function yse(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var yS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var kE={exports:{}},Cb={},ME={exports:{}},Ri={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L5;function vse(){if(L5)return Ri;L5=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),f=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),E=Symbol.iterator;function O(ze){return ze===null||typeof ze!="object"?null:(ze=E&&ze[E]||ze["@@iterator"],typeof ze=="function"?ze:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,B={};function q(ze,ht,rt){this.props=ze,this.context=ht,this.refs=B,this.updater=rt||F}q.prototype.isReactComponent={},q.prototype.setState=function(ze,ht){if(typeof ze!="object"&&typeof ze!="function"&&ze!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ze,ht,"setState")},q.prototype.forceUpdate=function(ze){this.updater.enqueueForceUpdate(this,ze,"forceUpdate")};function W(){}W.prototype=q.prototype;function Z(ze,ht,rt){this.props=ze,this.context=ht,this.refs=B,this.updater=rt||F}var ne=Z.prototype=new W;ne.constructor=Z,U(ne,q.prototype),ne.isPureReactComponent=!0;var ae=Array.isArray,ee=Object.prototype.hasOwnProperty,se={current:null},ce={key:!0,ref:!0,__self:!0,__source:!0};function ge(ze,ht,rt){var Qt,Cr={},vr=null,cr=null;if(ht!=null)for(Qt in ht.ref!==void 0&&(cr=ht.ref),ht.key!==void 0&&(vr=""+ht.key),ht)ee.call(ht,Qt)&&!ce.hasOwnProperty(Qt)&&(Cr[Qt]=ht[Qt]);var nr=arguments.length-2;if(nr===1)Cr.children=rt;else if(1<nr){for(var Kt=Array(nr),De=0;De<nr;De++)Kt[De]=arguments[De+2];Cr.children=Kt}if(ze&&ze.defaultProps)for(Qt in nr=ze.defaultProps,nr)Cr[Qt]===void 0&&(Cr[Qt]=nr[Qt]);return{$$typeof:e,type:ze,key:vr,ref:cr,props:Cr,_owner:se.current}}function Te(ze,ht){return{$$typeof:e,type:ze.type,key:ht,ref:ze.ref,props:ze.props,_owner:ze._owner}}function Ae(ze){return typeof ze=="object"&&ze!==null&&ze.$$typeof===e}function _e(ze){var ht={"=":"=0",":":"=2"};return"$"+ze.replace(/[=:]/g,function(rt){return ht[rt]})}var Ee=/\/+/g;function ke(ze,ht){return typeof ze=="object"&&ze!==null&&ze.key!=null?_e(""+ze.key):ht.toString(36)}function Qe(ze,ht,rt,Qt,Cr){var vr=typeof ze;(vr==="undefined"||vr==="boolean")&&(ze=null);var cr=!1;if(ze===null)cr=!0;else switch(vr){case"string":case"number":cr=!0;break;case"object":switch(ze.$$typeof){case e:case t:cr=!0}}if(cr)return cr=ze,Cr=Cr(cr),ze=Qt===""?"."+ke(cr,0):Qt,ae(Cr)?(rt="",ze!=null&&(rt=ze.replace(Ee,"$&/")+"/"),Qe(Cr,ht,rt,"",function(De){return De})):Cr!=null&&(Ae(Cr)&&(Cr=Te(Cr,rt+(!Cr.key||cr&&cr.key===Cr.key?"":(""+Cr.key).replace(Ee,"$&/")+"/")+ze)),ht.push(Cr)),1;if(cr=0,Qt=Qt===""?".":Qt+":",ae(ze))for(var nr=0;nr<ze.length;nr++){vr=ze[nr];var Kt=Qt+ke(vr,nr);cr+=Qe(vr,ht,rt,Kt,Cr)}else if(Kt=O(ze),typeof Kt=="function")for(ze=Kt.call(ze),nr=0;!(vr=ze.next()).done;)vr=vr.value,Kt=Qt+ke(vr,nr++),cr+=Qe(vr,ht,rt,Kt,Cr);else if(vr==="object")throw ht=String(ze),Error("Objects are not valid as a React child (found: "+(ht==="[object Object]"?"object with keys {"+Object.keys(ze).join(", ")+"}":ht)+"). If you meant to render a collection of children, use an array instead.");return cr}function Ze(ze,ht,rt){if(ze==null)return ze;var Qt=[],Cr=0;return Qe(ze,Qt,"","",function(vr){return ht.call(rt,vr,Cr++)}),Qt}function Ge(ze){if(ze._status===-1){var ht=ze._result;ht=ht(),ht.then(function(rt){(ze._status===0||ze._status===-1)&&(ze._status=1,ze._result=rt)},function(rt){(ze._status===0||ze._status===-1)&&(ze._status=2,ze._result=rt)}),ze._status===-1&&(ze._status=0,ze._result=ht)}if(ze._status===1)return ze._result.default;throw ze._result}var Oe={current:null},je={transition:null},Le={ReactCurrentDispatcher:Oe,ReactCurrentBatchConfig:je,ReactCurrentOwner:se};function ut(){throw Error("act(...) is not supported in production builds of React.")}return Ri.Children={map:Ze,forEach:function(ze,ht,rt){Ze(ze,function(){ht.apply(this,arguments)},rt)},count:function(ze){var ht=0;return Ze(ze,function(){ht++}),ht},toArray:function(ze){return Ze(ze,function(ht){return ht})||[]},only:function(ze){if(!Ae(ze))throw Error("React.Children.only expected to receive a single React element child.");return ze}},Ri.Component=q,Ri.Fragment=r,Ri.Profiler=a,Ri.PureComponent=Z,Ri.StrictMode=n,Ri.Suspense=_,Ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Le,Ri.act=ut,Ri.cloneElement=function(ze,ht,rt){if(ze==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ze+".");var Qt=U({},ze.props),Cr=ze.key,vr=ze.ref,cr=ze._owner;if(ht!=null){if(ht.ref!==void 0&&(vr=ht.ref,cr=se.current),ht.key!==void 0&&(Cr=""+ht.key),ze.type&&ze.type.defaultProps)var nr=ze.type.defaultProps;for(Kt in ht)ee.call(ht,Kt)&&!ce.hasOwnProperty(Kt)&&(Qt[Kt]=ht[Kt]===void 0&&nr!==void 0?nr[Kt]:ht[Kt])}var Kt=arguments.length-2;if(Kt===1)Qt.children=rt;else if(1<Kt){nr=Array(Kt);for(var De=0;De<Kt;De++)nr[De]=arguments[De+2];Qt.children=nr}return{$$typeof:e,type:ze.type,key:Cr,ref:vr,props:Qt,_owner:cr}},Ri.createContext=function(ze){return ze={$$typeof:f,_currentValue:ze,_currentValue2:ze,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ze.Provider={$$typeof:l,_context:ze},ze.Consumer=ze},Ri.createElement=ge,Ri.createFactory=function(ze){var ht=ge.bind(null,ze);return ht.type=ze,ht},Ri.createRef=function(){return{current:null}},Ri.forwardRef=function(ze){return{$$typeof:i,render:ze}},Ri.isValidElement=Ae,Ri.lazy=function(ze){return{$$typeof:A,_payload:{_status:-1,_result:ze},_init:Ge}},Ri.memo=function(ze,ht){return{$$typeof:w,type:ze,compare:ht===void 0?null:ht}},Ri.startTransition=function(ze){var ht=je.transition;je.transition={};try{ze()}finally{je.transition=ht}},Ri.unstable_act=ut,Ri.useCallback=function(ze,ht){return Oe.current.useCallback(ze,ht)},Ri.useContext=function(ze){return Oe.current.useContext(ze)},Ri.useDebugValue=function(){},Ri.useDeferredValue=function(ze){return Oe.current.useDeferredValue(ze)},Ri.useEffect=function(ze,ht){return Oe.current.useEffect(ze,ht)},Ri.useId=function(){return Oe.current.useId()},Ri.useImperativeHandle=function(ze,ht,rt){return Oe.current.useImperativeHandle(ze,ht,rt)},Ri.useInsertionEffect=function(ze,ht){return Oe.current.useInsertionEffect(ze,ht)},Ri.useLayoutEffect=function(ze,ht){return Oe.current.useLayoutEffect(ze,ht)},Ri.useMemo=function(ze,ht){return Oe.current.useMemo(ze,ht)},Ri.useReducer=function(ze,ht,rt){return Oe.current.useReducer(ze,ht,rt)},Ri.useRef=function(ze){return Oe.current.useRef(ze)},Ri.useState=function(ze){return Oe.current.useState(ze)},Ri.useSyncExternalStore=function(ze,ht,rt){return Oe.current.useSyncExternalStore(ze,ht,rt)},Ri.useTransition=function(){return Oe.current.useTransition()},Ri.version="18.3.1",Ri}var z5;function x3(){return z5||(z5=1,ME.exports=vse()),ME.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F5;function xse(){if(F5)return Cb;F5=1;var e=x3(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function f(i,_,w){var A,E={},O=null,F=null;w!==void 0&&(O=""+w),_.key!==void 0&&(O=""+_.key),_.ref!==void 0&&(F=_.ref);for(A in _)n.call(_,A)&&!l.hasOwnProperty(A)&&(E[A]=_[A]);if(i&&i.defaultProps)for(A in _=i.defaultProps,_)E[A]===void 0&&(E[A]=_[A]);return{$$typeof:t,type:i,key:O,ref:F,props:E,_owner:a.current}}return Cb.Fragment=r,Cb.jsx=f,Cb.jsxs=f,Cb}var B5;function _se(){return B5||(B5=1,kE.exports=xse()),kE.exports}var u=_se(),H=x3();const Re=oa(H),bse=yse({__proto__:null,default:Re},[H]);var wse=(e,t,r,n,a,l,f,i)=>{let _=document.documentElement,w=["light","dark"];function A(F){(Array.isArray(e)?e:[e]).forEach(U=>{let B=U==="class",q=B&&l?a.map(W=>l[W]||W):a;B?(_.classList.remove(...q),_.classList.add(l&&l[F]?l[F]:F)):_.setAttribute(U,F)}),E(F)}function E(F){i&&w.includes(F)&&(_.style.colorScheme=F)}function O(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)A(n);else try{let F=localStorage.getItem(t)||r,U=f&&F==="system"?O():F;A(U)}catch{}},Sse=H.createContext(void 0),Ase={setTheme:e=>{},themes:[]},Tse=()=>{var e;return(e=H.useContext(Sse))!=null?e:Ase};H.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:l,value:f,themes:i,nonce:_,scriptProps:w})=>{let A=JSON.stringify([r,t,l,e,i,f,n,a]).slice(1,-1);return H.createElement("script",{...w,suppressHydrationWarning:!0,nonce:typeof window>"u"?_:"",dangerouslySetInnerHTML:{__html:`(${wse.toString()})(${A})`}})});var jE={exports:{}},kc={},OE={exports:{}},NE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V5;function Pse(){return V5||(V5=1,function(e){function t(je,Le){var ut=je.length;je.push(Le);e:for(;0<ut;){var ze=ut-1>>>1,ht=je[ze];if(0<a(ht,Le))je[ze]=Le,je[ut]=ht,ut=ze;else break e}}function r(je){return je.length===0?null:je[0]}function n(je){if(je.length===0)return null;var Le=je[0],ut=je.pop();if(ut!==Le){je[0]=ut;e:for(var ze=0,ht=je.length,rt=ht>>>1;ze<rt;){var Qt=2*(ze+1)-1,Cr=je[Qt],vr=Qt+1,cr=je[vr];if(0>a(Cr,ut))vr<ht&&0>a(cr,Cr)?(je[ze]=cr,je[vr]=ut,ze=vr):(je[ze]=Cr,je[Qt]=ut,ze=Qt);else if(vr<ht&&0>a(cr,ut))je[ze]=cr,je[vr]=ut,ze=vr;else break e}}return Le}function a(je,Le){var ut=je.sortIndex-Le.sortIndex;return ut!==0?ut:je.id-Le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var f=Date,i=f.now();e.unstable_now=function(){return f.now()-i}}var _=[],w=[],A=1,E=null,O=3,F=!1,U=!1,B=!1,q=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ne(je){for(var Le=r(w);Le!==null;){if(Le.callback===null)n(w);else if(Le.startTime<=je)n(w),Le.sortIndex=Le.expirationTime,t(_,Le);else break;Le=r(w)}}function ae(je){if(B=!1,ne(je),!U)if(r(_)!==null)U=!0,Ge(ee);else{var Le=r(w);Le!==null&&Oe(ae,Le.startTime-je)}}function ee(je,Le){U=!1,B&&(B=!1,W(ge),ge=-1),F=!0;var ut=O;try{for(ne(Le),E=r(_);E!==null&&(!(E.expirationTime>Le)||je&&!_e());){var ze=E.callback;if(typeof ze=="function"){E.callback=null,O=E.priorityLevel;var ht=ze(E.expirationTime<=Le);Le=e.unstable_now(),typeof ht=="function"?E.callback=ht:E===r(_)&&n(_),ne(Le)}else n(_);E=r(_)}if(E!==null)var rt=!0;else{var Qt=r(w);Qt!==null&&Oe(ae,Qt.startTime-Le),rt=!1}return rt}finally{E=null,O=ut,F=!1}}var se=!1,ce=null,ge=-1,Te=5,Ae=-1;function _e(){return!(e.unstable_now()-Ae<Te)}function Ee(){if(ce!==null){var je=e.unstable_now();Ae=je;var Le=!0;try{Le=ce(!0,je)}finally{Le?ke():(se=!1,ce=null)}}else se=!1}var ke;if(typeof Z=="function")ke=function(){Z(Ee)};else if(typeof MessageChannel<"u"){var Qe=new MessageChannel,Ze=Qe.port2;Qe.port1.onmessage=Ee,ke=function(){Ze.postMessage(null)}}else ke=function(){q(Ee,0)};function Ge(je){ce=je,se||(se=!0,ke())}function Oe(je,Le){ge=q(function(){je(e.unstable_now())},Le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(je){je.callback=null},e.unstable_continueExecution=function(){U||F||(U=!0,Ge(ee))},e.unstable_forceFrameRate=function(je){0>je||125<je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Te=0<je?Math.floor(1e3/je):5},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return r(_)},e.unstable_next=function(je){switch(O){case 1:case 2:case 3:var Le=3;break;default:Le=O}var ut=O;O=Le;try{return je()}finally{O=ut}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(je,Le){switch(je){case 1:case 2:case 3:case 4:case 5:break;default:je=3}var ut=O;O=je;try{return Le()}finally{O=ut}},e.unstable_scheduleCallback=function(je,Le,ut){var ze=e.unstable_now();switch(typeof ut=="object"&&ut!==null?(ut=ut.delay,ut=typeof ut=="number"&&0<ut?ze+ut:ze):ut=ze,je){case 1:var ht=-1;break;case 2:ht=250;break;case 5:ht=1073741823;break;case 4:ht=1e4;break;default:ht=5e3}return ht=ut+ht,je={id:A++,callback:Le,priorityLevel:je,startTime:ut,expirationTime:ht,sortIndex:-1},ut>ze?(je.sortIndex=ut,t(w,je),r(_)===null&&je===r(w)&&(B?(W(ge),ge=-1):B=!0,Oe(ae,ut-ze))):(je.sortIndex=ht,t(_,je),U||F||(U=!0,Ge(ee))),je},e.unstable_shouldYield=_e,e.unstable_wrapCallback=function(je){var Le=O;return function(){var ut=O;O=Le;try{return je.apply(this,arguments)}finally{O=ut}}}}(NE)),NE}var U5;function Cse(){return U5||(U5=1,OE.exports=Pse()),OE.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $5;function Ese(){if($5)return kc;$5=1;var e=x3(),t=Cse();function r(b){for(var T="https://reactjs.org/docs/error-decoder.html?invariant="+b,V=1;V<arguments.length;V++)T+="&args[]="+encodeURIComponent(arguments[V]);return"Minified React error #"+b+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(b,T){f(b,T),f(b+"Capture",T)}function f(b,T){for(a[b]=T,b=0;b<T.length;b++)n.add(T[b])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A={},E={};function O(b){return _.call(E,b)?!0:_.call(A,b)?!1:w.test(b)?E[b]=!0:(A[b]=!0,!1)}function F(b,T,V,J){if(V!==null&&V.type===0)return!1;switch(typeof T){case"function":case"symbol":return!0;case"boolean":return J?!1:V!==null?!V.acceptsBooleans:(b=b.toLowerCase().slice(0,5),b!=="data-"&&b!=="aria-");default:return!1}}function U(b,T,V,J){if(T===null||typeof T>"u"||F(b,T,V,J))return!0;if(J)return!1;if(V!==null)switch(V.type){case 3:return!T;case 4:return T===!1;case 5:return isNaN(T);case 6:return isNaN(T)||1>T}return!1}function B(b,T,V,J,de,pe,Ve){this.acceptsBooleans=T===2||T===3||T===4,this.attributeName=J,this.attributeNamespace=de,this.mustUseProperty=V,this.propertyName=b,this.type=T,this.sanitizeURL=pe,this.removeEmptyString=Ve}var q={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(b){q[b]=new B(b,0,!1,b,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(b){var T=b[0];q[T]=new B(T,1,!1,b[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(b){q[b]=new B(b,2,!1,b.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(b){q[b]=new B(b,2,!1,b,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(b){q[b]=new B(b,3,!1,b.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(b){q[b]=new B(b,3,!0,b,null,!1,!1)}),["capture","download"].forEach(function(b){q[b]=new B(b,4,!1,b,null,!1,!1)}),["cols","rows","size","span"].forEach(function(b){q[b]=new B(b,6,!1,b,null,!1,!1)}),["rowSpan","start"].forEach(function(b){q[b]=new B(b,5,!1,b.toLowerCase(),null,!1,!1)});var W=/[\-:]([a-z])/g;function Z(b){return b[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(b){var T=b.replace(W,Z);q[T]=new B(T,1,!1,b,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(b){var T=b.replace(W,Z);q[T]=new B(T,1,!1,b,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(b){var T=b.replace(W,Z);q[T]=new B(T,1,!1,b,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(b){q[b]=new B(b,1,!1,b.toLowerCase(),null,!1,!1)}),q.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(b){q[b]=new B(b,1,!1,b.toLowerCase(),null,!0,!0)});function ne(b,T,V,J){var de=q.hasOwnProperty(T)?q[T]:null;(de!==null?de.type!==0:J||!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&(U(T,V,de,J)&&(V=null),J||de===null?O(T)&&(V===null?b.removeAttribute(T):b.setAttribute(T,""+V)):de.mustUseProperty?b[de.propertyName]=V===null?de.type===3?!1:"":V:(T=de.attributeName,J=de.attributeNamespace,V===null?b.removeAttribute(T):(de=de.type,V=de===3||de===4&&V===!0?"":""+V,J?b.setAttributeNS(J,T,V):b.setAttribute(T,V))))}var ae=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ee=Symbol.for("react.element"),se=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),ge=Symbol.for("react.strict_mode"),Te=Symbol.for("react.profiler"),Ae=Symbol.for("react.provider"),_e=Symbol.for("react.context"),Ee=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),Qe=Symbol.for("react.suspense_list"),Ze=Symbol.for("react.memo"),Ge=Symbol.for("react.lazy"),Oe=Symbol.for("react.offscreen"),je=Symbol.iterator;function Le(b){return b===null||typeof b!="object"?null:(b=je&&b[je]||b["@@iterator"],typeof b=="function"?b:null)}var ut=Object.assign,ze;function ht(b){if(ze===void 0)try{throw Error()}catch(V){var T=V.stack.trim().match(/\n( *(at )?)/);ze=T&&T[1]||""}return`
`+ze+b}var rt=!1;function Qt(b,T){if(!b||rt)return"";rt=!0;var V=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(T)if(T=function(){throw Error()},Object.defineProperty(T.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(T,[])}catch(Zt){var J=Zt}Reflect.construct(b,[],T)}else{try{T.call()}catch(Zt){J=Zt}b.call(T.prototype)}else{try{throw Error()}catch(Zt){J=Zt}b()}}catch(Zt){if(Zt&&J&&typeof Zt.stack=="string"){for(var de=Zt.stack.split(`
`),pe=J.stack.split(`
`),Ve=de.length-1,yt=pe.length-1;1<=Ve&&0<=yt&&de[Ve]!==pe[yt];)yt--;for(;1<=Ve&&0<=yt;Ve--,yt--)if(de[Ve]!==pe[yt]){if(Ve!==1||yt!==1)do if(Ve--,yt--,0>yt||de[Ve]!==pe[yt]){var Ct=`
`+de[Ve].replace(" at new "," at ");return b.displayName&&Ct.includes("<anonymous>")&&(Ct=Ct.replace("<anonymous>",b.displayName)),Ct}while(1<=Ve&&0<=yt);break}}}finally{rt=!1,Error.prepareStackTrace=V}return(b=b?b.displayName||b.name:"")?ht(b):""}function Cr(b){switch(b.tag){case 5:return ht(b.type);case 16:return ht("Lazy");case 13:return ht("Suspense");case 19:return ht("SuspenseList");case 0:case 2:case 15:return b=Qt(b.type,!1),b;case 11:return b=Qt(b.type.render,!1),b;case 1:return b=Qt(b.type,!0),b;default:return""}}function vr(b){if(b==null)return null;if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case ce:return"Fragment";case se:return"Portal";case Te:return"Profiler";case ge:return"StrictMode";case ke:return"Suspense";case Qe:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case _e:return(b.displayName||"Context")+".Consumer";case Ae:return(b._context.displayName||"Context")+".Provider";case Ee:var T=b.render;return b=b.displayName,b||(b=T.displayName||T.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case Ze:return T=b.displayName||null,T!==null?T:vr(b.type)||"Memo";case Ge:T=b._payload,b=b._init;try{return vr(b(T))}catch{}}return null}function cr(b){var T=b.type;switch(b.tag){case 24:return"Cache";case 9:return(T.displayName||"Context")+".Consumer";case 10:return(T._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return b=T.render,b=b.displayName||b.name||"",T.displayName||(b!==""?"ForwardRef("+b+")":"ForwardRef");case 7:return"Fragment";case 5:return T;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vr(T);case 8:return T===ge?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T}return null}function nr(b){switch(typeof b){case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function Kt(b){var T=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(T==="checkbox"||T==="radio")}function De(b){var T=Kt(b)?"checked":"value",V=Object.getOwnPropertyDescriptor(b.constructor.prototype,T),J=""+b[T];if(!b.hasOwnProperty(T)&&typeof V<"u"&&typeof V.get=="function"&&typeof V.set=="function"){var de=V.get,pe=V.set;return Object.defineProperty(b,T,{configurable:!0,get:function(){return de.call(this)},set:function(Ve){J=""+Ve,pe.call(this,Ve)}}),Object.defineProperty(b,T,{enumerable:V.enumerable}),{getValue:function(){return J},setValue:function(Ve){J=""+Ve},stopTracking:function(){b._valueTracker=null,delete b[T]}}}}function er(b){b._valueTracker||(b._valueTracker=De(b))}function Lt(b){if(!b)return!1;var T=b._valueTracker;if(!T)return!0;var V=T.getValue(),J="";return b&&(J=Kt(b)?b.checked?"true":"false":b.value),b=J,b!==V?(T.setValue(b),!0):!1}function Rr(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}function Pt(b,T){var V=T.checked;return ut({},T,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:V??b._wrapperState.initialChecked})}function nn(b,T){var V=T.defaultValue==null?"":T.defaultValue,J=T.checked!=null?T.checked:T.defaultChecked;V=nr(T.value!=null?T.value:V),b._wrapperState={initialChecked:J,initialValue:V,controlled:T.type==="checkbox"||T.type==="radio"?T.checked!=null:T.value!=null}}function Sn(b,T){T=T.checked,T!=null&&ne(b,"checked",T,!1)}function Br(b,T){Sn(b,T);var V=nr(T.value),J=T.type;if(V!=null)J==="number"?(V===0&&b.value===""||b.value!=V)&&(b.value=""+V):b.value!==""+V&&(b.value=""+V);else if(J==="submit"||J==="reset"){b.removeAttribute("value");return}T.hasOwnProperty("value")?bt(b,T.type,V):T.hasOwnProperty("defaultValue")&&bt(b,T.type,nr(T.defaultValue)),T.checked==null&&T.defaultChecked!=null&&(b.defaultChecked=!!T.defaultChecked)}function et(b,T,V){if(T.hasOwnProperty("value")||T.hasOwnProperty("defaultValue")){var J=T.type;if(!(J!=="submit"&&J!=="reset"||T.value!==void 0&&T.value!==null))return;T=""+b._wrapperState.initialValue,V||T===b.value||(b.value=T),b.defaultValue=T}V=b.name,V!==""&&(b.name=""),b.defaultChecked=!!b._wrapperState.initialChecked,V!==""&&(b.name=V)}function bt(b,T,V){(T!=="number"||Rr(b.ownerDocument)!==b)&&(V==null?b.defaultValue=""+b._wrapperState.initialValue:b.defaultValue!==""+V&&(b.defaultValue=""+V))}var zt=Array.isArray;function xr(b,T,V,J){if(b=b.options,T){T={};for(var de=0;de<V.length;de++)T["$"+V[de]]=!0;for(V=0;V<b.length;V++)de=T.hasOwnProperty("$"+b[V].value),b[V].selected!==de&&(b[V].selected=de),de&&J&&(b[V].defaultSelected=!0)}else{for(V=""+nr(V),T=null,de=0;de<b.length;de++){if(b[de].value===V){b[de].selected=!0,J&&(b[de].defaultSelected=!0);return}T!==null||b[de].disabled||(T=b[de])}T!==null&&(T.selected=!0)}}function fr(b,T){if(T.dangerouslySetInnerHTML!=null)throw Error(r(91));return ut({},T,{value:void 0,defaultValue:void 0,children:""+b._wrapperState.initialValue})}function pr(b,T){var V=T.value;if(V==null){if(V=T.children,T=T.defaultValue,V!=null){if(T!=null)throw Error(r(92));if(zt(V)){if(1<V.length)throw Error(r(93));V=V[0]}T=V}T==null&&(T=""),V=T}b._wrapperState={initialValue:nr(V)}}function ar(b,T){var V=nr(T.value),J=nr(T.defaultValue);V!=null&&(V=""+V,V!==b.value&&(b.value=V),T.defaultValue==null&&b.defaultValue!==V&&(b.defaultValue=V)),J!=null&&(b.defaultValue=""+J)}function tn(b){var T=b.textContent;T===b._wrapperState.initialValue&&T!==""&&T!==null&&(b.value=T)}function Xn(b){switch(b){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bi(b,T){return b==null||b==="http://www.w3.org/1999/xhtml"?Xn(T):b==="http://www.w3.org/2000/svg"&&T==="foreignObject"?"http://www.w3.org/1999/xhtml":b}var Vi,io=function(b){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(T,V,J,de){MSApp.execUnsafeLocalFunction(function(){return b(T,V,J,de)})}:b}(function(b,T){if(b.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in b)b.innerHTML=T;else{for(Vi=Vi||document.createElement("div"),Vi.innerHTML="<svg>"+T.valueOf().toString()+"</svg>",T=Vi.firstChild;b.firstChild;)b.removeChild(b.firstChild);for(;T.firstChild;)b.appendChild(T.firstChild)}});function Va(b,T){if(T){var V=b.firstChild;if(V&&V===b.lastChild&&V.nodeType===3){V.nodeValue=T;return}}b.textContent=T}var Vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yo=["Webkit","ms","Moz","O"];Object.keys(Vs).forEach(function(b){yo.forEach(function(T){T=T+b.charAt(0).toUpperCase()+b.substring(1),Vs[T]=Vs[b]})});function Qa(b,T,V){return T==null||typeof T=="boolean"||T===""?"":V||typeof T!="number"||T===0||Vs.hasOwnProperty(b)&&Vs[b]?(""+T).trim():T+"px"}function ql(b,T){b=b.style;for(var V in T)if(T.hasOwnProperty(V)){var J=V.indexOf("--")===0,de=Qa(V,T[V],J);V==="float"&&(V="cssFloat"),J?b.setProperty(V,de):b[V]=de}}var _l=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Os(b,T){if(T){if(_l[b]&&(T.children!=null||T.dangerouslySetInnerHTML!=null))throw Error(r(137,b));if(T.dangerouslySetInnerHTML!=null){if(T.children!=null)throw Error(r(60));if(typeof T.dangerouslySetInnerHTML!="object"||!("__html"in T.dangerouslySetInnerHTML))throw Error(r(61))}if(T.style!=null&&typeof T.style!="object")throw Error(r(62))}}function Gl(b,T){if(b.indexOf("-")===-1)return typeof T.is=="string";switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var an=null;function es(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var Mu=null,Ua=null,Us=null;function qn(b){if(b=qd(b)){if(typeof Mu!="function")throw Error(r(280));var T=b.stateNode;T&&(T=of(T),Mu(b.stateNode,b.type,T))}}function ha(b){Ua?Us?Us.push(b):Us=[b]:Ua=b}function Ta(){if(Ua){var b=Ua,T=Us;if(Us=Ua=null,qn(b),T)for(b=0;b<T.length;b++)qn(T[b])}}function ws(b,T){return b(T)}function bl(){}var Pa=!1;function Ns(b,T,V){if(Pa)return b(T,V);Pa=!0;try{return ws(b,T,V)}finally{Pa=!1,(Ua!==null||Us!==null)&&(bl(),Ta())}}function Ui(b,T){var V=b.stateNode;if(V===null)return null;var J=of(V);if(J===null)return null;V=J[T];e:switch(T){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(J=!J.disabled)||(b=b.type,J=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!J;break e;default:b=!1}if(b)return null;if(V&&typeof V!="function")throw Error(r(231,T,typeof V));return V}var Ss=!1;if(i)try{var us={};Object.defineProperty(us,"passive",{get:function(){Ss=!0}}),window.addEventListener("test",us,us),window.removeEventListener("test",us,us)}catch{Ss=!1}function ju(b,T,V,J,de,pe,Ve,yt,Ct){var Zt=Array.prototype.slice.call(arguments,3);try{T.apply(V,Zt)}catch(Tr){this.onError(Tr)}}var Hi=!1,zo=null,At=!1,ye=null,Se={onError:function(b){Hi=!0,zo=b}};function Pe(b,T,V,J,de,pe,Ve,yt,Ct){Hi=!1,zo=null,ju.apply(Se,arguments)}function He(b,T,V,J,de,pe,Ve,yt,Ct){if(Pe.apply(this,arguments),Hi){if(Hi){var Zt=zo;Hi=!1,zo=null}else throw Error(r(198));At||(At=!0,ye=Zt)}}function Ye(b){var T=b,V=b;if(b.alternate)for(;T.return;)T=T.return;else{b=T;do T=b,(T.flags&4098)!==0&&(V=T.return),b=T.return;while(b)}return T.tag===3?V:null}function at(b){if(b.tag===13){var T=b.memoizedState;if(T===null&&(b=b.alternate,b!==null&&(T=b.memoizedState)),T!==null)return T.dehydrated}return null}function gt(b){if(Ye(b)!==b)throw Error(r(188))}function ot(b){var T=b.alternate;if(!T){if(T=Ye(b),T===null)throw Error(r(188));return T!==b?null:b}for(var V=b,J=T;;){var de=V.return;if(de===null)break;var pe=de.alternate;if(pe===null){if(J=de.return,J!==null){V=J;continue}break}if(de.child===pe.child){for(pe=de.child;pe;){if(pe===V)return gt(de),b;if(pe===J)return gt(de),T;pe=pe.sibling}throw Error(r(188))}if(V.return!==J.return)V=de,J=pe;else{for(var Ve=!1,yt=de.child;yt;){if(yt===V){Ve=!0,V=de,J=pe;break}if(yt===J){Ve=!0,J=de,V=pe;break}yt=yt.sibling}if(!Ve){for(yt=pe.child;yt;){if(yt===V){Ve=!0,V=pe,J=de;break}if(yt===J){Ve=!0,J=pe,V=de;break}yt=yt.sibling}if(!Ve)throw Error(r(189))}}if(V.alternate!==J)throw Error(r(190))}if(V.tag!==3)throw Error(r(188));return V.stateNode.current===V?b:T}function St(b){return b=ot(b),b!==null?wt(b):null}function wt(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){var T=wt(b);if(T!==null)return T;b=b.sibling}return null}var Tt=t.unstable_scheduleCallback,Ft=t.unstable_cancelCallback,rr=t.unstable_shouldYield,sr=t.unstable_requestPaint,Ar=t.unstable_now,$r=t.unstable_getCurrentPriorityLevel,Ur=t.unstable_ImmediatePriority,Vr=t.unstable_UserBlockingPriority,Cn=t.unstable_NormalPriority,Hn=t.unstable_LowPriority,bn=t.unstable_IdlePriority,Un=null,En=null;function Ca(b){if(En&&typeof En.onCommitFiberRoot=="function")try{En.onCommitFiberRoot(Un,b,void 0,(b.current.flags&128)===128)}catch{}}var ds=Math.clz32?Math.clz32:ao,$a=Math.log,ts=Math.LN2;function ao(b){return b>>>=0,b===0?32:31-($a(b)/ts|0)|0}var Ou=64,wl=4194304;function Vc(b){switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return b&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return b}}function Wh(b,T){var V=b.pendingLanes;if(V===0)return 0;var J=0,de=b.suspendedLanes,pe=b.pingedLanes,Ve=V&268435455;if(Ve!==0){var yt=Ve&~de;yt!==0?J=Vc(yt):(pe&=Ve,pe!==0&&(J=Vc(pe)))}else Ve=V&~de,Ve!==0?J=Vc(Ve):pe!==0&&(J=Vc(pe));if(J===0)return 0;if(T!==0&&T!==J&&(T&de)===0&&(de=J&-J,pe=T&-T,de>=pe||de===16&&(pe&4194240)!==0))return T;if((J&4)!==0&&(J|=V&16),T=b.entangledLanes,T!==0)for(b=b.entanglements,T&=J;0<T;)V=31-ds(T),de=1<<V,J|=b[V],T&=~de;return J}function r0(b,T){switch(b){case 1:case 2:case 4:return T+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dy(b,T){for(var V=b.suspendedLanes,J=b.pingedLanes,de=b.expirationTimes,pe=b.pendingLanes;0<pe;){var Ve=31-ds(pe),yt=1<<Ve,Ct=de[Ve];Ct===-1?((yt&V)===0||(yt&J)!==0)&&(de[Ve]=r0(yt,T)):Ct<=T&&(b.expiredLanes|=yt),pe&=~yt}}function lp(b){return b=b.pendingLanes&-1073741825,b!==0?b:b&1073741824?1073741824:0}function $s(){var b=Ou;return Ou<<=1,(Ou&4194240)===0&&(Ou=64),b}function al(b){for(var T=[],V=0;31>V;V++)T.push(b);return T}function sl(b,T,V){b.pendingLanes|=T,T!==536870912&&(b.suspendedLanes=0,b.pingedLanes=0),b=b.eventTimes,T=31-ds(T),b[T]=V}function uc(b,T){var V=b.pendingLanes&~T;b.pendingLanes=T,b.suspendedLanes=0,b.pingedLanes=0,b.expiredLanes&=T,b.mutableReadLanes&=T,b.entangledLanes&=T,T=b.entanglements;var J=b.eventTimes;for(b=b.expirationTimes;0<V;){var de=31-ds(V),pe=1<<de;T[de]=0,J[de]=-1,b[de]=-1,V&=~pe}}function ol(b,T){var V=b.entangledLanes|=T;for(b=b.entanglements;V;){var J=31-ds(V),de=1<<J;de&T|b[J]&T&&(b[J]|=T),V&=~de}}var vi=0;function cp(b){return b&=-b,1<b?4<b?(b&268435455)!==0?16:536870912:4:1}var Tm,dc,Uc,hy,Pm,Fo=!1,Jn=[],hc=null,Lr=null,$c=null,Nu=new Map,Ru=new Map,hn=[],Cm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Iu(b,T){switch(b){case"focusin":case"focusout":hc=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":$c=null;break;case"pointerover":case"pointerout":Nu.delete(T.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ru.delete(T.pointerId)}}function wr(b,T,V,J,de,pe){return b===null||b.nativeEvent!==pe?(b={blockedOn:T,domEventName:V,eventSystemFlags:J,nativeEvent:pe,targetContainers:[de]},T!==null&&(T=qd(T),T!==null&&dc(T)),b):(b.eventSystemFlags|=J,T=b.targetContainers,de!==null&&T.indexOf(de)===-1&&T.push(de),b)}function mi(b,T,V,J,de){switch(T){case"focusin":return hc=wr(hc,b,T,V,J,de),!0;case"dragenter":return Lr=wr(Lr,b,T,V,J,de),!0;case"mouseover":return $c=wr($c,b,T,V,J,de),!0;case"pointerover":var pe=de.pointerId;return Nu.set(pe,wr(Nu.get(pe)||null,b,T,V,J,de)),!0;case"gotpointercapture":return pe=de.pointerId,Ru.set(pe,wr(Ru.get(pe)||null,b,T,V,J,de)),!0}return!1}function Gn(b){var T=Wu(b.target);if(T!==null){var V=Ye(T);if(V!==null){if(T=V.tag,T===13){if(T=at(V),T!==null){b.blockedOn=T,Pm(b.priority,function(){Uc(V)});return}}else if(T===3&&V.stateNode.current.memoizedState.isDehydrated){b.blockedOn=V.tag===3?V.stateNode.containerInfo:null;return}}}b.blockedOn=null}function hs(b){if(b.blockedOn!==null)return!1;for(var T=b.targetContainers;0<T.length;){var V=Od(b.domEventName,b.eventSystemFlags,T[0],b.nativeEvent);if(V===null){V=b.nativeEvent;var J=new V.constructor(V.type,V);an=J,V.target.dispatchEvent(J),an=null}else return T=qd(V),T!==null&&dc(T),b.blockedOn=V,!1;T.shift()}return!0}function fc(b,T,V){hs(b)&&V.delete(T)}function ai(){Fo=!1,hc!==null&&hs(hc)&&(hc=null),Lr!==null&&hs(Lr)&&(Lr=null),$c!==null&&hs($c)&&($c=null),Nu.forEach(fc),Ru.forEach(fc)}function qc(b,T){b.blockedOn===T&&(b.blockedOn=null,Fo||(Fo=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ai)))}function Bo(b){function T(de){return qc(de,b)}if(0<Jn.length){qc(Jn[0],b);for(var V=1;V<Jn.length;V++){var J=Jn[V];J.blockedOn===b&&(J.blockedOn=null)}}for(hc!==null&&qc(hc,b),Lr!==null&&qc(Lr,b),$c!==null&&qc($c,b),Nu.forEach(T),Ru.forEach(T),V=0;V<hn.length;V++)J=hn[V],J.blockedOn===b&&(J.blockedOn=null);for(;0<hn.length&&(V=hn[0],V.blockedOn===null);)Gn(V),V.blockedOn===null&&hn.shift()}var pc=ae.ReactCurrentBatchConfig,qa=!0;function fa(b,T,V,J){var de=vi,pe=pc.transition;pc.transition=null;try{vi=1,qs(b,T,V,J)}finally{vi=de,pc.transition=pe}}function fy(b,T,V,J){var de=vi,pe=pc.transition;pc.transition=null;try{vi=4,qs(b,T,V,J)}finally{vi=de,pc.transition=pe}}function qs(b,T,V,J){if(qa){var de=Od(b,T,V,J);if(de===null)Bd(b,T,J,jd,V),Iu(b,J);else if(mi(de,b,T,V,J))J.stopPropagation();else if(Iu(b,J),T&4&&-1<Cm.indexOf(b)){for(;de!==null;){var pe=qd(de);if(pe!==null&&Tm(pe),pe=Od(b,T,V,J),pe===null&&Bd(b,T,J,jd,V),pe===de)break;de=pe}de!==null&&J.stopPropagation()}else Bd(b,T,J,null,V)}}var jd=null;function Od(b,T,V,J){if(jd=null,b=es(J),b=Wu(b),b!==null)if(T=Ye(b),T===null)b=null;else if(V=T.tag,V===13){if(b=at(T),b!==null)return b;b=null}else if(V===3){if(T.stateNode.current.memoizedState.isDehydrated)return T.tag===3?T.stateNode.containerInfo:null;b=null}else T!==b&&(b=null);return jd=b,null}function up(b){switch(b){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($r()){case Ur:return 1;case Vr:return 4;case Cn:case Hn:return 16;case bn:return 536870912;default:return 16}default:return 16}}var Sl=null,As=null,ll=null;function Ts(){if(ll)return ll;var b,T=As,V=T.length,J,de="value"in Sl?Sl.value:Sl.textContent,pe=de.length;for(b=0;b<V&&T[b]===de[b];b++);var Ve=V-b;for(J=1;J<=Ve&&T[V-J]===de[pe-J];J++);return ll=de.slice(b,1<J?1-J:void 0)}function Hh(b){var T=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&T===13&&(b=13)):b=T,b===10&&(b=13),32<=b||b===13?b:0}function Al(){return!0}function ta(){return!1}function Ea(b){function T(V,J,de,pe,Ve){this._reactName=V,this._targetInst=de,this.type=J,this.nativeEvent=pe,this.target=Ve,this.currentTarget=null;for(var yt in b)b.hasOwnProperty(yt)&&(V=b[yt],this[yt]=V?V(pe):pe[yt]);return this.isDefaultPrevented=(pe.defaultPrevented!=null?pe.defaultPrevented:pe.returnValue===!1)?Al:ta,this.isPropagationStopped=ta,this}return ut(T.prototype,{preventDefault:function(){this.defaultPrevented=!0;var V=this.nativeEvent;V&&(V.preventDefault?V.preventDefault():typeof V.returnValue!="unknown"&&(V.returnValue=!1),this.isDefaultPrevented=Al)},stopPropagation:function(){var V=this.nativeEvent;V&&(V.stopPropagation?V.stopPropagation():typeof V.cancelBubble!="unknown"&&(V.cancelBubble=!0),this.isPropagationStopped=Al)},persist:function(){},isPersistent:Al}),T}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pa=Ea(ka),Gc=ut({},ka,{view:0,detail:0}),Wl=Ea(Gc),Wc,Nd,vo,Kh=ut({},Gc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hl,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==vo&&(vo&&b.type==="mousemove"?(Wc=b.screenX-vo.screenX,Nd=b.screenY-vo.screenY):Nd=Wc=0,vo=b),Wc)},movementY:function(b){return"movementY"in b?b.movementY:Nd}}),mc=Ea(Kh),I_=ut({},Kh,{dataTransfer:0}),py=Ea(I_),xo=ut({},Gc,{relatedTarget:0}),dp=Ea(xo),Em=ut({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),hp=Ea(Em),fp=ut({},ka,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),D_=Ea(fp),L_=ut({},ka,{data:0}),Zh=Ea(L_),pp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function my(b){var T=this.nativeEvent;return T.getModifierState?T.getModifierState(b):(b=Yh[b])?!!T[b]:!1}function Hl(){return my}var Du=ut({},Gc,{key:function(b){if(b.key){var T=pp[b.key]||b.key;if(T!=="Unidentified")return T}return b.type==="keypress"?(b=Hh(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?z_[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hl,charCode:function(b){return b.type==="keypress"?Hh(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?Hh(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),F_=Ea(Du),gy=ut({},Kh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),n0=Ea(gy),i0=ut({},Gc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hl}),B_=Ea(i0),yy=ut({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rd=Ea(yy),An=ut({},Kh,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),zr=Ea(An),km=[9,13,27,32],Wr=i&&"CompositionEvent"in window,gc=null;i&&"documentMode"in document&&(gc=document.documentMode);var Mm=i&&"TextEvent"in window&&!gc,Kr=i&&(!Wr||gc&&8<gc&&11>=gc),Id=" ",Lu=!1;function jm(b,T){switch(b){case"keyup":return km.indexOf(T.keyCode)!==-1;case"keydown":return T.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mp(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var fs=!1;function Rs(b,T){switch(b){case"compositionend":return mp(T);case"keypress":return T.which!==32?null:(Lu=!0,Id);case"textInput":return b=T.data,b===Id&&Lu?null:b;default:return null}}function lr(b,T){if(fs)return b==="compositionend"||!Wr&&jm(b,T)?(b=Ts(),ll=As=Sl=null,fs=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(T.ctrlKey||T.altKey||T.metaKey)||T.ctrlKey&&T.altKey){if(T.char&&1<T.char.length)return T.char;if(T.which)return String.fromCharCode(T.which)}return null;case"compositionend":return Kr&&T.locale!=="ko"?null:T.data;default:return null}}var vy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gp(b){var T=b&&b.nodeName&&b.nodeName.toLowerCase();return T==="input"?!!vy[b.type]:T==="textarea"}function Xh(b,T,V,J){ha(J),T=Tp(T,"onChange"),0<T.length&&(V=new pa("onChange","change",null,V,J),b.push({event:V,listeners:T}))}var Tl=null,Ra=null;function Hc(b){Lm(b,0)}function Jh(b){var T=cl(b);if(Lt(T))return b}function Dd(b,T){if(b==="change")return T}var zu=!1;if(i){var Kc;if(i){var yp="oninput"in document;if(!yp){var a0=document.createElement("div");a0.setAttribute("oninput","return;"),yp=typeof a0.oninput=="function"}Kc=yp}else Kc=!1;zu=Kc&&(!document.documentMode||9<document.documentMode)}function Om(){Tl&&(Tl.detachEvent("onpropertychange",s0),Ra=Tl=null)}function s0(b){if(b.propertyName==="value"&&Jh(Ra)){var T=[];Xh(T,Ra,b,es(b)),Ns(Hc,T)}}function o0(b,T,V){b==="focusin"?(Om(),Tl=T,Ra=V,Tl.attachEvent("onpropertychange",s0)):b==="focusout"&&Om()}function xy(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return Jh(Ra)}function _y(b,T){if(b==="click")return Jh(T)}function V_(b,T){if(b==="input"||b==="change")return Jh(T)}function l0(b,T){return b===T&&(b!==0||1/b===1/T)||b!==b&&T!==T}var Gs=typeof Object.is=="function"?Object.is:l0;function vp(b,T){if(Gs(b,T))return!0;if(typeof b!="object"||b===null||typeof T!="object"||T===null)return!1;var V=Object.keys(b),J=Object.keys(T);if(V.length!==J.length)return!1;for(J=0;J<V.length;J++){var de=V[J];if(!_.call(T,de)||!Gs(b[de],T[de]))return!1}return!0}function by(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Nm(b,T){var V=by(b);b=0;for(var J;V;){if(V.nodeType===3){if(J=b+V.textContent.length,b<=T&&J>=T)return{node:V,offset:T-b};b=J}e:{for(;V;){if(V.nextSibling){V=V.nextSibling;break e}V=V.parentNode}V=void 0}V=by(V)}}function Qh(b,T){return b&&T?b===T?!0:b&&b.nodeType===3?!1:T&&T.nodeType===3?Qh(b,T.parentNode):"contains"in b?b.contains(T):b.compareDocumentPosition?!!(b.compareDocumentPosition(T)&16):!1:!1}function wy(){for(var b=window,T=Rr();T instanceof b.HTMLIFrameElement;){try{var V=typeof T.contentWindow.location.href=="string"}catch{V=!1}if(V)b=T.contentWindow;else break;T=Rr(b.document)}return T}function Vo(b){var T=b&&b.nodeName&&b.nodeName.toLowerCase();return T&&(T==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||T==="textarea"||b.contentEditable==="true")}function Rm(b){var T=wy(),V=b.focusedElem,J=b.selectionRange;if(T!==V&&V&&V.ownerDocument&&Qh(V.ownerDocument.documentElement,V)){if(J!==null&&Vo(V)){if(T=J.start,b=J.end,b===void 0&&(b=T),"selectionStart"in V)V.selectionStart=T,V.selectionEnd=Math.min(b,V.value.length);else if(b=(T=V.ownerDocument||document)&&T.defaultView||window,b.getSelection){b=b.getSelection();var de=V.textContent.length,pe=Math.min(J.start,de);J=J.end===void 0?pe:Math.min(J.end,de),!b.extend&&pe>J&&(de=J,J=pe,pe=de),de=Nm(V,pe);var Ve=Nm(V,J);de&&Ve&&(b.rangeCount!==1||b.anchorNode!==de.node||b.anchorOffset!==de.offset||b.focusNode!==Ve.node||b.focusOffset!==Ve.offset)&&(T=T.createRange(),T.setStart(de.node,de.offset),b.removeAllRanges(),pe>J?(b.addRange(T),b.extend(Ve.node,Ve.offset)):(T.setEnd(Ve.node,Ve.offset),b.addRange(T)))}}for(T=[],b=V;b=b.parentNode;)b.nodeType===1&&T.push({element:b,left:b.scrollLeft,top:b.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<T.length;V++)b=T[V],b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}var xp=i&&"documentMode"in document&&11>=document.documentMode,Zc=null,yc=null,Fu=null,_p=!1;function Bu(b,T,V){var J=V.window===V?V.document:V.nodeType===9?V:V.ownerDocument;_p||Zc==null||Zc!==Rr(J)||(J=Zc,"selectionStart"in J&&Vo(J)?J={start:J.selectionStart,end:J.selectionEnd}:(J=(J.ownerDocument&&J.ownerDocument.defaultView||window).getSelection(),J={anchorNode:J.anchorNode,anchorOffset:J.anchorOffset,focusNode:J.focusNode,focusOffset:J.focusOffset}),Fu&&vp(Fu,J)||(Fu=J,J=Tp(yc,"onSelect"),0<J.length&&(T=new pa("onSelect","select",null,T,V),b.push({event:T,listeners:J}),T.target=Zc)))}function Yc(b,T){var V={};return V[b.toLowerCase()]=T.toLowerCase(),V["Webkit"+b]="webkit"+T,V["Moz"+b]="moz"+T,V}var vc={animationend:Yc("Animation","AnimationEnd"),animationiteration:Yc("Animation","AnimationIteration"),animationstart:Yc("Animation","AnimationStart"),transitionend:Yc("Transition","TransitionEnd")},Ld={},Vu={};i&&(Vu=document.createElement("div").style,"AnimationEvent"in window||(delete vc.animationend.animation,delete vc.animationiteration.animation,delete vc.animationstart.animation),"TransitionEvent"in window||delete vc.transitionend.transition);function xc(b){if(Ld[b])return Ld[b];if(!vc[b])return b;var T=vc[b],V;for(V in T)if(T.hasOwnProperty(V)&&V in Vu)return Ld[b]=T[V];return b}var zd=xc("animationend"),ef=xc("animationiteration"),bp=xc("animationstart"),tf=xc("transitionend"),Fd=new Map,Uu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tn(b,T){Fd.set(b,T),l(T,[b])}for(var Im=0;Im<Uu.length;Im++){var $u=Uu[Im],c0=$u.toLowerCase(),u0=$u[0].toUpperCase()+$u.slice(1);Tn(c0,"on"+u0)}Tn(zd,"onAnimationEnd"),Tn(ef,"onAnimationIteration"),Tn(bp,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(tf,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zi=new Set("cancel close invalid load scroll toggle".split(" ").concat(wp));function Dm(b,T,V){var J=b.type||"unknown-event";b.currentTarget=V,He(J,T,void 0,b),b.currentTarget=null}function Lm(b,T){T=(T&4)!==0;for(var V=0;V<b.length;V++){var J=b[V],de=J.event;J=J.listeners;e:{var pe=void 0;if(T)for(var Ve=J.length-1;0<=Ve;Ve--){var yt=J[Ve],Ct=yt.instance,Zt=yt.currentTarget;if(yt=yt.listener,Ct!==pe&&de.isPropagationStopped())break e;Dm(de,yt,Zt),pe=Ct}else for(Ve=0;Ve<J.length;Ve++){if(yt=J[Ve],Ct=yt.instance,Zt=yt.currentTarget,yt=yt.listener,Ct!==pe&&de.isPropagationStopped())break e;Dm(de,yt,Zt),pe=Ct}}}if(At)throw b=ye,At=!1,ye=null,b}function ca(b,T){var V=T[Gu];V===void 0&&(V=T[Gu]=new Set);var J=b+"__bubble";V.has(J)||(d0(T,b,2,!1),V.add(J))}function Sp(b,T,V){var J=0;T&&(J|=4),d0(V,b,J,T)}var Ap="_reactListening"+Math.random().toString(36).slice(2);function rf(b){if(!b[Ap]){b[Ap]=!0,n.forEach(function(V){V!=="selectionchange"&&(zi.has(V)||Sp(V,!1,b),Sp(V,!0,b))});var T=b.nodeType===9?b:b.ownerDocument;T===null||T[Ap]||(T[Ap]=!0,Sp("selectionchange",!1,T))}}function d0(b,T,V,J){switch(up(T)){case 1:var de=fa;break;case 4:de=fy;break;default:de=qs}V=de.bind(null,T,V,b),de=void 0,!Ss||T!=="touchstart"&&T!=="touchmove"&&T!=="wheel"||(de=!0),J?de!==void 0?b.addEventListener(T,V,{capture:!0,passive:de}):b.addEventListener(T,V,!0):de!==void 0?b.addEventListener(T,V,{passive:de}):b.addEventListener(T,V,!1)}function Bd(b,T,V,J,de){var pe=J;if((T&1)===0&&(T&2)===0&&J!==null)e:for(;;){if(J===null)return;var Ve=J.tag;if(Ve===3||Ve===4){var yt=J.stateNode.containerInfo;if(yt===de||yt.nodeType===8&&yt.parentNode===de)break;if(Ve===4)for(Ve=J.return;Ve!==null;){var Ct=Ve.tag;if((Ct===3||Ct===4)&&(Ct=Ve.stateNode.containerInfo,Ct===de||Ct.nodeType===8&&Ct.parentNode===de))return;Ve=Ve.return}for(;yt!==null;){if(Ve=Wu(yt),Ve===null)return;if(Ct=Ve.tag,Ct===5||Ct===6){J=pe=Ve;continue e}yt=yt.parentNode}}J=J.return}Ns(function(){var Zt=pe,Tr=es(V),Mr=[];e:{var Pr=Fd.get(b);if(Pr!==void 0){var Jr=pa,ln=b;switch(b){case"keypress":if(Hh(V)===0)break e;case"keydown":case"keyup":Jr=F_;break;case"focusin":ln="focus",Jr=dp;break;case"focusout":ln="blur",Jr=dp;break;case"beforeblur":case"afterblur":Jr=dp;break;case"click":if(V.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Jr=mc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Jr=py;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Jr=B_;break;case zd:case ef:case bp:Jr=hp;break;case tf:Jr=Rd;break;case"scroll":Jr=Wl;break;case"wheel":Jr=zr;break;case"copy":case"cut":case"paste":Jr=D_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Jr=n0}var un=(T&4)!==0,ys=!un&&b==="scroll",Vt=un?Pr!==null?Pr+"Capture":null:Pr;un=[];for(var Ot=Zt,Gt;Ot!==null;){Gt=Ot;var Nr=Gt.stateNode;if(Gt.tag===5&&Nr!==null&&(Gt=Nr,Vt!==null&&(Nr=Ui(Ot,Vt),Nr!=null&&un.push(Xc(Ot,Nr,Gt)))),ys)break;Ot=Ot.return}0<un.length&&(Pr=new Jr(Pr,ln,null,V,Tr),Mr.push({event:Pr,listeners:un}))}}if((T&7)===0){e:{if(Pr=b==="mouseover"||b==="pointerover",Jr=b==="mouseout"||b==="pointerout",Pr&&V!==an&&(ln=V.relatedTarget||V.fromElement)&&(Wu(ln)||ln[Cl]))break e;if((Jr||Pr)&&(Pr=Tr.window===Tr?Tr:(Pr=Tr.ownerDocument)?Pr.defaultView||Pr.parentWindow:window,Jr?(ln=V.relatedTarget||V.toElement,Jr=Zt,ln=ln?Wu(ln):null,ln!==null&&(ys=Ye(ln),ln!==ys||ln.tag!==5&&ln.tag!==6)&&(ln=null)):(Jr=null,ln=Zt),Jr!==ln)){if(un=mc,Nr="onMouseLeave",Vt="onMouseEnter",Ot="mouse",(b==="pointerout"||b==="pointerover")&&(un=n0,Nr="onPointerLeave",Vt="onPointerEnter",Ot="pointer"),ys=Jr==null?Pr:cl(Jr),Gt=ln==null?Pr:cl(ln),Pr=new un(Nr,Ot+"leave",Jr,V,Tr),Pr.target=ys,Pr.relatedTarget=Gt,Nr=null,Wu(Tr)===Zt&&(un=new un(Vt,Ot+"enter",ln,V,Tr),un.target=Gt,un.relatedTarget=ys,Nr=un),ys=Nr,Jr&&ln)t:{for(un=Jr,Vt=ln,Ot=0,Gt=un;Gt;Gt=Ps(Gt))Ot++;for(Gt=0,Nr=Vt;Nr;Nr=Ps(Nr))Gt++;for(;0<Ot-Gt;)un=Ps(un),Ot--;for(;0<Gt-Ot;)Vt=Ps(Vt),Gt--;for(;Ot--;){if(un===Vt||Vt!==null&&un===Vt.alternate)break t;un=Ps(un),Vt=Ps(Vt)}un=null}else un=null;Jr!==null&&zm(Mr,Pr,Jr,un,!1),ln!==null&&ys!==null&&zm(Mr,ys,ln,un,!0)}}e:{if(Pr=Zt?cl(Zt):window,Jr=Pr.nodeName&&Pr.nodeName.toLowerCase(),Jr==="select"||Jr==="input"&&Pr.type==="file")var rn=Dd;else if(gp(Pr))if(zu)rn=V_;else{rn=xy;var Rn=o0}else(Jr=Pr.nodeName)&&Jr.toLowerCase()==="input"&&(Pr.type==="checkbox"||Pr.type==="radio")&&(rn=_y);if(rn&&(rn=rn(b,Zt))){Xh(Mr,rn,V,Tr);break e}Rn&&Rn(b,Pr,Zt),b==="focusout"&&(Rn=Pr._wrapperState)&&Rn.controlled&&Pr.type==="number"&&bt(Pr,"number",Pr.value)}switch(Rn=Zt?cl(Zt):window,b){case"focusin":(gp(Rn)||Rn.contentEditable==="true")&&(Zc=Rn,yc=Zt,Fu=null);break;case"focusout":Fu=yc=Zc=null;break;case"mousedown":_p=!0;break;case"contextmenu":case"mouseup":case"dragend":_p=!1,Bu(Mr,V,Tr);break;case"selectionchange":if(xp)break;case"keydown":case"keyup":Bu(Mr,V,Tr)}var Fn;if(Wr)e:{switch(b){case"compositionstart":var oi="onCompositionStart";break e;case"compositionend":oi="onCompositionEnd";break e;case"compositionupdate":oi="onCompositionUpdate";break e}oi=void 0}else fs?jm(b,V)&&(oi="onCompositionEnd"):b==="keydown"&&V.keyCode===229&&(oi="onCompositionStart");oi&&(Kr&&V.locale!=="ko"&&(fs||oi!=="onCompositionStart"?oi==="onCompositionEnd"&&fs&&(Fn=Ts()):(Sl=Tr,As="value"in Sl?Sl.value:Sl.textContent,fs=!0)),Rn=Tp(Zt,oi),0<Rn.length&&(oi=new Zh(oi,b,null,V,Tr),Mr.push({event:oi,listeners:Rn}),Fn?oi.data=Fn:(Fn=mp(V),Fn!==null&&(oi.data=Fn)))),(Fn=Mm?Rs(b,V):lr(b,V))&&(Zt=Tp(Zt,"onBeforeInput"),0<Zt.length&&(Tr=new Zh("onBeforeInput","beforeinput",null,V,Tr),Mr.push({event:Tr,listeners:Zt}),Tr.data=Fn))}Lm(Mr,T)})}function Xc(b,T,V){return{instance:b,listener:T,currentTarget:V}}function Tp(b,T){for(var V=T+"Capture",J=[];b!==null;){var de=b,pe=de.stateNode;de.tag===5&&pe!==null&&(de=pe,pe=Ui(b,V),pe!=null&&J.unshift(Xc(b,pe,de)),pe=Ui(b,T),pe!=null&&J.push(Xc(b,pe,de))),b=b.return}return J}function Ps(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5);return b||null}function zm(b,T,V,J,de){for(var pe=T._reactName,Ve=[];V!==null&&V!==J;){var yt=V,Ct=yt.alternate,Zt=yt.stateNode;if(Ct!==null&&Ct===J)break;yt.tag===5&&Zt!==null&&(yt=Zt,de?(Ct=Ui(V,pe),Ct!=null&&Ve.unshift(Xc(V,Ct,yt))):de||(Ct=Ui(V,pe),Ct!=null&&Ve.push(Xc(V,Ct,yt)))),V=V.return}Ve.length!==0&&b.push({event:T,listeners:Ve})}var Fm=/\r\n?/g,Bm=/\u0000|\uFFFD/g;function Vm(b){return(typeof b=="string"?b:""+b).replace(Fm,`
`).replace(Bm,"")}function nf(b,T,V){if(T=Vm(T),Vm(b)!==T&&V)throw Error(r(425))}function Vd(){}var Pp=null,Cp=null;function af(b,T){return b==="textarea"||b==="noscript"||typeof T.children=="string"||typeof T.children=="number"||typeof T.dangerouslySetInnerHTML=="object"&&T.dangerouslySetInnerHTML!==null&&T.dangerouslySetInnerHTML.__html!=null}var Um=typeof setTimeout=="function"?setTimeout:void 0,h0=typeof clearTimeout=="function"?clearTimeout:void 0,Ud=typeof Promise=="function"?Promise:void 0,U_=typeof queueMicrotask=="function"?queueMicrotask:typeof Ud<"u"?function(b){return Ud.resolve(null).then(b).catch($_)}:Um;function $_(b){setTimeout(function(){throw b})}function Sy(b,T){var V=T,J=0;do{var de=V.nextSibling;if(b.removeChild(V),de&&de.nodeType===8)if(V=de.data,V==="/$"){if(J===0){b.removeChild(de),Bo(T);return}J--}else V!=="$"&&V!=="$?"&&V!=="$!"||J++;V=de}while(V);Bo(T)}function qu(b){for(;b!=null;b=b.nextSibling){var T=b.nodeType;if(T===1||T===3)break;if(T===8){if(T=b.data,T==="$"||T==="$!"||T==="$?")break;if(T==="/$")return null}}return b}function f0(b){b=b.previousSibling;for(var T=0;b;){if(b.nodeType===8){var V=b.data;if(V==="$"||V==="$!"||V==="$?"){if(T===0)return b;T--}else V==="/$"&&T++}b=b.previousSibling}return null}var sf=Math.random().toString(36).slice(2),Pl="__reactFiber$"+sf,$d="__reactProps$"+sf,Cl="__reactContainer$"+sf,Gu="__reactEvents$"+sf,Ay="__reactListeners$"+sf,p0="__reactHandles$"+sf;function Wu(b){var T=b[Pl];if(T)return T;for(var V=b.parentNode;V;){if(T=V[Cl]||V[Pl]){if(V=T.alternate,T.child!==null||V!==null&&V.child!==null)for(b=f0(b);b!==null;){if(V=b[Pl])return V;b=f0(b)}return T}b=V,V=b.parentNode}return null}function qd(b){return b=b[Pl]||b[Cl],!b||b.tag!==5&&b.tag!==6&&b.tag!==13&&b.tag!==3?null:b}function cl(b){if(b.tag===5||b.tag===6)return b.stateNode;throw Error(r(33))}function of(b){return b[$d]||null}var _o=[],Jc=-1;function El(b){return{current:b}}function ma(b){0>Jc||(b.current=_o[Jc],_o[Jc]=null,Jc--)}function Ji(b,T){Jc++,_o[Jc]=b.current,b.current=T}var kl={},Is=El(kl),Uo=El(!1),Qc=kl;function Kl(b,T){var V=b.type.contextTypes;if(!V)return kl;var J=b.stateNode;if(J&&J.__reactInternalMemoizedUnmaskedChildContext===T)return J.__reactInternalMemoizedMaskedChildContext;var de={},pe;for(pe in V)de[pe]=T[pe];return J&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=T,b.__reactInternalMemoizedMaskedChildContext=de),de}function $o(b){return b=b.childContextTypes,b!=null}function $m(){ma(Uo),ma(Is)}function Ty(b,T,V){if(Is.current!==kl)throw Error(r(168));Ji(Is,T),Ji(Uo,V)}function Py(b,T,V){var J=b.stateNode;if(T=T.childContextTypes,typeof J.getChildContext!="function")return V;J=J.getChildContext();for(var de in J)if(!(de in T))throw Error(r(108,cr(b)||"Unknown",de));return ut({},V,J)}function Gd(b){return b=(b=b.stateNode)&&b.__reactInternalMemoizedMergedChildContext||kl,Qc=Is.current,Ji(Is,b),Ji(Uo,Uo.current),!0}function Wd(b,T,V){var J=b.stateNode;if(!J)throw Error(r(169));V?(b=Py(b,T,Qc),J.__reactInternalMemoizedMergedChildContext=b,ma(Uo),ma(Is),Ji(Is,b)):ma(Uo),Ji(Uo,V)}var qo=null,Hd=!1,Kd=!1;function Cy(b){qo===null?qo=[b]:qo.push(b)}function Ep(b){Hd=!0,Cy(b)}function Ml(){if(!Kd&&qo!==null){Kd=!0;var b=0,T=vi;try{var V=qo;for(vi=1;b<V.length;b++){var J=V[b];do J=J(!0);while(J!==null)}qo=null,Hd=!1}catch(de){throw qo!==null&&(qo=qo.slice(b+1)),Tt(Ur,Ml),de}finally{vi=T,Kd=!1}}return null}var Hu=[],Zd=0,qm=null,_c=0,bo=[],mr=0,eu=null,Zl=1,so="";function ul(b,T){Hu[Zd++]=_c,Hu[Zd++]=qm,qm=b,_c=T}function kr(b,T,V){bo[mr++]=Zl,bo[mr++]=so,bo[mr++]=eu,eu=b;var J=Zl;b=so;var de=32-ds(J)-1;J&=~(1<<de),V+=1;var pe=32-ds(T)+de;if(30<pe){var Ve=de-de%5;pe=(J&(1<<Ve)-1).toString(32),J>>=Ve,de-=Ve,Zl=1<<32-ds(T)+de|V<<de|J,so=pe+b}else Zl=1<<pe|V<<de|J,so=b}function kp(b){b.return!==null&&(ul(b,1),kr(b,1,0))}function Ey(b){for(;b===qm;)qm=Hu[--Zd],Hu[Zd]=null,_c=Hu[--Zd],Hu[Zd]=null;for(;b===eu;)eu=bo[--mr],bo[mr]=null,so=bo[--mr],bo[mr]=null,Zl=bo[--mr],bo[mr]=null}var dl=null,oo=null,ga=!1,hl=null;function ky(b,T){var V=Ec(5,null,null,0);V.elementType="DELETED",V.stateNode=T,V.return=b,T=b.deletions,T===null?(b.deletions=[V],b.flags|=16):T.push(V)}function Gm(b,T){switch(b.tag){case 5:var V=b.type;return T=T.nodeType!==1||V.toLowerCase()!==T.nodeName.toLowerCase()?null:T,T!==null?(b.stateNode=T,dl=b,oo=qu(T.firstChild),!0):!1;case 6:return T=b.pendingProps===""||T.nodeType!==3?null:T,T!==null?(b.stateNode=T,dl=b,oo=null,!0):!1;case 13:return T=T.nodeType!==8?null:T,T!==null?(V=eu!==null?{id:Zl,overflow:so}:null,b.memoizedState={dehydrated:T,treeContext:V,retryLane:1073741824},V=Ec(18,null,null,0),V.stateNode=T,V.return=b,b.child=V,dl=b,oo=null,!0):!1;default:return!1}}function Yd(b){return(b.mode&1)!==0&&(b.flags&128)===0}function lf(b){if(ga){var T=oo;if(T){var V=T;if(!Gm(b,T)){if(Yd(b))throw Error(r(418));T=qu(V.nextSibling);var J=dl;T&&Gm(b,T)?ky(J,V):(b.flags=b.flags&-4097|2,ga=!1,dl=b)}}else{if(Yd(b))throw Error(r(418));b.flags=b.flags&-4097|2,ga=!1,dl=b}}}function Wm(b){for(b=b.return;b!==null&&b.tag!==5&&b.tag!==3&&b.tag!==13;)b=b.return;dl=b}function fl(b){if(b!==dl)return!1;if(!ga)return Wm(b),ga=!0,!1;var T;if((T=b.tag!==3)&&!(T=b.tag!==5)&&(T=b.type,T=T!=="head"&&T!=="body"&&!af(b.type,b.memoizedProps)),T&&(T=oo)){if(Yd(b))throw wo(),Error(r(418));for(;T;)ky(b,T),T=qu(T.nextSibling)}if(Wm(b),b.tag===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));e:{for(b=b.nextSibling,T=0;b;){if(b.nodeType===8){var V=b.data;if(V==="/$"){if(T===0){oo=qu(b.nextSibling);break e}T--}else V!=="$"&&V!=="$!"&&V!=="$?"||T++}b=b.nextSibling}oo=null}}else oo=dl?qu(b.stateNode.nextSibling):null;return!0}function wo(){for(var b=oo;b;)b=qu(b.nextSibling)}function pl(){oo=dl=null,ga=!1}function Mp(b){hl===null?hl=[b]:hl.push(b)}var My=ae.ReactCurrentBatchConfig;function bc(b,T,V){if(b=V.ref,b!==null&&typeof b!="function"&&typeof b!="object"){if(V._owner){if(V=V._owner,V){if(V.tag!==1)throw Error(r(309));var J=V.stateNode}if(!J)throw Error(r(147,b));var de=J,pe=""+b;return T!==null&&T.ref!==null&&typeof T.ref=="function"&&T.ref._stringRef===pe?T.ref:(T=function(Ve){var yt=de.refs;Ve===null?delete yt[pe]:yt[pe]=Ve},T._stringRef=pe,T)}if(typeof b!="string")throw Error(r(284));if(!V._owner)throw Error(r(290,b))}return b}function Xd(b,T){throw b=Object.prototype.toString.call(T),Error(r(31,b==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":b))}function cf(b){var T=b._init;return T(b._payload)}function Go(b){function T(Vt,Ot){if(b){var Gt=Vt.deletions;Gt===null?(Vt.deletions=[Ot],Vt.flags|=16):Gt.push(Ot)}}function V(Vt,Ot){if(!b)return null;for(;Ot!==null;)T(Vt,Ot),Ot=Ot.sibling;return null}function J(Vt,Ot){for(Vt=new Map;Ot!==null;)Ot.key!==null?Vt.set(Ot.key,Ot):Vt.set(Ot.index,Ot),Ot=Ot.sibling;return Vt}function de(Vt,Ot){return Vt=hh(Vt,Ot),Vt.index=0,Vt.sibling=null,Vt}function pe(Vt,Ot,Gt){return Vt.index=Gt,b?(Gt=Vt.alternate,Gt!==null?(Gt=Gt.index,Gt<Ot?(Vt.flags|=2,Ot):Gt):(Vt.flags|=2,Ot)):(Vt.flags|=1048576,Ot)}function Ve(Vt){return b&&Vt.alternate===null&&(Vt.flags|=2),Vt}function yt(Vt,Ot,Gt,Nr){return Ot===null||Ot.tag!==6?(Ot=_0(Gt,Vt.mode,Nr),Ot.return=Vt,Ot):(Ot=de(Ot,Gt),Ot.return=Vt,Ot)}function Ct(Vt,Ot,Gt,Nr){var rn=Gt.type;return rn===ce?Tr(Vt,Ot,Gt.props.children,Nr,Gt.key):Ot!==null&&(Ot.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===Ge&&cf(rn)===Ot.type)?(Nr=de(Ot,Gt.props),Nr.ref=bc(Vt,Ot,Gt),Nr.return=Vt,Nr):(Nr=$y(Gt.type,Gt.key,Gt.props,null,Vt.mode,Nr),Nr.ref=bc(Vt,Ot,Gt),Nr.return=Vt,Nr)}function Zt(Vt,Ot,Gt,Nr){return Ot===null||Ot.tag!==4||Ot.stateNode.containerInfo!==Gt.containerInfo||Ot.stateNode.implementation!==Gt.implementation?(Ot=b0(Gt,Vt.mode,Nr),Ot.return=Vt,Ot):(Ot=de(Ot,Gt.children||[]),Ot.return=Vt,Ot)}function Tr(Vt,Ot,Gt,Nr,rn){return Ot===null||Ot.tag!==7?(Ot=Tf(Gt,Vt.mode,Nr,rn),Ot.return=Vt,Ot):(Ot=de(Ot,Gt),Ot.return=Vt,Ot)}function Mr(Vt,Ot,Gt){if(typeof Ot=="string"&&Ot!==""||typeof Ot=="number")return Ot=_0(""+Ot,Vt.mode,Gt),Ot.return=Vt,Ot;if(typeof Ot=="object"&&Ot!==null){switch(Ot.$$typeof){case ee:return Gt=$y(Ot.type,Ot.key,Ot.props,null,Vt.mode,Gt),Gt.ref=bc(Vt,null,Ot),Gt.return=Vt,Gt;case se:return Ot=b0(Ot,Vt.mode,Gt),Ot.return=Vt,Ot;case Ge:var Nr=Ot._init;return Mr(Vt,Nr(Ot._payload),Gt)}if(zt(Ot)||Le(Ot))return Ot=Tf(Ot,Vt.mode,Gt,null),Ot.return=Vt,Ot;Xd(Vt,Ot)}return null}function Pr(Vt,Ot,Gt,Nr){var rn=Ot!==null?Ot.key:null;if(typeof Gt=="string"&&Gt!==""||typeof Gt=="number")return rn!==null?null:yt(Vt,Ot,""+Gt,Nr);if(typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case ee:return Gt.key===rn?Ct(Vt,Ot,Gt,Nr):null;case se:return Gt.key===rn?Zt(Vt,Ot,Gt,Nr):null;case Ge:return rn=Gt._init,Pr(Vt,Ot,rn(Gt._payload),Nr)}if(zt(Gt)||Le(Gt))return rn!==null?null:Tr(Vt,Ot,Gt,Nr,null);Xd(Vt,Gt)}return null}function Jr(Vt,Ot,Gt,Nr,rn){if(typeof Nr=="string"&&Nr!==""||typeof Nr=="number")return Vt=Vt.get(Gt)||null,yt(Ot,Vt,""+Nr,rn);if(typeof Nr=="object"&&Nr!==null){switch(Nr.$$typeof){case ee:return Vt=Vt.get(Nr.key===null?Gt:Nr.key)||null,Ct(Ot,Vt,Nr,rn);case se:return Vt=Vt.get(Nr.key===null?Gt:Nr.key)||null,Zt(Ot,Vt,Nr,rn);case Ge:var Rn=Nr._init;return Jr(Vt,Ot,Gt,Rn(Nr._payload),rn)}if(zt(Nr)||Le(Nr))return Vt=Vt.get(Gt)||null,Tr(Ot,Vt,Nr,rn,null);Xd(Ot,Nr)}return null}function ln(Vt,Ot,Gt,Nr){for(var rn=null,Rn=null,Fn=Ot,oi=Ot=0,ho=null;Fn!==null&&oi<Gt.length;oi++){Fn.index>oi?(ho=Fn,Fn=null):ho=Fn.sibling;var Ki=Pr(Vt,Fn,Gt[oi],Nr);if(Ki===null){Fn===null&&(Fn=ho);break}b&&Fn&&Ki.alternate===null&&T(Vt,Fn),Ot=pe(Ki,Ot,oi),Rn===null?rn=Ki:Rn.sibling=Ki,Rn=Ki,Fn=ho}if(oi===Gt.length)return V(Vt,Fn),ga&&ul(Vt,oi),rn;if(Fn===null){for(;oi<Gt.length;oi++)Fn=Mr(Vt,Gt[oi],Nr),Fn!==null&&(Ot=pe(Fn,Ot,oi),Rn===null?rn=Fn:Rn.sibling=Fn,Rn=Fn);return ga&&ul(Vt,oi),rn}for(Fn=J(Vt,Fn);oi<Gt.length;oi++)ho=Jr(Fn,Vt,oi,Gt[oi],Nr),ho!==null&&(b&&ho.alternate!==null&&Fn.delete(ho.key===null?oi:ho.key),Ot=pe(ho,Ot,oi),Rn===null?rn=ho:Rn.sibling=ho,Rn=ho);return b&&Fn.forEach(function(Pf){return T(Vt,Pf)}),ga&&ul(Vt,oi),rn}function un(Vt,Ot,Gt,Nr){var rn=Le(Gt);if(typeof rn!="function")throw Error(r(150));if(Gt=rn.call(Gt),Gt==null)throw Error(r(151));for(var Rn=rn=null,Fn=Ot,oi=Ot=0,ho=null,Ki=Gt.next();Fn!==null&&!Ki.done;oi++,Ki=Gt.next()){Fn.index>oi?(ho=Fn,Fn=null):ho=Fn.sibling;var Pf=Pr(Vt,Fn,Ki.value,Nr);if(Pf===null){Fn===null&&(Fn=ho);break}b&&Fn&&Pf.alternate===null&&T(Vt,Fn),Ot=pe(Pf,Ot,oi),Rn===null?rn=Pf:Rn.sibling=Pf,Rn=Pf,Fn=ho}if(Ki.done)return V(Vt,Fn),ga&&ul(Vt,oi),rn;if(Fn===null){for(;!Ki.done;oi++,Ki=Gt.next())Ki=Mr(Vt,Ki.value,Nr),Ki!==null&&(Ot=pe(Ki,Ot,oi),Rn===null?rn=Ki:Rn.sibling=Ki,Rn=Ki);return ga&&ul(Vt,oi),rn}for(Fn=J(Vt,Fn);!Ki.done;oi++,Ki=Gt.next())Ki=Jr(Fn,Vt,oi,Ki.value,Nr),Ki!==null&&(b&&Ki.alternate!==null&&Fn.delete(Ki.key===null?oi:Ki.key),Ot=pe(Ki,Ot,oi),Rn===null?rn=Ki:Rn.sibling=Ki,Rn=Ki);return b&&Fn.forEach(function(_C){return T(Vt,_C)}),ga&&ul(Vt,oi),rn}function ys(Vt,Ot,Gt,Nr){if(typeof Gt=="object"&&Gt!==null&&Gt.type===ce&&Gt.key===null&&(Gt=Gt.props.children),typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case ee:e:{for(var rn=Gt.key,Rn=Ot;Rn!==null;){if(Rn.key===rn){if(rn=Gt.type,rn===ce){if(Rn.tag===7){V(Vt,Rn.sibling),Ot=de(Rn,Gt.props.children),Ot.return=Vt,Vt=Ot;break e}}else if(Rn.elementType===rn||typeof rn=="object"&&rn!==null&&rn.$$typeof===Ge&&cf(rn)===Rn.type){V(Vt,Rn.sibling),Ot=de(Rn,Gt.props),Ot.ref=bc(Vt,Rn,Gt),Ot.return=Vt,Vt=Ot;break e}V(Vt,Rn);break}else T(Vt,Rn);Rn=Rn.sibling}Gt.type===ce?(Ot=Tf(Gt.props.children,Vt.mode,Nr,Gt.key),Ot.return=Vt,Vt=Ot):(Nr=$y(Gt.type,Gt.key,Gt.props,null,Vt.mode,Nr),Nr.ref=bc(Vt,Ot,Gt),Nr.return=Vt,Vt=Nr)}return Ve(Vt);case se:e:{for(Rn=Gt.key;Ot!==null;){if(Ot.key===Rn)if(Ot.tag===4&&Ot.stateNode.containerInfo===Gt.containerInfo&&Ot.stateNode.implementation===Gt.implementation){V(Vt,Ot.sibling),Ot=de(Ot,Gt.children||[]),Ot.return=Vt,Vt=Ot;break e}else{V(Vt,Ot);break}else T(Vt,Ot);Ot=Ot.sibling}Ot=b0(Gt,Vt.mode,Nr),Ot.return=Vt,Vt=Ot}return Ve(Vt);case Ge:return Rn=Gt._init,ys(Vt,Ot,Rn(Gt._payload),Nr)}if(zt(Gt))return ln(Vt,Ot,Gt,Nr);if(Le(Gt))return un(Vt,Ot,Gt,Nr);Xd(Vt,Gt)}return typeof Gt=="string"&&Gt!==""||typeof Gt=="number"?(Gt=""+Gt,Ot!==null&&Ot.tag===6?(V(Vt,Ot.sibling),Ot=de(Ot,Gt),Ot.return=Vt,Vt=Ot):(V(Vt,Ot),Ot=_0(Gt,Vt.mode,Nr),Ot.return=Vt,Vt=Ot),Ve(Vt)):V(Vt,Ot)}return ys}var xi=Go(!0),jp=Go(!1),Ku=El(null),Jd=null,Zu=null,Qd=null;function Yu(){Qd=Zu=Jd=null}function Xu(b){var T=Ku.current;ma(Ku),b._currentValue=T}function Ju(b,T,V){for(;b!==null;){var J=b.alternate;if((b.childLanes&T)!==T?(b.childLanes|=T,J!==null&&(J.childLanes|=T)):J!==null&&(J.childLanes&T)!==T&&(J.childLanes|=T),b===V)break;b=b.return}}function Xt(b,T){Jd=b,Qd=Zu=null,b=b.dependencies,b!==null&&b.firstContext!==null&&((b.lanes&T)!==0&&(lo=!0),b.firstContext=null)}function ur(b){var T=b._currentValue;if(Qd!==b)if(b={context:b,memoizedValue:T,next:null},Zu===null){if(Jd===null)throw Error(r(308));Zu=b,Jd.dependencies={lanes:0,firstContext:b}}else Zu=Zu.next=b;return T}var jl=null;function $i(b){jl===null?jl=[b]:jl.push(b)}function xt(b,T,V,J){var de=T.interleaved;return de===null?(V.next=V,$i(T)):(V.next=de.next,de.next=V),T.interleaved=V,wc(b,J)}function wc(b,T){b.lanes|=T;var V=b.alternate;for(V!==null&&(V.lanes|=T),V=b,b=b.return;b!==null;)b.childLanes|=T,V=b.alternate,V!==null&&(V.childLanes|=T),V=b,b=b.return;return V.tag===3?V.stateNode:null}var Yl=!1;function Op(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jy(b,T){b=b.updateQueue,T.updateQueue===b&&(T.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,effects:b.effects})}function Sc(b,T){return{eventTime:b,lane:T,tag:0,payload:null,callback:null,next:null}}function tu(b,T,V){var J=b.updateQueue;if(J===null)return null;if(J=J.shared,(Ke&2)!==0){var de=J.pending;return de===null?T.next=T:(T.next=de.next,de.next=T),J.pending=T,wc(b,V)}return de=J.interleaved,de===null?(T.next=T,$i(J)):(T.next=de.next,de.next=T),J.interleaved=T,wc(b,V)}function ru(b,T,V){if(T=T.updateQueue,T!==null&&(T=T.shared,(V&4194240)!==0)){var J=T.lanes;J&=b.pendingLanes,V|=J,T.lanes=V,ol(b,V)}}function m0(b,T){var V=b.updateQueue,J=b.alternate;if(J!==null&&(J=J.updateQueue,V===J)){var de=null,pe=null;if(V=V.firstBaseUpdate,V!==null){do{var Ve={eventTime:V.eventTime,lane:V.lane,tag:V.tag,payload:V.payload,callback:V.callback,next:null};pe===null?de=pe=Ve:pe=pe.next=Ve,V=V.next}while(V!==null);pe===null?de=pe=T:pe=pe.next=T}else de=pe=T;V={baseState:J.baseState,firstBaseUpdate:de,lastBaseUpdate:pe,shared:J.shared,effects:J.effects},b.updateQueue=V;return}b=V.lastBaseUpdate,b===null?V.firstBaseUpdate=T:b.next=T,V.lastBaseUpdate=T}function Hm(b,T,V,J){var de=b.updateQueue;Yl=!1;var pe=de.firstBaseUpdate,Ve=de.lastBaseUpdate,yt=de.shared.pending;if(yt!==null){de.shared.pending=null;var Ct=yt,Zt=Ct.next;Ct.next=null,Ve===null?pe=Zt:Ve.next=Zt,Ve=Ct;var Tr=b.alternate;Tr!==null&&(Tr=Tr.updateQueue,yt=Tr.lastBaseUpdate,yt!==Ve&&(yt===null?Tr.firstBaseUpdate=Zt:yt.next=Zt,Tr.lastBaseUpdate=Ct))}if(pe!==null){var Mr=de.baseState;Ve=0,Tr=Zt=Ct=null,yt=pe;do{var Pr=yt.lane,Jr=yt.eventTime;if((J&Pr)===Pr){Tr!==null&&(Tr=Tr.next={eventTime:Jr,lane:0,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null});e:{var ln=b,un=yt;switch(Pr=T,Jr=V,un.tag){case 1:if(ln=un.payload,typeof ln=="function"){Mr=ln.call(Jr,Mr,Pr);break e}Mr=ln;break e;case 3:ln.flags=ln.flags&-65537|128;case 0:if(ln=un.payload,Pr=typeof ln=="function"?ln.call(Jr,Mr,Pr):ln,Pr==null)break e;Mr=ut({},Mr,Pr);break e;case 2:Yl=!0}}yt.callback!==null&&yt.lane!==0&&(b.flags|=64,Pr=de.effects,Pr===null?de.effects=[yt]:Pr.push(yt))}else Jr={eventTime:Jr,lane:Pr,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null},Tr===null?(Zt=Tr=Jr,Ct=Mr):Tr=Tr.next=Jr,Ve|=Pr;if(yt=yt.next,yt===null){if(yt=de.shared.pending,yt===null)break;Pr=yt,yt=Pr.next,Pr.next=null,de.lastBaseUpdate=Pr,de.shared.pending=null}}while(!0);if(Tr===null&&(Ct=Mr),de.baseState=Ct,de.firstBaseUpdate=Zt,de.lastBaseUpdate=Tr,T=de.shared.interleaved,T!==null){de=T;do Ve|=de.lane,de=de.next;while(de!==T)}else pe===null&&(de.shared.lanes=0);Ut|=Ve,b.lanes=Ve,b.memoizedState=Mr}}function Oy(b,T,V){if(b=T.effects,T.effects=null,b!==null)for(T=0;T<b.length;T++){var J=b[T],de=J.callback;if(de!==null){if(J.callback=null,J=V,typeof de!="function")throw Error(r(191,de));de.call(J)}}}var Qu={},Ws=El(Qu),eh=El(Qu),th=El(Qu);function ml(b){if(b===Qu)throw Error(r(174));return b}function uf(b,T){switch(Ji(th,T),Ji(eh,b),Ji(Ws,Qu),b=T.nodeType,b){case 9:case 11:T=(T=T.documentElement)?T.namespaceURI:Bi(null,"");break;default:b=b===8?T.parentNode:T,T=b.namespaceURI||null,b=b.tagName,T=Bi(T,b)}ma(Ws),Ji(Ws,T)}function So(){ma(Ws),ma(eh),ma(th)}function Ac(b){ml(th.current);var T=ml(Ws.current),V=Bi(T,b.type);T!==V&&(Ji(eh,b),Ji(Ws,V))}function Km(b){eh.current===b&&(ma(Ws),ma(eh))}var fi=El(0);function Zm(b){for(var T=b;T!==null;){if(T.tag===13){var V=T.memoizedState;if(V!==null&&(V=V.dehydrated,V===null||V.data==="$?"||V.data==="$!"))return T}else if(T.tag===19&&T.memoizedProps.revealOrder!==void 0){if((T.flags&128)!==0)return T}else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===b)break;for(;T.sibling===null;){if(T.return===null||T.return===b)return null;T=T.return}T.sibling.return=T.return,T=T.sibling}return null}var rh=[];function ji(){for(var b=0;b<rh.length;b++)rh[b]._workInProgressVersionPrimary=null;rh.length=0}var Qn=ae.ReactCurrentDispatcher,Ym=ae.ReactCurrentBatchConfig,Ao=0,ra=null,ua=null,rs=null,ed=!1,Wo=!1,ns=0,Xm=0;function ps(){throw Error(r(321))}function Np(b,T){if(T===null)return!1;for(var V=0;V<T.length&&V<b.length;V++)if(!Gs(b[V],T[V]))return!1;return!0}function Rp(b,T,V,J,de,pe){if(Ao=pe,ra=T,T.memoizedState=null,T.updateQueue=null,T.lanes=0,Qn.current=b===null||b.memoizedState===null?q_:ya,b=V(J,de),Wo){pe=0;do{if(Wo=!1,ns=0,25<=pe)throw Error(r(301));pe+=1,rs=ua=null,T.updateQueue=null,Qn.current=ig,b=V(J,de)}while(Wo)}if(Qn.current=ng,T=ua!==null&&ua.next!==null,Ao=0,rs=ua=ra=null,ed=!1,T)throw Error(r(300));return b}function nu(){var b=ns!==0;return ns=0,b}function Ol(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rs===null?ra.memoizedState=rs=b:rs=rs.next=b,rs}function Cs(){if(ua===null){var b=ra.alternate;b=b!==null?b.memoizedState:null}else b=ua.next;var T=rs===null?ra.memoizedState:rs.next;if(T!==null)rs=T,ua=b;else{if(b===null)throw Error(r(310));ua=b,b={memoizedState:ua.memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},rs===null?ra.memoizedState=rs=b:rs=rs.next=b}return rs}function nh(b,T){return typeof T=="function"?T(b):T}function df(b){var T=Cs(),V=T.queue;if(V===null)throw Error(r(311));V.lastRenderedReducer=b;var J=ua,de=J.baseQueue,pe=V.pending;if(pe!==null){if(de!==null){var Ve=de.next;de.next=pe.next,pe.next=Ve}J.baseQueue=de=pe,V.pending=null}if(de!==null){pe=de.next,J=J.baseState;var yt=Ve=null,Ct=null,Zt=pe;do{var Tr=Zt.lane;if((Ao&Tr)===Tr)Ct!==null&&(Ct=Ct.next={lane:0,action:Zt.action,hasEagerState:Zt.hasEagerState,eagerState:Zt.eagerState,next:null}),J=Zt.hasEagerState?Zt.eagerState:b(J,Zt.action);else{var Mr={lane:Tr,action:Zt.action,hasEagerState:Zt.hasEagerState,eagerState:Zt.eagerState,next:null};Ct===null?(yt=Ct=Mr,Ve=J):Ct=Ct.next=Mr,ra.lanes|=Tr,Ut|=Tr}Zt=Zt.next}while(Zt!==null&&Zt!==pe);Ct===null?Ve=J:Ct.next=yt,Gs(J,T.memoizedState)||(lo=!0),T.memoizedState=J,T.baseState=Ve,T.baseQueue=Ct,V.lastRenderedState=J}if(b=V.interleaved,b!==null){de=b;do pe=de.lane,ra.lanes|=pe,Ut|=pe,de=de.next;while(de!==b)}else de===null&&(V.lanes=0);return[T.memoizedState,V.dispatch]}function Ip(b){var T=Cs(),V=T.queue;if(V===null)throw Error(r(311));V.lastRenderedReducer=b;var J=V.dispatch,de=V.pending,pe=T.memoizedState;if(de!==null){V.pending=null;var Ve=de=de.next;do pe=b(pe,Ve.action),Ve=Ve.next;while(Ve!==de);Gs(pe,T.memoizedState)||(lo=!0),T.memoizedState=pe,T.baseQueue===null&&(T.baseState=pe),V.lastRenderedState=pe}return[pe,J]}function Jm(){}function ms(b,T){var V=ra,J=Cs(),de=T(),pe=!Gs(J.memoizedState,de);if(pe&&(J.memoizedState=de,lo=!0),J=J.queue,ah(hf.bind(null,V,J,b),[b]),J.getSnapshot!==T||pe||rs!==null&&rs.memoizedState.tag&1){if(V.flags|=2048,td(9,eg.bind(null,V,J,de,T),void 0,null),it===null)throw Error(r(349));(Ao&30)!==0||Qm(V,T,de)}return de}function Qm(b,T,V){b.flags|=16384,b={getSnapshot:T,value:V},T=ra.updateQueue,T===null?(T={lastEffect:null,stores:null},ra.updateQueue=T,T.stores=[b]):(V=T.stores,V===null?T.stores=[b]:V.push(b))}function eg(b,T,V,J){T.value=V,T.getSnapshot=J,iu(T)&&Dp(b)}function hf(b,T,V){return V(function(){iu(T)&&Dp(b)})}function iu(b){var T=b.getSnapshot;b=b.value;try{var V=T();return!Gs(b,V)}catch{return!0}}function Dp(b){var T=wc(b,1);T!==null&&wn(T,b,1,-1)}function Xl(b){var T=Ol();return typeof b=="function"&&(b=b()),T.memoizedState=T.baseState=b,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:b},T.queue=b,b=b.dispatch=Fp.bind(null,ra,b),[T.memoizedState,b]}function td(b,T,V,J){return b={tag:b,create:T,destroy:V,deps:J,next:null},T=ra.updateQueue,T===null?(T={lastEffect:null,stores:null},ra.updateQueue=T,T.lastEffect=b.next=b):(V=T.lastEffect,V===null?T.lastEffect=b.next=b:(J=V.next,V.next=b,b.next=J,T.lastEffect=b)),b}function ih(){return Cs().memoizedState}function ff(b,T,V,J){var de=Ol();ra.flags|=b,de.memoizedState=td(1|T,V,void 0,J===void 0?null:J)}function pf(b,T,V,J){var de=Cs();J=J===void 0?null:J;var pe=void 0;if(ua!==null){var Ve=ua.memoizedState;if(pe=Ve.destroy,J!==null&&Np(J,Ve.deps)){de.memoizedState=td(T,V,pe,J);return}}ra.flags|=b,de.memoizedState=td(1|T,V,pe,J)}function mf(b,T){return ff(8390656,8,b,T)}function ah(b,T){return pf(2048,8,b,T)}function tg(b,T){return pf(4,2,b,T)}function Lp(b,T){return pf(4,4,b,T)}function Ny(b,T){if(typeof T=="function")return b=b(),T(b),function(){T(null)};if(T!=null)return b=b(),T.current=b,function(){T.current=null}}function rg(b,T,V){return V=V!=null?V.concat([b]):null,pf(4,4,Ny.bind(null,T,b),V)}function sh(){}function Ry(b,T){var V=Cs();T=T===void 0?null:T;var J=V.memoizedState;return J!==null&&T!==null&&Np(T,J[1])?J[0]:(V.memoizedState=[b,T],b)}function Iy(b,T){var V=Cs();T=T===void 0?null:T;var J=V.memoizedState;return J!==null&&T!==null&&Np(T,J[1])?J[0]:(b=b(),V.memoizedState=[b,T],b)}function Dy(b,T,V){return(Ao&21)===0?(b.baseState&&(b.baseState=!1,lo=!0),b.memoizedState=V):(Gs(V,T)||(V=$s(),ra.lanes|=V,Ut|=V,b.baseState=!0),T)}function g0(b,T){var V=vi;vi=V!==0&&4>V?V:4,b(!0);var J=Ym.transition;Ym.transition={};try{b(!1),T()}finally{vi=V,Ym.transition=J}}function Ly(){return Cs().memoizedState}function zp(b,T,V){var J=Zr(b);if(V={lane:J,action:V,hasEagerState:!1,eagerState:null,next:null},To(b))gf(T,V);else if(V=xt(b,T,V,J),V!==null){var de=Zn();wn(V,b,J,de),zy(V,T,J)}}function Fp(b,T,V){var J=Zr(b),de={lane:J,action:V,hasEagerState:!1,eagerState:null,next:null};if(To(b))gf(T,de);else{var pe=b.alternate;if(b.lanes===0&&(pe===null||pe.lanes===0)&&(pe=T.lastRenderedReducer,pe!==null))try{var Ve=T.lastRenderedState,yt=pe(Ve,V);if(de.hasEagerState=!0,de.eagerState=yt,Gs(yt,Ve)){var Ct=T.interleaved;Ct===null?(de.next=de,$i(T)):(de.next=Ct.next,Ct.next=de),T.interleaved=de;return}}catch{}finally{}V=xt(b,T,de,J),V!==null&&(de=Zn(),wn(V,b,J,de),zy(V,T,J))}}function To(b){var T=b.alternate;return b===ra||T!==null&&T===ra}function gf(b,T){Wo=ed=!0;var V=b.pending;V===null?T.next=T:(T.next=V.next,V.next=T),b.pending=T}function zy(b,T,V){if((V&4194240)!==0){var J=T.lanes;J&=b.pendingLanes,V|=J,T.lanes=V,ol(b,V)}}var ng={readContext:ur,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},q_={readContext:ur,useCallback:function(b,T){return Ol().memoizedState=[b,T===void 0?null:T],b},useContext:ur,useEffect:mf,useImperativeHandle:function(b,T,V){return V=V!=null?V.concat([b]):null,ff(4194308,4,Ny.bind(null,T,b),V)},useLayoutEffect:function(b,T){return ff(4194308,4,b,T)},useInsertionEffect:function(b,T){return ff(4,2,b,T)},useMemo:function(b,T){var V=Ol();return T=T===void 0?null:T,b=b(),V.memoizedState=[b,T],b},useReducer:function(b,T,V){var J=Ol();return T=V!==void 0?V(T):T,J.memoizedState=J.baseState=T,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:T},J.queue=b,b=b.dispatch=zp.bind(null,ra,b),[J.memoizedState,b]},useRef:function(b){var T=Ol();return b={current:b},T.memoizedState=b},useState:Xl,useDebugValue:sh,useDeferredValue:function(b){return Ol().memoizedState=b},useTransition:function(){var b=Xl(!1),T=b[0];return b=g0.bind(null,b[1]),Ol().memoizedState=b,[T,b]},useMutableSource:function(){},useSyncExternalStore:function(b,T,V){var J=ra,de=Ol();if(ga){if(V===void 0)throw Error(r(407));V=V()}else{if(V=T(),it===null)throw Error(r(349));(Ao&30)!==0||Qm(J,T,V)}de.memoizedState=V;var pe={value:V,getSnapshot:T};return de.queue=pe,mf(hf.bind(null,J,pe,b),[b]),J.flags|=2048,td(9,eg.bind(null,J,pe,V,T),void 0,null),V},useId:function(){var b=Ol(),T=it.identifierPrefix;if(ga){var V=so,J=Zl;V=(J&~(1<<32-ds(J)-1)).toString(32)+V,T=":"+T+"R"+V,V=ns++,0<V&&(T+="H"+V.toString(32)),T+=":"}else V=Xm++,T=":"+T+"r"+V.toString(32)+":";return b.memoizedState=T},unstable_isNewReconciler:!1},ya={readContext:ur,useCallback:Ry,useContext:ur,useEffect:ah,useImperativeHandle:rg,useInsertionEffect:tg,useLayoutEffect:Lp,useMemo:Iy,useReducer:df,useRef:ih,useState:function(){return df(nh)},useDebugValue:sh,useDeferredValue:function(b){var T=Cs();return Dy(T,ua.memoizedState,b)},useTransition:function(){var b=df(nh)[0],T=Cs().memoizedState;return[b,T]},useMutableSource:Jm,useSyncExternalStore:ms,useId:Ly,unstable_isNewReconciler:!1},ig={readContext:ur,useCallback:Ry,useContext:ur,useEffect:ah,useImperativeHandle:rg,useInsertionEffect:tg,useLayoutEffect:Lp,useMemo:Iy,useReducer:Ip,useRef:ih,useState:function(){return Ip(nh)},useDebugValue:sh,useDeferredValue:function(b){var T=Cs();return ua===null?T.memoizedState=b:Dy(T,ua.memoizedState,b)},useTransition:function(){var b=Ip(nh)[0],T=Cs().memoizedState;return[b,T]},useMutableSource:Jm,useSyncExternalStore:ms,useId:Ly,unstable_isNewReconciler:!1};function Jl(b,T){if(b&&b.defaultProps){T=ut({},T),b=b.defaultProps;for(var V in b)T[V]===void 0&&(T[V]=b[V]);return T}return T}function Bp(b,T,V,J){T=b.memoizedState,V=V(J,T),V=V==null?T:ut({},T,V),b.memoizedState=V,b.lanes===0&&(b.updateQueue.baseState=V)}var rd={isMounted:function(b){return(b=b._reactInternals)?Ye(b)===b:!1},enqueueSetState:function(b,T,V){b=b._reactInternals;var J=Zn(),de=Zr(b),pe=Sc(J,de);pe.payload=T,V!=null&&(pe.callback=V),T=tu(b,pe,de),T!==null&&(wn(T,b,de,J),ru(T,b,de))},enqueueReplaceState:function(b,T,V){b=b._reactInternals;var J=Zn(),de=Zr(b),pe=Sc(J,de);pe.tag=1,pe.payload=T,V!=null&&(pe.callback=V),T=tu(b,pe,de),T!==null&&(wn(T,b,de,J),ru(T,b,de))},enqueueForceUpdate:function(b,T){b=b._reactInternals;var V=Zn(),J=Zr(b),de=Sc(V,J);de.tag=2,T!=null&&(de.callback=T),T=tu(b,de,J),T!==null&&(wn(T,b,J,V),ru(T,b,J))}};function Fy(b,T,V,J,de,pe,Ve){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(J,pe,Ve):T.prototype&&T.prototype.isPureReactComponent?!vp(V,J)||!vp(de,pe):!0}function yf(b,T,V){var J=!1,de=kl,pe=T.contextType;return typeof pe=="object"&&pe!==null?pe=ur(pe):(de=$o(T)?Qc:Is.current,J=T.contextTypes,pe=(J=J!=null)?Kl(b,de):kl),T=new T(V,pe),b.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=rd,b.stateNode=T,T._reactInternals=b,J&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=de,b.__reactInternalMemoizedMaskedChildContext=pe),T}function Vp(b,T,V,J){b=T.state,typeof T.componentWillReceiveProps=="function"&&T.componentWillReceiveProps(V,J),typeof T.UNSAFE_componentWillReceiveProps=="function"&&T.UNSAFE_componentWillReceiveProps(V,J),T.state!==b&&rd.enqueueReplaceState(T,T.state,null)}function Nl(b,T,V,J){var de=b.stateNode;de.props=V,de.state=b.memoizedState,de.refs={},Op(b);var pe=T.contextType;typeof pe=="object"&&pe!==null?de.context=ur(pe):(pe=$o(T)?Qc:Is.current,de.context=Kl(b,pe)),de.state=b.memoizedState,pe=T.getDerivedStateFromProps,typeof pe=="function"&&(Bp(b,T,pe,V),de.state=b.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof de.getSnapshotBeforeUpdate=="function"||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(T=de.state,typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount(),T!==de.state&&rd.enqueueReplaceState(de,de.state,null),Hm(b,V,de,J),de.state=b.memoizedState),typeof de.componentDidMount=="function"&&(b.flags|=4194308)}function Tc(b,T){try{var V="",J=T;do V+=Cr(J),J=J.return;while(J);var de=V}catch(pe){de=`
Error generating stack: `+pe.message+`
`+pe.stack}return{value:b,source:T,stack:de,digest:null}}function da(b,T,V){return{value:b,source:null,stack:V??null,digest:T??null}}function Ho(b,T){try{console.error(T.value)}catch(V){setTimeout(function(){throw V})}}var vf=typeof WeakMap=="function"?WeakMap:Map;function xf(b,T,V){V=Sc(-1,V),V.tag=3,V.payload={element:null};var J=T.value;return V.callback=function(){tr||(tr=!0,gr=J),Ho(b,T)},V}function By(b,T,V){V=Sc(-1,V),V.tag=3;var J=b.type.getDerivedStateFromError;if(typeof J=="function"){var de=T.value;V.payload=function(){return J(de)},V.callback=function(){Ho(b,T)}}var pe=b.stateNode;return pe!==null&&typeof pe.componentDidCatch=="function"&&(V.callback=function(){Ho(b,T),typeof J!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var Ve=T.stack;this.componentDidCatch(T.value,{componentStack:Ve!==null?Ve:""})}),V}function Vy(b,T,V){var J=b.pingCache;if(J===null){J=b.pingCache=new vf;var de=new Set;J.set(T,de)}else de=J.get(T),de===void 0&&(de=new Set,J.set(T,de));de.has(V)||(de.add(V),b=uh.bind(null,b,T,V),T.then(b,b))}function _f(b){do{var T;if((T=b.tag===13)&&(T=b.memoizedState,T=T!==null?T.dehydrated!==null:!0),T)return b;b=b.return}while(b!==null);return null}function ag(b,T,V,J,de){return(b.mode&1)===0?(b===T?b.flags|=65536:(b.flags|=128,V.flags|=131072,V.flags&=-52805,V.tag===1&&(V.alternate===null?V.tag=17:(T=Sc(-1,1),T.tag=2,tu(V,T,1))),V.lanes|=1),b):(b.flags|=65536,b.lanes=de,b)}var G_=ae.ReactCurrentOwner,lo=!1;function Hs(b,T,V,J){T.child=b===null?jp(T,null,V,J):xi(T,b.child,V,J)}function nd(b,T,V,J,de){V=V.render;var pe=T.ref;return Xt(T,de),J=Rp(b,T,V,J,pe,de),V=nu(),b!==null&&!lo?(T.updateQueue=b.updateQueue,T.flags&=-2053,b.lanes&=~de,Zo(b,T,de)):(ga&&V&&kp(T),T.flags|=1,Hs(b,T,J,de),T.child)}function id(b,T,V,J,de){if(b===null){var pe=V.type;return typeof pe=="function"&&!W_(pe)&&pe.defaultProps===void 0&&V.compare===null&&V.defaultProps===void 0?(T.tag=15,T.type=pe,Pc(b,T,pe,J,de)):(b=$y(V.type,null,J,T,T.mode,de),b.ref=T.ref,b.return=T,T.child=b)}if(pe=b.child,(b.lanes&de)===0){var Ve=pe.memoizedProps;if(V=V.compare,V=V!==null?V:vp,V(Ve,J)&&b.ref===T.ref)return Zo(b,T,de)}return T.flags|=1,b=hh(pe,J),b.ref=T.ref,b.return=T,T.child=b}function Pc(b,T,V,J,de){if(b!==null){var pe=b.memoizedProps;if(vp(pe,J)&&b.ref===T.ref)if(lo=!1,T.pendingProps=J=pe,(b.lanes&de)!==0)(b.flags&131072)!==0&&(lo=!0);else return T.lanes=b.lanes,Zo(b,T,de)}return su(b,T,V,J,de)}function Rl(b,T,V){var J=T.pendingProps,de=J.children,pe=b!==null?b.memoizedState:null;if(J.mode==="hidden")if((T.mode&1)===0)T.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ji(jt,Mt),Mt|=V;else{if((V&1073741824)===0)return b=pe!==null?pe.baseLanes|V:V,T.lanes=T.childLanes=1073741824,T.memoizedState={baseLanes:b,cachePool:null,transitions:null},T.updateQueue=null,Ji(jt,Mt),Mt|=b,null;T.memoizedState={baseLanes:0,cachePool:null,transitions:null},J=pe!==null?pe.baseLanes:V,Ji(jt,Mt),Mt|=J}else pe!==null?(J=pe.baseLanes|V,T.memoizedState=null):J=V,Ji(jt,Mt),Mt|=J;return Hs(b,T,de,V),T.child}function au(b,T){var V=T.ref;(b===null&&V!==null||b!==null&&b.ref!==V)&&(T.flags|=512,T.flags|=2097152)}function su(b,T,V,J,de){var pe=$o(V)?Qc:Is.current;return pe=Kl(T,pe),Xt(T,de),V=Rp(b,T,V,J,pe,de),J=nu(),b!==null&&!lo?(T.updateQueue=b.updateQueue,T.flags&=-2053,b.lanes&=~de,Zo(b,T,de)):(ga&&J&&kp(T),T.flags|=1,Hs(b,T,V,de),T.child)}function ou(b,T,V,J,de){if($o(V)){var pe=!0;Gd(T)}else pe=!1;if(Xt(T,de),T.stateNode===null)co(b,T),yf(T,V,J),Nl(T,V,J,de),J=!0;else if(b===null){var Ve=T.stateNode,yt=T.memoizedProps;Ve.props=yt;var Ct=Ve.context,Zt=V.contextType;typeof Zt=="object"&&Zt!==null?Zt=ur(Zt):(Zt=$o(V)?Qc:Is.current,Zt=Kl(T,Zt));var Tr=V.getDerivedStateFromProps,Mr=typeof Tr=="function"||typeof Ve.getSnapshotBeforeUpdate=="function";Mr||typeof Ve.UNSAFE_componentWillReceiveProps!="function"&&typeof Ve.componentWillReceiveProps!="function"||(yt!==J||Ct!==Zt)&&Vp(T,Ve,J,Zt),Yl=!1;var Pr=T.memoizedState;Ve.state=Pr,Hm(T,J,Ve,de),Ct=T.memoizedState,yt!==J||Pr!==Ct||Uo.current||Yl?(typeof Tr=="function"&&(Bp(T,V,Tr,J),Ct=T.memoizedState),(yt=Yl||Fy(T,V,yt,J,Pr,Ct,Zt))?(Mr||typeof Ve.UNSAFE_componentWillMount!="function"&&typeof Ve.componentWillMount!="function"||(typeof Ve.componentWillMount=="function"&&Ve.componentWillMount(),typeof Ve.UNSAFE_componentWillMount=="function"&&Ve.UNSAFE_componentWillMount()),typeof Ve.componentDidMount=="function"&&(T.flags|=4194308)):(typeof Ve.componentDidMount=="function"&&(T.flags|=4194308),T.memoizedProps=J,T.memoizedState=Ct),Ve.props=J,Ve.state=Ct,Ve.context=Zt,J=yt):(typeof Ve.componentDidMount=="function"&&(T.flags|=4194308),J=!1)}else{Ve=T.stateNode,jy(b,T),yt=T.memoizedProps,Zt=T.type===T.elementType?yt:Jl(T.type,yt),Ve.props=Zt,Mr=T.pendingProps,Pr=Ve.context,Ct=V.contextType,typeof Ct=="object"&&Ct!==null?Ct=ur(Ct):(Ct=$o(V)?Qc:Is.current,Ct=Kl(T,Ct));var Jr=V.getDerivedStateFromProps;(Tr=typeof Jr=="function"||typeof Ve.getSnapshotBeforeUpdate=="function")||typeof Ve.UNSAFE_componentWillReceiveProps!="function"&&typeof Ve.componentWillReceiveProps!="function"||(yt!==Mr||Pr!==Ct)&&Vp(T,Ve,J,Ct),Yl=!1,Pr=T.memoizedState,Ve.state=Pr,Hm(T,J,Ve,de);var ln=T.memoizedState;yt!==Mr||Pr!==ln||Uo.current||Yl?(typeof Jr=="function"&&(Bp(T,V,Jr,J),ln=T.memoizedState),(Zt=Yl||Fy(T,V,Zt,J,Pr,ln,Ct)||!1)?(Tr||typeof Ve.UNSAFE_componentWillUpdate!="function"&&typeof Ve.componentWillUpdate!="function"||(typeof Ve.componentWillUpdate=="function"&&Ve.componentWillUpdate(J,ln,Ct),typeof Ve.UNSAFE_componentWillUpdate=="function"&&Ve.UNSAFE_componentWillUpdate(J,ln,Ct)),typeof Ve.componentDidUpdate=="function"&&(T.flags|=4),typeof Ve.getSnapshotBeforeUpdate=="function"&&(T.flags|=1024)):(typeof Ve.componentDidUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=4),typeof Ve.getSnapshotBeforeUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=1024),T.memoizedProps=J,T.memoizedState=ln),Ve.props=J,Ve.state=ln,Ve.context=Ct,J=Zt):(typeof Ve.componentDidUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=4),typeof Ve.getSnapshotBeforeUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=1024),J=!1)}return Uy(b,T,V,J,pe,de)}function Uy(b,T,V,J,de,pe){au(b,T);var Ve=(T.flags&128)!==0;if(!J&&!Ve)return de&&Wd(T,V,!1),Zo(b,T,pe);J=T.stateNode,G_.current=T;var yt=Ve&&typeof V.getDerivedStateFromError!="function"?null:J.render();return T.flags|=1,b!==null&&Ve?(T.child=xi(T,b.child,null,pe),T.child=xi(T,null,yt,pe)):Hs(b,T,yt,pe),T.memoizedState=J.state,de&&Wd(T,V,!0),T.child}function y0(b){var T=b.stateNode;T.pendingContext?Ty(b,T.pendingContext,T.pendingContext!==T.context):T.context&&Ty(b,T.context,!1),uf(b,T.containerInfo)}function v0(b,T,V,J,de){return pl(),Mp(de),T.flags|=256,Hs(b,T,V,J),T.child}var bf={dehydrated:null,treeContext:null,retryLane:0};function sg(b){return{baseLanes:b,cachePool:null,transitions:null}}function Ks(b,T,V){var J=T.pendingProps,de=fi.current,pe=!1,Ve=(T.flags&128)!==0,yt;if((yt=Ve)||(yt=b!==null&&b.memoizedState===null?!1:(de&2)!==0),yt?(pe=!0,T.flags&=-129):(b===null||b.memoizedState!==null)&&(de|=1),Ji(fi,de&1),b===null)return lf(T),b=T.memoizedState,b!==null&&(b=b.dehydrated,b!==null)?((T.mode&1)===0?T.lanes=1:b.data==="$!"?T.lanes=8:T.lanes=1073741824,null):(Ve=J.children,b=J.fallback,pe?(J=T.mode,pe=T.child,Ve={mode:"hidden",children:Ve},(J&1)===0&&pe!==null?(pe.childLanes=0,pe.pendingProps=Ve):pe=qy(Ve,J,0,null),b=Tf(b,J,V,null),pe.return=T,b.return=T,pe.sibling=b,T.child=pe,T.child.memoizedState=sg(V),T.memoizedState=bf,b):ad(T,Ve));if(de=b.memoizedState,de!==null&&(yt=de.dehydrated,yt!==null))return x0(b,T,Ve,J,yt,de,V);if(pe){pe=J.fallback,Ve=T.mode,de=b.child,yt=de.sibling;var Ct={mode:"hidden",children:J.children};return(Ve&1)===0&&T.child!==de?(J=T.child,J.childLanes=0,J.pendingProps=Ct,T.deletions=null):(J=hh(de,Ct),J.subtreeFlags=de.subtreeFlags&14680064),yt!==null?pe=hh(yt,pe):(pe=Tf(pe,Ve,V,null),pe.flags|=2),pe.return=T,J.return=T,J.sibling=pe,T.child=J,J=pe,pe=T.child,Ve=b.child.memoizedState,Ve=Ve===null?sg(V):{baseLanes:Ve.baseLanes|V,cachePool:null,transitions:Ve.transitions},pe.memoizedState=Ve,pe.childLanes=b.childLanes&~V,T.memoizedState=bf,J}return pe=b.child,b=pe.sibling,J=hh(pe,{mode:"visible",children:J.children}),(T.mode&1)===0&&(J.lanes=V),J.return=T,J.sibling=null,b!==null&&(V=T.deletions,V===null?(T.deletions=[b],T.flags|=16):V.push(b)),T.child=J,T.memoizedState=null,J}function ad(b,T){return T=qy({mode:"visible",children:T},b.mode,0,null),T.return=b,b.child=T}function Up(b,T,V,J){return J!==null&&Mp(J),xi(T,b.child,null,V),b=ad(T,T.pendingProps.children),b.flags|=2,T.memoizedState=null,b}function x0(b,T,V,J,de,pe,Ve){if(V)return T.flags&256?(T.flags&=-257,J=da(Error(r(422))),Up(b,T,Ve,J)):T.memoizedState!==null?(T.child=b.child,T.flags|=128,null):(pe=J.fallback,de=T.mode,J=qy({mode:"visible",children:J.children},de,0,null),pe=Tf(pe,de,Ve,null),pe.flags|=2,J.return=T,pe.return=T,J.sibling=pe,T.child=J,(T.mode&1)!==0&&xi(T,b.child,null,Ve),T.child.memoizedState=sg(Ve),T.memoizedState=bf,pe);if((T.mode&1)===0)return Up(b,T,Ve,null);if(de.data==="$!"){if(J=de.nextSibling&&de.nextSibling.dataset,J)var yt=J.dgst;return J=yt,pe=Error(r(419)),J=da(pe,J,void 0),Up(b,T,Ve,J)}if(yt=(Ve&b.childLanes)!==0,lo||yt){if(J=it,J!==null){switch(Ve&-Ve){case 4:de=2;break;case 16:de=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:de=32;break;case 536870912:de=268435456;break;default:de=0}de=(de&(J.suspendedLanes|Ve))!==0?0:de,de!==0&&de!==pe.retryLane&&(pe.retryLane=de,wc(b,de),wn(J,b,de,-1))}return Nn(),J=da(Error(r(421))),Up(b,T,Ve,J)}return de.data==="$?"?(T.flags|=128,T.child=b.child,T=dh.bind(null,b),de._reactRetry=T,null):(b=pe.treeContext,oo=qu(de.nextSibling),dl=T,ga=!0,hl=null,b!==null&&(bo[mr++]=Zl,bo[mr++]=so,bo[mr++]=eu,Zl=b.id,so=b.overflow,eu=T),T=ad(T,J.children),T.flags|=4096,T)}function oh(b,T,V){b.lanes|=T;var J=b.alternate;J!==null&&(J.lanes|=T),Ju(b.return,T,V)}function wf(b,T,V,J,de){var pe=b.memoizedState;pe===null?b.memoizedState={isBackwards:T,rendering:null,renderingStartTime:0,last:J,tail:V,tailMode:de}:(pe.isBackwards=T,pe.rendering=null,pe.renderingStartTime=0,pe.last=J,pe.tail=V,pe.tailMode=de)}function Ko(b,T,V){var J=T.pendingProps,de=J.revealOrder,pe=J.tail;if(Hs(b,T,J.children,V),J=fi.current,(J&2)!==0)J=J&1|2,T.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=T.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&oh(b,V,T);else if(b.tag===19)oh(b,V,T);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===T)break e;for(;b.sibling===null;){if(b.return===null||b.return===T)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}J&=1}if(Ji(fi,J),(T.mode&1)===0)T.memoizedState=null;else switch(de){case"forwards":for(V=T.child,de=null;V!==null;)b=V.alternate,b!==null&&Zm(b)===null&&(de=V),V=V.sibling;V=de,V===null?(de=T.child,T.child=null):(de=V.sibling,V.sibling=null),wf(T,!1,de,V,pe);break;case"backwards":for(V=null,de=T.child,T.child=null;de!==null;){if(b=de.alternate,b!==null&&Zm(b)===null){T.child=de;break}b=de.sibling,de.sibling=V,V=de,de=b}wf(T,!0,V,null,pe);break;case"together":wf(T,!1,null,null,void 0);break;default:T.memoizedState=null}return T.child}function co(b,T){(T.mode&1)===0&&b!==null&&(b.alternate=null,T.alternate=null,T.flags|=2)}function Zo(b,T,V){if(b!==null&&(T.dependencies=b.dependencies),Ut|=T.lanes,(V&T.childLanes)===0)return null;if(b!==null&&T.child!==b.child)throw Error(r(153));if(T.child!==null){for(b=T.child,V=hh(b,b.pendingProps),T.child=V,V.return=T;b.sibling!==null;)b=b.sibling,V=V.sibling=hh(b,b.pendingProps),V.return=T;V.sibling=null}return T.child}function lh(b,T,V){switch(T.tag){case 3:y0(T),pl();break;case 5:Ac(T);break;case 1:$o(T.type)&&Gd(T);break;case 4:uf(T,T.stateNode.containerInfo);break;case 10:var J=T.type._context,de=T.memoizedProps.value;Ji(Ku,J._currentValue),J._currentValue=de;break;case 13:if(J=T.memoizedState,J!==null)return J.dehydrated!==null?(Ji(fi,fi.current&1),T.flags|=128,null):(V&T.child.childLanes)!==0?Ks(b,T,V):(Ji(fi,fi.current&1),b=Zo(b,T,V),b!==null?b.sibling:null);Ji(fi,fi.current&1);break;case 19:if(J=(V&T.childLanes)!==0,(b.flags&128)!==0){if(J)return Ko(b,T,V);T.flags|=128}if(de=T.memoizedState,de!==null&&(de.rendering=null,de.tail=null,de.lastEffect=null),Ji(fi,fi.current),J)break;return null;case 22:case 23:return T.lanes=0,Rl(b,T,V)}return Zo(b,T,V)}var sd,$p,Kn,lu;sd=function(b,T){for(var V=T.child;V!==null;){if(V.tag===5||V.tag===6)b.appendChild(V.stateNode);else if(V.tag!==4&&V.child!==null){V.child.return=V,V=V.child;continue}if(V===T)break;for(;V.sibling===null;){if(V.return===null||V.return===T)return;V=V.return}V.sibling.return=V.return,V=V.sibling}},$p=function(){},Kn=function(b,T,V,J){var de=b.memoizedProps;if(de!==J){b=T.stateNode,ml(Ws.current);var pe=null;switch(V){case"input":de=Pt(b,de),J=Pt(b,J),pe=[];break;case"select":de=ut({},de,{value:void 0}),J=ut({},J,{value:void 0}),pe=[];break;case"textarea":de=fr(b,de),J=fr(b,J),pe=[];break;default:typeof de.onClick!="function"&&typeof J.onClick=="function"&&(b.onclick=Vd)}Os(V,J);var Ve;V=null;for(Zt in de)if(!J.hasOwnProperty(Zt)&&de.hasOwnProperty(Zt)&&de[Zt]!=null)if(Zt==="style"){var yt=de[Zt];for(Ve in yt)yt.hasOwnProperty(Ve)&&(V||(V={}),V[Ve]="")}else Zt!=="dangerouslySetInnerHTML"&&Zt!=="children"&&Zt!=="suppressContentEditableWarning"&&Zt!=="suppressHydrationWarning"&&Zt!=="autoFocus"&&(a.hasOwnProperty(Zt)?pe||(pe=[]):(pe=pe||[]).push(Zt,null));for(Zt in J){var Ct=J[Zt];if(yt=de!=null?de[Zt]:void 0,J.hasOwnProperty(Zt)&&Ct!==yt&&(Ct!=null||yt!=null))if(Zt==="style")if(yt){for(Ve in yt)!yt.hasOwnProperty(Ve)||Ct&&Ct.hasOwnProperty(Ve)||(V||(V={}),V[Ve]="");for(Ve in Ct)Ct.hasOwnProperty(Ve)&&yt[Ve]!==Ct[Ve]&&(V||(V={}),V[Ve]=Ct[Ve])}else V||(pe||(pe=[]),pe.push(Zt,V)),V=Ct;else Zt==="dangerouslySetInnerHTML"?(Ct=Ct?Ct.__html:void 0,yt=yt?yt.__html:void 0,Ct!=null&&yt!==Ct&&(pe=pe||[]).push(Zt,Ct)):Zt==="children"?typeof Ct!="string"&&typeof Ct!="number"||(pe=pe||[]).push(Zt,""+Ct):Zt!=="suppressContentEditableWarning"&&Zt!=="suppressHydrationWarning"&&(a.hasOwnProperty(Zt)?(Ct!=null&&Zt==="onScroll"&&ca("scroll",b),pe||yt===Ct||(pe=[])):(pe=pe||[]).push(Zt,Ct))}V&&(pe=pe||[]).push("style",V);var Zt=pe;(T.updateQueue=Zt)&&(T.flags|=4)}},lu=function(b,T,V,J){V!==J&&(T.flags|=4)};function qp(b,T){if(!ga)switch(b.tailMode){case"hidden":T=b.tail;for(var V=null;T!==null;)T.alternate!==null&&(V=T),T=T.sibling;V===null?b.tail=null:V.sibling=null;break;case"collapsed":V=b.tail;for(var J=null;V!==null;)V.alternate!==null&&(J=V),V=V.sibling;J===null?T||b.tail===null?b.tail=null:b.tail.sibling=null:J.sibling=null}}function uo(b){var T=b.alternate!==null&&b.alternate.child===b.child,V=0,J=0;if(T)for(var de=b.child;de!==null;)V|=de.lanes|de.childLanes,J|=de.subtreeFlags&14680064,J|=de.flags&14680064,de.return=b,de=de.sibling;else for(de=b.child;de!==null;)V|=de.lanes|de.childLanes,J|=de.subtreeFlags,J|=de.flags,de.return=b,de=de.sibling;return b.subtreeFlags|=J,b.childLanes=V,T}function og(b,T,V){var J=T.pendingProps;switch(Ey(T),T.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return uo(T),null;case 1:return $o(T.type)&&$m(),uo(T),null;case 3:return J=T.stateNode,So(),ma(Uo),ma(Is),ji(),J.pendingContext&&(J.context=J.pendingContext,J.pendingContext=null),(b===null||b.child===null)&&(fl(T)?T.flags|=4:b===null||b.memoizedState.isDehydrated&&(T.flags&256)===0||(T.flags|=1024,hl!==null&&(si(hl),hl=null))),$p(b,T),uo(T),null;case 5:Km(T);var de=ml(th.current);if(V=T.type,b!==null&&T.stateNode!=null)Kn(b,T,V,J,de),b.ref!==T.ref&&(T.flags|=512,T.flags|=2097152);else{if(!J){if(T.stateNode===null)throw Error(r(166));return uo(T),null}if(b=ml(Ws.current),fl(T)){J=T.stateNode,V=T.type;var pe=T.memoizedProps;switch(J[Pl]=T,J[$d]=pe,b=(T.mode&1)!==0,V){case"dialog":ca("cancel",J),ca("close",J);break;case"iframe":case"object":case"embed":ca("load",J);break;case"video":case"audio":for(de=0;de<wp.length;de++)ca(wp[de],J);break;case"source":ca("error",J);break;case"img":case"image":case"link":ca("error",J),ca("load",J);break;case"details":ca("toggle",J);break;case"input":nn(J,pe),ca("invalid",J);break;case"select":J._wrapperState={wasMultiple:!!pe.multiple},ca("invalid",J);break;case"textarea":pr(J,pe),ca("invalid",J)}Os(V,pe),de=null;for(var Ve in pe)if(pe.hasOwnProperty(Ve)){var yt=pe[Ve];Ve==="children"?typeof yt=="string"?J.textContent!==yt&&(pe.suppressHydrationWarning!==!0&&nf(J.textContent,yt,b),de=["children",yt]):typeof yt=="number"&&J.textContent!==""+yt&&(pe.suppressHydrationWarning!==!0&&nf(J.textContent,yt,b),de=["children",""+yt]):a.hasOwnProperty(Ve)&&yt!=null&&Ve==="onScroll"&&ca("scroll",J)}switch(V){case"input":er(J),et(J,pe,!0);break;case"textarea":er(J),tn(J);break;case"select":case"option":break;default:typeof pe.onClick=="function"&&(J.onclick=Vd)}J=de,T.updateQueue=J,J!==null&&(T.flags|=4)}else{Ve=de.nodeType===9?de:de.ownerDocument,b==="http://www.w3.org/1999/xhtml"&&(b=Xn(V)),b==="http://www.w3.org/1999/xhtml"?V==="script"?(b=Ve.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild)):typeof J.is=="string"?b=Ve.createElement(V,{is:J.is}):(b=Ve.createElement(V),V==="select"&&(Ve=b,J.multiple?Ve.multiple=!0:J.size&&(Ve.size=J.size))):b=Ve.createElementNS(b,V),b[Pl]=T,b[$d]=J,sd(b,T,!1,!1),T.stateNode=b;e:{switch(Ve=Gl(V,J),V){case"dialog":ca("cancel",b),ca("close",b),de=J;break;case"iframe":case"object":case"embed":ca("load",b),de=J;break;case"video":case"audio":for(de=0;de<wp.length;de++)ca(wp[de],b);de=J;break;case"source":ca("error",b),de=J;break;case"img":case"image":case"link":ca("error",b),ca("load",b),de=J;break;case"details":ca("toggle",b),de=J;break;case"input":nn(b,J),de=Pt(b,J),ca("invalid",b);break;case"option":de=J;break;case"select":b._wrapperState={wasMultiple:!!J.multiple},de=ut({},J,{value:void 0}),ca("invalid",b);break;case"textarea":pr(b,J),de=fr(b,J),ca("invalid",b);break;default:de=J}Os(V,de),yt=de;for(pe in yt)if(yt.hasOwnProperty(pe)){var Ct=yt[pe];pe==="style"?ql(b,Ct):pe==="dangerouslySetInnerHTML"?(Ct=Ct?Ct.__html:void 0,Ct!=null&&io(b,Ct)):pe==="children"?typeof Ct=="string"?(V!=="textarea"||Ct!=="")&&Va(b,Ct):typeof Ct=="number"&&Va(b,""+Ct):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(a.hasOwnProperty(pe)?Ct!=null&&pe==="onScroll"&&ca("scroll",b):Ct!=null&&ne(b,pe,Ct,Ve))}switch(V){case"input":er(b),et(b,J,!1);break;case"textarea":er(b),tn(b);break;case"option":J.value!=null&&b.setAttribute("value",""+nr(J.value));break;case"select":b.multiple=!!J.multiple,pe=J.value,pe!=null?xr(b,!!J.multiple,pe,!1):J.defaultValue!=null&&xr(b,!!J.multiple,J.defaultValue,!0);break;default:typeof de.onClick=="function"&&(b.onclick=Vd)}switch(V){case"button":case"input":case"select":case"textarea":J=!!J.autoFocus;break e;case"img":J=!0;break e;default:J=!1}}J&&(T.flags|=4)}T.ref!==null&&(T.flags|=512,T.flags|=2097152)}return uo(T),null;case 6:if(b&&T.stateNode!=null)lu(b,T,b.memoizedProps,J);else{if(typeof J!="string"&&T.stateNode===null)throw Error(r(166));if(V=ml(th.current),ml(Ws.current),fl(T)){if(J=T.stateNode,V=T.memoizedProps,J[Pl]=T,(pe=J.nodeValue!==V)&&(b=dl,b!==null))switch(b.tag){case 3:nf(J.nodeValue,V,(b.mode&1)!==0);break;case 5:b.memoizedProps.suppressHydrationWarning!==!0&&nf(J.nodeValue,V,(b.mode&1)!==0)}pe&&(T.flags|=4)}else J=(V.nodeType===9?V:V.ownerDocument).createTextNode(J),J[Pl]=T,T.stateNode=J}return uo(T),null;case 13:if(ma(fi),J=T.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(ga&&oo!==null&&(T.mode&1)!==0&&(T.flags&128)===0)wo(),pl(),T.flags|=98560,pe=!1;else if(pe=fl(T),J!==null&&J.dehydrated!==null){if(b===null){if(!pe)throw Error(r(318));if(pe=T.memoizedState,pe=pe!==null?pe.dehydrated:null,!pe)throw Error(r(317));pe[Pl]=T}else pl(),(T.flags&128)===0&&(T.memoizedState=null),T.flags|=4;uo(T),pe=!1}else hl!==null&&(si(hl),hl=null),pe=!0;if(!pe)return T.flags&65536?T:null}return(T.flags&128)!==0?(T.lanes=V,T):(J=J!==null,J!==(b!==null&&b.memoizedState!==null)&&J&&(T.child.flags|=8192,(T.mode&1)!==0&&(b===null||(fi.current&1)!==0?dt===0&&(dt=3):Nn())),T.updateQueue!==null&&(T.flags|=4),uo(T),null);case 4:return So(),$p(b,T),b===null&&rf(T.stateNode.containerInfo),uo(T),null;case 10:return Xu(T.type._context),uo(T),null;case 17:return $o(T.type)&&$m(),uo(T),null;case 19:if(ma(fi),pe=T.memoizedState,pe===null)return uo(T),null;if(J=(T.flags&128)!==0,Ve=pe.rendering,Ve===null)if(J)qp(pe,!1);else{if(dt!==0||b!==null&&(b.flags&128)!==0)for(b=T.child;b!==null;){if(Ve=Zm(b),Ve!==null){for(T.flags|=128,qp(pe,!1),J=Ve.updateQueue,J!==null&&(T.updateQueue=J,T.flags|=4),T.subtreeFlags=0,J=V,V=T.child;V!==null;)pe=V,b=J,pe.flags&=14680066,Ve=pe.alternate,Ve===null?(pe.childLanes=0,pe.lanes=b,pe.child=null,pe.subtreeFlags=0,pe.memoizedProps=null,pe.memoizedState=null,pe.updateQueue=null,pe.dependencies=null,pe.stateNode=null):(pe.childLanes=Ve.childLanes,pe.lanes=Ve.lanes,pe.child=Ve.child,pe.subtreeFlags=0,pe.deletions=null,pe.memoizedProps=Ve.memoizedProps,pe.memoizedState=Ve.memoizedState,pe.updateQueue=Ve.updateQueue,pe.type=Ve.type,b=Ve.dependencies,pe.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),V=V.sibling;return Ji(fi,fi.current&1|2),T.child}b=b.sibling}pe.tail!==null&&Ar()>It&&(T.flags|=128,J=!0,qp(pe,!1),T.lanes=4194304)}else{if(!J)if(b=Zm(Ve),b!==null){if(T.flags|=128,J=!0,V=b.updateQueue,V!==null&&(T.updateQueue=V,T.flags|=4),qp(pe,!0),pe.tail===null&&pe.tailMode==="hidden"&&!Ve.alternate&&!ga)return uo(T),null}else 2*Ar()-pe.renderingStartTime>It&&V!==1073741824&&(T.flags|=128,J=!0,qp(pe,!1),T.lanes=4194304);pe.isBackwards?(Ve.sibling=T.child,T.child=Ve):(V=pe.last,V!==null?V.sibling=Ve:T.child=Ve,pe.last=Ve)}return pe.tail!==null?(T=pe.tail,pe.rendering=T,pe.tail=T.sibling,pe.renderingStartTime=Ar(),T.sibling=null,V=fi.current,Ji(fi,J?V&1|2:V&1),T):(uo(T),null);case 22:case 23:return ks(),J=T.memoizedState!==null,b!==null&&b.memoizedState!==null!==J&&(T.flags|=8192),J&&(T.mode&1)!==0?(Mt&1073741824)!==0&&(uo(T),T.subtreeFlags&6&&(T.flags|=8192)):uo(T),null;case 24:return null;case 25:return null}throw Error(r(156,T.tag))}function Cc(b,T){switch(Ey(T),T.tag){case 1:return $o(T.type)&&$m(),b=T.flags,b&65536?(T.flags=b&-65537|128,T):null;case 3:return So(),ma(Uo),ma(Is),ji(),b=T.flags,(b&65536)!==0&&(b&128)===0?(T.flags=b&-65537|128,T):null;case 5:return Km(T),null;case 13:if(ma(fi),b=T.memoizedState,b!==null&&b.dehydrated!==null){if(T.alternate===null)throw Error(r(340));pl()}return b=T.flags,b&65536?(T.flags=b&-65537|128,T):null;case 19:return ma(fi),null;case 4:return So(),null;case 10:return Xu(T.type._context),null;case 22:case 23:return ks(),null;case 24:return null;default:return null}}var Yo=!1,qi=!1,Xo=typeof WeakSet=="function"?WeakSet:Set,Fr=null;function ch(b,T){var V=b.ref;if(V!==null)if(typeof V=="function")try{V(null)}catch(J){Ni(b,T,J)}else V.current=null}function Zs(b,T,V){try{V()}catch(J){Ni(b,T,J)}}var lg=!1;function Sf(b,T){if(Pp=qa,b=wy(),Vo(b)){if("selectionStart"in b)var V={start:b.selectionStart,end:b.selectionEnd};else e:{V=(V=b.ownerDocument)&&V.defaultView||window;var J=V.getSelection&&V.getSelection();if(J&&J.rangeCount!==0){V=J.anchorNode;var de=J.anchorOffset,pe=J.focusNode;J=J.focusOffset;try{V.nodeType,pe.nodeType}catch{V=null;break e}var Ve=0,yt=-1,Ct=-1,Zt=0,Tr=0,Mr=b,Pr=null;t:for(;;){for(var Jr;Mr!==V||de!==0&&Mr.nodeType!==3||(yt=Ve+de),Mr!==pe||J!==0&&Mr.nodeType!==3||(Ct=Ve+J),Mr.nodeType===3&&(Ve+=Mr.nodeValue.length),(Jr=Mr.firstChild)!==null;)Pr=Mr,Mr=Jr;for(;;){if(Mr===b)break t;if(Pr===V&&++Zt===de&&(yt=Ve),Pr===pe&&++Tr===J&&(Ct=Ve),(Jr=Mr.nextSibling)!==null)break;Mr=Pr,Pr=Mr.parentNode}Mr=Jr}V=yt===-1||Ct===-1?null:{start:yt,end:Ct}}else V=null}V=V||{start:0,end:0}}else V=null;for(Cp={focusedElem:b,selectionRange:V},qa=!1,Fr=T;Fr!==null;)if(T=Fr,b=T.child,(T.subtreeFlags&1028)!==0&&b!==null)b.return=T,Fr=b;else for(;Fr!==null;){T=Fr;try{var ln=T.alternate;if((T.flags&1024)!==0)switch(T.tag){case 0:case 11:case 15:break;case 1:if(ln!==null){var un=ln.memoizedProps,ys=ln.memoizedState,Vt=T.stateNode,Ot=Vt.getSnapshotBeforeUpdate(T.elementType===T.type?un:Jl(T.type,un),ys);Vt.__reactInternalSnapshotBeforeUpdate=Ot}break;case 3:var Gt=T.stateNode.containerInfo;Gt.nodeType===1?Gt.textContent="":Gt.nodeType===9&&Gt.documentElement&&Gt.removeChild(Gt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Nr){Ni(T,T.return,Nr)}if(b=T.sibling,b!==null){b.return=T.return,Fr=b;break}Fr=T.return}return ln=lg,lg=!1,ln}function g(b,T,V){var J=T.updateQueue;if(J=J!==null?J.lastEffect:null,J!==null){var de=J=J.next;do{if((de.tag&b)===b){var pe=de.destroy;de.destroy=void 0,pe!==void 0&&Zs(T,V,pe)}de=de.next}while(de!==J)}}function o(b,T){if(T=T.updateQueue,T=T!==null?T.lastEffect:null,T!==null){var V=T=T.next;do{if((V.tag&b)===b){var J=V.create;V.destroy=J()}V=V.next}while(V!==T)}}function d(b){var T=b.ref;if(T!==null){var V=b.stateNode;switch(b.tag){case 5:b=V;break;default:b=V}typeof T=="function"?T(b):T.current=b}}function y(b){var T=b.alternate;T!==null&&(b.alternate=null,y(T)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(T=b.stateNode,T!==null&&(delete T[Pl],delete T[$d],delete T[Gu],delete T[Ay],delete T[p0])),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}function S(b){return b.tag===5||b.tag===3||b.tag===4}function P(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||S(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function M(b,T,V){var J=b.tag;if(J===5||J===6)b=b.stateNode,T?V.nodeType===8?V.parentNode.insertBefore(b,T):V.insertBefore(b,T):(V.nodeType===8?(T=V.parentNode,T.insertBefore(b,V)):(T=V,T.appendChild(b)),V=V._reactRootContainer,V!=null||T.onclick!==null||(T.onclick=Vd));else if(J!==4&&(b=b.child,b!==null))for(M(b,T,V),b=b.sibling;b!==null;)M(b,T,V),b=b.sibling}function D(b,T,V){var J=b.tag;if(J===5||J===6)b=b.stateNode,T?V.insertBefore(b,T):V.appendChild(b);else if(J!==4&&(b=b.child,b!==null))for(D(b,T,V),b=b.sibling;b!==null;)D(b,T,V),b=b.sibling}var G=null,K=!1;function Y(b,T,V){for(V=V.child;V!==null;)te(b,T,V),V=V.sibling}function te(b,T,V){if(En&&typeof En.onCommitFiberUnmount=="function")try{En.onCommitFiberUnmount(Un,V)}catch{}switch(V.tag){case 5:qi||ch(V,T);case 6:var J=G,de=K;G=null,Y(b,T,V),G=J,K=de,G!==null&&(K?(b=G,V=V.stateNode,b.nodeType===8?b.parentNode.removeChild(V):b.removeChild(V)):G.removeChild(V.stateNode));break;case 18:G!==null&&(K?(b=G,V=V.stateNode,b.nodeType===8?Sy(b.parentNode,V):b.nodeType===1&&Sy(b,V),Bo(b)):Sy(G,V.stateNode));break;case 4:J=G,de=K,G=V.stateNode.containerInfo,K=!0,Y(b,T,V),G=J,K=de;break;case 0:case 11:case 14:case 15:if(!qi&&(J=V.updateQueue,J!==null&&(J=J.lastEffect,J!==null))){de=J=J.next;do{var pe=de,Ve=pe.destroy;pe=pe.tag,Ve!==void 0&&((pe&2)!==0||(pe&4)!==0)&&Zs(V,T,Ve),de=de.next}while(de!==J)}Y(b,T,V);break;case 1:if(!qi&&(ch(V,T),J=V.stateNode,typeof J.componentWillUnmount=="function"))try{J.props=V.memoizedProps,J.state=V.memoizedState,J.componentWillUnmount()}catch(yt){Ni(V,T,yt)}Y(b,T,V);break;case 21:Y(b,T,V);break;case 22:V.mode&1?(qi=(J=qi)||V.memoizedState!==null,Y(b,T,V),qi=J):Y(b,T,V);break;default:Y(b,T,V)}}function re(b){var T=b.updateQueue;if(T!==null){b.updateQueue=null;var V=b.stateNode;V===null&&(V=b.stateNode=new Xo),T.forEach(function(J){var de=Af.bind(null,b,J);V.has(J)||(V.add(J),J.then(de,de))})}}function oe(b,T){var V=T.deletions;if(V!==null)for(var J=0;J<V.length;J++){var de=V[J];try{var pe=b,Ve=T,yt=Ve;e:for(;yt!==null;){switch(yt.tag){case 5:G=yt.stateNode,K=!1;break e;case 3:G=yt.stateNode.containerInfo,K=!0;break e;case 4:G=yt.stateNode.containerInfo,K=!0;break e}yt=yt.return}if(G===null)throw Error(r(160));te(pe,Ve,de),G=null,K=!1;var Ct=de.alternate;Ct!==null&&(Ct.return=null),de.return=null}catch(Zt){Ni(de,T,Zt)}}if(T.subtreeFlags&12854)for(T=T.child;T!==null;)ve(T,b),T=T.sibling}function ve(b,T){var V=b.alternate,J=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:if(oe(T,b),fe(b),J&4){try{g(3,b,b.return),o(3,b)}catch(un){Ni(b,b.return,un)}try{g(5,b,b.return)}catch(un){Ni(b,b.return,un)}}break;case 1:oe(T,b),fe(b),J&512&&V!==null&&ch(V,V.return);break;case 5:if(oe(T,b),fe(b),J&512&&V!==null&&ch(V,V.return),b.flags&32){var de=b.stateNode;try{Va(de,"")}catch(un){Ni(b,b.return,un)}}if(J&4&&(de=b.stateNode,de!=null)){var pe=b.memoizedProps,Ve=V!==null?V.memoizedProps:pe,yt=b.type,Ct=b.updateQueue;if(b.updateQueue=null,Ct!==null)try{yt==="input"&&pe.type==="radio"&&pe.name!=null&&Sn(de,pe),Gl(yt,Ve);var Zt=Gl(yt,pe);for(Ve=0;Ve<Ct.length;Ve+=2){var Tr=Ct[Ve],Mr=Ct[Ve+1];Tr==="style"?ql(de,Mr):Tr==="dangerouslySetInnerHTML"?io(de,Mr):Tr==="children"?Va(de,Mr):ne(de,Tr,Mr,Zt)}switch(yt){case"input":Br(de,pe);break;case"textarea":ar(de,pe);break;case"select":var Pr=de._wrapperState.wasMultiple;de._wrapperState.wasMultiple=!!pe.multiple;var Jr=pe.value;Jr!=null?xr(de,!!pe.multiple,Jr,!1):Pr!==!!pe.multiple&&(pe.defaultValue!=null?xr(de,!!pe.multiple,pe.defaultValue,!0):xr(de,!!pe.multiple,pe.multiple?[]:"",!1))}de[$d]=pe}catch(un){Ni(b,b.return,un)}}break;case 6:if(oe(T,b),fe(b),J&4){if(b.stateNode===null)throw Error(r(162));de=b.stateNode,pe=b.memoizedProps;try{de.nodeValue=pe}catch(un){Ni(b,b.return,un)}}break;case 3:if(oe(T,b),fe(b),J&4&&V!==null&&V.memoizedState.isDehydrated)try{Bo(T.containerInfo)}catch(un){Ni(b,b.return,un)}break;case 4:oe(T,b),fe(b);break;case 13:oe(T,b),fe(b),de=b.child,de.flags&8192&&(pe=de.memoizedState!==null,de.stateNode.isHidden=pe,!pe||de.alternate!==null&&de.alternate.memoizedState!==null||(Bt=Ar())),J&4&&re(b);break;case 22:if(Tr=V!==null&&V.memoizedState!==null,b.mode&1?(qi=(Zt=qi)||Tr,oe(T,b),qi=Zt):oe(T,b),fe(b),J&8192){if(Zt=b.memoizedState!==null,(b.stateNode.isHidden=Zt)&&!Tr&&(b.mode&1)!==0)for(Fr=b,Tr=b.child;Tr!==null;){for(Mr=Fr=Tr;Fr!==null;){switch(Pr=Fr,Jr=Pr.child,Pr.tag){case 0:case 11:case 14:case 15:g(4,Pr,Pr.return);break;case 1:ch(Pr,Pr.return);var ln=Pr.stateNode;if(typeof ln.componentWillUnmount=="function"){J=Pr,V=Pr.return;try{T=J,ln.props=T.memoizedProps,ln.state=T.memoizedState,ln.componentWillUnmount()}catch(un){Ni(J,V,un)}}break;case 5:ch(Pr,Pr.return);break;case 22:if(Pr.memoizedState!==null){Ue(Mr);continue}}Jr!==null?(Jr.return=Pr,Fr=Jr):Ue(Mr)}Tr=Tr.sibling}e:for(Tr=null,Mr=b;;){if(Mr.tag===5){if(Tr===null){Tr=Mr;try{de=Mr.stateNode,Zt?(pe=de.style,typeof pe.setProperty=="function"?pe.setProperty("display","none","important"):pe.display="none"):(yt=Mr.stateNode,Ct=Mr.memoizedProps.style,Ve=Ct!=null&&Ct.hasOwnProperty("display")?Ct.display:null,yt.style.display=Qa("display",Ve))}catch(un){Ni(b,b.return,un)}}}else if(Mr.tag===6){if(Tr===null)try{Mr.stateNode.nodeValue=Zt?"":Mr.memoizedProps}catch(un){Ni(b,b.return,un)}}else if((Mr.tag!==22&&Mr.tag!==23||Mr.memoizedState===null||Mr===b)&&Mr.child!==null){Mr.child.return=Mr,Mr=Mr.child;continue}if(Mr===b)break e;for(;Mr.sibling===null;){if(Mr.return===null||Mr.return===b)break e;Tr===Mr&&(Tr=null),Mr=Mr.return}Tr===Mr&&(Tr=null),Mr.sibling.return=Mr.return,Mr=Mr.sibling}}break;case 19:oe(T,b),fe(b),J&4&&re(b);break;case 21:break;default:oe(T,b),fe(b)}}function fe(b){var T=b.flags;if(T&2){try{e:{for(var V=b.return;V!==null;){if(S(V)){var J=V;break e}V=V.return}throw Error(r(160))}switch(J.tag){case 5:var de=J.stateNode;J.flags&32&&(Va(de,""),J.flags&=-33);var pe=P(b);D(b,pe,de);break;case 3:case 4:var Ve=J.stateNode.containerInfo,yt=P(b);M(b,yt,Ve);break;default:throw Error(r(161))}}catch(Ct){Ni(b,b.return,Ct)}b.flags&=-3}T&4096&&(b.flags&=-4097)}function be(b,T,V){Fr=b,xe(b)}function xe(b,T,V){for(var J=(b.mode&1)!==0;Fr!==null;){var de=Fr,pe=de.child;if(de.tag===22&&J){var Ve=de.memoizedState!==null||Yo;if(!Ve){var yt=de.alternate,Ct=yt!==null&&yt.memoizedState!==null||qi;yt=Yo;var Zt=qi;if(Yo=Ve,(qi=Ct)&&!Zt)for(Fr=de;Fr!==null;)Ve=Fr,Ct=Ve.child,Ve.tag===22&&Ve.memoizedState!==null?Be(de):Ct!==null?(Ct.return=Ve,Fr=Ct):Be(de);for(;pe!==null;)Fr=pe,xe(pe),pe=pe.sibling;Fr=de,Yo=yt,qi=Zt}Ce(b)}else(de.subtreeFlags&8772)!==0&&pe!==null?(pe.return=de,Fr=pe):Ce(b)}}function Ce(b){for(;Fr!==null;){var T=Fr;if((T.flags&8772)!==0){var V=T.alternate;try{if((T.flags&8772)!==0)switch(T.tag){case 0:case 11:case 15:qi||o(5,T);break;case 1:var J=T.stateNode;if(T.flags&4&&!qi)if(V===null)J.componentDidMount();else{var de=T.elementType===T.type?V.memoizedProps:Jl(T.type,V.memoizedProps);J.componentDidUpdate(de,V.memoizedState,J.__reactInternalSnapshotBeforeUpdate)}var pe=T.updateQueue;pe!==null&&Oy(T,pe,J);break;case 3:var Ve=T.updateQueue;if(Ve!==null){if(V=null,T.child!==null)switch(T.child.tag){case 5:V=T.child.stateNode;break;case 1:V=T.child.stateNode}Oy(T,Ve,V)}break;case 5:var yt=T.stateNode;if(V===null&&T.flags&4){V=yt;var Ct=T.memoizedProps;switch(T.type){case"button":case"input":case"select":case"textarea":Ct.autoFocus&&V.focus();break;case"img":Ct.src&&(V.src=Ct.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(T.memoizedState===null){var Zt=T.alternate;if(Zt!==null){var Tr=Zt.memoizedState;if(Tr!==null){var Mr=Tr.dehydrated;Mr!==null&&Bo(Mr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}qi||T.flags&512&&d(T)}catch(Pr){Ni(T,T.return,Pr)}}if(T===b){Fr=null;break}if(V=T.sibling,V!==null){V.return=T.return,Fr=V;break}Fr=T.return}}function Ue(b){for(;Fr!==null;){var T=Fr;if(T===b){Fr=null;break}var V=T.sibling;if(V!==null){V.return=T.return,Fr=V;break}Fr=T.return}}function Be(b){for(;Fr!==null;){var T=Fr;try{switch(T.tag){case 0:case 11:case 15:var V=T.return;try{o(4,T)}catch(Ct){Ni(T,V,Ct)}break;case 1:var J=T.stateNode;if(typeof J.componentDidMount=="function"){var de=T.return;try{J.componentDidMount()}catch(Ct){Ni(T,de,Ct)}}var pe=T.return;try{d(T)}catch(Ct){Ni(T,pe,Ct)}break;case 5:var Ve=T.return;try{d(T)}catch(Ct){Ni(T,Ve,Ct)}}}catch(Ct){Ni(T,T.return,Ct)}if(T===b){Fr=null;break}var yt=T.sibling;if(yt!==null){yt.return=T.return,Fr=yt;break}Fr=T.return}}var Xe=Math.ceil,qe=ae.ReactCurrentDispatcher,We=ae.ReactCurrentOwner,$e=ae.ReactCurrentBatchConfig,Ke=0,it=null,_t=null,mt=0,Mt=0,jt=El(0),dt=0,Et=null,Ut=0,pt=0,Dt=0,kt=null,Yt=null,Bt=0,It=1/0,Ht=null,tr=!1,gr=null,_r=null,qr=!1,jr=null,Ir=0,Hr=0,Mn=null,di=-1,Gi=0;function Zn(){return(Ke&6)!==0?Ar():di!==-1?di:di=Ar()}function Zr(b){return(b.mode&1)===0?1:(Ke&2)!==0&&mt!==0?mt&-mt:My.transition!==null?(Gi===0&&(Gi=$s()),Gi):(b=vi,b!==0||(b=window.event,b=b===void 0?16:up(b.type)),b)}function wn(b,T,V,J){if(50<Hr)throw Hr=0,Mn=null,Error(r(185));sl(b,V,J),((Ke&2)===0||b!==it)&&(b===it&&((Ke&2)===0&&(pt|=V),dt===4&&na(b,mt)),Sr(b,J),V===1&&Ke===0&&(T.mode&1)===0&&(It=Ar()+500,Hd&&Ml()))}function Sr(b,T){var V=b.callbackNode;dy(b,T);var J=Wh(b,b===it?mt:0);if(J===0)V!==null&&Ft(V),b.callbackNode=null,b.callbackPriority=0;else if(T=J&-J,b.callbackPriority!==T){if(V!=null&&Ft(V),T===1)b.tag===0?Ep(Ma.bind(null,b)):Cy(Ma.bind(null,b)),U_(function(){(Ke&6)===0&&Ml()}),V=null;else{switch(cp(J)){case 1:V=Ur;break;case 4:V=Vr;break;case 16:V=Cn;break;case 536870912:V=bn;break;default:V=Cn}V=cg(V,kn.bind(null,b))}b.callbackPriority=T,b.callbackNode=V}}function kn(b,T){if(di=-1,Gi=0,(Ke&6)!==0)throw Error(r(327));var V=b.callbackNode;if(Co()&&b.callbackNode!==V)return null;var J=Wh(b,b===it?mt:0);if(J===0)return null;if((J&30)!==0||(J&b.expiredLanes)!==0||T)T=ia(b,J);else{T=J;var de=Ke;Ke|=2;var pe=_i();(it!==b||mt!==T)&&(Ht=null,It=Ar()+500,Oi(b,T));do try{Ci();break}catch(yt){Pi(b,yt)}while(!0);Yu(),qe.current=pe,Ke=de,_t!==null?T=0:(it=null,mt=0,T=dt)}if(T!==0){if(T===2&&(de=lp(b),de!==0&&(J=de,T=ei(b,de))),T===1)throw V=Et,Oi(b,0),na(b,J),Sr(b,Ar()),V;if(T===6)na(b,J);else{if(de=b.current.alternate,(J&30)===0&&!Qi(de)&&(T=ia(b,J),T===2&&(pe=lp(b),pe!==0&&(J=pe,T=ei(b,pe))),T===1))throw V=Et,Oi(b,0),na(b,J),Sr(b,Ar()),V;switch(b.finishedWork=de,b.finishedLanes=J,T){case 0:case 1:throw Error(r(345));case 2:gs(b,Yt,Ht);break;case 3:if(na(b,J),(J&130023424)===J&&(T=Bt+500-Ar(),10<T)){if(Wh(b,0)!==0)break;if(de=b.suspendedLanes,(de&J)!==J){Zn(),b.pingedLanes|=b.suspendedLanes&de;break}b.timeoutHandle=Um(gs.bind(null,b,Yt,Ht),T);break}gs(b,Yt,Ht);break;case 4:if(na(b,J),(J&4194240)===J)break;for(T=b.eventTimes,de=-1;0<J;){var Ve=31-ds(J);pe=1<<Ve,Ve=T[Ve],Ve>de&&(de=Ve),J&=~pe}if(J=de,J=Ar()-J,J=(120>J?120:480>J?480:1080>J?1080:1920>J?1920:3e3>J?3e3:4320>J?4320:1960*Xe(J/1960))-J,10<J){b.timeoutHandle=Um(gs.bind(null,b,Yt,Ht),J);break}gs(b,Yt,Ht);break;case 5:gs(b,Yt,Ht);break;default:throw Error(r(329))}}}return Sr(b,Ar()),b.callbackNode===V?kn.bind(null,b):null}function ei(b,T){var V=kt;return b.current.memoizedState.isDehydrated&&(Oi(b,T).flags|=256),b=ia(b,T),b!==2&&(T=Yt,Yt=V,T!==null&&si(T)),b}function si(b){Yt===null?Yt=b:Yt.push.apply(Yt,b)}function Qi(b){for(var T=b;;){if(T.flags&16384){var V=T.updateQueue;if(V!==null&&(V=V.stores,V!==null))for(var J=0;J<V.length;J++){var de=V[J],pe=de.getSnapshot;de=de.value;try{if(!Gs(pe(),de))return!1}catch{return!1}}}if(V=T.child,T.subtreeFlags&16384&&V!==null)V.return=T,T=V;else{if(T===b)break;for(;T.sibling===null;){if(T.return===null||T.return===b)return!0;T=T.return}T.sibling.return=T.return,T=T.sibling}}return!0}function na(b,T){for(T&=~Dt,T&=~pt,b.suspendedLanes|=T,b.pingedLanes&=~T,b=b.expirationTimes;0<T;){var V=31-ds(T),J=1<<V;b[V]=-1,T&=~J}}function Ma(b){if((Ke&6)!==0)throw Error(r(327));Co();var T=Wh(b,0);if((T&1)===0)return Sr(b,Ar()),null;var V=ia(b,T);if(b.tag!==0&&V===2){var J=lp(b);J!==0&&(T=J,V=ei(b,J))}if(V===1)throw V=Et,Oi(b,0),na(b,T),Sr(b,Ar()),V;if(V===6)throw Error(r(345));return b.finishedWork=b.current.alternate,b.finishedLanes=T,gs(b,Yt,Ht),Sr(b,Ar()),null}function ba(b,T){var V=Ke;Ke|=1;try{return b(T)}finally{Ke=V,Ke===0&&(It=Ar()+500,Hd&&Ml())}}function Es(b){jr!==null&&jr.tag===0&&(Ke&6)===0&&Co();var T=Ke;Ke|=1;var V=$e.transition,J=vi;try{if($e.transition=null,vi=1,b)return b()}finally{vi=J,$e.transition=V,Ke=T,(Ke&6)===0&&Ml()}}function ks(){Mt=jt.current,ma(jt)}function Oi(b,T){b.finishedWork=null,b.finishedLanes=0;var V=b.timeoutHandle;if(V!==-1&&(b.timeoutHandle=-1,h0(V)),_t!==null)for(V=_t.return;V!==null;){var J=V;switch(Ey(J),J.tag){case 1:J=J.type.childContextTypes,J!=null&&$m();break;case 3:So(),ma(Uo),ma(Is),ji();break;case 5:Km(J);break;case 4:So();break;case 13:ma(fi);break;case 19:ma(fi);break;case 10:Xu(J.type._context);break;case 22:case 23:ks()}V=V.return}if(it=b,_t=b=hh(b.current,null),mt=Mt=T,dt=0,Et=null,Dt=pt=Ut=0,Yt=kt=null,jl!==null){for(T=0;T<jl.length;T++)if(V=jl[T],J=V.interleaved,J!==null){V.interleaved=null;var de=J.next,pe=V.pending;if(pe!==null){var Ve=pe.next;pe.next=de,J.next=Ve}V.pending=J}jl=null}return b}function Pi(b,T){do{var V=_t;try{if(Yu(),Qn.current=ng,ed){for(var J=ra.memoizedState;J!==null;){var de=J.queue;de!==null&&(de.pending=null),J=J.next}ed=!1}if(Ao=0,rs=ua=ra=null,Wo=!1,ns=0,We.current=null,V===null||V.return===null){dt=1,Et=T,_t=null;break}e:{var pe=b,Ve=V.return,yt=V,Ct=T;if(T=mt,yt.flags|=32768,Ct!==null&&typeof Ct=="object"&&typeof Ct.then=="function"){var Zt=Ct,Tr=yt,Mr=Tr.tag;if((Tr.mode&1)===0&&(Mr===0||Mr===11||Mr===15)){var Pr=Tr.alternate;Pr?(Tr.updateQueue=Pr.updateQueue,Tr.memoizedState=Pr.memoizedState,Tr.lanes=Pr.lanes):(Tr.updateQueue=null,Tr.memoizedState=null)}var Jr=_f(Ve);if(Jr!==null){Jr.flags&=-257,ag(Jr,Ve,yt,pe,T),Jr.mode&1&&Vy(pe,Zt,T),T=Jr,Ct=Zt;var ln=T.updateQueue;if(ln===null){var un=new Set;un.add(Ct),T.updateQueue=un}else ln.add(Ct);break e}else{if((T&1)===0){Vy(pe,Zt,T),Nn();break e}Ct=Error(r(426))}}else if(ga&&yt.mode&1){var ys=_f(Ve);if(ys!==null){(ys.flags&65536)===0&&(ys.flags|=256),ag(ys,Ve,yt,pe,T),Mp(Tc(Ct,yt));break e}}pe=Ct=Tc(Ct,yt),dt!==4&&(dt=2),kt===null?kt=[pe]:kt.push(pe),pe=Ve;do{switch(pe.tag){case 3:pe.flags|=65536,T&=-T,pe.lanes|=T;var Vt=xf(pe,Ct,T);m0(pe,Vt);break e;case 1:yt=Ct;var Ot=pe.type,Gt=pe.stateNode;if((pe.flags&128)===0&&(typeof Ot.getDerivedStateFromError=="function"||Gt!==null&&typeof Gt.componentDidCatch=="function"&&(_r===null||!_r.has(Gt)))){pe.flags|=65536,T&=-T,pe.lanes|=T;var Nr=By(pe,yt,T);m0(pe,Nr);break e}}pe=pe.return}while(pe!==null)}gl(V)}catch(rn){T=rn,_t===V&&V!==null&&(_t=V=V.return);continue}break}while(!0)}function _i(){var b=qe.current;return qe.current=ng,b===null?ng:b}function Nn(){(dt===0||dt===3||dt===2)&&(dt=4),it===null||(Ut&268435455)===0&&(pt&268435455)===0||na(it,mt)}function ia(b,T){var V=Ke;Ke|=2;var J=_i();(it!==b||mt!==T)&&(Ht=null,Oi(b,T));do try{is();break}catch(de){Pi(b,de)}while(!0);if(Yu(),Ke=V,qe.current=J,_t!==null)throw Error(r(261));return it=null,mt=0,dt}function is(){for(;_t!==null;)Ds(_t)}function Ci(){for(;_t!==null&&!rr();)Ds(_t)}function Ds(b){var T=Gp(b.alternate,b,Mt);b.memoizedProps=b.pendingProps,T===null?gl(b):_t=T,We.current=null}function gl(b){var T=b;do{var V=T.alternate;if(b=T.return,(T.flags&32768)===0){if(V=og(V,T,Mt),V!==null){_t=V;return}}else{if(V=Cc(V,T),V!==null){V.flags&=32767,_t=V;return}if(b!==null)b.flags|=32768,b.subtreeFlags=0,b.deletions=null;else{dt=6,_t=null;return}}if(T=T.sibling,T!==null){_t=T;return}_t=T=b}while(T!==null);dt===0&&(dt=5)}function gs(b,T,V){var J=vi,de=$e.transition;try{$e.transition=null,vi=1,Po(b,T,V,J)}finally{$e.transition=de,vi=J}return null}function Po(b,T,V,J){do Co();while(jr!==null);if((Ke&6)!==0)throw Error(r(327));V=b.finishedWork;var de=b.finishedLanes;if(V===null)return null;if(b.finishedWork=null,b.finishedLanes=0,V===b.current)throw Error(r(177));b.callbackNode=null,b.callbackPriority=0;var pe=V.lanes|V.childLanes;if(uc(b,pe),b===it&&(_t=it=null,mt=0),(V.subtreeFlags&2064)===0&&(V.flags&2064)===0||qr||(qr=!0,cg(Cn,function(){return Co(),null})),pe=(V.flags&15990)!==0,(V.subtreeFlags&15990)!==0||pe){pe=$e.transition,$e.transition=null;var Ve=vi;vi=1;var yt=Ke;Ke|=4,We.current=null,Sf(b,V),ve(V,b),Rm(Cp),qa=!!Pp,Cp=Pp=null,b.current=V,be(V),sr(),Ke=yt,vi=Ve,$e.transition=pe}else b.current=V;if(qr&&(qr=!1,jr=b,Ir=de),pe=b.pendingLanes,pe===0&&(_r=null),Ca(V.stateNode),Sr(b,Ar()),T!==null)for(J=b.onRecoverableError,V=0;V<T.length;V++)de=T[V],J(de.value,{componentStack:de.stack,digest:de.digest});if(tr)throw tr=!1,b=gr,gr=null,b;return(Ir&1)!==0&&b.tag!==0&&Co(),pe=b.pendingLanes,(pe&1)!==0?b===Mn?Hr++:(Hr=0,Mn=b):Hr=0,Ml(),null}function Co(){if(jr!==null){var b=cp(Ir),T=$e.transition,V=vi;try{if($e.transition=null,vi=16>b?16:b,jr===null)var J=!1;else{if(b=jr,jr=null,Ir=0,(Ke&6)!==0)throw Error(r(331));var de=Ke;for(Ke|=4,Fr=b.current;Fr!==null;){var pe=Fr,Ve=pe.child;if((Fr.flags&16)!==0){var yt=pe.deletions;if(yt!==null){for(var Ct=0;Ct<yt.length;Ct++){var Zt=yt[Ct];for(Fr=Zt;Fr!==null;){var Tr=Fr;switch(Tr.tag){case 0:case 11:case 15:g(8,Tr,pe)}var Mr=Tr.child;if(Mr!==null)Mr.return=Tr,Fr=Mr;else for(;Fr!==null;){Tr=Fr;var Pr=Tr.sibling,Jr=Tr.return;if(y(Tr),Tr===Zt){Fr=null;break}if(Pr!==null){Pr.return=Jr,Fr=Pr;break}Fr=Jr}}}var ln=pe.alternate;if(ln!==null){var un=ln.child;if(un!==null){ln.child=null;do{var ys=un.sibling;un.sibling=null,un=ys}while(un!==null)}}Fr=pe}}if((pe.subtreeFlags&2064)!==0&&Ve!==null)Ve.return=pe,Fr=Ve;else e:for(;Fr!==null;){if(pe=Fr,(pe.flags&2048)!==0)switch(pe.tag){case 0:case 11:case 15:g(9,pe,pe.return)}var Vt=pe.sibling;if(Vt!==null){Vt.return=pe.return,Fr=Vt;break e}Fr=pe.return}}var Ot=b.current;for(Fr=Ot;Fr!==null;){Ve=Fr;var Gt=Ve.child;if((Ve.subtreeFlags&2064)!==0&&Gt!==null)Gt.return=Ve,Fr=Gt;else e:for(Ve=Ot;Fr!==null;){if(yt=Fr,(yt.flags&2048)!==0)try{switch(yt.tag){case 0:case 11:case 15:o(9,yt)}}catch(rn){Ni(yt,yt.return,rn)}if(yt===Ve){Fr=null;break e}var Nr=yt.sibling;if(Nr!==null){Nr.return=yt.return,Fr=Nr;break e}Fr=yt.return}}if(Ke=de,Ml(),En&&typeof En.onPostCommitFiberRoot=="function")try{En.onPostCommitFiberRoot(Un,b)}catch{}J=!0}return J}finally{vi=V,$e.transition=T}}return!1}function yl(b,T,V){T=Tc(V,T),T=xf(b,T,1),b=tu(b,T,1),T=Zn(),b!==null&&(sl(b,1,T),Sr(b,T))}function Ni(b,T,V){if(b.tag===3)yl(b,b,V);else for(;T!==null;){if(T.tag===3){yl(T,b,V);break}else if(T.tag===1){var J=T.stateNode;if(typeof T.type.getDerivedStateFromError=="function"||typeof J.componentDidCatch=="function"&&(_r===null||!_r.has(J))){b=Tc(V,b),b=By(T,b,1),T=tu(T,b,1),b=Zn(),T!==null&&(sl(T,1,b),Sr(T,b));break}}T=T.return}}function uh(b,T,V){var J=b.pingCache;J!==null&&J.delete(T),T=Zn(),b.pingedLanes|=b.suspendedLanes&V,it===b&&(mt&V)===V&&(dt===4||dt===3&&(mt&130023424)===mt&&500>Ar()-Bt?Oi(b,0):Dt|=V),Sr(b,T)}function Ql(b,T){T===0&&((b.mode&1)===0?T=1:(T=wl,wl<<=1,(wl&130023424)===0&&(wl=4194304)));var V=Zn();b=wc(b,T),b!==null&&(sl(b,T,V),Sr(b,V))}function dh(b){var T=b.memoizedState,V=0;T!==null&&(V=T.retryLane),Ql(b,V)}function Af(b,T){var V=0;switch(b.tag){case 13:var J=b.stateNode,de=b.memoizedState;de!==null&&(V=de.retryLane);break;case 19:J=b.stateNode;break;default:throw Error(r(314))}J!==null&&J.delete(T),Ql(b,V)}var Gp;Gp=function(b,T,V){if(b!==null)if(b.memoizedProps!==T.pendingProps||Uo.current)lo=!0;else{if((b.lanes&V)===0&&(T.flags&128)===0)return lo=!1,lh(b,T,V);lo=(b.flags&131072)!==0}else lo=!1,ga&&(T.flags&1048576)!==0&&kr(T,_c,T.index);switch(T.lanes=0,T.tag){case 2:var J=T.type;co(b,T),b=T.pendingProps;var de=Kl(T,Is.current);Xt(T,V),de=Rp(null,T,J,b,de,V);var pe=nu();return T.flags|=1,typeof de=="object"&&de!==null&&typeof de.render=="function"&&de.$$typeof===void 0?(T.tag=1,T.memoizedState=null,T.updateQueue=null,$o(J)?(pe=!0,Gd(T)):pe=!1,T.memoizedState=de.state!==null&&de.state!==void 0?de.state:null,Op(T),de.updater=rd,T.stateNode=de,de._reactInternals=T,Nl(T,J,b,V),T=Uy(null,T,J,!0,pe,V)):(T.tag=0,ga&&pe&&kp(T),Hs(null,T,de,V),T=T.child),T;case 16:J=T.elementType;e:{switch(co(b,T),b=T.pendingProps,de=J._init,J=de(J._payload),T.type=J,de=T.tag=M2(J),b=Jl(J,b),de){case 0:T=su(null,T,J,b,V);break e;case 1:T=ou(null,T,J,b,V);break e;case 11:T=nd(null,T,J,b,V);break e;case 14:T=id(null,T,J,Jl(J.type,b),V);break e}throw Error(r(306,J,""))}return T;case 0:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:Jl(J,de),su(b,T,J,de,V);case 1:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:Jl(J,de),ou(b,T,J,de,V);case 3:e:{if(y0(T),b===null)throw Error(r(387));J=T.pendingProps,pe=T.memoizedState,de=pe.element,jy(b,T),Hm(T,J,null,V);var Ve=T.memoizedState;if(J=Ve.element,pe.isDehydrated)if(pe={element:J,isDehydrated:!1,cache:Ve.cache,pendingSuspenseBoundaries:Ve.pendingSuspenseBoundaries,transitions:Ve.transitions},T.updateQueue.baseState=pe,T.memoizedState=pe,T.flags&256){de=Tc(Error(r(423)),T),T=v0(b,T,J,V,de);break e}else if(J!==de){de=Tc(Error(r(424)),T),T=v0(b,T,J,V,de);break e}else for(oo=qu(T.stateNode.containerInfo.firstChild),dl=T,ga=!0,hl=null,V=jp(T,null,J,V),T.child=V;V;)V.flags=V.flags&-3|4096,V=V.sibling;else{if(pl(),J===de){T=Zo(b,T,V);break e}Hs(b,T,J,V)}T=T.child}return T;case 5:return Ac(T),b===null&&lf(T),J=T.type,de=T.pendingProps,pe=b!==null?b.memoizedProps:null,Ve=de.children,af(J,de)?Ve=null:pe!==null&&af(J,pe)&&(T.flags|=32),au(b,T),Hs(b,T,Ve,V),T.child;case 6:return b===null&&lf(T),null;case 13:return Ks(b,T,V);case 4:return uf(T,T.stateNode.containerInfo),J=T.pendingProps,b===null?T.child=xi(T,null,J,V):Hs(b,T,J,V),T.child;case 11:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:Jl(J,de),nd(b,T,J,de,V);case 7:return Hs(b,T,T.pendingProps,V),T.child;case 8:return Hs(b,T,T.pendingProps.children,V),T.child;case 12:return Hs(b,T,T.pendingProps.children,V),T.child;case 10:e:{if(J=T.type._context,de=T.pendingProps,pe=T.memoizedProps,Ve=de.value,Ji(Ku,J._currentValue),J._currentValue=Ve,pe!==null)if(Gs(pe.value,Ve)){if(pe.children===de.children&&!Uo.current){T=Zo(b,T,V);break e}}else for(pe=T.child,pe!==null&&(pe.return=T);pe!==null;){var yt=pe.dependencies;if(yt!==null){Ve=pe.child;for(var Ct=yt.firstContext;Ct!==null;){if(Ct.context===J){if(pe.tag===1){Ct=Sc(-1,V&-V),Ct.tag=2;var Zt=pe.updateQueue;if(Zt!==null){Zt=Zt.shared;var Tr=Zt.pending;Tr===null?Ct.next=Ct:(Ct.next=Tr.next,Tr.next=Ct),Zt.pending=Ct}}pe.lanes|=V,Ct=pe.alternate,Ct!==null&&(Ct.lanes|=V),Ju(pe.return,V,T),yt.lanes|=V;break}Ct=Ct.next}}else if(pe.tag===10)Ve=pe.type===T.type?null:pe.child;else if(pe.tag===18){if(Ve=pe.return,Ve===null)throw Error(r(341));Ve.lanes|=V,yt=Ve.alternate,yt!==null&&(yt.lanes|=V),Ju(Ve,V,T),Ve=pe.sibling}else Ve=pe.child;if(Ve!==null)Ve.return=pe;else for(Ve=pe;Ve!==null;){if(Ve===T){Ve=null;break}if(pe=Ve.sibling,pe!==null){pe.return=Ve.return,Ve=pe;break}Ve=Ve.return}pe=Ve}Hs(b,T,de.children,V),T=T.child}return T;case 9:return de=T.type,J=T.pendingProps.children,Xt(T,V),de=ur(de),J=J(de),T.flags|=1,Hs(b,T,J,V),T.child;case 14:return J=T.type,de=Jl(J,T.pendingProps),de=Jl(J.type,de),id(b,T,J,de,V);case 15:return Pc(b,T,T.type,T.pendingProps,V);case 17:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:Jl(J,de),co(b,T),T.tag=1,$o(J)?(b=!0,Gd(T)):b=!1,Xt(T,V),yf(T,J,de),Nl(T,J,de,V),Uy(null,T,J,!0,b,V);case 19:return Ko(b,T,V);case 22:return Rl(b,T,V)}throw Error(r(156,T.tag))};function cg(b,T){return Tt(b,T)}function k2(b,T,V,J){this.tag=b,this.key=V,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=T,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=J,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ec(b,T,V,J){return new k2(b,T,V,J)}function W_(b){return b=b.prototype,!(!b||!b.isReactComponent)}function M2(b){if(typeof b=="function")return W_(b)?1:0;if(b!=null){if(b=b.$$typeof,b===Ee)return 11;if(b===Ze)return 14}return 2}function hh(b,T){var V=b.alternate;return V===null?(V=Ec(b.tag,T,b.key,b.mode),V.elementType=b.elementType,V.type=b.type,V.stateNode=b.stateNode,V.alternate=b,b.alternate=V):(V.pendingProps=T,V.type=b.type,V.flags=0,V.subtreeFlags=0,V.deletions=null),V.flags=b.flags&14680064,V.childLanes=b.childLanes,V.lanes=b.lanes,V.child=b.child,V.memoizedProps=b.memoizedProps,V.memoizedState=b.memoizedState,V.updateQueue=b.updateQueue,T=b.dependencies,V.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext},V.sibling=b.sibling,V.index=b.index,V.ref=b.ref,V}function $y(b,T,V,J,de,pe){var Ve=2;if(J=b,typeof b=="function")W_(b)&&(Ve=1);else if(typeof b=="string")Ve=5;else e:switch(b){case ce:return Tf(V.children,de,pe,T);case ge:Ve=8,de|=8;break;case Te:return b=Ec(12,V,T,de|2),b.elementType=Te,b.lanes=pe,b;case ke:return b=Ec(13,V,T,de),b.elementType=ke,b.lanes=pe,b;case Qe:return b=Ec(19,V,T,de),b.elementType=Qe,b.lanes=pe,b;case Oe:return qy(V,de,pe,T);default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case Ae:Ve=10;break e;case _e:Ve=9;break e;case Ee:Ve=11;break e;case Ze:Ve=14;break e;case Ge:Ve=16,J=null;break e}throw Error(r(130,b==null?b:typeof b,""))}return T=Ec(Ve,V,T,de),T.elementType=b,T.type=J,T.lanes=pe,T}function Tf(b,T,V,J){return b=Ec(7,b,J,T),b.lanes=V,b}function qy(b,T,V,J){return b=Ec(22,b,J,T),b.elementType=Oe,b.lanes=V,b.stateNode={isHidden:!1},b}function _0(b,T,V){return b=Ec(6,b,null,T),b.lanes=V,b}function b0(b,T,V){return T=Ec(4,b.children!==null?b.children:[],b.key,T),T.lanes=V,T.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},T}function H_(b,T,V,J,de){this.tag=T,this.containerInfo=b,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=al(0),this.expirationTimes=al(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=al(0),this.identifierPrefix=J,this.onRecoverableError=de,this.mutableSourceEagerHydrationData=null}function od(b,T,V,J,de,pe,Ve,yt,Ct){return b=new H_(b,T,V,yt,Ct),T===1?(T=1,pe===!0&&(T|=8)):T=0,pe=Ec(3,null,null,T),b.current=pe,pe.stateNode=b,pe.memoizedState={element:J,isDehydrated:V,cache:null,transitions:null,pendingSuspenseBoundaries:null},Op(pe),b}function Ls(b,T,V){var J=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:J==null?null:""+J,children:b,containerInfo:T,implementation:V}}function K_(b){if(!b)return kl;b=b._reactInternals;e:{if(Ye(b)!==b||b.tag!==1)throw Error(r(170));var T=b;do{switch(T.tag){case 3:T=T.stateNode.context;break e;case 1:if($o(T.type)){T=T.stateNode.__reactInternalMemoizedMergedChildContext;break e}}T=T.return}while(T!==null);throw Error(r(171))}if(b.tag===1){var V=b.type;if($o(V))return Py(b,V,T)}return T}function ug(b,T,V,J,de,pe,Ve,yt,Ct){return b=od(V,J,!0,b,de,pe,Ve,yt,Ct),b.context=K_(null),V=b.current,J=Zn(),de=Zr(V),pe=Sc(J,de),pe.callback=T??null,tu(V,pe,de),b.current.lanes=de,sl(b,de,J),Sr(b,J),b}function w0(b,T,V,J){var de=T.current,pe=Zn(),Ve=Zr(de);return V=K_(V),T.context===null?T.context=V:T.pendingContext=V,T=Sc(pe,Ve),T.payload={element:b},J=J===void 0?null:J,J!==null&&(T.callback=J),b=tu(de,T,Ve),b!==null&&(wn(b,de,Ve,pe),ru(b,de,Ve)),Ve}function S0(b){if(b=b.current,!b.child)return null;switch(b.child.tag){case 5:return b.child.stateNode;default:return b.child.stateNode}}function dg(b,T){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var V=b.retryLane;b.retryLane=V!==0&&V<T?V:T}}function A0(b,T){dg(b,T),(b=b.alternate)&&dg(b,T)}function Wp(){return null}var hg=typeof reportError=="function"?reportError:function(b){console.error(b)};function Z_(b){this._internalRoot=b}T0.prototype.render=Z_.prototype.render=function(b){var T=this._internalRoot;if(T===null)throw Error(r(409));w0(b,T,null,null)},T0.prototype.unmount=Z_.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var T=b.containerInfo;Es(function(){w0(null,b,null,null)}),T[Cl]=null}};function T0(b){this._internalRoot=b}T0.prototype.unstable_scheduleHydration=function(b){if(b){var T=hy();b={blockedOn:null,target:b,priority:T};for(var V=0;V<hn.length&&T!==0&&T<hn[V].priority;V++);hn.splice(V,0,b),V===0&&Gn(b)}};function Y_(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function P0(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11&&(b.nodeType!==8||b.nodeValue!==" react-mount-point-unstable "))}function j2(){}function xC(b,T,V,J,de){if(de){if(typeof J=="function"){var pe=J;J=function(){var Zt=S0(Ve);pe.call(Zt)}}var Ve=ug(T,J,b,0,null,!1,!1,"",j2);return b._reactRootContainer=Ve,b[Cl]=Ve.current,rf(b.nodeType===8?b.parentNode:b),Es(),Ve}for(;de=b.lastChild;)b.removeChild(de);if(typeof J=="function"){var yt=J;J=function(){var Zt=S0(Ct);yt.call(Zt)}}var Ct=od(b,0,!1,null,null,!1,!1,"",j2);return b._reactRootContainer=Ct,b[Cl]=Ct.current,rf(b.nodeType===8?b.parentNode:b),Es(function(){w0(T,Ct,V,J)}),Ct}function C0(b,T,V,J,de){var pe=V._reactRootContainer;if(pe){var Ve=pe;if(typeof de=="function"){var yt=de;de=function(){var Ct=S0(Ve);yt.call(Ct)}}w0(T,Ve,b,de)}else Ve=xC(V,T,b,de,J);return S0(Ve)}Tm=function(b){switch(b.tag){case 3:var T=b.stateNode;if(T.current.memoizedState.isDehydrated){var V=Vc(T.pendingLanes);V!==0&&(ol(T,V|1),Sr(T,Ar()),(Ke&6)===0&&(It=Ar()+500,Ml()))}break;case 13:Es(function(){var J=wc(b,1);if(J!==null){var de=Zn();wn(J,b,1,de)}}),A0(b,1)}},dc=function(b){if(b.tag===13){var T=wc(b,134217728);if(T!==null){var V=Zn();wn(T,b,134217728,V)}A0(b,134217728)}},Uc=function(b){if(b.tag===13){var T=Zr(b),V=wc(b,T);if(V!==null){var J=Zn();wn(V,b,T,J)}A0(b,T)}},hy=function(){return vi},Pm=function(b,T){var V=vi;try{return vi=b,T()}finally{vi=V}},Mu=function(b,T,V){switch(T){case"input":if(Br(b,V),T=V.name,V.type==="radio"&&T!=null){for(V=b;V.parentNode;)V=V.parentNode;for(V=V.querySelectorAll("input[name="+JSON.stringify(""+T)+'][type="radio"]'),T=0;T<V.length;T++){var J=V[T];if(J!==b&&J.form===b.form){var de=of(J);if(!de)throw Error(r(90));Lt(J),Br(J,de)}}}break;case"textarea":ar(b,V);break;case"select":T=V.value,T!=null&&xr(b,!!V.multiple,T,!1)}},ws=ba,bl=Es;var X_={usingClientEntryPoint:!1,Events:[qd,cl,of,ha,Ta,ba]},Gy={findFiberByHostInstance:Wu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fg={bundleType:Gy.bundleType,version:Gy.version,rendererPackageName:Gy.rendererPackageName,rendererConfig:Gy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ae.ReactCurrentDispatcher,findHostInstanceByFiber:function(b){return b=St(b),b===null?null:b.stateNode},findFiberByHostInstance:Gy.findFiberByHostInstance||Wp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var E0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!E0.isDisabled&&E0.supportsFiber)try{Un=E0.inject(fg),En=E0}catch{}}return kc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X_,kc.createPortal=function(b,T){var V=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y_(T))throw Error(r(200));return Ls(b,T,null,V)},kc.createRoot=function(b,T){if(!Y_(b))throw Error(r(299));var V=!1,J="",de=hg;return T!=null&&(T.unstable_strictMode===!0&&(V=!0),T.identifierPrefix!==void 0&&(J=T.identifierPrefix),T.onRecoverableError!==void 0&&(de=T.onRecoverableError)),T=od(b,1,!1,null,null,V,!1,J,de),b[Cl]=T.current,rf(b.nodeType===8?b.parentNode:b),new Z_(T)},kc.findDOMNode=function(b){if(b==null)return null;if(b.nodeType===1)return b;var T=b._reactInternals;if(T===void 0)throw typeof b.render=="function"?Error(r(188)):(b=Object.keys(b).join(","),Error(r(268,b)));return b=St(T),b=b===null?null:b.stateNode,b},kc.flushSync=function(b){return Es(b)},kc.hydrate=function(b,T,V){if(!P0(T))throw Error(r(200));return C0(null,b,T,!0,V)},kc.hydrateRoot=function(b,T,V){if(!Y_(b))throw Error(r(405));var J=V!=null&&V.hydratedSources||null,de=!1,pe="",Ve=hg;if(V!=null&&(V.unstable_strictMode===!0&&(de=!0),V.identifierPrefix!==void 0&&(pe=V.identifierPrefix),V.onRecoverableError!==void 0&&(Ve=V.onRecoverableError)),T=ug(T,null,b,1,V??null,de,!1,pe,Ve),b[Cl]=T.current,rf(b),J)for(b=0;b<J.length;b++)V=J[b],de=V._getVersion,de=de(V._source),T.mutableSourceEagerHydrationData==null?T.mutableSourceEagerHydrationData=[V,de]:T.mutableSourceEagerHydrationData.push(V,de);return new T0(T)},kc.render=function(b,T,V){if(!P0(T))throw Error(r(200));return C0(null,b,T,!1,V)},kc.unmountComponentAtNode=function(b){if(!P0(b))throw Error(r(40));return b._reactRootContainer?(Es(function(){C0(null,null,b,!1,function(){b._reactRootContainer=null,b[Cl]=null})}),!0):!1},kc.unstable_batchedUpdates=ba,kc.unstable_renderSubtreeIntoContainer=function(b,T,V,J){if(!P0(V))throw Error(r(200));if(b==null||b._reactInternals===void 0)throw Error(r(38));return C0(b,T,V,!1,J)},kc.version="18.3.1-next-f1338f8080-20240426",kc}var q5;function QG(){if(q5)return jE.exports;q5=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),jE.exports=Ese(),jE.exports}var Ow=QG();const eW=oa(Ow);function kse(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const Mse=e=>{switch(e){case"success":return Nse;case"info":return Ise;case"warning":return Rse;case"error":return Dse;default:return null}},jse=Array(12).fill(0),Ose=({visible:e,className:t})=>Re.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Re.createElement("div",{className:"sonner-spinner"},jse.map((r,n)=>Re.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),Nse=Re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Re.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Rse=Re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Re.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Ise=Re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Re.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Dse=Re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Re.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Lse=Re.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Re.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Re.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),zse=()=>{const[e,t]=Re.useState(document.hidden);return Re.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let RN=1;class Fse{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...a}=t,l=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:RN++,f=this.toasts.find(_=>_.id===l),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),f?this.toasts=this.toasts.map(_=>_.id===l?(this.publish({..._,...t,id:l,title:n}),{..._,...t,id:l,dismissible:i,title:n}):_):this.addToast({title:n,...a,dismissible:i,id:l}),l},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0}))),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let l=n!==void 0,f;const i=a.then(async w=>{if(f=["resolve",w],Re.isValidElement(w))l=!1,this.create({id:n,type:"default",message:w});else if(Vse(w)&&!w.ok){l=!1;const E=typeof r.error=="function"?await r.error(`HTTP error! status: ${w.status}`):r.error,O=typeof r.description=="function"?await r.description(`HTTP error! status: ${w.status}`):r.description,F=typeof E=="object"?E:{message:E};this.create({id:n,type:"error",description:O,...F})}else if(w instanceof Error){l=!1;const E=typeof r.error=="function"?await r.error(w):r.error,O=typeof r.description=="function"?await r.description(w):r.description,F=typeof E=="object"?E:{message:E};this.create({id:n,type:"error",description:O,...F})}else if(r.success!==void 0){l=!1;const E=typeof r.success=="function"?await r.success(w):r.success,O=typeof r.description=="function"?await r.description(w):r.description,F=typeof E=="object"?E:{message:E};this.create({id:n,type:"success",description:O,...F})}}).catch(async w=>{if(f=["reject",w],r.error!==void 0){l=!1;const A=typeof r.error=="function"?await r.error(w):r.error,E=typeof r.description=="function"?await r.description(w):r.description,O=typeof A=="object"?A:{message:A};this.create({id:n,type:"error",description:E,...O})}}).finally(()=>{l&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),_=()=>new Promise((w,A)=>i.then(()=>f[0]==="reject"?A(f[1]):w(f[1])).catch(A));return typeof n!="string"&&typeof n!="number"?{unwrap:_}:Object.assign(n,{unwrap:_})},this.custom=(t,r)=>{const n=(r==null?void 0:r.id)||RN++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Oc=new Fse,Bse=(e,t)=>{const r=(t==null?void 0:t.id)||RN++;return Oc.addToast({title:e,...t,id:r}),r},Vse=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Use=Bse,$se=()=>Oc.toasts,qse=()=>Oc.getActiveToasts(),ki=Object.assign(Use,{success:Oc.success,info:Oc.info,warning:Oc.warning,error:Oc.error,custom:Oc.custom,message:Oc.message,promise:Oc.promise,dismiss:Oc.dismiss,loading:Oc.loading},{getHistory:$se,getToasts:qse});kse("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function vS(e){return e.label!==void 0}const Gse=3,Wse="24px",Hse="16px",G5=4e3,Kse=356,Zse=14,Yse=45,Xse=200;function Ef(...e){return e.filter(Boolean).join(" ")}function Jse(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const Qse=e=>{var t,r,n,a,l,f,i,_,w;const{invert:A,toast:E,unstyled:O,interacting:F,setHeights:U,visibleToasts:B,heights:q,index:W,toasts:Z,expanded:ne,removeToast:ae,defaultRichColors:ee,closeButton:se,style:ce,cancelButtonStyle:ge,actionButtonStyle:Te,className:Ae="",descriptionClassName:_e="",duration:Ee,position:ke,gap:Qe,expandByDefault:Ze,classNames:Ge,icons:Oe,closeButtonAriaLabel:je="Close toast"}=e,[Le,ut]=Re.useState(null),[ze,ht]=Re.useState(null),[rt,Qt]=Re.useState(!1),[Cr,vr]=Re.useState(!1),[cr,nr]=Re.useState(!1),[Kt,De]=Re.useState(!1),[er,Lt]=Re.useState(!1),[Rr,Pt]=Re.useState(0),[nn,Sn]=Re.useState(0),Br=Re.useRef(E.duration||Ee||G5),et=Re.useRef(null),bt=Re.useRef(null),zt=W===0,xr=W+1<=B,fr=E.type,pr=E.dismissible!==!1,ar=E.className||"",tn=E.descriptionClassName||"",Xn=Re.useMemo(()=>q.findIndex(qn=>qn.toastId===E.id)||0,[q,E.id]),Bi=Re.useMemo(()=>{var qn;return(qn=E.closeButton)!=null?qn:se},[E.closeButton,se]),Vi=Re.useMemo(()=>E.duration||Ee||G5,[E.duration,Ee]),io=Re.useRef(0),Va=Re.useRef(0),Vs=Re.useRef(0),yo=Re.useRef(null),[Qa,ql]=ke.split("-"),_l=Re.useMemo(()=>q.reduce((qn,ha,Ta)=>Ta>=Xn?qn:qn+ha.height,0),[q,Xn]),Os=zse(),Gl=E.invert||A,an=fr==="loading";Va.current=Re.useMemo(()=>Xn*Qe+_l,[Xn,_l]),Re.useEffect(()=>{Br.current=Vi},[Vi]),Re.useEffect(()=>{Qt(!0)},[]),Re.useEffect(()=>{const qn=bt.current;if(qn){const ha=qn.getBoundingClientRect().height;return Sn(ha),U(Ta=>[{toastId:E.id,height:ha,position:E.position},...Ta]),()=>U(Ta=>Ta.filter(ws=>ws.toastId!==E.id))}},[U,E.id]),Re.useLayoutEffect(()=>{if(!rt)return;const qn=bt.current,ha=qn.style.height;qn.style.height="auto";const Ta=qn.getBoundingClientRect().height;qn.style.height=ha,Sn(Ta),U(ws=>ws.find(Pa=>Pa.toastId===E.id)?ws.map(Pa=>Pa.toastId===E.id?{...Pa,height:Ta}:Pa):[{toastId:E.id,height:Ta,position:E.position},...ws])},[rt,E.title,E.description,U,E.id]);const es=Re.useCallback(()=>{vr(!0),Pt(Va.current),U(qn=>qn.filter(ha=>ha.toastId!==E.id)),setTimeout(()=>{ae(E)},Xse)},[E,ae,U,Va]);Re.useEffect(()=>{if(E.promise&&fr==="loading"||E.duration===1/0||E.type==="loading")return;let qn;return ne||F||Os?(()=>{if(Vs.current<io.current){const ws=new Date().getTime()-io.current;Br.current=Br.current-ws}Vs.current=new Date().getTime()})():(()=>{Br.current!==1/0&&(io.current=new Date().getTime(),qn=setTimeout(()=>{E.onAutoClose==null||E.onAutoClose.call(E,E),es()},Br.current))})(),()=>clearTimeout(qn)},[ne,F,E,fr,Os,es]),Re.useEffect(()=>{E.delete&&es()},[es,E.delete]);function Mu(){var qn;if(Oe!=null&&Oe.loading){var ha;return Re.createElement("div",{className:Ef(Ge==null?void 0:Ge.loader,E==null||(ha=E.classNames)==null?void 0:ha.loader,"sonner-loader"),"data-visible":fr==="loading"},Oe.loading)}return Re.createElement(Ose,{className:Ef(Ge==null?void 0:Ge.loader,E==null||(qn=E.classNames)==null?void 0:qn.loader),visible:fr==="loading"})}var Ua,Us;return Re.createElement("li",{tabIndex:0,ref:bt,className:Ef(Ae,ar,Ge==null?void 0:Ge.toast,E==null||(t=E.classNames)==null?void 0:t.toast,Ge==null?void 0:Ge.default,Ge==null?void 0:Ge[fr],E==null||(r=E.classNames)==null?void 0:r[fr]),"data-sonner-toast":"","data-rich-colors":(Ua=E.richColors)!=null?Ua:ee,"data-styled":!(E.jsx||E.unstyled||O),"data-mounted":rt,"data-promise":!!E.promise,"data-swiped":er,"data-removed":Cr,"data-visible":xr,"data-y-position":Qa,"data-x-position":ql,"data-index":W,"data-front":zt,"data-swiping":cr,"data-dismissible":pr,"data-type":fr,"data-invert":Gl,"data-swipe-out":Kt,"data-swipe-direction":ze,"data-expanded":!!(ne||Ze&&rt),style:{"--index":W,"--toasts-before":W,"--z-index":Z.length-W,"--offset":`${Cr?Rr:Va.current}px`,"--initial-height":Ze?"auto":`${nn}px`,...ce,...E.style},onDragEnd:()=>{nr(!1),ut(null),yo.current=null},onPointerDown:qn=>{an||!pr||(et.current=new Date,Pt(Va.current),qn.target.setPointerCapture(qn.pointerId),qn.target.tagName!=="BUTTON"&&(nr(!0),yo.current={x:qn.clientX,y:qn.clientY}))},onPointerUp:()=>{var qn,ha,Ta;if(Kt||!pr)return;yo.current=null;const ws=Number(((qn=bt.current)==null?void 0:qn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),bl=Number(((ha=bt.current)==null?void 0:ha.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Pa=new Date().getTime()-((Ta=et.current)==null?void 0:Ta.getTime()),Ns=Le==="x"?ws:bl,Ui=Math.abs(Ns)/Pa;if(Math.abs(Ns)>=Yse||Ui>.11){Pt(Va.current),E.onDismiss==null||E.onDismiss.call(E,E),ht(Le==="x"?ws>0?"right":"left":bl>0?"down":"up"),es(),De(!0);return}else{var Ss,us;(Ss=bt.current)==null||Ss.style.setProperty("--swipe-amount-x","0px"),(us=bt.current)==null||us.style.setProperty("--swipe-amount-y","0px")}Lt(!1),nr(!1),ut(null)},onPointerMove:qn=>{var ha,Ta,ws;if(!yo.current||!pr||((ha=window.getSelection())==null?void 0:ha.toString().length)>0)return;const Pa=qn.clientY-yo.current.y,Ns=qn.clientX-yo.current.x;var Ui;const Ss=(Ui=e.swipeDirections)!=null?Ui:Jse(ke);!Le&&(Math.abs(Ns)>1||Math.abs(Pa)>1)&&ut(Math.abs(Ns)>Math.abs(Pa)?"x":"y");let us={x:0,y:0};const ju=Hi=>1/(1.5+Math.abs(Hi)/20);if(Le==="y"){if(Ss.includes("top")||Ss.includes("bottom"))if(Ss.includes("top")&&Pa<0||Ss.includes("bottom")&&Pa>0)us.y=Pa;else{const Hi=Pa*ju(Pa);us.y=Math.abs(Hi)<Math.abs(Pa)?Hi:Pa}}else if(Le==="x"&&(Ss.includes("left")||Ss.includes("right")))if(Ss.includes("left")&&Ns<0||Ss.includes("right")&&Ns>0)us.x=Ns;else{const Hi=Ns*ju(Ns);us.x=Math.abs(Hi)<Math.abs(Ns)?Hi:Ns}(Math.abs(us.x)>0||Math.abs(us.y)>0)&&Lt(!0),(Ta=bt.current)==null||Ta.style.setProperty("--swipe-amount-x",`${us.x}px`),(ws=bt.current)==null||ws.style.setProperty("--swipe-amount-y",`${us.y}px`)}},Bi&&!E.jsx&&fr!=="loading"?Re.createElement("button",{"aria-label":je,"data-disabled":an,"data-close-button":!0,onClick:an||!pr?()=>{}:()=>{es(),E.onDismiss==null||E.onDismiss.call(E,E)},className:Ef(Ge==null?void 0:Ge.closeButton,E==null||(n=E.classNames)==null?void 0:n.closeButton)},(Us=Oe==null?void 0:Oe.close)!=null?Us:Lse):null,fr||E.icon||E.promise?Re.createElement("div",{"data-icon":"",className:Ef(Ge==null?void 0:Ge.icon,E==null||(a=E.classNames)==null?void 0:a.icon)},E.promise||E.type==="loading"&&!E.icon?E.icon||Mu():null,E.type!=="loading"?E.icon||(Oe==null?void 0:Oe[fr])||Mse(fr):null):null,Re.createElement("div",{"data-content":"",className:Ef(Ge==null?void 0:Ge.content,E==null||(l=E.classNames)==null?void 0:l.content)},Re.createElement("div",{"data-title":"",className:Ef(Ge==null?void 0:Ge.title,E==null||(f=E.classNames)==null?void 0:f.title)},E.jsx?E.jsx:typeof E.title=="function"?E.title():E.title),E.description?Re.createElement("div",{"data-description":"",className:Ef(_e,tn,Ge==null?void 0:Ge.description,E==null||(i=E.classNames)==null?void 0:i.description)},typeof E.description=="function"?E.description():E.description):null),Re.isValidElement(E.cancel)?E.cancel:E.cancel&&vS(E.cancel)?Re.createElement("button",{"data-button":!0,"data-cancel":!0,style:E.cancelButtonStyle||ge,onClick:qn=>{vS(E.cancel)&&pr&&(E.cancel.onClick==null||E.cancel.onClick.call(E.cancel,qn),es())},className:Ef(Ge==null?void 0:Ge.cancelButton,E==null||(_=E.classNames)==null?void 0:_.cancelButton)},E.cancel.label):null,Re.isValidElement(E.action)?E.action:E.action&&vS(E.action)?Re.createElement("button",{"data-button":!0,"data-action":!0,style:E.actionButtonStyle||Te,onClick:qn=>{vS(E.action)&&(E.action.onClick==null||E.action.onClick.call(E.action,qn),!qn.defaultPrevented&&es())},className:Ef(Ge==null?void 0:Ge.actionButton,E==null||(w=E.classNames)==null?void 0:w.actionButton)},E.action.label):null)};function W5(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function eoe(e,t){const r={};return[e,t].forEach((n,a)=>{const l=a===1,f=l?"--mobile-offset":"--offset",i=l?Hse:Wse;function _(w){["top","right","bottom","left"].forEach(A=>{r[`${f}-${A}`]=typeof w=="number"?`${w}px`:w})}typeof n=="number"||typeof n=="string"?_(n):typeof n=="object"?["top","right","bottom","left"].forEach(w=>{n[w]===void 0?r[`${f}-${w}`]=i:r[`${f}-${w}`]=typeof n[w]=="number"?`${n[w]}px`:n[w]}):_(i)}),r}const toe=Re.forwardRef(function(t,r){const{invert:n,position:a="bottom-right",hotkey:l=["altKey","KeyT"],expand:f,closeButton:i,className:_,offset:w,mobileOffset:A,theme:E="light",richColors:O,duration:F,style:U,visibleToasts:B=Gse,toastOptions:q,dir:W=W5(),gap:Z=Zse,icons:ne,containerAriaLabel:ae="Notifications"}=t,[ee,se]=Re.useState([]),ce=Re.useMemo(()=>Array.from(new Set([a].concat(ee.filter(ze=>ze.position).map(ze=>ze.position)))),[ee,a]),[ge,Te]=Re.useState([]),[Ae,_e]=Re.useState(!1),[Ee,ke]=Re.useState(!1),[Qe,Ze]=Re.useState(E!=="system"?E:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Ge=Re.useRef(null),Oe=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),je=Re.useRef(null),Le=Re.useRef(!1),ut=Re.useCallback(ze=>{se(ht=>{var rt;return(rt=ht.find(Qt=>Qt.id===ze.id))!=null&&rt.delete||Oc.dismiss(ze.id),ht.filter(({id:Qt})=>Qt!==ze.id)})},[]);return Re.useEffect(()=>Oc.subscribe(ze=>{if(ze.dismiss){const ht=ee.map(rt=>rt.id===ze.id?{...rt,delete:!0}:rt);requestAnimationFrame(()=>{se(ht)});return}setTimeout(()=>{eW.flushSync(()=>{se(ht=>{const rt=ht.findIndex(Qt=>Qt.id===ze.id);return rt!==-1?[...ht.slice(0,rt),{...ht[rt],...ze},...ht.slice(rt+1)]:[ze,...ht]})})})}),[ee]),Re.useEffect(()=>{if(E!=="system"){Ze(E);return}if(E==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Ze("dark"):Ze("light")),typeof window>"u")return;const ze=window.matchMedia("(prefers-color-scheme: dark)");try{ze.addEventListener("change",({matches:ht})=>{Ze(ht?"dark":"light")})}catch{ze.addListener(({matches:rt})=>{try{Ze(rt?"dark":"light")}catch(Qt){console.error(Qt)}})}},[E]),Re.useEffect(()=>{ee.length<=1&&_e(!1)},[ee]),Re.useEffect(()=>{const ze=ht=>{var rt;if(l.every(vr=>ht[vr]||ht.code===vr)){var Cr;_e(!0),(Cr=Ge.current)==null||Cr.focus()}ht.code==="Escape"&&(document.activeElement===Ge.current||(rt=Ge.current)!=null&&rt.contains(document.activeElement))&&_e(!1)};return document.addEventListener("keydown",ze),()=>document.removeEventListener("keydown",ze)},[l]),Re.useEffect(()=>{if(Ge.current)return()=>{je.current&&(je.current.focus({preventScroll:!0}),je.current=null,Le.current=!1)}},[Ge.current]),Re.createElement("section",{ref:r,"aria-label":`${ae} ${Oe}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ce.map((ze,ht)=>{var rt;const[Qt,Cr]=ze.split("-");return ee.length?Re.createElement("ol",{key:ze,dir:W==="auto"?W5():W,tabIndex:-1,ref:Ge,className:_,"data-sonner-toaster":!0,"data-sonner-theme":Qe,"data-y-position":Qt,"data-lifted":Ae&&ee.length>1&&!f,"data-x-position":Cr,style:{"--front-toast-height":`${((rt=ge[0])==null?void 0:rt.height)||0}px`,"--width":`${Kse}px`,"--gap":`${Z}px`,...U,...eoe(w,A)},onBlur:vr=>{Le.current&&!vr.currentTarget.contains(vr.relatedTarget)&&(Le.current=!1,je.current&&(je.current.focus({preventScroll:!0}),je.current=null))},onFocus:vr=>{vr.target instanceof HTMLElement&&vr.target.dataset.dismissible==="false"||Le.current||(Le.current=!0,je.current=vr.relatedTarget)},onMouseEnter:()=>_e(!0),onMouseMove:()=>_e(!0),onMouseLeave:()=>{Ee||_e(!1)},onDragEnd:()=>_e(!1),onPointerDown:vr=>{vr.target instanceof HTMLElement&&vr.target.dataset.dismissible==="false"||ke(!0)},onPointerUp:()=>ke(!1)},ee.filter(vr=>!vr.position&&ht===0||vr.position===ze).map((vr,cr)=>{var nr,Kt;return Re.createElement(Qse,{key:vr.id,icons:ne,index:cr,toast:vr,defaultRichColors:O,duration:(nr=q==null?void 0:q.duration)!=null?nr:F,className:q==null?void 0:q.className,descriptionClassName:q==null?void 0:q.descriptionClassName,invert:n,visibleToasts:B,closeButton:(Kt=q==null?void 0:q.closeButton)!=null?Kt:i,interacting:Ee,position:ze,style:q==null?void 0:q.style,unstyled:q==null?void 0:q.unstyled,classNames:q==null?void 0:q.classNames,cancelButtonStyle:q==null?void 0:q.cancelButtonStyle,actionButtonStyle:q==null?void 0:q.actionButtonStyle,closeButtonAriaLabel:q==null?void 0:q.closeButtonAriaLabel,removeToast:ut,toasts:ee.filter(De=>De.position==vr.position),heights:ge.filter(De=>De.position==vr.position),setHeights:Te,expandByDefault:f,gap:Z,expanded:Ae,swipeDirections:t.swipeDirections})})):null}))}),roe=({...e})=>{const{theme:t="system"}=Tse();return u.jsx(toe,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Eb={},H5;function noe(){if(H5)return Eb;H5=1,Object.defineProperty(Eb,"__esModule",{value:!0}),Eb.parse=f,Eb.serialize=w;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,l=(()=>{const O=function(){};return O.prototype=Object.create(null),O})();function f(O,F){const U=new l,B=O.length;if(B<2)return U;const q=(F==null?void 0:F.decode)||A;let W=0;do{const Z=O.indexOf("=",W);if(Z===-1)break;const ne=O.indexOf(";",W),ae=ne===-1?B:ne;if(Z>ae){W=O.lastIndexOf(";",Z-1)+1;continue}const ee=i(O,W,Z),se=_(O,Z,ee),ce=O.slice(ee,se);if(U[ce]===void 0){let ge=i(O,Z+1,ae),Te=_(O,ae,ge);const Ae=q(O.slice(ge,Te));U[ce]=Ae}W=ae+1}while(W<B);return U}function i(O,F,U){do{const B=O.charCodeAt(F);if(B!==32&&B!==9)return F}while(++F<U);return U}function _(O,F,U){for(;F>U;){const B=O.charCodeAt(--F);if(B!==32&&B!==9)return F+1}return U}function w(O,F,U){const B=(U==null?void 0:U.encode)||encodeURIComponent;if(!e.test(O))throw new TypeError(`argument name is invalid: ${O}`);const q=B(F);if(!t.test(q))throw new TypeError(`argument val is invalid: ${F}`);let W=O+"="+q;if(!U)return W;if(U.maxAge!==void 0){if(!Number.isInteger(U.maxAge))throw new TypeError(`option maxAge is invalid: ${U.maxAge}`);W+="; Max-Age="+U.maxAge}if(U.domain){if(!r.test(U.domain))throw new TypeError(`option domain is invalid: ${U.domain}`);W+="; Domain="+U.domain}if(U.path){if(!n.test(U.path))throw new TypeError(`option path is invalid: ${U.path}`);W+="; Path="+U.path}if(U.expires){if(!E(U.expires)||!Number.isFinite(U.expires.valueOf()))throw new TypeError(`option expires is invalid: ${U.expires}`);W+="; Expires="+U.expires.toUTCString()}if(U.httpOnly&&(W+="; HttpOnly"),U.secure&&(W+="; Secure"),U.partitioned&&(W+="; Partitioned"),U.priority)switch(typeof U.priority=="string"?U.priority.toLowerCase():void 0){case"low":W+="; Priority=Low";break;case"medium":W+="; Priority=Medium";break;case"high":W+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${U.priority}`)}if(U.sameSite)switch(typeof U.sameSite=="string"?U.sameSite.toLowerCase():U.sameSite){case!0:case"strict":W+="; SameSite=Strict";break;case"lax":W+="; SameSite=Lax";break;case"none":W+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${U.sameSite}`)}return W}function A(O){if(O.indexOf("%")===-1)return O;try{return decodeURIComponent(O)}catch{return O}}function E(O){return a.call(O)==="[object Date]"}return Eb}noe();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var K5="popstate";function ioe(e={}){function t(n,a){let{pathname:l,search:f,hash:i}=n.location;return IN("",{pathname:l,search:f,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:v1(a)}return soe(t,r,null,e)}function bs(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function jh(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aoe(){return Math.random().toString(36).substring(2,10)}function Z5(e,t){return{usr:e.state,key:e.key,idx:t}}function IN(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?c_(t):t,state:r,key:t&&t.key||n||aoe()}}function v1({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function c_(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function soe(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:l=!1}=n,f=a.history,i="POP",_=null,w=A();w==null&&(w=0,f.replaceState({...f.state,idx:w},""));function A(){return(f.state||{idx:null}).idx}function E(){i="POP";let q=A(),W=q==null?null:q-w;w=q,_&&_({action:i,location:B.location,delta:W})}function O(q,W){i="PUSH";let Z=IN(B.location,q,W);w=A()+1;let ne=Z5(Z,w),ae=B.createHref(Z);try{f.pushState(ne,"",ae)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;a.location.assign(ae)}l&&_&&_({action:i,location:B.location,delta:1})}function F(q,W){i="REPLACE";let Z=IN(B.location,q,W);w=A();let ne=Z5(Z,w),ae=B.createHref(Z);f.replaceState(ne,"",ae),l&&_&&_({action:i,location:B.location,delta:0})}function U(q){let W=a.location.origin!=="null"?a.location.origin:a.location.href,Z=typeof q=="string"?q:v1(q);return Z=Z.replace(/ $/,"%20"),bs(W,`No window.location.(origin|href) available to create URL for href: ${Z}`),new URL(Z,W)}let B={get action(){return i},get location(){return e(a,f)},listen(q){if(_)throw new Error("A history only accepts one active listener");return a.addEventListener(K5,E),_=q,()=>{a.removeEventListener(K5,E),_=null}},createHref(q){return t(a,q)},createURL:U,encodeLocation(q){let W=U(q);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:O,replace:F,go(q){return f.go(q)}};return B}function tW(e,t,r="/"){return ooe(e,t,r,!1)}function ooe(e,t,r,n){let a=typeof t=="string"?c_(t):t,l=um(a.pathname||"/",r);if(l==null)return null;let f=rW(e);loe(f);let i=null;for(let _=0;i==null&&_<f.length;++_){let w=xoe(l);i=yoe(f[_],w,n)}return i}function rW(e,t=[],r=[],n=""){let a=(l,f,i)=>{let _={relativePath:i===void 0?l.path||"":i,caseSensitive:l.caseSensitive===!0,childrenIndex:f,route:l};_.relativePath.startsWith("/")&&(bs(_.relativePath.startsWith(n),`Absolute route path "${_.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(n.length));let w=am([n,_.relativePath]),A=r.concat(_);l.children&&l.children.length>0&&(bs(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),rW(l.children,t,A,w)),!(l.path==null&&!l.index)&&t.push({path:w,score:moe(w,l.index),routesMeta:A})};return e.forEach((l,f)=>{var i;if(l.path===""||!((i=l.path)!=null&&i.includes("?")))a(l,f);else for(let _ of nW(l.path))a(l,f,_)}),t}function nW(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let f=nW(n.join("/")),i=[];return i.push(...f.map(_=>_===""?l:[l,_].join("/"))),a&&i.push(...f),i.map(_=>e.startsWith("/")&&_===""?"/":_)}function loe(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:goe(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var coe=/^:[\w-]+$/,uoe=3,doe=2,hoe=1,foe=10,poe=-2,Y5=e=>e==="*";function moe(e,t){let r=e.split("/"),n=r.length;return r.some(Y5)&&(n+=poe),t&&(n+=doe),r.filter(a=>!Y5(a)).reduce((a,l)=>a+(coe.test(l)?uoe:l===""?hoe:foe),n)}function goe(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function yoe(e,t,r=!1){let{routesMeta:n}=e,a={},l="/",f=[];for(let i=0;i<n.length;++i){let _=n[i],w=i===n.length-1,A=l==="/"?t:t.slice(l.length)||"/",E=gA({path:_.relativePath,caseSensitive:_.caseSensitive,end:w},A),O=_.route;if(!E&&w&&r&&!n[n.length-1].route.index&&(E=gA({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},A)),!E)return null;Object.assign(a,E.params),f.push({params:a,pathname:am([l,E.pathname]),pathnameBase:Soe(am([l,E.pathnameBase])),route:O}),E.pathnameBase!=="/"&&(l=am([l,E.pathnameBase]))}return f}function gA(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=voe(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let l=a[0],f=l.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((w,{paramName:A,isOptional:E},O)=>{if(A==="*"){let U=i[O]||"";f=l.slice(0,l.length-U.length).replace(/(.)\/+$/,"$1")}const F=i[O];return E&&!F?w[A]=void 0:w[A]=(F||"").replace(/%2F/g,"/"),w},{}),pathname:l,pathnameBase:f,pattern:e}}function voe(e,t=!1,r=!0){jh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,i,_)=>(n.push({paramName:i,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function xoe(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return jh(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function um(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function _oe(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?c_(e):e;return{pathname:r?r.startsWith("/")?r:boe(r,t):t,search:Aoe(n),hash:Toe(a)}}function boe(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function RE(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function woe(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function _3(e){let t=woe(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function b3(e,t,r,n=!1){let a;typeof e=="string"?a=c_(e):(a={...e},bs(!a.pathname||!a.pathname.includes("?"),RE("?","pathname","search",a)),bs(!a.pathname||!a.pathname.includes("#"),RE("#","pathname","hash",a)),bs(!a.search||!a.search.includes("#"),RE("#","search","hash",a)));let l=e===""||a.pathname==="",f=l?"/":a.pathname,i;if(f==null)i=r;else{let E=t.length-1;if(!n&&f.startsWith("..")){let O=f.split("/");for(;O[0]==="..";)O.shift(),E-=1;a.pathname=O.join("/")}i=E>=0?t[E]:"/"}let _=_oe(a,i),w=f&&f!=="/"&&f.endsWith("/"),A=(l||f===".")&&r.endsWith("/");return!_.pathname.endsWith("/")&&(w||A)&&(_.pathname+="/"),_}var am=e=>e.join("/").replace(/\/\/+/g,"/"),Soe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Aoe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Toe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Poe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var iW=["POST","PUT","PATCH","DELETE"];new Set(iW);var Coe=["GET",...iW];new Set(Coe);var u_=H.createContext(null);u_.displayName="DataRouter";var XT=H.createContext(null);XT.displayName="DataRouterState";var aW=H.createContext({isTransitioning:!1});aW.displayName="ViewTransition";var Eoe=H.createContext(new Map);Eoe.displayName="Fetchers";var koe=H.createContext(null);koe.displayName="Await";var Vh=H.createContext(null);Vh.displayName="Navigation";var Nw=H.createContext(null);Nw.displayName="Location";var Ed=H.createContext({outlet:null,matches:[],isDataRoute:!1});Ed.displayName="Route";var w3=H.createContext(null);w3.displayName="RouteError";function Moe(e,{relative:t}={}){bs(d_(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=H.useContext(Vh),{hash:a,pathname:l,search:f}=Rw(e,{relative:t}),i=l;return r!=="/"&&(i=l==="/"?r:am([r,l])),n.createHref({pathname:i,search:f,hash:a})}function d_(){return H.useContext(Nw)!=null}function no(){return bs(d_(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(Nw).location}var sW="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function oW(e){H.useContext(Vh).static||H.useLayoutEffect(e)}function Na(){let{isDataRoute:e}=H.useContext(Ed);return e?Goe():joe()}function joe(){bs(d_(),"useNavigate() may be used only in the context of a <Router> component.");let e=H.useContext(u_),{basename:t,navigator:r}=H.useContext(Vh),{matches:n}=H.useContext(Ed),{pathname:a}=no(),l=JSON.stringify(_3(n)),f=H.useRef(!1);return oW(()=>{f.current=!0}),H.useCallback((_,w={})=>{if(jh(f.current,sW),!f.current)return;if(typeof _=="number"){r.go(_);return}let A=b3(_,JSON.parse(l),a,w.relative==="path");e==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:am([t,A.pathname])),(w.replace?r.replace:r.push)(A,w.state,w)},[t,r,l,a,e])}var Ooe=H.createContext(null);function Noe(e){let t=H.useContext(Ed).outlet;return t&&H.createElement(Ooe.Provider,{value:e},t)}function _m(){let{matches:e}=H.useContext(Ed),t=e[e.length-1];return t?t.params:{}}function Rw(e,{relative:t}={}){let{matches:r}=H.useContext(Ed),{pathname:n}=no(),a=JSON.stringify(_3(r));return H.useMemo(()=>b3(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function Roe(e,t){return lW(e,t)}function lW(e,t,r,n){var Z;bs(d_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:l}=H.useContext(Vh),{matches:f}=H.useContext(Ed),i=f[f.length-1],_=i?i.params:{},w=i?i.pathname:"/",A=i?i.pathnameBase:"/",E=i&&i.route;{let ne=E&&E.path||"";cW(w,!E||ne.endsWith("*")||ne.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${ne}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${ne}"> to <Route path="${ne==="/"?"*":`${ne}/*`}">.`)}let O=no(),F;if(t){let ne=typeof t=="string"?c_(t):t;bs(A==="/"||((Z=ne.pathname)==null?void 0:Z.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${ne.pathname}" was given in the \`location\` prop.`),F=ne}else F=O;let U=F.pathname||"/",B=U;if(A!=="/"){let ne=A.replace(/^\//,"").split("/");B="/"+U.replace(/^\//,"").split("/").slice(ne.length).join("/")}let q=!l&&r&&r.matches&&r.matches.length>0?r.matches:tW(e,{pathname:B});jh(E||q!=null,`No routes matched location "${F.pathname}${F.search}${F.hash}" `),jh(q==null||q[q.length-1].route.element!==void 0||q[q.length-1].route.Component!==void 0||q[q.length-1].route.lazy!==void 0,`Matched leaf route at location "${F.pathname}${F.search}${F.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let W=Foe(q&&q.map(ne=>Object.assign({},ne,{params:Object.assign({},_,ne.params),pathname:am([A,a.encodeLocation?a.encodeLocation(ne.pathname).pathname:ne.pathname]),pathnameBase:ne.pathnameBase==="/"?A:am([A,a.encodeLocation?a.encodeLocation(ne.pathnameBase).pathname:ne.pathnameBase])})),f,r,n);return t&&W?H.createElement(Nw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...F},navigationType:"POP"}},W):W}function Ioe(){let e=qoe(),t=Poe(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},f=null;return console.error("Error handled by React Router default ErrorBoundary:",e),f=H.createElement(H.Fragment,null,H.createElement("p",null," Hey developer "),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:l},"ErrorBoundary")," or"," ",H.createElement("code",{style:l},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},t),r?H.createElement("pre",{style:a},r):null,f)}var Doe=H.createElement(Ioe,null),Loe=class extends H.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?H.createElement(Ed.Provider,{value:this.props.routeContext},H.createElement(w3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function zoe({routeContext:e,match:t,children:r}){let n=H.useContext(u_);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),H.createElement(Ed.Provider,{value:e},r)}function Foe(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,l=r==null?void 0:r.errors;if(l!=null){let _=a.findIndex(w=>w.route.id&&(l==null?void 0:l[w.route.id])!==void 0);bs(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,_+1))}let f=!1,i=-1;if(r)for(let _=0;_<a.length;_++){let w=a[_];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(i=_),w.route.id){let{loaderData:A,errors:E}=r,O=w.route.loader&&!A.hasOwnProperty(w.route.id)&&(!E||E[w.route.id]===void 0);if(w.route.lazy||O){f=!0,i>=0?a=a.slice(0,i+1):a=[a[0]];break}}}return a.reduceRight((_,w,A)=>{let E,O=!1,F=null,U=null;r&&(E=l&&w.route.id?l[w.route.id]:void 0,F=w.route.errorElement||Doe,f&&(i<0&&A===0?(cW("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),O=!0,U=null):i===A&&(O=!0,U=w.route.hydrateFallbackElement||null)));let B=t.concat(a.slice(0,A+1)),q=()=>{let W;return E?W=F:O?W=U:w.route.Component?W=H.createElement(w.route.Component,null):w.route.element?W=w.route.element:W=_,H.createElement(zoe,{match:w,routeContext:{outlet:_,matches:B,isDataRoute:r!=null},children:W})};return r&&(w.route.ErrorBoundary||w.route.errorElement||A===0)?H.createElement(Loe,{location:r.location,revalidation:r.revalidation,component:F,error:E,children:q(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):q()},null)}function S3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Boe(e){let t=H.useContext(u_);return bs(t,S3(e)),t}function Voe(e){let t=H.useContext(XT);return bs(t,S3(e)),t}function Uoe(e){let t=H.useContext(Ed);return bs(t,S3(e)),t}function A3(e){let t=Uoe(e),r=t.matches[t.matches.length-1];return bs(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function $oe(){return A3("useRouteId")}function qoe(){var n;let e=H.useContext(w3),t=Voe("useRouteError"),r=A3("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Goe(){let{router:e}=Boe("useNavigate"),t=A3("useNavigate"),r=H.useRef(!1);return oW(()=>{r.current=!0}),H.useCallback(async(a,l={})=>{jh(r.current,sW),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...l}))},[e,t])}var X5={};function cW(e,t,r){!t&&!X5[e]&&(X5[e]=!0,jh(!1,r))}H.memo(Woe);function Woe({routes:e,future:t,state:r}){return lW(e,void 0,r,t)}function T3({to:e,replace:t,state:r,relative:n}){bs(d_(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=H.useContext(Vh);jh(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=H.useContext(Ed),{pathname:f}=no(),i=Na(),_=b3(e,_3(l),f,n==="path"),w=JSON.stringify(_);return H.useEffect(()=>{i(JSON.parse(w),{replace:t,state:r,relative:n})},[i,w,n,t,r]),null}function uW(e){return Noe(e.context)}function Wa(e){bs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Hoe({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:l=!1}){bs(!d_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=e.replace(/^\/*/,"/"),i=H.useMemo(()=>({basename:f,navigator:a,static:l,future:{}}),[f,a,l]);typeof r=="string"&&(r=c_(r));let{pathname:_="/",search:w="",hash:A="",state:E=null,key:O="default"}=r,F=H.useMemo(()=>{let U=um(_,f);return U==null?null:{location:{pathname:U,search:w,hash:A,state:E,key:O},navigationType:n}},[f,_,w,A,E,O,n]);return jh(F!=null,`<Router basename="${f}"> is not able to match the URL "${_}${w}${A}" because it does not start with the basename, so the <Router> won't render anything.`),F==null?null:H.createElement(Vh.Provider,{value:i},H.createElement(Nw.Provider,{children:t,value:F}))}function Koe({children:e,location:t}){return Roe(DN(e),t)}function DN(e,t=[]){let r=[];return H.Children.forEach(e,(n,a)=>{if(!H.isValidElement(n))return;let l=[...t,a];if(n.type===H.Fragment){r.push.apply(r,DN(n.props.children,l));return}bs(n.type===Wa,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let f={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(f.children=DN(n.props.children,l)),r.push(f)}),r}var JS="get",QS="application/x-www-form-urlencoded";function JT(e){return e!=null&&typeof e.tagName=="string"}function Zoe(e){return JT(e)&&e.tagName.toLowerCase()==="button"}function Yoe(e){return JT(e)&&e.tagName.toLowerCase()==="form"}function Xoe(e){return JT(e)&&e.tagName.toLowerCase()==="input"}function Joe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Qoe(e,t){return e.button===0&&(!t||t==="_self")&&!Joe(e)}var xS=null;function ele(){if(xS===null)try{new FormData(document.createElement("form"),0),xS=!1}catch{xS=!0}return xS}var tle=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function IE(e){return e!=null&&!tle.has(e)?(jh(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${QS}"`),null):e}function rle(e,t){let r,n,a,l,f;if(Yoe(e)){let i=e.getAttribute("action");n=i?um(i,t):null,r=e.getAttribute("method")||JS,a=IE(e.getAttribute("enctype"))||QS,l=new FormData(e)}else if(Zoe(e)||Xoe(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let _=e.getAttribute("formaction")||i.getAttribute("action");if(n=_?um(_,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||JS,a=IE(e.getAttribute("formenctype"))||IE(i.getAttribute("enctype"))||QS,l=new FormData(i,e),!ele()){let{name:w,type:A,value:E}=e;if(A==="image"){let O=w?`${w}.`:"";l.append(`${O}x`,"0"),l.append(`${O}y`,"0")}else w&&l.append(w,E)}}else{if(JT(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=JS,n=null,a=QS,f=e}return l&&a==="text/plain"&&(f=l,l=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:l,body:f}}function P3(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function nle(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ile(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function ale(e,t,r){let n=await Promise.all(e.map(async a=>{let l=t.routes[a.route.id];if(l){let f=await nle(l,r);return f.links?f.links():[]}return[]}));return cle(n.flat(1).filter(ile).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function J5(e,t,r,n,a,l){let f=(_,w)=>r[w]?_.route.id!==r[w].route.id:!0,i=(_,w)=>{var A;return r[w].pathname!==_.pathname||((A=r[w].route.path)==null?void 0:A.endsWith("*"))&&r[w].params["*"]!==_.params["*"]};return l==="assets"?t.filter((_,w)=>f(_,w)||i(_,w)):l==="data"?t.filter((_,w)=>{var E;let A=n.routes[_.route.id];if(!A||!A.hasLoader)return!1;if(f(_,w)||i(_,w))return!0;if(_.route.shouldRevalidate){let O=_.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((E=r[0])==null?void 0:E.params)||{},nextUrl:new URL(e,window.origin),nextParams:_.params,defaultShouldRevalidate:!0});if(typeof O=="boolean")return O}return!0}):[]}function sle(e,t,{includeHydrateFallback:r}={}){return ole(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function ole(e){return[...new Set(e)]}function lle(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function cle(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let l=JSON.stringify(lle(a));return r.has(l)||(r.add(l),n.push({key:l,link:a})),n},[])}function ule(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&um(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function dW(){let e=H.useContext(u_);return P3(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function dle(){let e=H.useContext(XT);return P3(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var C3=H.createContext(void 0);C3.displayName="FrameworkContext";function hW(){let e=H.useContext(C3);return P3(e,"You must render this element inside a <HydratedRouter> element"),e}function hle(e,t){let r=H.useContext(C3),[n,a]=H.useState(!1),[l,f]=H.useState(!1),{onFocus:i,onBlur:_,onMouseEnter:w,onMouseLeave:A,onTouchStart:E}=t,O=H.useRef(null);H.useEffect(()=>{if(e==="render"&&f(!0),e==="viewport"){let B=W=>{W.forEach(Z=>{f(Z.isIntersecting)})},q=new IntersectionObserver(B,{threshold:.5});return O.current&&q.observe(O.current),()=>{q.disconnect()}}},[e]),H.useEffect(()=>{if(n){let B=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(B)}}},[n]);let F=()=>{a(!0)},U=()=>{a(!1),f(!1)};return r?e!=="intent"?[l,O,{}]:[l,O,{onFocus:kb(i,F),onBlur:kb(_,U),onMouseEnter:kb(w,F),onMouseLeave:kb(A,U),onTouchStart:kb(E,F)}]:[!1,O,{}]}function kb(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function fle({page:e,...t}){let{router:r}=dW(),n=H.useMemo(()=>tW(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?H.createElement(mle,{page:e,matches:n,...t}):null}function ple(e){let{manifest:t,routeModules:r}=hW(),[n,a]=H.useState([]);return H.useEffect(()=>{let l=!1;return ale(e,t,r).then(f=>{l||a(f)}),()=>{l=!0}},[e,t,r]),n}function mle({page:e,matches:t,...r}){let n=no(),{manifest:a,routeModules:l}=hW(),{basename:f}=dW(),{loaderData:i,matches:_}=dle(),w=H.useMemo(()=>J5(e,t,_,a,n,"data"),[e,t,_,a,n]),A=H.useMemo(()=>J5(e,t,_,a,n,"assets"),[e,t,_,a,n]),E=H.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let U=new Set,B=!1;if(t.forEach(W=>{var ne;let Z=a.routes[W.route.id];!Z||!Z.hasLoader||(!w.some(ae=>ae.route.id===W.route.id)&&W.route.id in i&&((ne=l[W.route.id])!=null&&ne.shouldRevalidate)||Z.hasClientLoader?B=!0:U.add(W.route.id))}),U.size===0)return[];let q=ule(e,f);return B&&U.size>0&&q.searchParams.set("_routes",t.filter(W=>U.has(W.route.id)).map(W=>W.route.id).join(",")),[q.pathname+q.search]},[f,i,n,a,w,t,e,l]),O=H.useMemo(()=>sle(A,a),[A,a]),F=ple(A);return H.createElement(H.Fragment,null,E.map(U=>H.createElement("link",{key:U,rel:"prefetch",as:"fetch",href:U,...r})),O.map(U=>H.createElement("link",{key:U,rel:"modulepreload",href:U,...r})),F.map(({key:U,link:B})=>H.createElement("link",{key:U,...B})))}function gle(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var fW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{fW&&(window.__reactRouterVersion="7.3.0")}catch{}function yle({basename:e,children:t,window:r}){let n=H.useRef();n.current==null&&(n.current=ioe({window:r,v5Compat:!0}));let a=n.current,[l,f]=H.useState({action:a.action,location:a.location}),i=H.useCallback(_=>{H.startTransition(()=>f(_))},[f]);return H.useLayoutEffect(()=>a.listen(i),[a,i]),H.createElement(Hoe,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:a})}var pW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jo=H.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:l,replace:f,state:i,target:_,to:w,preventScrollReset:A,viewTransition:E,...O},F){let{basename:U}=H.useContext(Vh),B=typeof w=="string"&&pW.test(w),q,W=!1;if(typeof w=="string"&&B&&(q=w,fW))try{let Te=new URL(window.location.href),Ae=w.startsWith("//")?new URL(Te.protocol+w):new URL(w),_e=um(Ae.pathname,U);Ae.origin===Te.origin&&_e!=null?w=_e+Ae.search+Ae.hash:W=!0}catch{jh(!1,`<Link to="${w}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let Z=Moe(w,{relative:a}),[ne,ae,ee]=hle(n,O),se=ble(w,{replace:f,state:i,target:_,preventScrollReset:A,relative:a,viewTransition:E});function ce(Te){t&&t(Te),Te.defaultPrevented||se(Te)}let ge=H.createElement("a",{...O,...ee,href:q||Z,onClick:W||l?t:ce,ref:gle(F,ae),target:_,"data-discover":!B&&r==="render"?"true":void 0});return ne&&!B?H.createElement(H.Fragment,null,ge,H.createElement(fle,{page:Z})):ge});jo.displayName="Link";var vle=H.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:l,to:f,viewTransition:i,children:_,...w},A){let E=Rw(f,{relative:w.relative}),O=no(),F=H.useContext(XT),{navigator:U,basename:B}=H.useContext(Vh),q=F!=null&&Ple(E)&&i===!0,W=U.encodeLocation?U.encodeLocation(E).pathname:E.pathname,Z=O.pathname,ne=F&&F.navigation&&F.navigation.location?F.navigation.location.pathname:null;r||(Z=Z.toLowerCase(),ne=ne?ne.toLowerCase():null,W=W.toLowerCase()),ne&&B&&(ne=um(ne,B)||ne);const ae=W!=="/"&&W.endsWith("/")?W.length-1:W.length;let ee=Z===W||!a&&Z.startsWith(W)&&Z.charAt(ae)==="/",se=ne!=null&&(ne===W||!a&&ne.startsWith(W)&&ne.charAt(W.length)==="/"),ce={isActive:ee,isPending:se,isTransitioning:q},ge=ee?t:void 0,Te;typeof n=="function"?Te=n(ce):Te=[n,ee?"active":null,se?"pending":null,q?"transitioning":null].filter(Boolean).join(" ");let Ae=typeof l=="function"?l(ce):l;return H.createElement(jo,{...w,"aria-current":ge,className:Te,ref:A,style:Ae,to:f,viewTransition:i},typeof _=="function"?_(ce):_)});vle.displayName="NavLink";var xle=H.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:l,method:f=JS,action:i,onSubmit:_,relative:w,preventScrollReset:A,viewTransition:E,...O},F)=>{let U=Ale(),B=Tle(i,{relative:w}),q=f.toLowerCase()==="get"?"get":"post",W=typeof i=="string"&&pW.test(i),Z=ne=>{if(_&&_(ne),ne.defaultPrevented)return;ne.preventDefault();let ae=ne.nativeEvent.submitter,ee=(ae==null?void 0:ae.getAttribute("formmethod"))||f;U(ae||ne.currentTarget,{fetcherKey:t,method:ee,navigate:r,replace:a,state:l,relative:w,preventScrollReset:A,viewTransition:E})};return H.createElement("form",{ref:F,method:q,action:B,onSubmit:n?_:Z,...O,"data-discover":!W&&e==="render"?"true":void 0})});xle.displayName="Form";function _le(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function mW(e){let t=H.useContext(u_);return bs(t,_le(e)),t}function ble(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:l,viewTransition:f}={}){let i=Na(),_=no(),w=Rw(e,{relative:l});return H.useCallback(A=>{if(Qoe(A,t)){A.preventDefault();let E=r!==void 0?r:v1(_)===v1(w);i(e,{replace:E,state:n,preventScrollReset:a,relative:l,viewTransition:f})}},[_,i,w,r,n,t,e,a,l,f])}var wle=0,Sle=()=>`__${String(++wle)}__`;function Ale(){let{router:e}=mW("useSubmit"),{basename:t}=H.useContext(Vh),r=$oe();return H.useCallback(async(n,a={})=>{let{action:l,method:f,encType:i,formData:_,body:w}=rle(n,t);if(a.navigate===!1){let A=a.fetcherKey||Sle();await e.fetch(A,r,a.action||l,{preventScrollReset:a.preventScrollReset,formData:_,body:w,formMethod:a.method||f,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:_,body:w,formMethod:a.method||f,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function Tle(e,{relative:t}={}){let{basename:r}=H.useContext(Vh),n=H.useContext(Ed);bs(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),l={...Rw(e||".",{relative:t})},f=no();if(e==null){l.search=f.search;let i=new URLSearchParams(l.search),_=i.getAll("index");if(_.some(A=>A==="")){i.delete("index"),_.filter(E=>E).forEach(E=>i.append("index",E));let A=i.toString();l.search=A?`?${A}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:am([r,l.pathname])),v1(l)}function Ple(e,t={}){let r=H.useContext(aW);bs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=mW("useViewTransitionState"),a=Rw(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=um(r.currentLocation.pathname,n)||r.currentLocation.pathname,f=um(r.nextLocation.pathname,n)||r.nextLocation.pathname;return gA(a.pathname,f)!=null||gA(a.pathname,l)!=null}new TextEncoder;const Cle="/assets/lto-C2OlZVWi.svg";function Q5(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function QT(...e){return t=>{let r=!1;const n=e.map(a=>{const l=Q5(a,t);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let a=0;a<n.length;a++){const l=n[a];typeof l=="function"?l():Q5(e[a],null)}}}}function Xi(...e){return H.useCallback(QT(...e),e)}var Ul=H.forwardRef((e,t)=>{const{children:r,...n}=e,a=H.Children.toArray(r),l=a.find(Ele);if(l){const f=l.props.children,i=a.map(_=>_===l?H.Children.count(f)>1?H.Children.only(null):H.isValidElement(f)?f.props.children:null:_);return u.jsx(LN,{...n,ref:t,children:H.isValidElement(f)?H.cloneElement(f,void 0,i):null})}return u.jsx(LN,{...n,ref:t,children:r})});Ul.displayName="Slot";var LN=H.forwardRef((e,t)=>{const{children:r,...n}=e;if(H.isValidElement(r)){const a=Mle(r),l=kle(n,r.props);return r.type!==H.Fragment&&(l.ref=t?QT(t,a):a),H.cloneElement(r,l)}return H.Children.count(r)>1?H.Children.only(null):null});LN.displayName="SlotClone";var E3=({children:e})=>u.jsx(u.Fragment,{children:e});function Ele(e){return H.isValidElement(e)&&e.type===E3}function kle(e,t){const r={...t};for(const n in t){const a=e[n],l=t[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...i)=>{l(...i),a(...i)}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}function Mle(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function gW(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=gW(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function hi(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=gW(e))&&(n&&(n+=" "),n+=t);return n}const eB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,tB=hi,h_=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return tB(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:l}=t,f=Object.keys(a).map(w=>{const A=r==null?void 0:r[w],E=l==null?void 0:l[w];if(A===null)return null;const O=eB(A)||eB(E);return a[w][O]}),i=r&&Object.entries(r).reduce((w,A)=>{let[E,O]=A;return O===void 0||(w[E]=O),w},{}),_=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((w,A)=>{let{class:E,className:O,...F}=A;return Object.entries(F).every(U=>{let[B,q]=U;return Array.isArray(q)?q.includes({...l,...i}[B]):{...l,...i}[B]===q})?[...w,E,O]:w},[]);return tB(e,f,_,r==null?void 0:r.class,r==null?void 0:r.className)},k3="-",jle=e=>{const t=Nle(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:f=>{const i=f.split(k3);return i[0]===""&&i.length!==1&&i.shift(),yW(i,t)||Ole(f)},getConflictingClassGroupIds:(f,i)=>{const _=r[f]||[];return i&&n[f]?[..._,...n[f]]:_}}},yW=(e,t)=>{var f;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?yW(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(k3);return(f=t.validators.find(({validator:i})=>i(l)))==null?void 0:f.classGroupId},rB=/^\[(.+)\]$/,Ole=e=>{if(rB.test(e)){const t=rB.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Nle=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)zN(r[a],n,a,t);return n},zN=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:nB(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(Rle(a)){zN(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,f])=>{zN(f,nB(t,l),r,n)})})},nB=(e,t)=>{let r=e;return t.split(k3).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Rle=e=>e.isThemeGetter,Ile=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(l,f)=>{r.set(l,f),t++,t>e&&(t=0,n=r,r=new Map)};return{get(l){let f=r.get(l);if(f!==void 0)return f;if((f=n.get(l))!==void 0)return a(l,f),f},set(l,f){r.has(l)?r.set(l,f):a(l,f)}}},FN="!",BN=":",Dle=BN.length,Lle=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const l=[];let f=0,i=0,_=0,w;for(let U=0;U<a.length;U++){let B=a[U];if(f===0&&i===0){if(B===BN){l.push(a.slice(_,U)),_=U+Dle;continue}if(B==="/"){w=U;continue}}B==="["?f++:B==="]"?f--:B==="("?i++:B===")"&&i--}const A=l.length===0?a:a.substring(_),E=zle(A),O=E!==A,F=w&&w>_?w-_:void 0;return{modifiers:l,hasImportantModifier:O,baseClassName:E,maybePostfixModifierPosition:F}};if(t){const a=t+BN,l=n;n=f=>f.startsWith(a)?l(f.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:f,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=l=>r({className:l,parseClassName:a})}return n},zle=e=>e.endsWith(FN)?e.substring(0,e.length-1):e.startsWith(FN)?e.substring(1):e,Fle=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let l=[];return n.forEach(f=>{f[0]==="["||t[f]?(a.push(...l.sort(),f),l=[]):l.push(f)}),a.push(...l.sort()),a}},Ble=e=>({cache:Ile(e.cacheSize),parseClassName:Lle(e),sortModifiers:Fle(e),...jle(e)}),Vle=/\s+/,Ule=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:l}=t,f=[],i=e.trim().split(Vle);let _="";for(let w=i.length-1;w>=0;w-=1){const A=i[w],{isExternal:E,modifiers:O,hasImportantModifier:F,baseClassName:U,maybePostfixModifierPosition:B}=r(A);if(E){_=A+(_.length>0?" "+_:_);continue}let q=!!B,W=n(q?U.substring(0,B):U);if(!W){if(!q){_=A+(_.length>0?" "+_:_);continue}if(W=n(U),!W){_=A+(_.length>0?" "+_:_);continue}q=!1}const Z=l(O).join(":"),ne=F?Z+FN:Z,ae=ne+W;if(f.includes(ae))continue;f.push(ae);const ee=a(W,q);for(let se=0;se<ee.length;++se){const ce=ee[se];f.push(ne+ce)}_=A+(_.length>0?" "+_:_)}return _};function $le(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=vW(t))&&(n&&(n+=" "),n+=r);return n}const vW=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=vW(e[n]))&&(r&&(r+=" "),r+=t);return r};function qle(e,...t){let r,n,a,l=f;function f(_){const w=t.reduce((A,E)=>E(A),e());return r=Ble(w),n=r.cache.get,a=r.cache.set,l=i,i(_)}function i(_){const w=n(_);if(w)return w;const A=Ule(_,r);return a(_,A),A}return function(){return l($le.apply(null,arguments))}}const Jo=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},xW=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,_W=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Gle=/^\d+\/\d+$/,Wle=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Hle=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Kle=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Zle=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Yle=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,q0=e=>Gle.test(e),Fi=e=>!!e&&!Number.isNaN(Number(e)),rv=e=>!!e&&Number.isInteger(Number(e)),iB=e=>e.endsWith("%")&&Fi(e.slice(0,-1)),bg=e=>Wle.test(e),Xle=()=>!0,Jle=e=>Hle.test(e)&&!Kle.test(e),M3=()=>!1,Qle=e=>Zle.test(e),ece=e=>Yle.test(e),tce=e=>!mn(e)&&!gn(e),rce=e=>f_(e,SW,M3),mn=e=>xW.test(e),nv=e=>f_(e,AW,Jle),DE=e=>f_(e,fce,Fi),nce=e=>f_(e,bW,M3),ice=e=>f_(e,wW,ece),ace=e=>f_(e,M3,Qle),gn=e=>_W.test(e),_S=e=>p_(e,AW),sce=e=>p_(e,pce),oce=e=>p_(e,bW),lce=e=>p_(e,SW),cce=e=>p_(e,wW),uce=e=>p_(e,mce,!0),f_=(e,t,r)=>{const n=xW.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},p_=(e,t,r=!1)=>{const n=_W.exec(e);return n?n[1]?t(n[1]):r:!1},bW=e=>e==="position",dce=new Set(["image","url"]),wW=e=>dce.has(e),hce=new Set(["length","size","percentage"]),SW=e=>hce.has(e),AW=e=>e==="length",fce=e=>e==="number",pce=e=>e==="family-name",mce=e=>e==="shadow",gce=()=>{const e=Jo("color"),t=Jo("font"),r=Jo("text"),n=Jo("font-weight"),a=Jo("tracking"),l=Jo("leading"),f=Jo("breakpoint"),i=Jo("container"),_=Jo("spacing"),w=Jo("radius"),A=Jo("shadow"),E=Jo("inset-shadow"),O=Jo("drop-shadow"),F=Jo("blur"),U=Jo("perspective"),B=Jo("aspect"),q=Jo("ease"),W=Jo("animate"),Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ne=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ae=()=>["auto","hidden","clip","visible","scroll"],ee=()=>["auto","contain","none"],se=()=>[gn,mn,_],ce=()=>[q0,"full","auto",...se()],ge=()=>[rv,"none","subgrid",gn,mn],Te=()=>["auto",{span:["full",rv,gn,mn]},gn,mn],Ae=()=>[rv,"auto",gn,mn],_e=()=>["auto","min","max","fr",gn,mn],Ee=()=>["start","end","center","between","around","evenly","stretch","baseline"],ke=()=>["start","end","center","stretch"],Qe=()=>["auto",...se()],Ze=()=>[q0,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...se()],Ge=()=>[e,gn,mn],Oe=()=>[iB,nv],je=()=>["","none","full",w,gn,mn],Le=()=>["",Fi,_S,nv],ut=()=>["solid","dashed","dotted","double"],ze=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ht=()=>["","none",F,gn,mn],rt=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",gn,mn],Qt=()=>["none",Fi,gn,mn],Cr=()=>["none",Fi,gn,mn],vr=()=>[Fi,gn,mn],cr=()=>[q0,"full",...se()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[bg],breakpoint:[bg],color:[Xle],container:[bg],"drop-shadow":[bg],ease:["in","out","in-out"],font:[tce],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[bg],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[bg],shadow:[bg],spacing:["px",Fi],text:[bg],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",q0,mn,gn,B]}],container:["container"],columns:[{columns:[Fi,mn,gn,i]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ne(),mn,gn]}],overflow:[{overflow:ae()}],"overflow-x":[{"overflow-x":ae()}],"overflow-y":[{"overflow-y":ae()}],overscroll:[{overscroll:ee()}],"overscroll-x":[{"overscroll-x":ee()}],"overscroll-y":[{"overscroll-y":ee()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ce()}],"inset-x":[{"inset-x":ce()}],"inset-y":[{"inset-y":ce()}],start:[{start:ce()}],end:[{end:ce()}],top:[{top:ce()}],right:[{right:ce()}],bottom:[{bottom:ce()}],left:[{left:ce()}],visibility:["visible","invisible","collapse"],z:[{z:[rv,"auto",gn,mn]}],basis:[{basis:[q0,"full","auto",i,...se()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Fi,q0,"auto","initial","none",mn]}],grow:[{grow:["",Fi,gn,mn]}],shrink:[{shrink:["",Fi,gn,mn]}],order:[{order:[rv,"first","last","none",gn,mn]}],"grid-cols":[{"grid-cols":ge()}],"col-start-end":[{col:Te()}],"col-start":[{"col-start":Ae()}],"col-end":[{"col-end":Ae()}],"grid-rows":[{"grid-rows":ge()}],"row-start-end":[{row:Te()}],"row-start":[{"row-start":Ae()}],"row-end":[{"row-end":Ae()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":_e()}],"auto-rows":[{"auto-rows":_e()}],gap:[{gap:se()}],"gap-x":[{"gap-x":se()}],"gap-y":[{"gap-y":se()}],"justify-content":[{justify:[...Ee(),"normal"]}],"justify-items":[{"justify-items":[...ke(),"normal"]}],"justify-self":[{"justify-self":["auto",...ke()]}],"align-content":[{content:["normal",...Ee()]}],"align-items":[{items:[...ke(),"baseline"]}],"align-self":[{self:["auto",...ke(),"baseline"]}],"place-content":[{"place-content":Ee()}],"place-items":[{"place-items":[...ke(),"baseline"]}],"place-self":[{"place-self":["auto",...ke()]}],p:[{p:se()}],px:[{px:se()}],py:[{py:se()}],ps:[{ps:se()}],pe:[{pe:se()}],pt:[{pt:se()}],pr:[{pr:se()}],pb:[{pb:se()}],pl:[{pl:se()}],m:[{m:Qe()}],mx:[{mx:Qe()}],my:[{my:Qe()}],ms:[{ms:Qe()}],me:[{me:Qe()}],mt:[{mt:Qe()}],mr:[{mr:Qe()}],mb:[{mb:Qe()}],ml:[{ml:Qe()}],"space-x":[{"space-x":se()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":se()}],"space-y-reverse":["space-y-reverse"],size:[{size:Ze()}],w:[{w:[i,"screen",...Ze()]}],"min-w":[{"min-w":[i,"screen","none",...Ze()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[f]},...Ze()]}],h:[{h:["screen",...Ze()]}],"min-h":[{"min-h":["screen","none",...Ze()]}],"max-h":[{"max-h":["screen",...Ze()]}],"font-size":[{text:["base",r,_S,nv]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,gn,DE]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",iB,mn]}],"font-family":[{font:[sce,mn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,gn,mn]}],"line-clamp":[{"line-clamp":[Fi,"none",gn,DE]}],leading:[{leading:[l,...se()]}],"list-image":[{"list-image":["none",gn,mn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",gn,mn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Ge()}],"text-color":[{text:Ge()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ut(),"wavy"]}],"text-decoration-thickness":[{decoration:[Fi,"from-font","auto",gn,nv]}],"text-decoration-color":[{decoration:Ge()}],"underline-offset":[{"underline-offset":[Fi,"auto",gn,mn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:se()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",gn,mn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",gn,mn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ne(),oce,nce]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",lce,rce]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},rv,gn,mn],radial:["",gn,mn],conic:[rv,gn,mn]},cce,ice]}],"bg-color":[{bg:Ge()}],"gradient-from-pos":[{from:Oe()}],"gradient-via-pos":[{via:Oe()}],"gradient-to-pos":[{to:Oe()}],"gradient-from":[{from:Ge()}],"gradient-via":[{via:Ge()}],"gradient-to":[{to:Ge()}],rounded:[{rounded:je()}],"rounded-s":[{"rounded-s":je()}],"rounded-e":[{"rounded-e":je()}],"rounded-t":[{"rounded-t":je()}],"rounded-r":[{"rounded-r":je()}],"rounded-b":[{"rounded-b":je()}],"rounded-l":[{"rounded-l":je()}],"rounded-ss":[{"rounded-ss":je()}],"rounded-se":[{"rounded-se":je()}],"rounded-ee":[{"rounded-ee":je()}],"rounded-es":[{"rounded-es":je()}],"rounded-tl":[{"rounded-tl":je()}],"rounded-tr":[{"rounded-tr":je()}],"rounded-br":[{"rounded-br":je()}],"rounded-bl":[{"rounded-bl":je()}],"border-w":[{border:Le()}],"border-w-x":[{"border-x":Le()}],"border-w-y":[{"border-y":Le()}],"border-w-s":[{"border-s":Le()}],"border-w-e":[{"border-e":Le()}],"border-w-t":[{"border-t":Le()}],"border-w-r":[{"border-r":Le()}],"border-w-b":[{"border-b":Le()}],"border-w-l":[{"border-l":Le()}],"divide-x":[{"divide-x":Le()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Le()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ut(),"hidden","none"]}],"divide-style":[{divide:[...ut(),"hidden","none"]}],"border-color":[{border:Ge()}],"border-color-x":[{"border-x":Ge()}],"border-color-y":[{"border-y":Ge()}],"border-color-s":[{"border-s":Ge()}],"border-color-e":[{"border-e":Ge()}],"border-color-t":[{"border-t":Ge()}],"border-color-r":[{"border-r":Ge()}],"border-color-b":[{"border-b":Ge()}],"border-color-l":[{"border-l":Ge()}],"divide-color":[{divide:Ge()}],"outline-style":[{outline:[...ut(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Fi,gn,mn]}],"outline-w":[{outline:["",Fi,_S,nv]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",A,uce,ace]}],"shadow-color":[{shadow:Ge()}],"inset-shadow":[{"inset-shadow":["none",gn,mn,E]}],"inset-shadow-color":[{"inset-shadow":Ge()}],"ring-w":[{ring:Le()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Ge()}],"ring-offset-w":[{"ring-offset":[Fi,nv]}],"ring-offset-color":[{"ring-offset":Ge()}],"inset-ring-w":[{"inset-ring":Le()}],"inset-ring-color":[{"inset-ring":Ge()}],opacity:[{opacity:[Fi,gn,mn]}],"mix-blend":[{"mix-blend":[...ze(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ze()}],filter:[{filter:["","none",gn,mn]}],blur:[{blur:ht()}],brightness:[{brightness:[Fi,gn,mn]}],contrast:[{contrast:[Fi,gn,mn]}],"drop-shadow":[{"drop-shadow":["","none",O,gn,mn]}],grayscale:[{grayscale:["",Fi,gn,mn]}],"hue-rotate":[{"hue-rotate":[Fi,gn,mn]}],invert:[{invert:["",Fi,gn,mn]}],saturate:[{saturate:[Fi,gn,mn]}],sepia:[{sepia:["",Fi,gn,mn]}],"backdrop-filter":[{"backdrop-filter":["","none",gn,mn]}],"backdrop-blur":[{"backdrop-blur":ht()}],"backdrop-brightness":[{"backdrop-brightness":[Fi,gn,mn]}],"backdrop-contrast":[{"backdrop-contrast":[Fi,gn,mn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Fi,gn,mn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Fi,gn,mn]}],"backdrop-invert":[{"backdrop-invert":["",Fi,gn,mn]}],"backdrop-opacity":[{"backdrop-opacity":[Fi,gn,mn]}],"backdrop-saturate":[{"backdrop-saturate":[Fi,gn,mn]}],"backdrop-sepia":[{"backdrop-sepia":["",Fi,gn,mn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":se()}],"border-spacing-x":[{"border-spacing-x":se()}],"border-spacing-y":[{"border-spacing-y":se()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",gn,mn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Fi,"initial",gn,mn]}],ease:[{ease:["linear","initial",q,gn,mn]}],delay:[{delay:[Fi,gn,mn]}],animate:[{animate:["none",W,gn,mn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[U,gn,mn]}],"perspective-origin":[{"perspective-origin":rt()}],rotate:[{rotate:Qt()}],"rotate-x":[{"rotate-x":Qt()}],"rotate-y":[{"rotate-y":Qt()}],"rotate-z":[{"rotate-z":Qt()}],scale:[{scale:Cr()}],"scale-x":[{"scale-x":Cr()}],"scale-y":[{"scale-y":Cr()}],"scale-z":[{"scale-z":Cr()}],"scale-3d":["scale-3d"],skew:[{skew:vr()}],"skew-x":[{"skew-x":vr()}],"skew-y":[{"skew-y":vr()}],transform:[{transform:[gn,mn,"","none","gpu","cpu"]}],"transform-origin":[{origin:rt()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:cr()}],"translate-x":[{"translate-x":cr()}],"translate-y":[{"translate-y":cr()}],"translate-z":[{"translate-z":cr()}],"translate-none":["translate-none"],accent:[{accent:Ge()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Ge()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",gn,mn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":se()}],"scroll-mx":[{"scroll-mx":se()}],"scroll-my":[{"scroll-my":se()}],"scroll-ms":[{"scroll-ms":se()}],"scroll-me":[{"scroll-me":se()}],"scroll-mt":[{"scroll-mt":se()}],"scroll-mr":[{"scroll-mr":se()}],"scroll-mb":[{"scroll-mb":se()}],"scroll-ml":[{"scroll-ml":se()}],"scroll-p":[{"scroll-p":se()}],"scroll-px":[{"scroll-px":se()}],"scroll-py":[{"scroll-py":se()}],"scroll-ps":[{"scroll-ps":se()}],"scroll-pe":[{"scroll-pe":se()}],"scroll-pt":[{"scroll-pt":se()}],"scroll-pr":[{"scroll-pr":se()}],"scroll-pb":[{"scroll-pb":se()}],"scroll-pl":[{"scroll-pl":se()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",gn,mn]}],fill:[{fill:["none",...Ge()]}],"stroke-w":[{stroke:[Fi,_S,nv,DE]}],stroke:[{stroke:["none",...Ge()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}},yce=qle(gce);function Wt(...e){return yce(hi(e))}const x1=h_("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"sm"}}),Xr=H.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},l)=>{const f=n?Ul:"button";return u.jsx(f,{className:Wt(x1({variant:t,size:r,className:e})),ref:l,...a})});Xr.displayName="Button";/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vce=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TW=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ce=H.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:f,...i},_)=>H.createElement("svg",{ref:_,...xce,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:TW("lucide",a),...i},[...f.map(([w,A])=>H.createElement(w,A)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=(e,t)=>{const r=H.forwardRef(({className:n,...a},l)=>H.createElement(_ce,{ref:l,iconNode:t,className:TW(`lucide-${vce(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bce=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],aB=fn("Activity",bce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wce=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],sB=fn("ArrowDown",wce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sce=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],eP=fn("ArrowLeft",Sce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ace=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],oB=fn("ArrowUp",Ace);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tce=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Pce=fn("BadgeCheck",Tce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cce=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],lB=fn("BookOpen",Cce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ece=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wd=fn("Calendar",Ece);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kce=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],Gf=fn("Car",kce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mce=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],j3=fn("ChartColumn",Mce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jce=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],_1=fn("ChartPie",jce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oce=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16c.5-2 1.5-7 4-7 2 0 2 3 4 3 2.5 0 4.5-5 5-7",key:"lw07rv"}]],Nce=fn("ChartSpline",Oce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rce=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],PW=fn("Check",Rce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ice=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],CW=fn("ChevronDown",Ice);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dce=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],EW=fn("ChevronLeft",Dce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lce=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],bx=fn("ChevronRight",Lce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zce=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Fce=fn("ChevronUp",zce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bce=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],Vce=fn("ChevronsLeft",Bce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uce=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],$ce=fn("ChevronsRight",Uce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qce=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],kW=fn("ChevronsUpDown",qce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Wce=fn("CircleAlert",Gce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Kce=fn("CircleCheck",Hce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Yce=fn("Circle",Zce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Jce=fn("Clock",Xce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qce=[["rect",{width:"14",height:"8",x:"5",y:"2",rx:"2",key:"wc9tft"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6 18h2",key:"rwmk9e"}],["path",{d:"M12 18h6",key:"aqd8w3"}]],eue=fn("Computer",Qce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tue=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],rue=fn("CreditCard",tue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nue=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],MW=fn("Download",nue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iue=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],aue=fn("Ellipsis",iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sue=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],jW=fn("EyeOff",sue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oue=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],lue=fn("Eye",oue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cue=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],jv=fn("FileText",cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uue=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],OW=fn("Filter",uue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const due=[["path",{d:"M7 2h10",key:"nczekb"}],["path",{d:"M5 6h14",key:"u2x4p"}],["rect",{width:"18",height:"12",x:"3",y:"10",rx:"2",key:"l0tzu3"}]],hue=fn("GalleryVerticalEnd",due);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],cB=fn("Image",fue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pue=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],uB=fn("Layers",pue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mue=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Lf=fn("LoaderCircle",mue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gue=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],yue=fn("LogOut",gue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vue=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],O3=fn("Mail",vue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xue=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],wx=fn("MapPin",xue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ue=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],dB=fn("Moon",_ue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],wue=fn("PanelLeft",bue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sue=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],NW=fn("Phone",Sue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aue=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Wv=fn("Plus",Aue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tue=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Pue=fn("RefreshCw",Tue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cue=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Eue=fn("RotateCcw",Cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Mue=fn("Save",kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jue=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],tP=fn("Search",jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oue=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Nue=fn("Settings2",Oue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rue=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],RW=fn("Shield",Rue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]],LE=fn("SquareActivity",Iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Due=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 8h7",key:"kbo1nt"}],["path",{d:"M8 12h6",key:"ikassy"}],["path",{d:"M11 16h5",key:"oq65wt"}]],zE=fn("SquareChartGantt",Due);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lue=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Nc=fn("SquarePen",Lue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zue=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],Fue=fn("SquareTerminal",zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bue=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],hB=fn("Sun",Bue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vue=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Uue=fn("Table",Vue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],IW=fn("Target",$ue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const que=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Gue=fn("Trash2",que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wue=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Hue=fn("Trash",Wue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kue=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],fB=fn("TrendingDown",Kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zue=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],pB=fn("TrendingUp",Zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yue=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],mv=fn("TriangleAlert",Yue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xue=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],yA=fn("UserPlus",Xue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jue=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Rg=fn("User",Jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Que=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],DW=fn("Users",Que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ede=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],b1=fn("X",ede);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tde=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],rde=fn("Zap",tde);function on(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function nde(e,t){const r=H.createContext(t),n=l=>{const{children:f,...i}=l,_=H.useMemo(()=>i,Object.values(i));return u.jsx(r.Provider,{value:_,children:f})};n.displayName=e+"Provider";function a(l){const f=H.useContext(r);if(f)return f;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[n,a]}function kd(e,t=[]){let r=[];function n(l,f){const i=H.createContext(f),_=r.length;r=[...r,f];const w=E=>{var W;const{scope:O,children:F,...U}=E,B=((W=O==null?void 0:O[e])==null?void 0:W[_])||i,q=H.useMemo(()=>U,Object.values(U));return u.jsx(B.Provider,{value:q,children:F})};w.displayName=l+"Provider";function A(E,O){var B;const F=((B=O==null?void 0:O[e])==null?void 0:B[_])||i,U=H.useContext(F);if(U)return U;if(f!==void 0)return f;throw new Error(`\`${E}\` must be used within \`${l}\``)}return[w,A]}const a=()=>{const l=r.map(f=>H.createContext(f));return function(i){const _=(i==null?void 0:i[e])||l;return H.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,ide(a,...t)]}function ide(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const f=n.reduce((i,{useScope:_,scopeName:w})=>{const E=_(l)[`__scope${w}`];return{...i,...E}},{});return H.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}function Au(e){const t=H.useRef(e);return H.useEffect(()=>{t.current=e}),H.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Lg({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=ade({defaultProp:t,onChange:r}),l=e!==void 0,f=l?e:n,i=Au(r),_=H.useCallback(w=>{if(l){const E=typeof w=="function"?w(e):w;E!==e&&i(E)}else a(w)},[l,e,a,i]);return[f,_]}function ade({defaultProp:e,onChange:t}){const r=H.useState(e),[n]=r,a=H.useRef(n),l=Au(t);return H.useEffect(()=>{a.current!==n&&(l(n),a.current=n)},[n,a,l]),r}var sde=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],gi=sde.reduce((e,t)=>{const r=H.forwardRef((n,a)=>{const{asChild:l,...f}=n,i=l?Ul:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(i,{...f,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function LW(e,t){e&&Ow.flushSync(()=>e.dispatchEvent(t))}function N3(e){const t=e+"CollectionProvider",[r,n]=kd(t),[a,l]=r(t,{collectionRef:{current:null},itemMap:new Map}),f=F=>{const{scope:U,children:B}=F,q=Re.useRef(null),W=Re.useRef(new Map).current;return u.jsx(a,{scope:U,itemMap:W,collectionRef:q,children:B})};f.displayName=t;const i=e+"CollectionSlot",_=Re.forwardRef((F,U)=>{const{scope:B,children:q}=F,W=l(i,B),Z=Xi(U,W.collectionRef);return u.jsx(Ul,{ref:Z,children:q})});_.displayName=i;const w=e+"CollectionItemSlot",A="data-radix-collection-item",E=Re.forwardRef((F,U)=>{const{scope:B,children:q,...W}=F,Z=Re.useRef(null),ne=Xi(U,Z),ae=l(w,B);return Re.useEffect(()=>(ae.itemMap.set(Z,{ref:Z,...W}),()=>void ae.itemMap.delete(Z))),u.jsx(Ul,{[A]:"",ref:ne,children:q})});E.displayName=w;function O(F){const U=l(e+"CollectionConsumer",F);return Re.useCallback(()=>{const q=U.collectionRef.current;if(!q)return[];const W=Array.from(q.querySelectorAll(`[${A}]`));return Array.from(U.itemMap.values()).sort((ae,ee)=>W.indexOf(ae.ref.current)-W.indexOf(ee.ref.current))},[U.collectionRef,U.itemMap])}return[{Provider:f,Slot:_,ItemSlot:E},O,n]}var ode=H.createContext(void 0);function R3(e){const t=H.useContext(ode);return e||t||"ltr"}function lde(e,t=globalThis==null?void 0:globalThis.document){const r=Au(e);H.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var cde="DismissableLayer",VN="dismissableLayer.update",ude="dismissableLayer.pointerDownOutside",dde="dismissableLayer.focusOutside",mB,zW=H.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),m_=H.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:f,onDismiss:i,..._}=e,w=H.useContext(zW),[A,E]=H.useState(null),O=(A==null?void 0:A.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,F]=H.useState({}),U=Xi(t,ce=>E(ce)),B=Array.from(w.layers),[q]=[...w.layersWithOutsidePointerEventsDisabled].slice(-1),W=B.indexOf(q),Z=A?B.indexOf(A):-1,ne=w.layersWithOutsidePointerEventsDisabled.size>0,ae=Z>=W,ee=pde(ce=>{const ge=ce.target,Te=[...w.branches].some(Ae=>Ae.contains(ge));!ae||Te||(a==null||a(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},O),se=mde(ce=>{const ge=ce.target;[...w.branches].some(Ae=>Ae.contains(ge))||(l==null||l(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},O);return lde(ce=>{Z===w.layers.size-1&&(n==null||n(ce),!ce.defaultPrevented&&i&&(ce.preventDefault(),i()))},O),H.useEffect(()=>{if(A)return r&&(w.layersWithOutsidePointerEventsDisabled.size===0&&(mB=O.body.style.pointerEvents,O.body.style.pointerEvents="none"),w.layersWithOutsidePointerEventsDisabled.add(A)),w.layers.add(A),gB(),()=>{r&&w.layersWithOutsidePointerEventsDisabled.size===1&&(O.body.style.pointerEvents=mB)}},[A,O,r,w]),H.useEffect(()=>()=>{A&&(w.layers.delete(A),w.layersWithOutsidePointerEventsDisabled.delete(A),gB())},[A,w]),H.useEffect(()=>{const ce=()=>F({});return document.addEventListener(VN,ce),()=>document.removeEventListener(VN,ce)},[]),u.jsx(gi.div,{..._,ref:U,style:{pointerEvents:ne?ae?"auto":"none":void 0,...e.style},onFocusCapture:on(e.onFocusCapture,se.onFocusCapture),onBlurCapture:on(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:on(e.onPointerDownCapture,ee.onPointerDownCapture)})});m_.displayName=cde;var hde="DismissableLayerBranch",fde=H.forwardRef((e,t)=>{const r=H.useContext(zW),n=H.useRef(null),a=Xi(t,n);return H.useEffect(()=>{const l=n.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),u.jsx(gi.div,{...e,ref:a})});fde.displayName=hde;function pde(e,t=globalThis==null?void 0:globalThis.document){const r=Au(e),n=H.useRef(!1),a=H.useRef(()=>{});return H.useEffect(()=>{const l=i=>{if(i.target&&!n.current){let _=function(){FW(ude,r,w,{discrete:!0})};const w={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=_,t.addEventListener("click",a.current,{once:!0})):_()}else t.removeEventListener("click",a.current);n.current=!1},f=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(f),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function mde(e,t=globalThis==null?void 0:globalThis.document){const r=Au(e),n=H.useRef(!1);return H.useEffect(()=>{const a=l=>{l.target&&!n.current&&FW(dde,r,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function gB(){const e=new CustomEvent(VN);document.dispatchEvent(e)}function FW(e,t,r,{discrete:n}){const a=r.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?LW(a,l):a.dispatchEvent(l)}var FE=0;function rP(){H.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??yB()),document.body.insertAdjacentElement("beforeend",e[1]??yB()),FE++,()=>{FE===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),FE--}},[])}function yB(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var BE="focusScope.autoFocusOnMount",VE="focusScope.autoFocusOnUnmount",vB={bubbles:!1,cancelable:!0},gde="FocusScope",Iw=H.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...f}=e,[i,_]=H.useState(null),w=Au(a),A=Au(l),E=H.useRef(null),O=Xi(t,B=>_(B)),F=H.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;H.useEffect(()=>{if(n){let B=function(ne){if(F.paused||!i)return;const ae=ne.target;i.contains(ae)?E.current=ae:Sg(E.current,{select:!0})},q=function(ne){if(F.paused||!i)return;const ae=ne.relatedTarget;ae!==null&&(i.contains(ae)||Sg(E.current,{select:!0}))},W=function(ne){if(document.activeElement===document.body)for(const ee of ne)ee.removedNodes.length>0&&Sg(i)};document.addEventListener("focusin",B),document.addEventListener("focusout",q);const Z=new MutationObserver(W);return i&&Z.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",B),document.removeEventListener("focusout",q),Z.disconnect()}}},[n,i,F.paused]),H.useEffect(()=>{if(i){_B.add(F);const B=document.activeElement;if(!i.contains(B)){const W=new CustomEvent(BE,vB);i.addEventListener(BE,w),i.dispatchEvent(W),W.defaultPrevented||(yde(wde(BW(i)),{select:!0}),document.activeElement===B&&Sg(i))}return()=>{i.removeEventListener(BE,w),setTimeout(()=>{const W=new CustomEvent(VE,vB);i.addEventListener(VE,A),i.dispatchEvent(W),W.defaultPrevented||Sg(B??document.body,{select:!0}),i.removeEventListener(VE,A),_B.remove(F)},0)}}},[i,w,A,F]);const U=H.useCallback(B=>{if(!r&&!n||F.paused)return;const q=B.key==="Tab"&&!B.altKey&&!B.ctrlKey&&!B.metaKey,W=document.activeElement;if(q&&W){const Z=B.currentTarget,[ne,ae]=vde(Z);ne&&ae?!B.shiftKey&&W===ae?(B.preventDefault(),r&&Sg(ne,{select:!0})):B.shiftKey&&W===ne&&(B.preventDefault(),r&&Sg(ae,{select:!0})):W===Z&&B.preventDefault()}},[r,n,F.paused]);return u.jsx(gi.div,{tabIndex:-1,...f,ref:O,onKeyDown:U})});Iw.displayName=gde;function yde(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Sg(n,{select:t}),document.activeElement!==r)return}function vde(e){const t=BW(e),r=xB(t,e),n=xB(t.reverse(),e);return[r,n]}function BW(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function xB(e,t){for(const r of e)if(!xde(r,{upTo:t}))return r}function xde(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function _de(e){return e instanceof HTMLInputElement&&"select"in e}function Sg(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&_de(e)&&t&&e.select()}}var _B=bde();function bde(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=bB(e,t),e.unshift(t)},remove(t){var r;e=bB(e,t),(r=e[0])==null||r.resume()}}}function bB(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function wde(e){return e.filter(t=>t.tagName!=="A")}var nl=globalThis!=null&&globalThis.document?H.useLayoutEffect:()=>{},Sde=bse.useId||(()=>{}),Ade=0;function Sd(e){const[t,r]=H.useState(Sde());return nl(()=>{r(n=>n??String(Ade++))},[e]),t?`radix-${t}`:""}const Tde=["top","right","bottom","left"],zg=Math.min,mu=Math.max,vA=Math.round,bS=Math.floor,zf=e=>({x:e,y:e}),Pde={left:"right",right:"left",bottom:"top",top:"bottom"},Cde={start:"end",end:"start"};function UN(e,t,r){return mu(e,zg(t,r))}function dm(e,t){return typeof e=="function"?e(t):e}function hm(e){return e.split("-")[0]}function g_(e){return e.split("-")[1]}function I3(e){return e==="x"?"y":"x"}function D3(e){return e==="y"?"height":"width"}function Fg(e){return["top","bottom"].includes(hm(e))?"y":"x"}function L3(e){return I3(Fg(e))}function Ede(e,t,r){r===void 0&&(r=!1);const n=g_(e),a=L3(e),l=D3(a);let f=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(f=xA(f)),[f,xA(f)]}function kde(e){const t=xA(e);return[$N(e),t,$N(t)]}function $N(e){return e.replace(/start|end/g,t=>Cde[t])}function Mde(e,t,r){const n=["left","right"],a=["right","left"],l=["top","bottom"],f=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?l:f;default:return[]}}function jde(e,t,r,n){const a=g_(e);let l=Mde(hm(e),r==="start",n);return a&&(l=l.map(f=>f+"-"+a),t&&(l=l.concat(l.map($N)))),l}function xA(e){return e.replace(/left|right|bottom|top/g,t=>Pde[t])}function Ode(e){return{top:0,right:0,bottom:0,left:0,...e}}function VW(e){return typeof e!="number"?Ode(e):{top:e,right:e,bottom:e,left:e}}function _A(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function wB(e,t,r){let{reference:n,floating:a}=e;const l=Fg(t),f=L3(t),i=D3(f),_=hm(t),w=l==="y",A=n.x+n.width/2-a.width/2,E=n.y+n.height/2-a.height/2,O=n[i]/2-a[i]/2;let F;switch(_){case"top":F={x:A,y:n.y-a.height};break;case"bottom":F={x:A,y:n.y+n.height};break;case"right":F={x:n.x+n.width,y:E};break;case"left":F={x:n.x-a.width,y:E};break;default:F={x:n.x,y:n.y}}switch(g_(t)){case"start":F[f]-=O*(r&&w?-1:1);break;case"end":F[f]+=O*(r&&w?-1:1);break}return F}const Nde=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:f}=r,i=l.filter(Boolean),_=await(f.isRTL==null?void 0:f.isRTL(t));let w=await f.getElementRects({reference:e,floating:t,strategy:a}),{x:A,y:E}=wB(w,n,_),O=n,F={},U=0;for(let B=0;B<i.length;B++){const{name:q,fn:W}=i[B],{x:Z,y:ne,data:ae,reset:ee}=await W({x:A,y:E,initialPlacement:n,placement:O,strategy:a,middlewareData:F,rects:w,platform:f,elements:{reference:e,floating:t}});A=Z??A,E=ne??E,F={...F,[q]:{...F[q],...ae}},ee&&U<=50&&(U++,typeof ee=="object"&&(ee.placement&&(O=ee.placement),ee.rects&&(w=ee.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:a}):ee.rects),{x:A,y:E}=wB(w,O,_)),B=-1)}return{x:A,y:E,placement:O,strategy:a,middlewareData:F}};async function w1(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:f,elements:i,strategy:_}=e,{boundary:w="clippingAncestors",rootBoundary:A="viewport",elementContext:E="floating",altBoundary:O=!1,padding:F=0}=dm(t,e),U=VW(F),q=i[O?E==="floating"?"reference":"floating":E],W=_A(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(q)))==null||r?q:q.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:w,rootBoundary:A,strategy:_})),Z=E==="floating"?{x:n,y:a,width:f.floating.width,height:f.floating.height}:f.reference,ne=await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),ae=await(l.isElement==null?void 0:l.isElement(ne))?await(l.getScale==null?void 0:l.getScale(ne))||{x:1,y:1}:{x:1,y:1},ee=_A(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:Z,offsetParent:ne,strategy:_}):Z);return{top:(W.top-ee.top+U.top)/ae.y,bottom:(ee.bottom-W.bottom+U.bottom)/ae.y,left:(W.left-ee.left+U.left)/ae.x,right:(ee.right-W.right+U.right)/ae.x}}const Rde=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:l,platform:f,elements:i,middlewareData:_}=t,{element:w,padding:A=0}=dm(e,t)||{};if(w==null)return{};const E=VW(A),O={x:r,y:n},F=L3(a),U=D3(F),B=await f.getDimensions(w),q=F==="y",W=q?"top":"left",Z=q?"bottom":"right",ne=q?"clientHeight":"clientWidth",ae=l.reference[U]+l.reference[F]-O[F]-l.floating[U],ee=O[F]-l.reference[F],se=await(f.getOffsetParent==null?void 0:f.getOffsetParent(w));let ce=se?se[ne]:0;(!ce||!await(f.isElement==null?void 0:f.isElement(se)))&&(ce=i.floating[ne]||l.floating[U]);const ge=ae/2-ee/2,Te=ce/2-B[U]/2-1,Ae=zg(E[W],Te),_e=zg(E[Z],Te),Ee=Ae,ke=ce-B[U]-_e,Qe=ce/2-B[U]/2+ge,Ze=UN(Ee,Qe,ke),Ge=!_.arrow&&g_(a)!=null&&Qe!==Ze&&l.reference[U]/2-(Qe<Ee?Ae:_e)-B[U]/2<0,Oe=Ge?Qe<Ee?Qe-Ee:Qe-ke:0;return{[F]:O[F]+Oe,data:{[F]:Ze,centerOffset:Qe-Ze-Oe,...Ge&&{alignmentOffset:Oe}},reset:Ge}}}),Ide=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:l,rects:f,initialPlacement:i,platform:_,elements:w}=t,{mainAxis:A=!0,crossAxis:E=!0,fallbackPlacements:O,fallbackStrategy:F="bestFit",fallbackAxisSideDirection:U="none",flipAlignment:B=!0,...q}=dm(e,t);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const W=hm(a),Z=Fg(i),ne=hm(i)===i,ae=await(_.isRTL==null?void 0:_.isRTL(w.floating)),ee=O||(ne||!B?[xA(i)]:kde(i)),se=U!=="none";!O&&se&&ee.push(...jde(i,B,U,ae));const ce=[i,...ee],ge=await w1(t,q),Te=[];let Ae=((n=l.flip)==null?void 0:n.overflows)||[];if(A&&Te.push(ge[W]),E){const Qe=Ede(a,f,ae);Te.push(ge[Qe[0]],ge[Qe[1]])}if(Ae=[...Ae,{placement:a,overflows:Te}],!Te.every(Qe=>Qe<=0)){var _e,Ee;const Qe=(((_e=l.flip)==null?void 0:_e.index)||0)+1,Ze=ce[Qe];if(Ze)return{data:{index:Qe,overflows:Ae},reset:{placement:Ze}};let Ge=(Ee=Ae.filter(Oe=>Oe.overflows[0]<=0).sort((Oe,je)=>Oe.overflows[1]-je.overflows[1])[0])==null?void 0:Ee.placement;if(!Ge)switch(F){case"bestFit":{var ke;const Oe=(ke=Ae.filter(je=>{if(se){const Le=Fg(je.placement);return Le===Z||Le==="y"}return!0}).map(je=>[je.placement,je.overflows.filter(Le=>Le>0).reduce((Le,ut)=>Le+ut,0)]).sort((je,Le)=>je[1]-Le[1])[0])==null?void 0:ke[0];Oe&&(Ge=Oe);break}case"initialPlacement":Ge=i;break}if(a!==Ge)return{reset:{placement:Ge}}}return{}}}};function SB(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function AB(e){return Tde.some(t=>e[t]>=0)}const Dde=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=dm(e,t);switch(n){case"referenceHidden":{const l=await w1(t,{...a,elementContext:"reference"}),f=SB(l,r.reference);return{data:{referenceHiddenOffsets:f,referenceHidden:AB(f)}}}case"escaped":{const l=await w1(t,{...a,altBoundary:!0}),f=SB(l,r.floating);return{data:{escapedOffsets:f,escaped:AB(f)}}}default:return{}}}}};async function Lde(e,t){const{placement:r,platform:n,elements:a}=e,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),f=hm(r),i=g_(r),_=Fg(r)==="y",w=["left","top"].includes(f)?-1:1,A=l&&_?-1:1,E=dm(t,e);let{mainAxis:O,crossAxis:F,alignmentAxis:U}=typeof E=="number"?{mainAxis:E,crossAxis:0,alignmentAxis:null}:{mainAxis:E.mainAxis||0,crossAxis:E.crossAxis||0,alignmentAxis:E.alignmentAxis};return i&&typeof U=="number"&&(F=i==="end"?U*-1:U),_?{x:F*A,y:O*w}:{x:O*w,y:F*A}}const zde=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:l,placement:f,middlewareData:i}=t,_=await Lde(t,e);return f===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+_.x,y:l+_.y,data:{..._,placement:f}}}}},Fde=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:l=!0,crossAxis:f=!1,limiter:i={fn:q=>{let{x:W,y:Z}=q;return{x:W,y:Z}}},..._}=dm(e,t),w={x:r,y:n},A=await w1(t,_),E=Fg(hm(a)),O=I3(E);let F=w[O],U=w[E];if(l){const q=O==="y"?"top":"left",W=O==="y"?"bottom":"right",Z=F+A[q],ne=F-A[W];F=UN(Z,F,ne)}if(f){const q=E==="y"?"top":"left",W=E==="y"?"bottom":"right",Z=U+A[q],ne=U-A[W];U=UN(Z,U,ne)}const B=i.fn({...t,[O]:F,[E]:U});return{...B,data:{x:B.x-r,y:B.y-n,enabled:{[O]:l,[E]:f}}}}}},Bde=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:l,middlewareData:f}=t,{offset:i=0,mainAxis:_=!0,crossAxis:w=!0}=dm(e,t),A={x:r,y:n},E=Fg(a),O=I3(E);let F=A[O],U=A[E];const B=dm(i,t),q=typeof B=="number"?{mainAxis:B,crossAxis:0}:{mainAxis:0,crossAxis:0,...B};if(_){const ne=O==="y"?"height":"width",ae=l.reference[O]-l.floating[ne]+q.mainAxis,ee=l.reference[O]+l.reference[ne]-q.mainAxis;F<ae?F=ae:F>ee&&(F=ee)}if(w){var W,Z;const ne=O==="y"?"width":"height",ae=["top","left"].includes(hm(a)),ee=l.reference[E]-l.floating[ne]+(ae&&((W=f.offset)==null?void 0:W[E])||0)+(ae?0:q.crossAxis),se=l.reference[E]+l.reference[ne]+(ae?0:((Z=f.offset)==null?void 0:Z[E])||0)-(ae?q.crossAxis:0);U<ee?U=ee:U>se&&(U=se)}return{[O]:F,[E]:U}}}},Vde=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:l,platform:f,elements:i}=t,{apply:_=()=>{},...w}=dm(e,t),A=await w1(t,w),E=hm(a),O=g_(a),F=Fg(a)==="y",{width:U,height:B}=l.floating;let q,W;E==="top"||E==="bottom"?(q=E,W=O===(await(f.isRTL==null?void 0:f.isRTL(i.floating))?"start":"end")?"left":"right"):(W=E,q=O==="end"?"top":"bottom");const Z=B-A.top-A.bottom,ne=U-A.left-A.right,ae=zg(B-A[q],Z),ee=zg(U-A[W],ne),se=!t.middlewareData.shift;let ce=ae,ge=ee;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ge=ne),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(ce=Z),se&&!O){const Ae=mu(A.left,0),_e=mu(A.right,0),Ee=mu(A.top,0),ke=mu(A.bottom,0);F?ge=U-2*(Ae!==0||_e!==0?Ae+_e:mu(A.left,A.right)):ce=B-2*(Ee!==0||ke!==0?Ee+ke:mu(A.top,A.bottom))}await _({...t,availableWidth:ge,availableHeight:ce});const Te=await f.getDimensions(i.floating);return U!==Te.width||B!==Te.height?{reset:{rects:!0}}:{}}}};function nP(){return typeof window<"u"}function y_(e){return UW(e)?(e.nodeName||"").toLowerCase():"#document"}function vu(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function rp(e){var t;return(t=(UW(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function UW(e){return nP()?e instanceof Node||e instanceof vu(e).Node:!1}function Oh(e){return nP()?e instanceof Element||e instanceof vu(e).Element:!1}function Wf(e){return nP()?e instanceof HTMLElement||e instanceof vu(e).HTMLElement:!1}function TB(e){return!nP()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof vu(e).ShadowRoot}function Dw(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Nh(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function Ude(e){return["table","td","th"].includes(y_(e))}function iP(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function z3(e){const t=F3(),r=Oh(e)?Nh(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function $de(e){let t=Bg(e);for(;Wf(t)&&!Sx(t);){if(z3(t))return t;if(iP(t))return null;t=Bg(t)}return null}function F3(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Sx(e){return["html","body","#document"].includes(y_(e))}function Nh(e){return vu(e).getComputedStyle(e)}function aP(e){return Oh(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Bg(e){if(y_(e)==="html")return e;const t=e.assignedSlot||e.parentNode||TB(e)&&e.host||rp(e);return TB(t)?t.host:t}function $W(e){const t=Bg(e);return Sx(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wf(t)&&Dw(t)?t:$W(t)}function S1(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=$W(e),l=a===((n=e.ownerDocument)==null?void 0:n.body),f=vu(a);if(l){const i=qN(f);return t.concat(f,f.visualViewport||[],Dw(a)?a:[],i&&r?S1(i):[])}return t.concat(a,S1(a,[],r))}function qN(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function qW(e){const t=Nh(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Wf(e),l=a?e.offsetWidth:r,f=a?e.offsetHeight:n,i=vA(r)!==l||vA(n)!==f;return i&&(r=l,n=f),{width:r,height:n,$:i}}function B3(e){return Oh(e)?e:e.contextElement}function px(e){const t=B3(e);if(!Wf(t))return zf(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:l}=qW(t);let f=(l?vA(r.width):r.width)/n,i=(l?vA(r.height):r.height)/a;return(!f||!Number.isFinite(f))&&(f=1),(!i||!Number.isFinite(i))&&(i=1),{x:f,y:i}}const qde=zf(0);function GW(e){const t=vu(e);return!F3()||!t.visualViewport?qde:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Gde(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==vu(e)?!1:t}function Ov(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),l=B3(e);let f=zf(1);t&&(n?Oh(n)&&(f=px(n)):f=px(e));const i=Gde(l,r,n)?GW(l):zf(0);let _=(a.left+i.x)/f.x,w=(a.top+i.y)/f.y,A=a.width/f.x,E=a.height/f.y;if(l){const O=vu(l),F=n&&Oh(n)?vu(n):n;let U=O,B=qN(U);for(;B&&n&&F!==U;){const q=px(B),W=B.getBoundingClientRect(),Z=Nh(B),ne=W.left+(B.clientLeft+parseFloat(Z.paddingLeft))*q.x,ae=W.top+(B.clientTop+parseFloat(Z.paddingTop))*q.y;_*=q.x,w*=q.y,A*=q.x,E*=q.y,_+=ne,w+=ae,U=vu(B),B=qN(U)}}return _A({width:A,height:E,x:_,y:w})}function V3(e,t){const r=aP(e).scrollLeft;return t?t.left+r:Ov(rp(e)).left+r}function WW(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:V3(e,n)),l=n.top+t.scrollTop;return{x:a,y:l}}function Wde(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const l=a==="fixed",f=rp(n),i=t?iP(t.floating):!1;if(n===f||i&&l)return r;let _={scrollLeft:0,scrollTop:0},w=zf(1);const A=zf(0),E=Wf(n);if((E||!E&&!l)&&((y_(n)!=="body"||Dw(f))&&(_=aP(n)),Wf(n))){const F=Ov(n);w=px(n),A.x=F.x+n.clientLeft,A.y=F.y+n.clientTop}const O=f&&!E&&!l?WW(f,_,!0):zf(0);return{width:r.width*w.x,height:r.height*w.y,x:r.x*w.x-_.scrollLeft*w.x+A.x+O.x,y:r.y*w.y-_.scrollTop*w.y+A.y+O.y}}function Hde(e){return Array.from(e.getClientRects())}function Kde(e){const t=rp(e),r=aP(e),n=e.ownerDocument.body,a=mu(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),l=mu(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let f=-r.scrollLeft+V3(e);const i=-r.scrollTop;return Nh(n).direction==="rtl"&&(f+=mu(t.clientWidth,n.clientWidth)-a),{width:a,height:l,x:f,y:i}}function Zde(e,t){const r=vu(e),n=rp(e),a=r.visualViewport;let l=n.clientWidth,f=n.clientHeight,i=0,_=0;if(a){l=a.width,f=a.height;const w=F3();(!w||w&&t==="fixed")&&(i=a.offsetLeft,_=a.offsetTop)}return{width:l,height:f,x:i,y:_}}function Yde(e,t){const r=Ov(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,l=Wf(e)?px(e):zf(1),f=e.clientWidth*l.x,i=e.clientHeight*l.y,_=a*l.x,w=n*l.y;return{width:f,height:i,x:_,y:w}}function PB(e,t,r){let n;if(t==="viewport")n=Zde(e,r);else if(t==="document")n=Kde(rp(e));else if(Oh(t))n=Yde(t,r);else{const a=GW(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return _A(n)}function HW(e,t){const r=Bg(e);return r===t||!Oh(r)||Sx(r)?!1:Nh(r).position==="fixed"||HW(r,t)}function Xde(e,t){const r=t.get(e);if(r)return r;let n=S1(e,[],!1).filter(i=>Oh(i)&&y_(i)!=="body"),a=null;const l=Nh(e).position==="fixed";let f=l?Bg(e):e;for(;Oh(f)&&!Sx(f);){const i=Nh(f),_=z3(f);!_&&i.position==="fixed"&&(a=null),(l?!_&&!a:!_&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Dw(f)&&!_&&HW(e,f))?n=n.filter(A=>A!==f):a=i,f=Bg(f)}return t.set(e,n),n}function Jde(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const f=[...r==="clippingAncestors"?iP(t)?[]:Xde(t,this._c):[].concat(r),n],i=f[0],_=f.reduce((w,A)=>{const E=PB(t,A,a);return w.top=mu(E.top,w.top),w.right=zg(E.right,w.right),w.bottom=zg(E.bottom,w.bottom),w.left=mu(E.left,w.left),w},PB(t,i,a));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function Qde(e){const{width:t,height:r}=qW(e);return{width:t,height:r}}function ehe(e,t,r){const n=Wf(t),a=rp(t),l=r==="fixed",f=Ov(e,!0,l,t);let i={scrollLeft:0,scrollTop:0};const _=zf(0);if(n||!n&&!l)if((y_(t)!=="body"||Dw(a))&&(i=aP(t)),n){const O=Ov(t,!0,l,t);_.x=O.x+t.clientLeft,_.y=O.y+t.clientTop}else a&&(_.x=V3(a));const w=a&&!n&&!l?WW(a,i):zf(0),A=f.left+i.scrollLeft-_.x-w.x,E=f.top+i.scrollTop-_.y-w.y;return{x:A,y:E,width:f.width,height:f.height}}function UE(e){return Nh(e).position==="static"}function CB(e,t){if(!Wf(e)||Nh(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return rp(e)===r&&(r=r.ownerDocument.body),r}function KW(e,t){const r=vu(e);if(iP(e))return r;if(!Wf(e)){let a=Bg(e);for(;a&&!Sx(a);){if(Oh(a)&&!UE(a))return a;a=Bg(a)}return r}let n=CB(e,t);for(;n&&Ude(n)&&UE(n);)n=CB(n,t);return n&&Sx(n)&&UE(n)&&!z3(n)?r:n||$de(e)||r}const the=async function(e){const t=this.getOffsetParent||KW,r=this.getDimensions,n=await r(e.floating);return{reference:ehe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function rhe(e){return Nh(e).direction==="rtl"}const nhe={convertOffsetParentRelativeRectToViewportRelativeRect:Wde,getDocumentElement:rp,getClippingRect:Jde,getOffsetParent:KW,getElementRects:the,getClientRects:Hde,getDimensions:Qde,getScale:px,isElement:Oh,isRTL:rhe};function ZW(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function ihe(e,t){let r=null,n;const a=rp(e);function l(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function f(i,_){i===void 0&&(i=!1),_===void 0&&(_=1),l();const w=e.getBoundingClientRect(),{left:A,top:E,width:O,height:F}=w;if(i||t(),!O||!F)return;const U=bS(E),B=bS(a.clientWidth-(A+O)),q=bS(a.clientHeight-(E+F)),W=bS(A),ne={rootMargin:-U+"px "+-B+"px "+-q+"px "+-W+"px",threshold:mu(0,zg(1,_))||1};let ae=!0;function ee(se){const ce=se[0].intersectionRatio;if(ce!==_){if(!ae)return f();ce?f(!1,ce):n=setTimeout(()=>{f(!1,1e-7)},1e3)}ce===1&&!ZW(w,e.getBoundingClientRect())&&f(),ae=!1}try{r=new IntersectionObserver(ee,{...ne,root:a.ownerDocument})}catch{r=new IntersectionObserver(ee,ne)}r.observe(e)}return f(!0),l}function ahe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:_=!1}=n,w=B3(e),A=a||l?[...w?S1(w):[],...S1(t)]:[];A.forEach(W=>{a&&W.addEventListener("scroll",r,{passive:!0}),l&&W.addEventListener("resize",r)});const E=w&&i?ihe(w,r):null;let O=-1,F=null;f&&(F=new ResizeObserver(W=>{let[Z]=W;Z&&Z.target===w&&F&&(F.unobserve(t),cancelAnimationFrame(O),O=requestAnimationFrame(()=>{var ne;(ne=F)==null||ne.observe(t)})),r()}),w&&!_&&F.observe(w),F.observe(t));let U,B=_?Ov(e):null;_&&q();function q(){const W=Ov(e);B&&!ZW(B,W)&&r(),B=W,U=requestAnimationFrame(q)}return r(),()=>{var W;A.forEach(Z=>{a&&Z.removeEventListener("scroll",r),l&&Z.removeEventListener("resize",r)}),E==null||E(),(W=F)==null||W.disconnect(),F=null,_&&cancelAnimationFrame(U)}}const she=zde,ohe=Fde,lhe=Ide,che=Vde,uhe=Dde,EB=Rde,dhe=Bde,hhe=(e,t,r)=>{const n=new Map,a={platform:nhe,...r},l={...a.platform,_c:n};return Nde(e,t,{...a,platform:l})};var eA=typeof document<"u"?H.useLayoutEffect:H.useEffect;function bA(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!bA(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const l=a[n];if(!(l==="_owner"&&e.$$typeof)&&!bA(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function YW(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function kB(e,t){const r=YW(e);return Math.round(t*r)/r}function $E(e){const t=H.useRef(e);return eA(()=>{t.current=e}),t}function fhe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:f}={},transform:i=!0,whileElementsMounted:_,open:w}=e,[A,E]=H.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[O,F]=H.useState(n);bA(O,n)||F(n);const[U,B]=H.useState(null),[q,W]=H.useState(null),Z=H.useCallback(je=>{je!==se.current&&(se.current=je,B(je))},[]),ne=H.useCallback(je=>{je!==ce.current&&(ce.current=je,W(je))},[]),ae=l||U,ee=f||q,se=H.useRef(null),ce=H.useRef(null),ge=H.useRef(A),Te=_!=null,Ae=$E(_),_e=$E(a),Ee=$E(w),ke=H.useCallback(()=>{if(!se.current||!ce.current)return;const je={placement:t,strategy:r,middleware:O};_e.current&&(je.platform=_e.current),hhe(se.current,ce.current,je).then(Le=>{const ut={...Le,isPositioned:Ee.current!==!1};Qe.current&&!bA(ge.current,ut)&&(ge.current=ut,Ow.flushSync(()=>{E(ut)}))})},[O,t,r,_e,Ee]);eA(()=>{w===!1&&ge.current.isPositioned&&(ge.current.isPositioned=!1,E(je=>({...je,isPositioned:!1})))},[w]);const Qe=H.useRef(!1);eA(()=>(Qe.current=!0,()=>{Qe.current=!1}),[]),eA(()=>{if(ae&&(se.current=ae),ee&&(ce.current=ee),ae&&ee){if(Ae.current)return Ae.current(ae,ee,ke);ke()}},[ae,ee,ke,Ae,Te]);const Ze=H.useMemo(()=>({reference:se,floating:ce,setReference:Z,setFloating:ne}),[Z,ne]),Ge=H.useMemo(()=>({reference:ae,floating:ee}),[ae,ee]),Oe=H.useMemo(()=>{const je={position:r,left:0,top:0};if(!Ge.floating)return je;const Le=kB(Ge.floating,A.x),ut=kB(Ge.floating,A.y);return i?{...je,transform:"translate("+Le+"px, "+ut+"px)",...YW(Ge.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Le,top:ut}},[r,i,Ge.floating,A.x,A.y]);return H.useMemo(()=>({...A,update:ke,refs:Ze,elements:Ge,floatingStyles:Oe}),[A,ke,Ze,Ge,Oe])}const phe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?EB({element:n.current,padding:a}).fn(r):{}:n?EB({element:n,padding:a}).fn(r):{}}}},mhe=(e,t)=>({...she(e),options:[e,t]}),ghe=(e,t)=>({...ohe(e),options:[e,t]}),yhe=(e,t)=>({...dhe(e),options:[e,t]}),vhe=(e,t)=>({...lhe(e),options:[e,t]}),xhe=(e,t)=>({...che(e),options:[e,t]}),_he=(e,t)=>({...uhe(e),options:[e,t]}),bhe=(e,t)=>({...phe(e),options:[e,t]});var whe="Arrow",XW=H.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...l}=e;return u.jsx(gi.svg,{...l,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:u.jsx("polygon",{points:"0,0 30,0 15,10"})})});XW.displayName=whe;var She=XW;function Ahe(e){const[t,r]=H.useState(void 0);return nl(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let f,i;if("borderBoxSize"in l){const _=l.borderBoxSize,w=Array.isArray(_)?_[0]:_;f=w.inlineSize,i=w.blockSize}else f=e.offsetWidth,i=e.offsetHeight;r({width:f,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var U3="Popper",[JW,Xg]=kd(U3),[The,QW]=JW(U3),eH=e=>{const{__scopePopper:t,children:r}=e,[n,a]=H.useState(null);return u.jsx(The,{scope:t,anchor:n,onAnchorChange:a,children:r})};eH.displayName=U3;var tH="PopperAnchor",rH=H.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,l=QW(tH,r),f=H.useRef(null),i=Xi(t,f);return H.useEffect(()=>{l.onAnchorChange((n==null?void 0:n.current)||f.current)}),n?null:u.jsx(gi.div,{...a,ref:i})});rH.displayName=tH;var $3="PopperContent",[Phe,Che]=JW($3),nH=H.forwardRef((e,t)=>{var cr,nr,Kt,De,er,Lt;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:f=0,arrowPadding:i=0,avoidCollisions:_=!0,collisionBoundary:w=[],collisionPadding:A=0,sticky:E="partial",hideWhenDetached:O=!1,updatePositionStrategy:F="optimized",onPlaced:U,...B}=e,q=QW($3,r),[W,Z]=H.useState(null),ne=Xi(t,Rr=>Z(Rr)),[ae,ee]=H.useState(null),se=Ahe(ae),ce=(se==null?void 0:se.width)??0,ge=(se==null?void 0:se.height)??0,Te=n+(l!=="center"?"-"+l:""),Ae=typeof A=="number"?A:{top:0,right:0,bottom:0,left:0,...A},_e=Array.isArray(w)?w:[w],Ee=_e.length>0,ke={padding:Ae,boundary:_e.filter(khe),altBoundary:Ee},{refs:Qe,floatingStyles:Ze,placement:Ge,isPositioned:Oe,middlewareData:je}=fhe({strategy:"fixed",placement:Te,whileElementsMounted:(...Rr)=>ahe(...Rr,{animationFrame:F==="always"}),elements:{reference:q.anchor},middleware:[mhe({mainAxis:a+ge,alignmentAxis:f}),_&&ghe({mainAxis:!0,crossAxis:!1,limiter:E==="partial"?yhe():void 0,...ke}),_&&vhe({...ke}),xhe({...ke,apply:({elements:Rr,rects:Pt,availableWidth:nn,availableHeight:Sn})=>{const{width:Br,height:et}=Pt.reference,bt=Rr.floating.style;bt.setProperty("--radix-popper-available-width",`${nn}px`),bt.setProperty("--radix-popper-available-height",`${Sn}px`),bt.setProperty("--radix-popper-anchor-width",`${Br}px`),bt.setProperty("--radix-popper-anchor-height",`${et}px`)}}),ae&&bhe({element:ae,padding:i}),Mhe({arrowWidth:ce,arrowHeight:ge}),O&&_he({strategy:"referenceHidden",...ke})]}),[Le,ut]=sH(Ge),ze=Au(U);nl(()=>{Oe&&(ze==null||ze())},[Oe,ze]);const ht=(cr=je.arrow)==null?void 0:cr.x,rt=(nr=je.arrow)==null?void 0:nr.y,Qt=((Kt=je.arrow)==null?void 0:Kt.centerOffset)!==0,[Cr,vr]=H.useState();return nl(()=>{W&&vr(window.getComputedStyle(W).zIndex)},[W]),u.jsx("div",{ref:Qe.setFloating,"data-radix-popper-content-wrapper":"",style:{...Ze,transform:Oe?Ze.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Cr,"--radix-popper-transform-origin":[(De=je.transformOrigin)==null?void 0:De.x,(er=je.transformOrigin)==null?void 0:er.y].join(" "),...((Lt=je.hide)==null?void 0:Lt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:u.jsx(Phe,{scope:r,placedSide:Le,onArrowChange:ee,arrowX:ht,arrowY:rt,shouldHideArrow:Qt,children:u.jsx(gi.div,{"data-side":Le,"data-align":ut,...B,ref:ne,style:{...B.style,animation:Oe?void 0:"none"}})})})});nH.displayName=$3;var iH="PopperArrow",Ehe={top:"bottom",right:"left",bottom:"top",left:"right"},aH=H.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,l=Che(iH,n),f=Ehe[l.placedSide];return u.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:u.jsx(She,{...a,ref:r,style:{...a.style,display:"block"}})})});aH.displayName=iH;function khe(e){return e!==null}var Mhe=e=>({name:"transformOrigin",options:e,fn(t){var q,W,Z;const{placement:r,rects:n,middlewareData:a}=t,f=((q=a.arrow)==null?void 0:q.centerOffset)!==0,i=f?0:e.arrowWidth,_=f?0:e.arrowHeight,[w,A]=sH(r),E={start:"0%",center:"50%",end:"100%"}[A],O=(((W=a.arrow)==null?void 0:W.x)??0)+i/2,F=(((Z=a.arrow)==null?void 0:Z.y)??0)+_/2;let U="",B="";return w==="bottom"?(U=f?E:`${O}px`,B=`${-_}px`):w==="top"?(U=f?E:`${O}px`,B=`${n.floating.height+_}px`):w==="right"?(U=`${-_}px`,B=f?E:`${F}px`):w==="left"&&(U=`${n.floating.width+_}px`,B=f?E:`${F}px`),{data:{x:U,y:B}}}});function sH(e){const[t,r="center"]=e.split("-");return[t,r]}var sP=eH,Lw=rH,oP=nH,lP=aH,jhe="Portal",v_=H.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[a,l]=H.useState(!1);nl(()=>l(!0),[]);const f=r||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return f?eW.createPortal(u.jsx(gi.div,{...n,ref:t}),f):null});v_.displayName=jhe;function Ohe(e,t){return H.useReducer((r,n)=>t[r][n]??r,e)}var ku=e=>{const{present:t,children:r}=e,n=Nhe(t),a=typeof r=="function"?r({present:n.isPresent}):H.Children.only(r),l=Xi(n.ref,Rhe(a));return typeof r=="function"||n.isPresent?H.cloneElement(a,{ref:l}):null};ku.displayName="Presence";function Nhe(e){const[t,r]=H.useState(),n=H.useRef({}),a=H.useRef(e),l=H.useRef("none"),f=e?"mounted":"unmounted",[i,_]=Ohe(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return H.useEffect(()=>{const w=wS(n.current);l.current=i==="mounted"?w:"none"},[i]),nl(()=>{const w=n.current,A=a.current;if(A!==e){const O=l.current,F=wS(w);e?_("MOUNT"):F==="none"||(w==null?void 0:w.display)==="none"?_("UNMOUNT"):_(A&&O!==F?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,_]),nl(()=>{if(t){let w;const A=t.ownerDocument.defaultView??window,E=F=>{const B=wS(n.current).includes(F.animationName);if(F.target===t&&B&&(_("ANIMATION_END"),!a.current)){const q=t.style.animationFillMode;t.style.animationFillMode="forwards",w=A.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=q)})}},O=F=>{F.target===t&&(l.current=wS(n.current))};return t.addEventListener("animationstart",O),t.addEventListener("animationcancel",E),t.addEventListener("animationend",E),()=>{A.clearTimeout(w),t.removeEventListener("animationstart",O),t.removeEventListener("animationcancel",E),t.removeEventListener("animationend",E)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:H.useCallback(w=>{w&&(n.current=getComputedStyle(w)),r(w)},[])}}function wS(e){return(e==null?void 0:e.animationName)||"none"}function Rhe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var qE="rovingFocusGroup.onEntryFocus",Ihe={bubbles:!1,cancelable:!0},cP="RovingFocusGroup",[GN,oH,Dhe]=N3(cP),[Lhe,lH]=kd(cP,[Dhe]),[zhe,Fhe]=Lhe(cP),cH=H.forwardRef((e,t)=>u.jsx(GN.Provider,{scope:e.__scopeRovingFocusGroup,children:u.jsx(GN.Slot,{scope:e.__scopeRovingFocusGroup,children:u.jsx(Bhe,{...e,ref:t})})}));cH.displayName=cP;var Bhe=H.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:l,currentTabStopId:f,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:_,onEntryFocus:w,preventScrollOnEntryFocus:A=!1,...E}=e,O=H.useRef(null),F=Xi(t,O),U=R3(l),[B=null,q]=Lg({prop:f,defaultProp:i,onChange:_}),[W,Z]=H.useState(!1),ne=Au(w),ae=oH(r),ee=H.useRef(!1),[se,ce]=H.useState(0);return H.useEffect(()=>{const ge=O.current;if(ge)return ge.addEventListener(qE,ne),()=>ge.removeEventListener(qE,ne)},[ne]),u.jsx(zhe,{scope:r,orientation:n,dir:U,loop:a,currentTabStopId:B,onItemFocus:H.useCallback(ge=>q(ge),[q]),onItemShiftTab:H.useCallback(()=>Z(!0),[]),onFocusableItemAdd:H.useCallback(()=>ce(ge=>ge+1),[]),onFocusableItemRemove:H.useCallback(()=>ce(ge=>ge-1),[]),children:u.jsx(gi.div,{tabIndex:W||se===0?-1:0,"data-orientation":n,...E,ref:F,style:{outline:"none",...e.style},onMouseDown:on(e.onMouseDown,()=>{ee.current=!0}),onFocus:on(e.onFocus,ge=>{const Te=!ee.current;if(ge.target===ge.currentTarget&&Te&&!W){const Ae=new CustomEvent(qE,Ihe);if(ge.currentTarget.dispatchEvent(Ae),!Ae.defaultPrevented){const _e=ae().filter(Ge=>Ge.focusable),Ee=_e.find(Ge=>Ge.active),ke=_e.find(Ge=>Ge.id===B),Ze=[Ee,ke,..._e].filter(Boolean).map(Ge=>Ge.ref.current);hH(Ze,A)}}ee.current=!1}),onBlur:on(e.onBlur,()=>Z(!1))})})}),uH="RovingFocusGroupItem",dH=H.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:l,...f}=e,i=Sd(),_=l||i,w=Fhe(uH,r),A=w.currentTabStopId===_,E=oH(r),{onFocusableItemAdd:O,onFocusableItemRemove:F}=w;return H.useEffect(()=>{if(n)return O(),()=>F()},[n,O,F]),u.jsx(GN.ItemSlot,{scope:r,id:_,focusable:n,active:a,children:u.jsx(gi.span,{tabIndex:A?0:-1,"data-orientation":w.orientation,...f,ref:t,onMouseDown:on(e.onMouseDown,U=>{n?w.onItemFocus(_):U.preventDefault()}),onFocus:on(e.onFocus,()=>w.onItemFocus(_)),onKeyDown:on(e.onKeyDown,U=>{if(U.key==="Tab"&&U.shiftKey){w.onItemShiftTab();return}if(U.target!==U.currentTarget)return;const B=$he(U,w.orientation,w.dir);if(B!==void 0){if(U.metaKey||U.ctrlKey||U.altKey||U.shiftKey)return;U.preventDefault();let W=E().filter(Z=>Z.focusable).map(Z=>Z.ref.current);if(B==="last")W.reverse();else if(B==="prev"||B==="next"){B==="prev"&&W.reverse();const Z=W.indexOf(U.currentTarget);W=w.loop?qhe(W,Z+1):W.slice(Z+1)}setTimeout(()=>hH(W))}})})})});dH.displayName=uH;var Vhe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Uhe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function $he(e,t,r){const n=Uhe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Vhe[n]}function hH(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function qhe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Ghe=cH,Whe=dH,Hhe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},G0=new WeakMap,SS=new WeakMap,AS={},GE=0,fH=function(e){return e&&(e.host||fH(e.parentNode))},Khe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=fH(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Zhe=function(e,t,r,n){var a=Khe(t,Array.isArray(e)?e:[e]);AS[r]||(AS[r]=new WeakMap);var l=AS[r],f=[],i=new Set,_=new Set(a),w=function(E){!E||i.has(E)||(i.add(E),w(E.parentNode))};a.forEach(w);var A=function(E){!E||_.has(E)||Array.prototype.forEach.call(E.children,function(O){if(i.has(O))A(O);else try{var F=O.getAttribute(n),U=F!==null&&F!=="false",B=(G0.get(O)||0)+1,q=(l.get(O)||0)+1;G0.set(O,B),l.set(O,q),f.push(O),B===1&&U&&SS.set(O,!0),q===1&&O.setAttribute(r,"true"),U||O.setAttribute(n,"true")}catch(W){console.error("aria-hidden: cannot operate on ",O,W)}})};return A(t),i.clear(),GE++,function(){f.forEach(function(E){var O=G0.get(E)-1,F=l.get(E)-1;G0.set(E,O),l.set(E,F),O||(SS.has(E)||E.removeAttribute(n),SS.delete(E)),F||E.removeAttribute(r)}),GE--,GE||(G0=new WeakMap,G0=new WeakMap,SS=new WeakMap,AS={})}},uP=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=Hhe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),Zhe(n,a,r,"aria-hidden")):function(){return null}},jf=function(){return jf=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},jf.apply(this,arguments)};function pH(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Yhe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var tA="right-scroll-bar-position",rA="width-before-scroll-bar",Xhe="with-scroll-bars-hidden",Jhe="--removed-body-scroll-bar-size";function WE(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Qhe(e,t){var r=H.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var efe=typeof window<"u"?H.useLayoutEffect:H.useEffect,MB=new WeakMap;function tfe(e,t){var r=Qhe(null,function(n){return e.forEach(function(a){return WE(a,n)})});return efe(function(){var n=MB.get(r);if(n){var a=new Set(n),l=new Set(e),f=r.current;a.forEach(function(i){l.has(i)||WE(i,null)}),l.forEach(function(i){a.has(i)||WE(i,f)})}MB.set(r,e)},[e]),r}function rfe(e){return e}function nfe(e,t){t===void 0&&(t=rfe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(l){var f=t(l,n);return r.push(f),function(){r=r.filter(function(i){return i!==f})}},assignSyncMedium:function(l){for(n=!0;r.length;){var f=r;r=[],f.forEach(l)}r={push:function(i){return l(i)},filter:function(){return r}}},assignMedium:function(l){n=!0;var f=[];if(r.length){var i=r;r=[],i.forEach(l),f=r}var _=function(){var A=f;f=[],A.forEach(l)},w=function(){return Promise.resolve().then(_)};w(),r={push:function(A){f.push(A),w()},filter:function(A){return f=f.filter(A),r}}}};return a}function ife(e){e===void 0&&(e={});var t=nfe(null);return t.options=jf({async:!0,ssr:!1},e),t}var mH=function(e){var t=e.sideCar,r=pH(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return H.createElement(n,jf({},r))};mH.isSideCarExport=!0;function afe(e,t){return e.useMedium(t),mH}var gH=ife(),HE=function(){},dP=H.forwardRef(function(e,t){var r=H.useRef(null),n=H.useState({onScrollCapture:HE,onWheelCapture:HE,onTouchMoveCapture:HE}),a=n[0],l=n[1],f=e.forwardProps,i=e.children,_=e.className,w=e.removeScrollBar,A=e.enabled,E=e.shards,O=e.sideCar,F=e.noIsolation,U=e.inert,B=e.allowPinchZoom,q=e.as,W=q===void 0?"div":q,Z=e.gapMode,ne=pH(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),ae=O,ee=tfe([r,t]),se=jf(jf({},ne),a);return H.createElement(H.Fragment,null,A&&H.createElement(ae,{sideCar:gH,removeScrollBar:w,shards:E,noIsolation:F,inert:U,setCallbacks:l,allowPinchZoom:!!B,lockRef:r,gapMode:Z}),f?H.cloneElement(H.Children.only(i),jf(jf({},se),{ref:ee})):H.createElement(W,jf({},se,{className:_,ref:ee}),i))});dP.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};dP.classNames={fullWidth:rA,zeroRight:tA};var sfe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ofe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=sfe();return t&&e.setAttribute("nonce",t),e}function lfe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function cfe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var ufe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=ofe())&&(lfe(t,r),cfe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},dfe=function(){var e=ufe();return function(t,r){H.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},yH=function(){var e=dfe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},hfe={left:0,top:0,right:0,gap:0},KE=function(e){return parseInt(e||"",10)||0},ffe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[KE(r),KE(n),KE(a)]},pfe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return hfe;var t=ffe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},mfe=yH(),mx="data-scroll-locked",gfe=function(e,t,r,n){var a=e.left,l=e.top,f=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Xhe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(mx,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(f,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(tA,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(rA,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(tA," .").concat(tA,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(rA," .").concat(rA,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(mx,`] {
    `).concat(Jhe,": ").concat(i,`px;
  }
`)},jB=function(){var e=parseInt(document.body.getAttribute(mx)||"0",10);return isFinite(e)?e:0},yfe=function(){H.useEffect(function(){return document.body.setAttribute(mx,(jB()+1).toString()),function(){var e=jB()-1;e<=0?document.body.removeAttribute(mx):document.body.setAttribute(mx,e.toString())}},[])},vfe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;yfe();var l=H.useMemo(function(){return pfe(a)},[a]);return H.createElement(mfe,{styles:gfe(l,!t,a,r?"":"!important")})},WN=!1;if(typeof window<"u")try{var TS=Object.defineProperty({},"passive",{get:function(){return WN=!0,!0}});window.addEventListener("test",TS,TS),window.removeEventListener("test",TS,TS)}catch{WN=!1}var W0=WN?{passive:!1}:!1,xfe=function(e){return e.tagName==="TEXTAREA"},vH=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!xfe(e)&&r[t]==="visible")},_fe=function(e){return vH(e,"overflowY")},bfe=function(e){return vH(e,"overflowX")},OB=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=xH(e,n);if(a){var l=_H(e,n),f=l[1],i=l[2];if(f>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},wfe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Sfe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},xH=function(e,t){return e==="v"?_fe(t):bfe(t)},_H=function(e,t){return e==="v"?wfe(t):Sfe(t)},Afe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Tfe=function(e,t,r,n,a){var l=Afe(e,window.getComputedStyle(t).direction),f=l*n,i=r.target,_=t.contains(i),w=!1,A=f>0,E=0,O=0;do{var F=_H(e,i),U=F[0],B=F[1],q=F[2],W=B-q-l*U;(U||W)&&xH(e,i)&&(E+=W,O+=U),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!_&&i!==document.body||_&&(t.contains(i)||t===i));return(A&&Math.abs(E)<1||!A&&Math.abs(O)<1)&&(w=!0),w},PS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},NB=function(e){return[e.deltaX,e.deltaY]},RB=function(e){return e&&"current"in e?e.current:e},Pfe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Cfe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Efe=0,H0=[];function kfe(e){var t=H.useRef([]),r=H.useRef([0,0]),n=H.useRef(),a=H.useState(Efe++)[0],l=H.useState(yH)[0],f=H.useRef(e);H.useEffect(function(){f.current=e},[e]),H.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var B=Yhe([e.lockRef.current],(e.shards||[]).map(RB),!0).filter(Boolean);return B.forEach(function(q){return q.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),B.forEach(function(q){return q.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=H.useCallback(function(B,q){if("touches"in B&&B.touches.length===2||B.type==="wheel"&&B.ctrlKey)return!f.current.allowPinchZoom;var W=PS(B),Z=r.current,ne="deltaX"in B?B.deltaX:Z[0]-W[0],ae="deltaY"in B?B.deltaY:Z[1]-W[1],ee,se=B.target,ce=Math.abs(ne)>Math.abs(ae)?"h":"v";if("touches"in B&&ce==="h"&&se.type==="range")return!1;var ge=OB(ce,se);if(!ge)return!0;if(ge?ee=ce:(ee=ce==="v"?"h":"v",ge=OB(ce,se)),!ge)return!1;if(!n.current&&"changedTouches"in B&&(ne||ae)&&(n.current=ee),!ee)return!0;var Te=n.current||ee;return Tfe(Te,q,B,Te==="h"?ne:ae)},[]),_=H.useCallback(function(B){var q=B;if(!(!H0.length||H0[H0.length-1]!==l)){var W="deltaY"in q?NB(q):PS(q),Z=t.current.filter(function(ee){return ee.name===q.type&&(ee.target===q.target||q.target===ee.shadowParent)&&Pfe(ee.delta,W)})[0];if(Z&&Z.should){q.cancelable&&q.preventDefault();return}if(!Z){var ne=(f.current.shards||[]).map(RB).filter(Boolean).filter(function(ee){return ee.contains(q.target)}),ae=ne.length>0?i(q,ne[0]):!f.current.noIsolation;ae&&q.cancelable&&q.preventDefault()}}},[]),w=H.useCallback(function(B,q,W,Z){var ne={name:B,delta:q,target:W,should:Z,shadowParent:Mfe(W)};t.current.push(ne),setTimeout(function(){t.current=t.current.filter(function(ae){return ae!==ne})},1)},[]),A=H.useCallback(function(B){r.current=PS(B),n.current=void 0},[]),E=H.useCallback(function(B){w(B.type,NB(B),B.target,i(B,e.lockRef.current))},[]),O=H.useCallback(function(B){w(B.type,PS(B),B.target,i(B,e.lockRef.current))},[]);H.useEffect(function(){return H0.push(l),e.setCallbacks({onScrollCapture:E,onWheelCapture:E,onTouchMoveCapture:O}),document.addEventListener("wheel",_,W0),document.addEventListener("touchmove",_,W0),document.addEventListener("touchstart",A,W0),function(){H0=H0.filter(function(B){return B!==l}),document.removeEventListener("wheel",_,W0),document.removeEventListener("touchmove",_,W0),document.removeEventListener("touchstart",A,W0)}},[]);var F=e.removeScrollBar,U=e.inert;return H.createElement(H.Fragment,null,U?H.createElement(l,{styles:Cfe(a)}):null,F?H.createElement(vfe,{gapMode:e.gapMode}):null)}function Mfe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const jfe=afe(gH,kfe);var zw=H.forwardRef(function(e,t){return H.createElement(dP,jf({},e,{ref:t,sideCar:jfe}))});zw.classNames=dP.classNames;var HN=["Enter"," "],Ofe=["ArrowDown","PageUp","Home"],bH=["ArrowUp","PageDown","End"],Nfe=[...Ofe,...bH],Rfe={ltr:[...HN,"ArrowRight"],rtl:[...HN,"ArrowLeft"]},Ife={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Fw="Menu",[A1,Dfe,Lfe]=N3(Fw),[Hv,wH]=kd(Fw,[Lfe,Xg,lH]),hP=Xg(),SH=lH(),[zfe,Kv]=Hv(Fw),[Ffe,Bw]=Hv(Fw),AH=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:l,modal:f=!0}=e,i=hP(t),[_,w]=H.useState(null),A=H.useRef(!1),E=Au(l),O=R3(a);return H.useEffect(()=>{const F=()=>{A.current=!0,document.addEventListener("pointerdown",U,{capture:!0,once:!0}),document.addEventListener("pointermove",U,{capture:!0,once:!0})},U=()=>A.current=!1;return document.addEventListener("keydown",F,{capture:!0}),()=>{document.removeEventListener("keydown",F,{capture:!0}),document.removeEventListener("pointerdown",U,{capture:!0}),document.removeEventListener("pointermove",U,{capture:!0})}},[]),u.jsx(sP,{...i,children:u.jsx(zfe,{scope:t,open:r,onOpenChange:E,content:_,onContentChange:w,children:u.jsx(Ffe,{scope:t,onClose:H.useCallback(()=>E(!1),[E]),isUsingKeyboardRef:A,dir:O,modal:f,children:n})})})};AH.displayName=Fw;var Bfe="MenuAnchor",q3=H.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=hP(r);return u.jsx(Lw,{...a,...n,ref:t})});q3.displayName=Bfe;var G3="MenuPortal",[Vfe,TH]=Hv(G3,{forceMount:void 0}),PH=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,l=Kv(G3,t);return u.jsx(Vfe,{scope:t,forceMount:r,children:u.jsx(ku,{present:r||l.open,children:u.jsx(v_,{asChild:!0,container:a,children:n})})})};PH.displayName=G3;var Ad="MenuContent",[Ufe,W3]=Hv(Ad),CH=H.forwardRef((e,t)=>{const r=TH(Ad,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,l=Kv(Ad,e.__scopeMenu),f=Bw(Ad,e.__scopeMenu);return u.jsx(A1.Provider,{scope:e.__scopeMenu,children:u.jsx(ku,{present:n||l.open,children:u.jsx(A1.Slot,{scope:e.__scopeMenu,children:f.modal?u.jsx($fe,{...a,ref:t}):u.jsx(qfe,{...a,ref:t})})})})}),$fe=H.forwardRef((e,t)=>{const r=Kv(Ad,e.__scopeMenu),n=H.useRef(null),a=Xi(t,n);return H.useEffect(()=>{const l=n.current;if(l)return uP(l)},[]),u.jsx(H3,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:on(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),qfe=H.forwardRef((e,t)=>{const r=Kv(Ad,e.__scopeMenu);return u.jsx(H3,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),H3=H.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:f,disableOutsidePointerEvents:i,onEntryFocus:_,onEscapeKeyDown:w,onPointerDownOutside:A,onFocusOutside:E,onInteractOutside:O,onDismiss:F,disableOutsideScroll:U,...B}=e,q=Kv(Ad,r),W=Bw(Ad,r),Z=hP(r),ne=SH(r),ae=Dfe(r),[ee,se]=H.useState(null),ce=H.useRef(null),ge=Xi(t,ce,q.onContentChange),Te=H.useRef(0),Ae=H.useRef(""),_e=H.useRef(0),Ee=H.useRef(null),ke=H.useRef("right"),Qe=H.useRef(0),Ze=U?zw:H.Fragment,Ge=U?{as:Ul,allowPinchZoom:!0}:void 0,Oe=Le=>{var cr,nr;const ut=Ae.current+Le,ze=ae().filter(Kt=>!Kt.disabled),ht=document.activeElement,rt=(cr=ze.find(Kt=>Kt.ref.current===ht))==null?void 0:cr.textValue,Qt=ze.map(Kt=>Kt.textValue),Cr=rpe(Qt,ut,rt),vr=(nr=ze.find(Kt=>Kt.textValue===Cr))==null?void 0:nr.ref.current;(function Kt(De){Ae.current=De,window.clearTimeout(Te.current),De!==""&&(Te.current=window.setTimeout(()=>Kt(""),1e3))})(ut),vr&&setTimeout(()=>vr.focus())};H.useEffect(()=>()=>window.clearTimeout(Te.current),[]),rP();const je=H.useCallback(Le=>{var ze,ht;return ke.current===((ze=Ee.current)==null?void 0:ze.side)&&ipe(Le,(ht=Ee.current)==null?void 0:ht.area)},[]);return u.jsx(Ufe,{scope:r,searchRef:Ae,onItemEnter:H.useCallback(Le=>{je(Le)&&Le.preventDefault()},[je]),onItemLeave:H.useCallback(Le=>{var ut;je(Le)||((ut=ce.current)==null||ut.focus(),se(null))},[je]),onTriggerLeave:H.useCallback(Le=>{je(Le)&&Le.preventDefault()},[je]),pointerGraceTimerRef:_e,onPointerGraceIntentChange:H.useCallback(Le=>{Ee.current=Le},[]),children:u.jsx(Ze,{...Ge,children:u.jsx(Iw,{asChild:!0,trapped:a,onMountAutoFocus:on(l,Le=>{var ut;Le.preventDefault(),(ut=ce.current)==null||ut.focus({preventScroll:!0})}),onUnmountAutoFocus:f,children:u.jsx(m_,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:w,onPointerDownOutside:A,onFocusOutside:E,onInteractOutside:O,onDismiss:F,children:u.jsx(Ghe,{asChild:!0,...ne,dir:W.dir,orientation:"vertical",loop:n,currentTabStopId:ee,onCurrentTabStopIdChange:se,onEntryFocus:on(_,Le=>{W.isUsingKeyboardRef.current||Le.preventDefault()}),preventScrollOnEntryFocus:!0,children:u.jsx(oP,{role:"menu","aria-orientation":"vertical","data-state":$H(q.open),"data-radix-menu-content":"",dir:W.dir,...Z,...B,ref:ge,style:{outline:"none",...B.style},onKeyDown:on(B.onKeyDown,Le=>{const ze=Le.target.closest("[data-radix-menu-content]")===Le.currentTarget,ht=Le.ctrlKey||Le.altKey||Le.metaKey,rt=Le.key.length===1;ze&&(Le.key==="Tab"&&Le.preventDefault(),!ht&&rt&&Oe(Le.key));const Qt=ce.current;if(Le.target!==Qt||!Nfe.includes(Le.key))return;Le.preventDefault();const vr=ae().filter(cr=>!cr.disabled).map(cr=>cr.ref.current);bH.includes(Le.key)&&vr.reverse(),epe(vr)}),onBlur:on(e.onBlur,Le=>{Le.currentTarget.contains(Le.target)||(window.clearTimeout(Te.current),Ae.current="")}),onPointerMove:on(e.onPointerMove,T1(Le=>{const ut=Le.target,ze=Qe.current!==Le.clientX;if(Le.currentTarget.contains(ut)&&ze){const ht=Le.clientX>Qe.current?"right":"left";ke.current=ht,Qe.current=Le.clientX}}))})})})})})})});CH.displayName=Ad;var Gfe="MenuGroup",K3=H.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return u.jsx(gi.div,{role:"group",...n,ref:t})});K3.displayName=Gfe;var Wfe="MenuLabel",EH=H.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return u.jsx(gi.div,{...n,ref:t})});EH.displayName=Wfe;var wA="MenuItem",IB="menu.itemSelect",fP=H.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,l=H.useRef(null),f=Bw(wA,e.__scopeMenu),i=W3(wA,e.__scopeMenu),_=Xi(t,l),w=H.useRef(!1),A=()=>{const E=l.current;if(!r&&E){const O=new CustomEvent(IB,{bubbles:!0,cancelable:!0});E.addEventListener(IB,F=>n==null?void 0:n(F),{once:!0}),LW(E,O),O.defaultPrevented?w.current=!1:f.onClose()}};return u.jsx(kH,{...a,ref:_,disabled:r,onClick:on(e.onClick,A),onPointerDown:E=>{var O;(O=e.onPointerDown)==null||O.call(e,E),w.current=!0},onPointerUp:on(e.onPointerUp,E=>{var O;w.current||(O=E.currentTarget)==null||O.click()}),onKeyDown:on(e.onKeyDown,E=>{const O=i.searchRef.current!=="";r||O&&E.key===" "||HN.includes(E.key)&&(E.currentTarget.click(),E.preventDefault())})})});fP.displayName=wA;var kH=H.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...l}=e,f=W3(wA,r),i=SH(r),_=H.useRef(null),w=Xi(t,_),[A,E]=H.useState(!1),[O,F]=H.useState("");return H.useEffect(()=>{const U=_.current;U&&F((U.textContent??"").trim())},[l.children]),u.jsx(A1.ItemSlot,{scope:r,disabled:n,textValue:a??O,children:u.jsx(Whe,{asChild:!0,...i,focusable:!n,children:u.jsx(gi.div,{role:"menuitem","data-highlighted":A?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...l,ref:w,onPointerMove:on(e.onPointerMove,T1(U=>{n?f.onItemLeave(U):(f.onItemEnter(U),U.defaultPrevented||U.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:on(e.onPointerLeave,T1(U=>f.onItemLeave(U))),onFocus:on(e.onFocus,()=>E(!0)),onBlur:on(e.onBlur,()=>E(!1))})})})}),Hfe="MenuCheckboxItem",MH=H.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return u.jsx(IH,{scope:e.__scopeMenu,checked:r,children:u.jsx(fP,{role:"menuitemcheckbox","aria-checked":SA(r)?"mixed":r,...a,ref:t,"data-state":Y3(r),onSelect:on(a.onSelect,()=>n==null?void 0:n(SA(r)?!0:!r),{checkForDefaultPrevented:!1})})})});MH.displayName=Hfe;var jH="MenuRadioGroup",[Kfe,Zfe]=Hv(jH,{value:void 0,onValueChange:()=>{}}),OH=H.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,l=Au(n);return u.jsx(Kfe,{scope:e.__scopeMenu,value:r,onValueChange:l,children:u.jsx(K3,{...a,ref:t})})});OH.displayName=jH;var NH="MenuRadioItem",RH=H.forwardRef((e,t)=>{const{value:r,...n}=e,a=Zfe(NH,e.__scopeMenu),l=r===a.value;return u.jsx(IH,{scope:e.__scopeMenu,checked:l,children:u.jsx(fP,{role:"menuitemradio","aria-checked":l,...n,ref:t,"data-state":Y3(l),onSelect:on(n.onSelect,()=>{var f;return(f=a.onValueChange)==null?void 0:f.call(a,r)},{checkForDefaultPrevented:!1})})})});RH.displayName=NH;var Z3="MenuItemIndicator",[IH,Yfe]=Hv(Z3,{checked:!1}),DH=H.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,l=Yfe(Z3,r);return u.jsx(ku,{present:n||SA(l.checked)||l.checked===!0,children:u.jsx(gi.span,{...a,ref:t,"data-state":Y3(l.checked)})})});DH.displayName=Z3;var Xfe="MenuSeparator",LH=H.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return u.jsx(gi.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});LH.displayName=Xfe;var Jfe="MenuArrow",zH=H.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=hP(r);return u.jsx(lP,{...a,...n,ref:t})});zH.displayName=Jfe;var Qfe="MenuSub",[OVe,FH]=Hv(Qfe),Wb="MenuSubTrigger",BH=H.forwardRef((e,t)=>{const r=Kv(Wb,e.__scopeMenu),n=Bw(Wb,e.__scopeMenu),a=FH(Wb,e.__scopeMenu),l=W3(Wb,e.__scopeMenu),f=H.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:_}=l,w={__scopeMenu:e.__scopeMenu},A=H.useCallback(()=>{f.current&&window.clearTimeout(f.current),f.current=null},[]);return H.useEffect(()=>A,[A]),H.useEffect(()=>{const E=i.current;return()=>{window.clearTimeout(E),_(null)}},[i,_]),u.jsx(q3,{asChild:!0,...w,children:u.jsx(kH,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":$H(r.open),...e,ref:QT(t,a.onTriggerChange),onClick:E=>{var O;(O=e.onClick)==null||O.call(e,E),!(e.disabled||E.defaultPrevented)&&(E.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:on(e.onPointerMove,T1(E=>{l.onItemEnter(E),!E.defaultPrevented&&!e.disabled&&!r.open&&!f.current&&(l.onPointerGraceIntentChange(null),f.current=window.setTimeout(()=>{r.onOpenChange(!0),A()},100))})),onPointerLeave:on(e.onPointerLeave,T1(E=>{var F,U;A();const O=(F=r.content)==null?void 0:F.getBoundingClientRect();if(O){const B=(U=r.content)==null?void 0:U.dataset.side,q=B==="right",W=q?-5:5,Z=O[q?"left":"right"],ne=O[q?"right":"left"];l.onPointerGraceIntentChange({area:[{x:E.clientX+W,y:E.clientY},{x:Z,y:O.top},{x:ne,y:O.top},{x:ne,y:O.bottom},{x:Z,y:O.bottom}],side:B}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(E),E.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:on(e.onKeyDown,E=>{var F;const O=l.searchRef.current!=="";e.disabled||O&&E.key===" "||Rfe[n.dir].includes(E.key)&&(r.onOpenChange(!0),(F=r.content)==null||F.focus(),E.preventDefault())})})})});BH.displayName=Wb;var VH="MenuSubContent",UH=H.forwardRef((e,t)=>{const r=TH(Ad,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,l=Kv(Ad,e.__scopeMenu),f=Bw(Ad,e.__scopeMenu),i=FH(VH,e.__scopeMenu),_=H.useRef(null),w=Xi(t,_);return u.jsx(A1.Provider,{scope:e.__scopeMenu,children:u.jsx(ku,{present:n||l.open,children:u.jsx(A1.Slot,{scope:e.__scopeMenu,children:u.jsx(H3,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:w,align:"start",side:f.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:A=>{var E;f.isUsingKeyboardRef.current&&((E=_.current)==null||E.focus()),A.preventDefault()},onCloseAutoFocus:A=>A.preventDefault(),onFocusOutside:on(e.onFocusOutside,A=>{A.target!==i.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:on(e.onEscapeKeyDown,A=>{f.onClose(),A.preventDefault()}),onKeyDown:on(e.onKeyDown,A=>{var F;const E=A.currentTarget.contains(A.target),O=Ife[f.dir].includes(A.key);E&&O&&(l.onOpenChange(!1),(F=i.trigger)==null||F.focus(),A.preventDefault())})})})})})});UH.displayName=VH;function $H(e){return e?"open":"closed"}function SA(e){return e==="indeterminate"}function Y3(e){return SA(e)?"indeterminate":e?"checked":"unchecked"}function epe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function tpe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function rpe(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let f=tpe(e,Math.max(l,0));a.length===1&&(f=f.filter(w=>w!==r));const _=f.find(w=>w.toLowerCase().startsWith(a.toLowerCase()));return _!==r?_:void 0}function npe(e,t){const{x:r,y:n}=e;let a=!1;for(let l=0,f=t.length-1;l<t.length;f=l++){const i=t[l].x,_=t[l].y,w=t[f].x,A=t[f].y;_>n!=A>n&&r<(w-i)*(n-_)/(A-_)+i&&(a=!a)}return a}function ipe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return npe(r,t)}function T1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var ape=AH,spe=q3,ope=PH,lpe=CH,cpe=K3,upe=EH,dpe=fP,hpe=MH,fpe=OH,ppe=RH,mpe=DH,gpe=LH,ype=zH,vpe=BH,xpe=UH,X3="DropdownMenu",[_pe,NVe]=kd(X3,[wH]),cc=wH(),[bpe,qH]=_pe(X3),GH=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:l,onOpenChange:f,modal:i=!0}=e,_=cc(t),w=H.useRef(null),[A=!1,E]=Lg({prop:a,defaultProp:l,onChange:f});return u.jsx(bpe,{scope:t,triggerId:Sd(),triggerRef:w,contentId:Sd(),open:A,onOpenChange:E,onOpenToggle:H.useCallback(()=>E(O=>!O),[E]),modal:i,children:u.jsx(ape,{..._,open:A,onOpenChange:E,dir:n,modal:i,children:r})})};GH.displayName=X3;var WH="DropdownMenuTrigger",J3=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,l=qH(WH,r),f=cc(r);return u.jsx(spe,{asChild:!0,...f,children:u.jsx(gi.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:QT(t,l.triggerRef),onPointerDown:on(e.onPointerDown,i=>{!n&&i.button===0&&i.ctrlKey===!1&&(l.onOpenToggle(),l.open||i.preventDefault())}),onKeyDown:on(e.onKeyDown,i=>{n||(["Enter"," "].includes(i.key)&&l.onOpenToggle(),i.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});J3.displayName=WH;var wpe="DropdownMenuPortal",HH=e=>{const{__scopeDropdownMenu:t,...r}=e,n=cc(t);return u.jsx(ope,{...n,...r})};HH.displayName=wpe;var KH="DropdownMenuContent",ZH=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=qH(KH,r),l=cc(r),f=H.useRef(!1);return u.jsx(lpe,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...n,ref:t,onCloseAutoFocus:on(e.onCloseAutoFocus,i=>{var _;f.current||(_=a.triggerRef.current)==null||_.focus(),f.current=!1,i.preventDefault()}),onInteractOutside:on(e.onInteractOutside,i=>{const _=i.detail.originalEvent,w=_.button===0&&_.ctrlKey===!0,A=_.button===2||w;(!a.modal||A)&&(f.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});ZH.displayName=KH;var Spe="DropdownMenuGroup",YH=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(cpe,{...a,...n,ref:t})});YH.displayName=Spe;var Ape="DropdownMenuLabel",XH=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(upe,{...a,...n,ref:t})});XH.displayName=Ape;var Tpe="DropdownMenuItem",JH=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(dpe,{...a,...n,ref:t})});JH.displayName=Tpe;var Ppe="DropdownMenuCheckboxItem",QH=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(hpe,{...a,...n,ref:t})});QH.displayName=Ppe;var Cpe="DropdownMenuRadioGroup",Epe=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(fpe,{...a,...n,ref:t})});Epe.displayName=Cpe;var kpe="DropdownMenuRadioItem",eK=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(ppe,{...a,...n,ref:t})});eK.displayName=kpe;var Mpe="DropdownMenuItemIndicator",tK=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(mpe,{...a,...n,ref:t})});tK.displayName=Mpe;var jpe="DropdownMenuSeparator",rK=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(gpe,{...a,...n,ref:t})});rK.displayName=jpe;var Ope="DropdownMenuArrow",Npe=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(ype,{...a,...n,ref:t})});Npe.displayName=Ope;var Rpe="DropdownMenuSubTrigger",nK=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(vpe,{...a,...n,ref:t})});nK.displayName=Rpe;var Ipe="DropdownMenuSubContent",iK=H.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=cc(r);return u.jsx(xpe,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});iK.displayName=Ipe;var Dpe=GH,Lpe=J3,zpe=HH,aK=ZH,Fpe=YH,sK=XH,oK=JH,lK=QH,cK=eK,uK=tK,dK=rK,hK=nK,fK=iK;const Tu=Dpe,Pd=Lpe,Bpe=Fpe,Vpe=H.forwardRef(({className:e,inset:t,children:r,...n},a)=>u.jsxs(hK,{ref:a,className:Wt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n,children:[r,u.jsx(bx,{className:"ml-auto"})]}));Vpe.displayName=hK.displayName;const Upe=H.forwardRef(({className:e,...t},r)=>u.jsx(fK,{ref:r,className:Wt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Upe.displayName=fK.displayName;const zc=H.forwardRef(({className:e,sideOffset:t=4,...r},n)=>u.jsx(zpe,{children:u.jsx(aK,{ref:n,sideOffset:t,className:Wt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md scrollbar-transparent","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));zc.displayName=aK.displayName;const Aa=H.forwardRef(({className:e,inset:t,...r},n)=>u.jsx(oK,{ref:n,className:Wt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",t&&"pl-8",e),...r}));Aa.displayName=oK.displayName;const pK=H.forwardRef(({className:e,children:t,checked:r,...n},a)=>u.jsxs(lK,{ref:a,className:Wt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(uK,{children:u.jsx(PW,{className:"h-4 w-4"})})}),t]}));pK.displayName=lK.displayName;const $pe=H.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(cK,{ref:n,className:Wt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(uK,{children:u.jsx(Yce,{className:"h-2 w-2 fill-current"})})}),t]}));$pe.displayName=cK.displayName;const Jg=H.forwardRef(({className:e,inset:t,...r},n)=>u.jsx(sK,{ref:n,className:Wt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Jg.displayName=sK.displayName;const Rh=H.forwardRef(({className:e,...t},r)=>u.jsx(dK,{ref:r,className:Wt("-mx-1 my-1 h-px bg-muted",e),...t}));Rh.displayName=dK.displayName;const mK=H.createContext({theme:"system",setTheme:()=>null});function qpe({children:e,defaultTheme:t="system",storageKey:r="vite-ui-theme",...n}){const[a,l]=H.useState(()=>localStorage.getItem(r)||t);H.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),a==="system"){const _=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(_);return}i.classList.add(a)},[a]);const f={theme:a,setTheme:i=>{localStorage.setItem(r,i),l(i)}};return u.jsx(mK.Provider,{...n,value:f,children:e})}const Gpe=()=>{const e=H.useContext(mK);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};function Wpe(){const{theme:e,setTheme:t}=Gpe();return u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"outline",size:"icon",children:[u.jsx(hB,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),u.jsx(dB,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),u.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),u.jsxs(zc,{align:"end",children:[u.jsxs(Aa,{className:e==="light"&&" border-2 border-primary",onClick:()=>t("light"),children:[u.jsx(hB,{className:"mr-2 h-4 w-4"}),"Light"]}),u.jsxs(Aa,{className:e==="dark"&&" border-2 border-primary",onClick:()=>t("dark"),children:[u.jsx(dB,{className:"mr-2 h-4 w-4"}),"Dark"]}),u.jsxs(Aa,{className:e==="system"&&" border-2 border-primary",onClick:()=>t("system"),children:[u.jsx(eue,{className:"mr-2 h-4 w-4"}),"System"]})]})]})}const Vn=H.forwardRef(({className:e,type:t,...r},n)=>u.jsx("input",{type:t,className:Wt("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Vn.displayName="Input";var Hpe="Label",gK=H.forwardRef((e,t)=>u.jsx(gi.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));gK.displayName=Hpe;var yK=gK;const Kpe=h_("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),os=H.forwardRef(({className:e,...t},r)=>u.jsx(yK,{ref:r,className:Wt(Kpe(),e),...t}));os.displayName=yK.displayName;var Vw=e=>e.type==="checkbox",gv=e=>e instanceof Date,nc=e=>e==null;const vK=e=>typeof e=="object";var to=e=>!nc(e)&&!Array.isArray(e)&&vK(e)&&!gv(e),xK=e=>to(e)&&e.target?Vw(e.target)?e.target.checked:e.target.value:e,Zpe=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,_K=(e,t)=>e.has(Zpe(t)),Ype=e=>{const t=e.constructor&&e.constructor.prototype;return to(t)&&t.hasOwnProperty("isPrototypeOf")},Q3=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Mc(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Q3&&(e instanceof Blob||n))&&(r||to(e)))if(t=r?[]:{},!r&&!Ype(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=Mc(e[a]));else return e;return t}var pP=e=>Array.isArray(e)?e.filter(Boolean):[],Qs=e=>e===void 0,Gr=(e,t,r)=>{if(!t||!to(e))return r;const n=pP(t.split(/[,[\].]+?/)).reduce((a,l)=>nc(a)?a:a[l],e);return Qs(n)||n===e?Qs(e[t])?r:e[t]:n},vd=e=>typeof e=="boolean",eD=e=>/^\w*$/.test(e),bK=e=>pP(e.replace(/["|']|\]/g,"").split(/\.|\[/)),_a=(e,t,r)=>{let n=-1;const a=eD(t)?[t]:bK(t),l=a.length,f=l-1;for(;++n<l;){const i=a[n];let _=r;if(n!==f){const w=e[i];_=to(w)||Array.isArray(w)?w:isNaN(+a[n+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;e[i]=_,e=e[i]}return e};const AA={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Th={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Kp={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},wK=Re.createContext(null),mP=()=>Re.useContext(wK),Xpe=e=>{const{children:t,...r}=e;return Re.createElement(wK.Provider,{value:r},t)};var SK=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(a,l,{get:()=>{const f=l;return t._proxyFormState[f]!==Th.all&&(t._proxyFormState[f]=!n||Th.all),r&&(r[f]=!0),e[f]}});return a},jc=e=>to(e)&&!Object.keys(e).length,AK=(e,t,r,n)=>{r(e);const{name:a,...l}=e;return jc(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(f=>t[f]===(!n||Th.all))},r1=e=>Array.isArray(e)?e:[e],TK=(e,t,r)=>!e||!t||e===t||r1(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function tD(e){const t=Re.useRef(e);t.current=e,Re.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function Jpe(e){const t=mP(),{control:r=t.control,disabled:n,name:a,exact:l}=e||{},[f,i]=Re.useState(r._formState),_=Re.useRef(!0),w=Re.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),A=Re.useRef(a);return A.current=a,tD({disabled:n,next:E=>_.current&&TK(A.current,E.name,l)&&AK(E,w.current,r._updateFormState)&&i({...r._formState,...E}),subject:r._subjects.state}),Re.useEffect(()=>(_.current=!0,w.current.isValid&&r._updateValid(!0),()=>{_.current=!1}),[r]),Re.useMemo(()=>SK(f,r,w.current,!1),[f,r])}var Nf=e=>typeof e=="string",PK=(e,t,r,n,a)=>Nf(e)?(n&&t.watch.add(e),Gr(r,e,a)):Array.isArray(e)?e.map(l=>(n&&t.watch.add(l),Gr(r,l))):(n&&(t.watchAll=!0),r);function CK(e){const t=mP(),{control:r=t.control,name:n,defaultValue:a,disabled:l,exact:f}=e||{},i=Re.useRef(n);i.current=n,tD({disabled:l,subject:r._subjects.values,next:A=>{TK(i.current,A.name,f)&&w(Mc(PK(i.current,r._names,A.values||r._formValues,!1,a)))}});const[_,w]=Re.useState(r._getWatch(n,a));return Re.useEffect(()=>r._removeUnmounted()),_}function Qpe(e){const t=mP(),{name:r,disabled:n,control:a=t.control,shouldUnregister:l}=e,f=_K(a._names.array,r),i=CK({control:a,name:r,defaultValue:Gr(a._formValues,r,Gr(a._defaultValues,r,e.defaultValue)),exact:!0}),_=Jpe({control:a,name:r,exact:!0}),w=Re.useRef(a.register(r,{...e.rules,value:i,...vd(e.disabled)?{disabled:e.disabled}:{}})),A=Re.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Gr(_.errors,r)},isDirty:{enumerable:!0,get:()=>!!Gr(_.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Gr(_.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Gr(_.validatingFields,r)},error:{enumerable:!0,get:()=>Gr(_.errors,r)}}),[_,r]),E=Re.useMemo(()=>({name:r,value:i,...vd(n)||_.disabled?{disabled:_.disabled||n}:{},onChange:O=>w.current.onChange({target:{value:xK(O),name:r},type:AA.CHANGE}),onBlur:()=>w.current.onBlur({target:{value:Gr(a._formValues,r),name:r},type:AA.BLUR}),ref:O=>{const F=Gr(a._fields,r);F&&O&&(F._f.ref={focus:()=>O.focus(),select:()=>O.select(),setCustomValidity:U=>O.setCustomValidity(U),reportValidity:()=>O.reportValidity()})}}),[r,a._formValues,n,_.disabled,i,a._fields]);return Re.useEffect(()=>{const O=a._options.shouldUnregister||l,F=(U,B)=>{const q=Gr(a._fields,U);q&&q._f&&(q._f.mount=B)};if(F(r,!0),O){const U=Mc(Gr(a._options.defaultValues,r));_a(a._defaultValues,r,U),Qs(Gr(a._formValues,r))&&_a(a._formValues,r,U)}return!f&&a.register(r),()=>{(f?O&&!a._state.action:O)?a.unregister(r):F(r,!1)}},[r,a,f,l]),Re.useEffect(()=>{a._updateDisabledField({disabled:n,fields:a._fields,name:r})},[n,r,a]),Re.useMemo(()=>({field:E,formState:_,fieldState:A}),[E,_,A])}const eme=e=>e.render(Qpe(e));var EK=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},DB=e=>({isOnSubmit:!e||e===Th.onSubmit,isOnBlur:e===Th.onBlur,isOnChange:e===Th.onChange,isOnAll:e===Th.all,isOnTouch:e===Th.onTouched}),LB=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const n1=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const l=Gr(e,a);if(l){const{_f:f,...i}=l;if(f){if(f.refs&&f.refs[0]&&t(f.refs[0],a)&&!n)return!0;if(f.ref&&t(f.ref,f.name)&&!n)return!0;if(n1(i,t))break}else if(to(i)&&n1(i,t))break}}};var tme=(e,t,r)=>{const n=r1(Gr(e,r));return _a(n,"root",t[r]),_a(e,r,n),e},rD=e=>e.type==="file",Of=e=>typeof e=="function",TA=e=>{if(!Q3)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},nA=e=>Nf(e),nD=e=>e.type==="radio",PA=e=>e instanceof RegExp;const zB={value:!1,isValid:!1},FB={value:!0,isValid:!0};var kK=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Qs(e[0].attributes.value)?Qs(e[0].value)||e[0].value===""?FB:{value:e[0].value,isValid:!0}:FB:zB}return zB};const BB={isValid:!1,value:null};var MK=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,BB):BB;function VB(e,t,r="validate"){if(nA(e)||Array.isArray(e)&&e.every(nA)||vd(e)&&!e)return{type:r,message:nA(e)?e:"",ref:t}}var K0=e=>to(e)&&!PA(e)?e:{value:e,message:""},UB=async(e,t,r,n,a,l)=>{const{ref:f,refs:i,required:_,maxLength:w,minLength:A,min:E,max:O,pattern:F,validate:U,name:B,valueAsNumber:q,mount:W}=e._f,Z=Gr(r,B);if(!W||t.has(B))return{};const ne=i?i[0]:f,ae=Ee=>{a&&ne.reportValidity&&(ne.setCustomValidity(vd(Ee)?"":Ee||""),ne.reportValidity())},ee={},se=nD(f),ce=Vw(f),ge=se||ce,Te=(q||rD(f))&&Qs(f.value)&&Qs(Z)||TA(f)&&f.value===""||Z===""||Array.isArray(Z)&&!Z.length,Ae=EK.bind(null,B,n,ee),_e=(Ee,ke,Qe,Ze=Kp.maxLength,Ge=Kp.minLength)=>{const Oe=Ee?ke:Qe;ee[B]={type:Ee?Ze:Ge,message:Oe,ref:f,...Ae(Ee?Ze:Ge,Oe)}};if(l?!Array.isArray(Z)||!Z.length:_&&(!ge&&(Te||nc(Z))||vd(Z)&&!Z||ce&&!kK(i).isValid||se&&!MK(i).isValid)){const{value:Ee,message:ke}=nA(_)?{value:!!_,message:_}:K0(_);if(Ee&&(ee[B]={type:Kp.required,message:ke,ref:ne,...Ae(Kp.required,ke)},!n))return ae(ke),ee}if(!Te&&(!nc(E)||!nc(O))){let Ee,ke;const Qe=K0(O),Ze=K0(E);if(!nc(Z)&&!isNaN(Z)){const Ge=f.valueAsNumber||Z&&+Z;nc(Qe.value)||(Ee=Ge>Qe.value),nc(Ze.value)||(ke=Ge<Ze.value)}else{const Ge=f.valueAsDate||new Date(Z),Oe=ut=>new Date(new Date().toDateString()+" "+ut),je=f.type=="time",Le=f.type=="week";Nf(Qe.value)&&Z&&(Ee=je?Oe(Z)>Oe(Qe.value):Le?Z>Qe.value:Ge>new Date(Qe.value)),Nf(Ze.value)&&Z&&(ke=je?Oe(Z)<Oe(Ze.value):Le?Z<Ze.value:Ge<new Date(Ze.value))}if((Ee||ke)&&(_e(!!Ee,Qe.message,Ze.message,Kp.max,Kp.min),!n))return ae(ee[B].message),ee}if((w||A)&&!Te&&(Nf(Z)||l&&Array.isArray(Z))){const Ee=K0(w),ke=K0(A),Qe=!nc(Ee.value)&&Z.length>+Ee.value,Ze=!nc(ke.value)&&Z.length<+ke.value;if((Qe||Ze)&&(_e(Qe,Ee.message,ke.message),!n))return ae(ee[B].message),ee}if(F&&!Te&&Nf(Z)){const{value:Ee,message:ke}=K0(F);if(PA(Ee)&&!Z.match(Ee)&&(ee[B]={type:Kp.pattern,message:ke,ref:f,...Ae(Kp.pattern,ke)},!n))return ae(ke),ee}if(U){if(Of(U)){const Ee=await U(Z,r),ke=VB(Ee,ne);if(ke&&(ee[B]={...ke,...Ae(Kp.validate,ke.message)},!n))return ae(ke.message),ee}else if(to(U)){let Ee={};for(const ke in U){if(!jc(Ee)&&!n)break;const Qe=VB(await U[ke](Z,r),ne,ke);Qe&&(Ee={...Qe,...Ae(ke,Qe.message)},ae(Qe.message),n&&(ee[B]=Ee))}if(!jc(Ee)&&(ee[B]={ref:ne,...Ee},!n))return ee}}return ae(!0),ee};function rme(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=Qs(e)?n++:e[t[n++]];return e}function nme(e){for(const t in e)if(e.hasOwnProperty(t)&&!Qs(e[t]))return!1;return!0}function Oo(e,t){const r=Array.isArray(t)?t:eD(t)?[t]:bK(t),n=r.length===1?e:rme(e,r),a=r.length-1,l=r[a];return n&&delete n[l],a!==0&&(to(n)&&jc(n)||Array.isArray(n)&&nme(n))&&Oo(e,r.slice(0,-1)),e}var ZE=()=>{let e=[];return{get observers(){return e},next:a=>{for(const l of e)l.next&&l.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(l=>l!==a)}}),unsubscribe:()=>{e=[]}}},KN=e=>nc(e)||!vK(e);function Eg(e,t){if(KN(e)||KN(t))return e===t;if(gv(e)&&gv(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r){const l=e[a];if(!n.includes(a))return!1;if(a!=="ref"){const f=t[a];if(gv(l)&&gv(f)||to(l)&&to(f)||Array.isArray(l)&&Array.isArray(f)?!Eg(l,f):l!==f)return!1}}return!0}var jK=e=>e.type==="select-multiple",ime=e=>nD(e)||Vw(e),YE=e=>TA(e)&&e.isConnected,OK=e=>{for(const t in e)if(Of(e[t]))return!0;return!1};function CA(e,t={}){const r=Array.isArray(e);if(to(e)||r)for(const n in e)Array.isArray(e[n])||to(e[n])&&!OK(e[n])?(t[n]=Array.isArray(e[n])?[]:{},CA(e[n],t[n])):nc(e[n])||(t[n]=!0);return t}function NK(e,t,r){const n=Array.isArray(e);if(to(e)||n)for(const a in e)Array.isArray(e[a])||to(e[a])&&!OK(e[a])?Qs(t)||KN(r[a])?r[a]=Array.isArray(e[a])?CA(e[a],[]):{...CA(e[a])}:NK(e[a],nc(t)?{}:t[a],r[a]):r[a]=!Eg(e[a],t[a]);return r}var Mb=(e,t)=>NK(e,t,CA(t)),RK=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Qs(e)?e:t?e===""?NaN:e&&+e:r&&Nf(e)?new Date(e):n?n(e):e;function XE(e){const t=e.ref;return rD(t)?t.files:nD(t)?MK(e.refs).value:jK(t)?[...t.selectedOptions].map(({value:r})=>r):Vw(t)?kK(e.refs).value:RK(Qs(t.value)?e.ref.value:t.value,e)}var ame=(e,t,r,n)=>{const a={};for(const l of e){const f=Gr(t,l);f&&_a(a,l,f._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},jb=e=>Qs(e)?e:PA(e)?e.source:to(e)?PA(e.value)?e.value.source:e.value:e;const $B="AsyncFunction";var sme=e=>!!e&&!!e.validate&&!!(Of(e.validate)&&e.validate.constructor.name===$B||to(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===$B)),ome=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function qB(e,t,r){const n=Gr(e,r);if(n||eD(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const l=a.join("."),f=Gr(t,l),i=Gr(e,l);if(f&&!Array.isArray(f)&&r!==l)return{name:r};if(i&&i.type)return{name:l,error:i};a.pop()}return{name:r}}var lme=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,cme=(e,t)=>!pP(Gr(e,t)).length&&Oo(e,t);const ume={mode:Th.onSubmit,reValidateMode:Th.onChange,shouldFocusError:!0};function dme(e={}){let t={...ume,...e},r={submitCount:0,isDirty:!1,isLoading:Of(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=to(t.defaultValues)||to(t.values)?Mc(t.defaultValues||t.values)||{}:{},l=t.shouldUnregister?{}:Mc(a),f={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},_,w=0;const A={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},E={values:ZE(),array:ZE(),state:ZE()},O=DB(t.mode),F=DB(t.reValidateMode),U=t.criteriaMode===Th.all,B=et=>bt=>{clearTimeout(w),w=setTimeout(et,bt)},q=async et=>{if(!t.disabled&&(A.isValid||et)){const bt=t.resolver?jc((await ge()).errors):await Ae(n,!0);bt!==r.isValid&&E.state.next({isValid:bt})}},W=(et,bt)=>{!t.disabled&&(A.isValidating||A.validatingFields)&&((et||Array.from(i.mount)).forEach(zt=>{zt&&(bt?_a(r.validatingFields,zt,bt):Oo(r.validatingFields,zt))}),E.state.next({validatingFields:r.validatingFields,isValidating:!jc(r.validatingFields)}))},Z=(et,bt=[],zt,xr,fr=!0,pr=!0)=>{if(xr&&zt&&!t.disabled){if(f.action=!0,pr&&Array.isArray(Gr(n,et))){const ar=zt(Gr(n,et),xr.argA,xr.argB);fr&&_a(n,et,ar)}if(pr&&Array.isArray(Gr(r.errors,et))){const ar=zt(Gr(r.errors,et),xr.argA,xr.argB);fr&&_a(r.errors,et,ar),cme(r.errors,et)}if(A.touchedFields&&pr&&Array.isArray(Gr(r.touchedFields,et))){const ar=zt(Gr(r.touchedFields,et),xr.argA,xr.argB);fr&&_a(r.touchedFields,et,ar)}A.dirtyFields&&(r.dirtyFields=Mb(a,l)),E.state.next({name:et,isDirty:Ee(et,bt),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else _a(l,et,bt)},ne=(et,bt)=>{_a(r.errors,et,bt),E.state.next({errors:r.errors})},ae=et=>{r.errors=et,E.state.next({errors:r.errors,isValid:!1})},ee=(et,bt,zt,xr)=>{const fr=Gr(n,et);if(fr){const pr=Gr(l,et,Qs(zt)?Gr(a,et):zt);Qs(pr)||xr&&xr.defaultChecked||bt?_a(l,et,bt?pr:XE(fr._f)):Ze(et,pr),f.mount&&q()}},se=(et,bt,zt,xr,fr)=>{let pr=!1,ar=!1;const tn={name:et};if(!t.disabled){const Xn=!!(Gr(n,et)&&Gr(n,et)._f&&Gr(n,et)._f.disabled);if(!zt||xr){A.isDirty&&(ar=r.isDirty,r.isDirty=tn.isDirty=Ee(),pr=ar!==tn.isDirty);const Bi=Xn||Eg(Gr(a,et),bt);ar=!!(!Xn&&Gr(r.dirtyFields,et)),Bi||Xn?Oo(r.dirtyFields,et):_a(r.dirtyFields,et,!0),tn.dirtyFields=r.dirtyFields,pr=pr||A.dirtyFields&&ar!==!Bi}if(zt){const Bi=Gr(r.touchedFields,et);Bi||(_a(r.touchedFields,et,zt),tn.touchedFields=r.touchedFields,pr=pr||A.touchedFields&&Bi!==zt)}pr&&fr&&E.state.next(tn)}return pr?tn:{}},ce=(et,bt,zt,xr)=>{const fr=Gr(r.errors,et),pr=A.isValid&&vd(bt)&&r.isValid!==bt;if(t.delayError&&zt?(_=B(()=>ne(et,zt)),_(t.delayError)):(clearTimeout(w),_=null,zt?_a(r.errors,et,zt):Oo(r.errors,et)),(zt?!Eg(fr,zt):fr)||!jc(xr)||pr){const ar={...xr,...pr&&vd(bt)?{isValid:bt}:{},errors:r.errors,name:et};r={...r,...ar},E.state.next(ar)}},ge=async et=>{W(et,!0);const bt=await t.resolver(l,t.context,ame(et||i.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return W(et),bt},Te=async et=>{const{errors:bt}=await ge(et);if(et)for(const zt of et){const xr=Gr(bt,zt);xr?_a(r.errors,zt,xr):Oo(r.errors,zt)}else r.errors=bt;return bt},Ae=async(et,bt,zt={valid:!0})=>{for(const xr in et){const fr=et[xr];if(fr){const{_f:pr,...ar}=fr;if(pr){const tn=i.array.has(pr.name),Xn=fr._f&&sme(fr._f);Xn&&A.validatingFields&&W([xr],!0);const Bi=await UB(fr,i.disabled,l,U,t.shouldUseNativeValidation&&!bt,tn);if(Xn&&A.validatingFields&&W([xr]),Bi[pr.name]&&(zt.valid=!1,bt))break;!bt&&(Gr(Bi,pr.name)?tn?tme(r.errors,Bi,pr.name):_a(r.errors,pr.name,Bi[pr.name]):Oo(r.errors,pr.name))}!jc(ar)&&await Ae(ar,bt,zt)}}return zt.valid},_e=()=>{for(const et of i.unMount){const bt=Gr(n,et);bt&&(bt._f.refs?bt._f.refs.every(zt=>!YE(zt)):!YE(bt._f.ref))&&vr(et)}i.unMount=new Set},Ee=(et,bt)=>!t.disabled&&(et&&bt&&_a(l,et,bt),!Eg(ze(),a)),ke=(et,bt,zt)=>PK(et,i,{...f.mount?l:Qs(bt)?a:Nf(et)?{[et]:bt}:bt},zt,bt),Qe=et=>pP(Gr(f.mount?l:a,et,t.shouldUnregister?Gr(a,et,[]):[])),Ze=(et,bt,zt={})=>{const xr=Gr(n,et);let fr=bt;if(xr){const pr=xr._f;pr&&(!pr.disabled&&_a(l,et,RK(bt,pr)),fr=TA(pr.ref)&&nc(bt)?"":bt,jK(pr.ref)?[...pr.ref.options].forEach(ar=>ar.selected=fr.includes(ar.value)):pr.refs?Vw(pr.ref)?pr.refs.length>1?pr.refs.forEach(ar=>(!ar.defaultChecked||!ar.disabled)&&(ar.checked=Array.isArray(fr)?!!fr.find(tn=>tn===ar.value):fr===ar.value)):pr.refs[0]&&(pr.refs[0].checked=!!fr):pr.refs.forEach(ar=>ar.checked=ar.value===fr):rD(pr.ref)?pr.ref.value="":(pr.ref.value=fr,pr.ref.type||E.values.next({name:et,values:{...l}})))}(zt.shouldDirty||zt.shouldTouch)&&se(et,fr,zt.shouldTouch,zt.shouldDirty,!0),zt.shouldValidate&&ut(et)},Ge=(et,bt,zt)=>{for(const xr in bt){const fr=bt[xr],pr=`${et}.${xr}`,ar=Gr(n,pr);(i.array.has(et)||to(fr)||ar&&!ar._f)&&!gv(fr)?Ge(pr,fr,zt):Ze(pr,fr,zt)}},Oe=(et,bt,zt={})=>{const xr=Gr(n,et),fr=i.array.has(et),pr=Mc(bt);_a(l,et,pr),fr?(E.array.next({name:et,values:{...l}}),(A.isDirty||A.dirtyFields)&&zt.shouldDirty&&E.state.next({name:et,dirtyFields:Mb(a,l),isDirty:Ee(et,pr)})):xr&&!xr._f&&!nc(pr)?Ge(et,pr,zt):Ze(et,pr,zt),LB(et,i)&&E.state.next({...r}),E.values.next({name:f.mount?et:void 0,values:{...l}})},je=async et=>{f.mount=!0;const bt=et.target;let zt=bt.name,xr=!0;const fr=Gr(n,zt),pr=()=>bt.type?XE(fr._f):xK(et),ar=tn=>{xr=Number.isNaN(tn)||gv(tn)&&isNaN(tn.getTime())||Eg(tn,Gr(l,zt,tn))};if(fr){let tn,Xn;const Bi=pr(),Vi=et.type===AA.BLUR||et.type===AA.FOCUS_OUT,io=!ome(fr._f)&&!t.resolver&&!Gr(r.errors,zt)&&!fr._f.deps||lme(Vi,Gr(r.touchedFields,zt),r.isSubmitted,F,O),Va=LB(zt,i,Vi);_a(l,zt,Bi),Vi?(fr._f.onBlur&&fr._f.onBlur(et),_&&_(0)):fr._f.onChange&&fr._f.onChange(et);const Vs=se(zt,Bi,Vi,!1),yo=!jc(Vs)||Va;if(!Vi&&E.values.next({name:zt,type:et.type,values:{...l}}),io)return A.isValid&&(t.mode==="onBlur"&&Vi?q():Vi||q()),yo&&E.state.next({name:zt,...Va?{}:Vs});if(!Vi&&Va&&E.state.next({...r}),t.resolver){const{errors:Qa}=await ge([zt]);if(ar(Bi),xr){const ql=qB(r.errors,n,zt),_l=qB(Qa,n,ql.name||zt);tn=_l.error,zt=_l.name,Xn=jc(Qa)}}else W([zt],!0),tn=(await UB(fr,i.disabled,l,U,t.shouldUseNativeValidation))[zt],W([zt]),ar(Bi),xr&&(tn?Xn=!1:A.isValid&&(Xn=await Ae(n,!0)));xr&&(fr._f.deps&&ut(fr._f.deps),ce(zt,Xn,tn,Vs))}},Le=(et,bt)=>{if(Gr(r.errors,bt)&&et.focus)return et.focus(),1},ut=async(et,bt={})=>{let zt,xr;const fr=r1(et);if(t.resolver){const pr=await Te(Qs(et)?et:fr);zt=jc(pr),xr=et?!fr.some(ar=>Gr(pr,ar)):zt}else et?(xr=(await Promise.all(fr.map(async pr=>{const ar=Gr(n,pr);return await Ae(ar&&ar._f?{[pr]:ar}:ar)}))).every(Boolean),!(!xr&&!r.isValid)&&q()):xr=zt=await Ae(n);return E.state.next({...!Nf(et)||A.isValid&&zt!==r.isValid?{}:{name:et},...t.resolver||!et?{isValid:zt}:{},errors:r.errors}),bt.shouldFocus&&!xr&&n1(n,Le,et?fr:i.mount),xr},ze=et=>{const bt={...f.mount?l:a};return Qs(et)?bt:Nf(et)?Gr(bt,et):et.map(zt=>Gr(bt,zt))},ht=(et,bt)=>({invalid:!!Gr((bt||r).errors,et),isDirty:!!Gr((bt||r).dirtyFields,et),error:Gr((bt||r).errors,et),isValidating:!!Gr(r.validatingFields,et),isTouched:!!Gr((bt||r).touchedFields,et)}),rt=et=>{et&&r1(et).forEach(bt=>Oo(r.errors,bt)),E.state.next({errors:et?r.errors:{}})},Qt=(et,bt,zt)=>{const xr=(Gr(n,et,{_f:{}})._f||{}).ref,fr=Gr(r.errors,et)||{},{ref:pr,message:ar,type:tn,...Xn}=fr;_a(r.errors,et,{...Xn,...bt,ref:xr}),E.state.next({name:et,errors:r.errors,isValid:!1}),zt&&zt.shouldFocus&&xr&&xr.focus&&xr.focus()},Cr=(et,bt)=>Of(et)?E.values.subscribe({next:zt=>et(ke(void 0,bt),zt)}):ke(et,bt,!0),vr=(et,bt={})=>{for(const zt of et?r1(et):i.mount)i.mount.delete(zt),i.array.delete(zt),bt.keepValue||(Oo(n,zt),Oo(l,zt)),!bt.keepError&&Oo(r.errors,zt),!bt.keepDirty&&Oo(r.dirtyFields,zt),!bt.keepTouched&&Oo(r.touchedFields,zt),!bt.keepIsValidating&&Oo(r.validatingFields,zt),!t.shouldUnregister&&!bt.keepDefaultValue&&Oo(a,zt);E.values.next({values:{...l}}),E.state.next({...r,...bt.keepDirty?{isDirty:Ee()}:{}}),!bt.keepIsValid&&q()},cr=({disabled:et,name:bt,field:zt,fields:xr})=>{(vd(et)&&f.mount||et||i.disabled.has(bt))&&(et?i.disabled.add(bt):i.disabled.delete(bt),se(bt,XE(zt?zt._f:Gr(xr,bt)._f),!1,!1,!0))},nr=(et,bt={})=>{let zt=Gr(n,et);const xr=vd(bt.disabled)||vd(t.disabled);return _a(n,et,{...zt||{},_f:{...zt&&zt._f?zt._f:{ref:{name:et}},name:et,mount:!0,...bt}}),i.mount.add(et),zt?cr({field:zt,disabled:vd(bt.disabled)?bt.disabled:t.disabled,name:et}):ee(et,!0,bt.value),{...xr?{disabled:bt.disabled||t.disabled}:{},...t.progressive?{required:!!bt.required,min:jb(bt.min),max:jb(bt.max),minLength:jb(bt.minLength),maxLength:jb(bt.maxLength),pattern:jb(bt.pattern)}:{},name:et,onChange:je,onBlur:je,ref:fr=>{if(fr){nr(et,bt),zt=Gr(n,et);const pr=Qs(fr.value)&&fr.querySelectorAll&&fr.querySelectorAll("input,select,textarea")[0]||fr,ar=ime(pr),tn=zt._f.refs||[];if(ar?tn.find(Xn=>Xn===pr):pr===zt._f.ref)return;_a(n,et,{_f:{...zt._f,...ar?{refs:[...tn.filter(YE),pr,...Array.isArray(Gr(a,et))?[{}]:[]],ref:{type:pr.type,name:et}}:{ref:pr}}}),ee(et,!1,void 0,pr)}else zt=Gr(n,et,{}),zt._f&&(zt._f.mount=!1),(t.shouldUnregister||bt.shouldUnregister)&&!(_K(i.array,et)&&f.action)&&i.unMount.add(et)}}},Kt=()=>t.shouldFocusError&&n1(n,Le,i.mount),De=et=>{vd(et)&&(E.state.next({disabled:et}),n1(n,(bt,zt)=>{const xr=Gr(n,zt);xr&&(bt.disabled=xr._f.disabled||et,Array.isArray(xr._f.refs)&&xr._f.refs.forEach(fr=>{fr.disabled=xr._f.disabled||et}))},0,!1))},er=(et,bt)=>async zt=>{let xr;zt&&(zt.preventDefault&&zt.preventDefault(),zt.persist&&zt.persist());let fr=Mc(l);if(i.disabled.size)for(const pr of i.disabled)_a(fr,pr,void 0);if(E.state.next({isSubmitting:!0}),t.resolver){const{errors:pr,values:ar}=await ge();r.errors=pr,fr=ar}else await Ae(n);if(Oo(r.errors,"root"),jc(r.errors)){E.state.next({errors:{}});try{await et(fr,zt)}catch(pr){xr=pr}}else bt&&await bt({...r.errors},zt),Kt(),setTimeout(Kt);if(E.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:jc(r.errors)&&!xr,submitCount:r.submitCount+1,errors:r.errors}),xr)throw xr},Lt=(et,bt={})=>{Gr(n,et)&&(Qs(bt.defaultValue)?Oe(et,Mc(Gr(a,et))):(Oe(et,bt.defaultValue),_a(a,et,Mc(bt.defaultValue))),bt.keepTouched||Oo(r.touchedFields,et),bt.keepDirty||(Oo(r.dirtyFields,et),r.isDirty=bt.defaultValue?Ee(et,Mc(Gr(a,et))):Ee()),bt.keepError||(Oo(r.errors,et),A.isValid&&q()),E.state.next({...r}))},Rr=(et,bt={})=>{const zt=et?Mc(et):a,xr=Mc(zt),fr=jc(et),pr=fr?a:xr;if(bt.keepDefaultValues||(a=zt),!bt.keepValues){if(bt.keepDirtyValues){const ar=new Set([...i.mount,...Object.keys(Mb(a,l))]);for(const tn of Array.from(ar))Gr(r.dirtyFields,tn)?_a(pr,tn,Gr(l,tn)):Oe(tn,Gr(pr,tn))}else{if(Q3&&Qs(et))for(const ar of i.mount){const tn=Gr(n,ar);if(tn&&tn._f){const Xn=Array.isArray(tn._f.refs)?tn._f.refs[0]:tn._f.ref;if(TA(Xn)){const Bi=Xn.closest("form");if(Bi){Bi.reset();break}}}}n={}}l=t.shouldUnregister?bt.keepDefaultValues?Mc(a):{}:Mc(pr),E.array.next({values:{...pr}}),E.values.next({values:{...pr}})}i={mount:bt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},f.mount=!A.isValid||!!bt.keepIsValid||!!bt.keepDirtyValues,f.watch=!!t.shouldUnregister,E.state.next({submitCount:bt.keepSubmitCount?r.submitCount:0,isDirty:fr?!1:bt.keepDirty?r.isDirty:!!(bt.keepDefaultValues&&!Eg(et,a)),isSubmitted:bt.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:fr?{}:bt.keepDirtyValues?bt.keepDefaultValues&&l?Mb(a,l):r.dirtyFields:bt.keepDefaultValues&&et?Mb(a,et):bt.keepDirty?r.dirtyFields:{},touchedFields:bt.keepTouched?r.touchedFields:{},errors:bt.keepErrors?r.errors:{},isSubmitSuccessful:bt.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Pt=(et,bt)=>Rr(Of(et)?et(l):et,bt);return{control:{register:nr,unregister:vr,getFieldState:ht,handleSubmit:er,setError:Qt,_executeSchema:ge,_getWatch:ke,_getDirty:Ee,_updateValid:q,_removeUnmounted:_e,_updateFieldArray:Z,_updateDisabledField:cr,_getFieldArray:Qe,_reset:Rr,_resetDefaultValues:()=>Of(t.defaultValues)&&t.defaultValues().then(et=>{Pt(et,t.resetOptions),E.state.next({isLoading:!1})}),_updateFormState:et=>{r={...r,...et}},_disableForm:De,_subjects:E,_proxyFormState:A,_setErrors:ae,get _fields(){return n},get _formValues(){return l},get _state(){return f},set _state(et){f=et},get _defaultValues(){return a},get _names(){return i},set _names(et){i=et},get _formState(){return r},set _formState(et){r=et},get _options(){return t},set _options(et){t={...t,...et}}},trigger:ut,register:nr,handleSubmit:er,watch:Cr,setValue:Oe,getValues:ze,reset:Pt,resetField:Lt,clearErrors:rt,unregister:vr,setError:Qt,setFocus:(et,bt={})=>{const zt=Gr(n,et),xr=zt&&zt._f;if(xr){const fr=xr.refs?xr.refs[0]:xr.ref;fr.focus&&(fr.focus(),bt.shouldSelect&&Of(fr.select)&&fr.select())}},getFieldState:ht}}function Uh(e={}){const t=Re.useRef(void 0),r=Re.useRef(void 0),[n,a]=Re.useState({isDirty:!1,isValidating:!1,isLoading:Of(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Of(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...dme(e),formState:n});const l=t.current.control;return l._options=e,tD({subject:l._subjects.state,next:f=>{AK(f,l._proxyFormState,l._updateFormState,!0)&&a({...l._formState})}}),Re.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),Re.useEffect(()=>{if(l._proxyFormState.isDirty){const f=l._getDirty();f!==n.isDirty&&l._subjects.state.next({isDirty:f})}},[l,n.isDirty]),Re.useEffect(()=>{e.values&&!Eg(e.values,r.current)?(l._reset(e.values,l._options.resetOptions),r.current=e.values,a(f=>({...f}))):l._resetDefaultValues()},[e.values,l]),Re.useEffect(()=>{e.errors&&l._setErrors(e.errors)},[e.errors,l]),Re.useEffect(()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),Re.useEffect(()=>{e.shouldUnregister&&l._subjects.values.next({values:l._getWatch()})},[e.shouldUnregister,l]),t.current.formState=SK(n,l),t.current}var Yi;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const l={};for(const f of a)l[f]=f;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),f={};for(const i of l)f[i]=a[i];return e.objectValues(f)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const f in a)Object.prototype.hasOwnProperty.call(a,f)&&l.push(f);return l},e.find=(a,l)=>{for(const f of a)if(l(f))return f},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,l=" | "){return a.map(f=>typeof f=="string"?`'${f}'`:f).join(l)}e.joinValues=n,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(Yi||(Yi={}));var ZN;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(ZN||(ZN={}));const sn=Yi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),tm=e=>{switch(typeof e){case"undefined":return sn.undefined;case"string":return sn.string;case"number":return isNaN(e)?sn.nan:sn.number;case"boolean":return sn.boolean;case"function":return sn.function;case"bigint":return sn.bigint;case"symbol":return sn.symbol;case"object":return Array.isArray(e)?sn.array:e===null?sn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?sn.promise:typeof Map<"u"&&e instanceof Map?sn.map:typeof Set<"u"&&e instanceof Set?sn.set:typeof Date<"u"&&e instanceof Date?sn.date:sn.object;default:return sn.unknown}},Or=Yi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),hme=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class xu extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(l){return l.message},n={_errors:[]},a=l=>{for(const f of l.issues)if(f.code==="invalid_union")f.unionErrors.map(a);else if(f.code==="invalid_return_type")a(f.returnTypeError);else if(f.code==="invalid_arguments")a(f.argumentsError);else if(f.path.length===0)n._errors.push(r(f));else{let i=n,_=0;for(;_<f.path.length;){const w=f.path[_];_===f.path.length-1?(i[w]=i[w]||{_errors:[]},i[w]._errors.push(r(f))):i[w]=i[w]||{_errors:[]},i=i[w],_++}}};return a(this),n}static assert(t){if(!(t instanceof xu))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Yi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}xu.create=e=>new xu(e);const Ax=(e,t)=>{let r;switch(e.code){case Or.invalid_type:e.received===sn.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Or.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Yi.jsonStringifyReplacer)}`;break;case Or.unrecognized_keys:r=`Unrecognized key(s) in object: ${Yi.joinValues(e.keys,", ")}`;break;case Or.invalid_union:r="Invalid input";break;case Or.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Yi.joinValues(e.options)}`;break;case Or.invalid_enum_value:r=`Invalid enum value. Expected ${Yi.joinValues(e.options)}, received '${e.received}'`;break;case Or.invalid_arguments:r="Invalid function arguments";break;case Or.invalid_return_type:r="Invalid function return type";break;case Or.invalid_date:r="Invalid date";break;case Or.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Yi.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Or.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Or.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Or.custom:r="Invalid input";break;case Or.invalid_intersection_types:r="Intersection results could not be merged";break;case Or.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Or.not_finite:r="Number must be finite";break;default:r=t.defaultError,Yi.assertNever(e)}return{message:r}};let IK=Ax;function fme(e){IK=e}function EA(){return IK}const kA=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,l=[...r,...a.path||[]],f={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let i="";const _=n.filter(w=>!!w).slice().reverse();for(const w of _)i=w(f,{data:t,defaultError:i}).message;return{...a,path:l,message:i}},pme=[];function Yr(e,t){const r=EA(),n=kA({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===Ax?void 0:Ax].filter(a=>!!a)});e.common.issues.push(n)}class $l{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return ui;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const l=await a.key,f=await a.value;n.push({key:l,value:f})}return $l.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:l,value:f}=a;if(l.status==="aborted"||f.status==="aborted")return ui;l.status==="dirty"&&t.dirty(),f.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof f.value<"u"||a.alwaysSet)&&(n[l.value]=f.value)}return{status:t.value,value:n}}}const ui=Object.freeze({status:"aborted"}),rx=e=>({status:"dirty",value:e}),lc=e=>({status:"valid",value:e}),YN=e=>e.status==="aborted",XN=e=>e.status==="dirty",Nv=e=>e.status==="valid",P1=e=>typeof Promise<"u"&&e instanceof Promise;function MA(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function DK(e,t,r,n,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var Pn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Pn||(Pn={}));var Hb,Kb;class Hf{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const GB=(e,t)=>{if(Nv(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new xu(e.common.issues);return this._error=r,this._error}}};function Ai(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(f,i)=>{var _,w;const{message:A}=e;return f.code==="invalid_enum_value"?{message:A??i.defaultError}:typeof i.data>"u"?{message:(_=A??n)!==null&&_!==void 0?_:i.defaultError}:f.code!=="invalid_type"?{message:i.defaultError}:{message:(w=A??r)!==null&&w!==void 0?w:i.defaultError}},description:a}}class Mi{get description(){return this._def.description}_getType(t){return tm(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:tm(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new $l,ctx:{common:t.parent.common,data:t.data,parsedType:tm(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(P1(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:tm(t)},l=this._parseSync({data:t,path:a.path,parent:a});return GB(a,l)}"~validate"(t){var r,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:tm(t)};if(!this["~standard"].async)try{const l=this._parseSync({data:t,path:[],parent:a});return Nv(l)?{value:l.value}:{issues:a.common.issues}}catch(l){!((n=(r=l==null?void 0:l.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(l=>Nv(l)?{value:l.value}:{issues:a.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:tm(t)},a=this._parse({data:t,path:n.path,parent:n}),l=await(P1(a)?a:Promise.resolve(a));return GB(n,l)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,l)=>{const f=t(a),i=()=>l.addIssue({code:Or.custom,...n(a)});return typeof Promise<"u"&&f instanceof Promise?f.then(_=>_?!0:(i(),!1)):f?!0:(i(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Ih({schema:this,typeName:li.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ff.create(this,this._def)}nullable(){return qg.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Eh.create(this)}promise(){return Px.create(this,this._def)}or(t){return M1.create([this,t],this._def)}and(t){return j1.create(this,t,this._def)}transform(t){return new Ih({...Ai(this._def),schema:this,typeName:li.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new D1({...Ai(this._def),innerType:this,defaultValue:r,typeName:li.ZodDefault})}brand(){return new iD({typeName:li.ZodBranded,type:this,...Ai(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new L1({...Ai(this._def),innerType:this,catchValue:r,typeName:li.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Uw.create(this,t)}readonly(){return z1.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const mme=/^c[^\s-]{8,}$/i,gme=/^[0-9a-z]+$/,yme=/^[0-9A-HJKMNP-TV-Z]{26}$/i,vme=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,xme=/^[a-z0-9_-]{21}$/i,_me=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,bme=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,wme=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Sme="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let JE;const Ame=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Tme=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Pme=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Cme=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Eme=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,kme=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,LK="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Mme=new RegExp(`^${LK}$`);function zK(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function jme(e){return new RegExp(`^${zK(e)}$`)}function FK(e){let t=`${LK}T${zK(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Ome(e,t){return!!((t==="v4"||!t)&&Ame.test(e)||(t==="v6"||!t)&&Pme.test(e))}function Nme(e,t){if(!_me.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||!a.typ||!a.alg||t&&a.alg!==t)}catch{return!1}}function Rme(e,t){return!!((t==="v4"||!t)&&Tme.test(e)||(t==="v6"||!t)&&Cme.test(e))}class Ch extends Mi{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==sn.string){const l=this._getOrReturnCtx(t);return Yr(l,{code:Or.invalid_type,expected:sn.string,received:l.parsedType}),ui}const n=new $l;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="length"){const f=t.data.length>l.value,i=t.data.length<l.value;(f||i)&&(a=this._getOrReturnCtx(t,a),f?Yr(a,{code:Or.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):i&&Yr(a,{code:Or.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),n.dirty())}else if(l.kind==="email")wme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"email",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="emoji")JE||(JE=new RegExp(Sme,"u")),JE.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"emoji",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="uuid")vme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"uuid",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="nanoid")xme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"nanoid",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid")mme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"cuid",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid2")gme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"cuid2",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="ulid")yme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"ulid",code:Or.invalid_string,message:l.message}),n.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Yr(a,{validation:"url",code:Or.invalid_string,message:l.message}),n.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"regex",code:Or.invalid_string,message:l.message}),n.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),n.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.invalid_string,validation:{startsWith:l.value},message:l.message}),n.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.invalid_string,validation:{endsWith:l.value},message:l.message}),n.dirty()):l.kind==="datetime"?FK(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.invalid_string,validation:"datetime",message:l.message}),n.dirty()):l.kind==="date"?Mme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.invalid_string,validation:"date",message:l.message}),n.dirty()):l.kind==="time"?jme(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.invalid_string,validation:"time",message:l.message}),n.dirty()):l.kind==="duration"?bme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"duration",code:Or.invalid_string,message:l.message}),n.dirty()):l.kind==="ip"?Ome(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"ip",code:Or.invalid_string,message:l.message}),n.dirty()):l.kind==="jwt"?Nme(t.data,l.alg)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"jwt",code:Or.invalid_string,message:l.message}),n.dirty()):l.kind==="cidr"?Rme(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"cidr",code:Or.invalid_string,message:l.message}),n.dirty()):l.kind==="base64"?Eme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"base64",code:Or.invalid_string,message:l.message}),n.dirty()):l.kind==="base64url"?kme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"base64url",code:Or.invalid_string,message:l.message}),n.dirty()):Yi.assertNever(l);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:Or.invalid_string,...Pn.errToObj(n)})}_addCheck(t){return new Ch({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Pn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Pn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Pn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Pn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Pn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Pn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Pn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Pn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Pn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Pn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Pn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Pn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Pn.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...Pn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Pn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Pn.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Pn.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...Pn.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Pn.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Pn.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Pn.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Pn.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Pn.errToObj(r)})}nonempty(t){return this.min(1,Pn.errToObj(t))}trim(){return new Ch({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ch({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ch({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ch.create=e=>{var t;return new Ch({checks:[],typeName:li.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Ai(e)})};function Ime(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,l=parseInt(e.toFixed(a).replace(".","")),f=parseInt(t.toFixed(a).replace(".",""));return l%f/Math.pow(10,a)}class Vg extends Mi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==sn.number){const l=this._getOrReturnCtx(t);return Yr(l,{code:Or.invalid_type,expected:sn.number,received:l.parsedType}),ui}let n;const a=new $l;for(const l of this._def.checks)l.kind==="int"?Yi.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?Ime(t.data,l.value)!==0&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.not_finite,message:l.message}),a.dirty()):Yi.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Pn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Pn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Pn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Pn.toString(r))}setLimit(t,r,n,a){return new Vg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Pn.toString(a)}]})}_addCheck(t){return new Vg({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Pn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Pn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Pn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Pn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Pn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Pn.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Pn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Pn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Pn.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Yi.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Vg.create=e=>new Vg({checks:[],typeName:li.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Ai(e)});class Ug extends Mi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==sn.bigint)return this._getInvalidInput(t);let n;const a=new $l;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Or.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):Yi.assertNever(l);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Yr(r,{code:Or.invalid_type,expected:sn.bigint,received:r.parsedType}),ui}gte(t,r){return this.setLimit("min",t,!0,Pn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Pn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Pn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Pn.toString(r))}setLimit(t,r,n,a){return new Ug({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Pn.toString(a)}]})}_addCheck(t){return new Ug({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Pn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Pn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Pn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Pn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Pn.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ug.create=e=>{var t;return new Ug({checks:[],typeName:li.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Ai(e)})};class C1 extends Mi{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==sn.boolean){const n=this._getOrReturnCtx(t);return Yr(n,{code:Or.invalid_type,expected:sn.boolean,received:n.parsedType}),ui}return lc(t.data)}}C1.create=e=>new C1({typeName:li.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Ai(e)});class Rv extends Mi{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==sn.date){const l=this._getOrReturnCtx(t);return Yr(l,{code:Or.invalid_type,expected:sn.date,received:l.parsedType}),ui}if(isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Yr(l,{code:Or.invalid_date}),ui}const n=new $l;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),n.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Or.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),n.dirty()):Yi.assertNever(l);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Rv({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Pn.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Pn.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Rv.create=e=>new Rv({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:li.ZodDate,...Ai(e)});class jA extends Mi{_parse(t){if(this._getType(t)!==sn.symbol){const n=this._getOrReturnCtx(t);return Yr(n,{code:Or.invalid_type,expected:sn.symbol,received:n.parsedType}),ui}return lc(t.data)}}jA.create=e=>new jA({typeName:li.ZodSymbol,...Ai(e)});class E1 extends Mi{_parse(t){if(this._getType(t)!==sn.undefined){const n=this._getOrReturnCtx(t);return Yr(n,{code:Or.invalid_type,expected:sn.undefined,received:n.parsedType}),ui}return lc(t.data)}}E1.create=e=>new E1({typeName:li.ZodUndefined,...Ai(e)});class k1 extends Mi{_parse(t){if(this._getType(t)!==sn.null){const n=this._getOrReturnCtx(t);return Yr(n,{code:Or.invalid_type,expected:sn.null,received:n.parsedType}),ui}return lc(t.data)}}k1.create=e=>new k1({typeName:li.ZodNull,...Ai(e)});class Tx extends Mi{constructor(){super(...arguments),this._any=!0}_parse(t){return lc(t.data)}}Tx.create=e=>new Tx({typeName:li.ZodAny,...Ai(e)});class Tv extends Mi{constructor(){super(...arguments),this._unknown=!0}_parse(t){return lc(t.data)}}Tv.create=e=>new Tv({typeName:li.ZodUnknown,...Ai(e)});class fm extends Mi{_parse(t){const r=this._getOrReturnCtx(t);return Yr(r,{code:Or.invalid_type,expected:sn.never,received:r.parsedType}),ui}}fm.create=e=>new fm({typeName:li.ZodNever,...Ai(e)});class OA extends Mi{_parse(t){if(this._getType(t)!==sn.undefined){const n=this._getOrReturnCtx(t);return Yr(n,{code:Or.invalid_type,expected:sn.void,received:n.parsedType}),ui}return lc(t.data)}}OA.create=e=>new OA({typeName:li.ZodVoid,...Ai(e)});class Eh extends Mi{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==sn.array)return Yr(r,{code:Or.invalid_type,expected:sn.array,received:r.parsedType}),ui;if(a.exactLength!==null){const f=r.data.length>a.exactLength.value,i=r.data.length<a.exactLength.value;(f||i)&&(Yr(r,{code:f?Or.too_big:Or.too_small,minimum:i?a.exactLength.value:void 0,maximum:f?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Yr(r,{code:Or.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Yr(r,{code:Or.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((f,i)=>a.type._parseAsync(new Hf(r,f,r.path,i)))).then(f=>$l.mergeArray(n,f));const l=[...r.data].map((f,i)=>a.type._parseSync(new Hf(r,f,r.path,i)));return $l.mergeArray(n,l)}get element(){return this._def.type}min(t,r){return new Eh({...this._def,minLength:{value:t,message:Pn.toString(r)}})}max(t,r){return new Eh({...this._def,maxLength:{value:t,message:Pn.toString(r)}})}length(t,r){return new Eh({...this._def,exactLength:{value:t,message:Pn.toString(r)}})}nonempty(t){return this.min(1,t)}}Eh.create=(e,t)=>new Eh({type:e,minLength:null,maxLength:null,exactLength:null,typeName:li.ZodArray,...Ai(t)});function tx(e){if(e instanceof Ms){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ff.create(tx(n))}return new Ms({...e._def,shape:()=>t})}else return e instanceof Eh?new Eh({...e._def,type:tx(e.element)}):e instanceof Ff?Ff.create(tx(e.unwrap())):e instanceof qg?qg.create(tx(e.unwrap())):e instanceof Kf?Kf.create(e.items.map(t=>tx(t))):e}class Ms extends Mi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Yi.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==sn.object){const w=this._getOrReturnCtx(t);return Yr(w,{code:Or.invalid_type,expected:sn.object,received:w.parsedType}),ui}const{status:n,ctx:a}=this._processInputParams(t),{shape:l,keys:f}=this._getCached(),i=[];if(!(this._def.catchall instanceof fm&&this._def.unknownKeys==="strip"))for(const w in a.data)f.includes(w)||i.push(w);const _=[];for(const w of f){const A=l[w],E=a.data[w];_.push({key:{status:"valid",value:w},value:A._parse(new Hf(a,E,a.path,w)),alwaysSet:w in a.data})}if(this._def.catchall instanceof fm){const w=this._def.unknownKeys;if(w==="passthrough")for(const A of i)_.push({key:{status:"valid",value:A},value:{status:"valid",value:a.data[A]}});else if(w==="strict")i.length>0&&(Yr(a,{code:Or.unrecognized_keys,keys:i}),n.dirty());else if(w!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const w=this._def.catchall;for(const A of i){const E=a.data[A];_.push({key:{status:"valid",value:A},value:w._parse(new Hf(a,E,a.path,A)),alwaysSet:A in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const w=[];for(const A of _){const E=await A.key,O=await A.value;w.push({key:E,value:O,alwaysSet:A.alwaysSet})}return w}).then(w=>$l.mergeObjectSync(n,w)):$l.mergeObjectSync(n,_)}get shape(){return this._def.shape()}strict(t){return Pn.errToObj,new Ms({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,l,f,i;const _=(f=(l=(a=this._def).errorMap)===null||l===void 0?void 0:l.call(a,r,n).message)!==null&&f!==void 0?f:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=Pn.errToObj(t).message)!==null&&i!==void 0?i:_}:{message:_}}}:{}})}strip(){return new Ms({...this._def,unknownKeys:"strip"})}passthrough(){return new Ms({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ms({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ms({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:li.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Ms({...this._def,catchall:t})}pick(t){const r={};return Yi.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Ms({...this._def,shape:()=>r})}omit(t){const r={};return Yi.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Ms({...this._def,shape:()=>r})}deepPartial(){return tx(this)}partial(t){const r={};return Yi.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new Ms({...this._def,shape:()=>r})}required(t){const r={};return Yi.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let l=this.shape[n];for(;l instanceof Ff;)l=l._def.innerType;r[n]=l}}),new Ms({...this._def,shape:()=>r})}keyof(){return BK(Yi.objectKeys(this.shape))}}Ms.create=(e,t)=>new Ms({shape:()=>e,unknownKeys:"strip",catchall:fm.create(),typeName:li.ZodObject,...Ai(t)});Ms.strictCreate=(e,t)=>new Ms({shape:()=>e,unknownKeys:"strict",catchall:fm.create(),typeName:li.ZodObject,...Ai(t)});Ms.lazycreate=(e,t)=>new Ms({shape:e,unknownKeys:"strip",catchall:fm.create(),typeName:li.ZodObject,...Ai(t)});class M1 extends Mi{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(l){for(const i of l)if(i.result.status==="valid")return i.result;for(const i of l)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const f=l.map(i=>new xu(i.ctx.common.issues));return Yr(r,{code:Or.invalid_union,unionErrors:f}),ui}if(r.common.async)return Promise.all(n.map(async l=>{const f={...r,common:{...r.common,issues:[]},parent:null};return{result:await l._parseAsync({data:r.data,path:r.path,parent:f}),ctx:f}})).then(a);{let l;const f=[];for(const _ of n){const w={...r,common:{...r.common,issues:[]},parent:null},A=_._parseSync({data:r.data,path:r.path,parent:w});if(A.status==="valid")return A;A.status==="dirty"&&!l&&(l={result:A,ctx:w}),w.common.issues.length&&f.push(w.common.issues)}if(l)return r.common.issues.push(...l.ctx.common.issues),l.result;const i=f.map(_=>new xu(_));return Yr(r,{code:Or.invalid_union,unionErrors:i}),ui}}get options(){return this._def.options}}M1.create=(e,t)=>new M1({options:e,typeName:li.ZodUnion,...Ai(t)});const Jp=e=>e instanceof N1?Jp(e.schema):e instanceof Ih?Jp(e.innerType()):e instanceof R1?[e.value]:e instanceof $g?e.options:e instanceof I1?Yi.objectValues(e.enum):e instanceof D1?Jp(e._def.innerType):e instanceof E1?[void 0]:e instanceof k1?[null]:e instanceof Ff?[void 0,...Jp(e.unwrap())]:e instanceof qg?[null,...Jp(e.unwrap())]:e instanceof iD||e instanceof z1?Jp(e.unwrap()):e instanceof L1?Jp(e._def.innerType):[];class gP extends Mi{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==sn.object)return Yr(r,{code:Or.invalid_type,expected:sn.object,received:r.parsedType}),ui;const n=this.discriminator,a=r.data[n],l=this.optionsMap.get(a);return l?r.common.async?l._parseAsync({data:r.data,path:r.path,parent:r}):l._parseSync({data:r.data,path:r.path,parent:r}):(Yr(r,{code:Or.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),ui)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const l of r){const f=Jp(l.shape[t]);if(!f.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of f){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,l)}}return new gP({typeName:li.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...Ai(n)})}}function JN(e,t){const r=tm(e),n=tm(t);if(e===t)return{valid:!0,data:e};if(r===sn.object&&n===sn.object){const a=Yi.objectKeys(t),l=Yi.objectKeys(e).filter(i=>a.indexOf(i)!==-1),f={...e,...t};for(const i of l){const _=JN(e[i],t[i]);if(!_.valid)return{valid:!1};f[i]=_.data}return{valid:!0,data:f}}else if(r===sn.array&&n===sn.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const f=e[l],i=t[l],_=JN(f,i);if(!_.valid)return{valid:!1};a.push(_.data)}return{valid:!0,data:a}}else return r===sn.date&&n===sn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class j1 extends Mi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(l,f)=>{if(YN(l)||YN(f))return ui;const i=JN(l.value,f.value);return i.valid?((XN(l)||XN(f))&&r.dirty(),{status:r.value,value:i.data}):(Yr(n,{code:Or.invalid_intersection_types}),ui)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([l,f])=>a(l,f)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}j1.create=(e,t,r)=>new j1({left:e,right:t,typeName:li.ZodIntersection,...Ai(r)});class Kf extends Mi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==sn.array)return Yr(n,{code:Or.invalid_type,expected:sn.array,received:n.parsedType}),ui;if(n.data.length<this._def.items.length)return Yr(n,{code:Or.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ui;!this._def.rest&&n.data.length>this._def.items.length&&(Yr(n,{code:Or.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const l=[...n.data].map((f,i)=>{const _=this._def.items[i]||this._def.rest;return _?_._parse(new Hf(n,f,n.path,i)):null}).filter(f=>!!f);return n.common.async?Promise.all(l).then(f=>$l.mergeArray(r,f)):$l.mergeArray(r,l)}get items(){return this._def.items}rest(t){return new Kf({...this._def,rest:t})}}Kf.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kf({items:e,typeName:li.ZodTuple,rest:null,...Ai(t)})};class O1 extends Mi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==sn.object)return Yr(n,{code:Or.invalid_type,expected:sn.object,received:n.parsedType}),ui;const a=[],l=this._def.keyType,f=this._def.valueType;for(const i in n.data)a.push({key:l._parse(new Hf(n,i,n.path,i)),value:f._parse(new Hf(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?$l.mergeObjectAsync(r,a):$l.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Mi?new O1({keyType:t,valueType:r,typeName:li.ZodRecord,...Ai(n)}):new O1({keyType:Ch.create(),valueType:t,typeName:li.ZodRecord,...Ai(r)})}}class NA extends Mi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==sn.map)return Yr(n,{code:Or.invalid_type,expected:sn.map,received:n.parsedType}),ui;const a=this._def.keyType,l=this._def.valueType,f=[...n.data.entries()].map(([i,_],w)=>({key:a._parse(new Hf(n,i,n.path,[w,"key"])),value:l._parse(new Hf(n,_,n.path,[w,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const _ of f){const w=await _.key,A=await _.value;if(w.status==="aborted"||A.status==="aborted")return ui;(w.status==="dirty"||A.status==="dirty")&&r.dirty(),i.set(w.value,A.value)}return{status:r.value,value:i}})}else{const i=new Map;for(const _ of f){const w=_.key,A=_.value;if(w.status==="aborted"||A.status==="aborted")return ui;(w.status==="dirty"||A.status==="dirty")&&r.dirty(),i.set(w.value,A.value)}return{status:r.value,value:i}}}}NA.create=(e,t,r)=>new NA({valueType:t,keyType:e,typeName:li.ZodMap,...Ai(r)});class Iv extends Mi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==sn.set)return Yr(n,{code:Or.invalid_type,expected:sn.set,received:n.parsedType}),ui;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(Yr(n,{code:Or.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(Yr(n,{code:Or.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const l=this._def.valueType;function f(_){const w=new Set;for(const A of _){if(A.status==="aborted")return ui;A.status==="dirty"&&r.dirty(),w.add(A.value)}return{status:r.value,value:w}}const i=[...n.data.values()].map((_,w)=>l._parse(new Hf(n,_,n.path,w)));return n.common.async?Promise.all(i).then(_=>f(_)):f(i)}min(t,r){return new Iv({...this._def,minSize:{value:t,message:Pn.toString(r)}})}max(t,r){return new Iv({...this._def,maxSize:{value:t,message:Pn.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Iv.create=(e,t)=>new Iv({valueType:e,minSize:null,maxSize:null,typeName:li.ZodSet,...Ai(t)});class gx extends Mi{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==sn.function)return Yr(r,{code:Or.invalid_type,expected:sn.function,received:r.parsedType}),ui;function n(i,_){return kA({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,EA(),Ax].filter(w=>!!w),issueData:{code:Or.invalid_arguments,argumentsError:_}})}function a(i,_){return kA({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,EA(),Ax].filter(w=>!!w),issueData:{code:Or.invalid_return_type,returnTypeError:_}})}const l={errorMap:r.common.contextualErrorMap},f=r.data;if(this._def.returns instanceof Px){const i=this;return lc(async function(..._){const w=new xu([]),A=await i._def.args.parseAsync(_,l).catch(F=>{throw w.addIssue(n(_,F)),w}),E=await Reflect.apply(f,this,A);return await i._def.returns._def.type.parseAsync(E,l).catch(F=>{throw w.addIssue(a(E,F)),w})})}else{const i=this;return lc(function(..._){const w=i._def.args.safeParse(_,l);if(!w.success)throw new xu([n(_,w.error)]);const A=Reflect.apply(f,this,w.data),E=i._def.returns.safeParse(A,l);if(!E.success)throw new xu([a(A,E.error)]);return E.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new gx({...this._def,args:Kf.create(t).rest(Tv.create())})}returns(t){return new gx({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new gx({args:t||Kf.create([]).rest(Tv.create()),returns:r||Tv.create(),typeName:li.ZodFunction,...Ai(n)})}}class N1 extends Mi{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}N1.create=(e,t)=>new N1({getter:e,typeName:li.ZodLazy,...Ai(t)});class R1 extends Mi{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Yr(r,{received:r.data,code:Or.invalid_literal,expected:this._def.value}),ui}return{status:"valid",value:t.data}}get value(){return this._def.value}}R1.create=(e,t)=>new R1({value:e,typeName:li.ZodLiteral,...Ai(t)});function BK(e,t){return new $g({values:e,typeName:li.ZodEnum,...Ai(t)})}class $g extends Mi{constructor(){super(...arguments),Hb.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return Yr(r,{expected:Yi.joinValues(n),received:r.parsedType,code:Or.invalid_type}),ui}if(MA(this,Hb)||DK(this,Hb,new Set(this._def.values)),!MA(this,Hb).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return Yr(r,{received:r.data,code:Or.invalid_enum_value,options:n}),ui}return lc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return $g.create(t,{...this._def,...r})}exclude(t,r=this._def){return $g.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Hb=new WeakMap;$g.create=BK;class I1 extends Mi{constructor(){super(...arguments),Kb.set(this,void 0)}_parse(t){const r=Yi.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==sn.string&&n.parsedType!==sn.number){const a=Yi.objectValues(r);return Yr(n,{expected:Yi.joinValues(a),received:n.parsedType,code:Or.invalid_type}),ui}if(MA(this,Kb)||DK(this,Kb,new Set(Yi.getValidEnumValues(this._def.values))),!MA(this,Kb).has(t.data)){const a=Yi.objectValues(r);return Yr(n,{received:n.data,code:Or.invalid_enum_value,options:a}),ui}return lc(t.data)}get enum(){return this._def.values}}Kb=new WeakMap;I1.create=(e,t)=>new I1({values:e,typeName:li.ZodNativeEnum,...Ai(t)});class Px extends Mi{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==sn.promise&&r.common.async===!1)return Yr(r,{code:Or.invalid_type,expected:sn.promise,received:r.parsedType}),ui;const n=r.parsedType===sn.promise?r.data:Promise.resolve(r.data);return lc(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Px.create=(e,t)=>new Px({type:e,typeName:li.ZodPromise,...Ai(t)});class Ih extends Mi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===li.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:f=>{Yr(n,f),f.fatal?r.abort():r.dirty()},get path(){return n.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const f=a.transform(n.data,l);if(n.common.async)return Promise.resolve(f).then(async i=>{if(r.value==="aborted")return ui;const _=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return _.status==="aborted"?ui:_.status==="dirty"||r.value==="dirty"?rx(_.value):_});{if(r.value==="aborted")return ui;const i=this._def.schema._parseSync({data:f,path:n.path,parent:n});return i.status==="aborted"?ui:i.status==="dirty"||r.value==="dirty"?rx(i.value):i}}if(a.type==="refinement"){const f=i=>{const _=a.refinement(i,l);if(n.common.async)return Promise.resolve(_);if(_ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?ui:(i.status==="dirty"&&r.dirty(),f(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?ui:(i.status==="dirty"&&r.dirty(),f(i.value).then(()=>({status:r.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const f=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Nv(f))return f;const i=a.transform(f.value,l);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(f=>Nv(f)?Promise.resolve(a.transform(f.value,l)).then(i=>({status:r.value,value:i})):f);Yi.assertNever(a)}}Ih.create=(e,t,r)=>new Ih({schema:e,typeName:li.ZodEffects,effect:t,...Ai(r)});Ih.createWithPreprocess=(e,t,r)=>new Ih({schema:t,effect:{type:"preprocess",transform:e},typeName:li.ZodEffects,...Ai(r)});class Ff extends Mi{_parse(t){return this._getType(t)===sn.undefined?lc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ff.create=(e,t)=>new Ff({innerType:e,typeName:li.ZodOptional,...Ai(t)});class qg extends Mi{_parse(t){return this._getType(t)===sn.null?lc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}qg.create=(e,t)=>new qg({innerType:e,typeName:li.ZodNullable,...Ai(t)});class D1 extends Mi{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===sn.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}D1.create=(e,t)=>new D1({innerType:e,typeName:li.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ai(t)});class L1 extends Mi{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return P1(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new xu(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new xu(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}L1.create=(e,t)=>new L1({innerType:e,typeName:li.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ai(t)});class RA extends Mi{_parse(t){if(this._getType(t)!==sn.nan){const n=this._getOrReturnCtx(t);return Yr(n,{code:Or.invalid_type,expected:sn.nan,received:n.parsedType}),ui}return{status:"valid",value:t.data}}}RA.create=e=>new RA({typeName:li.ZodNaN,...Ai(e)});const Dme=Symbol("zod_brand");class iD extends Mi{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Uw extends Mi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?ui:l.status==="dirty"?(r.dirty(),rx(l.value)):this._def.out._parseAsync({data:l.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?ui:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new Uw({in:t,out:r,typeName:li.ZodPipeline})}}class z1 extends Mi{_parse(t){const r=this._def.innerType._parse(t),n=a=>(Nv(a)&&(a.value=Object.freeze(a.value)),a);return P1(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}z1.create=(e,t)=>new z1({innerType:e,typeName:li.ZodReadonly,...Ai(t)});function WB(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function VK(e,t={},r){return e?Tx.create().superRefine((n,a)=>{var l,f;const i=e(n);if(i instanceof Promise)return i.then(_=>{var w,A;if(!_){const E=WB(t,n),O=(A=(w=E.fatal)!==null&&w!==void 0?w:r)!==null&&A!==void 0?A:!0;a.addIssue({code:"custom",...E,fatal:O})}});if(!i){const _=WB(t,n),w=(f=(l=_.fatal)!==null&&l!==void 0?l:r)!==null&&f!==void 0?f:!0;a.addIssue({code:"custom",..._,fatal:w})}}):Tx.create()}const Lme={object:Ms.lazycreate};var li;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(li||(li={}));const zme=(e,t={message:`Input not instance of ${e.name}`})=>VK(r=>r instanceof e,t),UK=Ch.create,$K=Vg.create,Fme=RA.create,Bme=Ug.create,qK=C1.create,Vme=Rv.create,Ume=jA.create,$me=E1.create,qme=k1.create,Gme=Tx.create,Wme=Tv.create,Hme=fm.create,Kme=OA.create,Zme=Eh.create,Yme=Ms.create,Xme=Ms.strictCreate,Jme=M1.create,Qme=gP.create,ege=j1.create,tge=Kf.create,rge=O1.create,nge=NA.create,ige=Iv.create,age=gx.create,sge=N1.create,oge=R1.create,lge=$g.create,cge=I1.create,uge=Px.create,HB=Ih.create,dge=Ff.create,hge=qg.create,fge=Ih.createWithPreprocess,pge=Uw.create,mge=()=>UK().optional(),gge=()=>$K().optional(),yge=()=>qK().optional(),vge={string:e=>Ch.create({...e,coerce:!0}),number:e=>Vg.create({...e,coerce:!0}),boolean:e=>C1.create({...e,coerce:!0}),bigint:e=>Ug.create({...e,coerce:!0}),date:e=>Rv.create({...e,coerce:!0})},xge=ui;var en=Object.freeze({__proto__:null,defaultErrorMap:Ax,setErrorMap:fme,getErrorMap:EA,makeIssue:kA,EMPTY_PATH:pme,addIssueToContext:Yr,ParseStatus:$l,INVALID:ui,DIRTY:rx,OK:lc,isAborted:YN,isDirty:XN,isValid:Nv,isAsync:P1,get util(){return Yi},get objectUtil(){return ZN},ZodParsedType:sn,getParsedType:tm,ZodType:Mi,datetimeRegex:FK,ZodString:Ch,ZodNumber:Vg,ZodBigInt:Ug,ZodBoolean:C1,ZodDate:Rv,ZodSymbol:jA,ZodUndefined:E1,ZodNull:k1,ZodAny:Tx,ZodUnknown:Tv,ZodNever:fm,ZodVoid:OA,ZodArray:Eh,ZodObject:Ms,ZodUnion:M1,ZodDiscriminatedUnion:gP,ZodIntersection:j1,ZodTuple:Kf,ZodRecord:O1,ZodMap:NA,ZodSet:Iv,ZodFunction:gx,ZodLazy:N1,ZodLiteral:R1,ZodEnum:$g,ZodNativeEnum:I1,ZodPromise:Px,ZodEffects:Ih,ZodTransformer:Ih,ZodOptional:Ff,ZodNullable:qg,ZodDefault:D1,ZodCatch:L1,ZodNaN:RA,BRAND:Dme,ZodBranded:iD,ZodPipeline:Uw,ZodReadonly:z1,custom:VK,Schema:Mi,ZodSchema:Mi,late:Lme,get ZodFirstPartyTypeKind(){return li},coerce:vge,any:Gme,array:Zme,bigint:Bme,boolean:qK,date:Vme,discriminatedUnion:Qme,effect:HB,enum:lge,function:age,instanceof:zme,intersection:ege,lazy:sge,literal:oge,map:nge,nan:Fme,nativeEnum:cge,never:Hme,null:qme,nullable:hge,number:$K,object:Yme,oboolean:yge,onumber:gge,optional:dge,ostring:mge,pipeline:pge,preprocess:fge,promise:uge,record:rge,set:ige,strictObject:Xme,string:UK,symbol:Ume,transformer:HB,tuple:tge,undefined:$me,union:Jme,unknown:Wme,void:Kme,NEVER:xge,ZodIssueCode:Or,quotelessJson:hme,ZodError:xu});const _ge=en.object({email:en.string().email(),password:en.string().min(6,{message:"Password must be at least 6 characters long"})}),bge=en.object({plateNo:en.union([en.string().min(1,{message:"Plate number is required"}),en.array(en.string().min(1,{message:"Each plate number must not be empty"})).min(1,{message:"At least one plate number is required"})]).transform(e=>typeof e=="string"?e.split(",").map(t=>t.trim()).filter(t=>t.length>0):e),fileNo:en.string().optional(),ownerRepresentativeName:en.string().min(1,{message:"Owner/Representative name is required"}),purok:en.string().optional(),barangay:en.string().min(1,{message:"Barangay is required"}),municipality:en.string().min(1,{message:"Municipality is required"}),province:en.string().min(1,{message:"Province is required"}),contactNumber:en.string().optional(),emailAddress:en.string().email({message:"Invalid email format"}).optional().or(en.literal("")),hasDriversLicense:en.boolean({required_error:"Please specify if you have a driver's license"}),driversLicenseNumber:en.string().optional(),birthDate:en.date().optional()}).refine(e=>!(e.hasDriversLicense&&!e.driversLicenseNumber),{message:"Driver's license number is required when you have a driver's license",path:["driversLicenseNumber"]}),GK=en.object({plateNo:en.string().min(1,{message:"Plate number is required"}),fileNo:en.string().min(1,{message:"File number is required"}),engineNo:en.string().min(1,{message:"Engine number is required"}),chassisNo:en.string().min(1,{message:"Chassis number is required"}),make:en.string().min(1,{message:"Make is required"}),bodyType:en.string().min(1,{message:"Body type is required"}),color:en.string().min(1,{message:"Color is required"}),classification:en.string().min(1,{message:"Classification is required"}),dateOfRenewal:en.date({required_error:"Date of renewal is required"}),vehicleStatusType:en.enum(["New","Old"],{required_error:"Vehicle status type is required"}),driver:en.string().min(1,{message:"Driver selection is required"})}),WK=en.object({accident_id:en.string().optional(),plateNo:en.string().min(1,{message:"Plate number is required"}),accident_date:en.date({required_error:"Accident date is required"}),street:en.string().min(1,{message:"Street is required"}),barangay:en.string().min(1,{message:"Barangay is required"}),municipality:en.string().min(1,{message:"Municipality is required"}),vehicle_type:en.string().min(1,{message:"Vehicle type is required"}),severity:en.string().min(1,{message:"Severity is required"}),notes:en.string().optional()}),HK=en.object({topNo:en.string().optional(),firstName:en.string().optional().nullable(),middleInitial:en.string().optional().nullable(),lastName:en.string().optional().nullable(),suffix:en.string().optional().nullable(),violations:en.array(en.string()).optional().nullable(),violationType:en.enum(["confiscated","alarm","impounded"],{required_error:"Violation type is required"}),licenseType:en.string().optional().nullable(),plateNo:en.string().min(1,{message:"Plate number is required"}),dateOfApprehension:en.date({required_error:"Date of apprehension is required"}),apprehendingOfficer:en.string().min(1,{message:"Apprehending officer is required"}),chassisNo:en.string().optional().nullable(),engineNo:en.string().optional().nullable()}).refine(e=>!(e.middleInitial&&e.middleInitial!==null&&e.middleInitial.trim()!==""&&e.middleInitial.length>1),{message:"Middle initial must be 1 character",path:["middleInitial"]}).refine(e=>!(e.licenseType&&e.licenseType!==null&&e.licenseType.trim()!==""&&!["SP","DL","CL","plate","sp receipt","dl receipt","refuse to sur.","dl tempor"].includes(e.licenseType)),{message:"License type must be SP, DL, CL, plate, sp receipt, dl receipt, refuse to sur., or dl tempor",path:["licenseType"]}),wge=h_("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Sge=H.forwardRef(({className:e,variant:t,...r},n)=>u.jsx("div",{ref:n,role:"alert",className:Wt(wge({variant:t}),e),...r}));Sge.displayName="Alert";const Age=H.forwardRef(({className:e,...t},r)=>u.jsx("h5",{ref:r,className:Wt("mb-1 font-medium leading-none tracking-tight",e),...t}));Age.displayName="AlertTitle";const Tge=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("text-sm [&_p]:leading-relaxed",e),...t}));Tge.displayName="AlertDescription";const KB=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Gr(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},KK=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?KB(n.ref,r,e):n&&n.refs&&n.refs.forEach(a=>KB(a,r,e))}},Pge=(e,t)=>{t.shouldUseNativeValidation&&KK(e,t);const r={};for(const n in e){const a=Gr(t.fields,n),l=Object.assign(e[n]||{},{ref:a&&a.ref});if(Cge(t.names||Object.keys(e),n)){const f=Object.assign({},Gr(r,n));_a(f,"root",l),_a(r,n,f)}else _a(r,n,l)}return r},Cge=(e,t)=>{const r=ZB(t);return e.some(n=>ZB(n).match(`^${r}\\.\\d+`))};function ZB(e){return e.replace(/\]|\[/g,"")}function Ege(e,t){for(var r={};e.length;){var n=e[0],a=n.code,l=n.message,f=n.path.join(".");if(!r[f])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];r[f]={message:i.message,type:i.code}}else r[f]={message:l,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(A){return A.errors.forEach(function(E){return e.push(E)})}),t){var _=r[f].types,w=_&&_[n.code];r[f]=EK(f,t,r,a,w?[].concat(w,n.message):n.message)}e.shift()}return r}function np(e,t,r){return r===void 0&&(r={}),function(n,a,l){try{return Promise.resolve(function(f,i){try{var _=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(w){return l.shouldUseNativeValidation&&KK({},l),{errors:{},values:r.raw?Object.assign({},n):w}})}catch(w){return i(w)}return _&&_.then?_.then(void 0,i):_}(0,function(f){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(f))return{values:{},errors:Pge(Ege(f.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw f}))}catch(f){return Promise.reject(f)}}}const Zv=Xpe,ZK=H.createContext({}),Bn=({...e})=>u.jsx(ZK.Provider,{value:{name:e.name},children:u.jsx(eme,{...e})}),yP=()=>{const e=H.useContext(ZK),t=H.useContext(YK),{getFieldState:r,formState:n}=mP(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...a}},YK=H.createContext({}),Dn=H.forwardRef(({className:e,...t},r)=>{const n=H.useId();return u.jsx(YK.Provider,{value:{id:n},children:u.jsx("div",{ref:r,className:Wt("space-y-2",e),...t})})});Dn.displayName="FormItem";const Ln=H.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=yP();return u.jsx(os,{ref:r,className:Wt(n&&"text-destructive",e),htmlFor:a,...t})});Ln.displayName="FormLabel";const On=H.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:l}=yP();return u.jsx(Ul,{ref:t,id:n,"aria-describedby":r?`${a} ${l}`:`${a}`,"aria-invalid":!!r,...e})});On.displayName="FormControl";const kge=H.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=yP();return u.jsx("p",{ref:r,id:n,className:Wt("text-[0.8rem] text-muted-foreground",e),...t})});kge.displayName="FormDescription";const zn=H.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:l}=yP(),f=a?String((a==null?void 0:a.message)??""):t;return f?u.jsx("p",{ref:n,id:l,className:Wt("text-[0.8rem] font-medium text-destructive",e),...r,children:f}):null});zn.displayName="FormMessage";function XK(e,t){return function(){return e.apply(t,arguments)}}const{toString:Mge}=Object.prototype,{getPrototypeOf:aD}=Object,vP=(e=>t=>{const r=Mge.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),$h=e=>(e=e.toLowerCase(),t=>vP(t)===e),xP=e=>t=>typeof t===e,{isArray:x_}=Array,F1=xP("undefined");function jge(e){return e!==null&&!F1(e)&&e.constructor!==null&&!F1(e.constructor)&&_u(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const JK=$h("ArrayBuffer");function Oge(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&JK(e.buffer),t}const Nge=xP("string"),_u=xP("function"),QK=xP("number"),_P=e=>e!==null&&typeof e=="object",Rge=e=>e===!0||e===!1,iA=e=>{if(vP(e)!=="object")return!1;const t=aD(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Ige=$h("Date"),Dge=$h("File"),Lge=$h("Blob"),zge=$h("FileList"),Fge=e=>_P(e)&&_u(e.pipe),Bge=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||_u(e.append)&&((t=vP(e))==="formdata"||t==="object"&&_u(e.toString)&&e.toString()==="[object FormData]"))},Vge=$h("URLSearchParams"),[Uge,$ge,qge,Gge]=["ReadableStream","Request","Response","Headers"].map($h),Wge=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $w(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),x_(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),f=l.length;let i;for(n=0;n<f;n++)i=l[n],t.call(null,e[i],i,e)}}function eZ(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const yv=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,tZ=e=>!F1(e)&&e!==yv;function QN(){const{caseless:e}=tZ(this)&&this||{},t={},r=(n,a)=>{const l=e&&eZ(t,a)||a;iA(t[l])&&iA(n)?t[l]=QN(t[l],n):iA(n)?t[l]=QN({},n):x_(n)?t[l]=n.slice():t[l]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&$w(arguments[n],r);return t}const Hge=(e,t,r,{allOwnKeys:n}={})=>($w(t,(a,l)=>{r&&_u(a)?e[l]=XK(a,r):e[l]=a},{allOwnKeys:n}),e),Kge=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Zge=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Yge=(e,t,r,n)=>{let a,l,f;const i={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),l=a.length;l-- >0;)f=a[l],(!n||n(f,e,t))&&!i[f]&&(t[f]=e[f],i[f]=!0);e=r!==!1&&aD(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Xge=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Jge=e=>{if(!e)return null;if(x_(e))return e;let t=e.length;if(!QK(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Qge=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&aD(Uint8Array)),eye=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const l=a.value;t.call(e,l[0],l[1])}},tye=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},rye=$h("HTMLFormElement"),nye=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),YB=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),iye=$h("RegExp"),rZ=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};$w(r,(a,l)=>{let f;(f=t(a,l,e))!==!1&&(n[l]=f||a)}),Object.defineProperties(e,n)},aye=e=>{rZ(e,(t,r)=>{if(_u(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(_u(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},sye=(e,t)=>{const r={},n=a=>{a.forEach(l=>{r[l]=!0})};return x_(e)?n(e):n(String(e).split(t)),r},oye=()=>{},lye=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function cye(e){return!!(e&&_u(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const uye=e=>{const t=new Array(10),r=(n,a)=>{if(_P(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const l=x_(n)?[]:{};return $w(n,(f,i)=>{const _=r(f,a+1);!F1(_)&&(l[i]=_)}),t[a]=void 0,l}}return n};return r(e,0)},dye=$h("AsyncFunction"),hye=e=>e&&(_P(e)||_u(e))&&_u(e.then)&&_u(e.catch),nZ=((e,t)=>e?setImmediate:t?((r,n)=>(yv.addEventListener("message",({source:a,data:l})=>{a===yv&&l===r&&n.length&&n.shift()()},!1),a=>{n.push(a),yv.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",_u(yv.postMessage)),fye=typeof queueMicrotask<"u"?queueMicrotask.bind(yv):typeof process<"u"&&process.nextTick||nZ,ir={isArray:x_,isArrayBuffer:JK,isBuffer:jge,isFormData:Bge,isArrayBufferView:Oge,isString:Nge,isNumber:QK,isBoolean:Rge,isObject:_P,isPlainObject:iA,isReadableStream:Uge,isRequest:$ge,isResponse:qge,isHeaders:Gge,isUndefined:F1,isDate:Ige,isFile:Dge,isBlob:Lge,isRegExp:iye,isFunction:_u,isStream:Fge,isURLSearchParams:Vge,isTypedArray:Qge,isFileList:zge,forEach:$w,merge:QN,extend:Hge,trim:Wge,stripBOM:Kge,inherits:Zge,toFlatObject:Yge,kindOf:vP,kindOfTest:$h,endsWith:Xge,toArray:Jge,forEachEntry:eye,matchAll:tye,isHTMLForm:rye,hasOwnProperty:YB,hasOwnProp:YB,reduceDescriptors:rZ,freezeMethods:aye,toObjectSet:sye,toCamelCase:nye,noop:oye,toFiniteNumber:lye,findKey:eZ,global:yv,isContextDefined:tZ,isSpecCompliantForm:cye,toJSONObject:uye,isAsyncFn:dye,isThenable:hye,setImmediate:nZ,asap:fye};function Si(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}ir.inherits(Si,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ir.toJSONObject(this.config),code:this.code,status:this.status}}});const iZ=Si.prototype,aZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{aZ[e]={value:e}});Object.defineProperties(Si,aZ);Object.defineProperty(iZ,"isAxiosError",{value:!0});Si.from=(e,t,r,n,a,l)=>{const f=Object.create(iZ);return ir.toFlatObject(e,f,function(_){return _!==Error.prototype},i=>i!=="isAxiosError"),Si.call(f,e.message,t,r,n,a),f.cause=e,f.name=e.name,l&&Object.assign(f,l),f};const pye=null;function eR(e){return ir.isPlainObject(e)||ir.isArray(e)}function sZ(e){return ir.endsWith(e,"[]")?e.slice(0,-2):e}function XB(e,t,r){return e?e.concat(t).map(function(a,l){return a=sZ(a),!r&&l?"["+a+"]":a}).join(r?".":""):t}function mye(e){return ir.isArray(e)&&!e.some(eR)}const gye=ir.toFlatObject(ir,{},null,function(t){return/^is[A-Z]/.test(t)});function bP(e,t,r){if(!ir.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ir.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(B,q){return!ir.isUndefined(q[B])});const n=r.metaTokens,a=r.visitor||A,l=r.dots,f=r.indexes,_=(r.Blob||typeof Blob<"u"&&Blob)&&ir.isSpecCompliantForm(t);if(!ir.isFunction(a))throw new TypeError("visitor must be a function");function w(U){if(U===null)return"";if(ir.isDate(U))return U.toISOString();if(!_&&ir.isBlob(U))throw new Si("Blob is not supported. Use a Buffer instead.");return ir.isArrayBuffer(U)||ir.isTypedArray(U)?_&&typeof Blob=="function"?new Blob([U]):Buffer.from(U):U}function A(U,B,q){let W=U;if(U&&!q&&typeof U=="object"){if(ir.endsWith(B,"{}"))B=n?B:B.slice(0,-2),U=JSON.stringify(U);else if(ir.isArray(U)&&mye(U)||(ir.isFileList(U)||ir.endsWith(B,"[]"))&&(W=ir.toArray(U)))return B=sZ(B),W.forEach(function(ne,ae){!(ir.isUndefined(ne)||ne===null)&&t.append(f===!0?XB([B],ae,l):f===null?B:B+"[]",w(ne))}),!1}return eR(U)?!0:(t.append(XB(q,B,l),w(U)),!1)}const E=[],O=Object.assign(gye,{defaultVisitor:A,convertValue:w,isVisitable:eR});function F(U,B){if(!ir.isUndefined(U)){if(E.indexOf(U)!==-1)throw Error("Circular reference detected in "+B.join("."));E.push(U),ir.forEach(U,function(W,Z){(!(ir.isUndefined(W)||W===null)&&a.call(t,W,ir.isString(Z)?Z.trim():Z,B,O))===!0&&F(W,B?B.concat(Z):[Z])}),E.pop()}}if(!ir.isObject(e))throw new TypeError("data must be an object");return F(e),t}function JB(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function sD(e,t){this._pairs=[],e&&bP(e,this,t)}const oZ=sD.prototype;oZ.append=function(t,r){this._pairs.push([t,r])};oZ.toString=function(t){const r=t?function(n){return t.call(this,n,JB)}:JB;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function yye(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function lZ(e,t,r){if(!t)return e;const n=r&&r.encode||yye;ir.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let l;if(a?l=a(t,r):l=ir.isURLSearchParams(t)?t.toString():new sD(t,r).toString(n),l){const f=e.indexOf("#");f!==-1&&(e=e.slice(0,f)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class QB{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ir.forEach(this.handlers,function(n){n!==null&&t(n)})}}const cZ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vye=typeof URLSearchParams<"u"?URLSearchParams:sD,xye=typeof FormData<"u"?FormData:null,_ye=typeof Blob<"u"?Blob:null,bye={isBrowser:!0,classes:{URLSearchParams:vye,FormData:xye,Blob:_ye},protocols:["http","https","file","blob","url","data"]},oD=typeof window<"u"&&typeof document<"u",tR=typeof navigator=="object"&&navigator||void 0,wye=oD&&(!tR||["ReactNative","NativeScript","NS"].indexOf(tR.product)<0),Sye=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Aye=oD&&window.location.href||"http://localhost",Tye=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:oD,hasStandardBrowserEnv:wye,hasStandardBrowserWebWorkerEnv:Sye,navigator:tR,origin:Aye},Symbol.toStringTag,{value:"Module"})),Fl={...Tye,...bye};function Pye(e,t){return bP(e,new Fl.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,l){return Fl.isNode&&ir.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function Cye(e){return ir.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Eye(e){const t={},r=Object.keys(e);let n;const a=r.length;let l;for(n=0;n<a;n++)l=r[n],t[l]=e[l];return t}function uZ(e){function t(r,n,a,l){let f=r[l++];if(f==="__proto__")return!0;const i=Number.isFinite(+f),_=l>=r.length;return f=!f&&ir.isArray(a)?a.length:f,_?(ir.hasOwnProp(a,f)?a[f]=[a[f],n]:a[f]=n,!i):((!a[f]||!ir.isObject(a[f]))&&(a[f]=[]),t(r,n,a[f],l)&&ir.isArray(a[f])&&(a[f]=Eye(a[f])),!i)}if(ir.isFormData(e)&&ir.isFunction(e.entries)){const r={};return ir.forEachEntry(e,(n,a)=>{t(Cye(n),a,r,0)}),r}return null}function kye(e,t,r){if(ir.isString(e))try{return(t||JSON.parse)(e),ir.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const qw={transitional:cZ,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,l=ir.isObject(t);if(l&&ir.isHTMLForm(t)&&(t=new FormData(t)),ir.isFormData(t))return a?JSON.stringify(uZ(t)):t;if(ir.isArrayBuffer(t)||ir.isBuffer(t)||ir.isStream(t)||ir.isFile(t)||ir.isBlob(t)||ir.isReadableStream(t))return t;if(ir.isArrayBufferView(t))return t.buffer;if(ir.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Pye(t,this.formSerializer).toString();if((i=ir.isFileList(t))||n.indexOf("multipart/form-data")>-1){const _=this.env&&this.env.FormData;return bP(i?{"files[]":t}:t,_&&new _,this.formSerializer)}}return l||a?(r.setContentType("application/json",!1),kye(t)):t}],transformResponse:[function(t){const r=this.transitional||qw.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(ir.isResponse(t)||ir.isReadableStream(t))return t;if(t&&ir.isString(t)&&(n&&!this.responseType||a)){const f=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(i){if(f)throw i.name==="SyntaxError"?Si.from(i,Si.ERR_BAD_RESPONSE,this,null,this.response):i}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fl.classes.FormData,Blob:Fl.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ir.forEach(["delete","get","head","post","put","patch"],e=>{qw.headers[e]={}});const Mye=ir.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jye=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(f){a=f.indexOf(":"),r=f.substring(0,a).trim().toLowerCase(),n=f.substring(a+1).trim(),!(!r||t[r]&&Mye[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},e6=Symbol("internals");function Ob(e){return e&&String(e).trim().toLowerCase()}function aA(e){return e===!1||e==null?e:ir.isArray(e)?e.map(aA):String(e)}function Oye(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const Nye=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function QE(e,t,r,n,a){if(ir.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!ir.isString(t)){if(ir.isString(n))return t.indexOf(n)!==-1;if(ir.isRegExp(n))return n.test(t)}}function Rye(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function Iye(e,t){const r=ir.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,l,f){return this[n].call(this,t,a,l,f)},configurable:!0})})}let Dc=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function l(i,_,w){const A=Ob(_);if(!A)throw new Error("header name must be a non-empty string");const E=ir.findKey(a,A);(!E||a[E]===void 0||w===!0||w===void 0&&a[E]!==!1)&&(a[E||_]=aA(i))}const f=(i,_)=>ir.forEach(i,(w,A)=>l(w,A,_));if(ir.isPlainObject(t)||t instanceof this.constructor)f(t,r);else if(ir.isString(t)&&(t=t.trim())&&!Nye(t))f(jye(t),r);else if(ir.isHeaders(t))for(const[i,_]of t.entries())l(_,i,n);else t!=null&&l(r,t,n);return this}get(t,r){if(t=Ob(t),t){const n=ir.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return Oye(a);if(ir.isFunction(r))return r.call(this,a,n);if(ir.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ob(t),t){const n=ir.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||QE(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function l(f){if(f=Ob(f),f){const i=ir.findKey(n,f);i&&(!r||QE(n,n[i],i,r))&&(delete n[i],a=!0)}}return ir.isArray(t)?t.forEach(l):l(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const l=r[n];(!t||QE(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const r=this,n={};return ir.forEach(this,(a,l)=>{const f=ir.findKey(n,l);if(f){r[f]=aA(a),delete r[l];return}const i=t?Rye(l):String(l).trim();i!==l&&delete r[l],r[i]=aA(a),n[i]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ir.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&ir.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[e6]=this[e6]={accessors:{}}).accessors,a=this.prototype;function l(f){const i=Ob(f);n[i]||(Iye(a,f),n[i]=!0)}return ir.isArray(t)?t.forEach(l):l(t),this}};Dc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ir.reduceDescriptors(Dc.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});ir.freezeMethods(Dc);function ek(e,t){const r=this||qw,n=t||r,a=Dc.from(n.headers);let l=n.data;return ir.forEach(e,function(i){l=i.call(r,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function dZ(e){return!!(e&&e.__CANCEL__)}function __(e,t,r){Si.call(this,e??"canceled",Si.ERR_CANCELED,t,r),this.name="CanceledError"}ir.inherits(__,Si,{__CANCEL__:!0});function hZ(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Si("Request failed with status code "+r.status,[Si.ERR_BAD_REQUEST,Si.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Dye(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Lye(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,l=0,f;return t=t!==void 0?t:1e3,function(_){const w=Date.now(),A=n[l];f||(f=w),r[a]=_,n[a]=w;let E=l,O=0;for(;E!==a;)O+=r[E++],E=E%e;if(a=(a+1)%e,a===l&&(l=(l+1)%e),w-f<t)return;const F=A&&w-A;return F?Math.round(O*1e3/F):void 0}}function zye(e,t){let r=0,n=1e3/t,a,l;const f=(w,A=Date.now())=>{r=A,a=null,l&&(clearTimeout(l),l=null),e.apply(null,w)};return[(...w)=>{const A=Date.now(),E=A-r;E>=n?f(w,A):(a=w,l||(l=setTimeout(()=>{l=null,f(a)},n-E)))},()=>a&&f(a)]}const IA=(e,t,r=3)=>{let n=0;const a=Lye(50,250);return zye(l=>{const f=l.loaded,i=l.lengthComputable?l.total:void 0,_=f-n,w=a(_),A=f<=i;n=f;const E={loaded:f,total:i,progress:i?f/i:void 0,bytes:_,rate:w||void 0,estimated:w&&i&&A?(i-f)/w:void 0,event:l,lengthComputable:i!=null,[t?"download":"upload"]:!0};e(E)},r)},t6=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},r6=e=>(...t)=>ir.asap(()=>e(...t)),Fye=Fl.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Fl.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Fl.origin),Fl.navigator&&/(msie|trident)/i.test(Fl.navigator.userAgent)):()=>!0,Bye=Fl.hasStandardBrowserEnv?{write(e,t,r,n,a,l){const f=[e+"="+encodeURIComponent(t)];ir.isNumber(r)&&f.push("expires="+new Date(r).toGMTString()),ir.isString(n)&&f.push("path="+n),ir.isString(a)&&f.push("domain="+a),l===!0&&f.push("secure"),document.cookie=f.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Vye(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Uye(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function fZ(e,t,r){let n=!Vye(t);return e&&n||r==!1?Uye(e,t):t}const n6=e=>e instanceof Dc?{...e}:e;function Dv(e,t){t=t||{};const r={};function n(w,A,E,O){return ir.isPlainObject(w)&&ir.isPlainObject(A)?ir.merge.call({caseless:O},w,A):ir.isPlainObject(A)?ir.merge({},A):ir.isArray(A)?A.slice():A}function a(w,A,E,O){if(ir.isUndefined(A)){if(!ir.isUndefined(w))return n(void 0,w,E,O)}else return n(w,A,E,O)}function l(w,A){if(!ir.isUndefined(A))return n(void 0,A)}function f(w,A){if(ir.isUndefined(A)){if(!ir.isUndefined(w))return n(void 0,w)}else return n(void 0,A)}function i(w,A,E){if(E in t)return n(w,A);if(E in e)return n(void 0,w)}const _={url:l,method:l,data:l,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:i,headers:(w,A,E)=>a(n6(w),n6(A),E,!0)};return ir.forEach(Object.keys(Object.assign({},e,t)),function(A){const E=_[A]||a,O=E(e[A],t[A],A);ir.isUndefined(O)&&E!==i||(r[A]=O)}),r}const pZ=e=>{const t=Dv({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:l,headers:f,auth:i}=t;t.headers=f=Dc.from(f),t.url=lZ(fZ(t.baseURL,t.url),e.params,e.paramsSerializer),i&&f.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):"")));let _;if(ir.isFormData(r)){if(Fl.hasStandardBrowserEnv||Fl.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if((_=f.getContentType())!==!1){const[w,...A]=_?_.split(";").map(E=>E.trim()).filter(Boolean):[];f.setContentType([w||"multipart/form-data",...A].join("; "))}}if(Fl.hasStandardBrowserEnv&&(n&&ir.isFunction(n)&&(n=n(t)),n||n!==!1&&Fye(t.url))){const w=a&&l&&Bye.read(l);w&&f.set(a,w)}return t},$ye=typeof XMLHttpRequest<"u",qye=$ye&&function(e){return new Promise(function(r,n){const a=pZ(e);let l=a.data;const f=Dc.from(a.headers).normalize();let{responseType:i,onUploadProgress:_,onDownloadProgress:w}=a,A,E,O,F,U;function B(){F&&F(),U&&U(),a.cancelToken&&a.cancelToken.unsubscribe(A),a.signal&&a.signal.removeEventListener("abort",A)}let q=new XMLHttpRequest;q.open(a.method.toUpperCase(),a.url,!0),q.timeout=a.timeout;function W(){if(!q)return;const ne=Dc.from("getAllResponseHeaders"in q&&q.getAllResponseHeaders()),ee={data:!i||i==="text"||i==="json"?q.responseText:q.response,status:q.status,statusText:q.statusText,headers:ne,config:e,request:q};hZ(function(ce){r(ce),B()},function(ce){n(ce),B()},ee),q=null}"onloadend"in q?q.onloadend=W:q.onreadystatechange=function(){!q||q.readyState!==4||q.status===0&&!(q.responseURL&&q.responseURL.indexOf("file:")===0)||setTimeout(W)},q.onabort=function(){q&&(n(new Si("Request aborted",Si.ECONNABORTED,e,q)),q=null)},q.onerror=function(){n(new Si("Network Error",Si.ERR_NETWORK,e,q)),q=null},q.ontimeout=function(){let ae=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const ee=a.transitional||cZ;a.timeoutErrorMessage&&(ae=a.timeoutErrorMessage),n(new Si(ae,ee.clarifyTimeoutError?Si.ETIMEDOUT:Si.ECONNABORTED,e,q)),q=null},l===void 0&&f.setContentType(null),"setRequestHeader"in q&&ir.forEach(f.toJSON(),function(ae,ee){q.setRequestHeader(ee,ae)}),ir.isUndefined(a.withCredentials)||(q.withCredentials=!!a.withCredentials),i&&i!=="json"&&(q.responseType=a.responseType),w&&([O,U]=IA(w,!0),q.addEventListener("progress",O)),_&&q.upload&&([E,F]=IA(_),q.upload.addEventListener("progress",E),q.upload.addEventListener("loadend",F)),(a.cancelToken||a.signal)&&(A=ne=>{q&&(n(!ne||ne.type?new __(null,e,q):ne),q.abort(),q=null)},a.cancelToken&&a.cancelToken.subscribe(A),a.signal&&(a.signal.aborted?A():a.signal.addEventListener("abort",A)));const Z=Dye(a.url);if(Z&&Fl.protocols.indexOf(Z)===-1){n(new Si("Unsupported protocol "+Z+":",Si.ERR_BAD_REQUEST,e));return}q.send(l||null)})},Gye=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const l=function(w){if(!a){a=!0,i();const A=w instanceof Error?w:this.reason;n.abort(A instanceof Si?A:new __(A instanceof Error?A.message:A))}};let f=t&&setTimeout(()=>{f=null,l(new Si(`timeout ${t} of ms exceeded`,Si.ETIMEDOUT))},t);const i=()=>{e&&(f&&clearTimeout(f),f=null,e.forEach(w=>{w.unsubscribe?w.unsubscribe(l):w.removeEventListener("abort",l)}),e=null)};e.forEach(w=>w.addEventListener("abort",l));const{signal:_}=n;return _.unsubscribe=()=>ir.asap(i),_}},Wye=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},Hye=async function*(e,t){for await(const r of Kye(e))yield*Wye(r,t)},Kye=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},i6=(e,t,r,n)=>{const a=Hye(e,t);let l=0,f,i=_=>{f||(f=!0,n&&n(_))};return new ReadableStream({async pull(_){try{const{done:w,value:A}=await a.next();if(w){i(),_.close();return}let E=A.byteLength;if(r){let O=l+=E;r(O)}_.enqueue(new Uint8Array(A))}catch(w){throw i(w),w}},cancel(_){return i(_),a.return()}},{highWaterMark:2})},wP=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",mZ=wP&&typeof ReadableStream=="function",Zye=wP&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),gZ=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Yye=mZ&&gZ(()=>{let e=!1;const t=new Request(Fl.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),a6=64*1024,rR=mZ&&gZ(()=>ir.isReadableStream(new Response("").body)),DA={stream:rR&&(e=>e.body)};wP&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!DA[t]&&(DA[t]=ir.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Si(`Response type '${t}' is not supported`,Si.ERR_NOT_SUPPORT,n)})})})(new Response);const Xye=async e=>{if(e==null)return 0;if(ir.isBlob(e))return e.size;if(ir.isSpecCompliantForm(e))return(await new Request(Fl.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ir.isArrayBufferView(e)||ir.isArrayBuffer(e))return e.byteLength;if(ir.isURLSearchParams(e)&&(e=e+""),ir.isString(e))return(await Zye(e)).byteLength},Jye=async(e,t)=>{const r=ir.toFiniteNumber(e.getContentLength());return r??Xye(t)},Qye=wP&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:l,timeout:f,onDownloadProgress:i,onUploadProgress:_,responseType:w,headers:A,withCredentials:E="same-origin",fetchOptions:O}=pZ(e);w=w?(w+"").toLowerCase():"text";let F=Gye([a,l&&l.toAbortSignal()],f),U;const B=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let q;try{if(_&&Yye&&r!=="get"&&r!=="head"&&(q=await Jye(A,n))!==0){let ee=new Request(t,{method:"POST",body:n,duplex:"half"}),se;if(ir.isFormData(n)&&(se=ee.headers.get("content-type"))&&A.setContentType(se),ee.body){const[ce,ge]=t6(q,IA(r6(_)));n=i6(ee.body,a6,ce,ge)}}ir.isString(E)||(E=E?"include":"omit");const W="credentials"in Request.prototype;U=new Request(t,{...O,signal:F,method:r.toUpperCase(),headers:A.normalize().toJSON(),body:n,duplex:"half",credentials:W?E:void 0});let Z=await fetch(U);const ne=rR&&(w==="stream"||w==="response");if(rR&&(i||ne&&B)){const ee={};["status","statusText","headers"].forEach(Te=>{ee[Te]=Z[Te]});const se=ir.toFiniteNumber(Z.headers.get("content-length")),[ce,ge]=i&&t6(se,IA(r6(i),!0))||[];Z=new Response(i6(Z.body,a6,ce,()=>{ge&&ge(),B&&B()}),ee)}w=w||"text";let ae=await DA[ir.findKey(DA,w)||"text"](Z,e);return!ne&&B&&B(),await new Promise((ee,se)=>{hZ(ee,se,{data:ae,headers:Dc.from(Z.headers),status:Z.status,statusText:Z.statusText,config:e,request:U})})}catch(W){throw B&&B(),W&&W.name==="TypeError"&&/fetch/i.test(W.message)?Object.assign(new Si("Network Error",Si.ERR_NETWORK,e,U),{cause:W.cause||W}):Si.from(W,W&&W.code,e,U)}}),nR={http:pye,xhr:qye,fetch:Qye};ir.forEach(nR,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const s6=e=>`- ${e}`,eve=e=>ir.isFunction(e)||e===null||e===!1,yZ={getAdapter:e=>{e=ir.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let l=0;l<t;l++){r=e[l];let f;if(n=r,!eve(r)&&(n=nR[(f=String(r)).toLowerCase()],n===void 0))throw new Si(`Unknown adapter '${f}'`);if(n)break;a[f||"#"+l]=n}if(!n){const l=Object.entries(a).map(([i,_])=>`adapter ${i} `+(_===!1?"is not supported by the environment":"is not available in the build"));let f=t?l.length>1?`since :
`+l.map(s6).join(`
`):" "+s6(l[0]):"as no adapter specified";throw new Si("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return n},adapters:nR};function tk(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new __(null,e)}function o6(e){return tk(e),e.headers=Dc.from(e.headers),e.data=ek.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),yZ.getAdapter(e.adapter||qw.adapter)(e).then(function(n){return tk(e),n.data=ek.call(e,e.transformResponse,n),n.headers=Dc.from(n.headers),n},function(n){return dZ(n)||(tk(e),n&&n.response&&(n.response.data=ek.call(e,e.transformResponse,n.response),n.response.headers=Dc.from(n.response.headers))),Promise.reject(n)})}const vZ="1.8.2",SP={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{SP[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const l6={};SP.transitional=function(t,r,n){function a(l,f){return"[Axios v"+vZ+"] Transitional option '"+l+"'"+f+(n?". "+n:"")}return(l,f,i)=>{if(t===!1)throw new Si(a(f," has been removed"+(r?" in "+r:"")),Si.ERR_DEPRECATED);return r&&!l6[f]&&(l6[f]=!0,console.warn(a(f," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,f,i):!0}};SP.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function tve(e,t,r){if(typeof e!="object")throw new Si("options must be an object",Si.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const l=n[a],f=t[l];if(f){const i=e[l],_=i===void 0||f(i,l,e);if(_!==!0)throw new Si("option "+l+" must be "+_,Si.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Si("Unknown option "+l,Si.ERR_BAD_OPTION)}}const sA={assertOptions:tve,validators:SP},kf=sA.validators;let Pv=class{constructor(t){this.defaults=t,this.interceptors={request:new QB,response:new QB}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Dv(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:l}=r;n!==void 0&&sA.assertOptions(n,{silentJSONParsing:kf.transitional(kf.boolean),forcedJSONParsing:kf.transitional(kf.boolean),clarifyTimeoutError:kf.transitional(kf.boolean)},!1),a!=null&&(ir.isFunction(a)?r.paramsSerializer={serialize:a}:sA.assertOptions(a,{encode:kf.function,serialize:kf.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),sA.assertOptions(r,{baseUrl:kf.spelling("baseURL"),withXsrfToken:kf.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let f=l&&ir.merge(l.common,l[r.method]);l&&ir.forEach(["delete","get","head","post","put","patch","common"],U=>{delete l[U]}),r.headers=Dc.concat(f,l);const i=[];let _=!0;this.interceptors.request.forEach(function(B){typeof B.runWhen=="function"&&B.runWhen(r)===!1||(_=_&&B.synchronous,i.unshift(B.fulfilled,B.rejected))});const w=[];this.interceptors.response.forEach(function(B){w.push(B.fulfilled,B.rejected)});let A,E=0,O;if(!_){const U=[o6.bind(this),void 0];for(U.unshift.apply(U,i),U.push.apply(U,w),O=U.length,A=Promise.resolve(r);E<O;)A=A.then(U[E++],U[E++]);return A}O=i.length;let F=r;for(E=0;E<O;){const U=i[E++],B=i[E++];try{F=U(F)}catch(q){B.call(this,q);break}}try{A=o6.call(this,F)}catch(U){return Promise.reject(U)}for(E=0,O=w.length;E<O;)A=A.then(w[E++],w[E++]);return A}getUri(t){t=Dv(this.defaults,t);const r=fZ(t.baseURL,t.url,t.allowAbsoluteUrls);return lZ(r,t.params,t.paramsSerializer)}};ir.forEach(["delete","get","head","options"],function(t){Pv.prototype[t]=function(r,n){return this.request(Dv(n||{},{method:t,url:r,data:(n||{}).data}))}});ir.forEach(["post","put","patch"],function(t){function r(n){return function(l,f,i){return this.request(Dv(i||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:f}))}}Pv.prototype[t]=r(),Pv.prototype[t+"Form"]=r(!0)});let rve=class xZ{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(a=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](a);n._listeners=null}),this.promise.then=a=>{let l;const f=new Promise(i=>{n.subscribe(i),l=i}).then(a);return f.cancel=function(){n.unsubscribe(l)},f},t(function(l,f,i){n.reason||(n.reason=new __(l,f,i),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new xZ(function(a){t=a}),cancel:t}}};function nve(e){return function(r){return e.apply(null,r)}}function ive(e){return ir.isObject(e)&&e.isAxiosError===!0}const iR={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(iR).forEach(([e,t])=>{iR[t]=e});function _Z(e){const t=new Pv(e),r=XK(Pv.prototype.request,t);return ir.extend(r,Pv.prototype,t,{allOwnKeys:!0}),ir.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return _Z(Dv(e,a))},r}const ro=_Z(qw);ro.Axios=Pv;ro.CanceledError=__;ro.CancelToken=rve;ro.isCancel=dZ;ro.VERSION=vZ;ro.toFormData=bP;ro.AxiosError=Si;ro.Cancel=ro.CanceledError;ro.all=function(t){return Promise.all(t)};ro.spread=nve;ro.isAxiosError=ive;ro.mergeConfig=Dv;ro.AxiosHeaders=Dc;ro.formToJSON=e=>uZ(ir.isHTMLForm(e)?new FormData(e):e);ro.getAdapter=yZ.getAdapter;ro.HttpStatusCode=iR;ro.default=ro;const{Axios:DVe,AxiosError:LVe,CanceledError:zVe,isCancel:FVe,CancelToken:BVe,VERSION:VVe,all:UVe,Cancel:$Ve,isAxiosError:qVe,spread:GVe,toFormData:WVe,AxiosHeaders:HVe,HttpStatusCode:KVe,formToJSON:ZVe,getAdapter:YVe,mergeConfig:XVe}=ro,ave="https://ltodatamanager.com/api",Wn=ro.create({baseURL:ave});Wn.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e));Wn.interceptors.response.use(e=>e,e=>{var t,r,n;return((t=e.response)==null?void 0:t.status)===401&&((n=(r=e.config)==null?void 0:r.url)!=null&&n.includes("/auth/login")||(localStorage.removeItem("token"),localStorage.removeItem("userData"))),Promise.reject(e)});class Zb extends Error{}Zb.prototype.name="InvalidTokenError";function sve(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function ove(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return sve(t)}catch{return atob(t)}}function CS(e,t){if(typeof e!="string")throw new Zb("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new Zb(`Invalid token specified: missing part #${r+1}`);let a;try{a=ove(n)}catch(l){throw new Zb(`Invalid token specified: invalid base64 for part #${r+1} (${l.message})`)}try{return JSON.parse(a)}catch(l){throw new Zb(`Invalid token specified: invalid json for part #${r+1} (${l.message})`)}}var lD="Dialog",[bZ,wZ]=kd(lD),[lve,qh]=bZ(lD),SZ=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:f=!0}=e,i=H.useRef(null),_=H.useRef(null),[w=!1,A]=Lg({prop:n,defaultProp:a,onChange:l});return u.jsx(lve,{scope:t,triggerRef:i,contentRef:_,contentId:Sd(),titleId:Sd(),descriptionId:Sd(),open:w,onOpenChange:A,onOpenToggle:H.useCallback(()=>A(E=>!E),[A]),modal:f,children:r})};SZ.displayName=lD;var AZ="DialogTrigger",TZ=H.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=qh(AZ,r),l=Xi(t,a.triggerRef);return u.jsx(gi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":dD(a.open),...n,ref:l,onClick:on(e.onClick,a.onOpenToggle)})});TZ.displayName=AZ;var cD="DialogPortal",[cve,PZ]=bZ(cD,{forceMount:void 0}),CZ=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,l=qh(cD,t);return u.jsx(cve,{scope:t,forceMount:r,children:H.Children.map(n,f=>u.jsx(ku,{present:r||l.open,children:u.jsx(v_,{asChild:!0,container:a,children:f})}))})};CZ.displayName=cD;var LA="DialogOverlay",EZ=H.forwardRef((e,t)=>{const r=PZ(LA,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=qh(LA,e.__scopeDialog);return l.modal?u.jsx(ku,{present:n||l.open,children:u.jsx(uve,{...a,ref:t})}):null});EZ.displayName=LA;var uve=H.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=qh(LA,r);return u.jsx(zw,{as:Ul,allowPinchZoom:!0,shards:[a.contentRef],children:u.jsx(gi.div,{"data-state":dD(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Lv="DialogContent",kZ=H.forwardRef((e,t)=>{const r=PZ(Lv,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=qh(Lv,e.__scopeDialog);return u.jsx(ku,{present:n||l.open,children:l.modal?u.jsx(dve,{...a,ref:t}):u.jsx(hve,{...a,ref:t})})});kZ.displayName=Lv;var dve=H.forwardRef((e,t)=>{const r=qh(Lv,e.__scopeDialog),n=H.useRef(null),a=Xi(t,r.contentRef,n);return H.useEffect(()=>{const l=n.current;if(l)return uP(l)},[]),u.jsx(MZ,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:on(e.onCloseAutoFocus,l=>{var f;l.preventDefault(),(f=r.triggerRef.current)==null||f.focus()}),onPointerDownOutside:on(e.onPointerDownOutside,l=>{const f=l.detail.originalEvent,i=f.button===0&&f.ctrlKey===!0;(f.button===2||i)&&l.preventDefault()}),onFocusOutside:on(e.onFocusOutside,l=>l.preventDefault())})}),hve=H.forwardRef((e,t)=>{const r=qh(Lv,e.__scopeDialog),n=H.useRef(!1),a=H.useRef(!1);return u.jsx(MZ,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,w;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=l.target;((w=r.triggerRef.current)==null?void 0:w.contains(f))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),MZ=H.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...f}=e,i=qh(Lv,r),_=H.useRef(null),w=Xi(t,_);return rP(),u.jsxs(u.Fragment,{children:[u.jsx(Iw,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:u.jsx(m_,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":dD(i.open),...f,ref:w,onDismiss:()=>i.onOpenChange(!1)})}),u.jsxs(u.Fragment,{children:[u.jsx(pve,{titleId:i.titleId}),u.jsx(gve,{contentRef:_,descriptionId:i.descriptionId})]})]})}),uD="DialogTitle",jZ=H.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=qh(uD,r);return u.jsx(gi.h2,{id:a.titleId,...n,ref:t})});jZ.displayName=uD;var OZ="DialogDescription",NZ=H.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=qh(OZ,r);return u.jsx(gi.p,{id:a.descriptionId,...n,ref:t})});NZ.displayName=OZ;var RZ="DialogClose",IZ=H.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=qh(RZ,r);return u.jsx(gi.button,{type:"button",...n,ref:t,onClick:on(e.onClick,()=>a.onOpenChange(!1))})});IZ.displayName=RZ;function dD(e){return e?"open":"closed"}var DZ="DialogTitleWarning",[fve,LZ]=nde(DZ,{contentName:Lv,titleName:uD,docsSlug:"dialog"}),pve=({titleId:e})=>{const t=LZ(DZ),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return H.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},mve="DialogDescriptionWarning",gve=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${LZ(mve).contentName}}.`;return H.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},hD=SZ,yve=TZ,fD=CZ,Gw=EZ,Ww=kZ,Hw=jZ,Kw=NZ,AP=IZ;const Zf=hD,vve=fD,zZ=H.forwardRef(({className:e,...t},r)=>u.jsx(Gw,{ref:r,className:Wt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));zZ.displayName=Gw.displayName;const Dh=H.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(vve,{children:[u.jsx(zZ,{}),u.jsxs(Ww,{ref:n,className:Wt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,u.jsxs(AP,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[u.jsx(b1,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Dh.displayName=Ww.displayName;const Lh=({className:e,...t})=>u.jsx("div",{className:Wt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Lh.displayName="DialogHeader";const Gg=({className:e,...t})=>u.jsx("div",{className:Wt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Gg.displayName="DialogFooter";const zh=H.forwardRef(({className:e,...t},r)=>u.jsx(Hw,{ref:r,className:Wt("text-lg font-semibold leading-none tracking-tight",e),...t}));zh.displayName=Hw.displayName;const pm=H.forwardRef(({className:e,...t},r)=>u.jsx(Kw,{ref:r,className:Wt("text-sm text-muted-foreground",e),...t}));pm.displayName=Kw.displayName;const xve=({isOpen:e,onClose:t,onSuccess:r,userEmail:n})=>{const[a,l]=H.useState(""),[f,i]=H.useState(!1),[_,w]=H.useState(300),[A,E]=H.useState(!1);H.useEffect(()=>{if(_>0&&e){const B=setTimeout(()=>w(_-1),1e3);return()=>clearTimeout(B)}else _===0&&E(!0)},[_,e]),H.useEffect(()=>{e&&(w(300),E(!1),l(""))},[e]);const O=async B=>{var q,W;if(B.preventDefault(),!a||a.length!==6){ki.error("Please enter a valid 6-digit OTP");return}i(!0);try{const Z=await Wn.post("/auth/verify-otp",{email:n,otp:a});Z.data.success?(ki.success("OTP verified successfully!"),r(Z.data.token)):ki.error(Z.data.message||"OTP verification failed")}catch(Z){const ne=((W=(q=Z.response)==null?void 0:q.data)==null?void 0:W.message)||"OTP verification failed";ki.error(ne)}finally{i(!1)}},F=async()=>{i(!0);try{ki.info("Please login again to receive a new OTP"),t()}catch{ki.error("Failed to resend OTP")}finally{i(!1)}},U=B=>{const q=Math.floor(B/60),W=B%60;return`${q}:${W.toString().padStart(2,"0")}`};return u.jsx(Zf,{open:e,onOpenChange:t,children:u.jsxs(Dh,{className:"sm:max-w-md",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(RW,{className:"h-5 w-5 text-blue-600"}),"OTP Verification Required"]}),u.jsx(pm,{children:"Please enter the 6-digit OTP sent to your email address to complete the login process."})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg",children:[u.jsx(O3,{className:"h-4 w-4 text-blue-600"}),u.jsxs("span",{className:"text-sm text-blue-800",children:["OTP sent to: ",u.jsx("strong",{children:n})]})]}),u.jsxs("form",{onSubmit:O,className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(os,{htmlFor:"otp",children:"Enter OTP"}),u.jsx(Vn,{id:"otp",type:"text",placeholder:"000000",value:a,onChange:B=>l(B.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest",disabled:f})]}),u.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[u.jsxs("span",{children:["Time remaining: ",U(_)]}),A&&u.jsx(Xr,{type:"button",variant:"link",size:"sm",onClick:F,disabled:f,className:"p-0 h-auto",children:"Resend OTP"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:t,disabled:f,className:"flex-1",children:"Cancel"}),u.jsx(Xr,{type:"submit",disabled:f||a.length!==6,className:"flex-1",children:f?u.jsxs(u.Fragment,{children:[u.jsx(Lf,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify OTP"})]})]})]})]})})},FZ=H.createContext(),_ve=({children:e})=>{const[t,r]=H.useState(null),[n,a]=H.useState(null),[l,f]=H.useState(!1),[i,_]=H.useState(!0),[w,A]=H.useState(!1),E=Na(),O=H.useRef(!1),F=ae=>ae.exp*1e3<Date.now();H.useEffect(()=>{(()=>{try{const ee=localStorage.getItem("token"),se=localStorage.getItem("userData"),ce=se?JSON.parse(se):null;if(ee)try{const ge=CS(ee);F(ge)?(localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1)):(r(ee),a(ce),f(!0))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1)}else r(null),a(null),f(!1)}catch(ee){console.error("Auth initialization error:",ee),r(null),a(null),f(!1)}finally{_(!1)}})()},[]);const U=ae=>{const ee=CS(ae);if(F(ee)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1);return}const se={userId:ee.userId,role:ee.role,email:ee.email,isPasswordChange:ee.isPasswordChange,isOtpVerified:ee.isOtpVerified};localStorage.setItem("token",ae),localStorage.setItem("userData",JSON.stringify(se)),r(ae),a(se),f(!0)},B=ae=>{const ee=CS(ae);if(F(ee)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1);return}const se={userId:ee.userId,role:ee.role,email:ee.email,isPasswordChange:ee.isPasswordChange,isOtpVerified:ee.isOtpVerified};localStorage.setItem("token",ae),localStorage.setItem("userData",JSON.stringify(se)),r(ae),a(se),f(!0)};H.useEffect(()=>{l&&(n!=null&&n.role)&&n.role!=="0"&&n.isOtpVerified===!1?A(!0):A(!1)},[l,n]);const q=ae=>{B(ae),setTimeout(()=>{O.current||(O.current=!0,E("/"),setTimeout(()=>{O.current=!1},100))},100)},W=()=>{A(!1),Z()},Z=async()=>{try{await Wn.post("/auth/logout")}catch(ae){console.error("Logout API call failed:",ae)}finally{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1),O.current||(O.current=!0,E("/login"),setTimeout(()=>{O.current=!1},100))}};if(H.useEffect(()=>{if(l&&t)try{const ee=CS(t).exp*1e3-Date.now();if(ee>0){const se=setTimeout(()=>{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1),O.current||(O.current=!0,E("/login"),setTimeout(()=>{O.current=!1},100))},ee);return()=>clearTimeout(se)}else localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1),O.current||(O.current=!0,E("/login"),setTimeout(()=>{O.current=!1},100))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1)}},[t]),i)return u.jsx("div",{className:"h-screen flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const ne={token:t,isAuthenticated:l,login:U,logout:Z,updateToken:B,userData:n,setUserData:a};return u.jsxs(FZ.Provider,{value:ne,children:[e,u.jsx(xve,{isOpen:w,onClose:W,onSuccess:q,userEmail:n==null?void 0:n.email})]})},la=()=>{const e=H.useContext(FZ);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};function bve({className:e,...t}){const[r,n]=H.useState(!1),[a,l]=H.useState(!1),[f,i]=H.useState(null),{login:_,isAuthenticated:w}=la(),A=Na(),E=()=>{n(!r)},O=Uh({resolver:np(_ge),defaultValues:{email:"",password:""}}),F=async U=>{var B,q;try{l(!0),i(null);const{data:W}=await Wn.post("/auth/login",U);if(W){if(l(!1),W.requiresOTP){ki.success(`OTP has been sent to ${W.email}. Please check your email.`),W.token&&_(W.token);return}W.token&&(_(W.token),A("/"))}}catch(W){console.error("Login error:",W),O.clearErrors(),(((q=(B=W.response)==null?void 0:B.data)==null?void 0:q.message)==="Password is incorrect"?"0":"1")==="0"?O.setError("password",{type:"manual",message:"Password is incorrect"}):O.setError("email",{type:"manual",message:"Email or license number is incorrect"}),l(!1)}};return u.jsx("div",{className:Wt("flex flex-col gap-6",e),...t,children:u.jsx(Zv,{...O,children:u.jsx("form",{onSubmit:U=>{U.preventDefault(),O.handleSubmit(F)(U)},children:u.jsxs("div",{className:"flex flex-col gap-6",children:[u.jsxs("div",{className:"flex flex-col  gap-2",children:[u.jsx("div",{className:"flex flex-col items-center gap-2 font-medium",children:u.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md",children:u.jsx(hue,{className:"size-6"})})}),u.jsx("h1",{className:"text-xl font-bold",children:"Login"}),u.jsxs("div",{className:"text-start text-sm",children:["Fill in the form to get started."," "]})]}),u.jsxs("div",{className:"flex flex-col gap-6",children:[u.jsx(Bn,{control:O.control,name:"email",render:({field:U})=>u.jsx(Dn,{children:u.jsxs("div",{className:"grid gap-2",children:[u.jsx(Ln,{children:"Email"}),u.jsx(On,{children:u.jsx(Vn,{...U,type:"text",placeholder:"m@example.com",autoComplete:"current-email",className:Wt("border border-input focus:ring-0",O.formState.errors.email&&"border-red-500")})}),u.jsx(zn,{})]})})}),u.jsx(Bn,{control:O.control,name:"password",render:({field:U})=>u.jsx(Dn,{children:u.jsxs("div",{className:"grid gap-2",children:[u.jsx(Ln,{children:"Password"}),u.jsx(On,{children:u.jsxs("div",{className:"relative w-full ",children:[u.jsx(Vn,{...U,type:r?"text":"password",autoComplete:"current-password",className:Wt("border border-input focus:ring-0",O.formState.errors.password&&"border-red-500")}),u.jsx(Xr,{type:"button",size:"icon",variant:"ghost",className:"absolute right-0 top-0 h-full w-min px-3 py-2 hover:bg-transparent",onClick:E,"aria-label":r?"Hide Password":"Show Password",children:r?u.jsx(lue,{className:"text-gray-500 size-4"}):u.jsx(jW,{className:"text-gray-500 size-4"})})]})}),u.jsx(zn,{})]})})}),u.jsx(Xr,{type:"submit",disabled:a,id:"submit",className:"w-full",children:a?u.jsx(Lf,{className:"w-6 h-6 text-primary-foreground mx-auto animate-spin"}):"Login"})]}),u.jsx("div",{className:"relative text-end text-sm ",children:u.jsx("button",{type:"button",className:"relative z-10 bg-background px-2 text-muted-foreground hover:text-foreground transition-colors",children:"Forgot your password?"})})]})},"login-form")})})}const wve=()=>u.jsx("div",{className:"flex min-h-svh flex-col items-center justify-center gap-6 bg-background p-6 md:p-10",children:u.jsx("div",{className:"w-full max-w-sm",children:u.jsx(bve,{})})}),BZ=H.createContext({});function Sve(e){const t=H.useRef(null);return t.current===null&&(t.current=e()),t.current}const pD=typeof window<"u",Ave=pD?H.useLayoutEffect:H.useEffect,mD=H.createContext(null),VZ=H.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Tve(e=!0){const t=H.useContext(mD);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:a}=t,l=H.useId();H.useEffect(()=>{if(e)return a(l)},[e]);const f=H.useCallback(()=>e&&n&&n(l),[l,n,e]);return!r&&n?[!1,f]:[!0]}function gD(e,t){e.indexOf(t)===-1&&e.push(t)}function yD(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const bu=e=>e;let UZ=bu;const Pve={useManualTiming:!1};function vD(e){let t;return()=>(t===void 0&&(t=e()),t)}const Cx=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class xD{constructor(){this.subscriptions=[]}add(t){return gD(this.subscriptions,t),()=>yD(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let l=0;l<a;l++){const f=this.subscriptions[l];f&&f(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const sm=e=>e*1e3,om=e=>e/1e3;function $Z(e,t){return t?e*(1e3/t):0}const Cve=vD(()=>window.ScrollTimeline!==void 0);class Eve{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=r}attachTimeline(t,r){const n=this.animations.map(a=>{if(Cve()&&a.attachTimeline)return a.attachTimeline(t);if(typeof r=="function")return r(a)});return()=>{n.forEach((a,l)=>{a&&a(),this.animations[l].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class kve extends Eve{then(t,r){return Promise.all(this.animations).then(t).catch(r)}}function _D(e,t){return e?e[t]||e.default||e:void 0}const aR=2e4;function qZ(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<aR;)t+=r,n=e.next(t);return t>=aR?1/0:t}function bD(e){return typeof e=="function"}function c6(e,t){e.timeline=t,e.onfinish=null}const wD=e=>Array.isArray(e)&&typeof e[0]=="number",Mve={linearEasing:void 0};function jve(e,t){const r=vD(e);return()=>{var n;return(n=Mve[t])!==null&&n!==void 0?n:r()}}const zA=jve(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),GZ=(e,t,r=10)=>{let n="";const a=Math.max(Math.round(t/r),2);for(let l=0;l<a;l++)n+=e(Cx(0,a-1,l))+", ";return`linear(${n.substring(0,n.length-2)})`};function WZ(e){return!!(typeof e=="function"&&zA()||!e||typeof e=="string"&&(e in sR||zA())||wD(e)||Array.isArray(e)&&e.every(WZ))}const Yb=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,sR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Yb([0,.65,.55,1]),circOut:Yb([.55,0,1,.45]),backIn:Yb([.31,.01,.66,-.59]),backOut:Yb([.33,1.53,.69,.99])};function HZ(e,t){if(e)return typeof e=="function"&&zA()?GZ(e,t):wD(e)?Yb(e):Array.isArray(e)?e.map(r=>HZ(r,t)||sR.easeOut):sR[e]}const ES=["read","resolveKeyframes","update","preRender","render","postRender"],u6={value:null};function Ove(e,t){let r=new Set,n=new Set,a=!1,l=!1;const f=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1},_=0;function w(E){f.has(E)&&(A.schedule(E),e()),_++,E(i)}const A={schedule:(E,O=!1,F=!1)=>{const B=F&&a?r:n;return O&&f.add(E),B.has(E)||B.add(E),E},cancel:E=>{n.delete(E),f.delete(E)},process:E=>{if(i=E,a){l=!0;return}a=!0,[r,n]=[n,r],r.forEach(w),t&&u6.value&&u6.value.frameloop[t].push(_),_=0,r.clear(),a=!1,l&&(l=!1,A.process(E))}};return A}const Nve=40;function KZ(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},l=()=>r=!0,f=ES.reduce((W,Z)=>(W[Z]=Ove(l,t?Z:void 0),W),{}),{read:i,resolveKeyframes:_,update:w,preRender:A,render:E,postRender:O}=f,F=()=>{const W=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(W-a.timestamp,Nve),1),a.timestamp=W,a.isProcessing=!0,i.process(a),_.process(a),w.process(a),A.process(a),E.process(a),O.process(a),a.isProcessing=!1,r&&t&&(n=!1,e(F))},U=()=>{r=!0,n=!0,a.isProcessing||e(F)};return{schedule:ES.reduce((W,Z)=>{const ne=f[Z];return W[Z]=(ae,ee=!1,se=!1)=>(r||U(),ne.schedule(ae,ee,se)),W},{}),cancel:W=>{for(let Z=0;Z<ES.length;Z++)f[ES[Z]].cancel(W)},state:a,steps:f}}const{schedule:Xa,cancel:Wg,state:xl,steps:rk}=KZ(typeof requestAnimationFrame<"u"?requestAnimationFrame:bu,!0),{schedule:SD}=KZ(queueMicrotask,!1);let oA;function Rve(){oA=void 0}const Bf={now:()=>(oA===void 0&&Bf.set(xl.isProcessing||Pve.useManualTiming?xl.timestamp:performance.now()),oA),set:e=>{oA=e,queueMicrotask(Rve)}},bh={x:!1,y:!1};function ZZ(){return bh.x||bh.y}function Ive(e){return e==="x"||e==="y"?bh[e]?null:(bh[e]=!0,()=>{bh[e]=!1}):bh.x||bh.y?null:(bh.x=bh.y=!0,()=>{bh.x=bh.y=!1})}function Dve(e,t,r){var n;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const l=(n=void 0)!==null&&n!==void 0?n:a.querySelectorAll(e);return l?Array.from(l):[]}return Array.from(e)}function YZ(e,t){const r=Dve(e),n=new AbortController,a={passive:!0,...t,signal:n.signal};return[r,a,()=>n.abort()]}function d6(e){return!(e.pointerType==="touch"||ZZ())}function Lve(e,t,r={}){const[n,a,l]=YZ(e,r),f=i=>{if(!d6(i))return;const{target:_}=i,w=t(_,i);if(typeof w!="function"||!_)return;const A=E=>{d6(E)&&(w(E),_.removeEventListener("pointerleave",A))};_.addEventListener("pointerleave",A,a)};return n.forEach(i=>{i.addEventListener("pointerenter",f,a)}),l}function h6(e,t){const r=`${t}PointerCapture`;if(e.target instanceof Element&&r in e.target&&e.pointerId!==void 0)try{e.target[r](e.pointerId)}catch{}}const XZ=(e,t)=>t?e===t?!0:XZ(e,t.parentElement):!1,AD=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,zve=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Fve(e){return zve.has(e.tagName)||e.tabIndex!==-1}const Xb=new WeakSet;function f6(e){return t=>{t.key==="Enter"&&e(t)}}function nk(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Bve=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=f6(()=>{if(Xb.has(r))return;nk(r,"down");const a=f6(()=>{nk(r,"up")}),l=()=>nk(r,"cancel");r.addEventListener("keyup",a,t),r.addEventListener("blur",l,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function p6(e){return AD(e)&&!ZZ()}function Vve(e,t,r={}){const[n,a,l]=YZ(e,r),f=i=>{const _=i.currentTarget;if(!_||!p6(i)||Xb.has(_))return;Xb.add(_),h6(i,"set");const w=t(_,i),A=(F,U)=>{_.removeEventListener("pointerup",E),_.removeEventListener("pointercancel",O),h6(F,"release"),!(!p6(F)||!Xb.has(_))&&(Xb.delete(_),typeof w=="function"&&w(F,{success:U}))},E=F=>{(F.isTrusted?Uve(F,_ instanceof Element?_.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?A(F,!1):A(F,!(_ instanceof Element)||XZ(_,F.target))},O=F=>{A(F,!1)};_.addEventListener("pointerup",E,a),_.addEventListener("pointercancel",O,a),_.addEventListener("lostpointercapture",O,a)};return n.forEach(i=>{i=r.useGlobalTarget?window:i;let _=!1;i instanceof HTMLElement&&(_=!0,!Fve(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0)),i.addEventListener("pointerdown",f,a),_&&i.addEventListener("focus",w=>Bve(w,a),a)}),l}function Uve(e,t){return e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom}const m6=30,$ve=e=>!isNaN(parseFloat(e));class qve{constructor(t,r={}){this.version="12.5.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,a=!0)=>{const l=Bf.now();this.updatedAt!==l&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Bf.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=$ve(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new xD);const n=this.events[t].add(r);return t==="change"?()=>{n(),Xa.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Bf.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>m6)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,m6);return $Z(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function B1(e,t){return new qve(e,t)}const JZ=H.createContext({strict:!1}),g6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ex={};for(const e in g6)Ex[e]={isEnabled:t=>g6[e].some(r=>!!t[r])};function Gve(e){for(const t in e)Ex[t]={...Ex[t],...e[t]}}const Wve=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function FA(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Wve.has(e)}let QZ=e=>!FA(e);function Hve(e){e&&(QZ=t=>t.startsWith("on")?!FA(t):e(t))}try{Hve(require("@emotion/is-prop-valid").default)}catch{}function Kve(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(QZ(a)||r===!0&&FA(a)||!t&&!FA(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function Zve(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,a)=>a==="create"?e:(t.has(a)||t.set(a,e(a)),t.get(a))})}const TP=H.createContext({});function PP(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function V1(e){return typeof e=="string"||Array.isArray(e)}const TD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],PD=["initial",...TD];function CP(e){return PP(e.animate)||PD.some(t=>V1(e[t]))}function eY(e){return!!(CP(e)||e.variants)}function Yve(e,t){if(CP(e)){const{initial:r,animate:n}=e;return{initial:r===!1||V1(r)?r:void 0,animate:V1(n)?n:void 0}}return e.inherit!==!1?t:{}}function Xve(e){const{initial:t,animate:r}=Yve(e,H.useContext(TP));return H.useMemo(()=>({initial:t,animate:r}),[y6(t),y6(r)])}function y6(e){return Array.isArray(e)?e.join(" "):e}const Jve=Symbol.for("motionComponentSymbol");function nx(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Qve(e,t,r){return H.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):nx(r)&&(r.current=n))},[t])}const CD=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),e0e="framerAppearId",tY="data-"+CD(e0e),rY=H.createContext({});function t0e(e,t,r,n,a){var l,f;const{visualElement:i}=H.useContext(TP),_=H.useContext(JZ),w=H.useContext(mD),A=H.useContext(VZ).reducedMotion,E=H.useRef(null);n=n||_.renderer,!E.current&&n&&(E.current=n(e,{visualState:t,parent:i,props:r,presenceContext:w,blockInitialAnimation:w?w.initial===!1:!1,reducedMotionConfig:A}));const O=E.current,F=H.useContext(rY);O&&!O.projection&&a&&(O.type==="html"||O.type==="svg")&&r0e(E.current,r,a,F);const U=H.useRef(!1);H.useInsertionEffect(()=>{O&&U.current&&O.update(r,w)});const B=r[tY],q=H.useRef(!!B&&!(!((l=window.MotionHandoffIsComplete)===null||l===void 0)&&l.call(window,B))&&((f=window.MotionHasOptimisedAnimation)===null||f===void 0?void 0:f.call(window,B)));return Ave(()=>{O&&(U.current=!0,window.MotionIsMounted=!0,O.updateFeatures(),SD.render(O.render),q.current&&O.animationState&&O.animationState.animateChanges())}),H.useEffect(()=>{O&&(!q.current&&O.animationState&&O.animationState.animateChanges(),q.current&&(queueMicrotask(()=>{var W;(W=window.MotionHandoffMarkAsComplete)===null||W===void 0||W.call(window,B)}),q.current=!1))}),O}function r0e(e,t,r,n){const{layoutId:a,layout:l,drag:f,dragConstraints:i,layoutScroll:_,layoutRoot:w}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:nY(e.parent)),e.projection.setOptions({layoutId:a,layout:l,alwaysMeasureLayout:!!f||i&&nx(i),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:n,layoutScroll:_,layoutRoot:w})}function nY(e){if(e)return e.options.allowProjection!==!1?e.projection:nY(e.parent)}function n0e({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){var l,f;e&&Gve(e);function i(w,A){let E;const O={...H.useContext(VZ),...w,layoutId:i0e(w)},{isStatic:F}=O,U=Xve(w),B=n(w,F);if(!F&&pD){a0e();const q=s0e(O);E=q.MeasureLayout,U.visualElement=t0e(a,B,O,t,q.ProjectionNode)}return u.jsxs(TP.Provider,{value:U,children:[E&&U.visualElement?u.jsx(E,{visualElement:U.visualElement,...O}):null,r(a,w,Qve(B,U.visualElement,A),B,F,U.visualElement)]})}i.displayName=`motion.${typeof a=="string"?a:`create(${(f=(l=a.displayName)!==null&&l!==void 0?l:a.name)!==null&&f!==void 0?f:""})`}`;const _=H.forwardRef(i);return _[Jve]=a,_}function i0e({layoutId:e}){const t=H.useContext(BZ).id;return t&&e!==void 0?t+"-"+e:e}function a0e(e,t){H.useContext(JZ).strict}function s0e(e){const{drag:t,layout:r}=Ex;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const iY=e=>t=>typeof t=="string"&&t.startsWith(e),ED=iY("--"),o0e=iY("var(--"),kD=e=>o0e(e)?l0e.test(e.split("/*")[0].trim()):!1,l0e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,U1={};function c0e(e){for(const t in e)U1[t]=e[t],ED(t)&&(U1[t].isCSSVariable=!0)}const b_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Yv=new Set(b_);function aY(e,{layout:t,layoutId:r}){return Yv.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!U1[e]||e==="opacity")}const Bl=e=>!!(e&&e.getVelocity),sY=(e,t)=>t&&typeof e=="number"?t.transform(e):e,mm=(e,t,r)=>r>t?t:r<e?e:r,w_={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},$1={...w_,transform:e=>mm(0,1,e)},kS={...w_,default:1},Zw=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ag=Zw("deg"),Vf=Zw("%"),ri=Zw("px"),u0e=Zw("vh"),d0e=Zw("vw"),v6={...Vf,parse:e=>Vf.parse(e)/100,transform:e=>Vf.transform(e*100)},h0e={borderWidth:ri,borderTopWidth:ri,borderRightWidth:ri,borderBottomWidth:ri,borderLeftWidth:ri,borderRadius:ri,radius:ri,borderTopLeftRadius:ri,borderTopRightRadius:ri,borderBottomRightRadius:ri,borderBottomLeftRadius:ri,width:ri,maxWidth:ri,height:ri,maxHeight:ri,top:ri,right:ri,bottom:ri,left:ri,padding:ri,paddingTop:ri,paddingRight:ri,paddingBottom:ri,paddingLeft:ri,margin:ri,marginTop:ri,marginRight:ri,marginBottom:ri,marginLeft:ri,backgroundPositionX:ri,backgroundPositionY:ri},f0e={rotate:Ag,rotateX:Ag,rotateY:Ag,rotateZ:Ag,scale:kS,scaleX:kS,scaleY:kS,scaleZ:kS,skew:Ag,skewX:Ag,skewY:Ag,distance:ri,translateX:ri,translateY:ri,translateZ:ri,x:ri,y:ri,z:ri,perspective:ri,transformPerspective:ri,opacity:$1,originX:v6,originY:v6,originZ:ri},x6={...w_,transform:Math.round},MD={...h0e,...f0e,zIndex:x6,size:ri,fillOpacity:$1,strokeOpacity:$1,numOctaves:x6},p0e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},m0e=b_.length;function g0e(e,t,r){let n="",a=!0;for(let l=0;l<m0e;l++){const f=b_[l],i=e[f];if(i===void 0)continue;let _=!0;if(typeof i=="number"?_=i===(f.startsWith("scale")?1:0):_=parseFloat(i)===0,!_||r){const w=sY(i,MD[f]);if(!_){a=!1;const A=p0e[f]||f;n+=`${A}(${w}) `}r&&(t[f]=w)}}return n=n.trim(),r?n=r(t,a?"":n):a&&(n="none"),n}function jD(e,t,r){const{style:n,vars:a,transformOrigin:l}=e;let f=!1,i=!1;for(const _ in t){const w=t[_];if(Yv.has(_)){f=!0;continue}else if(ED(_)){a[_]=w;continue}else{const A=sY(w,MD[_]);_.startsWith("origin")?(i=!0,l[_]=A):n[_]=A}}if(t.transform||(f||r?n.transform=g0e(t,e.transform,r):n.transform&&(n.transform="none")),i){const{originX:_="50%",originY:w="50%",originZ:A=0}=l;n.transformOrigin=`${_} ${w} ${A}`}}const OD=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function oY(e,t,r){for(const n in t)!Bl(t[n])&&!aY(n,r)&&(e[n]=t[n])}function y0e({transformTemplate:e},t){return H.useMemo(()=>{const r=OD();return jD(r,t,e),Object.assign({},r.vars,r.style)},[t])}function v0e(e,t){const r=e.style||{},n={};return oY(n,r,e),Object.assign(n,y0e(e,t)),n}function x0e(e,t){const r={},n=v0e(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const _0e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ND(e){return typeof e!="string"||e.includes("-")?!1:!!(_0e.indexOf(e)>-1||/[A-Z]/u.test(e))}const b0e={offset:"stroke-dashoffset",array:"stroke-dasharray"},w0e={offset:"strokeDashoffset",array:"strokeDasharray"};function S0e(e,t,r=1,n=0,a=!0){e.pathLength=1;const l=a?b0e:w0e;e[l.offset]=ri.transform(-n);const f=ri.transform(t),i=ri.transform(r);e[l.array]=`${f} ${i}`}function _6(e,t,r){return typeof e=="string"?e:ri.transform(t+r*e)}function A0e(e,t,r){const n=_6(t,e.x,e.width),a=_6(r,e.y,e.height);return`${n} ${a}`}function RD(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:l,pathLength:f,pathSpacing:i=1,pathOffset:_=0,...w},A,E){if(jD(e,w,E),A){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:O,style:F,dimensions:U}=e;O.transform&&(U&&(F.transform=O.transform),delete O.transform),U&&(a!==void 0||l!==void 0||F.transform)&&(F.transformOrigin=A0e(U,a!==void 0?a:.5,l!==void 0?l:.5)),t!==void 0&&(O.x=t),r!==void 0&&(O.y=r),n!==void 0&&(O.scale=n),f!==void 0&&S0e(O,f,i,_,!1)}const lY=()=>({...OD(),attrs:{}}),ID=e=>typeof e=="string"&&e.toLowerCase()==="svg";function T0e(e,t,r,n){const a=H.useMemo(()=>{const l=lY();return RD(l,t,ID(n),e.transformTemplate),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};oY(l,e.style,e),a.style={...l,...a.style}}return a}function P0e(e=!1){return(r,n,a,{latestValues:l},f)=>{const _=(ND(r)?T0e:x0e)(n,l,f,r),w=Kve(n,typeof r=="string",e),A=r!==H.Fragment?{...w,..._,ref:a}:{},{children:E}=n,O=H.useMemo(()=>Bl(E)?E.get():E,[E]);return H.createElement(r,{...A,children:O})}}function b6(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function DD(e,t,r,n){if(typeof t=="function"){const[a,l]=b6(n);t=t(r!==void 0?r:e.custom,a,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,l]=b6(n);t=t(r!==void 0?r:e.custom,a,l)}return t}const oR=e=>Array.isArray(e),C0e=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),E0e=e=>oR(e)?e[e.length-1]||0:e;function lA(e){const t=Bl(e)?e.get():e;return C0e(t)?t.toValue():t}function k0e({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:r},n,a,l){const f={latestValues:M0e(n,a,l,e),renderState:t()};return r&&(f.onMount=i=>r({props:n,current:i,...f}),f.onUpdate=i=>r(i)),f}const cY=e=>(t,r)=>{const n=H.useContext(TP),a=H.useContext(mD),l=()=>k0e(e,t,n,a);return r?l():Sve(l)};function M0e(e,t,r,n){const a={},l=n(e,{});for(const O in l)a[O]=lA(l[O]);let{initial:f,animate:i}=e;const _=CP(e),w=eY(e);t&&w&&!_&&e.inherit!==!1&&(f===void 0&&(f=t.initial),i===void 0&&(i=t.animate));let A=r?r.initial===!1:!1;A=A||f===!1;const E=A?i:f;if(E&&typeof E!="boolean"&&!PP(E)){const O=Array.isArray(E)?E:[E];for(let F=0;F<O.length;F++){const U=DD(e,O[F]);if(U){const{transitionEnd:B,transition:q,...W}=U;for(const Z in W){let ne=W[Z];if(Array.isArray(ne)){const ae=A?ne.length-1:0;ne=ne[ae]}ne!==null&&(a[Z]=ne)}for(const Z in B)a[Z]=B[Z]}}}return a}function LD(e,t,r){var n;const{style:a}=e,l={};for(const f in a)(Bl(a[f])||t.style&&Bl(t.style[f])||aY(f,e)||((n=r==null?void 0:r.getValue(f))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(l[f]=a[f]);return l}const j0e={useVisualState:cY({scrapeMotionValuesFromProps:LD,createRenderState:OD})};function uY(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function dY(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const l in r)e.style.setProperty(l,r[l])}const hY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function fY(e,t,r,n){dY(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(hY.has(a)?a:CD(a),t.attrs[a])}function pY(e,t,r){const n=LD(e,t,r);for(const a in e)if(Bl(e[a])||Bl(t[a])){const l=b_.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[l]=e[a]}return n}const w6=["x","y","width","height","cx","cy","r"],O0e={useVisualState:cY({scrapeMotionValuesFromProps:pY,createRenderState:lY,onUpdate:({props:e,prevProps:t,current:r,renderState:n,latestValues:a})=>{if(!r)return;let l=!!e.drag;if(!l){for(const i in a)if(Yv.has(i)){l=!0;break}}if(!l)return;let f=!t;if(t)for(let i=0;i<w6.length;i++){const _=w6[i];e[_]!==t[_]&&(f=!0)}f&&Xa.read(()=>{uY(r,n),Xa.render(()=>{RD(n,a,ID(r.tagName),e.transformTemplate),fY(r,n)})})}})};function N0e(e,t){return function(n,{forwardMotionProps:a}={forwardMotionProps:!1}){const f={...ND(n)?O0e:j0e,preloadedFeatures:e,useRender:P0e(a),createVisualElement:t,Component:n};return n0e(f)}}function q1(e,t,r){const n=e.getProps();return DD(n,t,r!==void 0?r:n.custom,e)}const mY=new Set(["width","height","top","left","right","bottom",...b_]);function R0e(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,B1(r))}function I0e(e,t){const r=q1(e,t);let{transitionEnd:n={},transition:a={},...l}=r||{};l={...l,...n};for(const f in l){const i=E0e(l[f]);R0e(e,f,i)}}function D0e(e){return!!(Bl(e)&&e.add)}function lR(e,t){const r=e.getValue("willChange");if(D0e(r))return r.add(t)}function gY(e){return e.props[tY]}const yY=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,L0e=1e-7,z0e=12;function F0e(e,t,r,n,a){let l,f,i=0;do f=t+(r-t)/2,l=yY(f,n,a)-e,l>0?r=f:t=f;while(Math.abs(l)>L0e&&++i<z0e);return f}function Yw(e,t,r,n){if(e===t&&r===n)return bu;const a=l=>F0e(l,0,1,e,r);return l=>l===0||l===1?l:yY(a(l),t,n)}const vY=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,xY=e=>t=>1-e(1-t),_Y=Yw(.33,1.53,.69,.99),zD=xY(_Y),bY=vY(zD),wY=e=>(e*=2)<1?.5*zD(e):.5*(2-Math.pow(2,-10*(e-1))),FD=e=>1-Math.sin(Math.acos(e)),SY=xY(FD),AY=vY(FD),TY=e=>/^0[^.\s]+$/u.test(e);function B0e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||TY(e):!0}const i1=e=>Math.round(e*1e5)/1e5,BD=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function V0e(e){return e==null}const U0e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,VD=(e,t)=>r=>!!(typeof r=="string"&&U0e.test(r)&&r.startsWith(e)||t&&!V0e(r)&&Object.prototype.hasOwnProperty.call(r,t)),PY=(e,t,r)=>n=>{if(typeof n!="string")return n;const[a,l,f,i]=n.match(BD);return{[e]:parseFloat(a),[t]:parseFloat(l),[r]:parseFloat(f),alpha:i!==void 0?parseFloat(i):1}},$0e=e=>mm(0,255,e),ik={...w_,transform:e=>Math.round($0e(e))},vv={test:VD("rgb","red"),parse:PY("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+ik.transform(e)+", "+ik.transform(t)+", "+ik.transform(r)+", "+i1($1.transform(n))+")"};function q0e(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const cR={test:VD("#"),parse:q0e,transform:vv.transform},ix={test:VD("hsl","hue"),parse:PY("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Vf.transform(i1(t))+", "+Vf.transform(i1(r))+", "+i1($1.transform(n))+")"},Dl={test:e=>vv.test(e)||cR.test(e)||ix.test(e),parse:e=>vv.test(e)?vv.parse(e):ix.test(e)?ix.parse(e):cR.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?vv.transform(e):ix.transform(e)},G0e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function W0e(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(BD))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(G0e))===null||r===void 0?void 0:r.length)||0)>0}const CY="number",EY="color",H0e="var",K0e="var(",S6="${}",Z0e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function G1(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},a=[];let l=0;const i=t.replace(Z0e,_=>(Dl.test(_)?(n.color.push(l),a.push(EY),r.push(Dl.parse(_))):_.startsWith(K0e)?(n.var.push(l),a.push(H0e),r.push(_)):(n.number.push(l),a.push(CY),r.push(parseFloat(_))),++l,S6)).split(S6);return{values:r,split:i,indexes:n,types:a}}function kY(e){return G1(e).values}function MY(e){const{split:t,types:r}=G1(e),n=t.length;return a=>{let l="";for(let f=0;f<n;f++)if(l+=t[f],a[f]!==void 0){const i=r[f];i===CY?l+=i1(a[f]):i===EY?l+=Dl.transform(a[f]):l+=a[f]}return l}}const Y0e=e=>typeof e=="number"?0:e;function X0e(e){const t=kY(e);return MY(e)(t.map(Y0e))}const Hg={test:W0e,parse:kY,createTransformer:MY,getAnimatableNone:X0e},J0e=new Set(["brightness","contrast","saturate","opacity"]);function Q0e(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(BD)||[];if(!n)return e;const a=r.replace(n,"");let l=J0e.has(t)?1:0;return n!==r&&(l*=100),t+"("+l+a+")"}const exe=/\b([a-z-]*)\(.*?\)/gu,uR={...Hg,getAnimatableNone:e=>{const t=e.match(exe);return t?t.map(Q0e).join(" "):e}},txe={...MD,color:Dl,backgroundColor:Dl,outlineColor:Dl,fill:Dl,stroke:Dl,borderColor:Dl,borderTopColor:Dl,borderRightColor:Dl,borderBottomColor:Dl,borderLeftColor:Dl,filter:uR,WebkitFilter:uR},jY=e=>txe[e];function OY(e,t){let r=jY(e);return r!==uR&&(r=Hg),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const rxe=new Set(["auto","none","0"]);function nxe(e,t,r){let n=0,a;for(;n<e.length&&!a;){const l=e[n];typeof l=="string"&&!rxe.has(l)&&G1(l).values.length&&(a=e[n]),n++}if(a&&r)for(const l of t)e[l]=OY(r,a)}const xv=e=>e*180/Math.PI,dR=e=>{const t=xv(Math.atan2(e[1],e[0]));return hR(t)},ixe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:dR,rotateZ:dR,skewX:e=>xv(Math.atan(e[1])),skewY:e=>xv(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},hR=e=>(e=e%360,e<0&&(e+=360),e),A6=dR,T6=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),P6=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),axe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:T6,scaleY:P6,scale:e=>(T6(e)+P6(e))/2,rotateX:e=>hR(xv(Math.atan2(e[6],e[5]))),rotateY:e=>hR(xv(Math.atan2(-e[2],e[0]))),rotateZ:A6,rotate:A6,skewX:e=>xv(Math.atan(e[4])),skewY:e=>xv(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function C6(e){return e.includes("scale")?1:0}function fR(e,t){if(!e||e==="none")return C6(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(r)n=axe,a=r;else{const i=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=ixe,a=i}if(!a)return C6(t);const l=n[t],f=a[1].split(",").map(oxe);return typeof l=="function"?l(f):f[l]}const sxe=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return fR(r,t)};function oxe(e){return parseFloat(e.trim())}const E6=e=>e===w_||e===ri,lxe=new Set(["x","y","z"]),cxe=b_.filter(e=>!lxe.has(e));function uxe(e){const t=[];return cxe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const kx={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>fR(t,"x"),y:(e,{transform:t})=>fR(t,"y")};kx.translateX=kx.x;kx.translateY=kx.y;const Cv=new Set;let pR=!1,mR=!1;function NY(){if(mR){const e=Array.from(Cv).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const a=uxe(n);a.length&&(r.set(n,a),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const a=r.get(n);a&&a.forEach(([l,f])=>{var i;(i=n.getValue(l))===null||i===void 0||i.set(f)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}mR=!1,pR=!1,Cv.forEach(e=>e.complete()),Cv.clear()}function RY(){Cv.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(mR=!0)})}function dxe(){RY(),NY()}class UD{constructor(t,r,n,a,l,f=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=a,this.element=l,this.isAsync=f}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Cv.add(this),pR||(pR=!0,Xa.read(RY),Xa.resolveKeyframes(NY))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:a}=this;for(let l=0;l<t.length;l++)if(t[l]===null)if(l===0){const f=a==null?void 0:a.get(),i=t[t.length-1];if(f!==void 0)t[0]=f;else if(n&&r){const _=n.readValue(r,i);_!=null&&(t[0]=_)}t[0]===void 0&&(t[0]=i),a&&f===void 0&&a.set(t[0])}else t[l]=t[l-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Cv.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Cv.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const IY=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),hxe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function fxe(e){const t=hxe.exec(e);if(!t)return[,];const[,r,n,a]=t;return[`--${r??n}`,a]}function DY(e,t,r=1){const[n,a]=fxe(e);if(!n)return;const l=window.getComputedStyle(t).getPropertyValue(n);if(l){const f=l.trim();return IY(f)?parseFloat(f):f}return kD(a)?DY(a,t,r+1):a}const LY=e=>t=>t.test(e),pxe={test:e=>e==="auto",parse:e=>e},zY=[w_,ri,Vf,Ag,d0e,u0e,pxe],k6=e=>zY.find(LY(e));class FY extends UD{constructor(t,r,n,a,l){super(t,r,n,a,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let _=0;_<t.length;_++){let w=t[_];if(typeof w=="string"&&(w=w.trim(),kD(w))){const A=DY(w,r.current);A!==void 0&&(t[_]=A),_===t.length-1&&(this.finalKeyframe=w)}}if(this.resolveNoneKeyframes(),!mY.has(n)||t.length!==2)return;const[a,l]=t,f=k6(a),i=k6(l);if(f!==i)if(E6(f)&&E6(i))for(let _=0;_<t.length;_++){const w=t[_];typeof w=="string"&&(t[_]=parseFloat(w))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let a=0;a<t.length;a++)B0e(t[a])&&n.push(a);n.length&&nxe(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=kx[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(n,a).jump(a,!1)}measureEndState(){var t;const{element:r,name:n,unresolvedKeyframes:a}=this;if(!r||!r.current)return;const l=r.getValue(n);l&&l.jump(this.measuredOrigin,!1);const f=a.length-1,i=a[f];a[f]=kx[n](r.measureViewportBox(),window.getComputedStyle(r.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([_,w])=>{r.getValue(_).set(w)}),this.resolveNoneKeyframes()}}const M6=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Hg.test(e)||e==="0")&&!e.startsWith("url("));function mxe(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function gxe(e,t,r,n){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],f=M6(a,t),i=M6(l,t);return!f||!i?!1:mxe(e)||(r==="spring"||bD(r))&&n}const yxe=e=>e!==null;function EP(e,{repeat:t,repeatType:r="loop"},n){const a=e.filter(yxe),l=t&&r!=="loop"&&t%2===1?0:a.length-1;return!l||n===void 0?a[l]:n}const vxe=40;class BY{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:a=0,repeatDelay:l=0,repeatType:f="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Bf.now(),this.options={autoplay:t,delay:r,type:n,repeat:a,repeatDelay:l,repeatType:f,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>vxe?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&dxe(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=Bf.now(),this.hasAttemptedResolve=!0;const{name:n,type:a,velocity:l,delay:f,onComplete:i,onUpdate:_,isGenerator:w}=this.options;if(!w&&!gxe(t,n,a,l))if(f)this.options.duration=0;else{_&&_(EP(t,this.options,r)),i&&i(),this.resolveFinishedPromise();return}const A=this.initPlayback(t,r);A!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...A},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const js=(e,t,r)=>e+(t-e)*r;function ak(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function xxe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,l=0,f=0;if(!t)a=l=f=r;else{const i=r<.5?r*(1+t):r+t-r*t,_=2*r-i;a=ak(_,i,e+1/3),l=ak(_,i,e),f=ak(_,i,e-1/3)}return{red:Math.round(a*255),green:Math.round(l*255),blue:Math.round(f*255),alpha:n}}function BA(e,t){return r=>r>0?t:e}const sk=(e,t,r)=>{const n=e*e,a=r*(t*t-n)+n;return a<0?0:Math.sqrt(a)},_xe=[cR,vv,ix],bxe=e=>_xe.find(t=>t.test(e));function j6(e){const t=bxe(e);if(!t)return!1;let r=t.parse(e);return t===ix&&(r=xxe(r)),r}const O6=(e,t)=>{const r=j6(e),n=j6(t);if(!r||!n)return BA(e,t);const a={...r};return l=>(a.red=sk(r.red,n.red,l),a.green=sk(r.green,n.green,l),a.blue=sk(r.blue,n.blue,l),a.alpha=js(r.alpha,n.alpha,l),vv.transform(a))},wxe=(e,t)=>r=>t(e(r)),Xw=(...e)=>e.reduce(wxe),gR=new Set(["none","hidden"]);function Sxe(e,t){return gR.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Axe(e,t){return r=>js(e,t,r)}function $D(e){return typeof e=="number"?Axe:typeof e=="string"?kD(e)?BA:Dl.test(e)?O6:Cxe:Array.isArray(e)?VY:typeof e=="object"?Dl.test(e)?O6:Txe:BA}function VY(e,t){const r=[...e],n=r.length,a=e.map((l,f)=>$D(l)(l,t[f]));return l=>{for(let f=0;f<n;f++)r[f]=a[f](l);return r}}function Txe(e,t){const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=$D(e[a])(e[a],t[a]));return a=>{for(const l in n)r[l]=n[l](a);return r}}function Pxe(e,t){var r;const n=[],a={color:0,var:0,number:0};for(let l=0;l<t.values.length;l++){const f=t.types[l],i=e.indexes[f][a[f]],_=(r=e.values[i])!==null&&r!==void 0?r:0;n[l]=_,a[f]++}return n}const Cxe=(e,t)=>{const r=Hg.createTransformer(t),n=G1(e),a=G1(t);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?gR.has(e)&&!a.values.length||gR.has(t)&&!n.values.length?Sxe(e,t):Xw(VY(Pxe(n,a),a.values),r):BA(e,t)};function UY(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?js(e,t,r):$D(e)(e,t)}const Exe=5;function $Y(e,t,r){const n=Math.max(t-Exe,0);return $Z(r-e(n),t-n)}const zs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},N6=.001;function kxe({duration:e=zs.duration,bounce:t=zs.bounce,velocity:r=zs.velocity,mass:n=zs.mass}){let a,l,f=1-t;f=mm(zs.minDamping,zs.maxDamping,f),e=mm(zs.minDuration,zs.maxDuration,om(e)),f<1?(a=w=>{const A=w*f,E=A*e,O=A-r,F=yR(w,f),U=Math.exp(-E);return N6-O/F*U},l=w=>{const E=w*f*e,O=E*r+r,F=Math.pow(f,2)*Math.pow(w,2)*e,U=Math.exp(-E),B=yR(Math.pow(w,2),f);return(-a(w)+N6>0?-1:1)*((O-F)*U)/B}):(a=w=>{const A=Math.exp(-w*e),E=(w-r)*e+1;return-.001+A*E},l=w=>{const A=Math.exp(-w*e),E=(r-w)*(e*e);return A*E});const i=5/e,_=jxe(a,l,i);if(e=sm(e),isNaN(_))return{stiffness:zs.stiffness,damping:zs.damping,duration:e};{const w=Math.pow(_,2)*n;return{stiffness:w,damping:f*2*Math.sqrt(n*w),duration:e}}}const Mxe=12;function jxe(e,t,r){let n=r;for(let a=1;a<Mxe;a++)n=n-e(n)/t(n);return n}function yR(e,t){return e*Math.sqrt(1-t*t)}const Oxe=["duration","bounce"],Nxe=["stiffness","damping","mass"];function R6(e,t){return t.some(r=>e[r]!==void 0)}function Rxe(e){let t={velocity:zs.velocity,stiffness:zs.stiffness,damping:zs.damping,mass:zs.mass,isResolvedFromDuration:!1,...e};if(!R6(e,Nxe)&&R6(e,Oxe))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),a=n*n,l=2*mm(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:zs.mass,stiffness:a,damping:l}}else{const r=kxe(e);t={...t,...r,mass:zs.mass},t.isResolvedFromDuration=!0}return t}function qY(e=zs.visualDuration,t=zs.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:a}=r;const l=r.keyframes[0],f=r.keyframes[r.keyframes.length-1],i={done:!1,value:l},{stiffness:_,damping:w,mass:A,duration:E,velocity:O,isResolvedFromDuration:F}=Rxe({...r,velocity:-om(r.velocity||0)}),U=O||0,B=w/(2*Math.sqrt(_*A)),q=f-l,W=om(Math.sqrt(_/A)),Z=Math.abs(q)<5;n||(n=Z?zs.restSpeed.granular:zs.restSpeed.default),a||(a=Z?zs.restDelta.granular:zs.restDelta.default);let ne;if(B<1){const ee=yR(W,B);ne=se=>{const ce=Math.exp(-B*W*se);return f-ce*((U+B*W*q)/ee*Math.sin(ee*se)+q*Math.cos(ee*se))}}else if(B===1)ne=ee=>f-Math.exp(-W*ee)*(q+(U+W*q)*ee);else{const ee=W*Math.sqrt(B*B-1);ne=se=>{const ce=Math.exp(-B*W*se),ge=Math.min(ee*se,300);return f-ce*((U+B*W*q)*Math.sinh(ge)+ee*q*Math.cosh(ge))/ee}}const ae={calculatedDuration:F&&E||null,next:ee=>{const se=ne(ee);if(F)i.done=ee>=E;else{let ce=0;B<1&&(ce=ee===0?sm(U):$Y(ne,ee,se));const ge=Math.abs(ce)<=n,Te=Math.abs(f-se)<=a;i.done=ge&&Te}return i.value=i.done?f:se,i},toString:()=>{const ee=Math.min(qZ(ae),aR),se=GZ(ce=>ae.next(ee*ce).value,ee,30);return ee+"ms "+se}};return ae}function I6({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:l=500,modifyTarget:f,min:i,max:_,restDelta:w=.5,restSpeed:A}){const E=e[0],O={done:!1,value:E},F=ge=>i!==void 0&&ge<i||_!==void 0&&ge>_,U=ge=>i===void 0?_:_===void 0||Math.abs(i-ge)<Math.abs(_-ge)?i:_;let B=r*t;const q=E+B,W=f===void 0?q:f(q);W!==q&&(B=W-E);const Z=ge=>-B*Math.exp(-ge/n),ne=ge=>W+Z(ge),ae=ge=>{const Te=Z(ge),Ae=ne(ge);O.done=Math.abs(Te)<=w,O.value=O.done?W:Ae};let ee,se;const ce=ge=>{F(O.value)&&(ee=ge,se=qY({keyframes:[O.value,U(O.value)],velocity:$Y(ne,ge,O.value),damping:a,stiffness:l,restDelta:w,restSpeed:A}))};return ce(0),{calculatedDuration:null,next:ge=>{let Te=!1;return!se&&ee===void 0&&(Te=!0,ae(ge),ce(ge)),ee!==void 0&&ge>=ee?se.next(ge-ee):(!Te&&ae(ge),O)}}}const Ixe=Yw(.42,0,1,1),Dxe=Yw(0,0,.58,1),GY=Yw(.42,0,.58,1),Lxe=e=>Array.isArray(e)&&typeof e[0]!="number",zxe={linear:bu,easeIn:Ixe,easeInOut:GY,easeOut:Dxe,circIn:FD,circInOut:AY,circOut:SY,backIn:zD,backInOut:bY,backOut:_Y,anticipate:wY},D6=e=>{if(wD(e)){UZ(e.length===4);const[t,r,n,a]=e;return Yw(t,r,n,a)}else if(typeof e=="string")return zxe[e];return e};function Fxe(e,t,r){const n=[],a=r||UY,l=e.length-1;for(let f=0;f<l;f++){let i=a(e[f],e[f+1]);if(t){const _=Array.isArray(t)?t[f]||bu:t;i=Xw(_,i)}n.push(i)}return n}function Bxe(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const l=e.length;if(UZ(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const f=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=Fxe(t,n,a),_=i.length,w=A=>{if(f&&A<e[0])return t[0];let E=0;if(_>1)for(;E<e.length-2&&!(A<e[E+1]);E++);const O=Cx(e[E],e[E+1],A);return i[E](O)};return r?A=>w(mm(e[0],e[l-1],A)):w}function Vxe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Cx(0,t,n);e.push(js(r,1,a))}}function Uxe(e){const t=[0];return Vxe(t,e.length-1),t}function $xe(e,t){return e.map(r=>r*t)}function qxe(e,t){return e.map(()=>t||GY).splice(0,e.length-1)}function VA({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=Lxe(n)?n.map(D6):D6(n),l={done:!1,value:t[0]},f=$xe(r&&r.length===t.length?r:Uxe(t),e),i=Bxe(f,t,{ease:Array.isArray(a)?a:qxe(t,a)});return{calculatedDuration:e,next:_=>(l.value=i(_),l.done=_>=e,l)}}const Gxe=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Xa.update(t,!0),stop:()=>Wg(t),now:()=>xl.isProcessing?xl.timestamp:Bf.now()}},Wxe={decay:I6,inertia:I6,tween:VA,keyframes:VA,spring:qY},Hxe=e=>e/100;class qD extends BY{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:_}=this.options;_&&_()};const{name:r,motionValue:n,element:a,keyframes:l}=this.options,f=(a==null?void 0:a.KeyframeResolver)||UD,i=(_,w)=>this.onKeyframesResolved(_,w);this.resolver=new f(l,i,r,n,a),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:l,velocity:f=0}=this.options,i=bD(r)?r:Wxe[r]||VA;let _,w;i!==VA&&typeof t[0]!="number"&&(_=Xw(Hxe,UY(t[0],t[1])),t=[0,100]);const A=i({...this.options,keyframes:t});l==="mirror"&&(w=i({...this.options,keyframes:[...t].reverse(),velocity:-f})),A.calculatedDuration===null&&(A.calculatedDuration=qZ(A));const{calculatedDuration:E}=A,O=E+a,F=O*(n+1)-a;return{generator:A,mirroredGenerator:w,mapPercentToKeyframes:_,calculatedDuration:E,resolvedDuration:O,totalDuration:F}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:n}=this;if(!n){const{keyframes:ge}=this.options;return{done:!0,value:ge[ge.length-1]}}const{finalKeyframe:a,generator:l,mirroredGenerator:f,mapPercentToKeyframes:i,keyframes:_,calculatedDuration:w,totalDuration:A,resolvedDuration:E}=n;if(this.startTime===null)return l.next(0);const{delay:O,repeat:F,repeatType:U,repeatDelay:B,onUpdate:q}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-A/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const W=this.currentTime-O*(this.speed>=0?1:-1),Z=this.speed>=0?W<0:W>A;this.currentTime=Math.max(W,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=A);let ne=this.currentTime,ae=l;if(F){const ge=Math.min(this.currentTime,A)/E;let Te=Math.floor(ge),Ae=ge%1;!Ae&&ge>=1&&(Ae=1),Ae===1&&Te--,Te=Math.min(Te,F+1),!!(Te%2)&&(U==="reverse"?(Ae=1-Ae,B&&(Ae-=B/E)):U==="mirror"&&(ae=f)),ne=mm(0,1,Ae)*E}const ee=Z?{done:!1,value:_[0]}:ae.next(ne);i&&(ee.value=i(ee.value));let{done:se}=ee;!Z&&w!==null&&(se=this.speed>=0?this.currentTime>=A:this.currentTime<=0);const ce=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&se);return ce&&a!==void 0&&(ee.value=EP(_,this.options,a)),q&&q(ee.value),ce&&this.finish(),ee}get duration(){const{resolved:t}=this;return t?om(t.calculatedDuration):0}get time(){return om(this.currentTime)}set time(t){t=sm(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=om(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=Gxe,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),r&&r();const a=this.driver.now();this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=a):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Kxe=new Set(["opacity","clipPath","filter","transform"]);function Zxe(e,t,r,{delay:n=0,duration:a=300,repeat:l=0,repeatType:f="loop",ease:i="easeInOut",times:_}={}){const w={[t]:r};_&&(w.offset=_);const A=HZ(i,a);return Array.isArray(A)&&(w.easing=A),e.animate(w,{delay:n,duration:a,easing:Array.isArray(A)?"linear":A,fill:"both",iterations:l+1,direction:f==="reverse"?"alternate":"normal"})}const Yxe=vD(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),UA=10,Xxe=2e4;function Jxe(e){return bD(e.type)||e.type==="spring"||!WZ(e.ease)}function Qxe(e,t){const r=new qD({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:e[0]};const a=[];let l=0;for(;!n.done&&l<Xxe;)n=r.sample(l),a.push(n.value),l+=UA;return{times:void 0,keyframes:a,duration:l-UA,ease:"linear"}}const WY={anticipate:wY,backInOut:bY,circInOut:AY};function e_e(e){return e in WY}class L6 extends BY{constructor(t){super(t);const{name:r,motionValue:n,element:a,keyframes:l}=this.options;this.resolver=new FY(l,(f,i)=>this.onKeyframesResolved(f,i),r,n,a),this.resolver.scheduleResolve()}initPlayback(t,r){let{duration:n=300,times:a,ease:l,type:f,motionValue:i,name:_,startTime:w}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof l=="string"&&zA()&&e_e(l)&&(l=WY[l]),Jxe(this.options)){const{onComplete:E,onUpdate:O,motionValue:F,element:U,...B}=this.options,q=Qxe(t,B);t=q.keyframes,t.length===1&&(t[1]=t[0]),n=q.duration,a=q.times,l=q.ease,f="keyframes"}const A=Zxe(i.owner.current,_,t,{...this.options,duration:n,times:a,ease:l});return A.startTime=w??this.calcStartTime(),this.pendingTimeline?(c6(A,this.pendingTimeline),this.pendingTimeline=void 0):A.onfinish=()=>{const{onComplete:E}=this.options;i.set(EP(t,this.options,r)),E&&E(),this.cancel(),this.resolveFinishedPromise()},{animation:A,duration:n,times:a,type:f,ease:l,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return om(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return om(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=sm(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return bu;const{animation:n}=r;c6(n,t)}return bu}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:n,duration:a,type:l,ease:f,times:i}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:w,onUpdate:A,onComplete:E,element:O,...F}=this.options,U=new qD({...F,keyframes:n,duration:a,type:l,ease:f,times:i,isGenerator:!0}),B=sm(this.time);w.setWithVelocity(U.sample(B-UA).value,U.sample(B).value,UA)}const{onStop:_}=this.options;_&&_(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:n,repeatDelay:a,repeatType:l,damping:f,type:i}=t;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:_,transformTemplate:w}=r.owner.getProps();return Yxe()&&n&&Kxe.has(n)&&!_&&!w&&!a&&l!=="mirror"&&f!==0&&i!=="inertia"}}const t_e={type:"spring",stiffness:500,damping:25,restSpeed:10},r_e=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),n_e={type:"keyframes",duration:.8},i_e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},a_e=(e,{keyframes:t})=>t.length>2?n_e:Yv.has(e)?e.startsWith("scale")?r_e(t[1]):t_e:i_e;function s_e({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:l,repeatType:f,repeatDelay:i,from:_,elapsed:w,...A}){return!!Object.keys(A).length}const GD=(e,t,r,n={},a,l)=>f=>{const i=_D(n,e)||{},_=i.delay||n.delay||0;let{elapsed:w=0}=n;w=w-sm(_);let A={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...i,delay:-w,onUpdate:O=>{t.set(O),i.onUpdate&&i.onUpdate(O)},onComplete:()=>{f(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:l?void 0:a};s_e(i)||(A={...A,...a_e(e,A)}),A.duration&&(A.duration=sm(A.duration)),A.repeatDelay&&(A.repeatDelay=sm(A.repeatDelay)),A.from!==void 0&&(A.keyframes[0]=A.from);let E=!1;if((A.type===!1||A.duration===0&&!A.repeatDelay)&&(A.duration=0,A.delay===0&&(E=!0)),A.allowFlatten=!i.type&&!i.ease,E&&!l&&t.get()!==void 0){const O=EP(A.keyframes,i);if(O!==void 0)return Xa.update(()=>{A.onUpdate(O),A.onComplete()}),new kve([])}return!l&&L6.supports(A)?new L6(A):new qD(A)};function o_e({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function HY(e,t,{delay:r=0,transitionOverride:n,type:a}={}){var l;let{transition:f=e.getDefaultTransition(),transitionEnd:i,..._}=t;n&&(f=n);const w=[],A=a&&e.animationState&&e.animationState.getState()[a];for(const E in _){const O=e.getValue(E,(l=e.latestValues[E])!==null&&l!==void 0?l:null),F=_[E];if(F===void 0||A&&o_e(A,E))continue;const U={delay:r,..._D(f||{},E)};let B=!1;if(window.MotionHandoffAnimation){const W=gY(e);if(W){const Z=window.MotionHandoffAnimation(W,E,Xa);Z!==null&&(U.startTime=Z,B=!0)}}lR(e,E),O.start(GD(E,O,F,e.shouldReduceMotion&&mY.has(E)?{type:!1}:U,e,B));const q=O.animation;q&&w.push(q)}return i&&Promise.all(w).then(()=>{Xa.update(()=>{i&&I0e(e,i)})}),w}function vR(e,t,r={}){var n;const a=q1(e,t,r.type==="exit"?(n=e.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:l=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(l=r.transitionOverride);const f=a?()=>Promise.all(HY(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(w=0)=>{const{delayChildren:A=0,staggerChildren:E,staggerDirection:O}=l;return l_e(e,t,A+w,E,O,r)}:()=>Promise.resolve(),{when:_}=l;if(_){const[w,A]=_==="beforeChildren"?[f,i]:[i,f];return w().then(()=>A())}else return Promise.all([f(),i(r.delay)])}function l_e(e,t,r=0,n=0,a=1,l){const f=[],i=(e.variantChildren.size-1)*n,_=a===1?(w=0)=>w*n:(w=0)=>i-w*n;return Array.from(e.variantChildren).sort(c_e).forEach((w,A)=>{w.notify("AnimationStart",t),f.push(vR(w,t,{...l,delay:r+_(A)}).then(()=>w.notify("AnimationComplete",t)))}),Promise.all(f)}function c_e(e,t){return e.sortNodePosition(t)}function u_e(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(l=>vR(e,l,r));n=Promise.all(a)}else if(typeof t=="string")n=vR(e,t,r);else{const a=typeof t=="function"?q1(e,t,r.custom):t;n=Promise.all(HY(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function KY(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const d_e=PD.length;function ZY(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?ZY(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<d_e;r++){const n=PD[r],a=e.props[n];(V1(a)||a===!1)&&(t[n]=a)}return t}const h_e=[...TD].reverse(),f_e=TD.length;function p_e(e){return t=>Promise.all(t.map(({animation:r,options:n})=>u_e(e,r,n)))}function m_e(e){let t=p_e(e),r=z6(),n=!0;const a=_=>(w,A)=>{var E;const O=q1(e,A,_==="exit"?(E=e.presenceContext)===null||E===void 0?void 0:E.custom:void 0);if(O){const{transition:F,transitionEnd:U,...B}=O;w={...w,...B,...U}}return w};function l(_){t=_(e)}function f(_){const{props:w}=e,A=ZY(e.parent)||{},E=[],O=new Set;let F={},U=1/0;for(let q=0;q<f_e;q++){const W=h_e[q],Z=r[W],ne=w[W]!==void 0?w[W]:A[W],ae=V1(ne),ee=W===_?Z.isActive:null;ee===!1&&(U=q);let se=ne===A[W]&&ne!==w[W]&&ae;if(se&&n&&e.manuallyAnimateOnMount&&(se=!1),Z.protectedKeys={...F},!Z.isActive&&ee===null||!ne&&!Z.prevProp||PP(ne)||typeof ne=="boolean")continue;const ce=g_e(Z.prevProp,ne);let ge=ce||W===_&&Z.isActive&&!se&&ae||q>U&&ae,Te=!1;const Ae=Array.isArray(ne)?ne:[ne];let _e=Ae.reduce(a(W),{});ee===!1&&(_e={});const{prevResolvedValues:Ee={}}=Z,ke={...Ee,..._e},Qe=Oe=>{ge=!0,O.has(Oe)&&(Te=!0,O.delete(Oe)),Z.needsAnimating[Oe]=!0;const je=e.getValue(Oe);je&&(je.liveStyle=!1)};for(const Oe in ke){const je=_e[Oe],Le=Ee[Oe];if(F.hasOwnProperty(Oe))continue;let ut=!1;oR(je)&&oR(Le)?ut=!KY(je,Le):ut=je!==Le,ut?je!=null?Qe(Oe):O.add(Oe):je!==void 0&&O.has(Oe)?Qe(Oe):Z.protectedKeys[Oe]=!0}Z.prevProp=ne,Z.prevResolvedValues=_e,Z.isActive&&(F={...F,..._e}),n&&e.blockInitialAnimation&&(ge=!1),ge&&(!(se&&ce)||Te)&&E.push(...Ae.map(Oe=>({animation:Oe,options:{type:W}})))}if(O.size){const q={};if(typeof w.initial!="boolean"){const W=q1(e,Array.isArray(w.initial)?w.initial[0]:w.initial);W&&W.transition&&(q.transition=W.transition)}O.forEach(W=>{const Z=e.getBaseTarget(W),ne=e.getValue(W);ne&&(ne.liveStyle=!0),q[W]=Z??null}),E.push({animation:q})}let B=!!E.length;return n&&(w.initial===!1||w.initial===w.animate)&&!e.manuallyAnimateOnMount&&(B=!1),n=!1,B?t(E):Promise.resolve()}function i(_,w){var A;if(r[_].isActive===w)return Promise.resolve();(A=e.variantChildren)===null||A===void 0||A.forEach(O=>{var F;return(F=O.animationState)===null||F===void 0?void 0:F.setActive(_,w)}),r[_].isActive=w;const E=f(_);for(const O in r)r[O].protectedKeys={};return E}return{animateChanges:f,setActive:i,setAnimateFunction:l,getState:()=>r,reset:()=>{r=z6(),n=!0}}}function g_e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!KY(t,e):!1}function iv(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function z6(){return{animate:iv(!0),whileInView:iv(),whileHover:iv(),whileTap:iv(),whileDrag:iv(),whileFocus:iv(),exit:iv()}}class Qg{constructor(t){this.isMounted=!1,this.node=t}update(){}}class y_e extends Qg{constructor(t){super(t),t.animationState||(t.animationState=m_e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();PP(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let v_e=0;class x_e extends Qg{constructor(){super(...arguments),this.id=v_e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const __e={animation:{Feature:y_e},exit:{Feature:x_e}};function W1(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Jw(e){return{point:{x:e.pageX,y:e.pageY}}}const b_e=e=>t=>AD(t)&&e(t,Jw(t));function a1(e,t,r,n){return W1(e,t,b_e(r),n)}function YY({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function w_e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function S_e(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const XY=1e-4,A_e=1-XY,T_e=1+XY,JY=.01,P_e=0-JY,C_e=0+JY;function ac(e){return e.max-e.min}function E_e(e,t,r){return Math.abs(e-t)<=r}function F6(e,t,r,n=.5){e.origin=n,e.originPoint=js(t.min,t.max,e.origin),e.scale=ac(r)/ac(t),e.translate=js(r.min,r.max,e.origin)-e.originPoint,(e.scale>=A_e&&e.scale<=T_e||isNaN(e.scale))&&(e.scale=1),(e.translate>=P_e&&e.translate<=C_e||isNaN(e.translate))&&(e.translate=0)}function s1(e,t,r,n){F6(e.x,t.x,r.x,n?n.originX:void 0),F6(e.y,t.y,r.y,n?n.originY:void 0)}function B6(e,t,r){e.min=r.min+t.min,e.max=e.min+ac(t)}function k_e(e,t,r){B6(e.x,t.x,r.x),B6(e.y,t.y,r.y)}function V6(e,t,r){e.min=t.min-r.min,e.max=e.min+ac(t)}function o1(e,t,r){V6(e.x,t.x,r.x),V6(e.y,t.y,r.y)}const U6=()=>({translate:0,scale:1,origin:0,originPoint:0}),ax=()=>({x:U6(),y:U6()}),$6=()=>({min:0,max:0}),Ys=()=>({x:$6(),y:$6()});function pd(e){return[e("x"),e("y")]}function ok(e){return e===void 0||e===1}function xR({scale:e,scaleX:t,scaleY:r}){return!ok(e)||!ok(t)||!ok(r)}function lv(e){return xR(e)||QY(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function QY(e){return q6(e.x)||q6(e.y)}function q6(e){return e&&e!=="0%"}function $A(e,t,r){const n=e-r,a=t*n;return r+a}function G6(e,t,r,n,a){return a!==void 0&&(e=$A(e,a,n)),$A(e,r,n)+t}function _R(e,t=0,r=1,n,a){e.min=G6(e.min,t,r,n,a),e.max=G6(e.max,t,r,n,a)}function eX(e,{x:t,y:r}){_R(e.x,t.translate,t.scale,t.originPoint),_R(e.y,r.translate,r.scale,r.originPoint)}const W6=.999999999999,H6=1.0000000000001;function M_e(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let l,f;for(let i=0;i<a;i++){l=r[i],f=l.projectionDelta;const{visualElement:_}=l.options;_&&_.props.style&&_.props.style.display==="contents"||(n&&l.options.layoutScroll&&l.scroll&&l!==l.root&&ox(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),f&&(t.x*=f.x.scale,t.y*=f.y.scale,eX(e,f)),n&&lv(l.latestValues)&&ox(e,l.latestValues))}t.x<H6&&t.x>W6&&(t.x=1),t.y<H6&&t.y>W6&&(t.y=1)}function sx(e,t){e.min=e.min+t,e.max=e.max+t}function K6(e,t,r,n,a=.5){const l=js(e.min,e.max,a);_R(e,t,r,l,n)}function ox(e,t){K6(e.x,t.x,t.scaleX,t.scale,t.originX),K6(e.y,t.y,t.scaleY,t.scale,t.originY)}function tX(e,t){return YY(S_e(e.getBoundingClientRect(),t))}function j_e(e,t,r){const n=tX(e,r),{scroll:a}=t;return a&&(sx(n.x,a.offset.x),sx(n.y,a.offset.y)),n}const rX=({current:e})=>e?e.ownerDocument.defaultView:null,Z6=(e,t)=>Math.abs(e-t);function O_e(e,t){const r=Z6(e.x,t.x),n=Z6(e.y,t.y);return Math.sqrt(r**2+n**2)}class nX{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:l=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=ck(this.lastMoveEventInfo,this.history),O=this.startEvent!==null,F=O_e(E.offset,{x:0,y:0})>=3;if(!O&&!F)return;const{point:U}=E,{timestamp:B}=xl;this.history.push({...U,timestamp:B});const{onStart:q,onMove:W}=this.handlers;O||(q&&q(this.lastMoveEvent,E),this.startEvent=this.lastMoveEvent),W&&W(this.lastMoveEvent,E)},this.handlePointerMove=(E,O)=>{this.lastMoveEvent=E,this.lastMoveEventInfo=lk(O,this.transformPagePoint),Xa.update(this.updatePoint,!0)},this.handlePointerUp=(E,O)=>{this.end();const{onEnd:F,onSessionEnd:U,resumeAnimation:B}=this.handlers;if(this.dragSnapToOrigin&&B&&B(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const q=ck(E.type==="pointercancel"?this.lastMoveEventInfo:lk(O,this.transformPagePoint),this.history);this.startEvent&&F&&F(E,q),U&&U(E,q)},!AD(t))return;this.dragSnapToOrigin=l,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const f=Jw(t),i=lk(f,this.transformPagePoint),{point:_}=i,{timestamp:w}=xl;this.history=[{..._,timestamp:w}];const{onSessionStart:A}=r;A&&A(t,ck(i,this.history)),this.removeListeners=Xw(a1(this.contextWindow,"pointermove",this.handlePointerMove),a1(this.contextWindow,"pointerup",this.handlePointerUp),a1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Wg(this.updatePoint)}}function lk(e,t){return t?{point:t(e.point)}:e}function Y6(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ck({point:e},t){return{point:e,delta:Y6(e,iX(t)),offset:Y6(e,N_e(t)),velocity:R_e(t,.1)}}function N_e(e){return e[0]}function iX(e){return e[e.length-1]}function R_e(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=iX(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>sm(t)));)r--;if(!n)return{x:0,y:0};const l=om(a.timestamp-n.timestamp);if(l===0)return{x:0,y:0};const f={x:(a.x-n.x)/l,y:(a.y-n.y)/l};return f.x===1/0&&(f.x=0),f.y===1/0&&(f.y=0),f}function I_e(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?js(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?js(r,e,n.max):Math.min(e,r)),e}function X6(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function D_e(e,{top:t,left:r,bottom:n,right:a}){return{x:X6(e.x,r,a),y:X6(e.y,t,n)}}function J6(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function L_e(e,t){return{x:J6(e.x,t.x),y:J6(e.y,t.y)}}function z_e(e,t){let r=.5;const n=ac(e),a=ac(t);return a>n?r=Cx(t.min,t.max-n,e.min):n>a&&(r=Cx(e.min,e.max-a,t.min)),mm(0,1,r)}function F_e(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const bR=.35;function B_e(e=bR){return e===!1?e=0:e===!0&&(e=bR),{x:Q6(e,"left","right"),y:Q6(e,"top","bottom")}}function Q6(e,t,r){return{min:eV(e,t),max:eV(e,r)}}function eV(e,t){return typeof e=="number"?e:e[t]||0}const V_e=new WeakMap;class U_e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ys(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=A=>{const{dragSnapToOrigin:E}=this.getProps();E?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Jw(A).point)},l=(A,E)=>{const{drag:O,dragPropagation:F,onDragStart:U}=this.getProps();if(O&&!F&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Ive(O),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),pd(q=>{let W=this.getAxisMotionValue(q).get()||0;if(Vf.test(W)){const{projection:Z}=this.visualElement;if(Z&&Z.layout){const ne=Z.layout.layoutBox[q];ne&&(W=ac(ne)*(parseFloat(W)/100))}}this.originPoint[q]=W}),U&&Xa.postRender(()=>U(A,E)),lR(this.visualElement,"transform");const{animationState:B}=this.visualElement;B&&B.setActive("whileDrag",!0)},f=(A,E)=>{const{dragPropagation:O,dragDirectionLock:F,onDirectionLock:U,onDrag:B}=this.getProps();if(!O&&!this.openDragLock)return;const{offset:q}=E;if(F&&this.currentDirection===null){this.currentDirection=$_e(q),this.currentDirection!==null&&U&&U(this.currentDirection);return}this.updateAxis("x",E.point,q),this.updateAxis("y",E.point,q),this.visualElement.render(),B&&B(A,E)},i=(A,E)=>this.stop(A,E),_=()=>pd(A=>{var E;return this.getAnimationState(A)==="paused"&&((E=this.getAxisMotionValue(A).animation)===null||E===void 0?void 0:E.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new nX(t,{onSessionStart:a,onStart:l,onMove:f,onSessionEnd:i,resumeAnimation:_},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,contextWindow:rX(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&Xa.postRender(()=>l(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!MS(t,a,this.currentDirection))return;const l=this.getAxisMotionValue(t);let f=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(f=I_e(f,this.constraints[t],this.elastic[t])),l.set(f)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,l=this.constraints;r&&nx(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=D_e(a.layoutBox,r):this.constraints=!1,this.elastic=B_e(n),l!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&pd(f=>{this.constraints!==!1&&this.getAxisMotionValue(f)&&(this.constraints[f]=F_e(a.layoutBox[f],this.constraints[f]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!nx(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const l=j_e(n,a.root,this.visualElement.getTransformPagePoint());let f=L_e(a.layout.layoutBox,l);if(r){const i=r(w_e(f));this.hasMutatedConstraints=!!i,i&&(f=YY(i))}return f}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:l,dragSnapToOrigin:f,onDragTransitionEnd:i}=this.getProps(),_=this.constraints||{},w=pd(A=>{if(!MS(A,r,this.currentDirection))return;let E=_&&_[A]||{};f&&(E={min:0,max:0});const O=a?200:1e6,F=a?40:1e7,U={type:"inertia",velocity:n?t[A]:0,bounceStiffness:O,bounceDamping:F,timeConstant:750,restDelta:1,restSpeed:10,...l,...E};return this.startAxisValueAnimation(A,U)});return Promise.all(w).then(i)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return lR(this.visualElement,t),n.start(GD(t,n,0,r,this.visualElement,!1))}stopAnimation(){pd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){pd(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){pd(r=>{const{drag:n}=this.getProps();if(!MS(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,l=this.getAxisMotionValue(r);if(a&&a.layout){const{min:f,max:i}=a.layout.layoutBox[r];l.set(t[r]-js(f,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!nx(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};pd(f=>{const i=this.getAxisMotionValue(f);if(i&&this.constraints!==!1){const _=i.get();a[f]=z_e({min:_,max:_},this.constraints[f])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),pd(f=>{if(!MS(f,t,null))return;const i=this.getAxisMotionValue(f),{min:_,max:w}=this.constraints[f];i.set(js(_,w,a[f]))})}addListeners(){if(!this.visualElement.current)return;V_e.set(this.visualElement,this);const t=this.visualElement.current,r=a1(t,"pointerdown",_=>{const{drag:w,dragListener:A=!0}=this.getProps();w&&A&&this.start(_)}),n=()=>{const{dragConstraints:_}=this.getProps();nx(_)&&_.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,l=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),Xa.read(n);const f=W1(window,"resize",()=>this.scalePositionWithinConstraints()),i=a.addEventListener("didUpdate",({delta:_,hasLayoutChanged:w})=>{this.isDragging&&w&&(pd(A=>{const E=this.getAxisMotionValue(A);E&&(this.originPoint[A]+=_[A].translate,E.set(E.get()+_[A].translate))}),this.visualElement.render())});return()=>{f(),r(),l(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:l=!1,dragElastic:f=bR,dragMomentum:i=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:l,dragElastic:f,dragMomentum:i}}}function MS(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function $_e(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class q_e extends Qg{constructor(t){super(t),this.removeGroupControls=bu,this.removeListeners=bu,this.controls=new U_e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||bu}unmount(){this.removeGroupControls(),this.removeListeners()}}const tV=e=>(t,r)=>{e&&Xa.postRender(()=>e(t,r))};class G_e extends Qg{constructor(){super(...arguments),this.removePointerDownListener=bu}onPointerDown(t){this.session=new nX(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:rX(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:tV(t),onStart:tV(r),onMove:n,onEnd:(l,f)=>{delete this.session,a&&Xa.postRender(()=>a(l,f))}}}mount(){this.removePointerDownListener=a1(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const cA={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function rV(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Nb={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ri.test(e))e=parseFloat(e);else return e;const r=rV(e,t.target.x),n=rV(e,t.target.y);return`${r}% ${n}%`}},W_e={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=Hg.parse(e);if(a.length>5)return n;const l=Hg.createTransformer(e),f=typeof a[0]!="number"?1:0,i=r.x.scale*t.x,_=r.y.scale*t.y;a[0+f]/=i,a[1+f]/=_;const w=js(i,_,.5);return typeof a[2+f]=="number"&&(a[2+f]/=w),typeof a[3+f]=="number"&&(a[3+f]/=w),l(a)}};class H_e extends H.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:l}=t;c0e(K_e),l&&(r.group&&r.group.add(l),n&&n.register&&a&&n.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),cA.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:l}=this.props,f=n.projection;return f&&(f.isPresent=l,a||t.layoutDependency!==r||r===void 0||t.isPresent!==l?f.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?f.promote():f.relegate()||Xa.postRender(()=>{const i=f.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),SD.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function aX(e){const[t,r]=Tve(),n=H.useContext(BZ);return u.jsx(H_e,{...e,layoutGroup:n,switchLayoutGroup:H.useContext(rY),isPresent:t,safeToRemove:r})}const K_e={borderRadius:{...Nb,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Nb,borderTopRightRadius:Nb,borderBottomLeftRadius:Nb,borderBottomRightRadius:Nb,boxShadow:W_e};function Z_e(e,t,r){const n=Bl(e)?e:B1(e);return n.start(GD("",n,t,r)),n.animation}function Y_e(e){return e instanceof SVGElement&&e.tagName!=="svg"}const X_e=(e,t)=>e.depth-t.depth;class J_e{constructor(){this.children=[],this.isDirty=!1}add(t){gD(this.children,t),this.isDirty=!0}remove(t){yD(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(X_e),this.isDirty=!1,this.children.forEach(t)}}function Q_e(e,t){const r=Bf.now(),n=({timestamp:a})=>{const l=a-r;l>=t&&(Wg(n),e(l-t))};return Xa.read(n,!0),()=>Wg(n)}const sX=["TopLeft","TopRight","BottomLeft","BottomRight"],ebe=sX.length,nV=e=>typeof e=="string"?parseFloat(e):e,iV=e=>typeof e=="number"||ri.test(e);function tbe(e,t,r,n,a,l){a?(e.opacity=js(0,r.opacity!==void 0?r.opacity:1,rbe(n)),e.opacityExit=js(t.opacity!==void 0?t.opacity:1,0,nbe(n))):l&&(e.opacity=js(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let f=0;f<ebe;f++){const i=`border${sX[f]}Radius`;let _=aV(t,i),w=aV(r,i);if(_===void 0&&w===void 0)continue;_||(_=0),w||(w=0),_===0||w===0||iV(_)===iV(w)?(e[i]=Math.max(js(nV(_),nV(w),n),0),(Vf.test(w)||Vf.test(_))&&(e[i]+="%")):e[i]=w}(t.rotate||r.rotate)&&(e.rotate=js(t.rotate||0,r.rotate||0,n))}function aV(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const rbe=oX(0,.5,SY),nbe=oX(.5,.95,bu);function oX(e,t,r){return n=>n<e?0:n>t?1:r(Cx(e,t,n))}function sV(e,t){e.min=t.min,e.max=t.max}function dd(e,t){sV(e.x,t.x),sV(e.y,t.y)}function oV(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function lV(e,t,r,n,a){return e-=t,e=$A(e,1/r,n),a!==void 0&&(e=$A(e,1/a,n)),e}function ibe(e,t=0,r=1,n=.5,a,l=e,f=e){if(Vf.test(t)&&(t=parseFloat(t),t=js(f.min,f.max,t/100)-f.min),typeof t!="number")return;let i=js(l.min,l.max,n);e===l&&(i-=t),e.min=lV(e.min,t,r,i,a),e.max=lV(e.max,t,r,i,a)}function cV(e,t,[r,n,a],l,f){ibe(e,t[r],t[n],t[a],t.scale,l,f)}const abe=["x","scaleX","originX"],sbe=["y","scaleY","originY"];function uV(e,t,r,n){cV(e.x,t,abe,r?r.x:void 0,n?n.x:void 0),cV(e.y,t,sbe,r?r.y:void 0,n?n.y:void 0)}function dV(e){return e.translate===0&&e.scale===1}function lX(e){return dV(e.x)&&dV(e.y)}function hV(e,t){return e.min===t.min&&e.max===t.max}function obe(e,t){return hV(e.x,t.x)&&hV(e.y,t.y)}function fV(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function cX(e,t){return fV(e.x,t.x)&&fV(e.y,t.y)}function pV(e){return ac(e.x)/ac(e.y)}function mV(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class lbe{constructor(){this.members=[]}add(t){gD(this.members,t),t.scheduleRender()}remove(t){if(yD(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const l=this.members[a];if(l.isPresent!==!1){n=l;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function cbe(e,t,r){let n="";const a=e.x.translate/t.x,l=e.y.translate/t.y,f=(r==null?void 0:r.z)||0;if((a||l||f)&&(n=`translate3d(${a}px, ${l}px, ${f}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:w,rotate:A,rotateX:E,rotateY:O,skewX:F,skewY:U}=r;w&&(n=`perspective(${w}px) ${n}`),A&&(n+=`rotate(${A}deg) `),E&&(n+=`rotateX(${E}deg) `),O&&(n+=`rotateY(${O}deg) `),F&&(n+=`skewX(${F}deg) `),U&&(n+=`skewY(${U}deg) `)}const i=e.x.scale*t.x,_=e.y.scale*t.y;return(i!==1||_!==1)&&(n+=`scale(${i}, ${_})`),n||"none"}const uk=["","X","Y","Z"],ube={visibility:"hidden"},gV=1e3;let dbe=0;function dk(e,t,r,n){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),n&&(n[e]=0))}function uX(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=gY(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Xa,!(a||l))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&uX(n)}function dX({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(f={},i=t==null?void 0:t()){this.id=dbe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(pbe),this.nodes.forEach(xbe),this.nodes.forEach(_be),this.nodes.forEach(mbe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=f,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let _=0;_<this.path.length;_++)this.path[_].shouldResetTransform=!0;this.root===this&&(this.nodes=new J_e)}addEventListener(f,i){return this.eventHandlers.has(f)||this.eventHandlers.set(f,new xD),this.eventHandlers.get(f).add(i)}notifyListeners(f,...i){const _=this.eventHandlers.get(f);_&&_.notify(...i)}hasListeners(f){return this.eventHandlers.has(f)}mount(f,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Y_e(f),this.instance=f;const{layoutId:_,layout:w,visualElement:A}=this.options;if(A&&!A.current&&A.mount(f),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(w||_)&&(this.isLayoutDirty=!0),e){let E;const O=()=>this.root.updateBlockedByResize=!1;e(f,()=>{this.root.updateBlockedByResize=!0,E&&E(),E=Q_e(O,250),cA.hasAnimatedSinceResize&&(cA.hasAnimatedSinceResize=!1,this.nodes.forEach(vV))})}_&&this.root.registerSharedNode(_,this),this.options.animate!==!1&&A&&(_||w)&&this.addEventListener("didUpdate",({delta:E,hasLayoutChanged:O,hasRelativeLayoutChanged:F,layout:U})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const B=this.options.transition||A.getDefaultTransition()||Tbe,{onLayoutAnimationStart:q,onLayoutAnimationComplete:W}=A.getProps(),Z=!this.targetLayout||!cX(this.targetLayout,U),ne=!O&&F;if(this.options.layoutRoot||this.resumeFrom||ne||O&&(Z||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(E,ne);const ae={..._D(B,"layout"),onPlay:q,onComplete:W};(A.shouldReduceMotion||this.options.layoutRoot)&&(ae.delay=0,ae.type=!1),this.startAnimation(ae)}else O||vV(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=U})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const f=this.getStack();f&&f.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Wg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(bbe),this.animationId++)}getTransformTemplate(){const{visualElement:f}=this.options;return f&&f.getProps().transformTemplate}willUpdate(f=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&uX(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let A=0;A<this.path.length;A++){const E=this.path[A];E.shouldResetTransform=!0,E.updateScroll("snapshot"),E.options.layoutRoot&&E.willUpdate(!1)}const{layoutId:i,layout:_}=this.options;if(i===void 0&&!_)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),f&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(yV);return}this.isUpdating||this.nodes.forEach(ybe),this.isUpdating=!1,this.nodes.forEach(vbe),this.nodes.forEach(hbe),this.nodes.forEach(fbe),this.clearAllSnapshots();const i=Bf.now();xl.delta=mm(0,1e3/60,i-xl.timestamp),xl.timestamp=i,xl.isProcessing=!0,rk.update.process(xl),rk.preRender.process(xl),rk.render.process(xl),xl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,SD.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(gbe),this.sharedNodes.forEach(wbe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Xa.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Xa.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ac(this.snapshot.measuredBox.x)&&!ac(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let _=0;_<this.path.length;_++)this.path[_].updateScroll();const f=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ys(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,f?f.layoutBox:void 0)}updateScroll(f="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===f&&(i=!1),i){const _=n(this.instance);this.scroll={animationId:this.root.animationId,phase:f,isRoot:_,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:_}}}resetTransform(){if(!a)return;const f=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!lX(this.projectionDelta),_=this.getTransformTemplate(),w=_?_(this.latestValues,""):void 0,A=w!==this.prevTransformTemplateValue;f&&(i||lv(this.latestValues)||A)&&(a(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(f=!0){const i=this.measurePageBox();let _=this.removeElementScroll(i);return f&&(_=this.removeTransform(_)),Pbe(_),{animationId:this.root.animationId,measuredBox:i,layoutBox:_,latestValues:{},source:this.id}}measurePageBox(){var f;const{visualElement:i}=this.options;if(!i)return Ys();const _=i.measureViewportBox();if(!(((f=this.scroll)===null||f===void 0?void 0:f.wasRoot)||this.path.some(Cbe))){const{scroll:A}=this.root;A&&(sx(_.x,A.offset.x),sx(_.y,A.offset.y))}return _}removeElementScroll(f){var i;const _=Ys();if(dd(_,f),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return _;for(let w=0;w<this.path.length;w++){const A=this.path[w],{scroll:E,options:O}=A;A!==this.root&&E&&O.layoutScroll&&(E.wasRoot&&dd(_,f),sx(_.x,E.offset.x),sx(_.y,E.offset.y))}return _}applyTransform(f,i=!1){const _=Ys();dd(_,f);for(let w=0;w<this.path.length;w++){const A=this.path[w];!i&&A.options.layoutScroll&&A.scroll&&A!==A.root&&ox(_,{x:-A.scroll.offset.x,y:-A.scroll.offset.y}),lv(A.latestValues)&&ox(_,A.latestValues)}return lv(this.latestValues)&&ox(_,this.latestValues),_}removeTransform(f){const i=Ys();dd(i,f);for(let _=0;_<this.path.length;_++){const w=this.path[_];if(!w.instance||!lv(w.latestValues))continue;xR(w.latestValues)&&w.updateSnapshot();const A=Ys(),E=w.measurePageBox();dd(A,E),uV(i,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,A)}return lv(this.latestValues)&&uV(i,this.latestValues),i}setTargetDelta(f){this.targetDelta=f,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(f){this.options={...this.options,...f,crossfade:f.crossfade!==void 0?f.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(f=!1){var i;const _=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=_.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=_.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=_.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==_;if(!(f||w&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:E,layoutId:O}=this.options;if(!(!this.layout||!(E||O))){if(this.resolvedRelativeTargetAt=xl.timestamp,!this.targetDelta&&!this.relativeTarget){const F=this.getClosestProjectingParent();F&&F.layout&&this.animationProgress!==1?(this.relativeParent=F,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ys(),this.relativeTargetOrigin=Ys(),o1(this.relativeTargetOrigin,this.layout.layoutBox,F.layout.layoutBox),dd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ys(),this.targetWithTransforms=Ys()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),k_e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):dd(this.target,this.layout.layoutBox),eX(this.target,this.targetDelta)):dd(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const F=this.getClosestProjectingParent();F&&!!F.resumingFrom==!!this.resumingFrom&&!F.options.layoutScroll&&F.target&&this.animationProgress!==1?(this.relativeParent=F,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ys(),this.relativeTargetOrigin=Ys(),o1(this.relativeTargetOrigin,this.target,F.target),dd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||xR(this.parent.latestValues)||QY(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var f;const i=this.getLead(),_=!!this.resumingFrom||this!==i;let w=!0;if((this.isProjectionDirty||!((f=this.parent)===null||f===void 0)&&f.isProjectionDirty)&&(w=!1),_&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===xl.timestamp&&(w=!1),w)return;const{layout:A,layoutId:E}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(A||E))return;dd(this.layoutCorrected,this.layout.layoutBox);const O=this.treeScale.x,F=this.treeScale.y;M_e(this.layoutCorrected,this.treeScale,this.path,_),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Ys());const{target:U}=i;if(!U){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(oV(this.prevProjectionDelta.x,this.projectionDelta.x),oV(this.prevProjectionDelta.y,this.projectionDelta.y)),s1(this.projectionDelta,this.layoutCorrected,U,this.latestValues),(this.treeScale.x!==O||this.treeScale.y!==F||!mV(this.projectionDelta.x,this.prevProjectionDelta.x)||!mV(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",U))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(f=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),f){const _=this.getStack();_&&_.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ax(),this.projectionDelta=ax(),this.projectionDeltaWithTransform=ax()}setAnimationOrigin(f,i=!1){const _=this.snapshot,w=_?_.latestValues:{},A={...this.latestValues},E=ax();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const O=Ys(),F=_?_.source:void 0,U=this.layout?this.layout.source:void 0,B=F!==U,q=this.getStack(),W=!q||q.members.length<=1,Z=!!(B&&!W&&this.options.crossfade===!0&&!this.path.some(Abe));this.animationProgress=0;let ne;this.mixTargetDelta=ae=>{const ee=ae/1e3;xV(E.x,f.x,ee),xV(E.y,f.y,ee),this.setTargetDelta(E),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(o1(O,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Sbe(this.relativeTarget,this.relativeTargetOrigin,O,ee),ne&&obe(this.relativeTarget,ne)&&(this.isProjectionDirty=!1),ne||(ne=Ys()),dd(ne,this.relativeTarget)),B&&(this.animationValues=A,tbe(A,w,this.latestValues,ee,Z,W)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ee},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(f){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Wg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Xa.update(()=>{cA.hasAnimatedSinceResize=!0,this.currentAnimation=Z_e(0,gV,{...f,onUpdate:i=>{this.mixTargetDelta(i),f.onUpdate&&f.onUpdate(i)},onStop:()=>{},onComplete:()=>{f.onComplete&&f.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const f=this.getStack();f&&f.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gV),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const f=this.getLead();let{targetWithTransforms:i,target:_,layout:w,latestValues:A}=f;if(!(!i||!_||!w)){if(this!==f&&this.layout&&w&&hX(this.options.animationType,this.layout.layoutBox,w.layoutBox)){_=this.target||Ys();const E=ac(this.layout.layoutBox.x);_.x.min=f.target.x.min,_.x.max=_.x.min+E;const O=ac(this.layout.layoutBox.y);_.y.min=f.target.y.min,_.y.max=_.y.min+O}dd(i,_),ox(i,A),s1(this.projectionDeltaWithTransform,this.layoutCorrected,i,A)}}registerSharedNode(f,i){this.sharedNodes.has(f)||this.sharedNodes.set(f,new lbe),this.sharedNodes.get(f).add(i);const w=i.options.initialPromotionConfig;i.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(i):void 0})}isLead(){const f=this.getStack();return f?f.lead===this:!0}getLead(){var f;const{layoutId:i}=this.options;return i?((f=this.getStack())===null||f===void 0?void 0:f.lead)||this:this}getPrevLead(){var f;const{layoutId:i}=this.options;return i?(f=this.getStack())===null||f===void 0?void 0:f.prevLead:void 0}getStack(){const{layoutId:f}=this.options;if(f)return this.root.sharedNodes.get(f)}promote({needsReset:f,transition:i,preserveFollowOpacity:_}={}){const w=this.getStack();w&&w.promote(this,_),f&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const f=this.getStack();return f?f.relegate(this):!1}resetSkewAndRotation(){const{visualElement:f}=this.options;if(!f)return;let i=!1;const{latestValues:_}=f;if((_.z||_.rotate||_.rotateX||_.rotateY||_.rotateZ||_.skewX||_.skewY)&&(i=!0),!i)return;const w={};_.z&&dk("z",f,w,this.animationValues);for(let A=0;A<uk.length;A++)dk(`rotate${uk[A]}`,f,w,this.animationValues),dk(`skew${uk[A]}`,f,w,this.animationValues);f.render();for(const A in w)f.setStaticValue(A,w[A]),this.animationValues&&(this.animationValues[A]=w[A]);f.scheduleRender()}getProjectionStyles(f){var i,_;if(!this.instance||this.isSVG)return;if(!this.isVisible)return ube;const w={visibility:""},A=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,w.opacity="",w.pointerEvents=lA(f==null?void 0:f.pointerEvents)||"",w.transform=A?A(this.latestValues,""):"none",w;const E=this.getLead();if(!this.projectionDelta||!this.layout||!E.target){const B={};return this.options.layoutId&&(B.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,B.pointerEvents=lA(f==null?void 0:f.pointerEvents)||""),this.hasProjected&&!lv(this.latestValues)&&(B.transform=A?A({},""):"none",this.hasProjected=!1),B}const O=E.animationValues||E.latestValues;this.applyTransformsToTarget(),w.transform=cbe(this.projectionDeltaWithTransform,this.treeScale,O),A&&(w.transform=A(O,w.transform));const{x:F,y:U}=this.projectionDelta;w.transformOrigin=`${F.origin*100}% ${U.origin*100}% 0`,E.animationValues?w.opacity=E===this?(_=(i=O.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&_!==void 0?_:1:this.preserveOpacity?this.latestValues.opacity:O.opacityExit:w.opacity=E===this?O.opacity!==void 0?O.opacity:"":O.opacityExit!==void 0?O.opacityExit:0;for(const B in U1){if(O[B]===void 0)continue;const{correct:q,applyTo:W,isCSSVariable:Z}=U1[B],ne=w.transform==="none"?O[B]:q(O[B],E);if(W){const ae=W.length;for(let ee=0;ee<ae;ee++)w[W[ee]]=ne}else Z?this.options.visualElement.renderState.vars[B]=ne:w[B]=ne}return this.options.layoutId&&(w.pointerEvents=E===this?lA(f==null?void 0:f.pointerEvents)||"":"none"),w}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(f=>{var i;return(i=f.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(yV),this.root.sharedNodes.clear()}}}function hbe(e){e.updateLayout()}function fbe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:l}=e.options,f=r.source!==e.layout.source;l==="size"?pd(E=>{const O=f?r.measuredBox[E]:r.layoutBox[E],F=ac(O);O.min=n[E].min,O.max=O.min+F}):hX(l,r.layoutBox,n)&&pd(E=>{const O=f?r.measuredBox[E]:r.layoutBox[E],F=ac(n[E]);O.max=O.min+F,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[E].max=e.relativeTarget[E].min+F)});const i=ax();s1(i,n,r.layoutBox);const _=ax();f?s1(_,e.applyTransform(a,!0),r.measuredBox):s1(_,n,r.layoutBox);const w=!lX(i);let A=!1;if(!e.resumeFrom){const E=e.getClosestProjectingParent();if(E&&!E.resumeFrom){const{snapshot:O,layout:F}=E;if(O&&F){const U=Ys();o1(U,r.layoutBox,O.layoutBox);const B=Ys();o1(B,n,F.layoutBox),cX(U,B)||(A=!0),E.options.layoutRoot&&(e.relativeTarget=B,e.relativeTargetOrigin=U,e.relativeParent=E)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:_,layoutDelta:i,hasLayoutChanged:w,hasRelativeLayoutChanged:A})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function pbe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function mbe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function gbe(e){e.clearSnapshot()}function yV(e){e.clearMeasurements()}function ybe(e){e.isLayoutDirty=!1}function vbe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function vV(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function xbe(e){e.resolveTargetDelta()}function _be(e){e.calcProjection()}function bbe(e){e.resetSkewAndRotation()}function wbe(e){e.removeLeadSnapshot()}function xV(e,t,r){e.translate=js(t.translate,0,r),e.scale=js(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function _V(e,t,r,n){e.min=js(t.min,r.min,n),e.max=js(t.max,r.max,n)}function Sbe(e,t,r,n){_V(e.x,t.x,r.x,n),_V(e.y,t.y,r.y,n)}function Abe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Tbe={duration:.45,ease:[.4,0,.1,1]},bV=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),wV=bV("applewebkit/")&&!bV("chrome/")?Math.round:bu;function SV(e){e.min=wV(e.min),e.max=wV(e.max)}function Pbe(e){SV(e.x),SV(e.y)}function hX(e,t,r){return e==="position"||e==="preserve-aspect"&&!E_e(pV(t),pV(r),.2)}function Cbe(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const Ebe=dX({attachResizeListener:(e,t)=>W1(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),hk={current:void 0},fX=dX({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!hk.current){const e=new Ebe({});e.mount(window),e.setOptions({layoutScroll:!0}),hk.current=e}return hk.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),kbe={pan:{Feature:G_e},drag:{Feature:q_e,ProjectionNode:fX,MeasureLayout:aX}};function AV(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,l=n[a];l&&Xa.postRender(()=>l(t,Jw(t)))}class Mbe extends Qg{mount(){const{current:t}=this.node;t&&(this.unmount=Lve(t,(r,n)=>(AV(this.node,n,"Start"),a=>AV(this.node,a,"End"))))}unmount(){}}class jbe extends Qg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Xw(W1(this.node.current,"focus",()=>this.onFocus()),W1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function TV(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),l=n[a];l&&Xa.postRender(()=>l(t,Jw(t)))}class Obe extends Qg{mount(){const{current:t}=this.node;t&&(this.unmount=Vve(t,(r,n)=>(TV(this.node,n,"Start"),(a,{success:l})=>TV(this.node,a,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const wR=new WeakMap,fk=new WeakMap,Nbe=e=>{const t=wR.get(e.target);t&&t(e)},Rbe=e=>{e.forEach(Nbe)};function Ibe({root:e,...t}){const r=e||document;fk.has(r)||fk.set(r,{});const n=fk.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(Rbe,{root:e,...t})),n[a]}function Dbe(e,t,r){const n=Ibe(t);return wR.set(e,r),n.observe(e),()=>{wR.delete(e),n.unobserve(e)}}const Lbe={some:0,all:1};class zbe extends Qg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:l}=t,f={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:Lbe[a]},i=_=>{const{isIntersecting:w}=_;if(this.isInView===w||(this.isInView=w,l&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:A,onViewportLeave:E}=this.node.getProps(),O=w?A:E;O&&O(_)};return Dbe(this.node.current,f,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Fbe(t,r))&&this.startObserver()}unmount(){}}function Fbe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Bbe={inView:{Feature:zbe},tap:{Feature:Obe},focus:{Feature:jbe},hover:{Feature:Mbe}},Vbe={layout:{ProjectionNode:fX,MeasureLayout:aX}},SR={current:null},pX={current:!1};function Ube(){if(pX.current=!0,!!pD)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>SR.current=e.matches;e.addListener(t),t()}else SR.current=!1}const $be=[...zY,Dl,Hg],qbe=e=>$be.find(LY(e)),Gbe=new WeakMap;function Wbe(e,t,r){for(const n in t){const a=t[n],l=r[n];if(Bl(a))e.addValue(n,a);else if(Bl(l))e.addValue(n,B1(a,{owner:e}));else if(l!==a)if(e.hasValue(n)){const f=e.getValue(n);f.liveStyle===!0?f.jump(a):f.hasAnimated||f.set(a)}else{const f=e.getStaticValue(n);e.addValue(n,B1(f!==void 0?f:a,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const PV=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Hbe{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:l,visualState:f},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=UD,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const F=Bf.now();this.renderScheduledAt<F&&(this.renderScheduledAt=F,Xa.render(this.render,!1,!0))};const{latestValues:_,renderState:w,onUpdate:A}=f;this.onUpdate=A,this.latestValues=_,this.baseTarget={..._},this.initialValues=r.initial?{..._}:{},this.renderState=w,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!l,this.isControllingVariants=CP(r),this.isVariantNode=eY(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:E,...O}=this.scrapeMotionValuesFromProps(r,{},this);for(const F in O){const U=O[F];_[F]!==void 0&&Bl(U)&&U.set(_[F],!1)}}mount(t){this.current=t,Gbe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),pX.current||Ube(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:SR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Wg(this.notifyUpdate),Wg(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Yv.has(t);n&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Xa.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),l=r.on("renderRequest",this.scheduleRender);let f;window.MotionCheckAppearSync&&(f=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),l(),f&&f(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ex){const r=Ex[t];if(!r)continue;const{isEnabled:n,Feature:a}=r;if(!this.features[t]&&a&&n(this.props)&&(this.features[t]=new a(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ys()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<PV.length;n++){const a=PV[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const l="on"+a,f=t[l];f&&(this.propEventSubscriptions[a]=this.on(a,f))}this.prevMotionValues=Wbe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=B1(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){var n;let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(IY(a)||TY(a))?a=parseFloat(a):!qbe(a)&&Hg.test(r)&&(a=OY(t,r)),this.setBaseTarget(t,Bl(a)?a.get():a)),Bl(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const f=DD(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);f&&(a=f[t])}if(n&&a!==void 0)return a;const l=this.getBaseTargetFromProps(this.props,t);return l!==void 0&&!Bl(l)?l:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new xD),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class mX extends Hbe{constructor(){super(...arguments),this.KeyframeResolver=FY}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Bl(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Kbe(e){return window.getComputedStyle(e)}class Zbe extends mX{constructor(){super(...arguments),this.type="html",this.renderInstance=dY}readValueFromInstance(t,r){if(Yv.has(r))return sxe(t,r);{const n=Kbe(t),a=(ED(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return tX(t,r)}build(t,r,n){jD(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return LD(t,r,n)}}class Ybe extends mX{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ys,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&uY(this.current,this.renderState)}}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Yv.has(r)){const n=jY(r);return n&&n.default||0}return r=hY.has(r)?r:CD(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return pY(t,r,n)}onBindTransform(){this.current&&!this.renderState.dimensions&&Xa.postRender(this.updateDimensions)}build(t,r,n){RD(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,a){fY(t,r,n,a)}mount(t){this.isSVGTag=ID(t.tagName),super.mount(t)}}const Xbe=(e,t)=>ND(e)?new Ybe(t):new Zbe(t,{allowProjection:e!==H.Fragment}),Jbe=N0e({...__e,...Bbe,...kbe,...Vbe},Xbe),Qbe=Zve(Jbe);function qA({className:e,...t}){return u.jsx("div",{className:Wt("animate-pulse rounded-md bg-primary/10",e),...t})}const jS=({name:e,icon:t,value:r,color:n,loading:a,statuses:l=[]})=>u.jsx(Qbe.div,{className:"bg-card shadow-sm border border-border overflow-hidden rounded-xl",children:a?u.jsx(qA,{className:"h-[100px]"}):u.jsxs("div",{className:"md:px-4 md:py-5 p-6",children:[u.jsxs("span",{className:"flex items-center justify-between text-xs text-muted-foreground ",children:[e,u.jsx(t,{size:20,className:"mr-3 text-accent-foreground"})]}),u.jsx("p",{className:"mt-1 text-3xl md:text-4xl tracking-tight font-bold ",children:r}),l.length>0&&u.jsx("div",{className:"space-x-2 mt-2",children:l.map((f,i)=>u.jsx("span",{className:" text-xs py-1 px-2 rounded-md",style:{color:f.color,backgroundColor:f.bgColor},children:f.label},i))})]})});var pk,CV;function Bc(){if(CV)return pk;CV=1;var e=Array.isArray;return pk=e,pk}var mk,EV;function gX(){if(EV)return mk;EV=1;var e=typeof yS=="object"&&yS&&yS.Object===Object&&yS;return mk=e,mk}var gk,kV;function ip(){if(kV)return gk;kV=1;var e=gX(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return gk=r,gk}var yk,MV;function Qw(){if(MV)return yk;MV=1;var e=ip(),t=e.Symbol;return yk=t,yk}var vk,jV;function e1e(){if(jV)return vk;jV=1;var e=Qw(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function l(f){var i=r.call(f,a),_=f[a];try{f[a]=void 0;var w=!0}catch{}var A=n.call(f);return w&&(i?f[a]=_:delete f[a]),A}return vk=l,vk}var xk,OV;function t1e(){if(OV)return xk;OV=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return xk=r,xk}var _k,NV;function bm(){if(NV)return _k;NV=1;var e=Qw(),t=e1e(),r=t1e(),n="[object Null]",a="[object Undefined]",l=e?e.toStringTag:void 0;function f(i){return i==null?i===void 0?a:n:l&&l in Object(i)?t(i):r(i)}return _k=f,_k}var bk,RV;function wm(){if(RV)return bk;RV=1;function e(t){return t!=null&&typeof t=="object"}return bk=e,bk}var wk,IV;function S_(){if(IV)return wk;IV=1;var e=bm(),t=wm(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return wk=n,wk}var Sk,DV;function WD(){if(DV)return Sk;DV=1;var e=Bc(),t=S_(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(l,f){if(e(l))return!1;var i=typeof l;return i=="number"||i=="symbol"||i=="boolean"||l==null||t(l)?!0:n.test(l)||!r.test(l)||f!=null&&l in Object(f)}return Sk=a,Sk}var Ak,LV;function ey(){if(LV)return Ak;LV=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return Ak=e,Ak}var Tk,zV;function HD(){if(zV)return Tk;zV=1;var e=bm(),t=ey(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",l="[object Proxy]";function f(i){if(!t(i))return!1;var _=e(i);return _==n||_==a||_==r||_==l}return Tk=f,Tk}var Pk,FV;function r1e(){if(FV)return Pk;FV=1;var e=ip(),t=e["__core-js_shared__"];return Pk=t,Pk}var Ck,BV;function n1e(){if(BV)return Ck;BV=1;var e=r1e(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return Ck=r,Ck}var Ek,VV;function yX(){if(VV)return Ek;VV=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return Ek=r,Ek}var kk,UV;function i1e(){if(UV)return kk;UV=1;var e=HD(),t=n1e(),r=ey(),n=yX(),a=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,f=Function.prototype,i=Object.prototype,_=f.toString,w=i.hasOwnProperty,A=RegExp("^"+_.call(w).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function E(O){if(!r(O)||t(O))return!1;var F=e(O)?A:l;return F.test(n(O))}return kk=E,kk}var Mk,$V;function a1e(){if($V)return Mk;$V=1;function e(t,r){return t==null?void 0:t[r]}return Mk=e,Mk}var jk,qV;function Xv(){if(qV)return jk;qV=1;var e=i1e(),t=a1e();function r(n,a){var l=t(n,a);return e(l)?l:void 0}return jk=r,jk}var Ok,GV;function kP(){if(GV)return Ok;GV=1;var e=Xv(),t=e(Object,"create");return Ok=t,Ok}var Nk,WV;function s1e(){if(WV)return Nk;WV=1;var e=kP();function t(){this.__data__=e?e(null):{},this.size=0}return Nk=t,Nk}var Rk,HV;function o1e(){if(HV)return Rk;HV=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return Rk=e,Rk}var Ik,KV;function l1e(){if(KV)return Ik;KV=1;var e=kP(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(l){var f=this.__data__;if(e){var i=f[l];return i===t?void 0:i}return n.call(f,l)?f[l]:void 0}return Ik=a,Ik}var Dk,ZV;function c1e(){if(ZV)return Dk;ZV=1;var e=kP(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var l=this.__data__;return e?l[a]!==void 0:r.call(l,a)}return Dk=n,Dk}var Lk,YV;function u1e(){if(YV)return Lk;YV=1;var e=kP(),t="__lodash_hash_undefined__";function r(n,a){var l=this.__data__;return this.size+=this.has(n)?0:1,l[n]=e&&a===void 0?t:a,this}return Lk=r,Lk}var zk,XV;function d1e(){if(XV)return zk;XV=1;var e=s1e(),t=o1e(),r=l1e(),n=c1e(),a=u1e();function l(f){var i=-1,_=f==null?0:f.length;for(this.clear();++i<_;){var w=f[i];this.set(w[0],w[1])}}return l.prototype.clear=e,l.prototype.delete=t,l.prototype.get=r,l.prototype.has=n,l.prototype.set=a,zk=l,zk}var Fk,JV;function h1e(){if(JV)return Fk;JV=1;function e(){this.__data__=[],this.size=0}return Fk=e,Fk}var Bk,QV;function KD(){if(QV)return Bk;QV=1;function e(t,r){return t===r||t!==t&&r!==r}return Bk=e,Bk}var Vk,eU;function MP(){if(eU)return Vk;eU=1;var e=KD();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return Vk=t,Vk}var Uk,tU;function f1e(){if(tU)return Uk;tU=1;var e=MP(),t=Array.prototype,r=t.splice;function n(a){var l=this.__data__,f=e(l,a);if(f<0)return!1;var i=l.length-1;return f==i?l.pop():r.call(l,f,1),--this.size,!0}return Uk=n,Uk}var $k,rU;function p1e(){if(rU)return $k;rU=1;var e=MP();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return $k=t,$k}var qk,nU;function m1e(){if(nU)return qk;nU=1;var e=MP();function t(r){return e(this.__data__,r)>-1}return qk=t,qk}var Gk,iU;function g1e(){if(iU)return Gk;iU=1;var e=MP();function t(r,n){var a=this.__data__,l=e(a,r);return l<0?(++this.size,a.push([r,n])):a[l][1]=n,this}return Gk=t,Gk}var Wk,aU;function jP(){if(aU)return Wk;aU=1;var e=h1e(),t=f1e(),r=p1e(),n=m1e(),a=g1e();function l(f){var i=-1,_=f==null?0:f.length;for(this.clear();++i<_;){var w=f[i];this.set(w[0],w[1])}}return l.prototype.clear=e,l.prototype.delete=t,l.prototype.get=r,l.prototype.has=n,l.prototype.set=a,Wk=l,Wk}var Hk,sU;function ZD(){if(sU)return Hk;sU=1;var e=Xv(),t=ip(),r=e(t,"Map");return Hk=r,Hk}var Kk,oU;function y1e(){if(oU)return Kk;oU=1;var e=d1e(),t=jP(),r=ZD();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return Kk=n,Kk}var Zk,lU;function v1e(){if(lU)return Zk;lU=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return Zk=e,Zk}var Yk,cU;function OP(){if(cU)return Yk;cU=1;var e=v1e();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return Yk=t,Yk}var Xk,uU;function x1e(){if(uU)return Xk;uU=1;var e=OP();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return Xk=t,Xk}var Jk,dU;function _1e(){if(dU)return Jk;dU=1;var e=OP();function t(r){return e(this,r).get(r)}return Jk=t,Jk}var Qk,hU;function b1e(){if(hU)return Qk;hU=1;var e=OP();function t(r){return e(this,r).has(r)}return Qk=t,Qk}var eM,fU;function w1e(){if(fU)return eM;fU=1;var e=OP();function t(r,n){var a=e(this,r),l=a.size;return a.set(r,n),this.size+=a.size==l?0:1,this}return eM=t,eM}var tM,pU;function YD(){if(pU)return tM;pU=1;var e=y1e(),t=x1e(),r=_1e(),n=b1e(),a=w1e();function l(f){var i=-1,_=f==null?0:f.length;for(this.clear();++i<_;){var w=f[i];this.set(w[0],w[1])}}return l.prototype.clear=e,l.prototype.delete=t,l.prototype.get=r,l.prototype.has=n,l.prototype.set=a,tM=l,tM}var rM,mU;function vX(){if(mU)return rM;mU=1;var e=YD(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var l=function(){var f=arguments,i=a?a.apply(this,f):f[0],_=l.cache;if(_.has(i))return _.get(i);var w=n.apply(this,f);return l.cache=_.set(i,w)||_,w};return l.cache=new(r.Cache||e),l}return r.Cache=e,rM=r,rM}var nM,gU;function S1e(){if(gU)return nM;gU=1;var e=vX(),t=500;function r(n){var a=e(n,function(f){return l.size===t&&l.clear(),f}),l=a.cache;return a}return nM=r,nM}var iM,yU;function A1e(){if(yU)return iM;yU=1;var e=S1e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var l=[];return a.charCodeAt(0)===46&&l.push(""),a.replace(t,function(f,i,_,w){l.push(_?w.replace(r,"$1"):i||f)}),l});return iM=n,iM}var aM,vU;function XD(){if(vU)return aM;vU=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,l=Array(a);++n<a;)l[n]=r(t[n],n,t);return l}return aM=e,aM}var sM,xU;function T1e(){if(xU)return sM;xU=1;var e=Qw(),t=XD(),r=Bc(),n=S_(),a=e?e.prototype:void 0,l=a?a.toString:void 0;function f(i){if(typeof i=="string")return i;if(r(i))return t(i,f)+"";if(n(i))return l?l.call(i):"";var _=i+"";return _=="0"&&1/i==-1/0?"-0":_}return sM=f,sM}var oM,_U;function xX(){if(_U)return oM;_U=1;var e=T1e();function t(r){return r==null?"":e(r)}return oM=t,oM}var lM,bU;function _X(){if(bU)return lM;bU=1;var e=Bc(),t=WD(),r=A1e(),n=xX();function a(l,f){return e(l)?l:t(l,f)?[l]:r(n(l))}return lM=a,lM}var cM,wU;function NP(){if(wU)return cM;wU=1;var e=S_();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return cM=t,cM}var uM,SU;function JD(){if(SU)return uM;SU=1;var e=_X(),t=NP();function r(n,a){a=e(a,n);for(var l=0,f=a.length;n!=null&&l<f;)n=n[t(a[l++])];return l&&l==f?n:void 0}return uM=r,uM}var dM,AU;function bX(){if(AU)return dM;AU=1;var e=JD();function t(r,n,a){var l=r==null?void 0:e(r,n);return l===void 0?a:l}return dM=t,dM}var P1e=bX();const wu=oa(P1e);var hM,TU;function C1e(){if(TU)return hM;TU=1;function e(t){return t==null}return hM=e,hM}var E1e=C1e();const Yn=oa(E1e);var fM,PU;function k1e(){if(PU)return fM;PU=1;var e=bm(),t=Bc(),r=wm(),n="[object String]";function a(l){return typeof l=="string"||!t(l)&&r(l)&&e(l)==n}return fM=a,fM}var M1e=k1e();const e2=oa(M1e);var j1e=HD();const $n=oa(j1e);var O1e=ey();const A_=oa(O1e);var pM={exports:{}},va={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CU;function N1e(){if(CU)return va;CU=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),f=Symbol.for("react.context"),i=Symbol.for("react.server_context"),_=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),F=Symbol.for("react.offscreen"),U;U=Symbol.for("react.module.reference");function B(q){if(typeof q=="object"&&q!==null){var W=q.$$typeof;switch(W){case e:switch(q=q.type,q){case r:case a:case n:case w:case A:return q;default:switch(q=q&&q.$$typeof,q){case i:case f:case _:case O:case E:case l:return q;default:return W}}case t:return W}}}return va.ContextConsumer=f,va.ContextProvider=l,va.Element=e,va.ForwardRef=_,va.Fragment=r,va.Lazy=O,va.Memo=E,va.Portal=t,va.Profiler=a,va.StrictMode=n,va.Suspense=w,va.SuspenseList=A,va.isAsyncMode=function(){return!1},va.isConcurrentMode=function(){return!1},va.isContextConsumer=function(q){return B(q)===f},va.isContextProvider=function(q){return B(q)===l},va.isElement=function(q){return typeof q=="object"&&q!==null&&q.$$typeof===e},va.isForwardRef=function(q){return B(q)===_},va.isFragment=function(q){return B(q)===r},va.isLazy=function(q){return B(q)===O},va.isMemo=function(q){return B(q)===E},va.isPortal=function(q){return B(q)===t},va.isProfiler=function(q){return B(q)===a},va.isStrictMode=function(q){return B(q)===n},va.isSuspense=function(q){return B(q)===w},va.isSuspenseList=function(q){return B(q)===A},va.isValidElementType=function(q){return typeof q=="string"||typeof q=="function"||q===r||q===a||q===n||q===w||q===A||q===F||typeof q=="object"&&q!==null&&(q.$$typeof===O||q.$$typeof===E||q.$$typeof===l||q.$$typeof===f||q.$$typeof===_||q.$$typeof===U||q.getModuleId!==void 0)},va.typeOf=B,va}var EU;function R1e(){return EU||(EU=1,pM.exports=N1e()),pM.exports}var I1e=R1e(),mM,kU;function wX(){if(kU)return mM;kU=1;var e=bm(),t=wm(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return mM=n,mM}var gM,MU;function D1e(){if(MU)return gM;MU=1;var e=wX();function t(r){return e(r)&&r!=+r}return gM=t,gM}var L1e=D1e();const T_=oa(L1e);var z1e=wX();const F1e=oa(z1e);var rl=function(t){return t===0?0:t>0?1:-1},_v=function(t){return e2(t)&&t.indexOf("%")===t.length-1},Dr=function(t){return F1e(t)&&!T_(t)},Ro=function(t){return Dr(t)||e2(t)},B1e=0,ty=function(t){var r=++B1e;return"".concat(t||"").concat(r)},sc=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Dr(t)&&!e2(t))return n;var l;if(_v(t)){var f=t.indexOf("%");l=r*parseFloat(t.slice(0,f))/100}else l=+t;return T_(l)&&(l=n),a&&l>r&&(l=r),l},kg=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},V1e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Za=function(t,r){return Dr(t)&&Dr(r)?function(n){return t+n*(r-t)}:function(){return r}};function GA(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):wu(n,t))===r})}var U1e=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,l=0,f=0,i=1/0,_=-1/0,w=0,A=0,E=0;E<r;E++)w=t[E].cx||0,A=t[E].cy||0,n+=w,a+=A,l+=w*A,f+=w*w,i=Math.min(i,w),_=Math.max(_,w);var O=r*f!==n*n?(r*l-n*a)/(r*f-n*n):0;return{xmin:i,xmax:_,a:O,b:(a-O*n)/r}};function yx(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function AR(e){"@babel/helpers - typeof";return AR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AR(e)}var $1e=["viewBox","children"],q1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],jU=["points","pathLength"],yM={svg:$1e,polygon:jU,polyline:jU},QD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],WA=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(H.isValidElement(t)&&(n=t.props),!A_(n))return null;var a={};return Object.keys(n).forEach(function(l){QD.includes(l)&&(a[l]=r||function(f){return n[l](n,f)})}),a},G1e=function(t,r,n){return function(a){return t(r,n,a),null}},Yf=function(t,r,n){if(!A_(t)||AR(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(l){var f=t[l];QD.includes(l)&&typeof f=="function"&&(a||(a={}),a[l]=G1e(f,r,n))}),a},W1e=["children"],H1e=["children"];function OU(e,t){if(e==null)return{};var r=K1e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function K1e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function TR(e){"@babel/helpers - typeof";return TR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},TR(e)}var NU={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},lm=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},RU=null,vM=null,eL=function e(t){if(t===RU&&Array.isArray(vM))return vM;var r=[];return H.Children.forEach(t,function(n){Yn(n)||(I1e.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),vM=r,RU=t,r};function Vl(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return lm(a)}):n=[lm(t)],eL(e).forEach(function(a){var l=wu(a,"type.displayName")||wu(a,"type.name");n.indexOf(l)!==-1&&r.push(a)}),r}function pu(e,t){var r=Vl(e,t);return r&&r[0]}var IU=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Dr(n)||n<=0||!Dr(a)||a<=0)},Z1e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Y1e=function(t){return t&&t.type&&e2(t.type)&&Z1e.indexOf(t.type)>=0},SX=function(t){return t&&TR(t)==="object"&&"clipDot"in t},X1e=function(t,r,n,a){var l,f=(l=yM==null?void 0:yM[a])!==null&&l!==void 0?l:[];return!$n(t)&&(a&&f.includes(r)||q1e.includes(r))||n&&QD.includes(r)},yn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(H.isValidElement(t)&&(a=t.props),!A_(a))return null;var l={};return Object.keys(a).forEach(function(f){var i;X1e((i=a)===null||i===void 0?void 0:i[f],f,r,n)&&(l[f]=a[f])}),l},PR=function e(t,r){if(t===r)return!0;var n=H.Children.count(t);if(n!==H.Children.count(r))return!1;if(n===0)return!0;if(n===1)return DU(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var l=t[a],f=r[a];if(Array.isArray(l)||Array.isArray(f)){if(!e(l,f))return!1}else if(!DU(l,f))return!1}return!0},DU=function(t,r){if(Yn(t)&&Yn(r))return!0;if(!Yn(t)&&!Yn(r)){var n=t.props||{},a=n.children,l=OU(n,W1e),f=r.props||{},i=f.children,_=OU(f,H1e);return a&&i?yx(l,_)&&PR(a,i):!a&&!i?yx(l,_):!1}return!1},LU=function(t,r){var n=[],a={};return eL(t).forEach(function(l,f){if(Y1e(l))n.push(l);else if(l){var i=lm(l.type),_=r[i]||{},w=_.handler,A=_.once;if(w&&(!A||!a[i])){var E=w(l,i,f);n.push(E),a[i]=!0}}}),n},J1e=function(t){var r=t&&t.type;return r&&NU[r]?NU[r]:null},Q1e=function(t,r){return eL(r).indexOf(t)},ewe=["children","width","height","viewBox","className","style","title","desc"];function CR(){return CR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CR.apply(this,arguments)}function twe(e,t){if(e==null)return{};var r=rwe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ER(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,l=e.className,f=e.style,i=e.title,_=e.desc,w=twe(e,ewe),A=a||{width:r,height:n,x:0,y:0},E=hi("recharts-surface",l);return Re.createElement("svg",CR({},yn(w,!0,"svg"),{className:E,width:r,height:n,style:f,viewBox:"".concat(A.x," ").concat(A.y," ").concat(A.width," ").concat(A.height)}),Re.createElement("title",null,i),Re.createElement("desc",null,_),t)}var nwe=["children","className"];function kR(){return kR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kR.apply(this,arguments)}function iwe(e,t){if(e==null)return{};var r=awe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function awe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var pi=Re.forwardRef(function(e,t){var r=e.children,n=e.className,a=iwe(e,nwe),l=hi("recharts-layer",n);return Re.createElement("g",kR({className:l},yn(a,!0),{ref:t}),r)}),kh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l]},xM,zU;function swe(){if(zU)return xM;zU=1;function e(t,r,n){var a=-1,l=t.length;r<0&&(r=-r>l?0:l+r),n=n>l?l:n,n<0&&(n+=l),l=r>n?0:n-r>>>0,r>>>=0;for(var f=Array(l);++a<l;)f[a]=t[a+r];return f}return xM=e,xM}var _M,FU;function owe(){if(FU)return _M;FU=1;var e=swe();function t(r,n,a){var l=r.length;return a=a===void 0?l:a,!n&&a>=l?r:e(r,n,a)}return _M=t,_M}var bM,BU;function AX(){if(BU)return bM;BU=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,l="\\ufe0e\\ufe0f",f="\\u200d",i=RegExp("["+f+e+a+l+"]");function _(w){return i.test(w)}return bM=_,bM}var wM,VU;function lwe(){if(VU)return wM;VU=1;function e(t){return t.split("")}return wM=e,wM}var SM,UU;function cwe(){if(UU)return SM;UU=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,l="\\ufe0e\\ufe0f",f="["+e+"]",i="["+a+"]",_="\\ud83c[\\udffb-\\udfff]",w="(?:"+i+"|"+_+")",A="[^"+e+"]",E="(?:\\ud83c[\\udde6-\\uddff]){2}",O="[\\ud800-\\udbff][\\udc00-\\udfff]",F="\\u200d",U=w+"?",B="["+l+"]?",q="(?:"+F+"(?:"+[A,E,O].join("|")+")"+B+U+")*",W=B+U+q,Z="(?:"+[A+i+"?",i,E,O,f].join("|")+")",ne=RegExp(_+"(?="+_+")|"+Z+W,"g");function ae(ee){return ee.match(ne)||[]}return SM=ae,SM}var AM,$U;function uwe(){if($U)return AM;$U=1;var e=lwe(),t=AX(),r=cwe();function n(a){return t(a)?r(a):e(a)}return AM=n,AM}var TM,qU;function dwe(){if(qU)return TM;qU=1;var e=owe(),t=AX(),r=uwe(),n=xX();function a(l){return function(f){f=n(f);var i=t(f)?r(f):void 0,_=i?i[0]:f.charAt(0),w=i?e(i,1).join(""):f.slice(1);return _[l]()+w}}return TM=a,TM}var PM,GU;function hwe(){if(GU)return PM;GU=1;var e=dwe(),t=e("toUpperCase");return PM=t,PM}var fwe=hwe();const RP=oa(fwe);function Ka(e){return function(){return e}}const TX=Math.cos,HA=Math.sin,Gh=Math.sqrt,KA=Math.PI,IP=2*KA,MR=Math.PI,jR=2*MR,cv=1e-6,pwe=jR-cv;function PX(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function mwe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return PX;const r=10**t;return function(n){this._+=n[0];for(let a=1,l=n.length;a<l;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class gwe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?PX:mwe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,l,f){this._append`C${+t},${+r},${+n},${+a},${this._x1=+l},${this._y1=+f}`}arcTo(t,r,n,a,l){if(t=+t,r=+r,n=+n,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let f=this._x1,i=this._y1,_=n-t,w=a-r,A=f-t,E=i-r,O=A*A+E*E;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(O>cv)if(!(Math.abs(E*_-w*A)>cv)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let F=n-f,U=a-i,B=_*_+w*w,q=F*F+U*U,W=Math.sqrt(B),Z=Math.sqrt(O),ne=l*Math.tan((MR-Math.acos((B+O-q)/(2*W*Z)))/2),ae=ne/Z,ee=ne/W;Math.abs(ae-1)>cv&&this._append`L${t+ae*A},${r+ae*E}`,this._append`A${l},${l},0,0,${+(E*F>A*U)},${this._x1=t+ee*_},${this._y1=r+ee*w}`}}arc(t,r,n,a,l,f){if(t=+t,r=+r,n=+n,f=!!f,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),_=n*Math.sin(a),w=t+i,A=r+_,E=1^f,O=f?a-l:l-a;this._x1===null?this._append`M${w},${A}`:(Math.abs(this._x1-w)>cv||Math.abs(this._y1-A)>cv)&&this._append`L${w},${A}`,n&&(O<0&&(O=O%jR+jR),O>pwe?this._append`A${n},${n},0,1,${E},${t-i},${r-_}A${n},${n},0,1,${E},${this._x1=w},${this._y1=A}`:O>cv&&this._append`A${n},${n},0,${+(O>=MR)},${E},${this._x1=t+n*Math.cos(l)},${this._y1=r+n*Math.sin(l)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function tL(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new gwe(t)}function rL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CX(e){this._context=e}CX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function DP(e){return new CX(e)}function EX(e){return e[0]}function kX(e){return e[1]}function MX(e,t){var r=Ka(!0),n=null,a=DP,l=null,f=tL(i);e=typeof e=="function"?e:e===void 0?EX:Ka(e),t=typeof t=="function"?t:t===void 0?kX:Ka(t);function i(_){var w,A=(_=rL(_)).length,E,O=!1,F;for(n==null&&(l=a(F=f())),w=0;w<=A;++w)!(w<A&&r(E=_[w],w,_))===O&&((O=!O)?l.lineStart():l.lineEnd()),O&&l.point(+e(E,w,_),+t(E,w,_));if(F)return l=null,F+""||null}return i.x=function(_){return arguments.length?(e=typeof _=="function"?_:Ka(+_),i):e},i.y=function(_){return arguments.length?(t=typeof _=="function"?_:Ka(+_),i):t},i.defined=function(_){return arguments.length?(r=typeof _=="function"?_:Ka(!!_),i):r},i.curve=function(_){return arguments.length?(a=_,n!=null&&(l=a(n)),i):a},i.context=function(_){return arguments.length?(_==null?n=l=null:l=a(n=_),i):n},i}function OS(e,t,r){var n=null,a=Ka(!0),l=null,f=DP,i=null,_=tL(w);e=typeof e=="function"?e:e===void 0?EX:Ka(+e),t=typeof t=="function"?t:Ka(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?kX:Ka(+r);function w(E){var O,F,U,B=(E=rL(E)).length,q,W=!1,Z,ne=new Array(B),ae=new Array(B);for(l==null&&(i=f(Z=_())),O=0;O<=B;++O){if(!(O<B&&a(q=E[O],O,E))===W)if(W=!W)F=O,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),U=O-1;U>=F;--U)i.point(ne[U],ae[U]);i.lineEnd(),i.areaEnd()}W&&(ne[O]=+e(q,O,E),ae[O]=+t(q,O,E),i.point(n?+n(q,O,E):ne[O],r?+r(q,O,E):ae[O]))}if(Z)return i=null,Z+""||null}function A(){return MX().defined(a).curve(f).context(l)}return w.x=function(E){return arguments.length?(e=typeof E=="function"?E:Ka(+E),n=null,w):e},w.x0=function(E){return arguments.length?(e=typeof E=="function"?E:Ka(+E),w):e},w.x1=function(E){return arguments.length?(n=E==null?null:typeof E=="function"?E:Ka(+E),w):n},w.y=function(E){return arguments.length?(t=typeof E=="function"?E:Ka(+E),r=null,w):t},w.y0=function(E){return arguments.length?(t=typeof E=="function"?E:Ka(+E),w):t},w.y1=function(E){return arguments.length?(r=E==null?null:typeof E=="function"?E:Ka(+E),w):r},w.lineX0=w.lineY0=function(){return A().x(e).y(t)},w.lineY1=function(){return A().x(e).y(r)},w.lineX1=function(){return A().x(n).y(t)},w.defined=function(E){return arguments.length?(a=typeof E=="function"?E:Ka(!!E),w):a},w.curve=function(E){return arguments.length?(f=E,l!=null&&(i=f(l)),w):f},w.context=function(E){return arguments.length?(E==null?l=i=null:i=f(l=E),w):l},w}class jX{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function ywe(e){return new jX(e,!0)}function vwe(e){return new jX(e,!1)}const nL={draw(e,t){const r=Gh(t/KA);e.moveTo(r,0),e.arc(0,0,r,0,IP)}},xwe={draw(e,t){const r=Gh(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},OX=Gh(1/3),_we=OX*2,bwe={draw(e,t){const r=Gh(t/_we),n=r*OX;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},wwe={draw(e,t){const r=Gh(t),n=-r/2;e.rect(n,n,r,r)}},Swe=.8908130915292852,NX=HA(KA/10)/HA(7*KA/10),Awe=HA(IP/10)*NX,Twe=-TX(IP/10)*NX,Pwe={draw(e,t){const r=Gh(t*Swe),n=Awe*r,a=Twe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let l=1;l<5;++l){const f=IP*l/5,i=TX(f),_=HA(f);e.lineTo(_*r,-i*r),e.lineTo(i*n-_*a,_*n+i*a)}e.closePath()}},CM=Gh(3),Cwe={draw(e,t){const r=-Gh(t/(CM*3));e.moveTo(0,r*2),e.lineTo(-CM*r,-r),e.lineTo(CM*r,-r),e.closePath()}},hd=-.5,fd=Gh(3)/2,OR=1/Gh(12),Ewe=(OR/2+1)*3,kwe={draw(e,t){const r=Gh(t/Ewe),n=r/2,a=r*OR,l=n,f=r*OR+r,i=-l,_=f;e.moveTo(n,a),e.lineTo(l,f),e.lineTo(i,_),e.lineTo(hd*n-fd*a,fd*n+hd*a),e.lineTo(hd*l-fd*f,fd*l+hd*f),e.lineTo(hd*i-fd*_,fd*i+hd*_),e.lineTo(hd*n+fd*a,hd*a-fd*n),e.lineTo(hd*l+fd*f,hd*f-fd*l),e.lineTo(hd*i+fd*_,hd*_-fd*i),e.closePath()}};function Mwe(e,t){let r=null,n=tL(a);e=typeof e=="function"?e:Ka(e||nL),t=typeof t=="function"?t:Ka(t===void 0?64:+t);function a(){let l;if(r||(r=l=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:Ka(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:Ka(+l),a):t},a.context=function(l){return arguments.length?(r=l??null,a):r},a}function ZA(){}function YA(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function RX(e){this._context=e}RX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:YA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:YA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jwe(e){return new RX(e)}function IX(e){this._context=e}IX.prototype={areaStart:ZA,areaEnd:ZA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:YA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Owe(e){return new IX(e)}function DX(e){this._context=e}DX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:YA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Nwe(e){return new DX(e)}function LX(e){this._context=e}LX.prototype={areaStart:ZA,areaEnd:ZA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Rwe(e){return new LX(e)}function WU(e){return e<0?-1:1}function HU(e,t,r){var n=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(n||a<0&&-0),f=(r-e._y1)/(a||n<0&&-0),i=(l*a+f*n)/(n+a);return(WU(l)+WU(f))*Math.min(Math.abs(l),Math.abs(f),.5*Math.abs(i))||0}function KU(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function EM(e,t,r){var n=e._x0,a=e._y0,l=e._x1,f=e._y1,i=(l-n)/3;e._context.bezierCurveTo(n+i,a+i*t,l-i,f-i*r,l,f)}function XA(e){this._context=e}XA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:EM(this,this._t0,KU(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,EM(this,KU(this,r=HU(this,e,t)),r);break;default:EM(this,this._t0,r=HU(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function zX(e){this._context=new FX(e)}(zX.prototype=Object.create(XA.prototype)).point=function(e,t){XA.prototype.point.call(this,t,e)};function FX(e){this._context=e}FX.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,l){this._context.bezierCurveTo(t,e,n,r,l,a)}};function Iwe(e){return new XA(e)}function Dwe(e){return new zX(e)}function BX(e){this._context=e}BX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=ZU(e),a=ZU(t),l=0,f=1;f<r;++l,++f)this._context.bezierCurveTo(n[0][l],a[0][l],n[1][l],a[1][l],e[f],t[f]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ZU(e){var t,r=e.length-1,n,a=new Array(r),l=new Array(r),f=new Array(r);for(a[0]=0,l[0]=2,f[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,l[t]=4,f[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,l[r-1]=7,f[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/l[t-1],l[t]-=n,f[t]-=n*f[t-1];for(a[r-1]=f[r-1]/l[r-1],t=r-2;t>=0;--t)a[t]=(f[t]-a[t+1])/l[t];for(l[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function Lwe(e){return new BX(e)}function LP(e,t){this._context=e,this._t=t}LP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function zwe(e){return new LP(e,.5)}function Fwe(e){return new LP(e,0)}function Bwe(e){return new LP(e,1)}function Mx(e,t){if((f=e.length)>1)for(var r=1,n,a,l=e[t[0]],f,i=l.length;r<f;++r)for(a=l,l=e[t[r]],n=0;n<i;++n)l[n][1]+=l[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function NR(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Vwe(e,t){return e[t]}function Uwe(e){const t=[];return t.key=e,t}function $we(){var e=Ka([]),t=NR,r=Mx,n=Vwe;function a(l){var f=Array.from(e.apply(this,arguments),Uwe),i,_=f.length,w=-1,A;for(const E of l)for(i=0,++w;i<_;++i)(f[i][w]=[0,+n(E,f[i].key,w,l)]).data=E;for(i=0,A=rL(t(f));i<_;++i)f[A[i]].index=i;return r(f,A),f}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:Ka(Array.from(l)),a):e},a.value=function(l){return arguments.length?(n=typeof l=="function"?l:Ka(+l),a):n},a.order=function(l){return arguments.length?(t=l==null?NR:typeof l=="function"?l:Ka(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(r=l??Mx,a):r},a}function qwe(e,t){if((n=e.length)>0){for(var r,n,a=0,l=e[0].length,f;a<l;++a){for(f=r=0;r<n;++r)f+=e[r][a][1]||0;if(f)for(r=0;r<n;++r)e[r][a][1]/=f}Mx(e,t)}}function Gwe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,l=n.length;r<l;++r){for(var f=0,i=0;f<a;++f)i+=e[f][r][1]||0;n[r][1]+=n[r][0]=-i/2}Mx(e,t)}}function Wwe(e,t){if(!(!((f=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,l,f;n<l;++n){for(var i=0,_=0,w=0;i<f;++i){for(var A=e[t[i]],E=A[n][1]||0,O=A[n-1][1]||0,F=(E-O)/2,U=0;U<i;++U){var B=e[t[U]],q=B[n][1]||0,W=B[n-1][1]||0;F+=q-W}_+=E,w+=F*E}a[n-1][1]+=a[n-1][0]=r,_&&(r-=w/_)}a[n-1][1]+=a[n-1][0]=r,Mx(e,t)}}function H1(e){"@babel/helpers - typeof";return H1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H1(e)}var Hwe=["type","size","sizeType"];function RR(){return RR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RR.apply(this,arguments)}function YU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function XU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YU(Object(r),!0).forEach(function(n){Kwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kwe(e,t,r){return t=Zwe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zwe(e){var t=Ywe(e,"string");return H1(t)=="symbol"?t:t+""}function Ywe(e,t){if(H1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(H1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xwe(e,t){if(e==null)return{};var r=Jwe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Jwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var VX={symbolCircle:nL,symbolCross:xwe,symbolDiamond:bwe,symbolSquare:wwe,symbolStar:Pwe,symbolTriangle:Cwe,symbolWye:kwe},Qwe=Math.PI/180,e2e=function(t){var r="symbol".concat(RP(t));return VX[r]||nL},t2e=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*Qwe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},r2e=function(t,r){VX["symbol".concat(RP(t))]=r},zP=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,l=a===void 0?64:a,f=t.sizeType,i=f===void 0?"area":f,_=Xwe(t,Hwe),w=XU(XU({},_),{},{type:n,size:l,sizeType:i}),A=function(){var q=e2e(n),W=Mwe().type(q).size(t2e(l,i,n));return W()},E=w.className,O=w.cx,F=w.cy,U=yn(w,!0);return O===+O&&F===+F&&l===+l?Re.createElement("path",RR({},U,{className:hi("recharts-symbols",E),transform:"translate(".concat(O,", ").concat(F,")"),d:A()})):null};zP.registerSymbol=r2e;function jx(e){"@babel/helpers - typeof";return jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jx(e)}function IR(){return IR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IR.apply(this,arguments)}function JU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JU(Object(r),!0).forEach(function(n){K1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a2e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$X(n.key),n)}}function s2e(e,t,r){return t&&a2e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o2e(e,t,r){return t=JA(t),l2e(e,UX()?Reflect.construct(t,r||[],JA(e).constructor):t.apply(e,r))}function l2e(e,t){if(t&&(jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c2e(e)}function c2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UX=function(){return!!e})()}function JA(e){return JA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JA(e)}function u2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DR(e,t)}function DR(e,t){return DR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},DR(e,t)}function K1(e,t,r){return t=$X(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $X(e){var t=d2e(e,"string");return jx(t)=="symbol"?t:t+""}function d2e(e,t){if(jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xh=32,iL=function(e){function t(){return i2e(this,t),o2e(this,t,arguments)}return u2e(t,e),s2e(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,l=xh/2,f=xh/6,i=xh/3,_=n.inactive?a:n.color;if(n.type==="plainline")return Re.createElement("line",{strokeWidth:4,fill:"none",stroke:_,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:l,x2:xh,y2:l,className:"recharts-legend-icon"});if(n.type==="line")return Re.createElement("path",{strokeWidth:4,fill:"none",stroke:_,d:"M0,".concat(l,"h").concat(i,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(2*i,",").concat(l,`
            H`).concat(xh,"M").concat(2*i,",").concat(l,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(i,",").concat(l),className:"recharts-legend-icon"});if(n.type==="rect")return Re.createElement("path",{stroke:"none",fill:_,d:"M0,".concat(xh/8,"h").concat(xh,"v").concat(xh*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(Re.isValidElement(n.legendIcon)){var w=n2e({},n);return delete w.legendIcon,Re.cloneElement(n.legendIcon,w)}return Re.createElement(zP,{fill:_,cx:l,cy:l,size:xh,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,l=a.payload,f=a.iconSize,i=a.layout,_=a.formatter,w=a.inactiveColor,A={x:0,y:0,width:xh,height:xh},E={display:i==="horizontal"?"inline-block":"block",marginRight:10},O={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(F,U){var B=F.formatter||_,q=hi(K1(K1({"recharts-legend-item":!0},"legend-item-".concat(U),!0),"inactive",F.inactive));if(F.type==="none")return null;var W=$n(F.value)?null:F.value;kh(!$n(F.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var Z=F.inactive?w:F.color;return Re.createElement("li",IR({className:q,style:E,key:"legend-item-".concat(U)},Yf(n.props,F,U)),Re.createElement(ER,{width:f,height:f,viewBox:A,style:O},n.renderIcon(F)),Re.createElement("span",{className:"recharts-legend-item-text",style:{color:Z}},B?B(W,F,U):W))})}},{key:"render",value:function(){var n=this.props,a=n.payload,l=n.layout,f=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:l==="horizontal"?f:"left"};return Re.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(H.PureComponent);K1(iL,"displayName","Legend");K1(iL,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var kM,QU;function h2e(){if(QU)return kM;QU=1;var e=jP();function t(){this.__data__=new e,this.size=0}return kM=t,kM}var MM,e$;function f2e(){if(e$)return MM;e$=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return MM=e,MM}var jM,t$;function p2e(){if(t$)return jM;t$=1;function e(t){return this.__data__.get(t)}return jM=e,jM}var OM,r$;function m2e(){if(r$)return OM;r$=1;function e(t){return this.__data__.has(t)}return OM=e,OM}var NM,n$;function g2e(){if(n$)return NM;n$=1;var e=jP(),t=ZD(),r=YD(),n=200;function a(l,f){var i=this.__data__;if(i instanceof e){var _=i.__data__;if(!t||_.length<n-1)return _.push([l,f]),this.size=++i.size,this;i=this.__data__=new r(_)}return i.set(l,f),this.size=i.size,this}return NM=a,NM}var RM,i$;function qX(){if(i$)return RM;i$=1;var e=jP(),t=h2e(),r=f2e(),n=p2e(),a=m2e(),l=g2e();function f(i){var _=this.__data__=new e(i);this.size=_.size}return f.prototype.clear=t,f.prototype.delete=r,f.prototype.get=n,f.prototype.has=a,f.prototype.set=l,RM=f,RM}var IM,a$;function y2e(){if(a$)return IM;a$=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return IM=t,IM}var DM,s$;function v2e(){if(s$)return DM;s$=1;function e(t){return this.__data__.has(t)}return DM=e,DM}var LM,o$;function GX(){if(o$)return LM;o$=1;var e=YD(),t=y2e(),r=v2e();function n(a){var l=-1,f=a==null?0:a.length;for(this.__data__=new e;++l<f;)this.add(a[l])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,LM=n,LM}var zM,l$;function WX(){if(l$)return zM;l$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return zM=e,zM}var FM,c$;function HX(){if(c$)return FM;c$=1;function e(t,r){return t.has(r)}return FM=e,FM}var BM,u$;function KX(){if(u$)return BM;u$=1;var e=GX(),t=WX(),r=HX(),n=1,a=2;function l(f,i,_,w,A,E){var O=_&n,F=f.length,U=i.length;if(F!=U&&!(O&&U>F))return!1;var B=E.get(f),q=E.get(i);if(B&&q)return B==i&&q==f;var W=-1,Z=!0,ne=_&a?new e:void 0;for(E.set(f,i),E.set(i,f);++W<F;){var ae=f[W],ee=i[W];if(w)var se=O?w(ee,ae,W,i,f,E):w(ae,ee,W,f,i,E);if(se!==void 0){if(se)continue;Z=!1;break}if(ne){if(!t(i,function(ce,ge){if(!r(ne,ge)&&(ae===ce||A(ae,ce,_,w,E)))return ne.push(ge)})){Z=!1;break}}else if(!(ae===ee||A(ae,ee,_,w,E))){Z=!1;break}}return E.delete(f),E.delete(i),Z}return BM=l,BM}var VM,d$;function x2e(){if(d$)return VM;d$=1;var e=ip(),t=e.Uint8Array;return VM=t,VM}var UM,h$;function _2e(){if(h$)return UM;h$=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,l){n[++r]=[l,a]}),n}return UM=e,UM}var $M,f$;function aL(){if(f$)return $M;f$=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return $M=e,$M}var qM,p$;function b2e(){if(p$)return qM;p$=1;var e=Qw(),t=x2e(),r=KD(),n=KX(),a=_2e(),l=aL(),f=1,i=2,_="[object Boolean]",w="[object Date]",A="[object Error]",E="[object Map]",O="[object Number]",F="[object RegExp]",U="[object Set]",B="[object String]",q="[object Symbol]",W="[object ArrayBuffer]",Z="[object DataView]",ne=e?e.prototype:void 0,ae=ne?ne.valueOf:void 0;function ee(se,ce,ge,Te,Ae,_e,Ee){switch(ge){case Z:if(se.byteLength!=ce.byteLength||se.byteOffset!=ce.byteOffset)return!1;se=se.buffer,ce=ce.buffer;case W:return!(se.byteLength!=ce.byteLength||!_e(new t(se),new t(ce)));case _:case w:case O:return r(+se,+ce);case A:return se.name==ce.name&&se.message==ce.message;case F:case B:return se==ce+"";case E:var ke=a;case U:var Qe=Te&f;if(ke||(ke=l),se.size!=ce.size&&!Qe)return!1;var Ze=Ee.get(se);if(Ze)return Ze==ce;Te|=i,Ee.set(se,ce);var Ge=n(ke(se),ke(ce),Te,Ae,_e,Ee);return Ee.delete(se),Ge;case q:if(ae)return ae.call(se)==ae.call(ce)}return!1}return qM=ee,qM}var GM,m$;function ZX(){if(m$)return GM;m$=1;function e(t,r){for(var n=-1,a=r.length,l=t.length;++n<a;)t[l+n]=r[n];return t}return GM=e,GM}var WM,g$;function w2e(){if(g$)return WM;g$=1;var e=ZX(),t=Bc();function r(n,a,l){var f=a(n);return t(n)?f:e(f,l(n))}return WM=r,WM}var HM,y$;function S2e(){if(y$)return HM;y$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,l=0,f=[];++n<a;){var i=t[n];r(i,n,t)&&(f[l++]=i)}return f}return HM=e,HM}var KM,v$;function A2e(){if(v$)return KM;v$=1;function e(){return[]}return KM=e,KM}var ZM,x$;function T2e(){if(x$)return ZM;x$=1;var e=S2e(),t=A2e(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,l=a?function(f){return f==null?[]:(f=Object(f),e(a(f),function(i){return n.call(f,i)}))}:t;return ZM=l,ZM}var YM,_$;function P2e(){if(_$)return YM;_$=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return YM=e,YM}var XM,b$;function C2e(){if(b$)return XM;b$=1;var e=bm(),t=wm(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return XM=n,XM}var JM,w$;function sL(){if(w$)return JM;w$=1;var e=C2e(),t=wm(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,l=e(function(){return arguments}())?e:function(f){return t(f)&&n.call(f,"callee")&&!a.call(f,"callee")};return JM=l,JM}var Jb={exports:{}},QM,S$;function E2e(){if(S$)return QM;S$=1;function e(){return!1}return QM=e,QM}Jb.exports;var A$;function YX(){return A$||(A$=1,function(e,t){var r=ip(),n=E2e(),a=t&&!t.nodeType&&t,l=a&&!0&&e&&!e.nodeType&&e,f=l&&l.exports===a,i=f?r.Buffer:void 0,_=i?i.isBuffer:void 0,w=_||n;e.exports=w}(Jb,Jb.exports)),Jb.exports}var ej,T$;function oL(){if(T$)return ej;T$=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var l=typeof n;return a=a??e,!!a&&(l=="number"||l!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return ej=r,ej}var tj,P$;function lL(){if(P$)return tj;P$=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return tj=t,tj}var rj,C$;function k2e(){if(C$)return rj;C$=1;var e=bm(),t=lL(),r=wm(),n="[object Arguments]",a="[object Array]",l="[object Boolean]",f="[object Date]",i="[object Error]",_="[object Function]",w="[object Map]",A="[object Number]",E="[object Object]",O="[object RegExp]",F="[object Set]",U="[object String]",B="[object WeakMap]",q="[object ArrayBuffer]",W="[object DataView]",Z="[object Float32Array]",ne="[object Float64Array]",ae="[object Int8Array]",ee="[object Int16Array]",se="[object Int32Array]",ce="[object Uint8Array]",ge="[object Uint8ClampedArray]",Te="[object Uint16Array]",Ae="[object Uint32Array]",_e={};_e[Z]=_e[ne]=_e[ae]=_e[ee]=_e[se]=_e[ce]=_e[ge]=_e[Te]=_e[Ae]=!0,_e[n]=_e[a]=_e[q]=_e[l]=_e[W]=_e[f]=_e[i]=_e[_]=_e[w]=_e[A]=_e[E]=_e[O]=_e[F]=_e[U]=_e[B]=!1;function Ee(ke){return r(ke)&&t(ke.length)&&!!_e[e(ke)]}return rj=Ee,rj}var nj,E$;function XX(){if(E$)return nj;E$=1;function e(t){return function(r){return t(r)}}return nj=e,nj}var Qb={exports:{}};Qb.exports;var k$;function M2e(){return k$||(k$=1,function(e,t){var r=gX(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,l=a&&a.exports===n,f=l&&r.process,i=function(){try{var _=a&&a.require&&a.require("util").types;return _||f&&f.binding&&f.binding("util")}catch{}}();e.exports=i}(Qb,Qb.exports)),Qb.exports}var ij,M$;function JX(){if(M$)return ij;M$=1;var e=k2e(),t=XX(),r=M2e(),n=r&&r.isTypedArray,a=n?t(n):e;return ij=a,ij}var aj,j$;function j2e(){if(j$)return aj;j$=1;var e=P2e(),t=sL(),r=Bc(),n=YX(),a=oL(),l=JX(),f=Object.prototype,i=f.hasOwnProperty;function _(w,A){var E=r(w),O=!E&&t(w),F=!E&&!O&&n(w),U=!E&&!O&&!F&&l(w),B=E||O||F||U,q=B?e(w.length,String):[],W=q.length;for(var Z in w)(A||i.call(w,Z))&&!(B&&(Z=="length"||F&&(Z=="offset"||Z=="parent")||U&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||a(Z,W)))&&q.push(Z);return q}return aj=_,aj}var sj,O$;function O2e(){if(O$)return sj;O$=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return sj=t,sj}var oj,N$;function QX(){if(N$)return oj;N$=1;function e(t,r){return function(n){return t(r(n))}}return oj=e,oj}var lj,R$;function N2e(){if(R$)return lj;R$=1;var e=QX(),t=e(Object.keys,Object);return lj=t,lj}var cj,I$;function R2e(){if(I$)return cj;I$=1;var e=O2e(),t=N2e(),r=Object.prototype,n=r.hasOwnProperty;function a(l){if(!e(l))return t(l);var f=[];for(var i in Object(l))n.call(l,i)&&i!="constructor"&&f.push(i);return f}return cj=a,cj}var uj,D$;function t2(){if(D$)return uj;D$=1;var e=HD(),t=lL();function r(n){return n!=null&&t(n.length)&&!e(n)}return uj=r,uj}var dj,L$;function FP(){if(L$)return dj;L$=1;var e=j2e(),t=R2e(),r=t2();function n(a){return r(a)?e(a):t(a)}return dj=n,dj}var hj,z$;function I2e(){if(z$)return hj;z$=1;var e=w2e(),t=T2e(),r=FP();function n(a){return e(a,r,t)}return hj=n,hj}var fj,F$;function D2e(){if(F$)return fj;F$=1;var e=I2e(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(l,f,i,_,w,A){var E=i&t,O=e(l),F=O.length,U=e(f),B=U.length;if(F!=B&&!E)return!1;for(var q=F;q--;){var W=O[q];if(!(E?W in f:n.call(f,W)))return!1}var Z=A.get(l),ne=A.get(f);if(Z&&ne)return Z==f&&ne==l;var ae=!0;A.set(l,f),A.set(f,l);for(var ee=E;++q<F;){W=O[q];var se=l[W],ce=f[W];if(_)var ge=E?_(ce,se,W,f,l,A):_(se,ce,W,l,f,A);if(!(ge===void 0?se===ce||w(se,ce,i,_,A):ge)){ae=!1;break}ee||(ee=W=="constructor")}if(ae&&!ee){var Te=l.constructor,Ae=f.constructor;Te!=Ae&&"constructor"in l&&"constructor"in f&&!(typeof Te=="function"&&Te instanceof Te&&typeof Ae=="function"&&Ae instanceof Ae)&&(ae=!1)}return A.delete(l),A.delete(f),ae}return fj=a,fj}var pj,B$;function L2e(){if(B$)return pj;B$=1;var e=Xv(),t=ip(),r=e(t,"DataView");return pj=r,pj}var mj,V$;function z2e(){if(V$)return mj;V$=1;var e=Xv(),t=ip(),r=e(t,"Promise");return mj=r,mj}var gj,U$;function eJ(){if(U$)return gj;U$=1;var e=Xv(),t=ip(),r=e(t,"Set");return gj=r,gj}var yj,$$;function F2e(){if($$)return yj;$$=1;var e=Xv(),t=ip(),r=e(t,"WeakMap");return yj=r,yj}var vj,q$;function B2e(){if(q$)return vj;q$=1;var e=L2e(),t=ZD(),r=z2e(),n=eJ(),a=F2e(),l=bm(),f=yX(),i="[object Map]",_="[object Object]",w="[object Promise]",A="[object Set]",E="[object WeakMap]",O="[object DataView]",F=f(e),U=f(t),B=f(r),q=f(n),W=f(a),Z=l;return(e&&Z(new e(new ArrayBuffer(1)))!=O||t&&Z(new t)!=i||r&&Z(r.resolve())!=w||n&&Z(new n)!=A||a&&Z(new a)!=E)&&(Z=function(ne){var ae=l(ne),ee=ae==_?ne.constructor:void 0,se=ee?f(ee):"";if(se)switch(se){case F:return O;case U:return i;case B:return w;case q:return A;case W:return E}return ae}),vj=Z,vj}var xj,G$;function V2e(){if(G$)return xj;G$=1;var e=qX(),t=KX(),r=b2e(),n=D2e(),a=B2e(),l=Bc(),f=YX(),i=JX(),_=1,w="[object Arguments]",A="[object Array]",E="[object Object]",O=Object.prototype,F=O.hasOwnProperty;function U(B,q,W,Z,ne,ae){var ee=l(B),se=l(q),ce=ee?A:a(B),ge=se?A:a(q);ce=ce==w?E:ce,ge=ge==w?E:ge;var Te=ce==E,Ae=ge==E,_e=ce==ge;if(_e&&f(B)){if(!f(q))return!1;ee=!0,Te=!1}if(_e&&!Te)return ae||(ae=new e),ee||i(B)?t(B,q,W,Z,ne,ae):r(B,q,ce,W,Z,ne,ae);if(!(W&_)){var Ee=Te&&F.call(B,"__wrapped__"),ke=Ae&&F.call(q,"__wrapped__");if(Ee||ke){var Qe=Ee?B.value():B,Ze=ke?q.value():q;return ae||(ae=new e),ne(Qe,Ze,W,Z,ae)}}return _e?(ae||(ae=new e),n(B,q,W,Z,ne,ae)):!1}return xj=U,xj}var _j,W$;function cL(){if(W$)return _j;W$=1;var e=V2e(),t=wm();function r(n,a,l,f,i){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,l,f,r,i)}return _j=r,_j}var bj,H$;function U2e(){if(H$)return bj;H$=1;var e=qX(),t=cL(),r=1,n=2;function a(l,f,i,_){var w=i.length,A=w,E=!_;if(l==null)return!A;for(l=Object(l);w--;){var O=i[w];if(E&&O[2]?O[1]!==l[O[0]]:!(O[0]in l))return!1}for(;++w<A;){O=i[w];var F=O[0],U=l[F],B=O[1];if(E&&O[2]){if(U===void 0&&!(F in l))return!1}else{var q=new e;if(_)var W=_(U,B,F,l,f,q);if(!(W===void 0?t(B,U,r|n,_,q):W))return!1}}return!0}return bj=a,bj}var wj,K$;function tJ(){if(K$)return wj;K$=1;var e=ey();function t(r){return r===r&&!e(r)}return wj=t,wj}var Sj,Z$;function $2e(){if(Z$)return Sj;Z$=1;var e=tJ(),t=FP();function r(n){for(var a=t(n),l=a.length;l--;){var f=a[l],i=n[f];a[l]=[f,i,e(i)]}return a}return Sj=r,Sj}var Aj,Y$;function rJ(){if(Y$)return Aj;Y$=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return Aj=e,Aj}var Tj,X$;function q2e(){if(X$)return Tj;X$=1;var e=U2e(),t=$2e(),r=rJ();function n(a){var l=t(a);return l.length==1&&l[0][2]?r(l[0][0],l[0][1]):function(f){return f===a||e(f,a,l)}}return Tj=n,Tj}var Pj,J$;function G2e(){if(J$)return Pj;J$=1;function e(t,r){return t!=null&&r in Object(t)}return Pj=e,Pj}var Cj,Q$;function W2e(){if(Q$)return Cj;Q$=1;var e=_X(),t=sL(),r=Bc(),n=oL(),a=lL(),l=NP();function f(i,_,w){_=e(_,i);for(var A=-1,E=_.length,O=!1;++A<E;){var F=l(_[A]);if(!(O=i!=null&&w(i,F)))break;i=i[F]}return O||++A!=E?O:(E=i==null?0:i.length,!!E&&a(E)&&n(F,E)&&(r(i)||t(i)))}return Cj=f,Cj}var Ej,e8;function H2e(){if(e8)return Ej;e8=1;var e=G2e(),t=W2e();function r(n,a){return n!=null&&t(n,a,e)}return Ej=r,Ej}var kj,t8;function K2e(){if(t8)return kj;t8=1;var e=cL(),t=bX(),r=H2e(),n=WD(),a=tJ(),l=rJ(),f=NP(),i=1,_=2;function w(A,E){return n(A)&&a(E)?l(f(A),E):function(O){var F=t(O,A);return F===void 0&&F===E?r(O,A):e(E,F,i|_)}}return kj=w,kj}var Mj,r8;function P_(){if(r8)return Mj;r8=1;function e(t){return t}return Mj=e,Mj}var jj,n8;function Z2e(){if(n8)return jj;n8=1;function e(t){return function(r){return r==null?void 0:r[t]}}return jj=e,jj}var Oj,i8;function Y2e(){if(i8)return Oj;i8=1;var e=JD();function t(r){return function(n){return e(n,r)}}return Oj=t,Oj}var Nj,a8;function X2e(){if(a8)return Nj;a8=1;var e=Z2e(),t=Y2e(),r=WD(),n=NP();function a(l){return r(l)?e(n(l)):t(l)}return Nj=a,Nj}var Rj,s8;function ap(){if(s8)return Rj;s8=1;var e=q2e(),t=K2e(),r=P_(),n=Bc(),a=X2e();function l(f){return typeof f=="function"?f:f==null?r:typeof f=="object"?n(f)?t(f[0],f[1]):e(f):a(f)}return Rj=l,Rj}var Ij,o8;function nJ(){if(o8)return Ij;o8=1;function e(t,r,n,a){for(var l=t.length,f=n+(a?1:-1);a?f--:++f<l;)if(r(t[f],f,t))return f;return-1}return Ij=e,Ij}var Dj,l8;function J2e(){if(l8)return Dj;l8=1;function e(t){return t!==t}return Dj=e,Dj}var Lj,c8;function Q2e(){if(c8)return Lj;c8=1;function e(t,r,n){for(var a=n-1,l=t.length;++a<l;)if(t[a]===r)return a;return-1}return Lj=e,Lj}var zj,u8;function eSe(){if(u8)return zj;u8=1;var e=nJ(),t=J2e(),r=Q2e();function n(a,l,f){return l===l?r(a,l,f):e(a,t,f)}return zj=n,zj}var Fj,d8;function tSe(){if(d8)return Fj;d8=1;var e=eSe();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return Fj=t,Fj}var Bj,h8;function rSe(){if(h8)return Bj;h8=1;function e(t,r,n){for(var a=-1,l=t==null?0:t.length;++a<l;)if(n(r,t[a]))return!0;return!1}return Bj=e,Bj}var Vj,f8;function nSe(){if(f8)return Vj;f8=1;function e(){}return Vj=e,Vj}var Uj,p8;function iSe(){if(p8)return Uj;p8=1;var e=eJ(),t=nSe(),r=aL(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(l){return new e(l)}:t;return Uj=a,Uj}var $j,m8;function aSe(){if(m8)return $j;m8=1;var e=GX(),t=tSe(),r=rSe(),n=HX(),a=iSe(),l=aL(),f=200;function i(_,w,A){var E=-1,O=t,F=_.length,U=!0,B=[],q=B;if(A)U=!1,O=r;else if(F>=f){var W=w?null:a(_);if(W)return l(W);U=!1,O=n,q=new e}else q=w?[]:B;e:for(;++E<F;){var Z=_[E],ne=w?w(Z):Z;if(Z=A||Z!==0?Z:0,U&&ne===ne){for(var ae=q.length;ae--;)if(q[ae]===ne)continue e;w&&q.push(ne),B.push(Z)}else O(q,ne,A)||(q!==B&&q.push(ne),B.push(Z))}return B}return $j=i,$j}var qj,g8;function sSe(){if(g8)return qj;g8=1;var e=ap(),t=aSe();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return qj=r,qj}var oSe=sSe();const y8=oa(oSe);function iJ(e,t,r){return t===!0?y8(e,r):$n(t)?y8(e,t):e}function Ox(e){"@babel/helpers - typeof";return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}var lSe=["ref"];function v8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v8(Object(r),!0).forEach(function(n){BP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sJ(n.key),n)}}function uSe(e,t,r){return t&&x8(e.prototype,t),r&&x8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dSe(e,t,r){return t=QA(t),hSe(e,aJ()?Reflect.construct(t,r||[],QA(e).constructor):t.apply(e,r))}function hSe(e,t){if(t&&(Ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fSe(e)}function fSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aJ=function(){return!!e})()}function QA(e){return QA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QA(e)}function pSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LR(e,t)}function LR(e,t){return LR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LR(e,t)}function BP(e,t,r){return t=sJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sJ(e){var t=mSe(e,"string");return Ox(t)=="symbol"?t:t+""}function mSe(e,t){if(Ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function gSe(e,t){if(e==null)return{};var r=ySe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ySe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function vSe(e){return e.value}function xSe(e,t){if(Re.isValidElement(e))return Re.cloneElement(e,t);if(typeof e=="function")return Re.createElement(e,t);t.ref;var r=gSe(t,lSe);return Re.createElement(iL,r)}var _8=1,Uf=function(e){function t(){var r;cSe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=dSe(this,t,[].concat(a)),BP(r,"lastBoundingBox",{width:-1,height:-1}),r}return pSe(t,e),uSe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>_8||Math.abs(a.height-this.lastBoundingBox.height)>_8)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Zp({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,l=a.layout,f=a.align,i=a.verticalAlign,_=a.margin,w=a.chartWidth,A=a.chartHeight,E,O;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(f==="center"&&l==="vertical"){var F=this.getBBoxSnapshot();E={left:((w||0)-F.width)/2}}else E=f==="right"?{right:_&&_.right||0}:{left:_&&_.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var U=this.getBBoxSnapshot();O={top:((A||0)-U.height)/2}}else O=i==="bottom"?{bottom:_&&_.bottom||0}:{top:_&&_.top||0};return Zp(Zp({},E),O)}},{key:"render",value:function(){var n=this,a=this.props,l=a.content,f=a.width,i=a.height,_=a.wrapperStyle,w=a.payloadUniqBy,A=a.payload,E=Zp(Zp({position:"absolute",width:f||"auto",height:i||"auto"},this.getDefaultPosition(_)),_);return Re.createElement("div",{className:"recharts-legend-wrapper",style:E,ref:function(F){n.wrapperNode=F}},xSe(l,Zp(Zp({},this.props),{},{payload:iJ(A,w,vSe)})))}}],[{key:"getWithHeight",value:function(n,a){var l=Zp(Zp({},this.defaultProps),n.props),f=l.layout;return f==="vertical"&&Dr(n.props.height)?{height:n.props.height}:f==="horizontal"?{width:n.props.width||a}:null}}])}(H.PureComponent);BP(Uf,"displayName","Legend");BP(Uf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var Gj,b8;function _Se(){if(b8)return Gj;b8=1;var e=Qw(),t=sL(),r=Bc(),n=e?e.isConcatSpreadable:void 0;function a(l){return r(l)||t(l)||!!(n&&l&&l[n])}return Gj=a,Gj}var Wj,w8;function oJ(){if(w8)return Wj;w8=1;var e=ZX(),t=_Se();function r(n,a,l,f,i){var _=-1,w=n.length;for(l||(l=t),i||(i=[]);++_<w;){var A=n[_];a>0&&l(A)?a>1?r(A,a-1,l,f,i):e(i,A):f||(i[i.length]=A)}return i}return Wj=r,Wj}var Hj,S8;function bSe(){if(S8)return Hj;S8=1;function e(t){return function(r,n,a){for(var l=-1,f=Object(r),i=a(r),_=i.length;_--;){var w=i[t?_:++l];if(n(f[w],w,f)===!1)break}return r}}return Hj=e,Hj}var Kj,A8;function wSe(){if(A8)return Kj;A8=1;var e=bSe(),t=e();return Kj=t,Kj}var Zj,T8;function lJ(){if(T8)return Zj;T8=1;var e=wSe(),t=FP();function r(n,a){return n&&e(n,a,t)}return Zj=r,Zj}var Yj,P8;function SSe(){if(P8)return Yj;P8=1;var e=t2();function t(r,n){return function(a,l){if(a==null)return a;if(!e(a))return r(a,l);for(var f=a.length,i=n?f:-1,_=Object(a);(n?i--:++i<f)&&l(_[i],i,_)!==!1;);return a}}return Yj=t,Yj}var Xj,C8;function uL(){if(C8)return Xj;C8=1;var e=lJ(),t=SSe(),r=t(e);return Xj=r,Xj}var Jj,E8;function cJ(){if(E8)return Jj;E8=1;var e=uL(),t=t2();function r(n,a){var l=-1,f=t(n)?Array(n.length):[];return e(n,function(i,_,w){f[++l]=a(i,_,w)}),f}return Jj=r,Jj}var Qj,k8;function ASe(){if(k8)return Qj;k8=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return Qj=e,Qj}var eO,M8;function TSe(){if(M8)return eO;M8=1;var e=S_();function t(r,n){if(r!==n){var a=r!==void 0,l=r===null,f=r===r,i=e(r),_=n!==void 0,w=n===null,A=n===n,E=e(n);if(!w&&!E&&!i&&r>n||i&&_&&A&&!w&&!E||l&&_&&A||!a&&A||!f)return 1;if(!l&&!i&&!E&&r<n||E&&a&&f&&!l&&!i||w&&a&&f||!_&&f||!A)return-1}return 0}return eO=t,eO}var tO,j8;function PSe(){if(j8)return tO;j8=1;var e=TSe();function t(r,n,a){for(var l=-1,f=r.criteria,i=n.criteria,_=f.length,w=a.length;++l<_;){var A=e(f[l],i[l]);if(A){if(l>=w)return A;var E=a[l];return A*(E=="desc"?-1:1)}}return r.index-n.index}return tO=t,tO}var rO,O8;function CSe(){if(O8)return rO;O8=1;var e=XD(),t=JD(),r=ap(),n=cJ(),a=ASe(),l=XX(),f=PSe(),i=P_(),_=Bc();function w(A,E,O){E.length?E=e(E,function(B){return _(B)?function(q){return t(q,B.length===1?B[0]:B)}:B}):E=[i];var F=-1;E=e(E,l(r));var U=n(A,function(B,q,W){var Z=e(E,function(ne){return ne(B)});return{criteria:Z,index:++F,value:B}});return a(U,function(B,q){return f(B,q,O)})}return rO=w,rO}var nO,N8;function ESe(){if(N8)return nO;N8=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return nO=e,nO}var iO,R8;function kSe(){if(R8)return iO;R8=1;var e=ESe(),t=Math.max;function r(n,a,l){return a=t(a===void 0?n.length-1:a,0),function(){for(var f=arguments,i=-1,_=t(f.length-a,0),w=Array(_);++i<_;)w[i]=f[a+i];i=-1;for(var A=Array(a+1);++i<a;)A[i]=f[i];return A[a]=l(w),e(n,this,A)}}return iO=r,iO}var aO,I8;function MSe(){if(I8)return aO;I8=1;function e(t){return function(){return t}}return aO=e,aO}var sO,D8;function uJ(){if(D8)return sO;D8=1;var e=Xv(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return sO=t,sO}var oO,L8;function jSe(){if(L8)return oO;L8=1;var e=MSe(),t=uJ(),r=P_(),n=t?function(a,l){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(l),writable:!0})}:r;return oO=n,oO}var lO,z8;function OSe(){if(z8)return lO;z8=1;var e=800,t=16,r=Date.now;function n(a){var l=0,f=0;return function(){var i=r(),_=t-(i-f);if(f=i,_>0){if(++l>=e)return arguments[0]}else l=0;return a.apply(void 0,arguments)}}return lO=n,lO}var cO,F8;function NSe(){if(F8)return cO;F8=1;var e=jSe(),t=OSe(),r=t(e);return cO=r,cO}var uO,B8;function RSe(){if(B8)return uO;B8=1;var e=P_(),t=kSe(),r=NSe();function n(a,l){return r(t(a,l,e),a+"")}return uO=n,uO}var dO,V8;function VP(){if(V8)return dO;V8=1;var e=KD(),t=t2(),r=oL(),n=ey();function a(l,f,i){if(!n(i))return!1;var _=typeof f;return(_=="number"?t(i)&&r(f,i.length):_=="string"&&f in i)?e(i[f],l):!1}return dO=a,dO}var hO,U8;function ISe(){if(U8)return hO;U8=1;var e=oJ(),t=CSe(),r=RSe(),n=VP(),a=r(function(l,f){if(l==null)return[];var i=f.length;return i>1&&n(l,f[0],f[1])?f=[]:i>2&&n(f[0],f[1],f[2])&&(f=[f[0]]),t(l,e(f,1),[])});return hO=a,hO}var DSe=ISe();const dL=oa(DSe);function Z1(e){"@babel/helpers - typeof";return Z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z1(e)}function zR(){return zR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zR.apply(this,arguments)}function LSe(e,t){return VSe(e)||BSe(e,t)||FSe(e,t)||zSe()}function zSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FSe(e,t){if(e){if(typeof e=="string")return $8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $8(e,t)}}function $8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BSe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function VSe(e){if(Array.isArray(e))return e}function q8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q8(Object(r),!0).forEach(function(n){USe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function USe(e,t,r){return t=$Se(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Se(e){var t=qSe(e,"string");return Z1(t)=="symbol"?t:t+""}function qSe(e,t){if(Z1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Z1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GSe(e){return Array.isArray(e)&&Ro(e[0])&&Ro(e[1])?e.join(" ~ "):e}var WSe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,l=a===void 0?{}:a,f=t.itemStyle,i=f===void 0?{}:f,_=t.labelStyle,w=_===void 0?{}:_,A=t.payload,E=t.formatter,O=t.itemSorter,F=t.wrapperClassName,U=t.labelClassName,B=t.label,q=t.labelFormatter,W=t.accessibilityLayer,Z=W===void 0?!1:W,ne=function(){if(A&&A.length){var Ee={padding:0,margin:0},ke=(O?dL(A,O):A).map(function(Qe,Ze){if(Qe.type==="none")return null;var Ge=fO({display:"block",paddingTop:4,paddingBottom:4,color:Qe.color||"#000"},i),Oe=Qe.formatter||E||GSe,je=Qe.value,Le=Qe.name,ut=je,ze=Le;if(Oe&&ut!=null&&ze!=null){var ht=Oe(je,Le,Qe,Ze,A);if(Array.isArray(ht)){var rt=LSe(ht,2);ut=rt[0],ze=rt[1]}else ut=ht}return Re.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Ze),style:Ge},Ro(ze)?Re.createElement("span",{className:"recharts-tooltip-item-name"},ze):null,Ro(ze)?Re.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Re.createElement("span",{className:"recharts-tooltip-item-value"},ut),Re.createElement("span",{className:"recharts-tooltip-item-unit"},Qe.unit||""))});return Re.createElement("ul",{className:"recharts-tooltip-item-list",style:Ee},ke)}return null},ae=fO({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),ee=fO({margin:0},w),se=!Yn(B),ce=se?B:"",ge=hi("recharts-default-tooltip",F),Te=hi("recharts-tooltip-label",U);se&&q&&A!==void 0&&A!==null&&(ce=q(B,A));var Ae=Z?{role:"status","aria-live":"assertive"}:{};return Re.createElement("div",zR({className:ge,style:ae},Ae),Re.createElement("p",{className:Te,style:ee},Re.isValidElement(ce)?ce:"".concat(ce)),ne())};function Y1(e){"@babel/helpers - typeof";return Y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y1(e)}function NS(e,t,r){return t=HSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HSe(e){var t=KSe(e,"string");return Y1(t)=="symbol"?t:t+""}function KSe(e,t){if(Y1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Y1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rb="recharts-tooltip-wrapper",ZSe={visibility:"hidden"};function YSe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return hi(Rb,NS(NS(NS(NS({},"".concat(Rb,"-right"),Dr(r)&&t&&Dr(t.x)&&r>=t.x),"".concat(Rb,"-left"),Dr(r)&&t&&Dr(t.x)&&r<t.x),"".concat(Rb,"-bottom"),Dr(n)&&t&&Dr(t.y)&&n>=t.y),"".concat(Rb,"-top"),Dr(n)&&t&&Dr(t.y)&&n<t.y))}function G8(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,l=e.position,f=e.reverseDirection,i=e.tooltipDimension,_=e.viewBox,w=e.viewBoxDimension;if(l&&Dr(l[n]))return l[n];var A=r[n]-i-a,E=r[n]+a;if(t[n])return f[n]?A:E;if(f[n]){var O=A,F=_[n];return O<F?Math.max(E,_[n]):Math.max(A,_[n])}var U=E+i,B=_[n]+w;return U>B?Math.max(A,_[n]):Math.max(E,_[n])}function XSe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function JSe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,l=e.reverseDirection,f=e.tooltipBox,i=e.useTranslate3d,_=e.viewBox,w,A,E;return f.height>0&&f.width>0&&r?(A=G8({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:f.width,viewBox:_,viewBoxDimension:_.width}),E=G8({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:f.height,viewBox:_,viewBoxDimension:_.height}),w=XSe({translateX:A,translateY:E,useTranslate3d:i})):w=ZSe,{cssProperties:w,cssClasses:YSe({translateX:A,translateY:E,coordinate:r})}}function Nx(e){"@babel/helpers - typeof";return Nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nx(e)}function W8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function H8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W8(Object(r),!0).forEach(function(n){BR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hJ(n.key),n)}}function tAe(e,t,r){return t&&eAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rAe(e,t,r){return t=eT(t),nAe(e,dJ()?Reflect.construct(t,r||[],eT(e).constructor):t.apply(e,r))}function nAe(e,t){if(t&&(Nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iAe(e)}function iAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dJ=function(){return!!e})()}function eT(e){return eT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eT(e)}function aAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FR(e,t)}function FR(e,t){return FR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},FR(e,t)}function BR(e,t,r){return t=hJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hJ(e){var t=sAe(e,"string");return Nx(t)=="symbol"?t:t+""}function sAe(e,t){if(Nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var K8=1,oAe=function(e){function t(){var r;QSe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=rAe(this,t,[].concat(a)),BR(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),BR(r,"handleKeyDown",function(f){if(f.key==="Escape"){var i,_,w,A;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(_=r.props.coordinate)===null||_===void 0?void 0:_.x)!==null&&i!==void 0?i:0,y:(w=(A=r.props.coordinate)===null||A===void 0?void 0:A.y)!==null&&w!==void 0?w:0}})}}),r}return aAe(t,e),tAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>K8||Math.abs(n.height-this.state.lastBoundingBox.height)>K8)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,l=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,w=a.children,A=a.coordinate,E=a.hasPayload,O=a.isAnimationActive,F=a.offset,U=a.position,B=a.reverseDirection,q=a.useTranslate3d,W=a.viewBox,Z=a.wrapperStyle,ne=JSe({allowEscapeViewBox:f,coordinate:A,offsetTopLeft:F,position:U,reverseDirection:B,tooltipBox:this.state.lastBoundingBox,useTranslate3d:q,viewBox:W}),ae=ne.cssClasses,ee=ne.cssProperties,se=H8(H8({transition:O&&l?"transform ".concat(i,"ms ").concat(_):void 0},ee),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&E?"visible":"hidden",position:"absolute",top:0,left:0},Z);return Re.createElement("div",{tabIndex:-1,className:ae,style:se,ref:function(ge){n.wrapperNode=ge}},w)}}])}(H.PureComponent),lAe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},sp={isSsr:lAe()};function Rx(e){"@babel/helpers - typeof";return Rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rx(e)}function Z8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z8(Object(r),!0).forEach(function(n){hL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pJ(n.key),n)}}function dAe(e,t,r){return t&&uAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function hAe(e,t,r){return t=tT(t),fAe(e,fJ()?Reflect.construct(t,r||[],tT(e).constructor):t.apply(e,r))}function fAe(e,t){if(t&&(Rx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pAe(e)}function pAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fJ=function(){return!!e})()}function tT(e){return tT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tT(e)}function mAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VR(e,t)}function VR(e,t){return VR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},VR(e,t)}function hL(e,t,r){return t=pJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pJ(e){var t=gAe(e,"string");return Rx(t)=="symbol"?t:t+""}function gAe(e,t){if(Rx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function yAe(e){return e.dataKey}function vAe(e,t){return Re.isValidElement(e)?Re.cloneElement(e,t):typeof e=="function"?Re.createElement(e,t):Re.createElement(WSe,t)}var aa=function(e){function t(){return cAe(this,t),hAe(this,t,arguments)}return mAe(t,e),dAe(t,[{key:"render",value:function(){var n=this,a=this.props,l=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,w=a.content,A=a.coordinate,E=a.filterNull,O=a.isAnimationActive,F=a.offset,U=a.payload,B=a.payloadUniqBy,q=a.position,W=a.reverseDirection,Z=a.useTranslate3d,ne=a.viewBox,ae=a.wrapperStyle,ee=U??[];E&&ee.length&&(ee=iJ(U.filter(function(ce){return ce.value!=null&&(ce.hide!==!0||n.props.includeHidden)}),B,yAe));var se=ee.length>0;return Re.createElement(oAe,{allowEscapeViewBox:f,animationDuration:i,animationEasing:_,isAnimationActive:O,active:l,coordinate:A,hasPayload:se,offset:F,position:q,reverseDirection:W,useTranslate3d:Z,viewBox:ne,wrapperStyle:ae},vAe(w,Y8(Y8({},this.props),{},{payload:ee})))}}])}(H.PureComponent);hL(aa,"displayName","Tooltip");hL(aa,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!sp.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var pO,X8;function xAe(){if(X8)return pO;X8=1;var e=ip(),t=function(){return e.Date.now()};return pO=t,pO}var mO,J8;function _Ae(){if(J8)return mO;J8=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return mO=t,mO}var gO,Q8;function bAe(){if(Q8)return gO;Q8=1;var e=_Ae(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return gO=r,gO}var yO,e7;function mJ(){if(e7)return yO;e7=1;var e=bAe(),t=ey(),r=S_(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,i=parseInt;function _(w){if(typeof w=="number")return w;if(r(w))return n;if(t(w)){var A=typeof w.valueOf=="function"?w.valueOf():w;w=t(A)?A+"":A}if(typeof w!="string")return w===0?w:+w;w=e(w);var E=l.test(w);return E||f.test(w)?i(w.slice(2),E?2:8):a.test(w)?n:+w}return yO=_,yO}var vO,t7;function wAe(){if(t7)return vO;t7=1;var e=ey(),t=xAe(),r=mJ(),n="Expected a function",a=Math.max,l=Math.min;function f(i,_,w){var A,E,O,F,U,B,q=0,W=!1,Z=!1,ne=!0;if(typeof i!="function")throw new TypeError(n);_=r(_)||0,e(w)&&(W=!!w.leading,Z="maxWait"in w,O=Z?a(r(w.maxWait)||0,_):O,ne="trailing"in w?!!w.trailing:ne);function ae(ke){var Qe=A,Ze=E;return A=E=void 0,q=ke,F=i.apply(Ze,Qe),F}function ee(ke){return q=ke,U=setTimeout(ge,_),W?ae(ke):F}function se(ke){var Qe=ke-B,Ze=ke-q,Ge=_-Qe;return Z?l(Ge,O-Ze):Ge}function ce(ke){var Qe=ke-B,Ze=ke-q;return B===void 0||Qe>=_||Qe<0||Z&&Ze>=O}function ge(){var ke=t();if(ce(ke))return Te(ke);U=setTimeout(ge,se(ke))}function Te(ke){return U=void 0,ne&&A?ae(ke):(A=E=void 0,F)}function Ae(){U!==void 0&&clearTimeout(U),q=0,A=B=E=U=void 0}function _e(){return U===void 0?F:Te(t())}function Ee(){var ke=t(),Qe=ce(ke);if(A=arguments,E=this,B=ke,Qe){if(U===void 0)return ee(B);if(Z)return clearTimeout(U),U=setTimeout(ge,_),ae(B)}return U===void 0&&(U=setTimeout(ge,_)),F}return Ee.cancel=Ae,Ee.flush=_e,Ee}return vO=f,vO}var xO,r7;function SAe(){if(r7)return xO;r7=1;var e=wAe(),t=ey(),r="Expected a function";function n(a,l,f){var i=!0,_=!0;if(typeof a!="function")throw new TypeError(r);return t(f)&&(i="leading"in f?!!f.leading:i,_="trailing"in f?!!f.trailing:_),e(a,l,{leading:i,maxWait:l,trailing:_})}return xO=n,xO}var AAe=SAe();const gJ=oa(AAe);function X1(e){"@babel/helpers - typeof";return X1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X1(e)}function n7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n7(Object(r),!0).forEach(function(n){TAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TAe(e,t,r){return t=PAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PAe(e){var t=CAe(e,"string");return X1(t)=="symbol"?t:t+""}function CAe(e,t){if(X1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(X1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EAe(e,t){return OAe(e)||jAe(e,t)||MAe(e,t)||kAe()}function kAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MAe(e,t){if(e){if(typeof e=="string")return i7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i7(e,t)}}function i7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function OAe(e){if(Array.isArray(e))return e}var No=H.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,l=e.width,f=l===void 0?"100%":l,i=e.height,_=i===void 0?"100%":i,w=e.minWidth,A=w===void 0?0:w,E=e.minHeight,O=e.maxHeight,F=e.children,U=e.debounce,B=U===void 0?0:U,q=e.id,W=e.className,Z=e.onResize,ne=e.style,ae=ne===void 0?{}:ne,ee=H.useRef(null),se=H.useRef();se.current=Z,H.useImperativeHandle(t,function(){return Object.defineProperty(ee.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ee.current},configurable:!0})});var ce=H.useState({containerWidth:a.width,containerHeight:a.height}),ge=EAe(ce,2),Te=ge[0],Ae=ge[1],_e=H.useCallback(function(ke,Qe){Ae(function(Ze){var Ge=Math.round(ke),Oe=Math.round(Qe);return Ze.containerWidth===Ge&&Ze.containerHeight===Oe?Ze:{containerWidth:Ge,containerHeight:Oe}})},[]);H.useEffect(function(){var ke=function(Le){var ut,ze=Le[0].contentRect,ht=ze.width,rt=ze.height;_e(ht,rt),(ut=se.current)===null||ut===void 0||ut.call(se,ht,rt)};B>0&&(ke=gJ(ke,B,{trailing:!0,leading:!1}));var Qe=new ResizeObserver(ke),Ze=ee.current.getBoundingClientRect(),Ge=Ze.width,Oe=Ze.height;return _e(Ge,Oe),Qe.observe(ee.current),function(){Qe.disconnect()}},[_e,B]);var Ee=H.useMemo(function(){var ke=Te.containerWidth,Qe=Te.containerHeight;if(ke<0||Qe<0)return null;kh(_v(f)||_v(_),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,f,_),kh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var Ze=_v(f)?ke:f,Ge=_v(_)?Qe:_;r&&r>0&&(Ze?Ge=Ze/r:Ge&&(Ze=Ge*r),O&&Ge>O&&(Ge=O)),kh(Ze>0||Ge>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ze,Ge,f,_,A,E,r);var Oe=!Array.isArray(F)&&lm(F.type).endsWith("Chart");return Re.Children.map(F,function(je){return Re.isValidElement(je)?H.cloneElement(je,RS({width:Ze,height:Ge},Oe?{style:RS({height:"100%",width:"100%",maxHeight:Ge,maxWidth:Ze},je.props.style)}:{})):je})},[r,F,_,O,E,A,Te,f]);return Re.createElement("div",{id:q?"".concat(q):void 0,className:hi("recharts-responsive-container",W),style:RS(RS({},ae),{},{width:f,height:_,minWidth:A,minHeight:E,maxHeight:O}),ref:ee},Ee)}),Xf=function(t){return null};Xf.displayName="Cell";function J1(e){"@babel/helpers - typeof";return J1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J1(e)}function a7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a7(Object(r),!0).forEach(function(n){NAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NAe(e,t,r){return t=RAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RAe(e){var t=IAe(e,"string");return J1(t)=="symbol"?t:t+""}function IAe(e,t){if(J1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(J1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z0={widthCache:{},cacheCount:0},DAe=2e3,LAe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},s7="recharts_measurement_span";function zAe(e){var t=UR({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var l1=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||sp.isSsr)return{width:0,height:0};var n=zAe(r),a=JSON.stringify({text:t,copyStyle:n});if(Z0.widthCache[a])return Z0.widthCache[a];try{var l=document.getElementById(s7);l||(l=document.createElement("span"),l.setAttribute("id",s7),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var f=UR(UR({},LAe),n);Object.assign(l.style,f),l.textContent="".concat(t);var i=l.getBoundingClientRect(),_={width:i.width,height:i.height};return Z0.widthCache[a]=_,++Z0.cacheCount>DAe&&(Z0.cacheCount=0,Z0.widthCache={}),_}catch{return{width:0,height:0}}},FAe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Q1(e){"@babel/helpers - typeof";return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q1(e)}function rT(e,t){return $Ae(e)||UAe(e,t)||VAe(e,t)||BAe()}function BAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VAe(e,t){if(e){if(typeof e=="string")return o7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o7(e,t)}}function o7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function $Ae(e){if(Array.isArray(e))return e}function qAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WAe(n.key),n)}}function GAe(e,t,r){return t&&l7(e.prototype,t),r&&l7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WAe(e){var t=HAe(e,"string");return Q1(t)=="symbol"?t:t+""}function HAe(e,t){if(Q1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Q1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var c7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,u7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,KAe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ZAe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,yJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},YAe=Object.keys(yJ),lx="NaN";function XAe(e,t){return e*yJ[t]}var IS=function(){function e(t,r){qAe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!KAe.test(r)&&(this.num=NaN,this.unit=""),YAe.includes(r)&&(this.num=XAe(t,r),this.unit="px")}return GAe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=ZAe.exec(r))!==null&&n!==void 0?n:[],l=rT(a,3),f=l[1],i=l[2];return new e(parseFloat(f),i??"")}}])}();function vJ(e){if(e.includes(lx))return lx;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=c7.exec(t))!==null&&r!==void 0?r:[],a=rT(n,4),l=a[1],f=a[2],i=a[3],_=IS.parse(l??""),w=IS.parse(i??""),A=f==="*"?_.multiply(w):_.divide(w);if(A.isNaN())return lx;t=t.replace(c7,A.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var E,O=(E=u7.exec(t))!==null&&E!==void 0?E:[],F=rT(O,4),U=F[1],B=F[2],q=F[3],W=IS.parse(U??""),Z=IS.parse(q??""),ne=B==="+"?W.add(Z):W.subtract(Z);if(ne.isNaN())return lx;t=t.replace(u7,ne.toString())}return t}var d7=/\(([^()]*)\)/;function JAe(e){for(var t=e;t.includes("(");){var r=d7.exec(t),n=rT(r,2),a=n[1];t=t.replace(d7,vJ(a))}return t}function QAe(e){var t=e.replace(/\s+/g,"");return t=JAe(t),t=vJ(t),t}function eTe(e){try{return QAe(e)}catch{return lx}}function _O(e){var t=eTe(e.slice(5,-1));return t===lx?"":t}var tTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],rTe=["dx","dy","angle","className","breakAll"];function $R(){return $R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$R.apply(this,arguments)}function h7(e,t){if(e==null)return{};var r=nTe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nTe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function f7(e,t){return oTe(e)||sTe(e,t)||aTe(e,t)||iTe()}function iTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aTe(e,t){if(e){if(typeof e=="string")return p7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p7(e,t)}}function p7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function sTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function oTe(e){if(Array.isArray(e))return e}var xJ=/[ \f\n\r\t\v\u2028\u2029]+/,_J=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var l=[];Yn(r)||(n?l=r.toString().split(""):l=r.toString().split(xJ));var f=l.map(function(_){return{word:_,width:l1(_,a).width}}),i=n?0:l1("",a).width;return{wordsWithComputedWidth:f,spaceWidth:i}}catch{return null}},lTe=function(t,r,n,a,l){var f=t.maxLines,i=t.children,_=t.style,w=t.breakAll,A=Dr(f),E=i,O=function(){var Ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Ze.reduce(function(Ge,Oe){var je=Oe.word,Le=Oe.width,ut=Ge[Ge.length-1];if(ut&&(a==null||l||ut.width+Le+n<Number(a)))ut.words.push(je),ut.width+=Le+n;else{var ze={words:[je],width:Le};Ge.push(ze)}return Ge},[])},F=O(r),U=function(Ze){return Ze.reduce(function(Ge,Oe){return Ge.width>Oe.width?Ge:Oe})};if(!A)return F;for(var B="",q=function(Ze){var Ge=E.slice(0,Ze),Oe=_J({breakAll:w,style:_,children:Ge+B}).wordsWithComputedWidth,je=O(Oe),Le=je.length>f||U(je).width>Number(a);return[Le,je]},W=0,Z=E.length-1,ne=0,ae;W<=Z&&ne<=E.length-1;){var ee=Math.floor((W+Z)/2),se=ee-1,ce=q(se),ge=f7(ce,2),Te=ge[0],Ae=ge[1],_e=q(ee),Ee=f7(_e,1),ke=Ee[0];if(!Te&&!ke&&(W=ee+1),Te&&ke&&(Z=ee-1),!Te&&ke){ae=Ae;break}ne++}return ae||F},m7=function(t){var r=Yn(t)?[]:t.toString().split(xJ);return[{words:r}]},cTe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,l=t.style,f=t.breakAll,i=t.maxLines;if((r||n)&&!sp.isSsr){var _,w,A=_J({breakAll:f,children:a,style:l});if(A){var E=A.wordsWithComputedWidth,O=A.spaceWidth;_=E,w=O}else return m7(a);return lTe({breakAll:f,children:a,maxLines:i,style:l},_,w,r,n)}return m7(a)},g7="#808080",zv=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,f=t.lineHeight,i=f===void 0?"1em":f,_=t.capHeight,w=_===void 0?"0.71em":_,A=t.scaleToFit,E=A===void 0?!1:A,O=t.textAnchor,F=O===void 0?"start":O,U=t.verticalAnchor,B=U===void 0?"end":U,q=t.fill,W=q===void 0?g7:q,Z=h7(t,tTe),ne=H.useMemo(function(){return cTe({breakAll:Z.breakAll,children:Z.children,maxLines:Z.maxLines,scaleToFit:E,style:Z.style,width:Z.width})},[Z.breakAll,Z.children,Z.maxLines,E,Z.style,Z.width]),ae=Z.dx,ee=Z.dy,se=Z.angle,ce=Z.className,ge=Z.breakAll,Te=h7(Z,rTe);if(!Ro(n)||!Ro(l))return null;var Ae=n+(Dr(ae)?ae:0),_e=l+(Dr(ee)?ee:0),Ee;switch(B){case"start":Ee=_O("calc(".concat(w,")"));break;case"middle":Ee=_O("calc(".concat((ne.length-1)/2," * -").concat(i," + (").concat(w," / 2))"));break;default:Ee=_O("calc(".concat(ne.length-1," * -").concat(i,")"));break}var ke=[];if(E){var Qe=ne[0].width,Ze=Z.width;ke.push("scale(".concat((Dr(Ze)?Ze/Qe:1)/Qe,")"))}return se&&ke.push("rotate(".concat(se,", ").concat(Ae,", ").concat(_e,")")),ke.length&&(Te.transform=ke.join(" ")),Re.createElement("text",$R({},yn(Te,!0),{x:Ae,y:_e,className:hi("recharts-text",ce),textAnchor:F,fill:W.includes("url")?g7:W}),ne.map(function(Ge,Oe){var je=Ge.words.join(ge?"":" ");return Re.createElement("tspan",{x:Ae,dy:Oe===0?Ee:i,key:"".concat(je,"-").concat(Oe)},je)}))};function Ig(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function uTe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function fL(e){let t,r,n;e.length!==2?(t=Ig,r=(i,_)=>Ig(e(i),_),n=(i,_)=>e(i)-_):(t=e===Ig||e===uTe?e:dTe,r=e,n=e);function a(i,_,w=0,A=i.length){if(w<A){if(t(_,_)!==0)return A;do{const E=w+A>>>1;r(i[E],_)<0?w=E+1:A=E}while(w<A)}return w}function l(i,_,w=0,A=i.length){if(w<A){if(t(_,_)!==0)return A;do{const E=w+A>>>1;r(i[E],_)<=0?w=E+1:A=E}while(w<A)}return w}function f(i,_,w=0,A=i.length){const E=a(i,_,w,A-1);return E>w&&n(i[E-1],_)>-n(i[E],_)?E-1:E}return{left:a,center:f,right:l}}function dTe(){return 0}function bJ(e){return e===null?NaN:+e}function*hTe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const fTe=fL(Ig),r2=fTe.right;fL(bJ).center;class y7 extends Map{constructor(t,r=gTe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(v7(this,t))}has(t){return super.has(v7(this,t))}set(t,r){return super.set(pTe(this,t),r)}delete(t){return super.delete(mTe(this,t))}}function v7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function pTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function mTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function gTe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function yTe(e=Ig){if(e===Ig)return wJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function wJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const vTe=Math.sqrt(50),xTe=Math.sqrt(10),_Te=Math.sqrt(2);function nT(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),l=n/Math.pow(10,a),f=l>=vTe?10:l>=xTe?5:l>=_Te?2:1;let i,_,w;return a<0?(w=Math.pow(10,-a)/f,i=Math.round(e*w),_=Math.round(t*w),i/w<e&&++i,_/w>t&&--_,w=-w):(w=Math.pow(10,a)*f,i=Math.round(e/w),_=Math.round(t/w),i*w<e&&++i,_*w>t&&--_),_<i&&.5<=r&&r<2?nT(e,t,r*2):[i,_,w]}function qR(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,l,f]=n?nT(t,e,r):nT(e,t,r);if(!(l>=a))return[];const i=l-a+1,_=new Array(i);if(n)if(f<0)for(let w=0;w<i;++w)_[w]=(l-w)/-f;else for(let w=0;w<i;++w)_[w]=(l-w)*f;else if(f<0)for(let w=0;w<i;++w)_[w]=(a+w)/-f;else for(let w=0;w<i;++w)_[w]=(a+w)*f;return _}function GR(e,t,r){return t=+t,e=+e,r=+r,nT(e,t,r)[2]}function WR(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?GR(t,e,r):GR(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function x7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function _7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function SJ(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?wJ:yTe(a);n>r;){if(n-r>600){const _=n-r+1,w=t-r+1,A=Math.log(_),E=.5*Math.exp(2*A/3),O=.5*Math.sqrt(A*E*(_-E)/_)*(w-_/2<0?-1:1),F=Math.max(r,Math.floor(t-w*E/_+O)),U=Math.min(n,Math.floor(t+(_-w)*E/_+O));SJ(e,t,F,U,a)}const l=e[t];let f=r,i=n;for(Ib(e,r,t),a(e[n],l)>0&&Ib(e,r,n);f<i;){for(Ib(e,f,i),++f,--i;a(e[f],l)<0;)++f;for(;a(e[i],l)>0;)--i}a(e[r],l)===0?Ib(e,r,i):(++i,Ib(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function Ib(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function bTe(e,t,r){if(e=Float64Array.from(hTe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return _7(e);if(t>=1)return x7(e);var n,a=(n-1)*t,l=Math.floor(a),f=x7(SJ(e,l).subarray(0,l+1)),i=_7(e.subarray(l+1));return f+(i-f)*(a-l)}}function wTe(e,t,r=bJ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,l=Math.floor(a),f=+r(e[l],l,e),i=+r(e[l+1],l+1,e);return f+(i-f)*(a-l)}}function STe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(a);++n<a;)l[n]=e+n*r;return l}function Md(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Sm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const HR=Symbol("implicit");function pL(){var e=new y7,t=[],r=[],n=HR;function a(l){let f=e.get(l);if(f===void 0){if(n!==HR)return n;e.set(l,f=t.push(l)-1)}return r[f%r.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new y7;for(const f of l)e.has(f)||e.set(f,t.push(f)-1);return a},a.range=function(l){return arguments.length?(r=Array.from(l),a):r.slice()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return pL(t,r).unknown(n)},Md.apply(a,arguments),a}function ew(){var e=pL().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,l,f,i=!1,_=0,w=0,A=.5;delete e.unknown;function E(){var O=t().length,F=a<n,U=F?a:n,B=F?n:a;l=(B-U)/Math.max(1,O-_+w*2),i&&(l=Math.floor(l)),U+=(B-U-l*(O-_))*A,f=l*(1-_),i&&(U=Math.round(U),f=Math.round(f));var q=STe(O).map(function(W){return U+l*W});return r(F?q.reverse():q)}return e.domain=function(O){return arguments.length?(t(O),E()):t()},e.range=function(O){return arguments.length?([n,a]=O,n=+n,a=+a,E()):[n,a]},e.rangeRound=function(O){return[n,a]=O,n=+n,a=+a,i=!0,E()},e.bandwidth=function(){return f},e.step=function(){return l},e.round=function(O){return arguments.length?(i=!!O,E()):i},e.padding=function(O){return arguments.length?(_=Math.min(1,w=+O),E()):_},e.paddingInner=function(O){return arguments.length?(_=Math.min(1,O),E()):_},e.paddingOuter=function(O){return arguments.length?(w=+O,E()):w},e.align=function(O){return arguments.length?(A=Math.max(0,Math.min(1,O)),E()):A},e.copy=function(){return ew(t(),[n,a]).round(i).paddingInner(_).paddingOuter(w).align(A)},Md.apply(E(),arguments)}function AJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return AJ(t())},e}function c1(){return AJ(ew.apply(null,arguments).paddingInner(1))}function mL(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function TJ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function n2(){}var tw=.7,iT=1/tw,vx="\\s*([+-]?\\d+)\\s*",rw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$f="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ATe=/^#([0-9a-f]{3,8})$/,TTe=new RegExp(`^rgb\\(${vx},${vx},${vx}\\)$`),PTe=new RegExp(`^rgb\\(${$f},${$f},${$f}\\)$`),CTe=new RegExp(`^rgba\\(${vx},${vx},${vx},${rw}\\)$`),ETe=new RegExp(`^rgba\\(${$f},${$f},${$f},${rw}\\)$`),kTe=new RegExp(`^hsl\\(${rw},${$f},${$f}\\)$`),MTe=new RegExp(`^hsla\\(${rw},${$f},${$f},${rw}\\)$`),b7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mL(n2,nw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:w7,formatHex:w7,formatHex8:jTe,formatHsl:OTe,formatRgb:S7,toString:S7});function w7(){return this.rgb().formatHex()}function jTe(){return this.rgb().formatHex8()}function OTe(){return PJ(this).formatHsl()}function S7(){return this.rgb().formatRgb()}function nw(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=ATe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?A7(t):r===3?new Rc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?DS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?DS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=TTe.exec(e))?new Rc(t[1],t[2],t[3],1):(t=PTe.exec(e))?new Rc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=CTe.exec(e))?DS(t[1],t[2],t[3],t[4]):(t=ETe.exec(e))?DS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=kTe.exec(e))?C7(t[1],t[2]/100,t[3]/100,1):(t=MTe.exec(e))?C7(t[1],t[2]/100,t[3]/100,t[4]):b7.hasOwnProperty(e)?A7(b7[e]):e==="transparent"?new Rc(NaN,NaN,NaN,0):null}function A7(e){return new Rc(e>>16&255,e>>8&255,e&255,1)}function DS(e,t,r,n){return n<=0&&(e=t=r=NaN),new Rc(e,t,r,n)}function NTe(e){return e instanceof n2||(e=nw(e)),e?(e=e.rgb(),new Rc(e.r,e.g,e.b,e.opacity)):new Rc}function KR(e,t,r,n){return arguments.length===1?NTe(e):new Rc(e,t,r,n??1)}function Rc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}mL(Rc,KR,TJ(n2,{brighter(e){return e=e==null?iT:Math.pow(iT,e),new Rc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?tw:Math.pow(tw,e),new Rc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rc(Ev(this.r),Ev(this.g),Ev(this.b),aT(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T7,formatHex:T7,formatHex8:RTe,formatRgb:P7,toString:P7}));function T7(){return`#${bv(this.r)}${bv(this.g)}${bv(this.b)}`}function RTe(){return`#${bv(this.r)}${bv(this.g)}${bv(this.b)}${bv((isNaN(this.opacity)?1:this.opacity)*255)}`}function P7(){const e=aT(this.opacity);return`${e===1?"rgb(":"rgba("}${Ev(this.r)}, ${Ev(this.g)}, ${Ev(this.b)}${e===1?")":`, ${e})`}`}function aT(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ev(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function bv(e){return e=Ev(e),(e<16?"0":"")+e.toString(16)}function C7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ph(e,t,r,n)}function PJ(e){if(e instanceof Ph)return new Ph(e.h,e.s,e.l,e.opacity);if(e instanceof n2||(e=nw(e)),!e)return new Ph;if(e instanceof Ph)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),l=Math.max(t,r,n),f=NaN,i=l-a,_=(l+a)/2;return i?(t===l?f=(r-n)/i+(r<n)*6:r===l?f=(n-t)/i+2:f=(t-r)/i+4,i/=_<.5?l+a:2-l-a,f*=60):i=_>0&&_<1?0:f,new Ph(f,i,_,e.opacity)}function ITe(e,t,r,n){return arguments.length===1?PJ(e):new Ph(e,t,r,n??1)}function Ph(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}mL(Ph,ITe,TJ(n2,{brighter(e){return e=e==null?iT:Math.pow(iT,e),new Ph(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?tw:Math.pow(tw,e),new Ph(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Rc(bO(e>=240?e-240:e+120,a,n),bO(e,a,n),bO(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ph(E7(this.h),LS(this.s),LS(this.l),aT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=aT(this.opacity);return`${e===1?"hsl(":"hsla("}${E7(this.h)}, ${LS(this.s)*100}%, ${LS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function E7(e){return e=(e||0)%360,e<0?e+360:e}function LS(e){return Math.max(0,Math.min(1,e||0))}function bO(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const gL=e=>()=>e;function DTe(e,t){return function(r){return e+r*t}}function LTe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function zTe(e){return(e=+e)==1?CJ:function(t,r){return r-t?LTe(t,r,e):gL(isNaN(t)?r:t)}}function CJ(e,t){var r=t-e;return r?DTe(e,r):gL(isNaN(e)?t:e)}const k7=function e(t){var r=zTe(t);function n(a,l){var f=r((a=KR(a)).r,(l=KR(l)).r),i=r(a.g,l.g),_=r(a.b,l.b),w=CJ(a.opacity,l.opacity);return function(A){return a.r=f(A),a.g=i(A),a.b=_(A),a.opacity=w(A),a+""}}return n.gamma=e,n}(1);function FTe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(l){for(a=0;a<r;++a)n[a]=e[a]*(1-l)+t[a]*l;return n}}function BTe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function VTe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),l=new Array(r),f;for(f=0;f<n;++f)a[f]=C_(e[f],t[f]);for(;f<r;++f)l[f]=t[f];return function(i){for(f=0;f<n;++f)l[f]=a[f](i);return l}}function UTe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function sT(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function $Te(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=C_(e[a],t[a]):n[a]=t[a];return function(l){for(a in r)n[a]=r[a](l);return n}}var ZR=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,wO=new RegExp(ZR.source,"g");function qTe(e){return function(){return e}}function GTe(e){return function(t){return e(t)+""}}function WTe(e,t){var r=ZR.lastIndex=wO.lastIndex=0,n,a,l,f=-1,i=[],_=[];for(e=e+"",t=t+"";(n=ZR.exec(e))&&(a=wO.exec(t));)(l=a.index)>r&&(l=t.slice(r,l),i[f]?i[f]+=l:i[++f]=l),(n=n[0])===(a=a[0])?i[f]?i[f]+=a:i[++f]=a:(i[++f]=null,_.push({i:f,x:sT(n,a)})),r=wO.lastIndex;return r<t.length&&(l=t.slice(r),i[f]?i[f]+=l:i[++f]=l),i.length<2?_[0]?GTe(_[0].x):qTe(t):(t=_.length,function(w){for(var A=0,E;A<t;++A)i[(E=_[A]).i]=E.x(w);return i.join("")})}function C_(e,t){var r=typeof t,n;return t==null||r==="boolean"?gL(t):(r==="number"?sT:r==="string"?(n=nw(t))?(t=n,k7):WTe:t instanceof nw?k7:t instanceof Date?UTe:BTe(t)?FTe:Array.isArray(t)?VTe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$Te:sT)(e,t)}function yL(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function HTe(e,t){t===void 0&&(t=e,e=C_);for(var r=0,n=t.length-1,a=t[0],l=new Array(n<0?0:n);r<n;)l[r]=e(a,a=t[++r]);return function(f){var i=Math.max(0,Math.min(n-1,Math.floor(f*=n)));return l[i](f-i)}}function KTe(e){return function(){return e}}function oT(e){return+e}var M7=[0,1];function oc(e){return e}function YR(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:KTe(isNaN(t)?NaN:.5)}function ZTe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function YTe(e,t,r){var n=e[0],a=e[1],l=t[0],f=t[1];return a<n?(n=YR(a,n),l=r(f,l)):(n=YR(n,a),l=r(l,f)),function(i){return l(n(i))}}function XTe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),l=new Array(n),f=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++f<n;)a[f]=YR(e[f],e[f+1]),l[f]=r(t[f],t[f+1]);return function(i){var _=r2(e,i,1,n)-1;return l[_](a[_](i))}}function i2(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function UP(){var e=M7,t=M7,r=C_,n,a,l,f=oc,i,_,w;function A(){var O=Math.min(e.length,t.length);return f!==oc&&(f=ZTe(e[0],e[O-1])),i=O>2?XTe:YTe,_=w=null,E}function E(O){return O==null||isNaN(O=+O)?l:(_||(_=i(e.map(n),t,r)))(n(f(O)))}return E.invert=function(O){return f(a((w||(w=i(t,e.map(n),sT)))(O)))},E.domain=function(O){return arguments.length?(e=Array.from(O,oT),A()):e.slice()},E.range=function(O){return arguments.length?(t=Array.from(O),A()):t.slice()},E.rangeRound=function(O){return t=Array.from(O),r=yL,A()},E.clamp=function(O){return arguments.length?(f=O?!0:oc,A()):f!==oc},E.interpolate=function(O){return arguments.length?(r=O,A()):r},E.unknown=function(O){return arguments.length?(l=O,E):l},function(O,F){return n=O,a=F,A()}}function vL(){return UP()(oc,oc)}function JTe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function lT(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ix(e){return e=lT(Math.abs(e)),e?e[1]:NaN}function QTe(e,t){return function(r,n){for(var a=r.length,l=[],f=0,i=e[0],_=0;a>0&&i>0&&(_+i+1>n&&(i=Math.max(1,n-_)),l.push(r.substring(a-=i,a+i)),!((_+=i+1)>n));)i=e[f=(f+1)%e.length];return l.reverse().join(t)}}function ePe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var tPe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function iw(e){if(!(t=tPe.exec(e)))throw new Error("invalid format: "+e);var t;return new xL({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}iw.prototype=xL.prototype;function xL(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}xL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function rPe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var EJ;function nPe(e,t){var r=lT(e,t);if(!r)return e+"";var n=r[0],a=r[1],l=a-(EJ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,f=n.length;return l===f?n:l>f?n+new Array(l-f+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+lT(e,Math.max(0,t+l-1))[0]}function j7(e,t){var r=lT(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const O7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:JTe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>j7(e*100,t),r:j7,s:nPe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function N7(e){return e}var R7=Array.prototype.map,I7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function iPe(e){var t=e.grouping===void 0||e.thousands===void 0?N7:QTe(R7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?N7:ePe(R7.call(e.numerals,String)),f=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",_=e.nan===void 0?"NaN":e.nan+"";function w(E){E=iw(E);var O=E.fill,F=E.align,U=E.sign,B=E.symbol,q=E.zero,W=E.width,Z=E.comma,ne=E.precision,ae=E.trim,ee=E.type;ee==="n"?(Z=!0,ee="g"):O7[ee]||(ne===void 0&&(ne=12),ae=!0,ee="g"),(q||O==="0"&&F==="=")&&(q=!0,O="0",F="=");var se=B==="$"?r:B==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",ce=B==="$"?n:/[%p]/.test(ee)?f:"",ge=O7[ee],Te=/[defgprs%]/.test(ee);ne=ne===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,ne)):Math.max(0,Math.min(20,ne));function Ae(_e){var Ee=se,ke=ce,Qe,Ze,Ge;if(ee==="c")ke=ge(_e)+ke,_e="";else{_e=+_e;var Oe=_e<0||1/_e<0;if(_e=isNaN(_e)?_:ge(Math.abs(_e),ne),ae&&(_e=rPe(_e)),Oe&&+_e==0&&U!=="+"&&(Oe=!1),Ee=(Oe?U==="("?U:i:U==="-"||U==="("?"":U)+Ee,ke=(ee==="s"?I7[8+EJ/3]:"")+ke+(Oe&&U==="("?")":""),Te){for(Qe=-1,Ze=_e.length;++Qe<Ze;)if(Ge=_e.charCodeAt(Qe),48>Ge||Ge>57){ke=(Ge===46?a+_e.slice(Qe+1):_e.slice(Qe))+ke,_e=_e.slice(0,Qe);break}}}Z&&!q&&(_e=t(_e,1/0));var je=Ee.length+_e.length+ke.length,Le=je<W?new Array(W-je+1).join(O):"";switch(Z&&q&&(_e=t(Le+_e,Le.length?W-ke.length:1/0),Le=""),F){case"<":_e=Ee+_e+ke+Le;break;case"=":_e=Ee+Le+_e+ke;break;case"^":_e=Le.slice(0,je=Le.length>>1)+Ee+_e+ke+Le.slice(je);break;default:_e=Le+Ee+_e+ke;break}return l(_e)}return Ae.toString=function(){return E+""},Ae}function A(E,O){var F=w((E=iw(E),E.type="f",E)),U=Math.max(-8,Math.min(8,Math.floor(Ix(O)/3)))*3,B=Math.pow(10,-U),q=I7[8+U/3];return function(W){return F(B*W)+q}}return{format:w,formatPrefix:A}}var zS,_L,kJ;aPe({thousands:",",grouping:[3],currency:["$",""]});function aPe(e){return zS=iPe(e),_L=zS.format,kJ=zS.formatPrefix,zS}function sPe(e){return Math.max(0,-Ix(Math.abs(e)))}function oPe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ix(t)/3)))*3-Ix(Math.abs(e)))}function lPe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ix(t)-Ix(e))+1}function MJ(e,t,r,n){var a=WR(e,t,r),l;switch(n=iw(n??",f"),n.type){case"s":{var f=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(l=oPe(a,f))&&(n.precision=l),kJ(n,f)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=lPe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=sPe(a))&&(n.precision=l-(n.type==="%")*2);break}}return _L(n)}function ry(e){var t=e.domain;return e.ticks=function(r){var n=t();return qR(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return MJ(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,l=n.length-1,f=n[a],i=n[l],_,w,A=10;for(i<f&&(w=f,f=i,i=w,w=a,a=l,l=w);A-- >0;){if(w=GR(f,i,r),w===_)return n[a]=f,n[l]=i,t(n);if(w>0)f=Math.floor(f/w)*w,i=Math.ceil(i/w)*w;else if(w<0)f=Math.ceil(f*w)/w,i=Math.floor(i*w)/w;else break;_=w}return e},e}function cT(){var e=vL();return e.copy=function(){return i2(e,cT())},Md.apply(e,arguments),ry(e)}function jJ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,oT),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return jJ(e).unknown(t)},e=arguments.length?Array.from(e,oT):[0,1],ry(r)}function OJ(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],l=e[n],f;return l<a&&(f=r,r=n,n=f,f=a,a=l,l=f),e[r]=t.floor(a),e[n]=t.ceil(l),e}function D7(e){return Math.log(e)}function L7(e){return Math.exp(e)}function cPe(e){return-Math.log(-e)}function uPe(e){return-Math.exp(-e)}function dPe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function hPe(e){return e===10?dPe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function fPe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function z7(e){return(t,r)=>-e(-t,r)}function bL(e){const t=e(D7,L7),r=t.domain;let n=10,a,l;function f(){return a=fPe(n),l=hPe(n),r()[0]<0?(a=z7(a),l=z7(l),e(cPe,uPe)):e(D7,L7),t}return t.base=function(i){return arguments.length?(n=+i,f()):n},t.domain=function(i){return arguments.length?(r(i),f()):r()},t.ticks=i=>{const _=r();let w=_[0],A=_[_.length-1];const E=A<w;E&&([w,A]=[A,w]);let O=a(w),F=a(A),U,B;const q=i==null?10:+i;let W=[];if(!(n%1)&&F-O<q){if(O=Math.floor(O),F=Math.ceil(F),w>0){for(;O<=F;++O)for(U=1;U<n;++U)if(B=O<0?U/l(-O):U*l(O),!(B<w)){if(B>A)break;W.push(B)}}else for(;O<=F;++O)for(U=n-1;U>=1;--U)if(B=O>0?U/l(-O):U*l(O),!(B<w)){if(B>A)break;W.push(B)}W.length*2<q&&(W=qR(w,A,q))}else W=qR(O,F,Math.min(F-O,q)).map(l);return E?W.reverse():W},t.tickFormat=(i,_)=>{if(i==null&&(i=10),_==null&&(_=n===10?"s":","),typeof _!="function"&&(!(n%1)&&(_=iw(_)).precision==null&&(_.trim=!0),_=_L(_)),i===1/0)return _;const w=Math.max(1,n*i/t.ticks().length);return A=>{let E=A/l(Math.round(a(A)));return E*n<n-.5&&(E*=n),E<=w?_(A):""}},t.nice=()=>r(OJ(r(),{floor:i=>l(Math.floor(a(i))),ceil:i=>l(Math.ceil(a(i)))})),t}function NJ(){const e=bL(UP()).domain([1,10]);return e.copy=()=>i2(e,NJ()).base(e.base()),Md.apply(e,arguments),e}function F7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function B7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function wL(e){var t=1,r=e(F7(t),B7(t));return r.constant=function(n){return arguments.length?e(F7(t=+n),B7(t)):t},ry(r)}function RJ(){var e=wL(UP());return e.copy=function(){return i2(e,RJ()).constant(e.constant())},Md.apply(e,arguments)}function V7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pPe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function mPe(e){return e<0?-e*e:e*e}function SL(e){var t=e(oc,oc),r=1;function n(){return r===1?e(oc,oc):r===.5?e(pPe,mPe):e(V7(r),V7(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ry(t)}function AL(){var e=SL(UP());return e.copy=function(){return i2(e,AL()).exponent(e.exponent())},Md.apply(e,arguments),e}function gPe(){return AL.apply(null,arguments).exponent(.5)}function U7(e){return Math.sign(e)*e*e}function yPe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function IJ(){var e=vL(),t=[0,1],r=!1,n;function a(l){var f=yPe(e(l));return isNaN(f)?n:r?Math.round(f):f}return a.invert=function(l){return e.invert(U7(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,oT)).map(U7)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(r=!!l,a):r},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return IJ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Md.apply(a,arguments),ry(a)}function DJ(){var e=[],t=[],r=[],n;function a(){var f=0,i=Math.max(1,t.length);for(r=new Array(i-1);++f<i;)r[f-1]=wTe(e,f/i);return l}function l(f){return f==null||isNaN(f=+f)?n:t[r2(r,f)]}return l.invertExtent=function(f){var i=t.indexOf(f);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},l.domain=function(f){if(!arguments.length)return e.slice();e=[];for(let i of f)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Ig),a()},l.range=function(f){return arguments.length?(t=Array.from(f),a()):t.slice()},l.unknown=function(f){return arguments.length?(n=f,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return DJ().domain(e).range(t).unknown(n)},Md.apply(l,arguments)}function LJ(){var e=0,t=1,r=1,n=[.5],a=[0,1],l;function f(_){return _!=null&&_<=_?a[r2(n,_,0,r)]:l}function i(){var _=-1;for(n=new Array(r);++_<r;)n[_]=((_+1)*t-(_-r)*e)/(r+1);return f}return f.domain=function(_){return arguments.length?([e,t]=_,e=+e,t=+t,i()):[e,t]},f.range=function(_){return arguments.length?(r=(a=Array.from(_)).length-1,i()):a.slice()},f.invertExtent=function(_){var w=a.indexOf(_);return w<0?[NaN,NaN]:w<1?[e,n[0]]:w>=r?[n[r-1],t]:[n[w-1],n[w]]},f.unknown=function(_){return arguments.length&&(l=_),f},f.thresholds=function(){return n.slice()},f.copy=function(){return LJ().domain([e,t]).range(a).unknown(l)},Md.apply(ry(f),arguments)}function zJ(){var e=[.5],t=[0,1],r,n=1;function a(l){return l!=null&&l<=l?t[r2(e,l,0,n)]:r}return a.domain=function(l){return arguments.length?(e=Array.from(l),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var f=t.indexOf(l);return[e[f-1],e[f]]},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return zJ().domain(e).range(t).unknown(r)},Md.apply(a,arguments)}const SO=new Date,AO=new Date;function Lo(e,t,r,n){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const f=a(l),i=a.ceil(l);return l-f<i-l?f:i},a.offset=(l,f)=>(t(l=new Date(+l),f==null?1:Math.floor(f)),l),a.range=(l,f,i)=>{const _=[];if(l=a.ceil(l),i=i==null?1:Math.floor(i),!(l<f)||!(i>0))return _;let w;do _.push(w=new Date(+l)),t(l,i),e(l);while(w<l&&l<f);return _},a.filter=l=>Lo(f=>{if(f>=f)for(;e(f),!l(f);)f.setTime(f-1)},(f,i)=>{if(f>=f)if(i<0)for(;++i<=0;)for(;t(f,-1),!l(f););else for(;--i>=0;)for(;t(f,1),!l(f););}),r&&(a.count=(l,f)=>(SO.setTime(+l),AO.setTime(+f),e(SO),e(AO),Math.floor(r(SO,AO))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(n?f=>n(f)%l===0:f=>a.count(0,f)%l===0):a)),a}const uT=Lo(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);uT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Lo(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):uT);uT.range;const rm=1e3,bd=rm*60,nm=bd*60,gm=nm*24,TL=gm*7,$7=gm*30,TO=gm*365,wv=Lo(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*rm)},(e,t)=>(t-e)/rm,e=>e.getUTCSeconds());wv.range;const PL=Lo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*rm)},(e,t)=>{e.setTime(+e+t*bd)},(e,t)=>(t-e)/bd,e=>e.getMinutes());PL.range;const CL=Lo(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*bd)},(e,t)=>(t-e)/bd,e=>e.getUTCMinutes());CL.range;const EL=Lo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*rm-e.getMinutes()*bd)},(e,t)=>{e.setTime(+e+t*nm)},(e,t)=>(t-e)/nm,e=>e.getHours());EL.range;const kL=Lo(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*nm)},(e,t)=>(t-e)/nm,e=>e.getUTCHours());kL.range;const a2=Lo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*bd)/gm,e=>e.getDate()-1);a2.range;const $P=Lo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gm,e=>e.getUTCDate()-1);$P.range;const FJ=Lo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gm,e=>Math.floor(e/gm));FJ.range;function Jv(e){return Lo(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*bd)/TL)}const qP=Jv(0),dT=Jv(1),vPe=Jv(2),xPe=Jv(3),Dx=Jv(4),_Pe=Jv(5),bPe=Jv(6);qP.range;dT.range;vPe.range;xPe.range;Dx.range;_Pe.range;bPe.range;function Qv(e){return Lo(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/TL)}const GP=Qv(0),hT=Qv(1),wPe=Qv(2),SPe=Qv(3),Lx=Qv(4),APe=Qv(5),TPe=Qv(6);GP.range;hT.range;wPe.range;SPe.range;Lx.range;APe.range;TPe.range;const ML=Lo(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());ML.range;const jL=Lo(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());jL.range;const ym=Lo(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ym.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Lo(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ym.range;const vm=Lo(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());vm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Lo(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});vm.range;function BJ(e,t,r,n,a,l){const f=[[wv,1,rm],[wv,5,5*rm],[wv,15,15*rm],[wv,30,30*rm],[l,1,bd],[l,5,5*bd],[l,15,15*bd],[l,30,30*bd],[a,1,nm],[a,3,3*nm],[a,6,6*nm],[a,12,12*nm],[n,1,gm],[n,2,2*gm],[r,1,TL],[t,1,$7],[t,3,3*$7],[e,1,TO]];function i(w,A,E){const O=A<w;O&&([w,A]=[A,w]);const F=E&&typeof E.range=="function"?E:_(w,A,E),U=F?F.range(w,+A+1):[];return O?U.reverse():U}function _(w,A,E){const O=Math.abs(A-w)/E,F=fL(([,,q])=>q).right(f,O);if(F===f.length)return e.every(WR(w/TO,A/TO,E));if(F===0)return uT.every(Math.max(WR(w,A,E),1));const[U,B]=f[O/f[F-1][2]<f[F][2]/O?F-1:F];return U.every(B)}return[i,_]}const[PPe,CPe]=BJ(vm,jL,GP,FJ,kL,CL),[EPe,kPe]=BJ(ym,ML,qP,a2,EL,PL);function PO(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function CO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Db(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function MPe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,l=e.days,f=e.shortDays,i=e.months,_=e.shortMonths,w=Lb(a),A=zb(a),E=Lb(l),O=zb(l),F=Lb(f),U=zb(f),B=Lb(i),q=zb(i),W=Lb(_),Z=zb(_),ne={a:Oe,A:je,b:Le,B:ut,c:null,d:Z7,e:Z7,f:QPe,g:cCe,G:dCe,H:YPe,I:XPe,j:JPe,L:VJ,m:eCe,M:tCe,p:ze,q:ht,Q:J7,s:Q7,S:rCe,u:nCe,U:iCe,V:aCe,w:sCe,W:oCe,x:null,X:null,y:lCe,Y:uCe,Z:hCe,"%":X7},ae={a:rt,A:Qt,b:Cr,B:vr,c:null,d:Y7,e:Y7,f:gCe,g:PCe,G:ECe,H:fCe,I:pCe,j:mCe,L:$J,m:yCe,M:vCe,p:cr,q:nr,Q:J7,s:Q7,S:xCe,u:_Ce,U:bCe,V:wCe,w:SCe,W:ACe,x:null,X:null,y:TCe,Y:CCe,Z:kCe,"%":X7},ee={a:Ae,A:_e,b:Ee,B:ke,c:Qe,d:H7,e:H7,f:WPe,g:W7,G:G7,H:K7,I:K7,j:UPe,L:GPe,m:VPe,M:$Pe,p:Te,q:BPe,Q:KPe,s:ZPe,S:qPe,u:IPe,U:DPe,V:LPe,w:RPe,W:zPe,x:Ze,X:Ge,y:W7,Y:G7,Z:FPe,"%":HPe};ne.x=se(r,ne),ne.X=se(n,ne),ne.c=se(t,ne),ae.x=se(r,ae),ae.X=se(n,ae),ae.c=se(t,ae);function se(Kt,De){return function(er){var Lt=[],Rr=-1,Pt=0,nn=Kt.length,Sn,Br,et;for(er instanceof Date||(er=new Date(+er));++Rr<nn;)Kt.charCodeAt(Rr)===37&&(Lt.push(Kt.slice(Pt,Rr)),(Br=q7[Sn=Kt.charAt(++Rr)])!=null?Sn=Kt.charAt(++Rr):Br=Sn==="e"?" ":"0",(et=De[Sn])&&(Sn=et(er,Br)),Lt.push(Sn),Pt=Rr+1);return Lt.push(Kt.slice(Pt,Rr)),Lt.join("")}}function ce(Kt,De){return function(er){var Lt=Db(1900,void 0,1),Rr=ge(Lt,Kt,er+="",0),Pt,nn;if(Rr!=er.length)return null;if("Q"in Lt)return new Date(Lt.Q);if("s"in Lt)return new Date(Lt.s*1e3+("L"in Lt?Lt.L:0));if(De&&!("Z"in Lt)&&(Lt.Z=0),"p"in Lt&&(Lt.H=Lt.H%12+Lt.p*12),Lt.m===void 0&&(Lt.m="q"in Lt?Lt.q:0),"V"in Lt){if(Lt.V<1||Lt.V>53)return null;"w"in Lt||(Lt.w=1),"Z"in Lt?(Pt=CO(Db(Lt.y,0,1)),nn=Pt.getUTCDay(),Pt=nn>4||nn===0?hT.ceil(Pt):hT(Pt),Pt=$P.offset(Pt,(Lt.V-1)*7),Lt.y=Pt.getUTCFullYear(),Lt.m=Pt.getUTCMonth(),Lt.d=Pt.getUTCDate()+(Lt.w+6)%7):(Pt=PO(Db(Lt.y,0,1)),nn=Pt.getDay(),Pt=nn>4||nn===0?dT.ceil(Pt):dT(Pt),Pt=a2.offset(Pt,(Lt.V-1)*7),Lt.y=Pt.getFullYear(),Lt.m=Pt.getMonth(),Lt.d=Pt.getDate()+(Lt.w+6)%7)}else("W"in Lt||"U"in Lt)&&("w"in Lt||(Lt.w="u"in Lt?Lt.u%7:"W"in Lt?1:0),nn="Z"in Lt?CO(Db(Lt.y,0,1)).getUTCDay():PO(Db(Lt.y,0,1)).getDay(),Lt.m=0,Lt.d="W"in Lt?(Lt.w+6)%7+Lt.W*7-(nn+5)%7:Lt.w+Lt.U*7-(nn+6)%7);return"Z"in Lt?(Lt.H+=Lt.Z/100|0,Lt.M+=Lt.Z%100,CO(Lt)):PO(Lt)}}function ge(Kt,De,er,Lt){for(var Rr=0,Pt=De.length,nn=er.length,Sn,Br;Rr<Pt;){if(Lt>=nn)return-1;if(Sn=De.charCodeAt(Rr++),Sn===37){if(Sn=De.charAt(Rr++),Br=ee[Sn in q7?De.charAt(Rr++):Sn],!Br||(Lt=Br(Kt,er,Lt))<0)return-1}else if(Sn!=er.charCodeAt(Lt++))return-1}return Lt}function Te(Kt,De,er){var Lt=w.exec(De.slice(er));return Lt?(Kt.p=A.get(Lt[0].toLowerCase()),er+Lt[0].length):-1}function Ae(Kt,De,er){var Lt=F.exec(De.slice(er));return Lt?(Kt.w=U.get(Lt[0].toLowerCase()),er+Lt[0].length):-1}function _e(Kt,De,er){var Lt=E.exec(De.slice(er));return Lt?(Kt.w=O.get(Lt[0].toLowerCase()),er+Lt[0].length):-1}function Ee(Kt,De,er){var Lt=W.exec(De.slice(er));return Lt?(Kt.m=Z.get(Lt[0].toLowerCase()),er+Lt[0].length):-1}function ke(Kt,De,er){var Lt=B.exec(De.slice(er));return Lt?(Kt.m=q.get(Lt[0].toLowerCase()),er+Lt[0].length):-1}function Qe(Kt,De,er){return ge(Kt,t,De,er)}function Ze(Kt,De,er){return ge(Kt,r,De,er)}function Ge(Kt,De,er){return ge(Kt,n,De,er)}function Oe(Kt){return f[Kt.getDay()]}function je(Kt){return l[Kt.getDay()]}function Le(Kt){return _[Kt.getMonth()]}function ut(Kt){return i[Kt.getMonth()]}function ze(Kt){return a[+(Kt.getHours()>=12)]}function ht(Kt){return 1+~~(Kt.getMonth()/3)}function rt(Kt){return f[Kt.getUTCDay()]}function Qt(Kt){return l[Kt.getUTCDay()]}function Cr(Kt){return _[Kt.getUTCMonth()]}function vr(Kt){return i[Kt.getUTCMonth()]}function cr(Kt){return a[+(Kt.getUTCHours()>=12)]}function nr(Kt){return 1+~~(Kt.getUTCMonth()/3)}return{format:function(Kt){var De=se(Kt+="",ne);return De.toString=function(){return Kt},De},parse:function(Kt){var De=ce(Kt+="",!1);return De.toString=function(){return Kt},De},utcFormat:function(Kt){var De=se(Kt+="",ae);return De.toString=function(){return Kt},De},utcParse:function(Kt){var De=ce(Kt+="",!0);return De.toString=function(){return Kt},De}}}var q7={"-":"",_:" ",0:"0"},il=/^\s*\d+/,jPe=/^%/,OPe=/[\\^$*+?|[\]().{}]/g;function sa(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",l=a.length;return n+(l<r?new Array(r-l+1).join(t)+a:a)}function NPe(e){return e.replace(OPe,"\\$&")}function Lb(e){return new RegExp("^(?:"+e.map(NPe).join("|")+")","i")}function zb(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function RPe(e,t,r){var n=il.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function IPe(e,t,r){var n=il.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function DPe(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function LPe(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function zPe(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function G7(e,t,r){var n=il.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function W7(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function FPe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function BPe(e,t,r){var n=il.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function VPe(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function H7(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function UPe(e,t,r){var n=il.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function K7(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function $Pe(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function qPe(e,t,r){var n=il.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function GPe(e,t,r){var n=il.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function WPe(e,t,r){var n=il.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function HPe(e,t,r){var n=jPe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function KPe(e,t,r){var n=il.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function ZPe(e,t,r){var n=il.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Z7(e,t){return sa(e.getDate(),t,2)}function YPe(e,t){return sa(e.getHours(),t,2)}function XPe(e,t){return sa(e.getHours()%12||12,t,2)}function JPe(e,t){return sa(1+a2.count(ym(e),e),t,3)}function VJ(e,t){return sa(e.getMilliseconds(),t,3)}function QPe(e,t){return VJ(e,t)+"000"}function eCe(e,t){return sa(e.getMonth()+1,t,2)}function tCe(e,t){return sa(e.getMinutes(),t,2)}function rCe(e,t){return sa(e.getSeconds(),t,2)}function nCe(e){var t=e.getDay();return t===0?7:t}function iCe(e,t){return sa(qP.count(ym(e)-1,e),t,2)}function UJ(e){var t=e.getDay();return t>=4||t===0?Dx(e):Dx.ceil(e)}function aCe(e,t){return e=UJ(e),sa(Dx.count(ym(e),e)+(ym(e).getDay()===4),t,2)}function sCe(e){return e.getDay()}function oCe(e,t){return sa(dT.count(ym(e)-1,e),t,2)}function lCe(e,t){return sa(e.getFullYear()%100,t,2)}function cCe(e,t){return e=UJ(e),sa(e.getFullYear()%100,t,2)}function uCe(e,t){return sa(e.getFullYear()%1e4,t,4)}function dCe(e,t){var r=e.getDay();return e=r>=4||r===0?Dx(e):Dx.ceil(e),sa(e.getFullYear()%1e4,t,4)}function hCe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+sa(t/60|0,"0",2)+sa(t%60,"0",2)}function Y7(e,t){return sa(e.getUTCDate(),t,2)}function fCe(e,t){return sa(e.getUTCHours(),t,2)}function pCe(e,t){return sa(e.getUTCHours()%12||12,t,2)}function mCe(e,t){return sa(1+$P.count(vm(e),e),t,3)}function $J(e,t){return sa(e.getUTCMilliseconds(),t,3)}function gCe(e,t){return $J(e,t)+"000"}function yCe(e,t){return sa(e.getUTCMonth()+1,t,2)}function vCe(e,t){return sa(e.getUTCMinutes(),t,2)}function xCe(e,t){return sa(e.getUTCSeconds(),t,2)}function _Ce(e){var t=e.getUTCDay();return t===0?7:t}function bCe(e,t){return sa(GP.count(vm(e)-1,e),t,2)}function qJ(e){var t=e.getUTCDay();return t>=4||t===0?Lx(e):Lx.ceil(e)}function wCe(e,t){return e=qJ(e),sa(Lx.count(vm(e),e)+(vm(e).getUTCDay()===4),t,2)}function SCe(e){return e.getUTCDay()}function ACe(e,t){return sa(hT.count(vm(e)-1,e),t,2)}function TCe(e,t){return sa(e.getUTCFullYear()%100,t,2)}function PCe(e,t){return e=qJ(e),sa(e.getUTCFullYear()%100,t,2)}function CCe(e,t){return sa(e.getUTCFullYear()%1e4,t,4)}function ECe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Lx(e):Lx.ceil(e),sa(e.getUTCFullYear()%1e4,t,4)}function kCe(){return"+0000"}function X7(){return"%"}function J7(e){return+e}function Q7(e){return Math.floor(+e/1e3)}var Y0,GJ,WJ;MCe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function MCe(e){return Y0=MPe(e),GJ=Y0.format,Y0.parse,WJ=Y0.utcFormat,Y0.utcParse,Y0}function jCe(e){return new Date(e)}function OCe(e){return e instanceof Date?+e:+new Date(+e)}function OL(e,t,r,n,a,l,f,i,_,w){var A=vL(),E=A.invert,O=A.domain,F=w(".%L"),U=w(":%S"),B=w("%I:%M"),q=w("%I %p"),W=w("%a %d"),Z=w("%b %d"),ne=w("%B"),ae=w("%Y");function ee(se){return(_(se)<se?F:i(se)<se?U:f(se)<se?B:l(se)<se?q:n(se)<se?a(se)<se?W:Z:r(se)<se?ne:ae)(se)}return A.invert=function(se){return new Date(E(se))},A.domain=function(se){return arguments.length?O(Array.from(se,OCe)):O().map(jCe)},A.ticks=function(se){var ce=O();return e(ce[0],ce[ce.length-1],se??10)},A.tickFormat=function(se,ce){return ce==null?ee:w(ce)},A.nice=function(se){var ce=O();return(!se||typeof se.range!="function")&&(se=t(ce[0],ce[ce.length-1],se??10)),se?O(OJ(ce,se)):A},A.copy=function(){return i2(A,OL(e,t,r,n,a,l,f,i,_,w))},A}function NCe(){return Md.apply(OL(EPe,kPe,ym,ML,qP,a2,EL,PL,wv,GJ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function RCe(){return Md.apply(OL(PPe,CPe,vm,jL,GP,$P,kL,CL,wv,WJ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function WP(){var e=0,t=1,r,n,a,l,f=oc,i=!1,_;function w(E){return E==null||isNaN(E=+E)?_:f(a===0?.5:(E=(l(E)-r)*a,i?Math.max(0,Math.min(1,E)):E))}w.domain=function(E){return arguments.length?([e,t]=E,r=l(e=+e),n=l(t=+t),a=r===n?0:1/(n-r),w):[e,t]},w.clamp=function(E){return arguments.length?(i=!!E,w):i},w.interpolator=function(E){return arguments.length?(f=E,w):f};function A(E){return function(O){var F,U;return arguments.length?([F,U]=O,f=E(F,U),w):[f(0),f(1)]}}return w.range=A(C_),w.rangeRound=A(yL),w.unknown=function(E){return arguments.length?(_=E,w):_},function(E){return l=E,r=E(e),n=E(t),a=r===n?0:1/(n-r),w}}function ny(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function HJ(){var e=ry(WP()(oc));return e.copy=function(){return ny(e,HJ())},Sm.apply(e,arguments)}function KJ(){var e=bL(WP()).domain([1,10]);return e.copy=function(){return ny(e,KJ()).base(e.base())},Sm.apply(e,arguments)}function ZJ(){var e=wL(WP());return e.copy=function(){return ny(e,ZJ()).constant(e.constant())},Sm.apply(e,arguments)}function NL(){var e=SL(WP());return e.copy=function(){return ny(e,NL()).exponent(e.exponent())},Sm.apply(e,arguments)}function ICe(){return NL.apply(null,arguments).exponent(.5)}function YJ(){var e=[],t=oc;function r(n){if(n!=null&&!isNaN(n=+n))return t((r2(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Ig),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,l)=>bTe(e,l/n))},r.copy=function(){return YJ(t).domain(e)},Sm.apply(r,arguments)}function HP(){var e=0,t=.5,r=1,n=1,a,l,f,i,_,w=oc,A,E=!1,O;function F(B){return isNaN(B=+B)?O:(B=.5+((B=+A(B))-l)*(n*B<n*l?i:_),w(E?Math.max(0,Math.min(1,B)):B))}F.domain=function(B){return arguments.length?([e,t,r]=B,a=A(e=+e),l=A(t=+t),f=A(r=+r),i=a===l?0:.5/(l-a),_=l===f?0:.5/(f-l),n=l<a?-1:1,F):[e,t,r]},F.clamp=function(B){return arguments.length?(E=!!B,F):E},F.interpolator=function(B){return arguments.length?(w=B,F):w};function U(B){return function(q){var W,Z,ne;return arguments.length?([W,Z,ne]=q,w=HTe(B,[W,Z,ne]),F):[w(0),w(.5),w(1)]}}return F.range=U(C_),F.rangeRound=U(yL),F.unknown=function(B){return arguments.length?(O=B,F):O},function(B){return A=B,a=B(e),l=B(t),f=B(r),i=a===l?0:.5/(l-a),_=l===f?0:.5/(f-l),n=l<a?-1:1,F}}function XJ(){var e=ry(HP()(oc));return e.copy=function(){return ny(e,XJ())},Sm.apply(e,arguments)}function JJ(){var e=bL(HP()).domain([.1,1,10]);return e.copy=function(){return ny(e,JJ()).base(e.base())},Sm.apply(e,arguments)}function QJ(){var e=wL(HP());return e.copy=function(){return ny(e,QJ()).constant(e.constant())},Sm.apply(e,arguments)}function RL(){var e=SL(HP());return e.copy=function(){return ny(e,RL()).exponent(e.exponent())},Sm.apply(e,arguments)}function DCe(){return RL.apply(null,arguments).exponent(.5)}const eq=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:ew,scaleDiverging:XJ,scaleDivergingLog:JJ,scaleDivergingPow:RL,scaleDivergingSqrt:DCe,scaleDivergingSymlog:QJ,scaleIdentity:jJ,scaleImplicit:HR,scaleLinear:cT,scaleLog:NJ,scaleOrdinal:pL,scalePoint:c1,scalePow:AL,scaleQuantile:DJ,scaleQuantize:LJ,scaleRadial:IJ,scaleSequential:HJ,scaleSequentialLog:KJ,scaleSequentialPow:NL,scaleSequentialQuantile:YJ,scaleSequentialSqrt:ICe,scaleSequentialSymlog:ZJ,scaleSqrt:gPe,scaleSymlog:RJ,scaleThreshold:zJ,scaleTime:NCe,scaleUtc:RCe,tickFormat:MJ},Symbol.toStringTag,{value:"Module"}));var EO,tq;function KP(){if(tq)return EO;tq=1;var e=S_();function t(r,n,a){for(var l=-1,f=r.length;++l<f;){var i=r[l],_=n(i);if(_!=null&&(w===void 0?_===_&&!e(_):a(_,w)))var w=_,A=i}return A}return EO=t,EO}var kO,rq;function eQ(){if(rq)return kO;rq=1;function e(t,r){return t>r}return kO=e,kO}var MO,nq;function LCe(){if(nq)return MO;nq=1;var e=KP(),t=eQ(),r=P_();function n(a){return a&&a.length?e(a,r,t):void 0}return MO=n,MO}var zCe=LCe();const Mg=oa(zCe);var jO,iq;function tQ(){if(iq)return jO;iq=1;function e(t,r){return t<r}return jO=e,jO}var OO,aq;function FCe(){if(aq)return OO;aq=1;var e=KP(),t=tQ(),r=P_();function n(a){return a&&a.length?e(a,r,t):void 0}return OO=n,OO}var BCe=FCe();const ZP=oa(BCe);var NO,sq;function VCe(){if(sq)return NO;sq=1;var e=XD(),t=ap(),r=cJ(),n=Bc();function a(l,f){var i=n(l)?e:r;return i(l,t(f,3))}return NO=a,NO}var RO,oq;function UCe(){if(oq)return RO;oq=1;var e=oJ(),t=VCe();function r(n,a){return e(t(n,a),1)}return RO=r,RO}var $Ce=UCe();const qCe=oa($Ce);var IO,lq;function GCe(){if(lq)return IO;lq=1;var e=cL();function t(r,n){return e(r,n)}return IO=t,IO}var WCe=GCe();const xm=oa(WCe);var E_=1e9,HCe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},DL,_s=!0,Cd="[DecimalError] ",kv=Cd+"Invalid argument: ",IL=Cd+"Exponent out of range: ",k_=Math.floor,uv=Math.pow,KCe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,gu,el=1e7,cs=7,rQ=9007199254740991,fT=k_(rQ/cs),dn={};dn.absoluteValue=dn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};dn.comparedTo=dn.cmp=function(e){var t,r,n,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(n=l.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return n===a?0:n>a^l.s<0?1:-1};dn.decimalPlaces=dn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*cs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};dn.dividedBy=dn.div=function(e){return cm(this,new this.constructor(e))};dn.dividedToIntegerBy=dn.idiv=function(e){var t=this,r=t.constructor;return Fa(cm(t,new r(e),0,1),r.precision)};dn.equals=dn.eq=function(e){return!this.cmp(e)};dn.exponent=function(){return po(this)};dn.greaterThan=dn.gt=function(e){return this.cmp(e)>0};dn.greaterThanOrEqualTo=dn.gte=function(e){return this.cmp(e)>=0};dn.isInteger=dn.isint=function(){return this.e>this.d.length-2};dn.isNegative=dn.isneg=function(){return this.s<0};dn.isPositive=dn.ispos=function(){return this.s>0};dn.isZero=function(){return this.s===0};dn.lessThan=dn.lt=function(e){return this.cmp(e)<0};dn.lessThanOrEqualTo=dn.lte=function(e){return this.cmp(e)<1};dn.logarithm=dn.log=function(e){var t,r=this,n=r.constructor,a=n.precision,l=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(gu))throw Error(Cd+"NaN");if(r.s<1)throw Error(Cd+(r.s?"NaN":"-Infinity"));return r.eq(gu)?new n(0):(_s=!1,t=cm(aw(r,l),aw(e,l),l),_s=!0,Fa(t,a))};dn.minus=dn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aQ(t,e):nQ(t,(e.s=-e.s,e))};dn.modulo=dn.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Cd+"NaN");return r.s?(_s=!1,t=cm(r,e,0,1).times(e),_s=!0,r.minus(t)):Fa(new n(r),a)};dn.naturalExponential=dn.exp=function(){return iQ(this)};dn.naturalLogarithm=dn.ln=function(){return aw(this)};dn.negated=dn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};dn.plus=dn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?nQ(t,e):aQ(t,(e.s=-e.s,e))};dn.precision=dn.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(kv+e);if(t=po(a)+1,n=a.d.length-1,r=n*cs+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};dn.squareRoot=dn.sqrt=function(){var e,t,r,n,a,l,f,i=this,_=i.constructor;if(i.s<1){if(!i.s)return new _(0);throw Error(Cd+"NaN")}for(e=po(i),_s=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=Rf(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=k_((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new _(t)):n=new _(a.toString()),r=_.precision,a=f=r+3;;)if(l=n,n=l.plus(cm(i,l,f+2)).times(.5),Rf(l.d).slice(0,f)===(t=Rf(n.d)).slice(0,f)){if(t=t.slice(f-3,f+1),a==f&&t=="4999"){if(Fa(l,r+1,0),l.times(l).eq(i)){n=l;break}}else if(t!="9999")break;f+=4}return _s=!0,Fa(n,r)};dn.times=dn.mul=function(e){var t,r,n,a,l,f,i,_,w,A=this,E=A.constructor,O=A.d,F=(e=new E(e)).d;if(!A.s||!e.s)return new E(0);for(e.s*=A.s,r=A.e+e.e,_=O.length,w=F.length,_<w&&(l=O,O=F,F=l,f=_,_=w,w=f),l=[],f=_+w,n=f;n--;)l.push(0);for(n=w;--n>=0;){for(t=0,a=_+n;a>n;)i=l[a]+F[n]*O[a-n-1]+t,l[a--]=i%el|0,t=i/el|0;l[a]=(l[a]+t)%el|0}for(;!l[--f];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,_s?Fa(e,E.precision):e};dn.toDecimalPlaces=dn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Jf(e,0,E_),t===void 0?t=n.rounding:Jf(t,0,8),Fa(r,e+po(r)+1,t))};dn.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Fv(n,!0):(Jf(e,0,E_),t===void 0?t=a.rounding:Jf(t,0,8),n=Fa(new a(n),e+1,t),r=Fv(n,!0,e+1)),r};dn.toFixed=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?Fv(a):(Jf(e,0,E_),t===void 0?t=l.rounding:Jf(t,0,8),n=Fa(new l(a),e+po(a)+1,t),r=Fv(n.abs(),!1,e+po(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};dn.toInteger=dn.toint=function(){var e=this,t=e.constructor;return Fa(new t(e),po(e)+1,t.rounding)};dn.toNumber=function(){return+this};dn.toPower=dn.pow=function(e){var t,r,n,a,l,f,i=this,_=i.constructor,w=12,A=+(e=new _(e));if(!e.s)return new _(gu);if(i=new _(i),!i.s){if(e.s<1)throw Error(Cd+"Infinity");return i}if(i.eq(gu))return i;if(n=_.precision,e.eq(gu))return Fa(i,n);if(t=e.e,r=e.d.length-1,f=t>=r,l=i.s,f){if((r=A<0?-A:A)<=rQ){for(a=new _(gu),t=Math.ceil(n/cs+4),_s=!1;r%2&&(a=a.times(i),uq(a.d,t)),r=k_(r/2),r!==0;)i=i.times(i),uq(i.d,t);return _s=!0,e.s<0?new _(gu).div(a):Fa(a,n)}}else if(l<0)throw Error(Cd+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,_s=!1,a=e.times(aw(i,n+w)),_s=!0,a=iQ(a),a.s=l,a};dn.toPrecision=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?(r=po(a),n=Fv(a,r<=l.toExpNeg||r>=l.toExpPos)):(Jf(e,1,E_),t===void 0?t=l.rounding:Jf(t,0,8),a=Fa(new l(a),e,t),r=po(a),n=Fv(a,e<=r||r<=l.toExpNeg,e)),n};dn.toSignificantDigits=dn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Jf(e,1,E_),t===void 0?t=n.rounding:Jf(t,0,8)),Fa(new n(r),e,t)};dn.toString=dn.valueOf=dn.val=dn.toJSON=dn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=po(e),r=e.constructor;return Fv(e,t<=r.toExpNeg||t>=r.toExpPos)};function nQ(e,t){var r,n,a,l,f,i,_,w,A=e.constructor,E=A.precision;if(!e.s||!t.s)return t.s||(t=new A(e)),_s?Fa(t,E):t;if(_=e.d,w=t.d,f=e.e,a=t.e,_=_.slice(),l=f-a,l){for(l<0?(n=_,l=-l,i=w.length):(n=w,a=f,i=_.length),f=Math.ceil(E/cs),i=f>i?f+1:i+1,l>i&&(l=i,n.length=1),n.reverse();l--;)n.push(0);n.reverse()}for(i=_.length,l=w.length,i-l<0&&(l=i,n=w,w=_,_=n),r=0;l;)r=(_[--l]=_[l]+w[l]+r)/el|0,_[l]%=el;for(r&&(_.unshift(r),++a),i=_.length;_[--i]==0;)_.pop();return t.d=_,t.e=a,_s?Fa(t,E):t}function Jf(e,t,r){if(e!==~~e||e<t||e>r)throw Error(kv+e)}function Rf(e){var t,r,n,a=e.length-1,l="",f=e[0];if(a>0){for(l+=f,t=1;t<a;t++)n=e[t]+"",r=cs-n.length,r&&(l+=Pg(r)),l+=n;f=e[t],n=f+"",r=cs-n.length,r&&(l+=Pg(r))}else if(f===0)return"0";for(;f%10===0;)f/=10;return l+f}var cm=function(){function e(n,a){var l,f=0,i=n.length;for(n=n.slice();i--;)l=n[i]*a+f,n[i]=l%el|0,f=l/el|0;return f&&n.unshift(f),n}function t(n,a,l,f){var i,_;if(l!=f)_=l>f?1:-1;else for(i=_=0;i<l;i++)if(n[i]!=a[i]){_=n[i]>a[i]?1:-1;break}return _}function r(n,a,l){for(var f=0;l--;)n[l]-=f,f=n[l]<a[l]?1:0,n[l]=f*el+n[l]-a[l];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,l,f){var i,_,w,A,E,O,F,U,B,q,W,Z,ne,ae,ee,se,ce,ge,Te=n.constructor,Ae=n.s==a.s?1:-1,_e=n.d,Ee=a.d;if(!n.s)return new Te(n);if(!a.s)throw Error(Cd+"Division by zero");for(_=n.e-a.e,ce=Ee.length,ee=_e.length,F=new Te(Ae),U=F.d=[],w=0;Ee[w]==(_e[w]||0);)++w;if(Ee[w]>(_e[w]||0)&&--_,l==null?Z=l=Te.precision:f?Z=l+(po(n)-po(a))+1:Z=l,Z<0)return new Te(0);if(Z=Z/cs+2|0,w=0,ce==1)for(A=0,Ee=Ee[0],Z++;(w<ee||A)&&Z--;w++)ne=A*el+(_e[w]||0),U[w]=ne/Ee|0,A=ne%Ee|0;else{for(A=el/(Ee[0]+1)|0,A>1&&(Ee=e(Ee,A),_e=e(_e,A),ce=Ee.length,ee=_e.length),ae=ce,B=_e.slice(0,ce),q=B.length;q<ce;)B[q++]=0;ge=Ee.slice(),ge.unshift(0),se=Ee[0],Ee[1]>=el/2&&++se;do A=0,i=t(Ee,B,ce,q),i<0?(W=B[0],ce!=q&&(W=W*el+(B[1]||0)),A=W/se|0,A>1?(A>=el&&(A=el-1),E=e(Ee,A),O=E.length,q=B.length,i=t(E,B,O,q),i==1&&(A--,r(E,ce<O?ge:Ee,O))):(A==0&&(i=A=1),E=Ee.slice()),O=E.length,O<q&&E.unshift(0),r(B,E,q),i==-1&&(q=B.length,i=t(Ee,B,ce,q),i<1&&(A++,r(B,ce<q?ge:Ee,q))),q=B.length):i===0&&(A++,B=[0]),U[w++]=A,i&&B[0]?B[q++]=_e[ae]||0:(B=[_e[ae]],q=1);while((ae++<ee||B[0]!==void 0)&&Z--)}return U[0]||U.shift(),F.e=_,Fa(F,f?l+po(F)+1:l)}}();function iQ(e,t){var r,n,a,l,f,i,_=0,w=0,A=e.constructor,E=A.precision;if(po(e)>16)throw Error(IL+po(e));if(!e.s)return new A(gu);for(_s=!1,i=E,f=new A(.03125);e.abs().gte(.1);)e=e.times(f),w+=5;for(n=Math.log(uv(2,w))/Math.LN10*2+5|0,i+=n,r=a=l=new A(gu),A.precision=i;;){if(a=Fa(a.times(e),i),r=r.times(++_),f=l.plus(cm(a,r,i)),Rf(f.d).slice(0,i)===Rf(l.d).slice(0,i)){for(;w--;)l=Fa(l.times(l),i);return A.precision=E,t==null?(_s=!0,Fa(l,E)):l}l=f}}function po(e){for(var t=e.e*cs,r=e.d[0];r>=10;r/=10)t++;return t}function DO(e,t,r){if(t>e.LN10.sd())throw _s=!0,r&&(e.precision=r),Error(Cd+"LN10 precision limit exceeded");return Fa(new e(e.LN10),t)}function Pg(e){for(var t="";e--;)t+="0";return t}function aw(e,t){var r,n,a,l,f,i,_,w,A,E=1,O=10,F=e,U=F.d,B=F.constructor,q=B.precision;if(F.s<1)throw Error(Cd+(F.s?"NaN":"-Infinity"));if(F.eq(gu))return new B(0);if(t==null?(_s=!1,w=q):w=t,F.eq(10))return t==null&&(_s=!0),DO(B,w);if(w+=O,B.precision=w,r=Rf(U),n=r.charAt(0),l=po(F),Math.abs(l)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)F=F.times(e),r=Rf(F.d),n=r.charAt(0),E++;l=po(F),n>1?(F=new B("0."+r),l++):F=new B(n+"."+r.slice(1))}else return _=DO(B,w+2,q).times(l+""),F=aw(new B(n+"."+r.slice(1)),w-O).plus(_),B.precision=q,t==null?(_s=!0,Fa(F,q)):F;for(i=f=F=cm(F.minus(gu),F.plus(gu),w),A=Fa(F.times(F),w),a=3;;){if(f=Fa(f.times(A),w),_=i.plus(cm(f,new B(a),w)),Rf(_.d).slice(0,w)===Rf(i.d).slice(0,w))return i=i.times(2),l!==0&&(i=i.plus(DO(B,w+2,q).times(l+""))),i=cm(i,new B(E),w),B.precision=q,t==null?(_s=!0,Fa(i,q)):i;i=_,a+=2}}function cq(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=k_(r/cs),e.d=[],n=(r+1)%cs,r<0&&(n+=cs),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=cs;n<a;)e.d.push(+t.slice(n,n+=cs));t=t.slice(n),n=cs-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),_s&&(e.e>fT||e.e<-fT))throw Error(IL+r)}else e.s=0,e.e=0,e.d=[0];return e}function Fa(e,t,r){var n,a,l,f,i,_,w,A,E=e.d;for(f=1,l=E[0];l>=10;l/=10)f++;if(n=t-f,n<0)n+=cs,a=t,w=E[A=0];else{if(A=Math.ceil((n+1)/cs),l=E.length,A>=l)return e;for(w=l=E[A],f=1;l>=10;l/=10)f++;n%=cs,a=n-cs+f}if(r!==void 0&&(l=uv(10,f-a-1),i=w/l%10|0,_=t<0||E[A+1]!==void 0||w%l,_=r<4?(i||_)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||_||r==6&&(n>0?a>0?w/uv(10,f-a):0:E[A-1])%10&1||r==(e.s<0?8:7))),t<1||!E[0])return _?(l=po(e),E.length=1,t=t-l-1,E[0]=uv(10,(cs-t%cs)%cs),e.e=k_(-t/cs)||0):(E.length=1,E[0]=e.e=e.s=0),e;if(n==0?(E.length=A,l=1,A--):(E.length=A+1,l=uv(10,cs-n),E[A]=a>0?(w/uv(10,f-a)%uv(10,a)|0)*l:0),_)for(;;)if(A==0){(E[0]+=l)==el&&(E[0]=1,++e.e);break}else{if(E[A]+=l,E[A]!=el)break;E[A--]=0,l=1}for(n=E.length;E[--n]===0;)E.pop();if(_s&&(e.e>fT||e.e<-fT))throw Error(IL+po(e));return e}function aQ(e,t){var r,n,a,l,f,i,_,w,A,E,O=e.constructor,F=O.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new O(e),_s?Fa(t,F):t;if(_=e.d,E=t.d,n=t.e,w=e.e,_=_.slice(),f=w-n,f){for(A=f<0,A?(r=_,f=-f,i=E.length):(r=E,n=w,i=_.length),a=Math.max(Math.ceil(F/cs),i)+2,f>a&&(f=a,r.length=1),r.reverse(),a=f;a--;)r.push(0);r.reverse()}else{for(a=_.length,i=E.length,A=a<i,A&&(i=a),a=0;a<i;a++)if(_[a]!=E[a]){A=_[a]<E[a];break}f=0}for(A&&(r=_,_=E,E=r,t.s=-t.s),i=_.length,a=E.length-i;a>0;--a)_[i++]=0;for(a=E.length;a>f;){if(_[--a]<E[a]){for(l=a;l&&_[--l]===0;)_[l]=el-1;--_[l],_[a]+=el}_[a]-=E[a]}for(;_[--i]===0;)_.pop();for(;_[0]===0;_.shift())--n;return _[0]?(t.d=_,t.e=n,_s?Fa(t,F):t):new O(0)}function Fv(e,t,r){var n,a=po(e),l=Rf(e.d),f=l.length;return t?(r&&(n=r-f)>0?l=l.charAt(0)+"."+l.slice(1)+Pg(n):f>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+Pg(-a-1)+l,r&&(n=r-f)>0&&(l+=Pg(n))):a>=f?(l+=Pg(a+1-f),r&&(n=r-a-1)>0&&(l=l+"."+Pg(n))):((n=a+1)<f&&(l=l.slice(0,n)+"."+l.slice(n)),r&&(n=r-f)>0&&(a+1===f&&(l+="."),l+=Pg(n))),e.s<0?"-"+l:l}function uq(e,t){if(e.length>t)return e.length=t,!0}function sQ(e){var t,r,n;function a(l){var f=this;if(!(f instanceof a))return new a(l);if(f.constructor=a,l instanceof a){f.s=l.s,f.e=l.e,f.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(kv+l);if(l>0)f.s=1;else if(l<0)l=-l,f.s=-1;else{f.s=0,f.e=0,f.d=[0];return}if(l===~~l&&l<1e7){f.e=0,f.d=[l];return}return cq(f,l.toString())}else if(typeof l!="string")throw Error(kv+l);if(l.charCodeAt(0)===45?(l=l.slice(1),f.s=-1):f.s=1,KCe.test(l))cq(f,l);else throw Error(kv+l)}if(a.prototype=dn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=sQ,a.config=a.set=ZCe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function ZCe(e){if(!e||typeof e!="object")throw Error(Cd+"Object expected");var t,r,n,a=["precision",1,E_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(k_(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(kv+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(kv+r+": "+n);return this}var DL=sQ(HCe);gu=new DL(1);const ja=DL;function YCe(e){return eEe(e)||QCe(e)||JCe(e)||XCe()}function XCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JCe(e,t){if(e){if(typeof e=="string")return XR(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XR(e,t)}}function QCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function eEe(e){if(Array.isArray(e))return XR(e)}function XR(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var tEe=function(t){return t},oQ={},lQ=function(t){return t===oQ},dq=function(t){return function r(){return arguments.length===0||arguments.length===1&&lQ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},rEe=function e(t,r){return t===1?r:dq(function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var f=a.filter(function(i){return i!==oQ}).length;return f>=t?r.apply(void 0,a):e(t-f,dq(function(){for(var i=arguments.length,_=new Array(i),w=0;w<i;w++)_[w]=arguments[w];var A=a.map(function(E){return lQ(E)?_.shift():E});return r.apply(void 0,YCe(A).concat(_))}))})},YP=function(t){return rEe(t.length,t)},JR=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},nEe=YP(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),iEe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return tEe;var a=r.reverse(),l=a[0],f=a.slice(1);return function(){return f.reduce(function(i,_){return _(i)},l.apply(void 0,arguments))}},QR=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},cQ=function(t){var r=null,n=null;return function(){for(var a=arguments.length,l=new Array(a),f=0;f<a;f++)l[f]=arguments[f];return r&&l.every(function(i,_){return i===r[_]})||(r=l,n=t.apply(void 0,l)),n}};function aEe(e){var t;return e===0?t=1:t=Math.floor(new ja(e).abs().log(10).toNumber())+1,t}function sEe(e,t,r){for(var n=new ja(e),a=0,l=[];n.lt(t)&&a<1e5;)l.push(n.toNumber()),n=n.add(r),a++;return l}var oEe=YP(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),lEe=YP(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),cEe=YP(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const XP={rangeStep:sEe,getDigitCount:aEe,interpolateNumber:oEe,uninterpolateNumber:lEe,uninterpolateTruncation:cEe};function eI(e){return hEe(e)||dEe(e)||uQ(e)||uEe()}function uEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dEe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function hEe(e){if(Array.isArray(e))return tI(e)}function sw(e,t){return mEe(e)||pEe(e,t)||uQ(e,t)||fEe()}function fEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uQ(e,t){if(e){if(typeof e=="string")return tI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tI(e,t)}}function tI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function pEe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,l=void 0;try{for(var f=e[Symbol.iterator](),i;!(n=(i=f.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(_){a=!0,l=_}finally{try{!n&&f.return!=null&&f.return()}finally{if(a)throw l}}return r}}function mEe(e){if(Array.isArray(e))return e}function dQ(e){var t=sw(e,2),r=t[0],n=t[1],a=r,l=n;return r>n&&(a=n,l=r),[a,l]}function hQ(e,t,r){if(e.lte(0))return new ja(0);var n=XP.getDigitCount(e.toNumber()),a=new ja(10).pow(n),l=e.div(a),f=n!==1?.05:.1,i=new ja(Math.ceil(l.div(f).toNumber())).add(r).mul(f),_=i.mul(a);return t?_:new ja(Math.ceil(_))}function gEe(e,t,r){var n=1,a=new ja(e);if(!a.isint()&&r){var l=Math.abs(e);l<1?(n=new ja(10).pow(XP.getDigitCount(e)-1),a=new ja(Math.floor(a.div(n).toNumber())).mul(n)):l>1&&(a=new ja(Math.floor(e)))}else e===0?a=new ja(Math.floor((t-1)/2)):r||(a=new ja(Math.floor(e)));var f=Math.floor((t-1)/2),i=iEe(nEe(function(_){return a.add(new ja(_-f).mul(n)).toNumber()}),JR);return i(0,t)}function fQ(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new ja(0),tickMin:new ja(0),tickMax:new ja(0)};var l=hQ(new ja(t).sub(e).div(r-1),n,a),f;e<=0&&t>=0?f=new ja(0):(f=new ja(e).add(t).div(2),f=f.sub(new ja(f).mod(l)));var i=Math.ceil(f.sub(e).div(l).toNumber()),_=Math.ceil(new ja(t).sub(f).div(l).toNumber()),w=i+_+1;return w>r?fQ(e,t,r,n,a+1):(w<r&&(_=t>0?_+(r-w):_,i=t>0?i:i+(r-w)),{step:l,tickMin:f.sub(new ja(i).mul(l)),tickMax:f.add(new ja(_).mul(l))})}function yEe(e){var t=sw(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=Math.max(a,2),i=dQ([r,n]),_=sw(i,2),w=_[0],A=_[1];if(w===-1/0||A===1/0){var E=A===1/0?[w].concat(eI(JR(0,a-1).map(function(){return 1/0}))):[].concat(eI(JR(0,a-1).map(function(){return-1/0})),[A]);return r>n?QR(E):E}if(w===A)return gEe(w,a,l);var O=fQ(w,A,f,l),F=O.step,U=O.tickMin,B=O.tickMax,q=XP.rangeStep(U,B.add(new ja(.1).mul(F)),F);return r>n?QR(q):q}function vEe(e,t){var r=sw(e,2),n=r[0],a=r[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=dQ([n,a]),i=sw(f,2),_=i[0],w=i[1];if(_===-1/0||w===1/0)return[n,a];if(_===w)return[_];var A=Math.max(t,2),E=hQ(new ja(w).sub(_).div(A-1),l,0),O=[].concat(eI(XP.rangeStep(new ja(_),new ja(w).sub(new ja(.99).mul(E)),E)),[w]);return n>a?QR(O):O}var xEe=cQ(yEe),_Ee=cQ(vEe),bEe="Invariant failed";function Bv(e,t){throw new Error(bEe)}var wEe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function pT(){return pT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pT.apply(this,arguments)}function SEe(e,t){return CEe(e)||PEe(e,t)||TEe(e,t)||AEe()}function AEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TEe(e,t){if(e){if(typeof e=="string")return hq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hq(e,t)}}function hq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PEe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function CEe(e){if(Array.isArray(e))return e}function EEe(e,t){if(e==null)return{};var r=kEe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function MEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jEe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gQ(n.key),n)}}function OEe(e,t,r){return t&&jEe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function NEe(e,t,r){return t=mT(t),REe(e,pQ()?Reflect.construct(t,r||[],mT(e).constructor):t.apply(e,r))}function REe(e,t){if(t&&(zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IEe(e)}function IEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pQ=function(){return!!e})()}function mT(e){return mT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mT(e)}function DEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rI(e,t)}function rI(e,t){return rI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rI(e,t)}function mQ(e,t,r){return t=gQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gQ(e){var t=LEe(e,"string");return zx(t)=="symbol"?t:t+""}function LEe(e,t){if(zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var M_=function(e){function t(){return MEe(this,t),NEe(this,t,arguments)}return DEe(t,e),OEe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,l=n.layout,f=n.width,i=n.dataKey,_=n.data,w=n.dataPointFormatter,A=n.xAxis,E=n.yAxis,O=EEe(n,wEe),F=yn(O,!1);this.props.direction==="x"&&A.type!=="number"&&Bv();var U=_.map(function(B){var q=w(B,i),W=q.x,Z=q.y,ne=q.value,ae=q.errorVal;if(!ae)return null;var ee=[],se,ce;if(Array.isArray(ae)){var ge=SEe(ae,2);se=ge[0],ce=ge[1]}else se=ce=ae;if(l==="vertical"){var Te=A.scale,Ae=Z+a,_e=Ae+f,Ee=Ae-f,ke=Te(ne-se),Qe=Te(ne+ce);ee.push({x1:Qe,y1:_e,x2:Qe,y2:Ee}),ee.push({x1:ke,y1:Ae,x2:Qe,y2:Ae}),ee.push({x1:ke,y1:_e,x2:ke,y2:Ee})}else if(l==="horizontal"){var Ze=E.scale,Ge=W+a,Oe=Ge-f,je=Ge+f,Le=Ze(ne-se),ut=Ze(ne+ce);ee.push({x1:Oe,y1:ut,x2:je,y2:ut}),ee.push({x1:Ge,y1:Le,x2:Ge,y2:ut}),ee.push({x1:Oe,y1:Le,x2:je,y2:Le})}return Re.createElement(pi,pT({className:"recharts-errorBar",key:"bar-".concat(ee.map(function(ze){return"".concat(ze.x1,"-").concat(ze.x2,"-").concat(ze.y1,"-").concat(ze.y2)}))},F),ee.map(function(ze){return Re.createElement("line",pT({},ze,{key:"line-".concat(ze.x1,"-").concat(ze.x2,"-").concat(ze.y1,"-").concat(ze.y2)}))}))});return Re.createElement(pi,{className:"recharts-errorBars"},U)}}])}(Re.Component);mQ(M_,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});mQ(M_,"displayName","ErrorBar");function ow(e){"@babel/helpers - typeof";return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(e)}function fq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fq(Object(r),!0).forEach(function(n){zEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zEe(e,t,r){return t=FEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FEe(e){var t=BEe(e,"string");return ow(t)=="symbol"?t:t+""}function BEe(e,t){if(ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yQ=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,l=t.legendContent,f=pu(r,Uf);if(!f)return null;var i=Uf.defaultProps,_=i!==void 0?av(av({},i),f.props):{},w;return f.props&&f.props.payload?w=f.props&&f.props.payload:l==="children"?w=(n||[]).reduce(function(A,E){var O=E.item,F=E.props,U=F.sectors||F.data||[];return A.concat(U.map(function(B){return{type:f.props.iconType||O.props.legendType,value:B.name,color:B.fill,payload:B}}))},[]):w=(n||[]).map(function(A){var E=A.item,O=E.type.defaultProps,F=O!==void 0?av(av({},O),E.props):{},U=F.dataKey,B=F.name,q=F.legendType,W=F.hide;return{inactive:W,dataKey:U,type:_.iconType||q||"square",color:LL(E),value:B||U,payload:F}}),av(av(av({},_),Uf.getWithHeight(f,a)),{},{payload:w,item:f})};function lw(e){"@babel/helpers - typeof";return lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(e)}function pq(e){return qEe(e)||$Ee(e)||UEe(e)||VEe()}function VEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UEe(e,t){if(e){if(typeof e=="string")return nI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nI(e,t)}}function $Ee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qEe(e){if(Array.isArray(e))return nI(e)}function nI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mq(Object(r),!0).forEach(function(n){xx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xx(e,t,r){return t=GEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GEe(e){var t=WEe(e,"string");return lw(t)=="symbol"?t:t+""}function WEe(e,t){if(lw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(lw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ya(e,t,r){return Yn(e)||Yn(t)?r:Ro(t)?wu(e,t,r):$n(t)?t(e):r}function u1(e,t,r,n){var a=qCe(e,function(i){return Ya(i,t)});if(r==="number"){var l=a.filter(function(i){return Dr(i)||parseFloat(i)});return l.length?[ZP(l),Mg(l)]:[1/0,-1/0]}var f=n?a.filter(function(i){return!Yn(i)}):a;return f.map(function(i){return Ro(i)||i instanceof Date?i:""})}var HEe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,f=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var _=l.range,w=0;w<i;w++){var A=w>0?a[w-1].coordinate:a[i-1].coordinate,E=a[w].coordinate,O=w>=i-1?a[0].coordinate:a[w+1].coordinate,F=void 0;if(rl(E-A)!==rl(O-E)){var U=[];if(rl(O-E)===rl(_[1]-_[0])){F=O;var B=E+_[1]-_[0];U[0]=Math.min(B,(B+A)/2),U[1]=Math.max(B,(B+A)/2)}else{F=A;var q=O+_[1]-_[0];U[0]=Math.min(E,(q+E)/2),U[1]=Math.max(E,(q+E)/2)}var W=[Math.min(E,(F+E)/2),Math.max(E,(F+E)/2)];if(t>W[0]&&t<=W[1]||t>=U[0]&&t<=U[1]){f=a[w].index;break}}else{var Z=Math.min(A,O),ne=Math.max(A,O);if(t>(Z+E)/2&&t<=(ne+E)/2){f=a[w].index;break}}}else for(var ae=0;ae<i;ae++)if(ae===0&&t<=(n[ae].coordinate+n[ae+1].coordinate)/2||ae>0&&ae<i-1&&t>(n[ae].coordinate+n[ae-1].coordinate)/2&&t<=(n[ae].coordinate+n[ae+1].coordinate)/2||ae===i-1&&t>(n[ae].coordinate+n[ae-1].coordinate)/2){f=n[ae].index;break}return f},LL=function(t){var r,n=t,a=n.type.displayName,l=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Fs(Fs({},t.type.defaultProps),t.props):t.props,f=l.stroke,i=l.fill,_;switch(a){case"Line":_=f;break;case"Area":case"Radar":_=f&&f!=="none"?f:i;break;default:_=i;break}return _},KEe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,l=a===void 0?{}:a;if(!l)return{};for(var f={},i=Object.keys(l),_=0,w=i.length;_<w;_++)for(var A=l[i[_]].stackGroups,E=Object.keys(A),O=0,F=E.length;O<F;O++){var U=A[E[O]],B=U.items,q=U.cateAxisId,W=B.filter(function(ce){return lm(ce.type).indexOf("Bar")>=0});if(W&&W.length){var Z=W[0].type.defaultProps,ne=Z!==void 0?Fs(Fs({},Z),W[0].props):W[0].props,ae=ne.barSize,ee=ne[q];f[ee]||(f[ee]=[]);var se=Yn(ae)?r:ae;f[ee].push({item:W[0],stackList:W.slice(1),barSize:Yn(se)?void 0:sc(se,n,0)})}}return f},ZEe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,l=t.sizeList,f=l===void 0?[]:l,i=t.maxBarSize,_=f.length;if(_<1)return null;var w=sc(r,a,0,!0),A,E=[];if(f[0].barSize===+f[0].barSize){var O=!1,F=a/_,U=f.reduce(function(ae,ee){return ae+ee.barSize||0},0);U+=(_-1)*w,U>=a&&(U-=(_-1)*w,w=0),U>=a&&F>0&&(O=!0,F*=.9,U=_*F);var B=(a-U)/2>>0,q={offset:B-w,size:0};A=f.reduce(function(ae,ee){var se={item:ee.item,position:{offset:q.offset+q.size+w,size:O?F:ee.barSize}},ce=[].concat(pq(ae),[se]);return q=ce[ce.length-1].position,ee.stackList&&ee.stackList.length&&ee.stackList.forEach(function(ge){ce.push({item:ge,position:q})}),ce},E)}else{var W=sc(n,a,0,!0);a-2*W-(_-1)*w<=0&&(w=0);var Z=(a-2*W-(_-1)*w)/_;Z>1&&(Z>>=0);var ne=i===+i?Math.min(Z,i):Z;A=f.reduce(function(ae,ee,se){var ce=[].concat(pq(ae),[{item:ee.item,position:{offset:W+(Z+w)*se+(Z-ne)/2,size:ne}}]);return ee.stackList&&ee.stackList.length&&ee.stackList.forEach(function(ge){ce.push({item:ge,position:ce[ce.length-1].position})}),ce},E)}return A},YEe=function(t,r,n,a){var l=n.children,f=n.width,i=n.margin,_=f-(i.left||0)-(i.right||0),w=yQ({children:l,legendWidth:_});if(w){var A=a||{},E=A.width,O=A.height,F=w.align,U=w.verticalAlign,B=w.layout;if((B==="vertical"||B==="horizontal"&&U==="middle")&&F!=="center"&&Dr(t[F]))return Fs(Fs({},t),{},xx({},F,t[F]+(E||0)));if((B==="horizontal"||B==="vertical"&&F==="center")&&U!=="middle"&&Dr(t[U]))return Fs(Fs({},t),{},xx({},U,t[U]+(O||0)))}return t},XEe=function(t,r,n){return Yn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},vQ=function(t,r,n,a,l){var f=r.props.children,i=Vl(f,M_).filter(function(w){return XEe(a,l,w.props.direction)});if(i&&i.length){var _=i.map(function(w){return w.props.dataKey});return t.reduce(function(w,A){var E=Ya(A,n);if(Yn(E))return w;var O=Array.isArray(E)?[ZP(E),Mg(E)]:[E,E],F=_.reduce(function(U,B){var q=Ya(A,B,0),W=O[0]-Math.abs(Array.isArray(q)?q[0]:q),Z=O[1]+Math.abs(Array.isArray(q)?q[1]:q);return[Math.min(W,U[0]),Math.max(Z,U[1])]},[1/0,-1/0]);return[Math.min(F[0],w[0]),Math.max(F[1],w[1])]},[1/0,-1/0])}return null},JEe=function(t,r,n,a,l){var f=r.map(function(i){return vQ(t,i,n,l,a)}).filter(function(i){return!Yn(i)});return f&&f.length?f.reduce(function(i,_){return[Math.min(i[0],_[0]),Math.max(i[1],_[1])]},[1/0,-1/0]):null},xQ=function(t,r,n,a,l){var f=r.map(function(_){var w=_.props.dataKey;return n==="number"&&w&&vQ(t,_,w,a)||u1(t,w,n,l)});if(n==="number")return f.reduce(function(_,w){return[Math.min(_[0],w[0]),Math.max(_[1],w[1])]},[1/0,-1/0]);var i={};return f.reduce(function(_,w){for(var A=0,E=w.length;A<E;A++)i[w[A]]||(i[w[A]]=!0,_.push(w[A]));return _},[])},_Q=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},bQ=function(t,r,n,a){if(a)return t.map(function(_){return _.coordinate});var l,f,i=t.map(function(_){return _.coordinate===r&&(l=!0),_.coordinate===n&&(f=!0),_.coordinate});return l||i.push(r),f||i.push(n),i},im=function(t,r,n){if(!t)return null;var a=t.scale,l=t.duplicateDomain,f=t.type,i=t.range,_=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,w=(r||n)&&f==="category"&&a.bandwidth?a.bandwidth()/_:0;if(w=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?rl(i[0]-i[1])*2*w:w,r&&(t.ticks||t.niceTicks)){var A=(t.ticks||t.niceTicks).map(function(E){var O=l?l.indexOf(E):E;return{coordinate:a(O)+w,value:E,offset:w}});return A.filter(function(E){return!T_(E.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(E,O){return{coordinate:a(E)+w,value:E,index:O,offset:w}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(E){return{coordinate:a(E)+w,value:E,offset:w}}):a.domain().map(function(E,O){return{coordinate:a(E)+w,value:l?l[E]:E,index:O,offset:w}})},LO=new WeakMap,FS=function(t,r){if(typeof r!="function")return t;LO.has(t)||LO.set(t,new WeakMap);var n=LO.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},wQ=function(t,r,n){var a=t.scale,l=t.type,f=t.layout,i=t.axisType;if(a==="auto")return f==="radial"&&i==="radiusAxis"?{scale:ew(),realScaleType:"band"}:f==="radial"&&i==="angleAxis"?{scale:cT(),realScaleType:"linear"}:l==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:c1(),realScaleType:"point"}:l==="category"?{scale:ew(),realScaleType:"band"}:{scale:cT(),realScaleType:"linear"};if(e2(a)){var _="scale".concat(RP(a));return{scale:(eq[_]||c1)(),realScaleType:eq[_]?_:"point"}}return $n(a)?{scale:a}:{scale:c1(),realScaleType:"point"}},gq=1e-4,SQ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),l=Math.min(a[0],a[1])-gq,f=Math.max(a[0],a[1])+gq,i=t(r[0]),_=t(r[n-1]);(i<l||i>f||_<l||_>f)&&t.domain([r[0],r[n-1]])}},AQ=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},TQ=function(t,r){if(!r||r.length!==2||!Dr(r[0])||!Dr(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[t[0],t[1]];return(!Dr(t[0])||t[0]<n)&&(l[0]=n),(!Dr(t[1])||t[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},QEe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,f=0,i=0;i<r;++i){var _=T_(t[i][n][1])?t[i][n][0]:t[i][n][1];_>=0?(t[i][n][0]=l,t[i][n][1]=l+_,l=t[i][n][1]):(t[i][n][0]=f,t[i][n][1]=f+_,f=t[i][n][1])}},eke=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,f=0;f<r;++f){var i=T_(t[f][n][1])?t[f][n][0]:t[f][n][1];i>=0?(t[f][n][0]=l,t[f][n][1]=l+i,l=t[f][n][1]):(t[f][n][0]=0,t[f][n][1]=0)}},tke={sign:QEe,expand:qwe,none:Mx,silhouette:Gwe,wiggle:Wwe,positive:eke},rke=function(t,r,n){var a=r.map(function(i){return i.props.dataKey}),l=tke[n],f=$we().keys(a).value(function(i,_){return+Ya(i,_,0)}).order(NR).offset(l);return f(t)},nke=function(t,r,n,a,l,f){if(!t)return null;var i=f?r.reverse():r,_={},w=i.reduce(function(E,O){var F,U=(F=O.type)!==null&&F!==void 0&&F.defaultProps?Fs(Fs({},O.type.defaultProps),O.props):O.props,B=U.stackId,q=U.hide;if(q)return E;var W=U[n],Z=E[W]||{hasStack:!1,stackGroups:{}};if(Ro(B)){var ne=Z.stackGroups[B]||{numericAxisId:n,cateAxisId:a,items:[]};ne.items.push(O),Z.hasStack=!0,Z.stackGroups[B]=ne}else Z.stackGroups[ty("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[O]};return Fs(Fs({},E),{},xx({},W,Z))},_),A={};return Object.keys(w).reduce(function(E,O){var F=w[O];if(F.hasStack){var U={};F.stackGroups=Object.keys(F.stackGroups).reduce(function(B,q){var W=F.stackGroups[q];return Fs(Fs({},B),{},xx({},q,{numericAxisId:n,cateAxisId:a,items:W.items,stackedData:rke(t,W.items,l)}))},U)}return Fs(Fs({},E),{},xx({},O,F))},A)},PQ=function(t,r){var n=r.realScaleType,a=r.type,l=r.tickCount,f=r.originalDomain,i=r.allowDecimals,_=n||r.scale;if(_!=="auto"&&_!=="linear")return null;if(l&&a==="number"&&f&&(f[0]==="auto"||f[1]==="auto")){var w=t.domain();if(!w.length)return null;var A=xEe(w,l,i);return t.domain([ZP(A),Mg(A)]),{niceTicks:A}}if(l&&a==="number"){var E=t.domain(),O=_Ee(E,l,i);return{niceTicks:O}}return null};function Fx(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,l=e.index,f=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Yn(a[t.dataKey])){var i=GA(r,"value",a[t.dataKey]);if(i)return i.coordinate+n/2}return r[l]?r[l].coordinate+n/2:null}var _=Ya(a,Yn(f)?t.dataKey:f);return Yn(_)?null:t.scale(_)}var gT=function(t){var r=t.axis,n=t.ticks,a=t.offset,l=t.bandSize,f=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+a:null;var _=Ya(f,r.dataKey,r.domain[i]);return Yn(_)?null:r.scale(_)-l/2+a},CQ=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},ike=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Fs(Fs({},t.type.defaultProps),t.props):t.props,l=a.stackId;if(Ro(l)){var f=r[l];if(f){var i=f.items.indexOf(t);return i>=0?f.stackedData[i]:null}}return null},ake=function(t){return t.reduce(function(r,n){return[ZP(n.concat([r[0]]).filter(Dr)),Mg(n.concat([r[1]]).filter(Dr))]},[1/0,-1/0])},EQ=function(t,r,n){return Object.keys(t).reduce(function(a,l){var f=t[l],i=f.stackedData,_=i.reduce(function(w,A){var E=ake(A.slice(r,n+1));return[Math.min(w[0],E[0]),Math.max(w[1],E[1])]},[1/0,-1/0]);return[Math.min(_[0],a[0]),Math.max(_[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},yq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,vq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,iI=function(t,r,n){if($n(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Dr(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(yq.test(t[0])){var l=+yq.exec(t[0])[1];a[0]=r[0]-l}else $n(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Dr(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(vq.test(t[1])){var f=+vq.exec(t[1])[1];a[1]=r[1]+f}else $n(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},yT=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var l=dL(r,function(E){return E.coordinate}),f=1/0,i=1,_=l.length;i<_;i++){var w=l[i],A=l[i-1];f=Math.min((w.coordinate||0)-(A.coordinate||0),f)}return f===1/0?0:f}return n?void 0:0},xq=function(t,r,n){return!t||!t.length||xm(t,wu(n,"type.defaultProps.domain"))?r:t},zL=function(t,r){var n=t.type.defaultProps?Fs(Fs({},t.type.defaultProps),t.props):t.props,a=n.dataKey,l=n.name,f=n.unit,i=n.formatter,_=n.tooltipType,w=n.chartType,A=n.hide;return Fs(Fs({},yn(t,!1)),{},{dataKey:a,unit:f,formatter:i,name:l||a,color:LL(t),value:Ya(r,a),type:_,payload:r,chartType:w,hide:A})};function cw(e){"@babel/helpers - typeof";return cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cw(e)}function _q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_q(Object(r),!0).forEach(function(n){kQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kQ(e,t,r){return t=ske(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ske(e){var t=oke(e,"string");return cw(t)=="symbol"?t:t+""}function oke(e,t){if(cw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(cw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lke(e,t){return hke(e)||dke(e,t)||uke(e,t)||cke()}function cke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uke(e,t){if(e){if(typeof e=="string")return bq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bq(e,t)}}function bq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function hke(e){if(Array.isArray(e))return e}var vT=Math.PI/180,fke=function(t){return t*180/Math.PI},Ba=function(t,r,n,a){return{x:t+Math.cos(-vT*a)*n,y:r+Math.sin(-vT*a)*n}},MQ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},jQ=function(t,r,n,a,l){var f=t.width,i=t.height,_=t.startAngle,w=t.endAngle,A=sc(t.cx,f,f/2),E=sc(t.cy,i,i/2),O=MQ(f,i,n),F=sc(t.innerRadius,O,0),U=sc(t.outerRadius,O,O*.8),B=Object.keys(r);return B.reduce(function(q,W){var Z=r[W],ne=Z.domain,ae=Z.reversed,ee;if(Yn(Z.range))a==="angleAxis"?ee=[_,w]:a==="radiusAxis"&&(ee=[F,U]),ae&&(ee=[ee[1],ee[0]]);else{ee=Z.range;var se=ee,ce=lke(se,2);_=ce[0],w=ce[1]}var ge=wQ(Z,l),Te=ge.realScaleType,Ae=ge.scale;Ae.domain(ne).range(ee),SQ(Ae);var _e=PQ(Ae,Qp(Qp({},Z),{},{realScaleType:Te})),Ee=Qp(Qp(Qp({},Z),_e),{},{range:ee,radius:U,realScaleType:Te,scale:Ae,cx:A,cy:E,innerRadius:F,outerRadius:U,startAngle:_,endAngle:w});return Qp(Qp({},q),{},kQ({},W,Ee))},{})},pke=function(t,r){var n=t.x,a=t.y,l=r.x,f=r.y;return Math.sqrt(Math.pow(n-l,2)+Math.pow(a-f,2))},mke=function(t,r){var n=t.x,a=t.y,l=r.cx,f=r.cy,i=pke({x:n,y:a},{x:l,y:f});if(i<=0)return{radius:i};var _=(n-l)/i,w=Math.acos(_);return a>f&&(w=2*Math.PI-w),{radius:i,angle:fke(w),angleInRadian:w}},gke=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),l=Math.floor(n/360),f=Math.min(a,l);return{startAngle:r-f*360,endAngle:n-f*360}},yke=function(t,r){var n=r.startAngle,a=r.endAngle,l=Math.floor(n/360),f=Math.floor(a/360),i=Math.min(l,f);return t+i*360},wq=function(t,r){var n=t.x,a=t.y,l=mke({x:n,y:a},r),f=l.radius,i=l.angle,_=r.innerRadius,w=r.outerRadius;if(f<_||f>w)return!1;if(f===0)return!0;var A=gke(r),E=A.startAngle,O=A.endAngle,F=i,U;if(E<=O){for(;F>O;)F-=360;for(;F<E;)F+=360;U=F>=E&&F<=O}else{for(;F>E;)F-=360;for(;F<O;)F+=360;U=F>=O&&F<=E}return U?Qp(Qp({},r),{},{radius:f,angle:yke(F,r)}):null},OQ=function(t){return!H.isValidElement(t)&&!$n(t)&&typeof t!="boolean"?t.className:""};function uw(e){"@babel/helpers - typeof";return uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uw(e)}var vke=["offset"];function xke(e){return Ske(e)||wke(e)||bke(e)||_ke()}function _ke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bke(e,t){if(e){if(typeof e=="string")return aI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aI(e,t)}}function wke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ske(e){if(Array.isArray(e))return aI(e)}function aI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ake(e,t){if(e==null)return{};var r=Tke(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Tke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Sq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sq(Object(r),!0).forEach(function(n){Pke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pke(e,t,r){return t=Cke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cke(e){var t=Eke(e,"string");return uw(t)=="symbol"?t:t+""}function Eke(e,t){if(uw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(uw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dw(){return dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dw.apply(this,arguments)}var kke=function(t){var r=t.value,n=t.formatter,a=Yn(t.children)?r:t.children;return $n(n)?n(a):a},Mke=function(t,r){var n=rl(r-t),a=Math.min(Math.abs(r-t),360);return n*a},jke=function(t,r,n){var a=t.position,l=t.viewBox,f=t.offset,i=t.className,_=l,w=_.cx,A=_.cy,E=_.innerRadius,O=_.outerRadius,F=_.startAngle,U=_.endAngle,B=_.clockWise,q=(E+O)/2,W=Mke(F,U),Z=W>=0?1:-1,ne,ae;a==="insideStart"?(ne=F+Z*f,ae=B):a==="insideEnd"?(ne=U-Z*f,ae=!B):a==="end"&&(ne=U+Z*f,ae=B),ae=W<=0?ae:!ae;var ee=Ba(w,A,q,ne),se=Ba(w,A,q,ne+(ae?1:-1)*359),ce="M".concat(ee.x,",").concat(ee.y,`
    A`).concat(q,",").concat(q,",0,1,").concat(ae?0:1,`,
    `).concat(se.x,",").concat(se.y),ge=Yn(t.id)?ty("recharts-radial-line-"):t.id;return Re.createElement("text",dw({},n,{dominantBaseline:"central",className:hi("recharts-radial-bar-label",i)}),Re.createElement("defs",null,Re.createElement("path",{id:ge,d:ce})),Re.createElement("textPath",{xlinkHref:"#".concat(ge)},r))},Oke=function(t){var r=t.viewBox,n=t.offset,a=t.position,l=r,f=l.cx,i=l.cy,_=l.innerRadius,w=l.outerRadius,A=l.startAngle,E=l.endAngle,O=(A+E)/2;if(a==="outside"){var F=Ba(f,i,w+n,O),U=F.x,B=F.y;return{x:U,y:B,textAnchor:U>=f?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"end"};var q=(_+w)/2,W=Ba(f,i,q,O),Z=W.x,ne=W.y;return{x:Z,y:ne,textAnchor:"middle",verticalAnchor:"middle"}},Nke=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,l=t.position,f=r,i=f.x,_=f.y,w=f.width,A=f.height,E=A>=0?1:-1,O=E*a,F=E>0?"end":"start",U=E>0?"start":"end",B=w>=0?1:-1,q=B*a,W=B>0?"end":"start",Z=B>0?"start":"end";if(l==="top"){var ne={x:i+w/2,y:_-E*a,textAnchor:"middle",verticalAnchor:F};return Mo(Mo({},ne),n?{height:Math.max(_-n.y,0),width:w}:{})}if(l==="bottom"){var ae={x:i+w/2,y:_+A+O,textAnchor:"middle",verticalAnchor:U};return Mo(Mo({},ae),n?{height:Math.max(n.y+n.height-(_+A),0),width:w}:{})}if(l==="left"){var ee={x:i-q,y:_+A/2,textAnchor:W,verticalAnchor:"middle"};return Mo(Mo({},ee),n?{width:Math.max(ee.x-n.x,0),height:A}:{})}if(l==="right"){var se={x:i+w+q,y:_+A/2,textAnchor:Z,verticalAnchor:"middle"};return Mo(Mo({},se),n?{width:Math.max(n.x+n.width-se.x,0),height:A}:{})}var ce=n?{width:w,height:A}:{};return l==="insideLeft"?Mo({x:i+q,y:_+A/2,textAnchor:Z,verticalAnchor:"middle"},ce):l==="insideRight"?Mo({x:i+w-q,y:_+A/2,textAnchor:W,verticalAnchor:"middle"},ce):l==="insideTop"?Mo({x:i+w/2,y:_+O,textAnchor:"middle",verticalAnchor:U},ce):l==="insideBottom"?Mo({x:i+w/2,y:_+A-O,textAnchor:"middle",verticalAnchor:F},ce):l==="insideTopLeft"?Mo({x:i+q,y:_+O,textAnchor:Z,verticalAnchor:U},ce):l==="insideTopRight"?Mo({x:i+w-q,y:_+O,textAnchor:W,verticalAnchor:U},ce):l==="insideBottomLeft"?Mo({x:i+q,y:_+A-O,textAnchor:Z,verticalAnchor:F},ce):l==="insideBottomRight"?Mo({x:i+w-q,y:_+A-O,textAnchor:W,verticalAnchor:F},ce):A_(l)&&(Dr(l.x)||_v(l.x))&&(Dr(l.y)||_v(l.y))?Mo({x:i+sc(l.x,w),y:_+sc(l.y,A),textAnchor:"end",verticalAnchor:"end"},ce):Mo({x:i+w/2,y:_+A/2,textAnchor:"middle",verticalAnchor:"middle"},ce)},Rke=function(t){return"cx"in t&&Dr(t.cx)};function tl(e){var t=e.offset,r=t===void 0?5:t,n=Ake(e,vke),a=Mo({offset:r},n),l=a.viewBox,f=a.position,i=a.value,_=a.children,w=a.content,A=a.className,E=A===void 0?"":A,O=a.textBreakAll;if(!l||Yn(i)&&Yn(_)&&!H.isValidElement(w)&&!$n(w))return null;if(H.isValidElement(w))return H.cloneElement(w,a);var F;if($n(w)){if(F=H.createElement(w,a),H.isValidElement(F))return F}else F=kke(a);var U=Rke(l),B=yn(a,!0);if(U&&(f==="insideStart"||f==="insideEnd"||f==="end"))return jke(a,F,B);var q=U?Oke(a):Nke(a);return Re.createElement(zv,dw({className:hi("recharts-label",E)},B,q,{breakAll:O}),F)}tl.displayName="Label";var NQ=function(t){var r=t.cx,n=t.cy,a=t.angle,l=t.startAngle,f=t.endAngle,i=t.r,_=t.radius,w=t.innerRadius,A=t.outerRadius,E=t.x,O=t.y,F=t.top,U=t.left,B=t.width,q=t.height,W=t.clockWise,Z=t.labelViewBox;if(Z)return Z;if(Dr(B)&&Dr(q)){if(Dr(E)&&Dr(O))return{x:E,y:O,width:B,height:q};if(Dr(F)&&Dr(U))return{x:F,y:U,width:B,height:q}}return Dr(E)&&Dr(O)?{x:E,y:O,width:0,height:0}:Dr(r)&&Dr(n)?{cx:r,cy:n,startAngle:l||a||0,endAngle:f||a||0,innerRadius:w||0,outerRadius:A||_||i||0,clockWise:W}:t.viewBox?t.viewBox:{}},Ike=function(t,r){return t?t===!0?Re.createElement(tl,{key:"label-implicit",viewBox:r}):Ro(t)?Re.createElement(tl,{key:"label-implicit",viewBox:r,value:t}):H.isValidElement(t)?t.type===tl?H.cloneElement(t,{key:"label-implicit",viewBox:r}):Re.createElement(tl,{key:"label-implicit",content:t,viewBox:r}):$n(t)?Re.createElement(tl,{key:"label-implicit",content:t,viewBox:r}):A_(t)?Re.createElement(tl,dw({viewBox:r},t,{key:"label-implicit"})):null:null},Dke=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,l=NQ(t),f=Vl(a,tl).map(function(_,w){return H.cloneElement(_,{viewBox:r||l,key:"label-".concat(w)})});if(!n)return f;var i=Ike(t.label,r||l);return[i].concat(xke(f))};tl.parseViewBox=NQ;tl.renderCallByParent=Dke;var zO,Aq;function Lke(){if(Aq)return zO;Aq=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return zO=e,zO}var zke=Lke();const Fke=oa(zke);function hw(e){"@babel/helpers - typeof";return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(e)}var Bke=["valueAccessor"],Vke=["data","dataKey","clockWise","id","textBreakAll"];function Uke(e){return Wke(e)||Gke(e)||qke(e)||$ke()}function $ke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qke(e,t){if(e){if(typeof e=="string")return sI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sI(e,t)}}function Gke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Wke(e){if(Array.isArray(e))return sI(e)}function sI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function xT(){return xT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xT.apply(this,arguments)}function Tq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tq(Object(r),!0).forEach(function(n){Hke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hke(e,t,r){return t=Kke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kke(e){var t=Zke(e,"string");return hw(t)=="symbol"?t:t+""}function Zke(e,t){if(hw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cq(e,t){if(e==null)return{};var r=Yke(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Yke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Xke=function(t){return Array.isArray(t.value)?Fke(t.value):t.value};function Td(e){var t=e.valueAccessor,r=t===void 0?Xke:t,n=Cq(e,Bke),a=n.data,l=n.dataKey,f=n.clockWise,i=n.id,_=n.textBreakAll,w=Cq(n,Vke);return!a||!a.length?null:Re.createElement(pi,{className:"recharts-label-list"},a.map(function(A,E){var O=Yn(l)?r(A,E):Ya(A&&A.payload,l),F=Yn(i)?{}:{id:"".concat(i,"-").concat(E)};return Re.createElement(tl,xT({},yn(A,!0),w,F,{parentViewBox:A.parentViewBox,value:O,textBreakAll:_,viewBox:tl.parseViewBox(Yn(f)?A:Pq(Pq({},A),{},{clockWise:f})),key:"label-".concat(E),index:E}))}))}Td.displayName="LabelList";function Jke(e,t){return e?e===!0?Re.createElement(Td,{key:"labelList-implicit",data:t}):Re.isValidElement(e)||$n(e)?Re.createElement(Td,{key:"labelList-implicit",data:t,content:e}):A_(e)?Re.createElement(Td,xT({data:t},e,{key:"labelList-implicit"})):null:null}function Qke(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Vl(n,Td).map(function(f,i){return H.cloneElement(f,{data:t,key:"labelList-".concat(i)})});if(!r)return a;var l=Jke(e.label,t);return[l].concat(Uke(a))}Td.renderCallByParent=Qke;function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}function oI(){return oI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oI.apply(this,arguments)}function Eq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Eq(Object(r),!0).forEach(function(n){eMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eMe(e,t,r){return t=tMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tMe(e){var t=rMe(e,"string");return fw(t)=="symbol"?t:t+""}function rMe(e,t){if(fw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nMe=function(t,r){var n=rl(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},BS=function(t){var r=t.cx,n=t.cy,a=t.radius,l=t.angle,f=t.sign,i=t.isExternal,_=t.cornerRadius,w=t.cornerIsExternal,A=_*(i?1:-1)+a,E=Math.asin(_/A)/vT,O=w?l:l+f*E,F=Ba(r,n,A,O),U=Ba(r,n,a,O),B=w?l-f*E:l,q=Ba(r,n,A*Math.cos(E*vT),B);return{center:F,circleTangency:U,lineTangency:q,theta:E}},RQ=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,f=t.startAngle,i=t.endAngle,_=nMe(f,i),w=f+_,A=Ba(r,n,l,f),E=Ba(r,n,l,w),O="M ".concat(A.x,",").concat(A.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(_)>180),",").concat(+(f>w),`,
    `).concat(E.x,",").concat(E.y,`
  `);if(a>0){var F=Ba(r,n,a,f),U=Ba(r,n,a,w);O+="L ".concat(U.x,",").concat(U.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(_)>180),",").concat(+(f<=w),`,
            `).concat(F.x,",").concat(F.y," Z")}else O+="L ".concat(r,",").concat(n," Z");return O},iMe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,f=t.cornerRadius,i=t.forceCornerRadius,_=t.cornerIsExternal,w=t.startAngle,A=t.endAngle,E=rl(A-w),O=BS({cx:r,cy:n,radius:l,angle:w,sign:E,cornerRadius:f,cornerIsExternal:_}),F=O.circleTangency,U=O.lineTangency,B=O.theta,q=BS({cx:r,cy:n,radius:l,angle:A,sign:-E,cornerRadius:f,cornerIsExternal:_}),W=q.circleTangency,Z=q.lineTangency,ne=q.theta,ae=_?Math.abs(w-A):Math.abs(w-A)-B-ne;if(ae<0)return i?"M ".concat(U.x,",").concat(U.y,`
        a`).concat(f,",").concat(f,",0,0,1,").concat(f*2,`,0
        a`).concat(f,",").concat(f,",0,0,1,").concat(-f*2,`,0
      `):RQ({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:w,endAngle:A});var ee="M ".concat(U.x,",").concat(U.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(F.x,",").concat(F.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(ae>180),",").concat(+(E<0),",").concat(W.x,",").concat(W.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(Z.x,",").concat(Z.y,`
  `);if(a>0){var se=BS({cx:r,cy:n,radius:a,angle:w,sign:E,isExternal:!0,cornerRadius:f,cornerIsExternal:_}),ce=se.circleTangency,ge=se.lineTangency,Te=se.theta,Ae=BS({cx:r,cy:n,radius:a,angle:A,sign:-E,isExternal:!0,cornerRadius:f,cornerIsExternal:_}),_e=Ae.circleTangency,Ee=Ae.lineTangency,ke=Ae.theta,Qe=_?Math.abs(w-A):Math.abs(w-A)-Te-ke;if(Qe<0&&f===0)return"".concat(ee,"L").concat(r,",").concat(n,"Z");ee+="L".concat(Ee.x,",").concat(Ee.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(_e.x,",").concat(_e.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Qe>180),",").concat(+(E>0),",").concat(ce.x,",").concat(ce.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(E<0),",").concat(ge.x,",").concat(ge.y,"Z")}else ee+="L".concat(r,",").concat(n,"Z");return ee},aMe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},IQ=function(t){var r=kq(kq({},aMe),t),n=r.cx,a=r.cy,l=r.innerRadius,f=r.outerRadius,i=r.cornerRadius,_=r.forceCornerRadius,w=r.cornerIsExternal,A=r.startAngle,E=r.endAngle,O=r.className;if(f<l||A===E)return null;var F=hi("recharts-sector",O),U=f-l,B=sc(i,U,0,!0),q;return B>0&&Math.abs(A-E)<360?q=iMe({cx:n,cy:a,innerRadius:l,outerRadius:f,cornerRadius:Math.min(B,U/2),forceCornerRadius:_,cornerIsExternal:w,startAngle:A,endAngle:E}):q=RQ({cx:n,cy:a,innerRadius:l,outerRadius:f,startAngle:A,endAngle:E}),Re.createElement("path",oI({},yn(r,!0),{className:F,d:q,role:"img"}))};function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function lI(){return lI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lI.apply(this,arguments)}function Mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mq(Object(r),!0).forEach(function(n){sMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sMe(e,t,r){return t=oMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oMe(e){var t=lMe(e,"string");return pw(t)=="symbol"?t:t+""}function lMe(e,t){if(pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oq={curveBasisClosed:Owe,curveBasisOpen:Nwe,curveBasis:jwe,curveBumpX:ywe,curveBumpY:vwe,curveLinearClosed:Rwe,curveLinear:DP,curveMonotoneX:Iwe,curveMonotoneY:Dwe,curveNatural:Lwe,curveStep:zwe,curveStepAfter:Bwe,curveStepBefore:Fwe},VS=function(t){return t.x===+t.x&&t.y===+t.y},Fb=function(t){return t.x},Bb=function(t){return t.y},cMe=function(t,r){if($n(t))return t;var n="curve".concat(RP(t));return(n==="curveMonotone"||n==="curveBump")&&r?Oq["".concat(n).concat(r==="vertical"?"Y":"X")]:Oq[n]||DP},uMe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,l=a===void 0?[]:a,f=t.baseLine,i=t.layout,_=t.connectNulls,w=_===void 0?!1:_,A=cMe(n,i),E=w?l.filter(function(B){return VS(B)}):l,O;if(Array.isArray(f)){var F=w?f.filter(function(B){return VS(B)}):f,U=E.map(function(B,q){return jq(jq({},B),{},{base:F[q]})});return i==="vertical"?O=OS().y(Bb).x1(Fb).x0(function(B){return B.base.x}):O=OS().x(Fb).y1(Bb).y0(function(B){return B.base.y}),O.defined(VS).curve(A),O(U)}return i==="vertical"&&Dr(f)?O=OS().y(Bb).x1(Fb).x0(f):Dr(f)?O=OS().x(Fb).y1(Bb).y0(f):O=MX().x(Fb).y(Bb),O.defined(VS).curve(A),O(E)},Dg=function(t){var r=t.className,n=t.points,a=t.path,l=t.pathRef;if((!n||!n.length)&&!a)return null;var f=n&&n.length?uMe(t):a;return Re.createElement("path",lI({},yn(t,!1),WA(t),{className:hi("recharts-curve",r),d:f,ref:l}))},FO={exports:{}},BO,Nq;function dMe(){if(Nq)return BO;Nq=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return BO=e,BO}var VO,Rq;function hMe(){if(Rq)return VO;Rq=1;var e=dMe();function t(){}function r(){}return r.resetWarningCache=t,VO=function(){function n(f,i,_,w,A,E){if(E!==e){var O=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw O.name="Invariant Violation",O}}n.isRequired=n;function a(){return n}var l={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},VO}var Iq;function fMe(){return Iq||(Iq=1,FO.exports=hMe()()),FO.exports}var pMe=fMe();const xa=oa(pMe);var mMe=Object.getOwnPropertyNames,gMe=Object.getOwnPropertySymbols,yMe=Object.prototype.hasOwnProperty;function Dq(e,t){return function(n,a,l){return e(n,a,l)&&t(n,a,l)}}function US(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var l=a.cache,f=l.get(r),i=l.get(n);if(f&&i)return f===n&&i===r;l.set(r,n),l.set(n,r);var _=e(r,n,a);return l.delete(r),l.delete(n),_}}function Lq(e){return mMe(e).concat(gMe(e))}var vMe=Object.hasOwn||function(e,t){return yMe.call(e,t)};function e0(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var xMe="__v",_Me="__o",bMe="_owner",zq=Object.getOwnPropertyDescriptor,Fq=Object.keys;function wMe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function SMe(e,t){return e0(e.getTime(),t.getTime())}function AMe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function TMe(e,t){return e===t}function Bq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),l=e.entries(),f,i,_=0;(f=l.next())&&!f.done;){for(var w=t.entries(),A=!1,E=0;(i=w.next())&&!i.done;){if(a[E]){E++;continue}var O=f.value,F=i.value;if(r.equals(O[0],F[0],_,E,e,t,r)&&r.equals(O[1],F[1],O[0],F[0],e,t,r)){A=a[E]=!0;break}E++}if(!A)return!1;_++}return!0}var PMe=e0;function CMe(e,t,r){var n=Fq(e),a=n.length;if(Fq(t).length!==a)return!1;for(;a-- >0;)if(!DQ(e,t,r,n[a]))return!1;return!0}function Vb(e,t,r){var n=Lq(e),a=n.length;if(Lq(t).length!==a)return!1;for(var l,f,i;a-- >0;)if(l=n[a],!DQ(e,t,r,l)||(f=zq(e,l),i=zq(t,l),(f||i)&&(!f||!i||f.configurable!==i.configurable||f.enumerable!==i.enumerable||f.writable!==i.writable)))return!1;return!0}function EMe(e,t){return e0(e.valueOf(),t.valueOf())}function kMe(e,t){return e.source===t.source&&e.flags===t.flags}function Vq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),l=e.values(),f,i;(f=l.next())&&!f.done;){for(var _=t.values(),w=!1,A=0;(i=_.next())&&!i.done;){if(!a[A]&&r.equals(f.value,i.value,f.value,i.value,e,t,r)){w=a[A]=!0;break}A++}if(!w)return!1}return!0}function MMe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function jMe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function DQ(e,t,r,n){return(n===bMe||n===_Me||n===xMe)&&(e.$$typeof||t.$$typeof)?!0:vMe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var OMe="[object Arguments]",NMe="[object Boolean]",RMe="[object Date]",IMe="[object Error]",DMe="[object Map]",LMe="[object Number]",zMe="[object Object]",FMe="[object RegExp]",BMe="[object Set]",VMe="[object String]",UMe="[object URL]",$Me=Array.isArray,Uq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,$q=Object.assign,qMe=Object.prototype.toString.call.bind(Object.prototype.toString);function GMe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,l=e.areMapsEqual,f=e.areNumbersEqual,i=e.areObjectsEqual,_=e.arePrimitiveWrappersEqual,w=e.areRegExpsEqual,A=e.areSetsEqual,E=e.areTypedArraysEqual,O=e.areUrlsEqual;return function(U,B,q){if(U===B)return!0;if(U==null||B==null)return!1;var W=typeof U;if(W!==typeof B)return!1;if(W!=="object")return W==="number"?f(U,B,q):W==="function"?a(U,B,q):!1;var Z=U.constructor;if(Z!==B.constructor)return!1;if(Z===Object)return i(U,B,q);if($Me(U))return t(U,B,q);if(Uq!=null&&Uq(U))return E(U,B,q);if(Z===Date)return r(U,B,q);if(Z===RegExp)return w(U,B,q);if(Z===Map)return l(U,B,q);if(Z===Set)return A(U,B,q);var ne=qMe(U);return ne===RMe?r(U,B,q):ne===FMe?w(U,B,q):ne===DMe?l(U,B,q):ne===BMe?A(U,B,q):ne===zMe?typeof U.then!="function"&&typeof B.then!="function"&&i(U,B,q):ne===UMe?O(U,B,q):ne===IMe?n(U,B,q):ne===OMe?i(U,B,q):ne===NMe||ne===LMe||ne===VMe?_(U,B,q):!1}}function WMe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Vb:wMe,areDatesEqual:SMe,areErrorsEqual:AMe,areFunctionsEqual:TMe,areMapsEqual:n?Dq(Bq,Vb):Bq,areNumbersEqual:PMe,areObjectsEqual:n?Vb:CMe,arePrimitiveWrappersEqual:EMe,areRegExpsEqual:kMe,areSetsEqual:n?Dq(Vq,Vb):Vq,areTypedArraysEqual:n?Vb:MMe,areUrlsEqual:jMe};if(r&&(a=$q({},a,r(a))),t){var l=US(a.areArraysEqual),f=US(a.areMapsEqual),i=US(a.areObjectsEqual),_=US(a.areSetsEqual);a=$q({},a,{areArraysEqual:l,areMapsEqual:f,areObjectsEqual:i,areSetsEqual:_})}return a}function HMe(e){return function(t,r,n,a,l,f,i){return e(t,r,i)}}function KMe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,l=e.strict;if(n)return function(_,w){var A=n(),E=A.cache,O=E===void 0?t?new WeakMap:void 0:E,F=A.meta;return r(_,w,{cache:O,equals:a,meta:F,strict:l})};if(t)return function(_,w){return r(_,w,{cache:new WeakMap,equals:a,meta:void 0,strict:l})};var f={cache:void 0,equals:a,meta:void 0,strict:l};return function(_,w){return r(_,w,f)}}var ZMe=iy();iy({strict:!0});iy({circular:!0});iy({circular:!0,strict:!0});iy({createInternalComparator:function(){return e0}});iy({strict:!0,createInternalComparator:function(){return e0}});iy({circular:!0,createInternalComparator:function(){return e0}});iy({circular:!0,createInternalComparator:function(){return e0},strict:!0});function iy(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,l=e.strict,f=l===void 0?!1:l,i=WMe(e),_=GMe(i),w=n?n(_):HMe(_);return KMe({circular:r,comparator:_,createState:a,equals:w,strict:f})}function YMe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function qq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(l){r<0&&(r=l),l-r>t?(e(l),r=-1):YMe(a)};requestAnimationFrame(n)}function cI(e){"@babel/helpers - typeof";return cI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cI(e)}function XMe(e){return tje(e)||eje(e)||QMe(e)||JMe()}function JMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QMe(e,t){if(e){if(typeof e=="string")return Gq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Gq(e,t)}}function Gq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tje(e){if(Array.isArray(e))return e}function rje(){var e={},t=function(){return null},r=!1,n=function a(l){if(!r){if(Array.isArray(l)){if(!l.length)return;var f=l,i=XMe(f),_=i[0],w=i.slice(1);if(typeof _=="number"){qq(a.bind(null,w),_);return}a(_),qq(a.bind(null,w));return}cI(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){r=!0},start:function(l){r=!1,n(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}function Wq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(r),!0).forEach(function(n){LQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LQ(e,t,r){return t=nje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nje(e){var t=ije(e,"string");return mw(t)==="symbol"?t:String(t)}function ije(e,t){if(mw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aje=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(l){return a.includes(l)})})},sje=function(t){return t},oje=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},d1=function(t,r){return Object.keys(r).reduce(function(n,a){return Hq(Hq({},n),{},LQ({},a,t(a,r[a])))},{})},Kq=function(t,r,n){return t.map(function(a){return"".concat(oje(a)," ").concat(r,"ms ").concat(n)}).join(",")};function lje(e,t){return dje(e)||uje(e,t)||zQ(e,t)||cje()}function cje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function dje(e){if(Array.isArray(e))return e}function hje(e){return mje(e)||pje(e)||zQ(e)||fje()}function fje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zQ(e,t){if(e){if(typeof e=="string")return uI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uI(e,t)}}function pje(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mje(e){if(Array.isArray(e))return uI(e)}function uI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _T=1e-4,FQ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},BQ=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},Zq=function(t,r){return function(n){var a=FQ(t,r);return BQ(a,n)}},gje=function(t,r){return function(n){var a=FQ(t,r),l=[].concat(hje(a.map(function(f,i){return f*i}).slice(1)),[0]);return BQ(l,n)}},Yq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],l=r[1],f=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,l=0,f=1,i=1;break;case"ease":a=.25,l=.1,f=.25,i=1;break;case"ease-in":a=.42,l=0,f=1,i=1;break;case"ease-out":a=.42,l=0,f=.58,i=1;break;case"ease-in-out":a=0,l=0,f=.58,i=1;break;default:{var _=r[0].split("(");if(_[0]==="cubic-bezier"&&_[1].split(")")[0].split(",").length===4){var w=_[1].split(")")[0].split(",").map(function(q){return parseFloat(q)}),A=lje(w,4);a=A[0],l=A[1],f=A[2],i=A[3]}}}var E=Zq(a,f),O=Zq(l,i),F=gje(a,f),U=function(W){return W>1?1:W<0?0:W},B=function(W){for(var Z=W>1?1:W,ne=Z,ae=0;ae<8;++ae){var ee=E(ne)-Z,se=F(ne);if(Math.abs(ee-Z)<_T||se<_T)return O(ne);ne=U(ne-ee/se)}return O(ne)};return B.isStepper=!1,B},yje=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,l=a===void 0?8:a,f=t.dt,i=f===void 0?17:f,_=function(A,E,O){var F=-(A-E)*n,U=O*l,B=O+(F-U)*i/1e3,q=O*i/1e3+A;return Math.abs(q-E)<_T&&Math.abs(B)<_T?[E,0]:[q,B]};return _.isStepper=!0,_.dt=i,_},vje=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Yq(a);case"spring":return yje();default:if(a.split("(")[0]==="cubic-bezier")return Yq(a)}return typeof a=="function"?a:null};function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function Xq(e){return bje(e)||_je(e)||VQ(e)||xje()}function xje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _je(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bje(e){if(Array.isArray(e))return hI(e)}function Jq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jq(Object(r),!0).forEach(function(n){dI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dI(e,t,r){return t=wje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wje(e){var t=Sje(e,"string");return gw(t)==="symbol"?t:String(t)}function Sje(e,t){if(gw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aje(e,t){return Cje(e)||Pje(e,t)||VQ(e,t)||Tje()}function Tje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VQ(e,t){if(e){if(typeof e=="string")return hI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hI(e,t)}}function hI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function Cje(e){if(Array.isArray(e))return e}var bT=function(t,r,n){return t+(r-t)*n},fI=function(t){var r=t.from,n=t.to;return r!==n},Eje=function e(t,r,n){var a=d1(function(l,f){if(fI(f)){var i=t(f.from,f.to,f.velocity),_=Aje(i,2),w=_[0],A=_[1];return vl(vl({},f),{},{from:w,velocity:A})}return f},r);return n<1?d1(function(l,f){return fI(f)?vl(vl({},f),{},{velocity:bT(f.velocity,a[l].velocity,n),from:bT(f.from,a[l].from,n)}):f},r):e(t,a,n-1)};const kje=function(e,t,r,n,a){var l=aje(e,t),f=l.reduce(function(q,W){return vl(vl({},q),{},dI({},W,[e[W],t[W]]))},{}),i=l.reduce(function(q,W){return vl(vl({},q),{},dI({},W,{from:e[W],velocity:0,to:t[W]}))},{}),_=-1,w,A,E=function(){return null},O=function(){return d1(function(W,Z){return Z.from},i)},F=function(){return!Object.values(i).filter(fI).length},U=function(W){w||(w=W);var Z=W-w,ne=Z/r.dt;i=Eje(r,i,ne),a(vl(vl(vl({},e),t),O())),w=W,F()||(_=requestAnimationFrame(E))},B=function(W){A||(A=W);var Z=(W-A)/n,ne=d1(function(ee,se){return bT.apply(void 0,Xq(se).concat([r(Z)]))},f);if(a(vl(vl(vl({},e),t),ne)),Z<1)_=requestAnimationFrame(E);else{var ae=d1(function(ee,se){return bT.apply(void 0,Xq(se).concat([r(1)]))},f);a(vl(vl(vl({},e),t),ae))}};return E=r.isStepper?U:B,function(){return requestAnimationFrame(E),function(){cancelAnimationFrame(_)}}};function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}var Mje=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function jje(e,t){if(e==null)return{};var r=Oje(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Oje(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function UO(e){return Dje(e)||Ije(e)||Rje(e)||Nje()}function Nje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rje(e,t){if(e){if(typeof e=="string")return pI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pI(e,t)}}function Ije(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Dje(e){if(Array.isArray(e))return pI(e)}function pI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _h(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(r),!0).forEach(function(n){e1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e1(e,t,r){return t=UQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zje(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UQ(n.key),n)}}function Fje(e,t,r){return t&&zje(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function UQ(e){var t=Bje(e,"string");return Bx(t)==="symbol"?t:String(t)}function Bje(e,t){if(Bx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mI(e,t)}function mI(e,t){return mI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},mI(e,t)}function Uje(e){var t=$je();return function(){var n=wT(e),a;if(t){var l=wT(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return gI(this,a)}}function gI(e,t){if(t&&(Bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yI(e)}function yI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $je(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wT(e){return wT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wT(e)}var Pu=function(e){Vje(r,e);var t=Uje(r);function r(n,a){var l;Lje(this,r),l=t.call(this,n,a);var f=l.props,i=f.isActive,_=f.attributeName,w=f.from,A=f.to,E=f.steps,O=f.children,F=f.duration;if(l.handleStyleChange=l.handleStyleChange.bind(yI(l)),l.changeStyle=l.changeStyle.bind(yI(l)),!i||F<=0)return l.state={style:{}},typeof O=="function"&&(l.state={style:A}),gI(l);if(E&&E.length)l.state={style:E[0].style};else if(w){if(typeof O=="function")return l.state={style:w},gI(l);l.state={style:_?e1({},_,w):w}}else l.state={style:{}};return l}return Fje(r,[{key:"componentDidMount",value:function(){var a=this.props,l=a.isActive,f=a.canBegin;this.mounted=!0,!(!l||!f)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var l=this.props,f=l.isActive,i=l.canBegin,_=l.attributeName,w=l.shouldReAnimate,A=l.to,E=l.from,O=this.state.style;if(i){if(!f){var F={style:_?e1({},_,A):A};this.state&&O&&(_&&O[_]!==A||!_&&O!==A)&&this.setState(F);return}if(!(ZMe(a.to,A)&&a.canBegin&&a.isActive)){var U=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var B=U||w?E:a.to;if(this.state&&O){var q={style:_?e1({},_,B):B};(_&&O[_]!==B||!_&&O!==B)&&this.setState(q)}this.runAnimation(_h(_h({},this.props),{},{from:B,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var l=this,f=a.from,i=a.to,_=a.duration,w=a.easing,A=a.begin,E=a.onAnimationEnd,O=a.onAnimationStart,F=kje(f,i,vje(w),_,this.changeStyle),U=function(){l.stopJSAnimation=F()};this.manager.start([O,A,U,_,E])}},{key:"runStepAnimation",value:function(a){var l=this,f=a.steps,i=a.begin,_=a.onAnimationStart,w=f[0],A=w.style,E=w.duration,O=E===void 0?0:E,F=function(B,q,W){if(W===0)return B;var Z=q.duration,ne=q.easing,ae=ne===void 0?"ease":ne,ee=q.style,se=q.properties,ce=q.onAnimationEnd,ge=W>0?f[W-1]:q,Te=se||Object.keys(ee);if(typeof ae=="function"||ae==="spring")return[].concat(UO(B),[l.runJSAnimation.bind(l,{from:ge.style,to:ee,duration:Z,easing:ae}),Z]);var Ae=Kq(Te,Z,ae),_e=_h(_h(_h({},ge.style),ee),{},{transition:Ae});return[].concat(UO(B),[_e,Z,ce]).filter(sje)};return this.manager.start([_].concat(UO(f.reduce(F,[A,Math.max(O,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=rje());var l=a.begin,f=a.duration,i=a.attributeName,_=a.to,w=a.easing,A=a.onAnimationStart,E=a.onAnimationEnd,O=a.steps,F=a.children,U=this.manager;if(this.unSubscribe=U.subscribe(this.handleStyleChange),typeof w=="function"||typeof F=="function"||w==="spring"){this.runJSAnimation(a);return}if(O.length>1){this.runStepAnimation(a);return}var B=i?e1({},i,_):_,q=Kq(Object.keys(B),f,w);U.start([A,l,_h(_h({},B),{},{transition:q}),f,E])}},{key:"render",value:function(){var a=this.props,l=a.children;a.begin;var f=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var _=jje(a,Mje),w=H.Children.count(l),A=this.state.style;if(typeof l=="function")return l(A);if(!i||w===0||f<=0)return l;var E=function(F){var U=F.props,B=U.style,q=B===void 0?{}:B,W=U.className,Z=H.cloneElement(F,_h(_h({},_),{},{style:_h(_h({},q),A),className:W}));return Z};return w===1?E(H.Children.only(l)):Re.createElement("div",null,H.Children.map(l,function(O){return E(O)}))}}]),r}(H.PureComponent);Pu.displayName="Animate";Pu.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Pu.propTypes={from:xa.oneOfType([xa.object,xa.string]),to:xa.oneOfType([xa.object,xa.string]),attributeName:xa.string,duration:xa.number,begin:xa.number,easing:xa.oneOfType([xa.string,xa.func]),steps:xa.arrayOf(xa.shape({duration:xa.number.isRequired,style:xa.object.isRequired,easing:xa.oneOfType([xa.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),xa.func]),properties:xa.arrayOf("string"),onAnimationEnd:xa.func})),children:xa.oneOfType([xa.node,xa.func]),isActive:xa.bool,canBegin:xa.bool,onAnimationEnd:xa.func,shouldReAnimate:xa.bool,onAnimationStart:xa.func,onAnimationReStart:xa.func};function yw(e){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function ST(){return ST=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ST.apply(this,arguments)}function qje(e,t){return Kje(e)||Hje(e,t)||Wje(e,t)||Gje()}function Gje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wje(e,t){if(e){if(typeof e=="string")return e9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e9(e,t)}}function e9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Hje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function Kje(e){if(Array.isArray(e))return e}function t9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t9(Object(r),!0).forEach(function(n){Zje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zje(e,t,r){return t=Yje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yje(e){var t=Xje(e,"string");return yw(t)=="symbol"?t:t+""}function Xje(e,t){if(yw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n9=function(t,r,n,a,l){var f=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,_=n>=0?1:-1,w=a>=0&&n>=0||a<0&&n<0?1:0,A;if(f>0&&l instanceof Array){for(var E=[0,0,0,0],O=0,F=4;O<F;O++)E[O]=l[O]>f?f:l[O];A="M".concat(t,",").concat(r+i*E[0]),E[0]>0&&(A+="A ".concat(E[0],",").concat(E[0],",0,0,").concat(w,",").concat(t+_*E[0],",").concat(r)),A+="L ".concat(t+n-_*E[1],",").concat(r),E[1]>0&&(A+="A ".concat(E[1],",").concat(E[1],",0,0,").concat(w,`,
        `).concat(t+n,",").concat(r+i*E[1])),A+="L ".concat(t+n,",").concat(r+a-i*E[2]),E[2]>0&&(A+="A ".concat(E[2],",").concat(E[2],",0,0,").concat(w,`,
        `).concat(t+n-_*E[2],",").concat(r+a)),A+="L ".concat(t+_*E[3],",").concat(r+a),E[3]>0&&(A+="A ".concat(E[3],",").concat(E[3],",0,0,").concat(w,`,
        `).concat(t,",").concat(r+a-i*E[3])),A+="Z"}else if(f>0&&l===+l&&l>0){var U=Math.min(f,l);A="M ".concat(t,",").concat(r+i*U,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t+_*U,",").concat(r,`
            L `).concat(t+n-_*U,",").concat(r,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t+n,",").concat(r+i*U,`
            L `).concat(t+n,",").concat(r+a-i*U,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t+n-_*U,",").concat(r+a,`
            L `).concat(t+_*U,",").concat(r+a,`
            A `).concat(U,",").concat(U,",0,0,").concat(w,",").concat(t,",").concat(r+a-i*U," Z")}else A="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return A},Jje=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,l=r.x,f=r.y,i=r.width,_=r.height;if(Math.abs(i)>0&&Math.abs(_)>0){var w=Math.min(l,l+i),A=Math.max(l,l+i),E=Math.min(f,f+_),O=Math.max(f,f+_);return n>=w&&n<=A&&a>=E&&a<=O}return!1},Qje={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FL=function(t){var r=r9(r9({},Qje),t),n=H.useRef(),a=H.useState(-1),l=qje(a,2),f=l[0],i=l[1];H.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var ae=n.current.getTotalLength();ae&&i(ae)}catch{}},[]);var _=r.x,w=r.y,A=r.width,E=r.height,O=r.radius,F=r.className,U=r.animationEasing,B=r.animationDuration,q=r.animationBegin,W=r.isAnimationActive,Z=r.isUpdateAnimationActive;if(_!==+_||w!==+w||A!==+A||E!==+E||A===0||E===0)return null;var ne=hi("recharts-rectangle",F);return Z?Re.createElement(Pu,{canBegin:f>0,from:{width:A,height:E,x:_,y:w},to:{width:A,height:E,x:_,y:w},duration:B,animationEasing:U,isActive:Z},function(ae){var ee=ae.width,se=ae.height,ce=ae.x,ge=ae.y;return Re.createElement(Pu,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:q,duration:B,isActive:W,easing:U},Re.createElement("path",ST({},yn(r,!0),{className:ne,d:n9(ce,ge,ee,se,O),ref:n})))}):Re.createElement("path",ST({},yn(r,!0),{className:ne,d:n9(_,w,A,E,O)}))},eOe=["points","className","baseLinePoints","connectNulls"];function cx(){return cx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cx.apply(this,arguments)}function tOe(e,t){if(e==null)return{};var r=rOe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function i9(e){return sOe(e)||aOe(e)||iOe(e)||nOe()}function nOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iOe(e,t){if(e){if(typeof e=="string")return vI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vI(e,t)}}function aOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sOe(e){if(Array.isArray(e))return vI(e)}function vI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a9=function(t){return t&&t.x===+t.x&&t.y===+t.y},oOe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){a9(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),a9(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},h1=function(t,r){var n=oOe(t);r&&(n=[n.reduce(function(l,f){return[].concat(i9(l),i9(f))},[])]);var a=n.map(function(l){return l.reduce(function(f,i,_){return"".concat(f).concat(_===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},lOe=function(t,r,n){var a=h1(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(h1(r.reverse(),n).slice(1))},cOe=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,l=t.connectNulls,f=tOe(t,eOe);if(!r||!r.length)return null;var i=hi("recharts-polygon",n);if(a&&a.length){var _=f.stroke&&f.stroke!=="none",w=lOe(r,a,l);return Re.createElement("g",{className:i},Re.createElement("path",cx({},yn(f,!0),{fill:w.slice(-1)==="Z"?f.fill:"none",stroke:"none",d:w})),_?Re.createElement("path",cx({},yn(f,!0),{fill:"none",d:h1(r,l)})):null,_?Re.createElement("path",cx({},yn(f,!0),{fill:"none",d:h1(a,l)})):null)}var A=h1(r,l);return Re.createElement("path",cx({},yn(f,!0),{fill:A.slice(-1)==="Z"?f.fill:"none",className:i,d:A}))};function xI(){return xI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xI.apply(this,arguments)}var s2=function(t){var r=t.cx,n=t.cy,a=t.r,l=t.className,f=hi("recharts-dot",l);return r===+r&&n===+n&&a===+a?Re.createElement("circle",xI({},yn(t,!1),WA(t),{className:f,cx:r,cy:n,r:a})):null};function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}var uOe=["x","y","top","left","width","height","className"];function _I(){return _I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_I.apply(this,arguments)}function s9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s9(Object(r),!0).forEach(function(n){hOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hOe(e,t,r){return t=fOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fOe(e){var t=pOe(e,"string");return vw(t)=="symbol"?t:t+""}function pOe(e,t){if(vw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mOe(e,t){if(e==null)return{};var r=gOe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function gOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var yOe=function(t,r,n,a,l,f){return"M".concat(t,",").concat(l,"v").concat(a,"M").concat(f,",").concat(r,"h").concat(n)},vOe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,f=t.top,i=f===void 0?0:f,_=t.left,w=_===void 0?0:_,A=t.width,E=A===void 0?0:A,O=t.height,F=O===void 0?0:O,U=t.className,B=mOe(t,uOe),q=dOe({x:n,y:l,top:i,left:w,width:E,height:F},B);return!Dr(n)||!Dr(l)||!Dr(E)||!Dr(F)||!Dr(i)||!Dr(w)?null:Re.createElement("path",_I({},yn(q,!0),{className:hi("recharts-cross",U),d:yOe(n,l,E,F,i,w)}))},$O,o9;function xOe(){if(o9)return $O;o9=1;var e=KP(),t=eQ(),r=ap();function n(a,l){return a&&a.length?e(a,r(l,2),t):void 0}return $O=n,$O}var _Oe=xOe();const bOe=oa(_Oe);var qO,l9;function wOe(){if(l9)return qO;l9=1;var e=KP(),t=ap(),r=tQ();function n(a,l){return a&&a.length?e(a,t(l,2),r):void 0}return qO=n,qO}var SOe=wOe();const AOe=oa(SOe);var TOe=["cx","cy","angle","ticks","axisLine"],POe=["ticks","tick","angle","tickFormatter","stroke"];function Vx(e){"@babel/helpers - typeof";return Vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vx(e)}function f1(){return f1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f1.apply(this,arguments)}function c9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c9(Object(r),!0).forEach(function(n){JP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u9(e,t){if(e==null)return{};var r=COe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function COe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function EOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qQ(n.key),n)}}function kOe(e,t,r){return t&&d9(e.prototype,t),r&&d9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MOe(e,t,r){return t=AT(t),jOe(e,$Q()?Reflect.construct(t,r||[],AT(e).constructor):t.apply(e,r))}function jOe(e,t){if(t&&(Vx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OOe(e)}function OOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $Q(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($Q=function(){return!!e})()}function AT(e){return AT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},AT(e)}function NOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bI(e,t)}function bI(e,t){return bI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},bI(e,t)}function JP(e,t,r){return t=qQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qQ(e){var t=ROe(e,"string");return Vx(t)=="symbol"?t:t+""}function ROe(e,t){if(Vx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var o2=function(e){function t(){return EOe(this,t),MOe(this,t,arguments)}return NOe(t,e),kOe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,l=this.props,f=l.angle,i=l.cx,_=l.cy;return Ba(i,_,a,f)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,l=n.cy,f=n.angle,i=n.ticks,_=bOe(i,function(A){return A.coordinate||0}),w=AOe(i,function(A){return A.coordinate||0});return{cx:a,cy:l,startAngle:f,endAngle:f,innerRadius:w.coordinate||0,outerRadius:_.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,l=n.cy,f=n.angle,i=n.ticks,_=n.axisLine,w=u9(n,TOe),A=i.reduce(function(U,B){return[Math.min(U[0],B.coordinate),Math.max(U[1],B.coordinate)]},[1/0,-1/0]),E=Ba(a,l,A[0],f),O=Ba(a,l,A[1],f),F=sv(sv(sv({},yn(w,!1)),{},{fill:"none"},yn(_,!1)),{},{x1:E.x,y1:E.y,x2:O.x,y2:O.y});return Re.createElement("line",f1({className:"recharts-polar-radius-axis-line"},F))}},{key:"renderTicks",value:function(){var n=this,a=this.props,l=a.ticks,f=a.tick,i=a.angle,_=a.tickFormatter,w=a.stroke,A=u9(a,POe),E=this.getTickTextAnchor(),O=yn(A,!1),F=yn(f,!1),U=l.map(function(B,q){var W=n.getTickValueCoord(B),Z=sv(sv(sv(sv({textAnchor:E,transform:"rotate(".concat(90-i,", ").concat(W.x,", ").concat(W.y,")")},O),{},{stroke:"none",fill:w},F),{},{index:q},W),{},{payload:B});return Re.createElement(pi,f1({className:hi("recharts-polar-radius-axis-tick",OQ(f)),key:"tick-".concat(B.coordinate)},Yf(n.props,B,q)),t.renderTickItem(f,Z,_?_(B.value,q):B.value))});return Re.createElement(pi,{className:"recharts-polar-radius-axis-ticks"},U)}},{key:"render",value:function(){var n=this.props,a=n.ticks,l=n.axisLine,f=n.tick;return!a||!a.length?null:Re.createElement(pi,{className:hi("recharts-polar-radius-axis",this.props.className)},l&&this.renderAxisLine(),f&&this.renderTicks(),tl.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,l){var f;return Re.isValidElement(n)?f=Re.cloneElement(n,a):$n(n)?f=n(a):f=Re.createElement(zv,f1({},a,{className:"recharts-polar-radius-axis-tick-value"}),l),f}}])}(H.PureComponent);JP(o2,"displayName","PolarRadiusAxis");JP(o2,"axisType","radiusAxis");JP(o2,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Ux(e){"@babel/helpers - typeof";return Ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ux(e)}function pv(){return pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pv.apply(this,arguments)}function h9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ov(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h9(Object(r),!0).forEach(function(n){QP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WQ(n.key),n)}}function DOe(e,t,r){return t&&f9(e.prototype,t),r&&f9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LOe(e,t,r){return t=TT(t),zOe(e,GQ()?Reflect.construct(t,r||[],TT(e).constructor):t.apply(e,r))}function zOe(e,t){if(t&&(Ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FOe(e)}function FOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GQ=function(){return!!e})()}function TT(e){return TT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},TT(e)}function BOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wI(e,t)}function wI(e,t){return wI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},wI(e,t)}function QP(e,t,r){return t=WQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WQ(e){var t=VOe(e,"string");return Ux(t)=="symbol"?t:t+""}function VOe(e,t){if(Ux(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ux(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var UOe=Math.PI/180,$Oe=1e-5,l2=function(e){function t(){return IOe(this,t),LOe(this,t,arguments)}return BOe(t,e),DOe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,l=a.cx,f=a.cy,i=a.radius,_=a.orientation,w=a.tickSize,A=w||8,E=Ba(l,f,i,n.coordinate),O=Ba(l,f,i+(_==="inner"?-1:1)*A,n.coordinate);return{x1:E.x,y1:E.y,x2:O.x,y2:O.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,l=Math.cos(-n.coordinate*UOe),f;return l>$Oe?f=a==="outer"?"start":"end":l<-1e-5?f=a==="outer"?"end":"start":f="middle",f}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,l=n.cy,f=n.radius,i=n.axisLine,_=n.axisLineType,w=ov(ov({},yn(this.props,!1)),{},{fill:"none"},yn(i,!1));if(_==="circle")return Re.createElement(s2,pv({className:"recharts-polar-angle-axis-line"},w,{cx:a,cy:l,r:f}));var A=this.props.ticks,E=A.map(function(O){return Ba(a,l,f,O.coordinate)});return Re.createElement(cOe,pv({className:"recharts-polar-angle-axis-line"},w,{points:E}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,l=a.ticks,f=a.tick,i=a.tickLine,_=a.tickFormatter,w=a.stroke,A=yn(this.props,!1),E=yn(f,!1),O=ov(ov({},A),{},{fill:"none"},yn(i,!1)),F=l.map(function(U,B){var q=n.getTickLineCoord(U),W=n.getTickTextAnchor(U),Z=ov(ov(ov({textAnchor:W},A),{},{stroke:"none",fill:w},E),{},{index:B,payload:U,x:q.x2,y:q.y2});return Re.createElement(pi,pv({className:hi("recharts-polar-angle-axis-tick",OQ(f)),key:"tick-".concat(U.coordinate)},Yf(n.props,U,B)),i&&Re.createElement("line",pv({className:"recharts-polar-angle-axis-tick-line"},O,q)),f&&t.renderTickItem(f,Z,_?_(U.value,B):U.value))});return Re.createElement(pi,{className:"recharts-polar-angle-axis-ticks"},F)}},{key:"render",value:function(){var n=this.props,a=n.ticks,l=n.radius,f=n.axisLine;return l<=0||!a||!a.length?null:Re.createElement(pi,{className:hi("recharts-polar-angle-axis",this.props.className)},f&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,l){var f;return Re.isValidElement(n)?f=Re.cloneElement(n,a):$n(n)?f=n(a):f=Re.createElement(zv,pv({},a,{className:"recharts-polar-angle-axis-tick-value"}),l),f}}])}(H.PureComponent);QP(l2,"displayName","PolarAngleAxis");QP(l2,"axisType","angleAxis");QP(l2,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var GO,p9;function qOe(){if(p9)return GO;p9=1;var e=QX(),t=e(Object.getPrototypeOf,Object);return GO=t,GO}var WO,m9;function GOe(){if(m9)return WO;m9=1;var e=bm(),t=qOe(),r=wm(),n="[object Object]",a=Function.prototype,l=Object.prototype,f=a.toString,i=l.hasOwnProperty,_=f.call(Object);function w(A){if(!r(A)||e(A)!=n)return!1;var E=t(A);if(E===null)return!0;var O=i.call(E,"constructor")&&E.constructor;return typeof O=="function"&&O instanceof O&&f.call(O)==_}return WO=w,WO}var WOe=GOe();const HOe=oa(WOe);var HO,g9;function KOe(){if(g9)return HO;g9=1;var e=bm(),t=wm(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return HO=n,HO}var ZOe=KOe();const YOe=oa(ZOe);function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function PT(){return PT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PT.apply(this,arguments)}function XOe(e,t){return tNe(e)||eNe(e,t)||QOe(e,t)||JOe()}function JOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QOe(e,t){if(e){if(typeof e=="string")return y9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y9(e,t)}}function y9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eNe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function tNe(e){if(Array.isArray(e))return e}function v9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v9(Object(r),!0).forEach(function(n){rNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rNe(e,t,r){return t=nNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nNe(e){var t=iNe(e,"string");return xw(t)=="symbol"?t:t+""}function iNe(e,t){if(xw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _9=function(t,r,n,a,l){var f=n-a,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-f/2,",").concat(r+l),i+="L ".concat(t+n-f/2-a,",").concat(r+l),i+="L ".concat(t,",").concat(r," Z"),i},aNe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},sNe=function(t){var r=x9(x9({},aNe),t),n=H.useRef(),a=H.useState(-1),l=XOe(a,2),f=l[0],i=l[1];H.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var ne=n.current.getTotalLength();ne&&i(ne)}catch{}},[]);var _=r.x,w=r.y,A=r.upperWidth,E=r.lowerWidth,O=r.height,F=r.className,U=r.animationEasing,B=r.animationDuration,q=r.animationBegin,W=r.isUpdateAnimationActive;if(_!==+_||w!==+w||A!==+A||E!==+E||O!==+O||A===0&&E===0||O===0)return null;var Z=hi("recharts-trapezoid",F);return W?Re.createElement(Pu,{canBegin:f>0,from:{upperWidth:0,lowerWidth:0,height:O,x:_,y:w},to:{upperWidth:A,lowerWidth:E,height:O,x:_,y:w},duration:B,animationEasing:U,isActive:W},function(ne){var ae=ne.upperWidth,ee=ne.lowerWidth,se=ne.height,ce=ne.x,ge=ne.y;return Re.createElement(Pu,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:q,duration:B,easing:U},Re.createElement("path",PT({},yn(r,!0),{className:Z,d:_9(ce,ge,ae,ee,se),ref:n})))}):Re.createElement("g",null,Re.createElement("path",PT({},yn(r,!0),{className:Z,d:_9(_,w,A,E,O)})))},oNe=["option","shapeType","propTransformer","activeClassName","isActive"];function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function lNe(e,t){if(e==null)return{};var r=cNe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function b9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function CT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b9(Object(r),!0).forEach(function(n){uNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uNe(e,t,r){return t=dNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dNe(e){var t=hNe(e,"string");return _w(t)=="symbol"?t:t+""}function hNe(e,t){if(_w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_w(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fNe(e,t){return CT(CT({},t),e)}function pNe(e,t){return e==="symbols"}function w9(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Re.createElement(FL,r);case"trapezoid":return Re.createElement(sNe,r);case"sector":return Re.createElement(IQ,r);case"symbols":if(pNe(t))return Re.createElement(zP,r);break;default:return null}}function mNe(e){return H.isValidElement(e)?e.props:e}function bw(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?fNe:n,l=e.activeClassName,f=l===void 0?"recharts-active-shape":l,i=e.isActive,_=lNe(e,oNe),w;if(H.isValidElement(t))w=H.cloneElement(t,CT(CT({},_),mNe(t)));else if($n(t))w=t(_);else if(HOe(t)&&!YOe(t)){var A=a(t,_);w=Re.createElement(w9,{shapeType:r,elementProps:A})}else{var E=_;w=Re.createElement(w9,{shapeType:r,elementProps:E})}return i?Re.createElement(pi,{className:f},w):w}function eC(e,t){return t!=null&&"trapezoids"in e.props}function tC(e,t){return t!=null&&"sectors"in e.props}function ww(e,t){return t!=null&&"points"in e.props}function gNe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,l=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&l}function yNe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function vNe(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function xNe(e,t){var r;return eC(e,t)?r=gNe:tC(e,t)?r=yNe:ww(e,t)&&(r=vNe),r}function _Ne(e,t){var r;return eC(e,t)?r="trapezoids":tC(e,t)?r="sectors":ww(e,t)&&(r="points"),r}function bNe(e,t){if(eC(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(tC(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return ww(e,t)?t.payload:{}}function wNe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=_Ne(r,t),l=bNe(r,t),f=n.filter(function(_,w){var A=xm(l,_),E=r.props[a].filter(function(U){var B=xNe(r,t);return B(U,t)}),O=r.props[a].indexOf(E[E.length-1]),F=w===O;return A&&F}),i=n.indexOf(f[f.length-1]);return i}var uA;function $x(e){"@babel/helpers - typeof";return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}function ux(){return ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ux.apply(this,arguments)}function S9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S9(Object(r),!0).forEach(function(n){xd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KQ(n.key),n)}}function ANe(e,t,r){return t&&A9(e.prototype,t),r&&A9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TNe(e,t,r){return t=ET(t),PNe(e,HQ()?Reflect.construct(t,r||[],ET(e).constructor):t.apply(e,r))}function PNe(e,t){if(t&&($x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CNe(e)}function CNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HQ=function(){return!!e})()}function ET(e){return ET=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ET(e)}function ENe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SI(e,t)}function SI(e,t){return SI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},SI(e,t)}function xd(e,t,r){return t=KQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KQ(e){var t=kNe(e,"string");return $x(t)=="symbol"?t:t+""}function kNe(e,t){if($x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var op=function(e){function t(r){var n;return SNe(this,t),n=TNe(this,t,[r]),xd(n,"pieRef",null),xd(n,"sectorRefs",[]),xd(n,"id",ty("recharts-pie-")),xd(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),$n(a)&&a()}),xd(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),$n(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return ENe(t,e),ANe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var l=this.props,f=l.label,i=l.labelLine,_=l.dataKey,w=l.valueKey,A=yn(this.props,!1),E=yn(f,!1),O=yn(i,!1),F=f&&f.offsetRadius||20,U=n.map(function(B,q){var W=(B.startAngle+B.endAngle)/2,Z=Ba(B.cx,B.cy,B.outerRadius+F,W),ne=Ha(Ha(Ha(Ha({},A),B),{},{stroke:"none"},E),{},{index:q,textAnchor:t.getTextAnchor(Z.x,B.cx)},Z),ae=Ha(Ha(Ha(Ha({},A),B),{},{fill:"none",stroke:B.fill},O),{},{index:q,points:[Ba(B.cx,B.cy,B.outerRadius,W),Z]}),ee=_;return Yn(_)&&Yn(w)?ee="value":Yn(_)&&(ee=w),Re.createElement(pi,{key:"label-".concat(B.startAngle,"-").concat(B.endAngle,"-").concat(B.midAngle,"-").concat(q)},i&&t.renderLabelLineItem(i,ae,"line"),t.renderLabelItem(f,ne,Ya(B,ee)))});return Re.createElement(pi,{className:"recharts-pie-labels"},U)}},{key:"renderSectorsStatically",value:function(n){var a=this,l=this.props,f=l.activeShape,i=l.blendStroke,_=l.inactiveShape;return n.map(function(w,A){if((w==null?void 0:w.startAngle)===0&&(w==null?void 0:w.endAngle)===0&&n.length!==1)return null;var E=a.isActiveIndex(A),O=_&&a.hasActiveIndex()?_:null,F=E?f:O,U=Ha(Ha({},w),{},{stroke:i?w.fill:w.stroke,tabIndex:-1});return Re.createElement(pi,ux({ref:function(q){q&&!a.sectorRefs.includes(q)&&a.sectorRefs.push(q)},tabIndex:-1,className:"recharts-pie-sector"},Yf(a.props,w,A),{key:"sector-".concat(w==null?void 0:w.startAngle,"-").concat(w==null?void 0:w.endAngle,"-").concat(w.midAngle,"-").concat(A)}),Re.createElement(bw,ux({option:F,isActive:E,shapeType:"sector"},U)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,l=a.sectors,f=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,E=this.state,O=E.prevSectors,F=E.prevIsAnimationActive;return Re.createElement(Pu,{begin:i,duration:_,isActive:f,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(A,"-").concat(F),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(U){var B=U.t,q=[],W=l&&l[0],Z=W.startAngle;return l.forEach(function(ne,ae){var ee=O&&O[ae],se=ae>0?wu(ne,"paddingAngle",0):0;if(ee){var ce=Za(ee.endAngle-ee.startAngle,ne.endAngle-ne.startAngle),ge=Ha(Ha({},ne),{},{startAngle:Z+se,endAngle:Z+ce(B)+se});q.push(ge),Z=ge.endAngle}else{var Te=ne.endAngle,Ae=ne.startAngle,_e=Za(0,Te-Ae),Ee=_e(B),ke=Ha(Ha({},ne),{},{startAngle:Z+se,endAngle:Z+Ee+se});q.push(ke),Z=ke.endAngle}}),Re.createElement(pi,null,n.renderSectorsStatically(q))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(l){if(!l.altKey)switch(l.key){case"ArrowLeft":{var f=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[f].focus(),a.setState({sectorToFocus:f});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,l=n.isAnimationActive,f=this.state.prevSectors;return l&&a&&a.length&&(!f||!xm(f,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,l=a.hide,f=a.sectors,i=a.className,_=a.label,w=a.cx,A=a.cy,E=a.innerRadius,O=a.outerRadius,F=a.isAnimationActive,U=this.state.isAnimationFinished;if(l||!f||!f.length||!Dr(w)||!Dr(A)||!Dr(E)||!Dr(O))return null;var B=hi("recharts-pie",i);return Re.createElement(pi,{tabIndex:this.props.rootTabIndex,className:B,ref:function(W){n.pieRef=W}},this.renderSectors(),_&&this.renderLabels(f),tl.renderCallByParent(this.props,null,!1),(!F||U)&&Td.renderCallByParent(this.props,f,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,l){if(Re.isValidElement(n))return Re.cloneElement(n,a);if($n(n))return n(a);var f=hi("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Re.createElement(Dg,ux({},a,{key:l,type:"linear",className:f}))}},{key:"renderLabelItem",value:function(n,a,l){if(Re.isValidElement(n))return Re.cloneElement(n,a);var f=l;if($n(n)&&(f=n(a),Re.isValidElement(f)))return f;var i=hi("recharts-pie-label-text",typeof n!="boolean"&&!$n(n)?n.className:"");return Re.createElement(zv,ux({},a,{alignmentBaseline:"middle",className:i}),f)}}])}(H.PureComponent);uA=op;xd(op,"displayName","Pie");xd(op,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!sp.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});xd(op,"parseDeltaAngle",function(e,t){var r=rl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});xd(op,"getRealPieData",function(e){var t=e.data,r=e.children,n=yn(e,!1),a=Vl(r,Xf);return t&&t.length?t.map(function(l,f){return Ha(Ha(Ha({payload:l},n),l),a&&a[f]&&a[f].props)}):a&&a.length?a.map(function(l){return Ha(Ha({},n),l.props)}):[]});xd(op,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,l=t.height,f=MQ(a,l),i=n+sc(e.cx,a,a/2),_=r+sc(e.cy,l,l/2),w=sc(e.innerRadius,f,0),A=sc(e.outerRadius,f,f*.8),E=e.maxRadius||Math.sqrt(a*a+l*l)/2;return{cx:i,cy:_,innerRadius:w,outerRadius:A,maxRadius:E}});xd(op,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Ha(Ha({},t.type.defaultProps),t.props):t.props,a=uA.getRealPieData(n);if(!a||!a.length)return null;var l=n.cornerRadius,f=n.startAngle,i=n.endAngle,_=n.paddingAngle,w=n.dataKey,A=n.nameKey,E=n.valueKey,O=n.tooltipType,F=Math.abs(n.minAngle),U=uA.parseCoordinateOfPie(n,r),B=uA.parseDeltaAngle(f,i),q=Math.abs(B),W=w;Yn(w)&&Yn(E)?(kh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),W="value"):Yn(w)&&(kh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),W=E);var Z=a.filter(function(ge){return Ya(ge,W,0)!==0}).length,ne=(q>=360?Z:Z-1)*_,ae=q-Z*F-ne,ee=a.reduce(function(ge,Te){var Ae=Ya(Te,W,0);return ge+(Dr(Ae)?Ae:0)},0),se;if(ee>0){var ce;se=a.map(function(ge,Te){var Ae=Ya(ge,W,0),_e=Ya(ge,A,Te),Ee=(Dr(Ae)?Ae:0)/ee,ke;Te?ke=ce.endAngle+rl(B)*_*(Ae!==0?1:0):ke=f;var Qe=ke+rl(B)*((Ae!==0?F:0)+Ee*ae),Ze=(ke+Qe)/2,Ge=(U.innerRadius+U.outerRadius)/2,Oe=[{name:_e,value:Ae,payload:ge,dataKey:W,type:O}],je=Ba(U.cx,U.cy,Ge,Ze);return ce=Ha(Ha(Ha({percent:Ee,cornerRadius:l,name:_e,tooltipPayload:Oe,midAngle:Ze,middleRadius:Ge,tooltipPosition:je},ge),U),{},{value:Ya(ge,W),startAngle:ke,endAngle:Qe,payload:ge,paddingAngle:rl(B)*_}),ce})}return Ha(Ha({},U),{},{sectors:se,data:a})});function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function AI(){return AI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},AI.apply(this,arguments)}function T9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function KO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T9(Object(r),!0).forEach(function(n){MNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MNe(e,t,r){return t=jNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jNe(e){var t=ONe(e,"string");return Sw(t)=="symbol"?t:t+""}function ONe(e,t){if(Sw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P9(e){return typeof e=="string"?parseInt(e,10):e}function NNe(e,t){var r="".concat(t.cx||e.cx),n=Number(r),a="".concat(t.cy||e.cy),l=Number(a);return KO(KO(KO({},t),e),{},{cx:n,cy:l})}function C9(e){return Re.createElement(bw,AI({shapeType:"sector",propTransformer:NNe},e))}var RNe=["shape","activeShape","activeIndex","cornerRadius"],INe=["value","background"];function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}function kT(){return kT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kT.apply(this,arguments)}function E9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E9(Object(r),!0).forEach(function(n){Mv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k9(e,t){if(e==null)return{};var r=DNe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function LNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,YQ(n.key),n)}}function zNe(e,t,r){return t&&M9(e.prototype,t),r&&M9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FNe(e,t,r){return t=MT(t),BNe(e,ZQ()?Reflect.construct(t,r||[],MT(e).constructor):t.apply(e,r))}function BNe(e,t){if(t&&(qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VNe(e)}function VNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZQ=function(){return!!e})()}function MT(e){return MT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MT(e)}function UNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&TI(e,t)}function TI(e,t){return TI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},TI(e,t)}function Mv(e,t,r){return t=YQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YQ(e){var t=$Ne(e,"string");return qx(t)=="symbol"?t:t+""}function $Ne(e,t){if(qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var c2=function(e){function t(){var r;LNe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=FNe(this,t,[].concat(a)),Mv(r,"state",{isAnimationFinished:!1}),Mv(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),$n(f)&&f()}),Mv(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),$n(f)&&f()}),r}return UNe(t,e),zNe(t,[{key:"getDeltaAngle",value:function(){var n=this.props,a=n.startAngle,l=n.endAngle,f=rl(l-a),i=Math.min(Math.abs(l-a),360);return f*i}},{key:"renderSectorsStatically",value:function(n){var a=this,l=this.props,f=l.shape,i=l.activeShape,_=l.activeIndex,w=l.cornerRadius,A=k9(l,RNe),E=yn(A,!1);return n.map(function(O,F){var U=F===_,B=Qo(Qo(Qo(Qo({},E),{},{cornerRadius:P9(w)},O),Yf(a.props,O,F)),{},{className:"recharts-radial-bar-sector ".concat(O.className),forceCornerRadius:A.forceCornerRadius,cornerIsExternal:A.cornerIsExternal,isActive:U,option:U?i:f});return Re.createElement(C9,kT({},B,{key:"sector-".concat(F)}))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,l=a.data,f=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,E=this.state.prevData;return Re.createElement(Pu,{begin:i,duration:_,isActive:f,easing:w,from:{t:0},to:{t:1},key:"radialBar-".concat(A),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(O){var F=O.t,U=l.map(function(B,q){var W=E&&E[q];if(W){var Z=Za(W.startAngle,B.startAngle),ne=Za(W.endAngle,B.endAngle);return Qo(Qo({},B),{},{startAngle:Z(F),endAngle:ne(F)})}var ae=B.endAngle,ee=B.startAngle,se=Za(ee,ae);return Qo(Qo({},B),{},{endAngle:se(F)})});return Re.createElement(pi,null,n.renderSectorsStatically(U))})}},{key:"renderSectors",value:function(){var n=this.props,a=n.data,l=n.isAnimationActive,f=this.state.prevData;return l&&a&&a.length&&(!f||!xm(f,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"renderBackground",value:function(n){var a=this,l=this.props.cornerRadius,f=yn(this.props.background,!1);return n.map(function(i,_){i.value;var w=i.background,A=k9(i,INe);if(!w)return null;var E=Qo(Qo(Qo(Qo(Qo({cornerRadius:P9(l)},A),{},{fill:"#eee"},w),f),Yf(a.props,i,_)),{},{index:_,className:hi("recharts-radial-bar-background-sector",f==null?void 0:f.className),option:w,isActive:!1});return Re.createElement(C9,kT({},E,{key:"sector-".concat(_)}))})}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.data,f=n.className,i=n.background,_=n.isAnimationActive;if(a||!l||!l.length)return null;var w=this.state.isAnimationFinished,A=hi("recharts-area",f);return Re.createElement(pi,{className:A},i&&Re.createElement(pi,{className:"recharts-radial-bar-background"},this.renderBackground(l)),Re.createElement(pi,{className:"recharts-radial-bar-sectors"},this.renderSectors()),(!_||w)&&Td.renderCallByParent(Qo({},this.props),l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(H.PureComponent);Mv(c2,"displayName","RadialBar");Mv(c2,"defaultProps",{angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!sp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1});Mv(c2,"getComposedData",function(e){var t=e.item,r=e.props,n=e.radiusAxis,a=e.radiusAxisTicks,l=e.angleAxis,f=e.angleAxisTicks,i=e.displayedData,_=e.dataKey,w=e.stackedData,A=e.barPosition,E=e.bandSize,O=e.dataStartIndex,F=AQ(A,t);if(!F)return null;var U=l.cx,B=l.cy,q=r.layout,W=t.props,Z=W.children,ne=W.minPointSize,ae=q==="radial"?l:n,ee=w?ae.scale.domain():null,se=CQ({numericAxis:ae}),ce=Vl(Z,Xf),ge=i.map(function(Te,Ae){var _e,Ee,ke,Qe,Ze,Ge;if(w?_e=TQ(w[O+Ae],ee):(_e=Ya(Te,_),Array.isArray(_e)||(_e=[se,_e])),q==="radial"){Ee=gT({axis:n,ticks:a,bandSize:E,offset:F.offset,entry:Te,index:Ae}),Ze=l.scale(_e[1]),Qe=l.scale(_e[0]),ke=Ee+F.size;var Oe=Ze-Qe;if(Math.abs(ne)>0&&Math.abs(Oe)<Math.abs(ne)){var je=rl(Oe||ne)*(Math.abs(ne)-Math.abs(Oe));Ze+=je}Ge={background:{cx:U,cy:B,innerRadius:Ee,outerRadius:ke,startAngle:r.startAngle,endAngle:r.endAngle}}}else{Ee=n.scale(_e[0]),ke=n.scale(_e[1]),Qe=gT({axis:l,ticks:f,bandSize:E,offset:F.offset,entry:Te,index:Ae}),Ze=Qe+F.size;var Le=ke-Ee;if(Math.abs(ne)>0&&Math.abs(Le)<Math.abs(ne)){var ut=rl(Le||ne)*(Math.abs(ne)-Math.abs(Le));ke+=ut}}return Qo(Qo(Qo(Qo({},Te),Ge),{},{payload:Te,value:w?_e:_e[1],cx:U,cy:B,innerRadius:Ee,outerRadius:ke,startAngle:Qe,endAngle:Ze},ce&&ce[Ae]&&ce[Ae].props),{},{tooltipPayload:[zL(t,Te)],tooltipPosition:Ba(U,B,(Ee+ke)/2,(Qe+Ze)/2)})});return{data:ge,layout:q}});var ZO,j9;function qNe(){if(j9)return ZO;j9=1;var e=Math.ceil,t=Math.max;function r(n,a,l,f){for(var i=-1,_=t(e((a-n)/(l||1)),0),w=Array(_);_--;)w[f?_:++i]=n,n+=l;return w}return ZO=r,ZO}var YO,O9;function XQ(){if(O9)return YO;O9=1;var e=mJ(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-1/0){var l=a<0?-1:1;return l*r}return a===a?a:0}return YO=n,YO}var XO,N9;function GNe(){if(N9)return XO;N9=1;var e=qNe(),t=VP(),r=XQ();function n(a){return function(l,f,i){return i&&typeof i!="number"&&t(l,f,i)&&(f=i=void 0),l=r(l),f===void 0?(f=l,l=0):f=r(f),i=i===void 0?l<f?1:-1:r(i),e(l,f,i,a)}}return XO=n,XO}var JO,R9;function WNe(){if(R9)return JO;R9=1;var e=GNe(),t=e();return JO=t,JO}var HNe=WNe();const jT=oa(HNe);function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function I9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I9(Object(r),!0).forEach(function(n){JQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JQ(e,t,r){return t=KNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KNe(e){var t=ZNe(e,"string");return Aw(t)=="symbol"?t:t+""}function ZNe(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YNe=["Webkit","Moz","O","ms"],XNe=function(t,r){var n=t.replace(/(\w)/,function(l){return l.toUpperCase()}),a=YNe.reduce(function(l,f){return D9(D9({},l),{},JQ({},f+n,r))},{});return a[t]=r,a};function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function OT(){return OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OT.apply(this,arguments)}function L9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L9(Object(r),!0).forEach(function(n){fu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eee(n.key),n)}}function QNe(e,t,r){return t&&z9(e.prototype,t),r&&z9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eRe(e,t,r){return t=NT(t),tRe(e,QQ()?Reflect.construct(t,r||[],NT(e).constructor):t.apply(e,r))}function tRe(e,t){if(t&&(Gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rRe(e)}function rRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QQ=function(){return!!e})()}function NT(e){return NT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},NT(e)}function nRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PI(e,t)}function PI(e,t){return PI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},PI(e,t)}function fu(e,t,r){return t=eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eee(e){var t=iRe(e,"string");return Gx(t)=="symbol"?t:t+""}function iRe(e,t){if(Gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var aRe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,l=t.x,f=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var _=r.length,w=c1().domain(jT(0,_)).range([l,l+f-i]),A=w.domain().map(function(E){return w(E)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:w(n),endX:w(a),scale:w,scaleValues:A}},F9=function(t){return t.changedTouches&&!!t.changedTouches.length},Wx=function(e){function t(r){var n;return JNe(this,t),n=eRe(this,t,[r]),fu(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),fu(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),fu(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,l=a.endIndex,f=a.onDragEnd,i=a.startIndex;f==null||f({endIndex:l,startIndex:i})}),n.detachDragEndListener()}),fu(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),fu(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),fu(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),fu(n,"handleSlideDragStart",function(a){var l=F9(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return nRe(t,e),QNe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,l=n.endX,f=this.state.scaleValues,i=this.props,_=i.gap,w=i.data,A=w.length-1,E=Math.min(a,l),O=Math.max(a,l),F=t.getIndexInRange(f,E),U=t.getIndexInRange(f,O);return{startIndex:F-F%_,endIndex:U===A?A:U-U%_}}},{key:"getTextOfTick",value:function(n){var a=this.props,l=a.data,f=a.tickFormatter,i=a.dataKey,_=Ya(l[n],i,n);return $n(f)?f(_,n):_}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,l=a.slideMoveStartX,f=a.startX,i=a.endX,_=this.props,w=_.x,A=_.width,E=_.travellerWidth,O=_.startIndex,F=_.endIndex,U=_.onChange,B=n.pageX-l;B>0?B=Math.min(B,w+A-E-i,w+A-E-f):B<0&&(B=Math.max(B,w-f,w-i));var q=this.getIndex({startX:f+B,endX:i+B});(q.startIndex!==O||q.endIndex!==F)&&U&&U(q),this.setState({startX:f+B,endX:i+B,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var l=F9(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,l=a.brushMoveStartX,f=a.movingTravellerId,i=a.endX,_=a.startX,w=this.state[f],A=this.props,E=A.x,O=A.width,F=A.travellerWidth,U=A.onChange,B=A.gap,q=A.data,W={startX:this.state.startX,endX:this.state.endX},Z=n.pageX-l;Z>0?Z=Math.min(Z,E+O-F-w):Z<0&&(Z=Math.max(Z,E-w)),W[f]=w+Z;var ne=this.getIndex(W),ae=ne.startIndex,ee=ne.endIndex,se=function(){var ge=q.length-1;return f==="startX"&&(i>_?ae%B===0:ee%B===0)||i<_&&ee===ge||f==="endX"&&(i>_?ee%B===0:ae%B===0)||i>_&&ee===ge};this.setState(fu(fu({},f,w+Z),"brushMoveStartX",n.pageX),function(){U&&se()&&U(ne)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var l=this,f=this.state,i=f.scaleValues,_=f.startX,w=f.endX,A=this.state[a],E=i.indexOf(A);if(E!==-1){var O=E+n;if(!(O===-1||O>=i.length)){var F=i[O];a==="startX"&&F>=w||a==="endX"&&F<=_||this.setState(fu({},a,F),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,l=n.y,f=n.width,i=n.height,_=n.fill,w=n.stroke;return Re.createElement("rect",{stroke:w,fill:_,x:a,y:l,width:f,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,l=n.y,f=n.width,i=n.height,_=n.data,w=n.children,A=n.padding,E=H.Children.only(w);return E?Re.cloneElement(E,{x:a,y:l,width:f,height:i,margin:A,compact:!0,data:_}):null}},{key:"renderTravellerLayer",value:function(n,a){var l,f,i=this,_=this.props,w=_.y,A=_.travellerWidth,E=_.height,O=_.traveller,F=_.ariaLabel,U=_.data,B=_.startIndex,q=_.endIndex,W=Math.max(n,this.props.x),Z=QO(QO({},yn(this.props,!1)),{},{x:W,y:w,width:A,height:E}),ne=F||"Min value: ".concat((l=U[B])===null||l===void 0?void 0:l.name,", Max value: ").concat((f=U[q])===null||f===void 0?void 0:f.name);return Re.createElement(pi,{tabIndex:0,role:"slider","aria-label":ne,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(ee){["ArrowLeft","ArrowRight"].includes(ee.key)&&(ee.preventDefault(),ee.stopPropagation(),i.handleTravellerMoveKeyboard(ee.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(O,Z))}},{key:"renderSlide",value:function(n,a){var l=this.props,f=l.y,i=l.height,_=l.stroke,w=l.travellerWidth,A=Math.min(n,a)+w,E=Math.max(Math.abs(a-n)-w,0);return Re.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:_,fillOpacity:.2,x:A,y:f,width:E,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,l=n.endIndex,f=n.y,i=n.height,_=n.travellerWidth,w=n.stroke,A=this.state,E=A.startX,O=A.endX,F=5,U={pointerEvents:"none",fill:w};return Re.createElement(pi,{className:"recharts-brush-texts"},Re.createElement(zv,OT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(E,O)-F,y:f+i/2},U),this.getTextOfTick(a)),Re.createElement(zv,OT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(E,O)+_+F,y:f+i/2},U),this.getTextOfTick(l)))}},{key:"render",value:function(){var n=this.props,a=n.data,l=n.className,f=n.children,i=n.x,_=n.y,w=n.width,A=n.height,E=n.alwaysShowText,O=this.state,F=O.startX,U=O.endX,B=O.isTextActive,q=O.isSlideMoving,W=O.isTravellerMoving,Z=O.isTravellerFocused;if(!a||!a.length||!Dr(i)||!Dr(_)||!Dr(w)||!Dr(A)||w<=0||A<=0)return null;var ne=hi("recharts-brush",l),ae=Re.Children.count(f)===1,ee=XNe("userSelect","none");return Re.createElement(pi,{className:ne,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ee},this.renderBackground(),ae&&this.renderPanorama(),this.renderSlide(F,U),this.renderTravellerLayer(F,"startX"),this.renderTravellerLayer(U,"endX"),(B||q||W||Z||E)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,l=n.y,f=n.width,i=n.height,_=n.stroke,w=Math.floor(l+i/2)-1;return Re.createElement(Re.Fragment,null,Re.createElement("rect",{x:a,y:l,width:f,height:i,fill:_,stroke:"none"}),Re.createElement("line",{x1:a+1,y1:w,x2:a+f-1,y2:w,fill:"none",stroke:"#fff"}),Re.createElement("line",{x1:a+1,y1:w+2,x2:a+f-1,y2:w+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var l;return Re.isValidElement(n)?l=Re.cloneElement(n,a):$n(n)?l=n(a):l=t.renderDefaultTraveller(a),l}},{key:"getDerivedStateFromProps",value:function(n,a){var l=n.data,f=n.width,i=n.x,_=n.travellerWidth,w=n.updateId,A=n.startIndex,E=n.endIndex;if(l!==a.prevData||w!==a.prevUpdateId)return QO({prevData:l,prevTravellerWidth:_,prevUpdateId:w,prevX:i,prevWidth:f},l&&l.length?aRe({data:l,width:f,x:i,travellerWidth:_,startIndex:A,endIndex:E}):{scale:null,scaleValues:null});if(a.scale&&(f!==a.prevWidth||i!==a.prevX||_!==a.prevTravellerWidth)){a.scale.range([i,i+f-_]);var O=a.scale.domain().map(function(F){return a.scale(F)});return{prevData:l,prevTravellerWidth:_,prevUpdateId:w,prevX:i,prevWidth:f,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:O}}return null}},{key:"getIndexInRange",value:function(n,a){for(var l=n.length,f=0,i=l-1;i-f>1;){var _=Math.floor((f+i)/2);n[_]>a?i=_:f=_}return a>=n[i]?i:f}}])}(H.PureComponent);fu(Wx,"displayName","Brush");fu(Wx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var eN,B9;function sRe(){if(B9)return eN;B9=1;var e=uL();function t(r,n){var a;return e(r,function(l,f,i){return a=n(l,f,i),!a}),!!a}return eN=t,eN}var tN,V9;function oRe(){if(V9)return tN;V9=1;var e=WX(),t=ap(),r=sRe(),n=Bc(),a=VP();function l(f,i,_){var w=n(f)?e:r;return _&&a(f,i,_)&&(i=void 0),w(f,t(i,3))}return tN=l,tN}var lRe=oRe();const cRe=oa(lRe);var qf=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},rN,U9;function uRe(){if(U9)return rN;U9=1;var e=uJ();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return rN=t,rN}var nN,$9;function dRe(){if($9)return nN;$9=1;var e=uRe(),t=lJ(),r=ap();function n(a,l){var f={};return l=r(l,3),t(a,function(i,_,w){e(f,_,l(i,_,w))}),f}return nN=n,nN}var hRe=dRe();const fRe=oa(hRe);var iN,q9;function pRe(){if(q9)return iN;q9=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return iN=e,iN}var aN,G9;function mRe(){if(G9)return aN;G9=1;var e=uL();function t(r,n){var a=!0;return e(r,function(l,f,i){return a=!!n(l,f,i),a}),a}return aN=t,aN}var sN,W9;function gRe(){if(W9)return sN;W9=1;var e=pRe(),t=mRe(),r=ap(),n=Bc(),a=VP();function l(f,i,_){var w=n(f)?e:t;return _&&a(f,i,_)&&(i=void 0),w(f,r(i,3))}return sN=l,sN}var yRe=gRe();const tee=oa(yRe);var vRe=["x","y"];function Tw(e){"@babel/helpers - typeof";return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}function CI(){return CI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CI.apply(this,arguments)}function H9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ub(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H9(Object(r),!0).forEach(function(n){xRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xRe(e,t,r){return t=_Re(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Re(e){var t=bRe(e,"string");return Tw(t)=="symbol"?t:t+""}function bRe(e,t){if(Tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wRe(e,t){if(e==null)return{};var r=SRe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ARe(e,t){var r=e.x,n=e.y,a=wRe(e,vRe),l="".concat(r),f=parseInt(l,10),i="".concat(n),_=parseInt(i,10),w="".concat(t.height||a.height),A=parseInt(w,10),E="".concat(t.width||a.width),O=parseInt(E,10);return Ub(Ub(Ub(Ub(Ub({},t),a),f?{x:f}:{}),_?{y:_}:{}),{},{height:A,width:O,name:t.name,radius:t.radius})}function K9(e){return Re.createElement(bw,CI({shapeType:"rectangle",propTransformer:ARe,activeClassName:"recharts-active-bar"},e))}var TRe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var l=typeof n=="number";return l?t(n,a):(l||Bv(),r)}},PRe=["value","background"],ree;function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function CRe(e,t){if(e==null)return{};var r=ERe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ERe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function RT(){return RT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RT.apply(this,arguments)}function Z9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z9(Object(r),!0).forEach(function(n){jg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iee(n.key),n)}}function MRe(e,t,r){return t&&Y9(e.prototype,t),r&&Y9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jRe(e,t,r){return t=IT(t),ORe(e,nee()?Reflect.construct(t,r||[],IT(e).constructor):t.apply(e,r))}function ORe(e,t){if(t&&(Hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NRe(e)}function NRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nee=function(){return!!e})()}function IT(e){return IT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},IT(e)}function RRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EI(e,t)}function EI(e,t){return EI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},EI(e,t)}function jg(e,t,r){return t=iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iee(e){var t=IRe(e,"string");return Hx(t)=="symbol"?t:t+""}function IRe(e,t){if(Hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xs=function(e){function t(){var r;kRe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=jRe(this,t,[].concat(a)),jg(r,"state",{isAnimationFinished:!1}),jg(r,"id",ty("recharts-bar-")),jg(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),f&&f()}),jg(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),f&&f()}),r}return RRe(t,e),MRe(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,l=this.props,f=l.shape,i=l.dataKey,_=l.activeIndex,w=l.activeBar,A=yn(this.props,!1);return n&&n.map(function(E,O){var F=O===_,U=F?w:f,B=fo(fo(fo({},A),E),{},{isActive:F,option:U,index:O,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Re.createElement(pi,RT({className:"recharts-bar-rectangle"},Yf(a.props,E,O),{key:"rectangle-".concat(E==null?void 0:E.x,"-").concat(E==null?void 0:E.y,"-").concat(E==null?void 0:E.value)}),Re.createElement(K9,B))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,l=a.data,f=a.layout,i=a.isAnimationActive,_=a.animationBegin,w=a.animationDuration,A=a.animationEasing,E=a.animationId,O=this.state.prevData;return Re.createElement(Pu,{begin:_,duration:w,isActive:i,easing:A,from:{t:0},to:{t:1},key:"bar-".concat(E),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(F){var U=F.t,B=l.map(function(q,W){var Z=O&&O[W];if(Z){var ne=Za(Z.x,q.x),ae=Za(Z.y,q.y),ee=Za(Z.width,q.width),se=Za(Z.height,q.height);return fo(fo({},q),{},{x:ne(U),y:ae(U),width:ee(U),height:se(U)})}if(f==="horizontal"){var ce=Za(0,q.height),ge=ce(U);return fo(fo({},q),{},{y:q.y+q.height-ge,height:ge})}var Te=Za(0,q.width),Ae=Te(U);return fo(fo({},q),{},{width:Ae})});return Re.createElement(pi,null,n.renderRectanglesStatically(B))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,l=n.isAnimationActive,f=this.state.prevData;return l&&a&&a.length&&(!f||!xm(f,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,l=a.data,f=a.dataKey,i=a.activeIndex,_=yn(this.props.background,!1);return l.map(function(w,A){w.value;var E=w.background,O=CRe(w,PRe);if(!E)return null;var F=fo(fo(fo(fo(fo({},O),{},{fill:"#eee"},E),_),Yf(n.props,w,A)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:f,index:A,className:"recharts-bar-background-rectangle"});return Re.createElement(K9,RT({key:"background-bar-".concat(A),option:n.props.background,isActive:A===i},F))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,f=l.data,i=l.xAxis,_=l.yAxis,w=l.layout,A=l.children,E=Vl(A,M_);if(!E)return null;var O=w==="vertical"?f[0].height/2:f[0].width/2,F=function(q,W){var Z=Array.isArray(q.value)?q.value[1]:q.value;return{x:q.x,y:q.y,value:Z,errorVal:Ya(q,W)}},U={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Re.createElement(pi,U,E.map(function(B){return Re.cloneElement(B,{key:"error-bar-".concat(a,"-").concat(B.props.dataKey),data:f,xAxis:i,yAxis:_,layout:w,offset:O,dataPointFormatter:F})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.data,f=n.className,i=n.xAxis,_=n.yAxis,w=n.left,A=n.top,E=n.width,O=n.height,F=n.isAnimationActive,U=n.background,B=n.id;if(a||!l||!l.length)return null;var q=this.state.isAnimationFinished,W=hi("recharts-bar",f),Z=i&&i.allowDataOverflow,ne=_&&_.allowDataOverflow,ae=Z||ne,ee=Yn(B)?this.id:B;return Re.createElement(pi,{className:W},Z||ne?Re.createElement("defs",null,Re.createElement("clipPath",{id:"clipPath-".concat(ee)},Re.createElement("rect",{x:Z?w:w-E/2,y:ne?A:A-O/2,width:Z?E:E*2,height:ne?O:O*2}))):null,Re.createElement(pi,{className:"recharts-bar-rectangles",clipPath:ae?"url(#clipPath-".concat(ee,")"):null},U?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(ae,ee),(!F||q)&&Td.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(H.PureComponent);ree=xs;jg(xs,"displayName","Bar");jg(xs,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!sp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});jg(xs,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,l=e.xAxis,f=e.yAxis,i=e.xAxisTicks,_=e.yAxisTicks,w=e.stackedData,A=e.dataStartIndex,E=e.displayedData,O=e.offset,F=AQ(n,r);if(!F)return null;var U=t.layout,B=r.type.defaultProps,q=B!==void 0?fo(fo({},B),r.props):r.props,W=q.dataKey,Z=q.children,ne=q.minPointSize,ae=U==="horizontal"?f:l,ee=w?ae.scale.domain():null,se=CQ({numericAxis:ae}),ce=Vl(Z,Xf),ge=E.map(function(Te,Ae){var _e,Ee,ke,Qe,Ze,Ge;w?_e=TQ(w[A+Ae],ee):(_e=Ya(Te,W),Array.isArray(_e)||(_e=[se,_e]));var Oe=TRe(ne,ree.defaultProps.minPointSize)(_e[1],Ae);if(U==="horizontal"){var je,Le=[f.scale(_e[0]),f.scale(_e[1])],ut=Le[0],ze=Le[1];Ee=gT({axis:l,ticks:i,bandSize:a,offset:F.offset,entry:Te,index:Ae}),ke=(je=ze??ut)!==null&&je!==void 0?je:void 0,Qe=F.size;var ht=ut-ze;if(Ze=Number.isNaN(ht)?0:ht,Ge={x:Ee,y:f.y,width:Qe,height:f.height},Math.abs(Oe)>0&&Math.abs(Ze)<Math.abs(Oe)){var rt=rl(Ze||Oe)*(Math.abs(Oe)-Math.abs(Ze));ke-=rt,Ze+=rt}}else{var Qt=[l.scale(_e[0]),l.scale(_e[1])],Cr=Qt[0],vr=Qt[1];if(Ee=Cr,ke=gT({axis:f,ticks:_,bandSize:a,offset:F.offset,entry:Te,index:Ae}),Qe=vr-Cr,Ze=F.size,Ge={x:l.x,y:ke,width:l.width,height:Ze},Math.abs(Oe)>0&&Math.abs(Qe)<Math.abs(Oe)){var cr=rl(Qe||Oe)*(Math.abs(Oe)-Math.abs(Qe));Qe+=cr}}return fo(fo(fo({},Te),{},{x:Ee,y:ke,width:Qe,height:Ze,value:w?_e:_e[1],payload:Te,background:Ge},ce&&ce[Ae]&&ce[Ae].props),{},{tooltipPayload:[zL(r,Te)],tooltipPosition:{x:Ee+Qe/2,y:ke+Ze/2}})});return fo({data:ge,layout:U},O)});function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function DRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,aee(n.key),n)}}function LRe(e,t,r){return t&&X9(e.prototype,t),r&&X9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J9(Object(r),!0).forEach(function(n){rC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rC(e,t,r){return t=aee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aee(e){var t=zRe(e,"string");return Pw(t)=="symbol"?t:t+""}function zRe(e,t){if(Pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u2=function(t,r,n,a,l){var f=t.width,i=t.height,_=t.layout,w=t.children,A=Object.keys(r),E={left:n.left,leftMirror:n.left,right:f-n.right,rightMirror:f-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},O=!!pu(w,xs);return A.reduce(function(F,U){var B=r[U],q=B.orientation,W=B.domain,Z=B.padding,ne=Z===void 0?{}:Z,ae=B.mirror,ee=B.reversed,se="".concat(q).concat(ae?"Mirror":""),ce,ge,Te,Ae,_e;if(B.type==="number"&&(B.padding==="gap"||B.padding==="no-gap")){var Ee=W[1]-W[0],ke=1/0,Qe=B.categoricalDomain.sort();if(Qe.forEach(function(Qt,Cr){Cr>0&&(ke=Math.min((Qt||0)-(Qe[Cr-1]||0),ke))}),Number.isFinite(ke)){var Ze=ke/Ee,Ge=B.layout==="vertical"?n.height:n.width;if(B.padding==="gap"&&(ce=Ze*Ge/2),B.padding==="no-gap"){var Oe=sc(t.barCategoryGap,Ze*Ge),je=Ze*Ge/2;ce=je-Oe-(je-Oe)/Ge*Oe}}}a==="xAxis"?ge=[n.left+(ne.left||0)+(ce||0),n.left+n.width-(ne.right||0)-(ce||0)]:a==="yAxis"?ge=_==="horizontal"?[n.top+n.height-(ne.bottom||0),n.top+(ne.top||0)]:[n.top+(ne.top||0)+(ce||0),n.top+n.height-(ne.bottom||0)-(ce||0)]:ge=B.range,ee&&(ge=[ge[1],ge[0]]);var Le=wQ(B,l,O),ut=Le.scale,ze=Le.realScaleType;ut.domain(W).range(ge),SQ(ut);var ht=PQ(ut,Sh(Sh({},B),{},{realScaleType:ze}));a==="xAxis"?(_e=q==="top"&&!ae||q==="bottom"&&ae,Te=n.left,Ae=E[se]-_e*B.height):a==="yAxis"&&(_e=q==="left"&&!ae||q==="right"&&ae,Te=E[se]-_e*B.width,Ae=n.top);var rt=Sh(Sh(Sh({},B),ht),{},{realScaleType:ze,x:Te,y:Ae,scale:ut,width:a==="xAxis"?n.width:B.width,height:a==="yAxis"?n.height:B.height});return rt.bandSize=yT(rt,ht),!B.hide&&a==="xAxis"?E[se]+=(_e?-1:1)*rt.height:B.hide||(E[se]+=(_e?-1:1)*rt.width),Sh(Sh({},F),{},rC({},U,rt))},{})},see=function(t,r){var n=t.x,a=t.y,l=r.x,f=r.y;return{x:Math.min(n,l),y:Math.min(a,f),width:Math.abs(l-n),height:Math.abs(f-a)}},FRe=function(t){var r=t.x1,n=t.y1,a=t.x2,l=t.y2;return see({x:r,y:n},{x:a,y:l})},oee=function(){function e(t){DRe(this,e),this.scale=t}return LRe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,l=n.position;if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+f}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(a){var _=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+_}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],l=n[n.length-1];return a<=l?r>=a&&r<=l:r>=l&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();rC(oee,"EPS",1e-4);var BL=function(t){var r=Object.keys(t).reduce(function(n,a){return Sh(Sh({},n),{},rC({},a,oee.create(t[a])))},{});return Sh(Sh({},r),{},{apply:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=l.bandAware,i=l.position;return fRe(a,function(_,w){return r[w].apply(_,{bandAware:f,position:i})})},isInRange:function(a){return tee(a,function(l,f){return r[f].isInRange(l)})}})};function BRe(e){return(e%180+180)%180}var VRe=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=BRe(a),f=l*Math.PI/180,i=Math.atan(n/r),_=f>i&&f<Math.PI-i?n/Math.sin(f):r/Math.cos(f);return Math.abs(_)},oN,Q9;function URe(){if(Q9)return oN;Q9=1;var e=ap(),t=t2(),r=FP();function n(a){return function(l,f,i){var _=Object(l);if(!t(l)){var w=e(f,3);l=r(l),f=function(E){return w(_[E],E,_)}}var A=a(l,f,i);return A>-1?_[w?l[A]:A]:void 0}}return oN=n,oN}var lN,eG;function $Re(){if(eG)return lN;eG=1;var e=XQ();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return lN=t,lN}var cN,tG;function qRe(){if(tG)return cN;tG=1;var e=nJ(),t=ap(),r=$Re(),n=Math.max;function a(l,f,i){var _=l==null?0:l.length;if(!_)return-1;var w=i==null?0:r(i);return w<0&&(w=n(_+w,0)),e(l,t(f,3),w)}return cN=a,cN}var uN,rG;function GRe(){if(rG)return uN;rG=1;var e=URe(),t=qRe(),r=e(t);return uN=r,uN}var WRe=GRe();const HRe=oa(WRe);var KRe=vX();const ZRe=oa(KRe);var YRe=ZRe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),VL=H.createContext(void 0),UL=H.createContext(void 0),lee=H.createContext(void 0),cee=H.createContext({}),uee=H.createContext(void 0),dee=H.createContext(0),hee=H.createContext(0),nG=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,l=r.offset,f=t.clipPathId,i=t.children,_=t.width,w=t.height,A=YRe(l);return Re.createElement(VL.Provider,{value:n},Re.createElement(UL.Provider,{value:a},Re.createElement(cee.Provider,{value:l},Re.createElement(lee.Provider,{value:A},Re.createElement(uee.Provider,{value:f},Re.createElement(dee.Provider,{value:w},Re.createElement(hee.Provider,{value:_},i)))))))},XRe=function(){return H.useContext(uee)},fee=function(t){var r=H.useContext(VL);r==null&&Bv();var n=r[t];return n==null&&Bv(),n},JRe=function(){var t=H.useContext(VL);return kg(t)},QRe=function(){var t=H.useContext(UL),r=HRe(t,function(n){return tee(n.domain,Number.isFinite)});return r||kg(t)},pee=function(t){var r=H.useContext(UL);r==null&&Bv();var n=r[t];return n==null&&Bv(),n},eIe=function(){var t=H.useContext(lee);return t},tIe=function(){return H.useContext(cee)},$L=function(){return H.useContext(hee)},qL=function(){return H.useContext(dee)};function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function rIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gee(n.key),n)}}function iIe(e,t,r){return t&&nIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aIe(e,t,r){return t=DT(t),sIe(e,mee()?Reflect.construct(t,r||[],DT(e).constructor):t.apply(e,r))}function sIe(e,t){if(t&&(Kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oIe(e)}function oIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mee=function(){return!!e})()}function DT(e){return DT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DT(e)}function lIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kI(e,t)}function kI(e,t){return kI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},kI(e,t)}function iG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iG(Object(r),!0).forEach(function(n){GL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GL(e,t,r){return t=gee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gee(e){var t=cIe(e,"string");return Kx(t)=="symbol"?t:t+""}function cIe(e,t){if(Kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function uIe(e,t){return pIe(e)||fIe(e,t)||hIe(e,t)||dIe()}function dIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hIe(e,t){if(e){if(typeof e=="string")return sG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sG(e,t)}}function sG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function pIe(e){if(Array.isArray(e))return e}function MI(){return MI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MI.apply(this,arguments)}var mIe=function(t,r){var n;return Re.isValidElement(t)?n=Re.cloneElement(t,r):$n(t)?n=t(r):n=Re.createElement("line",MI({},r,{className:"recharts-reference-line-line"})),n},gIe=function(t,r,n,a,l,f,i,_,w){var A=l.x,E=l.y,O=l.width,F=l.height;if(n){var U=w.y,B=t.y.apply(U,{position:f});if(qf(w,"discard")&&!t.y.isInRange(B))return null;var q=[{x:A+O,y:B},{x:A,y:B}];return _==="left"?q.reverse():q}if(r){var W=w.x,Z=t.x.apply(W,{position:f});if(qf(w,"discard")&&!t.x.isInRange(Z))return null;var ne=[{x:Z,y:E+F},{x:Z,y:E}];return i==="top"?ne.reverse():ne}if(a){var ae=w.segment,ee=ae.map(function(se){return t.apply(se,{position:f})});return qf(w,"discard")&&cRe(ee,function(se){return!t.isInRange(se)})?null:ee}return null};function yIe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,l=e.yAxisId,f=e.shape,i=e.className,_=e.alwaysShow,w=XRe(),A=fee(a),E=pee(l),O=eIe();if(!w||!O)return null;kh(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var F=BL({x:A.scale,y:E.scale}),U=Ro(t),B=Ro(r),q=n&&n.length===2,W=gIe(F,U,B,q,O,e.position,A.orientation,E.orientation,e);if(!W)return null;var Z=uIe(W,2),ne=Z[0],ae=ne.x,ee=ne.y,se=Z[1],ce=se.x,ge=se.y,Te=qf(e,"hidden")?"url(#".concat(w,")"):void 0,Ae=aG(aG({clipPath:Te},yn(e,!0)),{},{x1:ae,y1:ee,x2:ce,y2:ge});return Re.createElement(pi,{className:hi("recharts-reference-line",i)},mIe(f,Ae),tl.renderCallByParent(e,FRe({x1:ae,y1:ee,x2:ce,y2:ge})))}var WL=function(e){function t(){return rIe(this,t),aIe(this,t,arguments)}return lIe(t,e),iIe(t,[{key:"render",value:function(){return Re.createElement(yIe,this.props)}}])}(Re.Component);GL(WL,"displayName","ReferenceLine");GL(WL,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function jI(){return jI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jI.apply(this,arguments)}function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function oG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oG(Object(r),!0).forEach(function(n){nC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vee(n.key),n)}}function _Ie(e,t,r){return t&&xIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bIe(e,t,r){return t=LT(t),wIe(e,yee()?Reflect.construct(t,r||[],LT(e).constructor):t.apply(e,r))}function wIe(e,t){if(t&&(Zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SIe(e)}function SIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yee=function(){return!!e})()}function LT(e){return LT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LT(e)}function AIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OI(e,t)}function OI(e,t){return OI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},OI(e,t)}function nC(e,t,r){return t=vee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vee(e){var t=TIe(e,"string");return Zx(t)=="symbol"?t:t+""}function TIe(e,t){if(Zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var PIe=function(t){var r=t.x,n=t.y,a=t.xAxis,l=t.yAxis,f=BL({x:a.scale,y:l.scale}),i=f.apply({x:r,y:n},{bandAware:!0});return qf(t,"discard")&&!f.isInRange(i)?null:i},iC=function(e){function t(){return vIe(this,t),bIe(this,t,arguments)}return AIe(t,e),_Ie(t,[{key:"render",value:function(){var n=this.props,a=n.x,l=n.y,f=n.r,i=n.alwaysShow,_=n.clipPathId,w=Ro(a),A=Ro(l);if(kh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!w||!A)return null;var E=PIe(this.props);if(!E)return null;var O=E.x,F=E.y,U=this.props,B=U.shape,q=U.className,W=qf(this.props,"hidden")?"url(#".concat(_,")"):void 0,Z=lG(lG({clipPath:W},yn(this.props,!0)),{},{cx:O,cy:F});return Re.createElement(pi,{className:hi("recharts-reference-dot",q)},t.renderDot(B,Z),tl.renderCallByParent(this.props,{x:O-f,y:F-f,width:2*f,height:2*f}))}}])}(Re.Component);nC(iC,"displayName","ReferenceDot");nC(iC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});nC(iC,"renderDot",function(e,t){var r;return Re.isValidElement(e)?r=Re.cloneElement(e,t):$n(e)?r=e(t):r=Re.createElement(s2,jI({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function NI(){return NI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NI.apply(this,arguments)}function Yx(e){"@babel/helpers - typeof";return Yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yx(e)}function cG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cG(Object(r),!0).forEach(function(n){aC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_ee(n.key),n)}}function kIe(e,t,r){return t&&EIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function MIe(e,t,r){return t=zT(t),jIe(e,xee()?Reflect.construct(t,r||[],zT(e).constructor):t.apply(e,r))}function jIe(e,t){if(t&&(Yx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OIe(e)}function OIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xee=function(){return!!e})()}function zT(e){return zT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zT(e)}function NIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RI(e,t)}function RI(e,t){return RI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},RI(e,t)}function aC(e,t,r){return t=_ee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _ee(e){var t=RIe(e,"string");return Yx(t)=="symbol"?t:t+""}function RIe(e,t){if(Yx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var IIe=function(t,r,n,a,l){var f=l.x1,i=l.x2,_=l.y1,w=l.y2,A=l.xAxis,E=l.yAxis;if(!A||!E)return null;var O=BL({x:A.scale,y:E.scale}),F={x:t?O.x.apply(f,{position:"start"}):O.x.rangeMin,y:n?O.y.apply(_,{position:"start"}):O.y.rangeMin},U={x:r?O.x.apply(i,{position:"end"}):O.x.rangeMax,y:a?O.y.apply(w,{position:"end"}):O.y.rangeMax};return qf(l,"discard")&&(!O.isInRange(F)||!O.isInRange(U))?null:see(F,U)},sC=function(e){function t(){return CIe(this,t),MIe(this,t,arguments)}return NIe(t,e),kIe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,l=n.x2,f=n.y1,i=n.y2,_=n.className,w=n.alwaysShow,A=n.clipPathId;kh(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var E=Ro(a),O=Ro(l),F=Ro(f),U=Ro(i),B=this.props.shape;if(!E&&!O&&!F&&!U&&!B)return null;var q=IIe(E,O,F,U,this.props);if(!q&&!B)return null;var W=qf(this.props,"hidden")?"url(#".concat(A,")"):void 0;return Re.createElement(pi,{className:hi("recharts-reference-area",_)},t.renderRect(B,uG(uG({clipPath:W},yn(this.props,!0)),q)),tl.renderCallByParent(this.props,q))}}])}(Re.Component);aC(sC,"displayName","ReferenceArea");aC(sC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});aC(sC,"renderRect",function(e,t){var r;return Re.isValidElement(e)?r=Re.cloneElement(e,t):$n(e)?r=e(t):r=Re.createElement(FL,NI({},t,{className:"recharts-reference-area-rect"})),r});function bee(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function DIe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return VRe(n,r)}function LIe(e,t,r){var n=r==="width",a=e.x,l=e.y,f=e.width,i=e.height;return t===1?{start:n?a:l,end:n?a+f:l+i}:{start:n?a+f:l+i,end:n?a:l}}function FT(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var l=r();return e*(t-e*l/2-n)>=0&&e*(t+e*l/2-a)<=0}function zIe(e,t){return bee(e,t+1)}function FIe(e,t,r,n,a){for(var l=(n||[]).slice(),f=t.start,i=t.end,_=0,w=1,A=f,E=function(){var U=n==null?void 0:n[_];if(U===void 0)return{v:bee(n,w)};var B=_,q,W=function(){return q===void 0&&(q=r(U,B)),q},Z=U.coordinate,ne=_===0||FT(e,Z,W,A,i);ne||(_=0,A=f,w+=1),ne&&(A=Z+e*(W()/2+a),_+=w)},O;w<=l.length;)if(O=E(),O)return O.v;return[]}function Cw(e){"@babel/helpers - typeof";return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(e)}function dG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ll(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dG(Object(r),!0).forEach(function(n){BIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BIe(e,t,r){return t=VIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VIe(e){var t=UIe(e,"string");return Cw(t)=="symbol"?t:t+""}function UIe(e,t){if(Cw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ie(e,t,r,n,a){for(var l=(n||[]).slice(),f=l.length,i=t.start,_=t.end,w=function(O){var F=l[O],U,B=function(){return U===void 0&&(U=r(F,O)),U};if(O===f-1){var q=e*(F.coordinate+e*B()/2-_);l[O]=F=Ll(Ll({},F),{},{tickCoord:q>0?F.coordinate-q*e:F.coordinate})}else l[O]=F=Ll(Ll({},F),{},{tickCoord:F.coordinate});var W=FT(e,F.tickCoord,B,i,_);W&&(_=F.tickCoord-e*(B()/2+a),l[O]=Ll(Ll({},F),{},{isShow:!0}))},A=f-1;A>=0;A--)w(A);return l}function qIe(e,t,r,n,a,l){var f=(n||[]).slice(),i=f.length,_=t.start,w=t.end;if(l){var A=n[i-1],E=r(A,i-1),O=e*(A.coordinate+e*E/2-w);f[i-1]=A=Ll(Ll({},A),{},{tickCoord:O>0?A.coordinate-O*e:A.coordinate});var F=FT(e,A.tickCoord,function(){return E},_,w);F&&(w=A.tickCoord-e*(E/2+a),f[i-1]=Ll(Ll({},A),{},{isShow:!0}))}for(var U=l?i-1:i,B=function(Z){var ne=f[Z],ae,ee=function(){return ae===void 0&&(ae=r(ne,Z)),ae};if(Z===0){var se=e*(ne.coordinate-e*ee()/2-_);f[Z]=ne=Ll(Ll({},ne),{},{tickCoord:se<0?ne.coordinate-se*e:ne.coordinate})}else f[Z]=ne=Ll(Ll({},ne),{},{tickCoord:ne.coordinate});var ce=FT(e,ne.tickCoord,ee,_,w);ce&&(_=ne.tickCoord+e*(ee()/2+a),f[Z]=Ll(Ll({},ne),{},{isShow:!0}))},q=0;q<U;q++)B(q);return f}function HL(e,t,r){var n=e.tick,a=e.ticks,l=e.viewBox,f=e.minTickGap,i=e.orientation,_=e.interval,w=e.tickFormatter,A=e.unit,E=e.angle;if(!a||!a.length||!n)return[];if(Dr(_)||sp.isSsr)return zIe(a,typeof _=="number"&&Dr(_)?_:0);var O=[],F=i==="top"||i==="bottom"?"width":"height",U=A&&F==="width"?l1(A,{fontSize:t,letterSpacing:r}):{width:0,height:0},B=function(ne,ae){var ee=$n(w)?w(ne.value,ae):ne.value;return F==="width"?DIe(l1(ee,{fontSize:t,letterSpacing:r}),U,E):l1(ee,{fontSize:t,letterSpacing:r})[F]},q=a.length>=2?rl(a[1].coordinate-a[0].coordinate):1,W=LIe(l,q,F);return _==="equidistantPreserveStart"?FIe(q,W,B,a,f):(_==="preserveStart"||_==="preserveStartEnd"?O=qIe(q,W,B,a,f,_==="preserveStartEnd"):O=$Ie(q,W,B,a,f),O.filter(function(Z){return Z.isShow}))}var GIe=["viewBox"],WIe=["viewBox"],HIe=["ticks"];function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function dx(){return dx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dx.apply(this,arguments)}function hG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hG(Object(r),!0).forEach(function(n){KL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dN(e,t){if(e==null)return{};var r=KIe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ZIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,See(n.key),n)}}function YIe(e,t,r){return t&&fG(e.prototype,t),r&&fG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function XIe(e,t,r){return t=BT(t),JIe(e,wee()?Reflect.construct(t,r||[],BT(e).constructor):t.apply(e,r))}function JIe(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QIe(e)}function QIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wee=function(){return!!e})()}function BT(e){return BT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BT(e)}function e3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&II(e,t)}function II(e,t){return II=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},II(e,t)}function KL(e,t,r){return t=See(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function See(e){var t=t3e(e,"string");return Xx(t)=="symbol"?t:t+""}function t3e(e,t){if(Xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var j_=function(e){function t(r){var n;return ZIe(this,t),n=XIe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return e3e(t,e),YIe(t,[{key:"shouldComponentUpdate",value:function(n,a){var l=n.viewBox,f=dN(n,GIe),i=this.props,_=i.viewBox,w=dN(i,WIe);return!yx(l,_)||!yx(f,w)||!yx(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,l=a.x,f=a.y,i=a.width,_=a.height,w=a.orientation,A=a.tickSize,E=a.mirror,O=a.tickMargin,F,U,B,q,W,Z,ne=E?-1:1,ae=n.tickSize||A,ee=Dr(n.tickCoord)?n.tickCoord:n.coordinate;switch(w){case"top":F=U=n.coordinate,q=f+ +!E*_,B=q-ne*ae,Z=B-ne*O,W=ee;break;case"left":B=q=n.coordinate,U=l+ +!E*i,F=U-ne*ae,W=F-ne*O,Z=ee;break;case"right":B=q=n.coordinate,U=l+ +E*i,F=U+ne*ae,W=F+ne*O,Z=ee;break;default:F=U=n.coordinate,q=f+ +E*_,B=q+ne*ae,Z=B+ne*O,W=ee;break}return{line:{x1:F,y1:B,x2:U,y2:q},tick:{x:W,y:Z}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,f;switch(a){case"left":f=l?"start":"end";break;case"right":f=l?"end":"start";break;default:f="middle";break}return f}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,f="end";switch(a){case"left":case"right":f="middle";break;case"top":f=l?"start":"end";break;default:f=l?"end":"start";break}return f}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,l=n.y,f=n.width,i=n.height,_=n.orientation,w=n.mirror,A=n.axisLine,E=rc(rc(rc({},yn(this.props,!1)),yn(A,!1)),{},{fill:"none"});if(_==="top"||_==="bottom"){var O=+(_==="top"&&!w||_==="bottom"&&w);E=rc(rc({},E),{},{x1:a,y1:l+O*i,x2:a+f,y2:l+O*i})}else{var F=+(_==="left"&&!w||_==="right"&&w);E=rc(rc({},E),{},{x1:a+F*f,y1:l,x2:a+F*f,y2:l+i})}return Re.createElement("line",dx({},E,{className:hi("recharts-cartesian-axis-line",wu(A,"className"))}))}},{key:"renderTicks",value:function(n,a,l){var f=this,i=this.props,_=i.tickLine,w=i.stroke,A=i.tick,E=i.tickFormatter,O=i.unit,F=HL(rc(rc({},this.props),{},{ticks:n}),a,l),U=this.getTickTextAnchor(),B=this.getTickVerticalAnchor(),q=yn(this.props,!1),W=yn(A,!1),Z=rc(rc({},q),{},{fill:"none"},yn(_,!1)),ne=F.map(function(ae,ee){var se=f.getTickLineCoord(ae),ce=se.line,ge=se.tick,Te=rc(rc(rc(rc({textAnchor:U,verticalAnchor:B},q),{},{stroke:"none",fill:w},W),ge),{},{index:ee,payload:ae,visibleTicksCount:F.length,tickFormatter:E});return Re.createElement(pi,dx({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},Yf(f.props,ae,ee)),_&&Re.createElement("line",dx({},Z,ce,{className:hi("recharts-cartesian-axis-tick-line",wu(_,"className"))})),A&&t.renderTickItem(A,Te,"".concat($n(E)?E(ae.value,ee):ae.value).concat(O||"")))});return Re.createElement("g",{className:"recharts-cartesian-axis-ticks"},ne)}},{key:"render",value:function(){var n=this,a=this.props,l=a.axisLine,f=a.width,i=a.height,_=a.ticksGenerator,w=a.className,A=a.hide;if(A)return null;var E=this.props,O=E.ticks,F=dN(E,HIe),U=O;return $n(_)&&(U=O&&O.length>0?_(this.props):_(F)),f<=0||i<=0||!U||!U.length?null:Re.createElement(pi,{className:hi("recharts-cartesian-axis",w),ref:function(q){n.layerReference=q}},l&&this.renderAxisLine(),this.renderTicks(U,this.state.fontSize,this.state.letterSpacing),tl.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,l){var f;return Re.isValidElement(n)?f=Re.cloneElement(n,a):$n(n)?f=n(a):f=Re.createElement(zv,dx({},a,{className:"recharts-cartesian-axis-tick-value"}),l),f}}])}(H.Component);KL(j_,"displayName","CartesianAxis");KL(j_,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var r3e=["x1","y1","x2","y2","key"],n3e=["offset"];function Vv(e){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function pG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pG(Object(r),!0).forEach(function(n){i3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i3e(e,t,r){return t=a3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a3e(e){var t=s3e(e,"string");return Vv(t)=="symbol"?t:t+""}function s3e(e,t){if(Vv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sv(){return Sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sv.apply(this,arguments)}function mG(e,t){if(e==null)return{};var r=o3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var l3e=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,l=t.y,f=t.width,i=t.height,_=t.ry;return Re.createElement("rect",{x:a,y:l,ry:_,width:f,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Aee(e,t){var r;if(Re.isValidElement(e))r=Re.cloneElement(e,t);else if($n(e))r=e(t);else{var n=t.x1,a=t.y1,l=t.x2,f=t.y2,i=t.key,_=mG(t,r3e),w=yn(_,!1);w.offset;var A=mG(w,n3e);r=Re.createElement("line",Sv({},A,{x1:n,y1:a,x2:l,y2:f,fill:"none",key:i}))}return r}function c3e(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,l=e.horizontalPoints;if(!a||!l||!l.length)return null;var f=l.map(function(i,_){var w=zl(zl({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(_),index:_});return Aee(a,w)});return Re.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function u3e(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,l=e.verticalPoints;if(!a||!l||!l.length)return null;var f=l.map(function(i,_){var w=zl(zl({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(_),index:_});return Aee(a,w)});return Re.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function d3e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,l=e.width,f=e.height,i=e.horizontalPoints,_=e.horizontal,w=_===void 0?!0:_;if(!w||!t||!t.length)return null;var A=i.map(function(O){return Math.round(O+a-a)}).sort(function(O,F){return O-F});a!==A[0]&&A.unshift(0);var E=A.map(function(O,F){var U=!A[F+1],B=U?a+f-O:A[F+1]-O;if(B<=0)return null;var q=F%t.length;return Re.createElement("rect",{key:"react-".concat(F),y:O,x:n,height:B,width:l,stroke:"none",fill:t[q],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Re.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},E)}function h3e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,l=e.x,f=e.y,i=e.width,_=e.height,w=e.verticalPoints;if(!r||!n||!n.length)return null;var A=w.map(function(O){return Math.round(O+l-l)}).sort(function(O,F){return O-F});l!==A[0]&&A.unshift(0);var E=A.map(function(O,F){var U=!A[F+1],B=U?l+i-O:A[F+1]-O;if(B<=0)return null;var q=F%n.length;return Re.createElement("rect",{key:"react-".concat(F),x:O,y:f,width:B,height:_,stroke:"none",fill:n[q],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Re.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},E)}var f3e=function(t,r){var n=t.xAxis,a=t.width,l=t.height,f=t.offset;return bQ(HL(zl(zl(zl({},j_.defaultProps),n),{},{ticks:im(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),f.left,f.left+f.width,r)},p3e=function(t,r){var n=t.yAxis,a=t.width,l=t.height,f=t.offset;return bQ(HL(zl(zl(zl({},j_.defaultProps),n),{},{ticks:im(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),f.top,f.top+f.height,r)},X0={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Xs(e){var t,r,n,a,l,f,i=$L(),_=qL(),w=tIe(),A=zl(zl({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:X0.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:X0.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:X0.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:X0.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:X0.vertical,verticalFill:(f=e.verticalFill)!==null&&f!==void 0?f:X0.verticalFill,x:Dr(e.x)?e.x:w.left,y:Dr(e.y)?e.y:w.top,width:Dr(e.width)?e.width:w.width,height:Dr(e.height)?e.height:w.height}),E=A.x,O=A.y,F=A.width,U=A.height,B=A.syncWithTicks,q=A.horizontalValues,W=A.verticalValues,Z=JRe(),ne=QRe();if(!Dr(F)||F<=0||!Dr(U)||U<=0||!Dr(E)||E!==+E||!Dr(O)||O!==+O)return null;var ae=A.verticalCoordinatesGenerator||f3e,ee=A.horizontalCoordinatesGenerator||p3e,se=A.horizontalPoints,ce=A.verticalPoints;if((!se||!se.length)&&$n(ee)){var ge=q&&q.length,Te=ee({yAxis:ne?zl(zl({},ne),{},{ticks:ge?q:ne.ticks}):void 0,width:i,height:_,offset:w},ge?!0:B);kh(Array.isArray(Te),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Vv(Te),"]")),Array.isArray(Te)&&(se=Te)}if((!ce||!ce.length)&&$n(ae)){var Ae=W&&W.length,_e=ae({xAxis:Z?zl(zl({},Z),{},{ticks:Ae?W:Z.ticks}):void 0,width:i,height:_,offset:w},Ae?!0:B);kh(Array.isArray(_e),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Vv(_e),"]")),Array.isArray(_e)&&(ce=_e)}return Re.createElement("g",{className:"recharts-cartesian-grid"},Re.createElement(l3e,{fill:A.fill,fillOpacity:A.fillOpacity,x:A.x,y:A.y,width:A.width,height:A.height,ry:A.ry}),Re.createElement(c3e,Sv({},A,{offset:w,horizontalPoints:se,xAxis:Z,yAxis:ne})),Re.createElement(u3e,Sv({},A,{offset:w,verticalPoints:ce,xAxis:Z,yAxis:ne})),Re.createElement(d3e,Sv({},A,{horizontalPoints:se})),Re.createElement(h3e,Sv({},A,{verticalPoints:ce})))}Xs.displayName="CartesianGrid";var m3e=["type","layout","connectNulls","ref"],g3e=["key"];function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function gG(e,t){if(e==null)return{};var r=y3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function y3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function p1(){return p1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p1.apply(this,arguments)}function yG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yG(Object(r),!0).forEach(function(n){Ah(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J0(e){return b3e(e)||_3e(e)||x3e(e)||v3e()}function v3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x3e(e,t){if(e){if(typeof e=="string")return DI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DI(e,t)}}function _3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b3e(e){if(Array.isArray(e))return DI(e)}function DI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pee(n.key),n)}}function S3e(e,t,r){return t&&vG(e.prototype,t),r&&vG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function A3e(e,t,r){return t=VT(t),T3e(e,Tee()?Reflect.construct(t,r||[],VT(e).constructor):t.apply(e,r))}function T3e(e,t){if(t&&(Jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P3e(e)}function P3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tee=function(){return!!e})()}function VT(e){return VT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},VT(e)}function C3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LI(e,t)}function LI(e,t){return LI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LI(e,t)}function Ah(e,t,r){return t=Pee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pee(e){var t=E3e(e,"string");return Jx(t)=="symbol"?t:t+""}function E3e(e,t){if(Jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Qf=function(e){function t(){var r;w3e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=A3e(this,t,[].concat(a)),Ah(r,"state",{isAnimationFinished:!0,totalLength:0}),Ah(r,"generateSimpleStrokeDasharray",function(f,i){return"".concat(i,"px ").concat(f-i,"px")}),Ah(r,"getStrokeDasharray",function(f,i,_){var w=_.reduce(function(W,Z){return W+Z});if(!w)return r.generateSimpleStrokeDasharray(i,f);for(var A=Math.floor(f/w),E=f%w,O=i-f,F=[],U=0,B=0;U<_.length;B+=_[U],++U)if(B+_[U]>E){F=[].concat(J0(_.slice(0,U)),[E-B]);break}var q=F.length%2===0?[0,O]:[O];return[].concat(J0(t.repeat(_,A)),J0(F),q).map(function(W){return"".concat(W,"px")}).join(", ")}),Ah(r,"id",ty("recharts-line-")),Ah(r,"pathRef",function(f){r.mainCurve=f}),Ah(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Ah(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return C3e(t,e),S3e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,f=l.points,i=l.xAxis,_=l.yAxis,w=l.layout,A=l.children,E=Vl(A,M_);if(!E)return null;var O=function(B,q){return{x:B.x,y:B.y,value:B.value,errorVal:Ya(B.payload,q)}},F={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Re.createElement(pi,F,E.map(function(U){return Re.cloneElement(U,{key:"bar-".concat(U.props.dataKey),data:f,xAxis:i,yAxis:_,layout:w,dataPointFormatter:O})}))}},{key:"renderDots",value:function(n,a,l){var f=this.props.isAnimationActive;if(f&&!this.state.isAnimationFinished)return null;var i=this.props,_=i.dot,w=i.points,A=i.dataKey,E=yn(this.props,!1),O=yn(_,!0),F=w.map(function(B,q){var W=hu(hu(hu({key:"dot-".concat(q),r:3},E),O),{},{value:B.value,dataKey:A,cx:B.x,cy:B.y,index:q,payload:B.payload});return t.renderDotItem(_,W)}),U={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return Re.createElement(pi,p1({className:"recharts-line-dots",key:"dots"},U),F)}},{key:"renderCurveStatically",value:function(n,a,l,f){var i=this.props,_=i.type,w=i.layout,A=i.connectNulls;i.ref;var E=gG(i,m3e),O=hu(hu(hu({},yn(E,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(l,")"):null,points:n},f),{},{type:_,layout:w,connectNulls:A});return Re.createElement(Dg,p1({},O,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var l=this,f=this.props,i=f.points,_=f.strokeDasharray,w=f.isAnimationActive,A=f.animationBegin,E=f.animationDuration,O=f.animationEasing,F=f.animationId,U=f.animateNewValues,B=f.width,q=f.height,W=this.state,Z=W.prevPoints,ne=W.totalLength;return Re.createElement(Pu,{begin:A,duration:E,isActive:w,easing:O,from:{t:0},to:{t:1},key:"line-".concat(F),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(ae){var ee=ae.t;if(Z){var se=Z.length/i.length,ce=i.map(function(Ee,ke){var Qe=Math.floor(ke*se);if(Z[Qe]){var Ze=Z[Qe],Ge=Za(Ze.x,Ee.x),Oe=Za(Ze.y,Ee.y);return hu(hu({},Ee),{},{x:Ge(ee),y:Oe(ee)})}if(U){var je=Za(B*2,Ee.x),Le=Za(q/2,Ee.y);return hu(hu({},Ee),{},{x:je(ee),y:Le(ee)})}return hu(hu({},Ee),{},{x:Ee.x,y:Ee.y})});return l.renderCurveStatically(ce,n,a)}var ge=Za(0,ne),Te=ge(ee),Ae;if(_){var _e="".concat(_).split(/[,\s]+/gim).map(function(Ee){return parseFloat(Ee)});Ae=l.getStrokeDasharray(Te,ne,_e)}else Ae=l.generateSimpleStrokeDasharray(ne,Te);return l.renderCurveStatically(i,n,a,{strokeDasharray:Ae})})}},{key:"renderCurve",value:function(n,a){var l=this.props,f=l.points,i=l.isAnimationActive,_=this.state,w=_.prevPoints,A=_.totalLength;return i&&f&&f.length&&(!w&&A>0||!xm(w,f))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(f,n,a)}},{key:"render",value:function(){var n,a=this.props,l=a.hide,f=a.dot,i=a.points,_=a.className,w=a.xAxis,A=a.yAxis,E=a.top,O=a.left,F=a.width,U=a.height,B=a.isAnimationActive,q=a.id;if(l||!i||!i.length)return null;var W=this.state.isAnimationFinished,Z=i.length===1,ne=hi("recharts-line",_),ae=w&&w.allowDataOverflow,ee=A&&A.allowDataOverflow,se=ae||ee,ce=Yn(q)?this.id:q,ge=(n=yn(f,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Te=ge.r,Ae=Te===void 0?3:Te,_e=ge.strokeWidth,Ee=_e===void 0?2:_e,ke=SX(f)?f:{},Qe=ke.clipDot,Ze=Qe===void 0?!0:Qe,Ge=Ae*2+Ee;return Re.createElement(pi,{className:ne},ae||ee?Re.createElement("defs",null,Re.createElement("clipPath",{id:"clipPath-".concat(ce)},Re.createElement("rect",{x:ae?O:O-F/2,y:ee?E:E-U/2,width:ae?F:F*2,height:ee?U:U*2})),!Ze&&Re.createElement("clipPath",{id:"clipPath-dots-".concat(ce)},Re.createElement("rect",{x:O-Ge/2,y:E-Ge/2,width:F+Ge,height:U+Ge}))):null,!Z&&this.renderCurve(se,ce),this.renderErrorBar(se,ce),(Z||f)&&this.renderDots(se,Ze,ce),(!B||W)&&Td.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var l=n.length%2!==0?[].concat(J0(n),[0]):n,f=[],i=0;i<a;++i)f=[].concat(J0(f),J0(l));return f}},{key:"renderDotItem",value:function(n,a){var l;if(Re.isValidElement(n))l=Re.cloneElement(n,a);else if($n(n))l=n(a);else{var f=a.key,i=gG(a,g3e),_=hi("recharts-line-dot",typeof n!="boolean"?n.className:"");l=Re.createElement(s2,p1({key:f},i,{className:_}))}return l}}])}(H.PureComponent);Ah(Qf,"displayName","Line");Ah(Qf,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!sp.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Ah(Qf,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,l=e.yAxisTicks,f=e.dataKey,i=e.bandSize,_=e.displayedData,w=e.offset,A=t.layout,E=_.map(function(O,F){var U=Ya(O,f);return A==="horizontal"?{x:Fx({axis:r,ticks:a,bandSize:i,entry:O,index:F}),y:Yn(U)?null:n.scale(U),value:U,payload:O}:{x:Yn(U)?null:r.scale(U),y:Fx({axis:n,ticks:l,bandSize:i,entry:O,index:F}),value:U,payload:O}});return hu({points:E,layout:A},w)});var k3e=["layout","type","stroke","connectNulls","isRange","ref"],M3e=["key"],Cee;function Qx(e){"@babel/helpers - typeof";return Qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qx(e)}function Eee(e,t){if(e==null)return{};var r=j3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function j3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Av.apply(this,arguments)}function xG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xG(Object(r),!0).forEach(function(n){If(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mee(n.key),n)}}function N3e(e,t,r){return t&&_G(e.prototype,t),r&&_G(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R3e(e,t,r){return t=UT(t),I3e(e,kee()?Reflect.construct(t,r||[],UT(e).constructor):t.apply(e,r))}function I3e(e,t){if(t&&(Qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D3e(e)}function D3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kee=function(){return!!e})()}function UT(e){return UT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},UT(e)}function L3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zI(e,t)}function zI(e,t){return zI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},zI(e,t)}function If(e,t,r){return t=Mee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mee(e){var t=z3e(e,"string");return Qx(t)=="symbol"?t:t+""}function z3e(e,t){if(Qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yu=function(e){function t(){var r;O3e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=R3e(this,t,[].concat(a)),If(r,"state",{isAnimationFinished:!0}),If(r,"id",ty("recharts-area-")),If(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),$n(f)&&f()}),If(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),$n(f)&&f()}),r}return L3e(t,e),N3e(t,[{key:"renderDots",value:function(n,a,l){var f=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(f&&!i)return null;var _=this.props,w=_.dot,A=_.points,E=_.dataKey,O=yn(this.props,!1),F=yn(w,!0),U=A.map(function(q,W){var Z=Tg(Tg(Tg({key:"dot-".concat(W),r:3},O),F),{},{index:W,cx:q.x,cy:q.y,dataKey:E,value:q.value,payload:q.payload,points:A});return t.renderDotItem(w,Z)}),B={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return Re.createElement(pi,Av({className:"recharts-area-dots"},B),U)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,l=a.baseLine,f=a.points,i=a.strokeWidth,_=f[0].x,w=f[f.length-1].x,A=n*Math.abs(_-w),E=Mg(f.map(function(O){return O.y||0}));return Dr(l)&&typeof l=="number"?E=Math.max(l,E):l&&Array.isArray(l)&&l.length&&(E=Math.max(Mg(l.map(function(O){return O.y||0})),E)),Dr(E)?Re.createElement("rect",{x:_<w?_:_-A,y:0,width:A,height:Math.floor(E+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,l=a.baseLine,f=a.points,i=a.strokeWidth,_=f[0].y,w=f[f.length-1].y,A=n*Math.abs(_-w),E=Mg(f.map(function(O){return O.x||0}));return Dr(l)&&typeof l=="number"?E=Math.max(l,E):l&&Array.isArray(l)&&l.length&&(E=Math.max(Mg(l.map(function(O){return O.x||0})),E)),Dr(E)?Re.createElement("rect",{x:0,y:_<w?_:_-A,width:E+(i?parseInt("".concat(i),10):1),height:Math.floor(A)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,l,f){var i=this.props,_=i.layout,w=i.type,A=i.stroke,E=i.connectNulls,O=i.isRange;i.ref;var F=Eee(i,k3e);return Re.createElement(pi,{clipPath:l?"url(#clipPath-".concat(f,")"):null},Re.createElement(Dg,Av({},yn(F,!0),{points:n,connectNulls:E,type:w,baseLine:a,layout:_,stroke:"none",className:"recharts-area-area"})),A!=="none"&&Re.createElement(Dg,Av({},yn(this.props,!1),{className:"recharts-area-curve",layout:_,type:w,connectNulls:E,fill:"none",points:n})),A!=="none"&&O&&Re.createElement(Dg,Av({},yn(this.props,!1),{className:"recharts-area-curve",layout:_,type:w,connectNulls:E,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var l=this,f=this.props,i=f.points,_=f.baseLine,w=f.isAnimationActive,A=f.animationBegin,E=f.animationDuration,O=f.animationEasing,F=f.animationId,U=this.state,B=U.prevPoints,q=U.prevBaseLine;return Re.createElement(Pu,{begin:A,duration:E,isActive:w,easing:O,from:{t:0},to:{t:1},key:"area-".concat(F),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(W){var Z=W.t;if(B){var ne=B.length/i.length,ae=i.map(function(ge,Te){var Ae=Math.floor(Te*ne);if(B[Ae]){var _e=B[Ae],Ee=Za(_e.x,ge.x),ke=Za(_e.y,ge.y);return Tg(Tg({},ge),{},{x:Ee(Z),y:ke(Z)})}return ge}),ee;if(Dr(_)&&typeof _=="number"){var se=Za(q,_);ee=se(Z)}else if(Yn(_)||T_(_)){var ce=Za(q,0);ee=ce(Z)}else ee=_.map(function(ge,Te){var Ae=Math.floor(Te*ne);if(q[Ae]){var _e=q[Ae],Ee=Za(_e.x,ge.x),ke=Za(_e.y,ge.y);return Tg(Tg({},ge),{},{x:Ee(Z),y:ke(Z)})}return ge});return l.renderAreaStatically(ae,ee,n,a)}return Re.createElement(pi,null,Re.createElement("defs",null,Re.createElement("clipPath",{id:"animationClipPath-".concat(a)},l.renderClipRect(Z))),Re.createElement(pi,{clipPath:"url(#animationClipPath-".concat(a,")")},l.renderAreaStatically(i,_,n,a)))})}},{key:"renderArea",value:function(n,a){var l=this.props,f=l.points,i=l.baseLine,_=l.isAnimationActive,w=this.state,A=w.prevPoints,E=w.prevBaseLine,O=w.totalLength;return _&&f&&f.length&&(!A&&O>0||!xm(A,f)||!xm(E,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(f,i,n,a)}},{key:"render",value:function(){var n,a=this.props,l=a.hide,f=a.dot,i=a.points,_=a.className,w=a.top,A=a.left,E=a.xAxis,O=a.yAxis,F=a.width,U=a.height,B=a.isAnimationActive,q=a.id;if(l||!i||!i.length)return null;var W=this.state.isAnimationFinished,Z=i.length===1,ne=hi("recharts-area",_),ae=E&&E.allowDataOverflow,ee=O&&O.allowDataOverflow,se=ae||ee,ce=Yn(q)?this.id:q,ge=(n=yn(f,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Te=ge.r,Ae=Te===void 0?3:Te,_e=ge.strokeWidth,Ee=_e===void 0?2:_e,ke=SX(f)?f:{},Qe=ke.clipDot,Ze=Qe===void 0?!0:Qe,Ge=Ae*2+Ee;return Re.createElement(pi,{className:ne},ae||ee?Re.createElement("defs",null,Re.createElement("clipPath",{id:"clipPath-".concat(ce)},Re.createElement("rect",{x:ae?A:A-F/2,y:ee?w:w-U/2,width:ae?F:F*2,height:ee?U:U*2})),!Ze&&Re.createElement("clipPath",{id:"clipPath-dots-".concat(ce)},Re.createElement("rect",{x:A-Ge/2,y:w-Ge/2,width:F+Ge,height:U+Ge}))):null,Z?null:this.renderArea(se,ce),(f||Z)&&this.renderDots(se,Ze,ce),(!B||W)&&Td.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(H.PureComponent);Cee=yu;If(yu,"displayName","Area");If(yu,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!sp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});If(yu,"getBaseValue",function(e,t,r,n){var a=e.layout,l=e.baseValue,f=t.props.baseValue,i=f??l;if(Dr(i)&&typeof i=="number")return i;var _=a==="horizontal"?n:r,w=_.scale.domain();if(_.type==="number"){var A=Math.max(w[0],w[1]),E=Math.min(w[0],w[1]);return i==="dataMin"?E:i==="dataMax"||A<0?A:Math.max(Math.min(w[0],w[1]),0)}return i==="dataMin"?w[0]:i==="dataMax"?w[1]:w[0]});If(yu,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,l=e.xAxisTicks,f=e.yAxisTicks,i=e.bandSize,_=e.dataKey,w=e.stackedData,A=e.dataStartIndex,E=e.displayedData,O=e.offset,F=t.layout,U=w&&w.length,B=Cee.getBaseValue(t,r,n,a),q=F==="horizontal",W=!1,Z=E.map(function(ae,ee){var se;U?se=w[A+ee]:(se=Ya(ae,_),Array.isArray(se)?W=!0:se=[B,se]);var ce=se[1]==null||U&&Ya(ae,_)==null;return q?{x:Fx({axis:n,ticks:l,bandSize:i,entry:ae,index:ee}),y:ce?null:a.scale(se[1]),value:se,payload:ae}:{x:ce?null:n.scale(se[1]),y:Fx({axis:a,ticks:f,bandSize:i,entry:ae,index:ee}),value:se,payload:ae}}),ne;return U||W?ne=Z.map(function(ae){var ee=Array.isArray(ae.value)?ae.value[0]:null;return q?{x:ae.x,y:ee!=null&&ae.y!=null?a.scale(ee):null}:{x:ee!=null?n.scale(ee):null,y:ae.y}}):ne=q?a.scale(B):n.scale(B),Tg({points:Z,baseLine:ne,layout:F,isRange:W},O)});If(yu,"renderDotItem",function(e,t){var r;if(Re.isValidElement(e))r=Re.cloneElement(e,t);else if($n(e))r=e(t);else{var n=hi("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,l=Eee(t,M3e);r=Re.createElement(s2,Av({},l,{key:a,className:n}))}return r});function e_(e){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function F3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nee(n.key),n)}}function V3e(e,t,r){return t&&B3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function U3e(e,t,r){return t=$T(t),$3e(e,jee()?Reflect.construct(t,r||[],$T(e).constructor):t.apply(e,r))}function $3e(e,t){if(t&&(e_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q3e(e)}function q3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jee=function(){return!!e})()}function $T(e){return $T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$T(e)}function G3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FI(e,t)}function FI(e,t){return FI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},FI(e,t)}function Oee(e,t,r){return t=Nee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nee(e){var t=W3e(e,"string");return e_(t)=="symbol"?t:t+""}function W3e(e,t){if(e_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(e_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var d2=function(e){function t(){return F3e(this,t),U3e(this,t,arguments)}return G3e(t,e),V3e(t,[{key:"render",value:function(){return null}}])}(Re.Component);Oee(d2,"displayName","ZAxis");Oee(d2,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var H3e=["option","isActive"];function m1(){return m1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m1.apply(this,arguments)}function K3e(e,t){if(e==null)return{};var r=Z3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Z3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Y3e(e){var t=e.option,r=e.isActive,n=K3e(e,H3e);return typeof t=="string"?Re.createElement(bw,m1({option:Re.createElement(zP,m1({type:t},n)),isActive:r,shapeType:"symbols"},n)):Re.createElement(bw,m1({option:t,isActive:r,shapeType:"symbols"},n))}function t_(e){"@babel/helpers - typeof";return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function g1(){return g1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g1.apply(this,arguments)}function bG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bG(Object(r),!0).forEach(function(n){Og(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iee(n.key),n)}}function J3e(e,t,r){return t&&wG(e.prototype,t),r&&wG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q3e(e,t,r){return t=qT(t),eDe(e,Ree()?Reflect.construct(t,r||[],qT(e).constructor):t.apply(e,r))}function eDe(e,t){if(t&&(t_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tDe(e)}function tDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ree(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ree=function(){return!!e})()}function qT(e){return qT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qT(e)}function rDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BI(e,t)}function BI(e,t){return BI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},BI(e,t)}function Og(e,t,r){return t=Iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iee(e){var t=nDe(e,"string");return t_(t)=="symbol"?t:t+""}function nDe(e,t){if(t_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(t_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var O_=function(e){function t(){var r;X3e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=Q3e(this,t,[].concat(a)),Og(r,"state",{isAnimationFinished:!1}),Og(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),Og(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),Og(r,"id",ty("recharts-scatter-")),r}return rDe(t,e),J3e(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,l=this.props,f=l.shape,i=l.activeShape,_=l.activeIndex,w=yn(this.props,!1);return n.map(function(A,E){var O=_===E,F=O?i:f,U=yd(yd({},w),A);return Re.createElement(pi,g1({className:"recharts-scatter-symbol",key:"symbol-".concat(A==null?void 0:A.cx,"-").concat(A==null?void 0:A.cy,"-").concat(A==null?void 0:A.size,"-").concat(E)},Yf(a.props,A,E),{role:"img"}),Re.createElement(Y3e,g1({option:F,isActive:O,key:"symbol-".concat(E)},U)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,l=a.points,f=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,E=this.state.prevPoints;return Re.createElement(Pu,{begin:i,duration:_,isActive:f,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(O){var F=O.t,U=l.map(function(B,q){var W=E&&E[q];if(W){var Z=Za(W.cx,B.cx),ne=Za(W.cy,B.cy),ae=Za(W.size,B.size);return yd(yd({},B),{},{cx:Z(F),cy:ne(F),size:ae(F)})}var ee=Za(0,B.size);return yd(yd({},B),{},{size:ee(F)})});return Re.createElement(pi,null,n.renderSymbolsStatically(U))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,l=n.isAnimationActive,f=this.state.prevPoints;return l&&a&&a.length&&(!f||!xm(f,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,l=a.points,f=a.xAxis,i=a.yAxis,_=a.children,w=Vl(_,M_);return w?w.map(function(A,E){var O=A.props,F=O.direction,U=O.dataKey;return Re.cloneElement(A,{key:"".concat(F,"-").concat(U,"-").concat(l[E]),data:l,xAxis:f,yAxis:i,layout:F==="x"?"vertical":"horizontal",dataPointFormatter:function(q,W){return{x:q.cx,y:q.cy,value:F==="x"?+q.node.x:+q.node.y,errorVal:Ya(q,W)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,l=n.line,f=n.lineType,i=n.lineJointType,_=yn(this.props,!1),w=yn(l,!1),A,E;if(f==="joint")A=a.map(function(ne){return{x:ne.cx,y:ne.cy}});else if(f==="fitting"){var O=U1e(a),F=O.xmin,U=O.xmax,B=O.a,q=O.b,W=function(ae){return B*ae+q};A=[{x:F,y:W(F)},{x:U,y:W(U)}]}var Z=yd(yd(yd({},_),{},{fill:"none",stroke:_&&_.fill},w),{},{points:A});return Re.isValidElement(l)?E=Re.cloneElement(l,Z):$n(l)?E=l(Z):E=Re.createElement(Dg,g1({},Z,{type:i})),Re.createElement(pi,{className:"recharts-scatter-line",key:"recharts-scatter-line"},E)}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.points,f=n.line,i=n.className,_=n.xAxis,w=n.yAxis,A=n.left,E=n.top,O=n.width,F=n.height,U=n.id,B=n.isAnimationActive;if(a||!l||!l.length)return null;var q=this.state.isAnimationFinished,W=hi("recharts-scatter",i),Z=_&&_.allowDataOverflow,ne=w&&w.allowDataOverflow,ae=Z||ne,ee=Yn(U)?this.id:U;return Re.createElement(pi,{className:W,clipPath:ae?"url(#clipPath-".concat(ee,")"):null},Z||ne?Re.createElement("defs",null,Re.createElement("clipPath",{id:"clipPath-".concat(ee)},Re.createElement("rect",{x:Z?A:A-O/2,y:ne?E:E-F/2,width:Z?O:O*2,height:ne?F:F*2}))):null,f&&this.renderLine(),this.renderErrorBar(),Re.createElement(pi,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!B||q)&&Td.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(H.PureComponent);Og(O_,"displayName","Scatter");Og(O_,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!sp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Og(O_,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,l=e.displayedData,f=e.xAxisTicks,i=e.yAxisTicks,_=e.offset,w=a.props.tooltipType,A=Vl(a.props.children,Xf),E=Yn(t.dataKey)?a.props.dataKey:t.dataKey,O=Yn(r.dataKey)?a.props.dataKey:r.dataKey,F=n&&n.dataKey,U=n?n.range:d2.defaultProps.range,B=U&&U[0],q=t.scale.bandwidth?t.scale.bandwidth():0,W=r.scale.bandwidth?r.scale.bandwidth():0,Z=l.map(function(ne,ae){var ee=Ya(ne,E),se=Ya(ne,O),ce=!Yn(F)&&Ya(ne,F)||"-",ge=[{name:Yn(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:ee,payload:ne,dataKey:E,type:w},{name:Yn(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:se,payload:ne,dataKey:O,type:w}];ce!=="-"&&ge.push({name:n.name||n.dataKey,unit:n.unit||"",value:ce,payload:ne,dataKey:F,type:w});var Te=Fx({axis:t,ticks:f,bandSize:q,entry:ne,index:ae,dataKey:E}),Ae=Fx({axis:r,ticks:i,bandSize:W,entry:ne,index:ae,dataKey:O}),_e=ce!=="-"?n.scale(ce):B,Ee=Math.sqrt(Math.max(_e,0)/Math.PI);return yd(yd({},ne),{},{cx:Te,cy:Ae,x:Te-Ee,y:Ae-Ee,xAxis:t,yAxis:r,zAxis:n,width:2*Ee,height:2*Ee,size:_e,node:{x:ee,y:se,z:ce},tooltipPayload:ge,tooltipPosition:{x:Te,y:Ae},payload:ne},A&&A[ae]&&A[ae].props)});return yd({points:Z},_)});function r_(e){"@babel/helpers - typeof";return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r_(e)}function iDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zee(n.key),n)}}function sDe(e,t,r){return t&&aDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oDe(e,t,r){return t=GT(t),lDe(e,Dee()?Reflect.construct(t,r||[],GT(e).constructor):t.apply(e,r))}function lDe(e,t){if(t&&(r_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cDe(e)}function cDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dee=function(){return!!e})()}function GT(e){return GT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GT(e)}function uDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&VI(e,t)}function VI(e,t){return VI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},VI(e,t)}function Lee(e,t,r){return t=zee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zee(e){var t=dDe(e,"string");return r_(t)=="symbol"?t:t+""}function dDe(e,t){if(r_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(r_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function UI(){return UI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UI.apply(this,arguments)}function hDe(e){var t=e.xAxisId,r=$L(),n=qL(),a=fee(t);return a==null?null:Re.createElement(j_,UI({},a,{className:hi("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(f){return im(f,!0)}}))}var La=function(e){function t(){return iDe(this,t),oDe(this,t,arguments)}return uDe(t,e),sDe(t,[{key:"render",value:function(){return Re.createElement(hDe,this.props)}}])}(Re.Component);Lee(La,"displayName","XAxis");Lee(La,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function n_(e){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}function fDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vee(n.key),n)}}function mDe(e,t,r){return t&&pDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gDe(e,t,r){return t=WT(t),yDe(e,Fee()?Reflect.construct(t,r||[],WT(e).constructor):t.apply(e,r))}function yDe(e,t){if(t&&(n_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vDe(e)}function vDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fee=function(){return!!e})()}function WT(e){return WT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WT(e)}function xDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$I(e,t)}function $I(e,t){return $I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$I(e,t)}function Bee(e,t,r){return t=Vee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vee(e){var t=_De(e,"string");return n_(t)=="symbol"?t:t+""}function _De(e,t){if(n_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(n_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function qI(){return qI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qI.apply(this,arguments)}var bDe=function(t){var r=t.yAxisId,n=$L(),a=qL(),l=pee(r);return l==null?null:Re.createElement(j_,qI({},l,{className:hi("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return im(i,!0)}}))},za=function(e){function t(){return fDe(this,t),gDe(this,t,arguments)}return xDe(t,e),mDe(t,[{key:"render",value:function(){return Re.createElement(bDe,this.props)}}])}(Re.Component);Bee(za,"displayName","YAxis");Bee(za,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function SG(e){return TDe(e)||ADe(e)||SDe(e)||wDe()}function wDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SDe(e,t){if(e){if(typeof e=="string")return GI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GI(e,t)}}function ADe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TDe(e){if(Array.isArray(e))return GI(e)}function GI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var WI=function(t,r,n,a,l){var f=Vl(t,WL),i=Vl(t,iC),_=[].concat(SG(f),SG(i)),w=Vl(t,sC),A="".concat(a,"Id"),E=a[0],O=r;if(_.length&&(O=_.reduce(function(B,q){if(q.props[A]===n&&qf(q.props,"extendDomain")&&Dr(q.props[E])){var W=q.props[E];return[Math.min(B[0],W),Math.max(B[1],W)]}return B},O)),w.length){var F="".concat(E,"1"),U="".concat(E,"2");O=w.reduce(function(B,q){if(q.props[A]===n&&qf(q.props,"extendDomain")&&Dr(q.props[F])&&Dr(q.props[U])){var W=q.props[F],Z=q.props[U];return[Math.min(B[0],W,Z),Math.max(B[1],W,Z)]}return B},O)}return l&&l.length&&(O=l.reduce(function(B,q){return Dr(q)?[Math.min(B[0],q),Math.max(B[1],q)]:B},O)),O},hN={exports:{}},AG;function PDe(){return AG||(AG=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(_,w,A){this.fn=_,this.context=w,this.once=A||!1}function l(_,w,A,E,O){if(typeof A!="function")throw new TypeError("The listener must be a function");var F=new a(A,E||_,O),U=r?r+w:w;return _._events[U]?_._events[U].fn?_._events[U]=[_._events[U],F]:_._events[U].push(F):(_._events[U]=F,_._eventsCount++),_}function f(_,w){--_._eventsCount===0?_._events=new n:delete _._events[w]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var w=[],A,E;if(this._eventsCount===0)return w;for(E in A=this._events)t.call(A,E)&&w.push(r?E.slice(1):E);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(A)):w},i.prototype.listeners=function(w){var A=r?r+w:w,E=this._events[A];if(!E)return[];if(E.fn)return[E.fn];for(var O=0,F=E.length,U=new Array(F);O<F;O++)U[O]=E[O].fn;return U},i.prototype.listenerCount=function(w){var A=r?r+w:w,E=this._events[A];return E?E.fn?1:E.length:0},i.prototype.emit=function(w,A,E,O,F,U){var B=r?r+w:w;if(!this._events[B])return!1;var q=this._events[B],W=arguments.length,Z,ne;if(q.fn){switch(q.once&&this.removeListener(w,q.fn,void 0,!0),W){case 1:return q.fn.call(q.context),!0;case 2:return q.fn.call(q.context,A),!0;case 3:return q.fn.call(q.context,A,E),!0;case 4:return q.fn.call(q.context,A,E,O),!0;case 5:return q.fn.call(q.context,A,E,O,F),!0;case 6:return q.fn.call(q.context,A,E,O,F,U),!0}for(ne=1,Z=new Array(W-1);ne<W;ne++)Z[ne-1]=arguments[ne];q.fn.apply(q.context,Z)}else{var ae=q.length,ee;for(ne=0;ne<ae;ne++)switch(q[ne].once&&this.removeListener(w,q[ne].fn,void 0,!0),W){case 1:q[ne].fn.call(q[ne].context);break;case 2:q[ne].fn.call(q[ne].context,A);break;case 3:q[ne].fn.call(q[ne].context,A,E);break;case 4:q[ne].fn.call(q[ne].context,A,E,O);break;default:if(!Z)for(ee=1,Z=new Array(W-1);ee<W;ee++)Z[ee-1]=arguments[ee];q[ne].fn.apply(q[ne].context,Z)}}return!0},i.prototype.on=function(w,A,E){return l(this,w,A,E,!1)},i.prototype.once=function(w,A,E){return l(this,w,A,E,!0)},i.prototype.removeListener=function(w,A,E,O){var F=r?r+w:w;if(!this._events[F])return this;if(!A)return f(this,F),this;var U=this._events[F];if(U.fn)U.fn===A&&(!O||U.once)&&(!E||U.context===E)&&f(this,F);else{for(var B=0,q=[],W=U.length;B<W;B++)(U[B].fn!==A||O&&!U[B].once||E&&U[B].context!==E)&&q.push(U[B]);q.length?this._events[F]=q.length===1?q[0]:q:f(this,F)}return this},i.prototype.removeAllListeners=function(w){var A;return w?(A=r?r+w:w,this._events[A]&&f(this,A)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i}(hN)),hN.exports}var CDe=PDe();const EDe=oa(CDe);var fN=new EDe,pN="recharts.syncMouseEvents";function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function kDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uee(n.key),n)}}function jDe(e,t,r){return t&&MDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function mN(e,t,r){return t=Uee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uee(e){var t=ODe(e,"string");return Ew(t)=="symbol"?t:t+""}function ODe(e,t){if(Ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var NDe=function(){function e(){kDe(this,e),mN(this,"activeIndex",0),mN(this,"coordinateList",[]),mN(this,"layout","horizontal")}return jDe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,l=a===void 0?null:a,f=r.container,i=f===void 0?null:f,_=r.layout,w=_===void 0?null:_,A=r.offset,E=A===void 0?null:A,O=r.mouseHandlerCallback,F=O===void 0?null:O;this.coordinateList=(n=l??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=w??this.layout,this.offset=E??this.offset,this.mouseHandlerCallback=F??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),l=a.x,f=a.y,i=a.height,_=this.coordinateList[this.activeIndex].coordinate,w=((r=window)===null||r===void 0?void 0:r.scrollX)||0,A=((n=window)===null||n===void 0?void 0:n.scrollY)||0,E=l+_+w,O=f+this.offset.top+i/2+A;this.mouseHandlerCallback({pageX:E,pageY:O})}}}])}();function RDe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Dr(n)&&Dr(a))return!0}return!1}function IDe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function $ee(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,l=e.endAngle,f=Ba(t,r,n,a),i=Ba(t,r,n,l);return{points:[f,i],cx:t,cy:r,radius:n,startAngle:a,endAngle:l}}function DDe(e,t,r){var n,a,l,f;if(e==="horizontal")n=t.x,l=n,a=r.top,f=r.top+r.height;else if(e==="vertical")a=t.y,f=a,n=r.left,l=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,_=t.cy,w=t.innerRadius,A=t.outerRadius,E=t.angle,O=Ba(i,_,w,E),F=Ba(i,_,A,E);n=O.x,a=O.y,l=F.x,f=F.y}else return $ee(t);return[{x:n,y:a},{x:l,y:f}]}function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function TG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $S(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TG(Object(r),!0).forEach(function(n){LDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LDe(e,t,r){return t=zDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zDe(e){var t=FDe(e,"string");return kw(t)=="symbol"?t:t+""}function FDe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BDe(e){var t,r,n=e.element,a=e.tooltipEventType,l=e.isActive,f=e.activeCoordinate,i=e.activePayload,_=e.offset,w=e.activeTooltipIndex,A=e.tooltipAxisBandSize,E=e.layout,O=e.chartName,F=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!F||!l||!f||O!=="ScatterChart"&&a!=="axis")return null;var U,B=Dg;if(O==="ScatterChart")U=f,B=vOe;else if(O==="BarChart")U=IDe(E,f,_,A),B=FL;else if(E==="radial"){var q=$ee(f),W=q.cx,Z=q.cy,ne=q.radius,ae=q.startAngle,ee=q.endAngle;U={cx:W,cy:Z,startAngle:ae,endAngle:ee,innerRadius:ne,outerRadius:ne},B=IQ}else U={points:DDe(E,f,_)},B=Dg;var se=$S($S($S($S({stroke:"#ccc",pointerEvents:"none"},_),U),yn(F,!1)),{},{payload:i,payloadIndex:w,className:hi("recharts-tooltip-cursor",F.className)});return H.isValidElement(F)?H.cloneElement(F,se):H.createElement(B,se)}var VDe=["item"],UDe=["children","className","width","height","style","compact","title","desc"];function i_(e){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function hx(){return hx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hx.apply(this,arguments)}function PG(e,t){return GDe(e)||qDe(e,t)||Gee(e,t)||$De()}function $De(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,f,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function GDe(e){if(Array.isArray(e))return e}function CG(e,t){if(e==null)return{};var r=WDe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function WDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function HDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wee(n.key),n)}}function ZDe(e,t,r){return t&&KDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function YDe(e,t,r){return t=HT(t),XDe(e,qee()?Reflect.construct(t,r||[],HT(e).constructor):t.apply(e,r))}function XDe(e,t){if(t&&(i_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JDe(e)}function JDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qee=function(){return!!e})()}function HT(e){return HT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},HT(e)}function QDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},HI(e,t)}function a_(e){return rLe(e)||tLe(e)||Gee(e)||eLe()}function eLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gee(e,t){if(e){if(typeof e=="string")return KI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KI(e,t)}}function tLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function rLe(e){if(Array.isArray(e))return KI(e)}function KI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function EG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EG(Object(r),!0).forEach(function(n){ti(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ti(e,t,r){return t=Wee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wee(e){var t=nLe(e,"string");return i_(t)=="symbol"?t:t+""}function nLe(e,t){if(i_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(i_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iLe={xAxis:["bottom","top"],yAxis:["left","right"]},aLe={width:"100%",height:"100%"},Hee={x:0,y:0};function qS(e){return e}var sLe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},oLe=function(t,r,n,a){var l=r.find(function(A){return A&&A.index===n});if(l){if(t==="horizontal")return{x:l.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:l.coordinate};if(t==="centric"){var f=l.coordinate,i=a.radius;return dr(dr(dr({},a),Ba(a.cx,a.cy,i,f)),{},{angle:f,radius:i})}var _=l.coordinate,w=a.angle;return dr(dr(dr({},a),Ba(a.cx,a.cy,_,w)),{},{angle:w,radius:_})}return Hee},oC=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,l=r.dataEndIndex,f=(n??[]).reduce(function(i,_){var w=_.props.data;return w&&w.length?[].concat(a_(i),a_(w)):i},[]);return f.length>0?f:t&&t.length&&Dr(a)&&Dr(l)?t.slice(a,l+1):[]};function Kee(e){return e==="number"?[0,"auto"]:void 0}var ZI=function(t,r,n,a){var l=t.graphicalItems,f=t.tooltipAxis,i=oC(r,t);return n<0||!l||!l.length||n>=i.length?null:l.reduce(function(_,w){var A,E=(A=w.props.data)!==null&&A!==void 0?A:r;E&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(E=E.slice(t.dataStartIndex,t.dataEndIndex+1));var O;if(f.dataKey&&!f.allowDuplicatedCategory){var F=E===void 0?i:E;O=GA(F,f.dataKey,a)}else O=E&&E[n]||i[n];return O?[].concat(a_(_),[zL(w,O)]):_},[])},kG=function(t,r,n,a){var l=a||{x:t.chartX,y:t.chartY},f=sLe(l,n),i=t.orderedTooltipTicks,_=t.tooltipAxis,w=t.tooltipTicks,A=HEe(f,i,w,_);if(A>=0&&w){var E=w[A]&&w[A].value,O=ZI(t,r,A,E),F=oLe(n,i,A,l);return{activeTooltipIndex:A,activeLabel:E,activePayload:O,activeCoordinate:F}}return null},lLe=function(t,r){var n=r.axes,a=r.graphicalItems,l=r.axisType,f=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,w=r.dataEndIndex,A=t.layout,E=t.children,O=t.stackOffset,F=_Q(A,l);return n.reduce(function(U,B){var q,W=B.type.defaultProps!==void 0?dr(dr({},B.type.defaultProps),B.props):B.props,Z=W.type,ne=W.dataKey,ae=W.allowDataOverflow,ee=W.allowDuplicatedCategory,se=W.scale,ce=W.ticks,ge=W.includeHidden,Te=W[f];if(U[Te])return U;var Ae=oC(t.data,{graphicalItems:a.filter(function(ht){var rt,Qt=f in ht.props?ht.props[f]:(rt=ht.type.defaultProps)===null||rt===void 0?void 0:rt[f];return Qt===Te}),dataStartIndex:_,dataEndIndex:w}),_e=Ae.length,Ee,ke,Qe;RDe(W.domain,ae,Z)&&(Ee=iI(W.domain,null,ae),F&&(Z==="number"||se!=="auto")&&(Qe=u1(Ae,ne,"category")));var Ze=Kee(Z);if(!Ee||Ee.length===0){var Ge,Oe=(Ge=W.domain)!==null&&Ge!==void 0?Ge:Ze;if(ne){if(Ee=u1(Ae,ne,Z),Z==="category"&&F){var je=V1e(Ee);ee&&je?(ke=Ee,Ee=jT(0,_e)):ee||(Ee=xq(Oe,Ee,B).reduce(function(ht,rt){return ht.indexOf(rt)>=0?ht:[].concat(a_(ht),[rt])},[]))}else if(Z==="category")ee?Ee=Ee.filter(function(ht){return ht!==""&&!Yn(ht)}):Ee=xq(Oe,Ee,B).reduce(function(ht,rt){return ht.indexOf(rt)>=0||rt===""||Yn(rt)?ht:[].concat(a_(ht),[rt])},[]);else if(Z==="number"){var Le=JEe(Ae,a.filter(function(ht){var rt,Qt,Cr=f in ht.props?ht.props[f]:(rt=ht.type.defaultProps)===null||rt===void 0?void 0:rt[f],vr="hide"in ht.props?ht.props.hide:(Qt=ht.type.defaultProps)===null||Qt===void 0?void 0:Qt.hide;return Cr===Te&&(ge||!vr)}),ne,l,A);Le&&(Ee=Le)}F&&(Z==="number"||se!=="auto")&&(Qe=u1(Ae,ne,"category"))}else F?Ee=jT(0,_e):i&&i[Te]&&i[Te].hasStack&&Z==="number"?Ee=O==="expand"?[0,1]:EQ(i[Te].stackGroups,_,w):Ee=xQ(Ae,a.filter(function(ht){var rt=f in ht.props?ht.props[f]:ht.type.defaultProps[f],Qt="hide"in ht.props?ht.props.hide:ht.type.defaultProps.hide;return rt===Te&&(ge||!Qt)}),Z,A,!0);if(Z==="number")Ee=WI(E,Ee,Te,l,ce),Oe&&(Ee=iI(Oe,Ee,ae));else if(Z==="category"&&Oe){var ut=Oe,ze=Ee.every(function(ht){return ut.indexOf(ht)>=0});ze&&(Ee=ut)}}return dr(dr({},U),{},ti({},Te,dr(dr({},W),{},{axisType:l,domain:Ee,categoricalDomain:Qe,duplicateDomain:ke,originalDomain:(q=W.domain)!==null&&q!==void 0?q:Ze,isCategorical:F,layout:A})))},{})},cLe=function(t,r){var n=r.graphicalItems,a=r.Axis,l=r.axisType,f=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,w=r.dataEndIndex,A=t.layout,E=t.children,O=oC(t.data,{graphicalItems:n,dataStartIndex:_,dataEndIndex:w}),F=O.length,U=_Q(A,l),B=-1;return n.reduce(function(q,W){var Z=W.type.defaultProps!==void 0?dr(dr({},W.type.defaultProps),W.props):W.props,ne=Z[f],ae=Kee("number");if(!q[ne]){B++;var ee;return U?ee=jT(0,F):i&&i[ne]&&i[ne].hasStack?(ee=EQ(i[ne].stackGroups,_,w),ee=WI(E,ee,ne,l)):(ee=iI(ae,xQ(O,n.filter(function(se){var ce,ge,Te=f in se.props?se.props[f]:(ce=se.type.defaultProps)===null||ce===void 0?void 0:ce[f],Ae="hide"in se.props?se.props.hide:(ge=se.type.defaultProps)===null||ge===void 0?void 0:ge.hide;return Te===ne&&!Ae}),"number",A),a.defaultProps.allowDataOverflow),ee=WI(E,ee,ne,l)),dr(dr({},q),{},ti({},ne,dr(dr({axisType:l},a.defaultProps),{},{hide:!0,orientation:wu(iLe,"".concat(l,".").concat(B%2),null),domain:ee,originalDomain:ae,isCategorical:U,layout:A})))}return q},{})},uLe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,l=r.AxisComp,f=r.graphicalItems,i=r.stackGroups,_=r.dataStartIndex,w=r.dataEndIndex,A=t.children,E="".concat(a,"Id"),O=Vl(A,l),F={};return O&&O.length?F=lLe(t,{axes:O,graphicalItems:f,axisType:a,axisIdKey:E,stackGroups:i,dataStartIndex:_,dataEndIndex:w}):f&&f.length&&(F=cLe(t,{Axis:l,graphicalItems:f,axisType:a,axisIdKey:E,stackGroups:i,dataStartIndex:_,dataEndIndex:w})),F},dLe=function(t){var r=kg(t),n=im(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:dL(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:yT(r,n)}},MG=function(t){var r=t.children,n=t.defaultShowTooltip,a=pu(r,Wx),l=0,f=0;return t.data&&t.data.length!==0&&(f=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(l=a.props.startIndex),a.props.endIndex>=0&&(f=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:f,activeTooltipIndex:-1,isTooltipActive:!!n}},hLe=function(t){return!t||!t.length?!1:t.some(function(r){var n=lm(r&&r.type);return n&&n.indexOf("Bar")>=0})},jG=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},fLe=function(t,r){var n=t.props,a=t.graphicalItems,l=t.xAxisMap,f=l===void 0?{}:l,i=t.yAxisMap,_=i===void 0?{}:i,w=n.width,A=n.height,E=n.children,O=n.margin||{},F=pu(E,Wx),U=pu(E,Uf),B=Object.keys(_).reduce(function(ee,se){var ce=_[se],ge=ce.orientation;return!ce.mirror&&!ce.hide?dr(dr({},ee),{},ti({},ge,ee[ge]+ce.width)):ee},{left:O.left||0,right:O.right||0}),q=Object.keys(f).reduce(function(ee,se){var ce=f[se],ge=ce.orientation;return!ce.mirror&&!ce.hide?dr(dr({},ee),{},ti({},ge,wu(ee,"".concat(ge))+ce.height)):ee},{top:O.top||0,bottom:O.bottom||0}),W=dr(dr({},q),B),Z=W.bottom;F&&(W.bottom+=F.props.height||Wx.defaultProps.height),U&&r&&(W=YEe(W,a,n,r));var ne=w-W.left-W.right,ae=A-W.top-W.bottom;return dr(dr({brushBottom:Z},W),{},{width:Math.max(ne,0),height:Math.max(ae,0)})},pLe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},t0=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,l=a===void 0?"axis":a,f=t.validateTooltipEventTypes,i=f===void 0?["axis"]:f,_=t.axisComponents,w=t.legendContent,A=t.formatAxisMap,E=t.defaultProps,O=function(W,Z){var ne=Z.graphicalItems,ae=Z.stackGroups,ee=Z.offset,se=Z.updateId,ce=Z.dataStartIndex,ge=Z.dataEndIndex,Te=W.barSize,Ae=W.layout,_e=W.barGap,Ee=W.barCategoryGap,ke=W.maxBarSize,Qe=jG(Ae),Ze=Qe.numericAxisName,Ge=Qe.cateAxisName,Oe=hLe(ne),je=[];return ne.forEach(function(Le,ut){var ze=oC(W.data,{graphicalItems:[Le],dataStartIndex:ce,dataEndIndex:ge}),ht=Le.type.defaultProps!==void 0?dr(dr({},Le.type.defaultProps),Le.props):Le.props,rt=ht.dataKey,Qt=ht.maxBarSize,Cr=ht["".concat(Ze,"Id")],vr=ht["".concat(Ge,"Id")],cr={},nr=_.reduce(function(xr,fr){var pr=Z["".concat(fr.axisType,"Map")],ar=ht["".concat(fr.axisType,"Id")];pr&&pr[ar]||fr.axisType==="zAxis"||Bv();var tn=pr[ar];return dr(dr({},xr),{},ti(ti({},fr.axisType,tn),"".concat(fr.axisType,"Ticks"),im(tn)))},cr),Kt=nr[Ge],De=nr["".concat(Ge,"Ticks")],er=ae&&ae[Cr]&&ae[Cr].hasStack&&ike(Le,ae[Cr].stackGroups),Lt=lm(Le.type).indexOf("Bar")>=0,Rr=yT(Kt,De),Pt=[],nn=Oe&&KEe({barSize:Te,stackGroups:ae,totalSize:pLe(nr,Ge)});if(Lt){var Sn,Br,et=Yn(Qt)?ke:Qt,bt=(Sn=(Br=yT(Kt,De,!0))!==null&&Br!==void 0?Br:et)!==null&&Sn!==void 0?Sn:0;Pt=ZEe({barGap:_e,barCategoryGap:Ee,bandSize:bt!==Rr?bt:Rr,sizeList:nn[vr],maxBarSize:et}),bt!==Rr&&(Pt=Pt.map(function(xr){return dr(dr({},xr),{},{position:dr(dr({},xr.position),{},{offset:xr.position.offset-bt/2})})}))}var zt=Le&&Le.type&&Le.type.getComposedData;zt&&je.push({props:dr(dr({},zt(dr(dr({},nr),{},{displayedData:ze,props:W,dataKey:rt,item:Le,bandSize:Rr,barPosition:Pt,offset:ee,stackedData:er,layout:Ae,dataStartIndex:ce,dataEndIndex:ge}))),{},ti(ti(ti({key:Le.key||"item-".concat(ut)},Ze,nr[Ze]),Ge,nr[Ge]),"animationId",se)),childIndex:Q1e(Le,W.children),item:Le})}),je},F=function(W,Z){var ne=W.props,ae=W.dataStartIndex,ee=W.dataEndIndex,se=W.updateId;if(!IU({props:ne}))return null;var ce=ne.children,ge=ne.layout,Te=ne.stackOffset,Ae=ne.data,_e=ne.reverseStackOrder,Ee=jG(ge),ke=Ee.numericAxisName,Qe=Ee.cateAxisName,Ze=Vl(ce,n),Ge=nke(Ae,Ze,"".concat(ke,"Id"),"".concat(Qe,"Id"),Te,_e),Oe=_.reduce(function(ht,rt){var Qt="".concat(rt.axisType,"Map");return dr(dr({},ht),{},ti({},Qt,uLe(ne,dr(dr({},rt),{},{graphicalItems:Ze,stackGroups:rt.axisType===ke&&Ge,dataStartIndex:ae,dataEndIndex:ee}))))},{}),je=fLe(dr(dr({},Oe),{},{props:ne,graphicalItems:Ze}),Z==null?void 0:Z.legendBBox);Object.keys(Oe).forEach(function(ht){Oe[ht]=A(ne,Oe[ht],je,ht.replace("Map",""),r)});var Le=Oe["".concat(Qe,"Map")],ut=dLe(Le),ze=O(ne,dr(dr({},Oe),{},{dataStartIndex:ae,dataEndIndex:ee,updateId:se,graphicalItems:Ze,stackGroups:Ge,offset:je}));return dr(dr({formattedGraphicalItems:ze,graphicalItems:Ze,offset:je,stackGroups:Ge},ut),Oe)},U=function(q){function W(Z){var ne,ae,ee;return HDe(this,W),ee=YDe(this,W,[Z]),ti(ee,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ti(ee,"accessibilityManager",new NDe),ti(ee,"handleLegendBBoxUpdate",function(se){if(se){var ce=ee.state,ge=ce.dataStartIndex,Te=ce.dataEndIndex,Ae=ce.updateId;ee.setState(dr({legendBBox:se},F({props:ee.props,dataStartIndex:ge,dataEndIndex:Te,updateId:Ae},dr(dr({},ee.state),{},{legendBBox:se}))))}}),ti(ee,"handleReceiveSyncEvent",function(se,ce,ge){if(ee.props.syncId===se){if(ge===ee.eventEmitterSymbol&&typeof ee.props.syncMethod!="function")return;ee.applySyncEvent(ce)}}),ti(ee,"handleBrushChange",function(se){var ce=se.startIndex,ge=se.endIndex;if(ce!==ee.state.dataStartIndex||ge!==ee.state.dataEndIndex){var Te=ee.state.updateId;ee.setState(function(){return dr({dataStartIndex:ce,dataEndIndex:ge},F({props:ee.props,dataStartIndex:ce,dataEndIndex:ge,updateId:Te},ee.state))}),ee.triggerSyncEvent({dataStartIndex:ce,dataEndIndex:ge})}}),ti(ee,"handleMouseEnter",function(se){var ce=ee.getMouseInfo(se);if(ce){var ge=dr(dr({},ce),{},{isTooltipActive:!0});ee.setState(ge),ee.triggerSyncEvent(ge);var Te=ee.props.onMouseEnter;$n(Te)&&Te(ge,se)}}),ti(ee,"triggeredAfterMouseMove",function(se){var ce=ee.getMouseInfo(se),ge=ce?dr(dr({},ce),{},{isTooltipActive:!0}):{isTooltipActive:!1};ee.setState(ge),ee.triggerSyncEvent(ge);var Te=ee.props.onMouseMove;$n(Te)&&Te(ge,se)}),ti(ee,"handleItemMouseEnter",function(se){ee.setState(function(){return{isTooltipActive:!0,activeItem:se,activePayload:se.tooltipPayload,activeCoordinate:se.tooltipPosition||{x:se.cx,y:se.cy}}})}),ti(ee,"handleItemMouseLeave",function(){ee.setState(function(){return{isTooltipActive:!1}})}),ti(ee,"handleMouseMove",function(se){se.persist(),ee.throttleTriggeredAfterMouseMove(se)}),ti(ee,"handleMouseLeave",function(se){ee.throttleTriggeredAfterMouseMove.cancel();var ce={isTooltipActive:!1};ee.setState(ce),ee.triggerSyncEvent(ce);var ge=ee.props.onMouseLeave;$n(ge)&&ge(ce,se)}),ti(ee,"handleOuterEvent",function(se){var ce=J1e(se),ge=wu(ee.props,"".concat(ce));if(ce&&$n(ge)){var Te,Ae;/.*touch.*/i.test(ce)?Ae=ee.getMouseInfo(se.changedTouches[0]):Ae=ee.getMouseInfo(se),ge((Te=Ae)!==null&&Te!==void 0?Te:{},se)}}),ti(ee,"handleClick",function(se){var ce=ee.getMouseInfo(se);if(ce){var ge=dr(dr({},ce),{},{isTooltipActive:!0});ee.setState(ge),ee.triggerSyncEvent(ge);var Te=ee.props.onClick;$n(Te)&&Te(ge,se)}}),ti(ee,"handleMouseDown",function(se){var ce=ee.props.onMouseDown;if($n(ce)){var ge=ee.getMouseInfo(se);ce(ge,se)}}),ti(ee,"handleMouseUp",function(se){var ce=ee.props.onMouseUp;if($n(ce)){var ge=ee.getMouseInfo(se);ce(ge,se)}}),ti(ee,"handleTouchMove",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.throttleTriggeredAfterMouseMove(se.changedTouches[0])}),ti(ee,"handleTouchStart",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.handleMouseDown(se.changedTouches[0])}),ti(ee,"handleTouchEnd",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.handleMouseUp(se.changedTouches[0])}),ti(ee,"handleDoubleClick",function(se){var ce=ee.props.onDoubleClick;if($n(ce)){var ge=ee.getMouseInfo(se);ce(ge,se)}}),ti(ee,"handleContextMenu",function(se){var ce=ee.props.onContextMenu;if($n(ce)){var ge=ee.getMouseInfo(se);ce(ge,se)}}),ti(ee,"triggerSyncEvent",function(se){ee.props.syncId!==void 0&&fN.emit(pN,ee.props.syncId,se,ee.eventEmitterSymbol)}),ti(ee,"applySyncEvent",function(se){var ce=ee.props,ge=ce.layout,Te=ce.syncMethod,Ae=ee.state.updateId,_e=se.dataStartIndex,Ee=se.dataEndIndex;if(se.dataStartIndex!==void 0||se.dataEndIndex!==void 0)ee.setState(dr({dataStartIndex:_e,dataEndIndex:Ee},F({props:ee.props,dataStartIndex:_e,dataEndIndex:Ee,updateId:Ae},ee.state)));else if(se.activeTooltipIndex!==void 0){var ke=se.chartX,Qe=se.chartY,Ze=se.activeTooltipIndex,Ge=ee.state,Oe=Ge.offset,je=Ge.tooltipTicks;if(!Oe)return;if(typeof Te=="function")Ze=Te(je,se);else if(Te==="value"){Ze=-1;for(var Le=0;Le<je.length;Le++)if(je[Le].value===se.activeLabel){Ze=Le;break}}var ut=dr(dr({},Oe),{},{x:Oe.left,y:Oe.top}),ze=Math.min(ke,ut.x+ut.width),ht=Math.min(Qe,ut.y+ut.height),rt=je[Ze]&&je[Ze].value,Qt=ZI(ee.state,ee.props.data,Ze),Cr=je[Ze]?{x:ge==="horizontal"?je[Ze].coordinate:ze,y:ge==="horizontal"?ht:je[Ze].coordinate}:Hee;ee.setState(dr(dr({},se),{},{activeLabel:rt,activeCoordinate:Cr,activePayload:Qt,activeTooltipIndex:Ze}))}else ee.setState(se)}),ti(ee,"renderCursor",function(se){var ce,ge=ee.state,Te=ge.isTooltipActive,Ae=ge.activeCoordinate,_e=ge.activePayload,Ee=ge.offset,ke=ge.activeTooltipIndex,Qe=ge.tooltipAxisBandSize,Ze=ee.getTooltipEventType(),Ge=(ce=se.props.active)!==null&&ce!==void 0?ce:Te,Oe=ee.props.layout,je=se.key||"_recharts-cursor";return Re.createElement(BDe,{key:je,activeCoordinate:Ae,activePayload:_e,activeTooltipIndex:ke,chartName:r,element:se,isActive:Ge,layout:Oe,offset:Ee,tooltipAxisBandSize:Qe,tooltipEventType:Ze})}),ti(ee,"renderPolarAxis",function(se,ce,ge){var Te=wu(se,"type.axisType"),Ae=wu(ee.state,"".concat(Te,"Map")),_e=se.type.defaultProps,Ee=_e!==void 0?dr(dr({},_e),se.props):se.props,ke=Ae&&Ae[Ee["".concat(Te,"Id")]];return H.cloneElement(se,dr(dr({},ke),{},{className:hi(Te,ke.className),key:se.key||"".concat(ce,"-").concat(ge),ticks:im(ke,!0)}))}),ti(ee,"renderPolarGrid",function(se){var ce=se.props,ge=ce.radialLines,Te=ce.polarAngles,Ae=ce.polarRadius,_e=ee.state,Ee=_e.radiusAxisMap,ke=_e.angleAxisMap,Qe=kg(Ee),Ze=kg(ke),Ge=Ze.cx,Oe=Ze.cy,je=Ze.innerRadius,Le=Ze.outerRadius;return H.cloneElement(se,{polarAngles:Array.isArray(Te)?Te:im(Ze,!0).map(function(ut){return ut.coordinate}),polarRadius:Array.isArray(Ae)?Ae:im(Qe,!0).map(function(ut){return ut.coordinate}),cx:Ge,cy:Oe,innerRadius:je,outerRadius:Le,key:se.key||"polar-grid",radialLines:ge})}),ti(ee,"renderLegend",function(){var se=ee.state.formattedGraphicalItems,ce=ee.props,ge=ce.children,Te=ce.width,Ae=ce.height,_e=ee.props.margin||{},Ee=Te-(_e.left||0)-(_e.right||0),ke=yQ({children:ge,formattedGraphicalItems:se,legendWidth:Ee,legendContent:w});if(!ke)return null;var Qe=ke.item,Ze=CG(ke,VDe);return H.cloneElement(Qe,dr(dr({},Ze),{},{chartWidth:Te,chartHeight:Ae,margin:_e,onBBoxUpdate:ee.handleLegendBBoxUpdate}))}),ti(ee,"renderTooltip",function(){var se,ce=ee.props,ge=ce.children,Te=ce.accessibilityLayer,Ae=pu(ge,aa);if(!Ae)return null;var _e=ee.state,Ee=_e.isTooltipActive,ke=_e.activeCoordinate,Qe=_e.activePayload,Ze=_e.activeLabel,Ge=_e.offset,Oe=(se=Ae.props.active)!==null&&se!==void 0?se:Ee;return H.cloneElement(Ae,{viewBox:dr(dr({},Ge),{},{x:Ge.left,y:Ge.top}),active:Oe,label:Ze,payload:Oe?Qe:[],coordinate:ke,accessibilityLayer:Te})}),ti(ee,"renderBrush",function(se){var ce=ee.props,ge=ce.margin,Te=ce.data,Ae=ee.state,_e=Ae.offset,Ee=Ae.dataStartIndex,ke=Ae.dataEndIndex,Qe=Ae.updateId;return H.cloneElement(se,{key:se.key||"_recharts-brush",onChange:FS(ee.handleBrushChange,se.props.onChange),data:Te,x:Dr(se.props.x)?se.props.x:_e.left,y:Dr(se.props.y)?se.props.y:_e.top+_e.height+_e.brushBottom-(ge.bottom||0),width:Dr(se.props.width)?se.props.width:_e.width,startIndex:Ee,endIndex:ke,updateId:"brush-".concat(Qe)})}),ti(ee,"renderReferenceElement",function(se,ce,ge){if(!se)return null;var Te=ee,Ae=Te.clipPathId,_e=ee.state,Ee=_e.xAxisMap,ke=_e.yAxisMap,Qe=_e.offset,Ze=se.type.defaultProps||{},Ge=se.props,Oe=Ge.xAxisId,je=Oe===void 0?Ze.xAxisId:Oe,Le=Ge.yAxisId,ut=Le===void 0?Ze.yAxisId:Le;return H.cloneElement(se,{key:se.key||"".concat(ce,"-").concat(ge),xAxis:Ee[je],yAxis:ke[ut],viewBox:{x:Qe.left,y:Qe.top,width:Qe.width,height:Qe.height},clipPathId:Ae})}),ti(ee,"renderActivePoints",function(se){var ce=se.item,ge=se.activePoint,Te=se.basePoint,Ae=se.childIndex,_e=se.isRange,Ee=[],ke=ce.props.key,Qe=ce.item.type.defaultProps!==void 0?dr(dr({},ce.item.type.defaultProps),ce.item.props):ce.item.props,Ze=Qe.activeDot,Ge=Qe.dataKey,Oe=dr(dr({index:Ae,dataKey:Ge,cx:ge.x,cy:ge.y,r:4,fill:LL(ce.item),strokeWidth:2,stroke:"#fff",payload:ge.payload,value:ge.value},yn(Ze,!1)),WA(Ze));return Ee.push(W.renderActiveDot(Ze,Oe,"".concat(ke,"-activePoint-").concat(Ae))),Te?Ee.push(W.renderActiveDot(Ze,dr(dr({},Oe),{},{cx:Te.x,cy:Te.y}),"".concat(ke,"-basePoint-").concat(Ae))):_e&&Ee.push(null),Ee}),ti(ee,"renderGraphicChild",function(se,ce,ge){var Te=ee.filterFormatItem(se,ce,ge);if(!Te)return null;var Ae=ee.getTooltipEventType(),_e=ee.state,Ee=_e.isTooltipActive,ke=_e.tooltipAxis,Qe=_e.activeTooltipIndex,Ze=_e.activeLabel,Ge=ee.props.children,Oe=pu(Ge,aa),je=Te.props,Le=je.points,ut=je.isRange,ze=je.baseLine,ht=Te.item.type.defaultProps!==void 0?dr(dr({},Te.item.type.defaultProps),Te.item.props):Te.item.props,rt=ht.activeDot,Qt=ht.hide,Cr=ht.activeBar,vr=ht.activeShape,cr=!!(!Qt&&Ee&&Oe&&(rt||Cr||vr)),nr={};Ae!=="axis"&&Oe&&Oe.props.trigger==="click"?nr={onClick:FS(ee.handleItemMouseEnter,se.props.onClick)}:Ae!=="axis"&&(nr={onMouseLeave:FS(ee.handleItemMouseLeave,se.props.onMouseLeave),onMouseEnter:FS(ee.handleItemMouseEnter,se.props.onMouseEnter)});var Kt=H.cloneElement(se,dr(dr({},Te.props),nr));function De(fr){return typeof ke.dataKey=="function"?ke.dataKey(fr.payload):null}if(cr)if(Qe>=0){var er,Lt;if(ke.dataKey&&!ke.allowDuplicatedCategory){var Rr=typeof ke.dataKey=="function"?De:"payload.".concat(ke.dataKey.toString());er=GA(Le,Rr,Ze),Lt=ut&&ze&&GA(ze,Rr,Ze)}else er=Le==null?void 0:Le[Qe],Lt=ut&&ze&&ze[Qe];if(vr||Cr){var Pt=se.props.activeIndex!==void 0?se.props.activeIndex:Qe;return[H.cloneElement(se,dr(dr(dr({},Te.props),nr),{},{activeIndex:Pt})),null,null]}if(!Yn(er))return[Kt].concat(a_(ee.renderActivePoints({item:Te,activePoint:er,basePoint:Lt,childIndex:Qe,isRange:ut})))}else{var nn,Sn=(nn=ee.getItemByXY(ee.state.activeCoordinate))!==null&&nn!==void 0?nn:{graphicalItem:Kt},Br=Sn.graphicalItem,et=Br.item,bt=et===void 0?se:et,zt=Br.childIndex,xr=dr(dr(dr({},Te.props),nr),{},{activeIndex:zt});return[H.cloneElement(bt,xr),null,null]}return ut?[Kt,null,null]:[Kt,null]}),ti(ee,"renderCustomized",function(se,ce,ge){return H.cloneElement(se,dr(dr({key:"recharts-customized-".concat(ge)},ee.props),ee.state))}),ti(ee,"renderMap",{CartesianGrid:{handler:qS,once:!0},ReferenceArea:{handler:ee.renderReferenceElement},ReferenceLine:{handler:qS},ReferenceDot:{handler:ee.renderReferenceElement},XAxis:{handler:qS},YAxis:{handler:qS},Brush:{handler:ee.renderBrush,once:!0},Bar:{handler:ee.renderGraphicChild},Line:{handler:ee.renderGraphicChild},Area:{handler:ee.renderGraphicChild},Radar:{handler:ee.renderGraphicChild},RadialBar:{handler:ee.renderGraphicChild},Scatter:{handler:ee.renderGraphicChild},Pie:{handler:ee.renderGraphicChild},Funnel:{handler:ee.renderGraphicChild},Tooltip:{handler:ee.renderCursor,once:!0},PolarGrid:{handler:ee.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ee.renderPolarAxis},PolarRadiusAxis:{handler:ee.renderPolarAxis},Customized:{handler:ee.renderCustomized}}),ee.clipPathId="".concat((ne=Z.id)!==null&&ne!==void 0?ne:ty("recharts"),"-clip"),ee.throttleTriggeredAfterMouseMove=gJ(ee.triggeredAfterMouseMove,(ae=Z.throttleDelay)!==null&&ae!==void 0?ae:1e3/60),ee.state={},ee}return QDe(W,q),ZDe(W,[{key:"componentDidMount",value:function(){var ne,ae;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(ne=this.props.margin.left)!==null&&ne!==void 0?ne:0,top:(ae=this.props.margin.top)!==null&&ae!==void 0?ae:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var ne=this.props,ae=ne.children,ee=ne.data,se=ne.height,ce=ne.layout,ge=pu(ae,aa);if(ge){var Te=ge.props.defaultIndex;if(!(typeof Te!="number"||Te<0||Te>this.state.tooltipTicks.length-1)){var Ae=this.state.tooltipTicks[Te]&&this.state.tooltipTicks[Te].value,_e=ZI(this.state,ee,Te,Ae),Ee=this.state.tooltipTicks[Te].coordinate,ke=(this.state.offset.top+se)/2,Qe=ce==="horizontal",Ze=Qe?{x:Ee,y:ke}:{y:Ee,x:ke},Ge=this.state.formattedGraphicalItems.find(function(je){var Le=je.item;return Le.type.name==="Scatter"});Ge&&(Ze=dr(dr({},Ze),Ge.props.points[Te].tooltipPosition),_e=Ge.props.points[Te].tooltipPayload);var Oe={activeTooltipIndex:Te,isTooltipActive:!0,activeLabel:Ae,activePayload:_e,activeCoordinate:Ze};this.setState(Oe),this.renderCursor(ge),this.accessibilityManager.setIndex(Te)}}}},{key:"getSnapshotBeforeUpdate",value:function(ne,ae){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==ae.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==ne.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==ne.margin){var ee,se;this.accessibilityManager.setDetails({offset:{left:(ee=this.props.margin.left)!==null&&ee!==void 0?ee:0,top:(se=this.props.margin.top)!==null&&se!==void 0?se:0}})}return null}},{key:"componentDidUpdate",value:function(ne){PR([pu(ne.children,aa)],[pu(this.props.children,aa)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var ne=pu(this.props.children,aa);if(ne&&typeof ne.props.shared=="boolean"){var ae=ne.props.shared?"axis":"item";return i.indexOf(ae)>=0?ae:l}return l}},{key:"getMouseInfo",value:function(ne){if(!this.container)return null;var ae=this.container,ee=ae.getBoundingClientRect(),se=FAe(ee),ce={chartX:Math.round(ne.pageX-se.left),chartY:Math.round(ne.pageY-se.top)},ge=ee.width/ae.offsetWidth||1,Te=this.inRange(ce.chartX,ce.chartY,ge);if(!Te)return null;var Ae=this.state,_e=Ae.xAxisMap,Ee=Ae.yAxisMap,ke=this.getTooltipEventType();if(ke!=="axis"&&_e&&Ee){var Qe=kg(_e).scale,Ze=kg(Ee).scale,Ge=Qe&&Qe.invert?Qe.invert(ce.chartX):null,Oe=Ze&&Ze.invert?Ze.invert(ce.chartY):null;return dr(dr({},ce),{},{xValue:Ge,yValue:Oe})}var je=kG(this.state,this.props.data,this.props.layout,Te);return je?dr(dr({},ce),je):null}},{key:"inRange",value:function(ne,ae){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=this.props.layout,ce=ne/ee,ge=ae/ee;if(se==="horizontal"||se==="vertical"){var Te=this.state.offset,Ae=ce>=Te.left&&ce<=Te.left+Te.width&&ge>=Te.top&&ge<=Te.top+Te.height;return Ae?{x:ce,y:ge}:null}var _e=this.state,Ee=_e.angleAxisMap,ke=_e.radiusAxisMap;if(Ee&&ke){var Qe=kg(Ee);return wq({x:ce,y:ge},Qe)}return null}},{key:"parseEventsOfWrapper",value:function(){var ne=this.props.children,ae=this.getTooltipEventType(),ee=pu(ne,aa),se={};ee&&ae==="axis"&&(ee.props.trigger==="click"?se={onClick:this.handleClick}:se={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var ce=WA(this.props,this.handleOuterEvent);return dr(dr({},ce),se)}},{key:"addListener",value:function(){fN.on(pN,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){fN.removeListener(pN,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(ne,ae,ee){for(var se=this.state.formattedGraphicalItems,ce=0,ge=se.length;ce<ge;ce++){var Te=se[ce];if(Te.item===ne||Te.props.key===ne.key||ae===lm(Te.item.type)&&ee===Te.childIndex)return Te}return null}},{key:"renderClipPath",value:function(){var ne=this.clipPathId,ae=this.state.offset,ee=ae.left,se=ae.top,ce=ae.height,ge=ae.width;return Re.createElement("defs",null,Re.createElement("clipPath",{id:ne},Re.createElement("rect",{x:ee,y:se,height:ce,width:ge})))}},{key:"getXScales",value:function(){var ne=this.state.xAxisMap;return ne?Object.entries(ne).reduce(function(ae,ee){var se=PG(ee,2),ce=se[0],ge=se[1];return dr(dr({},ae),{},ti({},ce,ge.scale))},{}):null}},{key:"getYScales",value:function(){var ne=this.state.yAxisMap;return ne?Object.entries(ne).reduce(function(ae,ee){var se=PG(ee,2),ce=se[0],ge=se[1];return dr(dr({},ae),{},ti({},ce,ge.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(ne){var ae;return(ae=this.state.xAxisMap)===null||ae===void 0||(ae=ae[ne])===null||ae===void 0?void 0:ae.scale}},{key:"getYScaleByAxisId",value:function(ne){var ae;return(ae=this.state.yAxisMap)===null||ae===void 0||(ae=ae[ne])===null||ae===void 0?void 0:ae.scale}},{key:"getItemByXY",value:function(ne){var ae=this.state,ee=ae.formattedGraphicalItems,se=ae.activeItem;if(ee&&ee.length)for(var ce=0,ge=ee.length;ce<ge;ce++){var Te=ee[ce],Ae=Te.props,_e=Te.item,Ee=_e.type.defaultProps!==void 0?dr(dr({},_e.type.defaultProps),_e.props):_e.props,ke=lm(_e.type);if(ke==="Bar"){var Qe=(Ae.data||[]).find(function(je){return Jje(ne,je)});if(Qe)return{graphicalItem:Te,payload:Qe}}else if(ke==="RadialBar"){var Ze=(Ae.data||[]).find(function(je){return wq(ne,je)});if(Ze)return{graphicalItem:Te,payload:Ze}}else if(eC(Te,se)||tC(Te,se)||ww(Te,se)){var Ge=wNe({graphicalItem:Te,activeTooltipItem:se,itemData:Ee.data}),Oe=Ee.activeIndex===void 0?Ge:Ee.activeIndex;return{graphicalItem:dr(dr({},Te),{},{childIndex:Oe}),payload:ww(Te,se)?Ee.data[Ge]:Te.props.data[Ge]}}}return null}},{key:"render",value:function(){var ne=this;if(!IU(this))return null;var ae=this.props,ee=ae.children,se=ae.className,ce=ae.width,ge=ae.height,Te=ae.style,Ae=ae.compact,_e=ae.title,Ee=ae.desc,ke=CG(ae,UDe),Qe=yn(ke,!1);if(Ae)return Re.createElement(nG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Re.createElement(ER,hx({},Qe,{width:ce,height:ge,title:_e,desc:Ee}),this.renderClipPath(),LU(ee,this.renderMap)));if(this.props.accessibilityLayer){var Ze,Ge;Qe.tabIndex=(Ze=this.props.tabIndex)!==null&&Ze!==void 0?Ze:0,Qe.role=(Ge=this.props.role)!==null&&Ge!==void 0?Ge:"application",Qe.onKeyDown=function(je){ne.accessibilityManager.keyboardEvent(je)},Qe.onFocus=function(){ne.accessibilityManager.focus()}}var Oe=this.parseEventsOfWrapper();return Re.createElement(nG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Re.createElement("div",hx({className:hi("recharts-wrapper",se),style:dr({position:"relative",cursor:"default",width:ce,height:ge},Te)},Oe,{ref:function(Le){ne.container=Le}}),Re.createElement(ER,hx({},Qe,{width:ce,height:ge,title:_e,desc:Ee,style:aLe}),this.renderClipPath(),LU(ee,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(H.Component);ti(U,"displayName",r),ti(U,"defaultProps",dr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},E)),ti(U,"getDerivedStateFromProps",function(q,W){var Z=q.dataKey,ne=q.data,ae=q.children,ee=q.width,se=q.height,ce=q.layout,ge=q.stackOffset,Te=q.margin,Ae=W.dataStartIndex,_e=W.dataEndIndex;if(W.updateId===void 0){var Ee=MG(q);return dr(dr(dr({},Ee),{},{updateId:0},F(dr(dr({props:q},Ee),{},{updateId:0}),W)),{},{prevDataKey:Z,prevData:ne,prevWidth:ee,prevHeight:se,prevLayout:ce,prevStackOffset:ge,prevMargin:Te,prevChildren:ae})}if(Z!==W.prevDataKey||ne!==W.prevData||ee!==W.prevWidth||se!==W.prevHeight||ce!==W.prevLayout||ge!==W.prevStackOffset||!yx(Te,W.prevMargin)){var ke=MG(q),Qe={chartX:W.chartX,chartY:W.chartY,isTooltipActive:W.isTooltipActive},Ze=dr(dr({},kG(W,ne,ce)),{},{updateId:W.updateId+1}),Ge=dr(dr(dr({},ke),Qe),Ze);return dr(dr(dr({},Ge),F(dr({props:q},Ge),W)),{},{prevDataKey:Z,prevData:ne,prevWidth:ee,prevHeight:se,prevLayout:ce,prevStackOffset:ge,prevMargin:Te,prevChildren:ae})}if(!PR(ae,W.prevChildren)){var Oe,je,Le,ut,ze=pu(ae,Wx),ht=ze&&(Oe=(je=ze.props)===null||je===void 0?void 0:je.startIndex)!==null&&Oe!==void 0?Oe:Ae,rt=ze&&(Le=(ut=ze.props)===null||ut===void 0?void 0:ut.endIndex)!==null&&Le!==void 0?Le:_e,Qt=ht!==Ae||rt!==_e,Cr=!Yn(ne),vr=Cr&&!Qt?W.updateId:W.updateId+1;return dr(dr({updateId:vr},F(dr(dr({props:q},W),{},{updateId:vr,dataStartIndex:ht,dataEndIndex:rt}),W)),{},{prevChildren:ae,dataStartIndex:ht,dataEndIndex:rt})}return null}),ti(U,"renderActiveDot",function(q,W,Z){var ne;return H.isValidElement(q)?ne=H.cloneElement(q,W):$n(q)?ne=q(W):ne=Re.createElement(s2,W),Re.createElement(pi,{className:"recharts-active-dot",key:Z},ne)});var B=H.forwardRef(function(W,Z){return Re.createElement(U,hx({},W,{ref:Z}))});return B.displayName=U.displayName,B},ZL=t0({chartName:"LineChart",GraphicalChild:Qf,axisComponents:[{axisType:"xAxis",AxisComp:La},{axisType:"yAxis",AxisComp:za}],formatAxisMap:u2}),_d=t0({chartName:"BarChart",GraphicalChild:xs,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:La},{axisType:"yAxis",AxisComp:za}],formatAxisMap:u2}),Zee=t0({chartName:"PieChart",GraphicalChild:op,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:l2},{axisType:"radiusAxis",AxisComp:o2}],formatAxisMap:jQ,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),mLe=t0({chartName:"ScatterChart",GraphicalChild:O_,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:La},{axisType:"yAxis",AxisComp:za},{axisType:"zAxis",AxisComp:d2}],formatAxisMap:u2}),gLe=t0({chartName:"AreaChart",GraphicalChild:yu,axisComponents:[{axisType:"xAxis",AxisComp:La},{axisType:"yAxis",AxisComp:za}],formatAxisMap:u2}),yLe=t0({chartName:"RadialBarChart",GraphicalChild:c2,legendContent:"children",defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"angleAxis",AxisComp:l2},{axisType:"radiusAxis",AxisComp:o2}],formatAxisMap:jQ,defaultProps:{layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),YL=t0({chartName:"ComposedChart",GraphicalChild:[Qf,yu,xs,O_],axisComponents:[{axisType:"xAxis",AxisComp:La},{axisType:"yAxis",AxisComp:za},{axisType:"zAxis",AxisComp:d2}],formatAxisMap:u2});function OG(e,[t,r]){return Math.min(r,Math.max(t,e))}function vLe(e){const t=H.useRef({value:e,previous:e});return H.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var xLe="VisuallyHidden",XL=H.forwardRef((e,t)=>u.jsx(gi.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));XL.displayName=xLe;var _Le=XL,bLe=[" ","Enter","ArrowUp","ArrowDown"],wLe=[" ","Enter"],h2="Select",[lC,cC,SLe]=N3(h2),[N_,QVe]=kd(h2,[SLe,Xg]),uC=Xg(),[ALe,ay]=N_(h2),[TLe,PLe]=N_(h2),Yee=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:l,value:f,defaultValue:i,onValueChange:_,dir:w,name:A,autoComplete:E,disabled:O,required:F,form:U}=e,B=uC(t),[q,W]=H.useState(null),[Z,ne]=H.useState(null),[ae,ee]=H.useState(!1),se=R3(w),[ce=!1,ge]=Lg({prop:n,defaultProp:a,onChange:l}),[Te,Ae]=Lg({prop:f,defaultProp:i,onChange:_}),_e=H.useRef(null),Ee=q?U||!!q.closest("form"):!0,[ke,Qe]=H.useState(new Set),Ze=Array.from(ke).map(Ge=>Ge.props.value).join(";");return u.jsx(sP,{...B,children:u.jsxs(ALe,{required:F,scope:t,trigger:q,onTriggerChange:W,valueNode:Z,onValueNodeChange:ne,valueNodeHasChildren:ae,onValueNodeHasChildrenChange:ee,contentId:Sd(),value:Te,onValueChange:Ae,open:ce,onOpenChange:ge,dir:se,triggerPointerDownPosRef:_e,disabled:O,children:[u.jsx(lC.Provider,{scope:t,children:u.jsx(TLe,{scope:e.__scopeSelect,onNativeOptionAdd:H.useCallback(Ge=>{Qe(Oe=>new Set(Oe).add(Ge))},[]),onNativeOptionRemove:H.useCallback(Ge=>{Qe(Oe=>{const je=new Set(Oe);return je.delete(Ge),je})},[]),children:r})}),Ee?u.jsxs(wte,{"aria-hidden":!0,required:F,tabIndex:-1,name:A,autoComplete:E,value:Te,onChange:Ge=>Ae(Ge.target.value),disabled:O,form:U,children:[Te===void 0?u.jsx("option",{value:""}):null,Array.from(ke)]},Ze):null]})})};Yee.displayName=h2;var Xee="SelectTrigger",Jee=H.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,l=uC(r),f=ay(Xee,r),i=f.disabled||n,_=Xi(t,f.onTriggerChange),w=cC(r),A=H.useRef("touch"),[E,O,F]=Ste(B=>{const q=w().filter(ne=>!ne.disabled),W=q.find(ne=>ne.value===f.value),Z=Ate(q,B,W);Z!==void 0&&f.onValueChange(Z.value)}),U=B=>{i||(f.onOpenChange(!0),F()),B&&(f.triggerPointerDownPosRef.current={x:Math.round(B.pageX),y:Math.round(B.pageY)})};return u.jsx(Lw,{asChild:!0,...l,children:u.jsx(gi.button,{type:"button",role:"combobox","aria-controls":f.contentId,"aria-expanded":f.open,"aria-required":f.required,"aria-autocomplete":"none",dir:f.dir,"data-state":f.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":bte(f.value)?"":void 0,...a,ref:_,onClick:on(a.onClick,B=>{B.currentTarget.focus(),A.current!=="mouse"&&U(B)}),onPointerDown:on(a.onPointerDown,B=>{A.current=B.pointerType;const q=B.target;q.hasPointerCapture(B.pointerId)&&q.releasePointerCapture(B.pointerId),B.button===0&&B.ctrlKey===!1&&B.pointerType==="mouse"&&(U(B),B.preventDefault())}),onKeyDown:on(a.onKeyDown,B=>{const q=E.current!=="";!(B.ctrlKey||B.altKey||B.metaKey)&&B.key.length===1&&O(B.key),!(q&&B.key===" ")&&bLe.includes(B.key)&&(U(),B.preventDefault())})})})});Jee.displayName=Xee;var Qee="SelectValue",ete=H.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:l,placeholder:f="",...i}=e,_=ay(Qee,r),{onValueNodeHasChildrenChange:w}=_,A=l!==void 0,E=Xi(t,_.onValueNodeChange);return nl(()=>{w(A)},[w,A]),u.jsx(gi.span,{...i,ref:E,style:{pointerEvents:"none"},children:bte(_.value)?u.jsx(u.Fragment,{children:f}):l})});ete.displayName=Qee;var CLe="SelectIcon",tte=H.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return u.jsx(gi.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});tte.displayName=CLe;var ELe="SelectPortal",rte=e=>u.jsx(v_,{asChild:!0,...e});rte.displayName=ELe;var Uv="SelectContent",nte=H.forwardRef((e,t)=>{const r=ay(Uv,e.__scopeSelect),[n,a]=H.useState();if(nl(()=>{a(new DocumentFragment)},[]),!r.open){const l=n;return l?Ow.createPortal(u.jsx(ite,{scope:e.__scopeSelect,children:u.jsx(lC.Slot,{scope:e.__scopeSelect,children:u.jsx("div",{children:e.children})})}),l):null}return u.jsx(ate,{...e,ref:t})});nte.displayName=Uv;var wh=10,[ite,sy]=N_(Uv),kLe="SelectContentImpl",ate=H.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:f,side:i,sideOffset:_,align:w,alignOffset:A,arrowPadding:E,collisionBoundary:O,collisionPadding:F,sticky:U,hideWhenDetached:B,avoidCollisions:q,...W}=e,Z=ay(Uv,r),[ne,ae]=H.useState(null),[ee,se]=H.useState(null),ce=Xi(t,cr=>ae(cr)),[ge,Te]=H.useState(null),[Ae,_e]=H.useState(null),Ee=cC(r),[ke,Qe]=H.useState(!1),Ze=H.useRef(!1);H.useEffect(()=>{if(ne)return uP(ne)},[ne]),rP();const Ge=H.useCallback(cr=>{const[nr,...Kt]=Ee().map(Lt=>Lt.ref.current),[De]=Kt.slice(-1),er=document.activeElement;for(const Lt of cr)if(Lt===er||(Lt==null||Lt.scrollIntoView({block:"nearest"}),Lt===nr&&ee&&(ee.scrollTop=0),Lt===De&&ee&&(ee.scrollTop=ee.scrollHeight),Lt==null||Lt.focus(),document.activeElement!==er))return},[Ee,ee]),Oe=H.useCallback(()=>Ge([ge,ne]),[Ge,ge,ne]);H.useEffect(()=>{ke&&Oe()},[ke,Oe]);const{onOpenChange:je,triggerPointerDownPosRef:Le}=Z;H.useEffect(()=>{if(ne){let cr={x:0,y:0};const nr=De=>{var er,Lt;cr={x:Math.abs(Math.round(De.pageX)-(((er=Le.current)==null?void 0:er.x)??0)),y:Math.abs(Math.round(De.pageY)-(((Lt=Le.current)==null?void 0:Lt.y)??0))}},Kt=De=>{cr.x<=10&&cr.y<=10?De.preventDefault():ne.contains(De.target)||je(!1),document.removeEventListener("pointermove",nr),Le.current=null};return Le.current!==null&&(document.addEventListener("pointermove",nr),document.addEventListener("pointerup",Kt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",nr),document.removeEventListener("pointerup",Kt,{capture:!0})}}},[ne,je,Le]),H.useEffect(()=>{const cr=()=>je(!1);return window.addEventListener("blur",cr),window.addEventListener("resize",cr),()=>{window.removeEventListener("blur",cr),window.removeEventListener("resize",cr)}},[je]);const[ut,ze]=Ste(cr=>{const nr=Ee().filter(er=>!er.disabled),Kt=nr.find(er=>er.ref.current===document.activeElement),De=Ate(nr,cr,Kt);De&&setTimeout(()=>De.ref.current.focus())}),ht=H.useCallback((cr,nr,Kt)=>{const De=!Ze.current&&!Kt;(Z.value!==void 0&&Z.value===nr||De)&&(Te(cr),De&&(Ze.current=!0))},[Z.value]),rt=H.useCallback(()=>ne==null?void 0:ne.focus(),[ne]),Qt=H.useCallback((cr,nr,Kt)=>{const De=!Ze.current&&!Kt;(Z.value!==void 0&&Z.value===nr||De)&&_e(cr)},[Z.value]),Cr=n==="popper"?YI:ste,vr=Cr===YI?{side:i,sideOffset:_,align:w,alignOffset:A,arrowPadding:E,collisionBoundary:O,collisionPadding:F,sticky:U,hideWhenDetached:B,avoidCollisions:q}:{};return u.jsx(ite,{scope:r,content:ne,viewport:ee,onViewportChange:se,itemRefCallback:ht,selectedItem:ge,onItemLeave:rt,itemTextRefCallback:Qt,focusSelectedItem:Oe,selectedItemText:Ae,position:n,isPositioned:ke,searchRef:ut,children:u.jsx(zw,{as:Ul,allowPinchZoom:!0,children:u.jsx(Iw,{asChild:!0,trapped:Z.open,onMountAutoFocus:cr=>{cr.preventDefault()},onUnmountAutoFocus:on(a,cr=>{var nr;(nr=Z.trigger)==null||nr.focus({preventScroll:!0}),cr.preventDefault()}),children:u.jsx(m_,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:f,onFocusOutside:cr=>cr.preventDefault(),onDismiss:()=>Z.onOpenChange(!1),children:u.jsx(Cr,{role:"listbox",id:Z.contentId,"data-state":Z.open?"open":"closed",dir:Z.dir,onContextMenu:cr=>cr.preventDefault(),...W,...vr,onPlaced:()=>Qe(!0),ref:ce,style:{display:"flex",flexDirection:"column",outline:"none",...W.style},onKeyDown:on(W.onKeyDown,cr=>{const nr=cr.ctrlKey||cr.altKey||cr.metaKey;if(cr.key==="Tab"&&cr.preventDefault(),!nr&&cr.key.length===1&&ze(cr.key),["ArrowUp","ArrowDown","Home","End"].includes(cr.key)){let De=Ee().filter(er=>!er.disabled).map(er=>er.ref.current);if(["ArrowUp","End"].includes(cr.key)&&(De=De.slice().reverse()),["ArrowUp","ArrowDown"].includes(cr.key)){const er=cr.target,Lt=De.indexOf(er);De=De.slice(Lt+1)}setTimeout(()=>Ge(De)),cr.preventDefault()}})})})})})})});ate.displayName=kLe;var MLe="SelectItemAlignedPosition",ste=H.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,l=ay(Uv,r),f=sy(Uv,r),[i,_]=H.useState(null),[w,A]=H.useState(null),E=Xi(t,ce=>A(ce)),O=cC(r),F=H.useRef(!1),U=H.useRef(!0),{viewport:B,selectedItem:q,selectedItemText:W,focusSelectedItem:Z}=f,ne=H.useCallback(()=>{if(l.trigger&&l.valueNode&&i&&w&&B&&q&&W){const ce=l.trigger.getBoundingClientRect(),ge=w.getBoundingClientRect(),Te=l.valueNode.getBoundingClientRect(),Ae=W.getBoundingClientRect();if(l.dir!=="rtl"){const er=Ae.left-ge.left,Lt=Te.left-er,Rr=ce.left-Lt,Pt=ce.width+Rr,nn=Math.max(Pt,ge.width),Sn=window.innerWidth-wh,Br=OG(Lt,[wh,Math.max(wh,Sn-nn)]);i.style.minWidth=Pt+"px",i.style.left=Br+"px"}else{const er=ge.right-Ae.right,Lt=window.innerWidth-Te.right-er,Rr=window.innerWidth-ce.right-Lt,Pt=ce.width+Rr,nn=Math.max(Pt,ge.width),Sn=window.innerWidth-wh,Br=OG(Lt,[wh,Math.max(wh,Sn-nn)]);i.style.minWidth=Pt+"px",i.style.right=Br+"px"}const _e=O(),Ee=window.innerHeight-wh*2,ke=B.scrollHeight,Qe=window.getComputedStyle(w),Ze=parseInt(Qe.borderTopWidth,10),Ge=parseInt(Qe.paddingTop,10),Oe=parseInt(Qe.borderBottomWidth,10),je=parseInt(Qe.paddingBottom,10),Le=Ze+Ge+ke+je+Oe,ut=Math.min(q.offsetHeight*5,Le),ze=window.getComputedStyle(B),ht=parseInt(ze.paddingTop,10),rt=parseInt(ze.paddingBottom,10),Qt=ce.top+ce.height/2-wh,Cr=Ee-Qt,vr=q.offsetHeight/2,cr=q.offsetTop+vr,nr=Ze+Ge+cr,Kt=Le-nr;if(nr<=Qt){const er=_e.length>0&&q===_e[_e.length-1].ref.current;i.style.bottom="0px";const Lt=w.clientHeight-B.offsetTop-B.offsetHeight,Rr=Math.max(Cr,vr+(er?rt:0)+Lt+Oe),Pt=nr+Rr;i.style.height=Pt+"px"}else{const er=_e.length>0&&q===_e[0].ref.current;i.style.top="0px";const Rr=Math.max(Qt,Ze+B.offsetTop+(er?ht:0)+vr)+Kt;i.style.height=Rr+"px",B.scrollTop=nr-Qt+B.offsetTop}i.style.margin=`${wh}px 0`,i.style.minHeight=ut+"px",i.style.maxHeight=Ee+"px",n==null||n(),requestAnimationFrame(()=>F.current=!0)}},[O,l.trigger,l.valueNode,i,w,B,q,W,l.dir,n]);nl(()=>ne(),[ne]);const[ae,ee]=H.useState();nl(()=>{w&&ee(window.getComputedStyle(w).zIndex)},[w]);const se=H.useCallback(ce=>{ce&&U.current===!0&&(ne(),Z==null||Z(),U.current=!1)},[ne,Z]);return u.jsx(OLe,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:F,onScrollButtonChange:se,children:u.jsx("div",{ref:_,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ae},children:u.jsx(gi.div,{...a,ref:E,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});ste.displayName=MLe;var jLe="SelectPopperPosition",YI=H.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=wh,...l}=e,f=uC(r);return u.jsx(oP,{...f,...l,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});YI.displayName=jLe;var[OLe,JL]=N_(Uv,{}),XI="SelectViewport",ote=H.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,l=sy(XI,r),f=JL(XI,r),i=Xi(t,l.onViewportChange),_=H.useRef(0);return u.jsxs(u.Fragment,{children:[u.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),u.jsx(lC.Slot,{scope:r,children:u.jsx(gi.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:on(a.onScroll,w=>{const A=w.currentTarget,{contentWrapper:E,shouldExpandOnScrollRef:O}=f;if(O!=null&&O.current&&E){const F=Math.abs(_.current-A.scrollTop);if(F>0){const U=window.innerHeight-wh*2,B=parseFloat(E.style.minHeight),q=parseFloat(E.style.height),W=Math.max(B,q);if(W<U){const Z=W+F,ne=Math.min(U,Z),ae=Z-ne;E.style.height=ne+"px",E.style.bottom==="0px"&&(A.scrollTop=ae>0?ae:0,E.style.justifyContent="flex-end")}}}_.current=A.scrollTop})})})]})});ote.displayName=XI;var lte="SelectGroup",[NLe,RLe]=N_(lte),cte=H.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Sd();return u.jsx(NLe,{scope:r,id:a,children:u.jsx(gi.div,{role:"group","aria-labelledby":a,...n,ref:t})})});cte.displayName=lte;var ute="SelectLabel",dte=H.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=RLe(ute,r);return u.jsx(gi.div,{id:a.id,...n,ref:t})});dte.displayName=ute;var KT="SelectItem",[ILe,hte]=N_(KT),fte=H.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:l,...f}=e,i=ay(KT,r),_=sy(KT,r),w=i.value===n,[A,E]=H.useState(l??""),[O,F]=H.useState(!1),U=Xi(t,Z=>{var ne;return(ne=_.itemRefCallback)==null?void 0:ne.call(_,Z,n,a)}),B=Sd(),q=H.useRef("touch"),W=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return u.jsx(ILe,{scope:r,value:n,disabled:a,textId:B,isSelected:w,onItemTextChange:H.useCallback(Z=>{E(ne=>ne||((Z==null?void 0:Z.textContent)??"").trim())},[]),children:u.jsx(lC.ItemSlot,{scope:r,value:n,disabled:a,textValue:A,children:u.jsx(gi.div,{role:"option","aria-labelledby":B,"data-highlighted":O?"":void 0,"aria-selected":w&&O,"data-state":w?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...f,ref:U,onFocus:on(f.onFocus,()=>F(!0)),onBlur:on(f.onBlur,()=>F(!1)),onClick:on(f.onClick,()=>{q.current!=="mouse"&&W()}),onPointerUp:on(f.onPointerUp,()=>{q.current==="mouse"&&W()}),onPointerDown:on(f.onPointerDown,Z=>{q.current=Z.pointerType}),onPointerMove:on(f.onPointerMove,Z=>{var ne;q.current=Z.pointerType,a?(ne=_.onItemLeave)==null||ne.call(_):q.current==="mouse"&&Z.currentTarget.focus({preventScroll:!0})}),onPointerLeave:on(f.onPointerLeave,Z=>{var ne;Z.currentTarget===document.activeElement&&((ne=_.onItemLeave)==null||ne.call(_))}),onKeyDown:on(f.onKeyDown,Z=>{var ae;((ae=_.searchRef)==null?void 0:ae.current)!==""&&Z.key===" "||(wLe.includes(Z.key)&&W(),Z.key===" "&&Z.preventDefault())})})})})});fte.displayName=KT;var t1="SelectItemText",pte=H.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...l}=e,f=ay(t1,r),i=sy(t1,r),_=hte(t1,r),w=PLe(t1,r),[A,E]=H.useState(null),O=Xi(t,W=>E(W),_.onItemTextChange,W=>{var Z;return(Z=i.itemTextRefCallback)==null?void 0:Z.call(i,W,_.value,_.disabled)}),F=A==null?void 0:A.textContent,U=H.useMemo(()=>u.jsx("option",{value:_.value,disabled:_.disabled,children:F},_.value),[_.disabled,_.value,F]),{onNativeOptionAdd:B,onNativeOptionRemove:q}=w;return nl(()=>(B(U),()=>q(U)),[B,q,U]),u.jsxs(u.Fragment,{children:[u.jsx(gi.span,{id:_.textId,...l,ref:O}),_.isSelected&&f.valueNode&&!f.valueNodeHasChildren?Ow.createPortal(l.children,f.valueNode):null]})});pte.displayName=t1;var mte="SelectItemIndicator",gte=H.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return hte(mte,r).isSelected?u.jsx(gi.span,{"aria-hidden":!0,...n,ref:t}):null});gte.displayName=mte;var JI="SelectScrollUpButton",yte=H.forwardRef((e,t)=>{const r=sy(JI,e.__scopeSelect),n=JL(JI,e.__scopeSelect),[a,l]=H.useState(!1),f=Xi(t,n.onScrollButtonChange);return nl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=_.scrollTop>0;l(w)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?u.jsx(xte,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop-_.offsetHeight)}}):null});yte.displayName=JI;var QI="SelectScrollDownButton",vte=H.forwardRef((e,t)=>{const r=sy(QI,e.__scopeSelect),n=JL(QI,e.__scopeSelect),[a,l]=H.useState(!1),f=Xi(t,n.onScrollButtonChange);return nl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=_.scrollHeight-_.clientHeight,A=Math.ceil(_.scrollTop)<w;l(A)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?u.jsx(xte,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop+_.offsetHeight)}}):null});vte.displayName=QI;var xte=H.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,l=sy("SelectScrollButton",r),f=H.useRef(null),i=cC(r),_=H.useCallback(()=>{f.current!==null&&(window.clearInterval(f.current),f.current=null)},[]);return H.useEffect(()=>()=>_(),[_]),nl(()=>{var A;const w=i().find(E=>E.ref.current===document.activeElement);(A=w==null?void 0:w.ref.current)==null||A.scrollIntoView({block:"nearest"})},[i]),u.jsx(gi.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:on(a.onPointerDown,()=>{f.current===null&&(f.current=window.setInterval(n,50))}),onPointerMove:on(a.onPointerMove,()=>{var w;(w=l.onItemLeave)==null||w.call(l),f.current===null&&(f.current=window.setInterval(n,50))}),onPointerLeave:on(a.onPointerLeave,()=>{_()})})}),DLe="SelectSeparator",_te=H.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return u.jsx(gi.div,{"aria-hidden":!0,...n,ref:t})});_te.displayName=DLe;var e3="SelectArrow",LLe=H.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=uC(r),l=ay(e3,r),f=sy(e3,r);return l.open&&f.position==="popper"?u.jsx(lP,{...a,...n,ref:t}):null});LLe.displayName=e3;function bte(e){return e===""||e===void 0}var wte=H.forwardRef((e,t)=>{const{value:r,...n}=e,a=H.useRef(null),l=Xi(t,a),f=vLe(r);return H.useEffect(()=>{const i=a.current,_=window.HTMLSelectElement.prototype,A=Object.getOwnPropertyDescriptor(_,"value").set;if(f!==r&&A){const E=new Event("change",{bubbles:!0});A.call(i,r),i.dispatchEvent(E)}},[f,r]),u.jsx(XL,{asChild:!0,children:u.jsx("select",{...n,ref:l,defaultValue:r})})});wte.displayName="BubbleSelect";function Ste(e){const t=Au(e),r=H.useRef(""),n=H.useRef(0),a=H.useCallback(f=>{const i=r.current+f;t(i),function _(w){r.current=w,window.clearTimeout(n.current),w!==""&&(n.current=window.setTimeout(()=>_(""),1e3))}(i)},[t]),l=H.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return H.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,l]}function Ate(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let f=zLe(e,Math.max(l,0));a.length===1&&(f=f.filter(w=>w!==r));const _=f.find(w=>w.textValue.toLowerCase().startsWith(a.toLowerCase()));return _!==r?_:void 0}function zLe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var FLe=Yee,Tte=Jee,BLe=ete,VLe=tte,ULe=rte,Pte=nte,$Le=ote,qLe=cte,Cte=dte,Ete=fte,GLe=pte,WLe=gte,kte=yte,Mte=vte,jte=_te;const Io=FLe,t3=qLe,Do=BLe,mo=H.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(Tte,{ref:n,className:Wt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,u.jsx(VLe,{asChild:!0,children:u.jsx(CW,{className:"h-4 w-4 opacity-50"})})]}));mo.displayName=Tte.displayName;const Ote=H.forwardRef(({className:e,...t},r)=>u.jsx(kte,{ref:r,className:Wt("flex cursor-default items-center justify-center py-1",e),...t,children:u.jsx(Fce,{className:"h-4 w-4"})}));Ote.displayName=kte.displayName;const Nte=H.forwardRef(({className:e,...t},r)=>u.jsx(Mte,{ref:r,className:Wt("flex cursor-default items-center justify-center py-1",e),...t,children:u.jsx(CW,{className:"h-4 w-4"})}));Nte.displayName=Mte.displayName;const go=H.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>u.jsx(ULe,{children:u.jsxs(Pte,{ref:a,className:Wt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[u.jsx(Ote,{}),u.jsx($Le,{className:Wt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),u.jsx(Nte,{})]})}));go.displayName=Pte.displayName;const r3=H.forwardRef(({className:e,...t},r)=>u.jsx(Cte,{ref:r,className:Wt("px-2 py-1.5 text-sm font-semibold",e),...t}));r3.displayName=Cte.displayName;const _n=H.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(Ete,{ref:n,className:Wt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[u.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(WLe,{children:u.jsx(PW,{className:"h-4 w-4"})})}),u.jsx(GLe,{children:t})]}));_n.displayName=Ete.displayName;const HLe=H.forwardRef(({className:e,...t},r)=>u.jsx(jte,{ref:r,className:Wt("-mx-1 my-1 h-px bg-muted",e),...t}));HLe.displayName=jte.displayName;const wi=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("rounded-xl md:border bg-card text-card-foreground md:shadow",e),...t}));wi.displayName="Card";const Ii=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("flex flex-col space-y-1.5 p-6",e),...t}));Ii.displayName="CardHeader";const Di=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("font-semibold leading-none tracking-tight",e),...t}));Di.displayName="CardTitle";const ls=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("text-sm text-muted-foreground",e),...t}));ls.displayName="CardDescription";const Ei=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("p-6 pt-0",e),...t}));Ei.displayName="CardContent";const dC=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:Wt("flex items-center p-6 pt-0",e),...t}));dC.displayName="CardFooter";const KLe={light:"",dark:".dark"},Rte=H.createContext(null);function Ite(){const e=H.useContext(Rte);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const Dte=H.forwardRef(({id:e,className:t,children:r,config:n,...a},l)=>{const f=H.useId(),i=`chart-${e||f.replace(/:/g,"")}`;return u.jsx(Rte.Provider,{value:{config:n},children:u.jsxs("div",{"data-chart":i,ref:l,className:Wt("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[u.jsx(ZLe,{id:i,config:n}),u.jsx(No,{children:r})]})})});Dte.displayName="Chart";const ZLe=({id:e,config:t})=>{const r=Object.entries(t).filter(([,n])=>n.theme||n.color);return r.length?u.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(KLe).map(([n,a])=>`
${a} [data-chart=${e}] {
${r.map(([l,f])=>{var _;const i=((_=f.theme)==null?void 0:_[n])||f.color;return i?`  --color-${l}: ${i};`:null}).join(`
`)}
}
`).join(`
`)}}):null},YLe=aa,Lte=H.forwardRef(({active:e,payload:t,className:r,indicator:n="dot",hideLabel:a=!1,hideIndicator:l=!1,label:f,labelFormatter:i,labelClassName:_,formatter:w,color:A,nameKey:E,labelKey:O},F)=>{const{config:U}=Ite(),B=H.useMemo(()=>{var ee;if(a||!(t!=null&&t.length))return null;const[W]=t,Z=`${O||(W==null?void 0:W.dataKey)||(W==null?void 0:W.name)||"value"}`,ne=n3(U,W,Z),ae=!O&&typeof f=="string"?((ee=U[f])==null?void 0:ee.label)||f:ne==null?void 0:ne.label;return i?u.jsx("div",{className:Wt("font-medium",_),children:i(ae,t)}):ae?u.jsx("div",{className:Wt("font-medium",_),children:ae}):null},[f,i,t,a,_,U,O]);if(!e||!(t!=null&&t.length))return null;const q=t.length===1&&n!=="dot";return u.jsxs("div",{ref:F,className:Wt("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[q?null:B,u.jsx("div",{className:"grid gap-1.5",children:t.map((W,Z)=>{const ne=`${E||W.name||W.dataKey||"value"}`,ae=n3(U,W,ne),ee=A||W.payload.fill||W.color;return u.jsx("div",{className:Wt("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:w&&(W==null?void 0:W.value)!==void 0&&W.name?w(W.value,W.name,W,Z,W.payload):u.jsxs(u.Fragment,{children:[ae!=null&&ae.icon?u.jsx(ae.icon,{}):!l&&u.jsx("div",{className:Wt("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":q&&n==="dashed"}),style:{"--color-bg":ee,"--color-border":ee}}),u.jsxs("div",{className:Wt("flex flex-1 justify-between leading-none",q?"items-end":"items-center"),children:[u.jsxs("div",{className:"grid gap-1.5",children:[q?B:null,u.jsx("span",{className:"text-muted-foreground",children:(ae==null?void 0:ae.label)||W.name})]}),W.value&&u.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:W.value.toLocaleString()})]})]})},W.dataKey)})})]})});Lte.displayName="ChartTooltip";const XLe=H.forwardRef(({className:e,hideIcon:t=!1,payload:r,verticalAlign:n="bottom",nameKey:a},l)=>{const{config:f}=Ite();return r!=null&&r.length?u.jsx("div",{ref:l,className:Wt("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",e),children:r.map(i=>{const _=`${a||i.dataKey||"value"}`,w=n3(f,i,_);return u.jsxs("div",{className:Wt("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[w!=null&&w.icon&&!t?u.jsx(w.icon,{}):u.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:i.color}}),w==null?void 0:w.label]},i.value)})}):null});XLe.displayName="ChartLegend";function n3(e,t,r){if(typeof t!="object"||t===null)return;const n="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=r;return r in t&&typeof t[r]=="string"?a=t[r]:n&&r in n&&typeof n[r]=="string"&&(a=n[r]),a in e?e[a]:e[r]}const NG={views:{label:"Page Views"},violations:{label:"Violations",color:"hsl(var(--chart-1))"},accidents:{label:"Accidents",color:"hsl(var(--chart-2))"}};function JLe(){const[e,t]=H.useState("violations"),[r,n]=H.useState("all"),[a,l]=H.useState([]),[f,i]=H.useState(!0),[_,w]=H.useState(null),A=la(),{token:E}=A||{};H.useEffect(()=>{O()},[r]);const O=async()=>{try{i(!0),w(null);const{data:B}=await Wn.get(`/dashboard/chart?period=${r}`,{headers:{Authorization:E}});if(B.success){const q=B.data.chartData.map(W=>{let Z="";return r==="week"?Z=`${W.year}-${String(W.month).padStart(2,"0")}-${String(W.day).padStart(2,"0")}`:r==="years"?Z=`${W.year}-01-01`:Z=`${W.year}-${String(W.month).padStart(2,"0")}-01`,{date:Z,violations:W.violations||0,accidents:W.accidents||0}});l(q)}}catch(B){console.error("Error fetching chart data:",B),w("Failed to load chart data")}finally{i(!1)}},F=H.useMemo(()=>({violations:a.reduce((B,q)=>B+q.violations,0),accidents:a.reduce((B,q)=>B+q.accidents,0)}),[a]),U=B=>{switch(B){case"week":return"Last Week";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"months":return"Last 12 Months";case"year":return"Last Year";case"years":return"Last 5 Years";case"all":return"All Time";default:return"All Time"}};return u.jsxs(wi,{className:"md:shadow-none border",children:[u.jsxs(Ii,{className:"flex flex-col items-stretch space-y-0 border-b p-0 sm:flex-row",children:[u.jsxs("div",{className:"flex flex-1 flex-col justify-center gap-1 px-6 py-5 sm:py-6",children:[u.jsx(Di,{children:"Violation & Accidents Overview"}),u.jsxs(ls,{children:["Showing violation and accident frequency for ",U(r)]}),u.jsx("div",{className:"mt-2",children:u.jsxs(Io,{value:r,onValueChange:n,children:[u.jsx(mo,{className:"w-[180px]",children:u.jsx(Do,{placeholder:"Select time period"})}),u.jsxs(go,{children:[u.jsx(_n,{value:"week",children:"Last Week"}),u.jsx(_n,{value:"3months",children:"Last 3 Months"}),u.jsx(_n,{value:"6months",children:"Last 6 Months"}),u.jsx(_n,{value:"months",children:"Last 12 Months"}),u.jsx(_n,{value:"year",children:"Last Year"}),u.jsx(_n,{value:"years",children:"Last 5 Years"}),u.jsx(_n,{value:"all",children:"All Time"})]})]})})]}),u.jsx("div",{className:"flex",children:["violations","accidents"].map(B=>u.jsxs("button",{"data-active":e===B,className:"relative z-30 flex flex-1 flex-col justify-center gap-1 border-t px-6 py-4 text-left even:border-l data-[active=true]:bg-muted/50 sm:border-l sm:border-t-0 sm:px-8 sm:py-6",onClick:()=>t(B),children:[u.jsx("span",{className:"text-xs text-muted-foreground",children:NG[B].label}),u.jsx("span",{className:"text-lg font-bold leading-none sm:text-3xl",children:f?"...":F[B].toLocaleString()})]},B))})]}),u.jsx(Ei,{className:"px-2 sm:p-6",children:f?u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),u.jsx("div",{className:"h-[250px] bg-muted rounded"})]}):_?u.jsx("div",{className:"flex items-center justify-center h-[250px]",children:u.jsx("div",{className:"text-red-500",children:_})}):a.length===0?u.jsx("div",{className:"flex items-center justify-center h-[250px]",children:u.jsx("div",{className:"text-muted-foreground",children:"No data available for the selected period"})}):u.jsx(Dte,{config:NG,className:"aspect-auto h-[250px] w-full",children:u.jsxs(_d,{accessibilityLayer:!0,data:a,margin:{left:12,right:12},children:[u.jsx(Xs,{vertical:!1}),u.jsx(La,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:B=>{const q=new Date(B);return r==="week"?q.toLocaleDateString("en-US",{month:"short",day:"numeric"}):r==="years"?q.toLocaleDateString("en-US",{year:"numeric"}):q.toLocaleDateString("en-US",{month:"short",year:"numeric"})}}),u.jsx(YLe,{content:u.jsx(Lte,{className:"w-[150px]",nameKey:"views",labelFormatter:B=>{const q=new Date(B);return r==="week"?q.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):r==="years"?q.toLocaleDateString("en-US",{year:"numeric"}):q.toLocaleDateString("en-US",{month:"short",year:"numeric"})}})}),u.jsx(xs,{dataKey:e,fill:`var(--color-${e})`})]})})})]})}function ea(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Cu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ic(e,t){const r=ea(e);return isNaN(t)?Cu(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Fh(e,t){const r=ea(e);if(isNaN(t))return Cu(e,NaN);if(!t)return r;const n=r.getDate(),a=Cu(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const l=a.getDate();return n>=l?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const QL=6048e5,QLe=864e5;let e4e={};function f2(){return e4e}function ep(e,t){var i,_,w,A;const r=f2(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.weekStartsOn)??0,a=ea(e),l=a.getDay(),f=(l<n?7:0)+l-n;return a.setDate(a.getDate()-f),a.setHours(0,0,0,0),a}function $v(e){return ep(e,{weekStartsOn:1})}function zte(e){const t=ea(e),r=t.getFullYear(),n=Cu(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=$v(n),l=Cu(e,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const f=$v(l);return t.getTime()>=a.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function s_(e){const t=ea(e);return t.setHours(0,0,0,0),t}function ZT(e){const t=ea(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Df(e,t){const r=s_(e),n=s_(t),a=+r-ZT(r),l=+n-ZT(n);return Math.round((a-l)/QLe)}function t4e(e){const t=zte(e),r=Cu(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),$v(r)}function i3(e,t){const r=t*7;return ic(e,r)}function r4e(e,t){return Fh(e,t*12)}function n4e(e){let t;return e.forEach(function(r){const n=ea(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function i4e(e){let t;return e.forEach(r=>{const n=ea(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function Ic(e,t){const r=s_(e),n=s_(t);return+r==+n}function e4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function a4e(e){if(!e4(e)&&typeof e!="number")return!1;const t=ea(e);return!isNaN(Number(t))}function Mw(e,t){const r=ea(e),n=ea(t),a=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return a*12+l}function s4e(e,t,r){const n=ep(e,r),a=ep(t,r),l=+n-ZT(n),f=+a-ZT(a);return Math.round((l-f)/QL)}function t4(e){const t=ea(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Lc(e){const t=ea(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Fte(e){const t=ea(e),r=Cu(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function r4(e,t){var i,_,w,A;const r=f2(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.weekStartsOn)??0,a=ea(e),l=a.getDay(),f=(l<n?-7:0)+6-(l-n);return a.setDate(a.getDate()+f),a.setHours(23,59,59,999),a}function Bte(e){return r4(e,{weekStartsOn:1})}const o4e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},l4e=(e,t,r)=>{let n;const a=o4e[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function gN(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const c4e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},u4e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},d4e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},h4e={date:gN({formats:c4e,defaultWidth:"full"}),time:gN({formats:u4e,defaultWidth:"full"}),dateTime:gN({formats:d4e,defaultWidth:"full"})},f4e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},p4e=(e,t,r,n)=>f4e[e];function $b(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const f=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):f;a=e.formattingValues[i]||e.formattingValues[f]}else{const f=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[i]||e.values[f]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const m4e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},g4e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},y4e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},v4e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},x4e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_4e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},b4e=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},w4e={ordinalNumber:b4e,era:$b({values:m4e,defaultWidth:"wide"}),quarter:$b({values:g4e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:$b({values:y4e,defaultWidth:"wide"}),day:$b({values:v4e,defaultWidth:"wide"}),dayPeriod:$b({values:x4e,defaultWidth:"wide",formattingValues:_4e,defaultFormattingWidth:"wide"})};function qb(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const f=l[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],_=Array.isArray(i)?A4e(i,E=>E.test(f)):S4e(i,E=>E.test(f));let w;w=e.valueCallback?e.valueCallback(_):_,w=r.valueCallback?r.valueCallback(w):w;const A=t.slice(f.length);return{value:w,rest:A}}}function S4e(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function A4e(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function T4e(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],l=t.match(e.parsePattern);if(!l)return null;let f=e.valueCallback?e.valueCallback(l[0]):l[0];f=r.valueCallback?r.valueCallback(f):f;const i=t.slice(a.length);return{value:f,rest:i}}}const P4e=/^(\d+)(th|st|nd|rd)?/i,C4e=/\d+/i,E4e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},k4e={any:[/^b/i,/^(a|c)/i]},M4e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},j4e={any:[/1/i,/2/i,/3/i,/4/i]},O4e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},N4e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},R4e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},I4e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},D4e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},L4e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},z4e={ordinalNumber:T4e({matchPattern:P4e,parsePattern:C4e,valueCallback:e=>parseInt(e,10)}),era:qb({matchPatterns:E4e,defaultMatchWidth:"wide",parsePatterns:k4e,defaultParseWidth:"any"}),quarter:qb({matchPatterns:M4e,defaultMatchWidth:"wide",parsePatterns:j4e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qb({matchPatterns:O4e,defaultMatchWidth:"wide",parsePatterns:N4e,defaultParseWidth:"any"}),day:qb({matchPatterns:R4e,defaultMatchWidth:"wide",parsePatterns:I4e,defaultParseWidth:"any"}),dayPeriod:qb({matchPatterns:D4e,defaultMatchWidth:"any",parsePatterns:L4e,defaultParseWidth:"any"})},Vte={code:"en-US",formatDistance:l4e,formatLong:h4e,formatRelative:p4e,localize:w4e,match:z4e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function F4e(e){const t=ea(e);return Df(t,Fte(t))+1}function Ute(e){const t=ea(e),r=+$v(t)-+t4e(t);return Math.round(r/QL)+1}function $te(e,t){var A,E,O,F;const r=ea(e),n=r.getFullYear(),a=f2(),l=(t==null?void 0:t.firstWeekContainsDate)??((E=(A=t==null?void 0:t.locale)==null?void 0:A.options)==null?void 0:E.firstWeekContainsDate)??a.firstWeekContainsDate??((F=(O=a.locale)==null?void 0:O.options)==null?void 0:F.firstWeekContainsDate)??1,f=Cu(e,0);f.setFullYear(n+1,0,l),f.setHours(0,0,0,0);const i=ep(f,t),_=Cu(e,0);_.setFullYear(n,0,l),_.setHours(0,0,0,0);const w=ep(_,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=w.getTime()?n:n-1}function B4e(e,t){var i,_,w,A;const r=f2(),n=(t==null?void 0:t.firstWeekContainsDate)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.firstWeekContainsDate)??r.firstWeekContainsDate??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.firstWeekContainsDate)??1,a=$te(e,t),l=Cu(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),ep(l,t)}function qte(e,t){const r=ea(e),n=+ep(r,t)-+B4e(r,t);return Math.round(n/QL)+1}function Sa(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const wg={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Sa(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Sa(r+1,2)},d(e,t){return Sa(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Sa(e.getHours()%12||12,t.length)},H(e,t){return Sa(e.getHours(),t.length)},m(e,t){return Sa(e.getMinutes(),t.length)},s(e,t){return Sa(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Sa(a,t.length)}},Q0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},RG={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return wg.y(e,t)},Y:function(e,t,r,n){const a=$te(e,n),l=a>0?a:1-a;if(t==="YY"){const f=l%100;return Sa(f,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):Sa(l,t.length)},R:function(e,t){const r=zte(e);return Sa(r,t.length)},u:function(e,t){const r=e.getFullYear();return Sa(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Sa(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Sa(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return wg.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Sa(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=qte(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Sa(a,t.length)},I:function(e,t,r){const n=Ute(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Sa(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):wg.d(e,t)},D:function(e,t,r){const n=F4e(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Sa(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return Sa(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return Sa(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Sa(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Q0.noon:n===0?a=Q0.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Q0.evening:n>=12?a=Q0.afternoon:n>=4?a=Q0.morning:a=Q0.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return wg.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):wg.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Sa(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Sa(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):wg.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):wg.s(e,t)},S:function(e,t){return wg.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return DG(n);case"XXXX":case"XX":return dv(n);case"XXXXX":case"XXX":default:return dv(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return DG(n);case"xxxx":case"xx":return dv(n);case"xxxxx":case"xxx":default:return dv(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+IG(n,":");case"OOOO":default:return"GMT"+dv(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+IG(n,":");case"zzzz":default:return"GMT"+dv(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Sa(n,t.length)},T:function(e,t,r){const n=e.getTime();return Sa(n,t.length)}};function IG(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?r+String(a):r+String(a)+t+Sa(l,2)}function DG(e,t){return e%60===0?(e>0?"-":"+")+Sa(Math.abs(e)/60,2):dv(e,t)}function dv(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Sa(Math.trunc(n/60),2),l=Sa(n%60,2);return r+a+t+l}const LG=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Gte=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},V4e=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return LG(e,t);let l;switch(n){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",LG(n,t)).replace("{{time}}",Gte(a,t))},U4e={p:Gte,P:V4e},$4e=/^D+$/,q4e=/^Y+$/,G4e=["D","DD","YY","YYYY"];function W4e(e){return $4e.test(e)}function H4e(e){return q4e.test(e)}function K4e(e,t,r){const n=Z4e(e,t,r);if(console.warn(n),G4e.includes(e))throw new RangeError(n)}function Z4e(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Y4e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,X4e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,J4e=/^'([^]*?)'?$/,Q4e=/''/g,eze=/[a-zA-Z]/;function Fc(e,t,r){var A,E,O,F,U,B,q,W;const n=f2(),a=(r==null?void 0:r.locale)??n.locale??Vte,l=(r==null?void 0:r.firstWeekContainsDate)??((E=(A=r==null?void 0:r.locale)==null?void 0:A.options)==null?void 0:E.firstWeekContainsDate)??n.firstWeekContainsDate??((F=(O=n.locale)==null?void 0:O.options)==null?void 0:F.firstWeekContainsDate)??1,f=(r==null?void 0:r.weekStartsOn)??((B=(U=r==null?void 0:r.locale)==null?void 0:U.options)==null?void 0:B.weekStartsOn)??n.weekStartsOn??((W=(q=n.locale)==null?void 0:q.options)==null?void 0:W.weekStartsOn)??0,i=ea(e);if(!a4e(i))throw new RangeError("Invalid time value");let _=t.match(X4e).map(Z=>{const ne=Z[0];if(ne==="p"||ne==="P"){const ae=U4e[ne];return ae(Z,a.formatLong)}return Z}).join("").match(Y4e).map(Z=>{if(Z==="''")return{isToken:!1,value:"'"};const ne=Z[0];if(ne==="'")return{isToken:!1,value:tze(Z)};if(RG[ne])return{isToken:!0,value:Z};if(ne.match(eze))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ne+"`");return{isToken:!1,value:Z}});a.localize.preprocessor&&(_=a.localize.preprocessor(i,_));const w={firstWeekContainsDate:l,weekStartsOn:f,locale:a};return _.map(Z=>{if(!Z.isToken)return Z.value;const ne=Z.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&H4e(ne)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&W4e(ne))&&K4e(ne,t,String(e));const ae=RG[ne[0]];return ae(i,ne,a.localize,w)}).join("")}function tze(e){const t=e.match(J4e);return t?t[1].replace(Q4e,"'"):e}function rze(e){const t=ea(e),r=t.getFullYear(),n=t.getMonth(),a=Cu(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function nze(e){return Math.trunc(+ea(e)/1e3)}function ize(e){const t=ea(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function aze(e,t){return s4e(ize(e),Lc(e),t)+1}function a3(e,t){const r=ea(e),n=ea(t);return r.getTime()>n.getTime()}function Wte(e,t){const r=ea(e),n=ea(t);return+r<+n}function n4(e,t){const r=ea(e),n=ea(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function sze(e,t){const r=ea(e),n=ea(t);return r.getFullYear()===n.getFullYear()}function yN(e,t){return ic(e,-t)}function dA(e,t){const r=ea(e),n=r.getFullYear(),a=r.getDate(),l=Cu(e,0);l.setFullYear(n,t,15),l.setHours(0,0,0,0);const f=rze(l);return r.setMonth(t,Math.min(a,f)),r}function s3(e,t){const r=ea(e);return isNaN(+r)?Cu(e,NaN):(r.setFullYear(t),r)}var ci=function(){return ci=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},ci.apply(this,arguments)};function oze(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Hte(e,t,r){for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}function p2(e){return e.mode==="multiple"}function m2(e){return e.mode==="range"}function hC(e){return e.mode==="single"}var lze={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function cze(e,t){return Fc(e,"LLLL y",t)}function uze(e,t){return Fc(e,"d",t)}function dze(e,t){return Fc(e,"LLLL",t)}function hze(e){return"".concat(e)}function fze(e,t){return Fc(e,"cccccc",t)}function pze(e,t){return Fc(e,"yyyy",t)}var mze=Object.freeze({__proto__:null,formatCaption:cze,formatDay:uze,formatMonthCaption:dze,formatWeekNumber:hze,formatWeekdayName:fze,formatYearCaption:pze}),gze=function(e,t,r){return Fc(e,"do MMMM (EEEE)",r)},yze=function(){return"Month: "},vze=function(){return"Go to next month"},xze=function(){return"Go to previous month"},_ze=function(e,t){return Fc(e,"cccc",t)},bze=function(e){return"Week n. ".concat(e)},wze=function(){return"Year: "},Sze=Object.freeze({__proto__:null,labelDay:gze,labelMonthDropdown:yze,labelNext:vze,labelPrevious:xze,labelWeekNumber:bze,labelWeekday:_ze,labelYearDropdown:wze});function Aze(){var e="buttons",t=lze,r=Vte,n={},a={},l=1,f={},i=new Date;return{captionLayout:e,classNames:t,formatters:mze,labels:Sze,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:l,styles:f,today:i,mode:"default"}}function Tze(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,l=e.fromDate,f=e.toDate;return n?l=Lc(n):t&&(l=new Date(t,0,1)),a?f=t4(a):r&&(f=new Date(r,11,31)),{fromDate:l?s_(l):void 0,toDate:f?s_(f):void 0}}var Kte=H.createContext(void 0);function Pze(e){var t,r=e.initialProps,n=Aze(),a=Tze(r),l=a.fromDate,f=a.toDate,i=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;i!=="buttons"&&(!l||!f)&&(i="buttons");var _;(hC(r)||p2(r)||m2(r))&&(_=r.onSelect);var w=ci(ci(ci({},n),r),{captionLayout:i,classNames:ci(ci({},n.classNames),r.classNames),components:ci({},r.components),formatters:ci(ci({},n.formatters),r.formatters),fromDate:l,labels:ci(ci({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:ci(ci({},n.modifiers),r.modifiers),modifiersClassNames:ci(ci({},n.modifiersClassNames),r.modifiersClassNames),onSelect:_,styles:ci(ci({},n.styles),r.styles),toDate:f});return u.jsx(Kte.Provider,{value:w,children:e.children})}function Ja(){var e=H.useContext(Kte);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Zte(e){var t=Ja(),r=t.locale,n=t.classNames,a=t.styles,l=t.formatters.formatCaption;return u.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:l(e.displayMonth,{locale:r})})}function Cze(e){return u.jsx("svg",ci({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:u.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Yte(e){var t,r,n=e.onChange,a=e.value,l=e.children,f=e.caption,i=e.className,_=e.style,w=Ja(),A=(r=(t=w.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Cze;return u.jsxs("div",{className:i,style:_,children:[u.jsx("span",{className:w.classNames.vhidden,children:e["aria-label"]}),u.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:w.classNames.dropdown,style:w.styles.dropdown,value:a,onChange:n,children:l}),u.jsxs("div",{className:w.classNames.caption_label,style:w.styles.caption_label,"aria-hidden":"true",children:[f,u.jsx(A,{className:w.classNames.dropdown_icon,style:w.styles.dropdown_icon})]})]})}function Eze(e){var t,r=Ja(),n=r.fromDate,a=r.toDate,l=r.styles,f=r.locale,i=r.formatters.formatMonthCaption,_=r.classNames,w=r.components,A=r.labels.labelMonthDropdown;if(!n)return u.jsx(u.Fragment,{});if(!a)return u.jsx(u.Fragment,{});var E=[];if(sze(n,a))for(var O=Lc(n),F=n.getMonth();F<=a.getMonth();F++)E.push(dA(O,F));else for(var O=Lc(new Date),F=0;F<=11;F++)E.push(dA(O,F));var U=function(q){var W=Number(q.target.value),Z=dA(Lc(e.displayMonth),W);e.onChange(Z)},B=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:Yte;return u.jsx(B,{name:"months","aria-label":A(),className:_.dropdown_month,style:l.dropdown_month,onChange:U,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:f}),children:E.map(function(q){return u.jsx("option",{value:q.getMonth(),children:i(q,{locale:f})},q.getMonth())})})}function kze(e){var t,r=e.displayMonth,n=Ja(),a=n.fromDate,l=n.toDate,f=n.locale,i=n.styles,_=n.classNames,w=n.components,A=n.formatters.formatYearCaption,E=n.labels.labelYearDropdown,O=[];if(!a)return u.jsx(u.Fragment,{});if(!l)return u.jsx(u.Fragment,{});for(var F=a.getFullYear(),U=l.getFullYear(),B=F;B<=U;B++)O.push(s3(Fte(new Date),B));var q=function(Z){var ne=s3(Lc(r),Number(Z.target.value));e.onChange(ne)},W=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:Yte;return u.jsx(W,{name:"years","aria-label":E(),className:_.dropdown_year,style:i.dropdown_year,onChange:q,value:r.getFullYear(),caption:A(r,{locale:f}),children:O.map(function(Z){return u.jsx("option",{value:Z.getFullYear(),children:A(Z,{locale:f})},Z.getFullYear())})})}function Mze(e,t){var r=H.useState(e),n=r[0],a=r[1],l=t===void 0?n:t;return[l,a]}function jze(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,l=e.toDate,f=e.fromDate,i=e.numberOfMonths,_=i===void 0?1:i;if(l&&Mw(l,a)<0){var w=-1*(_-1);a=Fh(l,w)}return f&&Mw(a,f)<0&&(a=f),Lc(a)}function Oze(){var e=Ja(),t=jze(e),r=Mze(t,e.month),n=r[0],a=r[1],l=function(f){var i;if(!e.disableNavigation){var _=Lc(f);a(_),(i=e.onMonthChange)===null||i===void 0||i.call(e,_)}};return[n,l]}function Nze(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=Lc(e),l=Lc(Fh(a,n)),f=Mw(l,a),i=[],_=0;_<f;_++){var w=Fh(a,_);i.push(w)}return r&&(i=i.reverse()),i}function Rze(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,f=n?l:1,i=Lc(e);if(!r)return Fh(i,f);var _=Mw(r,e);if(!(_<l))return Fh(i,f)}}function Ize(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,f=n?l:1,i=Lc(e);if(!r)return Fh(i,-f);var _=Mw(i,r);if(!(_<=0))return Fh(i,-f)}}var Xte=H.createContext(void 0);function Dze(e){var t=Ja(),r=Oze(),n=r[0],a=r[1],l=Nze(n,t),f=Rze(n,t),i=Ize(n,t),_=function(E){return l.some(function(O){return n4(E,O)})},w=function(E,O){_(E)||(O&&Wte(E,O)?a(Fh(E,1+t.numberOfMonths*-1)):a(E))},A={currentMonth:n,displayMonths:l,goToMonth:a,goToDate:w,previousMonth:i,nextMonth:f,isDateDisplayed:_};return u.jsx(Xte.Provider,{value:A,children:e.children})}function g2(){var e=H.useContext(Xte);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function zG(e){var t,r=Ja(),n=r.classNames,a=r.styles,l=r.components,f=g2().goToMonth,i=function(A){f(Fh(A,e.displayIndex?-e.displayIndex:0))},_=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:Zte,w=u.jsx(_,{id:e.id,displayMonth:e.displayMonth});return u.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[u.jsx("div",{className:n.vhidden,children:w}),u.jsx(Eze,{onChange:i,displayMonth:e.displayMonth}),u.jsx(kze,{onChange:i,displayMonth:e.displayMonth})]})}function Lze(e){return u.jsx("svg",ci({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:u.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function zze(e){return u.jsx("svg",ci({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:u.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var YT=H.forwardRef(function(e,t){var r=Ja(),n=r.classNames,a=r.styles,l=[n.button_reset,n.button];e.className&&l.push(e.className);var f=l.join(" "),i=ci(ci({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),u.jsx("button",ci({},e,{ref:t,type:"button",className:f,style:i}))});function Fze(e){var t,r,n=Ja(),a=n.dir,l=n.locale,f=n.classNames,i=n.styles,_=n.labels,w=_.labelPrevious,A=_.labelNext,E=n.components;if(!e.nextMonth&&!e.previousMonth)return u.jsx(u.Fragment,{});var O=w(e.previousMonth,{locale:l}),F=[f.nav_button,f.nav_button_previous].join(" "),U=A(e.nextMonth,{locale:l}),B=[f.nav_button,f.nav_button_next].join(" "),q=(t=E==null?void 0:E.IconRight)!==null&&t!==void 0?t:zze,W=(r=E==null?void 0:E.IconLeft)!==null&&r!==void 0?r:Lze;return u.jsxs("div",{className:f.nav,style:i.nav,children:[!e.hidePrevious&&u.jsx(YT,{name:"previous-month","aria-label":O,className:F,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?u.jsx(q,{className:f.nav_icon,style:i.nav_icon}):u.jsx(W,{className:f.nav_icon,style:i.nav_icon})}),!e.hideNext&&u.jsx(YT,{name:"next-month","aria-label":U,className:B,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?u.jsx(W,{className:f.nav_icon,style:i.nav_icon}):u.jsx(q,{className:f.nav_icon,style:i.nav_icon})})]})}function FG(e){var t=Ja().numberOfMonths,r=g2(),n=r.previousMonth,a=r.nextMonth,l=r.goToMonth,f=r.displayMonths,i=f.findIndex(function(U){return n4(e.displayMonth,U)}),_=i===0,w=i===f.length-1,A=t>1&&(_||!w),E=t>1&&(w||!_),O=function(){n&&l(n)},F=function(){a&&l(a)};return u.jsx(Fze,{displayMonth:e.displayMonth,hideNext:A,hidePrevious:E,nextMonth:a,previousMonth:n,onPreviousClick:O,onNextClick:F})}function Bze(e){var t,r=Ja(),n=r.classNames,a=r.disableNavigation,l=r.styles,f=r.captionLayout,i=r.components,_=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:Zte,w;return a?w=u.jsx(_,{id:e.id,displayMonth:e.displayMonth}):f==="dropdown"?w=u.jsx(zG,{displayMonth:e.displayMonth,id:e.id}):f==="dropdown-buttons"?w=u.jsxs(u.Fragment,{children:[u.jsx(zG,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),u.jsx(FG,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):w=u.jsxs(u.Fragment,{children:[u.jsx(_,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),u.jsx(FG,{displayMonth:e.displayMonth,id:e.id})]}),u.jsx("div",{className:n.caption,style:l.caption,children:w})}function Vze(e){var t=Ja(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?u.jsx("tfoot",{className:a,style:n.tfoot,children:u.jsx("tr",{children:u.jsx("td",{colSpan:8,children:r})})}):u.jsx(u.Fragment,{})}function Uze(e,t,r){for(var n=r?$v(new Date):ep(new Date,{locale:e,weekStartsOn:t}),a=[],l=0;l<7;l++){var f=ic(n,l);a.push(f)}return a}function $ze(){var e=Ja(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,l=e.weekStartsOn,f=e.ISOWeek,i=e.formatters.formatWeekdayName,_=e.labels.labelWeekday,w=Uze(a,l,f);return u.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&u.jsx("td",{style:r.head_cell,className:t.head_cell}),w.map(function(A,E){return u.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":_(A,{locale:a}),children:i(A,{locale:a})},E)})]})}function qze(){var e,t=Ja(),r=t.classNames,n=t.styles,a=t.components,l=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:$ze;return u.jsx("thead",{style:n.head,className:r.head,children:u.jsx(l,{})})}function Gze(e){var t=Ja(),r=t.locale,n=t.formatters.formatDay;return u.jsx(u.Fragment,{children:n(e.date,{locale:r})})}var i4=H.createContext(void 0);function Wze(e){if(!p2(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return u.jsx(i4.Provider,{value:t,children:e.children})}return u.jsx(Hze,{initialProps:e.initialProps,children:e.children})}function Hze(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,l=t.max,f=function(w,A,E){var O,F;(O=t.onDayClick)===null||O===void 0||O.call(t,w,A,E);var U=!!(A.selected&&a&&(n==null?void 0:n.length)===a);if(!U){var B=!!(!A.selected&&l&&(n==null?void 0:n.length)===l);if(!B){var q=n?Hte([],n):[];if(A.selected){var W=q.findIndex(function(Z){return Ic(w,Z)});q.splice(W,1)}else q.push(w);(F=t.onSelect)===null||F===void 0||F.call(t,q,w,A,E)}}},i={disabled:[]};n&&i.disabled.push(function(w){var A=l&&n.length>l-1,E=n.some(function(O){return Ic(O,w)});return!!(A&&!E)});var _={selected:n,onDayClick:f,modifiers:i};return u.jsx(i4.Provider,{value:_,children:r})}function a4(){var e=H.useContext(i4);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Kze(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Ic(a,e)&&Ic(n,e)?void 0:Ic(a,e)?{from:a,to:void 0}:Ic(n,e)?void 0:a3(n,e)?{from:e,to:a}:{from:n,to:e}:a?a3(e,a)?{from:a,to:e}:{from:e,to:a}:n?Wte(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var s4=H.createContext(void 0);function Zze(e){if(!m2(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return u.jsx(s4.Provider,{value:t,children:e.children})}return u.jsx(Yze,{initialProps:e.initialProps,children:e.children})}function Yze(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},l=a.from,f=a.to,i=t.min,_=t.max,w=function(F,U,B){var q,W;(q=t.onDayClick)===null||q===void 0||q.call(t,F,U,B);var Z=Kze(F,n);(W=t.onSelect)===null||W===void 0||W.call(t,Z,F,U,B)},A={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(A.range_start=[l],f?(A.range_end=[f],Ic(l,f)||(A.range_middle=[{after:l,before:f}])):A.range_end=[l]):f&&(A.range_start=[f],A.range_end=[f]),i&&(l&&!f&&A.disabled.push({after:yN(l,i-1),before:ic(l,i-1)}),l&&f&&A.disabled.push({after:l,before:ic(l,i-1)}),!l&&f&&A.disabled.push({after:yN(f,i-1),before:ic(f,i-1)})),_){if(l&&!f&&(A.disabled.push({before:ic(l,-_+1)}),A.disabled.push({after:ic(l,_-1)})),l&&f){var E=Df(f,l)+1,O=_-E;A.disabled.push({before:yN(l,O)}),A.disabled.push({after:ic(f,O)})}!l&&f&&(A.disabled.push({before:ic(f,-_+1)}),A.disabled.push({after:ic(f,_-1)}))}return u.jsx(s4.Provider,{value:{selected:n,onDayClick:w,modifiers:A},children:r})}function o4(){var e=H.useContext(s4);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function hA(e){return Array.isArray(e)?Hte([],e):e!==void 0?[e]:[]}function Xze(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=hA(a)}),t}var Bh;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Bh||(Bh={}));var Jze=Bh.Selected,Yp=Bh.Disabled,Qze=Bh.Hidden,eFe=Bh.Today,vN=Bh.RangeEnd,xN=Bh.RangeMiddle,_N=Bh.RangeStart,tFe=Bh.Outside;function rFe(e,t,r){var n,a=(n={},n[Jze]=hA(e.selected),n[Yp]=hA(e.disabled),n[Qze]=hA(e.hidden),n[eFe]=[e.today],n[vN]=[],n[xN]=[],n[_N]=[],n[tFe]=[],n);return e.fromDate&&a[Yp].push({before:e.fromDate}),e.toDate&&a[Yp].push({after:e.toDate}),p2(e)?a[Yp]=a[Yp].concat(t.modifiers[Yp]):m2(e)&&(a[Yp]=a[Yp].concat(r.modifiers[Yp]),a[_N]=r.modifiers[_N],a[xN]=r.modifiers[xN],a[vN]=r.modifiers[vN]),a}var Jte=H.createContext(void 0);function nFe(e){var t=Ja(),r=a4(),n=o4(),a=rFe(t,r,n),l=Xze(t.modifiers),f=ci(ci({},a),l);return u.jsx(Jte.Provider,{value:f,children:e.children})}function Qte(){var e=H.useContext(Jte);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function iFe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function aFe(e){return!!(e&&typeof e=="object"&&"from"in e)}function sFe(e){return!!(e&&typeof e=="object"&&"after"in e)}function oFe(e){return!!(e&&typeof e=="object"&&"before"in e)}function lFe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function cFe(e,t){var r,n=t.from,a=t.to;if(n&&a){var l=Df(a,n)<0;l&&(r=[a,n],n=r[0],a=r[1]);var f=Df(e,n)>=0&&Df(a,e)>=0;return f}return a?Ic(a,e):n?Ic(n,e):!1}function uFe(e){return e4(e)}function dFe(e){return Array.isArray(e)&&e.every(e4)}function hFe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(uFe(r))return Ic(e,r);if(dFe(r))return r.includes(e);if(aFe(r))return cFe(e,r);if(lFe(r))return r.dayOfWeek.includes(e.getDay());if(iFe(r)){var n=Df(r.before,e),a=Df(r.after,e),l=n>0,f=a<0,i=a3(r.before,r.after);return i?f&&l:l||f}return sFe(r)?Df(e,r.after)>0:oFe(r)?Df(r.before,e)>0:typeof r=="function"?r(e):!1})}function l4(e,t,r){var n=Object.keys(t).reduce(function(l,f){var i=t[f];return hFe(e,i)&&l.push(f),l},[]),a={};return n.forEach(function(l){return a[l]=!0}),r&&!n4(e,r)&&(a.outside=!0),a}function fFe(e,t){for(var r=Lc(e[0]),n=t4(e[e.length-1]),a,l,f=r;f<=n;){var i=l4(f,t),_=!i.disabled&&!i.hidden;if(!_){f=ic(f,1);continue}if(i.selected)return f;i.today&&!l&&(l=f),a||(a=f),f=ic(f,1)}return l||a}var pFe=365;function ere(e,t){var r=t.moveBy,n=t.direction,a=t.context,l=t.modifiers,f=t.retry,i=f===void 0?{count:0,lastFocused:e}:f,_=a.weekStartsOn,w=a.fromDate,A=a.toDate,E=a.locale,O={day:ic,week:i3,month:Fh,year:r4e,startOfWeek:function(q){return a.ISOWeek?$v(q):ep(q,{locale:E,weekStartsOn:_})},endOfWeek:function(q){return a.ISOWeek?Bte(q):r4(q,{locale:E,weekStartsOn:_})}},F=O[r](e,n==="after"?1:-1);n==="before"&&w?F=n4e([w,F]):n==="after"&&A&&(F=i4e([A,F]));var U=!0;if(l){var B=l4(F,l);U=!B.disabled&&!B.hidden}return U?F:i.count>pFe?i.lastFocused:ere(F,{moveBy:r,direction:n,context:a,modifiers:l,retry:ci(ci({},i),{count:i.count+1})})}var tre=H.createContext(void 0);function mFe(e){var t=g2(),r=Qte(),n=H.useState(),a=n[0],l=n[1],f=H.useState(),i=f[0],_=f[1],w=fFe(t.displayMonths,r),A=a??(i&&t.isDateDisplayed(i))?i:w,E=function(){_(a),l(void 0)},O=function(q){l(q)},F=Ja(),U=function(q,W){if(a){var Z=ere(a,{moveBy:q,direction:W,context:F,modifiers:r});Ic(a,Z)||(t.goToDate(Z,a),O(Z))}},B={focusedDay:a,focusTarget:A,blur:E,focus:O,focusDayAfter:function(){return U("day","after")},focusDayBefore:function(){return U("day","before")},focusWeekAfter:function(){return U("week","after")},focusWeekBefore:function(){return U("week","before")},focusMonthBefore:function(){return U("month","before")},focusMonthAfter:function(){return U("month","after")},focusYearBefore:function(){return U("year","before")},focusYearAfter:function(){return U("year","after")},focusStartOfWeek:function(){return U("startOfWeek","before")},focusEndOfWeek:function(){return U("endOfWeek","after")}};return u.jsx(tre.Provider,{value:B,children:e.children})}function c4(){var e=H.useContext(tre);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function gFe(e,t){var r=Qte(),n=l4(e,r,t);return n}var u4=H.createContext(void 0);function yFe(e){if(!hC(e.initialProps)){var t={selected:void 0};return u.jsx(u4.Provider,{value:t,children:e.children})}return u.jsx(vFe,{initialProps:e.initialProps,children:e.children})}function vFe(e){var t=e.initialProps,r=e.children,n=function(l,f,i){var _,w,A;if((_=t.onDayClick)===null||_===void 0||_.call(t,l,f,i),f.selected&&!t.required){(w=t.onSelect)===null||w===void 0||w.call(t,void 0,l,f,i);return}(A=t.onSelect)===null||A===void 0||A.call(t,l,l,f,i)},a={selected:t.selected,onDayClick:n};return u.jsx(u4.Provider,{value:a,children:r})}function rre(){var e=H.useContext(u4);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function xFe(e,t){var r=Ja(),n=rre(),a=a4(),l=o4(),f=c4(),i=f.focusDayAfter,_=f.focusDayBefore,w=f.focusWeekAfter,A=f.focusWeekBefore,E=f.blur,O=f.focus,F=f.focusMonthBefore,U=f.focusMonthAfter,B=f.focusYearBefore,q=f.focusYearAfter,W=f.focusStartOfWeek,Z=f.focusEndOfWeek,ne=function(Oe){var je,Le,ut,ze;hC(r)?(je=n.onDayClick)===null||je===void 0||je.call(n,e,t,Oe):p2(r)?(Le=a.onDayClick)===null||Le===void 0||Le.call(a,e,t,Oe):m2(r)?(ut=l.onDayClick)===null||ut===void 0||ut.call(l,e,t,Oe):(ze=r.onDayClick)===null||ze===void 0||ze.call(r,e,t,Oe)},ae=function(Oe){var je;O(e),(je=r.onDayFocus)===null||je===void 0||je.call(r,e,t,Oe)},ee=function(Oe){var je;E(),(je=r.onDayBlur)===null||je===void 0||je.call(r,e,t,Oe)},se=function(Oe){var je;(je=r.onDayMouseEnter)===null||je===void 0||je.call(r,e,t,Oe)},ce=function(Oe){var je;(je=r.onDayMouseLeave)===null||je===void 0||je.call(r,e,t,Oe)},ge=function(Oe){var je;(je=r.onDayPointerEnter)===null||je===void 0||je.call(r,e,t,Oe)},Te=function(Oe){var je;(je=r.onDayPointerLeave)===null||je===void 0||je.call(r,e,t,Oe)},Ae=function(Oe){var je;(je=r.onDayTouchCancel)===null||je===void 0||je.call(r,e,t,Oe)},_e=function(Oe){var je;(je=r.onDayTouchEnd)===null||je===void 0||je.call(r,e,t,Oe)},Ee=function(Oe){var je;(je=r.onDayTouchMove)===null||je===void 0||je.call(r,e,t,Oe)},ke=function(Oe){var je;(je=r.onDayTouchStart)===null||je===void 0||je.call(r,e,t,Oe)},Qe=function(Oe){var je;(je=r.onDayKeyUp)===null||je===void 0||je.call(r,e,t,Oe)},Ze=function(Oe){var je;switch(Oe.key){case"ArrowLeft":Oe.preventDefault(),Oe.stopPropagation(),r.dir==="rtl"?i():_();break;case"ArrowRight":Oe.preventDefault(),Oe.stopPropagation(),r.dir==="rtl"?_():i();break;case"ArrowDown":Oe.preventDefault(),Oe.stopPropagation(),w();break;case"ArrowUp":Oe.preventDefault(),Oe.stopPropagation(),A();break;case"PageUp":Oe.preventDefault(),Oe.stopPropagation(),Oe.shiftKey?B():F();break;case"PageDown":Oe.preventDefault(),Oe.stopPropagation(),Oe.shiftKey?q():U();break;case"Home":Oe.preventDefault(),Oe.stopPropagation(),W();break;case"End":Oe.preventDefault(),Oe.stopPropagation(),Z();break}(je=r.onDayKeyDown)===null||je===void 0||je.call(r,e,t,Oe)},Ge={onClick:ne,onFocus:ae,onBlur:ee,onKeyDown:Ze,onKeyUp:Qe,onMouseEnter:se,onMouseLeave:ce,onPointerEnter:ge,onPointerLeave:Te,onTouchCancel:Ae,onTouchEnd:_e,onTouchMove:Ee,onTouchStart:ke};return Ge}function _Fe(){var e=Ja(),t=rre(),r=a4(),n=o4(),a=hC(e)?t.selected:p2(e)?r.selected:m2(e)?n.selected:void 0;return a}function bFe(e){return Object.values(Bh).includes(e)}function wFe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(bFe(n)){var l=e.classNames["day_".concat(n)];l&&r.push(l)}}),r}function SFe(e,t){var r=ci({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=ci(ci({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function AFe(e,t,r){var n,a,l,f=Ja(),i=c4(),_=gFe(e,t),w=xFe(e,_),A=_Fe(),E=!!(f.onDayClick||f.mode!=="default");H.useEffect(function(){var se;_.outside||i.focusedDay&&E&&Ic(i.focusedDay,e)&&((se=r.current)===null||se===void 0||se.focus())},[i.focusedDay,e,r,E,_.outside]);var O=wFe(f,_).join(" "),F=SFe(f,_),U=!!(_.outside&&!f.showOutsideDays||_.hidden),B=(l=(a=f.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:Gze,q=u.jsx(B,{date:e,displayMonth:t,activeModifiers:_}),W={style:F,className:O,children:q,role:"gridcell"},Z=i.focusTarget&&Ic(i.focusTarget,e)&&!_.outside,ne=i.focusedDay&&Ic(i.focusedDay,e),ae=ci(ci(ci({},W),(n={disabled:_.disabled,role:"gridcell"},n["aria-selected"]=_.selected,n.tabIndex=ne||Z?0:-1,n)),w),ee={isButton:E,isHidden:U,activeModifiers:_,selectedDays:A,buttonProps:ae,divProps:W};return ee}function TFe(e){var t=H.useRef(null),r=AFe(e.date,e.displayMonth,t);return r.isHidden?u.jsx("div",{role:"gridcell"}):r.isButton?u.jsx(YT,ci({name:"day",ref:t},r.buttonProps)):u.jsx("div",ci({},r.divProps))}function PFe(e){var t=e.number,r=e.dates,n=Ja(),a=n.onWeekNumberClick,l=n.styles,f=n.classNames,i=n.locale,_=n.labels.labelWeekNumber,w=n.formatters.formatWeekNumber,A=w(Number(t),{locale:i});if(!a)return u.jsx("span",{className:f.weeknumber,style:l.weeknumber,children:A});var E=_(Number(t),{locale:i}),O=function(F){a(t,r,F)};return u.jsx(YT,{name:"week-number","aria-label":E,className:f.weeknumber,style:l.weeknumber,onClick:O,children:A})}function CFe(e){var t,r,n=Ja(),a=n.styles,l=n.classNames,f=n.showWeekNumber,i=n.components,_=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:TFe,w=(r=i==null?void 0:i.WeekNumber)!==null&&r!==void 0?r:PFe,A;return f&&(A=u.jsx("td",{className:l.cell,style:a.cell,children:u.jsx(w,{number:e.weekNumber,dates:e.dates})})),u.jsxs("tr",{className:l.row,style:a.row,children:[A,e.dates.map(function(E){return u.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:u.jsx(_,{displayMonth:e.displayMonth,date:E})},nze(E))})]})}function BG(e,t,r){for(var n=r!=null&&r.ISOWeek?Bte(t):r4(t,r),a=r!=null&&r.ISOWeek?$v(e):ep(e,r),l=Df(n,a),f=[],i=0;i<=l;i++)f.push(ic(a,i));var _=f.reduce(function(w,A){var E=r!=null&&r.ISOWeek?Ute(A):qte(A,r),O=w.find(function(F){return F.weekNumber===E});return O?(O.dates.push(A),w):(w.push({weekNumber:E,dates:[A]}),w)},[]);return _}function EFe(e,t){var r=BG(Lc(e),t4(e),t);if(t!=null&&t.useFixedWeeks){var n=aze(e,t);if(n<6){var a=r[r.length-1],l=a.dates[a.dates.length-1],f=i3(l,6-n),i=BG(i3(l,1),f,t);r.push.apply(r,i)}}return r}function kFe(e){var t,r,n,a=Ja(),l=a.locale,f=a.classNames,i=a.styles,_=a.hideHead,w=a.fixedWeeks,A=a.components,E=a.weekStartsOn,O=a.firstWeekContainsDate,F=a.ISOWeek,U=EFe(e.displayMonth,{useFixedWeeks:!!w,ISOWeek:F,locale:l,weekStartsOn:E,firstWeekContainsDate:O}),B=(t=A==null?void 0:A.Head)!==null&&t!==void 0?t:qze,q=(r=A==null?void 0:A.Row)!==null&&r!==void 0?r:CFe,W=(n=A==null?void 0:A.Footer)!==null&&n!==void 0?n:Vze;return u.jsxs("table",{id:e.id,className:f.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!_&&u.jsx(B,{}),u.jsx("tbody",{className:f.tbody,style:i.tbody,children:U.map(function(Z){return u.jsx(q,{displayMonth:e.displayMonth,dates:Z.dates,weekNumber:Z.weekNumber},Z.weekNumber)})}),u.jsx(W,{displayMonth:e.displayMonth})]})}function MFe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var jFe=MFe()?H.useLayoutEffect:H.useEffect,bN=!1,OFe=0;function VG(){return"react-day-picker-".concat(++OFe)}function NFe(e){var t,r=e??(bN?VG():null),n=H.useState(r),a=n[0],l=n[1];return jFe(function(){a===null&&l(VG())},[]),H.useEffect(function(){bN===!1&&(bN=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function RFe(e){var t,r,n=Ja(),a=n.dir,l=n.classNames,f=n.styles,i=n.components,_=g2().displayMonths,w=NFe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),A=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,E=[l.month],O=f.month,F=e.displayIndex===0,U=e.displayIndex===_.length-1,B=!F&&!U;a==="rtl"&&(t=[F,U],U=t[0],F=t[1]),F&&(E.push(l.caption_start),O=ci(ci({},O),f.caption_start)),U&&(E.push(l.caption_end),O=ci(ci({},O),f.caption_end)),B&&(E.push(l.caption_between),O=ci(ci({},O),f.caption_between));var q=(r=i==null?void 0:i.Caption)!==null&&r!==void 0?r:Bze;return u.jsxs("div",{className:E.join(" "),style:O,children:[u.jsx(q,{id:w,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),u.jsx(kFe,{id:A,"aria-labelledby":w,displayMonth:e.displayMonth})]},e.displayIndex)}function IFe(e){var t=Ja(),r=t.classNames,n=t.styles;return u.jsx("div",{className:r.months,style:n.months,children:e.children})}function DFe(e){var t,r,n=e.initialProps,a=Ja(),l=c4(),f=g2(),i=H.useState(!1),_=i[0],w=i[1];H.useEffect(function(){a.initialFocus&&l.focusTarget&&(_||(l.focus(l.focusTarget),w(!0)))},[a.initialFocus,_,l.focus,l.focusTarget,l]);var A=[a.classNames.root,a.className];a.numberOfMonths>1&&A.push(a.classNames.multiple_months),a.showWeekNumber&&A.push(a.classNames.with_weeknumber);var E=ci(ci({},a.styles.root),a.style),O=Object.keys(n).filter(function(U){return U.startsWith("data-")}).reduce(function(U,B){var q;return ci(ci({},U),(q={},q[B]=n[B],q))},{}),F=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:IFe;return u.jsx("div",ci({className:A.join(" "),style:E,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},O,{children:u.jsx(F,{children:f.displayMonths.map(function(U,B){return u.jsx(RFe,{displayIndex:B,displayMonth:U},B)})})}))}function LFe(e){var t=e.children,r=oze(e,["children"]);return u.jsx(Pze,{initialProps:r,children:u.jsx(Dze,{children:u.jsx(yFe,{initialProps:r,children:u.jsx(Wze,{initialProps:r,children:u.jsx(Zze,{initialProps:r,children:u.jsx(nFe,{children:u.jsx(mFe,{children:t})})})})})})})}function zFe(e){return u.jsx(LFe,ci({},e,{children:u.jsx(DFe,{initialProps:e})}))}function jw({className:e,classNames:t,showOutsideDays:r=!0,...n}){return u.jsx(zFe,{showOutsideDays:r,className:Wt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-start pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Wt(x1({variant:"outline"}),"h-7 w-7 bg-transparent hidden p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:Wt("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:Wt(x1({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:a,...l})=>u.jsx(EW,{className:Wt("h-4 w-4",a),...l}),IconRight:({className:a,...l})=>u.jsx(bx,{className:Wt("h-4 w-4",a),...l})},...n})}jw.displayName="Calendar";function FFe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var BFe=["color"],y2=H.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=FFe(e,BFe);return H.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a,{ref:t}),H.createElement("path",{d:"M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z",fill:n,fillRule:"evenodd",clipRule:"evenodd"}))}),d4="Avatar",[VFe,eUe]=kd(d4),[UFe,nre]=VFe(d4),ire=H.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[a,l]=H.useState("idle");return u.jsx(UFe,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:u.jsx(gi.span,{...n,ref:t})})});ire.displayName=d4;var are="AvatarImage",sre=H.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...l}=e,f=nre(are,r),i=$Fe(n,l.referrerPolicy),_=Au(w=>{a(w),f.onImageLoadingStatusChange(w)});return nl(()=>{i!=="idle"&&_(i)},[i,_]),i==="loaded"?u.jsx(gi.img,{...l,ref:t,src:n}):null});sre.displayName=are;var ore="AvatarFallback",lre=H.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=e,l=nre(ore,r),[f,i]=H.useState(n===void 0);return H.useEffect(()=>{if(n!==void 0){const _=window.setTimeout(()=>i(!0),n);return()=>window.clearTimeout(_)}},[n]),f&&l.imageLoadingStatus!=="loaded"?u.jsx(gi.span,{...a,ref:t}):null});lre.displayName=ore;function $Fe(e,t){const[r,n]=H.useState("idle");return nl(()=>{if(!e){n("error");return}let a=!0;const l=new window.Image,f=i=>()=>{a&&n(i)};return n("loading"),l.onload=f("loaded"),l.onerror=f("error"),l.src=e,t&&(l.referrerPolicy=t),()=>{a=!1}},[e,t]),r}var cre=ire,ure=sre,dre=lre;const o3=H.forwardRef(({className:e,...t},r)=>u.jsx(cre,{ref:r,className:Wt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));o3.displayName=cre.displayName;const l3=H.forwardRef(({className:e,...t},r)=>u.jsx(ure,{ref:r,className:Wt("aspect-square h-full w-full",e),...t}));l3.displayName=ure.displayName;const c3=H.forwardRef(({className:e,...t},r)=>u.jsx(dre,{ref:r,className:Wt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));c3.displayName=dre.displayName;function h4({column:e,title:t,className:r}){return e.getCanSort()?u.jsx("div",{className:Wt("flex items-center space-x-2",r),children:u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[u.jsx("span",{children:t}),e.getIsSorted()==="desc"?u.jsx(sB,{}):e.getIsSorted()==="asc"?u.jsx(oB,{}):u.jsx(kW,{})]})}),u.jsxs(zc,{align:"start",children:[u.jsxs(Aa,{onClick:()=>e.toggleSorting(!1),children:[u.jsx(oB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),u.jsxs(Aa,{onClick:()=>e.toggleSorting(!0),children:[u.jsx(sB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:()=>e.toggleVisibility(!1),children:[u.jsx(jW,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):u.jsx("div",{className:Wt(r),children:t})}const qFe=h_("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function eo({className:e,variant:t,...r}){return u.jsx("div",{className:Wt(qFe({variant:t}),e),...r})}var[fC,tUe]=kd("Tooltip",[Xg]),pC=Xg(),hre="TooltipProvider",GFe=700,u3="tooltip.open",[WFe,f4]=fC(hre),fre=e=>{const{__scopeTooltip:t,delayDuration:r=GFe,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:l}=e,[f,i]=H.useState(!0),_=H.useRef(!1),w=H.useRef(0);return H.useEffect(()=>{const A=w.current;return()=>window.clearTimeout(A)},[]),u.jsx(WFe,{scope:t,isOpenDelayed:f,delayDuration:r,onOpen:H.useCallback(()=>{window.clearTimeout(w.current),i(!1)},[]),onClose:H.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>i(!0),n)},[n]),isPointerInTransitRef:_,onPointerInTransitChange:H.useCallback(A=>{_.current=A},[]),disableHoverableContent:a,children:l})};fre.displayName=hre;var mC="Tooltip",[HFe,v2]=fC(mC),pre=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a=!1,onOpenChange:l,disableHoverableContent:f,delayDuration:i}=e,_=f4(mC,e.__scopeTooltip),w=pC(t),[A,E]=H.useState(null),O=Sd(),F=H.useRef(0),U=f??_.disableHoverableContent,B=i??_.delayDuration,q=H.useRef(!1),[W=!1,Z]=Lg({prop:n,defaultProp:a,onChange:ce=>{ce?(_.onOpen(),document.dispatchEvent(new CustomEvent(u3))):_.onClose(),l==null||l(ce)}}),ne=H.useMemo(()=>W?q.current?"delayed-open":"instant-open":"closed",[W]),ae=H.useCallback(()=>{window.clearTimeout(F.current),F.current=0,q.current=!1,Z(!0)},[Z]),ee=H.useCallback(()=>{window.clearTimeout(F.current),F.current=0,Z(!1)},[Z]),se=H.useCallback(()=>{window.clearTimeout(F.current),F.current=window.setTimeout(()=>{q.current=!0,Z(!0),F.current=0},B)},[B,Z]);return H.useEffect(()=>()=>{F.current&&(window.clearTimeout(F.current),F.current=0)},[]),u.jsx(sP,{...w,children:u.jsx(HFe,{scope:t,contentId:O,open:W,stateAttribute:ne,trigger:A,onTriggerChange:E,onTriggerEnter:H.useCallback(()=>{_.isOpenDelayed?se():ae()},[_.isOpenDelayed,se,ae]),onTriggerLeave:H.useCallback(()=>{U?ee():(window.clearTimeout(F.current),F.current=0)},[ee,U]),onOpen:ae,onClose:ee,disableHoverableContent:U,children:r})})};pre.displayName=mC;var d3="TooltipTrigger",mre=H.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=v2(d3,r),l=f4(d3,r),f=pC(r),i=H.useRef(null),_=Xi(t,i,a.onTriggerChange),w=H.useRef(!1),A=H.useRef(!1),E=H.useCallback(()=>w.current=!1,[]);return H.useEffect(()=>()=>document.removeEventListener("pointerup",E),[E]),u.jsx(Lw,{asChild:!0,...f,children:u.jsx(gi.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:_,onPointerMove:on(e.onPointerMove,O=>{O.pointerType!=="touch"&&!A.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),A.current=!0)}),onPointerLeave:on(e.onPointerLeave,()=>{a.onTriggerLeave(),A.current=!1}),onPointerDown:on(e.onPointerDown,()=>{w.current=!0,document.addEventListener("pointerup",E,{once:!0})}),onFocus:on(e.onFocus,()=>{w.current||a.onOpen()}),onBlur:on(e.onBlur,a.onClose),onClick:on(e.onClick,a.onClose)})})});mre.displayName=d3;var p4="TooltipPortal",[KFe,ZFe]=fC(p4,{forceMount:void 0}),gre=e=>{const{__scopeTooltip:t,forceMount:r,children:n,container:a}=e,l=v2(p4,t);return u.jsx(KFe,{scope:t,forceMount:r,children:u.jsx(ku,{present:r||l.open,children:u.jsx(v_,{asChild:!0,container:a,children:n})})})};gre.displayName=p4;var o_="TooltipContent",yre=H.forwardRef((e,t)=>{const r=ZFe(o_,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...l}=e,f=v2(o_,e.__scopeTooltip);return u.jsx(ku,{present:n||f.open,children:f.disableHoverableContent?u.jsx(vre,{side:a,...l,ref:t}):u.jsx(YFe,{side:a,...l,ref:t})})}),YFe=H.forwardRef((e,t)=>{const r=v2(o_,e.__scopeTooltip),n=f4(o_,e.__scopeTooltip),a=H.useRef(null),l=Xi(t,a),[f,i]=H.useState(null),{trigger:_,onClose:w}=r,A=a.current,{onPointerInTransitChange:E}=n,O=H.useCallback(()=>{i(null),E(!1)},[E]),F=H.useCallback((U,B)=>{const q=U.currentTarget,W={x:U.clientX,y:U.clientY},Z=e5e(W,q.getBoundingClientRect()),ne=t5e(W,Z),ae=r5e(B.getBoundingClientRect()),ee=i5e([...ne,...ae]);i(ee),E(!0)},[E]);return H.useEffect(()=>()=>O(),[O]),H.useEffect(()=>{if(_&&A){const U=q=>F(q,A),B=q=>F(q,_);return _.addEventListener("pointerleave",U),A.addEventListener("pointerleave",B),()=>{_.removeEventListener("pointerleave",U),A.removeEventListener("pointerleave",B)}}},[_,A,F,O]),H.useEffect(()=>{if(f){const U=B=>{const q=B.target,W={x:B.clientX,y:B.clientY},Z=(_==null?void 0:_.contains(q))||(A==null?void 0:A.contains(q)),ne=!n5e(W,f);Z?O():ne&&(O(),w())};return document.addEventListener("pointermove",U),()=>document.removeEventListener("pointermove",U)}},[_,A,f,w,O]),u.jsx(vre,{...e,ref:l})}),[XFe,JFe]=fC(mC,{isInside:!1}),vre=H.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:f,...i}=e,_=v2(o_,r),w=pC(r),{onClose:A}=_;return H.useEffect(()=>(document.addEventListener(u3,A),()=>document.removeEventListener(u3,A)),[A]),H.useEffect(()=>{if(_.trigger){const E=O=>{const F=O.target;F!=null&&F.contains(_.trigger)&&A()};return window.addEventListener("scroll",E,{capture:!0}),()=>window.removeEventListener("scroll",E,{capture:!0})}},[_.trigger,A]),u.jsx(m_,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:f,onFocusOutside:E=>E.preventDefault(),onDismiss:A,children:u.jsxs(oP,{"data-state":_.stateAttribute,...w,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[u.jsx(E3,{children:n}),u.jsx(XFe,{scope:r,isInside:!0,children:u.jsx(_Le,{id:_.contentId,role:"tooltip",children:a||n})})]})})});yre.displayName=o_;var xre="TooltipArrow",QFe=H.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=pC(r);return JFe(xre,r).isInside?null:u.jsx(lP,{...a,...n,ref:t})});QFe.displayName=xre;function e5e(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(r,n,a,l)){case l:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function t5e(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function r5e(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function n5e(e,t){const{x:r,y:n}=e;let a=!1;for(let l=0,f=t.length-1;l<t.length;f=l++){const i=t[l].x,_=t[l].y,w=t[f].x,A=t[f].y;_>n!=A>n&&r<(w-i)*(n-_)/(A-_)+i&&(a=!a)}return a}function i5e(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),a5e(t)}function a5e(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const l=t[t.length-1],f=t[t.length-2];if((l.x-f.x)*(a.y-f.y)>=(l.y-f.y)*(a.x-f.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const l=r[r.length-1],f=r[r.length-2];if((l.x-f.x)*(a.y-f.y)>=(l.y-f.y)*(a.x-f.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var s5e=fre,o5e=pre,l5e=mre,c5e=gre,_re=yre;const bre=s5e,wre=o5e,Sre=l5e,m4=H.forwardRef(({className:e,sideOffset:t=4,...r},n)=>u.jsx(c5e,{children:u.jsx(_re,{ref:n,sideOffset:t,className:Wt("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));m4.displayName=_re.displayName;const u5e=({plateNumbers:e,maxVisible:t=2})=>{const n=(Array.isArray(e)?e:[e]).filter(i=>i&&i.trim()!=="");if(n.length===0)return u.jsx("span",{className:"text-gray-500 text-xs",children:"No plates"});if(n.length===1)return u.jsx(eo,{variant:"outline",className:"text-xs font-medium",children:n[0]});const a=n.slice(0,t),l=n.length-t,f=n.slice(t);return u.jsx(bre,{children:u.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[a.map((i,_)=>u.jsx(eo,{variant:"outline",className:"text-xs font-medium",children:i},_)),l>0&&u.jsxs(wre,{children:[u.jsx(Sre,{asChild:!0,children:u.jsxs(eo,{variant:"secondary",className:"text-xs font-medium cursor-help hover:bg-secondary/80",children:["+",l," more"]})}),u.jsx(m4,{side:"top",className:"max-w-xs",children:u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"font-semibold text-xs",children:"Additional plates:"}),u.jsx("div",{className:"flex flex-wrap gap-1",children:f.map((i,_)=>u.jsx(eo,{variant:"outline",className:"text-xs",children:i},_))})]})})]})]})})},d5e=(e,t,r)=>[{accessorKey:"accident_id",header:"Accident ID",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("accident_id")})},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("plateNo")})},{accessorKey:"accident_date",header:"Date",cell:({row:n})=>u.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("accident_date")})},{accessorKey:"street",header:"Street",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("street")||"N/A"})},{accessorKey:"barangay",header:"Barangay",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("barangay")||"N/A"})},{accessorKey:"municipality",header:"Municipality",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("municipality")||"N/A"})},{accessorKey:"vehicle_type",header:"Vehicle Type",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("vehicle_type")||"N/A"})},{accessorKey:"severity",header:"Severity",cell:({row:n})=>{const a=n.getValue("severity"),l={minor:"text-green-600 bg-green-100",moderate:"text-yellow-600 bg-yellow-100",severe:"text-orange-600 bg-orange-100",fatal:"text-red-600 bg-red-100"};return u.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium inline-block ${l[a]||"text-gray-600 bg-gray-100"}`,children:a})}},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,l=f=>{f.stopPropagation(),e(a._id)};return u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",className:"h-5 w-5 p-0",children:[u.jsx("span",{className:"sr-only",children:"Open menu"}),u.jsx(y2,{className:"h-4 w-4"})]})}),u.jsxs(zc,{align:"end",className:"w-24",children:[u.jsx(Jg,{className:"text-xs py-1",children:"Actions"}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:l,className:"text-xs py-1",children:[u.jsx(Nc,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}],h5e=e=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:t})=>u.jsx("div",{className:"",children:t.getValue("plateNo")})},{accessorKey:"ownerRepresentativeName",header:({column:t})=>u.jsx(h4,{column:t,title:"Owner/Representative Name"}),cell:({row:t})=>u.jsx("div",{className:"",children:t.getValue("ownerRepresentativeName")})},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:t})=>{const r=t.getValue("hasDriversLicense"),n=t.original.driversLicenseNumber;return u.jsx("div",{className:"",children:r?u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-green-600",children:"Yes"}),n&&u.jsx("div",{className:"text-xs text-muted-foreground",children:n})]}):u.jsx("div",{className:"font-semibold text-red-600",children:"No"})})}},{accessorKey:"birthDate",header:"Birthday",cell:({row:t})=>{const r=t.getValue("birthDate");return u.jsx("div",{className:"",children:r?new Date(r).toLocaleDateString():"None"})}},{accessorKey:"contactNumber",header:"Contact Number",cell:({row:t})=>{const r=t.getValue("contactNumber");return u.jsx("div",{className:"",children:r||"None"})}},{accessorKey:"emailAddress",header:"Email Address",cell:({row:t})=>{const r=t.getValue("emailAddress");return u.jsx("div",{className:"",children:r||"None"})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const r=t.original,n=a=>{a.stopPropagation(),e(r._id)};return u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",className:"h-5 w-5 p-0",children:[u.jsx("span",{className:"sr-only",children:"Open menu"}),u.jsx(y2,{className:"h-4 w-4"})]})}),u.jsxs(zc,{align:"end",children:[u.jsx(Jg,{children:"Actions"}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:n,children:["Activate",u.jsx(Wv,{})]})]})]})}}],f5e=(e,t)=>[{accessorKey:"ownerRepresentativeName",header:({column:r})=>u.jsx(h4,{column:r,title:"Owner"}),cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("ownerRepresentativeName")})},{accessorKey:"plateNo",header:"Plate No.",cell:({row:r})=>{const n=r.getValue("plateNo");return u.jsx(u5e,{plateNumbers:n,maxVisible:2})}},{accessorKey:"fileNo",header:"File No.",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:r.getValue("fileNo")||"N/A"})},{accessorKey:"municipality",header:"Municipality",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:r.getValue("municipality")||"N/A"})},{accessorKey:"barangay",header:"Barangay",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:r.getValue("barangay")||"N/A"})},{accessorKey:"birthDate",header:"Birthdate",cell:({row:r})=>{const n=r.getValue("birthDate");if(!n)return u.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"None"});const a=new Date(n);return isNaN(a.getTime())?u.jsx("div",{className:"text-red-500 text-xs",children:"Invalid Date"}):u.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:a.toLocaleDateString()})}},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:r})=>{const n=r.getValue("hasDriversLicense"),a=r.original.driversLicenseNumber;return u.jsx("div",{className:"",children:n?u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-green-600 text-xs",children:"Yes"}),a&&u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a})]}):u.jsx("div",{className:"font-semibold text-red-600 text-xs",children:"No"})})}},{id:"actions",enableHiding:!1,cell:({row:r})=>{const n=r.original,a=f=>{f.stopPropagation(),e(n._id)},l=f=>{f.stopPropagation(),t(n._id)};return u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",className:"h-5 w-5 p-0",children:[u.jsx("span",{className:"sr-only",children:"Open menu"}),u.jsx(y2,{className:"h-4 w-4"})]})}),u.jsxs(zc,{className:"text-xs w-28",align:"end",children:[u.jsx(Jg,{className:"text-xs py-1",children:"Actions"}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:a,className:"text-xs py-1",children:[u.jsx(Nc,{className:"h-3 w-3 mr-2"}),"Edit"]}),u.jsxs(Aa,{onClick:l,className:"text-xs py-1",children:[u.jsx(Hue,{className:"h-3 w-3 mr-2"}),"Deactivate"]})]})]})}}],p5e=(e,t,r)=>[{accessorKey:"topNo",header:"TOP NO.",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("topNo")})},{accessorKey:"firstName",header:"Full Name",cell:({row:n})=>{const a=n.getValue("firstName"),l=n.original.middleInitial,f=n.original.lastName,i=n.original.suffix;if((a==="None"||!a)&&(l==="None"||!l)&&(f==="None"||!f)&&(i==="None"||!i))return u.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"None"});const _=[a];return l&&l!=="None"&&_.push(l),f&&f!=="None"&&_.push(f),i&&i!=="None"&&_.push(i),u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:_.join(" ")})}},{accessorKey:"violations",header:"Violations",cell:({row:n})=>{const a=n.getValue("violations");return u.jsx("div",{className:"max-w-xs text-xs text-gray-900 dark:text-gray-200",children:a&&a.length>0&&a[0]!=="None"?Array.isArray(a)?a.join(", "):a:"None"})}},{accessorKey:"violationType",header:"Type",cell:({row:n})=>{const a=n.getValue("violationType"),l=i=>{switch(i){case"confiscated":return"Confiscated";case"alarm":return"Alarm";case"impounded":return"Impounded";default:return"Unknown"}},f=i=>{switch(i){case"confiscated":return"bg-blue-100 text-blue-800";case"alarm":return"bg-red-100 text-red-800";case"impounded":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(a)}`,children:l(a)})}},{accessorKey:"licenseType",header:"License Type",cell:({row:n})=>{const a=n.getValue("licenseType");return u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:a&&a!=="None"&&a!=="N/A"?a:"N/A"})}},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("plateNo")})},{accessorKey:"dateOfApprehension",header:({column:n})=>u.jsx(h4,{column:n,title:"Date of Apprehension"}),cell:({row:n})=>{const a=n.getValue("dateOfApprehension");return u.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:a?new Date(a).toLocaleDateString():"None"})}},{accessorKey:"apprehendingOfficer",header:"Officer",cell:({row:n})=>u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("apprehendingOfficer")||"None"})},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,l=f=>{f.stopPropagation(),e(a._id)};return u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",className:"h-5 w-5 p-0",children:[u.jsx("span",{className:"sr-only",children:"Open menu"}),u.jsx(y2,{className:"h-4 w-4"})]})}),u.jsxs(zc,{align:"end",className:"w-24",children:[u.jsx(Jg,{className:"text-xs py-1",children:"Actions"}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:l,className:"text-xs py-1",children:[u.jsx(Nc,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}],m5e=()=>[{accessorKey:"id",header:"Log ID",cell:({row:e})=>u.jsx("div",{className:"",children:e.getValue("id")})},{accessorKey:"fullname",header:"Driver",cell:({row:e})=>u.jsx("div",{className:"",children:e.getValue("fullname")})},{accessorKey:"type",header:"Type ",cell:({row:e})=>u.jsx("div",{className:"",children:e.getValue("type")})},{accessorKey:"createdAt",header:"Timestamp",cell:({row:e})=>u.jsx("div",{className:"",children:e.getValue("createdAt")})}],g5e=(e,t)=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("plateNo")})},{accessorKey:"fileNo",header:"File No.",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("fileNo")||"N/A"})},{accessorKey:"engineNo",header:"Engine No.",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("engineNo")||"N/A"})},{accessorKey:"chassisNo",header:"Chassis No.",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("chassisNo")||"N/A"})},{accessorKey:"dateOfRenewal",header:"Date of Renewal",cell:({row:r})=>{const n=r.getValue("dateOfRenewal");return u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n?new Date(n).toLocaleDateString():"Not set"})}},{accessorKey:"classification",header:"Classification",cell:({row:r})=>u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("classification")||"N/A"})},{accessorKey:"status",header:"Status",cell:({row:r})=>{const n=r.original.status,a=r.original.expirationInfo,l=n==="1"||n===1;return u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-sm",children:[l?u.jsx(Kce,{className:"h-3 w-3 text-green-600"}):u.jsx(Wce,{className:"h-3 w-3 text-red-600"}),u.jsx("span",{className:`text-xs font-medium ${l?"text-green-700":"text-red-700"}`,children:l?"Active":"Expired"})]}),a&&u.jsxs("div",{className:"text-xs text-muted-foreground px-2",children:[u.jsxs("div",{children:["Last 2 digits: ",a.lastTwoDigits]}),u.jsxs("div",{children:[a.week," week of ",a.month]}),a.expirationDate&&u.jsxs("div",{children:["Expires: ",new Date(a.expirationDate).toLocaleDateString()]})]})]})}},{id:"actions",enableHiding:!1,cell:({row:r})=>{const n=r.original,a=l=>{l.stopPropagation(),e(n._id)};return u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",className:"h-5 w-5 p-0",children:[u.jsx("span",{className:"sr-only",children:"Open menu"}),u.jsx(y2,{className:"h-4 w-4"})]})}),u.jsxs(zc,{align:"end",className:"w-24",children:[u.jsx(Jg,{className:"text-xs py-1",children:"Actions"}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:a,className:"text-xs py-1",children:[u.jsx(Nc,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}];/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Ng(e,t){return typeof e=="function"?e(t):e}function Eu(e,t){return r=>{t.setState(n=>({...n,[e]:Ng(r,n[e])}))}}function gC(e){return e instanceof Function}function y5e(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function v5e(e,t){const r=[],n=a=>{a.forEach(l=>{r.push(l);const f=t(l);f!=null&&f.length&&n(f)})};return n(e),r}function ni(e,t,r){let n=[],a;return l=>{let f;r.key&&r.debug&&(f=Date.now());const i=e(l);if(!(i.length!==n.length||i.some((A,E)=>n[E]!==A)))return a;n=i;let w;if(r.key&&r.debug&&(w=Date.now()),a=t(...i),r==null||r.onChange==null||r.onChange(a),r.key&&r.debug&&r!=null&&r.debug()){const A=Math.round((Date.now()-f)*100)/100,E=Math.round((Date.now()-w)*100)/100,O=E/16,F=(U,B)=>{for(U=String(U);U.length<B;)U=" "+U;return U};console.info(`%c ${F(E,5)} /${F(A,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*O,120))}deg 100% 31%);`,r==null?void 0:r.key)}return a}}function ii(e,t,r,n){return{debug:()=>{var a;return(a=e==null?void 0:e.debugAll)!=null?a:e[t]},key:!1,onChange:n}}function x5e(e,t,r,n){const a=()=>{var f;return(f=l.getValue())!=null?f:e.options.renderFallbackValue},l={id:`${t.id}_${r.id}`,row:t,column:r,getValue:()=>t.getValue(n),renderValue:a,getContext:ni(()=>[e,r,t,l],(f,i,_,w)=>({table:f,column:i,row:_,cell:w,getValue:w.getValue,renderValue:w.renderValue}),ii(e.options,"debugCells"))};return e._features.forEach(f=>{f.createCell==null||f.createCell(l,r,t,e)},{}),l}function _5e(e,t,r,n){var a,l;const i={...e._getDefaultColumnDef(),...t},_=i.accessorKey;let w=(a=(l=i.id)!=null?l:_?typeof String.prototype.replaceAll=="function"?_.replaceAll(".","_"):_.replace(/\./g,"_"):void 0)!=null?a:typeof i.header=="string"?i.header:void 0,A;if(i.accessorFn?A=i.accessorFn:_&&(_.includes(".")?A=O=>{let F=O;for(const B of _.split(".")){var U;F=(U=F)==null?void 0:U[B]}return F}:A=O=>O[i.accessorKey]),!w)throw new Error;let E={id:`${String(w)}`,accessorFn:A,parent:n,depth:r,columnDef:i,columns:[],getFlatColumns:ni(()=>[!0],()=>{var O;return[E,...(O=E.columns)==null?void 0:O.flatMap(F=>F.getFlatColumns())]},ii(e.options,"debugColumns")),getLeafColumns:ni(()=>[e._getOrderColumnsFn()],O=>{var F;if((F=E.columns)!=null&&F.length){let U=E.columns.flatMap(B=>B.getLeafColumns());return O(U)}return[E]},ii(e.options,"debugColumns"))};for(const O of e._features)O.createColumn==null||O.createColumn(E,e);return E}const Il="debugHeaders";function UG(e,t,r){var n;let l={id:(n=r.id)!=null?n:t.id,column:t,index:r.index,isPlaceholder:!!r.isPlaceholder,placeholderId:r.placeholderId,depth:r.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const f=[],i=_=>{_.subHeaders&&_.subHeaders.length&&_.subHeaders.map(i),f.push(_)};return i(l),f},getContext:()=>({table:e,header:l,column:t})};return e._features.forEach(f=>{f.createHeader==null||f.createHeader(l,e)}),l}const b5e={createTable:e=>{e.getHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>{var l,f;const i=(l=n==null?void 0:n.map(E=>r.find(O=>O.id===E)).filter(Boolean))!=null?l:[],_=(f=a==null?void 0:a.map(E=>r.find(O=>O.id===E)).filter(Boolean))!=null?f:[],w=r.filter(E=>!(n!=null&&n.includes(E.id))&&!(a!=null&&a.includes(E.id)));return GS(t,[...i,...w,..._],e)},ii(e.options,Il)),e.getCenterHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>(r=r.filter(l=>!(n!=null&&n.includes(l.id))&&!(a!=null&&a.includes(l.id))),GS(t,r,e,"center")),ii(e.options,Il)),e.getLeftHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,r,n)=>{var a;const l=(a=n==null?void 0:n.map(f=>r.find(i=>i.id===f)).filter(Boolean))!=null?a:[];return GS(t,l,e,"left")},ii(e.options,Il)),e.getRightHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,r,n)=>{var a;const l=(a=n==null?void 0:n.map(f=>r.find(i=>i.id===f)).filter(Boolean))!=null?a:[];return GS(t,l,e,"right")},ii(e.options,Il)),e.getFooterGroups=ni(()=>[e.getHeaderGroups()],t=>[...t].reverse(),ii(e.options,Il)),e.getLeftFooterGroups=ni(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),ii(e.options,Il)),e.getCenterFooterGroups=ni(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),ii(e.options,Il)),e.getRightFooterGroups=ni(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),ii(e.options,Il)),e.getFlatHeaders=ni(()=>[e.getHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Il)),e.getLeftFlatHeaders=ni(()=>[e.getLeftHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Il)),e.getCenterFlatHeaders=ni(()=>[e.getCenterHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Il)),e.getRightFlatHeaders=ni(()=>[e.getRightHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Il)),e.getCenterLeafHeaders=ni(()=>[e.getCenterFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ii(e.options,Il)),e.getLeftLeafHeaders=ni(()=>[e.getLeftFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ii(e.options,Il)),e.getRightLeafHeaders=ni(()=>[e.getRightFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ii(e.options,Il)),e.getLeafHeaders=ni(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,r,n)=>{var a,l,f,i,_,w;return[...(a=(l=t[0])==null?void 0:l.headers)!=null?a:[],...(f=(i=r[0])==null?void 0:i.headers)!=null?f:[],...(_=(w=n[0])==null?void 0:w.headers)!=null?_:[]].map(A=>A.getLeafHeaders()).flat()},ii(e.options,Il))}};function GS(e,t,r,n){var a,l;let f=0;const i=function(O,F){F===void 0&&(F=1),f=Math.max(f,F),O.filter(U=>U.getIsVisible()).forEach(U=>{var B;(B=U.columns)!=null&&B.length&&i(U.columns,F+1)},0)};i(e);let _=[];const w=(O,F)=>{const U={depth:F,id:[n,`${F}`].filter(Boolean).join("_"),headers:[]},B=[];O.forEach(q=>{const W=[...B].reverse()[0],Z=q.column.depth===U.depth;let ne,ae=!1;if(Z&&q.column.parent?ne=q.column.parent:(ne=q.column,ae=!0),W&&(W==null?void 0:W.column)===ne)W.subHeaders.push(q);else{const ee=UG(r,ne,{id:[n,F,ne.id,q==null?void 0:q.id].filter(Boolean).join("_"),isPlaceholder:ae,placeholderId:ae?`${B.filter(se=>se.column===ne).length}`:void 0,depth:F,index:B.length});ee.subHeaders.push(q),B.push(ee)}U.headers.push(q),q.headerGroup=U}),_.push(U),F>0&&w(B,F-1)},A=t.map((O,F)=>UG(r,O,{depth:f,index:F}));w(A,f-1),_.reverse();const E=O=>O.filter(U=>U.column.getIsVisible()).map(U=>{let B=0,q=0,W=[0];U.subHeaders&&U.subHeaders.length?(W=[],E(U.subHeaders).forEach(ne=>{let{colSpan:ae,rowSpan:ee}=ne;B+=ae,W.push(ee)})):B=1;const Z=Math.min(...W);return q=q+Z,U.colSpan=B,U.rowSpan=q,{colSpan:B,rowSpan:q}});return E((a=(l=_[0])==null?void 0:l.headers)!=null?a:[]),_}const g4=(e,t,r,n,a,l,f)=>{let i={id:t,index:n,original:r,depth:a,parentId:f,_valuesCache:{},_uniqueValuesCache:{},getValue:_=>{if(i._valuesCache.hasOwnProperty(_))return i._valuesCache[_];const w=e.getColumn(_);if(w!=null&&w.accessorFn)return i._valuesCache[_]=w.accessorFn(i.original,n),i._valuesCache[_]},getUniqueValues:_=>{if(i._uniqueValuesCache.hasOwnProperty(_))return i._uniqueValuesCache[_];const w=e.getColumn(_);if(w!=null&&w.accessorFn)return w.columnDef.getUniqueValues?(i._uniqueValuesCache[_]=w.columnDef.getUniqueValues(i.original,n),i._uniqueValuesCache[_]):(i._uniqueValuesCache[_]=[i.getValue(_)],i._uniqueValuesCache[_])},renderValue:_=>{var w;return(w=i.getValue(_))!=null?w:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>v5e(i.subRows,_=>_.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let _=[],w=i;for(;;){const A=w.getParentRow();if(!A)break;_.push(A),w=A}return _.reverse()},getAllCells:ni(()=>[e.getAllLeafColumns()],_=>_.map(w=>x5e(e,i,w,w.id)),ii(e.options,"debugRows")),_getAllCellsByColumnId:ni(()=>[i.getAllCells()],_=>_.reduce((w,A)=>(w[A.column.id]=A,w),{}),ii(e.options,"debugRows"))};for(let _=0;_<e._features.length;_++){const w=e._features[_];w==null||w.createRow==null||w.createRow(i,e)}return i},w5e={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Are=(e,t,r)=>{var n,a;const l=r==null||(n=r.toString())==null?void 0:n.toLowerCase();return!!(!((a=e.getValue(t))==null||(a=a.toString())==null||(a=a.toLowerCase())==null)&&a.includes(l))};Are.autoRemove=e=>Mh(e);const Tre=(e,t,r)=>{var n;return!!(!((n=e.getValue(t))==null||(n=n.toString())==null)&&n.includes(r))};Tre.autoRemove=e=>Mh(e);const Pre=(e,t,r)=>{var n;return((n=e.getValue(t))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(r==null?void 0:r.toLowerCase())};Pre.autoRemove=e=>Mh(e);const Cre=(e,t,r)=>{var n;return(n=e.getValue(t))==null?void 0:n.includes(r)};Cre.autoRemove=e=>Mh(e);const Ere=(e,t,r)=>!r.some(n=>{var a;return!((a=e.getValue(t))!=null&&a.includes(n))});Ere.autoRemove=e=>Mh(e)||!(e!=null&&e.length);const kre=(e,t,r)=>r.some(n=>{var a;return(a=e.getValue(t))==null?void 0:a.includes(n)});kre.autoRemove=e=>Mh(e)||!(e!=null&&e.length);const Mre=(e,t,r)=>e.getValue(t)===r;Mre.autoRemove=e=>Mh(e);const jre=(e,t,r)=>e.getValue(t)==r;jre.autoRemove=e=>Mh(e);const y4=(e,t,r)=>{let[n,a]=r;const l=e.getValue(t);return l>=n&&l<=a};y4.resolveFilterValue=e=>{let[t,r]=e,n=typeof t!="number"?parseFloat(t):t,a=typeof r!="number"?parseFloat(r):r,l=t===null||Number.isNaN(n)?-1/0:n,f=r===null||Number.isNaN(a)?1/0:a;if(l>f){const i=l;l=f,f=i}return[l,f]};y4.autoRemove=e=>Mh(e)||Mh(e[0])&&Mh(e[1]);const em={includesString:Are,includesStringSensitive:Tre,equalsString:Pre,arrIncludes:Cre,arrIncludesAll:Ere,arrIncludesSome:kre,equals:Mre,weakEquals:jre,inNumberRange:y4};function Mh(e){return e==null||e===""}const S5e={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Eu("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);return typeof n=="string"?em.includesString:typeof n=="number"?em.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?em.equals:Array.isArray(n)?em.arrIncludes:em.weakEquals},e.getFilterFn=()=>{var r,n;return gC(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(r=(n=t.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?r:em[e.columnDef.filterFn]},e.getCanFilter=()=>{var r,n,a;return((r=e.columnDef.enableColumnFilter)!=null?r:!0)&&((n=t.options.enableColumnFilters)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var r;return(r=t.getState().columnFilters)==null||(r=r.find(n=>n.id===e.id))==null?void 0:r.value},e.getFilterIndex=()=>{var r,n;return(r=(n=t.getState().columnFilters)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.setFilterValue=r=>{t.setColumnFilters(n=>{const a=e.getFilterFn(),l=n==null?void 0:n.find(A=>A.id===e.id),f=Ng(r,l?l.value:void 0);if($G(a,f,e)){var i;return(i=n==null?void 0:n.filter(A=>A.id!==e.id))!=null?i:[]}const _={id:e.id,value:f};if(l){var w;return(w=n==null?void 0:n.map(A=>A.id===e.id?_:A))!=null?w:[]}return n!=null&&n.length?[...n,_]:[_]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const r=e.getAllLeafColumns(),n=a=>{var l;return(l=Ng(t,a))==null?void 0:l.filter(f=>{const i=r.find(_=>_.id===f.id);if(i){const _=i.getFilterFn();if($G(_,f.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=t=>{var r,n;e.setColumnFilters(t?[]:(r=(n=e.initialState)==null?void 0:n.columnFilters)!=null?r:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function $G(e,t,r){return(e&&e.autoRemove?e.autoRemove(t,r):!1)||typeof t>"u"||typeof t=="string"&&!t}const A5e=(e,t,r)=>r.reduce((n,a)=>{const l=a.getValue(e);return n+(typeof l=="number"?l:0)},0),T5e=(e,t,r)=>{let n;return r.forEach(a=>{const l=a.getValue(e);l!=null&&(n>l||n===void 0&&l>=l)&&(n=l)}),n},P5e=(e,t,r)=>{let n;return r.forEach(a=>{const l=a.getValue(e);l!=null&&(n<l||n===void 0&&l>=l)&&(n=l)}),n},C5e=(e,t,r)=>{let n,a;return r.forEach(l=>{const f=l.getValue(e);f!=null&&(n===void 0?f>=f&&(n=a=f):(n>f&&(n=f),a<f&&(a=f)))}),[n,a]},E5e=(e,t)=>{let r=0,n=0;if(t.forEach(a=>{let l=a.getValue(e);l!=null&&(l=+l)>=l&&(++r,n+=l)}),r)return n/r},k5e=(e,t)=>{if(!t.length)return;const r=t.map(l=>l.getValue(e));if(!y5e(r))return;if(r.length===1)return r[0];const n=Math.floor(r.length/2),a=r.sort((l,f)=>l-f);return r.length%2!==0?a[n]:(a[n-1]+a[n])/2},M5e=(e,t)=>Array.from(new Set(t.map(r=>r.getValue(e))).values()),j5e=(e,t)=>new Set(t.map(r=>r.getValue(e))).size,O5e=(e,t)=>t.length,wN={sum:A5e,min:T5e,max:P5e,extent:C5e,mean:E5e,median:k5e,unique:M5e,uniqueCount:j5e,count:O5e},N5e={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,r;return(t=(r=e.getValue())==null||r.toString==null?void 0:r.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Eu("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(r=>r!=null&&r.includes(e.id)?r.filter(n=>n!==e.id):[...r??[],e.id])},e.getCanGroup=()=>{var r,n;return((r=e.columnDef.enableGrouping)!=null?r:!0)&&((n=t.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.includes(e.id)},e.getGroupedIndex=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const r=e.getCanGroup();return()=>{r&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);if(typeof n=="number")return wN.sum;if(Object.prototype.toString.call(n)==="[object Date]")return wN.extent},e.getAggregationFn=()=>{var r,n;if(!e)throw new Error;return gC(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(r=(n=t.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?r:wN[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var r,n;e.setGrouping(t?[]:(r=(n=e.initialState)==null?void 0:n.grouping)!=null?r:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=r=>{if(e._groupingValuesCache.hasOwnProperty(r))return e._groupingValuesCache[r];const n=t.getColumn(r);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[r]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[r]):e.getValue(r)},e._groupingValuesCache={}},createCell:(e,t,r,n)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===r.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var a;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((a=r.subRows)!=null&&a.length)}}};function R5e(e,t,r){if(!(t!=null&&t.length)||!r)return e;const n=e.filter(l=>!t.includes(l.id));return r==="remove"?n:[...t.map(l=>e.find(f=>f.id===l)).filter(Boolean),...n]}const I5e={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Eu("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=ni(r=>[y1(t,r)],r=>r.findIndex(n=>n.id===e.id),ii(t.options,"debugColumns")),e.getIsFirstColumn=r=>{var n;return((n=y1(t,r)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=r=>{var n;const a=y1(t,r);return((n=a[a.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var r;e.setColumnOrder(t?[]:(r=e.initialState.columnOrder)!=null?r:[])},e._getOrderColumnsFn=ni(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,r,n)=>a=>{let l=[];if(!(t!=null&&t.length))l=a;else{const f=[...t],i=[...a];for(;i.length&&f.length;){const _=f.shift(),w=i.findIndex(A=>A.id===_);w>-1&&l.push(i.splice(w,1)[0])}l=[...l,...i]}return R5e(l,r,n)},ii(e.options,"debugTable"))}},SN=()=>({left:[],right:[]}),D5e={getInitialState:e=>({columnPinning:SN(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Eu("columnPinning",e)}),createColumn:(e,t)=>{e.pin=r=>{const n=e.getLeafColumns().map(a=>a.id).filter(Boolean);t.setColumnPinning(a=>{var l,f;if(r==="right"){var i,_;return{left:((i=a==null?void 0:a.left)!=null?i:[]).filter(E=>!(n!=null&&n.includes(E))),right:[...((_=a==null?void 0:a.right)!=null?_:[]).filter(E=>!(n!=null&&n.includes(E))),...n]}}if(r==="left"){var w,A;return{left:[...((w=a==null?void 0:a.left)!=null?w:[]).filter(E=>!(n!=null&&n.includes(E))),...n],right:((A=a==null?void 0:a.right)!=null?A:[]).filter(E=>!(n!=null&&n.includes(E)))}}return{left:((l=a==null?void 0:a.left)!=null?l:[]).filter(E=>!(n!=null&&n.includes(E))),right:((f=a==null?void 0:a.right)!=null?f:[]).filter(E=>!(n!=null&&n.includes(E)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var a,l,f;return((a=n.columnDef.enablePinning)!=null?a:!0)&&((l=(f=t.options.enableColumnPinning)!=null?f:t.options.enablePinning)!=null?l:!0)}),e.getIsPinned=()=>{const r=e.getLeafColumns().map(i=>i.id),{left:n,right:a}=t.getState().columnPinning,l=r.some(i=>n==null?void 0:n.includes(i)),f=r.some(i=>a==null?void 0:a.includes(i));return l?"left":f?"right":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();return a?(r=(n=t.getState().columnPinning)==null||(n=n[a])==null?void 0:n.indexOf(e.id))!=null?r:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=ni(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(r,n,a)=>{const l=[...n??[],...a??[]];return r.filter(f=>!l.includes(f.column.id))},ii(t.options,"debugRows")),e.getLeftVisibleCells=ni(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(r,n)=>(n??[]).map(l=>r.find(f=>f.column.id===l)).filter(Boolean).map(l=>({...l,position:"left"})),ii(t.options,"debugRows")),e.getRightVisibleCells=ni(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(r,n)=>(n??[]).map(l=>r.find(f=>f.column.id===l)).filter(Boolean).map(l=>({...l,position:"right"})),ii(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var r,n;return e.setColumnPinning(t?SN():(r=(n=e.initialState)==null?void 0:n.columnPinning)!=null?r:SN())},e.getIsSomeColumnsPinned=t=>{var r;const n=e.getState().columnPinning;if(!t){var a,l;return!!((a=n.left)!=null&&a.length||(l=n.right)!=null&&l.length)}return!!((r=n[t])!=null&&r.length)},e.getLeftLeafColumns=ni(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ii(e.options,"debugColumns")),e.getRightLeafColumns=ni(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ii(e.options,"debugColumns")),e.getCenterLeafColumns=ni(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n)=>{const a=[...r??[],...n??[]];return t.filter(l=>!a.includes(l.id))},ii(e.options,"debugColumns"))}},WS={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},AN=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),L5e={getDefaultColumnDef:()=>WS,getInitialState:e=>({columnSizing:{},columnSizingInfo:AN(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Eu("columnSizing",e),onColumnSizingInfoChange:Eu("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var r,n,a;const l=t.getState().columnSizing[e.id];return Math.min(Math.max((r=e.columnDef.minSize)!=null?r:WS.minSize,(n=l??e.columnDef.size)!=null?n:WS.size),(a=e.columnDef.maxSize)!=null?a:WS.maxSize)},e.getStart=ni(r=>[r,y1(t,r),t.getState().columnSizing],(r,n)=>n.slice(0,e.getIndex(r)).reduce((a,l)=>a+l.getSize(),0),ii(t.options,"debugColumns")),e.getAfter=ni(r=>[r,y1(t,r),t.getState().columnSizing],(r,n)=>n.slice(e.getIndex(r)+1).reduce((a,l)=>a+l.getSize(),0),ii(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(r=>{let{[e.id]:n,...a}=r;return a})},e.getCanResize=()=>{var r,n;return((r=e.columnDef.enableResizing)!=null?r:!0)&&((n=t.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let r=0;const n=a=>{if(a.subHeaders.length)a.subHeaders.forEach(n);else{var l;r+=(l=a.column.getSize())!=null?l:0}};return n(e),r},e.getStart=()=>{if(e.index>0){const r=e.headerGroup.headers[e.index-1];return r.getStart()+r.getSize()}return 0},e.getResizeHandler=r=>{const n=t.getColumn(e.column.id),a=n==null?void 0:n.getCanResize();return l=>{if(!n||!a||(l.persist==null||l.persist(),TN(l)&&l.touches&&l.touches.length>1))return;const f=e.getSize(),i=e?e.getLeafHeaders().map(W=>[W.column.id,W.column.getSize()]):[[n.id,n.getSize()]],_=TN(l)?Math.round(l.touches[0].clientX):l.clientX,w={},A=(W,Z)=>{typeof Z=="number"&&(t.setColumnSizingInfo(ne=>{var ae,ee;const se=t.options.columnResizeDirection==="rtl"?-1:1,ce=(Z-((ae=ne==null?void 0:ne.startOffset)!=null?ae:0))*se,ge=Math.max(ce/((ee=ne==null?void 0:ne.startSize)!=null?ee:0),-.999999);return ne.columnSizingStart.forEach(Te=>{let[Ae,_e]=Te;w[Ae]=Math.round(Math.max(_e+_e*ge,0)*100)/100}),{...ne,deltaOffset:ce,deltaPercentage:ge}}),(t.options.columnResizeMode==="onChange"||W==="end")&&t.setColumnSizing(ne=>({...ne,...w})))},E=W=>A("move",W),O=W=>{A("end",W),t.setColumnSizingInfo(Z=>({...Z,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},F=r||typeof document<"u"?document:null,U={moveHandler:W=>E(W.clientX),upHandler:W=>{F==null||F.removeEventListener("mousemove",U.moveHandler),F==null||F.removeEventListener("mouseup",U.upHandler),O(W.clientX)}},B={moveHandler:W=>(W.cancelable&&(W.preventDefault(),W.stopPropagation()),E(W.touches[0].clientX),!1),upHandler:W=>{var Z;F==null||F.removeEventListener("touchmove",B.moveHandler),F==null||F.removeEventListener("touchend",B.upHandler),W.cancelable&&(W.preventDefault(),W.stopPropagation()),O((Z=W.touches[0])==null?void 0:Z.clientX)}},q=z5e()?{passive:!1}:!1;TN(l)?(F==null||F.addEventListener("touchmove",B.moveHandler,q),F==null||F.addEventListener("touchend",B.upHandler,q)):(F==null||F.addEventListener("mousemove",U.moveHandler,q),F==null||F.addEventListener("mouseup",U.upHandler,q)),t.setColumnSizingInfo(W=>({...W,startOffset:_,startSize:f,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var r;e.setColumnSizing(t?{}:(r=e.initialState.columnSizing)!=null?r:{})},e.resetHeaderSizeInfo=t=>{var r;e.setColumnSizingInfo(t?AN():(r=e.initialState.columnSizingInfo)!=null?r:AN())},e.getTotalSize=()=>{var t,r;return(t=(r=e.getHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,r;return(t=(r=e.getLeftHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,r;return(t=(r=e.getCenterHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,r;return(t=(r=e.getRightHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0}}};let HS=null;function z5e(){if(typeof HS=="boolean")return HS;let e=!1;try{const t={get passive(){return e=!0,!1}},r=()=>{};window.addEventListener("test",r,t),window.removeEventListener("test",r)}catch{e=!1}return HS=e,HS}function TN(e){return e.type==="touchstart"}const F5e={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Eu("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=r=>{e.getCanHide()&&t.setColumnVisibility(n=>({...n,[e.id]:r??!e.getIsVisible()}))},e.getIsVisible=()=>{var r,n;const a=e.columns;return(r=a.length?a.some(l=>l.getIsVisible()):(n=t.getState().columnVisibility)==null?void 0:n[e.id])!=null?r:!0},e.getCanHide=()=>{var r,n;return((r=e.columnDef.enableHiding)!=null?r:!0)&&((n=t.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>r=>{e.toggleVisibility==null||e.toggleVisibility(r.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=ni(()=>[e.getAllCells(),t.getState().columnVisibility],r=>r.filter(n=>n.column.getIsVisible()),ii(t.options,"debugRows")),e.getVisibleCells=ni(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(r,n,a)=>[...r,...n,...a],ii(t.options,"debugRows"))},createTable:e=>{const t=(r,n)=>ni(()=>[n(),n().filter(a=>a.getIsVisible()).map(a=>a.id).join("_")],a=>a.filter(l=>l.getIsVisible==null?void 0:l.getIsVisible()),ii(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=r=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(r),e.resetColumnVisibility=r=>{var n;e.setColumnVisibility(r?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=r=>{var n;r=(n=r)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((a,l)=>({...a,[l.id]:r||!(l.getCanHide!=null&&l.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(r=>!(r.getIsVisible!=null&&r.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(r=>r.getIsVisible==null?void 0:r.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>r=>{var n;e.toggleAllColumnsVisible((n=r.target)==null?void 0:n.checked)}}};function y1(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const B5e={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},V5e={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Eu("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var r;const n=(r=e.getCoreRowModel().flatRows[0])==null||(r=r._getAllCellsByColumnId()[t.id])==null?void 0:r.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var r,n,a,l;return((r=e.columnDef.enableGlobalFilter)!=null?r:!0)&&((n=t.options.enableGlobalFilter)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&((l=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?l:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>em.includesString,e.getGlobalFilterFn=()=>{var t,r;const{globalFilterFn:n}=e.options;return gC(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(t=(r=e.options.filterFns)==null?void 0:r[n])!=null?t:em[n]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},U5e={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Eu("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,r=!1;e._autoResetExpanded=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(r)return;r=!0,e._queue(()=>{e.resetExpanded(),r=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var a,l;e.setExpanded(n?{}:(a=(l=e.initialState)==null?void 0:l.expanded)!=null?a:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(a=>!a.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(l=>{const f=l.split(".");n=Math.max(n,f.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=r=>{t.setExpanded(n=>{var a;const l=n===!0?!0:!!(n!=null&&n[e.id]);let f={};if(n===!0?Object.keys(t.getRowModel().rowsById).forEach(i=>{f[i]=!0}):f=n,r=(a=r)!=null?a:!l,!l&&r)return{...f,[e.id]:!0};if(l&&!r){const{[e.id]:i,..._}=f;return _}return n})},e.getIsExpanded=()=>{var r;const n=t.getState().expanded;return!!((r=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?r:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var r,n,a;return(r=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?r:((n=t.options.enableExpanding)!=null?n:!0)&&!!((a=e.subRows)!=null&&a.length)},e.getIsAllParentsExpanded=()=>{let r=!0,n=e;for(;r&&n.parentId;)n=t.getRow(n.parentId,!0),r=n.getIsExpanded();return r},e.getToggleExpandedHandler=()=>{const r=e.getCanExpand();return()=>{r&&e.toggleExpanded()}}}},h3=0,f3=10,PN=()=>({pageIndex:h3,pageSize:f3}),$5e={getInitialState:e=>({...e,pagination:{...PN(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Eu("pagination",e)}),createTable:e=>{let t=!1,r=!1;e._autoResetPageIndex=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(r)return;r=!0,e._queue(()=>{e.resetPageIndex(),r=!1})}},e.setPagination=n=>{const a=l=>Ng(n,l);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(a)},e.resetPagination=n=>{var a;e.setPagination(n?PN():(a=e.initialState.pagination)!=null?a:PN())},e.setPageIndex=n=>{e.setPagination(a=>{let l=Ng(n,a.pageIndex);const f=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return l=Math.max(0,Math.min(l,f)),{...a,pageIndex:l}})},e.resetPageIndex=n=>{var a,l;e.setPageIndex(n?h3:(a=(l=e.initialState)==null||(l=l.pagination)==null?void 0:l.pageIndex)!=null?a:h3)},e.resetPageSize=n=>{var a,l;e.setPageSize(n?f3:(a=(l=e.initialState)==null||(l=l.pagination)==null?void 0:l.pageSize)!=null?a:f3)},e.setPageSize=n=>{e.setPagination(a=>{const l=Math.max(1,Ng(n,a.pageSize)),f=a.pageSize*a.pageIndex,i=Math.floor(f/l);return{...a,pageIndex:i,pageSize:l}})},e.setPageCount=n=>e.setPagination(a=>{var l;let f=Ng(n,(l=e.options.pageCount)!=null?l:-1);return typeof f=="number"&&(f=Math.max(-1,f)),{...a,pageCount:f}}),e.getPageOptions=ni(()=>[e.getPageCount()],n=>{let a=[];return n&&n>0&&(a=[...new Array(n)].fill(null).map((l,f)=>f)),a},ii(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,a=e.getPageCount();return a===-1?!0:a===0?!1:n<a-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},CN=()=>({top:[],bottom:[]}),q5e={getInitialState:e=>({rowPinning:CN(),...e}),getDefaultOptions:e=>({onRowPinningChange:Eu("rowPinning",e)}),createRow:(e,t)=>{e.pin=(r,n,a)=>{const l=n?e.getLeafRows().map(_=>{let{id:w}=_;return w}):[],f=a?e.getParentRows().map(_=>{let{id:w}=_;return w}):[],i=new Set([...f,e.id,...l]);t.setRowPinning(_=>{var w,A;if(r==="bottom"){var E,O;return{top:((E=_==null?void 0:_.top)!=null?E:[]).filter(B=>!(i!=null&&i.has(B))),bottom:[...((O=_==null?void 0:_.bottom)!=null?O:[]).filter(B=>!(i!=null&&i.has(B))),...Array.from(i)]}}if(r==="top"){var F,U;return{top:[...((F=_==null?void 0:_.top)!=null?F:[]).filter(B=>!(i!=null&&i.has(B))),...Array.from(i)],bottom:((U=_==null?void 0:_.bottom)!=null?U:[]).filter(B=>!(i!=null&&i.has(B)))}}return{top:((w=_==null?void 0:_.top)!=null?w:[]).filter(B=>!(i!=null&&i.has(B))),bottom:((A=_==null?void 0:_.bottom)!=null?A:[]).filter(B=>!(i!=null&&i.has(B)))}})},e.getCanPin=()=>{var r;const{enableRowPinning:n,enablePinning:a}=t.options;return typeof n=="function"?n(e):(r=n??a)!=null?r:!0},e.getIsPinned=()=>{const r=[e.id],{top:n,bottom:a}=t.getState().rowPinning,l=r.some(i=>n==null?void 0:n.includes(i)),f=r.some(i=>a==null?void 0:a.includes(i));return l?"top":f?"bottom":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();if(!a)return-1;const l=(r=a==="top"?t.getTopRows():t.getBottomRows())==null?void 0:r.map(f=>{let{id:i}=f;return i});return(n=l==null?void 0:l.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var r,n;return e.setRowPinning(t?CN():(r=(n=e.initialState)==null?void 0:n.rowPinning)!=null?r:CN())},e.getIsSomeRowsPinned=t=>{var r;const n=e.getState().rowPinning;if(!t){var a,l;return!!((a=n.top)!=null&&a.length||(l=n.bottom)!=null&&l.length)}return!!((r=n[t])!=null&&r.length)},e._getPinnedRows=(t,r,n)=>{var a;return((a=e.options.keepPinnedRows)==null||a?(r??[]).map(f=>{const i=e.getRow(f,!0);return i.getIsAllParentsExpanded()?i:null}):(r??[]).map(f=>t.find(i=>i.id===f))).filter(Boolean).map(f=>({...f,position:n}))},e.getTopRows=ni(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,r)=>e._getPinnedRows(t,r,"top"),ii(e.options,"debugRows")),e.getBottomRows=ni(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,r)=>e._getPinnedRows(t,r,"bottom"),ii(e.options,"debugRows")),e.getCenterRows=ni(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,r,n)=>{const a=new Set([...r??[],...n??[]]);return t.filter(l=>!a.has(l.id))},ii(e.options,"debugRows"))}},G5e={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Eu("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var r;return e.setRowSelection(t?{}:(r=e.initialState.rowSelection)!=null?r:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(r=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const n={...r},a=e.getPreGroupedRowModel().flatRows;return t?a.forEach(l=>{l.getCanSelect()&&(n[l.id]=!0)}):a.forEach(l=>{delete n[l.id]}),n})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(r=>{const n=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),a={...r};return e.getRowModel().rows.forEach(l=>{p3(a,l.id,n,!0,e)}),a}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=ni(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,r)=>Object.keys(t).length?EN(e,r):{rows:[],flatRows:[],rowsById:{}},ii(e.options,"debugTable")),e.getFilteredSelectedRowModel=ni(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,r)=>Object.keys(t).length?EN(e,r):{rows:[],flatRows:[],rowsById:{}},ii(e.options,"debugTable")),e.getGroupedSelectedRowModel=ni(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,r)=>Object.keys(t).length?EN(e,r):{rows:[],flatRows:[],rowsById:{}},ii(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:r}=e.getState();let n=!!(t.length&&Object.keys(r).length);return n&&t.some(a=>a.getCanSelect()&&!r[a.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(a=>a.getCanSelect()),{rowSelection:r}=e.getState();let n=!!t.length;return n&&t.some(a=>!r[a.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var t;const r=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return r>0&&r<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(r=>r.getCanSelect()).some(r=>r.getIsSelected()||r.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(r,n)=>{const a=e.getIsSelected();t.setRowSelection(l=>{var f;if(r=typeof r<"u"?r:!a,e.getCanSelect()&&a===r)return l;const i={...l};return p3(i,e.id,r,(f=n==null?void 0:n.selectChildren)!=null?f:!0,t),i})},e.getIsSelected=()=>{const{rowSelection:r}=t.getState();return v4(e,r)},e.getIsSomeSelected=()=>{const{rowSelection:r}=t.getState();return m3(e,r)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:r}=t.getState();return m3(e,r)==="all"},e.getCanSelect=()=>{var r;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(r=t.options.enableRowSelection)!=null?r:!0},e.getCanSelectSubRows=()=>{var r;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(r=t.options.enableSubRowSelection)!=null?r:!0},e.getCanMultiSelect=()=>{var r;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(r=t.options.enableMultiRowSelection)!=null?r:!0},e.getToggleSelectedHandler=()=>{const r=e.getCanSelect();return n=>{var a;r&&e.toggleSelected((a=n.target)==null?void 0:a.checked)}}}},p3=(e,t,r,n,a)=>{var l;const f=a.getRow(t,!0);r?(f.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),f.getCanSelect()&&(e[t]=!0)):delete e[t],n&&(l=f.subRows)!=null&&l.length&&f.getCanSelectSubRows()&&f.subRows.forEach(i=>p3(e,i.id,r,n,a))};function EN(e,t){const r=e.getState().rowSelection,n=[],a={},l=function(f,i){return f.map(_=>{var w;const A=v4(_,r);if(A&&(n.push(_),a[_.id]=_),(w=_.subRows)!=null&&w.length&&(_={..._,subRows:l(_.subRows)}),A)return _}).filter(Boolean)};return{rows:l(t.rows),flatRows:n,rowsById:a}}function v4(e,t){var r;return(r=t[e.id])!=null?r:!1}function m3(e,t,r){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let a=!0,l=!1;return e.subRows.forEach(f=>{if(!(l&&!a)&&(f.getCanSelect()&&(v4(f,t)?l=!0:a=!1),f.subRows&&f.subRows.length)){const i=m3(f,t);i==="all"?l=!0:(i==="some"&&(l=!0),a=!1)}}),a?"all":l?"some":!1}const g3=/([0-9]+)/gm,W5e=(e,t,r)=>Ore(Kg(e.getValue(r)).toLowerCase(),Kg(t.getValue(r)).toLowerCase()),H5e=(e,t,r)=>Ore(Kg(e.getValue(r)),Kg(t.getValue(r))),K5e=(e,t,r)=>x4(Kg(e.getValue(r)).toLowerCase(),Kg(t.getValue(r)).toLowerCase()),Z5e=(e,t,r)=>x4(Kg(e.getValue(r)),Kg(t.getValue(r))),Y5e=(e,t,r)=>{const n=e.getValue(r),a=t.getValue(r);return n>a?1:n<a?-1:0},X5e=(e,t,r)=>x4(e.getValue(r),t.getValue(r));function x4(e,t){return e===t?0:e>t?1:-1}function Kg(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Ore(e,t){const r=e.split(g3).filter(Boolean),n=t.split(g3).filter(Boolean);for(;r.length&&n.length;){const a=r.shift(),l=n.shift(),f=parseInt(a,10),i=parseInt(l,10),_=[f,i].sort();if(isNaN(_[0])){if(a>l)return 1;if(l>a)return-1;continue}if(isNaN(_[1]))return isNaN(f)?-1:1;if(f>i)return 1;if(i>f)return-1}return r.length-n.length}const Gb={alphanumeric:W5e,alphanumericCaseSensitive:H5e,text:K5e,textCaseSensitive:Z5e,datetime:Y5e,basic:X5e},J5e={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Eu("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const r=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const a of r){const l=a==null?void 0:a.getValue(e.id);if(Object.prototype.toString.call(l)==="[object Date]")return Gb.datetime;if(typeof l=="string"&&(n=!0,l.split(g3).length>1))return Gb.alphanumeric}return n?Gb.text:Gb.basic},e.getAutoSortDir=()=>{const r=t.getFilteredRowModel().flatRows[0];return typeof(r==null?void 0:r.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var r,n;if(!e)throw new Error;return gC(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(r=(n=t.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?r:Gb[e.columnDef.sortingFn]},e.toggleSorting=(r,n)=>{const a=e.getNextSortingOrder(),l=typeof r<"u"&&r!==null;t.setSorting(f=>{const i=f==null?void 0:f.find(F=>F.id===e.id),_=f==null?void 0:f.findIndex(F=>F.id===e.id);let w=[],A,E=l?r:a==="desc";if(f!=null&&f.length&&e.getCanMultiSort()&&n?i?A="toggle":A="add":f!=null&&f.length&&_!==f.length-1?A="replace":i?A="toggle":A="replace",A==="toggle"&&(l||a||(A="remove")),A==="add"){var O;w=[...f,{id:e.id,desc:E}],w.splice(0,w.length-((O=t.options.maxMultiSortColCount)!=null?O:Number.MAX_SAFE_INTEGER))}else A==="toggle"?w=f.map(F=>F.id===e.id?{...F,desc:E}:F):A==="remove"?w=f.filter(F=>F.id!==e.id):w=[{id:e.id,desc:E}];return w})},e.getFirstSortDir=()=>{var r,n;return((r=(n=e.columnDef.sortDescFirst)!=null?n:t.options.sortDescFirst)!=null?r:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=r=>{var n,a;const l=e.getFirstSortDir(),f=e.getIsSorted();return f?f!==l&&((n=t.options.enableSortingRemoval)==null||n)&&(!(r&&(a=t.options.enableMultiRemove)!=null)||a)?!1:f==="desc"?"asc":"desc":l},e.getCanSort=()=>{var r,n;return((r=e.columnDef.enableSorting)!=null?r:!0)&&((n=t.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var r,n;return(r=(n=e.columnDef.enableMultiSort)!=null?n:t.options.enableMultiSort)!=null?r:!!e.accessorFn},e.getIsSorted=()=>{var r;const n=(r=t.getState().sorting)==null?void 0:r.find(a=>a.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var r,n;return(r=(n=t.getState().sorting)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.clearSorting=()=>{t.setSorting(r=>r!=null&&r.length?r.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const r=e.getCanSort();return n=>{r&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var r,n;e.setSorting(t?[]:(r=(n=e.initialState)==null?void 0:n.sorting)!=null?r:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},Q5e=[b5e,F5e,I5e,D5e,w5e,S5e,B5e,V5e,J5e,N5e,U5e,$5e,q5e,G5e,L5e];function eBe(e){var t,r;const n=[...Q5e,...(t=e._features)!=null?t:[]];let a={_features:n};const l=a._features.reduce((O,F)=>Object.assign(O,F.getDefaultOptions==null?void 0:F.getDefaultOptions(a)),{}),f=O=>a.options.mergeOptions?a.options.mergeOptions(l,O):{...l,...O};let _={...{},...(r=e.initialState)!=null?r:{}};a._features.forEach(O=>{var F;_=(F=O.getInitialState==null?void 0:O.getInitialState(_))!=null?F:_});const w=[];let A=!1;const E={_features:n,options:{...l,...e},initialState:_,_queue:O=>{w.push(O),A||(A=!0,Promise.resolve().then(()=>{for(;w.length;)w.shift()();A=!1}).catch(F=>setTimeout(()=>{throw F})))},reset:()=>{a.setState(a.initialState)},setOptions:O=>{const F=Ng(O,a.options);a.options=f(F)},getState:()=>a.options.state,setState:O=>{a.options.onStateChange==null||a.options.onStateChange(O)},_getRowId:(O,F,U)=>{var B;return(B=a.options.getRowId==null?void 0:a.options.getRowId(O,F,U))!=null?B:`${U?[U.id,F].join("."):F}`},getCoreRowModel:()=>(a._getCoreRowModel||(a._getCoreRowModel=a.options.getCoreRowModel(a)),a._getCoreRowModel()),getRowModel:()=>a.getPaginationRowModel(),getRow:(O,F)=>{let U=(F?a.getPrePaginationRowModel():a.getRowModel()).rowsById[O];if(!U&&(U=a.getCoreRowModel().rowsById[O],!U))throw new Error;return U},_getDefaultColumnDef:ni(()=>[a.options.defaultColumn],O=>{var F;return O=(F=O)!=null?F:{},{header:U=>{const B=U.header.column.columnDef;return B.accessorKey?B.accessorKey:B.accessorFn?B.id:null},cell:U=>{var B,q;return(B=(q=U.renderValue())==null||q.toString==null?void 0:q.toString())!=null?B:null},...a._features.reduce((U,B)=>Object.assign(U,B.getDefaultColumnDef==null?void 0:B.getDefaultColumnDef()),{}),...O}},ii(e,"debugColumns")),_getColumnDefs:()=>a.options.columns,getAllColumns:ni(()=>[a._getColumnDefs()],O=>{const F=function(U,B,q){return q===void 0&&(q=0),U.map(W=>{const Z=_5e(a,W,q,B),ne=W;return Z.columns=ne.columns?F(ne.columns,Z,q+1):[],Z})};return F(O)},ii(e,"debugColumns")),getAllFlatColumns:ni(()=>[a.getAllColumns()],O=>O.flatMap(F=>F.getFlatColumns()),ii(e,"debugColumns")),_getAllFlatColumnsById:ni(()=>[a.getAllFlatColumns()],O=>O.reduce((F,U)=>(F[U.id]=U,F),{}),ii(e,"debugColumns")),getAllLeafColumns:ni(()=>[a.getAllColumns(),a._getOrderColumnsFn()],(O,F)=>{let U=O.flatMap(B=>B.getLeafColumns());return F(U)},ii(e,"debugColumns")),getColumn:O=>a._getAllFlatColumnsById()[O]};Object.assign(a,E);for(let O=0;O<a._features.length;O++){const F=a._features[O];F==null||F.createTable==null||F.createTable(a)}return a}function x2(){return e=>ni(()=>[e.options.data],t=>{const r={rows:[],flatRows:[],rowsById:{}},n=function(a,l,f){l===void 0&&(l=0);const i=[];for(let w=0;w<a.length;w++){const A=g4(e,e._getRowId(a[w],w,f),a[w],w,l,void 0,f==null?void 0:f.id);if(r.flatRows.push(A),r.rowsById[A.id]=A,i.push(A),e.options.getSubRows){var _;A.originalSubRows=e.options.getSubRows(a[w],w),(_=A.originalSubRows)!=null&&_.length&&(A.subRows=n(A.originalSubRows,l+1,A))}}return i};return r.rows=n(t),r},ii(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function tBe(e){const t=[],r=n=>{var a;t.push(n),(a=n.subRows)!=null&&a.length&&n.getIsExpanded()&&n.subRows.forEach(r)};return e.rows.forEach(r),{rows:t,flatRows:e.flatRows,rowsById:e.rowsById}}function rBe(e,t,r){return r.options.filterFromLeafRows?nBe(e,t,r):iBe(e,t,r)}function nBe(e,t,r){var n;const a=[],l={},f=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(_,w){w===void 0&&(w=0);const A=[];for(let O=0;O<_.length;O++){var E;let F=_[O];const U=g4(r,F.id,F.original,F.index,F.depth,void 0,F.parentId);if(U.columnFilters=F.columnFilters,(E=F.subRows)!=null&&E.length&&w<f){if(U.subRows=i(F.subRows,w+1),F=U,t(F)&&!U.subRows.length){A.push(F),l[F.id]=F,a.push(F);continue}if(t(F)||U.subRows.length){A.push(F),l[F.id]=F,a.push(F);continue}}else F=U,t(F)&&(A.push(F),l[F.id]=F,a.push(F))}return A};return{rows:i(e),flatRows:a,rowsById:l}}function iBe(e,t,r){var n;const a=[],l={},f=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(_,w){w===void 0&&(w=0);const A=[];for(let O=0;O<_.length;O++){let F=_[O];if(t(F)){var E;if((E=F.subRows)!=null&&E.length&&w<f){const B=g4(r,F.id,F.original,F.index,F.depth,void 0,F.parentId);B.subRows=i(F.subRows,w+1),F=B}A.push(F),a.push(F),l[F.id]=F}}return A};return{rows:i(e),flatRows:a,rowsById:l}}function _2(){return e=>ni(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,r,n)=>{if(!t.rows.length||!(r!=null&&r.length)&&!n){for(let O=0;O<t.flatRows.length;O++)t.flatRows[O].columnFilters={},t.flatRows[O].columnFiltersMeta={};return t}const a=[],l=[];(r??[]).forEach(O=>{var F;const U=e.getColumn(O.id);if(!U)return;const B=U.getFilterFn();B&&a.push({id:O.id,filterFn:B,resolvedValue:(F=B.resolveFilterValue==null?void 0:B.resolveFilterValue(O.value))!=null?F:O.value})});const f=(r??[]).map(O=>O.id),i=e.getGlobalFilterFn(),_=e.getAllLeafColumns().filter(O=>O.getCanGlobalFilter());n&&i&&_.length&&(f.push("__global__"),_.forEach(O=>{var F;l.push({id:O.id,filterFn:i,resolvedValue:(F=i.resolveFilterValue==null?void 0:i.resolveFilterValue(n))!=null?F:n})}));let w,A;for(let O=0;O<t.flatRows.length;O++){const F=t.flatRows[O];if(F.columnFilters={},a.length)for(let U=0;U<a.length;U++){w=a[U];const B=w.id;F.columnFilters[B]=w.filterFn(F,B,w.resolvedValue,q=>{F.columnFiltersMeta[B]=q})}if(l.length){for(let U=0;U<l.length;U++){A=l[U];const B=A.id;if(A.filterFn(F,B,A.resolvedValue,q=>{F.columnFiltersMeta[B]=q})){F.columnFilters.__global__=!0;break}}F.columnFilters.__global__!==!0&&(F.columnFilters.__global__=!1)}}const E=O=>{for(let F=0;F<f.length;F++)if(O.columnFilters[f[F]]===!1)return!1;return!0};return rBe(t.rows,E,e)},ii(e.options,"debugTable","getFilteredRowModel",()=>e._autoResetPageIndex()))}function b2(e){return t=>ni(()=>[t.getState().pagination,t.getPrePaginationRowModel(),t.options.paginateExpandedRows?void 0:t.getState().expanded],(r,n)=>{if(!n.rows.length)return n;const{pageSize:a,pageIndex:l}=r;let{rows:f,flatRows:i,rowsById:_}=n;const w=a*l,A=w+a;f=f.slice(w,A);let E;t.options.paginateExpandedRows?E={rows:f,flatRows:i,rowsById:_}:E=tBe({rows:f,flatRows:i,rowsById:_}),E.flatRows=[];const O=F=>{E.flatRows.push(F),F.subRows.length&&F.subRows.forEach(O)};return E.rows.forEach(O),E},ii(t.options,"debugTable"))}function w2(){return e=>ni(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,r)=>{if(!r.rows.length||!(t!=null&&t.length))return r;const n=e.getState().sorting,a=[],l=n.filter(_=>{var w;return(w=e.getColumn(_.id))==null?void 0:w.getCanSort()}),f={};l.forEach(_=>{const w=e.getColumn(_.id);w&&(f[_.id]={sortUndefined:w.columnDef.sortUndefined,invertSorting:w.columnDef.invertSorting,sortingFn:w.getSortingFn()})});const i=_=>{const w=_.map(A=>({...A}));return w.sort((A,E)=>{for(let F=0;F<l.length;F+=1){var O;const U=l[F],B=f[U.id],q=B.sortUndefined,W=(O=U==null?void 0:U.desc)!=null?O:!1;let Z=0;if(q){const ne=A.getValue(U.id),ae=E.getValue(U.id),ee=ne===void 0,se=ae===void 0;if(ee||se){if(q==="first")return ee?-1:1;if(q==="last")return ee?1:-1;Z=ee&&se?0:ee?q:-q}}if(Z===0&&(Z=B.sortingFn(A,E,U.id)),Z!==0)return W&&(Z*=-1),B.invertSorting&&(Z*=-1),Z}return A.index-E.index}),w.forEach(A=>{var E;a.push(A),(E=A.subRows)!=null&&E.length&&(A.subRows=i(A.subRows))}),w};return{rows:i(r.rows),flatRows:a,rowsById:r.rowsById}},ii(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function tp(e,t){return e?aBe(e)?H.createElement(e,t):e:null}function aBe(e){return sBe(e)||typeof e=="function"||oBe(e)}function sBe(e){return typeof e=="function"&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}function oBe(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function S2(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[r]=H.useState(()=>({current:eBe(t)})),[n,a]=H.useState(()=>r.current.initialState);return r.current.setOptions(l=>({...l,...e,state:{...n,...e.state},onStateChange:f=>{a(f),e.onStateChange==null||e.onStateChange(f)}})),r.current}const oy=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{className:"relative w-full overflow-auto",children:u.jsx("table",{ref:r,className:Wt("w-full caption-bottom text-sm",e),...t})}));oy.displayName="Table";const ly=H.forwardRef(({className:e,...t},r)=>u.jsx("thead",{ref:r,className:Wt("[&_tr]:border-b",e),...t}));ly.displayName="TableHeader";const cy=H.forwardRef(({className:e,...t},r)=>u.jsx("tbody",{ref:r,className:Wt("[&_tr:last-child]:border-0",e),...t}));cy.displayName="TableBody";const lBe=H.forwardRef(({className:e,...t},r)=>u.jsx("tfoot",{ref:r,className:Wt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));lBe.displayName="TableFooter";const Bs=H.forwardRef(({className:e,...t},r)=>u.jsx("tr",{ref:r,className:Wt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Bs.displayName="TableRow";const Js=H.forwardRef(({className:e,...t},r)=>u.jsx("th",{ref:r,className:Wt("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Js.displayName="TableHead";const Oa=H.forwardRef(({className:e,...t},r)=>u.jsx("td",{ref:r,className:Wt("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Oa.displayName="TableCell";const cBe=H.forwardRef(({className:e,...t},r)=>u.jsx("caption",{ref:r,className:Wt("mt-4 text-sm text-muted-foreground",e),...t}));cBe.displayName="TableCaption";const A2=({rowCount:e,cellCount:t})=>u.jsx(u.Fragment,{children:Array.from({length:e}).map((r,n)=>u.jsx(Bs,{children:Array.from({length:t}).map((a,l)=>u.jsx(Oa,{children:u.jsx(qA,{className:"h-5"})},l))},n))});function T2({table:e}){return u.jsxs(Tu,{children:[u.jsx(J3,{asChild:!0,children:u.jsxs(Xr,{size:"sm",className:"ml-auto hidden h-8 lg:flex bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[u.jsx(Nue,{}),"View"]})}),u.jsxs(zc,{align:"end",className:"w-[150px]",children:[u.jsx(Jg,{children:"Toggle columns"}),u.jsx(Rh,{}),e.getAllColumns().filter(t=>typeof t.accessorFn<"u"&&t.getCanHide()).map(t=>u.jsx(pK,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:r=>t.toggleVisibility(!!r),children:typeof t.columnDef.header=="string"?t.columnDef.header:t.id},t.id))]})]})}function P2({table:e}){return u.jsx("div",{className:"flex items-center justify-end px-2",children:u.jsxs("div",{className:"flex items-center space-x-4 lg:space-x-5",children:[u.jsxs("div",{className:"flex w-[100px] items-center justify-center text-xs font-medium",children:["Page ",e.getState().pagination.pageIndex+1," of"," ",e.getPageCount()]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs(Xr,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),children:[u.jsx("span",{className:"sr-only",children:"Go to first page"}),u.jsx(Vce,{className:"w-4 h-4"})]}),u.jsxs(Xr,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),children:[u.jsx("span",{className:"sr-only",children:"Go to previous page"}),u.jsx(EW,{className:"w-4 h-4"})]}),u.jsxs(Xr,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),children:[u.jsx("span",{className:"sr-only",children:"Go to next page"}),u.jsx(bx,{className:"w-4 h-4"})]}),u.jsxs(Xr,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),children:[u.jsx("span",{className:"sr-only",children:"Go to last page"}),u.jsx($ce,{className:"w-4 h-4"})]})]})]})})}const Nre=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:l,loading:f,showAddButton:i=!1,onAdd:_,onAction:w})=>{var se;const[A,E]=Re.useState([]),[O,F]=Re.useState([]),[U,B]=Re.useState({}),[q,W]=Re.useState({pageIndex:0,pageSize:8}),[Z,ne]=Re.useState(""),ae=r,ee=S2({data:l,columns:a(w),onSortingChange:E,onColumnFiltersChange:F,onPaginationChange:W,getCoreRowModel:x2(),getPaginationRowModel:b2(),getSortedRowModel:w2(),getFilteredRowModel:_2(),onColumnVisibilityChange:B,onGlobalFilterChange:ne,globalFilterFn:(ce,ge,Te)=>ae.some(Ae=>{const _e=ce.getValue(Ae);return String(_e).toLowerCase().includes(Te.toLowerCase())}),state:{pagination:q,sorting:A,columnFilters:O,columnVisibility:U,globalFilter:Z}});return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx(os,{className:"font-semibold",children:t}),u.jsxs("div",{className:`md:flex items-center flex-shrink-0 ${e?"justify-between py-3":"justify-end pb-3"}`,children:[u.jsx(Vn,{placeholder:e,value:Z??"",onChange:ce=>ne(ce.target.value),className:e?"hidden md:inline md:max-w-sm flex-shrink":"hidden"}),u.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[u.jsxs(Xr,{onClick:_,size:"sm",className:i?"w-min flex items-center gap-2":"hidden",children:[u.jsx(Wv,{}),u.jsx("span",{className:"hidden lg:inline",children:i})]}),u.jsx(T2,{table:ee})]})]}),u.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white min-h-0",children:u.jsx("div",{className:"overflow-auto h-full",children:u.jsx("div",{className:"px-4",children:u.jsxs(oy,{children:[u.jsx(ly,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-300",children:ee.getHeaderGroups().map(ce=>u.jsx(Bs,{className:"hover:bg-gray-100/50",children:ce.headers.map(ge=>u.jsx(Js,{className:"text-xs font-semibold text-gray-800 px-3 py-2 whitespace-nowrap",children:tp(ge.column.columnDef.header,ge.getContext())},ge.id))},ce.id))}),u.jsx(cy,{className:"text-xs",children:f?u.jsx(A2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ce=>u.jsx(Bs,{"data-state":ce.getIsSelected()&&"selected",className:"hover:bg-gray-100 transition-colors duration-150 border-b border-gray-100",children:ce.getVisibleCells().map(ge=>u.jsx(Oa,{className:"px-3 py-2 text-gray-800",children:tp(ge.column.columnDef.cell,ge.getContext())},ge.id))},ce.id)):u.jsx(Bs,{className:"hover:bg-transparent",children:u.jsx(Oa,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),u.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),u.jsx("div",{className:"mt-3 flex-shrink-0",children:u.jsx(P2,{table:ee})})]})},kN=e=>e.charAt(0).toUpperCase()+e.slice(1),uBe=e=>({get:t=>e[t]||null}),Su=e=>new Date(e).toLocaleString("en-PH",{weekday:"long",year:"numeric",month:"long",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),dBe=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),Zg=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"2-digit",timeZone:"Asia/Manila"}),hBe=uBe({0:"Registration",1:"Violation",2:"Accident"}),fBe=()=>{const[e,t]=H.useState([]),r=la(),{token:n}=r||{},[a,l]=H.useState(!0);return H.useEffect(()=>{async function f(){try{const{data:i}=await Wn.get("/logs",{headers:{Authorization:n}});if(i.success){const _=i.data.map(w=>({id:w._id,fullname:w.driver.fullname,type:hBe.get(w.type),createdAt:dBe(w.createdAt)}));t(_)}}catch(i){console.log(i)}finally{l(!1)}}f()},[]),u.jsx("div",{className:"w-full",children:u.jsx(Nre,{tableColumn:m5e,data:e})})},pBe=()=>{const[e,t]=H.useState(!0),[r,n]=H.useState({vehicles:{total:0,active:0,expired:0},drivers:{total:0},violations:{total:0,recent:0,byType:[]},accidents:{total:0},trends:{monthlyViolations:[]}}),{token:a}=la();H.useEffect(()=>{l()},[]);const l=async()=>{try{t(!0);const{data:f}=await Wn.get("/dashboard/stats",{headers:{Authorization:a}});f.success&&n(f.data)}catch(f){console.error("Error fetching dashboard stats:",f)}finally{t(!1)}};return u.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6 rounded-lg",children:[u.jsx("section",{className:"text-3xl font-bold",children:"Dashboard"}),e?u.jsxs("div",{className:"space-y-4",children:[u.jsx("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(f=>u.jsx("div",{className:"bg-card shadow-sm border border-border overflow-hidden rounded-xl p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("div",{className:"h-4 bg-muted rounded w-32"}),u.jsx("div",{className:"w-5 h-5 bg-muted rounded"})]}),u.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),u.jsx("div",{className:"h-3 bg-muted rounded w-20"})]})},f))}),u.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),u.jsx("div",{className:"h-64 bg-muted rounded"})]})}),u.jsxs("section",{className:"flex gap-4 flex-col lg:flex-row",children:[u.jsx("div",{className:"flex-1 bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-4"}),u.jsx("div",{className:"h-48 bg-muted rounded"})]})}),u.jsx("div",{className:"p-5 border w-full lg:w-min rounded-lg bg-card",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-24 mb-4"}),u.jsx("div",{className:"h-48 bg-muted rounded"})]})})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-4",children:[u.jsx(jS,{name:"Registered Vehicles",value:r.vehicles.total.toString(),icon:Gf,statuses:[{label:`${r.vehicles.active} Active`,color:"#047857",bgColor:"#d1fae5"},{label:`${r.vehicles.expired} Expired`,color:"#dc2626",bgColor:"#fee2e2"}]}),u.jsx(jS,{name:"Registered Drivers",value:r.drivers.total.toString(),icon:DW}),u.jsx(jS,{name:"Violations",value:r.violations.total.toString(),icon:Nce}),u.jsx(jS,{name:"Accidents",value:r.accidents.total.toString(),icon:_1})]}),u.jsx(JLe,{}),u.jsxs("section",{className:"flex gap-4 flex-col lg:flex-row",children:[u.jsx(fBe,{}),u.jsx("div",{className:"p-5 border w-full lg:w-min rounded-lg ",children:u.jsx(jw,{mode:"single",className:"w-full"})})]})]})]})},mBe=({allowedRoles:e})=>{const t={employee:"2",admin:"1",superadmin:"0"},{isAuthenticated:r,isLoading:n,userData:a}=la(),l=no(),f=a==null?void 0:a.role;if(n)return u.jsx("div",{className:"h-screen flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const i=e.map(_=>t[_]);return r&&i.includes(f)?u.jsx(uW,{}):u.jsx(T3,{to:"/login",state:{from:l},replace:!0})},MN=({allowedRoles:e,children:t})=>{const{userData:r,loading:n}=la(),a=no(),l=r==null?void 0:r.role;if(n)return u.jsx("div",{children:"Loading..."});const f={employee:"2",admin:"1",superadmin:"0"};return e.map(_=>f[_]).includes(l)?t:u.jsx(T3,{to:"/",state:{from:a},replace:!0})},jN=768;function gBe(){const[e,t]=H.useState(void 0);return H.useEffect(()=>{const r=window.matchMedia(`(max-width: ${jN-1}px)`),n=()=>{t(window.innerWidth<jN)};return r.addEventListener("change",n),t(window.innerWidth<jN),()=>r.removeEventListener("change",n)},[]),!!e}var yBe="Separator",qG="horizontal",vBe=["horizontal","vertical"],Rre=H.forwardRef((e,t)=>{const{decorative:r,orientation:n=qG,...a}=e,l=xBe(n)?n:qG,i=r?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return u.jsx(gi.div,{"data-orientation":l,...i,...a,ref:t})});Rre.displayName=yBe;function xBe(e){return vBe.includes(e)}var Ire=Rre;const yC=H.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},a)=>u.jsx(Ire,{ref:a,decorative:r,orientation:t,className:Wt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));yC.displayName=Ire.displayName;const _Be=hD,bBe=fD,Dre=H.forwardRef(({className:e,...t},r)=>u.jsx(Gw,{className:Wt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Dre.displayName=Gw.displayName;const wBe=h_("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Lre=H.forwardRef(({side:e="right",className:t,children:r,...n},a)=>u.jsxs(bBe,{children:[u.jsx(Dre,{}),u.jsxs(Ww,{ref:a,className:Wt(wBe({side:e}),t),...n,children:[u.jsxs(AP,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[u.jsx(b1,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]}),r]})]}));Lre.displayName=Ww.displayName;const zre=({className:e,...t})=>u.jsx("div",{className:Wt("flex flex-col space-y-2 text-center sm:text-left",e),...t});zre.displayName="SheetHeader";const Fre=H.forwardRef(({className:e,...t},r)=>u.jsx(Hw,{ref:r,className:Wt("text-lg font-semibold text-foreground",e),...t}));Fre.displayName=Hw.displayName;const Bre=H.forwardRef(({className:e,...t},r)=>u.jsx(Kw,{ref:r,className:Wt("text-sm text-muted-foreground",e),...t}));Bre.displayName=Kw.displayName;const SBe="sidebar_state",ABe=60*60*24*7,TBe="16rem",PBe="18rem",CBe="3rem",EBe="b",Vre=H.createContext(null);function R_(){const e=H.useContext(Vre);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Ure=H.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:r,className:n,style:a,children:l,...f},i)=>{const _=gBe(),[w,A]=H.useState(!1),[E,O]=H.useState(e),F=t??E,U=H.useCallback(Z=>{const ne=typeof Z=="function"?Z(F):Z;r?r(ne):O(ne),document.cookie=`${SBe}=${ne}; path=/; max-age=${ABe}`},[r,F]),B=H.useCallback(()=>_?A(Z=>!Z):U(Z=>!Z),[_,U,A]);H.useEffect(()=>{const Z=ne=>{ne.key===EBe&&(ne.metaKey||ne.ctrlKey)&&(ne.preventDefault(),B())};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[B]);const q=F?"expanded":"collapsed",W=H.useMemo(()=>({state:q,open:F,setOpen:U,isMobile:_,openMobile:w,setOpenMobile:A,toggleSidebar:B}),[q,F,U,_,w,A,B]);return u.jsx(Vre.Provider,{value:W,children:u.jsx(bre,{delayDuration:0,children:u.jsx("div",{style:{"--sidebar-width":TBe,"--sidebar-width-icon":CBe,...a},className:Wt("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:i,...f,children:l})})})});Ure.displayName="SidebarProvider";const $re=H.forwardRef(({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:n,children:a,...l},f)=>{const{isMobile:i,state:_,openMobile:w,setOpenMobile:A}=R_();return r==="none"?u.jsx("div",{className:Wt("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:f,...l,children:a}):i?u.jsx(_Be,{open:w,onOpenChange:A,...l,children:u.jsxs(Lre,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":PBe},side:e,children:[u.jsxs(zre,{className:"sr-only",children:[u.jsx(Fre,{children:"Sidebar"}),u.jsx(Bre,{children:"Displays the mobile sidebar."})]}),u.jsx("div",{className:"flex h-full w-full flex-col",children:a})]})}):u.jsxs("div",{ref:f,className:"group peer hidden text-sidebar-foreground md:block","data-state":_,"data-collapsible":_==="collapsed"?r:"","data-variant":t,"data-side":e,children:[u.jsx("div",{className:Wt("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),u.jsx("div",{className:Wt("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...l,children:u.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});$re.displayName="Sidebar";const qre=H.forwardRef(({className:e,onClick:t,...r},n)=>{const{toggleSidebar:a}=R_();return u.jsxs(Xr,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Wt("h-7 w-7",e),onClick:l=>{t==null||t(l),a()},...r,children:[u.jsx(wue,{}),u.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});qre.displayName="SidebarTrigger";const Gre=H.forwardRef(({className:e,...t},r)=>{const{toggleSidebar:n}=R_();return u.jsx("button",{ref:r,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:Wt("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});Gre.displayName="SidebarRail";const Wre=H.forwardRef(({className:e,...t},r)=>u.jsx("main",{ref:r,className:Wt("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));Wre.displayName="SidebarInset";const kBe=H.forwardRef(({className:e,...t},r)=>u.jsx(Vn,{ref:r,"data-sidebar":"input",className:Wt("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));kBe.displayName="SidebarInput";const Hre=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,"data-sidebar":"header",className:Wt("flex flex-col gap-2 p-2",e),...t}));Hre.displayName="SidebarHeader";const Kre=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,"data-sidebar":"footer",className:Wt("flex flex-col gap-2 p-2",e),...t}));Kre.displayName="SidebarFooter";const MBe=H.forwardRef(({className:e,...t},r)=>u.jsx(yC,{ref:r,"data-sidebar":"separator",className:Wt("mx-2 w-auto bg-sidebar-border",e),...t}));MBe.displayName="SidebarSeparator";const Zre=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,"data-sidebar":"content",className:Wt("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));Zre.displayName="SidebarContent";const fA=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,"data-sidebar":"group",className:Wt("relative flex w-full min-w-0 flex-col p-2",e),...t}));fA.displayName="SidebarGroup";const pA=H.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?Ul:"div";return u.jsx(a,{ref:n,"data-sidebar":"group-label",className:Wt("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...r})});pA.displayName="SidebarGroupLabel";const jBe=H.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?Ul:"button";return u.jsx(a,{ref:n,"data-sidebar":"group-action",className:Wt("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...r})});jBe.displayName="SidebarGroupAction";const OBe=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,"data-sidebar":"group-content",className:Wt("w-full text-sm",e),...t}));OBe.displayName="SidebarGroupContent";const fx=H.forwardRef(({className:e,...t},r)=>u.jsx("ul",{ref:r,"data-sidebar":"menu",className:Wt("flex w-full min-w-0 flex-col gap-1",e),...t}));fx.displayName="SidebarMenu";const md=H.forwardRef(({className:e,...t},r)=>u.jsx("li",{ref:r,"data-sidebar":"menu-item",className:Wt("group/menu-item relative",e),...t}));md.displayName="SidebarMenuItem";const NBe=h_("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),gd=H.forwardRef(({asChild:e=!1,isActive:t=!1,variant:r="default",size:n="default",tooltip:a,className:l,...f},i)=>{const _=e?Ul:"button",{isMobile:w,state:A}=R_(),E=u.jsx(_,{ref:i,"data-sidebar":"menu-button","data-size":n,"data-active":t,className:Wt(NBe({variant:r,size:n}),l),...f});return a?(typeof a=="string"&&(a={children:a}),u.jsxs(wre,{children:[u.jsx(Sre,{asChild:!0,children:E}),u.jsx(m4,{side:"right",align:"center",hidden:A!=="collapsed"||w,...a})]})):E});gd.displayName="SidebarMenuButton";const RBe=H.forwardRef(({className:e,asChild:t=!1,showOnHover:r=!1,...n},a)=>{const l=t?Ul:"button";return u.jsx(l,{ref:a,"data-sidebar":"menu-action",className:Wt("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...n})});RBe.displayName="SidebarMenuAction";const IBe=H.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,"data-sidebar":"menu-badge",className:Wt("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));IBe.displayName="SidebarMenuBadge";const DBe=H.forwardRef(({className:e,showIcon:t=!1,...r},n)=>{const a=H.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return u.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:Wt("flex h-8 items-center gap-2 rounded-md px-2",e),...r,children:[t&&u.jsx(qA,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),u.jsx(qA,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});DBe.displayName="SidebarMenuSkeleton";const y3=H.forwardRef(({className:e,...t},r)=>u.jsx("ul",{ref:r,"data-sidebar":"menu-sub",className:Wt("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));y3.displayName="SidebarMenuSub";const hv=H.forwardRef(({...e},t)=>u.jsx("li",{ref:t,...e}));hv.displayName="SidebarMenuSubItem";const fv=H.forwardRef(({asChild:e=!1,size:t="md",isActive:r,className:n,...a},l)=>{const f=e?Ul:"a";return u.jsx(f,{ref:l,"data-sidebar":"menu-sub-button","data-size":t,"data-active":r,className:Wt("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...a})});fv.displayName="SidebarMenuSubButton";var _4="Collapsible",[LBe,rUe]=kd(_4),[zBe,b4]=LBe(_4),Yre=H.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:l,onOpenChange:f,...i}=e,[_=!1,w]=Lg({prop:n,defaultProp:a,onChange:f});return u.jsx(zBe,{scope:r,disabled:l,contentId:Sd(),open:_,onOpenToggle:H.useCallback(()=>w(A=>!A),[w]),children:u.jsx(gi.div,{"data-state":S4(_),"data-disabled":l?"":void 0,...i,ref:t})})});Yre.displayName=_4;var Xre="CollapsibleTrigger",Jre=H.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=b4(Xre,r);return u.jsx(gi.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":S4(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:on(e.onClick,a.onOpenToggle)})});Jre.displayName=Xre;var w4="CollapsibleContent",Qre=H.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=b4(w4,e.__scopeCollapsible);return u.jsx(ku,{present:r||a.open,children:({present:l})=>u.jsx(FBe,{...n,ref:t,present:l})})});Qre.displayName=w4;var FBe=H.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...l}=e,f=b4(w4,r),[i,_]=H.useState(n),w=H.useRef(null),A=Xi(t,w),E=H.useRef(0),O=E.current,F=H.useRef(0),U=F.current,B=f.open||i,q=H.useRef(B),W=H.useRef(void 0);return H.useEffect(()=>{const Z=requestAnimationFrame(()=>q.current=!1);return()=>cancelAnimationFrame(Z)},[]),nl(()=>{const Z=w.current;if(Z){W.current=W.current||{transitionDuration:Z.style.transitionDuration,animationName:Z.style.animationName},Z.style.transitionDuration="0s",Z.style.animationName="none";const ne=Z.getBoundingClientRect();E.current=ne.height,F.current=ne.width,q.current||(Z.style.transitionDuration=W.current.transitionDuration,Z.style.animationName=W.current.animationName),_(n)}},[f.open,n]),u.jsx(gi.div,{"data-state":S4(f.open),"data-disabled":f.disabled?"":void 0,id:f.contentId,hidden:!B,...l,ref:A,style:{"--radix-collapsible-content-height":O?`${O}px`:void 0,"--radix-collapsible-content-width":U?`${U}px`:void 0,...e.style},children:B&&a})});function S4(e){return e?"open":"closed"}var BBe=Yre;const GG=BBe,WG=Jre,HG=Qre;function VBe(){const{isMobile:e}=R_(),t=la(),{logout:r,userData:n}=t||{},a=()=>{r()};return u.jsx(fx,{children:u.jsx(md,{children:u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(gd,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[u.jsxs(o3,{className:"h-8 w-8 rounded-lg",children:[u.jsx(l3,{src:n.avatar,alt:n.email}),u.jsx(c3,{className:"rounded-lg font-bold",children:n.email.charAt(0)})]}),u.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:u.jsx("span",{className:"truncate font-semibold",children:n.email})}),u.jsx(kW,{className:"ml-auto size-4"})]})}),u.jsxs(zc,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:e?"bottom":"right",align:"end",sideOffset:4,children:[u.jsx(Jg,{className:"p-0 font-normal",children:u.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[u.jsxs(o3,{className:"h-8 w-8 rounded-lg",children:[u.jsx(l3,{src:n.avatar,alt:n.email}),u.jsx(c3,{className:"rounded-lg font-bold",children:n.email.charAt(0)})]}),u.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:u.jsx("span",{className:"truncate font-semibold",children:n.email})})]})}),u.jsx(Rh,{}),u.jsx(Bpe,{children:u.jsxs(Aa,{children:[u.jsx(Pce,{}),"Account"]})}),u.jsx(Rh,{}),u.jsxs(Aa,{onSelect:a,children:[u.jsx(yue,{}),"Log out"]})]})]})})})}function UBe(e){const t=no(),r=la(),{userData:n}=r||{},{state:a}=R_(),[l,f]=H.useState(!1),[i,_]=H.useState(!1),w=a==="collapsed",A=F=>{f(F),F&&_(!1)},E=F=>{_(F),F&&f(!1)},O=(n==null?void 0:n.role)==="0"||(n==null?void 0:n.role)==="1";return n==null||n.role,u.jsxs($re,{collapsible:"icon",...e,children:[u.jsx(Hre,{className:"group-data-[collapsible=icon]:flex group-data-[collapsible=icon]:justify-center",children:u.jsx(fx,{children:u.jsx(md,{children:u.jsxs(gd,{tooltip:"LTO WebSystem",className:"group-data-[collapsible=icon]:justify-center",children:[u.jsx("div",{className:"flex aspect-square size-8 items-center justify-center rounded-lg text-sidebar-primary-foreground group-data-[collapsible=icon]:size-6",children:u.jsx("img",{src:Cle,className:"h-7 w-7 object-contain group-data-[collapsible=icon]:h-6 group-data-[collapsible=icon]:w-6",alt:"LTO Logo"})}),u.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight group-data-[collapsible=icon]:hidden",children:[u.jsx("span",{className:"truncate font-semibold",children:"LTO WebSystem"}),u.jsx("span",{className:"truncate text-xs",children:"Land Transportation Office"})]})]})})})}),u.jsxs(Zre,{children:[u.jsxs(fA,{children:[u.jsx(pA,{children:"Menu"}),u.jsxs(fx,{className:"",children:[u.jsx(md,{children:u.jsx(gd,{isActive:t.pathname==="/",asChild:!0,children:u.jsxs(jo,{to:"/",children:[u.jsx(Fue,{}),u.jsx("span",{children:"Dashboard"})]})})}),u.jsx(md,{children:u.jsx(gd,{isActive:t.pathname==="/vehicle",asChild:!0,children:u.jsxs(jo,{to:"/vehicle",children:[u.jsx(Gf,{}),u.jsx("span",{children:"Manage Vehicles"})]})})}),u.jsx(md,{children:u.jsx(gd,{isActive:t.pathname==="/driver",asChild:!0,children:u.jsxs(jo,{to:"/driver",children:[u.jsx(DW,{}),u.jsx("span",{children:"Manage Drivers"})]})})}),u.jsx(md,{children:u.jsx(gd,{isActive:t.pathname==="/violation",asChild:!0,children:u.jsxs(jo,{to:"/violation",children:[u.jsx(zE,{}),u.jsx("span",{children:"Manage Violations"})]})})}),u.jsx(md,{children:u.jsx(gd,{isActive:t.pathname==="/accident",asChild:!0,children:u.jsxs(jo,{to:"/accident",children:[u.jsx(LE,{}),u.jsx("span",{children:"Manage Accidents"})]})})})]})]}),u.jsxs(fA,{children:[u.jsx(pA,{children:"Analytics"}),u.jsx(fx,{children:w?u.jsx(md,{children:u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(gd,{tooltip:"Analytics",children:[u.jsx(_1,{}),u.jsx("span",{children:"Analytics"})]})}),u.jsxs(zc,{side:"right",align:"start",className:"w-48",children:[u.jsx(Aa,{asChild:!0,children:u.jsxs(jo,{to:"/analytics/registration",className:"flex items-center gap-2",children:[u.jsx(lB,{className:"h-4 w-4"}),u.jsx("span",{children:"Registration"})]})}),u.jsx(Aa,{asChild:!0,children:u.jsxs(jo,{to:"/analytics/violation",className:"flex items-center gap-2",children:[u.jsx(zE,{className:"h-4 w-4"}),u.jsx("span",{children:"Violation"})]})}),u.jsx(Aa,{asChild:!0,children:u.jsxs(jo,{to:"/analytics/accident",className:"flex items-center gap-2",children:[u.jsx(LE,{className:"h-4 w-4"}),u.jsx("span",{children:"Accident"})]})})]})]})}):u.jsx(GG,{asChild:!0,className:"group/collapsible",open:l,onOpenChange:A,children:u.jsxs(md,{children:[u.jsx(WG,{asChild:!0,children:u.jsxs(gd,{children:[u.jsx(_1,{}),u.jsx("span",{children:"Analytics"}),u.jsx(bx,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),u.jsx(HG,{children:u.jsxs(y3,{children:[u.jsx(hv,{children:u.jsx(fv,{isActive:t.pathname==="/analytics/registration",asChild:!0,children:u.jsxs(jo,{to:"/analytics/registration",children:[u.jsx(lB,{}),u.jsx("span",{children:"Registration"})]})})}),u.jsx(hv,{children:u.jsx(fv,{isActive:t.pathname==="/analytics/violation",asChild:!0,children:u.jsxs(jo,{to:"/analytics/violation",children:[u.jsx(zE,{}),u.jsx("span",{children:"Violation"})]})})}),u.jsx(hv,{children:u.jsx(fv,{isActive:t.pathname==="/analytics/accident",asChild:!0,children:u.jsxs(jo,{to:"/analytics/accident",children:[u.jsx(LE,{}),u.jsx("span",{children:"Accident"})]})})})]})})]})})})]}),O&&u.jsxs(fA,{children:[u.jsx(pA,{children:"Account Management"}),u.jsx(fx,{children:w?u.jsx(md,{children:u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(gd,{tooltip:"Manage Account",children:[u.jsx(Rg,{}),u.jsx("span",{children:"Manage Account"})]})}),u.jsxs(zc,{side:"right",align:"start",className:"w-48",children:[u.jsx(Aa,{asChild:!0,children:u.jsxs(jo,{to:"/account/register",className:"flex items-center gap-2",children:[u.jsx(yA,{className:"h-4 w-4"}),u.jsx("span",{children:"Register Account"})]})}),u.jsx(Aa,{asChild:!0,children:u.jsxs(jo,{to:"/account/update",className:"flex items-center gap-2",children:[u.jsx(Nc,{className:"h-4 w-4"}),u.jsx("span",{children:"Update Account"})]})}),u.jsx(Aa,{asChild:!0,children:u.jsxs(jo,{to:"/account/logs",className:"flex items-center gap-2",children:[u.jsx(jv,{className:"h-4 w-4"}),u.jsx("span",{children:"View Account Logs"})]})})]})]})}):u.jsx(GG,{asChild:!0,className:"group/collapsible",open:i,onOpenChange:E,children:u.jsxs(md,{children:[u.jsx(WG,{asChild:!0,children:u.jsxs(gd,{children:[u.jsx(Rg,{}),u.jsx("span",{children:"Manage Account"}),u.jsx(bx,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),u.jsx(HG,{children:u.jsxs(y3,{children:[u.jsx(hv,{children:u.jsx(fv,{isActive:t.pathname==="/account/register",asChild:!0,children:u.jsxs(jo,{to:"/account/register",children:[u.jsx(yA,{}),u.jsx("span",{children:"Register Account"})]})})}),u.jsx(hv,{children:u.jsx(fv,{isActive:t.pathname==="/account/update",asChild:!0,children:u.jsxs(jo,{to:"/account/update",children:[u.jsx(Nc,{}),u.jsx("span",{children:"Update Account"})]})})}),u.jsx(hv,{children:u.jsx(fv,{isActive:t.pathname==="/account/logs",asChild:!0,children:u.jsxs(jo,{to:"/account/logs",children:[u.jsx(jv,{}),u.jsx("span",{children:"View Account Logs"})]})})})]})})]})})})]})]}),u.jsx(Kre,{children:u.jsx(VBe,{})}),u.jsx(Gre,{})]})}const ene=H.forwardRef(({...e},t)=>u.jsx("nav",{ref:t,"aria-label":"breadcrumb",...e}));ene.displayName="Breadcrumb";const tne=H.forwardRef(({className:e,...t},r)=>u.jsx("ol",{ref:r,className:Wt("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...t}));tne.displayName="BreadcrumbList";const v3=H.forwardRef(({className:e,...t},r)=>u.jsx("li",{ref:r,className:Wt("inline-flex items-center gap-1.5",e),...t}));v3.displayName="BreadcrumbItem";const rne=H.forwardRef(({asChild:e,className:t,...r},n)=>{const a=e?Ul:"a";return u.jsx(a,{ref:n,className:Wt("transition-colors hover:text-foreground",t),...r})});rne.displayName="BreadcrumbLink";const nne=H.forwardRef(({className:e,...t},r)=>u.jsx("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:Wt("font-normal text-foreground",e),...t}));nne.displayName="BreadcrumbPage";const ine=({children:e,className:t,...r})=>u.jsx("li",{role:"presentation","aria-hidden":"true",className:Wt("[&>svg]:w-3.5 [&>svg]:h-3.5",t),...r,children:e??u.jsx(bx,{})});ine.displayName="BreadcrumbSeparator";const $Be=()=>{Na();const e=no(),t=()=>{switch(e.pathname){case"/":return"Overview";case"/driver":return"Drivers";case"/vehicle":return"Vehicles";case"/violation":return"Violations";case"/accident":return"Accidents";case"/analytics/registration":return"Registration Analytics";case"/analytics/violation":return"Violation Analytics";case"/analytics/accident":return"Accident Analytics";case"/account/register":return"Register Account";case"/account/update":return"Update Account";case"/account/logs":return"Account Logs";default:return"Overview"}};return u.jsx(u.Fragment,{children:u.jsxs(Ure,{children:[u.jsx(UBe,{}),u.jsxs(Wre,{children:[u.jsxs("header",{className:"flex justify-between border-b h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12 bg-white dark:bg-black border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-2 px-4",children:[u.jsx(qre,{className:"-ml-1"}),u.jsx(yC,{orientation:"vertical",className:"mr-2 h-4"}),u.jsx(ene,{children:u.jsxs(tne,{children:[u.jsx(v3,{className:"hidden md:block",children:u.jsx(rne,{href:"/",children:"Dashboard"})}),u.jsx(ine,{className:"hidden md:block"}),u.jsx(v3,{children:u.jsx(nne,{children:t()})})]})})]}),u.jsx("div",{className:"px-4 md:px-8",children:u.jsx(Wpe,{})})]}),u.jsx("main",{className:"md:p-4 h-full flex flex-col overflow-hidden",children:u.jsx(uW,{})})]})]})})},qBe=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:l,loading:f,onNavigate:i,onAdd:_,onRowClick:w,onEdit:A,onDelete:E})=>{var ge;const[O,F]=Re.useState([]),[U,B]=Re.useState([]),[q,W]=Re.useState({}),[Z,ne]=Re.useState({pageIndex:0,pageSize:8}),[ae,ee]=Re.useState(""),se=r,ce=S2({data:l,columns:a(A,E),onSortingChange:F,onColumnFiltersChange:B,onPaginationChange:ne,getCoreRowModel:x2(),getPaginationRowModel:b2(),getSortedRowModel:w2(),getFilteredRowModel:_2(),onColumnVisibilityChange:W,onGlobalFilterChange:ee,globalFilterFn:(Te,Ae,_e)=>se.some(Ee=>{const ke=Te.getValue(Ee);return String(ke).toLowerCase().includes(_e.toLowerCase())}),state:{pagination:Z,sorting:O,columnFilters:U,columnVisibility:q,globalFilter:ae}});return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx(os,{className:"font-semibold",children:t}),u.jsxs("div",{className:`md:flex items-center justify-between py-3 flex-shrink-0
        `,children:[u.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[u.jsx(tP,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx(Vn,{placeholder:"Search Driver...",value:ae??"",onChange:Te=>ee(Te.target.value),className:"pl-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"})]}),u.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[u.jsxs(Xr,{onClick:_,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[u.jsx(Wv,{}),u.jsx("span",{className:"hidden lg:inline",children:"Add Driver"})]}),u.jsx(T2,{table:ce})]})]}),u.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0",children:u.jsx("div",{className:"overflow-auto h-full",children:u.jsx("div",{className:"px-4",children:u.jsxs(oy,{children:[u.jsx(ly,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:ce.getHeaderGroups().map(Te=>u.jsx(Bs,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:Te.headers.map(Ae=>u.jsx(Js,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",children:tp(Ae.column.columnDef.header,Ae.getContext())},Ae.id))},Te.id))}),u.jsx(cy,{className:"text-xs bg-white dark:bg-transparent",children:f?u.jsx(A2,{rowCount:5,cellCount:ce.getAllColumns().length}):(ge=ce.getRowModel().rows)!=null&&ge.length?ce.getRowModel().rows.map(Te=>u.jsx(Bs,{onClick:()=>w(Te.original),"data-state":Te.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:Te.getVisibleCells().map(Ae=>u.jsx(Oa,{className:"px-3 py-2 text-gray-800 dark:text-gray-200 text-left",children:tp(Ae.column.columnDef.cell,Ae.getContext())},Ae.id))},Te.id)):u.jsx(Bs,{className:"hover:bg-transparent",children:u.jsx(Oa,{colSpan:ce.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),u.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),u.jsx("div",{className:"mt-3 flex-shrink-0",children:u.jsx(P2,{table:ce})})]})};var ane="AlertDialog",[GBe,nUe]=kd(ane,[wZ]),Am=wZ(),sne=e=>{const{__scopeAlertDialog:t,...r}=e,n=Am(t);return u.jsx(hD,{...n,...r,modal:!0})};sne.displayName=ane;var WBe="AlertDialogTrigger",HBe=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Am(r);return u.jsx(yve,{...a,...n,ref:t})});HBe.displayName=WBe;var KBe="AlertDialogPortal",one=e=>{const{__scopeAlertDialog:t,...r}=e,n=Am(t);return u.jsx(fD,{...n,...r})};one.displayName=KBe;var ZBe="AlertDialogOverlay",lne=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Am(r);return u.jsx(Gw,{...a,...n,ref:t})});lne.displayName=ZBe;var _x="AlertDialogContent",[YBe,XBe]=GBe(_x),cne=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,l=Am(r),f=H.useRef(null),i=Xi(t,f),_=H.useRef(null);return u.jsx(fve,{contentName:_x,titleName:une,docsSlug:"alert-dialog",children:u.jsx(YBe,{scope:r,cancelRef:_,children:u.jsxs(Ww,{role:"alertdialog",...l,...a,ref:i,onOpenAutoFocus:on(a.onOpenAutoFocus,w=>{var A;w.preventDefault(),(A=_.current)==null||A.focus({preventScroll:!0})}),onPointerDownOutside:w=>w.preventDefault(),onInteractOutside:w=>w.preventDefault(),children:[u.jsx(E3,{children:n}),u.jsx(QBe,{contentRef:f})]})})})});cne.displayName=_x;var une="AlertDialogTitle",dne=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Am(r);return u.jsx(Hw,{...a,...n,ref:t})});dne.displayName=une;var hne="AlertDialogDescription",fne=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Am(r);return u.jsx(Kw,{...a,...n,ref:t})});fne.displayName=hne;var JBe="AlertDialogAction",pne=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Am(r);return u.jsx(AP,{...a,...n,ref:t})});pne.displayName=JBe;var mne="AlertDialogCancel",gne=H.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=XBe(mne,r),l=Am(r),f=Xi(t,a);return u.jsx(AP,{...l,...n,ref:f})});gne.displayName=mne;var QBe=({contentRef:e})=>{const t=`\`${_x}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${_x}\` by passing a \`${hne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${_x}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return H.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},e6e=sne,t6e=one,yne=lne,vne=cne,xne=pne,_ne=gne,bne=dne,wne=fne;const Sne=e6e,r6e=t6e,Ane=H.forwardRef(({className:e,...t},r)=>u.jsx(yne,{className:Wt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Ane.displayName=yne.displayName;const A4=H.forwardRef(({className:e,...t},r)=>u.jsxs(r6e,{children:[u.jsx(Ane,{}),u.jsx(vne,{ref:r,className:Wt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));A4.displayName=vne.displayName;const T4=({className:e,...t})=>u.jsx("div",{className:Wt("flex flex-col space-y-2 text-center sm:text-left",e),...t});T4.displayName="AlertDialogHeader";const P4=({className:e,...t})=>u.jsx("div",{className:Wt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});P4.displayName="AlertDialogFooter";const C4=H.forwardRef(({className:e,...t},r)=>u.jsx(bne,{ref:r,className:Wt("text-lg font-semibold",e),...t}));C4.displayName=bne.displayName;const E4=H.forwardRef(({className:e,...t},r)=>u.jsx(wne,{ref:r,className:Wt("text-sm text-muted-foreground",e),...t}));E4.displayName=wne.displayName;const k4=H.forwardRef(({className:e,...t},r)=>u.jsx(xne,{ref:r,className:Wt(x1({variant:"outline"}),e),...t}));k4.displayName=xne.displayName;const M4=H.forwardRef(({className:e,...t},r)=>u.jsx(_ne,{ref:r,className:Wt(x1(),"mt-2 sm:mt-0",e),...t}));M4.displayName=_ne.displayName;const Tne=({open:e,onOpenChange:t,confirm:r,cancel:n,title:a,description:l})=>u.jsx(Sne,{open:e,onOpenChange:t,children:u.jsxs(A4,{className:"",children:[u.jsxs(T4,{children:[u.jsx(C4,{children:a}),u.jsx(E4,{children:l})]}),u.jsxs(P4,{children:[u.jsx(M4,{onClick:n,children:"Cancel"}),u.jsx(k4,{onClick:r,children:"Continue"})]})]})});var j4="Popover",[Pne,iUe]=kd(j4,[Xg]),C2=Xg(),[n6e,uy]=Pne(j4),Cne=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:f=!1}=e,i=C2(t),_=H.useRef(null),[w,A]=H.useState(!1),[E=!1,O]=Lg({prop:n,defaultProp:a,onChange:l});return u.jsx(sP,{...i,children:u.jsx(n6e,{scope:t,contentId:Sd(),triggerRef:_,open:E,onOpenChange:O,onOpenToggle:H.useCallback(()=>O(F=>!F),[O]),hasCustomAnchor:w,onCustomAnchorAdd:H.useCallback(()=>A(!0),[]),onCustomAnchorRemove:H.useCallback(()=>A(!1),[]),modal:f,children:r})})};Cne.displayName=j4;var Ene="PopoverAnchor",i6e=H.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=uy(Ene,r),l=C2(r),{onCustomAnchorAdd:f,onCustomAnchorRemove:i}=a;return H.useEffect(()=>(f(),()=>i()),[f,i]),u.jsx(Lw,{...l,...n,ref:t})});i6e.displayName=Ene;var kne="PopoverTrigger",Mne=H.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=uy(kne,r),l=C2(r),f=Xi(t,a.triggerRef),i=u.jsx(gi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Ine(a.open),...n,ref:f,onClick:on(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:u.jsx(Lw,{asChild:!0,...l,children:i})});Mne.displayName=kne;var O4="PopoverPortal",[a6e,s6e]=Pne(O4,{forceMount:void 0}),jne=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,l=uy(O4,t);return u.jsx(a6e,{scope:t,forceMount:r,children:u.jsx(ku,{present:r||l.open,children:u.jsx(v_,{asChild:!0,container:a,children:n})})})};jne.displayName=O4;var l_="PopoverContent",One=H.forwardRef((e,t)=>{const r=s6e(l_,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,l=uy(l_,e.__scopePopover);return u.jsx(ku,{present:n||l.open,children:l.modal?u.jsx(o6e,{...a,ref:t}):u.jsx(l6e,{...a,ref:t})})});One.displayName=l_;var o6e=H.forwardRef((e,t)=>{const r=uy(l_,e.__scopePopover),n=H.useRef(null),a=Xi(t,n),l=H.useRef(!1);return H.useEffect(()=>{const f=n.current;if(f)return uP(f)},[]),u.jsx(zw,{as:Ul,allowPinchZoom:!0,children:u.jsx(Nne,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:on(e.onCloseAutoFocus,f=>{var i;f.preventDefault(),l.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:on(e.onPointerDownOutside,f=>{const i=f.detail.originalEvent,_=i.button===0&&i.ctrlKey===!0,w=i.button===2||_;l.current=w},{checkForDefaultPrevented:!1}),onFocusOutside:on(e.onFocusOutside,f=>f.preventDefault(),{checkForDefaultPrevented:!1})})})}),l6e=H.forwardRef((e,t)=>{const r=uy(l_,e.__scopePopover),n=H.useRef(!1),a=H.useRef(!1);return u.jsx(Nne,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,w;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=l.target;((w=r.triggerRef.current)==null?void 0:w.contains(f))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),Nne=H.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:f,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:w,onInteractOutside:A,...E}=e,O=uy(l_,r),F=C2(r);return rP(),u.jsx(Iw,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:u.jsx(m_,{asChild:!0,disableOutsidePointerEvents:f,onInteractOutside:A,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:w,onDismiss:()=>O.onOpenChange(!1),children:u.jsx(oP,{"data-state":Ine(O.open),role:"dialog",id:O.contentId,...F,...E,ref:t,style:{...E.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Rne="PopoverClose",c6e=H.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=uy(Rne,r);return u.jsx(gi.button,{type:"button",...n,ref:t,onClick:on(e.onClick,()=>a.onOpenChange(!1))})});c6e.displayName=Rne;var u6e="PopoverArrow",d6e=H.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=C2(r);return u.jsx(lP,{...a,...n,ref:t})});d6e.displayName=u6e;function Ine(e){return e?"open":"closed"}var h6e=Cne,f6e=Mne,p6e=jne,Dne=One;const qv=h6e,Gv=f6e,Yg=H.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>u.jsx(p6e,{children:u.jsx(Dne,{ref:a,align:t,sideOffset:r,className:Wt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Yg.displayName=Dne.displayName;const E2=({fieldValue:e,dateValue:t})=>{const r=new Date,[n,a]=H.useState(e||r),[l,f]=H.useState((e||r).getFullYear()),[i,_]=H.useState((e||r).getMonth()),w=O=>{f(O);const F=s3(n,O);a(F),t&&t(F)},A=O=>{_(O);const F=dA(n,O);a(F),t&&t(F)},E=O=>{O&&(a(O),f(O.getFullYear()),_(O.getMonth()),t&&t(O))};return H.useEffect(()=>{e&&(a(e),f(e.getFullYear()),_(e.getMonth()))},[e]),u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(Io,{onValueChange:O=>A(parseInt(O,10)),value:i.toString(),children:[u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select Month"})}),u.jsx(go,{children:Array.from({length:12},(O,F)=>u.jsx(_n,{value:F.toString(),children:Fc(new Date(2e3,F,1),"MMMM")},F))})]}),u.jsxs(Io,{onValueChange:O=>w(parseInt(O,10)),value:l.toString(),children:[u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select Year"})}),u.jsx(go,{children:Array.from({length:150},(O,F)=>{const U=new Date().getFullYear()-50+F;return u.jsx(_n,{value:U.toString(),children:U},U)})})]})]}),u.jsx("div",{className:"border rounded-md",children:u.jsx(jw,{mode:"single",selected:n,onSelect:E,disabled:O=>O<new Date("1900-01-01"),fromYear:1900,toYear:new Date().getFullYear()+10,month:n,onMonthChange:O=>{a(O),f(O.getFullYear()),_(O.getMonth())}})}),u.jsx("div",{className:"flex justify-end",children:u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>{_(r.getMonth()),f(r.getFullYear()),a(r),t&&t(r)},children:"Today"})})]})},Mf={region:"DAVAO ORIENTAL",municipalities:{BANAYBANAY:{barangays:{CABANGCALAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CAGANGANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CALUBIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAUSWAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MOGBONGCOGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},PANIKIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PINTATAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PISO PROPER":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"PUNTA LINAO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"RANG-AY":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BOSTON:{barangays:{CAATIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABASAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CARMEN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAWAYANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SIBAJAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SIMULAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BAGANGA:{barangays:{BACULIN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BATAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATIANO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BINONDO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBONAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMPAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DAPNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},KINABLANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBAJON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHANUB:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MIKIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SALINGCOMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICTOR":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAOQUEGUE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CARAGA:{barangays:{ALVAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CANINGAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON LEON BALANTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMIAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANORIGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MERCEDES:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PALMA GIL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PICHON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN LUIS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN PEDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SANTA FE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANTIAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SOBRECAREY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CATEEL:{barangays:{ABIJOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ALEGRIA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ALIWAGWAG:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ARAGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BAYBAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGLAHUS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAINIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MALIBAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ALFONSO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN RAFAEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTA FILOMENA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAYTAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]}}},"GOVERNOR GENEROSO":{barangays:{ANITAP:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"CRISPIN DELA CRUZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON AURELIO CHICOTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAVIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUZON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGDUG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"MANUEL ROXAS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MONTSERRAT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},NANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},OREGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},PUNDAGUITAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SERGIO OSMEA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SUROP:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABEBE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"TANDANG SORA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TIBANBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TIBLAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"UPPER TIBANBAN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},LUPON:{barangays:{BAGUMBAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABADIANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CALAPAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},COCORNON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CORPORACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON MARIANO MARCOS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ILANGAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANTAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMBAHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACANGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGSAYSAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAHAYAHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MARAGATAS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MARAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW VISAYAS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGBOA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGUGPO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},MANAY:{barangays:{CAPASNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAYAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CONCEPCION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DEL PILAR":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},GUZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"HOLY CROSS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBOG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MABINI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MANREZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW TAOKANGA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"OLD MACOPA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},RIZAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN FERMIN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN IGNACIO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ZARAGOSA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},"CITY OF MATI":{barangays:{BADAS:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BUSO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABUAYA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CULIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAHICAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON ENRIQUE LOPEZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON MARTIN MARUNDAN":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON SALVADOR LOPEZ, SR.":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAWIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LIBUDON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LUBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACAMBOL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAMALI:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MATIAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAYO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAINZ:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANGHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABAKID:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGBINONGA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGUIBO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMISAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},"SAN ISIDRO":{barangays:{BAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATOBATO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BITAOGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMBALEON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DUGMANON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},IBA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"LA UNION":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"LAPU-LAPU":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANIKLING:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ROQUE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTO ROSARIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SUDLON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TALISAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},TARRAGONA:{barangays:{CABAGAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DADONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},JOVELLAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCATAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGANDA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},OMPAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TOMOAONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TUBAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}}}},m6e=({form:e,onLocationChange:t})=>{const[r,n]=H.useState(""),[a,l]=H.useState(""),[f,i]=H.useState(""),[_,w]=H.useState(""),[A,E]=H.useState(""),[O,F]=H.useState(""),B=Object.keys(Mf.municipalities).filter(ce=>ce.toLowerCase().includes(_.toLowerCase())),W=(r?Object.keys(Mf.municipalities[r].barangays):[]).filter(ce=>ce.toLowerCase().includes(A.toLowerCase())),ne=(r&&a?Mf.municipalities[r].barangays[a].puroks:[]).filter(ce=>ce.toLowerCase().includes(O.toLowerCase())),ae=ce=>{console.log("Setting municipality:",ce),n(ce),l(""),i(""),w(""),E(""),F(""),console.log("=== SETTING MUNICIPALITY ==="),console.log("Setting municipality to:",ce),e.setValue("municipality",ce,{shouldValidate:!0,shouldDirty:!0}),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("province",Mf.region,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after municipality change:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")}),setTimeout(()=>{console.log("Form values after 100ms delay:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},100),t&&t({region:Mf.region,municipality:ce,barangay:"",purok:""})},ee=ce=>{console.log("Setting barangay:",ce),l(ce),i(""),E(""),F(""),console.log("=== SETTING BARANGAY ==="),console.log("Setting barangay to:",ce),e.setValue("barangay",ce,{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after barangay change:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")}),setTimeout(()=>{console.log("Form values after barangay 100ms delay:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},100),t&&t({region:Mf.region,municipality:r,barangay:ce,purok:""})},se=ce=>{i(ce),F(""),e.setValue("purok",ce,{shouldValidate:!0,shouldDirty:!0}),t&&t({region:Mf.region,municipality:r,barangay:a,purok:ce})};return H.useEffect(()=>{console.log("Initializing province:",Mf.region),e.setValue("province",Mf.region,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after province initialization:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},[e]),H.useEffect(()=>{const ce=ge=>{(_||A||O)&&!ge.target.closest(".relative")&&(w(""),E(""),F(""))};return document.addEventListener("mousedown",ce),()=>{document.removeEventListener("mousedown",ce)}},[_,A,O]),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"space-y-0",children:[u.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Province"}),u.jsx("div",{className:"mt-0 p-3 bg-muted rounded-md border",children:u.jsx("span",{className:"text-sm font-medium",children:Mf.region})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"space-y-0",children:[u.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Municipality"}),u.jsxs("div",{className:"relative mt-0",children:[u.jsx(Vn,{type:"text",placeholder:"Type to search municipality...",value:r||_,onChange:ce=>{const ge=ce.target.value.toUpperCase();w(ge),r&&ge!==r&&(n(""),l(""),i(""),e.setValue("municipality","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},className:Wt("mt-1",e.formState.errors.municipality&&"border-red-400")}),_&&u.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:B.length>0?B.map(ce=>u.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ae(ce),children:ce},ce)):u.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No municipalities found"})})]}),e.formState.errors.municipality&&u.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.municipality.message})]}),u.jsxs("div",{className:"space-y-0",children:[u.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Barangay"}),u.jsxs("div",{className:"relative mt-0",children:[u.jsx(Vn,{type:"text",placeholder:r?"Type to search barangay...":"Select municipality first",value:a||A,onChange:ce=>{const ge=ce.target.value.toUpperCase();E(ge),a&&ge!==a&&(l(""),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},disabled:!r,className:Wt("mt-1",!r&&"opacity-50 cursor-not-allowed",e.formState.errors.barangay&&"border-red-400")}),r&&A&&u.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:W.length>0?W.map(ce=>u.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ee(ce),children:ce},ce)):u.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No barangays found"})})]}),e.formState.errors.barangay&&u.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.barangay.message})]}),u.jsxs("div",{className:"space-y-0",children:[u.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Purok"}),u.jsxs("div",{className:"relative mt-0",children:[u.jsx(Vn,{type:"text",placeholder:a?"Type to search purok...":"Select barangay first",value:f||O,onChange:ce=>{const ge=ce.target.value.toUpperCase();F(ge),f&&ge!==f&&(i(""),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},disabled:!a,className:Wt("mt-1",!a&&"opacity-50 cursor-not-allowed",e.formState.errors.purok&&"border-red-400")}),a&&O&&u.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:ne.length>0?ne.map(ce=>u.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>se(ce),children:ce},ce)):u.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No puroks found"})})]}),e.formState.errors.purok&&u.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.purok.message})]})]})]})},Lne=({onSubmit:e,form:t,submitting:r,onCancel:n})=>(Na(),u.jsx(Zv,{...t,children:u.jsx("form",{id:"driver-form",onSubmit:t.handleSubmit(e),children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium",children:"Vehicle Information"}),u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-x-3",children:[u.jsx(Bn,{control:t.control,name:"plateNo",render:({field:a})=>u.jsxs(Dn,{className:"space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),u.jsx(On,{children:u.jsx(Vn,{...a,type:"text",placeholder:"ABC-123, DEF-456",value:Array.isArray(a.value)?a.value.join(", "):a.value||"",onChange:l=>{const f=l.target.value.toUpperCase(),i=f.split(",").map(_=>_.trim()).filter(_=>_.length>0);a.onChange(i.length>0?i:f)},className:Wt("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.plateNo&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"fileNo",render:({field:a})=>u.jsxs(Dn,{className:"space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),u.jsx(On,{className:"mt-0",children:u.jsx(Vn,{...a,type:"text",onChange:l=>{const f=l.target.value.toUpperCase();a.onChange(f)},className:Wt("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.fileNo&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"ownerRepresentativeName",render:({field:a})=>u.jsxs(Dn,{className:"space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.ownerRepresentativeName&&"text-red-400"),children:"Owner's Name"}),u.jsx(On,{children:u.jsx(Vn,{...a,type:"text",onChange:l=>{const f=l.target.value.toUpperCase();a.onChange(f)},className:Wt("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.ownerRepresentativeName&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})})]})]}),u.jsx("div",{children:u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[u.jsx(Bn,{control:t.control,name:"birthDate",render:({field:a})=>u.jsxs(Dn,{className:"lg:col-span-3 space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.birthDate&&"text-red-400"),children:"Birthday (Optional)"}),u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsx(On,{children:u.jsxs(Xr,{variant:"outline",className:Wt("w-full text-left font-normal justify-start",!a.value&&"text-muted-foreground",t.formState.errors.birthDate&&"border-red-400"),children:[u.jsx(wd,{className:"h-4 w-4 opacity-50"}),a.value?Fc(a.value,"PPP"):u.jsx("span",{children:"Pick a date"})]})})}),u.jsx(Yg,{className:"w-auto p-2 space-y-2",align:"start",children:u.jsx(E2,{fieldValue:a.value,dateValue:l=>t.setValue("birthDate",l,{shouldValidate:!0})})})]}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"contactNumber",render:({field:a})=>u.jsxs(Dn,{className:"lg:col-span-3 space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.contactNumber&&"text-red-400"),children:"Contact Number (Optional)"}),u.jsx(On,{children:u.jsx(Vn,{...a,type:"tel",className:Wt("text-black dark:text-white",t.formState.errors.contactNumber&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"emailAddress",render:({field:a})=>u.jsxs(Dn,{className:"lg:col-span-3 space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.emailAddress&&"text-red-400"),children:"Email Address (Optional)"}),u.jsx(On,{children:u.jsx(Vn,{...a,type:"email",className:Wt("text-black dark:text-white",t.formState.errors.emailAddress&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})})]})}),u.jsx("div",{children:u.jsx("div",{className:"mt-4",children:u.jsx(m6e,{form:t,onLocationChange:a=>{console.log("Location changed:",a)}})})}),u.jsx("div",{children:u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[u.jsx(Bn,{control:t.control,name:"hasDriversLicense",render:({field:a})=>{var l;return u.jsxs(Dn,{className:"lg:col-span-3 space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs",t.formState.errors.hasDriversLicense&&"text-red-400"),children:"Do you have Driver's License?"}),u.jsxs(Io,{onValueChange:f=>a.onChange(f==="true"),value:((l=a.value)==null?void 0:l.toString())||"",children:[u.jsx(On,{children:u.jsx(mo,{className:Wt("text-black dark:text-white",t.formState.errors.hasDriversLicense&&"border-red-400"),children:u.jsx(Do,{placeholder:"Choose option"})})}),u.jsx(go,{children:u.jsxs(t3,{children:[u.jsx(_n,{value:"true",children:"Yes"}),u.jsx(_n,{value:"false",children:"No"})]})})]}),u.jsx(zn,{className:"text-xs text-red-400"})]})}}),u.jsx(Bn,{control:t.control,name:"driversLicenseNumber",render:({field:a})=>u.jsxs(Dn,{className:"lg:col-span-3 space-y-0",children:[u.jsx(Ln,{className:Wt("text-muted-foreground text-xs mb-0",t.formState.errors.driversLicenseNumber&&"text-red-400"),children:"Driver's License Number"}),u.jsx(On,{children:u.jsx(Vn,{...a,type:"text",onChange:l=>{const f=l.target.value.toUpperCase();a.onChange(f)},className:Wt("text-black dark:text-white",t.formState.errors.driversLicenseNumber&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx("div",{className:"lg:col-span-6"})]})})]})})})),zne=({open:e,onOpenChange:t,onDriverAdded:r})=>{const[n,a]=H.useState(!1),[l,f]=H.useState(!1),[i,_]=H.useState(null),{token:w}=la(),A=Su(Date.now());Na();const E=Uh({defaultValues:{plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0},mode:"onChange"});H.useEffect(()=>{if(e){const q=sessionStorage.getItem("vehicleFormData");if(q){const W=JSON.parse(q);E.reset({plateNo:W.plateNo||"",fileNo:W.fileNo||"",ownerRepresentativeName:W.ownerRepresentativeName||"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0})}else E.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0});setTimeout(()=>{E.setValue("province","Davao Oriental"),console.log("Province set to:",E.getValues("province")),E.trigger()},100)}},[e,E]);const O=async q=>{const W=E.getValues();console.log("=== FORM SUBMISSION DEBUG ==="),console.log("Form values at submission:",W),console.log("Specific address values:"),console.log("  - barangay:",W.barangay,"(type:",typeof W.barangay,")"),console.log("  - municipality:",W.municipality,"(type:",typeof W.municipality,")"),console.log("  - province:",W.province,"(type:",typeof W.province,")"),console.log("  - purok:",W.purok,"(type:",typeof W.purok,")"),console.log("Value checks:"),console.log("  - barangay empty?",!W.barangay||W.barangay.trim()===""),console.log("  - municipality empty?",!W.municipality||W.municipality.trim()===""),console.log("  - province empty?",!W.province||W.province.trim()===""),console.log("=== END DEBUG ===");const Z=[];if((!W.plateNo||Array.isArray(W.plateNo)&&W.plateNo.length===0)&&Z.push("Plate number is required"),(!W.ownerRepresentativeName||W.ownerRepresentativeName.trim()==="")&&Z.push("Owner/Representative name is required"),(!W.barangay||W.barangay.trim()==="")&&Z.push("Barangay is required"),(!W.municipality||W.municipality.trim()==="")&&Z.push("Municipality is required"),(!W.province||W.province.trim()==="")&&Z.push("Province is required"),W.hasDriversLicense&&(!W.driversLicenseNumber||W.driversLicenseNumber.trim()==="")&&Z.push("Driver's license number is required when you have a driver's license"),W.emailAddress&&W.emailAddress.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(W.emailAddress)||Z.push("Invalid email format")),Z.length>0){console.log("Validation errors:",Z),ki.error("Please fill in all required fields",{description:Z.join(", ")});return}_(W),f(!0),t(!1)},F=async()=>{var q,W;a(!0),f(!1);try{const Z=i,ne={plateNo:Z.plateNo,fileNo:Z.fileNo,ownerRepresentativeName:Z.ownerRepresentativeName,address:{purok:Z.purok,barangay:Z.barangay,municipality:Z.municipality,province:Z.province},contactNumber:Z.contactNumber,emailAddress:Z.emailAddress,hasDriversLicense:Z.hasDriversLicense,driversLicenseNumber:Z.driversLicenseNumber};Z.birthDate&&(ne.birthDate=Z.birthDate),console.log("=== SENDING TO SERVER ==="),console.log("Content being sent:",ne),console.log("Address object:",ne.address),console.log("=== END SERVER DATA ===");const{data:ae}=await Wn.post("/driver",ne,{headers:{Authorization:w}});ae.success&&(ki.success("Driver has been added",{description:A}),E.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),sessionStorage.removeItem("vehicleFormData"),t(!1),r&&r(ae.data))}catch(Z){console.log(Z);const ne=((W=(q=Z.response)==null?void 0:q.data)==null?void 0:W.message)||"Failed to add driver";ki.error(ne,{description:A})}finally{a(!1)}},U=q=>{!q&&!n&&E.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t(q)},B=()=>{sessionStorage.removeItem("vehicleFormData"),U(!1)};return u.jsxs(u.Fragment,{children:[u.jsx(Zf,{open:e,onOpenChange:U,children:u.jsxs(Dh,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(Rg,{className:"h-5 w-5"}),"Add New Driver"]}),u.jsx(pm,{children:"Fill in the required fields to add a new driver record to the system."})]}),u.jsx("div",{className:"space-y-6",children:u.jsx(Lne,{form:E,onSubmit:O,submitting:n,onCancel:B})}),u.jsxs(Gg,{className:"flex justify-start gap-3 pt-6",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:B,disabled:n,className:"min-w-[100px]",children:"Cancel"}),u.jsxs(Xr,{type:"submit",form:"driver-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-black hover:bg-gray-800 text-white",children:[n&&u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Driver"]})]})]})}),u.jsx(Zf,{open:l,onOpenChange:q=>{f(q),q||t(!1)},children:u.jsxs(Dh,{className:"max-w-lg border border-gray-200",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(Rg,{className:"h-5 w-5"}),"Confirm Driver Information"]}),u.jsx(pm,{children:"Please review the driver information before submitting."})]}),i&&u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Information"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),u.jsx("div",{className:"col-span-3",children:Array.isArray(i.plateNo)?i.plateNo.join(", "):i.plateNo}),u.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),u.jsx("div",{className:"col-span-3",children:i.fileNo||"Not provided"}),u.jsx("div",{className:"font-medium text-gray-600",children:"Owner:"}),u.jsx("div",{className:"col-span-3",children:i.ownerRepresentativeName})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Personal Information"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Contact:"}),u.jsx("div",{className:"col-span-3",children:i.contactNumber||"Not provided"}),u.jsx("div",{className:"font-medium text-gray-600",children:"Email:"}),u.jsx("div",{className:"col-span-3",children:i.emailAddress||"Not provided"}),u.jsx("div",{className:"font-medium text-gray-600",children:"Birth Date:"}),u.jsx("div",{className:"col-span-3",children:i.birthDate?new Date(i.birthDate).toLocaleDateString():"Not provided"})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Address Information"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Province:"}),u.jsx("div",{className:"col-span-3",children:i.province}),u.jsx("div",{className:"font-medium text-gray-600",children:"Municipality:"}),u.jsx("div",{className:"col-span-3",children:i.municipality}),u.jsx("div",{className:"font-medium text-gray-600",children:"Barangay:"}),u.jsx("div",{className:"col-span-3",children:i.barangay}),u.jsx("div",{className:"font-medium text-gray-600",children:"Purok:"}),u.jsx("div",{className:"col-span-3",children:i.purok||"Not provided"})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Driver's License"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Has License:"}),u.jsx("div",{className:"col-span-3",children:i.hasDriversLicense?"Yes":"No"}),i.hasDriversLicense&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"font-medium text-gray-600",children:"License Number:"}),u.jsx("div",{className:"col-span-3",children:i.driversLicenseNumber})]})]})})]})]}),u.jsxs(Gg,{className:"flex justify-end gap-3 pt-6",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>{f(!1),t(!0),E.clearErrors()},disabled:n,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),u.jsxs(Xr,{onClick:F,disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[n&&u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Confirm & Add Driver",u.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},g6e=()=>{const[e,t]=H.useState([]),{token:r}=la(),n=Na(),a=no(),[l,f]=H.useState(!0),[i,_]=H.useState(!1),[w,A]=H.useState(""),[E,O]=H.useState(!1);H.useEffect(()=>{F()},[]);const F=async()=>{try{const{data:ce}=await Wn.get("/driver",{headers:{Authorization:r}}),Te=ce.data.map(Ae=>{var _e,Ee;return{_id:Ae._id,plateNo:Ae.plateNo,fileNo:Ae.fileNo,ownerRepresentativeName:Ae.ownerRepresentativeName,fullname:Ae.fullname,birthDate:Ae.birthDate,municipality:((_e=Ae.address)==null?void 0:_e.municipality)||Ae.municipality,barangay:((Ee=Ae.address)==null?void 0:Ee.barangay)||Ae.barangay,hasDriversLicense:Ae.hasDriversLicense,driversLicenseNumber:Ae.driversLicenseNumber,isActive:Ae.isActive}}).filter(Ae=>Ae.isActive);t(Te),f(!1)}catch(ce){f(!1),console.log(ce)}},U=async()=>{O(!0)},B=ce=>{n(`/driver/${ce._id}`)},q=ce=>{n(`/driver/${ce}/edit`)},W=()=>{n(`${a.pathname}/inactive`)},Z=ce=>{_(!0),A(ce)},ne=()=>{ee(!1),_(!1)},ae=()=>{_(!1)},ee=async ce=>{const ge=async()=>{var Te,Ae;try{return(await Wn.patch(`/driver/${w}`,{isActive:ce},{headers:{Authorization:r}})).data}catch(_e){const Ee=((Ae=(Te=_e.response)==null?void 0:Te.data)==null?void 0:Ae.message)||"An error occurred";throw new Error(Ee)}finally{await F()}};ki.promise(ge(),{loading:"Loading...",success:"Driver deactivated",error:Te=>Te.message||"Failed to update driver"})},se=()=>{F()};return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[u.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Drivers"}),u.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:u.jsx(qBe,{data:e,filters:["fullname","plateNo","ownerRepresentativeName","municipality","barangay"],tableColumn:f5e,onAdd:U,loading:l,onRowClick:B,onEdit:q,onDelete:Z,onNavigate:W})})]}),u.jsx(Tne,{open:i,onOpenChange:_,confirm:ne,cancel:ae,title:"Are you sure?",description:"This action cannot be undone. This will deactivate the driver."}),u.jsx(zne,{open:E,onOpenChange:O,onDriverAdded:se})]})},y6e=({open:e,onOpenChange:t,driverData:r})=>{var U,B,q,W,Z;_m();const[n,a]=H.useState(!1),[l,f]=H.useState(null),[i,_]=H.useState(!1),w=no(),A=Na(),E=la(),{token:O}=E||{},F=async ne=>{if(ne){_(!0),a(!0);try{const{data:ae}=await Wn.get(`/vehicle/file/${ne}`,{headers:{Authorization:O}});ae.success&&f(ae.data)}catch(ae){console.error("Error fetching vehicle data:",ae),ki.error("Failed to fetch vehicle information")}finally{_(!1)}}};return r?u.jsxs(u.Fragment,{children:[u.jsx(Zf,{open:e,onOpenChange:t,children:u.jsxs(Dh,{className:"max-w-4xl max-h-[90vh] flex flex-col p-0",children:[u.jsx(Lh,{className:"p-6 pb-4 border-b bg-gray-50/50",children:u.jsxs(zh,{className:"text-xl font-bold flex items-center gap-2",children:[u.jsx(Rg,{className:"h-5 w-5 text-blue-600"}),r.fullname]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.jsxs("div",{className:"space-y-4",children:[u.jsx(wi,{className:"border-l-4 border-l-blue-500",children:u.jsxs(Ei,{className:"pt-4",children:[u.jsxs("h3",{className:"text-base font-semibold mb-3 flex items-center gap-2",children:[u.jsx(Rg,{className:"h-4 w-4 text-blue-600"}),"Personal Information"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(jv,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"File Number"}),u.jsx("button",{onClick:()=>F(r.fileNo),className:"text-blue-600 hover:text-blue-800 font-medium text-sm cursor-pointer hover:underline",children:r.fileNo||"N/A"})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Gf,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsxs("p",{className:"text-xs text-gray-600",children:["Plate Number",Array.isArray(r.plateNo)&&r.plateNo.length>1?"s":""]}),u.jsx("p",{className:"font-medium text-sm",children:Array.isArray(r.plateNo)?r.plateNo.join(", "):r.plateNo||"N/A"})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(Rg,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Owner/Representative"}),u.jsx("p",{className:"font-medium text-sm",children:r.ownerRepresentativeName||"N/A"})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(wd,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Date of Birth"}),u.jsx("p",{className:"font-medium text-sm",children:r.birthDate?Zg(r.birthDate):"None"})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(NW,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Contact Number"}),u.jsx("p",{className:"font-medium text-sm",children:r.contactNumber||"None"})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(O3,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Email Address"}),u.jsx("p",{className:"font-medium text-sm",children:r.emailAddress||"None"})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(rue,{className:"h-4 w-4 text-gray-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Driver's License"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(eo,{variant:r.hasDriversLicense?"default":"destructive",children:r.hasDriversLicense?"Yes":"No"}),r.hasDriversLicense&&r.driversLicenseNumber&&u.jsx("span",{className:"text-xs text-gray-600",children:r.driversLicenseNumber})]})]})]})]})]})]})}),u.jsx(wi,{className:"border-l-4 border-l-green-500",children:u.jsxs(Ei,{className:"pt-4",children:[u.jsxs("h3",{className:"text-base font-semibold mb-3 flex items-center gap-2",children:[u.jsx(wx,{className:"h-4 w-4 text-green-600"}),"Address Information"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Purok"}),u.jsx("p",{className:"font-medium text-sm",children:((U=r.address)==null?void 0:U.purok)||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Barangay"}),u.jsx("p",{className:"font-medium text-sm",children:((B=r.address)==null?void 0:B.barangay)||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Municipality"}),u.jsx("p",{className:"font-medium text-sm",children:((q=r.address)==null?void 0:q.municipality)||"N/A"})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Province"}),u.jsx("p",{className:"font-medium text-sm",children:((W=r.address)==null?void 0:W.province)||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Region"}),u.jsx("p",{className:"font-medium text-sm",children:((Z=r.address)==null?void 0:Z.region)||"N/A"})]})]})]})]})})]})}),u.jsx("div",{className:"border-t bg-white p-6 pt-4",children:u.jsx("div",{className:"flex justify-end",children:u.jsxs(Xr,{onClick:()=>A(`${w.pathname}/edit`),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium text-sm shadow-sm transition-colors duration-200",children:[u.jsx(Nc,{className:"h-4 w-4 mr-2"}),"Edit Driver"]})})})]})}),u.jsx(Zf,{open:n,onOpenChange:a,children:u.jsxs(Dh,{className:"max-w-2xl",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"text-xl font-bold flex items-center gap-2",children:[u.jsx(Gf,{className:"h-5 w-5 text-blue-600"}),"Vehicle Information"]}),u.jsxs(pm,{children:["Vehicle details for file number: ",r==null?void 0:r.fileNo]})]}),i?u.jsx("div",{className:"flex items-center justify-center py-8",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l?u.jsx("div",{className:"space-y-4",children:u.jsx(wi,{children:u.jsxs(Ei,{className:"pt-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Plate Number"}),u.jsx("p",{className:"font-medium text-sm",children:l.plateNo||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"File Number"}),u.jsx("p",{className:"font-medium text-sm",children:l.fileNo||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Engine Number"}),u.jsx("p",{className:"font-medium text-sm",children:l.engineNo||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Chassis Number"}),u.jsx("p",{className:"font-medium text-sm",children:l.chassisNo||"N/A"})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Make"}),u.jsx("p",{className:"font-medium text-sm",children:l.make||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Body Type"}),u.jsx("p",{className:"font-medium text-sm",children:l.bodyType||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Color"}),u.jsx("p",{className:"font-medium text-sm",children:l.color||"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Classification"}),u.jsx("p",{className:"font-medium text-sm",children:l.classification||"N/A"})]})]})]}),u.jsx(yC,{className:"my-4"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Date of Renewal"}),u.jsx("p",{className:"font-medium text-sm",children:l.dateOfRenewal?Zg(l.dateOfRenewal):"N/A"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-600",children:"Status"}),u.jsx(eo,{variant:l.status==="Active"?"default":"destructive",children:l.status||"N/A"})]})]})]})})}):u.jsx("div",{className:"text-center py-8",children:u.jsx("p",{className:"text-gray-500",children:"No vehicle information found for this file number."})})]})})]}):null},v6e=()=>{const e=_m(),t=Na(),[r,n]=H.useState(null),[a,l]=H.useState(!0),[f,i]=H.useState(!1),{token:_}=la();H.useEffect(()=>{w()},[]);const w=async()=>{try{const{data:A}=await Wn.get(`/driver/${e.id}`,{headers:{Authorization:_}});A&&(n(A.data),i(!0))}catch(A){console.error("Error fetching driver:",A),t("/404")}finally{l(!1)}};return a?u.jsx("div",{className:"flex items-center justify-center min-h-screen",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u.jsx(u.Fragment,{children:u.jsx(y6e,{open:f,onOpenChange:A=>{i(A),A||t("/driver")},driverData:r})})},x6e=()=>{const e=Na();return u.jsxs("div",{className:"flex flex-col justify-center items-center h-screen",children:[u.jsx("h1",{className:"font-bold text-[80px] md:text-[100px] lg:text-[300px] text-muted-foreground leading-none",children:"404"}),u.jsx("p",{className:"text-lg mb-5",children:"Oops... Page not found."}),u.jsx(Xr,{variant:"outline",size:"lg",onClick:()=>e("/"),children:"Go to Home"})]})},_6e=()=>{const[e,t]=H.useState(!1),{token:r}=la(),n=_m(),a=Su(Date.now()),[l,f]=H.useState({}),i=Na(),_=Uh({resolver:np(bge),defaultValues:{plateNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}}),{reset:w}=_;H.useEffect(()=>{Object.keys(l).length>0&&w(l)},[l,w]),H.useEffect(()=>{A()},[n.id,r]);const A=async()=>{var F,U,B,q,W,Z,ne,ae,ee,se,ce,ge,Te,Ae,_e;const O=n.id;try{const{data:Ee}=await Wn.get(`/driver/${O}`,{headers:{Authorization:r}});if(Ee){const ke={plateNo:(F=Ee.data)==null?void 0:F.plateNo,ownerRepresentativeName:(U=Ee.data)==null?void 0:U.ownerRepresentativeName,purok:(q=(B=Ee.data)==null?void 0:B.address)==null?void 0:q.purok,barangay:(Z=(W=Ee.data)==null?void 0:W.address)==null?void 0:Z.barangay,municipality:(ae=(ne=Ee.data)==null?void 0:ne.address)==null?void 0:ae.municipality,province:((se=(ee=Ee.data)==null?void 0:ee.address)==null?void 0:se.province)||"Davao Oriental",contactNumber:(ce=Ee.data)==null?void 0:ce.contactNumber,emailAddress:(ge=Ee.data)==null?void 0:ge.emailAddress,hasDriversLicense:(Te=Ee.data)==null?void 0:Te.hasDriversLicense,driversLicenseNumber:(Ae=Ee.data)==null?void 0:Ae.driversLicenseNumber,birthDate:new Date((_e=Ee.data)==null?void 0:_e.birthDate)};f(ke)}}catch(Ee){console.log(Ee)}},E=async O=>{t(!0);try{const F={plateNo:O.plateNo,ownerRepresentativeName:O.ownerRepresentativeName,address:{purok:O.purok,barangay:O.barangay,municipality:O.municipality,province:O.province},contactNumber:O.contactNumber,emailAddress:O.emailAddress,hasDriversLicense:O.hasDriversLicense,driversLicenseNumber:O.driversLicenseNumber,birthDate:O.birthDate},{data:U}=await Wn.patch(`/driver/${n.id}`,F,{headers:{Authorization:r}});U.success&&(ki.success("Driver updated",{description:a}),i(-1))}catch(F){console.log(F);const U=F.response.data.message;ki.error(U,{description:`${a}`})}finally{t(!1)}};return u.jsx(u.Fragment,{children:u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsx(Di,{className:"text-xl md:text-3xl font-bold",children:"Edit Driver"}),u.jsx(ls,{children:"Fill in required fields to edit driver."})]}),u.jsx(Ei,{children:u.jsx(Lne,{form:_,onSubmit:E,submitting:e})})]})})},b6e=()=>{const[e,t]=H.useState([]),[r,n]=H.useState(!1),[a,l]=H.useState(""),[f,i]=H.useState(!0),_=Na(),{token:w}=la();H.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:B}=await Wn.get("/driver",{headers:{Authorization:w}}),W=B.data.map(Z=>({_id:Z._id,plateNo:Z.plateNo,fileNo:Z.fileNo,ownerRepresentativeName:Z.ownerRepresentativeName,fullname:Z.fullname,birthDate:Zg(Z.birthDate),contactNumber:Z.contactNumber,emailAddress:Z.emailAddress,hasDriversLicense:Z.hasDriversLicense,driversLicenseNumber:Z.driversLicenseNumber,isActive:Z.isActive})).filter(Z=>Z.isActive===!1);t(W),i(!1)}catch(B){i(!1),console.log(B)}},E=B=>{n(!0),l(B)},O=()=>{U(!0),n(!1)},F=()=>{n(!1)},U=async B=>{const q=async()=>{var W,Z;try{return(await Wn.patch(`/driver/${a}`,{isActive:B},{headers:{Authorization:w}})).data}catch(ne){const ae=((Z=(W=ne.response)==null?void 0:W.data)==null?void 0:Z.message)||"An error occurred";throw new Error(ae)}finally{await A()}};ki.promise(q(),{loading:"Loading...",success:"Driver activated",error:W=>W.message||"Failed to update driver"})};return u.jsxs("div",{className:"p-4",children:[u.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Deleted Drivers"}),u.jsx("div",{className:" pt-4 md:px-0 md:pt-0",children:u.jsxs(Xr,{variant:"outline",className:"shadow-none",onClick:()=>_(-1),children:[u.jsx(eP,{})," Back"]})}),u.jsx("section",{children:u.jsx(Nre,{data:e,searchPlaceholder:"Search Driver...",filters:["fullname","plateNo","ownerRepresentativeName"],tableColumn:h5e,loading:f,onAction:E})}),u.jsx(Tne,{open:r,onOpenChange:n,cancel:F,confirm:O,title:"Are you sure?",description:"This action cannot be undone. This will activate the driver."})]})},w6e=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:l,onAdd:f,onEdit:i,onRenewal:_,submitting:w})=>{var se;const[A,E]=Re.useState([]),[O,F]=Re.useState([]),[U,B]=Re.useState({}),[q,W]=Re.useState({pageIndex:0,pageSize:8}),[Z,ne]=Re.useState(""),ae=t,ee=S2({data:n,columns:r(i,w),onSortingChange:E,onColumnFiltersChange:F,onPaginationChange:W,getCoreRowModel:x2(),getPaginationRowModel:b2(),getSortedRowModel:w2(),getFilteredRowModel:_2(),onColumnVisibilityChange:B,onGlobalFilterChange:ne,globalFilterFn:(ce,ge,Te)=>ae.some(Ae=>{const _e=ce.getValue(Ae);return String(_e).toLowerCase().includes(Te.toLowerCase())}),state:{pagination:q,sorting:A,columnFilters:O,columnVisibility:U,globalFilter:Z}});return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx(os,{className:"font-semibold",children:e}),u.jsxs("div",{className:`md:flex items-center justify-between py-3 flex-shrink-0
        `,children:[u.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[u.jsx(tP,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx(Vn,{placeholder:"Search Vehicle...",value:Z??"",onChange:ce=>ne(ce.target.value),className:"pl-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"})]}),u.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[u.jsxs(Xr,{onClick:f,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[u.jsx(Wv,{}),u.jsx("span",{className:"hidden lg:inline",children:"Add Vehicle"})]}),u.jsxs(Xr,{onClick:_,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[u.jsx(Pue,{}),u.jsx("span",{className:"hidden lg:inline",children:"Renewal"})]}),u.jsx(T2,{table:ee})]})]}),u.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0",children:u.jsx("div",{className:"overflow-auto h-full",children:u.jsx("div",{className:"px-4",children:u.jsxs(oy,{children:[u.jsx(ly,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:ee.getHeaderGroups().map(ce=>u.jsx(Bs,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:ce.headers.map(ge=>u.jsx(Js,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-4 whitespace-nowrap text-left",children:tp(ge.column.columnDef.header,ge.getContext())},ge.id))},ce.id))}),u.jsx(cy,{className:"text-xs bg-white dark:bg-transparent",children:a?u.jsx(A2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ce=>u.jsx(Bs,{onClick:()=>l(ce.original),"data-state":ce.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:ce.getVisibleCells().map(ge=>u.jsx(Oa,{className:"px-3 py-3.5 text-gray-800 dark:text-gray-200 text-left",children:tp(ge.column.columnDef.cell,ge.getContext())},ge.id))},ce.id)):u.jsx(Bs,{className:"hover:bg-transparent",children:u.jsx(Oa,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),u.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),u.jsx("div",{className:"mt-3 flex-shrink-0",children:u.jsx(P2,{table:ee})})]})},S6e=({open:e,onOpenChange:t,onVehicleUpdated:r})=>{const[n,a]=H.useState(""),[l,f]=H.useState(!1),[i,_]=H.useState(null),[w,A]=H.useState(""),[E,O]=H.useState(null),[F,U]=H.useState(!1),[B,q]=H.useState(!1),{token:W}=la(),Z=async()=>{var ce,ge;if(!n.trim()){A("Please enter a plate number");return}f(!0),A(""),_(null);try{const{data:Te}=await Wn.get(`/vehicle/owner/${n.trim()}`,{headers:{Authorization:W}});Te.success?(_(Te.data),O(Te.data.vehicle.dateOfRenewal?new Date(Te.data.vehicle.dateOfRenewal):new Date),q(!1)):A(Te.message||"Failed to fetch vehicle information")}catch(Te){console.error("Error fetching vehicle data:",Te),A(((ge=(ce=Te.response)==null?void 0:ce.data)==null?void 0:ge.message)||"Vehicle not found or error occurred while fetching data")}finally{f(!1)}},ne=()=>{a(""),_(null),A(""),O(null),U(!1),q(!1),t(!1)},ae=async()=>{var ce,ge;if(!i||!E){A("Please select a renewal date");return}U(!0),A("");try{const{data:Te}=await Wn.patch(`/vehicle/${i.vehicle._id}`,{dateOfRenewal:E.toISOString()},{headers:{Authorization:W}});if(Te.success){q(!0),ki.success("Vehicle Updated Successfully",{description:`Renewal date updated for ${i.vehicle.plateNo}`});try{const{data:Ae}=await Wn.get(`/vehicle/owner/${n.trim()}`,{headers:{Authorization:W}});Ae.success&&(_(Ae.data),O(Ae.data.vehicle.dateOfRenewal?new Date(Ae.data.vehicle.dateOfRenewal):new Date),r&&r())}catch(Ae){console.error("Error refreshing vehicle data:",Ae)}}else A(Te.message||"Failed to update renewal date")}catch(Te){console.error("Error updating renewal date:",Te),A(((ge=(ce=Te.response)==null?void 0:ce.data)==null?void 0:ge.message)||"Failed to update renewal date")}finally{U(!1)}},ee=ce=>ce==="1"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",se=ce=>ce==="1"?"Active":"Expired";return u.jsx(Zf,{open:e,onOpenChange:t,children:u.jsxs(Dh,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[u.jsx(Lh,{children:u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(Gf,{className:"h-5 w-5"}),"Vehicle Renewal Information"]})}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(os,{htmlFor:"plateNo",children:"Plate Number"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(Vn,{id:"plateNo",placeholder:"Enter plate number (e.g., ABC123)",value:n,onChange:ce=>a(ce.target.value.toUpperCase()),onKeyPress:ce=>ce.key==="Enter"&&Z(),className:"flex-1"}),u.jsx(Xr,{onClick:Z,disabled:l,className:"px-6",children:l?u.jsx(Lf,{className:"h-4 w-4 animate-spin"}):u.jsx(tP,{className:"h-4 w-4"})})]})]}),w&&u.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:u.jsx("p",{className:"text-sm text-red-600",children:w})}),B&&u.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:u.jsx("p",{className:"text-sm text-green-600",children:"Renewal date updated successfully!"})})]}),i&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsxs(Di,{className:"flex items-center justify-between",children:[u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx(Gf,{className:"h-4 w-4"}),"Vehicle Information"]}),u.jsx(eo,{className:ee(i.vehicle.status),children:se(i.vehicle.status)})]})}),u.jsx(Ei,{className:"space-y-3",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Plate Number"}),u.jsx("p",{className:"text-sm font-semibold",children:i.vehicle.plateNo})]}),u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Make & Model"}),u.jsxs("p",{className:"text-sm",children:[i.vehicle.make," ",i.vehicle.bodyType]})]}),u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Color"}),u.jsx("p",{className:"text-sm",children:i.vehicle.color})]}),u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Last Renewal"}),u.jsx("p",{className:"text-sm",children:i.vehicle.dateOfRenewal?Su(i.vehicle.dateOfRenewal):"Not set"})]})]})})]}),u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wd,{className:"h-4 w-4"}),"Update Renewal Date"]})}),u.jsxs(Ei,{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"New Renewal Date"}),u.jsx("div",{className:"mt-2",children:u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsxs(Xr,{variant:"outline",className:Wt("w-full justify-start text-left font-normal",!E&&"text-muted-foreground"),children:[u.jsx(wd,{className:"mr-2 h-4 w-4"}),E?Su(E):"Pick a date"]})}),u.jsx(Yg,{className:"w-auto p-0",align:"start",children:u.jsx(E2,{fieldValue:E,dateValue:O})})]})})]}),u.jsx("div",{className:"flex justify-end",children:u.jsxs(Xr,{onClick:ae,disabled:F||!E,className:"flex items-center gap-2",children:[F?u.jsx(Lf,{className:"h-4 w-4 animate-spin"}):u.jsx(Mue,{className:"h-4 w-4"}),F?"Updating...":"Update Renewal Date"]})})]})]}),u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(Rg,{className:"h-4 w-4"}),"Owner Information"]})}),u.jsxs(Ei,{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Owner Name"}),u.jsx("p",{className:"text-sm font-semibold",children:i.owner.name})]}),i.owner.address&&u.jsxs("div",{children:[u.jsxs(os,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[u.jsx(wx,{className:"h-3 w-3"}),"Address"]}),u.jsxs("p",{className:"text-sm",children:[i.owner.address.purok&&`${i.owner.address.purok}, `,i.owner.address.barangay,", ",i.owner.address.municipality,u.jsx("br",{}),i.owner.address.province,", ",i.owner.address.region]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.owner.contactNumber&&u.jsxs("div",{children:[u.jsxs(os,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[u.jsx(NW,{className:"h-3 w-3"}),"Contact Number"]}),u.jsx("p",{className:"text-sm",children:i.owner.contactNumber})]}),i.owner.emailAddress&&u.jsxs("div",{children:[u.jsxs(os,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[u.jsx(O3,{className:"h-3 w-3"}),"Email"]}),u.jsx("p",{className:"text-sm",children:i.owner.emailAddress})]})]}),i.owner.driversLicenseNumber&&u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Driver's License"}),u.jsx("p",{className:"text-sm",children:i.owner.driversLicenseNumber})]})]})]}),i.expirationInfo&&u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wd,{className:"h-4 w-4"}),"Expiration Information"]})}),u.jsx(Ei,{className:"space-y-3",children:u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Expiration Month"}),u.jsx("p",{className:"text-sm font-semibold",children:i.expirationInfo.month})]}),u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Week"}),u.jsxs("p",{className:"text-sm capitalize",children:[i.expirationInfo.week," week"]})]}),u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Expiration Date"}),u.jsx("p",{className:"text-sm",children:i.expirationInfo.expirationDate?Su(i.expirationInfo.expirationDate):"Not calculated"})]}),u.jsxs("div",{children:[u.jsx(os,{className:"text-sm font-medium text-gray-600",children:"Status"}),u.jsx(eo,{className:i.expirationInfo.isExpired?"bg-red-100 text-red-800":"bg-green-100 text-green-800",children:i.expirationInfo.isExpired?"Expired":"Active"})]})]})})]})]})]}),u.jsx(Gg,{children:u.jsx(Xr,{variant:"outline",onClick:ne,children:"Close"})})]})})},Fne=({onSubmit:e,form:t,submitting:r,hideDateOfRenewal:n=!1})=>{Na(),no();const{token:a}=la(),[l,f]=H.useState(""),[i,_]=H.useState([]),[w,A]=H.useState(!1),[E,O]=H.useState(null),[F,U]=H.useState(!1),[B,q]=H.useState(!1),W=H.useRef(null);H.useEffect(()=>{const ce=setTimeout(async()=>{var ge,Te,Ae,_e,Ee;if(l.length>=2){A(!0),U(!1);try{const{data:ke}=await Wn.get(`/driver/search?name=${encodeURIComponent(l)}`,{headers:{Authorization:a}});ke.success&&(console.log("Driver search results:",ke.data),console.log("First driver address:",(ge=ke.data[0])==null?void 0:ge.address),console.log("Municipality:",(Ae=(Te=ke.data[0])==null?void 0:Te.address)==null?void 0:Ae.municipality),console.log("Barangay:",(Ee=(_e=ke.data[0])==null?void 0:_e.address)==null?void 0:Ee.barangay),_(ke.data),ke.data.length===0&&l.length>=3&&U(!0))}catch(ke){console.error("Error searching drivers:",ke),_([]),l.length>=3&&U(!0)}finally{A(!1)}}else _([]),U(!1)},300);return()=>clearTimeout(ce)},[l,a]),H.useEffect(()=>{(i.length>0||F)&&setTimeout(()=>{W.current&&W.current.scrollIntoView({behavior:"smooth",block:"center"})},100)},[i,F]);const Z=se=>{O(se),t.setValue("driver",se._id),f(se.ownerRepresentativeName),_([]),U(!1)},ne=()=>{O(null),t.setValue("driver",null),f(""),_([]),U(!1)},ae=()=>{const se=t.getValues();sessionStorage.setItem("vehicleFormData",JSON.stringify({plateNo:se.plateNo||"",fileNo:se.fileNo||"",ownerRepresentativeName:se.ownerRepresentativeName||l||""})),q(!0)},ee=se=>{O(se),t.setValue("driver",se._id),f(se.ownerRepresentativeName),_([]),U(!1),q(!1),ki.success("Driver added successfully",{description:"The driver has been selected for this vehicle."})};return u.jsxs(Zv,{...t,children:[u.jsx("form",{id:"vehicle-form",onSubmit:t.handleSubmit(se=>{console.log("Selected driver:",E),console.log("Form data:",se);const ce=(E==null?void 0:E.ownerRepresentativeName)||(l&&l!==""?l:"Not selected"),ge={...se,ownerName:ce};console.log("Form data with owner:",ge),e(ge)}),children:u.jsxs("div",{className:"space-y-3",children:[u.jsx("div",{children:u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[u.jsx(Bn,{control:t.control,name:"plateNo",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",placeholder:"ABC-123",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.plateNo&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"fileNo",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.fileNo&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"engineNo",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.engineNo&&"text-red-400"),children:"Engine No."}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.engineNo&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})})]})}),u.jsx("div",{children:u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[u.jsx(Bn,{control:t.control,name:"chassisNo",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.chassisNo&&"text-red-400"),children:"Chassis No."}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.chassisNo&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"make",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.make&&"text-red-400"),children:"Make"}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.make&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"bodyType",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.bodyType&&"text-red-400"),children:"Body Type"}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.bodyType&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})})]})}),u.jsx("div",{children:u.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[u.jsx(Bn,{control:t.control,name:"color",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.color&&"text-red-400"),children:"Color"}),u.jsx(On,{children:u.jsx(Vn,{...se,type:"text",onChange:ce=>{const ge=ce.target.value.toUpperCase();se.onChange(ge)},className:Wt("text-black dark:text-white",t.formState.errors.color&&"border-red-400")})}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"classification",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.classification&&"text-red-400"),children:"Classification"}),u.jsxs(Io,{onValueChange:se.onChange,defaultValue:se.value,children:[u.jsx(On,{children:u.jsx(mo,{className:Wt("text-black dark:text-white",t.formState.errors.classification&&"border-red-400"),children:u.jsx(Do,{placeholder:"Select classification"})})}),u.jsx(go,{children:u.jsxs(t3,{children:[u.jsx(r3,{children:"Classifications"}),u.jsx(_n,{value:"Private",children:"PRIVATE"}),u.jsx(_n,{value:"For Hire",children:"FOR HIRE"}),u.jsx(_n,{value:"Government",children:"GOVERNMENT"})]})})]}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),u.jsx(Bn,{control:t.control,name:"vehicleStatusType",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.vehicleStatusType&&"text-red-400"),children:"Vehicle Status Type"}),u.jsxs(Io,{onValueChange:se.onChange,defaultValue:se.value,children:[u.jsx(On,{children:u.jsx(mo,{className:Wt("text-black dark:text-white",t.formState.errors.vehicleStatusType&&"border-red-400"),children:u.jsx(Do,{placeholder:"Select vehicle status type"})})}),u.jsx(go,{children:u.jsxs(t3,{children:[u.jsx(r3,{children:"Vehicle Status"}),u.jsx(_n,{value:"New",children:"New Vehicle"}),u.jsx(_n,{value:"Old",children:"Old Vehicle"})]})})]}),u.jsx(zn,{className:"text-xs text-red-400"})]})}),!n&&u.jsx(Bn,{control:t.control,name:"dateOfRenewal",render:({field:se})=>u.jsxs(Dn,{className:"lg:col-span-2",children:[u.jsx(Ln,{className:Wt("text-muted-foreground mb-0",t.formState.errors.dateOfRenewal&&"text-red-400"),children:"Date of Renewal"}),u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsx(On,{children:u.jsxs(Xr,{variant:"outline",className:Wt("w-full pl-3 text-left font-normal text-black dark:text-white",!se.value&&"text-muted-foreground",t.formState.errors.dateOfRenewal&&"border-red-400"),children:[se.value?Fc(se.value,"PPP"):u.jsx("span",{children:"Pick a date"}),u.jsx(wd,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),u.jsx(Yg,{className:"w-auto p-0",align:"start",children:u.jsx(E2,{fieldValue:se.value,dateValue:se.onChange})})]}),u.jsx(zn,{className:"text-xs text-red-400"})]})})]})}),u.jsxs("div",{children:[u.jsx(os,{children:"Driver/Owner Information"}),u.jsx("div",{className:"mt-1",children:u.jsx(Bn,{control:t.control,name:"driver",render:({field:se})=>u.jsxs(Dn,{children:[u.jsx(Ln,{className:"text-muted-foreground mb-0",children:"Search and Select Driver/Owner"}),u.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Format: Surname Suffix (Optional), FirstName, Middle Initial"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"flex gap-2",children:u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(Vn,{ref:W,placeholder:"Type driver/owner name to search...",value:l,onChange:ce=>{const ge=ce.target.value.toUpperCase();f(ge)},className:"pr-10"}),w&&u.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:u.jsx(Lf,{className:"h-4 w-4 animate-spin text-muted-foreground"})}),!w&&l&&u.jsx("button",{type:"button",onClick:ne,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:u.jsx(b1,{className:"h-4 w-4"})})]})}),(i.length>0||F)&&u.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent hover:scrollbar-thumb-gray-400",children:[i.map(ce=>u.jsxs("div",{className:"p-3 hover:bg-accent cursor-pointer border-b border-border last:border-b-0 transition-colors",onClick:()=>Z(ce),children:[u.jsx("div",{className:"text-sm font-medium text-foreground",children:ce.ownerRepresentativeName}),u.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Current vehicles: ",ce.plateNo||"None"]})]},ce._id)),F&&i.length===0&&!E&&u.jsxs("div",{className:"p-3 hover:bg-accent cursor-pointer border-b border-border last:border-b-0 bg-accent/50 transition-colors",onClick:ae,children:[u.jsxs("div",{className:"text-sm font-medium text-primary",children:['+ Add "',l,'" as new driver']}),u.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Click to create a new driver record"})]})]}),E&&u.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded-md",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"text-sm font-medium text-green-800",children:["Selected: ",E.ownerRepresentativeName]}),u.jsxs("div",{className:"text-xs text-green-600",children:["Current vehicles: ",E.plateNo||"None"]})]}),u.jsx(Xr,{type:"button",variant:"ghost",size:"sm",onClick:ne,className:"text-green-600 hover:text-green-800 h-6 w-6 p-0",children:u.jsx(b1,{className:"h-3 w-3"})})]})})]}),u.jsx(zn,{className:"text-xs text-red-400"})]})})})]})]})}),u.jsx(zne,{open:B,onOpenChange:q,onDriverAdded:ee})]})},A6e=({open:e,onOpenChange:t,onVehicleAdded:r})=>{const[n,a]=H.useState(!1),[l,f]=H.useState(!1),[i,_]=H.useState(null),{token:w}=la(),A=Su(Date.now()),E=Uh({resolver:np(GK),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,vehicleStatusType:"",driver:""}}),O=async B=>{console.log("Received form data in AddVehicleModal:",B),console.log("Owner name:",B.ownerName),_(B),f(!0)},F=async()=>{var B,q;a(!0),f(!1);try{const W=i;console.log("Form data in handleConfirmSubmission:",W),console.log("vehicleStatusType in formData:",W.vehicleStatusType);const Z={plateNo:W.plateNo,fileNo:W.fileNo,engineNo:W.engineNo,chassisNo:W.chassisNo,make:W.make,bodyType:W.bodyType,color:W.color,classification:W.classification,vehicleStatusType:W.vehicleStatusType,driverId:W.driver};W.dateOfRenewal&&(Z.dateOfRenewal=W.dateOfRenewal),console.log("Content being sent to API:",Z),console.log("vehicleStatusType in content:",Z.vehicleStatusType),console.log("driverId in content:",Z.driverId),console.log("plateNo in content:",Z.plateNo),console.log("fileNo in content:",Z.fileNo);const{data:ne}=await Wn.post("/vehicle",Z,{headers:{Authorization:w}});ne.success&&(ki.success("Vehicle has been added",{description:A}),E.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(!1),r&&r())}catch(W){console.log(W);const Z=((q=(B=W.response)==null?void 0:B.data)==null?void 0:q.message)||"Failed to add vehicle";ki.error(Z,{description:A})}finally{a(!1)}},U=B=>{!B&&!n&&E.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(B)};return u.jsxs(u.Fragment,{children:[u.jsx(Zf,{open:e,onOpenChange:U,children:u.jsxs(Dh,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[u.jsxs(Lh,{className:"flex-shrink-0",children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(Gf,{className:"h-5 w-5"}),"Add New Vehicle"]}),u.jsx(pm,{children:"Fill in the required fields to add a new vehicle record to the system."})]}),u.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:u.jsx(Fne,{form:E,onSubmit:O,submitting:n})}),u.jsxs(Gg,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>U(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),u.jsxs(Xr,{type:"submit",form:"vehicle-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-black hover:bg-gray-800 text-white shadow-lg",children:[n&&u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Vehicle"]})]})]})}),u.jsx(Zf,{open:l,onOpenChange:f,children:u.jsxs(Dh,{className:"max-w-lg border border-gray-200",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(Gf,{className:"h-5 w-5"}),"Confirm Vehicle Information"]}),u.jsx(pm,{children:"Please review the vehicle information before submitting."})]}),i&&u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Details"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),u.jsx("div",{className:"col-span-3",children:i.plateNo}),u.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),u.jsx("div",{className:"col-span-3",children:i.fileNo||"Not provided"}),u.jsx("div",{className:"font-medium text-gray-600",children:"Engine No:"}),u.jsx("div",{className:"col-span-3",children:i.engineNo}),u.jsx("div",{className:"font-medium text-gray-600",children:"Chassis No:"}),u.jsx("div",{className:"col-span-3",children:i.chassisNo})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Specifications"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Make:"}),u.jsx("div",{className:"col-span-3",children:i.make}),u.jsx("div",{className:"font-medium text-gray-600",children:"Body Type:"}),u.jsx("div",{className:"col-span-3",children:i.bodyType}),u.jsx("div",{className:"font-medium text-gray-600",children:"Color:"}),u.jsx("div",{className:"col-span-3",children:i.color}),u.jsx("div",{className:"font-medium text-gray-600",children:"Classification:"}),u.jsx("div",{className:"col-span-3",children:i.classification})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Renewal"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Date of Renewal:"}),u.jsx("div",{className:"col-span-3",children:i.dateOfRenewal?new Date(i.dateOfRenewal).toLocaleDateString():"Not provided"}),u.jsx("div",{className:"font-medium text-gray-600",children:"Vehicle Status:"}),u.jsx("div",{className:"col-span-3",children:i.vehicleStatusType||"Not selected"})]})})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Owner"}),u.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:u.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[u.jsx("div",{className:"font-medium text-gray-600",children:"Owner Name:"}),u.jsx("div",{className:"col-span-3",children:i.ownerName||"Not selected"})]})})]})]}),u.jsxs(Gg,{className:"flex justify-end gap-3 pt-6",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>{f(!1),E.clearErrors()},disabled:n,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),u.jsxs(Xr,{onClick:F,disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[n&&u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Confirm & Add Vehicle",u.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},T6e=()=>{const[e,t]=H.useState([]),{token:r}=la(),n=Na();no();const[a,l]=H.useState(!0);Su(Date.now());const[f,i]=H.useState(!1),[_,w]=H.useState(!1),[A,E]=H.useState(!1);H.useEffect(()=>{O()},[]);const O=async()=>{try{const{data:ne}=await Wn.get("/vehicle",{headers:{Authorization:r}}),ae=ne.data.map(ee=>({_id:ee._id,plateNo:ee.plateNo,fileNo:ee.fileNo,engineNo:ee.engineNo,chassisNo:ee.chassisNo,make:ee.make,bodyType:ee.bodyType,color:ee.color,classification:ee.classification,dateOfRenewal:ee.dateOfRenewal,status:ee.status}));t(ae)}catch(ne){console.log(ne)}finally{l(!1)}},F=async()=>{E(!0)},U=ne=>{const ae=ne._id;n(`/vehicle/${ae}`)},B=ne=>{n(`/vehicle/${ne}/edit`)},q=()=>{w(!0)},W=()=>{O()},Z=()=>{O()};return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[u.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Vehicles"}),u.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:u.jsx(w6e,{data:e,filters:["plateNo","fileNo","engineNo","chassisNo","classification","status"],tableColumn:g5e,onAdd:F,loading:a,onRowClick:U,onEdit:B,onRenewal:q,submitting:f})})]}),u.jsx(S6e,{open:_,onOpenChange:w,onVehicleUpdated:W}),u.jsx(A6e,{open:A,onOpenChange:E,onVehicleAdded:Z})]})},P6e=()=>{const e=_m(),[t,r]=H.useState(!0),{token:n}=la(),[a,l]=H.useState(),[f,i]=H.useState(!1),[_,w]=H.useState(!1),A=no(),E=Na(),O=async()=>{try{r(!0);const{data:F}=await Wn.get(`/vehicle/${e.id}`,{headers:{Authorization:n}});F&&l(F.data)}catch(F){console.error("Error fetching vehicle:",F),ki.error("Failed to load vehicle data")}finally{r(!1)}};return H.useEffect(()=>{O()},[]),t?u.jsx(wi,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:u.jsx(Ei,{className:"p-6",children:u.jsx("div",{className:"flex items-center justify-center",children:u.jsx("div",{className:"text-muted-foreground",children:"Loading vehicle data..."})})})}):u.jsx(u.Fragment,{children:u.jsxs(wi,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[u.jsxs(Ii,{className:"border-b",children:[u.jsx(Di,{className:"text-3xl font-bold",children:a!=null&&a.make?kN(a.make):"N/A"}),u.jsx(ls,{children:(a==null?void 0:a.plateNo)||"N/A"})]}),u.jsx(Ei,{className:"p-0 pb-6",children:u.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[u.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Vehicle Information"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate Number:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"File Number:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.fileNo)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Engine Number:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.engineNo)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Chassis Number:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.chassisNo)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Make:"}),u.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.make?kN(a.make):"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Body Type:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.bodyType)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Color:"}),u.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.color?kN(a.color):"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Classification:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.classification)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Date of Renewal:"}),u.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.dateOfRenewal?Zg(a.dateOfRenewal):"Not set"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Status:"}),u.jsx("p",{className:"font-semibold w-full",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs ${(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"Active":"Expired"})})]})}),u.jsx(dC,{className:"gap-2 text-sm ",children:u.jsxs(Xr,{onClick:()=>E(`${A.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[u.jsx(Nc,{}),"Edit"]})})]})})},C6e=()=>{const e=Na();return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:u.jsxs(Xr,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[u.jsx(eP,{})," Back"]})}),u.jsx("div",{className:"p-4 md:p-0",children:u.jsx(P6e,{})})]})},E6e=()=>{const[e,t]=H.useState(!1),{token:r}=la(),n=_m(),a=Su(Date.now()),[l,f]=H.useState({}),i=Na(),_=Uh({resolver:np(GK),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0}}),{reset:w}=_;H.useEffect(()=>{Object.keys(l).length>0&&w(l)},[l,w]),H.useEffect(()=>{A()},[n.id,r]);const A=async()=>{var F,U,B,q,W,Z,ne,ae;const O=n.id;try{const{data:ee}=await Wn.get(`/vehicle/${O}`,{headers:{Authorization:r}});if(ee){const se={plateNo:(F=ee.data)==null?void 0:F.plateNo,fileNo:(U=ee.data)==null?void 0:U.fileNo,engineNo:(B=ee.data)==null?void 0:B.engineNo,chassisNo:(q=ee.data)==null?void 0:q.chassisNo,make:(W=ee.data)==null?void 0:W.make,bodyType:(Z=ee.data)==null?void 0:Z.bodyType,color:(ne=ee.data)==null?void 0:ne.color,classification:(ae=ee.data)==null?void 0:ae.classification};f(se)}}catch(ee){console.log(ee)}},E=async O=>{var F,U;t(!0);try{const B={plateNo:O.plateNo,fileNo:O.fileNo,engineNo:O.engineNo,chassisNo:O.chassisNo,make:O.make,bodyType:O.bodyType,color:O.color,classification:O.classification},{data:q}=await Wn.patch(`/vehicle/${n.id}`,B,{headers:{Authorization:r}});q.success&&(ki.success("Vehicle updated",{description:a}),i(-1))}catch(B){console.log(B);const q=((U=(F=B.response)==null?void 0:F.data)==null?void 0:U.message)||"An error occurred";ki.error(q,{description:`${a}`})}finally{t(!1)}};return u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsx(Di,{className:"text-xl md:text-3xl font-bold",children:"Edit Vehicle"}),u.jsx(ls,{children:"Fill in required fields to edit vehicle."})]}),u.jsx(Ei,{children:u.jsx(Fne,{form:_,onSubmit:E,submitting:e,hideDateOfRenewal:!0})})]})},k6e=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:l,onAdd:f,onEdit:i,onUpdateStatus:_,submitting:w})=>{var se;const[A,E]=Re.useState([]),[O,F]=Re.useState([]),[U,B]=Re.useState({}),[q,W]=Re.useState({pageIndex:0,pageSize:8}),[Z,ne]=Re.useState(""),ae=t,ee=S2({data:n,columns:r(i,_,w),onSortingChange:E,onColumnFiltersChange:F,onPaginationChange:W,getCoreRowModel:x2(),getPaginationRowModel:b2(),getSortedRowModel:w2(),getFilteredRowModel:_2(),onColumnVisibilityChange:B,onGlobalFilterChange:ne,globalFilterFn:(ce,ge,Te)=>ae.some(Ae=>{const _e=ce.getValue(Ae);return String(_e).toLowerCase().includes(Te.toLowerCase())}),state:{pagination:q,sorting:A,columnFilters:O,columnVisibility:U,globalFilter:Z}});return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsx(os,{className:"font-semibold",children:e}),u.jsxs("div",{className:"md:flex items-center justify-between py-3 flex-shrink-0",children:[u.jsx("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:u.jsx(Vn,{placeholder:"Search Violation...",value:Z??"",onChange:ce=>ne(ce.target.value),className:"pl-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"})}),u.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[u.jsxs(Xr,{onClick:f,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[u.jsx(Wv,{}),u.jsx("span",{className:"hidden lg:inline",children:"Add Violation"})]}),u.jsx(T2,{table:ee})]})]}),u.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0",children:u.jsx("div",{className:"overflow-auto h-full",children:u.jsx("div",{className:"px-4",children:u.jsxs(oy,{children:[u.jsx(ly,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:ee.getHeaderGroups().map(ce=>u.jsx(Bs,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:ce.headers.map(ge=>u.jsx(Js,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",children:tp(ge.column.columnDef.header,ge.getContext())},ge.id))},ce.id))}),u.jsx(cy,{className:"text-xs bg-white dark:bg-transparent",children:a?u.jsx(A2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ce=>u.jsx(Bs,{onClick:()=>l(ce.original),"data-state":ce.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:ce.getVisibleCells().map(ge=>u.jsx(Oa,{className:"px-3 py-3 text-gray-800 dark:text-gray-200 text-left",children:tp(ge.column.columnDef.cell,ge.getContext())},ge.id))},ce.id)):u.jsx(Bs,{className:"hover:bg-transparent",children:u.jsx(Oa,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),u.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),u.jsx("div",{className:"mt-3 flex-shrink-0",children:u.jsx(P2,{table:ee})})]})},Bne=({form:e,onSubmit:t,submitting:r})=>{Na();const[n,a]=H.useState([]);CK({control:e.control,name:"violationType",defaultValue:"confiscated"}),H.useEffect(()=>{n.length===0&&(a([""]),e.setValue("violations",[""]))},[n.length,e]);const l=()=>{a([...n,""])},f=w=>{if(n.length>1){const A=n.filter((E,O)=>O!==w);a(A),e.setValue("violations",A)}},i=(w,A)=>{const E=[...n];E[w]=A,a(E),e.setValue("violations",E)},_=w=>{console.log("=== FORM COMPONENT SUBMIT ==="),console.log("Form submitted with data:",w),console.log("Form state:",e.formState),console.log("Form errors:",e.formState.errors),t(w)};return u.jsx(Zv,{...e,children:u.jsxs("form",{id:"violation-form",onSubmit:e.handleSubmit(_),className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Bn,{control:e.control,name:"topNo",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"TOP NO."}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"TOP-0001",...w})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"violationType",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Violation Type"}),u.jsxs(Io,{onValueChange:w.onChange,defaultValue:w.value,children:[u.jsx(On,{children:u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select violation type"})})}),u.jsxs(go,{children:[u.jsx(_n,{value:"confiscated",children:"Confiscated"}),u.jsx(_n,{value:"alarm",children:"Alarm"}),u.jsx(_n,{value:"impounded",children:"Impounded"})]})]}),u.jsx(zn,{})]})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"Apprehension Details"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsx(Bn,{control:e.control,name:"firstName",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"First Name"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"John",...w})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"middleInitial",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Middle Initial"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"D",maxLength:1,...w})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"lastName",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Last Name"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Doe",...w})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"suffix",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Suffix"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Jr.",...w})}),u.jsx(zn,{})]})})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"Violations"}),u.jsxs("div",{className:"space-y-2",children:[n.map((w,A)=>u.jsxs("div",{className:"flex gap-2",children:[u.jsx(Vn,{placeholder:`Violation ${A+1}`,value:w,onChange:E=>i(A,E.target.value)}),n.length>1&&u.jsx(Xr,{type:"button",variant:"outline",size:"icon",onClick:()=>f(A),children:u.jsx(b1,{className:"h-4 w-4"})})]},A)),u.jsxs(Xr,{type:"button",variant:"outline",onClick:l,className:"w-full",children:[u.jsx(Wv,{className:"h-4 w-4 mr-2"}),"Add Violation"]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"License Type"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Bn,{control:e.control,name:"licenseType",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"License Type"}),u.jsxs(Io,{onValueChange:w.onChange,defaultValue:w.value,children:[u.jsx(On,{children:u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select license type"})})}),u.jsxs(go,{children:[u.jsx(_n,{value:"SP",children:"SP (Student Permit)"}),u.jsx(_n,{value:"DL",children:"DL (Driver's License)"}),u.jsx(_n,{value:"CL",children:"CL (Commercial License)"}),u.jsx(_n,{value:"plate",children:"Plate"}),u.jsx(_n,{value:"sp receipt",children:"SP Receipt"}),u.jsx(_n,{value:"dl receipt",children:"DL Receipt"}),u.jsx(_n,{value:"refuse to sur.",children:"Refuse to Sur."}),u.jsx(_n,{value:"dl tempor",children:"DL Tempor"})]})]}),u.jsx(zn,{})]})}),u.jsx("div",{})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Details"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsx(Bn,{control:e.control,name:"plateNo",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Plate No."}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"ABC-1234",...w})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"chassisNo",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Chassis No. (Optional)"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Chassis Number",...w})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"engineNo",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Engine No. (Optional)"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Engine Number",...w})}),u.jsx(zn,{})]})})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"Apprehension Information"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Bn,{control:e.control,name:"dateOfApprehension",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Date of Apprehension"}),u.jsx(On,{children:u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsx(On,{children:u.jsxs(Xr,{variant:"outline",className:Wt("w-full pl-3 text-left font-normal",!w.value&&"text-muted-foreground"),children:[w.value?Fc(w.value,"PPP"):u.jsx("span",{children:"Pick a date"}),u.jsx(wd,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),u.jsx(Yg,{className:"w-auto p-0",align:"start",children:u.jsx(E2,{fieldValue:w.value,dateValue:w.onChange})})]})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"apprehendingOfficer",render:({field:w})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Apprehending Officer"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Officer Name",...w})}),u.jsx(zn,{})]})})]})]})]})})},M6e=({open:e,onOpenChange:t,onViolationAdded:r})=>{const[n,a]=H.useState(!1),{token:l}=la(),f=Su(Date.now()),i=Uh({resolver:np(HK),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),_=async A=>{var E,O;a(!0);try{const F={topNo:A.topNo,firstName:A.firstName,middleInitial:A.middleInitial,lastName:A.lastName,suffix:A.suffix,violations:A.violations,violationType:A.violationType,licenseType:A.licenseType,plateNo:A.plateNo,apprehendingOfficer:A.apprehendingOfficer,chassisNo:A.chassisNo,engineNo:A.engineNo};A.dateOfApprehension&&(F.dateOfApprehension=A.dateOfApprehension);const{data:U}=await Wn.post("/violations",F,{headers:{Authorization:l}});U.success&&(ki.success("Violation has been added",{description:f}),i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(!1),r&&r())}catch(F){console.log(F);const U=((O=(E=F.response)==null?void 0:E.data)==null?void 0:O.message)||"Failed to add violation";ki.error(U,{description:f})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(A)};return u.jsx(Zf,{open:e,onOpenChange:w,children:u.jsxs(Dh,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(mv,{className:"h-5 w-5"}),"Add New Violation"]}),u.jsx(pm,{children:"Fill in the required fields to add a new violation record to the system."})]}),u.jsx("div",{className:"space-y-6",children:u.jsx(Bne,{form:i,onSubmit:_,submitting:n})}),u.jsxs(Gg,{className:"flex justify-start gap-3 pt-6",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),u.jsxs(Xr,{type:"submit",form:"violation-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-black hover:bg-gray-800 text-white",children:[n&&u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Violation"]})]})]})})},j6e=()=>{const[e,t]=H.useState([]),{token:r}=la(),n=Na();no();const[a,l]=H.useState(!0),[f,i]=H.useState(!1),[_,w]=H.useState(!1);H.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:B}=await Wn.get("/violations",{headers:{Authorization:r}}),q=B.data.map(W=>({_id:W._id,topNo:W.topNo||"N/A",firstName:W.firstName||"N/A",middleInitial:W.middleInitial||"",lastName:W.lastName||"N/A",suffix:W.suffix||"",violations:W.violations||[],violationType:W.violationType||"confiscated",licenseType:W.licenseType||null,plateNo:W.plateNo||"N/A",dateOfApprehension:W.dateOfApprehension,apprehendingOfficer:W.apprehendingOfficer||"N/A"}));t(q)}catch(B){console.log(B)}finally{l(!1)}},E=()=>{w(!0)},O=B=>{const q=B._id;n(`/violation/${q}`)},F=B=>{n(`/violation/${B}/edit`)},U=()=>{A()};return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[u.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Violations"}),u.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:u.jsx(k6e,{data:e,filters:["topNo","firstName","lastName","violations","violationType","licenseType","plateNo","dateOfApprehension","apprehendingOfficer"],tableColumn:p5e,onAdd:E,loading:a,onRowClick:O,onEdit:F,onUpdateStatus:()=>{},submitting:f})})]}),u.jsx(M6e,{open:_,onOpenChange:w,onViolationAdded:U})]})},O6e=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:l,onAdd:f,onEdit:i,onUpdateStatus:_,submitting:w})=>{var Te;const[A,E]=Re.useState([]),[O,F]=Re.useState([]),[U,B]=Re.useState({}),[q,W]=Re.useState({pageIndex:0,pageSize:12}),[Z,ne]=Re.useState(""),[ae,ee]=Re.useState(0),se=t,ce=Re.useRef(null);Re.useEffect(()=>{let Ae;const _e=()=>{if(ce.current){const ke=ce.current.offsetHeight,Qe=180,Ze=80,Ge=60,Oe=52,je=ke-Qe-Ze-Ge,Le=Math.max(8,Math.floor(je/Oe)),ut=Math.min(Le,25);ut!==q.pageSize&&W(ze=>({...ze,pageSize:ut}))}},Ee=()=>{clearTimeout(Ae),Ae=setTimeout(_e,100)};return setTimeout(_e,100),window.addEventListener("resize",Ee),()=>{window.removeEventListener("resize",Ee),clearTimeout(Ae)}},[q.pageSize]);const ge=S2({data:n,columns:r(i,_,w),onSortingChange:E,onColumnFiltersChange:F,onPaginationChange:W,getCoreRowModel:x2(),getPaginationRowModel:b2(),getSortedRowModel:w2(),getFilteredRowModel:_2(),onColumnVisibilityChange:B,onGlobalFilterChange:ne,globalFilterFn:(Ae,_e,Ee)=>se.some(ke=>{const Qe=Ae.getValue(ke);return String(Qe).toLowerCase().includes(Ee.toLowerCase())}),state:{pagination:q,sorting:A,columnFilters:O,columnVisibility:U,globalFilter:Z}});return u.jsxs("div",{ref:ce,className:"h-full flex flex-col min-h-0",children:[u.jsx(os,{className:"font-semibold flex-shrink-0",children:e}),u.jsxs("div",{className:"md:flex items-center justify-between py-3 flex-shrink-0",children:[u.jsx("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:u.jsx(Vn,{placeholder:"Search Accident...",value:Z??"",onChange:Ae=>ne(Ae.target.value),className:"pl-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"})}),u.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[u.jsxs(Xr,{onClick:f,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[u.jsx(Wv,{className:"w-4 h-4"}),u.jsx("span",{className:"hidden lg:inline",children:"Add Accident"})]}),u.jsx(T2,{table:ge})]})]}),u.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0 flex flex-col",children:u.jsx("div",{className:"overflow-auto flex-1",children:u.jsx("div",{className:"px-4",children:u.jsxs(oy,{children:[u.jsx(ly,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:ge.getHeaderGroups().map(Ae=>u.jsx(Bs,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:Ae.headers.map(_e=>u.jsx(Js,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-2 py-4 whitespace-nowrap text-left",children:tp(_e.column.columnDef.header,_e.getContext())},_e.id))},Ae.id))}),u.jsx(cy,{className:"text-xs bg-white dark:bg-transparent",children:a?u.jsx(A2,{rowCount:q.pageSize,cellCount:ge.getAllColumns().length}):(Te=ge.getRowModel().rows)!=null&&Te.length?u.jsxs(u.Fragment,{children:[ge.getRowModel().rows.map(Ae=>u.jsx(Bs,{onClick:()=>l(Ae.original),"data-state":Ae.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:Ae.getVisibleCells().map(_e=>u.jsx(Oa,{className:"px-3 py-3 text-gray-800 dark:text-gray-200 text-left",children:tp(_e.column.columnDef.cell,_e.getContext())},_e.id))},Ae.id)),Array.from({length:Math.max(0,q.pageSize-ge.getRowModel().rows.length)}).map((Ae,_e)=>u.jsx(Bs,{className:"hover:bg-transparent",children:ge.getVisibleLeafColumns().map(Ee=>u.jsx(Oa,{className:"px-3 py-3 h-12 border-b border-gray-100 dark:border-gray-700",children:""},`empty-${_e}-${Ee.id}`))},`empty-${_e}`))]}):u.jsx(Bs,{className:"hover:bg-transparent",children:u.jsx(Oa,{colSpan:ge.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),u.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),u.jsx("div",{className:"mt-3 flex-shrink-0",children:u.jsx(P2,{table:ge})})]})},Vne=H.forwardRef(({className:e,...t},r)=>u.jsx("textarea",{className:Wt("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));Vne.displayName="Textarea";const Une=({form:e,onSubmit:t,submitting:r})=>(Na(),u.jsx(Zv,{...e,children:u.jsxs("form",{id:"accident-form",onSubmit:e.handleSubmit(t),className:"space-y-4",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.jsx(Bn,{control:e.control,name:"accident_id",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Accident ID"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"ACC-0001",...n})}),u.jsx(zn,{})]})})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Bn,{control:e.control,name:"plateNo",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Plate No."}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter vehicle plate number",...n})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"accident_date",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Accident Date"}),u.jsx(On,{children:u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsx(On,{children:u.jsxs(Xr,{variant:"outline",className:Wt("w-full text-left font-normal justify-start",!n.value&&"text-muted-foreground"),children:[u.jsx(wd,{className:"h-4 w-4 opacity-50"}),n.value?Fc(n.value,"PPP"):u.jsx("span",{children:"Pick a date"})]})})}),u.jsx(Yg,{className:"w-auto p-2 space-y-2",align:"start",children:u.jsx(E2,{fieldValue:n.value,dateValue:a=>e.setValue("accident_date",a,{shouldValidate:!0})})})]})}),u.jsx(zn,{})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsx(Bn,{control:e.control,name:"street",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Street"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Street",...n})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"barangay",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Barangay"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Barangay",...n})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"municipality",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Municipality"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Municipality",...n})}),u.jsx(zn,{})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Bn,{control:e.control,name:"vehicle_type",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Vehicle Type"}),u.jsxs(Io,{onValueChange:n.onChange,defaultValue:n.value,children:[u.jsx(On,{children:u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select vehicle type"})})}),u.jsxs(go,{children:[u.jsx(_n,{value:"motorcycle",children:"Motorcycle"}),u.jsx(_n,{value:"car",children:"Car"}),u.jsx(_n,{value:"truck",children:"Truck"}),u.jsx(_n,{value:"bus",children:"Bus"}),u.jsx(_n,{value:"van",children:"Van"}),u.jsx(_n,{value:"jeepney",children:"Jeepney"}),u.jsx(_n,{value:"tricycle",children:"Tricycle"}),u.jsx(_n,{value:"other",children:"Other"})]})]}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:e.control,name:"severity",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Severity"}),u.jsxs(Io,{onValueChange:n.onChange,defaultValue:n.value,children:[u.jsx(On,{children:u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select severity"})})}),u.jsxs(go,{children:[u.jsx(_n,{value:"minor",children:"Minor"}),u.jsx(_n,{value:"moderate",children:"Moderate"}),u.jsx(_n,{value:"severe",children:"Severe"}),u.jsx(_n,{value:"fatal",children:"Fatal"})]})]}),u.jsx(zn,{})]})})]}),u.jsx(Bn,{control:e.control,name:"notes",render:({field:n})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Notes"}),u.jsx(On,{children:u.jsx(Vne,{placeholder:"Enter additional notes about the accident...",className:"resize-none",rows:3,...n})}),u.jsx(zn,{})]})})]})})),N6e=({open:e,onOpenChange:t,onAccidentAdded:r})=>{const[n,a]=H.useState(!1),{token:l}=la(),f=Su(Date.now()),i=Uh({resolver:np(WK),defaultValues:{accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}}),_=async A=>{var E,O;a(!0);try{const F={accident_id:A.accident_id,plateNo:A.plateNo,accident_date:A.accident_date?A.accident_date.toISOString():null,street:A.street,barangay:A.barangay,municipality:A.municipality,vehicle_type:A.vehicle_type,severity:A.severity,notes:A.notes};console.log("Sending accident data:",F);const{data:U}=await Wn.post("/accident",F,{headers:{Authorization:l}});U.success&&(ki.success("Accident has been added",{description:f}),i.reset({accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}),t(!1),r&&r())}catch(F){const U=((O=(E=F==null?void 0:F.response)==null?void 0:E.data)==null?void 0:O.message)||"Failed to add accident";ki.error(U,{description:f})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}),t(A)};return u.jsx(Zf,{open:e,onOpenChange:w,children:u.jsxs(Dh,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[u.jsxs(Lh,{children:[u.jsxs(zh,{className:"flex items-center gap-2",children:[u.jsx(mv,{className:"h-5 w-5"}),"Add New Accident"]}),u.jsx(pm,{children:"Fill in the required fields to add a new accident record to the system."})]}),u.jsx("div",{className:"space-y-6",children:u.jsx(Une,{form:i,onSubmit:_,submitting:n})}),u.jsxs(Gg,{className:"flex justify-start gap-3 pt-6",children:[u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),u.jsxs(Xr,{type:"submit",form:"accident-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-black hover:bg-gray-800 text-white",children:[n&&u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Accident"]})]})]})})},R6e=()=>{const[e,t]=H.useState([]),{token:r}=la(),n=Na();no();const[a,l]=H.useState(!0),[f,i]=H.useState(!1),[_,w]=H.useState(!1);H.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:B}=await Wn.get("/accident",{headers:{Authorization:r}}),q=B.data.map(W=>({_id:W._id,accident_id:W.accident_id,plateNo:W.plateNo||"N/A",accident_date:Zg(W.accident_date),street:W.street,barangay:W.barangay,municipality:W.municipality,vehicle_type:W.vehicle_type||"N/A",severity:W.severity||"N/A",notes:W.notes||""}));t(q)}catch(B){console.log(B)}finally{l(!1)}},E=()=>{w(!0)},O=B=>{const q=B._id;n(`/accident/${q}`)},F=B=>{n(`/accident/${B}/edit`)},U=()=>{A()};return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[u.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Accidents"}),u.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:u.jsx(O6e,{data:e,filters:["accident_id","plateNo","accident_date","street","barangay","municipality","vehicle_type","severity"],tableColumn:d5e,onAdd:E,loading:a,onRowClick:O,onEdit:F,onUpdateStatus:()=>{},submitting:f})})]}),u.jsx(N6e,{open:_,onOpenChange:w,onAccidentAdded:U})]})},I6e=()=>{const e=_m(),[t,r]=H.useState(!0),{token:n}=la(),[a,l]=H.useState(),f=no(),i=Na(),_=async()=>{try{const{data:w}=await Wn.get(`/accident/${e.id}`,{headers:{Authorization:n}});w&&l(w.data)}catch{}r(!1)};return H.useEffect(()=>{_()},[]),t?u.jsx("div",{children:"Loading..."}):u.jsxs(wi,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[u.jsxs(Ii,{className:"border-b",children:[u.jsxs(Di,{className:"text-3xl font-bold",children:["Accident #",(a==null?void 0:a.accident_id)||"Details"]}),u.jsx(ls,{children:(a==null?void 0:a.description)||"No description available."})]}),u.jsx(Ei,{className:"p-0 pb-6",children:u.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[u.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Accident Information"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Date:"}),u.jsx("p",{className:"font-semibold w-full",children:Zg(a==null?void 0:a.accident_date)}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Location:"}),u.jsx("p",{className:"font-semibold w-full",children:`${(a==null?void 0:a.street)||""}, ${(a==null?void 0:a.barangay)||""}, ${(a==null?void 0:a.municipality)||""}`}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate No:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Vehicle Type:"}),u.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.vehicle_type)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Severity:"}),u.jsx("p",{className:"font-semibold w-full",children:u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(a==null?void 0:a.severity)==="minor"?"text-green-600 bg-green-100":(a==null?void 0:a.severity)==="moderate"?"text-yellow-600 bg-yellow-100":(a==null?void 0:a.severity)==="severe"?"text-orange-600 bg-orange-100":(a==null?void 0:a.severity)==="fatal"?"text-red-600 bg-red-100":"text-gray-600 bg-gray-100"}`,children:(a==null?void 0:a.severity)||"N/A"})}),(a==null?void 0:a.notes)&&u.jsxs(u.Fragment,{children:[u.jsx("h2",{className:"text-muted-foreground px-6",children:"Notes:"}),u.jsx("p",{className:"font-semibold w-full col-span-2",children:a.notes})]}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Last Edited:"}),u.jsx("p",{className:"font-semibold w-full",children:Zg(a==null?void 0:a.time_edited)})]})}),u.jsx(dC,{className:"gap-2 text-sm ",children:u.jsxs(Xr,{onClick:()=>i(`${f.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[u.jsx(Nc,{}),"Edit"]})})]})},D6e=()=>{const e=Na();return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:u.jsxs(Xr,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[u.jsx(eP,{})," Back"]})}),u.jsx("div",{className:"p-4 md:p-0",children:u.jsx(I6e,{})})]})},L6e=()=>{const[e,t]=H.useState(!1),{token:r}=la(),n=_m(),a=Su(Date.now()),l=Na(),f=Uh({resolver:np(WK),defaultValues:{accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}}),{reset:i}=f;H.useEffect(()=>{_()},[n.id,r]);const _=async()=>{const A=n.id;try{const{data:E}=await Wn.get(`/accident/${A}`,{headers:{Authorization:r}});if(E!=null&&E.data){const O=E.data;i({accident_id:O.accident_id,plateNo:O.plateNo||"",accident_date:new Date(O.accident_date),street:O.street,barangay:O.barangay,municipality:O.municipality,vehicle_type:O.vehicle_type||"",severity:O.severity||"",notes:O.notes||""})}}catch(E){console.log(E)}},w=async A=>{var E,O;t(!0);try{const F={accident_id:A.accident_id,plateNo:A.plateNo,accident_date:A.accident_date?A.accident_date.toISOString():null,street:A.street,barangay:A.barangay,municipality:A.municipality,vehicle_type:A.vehicle_type,severity:A.severity,notes:A.notes},{data:U}=await Wn.patch(`/accident/${n.id}`,F,{headers:{Authorization:r}});U.success&&(ki.success("Accident updated",{description:a}),l(-1))}catch(F){const U=((O=(E=F==null?void 0:F.response)==null?void 0:E.data)==null?void 0:O.message)||"Failed to update accident";ki.error(U,{description:`${a}`})}finally{t(!1)}};return u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsx(Di,{className:"text-xl md:text-3xl font-bold",children:"Edit Accident"}),u.jsx(ls,{children:"Update accident details."})]}),u.jsx(Ei,{children:u.jsx(Une,{form:f,onSubmit:w,submitting:e})})]})},z6e=()=>{const e=_m(),[t,r]=H.useState(!0),n=la(),{token:a}=n||{},[l,f]=H.useState(),i=no(),_=Na(),w=async()=>{try{const{data:A}=await Wn.get(`/violations/${e.id}`,{headers:{Authorization:a}});A&&f(A.data)}catch{}r(!1)};return H.useEffect(()=>{w()},[]),t?u.jsx("div",{children:"Loading..."}):u.jsxs(wi,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[u.jsxs(Ii,{className:"border-b",children:[u.jsxs(Di,{className:"text-3xl font-bold",children:["TOP #",(l==null?void 0:l.topNo)||"Details"]}),u.jsx(ls,{children:(l==null?void 0:l.remarks)||"No remarks available."})]}),u.jsx(Ei,{className:"p-0 pb-6",children:u.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[u.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Apprehension Details"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Name:"}),u.jsx("p",{className:"font-semibold w-full",children:l!=null&&l.firstName&&(l!=null&&l.lastName)?`${l.firstName}${l.middleInitial?` ${l.middleInitial}.`:""} ${l.lastName}${l.suffix?` ${l.suffix}`:""}`:"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Violations:"}),u.jsx("p",{className:"font-semibold w-full",children:l!=null&&l.violations&&Array.isArray(l.violations)?l.violations.join(", "):"N/A"}),u.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1 mt-4",children:"Confiscated Item"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"License Type:"}),u.jsx("p",{className:"font-semibold w-full",children:(l==null?void 0:l.licenseType)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate No:"}),u.jsx("p",{className:"font-semibold w-full",children:(l==null?void 0:l.plateNo)||"N/A"}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Date of Apprehension:"}),u.jsx("p",{className:"font-semibold w-full",children:Zg(l==null?void 0:l.dateOfApprehension)}),u.jsx("h2",{className:"text-muted-foreground px-6",children:"Apprehending Officer:"}),u.jsx("p",{className:"font-semibold w-full",children:(l==null?void 0:l.apprehendingOfficer)||"N/A"})]})}),u.jsx(dC,{className:"gap-2 text-sm ",children:u.jsxs(Xr,{onClick:()=>_(`${i.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[u.jsx(Nc,{}),"Edit"]})})]})},F6e=()=>{const e=Na();return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:u.jsxs(Xr,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[u.jsx(eP,{})," Back"]})}),u.jsx("div",{className:"p-4 md:p-0",children:u.jsx(z6e,{})})]})},B6e=()=>{const[e,t]=H.useState(!1),{token:r}=la(),n=_m(),a=Su(Date.now()),l=Na(),f=Uh({resolver:np(HK),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),{reset:i}=f;H.useEffect(()=>{_()},[n.id,r]);const _=async()=>{const A=n.id;try{const{data:E}=await Wn.get(`/violations/${A}`,{headers:{Authorization:r}});if(E!=null&&E.data){const O=E.data,F=O.violationType||"confiscated";i({topNo:O.topNo||"",firstName:O.firstName||"",middleInitial:O.middleInitial||"",lastName:O.lastName||"",suffix:O.suffix||"",violations:O.violations||[""],violationType:F,licenseType:O.licenseType||void 0,plateNo:O.plateNo||"",dateOfApprehension:O.dateOfApprehension?new Date(O.dateOfApprehension):void 0,apprehendingOfficer:O.apprehendingOfficer||""})}}catch(E){console.log(E)}},w=async A=>{var E,O;t(!0);try{const F={topNo:A.topNo,violationType:A.violationType,plateNo:A.plateNo,dateOfApprehension:A.dateOfApprehension,apprehendingOfficer:A.apprehendingOfficer};A.violationType==="confiscated"?(F.firstName=A.firstName,F.middleInitial=A.middleInitial,F.lastName=A.lastName,F.suffix=A.suffix,F.violations=A.violations?A.violations.filter(B=>B.trim()!==""):[],F.licenseType=A.licenseType):A.violationType==="impounded"?(F.firstName=A.firstName,F.middleInitial=A.middleInitial,F.lastName=A.lastName,F.suffix=A.suffix,F.violations=A.violations?A.violations.filter(B=>B.trim()!==""):[],F.licenseType=null):A.violationType==="alarm"&&(F.firstName=null,F.middleInitial=null,F.lastName=null,F.suffix=null,F.violations=null,F.licenseType=null);const{data:U}=await Wn.patch(`/violations/${n.id}`,F,{headers:{Authorization:r}});U.success&&(ki.success("Violation updated",{description:a}),l(-1))}catch(F){const U=((O=(E=F==null?void 0:F.response)==null?void 0:E.data)==null?void 0:O.message)||"Failed to update violation";ki.error(U,{description:`${a}`})}finally{t(!1)}};return u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsx(Di,{className:"text-xl md:text-3xl font-bold",children:"Edit Violation"}),u.jsx(ls,{children:"Update violation details."})]}),u.jsx(Ei,{children:u.jsx(Bne,{form:f,onSubmit:w,submitting:e})})]})},V6e=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Wn.get("/dashboard/registration-analytics",{params:r})).data}catch(r){throw console.error("Error fetching registration analytics:",r),r}},vC=e=>["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(e)+1,U6e=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Wn.get("/dashboard/municipality-registration-totals",{params:r})).data}catch(r){throw console.error("Error fetching municipality registration totals:",r),r}},$6e=async(e,t=null,r=null)=>{try{const n={municipality:e};return t&&(n.month=t),r&&(n.year=r),(await Wn.get("/dashboard/barangay-registration-totals",{params:n})).data}catch(n){throw console.error("Error fetching barangay registration totals:",n),n}},q6e=async(e=null,t=null,r=null)=>{try{const n={};return e&&(n.startYear=e),t&&(n.endYear=t),r&&(n.municipality=r),(await Wn.get("/dashboard/yearly-vehicle-trends",{params:n})).data}catch(n){throw console.error("Error fetching yearly vehicle trends:",n),n}},G6e=async(e,t=null)=>{try{const r={year:e};return t&&(r.municipality=t),(await Wn.get("/dashboard/monthly-vehicle-trends",{params:r})).data}catch(r){throw console.error("Error fetching monthly vehicle trends:",r),r}},W6e=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Wn.get("/dashboard/owner-municipality-data",{params:r})).data}catch(r){throw console.error("Error fetching owner municipality data:",r),r}},H6e=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Wn.get("/dashboard/vehicle-classification-data",{params:r})).data}catch(r){throw console.error("Error fetching vehicle classification data:",r),r}},K6e=({isOpen:e,onClose:t,municipality:r,selectedMonth:n,selectedYear:a,municipalitiesList:l=[]})=>{var Qe,Ze;const[f,i]=H.useState([]),[_,w]=H.useState(!1),[A,E]=H.useState(null),[O,F]=H.useState("desc"),[U,B]=H.useState(!1),[q,W]=H.useState(!1),[Z,ne]=H.useState(0),[ae,ee]=H.useState("right"),[se,ce]=H.useState(!1);H.useEffect(()=>{if(e&&r&&l.length>0){const Ge=l.findIndex(Oe=>Oe.municipality===r);ne(Ge>=0?Ge:0)}},[e,r,l]),H.useEffect(()=>{e&&r&&ge()},[e,r,n,a]),H.useEffect(()=>{W(!!e)},[e]);const ge=async(Ge=r)=>{try{w(!0),E(null);let Oe=null,je=null;n&&n!=="All"&&(Oe=["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(n)+1),a&&a!=="All"&&(je=a),console.log("Fetching barangay data for",Ge,"with:",{monthNumber:Oe,yearValue:je,selectedMonth:n,selectedYear:a});const Le=await $6e(Ge,Oe,je);i(Le.data||[])}catch(Oe){console.error("Error fetching barangay data:",Oe),E("Error loading barangay data")}finally{w(!1)}},Te=()=>{Z>0&&(ee("left"),ce(!0),setTimeout(()=>{const Ge=Z-1;ne(Ge);const Oe=l[Ge].municipality;ge(Oe),setTimeout(()=>ce(!1),100)},200))},Ae=()=>{Z<l.length-1&&(ee("right"),ce(!0),setTimeout(()=>{const Ge=Z+1;ne(Ge);const Oe=l[Ge].municipality;ge(Oe),setTimeout(()=>ce(!1),100)},200))},_e=Ge=>Ge.toLocaleString(),Ee=()=>{B(!0),F(Ge=>Ge==="desc"?"asc":"desc"),setTimeout(()=>B(!1),300)},ke=[...f].sort((Ge,Oe)=>O==="desc"?Oe.vehicles-Ge.vehicles:Ge.vehicles-Oe.vehicles);return e?u.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4",children:u.jsxs("div",{className:`bg-gray-100 border border-gray-200/50 rounded-2xl p-4 sm:p-6 w-full max-w-4xl h-[90vh] sm:h-[85vh] overflow-hidden dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] dark:!border-[#2A2A3E]/50 dark:!shadow-2xl flex flex-col transition-all duration-500 ease-out transform ${q?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-4"}`,children:[u.jsxs("div",{className:"bg-gray-100 dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] border-b border-gray-200/50 dark:border-gray-700/30 pb-4 mb-4 flex-shrink-0",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-4",children:[u.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[u.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl shadow-lg",children:u.jsxs("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M3 3v18h18"}),u.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),u.jsx("path",{d:"M16 5l3 3-3 3"})]})}),u.jsxs("div",{className:"flex items-center gap-3",children:[l.length>1&&u.jsx(u.Fragment,{children:u.jsx("button",{onClick:Te,disabled:Z===0,className:`p-2 rounded-xl transition-all duration-300 transform ${Z===0?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Previous Municipality",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})}),u.jsxs("div",{className:"overflow-hidden",children:[u.jsx("h2",{className:`text-xl sm:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent dark:from-blue-400 dark:to-purple-400 transition-all duration-500 ease-in-out ${se?ae==="left"?"opacity-0 transform translate-x-4 scale-95":"opacity-0 transform -translate-x-4 scale-95":"opacity-100 transform translate-x-0 scale-100"}`,children:((Qe=l[Z])==null?void 0:Qe.municipality)||r}),u.jsxs("p",{className:`text-sm text-muted-foreground mt-1 transition-all duration-500 ease-in-out ${se?"opacity-0 transform translate-y-2":"opacity-100 transform translate-y-0"}`,children:["Barangay Registration Data",a==="All"&&n&&n!=="All"&&u.jsxs("span",{className:"ml-2 text-xs",children:["(",n," across all years)"]})]})]}),l.length>1&&u.jsx("button",{onClick:Ae,disabled:Z===l.length-1,className:`p-2 rounded-xl transition-all duration-300 transform ${Z===l.length-1?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Next Municipality",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),u.jsx("button",{onClick:t,className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-all duration-200 hover:scale-105",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-3 border border-blue-200/50 dark:border-blue-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-md flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),u.jsx("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Total Barangays"})]}),u.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:f.length})]}),u.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-3 border border-green-200/50 dark:border-green-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-md flex items-center justify-center",children:u.jsxs("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0M15 17a2 2 0 104 0"})]})}),u.jsx("div",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Total Vehicles"})]}),u.jsx("div",{className:"text-xl font-bold text-green-900 dark:text-green-100",children:_e(f.reduce((Ge,Oe)=>Ge+Oe.vehicles,0))})]}),u.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-xl p-3 border border-orange-200/50 dark:border-orange-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded-md flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),u.jsx("div",{className:"text-xs font-medium text-orange-700 dark:text-orange-300",children:"Zero Registrations"})]}),u.jsx("div",{className:"text-xl font-bold text-orange-900 dark:text-orange-100",children:f.filter(Ge=>Ge.vehicles===0).length})]})]})]}),u.jsx("div",{className:"overflow-y-auto flex-1 scrollbar-hide overflow-x-hidden min-h-0",children:u.jsx("div",{className:`transition-all duration-500 ease-in-out ${se?ae==="left"?"opacity-0 transform translate-x-6 scale-98":"opacity-0 transform -translate-x-6 scale-98":"opacity-100 transform translate-x-0 scale-100"}`,children:_?u.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):A?u.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-red-500",children:u.jsx("p",{children:A})}):f.length===0?u.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-muted-foreground",children:u.jsxs("p",{children:["No barangay data available for ",((Ze=l[Z])==null?void 0:Ze.municipality)||r]})}):u.jsx("div",{children:u.jsx("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-2xl border border-gray-200/50 dark:border-gray-700/30 overflow-hidden min-h-[400px] overflow-x-auto",children:u.jsxs("table",{className:"w-full min-w-[600px]",children:[u.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:"Barangay Name"}),u.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 select-none",onClick:Ee,children:u.jsxs("div",{className:"flex items-center gap-2",children:["Total Registered Vehicles",u.jsxs("div",{className:"flex flex-col",children:[u.jsx("svg",{className:`w-3 h-3 ${O==="desc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),u.jsx("svg",{className:`w-3 h-3 ${O==="asc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})]})}),u.jsx("tbody",{className:"bg-white dark:bg-gray-800/30 divide-y divide-gray-200/50 dark:divide-gray-700/30",children:ke.map((Ge,Oe)=>{const je=Ge.vehicles===0;return u.jsxs("tr",{className:`hover:bg-gray-50/80 dark:hover:bg-gray-700/50 transition-all duration-200 ${je?"bg-gradient-to-r from-red-50/80 to-red-100/50 dark:from-red-900/20 dark:to-red-800/10 border-l-4 border-red-500":""}`,style:{animation:`smoothFadeIn 0.6s ease-out ${Oe*.03}s both`},children:[u.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center mr-4 shadow-sm ${je?"bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900/40 dark:to-red-800/40":"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/40"}`,children:u.jsx("span",{className:`text-sm font-bold ${je?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"}`,children:Oe+1})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`text-base font-semibold ${je?"text-red-800 dark:text-red-200":"text-gray-800 dark:text-gray-200"}`,children:Ge.barangay}),je&&u.jsx("span",{className:"px-3 py-1 text-xs font-semibold bg-gradient-to-r from-red-100 to-red-200 text-red-800 dark:from-red-900/40 dark:to-red-800/40 dark:text-red-200 rounded-full shadow-sm",children:"No Registrations"})]})]})}),u.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:u.jsx("div",{className:`text-lg font-bold ${je?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-200"}`,children:_e(Ge.vehicles)})})]},Ge.barangay)})})]})})})})})]})}):null},Z6e=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=H.useState([]),[l,f]=H.useState(!1),[i,_]=H.useState(null),[w,A]=H.useState(!1),[E,O]=H.useState("desc"),[F,U]=H.useState(!1),[B,q]=H.useState(!1),[W,Z]=H.useState(null),[ne,ae]=H.useState(!1);H.useEffect(()=>{const ke=()=>{ae(window.innerWidth<640)};return ke(),window.addEventListener("resize",ke),()=>window.removeEventListener("resize",ke)},[]);const ee=async()=>{try{f(!0),_(null);let ke=null,Qe=null;e&&e!=="All"&&(ke=vC(e)),t&&t!=="All"&&(Qe=t);const Ze=await U6e(ke,Qe);Ze.success?a(Ze.data):(_("Failed to fetch municipality data"),a([]))}catch(ke){console.error("Error fetching municipality data:",ke),_("Error loading municipality data")}finally{f(!1)}};H.useEffect(()=>{ee(),U(!1)},[]),H.useEffect(()=>{ee(),U(!1)},[e,t]);const se=[...n].sort((ke,Qe)=>E==="asc"?ke.vehicles-Qe.vehicles:Qe.vehicles-ke.vehicles),ce=se.slice(0,5);H.useEffect(()=>{if(n.length>0){const ke=setTimeout(()=>U(!0),100);return()=>clearTimeout(ke)}},[n]);const ge=ke=>ke.map((Qe,Ze)=>({name:Qe.municipality,vehicles:Qe.vehicles,index:Ze,totalCount:ke.length})),Te=(ke,Qe)=>{if(E==="asc"){if(ke<5)return ke===0?"#dc2626":ke===1?"#ea580c":ke===2?"#d97706":ke===3?"#ca8a04":"#eab308";if(ke>=5&&ke<Qe-5)return"#84cc16";if(ke>=Qe-5)return ke===Qe-1?"#1d4ed8":ke===Qe-2?"#2563eb":ke===Qe-3?"#3b82f6":ke===Qe-4?"#60a5fa":"#93c5fd"}else{if(ke<5)return ke===0?"#1d4ed8":ke===1?"#2563eb":ke===2?"#3b82f6":ke===3?"#60a5fa":"#93c5fd";if(ke>=5&&ke<Qe-5)return"#84cc16";if(ke>=Qe-5)return ke===Qe-1?"#dc2626":ke===Qe-2?"#ea580c":ke===Qe-3?"#d97706":ke===Qe-4?"#ca8a04":"#eab308"}return"#3b82f6"},Ae=({active:ke,payload:Qe,label:Ze})=>{if(ke&&Qe&&Qe.length){const Ge=Qe[0].value,Oe=se.length>0?(Ge/Math.max(...se.map(je=>je.vehicles))*100).toFixed(1):0;return u.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-blue-500 to-purple-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:Ze}),u.jsxs("p",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[u.jsx("span",{className:"font-semibold text-lg",children:Ge.toLocaleString()})," vehicles"]}),u.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:[Oe,"% of highest"]})]})]})})}return null},_e=ke=>{Z(ke),q(!0)},Ee=()=>{q(!1),Z(null)};return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsxs("svg",{className:"w-6 h-6 text-orange-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),u.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["DavOr Vehicle Registration Rankings",t==="All"&&e&&e!=="All"&&u.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&u.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Top performing municipalities by vehicle registration volume"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:()=>O(E==="asc"?"desc":"asc"),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors flex items-center gap-1",title:`Sort ${E==="asc"?"Highest to Lowest":"Lowest to Highest"}`,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:E==="asc"?u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"}):u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}),E==="asc"?"":""]}),u.jsx("button",{onClick:()=>A(!0),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors",children:"View All"})]})]}),u.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[l||r?u.jsx("div",{className:"flex items-center justify-center w-full h-full",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:u.jsx("p",{children:i})}):ce.length===0?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:u.jsx("p",{children:"No data available"})}):u.jsx(No,{width:"100%",height:"100%",minHeight:320,children:u.jsxs(_d,{data:ge(ce),margin:{top:10,right:10,left:5,bottom:20},barCategoryGap:"10%",children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),u.jsx(La,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:20,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:ke=>ke.length>12?ke.substring(0,12)+"...":ke}),u.jsx(za,{stroke:"#6b7280",fontSize:9,tickFormatter:ke=>ke.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:50}),u.jsx(aa,{content:u.jsx(Ae,{})}),u.jsx(xs,{dataKey:"vehicles",radius:[8,8,0,0],onClick:ke=>_e(ke.name),style:{cursor:"pointer"},maxBarSize:120,children:ge(ce).map((ke,Qe)=>{const Ze=Te(ke.index,ke.totalCount);return u.jsx(Xf,{fill:Ze,stroke:Ze,strokeWidth:2,style:{filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15))",transition:"all 0.3s ease"}},`cell-${Qe}`)})})]})}),ce.length>0&&u.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:ne?"10px":"12px",fontWeight:"500",paddingTop:"0px",paddingBottom:"0px",textAlign:"center"},children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-700"}),u.jsx("span",{children:"High"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),u.jsx("span",{children:"Medium-high"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),u.jsx("span",{children:"Medium"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),u.jsx("span",{children:"Low"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),u.jsx("span",{children:"Lowest"})]})]})]})]}),w&&u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 border border-gray-200 rounded-xl p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden shadow-2xl dark:!bg-transparent dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsxs("svg",{className:"w-6 h-6 text-foreground",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M3 3v18h18"}),u.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),u.jsx("path",{d:"M16 5l3 3-3 3"})]})}),u.jsxs("h2",{className:"text-2xl font-bold text-foreground",children:["All Municipalities",t==="All"&&e&&e!=="All"&&u.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&u.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]})]}),u.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-muted rounded-md transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"h-[500px]",children:u.jsx(No,{width:"100%",height:"100%",minHeight:320,children:u.jsxs(_d,{data:ge(se),margin:{top:20,right:10,left:10,bottom:60},barCategoryGap:"5%",children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),u.jsx(La,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:5,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:ke=>ke.length>12?ke.substring(0,12)+"...":ke}),u.jsx(za,{stroke:"#6b7280",fontSize:12,tickFormatter:ke=>ke.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:60}),u.jsx(aa,{content:u.jsx(Ae,{})}),u.jsx(xs,{dataKey:"vehicles",radius:[6,6,0,0],onClick:ke=>_e(ke.name),style:{cursor:"pointer"},maxBarSize:80,children:ge(se).map((ke,Qe)=>{const Ze=Te(ke.index,ke.totalCount);return u.jsx(Xf,{fill:Ze,stroke:Ze,strokeWidth:1.5,style:{filter:"drop-shadow(0 3px 6px rgba(0, 0, 0, 0.12))",transition:"all 0.3s ease"}},`cell-${Qe}`)})})]})})})]})}),u.jsx(K6e,{isOpen:B,onClose:Ee,municipality:W,selectedMonth:e,selectedYear:t,municipalitiesList:se})]})},Y6e=()=>{const[e,t]=H.useState([]),[r,n]=H.useState(!1);H.useEffect(()=>{const rt=()=>{n(window.innerWidth<640)};return rt(),window.addEventListener("resize",rt),()=>window.removeEventListener("resize",rt)},[]),H.useEffect(()=>{const rt=document.createElement("style");return rt.textContent=`
      .scrollbar-hide {
        -ms-overflow-style: none;  /* Internet Explorer 10+ */
        scrollbar-width: none;  /* Firefox */
      }
      .scrollbar-hide::-webkit-scrollbar { 
        display: none;  /* Safari and Chrome */
      }
    `,document.head.appendChild(rt),()=>{document.head.removeChild(rt)}},[]);const[a,l]=H.useState(!1),[f,i]=H.useState(null),[_,w]=H.useState(!1),[A,E]=H.useState(!1),[O,F]=H.useState(""),[U,B]=H.useState(""),[q,W]=H.useState(!1),[Z,ne]=H.useState("year"),[ae,ee]=H.useState(!1),[se,ce]=H.useState(""),[ge,Te]=H.useState(()=>localStorage.getItem("vehicleTrendMunicipality")||"All"),[Ae,_e]=H.useState(!1),Ee=new Date().getFullYear(),ke=["All","BAGANGA","BANAYBANAY","BOSTON","CARAGA","CATEEL","GOVERNOR GENEROSO","LUPON","MANAY","SAN ISIDRO","TARRAGONA","CITY OF MATI"],Qe=async(rt,Qt,Cr=null)=>{try{l(!0),i(null);const cr=await q6e(rt,Qt,Cr||ge);if(cr.success){const nr=cr.data.map((Kt,De,er)=>Kt.total===0?er.slice(De+1).find(Rr=>Rr.total>0)?{...Kt,total:0,active:0,expired:0,noRegistration:null}:{...Kt,total:null,active:null,expired:null,noRegistration:0}:{...Kt,noRegistration:null});t(nr)}else i("Failed to fetch yearly trend data"),t([])}catch(vr){console.error("Error fetching yearly trend data:",vr),i("Error loading yearly trend data")}finally{l(!1)}},Ze=async(rt,Qt=null)=>{try{l(!0),i(null);const vr=await G6e(rt,Qt||ge);if(vr.success){const cr=vr.data.map((nr,Kt,De)=>nr.total===0?De.slice(Kt+1).find(Lt=>Lt.total>0)?{...nr,total:0,active:0,expired:0,noRegistration:null}:{...nr,total:null,active:null,expired:null,noRegistration:0}:{...nr,noRegistration:null});t(cr)}else i("Failed to fetch monthly trend data"),t([])}catch(Cr){console.error("Error fetching monthly trend data:",Cr),i("Error loading monthly trend data")}finally{l(!1)}},Ge=()=>{w(!0)},Oe=()=>{const rt=parseInt(O),Qt=parseInt(U);if(i(null),!rt||!Qt){i("Please enter both start and end years");return}if(rt<2e3){i(`Start year ${rt} is too early. Please enter a year from 2000 onwards`);return}if(Qt>Ee){i(`End year ${Qt} is in the future. Please enter a year up to ${Ee}`);return}if(rt>Qt){i(`Start year ${rt} cannot be later than end year ${Qt}`);return}W(!0),localStorage.setItem("vehicleTrendCustomStartYear",rt.toString()),localStorage.setItem("vehicleTrendCustomEndYear",Qt.toString()),localStorage.setItem("vehicleTrendIsCustomRange","true"),Z==="year"&&Qe(rt,Qt,ge),E(!1)},je=()=>{W(!1),F(""),B(""),i(null),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),Z==="year"&&Qe(Ee-4,Ee,ge),E(!1)},Le=rt=>{ne(rt),localStorage.setItem("vehicleTrendViewType",rt),rt==="year"?(W(!1),F(""),B(""),Qe(Ee-4,Ee,ge),w(!1)):rt==="month"?(ee(!0),w(!1)):rt==="customRange"&&w(!1)},ut=rt=>{ce(rt),localStorage.setItem("vehicleTrendSelectedYear",rt),i(null),ee(!1),Ze(rt,ge)},ze=rt=>{Te(rt),localStorage.setItem("vehicleTrendMunicipality",rt),_e(!1),Z==="year"?q&&O&&U?Qe(parseInt(O),parseInt(U),rt):Qe(Ee-4,Ee,rt):Z==="month"&&se&&Ze(se,rt)};H.useEffect(()=>{const rt=localStorage.getItem("vehicleTrendMunicipality")||"All";Qe(Ee-4,Ee,rt),localStorage.setItem("vehicleTrendViewType","year"),localStorage.removeItem("vehicleTrendSelectedYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear")},[]),H.useEffect(()=>{const rt=Qt=>{_&&!Qt.target.closest(".filter-dropdown")&&w(!1)};return document.addEventListener("mousedown",rt),()=>{document.removeEventListener("mousedown",rt)}},[_]),H.useEffect(()=>{Z==="month"&&!se&&(ne("year"),W(!1),F(""),B(""),Qe(Ee-4,Ee,ge))},[Z,se]);const ht=({active:rt,payload:Qt,label:Cr})=>{if(rt&&Qt&&Qt.length){const vr=Qt.filter(nr=>nr.value!==null&&nr.dataKey!=="noRegistration"&&(nr.dataKey==="total"||nr.dataKey==="active"||nr.dataKey==="expired")),cr=vr.every(nr=>nr.value===0);return u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-3 shadow-lg",children:[u.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:Cr}),u.jsx("div",{className:"space-y-1",children:vr.map((nr,Kt)=>u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:nr.color}}),u.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[nr.dataKey==="total"?"Total":nr.dataKey==="active"?"Active":"Expired",":",u.jsx("span",{className:"ml-1 font-medium",children:cr?"No Data":nr.value.toLocaleString()})]})]},Kt))})]})}return null};return u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsxs("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M3 3v18h18"}),u.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),u.jsx("circle",{cx:"18",cy:"8",r:"2"})]})}),u.jsxs("div",{className:"flex flex-col",children:[u.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["Vehicle Registration Trends",u.jsxs("span",{className:"text-muted-foreground font-normal ml-2",style:{fontSize:"10px"},children:[Z==="year"?q?`By Year (${O}-${U})`:"By Year (Last 5 Years)":`By Month (${se||"Select Year"})`,ge!=="All"&&u.jsxs("span",{className:"text-primary font-medium",children:[" ",ge]})]})]}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Historical registration patterns showing total, active, and expired vehicles"})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:Ge,className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Filter options",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),_&&u.jsx("div",{className:"filter-dropdown absolute right-0 top-full mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:u.jsxs("div",{className:"p-2",children:[u.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"View Type"}),u.jsx("button",{onClick:()=>Le("year"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${Z==="year"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Year"}),u.jsx("button",{onClick:()=>Le("month"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${Z==="month"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Month"}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 my-1"}),u.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"Date Range"}),u.jsx("button",{onClick:()=>{w(!1),E(!0)},className:"w-full text-left px-2 py-2 text-sm rounded-md transition-colors text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Custom Range"})]})})]}),u.jsx("button",{onClick:()=>_e(!0),className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Location options",children:u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),u.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[a?u.jsx("div",{className:"flex items-center justify-center w-full h-full",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):f?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:u.jsx("p",{children:f})}):e.length===0?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:u.jsx("p",{children:"No data available"})}):u.jsx(No,{width:"100%",height:"100%",minHeight:320,children:u.jsxs(YL,{data:e,margin:{top:10,right:20,left:0,bottom:20},children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"totalGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:.8}),u.jsx("stop",{offset:"20%",stopColor:"#3b82f6",stopOpacity:.6}),u.jsx("stop",{offset:"40%",stopColor:"#3b82f6",stopOpacity:.4}),u.jsx("stop",{offset:"60%",stopColor:"#3b82f6",stopOpacity:.2}),u.jsx("stop",{offset:"80%",stopColor:"#3b82f6",stopOpacity:.1}),u.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:0})]}),u.jsxs("linearGradient",{id:"activeGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:.8}),u.jsx("stop",{offset:"20%",stopColor:"#10b981",stopOpacity:.6}),u.jsx("stop",{offset:"40%",stopColor:"#10b981",stopOpacity:.4}),u.jsx("stop",{offset:"60%",stopColor:"#10b981",stopOpacity:.2}),u.jsx("stop",{offset:"80%",stopColor:"#10b981",stopOpacity:.1}),u.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:0})]}),u.jsxs("linearGradient",{id:"expiredGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#ef4444",stopOpacity:.8}),u.jsx("stop",{offset:"20%",stopColor:"#ef4444",stopOpacity:.6}),u.jsx("stop",{offset:"40%",stopColor:"#ef4444",stopOpacity:.4}),u.jsx("stop",{offset:"60%",stopColor:"#ef4444",stopOpacity:.2}),u.jsx("stop",{offset:"80%",stopColor:"#ef4444",stopOpacity:.1}),u.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:0})]})]}),u.jsx(Xs,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),u.jsx(La,{dataKey:Z==="year"?"year":"month",stroke:"#6b7280",fontSize:r?10:12,tick:{fill:"#6b7280",fontWeight:500},angle:r?-45:0,textAnchor:r?"end":"middle",height:r?60:30}),u.jsx(za,{stroke:"#6b7280",fontSize:r?10:12,tickFormatter:rt=>rt.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:r?60:80}),u.jsx(aa,{content:u.jsx(ht,{})}),u.jsx(yu,{type:"monotone",dataKey:"total",stroke:"#3b82f6",strokeWidth:3,fill:"url(#totalGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#3b82f6",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(59, 130, 246, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#3b82f6",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(59, 130, 246, 0.4))"},name:"Total Vehicles"}),u.jsx(yu,{type:"monotone",dataKey:"active",stroke:"#10b981",strokeWidth:3,fill:"url(#activeGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#10b981",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(16, 185, 129, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#10b981",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(16, 185, 129, 0.4))"},name:"Active Vehicles"}),u.jsx(yu,{type:"monotone",dataKey:"expired",stroke:"#ef4444",strokeWidth:3,fill:"url(#expiredGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#ef4444",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(239, 68, 68, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#ef4444",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(239, 68, 68, 0.4))"},name:"Expired Vehicles"}),u.jsx(yu,{type:"monotone",dataKey:"noRegistration",stroke:"#9ca3af",strokeWidth:2,strokeDasharray:"3 3",fill:"none",connectNulls:!0,dot:{fill:"#9ca3af",strokeWidth:1,r:3,filter:"drop-shadow(0 1px 2px rgba(156, 163, 175, 0.3))"},activeDot:{r:5,stroke:"#9ca3af",strokeWidth:1,filter:"drop-shadow(0 2px 4px rgba(156, 163, 175, 0.4))"},name:"No Registration",hide:!0})]})}),e.length>0&&u.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:r?"10px":"12px",fontWeight:"500",paddingTop:"0px",textAlign:"center"},children:[e.some(rt=>rt.total!==null)&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),u.jsx("span",{children:"Total Vehicles"})]}),e.some(rt=>rt.active!==null)&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),u.jsx("span",{children:"Active Vehicles"})]}),e.some(rt=>rt.expired!==null)&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),u.jsx("span",{children:"Expired Vehicles"})]})]})]}),A&&u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),u.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Filter Date Range"})]}),u.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Year"}),u.jsx("input",{type:"number",value:O,onChange:rt=>F(rt.target.value),placeholder:"e.g., 2020",min:"2000",max:Ee,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Year"}),u.jsx("input",{type:"number",value:U,onChange:rt=>B(rt.target.value),placeholder:"e.g., 2025",min:"2000",max:Ee,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]})]}),f&&u.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:u.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:f})}),u.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[u.jsx("button",{onClick:Oe,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply Filter"}),u.jsx("button",{onClick:je,className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Reset"})]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:"Default range: Last 5 years (2021 - 2025)"})]})]})}),ae&&u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),u.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Select Year for Monthly View"})]}),u.jsx("button",{onClick:()=>ee(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter a year to view monthly vehicle registration trends:"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Year"}),u.jsx("input",{type:"number",value:se,onChange:rt=>ce(rt.target.value),placeholder:"e.g., 2025",min:"2000",max:Ee,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",onKeyPress:rt=>{if(rt.key==="Enter"){const Qt=parseInt(se);Qt>=2e3&&Qt<=Ee&&ut(Qt)}}})]}),f&&u.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:u.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:f})}),u.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[u.jsx("button",{onClick:()=>{const rt=parseInt(se);rt>=2e3&&rt<=Ee?ut(rt):i(`Please enter a valid year between 2000 and ${Ee}`)},className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply"}),u.jsx("button",{onClick:()=>ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Cancel"})]}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:["Available years: 2000 - ",Ee]})]})]})}),Ae&&u.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:u.jsxs("div",{className:"bg-gradient-to-br from-white via-gray-50 to-white border border-gray-200/50 rounded-2xl p-8 w-full max-w-[600px] shadow-2xl dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 dark:border-gray-700/50 animate-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:"flex items-center justify-between mb-8",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/10 rounded-xl",children:u.jsxs("svg",{className:"w-7 h-7 text-primary",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),u.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Select Municipality"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter data by location"})]})]}),u.jsx("button",{onClick:()=>_e(!1),className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all duration-200 group",children:u.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4 border border-blue-200/50 dark:border-blue-700/50",children:u.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:" Choose a municipality to view its specific vehicle registration trends"})}),u.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-80 overflow-y-auto scrollbar-hide",children:ke.map((rt,Qt)=>u.jsxs("button",{onClick:()=>ze(rt),className:`group relative p-4 text-left rounded-xl transition-all duration-300 border-2 ${ge===rt?"bg-gradient-to-r from-primary to-primary/80 text-white border-primary shadow-lg shadow-primary/25 transform scale-[1.02]":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:border-primary/50 hover:bg-primary/5 dark:hover:bg-primary/10 hover:shadow-md hover:transform hover:scale-[1.01]"}`,style:{animationDelay:`${Qt*50}ms`},children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${ge===rt?"bg-white":"bg-primary/60 group-hover:bg-primary"}`}),u.jsx("span",{className:"font-medium",children:rt})]}),ge===rt&&u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}),rt==="All"&&u.jsx("p",{className:"text-xs opacity-75 mt-1",children:"View all municipalities combined"})]},rt))}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),u.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Currently selected:"}),u.jsx("span",{className:"text-sm font-semibold text-primary",children:ge})]})})]})]})})]})},X6e=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=H.useState([]),[l,f]=H.useState(!1),[i,_]=H.useState(null),[w,A]=H.useState(!1),[E,O]=H.useState(!1);H.useEffect(()=>{const q=()=>{O(window.innerWidth<640)};return q(),window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[]);const F=async()=>{try{f(!0),_(null);let q=null,W=null;e&&e!=="All"&&(q=vC(e)),t&&t!=="All"&&(W=t);const Z=await W6e(q,W);Z.success?a(Z.data):(_("Failed to fetch owner municipality data"),a([]))}catch(q){console.error("Error fetching owner municipality data:",q),_("Error loading owner municipality data")}finally{f(!1)}};H.useEffect(()=>{F(),A(!1)},[]),H.useEffect(()=>{F(),A(!1)},[e,t]),H.useEffect(()=>{if(n.length>0){const q=setTimeout(()=>A(!0),100);return()=>clearTimeout(q)}},[n]);const U=q=>q.map(W=>({name:W.municipality,withLicense:W.withLicense,withoutLicense:W.withoutLicense,total:W.totalOwners})),B=({active:q,payload:W,label:Z})=>{var ne,ae;if(q&&W&&W.length){const ee=((ne=W.find(ge=>ge.dataKey==="withLicense"))==null?void 0:ne.value)||0,se=((ae=W.find(ge=>ge.dataKey==="withoutLicense"))==null?void 0:ae.value)||0,ce=ee+se;return u.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:Z}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#22c55e"}}),u.jsxs("span",{className:"text-green-600 dark:text-green-400 text-xs",children:[u.jsx("span",{className:"font-semibold",children:ee.toLocaleString()})," With License"]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#3b82f6"}}),u.jsxs("span",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[u.jsx("span",{className:"font-semibold",children:se.toLocaleString()})," Without License"]})]}),u.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 pt-1",children:u.jsxs("span",{className:"text-gray-700 dark:text-gray-300 text-xs font-semibold",children:["Total: ",ce.toLocaleString()]})})]})]})})}return null};return u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsxs("svg",{className:"w-6 h-6 text-purple-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M3 3v18h18"}),u.jsx("path",{d:"M8 9v8"}),u.jsx("path",{d:"M8 12v6"}),u.jsx("path",{d:"M8 15v4"}),u.jsx("path",{d:"M12 9v4"}),u.jsx("path",{d:"M12 12v2"}),u.jsx("path",{d:"M12 15v1"})]})}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[u.jsxs("div",{className:"flex flex-col",children:[u.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Registered Owners by Municipality"}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Vehicle owners with and without driver's licenses by location"})]}),t==="All"&&e&&e!=="All"&&u.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&u.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),u.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[l||r?u.jsx("div",{className:"flex items-center justify-center w-full h-full",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:u.jsx("p",{children:i})}):n.length===0?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:u.jsx("p",{children:"No data available"})}):u.jsx(No,{width:"100%",height:"100%",minHeight:300,children:u.jsxs(_d,{data:U(n),margin:{top:0,right:E?5:10,left:E?5:10,bottom:E?40:30},barCategoryGap:"3%",children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),u.jsx(La,{dataKey:"name",stroke:"#6b7280",fontSize:E?7:9,height:E?35:25,interval:0,angle:-45,textAnchor:"end",tick:{fill:"#6b7280",fontWeight:500},tickFormatter:q=>q.length>10?q.substring(0,10)+"...":q}),u.jsx(za,{stroke:"#6b7280",fontSize:E?10:12,tickFormatter:q=>q.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:E?50:70}),u.jsx(aa,{content:u.jsx(B,{})}),u.jsx(xs,{dataKey:"withLicense",stackId:"owners",name:"With Driver's License",fill:"#22c55e",radius:[0,0,0,0],maxBarSize:E?150:200}),u.jsx(xs,{dataKey:"withoutLicense",stackId:"owners",name:"Without Driver's License",fill:"#3b82f6",radius:[4,4,0,0],maxBarSize:E?150:200})]})}),n.length>0&&u.jsxs("div",{className:"flex justify-center gap-6 mt-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#22c55e"}}),u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"With Driver's License"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#3b82f6"}}),u.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Without Driver's License"})]})]})]})]})},J6e=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=H.useState([]),[l,f]=H.useState(!1),[i,_]=H.useState(null),[w,A]=H.useState(!1),[E,O]=H.useState(!1);H.useEffect(()=>{const Z=()=>{O(window.innerWidth<640)};return Z(),window.addEventListener("resize",Z),()=>window.removeEventListener("resize",Z)},[]);const F=async()=>{try{f(!0),_(null);let Z=null,ne=null;e&&e!=="All"&&(Z=vC(e)),t&&t!=="All"&&(ne=t);const ae=await H6e(Z,ne);if(ae.success&&ae.data){console.log("Raw classification data:",ae.data);const ee=ae.data.filter(se=>se.classification&&se.classification.toUpperCase()==="FOR HRE");ee.length>0?console.warn("Found FOR HRE entries in data:",ee):console.log("No FOR HRE entries found in data - filtering working correctly")}ae.success?a(ae.data):(_("Failed to fetch vehicle classification data"),a([]))}catch(Z){console.error("Error fetching vehicle classification data:",Z),_("Error loading vehicle classification data")}finally{f(!1)}};H.useEffect(()=>{F(),A(!1)},[]),H.useEffect(()=>{F(),A(!1)},[e,t]),H.useEffect(()=>{if(n.length>0){const Z=setTimeout(()=>A(!0),100);return()=>clearTimeout(Z)}},[n]);const U=Z=>{const ne={};Z.forEach(ee=>{if(ee.classification&&ee.classification.toUpperCase()==="FOR HRE"||!["PRIVATE","FOR HIRE","GOVERNMENT"].includes(ee.classification))return;const ce=ee.classification;ce in ne?ne[ce].count+=ee.count:ne[ce]={classification:ce,count:ee.count}});const ae=Object.values(ne).reduce((ee,se)=>ee+se.count,0);return Object.values(ne).map(ee=>({name:ee.classification,value:ee.count,percentage:ae>0?Math.round(ee.count/ae*100):0}))},B=Z=>{switch(Z){case"PRIVATE":return"#3b82f6";case"FOR HIRE":return"#ef4444";case"GOVERNMENT":return"#10b981";default:return"#6b7280"}},q=({active:Z,payload:ne})=>{if(Z&&ne&&ne.length){const ae=ne[0];return u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-3 shadow-lg",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ae.color}}),u.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:ae.name})]}),u.jsxs("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:[ae.value.toLocaleString()," vehicles (",ae.payload.percentage,"%)"]})]})}return null},W=({payload:Z})=>u.jsx("div",{className:"flex flex-col gap-4",children:Z.map((ne,ae)=>{var ee;return u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm",style:{backgroundColor:ne.color,border:`2px solid ${ne.color}20`}}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:ne.value}),u.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[((ee=ne.payload)==null?void 0:ee.percentage)||0,"%"]})]})]},ae)})});return u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-2xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:u.jsxs("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"}),u.jsx("path",{d:"M12 2v10l8 8"})]})}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[u.jsxs("div",{className:"flex flex-col",children:[u.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Vehicle Classification"}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Distribution of vehicles by type (Private, For Hire, Government)"})]}),t==="All"&&e&&e!=="All"&&u.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&u.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),u.jsx("div",{className:"h-80 w-full min-h-[320px] flex-1 relative flex flex-col",children:l||r?u.jsx("div",{className:"flex items-center justify-center w-full h-full",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:u.jsx("p",{children:i})}):n.length===0?u.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:u.jsx("p",{children:"No data available"})}):u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsx("div",{className:"flex-shrink-0 animate-fade-in",children:u.jsx(No,{width:E?200:280,height:E?200:280,children:u.jsxs(Zee,{children:[u.jsx(op,{data:U(n),cx:"50%",cy:"50%",labelLine:!1,outerRadius:E?80:100,innerRadius:E?20:40,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:1800,animationEasing:"ease-out",stroke:"#ffffff",strokeWidth:2,startAngle:90,endAngle:450,children:U(n).map((Z,ne)=>u.jsx(Xf,{fill:B(Z.name),stroke:"#ffffff",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15))",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transformOrigin:"center"},onMouseEnter:ae=>{ae.target.style.filter="drop-shadow(0 4px 8px rgba(0, 0, 0, 0.25)) brightness(1.05)",ae.target.style.transform="scale(1.02)"},onMouseLeave:ae=>{ae.target.style.filter="drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15))",ae.target.style.transform="scale(1)"}},`cell-${Z.name}`))}),u.jsx(aa,{content:u.jsx(q,{}),position:{x:0,y:0},offset:20})]})})}),u.jsx("div",{className:"flex-shrink-0 animate-slide-in-right",children:u.jsx(W,{payload:U(n).map(Z=>({value:Z.name,color:B(Z.name),payload:{percentage:Z.percentage}}))})})]})})})]})},Cg={"CITY OF MATI":{Jan:1200,Feb:1180,Mar:1300,Apr:1250,May:1400,Jun:1500,Jul:1480,Aug:1420,Sep:1350,Oct:1380,Nov:1400,Dec:1520},MANAY:{Jan:800,Feb:780,Mar:900,Apr:860,May:920,Jun:980,Jul:950,Aug:920,Sep:880,Oct:900,Nov:910,Dec:1e3},BAGANGA:{Jan:650,Feb:680,Mar:720,Apr:700,May:750,Jun:780,Jul:760,Aug:740,Sep:720,Oct:730,Nov:740,Dec:800},BANAYBANAY:{Jan:450,Feb:460,Mar:480,Apr:470,May:500,Jun:520,Jul:510,Aug:490,Sep:480,Oct:485,Nov:490,Dec:530},BOSTON:{Jan:320,Feb:330,Mar:350,Apr:340,May:360,Jun:370,Jul:365,Aug:355,Sep:350,Oct:352,Nov:355,Dec:380},CARAGA:{Jan:280,Feb:290,Mar:310,Apr:300,May:320,Jun:330,Jul:325,Aug:315,Sep:310,Oct:312,Nov:315,Dec:340},CATEEL:{Jan:380,Feb:390,Mar:410,Apr:400,May:420,Jun:430,Jul:425,Aug:415,Sep:410,Oct:412,Nov:415,Dec:440},"GOVERNOR GENEROSO":{Jan:520,Feb:530,Mar:550,Apr:540,May:570,Jun:580,Jul:575,Aug:565,Sep:560,Oct:562,Nov:565,Dec:590},LUPON:{Jan:680,Feb:690,Mar:720,Apr:700,May:740,Jun:760,Jul:750,Aug:730,Sep:720,Oct:725,Nov:730,Dec:780},"SAN ISIDRO":{Jan:420,Feb:430,Mar:450,Apr:440,May:460,Jun:470,Jul:465,Aug:455,Sep:450,Oct:452,Nov:455,Dec:480},TARRAGONA:{Jan:350,Feb:360,Mar:380,Apr:370,May:390,Jun:400,Jul:395,Aug:385,Sep:380,Oct:382,Nov:385,Dec:410}},ex=Object.keys(Cg).reduce((e,t)=>{const r=Cg[t],n=Object.values(r).reduce((a,l)=>a+l,0);return e[t]=n,e},{});function Q6e(){const[e,t]=H.useState("monthly"),[r,n]=H.useState(!1),a=H.useRef(null),f=new Date().getFullYear()+1;H.useEffect(()=>{const U=B=>{a.current&&!a.current.contains(B.target)&&n(!1)};return document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[]);const _=(()=>{const U=Object.values(ex).reduce((ae,ee)=>ae+ee,0),B=Object.entries(ex).reduce((ae,[ee,se])=>se>ae.total?{municipality:ee,total:se}:ae,{municipality:"",total:0});let q=0,W="",Z="";return Object.entries(Cg).forEach(([ae,ee])=>{Object.entries(ee).forEach(([se,ce])=>{ce>q&&(q=ce,W=ae,Z=se)})}),{totalPredicted:U,topMunicipalityYear:B,peakMunicipality:W,peakMonth:Z,peakValue:q,fastestGrowth:12.5}})(),A=e==="monthly"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(q=>{const W={month:q};return Object.entries(Cg).forEach(([Z,ne])=>{W[Z]=ne[q]}),W}):Object.entries(ex).map(([U,B])=>({municipality:U,total:B})),E=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F","#EDC948","#B07AA1","#FF9DA7","#9C755F","#BAB0AC","#4E79A7"],O=({active:U,payload:B,label:q})=>{if(U&&B&&B.length){const W=[...B].sort((Z,ne)=>(ne.value||0)-(Z.value||0));return u.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-blue-200 dark:border-blue-700 rounded-lg shadow-lg max-w-xs",children:[u.jsx("p",{className:"text-sm font-bold text-blue-800 dark:text-blue-300 mb-2 text-center",children:e==="monthly"?`${q}`:`${q}`}),u.jsx("div",{className:"space-y-1",children:W.map((Z,ne)=>{var ae;return u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[u.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:Z.color}}),u.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300 truncate",title:Z.dataKey,children:Z.dataKey})]}),u.jsx("span",{className:"text-xs font-medium flex-shrink-0 ml-2",style:{color:Z.color},children:((ae=Z.value)==null?void 0:ae.toLocaleString())||0})]},ne)})})]})}return null},F=U=>{let B="",q="",W="";e==="monthly"?U==="csv"?(B=`Municipality,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
`,Object.entries(Cg).forEach(([ee,se])=>{const ce=[ee,...Object.values(se)].join(",");B+=ce+`
`}),q=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.csv`,W="text/csv"):U==="json"?(B=JSON.stringify(Cg,null,2),q=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.json`,W="application/json"):U==="excel"&&(B=`Municipality,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
`,Object.entries(Cg).forEach(([ee,se])=>{const ce=[ee,...Object.values(se)].join(",");B+=ce+`
`}),q=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.xlsx`,W="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):U==="csv"?(B=`Municipality,Total
`,Object.entries(ex).forEach(([ee,se])=>{B+=`${ee},${se}
`}),q=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.csv`,W="text/csv"):U==="json"?(B=JSON.stringify(ex,null,2),q=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.json`,W="application/json"):U==="excel"&&(B=`Municipality,Total
`,Object.entries(ex).forEach(([ee,se])=>{B+=`${ee},${se}
`}),q=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.xlsx`,W="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const Z=new Blob([B],{type:W}),ne=window.URL.createObjectURL(Z),ae=document.createElement("a");ae.href=ne,ae.download=q,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),window.URL.revokeObjectURL(ne),n(!1)};return u.jsxs("div",{className:"mt-8 bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/30 border border-blue-200 dark:border-blue-800 rounded-xl shadow-lg",children:[u.jsx("div",{className:"p-6 border-b border-blue-200/50 dark:border-blue-700/50",children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Predictive Analytics"}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Uses the SARIMA algorithm to forecast future trends based on historical and current data, providing insights on risks, traffic patterns, and vehicle registrations."}),u.jsxs("div",{className:"mt-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300",children:["Predicting ",f," (Based on the last data available)"]})]})]})})}),u.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 h-full",children:[u.jsx("div",{className:"xl:col-span-2 p-2 sm:p-4",children:u.jsx("div",{className:"space-y-4 sm:space-y-6",children:u.jsxs("div",{className:"relative bg-gradient-to-br from-green-50/80 via-blue-50/60 to-orange-50/40 dark:from-green-900/20 dark:via-blue-900/20 dark:to-orange-900/20 backdrop-blur-sm rounded-xl p-3 sm:p-6 border border-green-200/30 dark:border-green-700/30 shadow-lg overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 opacity-5",children:u.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 400 300",fill:"none",children:[u.jsx("path",{d:"M0,200 L50,150 L100,180 L150,120 L200,160 L250,100 L300,140 L350,80 L400,120 L400,300 L0,300 Z",fill:"#2E7D32"}),u.jsx("path",{d:"M0,250 Q100,220 200,250 T400,250 L400,300 L0,300 Z",fill:"#1565C0"}),u.jsx("circle",{cx:"80",cy:"80",r:"15",fill:"#81C784"}),u.jsx("circle",{cx:"320",cy:"60",r:"12",fill:"#FBC02D"}),u.jsx("circle",{cx:"150",cy:"200",r:"10",fill:"#F57C00"})]})}),u.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[u.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white",children:e==="monthly"?"Monthly Trends":"Yearly Totals"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",style:{pointerEvents:"auto"},children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"View:"}),u.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-600 rounded-md p-0.5",children:[u.jsx("button",{onClick:U=>{U.preventDefault(),U.stopPropagation(),console.log("Monthly button clicked"),t("monthly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${e==="monthly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Monthly"}),u.jsx("button",{onClick:U=>{U.preventDefault(),U.stopPropagation(),console.log("Yearly button clicked"),t("yearly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${e==="yearly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Yearly"})]})]}),u.jsx("div",{className:"flex items-center gap-2 ml-auto relative",children:u.jsxs("div",{className:"relative",ref:a,children:[u.jsxs("button",{onClick:()=>n(!r),className:"px-2 sm:px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded-md transition-colors duration-200 flex items-center gap-1 touch-manipulation",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),u.jsx("span",{className:"hidden sm:inline",children:"Export"}),u.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&u.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:u.jsxs("div",{className:"py-1",children:[u.jsxs("button",{onClick:()=>F("csv"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as CSV"]}),u.jsxs("button",{onClick:()=>F("json"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Export as JSON"]}),u.jsxs("button",{onClick:()=>F("excel"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as Excel"]})]})})]})})]})]}),u.jsx("div",{className:"h-64 sm:h-80 lg:h-96",children:u.jsx(No,{width:"100%",height:"100%",children:e==="monthly"?u.jsxs(ZL,{data:A,margin:{top:20,right:30,left:20,bottom:20},"aria-label":"Monthly registration trends chart",children:[u.jsx(Xs,{strokeDasharray:"2 4",stroke:"#4E79A7",strokeOpacity:.2,vertical:!1}),u.jsx(La,{dataKey:"month",stroke:"#4E79A7",fontSize:10,fontWeight:"500",tick:{fill:"#4E79A7"}}),u.jsx(za,{stroke:"#4E79A7",fontSize:10,fontWeight:"500",tick:{fill:"#4E79A7"},tickFormatter:U=>U.toLocaleString()}),u.jsx(aa,{content:u.jsx(O,{}),cursor:{stroke:"#76B7B2",strokeWidth:1,strokeDasharray:"3 3"}}),u.jsx(Uf,{wrapperStyle:{fontSize:"11px",fontWeight:"500",color:"#4E79A7",paddingTop:"10px"},onClick:U=>{console.log("Legend clicked:",U)}}),Object.keys(Cg).map((U,B)=>u.jsx(Qf,{type:"monotone",dataKey:U,stroke:E[B%E.length],strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",dot:{r:5,fill:E[B%E.length],stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:E[B%E.length],stroke:"#fff",strokeWidth:3,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},name:U,connectNulls:!1},U))]}):u.jsxs(_d,{data:A,margin:{top:20,right:20,left:20,bottom:10},"aria-label":"Yearly registration totals chart",children:[u.jsx(Xs,{strokeDasharray:"2 4",stroke:"#4E79A7",strokeOpacity:.2,vertical:!1}),u.jsx(La,{dataKey:"municipality",stroke:"#4E79A7",fontSize:10,fontWeight:"500",angle:-45,textAnchor:"end",height:120,interval:0,tick:{fontSize:9,fill:"#4E79A7",textAnchor:"end"},tickFormatter:U=>U==="GOVERNOR GENEROSO"?["GOVERNOR","GENEROSO"]:U==="CITY OF MATI"?["CITY OF","MATI"]:U}),u.jsx(za,{stroke:"#4E79A7",fontSize:13,fontWeight:"500",tick:{fill:"#4E79A7"},tickFormatter:U=>U.toLocaleString()}),u.jsx(aa,{content:u.jsx(O,{}),cursor:{fill:"#76B7B2",fillOpacity:.1}}),u.jsx(Uf,{wrapperStyle:{fontSize:"11px",fontWeight:"500",color:"#4E79A7",paddingTop:"10px"}}),u.jsx(xs,{dataKey:"total",fill:"url(#pastelGradient)",name:"Total Registrations",radius:[6,6,0,0],stroke:"#4E79A7",strokeWidth:1}),u.jsx("defs",{children:u.jsxs("linearGradient",{id:"pastelGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[u.jsx("stop",{offset:"0%",stopColor:"#76B7B2"}),u.jsx("stop",{offset:"50%",stopColor:"#4E79A7"}),u.jsx("stop",{offset:"100%",stopColor:"#B07AA1"})]})})]})})})]})})}),u.jsx("div",{className:"xl:col-span-1 p-2 sm:p-4",children:u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-3 sm:gap-4",children:[u.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-blue-100 dark:bg-blue-900/50 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Total Predicted"})]}),u.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:_.totalPredicted.toLocaleString()}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Across Davao Oriental"})]}),u.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-6 h-6 bg-green-100 dark:bg-green-900/50 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),u.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Top Municipality"})]}),u.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:_.topMunicipalityYear.municipality}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[_.topMunicipalityYear.total.toLocaleString()," registrations"]})]}),u.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-6 h-6 bg-purple-100 dark:bg-purple-900/50 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),u.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Peak Month"})]}),u.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:_.peakMunicipality}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[_.peakMonth,": ",_.peakValue.toLocaleString()]})]}),u.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-6 h-6 bg-orange-100 dark:bg-orange-900/50 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-3 h-3 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),u.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Growth Rate"})]}),u.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",_.fastestGrowth,"%"]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Year over Year"})]})]})})]})]})}const Xp=(e,t=2e3)=>{const[r,n]=H.useState(0);return H.useEffect(()=>{let a;const f=i=>{a||(a=i);const _=Math.min((i-a)/t,1),w=1-Math.pow(1-_,4),A=Math.floor(0+(e-0)*w);n(A),_<1&&requestAnimationFrame(f)};requestAnimationFrame(f)},[e,t]),r};function eVe(){var Te,Ae,_e,Ee,ke,Qe,Ze,Ge,Oe,je,Le,ut,ze,ht,rt,Qt,Cr,vr,cr,nr,Kt;const[e,t]=H.useState(""),[r,n]=H.useState(""),[a,l]=H.useState(null),[f,i]=H.useState(!1),[_,w]=H.useState(null),A=Xp(((Te=a==null?void 0:a.vehicles)==null?void 0:Te.total)||0),E=Xp(((Ae=a==null?void 0:a.vehicles)==null?void 0:Ae.active)||0),O=Xp(((_e=a==null?void 0:a.vehicles)==null?void 0:_e.expired)||0),F=Xp(((Ee=a==null?void 0:a.drivers)==null?void 0:Ee.total)||0),U=Xp(((ke=a==null?void 0:a.drivers)==null?void 0:ke.withLicense)||0),B=Xp(((Qe=a==null?void 0:a.drivers)==null?void 0:Qe.withoutLicense)||0),q=Xp(((Ze=a==null?void 0:a.plateClassification)==null?void 0:Ze.total)||0),W=Xp(((Ge=a==null?void 0:a.plateClassification)==null?void 0:Ge.permanent)||0),Z=Xp(((Oe=a==null?void 0:a.plateClassification)==null?void 0:Oe.temporary)||0),ne=["All","January","February","March","April","May","June","July","August","September","October","November","December"],ae=new Date().getFullYear(),ee=["All",...Array.from({length:7},(De,er)=>(ae+er).toString())],se=De=>{t(De)},ce=De=>{n(De)},ge=async(De,er)=>{try{i(!0),w(null);let Lt=null,Rr=null;De&&De!=="All"&&(Lt=vC(De)),er&&er!=="All"&&(Rr=er);const Pt=await V6e(Lt,Rr);Pt.success?l(Pt.data):w("Failed to fetch analytics data")}catch(Lt){console.error("Error fetching analytics data:",Lt),w("Error loading analytics data")}finally{i(!1)}};return H.useEffect(()=>{ge("All","All")},[]),H.useEffect(()=>{e||r?ge(e,r):ge("All","All")},[e,r]),u.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-transparent min-h-screen rounded-lg",children:[u.jsxs("div",{className:"registration-analytics-header",children:[u.jsxs("div",{children:[u.jsxs("h1",{className:"registration-analytics-title animate-in slide-in-from-top-5 fade-in duration-700 flex items-center gap-2",children:[u.jsx(jv,{className:"h-8 w-8 text-blue-500 animate-pulse"}),"Registration Analytics"]}),u.jsx("p",{className:"registration-analytics-subtitle",children:"Vehicle and Owners Registration Analytics"})]}),f?u.jsxs("div",{className:"registration-analytics-controls",children:[u.jsx("div",{className:"animate-pulse",children:u.jsx("div",{className:"h-8 bg-muted rounded w-32"})}),u.jsx("div",{className:"animate-pulse",children:u.jsx("div",{className:"h-8 bg-muted rounded w-32"})})]}):u.jsxs("div",{className:"registration-analytics-controls",children:[u.jsxs(Io,{value:e||"",onValueChange:se,children:[u.jsx(mo,{className:"w-[140px]",children:u.jsx(Do,{placeholder:"Month"})}),u.jsx(go,{children:ne.map(De=>u.jsx(_n,{value:De,children:De},De))})]}),u.jsxs(Io,{value:r||"",onValueChange:ce,children:[u.jsx(mo,{className:"w-[120px]",children:u.jsx(Do,{placeholder:"Year"})}),u.jsx(go,{children:ee.map(De=>u.jsx(_n,{value:De,children:De},De))})]})]})]}),_&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:u.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:_})}),f?u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-card border border-border rounded-lg",children:[u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-24"})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(De=>u.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsx("div",{className:"h-4 bg-muted rounded w-32 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),u.jsx("div",{className:"h-3 bg-muted rounded w-24"})]}),u.jsx("div",{className:"w-12 h-12 bg-muted rounded"})]}),u.jsx("div",{className:"h-1 bg-muted rounded w-full"})]})},De))}),u.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(De=>u.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),u.jsx("div",{className:"h-64 bg-muted rounded"})]})},De))}),u.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-40 mb-4"}),u.jsx("div",{className:"h-96 bg-muted rounded"})]})})]}):u.jsx("div",{className:"registration-analytics-fade-in animate-in slide-in-from-bottom-5 fade-in duration-700",children:u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[u.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-red-300 dark:hover:border-red-600 overflow-hidden",children:[u.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-pink-100 dark:bg-pink-900/30 rounded-full opacity-60"}),u.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-red-200 dark:bg-red-800/40 rounded-full opacity-40"}),u.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-red-400/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),u.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),u.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"REGISTERED VEHICLES"})]}),u.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:f?"...":A})]}),u.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:u.jsxs("svg",{className:"w-6 h-6 text-red-500 group-hover:text-red-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),u.jsx("circle",{cx:"7",cy:"17",r:"2"}),u.jsx("path",{d:"M9 17h6"}),u.jsx("circle",{cx:"17",cy:"17",r:"2"})]})})]}),u.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[u.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[f?"...":E," Active"]}),u.jsx("span",{className:"mx-2",children:""}),u.jsxs("span",{className:"text-red-600 dark:text-red-400 font-medium",children:[f?"...":O," Expired"]})]}),u.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[u.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm animate-pulse",style:{width:`${Math.min((((je=a==null?void 0:a.vehicles)==null?void 0:je.active)||0)/(((Le=a==null?void 0:a.vehicles)==null?void 0:Le.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),u.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-600 h-0.5 transition-all duration-1000 ease-out shadow-sm animate-pulse",style:{width:`${Math.min((((ut=a==null?void 0:a.vehicles)==null?void 0:ut.expired)||0)/(((ze=a==null?void 0:a.vehicles)==null?void 0:ze.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]}),u.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 overflow-hidden",children:[u.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-blue-100 dark:bg-blue-900/30 rounded-full opacity-60"}),u.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-blue-200 dark:bg-blue-800/40 rounded-full opacity-40"}),u.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),u.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),u.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"REGISTERED OWNERS"})]}),u.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:f?"...":F})]}),u.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:u.jsx("svg",{className:"w-6 h-6 text-blue-500 group-hover:text-blue-600 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),u.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[u.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[f?"...":U," With License"]}),u.jsx("span",{className:"mx-2",children:""}),u.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[f?"...":B," Without License"]})]}),u.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[u.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((ht=a==null?void 0:a.drivers)==null?void 0:ht.withLicense)||0)/(((rt=a==null?void 0:a.drivers)==null?void 0:rt.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),u.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Qt=a==null?void 0:a.drivers)==null?void 0:Qt.withoutLicense)||0)/(((Cr=a==null?void 0:a.drivers)==null?void 0:Cr.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]}),u.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-purple-300 dark:hover:border-purple-600 overflow-hidden",children:[u.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-purple-100 dark:bg-purple-900/30 rounded-full opacity-60"}),u.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-purple-200 dark:bg-purple-800/40 rounded-full opacity-40"}),u.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-purple-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),u.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),u.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"PLATE CLASSIFICATION"})]}),u.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:f?"...":q})]}),u.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:u.jsxs("svg",{className:"w-6 h-6 text-purple-500 group-hover:text-purple-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[u.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2",ry:"2"}),u.jsx("rect",{x:"4",y:"8",width:"16",height:"8",rx:"1",ry:"1"}),u.jsx("path",{d:"M8 10h2"}),u.jsx("path",{d:"M12 10h2"}),u.jsx("path",{d:"M16 10h2"}),u.jsx("path",{d:"M8 12h2"}),u.jsx("path",{d:"M12 12h2"}),u.jsx("path",{d:"M16 12h2"})]})})]}),u.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[u.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[f?"...":W," Permanent"]}),u.jsx("span",{className:"mx-2",children:""}),u.jsxs("span",{className:"text-purple-400 dark:text-purple-400 font-medium",children:[f?"...":Z," Temporary"]})]}),u.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[u.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((vr=a==null?void 0:a.plateClassification)==null?void 0:vr.permanent)||0)/(((cr=a==null?void 0:a.plateClassification)==null?void 0:cr.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),u.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((nr=a==null?void 0:a.plateClassification)==null?void 0:nr.temporary)||0)/(((Kt=a==null?void 0:a.plateClassification)==null?void 0:Kt.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]})]}),u.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-6",children:[u.jsx("div",{className:"flex-1 lg:flex-1",children:u.jsx(Z6e,{selectedMonth:e,selectedYear:r,loading:f})}),u.jsx("div",{className:"flex-1 lg:flex-1",children:u.jsx(Y6e,{})})]}),u.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[u.jsx("div",{className:"flex-1 lg:flex-1",children:u.jsx(J6e,{selectedMonth:e,selectedYear:r,loading:f})}),u.jsx("div",{className:"flex-1 lg:flex-1",children:u.jsx(X6e,{selectedMonth:e,selectedYear:r,loading:f})})]})]})}),u.jsx(Q6e,{})]})}function tVe(){return u.jsx("div",{children:u.jsx(eVe,{})})}const rVe=async(e={},t=null)=>{try{const r=new URLSearchParams;t&&r.append("year",t),e&&typeof e=="object"&&Object.keys(e).forEach(f=>{e[f]!==null&&e[f]!==void 0&&r.append(f,e[f])});const n=r.toString(),a=`/violations/analytics${n?`?${n}`:""}`;return(await Wn.get(a)).data}catch(r){throw console.error("Error fetching violation analytics:",r),r}};function nVe({displayData:e,loading:t,totalViolations:r,totalTrafficViolators:n,topOfficer:a,mostCommonViolation:l}){return t?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((f,i)=>u.jsx("div",{className:"bg-card border border-border rounded-xl p-6 animate-pulse",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"h-4 bg-muted rounded mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded mb-1"}),u.jsx("div",{className:"h-3 bg-muted rounded"})]}),u.jsx("div",{className:"ml-4",children:u.jsx("div",{className:"w-12 h-12 bg-muted rounded-full"})})]})},i))}):u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[u.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-blue-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-blue-500/10 to-blue-600/5 rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),u.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Total Violations"})]}),u.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:r.toLocaleString()}),u.jsx("p",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"All time recorded violations"}),u.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full shadow-sm transition-all duration-500",style:{width:"85%"}})})]}),u.jsx("div",{className:"ml-3",children:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})})]})]}),u.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-green-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-green-500/10 to-green-600/5 rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),u.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Traffic Violators"})]}),u.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:n.toLocaleString()}),u.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"People"}),u.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-600 rounded-full shadow-sm transition-all duration-500",style:{width:"70%"}})})]}),u.jsx("div",{className:"ml-3",children:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]})]}),u.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-red-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-red-500/10 to-red-600/5 rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),u.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Most Common Violation"})]}),u.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1 truncate",title:(l==null?void 0:l._id)||"N/A",children:(l==null?void 0:l._id)||"N/A"}),u.jsxs("p",{className:"text-xs font-medium text-red-600 dark:text-red-400",children:[(l==null?void 0:l.count)||0," occurrences"]}),u.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 to-red-600 rounded-full shadow-sm transition-all duration-500",style:{width:"60%"}})})]}),u.jsx("div",{className:"ml-3",children:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})})]})]}),u.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-purple-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-purple-500/10 to-purple-600/5 rounded-full -translate-y-4 translate-x-4"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[u.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),u.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Top Officer"})]}),u.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white truncate mb-1",children:(a==null?void 0:a.officerName)||"N/A"}),u.jsxs("p",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:[(a==null?void 0:a.violationCount)||0," apprehensions"]}),u.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1 overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 rounded-full shadow-sm transition-all duration-500",style:{width:"75%"}})})]}),u.jsx("div",{className:"ml-3",children:u.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})})]})]})]})}function iVe({data:e,title:t,type:r,loading:n,totalCount:a}){const[l,f]=H.useState(null),[i,_]=H.useState({}),w=H.useRef(null);if(H.useEffect(()=>{const U=setTimeout(()=>{e==null||e.slice(0,5).forEach((B,q)=>{setTimeout(()=>{_(W=>({...W,[q]:!0}))},q*200)})},100);return()=>clearTimeout(U)},[e]),n)return u.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 h-full flex flex-col",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded"}),u.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),u.jsx("div",{className:"space-y-4",children:[...Array(5)].map((U,B)=>u.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-xl",children:[u.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[u.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"}),u.jsx("div",{className:"h-3 w-24 bg-gray-200 dark:bg-gray-700 rounded"})]}),u.jsx("div",{className:"w-16 h-8 bg-gray-200 dark:bg-gray-700 rounded"})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"})]},B))})]})});if(!e||e.length===0)return u.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:u.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:t}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Performance Analytics"})]})]}),u.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400 flex-1 flex flex-col justify-center",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center shadow-lg",children:u.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsx("h4",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"No Data Available"}),u.jsxs("p",{className:"text-sm",children:["No ",r==="officers"?"officer":"violation"," data to display"]})]})]});const A=Math.max(...e.map(U=>U.count||U.violationCount||0)),E=e.slice(0,5),O=U=>U+1,F=U=>"bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700";return u.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg p-4 hover:shadow-xl transition-all duration-300 h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-500 rounded-lg flex items-center justify-center shadow-md",children:u.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Performance Rankings"})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-xs font-bold text-gray-500 dark:text-gray-400",children:"Total Officers"}),u.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-purple-600 to-pink-500 bg-clip-text text-transparent",children:a||E.length})]})]}),u.jsx("div",{ref:w,className:"space-y-3 flex-1",children:E.map((U,B)=>{const q=U.count||U.violationCount||0,W=A>0?q/A*100:0,Z=r==="officers"?U.officerName||"Unknown Officer":U._id||"Unknown Item",ne=l===B,ae=i[B];return u.jsx("div",{className:`relative p-3 border rounded-lg transition-all duration-300 ${F()} ${ne?"shadow-lg border-blue-300 dark:border-blue-600":"shadow-sm"}`,onMouseEnter:()=>f(B),onMouseLeave:()=>f(null),children:u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[u.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-gradient-to-br from-purple-500 to-pink-500 rounded flex items-center justify-center shadow-md",children:u.jsx("span",{className:"text-sm font-bold text-white",children:O(B)})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-xs font-bold text-gray-900 dark:text-white truncate",children:Z}),u.jsx("p",{className:"text-xs text-purple-600 dark:text-purple-400",children:r==="officers"?"Officer":"Type"})]})]}),u.jsxs("div",{className:"text-right ml-2",children:[u.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-white",children:q.toLocaleString()}),u.jsx("div",{className:"text-xs font-bold bg-gradient-to-r from-pink-500 to-purple-600 bg-clip-text text-transparent",children:r==="officers"?"apprehensions":"violations"})]})]}),u.jsx("div",{className:"relative",children:u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 border border-gray-300 dark:border-gray-600 shadow-inner",children:u.jsx("div",{className:`h-2 rounded-full bg-gradient-to-r from-purple-600 to-pink-500 transition-all duration-1000 ease-out ${ae?"animate-pulse":""}`,style:{width:ae?`${W}%`:"0%",transitionDelay:`${B*200}ms`}})})}),u.jsx("div",{className:"flex justify-end items-center mt-1",children:u.jsxs("span",{className:"text-xs text-purple-600 dark:text-purple-400",children:[(q/E.reduce((ee,se)=>ee+(se.count||se.violationCount||0),0)*100).toFixed(1),"% of total"]})})]})},B)})}),E.length<5&&u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-full",children:[u.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-pulse"}),u.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:["Only ",E.length," ",r==="officers"?"officers":"items"," available"]})]})})]})}function aVe({data:e,title:t,loading:r}){const[n,a]=H.useState(null),[l,f]=H.useState([]);if(r)return u.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),u.jsx("div",{className:"flex items-center justify-center",children:u.jsx("div",{className:"w-48 h-48 bg-gray-200 dark:bg-gray-700 rounded-full"})}),u.jsx("div",{className:"mt-6 space-y-3",children:[...Array(5)].map((W,Z)=>u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),u.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),u.jsx("div",{className:"w-12 h-4 bg-gray-200 dark:bg-gray-700 rounded"})]},Z))})]})});if(!e||e.length===0)return u.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t}),u.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),u.jsx("p",{children:"No data available"})]})]});const i=e.reduce((W,Z)=>W+(Z.count||0),0),_=e.slice(0,5);let w=0;const A=_.map((W,Z)=>{const ne=W.count||0,ae=i>0?ne/i*100:0,ee=w,se=w+ae/100*360;return w=se,{...W,percentage:ae,startAngle:ee,endAngle:se,index:Z}}),E=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],O=["url(#gradient1)","url(#gradient2)","url(#gradient3)","url(#gradient4)","url(#gradient5)"],F=W=>E[W]||"#6B7280",U=W=>O[W]||E[W]||"#6B7280";H.useEffect(()=>{const W=setTimeout(()=>{f(A)},100);return()=>clearTimeout(W)},[A]);const B=(W,Z,ne=80)=>{const se=q(100,100,ne,Z),ce=q(100,100,ne,W),ge=Z-W<=180?"0":"1";return["M",100,100,"L",se.x,se.y,"A",ne,ne,0,ge,0,ce.x,ce.y,"Z"].join(" ")},q=(W,Z,ne,ae)=>{const ee=(ae-90)*Math.PI/180;return{x:W+ne*Math.cos(ee),y:Z+ne*Math.sin(ee)}};return u.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-400/10 to-purple-500/10 rounded-full -translate-y-16 translate-x-16"}),u.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-green-300/10 to-teal-400/10 rounded-full translate-y-12 -translate-x-12"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-md mr-3",children:u.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),t]}),u.jsxs("div",{className:"flex flex-col lg:flex-row items-center space-y-6 lg:space-y-0 lg:space-x-6",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsxs("svg",{width:"220",height:"220",viewBox:"0 0 200 200",className:"mx-auto drop-shadow-lg",children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"gradient1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#3B82F6"}),u.jsx("stop",{offset:"100%",stopColor:"#1D4ED8"})]}),u.jsxs("linearGradient",{id:"gradient2",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#10B981"}),u.jsx("stop",{offset:"100%",stopColor:"#047857"})]}),u.jsxs("linearGradient",{id:"gradient3",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#F59E0B"}),u.jsx("stop",{offset:"100%",stopColor:"#D97706"})]}),u.jsxs("linearGradient",{id:"gradient4",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#EF4444"}),u.jsx("stop",{offset:"100%",stopColor:"#DC2626"})]}),u.jsxs("linearGradient",{id:"gradient5",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#8B5CF6"}),u.jsx("stop",{offset:"100%",stopColor:"#7C3AED"})]})]}),l.map((W,Z)=>u.jsx("path",{d:B(W.startAngle,W.endAngle),fill:U(Z),stroke:"white",strokeWidth:"3",className:`transition-all duration-300 cursor-pointer ${n===Z?"opacity-90 transform scale-1.05":"opacity-100 hover:opacity-90"}`,onMouseEnter:()=>a(Z),onMouseLeave:()=>a(null),style:{filter:n===Z?"drop-shadow(0 4px 8px rgba(0,0,0,0.2))":"none"}},Z)),u.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"white",className:"dark:fill-black drop-shadow-md"}),u.jsx("circle",{cx:"100",cy:"100",r:"40",fill:"url(#centerGradient)",className:"drop-shadow-sm"}),u.jsx("defs",{children:u.jsxs("radialGradient",{id:"centerGradient",cx:"50%",cy:"50%",r:"50%",children:[u.jsx("stop",{offset:"0%",stopColor:"#F8FAFC"}),u.jsx("stop",{offset:"100%",stopColor:"#E2E8F0"})]})}),u.jsx("text",{x:"100",y:"95",textAnchor:"middle",className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Total"}),u.jsx("text",{x:"100",y:"110",textAnchor:"middle",className:"text-xl font-black text-gray-900 dark:text-white",children:i.toLocaleString()})]})}),u.jsx("div",{className:"flex-1 space-y-3",children:A.map((W,Z)=>{var ne;return u.jsxs("div",{className:`flex items-center justify-between p-4 border-2 rounded-xl transition-all duration-300 cursor-pointer ${n===Z?"border-blue-300 dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20 shadow-lg transform scale-105":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-800"}`,onMouseEnter:()=>a(Z),onMouseLeave:()=>a(null),children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"w-6 h-6 rounded-full shadow-md",style:{backgroundColor:F(Z)}}),n===Z&&u.jsx("div",{className:"absolute inset-0 w-6 h-6 rounded-full animate-ping opacity-75",style:{backgroundColor:F(Z)}})]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white truncate",children:W._id||"Unknown"}),u.jsxs("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:[W.percentage.toFixed(1),"% of total"]})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-lg font-black text-gray-900 dark:text-white",children:((ne=W.count)==null?void 0:ne.toLocaleString())||0}),u.jsx("div",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",children:"violations"})]})]},Z)})})]}),_.length<5&&u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:[u.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Only ",_.length," violation types available"]})]})})]})]})}function sVe({displayData:e,loading:t,currentViolations:r,startIndex:n,endIndex:a,totalViolationItems:l,currentPage:f,totalPages:i,handlePrevPage:_,handleNextPage:w}){return t?u.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),u.jsx("div",{className:"space-y-3",children:[...Array(5)].map((A,E)=>u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-8 h-8 bg-muted rounded"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-muted rounded"}),u.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]}),u.jsx("div",{className:"w-16 h-6 bg-muted rounded"})]},E))})]})}):u.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-900 to-violet-600 rounded-lg flex items-center justify-center shadow-md",children:u.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})}),u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Top Violations Ranking"})]}),r.length>0?u.jsx("div",{className:"space-y-3 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:r.map((A,E)=>{const O=n+E+1,F=B=>"bg-gradient-to-br from-blue-900 to-violet-600 text-white shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",U=B=>B;return u.jsxs("div",{className:"flex items-center space-x-4 p-3 border-2 border-gray-300 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-lg transition-all duration-300 bg-white dark:bg-gray-900 group",children:[u.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${F()}`,children:U(O)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors duration-300",children:A._id||"Unknown Violation"}),u.jsxs("p",{className:"text-xs bg-gradient-to-r from-blue-900 to-violet-600 bg-clip-text text-transparent font-medium group-hover:from-blue-700 group-hover:to-violet-500 transition-all duration-300",children:[A.count||0," occurrences"]}),u.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-purple-400 to-pink-400 rounded-full shadow-sm transition-all duration-500 group-hover:shadow-md",style:{width:`${Math.min((A.count||0)/Math.max(...r.map(B=>B.count||0))*100,100)}%`}})})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors duration-300",children:A.count||0}),u.jsx("div",{className:"text-xs bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-transparent font-medium group-hover:from-violet-500 group-hover:to-purple-500 transition-all duration-300",children:"violations"})]})]},A._id||E)})}):u.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),u.jsx("p",{children:"No violation data available"})]}),r.length>0&&i>1&&u.jsx("div",{className:"mt-6 pt-4 border-t-2 border-gray-300 dark:border-gray-600",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Showing ",n+1," to ",Math.min(a,l)," of ",l," violations"]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Page ",f," of ",i]}),u.jsxs("div",{className:"flex space-x-2",children:[u.jsxs("button",{onClick:_,disabled:f===1,className:"px-3 py-1.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-900 to-violet-600 hover:from-blue-800 hover:to-violet-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),u.jsx("span",{children:"Previous"})]}),u.jsxs("button",{onClick:w,disabled:f===i,className:"px-3 py-1.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-900 to-violet-600 hover:from-blue-800 hover:to-violet-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[u.jsx("span",{children:"Next"}),u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})})]})}function oVe({displayData:e,loading:t,getCombinationRecommendation:r}){if(t)return u.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),u.jsx("div",{className:"space-y-4",children:[...Array(3)].map((l,f)=>u.jsx("div",{className:"border border-gray-200 dark:border-gray-800 rounded-lg p-4",children:u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),u.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})},f))})]})});const n=(e==null?void 0:e.violationCombinations)||[],a=(e==null?void 0:e.violationPatterns)||[];return u.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg shadow-md p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Violation Combinations & Recommendations"}),n.length>0||a.length>0?u.jsxs("div",{className:"space-y-4",children:[n.slice(0,5).map((l,f)=>{const i=l.violations||[],_=l.count||0,w=r(i);return u.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[u.jsx("div",{className:"flex items-start justify-between mb-2",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:i.map((A,E)=>u.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-400",children:A},E))}),u.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[_," occurrence",_!==1?"s":""]})]})}),u.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/10 border-l-4 border-yellow-400 rounded-r",children:[u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-300 font-medium",children:"Recommended Action:"}),u.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mt-1",children:w})]})]},f)}),a.slice(0,3).map((l,f)=>{const i=l.pattern||"Unknown Pattern",_=l.frequency||0,w=l.description||"No description available";return u.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[u.jsx("div",{className:"flex items-start justify-between mb-2",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:i}),u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:w}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Frequency: ",_," cases"]})]})}),u.jsxs("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/10 border-l-4 border-blue-400 rounded-r",children:[u.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-300 font-medium",children:"Pattern Analysis:"}),u.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400 mt-1",children:"This pattern indicates recurring violation behaviors that may require targeted enforcement strategies."})]})]},`pattern-${f}`)}),(n.length>5||a.length>3)&&u.jsx("div",{className:"text-center pt-4",children:u.jsx("button",{className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"View All Combinations "})})]}):u.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsx("p",{children:"No violation combination data available"})]})]})}function lVe({displayData:e,loading:t,setIsLineChartModalOpen:r,currentViolations:n,startIndex:a,endIndex:l,totalViolationItems:f,currentPage:i,totalPages:_,handlePrevPage:w,handleNextPage:A,getCombinationRecommendation:E}){var se,ce,ge,Te,Ae,_e,Ee,ke,Qe,Ze;const[O,F]=H.useState(null),[U,B]=H.useState({x:0,y:0}),[q,W]=H.useState(!1),Z=H.useRef(null);if(t)return u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[u.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),u.jsx("div",{className:"h-64 bg-muted rounded"})]})}),u.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),u.jsx("div",{className:"h-64 bg-muted rounded"})]})})]});const ne=(e==null?void 0:e.violationsByType)||[];ne.reduce((Ge,Oe)=>Ge+(Oe.count||0),0);const ee=((e==null?void 0:e.yearlyTrends)||[]).filter(Ge=>{var je;const Oe=((je=Ge._id)==null?void 0:je.year)||0;return Oe>=2020&&Oe<=2025});return Math.max(...ee.map(Ge=>Ge.count||0),1),u.jsxs("div",{className:"space-y-6 mb-8",children:[u.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300",children:u.jsx("div",{className:"relative",children:ee.length>0?u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-lg",children:u.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Violation Trends Analysis"}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Historical data from 2020-2025"})]})]}),ee.length>5&&u.jsxs("button",{onClick:()=>r(!0),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[u.jsx("span",{className:"text-sm font-medium",children:"View More"}),u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]}),u.jsxs("div",{className:"flex gap-6",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"relative bg-white dark:bg-black rounded-xl shadow-lg border border-gray-100 dark:border-gray-800 overflow-hidden",children:[u.jsx("svg",{ref:Z,width:"100%",height:"350",className:"relative",onMouseLeave:()=>{W(!1),F(null)},children:(()=>{const Ge=ee.sort((Br,et)=>{var bt,zt;return(((bt=Br._id)==null?void 0:bt.year)||0)-(((zt=et._id)==null?void 0:zt.year)||0)});if(Ge.length===0)return null;const Oe=800,je=350,Le=80,ut=Oe-Le*2,ze=je-Le*2,ht=Ge.map(Br=>{var et;return((et=Br._id)==null?void 0:et.year)||0}),rt=Ge.map(Br=>Br.count||0),Qt=Math.min(...ht),vr=Math.max(...ht)-Qt||1,cr=Math.min(...rt),nr=Math.max(...rt),De=(nr-cr||1)*.1,er=Math.max(0,cr-De),Rr=nr+De-er,Pt=Ge.map((Br,et)=>{var pr;const bt=((pr=Br._id)==null?void 0:pr.year)||0,zt=Br.count||0,xr=Le+(bt-Qt)/vr*ut,fr=Le+ze-(zt-er)/Rr*ze;return{x:xr,y:fr,year:bt,count:zt}}),nn=Pt.reduce((Br,et,bt)=>bt===0?`M ${et.x} ${Le+ze} L ${et.x} ${et.y}`:`${Br} L ${et.x} ${et.y}`,"")+` L ${Pt[Pt.length-1].x} ${Le+ze} Z`,Sn=Pt.reduce((Br,et,bt)=>{if(bt===0)return`M ${et.x} ${et.y}`;const zt=Pt[bt-1],xr=zt.x+(et.x-zt.x)/3,fr=zt.y,pr=et.x-(et.x-zt.x)/3,ar=et.y;return`${Br} C ${xr} ${fr} ${pr} ${ar} ${et.x} ${et.y}`},"");return u.jsxs("g",{children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"areaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),u.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.05"})]}),u.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[u.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),u.jsx("stop",{offset:"50%",stopColor:"#3b82f6"}),u.jsx("stop",{offset:"100%",stopColor:"#06b6d4"})]}),u.jsxs("filter",{id:"glow",children:[u.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),u.jsxs("feMerge",{children:[u.jsx("feMergeNode",{in:"coloredBlur"}),u.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),[0,.25,.5,.75,1].map((Br,et)=>{const bt=Le+ze-Br*ze;return u.jsx("line",{x1:Le,y1:bt,x2:Le+ut,y2:bt,stroke:"#e5e7eb",strokeWidth:1,strokeDasharray:"2,2",opacity:"0.6",children:u.jsx("animate",{attributeName:"opacity",values:"0;0.6;0",dur:"2s",begin:`${et*.2}s`,repeatCount:"1"})},et)}),u.jsx("path",{d:nn,fill:"url(#areaGradient)"}),u.jsx("path",{d:Sn,fill:"none",stroke:"url(#lineGradient)",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow)",children:u.jsx("animate",{attributeName:"stroke-dasharray",values:"0,1000;1000,0",dur:"2s",repeatCount:"1"})}),Pt.map((Br,et)=>{const bt=O===et;return u.jsxs("g",{children:[u.jsx("circle",{cx:Br.x,cy:Br.y,r:15,fill:"transparent",onMouseEnter:zt=>{F(et),W(!0);const xr=Z.current.getBoundingClientRect(),fr=200,pr=100;let ar=zt.clientX-xr.left,tn=zt.clientY-xr.top;const Xn=fr/2;ar<Xn+20?ar=Xn+20:ar>xr.width-Xn-20&&(ar=xr.width-Xn-20),tn=tn+30,tn+pr>xr.height-20&&(tn=zt.clientY-xr.top-pr-10),B({x:ar,y:tn})},onMouseMove:zt=>{const xr=Z.current.getBoundingClientRect(),fr=200,pr=100;let ar=zt.clientX-xr.left,tn=zt.clientY-xr.top;const Xn=fr/2;ar<Xn+20?ar=Xn+20:ar>xr.width-Xn-20&&(ar=xr.width-Xn-20),tn=tn+30,tn+pr>xr.height-20&&(tn=zt.clientY-xr.top-pr-10),B({x:ar,y:tn})},style:{cursor:"pointer"}}),u.jsx("circle",{cx:Br.x,cy:Br.y,r:bt?12:8,fill:"none",stroke:bt?"#3b82f6":"#e5e7eb",strokeWidth:bt?3:2,opacity:bt?.3:.6,children:u.jsx("animate",{attributeName:"r",values:bt?"8;12;8":"8",dur:bt?"1s":"0s",repeatCount:bt?"indefinite":"1"})}),u.jsx("circle",{cx:Br.x,cy:Br.y,r:bt?8:6,fill:"#3b82f6",stroke:"white",strokeWidth:3,className:"drop-shadow-lg",children:u.jsx("animate",{attributeName:"r",values:"6;8;6",dur:"2s",begin:`${et*.1}s`,repeatCount:"1"})}),u.jsx("circle",{cx:Br.x,cy:Br.y,r:bt?4:3,fill:"#60a5fa",opacity:"0.8"})]},Br.year)}),Pt.map((Br,et)=>u.jsxs("g",{children:[u.jsx("text",{x:Br.x,y:Le+ze+25,textAnchor:"middle",className:"text-sm font-medium fill-gray-600 dark:fill-gray-300",children:Br.year}),u.jsx("line",{x1:Br.x,y1:Le+ze,x2:Br.x,y2:Le+ze+5,stroke:"#6b7280",strokeWidth:1})]},Br.year)),[0,.25,.5,.75,1].map((Br,et)=>{const bt=Le+ze-Br*ze,zt=Math.round(er+Rr*Br);return u.jsxs("g",{children:[u.jsx("text",{x:Le-15,y:bt+4,textAnchor:"end",className:"text-sm font-medium fill-gray-600 dark:fill-gray-300",children:zt.toLocaleString()}),u.jsx("line",{x1:Le-5,y1:bt,x2:Le,y2:bt,stroke:"#6b7280",strokeWidth:1,opacity:"0.5"})]},et)}),u.jsx("text",{x:Oe/2,y:25,textAnchor:"middle",className:"text-lg font-bold fill-gray-800 dark:fill-gray-200",children:"Violation Trends Over Time"}),u.jsx("text",{x:Le-50,y:je/2,textAnchor:"middle",transform:`rotate(-90, ${Le-50}, ${je/2})`,className:"text-sm font-medium fill-gray-600 dark:fill-gray-400",children:"Number of Violations"})]})})()}),q&&O!==null&&u.jsxs("div",{className:"absolute bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 rounded-xl shadow-2xl p-4 z-50 pointer-events-none backdrop-blur-sm min-w-[200px]",style:{left:U.x-100,top:U.y,maxWidth:"250px",position:"absolute"},children:[u.jsx("div",{className:"absolute w-3 h-3 bg-white dark:bg-gray-800 border-l-2 border-t-2 border-gray-200 dark:border-gray-600 transform rotate-45",style:{left:"50%",top:"-6px",transform:"translateX(-50%) rotate(45deg)"}}),u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),u.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:((ce=(se=ee[O])==null?void 0:se._id)==null?void 0:ce.year)||"N/A"})]}),u.jsxs("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:[(((ge=ee[O])==null?void 0:ge.count)||0).toLocaleString()," violations"]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:O>0&&u.jsxs("span",{className:(((Te=ee[O])==null?void 0:Te.count)||0)>(((Ae=ee[O-1])==null?void 0:Ae.count)||0)?"text-red-500":"text-green-500",children:[(((_e=ee[O])==null?void 0:_e.count)||0)>(((Ee=ee[O-1])==null?void 0:Ee.count)||0)?"":"",Math.abs((((ke=ee[O])==null?void 0:ke.count)||0)-(((Qe=ee[O-1])==null?void 0:Qe.count)||0)).toLocaleString()," from previous year"]})})]})]})}),u.jsxs("div",{className:"w-60 space-y-4",children:[u.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700 p-2 rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 bg-blue-500/10 dark:bg-blue-400/10 rounded-full -translate-y-4 translate-x-4"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:"flex items-center mb-0.5",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mr-1.5 animate-pulse"}),u.jsx("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300 uppercase tracking-wide",children:"Timeline"})]}),u.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100 mb-0.5",children:ee.length}),u.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Years Covered"}),u.jsx("div",{className:"mt-1 flex space-x-0.5",children:[...Array(6)].map((Ge,Oe)=>u.jsx("div",{className:"w-1 h-1 bg-blue-400 dark:bg-blue-500 rounded-full opacity-60"},Oe))})]})]}),u.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-red-50 to-pink-100 dark:from-red-900/20 dark:to-pink-900/20 border border-red-200 dark:border-red-700 p-2 rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"absolute top-0 right-0 w-10 h-10 bg-red-500/10 dark:bg-red-400/10 rounded-full -translate-y-3 translate-x-3"}),u.jsx("div",{className:"absolute top-0.5 right-0.5 w-1.5 h-1.5 bg-red-500 rounded-full animate-ping"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:"flex items-center mb-0.5",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),u.jsx("div",{className:"text-xs font-medium text-red-700 dark:text-red-300 uppercase tracking-wide",children:"Critical"})]}),u.jsx("div",{className:"text-xl font-bold text-red-900 dark:text-red-100 mb-0.5",children:ee.reduce((Ge,Oe)=>Ge+(Oe.count||0),0).toLocaleString()}),u.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Total Violations"}),u.jsxs("div",{className:"mt-1 flex items-center",children:[u.jsx("div",{className:"w-4 h-0.5 bg-red-300 dark:bg-red-600 rounded-full mr-1.5"}),u.jsx("div",{className:"text-xs text-red-500 dark:text-red-400",children:"High Volume"})]})]})]}),u.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-green-50 to-emerald-100 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-700 p-2 rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 bg-green-500/10 dark:bg-green-400/10 rounded-full -translate-y-4 translate-x-4"}),u.jsx("div",{className:"absolute top-0.5 right-0.5 w-1.5 h-1.5 bg-green-400 rounded-full animate-bounce"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:"flex items-center mb-0.5",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mr-1.5"}),u.jsx("div",{className:"text-xs font-medium text-green-700 dark:text-green-300 uppercase tracking-wide",children:"Analytics"})]}),u.jsx("div",{className:"text-xl font-bold text-green-900 dark:text-green-100 mb-0.5",children:ee.length>0?Math.round(ee.reduce((Ge,Oe)=>Ge+(Oe.count||0),0)/ee.length).toLocaleString():0}),u.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Average per Year"}),u.jsxs("div",{className:"mt-1 flex items-center space-x-0.5",children:[u.jsx("div",{className:"w-0.5 h-1.5 bg-green-400 dark:bg-green-500 rounded-full"}),u.jsx("div",{className:"w-0.5 h-2 bg-green-500 dark:bg-green-400 rounded-full"}),u.jsx("div",{className:"w-0.5 h-1 bg-green-400 dark:bg-green-500 rounded-full"}),u.jsx("div",{className:"w-0.5 h-2.5 bg-green-500 dark:bg-green-400 rounded-full"}),u.jsx("div",{className:"w-0.5 h-1.5 bg-green-400 dark:bg-green-500 rounded-full"})]})]})]})]})]})]}):u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No data available for 2020-2025"})})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8",children:[u.jsxs("div",{className:"lg:col-span-2 flex flex-col space-y-4 h-full",children:[u.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-black dark:to-black border-2 border-blue-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl hover:scale-[1.02] transition-all duration-300 flex-1 relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-400/20 to-indigo-500/20 rounded-full -translate-y-16 translate-x-16"}),u.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-blue-300/20 to-indigo-400/20 rounded-full translate-y-12 -translate-x-12"}),u.jsxs("div",{className:"flex items-center justify-between h-full relative z-10",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg ring-4 ring-blue-200/50 dark:ring-blue-800/50",children:u.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:"Traffic Violations"}),u.jsx("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Distinct kinds of violation"})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-3xl font-black bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent drop-shadow-sm",children:((Ze=e==null?void 0:e.mostCommonViolations)==null?void 0:Ze.length)||0}),u.jsx("div",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400 mt-1",children:"Types"})]})]})]}),u.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-100 dark:from-black dark:to-black border-2 border-emerald-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl hover:scale-[1.02] transition-all duration-300 flex-1 relative overflow-hidden",children:[u.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-emerald-400/20 to-teal-500/20 rounded-full -translate-y-16 translate-x-16"}),u.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-emerald-300/20 to-teal-400/20 rounded-full translate-y-12 -translate-x-12"}),u.jsxs("div",{className:"flex items-center justify-between h-full relative z-10",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center shadow-lg ring-4 ring-emerald-200/50 dark:ring-emerald-800/50",children:u.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-emerald-900 dark:text-emerald-100",children:"Apprehending Officers"}),u.jsx("p",{className:"text-sm font-medium text-emerald-700 dark:text-emerald-300",children:"Active officers"})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-3xl font-black bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent drop-shadow-sm",children:(e==null?void 0:e.totalOfficers)||0}),u.jsx("div",{className:"text-xs font-semibold text-emerald-600 dark:text-emerald-400 mt-1",children:"Officers"})]})]})]})]}),u.jsx("div",{className:"lg:col-span-2",children:u.jsx(aVe,{data:ne,title:"Violation Types Distribution",loading:t})})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[u.jsx("div",{className:"lg:col-span-1",children:u.jsx(iVe,{data:(e==null?void 0:e.topOfficers)||[],title:"Apprehending Officers",type:"officers",loading:t,totalCount:(e==null?void 0:e.totalOfficers)||0})}),u.jsx("div",{className:"lg:col-span-1",children:u.jsx(sVe,{displayData:e,loading:t,currentViolations:n,startIndex:a,endIndex:l,totalViolationItems:f,currentPage:i,totalPages:_,handlePrevPage:w,handleNextPage:A})})]}),u.jsx("div",{className:"mb-8",children:u.jsx(oVe,{displayData:e,loading:t,getCombinationRecommendation:E})})]})}function cVe({isLineChartModalOpen:e,setIsLineChartModalOpen:t,selectedYearRange:r,setSelectedYearRange:n,filteredYearlyData:a,loading:l}){var W,Z,ne,ae,ee,se,ce,ge,Te;const[f,i]=H.useState(null),[_,w]=H.useState({x:0,y:0}),[A,E]=H.useState(!1),O=H.useRef(null);if(!e)return null;const F=["2020-2025","2015-2019","2010-2014","2005-2009","2000-2004"],U=Ae=>{n(Ae)};Math.max(...a.map(Ae=>Ae.count||0),1);const q=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#8b5cf6","#ec4899","#84cc16","#f59e0b"];return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-black border-2 border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl max-w-5xl w-full max-h-[80vh] overflow-hidden transform transition-all duration-300 scale-100",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-900",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:u.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsx("div",{})]}),u.jsx("button",{onClick:()=>t(!1),className:"w-10 h-10 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110",children:u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-4 overflow-hidden max-h-[calc(80vh-100px)]",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),u.jsx("label",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Select Analysis Period:"})]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:F.map(Ae=>u.jsx("button",{onClick:()=>U(Ae),className:`px-3 py-2 rounded-lg text-xs font-medium transition-all duration-300 transform hover:scale-105 ${r===Ae?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg shadow-blue-500/25":"bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-blue-300 dark:hover:border-blue-500 hover:shadow-md"}`,children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"font-bold",children:Ae}),u.jsx("div",{className:"text-xs opacity-75",children:"Years"})]})},Ae))})]}),u.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-2xl p-4 shadow-xl",children:l?u.jsx("div",{className:"flex items-center justify-center h-96",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600"}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full animate-pulse"})})]})}):a.length>0?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsx("div",{})}),u.jsxs("div",{className:"flex gap-6",children:[u.jsxs("div",{className:"flex-1 relative bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:[u.jsx("svg",{ref:O,width:"100%",height:"250",className:"relative",onMouseLeave:()=>{E(!1),i(null)},children:(()=>{const Ae=a.sort((er,Lt)=>{var Rr,Pt;return(((Rr=er._id)==null?void 0:Rr.year)||0)-(((Pt=Lt._id)==null?void 0:Pt.year)||0)});if(Ae.length===0)return null;const _e=700,Ee=300,ke=100,Qe=_e-ke*2,Ze=Ee-ke*2,Ge=Ae.map(er=>{var Lt;return((Lt=er._id)==null?void 0:Lt.year)||0}),Oe=Ae.map(er=>er.count||0),je=Math.min(...Ge),ut=Math.max(...Ge)-je||1,ze=Math.min(...Oe),ht=Math.max(...Oe),Qt=(ht-ze||1)*.1,Cr=Math.max(0,ze-Qt),cr=ht+Qt-Cr,nr=Ae.map((er,Lt)=>{var Br;const Rr=((Br=er._id)==null?void 0:Br.year)||0,Pt=er.count||0,nn=ke+(Rr-je)/ut*Qe,Sn=ke+Ze-(Pt-Cr)/cr*Ze;return{x:nn,y:Sn,year:Rr,count:Pt,color:q[Lt%q.length]}}),Kt=nr.reduce((er,Lt,Rr)=>Rr===0?`M ${Lt.x} ${ke+Ze} L ${Lt.x} ${Lt.y}`:`${er} L ${Lt.x} ${Lt.y}`,"")+` L ${nr[nr.length-1].x} ${ke+Ze} Z`,De=nr.reduce((er,Lt,Rr)=>{if(Rr===0)return`M ${Lt.x} ${Lt.y}`;const Pt=nr[Rr-1],nn=Pt.x+(Lt.x-Pt.x)/3,Sn=Pt.y,Br=Lt.x-(Lt.x-Pt.x)/3,et=Lt.y;return`${er} C ${nn} ${Sn} ${Br} ${et} ${Lt.x} ${Lt.y}`},"");return u.jsxs("g",{children:[u.jsxs("defs",{children:[u.jsxs("linearGradient",{id:"modalAreaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.2"}),u.jsx("stop",{offset:"50%",stopColor:"#8b5cf6",stopOpacity:"0.1"}),u.jsx("stop",{offset:"100%",stopColor:"#06b6d4",stopOpacity:"0.05"})]}),u.jsxs("linearGradient",{id:"modalLineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[u.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),u.jsx("stop",{offset:"14%",stopColor:"#f97316"}),u.jsx("stop",{offset:"28%",stopColor:"#eab308"}),u.jsx("stop",{offset:"42%",stopColor:"#22c55e"}),u.jsx("stop",{offset:"57%",stopColor:"#06b6d4"}),u.jsx("stop",{offset:"71%",stopColor:"#3b82f6"}),u.jsx("stop",{offset:"85%",stopColor:"#8b5cf6"}),u.jsx("stop",{offset:"100%",stopColor:"#ec4899"})]}),u.jsxs("filter",{id:"modalGlow",children:[u.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),u.jsxs("feMerge",{children:[u.jsx("feMergeNode",{in:"coloredBlur"}),u.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),[0,.5,1].map((er,Lt)=>{const Rr=ke+Ze-er*Ze;return u.jsx("line",{x1:ke,y1:Rr,x2:ke+Qe,y2:Rr,stroke:"#e5e7eb",strokeWidth:1,strokeDasharray:"3,3",opacity:"0.5",children:u.jsx("animate",{attributeName:"opacity",values:"0;0.5;0",dur:"3s",begin:`${Lt*.3}s`,repeatCount:"1"})},Lt)}),u.jsx("path",{d:Kt,fill:"url(#modalAreaGradient)"}),u.jsx("path",{d:De,fill:"none",stroke:"url(#modalLineGradient)",strokeWidth:5,strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#modalGlow)",children:u.jsx("animate",{attributeName:"stroke-dasharray",values:"0,2000;2000,0",dur:"3s",repeatCount:"1"})}),nr.map((er,Lt)=>{const Rr=f===Lt;return u.jsxs("g",{children:[u.jsx("circle",{cx:er.x,cy:er.y,r:20,fill:"transparent",onMouseEnter:Pt=>{i(Lt),E(!0);const nn=O.current.getBoundingClientRect(),Sn=220,Br=120;let et=Pt.clientX-nn.left,bt=Pt.clientY-nn.top;const zt=Sn/2;et<zt+20?et=zt+20:et>nn.width-zt-20&&(et=nn.width-zt-20),bt=bt+30,bt+Br>nn.height-20&&(bt=Pt.clientY-nn.top-Br-10),w({x:et,y:bt})},onMouseMove:Pt=>{const nn=O.current.getBoundingClientRect(),Sn=220,Br=120;let et=Pt.clientX-nn.left,bt=Pt.clientY-nn.top;const zt=Sn/2;et<zt+20?et=zt+20:et>nn.width-zt-20&&(et=nn.width-zt-20),bt=bt+30,bt+Br>nn.height-20&&(bt=Pt.clientY-nn.top-Br-10),w({x:et,y:bt})},style:{cursor:"pointer"}}),u.jsx("circle",{cx:er.x,cy:er.y,r:Rr?16:12,fill:"none",stroke:er.color,strokeWidth:Rr?4:3,opacity:Rr?.4:.6,children:u.jsx("animate",{attributeName:"r",values:Rr?"12;16;12":"12",dur:Rr?"1.5s":"0s",repeatCount:Rr?"indefinite":"1"})}),u.jsx("circle",{cx:er.x,cy:er.y,r:Rr?10:8,fill:er.color,stroke:"white",strokeWidth:4,className:"drop-shadow-xl",children:u.jsx("animate",{attributeName:"r",values:"8;10;8",dur:"2.5s",begin:`${Lt*.2}s`,repeatCount:"1"})}),u.jsx("circle",{cx:er.x,cy:er.y,r:Rr?5:4,fill:er.color,opacity:"0.9",filter:"url(#modalGlow)"}),u.jsx("circle",{cx:er.x+2,cy:er.y-2,r:3,fill:"white",opacity:"0.8"})]},er.year)}),nr.map((er,Lt)=>u.jsxs("g",{children:[u.jsx("text",{x:er.x,y:ke+Ze+30,textAnchor:"middle",className:"text-sm font-bold fill-gray-700 dark:fill-gray-200",children:er.year}),u.jsx("line",{x1:er.x,y1:ke+Ze,x2:er.x,y2:ke+Ze+8,stroke:er.color,strokeWidth:2})]},er.year)),[0,.5,1].map((er,Lt)=>{const Rr=ke+Ze-er*Ze,Pt=Math.round(Cr+cr*er);return u.jsxs("g",{children:[u.jsx("text",{x:ke-20,y:Rr+4,textAnchor:"end",className:"text-sm font-semibold fill-gray-700 dark:fill-gray-200",children:Pt.toLocaleString()}),u.jsx("line",{x1:ke-8,y1:Rr,x2:ke,y2:Rr,stroke:"#6b7280",strokeWidth:2,opacity:"0.6"})]},Lt)}),u.jsx("text",{x:ke-50,y:Ee/2,textAnchor:"middle",transform:`rotate(-90, ${ke-50}, ${Ee/2})`,className:"text-sm font-medium fill-gray-600 dark:fill-gray-400",children:"Number of Violations"})]})})()}),A&&f!==null&&u.jsxs("div",{className:"absolute bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 rounded-xl shadow-2xl p-4 z-50 pointer-events-none backdrop-blur-sm min-w-[200px]",style:{left:`${_.x-110}px`,top:`${_.y}px`,maxWidth:"250px",position:"absolute"},children:[u.jsx("div",{className:"absolute w-3 h-3 bg-white dark:bg-gray-800 border-l-2 border-t-2 border-gray-200 dark:border-gray-600 transform rotate-45",style:{left:"50%",top:"-6px",transform:"translateX(-50%) rotate(45deg)"}}),u.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full shadow-lg",style:{backgroundColor:q[f%q.length]}}),u.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:((Z=(W=a[f])==null?void 0:W._id)==null?void 0:Z.year)||"N/A"})]}),u.jsxs("div",{className:"text-lg font-bold mb-2",style:{color:q[f%q.length]},children:[(((ne=a[f])==null?void 0:ne.count)||0).toLocaleString()," violations"]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:f>0&&u.jsxs("span",{className:(((ae=a[f])==null?void 0:ae.count)||0)>(((ee=a[f-1])==null?void 0:ee.count)||0)?"text-red-500":"text-green-500",children:[(((se=a[f])==null?void 0:se.count)||0)>(((ce=a[f-1])==null?void 0:ce.count)||0)?"":"",Math.abs((((ge=a[f])==null?void 0:ge.count)||0)-(((Te=a[f-1])==null?void 0:Te.count)||0)).toLocaleString()," from previous year"]})})]})]}),u.jsxs("div",{className:"w-56 space-y-2",children:[u.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/20 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-2 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 bg-blue-500/10 dark:bg-blue-400/10 rounded-full -translate-y-1 translate-x-1"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:"flex items-center mb-0.5",children:[u.jsx("div",{className:"w-1 h-1 bg-blue-500 rounded-full mr-1 animate-pulse"}),u.jsx("div",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300 uppercase tracking-wide",children:"Timeline"})]}),u.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100 mb-0.5",children:a.length}),u.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Years Covered"})]})]}),u.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-red-50 to-pink-100 dark:from-red-900/20 dark:to-pink-900/20 border-2 border-red-200 dark:border-red-700 rounded-lg p-2 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 bg-red-500/10 dark:bg-red-400/10 rounded-full -translate-y-1 translate-x-1"}),u.jsx("div",{className:"absolute top-1 right-1 w-1 h-1 bg-red-500 rounded-full animate-ping"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:"flex items-center mb-0.5",children:[u.jsx("div",{className:"w-1 h-1 bg-red-500 rounded-full mr-1"}),u.jsx("div",{className:"text-xs font-semibold text-red-700 dark:text-red-300 uppercase tracking-wide",children:"Critical"})]}),u.jsx("div",{className:"text-lg font-bold text-red-900 dark:text-red-100 mb-0.5",children:a.reduce((Ae,_e)=>Ae+(_e.count||0),0).toLocaleString()}),u.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Total Violations"})]})]}),u.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-green-50 to-emerald-100 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-200 dark:border-green-700 rounded-lg p-2 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 bg-green-500/10 dark:bg-green-400/10 rounded-full -translate-y-1 translate-x-1"}),u.jsx("div",{className:"absolute top-1 right-1 w-1 h-1 bg-green-400 rounded-full animate-bounce"}),u.jsxs("div",{className:"relative z-10",children:[u.jsxs("div",{className:"flex items-center mb-0.5",children:[u.jsx("div",{className:"w-1 h-1 bg-green-500 rounded-full mr-1"}),u.jsx("div",{className:"text-xs font-semibold text-green-700 dark:text-green-300 uppercase tracking-wide",children:"Analytics"})]}),u.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100 mb-0.5",children:a.length>0?Math.round(a.reduce((Ae,_e)=>Ae+(_e.count||0),0)/a.length).toLocaleString():0}),u.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Average per Year"})]})]})]})]})]}):u.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsx("p",{className:"text-sm",children:"No data available for the selected year range"}),u.jsx("p",{className:"text-xs opacity-75 mt-1",children:"Try selecting a different time period"})]})})]})]})})}const KG=(e,t=2e3)=>{const[r,n]=H.useState(0);return H.useEffect(()=>{let a;const f=i=>{a||(a=i);const _=Math.min((i-a)/t,1),w=1-Math.pow(1-_,4),A=Math.floor(0+(e-0)*w);n(A),_<1&&requestAnimationFrame(f)};requestAnimationFrame(f)},[e,t]),r};function uVe(){var Ze,Ge,Oe,je;const[e,t]=H.useState(""),[r,n]=H.useState(!1),[a,l]=H.useState(null),[f,i]=H.useState(!1),[_,w]=H.useState(null),[A,E]=H.useState(1),O=5,[F,U]=H.useState(!1),[B,q]=H.useState("2020-2023"),W=H.useRef(null);new Date().getFullYear(),[...Array.from({length:19},(Le,ut)=>(2005+ut).toString())];const ne=(()=>{if(!(a!=null&&a.yearlyTrends))return[];if(!B.includes("-")){const ze=parseInt(B);return a.yearlyTrends.filter(ht=>{var rt;return((rt=ht._id)==null?void 0:rt.year)===ze})}const[Le,ut]=B.split("-").map(Number);return a.yearlyTrends.filter(ze=>{var ht,rt;return((ht=ze._id)==null?void 0:ht.year)>=Le&&((rt=ze._id)==null?void 0:rt.year)<=ut})})(),ae=KG((a==null?void 0:a.totalViolations)||0),ee=KG((a==null?void 0:a.totalTrafficViolators)||0);H.useEffect(()=>{const Le=ut=>{W.current&&!W.current.contains(ut.target)&&n(!1)};return document.addEventListener("mousedown",Le),()=>{document.removeEventListener("mousedown",Le)}},[]);const se=async Le=>{var ut,ze;try{i(!0),w(null);let ht=null;Le&&Le!=="All"&&(ht=Le),console.log(" Fetching violation analytics with filters:",{year:Le,yearValue:ht}),console.log(" Token in localStorage:",localStorage.getItem("token")?"Present":"Missing");const rt=await rVe({},ht);if(console.log(" API Response:",rt),console.log(" Response success:",rt==null?void 0:rt.success),console.log(" Response data:",rt==null?void 0:rt.data),rt&&rt.success)l(rt.data),console.log("Analytics data set:",rt.data),Le&&Le!=="All"&&rt.data.totalViolations===0?w(`No violation data available for year ${Le}. Please try a different year.`):w(null);else{const Qt=(rt==null?void 0:rt.message)||"Failed to fetch analytics data";w(Qt),console.error("API returned error:",Qt)}}catch(ht){console.error("Error fetching analytics data:",ht);const rt=((ze=(ut=ht.response)==null?void 0:ut.data)==null?void 0:ze.message)||ht.message||"Error loading analytics data";w(rt)}finally{i(!1)}};H.useEffect(()=>{se("All")},[]),H.useEffect(()=>{se(e||"All")},[e]);const ce=((Ze=a==null?void 0:a.mostCommonViolations)==null?void 0:Ze.length)||0,ge=Math.ceil(ce/O),Te=(A-1)*O,Ae=Te+O,_e=((Ge=a==null?void 0:a.mostCommonViolations)==null?void 0:Ge.slice(Te,Ae))||[],Ee=()=>{E(Le=>Math.max(Le-1,1))},ke=()=>{E(Le=>Math.min(Le+1,ge))},Qe=Le=>{const ut=Le.map(ze=>ze.toLowerCase());return ut.some(ze=>ze.includes("no helmet"))&&ut.some(ze=>ze.includes("no license"))?"Immediate impoundment - High risk rider without proper documentation":ut.some(ze=>ze.includes("speeding"))&&ut.some(ze=>ze.includes("no license"))?"Vehicle impoundment and court hearing - Reckless driving without license":ut.some(ze=>ze.includes("no registration"))&&ut.some(ze=>ze.includes("no license"))?"Complete documentation check and vehicle impoundment until compliance":ut.some(ze=>ze.includes("drunk"))||ut.some(ze=>ze.includes("alcohol"))?"Immediate arrest and breathalyzer test - Zero tolerance policy":ut.some(ze=>ze.includes("reckless"))&&ut.some(ze=>ze.includes("speeding"))?"License suspension and mandatory driver education program":ut.some(ze=>ze.includes("confiscated"))||ut.some(ze=>ze.includes("impound"))?"Severe violation - Court hearing and possible vehicle forfeiture":ut.some(ze=>ze.includes("no license"))||ut.some(ze=>ze.includes("no registration"))?"Documentation violation - Vehicle impoundment until proper documents provided":ut.some(ze=>ze.includes("helmet"))||ut.some(ze=>ze.includes("safety"))?"Safety violation - Fine and safety education requirement":ut.some(ze=>ze.includes("speeding"))||ut.some(ze=>ze.includes("traffic"))?"Traffic violation - Fine and license demerit points":"Standard fine and documentation review"};return u.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:[u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"mb-6",children:[u.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2 animate-in slide-in-from-top-5 fade-in duration-700 flex items-center gap-2",children:[u.jsx(RW,{className:"h-8 w-8 text-orange-500 animate-pulse"}),"Violation Analytics"]}),u.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Traffic Violation Analytics Dashboard",a&&u.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",children:" Live Data"}),!a&&!f&&u.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",children:"No Data"})]})]})}),_&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:_}),u.jsx("button",{onClick:()=>se(e||"All"),className:"ml-4 px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}),u.jsx(nVe,{displayData:a,loading:f,totalViolations:ae,totalTrafficViolators:ee,topOfficer:(Oe=a==null?void 0:a.topOfficers)==null?void 0:Oe[0],mostCommonViolation:(je=a==null?void 0:a.mostCommonViolations)==null?void 0:je[0]}),u.jsx(lVe,{displayData:a,loading:f,setIsLineChartModalOpen:U,currentViolations:_e,startIndex:Te,endIndex:Ae,totalViolationItems:ce,currentPage:A,totalPages:ge,handlePrevPage:Ee,handleNextPage:ke,getCombinationRecommendation:Qe}),u.jsx(cVe,{isLineChartModalOpen:F,setIsLineChartModalOpen:U,selectedYearRange:B,setSelectedYearRange:q,filteredYearlyData:ne,loading:f})]})}function dVe(){return u.jsx("div",{children:u.jsx(uVe,{})})}var mA={exports:{}},hVe=mA.exports,ZG;function fVe(){return ZG||(ZG=1,function(e,t){(function(r,n){e.exports=n()})(hVe,function(){var r,n,a;function l(i,_){if(!r)r=_;else if(!n)n=_;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",A={};r(A),a=_(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}l(["exports"],function(i){function _(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var w,A={},E={};function O(){if(w)return E;w=1,Object.defineProperty(E,"__esModule",{value:!0}),E.setMatrixArrayType=function(v){E.ARRAY_TYPE=s=v},E.toRadian=function(v){return v*p},E.equals=function(v,m){return Math.abs(v-m)<=h*Math.max(1,Math.abs(v),Math.abs(m))},E.RANDOM=E.ARRAY_TYPE=E.EPSILON=void 0;var h=1e-6;E.EPSILON=h;var s=typeof Float32Array<"u"?Float32Array:Array;E.ARRAY_TYPE=s;var c=Math.random;E.RANDOM=c;var p=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var v=0,m=arguments.length;m--;)v+=arguments[m]*arguments[m];return Math.sqrt(v)}),E}var F,U={};function B(){if(F)return U;function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(m)}F=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var m=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m},U.clone=function(m){var x=new s.ARRAY_TYPE(4);return x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3],x},U.copy=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3],m},U.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m},U.fromValues=function(m,x,k,N){var z=new s.ARRAY_TYPE(4);return z[0]=m,z[1]=x,z[2]=k,z[3]=N,z},U.set=function(m,x,k,N,z){return m[0]=x,m[1]=k,m[2]=N,m[3]=z,m},U.transpose=function(m,x){if(m===x){var k=x[1];m[1]=x[2],m[2]=k}else m[0]=x[0],m[1]=x[2],m[2]=x[1],m[3]=x[3];return m},U.invert=function(m,x){var k=x[0],N=x[1],z=x[2],C=x[3],R=k*C-z*N;return R?(m[0]=C*(R=1/R),m[1]=-N*R,m[2]=-z*R,m[3]=k*R,m):null},U.adjoint=function(m,x){var k=x[0];return m[0]=x[3],m[1]=-x[1],m[2]=-x[2],m[3]=k,m},U.determinant=function(m){return m[0]*m[3]-m[2]*m[1]},U.multiply=p,U.rotate=function(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=Math.sin(k),j=Math.cos(k);return m[0]=N*j+C*L,m[1]=z*j+R*L,m[2]=N*-L+C*j,m[3]=z*-L+R*j,m},U.scale=function(m,x,k){var N=x[1],z=x[2],C=x[3],R=k[0],L=k[1];return m[0]=x[0]*R,m[1]=N*R,m[2]=z*L,m[3]=C*L,m},U.fromRotation=function(m,x){var k=Math.sin(x),N=Math.cos(x);return m[0]=N,m[1]=k,m[2]=-k,m[3]=N,m},U.fromScaling=function(m,x){return m[0]=x[0],m[1]=0,m[2]=0,m[3]=x[1],m},U.str=function(m){return"mat2("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+")"},U.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3])},U.LDU=function(m,x,k,N){return m[2]=N[2]/N[0],k[0]=N[0],k[1]=N[1],k[3]=N[3]-m[2]*k[1],[m,x,k]},U.add=function(m,x,k){return m[0]=x[0]+k[0],m[1]=x[1]+k[1],m[2]=x[2]+k[2],m[3]=x[3]+k[3],m},U.subtract=v,U.exactEquals=function(m,x){return m[0]===x[0]&&m[1]===x[1]&&m[2]===x[2]&&m[3]===x[3]},U.equals=function(m,x){var k=m[0],N=m[1],z=m[2],C=m[3],R=x[0],L=x[1],j=x[2],I=x[3];return Math.abs(k-R)<=s.EPSILON*Math.max(1,Math.abs(k),Math.abs(R))&&Math.abs(N-L)<=s.EPSILON*Math.max(1,Math.abs(N),Math.abs(L))&&Math.abs(z-j)<=s.EPSILON*Math.max(1,Math.abs(z),Math.abs(j))&&Math.abs(C-I)<=s.EPSILON*Math.max(1,Math.abs(C),Math.abs(I))},U.multiplyScalar=function(m,x,k){return m[0]=x[0]*k,m[1]=x[1]*k,m[2]=x[2]*k,m[3]=x[3]*k,m},U.multiplyScalarAndAdd=function(m,x,k,N){return m[0]=x[0]+k[0]*N,m[1]=x[1]+k[1]*N,m[2]=x[2]+k[2]*N,m[3]=x[3]+k[3]*N,m},U.sub=U.mul=void 0;var s=function(m,x){if(m&&m.__esModule)return m;if(m===null||h(m)!=="object"&&typeof m!="function")return{default:m};var k=c(void 0);if(k&&k.has(m))return k.get(m);var N={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in m)if(C!=="default"&&Object.prototype.hasOwnProperty.call(m,C)){var R=z?Object.getOwnPropertyDescriptor(m,C):null;R&&(R.get||R.set)?Object.defineProperty(N,C,R):N[C]=m[C]}return N.default=m,k&&k.set(m,N),N}(O());function c(m){if(typeof WeakMap!="function")return null;var x=new WeakMap,k=new WeakMap;return(c=function(N){return N?k:x})(m)}function p(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=k[0],j=k[1],I=k[2],$=k[3];return m[0]=N*L+C*j,m[1]=z*L+R*j,m[2]=N*I+C*$,m[3]=z*I+R*$,m}function v(m,x,k){return m[0]=x[0]-k[0],m[1]=x[1]-k[1],m[2]=x[2]-k[2],m[3]=x[3]-k[3],m}return U.mul=p,U.sub=v,U}var q,W={};function Z(){if(q)return W;function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(m)}q=1,Object.defineProperty(W,"__esModule",{value:!0}),W.create=function(){var m=new s.ARRAY_TYPE(6);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[4]=0,m[5]=0),m[0]=1,m[3]=1,m},W.clone=function(m){var x=new s.ARRAY_TYPE(6);return x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3],x[4]=m[4],x[5]=m[5],x},W.copy=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3],m[4]=x[4],m[5]=x[5],m},W.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=0,m[5]=0,m},W.fromValues=function(m,x,k,N,z,C){var R=new s.ARRAY_TYPE(6);return R[0]=m,R[1]=x,R[2]=k,R[3]=N,R[4]=z,R[5]=C,R},W.set=function(m,x,k,N,z,C,R){return m[0]=x,m[1]=k,m[2]=N,m[3]=z,m[4]=C,m[5]=R,m},W.invert=function(m,x){var k=x[0],N=x[1],z=x[2],C=x[3],R=x[4],L=x[5],j=k*C-N*z;return j?(m[0]=C*(j=1/j),m[1]=-N*j,m[2]=-z*j,m[3]=k*j,m[4]=(z*L-C*R)*j,m[5]=(N*R-k*L)*j,m):null},W.determinant=function(m){return m[0]*m[3]-m[1]*m[2]},W.multiply=p,W.rotate=function(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=x[4],j=x[5],I=Math.sin(k),$=Math.cos(k);return m[0]=N*$+C*I,m[1]=z*$+R*I,m[2]=N*-I+C*$,m[3]=z*-I+R*$,m[4]=L,m[5]=j,m},W.scale=function(m,x,k){var N=x[1],z=x[2],C=x[3],R=x[4],L=x[5],j=k[0],I=k[1];return m[0]=x[0]*j,m[1]=N*j,m[2]=z*I,m[3]=C*I,m[4]=R,m[5]=L,m},W.translate=function(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=x[4],j=x[5],I=k[0],$=k[1];return m[0]=N,m[1]=z,m[2]=C,m[3]=R,m[4]=N*I+C*$+L,m[5]=z*I+R*$+j,m},W.fromRotation=function(m,x){var k=Math.sin(x),N=Math.cos(x);return m[0]=N,m[1]=k,m[2]=-k,m[3]=N,m[4]=0,m[5]=0,m},W.fromScaling=function(m,x){return m[0]=x[0],m[1]=0,m[2]=0,m[3]=x[1],m[4]=0,m[5]=0,m},W.fromTranslation=function(m,x){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=x[0],m[5]=x[1],m},W.str=function(m){return"mat2d("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+")"},W.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],1)},W.add=function(m,x,k){return m[0]=x[0]+k[0],m[1]=x[1]+k[1],m[2]=x[2]+k[2],m[3]=x[3]+k[3],m[4]=x[4]+k[4],m[5]=x[5]+k[5],m},W.subtract=v,W.multiplyScalar=function(m,x,k){return m[0]=x[0]*k,m[1]=x[1]*k,m[2]=x[2]*k,m[3]=x[3]*k,m[4]=x[4]*k,m[5]=x[5]*k,m},W.multiplyScalarAndAdd=function(m,x,k,N){return m[0]=x[0]+k[0]*N,m[1]=x[1]+k[1]*N,m[2]=x[2]+k[2]*N,m[3]=x[3]+k[3]*N,m[4]=x[4]+k[4]*N,m[5]=x[5]+k[5]*N,m},W.exactEquals=function(m,x){return m[0]===x[0]&&m[1]===x[1]&&m[2]===x[2]&&m[3]===x[3]&&m[4]===x[4]&&m[5]===x[5]},W.equals=function(m,x){var k=m[0],N=m[1],z=m[2],C=m[3],R=m[4],L=m[5],j=x[0],I=x[1],$=x[2],X=x[3],Q=x[4],le=x[5];return Math.abs(k-j)<=s.EPSILON*Math.max(1,Math.abs(k),Math.abs(j))&&Math.abs(N-I)<=s.EPSILON*Math.max(1,Math.abs(N),Math.abs(I))&&Math.abs(z-$)<=s.EPSILON*Math.max(1,Math.abs(z),Math.abs($))&&Math.abs(C-X)<=s.EPSILON*Math.max(1,Math.abs(C),Math.abs(X))&&Math.abs(R-Q)<=s.EPSILON*Math.max(1,Math.abs(R),Math.abs(Q))&&Math.abs(L-le)<=s.EPSILON*Math.max(1,Math.abs(L),Math.abs(le))},W.sub=W.mul=void 0;var s=function(m,x){if(m&&m.__esModule)return m;if(m===null||h(m)!=="object"&&typeof m!="function")return{default:m};var k=c(void 0);if(k&&k.has(m))return k.get(m);var N={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in m)if(C!=="default"&&Object.prototype.hasOwnProperty.call(m,C)){var R=z?Object.getOwnPropertyDescriptor(m,C):null;R&&(R.get||R.set)?Object.defineProperty(N,C,R):N[C]=m[C]}return N.default=m,k&&k.set(m,N),N}(O());function c(m){if(typeof WeakMap!="function")return null;var x=new WeakMap,k=new WeakMap;return(c=function(N){return N?k:x})(m)}function p(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=x[4],j=x[5],I=k[0],$=k[1],X=k[2],Q=k[3],le=k[4],ue=k[5];return m[0]=N*I+C*$,m[1]=z*I+R*$,m[2]=N*X+C*Q,m[3]=z*X+R*Q,m[4]=N*le+C*ue+L,m[5]=z*le+R*ue+j,m}function v(m,x,k){return m[0]=x[0]-k[0],m[1]=x[1]-k[1],m[2]=x[2]-k[2],m[3]=x[3]-k[3],m[4]=x[4]-k[4],m[5]=x[5]-k[5],m}return W.mul=p,W.sub=v,W}var ne,ae={};function ee(){if(ne)return ae;function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},h(m)}ne=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=function(){var m=new s.ARRAY_TYPE(9);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[5]=0,m[6]=0,m[7]=0),m[0]=1,m[4]=1,m[8]=1,m},ae.fromMat4=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[4],m[4]=x[5],m[5]=x[6],m[6]=x[8],m[7]=x[9],m[8]=x[10],m},ae.clone=function(m){var x=new s.ARRAY_TYPE(9);return x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3],x[4]=m[4],x[5]=m[5],x[6]=m[6],x[7]=m[7],x[8]=m[8],x},ae.copy=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3],m[4]=x[4],m[5]=x[5],m[6]=x[6],m[7]=x[7],m[8]=x[8],m},ae.fromValues=function(m,x,k,N,z,C,R,L,j){var I=new s.ARRAY_TYPE(9);return I[0]=m,I[1]=x,I[2]=k,I[3]=N,I[4]=z,I[5]=C,I[6]=R,I[7]=L,I[8]=j,I},ae.set=function(m,x,k,N,z,C,R,L,j,I){return m[0]=x,m[1]=k,m[2]=N,m[3]=z,m[4]=C,m[5]=R,m[6]=L,m[7]=j,m[8]=I,m},ae.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.transpose=function(m,x){if(m===x){var k=x[1],N=x[2],z=x[5];m[1]=x[3],m[2]=x[6],m[3]=k,m[5]=x[7],m[6]=N,m[7]=z}else m[0]=x[0],m[1]=x[3],m[2]=x[6],m[3]=x[1],m[4]=x[4],m[5]=x[7],m[6]=x[2],m[7]=x[5],m[8]=x[8];return m},ae.invert=function(m,x){var k=x[0],N=x[1],z=x[2],C=x[3],R=x[4],L=x[5],j=x[6],I=x[7],$=x[8],X=$*R-L*I,Q=-$*C+L*j,le=I*C-R*j,ue=k*X+N*Q+z*le;return ue?(m[0]=X*(ue=1/ue),m[1]=(-$*N+z*I)*ue,m[2]=(L*N-z*R)*ue,m[3]=Q*ue,m[4]=($*k-z*j)*ue,m[5]=(-L*k+z*C)*ue,m[6]=le*ue,m[7]=(-I*k+N*j)*ue,m[8]=(R*k-N*C)*ue,m):null},ae.adjoint=function(m,x){var k=x[0],N=x[1],z=x[2],C=x[3],R=x[4],L=x[5],j=x[6],I=x[7],$=x[8];return m[0]=R*$-L*I,m[1]=z*I-N*$,m[2]=N*L-z*R,m[3]=L*j-C*$,m[4]=k*$-z*j,m[5]=z*C-k*L,m[6]=C*I-R*j,m[7]=N*j-k*I,m[8]=k*R-N*C,m},ae.determinant=function(m){var x=m[3],k=m[4],N=m[5],z=m[6],C=m[7],R=m[8];return m[0]*(R*k-N*C)+m[1]*(-R*x+N*z)+m[2]*(C*x-k*z)},ae.multiply=p,ae.translate=function(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=x[4],j=x[5],I=x[6],$=x[7],X=x[8],Q=k[0],le=k[1];return m[0]=N,m[1]=z,m[2]=C,m[3]=R,m[4]=L,m[5]=j,m[6]=Q*N+le*R+I,m[7]=Q*z+le*L+$,m[8]=Q*C+le*j+X,m},ae.rotate=function(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=x[4],j=x[5],I=x[6],$=x[7],X=x[8],Q=Math.sin(k),le=Math.cos(k);return m[0]=le*N+Q*R,m[1]=le*z+Q*L,m[2]=le*C+Q*j,m[3]=le*R-Q*N,m[4]=le*L-Q*z,m[5]=le*j-Q*C,m[6]=I,m[7]=$,m[8]=X,m},ae.scale=function(m,x,k){var N=k[0],z=k[1];return m[0]=N*x[0],m[1]=N*x[1],m[2]=N*x[2],m[3]=z*x[3],m[4]=z*x[4],m[5]=z*x[5],m[6]=x[6],m[7]=x[7],m[8]=x[8],m},ae.fromTranslation=function(m,x){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=x[0],m[7]=x[1],m[8]=1,m},ae.fromRotation=function(m,x){var k=Math.sin(x),N=Math.cos(x);return m[0]=N,m[1]=k,m[2]=0,m[3]=-k,m[4]=N,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.fromScaling=function(m,x){return m[0]=x[0],m[1]=0,m[2]=0,m[3]=0,m[4]=x[1],m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.fromMat2d=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=0,m[3]=x[2],m[4]=x[3],m[5]=0,m[6]=x[4],m[7]=x[5],m[8]=1,m},ae.fromQuat=function(m,x){var k=x[0],N=x[1],z=x[2],C=x[3],R=k+k,L=N+N,j=z+z,I=k*R,$=N*R,X=N*L,Q=z*R,le=z*L,ue=z*j,ie=C*R,he=C*L,me=C*j;return m[0]=1-X-ue,m[3]=$-me,m[6]=Q+he,m[1]=$+me,m[4]=1-I-ue,m[7]=le-ie,m[2]=Q-he,m[5]=le+ie,m[8]=1-I-X,m},ae.normalFromMat4=function(m,x){var k=x[0],N=x[1],z=x[2],C=x[3],R=x[4],L=x[5],j=x[6],I=x[7],$=x[8],X=x[9],Q=x[10],le=x[11],ue=x[12],ie=x[13],he=x[14],me=x[15],we=k*L-N*R,Ie=k*j-z*R,Ne=k*I-C*R,Me=N*j-z*L,Je=N*I-C*L,Fe=z*I-C*j,tt=$*ie-X*ue,st=$*he-Q*ue,nt=$*me-le*ue,lt=X*he-Q*ie,ft=X*me-le*ie,vt=Q*me-le*he,ct=we*vt-Ie*ft+Ne*lt+Me*nt-Je*st+Fe*tt;return ct?(m[0]=(L*vt-j*ft+I*lt)*(ct=1/ct),m[1]=(j*nt-R*vt-I*st)*ct,m[2]=(R*ft-L*nt+I*tt)*ct,m[3]=(z*ft-N*vt-C*lt)*ct,m[4]=(k*vt-z*nt+C*st)*ct,m[5]=(N*nt-k*ft-C*tt)*ct,m[6]=(ie*Fe-he*Je+me*Me)*ct,m[7]=(he*Ne-ue*Fe-me*Ie)*ct,m[8]=(ue*Je-ie*Ne+me*we)*ct,m):null},ae.projection=function(m,x,k){return m[0]=2/x,m[1]=0,m[2]=0,m[3]=0,m[4]=-2/k,m[5]=0,m[6]=-1,m[7]=1,m[8]=1,m},ae.str=function(m){return"mat3("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+", "+m[6]+", "+m[7]+", "+m[8]+")"},ae.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8])},ae.add=function(m,x,k){return m[0]=x[0]+k[0],m[1]=x[1]+k[1],m[2]=x[2]+k[2],m[3]=x[3]+k[3],m[4]=x[4]+k[4],m[5]=x[5]+k[5],m[6]=x[6]+k[6],m[7]=x[7]+k[7],m[8]=x[8]+k[8],m},ae.subtract=v,ae.multiplyScalar=function(m,x,k){return m[0]=x[0]*k,m[1]=x[1]*k,m[2]=x[2]*k,m[3]=x[3]*k,m[4]=x[4]*k,m[5]=x[5]*k,m[6]=x[6]*k,m[7]=x[7]*k,m[8]=x[8]*k,m},ae.multiplyScalarAndAdd=function(m,x,k,N){return m[0]=x[0]+k[0]*N,m[1]=x[1]+k[1]*N,m[2]=x[2]+k[2]*N,m[3]=x[3]+k[3]*N,m[4]=x[4]+k[4]*N,m[5]=x[5]+k[5]*N,m[6]=x[6]+k[6]*N,m[7]=x[7]+k[7]*N,m[8]=x[8]+k[8]*N,m},ae.exactEquals=function(m,x){return m[0]===x[0]&&m[1]===x[1]&&m[2]===x[2]&&m[3]===x[3]&&m[4]===x[4]&&m[5]===x[5]&&m[6]===x[6]&&m[7]===x[7]&&m[8]===x[8]},ae.equals=function(m,x){var k=m[0],N=m[1],z=m[2],C=m[3],R=m[4],L=m[5],j=m[6],I=m[7],$=m[8],X=x[0],Q=x[1],le=x[2],ue=x[3],ie=x[4],he=x[5],me=x[6],we=x[7],Ie=x[8];return Math.abs(k-X)<=s.EPSILON*Math.max(1,Math.abs(k),Math.abs(X))&&Math.abs(N-Q)<=s.EPSILON*Math.max(1,Math.abs(N),Math.abs(Q))&&Math.abs(z-le)<=s.EPSILON*Math.max(1,Math.abs(z),Math.abs(le))&&Math.abs(C-ue)<=s.EPSILON*Math.max(1,Math.abs(C),Math.abs(ue))&&Math.abs(R-ie)<=s.EPSILON*Math.max(1,Math.abs(R),Math.abs(ie))&&Math.abs(L-he)<=s.EPSILON*Math.max(1,Math.abs(L),Math.abs(he))&&Math.abs(j-me)<=s.EPSILON*Math.max(1,Math.abs(j),Math.abs(me))&&Math.abs(I-we)<=s.EPSILON*Math.max(1,Math.abs(I),Math.abs(we))&&Math.abs($-Ie)<=s.EPSILON*Math.max(1,Math.abs($),Math.abs(Ie))},ae.sub=ae.mul=void 0;var s=function(m,x){if(m&&m.__esModule)return m;if(m===null||h(m)!=="object"&&typeof m!="function")return{default:m};var k=c(void 0);if(k&&k.has(m))return k.get(m);var N={},z=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in m)if(C!=="default"&&Object.prototype.hasOwnProperty.call(m,C)){var R=z?Object.getOwnPropertyDescriptor(m,C):null;R&&(R.get||R.set)?Object.defineProperty(N,C,R):N[C]=m[C]}return N.default=m,k&&k.set(m,N),N}(O());function c(m){if(typeof WeakMap!="function")return null;var x=new WeakMap,k=new WeakMap;return(c=function(N){return N?k:x})(m)}function p(m,x,k){var N=x[0],z=x[1],C=x[2],R=x[3],L=x[4],j=x[5],I=x[6],$=x[7],X=x[8],Q=k[0],le=k[1],ue=k[2],ie=k[3],he=k[4],me=k[5],we=k[6],Ie=k[7],Ne=k[8];return m[0]=Q*N+le*R+ue*I,m[1]=Q*z+le*L+ue*$,m[2]=Q*C+le*j+ue*X,m[3]=ie*N+he*R+me*I,m[4]=ie*z+he*L+me*$,m[5]=ie*C+he*j+me*X,m[6]=we*N+Ie*R+Ne*I,m[7]=we*z+Ie*L+Ne*$,m[8]=we*C+Ie*j+Ne*X,m}function v(m,x,k){return m[0]=x[0]-k[0],m[1]=x[1]-k[1],m[2]=x[2]-k[2],m[3]=x[3]-k[3],m[4]=x[4]-k[4],m[5]=x[5]-k[5],m[6]=x[6]-k[6],m[7]=x[7]-k[7],m[8]=x[8]-k[8],m}return ae.mul=p,ae.sub=v,ae}var se,ce={};function ge(){if(se)return ce;function h(C){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},h(C)}se=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=function(){var C=new s.ARRAY_TYPE(16);return s.ARRAY_TYPE!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C},ce.clone=function(C){var R=new s.ARRAY_TYPE(16);return R[0]=C[0],R[1]=C[1],R[2]=C[2],R[3]=C[3],R[4]=C[4],R[5]=C[5],R[6]=C[6],R[7]=C[7],R[8]=C[8],R[9]=C[9],R[10]=C[10],R[11]=C[11],R[12]=C[12],R[13]=C[13],R[14]=C[14],R[15]=C[15],R},ce.copy=function(C,R){return C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C},ce.fromValues=function(C,R,L,j,I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne){var Me=new s.ARRAY_TYPE(16);return Me[0]=C,Me[1]=R,Me[2]=L,Me[3]=j,Me[4]=I,Me[5]=$,Me[6]=X,Me[7]=Q,Me[8]=le,Me[9]=ue,Me[10]=ie,Me[11]=he,Me[12]=me,Me[13]=we,Me[14]=Ie,Me[15]=Ne,Me},ce.set=function(C,R,L,j,I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne,Me){return C[0]=R,C[1]=L,C[2]=j,C[3]=I,C[4]=$,C[5]=X,C[6]=Q,C[7]=le,C[8]=ue,C[9]=ie,C[10]=he,C[11]=me,C[12]=we,C[13]=Ie,C[14]=Ne,C[15]=Me,C},ce.identity=p,ce.transpose=function(C,R){if(C===R){var L=R[1],j=R[2],I=R[3],$=R[6],X=R[7],Q=R[11];C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=L,C[6]=R[9],C[7]=R[13],C[8]=j,C[9]=$,C[11]=R[14],C[12]=I,C[13]=X,C[14]=Q}else C[0]=R[0],C[1]=R[4],C[2]=R[8],C[3]=R[12],C[4]=R[1],C[5]=R[5],C[6]=R[9],C[7]=R[13],C[8]=R[2],C[9]=R[6],C[10]=R[10],C[11]=R[14],C[12]=R[3],C[13]=R[7],C[14]=R[11],C[15]=R[15];return C},ce.invert=function(C,R){var L=R[0],j=R[1],I=R[2],$=R[3],X=R[4],Q=R[5],le=R[6],ue=R[7],ie=R[8],he=R[9],me=R[10],we=R[11],Ie=R[12],Ne=R[13],Me=R[14],Je=R[15],Fe=L*Q-j*X,tt=L*le-I*X,st=L*ue-$*X,nt=j*le-I*Q,lt=j*ue-$*Q,ft=I*ue-$*le,vt=ie*Ne-he*Ie,ct=ie*Me-me*Ie,Rt=ie*Je-we*Ie,$t=he*Me-me*Ne,Nt=he*Je-we*Ne,hr=me*Je-we*Me,or=Fe*hr-tt*Nt+st*$t+nt*Rt-lt*ct+ft*vt;return or?(C[0]=(Q*hr-le*Nt+ue*$t)*(or=1/or),C[1]=(I*Nt-j*hr-$*$t)*or,C[2]=(Ne*ft-Me*lt+Je*nt)*or,C[3]=(me*lt-he*ft-we*nt)*or,C[4]=(le*Rt-X*hr-ue*ct)*or,C[5]=(L*hr-I*Rt+$*ct)*or,C[6]=(Me*st-Ie*ft-Je*tt)*or,C[7]=(ie*ft-me*st+we*tt)*or,C[8]=(X*Nt-Q*Rt+ue*vt)*or,C[9]=(j*Rt-L*Nt-$*vt)*or,C[10]=(Ie*lt-Ne*st+Je*Fe)*or,C[11]=(he*st-ie*lt-we*Fe)*or,C[12]=(Q*ct-X*$t-le*vt)*or,C[13]=(L*$t-j*ct+I*vt)*or,C[14]=(Ne*tt-Ie*nt-Me*Fe)*or,C[15]=(ie*nt-he*tt+me*Fe)*or,C):null},ce.adjoint=function(C,R){var L=R[0],j=R[1],I=R[2],$=R[3],X=R[4],Q=R[5],le=R[6],ue=R[7],ie=R[8],he=R[9],me=R[10],we=R[11],Ie=R[12],Ne=R[13],Me=R[14],Je=R[15];return C[0]=Q*(me*Je-we*Me)-he*(le*Je-ue*Me)+Ne*(le*we-ue*me),C[1]=-(j*(me*Je-we*Me)-he*(I*Je-$*Me)+Ne*(I*we-$*me)),C[2]=j*(le*Je-ue*Me)-Q*(I*Je-$*Me)+Ne*(I*ue-$*le),C[3]=-(j*(le*we-ue*me)-Q*(I*we-$*me)+he*(I*ue-$*le)),C[4]=-(X*(me*Je-we*Me)-ie*(le*Je-ue*Me)+Ie*(le*we-ue*me)),C[5]=L*(me*Je-we*Me)-ie*(I*Je-$*Me)+Ie*(I*we-$*me),C[6]=-(L*(le*Je-ue*Me)-X*(I*Je-$*Me)+Ie*(I*ue-$*le)),C[7]=L*(le*we-ue*me)-X*(I*we-$*me)+ie*(I*ue-$*le),C[8]=X*(he*Je-we*Ne)-ie*(Q*Je-ue*Ne)+Ie*(Q*we-ue*he),C[9]=-(L*(he*Je-we*Ne)-ie*(j*Je-$*Ne)+Ie*(j*we-$*he)),C[10]=L*(Q*Je-ue*Ne)-X*(j*Je-$*Ne)+Ie*(j*ue-$*Q),C[11]=-(L*(Q*we-ue*he)-X*(j*we-$*he)+ie*(j*ue-$*Q)),C[12]=-(X*(he*Me-me*Ne)-ie*(Q*Me-le*Ne)+Ie*(Q*me-le*he)),C[13]=L*(he*Me-me*Ne)-ie*(j*Me-I*Ne)+Ie*(j*me-I*he),C[14]=-(L*(Q*Me-le*Ne)-X*(j*Me-I*Ne)+Ie*(j*le-I*Q)),C[15]=L*(Q*me-le*he)-X*(j*me-I*he)+ie*(j*le-I*Q),C},ce.determinant=function(C){var R=C[0],L=C[1],j=C[2],I=C[3],$=C[4],X=C[5],Q=C[6],le=C[7],ue=C[8],ie=C[9],he=C[10],me=C[11],we=C[12],Ie=C[13],Ne=C[14],Me=C[15];return(R*X-L*$)*(he*Me-me*Ne)-(R*Q-j*$)*(ie*Me-me*Ie)+(R*le-I*$)*(ie*Ne-he*Ie)+(L*Q-j*X)*(ue*Me-me*we)-(L*le-I*X)*(ue*Ne-he*we)+(j*le-I*Q)*(ue*Ie-ie*we)},ce.multiply=v,ce.translate=function(C,R,L){var j,I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne=L[0],Me=L[1],Je=L[2];return R===C?(C[12]=R[0]*Ne+R[4]*Me+R[8]*Je+R[12],C[13]=R[1]*Ne+R[5]*Me+R[9]*Je+R[13],C[14]=R[2]*Ne+R[6]*Me+R[10]*Je+R[14],C[15]=R[3]*Ne+R[7]*Me+R[11]*Je+R[15]):(I=R[1],$=R[2],X=R[3],Q=R[4],le=R[5],ue=R[6],ie=R[7],he=R[8],me=R[9],we=R[10],Ie=R[11],C[0]=j=R[0],C[1]=I,C[2]=$,C[3]=X,C[4]=Q,C[5]=le,C[6]=ue,C[7]=ie,C[8]=he,C[9]=me,C[10]=we,C[11]=Ie,C[12]=j*Ne+Q*Me+he*Je+R[12],C[13]=I*Ne+le*Me+me*Je+R[13],C[14]=$*Ne+ue*Me+we*Je+R[14],C[15]=X*Ne+ie*Me+Ie*Je+R[15]),C},ce.scale=function(C,R,L){var j=L[0],I=L[1],$=L[2];return C[0]=R[0]*j,C[1]=R[1]*j,C[2]=R[2]*j,C[3]=R[3]*j,C[4]=R[4]*I,C[5]=R[5]*I,C[6]=R[6]*I,C[7]=R[7]*I,C[8]=R[8]*$,C[9]=R[9]*$,C[10]=R[10]*$,C[11]=R[11]*$,C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15],C},ce.rotate=function(C,R,L,j){var I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne,Me,Je,Fe,tt,st,nt,lt,ft,vt,ct,Rt,$t,Nt=j[0],hr=j[1],or=j[2],Jt=Math.hypot(Nt,hr,or);return Jt<s.EPSILON?null:(Nt*=Jt=1/Jt,hr*=Jt,or*=Jt,I=Math.sin(L),$=Math.cos(L),le=R[1],ue=R[2],ie=R[3],me=R[5],we=R[6],Ie=R[7],Me=R[9],Je=R[10],Fe=R[11],tt=Nt*Nt*(X=1-$)+$,lt=Nt*hr*X-or*I,ft=hr*hr*X+$,vt=or*hr*X+Nt*I,ct=Nt*or*X+hr*I,Rt=hr*or*X-Nt*I,$t=or*or*X+$,C[0]=(Q=R[0])*tt+(he=R[4])*(st=hr*Nt*X+or*I)+(Ne=R[8])*(nt=or*Nt*X-hr*I),C[1]=le*tt+me*st+Me*nt,C[2]=ue*tt+we*st+Je*nt,C[3]=ie*tt+Ie*st+Fe*nt,C[4]=Q*lt+he*ft+Ne*vt,C[5]=le*lt+me*ft+Me*vt,C[6]=ue*lt+we*ft+Je*vt,C[7]=ie*lt+Ie*ft+Fe*vt,C[8]=Q*ct+he*Rt+Ne*$t,C[9]=le*ct+me*Rt+Me*$t,C[10]=ue*ct+we*Rt+Je*$t,C[11]=ie*ct+Ie*Rt+Fe*$t,R!==C&&(C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C)},ce.rotateX=function(C,R,L){var j=Math.sin(L),I=Math.cos(L),$=R[4],X=R[5],Q=R[6],le=R[7],ue=R[8],ie=R[9],he=R[10],me=R[11];return R!==C&&(C[0]=R[0],C[1]=R[1],C[2]=R[2],C[3]=R[3],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[4]=$*I+ue*j,C[5]=X*I+ie*j,C[6]=Q*I+he*j,C[7]=le*I+me*j,C[8]=ue*I-$*j,C[9]=ie*I-X*j,C[10]=he*I-Q*j,C[11]=me*I-le*j,C},ce.rotateY=function(C,R,L){var j=Math.sin(L),I=Math.cos(L),$=R[0],X=R[1],Q=R[2],le=R[3],ue=R[8],ie=R[9],he=R[10],me=R[11];return R!==C&&(C[4]=R[4],C[5]=R[5],C[6]=R[6],C[7]=R[7],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=$*I-ue*j,C[1]=X*I-ie*j,C[2]=Q*I-he*j,C[3]=le*I-me*j,C[8]=$*j+ue*I,C[9]=X*j+ie*I,C[10]=Q*j+he*I,C[11]=le*j+me*I,C},ce.rotateZ=function(C,R,L){var j=Math.sin(L),I=Math.cos(L),$=R[0],X=R[1],Q=R[2],le=R[3],ue=R[4],ie=R[5],he=R[6],me=R[7];return R!==C&&(C[8]=R[8],C[9]=R[9],C[10]=R[10],C[11]=R[11],C[12]=R[12],C[13]=R[13],C[14]=R[14],C[15]=R[15]),C[0]=$*I+ue*j,C[1]=X*I+ie*j,C[2]=Q*I+he*j,C[3]=le*I+me*j,C[4]=ue*I-$*j,C[5]=ie*I-X*j,C[6]=he*I-Q*j,C[7]=me*I-le*j,C},ce.fromTranslation=function(C,R){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=R[0],C[13]=R[1],C[14]=R[2],C[15]=1,C},ce.fromScaling=function(C,R){return C[0]=R[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=R[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=R[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ce.fromRotation=function(C,R,L){var j,I,$,X=L[0],Q=L[1],le=L[2],ue=Math.hypot(X,Q,le);return ue<s.EPSILON?null:(X*=ue=1/ue,Q*=ue,le*=ue,j=Math.sin(R),I=Math.cos(R),C[0]=X*X*($=1-I)+I,C[1]=Q*X*$+le*j,C[2]=le*X*$-Q*j,C[3]=0,C[4]=X*Q*$-le*j,C[5]=Q*Q*$+I,C[6]=le*Q*$+X*j,C[7]=0,C[8]=X*le*$+Q*j,C[9]=Q*le*$-X*j,C[10]=le*le*$+I,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)},ce.fromXRotation=function(C,R){var L=Math.sin(R),j=Math.cos(R);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=j,C[6]=L,C[7]=0,C[8]=0,C[9]=-L,C[10]=j,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ce.fromYRotation=function(C,R){var L=Math.sin(R),j=Math.cos(R);return C[0]=j,C[1]=0,C[2]=-L,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=L,C[9]=0,C[10]=j,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ce.fromZRotation=function(C,R){var L=Math.sin(R),j=Math.cos(R);return C[0]=j,C[1]=L,C[2]=0,C[3]=0,C[4]=-L,C[5]=j,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ce.fromRotationTranslation=m,ce.fromQuat2=function(C,R){var L=new s.ARRAY_TYPE(3),j=-R[0],I=-R[1],$=-R[2],X=R[3],Q=R[4],le=R[5],ue=R[6],ie=R[7],he=j*j+I*I+$*$+X*X;return he>0?(L[0]=2*(Q*X+ie*j+le*$-ue*I)/he,L[1]=2*(le*X+ie*I+ue*j-Q*$)/he,L[2]=2*(ue*X+ie*$+Q*I-le*j)/he):(L[0]=2*(Q*X+ie*j+le*$-ue*I),L[1]=2*(le*X+ie*I+ue*j-Q*$),L[2]=2*(ue*X+ie*$+Q*I-le*j)),m(C,R,L),C},ce.getTranslation=function(C,R){return C[0]=R[12],C[1]=R[13],C[2]=R[14],C},ce.getScaling=x,ce.getRotation=function(C,R){var L=new s.ARRAY_TYPE(3);x(L,R);var j=1/L[0],I=1/L[1],$=1/L[2],X=R[0]*j,Q=R[1]*I,le=R[2]*$,ue=R[4]*j,ie=R[5]*I,he=R[6]*$,me=R[8]*j,we=R[9]*I,Ie=R[10]*$,Ne=X+ie+Ie,Me=0;return Ne>0?(Me=2*Math.sqrt(Ne+1),C[3]=.25*Me,C[0]=(he-we)/Me,C[1]=(me-le)/Me,C[2]=(Q-ue)/Me):X>ie&&X>Ie?(Me=2*Math.sqrt(1+X-ie-Ie),C[3]=(he-we)/Me,C[0]=.25*Me,C[1]=(Q+ue)/Me,C[2]=(me+le)/Me):ie>Ie?(Me=2*Math.sqrt(1+ie-X-Ie),C[3]=(me-le)/Me,C[0]=(Q+ue)/Me,C[1]=.25*Me,C[2]=(he+we)/Me):(Me=2*Math.sqrt(1+Ie-X-ie),C[3]=(Q-ue)/Me,C[0]=(me+le)/Me,C[1]=(he+we)/Me,C[2]=.25*Me),C},ce.fromRotationTranslationScale=function(C,R,L,j){var I=R[0],$=R[1],X=R[2],Q=R[3],le=I+I,ue=$+$,ie=X+X,he=I*le,me=I*ue,we=I*ie,Ie=$*ue,Ne=$*ie,Me=X*ie,Je=Q*le,Fe=Q*ue,tt=Q*ie,st=j[0],nt=j[1],lt=j[2];return C[0]=(1-(Ie+Me))*st,C[1]=(me+tt)*st,C[2]=(we-Fe)*st,C[3]=0,C[4]=(me-tt)*nt,C[5]=(1-(he+Me))*nt,C[6]=(Ne+Je)*nt,C[7]=0,C[8]=(we+Fe)*lt,C[9]=(Ne-Je)*lt,C[10]=(1-(he+Ie))*lt,C[11]=0,C[12]=L[0],C[13]=L[1],C[14]=L[2],C[15]=1,C},ce.fromRotationTranslationScaleOrigin=function(C,R,L,j,I){var $=R[0],X=R[1],Q=R[2],le=R[3],ue=$+$,ie=X+X,he=Q+Q,me=$*ue,we=$*ie,Ie=$*he,Ne=X*ie,Me=X*he,Je=Q*he,Fe=le*ue,tt=le*ie,st=le*he,nt=j[0],lt=j[1],ft=j[2],vt=I[0],ct=I[1],Rt=I[2],$t=(1-(Ne+Je))*nt,Nt=(we+st)*nt,hr=(Ie-tt)*nt,or=(we-st)*lt,Jt=(1-(me+Je))*lt,qt=(Me+Fe)*lt,Er=(Ie+tt)*ft,yr=(Me-Fe)*ft,br=(1-(me+Ne))*ft;return C[0]=$t,C[1]=Nt,C[2]=hr,C[3]=0,C[4]=or,C[5]=Jt,C[6]=qt,C[7]=0,C[8]=Er,C[9]=yr,C[10]=br,C[11]=0,C[12]=L[0]+vt-($t*vt+or*ct+Er*Rt),C[13]=L[1]+ct-(Nt*vt+Jt*ct+yr*Rt),C[14]=L[2]+Rt-(hr*vt+qt*ct+br*Rt),C[15]=1,C},ce.fromQuat=function(C,R){var L=R[0],j=R[1],I=R[2],$=R[3],X=L+L,Q=j+j,le=I+I,ue=L*X,ie=j*X,he=j*Q,me=I*X,we=I*Q,Ie=I*le,Ne=$*X,Me=$*Q,Je=$*le;return C[0]=1-he-Ie,C[1]=ie+Je,C[2]=me-Me,C[3]=0,C[4]=ie-Je,C[5]=1-ue-Ie,C[6]=we+Ne,C[7]=0,C[8]=me+Me,C[9]=we-Ne,C[10]=1-ue-he,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},ce.frustum=function(C,R,L,j,I,$,X){var Q=1/(L-R),le=1/(I-j),ue=1/($-X);return C[0]=2*$*Q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=2*$*le,C[6]=0,C[7]=0,C[8]=(L+R)*Q,C[9]=(I+j)*le,C[10]=(X+$)*ue,C[11]=-1,C[12]=0,C[13]=0,C[14]=X*$*2*ue,C[15]=0,C},ce.perspectiveNO=k,ce.perspectiveZO=function(C,R,L,j,I){var $,X=1/Math.tan(R/2);return C[0]=X/L,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=X,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,I!=null&&I!==1/0?(C[10]=I*($=1/(j-I)),C[14]=I*j*$):(C[10]=-1,C[14]=-j),C},ce.perspectiveFromFieldOfView=function(C,R,L,j){var I=Math.tan(R.upDegrees*Math.PI/180),$=Math.tan(R.downDegrees*Math.PI/180),X=Math.tan(R.leftDegrees*Math.PI/180),Q=Math.tan(R.rightDegrees*Math.PI/180),le=2/(X+Q),ue=2/(I+$);return C[0]=le,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=ue,C[6]=0,C[7]=0,C[8]=-(X-Q)*le*.5,C[9]=(I-$)*ue*.5,C[10]=j/(L-j),C[11]=-1,C[12]=0,C[13]=0,C[14]=j*L/(L-j),C[15]=0,C},ce.orthoNO=N,ce.orthoZO=function(C,R,L,j,I,$,X){var Q=1/(R-L),le=1/(j-I),ue=1/($-X);return C[0]=-2*Q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*le,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=ue,C[11]=0,C[12]=(R+L)*Q,C[13]=(I+j)*le,C[14]=$*ue,C[15]=1,C},ce.lookAt=function(C,R,L,j){var I,$,X,Q,le,ue,ie,he,me,we,Ie=R[0],Ne=R[1],Me=R[2],Je=j[0],Fe=j[1],tt=j[2],st=L[0],nt=L[1],lt=L[2];return Math.abs(Ie-st)<s.EPSILON&&Math.abs(Ne-nt)<s.EPSILON&&Math.abs(Me-lt)<s.EPSILON?p(C):(ie=Ie-st,he=Ne-nt,me=Me-lt,I=Fe*(me*=we=1/Math.hypot(ie,he,me))-tt*(he*=we),$=tt*(ie*=we)-Je*me,X=Je*he-Fe*ie,(we=Math.hypot(I,$,X))?(I*=we=1/we,$*=we,X*=we):(I=0,$=0,X=0),Q=he*X-me*$,le=me*I-ie*X,ue=ie*$-he*I,(we=Math.hypot(Q,le,ue))?(Q*=we=1/we,le*=we,ue*=we):(Q=0,le=0,ue=0),C[0]=I,C[1]=Q,C[2]=ie,C[3]=0,C[4]=$,C[5]=le,C[6]=he,C[7]=0,C[8]=X,C[9]=ue,C[10]=me,C[11]=0,C[12]=-(I*Ie+$*Ne+X*Me),C[13]=-(Q*Ie+le*Ne+ue*Me),C[14]=-(ie*Ie+he*Ne+me*Me),C[15]=1,C)},ce.targetTo=function(C,R,L,j){var I=R[0],$=R[1],X=R[2],Q=j[0],le=j[1],ue=j[2],ie=I-L[0],he=$-L[1],me=X-L[2],we=ie*ie+he*he+me*me;we>0&&(ie*=we=1/Math.sqrt(we),he*=we,me*=we);var Ie=le*me-ue*he,Ne=ue*ie-Q*me,Me=Q*he-le*ie;return(we=Ie*Ie+Ne*Ne+Me*Me)>0&&(Ie*=we=1/Math.sqrt(we),Ne*=we,Me*=we),C[0]=Ie,C[1]=Ne,C[2]=Me,C[3]=0,C[4]=he*Me-me*Ne,C[5]=me*Ie-ie*Me,C[6]=ie*Ne-he*Ie,C[7]=0,C[8]=ie,C[9]=he,C[10]=me,C[11]=0,C[12]=I,C[13]=$,C[14]=X,C[15]=1,C},ce.str=function(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"},ce.frob=function(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])},ce.add=function(C,R,L){return C[0]=R[0]+L[0],C[1]=R[1]+L[1],C[2]=R[2]+L[2],C[3]=R[3]+L[3],C[4]=R[4]+L[4],C[5]=R[5]+L[5],C[6]=R[6]+L[6],C[7]=R[7]+L[7],C[8]=R[8]+L[8],C[9]=R[9]+L[9],C[10]=R[10]+L[10],C[11]=R[11]+L[11],C[12]=R[12]+L[12],C[13]=R[13]+L[13],C[14]=R[14]+L[14],C[15]=R[15]+L[15],C},ce.subtract=z,ce.multiplyScalar=function(C,R,L){return C[0]=R[0]*L,C[1]=R[1]*L,C[2]=R[2]*L,C[3]=R[3]*L,C[4]=R[4]*L,C[5]=R[5]*L,C[6]=R[6]*L,C[7]=R[7]*L,C[8]=R[8]*L,C[9]=R[9]*L,C[10]=R[10]*L,C[11]=R[11]*L,C[12]=R[12]*L,C[13]=R[13]*L,C[14]=R[14]*L,C[15]=R[15]*L,C},ce.multiplyScalarAndAdd=function(C,R,L,j){return C[0]=R[0]+L[0]*j,C[1]=R[1]+L[1]*j,C[2]=R[2]+L[2]*j,C[3]=R[3]+L[3]*j,C[4]=R[4]+L[4]*j,C[5]=R[5]+L[5]*j,C[6]=R[6]+L[6]*j,C[7]=R[7]+L[7]*j,C[8]=R[8]+L[8]*j,C[9]=R[9]+L[9]*j,C[10]=R[10]+L[10]*j,C[11]=R[11]+L[11]*j,C[12]=R[12]+L[12]*j,C[13]=R[13]+L[13]*j,C[14]=R[14]+L[14]*j,C[15]=R[15]+L[15]*j,C},ce.exactEquals=function(C,R){return C[0]===R[0]&&C[1]===R[1]&&C[2]===R[2]&&C[3]===R[3]&&C[4]===R[4]&&C[5]===R[5]&&C[6]===R[6]&&C[7]===R[7]&&C[8]===R[8]&&C[9]===R[9]&&C[10]===R[10]&&C[11]===R[11]&&C[12]===R[12]&&C[13]===R[13]&&C[14]===R[14]&&C[15]===R[15]},ce.equals=function(C,R){var L=C[0],j=C[1],I=C[2],$=C[3],X=C[4],Q=C[5],le=C[6],ue=C[7],ie=C[8],he=C[9],me=C[10],we=C[11],Ie=C[12],Ne=C[13],Me=C[14],Je=C[15],Fe=R[0],tt=R[1],st=R[2],nt=R[3],lt=R[4],ft=R[5],vt=R[6],ct=R[7],Rt=R[8],$t=R[9],Nt=R[10],hr=R[11],or=R[12],Jt=R[13],qt=R[14],Er=R[15];return Math.abs(L-Fe)<=s.EPSILON*Math.max(1,Math.abs(L),Math.abs(Fe))&&Math.abs(j-tt)<=s.EPSILON*Math.max(1,Math.abs(j),Math.abs(tt))&&Math.abs(I-st)<=s.EPSILON*Math.max(1,Math.abs(I),Math.abs(st))&&Math.abs($-nt)<=s.EPSILON*Math.max(1,Math.abs($),Math.abs(nt))&&Math.abs(X-lt)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(lt))&&Math.abs(Q-ft)<=s.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ft))&&Math.abs(le-vt)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(vt))&&Math.abs(ue-ct)<=s.EPSILON*Math.max(1,Math.abs(ue),Math.abs(ct))&&Math.abs(ie-Rt)<=s.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Rt))&&Math.abs(he-$t)<=s.EPSILON*Math.max(1,Math.abs(he),Math.abs($t))&&Math.abs(me-Nt)<=s.EPSILON*Math.max(1,Math.abs(me),Math.abs(Nt))&&Math.abs(we-hr)<=s.EPSILON*Math.max(1,Math.abs(we),Math.abs(hr))&&Math.abs(Ie-or)<=s.EPSILON*Math.max(1,Math.abs(Ie),Math.abs(or))&&Math.abs(Ne-Jt)<=s.EPSILON*Math.max(1,Math.abs(Ne),Math.abs(Jt))&&Math.abs(Me-qt)<=s.EPSILON*Math.max(1,Math.abs(Me),Math.abs(qt))&&Math.abs(Je-Er)<=s.EPSILON*Math.max(1,Math.abs(Je),Math.abs(Er))},ce.sub=ce.mul=ce.ortho=ce.perspective=void 0;var s=function(C,R){if(C&&C.__esModule)return C;if(C===null||h(C)!=="object"&&typeof C!="function")return{default:C};var L=c(void 0);if(L&&L.has(C))return L.get(C);var j={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in C)if($!=="default"&&Object.prototype.hasOwnProperty.call(C,$)){var X=I?Object.getOwnPropertyDescriptor(C,$):null;X&&(X.get||X.set)?Object.defineProperty(j,$,X):j[$]=C[$]}return j.default=C,L&&L.set(C,j),j}(O());function c(C){if(typeof WeakMap!="function")return null;var R=new WeakMap,L=new WeakMap;return(c=function(j){return j?L:R})(C)}function p(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function v(C,R,L){var j=R[0],I=R[1],$=R[2],X=R[3],Q=R[4],le=R[5],ue=R[6],ie=R[7],he=R[8],me=R[9],we=R[10],Ie=R[11],Ne=R[12],Me=R[13],Je=R[14],Fe=R[15],tt=L[0],st=L[1],nt=L[2],lt=L[3];return C[0]=tt*j+st*Q+nt*he+lt*Ne,C[1]=tt*I+st*le+nt*me+lt*Me,C[2]=tt*$+st*ue+nt*we+lt*Je,C[3]=tt*X+st*ie+nt*Ie+lt*Fe,C[4]=(tt=L[4])*j+(st=L[5])*Q+(nt=L[6])*he+(lt=L[7])*Ne,C[5]=tt*I+st*le+nt*me+lt*Me,C[6]=tt*$+st*ue+nt*we+lt*Je,C[7]=tt*X+st*ie+nt*Ie+lt*Fe,C[8]=(tt=L[8])*j+(st=L[9])*Q+(nt=L[10])*he+(lt=L[11])*Ne,C[9]=tt*I+st*le+nt*me+lt*Me,C[10]=tt*$+st*ue+nt*we+lt*Je,C[11]=tt*X+st*ie+nt*Ie+lt*Fe,C[12]=(tt=L[12])*j+(st=L[13])*Q+(nt=L[14])*he+(lt=L[15])*Ne,C[13]=tt*I+st*le+nt*me+lt*Me,C[14]=tt*$+st*ue+nt*we+lt*Je,C[15]=tt*X+st*ie+nt*Ie+lt*Fe,C}function m(C,R,L){var j=R[0],I=R[1],$=R[2],X=R[3],Q=j+j,le=I+I,ue=$+$,ie=j*Q,he=j*le,me=j*ue,we=I*le,Ie=I*ue,Ne=$*ue,Me=X*Q,Je=X*le,Fe=X*ue;return C[0]=1-(we+Ne),C[1]=he+Fe,C[2]=me-Je,C[3]=0,C[4]=he-Fe,C[5]=1-(ie+Ne),C[6]=Ie+Me,C[7]=0,C[8]=me+Je,C[9]=Ie-Me,C[10]=1-(ie+we),C[11]=0,C[12]=L[0],C[13]=L[1],C[14]=L[2],C[15]=1,C}function x(C,R){var L=R[4],j=R[5],I=R[6],$=R[8],X=R[9],Q=R[10];return C[0]=Math.hypot(R[0],R[1],R[2]),C[1]=Math.hypot(L,j,I),C[2]=Math.hypot($,X,Q),C}function k(C,R,L,j,I){var $,X=1/Math.tan(R/2);return C[0]=X/L,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=X,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,I!=null&&I!==1/0?(C[10]=(I+j)*($=1/(j-I)),C[14]=2*I*j*$):(C[10]=-1,C[14]=-2*j),C}function N(C,R,L,j,I,$,X){var Q=1/(R-L),le=1/(j-I),ue=1/($-X);return C[0]=-2*Q,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*le,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*ue,C[11]=0,C[12]=(R+L)*Q,C[13]=(I+j)*le,C[14]=(X+$)*ue,C[15]=1,C}function z(C,R,L){return C[0]=R[0]-L[0],C[1]=R[1]-L[1],C[2]=R[2]-L[2],C[3]=R[3]-L[3],C[4]=R[4]-L[4],C[5]=R[5]-L[5],C[6]=R[6]-L[6],C[7]=R[7]-L[7],C[8]=R[8]-L[8],C[9]=R[9]-L[9],C[10]=R[10]-L[10],C[11]=R[11]-L[11],C[12]=R[12]-L[12],C[13]=R[13]-L[13],C[14]=R[14]-L[14],C[15]=R[15]-L[15],C}return ce.perspective=k,ce.ortho=N,ce.mul=v,ce.sub=z,ce}var Te,Ae={},_e={};function Ee(){if(Te)return _e;function h(I){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},h(I)}Te=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.create=p,_e.clone=function(I){var $=new s.ARRAY_TYPE(3);return $[0]=I[0],$[1]=I[1],$[2]=I[2],$},_e.length=v,_e.fromValues=function(I,$,X){var Q=new s.ARRAY_TYPE(3);return Q[0]=I,Q[1]=$,Q[2]=X,Q},_e.copy=function(I,$){return I[0]=$[0],I[1]=$[1],I[2]=$[2],I},_e.set=function(I,$,X,Q){return I[0]=$,I[1]=X,I[2]=Q,I},_e.add=function(I,$,X){return I[0]=$[0]+X[0],I[1]=$[1]+X[1],I[2]=$[2]+X[2],I},_e.subtract=m,_e.multiply=x,_e.divide=k,_e.ceil=function(I,$){return I[0]=Math.ceil($[0]),I[1]=Math.ceil($[1]),I[2]=Math.ceil($[2]),I},_e.floor=function(I,$){return I[0]=Math.floor($[0]),I[1]=Math.floor($[1]),I[2]=Math.floor($[2]),I},_e.min=function(I,$,X){return I[0]=Math.min($[0],X[0]),I[1]=Math.min($[1],X[1]),I[2]=Math.min($[2],X[2]),I},_e.max=function(I,$,X){return I[0]=Math.max($[0],X[0]),I[1]=Math.max($[1],X[1]),I[2]=Math.max($[2],X[2]),I},_e.round=function(I,$){return I[0]=Math.round($[0]),I[1]=Math.round($[1]),I[2]=Math.round($[2]),I},_e.scale=function(I,$,X){return I[0]=$[0]*X,I[1]=$[1]*X,I[2]=$[2]*X,I},_e.scaleAndAdd=function(I,$,X,Q){return I[0]=$[0]+X[0]*Q,I[1]=$[1]+X[1]*Q,I[2]=$[2]+X[2]*Q,I},_e.distance=N,_e.squaredDistance=z,_e.squaredLength=C,_e.negate=function(I,$){return I[0]=-$[0],I[1]=-$[1],I[2]=-$[2],I},_e.inverse=function(I,$){return I[0]=1/$[0],I[1]=1/$[1],I[2]=1/$[2],I},_e.normalize=function(I,$){var X=$[0],Q=$[1],le=$[2],ue=X*X+Q*Q+le*le;return ue>0&&(ue=1/Math.sqrt(ue)),I[0]=$[0]*ue,I[1]=$[1]*ue,I[2]=$[2]*ue,I},_e.dot=R,_e.cross=function(I,$,X){var Q=$[0],le=$[1],ue=$[2],ie=X[0],he=X[1],me=X[2];return I[0]=le*me-ue*he,I[1]=ue*ie-Q*me,I[2]=Q*he-le*ie,I},_e.lerp=function(I,$,X,Q){var le=$[0],ue=$[1],ie=$[2];return I[0]=le+Q*(X[0]-le),I[1]=ue+Q*(X[1]-ue),I[2]=ie+Q*(X[2]-ie),I},_e.hermite=function(I,$,X,Q,le,ue){var ie=ue*ue,he=ie*(2*ue-3)+1,me=ie*(ue-2)+ue,we=ie*(ue-1),Ie=ie*(3-2*ue);return I[0]=$[0]*he+X[0]*me+Q[0]*we+le[0]*Ie,I[1]=$[1]*he+X[1]*me+Q[1]*we+le[1]*Ie,I[2]=$[2]*he+X[2]*me+Q[2]*we+le[2]*Ie,I},_e.bezier=function(I,$,X,Q,le,ue){var ie=1-ue,he=ie*ie,me=ue*ue,we=he*ie,Ie=3*ue*he,Ne=3*me*ie,Me=me*ue;return I[0]=$[0]*we+X[0]*Ie+Q[0]*Ne+le[0]*Me,I[1]=$[1]*we+X[1]*Ie+Q[1]*Ne+le[1]*Me,I[2]=$[2]*we+X[2]*Ie+Q[2]*Ne+le[2]*Me,I},_e.random=function(I,$){$=$||1;var X=2*s.RANDOM()*Math.PI,Q=2*s.RANDOM()-1,le=Math.sqrt(1-Q*Q)*$;return I[0]=Math.cos(X)*le,I[1]=Math.sin(X)*le,I[2]=Q*$,I},_e.transformMat4=function(I,$,X){var Q=$[0],le=$[1],ue=$[2],ie=X[3]*Q+X[7]*le+X[11]*ue+X[15];return I[0]=(X[0]*Q+X[4]*le+X[8]*ue+X[12])/(ie=ie||1),I[1]=(X[1]*Q+X[5]*le+X[9]*ue+X[13])/ie,I[2]=(X[2]*Q+X[6]*le+X[10]*ue+X[14])/ie,I},_e.transformMat3=function(I,$,X){var Q=$[0],le=$[1],ue=$[2];return I[0]=Q*X[0]+le*X[3]+ue*X[6],I[1]=Q*X[1]+le*X[4]+ue*X[7],I[2]=Q*X[2]+le*X[5]+ue*X[8],I},_e.transformQuat=function(I,$,X){var Q=X[0],le=X[1],ue=X[2],ie=$[0],he=$[1],me=$[2],we=le*me-ue*he,Ie=ue*ie-Q*me,Ne=Q*he-le*ie,Me=le*Ne-ue*Ie,Je=ue*we-Q*Ne,Fe=Q*Ie-le*we,tt=2*X[3];return Ie*=tt,Ne*=tt,Je*=2,Fe*=2,I[0]=ie+(we*=tt)+(Me*=2),I[1]=he+Ie+Je,I[2]=me+Ne+Fe,I},_e.rotateX=function(I,$,X,Q){var le=[],ue=[];return le[0]=$[0]-X[0],le[1]=$[1]-X[1],le[2]=$[2]-X[2],ue[0]=le[0],ue[1]=le[1]*Math.cos(Q)-le[2]*Math.sin(Q),ue[2]=le[1]*Math.sin(Q)+le[2]*Math.cos(Q),I[0]=ue[0]+X[0],I[1]=ue[1]+X[1],I[2]=ue[2]+X[2],I},_e.rotateY=function(I,$,X,Q){var le=[],ue=[];return le[0]=$[0]-X[0],le[1]=$[1]-X[1],le[2]=$[2]-X[2],ue[0]=le[2]*Math.sin(Q)+le[0]*Math.cos(Q),ue[1]=le[1],ue[2]=le[2]*Math.cos(Q)-le[0]*Math.sin(Q),I[0]=ue[0]+X[0],I[1]=ue[1]+X[1],I[2]=ue[2]+X[2],I},_e.rotateZ=function(I,$,X,Q){var le=[],ue=[];return le[0]=$[0]-X[0],le[1]=$[1]-X[1],le[2]=$[2]-X[2],ue[0]=le[0]*Math.cos(Q)-le[1]*Math.sin(Q),ue[1]=le[0]*Math.sin(Q)+le[1]*Math.cos(Q),ue[2]=le[2],I[0]=ue[0]+X[0],I[1]=ue[1]+X[1],I[2]=ue[2]+X[2],I},_e.angle=function(I,$){var X=I[0],Q=I[1],le=I[2],ue=$[0],ie=$[1],he=$[2],me=Math.sqrt(X*X+Q*Q+le*le)*Math.sqrt(ue*ue+ie*ie+he*he),we=me&&R(I,$)/me;return Math.acos(Math.min(Math.max(we,-1),1))},_e.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I},_e.str=function(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"},_e.exactEquals=function(I,$){return I[0]===$[0]&&I[1]===$[1]&&I[2]===$[2]},_e.equals=function(I,$){var X=I[0],Q=I[1],le=I[2],ue=$[0],ie=$[1],he=$[2];return Math.abs(X-ue)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ue))&&Math.abs(Q-ie)<=s.EPSILON*Math.max(1,Math.abs(Q),Math.abs(ie))&&Math.abs(le-he)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(he))},_e.forEach=_e.sqrLen=_e.len=_e.sqrDist=_e.dist=_e.div=_e.mul=_e.sub=void 0;var s=function(I,$){if(I&&I.__esModule)return I;if(I===null||h(I)!=="object"&&typeof I!="function")return{default:I};var X=c(void 0);if(X&&X.has(I))return X.get(I);var Q={},le=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in I)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(I,ue)){var ie=le?Object.getOwnPropertyDescriptor(I,ue):null;ie&&(ie.get||ie.set)?Object.defineProperty(Q,ue,ie):Q[ue]=I[ue]}return Q.default=I,X&&X.set(I,Q),Q}(O());function c(I){if(typeof WeakMap!="function")return null;var $=new WeakMap,X=new WeakMap;return(c=function(Q){return Q?X:$})(I)}function p(){var I=new s.ARRAY_TYPE(3);return s.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function v(I){return Math.hypot(I[0],I[1],I[2])}function m(I,$,X){return I[0]=$[0]-X[0],I[1]=$[1]-X[1],I[2]=$[2]-X[2],I}function x(I,$,X){return I[0]=$[0]*X[0],I[1]=$[1]*X[1],I[2]=$[2]*X[2],I}function k(I,$,X){return I[0]=$[0]/X[0],I[1]=$[1]/X[1],I[2]=$[2]/X[2],I}function N(I,$){return Math.hypot($[0]-I[0],$[1]-I[1],$[2]-I[2])}function z(I,$){var X=$[0]-I[0],Q=$[1]-I[1],le=$[2]-I[2];return X*X+Q*Q+le*le}function C(I){var $=I[0],X=I[1],Q=I[2];return $*$+X*X+Q*Q}function R(I,$){return I[0]*$[0]+I[1]*$[1]+I[2]*$[2]}_e.sub=m,_e.mul=x,_e.div=k,_e.dist=N,_e.sqrDist=z,_e.len=v,_e.sqrLen=C;var L,j=(L=p(),function(I,$,X,Q,le,ue){var ie,he;for($||($=3),X||(X=0),he=Q?Math.min(Q*$+X,I.length):I.length,ie=X;ie<he;ie+=$)L[0]=I[ie],L[1]=I[ie+1],L[2]=I[ie+2],le(L,L,ue),I[ie]=L[0],I[ie+1]=L[1],I[ie+2]=L[2];return I});return _e.forEach=j,_e}var ke,Qe,Ze={};function Ge(){if(ke)return Ze;function h(j){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},h(j)}ke=1,Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.create=p,Ze.clone=function(j){var I=new s.ARRAY_TYPE(4);return I[0]=j[0],I[1]=j[1],I[2]=j[2],I[3]=j[3],I},Ze.fromValues=function(j,I,$,X){var Q=new s.ARRAY_TYPE(4);return Q[0]=j,Q[1]=I,Q[2]=$,Q[3]=X,Q},Ze.copy=function(j,I){return j[0]=I[0],j[1]=I[1],j[2]=I[2],j[3]=I[3],j},Ze.set=function(j,I,$,X,Q){return j[0]=I,j[1]=$,j[2]=X,j[3]=Q,j},Ze.add=function(j,I,$){return j[0]=I[0]+$[0],j[1]=I[1]+$[1],j[2]=I[2]+$[2],j[3]=I[3]+$[3],j},Ze.subtract=v,Ze.multiply=m,Ze.divide=x,Ze.ceil=function(j,I){return j[0]=Math.ceil(I[0]),j[1]=Math.ceil(I[1]),j[2]=Math.ceil(I[2]),j[3]=Math.ceil(I[3]),j},Ze.floor=function(j,I){return j[0]=Math.floor(I[0]),j[1]=Math.floor(I[1]),j[2]=Math.floor(I[2]),j[3]=Math.floor(I[3]),j},Ze.min=function(j,I,$){return j[0]=Math.min(I[0],$[0]),j[1]=Math.min(I[1],$[1]),j[2]=Math.min(I[2],$[2]),j[3]=Math.min(I[3],$[3]),j},Ze.max=function(j,I,$){return j[0]=Math.max(I[0],$[0]),j[1]=Math.max(I[1],$[1]),j[2]=Math.max(I[2],$[2]),j[3]=Math.max(I[3],$[3]),j},Ze.round=function(j,I){return j[0]=Math.round(I[0]),j[1]=Math.round(I[1]),j[2]=Math.round(I[2]),j[3]=Math.round(I[3]),j},Ze.scale=function(j,I,$){return j[0]=I[0]*$,j[1]=I[1]*$,j[2]=I[2]*$,j[3]=I[3]*$,j},Ze.scaleAndAdd=function(j,I,$,X){return j[0]=I[0]+$[0]*X,j[1]=I[1]+$[1]*X,j[2]=I[2]+$[2]*X,j[3]=I[3]+$[3]*X,j},Ze.distance=k,Ze.squaredDistance=N,Ze.length=z,Ze.squaredLength=C,Ze.negate=function(j,I){return j[0]=-I[0],j[1]=-I[1],j[2]=-I[2],j[3]=-I[3],j},Ze.inverse=function(j,I){return j[0]=1/I[0],j[1]=1/I[1],j[2]=1/I[2],j[3]=1/I[3],j},Ze.normalize=function(j,I){var $=I[0],X=I[1],Q=I[2],le=I[3],ue=$*$+X*X+Q*Q+le*le;return ue>0&&(ue=1/Math.sqrt(ue)),j[0]=$*ue,j[1]=X*ue,j[2]=Q*ue,j[3]=le*ue,j},Ze.dot=function(j,I){return j[0]*I[0]+j[1]*I[1]+j[2]*I[2]+j[3]*I[3]},Ze.cross=function(j,I,$,X){var Q=$[0]*X[1]-$[1]*X[0],le=$[0]*X[2]-$[2]*X[0],ue=$[0]*X[3]-$[3]*X[0],ie=$[1]*X[2]-$[2]*X[1],he=$[1]*X[3]-$[3]*X[1],me=$[2]*X[3]-$[3]*X[2],we=I[0],Ie=I[1],Ne=I[2],Me=I[3];return j[0]=Ie*me-Ne*he+Me*ie,j[1]=-we*me+Ne*ue-Me*le,j[2]=we*he-Ie*ue+Me*Q,j[3]=-we*ie+Ie*le-Ne*Q,j},Ze.lerp=function(j,I,$,X){var Q=I[0],le=I[1],ue=I[2],ie=I[3];return j[0]=Q+X*($[0]-Q),j[1]=le+X*($[1]-le),j[2]=ue+X*($[2]-ue),j[3]=ie+X*($[3]-ie),j},Ze.random=function(j,I){var $,X,Q,le,ue,ie;I=I||1;do ue=($=2*s.RANDOM()-1)*$+(X=2*s.RANDOM()-1)*X;while(ue>=1);do ie=(Q=2*s.RANDOM()-1)*Q+(le=2*s.RANDOM()-1)*le;while(ie>=1);var he=Math.sqrt((1-ue)/ie);return j[0]=I*$,j[1]=I*X,j[2]=I*Q*he,j[3]=I*le*he,j},Ze.transformMat4=function(j,I,$){var X=I[0],Q=I[1],le=I[2],ue=I[3];return j[0]=$[0]*X+$[4]*Q+$[8]*le+$[12]*ue,j[1]=$[1]*X+$[5]*Q+$[9]*le+$[13]*ue,j[2]=$[2]*X+$[6]*Q+$[10]*le+$[14]*ue,j[3]=$[3]*X+$[7]*Q+$[11]*le+$[15]*ue,j},Ze.transformQuat=function(j,I,$){var X=I[0],Q=I[1],le=I[2],ue=$[0],ie=$[1],he=$[2],me=$[3],we=me*X+ie*le-he*Q,Ie=me*Q+he*X-ue*le,Ne=me*le+ue*Q-ie*X,Me=-ue*X-ie*Q-he*le;return j[0]=we*me+Me*-ue+Ie*-he-Ne*-ie,j[1]=Ie*me+Me*-ie+Ne*-ue-we*-he,j[2]=Ne*me+Me*-he+we*-ie-Ie*-ue,j[3]=I[3],j},Ze.zero=function(j){return j[0]=0,j[1]=0,j[2]=0,j[3]=0,j},Ze.str=function(j){return"vec4("+j[0]+", "+j[1]+", "+j[2]+", "+j[3]+")"},Ze.exactEquals=function(j,I){return j[0]===I[0]&&j[1]===I[1]&&j[2]===I[2]&&j[3]===I[3]},Ze.equals=function(j,I){var $=j[0],X=j[1],Q=j[2],le=j[3],ue=I[0],ie=I[1],he=I[2],me=I[3];return Math.abs($-ue)<=s.EPSILON*Math.max(1,Math.abs($),Math.abs(ue))&&Math.abs(X-ie)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ie))&&Math.abs(Q-he)<=s.EPSILON*Math.max(1,Math.abs(Q),Math.abs(he))&&Math.abs(le-me)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(me))},Ze.forEach=Ze.sqrLen=Ze.len=Ze.sqrDist=Ze.dist=Ze.div=Ze.mul=Ze.sub=void 0;var s=function(j,I){if(j&&j.__esModule)return j;if(j===null||h(j)!=="object"&&typeof j!="function")return{default:j};var $=c(void 0);if($&&$.has(j))return $.get(j);var X={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in j)if(le!=="default"&&Object.prototype.hasOwnProperty.call(j,le)){var ue=Q?Object.getOwnPropertyDescriptor(j,le):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,le,ue):X[le]=j[le]}return X.default=j,$&&$.set(j,X),X}(O());function c(j){if(typeof WeakMap!="function")return null;var I=new WeakMap,$=new WeakMap;return(c=function(X){return X?$:I})(j)}function p(){var j=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(j[0]=0,j[1]=0,j[2]=0,j[3]=0),j}function v(j,I,$){return j[0]=I[0]-$[0],j[1]=I[1]-$[1],j[2]=I[2]-$[2],j[3]=I[3]-$[3],j}function m(j,I,$){return j[0]=I[0]*$[0],j[1]=I[1]*$[1],j[2]=I[2]*$[2],j[3]=I[3]*$[3],j}function x(j,I,$){return j[0]=I[0]/$[0],j[1]=I[1]/$[1],j[2]=I[2]/$[2],j[3]=I[3]/$[3],j}function k(j,I){return Math.hypot(I[0]-j[0],I[1]-j[1],I[2]-j[2],I[3]-j[3])}function N(j,I){var $=I[0]-j[0],X=I[1]-j[1],Q=I[2]-j[2],le=I[3]-j[3];return $*$+X*X+Q*Q+le*le}function z(j){return Math.hypot(j[0],j[1],j[2],j[3])}function C(j){var I=j[0],$=j[1],X=j[2],Q=j[3];return I*I+$*$+X*X+Q*Q}Ze.sub=v,Ze.mul=m,Ze.div=x,Ze.dist=k,Ze.sqrDist=N,Ze.len=z,Ze.sqrLen=C;var R,L=(R=p(),function(j,I,$,X,Q,le){var ue,ie;for(I||(I=4),$||($=0),ie=X?Math.min(X*I+$,j.length):j.length,ue=$;ue<ie;ue+=I)R[0]=j[ue],R[1]=j[ue+1],R[2]=j[ue+2],R[3]=j[ue+3],Q(R,R,le),j[ue]=R[0],j[ue+1]=R[1],j[ue+2]=R[2],j[ue+3]=R[3];return j});return Ze.forEach=L,Ze}function Oe(){if(Qe)return Ae;function h(Fe){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(tt){return typeof tt}:function(tt){return tt&&typeof Symbol=="function"&&tt.constructor===Symbol&&tt!==Symbol.prototype?"symbol":typeof tt},h(Fe)}Qe=1,Object.defineProperty(Ae,"__esModule",{value:!0}),Ae.create=k,Ae.identity=function(Fe){return Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=1,Fe},Ae.setAxisAngle=N,Ae.getAxisAngle=function(Fe,tt){var st=2*Math.acos(tt[3]),nt=Math.sin(st/2);return nt>s.EPSILON?(Fe[0]=tt[0]/nt,Fe[1]=tt[1]/nt,Fe[2]=tt[2]/nt):(Fe[0]=1,Fe[1]=0,Fe[2]=0),st},Ae.getAngle=function(Fe,tt){var st=$(Fe,tt);return Math.acos(2*st*st-1)},Ae.multiply=z,Ae.rotateX=function(Fe,tt,st){st*=.5;var nt=tt[0],lt=tt[1],ft=tt[2],vt=tt[3],ct=Math.sin(st),Rt=Math.cos(st);return Fe[0]=nt*Rt+vt*ct,Fe[1]=lt*Rt+ft*ct,Fe[2]=ft*Rt-lt*ct,Fe[3]=vt*Rt-nt*ct,Fe},Ae.rotateY=function(Fe,tt,st){st*=.5;var nt=tt[0],lt=tt[1],ft=tt[2],vt=tt[3],ct=Math.sin(st),Rt=Math.cos(st);return Fe[0]=nt*Rt-ft*ct,Fe[1]=lt*Rt+vt*ct,Fe[2]=ft*Rt+nt*ct,Fe[3]=vt*Rt-lt*ct,Fe},Ae.rotateZ=function(Fe,tt,st){st*=.5;var nt=tt[0],lt=tt[1],ft=tt[2],vt=tt[3],ct=Math.sin(st),Rt=Math.cos(st);return Fe[0]=nt*Rt+lt*ct,Fe[1]=lt*Rt-nt*ct,Fe[2]=ft*Rt+vt*ct,Fe[3]=vt*Rt-ft*ct,Fe},Ae.calculateW=function(Fe,tt){var st=tt[0],nt=tt[1],lt=tt[2];return Fe[0]=st,Fe[1]=nt,Fe[2]=lt,Fe[3]=Math.sqrt(Math.abs(1-st*st-nt*nt-lt*lt)),Fe},Ae.exp=C,Ae.ln=R,Ae.pow=function(Fe,tt,st){return R(Fe,tt),I(Fe,Fe,st),C(Fe,Fe),Fe},Ae.slerp=L,Ae.random=function(Fe){var tt=s.RANDOM(),st=s.RANDOM(),nt=s.RANDOM(),lt=Math.sqrt(1-tt),ft=Math.sqrt(tt);return Fe[0]=lt*Math.sin(2*Math.PI*st),Fe[1]=lt*Math.cos(2*Math.PI*st),Fe[2]=ft*Math.sin(2*Math.PI*nt),Fe[3]=ft*Math.cos(2*Math.PI*nt),Fe},Ae.invert=function(Fe,tt){var st=tt[0],nt=tt[1],lt=tt[2],ft=tt[3],vt=st*st+nt*nt+lt*lt+ft*ft,ct=vt?1/vt:0;return Fe[0]=-st*ct,Fe[1]=-nt*ct,Fe[2]=-lt*ct,Fe[3]=ft*ct,Fe},Ae.conjugate=function(Fe,tt){return Fe[0]=-tt[0],Fe[1]=-tt[1],Fe[2]=-tt[2],Fe[3]=tt[3],Fe},Ae.fromMat3=j,Ae.fromEuler=function(Fe,tt,st,nt){var lt=.5*Math.PI/180;tt*=lt,st*=lt,nt*=lt;var ft=Math.sin(tt),vt=Math.cos(tt),ct=Math.sin(st),Rt=Math.cos(st),$t=Math.sin(nt),Nt=Math.cos(nt);return Fe[0]=ft*Rt*Nt-vt*ct*$t,Fe[1]=vt*ct*Nt+ft*Rt*$t,Fe[2]=vt*Rt*$t-ft*ct*Nt,Fe[3]=vt*Rt*Nt+ft*ct*$t,Fe},Ae.str=function(Fe){return"quat("+Fe[0]+", "+Fe[1]+", "+Fe[2]+", "+Fe[3]+")"},Ae.setAxes=Ae.sqlerp=Ae.rotationTo=Ae.equals=Ae.exactEquals=Ae.normalize=Ae.sqrLen=Ae.squaredLength=Ae.len=Ae.length=Ae.lerp=Ae.dot=Ae.scale=Ae.mul=Ae.add=Ae.set=Ae.copy=Ae.fromValues=Ae.clone=void 0;var s=x(O()),c=x(ee()),p=x(Ee()),v=x(Ge());function m(Fe){if(typeof WeakMap!="function")return null;var tt=new WeakMap,st=new WeakMap;return(m=function(nt){return nt?st:tt})(Fe)}function x(Fe,tt){if(Fe&&Fe.__esModule)return Fe;if(Fe===null||h(Fe)!=="object"&&typeof Fe!="function")return{default:Fe};var st=m(tt);if(st&&st.has(Fe))return st.get(Fe);var nt={},lt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ft in Fe)if(ft!=="default"&&Object.prototype.hasOwnProperty.call(Fe,ft)){var vt=lt?Object.getOwnPropertyDescriptor(Fe,ft):null;vt&&(vt.get||vt.set)?Object.defineProperty(nt,ft,vt):nt[ft]=Fe[ft]}return nt.default=Fe,st&&st.set(Fe,nt),nt}function k(){var Fe=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0),Fe[3]=1,Fe}function N(Fe,tt,st){st*=.5;var nt=Math.sin(st);return Fe[0]=nt*tt[0],Fe[1]=nt*tt[1],Fe[2]=nt*tt[2],Fe[3]=Math.cos(st),Fe}function z(Fe,tt,st){var nt=tt[0],lt=tt[1],ft=tt[2],vt=tt[3],ct=st[0],Rt=st[1],$t=st[2],Nt=st[3];return Fe[0]=nt*Nt+vt*ct+lt*$t-ft*Rt,Fe[1]=lt*Nt+vt*Rt+ft*ct-nt*$t,Fe[2]=ft*Nt+vt*$t+nt*Rt-lt*ct,Fe[3]=vt*Nt-nt*ct-lt*Rt-ft*$t,Fe}function C(Fe,tt){var st=tt[0],nt=tt[1],lt=tt[2],ft=tt[3],vt=Math.sqrt(st*st+nt*nt+lt*lt),ct=Math.exp(ft),Rt=vt>0?ct*Math.sin(vt)/vt:0;return Fe[0]=st*Rt,Fe[1]=nt*Rt,Fe[2]=lt*Rt,Fe[3]=ct*Math.cos(vt),Fe}function R(Fe,tt){var st=tt[0],nt=tt[1],lt=tt[2],ft=tt[3],vt=Math.sqrt(st*st+nt*nt+lt*lt),ct=vt>0?Math.atan2(vt,ft)/vt:0;return Fe[0]=st*ct,Fe[1]=nt*ct,Fe[2]=lt*ct,Fe[3]=.5*Math.log(st*st+nt*nt+lt*lt+ft*ft),Fe}function L(Fe,tt,st,nt){var lt,ft,vt,ct,Rt,$t=tt[0],Nt=tt[1],hr=tt[2],or=tt[3],Jt=st[0],qt=st[1],Er=st[2],yr=st[3];return(ft=$t*Jt+Nt*qt+hr*Er+or*yr)<0&&(ft=-ft,Jt=-Jt,qt=-qt,Er=-Er,yr=-yr),1-ft>s.EPSILON?(lt=Math.acos(ft),vt=Math.sin(lt),ct=Math.sin((1-nt)*lt)/vt,Rt=Math.sin(nt*lt)/vt):(ct=1-nt,Rt=nt),Fe[0]=ct*$t+Rt*Jt,Fe[1]=ct*Nt+Rt*qt,Fe[2]=ct*hr+Rt*Er,Fe[3]=ct*or+Rt*yr,Fe}function j(Fe,tt){var st,nt=tt[0]+tt[4]+tt[8];if(nt>0)st=Math.sqrt(nt+1),Fe[3]=.5*st,Fe[0]=(tt[5]-tt[7])*(st=.5/st),Fe[1]=(tt[6]-tt[2])*st,Fe[2]=(tt[1]-tt[3])*st;else{var lt=0;tt[4]>tt[0]&&(lt=1),tt[8]>tt[3*lt+lt]&&(lt=2);var ft=(lt+1)%3,vt=(lt+2)%3;st=Math.sqrt(tt[3*lt+lt]-tt[3*ft+ft]-tt[3*vt+vt]+1),Fe[lt]=.5*st,Fe[3]=(tt[3*ft+vt]-tt[3*vt+ft])*(st=.5/st),Fe[ft]=(tt[3*ft+lt]+tt[3*lt+ft])*st,Fe[vt]=(tt[3*vt+lt]+tt[3*lt+vt])*st}return Fe}Ae.clone=v.clone,Ae.fromValues=v.fromValues,Ae.copy=v.copy,Ae.set=v.set,Ae.add=v.add,Ae.mul=z;var I=v.scale;Ae.scale=I;var $=v.dot;Ae.dot=$,Ae.lerp=v.lerp;var X=v.length;Ae.length=X,Ae.len=X;var Q=v.squaredLength;Ae.squaredLength=Q,Ae.sqrLen=Q;var le=v.normalize;Ae.normalize=le,Ae.exactEquals=v.exactEquals,Ae.equals=v.equals;var ue,ie,he,me=(ue=p.create(),ie=p.fromValues(1,0,0),he=p.fromValues(0,1,0),function(Fe,tt,st){var nt=p.dot(tt,st);return nt<-.999999?(p.cross(ue,ie,tt),p.len(ue)<1e-6&&p.cross(ue,he,tt),p.normalize(ue,ue),N(Fe,ue,Math.PI),Fe):nt>.999999?(Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=1,Fe):(p.cross(ue,tt,st),Fe[0]=ue[0],Fe[1]=ue[1],Fe[2]=ue[2],Fe[3]=1+nt,le(Fe,Fe))});Ae.rotationTo=me;var we,Ie,Ne=(we=k(),Ie=k(),function(Fe,tt,st,nt,lt,ft){return L(we,tt,lt,ft),L(Ie,st,nt,ft),L(Fe,we,Ie,2*ft*(1-ft)),Fe});Ae.sqlerp=Ne;var Me,Je=(Me=c.create(),function(Fe,tt,st,nt){return Me[0]=st[0],Me[3]=st[1],Me[6]=st[2],Me[1]=nt[0],Me[4]=nt[1],Me[7]=nt[2],Me[2]=-tt[0],Me[5]=-tt[1],Me[8]=-tt[2],le(Fe,j(Fe,Me))});return Ae.setAxes=Je,Ae}var je,Le={};function ut(){if(je)return Le;function h(L){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},h(L)}je=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.create=function(){var L=new s.ARRAY_TYPE(8);return s.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0,L[4]=0,L[5]=0,L[6]=0,L[7]=0),L[3]=1,L},Le.clone=function(L){var j=new s.ARRAY_TYPE(8);return j[0]=L[0],j[1]=L[1],j[2]=L[2],j[3]=L[3],j[4]=L[4],j[5]=L[5],j[6]=L[6],j[7]=L[7],j},Le.fromValues=function(L,j,I,$,X,Q,le,ue){var ie=new s.ARRAY_TYPE(8);return ie[0]=L,ie[1]=j,ie[2]=I,ie[3]=$,ie[4]=X,ie[5]=Q,ie[6]=le,ie[7]=ue,ie},Le.fromRotationTranslationValues=function(L,j,I,$,X,Q,le){var ue=new s.ARRAY_TYPE(8);ue[0]=L,ue[1]=j,ue[2]=I,ue[3]=$;var ie=.5*X,he=.5*Q,me=.5*le;return ue[4]=ie*$+he*I-me*j,ue[5]=he*$+me*L-ie*I,ue[6]=me*$+ie*j-he*L,ue[7]=-ie*L-he*j-me*I,ue},Le.fromRotationTranslation=x,Le.fromTranslation=function(L,j){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=.5*j[0],L[5]=.5*j[1],L[6]=.5*j[2],L[7]=0,L},Le.fromRotation=function(L,j){return L[0]=j[0],L[1]=j[1],L[2]=j[2],L[3]=j[3],L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},Le.fromMat4=function(L,j){var I=c.create();p.getRotation(I,j);var $=new s.ARRAY_TYPE(3);return p.getTranslation($,j),x(L,I,$),L},Le.copy=k,Le.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},Le.set=function(L,j,I,$,X,Q,le,ue,ie){return L[0]=j,L[1]=I,L[2]=$,L[3]=X,L[4]=Q,L[5]=le,L[6]=ue,L[7]=ie,L},Le.getDual=function(L,j){return L[0]=j[4],L[1]=j[5],L[2]=j[6],L[3]=j[7],L},Le.setDual=function(L,j){return L[4]=j[0],L[5]=j[1],L[6]=j[2],L[7]=j[3],L},Le.getTranslation=function(L,j){var I=j[4],$=j[5],X=j[6],Q=j[7],le=-j[0],ue=-j[1],ie=-j[2],he=j[3];return L[0]=2*(I*he+Q*le+$*ie-X*ue),L[1]=2*($*he+Q*ue+X*le-I*ie),L[2]=2*(X*he+Q*ie+I*ue-$*le),L},Le.translate=function(L,j,I){var $=j[0],X=j[1],Q=j[2],le=j[3],ue=.5*I[0],ie=.5*I[1],he=.5*I[2],me=j[4],we=j[5],Ie=j[6],Ne=j[7];return L[0]=$,L[1]=X,L[2]=Q,L[3]=le,L[4]=le*ue+X*he-Q*ie+me,L[5]=le*ie+Q*ue-$*he+we,L[6]=le*he+$*ie-X*ue+Ie,L[7]=-$*ue-X*ie-Q*he+Ne,L},Le.rotateX=function(L,j,I){var $=-j[0],X=-j[1],Q=-j[2],le=j[3],ue=j[4],ie=j[5],he=j[6],me=j[7],we=ue*le+me*$+ie*Q-he*X,Ie=ie*le+me*X+he*$-ue*Q,Ne=he*le+me*Q+ue*X-ie*$,Me=me*le-ue*$-ie*X-he*Q;return c.rotateX(L,j,I),L[4]=we*(le=L[3])+Me*($=L[0])+Ie*(Q=L[2])-Ne*(X=L[1]),L[5]=Ie*le+Me*X+Ne*$-we*Q,L[6]=Ne*le+Me*Q+we*X-Ie*$,L[7]=Me*le-we*$-Ie*X-Ne*Q,L},Le.rotateY=function(L,j,I){var $=-j[0],X=-j[1],Q=-j[2],le=j[3],ue=j[4],ie=j[5],he=j[6],me=j[7],we=ue*le+me*$+ie*Q-he*X,Ie=ie*le+me*X+he*$-ue*Q,Ne=he*le+me*Q+ue*X-ie*$,Me=me*le-ue*$-ie*X-he*Q;return c.rotateY(L,j,I),L[4]=we*(le=L[3])+Me*($=L[0])+Ie*(Q=L[2])-Ne*(X=L[1]),L[5]=Ie*le+Me*X+Ne*$-we*Q,L[6]=Ne*le+Me*Q+we*X-Ie*$,L[7]=Me*le-we*$-Ie*X-Ne*Q,L},Le.rotateZ=function(L,j,I){var $=-j[0],X=-j[1],Q=-j[2],le=j[3],ue=j[4],ie=j[5],he=j[6],me=j[7],we=ue*le+me*$+ie*Q-he*X,Ie=ie*le+me*X+he*$-ue*Q,Ne=he*le+me*Q+ue*X-ie*$,Me=me*le-ue*$-ie*X-he*Q;return c.rotateZ(L,j,I),L[4]=we*(le=L[3])+Me*($=L[0])+Ie*(Q=L[2])-Ne*(X=L[1]),L[5]=Ie*le+Me*X+Ne*$-we*Q,L[6]=Ne*le+Me*Q+we*X-Ie*$,L[7]=Me*le-we*$-Ie*X-Ne*Q,L},Le.rotateByQuatAppend=function(L,j,I){var $=I[0],X=I[1],Q=I[2],le=I[3],ue=j[0],ie=j[1],he=j[2],me=j[3];return L[0]=ue*le+me*$+ie*Q-he*X,L[1]=ie*le+me*X+he*$-ue*Q,L[2]=he*le+me*Q+ue*X-ie*$,L[3]=me*le-ue*$-ie*X-he*Q,L[4]=(ue=j[4])*le+(me=j[7])*$+(ie=j[5])*Q-(he=j[6])*X,L[5]=ie*le+me*X+he*$-ue*Q,L[6]=he*le+me*Q+ue*X-ie*$,L[7]=me*le-ue*$-ie*X-he*Q,L},Le.rotateByQuatPrepend=function(L,j,I){var $=j[0],X=j[1],Q=j[2],le=j[3],ue=I[0],ie=I[1],he=I[2],me=I[3];return L[0]=$*me+le*ue+X*he-Q*ie,L[1]=X*me+le*ie+Q*ue-$*he,L[2]=Q*me+le*he+$*ie-X*ue,L[3]=le*me-$*ue-X*ie-Q*he,L[4]=$*(me=I[7])+le*(ue=I[4])+X*(he=I[6])-Q*(ie=I[5]),L[5]=X*me+le*ie+Q*ue-$*he,L[6]=Q*me+le*he+$*ie-X*ue,L[7]=le*me-$*ue-X*ie-Q*he,L},Le.rotateAroundAxis=function(L,j,I,$){if(Math.abs($)<s.EPSILON)return k(L,j);var X=Math.hypot(I[0],I[1],I[2]);$*=.5;var Q=Math.sin($),le=Q*I[0]/X,ue=Q*I[1]/X,ie=Q*I[2]/X,he=Math.cos($),me=j[0],we=j[1],Ie=j[2],Ne=j[3];L[0]=me*he+Ne*le+we*ie-Ie*ue,L[1]=we*he+Ne*ue+Ie*le-me*ie,L[2]=Ie*he+Ne*ie+me*ue-we*le,L[3]=Ne*he-me*le-we*ue-Ie*ie;var Me=j[4],Je=j[5],Fe=j[6],tt=j[7];return L[4]=Me*he+tt*le+Je*ie-Fe*ue,L[5]=Je*he+tt*ue+Fe*le-Me*ie,L[6]=Fe*he+tt*ie+Me*ue-Je*le,L[7]=tt*he-Me*le-Je*ue-Fe*ie,L},Le.add=function(L,j,I){return L[0]=j[0]+I[0],L[1]=j[1]+I[1],L[2]=j[2]+I[2],L[3]=j[3]+I[3],L[4]=j[4]+I[4],L[5]=j[5]+I[5],L[6]=j[6]+I[6],L[7]=j[7]+I[7],L},Le.multiply=N,Le.scale=function(L,j,I){return L[0]=j[0]*I,L[1]=j[1]*I,L[2]=j[2]*I,L[3]=j[3]*I,L[4]=j[4]*I,L[5]=j[5]*I,L[6]=j[6]*I,L[7]=j[7]*I,L},Le.lerp=function(L,j,I,$){var X=1-$;return z(j,I)<0&&($=-$),L[0]=j[0]*X+I[0]*$,L[1]=j[1]*X+I[1]*$,L[2]=j[2]*X+I[2]*$,L[3]=j[3]*X+I[3]*$,L[4]=j[4]*X+I[4]*$,L[5]=j[5]*X+I[5]*$,L[6]=j[6]*X+I[6]*$,L[7]=j[7]*X+I[7]*$,L},Le.invert=function(L,j){var I=R(j);return L[0]=-j[0]/I,L[1]=-j[1]/I,L[2]=-j[2]/I,L[3]=j[3]/I,L[4]=-j[4]/I,L[5]=-j[5]/I,L[6]=-j[6]/I,L[7]=j[7]/I,L},Le.conjugate=function(L,j){return L[0]=-j[0],L[1]=-j[1],L[2]=-j[2],L[3]=j[3],L[4]=-j[4],L[5]=-j[5],L[6]=-j[6],L[7]=j[7],L},Le.normalize=function(L,j){var I=R(j);if(I>0){I=Math.sqrt(I);var $=j[0]/I,X=j[1]/I,Q=j[2]/I,le=j[3]/I,ue=j[4],ie=j[5],he=j[6],me=j[7],we=$*ue+X*ie+Q*he+le*me;L[0]=$,L[1]=X,L[2]=Q,L[3]=le,L[4]=(ue-$*we)/I,L[5]=(ie-X*we)/I,L[6]=(he-Q*we)/I,L[7]=(me-le*we)/I}return L},Le.str=function(L){return"quat2("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+")"},Le.exactEquals=function(L,j){return L[0]===j[0]&&L[1]===j[1]&&L[2]===j[2]&&L[3]===j[3]&&L[4]===j[4]&&L[5]===j[5]&&L[6]===j[6]&&L[7]===j[7]},Le.equals=function(L,j){var I=L[0],$=L[1],X=L[2],Q=L[3],le=L[4],ue=L[5],ie=L[6],he=L[7],me=j[0],we=j[1],Ie=j[2],Ne=j[3],Me=j[4],Je=j[5],Fe=j[6],tt=j[7];return Math.abs(I-me)<=s.EPSILON*Math.max(1,Math.abs(I),Math.abs(me))&&Math.abs($-we)<=s.EPSILON*Math.max(1,Math.abs($),Math.abs(we))&&Math.abs(X-Ie)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(Ie))&&Math.abs(Q-Ne)<=s.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Ne))&&Math.abs(le-Me)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(Me))&&Math.abs(ue-Je)<=s.EPSILON*Math.max(1,Math.abs(ue),Math.abs(Je))&&Math.abs(ie-Fe)<=s.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Fe))&&Math.abs(he-tt)<=s.EPSILON*Math.max(1,Math.abs(he),Math.abs(tt))},Le.sqrLen=Le.squaredLength=Le.len=Le.length=Le.dot=Le.mul=Le.setReal=Le.getReal=void 0;var s=m(O()),c=m(Oe()),p=m(ge());function v(L){if(typeof WeakMap!="function")return null;var j=new WeakMap,I=new WeakMap;return(v=function($){return $?I:j})(L)}function m(L,j){if(L&&L.__esModule)return L;if(L===null||h(L)!=="object"&&typeof L!="function")return{default:L};var I=v(j);if(I&&I.has(L))return I.get(L);var $={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Q in L)if(Q!=="default"&&Object.prototype.hasOwnProperty.call(L,Q)){var le=X?Object.getOwnPropertyDescriptor(L,Q):null;le&&(le.get||le.set)?Object.defineProperty($,Q,le):$[Q]=L[Q]}return $.default=L,I&&I.set(L,$),$}function x(L,j,I){var $=.5*I[0],X=.5*I[1],Q=.5*I[2],le=j[0],ue=j[1],ie=j[2],he=j[3];return L[0]=le,L[1]=ue,L[2]=ie,L[3]=he,L[4]=$*he+X*ie-Q*ue,L[5]=X*he+Q*le-$*ie,L[6]=Q*he+$*ue-X*le,L[7]=-$*le-X*ue-Q*ie,L}function k(L,j){return L[0]=j[0],L[1]=j[1],L[2]=j[2],L[3]=j[3],L[4]=j[4],L[5]=j[5],L[6]=j[6],L[7]=j[7],L}function N(L,j,I){var $=j[0],X=j[1],Q=j[2],le=j[3],ue=I[4],ie=I[5],he=I[6],me=I[7],we=j[4],Ie=j[5],Ne=j[6],Me=j[7],Je=I[0],Fe=I[1],tt=I[2],st=I[3];return L[0]=$*st+le*Je+X*tt-Q*Fe,L[1]=X*st+le*Fe+Q*Je-$*tt,L[2]=Q*st+le*tt+$*Fe-X*Je,L[3]=le*st-$*Je-X*Fe-Q*tt,L[4]=$*me+le*ue+X*he-Q*ie+we*st+Me*Je+Ie*tt-Ne*Fe,L[5]=X*me+le*ie+Q*ue-$*he+Ie*st+Me*Fe+Ne*Je-we*tt,L[6]=Q*me+le*he+$*ie-X*ue+Ne*st+Me*tt+we*Fe-Ie*Je,L[7]=le*me-$*ue-X*ie-Q*he+Me*st-we*Je-Ie*Fe-Ne*tt,L}Le.getReal=c.copy,Le.setReal=c.copy,Le.mul=N;var z=c.dot;Le.dot=z;var C=c.length;Le.length=C,Le.len=C;var R=c.squaredLength;return Le.squaredLength=R,Le.sqrLen=R,Le}var ze,ht,rt={};function Qt(){if(ze)return rt;function h(j){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},h(j)}ze=1,Object.defineProperty(rt,"__esModule",{value:!0}),rt.create=p,rt.clone=function(j){var I=new s.ARRAY_TYPE(2);return I[0]=j[0],I[1]=j[1],I},rt.fromValues=function(j,I){var $=new s.ARRAY_TYPE(2);return $[0]=j,$[1]=I,$},rt.copy=function(j,I){return j[0]=I[0],j[1]=I[1],j},rt.set=function(j,I,$){return j[0]=I,j[1]=$,j},rt.add=function(j,I,$){return j[0]=I[0]+$[0],j[1]=I[1]+$[1],j},rt.subtract=v,rt.multiply=m,rt.divide=x,rt.ceil=function(j,I){return j[0]=Math.ceil(I[0]),j[1]=Math.ceil(I[1]),j},rt.floor=function(j,I){return j[0]=Math.floor(I[0]),j[1]=Math.floor(I[1]),j},rt.min=function(j,I,$){return j[0]=Math.min(I[0],$[0]),j[1]=Math.min(I[1],$[1]),j},rt.max=function(j,I,$){return j[0]=Math.max(I[0],$[0]),j[1]=Math.max(I[1],$[1]),j},rt.round=function(j,I){return j[0]=Math.round(I[0]),j[1]=Math.round(I[1]),j},rt.scale=function(j,I,$){return j[0]=I[0]*$,j[1]=I[1]*$,j},rt.scaleAndAdd=function(j,I,$,X){return j[0]=I[0]+$[0]*X,j[1]=I[1]+$[1]*X,j},rt.distance=k,rt.squaredDistance=N,rt.length=z,rt.squaredLength=C,rt.negate=function(j,I){return j[0]=-I[0],j[1]=-I[1],j},rt.inverse=function(j,I){return j[0]=1/I[0],j[1]=1/I[1],j},rt.normalize=function(j,I){var $=I[0],X=I[1],Q=$*$+X*X;return Q>0&&(Q=1/Math.sqrt(Q)),j[0]=I[0]*Q,j[1]=I[1]*Q,j},rt.dot=function(j,I){return j[0]*I[0]+j[1]*I[1]},rt.cross=function(j,I,$){var X=I[0]*$[1]-I[1]*$[0];return j[0]=j[1]=0,j[2]=X,j},rt.lerp=function(j,I,$,X){var Q=I[0],le=I[1];return j[0]=Q+X*($[0]-Q),j[1]=le+X*($[1]-le),j},rt.random=function(j,I){I=I||1;var $=2*s.RANDOM()*Math.PI;return j[0]=Math.cos($)*I,j[1]=Math.sin($)*I,j},rt.transformMat2=function(j,I,$){var X=I[0],Q=I[1];return j[0]=$[0]*X+$[2]*Q,j[1]=$[1]*X+$[3]*Q,j},rt.transformMat2d=function(j,I,$){var X=I[0],Q=I[1];return j[0]=$[0]*X+$[2]*Q+$[4],j[1]=$[1]*X+$[3]*Q+$[5],j},rt.transformMat3=function(j,I,$){var X=I[0],Q=I[1];return j[0]=$[0]*X+$[3]*Q+$[6],j[1]=$[1]*X+$[4]*Q+$[7],j},rt.transformMat4=function(j,I,$){var X=I[0],Q=I[1];return j[0]=$[0]*X+$[4]*Q+$[12],j[1]=$[1]*X+$[5]*Q+$[13],j},rt.rotate=function(j,I,$,X){var Q=I[0]-$[0],le=I[1]-$[1],ue=Math.sin(X),ie=Math.cos(X);return j[0]=Q*ie-le*ue+$[0],j[1]=Q*ue+le*ie+$[1],j},rt.angle=function(j,I){var $=j[0],X=j[1],Q=I[0],le=I[1],ue=Math.sqrt($*$+X*X)*Math.sqrt(Q*Q+le*le);return Math.acos(Math.min(Math.max(ue&&($*Q+X*le)/ue,-1),1))},rt.zero=function(j){return j[0]=0,j[1]=0,j},rt.str=function(j){return"vec2("+j[0]+", "+j[1]+")"},rt.exactEquals=function(j,I){return j[0]===I[0]&&j[1]===I[1]},rt.equals=function(j,I){var $=j[0],X=j[1],Q=I[0],le=I[1];return Math.abs($-Q)<=s.EPSILON*Math.max(1,Math.abs($),Math.abs(Q))&&Math.abs(X-le)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(le))},rt.forEach=rt.sqrLen=rt.sqrDist=rt.dist=rt.div=rt.mul=rt.sub=rt.len=void 0;var s=function(j,I){if(j&&j.__esModule)return j;if(j===null||h(j)!=="object"&&typeof j!="function")return{default:j};var $=c(void 0);if($&&$.has(j))return $.get(j);var X={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in j)if(le!=="default"&&Object.prototype.hasOwnProperty.call(j,le)){var ue=Q?Object.getOwnPropertyDescriptor(j,le):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,le,ue):X[le]=j[le]}return X.default=j,$&&$.set(j,X),X}(O());function c(j){if(typeof WeakMap!="function")return null;var I=new WeakMap,$=new WeakMap;return(c=function(X){return X?$:I})(j)}function p(){var j=new s.ARRAY_TYPE(2);return s.ARRAY_TYPE!=Float32Array&&(j[0]=0,j[1]=0),j}function v(j,I,$){return j[0]=I[0]-$[0],j[1]=I[1]-$[1],j}function m(j,I,$){return j[0]=I[0]*$[0],j[1]=I[1]*$[1],j}function x(j,I,$){return j[0]=I[0]/$[0],j[1]=I[1]/$[1],j}function k(j,I){return Math.hypot(I[0]-j[0],I[1]-j[1])}function N(j,I){var $=I[0]-j[0],X=I[1]-j[1];return $*$+X*X}function z(j){return Math.hypot(j[0],j[1])}function C(j){var I=j[0],$=j[1];return I*I+$*$}rt.len=z,rt.sub=v,rt.mul=m,rt.div=x,rt.dist=k,rt.sqrDist=N,rt.sqrLen=C;var R,L=(R=p(),function(j,I,$,X,Q,le){var ue,ie;for(I||(I=2),$||($=0),ie=X?Math.min(X*I+$,j.length):j.length,ue=$;ue<ie;ue+=I)R[0]=j[ue],R[1]=j[ue+1],Q(R,R,le),j[ue]=R[0],j[ue+1]=R[1];return j});return rt.forEach=L,rt}function Cr(){if(ht)return A;function h(j){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},h(j)}ht=1,Object.defineProperty(A,"__esModule",{value:!0}),A.vec4=A.vec3=A.vec2=A.quat2=A.quat=A.mat4=A.mat3=A.mat2d=A.mat2=A.glMatrix=void 0;var s=L(O());A.glMatrix=s;var c=L(B());A.mat2=c;var p=L(Z());A.mat2d=p;var v=L(ee());A.mat3=v;var m=L(ge());A.mat4=m;var x=L(Oe());A.quat=x;var k=L(ut());A.quat2=k;var N=L(Qt());A.vec2=N;var z=L(Ee());A.vec3=z;var C=L(Ge());function R(j){if(typeof WeakMap!="function")return null;var I=new WeakMap,$=new WeakMap;return(R=function(X){return X?$:I})(j)}function L(j,I){if(j&&j.__esModule)return j;if(j===null||h(j)!=="object"&&typeof j!="function")return{default:j};var $=R(I);if($&&$.has(j))return $.get(j);var X={},Q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in j)if(le!=="default"&&Object.prototype.hasOwnProperty.call(j,le)){var ue=Q?Object.getOwnPropertyDescriptor(j,le):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,le,ue):X[le]=j[le]}return X.default=j,$&&$.set(j,X),X}return A.vec4=C,A}var vr,cr,nr,Kt,De=Cr(),er=function(){if(cr)return vr;function h(s,c,p,v){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(v-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=c,this.p2x=p,this.p2y=v}return cr=1,vr=h,h.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,c){if(c===void 0&&(c=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,v=0;v<8;v++){var m=this.sampleCurveX(p)-s;if(Math.abs(m)<c)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=m/x}var k=0,N=1;for(p=s,v=0;v<20&&(m=this.sampleCurveX(p),!(Math.abs(m-s)<c));v++)s>m?k=p:N=p,p=.5*(N-k)+k;return p},solve:function(s,c){return this.sampleCurveY(this.solveCurveX(s,c))}},vr}(),Lt=_(er);function Rr(){if(Kt)return nr;function h(s,c){this.x=s,this.y=c}return Kt=1,nr=h,h.prototype={clone:function(){return new h(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,c){return this.clone()._rotateAround(s,c)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var c=s.x-this.x,p=s.y-this.y;return c*c+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,c){return Math.atan2(this.x*c-this.y*s,this.x*s+this.y*c)},_matMult:function(s){var c=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=c,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var c=Math.cos(s),p=Math.sin(s),v=p*this.x+c*this.y;return this.x=c*this.x-p*this.y,this.y=v,this},_rotateAround:function(s,c){var p=Math.cos(s),v=Math.sin(s),m=c.y+v*(this.x-c.x)+p*(this.y-c.y);return this.x=c.x+p*(this.x-c.x)-v*(this.y-c.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},h.convert=function(s){return s instanceof h?s:Array.isArray(s)?new h(s[0],s[1]):s},nr}var Pt=_(Rr());function nn(h,s){if(Array.isArray(h)){if(!Array.isArray(s)||h.length!==s.length)return!1;for(let c=0;c<h.length;c++)if(!nn(h[c],s[c]))return!1;return!0}if(typeof h=="object"&&h!==null&&s!==null){if(typeof s!="object"||Object.keys(h).length!==Object.keys(s).length)return!1;for(const c in h)if(!nn(h[c],s[c]))return!1;return!0}return h===s}const Sn=Math.PI/180,Br=180/Math.PI;function et(h){return h*Sn}function bt(h){return h*Br}const zt=[[0,0],[1,0],[1,1],[0,1]];function xr(h){if(h<=0)return 0;if(h>=1)return 1;const s=h*h,c=s*h;return 4*(h<.5?c:3*(h-s)+c-.75)}function fr(h,s,c,p){const v=new Lt(h,s,c,p);return function(m){return v.solve(m)}}const pr=fr(.25,.1,.25,1);function ar(h,s,c){return Math.min(c,Math.max(s,h))}function tn(h,s,c){return(c=ar((c-h)/(s-h),0,1))*c*(3-2*c)}function Xn(h,s,c){const p=c-s,v=((h-s)%p+p)%p+s;return v===s?c:v}function Bi(h,s,c){if(!h.length)return c(null,[]);let p=h.length;const v=new Array(h.length);let m=null;h.forEach((x,k)=>{s(x,(N,z)=>{N&&(m=N),v[k]=z,--p==0&&c(m,v)})})}function Vi(h,...s){for(const c of s)for(const p in c)h[p]=c[p];return h}let io=1;function Va(){return io++}function Vs(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function yo(h,s){h.forEach(c=>{s[c]&&(s[c]=s[c].bind(s))})}function Qa(h,s){return h.indexOf(s,h.length-s.length)!==-1}function ql(h,s,c){const p={};for(const v in h)p[v]=s.call(this,h[v],v,h);return p}function _l(h,s,c){const p={};for(const v in h)s.call(this,h[v],v,h)&&(p[v]=h[v]);return p}function Os(h){return Array.isArray(h)?h.map(Os):typeof h=="object"&&h?ql(h,Os):h}const Gl={};function an(h){Gl[h]||(typeof console<"u"&&console.warn(h),Gl[h]=!0)}function es(h,s,c){return(c.y-h.y)*(s.x-h.x)>(s.y-h.y)*(c.x-h.x)}function Mu(h){let s=0;for(let c,p,v=0,m=h.length,x=m-1;v<m;x=v++)c=h[v],p=h[x],s+=(p.x-c.x)*(c.y+p.y);return s}function Ua([h,s,c]){const p=et(s+90),v=et(c);return{x:h*Math.cos(p)*Math.sin(v),y:h*Math.sin(p)*Math.sin(v),z:h*Math.cos(v),azimuthal:s,polar:c}}function Us(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function qn(h){const s={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,p,v,m)=>{const x=v||m;return s[p]=!x||x.toLowerCase(),""}),s["max-age"]){const c=parseInt(s["max-age"],10);isNaN(c)?delete s["max-age"]:s["max-age"]=c}return s}let ha=null;function Ta(h,s){return[h[4*s],h[4*s+1],h[4*s+2],h[4*s+3]]}function ws(h,s,c,p){for(;s<c;){const v=s+c>>1;h[v]<p?s=v+1:c=v}return s}function bl(h,s,c,p){for(;s<c;){const v=s+c>>1;h[v]<=p?s=v+1:c=v}return s}function Pa(h){return h>0?1/(1.001-h):1+h}function Ns(h){return h>0?1-1/(1.001-h):-h}const Ui={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ui.API_URL)return null;try{const h=new URL(Ui.API_URL);return h.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":h.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ss(h){return Ui.API_URL_REGEX.test(h)}function us(h){return Ui.API_SPRITE_REGEX.test(h)}let ju,Hi,zo,At,ye,Se;function Pe(){return ju==null&&(ju=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),ju}const He={now:()=>At!==void 0?At:performance.now(),setNow(h){At=h},restoreNow(){At=void 0},frame(h){const s=requestAnimationFrame(h);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(h,s=0){const{width:c,height:p}=h;ye||(ye=document.createElement("canvas"));const v=ye.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(c>ye.width||p>ye.height)&&(ye.width=c,ye.height=p),v.clearRect(-s,-s,c+2*s,p+2*s),v.drawImage(h,0,0,c,p),v.getImageData(-s,-s,c+2*s,p+2*s)},resolveURL:h=>(Hi||(Hi=document.createElement("a")),Hi.href=h,Hi.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(zo==null&&(zo=window.matchMedia("(prefers-reduced-motion: reduce)")),zo.matches)},hasCanvasFingerprintNoise(){if(Se!==void 0)return Se;if(!Pe())return Se=!1,!1;const h=new OffscreenCanvas(85,1),s=h.getContext("2d",{willReadFrequently:!0});let c=0;for(let v=0;v<h.width;++v)s.fillStyle=`rgba(${c++},${c++},${c++}, 255)`,s.fillRect(v,0,1,1);const p=s.getImageData(0,0,h.width,h.height);c=0;for(let v=0;v<p.data.length;++v)if(v%4!=3&&c++!==p.data[v])return Se=!0,!0;return Se=!1,!1}};function Ye(h,s){const c=h.indexOf("?");if(c<0)return`${h}?${new URLSearchParams(s).toString()}`;const p=new URLSearchParams(h.slice(c));for(const v in s)p.set(v,s[v]);return`${h.slice(0,c)}?${p.toString()}`}function at(h,s={persistentParams:[]}){const c=h.indexOf("?");if(c<0)return h;const p=new URLSearchParams,v=new URLSearchParams(h.slice(c));for(const x of s.persistentParams){const k=v.get(x);k&&p.set(x,k)}const m=p.toString();return`${h.slice(0,c)}${m.length>0?`?${m}`:""}`}const gt="mapbox-tiles";let ot=500,St=50;const wt=["language","worldview","jobid"];let Tt,Ft;function rr(){try{return caches}catch{}}function sr(){const h=rr();h&&Tt==null&&(Tt=h.open(gt))}let Ar=1/0;const $r={supported:!1,testSupport:function(h){!Cn&&Vr&&(Hn?Un(h):Ur=h)}};let Ur,Vr,Cn=!1,Hn=!1;const bn=typeof self<"u"?self:{};function Un(h){const s=h.createTexture();h.bindTexture(h.TEXTURE_2D,s);try{if(h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,Vr),h.isContextLost())return;$r.supported=!0}catch{}h.deleteTexture(s),Cn=!0}bn.document&&(Vr=bn.document.createElement("img"),Vr.onload=function(){Ur&&Un(Ur),Ur=null,Hn=!0},Vr.onerror=function(){Cn=!0,Ur=null},Vr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const En={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(En);class Ca extends Error{constructor(s,c,p){c===401&&Ss(p)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=c,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ds=Us()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,$a=function(h,s){if(!(/^file:/.test(c=h.url)||/^file:/.test(ds())&&!/^\w+:/.test(c))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(p,v){const m=new AbortController,x=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:ds(),referrerPolicy:p.referrerPolicy,signal:m.signal});let k=!1,N=!1;const z=(C=x.url).indexOf("sku=")>0&&Ss(C);var C;p.type==="json"&&x.headers.set("Accept","application/json");const R=(j,I,$)=>{if(N)return;if(j&&j.message!=="SecurityError"&&an(j.toString()),I&&$)return L(I);const X=Date.now();fetch(x).then(Q=>{if(Q.ok){const le=z?Q.clone():null;return L(Q,le,X)}return v(new Ca(Q.statusText,Q.status,p.url))}).catch(Q=>{Q.name!=="AbortError"&&v(new Error(`${Q.message} ${p.url}`))})},L=(j,I,$)=>{(p.type==="arrayBuffer"?j.arrayBuffer():p.type==="json"?j.json():j.text()).then(X=>{N||(I&&$&&function(Q,le,ue){if(sr(),Tt==null)return;const ie=qn(le.headers.get("Cache-Control")||"");if(ie["no-store"])return;const he={status:le.status,statusText:le.statusText,headers:new Headers};le.headers.forEach((Ie,Ne)=>he.headers.set(Ne,Ie)),ie["max-age"]&&he.headers.set("Expires",new Date(ue+1e3*ie["max-age"]).toUTCString());const me=he.headers.get("Expires");if(!me||new Date(me).getTime()-ue<42e4)return;let we=at(Q.url,{persistentParams:wt});if(le.status===206){const Ie=Q.headers.get("Range");if(!Ie)return;he.status=200,we=Ye(we,{range:Ie})}(function(Ie,Ne){if(Ft===void 0)try{new Response(new ReadableStream),Ft=!0}catch{Ft=!1}Ft?Ne(Ie.body):Ie.blob().then(Ne)})(le,Ie=>{const Ne=new Response((Me=le.status)!==200&&Me!==404&&[101,103,204,205,304].includes(Me)?null:Ie,he);var Me;sr(),Tt!=null&&Tt.then(Je=>Je.put(we,Ne)).catch(Je=>an(Je.message))})}(x,I,$),k=!0,v(null,X,j.headers.get("Cache-Control"),j.headers.get("Expires")))}).catch(X=>{N||v(new Error(X.message))})};return z?function(j,I){if(sr(),Tt==null)return I(null);Tt.then($=>{let X=at(j.url,{persistentParams:wt});const Q=j.headers.get("Range");Q&&(X=Ye(X,{range:Q})),$.match(X).then(le=>{const ue=function(ie){if(!ie)return!1;const he=new Date(ie.headers.get("Expires")||0),me=qn(ie.headers.get("Cache-Control")||"");return he>Date.now()&&!me["no-cache"]}(le);$.delete(X),ue&&$.put(X,le.clone()),I(null,le,ue)}).catch(I)}).catch(I)}(x,R):R(null,null),{cancel:()=>{N=!0,k||m.abort()}}}(h,s);if(Us()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,s,void 0,!0)}var c;return function(p,v){const m=new XMLHttpRequest;m.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const x in p.headers)m.setRequestHeader(x,p.headers[x]);return p.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=p.credentials==="include",m.onerror=()=>{v(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let x=m.response;if(p.type==="json")try{x=JSON.parse(m.response)}catch(k){return v(k)}v(null,x,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else v(new Ca(m.statusText,m.status,p.url))},m.send(p.body),{cancel:()=>m.abort()}}(h,s)},ts=function(h,s){return $a(Vi(h,{type:"arrayBuffer"}),s)};function ao(h){const s=document.createElement("a");return s.href=h,s.protocol===location.protocol&&s.host===location.host}const Ou="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let wl,Vc;wl=[],Vc=0;const Wh=function(h,s){if($r.supported&&(h.headers||(h.headers={}),h.headers.accept="image/webp,*/*"),Vc>=Ui.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:h,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return wl.push(m),m}Vc++;let c=!1;const p=()=>{if(!c)for(c=!0,Vc--;wl.length&&Vc<Ui.MAX_PARALLEL_IMAGE_REQUESTS;){const m=wl.shift(),{requestParameters:x,callback:k,cancelled:N}=m;N||(m.cancel=Wh(x,k).cancel)}},v=ts(h,(m,x,k,N)=>{p(),m?s(m):x&&(self.createImageBitmap?function(z,C){const R=new Blob([new Uint8Array(z)],{type:"image/png"});createImageBitmap(R).then(L=>{C(null,L)}).catch(L=>{C(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(z,C)=>s(z,C,k,N)):function(z,C){const R=new Image;R.onload=()=>{C(null,R),URL.revokeObjectURL(R.src),R.onload=null,requestAnimationFrame(()=>{R.src=Ou})},R.onerror=()=>C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(z)],{type:"image/png"});R.src=z.byteLength?URL.createObjectURL(L):Ou}(x,(z,C)=>s(z,C,k,N)))});return{cancel:()=>{v.cancel(),p()}}};var r0,dy,lp,$s={exports:{}},al={exports:{}},sl={exports:{}},uc=function(){if(lp)return $s.exports;lp=1;var h=(r0||(r0=1,al.exports=function(c,p){var v,m,x,k,N,z,C,R;for(m=c.length-(v=3&c.length),x=p,N=3432918353,z=461845907,R=0;R<m;)C=255&c.charCodeAt(R)|(255&c.charCodeAt(++R))<<8|(255&c.charCodeAt(++R))<<16|(255&c.charCodeAt(++R))<<24,++R,x=27492+(65535&(k=5*(65535&(x=(x^=C=(65535&(C=(C=(65535&C)*N+(((C>>>16)*N&65535)<<16)&4294967295)<<15|C>>>17))*z+(((C>>>16)*z&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(C=0,v){case 3:C^=(255&c.charCodeAt(R+2))<<16;case 2:C^=(255&c.charCodeAt(R+1))<<8;case 1:x^=C=(65535&(C=(C=(65535&(C^=255&c.charCodeAt(R)))*N+(((C>>>16)*N&65535)<<16)&4294967295)<<15|C>>>17))*z+(((C>>>16)*z&65535)<<16)&4294967295}return x^=c.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),al.exports),s=(dy||(dy=1,sl.exports=function(c,p){for(var v,m=c.length,x=p^m,k=0;m>=4;)v=1540483477*(65535&(v=255&c.charCodeAt(k)|(255&c.charCodeAt(++k))<<8|(255&c.charCodeAt(++k))<<16|(255&c.charCodeAt(++k))<<24))+((1540483477*(v>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),m-=4,++k;switch(m){case 3:x^=(255&c.charCodeAt(k+2))<<16;case 2:x^=(255&c.charCodeAt(k+1))<<8;case 1:x=1540483477*(65535&(x^=255&c.charCodeAt(k)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),sl.exports);return $s.exports=h,$s.exports.murmur3=h,$s.exports.murmur2=s,$s.exports}(),ol=_(uc);class vi{constructor(s,...c){Vi(this,c[0]||{}),this.type=s}}class cp extends vi{constructor(s,c={}){super("error",Vi({error:s},c))}}function Tm(h,s,c){c[h]&&c[h].indexOf(s)!==-1||(c[h]=c[h]||[],c[h].push(s))}function dc(h,s,c){if(c&&c[h]){const p=c[h].indexOf(s);p!==-1&&c[h].splice(p,1)}}class Uc{on(s,c){return this._listeners=this._listeners||{},Tm(s,c,this._listeners),this}off(s,c){return dc(s,c,this._listeners),dc(s,c,this._oneTimeListeners),this}once(s,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},Tm(s,c,this._oneTimeListeners),this):new Promise(p=>this.once(s,p))}fire(s,c){const p=typeof s=="string"?new vi(s,c):s,v=p.type;if(this.listens(v)){p.target=this;const m=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const N of m)N.call(this,p);const x=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const N of x)dc(v,N,this._oneTimeListeners),N.call(this,p);const k=this._eventedParent;k&&(Vi(p,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(p))}else p instanceof cp&&console.error(p.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,c){return this._eventedParent=s,this._eventedParentData=c,this}}var hy,Pm={},Fo=function(){if(hy)return Pm;hy=1;var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(m){return(m=Math.round(m))<0?0:m>255?255:m}function c(m){return s(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function p(m){return(x=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:x>1?1:x;var x}function v(m,x,k){return k<0?k+=1:k>1&&(k-=1),6*k<1?m+(x-m)*k*6:2*k<1?x:3*k<2?m+(x-m)*(2/3-k)*6:m}try{Pm.parseCSSColor=function(m){var x,k=m.replace(/ /g,"").toLowerCase();if(k in h)return h[k].slice();if(k[0]==="#")return k.length===4?(x=parseInt(k.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:k.length===7&&(x=parseInt(k.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var N=k.indexOf("("),z=k.indexOf(")");if(N!==-1&&z+1===k.length){var C=k.substr(0,N),R=k.substr(N+1,z-(N+1)).split(","),L=1;switch(C){case"rgba":if(R.length!==4)return null;L=p(R.pop());case"rgb":return R.length!==3?null:[c(R[0]),c(R[1]),c(R[2]),L];case"hsla":if(R.length!==4)return null;L=p(R.pop());case"hsl":if(R.length!==3)return null;var j=(parseFloat(R[0])%360+360)%360/360,I=p(R[1]),$=p(R[2]),X=$<=.5?$*(I+1):$+I-$*I,Q=2*$-X;return[s(255*v(Q,X,j+1/3)),s(255*v(Q,X,j)),s(255*v(Q,X,j-1/3)),L];default:return null}}return null}}catch{}return Pm}();class Jn{constructor(s,c,p,v=1){this.r=s,this.g=c,this.b=p,this.a=v}static parse(s){if(!s)return;if(s instanceof Jn)return s;if(typeof s!="string")return;const c=Fo.parseCSSColor(s);return c?new Jn(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toStringPremultipliedAlpha(){const[s,c,p,v]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(s)},${Math.round(c)},${Math.round(p)},${v})`}toString(){const[s,c,p,v]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*s)},${Math.round(255*c)},${Math.round(255*p)},${v})`}toRenderColor(s){const{r:c,g:p,b:v,a:m}=this;return new hc(s,c,p,v,m)}clone(){return new Jn(this.r,this.g,this.b,this.a)}}class hc{constructor(s,c,p,v,m){if(s){const x=s.image.height,k=x*x;c=m===0?0:c/m*(x-1),p=m===0?0:p/m*(x-1),v=m===0?0:v/m*(x-1);const N=Math.floor(c),z=Math.floor(p),C=Math.floor(v),R=Math.ceil(c),L=Math.ceil(p),j=Math.ceil(v),I=c-N,$=p-z,X=v-C,Q=s.image.data,le=4*(N+z*k+C*x),ue=4*(N+z*k+j*x),ie=4*(N+L*k+C*x),he=4*(N+L*k+j*x),me=4*(R+z*k+C*x),we=4*(R+z*k+j*x),Ie=4*(R+L*k+C*x),Ne=4*(R+L*k+j*x);if(le<0||Ne>=Q.length)throw new Error("out of range");this.r=Lr(Lr(Lr(Q[le],Q[ue],X),Lr(Q[ie],Q[he],X),$),Lr(Lr(Q[me],Q[we],X),Lr(Q[Ie],Q[Ne],X),$),I)/255*m,this.g=Lr(Lr(Lr(Q[le+1],Q[ue+1],X),Lr(Q[ie+1],Q[he+1],X),$),Lr(Lr(Q[me+1],Q[we+1],X),Lr(Q[Ie+1],Q[Ne+1],X),$),I)/255*m,this.b=Lr(Lr(Lr(Q[le+2],Q[ue+2],X),Lr(Q[ie+2],Q[he+2],X),$),Lr(Lr(Q[me+2],Q[we+2],X),Lr(Q[Ie+2],Q[Ne+2],X),$),I)/255*m,this.a=m}else this.r=c,this.g=p,this.b=v,this.a=m}toArray(){const{r:s,g:c,b:p,a:v}=this;return v===0?[0,0,0,0]:[255*s/v,255*c/v,255*p/v,v]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:s,g:c,b:p,a:v}=this,m=Math.min(Math.max(s/v,0),1),x=Math.min(Math.max(c/v,0),1),k=Math.min(Math.max(p/v,0),1),N=Math.min(m,x,k),z=Math.max(m,x,k),C=(N+z)/2;if(N===z)return[0,0,100*C,v];const R=z-N,L=C>.5?R/(2-z-N):R/(z+N);let j=0;return z===m?j=(x-k)/R+(x<k?6:0):z===x?j=(k-m)/R+2:z===k&&(j=(m-x)/R+4),j*=60,[Math.min(Math.max(j,0),360),Math.min(Math.max(100*L,0),100),Math.min(Math.max(100*C,0),100),v]}toArray01(){const{r:s,g:c,b:p,a:v}=this;return v===0?[0,0,0,0]:[s/v,c/v,p/v,v]}toArray01Scaled(s){const{r:c,g:p,b:v,a:m}=this;return m===0?[0,0,0]:[c/m*s,p/m*s,v/m*s]}toArray01PremultipliedAlpha(){const{r:s,g:c,b:p,a:v}=this;return[s,c,p,v]}toArray01Linear(){const{r:s,g:c,b:p,a:v}=this;return v===0?[0,0,0,0]:[Math.pow(s/v,2.2),Math.pow(c/v,2.2),Math.pow(p/v,2.2),v]}}function Lr(h,s,c){return h*(1-c)+s*c}function $c(h,s,c){return h.map((p,v)=>Lr(p,s[v],c))}Jn.black=new Jn(0,0,0,1),Jn.white=new Jn(1,1,1,1),Jn.transparent=new Jn(0,0,0,0),Jn.red=new Jn(1,0,0,1),Jn.blue=new Jn(0,0,1,1);var Nu=Object.freeze({__proto__:null,array:$c,color:function(h,s,c){return new Jn(Lr(h.r,s.r,c),Lr(h.g,s.g,c),Lr(h.b,s.b,c),Lr(h.a,s.a,c))},number:Lr});function Ru(h,...s){for(const c of s)for(const p in c)h[p]=c[p];return h}class hn extends Error{constructor(s,c){super(c),this.message=c,this.key=s}}class Cm{constructor(s,c=[]){this.parent=s,this.bindings={};for(const[p,v]of c)this.bindings[p]=v}concat(s){return new Cm(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Iu={kind:"null"},wr={kind:"number"},mi={kind:"string"},Gn={kind:"boolean"},hs={kind:"color"},fc={kind:"object"},ai={kind:"value"},qc={kind:"collator"},Bo={kind:"formatted"},pc={kind:"resolvedImage"};function qa(h,s){return{kind:"array",itemType:h,N:s}}function fa(h){if(h.kind==="array"){const s=fa(h.itemType);return typeof h.N=="number"?`array<${s}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${s}>`}return h.kind}const fy=[Iu,wr,mi,Gn,hs,Bo,fc,qa(ai),pc];function qs(h,s){if(s.kind==="error")return null;if(h.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!qs(h.itemType,s.itemType))&&(typeof h.N!="number"||h.N===s.N))return null}else{if(h.kind===s.kind)return null;if(h.kind==="value"){for(const c of fy)if(!qs(c,s))return null}}return`Expected ${fa(h)} but found ${fa(s)} instead.`}function jd(h,s){return s.some(c=>c.kind===h.kind)}function Od(h,s){return s.some(c=>c==="null"?h===null:c==="array"?Array.isArray(h):c==="object"?h&&!Array.isArray(h)&&typeof h=="object":c===typeof h)}class up{constructor(s,c,p){this.sensitivity=s?c?"variant":"case":c?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,c){return this.collator.compare(s,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Sl{constructor(s,c,p,v,m){this.text=s.normalize?s.normalize():s,this.image=c,this.scale=p,this.fontStack=v,this.textColor=m}}class As{constructor(s){this.sections=s}static fromString(s){return new As([new Sl(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.namePrimary)}static factory(s){return s instanceof As?s:As.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const c of this.sections){if(c.image){s.push(["image",c.image.namePrimary]);continue}s.push(c.text);const p={};c.fontStack&&(p["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(p["font-scale"]=c.scale),c.textColor&&(p["text-color"]=["rgba"].concat(c.textColor.toRenderColor(null).toArray())),s.push(p)}return s}}class ll{constructor(s,c){if(this.id=s,this.options=c||{params:{}},this.options.transform){const{a:p,b:v,c:m,d:x,e:k,f:N}=this.options.transform;this.options.transform=new DOMMatrix([p,v,m,x,k,N])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(s){return JSON.parse(s).id}static deserializeFromString(s){const c=JSON.parse(s),{a:p,b:v,c:m,d:x,e:k,f:N}=c.options.transform;return new DOMMatrix([p,v,m,x,k,N]),new ll(c.id,c.options)}scaleSelf(s){return this.options.transform=this.options.transform.scale(s),this}serialize(){const s={id:this.id};this.options&&(s.options=this.options);const{a:c,b:p,c:v,d:m,e:x,f:k}=this.options.transform;return s.options.transform={a:c,b:p,c:v,d:m,e:x,f:k},JSON.stringify(s)}}class Ts{constructor(s){this.namePrimary=s.namePrimary,s.nameSecondary&&(this.nameSecondary=s.nameSecondary),s.optionsPrimary&&(this.optionsPrimary=s.optionsPrimary),s.optionsSecondary&&(this.optionsSecondary=s.optionsSecondary),this.available=s.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new ll(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new ll(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(s){return typeof s=="string"?Ts.build(s):s}static build(s,c,p,v){return s?new Ts({namePrimary:s,nameSecondary:c,optionsPrimary:p,optionsSecondary:v,available:!1}):null}}function Hh(h,s,c,p){return typeof h=="number"&&h>=0&&h<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof c=="number"&&c>=0&&c<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[h,s,c,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[h,s,c,p]:[h,s,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Al(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof Jn||h instanceof up||h instanceof As||h instanceof Ts)return!0;if(Array.isArray(h)){for(const s of h)if(!Al(s))return!1;return!0}if(typeof h=="object"){for(const s in h)if(!Al(h[s]))return!1;return!0}return!1}function ta(h){if(h===null)return Iu;if(typeof h=="string")return mi;if(typeof h=="boolean")return Gn;if(typeof h=="number")return wr;if(h instanceof Jn)return hs;if(h instanceof up)return qc;if(h instanceof As)return Bo;if(h instanceof Ts)return pc;if(Array.isArray(h)){const s=h.length;let c;for(const p of h){const v=ta(p);if(c){if(c===v)continue;c=ai;break}c=v}return qa(c||ai,s)}return fc}function Ea(h){const s=typeof h;return h===null?"":s==="string"||s==="number"||s==="boolean"?String(h):h instanceof Jn?h.toStringPremultipliedAlpha():h instanceof As||h instanceof Ts?h.toString():JSON.stringify(h)}class ka{constructor(s,c){this.type=s,this.value=c}static parse(s,c){if(s.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Al(s[1]))return c.error("invalid value");const p=s[1];let v=ta(p);const m=c.expectedType;return v.kind!=="array"||v.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(v=m),new ka(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Jn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof As?this.value.serialize():this.value}}class pa{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const Gc={string:mi,number:wr,boolean:Gn,object:fc};class Wl{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");let p,v=1;const m=s[0];if(m==="array"){let k,N;if(s.length>2){const z=s[1];if(typeof z!="string"||!(z in Gc)||z==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);k=Gc[z],v++}else k=ai;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return c.error('The length argument to "array" must be a positive integer literal',2);N=s[2],v++}p=qa(k,N)}else p=Gc[m];const x=[];for(;v<s.length;v++){const k=c.parse(s[v],v,ai);if(!k)return null;x.push(k)}return new Wl(p,x)}evaluate(s){for(let c=0;c<this.args.length;c++){const p=this.args[c].evaluate(s);if(!qs(this.type,ta(p)))return p;if(c===this.args.length-1)throw new pa(`The expression ${JSON.stringify(this.args[c].serialize())} evaluated to ${fa(ta(p))} but was expected to be of type ${fa(this.type)}.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,c=[s.kind];if(s.kind==="array"){const p=s.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){c.push(p.kind);const v=s.N;(typeof v=="number"||this.args.length>1)&&c.push(v)}}return c.concat(this.args.map(p=>p.serialize()))}}class Wc{constructor(s){this.type=Bo,this.sections=s}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return c.error("First argument must be an image or text section.");const v=[];let m=!1;for(let x=1;x<=s.length-1;++x){const k=s[x];if(m&&typeof k=="object"&&!Array.isArray(k)){m=!1;let N=null;if(k["font-scale"]&&(N=c.parseObjectValue(k["font-scale"],x,"font-scale",wr),!N))return null;let z=null;if(k["text-font"]&&(z=c.parseObjectValue(k["text-font"],x,"text-font",qa(mi)),!z))return null;let C=null;if(k["text-color"]&&(C=c.parseObjectValue(k["text-color"],x,"text-color",hs),!C))return null;const R=v[v.length-1];R.scale=N,R.font=z,R.textColor=C}else{const N=c.parse(s[x],x,ai);if(!N)return null;const z=N.type.kind;if(z!=="string"&&z!=="value"&&z!=="null"&&z!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,v.push({content:N,scale:null,font:null,textColor:null})}}return new Wc(v)}evaluate(s){return new As(this.sections.map(c=>{const p=c.content.evaluate(s);return ta(p)===pc?new Sl("",p,null,null,null):new Sl(Ea(p),null,c.scale?c.scale.evaluate(s):null,c.font?c.font.evaluate(s).join(","):null,c.textColor?c.textColor.evaluate(s):null)}))}eachChild(s){for(const c of this.sections)s(c.content),c.scale&&s(c.scale),c.font&&s(c.font),c.textColor&&s(c.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const c of this.sections){s.push(c.content.serialize());const p={};c.scale&&(p["font-scale"]=c.scale.serialize()),c.font&&(p["text-font"]=c.font.serialize()),c.textColor&&(p["text-color"]=c.textColor.serialize()),s.push(p)}return s}}class Nd{constructor(s,c,p,v){this._imageWarnHistory={},this.type=pc,this.inputPrimary=s,this.inputSecondary=c,this.inputPrimaryParams=p,this.inputSecondaryParams=v}static parse(s,c){if(s.length<2)return c.error("Expected two or more arguments.");let p=1;const v=[];function m(){if(p<s.length){const k=c.parse(s[p],p++,mi);return k?(v.push({image:k,options:void 0}),!0):(c.error(v.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function x(){if(p<s.length){if((k=s[p])===null||typeof k!="object"||Array.isArray(k))return!0;const N=s[p].params,z=c.concat(p);if(!N)return p++,!0;if(typeof N!="object"||N.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const C={},R=z.concat(void 0,"params");for(const L in N){if(!L)return R.error("Image parameter name should be non-empty"),!1;const j=R.concat(void 0,L).parse(N[L],void 0,hs,void 0,{typeAnnotation:"coerce"});if(!j)return!1;C[L]=j}return v[v.length-1].options=C,p++,!0}var k;return!0}for(let k=0;k<2;k++)if(!m()||!x())return;return new Nd(v[0].image,v[1]?v[1].image:void 0,v[0].options,v[1]?v[1].options:void 0)}evaluateParams(s,c){const p={};if(c){for(const v in c)if(c[v])try{const m=c[v].evaluate(s),x=`Ignoring image parameter "${v}" with semi-transparent color ${m.toString()}`;if(m.a!==1){this._imageWarnHistory[x]||(console.warn(x),this._imageWarnHistory[x]=!0);continue}p[v]=m}catch{continue}if(Object.keys(p).length!==0)return{params:p}}}evaluate(s){const c=Ts.build(this.inputPrimary.evaluate(s),this.inputSecondary?this.inputSecondary.evaluate(s):void 0,this.inputPrimaryParams?this.evaluateParams(s,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(s,this.inputSecondaryParams):void 0);return c&&s.availableImages&&(c.available=s.availableImages.indexOf(c.namePrimary)>-1,c.nameSecondary&&c.available&&s.availableImages&&(c.available=s.availableImages.indexOf(c.nameSecondary)>-1)),c}eachChild(s){if(s(this.inputPrimary),this.inputPrimaryParams)for(const c in this.inputPrimaryParams)this.inputPrimaryParams[c]&&s(this.inputPrimaryParams[c]);if(this.inputSecondary&&(s(this.inputSecondary),this.inputSecondaryParams))for(const c in this.inputSecondaryParams)this.inputSecondaryParams[c]&&s(this.inputSecondaryParams[c])}outputDefined(){return!1}serializeParams(s){const c={};if(s){for(const p in s)s[p]&&(c[p]=s[p].serialize());return{params:c}}}serialize(){const s=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&s.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(s.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&s.push(this.serializeParams(this.inputSecondaryParams))),s}}function vo(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}const Kh={"to-boolean":Gn,"to-color":hs,"to-number":wr,"to-string":mi};class mc{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expected at least one argument.");const p=s[0],v=[];let m=Iu;if(p==="to-array"){if(!Array.isArray(s[1]))return null;const x=s[1].length;if(c.expectedType){if(c.expectedType.kind!=="array")return c.error(`Expected ${c.expectedType.kind} but found array.`);m=qa(c.expectedType.itemType,x)}else{if(!(x>0&&Al(s[1][0])))return null;m=qa(ta(s[1][0]),x)}for(let k=0;k<x;k++){const N=s[1][k];let z;if(vo(N)==="array")z=c.parse(N,void 0,m.itemType);else{const C=vo(N);if(C!==m.itemType.kind)return c.error(`Expected ${m.itemType.kind} but found ${C}.`);z=c.registry.literal.parse(["literal",N===void 0?null:N],c)}if(!z)return null;v.push(z)}}else{if((p==="to-boolean"||p==="to-string")&&s.length!==2)return c.error("Expected one argument.");m=Kh[p];for(let x=1;x<s.length;x++){const k=c.parse(s[x],x,ai);if(!k)return null;v.push(k)}}return new mc(m,v)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let c,p;for(const v of this.args){if(c=v.evaluate(s),p=null,c instanceof Jn)return c;if(typeof c=="string"){const m=s.parseColor(c);if(m)return m}else if(Array.isArray(c)&&(p=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Hh(c[0],c[1],c[2],c[3]),!p))return new Jn(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new pa(p||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const p of this.args){if(c=p.evaluate(s),c===null)return 0;const v=Number(c);if(!isNaN(v))return v}throw new pa(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?As.fromString(Ea(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?Ts.build(Ea(this.args[0].evaluate(s))):this.type.kind==="array"?this.args.map(c=>c.evaluate(s)):Ea(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Wc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Nd(this.args[0]).serialize();const s=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(c=>{s.push(c.serialize())}),s}}const I_=["Unknown","Point","LineString","Polygon"];class py{constructor(s,c){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=s,this.options=c}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?I_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(s){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,c=this.featureDistanceData.scale,{x:p,y:v}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*c-s[0])+this.featureDistanceData.bearing[1]*(v*c-s[1])}return 0}parseColor(s){let c=this._parseColorCache[s];return c||(c=this._parseColorCache[s]=Jn.parse(s)),c}getConfig(s){return this.options?this.options.get(s):null}}class xo{constructor(s,c,p,v,m){this.name=s,this.type=c,this._evaluate=p,this.args=v,this._overloadIndex=m}evaluate(s){if(!this._evaluate){const c=xo.definitions[this.name];this._evaluate=Array.isArray(c)?c[2]:c.overloads[this._overloadIndex][1]}return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,c){const p=s[0],v=xo.definitions[p];if(!v)return c.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(v)?v[0]:v.type,x=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,k=[];let N=null,z=-1;for(const[C,R]of x){if(Array.isArray(C)&&C.length!==s.length-1)continue;k.push(C),z++,N=new ef(c.registry,c.path,null,c.scope,void 0,c._scope,c.options);const L=[];let j=!1;for(let I=1;I<s.length;I++){const $=s[I],X=Array.isArray(C)?C[I-1]:C.type,Q=N.parse($,1+L.length,X);if(!Q){j=!0;break}L.push(Q)}if(!j)if(Array.isArray(C)&&C.length!==L.length)N.error(`Expected ${C.length} arguments, but found ${L.length} instead.`);else{for(let I=0;I<L.length;I++){const $=Array.isArray(C)?C[I]:C.type,X=L[I];N.concat(I+1).checkSubtype($,X.type)}if(N.errors.length===0)return new xo(p,m,R,L,z)}}if(k.length===1)c.errors.push(...N.errors);else{const C=(k.length?k:x.map(([L])=>L)).map(dp).join(" | "),R=[];for(let L=1;L<s.length;L++){const j=c.parse(s[L],1+R.length);if(!j)return null;R.push(fa(j.type))}c.error(`Expected arguments of type ${C}, but found (${R.join(", ")}) instead.`)}return null}static register(s,c){xo.definitions=c;for(const p in c)s[p]=xo}}function dp(h){return Array.isArray(h)?`(${h.map(fa).join(", ")})`:`(${fa(h.type)}...)`}class Em{constructor(s,c,p){this.type=qc,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=c}static parse(s,c){if(s.length!==2)return c.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return c.error("Collator options argument must be an object.");const v=p["case-sensitive"]===void 0?c.parse(!1,1,Gn):c.parseObjectValue(p["case-sensitive"],1,"case-sensitive",Gn);if(!v)return null;const m=p["diacritic-sensitive"]===void 0?c.parse(!1,1,Gn):c.parseObjectValue(p["diacritic-sensitive"],1,"diacritic-sensitive",Gn);if(!m)return null;let x=null;return p.locale&&(x=c.parseObjectValue(p.locale,1,"locale",mi),!x)?null:new Em(v,m,x)}evaluate(s){return new up(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}function hp(h,s,c=0,p=h.length-1,v=D_){for(;p>c;){if(p-c>600){const N=p-c+1,z=s-c+1,C=Math.log(N),R=.5*Math.exp(2*C/3),L=.5*Math.sqrt(C*R*(N-R)/N)*(z-N/2<0?-1:1);hp(h,s,Math.max(c,Math.floor(s-z*R/N+L)),Math.min(p,Math.floor(s+(N-z)*R/N+L)),v)}const m=h[s];let x=c,k=p;for(fp(h,c,s),v(h[p],m)>0&&fp(h,c,p);x<k;){for(fp(h,x,k),x++,k--;v(h[x],m)<0;)x++;for(;v(h[k],m)>0;)k--}v(h[c],m)===0?fp(h,c,k):(k++,fp(h,k,p)),k<=s&&(c=k+1),s<=k&&(p=k-1)}}function fp(h,s,c){const p=h[s];h[s]=h[c],h[c]=p}function D_(h,s){return h<s?-1:h>s?1:0}function L_(h){let s=0;for(let c,p,v=0,m=h.length,x=m-1;v<m;x=v++)c=h[v],p=h[x],s+=(p.x-c.x)*(c.y+p.y);return s}function Zh(h,s){h[0]=Math.min(h[0],s[0]),h[1]=Math.min(h[1],s[1]),h[2]=Math.max(h[2],s[0]),h[3]=Math.max(h[3],s[1])}function pp(h,s){return!(h[0]<=s[0]||h[2]>=s[2]||h[1]<=s[1]||h[3]>=s[3])}function z_(h,s,c){const p=h[0]-s[0],v=h[1]-s[1],m=h[0]-c[0],x=h[1]-c[1];return p*x-m*v==0&&p*m<=0&&v*x<=0}function Yh(h,s,c=!1){let p=!1;for(let k=0,N=s.length;k<N;k++){const z=s[k];for(let C=0,R=z.length,L=R-1;C<R;L=C++){const j=z[L],I=z[C];if(z_(h,j,I))return c;(m=j)[1]>(v=h)[1]!=(x=I)[1]>v[1]&&v[0]<(x[0]-m[0])*(v[1]-m[1])/(x[1]-m[1])+m[0]&&(p=!p)}}var v,m,x;return p}function my(h,s,c,p){const v=p[0]-c[0],m=p[1]-c[1],x=(h[0]-c[0])*m-v*(h[1]-c[1]),k=(s[0]-c[0])*m-v*(s[1]-c[1]);return x>0&&k<0||x<0&&k>0}function Hl(h,s,c,p){return(v=[p[0]-c[0],p[1]-c[1]])[0]*(m=[s[0]-h[0],s[1]-h[1]])[1]-v[1]*m[0]!=0&&!(!my(h,s,c,p)||!my(c,p,h,s));var v,m}const Du=8192;function F_(h,s){const c=(180+h[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,v=Math.pow(2,s.z);return[Math.round(c*v*Du),Math.round(p*v*Du)]}function gy(h,s){for(let c=0;c<s.length;c++)if(Yh(h,s[c]))return!0;return!1}function n0(h,s,c){for(const p of c)for(let v=0,m=p.length,x=m-1;v<m;x=v++)if(Hl(h,s,p[x],p[v]))return!0;return!1}function i0(h,s){for(let c=0;c<h.length;++c)if(!Yh(h[c],s))return!1;for(let c=0;c<h.length-1;++c)if(n0(h[c],h[c+1],s))return!1;return!0}function B_(h,s){for(let c=0;c<s.length;c++)if(i0(h,s[c]))return!0;return!1}function yy(h,s,c){const p=[];for(let v=0;v<h.length;v++){const m=[];for(let x=0;x<h[v].length;x++){const k=F_(h[v][x],c);Zh(s,k),m.push(k)}p.push(m)}return p}function Rd(h,s,c){const p=[];for(let v=0;v<h.length;v++){const m=yy(h[v],s,c);p.push(m)}return p}function An(h,s,c,p){if(h[0]<c[0]||h[0]>c[2]){const v=.5*p;let m=h[0]-c[0]>v?-p:c[0]-h[0]>v?p:0;m===0&&(m=h[0]-c[2]>v?-p:c[2]-h[0]>v?p:0),h[0]+=m}Zh(s,h)}function zr(h,s,c,p){const v=Math.pow(2,p.z)*Du,m=[p.x*Du,p.y*Du],x=[];if(!h)return x;for(const k of h)for(const N of k){const z=[N.x+m[0],N.y+m[1]];An(z,s,c,v),x.push(z)}return x}function km(h,s,c,p){const v=Math.pow(2,p.z)*Du,m=[p.x*Du,p.y*Du],x=[];if(!h)return x;for(const N of h){const z=[];for(const C of N){const R=[C.x+m[0],C.y+m[1]];Zh(s,R),z.push(R)}x.push(z)}if(s[2]-s[0]<=v/2){(k=s)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const N of x)for(const z of N)An(z,s,c,v)}var k;return x}class Wr{constructor(s,c){this.type=Gn,this.geojson=s,this.geometries=c}static parse(s,c){if(s.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Al(s[1])){const p=s[1];if(p.type==="FeatureCollection")for(let v=0;v<p.features.length;++v){const m=p.features[v].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Wr(p,p.features[v].geometry)}else if(p.type==="Feature"){const v=p.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Wr(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Wr(p,p)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(c,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(p.type==="Polygon"){const k=yy(p.coordinates,m,x),N=zr(c.geometry(),v,m,x);if(!pp(v,m))return!1;for(const z of N)if(!Yh(z,k))return!1}if(p.type==="MultiPolygon"){const k=Rd(p.coordinates,m,x),N=zr(c.geometry(),v,m,x);if(!pp(v,m))return!1;for(const z of N)if(!gy(z,k))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(c,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(p.type==="Polygon"){const k=yy(p.coordinates,m,x),N=km(c.geometry(),v,m,x);if(!pp(v,m))return!1;for(const z of N)if(!i0(z,k))return!1}if(p.type==="MultiPolygon"){const k=Rd(p.coordinates,m,x),N=km(c.geometry(),v,m,x);if(!pp(v,m))return!1;for(const z of N)if(!B_(z,k))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const gc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Mm=1/298.257223563,Kr=Mm*(2-Mm),Id=Math.PI/180;class Lu{static fromTile(s,c,p){const v=Math.PI*(1-2*(s+.5)/Math.pow(2,c)),m=Math.atan(.5*(Math.exp(v)-Math.exp(-v)))/Id;return new Lu(m,p)}static get units(){return gc}constructor(s,c){if(s===void 0)throw new Error("No latitude given.");if(c&&!gc[c])throw new Error(`Unknown unit ${c}. Use one of: ${Object.keys(gc).join(", ")}`);const p=6378.137*Id*(c?gc[c]:1),v=Math.cos(s*Id),m=1/(1-Kr*(1-v*v)),x=Math.sqrt(m);this.kx=p*x*v,this.ky=p*x*m*(1-Kr)}distance(s,c){const p=fs(s[0]-c[0])*this.kx,v=(s[1]-c[1])*this.ky;return Math.sqrt(p*p+v*v)}bearing(s,c){const p=fs(c[0]-s[0])*this.kx;return Math.atan2(p,(c[1]-s[1])*this.ky)/Id}destination(s,c,p){const v=p*Id;return this.offset(s,Math.sin(v)*c,Math.cos(v)*c)}offset(s,c,p){return[s[0]+c/this.kx,s[1]+p/this.ky]}lineDistance(s){let c=0;for(let p=0;p<s.length-1;p++)c+=this.distance(s[p],s[p+1]);return c}area(s){let c=0;for(let p=0;p<s.length;p++){const v=s[p];for(let m=0,x=v.length,k=x-1;m<x;k=m++)c+=fs(v[m][0]-v[k][0])*(v[m][1]+v[k][1])*(p?-1:1)}return Math.abs(c)/2*this.kx*this.ky}along(s,c){let p=0;if(c<=0)return s[0];for(let v=0;v<s.length-1;v++){const m=s[v],x=s[v+1],k=this.distance(m,x);if(p+=k,p>c)return mp(m,x,(c-(p-k))/k)}return s[s.length-1]}pointToSegmentDistance(s,c,p){let[v,m]=c,x=fs(p[0]-v)*this.kx,k=(p[1]-m)*this.ky;if(x!==0||k!==0){const N=(fs(s[0]-v)*this.kx*x+(s[1]-m)*this.ky*k)/(x*x+k*k);N>1?(v=p[0],m=p[1]):N>0&&(v+=x/this.kx*N,m+=k/this.ky*N)}return x=fs(s[0]-v)*this.kx,k=(s[1]-m)*this.ky,Math.sqrt(x*x+k*k)}pointOnLine(s,c){let p=1/0,v=s[0][0],m=s[0][1],x=0,k=0;for(let N=0;N<s.length-1;N++){let z=s[N][0],C=s[N][1],R=fs(s[N+1][0]-z)*this.kx,L=(s[N+1][1]-C)*this.ky,j=0;R===0&&L===0||(j=(fs(c[0]-z)*this.kx*R+(c[1]-C)*this.ky*L)/(R*R+L*L),j>1?(z=s[N+1][0],C=s[N+1][1]):j>0&&(z+=R/this.kx*j,C+=L/this.ky*j)),R=fs(c[0]-z)*this.kx,L=(c[1]-C)*this.ky;const I=R*R+L*L;I<p&&(p=I,v=z,m=C,x=N,k=j)}return{point:[v,m],index:x,t:Math.max(0,Math.min(1,k))}}lineSlice(s,c,p){let v=this.pointOnLine(p,s),m=this.pointOnLine(p,c);if(v.index>m.index||v.index===m.index&&v.t>m.t){const z=v;v=m,m=z}const x=[v.point],k=v.index+1,N=m.index;!jm(p[k],x[0])&&k<=N&&x.push(p[k]);for(let z=k+1;z<=N;z++)x.push(p[z]);return jm(p[N],m.point)||x.push(m.point),x}lineSliceAlong(s,c,p){let v=0;const m=[];for(let x=0;x<p.length-1;x++){const k=p[x],N=p[x+1],z=this.distance(k,N);if(v+=z,v>s&&m.length===0&&m.push(mp(k,N,(s-(v-z))/z)),v>=c)return m.push(mp(k,N,(c-(v-z))/z)),m;v>s&&m.push(N)}return m}bufferPoint(s,c){const p=c/this.ky,v=c/this.kx;return[s[0]-v,s[1]-p,s[0]+v,s[1]+p]}bufferBBox(s,c){const p=c/this.ky,v=c/this.kx;return[s[0]-v,s[1]-p,s[2]+v,s[3]+p]}insideBBox(s,c){return fs(s[0]-c[0])>=0&&fs(s[0]-c[2])<=0&&s[1]>=c[1]&&s[1]<=c[3]}}function jm(h,s){return h[0]===s[0]&&h[1]===s[1]}function mp(h,s,c){const p=fs(s[0]-h[0]);return[h[0]+p*c,h[1]+(s[1]-h[1])*c]}function fs(h){for(;h<-180;)h+=360;for(;h>180;)h-=360;return h}class Rs{constructor(s=[],c=(p,v)=>p<v?-1:p>v?1:0){if(this.data=s,this.length=this.data.length,this.compare=c,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:c,compare:p}=this,v=c[s];for(;s>0;){const m=s-1>>1,x=c[m];if(p(v,x)>=0)break;c[s]=x,s=m}c[s]=v}_down(s){const{data:c,compare:p}=this,v=this.length>>1,m=c[s];for(;s<v;){let x=1+(s<<1);const k=x+1;if(k<this.length&&p(c[k],c[x])<0&&(x=k),p(c[x],m)>=0)break;c[s]=c[x],s=x}c[s]=m}}var lr=8192;function vy(h,s){return s.dist-h.dist}const gp=100,Xh=50;function Tl(h){const s=[1/0,1/0,-1/0,-1/0];if(s.length!==h.length)return!1;for(let c=0;c<s.length;c++)if(s[c]!==h[c])return!1;return!0}function Ra(h){return h[1]-h[0]+1}function Hc(h,s){const c=h[1]>=h[0]&&h[1]<s;return c||console.warn("Distance Expression: Index is out of range"),c}function Jh(h,s){if(h[0]>h[1])return[null,null];const c=Ra(h);if(s){if(c===2)return[h,null];const p=Math.floor(c/2);return[[h[0],h[0]+p],[h[0]+p,h[1]]]}{if(c===1)return[h,null];const p=Math.floor(c/2)-1;return[[h[0],h[0]+p],[h[0]+p+1,h[1]]]}}function Dd(h,s){const c=[1/0,1/0,-1/0,-1/0];if(!Hc(s,h.length))return c;for(let p=s[0];p<=s[1];++p)Zh(c,h[p]);return c}function zu(h){const s=[1/0,1/0,-1/0,-1/0];for(let c=0;c<h.length;++c)for(let p=0;p<h[c].length;++p)Zh(s,h[c][p]);return s}function Kc(h,s,c){if(Tl(h)||Tl(s))return NaN;let p=0,v=0;return h[2]<s[0]&&(p=s[0]-h[2]),h[0]>s[2]&&(p=h[0]-s[2]),h[1]>s[3]&&(v=h[1]-s[3]),h[3]<s[1]&&(v=s[1]-h[3]),c.distance([0,0],[p,v])}function yp(h){return 360*h-180}function a0(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function Om(h,s){const c=Math.pow(2,s.z),p=(h.y/lr+s.y)/c;return[yp((h.x/lr+s.x)/c),a0(p)]}function s0(h,s){const c=[];for(let p=0;p<h.length;++p)c.push(Om(h[p],s));return c}function o0(h,s,c){const p=c.pointOnLine(s,h).point;return c.distance(h,p)}function xy(h,s,c,p,v){const m=c.slice(p[0],p[1]+1);let x=1/0;for(let k=s[0];k<=s[1];++k)if((x=Math.min(x,o0(h[k],m,v)))===0)return 0;return x}function _y(h,s,c,p,v){const m=Math.min(v.pointToSegmentDistance(h,c,p),v.pointToSegmentDistance(s,c,p)),x=Math.min(v.pointToSegmentDistance(c,h,s),v.pointToSegmentDistance(p,h,s));return Math.min(m,x)}function V_(h,s,c,p,v){if(!Hc(s,h.length)||!Hc(p,c.length))return NaN;let m=1/0;for(let x=s[0];x<s[1];++x)for(let k=p[0];k<p[1];++k){if(Hl(h[x],h[x+1],c[k],c[k+1]))return 0;m=Math.min(m,_y(h[x],h[x+1],c[k],c[k+1],v))}return m}function l0(h,s,c,p,v){if(!Hc(s,h.length)||!Hc(p,c.length))return NaN;let m=1/0;for(let x=s[0];x<=s[1];++x)for(let k=p[0];k<=p[1];++k)if((m=Math.min(m,v.distance(h[x],c[k])))===0)return m;return m}function Gs(h,s,c){if(Yh(h,s,!0))return 0;let p=1/0;for(const v of s){const m=v.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(v[0]!==v[m-1]&&(p=Math.min(p,c.pointToSegmentDistance(h,v[m-1],v[0])))===0||(p=Math.min(p,o0(h,v,c)))===0)return p}return p}function vp(h,s,c,p){if(!Hc(s,h.length))return NaN;for(let m=s[0];m<=s[1];++m)if(Yh(h[m],c,!0))return 0;let v=1/0;for(let m=s[0];m<s[1];++m)for(const x of c)for(let k=0,N=x.length,z=N-1;k<N;z=k++){if(Hl(h[m],h[m+1],x[z],x[k]))return 0;v=Math.min(v,_y(h[m],h[m+1],x[z],x[k],p))}return v}function by(h,s){for(const c of h)for(let p=0;p<=c.length-1;++p)if(Yh(c[p],s,!0))return!0;return!1}function Nm(h,s,c,p=1/0){const v=zu(h),m=zu(s);if(p!==1/0&&Kc(v,m,c)>=p)return p;if(pp(v,m)){if(by(h,s))return 0}else if(by(s,h))return 0;let x=p;for(const k of h)for(let N=0,z=k.length,C=z-1;N<z;C=N++)for(const R of s)for(let L=0,j=R.length,I=j-1;L<j;I=L++){if(Hl(k[C],k[N],R[I],R[L]))return 0;x=Math.min(x,_y(k[C],k[N],R[I],R[L],c))}return x}function Qh(h,s,c,p,v,m,x){if(m===null||x===null)return;const k=Kc(Dd(p,m),Dd(v,x),c);k<s&&h.push({dist:k,range1:m,range2:x})}function wy(h,s,c,p,v=1/0){let m=Math.min(p.distance(h[0],c[0][0]),v);if(m===0)return m;const x=new Rs([{dist:0,range1:[0,h.length-1],range2:[0,0]}],vy),k=s?Xh:gp,N=zu(c);for(;x.length;){const z=x.pop();if(z.dist>=m)continue;const C=z.range1;if(Ra(C)<=k){if(!Hc(C,h.length))return NaN;if(s){const R=vp(h,C,c,p);if((m=Math.min(m,R))===0)return m}else for(let R=C[0];R<=C[1];++R){const L=Gs(h[R],c,p);if((m=Math.min(m,L))===0)return m}}else{const R=Jh(C,s);if(R[0]!==null){const L=Kc(Dd(h,R[0]),N,p);L<m&&x.push({dist:L,range1:R[0],range2:[0,0]})}if(R[1]!==null){const L=Kc(Dd(h,R[1]),N,p);L<m&&x.push({dist:L,range1:R[1],range2:[0,0]})}}}return m}function Vo(h,s,c,p,v,m=1/0){let x=Math.min(m,v.distance(h[0],c[0]));if(x===0)return x;const k=new Rs([{dist:0,range1:[0,h.length-1],range2:[0,c.length-1]}],vy),N=s?Xh:gp,z=p?Xh:gp;for(;k.length;){const C=k.pop();if(C.dist>=x)continue;const R=C.range1,L=C.range2;if(Ra(R)<=N&&Ra(L)<=z){if(!Hc(R,h.length)||!Hc(L,c.length))return NaN;if(s&&p?x=Math.min(x,V_(h,R,c,L,v)):s||p?s&&!p?x=Math.min(x,xy(c,L,h,R,v)):!s&&p&&(x=Math.min(x,xy(h,R,c,L,v))):x=Math.min(x,l0(h,R,c,L,v)),x===0)return x}else{const j=Jh(R,s),I=Jh(L,p);Qh(k,x,v,h,c,j[0],I[0]),Qh(k,x,v,h,c,j[0],I[1]),Qh(k,x,v,h,c,j[1],I[0]),Qh(k,x,v,h,c,j[1],I[1])}}return x}function Rm(h,s,c,p,v=1/0){let m=v;const x=Dd(h,[0,h.length-1]);for(const k of c)if(!(m!==1/0&&Kc(x,Dd(k,[0,k.length-1]),p)>=m)&&(m=Math.min(m,Vo(h,s,k,!0,p,m)),m===0))return m;return m}function xp(h,s,c,p,v=1/0){let m=v;const x=Dd(h,[0,h.length-1]);for(const k of c){if(m!==1/0&&Kc(x,zu(k),p)>=m)continue;const N=wy(h,s,k,p,m);if(isNaN(N))return N;if((m=Math.min(m,N))===0)return m}return m}function Zc(h){return h==="Point"||h==="MultiPoint"||h==="LineString"||h==="MultiLineString"||h==="Polygon"||h==="MultiPolygon"}class yc{constructor(s,c){this.type=wr,this.geojson=s,this.geometries=c}static parse(s,c){if(s.length!==2)return c.error(`'distance' expression requires either one argument, but found ' ${s.length-1} instead.`);if(Al(s[1])){const p=s[1];if(p.type==="FeatureCollection"){for(let v=0;v<p.features.length;++v)if(Zc(p.features[v].geometry.type))return new yc(p,p.features[v].geometry)}else if(p.type==="Feature"){if(Zc(p.geometry.type))return new yc(p,p.geometry)}else if(Zc(p.type))return new yc(p,p)}return c.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(s){const c=s.geometry(),p=s.canonicalID();if(c!=null&&p!=null){if(s.geometryType()==="Point")return function(v,m,x){const k=[];for(const z of v)for(const C of z)k.push(Om(C,m));const N=new Lu(k[0][1],"meters");return x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString"?Vo(k,!1,x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",N):x.type==="MultiLineString"?Rm(k,!1,x.coordinates,N):x.type==="Polygon"||x.type==="MultiPolygon"?xp(k,!1,x.type==="Polygon"?[x.coordinates]:x.coordinates,N):null}(c,p,this.geometries);if(s.geometryType()==="LineString")return function(v,m,x){const k=[];for(const z of v){const C=[];for(const R of z)C.push(Om(R,m));k.push(C)}const N=new Lu(k[0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return Rm(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",k,N);if(x.type==="MultiLineString"){let z=1/0;for(let C=0;C<x.coordinates.length;C++){const R=Rm(x.coordinates[C],!0,k,N,z);if(isNaN(R))return R;if((z=Math.min(z,R))===0)return z}return z}if(x.type==="Polygon"||x.type==="MultiPolygon"){let z=1/0;for(let C=0;C<k.length;C++){const R=xp(k[C],!0,x.type==="Polygon"?[x.coordinates]:x.coordinates,N,z);if(isNaN(R))return R;if((z=Math.min(z,R))===0)return z}return z}return null}(c,p,this.geometries);if(s.geometryType()==="Polygon")return function(v,m,x){const k=[];for(const z of function(C,R){const L=C.length;if(L<=1)return[C];const j=[];let I,$;for(let X=0;X<L;X++){const Q=L_(C[X]);Q!==0&&(C[X].area=Math.abs(Q),$===void 0&&($=Q<0),$===Q<0?(I&&j.push(I),I=[C[X]]):I.push(C[X]))}return I&&j.push(I),j}(v)){const C=[];for(let R=0;R<z.length;++R)C.push(s0(z[R],m));k.push(C)}const N=new Lu(k[0][0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return xp(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",k,N);if(x.type==="MultiLineString"){let z=1/0;for(let C=0;C<x.coordinates.length;C++){const R=xp(x.coordinates[C],!0,k,N,z);if(isNaN(R))return R;if((z=Math.min(z,R))===0)return z}return z}return x.type==="Polygon"||x.type==="MultiPolygon"?function(z,C,R){let L=1/0;for(const j of z)for(const I of C){const $=Nm(j,I,R,L);if(isNaN($))return $;if((L=Math.min(L,$))===0)return L}return L}(x.type==="Polygon"?[x.coordinates]:x.coordinates,k,N):null}(c,p,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Fu(h,s){switch(h){case"string":return Ea(s);case"number":return+s;case"boolean":return!!s;case"color":return Jn.parse(s);case"formatted":return As.fromString(Ea(s));case"resolvedImage":return Ts.build(Ea(s))}return s}function _p(h,s,c,p){return p!==void 0&&(h=p*Math.round(h/p)),s!==void 0&&h<s&&(h=s),c!==void 0&&h>c&&(h=c),h}class Bu{constructor(s,c,p){this.type=s,this.key=c,this.scope=p}static parse(s,c){let p=c.expectedType;if(p==null&&(p=ai),s.length<2||s.length>3)return c.error("Invalid number of arguments for 'config' expression.");const v=c.parse(s[1],1);if(!(v instanceof ka))return c.error("Key name of 'config' expression must be a string literal.");if(s.length>=3){const m=c.parse(s[2],2);return m instanceof ka?new Bu(p,Ea(v.value),Ea(m.value)):c.error("Scope of 'config' expression must be a string literal.")}return new Bu(p,Ea(v.value))}evaluate(s){const c=[this.key,this.scope,s.scope].filter(Boolean).join(""),p=s.getConfig(c);if(!p)return null;const{type:v,value:m,values:x,minValue:k,maxValue:N,stepValue:z}=p,C=p.default.evaluate(s);let R=C;if(m){const L=s.scope;s.scope=(L||"").split("").slice(1).join(""),R=m.evaluate(s),s.scope=L}return v&&(R=Fu(v,R)),R===void 0||k===void 0&&N===void 0&&z===void 0||(typeof R=="number"?R=_p(R,k,N,z):Array.isArray(R)&&(R=R.map(L=>typeof L=="number"?_p(L,k,N,z):L))),m!==void 0&&R!==void 0&&x&&!x.includes(R)&&(R=C,v&&(R=Fu(v,R))),(v&&v!==this.type||R!==void 0&&ta(R)!==this.type)&&(R=Fu(this.type.kind,R)),R}eachChild(){}outputDefined(){return!1}serialize(){const s=["config",this.key];return this.scope&&s.concat(this.key),s}}function Yc(h){if(h instanceof xo&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Wr||h instanceof yc)return!1;let s=!0;return h.eachChild(c=>{s&&!Yc(c)&&(s=!1)}),s}function vc(h){if(h instanceof xo&&h.name==="feature-state")return!1;let s=!0;return h.eachChild(c=>{s&&!vc(c)&&(s=!1)}),s}function Ld(h){if(h instanceof Bu)return new Set([h.key]);let s=new Set;return h.eachChild(c=>{s=new Set([...s,...Ld(c)])}),s}function Vu(h,s){if(h instanceof xo&&s.indexOf(h.name)>=0)return!1;let c=!0;return h.eachChild(p=>{c&&!Vu(p,s)&&(c=!1)}),c}class xc{constructor(s,c){this.type=c.type,this.name=s,this.boundExpression=c}static parse(s,c){if(s.length!==2||typeof s[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const p=s[1];return c.scope.has(p)?new xc(p,c.scope.get(p)):c.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class zd{constructor(s,c=[],p,v=new Cm,m=[],x,k){this.registry=s,this.path=c,this.key=c.map(N=>typeof N=="string"?`['${N}']`:`[${N}]`).join(""),this.scope=v,this.errors=m,this.expectedType=p,this._scope=x,this.options=k}parse(s,c,p,v,m={}){return c||p?this.concat(c,null,p,v)._parse(s,m):this._parse(s,m)}parseObjectValue(s,c,p,v,m,x={}){return this.concat(c,p,v,m)._parse(s,x)}_parse(s,c){function p(v,m,x){return x==="assert"?new Wl(m,[v]):x==="coerce"?new mc(m,[v]):v}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=typeof s[0]=="string"?this.registry[s[0]]:void 0;if(v){let m=v.parse(s,this);if(!m)return null;if(this.expectedType){const x=this.expectedType,k=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||k.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(x,k))return null}else m=p(m,x,c.typeAnnotation||"coerce");else m=p(m,x,c.typeAnnotation||"assert")}if(!(m instanceof ka)&&m.type.kind!=="resolvedImage"&&bp(m)){const x=new py(this._scope,this.options);try{m=new ka(m.type,m.evaluate(x))}catch(k){return this.error(k.message),null}}return m}return mc.parse(["to-array",s],this)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,c,p,v){let m=typeof s=="number"?this.path.concat(s):this.path;m=typeof c=="string"?m.concat(c):m;const x=v?this.scope.concat(v):this.scope;return new zd(this.registry,m,p||null,x,this.errors,this._scope,this.options)}error(s,...c){const p=`${this.key}${c.map(v=>`[${v}]`).join("")}`;this.errors.push(new hn(p,s))}checkSubtype(s,c){const p=qs(s,c);return p&&this.error(p),p}}var ef=zd;function bp(h){if(h instanceof xc)return bp(h.boundExpression);if(h instanceof xo&&h.name==="error"||h instanceof Em||h instanceof Wr||h instanceof yc||h instanceof Bu)return!1;const s=h instanceof mc||h instanceof Wl;let c=!0;return h.eachChild(p=>{c=s?c&&bp(p):c&&p instanceof ka}),!!c&&Yc(h)&&Vu(h,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function tf(h,s){const c=h.length-1;let p,v,m=0,x=c,k=0;for(;m<=x;)if(k=Math.floor((m+x)/2),p=h[k],v=h[k+1],p<=s){if(k===c||s<v)return k;m=k+1}else{if(!(p>s))throw new pa("Input is not a number.");x=k-1}return 0}class Fd{constructor(s,c,p){this.type=s,this.input=c,this.labels=[],this.outputs=[];for(const[v,m]of p)this.labels.push(v),this.outputs.push(m)}static parse(s,c){if(s.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return c.error("Expected an even number of arguments.");const p=c.parse(s[1],1,wr);if(!p)return null;const v=[];let m=null;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);for(let x=1;x<s.length;x+=2){const k=x===1?-1/0:s[x],N=s[x+1],z=x,C=x+1;if(typeof k!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(v.length&&v[v.length-1][0]>=k)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const R=c.parse(N,C,m);if(!R)return null;m=m||R.type,v.push([k,R])}return new Fd(m,p,v)}evaluate(s){const c=this.labels,p=this.outputs;if(c.length===1)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=c[0])return p[0].evaluate(s);const m=c.length;return v>=c[m-1]?p[m-1].evaluate(s):p[tf(c,v)].evaluate(s)}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&s.push(this.labels[c]),s.push(this.outputs[c].serialize());return s}}const Uu=.95047,Tn=1.08883,Im=4/29,$u=6/29,c0=3*$u*$u,u0=$u*$u*$u,wp=Math.PI/180,zi=180/Math.PI;function Dm(h){return h>u0?Math.pow(h,1/3):h/c0+Im}function Lm(h){return h>$u?h*h*h:c0*(h-Im)}function ca(h){return 255*(h<=.0031308?12.92*h:1.055*Math.pow(h,1/2.4)-.055)}function Sp(h){return(h/=255)<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function Ap(h){const s=Sp(h.r),c=Sp(h.g),p=Sp(h.b),v=Dm((.4124564*s+.3575761*c+.1804375*p)/Uu),m=Dm((.2126729*s+.7151522*c+.072175*p)/1);return{l:116*m-16,a:500*(v-m),b:200*(m-Dm((.0193339*s+.119192*c+.9503041*p)/Tn)),alpha:h.a}}function rf(h){let s=(h.l+16)/116,c=isNaN(h.a)?s:s+h.a/500,p=isNaN(h.b)?s:s-h.b/200;return s=1*Lm(s),c=Uu*Lm(c),p=Tn*Lm(p),new Jn(ca(3.2404542*c-1.5371385*s-.4985314*p),ca(-.969266*c+1.8760108*s+.041556*p),ca(.0556434*c-.2040259*s+1.0572252*p),h.alpha)}function d0(h,s,c){const p=s-h;return h+c*(p>180||p<-180?p-360*Math.round(p/360):p)}const Bd={forward:Ap,reverse:rf,interpolate:function(h,s,c){return{l:Lr(h.l,s.l,c),a:Lr(h.a,s.a,c),b:Lr(h.b,s.b,c),alpha:Lr(h.alpha,s.alpha,c)}}},Xc={forward:function(h){const{l:s,a:c,b:p}=Ap(h),v=Math.atan2(p,c)*zi;return{h:v<0?v+360:v,c:Math.sqrt(c*c+p*p),l:s,alpha:h.a}},reverse:function(h){const s=h.h*wp,c=h.c;return rf({l:h.l,a:Math.cos(s)*c,b:Math.sin(s)*c,alpha:h.alpha})},interpolate:function(h,s,c){return{h:d0(h.h,s.h,c),c:Lr(h.c,s.c,c),l:Lr(h.l,s.l,c),alpha:Lr(h.alpha,s.alpha,c)}}};var Tp=Object.freeze({__proto__:null,hcl:Xc,lab:Bd});class Ps{constructor(s,c,p,v,m,x){this.type=s,this.operator=c,this.interpolation=p,this.input=v,this.dynamicStops=m,this.labels=[],this.outputs=[];for(const[k,N]of x)this.labels.push(k),this.outputs.push(N)}static interpolationFactor(s,c,p,v){let m=0;if(s.name==="exponential")m=zm(c,s.base,p,v);else if(s.name==="linear")m=zm(c,1,p,v);else if(s.name==="cubic-bezier"){const x=s.controlPoints;m=new Lt(x[0],x[1],x[2],x[3]).solve(zm(c,1,p,v))}return m}static parse(s,c){let[p,v,m,...x]=s;if(!Array.isArray(v)||v.length===0)return c.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const z=v[1];if(typeof z!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:z}}else{if(v[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const z=v.slice(1);if(z.length!==4||z.some(C=>typeof C!="number"||C<0||C>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:z}}}if(s.length-1<3)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length-1>3&&(s.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(m=c.parse(m,2,wr),!m)return null;const k=[];let N=null;if(p==="interpolate-hcl"||p==="interpolate-lab"?N=hs:c.expectedType&&c.expectedType.kind!=="value"&&(N=c.expectedType),s.length-1==3){const z=c.parse(x[0],3,ai);return z?new Ps(N,p,v,m,z,k):null}for(let z=0;z<x.length;z+=2){const C=x[z],R=x[z+1],L=z+3,j=z+4;if(typeof C!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(k.length&&k[k.length-1][0]>=C)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const I=c.parse(R,j,N);if(!I)return null;N=N||I.type,k.push([C,I])}return N.kind==="number"||N.kind==="color"||N.kind==="array"&&N.itemType.kind==="number"&&typeof N.N=="number"?new Ps(N,p,v,m,null,k):c.error(`Type ${fa(N)} is not interpolatable.`)}evaluate(s){let c=this.labels,p=this.outputs;if(this.dynamicStops){const C=this.dynamicStops.evaluate(s);if(C.length%2!=0)throw new pa("Expected an even number of arguments.");c=[],p=[];for(let R=0;R<C.length;R+=2){const L=C[R],j=new ka(wr,C[R+1]);if(typeof L!="number")throw new pa('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(c.length&&c[c.length-1]>=L)throw new pa('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');c.push(L),p.push(j)}if(c.length===0)throw new pa("Expected at least one input/output pair.")}if(c.length===1)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=c[0])return p[0].evaluate(s);const m=c.length;if(v>=c[m-1])return p[m-1].evaluate(s);const x=tf(c,v),k=Ps.interpolationFactor(this.interpolation,v,c[x],c[x+1]),N=p[x].evaluate(s),z=p[x+1].evaluate(s);return this.operator==="interpolate"?Nu[this.type.kind.toLowerCase()](N,z,k):this.operator==="interpolate-hcl"?Xc.reverse(Xc.interpolate(Xc.forward(N),Xc.forward(z),k)):Bd.reverse(Bd.interpolate(Bd.forward(N),Bd.forward(z),k))}eachChild(s){s(this.input);for(const c of this.outputs)s(c)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,s,this.input.serialize()];if(this.dynamicStops)c.push(this.dynamicStops.serialize());else for(let p=0;p<this.labels.length;p++)c.push(this.labels[p],this.outputs[p].serialize());return c}}function zm(h,s,c,p){const v=p-c,m=h-c;return v===0?0:s===1?m/v:(Math.pow(s,m)-1)/(Math.pow(s,v)-1)}class Fm{constructor(s,c){this.type=s,this.args=c}static parse(s,c){if(s.length<2)return c.error("Expectected at least one argument.");let p=null;const v=c.expectedType;v&&v.kind!=="value"&&(p=v);const m=[];for(const k of s.slice(1)){const N=c.parse(k,1+m.length,p,void 0,{typeAnnotation:"omit"});if(!N)return null;p=p||N.type,m.push(N)}const x=v&&m.some(k=>qs(v,k.type));return new Fm(x?ai:p,m)}evaluate(s){let c,p=null,v=0;for(const m of this.args){if(v++,p=m.evaluate(s),p&&p instanceof Ts&&!p.available&&(c||(c=p),p=null,v===this.args.length))return c;if(p!==null)break}return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(c=>{s.push(c.serialize())}),s}}class Bm{constructor(s,c){this.type=c.type,this.bindings=[].concat(s),this.result=c}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const c of this.bindings)s(c[1]);s(this.result)}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let m=1;m<s.length-1;m+=2){const x=s[m];if(typeof x!="string")return c.error(`Expected string, but found ${typeof x} instead.`,m);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",m);const k=c.parse(s[m+1],m+1);if(!k)return null;p.push([x,k])}const v=c.parse(s[s.length-1],s.length-1,c.expectedType,p);return v?new Bm(p,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[c,p]of this.bindings)s.push(c,p.serialize());return s.push(this.result.serialize()),s}}class Vm{constructor(s,c,p){this.type=s,this.index=c,this.input=p}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=c.parse(s[1],1,wr),v=c.parse(s[2],2,qa(c.expectedType||ai));return p&&v?new Vm(v.type.itemType,p,v):null}evaluate(s){const c=this.index.evaluate(s),p=this.input.evaluate(s);if(c<0)throw new pa(`Array index out of bounds: ${c} < 0.`);if(c>p.length-1)throw new pa(`Array index out of bounds: ${c} > ${p.length-1}.`);if(c===Math.floor(c))return p[c];const v=Math.floor(c),m=Math.ceil(c),x=p[v],k=p[m];if(typeof x!="number"||typeof k!="number")throw new pa(`Cannot interpolate between non-number values at index ${c}.`);const N=c-v;return x*(1-N)+k*N}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class nf{constructor(s,c){this.type=Gn,this.needle=s,this.haystack=c}static parse(s,c){if(s.length!==3)return c.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=c.parse(s[1],1,ai),v=c.parse(s[2],2,ai);return p&&v?jd(p.type,[Gn,mi,wr,Iu,ai])?new nf(p,v):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${fa(p.type)} instead`):null}evaluate(s){const c=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(p==null)return!1;if(!Od(c,["boolean","string","number","null"]))throw new pa(`Expected first argument to be of type boolean, string, number or null, but found ${fa(ta(c))} instead.`);if(!Od(p,["string","array"]))throw new pa(`Expected second argument to be of type array or string, but found ${fa(ta(p))} instead.`);return p.indexOf(c)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Vd{constructor(s,c,p){this.type=wr,this.needle=s,this.haystack=c,this.fromIndex=p}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=c.parse(s[1],1,ai),v=c.parse(s[2],2,ai);if(!p||!v)return null;if(!jd(p.type,[Gn,mi,wr,Iu,ai]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${fa(p.type)} instead`);if(s.length===4){const m=c.parse(s[3],3,wr);return m?new Vd(p,v,m):null}return new Vd(p,v)}evaluate(s){const c=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!Od(c,["boolean","string","number","null"]))throw new pa(`Expected first argument to be of type boolean, string, number or null, but found ${fa(ta(c))} instead.`);if(!Od(p,["string","array"]))throw new pa(`Expected second argument to be of type array or string, but found ${fa(ta(p))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(s);return p.indexOf(c,v)}return p.indexOf(c)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Pp{constructor(s,c,p,v,m,x){this.inputType=s,this.type=c,this.input=p,this.cases=v,this.outputs=m,this.otherwise=x}static parse(s,c){if(s.length<5)return c.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return c.error("Expected an even number of arguments.");let p,v;c.expectedType&&c.expectedType.kind!=="value"&&(v=c.expectedType);const m={},x=[];for(let z=2;z<s.length-1;z+=2){let C=s[z];const R=s[z+1];Array.isArray(C)||(C=[C]);const L=c.concat(z);if(C.length===0)return L.error("Expected at least one branch label.");for(const I of C){if(typeof I!="number"&&typeof I!="string")return L.error("Branch labels must be numbers or strings.");if(typeof I=="number"&&Math.abs(I)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof I=="number"&&Math.floor(I)!==I)return L.error("Numeric branch labels must be integer values.");if(p){if(L.checkSubtype(p,ta(I)))return null}else p=ta(I);if(m[String(I)]!==void 0)return L.error("Branch labels must be unique.");m[String(I)]=x.length}const j=c.parse(R,z,v);if(!j)return null;v=v||j.type,x.push(j)}const k=c.parse(s[1],1,ai);if(!k)return null;const N=c.parse(s[s.length-1],s.length-1,v);return N?k.type.kind!=="value"&&c.concat(1).checkSubtype(p,k.type)?null:new Pp(p,v,k,m,x,N):null}evaluate(s){const c=this.input.evaluate(s);return(ta(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),p=[],v={};for(const x of c){const k=v[this.cases[x]];k===void 0?(v[this.cases[x]]=p.length,p.push([this.cases[x],[x]])):p[k][1].push(x)}const m=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,k]of p)s.push(k.length===1?m(k[0]):k.map(m)),s.push(this.outputs[x].serialize());return s.push(this.otherwise.serialize()),s}}class Cp{constructor(s,c,p){this.type=s,this.branches=c,this.otherwise=p}static parse(s,c){if(s.length<4)return c.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return c.error("Expected an odd number of arguments.");let p;c.expectedType&&c.expectedType.kind!=="value"&&(p=c.expectedType);const v=[];for(let x=1;x<s.length-1;x+=2){const k=c.parse(s[x],x,Gn);if(!k)return null;const N=c.parse(s[x+1],x+1,p);if(!N)return null;v.push([k,N]),p=p||N.type}const m=c.parse(s[s.length-1],s.length-1,p);return m?new Cp(p,v,m):null}evaluate(s){for(const[c,p]of this.branches)if(c.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[c,p]of this.branches)s(c),s(p);s(this.otherwise)}outputDefined(){return this.branches.every(([s,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(c=>{s.push(c.serialize())}),s}}class af{constructor(s,c,p,v){this.type=s,this.input=c,this.beginIndex=p,this.endIndex=v}static parse(s,c){if(s.length<=2||s.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=c.parse(s[1],1,ai),v=c.parse(s[2],2,wr);if(!p||!v)return null;if(!jd(p.type,[qa(ai),mi,ai]))return c.error(`Expected first argument to be of type array or string, but found ${fa(p.type)} instead`);if(s.length===4){const m=c.parse(s[3],3,wr);return m?new af(p.type,p,v,m):null}return new af(p.type,p,v)}evaluate(s){const c=this.input.evaluate(s),p=this.beginIndex.evaluate(s);if(!Od(c,["string","array"]))throw new pa(`Expected first argument to be of type array or string, but found ${fa(ta(c))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(s);return c.slice(p,v)}return c.slice(p)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Um(h,s){return h==="=="||h==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function h0(h,s,c,p){return p.compare(s,c)===0}function Ud(h,s,c){const p=h!=="=="&&h!=="!=";return class $ne{constructor(m,x,k){this.type=Gn,this.lhs=m,this.rhs=x,this.collator=k,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}static parse(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");const k=m[0];let N=x.parse(m[1],1,ai);if(!N)return null;if(!Um(k,N.type))return x.concat(1).error(`"${k}" comparisons are not supported for type '${fa(N.type)}'.`);let z=x.parse(m[2],2,ai);if(!z)return null;if(!Um(k,z.type))return x.concat(2).error(`"${k}" comparisons are not supported for type '${fa(z.type)}'.`);if(N.type.kind!==z.type.kind&&N.type.kind!=="value"&&z.type.kind!=="value")return x.error(`Cannot compare types '${fa(N.type)}' and '${fa(z.type)}'.`);p&&(N.type.kind==="value"&&z.type.kind!=="value"?N=new Wl(z.type,[N]):N.type.kind!=="value"&&z.type.kind==="value"&&(z=new Wl(N.type,[z])));let C=null;if(m.length===4){if(N.type.kind!=="string"&&z.type.kind!=="string"&&N.type.kind!=="value"&&z.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(C=x.parse(m[3],3,qc),!C)return null}return new $ne(N,z,C)}evaluate(m){const x=this.lhs.evaluate(m),k=this.rhs.evaluate(m);if(p&&this.hasUntypedArgument){const N=ta(x),z=ta(k);if(N.kind!==z.kind||N.kind!=="string"&&N.kind!=="number")throw new pa(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${N.kind}, ${z.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const N=ta(x),z=ta(k);if(N.kind!=="string"||z.kind!=="string")return s(m,x,k)}return this.collator?c(m,x,k,this.collator.evaluate(m)):s(m,x,k)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[h];return this.eachChild(x=>{m.push(x.serialize())}),m}}}const U_=Ud("==",function(h,s,c){return s===c},h0),$_=Ud("!=",function(h,s,c){return s!==c},function(h,s,c,p){return!h0(0,s,c,p)}),Sy=Ud("<",function(h,s,c){return s<c},function(h,s,c,p){return p.compare(s,c)<0}),qu=Ud(">",function(h,s,c){return s>c},function(h,s,c,p){return p.compare(s,c)>0}),f0=Ud("<=",function(h,s,c){return s<=c},function(h,s,c,p){return p.compare(s,c)<=0}),sf=Ud(">=",function(h,s,c){return s>=c},function(h,s,c,p){return p.compare(s,c)>=0});class Pl{constructor(s,c,p,v,m,x){this.type=mi,this.number=s,this.locale=c,this.currency=p,this.unit=v,this.minFractionDigits=m,this.maxFractionDigits=x}static parse(s,c){if(s.length!==3)return c.error("Expected two arguments.");const p=c.parse(s[1],1,wr);if(!p)return null;const v=s[2];if(typeof v!="object"||Array.isArray(v))return c.error("NumberFormat options argument must be an object.");let m=null;if(v.locale&&(m=c.parseObjectValue(v.locale,2,"locale",mi),!m))return null;let x=null;if(v.currency&&(x=c.parseObjectValue(v.currency,2,"currency",mi),!x))return null;let k=null;if(v.unit&&(k=c.parseObjectValue(v.unit,2,"unit",mi),!k))return null;let N=null;if(v["min-fraction-digits"]&&(N=c.parseObjectValue(v["min-fraction-digits"],2,"min-fraction-digits",wr),!N))return null;let z=null;return v["max-fraction-digits"]&&(z=c.parseObjectValue(v["max-fraction-digits"],2,"max-fraction-digits",wr),!z)?null:new Pl(p,m,x,k,N,z)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class $d{constructor(s){this.type=wr,this.input=s}static parse(s,c){if(s.length!==2)return c.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=c.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${fa(p.type)} instead.`):new $d(p):null}evaluate(s){const c=this.input.evaluate(s);if(typeof c=="string"||Array.isArray(c))return c.length;throw new pa(`Expected value to be of type string or array, but found ${fa(ta(c))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(c=>{s.push(c.serialize())}),s}}function Cl(h){return function(){h=1831565813+(h|=0)|0;let s=Math.imul(h^h>>>15,1|h);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}const Gu={"==":U_,"!=":$_,">":qu,"<":Sy,">=":sf,"<=":f0,array:Wl,at:Vm,boolean:Wl,case:Cp,coalesce:Fm,collator:Em,format:Wc,image:Nd,in:nf,"index-of":Vd,interpolate:Ps,"interpolate-hcl":Ps,"interpolate-lab":Ps,length:$d,let:Bm,literal:ka,match:Pp,number:Wl,"number-format":Pl,object:Wl,slice:af,step:Fd,string:Wl,"to-boolean":mc,"to-color":mc,"to-number":mc,"to-string":mc,var:xc,within:Wr,distance:yc,config:Bu};function Ay(h,[s,c,p,v]){s=s.evaluate(h),c=c.evaluate(h),p=p.evaluate(h);const m=v?v.evaluate(h):1,x=Hh(s,c,p,m);if(x)throw new pa(x);return new Jn(s/255*m,c/255*m,p/255*m,m)}function p0(h,[s,c,p,v]){s=s.evaluate(h),c=c.evaluate(h),p=p.evaluate(h);const m=v?v.evaluate(h):1,x=function(z,C,R,L){return typeof z=="number"&&z>=0&&z<=360?typeof C=="number"&&C>=0&&C<=100&&typeof R=="number"&&R>=0&&R<=100?L===void 0||typeof L=="number"&&L>=0&&L<=1?null:`Invalid hsla value [${[z,C,R,L].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof L=="number"?[z,C,R,L]:[z,C,R]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof L=="number"?[z,C,R,L]:[z,C,R]).join(", ")}]: 'h' must be between 0 and 360.`}(s,c,p,m);if(x)throw new pa(x);const k=`hsla(${s}, ${c}%, ${p}%, ${m})`,N=Jn.parse(k);if(!N)throw new pa(`Failed to parse HSLA color: ${k}`);return N}function Wu(h,s){return h in s}function qd(h,s){const c=s[h];return c===void 0?null:c}function cl(h){return{type:h}}function of(h){return{result:"success",value:h}}function _o(h){return{result:"error",value:h}}function Jc(h,s){return!!h&&!!h.parameters&&h.parameters.indexOf(s)>-1}function El(h){return h["property-type"]==="data-driven"}function ma(h){return Jc(h.expression,"measure-light")}function Ji(h){return Jc(h.expression,"zoom")}function kl(h){return!!h.expression&&h.expression.interpolated}function Is(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function Uo(h){return h}function Qc(h,s){const c=s.type==="color",p=h.stops&&typeof h.stops[0][0]=="object",v=p||!(p||h.property!==void 0),m=h.type||(kl(s)?"exponential":"interval");if(c&&((h=Ru({},h)).stops&&(h.stops=h.stops.map(z=>[z[0],Jn.parse(z[1])])),h.default=Jn.parse(h.default?h.default:s.default)),h.colorSpace&&h.colorSpace!=="rgb"&&!Tp[h.colorSpace])throw new Error(`Unknown color space: ${h.colorSpace}`);let x,k,N;if(m==="exponential")x=Ty;else if(m==="interval")x=$m;else if(m==="categorical"){x=$o,k=Object.create(null);for(const z of h.stops)k[z[0]]=z[1];N=typeof h.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);x=Py}if(p){const z={},C=[];for(let j=0;j<h.stops.length;j++){const I=h.stops[j],$=I[0].zoom;z[$]===void 0&&(z[$]={zoom:$,type:h.type,property:h.property,default:h.default,stops:[]},C.push($)),z[$].stops.push([I[0].value,I[1]])}const R=[];for(const j of C)R.push([z[j].zoom,Qc(z[j],s)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:Ps.interpolationFactor.bind(void 0,L),zoomStops:R.map(j=>j[0]),evaluate:({zoom:j},I)=>Ty({stops:R,base:h.base},s,j).evaluate(j,I)}}if(v){const z=m==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:Ps.interpolationFactor.bind(void 0,z),zoomStops:h.stops.map(C=>C[0]),evaluate:({zoom:C})=>x(h,s,C,k,N)}}return{kind:"source",evaluate(z,C){const R=C&&C.properties?C.properties[h.property]:void 0;return R===void 0?Kl(h.default,s.default):x(h,s,R,k,N)}}}function Kl(h,s,c){return h!==void 0?h:s!==void 0?s:c!==void 0?c:void 0}function $o(h,s,c,p,v){return Kl(typeof c===v?p[c]:void 0,h.default,s.default)}function $m(h,s,c){if(vo(c)!=="number")return Kl(h.default,s.default);const p=h.stops.length;if(p===1||c<=h.stops[0][0])return h.stops[0][1];if(c>=h.stops[p-1][0])return h.stops[p-1][1];const v=tf(h.stops.map(m=>m[0]),c);return h.stops[v][1]}function Ty(h,s,c){const p=h.base!==void 0?h.base:1;if(vo(c)!=="number")return Kl(h.default,s.default);const v=h.stops.length;if(v===1||c<=h.stops[0][0])return h.stops[0][1];if(c>=h.stops[v-1][0])return h.stops[v-1][1];const m=tf(h.stops.map(C=>C[0]),c),x=function(C,R,L,j){const I=j-L,$=C-L;return I===0?0:R===1?$/I:(Math.pow(R,$)-1)/(Math.pow(R,I)-1)}(c,p,h.stops[m][0],h.stops[m+1][0]),k=h.stops[m][1],N=h.stops[m+1][1];let z=Nu[s.type]||Uo;if(h.colorSpace&&h.colorSpace!=="rgb"){const C=Tp[h.colorSpace];z=(R,L)=>C.reverse(C.interpolate(C.forward(R),C.forward(L),x))}return typeof k.evaluate=="function"?{evaluate(...C){const R=k.evaluate.apply(void 0,C),L=N.evaluate.apply(void 0,C);if(R!==void 0&&L!==void 0)return z(R,L,x)}}:z(k,N,x)}function Py(h,s,c){return s.type==="color"?c=Jn.parse(c):s.type==="formatted"?c=As.fromString(c.toString()):s.type==="resolvedImage"?c=Ts.build(c.toString()):vo(c)===s.type||s.type==="enum"&&s.values[c]||(c=void 0),Kl(c,h.default,s.default)}xo.register(Gu,{error:[{kind:"error"},[mi],(h,[s])=>{throw new pa(s.evaluate(h))}],typeof:[mi,[ai],(h,[s])=>fa(ta(s.evaluate(h)))],"to-rgba":[qa(wr,4),[hs],(h,[s])=>s.evaluate(h).toRenderColor(null).toArray()],"to-hsla":[qa(wr,4),[hs],(h,[s])=>s.evaluate(h).toRenderColor(null).toHslaArray()],rgb:[hs,[wr,wr,wr],Ay],rgba:[hs,[wr,wr,wr,wr],Ay],hsl:[hs,[wr,wr,wr],p0],hsla:[hs,[wr,wr,wr,wr],p0],has:{type:Gn,overloads:[[[mi],(h,[s])=>Wu(s.evaluate(h),h.properties())],[[mi,fc],(h,[s,c])=>Wu(s.evaluate(h),c.evaluate(h))]]},get:{type:ai,overloads:[[[mi],(h,[s])=>qd(s.evaluate(h),h.properties())],[[mi,fc],(h,[s,c])=>qd(s.evaluate(h),c.evaluate(h))]]},"feature-state":[ai,[mi],(h,[s])=>qd(s.evaluate(h),h.featureState||{})],properties:[fc,[],h=>h.properties()],"geometry-type":[mi,[],h=>h.geometryType()],id:[ai,[],h=>h.id()],zoom:[wr,[],h=>h.globals.zoom],pitch:[wr,[],h=>h.globals.pitch||0],"distance-from-center":[wr,[],h=>h.distanceFromCenter()],"measure-light":[wr,[mi],(h,[s])=>h.measureLight(s.evaluate(h))],"heatmap-density":[wr,[],h=>h.globals.heatmapDensity||0],"line-progress":[wr,[],h=>h.globals.lineProgress||0],"raster-value":[wr,[],h=>h.globals.rasterValue||0],"raster-particle-speed":[wr,[],h=>h.globals.rasterParticleSpeed||0],"sky-radial-progress":[wr,[],h=>h.globals.skyRadialProgress||0],accumulated:[ai,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[wr,cl(wr),(h,s)=>{let c=0;for(const p of s)c+=p.evaluate(h);return c}],"*":[wr,cl(wr),(h,s)=>{let c=1;for(const p of s)c*=p.evaluate(h);return c}],"-":{type:wr,overloads:[[[wr,wr],(h,[s,c])=>s.evaluate(h)-c.evaluate(h)],[[wr],(h,[s])=>-s.evaluate(h)]]},"/":[wr,[wr,wr],(h,[s,c])=>s.evaluate(h)/c.evaluate(h)],"%":[wr,[wr,wr],(h,[s,c])=>s.evaluate(h)%c.evaluate(h)],ln2:[wr,[],()=>Math.LN2],pi:[wr,[],()=>Math.PI],e:[wr,[],()=>Math.E],"^":[wr,[wr,wr],(h,[s,c])=>Math.pow(s.evaluate(h),c.evaluate(h))],sqrt:[wr,[wr],(h,[s])=>Math.sqrt(s.evaluate(h))],log10:[wr,[wr],(h,[s])=>Math.log(s.evaluate(h))/Math.LN10],ln:[wr,[wr],(h,[s])=>Math.log(s.evaluate(h))],log2:[wr,[wr],(h,[s])=>Math.log(s.evaluate(h))/Math.LN2],sin:[wr,[wr],(h,[s])=>Math.sin(s.evaluate(h))],cos:[wr,[wr],(h,[s])=>Math.cos(s.evaluate(h))],tan:[wr,[wr],(h,[s])=>Math.tan(s.evaluate(h))],asin:[wr,[wr],(h,[s])=>Math.asin(s.evaluate(h))],acos:[wr,[wr],(h,[s])=>Math.acos(s.evaluate(h))],atan:[wr,[wr],(h,[s])=>Math.atan(s.evaluate(h))],min:[wr,cl(wr),(h,s)=>Math.min(...s.map(c=>c.evaluate(h)))],max:[wr,cl(wr),(h,s)=>Math.max(...s.map(c=>c.evaluate(h)))],abs:[wr,[wr],(h,[s])=>Math.abs(s.evaluate(h))],round:[wr,[wr],(h,[s])=>{const c=s.evaluate(h);return c<0?-Math.round(-c):Math.round(c)}],floor:[wr,[wr],(h,[s])=>Math.floor(s.evaluate(h))],ceil:[wr,[wr],(h,[s])=>Math.ceil(s.evaluate(h))],"filter-==":[Gn,[mi,ai],(h,[s,c])=>h.properties()[s.value]===c.value],"filter-id-==":[Gn,[ai],(h,[s])=>h.id()===s.value],"filter-type-==":[Gn,[mi],(h,[s])=>h.geometryType()===s.value],"filter-<":[Gn,[mi,ai],(h,[s,c])=>{const p=h.properties()[s.value],v=c.value;return typeof p==typeof v&&p<v}],"filter-id-<":[Gn,[ai],(h,[s])=>{const c=h.id(),p=s.value;return typeof c==typeof p&&c<p}],"filter->":[Gn,[mi,ai],(h,[s,c])=>{const p=h.properties()[s.value],v=c.value;return typeof p==typeof v&&p>v}],"filter-id->":[Gn,[ai],(h,[s])=>{const c=h.id(),p=s.value;return typeof c==typeof p&&c>p}],"filter-<=":[Gn,[mi,ai],(h,[s,c])=>{const p=h.properties()[s.value],v=c.value;return typeof p==typeof v&&p<=v}],"filter-id-<=":[Gn,[ai],(h,[s])=>{const c=h.id(),p=s.value;return typeof c==typeof p&&c<=p}],"filter->=":[Gn,[mi,ai],(h,[s,c])=>{const p=h.properties()[s.value],v=c.value;return typeof p==typeof v&&p>=v}],"filter-id->=":[Gn,[ai],(h,[s])=>{const c=h.id(),p=s.value;return typeof c==typeof p&&c>=p}],"filter-has":[Gn,[ai],(h,[s])=>s.value in h.properties()],"filter-has-id":[Gn,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[Gn,[qa(mi)],(h,[s])=>s.value.indexOf(h.geometryType())>=0],"filter-id-in":[Gn,[qa(ai)],(h,[s])=>s.value.indexOf(h.id())>=0],"filter-in-small":[Gn,[mi,qa(ai)],(h,[s,c])=>c.value.indexOf(h.properties()[s.value])>=0],"filter-in-large":[Gn,[mi,qa(ai)],(h,[s,c])=>function(p,v,m,x){for(;m<=x;){const k=m+x>>1;if(v[k]===p)return!0;v[k]>p?x=k-1:m=k+1}return!1}(h.properties()[s.value],c.value,0,c.value.length-1)],all:{type:Gn,overloads:[[[Gn,Gn],(h,[s,c])=>s.evaluate(h)&&c.evaluate(h)],[cl(Gn),(h,s)=>{for(const c of s)if(!c.evaluate(h))return!1;return!0}]]},any:{type:Gn,overloads:[[[Gn,Gn],(h,[s,c])=>s.evaluate(h)||c.evaluate(h)],[cl(Gn),(h,s)=>{for(const c of s)if(c.evaluate(h))return!0;return!1}]]},"!":[Gn,[Gn],(h,[s])=>!s.evaluate(h)],"is-supported-script":[Gn,[mi],(h,[s])=>{const c=h.globals&&h.globals.isSupportedScript;return!c||c(s.evaluate(h))}],upcase:[mi,[mi],(h,[s])=>s.evaluate(h).toUpperCase()],downcase:[mi,[mi],(h,[s])=>s.evaluate(h).toLowerCase()],concat:[mi,cl(ai),(h,s)=>s.map(c=>Ea(c.evaluate(h))).join("")],"resolved-locale":[mi,[qc],(h,[s])=>s.evaluate(h).resolvedLocale()],random:[wr,[wr,wr,ai],(h,s)=>{const[c,p,v]=s.map(x=>x.evaluate(h));if(c>p||c===p)return c;let m;if(typeof v=="string")m=function(x){let k=0;if(x.length===0)return k;for(let N=0;N<x.length;N++)k=(k<<5)-k+x.charCodeAt(N),k|=0;return k}(v);else{if(typeof v!="number")throw new pa(`Invalid seed input: ${v}`);m=v}return c+Cl(m)()*(p-c)}]});class Gd{constructor(s,c,p,v){this.expression=s,this._warningHistory={},this._evaluator=new py(p,v),this._defaultValue=c?function(m){return m.type==="color"&&(Is(m.default)||Array.isArray(m.default))?new Jn(0,0,0,0):m.type==="color"?Jn.parse(m.default)||null:m.default===void 0?null:m.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this.configDependencies=Ld(s)}evaluateWithoutErrorHandling(s,c,p,v,m,x,k,N){return this._evaluator.globals=s,this._evaluator.feature=c,this._evaluator.featureState=p,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=k||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(s,c,p,v,m,x,k,N){this._evaluator.globals=s,this._evaluator.feature=c||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=k||null,this._evaluator.featureDistanceData=N||null;try{const z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new pa(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${z.message}`)),this._defaultValue}}}function Wd(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in Gu}function qo(h,s,c,p){const v=new ef(Gu,[],s?function(x){const k={color:hs,string:mi,number:wr,enum:mi,boolean:Gn,formatted:Bo,resolvedImage:pc};return x.type==="array"?qa(k[x.value]||ai,x.length):k[x.type]}(s):void 0,void 0,void 0,c,p),m=v.parse(h,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?of(new Gd(m,s,c,p)):_o(v.errors)}class Hd{constructor(s,c,p,v){this.kind=s,this._styleExpression=c,this.isLightConstant=p,this.isLineProgressConstant=v,this.isStateDependent=s!=="constant"&&!vc(c.expression),this.configDependencies=Ld(c.expression)}evaluateWithoutErrorHandling(s,c,p,v,m,x){return this._styleExpression.evaluateWithoutErrorHandling(s,c,p,v,m,x)}evaluate(s,c,p,v,m,x){return this._styleExpression.evaluate(s,c,p,v,m,x)}}class Kd{constructor(s,c,p,v,m,x){this.kind=s,this.zoomStops=p,this._styleExpression=c,this.isStateDependent=s!=="camera"&&!vc(c.expression),this.isLightConstant=m,this.isLineProgressConstant=x,this.configDependencies=Ld(c.expression),this.interpolationType=v}evaluateWithoutErrorHandling(s,c,p,v,m,x){return this._styleExpression.evaluateWithoutErrorHandling(s,c,p,v,m,x)}evaluate(s,c,p,v,m,x){return this._styleExpression.evaluate(s,c,p,v,m,x)}interpolationFactor(s,c,p){return this.interpolationType?Ps.interpolationFactor(this.interpolationType,s,c,p):0}}function Cy(h,s,c,p){if((h=qo(h,s,c,p)).result==="error")return h;const v=h.value.expression,m=Yc(v);if(!m&&!El(s))return _o([new hn("","data expressions not supported")]);const x=Vu(v,["zoom","pitch","distance-from-center"]);if(!x&&!Ji(s))return _o([new hn("","zoom expressions not supported")]);const k=Vu(v,["measure-light"]);if(!k&&!ma(s))return _o([new hn("","measure-light expression not supported")]);const N=Vu(v,["line-progress"]);if(!N&&!function(R){return Jc(R.expression,"line-progress")}(s))return _o([new hn("","line-progress expression not supported")]);const z=s.expression&&s.expression.relaxZoomRestriction,C=Ml(v);return C||x||z?C instanceof hn?_o([C]):C instanceof Ps&&!kl(s)?_o([new hn("",'"interpolate" expressions cannot be used with this property')]):of(C?new Kd(m&&N?"camera":"composite",h.value,C.labels,C instanceof Ps?C.interpolation:void 0,k,N):new Hd(m&&N?"constant":"source",h.value,k,N)):_o([new hn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Ep{constructor(s,c){this._parameters=s,this._specification=c,Ru(this,Qc(this._parameters,this._specification))}static deserialize(s){return new Ep(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Ml(h){let s=null;if(h instanceof Bm)s=Ml(h.result);else if(h instanceof Fm){for(const c of h.args)if(s=Ml(c),s)break}else(h instanceof Fd||h instanceof Ps)&&h.input instanceof xo&&h.input.name==="zoom"&&(s=h);return s instanceof hn||h.eachChild(c=>{const p=Ml(c);p instanceof hn?s=p:s&&p&&s!==p&&(s=new hn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}var Hu,Zd,qm=function(){if(Zd)return Hu;Zd=1,Hu=s;var h=3;function s(c,p,v){var m=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var x=new Int32Array(this.arrayBuffer);c=x[0],this.d=(p=x[1])+2*(v=x[2]);for(var k=0;k<this.d*this.d;k++){var N=x[h+k],z=x[h+k+1];m.push(N===z?null:x.subarray(N,z))}var C=x[h+m.length+1];this.keys=x.subarray(x[h+m.length],C),this.bboxes=x.subarray(C),this.insert=this._insertReadonly}else{this.d=p+2*v;for(var R=0;R<this.d*this.d;R++)m.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=c,this.padding=v,this.scale=p/c,this.uid=0;var L=v/p*c;this.min=-L,this.max=c+L}return s.prototype.insert=function(c,p,v,m,x){this._forEachCell(p,v,m,x,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(m),this.bboxes.push(x)},s.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},s.prototype._insertCell=function(c,p,v,m,x,k){this.cells[x].push(k)},s.prototype.query=function(c,p,v,m,x){var k=this.min,N=this.max;if(c<=k&&p<=k&&N<=v&&N<=m&&!x)return Array.prototype.slice.call(this.keys);var z=[];return this._forEachCell(c,p,v,m,this._queryCell,z,{},x),z},s.prototype._queryCell=function(c,p,v,m,x,k,N,z){var C=this.cells[x];if(C!==null)for(var R=this.keys,L=this.bboxes,j=0;j<C.length;j++){var I=C[j];if(N[I]===void 0){var $=4*I;(z?z(L[$+0],L[$+1],L[$+2],L[$+3]):c<=L[$+2]&&p<=L[$+3]&&v>=L[$+0]&&m>=L[$+1])?(N[I]=!0,k.push(R[I])):N[I]=!1}}},s.prototype._forEachCell=function(c,p,v,m,x,k,N,z){for(var C=this._convertToCellCoord(c),R=this._convertToCellCoord(p),L=this._convertToCellCoord(v),j=this._convertToCellCoord(m),I=C;I<=L;I++)for(var $=R;$<=j;$++){var X=this.d*$+I;if((!z||z(this._convertFromCellCoord(I),this._convertFromCellCoord($),this._convertFromCellCoord(I+1),this._convertFromCellCoord($+1)))&&x.call(this,c,p,v,m,X,k,N,z))return}},s.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},s.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},s.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,p=h+this.cells.length+1+1,v=0,m=0;m<this.cells.length;m++)v+=this.cells[m].length;var x=new Int32Array(p+v+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var k=p,N=0;N<c.length;N++){var z=c[N];x[h+N]=k,x.set(z,k),k+=z.length}return x[h+c.length]=k,x.set(this.keys,k),x[h+c.length+1]=k+=this.keys.length,x.set(this.bboxes,k),k+=this.bboxes.length,x.buffer},Hu}(),_c=_(qm);const bo={};function mr(h,s,c={}){Object.defineProperty(h,"_classRegistryKey",{value:s,writable:!1}),bo[s]={klass:h,omit:c.omit||[]}}mr(Object,"Object"),_c.serialize=function(h,s){const c=h.toArrayBuffer();return s&&s.add(c),{buffer:c}},_c.deserialize=function(h){return new _c(h.buffer)},Object.defineProperty(_c,"name",{value:"Grid"}),mr(_c,"Grid"),typeof DOMMatrix<"u"&&mr(DOMMatrix,"DOMMatrix"),mr(Jn,"Color"),mr(Error,"Error"),mr(As,"Formatted"),mr(Sl,"FormattedSection"),mr(Ca,"AJAXError"),mr(Ts,"ResolvedImage"),mr(Ep,"StylePropertyFunction"),mr(Gd,"StyleExpression",{omit:["_evaluator"]}),mr(ll,"ImageIdWithOptions"),mr(Kd,"ZoomDependentExpression"),mr(Hd,"ZoomConstantExpression"),mr(xo,"CompoundExpression",{omit:["_evaluate"]});for(const h in Gu)bo[Gu[h]._classRegistryKey]||mr(Gu[h],`Expression${h}`);function eu(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function Zl(h){return self.ImageBitmap&&h instanceof ImageBitmap}function so(h,s){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp)return h;if(eu(h)||Zl(h))return s&&s.add(h),h;if(ArrayBuffer.isView(h))return s&&s.add(h.buffer),h;if(h instanceof ImageData)return s&&s.add(h.data.buffer),h;if(Array.isArray(h)){const c=[];for(const p of h)c.push(so(p,s));return c}if(h instanceof Map){const c={$name:"Map"};for(const[p,v]of h.entries())c[p]=so(v);return c}if(h instanceof Set){const c={$name:"Set"};let p=0;for(const v of h.values())c[++p]=so(v);return c}if(typeof h=="object"){const c=h.constructor,p=c._classRegistryKey;if(!p)throw new Error(`Can't serialize object of unregistered class "${p}".`);const v=c.serialize?c.serialize(h,s):{};if(!c.serialize){for(const m in h)h.hasOwnProperty(m)&&(bo[p].omit.indexOf(m)>=0||(v[m]=so(h[m],s)));h instanceof Error&&(v.message=h.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(v.$name=p),v}throw new Error("can't serialize object of type "+typeof h)}function ul(h){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||eu(h)||Zl(h)||ArrayBuffer.isView(h)||h instanceof ImageData)return h;if(Array.isArray(h))return h.map(ul);if(typeof h=="object"){const s=h.$name||"Object";if(s==="Map"){const v=new Map;for(const m of Object.keys(h))m!=="$name"&&v.set(m,ul(h[m]));return v}if(s==="Set"){const v=new Set;for(const m of Object.keys(h))m!=="$name"&&v.add(ul(h[m]));return v}const{klass:c}=bo[s];if(!c)throw new Error(`Can't deserialize unregistered class "${s}".`);if(c.deserialize)return c.deserialize(h);const p=Object.create(c.prototype);for(const v of Object.keys(h))v!=="$name"&&(p[v]=ul(h[v]));return p}throw new Error("can't deserialize object of type "+typeof h)}const kr={"Latin-1 Supplement":h=>h>=128&&h<=255,Arabic:h=>h>=1536&&h<=1791,"Arabic Supplement":h=>h>=1872&&h<=1919,"Arabic Extended-A":h=>h>=2208&&h<=2303,"Hangul Jamo":h=>h>=4352&&h<=4607,"Unified Canadian Aboriginal Syllabics":h=>h>=5120&&h<=5759,Khmer:h=>h>=6016&&h<=6143,"Unified Canadian Aboriginal Syllabics Extended":h=>h>=6320&&h<=6399,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"CJK Radicals Supplement":h=>h>=11904&&h<=12031,"Kangxi Radicals":h=>h>=12032&&h<=12255,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Bopomofo:h=>h>=12544&&h<=12591,"Hangul Compatibility Jamo":h=>h>=12592&&h<=12687,Kanbun:h=>h>=12688&&h<=12703,"Bopomofo Extended":h=>h>=12704&&h<=12735,"CJK Strokes":h=>h>=12736&&h<=12783,"Katakana Phonetic Extensions":h=>h>=12784&&h<=12799,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"CJK Unified Ideographs Extension A":h=>h>=13312&&h<=19903,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Yi Syllables":h=>h>=40960&&h<=42127,"Yi Radicals":h=>h>=42128&&h<=42191,"Hangul Jamo Extended-A":h=>h>=43360&&h<=43391,"Hangul Syllables":h=>h>=44032&&h<=55215,"Hangul Jamo Extended-B":h=>h>=55216&&h<=55295,"Private Use Area":h=>h>=57344&&h<=63743,"CJK Compatibility Ideographs":h=>h>=63744&&h<=64255,"Arabic Presentation Forms-A":h=>h>=64336&&h<=65023,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Arabic Presentation Forms-B":h=>h>=65136&&h<=65279,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519,Osage:h=>h>=66736&&h<=66815,"CJK Unified Ideographs Extension B":h=>h>=131072&&h<=173791};function kp(h){for(const s of h)if(oo(s.charCodeAt(0)))return!0;return!1}function Ey(h){for(const s of h)if(!dl(s.charCodeAt(0)))return!1;return!0}function dl(h){return!(kr.Arabic(h)||kr["Arabic Supplement"](h)||kr["Arabic Extended-A"](h)||kr["Arabic Presentation Forms-A"](h)||kr["Arabic Presentation Forms-B"](h))}function oo(h){return!(h!==746&&h!==747&&(h<4352||!(kr["Bopomofo Extended"](h)||kr.Bopomofo(h)||kr["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||kr["CJK Compatibility Ideographs"](h)||kr["CJK Compatibility"](h)||kr["CJK Radicals Supplement"](h)||kr["CJK Strokes"](h)||!(!kr["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||kr["CJK Unified Ideographs Extension A"](h)||kr["CJK Unified Ideographs"](h)||kr["Enclosed CJK Letters and Months"](h)||kr["Hangul Compatibility Jamo"](h)||kr["Hangul Jamo Extended-A"](h)||kr["Hangul Jamo Extended-B"](h)||kr["Hangul Jamo"](h)||kr["Hangul Syllables"](h)||kr.Hiragana(h)||kr["Ideographic Description Characters"](h)||kr.Kanbun(h)||kr["Kangxi Radicals"](h)||kr["Katakana Phonetic Extensions"](h)||kr.Katakana(h)&&h!==12540||!(!kr["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!kr["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||kr["Unified Canadian Aboriginal Syllabics"](h)||kr["Unified Canadian Aboriginal Syllabics Extended"](h)||kr["Vertical Forms"](h)||kr["Yijing Hexagram Symbols"](h)||kr["Yi Syllables"](h)||kr["Yi Radicals"](h))))}function ga(h){return!(oo(h)||function(s){return!!(kr["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||kr["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||kr["Letterlike Symbols"](s)||kr["Number Forms"](s)||kr["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||kr["Control Pictures"](s)&&s!==9251||kr["Optical Character Recognition"](s)||kr["Enclosed Alphanumerics"](s)||kr["Geometric Shapes"](s)||kr["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||kr["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||kr["CJK Symbols and Punctuation"](s)||kr.Katakana(s)||kr["Private Use Area"](s)||kr["CJK Compatibility Forms"](s)||kr["Small Form Variants"](s)||kr["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(h))}function hl(h){return h>=1424&&h<=2303||kr["Arabic Presentation Forms-A"](h)||kr["Arabic Presentation Forms-B"](h)}function ky(h,s){return!(!s&&hl(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||kr.Khmer(h))}function Gm(h){for(const s of h)if(hl(s.charCodeAt(0)))return!0;return!1}const Yd="deferred",lf="loading",Wm="loaded";let fl=null,wo="unavailable",pl=null;const Mp=function(h){h&&typeof h=="string"&&h.indexOf("NetworkError")>-1&&(wo="error"),fl&&fl(h)};function My(){bc.fire(new vi("pluginStateChange",{pluginStatus:wo,pluginURL:pl}))}const bc=new Uc,Xd=function(){return wo},cf=function(){if(wo!==Yd||!pl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");wo=lf,My(),pl&&ts({url:pl},h=>{h?Mp(h):(wo=Wm,My())})},Go={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>wo===Wm||Go.applyArabicShaping!=null,isLoading:()=>wo===lf,setState(h){wo=h.pluginStatus,pl=h.pluginURL},isParsed:()=>Go.applyArabicShaping!=null&&Go.processBidirectionalText!=null&&Go.processStyledBidirectionalText!=null,getPluginURL:()=>pl};class xi{constructor(s,c){this.zoom=s,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch,this.brightness=c.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(s){return function(c,p){for(const v of c)if(!ky(v.charCodeAt(0),p))return!1;return!0}(s,Go.isLoaded())}}class jp{constructor(s,c,p,v){this.property=s,this.value=c,this.expression=function(m,x,k,N){if(Is(m))return new Ep(m,x);if(Wd(m)||Array.isArray(m)&&m.length>0){const z=Cy(m,x,k,N);if(z.result==="error")throw new Error(z.value.map(C=>`${C.key}: ${C.message}`).join(", "));return z.value}{let z=m;return typeof m=="string"&&x.type==="color"&&(z=Jn.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>z}}}(c===void 0?s.specification.default:c,s.specification,p,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,c,p){return this.property.possiblyEvaluate(this,s,c,p)}}class Ku{constructor(s,c,p){this.property=s,this.value=new jp(s,void 0,c,p)}transitioned(s,c){return new Zu(this.property,this.value,c,Vi({},s.transition,this.transition),s.now)}untransitioned(){return new Zu(this.property,this.value,null,{},0)}}class Jd{constructor(s,c,p){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues),this._scope=c,this._options=p,this.configDependencies=new Set}getValue(s){return Os(this._values[s].value.value)}setValue(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new Ku(this._values[s].property,this._scope,this._options)),this._values[s].value=new jp(this._values[s].property,c===null?void 0:Os(c),this._scope,this._options),this._values[s].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].value.expression.configDependencies]))}setTransitionOrValue(s,c){c&&(this._options=c);const p=this._properties.properties;if(s)for(const v in s){const m=s[v];if(Qa(v,"-transition")){const x=v.slice(0,-11);p[x]&&this.setTransition(x,m)}else p.hasOwnProperty(v)&&this.setValue(v,m)}}getTransition(s){return Os(this._values[s].transition)}setTransition(s,c){this._values.hasOwnProperty(s)||(this._values[s]=new Ku(this._values[s].property)),this._values[s].transition=Os(c)||void 0}serialize(){const s={};for(const c of Object.keys(this._values)){const p=this.getValue(c);p!==void 0&&(s[c]=p);const v=this.getTransition(c);v!==void 0&&(s[`${c}-transition`]=v)}return s}transitioned(s,c){const p=new Qd(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(s,c._values[v]);return p}untransitioned(){const s=new Qd(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].untransitioned();return s}}class Zu{constructor(s,c,p,v,m){const x=v.delay||0,k=v.duration||0;m=m||0,this.property=s,this.value=c,this.begin=m+x,this.end=this.begin+k,s.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(s,c,p){const v=s.now||0,m=this.value.possiblyEvaluate(s,c,p),x=this.prior;if(x){if(v>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(v<this.begin)return x.possiblyEvaluate(s,c,p);{const k=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(s,c,p),m,xr(k))}}return m}}class Qd{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,c,p){const v=new Ju(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(s,c,p);return v}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class Yu{constructor(s,c,p){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._scope=c,this._options=p,this.configDependencies=new Set}getValue(s){return Os(this._values[s].value)}setValue(s,c){this._values[s]=new jp(this._values[s].property,c===null?void 0:Os(c),this._scope,this._options),this._values[s].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].expression.configDependencies]))}serialize(){const s={};for(const c of Object.keys(this._values)){const p=this.getValue(c);p!==void 0&&(s[c]=p)}return s}possiblyEvaluate(s,c,p){const v=new Ju(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(s,c,p);return v}}class Xu{constructor(s,c,p){this.property=s,this.value=c,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,c,p,v){return this.property.evaluate(this.value,this.parameters,s,c,p,v)}}class Ju{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class Xt{constructor(s){this.specification=s}possiblyEvaluate(s,c){return s.expression.evaluate(c)}interpolate(s,c,p){const v=Nu[this.specification.type];return v?v(s,c,p):s}}class ur{constructor(s,c){this.specification=s,this.overrides=c}possiblyEvaluate(s,c,p,v){return new Xu(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(c,null,{},p,v)}:s.expression,c)}interpolate(s,c,p){if(s.value.kind!=="constant"||c.value.kind!=="constant")return s;if(s.value.value===void 0||c.value.value===void 0)return new Xu(this,{kind:"constant",value:void 0},s.parameters);const v=Nu[this.specification.type];return v?new Xu(this,{kind:"constant",value:v(s.value.value,c.value.value,p)},s.parameters):s}evaluate(s,c,p,v,m,x){return s.kind==="constant"?s.value:s.evaluate(c,p,v,m,x)}}class jl{constructor(s){this.specification=s}possiblyEvaluate(s,c,p,v){return!!s.expression.evaluate(c,null,{},p,v)}interpolate(){return!1}}class $i{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new xi(0,{});for(const p in s){const v=s[p];v.specification.overridable&&this.overridableProperties.push(p);const m=this.defaultPropertyValues[p]=new jp(v,void 0),x=this.defaultTransitionablePropertyValues[p]=new Ku(v);this.defaultTransitioningPropertyValues[p]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=m.possiblyEvaluate(c)}}}mr(ur,"DataDrivenProperty"),mr(Xt,"DataConstantProperty"),mr(jl,"ColorRampProperty");var xt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function wc(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Yl(h){if(Array.isArray(h))return h.map(Yl);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const s={};for(const c in h)s[c]=Yl(h[c]);return s}return wc(h)}function Op(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const s of h.slice(1))if(!Op(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function jy(h,s="",c=null,p="fill"){if(h==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Op(h)||(h=Qu(h));const v=h;let m=!0;try{m=function(C){if(!ru(C))return C;let R=Yl(C);return tu(R),R=Sc(R),R}(v)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(v,null,2)}
        `)}let x=null,k=null;if(p!=="background"&&p!=="sky"&&p!=="slot"){k=xt[`filter_${p}`];const C=qo(m,k,s,c);if(C.result==="error")throw new Error(C.value.map(R=>`${R.key}: ${R.message}`).join(", "));x=(R,L,j)=>C.value.evaluate(R,L,{},j)}let N=null,z=null;if(m!==v){const C=qo(v,k,s,c);if(C.result==="error")throw new Error(C.value.map(R=>`${R.key}: ${R.message}`).join(", "));N=(R,L,j,I,$)=>C.value.evaluate(R,L,{},j,void 0,void 0,I,$),z=!Yc(C.value.expression)}return{filter:x,dynamicFilter:N||void 0,needGeometry:Oy(m),needFeature:!!z}}function Sc(h){if(!Array.isArray(h))return h;const s=function(c){if(m0.has(c[0])){for(let p=1;p<c.length;p++)if(ru(c[p]))return!0}return c}(h);return s===!0?s:s.map(c=>Sc(c))}function tu(h){let s=!1;const c=[];if(h[0]==="case"){for(let p=1;p<h.length-1;p+=2)s=s||ru(h[p]),c.push(h[p+1]);c.push(h[h.length-1])}else if(h[0]==="match"){s=s||ru(h[1]);for(let p=2;p<h.length-1;p+=2)c.push(h[p+1]);c.push(h[h.length-1])}else if(h[0]==="step"){s=s||ru(h[1]);for(let p=1;p<h.length-1;p+=2)c.push(h[p+1])}s&&(h.length=0,h.push("any",...c));for(let p=1;p<h.length;p++)tu(h[p])}function ru(h){if(!Array.isArray(h))return!1;if((s=h[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let c=1;c<h.length;c++)if(ru(h[c]))return!0;return!1}const m0=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Hm(h,s){return h<s?-1:h>s?1:0}function Oy(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let s=1;s<h.length;s++)if(Oy(h[s]))return!0;return!1}function Qu(h){if(!h)return!0;const s=h[0];return h.length<=1?s!=="any":s==="=="?Ws(h[1],h[2],"=="):s==="!="?ml(Ws(h[1],h[2],"==")):s==="<"||s===">"||s==="<="||s===">="?Ws(h[1],h[2],s):s==="any"?(c=h.slice(1),["any"].concat(c.map(Qu))):s==="all"?["all"].concat(h.slice(1).map(Qu)):s==="none"?["all"].concat(h.slice(1).map(Qu).map(ml)):s==="in"?eh(h[1],h.slice(2)):s==="!in"?ml(eh(h[1],h.slice(2))):s==="has"?th(h[1]):s!=="!has"||ml(th(h[1]));var c}function Ws(h,s,c){switch(h){case"$type":return[`filter-type-${c}`,s];case"$id":return[`filter-id-${c}`,s];default:return[`filter-${c}`,h,s]}}function eh(h,s){if(s.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(c=>typeof c!=typeof s[0])?["filter-in-large",h,["literal",s.sort(Hm)]]:["filter-in-small",h,["literal",s]]}}function th(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function ml(h){return["!",h]}const uf="";function So(h,s){return s?`${h}${uf}${s}`:h}const Ac="-transition",Km=new Set(["fill","line","background","hillshade","raster"]);class fi extends Uc{constructor(s,c,p,v,m){if(super(),this.id=s.id,this.fqid=So(this.id,p),this.type=s.type,this.scope=p,this.lut=v,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,s.type!=="custom"){if(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type&&s.type!=="background"&&s.type!=="sky"&&s.type!=="slot"){this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter;const x=qo(this.filter,xt[`filter_${s.type}`]);x.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...x.value.configDependencies]))}if(s.slot&&(this.slot=s.slot),c.layout&&(this._unevaluatedLayout=new Yu(c.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),c.paint){this._transitionablePaint=new Jd(c.paint,this.scope,m);for(const x in s.paint)this.setPaintProperty(x,s.paint[x]);for(const x in s.layout)this.setLayoutProperty(x,s.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ju(c.paint)}}}onAdd(s){}onRemove(s){}isDraped(s){return!this.is3D()&&Km.has(this.type)}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,c){if(this.type==="custom"&&s==="visibility")return void(this.visibility=c);const p=this._unevaluatedLayout;p._properties.properties[s]&&(p.setValue(s,c),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),s==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(s){return Qa(s,Ac)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,c){const p=this._transitionablePaint,v=p._properties.properties;if(Qa(s,Ac)){const R=s.slice(0,-11);return v[R]&&p.setTransition(R,c||void 0),!1}if(!v[s])return!1;const m=p._values[s],x=m.value.isDataDriven(),k=m.value;p.setValue(s,c),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),this._handleSpecialPaintPropertyUpdate(s);const N=p._values[s].value,z=N.isDataDriven(),C=Qa(s,"pattern")||s==="line-dasharray";return z||x||C||this._handleOverridablePaintPropertyUpdate(s,k,N)}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getDefaultProgramParams(s,c,p){return null}_handleOverridablePaintPropertyUpdate(s,c,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,c)}serialize(){return _l({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const s in this.paint._values){const c=this.paint.get(s);if(c instanceof Xu&&El(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(s){this._filterCompiled||(this._featureFilter=jy(this.filter,this.scope,s),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(s){this._stats&&(s.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(s){}queryIntersectsFeature(s,c,p,v,m,x,k,N,z){}}const Zm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rh{constructor(s,c){this._structArray=s,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ji{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,c){return s._trim(),c&&(s.isTransferred=!0,c.add(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const c=Object.create(this.prototype);return c.arrayBuffer=s.arrayBuffer,c.length=s.length,c.capacity=s.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...s){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...s){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Qn(h,s=1){let c=0,p=0;return{members:h.map(v=>{const m=Zm[v.type].BYTES_PER_ELEMENT,x=c=Ym(c,Math.max(s,m)),k=v.components||1;return p=Math.max(p,m),c+=m*k,{name:v.name,type:v.type,components:k,offset:x}}),size:Ym(c,Math.max(p,s)),alignment:s}}function Ym(h,s){return Math.ceil(h/s)*s}class Ao extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c){const p=this.length;return this.resize(p+1),this.emplace(p,s,c)}emplace(s,c,p){const v=2*s;return this.int16[v+0]=c,this.int16[v+1]=p,s}}Ao.prototype.bytesPerElement=4,mr(Ao,"StructArrayLayout2i4");class ra extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,p)}emplace(s,c,p,v){const m=3*s;return this.int16[m+0]=c,this.int16[m+1]=p,this.int16[m+2]=v,s}}ra.prototype.bytesPerElement=6,mr(ra,"StructArrayLayout3i6");class ua extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,p,v)}emplace(s,c,p,v,m){const x=4*s;return this.int16[x+0]=c,this.int16[x+1]=p,this.int16[x+2]=v,this.int16[x+3]=m,s}}ua.prototype.bytesPerElement=8,mr(ua,"StructArrayLayout4i8");class rs extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,p,v,m)}emplace(s,c,p,v,m,x){const k=5*s;return this.int16[k+0]=c,this.int16[k+1]=p,this.int16[k+2]=v,this.int16[k+3]=m,this.int16[k+4]=x,s}}rs.prototype.bytesPerElement=10,mr(rs,"StructArrayLayout5i10");class ed extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,p,v,m,x,k)}emplace(s,c,p,v,m,x,k,N){const z=6*s,C=12*s,R=3*s;return this.int16[z+0]=c,this.int16[z+1]=p,this.uint8[C+4]=v,this.uint8[C+5]=m,this.uint8[C+6]=x,this.uint8[C+7]=k,this.float32[R+2]=N,s}}ed.prototype.bytesPerElement=12,mr(ed,"StructArrayLayout2i4ub1f12");class Wo extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,p)}emplace(s,c,p,v){const m=3*s;return this.float32[m+0]=c,this.float32[m+1]=p,this.float32[m+2]=v,s}}Wo.prototype.bytesPerElement=12,mr(Wo,"StructArrayLayout3f12");class ns extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,p,v,m)}emplace(s,c,p,v,m,x){const k=6*s,N=3*s;return this.uint16[k+0]=c,this.uint16[k+1]=p,this.uint16[k+2]=v,this.uint16[k+3]=m,this.float32[N+2]=x,s}}ns.prototype.bytesPerElement=12,mr(ns,"StructArrayLayout4ui1f12");class Xm extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,p,v)}emplace(s,c,p,v,m){const x=4*s;return this.uint16[x+0]=c,this.uint16[x+1]=p,this.uint16[x+2]=v,this.uint16[x+3]=m,s}}Xm.prototype.bytesPerElement=8,mr(Xm,"StructArrayLayout4ui8");class ps extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,s,c,p,v,m,x)}emplace(s,c,p,v,m,x,k){const N=6*s;return this.int16[N+0]=c,this.int16[N+1]=p,this.int16[N+2]=v,this.int16[N+3]=m,this.int16[N+4]=x,this.int16[N+5]=k,s}}ps.prototype.bytesPerElement=12,mr(ps,"StructArrayLayout6i12");class Np extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z,C,R,L){const j=this.length;return this.resize(j+1),this.emplace(j,s,c,p,v,m,x,k,N,z,C,R,L)}emplace(s,c,p,v,m,x,k,N,z,C,R,L,j){const I=12*s;return this.int16[I+0]=c,this.int16[I+1]=p,this.int16[I+2]=v,this.int16[I+3]=m,this.uint16[I+4]=x,this.uint16[I+5]=k,this.uint16[I+6]=N,this.uint16[I+7]=z,this.int16[I+8]=C,this.int16[I+9]=R,this.int16[I+10]=L,this.int16[I+11]=j,s}}Np.prototype.bytesPerElement=24,mr(Np,"StructArrayLayout4i4ui4i24");class Rp extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,s,c,p,v,m,x)}emplace(s,c,p,v,m,x,k){const N=10*s,z=5*s;return this.int16[N+0]=c,this.int16[N+1]=p,this.int16[N+2]=v,this.float32[z+2]=m,this.float32[z+3]=x,this.float32[z+4]=k,s}}Rp.prototype.bytesPerElement=20,mr(Rp,"StructArrayLayout3i3f20");class nu extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,p,v)}emplace(s,c,p,v,m){const x=4*s;return this.float32[x+0]=c,this.float32[x+1]=p,this.float32[x+2]=v,this.float32[x+3]=m,s}}nu.prototype.bytesPerElement=16,mr(nu,"StructArrayLayout4f16");class Ol extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint32[1*s+0]=c,s}}Ol.prototype.bytesPerElement=4,mr(Ol,"StructArrayLayout1ul4");class Cs extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c){const p=this.length;return this.resize(p+1),this.emplace(p,s,c)}emplace(s,c,p){const v=2*s;return this.uint16[v+0]=c,this.uint16[v+1]=p,s}}Cs.prototype.bytesPerElement=4,mr(Cs,"StructArrayLayout2ui4");class nh extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z,C,R,L,j){const I=this.length;return this.resize(I+1),this.emplace(I,s,c,p,v,m,x,k,N,z,C,R,L,j)}emplace(s,c,p,v,m,x,k,N,z,C,R,L,j,I){const $=20*s,X=10*s;return this.int16[$+0]=c,this.int16[$+1]=p,this.int16[$+2]=v,this.int16[$+3]=m,this.int16[$+4]=x,this.float32[X+3]=k,this.float32[X+4]=N,this.float32[X+5]=z,this.float32[X+6]=C,this.int16[$+14]=R,this.uint32[X+8]=L,this.uint16[$+18]=j,this.uint16[$+19]=I,s}}nh.prototype.bytesPerElement=40,mr(nh,"StructArrayLayout5i4f1i1ul2ui40");class df extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,p,v,m,x,k)}emplace(s,c,p,v,m,x,k,N){const z=8*s;return this.int16[z+0]=c,this.int16[z+1]=p,this.int16[z+2]=v,this.int16[z+4]=m,this.int16[z+5]=x,this.int16[z+6]=k,this.int16[z+7]=N,s}}df.prototype.bytesPerElement=16,mr(df,"StructArrayLayout3i2i2i16");class Ip extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,p,v,m)}emplace(s,c,p,v,m,x){const k=4*s,N=8*s;return this.float32[k+0]=c,this.float32[k+1]=p,this.float32[k+2]=v,this.int16[N+6]=m,this.int16[N+7]=x,s}}Ip.prototype.bytesPerElement=16,mr(Ip,"StructArrayLayout2f1f2i16");class Jm extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x){const k=this.length;return this.resize(k+1),this.emplace(k,s,c,p,v,m,x)}emplace(s,c,p,v,m,x,k){const N=20*s,z=5*s;return this.uint8[N+0]=c,this.uint8[N+1]=p,this.float32[z+1]=v,this.float32[z+2]=m,this.float32[z+3]=x,this.float32[z+4]=k,s}}Jm.prototype.bytesPerElement=20,mr(Jm,"StructArrayLayout2ub4f20");class ms extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,c,p)}emplace(s,c,p,v){const m=3*s;return this.uint16[m+0]=c,this.uint16[m+1]=p,this.uint16[m+2]=v,s}}ms.prototype.bytesPerElement=6,mr(ms,"StructArrayLayout3ui6");class Qm extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q,le,ue,ie,he){const me=this.length;return this.resize(me+1),this.emplace(me,s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q,le,ue,ie,he)}emplace(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q,le,ue,ie,he,me){const we=30*s,Ie=15*s,Ne=60*s;return this.int16[we+0]=c,this.int16[we+1]=p,this.int16[we+2]=v,this.float32[Ie+2]=m,this.float32[Ie+3]=x,this.uint16[we+8]=k,this.uint16[we+9]=N,this.uint32[Ie+5]=z,this.uint32[Ie+6]=C,this.uint32[Ie+7]=R,this.uint16[we+16]=L,this.uint16[we+17]=j,this.uint16[we+18]=I,this.float32[Ie+10]=$,this.float32[Ie+11]=X,this.uint8[Ne+48]=Q,this.uint8[Ne+49]=le,this.uint8[Ne+50]=ue,this.uint32[Ie+13]=ie,this.int16[we+28]=he,this.uint8[Ne+58]=me,s}}Qm.prototype.bytesPerElement=60,mr(Qm,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class eg extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne,Me,Je,Fe,tt,st,nt,lt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne,Me,Je,Fe,tt,st,nt,lt)}emplace(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q,le,ue,ie,he,me,we,Ie,Ne,Me,Je,Fe,tt,st,nt,lt,ft){const vt=20*s,ct=40*s,Rt=80*s;return this.float32[vt+0]=c,this.float32[vt+1]=p,this.int16[ct+4]=v,this.int16[ct+5]=m,this.int16[ct+6]=x,this.int16[ct+7]=k,this.int16[ct+8]=N,this.int16[ct+9]=z,this.int16[ct+10]=C,this.int16[ct+11]=R,this.int16[ct+12]=L,this.uint16[ct+13]=j,this.uint16[ct+14]=I,this.uint16[ct+15]=$,this.uint16[ct+16]=X,this.uint16[ct+17]=Q,this.uint16[ct+18]=le,this.uint16[ct+19]=ue,this.uint16[ct+20]=ie,this.uint16[ct+21]=he,this.uint16[ct+22]=me,this.uint16[ct+23]=we,this.uint16[ct+24]=Ie,this.uint16[ct+25]=Ne,this.uint16[ct+26]=Me,this.uint16[ct+27]=Je,this.uint32[vt+14]=Fe,this.float32[vt+15]=tt,this.float32[vt+16]=st,this.float32[vt+17]=nt,this.float32[vt+18]=lt,this.uint8[Rt+76]=ft,s}}eg.prototype.bytesPerElement=80,mr(eg,"StructArrayLayout2f9i15ui1ul4f1ub80");class hf extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.float32[1*s+0]=c,s}}hf.prototype.bytesPerElement=4,mr(hf,"StructArrayLayout1f4");class iu extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,s,c,p,v,m)}emplace(s,c,p,v,m,x){const k=5*s;return this.float32[k+0]=c,this.float32[k+1]=p,this.float32[k+2]=v,this.float32[k+3]=m,this.float32[k+4]=x,s}}iu.prototype.bytesPerElement=20,mr(iu,"StructArrayLayout5f20");class Dp extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,p,v,m,x,k)}emplace(s,c,p,v,m,x,k,N){const z=7*s;return this.float32[z+0]=c,this.float32[z+1]=p,this.float32[z+2]=v,this.float32[z+3]=m,this.float32[z+4]=x,this.float32[z+5]=k,this.float32[z+6]=N,s}}Dp.prototype.bytesPerElement=28,mr(Dp,"StructArrayLayout7f28");class Xl extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z,C,R){const L=this.length;return this.resize(L+1),this.emplace(L,s,c,p,v,m,x,k,N,z,C,R)}emplace(s,c,p,v,m,x,k,N,z,C,R,L){const j=11*s;return this.float32[j+0]=c,this.float32[j+1]=p,this.float32[j+2]=v,this.float32[j+3]=m,this.float32[j+4]=x,this.float32[j+5]=k,this.float32[j+6]=N,this.float32[j+7]=z,this.float32[j+8]=C,this.float32[j+9]=R,this.float32[j+10]=L,s}}Xl.prototype.bytesPerElement=44,mr(Xl,"StructArrayLayout11f44");class td extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z){const C=this.length;return this.resize(C+1),this.emplace(C,s,c,p,v,m,x,k,N,z)}emplace(s,c,p,v,m,x,k,N,z,C){const R=9*s;return this.float32[R+0]=c,this.float32[R+1]=p,this.float32[R+2]=v,this.float32[R+3]=m,this.float32[R+4]=x,this.float32[R+5]=k,this.float32[R+6]=N,this.float32[R+7]=z,this.float32[R+8]=C,s}}td.prototype.bytesPerElement=36,mr(td,"StructArrayLayout9f36");class ih extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c){const p=this.length;return this.resize(p+1),this.emplace(p,s,c)}emplace(s,c,p){const v=2*s;return this.float32[v+0]=c,this.float32[v+1]=p,s}}ih.prototype.bytesPerElement=8,mr(ih,"StructArrayLayout2f8");class ff extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,c,p,v)}emplace(s,c,p,v,m){const x=6*s;return this.uint32[3*s+0]=c,this.uint16[x+2]=p,this.uint16[x+3]=v,this.uint16[x+4]=m,s}}ff.prototype.bytesPerElement=12,mr(ff,"StructArrayLayout1ul3ui12");class pf extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint16[1*s+0]=c,s}}pf.prototype.bytesPerElement=2,mr(pf,"StructArrayLayout1ui2");class mf extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X){const Q=this.length;return this.resize(Q+1),this.emplace(Q,s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X)}emplace(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q){const le=16*s;return this.float32[le+0]=c,this.float32[le+1]=p,this.float32[le+2]=v,this.float32[le+3]=m,this.float32[le+4]=x,this.float32[le+5]=k,this.float32[le+6]=N,this.float32[le+7]=z,this.float32[le+8]=C,this.float32[le+9]=R,this.float32[le+10]=L,this.float32[le+11]=j,this.float32[le+12]=I,this.float32[le+13]=$,this.float32[le+14]=X,this.float32[le+15]=Q,s}}mf.prototype.bytesPerElement=64,mr(mf,"StructArrayLayout16f64");class ah extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,c,p,v,m,x,k){const N=this.length;return this.resize(N+1),this.emplace(N,s,c,p,v,m,x,k)}emplace(s,c,p,v,m,x,k,N){const z=10*s,C=5*s;return this.uint16[z+0]=c,this.uint16[z+1]=p,this.uint16[z+2]=v,this.uint16[z+3]=m,this.float32[C+2]=x,this.float32[C+3]=k,this.float32[C+4]=N,s}}ah.prototype.bytesPerElement=20,mr(ah,"StructArrayLayout4ui3f20");class tg extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.int16[1*s+0]=c,s}}tg.prototype.bytesPerElement=2,mr(tg,"StructArrayLayout1i2");class Lp extends ji{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(s){const c=this.length;return this.resize(c+1),this.emplace(c,s)}emplace(s,c){return this.uint8[1*s+0]=c,s}}Lp.prototype.bytesPerElement=1,mr(Lp,"StructArrayLayout1ub1");class Ny extends rh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ny.prototype.size=40;class rg extends nh{get(s){return new Ny(this,s)}}mr(rg,"CollisionBoxArray");class sh extends rh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}sh.prototype.size=60;class Ry extends Qm{get(s){return new sh(this,s)}}mr(Ry,"PlacedSymbolArray");class Iy extends rh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(s){this._structArray.uint32[this._pos4+14]=s}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(s){this._structArray.float32[this._pos4+18]=s}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Iy.prototype.size=80;class Dy extends eg{get(s){return new Iy(this,s)}}mr(Dy,"SymbolInstanceArray");class g0 extends hf{getoffsetX(s){return this.float32[1*s+0]}}mr(g0,"GlyphOffsetArray");class Ly extends Ao{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}mr(Ly,"SymbolLineVertexArray");class zp extends rh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}zp.prototype.size=12;class Fp extends ff{get(s){return new zp(this,s)}}mr(Fp,"FeatureIndexArray");class To extends Cs{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}mr(To,"FillExtrusionCentroidArray");class gf extends rh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}gf.prototype.size=6;class zy extends ra{get(s){return new gf(this,s)}}mr(zy,"FillExtrusionWallArray");const ng=Qn([{name:"a_pos",components:2,type:"Int16"}],4),q_=Qn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ya{constructor(s=[]){this.segments=s}_prepareSegment(s,c,p,v){let m=this.segments[this.segments.length-1];return s>ya.MAX_VERTEX_ARRAY_LENGTH&&an(`Max vertices per segment is ${ya.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!m||m.vertexLength+s>ya.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==v)&&(m={vertexOffset:c,primitiveOffset:p,vertexLength:0,primitiveLength:0},v!==void 0&&(m.sortKey=v),this.segments.push(m)),m}prepareSegment(s,c,p,v){return this._prepareSegment(s,c.length,p.length,v)}get(){return this.segments}destroy(){for(const s of this.segments)for(const c in s.vaos)s.vaos[c].destroy()}static simpleSegment(s,c,p,v){return new ya([{vertexOffset:s,primitiveOffset:c,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function ig(h,s){return 256*(h=ar(Math.floor(h),0,255))+ar(Math.floor(s),0,255)}ya.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,mr(ya,"SegmentVector");const Jl=Qn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Bp=Qn([{name:"a_dash",components:4,type:"Uint16"}]);class rd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(s,c,p,v){this.ids.push(Fy(s)),this.positions.push(c,p,v)}eachPosition(s,c){const p=Fy(s);let v=0,m=this.ids.length-1;for(;v<m;){const x=v+m>>1;this.ids[x]>=p?m=x:v=x+1}for(;this.ids[v]===p;)c(this.positions[3*v],this.positions[3*v+1],this.positions[3*v+2]),v++}static serialize(s,c){const p=new Float64Array(s.ids),v=new Uint32Array(s.positions);return yf(p,v,0,p.length-1),c&&(c.add(p.buffer),c.add(v.buffer)),{ids:p,positions:v}}static deserialize(s){const c=new rd;let p;c.ids=s.ids,c.positions=s.positions;for(const v of c.ids)v!==p&&c.uniqueIds.push(v),p=v;return c.indexed=!0,c}}function Fy(h){const s=+h;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:ol(String(h))}function yf(h,s,c,p){for(;c<p;){const v=h[c+p>>1];let m=c-1,x=p+1;for(;;){do m++;while(h[m]<v);do x--;while(h[x]>v);if(m>=x)break;Vp(h,m,x),Vp(s,3*m,3*x),Vp(s,3*m+1,3*x+1),Vp(s,3*m+2,3*x+2)}x-c<p-x?(yf(h,s,c,x),c=x+1):(yf(h,s,x+1,p),p=x)}}function Vp(h,s,c){const p=h[s];h[s]=h[c],h[c]=p}mr(rd,"FeaturePositionMap");class Nl{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,c),this.initialized=!0),!!this.location}set(s,c,p){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Tc extends Nl{constructor(s){super(s),this.current=0}set(s,c,p){this.fetchUniformLocation(s,c)&&this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}}class da extends Nl{constructor(s){super(s),this.current=0}set(s,c,p){this.fetchUniformLocation(s,c)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class Ho extends Nl{constructor(s){super(s),this.current=[0,0]}set(s,c,p){this.fetchUniformLocation(s,c)&&(p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1])))}}class vf extends Nl{constructor(s){super(s),this.current=[0,0,0]}set(s,c,p){this.fetchUniformLocation(s,c)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2])))}}class xf extends Nl{constructor(s){super(s),this.current=[0,0,0,0]}set(s,c,p){this.fetchUniformLocation(s,c)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class By extends Nl{constructor(s){super(s),this.current=Jn.transparent.toRenderColor(null)}set(s,c,p){this.fetchUniformLocation(s,c)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const Vy=new Float32Array(16);class _f extends Nl{constructor(s){super(s),this.current=Vy}set(s,c,p){if(this.fetchUniformLocation(s,c)){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let v=1;v<16;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}}}const ag=new Float32Array(9),G_=new Float32Array(4);class lo extends Nl{constructor(s){super(s),this.current=G_}set(s,c,p){if(this.fetchUniformLocation(s,c)){for(let v=0;v<4;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix2fv(this.location,!1,p);break}}}}function Hs(h){return[ig(255*h.r,255*h.g),ig(255*h.b,255*h.a)]}class nd{constructor(s,c,p,v){this.value=s,this.uniformNames=c.map(m=>`u_${m}`),this.type=p,this.context=v}setUniform(s,c,p,v,m){const x=v.constantOr(this.value);c.set(s,m,x instanceof Jn?x.toRenderColor(this.ignoreLut?null:this.context.lut):x)}getBinding(s,c){return this.type==="color"?new By(s):new da(s)}}class id{constructor(s,c){this.uniformNames=c.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,c,p,v,m){const x=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;x&&c.set(s,m,x)}getBinding(s,c){return c==="u_pattern"||c==="u_dash"?new xf(s):new da(s)}}class Pc{constructor(s,c,p,v){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=c.map(m=>({name:`a_${m}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(s,c,p,v,m,x,k){const N=this.paintVertexArray.length,z=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new xi(0,{brightness:x}),c,{},m,v,k):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new xi(0,{brightness:x}),c,{},m,v,k)==="none"),this.paintVertexArray.resize(s),this._setPaintValue(N,s,z,this.context)}updatePaintArray(s,c,p,v,m,x,k){const N=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:k},p,v,void 0,m):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:k},p,v,void 0,m)==="none"),this._setPaintValue(s,c,N,this.context)}_setPaintValue(s,c,p,v){if(this.type==="color"){const m=Hs(p.toRenderColor(this.ignoreLut?null:v.lut));for(let x=s;x<c;x++)this.paintVertexArray.emplace(x,m[0],m[1])}else{for(let m=s;m<c;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Rl{constructor(s,c,p,v,m,x){this.expression=s,this.uniformNames=c.map(k=>`u_${k}_t`),this.type=p,this.useIntegerZoom=v,this.context=m,this.maxValue=0,this.paintVertexAttributes=c.map(k=>({name:`a_${k}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(s,c,p,v,m,x,k){const N=this.expression.evaluate(new xi(this.context.zoom,{brightness:x}),c,{},m,v,k),z=this.expression.evaluate(new xi(this.context.zoom+1,{brightness:x}),c,{},m,v,k);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new xi(this.context.zoom,{brightness:x}),c,{},m,v,k)==="none");const C=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(C,s,N,z,this.context)}updatePaintArray(s,c,p,v,m,x,k){const N=this.expression.evaluate({zoom:this.context.zoom,brightness:k},p,v,void 0,m),z=this.expression.evaluate({zoom:this.context.zoom+1,brightness:k},p,v,void 0,m);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:k},p,v,void 0,m)==="none"),this._setPaintValue(s,c,N,z,this.context)}_setPaintValue(s,c,p,v,m){if(this.type==="color"){const x=Hs(p.toRenderColor(this.ignoreLut?null:m.lut)),k=Hs(p.toRenderColor(this.ignoreLut?null:m.lut));for(let N=s;N<c;N++)this.paintVertexArray.emplace(N,x[0],x[1],k[0],k[1])}else{for(let x=s;x<c;x++)this.paintVertexArray.emplace(x,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,c,p,v,m){const x=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,k=ar(this.expression.interpolationFactor(x,this.context.zoom,this.context.zoom+1),0,1);c.set(s,m,k)}getBinding(s,c){return new da(s)}}class au{constructor(s,c,p,v,m){this.expression=s,this.layerId=m,this.paintVertexAttributes=(p==="array"?Bp:Jl).members;for(let x=0;x<c.length;++x);this.paintVertexArray=new v}populatePaintArray(s,c,p,v){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,c.patterns&&c.patterns[this.layerId],p)}updatePaintArray(s,c,p,v,m,x,k){this._setPaintValues(s,c,p.patterns&&p.patterns[this.layerId],x)}_setPaintValues(s,c,p,v){if(!v||!p)return;const m=v[p];if(!m)return;const{tl:x,br:k,pixelRatio:N}=m;for(let z=s;z<c;z++)this.paintVertexArray.emplace(z,x[0],x[1],k[0],k[1],N)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class su{constructor(s,c,p=()=>!0){this.binders={},this._buffers=[],this.context=c;const v=[];for(const m in s.paint._values){const x=s.paint.get(m),k=s.paint.get(`${m}-use-theme`);if(m.endsWith("-use-theme")||!p(m)||!(x instanceof Xu&&El(x.property.specification)))continue;const N=y0(m,s.type),z=x.value,C=x.property.specification.type,R=!!x.property.useIntegerZoom,L=m==="line-dasharray"||m.endsWith("pattern"),j=m==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant"||k&&k.value.kind!=="constant";if(z.kind!=="constant"||j)if(z.kind==="source"||j||L){const I=sg(m,C,"source");this.binders[m]=L?new au(z,N,C,I,s.id):new Pc(z,N,C,I),v.push(`/a_${m}`)}else{const I=sg(m,C,"composite");this.binders[m]=new Rl(z,N,C,R,c,I),v.push(`/z_${m}`)}else this.binders[m]=L?new id(z.value,N):new nd(z.value,N,C,c),v.push(`/u_${m}`);k&&(this.binders[m].ignoreLut=k.constantOr("default")==="none",this.binders[m].lutExpression=k.value,this.binders[m].checkUseTheme=!0)}this.cacheKey=v.sort().join("")}getMaxValue(s){const c=this.binders[s];return c instanceof Pc||c instanceof Rl?c.maxValue:0}populatePaintArrays(s,c,p,v,m,x,k){for(const N in this.binders){const z=this.binders[N];z.context=this.context,z instanceof Pc||z instanceof Rl||z instanceof au?z.populatePaintArray(s,c,p,v,m,x,k):z.lutExpression&&z instanceof nd&&z.lutExpression&&(z.lutExpression.kind==="composite"||z.lutExpression.kind==="source")&&(z.ignoreLut=z.lutExpression.evaluate(new xi(0,{brightness:x}),c,{},m,v,k)==="none")}}setConstantPatternPositions(s){for(const c in this.binders){const p=this.binders[c];p instanceof id&&p.setConstantPatternPositions(s)}}updatePaintArrays(s,c,p,v,m,x,k,N,z){let C=!1;const R=Object.keys(s),L=R.length!==0&&!N,j=L?R:c.uniqueIds;this.context.lut=m.lut;for(const I in this.binders){const $=this.binders[I];if($.context=this.context,($ instanceof Pc||$ instanceof Rl||$ instanceof au)&&$.expression&&$.expression.kind&&$.expression.kind!=="constant"&&($.expression.isStateDependent===!0||$.expression.isLightConstant===!1)){const X=m.paint.get(I);$.expression=X.value;for(const Q of j){const le=s[Q.toString()];c.eachPosition(Q,(ue,ie,he)=>{const me=v.feature(ue);$.updatePaintArray(ie,he,me,le,x,k,z)})}if(!L)for(const Q of p.uniqueIds){const le=s[Q.toString()];p.eachPosition(Q,(ue,ie,he)=>{const me=v.feature(ue);$.updatePaintArray(ie,he,me,le,x,k,z)})}C=!0}}return C}defines(){const s=[];for(const c in this.binders){const p=this.binders[c];(p instanceof nd||p instanceof id)&&s.push(...p.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return s}getBinderAttributes(){const s=[];for(const c in this.binders){const p=this.binders[c];if(p instanceof Pc||p instanceof Rl||p instanceof au)for(let v=0;v<p.paintVertexAttributes.length;v++)s.push(p.paintVertexAttributes[v].name)}return s}getBinderUniforms(){const s=[];for(const c in this.binders){const p=this.binders[c];if(p instanceof nd||p instanceof id||p instanceof Rl)for(const v of p.uniformNames)s.push(v)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const c=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof nd||v instanceof id||v instanceof Rl)for(const m of v.uniformNames)c.push({name:m,property:p,binding:v.getBinding(s,m)})}return c}setUniforms(s,c,p,v,m){for(const{name:x,property:k,binding:N}of p){if(this.binders[k].checkUseTheme&&this.binders[k]instanceof nd){const z=v.get(`${k}-use-theme`);z.isConstant()&&(this.binders[k].ignoreLut=z.constantOr("default")==="none")}this.binders[k].setUniform(s,N,m,v.get(k),x)}}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Pc||c instanceof Rl||c instanceof au)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(s){for(const c in this.binders){const p=this.binders[c];(p instanceof Pc||p instanceof Rl||p instanceof au)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const c=this.binders[s];(c instanceof Pc||c instanceof Rl||c instanceof au)&&c.destroy()}}}class ou{constructor(s,c,p=()=>!0){this.programConfigurations={};for(const v of s)this.programConfigurations[v.id]=new su(v,c,p);this.needsUpload=!1,this._featureMap=new rd,this._featureMapWithoutIds=new rd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(s,c,p,v,m,x,k,N){for(const z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(s,c,v,m,x,k,N);c.id!==void 0?this._featureMap.add(c.id,p,this._bufferOffset,s):(this._featureMapWithoutIds.add(this._idlessCounter,p,this._bufferOffset,s),this._idlessCounter+=1),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,c,p,v,m,x,k){for(const N of p)this.needsUpload=this.programConfigurations[N.id].updatePaintArrays(s,this._featureMap,this._featureMapWithoutIds,c,N,v,m,x,k||0)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Uy={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function y0(h,s){return Uy[h]||[h.replace(`${s}-`,"").replace(/-/g,"_")]}const v0={"line-pattern":{source:ns,composite:ns},"fill-pattern":{source:ns,composite:ns},"fill-extrusion-pattern":{source:ns,composite:ns},"line-dasharray":{source:Xm,composite:Xm}},bf={color:{source:ih,composite:nu},number:{source:hf,composite:ih}};function sg(h,s,c){const p=v0[h];return p&&p[c]||bf[s][c]}mr(nd,"ConstantBinder"),mr(id,"PatternConstantBinder"),mr(Pc,"SourceExpressionBinder"),mr(au,"PatternCompositeBinder"),mr(Rl,"CompositeExpressionBinder"),mr(su,"ProgramConfiguration",{omit:["_buffers"]}),mr(ou,"ProgramConfigurationSet");const Ks=lr/Math.PI/2,ad=5,Up=6,x0=16383,oh=64,wf=[oh,32,16],Ko=-Ks,co=Ks;function Zo(h,s,c,p=Ks){return c=et(c),[h*Math.sin(c)*p,-s*p,h*Math.cos(c)*p]}function lh(h,s,c){return Zo(Math.cos(et(h)),Math.sin(et(h)),s,c)}const sd=63710088e-1,$p=2*Math.PI*sd;class Kn{constructor(s,c){if(isNaN(s)||isNaN(c))throw new Error(`Invalid LngLat object: (${s}, ${c})`);if(this.lng=+s,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Kn(Xn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const c=Math.PI/180,p=this.lat*c,v=s.lat*c,m=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((s.lng-this.lng)*c);return sd*Math.acos(Math.min(m,1))}toBounds(s=0){const c=360*s/40075017,p=c/Math.cos(Math.PI/180*this.lat);return new lu({lng:this.lng-p,lat:this.lat-c},{lng:this.lng+p,lat:this.lat+c})}toEcef(s){return lh(this.lat,this.lng,Ks+s*Ks/sd)}static convert(s){if(s instanceof Kn)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Kn(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Kn(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class lu{constructor(s,c){if(s)if(c)this.setSouthWest(s).setNorthEast(c);else if(s.length===4){const p=s;this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]])}else{const p=s;this.setSouthWest(p[0]).setNorthEast(p[1])}}setNorthEast(s){return this._ne=s instanceof Kn?new Kn(s.lng,s.lat):Kn.convert(s),this}setSouthWest(s){return this._sw=s instanceof Kn?new Kn(s.lng,s.lat):Kn.convert(s),this}extend(s){const c=this._sw,p=this._ne;let v,m;if(s instanceof Kn)v=s,m=s;else{if(!(s instanceof lu))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(lu.convert(s)):this.extend(Kn.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Kn.convert(s)):this;if(v=s._sw,m=s._ne,!v||!m)return this}return c||p?(c.lng=Math.min(v.lng,c.lng),c.lat=Math.min(v.lat,c.lat),p.lng=Math.max(m.lng,p.lng),p.lat=Math.max(m.lat,p.lat)):(this._sw=new Kn(v.lng,v.lat),this._ne=new Kn(m.lng,m.lat)),this}getCenter(){return new Kn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Kn(this.getWest(),this.getNorth())}getSouthEast(){return new Kn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:c,lat:p}=Kn.convert(s);let v=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(s){if(s)return s instanceof lu?s:new lu(s)}}const qp=0,uo=25.5;function og(h){return $p*Math.cos(h*Math.PI/180)}function Cc(h){return(180+h)/360}function Yo(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function qi(h,s){return h/og(s)}function Xo(h){return 360*h-180}function Fr(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function ch(h,s){return h*og(Fr(s))}const Zs=85.051129;function lg(h){return Math.cos(et(ar(h,-85.051129,Zs)))}function Sf(h,s){const c=ar(s,qp,uo),p=Math.pow(2,c);return lg(h)*$p/(512*p)}function g(h){return 1/Math.cos(h*Math.PI/180)}function o(h,s=0){const c=Math.exp(Math.PI*(1-(h.y+s/lr)/(1<<h.z)*2));return 80150034*c/(c*c+1)/lr/(1<<h.z)}class d{constructor(s,c,p=0){this.x=+s,this.y=+c,this.z=+p}static fromLngLat(s,c=0){const p=Kn.convert(s);return new d(Cc(p.lng),Yo(p.lat),qi(c,p.lat))}toLngLat(){return new Kn(Xo(this.x),Fr(this.y))}toAltitude(){return ch(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/$p*g(Fr(this.y))}}function y(h,s,c,p,v,m,x,k,N){const z=(s+p)/2,C=(c+v)/2,R=new Pt(z,C);k(R),function(L,j,I,$,X,Q){const le=I-X,ue=$-Q;return Math.abs(($-j)*le-(I-L)*ue)/Math.hypot(le,ue)}(R.x,R.y,m.x,m.y,x.x,x.y)>=N?(y(h,s,c,z,C,m,R,k,N),y(h,z,C,p,v,R,x,k,N)):h.push(x)}function S(h,s,c){let p=h[0],v=p.x,m=p.y;s(p);const x=[p];for(let k=1;k<h.length;k++){const N=h[k],{x:z,y:C}=N;s(N),y(x,v,m,z,C,p,N,s,c),v=z,m=C,p=N}return x}function P(h,s,c,p){if(p(s,c)){const v=s.add(c)._mult(.5);P(h,s,v,p),P(h,v,c,p)}else h.push(c)}function M(h,s){let c=h[0];const p=[c];for(let v=1;v<h.length;v++){const m=h[v];P(p,c,m,s),c=m}return p}const D=Math.pow(2,14)-1,G=-D-1;function K(h,s){const c=Math.round(h.x*s),p=Math.round(h.y*s);return h.x=ar(c,G,D),h.y=ar(p,G,D),(c<h.x||c>h.x+1||p<h.y||p>h.y+1)&&an("Geometry exceeds allowed extent, reduce your vector tile buffer size"),h}function Y(h,s,c){const p=h.loadGeometry(),v=h.extent,m=lr/v;if(s&&c&&c.projection.isReprojectedInTileSpace){const x=1<<s.z,{scale:k,x:N,y:z,projection:C}=c,R=L=>{const j=Xo((s.x+L.x/v)/x),I=Fr((s.y+L.y/v)/x),$=C.project(j,I);L.x=($.x*k-N)*v,L.y=($.y*k-z)*v};for(let L=0;L<p.length;L++)if(h.type!==1)p[L]=S(p[L],R,1);else{const j=[];for(const I of p[L])I.x<0||I.x>=v||I.y<0||I.y>=v||(R(I),j.push(I));p[L]=j}}for(const x of p)for(const k of x)K(k,m);return p}function te(h,s){return{type:h.type,id:h.id,properties:h.properties,geometry:s?Y(h):[]}}function re(h,s,c,p,v){h.emplaceBack(2*s+(p+1)/2,2*c+(v+1)/2)}function oe(h,s,c){h.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class ve{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new Ao,this.indexArray=new ms,this.segments=new ya,this.programConfigurations=new ou(s.layers,{zoom:s.zoom,lut:s.lut}),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}updateFootprints(s,c){}populate(s,c,p,v){const m=this.layers[0],x=[];let k=null;m.type==="circle"&&(k=m.layout.get("circle-sort-key"));for(const{feature:z,id:C,index:R,sourceLayerIndex:L}of s){const j=this.layers[0]._featureFilter.needGeometry,I=te(z,j);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),I,p))continue;const $=k?k.evaluate(I,{},p):void 0,X={id:C,properties:z.properties,type:z.type,sourceLayerIndex:L,index:R,geometry:j?I.geometry:Y(z,p,v),patterns:{},sortKey:$};x.push(X)}k&&x.sort((z,C)=>z.sortKey-C.sortKey);let N=null;v.projection.name==="globe"&&(this.globeExtVertexArray=new ps,N=v.projection);for(const z of x){const{geometry:C,index:R,sourceLayerIndex:L}=z,j=s[R].feature;this.addFeature(z,C,R,c.availableImages,p,N,c.brightness),c.featureIndex.insert(j,C,R,L,this.index)}}update(s,c,p,v,m,x,k){this.programConfigurations.updatePaintArrays(s,c,m,p,v,x,k)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,ng.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,q_.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,c,p,v,m,x,k){for(const N of c)for(const z of N){const C=z.x,R=z.y;if(C<0||C>=lr||R<0||R>=lr)continue;if(x){const I=x.projectTilePoint(C,R,m),$=x.upVector(m,C,R),X=this.globeExtVertexArray;oe(X,I,$),oe(X,I,$),oe(X,I,$),oe(X,I,$)}const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),j=L.vertexLength;re(this.layoutVertexArray,C,R,-1,-1),re(this.layoutVertexArray,C,R,1,-1),re(this.layoutVertexArray,C,R,1,1),re(this.layoutVertexArray,C,R,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{},v,m,k)}}function fe(h,s){for(let c=0;c<h.length;c++)if($e(s,h[c]))return!0;for(let c=0;c<s.length;c++)if($e(h,s[c]))return!0;return!!Ue(h,s)}function be(h,s,c){return!!$e(h,s)||!!Xe(s,h,c)}function xe(h,s){if(h.length===1)return We(s,h[0]);for(let c=0;c<s.length;c++){const p=s[c];for(let v=0;v<p.length;v++)if($e(h,p[v]))return!0}for(let c=0;c<h.length;c++)if(We(s,h[c]))return!0;for(let c=0;c<s.length;c++)if(Ue(h,s[c]))return!0;return!1}function Ce(h,s,c){if(h.length>1){if(Ue(h,s))return!0;for(let p=0;p<s.length;p++)if(Xe(s[p],h,c))return!0}for(let p=0;p<h.length;p++)if(Xe(h[p],s,c))return!0;return!1}function Ue(h,s){if(h.length===0||s.length===0)return!1;for(let c=0;c<h.length-1;c++){const p=h[c],v=h[c+1];for(let m=0;m<s.length-1;m++)if(Be(p,v,s[m],s[m+1]))return!0}return!1}function Be(h,s,c,p){return es(h,c,p)!==es(s,c,p)&&es(h,s,c)!==es(h,s,p)}function Xe(h,s,c){const p=c*c;if(s.length===1)return h.distSqr(s[0])<p;for(let v=1;v<s.length;v++)if(qe(h,s[v-1],s[v])<p)return!0;return!1}function qe(h,s,c){const p=s.distSqr(c);if(p===0)return h.distSqr(s);const v=((h.x-s.x)*(c.x-s.x)+(h.y-s.y)*(c.y-s.y))/p;return h.distSqr(v<0?s:v>1?c:c.sub(s)._mult(v)._add(s))}function We(h,s){let c,p,v,m=!1;for(let x=0;x<h.length;x++){c=h[x];for(let k=0,N=c.length-1;k<c.length;N=k++)p=c[k],v=c[N],p.y>s.y!=v.y>s.y&&s.x<(v.x-p.x)*(s.y-p.y)/(v.y-p.y)+p.x&&(m=!m)}return m}function $e(h,s){let c=!1;for(let p=0,v=h.length-1;p<h.length;v=p++){const m=h[p],x=h[v];m.y>s.y!=x.y>s.y&&s.x<(x.x-m.x)*(s.y-m.y)/(x.y-m.y)+m.x&&(c=!c)}return c}function Ke(h,s,c,p,v){for(const x of h)if(s<=x.x&&c<=x.y&&p>=x.x&&v>=x.y)return!0;const m=[new Pt(s,c),new Pt(s,v),new Pt(p,v),new Pt(p,c)];if(h.length>2){for(const x of m)if($e(h,x))return!0}for(let x=0;x<h.length-1;x++)if(it(h[x],h[x+1],m))return!0;return!1}function it(h,s,c){const p=c[0],v=c[2];if(h.x<p.x&&s.x<p.x||h.x>v.x&&s.x>v.x||h.y<p.y&&s.y<p.y||h.y>v.y&&s.y>v.y)return!1;const m=es(h,s,c[0]);return m!==es(h,s,c[1])||m!==es(h,s,c[2])||m!==es(h,s,c[3])}function _t(h,s,c,p,v,m){let x=s.y-h.y,k=h.x-s.x;if(m=m||0){const N=x*x+k*k;if(N===0)return!0;const z=Math.sqrt(N);x/=z,k/=z}return!((c.x-h.x)*x+(c.y-h.y)*k-m<0||(p.x-h.x)*x+(p.y-h.y)*k-m<0||(v.x-h.x)*x+(v.y-h.y)*k-m<0)}function mt(h,s,c,p,v,m,x){return!(_t(h,s,p,v,m,x)||_t(s,c,p,v,m,x)||_t(c,h,p,v,m,x)||_t(p,v,h,s,c,x)||_t(v,m,h,s,c,x)||_t(m,p,h,s,c,x))}function Mt(h,s,c){const p=s.paint.get(h).value;return p.kind==="constant"?p.value:c.programConfigurations.get(s.id).getMaxValue(h)}function jt(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function dt(h,s,c,p,v){if(!s[0]&&!s[1])return h;const m=Pt.convert(s)._mult(v);c==="viewport"&&m._rotate(-p);const x=[];for(let k=0;k<h.length;k++)x.push(h[k].sub(m));return x}function Et(h,s,c,p){const v=Pt.convert(h)._mult(p);return s==="viewport"&&v._rotate(-c),v}let Ut,pt;mr(ve,"CircleBucket",{omit:["layers"]});var Dt,kt={exports:{}},Yt=(Dt||(Dt=1,function(h,s){(function(c){function p(m,x,k){var N=v(256*m,256*(x=Math.pow(2,k)-x-1),k),z=v(256*(m+1),256*(x+1),k);return N[0]+","+N[1]+","+z[0]+","+z[1]}function v(m,x,k){var N=2*Math.PI*6378137/256/Math.pow(2,k);return[m*N-2*Math.PI*6378137/2,x*N-2*Math.PI*6378137/2]}c.getURL=function(m,x,k,N,z,C){return C=C||{},m+"?"+["bbox="+p(k,N,z),"format="+(C.format||"image/png"),"service="+(C.service||"WMS"),"version="+(C.version||"1.1.1"),"request="+(C.request||"GetMap"),"srs="+(C.srs||"EPSG:3857"),"width="+(C.width||256),"height="+(C.height||256),"layers="+x].join("&")},c.getTileBBox=p,c.getMercCoords=v,Object.defineProperty(c,"__esModule",{value:!0})})(s)}(0,kt.exports)),kt.exports);class Bt{constructor(s,c,p){this.z=s,this.x=c,this.y=p,this.key=tr(0,s,s,c,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,c){const p=Yt.getTileBBox(this.x,this.y,this.z),v=function(m,x,k){let N,z="";for(let C=m;C>0;C--)N=1<<C-1,z+=(x&N?1:0)+(k&N?2:0);return z}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class It{constructor(s,c){this.wrap=s,this.canonical=c,this.key=tr(s,c.z,c.z,c.x,c.y)}}class Ht{constructor(s,c,p,v,m){this.overscaledZ=s,this.wrap=c,this.canonical=new Bt(p,+v,+m),this.key=c===0&&s===p?this.canonical.key:tr(c,s,p,v,m)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const c=this.canonical.z-s;return s>this.canonical.z?new Ht(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ht(s,this.wrap,s,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(s,c=!0){if(this.overscaledZ===s&&c)return this.key;if(s>this.canonical.z)return tr(this.wrap*+c,s,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-s;return tr(this.wrap*+c,s,s,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const c=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.z<this.canonical.z&&s.canonical.x===this.canonical.x>>c&&s.canonical.y===this.canonical.y>>c}children(s){if(this.overscaledZ>=s)return[new Ht(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new Ht(c,this.wrap,c,p,v),new Ht(c,this.wrap,c,p+1,v),new Ht(c,this.wrap,c,p,v+1),new Ht(c,this.wrap,c,p+1,v+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Ht(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Ht(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new It(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function tr(h,s,c,p,v){const m=1<<Math.min(c,22);let x=m*(v%m)+p%m;return h&&c<22&&(x+=m*m*((h<0?-2*h-1:2*h)%(1<<2*(22-c)))),16*(32*x+c)+(s-c)}const gr=[h=>{let s=h.canonical.x-1,c=h.wrap;return s<0&&(s=(1<<h.canonical.z)-1,c--),new Ht(h.overscaledZ,c,h.canonical.z,s,h.canonical.y)},h=>{let s=h.canonical.x+1,c=h.wrap;return s===1<<h.canonical.z&&(s=0,c++),new Ht(h.overscaledZ,c,h.canonical.z,s,h.canonical.y)},h=>new Ht(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,(h.canonical.y===0?1<<h.canonical.z:h.canonical.y)-1),h=>new Ht(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y===(1<<h.canonical.z)-1?0:h.canonical.y+1)];mr(Bt,"CanonicalTileID"),mr(Ht,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const _r=Qn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:qr}=_r,jr=Qn([{name:"a_pos_3",components:3,type:"Int16"}]);var Ir=Qn([{name:"a_pos",type:"Int16",components:2}]);class Hr{constructor(s,c){this.pos=s,this.dir=c}intersectsPlane(s,c,p){const v=De.vec3.dot(c,this.dir);if(Math.abs(v)<1e-6)return!1;const m=((s[0]-this.pos[0])*c[0]+(s[1]-this.pos[1])*c[1]+(s[2]-this.pos[2])*c[2])/v;return p[0]=this.pos[0]+this.dir[0]*m,p[1]=this.pos[1]+this.dir[1]*m,p[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(s,c,p){if(De.vec3.equals(this.pos,s)||c===0)return p[0]=p[1]=p[2]=0,!1;const[v,m,x]=this.dir,k=this.pos[0]-s[0],N=this.pos[1]-s[1],z=this.pos[2]-s[2],C=v*v+m*m+x*x,R=2*(k*v+N*m+z*x),L=R*R-4*C*(k*k+N*N+z*z-c*c);if(L<0){const j=Math.max(-R/2,0),I=k+v*j,$=N+m*j,X=z+x*j,Q=Math.hypot(I,$,X);return p[0]=I*c/Q,p[1]=$*c/Q,p[2]=X*c/Q,!1}{const j=(-R-Math.sqrt(L))/(2*C);if(j<0){const I=Math.hypot(k,N,z);return p[0]=k*c/I,p[1]=N*c/I,p[2]=z*c/I,!1}return p[0]=k+v*j,p[1]=N+m*j,p[2]=z+x*j,!0}}}class Mn{constructor(s,c,p,v,m){this.TL=s,this.TR=c,this.BR=p,this.BL=v,this.horizon=m}static fromInvProjectionMatrix(s,c,p){const v=[-1,1,1],m=[1,1,1],x=[1,-1,1],k=[-1,-1,1],N=De.vec3.transformMat4(v,v,s),z=De.vec3.transformMat4(m,m,s),C=De.vec3.transformMat4(x,x,s),R=De.vec3.transformMat4(k,k,s);return new Mn(N,z,C,R,c/p)}}function di(h,s,c){let p=1/0,v=-1/0;const m=[];for(const x of h){De.vec3.sub(m,x,s);const k=De.vec3.dot(m,c);p=Math.min(p,k),v=Math.max(v,k)}return[p,v]}function Gi(h,s){let c=!0;for(let p=0;p<h.planes.length;p++){const v=h.planes[p];let m=0;for(let x=0;x<s.length;x++)m+=De.vec3.dot(v,s[x])+v[3]>=0;if(m===0)return 0;m!==s.length&&(c=!1)}return c?2:1}function Zn(h,s){for(const c of h.projections){const p=di(s,h.points[0],c.axis);if(c.projection[1]<p[0]||c.projection[0]>p[1])return 0}return 1}function Zr(h,s){let c=0;const p=[0,0,0,0];for(let v=0;v<h.length;v++)p[0]=h[v][0],p[1]=h[v][1],p[2]=h[v][2],p[3]=1,De.vec4.dot(p,s)>=0&&c++;return c}class wn{constructor(s,c){this.points=s||new Array(8).fill([0,0,0]),this.planes=c||new Array(6).fill([0,0,0,0]),this.bounds=Sr.fromPoints(this.points),this.projections=[],this.frustumEdges=[De.vec3.sub([],this.points[2],this.points[3]),De.vec3.sub([],this.points[0],this.points[3]),De.vec3.sub([],this.points[4],this.points[0]),De.vec3.sub([],this.points[5],this.points[1]),De.vec3.sub([],this.points[6],this.points[2]),De.vec3.sub([],this.points[7],this.points[3])];for(const p of this.frustumEdges){const v=[0,-p[2],p[1]],m=[p[2],0,-p[0]];this.projections.push({axis:v,projection:di(this.points,this.points[0],v)}),this.projections.push({axis:m,projection:di(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(s,c,p,v){const m=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(z=>{const C=De.vec4.transformMat4([],z,s),R=1/C[3]/c*m;return De.vec4.mul(C,C,[R,R,v?1/C[3]:R,R])}),k=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(z=>{const C=De.vec3.sub([],x[z[0]],x[z[1]]),R=De.vec3.sub([],x[z[2]],x[z[1]]),L=De.vec3.normalize([],De.vec3.cross([],C,R)),j=-De.vec3.dot(L,x[z[1]]);return L.concat(j)}),N=[];for(let z=0;z<x.length;z++)N.push([x[z][0],x[z][1],x[z][2]]);return new wn(N,k)}intersectsPrecise(s,c,p){for(let v=0;v<c.length;v++)if(!Zr(s,c[v]))return 0;for(let v=0;v<this.planes.length;v++)if(!Zr(s,this.planes[v]))return 0;for(const v of p)for(const m of this.frustumEdges){const x=De.vec3.cross([],v,m),k=De.vec3.length(x);if(k===0)continue;De.vec3.scale(x,x,1/k);const N=di(this.points,this.points[0],x),z=di(s,this.points[0],x);if(N[0]>z[1]||z[0]>N[1])return 0}return 1}containsPoint(s){for(const c of this.planes){const p=c[3];if(De.vec3.dot([c[0],c[1],c[2]],s)+p<0)return!1}return!0}}class Sr{static fromPoints(s){const c=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const v of s)De.vec3.min(c,c,v),De.vec3.max(p,p,v);return new Sr(c,p)}static fromTileIdAndHeight(s,c,p){const v=1<<s.canonical.z,m=s.canonical.x,x=s.canonical.y;return new Sr([m/v,x/v,c],[(m+1)/v,(x+1)/v,p])}static applyTransform(s,c){const p=s.getCorners();for(let v=0;v<p.length;++v)De.vec3.transformMat4(p[v],p[v],c);return Sr.fromPoints(p)}static applyTransformFast(s,c){const p=[c[12],c[13],c[14]],v=[...p];for(let m=0;m<3;m++)for(let x=0;x<3;x++){const k=c[4*x+m],N=k*s.min[x],z=k*s.max[x];p[m]+=Math.min(N,z),v[m]+=Math.max(N,z)}return new Sr(p,v)}static projectAabbCorners(s,c){const p=s.getCorners();for(let v=0;v<p.length;++v)De.vec3.transformMat4(p[v],p[v],c);return p}constructor(s,c){this.min=s,this.max=c,this.center=De.vec3.scale([],De.vec3.add([],this.min,this.max),.5)}quadrant(s){const c=[s%2==0,s<2],p=De.vec3.clone(this.min),v=De.vec3.clone(this.max);for(let m=0;m<c.length;m++)p[m]=c[m]?this.min[m]:this.center[m],v[m]=c[m]?this.center[m]:this.max[m];return v[2]=this.max[2],new Sr(p,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,c=this.max;return[[s[0],s[1],s[2]],[c[0],s[1],s[2]],[c[0],c[1],s[2]],[s[0],c[1],s[2]],[s[0],s[1],c[2]],[c[0],s[1],c[2]],[c[0],c[1],c[2]],[s[0],c[1],c[2]]]}intersects(s){return this.intersectsAabb(s.bounds)?Gi(s,this.getCorners()):0}intersectsFlat(s){return this.intersectsAabb(s.bounds)?Gi(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(s,c){return c||this.intersects(s)?Zn(s,this.getCorners()):0}intersectsPreciseFlat(s,c){return c||this.intersectsFlat(s)?Zn(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(s){for(let c=0;c<3;++c)if(this.min[c]>s.max[c]||s.min[c]>this.max[c])return!1;return!0}intersectsAabbXY(s){return!(this.min[0]>s.max[0]||s.min[0]>this.max[0]||this.min[1]>s.max[1]||s.min[1]>this.max[1])}encapsulate(s){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],s.min[c]),this.max[c]=Math.max(this.max[c],s.max[c])}encapsulatePoint(s){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],s[c]),this.max[c]=Math.max(this.max[c],s[c])}closestPoint(s){return[Math.max(Math.min(this.max[0],s[0]),this.min[0]),Math.max(Math.min(this.max[1],s[1]),this.min[1]),Math.max(Math.min(this.max[2],s[2]),this.min[2])]}}function kn(h){return h*Ks/sd}mr(Sr,"Aabb");const ei=[new Sr([Ko,Ko,Ko],[co,co,co]),new Sr([Ko,Ko,Ko],[0,0,co]),new Sr([0,Ko,Ko],[co,0,co]),new Sr([Ko,0,Ko],[0,co,co]),new Sr([0,0,Ko],[co,co,co])];function si(h,s,c,p=!0){const v=De.vec3.scale([],h._camera.position,h.worldSize),m=[s,c,1,1];De.vec4.transformMat4(m,m,h.pixelMatrixInverse),De.vec4.scale(m,m,1/m[3]);const x=De.vec3.sub([],m,v),k=De.vec3.normalize([],x),N=h.globeMatrix,z=[N[12],N[13],N[14]],C=De.vec3.sub([],z,v),R=De.vec3.length(C),L=De.vec3.normalize([],C),j=h.worldSize/(2*Math.PI),I=De.vec3.dot(L,k),$=Math.asin(j/R);if($<Math.acos(I)){if(!p)return null;const Je=[],Fe=[];De.vec3.scale(Je,k,R/I),De.vec3.normalize(Fe,De.vec3.sub(Fe,Je,C)),De.vec3.normalize(k,De.vec3.add(k,C,De.vec3.scale(k,Fe,Math.tan($)*R)))}const X=[];new Hr(v,k).closestPointOnSphere(z,j,X);const Q=De.vec3.normalize([],Ta(N,0)),le=De.vec3.normalize([],Ta(N,1)),ue=De.vec3.normalize([],Ta(N,2)),ie=De.vec3.dot(Q,X),he=De.vec3.dot(le,X),me=De.vec3.dot(ue,X),we=bt(Math.asin(-he/j));let Ie=bt(Math.atan2(ie,me));Ie=h.center.lng+function(Je,Fe){const tt=(Fe-Je+180)%360-180;return tt<-180?tt+360:tt}(h.center.lng,Ie);const Ne=Cc(Ie),Me=ar(Yo(we),0,1);return new d(Ne,Me)}class Qi{constructor(s,c,p){this.a=De.vec3.sub([],s,p),this.b=De.vec3.sub([],c,p),this.center=p;const v=De.vec3.normalize([],this.a),m=De.vec3.normalize([],this.b);this.angle=Math.acos(De.vec3.dot(v,m))}}function na(h,s){if(h.angle===0)return null;let c;return c=h.a[s]===0?1/h.angle*.5*Math.PI:1/h.angle*Math.atan(h.b[s]/h.a[s]/Math.sin(h.angle)-1/Math.tan(h.angle)),c<0||c>1?null:function(p,v,m,x){const k=Math.sin(m);return p*(Math.sin((1-x)*m)/k)+v*(Math.sin(x*m)/k)}(h.a[s],h.b[s],h.angle,ar(c,0,1))+h.center[s]}function Ma(h){if(h.z<=1)return ei[h.z+2*h.y+h.x];const s=Pi(Oi(h));return Sr.fromPoints(s)}function ba(h,s,c){return De.vec3.scale(h,h,1-c),De.vec3.scaleAndAdd(h,h,s,c)}function Es(h,s,c){for(const p of h)De.vec3.transformMat4(p,p,s),De.vec3.scale(p,p,c)}function ks(h,s,c,p){const v=s/h.worldSize,m=h.globeMatrix;if(c.z<=1){const Ne=Ma(c).getCorners();return Es(Ne,m,v),Sr.fromPoints(Ne)}const x=Oi(c,p),k=Pi(x,Ks+kn(h._tileCoverLift));Es(k,m,v);const N=Number.MAX_VALUE,z=[-N,-N,-N],C=[N,N,N];if(x.contains(h.center)){for(const Je of k)De.vec3.min(C,C,Je),De.vec3.max(z,z,Je);z[2]=0;const Ne=h.point,Me=[Ne.x*v,Ne.y*v,0];return De.vec3.min(C,C,Me),De.vec3.max(z,z,Me),new Sr(C,z)}if(h._tileCoverLift>0){for(const Ne of k)De.vec3.min(C,C,Ne),De.vec3.max(z,z,Ne);return new Sr(C,z)}const R=[m[12]*v,m[13]*v,m[14]*v],L=x.getCenter(),j=ar(h.center.lat,-85.051129,Zs),I=ar(L.lat,-85.051129,Zs),$=Cc(h.center.lng),X=Yo(j);let Q=$-Cc(L.lng);const le=X-Yo(I);Q>.5?Q-=1:Q<-.5&&(Q+=1);let ue=0;if(Math.abs(Q)>Math.abs(le))ue=Q>=0?1:3;else{ue=le>=0?0:2;const Ne=[m[4]*v,m[5]*v,m[6]*v],Me=-Math.sin(et(le>=0?x.getSouth():x.getNorth()))*Ks;De.vec3.scaleAndAdd(R,R,Ne,Me)}const ie=k[ue],he=k[(ue+1)%4],me=new Qi(ie,he,R),we=[na(me,0)||ie[0],na(me,1)||ie[1],na(me,2)||ie[2]],Ie=Po(h.zoom);if(Ie>0){const Ne=function({x:Je,y:Fe,z:tt},st,nt,lt,ft){const vt=1/(1<<tt);let ct=Je*vt,Rt=ct+vt,$t=Fe*vt,Nt=$t+vt,hr=0;const or=(ct+Rt)/2-lt;return or>.5?hr=-1:or<-.5&&(hr=1),ct=((ct+hr)*st-(lt*=st))*nt+lt,Rt=((Rt+hr)*st-lt)*nt+lt,$t=($t*st-(ft*=st))*nt+ft,Nt=(Nt*st-ft)*nt+ft,[[ct,Nt,0],[Rt,Nt,0],[Rt,$t,0],[ct,$t,0]]}(c,s,h._pixelsPerMercatorPixel,$,X);for(let Je=0;Je<k.length;Je++)ba(k[Je],Ne[Je],Ie);const Me=De.vec3.add([],Ne[ue],Ne[(ue+1)%4]);De.vec3.scale(Me,Me,.5),ba(we,Me,Ie)}for(const Ne of k)De.vec3.min(C,C,Ne),De.vec3.max(z,z,Ne);return C[2]=Math.min(ie[2],he[2]),De.vec3.min(C,C,we),De.vec3.max(z,z,we),new Sr(C,z)}function Oi({x:h,y:s,z:c},p=!1){const v=1/(1<<c),m=new Kn(Xo(h*v),s===(1<<c)-1&&p?-90:Fr((s+1)*v)),x=new Kn(Xo((h+1)*v),s===0&&p?90:Fr(s*v));return new lu(m,x)}function Pi(h,s=Ks){const c=et(h.getNorth()),p=et(h.getSouth()),v=Math.cos(c),m=Math.cos(p),x=Math.sin(c),k=Math.sin(p),N=h.getWest(),z=h.getEast();return[Zo(m,k,N,s),Zo(m,k,z,s),Zo(v,x,z,s),Zo(v,x,N,s)]}function _i(h,s,c,p){const v=1<<c.z,m=(h/lr+c.x)/v;return lh(Fr((s/lr+c.y)/v),Xo(m),p)}function Nn({min:h,max:s}){return x0/Math.max(s[0]-h[0],s[1]-h[1],s[2]-h[2])}const ia=new Float64Array(16);function is(h){const s=Nn(h),c=De.mat4.fromScaling(ia,[s,s,s]);return De.mat4.translate(c,c,De.vec3.negate([],h.min))}function Ci(h){const s=De.mat4.fromTranslation(ia,h.min),c=1/Nn(h);return De.mat4.scale(s,s,[c,c,c])}function Ds(h){const s=lr/(2*Math.PI);return h/(2*Math.PI)/s}function gl(h,s){return lr/(512*Math.pow(2,h))*Nn(Ma(s))}function gs(h,s,c,p,v){const m=Ds(c),x=[h,s,-c/(2*Math.PI)],k=De.mat4.identity(new Float64Array(16));return De.mat4.translate(k,k,x),De.mat4.scale(k,k,[m,m,m]),De.mat4.rotateX(k,k,et(-v)),De.mat4.rotateY(k,k,et(-p)),k}function Po(h){return tn(ad,Up,h)}function Co(h,s){const c=lh(s.lat,s.lng),p=function(m){const x=lh(m._center.lat,m._center.lng),k=De.vec3.fromValues(0,1,0);let N=De.vec3.cross([],k,x);const z=De.mat4.fromRotation([],-m.angle,x);N=De.vec3.transformMat4(N,N,z),De.mat4.fromRotation(z,-m._pitch,N);const C=De.vec3.normalize([],x);return De.vec3.scale(C,C,kn(m.cameraToCenterDistance/m.pixelsPerMeter)),De.vec3.transformMat4(C,C,z),De.vec3.add([],x,C)}(h),v=De.vec3.subtract([],p,c);return De.vec3.angle(v,c)}function yl(h,s){return Co(h,s)>Math.PI/2*1.01}const Ni=et(85),uh=Math.cos(Ni),Ql=Math.sin(Ni),dh=De.mat4.create(),Af=h=>{const s=[];return h.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s};function Gp(h,s,c,p,v,m,x,k,N){if(m&&h.queryGeometry.isAboveHorizon)return!1;m&&(N*=h.pixelToTileUnitsFactor);const z=h.tileID.canonical,C=c.projection.upVectorScale(z,c.center.lat,c.worldSize).metersToTile;for(const R of s)for(const L of R){const j=L.add(k),I=v&&c.elevation?c.elevation.exaggeration()*v.getElevationAt(j.x,j.y,!0):0,$=c.projection.projectTilePoint(j.x,j.y,z);if(I>0){const ue=c.projection.upVector(z,j.x,j.y);$.x+=ue[0]*C*I,$.y+=ue[1]*C*I,$.z+=ue[2]*C*I}const X=m?j:cg($.x,$.y,$.z,p),Q=m?h.tilespaceRays.map(ue=>W_(ue,I)):h.queryGeometry.screenGeometry,le=De.vec4.transformMat4([],[$.x,$.y,$.z,1],p);if(!x&&m?N*=le[3]/c.cameraToCenterDistance:x&&!m&&(N*=c.cameraToCenterDistance/le[3]),m){const ue=Fr((L.y/lr+z.y)/(1<<z.z));N/=c.projection.pixelsPerMeter(ue,1)/qi(1,ue)}if(be(Q,X,N))return!0}return!1}function cg(h,s,c,p){const v=De.vec4.transformMat4([],[h,s,c,1],p);return new Pt(v[0]/v[3],v[1]/v[3])}const k2=De.vec3.fromValues(0,0,0),Ec=De.vec3.fromValues(0,0,1);function W_(h,s){const c=De.vec3.create();return k2[2]=s,h.intersectsPlane(k2,Ec,c),new Pt(c[0],c[1])}class M2 extends ve{}let hh,$y,Tf,qy;function _0(h,{width:s,height:c},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==s*c*p)throw new RangeError("mismatched image size")}else v=new Uint8Array(s*c*p);return h.width=s,h.height=c,h.data=v,h}function b0(h,s,c){const{width:p,height:v}=s;p===h.width&&v===h.height||(H_(h,s,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,p),height:Math.min(h.height,v)},c,null),h.width=p,h.height=v,h.data=s.data)}function H_(h,s,c,p,v,m,x,k){if(v.width===0||v.height===0)return s;if(v.width>h.width||v.height>h.height||c.x>h.width-v.width||c.y>h.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>s.width||v.height>s.height||p.x>s.width-v.width||p.y>s.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const N=h.data,z=s.data,C=m===4&&k;for(let R=0;R<v.height;R++){const L=((c.y+R)*h.width+c.x)*m,j=((p.y+R)*s.width+p.x)*m;if(C)for(let I=0;I<v.width;I++){const $=L+I*m+3,X=j+I*m;z[X+0]=255,z[X+1]=255,z[X+2]=255,z[X+3]=N[$]}else if(x)for(let I=0;I<v.width;I++){const $=L+I*m,X=j+I*m,Q=N[$+3],le=new Jn(N[$+0]/255*Q,N[$+1]/255*Q,N[$+2]/255*Q,Q).toRenderColor(x).toArray();z[X+0]=le[0],z[X+1]=le[1],z[X+2]=le[2],z[X+3]=le[3]}else for(let I=0;I<v.width*m;I++)z[j+I]=N[L+I]}return s}mr(M2,"HeatmapBucket",{omit:["layers"]});class od{constructor(s,c){_0(this,s,1,c)}resize(s){b0(this,new od(s),1)}clone(){return new od({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,p,v,m){H_(s,c,p,v,m,1,null)}}class Ls{constructor(s,c){_0(this,s,4,c)}resize(s){b0(this,new Ls(s),4)}replace(s,c){c?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new Ls({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,c,p,v,m,x,k){H_(s,c,p,v,m,4,x,k)}}class K_{constructor(s,c){this.width=s.width,this.height=s.height,this.data=c instanceof Uint8Array?new Float32Array(c.buffer):c}}function ug(h){const s={},c=h.resolution||256,p=h.clips?h.clips.length:1,v=h.image||new Ls({width:c,height:p}),m=(x,k,N)=>{s[h.evaluationKey]=N;const z=h.expression.evaluate(s);z&&(v.data[x+k+0]=Math.floor(255*z.r/z.a),v.data[x+k+1]=Math.floor(255*z.g/z.a),v.data[x+k+2]=Math.floor(255*z.b/z.a),v.data[x+k+3]=Math.floor(255*z.a))};if(h.clips)for(let x=0,k=0;x<p;++x,k+=4*c)for(let N=0,z=0;N<c;N++,z+=4){const C=N/(c-1),{start:R,end:L}=h.clips[x];m(k,z,R*(1-C)+L*C)}else for(let x=0,k=0;x<c;x++,k+=4)m(0,k,x/(c-1));return v}mr(od,"AlphaImage"),mr(Ls,"RGBAImage");const w0=Qn([{name:"a_pos",components:2,type:"Int16"}],4),{members:S0}=w0;function dg(h,s,c=2){const p=s&&s.length,v=p?s[0]*c:h.length;let m=A0(h,0,v,c,!0);const x=[];if(!m||m.next===m.prev)return x;let k,N,z;if(p&&(m=function(C,R,L,j){const I=[];for(let $=0,X=R.length;$<X;$++){const Q=A0(C,R[$]*j,$<X-1?R[$+1]*j:C.length,j,!1);Q===Q.next&&(Q.steiner=!0),I.push(Gy(Q))}I.sort(j2);for(let $=0;$<I.length;$++)L=xC(I[$],L);return L}(h,s,m,c)),h.length>80*c){k=1/0,N=1/0;let C=-1/0,R=-1/0;for(let L=c;L<v;L+=c){const j=h[L],I=h[L+1];j<k&&(k=j),I<N&&(N=I),j>C&&(C=j),I>R&&(R=I)}z=Math.max(C-k,R-N),z=z!==0?32767/z:0}return hg(m,x,c,k,N,z,0),x}function A0(h,s,c,p,v){let m;if(v===function(x,k,N,z){let C=0;for(let R=k,L=N-z;R<N;R+=z)C+=(x[L]-x[R])*(x[R+1]+x[L+1]),L=R;return C}(h,s,c,p)>0)for(let x=s;x<c;x+=p)m=yt(x/p|0,h[x],h[x+1],m);else for(let x=c-p;x>=s;x-=p)m=yt(x/p|0,h[x],h[x+1],m);return m&&T(m,m.next)&&(Ct(m),m=m.next),m}function Wp(h,s){if(!h)return h;s||(s=h);let c,p=h;do if(c=!1,p.steiner||!T(p,p.next)&&b(p.prev,p,p.next)!==0)p=p.next;else{if(Ct(p),p=s=p.prev,p===p.next)break;c=!0}while(c||p!==s);return s}function hg(h,s,c,p,v,m,x){if(!h)return;!x&&m&&function(N,z,C,R){let L=N;do L.z===0&&(L.z=X_(L.x,L.y,z,C,R)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==N);L.prevZ.nextZ=null,L.prevZ=null,function(j){let I,$=1;do{let X,Q=j;j=null;let le=null;for(I=0;Q;){I++;let ue=Q,ie=0;for(let me=0;me<$&&(ie++,ue=ue.nextZ,ue);me++);let he=$;for(;ie>0||he>0&&ue;)ie!==0&&(he===0||!ue||Q.z<=ue.z)?(X=Q,Q=Q.nextZ,ie--):(X=ue,ue=ue.nextZ,he--),le?le.nextZ=X:j=X,X.prevZ=le,le=X;Q=ue}le.nextZ=null,$*=2}while(I>1)}(L)}(h,p,v,m);let k=h;for(;h.prev!==h.next;){const N=h.prev,z=h.next;if(m?T0(h,p,v,m):Z_(h))s.push(N.i,h.i,z.i),Ct(h),h=z.next,k=z.next;else if((h=z)===k){x?x===1?hg(h=Y_(Wp(h),s),s,c,p,v,m,2):x===2&&P0(h,s,c,p,v,m):hg(Wp(h),s,c,p,v,m,1);break}}}function Z_(h){const s=h.prev,c=h,p=h.next;if(b(s,c,p)>=0)return!1;const v=s.x,m=c.x,x=p.x,k=s.y,N=c.y,z=p.y,C=v<m?v<x?v:x:m<x?m:x,R=k<N?k<z?k:z:N<z?N:z,L=v>m?v>x?v:x:m>x?m:x,j=k>N?k>z?k:z:N>z?N:z;let I=p.next;for(;I!==s;){if(I.x>=C&&I.x<=L&&I.y>=R&&I.y<=j&&fg(v,k,m,N,x,z,I.x,I.y)&&b(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function T0(h,s,c,p){const v=h.prev,m=h,x=h.next;if(b(v,m,x)>=0)return!1;const k=v.x,N=m.x,z=x.x,C=v.y,R=m.y,L=x.y,j=k<N?k<z?k:z:N<z?N:z,I=C<R?C<L?C:L:R<L?R:L,$=k>N?k>z?k:z:N>z?N:z,X=C>R?C>L?C:L:R>L?R:L,Q=X_(j,I,s,c,p),le=X_($,X,s,c,p);let ue=h.prevZ,ie=h.nextZ;for(;ue&&ue.z>=Q&&ie&&ie.z<=le;){if(ue.x>=j&&ue.x<=$&&ue.y>=I&&ue.y<=X&&ue!==v&&ue!==x&&fg(k,C,N,R,z,L,ue.x,ue.y)&&b(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,ie.x>=j&&ie.x<=$&&ie.y>=I&&ie.y<=X&&ie!==v&&ie!==x&&fg(k,C,N,R,z,L,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;ue&&ue.z>=Q;){if(ue.x>=j&&ue.x<=$&&ue.y>=I&&ue.y<=X&&ue!==v&&ue!==x&&fg(k,C,N,R,z,L,ue.x,ue.y)&&b(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;ie&&ie.z<=le;){if(ie.x>=j&&ie.x<=$&&ie.y>=I&&ie.y<=X&&ie!==v&&ie!==x&&fg(k,C,N,R,z,L,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function Y_(h,s){let c=h;do{const p=c.prev,v=c.next.next;!T(p,v)&&V(p,c,c.next,v)&&pe(p,v)&&pe(v,p)&&(s.push(p.i,c.i,v.i),Ct(c),Ct(c.next),c=h=v),c=c.next}while(c!==h);return Wp(c)}function P0(h,s,c,p,v,m){let x=h;do{let k=x.next.next;for(;k!==x.prev;){if(x.i!==k.i&&E0(x,k)){let N=Ve(x,k);return x=Wp(x,x.next),N=Wp(N,N.next),hg(x,s,c,p,v,m,0),void hg(N,s,c,p,v,m,0)}k=k.next}x=x.next}while(x!==h)}function j2(h,s){return h.x-s.x}function xC(h,s){const c=function(v,m){let x=m;const k=v.x,N=v.y;let z,C=-1/0;do{if(N<=x.y&&N>=x.next.y&&x.next.y!==x.y){const $=x.x+(N-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if($<=k&&$>C&&(C=$,z=x.x<x.next.x?x:x.next,$===k))return z}x=x.next}while(x!==m);if(!z)return null;const R=z,L=z.x,j=z.y;let I=1/0;x=z;do{if(k>=x.x&&x.x>=L&&k!==x.x&&fg(N<j?k:C,N,L,j,N<j?C:k,N,x.x,x.y)){const $=Math.abs(N-x.y)/(k-x.x);pe(x,v)&&($<I||$===I&&(x.x>z.x||x.x===z.x&&C0(z,x)))&&(z=x,I=$)}x=x.next}while(x!==R);return z}(h,s);if(!c)return s;const p=Ve(c,h);return Wp(p,p.next),Wp(c,c.next)}function C0(h,s){return b(h.prev,h,s.prev)<0&&b(s.next,h,h.next)<0}function X_(h,s,c,p,v){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-c)*v|0)|h<<8))|h<<4))|h<<2))|h<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*v|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Gy(h){let s=h,c=h;do(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next;while(s!==h);return c}function fg(h,s,c,p,v,m,x,k){return(v-x)*(s-k)>=(h-x)*(m-k)&&(h-x)*(p-k)>=(c-x)*(s-k)&&(c-x)*(m-k)>=(v-x)*(p-k)}function E0(h,s){return h.next.i!==s.i&&h.prev.i!==s.i&&!function(c,p){let v=c;do{if(v.i!==c.i&&v.next.i!==c.i&&v.i!==p.i&&v.next.i!==p.i&&V(v,v.next,c,p))return!0;v=v.next}while(v!==c);return!1}(h,s)&&(pe(h,s)&&pe(s,h)&&function(c,p){let v=c,m=!1;const x=(c.x+p.x)/2,k=(c.y+p.y)/2;do v.y>k!=v.next.y>k&&v.next.y!==v.y&&x<(v.next.x-v.x)*(k-v.y)/(v.next.y-v.y)+v.x&&(m=!m),v=v.next;while(v!==c);return m}(h,s)&&(b(h.prev,h,s.prev)||b(h,s.prev,s))||T(h,s)&&b(h.prev,h,h.next)>0&&b(s.prev,s,s.next)>0)}function b(h,s,c){return(s.y-h.y)*(c.x-s.x)-(s.x-h.x)*(c.y-s.y)}function T(h,s){return h.x===s.x&&h.y===s.y}function V(h,s,c,p){const v=de(b(h,s,c)),m=de(b(h,s,p)),x=de(b(c,p,h)),k=de(b(c,p,s));return v!==m&&x!==k||!(v!==0||!J(h,c,s))||!(m!==0||!J(h,p,s))||!(x!==0||!J(c,h,p))||!(k!==0||!J(c,s,p))}function J(h,s,c){return s.x<=Math.max(h.x,c.x)&&s.x>=Math.min(h.x,c.x)&&s.y<=Math.max(h.y,c.y)&&s.y>=Math.min(h.y,c.y)}function de(h){return h>0?1:h<0?-1:0}function pe(h,s){return b(h.prev,h,h.next)<0?b(h,s,h.next)>=0&&b(h,h.prev,s)>=0:b(h,s,h.prev)<0||b(h,h.next,s)<0}function Ve(h,s){const c=Zt(h.i,h.x,h.y),p=Zt(s.i,s.x,s.y),v=h.next,m=s.prev;return h.next=s,s.prev=h,c.next=v,v.prev=c,p.next=c,c.prev=p,m.next=p,p.prev=m,p}function yt(h,s,c,p){const v=Zt(h,s,c);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function Ct(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function Zt(h,s,c){return{i:h,x:s,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Tr(h,s){const c=h.length;if(c<=1)return[h];const p=[];let v,m;for(let x=0;x<c;x++){const k=Mu(h[x]);k!==0&&(h[x].area=Math.abs(k),m===void 0&&(m=k<0),m===k<0?(v&&p.push(v),v=[h[x]]):v.push(h[x]))}if(v&&p.push(v),s>1)for(let x=0;x<p.length;x++)p[x].length<=s||(hp(p[x],s,1,p[x].length-1,Mr),p[x]=p[x].slice(0,s));return p}function Mr(h,s){return s.area-h.area}function Pr(h,s,c=1){if(!h)return null;const p=typeof h=="string"?h:h.getPrimary().id;s[p]||(s[p]=[]);const v=Ts.from(p).getPrimary().scaleSelf(c);return s[p].push(v),v.serialize()}function Jr(h,s,c,p){const v=p.patternDependencies;let m=!1;for(const x of s){const k=x.paint.get(`${h}-pattern`);k.isConstant()||(m=!0),Pr(k.constantOr(null),v,c)&&(m=!0)}return m}function ln(h,s,c,p,v,m){const x=m.patternDependencies;for(const k of s){const N=k.paint.get(`${h}-pattern`).value;if(N.kind!=="constant"){let z=N.evaluate({zoom:p},c,{},m.availableImages);z=z&&z.name?z.name:z;const C=Pr(z,x,v);C&&(c.patterns[k.id]=C)}}return c}class un{constructor(s){this.zoom=s.zoom,this.pixelRatio=s.pixelRatio,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ao,this.indexArray=new ms,this.indexArray2=new Cs,this.programConfigurations=new ou(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new ya,this.segments2=new ya,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=s.projection}updateFootprints(s,c){}populate(s,c,p,v){this.hasPattern=Jr("fill",this.layers,this.pixelRatio,c);const m=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:k,id:N,index:z,sourceLayerIndex:C}of s){const R=this.layers[0]._featureFilter.needGeometry,L=te(k,R);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),L,p))continue;const j=m?m.evaluate(L,{},p,c.availableImages):void 0,I={id:N,properties:k.properties,type:k.type,sourceLayerIndex:C,index:z,geometry:R?L.geometry:Y(k,p,v),patterns:{},sortKey:j};x.push(I)}m&&x.sort((k,N)=>k.sortKey-N.sortKey);for(const k of x){const{geometry:N,index:z,sourceLayerIndex:C}=k;if(this.hasPattern){const R=ln("fill",this.layers,k,this.zoom,this.pixelRatio,c);this.patternFeatures.push(R)}else this.addFeature(k,N,z,p,{},c.availableImages,c.brightness,c.elevationFeatures);c.featureIndex.insert(s[z].feature,N,z,C,this.index)}}update(s,c,p,v,m,x,k){this.programConfigurations.updatePaintArrays(s,c,m,p,v,x,k)}addFeatures(s,c,p,v,m,x){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,c,p,v,x,s.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,S0),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,c,p,v,m,x=[],k,N){for(const z of Tr(c,500)){let C=0;for(const X of z)C+=X.length;const R=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),L=R.vertexLength,j=[],I=[];for(const X of z){if(X.length===0)continue;X!==z[0]&&I.push(j.length/2);const Q=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),le=Q.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(le+X.length-1,le),j.push(X[0].x),j.push(X[0].y);for(let ue=1;ue<X.length;ue++)this.layoutVertexArray.emplaceBack(X[ue].x,X[ue].y),this.indexArray2.emplaceBack(le+ue-1,le+ue),j.push(X[ue].x),j.push(X[ue].y);Q.vertexLength+=X.length,Q.primitiveLength+=X.length}const $=dg(j,I);for(let X=0;X<$.length;X+=3)this.indexArray.emplaceBack(L+$[X],L+$[X+1],L+$[X+2]);R.vertexLength+=C,R.primitiveLength+=$.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,x,v,k)}}let ys,Vt,Ot,Gt;mr(un,"FillBucket",{omit:["layers","patternFeatures"]});class Nr{constructor(s,c,p,v){if(this.triangleCount=c.length/3,this.min=new Pt(0,0),this.max=new Pt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||s.length===0)return;const[m,x]=[s[0].clone(),s[0].clone()];for(let R=1;R<s.length;++R){const L=s[R];m.x=Math.min(m.x,L.x),m.y=Math.min(m.y,L.y),x.x=Math.max(x.x,L.x),x.y=Math.max(x.y,L.y)}if(v){const R=Math.ceil(Math.max(x.x-m.x,x.y-m.y)/v);p=Math.max(p,R)}if(p===0)return;this.min=m,this.max=x;const k=this.max.sub(this.min);k.x=Math.max(k.x,1),k.y=Math.max(k.y,1);const N=Math.max(k.x,k.y)/p;this.cellsX=Math.max(1,Math.ceil(k.x/N)),this.cellsY=Math.max(1,Math.ceil(k.y/N)),this.xScale=1/N,this.yScale=1/N;const z=[];for(let R=0;R<this.triangleCount;R++){const L=s[c[3*R+0]].sub(this.min),j=s[c[3*R+1]].sub(this.min),I=s[c[3*R+2]].sub(this.min),$=rn(Math.floor(Math.min(L.x,j.x,I.x)),this.xScale,this.cellsX),X=rn(Math.floor(Math.max(L.x,j.x,I.x)),this.xScale,this.cellsX),Q=rn(Math.floor(Math.min(L.y,j.y,I.y)),this.yScale,this.cellsY),le=rn(Math.floor(Math.max(L.y,j.y,I.y)),this.yScale,this.cellsY),ue=new Pt(0,0),ie=new Pt(0,0),he=new Pt(0,0),me=new Pt(0,0);for(let we=Q;we<=le;++we){ue.y=ie.y=we*N,he.y=me.y=(we+1)*N;for(let Ie=$;Ie<=X;++Ie)ue.x=he.x=Ie*N,ie.x=me.x=(Ie+1)*N,(mt(L,j,I,ue,ie,me)||mt(L,j,I,ue,me,he))&&z.push({cellIdx:we*this.cellsX+Ie,triIdx:R})}}if(z.length===0)return;z.sort((R,L)=>R.cellIdx-L.cellIdx||R.triIdx-L.triIdx);let C=0;for(;C<z.length;){const R=z[C].cellIdx,L={start:this.payload.length,len:0};for(;C<z.length&&z[C].cellIdx===R;)++L.len,this.payload.push(z[C++].triIdx);this.cells[R]=L}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(s,c){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>s.x||s.y>this.max.y||this.min.y>s.y)return;const p=rn(s.x-this.min.x,this.xScale,this.cellsX),v=rn(s.y-this.min.y,this.yScale,this.cellsY),m=this.cells[v*this.cellsX+p];if(m){this._lazyInitLookup();for(let x=0;x<m.len;x++){const k=this.payload[m.start+x],N=Math.floor(k/8),z=1<<k%8;if(!(this.lookup[N]&z)&&(this.lookup[N]|=z,c.push(k),c.length===this.triangleCount))return}}}query(s,c,p){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>c.x||s.y>this.max.y||this.min.y>c.y)return;this._lazyInitLookup();const v=rn(s.x-this.min.x,this.xScale,this.cellsX),m=rn(c.x-this.min.x,this.xScale,this.cellsX),x=rn(s.y-this.min.y,this.yScale,this.cellsY),k=rn(c.y-this.min.y,this.yScale,this.cellsY);for(let N=x;N<=k;N++)for(let z=v;z<=m;z++){const C=this.cells[N*this.cellsX+z];if(C)for(let R=0;R<C.len;R++){const L=this.payload[C.start+R],j=Math.floor(L/8),I=1<<L%8;if(!(this.lookup[j]&I)&&(this.lookup[j]|=I,p.push(L),p.length===this.triangleCount))return}}}}function rn(h,s,c){return Math.max(0,Math.min(c-1,Math.floor(h*s)))}mr(Nr,"TriangleGridIndex");class Rn{constructor(s){this.zoom=s.zoom,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.footprints=[]}updateFootprints(s,c){for(const p of this.footprints)c.push({footprint:p,id:s})}populate(s,c,p,v){const m=[];for(const{feature:x,id:k,index:N,sourceLayerIndex:z}of s){const C=this.layers[0]._featureFilter.needGeometry,R=te(x,C);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),R,p))continue;const L={id:k,properties:x.properties,type:x.type,sourceLayerIndex:z,index:N,geometry:C?R.geometry:Y(x,p,v),patterns:{}};m.push(L)}for(const x of m){const{geometry:k,index:N,sourceLayerIndex:z}=x;this.addFeature(x,k,N,p,{},c.availableImages,c.brightness),c.featureIndex.insert(s[N].feature,k,N,z,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(s){}update(s,c,p,v,m,x,k){}destroy(){}addFeature(s,c,p,v,m,x=[],k){for(const N of Tr(c,2)){const z=[],C=[],R=[],L=new Pt(1/0,1/0),j=new Pt(-1/0,-1/0);for(const X of N)if(X.length!==0){X!==N[0]&&R.push(C.length/2);for(let Q=0;Q<X.length;Q++)C.push(X[Q].x),C.push(X[Q].y),z.push(X[Q]),L.x=Math.min(L.x,X[Q].x),L.y=Math.min(L.y,X[Q].y),j.x=Math.max(j.x,X[Q].x),j.y=Math.max(j.y,X[Q].y)}const I=dg(C,R),$=new Nr(z,I,8,256);this.footprints.push({vertices:z,indices:I,grid:$,min:L,max:j})}}}mr(Rn,"ClipBucket",{omit:["layers"]});const Fn=Qn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),oi=Qn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),ho=Qn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ki=Qn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Pf=Qn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),_C=Qn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:qne}=Fn;var bC,N4,wC,R4,SC,I4,D4,O2={};function L4(){if(N4)return bC;N4=1;var h=Rr();function s(v,m,x,k,N){this.properties={},this.extent=x,this.type=0,this._pbf=v,this._geometry=-1,this._keys=k,this._values=N,v.readFields(c,this,m)}function c(v,m,x){v==1?m.id=x.readVarint():v==2?function(k,N){for(var z=k.readVarint()+k.pos;k.pos<z;){var C=N._keys[k.readVarint()],R=N._values[k.readVarint()];N.properties[C]=R}}(x,m):v==3?m.type=x.readVarint():v==4&&(m._geometry=x.pos)}function p(v){for(var m,x,k=0,N=0,z=v.length,C=z-1;N<z;C=N++)k+=((x=v[C]).x-(m=v[N]).x)*(m.y+x.y);return k}return bC=s,s.types=["Unknown","Point","LineString","Polygon"],s.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var m,x=v.readVarint()+v.pos,k=1,N=0,z=0,C=0,R=[];v.pos<x;){if(N<=0){var L=v.readVarint();k=7&L,N=L>>3}if(N--,k===1||k===2)z+=v.readSVarint(),C+=v.readSVarint(),k===1&&(m&&R.push(m),m=[]),m.push(new h(z,C));else{if(k!==7)throw new Error("unknown command "+k);m&&m.push(m[0].clone())}}return m&&R.push(m),R},s.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var m=v.readVarint()+v.pos,x=1,k=0,N=0,z=0,C=1/0,R=-1/0,L=1/0,j=-1/0;v.pos<m;){if(k<=0){var I=v.readVarint();x=7&I,k=I>>3}if(k--,x===1||x===2)(N+=v.readSVarint())<C&&(C=N),N>R&&(R=N),(z+=v.readSVarint())<L&&(L=z),z>j&&(j=z);else if(x!==7)throw new Error("unknown command "+x)}return[C,L,R,j]},s.prototype.toGeoJSON=function(v,m,x){var k,N,z=this.extent*Math.pow(2,x),C=this.extent*v,R=this.extent*m,L=this.loadGeometry(),j=s.types[this.type];function I(Q){for(var le=0;le<Q.length;le++){var ue=Q[le];Q[le]=[360*(ue.x+C)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+R)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(k=0;k<L.length;k++)$[k]=L[k][0];I(L=$);break;case 2:for(k=0;k<L.length;k++)I(L[k]);break;case 3:for(L=function(Q){var le=Q.length;if(le<=1)return[Q];for(var ue,ie,he=[],me=0;me<le;me++){var we=p(Q[me]);we!==0&&(ie===void 0&&(ie=we<0),ie===we<0?(ue&&he.push(ue),ue=[Q[me]]):ue.push(Q[me]))}return ue&&he.push(ue),he}(L),k=0;k<L.length;k++)for(N=0;N<L[k].length;N++)I(L[k][N])}L.length===1?L=L[0]:j="Multi"+j;var X={type:"Feature",geometry:{type:j,coordinates:L},properties:this.properties};return"id"in this&&(X.id=this.id),X},bC}function z4(){if(R4)return wC;R4=1;var h=L4();function s(p,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(c,this,v),this.length=this._features.length}function c(p,v,m){p===15?v.version=m.readVarint():p===1?v.name=m.readString():p===5?v.extent=m.readVarint():p===2?v._features.push(m.pos):p===3?v._keys.push(m.readString()):p===4&&v._values.push(function(x){for(var k=null,N=x.readVarint()+x.pos;x.pos<N;){var z=x.readVarint()>>3;k=z===1?x.readString():z===2?x.readFloat():z===3?x.readDouble():z===4?x.readVarint64():z===5?x.readVarint():z===6?x.readSVarint():z===7?x.readBoolean():null}return k}(m))}return wC=s,s.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var v=this._pbf.readVarint()+this._pbf.pos;return new h(this._pbf,v,this.extent,this._keys,this._values)},wC}function F4(){return D4||(D4=1,O2.VectorTile=function(){if(I4)return SC;I4=1;var h=z4();function s(c,p,v){if(c===3){var m=new h(v,v.readVarint()+v.pos);m.length&&(p[m.name]=m)}}return SC=function(c,p){this.layers=c.readFields(s,{},p)},SC}(),O2.VectorTileFeature=L4(),O2.VectorTileLayer=z4()),O2}var k0=F4();class Wy extends Pt{constructor(s,c,p){super(s,c),this.z=p}}class B4 extends Wy{constructor(s,c,p,v){super(s,c,p),this.w=v}}function N2(h,s,c,p){const v=[],m=p===0?(x,k,N,z,C,R)=>{x.push(new Pt(R,N+(R-k)/(z-k)*(C-N)))}:(x,k,N,z,C,R)=>{x.push(new Pt(k+(R-N)/(C-N)*(z-k),R))};for(const x of h){const k=[];for(const N of x){if(N.length<=2)continue;const z=[];for(let L=0;L<N.length-1;L++){const j=N[L].x,I=N[L].y,$=N[L+1].x,X=N[L+1].y,Q=p===0?j:I,le=p===0?$:X;Q<s?le>s&&m(z,j,I,$,X,s):Q>c?le<c&&m(z,j,I,$,X,c):z.push(N[L]),le<s&&Q>=s&&m(z,j,I,$,X,s),le>c&&Q<=c&&m(z,j,I,$,X,c)}let C=N[N.length-1];const R=p===0?C.x:C.y;R>=s&&R<=c&&z.push(C),z.length&&(C=z[z.length-1],z[0].x===C.x&&z[0].y===C.y||z.push(z[0]),k.push(z))}k.length&&v.push(k)}return v}function V4(h,s,c,p){const v=c==="x"?"y":"x",m=(p-h[c])/(s[c]-h[c]);h[v]=h[v]+(s[v]-h[v])*m,h[c]=p,h.hasOwnProperty("z")&&(h.z=Lr(h.z,s.z,m)),h.hasOwnProperty("w")&&(h.w=Lr(h.w,s.w,m))}function U4(h,s,c,p){const v=c,m=p;for(const x of["x","y"]){let k=h,N=s;k[x]>=N[x]&&(k=s,N=h),k[x]<v&&N[x]>v&&V4(k,N,x,v),k[x]<m&&N[x]>m&&V4(N,k,x,m)}}const R2=Number.MAX_SAFE_INTEGER;function $4(h,s,c,p){return h.order<s||h.order===R2||!(h.clipMask&c)||function(v,m){return m.length!==0&&m.find(x=>x===v)===void 0}(p,h.clipScope)}function I2(h,s){return h.x-s.x||h.y-s.y}function q4(h,s){return I2(h.min,s.min)===0&&I2(h.max,s.max)===0}function AC(h,s){return!(h.min.x>s.max.x||h.max.x<s.min.x||h.min.y>s.max.y||h.max.y<s.min.y)}function TC(h,s){if(h.length!==s.length)return!1;for(let c=0;c<h.length;c++)if(h[c].sourceId!==s[c].sourceId||!q4(h[c],s[c])||h[c].order!==s[c].order||h[c].clipMask!==s[c].clipMask||!nn(h[c].clipScope,s[c].clipScope))return!1;return!0}function G4(h,s,c){const p=1/lr,v=1/(1<<c.canonical.z),m=(s.x*p+c.canonical.x)*v+c.wrap,x=(s.y*p+c.canonical.y)*v;return{min:new Pt((h.x*p+c.canonical.x)*v+c.wrap,(h.y*p+c.canonical.y)*v),max:new Pt(m,x)}}function Gne(h,s,c){const p=1<<c.canonical.z,v=((s.x-c.wrap)*p-c.canonical.x)*lr,m=(s.y*p-c.canonical.y)*lr;return{min:new Pt(((h.x-c.wrap)*p-c.canonical.x)*lr,(h.y*p-c.canonical.y)*lr),max:new Pt(v,m)}}function W4(h,s,c,p,v,m,x){const k=h.indices,N=h.vertices,z=[];for(let C=p;C<p+v;C+=3){const R=s[c[C+0]+m],L=s[c[C+1]+m],j=s[c[C+2]+m],I=Math.min(R.x,L.x,j.x),$=Math.max(R.x,L.x,j.x),X=Math.min(R.y,L.y,j.y),Q=Math.max(R.y,L.y,j.y);z.length=0,h.grid.query(new Pt(I,X),new Pt($,Q),z);for(let le=0;le<z.length;le++){const ue=z[le];if(mt(N[k[3*ue+0]],N[k[3*ue+1]],N[k[3*ue+2]],R,L,j,x))return!0}}return!1}function H4(h,s,c,p){if(!h||!c)return!1;let v=h.vertices;if(!s.canonical.equals(p.canonical)||s.wrap!==p.wrap){if(c.vertices.length<h.vertices.length)return H4(c,p,h,s);const m=s.canonical,x=p.canonical,k=Math.pow(2,x.z-m.z);v=h.vertices.map(N=>new Pt((N.x+m.x*lr)*k-x.x*lr,(N.y+m.y*lr)*k-x.y*lr))}return W4(c,v,h.indices,0,h.indices.length,0,0)}function K4(h,s,c,p){const v=Math.pow(2,p.z-c.z);return new Pt((h+c.x*lr)*v-p.x*lr,(s+c.y*lr)*v-p.y*lr)}function Z4(h,s){const c=[];s.grid.queryPoint(h,c);const p=s.indices,v=s.vertices;for(let m=0;m<c.length;m++){const x=c[m];if($e([v[p[3*x+0]],v[p[3*x+1]],v[p[3*x+2]]],h))return!0}return!1}const PC=[new Pt(0,0),new Pt(lr,0),new Pt(lr,lr),new Pt(0,lr)];function Y4(h,s){const c=[];let p=[];if(!s||h.length<2)return[h];if(h.length===2)return it(h[0],h[1],PC)?[h]:[];for(let v=0;v<h.length+2;v++){const m=h[v%h.length],x=h[(v+1)%h.length],k=it(v===0?h[h.length-1]:h[(v-1)%h.length],m,PC),N=it(m,x,PC),z=k||N;z&&p.push(m),z&&N||p.length>0&&(p.length>1&&c.push(p),p=[])}return p.length>1&&c.push(p),c}const CC=k0.VectorTileFeature.types,Wne=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Hne=["fill-extrusion-flood-light-ground-radius"],Kne=Math.pow(2,13),Zne=Math.pow(2,15)-1,X4=new Pt(0,1),pg=2147483648;function J_(h,s,c,p,v,m,x,k){h.emplaceBack((s<<1)+x,(c<<1)+m,(Math.floor(p*Kne)<<1)+v,Math.round(k))}function Q_(h,s,c){h.emplaceBack(s.x*lr,s.y*lr,c?1:0)}function D2(h,s,c,p,v,m){h.emplaceBack(s.x,s.y,(c.x<<1)+p,(c.y<<1)+v,m)}function eb(h,s,c){h.emplaceBack(s.x,s.y,s.z,c[0]*16384,c[1]*16384,c[2]*16384)}class J4{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class Q4{constructor(){this.centroidXY=new Pt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Pt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Pt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Pt(this.max.x-this.min.x,this.max.y-this.min.y)}}class ez{constructor(){this.acc=new Pt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(s,c){s.min.x===Number.MAX_VALUE&&(s.min.x=s.max.x=c.x,s.min.y=s.max.y=c.y)}appendEdge(s,c,p){this.accCount++,this.acc._add(c);let v=!!this.borders;c.x<s.min.x?(s.min.x=c.x,v=!0):c.x>s.max.x&&(s.max.x=c.x,v=!0),c.y<s.min.y?(s.min.y=c.y,v=!0):c.y>s.max.y&&(s.max.y=c.y,v=!0),((c.x===0||c.x===lr)&&c.x===p.x)!=((c.y===0||c.y===lr)&&c.y===p.y)&&this.processBorderOverlap(c,p),v&&this.checkBorderIntersection(c,p)}checkBorderIntersection(s,c){c.x<0!=s.x<0&&this.addBorderIntersection(0,Lr(c.y,s.y,(0-c.x)/(s.x-c.x))),c.x>lr!=s.x>lr&&this.addBorderIntersection(1,Lr(c.y,s.y,(lr-c.x)/(s.x-c.x))),c.y<0!=s.y<0&&this.addBorderIntersection(2,Lr(c.x,s.x,(0-c.y)/(s.y-c.y))),c.y>lr!=s.y>lr&&this.addBorderIntersection(3,Lr(c.x,s.x,(lr-c.y)/(s.y-c.y)))}addBorderIntersection(s,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[s];c<p[0]&&(p[0]=c),c>p[1]&&(p[1]=c)}processBorderOverlap(s,c){if(s.x===c.x){if(s.y===c.y)return;const p=s.x===0?0:1;this.addBorderIntersection(p,c.y),this.addBorderIntersection(p,s.y)}else{const p=s.y===0?2:3;this.addBorderIntersection(p,c.x),this.addBorderIntersection(p,s.x)}}centroid(){return this.accCount===0?new Pt(0,0):new Pt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((s,c)=>s+ +(c[0]!==Number.MAX_VALUE),0):0}}function tz(h,s){const c=h.add(s)._unit(),p=ar(h.x*c.x+h.y*c.y,-1,1);var v,m,x;return x=Math.acos(p),Math.min(4,Math.max(-4,Math.tan(x)))/4*Zne*((v=h).x*(m=s).y-v.y*m.x<0?-1:1)}const Yne=[h=>h.x<0,h=>h.x>lr,h=>h.y<0,h=>h.y>lr];function Xne(h,s,c,p){const v=[4];if(p===0)return v;c._mult(p);const m=h.sub(c),x=s.sub(c),k=[h,s,m,x];for(let N=0;N<4;N++)for(const z of k)if(Yne[N](z)){v.push(N);break}return v}class rz{constructor(s){this.vertexArray=new rs,this.indexArray=new ms,this.programConfigurations=new ou(s.layers,{zoom:s.zoom,lut:s.lut},c=>Hne.includes(c)),this._segments=new ya,this.hiddenByLandmarkVertexArray=new Lp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ya}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(s,c,p,v=!1){const m=s.length;if(m>2){let x=Math.max(0,this._segments.get().length-1);const k=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[x].length);let N;x!==this._segments.get().length-1&&(x++,this._segmentToGroundQuads[x]=[],this._segmentToRegionTriCounts[x]=[0,0,0,0,0]);{const z=s[0],C=s[1];N=tz(z.sub(s[m-1])._perp()._unit(),C.sub(z)._perp()._unit())}for(let z=0;z<m;z++){const C=z===m-1?0:z+1,R=s[z],L=s[C],j=s[C===m-1?0:C+1],I=L.sub(R)._perp()._unit(),$=tz(I,j.sub(L)._perp()._unit()),X=N,Q=$;if(EC(R,L,c)||v&&az(R,c)&&az(L,c)){N=$;continue}const le=k.vertexLength;D2(this.vertexArray,R,L,1,1,X),D2(this.vertexArray,R,L,1,0,X),D2(this.vertexArray,R,L,0,1,Q),D2(this.vertexArray,R,L,0,0,Q),k.vertexLength+=4;const ue=Xne(R,L,I,p);for(const ie of ue)this._segmentToGroundQuads[x].push({id:le,region:ie}),this._segmentToRegionTriCounts[x][ie]+=2,k.primitiveLength+=2;N=$}}}prepareBorderSegments(){if(!this.hasData())return;const s=this._segments.get(),c=s.length;for(let p=0;p<c;p++)this._segmentToGroundQuads[p].sort((v,m)=>v.region-m.region);for(let p=0;p<c;p++){const v=this._segmentToGroundQuads[p],m=s[p],x=this._segmentToRegionTriCounts[p];x.reduce((N,z)=>N+z,0);let k=0;for(let N=0;N<=4;N++){const z=x[N];if(z!==0){let C=this.regionSegments[N];C||(C=this.regionSegments[N]=new ya);const R={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+k,vertexLength:m.vertexLength,primitiveLength:z};C.get().push(R)}k+=z}for(let N=0;N<v.length;N++){const z=v[N].id;this.indexArray.emplaceBack(z,z+1,z+3),this.indexArray.emplaceBack(z,z+3,z+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(s,c,p,v,m,x){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,s,c,p,v,m,x)}upload(s){this.hasData()&&(this.vertexBuffer=s.createVertexBuffer(this.vertexArray,oi.members),this.indexBuffer=s.createIndexBuffer(this.indexArray))}uploadPaintProperties(s){this.hasData()&&this.programConfigurations.upload(s)}update(s,c,p,v,m,x,k){this.hasData()&&this.programConfigurations.updatePaintArrays(s,c,p,v,m,x,k)}updateHiddenByLandmark(s){if(!this.hasData())return;const c=s.groundVertexCount+s.groundVertexArrayOffset;if(s.groundVertexCount===0)return;const p=s.flags&pg?1:0;for(let v=s.groundVertexArrayOffset;v<c;++v)this.hiddenByLandmarkVertexArray.emplace(v,p);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(s){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=s.createVertexBuffer(this.hiddenByLandmarkVertexArray,Pf.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let s=0;s<=4;s++){const c=this.regionSegments[s];c&&c.destroy()}}}}class L2{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.pixelRatio=s.pixelRatio,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ms,this.footprintVertices=new Ao,this.footprintSegments=[],this.layoutVertexArray=new ua,this.centroidVertexArray=new To,this.wallVertexArray=new zy,this.indexArray=new ms,this.programConfigurations=new ou(s.layers,{zoom:s.zoom,lut:s.lut},c=>Wne.includes(c)),this.segments=new ya,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.groundEffect=new rz(s),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(s,c){}populate(s,c,p,v){this.features=[],this.hasPattern=Jr("fill-extrusion",this.layers,this.pixelRatio,c),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=o(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:x,index:k,sourceLayerIndex:N}of s){const z=this.layers[0]._featureFilter.needGeometry,C=te(m,z);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),C,p))continue;const R={id:x,sourceLayerIndex:N,index:k,geometry:z?C.geometry:Y(m,p,v),properties:m.properties,type:m.type,patterns:{}},L=this.layoutVertexArray.length,j=CC[R.type]==="Polygon";if(this.hasPattern)this.features.push(ln("fill-extrusion",this.layers,R,this.zoom,this.pixelRatio,c));else if(this.wallMode)for(const I of R.geometry)for(const $ of Y4(I,j))this.addFeature(R,[$],k,p,{},c.availableImages,v,c.brightness);else this.addFeature(R,R.geometry,k,p,{},c.availableImages,v,c.brightness);c.featureIndex.insert(m,R.geometry,k,N,this.index,L)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(s,c,p,v,m,x){for(const k of this.features){const N=CC[k.type]==="Polygon",{geometry:z}=k;if(this.wallMode)for(const C of z)for(const R of Y4(C,N))this.addFeature(k,[R],k.index,c,p,v,m,x);else this.addFeature(k,z,k.index,c,p,v,m,x)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(s,c,p,v,m,x,k){this.programConfigurations.updatePaintArrays(s,c,m,p,v,x,k),this.groundEffect.update(s,c,m,p,v,x,k)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,qne),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.wallVertexBuffer=s.createVertexBuffer(this.wallVertexArray,Ki.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,_C.members,!0)),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.groundEffect.uploadHiddenByLandmark(s),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,ho.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,c,p,v,m,x,k,N){const z=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,C=[new Pt(0,0),new Pt(lr,lr)],R=k.projection,L=R.name==="globe",j=this.wallMode||CC[s.type]==="Polygon",I=new ez;I.centroidDataIndex=this.centroidData.length;const $=new Q4,X=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},v)<=0,Q=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},v);let le;if($.height=Q,$.vertexArrayOffset=this.layoutVertexArray.length,$.groundVertexArrayOffset=this.groundEffect.vertexArray.length,L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ps),this.wallMode){if(L)return void an("Non zero fill-extrusion-line-width is not yet supported on globe.");if(c.length!==1)return;le=function(Me){const Je=Me[0].x===Me[Me.length-1].x&&Me[0].y===Me[Me.length-1].y;(function(Jt){let qt=0;const Er=Jt.length;for(let yr=0;yr<Er;yr++)qt+=(Jt[(yr+1)%Er].x-Jt[yr].x)*(Jt[(yr+1)%Er].y+Jt[yr].y);return qt>=0})(Me)||(Me=Me.reverse());const tt={geometry:[],joinNormals:[],indices:[]},st=[],nt=[],lt=[];let ft=Me.length;for(;ft>=2&&Me[ft-1].equals(Me[ft-2]);)ft--;if(ft<(Je?3:2))return tt;let vt,ct,Rt,$t,Nt,hr=0;for(;hr<ft-1&&Me[hr].equals(Me[hr+1]);)hr++;Je&&(vt=Me[ft-2],Nt=Me[hr].sub(vt)._unit()._perp());for(let Jt=hr;Jt<ft;Jt++){if(Rt=Jt===ft-1?Je?Me[hr+1]:void 0:Me[Jt+1],Rt&&Me[Jt].equals(Rt))continue;Nt&&($t=Nt),vt&&(ct=vt),vt=Me[Jt],Nt=Rt?Rt.sub(vt)._unit()._perp():$t,$t=$t||Nt;let qt=$t.add(Nt);qt.x===0&&qt.y===0||qt._unit();const Er=qt.x*Nt.x+qt.y*Nt.y,yr=Er!==0?1/Er:1/0,br=$t.x*Nt.y-$t.y*Nt.x>0;let Qr="miter";const pn=2;Qr==="miter"&&yr>pn&&(Qr="bevel"),Qr==="bevel"&&(yr>100&&(Qr="flipbevel"),yr<pn&&(Qr="miter"));const vn=(xn,jn,In,Li)=>{const Ti=new Pt(xn.x,xn.y),cn=new Pt(xn.x,xn.y);Ti.x+=jn.x*Li,Ti.y+=jn.y*Li,cn.x-=jn.x*Math.max(In,1),cn.y-=jn.y*Math.max(In,1),lt.push(jn),st.push(Ti),nt.push(cn)};if(Qr==="miter")qt._mult(yr),vn(vt,qt,0,0);else if(Qr==="flipbevel")qt=Nt.mult(-1),vn(vt,qt,0,0),vn(vt,qt.mult(-1),0,0);else{const xn=-Math.sqrt(yr*yr-1),jn=br?xn:0,In=br?0:xn;ct&&vn(vt,$t,jn,In),Rt&&vn(vt,Nt,jn,In)}}tt.geometry=[...st,...nt.reverse(),st[0]],tt.joinNormals=[...lt,...lt.reverse(),lt[lt.length-1]];const or=tt.geometry.length-1;for(let Jt=0;Jt<or/2;Jt++)if(Jt+1<or/2){let qt=Jt,Er=Jt+1,yr=or-1-Jt,br=or-2-Jt;qt=qt===0?or-1:qt-1,Er=Er===0?or-1:Er-1,yr=yr===0?or-1:yr-1,br=br===0?or-1:br-1,tt.indices.push(yr),tt.indices.push(Er),tt.indices.push(qt),tt.indices.push(yr),tt.indices.push(br),tt.indices.push(Er)}return tt}(c[0]),c=[le.geometry]}const ue=(Me,Je)=>Me<(Je.length-1)/2||Me===Je.length-1,ie=this.wallMode?[c]:Tr(c,500);for(let Me=ie.length-1;Me>=0;Me--){const Je=ie[Me];(Je.length===0||(he=Je[0]).every(Fe=>Fe.x<=0)||he.every(Fe=>Fe.x>=lr)||he.every(Fe=>Fe.y<=0)||he.every(Fe=>Fe.y>=lr))&&ie.splice(Me,1)}var he;let me;if(L)me=cz(ie,C,v);else{me=[];for(const Me of ie)me.push({polygon:Me,bounds:C})}const we=j?this.edgeRadius:0,Ie=we>0&&this.zoom<17,Ne=(Me,Je)=>{if(Me.length===0)return!1;const Fe=Me[Me.length-1];return Je.x===Fe.x&&Je.y===Fe.y};for(const{polygon:Me,bounds:Je}of me){let Fe=0,tt=0;for(const ft of Me)j&&!ft[0].equals(ft[ft.length-1])&&ft.push(ft[0]),tt+=j?ft.length-1:ft.length;const st=this.segments.prepareSegment((j?5:4)*tt,this.layoutVertexArray,this.indexArray);$.footprintSegIdx<0&&($.footprintSegIdx=this.footprintSegments.length),$.polygonSegIdx<0&&($.polygonSegIdx=this.polygonSegments.length);const nt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},lt=new J4;if(lt.vertexOffset=this.footprintVertices.length,lt.indexOffset=3*this.footprintIndices.length,lt.ringIndices=[],j){const ft=[],vt=[];Fe=st.vertexLength;for(let Rt=0;Rt<Me.length;Rt++){const $t=Me[Rt];$t.length&&Rt!==0&&vt.push(ft.length/2);const Nt=[];let hr,or;hr=$t[1].sub($t[0])._perp()._unit(),lt.ringIndices.push($t.length-1);for(let Jt=1;Jt<$t.length;Jt++){const qt=$t[Jt],Er=$t[Jt===$t.length-1?1:Jt+1],yr=qt.clone();if(we){or=Er.sub(qt)._perp()._unit();const br=hr.add(or)._unit(),Qr=we*Math.min(4,1/(hr.x*br.x+hr.y*br.y));yr.x+=Qr*br.x,yr.y+=Qr*br.y,yr.x=Math.round(yr.x),yr.y=Math.round(yr.y),hr=or}if(!X||we!==0&&!Ie||Ne(Nt,yr)||Nt.push(yr),J_(this.layoutVertexArray,yr.x,yr.y,0,0,1,1,0),this.wallMode){const br=ue(Jt,$t);Q_(this.wallVertexArray,le.joinNormals[Jt],!br)}st.vertexLength++,this.footprintVertices.emplaceBack(qt.x,qt.y),ft.push(qt.x,qt.y),L&&eb(this.layoutVertexExtArray,R.projectTilePoint(yr.x,yr.y,v),R.upVector(v,yr.x,yr.y))}X&&(we===0||Ie)&&(Nt.length!==0&&Ne(Nt,Nt[0])&&Nt.pop(),this.groundEffect.addData(Nt,Je,z))}const ct=this.wallMode?le.indices:dg(ft,vt);for(let Rt=0;Rt<ct.length;Rt+=3)this.footprintIndices.emplaceBack(lt.vertexOffset+ct[Rt+0],lt.vertexOffset+ct[Rt+1],lt.vertexOffset+ct[Rt+2]),this.indexArray.emplaceBack(Fe+ct[Rt],Fe+ct[Rt+2],Fe+ct[Rt+1]),st.primitiveLength++;lt.indexCount+=ct.length,lt.vertexCount+=this.footprintVertices.length-lt.vertexOffset}for(let ft=0;ft<Me.length;ft++){const vt=Me[ft];I.startRing($,vt[0]);let ct=vt.length>4&&sz(vt[vt.length-2],vt[0],vt[1]),Rt=we?Jne(vt[vt.length-2],vt[0],vt[1],we):0;const $t=[];let Nt,hr,or;hr=vt[1].sub(vt[0])._perp()._unit();let Jt=!0;for(let qt=1,Er=0;qt<vt.length;qt++){let yr=vt[qt-1],br=vt[qt];const Qr=vt[qt===vt.length-1?1:qt+1];if(I.appendEdge($,br,yr),EC(br,yr,Je)){we&&(hr=Qr.sub(br)._perp()._unit(),Jt=!Jt);continue}const pn=br.sub(yr)._perp(),vn=pn.x/(Math.abs(pn.x)+Math.abs(pn.y)),xn=pn.y>0?1:0,jn=yr.dist(br);if(Er+jn>32768&&(Er=0),we){or=Qr.sub(br)._perp()._unit();let cn=iz(yr,br,Qr,nz(hr,or),we);isNaN(cn)&&(cn=0);const yi=br.sub(yr)._unit();yr=yr.add(yi.mult(Rt))._round(),br=br.add(yi.mult(-cn))._round(),Rt=cn,hr=or,X&&this.zoom>=17&&(Ne($t,yr)||$t.push(yr),Ne($t,br)||$t.push(br))}const In=st.vertexLength,Li=vt.length>4&&sz(yr,br,Qr);let Ti=oz(Er,ct,Jt);if(J_(this.layoutVertexArray,yr.x,yr.y,vn,xn,0,0,Ti),J_(this.layoutVertexArray,yr.x,yr.y,vn,xn,0,1,Ti),this.wallMode){const cn=ue(qt-1,vt),yi=le.joinNormals[qt-1];Q_(this.wallVertexArray,yi,cn),Q_(this.wallVertexArray,yi,cn)}if(Er+=jn,Ti=oz(Er,Li,!Jt),ct=Li,J_(this.layoutVertexArray,br.x,br.y,vn,xn,0,0,Ti),J_(this.layoutVertexArray,br.x,br.y,vn,xn,0,1,Ti),this.wallMode){const cn=ue(qt,vt),yi=le.joinNormals[qt];Q_(this.wallVertexArray,yi,cn),Q_(this.wallVertexArray,yi,cn)}if(st.vertexLength+=4,this.indexArray.emplaceBack(In+0,In+1,In+2),this.indexArray.emplaceBack(In+1,In+3,In+2),st.primitiveLength+=2,we){const cn=Fe+(qt===1?vt.length-2:qt-2),yi=qt===1?Fe:cn+1;if(this.indexArray.emplaceBack(In+1,cn,In+3),this.indexArray.emplaceBack(cn,yi,In+3),st.primitiveLength+=2,Nt===void 0&&(Nt=In),!EC(Qr,vt[qt],Je)){const bi=qt===vt.length-1?Nt:st.vertexLength;this.indexArray.emplaceBack(In+2,In+3,bi),this.indexArray.emplaceBack(In+3,bi+1,bi),this.indexArray.emplaceBack(In+3,yi,bi+1),st.primitiveLength+=3}Jt=!Jt}if(L){const cn=this.layoutVertexExtArray,yi=R.projectTilePoint(yr.x,yr.y,v),bi=R.projectTilePoint(br.x,br.y,v),Zi=R.upVector(v,yr.x,yr.y),Ia=R.upVector(v,br.x,br.y);eb(cn,yi,Zi),eb(cn,yi,Zi),eb(cn,bi,Ia),eb(cn,bi,Ia)}}j&&(Fe+=vt.length-1),X&&we&&this.zoom>=17&&($t.length!==0&&Ne($t,$t[0])&&$t.pop(),this.groundEffect.addData($t,Je,z,we>0))}this.footprintSegments.push(lt),nt.triangleCount=this.indexArray.length-nt.triangleArrayOffset,this.polygonSegments.push(nt),++$.footprintSegLen,++$.polygonSegLen}if($.vertexCount=this.layoutVertexArray.length-$.vertexArrayOffset,$.groundVertexCount=this.groundEffect.vertexArray.length-$.groundVertexArrayOffset,$.vertexCount!==0){if($.centroidXY=I.borders?X4:this.encodeCentroid(I,$),this.centroidData.push($),I.borders){this.featuresOnBorder.push(I);const Me=this.featuresOnBorder.length-1;for(let Je=0;Je<I.borders.length;Je++)I.borders[Je][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Je].push(Me)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,x,v,N),this.groundEffect.addPaintPropertiesData(s,p,m,x,v,N),this.maxHeight=Math.max(this.maxHeight,Q)}}sortBorders(){for(let s=0;s<this.borderFeatureIndices.length;s++)this.borderFeatureIndices[s].sort((c,p)=>this.featuresOnBorder[c].borders[s][0]-this.featuresOnBorder[p].borders[s][0])}splitToSubtiles(){const s=[];for(let k=0;k<this.centroidData.length;k++){const N=this.centroidData[k],z=+(N.min.y+N.max.y>lr),C=2*z+(+(N.min.x+N.max.x>lr)^z);for(let R=0;R<N.polygonSegLen;R++){const L=N.polygonSegIdx+R;s.push({centroidIdx:k,subtile:C,polygonSegmentIdx:L,triangleSegmentIdx:this.polygonSegments[L].triangleSegIdx})}}const c=new ms;s.sort((k,N)=>k.triangleSegmentIdx===N.triangleSegmentIdx?k.subtile-N.subtile:k.triangleSegmentIdx-N.triangleSegmentIdx);let p=0,v=0,m=0;for(const k of s){if(k.triangleSegmentIdx!==p)break;m++}const x=s.length;for(;v!==s.length;){p=s[v].triangleSegmentIdx;let k=0,N=v,z=v;for(let C=N;C<m&&s[C].subtile===k;C++)z++;for(;N!==m;){const C=s[N];k=C.subtile;const R=this.centroidData[C.centroidIdx].min.clone(),L=this.centroidData[C.centroidIdx].max.clone(),j={vertexOffset:this.segments.segments[p].vertexOffset,primitiveOffset:c.length,vertexLength:this.segments.segments[p].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let I=N;I<z;I++){const $=s[I],X=this.polygonSegments[$.polygonSegmentIdx],Q=this.centroidData[$.centroidIdx].min,le=this.centroidData[$.centroidIdx].max,ue=this.indexArray.uint16;for(let ie=X.triangleArrayOffset;ie<X.triangleArrayOffset+X.triangleCount;ie++)c.emplaceBack(ue[3*ie],ue[3*ie+1],ue[3*ie+2]);j.primitiveLength+=X.triangleCount,R.x=Math.min(R.x,Q.x),R.y=Math.min(R.y,Q.y),L.x=Math.max(L.x,le.x),L.y=Math.max(L.y,le.y)}j.primitiveLength>0&&this.triangleSubSegments.push({segment:j,min:R,max:L}),N=z;for(let I=N;I<m&&s[I].subtile===s[N].subtile;I++)z++}v=m;for(let C=v;C<x&&s[C].triangleSegmentIdx===s[v].triangleSegmentIdx;C++)m++}c._trim(),this.indexArray=c}getVisibleSegments(s,c,p){const v=new ya;if(this.wallMode){for(const $ of this.triangleSubSegments)v.segments.push($.segment);return v}let m=0,x=0;const k=1<<s.canonical.z;if(c){const $=c.getMinMaxForTile(s);$&&(m=$.min,x=$.max)}x+=this.maxHeight;const N=s.toUnwrapped();let z;const C=[N.canonical.x/k+N.wrap,N.canonical.y/k],R=[(N.canonical.x+1)/k+N.wrap,(N.canonical.y+1)/k],L=($,X,Q)=>[$[0]*(1-Q[0])+X[0]*Q[0],$[1]*(1-Q[1])+X[1]*Q[1]],j=[],I=[];for(const $ of this.triangleSubSegments){j[0]=$.min.x/lr,j[1]=$.min.y/lr,I[0]=$.max.x/lr,I[1]=$.max.y/lr;const X=L(C,R,j),Q=L(C,R,I);if(new Sr([X[0],X[1],m],[Q[0],Q[1],x]).intersectsPrecise(p)===0){z&&(v.segments.push(z),z=void 0);continue}const le=$.segment;z&&z.vertexOffset!==le.vertexOffset&&(v.segments.push(z),z=void 0),z?(z.vertexLength+=le.vertexLength,z.primitiveLength+=le.primitiveLength):z={vertexOffset:le.vertexOffset,primitiveLength:le.primitiveLength,vertexLength:le.vertexLength,primitiveOffset:le.primitiveOffset,sortKey:void 0,vaos:{}}}return z&&v.segments.push(z),v}encodeCentroid(s,c){const p=s.centroid(),v=c.span(),m=Math.min(7,Math.round(v.x*this.tileToMeter/10)),x=Math.min(7,Math.round(v.y*this.tileToMeter/10));return new Pt(ar(p.x,1,lr-1)<<3|m,ar(p.y,1,lr-1)<<3|x)}encodeBorderCentroid(s){if(!s.borders)return new Pt(0,0);const c=s.borders,p=Number.MAX_VALUE;if(c[0][0]!==p||c[1][0]!==p){const v=c[0][0]!==p?0:1;return new Pt(6|(c[0][0]!==p?0:65528),(c[v][0]+c[v][1])/2<<3|6)}{const v=c[2][0]!==p?2:3;return new Pt((c[v][0]+c[v][1])/2<<3|6,6|(c[2][0]!==p?0:65528))}}showCentroid(s){const c=this.centroidData[s.centroidDataIndex];c.flags&=pg,c.centroidXY.x=0,c.centroidXY.y=0,this.writeCentroidToBuffer(c)}writeCentroidToBuffer(s){this.groundEffect.updateHiddenByLandmark(s);const c=s.vertexArrayOffset,p=s.vertexCount+s.vertexArrayOffset,v=s.flags&pg?X4:s.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(c);if(this.centroidVertexArray.geta_centroid_pos1(c)!==v.y||m!==v.x){for(let x=c;x<p;++x)this.centroidVertexArray.emplace(x,v.x,v.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const s of this.centroidData)this.writeCentroidToBuffer(s)}updateReplacement(s,c,p){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const v=c.getReplacementRegionsForTile(s.toUnwrapped());if(TC(this.activeReplacements,v))return;if(this.activeReplacements=v,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const x of this.centroidData)x.flags&=2147483647;const m=[];for(const x of this.activeReplacements){if(x.order<p)continue;const k=Math.max(1,Math.pow(2,x.footprintTileId.canonical.z-s.canonical.z));for(const N of this.centroidData)if(!(N.flags&pg||x.min.x>N.max.x||N.min.x>x.max.x||x.min.y>N.max.y||N.min.y>x.max.y))for(let z=0;z<N.footprintSegLen;z++){const C=this.footprintSegments[N.footprintSegIdx+z];if(m.length=0,Qne(this.footprintVertices,C.vertexOffset,C.vertexCount,x.footprintTileId.canonical,s.canonical,m),W4(x.footprint,m,this.footprintIndices.uint16,C.indexOffset,C.indexCount,-C.vertexOffset,-k)){N.flags|=pg;break}}}for(const x of this.centroidData)this.writeCentroidToBuffer(x);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(s,c,p){let v=!1;for(let m=0;m<p.footprintSegLen;m++){const x=this.footprintSegments[p.footprintSegIdx+m];let k=0;for(const N of x.ringIndices){for(let z=k,C=N+k-1;z<N+k;C=z++){const R=this.footprintVertices.int16[2*(z+x.vertexOffset)+0],L=this.footprintVertices.int16[2*(z+x.vertexOffset)+1],j=this.footprintVertices.int16[2*(C+x.vertexOffset)+1];L>c!=j>c&&s<(this.footprintVertices.int16[2*(C+x.vertexOffset)+0]-R)*(c-L)/(j-L)+R&&(v=!v)}k=N}}return v}getHeightAtTileCoord(s,c){let p=Number.NEGATIVE_INFINITY,v=!0;const m=4*(s+lr)*lr+(c+lr);if(this.partLookup.hasOwnProperty(m)){const x=this.partLookup[m];return x?{height:x.height,hidden:!!(x.flags&pg)}:void 0}for(const x of this.centroidData)s>x.max.x||x.min.x>s||c>x.max.y||x.min.y>c||this.footprintContainsPoint(s,c,x)&&x&&x.height>p&&(p=x.height,this.partLookup[m]=x,v=!!(x.flags&pg));if(p!==Number.NEGATIVE_INFINITY)return{height:p,hidden:v};this.partLookup[m]=void 0}}function nz(h,s){const c=h.add(s)._unit();return h.x*c.x+h.y*c.y}function Jne(h,s,c,p){const v=s.sub(h)._perp()._unit(),m=c.sub(s)._perp()._unit();return iz(h,s,c,nz(v,m),p)}function iz(h,s,c,p,v){const m=Math.sqrt(1-p*p);return Math.min(h.dist(s)/3,s.dist(c)/3,v*m/p)}function EC(h,s,c){return h.x<c[0].x&&s.x<c[0].x||h.x>c[1].x&&s.x>c[1].x||h.y<c[0].y&&s.y<c[0].y||h.y>c[1].y&&s.y>c[1].y}function az(h,s){return h.x<s[0].x||h.x>s[1].x||h.y<s[0].y||h.y>s[1].y}function sz(h,s,c){if(h.x<0||h.x>=lr||s.x<0||s.x>=lr||c.x<0||c.x>=lr)return!1;const p=c.sub(s),v=p.perp(),m=h.sub(s);return(p.x*m.x+p.y*m.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(m.x*m.x+m.y*m.y))>-.866&&v.x*m.x+v.y*m.y<0}function oz(h,s,c){const p=s?2|h:-3&h;return c?1|p:-2&p}function lz(){const h=Math.PI/32,s=Math.tan(h),c=sd;return c*Math.sqrt(1+2*s*s)-c}function cz(h,s,c){const p=1<<c.z,v=Xo(c.x/p),m=Xo((c.x+1)/p),x=Fr(c.y/p),k=Fr((c.y+1)/p);return function(N,z,C,R,L=0,j){const I=[];if(!N.length||!C||!R)return I;const $=(me,we)=>{for(const Ie of me)I.push({polygon:Ie,bounds:we})},X=Math.ceil(Math.log2(C)),Q=Math.ceil(Math.log2(R)),le=X-Q,ue=[];for(let me=0;me<Math.abs(le);me++)ue.push(le>0?0:1);for(let me=0;me<Math.min(X,Q);me++)ue.push(0),ue.push(1);let ie=N;if(ie=N2(ie,z[0].y-L,z[1].y+L,1),ie=N2(ie,z[0].x-L,z[1].x+L,0),!ie.length)return I;const he=[];for(ue.length?he.push({polygons:ie,bounds:z,depth:0}):$(ie,z);he.length;){const me=he.pop(),we=me.depth,Ie=ue[we],Ne=me.bounds[0],Me=me.bounds[1],Je=Ie===0?Ne.x:Ne.y,Fe=Ie===0?Me.x:Me.y,tt=j?j(Ie,Je,Fe):.5*(Je+Fe),st=N2(me.polygons,Je-L,tt+L,Ie),nt=N2(me.polygons,tt-L,Fe+L,Ie);if(st.length){const lt=[Ne,new Pt(Ie===0?tt:Me.x,Ie===1?tt:Me.y)];ue.length>we+1?he.push({polygons:st,bounds:lt,depth:we+1}):$(st,lt)}if(nt.length){const lt=[new Pt(Ie===0?tt:Ne.x,Ie===1?tt:Ne.y),Me];ue.length>we+1?he.push({polygons:nt,bounds:lt,depth:we+1}):$(nt,lt)}}return I}(h,s,Math.ceil((m-v)/11.25),Math.ceil((x-k)/11.25),1,(N,z,C)=>{if(N===0)return .5*(z+C);{const R=Fr((c.y+z/lr)/p);return(Yo(.5*(Fr((c.y+C/lr)/p)+R))*p-c.y)*lr}})}function Qne(h,s,c,p,v,m){const x=Math.pow(2,p.z-v.z);for(let k=0;k<c;k++){let N=h.int16[2*(k+s)+0],z=h.int16[2*(k+s)+1];N=(N+v.x*lr)*x-p.x*lr,z=(z+v.y*lr)*x-p.y*lr,m.push(new Pt(N,z))}}let uz,dz;function tb(h,s){return h.x*s.x+h.y*s.y}function hz(h,s){if(h.length===1){let c=0;const p=s[c++];let v;for(;!v||p.equals(v);)if(v=s[c++],!v)return 1/0;for(;c<s.length;c++){const m=s[c],x=h[0],k=v.sub(p),N=m.sub(p),z=x.sub(p),C=tb(k,k),R=tb(k,N),L=tb(N,N),j=tb(z,k),I=tb(z,N),$=C*L-R*R,X=(L*j-R*I)/$,Q=(C*I-R*j)/$,le=p.z*(1-X-Q)+v.z*X+m.z*Q;if(isFinite(le))return le}return 1/0}{let c=1/0;for(const p of s)c=Math.min(c,p.z);return c}}function fz(h,s,c,p,v,m,x,k){const N=x*v.getElevationAt(h,s,!0,!0),z=m[0]!==0,C=z?m[1]===0?x*(m[0]/7-450):x*function(R,L,j){const I=Math.floor(L[0]/8),$=Math.floor(L[1]/8),X=10*(L[0]-8*I),Q=10*(L[1]-8*$),le=R.getElevationAt(I,$,!0,!0),ue=R.getMeterToDEM(j),ie=Math.floor(.5*(X*ue-1)),he=Math.floor(.5*(Q*ue-1)),me=R.tileCoordToPixel(I,$),we=2*ie+1,Ie=2*he+1,Ne=function(nt,lt,ft,vt,ct){return[nt.getElevationAtPixel(lt,ft,!0),nt.getElevationAtPixel(lt+ct,ft,!0),nt.getElevationAtPixel(lt,ft+ct,!0),nt.getElevationAtPixel(lt+vt,ft+ct,!0)]}(R,me.x-ie,me.y-he,we,Ie),Me=Math.abs(Ne[0]-Ne[1]),Je=Math.abs(Ne[2]-Ne[3]),Fe=Math.abs(Ne[0]-Ne[2])+Math.abs(Ne[1]-Ne[3]),tt=Math.min(.25,.5*ue*(Me+Je)/we),st=Math.min(.25,.5*ue*Fe/Ie);return le+Math.max(tt*X,st*Q)}(v,m,k):N;return{base:N+(c===0?-1:c),top:z?Math.max(C+p,N+c+2):N+p}}mr(L2,"FillExtrusionBucket",{omit:["layers","features"]}),mr(Q4,"PartData"),mr(J4,"FootprintSegment"),mr(ez,"BorderCentroidData"),mr(rz,"GroundEffect");const eie=Qn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),tie=Qn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:rie}=eie,nie=Qn([{name:"a_packed",components:3,type:"Float32"}]),{members:iie}=nie,aie=Qn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:sie}=aie;class pz{constructor(s,c){this.width=s,this.height=c,this.nextRow=0,this.image=new od({width:s,height:c}),this.positions={},this.uploaded=!1}getDash(s,c){const p=this.getKey(s,c);return this.positions[p]}trim(){const s=this.width,c=this.height=Vs(this.nextRow);this.image.resize({width:s,height:c})}getKey(s,c){return s.join(",")+c}getDashRanges(s,c,p){const v=[];let m=s.length%2==1?-s[s.length-1]*p:0,x=s[0]*p,k=!0;v.push({left:m,right:x,isDash:k,zeroLength:s[0]===0});let N=s[0];for(let z=1;z<s.length;z++){k=!k;const C=s[z];m=N*p,N+=C,x=N*p,v.push({left:m,right:x,isDash:k,zeroLength:C===0})}return v}addRoundDash(s,c,p){const v=c/2;for(let m=-p;m<=p;m++){const x=this.width*(this.nextRow+p+m);let k=0,N=s[k];for(let z=0;z<this.width;z++){z/N.right>1&&(N=s[++k]);const C=Math.abs(z-N.left),R=Math.abs(z-N.right),L=Math.min(C,R);let j;const I=m/p*(v+1);if(N.isDash){const $=v-Math.abs(I);j=Math.sqrt(L*L+$*$)}else j=v-Math.sqrt(L*L+I*I);this.image.data[x+z]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(s,c){for(let N=s.length-1;N>=0;--N){const z=s[N],C=s[N+1];z.zeroLength?s.splice(N,1):C&&C.isDash===z.isDash&&(C.left=z.left,s.splice(N,1))}const p=s[0],v=s[s.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const m=this.width*this.nextRow;let x=0,k=s[x];for(let N=0;N<this.width;N++){N/k.right>1&&(k=s[++x]);const z=Math.abs(N-k.left),C=Math.abs(N-k.right),R=Math.min(z,C);this.image.data[m+N]=Math.max(0,Math.min(255,(k.isDash?R:-R)+c+128))}}addDash(s,c){const p=this.getKey(s,c);if(this.positions[p])return this.positions[p];const v=c==="round",m=v?7:0,x=2*m+1;if(this.nextRow+x>this.height)return an("LineAtlas out of space"),null;s.length===0&&s.push(1);let k=0;for(let C=0;C<s.length;C++)s[C]<0&&(an("Negative value is found in line dasharray, replacing values with 0"),s[C]=0),k+=s[C];if(k!==0){const C=this.width/k,R=this.getDashRanges(s,this.width,C);v?this.addRoundDash(R,C,m):this.addRegularDash(R,c==="square"?.5*C:0)}const N=this.nextRow+m;this.nextRow+=x;const z={tl:[N,m],br:[k,0]};return this.positions[p]=z,z}}mr(pz,"LineAtlas");const oie=k0.VectorTileFeature.types,lie=Math.cos(Math.PI/180*37.5),cie=Math.cos(Math.PI/180*5);class kC{constructor(s){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=s.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=s.overscaling,this.pixelRatio=s.pixelRatio,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new ed,this.layoutVertexArray2=new Wo,this.patternVertexArray=new Wo,this.indexArray=new ms,this.programConfigurations=new ou(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new ya,this.maxLineLength=0,this.zOffsetVertexArray=new Wo,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.tessellationStep=s.tessellationStep?s.tessellationStep:lr/64}updateFootprints(s,c){}populate(s,c,p,v){this.hasPattern=Jr("line",this.layers,this.pixelRatio,c);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=o(p);const x=this.layers[0].layout.get("line-z-offset"),k=x.isConstant()&&!x.constantOr(0),N=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=N==="sea"||N==="ground"||!k&&N==="none",this.hasZOffset&&N==="none"&&an(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const z=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&z!==void 0;const C=[];for(const{feature:I,id:$,index:X,sourceLayerIndex:Q}of s){const le=this.layers[0]._featureFilter.needGeometry,ue=te(I,le);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),ue,p))continue;const ie=m?m.evaluate(ue,{},p):void 0,he={id:$,properties:I.properties,type:I.type,sourceLayerIndex:Q,index:X,geometry:le?ue.geometry:Y(I,p,v),patterns:{},sortKey:ie};C.push(he)}m&&C.sort((I,$)=>I.sortKey-$.sortKey);const{lineAtlas:R,featureIndex:L}=c,j=this.addConstantDashes(R);for(const I of C){const{geometry:$,index:X,sourceLayerIndex:Q}=I;if(j&&this.addFeatureDashes(I,R),this.hasPattern){const le=ln("line",this.layers,I,this.zoom,this.pixelRatio,c);this.patternFeatures.push(le)}else this.addFeature(I,$,X,p,R.positions,c.availableImages,c.brightness);L.insert(s[X].feature,$,X,Q,this.index)}}addConstantDashes(s){let c=!1;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,m=p.layout.get("line-cap").value;if(v.kind!=="constant"||m.kind!=="constant")c=!0;else{const x=m.value,k=v.value;if(!k)continue;s.addDash(k,x)}}return c}addFeatureDashes(s,c){const p=this.zoom;for(const v of this.layers){const m=v.paint.get("line-dasharray").value,x=v.layout.get("line-cap").value;if(m.kind==="constant"&&x.kind==="constant")continue;let k,N;if(m.kind==="constant"){if(k=m.value,!k)continue}else k=m.evaluate({zoom:p},s);N=x.kind==="constant"?x.value:x.evaluate({zoom:p},s),c.addDash(k,N),s.patterns[v.id]=c.getKey(k,N)}}update(s,c,p,v,m,x,k){this.programConfigurations.updatePaintArrays(s,c,m,p,v,x,k)}addFeatures(s,c,p,v,m,x){for(const k of this.patternFeatures)this.addFeature(k,k.geometry,k.index,c,p,v,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,iie)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=s.createVertexBuffer(this.patternVertexArray,sie)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,tie.members,!0)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,rie),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,c,p,v,m,x,k){const N=this.layers[0].layout,z=N.get("line-join").evaluate(s,{}),C=N.get("line-cap").evaluate(s,{}),R=N.get("line-miter-limit"),L=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(s),this.lineFeature=s,this.zOffsetValue=N.get("line-z-offset").value;const j=this.layers[0].paint.get("line-width").value;j.kind!=="constant"&&j.isLineProgressConstant===!1&&(this.variableWidthValue=j);for(const I of c)this.addLine(I,s,v,z,C,R,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,x,v,k)}addLine(s,c,p,v,m,x,k){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const N=v==="none";if(this.patternJoinNone=this.hasPattern&&N,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<s.length-1;ue++)this.totalDistance+=s[ue].dist(s[ue+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const z=oie[c.type]==="Polygon";let C=s.length;for(;C>=2&&s[C-1].equals(s[C-2]);)C--;let R=0;for(;R<C-1&&s[R].equals(s[R+1]);)R++;if(C<(z?3:2))return;v==="bevel"&&(x=1.05);const L=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let j,I,$,X,Q,le;this.e1=this.e2=-1,z&&(j=s[C-2],Q=s[R].sub(j)._unit()._perp());for(let ue=R;ue<C;ue++){if($=ue===C-1?z?s[R+1]:void 0:s[ue+1],$&&s[ue].equals($))continue;Q&&(X=Q),j&&(I=j),j=s[ue],le=this.evaluateLineProgressFeatures(I?I.dist(j):0),Q=$?$.sub(j)._unit()._perp():X,X=X||Q;const ie=I&&$;let he=ie?v:z||N?"butt":m;const me=X.x*Q.x+X.y*Q.y;if(N){const st=function(nt){if(nt.patternJoinNone){const lt=nt.segmentPoints.length/2,ft=nt.lineSoFar-nt.segmentStart;for(let vt=0;vt<lt;++vt){const ct=nt.segmentPoints[2*vt+1],Rt=Math.round(nt.segmentPoints[2*vt])+.5+.25*ct;nt.patternVertexArray.emplaceBack(Rt,ft,nt.segmentStart),nt.patternVertexArray.emplaceBack(Rt,ft,nt.segmentStart)}nt.segmentPoints.length=0}nt.e1=nt.e2=-1};if(ie&&me<cie){this.updateDistance(I,j),this.addCurrentVertex(j,X,1,1,L,le),st(this),this.addCurrentVertex(j,Q,-1,-1,L,le);continue}if(I){if(!$){this.updateDistance(I,j),this.addCurrentVertex(j,X,1,1,L,le),st(this);continue}he="miter"}}let we=X.add(Q);we.x===0&&we.y===0||we._unit();const Ie=we.x*Q.x+we.y*Q.y,Ne=Ie!==0?1/Ie:1/0,Me=2*Math.sqrt(2-2*Ie),Je=Ie<lie&&I&&$,Fe=X.x*Q.y-X.y*Q.x>0,tt=this.overscaling<=16?15*lr/(512*this.overscaling):0;if(ie&&he==="round"){if(Ne<k)he="miter";else if(Ne<=2){const st=MC(j,-10,lr+10);he=this.hasZOffset&&(st||this.hasCrossSlope)?"miter":"fakeround"}}if(he==="miter"&&Ne>x&&(he="bevel"),he==="bevel"&&(Ne>2&&(he="flipbevel"),Ne<x&&(he="miter")),I&&!(he==="miter"&&Je)&&this.updateDistance(I,j),he==="miter")if(Je){const st=j.dist(I);if(st>2*tt){const lt=j.sub(j.sub(I)._mult(tt/st)._round());this.updateDistance(I,lt),this.addCurrentVertex(lt,X,0,0,L,le),I=lt}this.updateDistance(I,j),we._mult(Ne),this.addCurrentVertex(j,we,0,0,L,le);const nt=j.dist($);if(nt>2*tt){const lt=j.add($.sub(j)._mult(tt/nt)._round());this.updateDistance(j,lt),this.addCurrentVertex(lt,Q,0,0,L,le),j=lt}}else we._mult(Ne),this.addCurrentVertex(j,we,0,0,L,le);else if(he==="flipbevel"){if(Ne>100)we=Q.mult(-1);else{const st=Ne*X.add(Q).mag()/X.sub(Q).mag();we._perp()._mult(st*(Fe?-1:1))}this.addCurrentVertex(j,we,0,0,L,le),this.addCurrentVertex(j,we.mult(-1),0,0,L,le)}else if(he==="bevel"||he==="fakeround"){le!=null&&I&&this.addCurrentVertex(j,X,-1,-1,L,le);const st=j.dist(I)<=2*tt&&he!=="bevel",nt=we.mult(Fe?1:-1);nt._mult(Ne);const lt=Q.mult(Fe?-1:1),ft=X.mult(Fe?-1:1),vt=this.evaluateLineProgressFeatures(this.distance);if(le==null&&(this.addHalfVertex(j,nt.x,nt.y,!1,!Fe,0,L,vt),st||this.addHalfVertex(j,nt.x+2*ft.x,nt.y+2*ft.y,!1,Fe,0,L,vt)),he==="fakeround"){const ct=Math.round(180*Me/Math.PI/20);this.addHalfVertex(j,ft.x,ft.y,!1,Fe,0,L,vt);for(let Rt=0;Rt<ct;Rt++){let $t=Rt/ct;if($t!==.5){const hr=$t-.5;$t+=$t*hr*($t-1)*((1.0904+me*(me*(3.55645-1.43519*me)-3.2452))*hr*hr+(.848013+me*(.215638*me-1.06021)))}const Nt=lt.sub(ft)._mult($t)._add(ft)._unit();this.addHalfVertex(j,Nt.x,Nt.y,!1,Fe,0,L,vt)}this.addHalfVertex(j,lt.x,lt.y,!1,Fe,0,L,vt)}st||le!=null||this.addHalfVertex(j,nt.x+2*lt.x,nt.y+2*lt.y,!1,Fe,0,L,vt),le!=null&&$&&this.addCurrentVertex(j,Q,1,1,L,le)}else he==="butt"?this.addCurrentVertex(j,we,0,0,L,le):he==="square"?(I||this.addCurrentVertex(j,we,-1,-1,L,le),this.addCurrentVertex(j,we,0,0,L,le),I&&this.addCurrentVertex(j,we,1,1,L,le)):he==="round"&&(I&&(this.addCurrentVertex(j,X,0,0,L,le),this.addCurrentVertex(j,X,1,1,L,le,!0)),$&&(this.addCurrentVertex(j,Q,-1,-1,L,le,!0),this.addCurrentVertex(j,Q,0,0,L,le)))}}addVerticesTo(s,c,p,v,m,x,k,N,z,C){const R=(c.w-s.w)/this.tessellationStep|0;let L=0;const j=this.scaledDistance;if(R>1){this.lineSoFar=s.w;const $=(c.x-s.x)/R,X=(c.y-s.y)/R,Q=(c.z-s.z)/R,le=(c.w-s.w)/R;for(let ue=1;ue<R;++ue){s.x+=$,s.y+=X,s.z+=Q,this.lineSoFar+=le,L+=le;const ie=this.evaluateLineProgressFeatures(this.prevDistance+L);this.scaledDistance=(this.prevDistance+L)/this.totalDistance,this.addHalfVertex(s,p,v,C,!1,k,z,ie),this.addHalfVertex(s,m,x,C,!0,-N,z,ie)}}this.lineSoFar=c.w,this.scaledDistance=j;const I=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(c,p,v,C,!1,k,z,I),this.addHalfVertex(c,m,x,C,!0,-N,z,I)}evaluateLineProgressFeatures(s){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+s)/this.totalFeatureLength):an(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let c=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(c=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:c}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:c}:{zOffset:0,variableWidth:c}}addCurrentVertex(s,c,p,v,m,x,k=!1){const N=c.x+c.y*p,z=c.y-c.x*p,C=c.y*v-c.x,R=-c.y-c.x*v;if(x!=null){const L=this.hasZOffset,j=-10,I=lr+10,$=x.zOffset,X=new B4(s.x,s.y,$,this.lineSoFar),Q=!!L&&MC(s,j,I),le=this.lineSoFar,ue=this.distance;if(this.currentVertex)if(Q){const ie=this.currentVertexIsOutside,he=this.currentVertex,me=new B4(s.x,s.y,$,this.lineSoFar);if(U4(he,me,j,I),!MC(me,j,I)){if(ie){this.e1=this.e2=-1,this.distance-=he.dist(X),this.lineSoFar=he.w;const we=this.evaluateLineProgressFeatures(he.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(he,N,z,k,!1,p,m,we),this.addHalfVertex(he,C,R,k,!0,-v,m,we),this.prevDistance=this.distance}this.distance=this.prevDistance+he.dist(me),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(he,me,N,z,C,R,p,v,m,k),this.distance=ue,this.scaledDistance=this.distance/this.totalDistance}}else{const ie=this.currentVertex;if(this.currentVertexIsOutside){U4(ie,X,j,I),this.e1=this.e2=-1,this.distance-=ie.dist(X),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ie.w;const he=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,N,z,k,!1,p,m,he),this.addHalfVertex(ie,C,R,k,!0,-v,m,he),this.prevDistance=this.distance,this.distance=ue,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ie,X,N,z,C,R,p,v,m,k)}else Q||(this.addHalfVertex(s,N,z,k,!1,p,m,x),this.addHalfVertex(s,C,R,k,!0,-v,m,x));this.currentVertex=X,this.currentVertexIsOutside=Q,this.lineSoFar=le}else this.addHalfVertex(s,N,z,k,!1,p,m,x),this.addHalfVertex(s,C,R,k,!0,-v,m,x)}addHalfVertex({x:s,y:c},p,v,m,x,k,N,z){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),x||this.segmentPoints.push(this.lineSoFar-this.segmentStart,k)),this.layoutVertexArray.emplaceBack((s<<1)+(m?1:0),(c<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(k===0?0:k<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const R=Lr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,R)}const C=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),N.primitiveLength++),x?this.e2=C:this.e1=C,z!=null&&this.zOffsetVertexArray.emplaceBack(z.zOffset,z.variableWidth,z.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(s,c){this.prevDistance=this.distance,this.distance+=s.dist(c),this.updateScaledDistance()}}function MC(h,s,c){return h.x<s||h.x>c||h.y<s||h.y>c}let mz,gz;function yz(h,s,c){return s*(lr/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}mr(kC,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const vz=(h,s,c)=>(1-c)*h+c*s;function xz(h,s){return 1/yz(h,1,s.tileZoom)}function _z(h,s,c,p){return h.translatePosMatrix(p||s.tileID.projMatrix,s,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const bz=h=>{const s=[];wz(h)&&s.push("RENDER_LINE_DASH"),h.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT");const c=h.paint.get("line-trim-offset");c[0]===0&&c[1]===0||s.push("RENDER_LINE_TRIM_OFFSET"),h.paint.get("line-border-width").constantOr(1)!==0&&s.push("RENDER_LINE_BORDER");const p=h.layout.get("line-join").constantOr("miter")==="none",v=!!h.paint.get("line-pattern").constantOr(1);return p&&v&&s.push("LINE_JOIN_NONE"),s};function wz(h){const s=h.paint.get("line-dasharray").value;return s.value||s.kind!=="constant"}let jC;const Sz=()=>jC||(jC={layout:mz||(mz=new $i({"line-cap":new ur(xt.layout_line["line-cap"]),"line-join":new ur(xt.layout_line["line-join"]),"line-miter-limit":new Xt(xt.layout_line["line-miter-limit"]),"line-round-limit":new Xt(xt.layout_line["line-round-limit"]),"line-sort-key":new ur(xt.layout_line["line-sort-key"]),"line-z-offset":new ur(xt.layout_line["line-z-offset"]),"line-elevation-reference":new Xt(xt.layout_line["line-elevation-reference"]),"line-cross-slope":new Xt(xt.layout_line["line-cross-slope"]),visibility:new Xt(xt.layout_line.visibility),"line-width-unit":new Xt(xt.layout_line["line-width-unit"])})),paint:gz||(gz=new $i({"line-opacity":new ur(xt.paint_line["line-opacity"]),"line-color":new ur(xt.paint_line["line-color"]),"line-translate":new Xt(xt.paint_line["line-translate"]),"line-translate-anchor":new Xt(xt.paint_line["line-translate-anchor"]),"line-width":new ur(xt.paint_line["line-width"]),"line-gap-width":new ur(xt.paint_line["line-gap-width"]),"line-offset":new ur(xt.paint_line["line-offset"]),"line-blur":new ur(xt.paint_line["line-blur"]),"line-dasharray":new ur(xt.paint_line["line-dasharray"]),"line-pattern":new ur(xt.paint_line["line-pattern"]),"line-gradient":new jl(xt.paint_line["line-gradient"]),"line-trim-offset":new Xt(xt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Xt(xt.paint_line["line-trim-fade-range"]),"line-trim-color":new Xt(xt.paint_line["line-trim-color"]),"line-emissive-strength":new Xt(xt.paint_line["line-emissive-strength"]),"line-border-width":new ur(xt.paint_line["line-border-width"]),"line-border-color":new ur(xt.paint_line["line-border-color"]),"line-occlusion-opacity":new Xt(xt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},jC);class uie extends ur{possiblyEvaluate(s,c){return c=new xi(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,transition:c.transition}),super.possiblyEvaluate(s,c)}evaluate(s,c,p,v){return c=Vi({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(s,c,p,v)}}let rb;function Az(h,s){return s>0?s+2*h:h}const die=Qn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hie=Qn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),fie=Qn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Qn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const pie=Qn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),mie=Qn([{name:"a_texb",components:2,type:"Uint16"}]),gie=Qn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),yie=Qn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Qn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Tz=Qn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),vie=Qn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Qn([{name:"triangle",components:3,type:"Uint16"}]),Qn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Qn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Qn([{type:"Float32",name:"offsetX"}]),Qn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Eo=24;const fh=128;function OC(h,s,c,p,v){if(h.kind==="camera")return h.maxSize;if(h.kind==="composite"){const m=s.possiblyEvaluate(new xi(h.maxZoom),c).evaluate(v,{},c),x=s.possiblyEvaluate(new xi(h.minZoom),c).evaluate(v,{},c);return Math.max(m,x)}return s.possiblyEvaluate(new xi(p)).evaluate(v,{},c)}function NC(h,s){const{expression:c}=s;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new xi(h+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=c;let m=0;for(;m<p.length&&p[m]<=h;)m++;m=Math.max(0,m-1);let x=m;for(;x<p.length&&p[x]<h+1;)x++;x=Math.min(p.length-1,x);const k=p[m],N=p[x];return c.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:N,interpolationType:v}:{kind:"camera",minZoom:k,maxZoom:N,minSize:c.evaluate(new xi(k)),maxSize:c.evaluate(new xi(N)),interpolationType:v}}}function z2(h,{uSize:s,uSizeT:c},{lowerSize:p,upperSize:v}){return h.kind==="source"?p/fh:h.kind==="composite"?Lr(p/fh,v/fh,c):s}function M0(h,s,c=1){let p=0,v=0;if(h.kind==="constant")v=h.layoutSize*c;else if(h.kind!=="source"){const{interpolationType:m,minZoom:x,maxZoom:k}=h,N=m?ar(Ps.interpolationFactor(m,s,x,k),0,1):0;h.kind==="camera"?v=Lr(h.minSize,h.maxSize,N)*c:p=N*c}return{uSizeT:p,uSize:v}}var xie=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:fh,evaluateSizeForFeature:z2,evaluateSizeForZoom:M0,getRasterizedIconSize:OC,getSizeData:NC});function _ie(h,s,c){return h.sections.forEach(p=>{p.text=function(v,m,x){const k=m.layout.get("text-transform").evaluate(x,{});return k==="uppercase"?v=v.toLocaleUpperCase():k==="lowercase"&&(v=v.toLocaleLowerCase()),Go.applyArabicShaping&&(v=Go.applyArabicShaping(v)),v}(p.text,s,c)}),h}const nb={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function bie(h){return h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""}function wie(h){return h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""||h===""}var Pz,RC,Cz,IC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Sie(){return Pz||(Pz=1,IC.read=function(h,s,c,p,v){var m,x,k=8*v-p-1,N=(1<<k)-1,z=N>>1,C=-7,R=c?v-1:0,L=c?-1:1,j=h[s+R];for(R+=L,m=j&(1<<-C)-1,j>>=-C,C+=k;C>0;m=256*m+h[s+R],R+=L,C-=8);for(x=m&(1<<-C)-1,m>>=-C,C+=p;C>0;x=256*x+h[s+R],R+=L,C-=8);if(m===0)m=1-z;else{if(m===N)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,p),m-=z}return(j?-1:1)*x*Math.pow(2,m-p)},IC.write=function(h,s,c,p,v,m){var x,k,N,z=8*m-v-1,C=(1<<z)-1,R=C>>1,L=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=p?0:m-1,I=p?1:-1,$=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(k=isNaN(s)?1:0,x=C):(x=Math.floor(Math.log(s)/Math.LN2),s*(N=Math.pow(2,-x))<1&&(x--,N*=2),(s+=x+R>=1?L/N:L*Math.pow(2,1-R))*N>=2&&(x++,N/=2),x+R>=C?(k=0,x=C):x+R>=1?(k=(s*N-1)*Math.pow(2,v),x+=R):(k=s*Math.pow(2,R-1)*Math.pow(2,v),x=0));v>=8;h[c+j]=255&k,j+=I,k/=256,v-=8);for(x=x<<v|k,z+=v;z>0;h[c+j]=255&x,j+=I,x/=256,z-=8);h[c+j-I]|=128*$}),IC}function Ez(){if(Cz)return RC;Cz=1,RC=s;var h=Sie();function s(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}s.Varint=0,s.Fixed64=1,s.Bytes=2,s.Fixed32=5;var c=4294967296,p=1/c,v=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ie){return ie.type===s.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function x(ie,he,me){return me?4294967296*he+(ie>>>0):4294967296*(he>>>0)+(ie>>>0)}function k(ie,he,me){var we=he<=16383?1:he<=2097151?2:he<=268435455?3:Math.floor(Math.log(he)/(7*Math.LN2));me.realloc(we);for(var Ie=me.pos-1;Ie>=ie;Ie--)me.buf[Ie+we]=me.buf[Ie]}function N(ie,he){for(var me=0;me<ie.length;me++)he.writeVarint(ie[me])}function z(ie,he){for(var me=0;me<ie.length;me++)he.writeSVarint(ie[me])}function C(ie,he){for(var me=0;me<ie.length;me++)he.writeFloat(ie[me])}function R(ie,he){for(var me=0;me<ie.length;me++)he.writeDouble(ie[me])}function L(ie,he){for(var me=0;me<ie.length;me++)he.writeBoolean(ie[me])}function j(ie,he){for(var me=0;me<ie.length;me++)he.writeFixed32(ie[me])}function I(ie,he){for(var me=0;me<ie.length;me++)he.writeSFixed32(ie[me])}function $(ie,he){for(var me=0;me<ie.length;me++)he.writeFixed64(ie[me])}function X(ie,he){for(var me=0;me<ie.length;me++)he.writeSFixed64(ie[me])}function Q(ie,he){return(ie[he]|ie[he+1]<<8|ie[he+2]<<16)+16777216*ie[he+3]}function le(ie,he,me){ie[me]=he,ie[me+1]=he>>>8,ie[me+2]=he>>>16,ie[me+3]=he>>>24}function ue(ie,he){return(ie[he]|ie[he+1]<<8|ie[he+2]<<16)+(ie[he+3]<<24)}return s.prototype={destroy:function(){this.buf=null},readFields:function(ie,he,me){for(me=me||this.length;this.pos<me;){var we=this.readVarint(),Ie=we>>3,Ne=this.pos;this.type=7&we,ie(Ie,he,this),this.pos===Ne&&this.skip(we)}return he},readMessage:function(ie,he){return this.readFields(ie,he,this.readVarint()+this.pos)},readFixed32:function(){var ie=Q(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=ue(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=Q(this.buf,this.pos)+Q(this.buf,this.pos+4)*c;return this.pos+=8,ie},readSFixed64:function(){var ie=Q(this.buf,this.pos)+ue(this.buf,this.pos+4)*c;return this.pos+=8,ie},readFloat:function(){var ie=h.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=h.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var he,me,we=this.buf;return he=127&(me=we[this.pos++]),me<128?he:(he|=(127&(me=we[this.pos++]))<<7,me<128?he:(he|=(127&(me=we[this.pos++]))<<14,me<128?he:(he|=(127&(me=we[this.pos++]))<<21,me<128?he:function(Ie,Ne,Me){var Je,Fe,tt=Me.buf;if(Je=(112&(Fe=tt[Me.pos++]))>>4,Fe<128||(Je|=(127&(Fe=tt[Me.pos++]))<<3,Fe<128)||(Je|=(127&(Fe=tt[Me.pos++]))<<10,Fe<128)||(Je|=(127&(Fe=tt[Me.pos++]))<<17,Fe<128)||(Je|=(127&(Fe=tt[Me.pos++]))<<24,Fe<128)||(Je|=(1&(Fe=tt[Me.pos++]))<<31,Fe<128))return x(Ie,Je,Ne);throw new Error("Expected varint not more than 10 bytes")}(he|=(15&(me=we[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,he=this.pos;return this.pos=ie,ie-he>=12&&v?function(me,we,Ie){return v.decode(me.subarray(we,Ie))}(this.buf,he,ie):function(me,we,Ie){for(var Ne="",Me=we;Me<Ie;){var Je,Fe,tt,st=me[Me],nt=null,lt=st>239?4:st>223?3:st>191?2:1;if(Me+lt>Ie)break;lt===1?st<128&&(nt=st):lt===2?(192&(Je=me[Me+1]))==128&&(nt=(31&st)<<6|63&Je)<=127&&(nt=null):lt===3?(Fe=me[Me+2],(192&(Je=me[Me+1]))==128&&(192&Fe)==128&&((nt=(15&st)<<12|(63&Je)<<6|63&Fe)<=2047||nt>=55296&&nt<=57343)&&(nt=null)):lt===4&&(Fe=me[Me+2],tt=me[Me+3],(192&(Je=me[Me+1]))==128&&(192&Fe)==128&&(192&tt)==128&&((nt=(15&st)<<18|(63&Je)<<12|(63&Fe)<<6|63&tt)<=65535||nt>=1114112)&&(nt=null)),nt===null?(nt=65533,lt=1):nt>65535&&(nt-=65536,Ne+=String.fromCharCode(nt>>>10&1023|55296),nt=56320|1023&nt),Ne+=String.fromCharCode(nt),Me+=lt}return Ne}(this.buf,he,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,he=this.buf.subarray(this.pos,ie);return this.pos=ie,he},readPackedVarint:function(ie,he){if(this.type!==s.Bytes)return ie.push(this.readVarint(he));var me=m(this);for(ie=ie||[];this.pos<me;)ie.push(this.readVarint(he));return ie},readPackedSVarint:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSVarint());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==s.Bytes)return ie.push(this.readBoolean());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFloat());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==s.Bytes)return ie.push(this.readDouble());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFixed32());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSFixed32());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFixed64());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSFixed64());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readSFixed64());return ie},skip:function(ie){var he=7&ie;if(he===s.Varint)for(;this.buf[this.pos++]>127;);else if(he===s.Bytes)this.pos=this.readVarint()+this.pos;else if(he===s.Fixed32)this.pos+=4;else{if(he!==s.Fixed64)throw new Error("Unimplemented type: "+he);this.pos+=8}},writeTag:function(ie,he){this.writeVarint(ie<<3|he)},realloc:function(ie){for(var he=this.length||16;he<this.pos+ie;)he*=2;if(he!==this.length){var me=new Uint8Array(he);me.set(this.buf),this.buf=me,this.length=he}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),le(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),le(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),le(this.buf,-1&ie,this.pos),le(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),le(this.buf,-1&ie,this.pos),le(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(he,me){var we,Ie;if(he>=0?(we=he%4294967296|0,Ie=he/4294967296|0):(Ie=~(-he/4294967296),4294967295^(we=~(-he%4294967296))?we=we+1|0:(we=0,Ie=Ie+1|0)),he>=18446744073709552e3||he<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");me.realloc(10),function(Ne,Me,Je){Je.buf[Je.pos++]=127&Ne|128,Ne>>>=7,Je.buf[Je.pos++]=127&Ne|128,Ne>>>=7,Je.buf[Je.pos++]=127&Ne|128,Ne>>>=7,Je.buf[Je.pos++]=127&Ne|128,Je.buf[Je.pos]=127&(Ne>>>=7)}(we,0,me),function(Ne,Me){var Je=(7&Ne)<<4;Me.buf[Me.pos++]|=Je|((Ne>>>=3)?128:0),Ne&&(Me.buf[Me.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Me.buf[Me.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Me.buf[Me.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Me.buf[Me.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Me.buf[Me.pos++]=127&Ne)))))}(Ie,me)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var he=this.pos;this.pos=function(we,Ie,Ne){for(var Me,Je,Fe=0;Fe<Ie.length;Fe++){if((Me=Ie.charCodeAt(Fe))>55295&&Me<57344){if(!Je){Me>56319||Fe+1===Ie.length?(we[Ne++]=239,we[Ne++]=191,we[Ne++]=189):Je=Me;continue}if(Me<56320){we[Ne++]=239,we[Ne++]=191,we[Ne++]=189,Je=Me;continue}Me=Je-55296<<10|Me-56320|65536,Je=null}else Je&&(we[Ne++]=239,we[Ne++]=191,we[Ne++]=189,Je=null);Me<128?we[Ne++]=Me:(Me<2048?we[Ne++]=Me>>6|192:(Me<65536?we[Ne++]=Me>>12|224:(we[Ne++]=Me>>18|240,we[Ne++]=Me>>12&63|128),we[Ne++]=Me>>6&63|128),we[Ne++]=63&Me|128)}return Ne}(this.buf,ie,this.pos);var me=this.pos-he;me>=128&&k(he,me,this),this.pos=he-1,this.writeVarint(me),this.pos+=me},writeFloat:function(ie){this.realloc(4),h.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),h.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var he=ie.length;this.writeVarint(he),this.realloc(he);for(var me=0;me<he;me++)this.buf[this.pos++]=ie[me]},writeRawMessage:function(ie,he){this.pos++;var me=this.pos;ie(he,this);var we=this.pos-me;we>=128&&k(me,we,this),this.pos=me-1,this.writeVarint(we),this.pos+=we},writeMessage:function(ie,he,me){this.writeTag(ie,s.Bytes),this.writeRawMessage(he,me)},writePackedVarint:function(ie,he){he.length&&this.writeMessage(ie,N,he)},writePackedSVarint:function(ie,he){he.length&&this.writeMessage(ie,z,he)},writePackedBoolean:function(ie,he){he.length&&this.writeMessage(ie,L,he)},writePackedFloat:function(ie,he){he.length&&this.writeMessage(ie,C,he)},writePackedDouble:function(ie,he){he.length&&this.writeMessage(ie,R,he)},writePackedFixed32:function(ie,he){he.length&&this.writeMessage(ie,j,he)},writePackedSFixed32:function(ie,he){he.length&&this.writeMessage(ie,I,he)},writePackedFixed64:function(ie,he){he.length&&this.writeMessage(ie,$,he)},writePackedSFixed64:function(ie,he){he.length&&this.writeMessage(ie,X,he)},writeBytesField:function(ie,he){this.writeTag(ie,s.Bytes),this.writeBytes(he)},writeFixed32Field:function(ie,he){this.writeTag(ie,s.Fixed32),this.writeFixed32(he)},writeSFixed32Field:function(ie,he){this.writeTag(ie,s.Fixed32),this.writeSFixed32(he)},writeFixed64Field:function(ie,he){this.writeTag(ie,s.Fixed64),this.writeFixed64(he)},writeSFixed64Field:function(ie,he){this.writeTag(ie,s.Fixed64),this.writeSFixed64(he)},writeVarintField:function(ie,he){this.writeTag(ie,s.Varint),this.writeVarint(he)},writeSVarintField:function(ie,he){this.writeTag(ie,s.Varint),this.writeSVarint(he)},writeStringField:function(ie,he){this.writeTag(ie,s.Bytes),this.writeString(he)},writeFloatField:function(ie,he){this.writeTag(ie,s.Fixed32),this.writeFloat(he)},writeDoubleField:function(ie,he){this.writeTag(ie,s.Fixed64),this.writeDouble(he)},writeBooleanField:function(ie,he){this.writeVarintField(ie,!!he)}},RC}var F2=_(Ez());const DC=3;function Aie(h,s,c){s.glyphs=[],h===1&&c.readMessage(Tie,s)}function Tie(h,s,c){if(h===3){const{id:p,bitmap:v,width:m,height:x,left:k,top:N,advance:z}=c.readMessage(Pie,{});s.glyphs.push({id:p,bitmap:new od({width:m+2*DC,height:x+2*DC},v),metrics:{width:m,height:x,left:k,top:N,advance:z}})}else h===4?s.ascender=c.readSVarint():h===5&&(s.descender=c.readSVarint())}function Pie(h,s,c){h===1?s.id=c.readVarint():h===2?s.bitmap=c.readBytes():h===3?s.width=c.readVarint():h===4?s.height=c.readVarint():h===5?s.left=c.readSVarint():h===6?s.top=c.readSVarint():h===7&&(s.advance=c.readVarint())}const Cie=DC,cu={horizontal:1,vertical:2,horizontalOnly:3};class ib{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(s,c){const p=new ib;return p.scale=s||1,p.fontStack=c,p}static forImage(s){const c=new ib;return c.image=s,c}}class j0{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,c){const p=new j0;for(let v=0;v<s.sections.length;v++){const m=s.sections[v];m.image?p.addImageSection(m):p.addTextSection(m,c)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCodePoint(s){return this.text.codePointAt(s)}verticalizePunctuation(s){this.text=function(c,p){let v="";for(let m=0;m<c.length;m++){const x=c.charCodeAt(m+1)||null,k=c.charCodeAt(m-1)||null;v+=!p&&(x&&ga(x)&&!nb[c[m+1]]||k&&ga(k)&&!nb[c[m-1]])||!nb[c[m]]?c[m]:nb[c[m]]}return v}(this.text,s)}trim(){let s=0;for(let p=0;p<this.text.length&&B2[this.text.charCodeAt(p)];p++)s++;let c=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&B2[this.text.charCodeAt(p)];p--)c--;this.text=this.text.substring(s,c),this.sectionIndex=this.sectionIndex.slice(s,c)}substring(s,c){const p=new j0;return p.text=this.text.substring(s,c),p.sectionIndex=this.sectionIndex.slice(s,c),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,c)=>Math.max(s,this.sections[c].scale),0)}addTextSection(s,c){this.text+=s.text,this.sections.push(ib.forText(s.scale,s.fontStack||c));const p=this.sections.length-1;for(let v=0;v<s.text.length;++v)this.sectionIndex.push(p)}addImageSection(s){const c=s.image&&s.image.namePrimary?s.image.getPrimary():null;if(!c)return void an("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(ib.forImage(c)),this.sectionIndex.push(this.sections.length-1)):an("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function LC(h,s,c,p,v,m,x,k,N,z,C,R,L,j,I){const $=j0.fromFeature(h,v);R===cu.vertical&&$.verticalizePunctuation(L);let X=[];const Q=function(me,we,Ie,Ne,Me,Je){if(!me)return[];const Fe=[],tt=function(ft,vt,ct,Rt,$t,Nt){let hr=0;for(let or=0;or<ft.length();or++){const Jt=ft.getSection(or);hr+=kz(ft.getCodePoint(or),Jt,Rt,$t,vt,Nt)}return hr/Math.max(1,Math.ceil(hr/ct))}(me,we,Ie,Ne,Me,Je),st=me.text.indexOf("")>=0;let nt=0;for(let ft=0;ft<me.length();ft++){const vt=me.getSection(ft),ct=me.getCodePoint(ft);if(B2[ct]||(nt+=kz(ct,vt,Ne,Me,we,Je)),ft<me.length()-1){const Rt=!((lt=ct)<11904||!(kr["Bopomofo Extended"](lt)||kr.Bopomofo(lt)||kr["CJK Compatibility Forms"](lt)||kr["CJK Compatibility Ideographs"](lt)||kr["CJK Compatibility"](lt)||kr["CJK Radicals Supplement"](lt)||kr["CJK Strokes"](lt)||kr["CJK Symbols and Punctuation"](lt)||kr["CJK Unified Ideographs Extension A"](lt)||kr["CJK Unified Ideographs"](lt)||kr["Enclosed CJK Letters and Months"](lt)||kr["Halfwidth and Fullwidth Forms"](lt)||kr.Hiragana(lt)||kr["Ideographic Description Characters"](lt)||kr["Kangxi Radicals"](lt)||kr["Katakana Phonetic Extensions"](lt)||kr.Katakana(lt)||kr["Vertical Forms"](lt)||kr["Yi Radicals"](lt)||kr["Yi Syllables"](lt)));(Eie[ct]||Rt||vt.image)&&Fe.push(jz(ft+1,nt,tt,Fe,kie(ct,me.getCodePoint(ft+1),Rt&&st),!1))}}var lt;return Oz(jz(me.length(),nt,tt,Fe,0,!0))}($,z,m,s,p,j),{processBidirectionalText:le,processStyledBidirectionalText:ue}=Go;if(le&&$.sections.length===1){const me=le($.toString(),Q);for(const we of me){const Ie=new j0;Ie.text=we,Ie.sections=$.sections;for(let Ne=0;Ne<we.length;Ne++)Ie.sectionIndex.push(0);X.push(Ie)}}else if(ue){const me=ue($.text,$.sectionIndex,Q);for(const we of me){const Ie=new j0;Ie.text=we[0],Ie.sectionIndex=we[1],Ie.sections=$.sections,X.push(Ie)}}else X=function(me,we){const Ie=[],Ne=me.text;let Me=0;for(const Je of we)Ie.push(me.substring(Me,Je)),Me=Je;return Me<Ne.length&&Ie.push(me.substring(Me,Ne.length)),Ie}($,Q);const ie=[],he={positionedLines:ie,text:$.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:R,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(me,we,Ie,Ne,Me,Je,Fe,tt,st,nt,lt,ft){let vt=0,ct=0,Rt=0;const $t=tt==="right"?1:tt==="left"?0:.5;let Nt=!1;for(const yr of Me){const br=yr.getSections();for(const Qr of br){if(Qr.image)continue;const pn=we[Qr.fontStack];if(pn&&(Nt=pn.ascender!==void 0&&pn.descender!==void 0,!Nt))break}if(!Nt)break}let hr=0;for(const yr of Me){yr.trim();const br=yr.getMaxScale(),Qr=(br-1)*Eo,pn={positionedGlyphs:[],lineOffset:0};me.positionedLines[hr]=pn;const vn=pn.positionedGlyphs;let xn=0;if(!yr.length()){ct+=Je,++hr;continue}let jn=0,In=0;for(let Ti=0;Ti<yr.length();Ti++){const cn=yr.getSection(Ti),yi=yr.getSectionIndex(Ti),bi=yr.getCodePoint(Ti);let Zi=cn.scale,Ia=null,ss=null,Da=null,wa=Eo,Ga=0;const vs=!(st===cu.horizontal||!lt&&!oo(bi)||lt&&(B2[bi]||(or=bi,kr.Arabic(or)||kr["Arabic Supplement"](or)||kr["Arabic Extended-A"](or)||kr["Arabic Presentation Forms-A"](or)||kr["Arabic Presentation Forms-B"](or))));if(cn.image){const ko=Ne[cn.image.serialize()];if(!ko)continue;Da=cn.image.id,me.iconsInText=me.iconsInText||!0,ss=ko.paddedRect;const Wi=ko.displaySize;Zi=Zi*Eo/ft,Ia={width:Wi[0],height:Wi[1],left:0,top:-3,advance:vs?Wi[1]:Wi[0],localGlyph:!1},Ga=Nt?-Ia.height*Zi:br*Eo-17-Wi[1]*Zi,wa=Ia.advance;const ec=(vs?Wi[0]:Wi[1])*Zi-Eo*br;ec>0&&ec>xn&&(xn=ec)}else{const ko=Ie[cn.fontStack];if(!ko)continue;ko[bi]&&(ss=ko[bi]);const Wi=we[cn.fontStack];if(!Wi)continue;const ec=Wi.glyphs[bi];if(!ec)continue;if(Ia=ec.metrics,wa=bi!==8203?Eo:0,Nt){const vh=Wi.ascender!==void 0?Math.abs(Wi.ascender):0,cd=Wi.descender!==void 0?Math.abs(Wi.descender):0,ud=(vh+cd)*Zi;jn<ud&&(jn=ud,In=(vh-cd)/2*Zi),Ga=-vh*Zi}else Ga=(br-Zi)*Eo-17}vs?(me.verticalizable=!0,vn.push({glyph:bi,imageName:Da,x:vt,y:ct+Ga,vertical:vs,scale:Zi,localGlyph:Ia.localGlyph,fontStack:cn.fontStack,sectionIndex:yi,metrics:Ia,rect:ss}),vt+=wa*Zi+nt):(vn.push({glyph:bi,imageName:Da,x:vt,y:ct+Ga,vertical:vs,scale:Zi,localGlyph:Ia.localGlyph,fontStack:cn.fontStack,sectionIndex:yi,metrics:Ia,rect:ss}),vt+=Ia.advance*Zi+nt)}vn.length!==0&&(Rt=Math.max(vt-nt,Rt),Nt?Nz(vn,$t,xn,In,Je*br/2):Nz(vn,$t,xn,0,Je/2)),vt=0;const Li=Je*br+xn;pn.lineOffset=Math.max(xn,Qr),ct+=Li,++hr}var or;const Jt=ct,{horizontalAlign:qt,verticalAlign:Er}=zC(Fe);(function(yr,br,Qr,pn,vn,xn){const jn=(br-Qr)*vn,In=-xn*pn;for(const Li of yr)for(const Ti of Li.positionedGlyphs)Ti.x+=jn,Ti.y+=In})(me.positionedLines,$t,qt,Er,Rt,Jt),me.top+=-Er*Jt,me.bottom=me.top+Jt,me.left+=-qt*Rt,me.right=me.left+Rt,me.hasBaseline=Nt}(he,s,c,p,X,x,k,N,R,z,L,I),!function(me){for(const we of me)if(we.positionedGlyphs.length!==0)return!1;return!0}(ie)&&he}const B2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Eie={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function kz(h,s,c,p,v,m){if(s.image){const x=p[s.image.serialize()];return x?x.displaySize[0]*s.scale*Eo/m+v:0}{const x=c[s.fontStack],k=x&&x.glyphs[h];return k?k.metrics.advance*s.scale+v:0}}function Mz(h,s,c,p){const v=Math.pow(h-s,2);return p?h<s?v/2:2*v:v+Math.abs(c)*c}function kie(h,s,c){let p=0;return h===10&&(p-=1e4),c&&(p+=150),h!==40&&h!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function jz(h,s,c,p,v,m){let x=null,k=Mz(s,c,v,m);for(const N of p){const z=Mz(s-N.x,c,v,m)+N.badness;z<=k&&(x=N,k=z)}return{index:h,x:s,priorBreak:x,badness:k}}function Oz(h){return h?Oz(h.priorBreak).concat(h.index):[]}function zC(h){let s=.5,c=.5;switch(h){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:s,verticalAlign:c}}function Nz(h,s,c,p,v){if(!(s||c||p||v))return;const m=h.length-1,x=h[m],k=(x.x+x.metrics.advance*x.scale)*s;for(let N=0;N<=m;N++)h[N].x-=k,h[N].y+=c+p+v}function Mie(h,s,c,p){const{horizontalAlign:v,verticalAlign:m}=zC(p),x=c[0]-h.displaySize[0]*v,k=c[1]-h.displaySize[1]*m;return{imagePrimary:h,imageSecondary:s,top:k,bottom:k+h.displaySize[1],left:x,right:x+h.displaySize[0]}}function Rz(h,s,c,p,v,m){const x=h.imagePrimary;let k;if(x.content){const X=x.content,Q=x.pixelRatio||1;k=[X[0]/Q,X[1]/Q,x.displaySize[0]-X[2]/Q,x.displaySize[1]-X[3]/Q]}const N=s.left*m,z=s.right*m;let C,R,L,j;c==="width"||c==="both"?(j=v[0]+N-p[3],R=v[0]+z+p[1]):(j=v[0]+(N+z-x.displaySize[0])/2,R=j+x.displaySize[0]);const I=s.top*m,$=s.bottom*m;return c==="height"||c==="both"?(C=v[1]+I-p[0],L=v[1]+$+p[2]):(C=v[1]+(I+$-x.displaySize[1])/2,L=C+x.displaySize[1]),{imagePrimary:x,imageSecondary:void 0,top:C,right:R,bottom:L,left:j,collisionPadding:k}}class Hp extends Pt{constructor(s,c,p,v,m){super(s,c),this.angle=v,this.z=p,m!==void 0&&(this.segment=m)}clone(){return new Hp(this.x,this.y,this.z,this.angle,this.segment)}}function Iz(h,s,c,p,v){if(s.segment===void 0)return!0;let m=s,x=s.segment+1,k=0;for(;k>-c/2;){if(x--,x<0)return!1;k-=h[x].dist(m),m=h[x]}k+=h[x].dist(h[x+1]),x++;const N=[];let z=0;for(;k<c/2;){const C=h[x],R=h[x+1];if(!R)return!1;let L=h[x-1].angleTo(C)-C.angleTo(R);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:k,angleDelta:L}),z+=L;k-N[0].distance>p;)z-=N.shift().angleDelta;if(z>v)return!1;x++,k+=C.dist(R)}return!0}function Dz(h){let s=0;for(let c=0;c<h.length-1;c++)s+=h[c].dist(h[c+1]);return s}function Lz(h,s,c){return h?.6*s*c:0}function zz(h,s){return Math.max(h?h.right-h.left:0,s?s.right-s.left:0)}function jie(h,s,c,p,v,m){const x=Lz(c,v,m),k=zz(c,p)*m;let N=0;const z=Dz(h)/2;for(let C=0;C<h.length-1;C++){const R=h[C],L=h[C+1],j=R.dist(L);if(N+j>z){const I=(z-N)/j,$=Lr(R.x,L.x,I),X=Lr(R.y,L.y,I),Q=new Hp($,X,0,L.angleTo(R),C);return!x||Iz(h,Q,k,x,s)?Q:void 0}N+=j}}function Oie(h,s,c,p,v,m,x,k,N){const z=Lz(p,m,x),C=zz(p,v),R=C*x,L=h[0].x===0||h[0].x===N||h[0].y===0||h[0].y===N;return s-R<s/4&&(s=R+s/4),Fz(h,L?s/2*k%s:(C/2+2*m)*x*k%s,s,z,c,R,L,!1,N)}function Fz(h,s,c,p,v,m,x,k,N){const z=m/2,C=Dz(h);let R=0,L=s-c,j=[];for(let I=0;I<h.length-1;I++){const $=h[I],X=h[I+1],Q=$.dist(X),le=X.angleTo($);for(;L+c<R+Q;){L+=c;const ue=(L-R)/Q,ie=Lr($.x,X.x,ue),he=Lr($.y,X.y,ue);if(ie>=0&&ie<N&&he>=0&&he<N&&L-z>=0&&L+z<=C){const me=new Hp(ie,he,0,le,I);p&&!Iz(h,me,m,p,v)||j.push(me)}}R+=Q}return k||j.length||x||(j=Fz(h,R/2,c,p,v,m,x,!0,N)),j}function Bz(h,s,c,p,v){const m=[];for(let x=0;x<h.length;x++){const k=h[x];let N;for(let z=0;z<k.length-1;z++){let C=k[z],R=k[z+1];C.x<s&&R.x<s||(C.x<s?C=new Pt(s,C.y+(s-C.x)/(R.x-C.x)*(R.y-C.y))._round():R.x<s&&(R=new Pt(s,C.y+(s-C.x)/(R.x-C.x)*(R.y-C.y))._round()),C.y<c&&R.y<c||(C.y<c?C=new Pt(C.x+(c-C.y)/(R.y-C.y)*(R.x-C.x),c)._round():R.y<c&&(R=new Pt(C.x+(c-C.y)/(R.y-C.y)*(R.x-C.x),c)._round()),C.x>=p&&R.x>=p||(C.x>=p?C=new Pt(p,C.y+(p-C.x)/(R.x-C.x)*(R.y-C.y))._round():R.x>=p&&(R=new Pt(p,C.y+(p-C.x)/(R.x-C.x)*(R.y-C.y))._round()),C.y>=v&&R.y>=v||(C.y>=v?C=new Pt(C.x+(v-C.y)/(R.y-C.y)*(R.x-C.x),v)._round():R.y>=v&&(R=new Pt(C.x+(v-C.y)/(R.y-C.y)*(R.x-C.x),v)._round()),N&&C.equals(N[N.length-1])||(N=[C],m.push(N)),N.push(R)))))}}return m}function Vz(h){let s=0,c=0;for(const x of h)s+=x.w*x.h,c=Math.max(c,x.w);h.sort((x,k)=>k.h-x.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),c),h:1/0}];let v=0,m=0;for(const x of h)for(let k=p.length-1;k>=0;k--){const N=p[k];if(!(x.w>N.w||x.h>N.h)){if(x.x=N.x,x.y=N.y,m=Math.max(m,x.y+x.h),v=Math.max(v,x.x+x.w),x.w===N.w&&x.h===N.h){const z=p.pop();k<p.length&&(p[k]=z)}else x.h===N.h?(N.x+=x.w,N.w-=x.w):x.w===N.w?(N.y+=x.h,N.h-=x.h):(p.push({x:N.x+x.w,y:N.y,w:N.w-x.w,h:x.h}),N.y+=x.h,N.h-=x.h);break}}return{w:v,h:m,fill:s/(v*m)||0}}mr(Hp,"Anchor");const ab=1;class sb{static getImagePositionScale(s,c,p){return c&&s&&s.options&&s.options.transform?{x:s.options.transform.a,y:s.options.transform.d}:{x:p,y:p}}constructor(s,{pixelRatio:c,version:p,stretchX:v,stretchY:m,content:x,sdf:k,usvg:N},z,C){this.paddedRect=s,this.pixelRatio=c,this.stretchX=v,this.stretchY=m,this.content=x,this.version=p,this.padding=z,this.sdf=k,this.scale=sb.getImagePositionScale(C,N,c)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class Uz{constructor(s,c,p){const v={},m={};this.haveRenderCallbacks=[];const x=[];this.addImages(s,v,ab,x),this.addImages(c,m,2,x);const{w:k,h:N}=Vz(x),z=new Ls({width:k||1,height:N||1});for(const C in s){const R=s[C],L=v[C].paddedRect;Ls.copy(R.data,z,{x:0,y:0},{x:L.x+ab,y:L.y+ab},R.data,p,R.sdf)}for(const C in c){const R=c[C],L=m[C].paddedRect;let j=m[C].padding;const I=L.x+j,$=L.y+j,X=R.data.width,Q=R.data.height;j=j>1?j-1:j,Ls.copy(R.data,z,{x:0,y:0},{x:I,y:$},R.data,p),Ls.copy(R.data,z,{x:0,y:Q-j},{x:I,y:$-j},{width:X,height:j},p),Ls.copy(R.data,z,{x:0,y:0},{x:I,y:$+Q},{width:X,height:j},p),Ls.copy(R.data,z,{x:X-j,y:0},{x:I-j,y:$},{width:j,height:Q},p),Ls.copy(R.data,z,{x:0,y:0},{x:I+X,y:$},{width:j,height:Q},p),Ls.copy(R.data,z,{x:X-j,y:Q-j},{x:I-j,y:$-j},{width:j,height:j},p),Ls.copy(R.data,z,{x:0,y:Q-j},{x:I+X,y:$-j},{width:j,height:j},p),Ls.copy(R.data,z,{x:0,y:0},{x:I+X,y:$+Q},{width:j,height:j},p),Ls.copy(R.data,z,{x:X-j,y:0},{x:I-j,y:$+Q},{width:j,height:j},p)}this.lut=p,this.image=z,this.iconPositions=v,this.patternPositions=m}addImages(s,c,p,v){for(const m in s){const x=s[m],k={x:0,y:0,w:x.data.width+2*p,h:x.data.height+2*p};v.push(k);const N=ll.deserializeFromString(m);c[m]=new sb(k,x,p,N),x.hasRenderCallback&&this.haveRenderCallbacks.push(N.id)}}patchUpdatedImages(s,c,p){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(v=>s.hasImage(v,p)),s.dispatchRenderCallbacks(this.haveRenderCallbacks,p);for(const v in s.getUpdatedImages(p)){for(const m of Object.keys(this.iconPositions))ll.deserializeId(m)===v&&this.patchUpdatedImage(this.iconPositions[m],s.getImage(v,p),c);for(const m of Object.keys(this.patternPositions))ll.deserializeId(m)===v&&this.patchUpdatedImage(this.patternPositions[m],s.getImage(v,p),c)}}patchUpdatedImage(s,c,p){if(!s||!c||s.version===c.version)return;s.version=c.version;const[v,m]=s.tl,x=s.sdf;if(this.lut||x){const k={width:c.data.width,height:c.data.height},N=new Ls(k);Ls.copy(c.data,N,{x:0,y:0},{x:0,y:0},k,this.lut,x),p.update(N,{position:{x:v,y:m}})}else p.update(c.data,{position:{x:v,y:m}})}}mr(sb,"ImagePosition"),mr(Uz,"ImageAtlas");const V2=1e20;function $z(h,s,c,p,v,m,x,k,N){for(let z=s;z<s+p;z++)qz(h,c*m+z,m,v,x,k,N);for(let z=c;z<c+v;z++)qz(h,z*m+s,1,p,x,k,N)}function qz(h,s,c,p,v,m,x){m[0]=0,x[0]=-1e20,x[1]=V2,v[0]=h[s];for(let k=1,N=0,z=0;k<p;k++){v[k]=h[s+k*c];const C=k*k;do{const R=m[N];z=(v[k]-v[R]+C-R*R)/(k-R)/2}while(z<=x[N]&&--N>-1);N++,m[N]=k,x[N]=z,x[N+1]=V2}for(let k=0,N=0;k<p;k++){for(;x[N+1]<k;)N++;const z=m[N],C=k-z;h[s+k*c]=v[z]+C*C}}const ph=2,FC={none:0,ideographs:1,all:2};class O0{constructor(s,c,p){this.requestManager=s,this.localGlyphMode=c,this.localFontFamily=p,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s,c){this.urls[c]=s}getGlyphs(s,c,p){const v=[],m=this.urls[c]||Ui.GLYPHS_URL;for(const x in s)for(const k of s[x])v.push({stack:x,id:k});Bi(v,({stack:x,id:k},N)=>{let z=this.entries[x];z||(z=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=z.glyphs[k];if(C!==void 0)return void N(null,{stack:x,id:k,glyph:C});if(C=this._tinySDF(z,x,k),C)return z.glyphs[k]=C,void N(null,{stack:x,id:k,glyph:C});const R=Math.floor(k/256);if(256*R>65535)return an("glyphs > 65535 not supported"),void N(null,{stack:x,id:k,glyph:C});if(z.ranges[R])return void N(null,{stack:x,id:k,glyph:C});let L=z.requests[R];L||(L=z.requests[R]=[],O0.loadGlyphRange(x,R,m,this.requestManager,(j,I)=>{if(I){z.ascender=I.ascender,z.descender=I.descender;for(const $ in I.glyphs)this._doesCharSupportLocalGlyph(+$)||(z.glyphs[+$]=I.glyphs[+$]);z.ranges[R]=!0}for(const $ of L)$(j,I);delete z.requests[R]})),L.push((j,I)=>{j?N(j):I&&N(null,{stack:x,id:k,glyph:I.glyphs[k]||null})})},(x,k)=>{if(x)p(x);else if(k){const N={};for(const{stack:z,id:C,glyph:R}of k)N[z]===void 0&&(N[z]={}),N[z].glyphs===void 0&&(N[z].glyphs={}),N[z].glyphs[C]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},N[z].ascender=this.entries[z].ascender,N[z].descender=this.entries[z].descender;p(null,N)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==FC.none&&(this.localGlyphMode===FC.all?!!this.localFontFamily:!!this.localFontFamily&&(kr["CJK Unified Ideographs"](s)||kr["Hangul Syllables"](s)||kr.Hiragana(s)||kr.Katakana(s)||kr["CJK Symbols and Punctuation"](s)||kr["CJK Unified Ideographs Extension A"](s)||kr["CJK Unified Ideographs Extension B"](s)||kr.Osage(s)))}_tinySDF(s,c,p){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let m=s.tinySDF;if(!m){let $="400";/bold/i.test(c)?$="900":/medium/i.test(c)?$="500":/light/i.test(c)&&($="200"),m=s.tinySDF=new O0.TinySDF({fontFamily:v,fontWeight:$,fontSize:24*ph,buffer:3*ph,radius:8*ph}),m.fontWeight=$}if(this.localGlyphs[m.fontWeight][p])return this.localGlyphs[m.fontWeight][p];const x=String.fromCodePoint(p),{data:k,width:N,height:z,glyphWidth:C,glyphHeight:R,glyphLeft:L,glyphTop:j,glyphAdvance:I}=m.draw(x);return this.localGlyphs[m.fontWeight][p]={id:p,bitmap:new od({width:N,height:z},k),metrics:{width:C/ph,height:R/ph,left:L/ph,top:j/ph-27,advance:I/ph,localGlyph:!0}}}}O0.loadGlyphRange=function(h,s,c,p,v){const m=256*s,x=m+255,k=p.transformRequest(p.normalizeGlyphsURL(c).replace("{fontstack}",h).replace("{range}",`${m}-${x}`),En.Glyphs);ts(k,(N,z)=>{if(N)v(N);else if(z){const C={},R=function(L){return new F2(L).readFields(Aie,{})}(z);for(const L of R.glyphs)C[L.id]=L;v(null,{glyphs:C,ascender:R.ascender,descender:R.descender})}})},O0.TinySDF=class{constructor({fontSize:h=24,buffer:s=3,radius:c=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=s,this.cutoff=p,this.radius=c;const k=this.size=h+4*s,N=this._createCanvas(k),z=this.ctx=N.getContext("2d",{willReadFrequently:!0});z.font=`${x} ${m} ${h}px ${v}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(h){const s=document.createElement("canvas");return s.width=s.height=h,s}draw(h){const{width:s,actualBoundingBoxAscent:c,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:m}=this.ctx.measureText(h),x=Math.ceil(c),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-v))),N=Math.min(this.size-this.buffer,x+Math.ceil(p)),z=k+2*this.buffer,C=N+2*this.buffer,R=Math.max(z*C,0),L=new Uint8ClampedArray(R),j={data:L,width:z,height:C,glyphWidth:k,glyphHeight:N,glyphTop:x,glyphLeft:0,glyphAdvance:s};if(k===0||N===0)return j;const{ctx:I,buffer:$,gridInner:X,gridOuter:Q}=this;I.clearRect($,$,k,N),I.fillText(h,$,$+x);const le=I.getImageData($,$,k,N);Q.fill(V2,0,R),X.fill(0,0,R);for(let ue=0;ue<N;ue++)for(let ie=0;ie<k;ie++){const he=le.data[4*(ue*k+ie)+3]/255;if(he===0)continue;const me=(ue+$)*z+ie+$;if(he===1)Q[me]=0,X[me]=V2;else{const we=.5-he;Q[me]=we>0?we*we:0,X[me]=we<0?we*we:0}}$z(Q,0,0,z,C,z,this.f,this.v,this.z),$z(X,$,$,k,N,z,this.f,this.v,this.z);for(let ue=0;ue<R;ue++){const ie=Math.sqrt(Q[ue])-Math.sqrt(X[ue]);L[ue]=Math.round(255-255*(ie/this.radius+this.cutoff))}return j}};const Hy=ab;function Gz(h,s){return h+s[1]-s[0]}function Wz(h,s,c,p,v=1){const m=[],x=h.imagePrimary,k=x.pixelRatio,N=x.paddedRect.w-2*Hy,z=x.paddedRect.h-2*Hy,C=(h.right-h.left)*v,R=(h.bottom-h.top)*v,L=x.stretchX||[[0,N]],j=x.stretchY||[[0,z]],I=L.reduce(Gz,0),$=j.reduce(Gz,0),X=N-I,Q=z-$;let le=0,ue=I,ie=0,he=$,me=0,we=X,Ie=0,Ne=Q;if(x.content&&p){const Je=x.content;le=U2(L,0,Je[0]),ie=U2(j,0,Je[1]),ue=U2(L,Je[0],Je[2]),he=U2(j,Je[1],Je[3]),me=Je[0]-le,Ie=Je[1]-ie,we=Je[2]-Je[0]-ue,Ne=Je[3]-Je[1]-he}const Me=(Je,Fe,tt,st)=>{const nt=$2(Je.stretch-le,ue,C,h.left*v),lt=q2(Je.fixed-me,we,Je.stretch,I),ft=$2(Fe.stretch-ie,he,R,h.top*v),vt=q2(Fe.fixed-Ie,Ne,Fe.stretch,$),ct=$2(tt.stretch-le,ue,C,h.left*v),Rt=q2(tt.fixed-me,we,tt.stretch,I),$t=$2(st.stretch-ie,he,R,h.top*v),Nt=q2(st.fixed-Ie,Ne,st.stretch,$),hr=new Pt(nt,ft),or=new Pt(ct,ft),Jt=new Pt(ct,$t),qt=new Pt(nt,$t),Er=new Pt(lt/k,vt/k),yr=new Pt(Rt/k,Nt/k),br=s*Math.PI/180;if(br){const In=Math.sin(br),Li=Math.cos(br),Ti=[Li,-In,In,Li];hr._matMult(Ti),or._matMult(Ti),qt._matMult(Ti),Jt._matMult(Ti)}const Qr=Je.stretch+Je.fixed,pn=tt.stretch+tt.fixed,vn=Fe.stretch+Fe.fixed,xn=st.stretch+st.fixed,jn=h.imageSecondary;return{tl:hr,tr:or,bl:qt,br:Jt,texPrimary:{x:x.paddedRect.x+Hy+Qr,y:x.paddedRect.y+Hy+vn,w:pn-Qr,h:xn-vn},texSecondary:jn?{x:jn.paddedRect.x+Hy+Qr,y:jn.paddedRect.y+Hy+vn,w:pn-Qr,h:xn-vn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Er,pixelOffsetBR:yr,minFontScaleX:we/k/C,minFontScaleY:Ne/k/R,isSDF:c}};if(p&&(x.stretchX||x.stretchY)){const Je=Hz(L,X,I),Fe=Hz(j,Q,$);for(let tt=0;tt<Je.length-1;tt++){const st=Je[tt],nt=Je[tt+1];for(let lt=0;lt<Fe.length-1;lt++)m.push(Me(st,Fe[lt],nt,Fe[lt+1]))}}else m.push(Me({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:N+1},{fixed:0,stretch:z+1}));return m}function U2(h,s,c){let p=0;for(const v of h)p+=Math.max(s,Math.min(c,v[1]))-Math.max(s,Math.min(c,v[0]));return p}function Hz(h,s,c){const p=[{fixed:-1,stretch:0}];for(const[v,m]of h){const x=p[p.length-1];p.push({fixed:v-x.stretch,stretch:x.stretch}),p.push({fixed:v-x.stretch,stretch:x.stretch+(m-v)})}return p.push({fixed:s+Hy,stretch:c}),p}function $2(h,s,c,p){return h/s*c+p}function q2(h,s,c,p){return h-s*c/p}function Nie(h,s,c,p){const v=s+h.positionedLines[p].lineOffset;return p===0?c+v/2:c+(v+(s+h.positionedLines[p-1].lineOffset))/2}function Rie(h,s=1,c=!1){let p=1/0,v=1/0,m=-1/0,x=-1/0;const k=h[0];for(let j=0;j<k.length;j++){const I=k[j];(!j||I.x<p)&&(p=I.x),(!j||I.y<v)&&(v=I.y),(!j||I.x>m)&&(m=I.x),(!j||I.y>x)&&(x=I.y)}const N=Math.min(m-p,x-v);let z=N/2;const C=new Rs([],Iie);if(N===0)return new Pt(p,v);for(let j=p;j<m;j+=N)for(let I=v;I<x;I+=N)C.push(new N0(j+z,I+z,z,h));let R=function(j){let I=0,$=0,X=0;const Q=j[0];for(let le=0,ue=Q.length,ie=ue-1;le<ue;ie=le++){const he=Q[le],me=Q[ie],we=he.x*me.y-me.x*he.y;$+=(he.x+me.x)*we,X+=(he.y+me.y)*we,I+=3*we}return new N0($/I,X/I,0,j)}(h),L=C.length;for(;C.length;){const j=C.pop();(j.d>R.d||!R.d)&&(R=j,c&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,L)),j.max-R.d<=s||(z=j.h/2,C.push(new N0(j.p.x-z,j.p.y-z,z,h)),C.push(new N0(j.p.x+z,j.p.y-z,z,h)),C.push(new N0(j.p.x-z,j.p.y+z,z,h)),C.push(new N0(j.p.x+z,j.p.y+z,z,h)),L+=4)}return c&&(console.log(`num probes: ${L}`),console.log(`best distance: ${R.d}`)),R.p}function Iie(h,s){return s.max-h.max}class N0{constructor(s,c,p,v){this.p=new Pt(s,c),this.h=p,this.d=function(m,x){let k=!1,N=1/0;for(let z=0;z<x.length;z++){const C=x[z];for(let R=0,L=C.length,j=L-1;R<L;j=R++){const I=C[R],$=C[j];I.y>m.y!=$.y>m.y&&m.x<($.x-I.x)*(m.y-I.y)/($.y-I.y)+I.x&&(k=!k),N=Math.min(N,qe(m,I,$))}}return(k?1:-1)*Math.sqrt(N)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const BC=Number.POSITIVE_INFINITY,Die=Math.sqrt(2);function Kz(h,[s,c]){let p=0,v=0;if(c===BC){s<0&&(s=0);const m=s/Die;switch(h){case"top-right":case"top-left":v=m-7;break;case"bottom-right":case"bottom-left":v=7-m;break;case"bottom":v=7-s;break;case"top":v=s-7}switch(h){case"top-right":case"bottom-right":p=-m;break;case"top-left":case"bottom-left":p=m;break;case"left":p=s;break;case"right":p=-s}}else{switch(s=Math.abs(s),c=Math.abs(c),h){case"top-right":case"top-left":case"top":v=c-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-c}switch(h){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}}return[p,v]}function VC(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Lie(h,s,c,p,v,m,x,k,N,z,C,R,L,j,I){let $=m.textMaxSize.evaluate(s,{},R);$===void 0?$=x*m.textScaleFactor:$*=m.textScaleFactor;const X=h.layers[0].layout,Q=X.get("icon-offset").evaluate(s,{},R),le=Yz(c.horizontal)||c.vertical,ue=L.name==="globe",ie=Eo,he=x*m.textScaleFactor/ie,me=h.tilePixelRatio*$/ie,we=(nt=h.overscaling,h.zoom>18&&nt>2&&(nt>>=1),Math.max(lr/(512*nt),1)*X.get("symbol-spacing")),Ie=X.get("text-padding")*h.tilePixelRatio,Ne=X.get("icon-padding")*h.tilePixelRatio,Me=et(X.get("text-max-angle")),Je=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Fe=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",tt=X.get("symbol-placement"),st=we/2;var nt;const lt=X.get("icon-text-fit").evaluate(s,{},R),ft=X.get("icon-text-fit-padding").evaluate(s,{},R),vt=lt!=="none";let ct;h.hasAnyIconTextFit===!1&&vt&&(h.hasAnyIconTextFit=!0),p&&vt&&(h.allowVerticalPlacement&&c.vertical&&(ct=Rz(p,c.vertical,lt,ft,Q,he)),le&&(p=Rz(p,le,lt,ft,Q,he)));const Rt=($t,Nt,hr)=>{if(Nt.x<0||Nt.x>=lr||Nt.y<0||Nt.y>=lr)return;let or=null;if(ue){const{x:Jt,y:qt,z:Er}=L.projectTilePoint(Nt.x,Nt.y,hr);or={anchor:new Hp(Jt,qt,Er,0,void 0),up:L.upVector(hr,Nt.x,Nt.y)}}(function(Jt,qt,Er,yr,br,Qr,pn,vn,xn,jn,In,Li,Ti,cn,yi,bi,Zi,Ia,ss,Da,wa,Ga,vs,ko,Wi,ec,vh){const cd=Jt.addToLineVertexArray(qt,yr);let ud,Jy,xg,Qy,Tb,M5,j5,O5=0,N5=0,R5=0,I5=0,wE=-1,SE=-1;const Cf={};let D5=ol("");const ev=Er?Er.anchor:qt,AE=xn.layout.get("icon-text-fit").evaluate(wa,{},Wi)!=="none";let TE=0,PE=0;if(xn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[TE,PE]=xn.layout.get("text-offset").evaluate(wa,{},Wi).map(du=>du*Eo):(TE=xn.layout.get("text-radial-offset").evaluate(wa,{},Wi)*Eo,PE=BC),Jt.allowVerticalPlacement&&br.vertical){const du=br.vertical;if(yi)M5=UC(du),vn&&(j5=UC(vn));else{const tc=xn.layout.get("text-rotate").evaluate(wa,{},Wi)+90;xg=G2(jn,ev,qt,In,Li,Ti,du,cn,tc,bi),vn&&(Qy=G2(jn,ev,qt,In,Li,Ti,vn,Ia,tc))}}if(Qr){const du=Jt.iconSizeData,tc=xn.layout.get("icon-rotate").evaluate(wa,{},Wi),Pb=Wz(Qr,tc,vs,AE,Ga.iconScaleFactor),EE=vn?Wz(vn,tc,vs,AE,Ga.iconScaleFactor):void 0;Jy=G2(jn,ev,qt,In,Li,Ti,Qr,Ia,tc,null),O5=4*Pb.length;let tv=null;du.kind==="source"?(tv=[fh*xn.layout.get("icon-size").evaluate(wa,{},Wi)*Ga.iconScaleFactor],tv[0]>mg&&an(`${Jt.layerIds[0]}: Value for "icon-size" is >= ${ob}. Reduce your "icon-size".`)):du.kind==="composite"&&(tv=[fh*Ga.compositeIconSizes[0].evaluate(wa,{},Wi)*Ga.iconScaleFactor,fh*Ga.compositeIconSizes[1].evaluate(wa,{},Wi)*Ga.iconScaleFactor],(tv[0]>mg||tv[1]>mg)&&an(`${Jt.layerIds[0]}: Value for "icon-size" is >= ${ob}. Reduce your "icon-size".`)),Jt.addSymbols(Jt.icon,Pb,tv,Da,ss,wa,!1,Er,qt,cd.lineStartIndex,cd.lineLength,-1,ko,Wi,ec,vh),wE=Jt.icon.placedSymbolArray.length-1,EE&&(N5=4*EE.length,Jt.addSymbols(Jt.icon,EE,tv,Da,ss,wa,cu.vertical,Er,qt,cd.lineStartIndex,cd.lineLength,-1,ko,Wi,ec,vh),SE=Jt.icon.placedSymbolArray.length-1)}for(const du in br.horizontal){const tc=br.horizontal[du];ud||(D5=ol(tc.text),yi?Tb=UC(tc):ud=G2(jn,ev,qt,In,Li,Ti,tc,cn,xn.layout.get("text-rotate").evaluate(wa,{},Wi),bi));const Pb=tc.positionedLines.length===1;if(R5+=Zz(Jt,Er,qt,tc,pn,xn,yi,wa,bi,cd,br.vertical?cu.horizontal:cu.horizontalOnly,Pb?Object.keys(br.horizontal):[du],Cf,wE,Ga,ko,Wi,ec),Pb)break}br.vertical&&(I5+=Zz(Jt,Er,qt,br.vertical,pn,xn,yi,wa,bi,cd,cu.vertical,["vertical"],Cf,SE,Ga,ko,Wi,ec));let _g=-1;const CE=(du,tc)=>du?Math.max(du,tc):tc;_g=CE(Tb,_g),_g=CE(M5,_g),_g=CE(j5,_g);const gse=_g>-1?1:0;Jt.glyphOffsetArray.length>=65535&&an("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wa.sortKey!==void 0&&Jt.addToSortKeyRanges(Jt.symbolInstances.length,wa.sortKey),Jt.symbolInstances.emplaceBack(qt.x,qt.y,ev.x,ev.y,ev.z,Cf.right>=0?Cf.right:-1,Cf.center>=0?Cf.center:-1,Cf.left>=0?Cf.left:-1,Cf.vertical>=0?Cf.vertical:-1,wE,SE,D5,ud!==void 0?ud:Jt.collisionBoxArray.length,ud!==void 0?ud+1:Jt.collisionBoxArray.length,xg!==void 0?xg:Jt.collisionBoxArray.length,xg!==void 0?xg+1:Jt.collisionBoxArray.length,Jy!==void 0?Jy:Jt.collisionBoxArray.length,Jy!==void 0?Jy+1:Jt.collisionBoxArray.length,Qy||Jt.collisionBoxArray.length,Qy?Qy+1:Jt.collisionBoxArray.length,In,R5,I5,O5,N5,gse,0,TE,PE,_g,0,AE?1:0)})(h,Nt,or,$t,c,p,v,ct,h.layers[0],h.collisionBoxArray,s.index,s.sourceLayerIndex,h.index,Ie,Je,N,0,Ne,Fe,Q,s,m,z,C,R,j,I)};if(tt==="line")for(const $t of Bz(s.geometry,0,0,lr,lr)){const Nt=Oie($t,we,Me,c.vertical||le,p,ie,me,h.overscaling,lr);for(const hr of Nt)le&&zie(h,le.text,st,hr)||Rt($t,hr,R)}else if(tt==="line-center"){for(const $t of s.geometry)if($t.length>1){const Nt=jie($t,Me,c.vertical||le,p,ie,me);Nt&&Rt($t,Nt,R)}}else if(s.type==="Polygon")for(const $t of Tr(s.geometry,0)){const Nt=Rie($t,16);Rt($t[0],new Hp(Nt.x,Nt.y,0,0,void 0),R)}else if(s.type==="LineString")for(const $t of s.geometry)Rt($t,new Hp($t[0].x,$t[0].y,0,0,void 0),R);else if(s.type==="Point")for(const $t of s.geometry)for(const Nt of $t)Rt([Nt],new Hp(Nt.x,Nt.y,0,0,void 0),R)}const ob=255,mg=ob*fh;function Zz(h,s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X,Q){const le=function(he,me,we,Ie,Ne,Me,Je,Fe){const tt=[];if(me.positionedLines.length===0)return tt;const st=Ie.layout.get("text-rotate").evaluate(Me,{})*Math.PI/180,nt=function(Rt){const $t=Rt[0],Nt=Rt[1],hr=$t*Nt;return hr>0?[$t,-Nt]:hr<0?[-$t,Nt]:$t===0?[Nt,$t]:[Nt,-$t]}(we);let lt=Math.abs(me.top-me.bottom);for(const Rt of me.positionedLines)lt-=Rt.lineOffset;const ft=me.positionedLines.length,vt=lt/ft;let ct=me.top-we[1];for(let Rt=0;Rt<ft;++Rt){const $t=me.positionedLines[Rt];ct=Nie(me,vt,ct,Rt);for(const Nt of $t.positionedGlyphs){if(!Nt.rect)continue;const hr=Nt.rect||{};let or=Cie+1,Jt=!0,qt=1,Er=0;if(Nt.imageName){const Da=Je[Ts.build(Nt.imageName).getSerializedPrimary()];if(!Da)continue;if(Da.sdf){an("SDF images are not supported in formatted text and will be ignored.");continue}Jt=!1,qt=Da.pixelRatio,or=ab/qt}const yr=(Ne||Fe)&&Nt.vertical,br=Nt.metrics.advance*Nt.scale/2,Qr=Nt.metrics,pn=Nt.rect;if(pn===null)continue;Fe&&me.verticalizable&&(Er=Nt.imageName?br-Nt.metrics.width*Nt.scale/2:0);const vn=Ne?[Nt.x+br,Nt.y]:[0,0];let xn=[0,0],jn=[0,0],In=!1;Ne||(yr?(jn=[Nt.x+br+nt[0],Nt.y+nt[1]-Er],In=!0):xn=[Nt.x+br+we[0],Nt.y+we[1]-Er]);const Li=pn.w*Nt.scale/(qt*(Nt.localGlyph?ph:1)),Ti=pn.h*Nt.scale/(qt*(Nt.localGlyph?ph:1));let cn,yi,bi,Zi;if(yr){const Da=Nt.y-ct,wa=new Pt(-br,br-Da),Ga=-Math.PI/2,vs=new Pt(...jn);cn=new Pt(-br+xn[0],xn[1]),cn._rotateAround(Ga,wa)._add(vs),cn.x+=-Da+br,cn.y-=(Qr.left-or)*Nt.scale;const ko=Nt.imageName?Qr.advance*Nt.scale:Eo*Nt.scale,Wi=String.fromCodePoint(Nt.glyph);bie(Wi)?cn.x+=(1-or)*Nt.scale:wie(Wi)?cn.x+=ko-Qr.height*Nt.scale+(-or-1)*Nt.scale:cn.x+=Nt.imageName||Qr.width+2*or===pn.w&&Qr.height+2*or===pn.h?(ko-Ti)/2:(ko-(Qr.height+2*or)*Nt.scale)/2,yi=new Pt(cn.x,cn.y-Li),bi=new Pt(cn.x+Ti,cn.y),Zi=new Pt(cn.x+Ti,cn.y-Li)}else{const Da=(Qr.left-or)*Nt.scale-br+xn[0],wa=(-Qr.top-or)*Nt.scale+xn[1],Ga=Da+Li,vs=wa+Ti;cn=new Pt(Da,wa),yi=new Pt(Ga,wa),bi=new Pt(Da,vs),Zi=new Pt(Ga,vs)}if(st){let Da;Da=Ne?new Pt(0,0):In?new Pt(nt[0],nt[1]):new Pt(we[0],we[1]),cn._rotateAround(st,Da),yi._rotateAround(st,Da),bi._rotateAround(st,Da),Zi._rotateAround(st,Da)}const Ia=new Pt(0,0),ss=new Pt(0,0);tt.push({tl:cn,tr:yi,bl:bi,br:Zi,texPrimary:hr,texSecondary:void 0,writingMode:me.writingMode,glyphOffset:vn,sectionIndex:Nt.sectionIndex,isSDF:Jt,pixelOffsetTL:Ia,pixelOffsetBR:ss,minFontScaleX:0,minFontScaleY:0})}}return tt}(0,p,N,m,x,k,v,h.allowVerticalPlacement),ue=h.textSizeData;let ie=null;ue.kind==="source"?(ie=[fh*m.layout.get("text-size").evaluate(k,{},X)*I.textScaleFactor],ie[0]>mg&&an(`${h.layerIds[0]}: Value for "text-size" is >= ${ob}. Reduce your "text-size".`)):ue.kind==="composite"&&(ie=[fh*I.compositeTextSizes[0].evaluate(k,{},X)*I.textScaleFactor,fh*I.compositeTextSizes[1].evaluate(k,{},X)*I.textScaleFactor],(ie[0]>mg||ie[1]>mg)&&an(`${h.layerIds[0]}: Value for "text-size" is >= ${ob}. Reduce your "text-size".`)),h.addSymbols(h.text,le,ie,N,x,k,C,s,c,z.lineStartIndex,z.lineLength,j,$,X,Q,!1);for(const he of R)L[he]=h.text.placedSymbolArray.length-1;return 4*le.length}function Yz(h){for(const s in h)return h[s];return null}function G2(h,s,c,p,v,m,x,k,N,z){let C=x.top,R=x.bottom,L=x.left,j=x.right;const I=x.collisionPadding;if(I&&(L-=I[0],C-=I[1],j+=I[2],R+=I[3]),N){const $=new Pt(L,C),X=new Pt(j,C),Q=new Pt(L,R),le=new Pt(j,R),ue=et(N);let ie=new Pt(0,0);z&&(ie=new Pt(z[0],z[1])),$._rotateAround(ue,ie),X._rotateAround(ue,ie),Q._rotateAround(ue,ie),le._rotateAround(ue,ie),L=Math.min($.x,X.x,Q.x,le.x),j=Math.max($.x,X.x,Q.x,le.x),C=Math.min($.y,X.y,Q.y,le.y),R=Math.max($.y,X.y,Q.y,le.y)}return h.emplaceBack(s.x,s.y,s.z,c.x,c.y,L,C,j,R,k,p,v,m),h.length-1}function UC(h){h.collisionPadding&&(h.top-=h.collisionPadding[1],h.bottom+=h.collisionPadding[3]);const s=h.bottom-h.top;return s>0?Math.max(10,s):null}function zie(h,s,c,p){const v=h.compareText;if(s in v){const m=v[s];for(let x=m.length-1;x>=0;x--)if(p.dist(m[x])<c)return!0}else v[s]=[];return v[s].push(p),!1}function Xz(h,s){const c=h.fovAboveCenter,p=h.elevation?h.elevation.getMinElevationBelowMSL()*s:0,v=(h._camera.position[2]*h.worldSize-p)/Math.cos(h._pitch),m=Math.sin(c)*v/Math.sin(Math.max(Math.PI/2-h._pitch-c,.01));let x=Math.sin(h._pitch)*m+v;const k=v*(1/h._horizonShift);if(!h.elevation||h.elevation.exaggeration()===0){let N=Math.max(h.zoom-17,0);h.isOrthographic&&(N/=10),x*=1+N}return Math.min(1.01*x,k)}function lb(h,s){if(!s.isReprojectedInTileSpace)return{scale:1<<h.z,x:h.x,y:h.y,x2:h.x+1,y2:h.y+1,projection:s};const c=Math.pow(2,-h.z),p=h.x*c,v=(h.x+1)*c,m=h.y*c,x=(h.y+1)*c,k=Xo(p),N=Xo(v),z=Fr(m),C=Fr(x),R=s.project(k,z),L=s.project(N,z),j=s.project(N,C),I=s.project(k,C);let $=Math.min(R.x,L.x,j.x,I.x),X=Math.min(R.y,L.y,j.y,I.y),Q=Math.max(R.x,L.x,j.x,I.x),le=Math.max(R.y,L.y,j.y,I.y);const ue=c/16;function ie(me,we,Ie,Ne,Me,Je){const Fe=(Ie+Me)/2,tt=(Ne+Je)/2,st=s.project(Xo(Fe),Fr(tt)),nt=Math.max(0,$-st.x,X-st.y,st.x-Q,st.y-le);$=Math.min($,st.x),Q=Math.max(Q,st.x),X=Math.min(X,st.y),le=Math.max(le,st.y),nt>ue&&(ie(me,st,Ie,Ne,Fe,tt),ie(st,we,Fe,tt,Me,Je))}ie(R,L,p,m,v,m),ie(L,j,v,m,v,x),ie(j,I,v,x,p,x),ie(I,R,p,x,p,m),$-=ue,X-=ue,Q+=ue,le+=ue;const he=1/Math.max(Q-$,le-X);return{scale:he,x:$*he,y:X*he,x2:Q*he,y2:le*he,projection:s}}function Jz(h,{x:s,y:c},p=0){return new Pt(((s-p)*h.scale-h.x)*lr,(c*h.scale-h.y)*lr)}const Fie=De.mat4.identity(new Float32Array(16));class gg{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,c){return{x:0,y:0,z:0}}unproject(s,c){return new Kn(0,0)}projectTilePoint(s,c,p){return{x:s,y:c,z:0}}locationPoint(s,c,p=!0){return s._coordinatePoint(s.locationCoordinate(c),p)}pixelsPerMeter(s,c){return qi(1,s)*c}pixelSpaceConversion(s,c,p){return 1}farthestPixelDistance(s){return Xz(s,s.pixelsPerMeter)}pointCoordinate(s,c,p,v){const m=s.horizonLineFromTop(!1),x=new Pt(c,Math.max(m,p));return s.rayIntersectionCoordinate(s.pointRayIntersection(x,v))}pointCoordinate3D(s,c,p){const v=new Pt(c,p);if(s.elevation)return s.elevation.pointCoordinate(v);{const m=this.pointCoordinate(s,v.x,v.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(s,c){if(s.elevation&&s.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(s,c.x,c.y);const p=s.horizonLineFromTop();return c.y<p}createInversionMatrix(s,c){return Fie}createTileMatrix(s,c,p){let v,m,x;const k=p.canonical,N=De.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const z=lb(k,this);v=1,m=z.x+p.wrap*z.scale,x=z.y,De.mat4.scale(N,N,[v/z.scale,v/z.scale,s.pixelsPerMeter/c])}else v=c/s.zoomScale(k.z),m=(k.x+Math.pow(2,k.z)*p.wrap)*v,x=k.y*v;return De.mat4.translate(N,N,[m,x,0]),De.mat4.scale(N,N,[v/lr,v/lr,1]),N}upVector(s,c,p){return[0,0,1]}upVectorScale(s,c,p){return{metersToTile:1}}}class Bie extends gg{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[c,p]=this.parallels=s.parallels||[29.5,45.5],v=Math.sin(et(c));this.n=(v+Math.sin(et(p)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(s,c){const{n:p,c:v,r0:m}=this,x=et(s-this.center[0]),k=et(c),N=Math.sqrt(v-2*p*Math.sin(k))/p;return{x:N*Math.sin(x*p),y:N*Math.cos(x*p)-m,z:0}}unproject(s,c){const{n:p,c:v,r0:m}=this,x=m+c;let k=Math.atan2(s,Math.abs(x))*Math.sign(x);x*p<0&&(k-=Math.PI*Math.sign(s)*Math.sign(x));const N=et(this.center[0])*p;k=Xn(k,-Math.PI-N,Math.PI-N);const z=ar(bt(k/p)+this.center[0],-180,180),C=Math.asin(ar((v-(s*s+x*x)*p*p)/(2*p),-1,1)),R=ar(bt(C),-85.051129,Zs);return new Kn(z,R)}}const cb=1.340264,ub=-.081106,db=893e-6,hb=.003796,W2=Math.sqrt(3)/2;class Vie extends gg{project(s,c){c=c/180*Math.PI,s=s/180*Math.PI;const p=Math.asin(W2*Math.sin(c)),v=p*p,m=v*v*v;return{x:.5*(s*Math.cos(p)/(W2*(cb+3*ub*v+m*(7*db+9*hb*v)))/Math.PI+.5),y:1-.5*(p*(cb+ub*v+m*(db+hb*v))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let p=c=(2*(1-c)-1)*Math.PI,v=p*p,m=v*v*v;for(let C,R,L,j=0;j<12&&(R=p*(cb+ub*v+m*(db+hb*v))-c,L=cb+3*ub*v+m*(7*db+9*hb*v),C=R/L,p=ar(p-C,-Math.PI/3,Math.PI/3),v=p*p,m=v*v*v,!(Math.abs(C)<1e-12));++j);const x=W2*s*(cb+3*ub*v+m*(7*db+9*hb*v))/Math.cos(p),k=Math.asin(Math.sin(p)/W2),N=ar(180*x/Math.PI,-180,180),z=ar(180*k/Math.PI,-85.051129,Zs);return new Kn(N,z)}}class Uie extends gg{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){return{x:.5+s/360,y:.5-c/360,z:0}}unproject(s,c){const p=360*(s-.5),v=ar(360*(.5-c),-85.051129,Zs);return new Kn(p,v)}}const R0=Math.PI/2;function H2(h){return Math.tan((R0+h)/2)}class $ie extends gg{constructor(s){super(s),this.center=s.center||[0,30];const[c,p]=this.parallels=s.parallels||[30,30];let v=et(c),m=et(p);this.southernCenter=v+m<0,this.southernCenter&&(v=-v,m=-m);const x=Math.cos(v),k=H2(v);this.n=v===m?Math.sin(v):Math.log(x/Math.cos(m))/Math.log(H2(m)/k),this.f=x*Math.pow(H2(v),this.n)/this.n}project(s,c){c=et(c),this.southernCenter&&(c=-c),s=et(s-this.center[0]);const p=1e-6,{n:v,f:m}=this;m>0?c<-R0+p&&(c=-R0+p):c>R0-p&&(c=R0-p);const x=m/Math.pow(H2(c),v);let k=x*Math.sin(v*s),N=m-x*Math.cos(v*s);return k=.5*(k/Math.PI+.5),N=.5*(N/Math.PI+.5),{x:k,y:this.southernCenter?N:1-N,z:0}}unproject(s,c){s=(2*s-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:p,f:v}=this,m=v-c,x=Math.sign(m),k=Math.sign(p)*Math.sqrt(s*s+m*m);let N=Math.atan2(s,Math.abs(m))*x;m*p<0&&(N-=Math.PI*Math.sign(s)*x);const z=ar(bt(N/p)+this.center[0],-180,180),C=ar(bt(2*Math.atan(Math.pow(v/k,1/p))-R0),-85.051129,Zs);return new Kn(z,this.southernCenter?-C:C)}}class Qz extends gg{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,c){return{x:Cc(s),y:Yo(c),z:0}}unproject(s,c){const p=Xo(s),v=Fr(c);return new Kn(p,v)}}const eF=et(Zs);class qie extends gg{project(s,c){const p=(c=et(c))*c,v=p*p;return{x:.5*((s=et(s))*(.8707-.131979*p+v*(v*(.003971*p-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+p*(.015085+v*(.028874*p-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(s,c){s=(2*s-.5)*Math.PI;let p=c=(2*(1-c)-1)*Math.PI,v=25,m=0,x=p*p;do{x=p*p;const z=x*x;m=(p*(1.007226+x*(.015085+z*(.028874*x-.044475-.005916*z)))-c)/(1.007226+x*(.045255+z*(.259866*x-.311325-.005916*11*z))),p=ar(p-m,-eF,eF)}while(Math.abs(m)>1e-6&&--v>0);x=p*p;const k=ar(bt(s/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),N=bt(p);return new Kn(k,N)}}const tF=et(Zs);class Gie extends gg{project(s,c){c=et(c),s=et(s);const p=Math.cos(c),v=2/Math.PI,m=Math.acos(p*Math.cos(s/2)),x=Math.sin(m)/m,k=.5*(s*v+2*p*Math.sin(s/2)/x)||0,N=.5*(c+Math.sin(c)/x)||0;return{x:.5*(k/Math.PI+.5),y:1-.5*(N/Math.PI+1),z:0}}unproject(s,c){let p=s=(2*s-.5)*Math.PI,v=c=(2*(1-c)-1)*Math.PI,m=25;const x=1e-6;let k=0,N=0;do{const z=Math.cos(v),C=Math.sin(v),R=2*C*z,L=C*C,j=z*z,I=Math.cos(p/2),$=Math.sin(p/2),X=2*I*$,Q=$*$,le=1-j*I*I,ue=le?1/le:0,ie=le?Math.acos(z*I)*Math.sqrt(1/le):0,he=.5*(2*ie*z*$+2*p/Math.PI)-s,me=.5*(ie*C+v)-c,we=.5*ue*(j*Q+ie*z*I*L)+1/Math.PI,Ie=ue*(X*R/4-ie*C*$),Ne=.125*ue*(R*$-ie*C*j*X),Me=.5*ue*(L*I+ie*Q*z)+.5,Je=Ie*Ne-Me*we;k=(me*Ie-he*Me)/Je,N=(he*Ne-me*we)/Je,p=ar(p-k,-Math.PI,Math.PI),v=ar(v-N,-tF,tF)}while((Math.abs(k)>x||Math.abs(N)>x)&&--m>0);return new Kn(bt(p),bt(v))}}class rF extends gg{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(et(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,c){const{scale:p,cosPhi:v}=this;return{x:et(s)*v*p+.5,y:-Math.sin(et(c))/v*p+.5,z:0}}unproject(s,c){const{scale:p,cosPhi:v}=this,m=-(c-.5)/p,x=ar(bt((s-.5)/p)/v,-180,180),k=Math.asin(ar(m*v,-1,1)),N=ar(bt(k),-85.051129,Zs);return new Kn(x,N)}}class Wie extends Qz{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,c,p){const v=_i(s,c,p),m=is(Ma(p));return De.vec3.transformMat4(v,v,m),{x:v[0],y:v[1],z:v[2]}}locationPoint(s,c){const p=lh(c.lat,c.lng),v=De.vec3.normalize([],p),m=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(c),s._centerAltitude):s._centerAltitude,x=qi(1,0)*lr*m;De.vec3.scaleAndAdd(p,p,v,x);const k=De.mat4.identity(new Float64Array(16));return De.mat4.multiply(k,s.pixelMatrix,s.globeMatrix),De.vec3.transformMat4(p,p,k),new Pt(p[0],p[1])}pixelsPerMeter(s,c){return qi(1,0)*c}pixelSpaceConversion(s,c,p){const v=qi(1,s)*c,m=Lr(qi(1,45)*c,v,p);return this.pixelsPerMeter(s,c)/m}createTileMatrix(s,c,p){const v=Ci(Ma(p.canonical));return De.mat4.multiply(new Float64Array(16),s.globeMatrix,v)}createInversionMatrix(s,c){const{center:p}=s,v=is(Ma(c));return De.mat4.rotateY(v,v,et(p.lng)),De.mat4.rotateX(v,v,et(p.lat)),De.mat4.scale(v,v,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(s,c,p,v){return si(s,c,p,!0)||new d(0,0)}pointCoordinate3D(s,c,p){const v=this.pointCoordinate(s,c,p,0);return[v.x,v.y,v.z]}isPointAboveHorizon(s,c){return!si(s,c.x,c.y,!1)}farthestPixelDistance(s){const c=function(v,m){const x=v.cameraToCenterDistance,k=v._centerAltitude*m,N=v._camera,z=v._camera.forward(),C=De.vec3.add([],De.vec3.scale([],z,-x),[0,0,k]),R=v.worldSize/(2*Math.PI),L=[0,0,-R],j=v.width/v.height,I=Math.tan(v.fovAboveCenter),$=De.vec3.scale([],N.up(),I),X=De.vec3.scale([],N.right(),I*j),Q=De.vec3.normalize([],De.vec3.add([],De.vec3.add([],z,$),X)),le=[];let ue;if(new Hr(C,Q).closestPointOnSphere(L,R,le)){const ie=De.vec3.add([],le,L),he=De.vec3.sub([],ie,C);ue=Math.cos(v.fovAboveCenter)*De.vec3.length(he)}else{const ie=De.vec3.sub([],C,L),he=De.vec3.sub([],L,C);De.vec3.normalize(he,he);const me=De.vec3.length(ie)-R;ue=Math.sqrt(me*(me+2*R));const we=Math.acos(ue/(R+me))-Math.acos(De.vec3.dot(z,he));ue*=Math.cos(we)}return 1.01*ue}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),p=Po(s.zoom);if(p>0){const v=Xz(s,qi(1,s.center.lat)*s.worldSize),m=s.worldSize/(2*Math.PI),x=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Lr(c,v+m*(1-Math.cos(x)),Math.pow(p,10))}return c}upVector(s,c,p){return _i(c,p,s,1)}upVectorScale(s){return{metersToTile:kn(Nn(Ma(s)))}}}function nF(h){const s=h.parallels,c=!!s&&Math.abs(s[0]+s[1])<.01;switch(h.name){case"mercator":return new Qz(h);case"equirectangular":return new Uie(h);case"naturalEarth":return new qie(h);case"equalEarth":return new Vie(h);case"winkelTripel":return new Gie(h);case"albers":return c?new rF(h):new Bie(h);case"lambertConformalConic":return c?new rF(h):new $ie(h);case"globe":return new Wie(h)}throw new Error(`Invalid projection name: ${h.name}`)}const Hie=k0.VectorTileFeature.types,Kie=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function K2(h,s,c,p,v,m,x,k,N,z,C,R,L){const j=k?Math.min(mg,Math.round(k[0])):0,I=k?Math.min(mg,Math.round(k[1])):0;h.emplaceBack(s,c,Math.round(32*p),Math.round(32*v),m,x,(j<<1)+(N?1:0),I,16*z,16*C,256*R,256*L)}function Z2(h,s,c){h.emplaceBack(s,c)}function Y2(h,s,c,p,v,m,x){h.emplaceBack(s,c,p,v,m,x)}function X2(h,s,c,p,v){h.emplaceBack(s,c,p,v),h.emplaceBack(s,c,p,v),h.emplaceBack(s,c,p,v),h.emplaceBack(s,c,p,v)}function Zie(h){for(const s of h.sections)if(Gm(s.text))return!0;return!1}class $C{constructor(s){this.layoutVertexArray=new Np,this.indexArray=new ms,this.programConfigurations=s,this.segments=new ya,this.dynamicLayoutVertexArray=new nu,this.opacityVertexArray=new Ol,this.placedSymbolArray=new Ry,this.iconTransitioningVertexArray=new Cs,this.globeExtVertexArray=new Rp,this.zOffsetVertexArray=new hf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(s,c,p,v,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,die.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,fie.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,Kie,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=s.createVertexBuffer(this.iconTransitioningVertexArray,mie.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,hie.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,pie.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}mr($C,"SymbolBuffers");class qC{constructor(s,c,p){this.layoutVertexArray=new s,this.layoutAttributes=c,this.indexArray=new p,this.segments=new ya,this.collisionVertexArray=new Jm,this.collisionVertexArrayExt=new nu}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,gie.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,yie.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}mr(qC,"CollisionBuffers");class J2{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.lut=s.lut,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(x=>x.fqid),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=De.mat4.identity([]),this.placementViewportMatrix=De.mat4.identity([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=NC(this.zoom,c["text-size"]),this.iconSizeData=NC(this.zoom,c["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),m=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(x=>cu[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=s.sourceID,this.projection=s.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=p.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new $C(new ou(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("text")||s.startsWith("symbol"))),this.icon=new $C(new ou(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("icon")||s.startsWith("symbol"))),this.glyphOffsetArray=new g0,this.lineVertexArray=new Ly,this.symbolInstances=new Dy}calculateGlyphDependencies(s,c,p,v,m){for(const x of s){const k=x.codePointAt(0);if(k===void 0)break;if(c[k]=!0,v&&m&&k<=65535){const N=nb[x];N&&(c[N.charCodeAt(0)]=!0)}}}updateFootprints(s,c){}updateReplacement(s,c){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(s.toUnwrapped(),!0);return!TC(this.activeReplacements,p)&&(this.activeReplacements=p,!0)}populate(s,c,p,v){const m=this.layers[0],x=m.layout,k=this.projection.name==="globe",N=x.get("text-font"),z=x.get("text-field"),C=x.get("icon-image"),[R,L]=x.get("icon-size-scale-range"),j=ar(c.scaleFactor||1,R,L),I=(z.value.kind!=="constant"||z.value.value instanceof As&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),$=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,X=x.get("symbol-sort-key");if(this.features=[],!I&&!$)return;const Q=c.iconDependencies,le=c.glyphDependencies,ue=c.availableImages,ie=new xi(this.zoom);for(const{feature:he,id:me,index:we,sourceLayerIndex:Ie}of s){const Ne=m._featureFilter.needGeometry,Me=te(he,Ne);if(!m._featureFilter.filter(ie,Me,p))continue;if(Ne||(Me.geometry=Y(he,p,v)),k&&he.type!==1&&p.z<=5){const nt=Me.geometry,lt=.98078528056,ft=(vt,ct)=>{const Rt=_i(vt.x,vt.y,p,1),$t=_i(ct.x,ct.y,p,1);return De.vec3.dot(Rt,$t)<lt};for(let vt=0;vt<nt.length;vt++)nt[vt]=M(nt[vt],ft)}let Je,Fe;if(I){const nt=m.getValueAndResolveTokens("text-field",Me,p,ue),lt=As.factory(nt);Zie(lt)&&(this.hasRTLText=!0),(!this.hasRTLText||Xd()==="unavailable"||this.hasRTLText&&Go.isParsed())&&(Je=_ie(lt,m,Me))}if($){const nt=m.getValueAndResolveTokens("icon-image",Me,p,ue);Fe=nt instanceof Ts?nt:Ts.build(nt)}if(!Je&&!Fe)continue;const tt=this.sortFeaturesByKey?X.evaluate(Me,{},p):void 0,st={id:me,text:Je,icon:Fe,index:we,sourceLayerIndex:Ie,geometry:Me.geometry,properties:he.properties,type:Hie[he.type],sortKey:tt};if(this.features.push(st),Fe){const nt=OC(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],p,this.zoom,st)*j*this.pixelRatio,lt=Fe.getPrimary().scaleSelf(nt);if(Q[lt.id]=Q[lt.id]||[],Q[lt.id].push(lt),Fe.nameSecondary){const ft=Fe.getSecondary().scaleSelf(nt);Q[ft.id]=Q[ft.id]||[],Q[ft.id].push(ft)}}if(Je){const nt=N.evaluate(Me,{},p).join(","),lt=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(cu.vertical)>=0;for(const ft of Je.sections)if(ft.image){const vt=ft.image.getPrimary().scaleSelf(this.pixelRatio);Q[vt.id]=Q[vt.id]||[],Q[vt.id].push(vt)}else{const vt=kp(Je.toString()),ct=ft.fontStack||nt,Rt=le[ct]=le[ct]||{};this.calculateGlyphDependencies(ft.text,Rt,lt,this.allowVerticalPlacement,vt)}}}x.get("symbol-placement")==="line"&&(this.features=function(he){const me={},we={},Ie=[];let Ne=0;function Me(st){Ie.push(he[st]),Ne++}function Je(st,nt,lt){const ft=we[st];return delete we[st],we[nt]=ft,Ie[ft].geometry[0].pop(),Ie[ft].geometry[0]=Ie[ft].geometry[0].concat(lt[0]),ft}function Fe(st,nt,lt){const ft=me[nt];return delete me[nt],me[st]=ft,Ie[ft].geometry[0].shift(),Ie[ft].geometry[0]=lt[0].concat(Ie[ft].geometry[0]),ft}function tt(st,nt,lt){const ft=lt?nt[0][nt[0].length-1]:nt[0][0];return`${st}:${ft.x}:${ft.y}`}for(let st=0;st<he.length;st++){const nt=he[st],lt=nt.geometry,ft=nt.text?nt.text.toString():null;if(!ft){Me(st);continue}const vt=tt(ft,lt),ct=tt(ft,lt,!0);if(vt in we&&ct in me&&we[vt]!==me[ct]){const Rt=Fe(vt,ct,lt),$t=Je(vt,ct,Ie[Rt].geometry);delete me[vt],delete we[ct],we[tt(ft,Ie[$t].geometry,!0)]=$t,Ie[Rt].geometry=null}else vt in we?Je(vt,ct,lt):ct in me?Fe(vt,ct,lt):(Me(st),me[vt]=Ne-1,we[ct]=Ne-1)}return Ie.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,me)=>he.sortKey-me.sortKey)}update(s,c,p,v,m,x,k){this.text.programConfigurations.updatePaintArrays(s,c,m,p,v,x,k),this.icon.programConfigurations.updatePaintArrays(s,c,m,p,v,x,k)}updateZOffset(){const s=(m,x,k)=>{p+=x,p>m.length&&m.resize(p);for(let N=-x;N<0;N++)m.emplace(N+p,k)},c=(m,x,k)=>{v+=x,v>m.length&&m.resize(v);for(let N=-x;N<0;N++)m.emplace(N+v,k)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let p=0,v=0;for(let m=0;m<this.symbolInstances.length;m++){const x=this.symbolInstances.get(m),{numHorizontalGlyphVertices:k,numVerticalGlyphVertices:N,numIconVertices:z}=x,C=x.zOffset,R=z>0;if((k>0||N>0)&&(s(this.text.zOffsetVertexArray,k,C),s(this.text.zOffsetVertexArray,N,C)),R){const{placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:j}=x;L>=0&&c(this.icon.zOffsetVertexArray,z,C),j>=0&&c(this.icon.zOffsetVertexArray,x.numVerticalIconVertices,C)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=nF(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,c){const p=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:v,y:m}of c)this.lineVertexArray.emplaceBack(v,m);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,c,p,v,m,x,k,N,z,C,R,L,j,I,$,X){const Q=s.indexArray,le=s.layoutVertexArray,ue=s.globeExtVertexArray,ie=s.segments.prepareSegment(4*c.length,le,Q,this.canOverlap?x.sortKey:void 0),he=this.glyphOffsetArray.length,me=ie.vertexLength,we=this.allowVerticalPlacement&&k===cu.vertical?Math.PI/2:0,Ie=x.text&&x.text.sections;for(let Me=0;Me<c.length;Me++){const{tl:Je,tr:Fe,bl:tt,br:st,texPrimary:nt,texSecondary:lt,pixelOffsetTL:ft,pixelOffsetBR:vt,minFontScaleX:ct,minFontScaleY:Rt,glyphOffset:$t,isSDF:Nt,sectionIndex:hr}=c[Me],or=ie.vertexLength,Jt=$t[1];if(K2(le,z.x,z.y,Je.x,Jt+Je.y,nt.x,nt.y,p,Nt,ft.x,ft.y,ct,Rt),K2(le,z.x,z.y,Fe.x,Jt+Fe.y,nt.x+nt.w,nt.y,p,Nt,vt.x,ft.y,ct,Rt),K2(le,z.x,z.y,tt.x,Jt+tt.y,nt.x,nt.y+nt.h,p,Nt,ft.x,vt.y,ct,Rt),K2(le,z.x,z.y,st.x,Jt+st.y,nt.x+nt.w,nt.y+nt.h,p,Nt,vt.x,vt.y,ct,Rt),N){const{x:qt,y:Er,z:yr}=N.anchor,[br,Qr,pn]=N.up;Y2(ue,qt,Er,yr,br,Qr,pn),Y2(ue,qt,Er,yr,br,Qr,pn),Y2(ue,qt,Er,yr,br,Qr,pn),Y2(ue,qt,Er,yr,br,Qr,pn),X2(s.dynamicLayoutVertexArray,qt,Er,yr,we)}else X2(s.dynamicLayoutVertexArray,z.x,z.y,z.z,we);if(X){const qt=lt||nt;Z2(s.iconTransitioningVertexArray,qt.x,qt.y),Z2(s.iconTransitioningVertexArray,qt.x+qt.w,qt.y),Z2(s.iconTransitioningVertexArray,qt.x,qt.y+qt.h),Z2(s.iconTransitioningVertexArray,qt.x+qt.w,qt.y+qt.h)}Q.emplaceBack(or,or+1,or+2),Q.emplaceBack(or+1,or+2,or+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($t[0]),Me!==c.length-1&&hr===c[Me+1].sectionIndex||s.programConfigurations.populatePaintArrays(le.length,x,x.index,{},j,I,$,Ie&&Ie[hr])}const Ne=N?N.anchor:z;s.placedSymbolArray.emplaceBack(Ne.x,Ne.y,Ne.z,z.x,z.y,he,this.glyphOffsetArray.length-he,me,C,R,z.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],k,0,!1,0,L,0)}_commitLayoutVertex(s,c,p,v,m,x,k){s.emplaceBack(c,p,v,m,x,Math.round(k.x),Math.round(k.y))}_addCollisionDebugVertices(s,c,p,v,m,x,k){const N=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),z=N.vertexLength,C=k.tileAnchorX,R=k.tileAnchorY;for(let j=0;j<4;j++)p.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(p.collisionVertexArrayExt,c,s.padding,k.zOffset),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,C,R,new Pt(s.x1,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,C,R,new Pt(s.x2,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,C,R,new Pt(s.x2,s.y2)),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,C,R,new Pt(s.x1,s.y2)),N.vertexLength+=4;const L=p.indexArray;L.emplaceBack(z,z+1),L.emplaceBack(z+1,z+2),L.emplaceBack(z+2,z+3),L.emplaceBack(z+3,z),N.primitiveLength+=4}_addTextDebugCollisionBoxes(s,c,p,v,m,x){for(let k=v;k<m;k++){const N=p.get(k),z=this.getSymbolInstanceTextSize(s,x,c,k);this._addCollisionDebugVertices(N,z,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(s,c,p,v,m,x){for(let k=v;k<m;k++){const N=p.get(k),z=this.getSymbolInstanceIconSize(s,c,x.placedIconSymbolIndex);this._addCollisionDebugVertices(N,z,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,x)}}generateCollisionDebugBuffers(s,c,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new qC(df,Tz.members,Cs),this.iconCollisionBox=new qC(df,Tz.members,Cs);const v=M0(this.iconSizeData,s),m=M0(this.textSizeData,s,p);for(let x=0;x<this.symbolInstances.length;x++){const k=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(m,s,c,k.textBoxStartIndex,k.textBoxEndIndex,k),this._addTextDebugCollisionBoxes(m,s,c,k.verticalTextBoxStartIndex,k.verticalTextBoxEndIndex,k),this._addIconDebugCollisionBoxes(v,s,c,k.iconBoxStartIndex,k.iconBoxEndIndex,k),this._addIconDebugCollisionBoxes(v,s,c,k.verticalIconBoxStartIndex,k.verticalIconBoxEndIndex,k)}}getSymbolInstanceTextSize(s,c,p,v){const m=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:v),x=z2(this.textSizeData,s,m)/Eo;return this.tilePixelRatio*x}getSymbolInstanceIconSize(s,c,p){const v=this.icon.placedSymbolArray.get(p),m=z2(this.iconSizeData,s,v);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(s,c,p,v){s.emplaceBack(c,-p,-p,v),s.emplaceBack(c,p,-p,v),s.emplaceBack(c,p,p,v),s.emplaceBack(c,-p,p,v)}_updateTextDebugCollisionBoxes(s,c,p,v,m,x,k){for(let N=v;N<m;N++){const z=p.get(N),C=this.getSymbolInstanceTextSize(s,x,c,N);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,z.padding,x.zOffset)}}_updateIconDebugCollisionBoxes(s,c,p,v,m,x,k){for(let N=v;N<m;N++){const z=p.get(N),C=this.getSymbolInstanceIconSize(s,c,x.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,z.padding,x.zOffset)}}updateCollisionDebugBuffers(s,c,p,v){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=M0(this.iconSizeData,s,v),x=M0(this.textSizeData,s,p);for(let k=0;k<this.symbolInstances.length;k++){const N=this.symbolInstances.get(k);this._updateTextDebugCollisionBoxes(x,s,c,N.textBoxStartIndex,N.textBoxEndIndex,N,p),this._updateTextDebugCollisionBoxes(x,s,c,N.verticalTextBoxStartIndex,N.verticalTextBoxEndIndex,N,p),this._updateIconDebugCollisionBoxes(m,s,c,N.iconBoxStartIndex,N.iconBoxEndIndex,N,v),this._updateIconDebugCollisionBoxes(m,s,c,N.verticalIconBoxStartIndex,N.verticalIconBoxEndIndex,N,v)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,c,p,v,m,x,k,N,z){const C={};if(c<p){const{x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:he}=s.get(c);C.textBox={x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},C.textFeatureIndex=he}if(v<m){const{x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:he}=s.get(v);C.verticalTextBox={x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},C.verticalTextFeatureIndex=he}if(x<k){const{x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:he}=s.get(x);C.iconBox={x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},C.iconFeatureIndex=he}if(N<z){const{x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:he}=s.get(N);C.verticalIconBox={x1:R,y1:L,x2:j,y2:I,padding:$,projectedAnchorX:X,projectedAnchorY:Q,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},C.verticalIconFeatureIndex=he}return C}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const p=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(s,c){const p=s.placedSymbolArray.get(c),v=p.vertexStartIndex+4*p.numGlyphs;for(let m=p.vertexStartIndex;m<v;m+=4)s.indexArray.emplaceBack(m,m+1,m+2),s.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(s),p=Math.cos(s),v=[],m=[],x=[];for(let k=0;k<this.symbolInstances.length;++k){x.push(k);const N=this.symbolInstances.get(k);v.push(0|Math.round(c*N.tileAnchorX+p*N.tileAnchorY)),m.push(N.featureIndex)}return x.sort((k,N)=>v[k]-v[N]||m[N]-m[k]),x}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let s=0;s<this.symbolInstances.length;++s)this.symbolInstanceIndexesSortedZOffset.push(s)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((s,c)=>this.symbolInstances.get(c).zOffset-this.symbolInstances.get(s).zOffset)}addToSortKeyRanges(s,c){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===c?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const p=this.symbolInstances.get(c);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:k,placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:z}=p;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),m>=0&&m!==v&&this.addIndicesForPlacedSymbol(this.text,m),x>=0&&x!==m&&x!==v&&this.addIndicesForPlacedSymbol(this.text,x),k>=0&&this.addIndicesForPlacedSymbol(this.text,k),N>=0&&this.addIndicesForPlacedSymbol(this.icon,N),z>=0&&this.addIndicesForPlacedSymbol(this.icon,z)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let iF,aF,GC;mr(J2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),J2.addDynamicAttributes=X2;class sF{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Iu,this.defaultValue=s}evaluate(s){if(s.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(s.formattedSection))return c.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}mr(sF,"FormatSectionOverride",{omit:["defaultValue"]});const WC=()=>GC||(GC={layout:iF||(iF=new $i({"symbol-placement":new Xt(xt.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(xt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(xt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ur(xt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(xt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Xt(xt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Xt(xt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Xt(xt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xt(xt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(xt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(xt.layout_symbol["icon-rotation-alignment"]),"icon-size":new ur(xt.layout_symbol["icon-size"]),"icon-size-scale-range":new Xt(xt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new ur(xt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ur(xt.layout_symbol["icon-text-fit-padding"]),"icon-image":new ur(xt.layout_symbol["icon-image"]),"icon-rotate":new ur(xt.layout_symbol["icon-rotate"]),"icon-padding":new Xt(xt.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(xt.layout_symbol["icon-keep-upright"]),"icon-offset":new ur(xt.layout_symbol["icon-offset"]),"icon-anchor":new ur(xt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(xt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(xt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(xt.layout_symbol["text-rotation-alignment"]),"text-field":new ur(xt.layout_symbol["text-field"]),"text-font":new ur(xt.layout_symbol["text-font"]),"text-size":new ur(xt.layout_symbol["text-size"]),"text-size-scale-range":new Xt(xt.layout_symbol["text-size-scale-range"]),"text-max-width":new ur(xt.layout_symbol["text-max-width"]),"text-line-height":new ur(xt.layout_symbol["text-line-height"]),"text-letter-spacing":new ur(xt.layout_symbol["text-letter-spacing"]),"text-justify":new ur(xt.layout_symbol["text-justify"]),"text-radial-offset":new ur(xt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(xt.layout_symbol["text-variable-anchor"]),"text-anchor":new ur(xt.layout_symbol["text-anchor"]),"text-max-angle":new Xt(xt.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(xt.layout_symbol["text-writing-mode"]),"text-rotate":new ur(xt.layout_symbol["text-rotate"]),"text-padding":new Xt(xt.layout_symbol["text-padding"]),"text-keep-upright":new Xt(xt.layout_symbol["text-keep-upright"]),"text-transform":new ur(xt.layout_symbol["text-transform"]),"text-offset":new ur(xt.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(xt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xt(xt.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(xt.layout_symbol["text-optional"]),visibility:new Xt(xt.layout_symbol.visibility)})),paint:aF||(aF=new $i({"icon-opacity":new ur(xt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new ur(xt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new ur(xt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new ur(xt.paint_symbol["text-emissive-strength"]),"icon-color":new ur(xt.paint_symbol["icon-color"]),"icon-halo-color":new ur(xt.paint_symbol["icon-halo-color"]),"icon-halo-width":new ur(xt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ur(xt.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(xt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(xt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new ur(xt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new ur(xt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new ur(xt.paint_symbol["text-occlusion-opacity"]),"text-color":new ur(xt.paint_symbol["text-color"],{runtimeType:hs,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new ur(xt.paint_symbol["text-halo-color"]),"text-halo-width":new ur(xt.paint_symbol["text-halo-width"]),"text-halo-blur":new ur(xt.paint_symbol["text-halo-blur"]),"text-translate":new Xt(xt.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(xt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Xt(xt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Xt(xt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Xt(xt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Xt(xt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new ur(xt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},GC);class Q2 extends fi{constructor(s,c,p,v){super(s,WC(),c,p,v),this._colorAdjustmentMatrix=De.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=s.paint!==void 0&&("icon-occlusion-opacity"in s.paint||"text-occlusion-opacity"in s.paint)}recalculate(s,c){super.recalculate(s,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const m of p)v.indexOf(m)<0&&v.push(m);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(s,c,p,v){return this._saturation===s&&this._contrast===c&&this._brightnessMin===p&&this._brightnessMax===v||(this._colorAdjustmentMatrix=function(m,x,k,N){m=Ns(m),x=Pa(x);const z=De.mat4.create(),C=m/3,R=1-2*C,L=[R,C,C,0,C,R,C,0,C,C,R,0,0,0,0,1],j=.5-.5*x,I=N-k;return De.mat4.multiply(z,[I,0,0,0,0,I,0,0,0,0,I,0,k,k,k,1],[x,0,0,0,0,x,0,0,0,0,x,0,j,j,j,1]),De.mat4.multiply(z,z,L),z}(s,c,p,v),this._saturation=s,this._contrast=c,this._brightnessMin=p,this._brightnessMax=v),this._colorAdjustmentMatrix}getValueAndResolveTokens(s,c,p,v){const m=this.layout.get(s).evaluate(c,{},p,v),x=this._unevaluatedLayout._values[s];return x.isDataDriven()||Wd(x.value)||!m?m:function(k,N){return N.replace(/{([^{}]+)}/g,(z,C)=>C in k?String(k[C]):"")}(c.properties,m)}createBucket(s){return new J2(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of WC().paint.overridableProperties){if(!Q2.hasPaintOverride(this.layout,s))continue;const c=this.paint.get(s),p=new sF(c),v=new Gd(p,c.property.specification,this.scope,this.options);let m=null;m=c.value.kind==="constant"||c.value.kind==="source"?new Hd("source",v):new Kd("composite",v,c.value.zoomStops,c.value._interpolationType),this.paint._values[s]=new Xu(c.property,m,c.parameters)}}_handleOverridablePaintPropertyUpdate(s,c,p){return!(!this.layout||c.isDataDriven()||p.isDataDriven())&&Q2.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,c){const p=s.get("text-field"),v=WC().paint.properties[c];let m=!1;const x=k=>{for(const N of k)if(v.overrides&&v.overrides.hasOverride(N))return void(m=!0)};if(p.value.kind==="constant"&&p.value.value instanceof As)x(p.value.value.sections);else if(p.value.kind==="source"){const k=z=>{m||(z instanceof ka&&ta(z.value)===Bo?x(z.value.sections):z instanceof Wc?x(z.sections):z.eachChild(k))},N=p.value;N._styleExpression&&k(N._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(s,c,p){return{config:new su(this,{zoom:c,lut:p}),overrideFog:!1}}}let oF,lF,cF,uF;var HC=Qn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function KC(h){switch(h){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function ZC(h){switch(h){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class YC{constructor(s,c,p,v){this.context=s,this.format=p,this.useMipmap=v&&v.useMipmap,this.texture=s.gl.createTexture(),this.update(c,{premultiply:v&&v.premultiply})}update(s,c){const p=s&&s instanceof HTMLVideoElement&&s.width===0?s.videoWidth:s.width,v=s&&s instanceof HTMLVideoElement&&s.height===0?s.videoHeight:s.height,{context:m}=this,{gl:x}=m,{x:k,y:N}=c&&c.position?c.position:{x:0,y:0},z=k+p,C=N+v;!this.size||this.size[0]===z&&this.size[1]===C||(x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(this.texture),this.texture=x.createTexture(),this.size=null),x.bindTexture(x.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA8&&(!c||c.premultiply!==!1));const R=s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap;if(!this.size&&z>0&&C>0){const L=this.useMipmap?Math.floor(Math.log2(Math.max(z,C)))+1:1;x.texStorage2D(x.TEXTURE_2D,L,this.format,z,C),this.size=[z,C]}if(this.size)if(R)x.texSubImage2D(x.TEXTURE_2D,0,k,N,KC(this.format),ZC(this.format),s);else{const L=s.data;L&&x.texSubImage2D(x.TEXTURE_2D,0,k,N,p,v,KC(this.format),ZC(this.format),L)}this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(s,c,p=!1){const{context:v}=this,{gl:m}=v;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!p?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrapS=c)}bindExtraParam(s,c,p,v){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),c!==this.magFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,c),this.magFilter=c),s!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap?s===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),p!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,p),this.wrapS=p),v!==this.wrapT&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,v),this.wrapT=v)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class eS{constructor(s,c){this.context=s,this.texture=c}bind(s,c){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,s),this.minFilter=s),c!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,c),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,c),this.wrapS=c)}}function tS(h,s,c,p,v,m,x,k){const N=[h,s,1,c,p,1,v,m,1],z=[x,k,1],C=De.mat3.adjoint([],N),[R,L,j]=De.vec3.transformMat3(z,z,C);return De.mat3.multiply(N,N,[R,0,0,0,L,0,0,0,j])}function dF(h,s,c,p,v,m,x,k){const N=function(z,C,R,L,j,I,$,X){const Q=tS(0,0,1,0,1,1,0,1),le=tS(z,C,R,L,j,I,$,X),ue=De.mat3.adjoint([],Q);return De.mat3.multiply(le,le,ue)}(h,s,c,p,v,m,x,k);return[N[2]/N[8]/lr,N[5]/N[8]/lr]}function rS(h){return[h[0],Math.min(Math.max(h[1],-85.051129),Zs)]}class hF extends Uc{constructor(s,c,p,v){super(),this.id=s,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(v),this.options=c,this._dirty=!1}load(s,c){if(this._loaded=c||!1,this.fire(new vi("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return s&&(this.coordinates=s),this._loaded=!0,void this._finishLoading();this._imageRequest=Wh(this.map._requestManager.transformRequest(this.url,En.Image),(p,v)=>{this._imageRequest=null,this._loaded=!0,p?this.fire(new cp(p)):v&&(this.image=v instanceof HTMLImageElement?He.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}setTexture(s){if(!(s.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new eS(this.map.painter.context,s.handle),this.width=s.dimensions[0],this.height=s.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new vi("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(s){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof eS||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(s){if(this.coordinates=s,this._boundsArray=void 0,this._unsupportedCoords=!1,!s.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let c=s[0][1],p=s[0][1];for(const m of s)m[1]>p&&(p=m[1]),m[1]<c&&(c=m[1]);const v=(p+c)/2;if(v>Zs?this.onNorthPole=!0:v<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=s.map(d.fromLngLat);this.tileID=function(x){let k=1/0,N=1/0,z=-1/0,C=-1/0;for(const $ of x)k=Math.min(k,$.x),N=Math.min(N,$.y),z=Math.max(z,$.x),C=Math.max(C,$.y);const R=Math.max(z-k,C-N),L=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),j=Math.pow(2,L);let I=Math.floor((k+z)/2*j);return I>1&&(I-=1),new Bt(L,I,Math.floor((N+C)/2*j))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new vi("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(s){for(const Q in this.tiles){const le=this.tiles[Q];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const c=lb(new Bt(0,0,0),this.map.transform.projection),p=[c.projection.project(this.coordinates[0][0],this.coordinates[0][1]),c.projection.project(this.coordinates[1][0],this.coordinates[1][1]),c.projection.project(this.coordinates[2][0],this.coordinates[2][1]),c.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(Q){const le=Q[1].x-Q[0].x,ue=Q[1].y-Q[0].y,ie=Q[2].x-Q[1].x,he=Q[2].y-Q[1].y,me=Q[3].x-Q[2].x,we=Q[3].y-Q[2].y,Ie=Q[0].x-Q[3].x,Ne=Q[0].y-Q[3].y,Me=le*he-ie*ue,Je=ie*we-me*he,Fe=me*Ne-Ie*we,tt=Ie*ue-le*Ne;return Me>0&&Je>0&&Fe>0&&tt>0||Me<0&&Je<0&&Fe<0&&tt<0}(p))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const v=lb(this.tileID,this.map.transform.projection),[m,x,k,N]=this.coordinates.map(Q=>{const le=v.projection.project(Q[0],Q[1]);return Jz(v,le)._round()});this.perspectiveTransform=dF(m.x,m.y,x.x,x.y,k.x,k.y,N.x,N.y);const z=this._boundsArray=new ua;z.emplaceBack(m.x,m.y,0,0),z.emplaceBack(x.x,x.y,lr,0),z.emplaceBack(N.x,N.y,0,lr),z.emplaceBack(k.x,k.y,lr,lr),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=s.createVertexBuffer(z,HC.members),this.boundsSegments=ya.simpleSegment(0,0,4,2);const C=[],R=[rS((L=this.coordinates)[0]),rS(L[1]),rS(L[2]),rS(L[3])];var L;const[j,I,$,X]=function(Q){let le=Q[0][0],ue=le,ie=Q[0][1],he=ie;for(let me=1;me<Q.length;me++)Q[me][0]<le?le=Q[me][0]:Q[me][0]>ue&&(ue=Q[me][0]),Q[me][1]<ie?ie=Q[me][1]:Q[me][1]>he&&(he=Q[me][1]);return[le,ie,ue-le,he-ie]}(R);{const Q=new ua,[le,ue,ie,he]=function(ft){let vt=ft[0].x,ct=vt,Rt=ft[0].y,$t=Rt;for(let Nt=1;Nt<ft.length;Nt++)ft[Nt].x<vt?vt=ft[Nt].x:ft[Nt].x>ct&&(ct=ft[Nt].x),ft[Nt].y<Rt?Rt=ft[Nt].y:ft[Nt].y>$t&&($t=ft[Nt].y);return[vt,Rt,ct-vt,$t-Rt]}(p),me=ft=>[(ft.x-le)/ie,(ft.y-ue)/he],[we,Ie,Ne,Me]=p.map(me),Je=function(ft,vt,ct,Rt,$t,Nt,hr,or){const Jt=tS(0,0,1,0,1,1,0,1),qt=tS(ft,vt,ct,Rt,$t,Nt,hr,or),Er=De.mat3.adjoint([],qt);return De.mat3.multiply(Jt,Jt,Er)}(we[0],we[1],Ie[0],Ie[1],Ne[0],Ne[1],Me[0],Me[1]);this.elevatedGlobePerspectiveTransform=dF(we[0],we[1],Ie[0],Ie[1],Ne[0],Ne[1],Me[0],Me[1]);const Fe=(ft,vt)=>{C.push(ft.lng);const ct=Math.round((ft.lng-j)/$*lr),Rt=Math.round((ft.lat-I)/X*lr),$t=me(vt),Nt=De.vec3.transformMat3([],[$t[0],$t[1],1],Je),hr=Math.round(Nt[0]/Nt[2]*lr),or=Math.round(Nt[1]/Nt[2]*lr);Q.emplaceBack(ct,Rt,hr,or)},tt=p[3].x-p[0].x,st=p[3].y-p[0].y,nt=p[2].x-p[1].x,lt=p[2].y-p[1].y;for(let ft=0;ft<65;ft++){const vt=ft/64,ct=[p[0].x+vt*tt,p[0].y+vt*st],Rt=[p[1].x+vt*nt,p[1].y+vt*lt],$t=Rt[0]-ct[0],Nt=Rt[1]-ct[1];for(let hr=0;hr<65;hr++){const or=hr/64,Jt={x:ct[0]+$t*or,y:ct[1]+Nt*or};Fe(c.projection.unproject(Jt.x,Jt.y),Jt)}}this.elevatedGlobeVertexBuffer=s.createVertexBuffer(Q,HC.members)}{this.maxLongitudeTriangleSize=0;let Q=[],le=new ms;const ue=(ie,he,me)=>{le.emplaceBack(ie,he,me);const we=C[ie],Ie=C[he],Ne=C[me],Me=Math.min(Math.min(we,Ie),Ne),Je=Math.max(Math.max(we,Ie),Ne)-Me;Je>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Je),Q.push(Me+Je/2)};for(let ie=0;ie<64;ie++)for(let he=0;he<64;he++){const me=65*ie+he,we=me+1,Ie=me+65,Ne=Ie+1;ue(me,Ie,we),ue(we,Ie,Ne)}[Q,le]=function(ie,he){const me=Array.from({length:ie.length},(Ne,Me)=>Me);me.sort((Ne,Me)=>ie[Ne]-ie[Me]);const we=[],Ie=new ms;for(let Ne=0;Ne<me.length;Ne++){const Me=me[Ne];we.push(ie[Me]);const Je=3*Me,Fe=Je+1;Ie.emplaceBack(he.uint16[Je],he.uint16[Fe],he.uint16[Fe+1])}return[we,Ie]}(Q,le),this.elevatedGlobeTrianglesCenterLongitudes=Q,this.elevatedGlobeIndexBuffer=s.createIndexBuffer(le)}this.elevatedGlobeSegments=ya.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,$/lr,0,X/lr,0,0,I,j,0])}prepare(){const s=Object.keys(this.tiles).length!==0;if(this.tileID&&!s)return;const c=this.map.painter.context,p=c.gl;!this._dirty||this.texture instanceof eS||(this.texture?this.texture.update(this.image):(this.texture=new YC(c,this.image,p.RGBA8),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),s&&this._prepareData(c)}loadTile(s,c){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},c(null)):(s.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(s){const c=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!c)return null;const p=this.elevatedGlobeTrianglesCenterLongitudes;let v=(m=s+180)+360*Math.round((p[0]-m)/360);var m;const x=new ya,k=(R,L)=>{x.segments.push({vertexOffset:0,primitiveOffset:R,vertexLength:c.segments[0].vertexLength,primitiveLength:L,sortKey:void 0,vaos:{}})},N=.51*this.maxLongitudeTriangleSize;if(Math.abs(p[0]-v)<=N){const R=bl(p,0,p.length,v+N);return R===p.length||k(R,ws(p,R+1,p.length,v+360-N)-R),x}v<p[0]&&(v+=360);const z=ws(p,0,p.length,v-N);if(z===p.length)return k(0,p.length),x;k(0,z-0);const C=bl(p,z+1,p.length,v+N);return C!==p.length&&k(C,p.length-C),x}}const Yie=(Math.pow(256,2)-1)/16907520;class fF extends fi{constructor(s,c,p,v){super(s,{layout:cF||(cF=new $i({visibility:new Xt(xt.layout_raster.visibility)})),paint:uF||(uF=new $i({"raster-opacity":new Xt(xt.paint_raster["raster-opacity"]),"raster-color":new jl(xt.paint_raster["raster-color"]),"raster-color-mix":new Xt(xt.paint_raster["raster-color-mix"]),"raster-color-range":new Xt(xt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Xt(xt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(xt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(xt.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(xt.paint_raster["raster-saturation"]),"raster-contrast":new Xt(xt.paint_raster["raster-contrast"]),"raster-resampling":new Xt(xt.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(xt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Xt(xt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Xt(xt.paint_raster["raster-array-band"]),"raster-elevation":new Xt(xt.paint_raster["raster-elevation"]),"raster-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},c,p,v),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(s){return!(s&&s._source instanceof hF&&(s._source.onNorthPole||s._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(s){s!=="raster-color"&&s!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(s){if(!this.hasColorMap()||!this._curRampRange)return;const c=this._transitionablePaint._values["raster-color"].value.expression,[p,v]=s||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(p)&&isNaN(v)||p===this._curRampRange[0]&&v===this._curRampRange[1]||(this.colorRamp=ug({expression:c,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:p,end:v}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[p,v])}}let pF,mF,gF,yF,vF;class xF extends fi{constructor(s,c,p,v){super(s,{layout:pF||(pF=new $i({visibility:new Xt(xt["layout_raster-particle"].visibility)})),paint:mF||(mF=new $i({"raster-particle-array-band":new Xt(xt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Xt(xt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new jl(xt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Xt(xt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Xt(xt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Xt(xt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Xt(xt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Xt(xt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},c,p,v),this._updateColorRamp(),this.lastInvalidatedAt=He.now()}onRemove(s){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(s){return!1}_handleSpecialPaintPropertyUpdate(s){s!=="raster-particle-color"&&s!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),s==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const s=this._transitionablePaint._values["raster-particle-color"].value.expression,c=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=ug({expression:s,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:c}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=He.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Xie extends fi{constructor(s,c){super(s,{},c,null),this.implementation=s,s.slot&&(this.slot=s.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(s){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}function XC(h,s,c){const p=[0,0,1],v=De.quat.identity([]);return De.quat.rotateY(v,v,c?-et(h)+Math.PI:et(h)),De.quat.rotateX(v,v,-et(s)),De.vec3.transformQuat(p,p,v),De.vec3.normalize(p,p)}function _F(h,s){const c=nS(h.projection,h.zoom,h.width,h.height),p=function(m,x,k,N,z){const C=new Kn(k.lng-180*yg,k.lat),R=new Kn(k.lng+180*yg,k.lat),L=m.project(C.lng,C.lat),j=m.project(R.lng,R.lat),I=-Math.atan2(j.y-L.y,j.x-L.x),$=d.fromLngLat(k);$.y=ar($.y,-1+yg,1-yg);const X=$.toLngLat(),Q=m.project(X.lng,X.lat),le=d.fromLngLat(X);le.x+=yg;const ue=le.toLngLat(),ie=m.project(ue.lng,ue.lat),he=wF(ie.x-Q.x,ie.y-Q.y,I),me=d.fromLngLat(X);me.y+=yg;const we=me.toLngLat(),Ie=m.project(we.lng,we.lat),Ne=wF(Ie.x-Q.x,Ie.y-Q.y,I),Me=Math.abs(he.x)/Math.abs(Ne.y),Je=De.mat4.identity([]);De.mat4.rotateZ(Je,Je,-I*(1-(z?0:N)));const Fe=De.mat4.identity([]);return De.mat4.scale(Fe,Fe,[1,1-(1-Me)*N,1]),Fe[4]=-Ne.x/Ne.y*N,De.mat4.rotateZ(Fe,Fe,I),De.mat4.multiply(Fe,Je,Fe),Fe}(h.projection,0,h.center,c,s),v=bF(h);return De.mat4.scale(p,p,[v,v,1]),p}function bF(h){const s=h.projection,c=nS(h.projection,h.zoom,h.width,h.height),p=JC(s,h.center),v=JC(s,Kn.convert(s.center));return Math.pow(2,p*c+(1-c)*v)}function nS(h,s,c,p,v=1/0){const m=h.range;if(!m)return 0;const x=Math.min(v,Math.max(c,p)),k=Math.log(x/1024)/Math.LN2;return tn(m[0]+k,m[1]+k,s)}const yg=1/4e4;function JC(h,s){const c=ar(s.lat,-85.051129,Zs),p=new Kn(s.lng-180*yg,c),v=new Kn(s.lng+180*yg,c),m=h.project(p.lng,c),x=h.project(v.lng,c),k=d.fromLngLat(p),N=d.fromLngLat(v),z=x.x-m.x,C=x.y-m.y,R=N.x-k.x,L=N.y-k.y,j=Math.sqrt((R*R+L*L)/(z*z+C*C));return Math.log(j)/Math.LN2}function wF(h,s,c){const p=Math.cos(c),v=Math.sin(c);return{x:h*p-s*v,y:h*v+s*p}}function SF(h,s,c){De.mat4.identity(h),De.mat4.rotateZ(h,h,et(s[2])),De.mat4.rotateX(h,h,et(s[0])),De.mat4.rotateY(h,h,et(s[1])),De.mat4.scale(h,h,c),De.mat4.multiply(h,h,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function iS(h,s,c,p,v,m,x,k){const N=[c[0]-s[0],c[1]-s[1],0],z=[p[0]-s[0],p[1]-s[1],0];if(De.vec3.length(N)<1e-12||De.vec3.length(z)<1e-12)return De.quat.identity(h);const C=De.vec3.cross([],N,z);De.vec3.normalize(C,C),De.vec3.subtract(z,p,s),N[2]=(m-v)*k,z[2]=(x-v)*k;const R=N;return De.vec3.cross(R,N,z),De.vec3.normalize(R,R),De.quat.rotationTo(h,C,R)}function QC(h,s,c=!1){const p=Po(s.zoom),v=function(m,x,k){const N=x.worldSize,z=[m[12],m[13],m[14]],C=Fr(z[1]/N),R=Xo(z[0]/N),L=De.mat4.identity([]),j=qi(1,C)*N,I=qi(1,0)*N*Sf(C,x.zoom),$=1/Ds(N);let X=I*$;if(k){const ie=nS(x.projection,x.zoom,x.width,x.height,1024);X=$*x.projection.pixelSpaceConversion(x.center.lat,N,ie)}const Q=lh(C,R);De.vec3.add(Q,Q,De.vec3.scale([],De.vec3.normalize([],Q),j*X*z[2]));const le=function(ie){const he=[ie[0],ie[1],ie[2]];let me=[0,1,0];const we=De.vec3.cross([],me,he);return De.vec3.cross(me,he,we),De.vec3.squaredLength(me)===0&&(me=[0,1,0],De.vec3.cross(we,he,me)),De.vec3.normalize(we,we),De.vec3.normalize(me,me),De.vec3.normalize(he,he),[we[0],we[1],we[2],0,me[0],me[1],me[2],0,he[0],he[1],he[2],0,ie[0],ie[1],ie[2],1]}(Q);De.mat4.scale(L,L,[X,X,X*j]),De.mat4.translate(L,L,[-z[0],-z[1],-z[2]]);const ue=De.mat4.multiply([],x.globeMatrix,le);return De.mat4.multiply(ue,ue,L),De.mat4.multiply(ue,ue,m),ue}(h,s,c);if(p>0){const m=function(x,k){const N=k.worldSize,z=qi(1,0)*N*Sf(k.center.lat,k.zoom)/Ds(N),C=qi(1,k.center.lat)*N,R=De.mat4.identity([]);return De.mat4.rotateY(R,R,et(k.center.lng)),De.mat4.rotateX(R,R,et(k.center.lat)),De.mat4.translate(R,R,[0,0,Ks]),De.mat4.scale(R,R,[z,z,z*C]),De.mat4.translate(R,R,[k.point.x-.5*N,k.point.y-.5*N,0]),De.mat4.multiply(R,R,x),De.mat4.multiply(R,k.globeMatrix,R)}(h,s);return function(x,k,N){const z=(I,$,X)=>{const Q=De.vec3.length(I),le=De.vec3.length($),ue=ba(I,$,X);return De.vec3.scale(ue,ue,1/De.vec3.length(ue)*Lr(Q,le,X))},C=z([x[0],x[1],x[2]],[k[0],k[1],k[2]],N),R=z([x[4],x[5],x[6]],[k[4],k[5],k[6]],N),L=z([x[8],x[9],x[10]],[k[8],k[9],k[10]],N),j=ba([x[12],x[13],x[14]],[k[12],k[13],k[14]],N);return[C[0],C[1],C[2],0,R[0],R[1],R[2],0,L[0],L[1],L[2],0,j[0],j[1],j[2],1]}(v,m,p)}return v}function AF(h,s,c,p){const v=Sr.projectAabbCorners(p,c);let m=Number.MAX_VALUE,x=-1;for(let z=0;z<v.length;++z){const C=v[z];C[0]=(.5*C[0]+.5)*s.width,C[1]=(.5-.5*C[1])*s.height,C[2]<m&&(x=z,m=C[2])}const k=z=>new Pt(v[z][0],v[z][1]);let N;switch(x){case 0:case 6:N=[k(1),k(5),k(4),k(7),k(3),k(2),k(1)];break;case 1:case 7:N=[k(0),k(4),k(5),k(6),k(2),k(3),k(0)];break;case 3:case 5:N=[k(1),k(0),k(4),k(7),k(6),k(2),k(1)];break;default:N=[k(1),k(5),k(6),k(7),k(3),k(0),k(1)]}if(fe(h,N))return m}const Jie=Qn([{name:"a_pos_3f",components:3,type:"Float32"}]),Qie=Qn([{name:"a_color_3f",components:3,type:"Float32"}]),eae=Qn([{name:"a_color_4f",components:4,type:"Float32"}]),tae=Qn([{name:"a_uv_2f",components:2,type:"Float32"}]),rae=Qn([{name:"a_normal_3f",components:3,type:"Float32"}]),nae=Qn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),iae=Qn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),TF={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class aS{constructor(s,c,p,v){this.message=(s?`${s}: `:"")+p,v&&(this.identifier=v),c!=null&&c.__line__&&(this.line=c.__line__)}}function PF(h,s){const c=h.indexOf("://")===-1;try{return new URL(h,c&&s?"http://example.com":void 0),!0}catch{return!1}}class CF{constructor(s,c){this.feature=s,this.instancedDataOffset=c,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class EF{constructor(){this.instancedDataArray=new mf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class eE{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(c=>c.fqid),this.projection=s.projection,this.index=s.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(s,c){}populate(s,c,p,v){this.tileToMeter=o(p);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:x,id:k,index:N,sourceLayerIndex:z}of s){const C=k??(x.properties&&x.properties.hasOwnProperty("id")?x.properties.id:void 0),R=te(x,m);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),R,p))continue;const L={id:C,sourceLayerIndex:z,index:N,geometry:m?R.geometry:Y(x,p,v),properties:x.properties,type:x.type,patterns:{}},j=this.addFeature(L,L.geometry,R);j&&c.featureIndex.insert(x,L.geometry,N,z,this.index,this.instancesPerModel[j].instancedDataArray.length,lr/32)}this.lookup=null}update(s,c,p,v){for(const m in this.instancesPerModel){const x=this.instancesPerModel[m];for(const k in s)x.idToFeaturesIndex.hasOwnProperty(k)&&(this.evaluate(x.features[x.idToFeaturesIndex[k]],s[k],x,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let s=!1;for(const c in this.instancesPerModel){const p=this.instancesPerModel[c];for(const v of p.features){const m=this.layers[0],x=v.feature,k=this.canonical,N=m.paint.get("model-rotation").evaluate(x,{},k),z=m.paint.get("model-scale").evaluate(x,{},k),C=m.paint.get("model-translation").evaluate(x,{},k);De.vec3.exactEquals(v.rotation,N)&&De.vec3.exactEquals(v.scale,z)&&De.vec3.exactEquals(v.translation,C)||(this.evaluate(v,v.featureStates,p,!0),s=!0)}}return s}updateReplacement(s,c,p,v){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const m=c.getReplacementRegionsForTile(s.toUnwrapped(),!0);if(TC(this.activeReplacements,m))return!1;this.activeReplacements=m;let x=!1;for(const k in this.instancesPerModel){const N=this.instancesPerModel[k],z=N.instancedDataArray;for(const C of N.features){const R=C.instancedDataOffset,L=C.instancedDataCount;for(let j=0;j<L;j++){const I=16*(j+R);let $=z.float32[I+0];const X=$>lr;$=X?$-lr:$;const Q=Math.floor($),le=z.float32[I+1];let ue=!1;for(const ie of this.activeReplacements)if(!$4(ie,p,TF.Model,v)&&!(ie.min.x>Q||Q>ie.max.x||ie.min.y>le||le>ie.max.y)&&(ue=Z4(K4(Q,le,s.canonical,ie.footprintTileId.canonical),ie.footprint),ue))break;z.float32[I]=ue?$+lr:$,x=x||ue!==X}}}return x}isEmpty(){for(const s in this.instancesPerModel)if(this.instancesPerModel[s].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(s){if(!this.uploaded)for(const c in this.instancesPerModel){const p=this.instancesPerModel[c];p.instancedDataArray.length<0||p.instancedDataArray.length===0||(p.instancedDataBuffer?p.instancedDataBuffer.updateData(p.instancedDataArray):p.instancedDataBuffer=s.createVertexBuffer(p.instancedDataArray,nae.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const c in this.instancesPerModel){const p=this.instancesPerModel[c];p.instancedDataArray.length!==0&&p.instancedDataBuffer&&p.instancedDataBuffer.destroy()}const s=this.layers[0].modelManager;if(s&&this.modelUris)for(const c of this.modelUris)s.removeModel(c,"")}addFeature(s,c,p){const v=this.layers[0],m=v.layout.get("model-id").evaluate(p,{},this.canonical);if(!m)return an(`modelId is not evaluated for layer ${v.id} and it is not going to get rendered.`),m;PF(m,!1)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new EF);const x=this.instancesPerModel[m],k=x.instancedDataArray,N=new CF(p,k.length);for(const z of c)for(const C of z){if(C.x<0||C.x>=lr||C.y<0||C.y>=lr)continue;const R=(this.lookupDim-1)/lr,L=this.lookupDim*(C.y*R|0)+C.x*R|0;if(this.lookup){if(this.lookup[L]!==0)continue;this.lookup[L]=1}this.instanceCount++;const j=k.length;k.resize(j+1),x.instancesEvaluatedElevation.push(0),k.float32[16*j]=C.x,k.float32[16*j+1]=C.y}return N.instancedDataCount=x.instancedDataArray.length-N.instancedDataOffset,N.instancedDataCount>0&&(s.id&&(x.idToFeaturesIndex[s.id]=x.features.length),x.features.push(N),this.evaluate(N,{},x,!1)),m}getModelUris(){return this.modelUris}evaluate(s,c,p,v){const m=this.layers[0],x=s.feature,k=this.canonical,N=s.rotation=m.paint.get("model-rotation").evaluate(x,c,k),z=s.scale=m.paint.get("model-scale").evaluate(x,c,k),C=s.translation=m.paint.get("model-translation").evaluate(x,c,k),R=m.paint.get("model-color").evaluate(x,c,k);R.a=m.paint.get("model-color-mix-intensity").evaluate(x,c,k);const L=[];this.maxVerticalOffset<C[2]&&(this.maxVerticalOffset=C[2]),this.maxScale=Math.max(Math.max(this.maxScale,z[0]),Math.max(z[1],z[2])),SF(L,N,z);const j=Math.round(100*R.a)+R.b/1.05;for(let I=0;I<s.instancedDataCount;++I){const $=s.instancedDataOffset+I,X=16*$,Q=p.instancedDataArray.float32;let le=0;v&&(le=Q[X+6]-p.instancesEvaluatedElevation[$]);const ue=0|Q[X+1];Q[X]=(0|Q[X])+R.r/1.05,Q[X+1]=ue+R.g/1.05,Q[X+2]=j,Q[X+3]=1/(k.z>10?this.tileToMeter:o(k,ue)),Q[X+4]=C[0],Q[X+5]=C[1],Q[X+6]=C[2]+le,Q[X+7]=L[0],Q[X+8]=L[1],Q[X+9]=L[2],Q[X+10]=L[4],Q[X+11]=L[5],Q[X+12]=L[6],Q[X+13]=L[8],Q[X+14]=L[9],Q[X+15]=L[10],p.instancesEvaluatedElevation[$]=C[2]}}}let kF,MF;mr(eE,"ModelBucket",{omit:["layers"]}),mr(EF,"PerModelAttributes"),mr(CF,"ModelFeature");const Ky=64,I0={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function jF(h,s,c,p,v,m,x,k,N,z=!1){const C=c.zoom,R=c.project(p),L=Sf(p.lat,C),j=1/L;De.mat4.identity(h),De.mat4.translate(h,h,[R.x+x[0]*j,R.y+x[1]*j,x[2]]);let I=1,$=1;const X=c.worldSize;if(z){if(c.projection.name==="mercator"){let ie=0;c.elevation&&(ie=c.elevation.getAtPointOrZero(new d(R.x/X,R.y/X),0));const he=De.vec4.transformMat4([],[R.x,R.y,ie,1],c.projMatrix)[3]/c.cameraToCenterDistance;I=he,$=he*Sf(c.center.lat,C)}else if(c.projection.name==="globe"){const ie=QC(h,c),he=De.mat4.multiply([],c.projMatrix,ie),me=[0,0,0,1];De.vec4.transformMat4(me,me,he);const we=me[3]/c.cameraToCenterDistance,Ie=Po(C),Ne=c.projection.pixelsPerMeter(p.lat,X)*Sf(p.lat,C),Me=c.projection.pixelsPerMeter(c.center.lat,X)*Sf(c.center.lat,C);I=we/Lr(Ne,lg(c.center.lat),Ie),$=we*L/Ne,I*=Me,$*=Me}}else I=j;De.mat4.scale(h,h,[I,I,$]);const Q=[...h],le=s.orientation,ue=[];if(SF(ue,[le[0]+v[0],le[1]+v[1],le[2]+v[2]],m),De.mat4.multiply(h,Q,ue),k&&c.elevation){let ie=0;const he=[];if(N&&c.elevation){ie=function(Ie,Ne,Me,Je,Fe){const tt=Ne.elevation;if(!tt)return 0;const st=Sr.projectAabbCorners(Me,Je),nt=qi(1,Fe.lat)*Ne.worldSize,lt=function(Er,yr){const br=[0,0,1],Qr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const pn of Qr){const vn=Er[pn.corners[0]],xn=Er[pn.corners[1]],jn=Er[pn.corners[2]],In=[xn[0]-vn[0],xn[1]-vn[1],yr*(xn[2]-vn[2])],Li=De.vec3.cross(In,In,[jn[0]-vn[0],jn[1]-vn[1],yr*(jn[2]-vn[2])]);De.vec3.normalize(Li,Li),pn.dotProductWithUp=De.vec3.dot(Li,br)}return Qr.sort((pn,vn)=>pn.dotProductWithUp-vn.dotProductWithUp),Qr[0].corners}(st,nt),ft=st[lt[0]],vt=st[lt[1]],ct=st[lt[2]],Rt=st[lt[3]],$t=tt.getAtPointOrZero(new d(ft[0]/Ne.worldSize,ft[1]/Ne.worldSize),0),Nt=tt.getAtPointOrZero(new d(vt[0]/Ne.worldSize,vt[1]/Ne.worldSize),0),hr=tt.getAtPointOrZero(new d(ct[0]/Ne.worldSize,ct[1]/Ne.worldSize),0),or=tt.getAtPointOrZero(new d(Rt[0]/Ne.worldSize,Rt[1]/Ne.worldSize),0),Jt=($t+or)/2,qt=(Nt+hr)/2;return Jt>qt?Nt<hr?iS(Ie,vt,Rt,ft,Nt,or,$t,nt):iS(Ie,ct,ft,Rt,hr,$t,or,nt):$t<or?iS(Ie,ft,vt,ct,$t,Nt,hr,nt):iS(Ie,Rt,ct,vt,or,hr,Nt,nt),Math.max(Jt,qt)}(he,c,s.aabb,h,p);const me=De.mat4.fromQuat([],he),we=De.mat4.multiply([],me,ue);De.mat4.multiply(h,Q,we)}else ie=c.elevation.getAtPointOrZero(new d(R.x/X,R.y/X),0);ie!==0&&(h[14]+=ie)}}function fb(h,s,c=!1){h.uploaded||(h.gfxTexture=new YC(s,h.image,c?s.gl.R8:s.gl.RGBA8,{useMipmap:h.sampler.minFilter>=s.gl.NEAREST_MIPMAP_NEAREST}),h.uploaded=!0,h.image=null)}function aae(h,s,c){h.indexBuffer=s.createIndexBuffer(h.indexArray,!1,!0),h.vertexBuffer=s.createVertexBuffer(h.vertexArray,Jie.members,!1,!0),h.normalArray&&(h.normalBuffer=s.createVertexBuffer(h.normalArray,rae.members,!1,!0)),h.texcoordArray&&(h.texcoordBuffer=s.createVertexBuffer(h.texcoordArray,tae.members,!1,!0)),h.colorArray&&(h.colorBuffer=s.createVertexBuffer(h.colorArray,(h.colorArray.bytesPerElement===12?Qie:eae).members,!1,!0)),h.featureArray&&(h.pbrBuffer=s.createVertexBuffer(h.featureArray,iae.members,!0)),h.segments=ya.simpleSegment(0,0,h.vertexArray.length,h.indexArray.length);const p=h.material;p.pbrMetallicRoughness.baseColorTexture&&fb(p.pbrMetallicRoughness.baseColorTexture,s),p.pbrMetallicRoughness.metallicRoughnessTexture&&fb(p.pbrMetallicRoughness.metallicRoughnessTexture,s),p.normalTexture&&fb(p.normalTexture,s),p.occlusionTexture&&fb(p.occlusionTexture,s,c),p.emissionTexture&&fb(p.emissionTexture,s)}function tE(h,s,c){if(h.meshes)for(const p of h.meshes)aae(p,s,c);if(h.children)for(const p of h.children)tE(p,s,c)}function sS(h){if(h.meshes)for(const s of h.meshes)s.indexArray.destroy(),s.vertexArray.destroy(),s.colorArray&&s.colorArray.destroy(),s.normalArray&&s.normalArray.destroy(),s.texcoordArray&&s.texcoordArray.destroy(),s.featureArray&&s.featureArray.destroy();if(h.children)for(const s of h.children)sS(s)}function rE(h){if(h.meshes)for(const c of h.meshes)c.vertexBuffer&&(c.vertexBuffer.destroy(),c.indexBuffer.destroy(),c.normalBuffer&&c.normalBuffer.destroy(),c.texcoordBuffer&&c.texcoordBuffer.destroy(),c.colorBuffer&&c.colorBuffer.destroy(),c.pbrBuffer&&c.pbrBuffer.destroy(),c.segments.destroy(),c.material&&((s=c.material).pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()));var s;if(h.children)for(const c of h.children)rE(c)}class D0{constructor(s,c,p){this._demTile=s,this._dem=this._demTile.dem,this._scale=c,this._offset=p}static create(s,c,p){const v=p||s.findDEMTileFor(c);if(!v||!v.dem)return;const m=v.dem,x=v.tileID,k=1<<c.canonical.z-x.canonical.z;return new D0(v,m.dim/lr/k,[(c.canonical.x/k-x.canonical.x)*m.dim,(c.canonical.y/k-x.canonical.y)*m.dim])}tileCoordToPixel(s,c){const p=c*this._scale+this._offset[1],v=Math.floor(s*this._scale+this._offset[0]),m=Math.floor(p);return new Pt(v,m)}getElevationAt(s,c,p,v){const m=s*this._scale+this._offset[0],x=c*this._scale+this._offset[1],k=Math.floor(m),N=Math.floor(x),z=this._dem;return v=!!v,p?Lr(Lr(z.get(k,N,v),z.get(k,N+1,v),x-N),Lr(z.get(k+1,N,v),z.get(k+1,N+1,v),x-N),m-k):z.get(k,N,v)}getElevationAtPixel(s,c,p){return this._dem.get(s,c,!!p)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*qi(1,s)*this._dem.stride}}const nE=new Float32Array(262144),Zy=new Uint8Array(262144);function OF(h){let s=0;if(h.meshes)for(const c of h.meshes)s=Math.max(s,c.aabb.max[2]);if(h.children)for(const c of h.children)s=Math.max(s,OF(c));return s}function NF(h,s,c){if(h.meshes)for(const p of h.meshes){if(p.aabb.min[0]===1/0)continue;const v=Sr.applyTransform(p.aabb,h.matrix);c.insert(s,v.min[0],v.min[1],v.max[0],v.max[1])}if(h.children)for(const p of h.children)NF(p,s,c)}const RF=["","wall","door","roof","window","lamp","logo"];class IF{constructor(s){this.node=s,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:s.id,geometry:[],properties:{height:OF(s)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let s=0;const c=new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const p of this.node.meshes)this.node.lightMeshIndex!==s&&(p.transformedAabb=Sr.applyTransformFast(p.aabb,this.node.matrix),c.encapsulate(p.transformedAabb)),s++;this.aabb=c}return this.aabb}}class oS{constructor(s,c,p,v,m,x,k){this.id=p,this.layers=s,this.layerIds=this.layers.map(N=>N.fqid),this.stateDependentLayerIds=this.layers.filter(N=>N.isStateDependent()).map(N=>N.id),this.modelTraits|=I0.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,v&&(this.modelTraits|=I0.HasMapboxMeshFeatures),m&&(this.modelTraits|=I0.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const N of c)this.nodesInfo.push(new IF(N)),NF(N,k.featureIndexArray.length,k.grid),k.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,k.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(s,c){for(const p of this.getNodesInfo()){const v=p.node;v.footprint&&c.push({footprint:v.footprint,id:s})}}update(s){const c=Object.keys(s).length!==0;if(c&&!this.stateDependentLayers.length)return;const p=c?this.stateDependentLayers:this.layers;if(!nn(s,this.states))for(const v of p)this.evaluate(v,s);this.states=structuredClone(s)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(s){if(!this.needsUpload)return;const c=this.getNodesInfo();for(const p of c){const v=p.node;this.uploaded?this.updatePbrBuffer(v):tE(v,s,!0)}for(const p of c)sS(p.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(s){let c=!1;if(!s.meshes)return c;for(const p of s.meshes)p.pbrBuffer&&(p.pbrBuffer.updateData(p.featureArray),c=!0);return c}needsReEvaluation(s,c,p){const v=s.transform.projectionOptions,m=s.style.getBrightness(),x=this.brightness!==m;if(!this.uploaded||this.dirty||v.name!==this.projection.name||pb(p.paint.get("model-color").value,x)||pb(p.paint.get("model-color-mix-intensity").value,x)||pb(p.paint.get("model-roughness").value,x)||pb(p.paint.get("model-emissive-strength").value,x)||pb(p.paint.get("model-height-based-emissive-strength-multiplier").value,x)){this.projection=v,this.brightness=m;const k=this.getNodesInfo();for(const N of k)N.state=null;return!0}return!1}evaluateScale(s,c){if(s.transform.zoom===this.zoom)return;this.zoom=s.transform.zoom;const p=this.getNodesInfo(),v=this.id.canonical;for(const m of p){const x=m.feature;m.evaluatedScale=c.paint.get("model-scale").evaluate(x,{},v)}}evaluate(s,c){const p=this.getNodesInfo();for(const v of p){if(!v.node.meshes)continue;const m=v.feature,x=c&&c[m.id];if(nn(x,v.state))continue;v.state=structuredClone(x);const k=v.node.meshes&&v.node.meshes[0].featureData,N=v.evaluatedColor[2],z=v.evaluatedRMEA[2],C=this.id.canonical;if(v.hasTranslucentParts=!1,k){for(let R=0;R<RF.length;R++){const L=RF[R];L.length&&(m.properties.part=L);const j=s.paint.get("model-color").evaluate(m,x,C).toRenderColor(null),I=s.paint.get("model-color-mix-intensity").evaluate(m,x,C);v.evaluatedColor[R]=[j.r,j.g,j.b,I],v.evaluatedRMEA[R][0]=s.paint.get("model-roughness").evaluate(m,x,C),v.evaluatedRMEA[R][2]=s.paint.get("model-emissive-strength").evaluate(m,x,C),v.evaluatedRMEA[R][3]=j.a,v.emissionHeightBasedParams[R]=s.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,x,C),!v.hasTranslucentParts&&j.a<1&&(v.hasTranslucentParts=!0)}delete m.properties.part,oae(v,N!==v.evaluatedColor[2]||z!==v.evaluatedRMEA[2],this.modelTraits)}else v.evaluatedRMEA[0][2]=s.paint.get("model-emissive-strength").evaluate(m,x,C);v.evaluatedScale=s.paint.get("model-scale").evaluate(m,x,C),this.updatePbrBuffer(v.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(s,c,p,v){const m=s.findDEMTileFor(p);if(m&&(m.tileID.canonical!==this.terrainTile||c!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const x=D0.create(s,p,m);if(!x)return;this.modelTraits&I0.HasMapboxMeshFeatures&&this.updateDEM(s,x,p,v);for(const k of this.getNodesInfo()){const N=k.node;if(!N.footprint||!N.footprint.vertices||!N.footprint.vertices.length)continue;const z=N.footprint.vertices;let C=x.getElevationAt(z[0].x,z[0].y,!0,!0);for(let R=1;R<z.length;R++)C=Math.min(C,x.getElevationAt(z[R].x,z[R].y,!0,!0));N.elevation=C}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=c}}updateDEM(s,c,p,v){let m=c._dem._modifiedForSources[v];if(m===void 0&&(c._dem._modifiedForSources[v]=[],m=c._dem._modifiedForSources[v]),m.includes(p.canonical))return;const x=c._dem.dim;m.push(p.canonical);let k=!1;for(const N of this.getNodesInfo()){const z=N.node;if(!z.footprint||!z.footprint.grid)continue;const C=z.footprint.grid,R=c.tileCoordToPixel(C.min.x,C.min.y),L=c.tileCoordToPixel(C.max.x,C.max.y),j=Math.min(Math.min(x-L.y,R.x),Math.min(R.y,x-L.x));if(j<0)continue;const I=ar(j,2,5);let $=Math.max(0,R.x-I),X=Math.max(0,R.y-I),Q=Math.min(L.x+I,x-1),le=Math.min(L.y+I,x-1);for(let me=X;me<=le;++me)for(let we=$;we<=Q;++we)Zy[me*x+we]=255;let ue=0,ie=0;for(let me=0;me<C.cellsY;++me)for(let we=0;we<C.cellsX;++we){if(!C.cells[me*C.cellsX+we])continue;const Ie=c.tileCoordToPixel(C.min.x+we/C.xScale,C.min.y+me/C.yScale),Ne=c.tileCoordToPixel(C.min.x+(we+1)/C.xScale,C.min.y+(me+1)/C.yScale);for(let Me=Ie.y;Me<=Math.min(Ne.y+1,x-1);++Me)for(let Je=Ie.x;Je<=Math.min(Ne.x+1,x-1);++Je)Zy[Me*x+Je]===255&&(Zy[Me*x+Je]=0,ue+=c.getElevationAtPixel(Je,Me),ie++)}const he=ue/ie;$=Math.max(1,R.x-I),X=Math.max(1,R.y-I),Q=Math.min(L.x+I,x-2),le=Math.min(L.y+I,x-2),k=!0;for(let me=X;me<=le;++me)for(let we=$;we<=Q;++we)Zy[me*x+we]===0&&(nE[me*x+we]=c._dem.set(we,me,he));for(let me=1;me<I;++me){$=Math.max(1,R.x-me),X=Math.max(1,R.y-me),Q=Math.min(L.x+me,x-2),le=Math.min(L.y+me,x-2);for(let we=X;we<=le;++we)for(let Ie=$;Ie<=Q;++Ie){const Ne=we*x+Ie;if(Zy[Ne]===255){let Me=0,Je=0,Fe=-1,tt=-1;for(let st=-1;st<=1;++st)for(let nt=-1;nt<=1;++nt){const lt=(we+st)*x+Ie+nt;if(Zy[lt]>=me)continue;const ft=nE[lt],vt=Math.abs(ft);vt>Je&&(Me=ft,Je=vt,Fe=nt,tt=st)}if(Je>.1){const st=1-(me+.5*Math.abs(Fe*tt))/I;let nt=c._dem.get(Ie,we)+Me*st;const lt=c._dem.get(Ie+Fe,we+tt),ft=c._dem.get(Ie-Fe,we-tt,!0);(nt-lt)*(nt-ft)>0&&(nt=(lt+ft)/2),nE[Ne]=c._dem.set(Ie,we,nt),Zy[Ne]=me}}}}}k&&(c._demTile.needsDEMTextureUpload=!0,c._dem._timestamp=He.now())}getNodesInfo(){return this.nodesInfo}destroy(){const s=this.getNodesInfo();for(const c of s)sS(c.node),rE(c.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(s,c){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(s.toUnwrapped()),v=this.getNodesInfo();for(let m=0;m<this.nodesInfo.length;m++){const x=v[m].node;v[m].hiddenByReplacement=!!x.footprint&&!p.find(k=>k.footprint===x.footprint)}}getHeightAtTileCoord(s,c){const p=this.getNodesInfo(),v=[],m=[0,0,0],x=De.mat4.identity([]);for(let k=0;k<this.nodesInfo.length;k++){const N=p[k],z=N.node.meshes[0],C=z.transformedAabb;if(s<C.min[0]||c<C.min[1]||s>C.max[0]||c>C.max[1])continue;if(N.node.hidden===!0)return{height:1/0,maxHeight:N.feature.properties.height,hidden:!1,verticalScale:N.evaluatedScale[2]};De.mat4.invert(x,N.node.matrix),m[0]=s,m[1]=c,De.vec3.transformMat4(m,m,x);const R=(m[0]-z.aabb.min[0])/(z.aabb.max[0]-z.aabb.min[0])*Ky|0,L=Math.min(63,(m[1]-z.aabb.min[1])/(z.aabb.max[1]-z.aabb.min[1])*Ky|0)*Ky+Math.min(63,R),j=z.heightmap[L];if(!(j<0&&N.node.footprint))return N.hiddenByReplacement?void 0:{height:j,maxHeight:N.feature.properties.height,hidden:!1,verticalScale:N.evaluatedScale[2]};if(N.node.footprint.grid.query(new Pt(s,c),new Pt(s,c),v),v.length>0)return{height:void 0,maxHeight:N.feature.properties.height,hidden:N.hiddenByReplacement,verticalScale:N.evaluatedScale[2]}}}}function pb(h,s){return!h.isLightConstant&&s}function sae(h,s,c,p,v,m,x,k){let N=(61440&s|(61440&s)>>4)>>8,z=(3840&s|(3840&s)>>4)>>4,C=240&s|(240&s)>>4;c[3]>0&&(N=Lr(N,255*c[0],c[3]),z=Lr(z,255*c[1],c[3]),C=Lr(C,255*c[2],c[3]));const R=N<<8|z,L=C<<8|Math.floor(255*p[3]),j=function(me){const we=ar(me,0,2);return Math.min(Math.round(.5*we*255),255)}(p[2])<<8|15*p[0]<<4|15*p[1],I=ar(v[0],0,1),$=ar(v[1],0,1),X=ar(v[2],0,1),Q=ar(v[3],0,1);let le,ue,ie,he;if(I!==$&&x!==m&&$!==I){const me=x-m;ue=1/(me*($-I)),ie=-(m+me*I)/(me*($-I));const we=ar(v[4],-1,1);he=Math.pow(10,we),le=255*X<<8|255*Q}else le=65535,ue=0,ie=1,he=1;if(h.emplaceBack(R,L,j,le,ue,ie,he),k){const me=k.length;k.clear();for(let we=0;we<me;we++)k.emplaceBack(R,L,j,le,ue,ie,he)}}function oae(h,s,c){const p=h.node;let v=0;const m=c&I0.HasMeshoptCompression;for(const x of p.meshes){if(p.lights&&p.lightMeshIndex===v||!x.featureData)continue;x.featureArray=new ah,x.featureArray.reserve(x.featureData.length);let k=s;for(const N of x.featureData){const z=m?65535&N:N>>16&65535,C=m?N>>16&65535:65535&N,R=(15&C)<8?15&C:0,L=h.evaluatedRMEA[R],j=h.evaluatedColor[R],I=h.emissionHeightBasedParams[R];let $;if(k&&R===2&&p.lights&&($=new ah,$.resize(10*p.lights.length)),sae(x.featureArray,z,j,L,I,x.aabb.min[2],x.aabb.max[2],$),$&&k){k=!1;const X=p.meshes[p.lightMeshIndex];X.featureArray=$,X.featureArray._trim()}}x.featureArray._trim(),v++}}function DF(h,s,c,p){const v=1<<h.z;s.lat=Fr((p/lr+h.y)/v),s.lng=Xo((c/lr+h.x)/v)}mr(oS,"Tiled3dModelBucket",{omit:["layers"]}),mr(IF,"Tiled3dModelFeature");const lae={circle:class extends fi{constructor(h,s,c,p){super(h,{layout:Ut||(Ut=new $i({"circle-sort-key":new ur(xt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Xt(xt.layout_circle["circle-elevation-reference"]),visibility:new Xt(xt.layout_circle.visibility)})),paint:pt||(pt=new $i({"circle-radius":new ur(xt.paint_circle["circle-radius"]),"circle-color":new ur(xt.paint_circle["circle-color"]),"circle-blur":new ur(xt.paint_circle["circle-blur"]),"circle-opacity":new ur(xt.paint_circle["circle-opacity"]),"circle-translate":new Xt(xt.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(xt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(xt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(xt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ur(xt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ur(xt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ur(xt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Xt(xt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p)}createBucket(h){return new ve(h)}queryRadius(h){const s=h;return Mt("circle-radius",this,s)+Mt("circle-stroke-width",this,s)+jt(this.paint.get("circle-translate"))}queryIntersectsFeature(h,s,c,p,v,m,x,k){const N=Et(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),z=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c);return Gp(h,p,m,x,k,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",N,z)}getProgramIds(){return["circle"]}getDefaultProgramParams(h,s,c){const p=Af(this);return{config:new su(this,{zoom:s,lut:c}),defines:p,overrideFog:!1}}},heatmap:class extends fi{createBucket(h){return new M2(h)}constructor(h,s,c,p){super(h,{layout:hh||(hh=new $i({visibility:new Xt(xt.layout_heatmap.visibility)})),paint:$y||($y=new $i({"heatmap-radius":new ur(xt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ur(xt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(xt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jl(xt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(xt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ug({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(h){return Mt("heatmap-radius",this,h)}queryIntersectsFeature(h,s,c,p,v,m,x,k){const N=this.paint.get("heatmap-radius").evaluate(s,c);return Gp(h,p,m,x,k,!0,!0,new Pt(0,0),N)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(h,s,c){return h==="heatmap"?{config:new su(this,{zoom:s,lut:c}),overrideFog:!1}:{}}},hillshade:class extends fi{constructor(h,s,c,p){super(h,{layout:Tf||(Tf=new $i({visibility:new Xt(xt.layout_hillshade.visibility)})),paint:qy||(qy=new $i({"hillshade-illumination-direction":new Xt(xt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(xt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(xt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(xt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(xt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(xt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Xt(xt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(h,s,c){return{overrideFog:!1}}},fill:class extends fi{constructor(h,s,c,p){super(h,{layout:ys||(ys=new $i({"fill-sort-key":new ur(xt.layout_fill["fill-sort-key"]),visibility:new Xt(xt.layout_fill.visibility),"fill-elevation-reference":new Xt(xt.layout_fill["fill-elevation-reference"])})),paint:Vt||(Vt=new $i({"fill-antialias":new Xt(xt.paint_fill["fill-antialias"]),"fill-opacity":new ur(xt.paint_fill["fill-opacity"]),"fill-color":new ur(xt.paint_fill["fill-color"]),"fill-outline-color":new ur(xt.paint_fill["fill-outline-color"]),"fill-translate":new Xt(xt.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(xt.paint_fill["fill-translate-anchor"]),"fill-pattern":new ur(xt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Xt(xt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new ur(xt.paint_fill["fill-z-offset"]),"fill-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p)}getProgramIds(){const h=this.paint.get("fill-pattern"),s=h&&h.constantOr(1),c=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getDefaultProgramParams(h,s,c){return{config:new su(this,{zoom:s,lut:c}),overrideFog:!1}}recalculate(h,s){super.recalculate(h,s);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new un(h)}queryRadius(){return jt(this.paint.get("fill-translate"))}queryIntersectsFeature(h,s,c,p,v,m){return!h.queryGeometry.isAboveHorizon&&xe(dt(h.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends fi{constructor(h,s,c,p){super(h,{layout:uz||(uz=new $i({visibility:new Xt(xt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Xt(xt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:dz||(dz=new $i({"fill-extrusion-opacity":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ur(xt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ur(xt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ur(xt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ur(xt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new ur(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new ur(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new ur(xt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new ur(xt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Xt(xt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(h){return new L2(h)}queryRadius(){return jt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(h,s,c,p,v,m,x,k,N){const z=Et(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),C=this.paint.get("fill-extrusion-height").evaluate(s,c),R=this.paint.get("fill-extrusion-base").evaluate(s,c),L=[0,0],j=k&&m.elevation,I=m.elevation?m.elevation.exaggeration():1,$=h.tile.getBucket(this);if(j&&$ instanceof L2){const ie=$.centroidVertexArray,he=N+1;he<ie.length&&(L[0]=ie.geta_centroid_pos0(he),L[1]=ie.geta_centroid_pos1(he))}if(L[0]===0&&L[1]===1)return!1;m.projection.name==="globe"&&(p=cz([p],[new Pt(0,0),new Pt(lr,lr)],h.tileID.canonical).map(ie=>ie.polygon).flat());const X=j?k:null,[Q,le]=function(ie,he,me,we,Ie,Ne,Me,Je,Fe,tt,st){return ie.projection.name==="globe"?function(nt,lt,ft,vt,ct,Rt,$t,Nt,hr,or,Jt){const qt=[],Er=[],yr=nt.projection.upVectorScale(Jt,nt.center.lat,nt.worldSize).metersToTile,br=[0,0,0,1],Qr=[0,0,0,1],pn=(xn,jn,In,Li)=>{xn[0]=jn,xn[1]=In,xn[2]=Li,xn[3]=1},vn=lz();ft>0&&(ft+=vn),vt+=vn;for(const xn of lt){const jn=[],In=[];for(const Li of xn){const Ti=Li.x+ct.x,cn=Li.y+ct.y,yi=nt.projection.projectTilePoint(Ti,cn,Jt),bi=nt.projection.upVector(Jt,Li.x,Li.y);let Zi=ft,Ia=vt;if($t){const ss=fz(Ti,cn,ft,vt,$t,Nt,hr,or);Zi+=ss.base,Ia+=ss.top}ft!==0?pn(br,yi.x+bi[0]*yr*Zi,yi.y+bi[1]*yr*Zi,yi.z+bi[2]*yr*Zi):pn(br,yi.x,yi.y,yi.z),pn(Qr,yi.x+bi[0]*yr*Ia,yi.y+bi[1]*yr*Ia,yi.z+bi[2]*yr*Ia),De.vec3.transformMat4(br,br,Rt),De.vec3.transformMat4(Qr,Qr,Rt),jn.push(new Wy(br[0],br[1],br[2])),In.push(new Wy(Qr[0],Qr[1],Qr[2]))}qt.push(jn),Er.push(In)}return[qt,Er]}(ie,he,me,we,Ie,Ne,Me,Je,Fe,tt,st):Me?function(nt,lt,ft,vt,ct,Rt,$t,Nt,hr){const or=[],Jt=[],qt=[0,0,0,1];for(const Er of nt){const yr=[],br=[];for(const Qr of Er){const pn=Qr.x+vt.x,vn=Qr.y+vt.y,xn=fz(pn,vn,lt,ft,Rt,$t,Nt,hr);qt[0]=pn,qt[1]=vn,qt[2]=xn.base,qt[3]=1,De.vec4.transformMat4(qt,qt,ct),qt[3]=Math.max(qt[3],1e-5);const jn=new Wy(qt[0]/qt[3],qt[1]/qt[3],qt[2]/qt[3]);qt[0]=pn,qt[1]=vn,qt[2]=xn.top,qt[3]=1,De.vec4.transformMat4(qt,qt,ct),qt[3]=Math.max(qt[3],1e-5);const In=new Wy(qt[0]/qt[3],qt[1]/qt[3],qt[2]/qt[3]);yr.push(jn),br.push(In)}or.push(yr),Jt.push(br)}return[or,Jt]}(he,me,we,Ie,Ne,Me,Je,Fe,tt):function(nt,lt,ft,vt,ct){const Rt=[],$t=[],Nt=ct[8]*lt,hr=ct[9]*lt,or=ct[10]*lt,Jt=ct[11]*lt,qt=ct[8]*ft,Er=ct[9]*ft,yr=ct[10]*ft,br=ct[11]*ft;for(const Qr of nt){const pn=[],vn=[];for(const xn of Qr){const jn=xn.x+vt.x,In=xn.y+vt.y,Li=ct[0]*jn+ct[4]*In+ct[12],Ti=ct[1]*jn+ct[5]*In+ct[13],cn=ct[2]*jn+ct[6]*In+ct[14],yi=ct[3]*jn+ct[7]*In+ct[15],bi=Li+Nt,Zi=Ti+hr,Ia=cn+or,ss=Math.max(yi+Jt,1e-5),Da=Li+qt,wa=Ti+Er,Ga=cn+yr,vs=Math.max(yi+br,1e-5);pn.push(new Wy(bi/ss,Zi/ss,Ia/ss)),vn.push(new Wy(Da/vs,wa/vs,Ga/vs))}Rt.push(pn),$t.push(vn)}return[Rt,$t]}(he,me,we,Ie,Ne)}(m,p,R,C,z,x,X,L,I,m.center.lat,h.tileID.canonical),ue=h.queryGeometry;return function(ie,he,me){let we=1/0;xe(me,he)&&(we=hz(me,he[0]));for(let Ie=0;Ie<he.length;Ie++){const Ne=he[Ie],Me=ie[Ie];for(let Je=0;Je<Ne.length-1;Je++){const Fe=Ne[Je],tt=[Fe,Ne[Je+1],Me[Je+1],Me[Je],Fe];fe(me,tt)&&(we=Math.min(we,hz(me,tt)))}}return we!==1/0&&we}(Q,le,ue.isPointQuery()?ue.screenBounds:ue.screenGeometry)}},line:class extends fi{constructor(h,s,c,p){const v=Sz();super(h,v,s,c,p),v.layout&&(this.layout=new Ju(v.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof Fd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(h,s){super.recalculate(h,s),this.paint._values["line-floorwidth"]=(()=>{if(rb)return rb;const c=Sz();return rb=new uie(c.paint.properties["line-width"].specification),rb.useIntegerZoom=!0,rb})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new kC(h)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(h,s,c){const p=bz(this);return{config:new su(this,{zoom:s,lut:c}),defines:p,overrideFog:!1}}queryRadius(h){const s=h,c=Az(Mt("line-width",this,s),Mt("line-gap-width",this,s)),p=Mt("line-offset",this,s);return c/2+Math.abs(p)+jt(this.paint.get("line-translate"))}queryIntersectsFeature(h,s,c,p,v,m){if(h.queryGeometry.isAboveHorizon)return!1;const x=dt(h.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),k=h.pixelToTileUnitsFactor/2*Az(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),N=this.paint.get("line-offset").evaluate(s,c);return N&&(p=function(z,C){const R=[],L=new Pt(0,0);for(let j=0;j<z.length;j++){const I=z[j],$=[];for(let X=0;X<I.length;X++){const Q=I[X],le=I[X+1],ue=X===0?L:Q.sub(I[X-1])._unit()._perp(),ie=X===I.length-1?L:le.sub(Q)._unit()._perp(),he=ue._add(ie)._unit();he._mult(1/(he.x*ie.x+he.y*ie.y)),$.push(he._mult(C)._add(Q))}R.push($)}return R}(p,N*h.pixelToTileUnitsFactor)),function(z,C,R){for(let L=0;L<C.length;L++){const j=C[L];if(z.length>=3){for(let I=0;I<j.length;I++)if($e(z,j[I]))return!0}if(Ce(z,j,R))return!0}return!1}(x,p,k)}isTileClipped(){return!0}isDraped(h){return!this.hasElevatedBuckets}},symbol:Q2,background:class extends fi{constructor(h,s,c,p){super(h,{layout:oF||(oF=new $i({visibility:new Xt(xt.layout_background.visibility)})),paint:lF||(lF=new $i({"background-pitch-alignment":new Xt(xt.paint_background["background-pitch-alignment"]),"background-color":new Xt(xt.paint_background["background-color"]),"background-pattern":new Xt(xt.paint_background["background-pattern"]),"background-opacity":new Xt(xt.paint_background["background-opacity"]),"background-emissive-strength":new Xt(xt.paint_background["background-emissive-strength"]),"background-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(h,s,c){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:fF,"raster-particle":xF,sky:class extends fi{constructor(h,s,c,p){super(h,{layout:gF||(gF=new $i({visibility:new Xt(xt.layout_sky.visibility)})),paint:yF||(yF=new $i({"sky-type":new Xt(xt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xt(xt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xt(xt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xt(xt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xt(xt.paint_sky["sky-gradient-radius"]),"sky-gradient":new jl(xt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xt(xt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xt(xt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xt(xt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="sky-gradient"?this._updateColorRamp():h!=="sky-atmosphere-sun"&&h!=="sky-atmosphere-halo-color"&&h!=="sky-atmosphere-color"&&h!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ug({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(h){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=h.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(h,s){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),v=!p,m=h.style.light,x=m.properties.get("position");return v&&m.properties.get("anchor")==="viewport"&&an("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?XC(x.azimuthal,90-x.polar,s):XC(p[0],90-p[1],s)}const c=this.paint.get("sky-gradient-center");return XC(c[0],90-c[1],s)}isSky(){return!0}markSkyboxValid(h){this._skyboxInvalidated=!1,this._lightPosition=h.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const h=this.paint.get("sky-type");return h==="atmosphere"?["skyboxCapture","skybox"]:h==="gradient"?["skyboxGradient"]:null}},slot:class extends fi{constructor(h,s,c,p){super(h,{paint:vF||(vF=new $i({}))},s,null)}},model:class extends fi{constructor(h,s,c,p){super(h,{layout:kF||(kF=new $i({visibility:new Xt(xt.layout_model.visibility),"model-id":new ur(xt.layout_model["model-id"])})),paint:MF||(MF=new $i({"model-opacity":new ur(xt.paint_model["model-opacity"]),"model-rotation":new ur(xt.paint_model["model-rotation"]),"model-scale":new ur(xt.paint_model["model-scale"]),"model-translation":new ur(xt.paint_model["model-translation"]),"model-color":new ur(xt.paint_model["model-color"]),"model-color-mix-intensity":new ur(xt.paint_model["model-color-mix-intensity"]),"model-type":new Xt(xt.paint_model["model-type"]),"model-cast-shadows":new Xt(xt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Xt(xt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Xt(xt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new ur(xt.paint_model["model-emissive-strength"]),"model-roughness":new ur(xt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new ur(xt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Xt(xt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Xt(xt.paint_model["model-front-cutoff"]),"model-color-use-theme":new ur({type:"string",default:"default","property-type":"data-driven"})}))},s,c,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(h){return new eE(h)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(h){return h instanceof oS?lr-1:0}queryIntersectsFeature(h,s,c,p,v,m){if(!this.modelManager)return!1;const x=this.modelManager,k=h.tile.getBucket(this);if(!(k&&k instanceof eE))return!1;for(const N in k.instancesPerModel){const z=k.instancesPerModel[N],C=s.id!==void 0?s.id:s.properties&&s.properties.hasOwnProperty("id")?s.properties.id:void 0;if(z.idToFeaturesIndex.hasOwnProperty(C)){const R=z.features[z.idToFeaturesIndex[C]],L=x.getModel(N,this.scope);if(!L)return!1;let j=De.mat4.create();const I=new Kn(0,0),$=k.canonical;let X=Number.MAX_VALUE;for(let Q=0;Q<R.instancedDataCount;++Q){const le=16*(R.instancedDataOffset+Q),ue=z.instancedDataArray.float32,ie=[ue[le+4],ue[le+5],ue[le+6]];DF($,I,ue[le],0|ue[le+1]),jF(j,L,m,I,R.rotation,R.scale,ie,!1,!1,!1),m.projection.name==="globe"&&(j=QC(j,m));const he=De.mat4.multiply([],m.projMatrix,j),me=h.queryGeometry,we=AF(me.isPointQuery()?me.screenBounds:me.screenGeometry,m,he,L.aabb);we!=null&&(X=Math.min(we,X))}return X!==Number.MAX_VALUE&&X}}return!1}_handleOverridablePaintPropertyUpdate(h,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven()||h!=="model-color"&&h!=="model-color-mix-intensity"&&h!=="model-rotation"&&h!=="model-scale"&&h!=="model-translation"&&h!=="model-emissive-strength")}_isPropertyZoomDependent(h){const s=this._transitionablePaint._values[h];return s!=null&&s.value!=null&&s.value.expression!=null&&s.value.expression instanceof Kd}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends fi{constructor(h,s,c,p){super(h,{layout:Ot||(Ot=new $i({"clip-layer-types":new Xt(xt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Xt(xt.layout_clip["clip-layer-scope"])})),paint:Gt||(Gt=new $i({}))},s,c,p)}recalculate(h,s){super.recalculate(h,s)}createBucket(h){return new Rn(h)}isTileClipped(){return!0}is3D(){return!0}}};class cae{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class uae{constructor(){this.tasks={},this.taskQueue=[],yo(["process"],this),this.invoker=new cae(this.process),this.nextId=0}add(s,c){const p=this.nextId++,v=function({type:m,isSymbolTile:x,zoom:k}){return k=k||0,m==="message"?0:m!=="maybePrepare"||x?m!=="parseTile"||x?m==="parseTile"&&x?300-k:m==="maybePrepare"&&x?400-k:500:200-k:100-k}(c);if(v===0){try{s()}finally{}return null}return this.tasks[p]={fn:s,metadata:c,priority:v,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const c=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let s=null,c=1/0;for(let v=0;v<this.taskQueue.length;v++){const m=this.tasks[this.taskQueue[v]];m.priority<c&&(c=m.priority,s=v)}if(s===null)return null;const p=this.taskQueue[s];return this.taskQueue.splice(s,1),p}remove(){this.invoker.remove()}}class LF{constructor(s,c,p){this.target=s,this.parent=c,this.mapId=p,this.callbacks={},this.cancelCallbacks={},yo(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new uae}send(s,c,p,v,m=!1,x){const k=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=x,this.callbacks[k]=p);const N=new Set;return this.target.postMessage({id:k,type:s,hasCallback:!!p,targetMapId:v,mustQueue:m,sourceMapId:this.mapId,data:so(c,N)},N),{cancel:()=>{p&&delete this.callbacks[k],this.target.postMessage({id:k,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(s){const c=s.data,p=c.id;if(p&&(!c.targetMapId||this.mapId===c.targetMapId))if(c.type==="<cancel>"){const v=this.cancelCallbacks[p];delete this.cancelCallbacks[p],v&&v.cancel()}else if(c.mustQueue||Us()){const v=this.callbacks[p],m=this.scheduler.add(()=>this.processTask(p,c),v&&v.metadata||{type:"message"});m&&(this.cancelCallbacks[p]=m)}else this.processTask(p,c)}processTask(s,c){if(delete this.cancelCallbacks[s],c.type==="<response>"){const p=this.callbacks[s];delete this.callbacks[s],p&&(c.error?p(ul(c.error)):p(null,ul(c.data)))}else{const p=new Set,v=c.hasCallback?(x,k)=>{this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:x?so(x):null,data:so(k,p)},p)}:()=>{},m=ul(c.data);if(this.parent[c.type])this.parent[c.type](c.sourceMapId,m,v);else if(this.parent.getWorkerSource){const x=c.type.split(".");this.parent.getWorkerSource(c.sourceMapId,x[0],m.source,m.scope)[x[1]](m,v)}else v(new Error(`Could not find function ${c.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var mb={workerUrl:"",workerClass:null,workerParams:void 0};const iE="mapboxgl_preloaded_worker_pool";class Yy{constructor(){this.active={}}acquire(s,c=Yy.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<c;)this.workers.push(mb.workerClass!=null?new mb.workerClass:new self.Worker(mb.workerUrl,mb.workerParams));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.workers&&this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[iE]}numActive(){return Object.keys(this.active).length}}Yy.workerCount=2;class L0{constructor(s,c,p="Worker",v=Yy.workerCount){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=Va();const m=this.workerPool.acquire(this.id,v);for(let x=0;x<m.length;x++){const k=new L0.Actor(m[x],c,this.id);k.name=`${p} ${x}`,this.actors.push(k)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,c,p){Bi(this.actors,(v,m)=>{v.send(s,c,m)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}let gb,aE;function lS(){return gb||(gb=new Yy),gb}L0.Actor=LF;const sE=new Jn(0,0,0);var oE=(h=>(h[h.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",h[h.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",h[h.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",h))(oE||{}),cS=(h=>(h[h.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",h[h.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",h[h.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",h[h.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",h))(cS||{}),yb=(h=>(h[h.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",h[h.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",h[h.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",h[h.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",h[h.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",h))(yb||{}),zF=(h=>(h[h.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",h[h.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",h[h.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",h))(zF||{}),z0=(h=>(h[h.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",h[h.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",h[h.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",h[h.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",h[h.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",h[h.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",h))(z0||{}),FF=(h=>(h[h.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",h[h.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",h[h.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",h))(FF||{});function dae(h,s,c){h===1&&s.icons.push(function(p,v){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:x}=m;if(x.content_area){const{content_area:k}=x;k.top==null&&(k.top=k.left),k.width==null&&(k.width=m.usvg_tree.width),k.height==null&&(k.height=k.width)}return x.stretch_x&&x.stretch_x.length&&BF(x,"x"),x.stretch_y&&x.stretch_y.length&&BF(x,"y"),m}(p.readFields(hae,{name:void 0},v))}(c,c.readVarint()+c.pos))}function BF(h,s){const c=[],p=h[`stretch_${s}`];let v=null;for(let m=0;m<p.length;m++)v===null?v=c.length===0?p[0]:c[c.length-1][1]+p[m]:(c.push([v,v+p[m]]),v=null);h[`stretch_${s}_areas`]=c}function hae(h,s,c){h===1?s.name=c.readString():h===2?s.metadata=function(p,v){return p.readFields(fae,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},v)}(c,c.readVarint()+c.pos):h===3&&(s.usvg_tree=function(p,v){return p.readFields(gae,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},v)}(c,c.readVarint()+c.pos),s.data="usvg_tree")}function fae(h,s,c){h===1?s.stretch_x=c.readPackedVarint():h===2?s.stretch_y=c.readPackedVarint():h===3?s.content_area=function(p,v){return p.readFields(pae,{left:0},v)}(c,c.readVarint()+c.pos):h===4&&s.variables.push(function(p,v){return p.readFields(mae,{name:void 0},v)}(c,c.readVarint()+c.pos))}function pae(h,s,c){h===1?s.left=c.readVarint():h===2?s.width=c.readVarint():h===3?s.top=c.readVarint():h===4&&(s.height=c.readVarint())}function mae(h,s,c){h===1?s.name=c.readString():h===2&&(s.rgb_color=hS(c.readVarint()),s.value="rgb_color")}function gae(h,s,c){h===1?s.width=s.height=c.readVarint():h===2?s.height=c.readVarint():h===3?s.children.push(uS(c,c.readVarint()+c.pos)):h===4?s.linear_gradients.push(function(p,v){return p.readFields(Sae,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},v)}(c,c.readVarint()+c.pos)):h===5?s.radial_gradients.push(function(p,v){return p.readFields(Tae,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},v)}(c,c.readVarint()+c.pos)):h===7?s.clip_paths.push(function(p,v){return p.readFields(Pae,{children:[]},v)}(c,c.readVarint()+c.pos)):h===8&&s.masks.push(function(p,v){const m=p.readFields(Cae,{left:0,width:20,mask_type:1,children:[]},v);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(c,c.readVarint()+c.pos))}function uS(h,s){return h.readFields(yae,{},s)}function yae(h,s,c){h===1?(s.group=function(p,v){return p.readFields(vae,{opacity:255,children:[]},v)}(c,c.readVarint()+c.pos),s.node="group"):h===2&&(s.path=function(p,v){return p.readFields(_ae,{paint_order:1,commands:[],step:1,diffs:[],rule:1},v)}(c,c.readVarint()+c.pos),s.node="path")}function vae(h,s,c){h===1?s.transform=dS(c,c.readVarint()+c.pos):h===2?s.opacity=c.readVarint():h===5?s.clip_path_idx=c.readVarint():h===6?s.mask_idx=c.readVarint():h===7&&s.children.push(uS(c,c.readVarint()+c.pos))}function dS(h,s){return h.readFields(xae,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},s)}function xae(h,s,c){h===1?s.sx=c.readFloat():h===2?s.ky=c.readFloat():h===3?s.kx=c.readFloat():h===4?s.sy=c.readFloat():h===5?s.tx=c.readFloat():h===6&&(s.ty=c.readFloat())}function _ae(h,s,c){h===1?s.fill=function(p,v){return p.readFields(bae,{rgb_color:sE,paint:"rgb_color",opacity:255},v)}(c,c.readVarint()+c.pos):h===2?s.stroke=function(p,v){return p.readFields(wae,{rgb_color:sE,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},v)}(c,c.readVarint()+c.pos):h===3?s.paint_order=c.readVarint():h===5?c.readPackedVarint(s.commands):h===6?s.step=c.readFloat():h===7?c.readPackedSVarint(s.diffs):h===8&&(s.rule=c.readVarint())}function bae(h,s,c){h===1?(s.rgb_color=hS(c.readVarint()),s.paint="rgb_color"):h===2?(s.linear_gradient_idx=c.readVarint(),s.paint="linear_gradient_idx"):h===3?(s.radial_gradient_idx=c.readVarint(),s.paint="radial_gradient_idx"):h===5&&(s.opacity=c.readVarint())}function hS(h){return new Jn((h>>16&255)/255,(h>>8&255)/255,(255&h)/255,1)}function wae(h,s,c){h===1?(s.rgb_color=hS(c.readVarint()),s.paint="rgb_color"):h===2?(s.linear_gradient_idx=c.readVarint(),s.paint="linear_gradient_idx"):h===3?(s.radial_gradient_idx=c.readVarint(),s.paint="radial_gradient_idx"):h===5?c.readPackedFloat(s.dasharray):h===6?s.dashoffset=c.readFloat():h===7?s.miterlimit=c.readFloat():h===8?s.opacity=c.readVarint():h===9?s.width=c.readFloat():h===10?s.linecap=c.readVarint():h===11&&(s.linejoin=c.readVarint())}function Sae(h,s,c){h===1?s.transform=dS(c,c.readVarint()+c.pos):h===2?s.spread_method=c.readVarint():h===3?s.stops.push(VF(c,c.readVarint()+c.pos)):h===4?s.x1=c.readFloat():h===5?s.y1=c.readFloat():h===6?s.x2=c.readFloat():h===7&&(s.y2=c.readFloat())}function VF(h,s){return h.readFields(Aae,{offset:0,opacity:255,rgb_color:sE},s)}function Aae(h,s,c){h===1?s.offset=c.readFloat():h===2?s.opacity=c.readVarint():h===3&&(s.rgb_color=hS(c.readVarint()))}function Tae(h,s,c){h===1?s.transform=dS(c,c.readVarint()+c.pos):h===2?s.spread_method=c.readVarint():h===3?s.stops.push(VF(c,c.readVarint()+c.pos)):h===4?s.cx=c.readFloat():h===5?s.cy=c.readFloat():h===6?s.r=c.readFloat():h===7?s.fx=c.readFloat():h===8?s.fy=c.readFloat():h===9&&(s.fr=c.readFloat())}function Pae(h,s,c){h===1?s.transform=dS(c,c.readVarint()+c.pos):h===2?s.clip_path_idx=c.readVarint():h===3&&s.children.push(uS(c,c.readVarint()+c.pos))}function Cae(h,s,c){h===1?s.left=s.top=c.readFloat():h===2?s.width=s.height=c.readFloat():h===3?s.top=c.readFloat():h===4?s.height=c.readFloat():h===5?s.mask_type=c.readVarint():h===6?s.mask_idx=c.readVarint():h===7&&s.children.push(uS(c,c.readVarint()+c.pos))}class Eae{static calculate(s,c){const p=new Map,v=new Map;if(Object.keys(s).length===0)return p;c.forEach(m=>{v.set(m.name,m.rgb_color||new Jn(0,0,0))});for(const[m,x]of Object.entries(s))v.has(m)?p.set(v.get(m).toStringPremultipliedAlpha(),x):console.warn(`Ignoring unknown image variable "${m}"`);return p}}function F0(h,s=255,c){const p=s/255,v=h.toStringPremultipliedAlpha(),m=c.has(v)?c.get(v).clone():h.clone();return m.a=p,m.toString()}function vb(h,s){if(!Pe()){const c=document.createElement("canvas");return c.width=h,c.height=s,c}return new OffscreenCanvas(h,s)}function kae(h,s){const c=Eae.calculate(s.params,h.metadata?h.metadata.variables:[]),p=h.usvg_tree,v=p.width,m=p.height,x=s.transform?s.transform:new DOMMatrix,k=Math.max(1,Math.round(v*x.a)),N=Math.max(1,Math.round(m*x.d)),z=new DOMMatrix([k/v,0,0,N/m,0,0]),C=vb(k,N).getContext("2d");return lE(C,z,p,p,c),C.getImageData(0,0,k,N)}function lE(h,s,c,p,v){for(const m of p.children)UF(h,s,c,m,v)}function UF(h,s,c,p,v){p.group?(h.save(),function(m,x,k,N,z){const C=N.mask_idx!=null?k.masks[N.mask_idx]:null,R=N.clip_path_idx!=null?k.clip_paths[N.clip_path_idx]:null;if(N.transform&&(x=fS(N.transform).preMultiplySelf(x)),!function(I,$,X){return I.opacity!==255||$||X}(N,R!=null,C!=null))return void lE(m,x,k,N,z);const L=vb(m.canvas.width,m.canvas.height),j=L.getContext("2d");lE(j,x,k,N,z),R&&ZF(j,x,k,R),C&&YF(j,x,k,C,z),m.globalAlpha=N.opacity/255,m.drawImage(L,0,0)}(h,s,c,p.group,v),h.restore()):p.path&&(h.save(),function(m,x,k,N,z){const C=XF(N);m.setTransform(x),N.paint_order===zF.PAINT_ORDER_FILL_AND_STROKE?($F(m,k,N,C,z),GF(m,k,N,C,z)):(GF(m,k,N,C,z),$F(m,k,N,C,z))}(h,s,c,p.path,v),h.restore())}function $F(h,s,c,p,v){const m=c.fill;if(!m)return;const x=m.opacity/255;switch(m.paint){case"rgb_color":h.fillStyle=F0(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":h.fillStyle=WF(h,s.linear_gradients[m.linear_gradient_idx],x,v);break;case"radial_gradient_idx":h.fillStyle=HF(h,s.radial_gradients[m.radial_gradient_idx],x,v)}h.fill(p,qF(c))}function qF(h){return h.rule===oE.PATH_RULE_NON_ZERO?"nonzero":h.rule===oE.PATH_RULE_EVEN_ODD?"evenodd":void 0}function GF(h,s,c,p,v){const m=c.stroke;if(!m)return;h.lineWidth=m.width,h.miterLimit=m.miterlimit,h.setLineDash(m.dasharray),h.lineDashOffset=m.dashoffset;const x=m.opacity/255;switch(m.paint){case"rgb_color":h.strokeStyle=F0(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":h.strokeStyle=WF(h,s.linear_gradients[m.linear_gradient_idx],x,v);break;case"radial_gradient_idx":h.strokeStyle=HF(h,s.radial_gradients[m.radial_gradient_idx],x,v)}switch(m.linejoin){case yb.LINE_JOIN_MITER_CLIP:case yb.LINE_JOIN_MITER:h.lineJoin="miter";break;case yb.LINE_JOIN_ROUND:h.lineJoin="round";break;case yb.LINE_JOIN_BEVEL:h.lineJoin="bevel"}switch(m.linecap){case cS.LINE_CAP_BUTT:h.lineCap="butt";break;case cS.LINE_CAP_ROUND:h.lineCap="round";break;case cS.LINE_CAP_SQUARE:h.lineCap="square"}h.stroke(p)}function WF(h,s,c,p){if(s.stops.length===1){const L=s.stops[0];return F0(L.rgb_color,L.opacity*c,p)}const v=fS(s.transform),{x1:m,y1:x,x2:k,y2:N}=s,z=v.transformPoint(new DOMPoint(m,x)),C=v.transformPoint(new DOMPoint(k,N)),R=h.createLinearGradient(z.x,z.y,C.x,C.y);for(const L of s.stops)R.addColorStop(L.offset,F0(L.rgb_color,L.opacity*c,p));return R}function HF(h,s,c,p){if(s.stops.length===1){const L=s.stops[0];return F0(L.rgb_color,L.opacity*c,p)}const v=fS(s.transform),{fx:m,fy:x,cx:k,cy:N}=s,z=v.transformPoint(new DOMPoint(m,x)),C=v.transformPoint(new DOMPoint(k,N)),R=h.createRadialGradient(z.x,z.y,0,C.x,C.y,s.r*((v.a+v.d)/2));for(const L of s.stops)R.addColorStop(L.offset,F0(L.rgb_color,L.opacity*c,p));return R}function KF(h,s,c,p){const v=p.transform?fS(p.transform).preMultiplySelf(s):s,m=vb(h.canvas.width,h.canvas.height),x=m.getContext("2d");for(const N of p.children)if(N.group)KF(x,v,c,N.group);else if(N.path){const z=N.path,C=new Path2D;C.addPath(XF(z),v),x.fill(C,qF(z))}const k=p.clip_path_idx!=null?c.clip_paths[p.clip_path_idx]:null;k&&ZF(x,v,c,k),h.globalCompositeOperation="source-over",h.drawImage(m,0,0)}function ZF(h,s,c,p){const v=vb(h.canvas.width,h.canvas.height);KF(v.getContext("2d"),s,c,p),h.globalCompositeOperation="destination-in",h.drawImage(v,0,0)}function YF(h,s,c,p,v){if(p.children.length===0)return;const m=p.mask_idx!=null?c.masks[p.mask_idx]:null;m&&YF(h,s,c,m,v);const x=h.canvas.width,k=h.canvas.height,N=vb(x,k),z=N.getContext("2d"),C=p.width,R=p.height,L=p.left,j=p.top,I=new Path2D,$=new Path2D;$.rect(L,j,C,R),I.addPath($,s),z.clip(I);for(const le of p.children)UF(z,s,c,le,v);const X=z.getImageData(0,0,x,k),Q=X.data;if(p.mask_type===FF.MASK_TYPE_LUMINANCE)for(let le=0;le<Q.length;le+=4)Q[le+3]=Q[le+3]/255*(.2126*Q[le]+.7152*Q[le+1]+.0722*Q[le+2]);z.putImageData(X,0,0),h.globalCompositeOperation="destination-in",h.drawImage(N,0,0)}function fS(h){return h?new DOMMatrix([h.sx,h.ky,h.kx,h.sy,h.tx,h.ty]):new DOMMatrix}function XF(h){const s=new Path2D,c=h.step;let p=h.diffs[0]*c,v=h.diffs[1]*c;s.moveTo(p,v);for(let m=0,x=2;m<h.commands.length;m++)switch(h.commands[m]){case z0.PATH_COMMAND_MOVE:p+=h.diffs[x++]*c,v+=h.diffs[x++]*c,s.moveTo(p,v);break;case z0.PATH_COMMAND_LINE:p+=h.diffs[x++]*c,v+=h.diffs[x++]*c,s.lineTo(p,v);break;case z0.PATH_COMMAND_QUAD:{const k=p+h.diffs[x++]*c,N=v+h.diffs[x++]*c;p=k+h.diffs[x++]*c,v=N+h.diffs[x++]*c,s.quadraticCurveTo(k,N,p,v);break}case z0.PATH_COMMAND_CUBIC:{const k=p+h.diffs[x++]*c,N=v+h.diffs[x++]*c,z=k+h.diffs[x++]*c,C=N+h.diffs[x++]*c;p=z+h.diffs[x++]*c,v=C+h.diffs[x++]*c,s.bezierCurveTo(k,N,z,C,p,v);break}case z0.PATH_COMMAND_CLOSE:s.closePath()}return s}class cE{constructor(s){this.capacity=s,this.cache=new Map}get(s){if(!this.cache.has(s))return;const c=this.cache.get(s);return this.cache.delete(s),this.cache.set(s,c),c}put(s,c){this.cache.has(s)?this.cache.delete(s):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(s,c)}delete(s){this.cache.delete(s)}}class uE{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(s){return new Ls(s,s.data)}getFromCache(s,c,p){return this.cacheMap.has(p)||this.cacheMap.set(p,new cE(150)),this.cacheMap.get(p).get(So(s.serialize(),c))}setInCache(s,c,p,v){this.cacheDependenciesMap.has(v)||this.cacheDependenciesMap.set(v,new Map),this.cacheMap.has(v)||this.cacheMap.set(v,new cE(150));const m=this.cacheDependenciesMap.get(v);m.get(So(s.id,p))||m.set(So(s.id,p),new Set);const x=this.cacheMap.get(v),k=s.serialize();m.get(So(s.id,p)).add(k),x.put(So(s.serialize(),p),c)}removeImagesFromCacheByIds(s,c,p=""){if(!this.cacheMap.has(p)||!this.cacheDependenciesMap.has(p))return;const v=this.cacheMap.get(p),m=this.cacheDependenciesMap.get(p);for(const x of s)if(m.has(So(x,c))){for(const k of m.get(So(x,c)))v.delete(k);m.delete(So(x,c))}}rasterize(s,c,p,v,m=kae){const x=this.getFromCache(s,p,v);if(x)return x.clone();const k=m(c.icon,s.options),N=uE._getImage(k);return this.setInCache(s,N,p,v),N.clone()}}class JF{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,c){const p=this.toIdx(s,c);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(s,c){return this.leaves[this.toIdx(s,c)]}toIdx(s,c){return c*this.size+s}}function QF(h,s,c,p){let v=0,m=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(p[x])<1e-15){if(c[x]<h[x]||c[x]>s[x])return null}else{const k=1/p[x];let N=(h[x]-c[x])*k,z=(s[x]-c[x])*k;if(N>z){const C=N;N=z,z=C}if(N>v&&(v=N),z<m&&(m=z),v>m)return null}return v}function e5(h,s,c,p,v,m,x,k,N,z,C){const R=p-h,L=v-s,j=m-c,I=x-h,$=k-s,X=N-c,Q=C[1]*X-C[2]*$,le=C[2]*I-C[0]*X,ue=C[0]*$-C[1]*I,ie=R*Q+L*le+j*ue;if(Math.abs(ie)<1e-15)return null;const he=1/ie,me=z[0]-h,we=z[1]-s,Ie=z[2]-c,Ne=(me*Q+we*le+Ie*ue)*he;if(Ne<0||Ne>1)return null;const Me=we*j-Ie*L,Je=Ie*R-me*j,Fe=me*L-we*R,tt=(C[0]*Me+C[1]*Je+C[2]*Fe)*he;return tt<0||Ne+tt>1?null:(I*Me+$*Je+X*Fe)*he}function t5(h,s,c){return(h-s)/(c-s)}function r5(h,s,c,p,v,m,x,k,N){const z=1<<c,C=m-p,R=x-v,L=(h+1)/z*C+p,j=(s+0)/z*R+v,I=(s+1)/z*R+v;k[0]=(h+0)/z*C+p,k[1]=j,N[0]=L,N[1]=I}class n5{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(m){const x=Math.ceil(Math.log2(m.dim/8)),k=[];let N=Math.ceil(Math.pow(2,x));const z=1/N,C=(j,I,$,X,Q)=>{const le=X?1:0,ue=(j+1)*$-le,ie=I*$,he=(I+1)*$-le;Q[0]=j*$,Q[1]=ie,Q[2]=ue,Q[3]=he};let R=new JF(N);const L=[];for(let j=0;j<N*N;j++){C(j%N,Math.floor(j/N),z,!1,L);const I=vg(L[0],L[1],m),$=vg(L[2],L[1],m),X=vg(L[2],L[3],m),Q=vg(L[0],L[3],m);R.minimums.push(Math.min(I,$,X,Q)),R.maximums.push(Math.max(I,$,X,Q)),R.leaves.push(1)}for(k.push(R),N/=2;N>=1;N/=2){const j=k[k.length-1];R=new JF(N);for(let I=0;I<N*N;I++){C(I%N,Math.floor(I/N),2,!0,L);const $=j.getElevation(L[0],L[1]),X=j.getElevation(L[2],L[1]),Q=j.getElevation(L[2],L[3]),le=j.getElevation(L[0],L[3]),ue=j.isLeaf(L[0],L[1]),ie=j.isLeaf(L[2],L[1]),he=j.isLeaf(L[2],L[3]),me=j.isLeaf(L[0],L[3]),we=Math.min($.min,X.min,Q.min,le.min),Ie=Math.max($.max,X.max,Q.max,le.max),Ne=ue&&ie&&he&&me;R.maximums.push(Ie),R.minimums.push(we),R.leaves.push(Ie-we<=5&&Ne?1:0)}k.push(R)}return k}(this.dem),p=c.length-1,v=c[p];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(c,0,0,p,0)}raycastRoot(s,c,p,v,m,x,k=1){return QF([s,c,-100],[p,v,this.maximums[0]*k],m,x)}raycast(s,c,p,v,m,x,k=1){if(!this.nodeCount)return null;const N=this.raycastRoot(s,c,p,v,m,x,k);if(N==null)return null;const z=[],C=[],R=[],L=[],j=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;j.length>0;){const{idx:I,t:$,nodex:X,nodey:Q,depth:le}=j.pop();if(this.leaves[I]){r5(X,Q,le,s,c,p,v,R,L);const ie=1<<le,he=(X+0)/ie,me=(X+1)/ie,we=(Q+0)/ie,Ie=(Q+1)/ie,Ne=vg(he,we,this.dem)*k,Me=vg(me,we,this.dem)*k,Je=vg(me,Ie,this.dem)*k,Fe=vg(he,Ie,this.dem)*k,tt=e5(R[0],R[1],Ne,L[0],R[1],Me,L[0],L[1],Je,m,x),st=e5(L[0],L[1],Je,R[0],L[1],Fe,R[0],R[1],Ne,m,x),nt=Math.min(tt!==null?tt:Number.MAX_VALUE,st!==null?st:Number.MAX_VALUE);if(nt!==Number.MAX_VALUE)return nt;{const lt=De.vec3.scaleAndAdd([],m,x,$);if(i5(Ne,Me,Fe,Je,t5(lt[0],R[0],L[0]),t5(lt[1],R[1],L[1]))>=lt[2])return $}continue}let ue=0;for(let ie=0;ie<this._siblingOffset.length;ie++){r5((X<<1)+this._siblingOffset[ie][0],(Q<<1)+this._siblingOffset[ie][1],le+1,s,c,p,v,R,L),R[2]=-100,L[2]=this.maximums[this.childOffsets[I]+ie]*k;const he=QF(R,L,m,x);if(he!=null){const me=he;z[ie]=me;let we=!1;for(let Ie=0;Ie<ue&&!we;Ie++)me>=z[C[Ie]]&&(C.splice(Ie,0,ie),we=!0);we||(C[ue]=ie),ue++}}for(let ie=0;ie<ue;ie++){const he=C[ie];j.push({idx:this.childOffsets[I]+he,t:z[he],nodex:(X<<1)+this._siblingOffset[he][0],nodey:(Q<<1)+this._siblingOffset[he][1],depth:le+1})}}return null}_addNode(s,c,p){return this.minimums.push(s),this.maximums.push(c),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(s,c,p,v,m){if(s[v].isLeaf(c,p)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const x=v-1,k=s[x];let N=0,z=0;for(let C=0;C<this._siblingOffset.length;C++){const R=2*c+this._siblingOffset[C][0],L=2*p+this._siblingOffset[C][1],j=k.getElevation(R,L),I=k.isLeaf(R,L),$=this._addNode(j.min,j.max,I);I&&(N|=1<<C),z||(z=$)}for(let C=0;C<this._siblingOffset.length;C++)N&1<<C||this._construct(s,2*c+this._siblingOffset[C][0],2*p+this._siblingOffset[C][1],x,z+C)}}function i5(h,s,c,p,v,m){return Lr(Lr(h,c,m),Lr(s,p,m),v)}function vg(h,s,c){const p=c.dim,v=ar(h*p-.5,0,p-1),m=ar(s*p-.5,0,p-1),x=Math.floor(v),k=Math.floor(m),N=Math.min(x+1,p-1),z=Math.min(k+1,p-1);return i5(c.get(x,k),c.get(N,k),c.get(x,z),c.get(N,z),v-x,m-k)}const Mae={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function jae(h,s,c){return(256*h*256+256*s+c)/10-1e4}function Oae(h,s,c){return 256*h+s+c/256-32768}class pS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,c,p,v=!1){if(this.uid=s,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void an(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const m=this.dim=c.height-2,x=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.floatView=new Float32Array(c.data.buffer),this.borderReady=v,this._modifiedForSources={},!v){for(let N=0;N<m;N++)x[this._idx(-1,N)]=x[this._idx(0,N)],x[this._idx(m,N)]=x[this._idx(m-1,N)],x[this._idx(N,-1)]=x[this._idx(N,0)],x[this._idx(N,m)]=x[this._idx(N,m-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(m,-1)]=x[this._idx(m-1,0)],x[this._idx(-1,m)]=x[this._idx(0,m-1)],x[this._idx(m,m)]=x[this._idx(m-1,m-1)]}const k=p==="terrarium"?Oae:jae;for(let N=0;N<x.length;++N){const z=4*N;this.floatView[N]=k(this.pixels[z],this.pixels[z+1],this.pixels[z+2])}this._timestamp=He.now()}_buildQuadTree(){this._tree=new n5(this)}get(s,c,p=!1){p&&(s=ar(s,-1,this.dim),c=ar(c,-1,this.dim));const v=this._idx(s,c);return this.floatView[v]}set(s,c,p){const v=this._idx(s,c),m=this.floatView[v];return this.floatView[v]=p,p-m}static getUnpackVector(s){return Mae[s]}_idx(s,c){if(s<-1||s>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(s+1)}static pack(s,c){const p=[0,0,0,0],v=pS.getUnpackVector(c);let m=Math.floor((s+v[3])/v[2]);return p[2]=m%256,m=Math.floor(m/256),p[1]=m%256,m=Math.floor(m/256),p[0]=m,p}getPixels(){return new K_({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,c,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let v=c*this.dim,m=c*this.dim+this.dim,x=p*this.dim,k=p*this.dim+this.dim;switch(c){case-1:v=m-1;break;case 1:m=v+1}switch(p){case-1:x=k-1;break;case 1:k=x+1}const N=-c*this.dim,z=-p*this.dim;for(let C=x;C<k;C++)for(let R=v;R<m;R++){const L=4*this._idx(R,C),j=4*this._idx(R+N,C+z);this.pixels[L+0]=s.pixels[j+0],this.pixels[L+1]=s.pixels[j+1],this.pixels[L+2]=s.pixels[j+2],this.pixels[L+3]=s.pixels[j+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Nae(h,s,c){h===1?s.headerLength=c.readFixed32():h===2?s.x=c.readVarint():h===3?s.y=c.readVarint():h===4?s.z=c.readVarint():h===5&&s.layers.push(function(p,v){return p.readFields(zae,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},v)}(c,c.readVarint()+c.pos))}function Rae(h,s,c){h===1?(s.delta_filter=function(p,v){return p.readFields(Iae,{blockSize:0},v)}(c,c.readVarint()+c.pos),s.filter="delta_filter"):h===2?(c.readVarint(),s.filter="zigzag_filter"):h===3?(c.readVarint(),s.filter="bitshuffle_filter"):h===4&&(c.readVarint(),s.filter="byteshuffle_filter")}function Iae(h,s,c){h===1&&(s.blockSize=c.readVarint())}function Dae(h,s,c){h===1?(c.readVarint(),s.codec="gzip_data"):h===2?(c.readVarint(),s.codec="jpeg_image"):h===3?(c.readVarint(),s.codec="webp_image"):h===4&&(c.readVarint(),s.codec="png_image")}function Lae(h,s,c){let p=0,v=0;h===1?s.firstByte=c.readFixed64():h===2?s.lastByte=c.readFixed64():h===3?s.filters.push(function(m,x){return m.readFields(Rae,{},x)}(c,c.readVarint()+c.pos)):h===4?s.codec=function(m,x){return m.readFields(Dae,{},x)}(c,c.readVarint()+c.pos):h===5?v=c.readFloat():h===6?p=c.readFloat():h===7?s.bands.push(c.readString()):h===8?s.offset=c.readDouble():h===9&&(s.scale=c.readDouble()),s.offset===0&&(s.offset=v),s.scale===0&&(s.scale=p)}function zae(h,s,c){h===1?s.version=c.readVarint():h===2?s.name=c.readString():h===3?s.units=c.readString():h===4?s.tileSize=c.readVarint():h===5?s.buffer=c.readVarint():h===6?s.pixelFormat=c.readVarint():h===7&&s.dataIndex.push(function(p,v){return p.readFields(Lae,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},v)}(c,c.readVarint()+c.pos))}function Fae(h,s,c){if(h===2)(function(p,v,m){p.readFields(Bae,m,v)})(c,c.readVarint()+c.pos,s);else if(h===3)throw new Error("Not implemented")}function Bae(h,s,c){if(h===1){let p=0;const v=c.readVarint()+c.pos;for(;c.pos<v;)s[p++]=c.readVarint()}}function Vae(h,s){if(s.length!==4)throw new Error(`Expected data of dimension 4 but got ${s.length}.`);let c=s[3];for(let p=2;p>=1;p--){const v=p===1?1:0,m=p===2?1:0;for(let x=0;x<s[0];x++){const k=s[1]*x;for(let N=v;N<s[1];N++){const z=s[2]*(N+k);for(let C=m;C<s[2];C++){const R=s[3]*(C+z);for(let L=0;L<s[3];L++){const j=R+L;h[j]+=h[j-c]}}}}c*=s[p]}return h}function Uae(h){for(let s=0,c=h.length;s<c;s++)h[s]=h[s]>>>1^-(1&h[s]);return h}function $ae(h,s){switch(s){case"uint32":return h;case"uint16":for(let c=0;c<h.length;c+=2){const p=h[c],v=h[c+1];h[c]=(240&p)>>4|(61440&p)>>8|(240&v)<<4|61440&v,h[c+1]=15&p|(3840&p)>>4|(15&v)<<8|(3840&v)<<4}return h;case"uint8":for(let c=0;c<h.length;c+=4){const p=h[c],v=h[c+1],m=h[c+2],x=h[c+3];h[c+0]=(192&p)>>6|(192&v)>>4|(192&m)>>2|192&x,h[c+1]=(48&p)>>4|(48&v)>>2|48&m|(48&x)<<2,h[c+2]=(12&p)>>2|12&v|(12&m)<<2|(12&x)<<4,h[c+3]=3&p|(3&v)<<2|(3&m)<<4|(3&x)<<6}return h;default:throw new Error(`Invalid pixel format, "${s}"`)}}mr(pS,"DEMData"),mr(n5,"DemMinMaxQuadTree",{omit:["dem"]});var uu=Uint8Array,xb=Uint16Array,qae=Int32Array,a5=new uu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s5=new uu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Gae=new uu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o5=function(h,s){for(var c=new xb(31),p=0;p<31;++p)c[p]=s+=1<<h[p-1];var v=new qae(c[30]);for(p=1;p<30;++p)for(var m=c[p];m<c[p+1];++m)v[m]=m-c[p]<<5|p;return{b:c,r:v}},l5=o5(a5,2),c5=l5.b,Wae=l5.r;c5[28]=258,Wae[258]=28;for(var Hae=o5(s5,0).b,u5=new xb(32768),as=0;as<32768;++as){var B0=(43690&as)>>1|(21845&as)<<1;u5[as]=((65280&(B0=(61680&(B0=(52428&B0)>>2|(13107&B0)<<2))>>4|(3855&B0)<<4))>>8|(255&B0)<<8)>>1}var _b=function(h,s,c){for(var p=h.length,v=0,m=new xb(s);v<p;++v)h[v]&&++m[h[v]-1];var x,k=new xb(s);for(v=1;v<s;++v)k[v]=k[v-1]+m[v-1]<<1;x=new xb(1<<s);var N=15-s;for(v=0;v<p;++v)if(h[v])for(var z=v<<4|h[v],C=s-h[v],R=k[h[v]-1]++<<C,L=R|(1<<C)-1;R<=L;++R)x[u5[R]>>N]=z;return x},bb=new uu(288);for(as=0;as<144;++as)bb[as]=8;for(as=144;as<256;++as)bb[as]=9;for(as=256;as<280;++as)bb[as]=7;for(as=280;as<288;++as)bb[as]=8;var d5=new uu(32);for(as=0;as<32;++as)d5[as]=5;var Kae=_b(bb,9),Zae=_b(d5,5),dE=function(h){for(var s=h[0],c=1;c<h.length;++c)h[c]>s&&(s=h[c]);return s},mh=function(h,s,c){var p=s/8|0;return(h[p]|h[p+1]<<8)>>(7&s)&c},hE=function(h,s){var c=s/8|0;return(h[c]|h[c+1]<<8|h[c+2]<<16)>>(7&s)},Yae=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],gh=function(h,s,c){var p=new Error(s||Yae[h]);if(p.code=h,Error.captureStackTrace&&Error.captureStackTrace(p,gh),!c)throw p;return p},Xae=new uu(0),Jae=typeof TextDecoder<"u"&&new TextDecoder;try{Jae.decode(Xae,{stream:!0})}catch{}const Qae={gzip_data:"gzip"};class ld extends Error{constructor(s){super(s),this.name="MRTError"}}const ese={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},h5={uint32:1,uint16:2,uint8:4},tse={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let fE;class pE{constructor(s=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=s}getLayer(s){const c=this.layers[s];if(!c)throw new ld(`Layer '${s}' not found`);return c}getHeaderLength(s){const c=new Uint8Array(s),p=new DataView(s);if(c[0]!==13)throw new ld("File is not a valid MRT.");return p.getUint32(1,!0)}parseHeader(s){const c=new Uint8Array(s),p=this.getHeaderLength(s);if(c.length<p)throw new ld(`Expected header with length >= ${p} but got buffer of length ${c.length}`);const v=function(m,x){return m.readFields(Nae,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new fE(c.subarray(0,p)));if(!isNaN(this.x)&&(this.x!==v.x||this.y!==v.y||this.z!==v.z))throw new ld(`Invalid attempt to parse header ${v.z}/${v.x}/${v.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=v.x,this.y=v.y,this.z=v.z;for(const m of v.layers)this.layers[m.name]=new rse(m,{cacheSize:this._cacheSize});return this}createDecodingTask(s){const c=[],p=this.getLayer(s.layerName);for(let v of s.blockIndices){const m=p.dataIndex[v],x=m.firstByte-s.firstByte,k=m.lastByte-s.firstByte;if(p._blocksInProgress.has(v))continue;const N={layerName:p.name,firstByte:x,lastByte:k,pixelFormat:p.pixelFormat,blockIndex:v,blockShape:[m.bands.length].concat(p.bandShape),buffer:p.buffer,codec:m.codec.codec,filters:m.filters.map(z=>z.filter)};p._blocksInProgress.add(v),c.push(N)}return new f5(c,()=>{c.forEach(v=>p._blocksInProgress.delete(v.blockIndex))},(v,m)=>{if(c.forEach(x=>p._blocksInProgress.delete(x.blockIndex)),v)throw v;m.forEach(x=>{this.getLayer(x.layerName).processDecodedData(x)})})}}class rse{constructor({version:s,name:c,units:p,tileSize:v,pixelFormat:m,buffer:x,dataIndex:k},N){if(this.version=s,this.version!==1)throw new ld(`Cannot parse raster layer encoded with MRT version ${s}`);this.name=c,this.units=p,this.tileSize=v,this.buffer=x,this.pixelFormat=ese[m],this.dataIndex=k,this.bandShape=[v+2*x,v+2*x,h5[this.pixelFormat]],this._decodedBlocks=new cE(N?N.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return h5[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:s})=>s).flat()}processDecodedData(s){const c=s.blockIndex.toString();this._decodedBlocks.get(c)||this._decodedBlocks.put(c,s.data)}getBlockForBand(s){let c=0;switch(typeof s){case"string":for(const[p,v]of this.dataIndex.entries()){for(const[m,x]of v.bands.entries())if(x===s)return{bandIndex:c+m,blockIndex:p,blockBandIndex:m};c+=v.bands.length}break;case"number":for(const[p,v]of this.dataIndex.entries()){if(s>=c&&s<c+v.bands.length)return{bandIndex:s,blockIndex:p,blockBandIndex:s-c};c+=v.bands.length}break;default:throw new ld(`Invalid band \`${JSON.stringify(s)}\`. Expected string or integer.`)}throw new ld(`Band not found: ${JSON.stringify(s)}`)}getDataRange(s){let c=1/0,p=-1/0;const v=[],m=new Set;for(const x of s){const{blockIndex:k}=this.getBlockForBand(x);if(k<0)throw new ld(`Invalid band: ${JSON.stringify(x)}`);const N=this.dataIndex[k];v.includes(k)||v.push(k),m.add(k),c=Math.min(c,N.firstByte),p=Math.max(p,N.lastByte)}if(m.size>this.cacheSize)throw new ld(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:c,lastByte:p,blockIndices:v}}hasBand(s){const{blockIndex:c}=this.getBlockForBand(s);return c>=0}hasDataForBand(s){const{blockIndex:c}=this.getBlockForBand(s);return c>=0&&!!this._decodedBlocks.get(c.toString())}getBandView(s){const{blockIndex:c,blockBandIndex:p}=this.getBlockForBand(s),v=this._decodedBlocks.get(c.toString());if(!v)throw new ld(`Data for band ${JSON.stringify(s)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[c],x=this.bandShape.reduce((z,C)=>z*C,1),k=p*x,N=v.subarray(k,k+x);return{data:N,bytes:new Uint8Array(N.buffer).subarray(N.byteOffset,N.byteOffset+N.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}pE.setPbf=function(h){fE=h};class f5{constructor(s,c,p){this.tasks=s,this._onCancel=c,this._onComplete=p,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(s,c){this._finalized||(this._onComplete(s,c),this._finalized=!0)}}pE.performDecoding=function(h,s){const c=new Uint8Array(h);return Promise.all(s.tasks.map(p=>{const{layerName:v,firstByte:m,lastByte:x,pixelFormat:k,blockShape:N,blockIndex:z,filters:C,codec:R}=p,L=c.subarray(m,x+1),j=new Uint32Array(N[0]*N[1]*N[2]);let I;if(R!=="gzip_data")throw new ld(`Unhandled codec: ${R}`);return I=function($,X){if(!globalThis.DecompressionStream&&X==="gzip_data")return Promise.resolve(((ie=function(we){we[0]==31&&we[1]==139&&we[2]==8||gh(6,"invalid gzip data");var Ie=we[3],Ne=10;4&Ie&&(Ne+=2+(we[10]|we[11]<<8));for(var Me=(Ie>>3&1)+(Ie>>4&1);Me>0;Me-=!we[Ne++]);return Ne+(2&Ie)}(ue=$))+8>ue.length&&gh(6,"invalid gzip data"),function(we,Ie,Ne,Me){var Je=we.length;if(!Je||Ie.f&&!Ie.l)return Ne||new uu(0);var Fe=!Ne,tt=Fe||Ie.i!=2,st=Ie.i;Fe&&(Ne=new uu(3*Je));var nt,lt,ft=function(xg){var Qy=Ne.length;if(xg>Qy){var Tb=new uu(Math.max(2*Qy,xg));Tb.set(Ne),Ne=Tb}},vt=Ie.f||0,ct=Ie.p||0,Rt=Ie.b||0,$t=Ie.l,Nt=Ie.d,hr=Ie.m,or=Ie.n,Jt=8*Je;do{if(!$t){vt=mh(we,ct,1);var qt=mh(we,ct+1,3);if(ct+=3,!qt){var Er=we[(cn=4+((ct+7)/8|0))-4]|we[cn-3]<<8,yr=cn+Er;if(yr>Je){st&&gh(0);break}tt&&ft(Rt+Er),Ne.set(we.subarray(cn,yr),Rt),Ie.b=Rt+=Er,Ie.p=ct=8*yr,Ie.f=vt;continue}if(qt==1)$t=Kae,Nt=Zae,hr=9,or=5;else if(qt==2){var br=mh(we,ct,31)+257,Qr=mh(we,ct+10,15)+4,pn=br+mh(we,ct+5,31)+1;ct+=14;for(var vn=new uu(pn),xn=new uu(19),jn=0;jn<Qr;++jn)xn[Gae[jn]]=mh(we,ct+3*jn,7);ct+=3*Qr;var In=dE(xn),Li=(1<<In)-1,Ti=_b(xn,In);for(jn=0;jn<pn;){var cn,yi=Ti[mh(we,ct,Li)];if(ct+=15&yi,(cn=yi>>4)<16)vn[jn++]=cn;else{var bi=0,Zi=0;for(cn==16?(Zi=3+mh(we,ct,3),ct+=2,bi=vn[jn-1]):cn==17?(Zi=3+mh(we,ct,7),ct+=3):cn==18&&(Zi=11+mh(we,ct,127),ct+=7);Zi--;)vn[jn++]=bi}}var Ia=vn.subarray(0,br),ss=vn.subarray(br);hr=dE(Ia),or=dE(ss),$t=_b(Ia,hr),Nt=_b(ss,or)}else gh(1);if(ct>Jt){st&&gh(0);break}}tt&&ft(Rt+131072);for(var Da=(1<<hr)-1,wa=(1<<or)-1,Ga=ct;;Ga=ct){var vs=(bi=$t[hE(we,ct)&Da])>>4;if((ct+=15&bi)>Jt){st&&gh(0);break}if(bi||gh(2),vs<256)Ne[Rt++]=vs;else{if(vs==256){Ga=ct,$t=null;break}var ko=vs-254;vs>264&&(ko=mh(we,ct,(1<<(vh=a5[jn=vs-257]))-1)+c5[jn],ct+=vh);var Wi=Nt[hE(we,ct)&wa],ec=Wi>>4;if(Wi||gh(3),ct+=15&Wi,ss=Hae[ec],ec>3){var vh=s5[ec];ss+=hE(we,ct)&(1<<vh)-1,ct+=vh}if(ct>Jt){st&&gh(0);break}tt&&ft(Rt+131072);var cd=Rt+ko;if(Rt<ss){var ud=0-ss,Jy=Math.min(ss,cd);for(ud+Rt<0&&gh(3);Rt<Jy;++Rt)Ne[Rt]=(void 0)[ud+Rt]}for(;Rt<cd;++Rt)Ne[Rt]=Ne[Rt-ss]}}Ie.l=$t,Ie.p=Ga,Ie.b=Rt,Ie.f=vt,$t&&(vt=1,Ie.m=hr,Ie.d=Nt,Ie.n=or)}while(!vt);return Rt!=Ne.length&&Fe?(nt=Ne,((lt=Rt)==null||lt>nt.length)&&(lt=nt.length),new uu(nt.subarray(0,lt))):Ne.subarray(0,Rt)}(ue.subarray(ie,-8),{i:2},new uu(((Q=ue)[(le=Q.length)-4]|Q[le-3]<<8|Q[le-2]<<16|Q[le-1]<<24)>>>0))));var Q,le,ue,ie;const he=Qae[X];if(!he)throw new Error(`Unhandled codec: ${X}`);const me=new globalThis.DecompressionStream(he);return new Response(new Blob([$]).stream().pipeThrough(me)).arrayBuffer().then(we=>new Uint8Array(we))}(L,R).then($=>(function(X,Q){X.readFields(Fae,Q)}(new fE($),j),new tse[k](j.buffer))),I.then($=>{for(let X=C.length-1;X>=0;X--)switch(C[X]){case"delta_filter":Vae($,N);break;case"zigzag_filter":Uae($);break;case"bitshuffle_filter":$ae($,k);break;default:throw new ld(`Unhandled filter "${C[X]}"`)}return{layerName:v,blockIndex:z,data:$}}).catch($=>{throw $})}))},mr(f5,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let wb,mE,yh,V0,gE,U0=null;function p5(){return Us()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:mE||Ui.DRACO_URL}function m5(){if(Us()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(V0)return V0;const h=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return V0=WebAssembly.validate(h)?Ui.MESHOPT_SIMD_URL:Ui.MESHOPT_URL,V0}const mS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},nse={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Sb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function g5(h,s,c){const p=c.json.bufferViews.length,v=c.buffers.length;s.bufferView=p,c.json.bufferViews[p]={buffer:v,byteLength:h.byteLength},c.buffers[v]=h}const yE="KHR_draco_mesh_compression";function ise(h,s){const c=h.extensions&&h.extensions[yE];if(!c)return;const p=new yh.Decoder,v=_5(s,c.bufferView),m=new yh.Mesh;if(!p.DecodeArrayToMesh(v,v.byteLength,m))throw new Error("Failed to decode Draco mesh");const x=s.json.accessors[h.indices],k=mS[x.componentType],N=x.count*k.BYTES_PER_ELEMENT,z=yh._malloc(N);k===Uint16Array?p.GetTrianglesUInt16Array(m,N,z):p.GetTrianglesUInt32Array(m,N,z),g5(yh.memory.buffer.slice(z,z+N),x,s),yh._free(z);for(const C of Object.keys(c.attributes)){const R=p.GetAttributeByUniqueId(m,c.attributes[C]),L=s.json.accessors[h.attributes[C]],j=nse[L.componentType],I=L.count*Sb[L.type]*mS[L.componentType].BYTES_PER_ELEMENT,$=yh._malloc(I);p.GetAttributeDataArrayForAllPoints(m,R,yh[j],I,$),g5(yh.memory.buffer.slice($,$+I),L,s),yh._free($)}p.destroy(),m.destroy(),delete h.extensions[yE]}const gS="EXT_meshopt_compression";function ase(h,s){if(!h.extensions||!h.extensions[gS])return;const c=h.extensions[gS],p=new Uint8Array(s.buffers[c.buffer],c.byteOffset||0,c.byteLength||0),v=new Uint8Array(c.count*c.byteStride);gE.decodeGltfBuffer(v,c.count,c.byteStride,p,c.mode,c.filter),h.buffer=s.buffers.length,h.byteOffset=0,s.buffers[h.buffer]=v.buffer,delete h.extensions[gS]}const y5=1179937895,v5=new TextDecoder("utf8");function x5(h,s){return new URL(h,s).href}function sse(h,s,c,p){return fetch(x5(h.uri,p)).then(v=>v.arrayBuffer()).then(v=>{s.buffers[c]=v})}function _5(h,s){const c=h.json.bufferViews[s];return new Uint8Array(h.buffers[c.buffer],c.byteOffset||0,c.byteLength)}function ose(h,s,c,p){if(h.uri){const v=x5(h.uri,p);return fetch(v).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{s.images[c]=m})}if(h.bufferView!==void 0){const v=_5(s,h.bufferView),m=new Blob([v],{type:h.mimeType});return createImageBitmap(m).then(x=>{s.images[c]=x})}}function b5(h,s=0,c){const p={json:null,images:[],buffers:[]};if(new Uint32Array(h,s,1)[0]===y5){const C=new Uint32Array(h,s);let R=2;const L=(C[R++]>>2)-3,j=C[R++]>>2;if(R++,p.json=JSON.parse(v5.decode(C.subarray(R,R+j))),R+=j,R<L){const I=C[R++];R++;const $=s+(R<<2);p.buffers[0]=h.slice($,$+I)}}else p.json=JSON.parse(v5.decode(new Uint8Array(h,s)));const{buffers:v,images:m,meshes:x,extensionsUsed:k,bufferViews:N}=p.json;let z=Promise.resolve();if(v){const C=[];for(let R=0;R<v.length;R++){const L=v[R];L.uri?C.push(sse(L,p,R,c)):p.buffers[R]||(p.buffers[R]=null)}z=Promise.all(C)}return z.then(()=>{const C=[],R=k&&k.includes(yE),L=k&&k.includes(gS);if(R&&C.push(function(){if(!yh)return wb??(wb=function(j){let I,$=null;function X(){I=new Uint8Array($.buffer)}function Q(){throw new Error("Unexpected Draco error.")}const le={a:{a:Q,d:function(ue,ie,he){return I.copyWithin(ue,ie,ie+he)},c:function(ue){const ie=I.length,he=Math.max(ue>>>0,Math.ceil(1.2*ie)),me=Math.ceil((he-ie)/65536);try{return $.grow(me),X(),!0}catch{return!1}},b:Q}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(j,le):j.then(ue=>ue.arrayBuffer()).then(ue=>WebAssembly.instantiate(ue,le))).then(ue=>{const{Rb:ie,Qb:he,P:me,T:we,X:Ie,Ja:Ne,La:Me,Qa:Je,Va:Fe,Wa:tt,eb:st,jb:nt,f:lt,e:ft,yb:vt,zb:ct,Ab:Rt,Bb:$t,Db:Nt,Gb:hr}=ue.instance.exports;$=ft;const or=(()=>{let Jt=0,qt=0,Er=0,yr=0;return br=>{Er&&(ie(yr),ie(Jt),qt+=Er,Er=Jt=0),Jt||(qt+=128,Jt=he(qt));const Qr=br.length+7&-8;let pn=Jt;Qr>=qt&&(Er=Qr,pn=yr=he(Qr));for(let vn=0;vn<br.length;vn++)I[pn+vn]=br[vn];return pn}})();return X(),lt(),{memory:ft,_free:ie,_malloc:he,Mesh:class{constructor(){this.ptr=me()}destroy(){we(this.ptr)}},Decoder:class{constructor(){this.ptr=Ne()}destroy(){nt(this.ptr)}DecodeArrayToMesh(Jt,qt,Er){const yr=or(Jt),br=Me(this.ptr,yr,qt,Er.ptr);return!!Ie(br)}GetAttributeByUniqueId(Jt,qt){return{ptr:Je(this.ptr,Jt.ptr,qt)}}GetTrianglesUInt16Array(Jt,qt,Er){Fe(this.ptr,Jt.ptr,qt,Er)}GetTrianglesUInt32Array(Jt,qt,Er){tt(this.ptr,Jt.ptr,qt,Er)}GetAttributeDataArrayForAllPoints(Jt,qt,Er,yr,br){st(this.ptr,Jt.ptr,qt.ptr,Er,yr,br)}},DT_INT8:vt(),DT_UINT8:ct(),DT_INT16:Rt(),DT_UINT16:$t(),DT_UINT32:Nt(),DT_FLOAT32:hr()}})}(fetch(p5())),wb.then(j=>{yh=j,wb=void 0}))}()),L&&C.push(function(){if(gE)return;const j=function(I){let $;const X=WebAssembly.instantiateStreaming(I,{}).then(ue=>{$=ue.instance,$.exports.__wasm_call_ctors()}),Q={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},le={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:X,supported:!0,decodeGltfBuffer(ue,ie,he,me,we,Ie){(function(Ne,Me,Je,Fe,tt,st,nt){const lt=Ne.exports.sbrk,ft=Fe+3&-4,vt=lt(ft*tt),ct=lt(st.length),Rt=new Uint8Array(Ne.exports.memory.buffer);Rt.set(st,ct);const $t=Me(vt,Fe,tt,ct,st.length);if($t===0&&nt&&nt(vt,ft,tt),Je.set(Rt.subarray(vt,vt+Fe*tt)),lt(vt-lt(0)),$t!==0)throw new Error(`Malformed buffer data: ${$t}`)})($,$.exports[le[we]],ue,ie,he,me,$.exports[Q[Ie]])}}}(fetch(m5()));return j.ready.then(()=>{gE=j})}()),m)for(let j=0;j<m.length;j++)C.push(ose(m[j],p,j,c));return(C.length?Promise.all(C):Promise.resolve()).then(()=>{if(R&&x)for(const{primitives:j}of x)for(const I of j)ise(I,p);if(L&&x&&N)for(const j of N)ase(j,p);return p})})}function Xy(h,s){const c=h.json.bufferViews[s.bufferView],p=mS[s.componentType];return new p(h.buffers[c.buffer],(s.byteOffset||0)+(c.byteOffset||0),s.count*(c.byteStride&&c.byteStride!==Sb[s.type]*p.BYTES_PER_ELEMENT?c.byteStride/p.BYTES_PER_ELEMENT:Sb[s.type]))}function vE(h,s,c,p){const v=mS[s.componentType],m=function(C){switch(C){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(v),x=h.json.bufferViews[s.bufferView],k=x.byteStride?x.byteStride/v.BYTES_PER_ELEMENT:Sb[s.type],N=c.float32,z=N.length/c.capacity;for(let C=0,R=0;C<s.count*k;C+=k,R+=z)for(let L=0;L<z;L++)N[R+L]=p[C+L]*m;c._trim()}function lse(h,s,c){const p=h.indices,v=h.attributes,m={};m.indexArray=new ms;const x=s.json.accessors[p],k=x.count/3;m.indexArray.reserve(k);const N=Xy(s,x);for(let L=0;L<k;L++)m.indexArray.emplaceBack(N[3*L],N[3*L+1],N[3*L+2]);m.indexArray._trim(),m.vertexArray=new Wo;const z=s.json.accessors[v.POSITION];m.vertexArray.reserve(z.count);const C=Xy(s,z);for(let L=0;L<z.count;L++)m.vertexArray.emplaceBack(C[3*L],C[3*L+1],C[3*L+2]);if(m.vertexArray._trim(),m.aabb=new Sr(z.min,z.max),m.centroid=function(L,j){const I=[0,0,0],$=L.length;if($>0){for(let X=0;X<$;X++){const Q=3*L[X];I[0]+=j[Q],I[1]+=j[Q+1],I[2]+=j[Q+2]}I[0]/=$,I[1]/=$,I[2]/=$}return I}(N,C),v.COLOR_0!==void 0){const L=s.json.accessors[v.COLOR_0],j=Sb[L.type],I=Xy(s,L);m.colorArray=j===3?new Wo:new nu,m.colorArray.resize(L.count),vE(s,L,m.colorArray,I)}if(v.NORMAL!==void 0){m.normalArray=new Wo;const L=s.json.accessors[v.NORMAL];m.normalArray.resize(L.count);const j=Xy(s,L);vE(s,L,m.normalArray,j)}if(v.TEXCOORD_0!==void 0&&c.length>0){m.texcoordArray=new ih;const L=s.json.accessors[v.TEXCOORD_0];m.texcoordArray.resize(L.count);const j=Xy(s,L);vE(s,L,m.texcoordArray,j)}if(v._FEATURE_ID_RGBA4444!==void 0){const L=s.json.accessors[v._FEATURE_ID_RGBA4444];s.json.extensionsUsed&&s.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=Xy(s,L))}v._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(Xy(s,s.json.accessors[v._FEATURE_RGBA4444]).buffer));const R=h.material;return m.material=function(L,j){const{emissiveFactor:I=[0,0,0],alphaMode:$="OPAQUE",alphaCutoff:X=.5,normalTexture:Q,occlusionTexture:le,emissiveTexture:ue,doubleSided:ie}=L,{baseColorFactor:he=[1,1,1,1],metallicFactor:me=1,roughnessFactor:we=1,baseColorTexture:Ie,metallicRoughnessTexture:Ne}=L.pbrMetallicRoughness||{},Me=le?j[le.index]:void 0;if(le&&le.extensions&&le.extensions.KHR_texture_transform&&Me){const Je=le.extensions.KHR_texture_transform;Me.offsetScale=[Je.offset[0],Je.offset[1],Je.scale[0],Je.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Jn(...he),metallicFactor:me,roughnessFactor:we,baseColorTexture:Ie?j[Ie.index]:void 0,metallicRoughnessTexture:Ne?j[Ne.index]:void 0},doubleSided:ie,emissiveFactor:I,alphaMode:$,alphaCutoff:X,normalTexture:Q?j[Q.index]:void 0,occlusionTexture:Me,emissionTexture:ue?j[ue.index]:void 0,defined:L.defined===void 0}}(R!==void 0?s.json.materials[R]:{defined:!1},c),m}function w5(h,s,c){const{matrix:p,rotation:v,translation:m,scale:x,mesh:k,extras:N,children:z}=h,C={};if(C.matrix=p||De.mat4.fromRotationTranslationScale([],v||[0,0,0,1],m||[0,0,0],x||[1,1,1]),k!==void 0){C.meshes=c[k];const R=C.anchor=[0,0];for(const L of C.meshes){const{min:j,max:I}=L.aabb;R[0]+=j[0]+I[0],R[1]+=j[1]+I[1]}R[0]=Math.floor(R[0]/C.meshes.length/2),R[1]=Math.floor(R[1]/C.meshes.length/2)}if(N&&(N.id&&(C.id=N.id),N.lights&&(C.lights=function(R){if(!R.length)return[];const L=function(Q){const le=atob(Q),ue=new Uint8Array(le.length);for(let ie=0;ie<le.length;ie++)ue[ie]=le.codePointAt(ie);return ue}(R),j=[],I=L.length/24,$=new Uint16Array(L.buffer),X=new Float32Array(L.buffer);for(let Q=0;Q<I;Q++){const le=$[2*Q*6]/30,ue=$[2*Q*6+1]/30,ie=$[2*Q*6+10]/100,he=X[6*Q+1],me=X[6*Q+2],we=X[6*Q+3],Ie=X[6*Q+4],Ne=we-he,Me=Ie-me,Je=Math.hypot(Ne,Me);j.push({pos:[he+.5*Ne,me+.5*Me,ue],normal:[Me/Je,-Ne/Je,0],width:Je,height:le,depth:ie,points:[he,me,we,Ie]})}return j}(N.lights))),z){const R=[];for(const L of z)R.push(w5(s.json.nodes[L],s,c));C.children=R}return C}function cse(h){if(h.vertices.length===0||h.indices.length===0)return null;const s=new Nr(h.vertices,h.indices,8,256),[c,p]=[s.min.clone(),s.max.clone()];return{vertices:h.vertices,indices:h.indices,grid:s,min:c,max:p}}function use(h){if(!h.extras||!h.extras.ground)return null;const s=h.extras.ground;if(!s||!Array.isArray(s)||s.length===0)return null;const c=s[0];if(!c||!Array.isArray(c)||c.length===0)return null;const p=[];for(const x of c){if(!Array.isArray(x)||x.length!==2)continue;const k=x[0],N=x[1];typeof k=="number"&&typeof N=="number"&&p.push(new Pt(k,N))}if(p.length<3)return null;p.length>1&&p[p.length-1].equals(p[0])&&p.pop();let v=0;for(let x=0;x<p.length;x++){const k=p[x],N=p[(x+1)%p.length],z=p[(x+2)%p.length];v+=(k.x-N.x)*(z.y-N.y)-(z.x-N.x)*(k.y-N.y)}v>0&&p.reverse();const m=dg(p.flatMap(x=>[x.x,x.y]),[]);return m.length===0?null:{vertices:p,indices:m}}function dse(h,s){const c=[],p=[];let v=0;const m=[];for(const x of h){v=c.length;const k=x.vertexArray.float32,N=x.indexArray.uint16;for(let z=0;z<x.vertexArray.length;z++)m[0]=k[3*z+0],m[1]=k[3*z+1],m[2]=k[3*z+2],De.vec3.transformMat4(m,m,s),c.push(new Pt(m[0],m[1]));for(let z=0;z<3*x.indexArray.length;z++)p.push(N[z]+v)}if(p.length%3!=0)return null;for(let x=0;x<p.length;x+=3){const k=c[p[x+0]],N=c[p[x+1]],z=c[p[x+2]];(k.x-N.x)*(z.y-N.y)-(z.x-N.x)*(k.y-N.y)>0&&([p[x+1],p[x+2]]=[p[x+2],p[x+1]])}return{vertices:c,indices:p}}function S5(h){const s=function(N,z){const C=[],R=WebGL2RenderingContext;if(N.json.textures)for(const L of N.json.textures){const j={magFilter:R.LINEAR,minFilter:R.NEAREST,wrapS:R.REPEAT,wrapT:R.REPEAT};L.sampler!==void 0&&Object.assign(j,N.json.samplers[L.sampler]),C.push({image:z[L.source],sampler:j,uploaded:!1})}return C}(h,h.images),c=function(N,z){const C=[];for(const R of N.json.meshes){const L=[];for(const j of R.primitives)L.push(lse(j,N,z));C.push(L)}return C}(h,s),{scenes:p,scene:v,nodes:m}=h.json,x=p?p[v||0].nodes:m,k=[];for(const N of x)k.push(w5(m[N],h,c));return function(N,z,C){const R={},L=new Set;for(let j=0;j<N.length;j++){const I=C[z[j]];if(!I.extras)continue;const $=I.extras["mapbox:footprint:version"],X=I.extras["mapbox:footprint:id"];($||X)&&L.add(j),$==="1.0.0"&&X&&(R[X]=j)}for(let j=0;j<N.length;j++){if(L.has(j))continue;const I=N[j],$=C[z[j]];if(!$.extras)continue;let X=null;I.id in R&&(X=dse(N[R[I.id]].meshes,I.matrix)),X||(X=use($)),X&&(I.footprint=cse(X))}if(L.size>0){const j=Array.from(L.values()).sort((I,$)=>I-$);for(let I=j.length-1;I>=0;I--)N.splice(j[I],1)}}(k,x,h.json.nodes),k}function hse(h){h.heightmap=new Float32Array(4096),h.heightmap.fill(-1);const s=h.vertexArray.float32,c=h.aabb.min[0]-1,p=h.aabb.min[1]-1,v=Ky/(h.aabb.max[0]-c+2),m=Ky/(h.aabb.max[1]-p+2);for(let x=0;x<s.length;x+=3){const k=s[x+2],N=(s[x+0]-c)*v|0,z=(s[x+1]-p)*m|0;k>h.heightmap[z*Ky+N]&&(h.heightmap[z*Ky+N]=k)}}function fse(h,s){const c={};c.indexArray=new ms,c.indexArray.reserve(4*h.length),c.vertexArray=new Wo,c.vertexArray.reserve(10*h.length),c.colorArray=new nu,c.vertexArray.reserve(10*h.length);let p=0;for(const x of h){const k=Math.min(10,Math.max(4,1.3*x.height))*s,N=[-x.normal[1],x.normal[0],0],z=Math.min(.29,.1*x.width/x.depth),C=x.width-2*x.depth*s*(z+.01),R=De.vec3.scaleAndAdd([],x.pos,N,C/2),L=De.vec3.scaleAndAdd([],x.pos,N,-C/2),j=[R[0],R[1],R[2]+x.height],I=[L[0],L[1],L[2]+x.height],$=De.vec3.scaleAndAdd([],x.normal,N,z);De.vec3.scale($,$,k);const X=De.vec3.scaleAndAdd([],x.normal,N,-z);De.vec3.scale(X,X,k),De.vec3.add($,R,$),De.vec3.add(X,L,X),R[2]+=.1,L[2]+=.1,c.vertexArray.emplaceBack($[0],$[1],$[2]),c.vertexArray.emplaceBack(X[0],X[1],X[2]),c.vertexArray.emplaceBack(R[0],R[1],R[2]),c.vertexArray.emplaceBack(L[0],L[1],L[2]),c.vertexArray.emplaceBack(j[0],j[1],j[2]),c.vertexArray.emplaceBack(I[0],I[1],I[2]),c.vertexArray.emplaceBack(R[0],R[1],R[2]),c.vertexArray.emplaceBack(L[0],L[1],L[2]),c.vertexArray.emplaceBack($[0],$[1],$[2]),c.vertexArray.emplaceBack(X[0],X[1],X[2]);const Q=C/k/2;c.colorArray.emplaceBack(-Q-z,-1,Q,.8),c.colorArray.emplaceBack(Q+z,-1,Q,.8),c.colorArray.emplaceBack(-Q,0,Q,1.3),c.colorArray.emplaceBack(Q,0,Q,1.3),c.colorArray.emplaceBack(Q+z,-.8,Q,.7),c.colorArray.emplaceBack(Q+z,-.8,Q,.7),c.colorArray.emplaceBack(0,0,Q,1.3),c.colorArray.emplaceBack(0,0,Q,1.3),c.colorArray.emplaceBack(Q+z,-1.2,Q,.8),c.colorArray.emplaceBack(Q+z,-1.2,Q,.8),c.indexArray.emplaceBack(6+p,4+p,8+p),c.indexArray.emplaceBack(7+p,9+p,5+p),c.indexArray.emplaceBack(0+p,1+p,2+p),c.indexArray.emplaceBack(1+p,3+p,2+p),p+=10}const v={defined:!0,emissiveFactor:[0,0,0]},m={};return m.baseColorFactor=Jn.white,v.pbrMetallicRoughness=m,c.material=v,c.aabb=new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),c}class A5{constructor(s){this._stringToNumber={},this._numberToString=[];for(let c=0;c<s.length;c++){const p=s[c];this._stringToNumber[p]=c,this._numberToString[c]=p}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const pse=["id","tile","layer","source","sourceLayer","state"];class $0{constructor(s,c,p,v,m){this.type="Feature",this._vectorTileFeature=s,this._z=c,this._x=p,this._y=v,this.properties=s.properties,this.id=m}clone(){const s=new $0(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(s.state=Object.assign({},this.state)),this.layer&&(s.layer=Object.assign({},this.layer)),this.source&&(s.source=this.source),this.sourceLayer&&(s.sourceLayer=this.sourceLayer),s}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const c of pse)this[c]!==void 0&&(s[c]=this[c]);return s}}class T5{constructor(s,c){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new _c(lr,16,0),this.featureIndexArray=new Fp,this.promoteId=c,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(s,c,p,v,m,x=0,k=0){const N=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,m,x);const z=this.grid;for(let C=0;C<c.length;C++){const R=c[C],L=[1/0,1/0,-1/0,-1/0];for(let j=0;j<R.length;j++){const I=R[j];L[0]=Math.min(L[0],I.x),L[1]=Math.min(L[1],I.y),L[2]=Math.max(L[2],I.x),L[3]=Math.max(L[3],I.y)}k!==0&&(L[0]-=k,L[1]-=k,L[2]+=k,L[3]+=k),L[0]<lr&&L[1]<lr&&L[2]>=0&&L[3]>=0&&z.insert(N,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new k0.VectorTile(new F2(this.rawTileData)).layers,this.sourceLayerCoder=new A5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,c){const{tilespaceGeometry:p,transform:v,tileTransform:m,pixelPosMatrix:x,availableImages:k}=c;this.loadVTLayers(),this.serializedLayersCache.clear();const N=p.bufferedTilespaceBounds,z=this.grid.query(N.min.x,N.min.y,N.max.x,N.max.y,(j,I,$,X)=>Ke(p.bufferedTilespaceGeometry,j,I,$,X));z.sort(mse);let C=null;v.elevation&&z.length>0&&(C=D0.create(v.elevation,this.tileID));const R={};let L;for(let j=0;j<z.length;j++){const I=z[j];if(I===L)continue;L=I;const $=this.featureIndexArray.get(I);let X=null;this.is3DTile?this.loadMatchingModelFeature(R,$,s,p,v):this.loadMatchingFeature(R,$,s,k,(Q,le,ue,ie=0)=>(X||(X=Y(Q,this.tileID.canonical,m)),le.queryIntersectsFeature(p,Q,ue,X,this.z,v,x,C,ie)))}return R}loadMatchingFeature(s,c,p,v,m){const{featureIndex:x,bucketIndex:k,sourceLayerIndex:N,layoutVertexArrayOffset:z}=c,C=this.bucketLayerIDs[k],R=p.layers,L=Object.keys(R);if(L.length&&!function(Q,le){for(let ue=0;ue<Q.length;ue++)if(le.indexOf(Q[ue])>=0)return!0;return!1}(L,C))return;const j=p.sourceCache,I=this.sourceLayerCoder.decode(N),$=this.vtLayers[I].feature(x),X=this.getId($,I);for(let Q=0;Q<C.length;Q++){const le=C[Q];if(!R[le])continue;const{styleLayer:ue,targets:ie}=R[le];let he={};X!==void 0&&(he=j.getFeatureState(ue.sourceLayer,X));const me=!m||m($,ue,he,z);if(!me)continue;const we=new $0($,this.z,this.x,this.y,X);we.tile=this.tileID.canonical,we.state=he;let Ie=this.serializedLayersCache.get(le);Ie||(Ie=ue.serialize(),Ie.id=le,this.serializedLayersCache.set(le,Ie)),we.source=Ie.source,we.sourceLayer=Ie["source-layer"],we.layer=Vi({},Ie),we.layer.paint=P5(Ie.paint,ue.paint,$,he,v),we.layer.layout=P5(Ie.layout,ue.layout,$,he,v);let Ne=!1;for(const Me of ie){this.updateFeatureProperties(we,Me);const{filter:Je}=Me;if(Je){if($.properties=we.properties,Je.needGeometry){const Fe=te($,!0);if(!Je.filter(new xi(this.tileID.overscaledZ),Fe,this.tileID.canonical))continue}else if(!Je.filter(new xi(this.tileID.overscaledZ),$))continue}Ne=!0,Me.targetId&&this.addFeatureVariant(we,Me)}Ne&&this.appendToResult(s,le,x,we,me)}}loadMatchingModelFeature(s,c,p,v,m){const x=this.bucketLayerIDs[0][0],k=p.layers;if(!k[x])return;const{styleLayer:N,targets:z}=k[x];if(N.type!=="model")return;const C=v.tile,R=c.featureIndex,L=C.getBucket(N);if(!(L&&L instanceof oS))return;const j=function(Ie,Ne,Me,Je){const Fe=Ie.getNodesInfo()[Ne];if(Fe.hiddenByReplacement||!Fe.node.meshes)return;let tt=Number.MAX_VALUE;const st=Fe.node,nt=Me.tile,lt=Je.calculatePosMatrix(nt.tileID.toUnwrapped(),Je.worldSize),ft=Fe.evaluatedScale;let vt=0;Je.elevation&&st.elevation&&(vt=st.elevation*Je.elevation.exaggeration()),De.mat4.translate(lt,lt,[(st.anchor?st.anchor[0]:0)*(ft[0]-1),(st.anchor?st.anchor[1]:0)*(ft[1]-1),vt]),De.mat4.scale(lt,lt,ft);const ct=Me.queryGeometry,Rt=ct.isPointQuery()?ct.screenBounds:ct.screenGeometry,$t=function(hr){const or=De.mat4.multiply([],lt,hr.matrix);De.mat4.multiply(or,Je.expandedFarZProjMatrix,or);for(let Jt=0;Jt<hr.meshes.length;++Jt){const qt=hr.meshes[Jt];if(Jt===hr.lightMeshIndex)continue;const Er=AF(Rt,Je,or,qt.aabb);Er!=null&&(tt=Math.min(Er,tt))}if(hr.children)for(const Jt of hr.children)$t(Jt)};if($t(st),tt===Number.MAX_VALUE)return;const Nt=new Kn(0,0);return DF(nt.tileID.canonical,Nt,Fe.node.anchor[0],Fe.node.anchor[1]),{intersectionZ:tt,position:Nt,feature:Fe.feature}}(L,R,v,m);if(!j)return;const{z:I,x:$,y:X}=C.tileID.canonical,{feature:Q,intersectionZ:le,position:ue}=j;let ie={};Q.id!==void 0&&(ie=p.sourceCache.getFeatureState(N.sourceLayer,Q.id));const he=new $0({},I,$,X,Q.id);he.tile=this.tileID.canonical,he.state=ie,he.properties=Q.properties,he.geometry={type:"Point",coordinates:[ue.lng,ue.lat]};let me=this.serializedLayersCache.get(x);me||(me=N.serialize(),me.id=x,this.serializedLayersCache.set(x,me)),he.source=me.source,he.sourceLayer=me["source-layer"],he.layer=Vi({},me);let we=!1;for(const Ie of z){this.updateFeatureProperties(he,Ie);const{filter:Ne}=Ie;if(Ne){if(Q.properties=he.properties,Ne.needGeometry){if(!Ne.filter(new xi(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!Ne.filter(new xi(this.tileID.overscaledZ),Q))continue}we=!0,Ie.targetId&&this.addFeatureVariant(he,Ie)}we&&this.appendToResult(s,x,R,he,le)}updateFeatureProperties(s,c,p){if(c.properties){const v={};for(const m in c.properties){const x=c.properties[m].evaluate({zoom:this.z},s._vectorTileFeature,s.state,s.tile,p);x!=null&&(v[m]=x)}s.properties=v}}addFeatureVariant(s,c,p){const v={target:c.target,namespace:c.namespace,uniqueFeatureID:c.uniqueFeatureID};c.properties&&(v.properties=s.properties),s.variants=s.variants||{},s.variants[c.targetId]=s.variants[c.targetId]||[],s.variants[c.targetId].push(v)}appendToResult(s,c,p,v,m){let x=s[c];x===void 0&&(x=s[c]=[]),x.push({featureIndex:p,feature:v,intersectionZ:m})}lookupSymbolFeatures(s,c,p,v,m){const x={};this.loadVTLayers();for(const k of s)this.loadMatchingFeature(x,{bucketIndex:c,sourceLayerIndex:p,featureIndex:k,layoutVertexArrayOffset:0},v,m);return x}loadFeature(s){const{featureIndex:c,sourceLayerIndex:p}=s;this.loadVTLayers();const v=this.sourceLayerCoder.decode(p),m=this.vtFeatures[v];if(m[c])return m[c];const x=this.vtLayers[v].feature(c);return m[c]=x,x}hasLayer(s){for(const c of this.bucketLayerIDs)for(const p of c)if(s===p)return!0;return!1}getId(s,c){let p=s.id;if(this.promoteId){const v=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[c];if(v!=null)if(Array.isArray(v)){if(!this.promoteIdExpression){const m=qo(v);if(m.result!=="success"){const x=m.value.map(k=>`${k.key}: ${k.message}`).join(", ");return void an(`Failed to create expression for promoteId: ${x}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new py),p=this.promoteIdExpression.evaluate({zoom:0},s)}else p=s.properties[v];typeof p=="boolean"&&(p=Number(p))}return p}}function P5(h,s,c,p,v){return ql(h,(m,x)=>{const k=s instanceof Ju?s.get(x):null;return k&&k.evaluate?k.evaluate(c,p,v):k})}function mse(h,s){return s-h}mr(T5,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const C5=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xE{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,p]=new Uint8Array(s,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const m=C5[15&p];if(!m)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(s,2,1),[k]=new Uint32Array(s,4,1);return new xE(k,x,m,s)}constructor(s,c=64,p=Float64Array,v){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const m=C5.indexOf(this.ArrayType),x=2*s*this.ArrayType.BYTES_PER_ELEMENT,k=s*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-k%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+k+N,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+x+k+N),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+k+N,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=s)}add(s,c){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=c,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return _E(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,c,p,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:k}=this,N=[0,m.length-1,0],z=[];for(;N.length;){const C=N.pop()||0,R=N.pop()||0,L=N.pop()||0;if(R-L<=k){for(let X=L;X<=R;X++){const Q=x[2*X],le=x[2*X+1];Q>=s&&Q<=p&&le>=c&&le<=v&&z.push(m[X])}continue}const j=L+R>>1,I=x[2*j],$=x[2*j+1];I>=s&&I<=p&&$>=c&&$<=v&&z.push(m[j]),(C===0?s<=I:c<=$)&&(N.push(L),N.push(j-1),N.push(1-C)),(C===0?p>=I:v>=$)&&(N.push(j+1),N.push(R),N.push(1-C))}return z}within(s,c,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:m,nodeSize:x}=this,k=[0,v.length-1,0],N=[],z=p*p;for(;k.length;){const C=k.pop()||0,R=k.pop()||0,L=k.pop()||0;if(R-L<=x){for(let X=L;X<=R;X++)k5(m[2*X],m[2*X+1],s,c)<=z&&N.push(v[X]);continue}const j=L+R>>1,I=m[2*j],$=m[2*j+1];k5(I,$,s,c)<=z&&N.push(v[j]),(C===0?s-p<=I:c-p<=$)&&(k.push(L),k.push(j-1),k.push(1-C)),(C===0?s+p>=I:c+p>=$)&&(k.push(j+1),k.push(R),k.push(1-C))}return N}}function _E(h,s,c,p,v,m){if(v-p<=c)return;const x=p+v>>1;E5(h,s,x,p,v,m),_E(h,s,c,p,x-1,1-m),_E(h,s,c,x+1,v,1-m)}function E5(h,s,c,p,v,m){for(;v>p;){if(v-p>600){const z=v-p+1,C=c-p+1,R=Math.log(z),L=.5*Math.exp(2*R/3),j=.5*Math.sqrt(R*L*(z-L)/z)*(C-z/2<0?-1:1);E5(h,s,c,Math.max(p,Math.floor(c-C*L/z+j)),Math.min(v,Math.floor(c+(z-C)*L/z+j)),m)}const x=s[2*c+m];let k=p,N=v;for(Ab(h,s,p,c),s[2*v+m]>x&&Ab(h,s,p,v);k<N;){for(Ab(h,s,k,N),k++,N--;s[2*k+m]<x;)k++;for(;s[2*N+m]>x;)N--}s[2*p+m]===x?Ab(h,s,p,N):(N++,Ab(h,s,N,v)),N<=c&&(p=N+1),c<=N&&(v=N-1)}}function Ab(h,s,c,p){bE(h,c,p),bE(s,2*c,2*p),bE(s,2*c+1,2*p+1)}function bE(h,s,c){const p=h[s];h[s]=h[c],h[c]=p}function k5(h,s,c,p){const v=h-c,m=s-p;return v*v+m*m}i.$=Op,i.A=Ts,i.B=2,i.C=sb,i.D=L0,i.E=Uc,i.F=Vz,i.G=class extends aS{},i.H=vo,i.I=uE,i.J=Ru,i.K=wc,i.L=kl,i.M=El,i.N=Ji,i.O=Wd,i.P=Pt,i.Q=Yl,i.R=En,i.S=Cy,i.T=YC,i.U=qo,i.V=aS,i.W=vc,i.X=Vu,i.Y=Yc,i.Z=xo,i._=Fo,i.a=function(h){return Ui.API_CDN_URL_REGEX.test(h)},i.a$=$0,i.a0=Is,i.a1=ma,i.a2=function(h){const s=h.value;let c=[];if(!s)return c;const p=vo(s);return p!=="string"?(c=c.concat([new aS(h.key,s,`string expected, "${p}" found`)]),c):(PF(s,!0)||(c=c.concat([new aS(h.key,s,`invalid url "${s}"`)])),c)},i.a3=xt,i.a4=Jd,i.a5=$i,i.a6=Xt,i.a7=class{constructor(h){this.specification=h}possiblyEvaluate(h,s){return Ua(h.expression.evaluate(s))}interpolate(h,s,c){return{x:Lr(h.x,s.x,c),y:Lr(h.y,s.y,c),z:Lr(h.z,s.z,c),azimuthal:Lr(h.azimuthal,s.azimuthal,c),polar:Lr(h.polar,s.polar,c)}}},i.a8=xi,i.a9=Kd,i.aA=Yo,i.aB=class{constructor(h){this.entries={},this.scheduler=h}request(h,s,c,p){const v=this.entries[h]=this.entries[h]||{callbacks:[]};if(v.result){const[m,x]=v.result;return this.scheduler?this.scheduler.add(()=>{p(m,x)},s):p(m,x),()=>{}}return v.callbacks.push(p),v.cancel||(v.cancel=c((m,x)=>{v.result=[m,x];for(const k of v.callbacks)this.scheduler?this.scheduler.add(()=>{k(m,x)},s):k(m,x);setTimeout(()=>delete this.entries[h],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(m=>m!==p),v.callbacks.length||(v.cancel(),delete this.entries[h]))}}},i.aC=So,i.aD=function(h,s,c){const p=JSON.stringify(h.request);return h.data&&(this.deduped.entries[p]={result:[null,h.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:h.isSymbolTile,zoom:h.tileZoom},v=>{const m=ts(h.request,(x,k,N,z)=>{x?v(x):k&&v(null,{vectorTile:c?void 0:new k0.VectorTile(new F2(k)),rawData:k,cacheControl:N,expires:z})});return()=>{m.cancel(),v()}},s)},i.aE=function(h){Ar++,Ar>St&&(h.getActor().send("enforceCacheSizeLimit",ot),Ar=0)},i.aF=function(h){return h<=1?1:Math.pow(2,Math.floor(Math.log(h)/Math.LN2))},i.aG=Ht,i.aH=fF,i.aI=xF,i.aJ=hF,i.aK=function(h,s){const c=document.createElement("video");c.muted=!0,c.onloadstart=function(){s(null,c)};for(let p=0;p<h.length;p++){const v=document.createElement("source");ao(h[p])||(c.crossOrigin="Anonymous"),v.src=h[p],c.appendChild(v)}return{cancel:()=>{}}},i.aL=eS,i.aM=function(h){return fetch(h).then(s=>s.arrayBuffer()).then(s=>b5(s,0,h))},i.aN=S5,i.aO=class{constructor(h,s,c,p){this.id=h,this.position=s!=null?new Kn(s[0],s[1]):new Kn(0,0),this.orientation=c??[0,0,0],this.nodes=p,this.uploaded=!1,this.aabb=new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(h,s){if(De.mat4.multiply(h.matrix,s,h.matrix),h.meshes)for(const c of h.meshes){const p=Sr.applyTransformFast(c.aabb,h.matrix);this.aabb.encapsulate(p)}if(h.children)for(const c of h.children)this._applyTransformations(c,h.matrix)}computeBoundsAndApplyParent(){const h=De.mat4.identity([]);for(const s of this.nodes)this._applyTransformations(s,h)}computeModelMatrix(h,s,c,p,v,m,x=!1){jF(this.matrix,this,h.transform,this.position,s,c,p,v,m,x)}upload(h){if(!this.uploaded){for(const s of this.nodes)tE(s,h);for(const s of this.nodes)sS(s);this.uploaded=!0}}destroy(){for(const h of this.nodes)rE(h)}},i.aP=yo,i.aQ=lb,i.aR=Xo,i.aS=Fr,i.aT=ua,i.aU=ms,i.aV=Va,i.aW=rg,i.aX=J2,i.aY=function(){Go.isLoading()||Go.isLoaded()||Xd()!=="deferred"||cf()},i.aZ=jy,i.a_=te,i.aa=d,i.ab=De,i.ac=tn,i.ad=Ju,i.ae=Po,i.af=Lr,i.ag=lr,i.ah=$c,i.ai=et,i.aj=Jn,i.ak=class{constructor(h){this.specification=h}possiblyEvaluate(h,s){return function([c,p]){const v=Ua([1,c,p]);return{x:v.x,y:v.y,z:v.z}}(h.expression.evaluate(s))}interpolate(h,s,c){return{x:Lr(h.x,s.x,c),y:Lr(h.y,s.y,c),z:Lr(h.z,s.z,c)}}},i.al=function(h,s,c=0,p=!0){const v=new Pt(c,c),m=h.sub(v),x=s.add(v),k=[m,new Pt(x.x,m.y),x,new Pt(m.x,x.y)];return p&&k.push(m.clone()),k},i.am=function(h,s){const c=[];for(let p=0;p<h.length;p++){const v=Xn(p-1,-1,h.length-1),m=Xn(p+1,-1,h.length-1),x=h[p],k=h[m],N=h[v].sub(x).unit(),z=k.sub(x).unit(),C=z.angleWithSep(N.x,N.y),R=N.add(z).unit().mult(-1*s/Math.sin(C/2));c.push(x.add(R))}return c},i.an=Jz,i.ao=Ke,i.ap=function(h,s,c=0){return De.vec3.fromValues(((s.x-c)*h.scale-h.x)*lr,(s.y*h.scale-h.y)*lr,ch(s.z,s.y))},i.aq=Hr,i.ar=yz,i.as=function(h){let s=1/0,c=1/0,p=-1/0,v=-1/0;for(const m of h)s=Math.min(s,m.x),c=Math.min(c,m.y),p=Math.max(p,m.x),v=Math.max(v,m.y);return{min:new Pt(s,c),max:new Pt(p,v)}},i.at=Cc,i.au=$e,i.av=S,i.aw=ar,i.ax=Ks,i.ay=function(h,s){const c={};for(let p=0;p<s.length;p++){const v=s[p];v in h&&(c[v]=h[v])}return c},i.az=lu,i.b=function(h){return Ui.API_FONTS_REGEX.test(h)},i.b$=nS,i.b0=qn,i.b1=kC,i.b2=un,i.b3=Y,i.b4=Ao,i.b5=pf,i.b6=Ir,i.b7=ya,i.b8=dg,i.b9=HC,i.bA=Z4,i.bB=VC,i.bC=Kz,i.bD=zC,i.bE=xE,i.bF=Xn,i.bG=Ta,i.bH=qi,i.bI=function(h,s,c){h[4*s+0]=c[0],h[4*s+1]=c[1],h[4*s+2]=c[2],h[4*s+3]=c[3]},i.bJ=_f,i.bK=Ho,i.bL=vf,i.bM=da,i.bN=Tc,i.bO=Kn,i.bP=nF,i.bQ=It,i.bR=wn,i.bS=bF,i.bT=Bt,i.bU=ks,i.bV=function(h,s,c,p,v,m,x,k,N){if(N.name==="globe")return ks(h,s,new Bt(c,p,v),!1);const z=lb({z:c,x:p,y:v},N);return new Sr([(m+z.x/z.scale)*s,s*(z.y/z.scale),x],[(m+z.x2/z.scale)*s,s*(z.y2/z.scale),k])},i.bW=function(h,s,c){let p=0;for(let v=0;v<2;++v)h[v]>0&&(p+=(h[v]-0)*(h[v]-0)),s[v]<0&&(p+=(0-s[v])*(0-s[v]));return p},i.bX=Zs,i.bY=Up,i.bZ=function(h){const s=De.mat4.identity(new Float64Array(16));De.mat4.multiply(s,h.pixelMatrix,h.globeMatrix);const c=[0,Ko,0],p=[0,co,0];return De.vec3.transformMat4(c,c,s),De.vec3.transformMat4(p,p,s),[c[0]>0&&c[0]<=h.width&&c[1]>0&&c[1]<=h.height&&!yl(h,new Kn(h.center.lat,90)),p[0]>0&&p[0]<=h.width&&p[1]>0&&p[1]<=h.height&&!yl(h,new Kn(h.center.lat,-90))]},i.b_=function(h,s){const{scale:c}=h.tileTransform,p=c*lr/(h.tileSize*Math.pow(2,s.zoom-h.tileID.overscaledZ+h.tileID.canonical.z));return De.mat2.scale(new Float32Array(4),s.inverseAdjustmentMatrix,[p,p])},i.ba=function(h,s){const c=Po(s.zoom);if(c===0)return Ma(h);const p=Oi(h),v=Pi(p),m=Cc(p.getWest())*s.worldSize,x=Cc(p.getEast())*s.worldSize,k=Yo(p.getNorth())*s.worldSize,N=Yo(p.getSouth())*s.worldSize,z=[m,k,0],C=[x,k,0],R=[m,N,0],L=[x,N,0],j=De.mat4.invert([],s.globeMatrix);return De.vec3.transformMat4(z,z,j),De.vec3.transformMat4(C,C,j),De.vec3.transformMat4(R,R,j),De.vec3.transformMat4(L,L,j),v[0]=ba(v[0],R,c),v[1]=ba(v[1],L,c),v[2]=ba(v[2],C,c),v[3]=ba(v[3],z,c),Sr.fromPoints(v)},i.bb=is,i.bc=_i,i.bd=ba,i.be=ra,i.bf=jr,i.bg=pE,i.bh=F2,i.bi=ts,i.bj=function(h){const s=[];for(const c in h)s.push(h[c]);return s},i.bk=function(h,s){const c=[];for(const p in h)p in s||c.push(p);return c},i.bl=Bi,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=nn,i.bo=function(h,s){const{x:c,y:p}=h.point,v=gs(c,p,h.worldSize/h._pixelsPerMercatorPixel,0,0);return De.mat4.multiply(v,v,Ci(Ma(s)))},i.bp=M0,i.bq=cu,i.br=z2,i.bs=function(h,s,c,p,v){const m=5*s+2;h.float32[m+0]=c,h.float32[m+1]=p,h.float32[m+2]=v},i.bt=X2,i.bu=Bz,i.bv=fe,i.bw=Eo,i.bx=$4,i.by=TF,i.bz=K4,i.c=us,i.c$=(h,s,c,p,v,m,x,k)=>{const N=h.transform,z=N.pitch<15?vz(.07,.7,ar((14-N.zoom)/5,0,1)):.07,C=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:_z(h,s,c,p),u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:N.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:v,u_width_scale:m,u_floor_width_scale:x,u_image:0,u_tile_units_to_pixels:xz(s,N),u_units_to_pixels:[1/N.pixelsToGLUnits[0],1/N.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:k,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(C?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:z,u_tile_to_meter:o(s.tileID.canonical,0)}},i.c0=_F,i.c1=function(h){const s=_F(h,!0);return De.mat2.invert([],[s[0],s[1],s[4],s[5]])},i.c2=Mn,i.c3=function(h){const{x:s,y:c}=h.point,{lng:p,lat:v}=h._center;return gs(s,c,h.worldSize,p,v)},i.c4=bt,i.c5=tr,i.c6=ad,i.c7=function(h){const s=Math.round((h+45+360)%360/90)%4;return zt[s]},i.c8=45,i.c9=og,i.cA=class extends Nl{constructor(h){super(h),this.current=ag}set(h,s,c){if(this.fetchUniformLocation(h,s)){for(let p=0;p<9;p++)if(c[p]!==this.current[p]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},i.cB=xr,i.cC=function(h,s,c){const p=Po(c.zoom),v=h.style.map._antialias,m=h.terrain&&h.terrain.exaggeration()>0;return p===0&&!v&&!m},i.cD=function(h){const s=h.pixelsPerMeter,c=s/qi(1,h.center.lat),p=De.mat4.identity(new Float64Array(16));return De.mat4.translate(p,p,[h.point.x,h.point.y,0]),De.mat4.scale(p,p,[c,c,s]),Float32Array.from(p)},i.cE=Oi,i.cF=function(h){const s=Zs-5;h=ar(h,-80.051129,s)/s*90;const c=Math.pow(Math.abs(Math.sin(et(h))),3);return Math.round(c*(wf.length-1))},i.cG=function(h,s,c,p){const v=s.getNorth(),m=s.getSouth(),x=s.getWest(),k=s.getEast(),N=1<<h.z,z=k-x,C=v-m,R=z/oh,L=-C/wf[c],j=[0,R,0,L,0,0,v,x,0];if(h.z>0){const I=180/p;De.mat3.multiply(j,j,[I/z+1,0,0,0,I/C+1,0,-.5*I/R,.5*I/L,1])}return j[2]=N,j[5]=h.x,j[8]=h.y,j},i.cH=Ma,i.cI=function(h,s,c){const p=De.mat4.identity(new Float64Array(16)),v=(s/(1<<h)-.5)*Math.PI*2;return De.mat4.rotateY(p,c.globeMatrix,v),Float32Array.from(p)},i.cJ=class{isDataAvailableAtPoint(h){const s=this._source();if(this.isUsingMockSource()||!s||h.y<0||h.y>1)return!1;const c=s.getSource().maxzoom,p=1<<c,v=Math.floor(h.x),m=Math.floor((h.x-v)*p),x=Math.floor(h.y*p),k=this.findDEMTileFor(new Ht(c,v,c,m,x));return!(!k||!k.dem)}getAtPointOrZero(h,s=0){return this.getAtPoint(h,s)||0}getAtPoint(h,s,c=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const p=this._source();if(!p||h.y<0||h.y>1)return s;const v=p.getSource().maxzoom,m=1<<v,x=Math.floor(h.x),k=h.x-x,N=new Ht(v,x,v,Math.floor(k*m),Math.floor(h.y*m)),z=this.findDEMTileFor(N);if(!z||!z.dem)return s;const C=z.dem,R=1<<z.tileID.canonical.z,L=(k*R-z.tileID.canonical.x)*C.dim,j=(h.y*R-z.tileID.canonical.y)*C.dim,I=Math.floor(L),$=Math.floor(j);return(c?this.exaggeration():1)*Lr(Lr(C.get(I,$),C.get(I,$+1),j-$),Lr(C.get(I+1,$),C.get(I+1,$+1),j-$),L-I)}getAtTileOffset(h,s,c){const p=1<<h.canonical.z;return this.getAtPointOrZero(new d(h.wrap+(h.canonical.x+s/lr)/p,(h.canonical.y+c/lr)/p))}getAtTileOffsetFunc(h,s,c,p){return v=>{const m=this.getAtTileOffset(h,v.x,v.y),x=p.upVector(h.canonical,v.x,v.y),k=p.upVectorScale(h.canonical,s,c).metersToTile;return De.vec3.scale(x,x,m*k),x}}getForTilePoints(h,s,c,p){if(this.isUsingMockSource())return!1;const v=D0.create(this,h,p);return!!v&&(s.forEach(m=>{m[2]=this.exaggeration()*v.getElevationAt(m[0],m[1],c)}),!0)}getMinMaxForTile(h){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(h);if(!s||!s.dem)return null;const c=s.dem.tree,p=s.tileID,v=1<<h.canonical.z-p.canonical.z;let m=h.canonical.x/v-p.canonical.x,x=h.canonical.y/v-p.canonical.y,k=0;for(let N=0;N<h.canonical.z-p.canonical.z&&!c.leaves[k];N++){m*=2,x*=2;const z=2*Math.floor(x)+Math.floor(m);k=c.childOffsets[k]+z,m%=1,x%=1}return{min:this.exaggeration()*c.minimums[k],max:this.exaggeration()*c.maximums[k]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(h,s,c){throw new Error("Pure virtual method called.")}pointCoordinate(h){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(h){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const h=this.visibleDemTiles;if(h.length===0)return null;let s=!1,c=Number.MAX_VALUE,p=Number.MIN_VALUE;for(const v of h){const m=this.getMinMaxForTile(v.tileID);m&&(c=Math.min(c,m.min),p=Math.max(p,m.max),s=!0)}return s?{min:c,max:p}:null}},i.cK=K_,i.cL=kn,i.cM=function(h,s){return[Math.pow(h[0],2.2)*s,Math.pow(h[1],2.2)*s,Math.pow(h[2],2.2)*s]},i.cN=gl,i.cO=Ns,i.cP=Pa,i.cQ=256,i.cR=function(h,s){const c=[0,0,0],p=is(Ma(s.canonical));return De.vec3.transformMat4(c,c,p),De.vec3.transformMat4(c,c,h),c},i.cS=h=>({u_camera_to_center_distance:new da(h),u_extrude_scale:new lo(h),u_device_pixel_ratio:new da(h),u_matrix:new _f(h),u_inv_rot_matrix:new _f(h),u_merc_center:new Ho(h),u_tile_id:new vf(h),u_zoom_transition:new da(h),u_up_dir:new vf(h),u_emissive_strength:new da(h)}),i.cT=h=>({u_matrix:new _f(h),u_pixels_to_tile_units:new lo(h),u_device_pixel_ratio:new da(h),u_width_scale:new da(h),u_floor_width_scale:new da(h),u_units_to_pixels:new Ho(h),u_dash_image:new Tc(h),u_gradient_image:new Tc(h),u_image_height:new da(h),u_texsize:new Ho(h),u_tile_units_to_pixels:new da(h),u_alpha_discard_threshold:new da(h),u_trim_offset:new Ho(h),u_trim_fade_range:new Ho(h),u_trim_color:new xf(h),u_emissive_strength:new da(h),u_zbias_factor:new da(h),u_tile_to_meter:new da(h)}),i.cU=h=>({u_matrix:new _f(h),u_texsize:new Ho(h),u_pixels_to_tile_units:new lo(h),u_device_pixel_ratio:new da(h),u_width_scale:new da(h),u_floor_width_scale:new da(h),u_image:new Tc(h),u_units_to_pixels:new Ho(h),u_tile_units_to_pixels:new da(h),u_alpha_discard_threshold:new da(h),u_trim_offset:new Ho(h),u_trim_fade_range:new Ho(h),u_trim_color:new xf(h),u_emissive_strength:new da(h),u_zbias_factor:new da(h),u_tile_to_meter:new da(h)}),i.cV=Ip,i.cW=vie,i.cX=xie,i.cY=Af,i.cZ=(h,s,c,p,v,m)=>{const x=h.transform,k=x.projection.name==="globe";let N;if(m.paint.get("circle-pitch-alignment")==="map")if(k){const C=gl(x.zoom,s.canonical)*x._pixelsPerMercatorPixel;N=Float32Array.from([C,0,0,C])}else N=x.calculatePixelsToTileUnitsMatrix(c);else N=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:h.transform.getCameraToCenterDistance(x.projection),u_matrix:h.translatePosMatrix(s.projMatrix,c,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:He.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:dh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(k){z.u_inv_rot_matrix=p,z.u_merc_center=v,z.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],z.u_zoom_transition=Po(x.zoom);const C=v[0]*lr,R=v[1]*lr;z.u_up_dir=x.projection.upVector(new Bt(0,0,0),C,R)}return z},i.c_=bz,i.ca=xf,i.cb=function(h,s,c){const p=Math.sqrt(h*h+s*s+c*c),v=p>0?Math.acos(c/p)*Br:0;let m=h!==0||s!==0?Math.atan2(-s,-h)*Br+90:0;return m<0&&(m+=360),[p,m,v]},i.cc=o,i.cd=Sr,i.ce=Ua,i.cf=function(h){return[Math.pow(h[0],1/2.2),Math.pow(h[1],1/2.2),Math.pow(h[2],1/2.2)]},i.cg=function(h,s){return h.readFields(dae,{icons:[]},s)},i.ch=function(h){return h({pluginStatus:wo,pluginURL:pl}),bc.on("pluginStateChange",h),h},i.ci=lS,i.cj=O0,i.ck=FC,i.cl=ds,i.cm=Mp,i.cn=at,i.co=ol,i.cp=Os,i.cq=function(h){const s=h.indexOf(uf);return s>=0?h.slice(0,s):h},i.cr=function(h){return h.indexOf(uf)>=0},i.cs=function(h){const s=h.indexOf(uf);return s>=0?h.slice(s+1):""},i.ct=function(h){const s=[],c=h.id;return c===void 0&&s.push({message:`layers.${c}: missing required property "id"`}),h.render===void 0&&s.push({message:`layers.${c}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&s.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),s},i.cu=function(h,s,c,p){return h.type==="custom"?new Xie(h,s):new lae[h.type](h,s,c,p)},i.cv=_l,i.cw=class extends $0{constructor(h,s){super(h._vectorTileFeature,h._z,h._x,h._y,h.id),h.state&&(this.state=Object.assign({},h.state)),this.target=s.target,this.namespace=s.namespace,s.properties&&(this.properties=s.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=h.source,this.sourceLayer=h.sourceLayer,this.layer=h.layer)}toJSON(){const h=super.toJSON();return h.target=this.target,h.namespace=this.namespace,h}},i.cx=bc,i.cy=$a,i.cz=By,i.d=function(h){return Ui.API_TILEJSON_REGEX.test(h)},i.d$=T5,i.d0=(h,s,c,p,v,m,x,k,N)=>{const z=h.transform,C=z.calculatePixelsToTileUnitsMatrix(s),R=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none",L=z.pitch<15?vz(.07,.7,ar((14-z.zoom)/5,0,1)):.07;return{u_matrix:_z(h,s,c,p),u_pixels_to_tile_units:C,u_device_pixel_ratio:m,u_width_scale:x,u_floor_width_scale:k,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:wz(c)&&s.lineAtlasTexture?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:xz(s,h.transform),u_alpha_discard_threshold:0,u_trim_offset:N,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(R?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:o(s.tileID.canonical,0)}},i.d1=Vs,i.d2=ug,i.d3=lz,i.d4=gr,i.d5=L2,i.d6=pg,i.d7=450,i.d8=7,i.d9=Yie,i.dA=pr,i.dB=g,i.dC=lh,i.dD=function([h,s,c]){const p=Math.hypot(h,s,c),v=Math.atan2(h,c),m=.5*Math.PI-Math.acos(-s/p);return new Kn(bt(v),bt(m))},i.dE=JC,i.dF=function(h){const s=h.navigator?h.navigator.userAgent:null;return!!function(c){if(ha==null){const p=c.navigator?c.navigator.userAgent:null;ha=!!c.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return ha}(h)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(h,s){ot=h,St=s},i.dH=yl,i.dI=Co,i.dJ=function(h){const s=[0,0,0],c=De.mat4.identity(new Float64Array(16));return De.mat4.multiply(c,h.pixelMatrix,h.globeMatrix),De.vec3.transformMat4(s,s,c),new Pt(s[0],s[1])},i.dK=function(h,s,c=!1){if(wo===Yd||wo===lf||wo===Wm)throw new Error("setRTLTextPlugin cannot be called multiple times.");pl=He.resolveURL(h),wo=Yd,fl=s,My(),c||cf()},i.dL=Xd,i.dM=function(){lS().acquire(iE)},i.dN=function(){const h=gb;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(iE),gb=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=Yy,i.dP=function(h){const s=rr();if(!s)return;const c=s.delete(gt);h&&c.catch(h).then(()=>h())},i.dQ=mb,i.dR=p5,i.dS=function(h){mE=He.resolveURL(h),U0||(U0=new L0(lS(),new Uc)),U0.broadcast("setDracoUrl",mE)},i.dT=m5,i.dU=function(h){V0=He.resolveURL(h),U0||(U0=new L0(lS(),new Uc)),U0.broadcast("setMeshoptUrl",V0)},i.dV=mr,i.dW=od,i.dX=ph,i.dY=k0,i.dZ=class{constructor(h,s){this.pos=h,this.dir=s}intersectsPlane(h,s,c){const p=De.vec2.dot(s,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((h[0]-this.pos[0])*s[0]+(h[1]-this.pos[1])*s[1])/p;return c[0]=this.pos[0]+this.dir[0]*v,c[1]=this.pos[1]+this.dir[1]*v,!0}},i.d_=A5,i.da=Qn,i.db=tg,i.dc=256,i.dd=Ci,i.de=Wo,i.df=iu,i.dg=Dp,i.dh=function(h,s,c,p,v){return ar((h-s)/(c-s)*(v-p)+p,p,v)},i.di=Cl,i.dj=Sf,i.dk=class{constructor(h,s,c,p){this.context=h,this.format=p,this.size=c,this.texture=h.gl.createTexture();const[v,m,x]=this.size,{gl:k}=h;k.bindTexture(k.TEXTURE_3D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(!1),k.texImage3D(k.TEXTURE_3D,0,this.format,v,m,x,0,KC(this.format),ZC(this.format),s.data)}bind(h,s){const{context:c}=this,{gl:p}=c;p.bindTexture(p.TEXTURE_3D,this.texture),h!==this.minFilter&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MAG_FILTER,h),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MIN_FILTER,h),this.minFilter=h),s!==this.wrapS&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_T,s),this.wrapS=s)}destroy(){const{gl:h}=this.context;h.deleteTexture(this.texture),this.texture=null}},i.dl=QC,i.dm=[1,1,1],i.dn=D0,i.dp=I0,i.dq=Cs,i.dr=ih,i.ds=sd,i.dt=td,i.du=Xl,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Pt(1/0,1/0),max:new Pt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(h,s=!1){const c=G4(new Pt(0,0),new Pt(lr,lr),h),p=[];if(s&&!AC(c,this._globalClipBounds))return p;for(const v of this._activeRegions){if(v.hiddenByOverlap||!AC(c,v))continue;const m=Gne(v.min,v.max,h);p.push({min:m.min,max:m.max,sourceId:this._sourceIds[v.priority],footprint:v.footprint,footprintTileId:v.tileId,order:v.order,clipMask:v.clipMask,clipScope:v.clipScope})}return p}setSources(h){this._setSources(h.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const c=[];for(const p of s.cache.getVisibleCoordinates()){const v=s.cache.getTile(p).buckets[s.layer];v&&v.updateFootprints(p.toUnwrapped(),c)}return c},getOrder:()=>s.order,getClipMask:()=>s.clipMask,getClipScope:()=>s.clipScope})))}_addSource(h){const s=h.getFootprints();if(s.length===0)return;const c=h.getOrder(),p=h.getClipMask(),v=h.getClipScope();for(const m of s){if(!m.footprint)continue;const x=G4(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:x.min,max:x.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:c,clipMask:p,clipScope:v})}this._sourceIds.push(h.getSourceId())}_computeReplacement(){this._activeRegions.sort((s,c)=>s.priority-c.priority||I2(s.min,c.min)||I2(s.max,c.max)||s.order-c.order||s.clipMask-c.clipMask||function(p,v){const m=(x,k)=>x+k;return p.length-v.length||p.reduce(m,"").localeCompare(v.reduce(m,""))}(s.clipScope,c.clipScope));let h=this._activeRegions.length!==this._prevRegions.length;if(!h){let s=0;for(;!h&&s!==this._activeRegions.length;){const c=this._activeRegions[s],p=this._prevRegions[s];h=c.priority!==p.priority||!q4(c,p)||c.order!==p.order||c.clipMask!==p.clipMask||!nn(c.clipScope,p.clipScope),++s}}if(h){++this._updateTime;for(const c of this._activeRegions)c.order!==R2&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,c.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,c.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,c.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,c.max.y));const s=c=>{const p=this._activeRegions;if(c>=p.length)return c;const v=p[c].priority;for(;c<p.length&&p[c].priority===v;)++c;return c};if(this._sourceIds.length>1){let c=0,p=s(c);for(;c!==p;){let v=c;const m=c;for(;v!==p;){const x=this._activeRegions[v];x.hiddenByOverlap=!1;for(let k=0;k<m;k++){const N=this._activeRegions[k];if(!N.hiddenByOverlap&&x.order===R2&&AC(x,N)&&(x.hiddenByOverlap=H4(x.footprint,x.tileId,N.footprint,N.tileId),x.hiddenByOverlap))break}++v}c=p,p=s(c)}}}}_setSources(h){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=h.length-1;s>=0;s--)this._addSource(h[s]);this._computeReplacement()}},i.dw=class{constructor(h){this._createGrid(h),this._createPoles(h)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const h of this._poleSegments)h.destroy();for(const h of this._gridSegments)h.withSkirts.destroy(),h.withoutSkirts.destroy()}_fillGridMeshWithLods(h,s){const c=new Ao,p=new ms,v=[],m=h+1+2,x=s[0]+1,k=s[0]+1+(1+s.length),N=(z,C,R)=>{let L=z===m-1?z-2:z===0?z:z-1;return L+=R?24575:0,[L,C]};for(let z=0;z<m;++z)c.emplaceBack(...N(z,0,!0));for(let z=0;z<x;++z)for(let C=0;C<m;++C)c.emplaceBack(...N(C,z,(C===0||C===m-1)&&!0));for(let z=0;z<s.length;++z){const C=s[z];for(let R=0;R<m;++R)c.emplaceBack(...N(R,C,!0))}for(let z=0;z<s.length;++z){const C=p.length,R=s[z]+1+2,L=new ms;for(let $=0;$<R-1;$++){const X=$===R-2,Q=X?m*(k-s.length+z-$):m;for(let le=0;le<m-1;le++){const ue=$*m+le;$===0||X||le===0||le===m-2?(L.emplaceBack(ue+1,ue,ue+Q),L.emplaceBack(ue+Q,ue+Q+1,ue+1)):(p.emplaceBack(ue+1,ue,ue+Q),p.emplaceBack(ue+Q,ue+Q+1,ue+1))}}const j=ya.simpleSegment(0,C,c.length,p.length-C);for(let $=0;$<L.uint16.length;$+=3)p.emplaceBack(L.uint16[$],L.uint16[$+1],L.uint16[$+2]);const I=ya.simpleSegment(0,C,c.length,p.length-C);v.push({withoutSkirts:j,withSkirts:I})}return{vertices:c,indices:p,segments:v}}_createGrid(h){const s=this._fillGridMeshWithLods(oh,wf);this._gridSegments=s.segments,this._gridBuffer=h.createVertexBuffer(s.vertices,Ir.members),this._gridIndexBuffer=h.createIndexBuffer(s.indices,!0)}_createPoles(h){const s=new ms;for(let x=0;x<=oh;x++)s.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=h.createIndexBuffer(s,!0);const c=new iu,p=new iu,v=new iu,m=new iu;this._poleSegments=[];for(let x=0,k=0;x<ad;x++){const N=360/(1<<x);c.emplaceBack(0,-Ks,0,.5,0),p.emplaceBack(0,-Ks,0,.5,1),v.emplaceBack(0,-Ks,0,.5,.5),m.emplaceBack(0,-Ks,0,.5,.5);for(let z=0;z<=oh;z++){let C=z/oh,R=0;const L=Lr(0,N,C),[j,I,$]=Zo(uh,Ql,L,Ks);c.emplaceBack(j,I,$,C,R),p.emplaceBack(j,I,$,C,1-R);const X=et(L);C=.5+.5*Math.sin(X),R=.5+.5*Math.cos(X),v.emplaceBack(j,I,$,C,R),m.emplaceBack(j,I,$,C,1-R)}this._poleSegments.push(ya.simpleSegment(k,0,66,64)),k+=66}this._poleNorthVertexBuffer=h.createVertexBuffer(c,qr,!1),this._poleSouthVertexBuffer=h.createVertexBuffer(p,qr,!1),this._texturedPoleNorthVertexBuffer=h.createVertexBuffer(v,qr,!1),this._texturedPoleSouthVertexBuffer=h.createVertexBuffer(m,qr,!1)}getGridBuffers(h,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[h].withSkirts:this._gridSegments[h].withoutSkirts]}getPoleBuffers(h,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[h]]}},i.dx=R2,i.dy=fr,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=Ui,i.e0=pz,i.e1=ql,i.e2=ll,i.e3=Uz,i.e4=function(h,s,c,p,v,m,x,k,N,z,C=1,R,L){h.createArrays(),h.tilePixelRatio=lr/(512*h.overscaling),h.compareText={},h.iconsNeedLinear=!1;const j=h.layers[0].layout,I=h.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=C,$.textSizeScaleRange=j.get("text-size-scale-range"),$.iconSizeScaleRange=j.get("icon-size-scale-range");const[X,Q]=$.textSizeScaleRange,[le,ue]=$.iconSizeScaleRange;if($.textScaleFactor=ar($.scaleFactor,X,Q),$.iconScaleFactor=ar($.scaleFactor,le,ue),h.textSizeData.kind==="composite"){const{minZoom:we,maxZoom:Ie}=h.textSizeData;$.compositeTextSizes=[I["text-size"].possiblyEvaluate(new xi(we),k),I["text-size"].possiblyEvaluate(new xi(Ie),k)]}if(h.iconSizeData.kind==="composite"){const{minZoom:we,maxZoom:Ie}=h.iconSizeData;$.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new xi(we),k),I["icon-size"].possiblyEvaluate(new xi(Ie),k)]}$.layoutTextSize=I["text-size"].possiblyEvaluate(new xi(N+1),k),$.layoutIconSize=I["icon-size"].possiblyEvaluate(new xi(N+1),k),$.textMaxSize=I["text-size"].possiblyEvaluate(new xi(18),k);const ie=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",he=j.get("text-size");let me=!1;for(const we of h.features)if(we.icon&&we.icon.nameSecondary){me=!0;break}for(const we of h.features){const Ie=j.get("text-font").evaluate(we,{},k).join(","),Ne=he.evaluate(we,{},k)*$.textScaleFactor,Me=$.layoutTextSize.evaluate(we,{},k)*$.textScaleFactor,Je=($.layoutIconSize.evaluate(we,{},k),{horizontal:{},vertical:void 0}),Fe=we.text;let tt,st=[0,0];if(Fe){const ft=Fe.toString(),vt=j.get("text-letter-spacing").evaluate(we,{},k)*Eo,ct=j.get("text-line-height").evaluate(we,{},k)*Eo,Rt=Ey(ft)?vt:0,$t=j.get("text-anchor").evaluate(we,{},k),Nt=j.get("text-variable-anchor");if(!Nt){const Er=j.get("text-radial-offset").evaluate(we,{},k);st=Er?Kz($t,[Er*Eo,BC]):j.get("text-offset").evaluate(we,{},k).map(yr=>yr*Eo)}let hr=ie?"center":j.get("text-justify").evaluate(we,{},k);const or=j.get("symbol-placement")==="point",Jt=or?j.get("text-max-width").evaluate(we,{},k)*Eo:1/0,qt=Er=>{h.allowVerticalPlacement&&kp(ft)&&(Je.vertical=LC(Fe,s,c,v,Ie,Jt,ct,$t,Er,Rt,st,cu.vertical,!0,Me,Ne))};if(!ie&&Nt){const Er=hr==="auto"?Nt.map(br=>VC(br)):[hr];let yr=!1;for(let br=0;br<Er.length;br++){const Qr=Er[br];if(!Je.horizontal[Qr])if(yr)Je.horizontal[Qr]=Je.horizontal[0];else{const pn=LC(Fe,s,c,v,Ie,Jt,ct,"center",Qr,Rt,st,cu.horizontal,!1,Me,Ne);pn&&(Je.horizontal[Qr]=pn,yr=pn.positionedLines.length===1)}}qt("left")}else{if(hr==="auto"&&(hr=VC($t)),or||j.get("text-writing-mode").indexOf("horizontal")>=0||!kp(ft)){const Er=LC(Fe,s,c,v,Ie,Jt,ct,$t,hr,Rt,st,cu.horizontal,!1,Me,Ne);Er&&(Je.horizontal[hr]=Er)}qt(or?"left":hr)}}let nt=!1;if(we.icon&&we.icon.namePrimary){const ft=OC(h.iconSizeData,I["icon-size"],k,h.zoom,we)*$.iconScaleFactor*R,vt=we.icon.getPrimary().scaleSelf(ft).serialize(),ct=p[vt];ct&&(tt=Mie(v[vt],we.icon.nameSecondary?v[we.icon.getSecondary().scaleSelf(ft).serialize()]:void 0,j.get("icon-offset").evaluate(we,{},k),j.get("icon-anchor").evaluate(we,{},k)),nt=ct.sdf,h.sdfIcons===void 0?h.sdfIcons=ct.sdf:h.sdfIcons!==ct.sdf&&an("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ct.pixelRatio!==h.pixelRatio||j.get("icon-rotate").constantOr(1)!==0)&&(h.iconsNeedLinear=!0))}const lt=Yz(Je.horizontal)||Je.vertical;h.iconsInText||(h.iconsInText=!!lt&&lt.iconsInText),(lt||tt)&&Lie(h,we,Je,tt,p,$,Me,0,st,nt,x,k,z,L,me)}m&&h.generateCollisionDebugBuffers(N,h.collisionBoxArray,$.textScaleFactor)},i.e5=pS,i.e6=Rr,i.e7=F4,i.e8=Ez,i.e9=_,i.ea=function(h){let s=0;if(new Uint32Array(h,0,1)[0]!==y5){const c=new Uint32Array(h,0,7),[,,p,v,m,x]=c;s=c.byteLength+v+m+x+m,(p!==h.byteLength||s>=h.byteLength)&&an("Invalid b3dm header information.")}return b5(h,s)},i.eb=function(h,s){const c=S5(h);for(const p of c){for(const v of p.meshes)hse(v);p.lights&&(p.lightMeshIndex=p.meshes.length,p.meshes.push(fse(p.lights,s)))}return c},i.ec=oS,i.ed=LF,i.ee=Go,i.ef=function(h){sr(),Tt!=null&&Tt.then(s=>{s.keys().then(c=>{for(let p=0;p<c.length-h;p++)s.delete(c[p])})})},i.f=function(h){return h.indexOf("mapbox:")===0},i.g=function(h,s){return $a(Vi(h,{method:"GET"}),s)},i.h=Ss,i.i=function(h){return Ui.API_STYLE_REGEX.test(h)&&!us(h)},i.j=function(h){return decodeURIComponent(atob(h).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(h){return btoa(encodeURIComponent(h).replace(/%([0-9A-F]{2})/g,(s,c)=>String.fromCharCode(+("0x"+c))))},i.l=Vi,i.m=$r,i.n=function(h,s){return $a(Vi(h,{type:"json"}),s)},i.o=Wh,i.p=function(h,s){return $a(Vi(h,{method:"POST"}),s)},i.q=He,i.r=Ls,i.s=function(h){try{const s=self[h];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Pe,i.u=function(){return function h(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,h)}()},i.v=function(h){return!!h&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(h)},i.w=an,i.x=function(){return aE||(aE=new Yy),aE},i.y=cp,i.z=vi}),l(["./shared"],function(i){function _(At){const ye=At?At.url.toString():void 0;return ye?performance.getEntriesByName(ye):[]}function w(At){if(typeof At=="number"||typeof At=="boolean"||typeof At=="string"||At==null)return JSON.stringify(At);if(Array.isArray(At)){let Se="[";for(const Pe of At)Se+=`${w(Pe)},`;return`${Se}]`}let ye="{";for(const Se of Object.keys(At).sort())ye+=`${Se}:${w(At[Se])},`;return`${ye}}`}function A(At){let ye="";for(const Se of i.bm)(At.type!=="model"||Se!=="minzoom"&&Se!=="maxzoom")&&(ye+=`/${w(At[Se])}`);return ye}class E{constructor(ye){this.keyCache={},this._layers={},this._layerConfigs={},ye&&this.replace(ye)}replace(ye,Se){this._layerConfigs={},this._layers={},this.update(ye,[],Se)}update(ye,Se,Pe){this._options=Pe;for(const Ye of ye)this._layerConfigs[Ye.id]=Ye,(this._layers[Ye.id]=i.cu(Ye,this.scope,null,this._options)).compileFilter(Pe),this.keyCache[Ye.id]&&delete this.keyCache[Ye.id];for(const Ye of Se)delete this.keyCache[Ye],delete this._layerConfigs[Ye],delete this._layers[Ye];this.familiesBySource={};const He=function(Ye,at){const gt={};for(let St=0;St<Ye.length;St++){const wt=Ye[St];let Tt=at&&at[wt.id];!Tt&&(Tt=A(wt),wt.type==="line"&&wt.paint)&&function rr(sr){return typeof sr=="string"&&sr==="line-progress"||(Array.isArray(sr)?sr.some(rr):!(!sr||typeof sr!="object")&&Object.values(sr).some(rr))}(wt.paint["line-width"])&&(Tt+=`/${w(wt.paint["line-width"])}`),at&&(at[wt.id]=Tt);let Ft=gt[Tt];Ft||(Ft=gt[Tt]=[]),Ft.push(wt)}const ot=[];for(const St in gt)ot.push(gt[St]);return ot}(i.bj(this._layerConfigs),this.keyCache);for(const Ye of He){const at=Ye.map(Ft=>this._layers[Ft.id]),gt=at[0];if(gt.visibility==="none")continue;const ot=gt.source||"";let St=this.familiesBySource[ot];St||(St=this.familiesBySource[ot]={});const wt=gt.sourceLayer||"_geojsonTileLayer";let Tt=St[wt];Tt||(Tt=St[wt]=[]),Tt.push(at)}}}const O=1*i.dX;class F{constructor(ye){const Se={},Pe=[];for(const gt in ye){const ot=ye[gt],St=Se[gt]={};for(const wt in ot.glyphs){const Tt=ot.glyphs[+wt];if(!Tt||Tt.bitmap.width===0||Tt.bitmap.height===0)continue;const Ft=Tt.metrics.localGlyph?O:1,rr={x:0,y:0,w:Tt.bitmap.width+2*Ft,h:Tt.bitmap.height+2*Ft};Pe.push(rr),St[wt]=rr}}const{w:He,h:Ye}=i.F(Pe),at=new i.dW({width:He||1,height:Ye||1});for(const gt in ye){const ot=ye[gt];for(const St in ot.glyphs){const wt=ot.glyphs[+St];if(!wt||wt.bitmap.width===0||wt.bitmap.height===0)continue;const Tt=Se[gt][St],Ft=wt.metrics.localGlyph?O:1;i.dW.copy(wt.bitmap,at,{x:0,y:0},{x:Tt.x+Ft,y:Tt.y+Ft},wt.bitmap)}}this.image=at,this.positions=Se}}i.dV(F,"GlyphAtlas");const U="3d_elevation_id",B="hd_road_elevation";class q{constructor(){this._valid=!1}reset(ye){return this.feature=ye,this._valid=!0,this._geometry=ye.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(ye,Se){return this._valid&&ye(Se(this._geometry)),this}require(ye,Se,Pe){return this.get(ye,!0,Se,Pe)}optional(ye,Se,Pe){return this.get(ye,!1,Se,Pe)}success(){return this._valid}get(ye,Se,Pe,He){const Ye=this.feature.properties.hasOwnProperty(ye)?+this.feature.properties[ye]:void 0;return this._valid&&Ye!==void 0?Pe(He?He(Ye):Ye):Se&&(this._valid=!1),this}}class W{constructor(ye,Se){this.featureFunc=ye,this.vertexFunc=Se}parseFeature(ye,Se,Pe){return this.featureFunc(ye,Se,Pe)}parseVertex(ye,Se,Pe){return this.vertexFunc(ye,Se,Pe)}}const Z=new W((At,ye,Se)=>At.reset(ye).require(U,Pe=>{Se.id=Pe}).optional("fixed_height_relative",Pe=>{Se.constantHeight=Pe},ae.decodeRelativeHeight).geometry(Pe=>{Se.bounds=Pe},ae.computeBounds).success(),(At,ye,Se)=>At.reset(ye).require(U,Pe=>{Se.id=Pe}).require("elevation_idx",Pe=>{Se.idx=Pe}).require("extent",Pe=>{Se.extent=Pe}).require("height_relative",Pe=>{Se.height=Pe},ae.decodeRelativeHeight).geometry(Pe=>{Se.position=Pe},ae.getPoint).success()),ne=new W((At,ye,Se)=>At.reset(ye).require(U,Pe=>{Se.id=Pe}).optional("fixed_height",Pe=>{Se.constantHeight=Pe},ae.decodeMetricHeight).geometry(Pe=>{Se.bounds=Pe},ae.computeBounds).success(),(At,ye,Se)=>At.reset(ye).require(U,Pe=>{Se.id=Pe}).require("elevation_idx",Pe=>{Se.idx=Pe}).require("extent",Pe=>{Se.extent=Pe}).require("height",Pe=>{Se.height=Pe},ae.decodeMetricHeight).geometry(Pe=>{Se.position=Pe},ae.getPoint).success());class ae{static computeBounds(ye){const Se=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Pe=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const He of ye[0])Se.x>He.x&&(Se.x=He.x),Se.y>He.y&&(Se.y=He.y),Pe.x<He.x&&(Pe.x=He.x),Pe.y<He.y&&(Pe.y=He.y);return{min:Se,max:Pe}}static getPoint(ye){return i.ab.vec2.fromValues(ye[0][0].x,ye[0][0].y)}static decodeRelativeHeight(ye){return 1e-4*ye*5}static decodeMetricHeight(ye){return 1e-4*ye}static parse(ye){const Se=[],Pe=[],He=ye.length,Ye=new q;for(let gt=0;gt<He;gt++){const ot=ye.feature(gt),St=ot.properties.hasOwnProperty("version")?String(ot.properties.version):void 0,wt=(at=St)?at==="1.0.1"?ne:void 0:Z;if(wt===void 0){i.w(`Unknown elevation feature version number ${St||"(unknown)"}`);continue}const Tt=ot.properties.hasOwnProperty("type")?ot.properties.type:void 0;if(Tt){if(i.dY.VectorTileFeature.types[ot.type]==="Point"&&Tt==="curve_point"){const Ft={};wt.parseVertex(Ye,ot,Ft)&&Se.push(Ft)}else if(i.dY.VectorTileFeature.types[ot.type]==="Polygon"&&Tt==="curve_meta"){const Ft={};wt.parseFeature(Ye,ot,Ft)&&Pe.push(Ft)}}}var at;return{vertices:Se,features:Pe}}}class ee{constructor(ye,Se,Pe,He,Ye,at){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=ye,this.heightRange={min:Pe,max:Pe},this.safeArea=Se,this.constantHeight=Pe,this.constantHeight==null&&(this.constantHeight!=null||He.length!==0)){this.vertices=He,this.edges=Ye,this.edges=this.edges.filter(gt=>gt.a<this.vertices.length&&gt.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[gt.a].position,this.vertices[gt.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const gt of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,gt.height),this.heightRange.max=Math.max(this.heightRange.max,gt.height);for(const gt of this.edges){const ot=this.vertices[gt.a].position,St=this.vertices[gt.b].position,wt=i.ab.vec2.subtract(i.ab.vec2.create(),St,ot),Tt=i.ab.vec2.length(wt),Ft=i.ab.vec2.scale(i.ab.vec2.create(),wt,1/Tt);this.edgeProps.push({vec:wt,dir:Ft,len:Tt});const rr=this.vertexProps[gt.a].dir,sr=this.vertexProps[gt.b].dir;i.ab.vec2.add(rr,rr,Ft),i.ab.vec2.add(sr,sr,Ft)}for(const gt of this.vertexProps)gt.dir[0]===0&&gt.dir[1]===0||i.ab.vec2.normalize(gt.dir,gt.dir);this.tessellate(at)}}pointElevation(ye){if(this.constantHeight!=null)return this.constantHeight;const Se=this.getClosestEdge(ye);if(Se==null)return 0;const[Pe,He]=Se;return(1-(Ye=He))*this.vertices[this.edges[Pe].a].height+Ye*this.vertices[this.edges[Pe].b].height;var Ye}getClosestEdge(ye){if(this.edges.length===0)return;let Se=0,Pe=Number.POSITIVE_INFINITY,He=0;const Ye=i.ab.vec2.fromValues(ye.x,ye.y);for(let at=0;at<this.edges.length;at++){const gt=this.edges[at],ot=this.edgeProps[at].dir,St=new i.dZ(Ye,this.edgeProps[at].dir),wt=this.vertices[gt.a].position,Tt=this.vertices[gt.b].position,Ft=i.ab.vec2.create(),rr=i.ab.vec2.create(),sr=St.intersectsPlane(wt,this.vertexProps[gt.a].dir,Ft),Ar=St.intersectsPlane(Tt,this.vertexProps[gt.b].dir,rr);if(!sr||!Ar)continue;const $r=i.ab.vec2.subtract(i.ab.vec2.create(),rr,Ft),Ur=i.ab.vec2.subtract(i.ab.vec2.create(),Ye,Ft),Vr=i.ab.vec2.dot($r,$r),Cn=Vr>0?i.ab.vec2.dot(Ur,$r)/Vr:0,Hn=i.aw(Cn,0,1),bn=Math.abs((Cn-Hn)*this.edgeProps[at].len),Un=i.ab.vec2.subtract(i.ab.vec2.create(),Ye,wt),En=bn+Math.abs(i.ab.vec2.dot(Un,i.ab.vec2.fromValues(ot[1],-ot[0])));En<Pe&&(Se=at,Pe=En,He=Hn)}return[Se,He]}tessellate(ye){for(let Se=this.edges.length-1;Se>=0;--Se){const Pe=this.edges[Se].a,He=this.edges[Se].b,{position:Ye,height:at,extent:gt}=this.vertices[Pe],{position:ot,height:St,extent:wt}=this.vertices[He],Tt=this.vertexProps[Pe].dir,Ft=this.vertexProps[He].dir,rr=i.ab.vec3.fromValues(Ye[0]/ye,Ye[1]/ye,at),sr=i.ab.vec3.fromValues(ot[0]/ye,ot[1]/ye,St),Ar=i.ab.vec3.fromValues(Tt[1],-Tt[0],0);i.ab.vec3.scale(Ar,Ar,gt);const $r=i.ab.vec3.fromValues(Ft[1],-Ft[0],0);if(i.ab.vec3.scale($r,$r,wt),this.distSqLines(i.ab.vec3.fromValues(rr[0]+.5*Ar[0],rr[1]+.5*Ar[1],rr[2]+.5*Ar[2]),i.ab.vec3.fromValues(sr[0]-.5*$r[0],sr[1]-.5*$r[1],sr[2]-.5*$r[2]),i.ab.vec3.fromValues(rr[0]-.5*Ar[0],rr[1]-.5*Ar[1],rr[2]-.5*Ar[2]),i.ab.vec3.fromValues(sr[0]+.5*$r[0],sr[1]+.5*$r[1],sr[2]+.5*$r[2]))<=.05*.05)continue;const Ur=this.vertices.length,Vr=i.ab.vec2.add(i.ab.vec2.create(),Ye,ot);this.vertices.push({position:i.ab.vec2.scale(Vr,Vr,.5),height:.5*(at+St),extent:.5*(gt+wt)});const Cn=i.ab.vec2.add(i.ab.vec2.create(),Tt,Ft);this.vertexProps.push({dir:i.ab.vec2.normalize(Cn,Cn)}),this.edges.splice(Se,1),this.edgeProps.splice(Se,1),this.edges.push({a:Pe,b:Ur}),this.edges.push({a:Ur,b:He});const Hn=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[Ur].position,Ye),bn=i.ab.vec2.length(Hn),Un={vec:Hn,dir:i.ab.vec2.scale(i.ab.vec2.create(),Hn,1/bn),len:bn};this.edgeProps.push(Un),this.edgeProps.push(Un)}}distSqLines(ye,Se,Pe,He){const Ye=i.ab.vec3.subtract(i.ab.vec3.create(),Se,ye),at=i.ab.vec3.subtract(i.ab.vec3.create(),He,Pe),gt=i.ab.vec3.subtract(i.ab.vec3.create(),ye,Pe),ot=i.ab.vec3.dot(Ye,Ye),St=i.ab.vec3.dot(Ye,at),wt=i.ab.vec3.dot(Ye,gt),Tt=i.ab.vec3.dot(at,at),Ft=i.ab.vec3.dot(at,gt),rr=ot*Tt-St*St;if(rr===0){const Vr=i.ab.vec3.dot(gt,at)/i.ab.vec3.dot(at,at),Cn=i.ab.vec3.lerp(i.ab.vec3.create(),Pe,He,Vr);return i.ab.vec3.squaredDistance(Cn,ye)}const sr=(St*Ft-wt*Tt)/rr,Ar=(ot*Ft-St*wt)/rr,$r=i.ab.vec3.lerp(i.ab.vec3.create(),ye,Se,sr),Ur=i.ab.vec3.lerp(i.ab.vec3.create(),Pe,He,Ar);return i.ab.vec3.squaredDistance($r,Ur)}}class se{static parseFrom(ye,Se){const Pe=ae.parse(ye);if(!Pe)return[];let{vertices:He,features:Ye}=Pe;const at=1/i.cc(Se);Ye.sort((wt,Tt)=>wt.id-Tt.id),He.sort((wt,Tt)=>wt.id-Tt.id||wt.idx-Tt.idx),He=He.filter((wt,Tt,Ft)=>Tt===Ft.findIndex(rr=>rr.id===wt.id&&rr.idx===wt.idx));const gt=new Array;let ot=0;const St=He.length;for(const wt of Ye){if(wt.constantHeight){gt.push(new ee(wt.id,wt.bounds,wt.constantHeight));continue}for(;ot!==St&&He[ot].id<wt.id;)ot++;if(ot===St||He[ot].id!==wt.id)continue;const Tt=new Array,Ft=new Array,rr=ot;for(;ot!==St&&He[ot].id===wt.id;){const sr=He[ot];if(Tt.push({position:sr.position,height:sr.height,extent:sr.extent}),ot!==rr&&He[ot-1].idx===sr.idx-1){const Ar=ot-rr;Ft.push({a:Ar-1,b:Ar})}ot++}gt.push(new ee(wt.id,wt.bounds,void 0,Tt,Ft,at))}return gt}}i.dV(ee,"ElevationFeature");class ce{constructor(ye){this.tileID=new i.aG(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.tileZoom=ye.tileZoom,this.uid=ye.uid,this.zoom=ye.zoom,this.lut=ye.lut,this.canonical=ye.tileID.canonical,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.scope=ye.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ye.showCollisionBoxes,this.collectResourceTiming=!!ye.request&&ye.request.collectResourceTiming,this.promoteId=ye.promoteId,this.isSymbolTile=ye.isSymbolTile,this.tileTransform=i.aQ(ye.tileID.canonical,ye.projection),this.projection=ye.projection,this.worldview=ye.worldview,this.localizableLayerIds=ye.localizableLayerIds,this.brightness=ye.brightness,this.extraShadowCaster=!!ye.extraShadowCaster,this.tessellationStep=ye.tessellationStep,this.scaleFactor=ye.scaleFactor}parse(ye,Se,Pe,He,Ye){this.status="parsing",this.data=ye,this.collisionBoxArray=new i.aW;const at=new i.d_(Object.keys(ye.layers).sort()),gt=new i.d$(this.tileID,this.promoteId);gt.bucketLayerIDs=[];const ot={},St=new i.e0(256,256),wt={featureIndex:gt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:St,availableImages:Pe,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Tt=Se.familiesBySource[this.source];for(const Vr in Tt){const Cn=ye.layers[Vr];if(!Cn)continue;let Hn=!1,bn=!1,Un=!1;for(const $a of Tt[Vr])$a[0].type==="symbol"?Hn=!0:bn=!0,$a[0].is3D()&&$a[0].type!=="model"&&(Un=!0);if(this.extraShadowCaster&&!Un||this.isSymbolTile===!0&&!Hn||this.isSymbolTile===!1&&!bn)continue;Cn.version===1&&i.w(`Vector tile source "${this.source}" layer "${Vr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const En=at.encode(Vr),Ca=[];let ds=!1;for(let $a=0,ts=0;$a<Cn.length;$a++){const ao=Cn.feature($a),Ou=gt.getId(ao,Vr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Vr)){const wl=ao.properties?ao.properties.worldview:null;if(this.worldview&&typeof wl=="string")if(wl==="all")ao.properties.$localized=!0;else{if(!wl.split(",").includes(this.worldview))continue;ao.properties.$localized=!0,ao.properties.worldview=this.worldview}}!ds&&ao.properties&&ao.properties.hasOwnProperty(U)&&(ds=!0),Ca.push({feature:ao,id:Ou,index:ts,sourceLayerIndex:En}),ts++}ds&&ye.layers.hasOwnProperty(B)&&(wt.elevationFeatures=se.parseFrom(ye.layers[B],this.canonical));for(const $a of Tt[Vr]){const ts=$a[0];(!this.extraShadowCaster||ts.is3D()&&ts.type!=="model")&&(this.isSymbolTile!==void 0&&ts.type==="symbol"!==this.isSymbolTile||ts.minzoom&&this.zoom<Math.floor(ts.minzoom)||ts.maxzoom&&this.zoom>=ts.maxzoom||ts.visibility!=="none"&&(ge($a,this.zoom,wt.brightness,Pe),(ot[ts.id]=ts.createBucket({index:gt.bucketLayerIDs.length,layers:$a,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:En,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Ca,wt,this.tileID.canonical,this.tileTransform),gt.bucketLayerIDs.push($a.map(ao=>i.aC(ao.id,ao.scope)))))}}let Ft,rr,sr,Ar;St.trim();const $r={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Ur=()=>{if(Ft)return this.status="done",Ye(Ft);if(this.extraShadowCaster)this.status="done",Ye(null,{buckets:i.bj(ot).filter(Vr=>!Vr.isEmpty()),featureIndex:gt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:wt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(rr&&sr&&Ar){const Vr=new F(rr),Cn=new i.e3(sr,Ar,this.lut);for(const Hn in ot){const bn=ot[Hn];bn instanceof i.aX?(ge(bn.layers,this.zoom,wt.brightness,Pe),i.e4(bn,rr,Vr.positions,sr,Cn.iconPositions,this.showCollisionBoxes,Pe,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):bn.hasPattern&&(bn instanceof i.b1||bn instanceof i.b2||bn instanceof i.d5)&&(ge(bn.layers,this.zoom,wt.brightness,Pe),bn.addFeatures(wt,this.tileID.canonical,Cn.patternPositions,Pe,this.tileTransform,this.brightness))}this.status="done",Ye(null,{buckets:i.bj(ot).filter(Hn=>!Hn.isEmpty()),featureIndex:gt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vr.image,lineAtlas:St,imageAtlas:Cn,brightness:wt.brightness})}};if(!this.extraShadowCaster){const Vr=i.e1(wt.glyphDependencies,bn=>Object.keys(bn).map(Number));Object.keys(Vr).length?He.send("getGlyphs",{uid:this.uid,stacks:Vr,scope:this.scope},(bn,Un)=>{Ft||(Ft=bn,rr=Un,Ur())},void 0,!1,$r):rr={};const Cn=Object.keys(wt.iconDependencies);Cn.length?He.send("getImages",{icons:Cn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(bn,Un)=>{if(Ft)return;Ft=bn;const En={};Object.values(Un).some(Ca=>Ca.usvg)?this.rasterize(He,En,Un,wt.iconDependencies,()=>{sr=En,Ur()}):(this.fillImageMap(En,wt.iconDependencies,Un),sr=En,Ur())},void 0,!1,$r):sr={};const Hn=Object.keys(wt.patternDependencies);Hn.length?He.send("getImages",{icons:Hn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(bn,Un)=>{if(!Ft){Ft=bn;const En={};Object.values(Un).some(Ca=>Ca.usvg)?this.rasterize(He,En,Un,wt.patternDependencies,()=>{Ar=En,Ur()}):(this.fillImageMap(En,wt.patternDependencies,Un),Ar=En,Ur())}},void 0,!1,$r):Ar={}}Ur()}fillImageMap(ye,Se,Pe){for(const He in Pe){const Ye=Se[He]||[];for(const at of Ye)Pe[at.id].usvg||(ye[at.serialize()]=Pe[at.id])}}getImageTaskQueue(ye,Se,Pe){const He={};for(const Ye in Se){const at=Pe[Ye]||[];for(const gt of at){const ot=gt.serialize();Se[gt.id].usvg?He[ot]||(He[ot]=gt):ye[ot]=Se[gt.id]}}return He}rasterize(ye,Se,Pe,He,Ye){const at=this.getImageTaskQueue(Se,Pe,He);this.rasterizeTask=ye.send("rasterizeImages",{scope:this.scope,imageTasks:at},(gt,ot)=>{if(!gt)for(const St in ot){const{id:wt}=i.e2.deserializeFromString(St);Se[St]=Object.assign({},Pe[wt],{data:ot[St]})}Ye()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function ge(At,ye,Se,Pe){const He=new i.a8(ye,{brightness:Se});for(const Ye of At)Ye.recalculate(He,Pe)}class Te extends i.E{constructor(ye,Se,Pe,He,Ye,at){super(),this.actor=ye,this.layerIndex=Se,this.availableImages=Pe,this.loadVectorData=Ye||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(ye.scheduler),this.isSpriteLoaded=He,this.scheduler=ye.scheduler,this.brightness=at}loadTile(ye,Se){const Pe=ye.uid,He=ye&&ye.request,Ye=He&&He.collectResourceTiming,at=this.loading[Pe]=new ce(ye);at.abort=this.loadVectorData(ye,(gt,ot)=>{const St=!this.loading[Pe];if(delete this.loading[Pe],at.cancelRasterize(),St||gt||!ot)return at.status="done",St||(this.loaded[Pe]=at),Se(gt);const wt=ot.rawData,Tt={};ot.expires&&(Tt.expires=ot.expires),ot.cacheControl&&(Tt.cacheControl=ot.cacheControl),at.vectorTile=ot.vectorTile||new i.dY.VectorTile(new i.bh(wt));const Ft=()=>{at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.actor,(rr,sr)=>{if(rr||!sr)return Se(rr);const Ar={};if(Ye){const $r=_(He);$r.length>0&&(Ar.resourceTiming=JSON.parse(JSON.stringify($r)))}Se(null,i.l({rawTileData:wt.slice(0)},sr,Tt,Ar))})};this.isSpriteLoaded?Ft():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ft,{type:"parseTile",isSymbolTile:ye.isSymbolTile,zoom:ye.tileZoom}):Ft()}),this.loaded=this.loaded||{},this.loaded[Pe]=at})}reloadTile(ye,Se){const Pe=this.loaded,He=ye.uid;if(Pe&&Pe[He]){const Ye=Pe[He];Ye.scaleFactor=ye.scaleFactor,Ye.showCollisionBoxes=ye.showCollisionBoxes,Ye.projection=ye.projection,Ye.brightness=ye.brightness,Ye.tileTransform=i.aQ(ye.tileID.canonical,ye.projection),Ye.extraShadowCaster=ye.extraShadowCaster,Ye.lut=ye.lut;const at=(gt,ot)=>{const St=Ye.reloadCallback;St&&(delete Ye.reloadCallback,Ye.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.actor,St)),Se(gt,ot)};Ye.status==="parsing"?Ye.reloadCallback=at:Ye.status==="done"&&(Ye.vectorTile?Ye.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.actor,at):at())}else Se(null,void 0)}abortTile(ye,Se){const Pe=ye.uid,He=this.loading[Pe];He&&(He.abort&&He.abort(),delete this.loading[Pe]),Se()}removeTile(ye,Se){const Pe=this.loaded,He=ye.uid;Pe&&Pe[He]&&delete Pe[He],Se()}}class Ae{loadTile(ye,Se){const{uid:Pe,encoding:He,rawImageData:Ye,padding:at}=ye,gt=ImageBitmap&&Ye instanceof ImageBitmap?this.getImageData(Ye,at):Ye;Se(null,new i.e5(Pe,gt,He,at<1))}getImageData(ye,Se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ye.width,ye.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ye.width,this.offscreenCanvas.height=ye.height,this.offscreenCanvasContext.drawImage(ye,0,0,ye.width,ye.height);const Pe=this.offscreenCanvasContext.getImageData(-Se,-Se,ye.width+2*Se,ye.height+2*Se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Pe}}i.bg.setPbf(i.bh);class _e{decodeRasterArray({task:ye,buffer:Se},Pe){i.bg.performDecoding(Se,ye).then(He=>{Pe(null,He)},He=>{Pe(He)})}}const Ee=i.dY.VectorTileFeature.prototype.toGeoJSON;class ke{constructor(ye){this._feature=ye,this.extent=i.ag,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const Se of this._feature.geometry)ye.push([new i.P(Se[0],Se[1])]);return ye}{const ye=[];for(const Se of this._feature.geometry){const Pe=[];for(const He of Se)Pe.push(new i.P(He[0],He[1]));ye.push(Pe)}return ye}}toGeoJSON(ye,Se,Pe){return Ee.call(this,ye,Se,Pe)}}class Qe{constructor(ye){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=ye.length,this._features=ye}feature(ye){return new ke(this._features[ye])}}const Ze=64/4096,Ge=128;class Oe{constructor(){this.features=new Map}clear(){this.features.clear()}load(ye=[],Se){for(const Pe of ye){const He=Pe.id;if(He==null)continue;let Ye=this.features.get(He);Ye&&this.updateCache(Ye,Se),Pe.geometry?(Ye=Le(Pe),this.updateCache(Ye,Se),this.features.set(He,Ye)):this.features.delete(He),this.updateCache(Ye,Se)}}updateCache(ye,Se){for(const{canonical:Pe,uid:He}of Object.values(Se)){const{z:Ye,x:at,y:gt}=Pe;je(ye,Math.pow(2,Ye),at,gt)&&delete Se[He]}}getTile(ye,Se,Pe){const He=Math.pow(2,ye),Ye=[];for(const at of this.features.values())je(at,He,Se,Pe)&&Ye.push(rt(at,He,Se,Pe));return{features:Ye}}getFeatures(){return[...this.features.values()]}}function je({minX:At,minY:ye,maxX:Se,maxY:Pe},He,Ye,at){return At<(Ye+1+Ze)/He&&ye<(at+1+Ze)/He&&Se>(Ye-Ze)/He&&Pe>(at-Ze)/He}function Le(At){const{id:ye,geometry:Se,properties:Pe}=At;if(!Se)return;if(Se.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:He,coordinates:Ye}=Se,at={id:ye,type:1,geometry:[],tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},gt=at.geometry;if(He==="Point")ut(Ye,gt,at);else if(He==="MultiPoint")for(const ot of Ye)ut(ot,gt,at);else if(He==="LineString")at.type=2,ze(Ye,gt,at);else if(He==="MultiLineString")at.type=2,ht(Ye,gt,at);else if(He==="Polygon")at.type=3,ht(Ye,gt,at,!0);else{if(He!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");at.type=3;for(const ot of Ye)ht(ot,gt,at,!0)}return at}function ut([At,ye],Se,Pe){const He=i.at(At);let Ye=i.aA(ye);Ye=Ye<0?0:Ye>1?1:Ye,Se.push(He,Ye),Pe.minX=Math.min(Pe.minX,He),Pe.minY=Math.min(Pe.minY,Ye),Pe.maxX=Math.max(Pe.maxX,He),Pe.maxY=Math.max(Pe.maxY,Ye)}function ze(At,ye,Se,Pe=!1,He=!1){const Ye=[];for(const at of At)ut(at,Ye,Se);ye.push(Ye),Pe&&function(at,gt){let ot=0;for(let St=0,wt=at.length,Tt=wt-2;St<wt;Tt=St,St+=2)ot+=(at[St]-at[Tt])*(at[St+1]+at[Tt+1]);if(ot>0===gt)for(let St=0,wt=at.length;St<wt/2;St+=2){const Tt=at[St],Ft=at[St+1];at[St]=at[wt-2-St],at[St+1]=at[wt-1-St],at[wt-2-St]=Tt,at[wt-1-St]=Ft}}(Ye,He)}function ht(At,ye,Se,Pe=!1){for(let He=0;He<At.length;He++)ze(At[He],ye,Se,Pe,He===0)}function rt(At,ye,Se,Pe){const{id:He,type:Ye,geometry:at,tags:gt}=At,ot=[];if(Ye===1)(function(St,wt,Tt,Ft,rr){for(let sr=0;sr<St.length;sr+=2){const Ar=Math.round(i.ag*(St[sr+0]*wt-Tt)),$r=Math.round(i.ag*(St[sr+1]*wt-Ft));rr.push([Ar,$r])}})(at,ye,Se,Pe,ot);else for(const St of at)Qt(St,ye,Se,Pe,ot);return{id:He,type:Ye,geometry:ot,tags:gt}}function Qt(At,ye,Se,Pe,He){const at=i.ag+Ge;let gt;for(let ot=0;ot<At.length-2;ot+=2){let St=Math.round(i.ag*(At[ot+0]*ye-Se)),wt=Math.round(i.ag*(At[ot+1]*ye-Pe)),Tt=Math.round(i.ag*(At[ot+2]*ye-Se)),Ft=Math.round(i.ag*(At[ot+3]*ye-Pe));const rr=Tt-St,sr=Ft-wt;St<-128&&Tt<-128||(St<-128?(wt+=Math.round(sr*((-128-St)/rr)),St=-128):Tt<-128&&(Ft=wt+Math.round(sr*((-128-St)/rr)),Tt=-128),wt<-128&&Ft<-128||(wt<-128?(St+=Math.round(rr*((-128-wt)/sr)),wt=-128):Ft<-128&&(Tt=St+Math.round(rr*((-128-wt)/sr)),Ft=-128),St>=at&&Tt>=at||(St>=at?(wt+=Math.round(sr*((at-St)/rr)),St=at):Tt>=at&&(Ft=wt+Math.round(sr*((at-St)/rr)),Tt=at),wt>=at&&Ft>=at||(wt>=at?(St+=Math.round(rr*((at-wt)/sr)),wt=at):Ft>=at&&(Tt=St+Math.round(rr*((at-wt)/sr)),Ft=at),gt&&St===gt[gt.length-1][0]&&wt===gt[gt.length-1][1]||(gt=[[St,wt]],He.push(gt)),gt.push([Tt,Ft])))))}}var Cr,vr,cr,nr={exports:{}},Kt=function(){if(cr)return nr.exports;cr=1;var At=i.e8(),ye=function(){if(vr)return Cr;vr=1;var wt=i.e6(),Tt=i.e7().VectorTileFeature;function Ft(sr,Ar){this.options=Ar||{},this.features=sr,this.length=sr.length}function rr(sr,Ar){this.id=typeof sr.id=="number"?sr.id:void 0,this.type=sr.type,this.rawGeometry=sr.type===1?[sr.geometry]:sr.geometry,this.properties=sr.tags,this.extent=Ar||4096}return Cr=Ft,Ft.prototype.feature=function(sr){return new rr(this.features[sr],this.options.extent)},rr.prototype.loadGeometry=function(){var sr=this.rawGeometry;this.geometry=[];for(var Ar=0;Ar<sr.length;Ar++){for(var $r=sr[Ar],Ur=[],Vr=0;Vr<$r.length;Vr++)Ur.push(new wt($r[Vr][0],$r[Vr][1]));this.geometry.push(Ur)}return this.geometry},rr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var sr=this.geometry,Ar=1/0,$r=-1/0,Ur=1/0,Vr=-1/0,Cn=0;Cn<sr.length;Cn++)for(var Hn=sr[Cn],bn=0;bn<Hn.length;bn++){var Un=Hn[bn];Ar=Math.min(Ar,Un.x),$r=Math.max($r,Un.x),Ur=Math.min(Ur,Un.y),Vr=Math.max(Vr,Un.y)}return[Ar,Ur,$r,Vr]},rr.prototype.toGeoJSON=Tt.prototype.toGeoJSON,Cr}();function Se(wt){var Tt=new At;return function(Ft,rr){for(var sr in Ft.layers)rr.writeMessage(3,Pe,Ft.layers[sr])}(wt,Tt),Tt.finish()}function Pe(wt,Tt){var Ft;Tt.writeVarintField(15,wt.version||1),Tt.writeStringField(1,wt.name||""),Tt.writeVarintField(5,wt.extent||4096);var rr={keys:[],values:[],keycache:{},valuecache:{}};for(Ft=0;Ft<wt.length;Ft++)rr.feature=wt.feature(Ft),Tt.writeMessage(2,He,rr);var sr=rr.keys;for(Ft=0;Ft<sr.length;Ft++)Tt.writeStringField(3,sr[Ft]);var Ar=rr.values;for(Ft=0;Ft<Ar.length;Ft++)Tt.writeMessage(4,St,Ar[Ft])}function He(wt,Tt){var Ft=wt.feature;Ft.id!==void 0&&Tt.writeVarintField(1,Ft.id),Tt.writeMessage(2,Ye,wt),Tt.writeVarintField(3,Ft.type),Tt.writeMessage(4,ot,Ft)}function Ye(wt,Tt){var Ft=wt.feature,rr=wt.keys,sr=wt.values,Ar=wt.keycache,$r=wt.valuecache;for(var Ur in Ft.properties){var Vr=Ft.properties[Ur],Cn=Ar[Ur];if(Vr!==null){Cn===void 0&&(rr.push(Ur),Ar[Ur]=Cn=rr.length-1),Tt.writeVarint(Cn);var Hn=typeof Vr;Hn!=="string"&&Hn!=="boolean"&&Hn!=="number"&&(Vr=JSON.stringify(Vr));var bn=Hn+":"+Vr,Un=$r[bn];Un===void 0&&(sr.push(Vr),$r[bn]=Un=sr.length-1),Tt.writeVarint(Un)}}}function at(wt,Tt){return(Tt<<3)+(7&wt)}function gt(wt){return wt<<1^wt>>31}function ot(wt,Tt){for(var Ft=wt.loadGeometry(),rr=wt.type,sr=0,Ar=0,$r=Ft.length,Ur=0;Ur<$r;Ur++){var Vr=Ft[Ur],Cn=1;rr===1&&(Cn=Vr.length),Tt.writeVarint(at(1,Cn));for(var Hn=rr===3?Vr.length-1:Vr.length,bn=0;bn<Hn;bn++){bn===1&&rr!==1&&Tt.writeVarint(at(2,Hn-1));var Un=Vr[bn].x-sr,En=Vr[bn].y-Ar;Tt.writeVarint(gt(Un)),Tt.writeVarint(gt(En)),sr+=Un,Ar+=En}rr===3&&Tt.writeVarint(at(7,1))}}function St(wt,Tt){var Ft=typeof wt;Ft==="string"?Tt.writeStringField(1,wt):Ft==="boolean"?Tt.writeBooleanField(7,wt):Ft==="number"&&(wt%1!=0?Tt.writeDoubleField(3,wt):wt<0?Tt.writeSVarintField(6,wt):Tt.writeVarintField(5,wt))}return nr.exports=Se,nr.exports.fromVectorTileJs=Se,nr.exports.fromGeojsonVt=function(wt,Tt){Tt=Tt||{};var Ft={};for(var rr in wt)Ft[rr]=new ye(wt[rr].features,Tt),Ft[rr].name=rr,Ft[rr].version=Tt.version,Ft[rr].extent=Tt.extent;return Se({layers:Ft})},nr.exports.GeoJSONWrapper=ye,nr.exports}(),De=i.e9(Kt);const er={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:At=>At},Lt=Math.fround||(Rr=new Float32Array(1),At=>(Rr[0]=+At,Rr[0]));var Rr;const Pt=3,nn=5,Sn=6;class Br{constructor(ye){this.options=Object.assign(Object.create(er),ye),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ye){const{log:Se,minZoom:Pe,maxZoom:He}=this.options;Se&&console.time("total time");const Ye=`prepare ${ye.length} points`;Se&&console.time(Ye),this.points=ye;const at=[];for(let ot=0;ot<ye.length;ot++){const St=ye[ot];if(!St.geometry)continue;const[wt,Tt]=St.geometry.coordinates,Ft=Lt(zt(wt)),rr=Lt(xr(Tt));at.push(Ft,rr,1/0,ot,-1,1),this.options.reduce&&at.push(0)}let gt=this.trees[He+1]=this._createTree(at);Se&&console.timeEnd(Ye);for(let ot=He;ot>=Pe;ot--){const St=+Date.now();gt=this.trees[ot]=this._createTree(this._cluster(gt,ot)),Se&&console.log("z%d: %d clusters in %dms",ot,gt.numItems,+Date.now()-St)}return Se&&console.timeEnd("total time"),this}getClusters(ye,Se){let Pe=((ye[0]+180)%360+360)%360-180;const He=Math.max(-90,Math.min(90,ye[1]));let Ye=ye[2]===180?180:((ye[2]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,ye[3]));if(ye[2]-ye[0]>=360)Pe=-180,Ye=180;else if(Pe>Ye){const Tt=this.getClusters([Pe,He,180,at],Se),Ft=this.getClusters([-180,He,Ye,at],Se);return Tt.concat(Ft)}const gt=this.trees[this._limitZoom(Se)],ot=gt.range(zt(Pe),xr(at),zt(Ye),xr(He)),St=gt.data,wt=[];for(const Tt of ot){const Ft=this.stride*Tt;wt.push(St[Ft+nn]>1?et(St,Ft,this.clusterProps):this.points[St[Ft+Pt]])}return wt}getChildren(ye){const Se=this._getOriginId(ye),Pe=this._getOriginZoom(ye),He="No cluster with the specified id.",Ye=this.trees[Pe];if(!Ye)throw new Error(He);const at=Ye.data;if(Se*this.stride>=at.length)throw new Error(He);const gt=this.options.radius/(this.options.extent*Math.pow(2,Pe-1)),ot=Ye.within(at[Se*this.stride],at[Se*this.stride+1],gt),St=[];for(const wt of ot){const Tt=wt*this.stride;at[Tt+4]===ye&&St.push(at[Tt+nn]>1?et(at,Tt,this.clusterProps):this.points[at[Tt+Pt]])}if(St.length===0)throw new Error(He);return St}getLeaves(ye,Se,Pe){const He=[];return this._appendLeaves(He,ye,Se=Se||10,Pe=Pe||0,0),He}getTile(ye,Se,Pe){const He=this.trees[this._limitZoom(ye)],Ye=Math.pow(2,ye),{extent:at,radius:gt}=this.options,ot=gt/at,St=(Pe-ot)/Ye,wt=(Pe+1+ot)/Ye,Tt={features:[]};return this._addTileFeatures(He.range((Se-ot)/Ye,St,(Se+1+ot)/Ye,wt),He.data,Se,Pe,Ye,Tt),Se===0&&this._addTileFeatures(He.range(1-ot/Ye,St,1,wt),He.data,Ye,Pe,Ye,Tt),Se===Ye-1&&this._addTileFeatures(He.range(0,St,ot/Ye,wt),He.data,-1,Pe,Ye,Tt),Tt.features.length?Tt:null}getClusterExpansionZoom(ye){let Se=this._getOriginZoom(ye)-1;for(;Se<=this.options.maxZoom;){const Pe=this.getChildren(ye);if(Se++,Pe.length!==1)break;ye=Pe[0].properties.cluster_id}return Se}_appendLeaves(ye,Se,Pe,He,Ye){const at=this.getChildren(Se);for(const gt of at){const ot=gt.properties;if(ot&&ot.cluster?Ye+ot.point_count<=He?Ye+=ot.point_count:Ye=this._appendLeaves(ye,ot.cluster_id,Pe,He,Ye):Ye<He?Ye++:ye.push(gt),ye.length===Pe)break}return Ye}_createTree(ye){const Se=new i.bE(ye.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Pe=0;Pe<ye.length;Pe+=this.stride)Se.add(ye[Pe],ye[Pe+1]);return Se.finish(),Se.data=ye,Se}_addTileFeatures(ye,Se,Pe,He,Ye,at){for(const gt of ye){const ot=gt*this.stride,St=Se[ot+nn]>1;let wt,Tt,Ft;if(St)wt=bt(Se,ot,this.clusterProps),Tt=Se[ot],Ft=Se[ot+1];else{const Ar=this.points[Se[ot+Pt]];wt=Ar.properties;const[$r,Ur]=Ar.geometry.coordinates;Tt=zt($r),Ft=xr(Ur)}const rr={type:1,geometry:[[Math.round(this.options.extent*(Tt*Ye-Pe)),Math.round(this.options.extent*(Ft*Ye-He))]],tags:wt};let sr;sr=St||this.options.generateId?Se[ot+Pt]:this.points[Se[ot+Pt]].id,sr!==void 0&&(rr.id=sr),at.features.push(rr)}}_limitZoom(ye){return Math.max(this.options.minZoom,Math.min(Math.floor(+ye),this.options.maxZoom+1))}_cluster(ye,Se){const{radius:Pe,extent:He,reduce:Ye,minPoints:at}=this.options,gt=Pe/(He*Math.pow(2,Se)),ot=ye.data,St=[],wt=this.stride;for(let Tt=0;Tt<ot.length;Tt+=wt){if(ot[Tt+2]<=Se)continue;ot[Tt+2]=Se;const Ft=ot[Tt],rr=ot[Tt+1],sr=ye.within(ot[Tt],ot[Tt+1],gt),Ar=ot[Tt+nn];let $r=Ar;for(const Ur of sr){const Vr=Ur*wt;ot[Vr+2]>Se&&($r+=ot[Vr+nn])}if($r>Ar&&$r>=at){let Ur,Vr=Ft*Ar,Cn=rr*Ar,Hn=-1;const bn=(Tt/wt<<5)+(Se+1)+this.points.length;for(const Un of sr){const En=Un*wt;if(ot[En+2]<=Se)continue;ot[En+2]=Se;const Ca=ot[En+nn];Vr+=ot[En]*Ca,Cn+=ot[En+1]*Ca,ot[En+4]=bn,Ye&&(Ur||(Ur=this._map(ot,Tt,!0),Hn=this.clusterProps.length,this.clusterProps.push(Ur)),Ye(Ur,this._map(ot,En)))}ot[Tt+4]=bn,St.push(Vr/$r,Cn/$r,1/0,bn,-1,$r),Ye&&St.push(Hn)}else{for(let Ur=0;Ur<wt;Ur++)St.push(ot[Tt+Ur]);if($r>1)for(const Ur of sr){const Vr=Ur*wt;if(!(ot[Vr+2]<=Se)){ot[Vr+2]=Se;for(let Cn=0;Cn<wt;Cn++)St.push(ot[Vr+Cn])}}}}return St}_getOriginId(ye){return ye-this.points.length>>5}_getOriginZoom(ye){return(ye-this.points.length)%32}_map(ye,Se,Pe){if(ye[Se+nn]>1){const at=this.clusterProps[ye[Se+Sn]];return Pe?Object.assign({},at):at}const He=this.points[ye[Se+Pt]].properties,Ye=this.options.map(He);return Pe&&Ye===He?Object.assign({},Ye):Ye}}function et(At,ye,Se){return{type:"Feature",id:At[ye+Pt],properties:bt(At,ye,Se),geometry:{type:"Point",coordinates:[(Pe=At[ye],360*(Pe-.5)),fr(At[ye+1])]}};var Pe}function bt(At,ye,Se){const Pe=At[ye+nn],He=Pe>=1e4?`${Math.round(Pe/1e3)}k`:Pe>=1e3?Math.round(Pe/100)/10+"k":Pe,Ye=At[ye+Sn],at=Ye===-1?{}:Object.assign({},Se[Ye]);return Object.assign(at,{cluster:!0,cluster_id:At[ye+Pt],point_count:Pe,point_count_abbreviated:He})}function zt(At){return At/360+.5}function xr(At){const ye=Math.sin(At*Math.PI/180),Se=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return Se<0?0:Se>1?1:Se}function fr(At){const ye=(180-360*At)*Math.PI/180;return 360*Math.atan(Math.exp(ye))/Math.PI-90}function pr(At,ye,Se,Pe){let He=Pe;const Ye=ye+(Se-ye>>1);let at,gt=Se-ye;const ot=At[ye],St=At[ye+1],wt=At[Se],Tt=At[Se+1];for(let Ft=ye+3;Ft<Se;Ft+=3){const rr=ar(At[Ft],At[Ft+1],ot,St,wt,Tt);if(rr>He)at=Ft,He=rr;else if(rr===He){const sr=Math.abs(Ft-Ye);sr<gt&&(at=Ft,gt=sr)}}He>Pe&&(at-ye>3&&pr(At,ye,at,Pe),At[at+2]=He,Se-at>3&&pr(At,at,Se,Pe))}function ar(At,ye,Se,Pe,He,Ye){let at=He-Se,gt=Ye-Pe;if(at!==0||gt!==0){const ot=((At-Se)*at+(ye-Pe)*gt)/(at*at+gt*gt);ot>1?(Se=He,Pe=Ye):ot>0&&(Se+=at*ot,Pe+=gt*ot)}return at=At-Se,gt=ye-Pe,at*at+gt*gt}function tn(At,ye,Se,Pe){const He={id:At??null,type:ye,geometry:Se,tags:Pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Xn(He,Se);else if(ye==="Polygon")Xn(He,Se[0]);else if(ye==="MultiLineString")for(const Ye of Se)Xn(He,Ye);else if(ye==="MultiPolygon")for(const Ye of Se)Xn(He,Ye[0]);return He}function Xn(At,ye){for(let Se=0;Se<ye.length;Se+=3)At.minX=Math.min(At.minX,ye[Se]),At.minY=Math.min(At.minY,ye[Se+1]),At.maxX=Math.max(At.maxX,ye[Se]),At.maxY=Math.max(At.maxY,ye[Se+1])}function Bi(At,ye,Se,Pe){if(!ye.geometry)return;const He=ye.geometry.coordinates;if(He&&He.length===0)return;const Ye=ye.geometry.type,at=Math.pow(Se.tolerance/((1<<Se.maxZoom)*Se.extent),2);let gt=[],ot=ye.id;if(Se.promoteId?ot=ye.properties[Se.promoteId]:Se.generateId&&(ot=Pe||0),Ye==="Point")Vi(He,gt);else if(Ye==="MultiPoint")for(const St of He)Vi(St,gt);else if(Ye==="LineString")io(He,gt,at,!1);else if(Ye==="MultiLineString"){if(Se.lineMetrics){for(const St of He)gt=[],io(St,gt,at,!1),At.push(tn(ot,"LineString",gt,ye.properties));return}Va(He,gt,at,!1)}else if(Ye==="Polygon")Va(He,gt,at,!0);else{if(Ye!=="MultiPolygon"){if(Ye==="GeometryCollection"){for(const St of ye.geometry.geometries)Bi(At,{id:ot,geometry:St,properties:ye.properties},Se,Pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const St of He){const wt=[];Va(St,wt,at,!0),gt.push(wt)}}At.push(tn(ot,Ye,gt,ye.properties))}function Vi(At,ye){ye.push(Vs(At[0]),yo(At[1]),0)}function io(At,ye,Se,Pe){let He,Ye,at=0;for(let ot=0;ot<At.length;ot++){const St=Vs(At[ot][0]),wt=yo(At[ot][1]);ye.push(St,wt,0),ot>0&&(at+=Pe?(He*wt-St*Ye)/2:Math.sqrt(Math.pow(St-He,2)+Math.pow(wt-Ye,2))),He=St,Ye=wt}const gt=ye.length-3;ye[2]=1,pr(ye,0,gt,Se),ye[gt+2]=1,ye.size=Math.abs(at),ye.start=0,ye.end=ye.size}function Va(At,ye,Se,Pe){for(let He=0;He<At.length;He++){const Ye=[];io(At[He],Ye,Se,Pe),ye.push(Ye)}}function Vs(At){return At/360+.5}function yo(At){const ye=Math.sin(At*Math.PI/180),Se=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return Se<0?0:Se>1?1:Se}function Qa(At,ye,Se,Pe,He,Ye,at,gt){if(Pe/=ye,Ye>=(Se/=ye)&&at<Pe)return At;if(at<Se||Ye>=Pe)return null;const ot=[];for(const St of At){const wt=St.geometry;let Tt=St.type;const Ft=He===0?St.minX:St.minY,rr=He===0?St.maxX:St.maxY;if(Ft>=Se&&rr<Pe){ot.push(St);continue}if(rr<Se||Ft>=Pe)continue;let sr=[];if(Tt==="Point"||Tt==="MultiPoint")ql(wt,sr,Se,Pe,He);else if(Tt==="LineString")_l(wt,sr,Se,Pe,He,!1,gt.lineMetrics);else if(Tt==="MultiLineString")Gl(wt,sr,Se,Pe,He,!1);else if(Tt==="Polygon")Gl(wt,sr,Se,Pe,He,!0);else if(Tt==="MultiPolygon")for(const Ar of wt){const $r=[];Gl(Ar,$r,Se,Pe,He,!0),$r.length&&sr.push($r)}if(sr.length){if(gt.lineMetrics&&Tt==="LineString"){for(const Ar of sr)ot.push(tn(St.id,Tt,Ar,St.tags));continue}Tt!=="LineString"&&Tt!=="MultiLineString"||(sr.length===1?(Tt="LineString",sr=sr[0]):Tt="MultiLineString"),Tt!=="Point"&&Tt!=="MultiPoint"||(Tt=sr.length===3?"Point":"MultiPoint"),ot.push(tn(St.id,Tt,sr,St.tags))}}return ot.length?ot:null}function ql(At,ye,Se,Pe,He){for(let Ye=0;Ye<At.length;Ye+=3){const at=At[Ye+He];at>=Se&&at<=Pe&&an(ye,At[Ye],At[Ye+1],At[Ye+2])}}function _l(At,ye,Se,Pe,He,Ye,at){let gt=Os(At);const ot=He===0?es:Mu;let St,wt,Tt=At.start;for(let $r=0;$r<At.length-3;$r+=3){const Ur=At[$r],Vr=At[$r+1],Cn=At[$r+2],Hn=At[$r+3],bn=At[$r+4],Un=He===0?Ur:Vr,En=He===0?Hn:bn;let Ca=!1;at&&(St=Math.sqrt(Math.pow(Ur-Hn,2)+Math.pow(Vr-bn,2))),Un<Se?En>Se&&(wt=ot(gt,Ur,Vr,Hn,bn,Se),at&&(gt.start=Tt+St*wt)):Un>Pe?En<Pe&&(wt=ot(gt,Ur,Vr,Hn,bn,Pe),at&&(gt.start=Tt+St*wt)):an(gt,Ur,Vr,Cn),En<Se&&Un>=Se&&(wt=ot(gt,Ur,Vr,Hn,bn,Se),Ca=!0),En>Pe&&Un<=Pe&&(wt=ot(gt,Ur,Vr,Hn,bn,Pe),Ca=!0),!Ye&&Ca&&(at&&(gt.end=Tt+St*wt),ye.push(gt),gt=Os(At)),at&&(Tt+=St)}let Ft=At.length-3;const rr=At[Ft],sr=At[Ft+1],Ar=He===0?rr:sr;Ar>=Se&&Ar<=Pe&&an(gt,rr,sr,At[Ft+2]),Ft=gt.length-3,Ye&&Ft>=3&&(gt[Ft]!==gt[0]||gt[Ft+1]!==gt[1])&&an(gt,gt[0],gt[1],gt[2]),gt.length&&ye.push(gt)}function Os(At){const ye=[];return ye.size=At.size,ye.start=At.start,ye.end=At.end,ye}function Gl(At,ye,Se,Pe,He,Ye){for(const at of At)_l(at,ye,Se,Pe,He,Ye,!1)}function an(At,ye,Se,Pe){At.push(ye,Se,Pe)}function es(At,ye,Se,Pe,He,Ye){const at=(Ye-ye)/(Pe-ye);return an(At,Ye,Se+(He-Se)*at,1),at}function Mu(At,ye,Se,Pe,He,Ye){const at=(Ye-Se)/(He-Se);return an(At,ye+(Pe-ye)*at,Ye,1),at}function Ua(At,ye){const Se=[];for(let Pe=0;Pe<At.length;Pe++){const He=At[Pe],Ye=He.type;let at;if(Ye==="Point"||Ye==="MultiPoint"||Ye==="LineString")at=Us(He.geometry,ye);else if(Ye==="MultiLineString"||Ye==="Polygon"){at=[];for(const gt of He.geometry)at.push(Us(gt,ye))}else if(Ye==="MultiPolygon"){at=[];for(const gt of He.geometry){const ot=[];for(const St of gt)ot.push(Us(St,ye));at.push(ot)}}Se.push(tn(He.id,Ye,at,He.tags))}return Se}function Us(At,ye){const Se=[];Se.size=At.size,At.start!==void 0&&(Se.start=At.start,Se.end=At.end);for(let Pe=0;Pe<At.length;Pe+=3)Se.push(At[Pe]+ye,At[Pe+1],At[Pe+2]);return Se}function qn(At,ye){if(At.transformed)return At;const Se=1<<At.z,Pe=At.x,He=At.y;for(const Ye of At.features){const at=Ye.geometry,gt=Ye.type;if(Ye.geometry=[],gt===1)for(let ot=0;ot<at.length;ot+=2)Ye.geometry.push(ha(at[ot],at[ot+1],ye,Se,Pe,He));else for(let ot=0;ot<at.length;ot++){const St=[];for(let wt=0;wt<at[ot].length;wt+=2)St.push(ha(at[ot][wt],at[ot][wt+1],ye,Se,Pe,He));Ye.geometry.push(St)}}return At.transformed=!0,At}function ha(At,ye,Se,Pe,He,Ye){return[Math.round(Se*(At*Pe-He)),Math.round(Se*(ye*Pe-Ye))]}function Ta(At,ye,Se,Pe,He){const Ye=ye===He.maxZoom?0:He.tolerance/((1<<ye)*He.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:At.length,source:null,x:Se,y:Pe,z:ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const gt of At)ws(at,gt,Ye,He);return at}function ws(At,ye,Se,Pe){const He=ye.geometry,Ye=ye.type,at=[];if(At.minX=Math.min(At.minX,ye.minX),At.minY=Math.min(At.minY,ye.minY),At.maxX=Math.max(At.maxX,ye.maxX),At.maxY=Math.max(At.maxY,ye.maxY),Ye==="Point"||Ye==="MultiPoint")for(let gt=0;gt<He.length;gt+=3)at.push(He[gt],He[gt+1]),At.numPoints++,At.numSimplified++;else if(Ye==="LineString")bl(at,He,At,Se,!1,!1);else if(Ye==="MultiLineString"||Ye==="Polygon")for(let gt=0;gt<He.length;gt++)bl(at,He[gt],At,Se,Ye==="Polygon",gt===0);else if(Ye==="MultiPolygon")for(let gt=0;gt<He.length;gt++){const ot=He[gt];for(let St=0;St<ot.length;St++)bl(at,ot[St],At,Se,!0,St===0)}if(at.length){let gt=ye.tags||null;if(Ye==="LineString"&&Pe.lineMetrics){gt={};for(const St in ye.tags)gt[St]=ye.tags[St];gt.mapbox_clip_start=He.start/He.size,gt.mapbox_clip_end=He.end/He.size}const ot={geometry:at,type:Ye==="Polygon"||Ye==="MultiPolygon"?3:Ye==="LineString"||Ye==="MultiLineString"?2:1,tags:gt};ye.id!==null&&(ot.id=ye.id),At.features.push(ot)}}function bl(At,ye,Se,Pe,He,Ye){const at=Pe*Pe;if(Pe>0&&ye.size<(He?at:Pe))return void(Se.numPoints+=ye.length/3);const gt=[];for(let ot=0;ot<ye.length;ot+=3)(Pe===0||ye[ot+2]>at)&&(Se.numSimplified++,gt.push(ye[ot],ye[ot+1])),Se.numPoints++;He&&function(ot,St){let wt=0;for(let Tt=0,Ft=ot.length,rr=Ft-2;Tt<Ft;rr=Tt,Tt+=2)wt+=(ot[Tt]-ot[rr])*(ot[Tt+1]+ot[rr+1]);if(wt>0===St)for(let Tt=0,Ft=ot.length;Tt<Ft/2;Tt+=2){const rr=ot[Tt],sr=ot[Tt+1];ot[Tt]=ot[Ft-2-Tt],ot[Tt+1]=ot[Ft-1-Tt],ot[Ft-2-Tt]=rr,ot[Ft-1-Tt]=sr}}(gt,Ye),At.push(gt)}const Pa={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ns{constructor(ye,Se){const Pe=(Se=this.options=function(Ye,at){for(const gt in at)Ye[gt]=at[gt];return Ye}(Object.create(Pa),Se)).debug;if(Pe&&console.time("preprocess data"),Se.maxZoom<0||Se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Se.promoteId&&Se.generateId)throw new Error("promoteId and generateId cannot be used together.");let He=function(Ye,at){const gt=[];if(Ye.type==="FeatureCollection")for(let ot=0;ot<Ye.features.length;ot++)Bi(gt,Ye.features[ot],at,ot);else Bi(gt,Ye.type==="Feature"?Ye:{geometry:Ye},at);return gt}(ye,Se);this.tiles={},this.tileCoords=[],Pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Se.indexMaxZoom,Se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),He=function(Ye,at){const gt=at.buffer/at.extent;let ot=Ye;const St=Qa(Ye,1,-1-gt,gt,0,-1,2,at),wt=Qa(Ye,1,1-gt,2+gt,0,-1,2,at);return(St||wt)&&(ot=Qa(Ye,1,-gt,1+gt,0,-1,2,at)||[],St&&(ot=Ua(St,1).concat(ot)),wt&&(ot=ot.concat(Ua(wt,-1)))),ot}(He,Se),He.length&&this.splitTile(He,0,0,0),Pe&&(He.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ye,Se,Pe,He,Ye,at,gt){const ot=[ye,Se,Pe,He],St=this.options,wt=St.debug;for(;ot.length;){He=ot.pop(),Pe=ot.pop(),Se=ot.pop(),ye=ot.pop();const Tt=1<<Se,Ft=Ui(Se,Pe,He);let rr=this.tiles[Ft];if(!rr&&(wt>1&&console.time("creation"),rr=this.tiles[Ft]=Ta(ye,Se,Pe,He,St),this.tileCoords.push({z:Se,x:Pe,y:He}),wt)){wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Se,Pe,He,rr.numFeatures,rr.numPoints,rr.numSimplified),console.timeEnd("creation"));const Ca=`z${Se}`;this.stats[Ca]=(this.stats[Ca]||0)+1,this.total++}if(rr.source=ye,Ye==null){if(Se===St.indexMaxZoom||rr.numPoints<=St.indexMaxPoints)continue}else{if(Se===St.maxZoom||Se===Ye)continue;if(Ye!=null){const Ca=Ye-Se;if(Pe!==at>>Ca||He!==gt>>Ca)continue}}if(rr.source=null,ye.length===0)continue;wt>1&&console.time("clipping");const sr=.5*St.buffer/St.extent,Ar=.5-sr,$r=.5+sr,Ur=1+sr;let Vr=null,Cn=null,Hn=null,bn=null,Un=Qa(ye,Tt,Pe-sr,Pe+$r,0,rr.minX,rr.maxX,St),En=Qa(ye,Tt,Pe+Ar,Pe+Ur,0,rr.minX,rr.maxX,St);ye=null,Un&&(Vr=Qa(Un,Tt,He-sr,He+$r,1,rr.minY,rr.maxY,St),Cn=Qa(Un,Tt,He+Ar,He+Ur,1,rr.minY,rr.maxY,St),Un=null),En&&(Hn=Qa(En,Tt,He-sr,He+$r,1,rr.minY,rr.maxY,St),bn=Qa(En,Tt,He+Ar,He+Ur,1,rr.minY,rr.maxY,St),En=null),wt>1&&console.timeEnd("clipping"),ot.push(Vr||[],Se+1,2*Pe,2*He),ot.push(Cn||[],Se+1,2*Pe,2*He+1),ot.push(Hn||[],Se+1,2*Pe+1,2*He),ot.push(bn||[],Se+1,2*Pe+1,2*He+1)}}getTile(ye,Se,Pe){ye=+ye,Se=+Se,Pe=+Pe;const He=this.options,{extent:Ye,debug:at}=He;if(ye<0||ye>24)return null;const gt=1<<ye,ot=Ui(ye,Se=Se+gt&gt-1,Pe);if(this.tiles[ot])return qn(this.tiles[ot],Ye);at>1&&console.log("drilling down to z%d-%d-%d",ye,Se,Pe);let St,wt=ye,Tt=Se,Ft=Pe;for(;!St&&wt>0;)wt--,Tt>>=1,Ft>>=1,St=this.tiles[Ui(wt,Tt,Ft)];return St&&St.source?(at>1&&(console.log("found parent tile z%d-%d-%d",wt,Tt,Ft),console.time("drilling down")),this.splitTile(St.source,wt,Tt,Ft,ye,Se,Pe),at>1&&console.timeEnd("drilling down"),this.tiles[ot]?qn(this.tiles[ot],Ye):null):null}}function Ui(At,ye,Se){return 32*((1<<At)*Se+ye)+At}function Ss(At,ye){const Se=At.tileID.canonical;if(!this._geoJSONIndex)return void ye(null,null);const Pe=this._geoJSONIndex.getTile(Se.z,Se.x,Se.y);if(!Pe)return void ye(null,null);const He=new Qe(Pe.features);let Ye=De(He);Ye.byteOffset===0&&Ye.byteLength===Ye.buffer.byteLength||(Ye=new Uint8Array(Ye)),ye(null,{vectorTile:He,rawData:Ye.buffer})}class us extends Te{constructor(ye,Se,Pe,He,Ye,at){super(ye,Se,Pe,He,Ss,at),Ye&&(this.loadGeoJSON=Ye),this._dynamicIndex=new Oe}loadData(ye,Se){const Pe=ye&&ye.request,He=Pe&&Pe.collectResourceTiming;this.loadGeoJSON(ye,(Ye,at)=>{if(Ye||!at)return Se(Ye);if(typeof at!="object")return Se(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));{try{if(ye.filter){const ot=i.U(ye.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ot.result==="error")throw new Error(ot.value.map(St=>`${St.key}: ${St.message}`).join(", "));at.features=at.features.filter(St=>ot.value.evaluate({zoom:0},St))}ye.dynamic?(at.type==="Feature"&&(at={type:"FeatureCollection",features:[at]}),ye.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(at.features,this.loaded),ye.cluster&&(at.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ye.cluster?new Br(function({superclusterOptions:ot,clusterProperties:St}){if(!St||!ot)return ot;const wt={},Tt={},Ft={accumulated:null,zoom:0},rr={properties:null},sr=Object.keys(St);for(const Ar of sr){const[$r,Ur]=St[Ar],Vr=i.U(Ur),Cn=i.U(typeof $r=="string"?[$r,["accumulated"],["get",Ar]]:$r);wt[Ar]=Vr.value,Tt[Ar]=Cn.value}return ot.map=Ar=>{rr.properties=Ar;const $r={};for(const Ur of sr)$r[Ur]=wt[Ur].evaluate(Ft,rr);return $r},ot.reduce=(Ar,$r)=>{rr.properties=$r;for(const Ur of sr)Ft.accumulated=Ar[Ur],Ar[Ur]=Tt[Ur].evaluate(Ft,rr)},ot}(ye)).load(at.features):ye.dynamic?this._dynamicIndex:function(ot,St){return new Ns(ot,St)}(at,ye.geojsonVtOptions)}catch(ot){return Se(ot)}const gt={};if(He){const ot=_(Pe);ot&&(gt.resourceTiming={},gt.resourceTiming[ye.source]=JSON.parse(JSON.stringify(ot)))}Se(null,gt)}})}reloadTile(ye,Se){const Pe=this.loaded;return Pe&&Pe[ye.uid]?ye.partial?Se(null,void 0):super.reloadTile(ye,Se):this.loadTile(ye,Se)}loadGeoJSON(ye,Se){if(ye.request)i.n(ye.request,Se);else{if(typeof ye.data!="string")return Se(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));try{return Se(null,JSON.parse(ye.data))}catch{return Se(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ye,Se){try{Se(null,this._geoJSONIndex.getClusterExpansionZoom(ye.clusterId))}catch(Pe){Se(Pe)}}getClusterChildren(ye,Se){try{Se(null,this._geoJSONIndex.getChildren(ye.clusterId))}catch(Pe){Se(Pe)}}getClusterLeaves(ye,Se){try{Se(null,this._geoJSONIndex.getLeaves(ye.clusterId,ye.limit,ye.offset))}catch(Pe){Se(Pe)}}}class ju{constructor(ye,Se){this.tileID=new i.aG(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.tileZoom=ye.tileZoom,this.uid=ye.uid,this.zoom=ye.zoom,this.canonical=ye.tileID.canonical,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ye.projection,this.brightness=Se}parse(ye,Se,Pe,He){this.status="parsing";const Ye=new i.aG(Pe.tileID.overscaledZ,Pe.tileID.wrap,Pe.tileID.canonical.z,Pe.tileID.canonical.x,Pe.tileID.canonical.y),at=[],gt=Se.familiesBySource[Pe.source],ot=new i.d$(Ye,Pe.promoteId);return ot.bucketLayerIDs=[],ot.is3DTile=!0,i.ea(ye).then(St=>{if(!St)return He(new Error("Could not parse tile"));const wt=i.eb(St,1/i.cc(Pe.tileID.canonical)),Tt=St.json.extensionsUsed&&St.json.extensionsUsed.includes("MAPBOX_mesh_features")||St.json.asset.extras&&St.json.asset.extras.MAPBOX_mesh_features,Ft=St.json.extensionsUsed&&St.json.extensionsUsed.includes("EXT_meshopt_compression"),rr=new i.a8(this.zoom,{brightness:this.brightness});for(const sr in gt)for(const Ar of gt[sr]){const $r=Ar[0];ot.bucketLayerIDs.push(Ar.map(Vr=>i.aC(Vr.id,Vr.scope))),$r.recalculate(rr,[]);const Ur=new i.ec(Ar,wt,Ye,Tt,Ft,this.brightness,ot);Tt||(Ur.needsUpload=!0),at.push(Ur),Ur.evaluate($r)}this.status="done",He(null,{buckets:at,featureIndex:ot,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(St=>He(new Error(St.message)))}}class Hi{constructor(ye,Se,Pe,He,Ye,at){this.actor=ye,this.layerIndex=Se,this.availableImages=Pe,this.brightness=at,this.loading={},this.loaded={}}loadTile(ye,Se){const Pe=ye.uid,He=this.loading[Pe]=new ju(ye,this.brightness);i.bi(ye.request,(Ye,at)=>{const gt=!this.loading[Pe];return delete this.loading[Pe],gt||Ye?(He.status="done",gt||(this.loaded[Pe]=He),Se(Ye)):at&&at.byteLength!==0?void He.parse(at,this.layerIndex,ye,(ot,St)=>{He.status="done",this.loaded=this.loaded||{},this.loaded[Pe]=He,ot||!St?Se(ot):Se(null,St)}):(He.status="done",this.loaded[Pe]=He,Se())})}reloadTile(ye,Se){const Pe=this.loaded,He=ye.uid;if(Pe&&Pe[He]){const Ye=Pe[He];Ye.projection=ye.projection,Ye.brightness=ye.brightness;const at=(gt,ot)=>{Ye.reloadCallback&&(delete Ye.reloadCallback,this.loadTile(ye,Se)),Se(gt,ot)};Ye.status==="parsing"?Ye.reloadCallback=at:Ye.status==="done"&&this.loadTile(ye,Se)}}abortTile(ye,Se){const Pe=ye.uid;this.loading[Pe]&&delete this.loading[Pe],Se()}removeTile(ye,Se){const Pe=this.loaded,He=ye.uid;Pe&&Pe[He]&&delete Pe[He],Se()}}class zo{constructor(ye){this.self=ye,this.actor=new i.ed(ye,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:Te,geojson:us,"batched-model":Hi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Se,Pe)=>{if(this.workerSourceTypes[Se])throw new Error(`Worker source with name "${Se}" already registered.`);this.workerSourceTypes[Se]=Pe},this.self.registerRTLTextPlugin=Se=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=Se.applyArabicShaping,i.ee.processBidirectionalText=Se.processBidirectionalText,i.ee.processStyledBidirectionalText=Se.processStyledBidirectionalText}}clearCaches(ye,Se,Pe){delete this.layerIndexes[ye],delete this.availableImages[ye],delete this.workerSources[ye],delete this.demWorkerSources[ye],delete this.rasterArrayWorkerSource,Pe()}checkIfReady(ye,Se,Pe){Pe()}setReferrer(ye,Se){this.referrer=Se}spriteLoaded(ye,{scope:Se,isLoaded:Pe}){if(this.isSpriteLoaded[ye]||(this.isSpriteLoaded[ye]={}),this.isSpriteLoaded[ye][Se]=Pe,this.workerSources[ye]&&this.workerSources[ye][Se])for(const He in this.workerSources[ye][Se]){const Ye=this.workerSources[ye][Se][He];for(const at in Ye){const gt=Ye[at];gt instanceof Te&&(gt.isSpriteLoaded=Pe,gt.fire(new i.z("isSpriteLoaded")))}}}setImages(ye,{scope:Se,images:Pe},He){if(this.availableImages[ye]||(this.availableImages[ye]={}),this.availableImages[ye][Se]=Pe,this.workerSources[ye]&&this.workerSources[ye][Se]){for(const Ye in this.workerSources[ye][Se]){const at=this.workerSources[ye][Se][Ye];for(const gt in at)at[gt].availableImages=Pe}He()}else He()}setProjection(ye,Se){this.projections[ye]=i.bP(Se)}setBrightness(ye,Se,Pe){this.brightness=Se,Pe()}setLayers(ye,Se,Pe){this.getLayerIndex(ye,Se.scope).replace(Se.layers,Se.options),Pe()}updateLayers(ye,Se,Pe){this.getLayerIndex(ye,Se.scope).update(Se.layers,Se.removedIds,Se.options),Pe()}loadTile(ye,Se,Pe){Se.projection=this.projections[ye]||this.defaultProjection,this.getWorkerSource(ye,Se.type,Se.source,Se.scope).loadTile(Se,Pe)}loadDEMTile(ye,Se,Pe){this.getDEMWorkerSource(ye,Se.source,Se.scope).loadTile(Se,Pe)}decodeRasterArray(ye,Se,Pe){this.getRasterArrayWorkerSource().decodeRasterArray(Se,Pe)}reloadTile(ye,Se,Pe){Se.projection=this.projections[ye]||this.defaultProjection,this.getWorkerSource(ye,Se.type,Se.source,Se.scope).reloadTile(Se,Pe)}abortTile(ye,Se,Pe){this.getWorkerSource(ye,Se.type,Se.source,Se.scope).abortTile(Se,Pe)}removeTile(ye,Se,Pe){this.getWorkerSource(ye,Se.type,Se.source,Se.scope).removeTile(Se,Pe)}removeSource(ye,Se,Pe){if(!(this.workerSources[ye]&&this.workerSources[ye][Se.scope]&&this.workerSources[ye][Se.scope][Se.type]&&this.workerSources[ye][Se.scope][Se.type][Se.source]))return;const He=this.workerSources[ye][Se.scope][Se.type][Se.source];delete this.workerSources[ye][Se.scope][Se.type][Se.source],He.removeSource!==void 0?He.removeSource(Se,Pe):Pe()}loadWorkerSource(ye,Se,Pe){try{this.self.importScripts(Se.url),Pe()}catch(He){Pe(He.toString())}}syncRTLPluginState(ye,Se,Pe){try{i.ee.setState(Se);const He=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&He!=null){this.self.importScripts(He);const Ye=i.ee.isParsed();Pe(Ye?void 0:new Error(`RTL Text Plugin failed to import scripts from ${He}`),Ye)}}catch(He){Pe(He.toString())}}setDracoUrl(ye,Se){this.dracoUrl=Se}getAvailableImages(ye,Se){this.availableImages[ye]||(this.availableImages[ye]={});let Pe=this.availableImages[ye][Se];return Pe||(Pe=[]),Pe}getLayerIndex(ye,Se){this.layerIndexes[ye]||(this.layerIndexes[ye]={});let Pe=this.layerIndexes[ye][Se];return Pe||(Pe=this.layerIndexes[ye][Se]=new E,Pe.scope=Se),Pe}getWorkerSource(ye,Se,Pe,He){return this.workerSources[ye]||(this.workerSources[ye]={}),this.workerSources[ye][He]||(this.workerSources[ye][He]={}),this.workerSources[ye][He][Se]||(this.workerSources[ye][He][Se]={}),this.isSpriteLoaded[ye]||(this.isSpriteLoaded[ye]={}),this.workerSources[ye][He][Se][Pe]||(this.workerSources[ye][He][Se][Pe]=new this.workerSourceTypes[Se]({send:(Ye,at,gt,ot,St,wt)=>{this.actor.send(Ye,at,gt,ye,St,wt)},scheduler:this.actor.scheduler},this.getLayerIndex(ye,He),this.getAvailableImages(ye,He),this.isSpriteLoaded[ye][He],void 0,this.brightness)),this.workerSources[ye][He][Se][Pe]}rasterizeImages(ye,Se,Pe){const{imageTasks:He,scope:Ye}=Se,at={};for(const gt in He){const{image:ot,imageIdWithOptions:St}=He[gt];at[gt]=this.imageRasterizer.rasterize(St,ot,Ye,ye)}Pe(void 0,at)}removeRasterizedImages(ye,Se,Pe){const{imageIds:He,scope:Ye}=Se;this.imageRasterizer.removeImagesFromCacheByIds(He,Ye,ye),Pe()}getDEMWorkerSource(ye,Se,Pe){return this.demWorkerSources[ye]||(this.demWorkerSources[ye]={}),this.demWorkerSources[ye][Pe]||(this.demWorkerSources[ye][Pe]={}),this.demWorkerSources[ye][Pe][Se]||(this.demWorkerSources[ye][Pe][Se]=new Ae),this.demWorkerSources[ye][Pe][Se]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new _e),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ye,Se){i.ef(Se)}getWorkerPerformanceMetrics(ye,Se,Pe){Pe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new zo(self)),zo}),l(["./shared"],function(i){var _="3.10.0";const w={create:"create",load:"load",fullLoad:"fullLoad"},A={mark(g){performance.mark(g)},measure(g,o,d){performance.measure(g,o,d)}};function E(g){const o=g.name.split("?")[0];return i.a(o)&&o.includes("mapbox-gl.js")?"javascript":i.a(o)&&o.includes("mapbox-gl.css")?"css":i.b(o)?"fontRange":i.c(o)?"sprite":i.i(o)?"style":i.d(o)?"tilejson":"other"}var O,F={},U=function(){if(O)return F;function g(y){return!o(y)}function o(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var P,M,D=new Blob([""],{type:"text/javascript"}),G=URL.createObjectURL(D);try{M=new Worker(G),P=!0}catch{P=!1}return M&&M.terminate(),URL.revokeObjectURL(G),P}()?function(){var P=document.createElement("canvas");P.width=P.height=1;var M=P.getContext("2d");if(!M)return!1;var D=M.getImageData(0,0,1,1);return D&&D.width===P.width}()?(d[S=y&&y.failIfMajorPerformanceCaveat]===void 0&&(d[S]=function(P){var M,D=function(G){var K=document.createElement("canvas"),Y=Object.create(g.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=G,K.getContext("webgl2",Y)}(P);if(!D)return!1;try{M=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!M||D.isContextLost())&&(D.shaderSource(M,"void main() {}"),D.compileShader(M),D.getShaderParameter(M,D.COMPILE_STATUS)===!0)}(S)),d[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}O=1,F.supported=g,F.notSupportedReason=o;var d={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},F}();function B(g,o,d){const y=document.createElement(g);return o!=null&&(y.className=o),d&&d.appendChild(y),y}function q(g,o,d){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const S of Object.keys(o))y.setAttributeNS(null,S,String(o[S]));return d&&d.appendChild(y),y}const W=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Z=W&&W.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ne;function ae(){W&&Z&&(ne=W[Z],W[Z]="none")}function ee(){W&&Z&&(W[Z]=ne)}function se(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",se,!0)}function ce(){window.addEventListener("click",se,!0),window.setTimeout(()=>{window.removeEventListener("click",se,!0)},0)}function ge(g,o){const d=g.getBoundingClientRect();return _e(g,d,o)}function Te(g,o){const d=g.getBoundingClientRect(),y=[];for(let S=0;S<o.length;S++)y.push(_e(g,d,o[S]));return y}function Ae(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function _e(g,o,d){const y=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new i.P((d.clientX-o.left)*y,(d.clientY-o.top)*y)}const Ee="01",ke="NO_ACCESS_TOKEN";class Qe{constructor(o,d,y){this._transformRequestFn=o,this._customAccessToken=d,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const o=function(){let d="";for(let y=0;y<10;y++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ee,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeStyleURL(o,d){if(!i.f(o))return o;const y=Ge(o);return y.params.push(`sdk=js-${_}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeGlyphsURL(o,d){if(!i.f(o))return o;const y=Ge(o);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeModelURL(o,d){if(!i.f(o))return o;const y=Ge(o);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeSourceURL(o,d,y,S){if(!i.f(o))return o;const P=Ge(o);return P.path=`/v4/${P.authority}.json`,P.params.push("secure"),y&&P.params.push(`language=${y}`),S&&P.params.push(`worldview=${S}`),this._makeAPIURL(P,this._customAccessToken||d)}normalizeIconsetURL(o,d){const y=Ge(o);return i.f(o)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||d)):Oe(y)}normalizeSpriteURL(o,d,y,S){const P=Ge(o);return i.f(o)?(P.path=`/styles/v1${P.path}/sprite${d}${y}`,this._makeAPIURL(P,this._customAccessToken||S)):(P.path+=`${d}${y}`,Oe(P))}normalizeTileURL(o,d,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!i.f(o))return o;const S=Ge(o);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${d||y&&S.authority!=="raster"&&y===512?"@2x":""}${i.m.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${i.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${i.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${i.e.TILE_URL_VERSION}${S.path}`);const P=this._customAccessToken||function(M){for(const D of M){const G=D.match(/^access_token=(.*)$/);if(G)return G[1]}return null}(S.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&P&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,P)}canonicalizeTileURL(o,d){const y=Ge(o);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return o;let S="mapbox://";y.path.match(/^\/raster\/v1\//)?S+=`raster/${y.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${y.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${y.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let P=y.params;return d&&(P=P.filter(M=>!M.match(/^access_token=/))),P.length&&(S+=`?${P.join("&")}`),S}canonicalizeTileset(o,d){const y=!!d&&i.f(d),S=[];for(const P of o.tiles||[])i.h(P)?S.push(this.canonicalizeTileURL(P,y)):S.push(P);return S}_makeAPIURL(o,d){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=Ge(i.e.API_URL);if(o.protocol=S.protocol,o.authority=S.authority,o.protocol==="http"){const P=o.params.indexOf("secure");P>=0&&o.params.splice(P,1)}if(S.path!=="/"&&(o.path=`${S.path}${o.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Oe(o);if(d=d||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!d)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(d[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return o.params=o.params.filter(P=>P.indexOf("access_token")===-1),o.params.push(`access_token=${d||""}`),Oe(o)}}const Ze=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ge(g){const o=g.match(Ze);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Oe(g){const o=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${o}`}const je="mapbox.eventData";function Le(g){if(!g)return null;const o=g.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(i.j(o[1]))}catch{return null}}class ut{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const d=Le(i.e.ACCESS_TOKEN);let y="";return y=d&&d.u?i.k(d.u):i.e.ACCESS_TOKEN||"",o?`${je}.${o}:${y}`:`${je}:${y}`}fetchEventData(){const o=i.s("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(o)try{const S=localStorage.getItem(d);S&&(this.eventData=JSON.parse(S));const P=localStorage.getItem(y);P&&(this.anonId=P)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const o=i.s("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid"),S=this.anonId;if(o&&S)try{localStorage.setItem(y,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,d,y,S){if(!i.e.EVENTS_URL)return;const P=Ge(i.e.EVENTS_URL);P.params.push(`access_token=${S||i.e.ACCESS_TOKEN||""}`);const M={event:this.type,created:new Date(o).toISOString()},D=d?i.l(M,d):M,G={url:Oe(P),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=i.p(G,K=>{this.pendingRequest=null,y(K),this.saveEventData(),this.processRequests(S)})}queueRequest(o,d){this.queue.push(o),this.processRequests(d)}}const ze=new class extends ut{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,o){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(d=>i.f(d)||i.h(d))&&this.queueRequest(Date.now(),o)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Le(i.e.ACCESS_TOKEN),d=o?o.u:i.e.ACCESS_TOKEN;let y=d!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),y=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const P=new Date(this.eventData.lastSuccess),M=new Date(S),D=(S-this.eventData.lastSuccess)/864e5;y=y||D>=1||D<-1||P.getDate()!==M.getDate()}else y=!0;y?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:Ee,"enabled.telemetry":!1,userId:this.anonId},P=>{P||(this.eventData.lastSuccess=S,this.eventData.tokenU=d)},g):this.processRequests()}},ht=ze.postTurnstileEvent.bind(ze),rt=new class extends ut{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,o,d,y){this.skuToken=o,this.errorCb=y,i.e.EVENTS_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(ke)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:d}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:Ee,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},g))}remove(){this.errorCb=null}},Qt=rt.postMapLoadEvent.bind(rt),Cr=new class extends ut{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let o=this.mapInstanceIdMap.get(g);return o||(o=i.u(),this.mapInstanceIdMap.set(g,o)),o}getEventId(g){const o=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,o+1),o}postStyleLoadEvent(g,o){const{map:d,style:y,importedStyles:S}=o;if(!i.e.EVENTS_URL||!g&&!i.e.ACCESS_TOKEN)return;const P=this.getMapInstanceId(d),M={mapInstanceId:P,eventId:this.getEventId(P),style:y};S.length&&(M.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:M},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:d}=this.queue.shift();this.postEvent(o,d,()=>{},g)}},vr=Cr.postStyleLoadEvent.bind(Cr),cr=new class extends ut{constructor(){super("gljs.performance")}postPerformanceEvent(g,o){i.e.EVENTS_URL&&(g||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:d}=this.queue.shift(),y=function(S){const P=performance.getEntriesByType("resource"),M=performance.getEntriesByType("mark"),D=function(oe){const ve={};if(oe){for(const fe in oe)if(fe!=="other")for(const be of oe[fe]){const xe=`${fe}ResolveRangeMin`,Ce=`${fe}ResolveRangeMax`,Ue=`${fe}RequestCount`,Be=`${fe}RequestCachedCount`;ve[xe]=Math.min(ve[xe]||1/0,be.startTime),ve[Ce]=Math.max(ve[Ce]||-1/0,be.responseEnd);const Xe=qe=>{ve[qe]===void 0&&(ve[qe]=0),++ve[qe]};be.transferSize!==void 0&&be.transferSize===0&&Xe(Be),Xe(Ue)}}return ve}(function(oe,ve){const fe={};if(oe)for(const be of oe){const xe=ve(be);fe[xe]===void 0&&(fe[xe]=[]),fe[xe].push(be)}return fe}(P,E)),G=window.devicePixelRatio,K=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Y=K?K.effectiveType:void 0,te={counters:[],metadata:[],attributes:[]},re=(oe,ve,fe)=>{fe!=null&&oe.push({name:ve,value:fe.toString()})};for(const oe in D)re(te.counters,oe,D[oe]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(re(te.counters,"interactionRangeMin",S.interactionRange[0]),re(te.counters,"interactionRangeMax",S.interactionRange[1])),M)for(const oe of Object.keys(w)){const ve=w[oe],fe=M.find(be=>be.name===ve);fe&&re(te.counters,ve,fe.startTime)}return re(te.counters,"visibilityHidden",S.visibilityHidden),re(te.attributes,"style",function(oe){if(oe)for(const ve of oe){const fe=ve.name.split("?")[0];if(i.i(fe)){const be=fe.split("/").slice(-2);if(be.length===2)return`mapbox://styles/${be[0]}/${be[1]}`}}}(P)),re(te.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),re(te.attributes,"fogEnabled",S.fogEnabled?"true":"false"),re(te.attributes,"projection",S.projection),re(te.attributes,"zoom",S.zoom),re(te.metadata,"devicePixelRatio",G),re(te.metadata,"connectionEffectiveType",Y),re(te.metadata,"navigatorUserAgent",navigator.userAgent),re(te.metadata,"screenWidth",window.screen.width),re(te.metadata,"screenHeight",window.screen.height),re(te.metadata,"windowWidth",window.innerWidth),re(te.metadata,"windowHeight",window.innerHeight),re(te.metadata,"mapWidth",S.width/G),re(te.metadata,"mapHeight",S.height/G),re(te.metadata,"webglRenderer",S.renderer),re(te.metadata,"webglVendor",S.vendor),re(te.metadata,"sdkVersion",_),re(te.metadata,"sdkIdentifier","mapbox-gl-js"),te}(d);for(const S of y.metadata);for(const S of y.counters);for(const S of y.attributes);this.postEvent(o,y,()=>{},g)}},nr=cr.postPerformanceEvent.bind(cr),Kt=new class extends ut{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,o,d,y){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const S=Ge(i.e.API_URL+i.e.SESSION_PATH);S.params.push(`sku=${o||""}`),S.params.push(`access_token=${y||i.e.ACCESS_TOKEN||""}`);const P={url:Oe(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(P,M=>{this.pendingRequest=null,d(M),this.saveEventData(),this.processRequests(y)})}getSessionAPI(g,o,d,y){this.skuToken=o,this.errorCb=y,i.e.SESSION_PATH&&i.e.API_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(ke)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:d}=this.queue.shift();o&&this.success[o]||this.getSession(d,this.skuToken,y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},g)}remove(){this.errorCb=null}},De=Kt.getSessionAPI.bind(Kt),er=new Set;function Lt(g,o){o?er.add(g):er.delete(g)}class Rr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,d){this._updatedSourceCaches[o]=d,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const d=o.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(o.id),this.setDirty()}removeLayer(o){const d=o.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][o.id]=o,this._updatedLayers[d].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const d in this._updatedLayers)o[d]=o[d]||{},o[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)o[d]=o[d]||{},o[d].removedIds=Object.keys(this._removedLayers[d]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(o){this._updatedImages.add(o),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Pt(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class nn extends i.E{constructor(o){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=o,o!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(o){this.images[o]={},this.loaded[o]=!1,this.updatedImages[o]={},this.patterns[o]={},this.callbackDispatchedThisFrame[o]={},this.atlasImage[o]=new i.r({width:1,height:1})}isLoaded(){for(const o in this.loaded)if(!this.loaded[o])return!1;return!0}setLoaded(o,d){if(this.loaded[d]!==o&&(this.loaded[d]=o,o)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,d,S);this.requestors=[]}}hasImage(o,d){return!!this.getImage(o,d)}getImage(o,d){return this.images[d][o]}addImage(o,d,y){this._validate(o,y)&&(this.images[d][o]=y)}_validate(o,d){let y=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new i.y(new Error(`Image "${o}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new i.y(new Error(`Image "${o}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new i.y(new Error(`Image "${o}" has invalid "content" value`))),y=!1),y}_validateStretch(o,d){if(!o)return!0;let y=0;for(const S of o){if(S[0]<y||S[1]<S[0]||d<S[1])return!1;y=S[1]}return!0}_validateContent(o,d){return o?o.length!==4||!d.usvg&&(o[0]<0||d.data.width<o[0]||o[1]<0||d.data.height<o[1]||o[2]<0||d.data.width<o[2]||o[3]<0||d.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,d,y){y.version=this.images[d][o].version+1,this.images[d][o]=y,this.updatedImages[d][o]=!0,this.removeFromImageRasterizerCache(o,d)}removeFromImageRasterizerCache(o,d){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:d}):this.imageRasterizer.removeImagesFromCacheByIds([o],d))}removeImage(o,d){const y=this.images[d][o];delete this.images[d][o],delete this.patterns[d][o],this.removeFromImageRasterizerCache(o,d),y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(o){return Object.keys(this.images[o])}getImages(o,d,y){let S=!0;const P=!!this.loaded[d];if(!P)for(const M of o)this.images[d][M]||(S=!1);P||S?this._notify(o,d,y):this.requestors.push({ids:o,scope:d,callback:y})}rasterizeImages({scope:o,imageTasks:d},y){const S={};for(const P in d){const M=d[P],D=this.getImage(M.id,o);D&&(S[P]={image:D,imageIdWithOptions:M})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:S,scope:o},y):this.rasterizeImagesInMainThread({imageTasks:S,scope:o},y)}rasterizeImagesInMainThread(o,d){const{imageTasks:y,scope:S}=o,P={};for(const M in y){const{image:D,imageIdWithOptions:G}=y[M];P[M]=this.imageRasterizer.rasterize(G,D,S,"")}d(void 0,P)}getUpdatedImages(o){return this.updatedImages[o]}_notify(o,d,y){const S={};for(const P of o){this.images[d][P]||this.fire(new i.z("styleimagemissing",{id:P}));const M=this.images[d][P];M?S[P]={data:M.usvg?null:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,usvg:M.usvg,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!!(M.userImage&&M.userImage.render)}:i.w(`Image "${P}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,S)}getPixelSize(o){const{width:d,height:y}=this.atlasImage[o];return{width:d,height:y}}getPattern(o,d,y){const S=this.patterns[d][o],P=this.getImage(o,d);if(!P)return null;if(S&&S.position.version===P.version)return S.position;if(S)S.position.version=P.version;else{P.usvg&&!P.data&&(P.data=this.imageRasterizer.rasterize(i.A.from(o).getPrimary(),P,d,""));const M={w:P.data.width+2*i.B,h:P.data.height+2*i.B,x:0,y:0},D=new i.C(M,P,i.B);this.patterns[d][o]={bin:M,position:D}}return this._updatePatternAtlas(d,y),this.patterns[d][o].position}bind(o,d){const y=o.gl;let S=this.atlasTexture[d];S?this.dirty&&(S.update(this.atlasImage[d]),this.dirty=!1):(S=new i.T(o,this.atlasImage[d],y.RGBA8),this.atlasTexture[d]=S),S.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(o,d){const y=[];for(const D in this.patterns[o])y.push(this.patterns[o][D].bin);const{w:S,h:P}=i.F(y),M=this.atlasImage[o];M.resize({width:S||1,height:P||1});for(const D in this.patterns[o]){const{bin:G,position:K}=this.patterns[o][D];let Y=K.padding;const te=G.x+Y,re=G.y+Y,oe=this.images[o][D].data,ve=oe.width,fe=oe.height;Y=Y>1?Y-1:Y,i.r.copy(oe,M,{x:0,y:0},{x:te,y:re},{width:ve,height:fe},d),i.r.copy(oe,M,{x:0,y:fe-Y},{x:te,y:re-Y},{width:ve,height:Y},d),i.r.copy(oe,M,{x:0,y:0},{x:te,y:re+fe},{width:ve,height:Y},d),i.r.copy(oe,M,{x:ve-Y,y:0},{x:te-Y,y:re},{width:Y,height:fe},d),i.r.copy(oe,M,{x:0,y:0},{x:te+ve,y:re},{width:Y,height:fe},d),i.r.copy(oe,M,{x:ve-Y,y:fe-Y},{x:te-Y,y:re-Y},{width:Y,height:Y},d),i.r.copy(oe,M,{x:0,y:fe-Y},{x:te+ve,y:re-Y},{width:Y,height:Y},d),i.r.copy(oe,M,{x:0,y:0},{x:te+ve,y:re+fe},{width:Y,height:Y},d),i.r.copy(oe,M,{x:ve-Y,y:0},{x:te-Y,y:re+fe},{width:Y,height:Y},d)}this.dirty=!0}beginFrame(){for(const o in this.images)this.callbackDispatchedThisFrame[o]={}}dispatchRenderCallbacks(o,d){for(const y of o){if(this.callbackDispatchedThisFrame[d][y])continue;this.callbackDispatchedThisFrame[d][y]=!0;const S=this.images[d][y];Pt(S)&&this.updateImage(y,d,S)}}}function Sn(g){const o=g.key,d=g.value,y=g.valueSpec||{},S=g.objectElementValidators||{},P=g.style,M=g.styleSpec;let D=[];const G=i.H(d);if(G!=="object")return[new i.V(o,d,`object expected, ${G} found`)];for(const K in d){const Y=K.split(".")[0];let te;S[Y]?te=S[Y]:y[Y]?te=an:S["*"]?te=S["*"]:y["*"]&&(te=an),te?D=D.concat(te({key:(o&&`${o}.`)+K,value:d[K],valueSpec:y[Y]||y["*"],style:P,styleSpec:M,object:d,objectKey:K},d)):D.push(new i.G(o,d[K],`unknown property "${K}"`))}for(const K in y)S[K]||y[K].required&&y[K].default===void 0&&d[K]===void 0&&D.push(new i.V(o,d,`missing required property "${K}"`));return D}function Br(g){const o=g.value,d=g.valueSpec,y=g.style,S=g.styleSpec,P=g.key,M=g.arrayElementValidator||an;if(i.H(o)!=="array")return[new i.V(P,o,`array expected, ${i.H(o)} found`)];if(d.length&&o.length!==d.length)return[new i.V(P,o,`array length ${d.length} expected, length ${o.length} found`)];if(d["min-length"]&&o.length<d["min-length"])return[new i.V(P,o,`array length at least ${d["min-length"]} expected, length ${o.length} found`)];let D={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};S.$version<7&&(D.function=d.function),i.H(d.value)==="object"&&(D=d.value);let G=[];for(let K=0;K<o.length;K++)G=G.concat(M({array:o,arrayIndex:K,value:o[K],valueSpec:D,style:y,styleSpec:S,key:`${P}[${K}]`},!0));return G}function et(g){const o=g.key,d=g.value,y=g.valueSpec;let S=i.H(d);if(S==="number"&&d!=d&&(S="NaN"),S!=="number")return[new i.V(o,d,`number expected, ${S} found`)];if("minimum"in y){let P=y.minimum;if(i.H(y.minimum)==="array"&&(P=y.minimum[g.arrayIndex]),d<P)return[new i.V(o,d,`${d} is less than the minimum value ${P}`)]}if("maximum"in y){let P=y.maximum;if(i.H(y.maximum)==="array"&&(P=y.maximum[g.arrayIndex]),d>P)return[new i.V(o,d,`${d} is greater than the maximum value ${P}`)]}return[]}function bt(g){const o=g.valueSpec,d=i.K(g.value.type);let y,S,P,M={};const D=d!=="categorical"&&g.value.property===void 0,G=!D,K=i.H(g.value.stops)==="array"&&i.H(g.value.stops[0])==="array"&&i.H(g.value.stops[0][0])==="object",Y=Sn({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(oe){if(d==="identity")return[new i.V(oe.key,oe.value,'identity function may not have a "stops" property')];let ve=[];const fe=oe.value;return ve=ve.concat(Br({key:oe.key,value:fe,valueSpec:oe.valueSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:te})),i.H(fe)==="array"&&fe.length===0&&ve.push(new i.V(oe.key,fe,"array must have at least one stop")),ve},default:function(oe){return an({key:oe.key,value:oe.value,valueSpec:o,style:oe.style,styleSpec:oe.styleSpec})}}});return d==="identity"&&D&&Y.push(new i.V(g.key,g.value,'missing required property "property"')),d==="identity"||g.value.stops||Y.push(new i.V(g.key,g.value,'missing required property "stops"')),d==="exponential"&&g.valueSpec.expression&&!i.L(g.valueSpec)&&Y.push(new i.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(G&&!i.M(g.valueSpec)?Y.push(new i.V(g.key,g.value,"property functions not supported")):D&&!i.N(g.valueSpec)&&Y.push(new i.V(g.key,g.value,"zoom functions not supported"))),d!=="categorical"&&!K||g.value.property!==void 0||Y.push(new i.V(g.key,g.value,'"property" property is required')),Y;function te(oe){let ve=[];const fe=oe.value,be=oe.key;if(i.H(fe)!=="array")return[new i.V(be,fe,`array expected, ${i.H(fe)} found`)];if(fe.length!==2)return[new i.V(be,fe,`array length 2 expected, length ${fe.length} found`)];if(K){if(i.H(fe[0])!=="object")return[new i.V(be,fe,`object expected, ${i.H(fe[0])} found`)];if(fe[0].zoom===void 0)return[new i.V(be,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new i.V(be,fe,"object stop key must have value")];const xe=i.K(fe[0].zoom);if(typeof xe!="number")return[new i.V(be,fe[0].zoom,"stop zoom values must be numbers")];if(P&&P>xe)return[new i.V(be,fe[0].zoom,"stop zoom values must appear in ascending order")];xe!==P&&(P=xe,S=void 0,M={}),ve=ve.concat(Sn({key:`${be}[0]`,value:fe[0],valueSpec:{zoom:{}},style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:et,value:re}}))}else ve=ve.concat(re({key:`${be}[0]`,value:fe[0],style:oe.style,styleSpec:oe.styleSpec},fe));return i.O(i.Q(fe[1]))?ve.concat([new i.V(`${be}[1]`,fe[1],"expressions are not allowed in function stops.")]):ve.concat(an({key:`${be}[1]`,value:fe[1],valueSpec:o,style:oe.style,styleSpec:oe.styleSpec}))}function re(oe,ve){const fe=i.H(oe.value),be=i.K(oe.value),xe=oe.value!==null?oe.value:ve;if(y){if(fe!==y)return[new i.V(oe.key,xe,`${fe} stop domain type must match previous stop domain type ${y}`)]}else y=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean"&&typeof be!="number"&&typeof be!="string"&&typeof be!="boolean")return[new i.V(oe.key,xe,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&d!=="categorical"){let Ce=`number expected, ${fe} found`;return i.M(o)&&d===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(oe.key,xe,Ce)]}return d!=="categorical"||fe!=="number"||typeof be=="number"&&isFinite(be)&&Math.floor(be)===be?d!=="categorical"&&fe==="number"&&typeof be=="number"&&typeof S=="number"&&S!==void 0&&be<S?[new i.V(oe.key,xe,"stop domain values must appear in ascending order")]:(S=be,d==="categorical"&&be in M?[new i.V(oe.key,xe,"stop domain values must be unique")]:(M[be]=!0,[])):[new i.V(oe.key,xe,`integer expected, found ${String(be)}`)]}}function zt(g){const o=(g.expressionContext==="property"?i.S:i.U)(i.Q(g.value),g.valueSpec);if(o.result==="error")return o.value.map(y=>new i.V(`${g.key}${y.key}`,g.value,y.message));const d=o.value.expression||o.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!d.outputDefined())return[new i.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!i.W(d))return[new i.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return xr(d,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!i.X(d,["zoom","feature-state"]))return[new i.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!i.Y(d))return[new i.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xr(g,o){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const S of o.valueSpec.expression.parameters)d.delete(S);if(d.size===0)return[];const y=[];return g instanceof i.Z&&d.has(g.name)?[new i.V(o.key,o.value,`["${g.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(g.eachChild(S=>{y.push(...xr(S,o))}),y)}function fr(g){const o=g.key,d=g.value,y=g.valueSpec,S=[];return Array.isArray(y.values)?y.values.indexOf(i.K(d))===-1&&S.push(new i.V(o,d,`expected one of [${y.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(y.values).indexOf(i.K(d))===-1&&S.push(new i.V(o,d,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(d)} found`)),S}function pr(g){return i.$(i.Q(g.value))?zt(i.J({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):ar(g)}function ar(g){const o=g.value,d=g.key;if(i.H(o)!=="array")return[new i.V(d,o,`array expected, ${i.H(o)} found`)];const y=g.styleSpec;let S,P=[];if(o.length<1)return[new i.V(d,o,"filter array must have at least 1 element")];switch(P=P.concat(fr({key:`${d}[0]`,value:o[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),i.K(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&i.K(o[1])==="$type"&&P.push(new i.V(d,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&P.push(new i.V(d,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(S=i.H(o[1]),S!=="string"&&P.push(new i.V(`${d}[1]`,o[1],`string expected, ${S} found`)));for(let M=2;M<o.length;M++)S=i.H(o[M]),i.K(o[1])==="$type"?P=P.concat(fr({key:`${d}[${M}]`,value:o[M],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&P.push(new i.V(`${d}[${M}]`,o[M],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let M=1;M<o.length;M++)P=P.concat(ar({key:`${d}[${M}]`,value:o[M],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":S=i.H(o[1]),o.length!==2?P.push(new i.V(d,o,`filter array for "${o[0]}" operator must have 2 elements`)):S!=="string"&&P.push(new i.V(`${d}[1]`,o[1],`string expected, ${S} found`))}return P}function tn(g,o){const d=g.key,y=g.style,S=g.layer,P=g.styleSpec,M=g.value,D=g.objectKey,G=P[`${o}_${g.layerType}`];if(!G)return[];const K=D.match(/^(.*)-use-theme$/);if(o==="paint"&&K&&G[K[1]])return i.O(M)?[].concat(an({key:g.key,value:M,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:P,expressionContext:"property",propertyType:o,propertyKey:D})):an({key:d,value:M,valueSpec:{type:"string"},style:y,styleSpec:P});const Y=D.match(/^(.*)-transition$/);if(o==="paint"&&Y&&G[Y[1]]&&G[Y[1]].transition)return an({key:d,value:M,valueSpec:P.transition,style:y,styleSpec:P});const te=g.valueSpec||G[D];if(!te)return[new i.G(d,M,`unknown property "${D}"`)];let re;if(i.H(M)==="string"&&i.M(te)&&!te.tokens&&(re=/^{([^}]+)}$/.exec(M))){const ve=`\`{ "type": "identity", "property": ${re?JSON.stringify(re[1]):'"_"'} }\``;return[new i.V(d,M,`"${D}" does not support interpolation syntax
Use an identity property function instead: ${ve}.`)]}const oe=[];if(g.layerType==="symbol")D!=="text-field"||!y||y.glyphs||y.imports||oe.push(new i.V(d,M,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&i.a0(i.Q(M))&&i.K(M.type)==="identity"&&oe.push(new i.V(d,M,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&o==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&i.M(te)&&(i.a1(te)||i.N(te))){const ve=i.S(i.Q(M),te),fe=ve.value.expression||ve.value._styleExpression.expression;fe&&!i.X(fe,["measure-light"])&&(D==="model-emissive-strength"&&i.Y(fe)&&i.W(fe)||oe.push(new i.V(d,M,`${D} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return oe.concat(an({key:g.key,value:M,valueSpec:te,style:y,styleSpec:P,expressionContext:"property",propertyType:o,propertyKey:D}))}function Xn(g){return tn(g,"paint")}function Bi(g){return tn(g,"layout")}function Vi(g){let o=[];const d=g.value,y=g.key,S=g.style,P=g.styleSpec;d.type||d.ref||o.push(new i.V(y,d,'either "type" or "ref" is required'));let M=i.K(d.type);const D=i.K(d.ref);if(d.id){const G=i.K(d.id);for(let K=0;K<g.arrayIndex;K++){const Y=S.layers[K];i.K(Y.id)===G&&o.push(new i.V(y,d.id,`duplicate layer id "${d.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in d){let G;["type","source","source-layer","filter","layout"].forEach(K=>{K in d&&o.push(new i.V(y,d[K],`"${K}" is prohibited for ref layers`))}),S.layers.forEach(K=>{i.K(K.id)===D&&(G=K)}),G?G.ref?o.push(new i.V(y,d.ref,"ref cannot reference another ref layer")):M=i.K(G.type):typeof D=="string"&&o.push(new i.V(y,d.ref,`ref layer "${D}" not found`))}else if(M!=="background"&&M!=="sky"&&M!=="slot")if(d.source){const G=S.sources&&S.sources[d.source],K=G&&i.K(G.type);G?K==="vector"&&M==="raster"?o.push(new i.V(y,d.source,`layer "${d.id}" requires a raster source`)):K==="raster"&&M!=="raster"?o.push(new i.V(y,d.source,`layer "${d.id}" requires a vector source`)):K!=="vector"||d["source-layer"]?K==="raster-dem"&&M!=="hillshade"?o.push(new i.V(y,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):K!=="raster-array"||["raster","raster-particle"].includes(M)?M!=="line"||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||K==="geojson"&&G.lineMetrics?M==="raster-particle"&&K!=="raster-array"&&o.push(new i.V(y,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):o.push(new i.V(y,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new i.V(y,d.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new i.V(y,d,`layer "${d.id}" must specify a "source-layer"`)):o.push(new i.V(y,d.source,`source "${d.source}" not found`))}else o.push(new i.V(y,d,'missing required property "source"'));return o=o.concat(Sn({key:y,value:d,valueSpec:P.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>an({key:`${y}.type`,value:d.type,valueSpec:P.layer.type,style:g.style,styleSpec:g.styleSpec,object:d,objectKey:"type"}),filter:G=>pr(i.J({layerType:M},G)),layout:G=>Sn({layer:d,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":K=>Bi(i.J({layerType:M},K))}}),paint:G=>Sn({layer:d,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":K=>Xn(i.J({layerType:M,layer:d},K))}})}})),o}function io(g){const o=g.value,d=g.key,y=i.H(o);return y!=="string"?[new i.V(d,o,`string expected, ${y} found`)]:[]}const Va={promoteId:function g({key:o,value:d}){if(i.H(d)==="string")return io({key:o,value:d});if(Array.isArray(d)){const y=[],S=i.Q(d),P=i.U(S);return P.result==="error"&&P.value.forEach(M=>{y.push(new i.V(`${o}${M.key}`,null,`${M.message}`))}),i.X(P.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new i.V(`${o}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const S in d)y.push(...g({key:`${o}.${S}`,value:d[S]}));return y}}};function Vs(g){const o=g.value,d=g.key,y=g.styleSpec,S=g.style;if(!o.type)return[new i.V(d,o,'"type" is required')];const P=i.K(o.type);let M=[];switch(["vector","raster","raster-dem","raster-array"].includes(P)&&(o.url||o.tiles||M.push(new i.G(d,o,'Either "url" or "tiles" is required.'))),P){case"vector":case"raster":case"raster-dem":case"raster-array":return M=M.concat(Sn({key:d,value:o,valueSpec:y[`source_${P.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:Va})),M;case"geojson":if(M=Sn({key:d,value:o,valueSpec:y.source_geojson,style:S,styleSpec:y,objectElementValidators:Va}),o.cluster)for(const D in o.clusterProperties){const[G,K]=o.clusterProperties[D],Y=typeof G=="string"?[G,["accumulated"],["get",D]]:G;M.push(...zt({key:`${d}.${D}.map`,value:K,expressionContext:"cluster-map"})),M.push(...zt({key:`${d}.${D}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return M;case"video":return Sn({key:d,value:o,valueSpec:y.source_video,style:S,styleSpec:y});case"image":return Sn({key:d,value:o,valueSpec:y.source_image,style:S,styleSpec:y});case"canvas":return[new i.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fr({key:`${d}.type`,value:o.type,valueSpec:{values:yo(y)}})}}function yo(g){return g.source.reduce((o,d)=>{const y=g[d];return y.type.type==="enum"&&(o=o.concat(Object.keys(y.type.values))),o},[])}function Qa(g){const o=g.value,d=g.styleSpec,y=d.light,S=g.style;let P=[];const M=i.H(o);if(o===void 0)return P;if(M!=="object")return P=P.concat([new i.V("light",o,`object expected, ${M} found`)]),P;for(const D in o){const G=D.match(/^(.*)-transition$/),K=D.match(/^(.*)-use-theme$/);P=P.concat(K&&y[K[1]]?an({key:D,value:o[D],valueSpec:{type:"string"},style:S,styleSpec:d}):G&&y[G[1]]&&y[G[1]].transition?an({key:D,value:o[D],valueSpec:d.transition,style:S,styleSpec:d}):y[D]?an({key:D,value:o[D],valueSpec:y[D],style:S,styleSpec:d}):[new i.V(D,o[D],`unknown property "${D}"`)])}return P}function ql(g){const o=g.value;let d=[];if(!o)return d;const y=i.H(o);if(y!=="object")return d=d.concat([new i.V("light-3d",o,`object expected, ${y} found`)]),d;const S=g.styleSpec,P=S["light-3d"],M=g.key,D=g.style,G=g.style.lights;for(const te of["type","id"])if(!(te in o))return d=d.concat([new i.V("light-3d",o,`missing property ${te} on light`)]),d;if(o.type&&G)for(let te=0;te<g.arrayIndex;te++){const re=i.K(o.type),oe=G[te];i.K(oe.type)===re&&d.push(new i.V(M,o.id,`duplicate light type "${o.type}", previously defined at line ${oe.id.__line__}`))}const K=`properties_light_${o.type}`;if(!(K in S))return d=d.concat([new i.V("light-3d",o,`Invalid light type ${o.type}`)]),d;const Y=S[K];for(const te in o)if(te==="properties"){const re=o[te],oe=i.H(re);if(oe!=="object")return d=d.concat([new i.V("properties",re,`object expected, ${oe} found`)]),d;for(const ve in re)d=d.concat(Y[ve]?an({key:ve,value:re[ve],valueSpec:Y[ve],style:D,styleSpec:S}):[new i.G(g.key,re[ve],`unknown property "${ve}"`)])}else{const re=te.match(/^(.*)-transition$/),oe=te.match(/^(.*)-use-theme$/);d=d.concat(oe&&P[oe[1]]?an({key:te,value:o[te],valueSpec:{type:"string"},style:D,styleSpec:S}):re&&P[re[1]]&&P[re[1]].transition?an({key:te,value:o[te],valueSpec:S.transition,style:D,styleSpec:S}):P[te]?an({key:te,value:o[te],valueSpec:P[te],style:D,styleSpec:S}):[new i.G(te,o[te],`unknown property "${te}"`)])}return d}function _l(g){const o=g.value,d=g.key,y=g.style,S=g.styleSpec,P=S.terrain;let M=[];const D=i.H(o);if(o===void 0||D==="null")return M;if(D!=="object")return M=M.concat([new i.V("terrain",o,`object expected, ${D} found`)]),M;for(const G in o){const K=G.match(/^(.*)-transition$/),Y=G.match(/^(.*)-use-theme$/);M=M.concat(Y&&P[Y[1]]?an({key:G,value:o[G],valueSpec:{type:"string"},style:y,styleSpec:S}):K&&P[K[1]]&&P[K[1]].transition?an({key:G,value:o[G],valueSpec:S.transition,style:y,styleSpec:S}):P[G]?an({key:G,value:o[G],valueSpec:P[G],style:y,styleSpec:S}):[new i.G(G,o[G],`unknown property "${G}"`)])}if(o.source){const G=y.sources&&y.sources[o.source],K=G&&i.K(G.type);G?K!=="raster-dem"&&M.push(new i.V(d,o.source,`terrain cannot be used with a source of type ${String(K)}, it only be used with a "raster-dem" source type`)):M.push(new i.V(d,o.source,`source "${o.source}" not found`))}else M.push(new i.V(d,o,'terrain is missing required property "source"'));return M}function Os(g){const o=g.value,d=g.style,y=g.styleSpec,S=y.fog;let P=[];const M=i.H(o);if(o===void 0)return P;if(M!=="object")return P=P.concat([new i.V("fog",o,`object expected, ${M} found`)]),P;for(const D in o){const G=D.match(/^(.*)-transition$/),K=D.match(/^(.*)-use-theme$/);P=P.concat(K&&S[K[1]]?an({key:D,value:o[D],valueSpec:{type:"string"},style:d,styleSpec:y}):G&&S[G[1]]&&S[G[1]].transition?an({key:D,value:o[D],valueSpec:y.transition,style:d,styleSpec:y}):S[D]?an({key:D,value:o[D],valueSpec:S[D],style:d,styleSpec:y}):[new i.G(D,o[D],`unknown property "${D}"`)])}return P}const Gl={"*":()=>[],array:Br,boolean:function(g){const o=g.value,d=g.key,y=i.H(o);return y!=="boolean"?[new i.V(d,o,`boolean expected, ${y} found`)]:[]},number:et,color:function(g){const o=g.key,d=g.value,y=i.H(d);return y!=="string"?[new i.V(o,d,`color expected, ${y} found`)]:i._.parseCSSColor(d)===null?[new i.V(o,d,`color expected, "${d}" found`)]:[]},enum:fr,filter:pr,function:bt,layer:Vi,object:Sn,source:Vs,model:i.a2,light:Qa,"light-3d":ql,terrain:_l,fog:Os,string:io,formatted:function(g){return io(g).length===0?[]:zt(g)},resolvedImage:function(g){return io(g).length===0?[]:zt(g)},projection:function(g){const o=g.value,d=g.styleSpec,y=d.projection,S=g.style;let P=[];const M=i.H(o);if(M==="object")for(const D in o)P=P.concat(an({key:D,value:o[D],valueSpec:y[D],style:S,styleSpec:d}));else M!=="string"&&(P=P.concat([new i.V("projection",o,`object or string expected, ${M} found`)]));return P},import:function(g){const{value:o,styleSpec:d}=g,{data:y,...S}=o;Object.defineProperty(S,"__line__",{value:o.__line__,enumerable:!1});let P=Sn(i.J({},g,{value:S,valueSpec:d.import}));return i.K(S.id)===""&&P.push(new i.V(`${g.key}.id`,S,"import id can't be an empty string")),y&&(P=P.concat(Mu(y,d,{key:`${g.key}.data`}))),P}};function an(g,o=!1){const d=g.value,y=g.valueSpec,S=g.styleSpec;if(y.expression&&i.a0(i.K(d)))return bt(g);if(y.expression&&i.O(i.Q(d)))return zt(g);if(y.type&&Gl[y.type]){const P=Gl[y.type](g);return o===!0&&P.length>0&&i.H(g.value)==="array"?zt(g):P}return Sn(i.J({},g,{valueSpec:y.type?S[y.type]:y}))}function es(g){const o=g.value,d=g.key,y=io(g);return y.length||(o.indexOf("{fontstack}")===-1&&y.push(new i.V(d,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&y.push(new i.V(d,o,'"glyphs" url must include a "{range}" token'))),y}function Mu(g,o=i.a3,d={}){return an({key:d.key||"",value:g,valueSpec:o.$root,styleSpec:o,style:g,objectElementValidators:{glyphs:es,"*":()=>[]}})}function Ua(g,o=i.a3){return Hi(Mu(g,o))}const Us=g=>Hi(Vs(g)),qn=g=>Hi(Qa(g)),ha=g=>Hi(ql(g)),Ta=g=>Hi(_l(g)),ws=g=>Hi(Os(g)),bl=g=>Hi(function(o){const d=o.value,y=o.style,S=o.styleSpec,P=S.snow;let M=[];const D=i.H(d);if(d===void 0)return M;if(D!=="object")return M=M.concat([new i.V("snow",d,`object expected, ${D} found`)]),M;for(const G in d){const K=G.match(/^(.*)-transition$/);M=M.concat(K&&P[K[1]]&&P[K[1]].transition?an({key:G,value:d[G],valueSpec:S.transition,style:y,styleSpec:S}):P[G]?an({key:G,value:d[G],valueSpec:P[G],style:y,styleSpec:S}):[new i.G(G,d[G],`unknown property "${G}"`)])}return M}(g)),Pa=g=>Hi(function(o){const d=o.value,y=o.style,S=o.styleSpec,P=S.rain;let M=[];const D=i.H(d);if(d===void 0)return M;if(D!=="object")return M=M.concat([new i.V("rain",d,`object expected, ${D} found`)]),M;for(const G in d){const K=G.match(/^(.*)-transition$/);M=M.concat(K&&P[K[1]]&&P[K[1]].transition?an({key:G,value:d[G],valueSpec:S.transition,style:y,styleSpec:S}):P[G]?an({key:G,value:d[G],valueSpec:P[G],style:y,styleSpec:S}):[new i.G(G,d[G],`unknown property "${G}"`)])}return M}(g)),Ns=g=>Hi(Vi(g)),Ui=g=>Hi(pr(g)),Ss=g=>Hi(Xn(g)),us=g=>Hi(Bi(g)),ju=g=>Hi(i.a2(g));function Hi(g){return g.slice().sort((o,d)=>o.line&&d.line?o.line-d.line:0)}function zo(g,o){let d=!1;if(o&&o.length)for(const y of o)y instanceof i.G?i.w(y.message):(g.fire(new i.y(new Error(y.message))),d=!0);return d}let At;class ye extends i.E{constructor(o,d="flat"){super(),this._transitionable=new i.a4(At||(At=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(o,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d,y={}){this._validate(qn,o,y)||(this._transitionable.setTransitionOrValue(o),this.id=d)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,y){return(!y||y.validate!==!1)&&zo(this,o.call(Ua,i.l({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Se=class extends i.E{constructor(g,o,d,y){super(),this.scope=d,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),d,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(g,o){this._transitionable.setTransitionOrValue(g,o)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new i.a8(g)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const o=g.value.expression;if(!o)return null;let d=-1,y=-1,S=1;for(const P of o.zoomStops)S=o.evaluate(new i.a8(P)),S>.01?(d=P,y=-1):y=P;return S<.01&&d>0&&y>d?[d,y]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof i.a9}};const Pe=45,He=65,Ye=.05;function at(g,o,d,y){const S=i.ac(Pe,He,d),[P,M]=gt(g,y);let D=1-Math.min(1,Math.exp((o-P)/(M-P)*-6));return D*=D*D,D=Math.min(1,1.00747*D),D*S*g.alpha}function gt(g,o){const d=.5/Math.tan(.5*o);return[g.range[0]+d,g.range[1]+d]}function ot(g,o,d,y,S){const P=i.ab.vec3.transformMat4([],[o,d,y],S.mercatorFogMatrix);return at(g,i.ab.vec3.length(P),S.pitch,S._fov)}function St(g,o,d,y,S,P,M){const D=[[d,y,0],[S,y,0],[S,P,0],[d,P,0]];let G=Number.MAX_VALUE,K=-Number.MAX_VALUE;for(const Y of D){const te=i.ab.vec3.transformMat4([],Y,o),re=i.ab.vec3.length(te);G=Math.min(G,re),K=Math.max(K,re)}return[at(g,G,M.pitch,M._fov),at(g,K,M.pitch,M._fov)]}class wt extends i.E{constructor(o,d,y,S){super();const P=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(P,y,new Map(S)),this.set(o,S),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new i.ad(P),this.scope=y}get state(){const o=this._transform,d=o.projection.name==="globe",y=i.ae(o.zoom),S=this.properties.get("range"),P=[.5,3];return{range:d?[i.af(P[0],S[0],y),i.af(P[1],S[1],y)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,d,y={}){if(this._validate(ws,o,y))return;const S=i.l({},o);for(const P of Object.keys(i.a3.fog))S[P]===void 0&&(S[P]=i.a3.fog[P].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(Pe,He,o))*d.a}getOpacityAtLatLng(o,d){return this._transform.projection.supportsFog?function(y,S,P){const M=i.aa.fromLngLat(S),D=P.elevation?P.elevation.getAtPointOrZero(M):0;return ot(y,M.x,M.y,D,P)}(this.state,o,d):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(o.toUnwrapped());return St(this.state,d,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(o,d,y,S,P){return this._transform.projection.supportsFog?St(this.state,o,d,y,S,P,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?gt(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const y of d){const S=o.points[y];let P;if(S[2]>=0)P=S;else{const M=o.points[y-4];P=i.ah(M,S,M[2]/(M[2]-S[2]))}if(ot(this.state,P[0],P[1],0,this._transform)>=Ye)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,y){return(!y||y.validate!==!1)&&zo(this,o.call(Ua,i.l({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Tt,Ft,rr,sr,Ar=class extends i.E{constructor(g,o,d,y){super();const S=Tt||(Tt=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(S,d,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(S),this.scope=d}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),d=this.properties.get("direction"),y=i.ai(d[0]),S=-Math.max(i.ai(d[1]),.01),P=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],M=this.properties.get("vignette"),D=this.properties.get("vignette-color");return D.a=M,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(o.r,o.g,o.b,o.a*g),direction:P,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:D}}get(){return this._transitionable.serialize()}set(g,o,d={}){if(this._validate(bl,g,d))return;const y=i.l({},g);for(const S of Object.keys(i.a3.snow))y[S]===void 0&&(y[S]=i.a3.snow[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,d){return(!d||d.validate!==!1)&&zo(this,g.call(Ua,i.l({value:o,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},$r=class extends i.E{constructor(g,o,d,y){super();const S=Ft||(Ft=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(S,d,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(S),this.scope=d}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),d=this.properties.get("direction"),y=i.ai(d[0]),S=-Math.max(i.ai(d[1]),.01),P=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],M=this.properties.get("vignette-color");return M.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(o.r,o.g,o.b,o.a*g),direction:P,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:M}}get(){return this._transitionable.serialize()}set(g,o,d={}){if(this._validate(Pa,g,d))return;const y=i.l({},g);for(const S of Object.keys(i.a3.rain))y[S]===void 0&&(y[S]=i.a3.rain[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,d){return(!d||d.validate!==!1)&&zo(this,g.call(Ua,i.l({value:o,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class Ur extends i.E{constructor(o,d,y,S){super(),this.scope=y,this._options=o,this.properties=new i.ad(d),this._transitionable=new i.a4(d,y,new Map(S)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,d){this._options=o,this._transitionable.setTransitionOrValue(o.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Vr{constructor(o,d,y,S){this.screenBounds=o,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(o,d){let y,S;if(o instanceof i.P||typeof o[0]=="number"){const P=i.P.convert(o);y=[P],S=d.isPointAboveHorizon(P)}else{const P=i.P.convert(o[0]),M=i.P.convert(o[1]);y=[P,M],S=i.al(P,M).every(D=>d.isPointAboveHorizon(D))}return new Vr(y,d.getCameraPoint(),S,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.al(d,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<y.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?S[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(S[3]=this.cameraPoint)),i.am(S,o)}bufferedCameraGeometryGlobe(o){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.al(d,y,o),P=this.cameraPoint.clone();switch(3*((P.y>d.y)+(P.y>y.y))+((P.x>d.x)+(P.x>y.x))){case 0:S[0]=P,S[4]=P.clone();break;case 1:S.splice(1,0,P);break;case 2:S[1]=P;break;case 3:S.splice(4,0,P);break;case 5:S.splice(2,0,P);break;case 6:S[3]=P;break;case 7:S.splice(3,0,P);break;case 8:S[2]=P}return S}containsTile(o,d,y,S=0){const P=o.queryPadding/d._pixelsPerMercatorPixel+1,M=y?this._bufferedCameraMercator(P,d):this._bufferedScreenMercator(P,d);let D=o.tileID.wrap+(M.unwrapped?S:0);const G=M.polygon.map(be=>i.an(o.tileTransform,be,D));if(!i.ao(G,0,0,i.ag,i.ag))return;D=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const K=this.screenGeometryMercator.polygon.map(be=>i.ap(o.tileTransform,be,D)),Y=K.map(be=>new i.P(be[0],be[1])),te=d.getFreeCameraOptions().position||new i.aa(0,0,0),re=i.ap(o.tileTransform,te,D),oe=K.map(be=>{const xe=i.ab.vec3.sub(be,be,re);return i.ab.vec3.normalize(xe,xe),new i.aq(re,xe)}),ve=i.ar(o,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:oe,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(fe=i.as(G),fe.min.x=i.aw(fe.min.x,0,i.ag),fe.min.y=i.aw(fe.min.y,0,i.ag),fe.max.x=i.aw(fe.max.x,0,i.ag),fe.max.y=i.aw(fe.max.y,0,i.ag),fe),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ve};var fe}_bufferedScreenMercator(o,d){const y=bn(o);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),d):{polygon:this.bufferedScreenGeometry(o).map(P=>d.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[y]=S,S}}_bufferedCameraMercator(o,d){const y=bn(o);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),d):{polygon:this.bufferedCameraGeometry(o).map(P=>d.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[y]=S,S}}_projectAndResample(o,d){const y=function(P,M){const D=i.ab.mat4.multiply([],M.pixelMatrix,M.globeMatrix),G=[0,-i.ax,0,1],K=[0,i.ax,0,1],Y=[0,0,0,1];i.ab.vec4.transformMat4(G,G,D),i.ab.vec4.transformMat4(K,K,D),i.ab.vec4.transformMat4(Y,Y,D);const te=new i.P(G[0]/G[3],G[1]/G[3]),re=new i.P(K[0]/K[3],K[1]/K[3]),oe=i.au(P,te)&&G[3]<Y[3],ve=i.au(P,re)&&K[3]<Y[3];if(!oe&&!ve)return null;const fe=function(We,$e,Ke){for(let it=1;it<We.length;it++){const _t=Hn($e.pointCoordinate3D(We[it-1]).x),mt=Hn($e.pointCoordinate3D(We[it]).x);if(Ke<0){if(_t<mt)return{idx:it,t:-_t/(mt-1-_t)}}else if(mt<_t)return{idx:it,t:(1-_t)/(mt+1-_t)}}return null}(P,M,oe?-1:1);if(!fe)return null;const{idx:be,t:xe}=fe;let Ce=be>1?Cn(P.slice(0,be),M):[],Ue=be<P.length?Cn(P.slice(be),M):[];Ce=Ce.map(We=>new i.P(Hn(We.x),We.y)),Ue=Ue.map(We=>new i.P(Hn(We.x),We.y));const Be=[...Ce];Be.length===0&&Be.push(Ue[Ue.length-1]);const Xe=i.af(Be[Be.length-1].y,(Ue.length===0?Ce[0]:Ue[0]).y,xe);let qe;return qe=oe?[new i.P(0,Xe),new i.P(0,0),new i.P(1,0),new i.P(1,Xe)]:[new i.P(1,Xe),new i.P(1,1),new i.P(0,1),new i.P(0,Xe)],Be.push(...qe),Ue.length===0?Be.push(Ce[0]):Be.push(...Ue),{polygon:Be.map(We=>new i.aa(We.x,We.y)),unwrapped:!1}}(o,d);if(y)return y;const S=function(P,M){let D=!1,G=-1/0,K=0;for(let te=0;te<P.length-1;te++)P[te].x>G&&(G=P[te].x,K=te);for(let te=0;te<P.length-1;te++){const re=(K+te)%(P.length-1),oe=P[re],ve=P[re+1];Math.abs(oe.x-ve.x)>.5&&(oe.x<ve.x?(oe.x+=1,re===0&&(P[P.length-1].x+=1)):(ve.x+=1,re+1===P.length-1&&(P[0].x+=1)),D=!0)}const Y=i.at(M.center.lng);return D&&Y<Math.abs(Y-1)&&P.forEach(te=>{te.x-=1}),{polygon:P,unwrapped:D}}(Cn(o,d).map(P=>new i.P(Hn(P.x),P.y)),d);return{polygon:S.polygon.map(P=>new i.aa(P.x,P.y)),unwrapped:S.unwrapped}}}function Cn(g,o){return i.av(g,d=>{const y=o.pointCoordinate3D(d);d.x=y.x,d.y=y.y},1/256)}function Hn(g){return g<0?1+g%1:g%1}function bn(g){return 100*g|0}function Un(g,o,d,y,S){const P=function(D,G){if(D)return S(D);if(G){if(g.url&&G.tiles&&g.tiles&&delete g.tiles,G.variants){if(!Array.isArray(G.variants))return S(new Error("variants must be an array"));for(const Y of G.variants){if(Y==null||typeof Y!="object"||Y.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(Y.capabilities))return S(new Error("capabilities must be an array"));if(Y.capabilities.length===1&&Y.capabilities[0]==="meshopt"){G=i.l(G,Y);break}}}const K=i.ay(i.l({},G,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);K.tiles=o.canonicalizeTileset(K,g.url),S(null,K)}},M=function(D,G,K){if(!D)return null;if(!G&&!K)return D;K=K||D.worldview_default;const Y=Object.values(D.language||{});if(Y.length===0)return null;const te=Object.values(D.worldview||{});if(te.length===0)return null;const re=Y.every(ve=>ve===G),oe=te.every(ve=>ve===K);return re&&oe?D:G in(D.language_options||{})||K in(D.worldview_options||{})?null:D.language_options&&D.worldview_options?D:null}(g.data,d,y);return M?i.q.frame(()=>P(null,M)):g.url?i.n(o.transformRequest(o.normalizeSourceURL(g.url,null,d,y),i.R.Source),P):i.q.frame(()=>{const{data:D,...G}=g;P(null,G)})}class En{constructor(o,d,y){this.bounds=i.az.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),y=Math.floor(i.at(this.bounds.getWest())*d),S=Math.floor(i.aA(this.bounds.getNorth())*d),P=Math.ceil(i.at(this.bounds.getEast())*d),M=Math.ceil(i.aA(this.bounds.getSouth())*d);return o.x>=y&&o.x<P&&o.y>=S&&o.y<M}}class Ca extends i.E{constructor(o,d,y,S){if(super(),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(d,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new i.aB}load(o){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=Un(this._options,this.map._requestManager,d,y,(S,P)=>{if(this._tileJSONRequest=null,this._loaded=!0,S)d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new i.y(S));else if(P){if(i.l(this,P),this.hasWorldviews=!!P.worldview_options,P.worldview_default&&(this.worldviewDefault=P.worldview_default),P.vector_layers){this.vectorLayers=P.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const M of P.vector_layers)this.vectorLayerIds.push(M.id),P.worldview&&P.worldview[M.source]&&this.localizableLayerIds.add(M.id)}P.bounds&&(this.tileBounds=new En(P.bounds,this.minzoom,this.maxzoom)),ht(P.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}o&&o(S)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(o,d){const y=o.tileID.canonical.url(this.tiles,this.scheme),S=this.map._requestManager.normalizeTileURL(y),P=this.map._requestManager.transformRequest(S,i.R.Tile),M=this.map.style?this.map.style.getLut(this.scope):null,D=M?{image:M.image.clone()}:null,G={request:P,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:D,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(y)&&(G.worldview=this.map.getWorldview()||this.worldviewDefault,G.localizableLayerIds=this.localizableLayerIds),G.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",G,K.bind(this));else if(o.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",G,K.bind(this),void 0,!0);else{const Y=i.aD.call({deduped:this._deduped},G,(te,re)=>{te||!re?K.call(this,te):(G.data={cacheControl:re.cacheControl,expires:re.expires,rawData:re.rawData.slice(0)},o.actor&&o.actor.send("loadTile",G,K.bind(this),void 0,!0))},!0);o.request={cancel:Y}}function K(Y,te){return delete o.request,o.aborted?d(null):Y&&Y.status!==404?d(Y):(te&&te.resourceTiming&&(o.resourceTiming=te.resourceTiming),this.map._refreshExpiredTiles&&te&&o.setExpiryData(te),o.loadVectorData(te,this.map.painter),i.aE(this.dispatcher),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,d){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ds extends i.E{constructor(o,d,y,S){super(),this.id=o,this.dispatcher=y,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},d),i.l(this,i.ay(d,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Un(this._options,this.map._requestManager,null,null,(d,y)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new i.y(d)):y&&(i.l(this,y),y.raster_layers&&(this.rasterLayers=y.raster_layers,this.rasterLayerIds=this.rasterLayers.map(S=>S.id)),y.bounds&&(this.tileBounds=new En(y.bounds,this.minzoom,this.maxzoom)),ht(y.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),o&&o(d)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const y=i.q.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);o.request=i.o(this.map._requestManager.transformRequest(S,i.R.Tile),(P,M,D,G)=>(delete o.request,o.aborted?(o.state="unloaded",d(null)):P?(o.state="errored",d(P)):M?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:D,expires:G}),o.setTexture(M,this.map.painter),o.state="loaded",i.aE(this.dispatcher),void d(null)):d(null)))}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d&&d()}unloadTile(o,d){o.texture&&o.texture instanceof i.T?(o.destroy(!0),o.texture&&o.texture instanceof i.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class $a extends ds{constructor(o,d,y,S){super(o,d,y,S),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},d)}triggerRepaint(o){const d=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);d&&d.enabled&&y&&d._clearRenderCacheForTile(y.id,o.tileID),this.map.triggerRepaint()}loadTile(o,d){const y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(y,i.R.Tile);o.requestParams=S,o.actor||(o.actor=this.dispatcher.getActor()),o.request=o.fetchHeader(void 0,(P,M,D,G)=>{if(delete o.request,o.aborted)return o.state="unloaded",d(null);if(P)return P.code===20?void 0:(o.state="errored",d(P));this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:D,expires:G}),o.state="empty",d(null)})}unloadTile(o,d){const y=o.texture;y&&y instanceof i.T?(o.destroy(!0),this.map.painter.saveTileTexture(y)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,d,y){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(d,y,(S,P)=>{if(S)return o.state="errored",this.fire(new i.y(S)),void this.triggerRepaint(o);P&&(o.setTexture(P,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:P})=>P===o),y=d&&d.fields,S=y&&y.bands&&y.bands;return S?S[0]:0}getTextureDescriptor(o,d,y){if(!o)return;const S=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let P=null;d instanceof i.aH?P=d.paint.get("raster-array-band"):d instanceof i.aI&&(P=d.paint.get("raster-particle-array-band"));const M=P||this.getInitialBand(S);if(M!=null)if(o.textureDescriptor){if(!o.updateNeeded(S,M)||y)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,S,M)}}const ts={vector:Ca,raster:ds,"raster-dem":class extends ds{constructor(g,o,d,y){super(g,o,d,y),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(S,P){S&&(g.state="errored",o(S)),P&&(g.dem=P,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=i.o(this.map._requestManager.transformRequest(d,i.R.Tile),(function(S,P,M,D){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(S)g.state="errored",o(S);else if(P){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:M,expires:D});const G=ImageBitmap&&P instanceof ImageBitmap&&i.t(),K=1-(P.width-i.aF(P.width))/2;K<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const Y=G?P:i.q.getImageData(P,K),te={uid:g.uid,coord:g.tileID,source:this.id,scope:this.scope,rawImageData:Y,encoding:this.encoding,padding:K};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",te,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,d=Math.pow(2,o.z),y=(o.x-1+d)%d,S=o.x===0?g.wrap-1:g.wrap,P=(o.x+1+d)%d,M=o.x+1===d?g.wrap+1:g.wrap,D={};return D[new i.aG(g.overscaledZ,S,o.z,y,o.y).key]={backfilled:!1},D[new i.aG(g.overscaledZ,M,o.z,P,o.y).key]={backfilled:!1},o.y>0&&(D[new i.aG(g.overscaledZ,S,o.z,y,o.y-1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,M,o.z,P,o.y-1).key]={backfilled:!1}),o.y+1<d&&(D[new i.aG(g.overscaledZ,S,o.z,y,o.y+1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,M,o.z,P,o.y+1).key]={backfilled:!1}),D}},"raster-array":$a,geojson:class extends i.E{constructor(g,o,d,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(y),this._data=o.data,this._options=i.l({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const S=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*S,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*S,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:i.ag,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*S,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const d of this._data.features)o.set(d.id,d);for(const d of g.features)o.set(d.id,d);this._data.features=[...o.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterLeaves(g,o,d,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:o,offset:d},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const o=i.l({append:g},this.workerOptions);o.scope=this.scope;const d=this._data;typeof d=="string"?(o.request=this.map._requestManager.transformRequest(i.q.resolveURL(d),i.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(y,S)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new i.y(y));else{const P={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(P.resourceTiming=S.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new i.z("data",P)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,o){const d=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,S=y?{image:y.image.clone()}:null,P=this._partialReload,M={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:P};g.request=this.actor.send(d,M,(D,G)=>P&&!G?(g.state="loaded",o(null)):(delete g.request,g.destroy(),g.aborted?o(null):D?o(D):(g.loadVectorData(G,this.map.painter,d==="reloadTile"),o(null))),void 0,d==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,o){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(g,o,d,y){super(g,o,d,y),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,i.R.Source).url);i.aK(this.urls,(o,d)=>{this._loaded=!0,o?this.fire(new i.y(o)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(g,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(g,o,d,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const g=[];for(const o in this._options.models){const d=this._options.models[o],y=i.aM(this.map._requestManager.transformRequest(d.uri,i.R.Model).url).then(S=>{if(!S)return;const P=i.aN(S),M=new i.aO(o,d.position,d.orientation,P);M.computeBoundsAndApplyParent(),this.models.push(M)}).catch(S=>{this.fire(new i.y(new Error(`Could not load model ${o} from ${d.uri}: ${S.message}`)))});g.push(y)}return Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this.fire(new i.y(new Error(`Could not load models: ${o.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,o){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(g,o,d,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=Un(this._options,this.map._requestManager,o,d,(y,S)=>{this._tileJSONRequest=null,this._loaded=!0,y?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new i.y(y))):S&&(i.l(this,S),S.bounds&&(this.tileBounds=new En(S.bounds,this.minzoom,this.maxzoom)),ht(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,o){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(d,i.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=o;else{if(g.buckets){const P=Object.values(g.buckets);for(const M of P)M.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,S.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,S.bind(this),void 0,!0);function S(P,M){return g.aborted?o(null):P&&P.status!==404?o(P):(this.map._refreshExpiredTiles&&M&&g.setExpiryData(M),g.loadModelData(M,this.map.painter),g.state="loaded",void o(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(g,o,d,y){super(g,o,d,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(P=>typeof P!="number"))||this.fire(new i.y(new i.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends i.E{constructor(g,o,d,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=o,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new En(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:d,z:y}=g.canonical;return this._implementation.hasTile({x:o,y:d,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:d,y,z:S}=g.tileID.canonical,P=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:d,y,z:S},{signal:P.signal})).then((function(M){return delete g.request,g.aborted?(g.state="unloaded",o(null)):M===void 0?(g.state="errored",o(null)):M===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):function(D){return D instanceof ImageData||D instanceof HTMLCanvasElement||D instanceof ImageBitmap||D instanceof HTMLImageElement}(M)?(this.loadTileData(g,M),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(M=>{M.code!==20&&(g.state="errored",o(M))}),g.request.cancel=()=>P.abort()}loadTileData(g,o){g.setTexture(o,this.map.painter)}unloadTile(g,o){if(g.texture&&g.texture instanceof i.T?(g.destroy(!0),g.texture&&g.texture instanceof i.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:d,y,z:S}=g.tileID.canonical;this._implementation.unloadTile({x:d,y,z:S})}o&&o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},ao=function(g,o,d,y){const S=new ts[o.type](g,o,d,y);if(S.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${S.id}`);return i.aP(["load","abort","unload","serialize","prepare"],S),S};function Ou(g,o,d=""){return`${d}:${o.id||""}:${o.layer.id}:${function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:S,importId:P}=y;return`featureset:${S}${P?`:import:${P}`:""}`}}(g.target)}`}function wl(g,o,d,y=""){if(g.uniqueFeatureID){const S=Ou(g,o,y);if(d.has(S))return!0;d.add(S)}return!1}function Vc(g,o,d,y,S=!1){const P=o.sourceCache.transform,M=o.sourceCache.tilesIn(g,o.has3DLayers,S);M.sort(dy);const D=[];for(const G of M){const K=G.tile.queryRenderedFeatures(o,G,d,y,P,S);Object.keys(K).length&&D.push({wrappedTileID:G.tile.tileID.wrapped().key,queryResults:K})}return D.length===0?{}:function(G){const K={},Y={};for(const te of G){const re=te.queryResults,oe=te.wrappedTileID,ve=Y[oe]=Y[oe]||{};for(const fe in re){const be=re[fe],xe=ve[fe]=ve[fe]||{},Ce=K[fe]=K[fe]||[];for(const Ue of be)xe[Ue.featureIndex]||(xe[Ue.featureIndex]=!0,Ce.push(Ue))}}return K}(D)}function Wh(g,o,d,y,S){const P={},M=y.queryRenderedSymbols(g),D=[];for(const G of Object.keys(M).map(Number))D.push(S[G]);D.sort(dy);for(const G of D){const K=G.featureIndex.lookupSymbolFeatures(M[G.bucketInstanceId],G.bucketIndex,G.sourceLayerIndex,o,d);for(const Y in K){const te=P[Y]=P[Y]||[],re=K[Y];re.sort((oe,ve)=>{const fe=G.featureSortOrder;if(fe){const be=fe.indexOf(oe.featureIndex);return fe.indexOf(ve.featureIndex)-be}return ve.featureIndex-oe.featureIndex});for(const oe of re)te.push(oe)}}return P}function r0(g,o){const d=g.getRenderableIds().map(P=>g.getTileByID(P)),y=[],S={};for(let P=0;P<d.length;P++){const M=d[P],D=M.tileID.canonical.key;S[D]||(S[D]=!0,M.querySourceFeatures(y,o))}return y}function dy(g,o){const d=g.tileID,y=o.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}function lp(g,o){const d={};if(!o)return d;for(const y of g){const S=y.layerIds.map(P=>o.getLayer(P)).filter(Boolean);if(S.length!==0){y.layers=S,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(P=>S.filter(M=>M.id===P)[0]));for(const P of S)d[P.fqid]=y}}return d}const $s=32,al=33,sl=new Uint16Array(8184);for(let g=0;g<2046;g++){let o=g+2,d=0,y=0,S=0,P=0,M=0,D=0;for(1&o?S=P=M=$s:d=y=D=$s;(o>>=1)>1;){const K=d+S>>1,Y=y+P>>1;1&o?(S=d,P=y,d=M,y=D):(d=S,y=P,S=M,P=D),M=K,D=Y}const G=4*g;sl[G+0]=d,sl[G+1]=y,sl[G+2]=S,sl[G+3]=P}const uc=new Uint16Array(2178),ol=new Uint8Array(1089),vi=new Uint16Array(1089);function cp(g){return g===0?-.03125:g===32?.03125:0}const Tm={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class dc{constructor(o,d,y,S,P){this.tileID=o,this.uid=i.aV(),this.uses=0,this.tileSize=d,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=P,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection)}registerFadeDuration(o){const d=o+this.timeAdded;d<i.q.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,d,y){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=lp(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const P=this.buckets[S];if(P instanceof i.aX){if(this.hasSymbolBuckets=!0,!y)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const P=this.buckets[S];if(P instanceof i.aX&&P.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const S in this.buckets){const P=this.buckets[S],M=d.style.getOwnLayer(S);if(!M)continue;const D=M.queryRadius(P);this.queryPadding=Math.max(this.queryPadding,D)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,d,y){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,lp(o.buckets,d.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const S in this.buckets){const P=this.buckets[S];P.uploadPending()&&P.upload(o)}const d=o.gl,y=this.imageAtlas;if(y&&!y.uploaded){const S=!!Object.keys(y.patternPositions).length;this.imageAtlasTexture=new i.T(o,y.image,d.RGBA8,{useMipmap:S}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(o,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(o,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(o,d,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,y),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=d.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this.updateBuckets(d,this._lastUpdatedBrightness!==S),this._lastUpdatedBrightness=S))}queryRenderedFeatures(o,d,y,S,P,M){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const D=function(G,K){const Y=i.ab.mat4.fromScaling([],[.5*G.width,.5*-G.height,1]);return i.ab.mat4.translate(Y,Y,[1,-1,0]),i.ab.mat4.multiply(Y,Y,G.calculateProjMatrix(K.toUnwrapped())),Float32Array.from(Y)}(P,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:d,pixelPosMatrix:D,transform:S,availableImages:y,tileTransform:this.tileTransform})}querySourceFeatures(o,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const S=y.loadVTLayers(),P=d?d.sourceLayer:"",M=S._geojsonTileLayer||S[P];if(!M)return;const D=i.aZ(d&&d.filter),{z:G,x:K,y:Y}=this.tileID.canonical,te={z:G,x:K,y:Y};for(let re=0;re<M.length;re++){const oe=M.feature(re);if(D.needGeometry){const be=i.a_(oe,!0);if(!D.filter(new i.a8(this.tileID.overscaledZ),be,this.tileID.canonical))continue}else if(!D.filter(new i.a8(this.tileID.overscaledZ),oe))continue;const ve=y.getId(oe,P),fe=new i.a$(oe,G,K,Y,ve);fe.tile=te,o.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const y=i.b0(o.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const y=Date.now();let S=!1;if(this.expirationTime>y)S=!1;else if(d)if(this.expirationTime<d)S=!0;else{const P=this.expirationTime-d;P?this.expirationTime=y+Math.max(P,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,d){if(!this.latestFeatureIndex||!o.style)return;const y=this.latestFeatureIndex.loadVTLayers(),S=o.style.listImages(),P=o.style.getBrightness();for(const M in this.buckets){if(!o.style.hasLayer(M))continue;const D=this.buckets[M],G=D.layers[0],K=G.sourceLayer||"_geojsonTileLayer",Y=y[K],te=o.style.getLayerSourceCache(G);let re={};te&&(re=te._state.getState(K,void 0));const oe=this.imageAtlas&&this.imageAtlas.patternPositions||{},ve=Object.keys(re).length>0&&!d;ve&&!D.stateDependentLayers.length&&!d||D.update(re,Y,S,oe,ve?D.stateDependentLayers:D.layers,d,P),(D instanceof i.b1||D instanceof i.b2)&&o._terrain&&o._terrain.enabled&&te&&D.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(te.id,this.tileID);const fe=o&&o.style&&o.style.getOwnLayer(M);fe&&(this.queryPadding=Math.max(this.queryPadding,fe.queryRadius(D)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=i.q.now()+o}setTexture(o,d){const y=d.context,S=y.gl;this.texture=this.texture||d.getTileTexture(o.width),this.texture&&this.texture instanceof i.T?this.texture.update(o):(this.texture=new i.T(y,o,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(o,d){const y={};for(const S of d)y[S]=!0;this.dependencies[o]=y}hasDependency(o,d){for(const y of o){const S=this.dependencies[y];if(S){for(const P of d)if(S[P])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const y=i.b3(Tm,this.tileID.canonical,this.tileTransform)[0],S=new i.b4,P=new i.b5;for(let M=0;M<y.length;M++){const{x:D,y:G}=y[M];S.emplaceBack(D,G),P.emplaceBack(M)}P.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(P),this._tileDebugBuffer=o.createVertexBuffer(S,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,S.length,P.length)}_makeTileBoundsBuffers(o,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const y=i.b3(Tm,this.tileID.canonical,this.tileTransform)[0];let S,P;if(this.isRaster){const M=function(D,G){const K=i.aQ(D,G),Y=Math.pow(2,D.z);for(let be=0;be<al;be++)for(let xe=0;xe<al;xe++){const Ce=i.aR((D.x+(xe+cp(xe))/$s)/Y),Ue=i.aS((D.y+(be+cp(be))/$s)/Y),Be=G.project(Ce,Ue),Xe=be*al+xe;uc[2*Xe+0]=Math.round((Be.x*K.scale-K.x)*i.ag),uc[2*Xe+1]=Math.round((Be.y*K.scale-K.y)*i.ag)}ol.fill(0),vi.fill(0);for(let be=2045;be>=0;be--){const xe=4*be,Ce=sl[xe+0],Ue=sl[xe+1],Be=sl[xe+2],Xe=sl[xe+3],qe=Ce+Be>>1,We=Ue+Xe>>1,$e=qe+We-Ue,Ke=We+Ce-qe,it=Ue*al+Ce,_t=Xe*al+Be,mt=We*al+qe,Mt=Math.hypot((uc[2*it+0]+uc[2*_t+0])/2-uc[2*mt+0],(uc[2*it+1]+uc[2*_t+1])/2-uc[2*mt+1])>=16;ol[mt]=ol[mt]||(Mt?1:0),be<1022&&(ol[mt]=ol[mt]||ol[(Ue+Ke>>1)*al+(Ce+$e>>1)]||ol[(Xe+Ke>>1)*al+(Be+$e>>1)])}const te=new i.aT,re=new i.aU;let oe=0;function ve(be,xe){const Ce=xe*al+be;return vi[Ce]===0&&(te.emplaceBack(uc[2*Ce+0],uc[2*Ce+1],be*i.ag/$s,xe*i.ag/$s),vi[Ce]=++oe),vi[Ce]-1}function fe(be,xe,Ce,Ue,Be,Xe){const qe=be+Ce>>1,We=xe+Ue>>1;if(Math.abs(be-Be)+Math.abs(xe-Xe)>1&&ol[We*al+qe])fe(Be,Xe,be,xe,qe,We),fe(Ce,Ue,Be,Xe,qe,We);else{const $e=ve(be,xe),Ke=ve(Ce,Ue),it=ve(Be,Xe);re.emplaceBack($e,Ke,it)}}return fe(0,0,$s,$s,$s,0),fe($s,$s,0,0,0,$s),{vertices:te,indices:re}}(this.tileID.canonical,d);S=M.vertices,P=M.indices}else{S=new i.aT,P=new i.aU;for(const{x:D,y:G}of y)S.emplaceBack(D,G,0,0);const M=i.b8(S.int16,void 0,4);for(let D=0;D<M.length;D+=3)P.emplaceBack(M[D],M[D+1],M[D+2])}this._tileBoundsBuffer=o.createVertexBuffer(S,i.b9.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(P),this._tileBoundsSegments=i.b7.simpleSegment(0,0,S.length,P.length)}_makeGlobeTileDebugBuffers(o,d){const y=d.projection;if(!y||y.name!=="globe"||d.freezeTileCoverage)return;const S=this.tileID.canonical,P=i.ba(S,d),M=i.bb(P),D=i.ae(d.zoom);let G;D>0&&(G=i.ab.mat4.invert(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,S,d,M,G,D),this._makeGlobeTileDebugTextBuffer(o,S,d,M,G,D)}_globePoint(o,d,y,S,P,M,D){let G=i.bc(o,d,y);if(M){const K=1<<y.z,Y=i.at(S.center.lng),te=i.aA(S.center.lat),re=(y.x+.5)/K-Y;let oe=0;re>.5?oe=-1:re<-.5&&(oe=1);let ve=(o/i.ag+y.x)/K+oe,fe=(d/i.ag+y.y)/K;ve=(ve-Y)*S._pixelsPerMercatorPixel+Y,fe=(fe-te)*S._pixelsPerMercatorPixel+te;const be=[ve*S.worldSize,fe*S.worldSize,0];i.ab.vec3.transformMat4(be,be,M),G=i.bd(G,be,D)}return i.ab.vec3.transformMat4(G,G,P)}_makeGlobeTileDebugBorderBuffer(o,d,y,S,P,M){const D=new i.b4,G=new i.b5,K=new i.be,Y=(re,oe,ve,fe,be)=>{const xe=(ve-re)/(be-1),Ce=(fe-oe)/(be-1),Ue=D.length;for(let Be=0;Be<be;Be++){const Xe=re+Be*xe,qe=oe+Be*Ce;D.emplaceBack(Xe,qe);const We=this._globePoint(Xe,qe,d,y,S,P,M);K.emplaceBack(We[0],We[1],We[2]),G.emplaceBack(Ue+Be)}},te=i.ag;Y(0,0,te,0,16),Y(te,0,te,te,16),Y(te,te,0,te,16),Y(0,te,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(G),this._tileDebugBuffer=o.createVertexBuffer(D,i.b6.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(K,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,D.length,G.length)}_makeGlobeTileDebugTextBuffer(o,d,y,S,P,M){const D=i.ag/4,G=new i.b4,K=new i.aU,Y=new i.be,te=25;K.reserve(32),G.reserve(te),Y.reserve(te);const re=(oe,ve)=>te*oe+ve;for(let oe=0;oe<te;oe++){const ve=oe*D;for(let fe=0;fe<te;fe++){const be=fe*D;G.emplaceBack(be,ve);const xe=this._globePoint(be,ve,d,y,S,P,M);Y.emplaceBack(xe[0],xe[1],xe[2])}}for(let oe=0;oe<4;oe++)for(let ve=0;ve<4;ve++){const fe=re(oe,ve),be=re(oe,ve+1),xe=re(oe+1,ve),Ce=re(oe+1,ve+1);K.emplaceBack(fe,be,xe),K.emplaceBack(xe,be,Ce)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(K),this._tileDebugTextBuffer=o.createVertexBuffer(G,i.b6.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(Y,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,te,32)}destroy(o=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class Uc extends dc{constructor(o,d,y,S,P){super(o,d,y,S,P),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(o,d){const y=d.context,S=y.gl;this.texture=this.texture||d.getTileTexture(o.width),this.texture&&this.texture instanceof i.T?this.texture.update(o,{premultiply:!1}):this.texture=new i.T(y,o,S.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(o=16384,d){const y=this._mrt=new i.bg(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=i.bi(S,(P,M,D,G)=>{if(P)d(P);else try{const K=y.getHeaderLength(M);if(K>o)return void(this.request=this.fetchHeader(K,d));y.parseHeader(M),this._isHeaderLoaded=!0;let Y=0;for(const te of Object.values(y.layers))Y=Math.max(Y,te.dataIndex[te.dataIndex.length-1].last_byte);M.byteLength>=Y&&(this.entireBuffer=M),d(null,this.entireBuffer||M,D,G)}catch(K){d(K)}}),this.request}fetchBand(o,d,y){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void y(new Error("Tile header is not ready"));const P=this.actor;if(!P)return void y(new Error("Can't fetch tile band without an actor"));let M;const D=(te,re)=>{M.complete(te,re),te?y(te):(this.updateTextureDescriptor(o,d),y(null,this.textureDescriptor&&this.textureDescriptor.img))},G=(te,re)=>{if(te)return y(te);const oe=P.send("decodeRasterArray",{buffer:re,task:M},D,void 0,!0);this._workQueue.push(()=>{oe&&oe.cancel(),M.cancel()})},K=S.getLayer(o);if(!K)return void y(new Error(`Unknown sourceLayer "${o}"`));if(K.hasDataForBand(d))return this.updateTextureDescriptor(o,d),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const Y=K.getDataRange([d]);if(M=S.createDecodingTask(Y),!M||M.tasks.length)if(this.flushQueues(),this.entireBuffer)G(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const te=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),re=i.bi(te,G);this._fetchQueue.push(()=>{re.cancel(),M.cancel()})}else y(null)}updateNeeded(o,d){return(!this.textureDescriptor||this.textureDescriptor.band!==d||this.textureDescriptor.layer!==o)&&this.state!=="errored"}updateTextureDescriptor(o,d){if(!this._mrt)return;const y=this._mrt.getLayer(o);if(!y||!y.hasBand(d)||!y.hasDataForBand(d))return;const{bytes:S,tileSize:P,buffer:M,offset:D,scale:G}=y.getBandView(d),K=P+2*M,Y={data:S,width:K,height:K},te=this.texture;te&&te instanceof i.T&&te.update(Y,{premultiply:!1}),this.textureDescriptor={layer:o,band:d,img:Y,buffer:M,offset:D,tileSize:P,format:y.pixelFormat,mix:[G,256*G,65536*G,16777216*G]}}}class hy{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,y){const S=o.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const P={value:d,timeout:void 0};if(y!==void 0&&(P.timeout=setTimeout(()=>{this.remove(o,P)},y)),this.data[S].push(P),this.order.push(S),this.order.length>this.max){const M=this._getAndRemoveByKey(this.order[0]);M&&this.onRemove(M)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const y=o.wrapped().key,S=d===void 0?0:this.data[y].indexOf(d),P=this.data[y][S];return this.data[y].splice(S,1),P.timeout&&clearTimeout(P.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(P.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const y in this.data)for(const S of this.data[y])o(S.value)||d.push(S);for(const y of d)this.remove(y.value.tileID,y)}}class Pm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,y){const S=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][S]=this.stateChanges[o][S]||{},i.l(this.stateChanges[o][S],y),this.deletedStates[o]===null){this.deletedStates[o]={};for(const P in this.state[o])P!==S&&(this.deletedStates[o][P]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][S]===null){this.deletedStates[o][S]={};for(const P in this.state[o][S])y[P]||(this.deletedStates[o][S][P]=null)}else for(const P in y)this.deletedStates[o]&&this.deletedStates[o][S]&&this.deletedStates[o][S][P]===null&&delete this.deletedStates[o][S][P]}removeFeatureState(o,d,y){if(this.deletedStates[o]===null)return;const S=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},y&&d!==void 0)this.deletedStates[o][S]!==null&&(this.deletedStates[o][S]=this.deletedStates[o][S]||{},this.deletedStates[o][S][y]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][S])for(y in this.deletedStates[o][S]={},this.stateChanges[o][S])this.deletedStates[o][S][y]=null;else this.deletedStates[o][S]=null;else this.deletedStates[o]=null}getState(o,d){const y=this.state[o]||{},S=this.stateChanges[o]||{},P=this.deletedStates[o];if(P===null)return{};if(d!==void 0){const D=String(d),G=i.l({},y[D],S[D]);if(P){const K=P[d];if(K===null)return{};for(const Y in K)delete G[Y]}return G}const M=i.l({},y,S);if(P)for(const D in P)delete M[D];return M}initializeTileState(o,d){o.refreshFeatureState(d)}coalesceChanges(o,d){const y={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const P={};for(const M in this.stateChanges[S])this.state[S][M]||(this.state[S][M]={}),i.l(this.state[S][M],this.stateChanges[S][M]),P[M]=this.state[S][M];y[S]=P}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const P={};if(this.deletedStates[S]===null)for(const M in this.state[S])P[M]={},this.state[S][M]={};else for(const M in this.deletedStates[S]){if(this.deletedStates[S][M]===null)this.state[S][M]={};else if(this.state[S][M])for(const D of Object.keys(this.deletedStates[S][M]))delete this.state[S][M][D];P[M]=this.state[S][M]}y[S]=y[S]||{},i.l(y[S],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const S in o)o[S].refreshFeatureState(d)}}class Fo extends i.E{constructor(o,d,y){super(),this.id=o,this._onlySymbols=y,d.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new hy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Pm,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,d){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(o),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(o=>o.tileID).sort(Jn).map(o=>o.key)}getRenderableIds(o,d){const y=[];for(const S in this._tiles)this._isIdRenderable(+S,o,d)&&y.push(this._tiles[S]);return o?y.sort((S,P)=>{const M=S.tileID,D=P.tileID,G=new i.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),K=new i.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-D.overscaledZ||K.y-G.y||K.x-G.x}).map(S=>S.tileID.key):y.map(S=>S.tileID).sort(Jn).map(S=>S.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d,y){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())&&(y||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,d){const y=this._tiles[o];y&&(y.state!=="loading"&&(y.state=d),this._loadTile(y,this._tileLoaded.bind(this,y,o,d)))}_tileLoaded(o,d,y,S){if(S)if(o.state="errored",S.status!==404)this._source.fire(new i.y(S,{tile:o}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const P=this.map.painter.terrain;this.update(this.transform,P.getScaledDemTileSize(),!0),P.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=i.q.now(),y==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const d=this.getRenderableIds();for(let S=0;S<d.length;S++){const P=d[S];if(o.neighboringTiles&&o.neighboringTiles[P]){const M=this.getTileByID(P);y(o,M),y(M,o)}}function y(S,P){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let M=P.tileID.canonical.x-S.tileID.canonical.x;const D=P.tileID.canonical.y-S.tileID.canonical.y,G=Math.pow(2,S.tileID.canonical.z),K=P.tileID.key;M===0&&D===0||Math.abs(D)>1||(Math.abs(M)>1&&(Math.abs(M+G)===1?M+=G:Math.abs(M-G)===1&&(M-=G)),P.dem&&S.dem&&(S.dem.backfillBorder(P.dem,M,D),S.neighboringTiles&&S.neighboringTiles[K]&&(S.neighboringTiles[K].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,y,S){for(const P in this._tiles){let M=this._tiles[P];if(S[P]||!M.hasData()||M.tileID.overscaledZ<=d||M.tileID.overscaledZ>y)continue;let D=M.tileID;for(;M&&M.tileID.overscaledZ>d+1;){const K=M.tileID.scaledTo(M.tileID.overscaledZ-1);M=this._tiles[K.key],M&&M.hasData()&&(D=K)}let G=D;for(;G.overscaledZ>d;)if(G=G.scaledTo(G.overscaledZ-1),o[G.key]){S[D.key]=D;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=o.overscaledZ-1;y>=d;y--){const S=o.scaledTo(y),P=this._getLoadedTile(S);if(P)return P}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,d){d=d||this._source.tileSize;const y=Math.ceil(o.width/d)+1,S=Math.ceil(o.height/d)+1,P=Math.floor(y*S*5),M=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,P):P,D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(D)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const y={};for(const S in this._tiles){const P=this._tiles[S];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+d),y[P.tileID.key]=P}this._tiles=y;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(o,d,y,S){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(o,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let M,D=this._source.maxzoom;const G=this.map&&this.map.painter?this.map.painter._terrain:null;if(G&&G.sourceCache===this&&G.attenuationRange()){const te=G.attenuationRange()[0],re=Math.floor(te)-Math.log2(G.getDemUpscale());D>re&&(D=re)}if(this.used||this.usedForTerrain){if(this._source.tileID)M=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(te=>new i.aG(te.canonical.z,te.wrap,te.canonical.z,te.canonical.x,te.canonical.y));else if(this.tileCoverLift!==0){const te=o.clone();te.tileCoverLift=this.tileCoverLift,M=te.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&o.projection.name==="globe"&&(M.push(new i.aG(1,0,1,0,0)),M.push(new i.aG(1,0,1,1,0)),M.push(new i.aG(1,0,1,0,1)),M.push(new i.aG(1,0,1,1,1)))}else if(M=o.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const te=this._source.hasTile.bind(this._source);M=M.filter(re=>te(re))}}else M=[];if(M.length>0&&this.castsShadows&&S&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!hc(this._source.type)){const te=o.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),re=Math.min(te,this._source.maxzoom);if(P){const oe=o.extendTileCover(M,re);for(const ve of oe)M.push(ve)}else{const oe=o.extendTileCover(M,re,S);for(const ve of oe)this._shadowCasterTiles[ve.key]=!0,M.push(ve)}}const K=this._updateRetainedTiles(M);if(hc(this._source.type)&&M.length!==0){const te={},re={},oe=Object.keys(K);for(const fe of oe){const be=K[fe],xe=this._tiles[fe];if(!xe||xe.fadeEndTime&&xe.fadeEndTime<=i.q.now())continue;const Ce=this.findLoadedParent(be,Math.max(be.overscaledZ-Fo.maxOverzooming,this._source.minzoom));Ce&&(this._addTile(Ce.tileID),te[Ce.tileID.key]=Ce.tileID),re[fe]=be}const ve=M[M.length-1].overscaledZ;for(const fe in this._tiles){const be=this._tiles[fe];if(K[fe]||!be.hasData())continue;let xe=be.tileID;for(;xe.overscaledZ>ve;){xe=xe.scaledTo(xe.overscaledZ-1);const Ce=this._tiles[xe.key];if(Ce&&Ce.hasData()&&re[xe.key]){K[fe]=be.tileID;break}}}for(const fe in te)K[fe]||(this._coveredTiles[fe]=!0,K[fe]=te[fe])}for(const te in K)this._tiles[te].clearFadeHold();const Y=i.bk(this._tiles,K);for(const te of Y){const re=this._tiles[te];re.hasSymbolBuckets&&!re.holdingForFade()?re.setHoldDuration(this.map._fadeDuration):re.hasSymbolBuckets&&!re.symbolFadeFinished()||this._removeTile(+te)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const d={};if(o.length===0)return d;const y={},S=o.reduce((K,Y)=>Math.min(K,Y.overscaledZ),1/0),P=o[0].overscaledZ,M=Math.max(P-Fo.maxOverzooming,this._source.minzoom),D=Math.max(P+Fo.maxUnderzooming,this._source.minzoom),G={};for(const K of o){const Y=this._addTile(K);d[K.key]=K,Y.hasData()||S<this._source.maxzoom&&(G[K.key]=K)}this._retainLoadedChildren(G,S,D,d);for(const K of o){let Y=this._tiles[K.key];if(Y.hasData())continue;if(K.canonical.z>=this._source.maxzoom){const re=K.children(this._source.maxzoom)[0],oe=this.getTile(re);if(oe&&oe.hasData()){d[re.key]=re;continue}}else{const re=K.children(this._source.maxzoom);if(d[re[0].key]&&d[re[1].key]&&d[re[2].key]&&d[re[3].key])continue}let te=Y.wasRequested();for(let re=K.overscaledZ-1;re>=M;--re){const oe=K.scaledTo(re);if(y[oe.key]||(y[oe.key]=!0,Y=this.getTile(oe),!Y&&te&&(Y=this._addTile(oe)),Y&&(d[oe.key]=oe,te=Y.wasRequested(),Y.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let y,S=this._tiles[o].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){y=this._loadedParentTiles[S.key];break}d.push(S.key);const P=S.scaledTo(S.overscaledZ-1);if(y=this._getLoadedTile(P),y)break;S=P}for(const P of d)this._loadedParentTiles[P]=y}}_addTile(o){let d=this._tiles[o.key];if(d)return d.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const y=!!d;if(!y){const S=this.map?this.map.painter:null,P=this._source.tileSize*o.overscaleFactor();d=this._source.type==="raster-array"?new Uc(o,P,this.transform.tileZoom,S,this._isRaster):new dc(o,P,this.transform.tileZoom,S,this._isRaster),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))}return d?(d.uses++,this._tiles[o.key]=d,y||this._source.fire(new i.z("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const y=d.getExpiryTimeout();y&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},y))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"||d.state==="empty"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,d,y){const S=[],P=this.transform;if(!P)return S;const M=P.projection.name==="globe",D=i.at(P.center.lng);for(const G in this._tiles){const K=this._tiles[G];if(y&&K.clearQueryDebugViz(),K.holdingForFade())continue;let Y;if(M){const te=K.tileID.canonical;if(te.z===0){const re=[Math.abs(i.aw(D,...Lr(te,-1))-D),Math.abs(i.aw(D,...Lr(te,1))-D)];Y=[0,2*re.indexOf(Math.min(...re))-1]}else{const re=[Math.abs(i.aw(D,...Lr(te,-1))-D),Math.abs(i.aw(D,...Lr(te,0))-D),Math.abs(i.aw(D,...Lr(te,1))-D)];Y=[re.indexOf(Math.min(...re))-1]}}else Y=[0];for(const te of Y){const re=o.containsTile(K,P,d,te);re&&S.push(re)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,d){const y=this.getRenderableIds(o,d).map(P=>this._tiles[P].tileID),S=this.transform.projection.name==="globe";for(const P of y)P.projMatrix=this.transform.calculateProjMatrix(P.toUnwrapped()),P.expandedProjMatrix=S?this.transform.calculateProjMatrix(P.toUnwrapped(),!1,!0):P.projMatrix;return y}sortCoordinatesByDistance(o){const d=o.slice(),y=this.transform._camera.position,S=this.transform._camera.forward(),P={};for(const M of d){const D=1/(1<<M.canonical.z);P[M.key]=((M.canonical.x+.5)*D+M.wrap-y[0])*S[0]+((M.canonical.y+.5)*D-y[1])*S[1]-y[2]*S[2]}return d.sort((M,D)=>P[M.key]-P[D.key]),d}hasTransition(){if(this._source.hasTransition())return!0;if(hc(this._source.type))for(const o in this._tiles){const d=this._tiles[o];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(o,d,y){this._state.updateState(o=o||"_geojsonTileLayer",d,y)}removeFeatureState(o,d,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,y)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,y){const S=this._tiles[o];S&&S.setDependencies(d,y)}reloadTilesForDependencies(o,d){for(const y in this._tiles)this._tiles[y].hasDependency(o,d)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(o,d))}_preloadTiles(o,d){if(!this._sourceLoaded){const G=()=>{this._sourceLoaded&&(this._source.off("data",G),this._preloadTiles(o,d))};return void this._source.on("data",G)}const y=new Map,S=Array.isArray(o)?o:[o],P=this.map.painter.terrain,M=this.usedForTerrain&&P?P.getScaledDemTileSize():this._source.tileSize;for(const G of S){const K=G.coveringTiles({tileSize:M,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Y of K)y.set(Y.key,Y);this.usedForTerrain&&G.updateElevation(!1)}const D=Array.from(y.values());i.bl(D,(G,K)=>{const Y=new dc(G,this._source.tileSize*G.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Y,te=>{this._source.type==="raster-dem"&&Y.dem&&this._backfillDEM(Y),K(te,Y)})},d)}}function Jn(g,o){const d=Math.abs(2*g.wrap)-+(g.wrap<0),y=Math.abs(2*o.wrap)-+(o.wrap<0);return g.overscaledZ-o.overscaledZ||y-d||o.canonical.y-g.canonical.y||o.canonical.x-g.canonical.x}function hc(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Lr(g,o){const d=1<<g.z;return[g.x/d+o,(g.x+1)/d+o]}Fo.maxOverzooming=10,Fo.maxUnderzooming=3;class $c{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,d=!1;for(const y in this.style._mergedLayers){const S=this.style._mergedLayers[y];if(S.type==="fill-extrusion")this.layers.push({layer:S,visible:o,visibilityChanged:d});else if(S.type==="model"){const P=this.style.getLayerSource(S);P&&P.type==="batched-model"&&this.layers.push({layer:S,visible:o,visibilityChanged:d})}}}onNewFrame(o){this.layersGotHidden=!1;for(const d of this.layers){const y=d.layer;let S=!1;y.type==="fill-extrusion"?S=!y.isHidden(o)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(S=!y.isHidden(o)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!S&&d.visible,d.visible=S}}updateZOffset(o,d){this.currentBuildingBuckets=[];for(const S of this.layers){const P=S.layer,M=this.style.getLayerSourceCache(P);let D=1;P.type==="fill-extrusion"&&(D=S.visible?P.paint.get("fill-extrusion-vertical-scale"):0);let G=M?M.getTile(d):null;if(!G&&M&&d.canonical.z>M.getSource().minzoom){let K=d.scaledTo(Math.min(M.getSource().maxzoom,d.overscaledZ-1));for(;K.overscaledZ>=M.getSource().minzoom&&(G=M.getTile(K),!G&&K.overscaledZ!==0);)K=K.scaledTo(K.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:G?G.getBucket(P):null,tileID:G?G.tileID:d,verticalScale:D})}o.hasAnyZOffset=!1;let y=!1;for(let S=0;S<o.symbolInstances.length;S++){const P=o.symbolInstances.get(S),M=P.zOffset,D=this._getHeightAtTileOffset(d,P.tileAnchorX,P.tileAnchorY);P.zOffset=D!==Number.NEGATIVE_INFINITY?D:M,y||M===P.zOffset||(y=!0),o.hasAnyZOffset||P.zOffset===0||(o.hasAnyZOffset=!0)}y&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,d,y,S){let P=d,M=y;if(o.canonical.z!==S.canonical.z){const D=S.canonical,G=1/(1<<o.canonical.z-D.z);P=(d+o.canonical.x*i.ag)*G-D.x*i.ag|0,M=(y+o.canonical.y*i.ag)*G-D.y*i.ag|0}return{tileX:P,tileY:M}}_getHeightAtTileOffset(o,d,y){let S,P;for(let M=0;M<this.layers.length;++M){if(this.layers[M].layer.type!=="fill-extrusion")continue;const{bucket:D,tileID:G,verticalScale:K}=this.currentBuildingBuckets[M];if(!D)continue;const{tileX:Y,tileY:te}=this._mapCoordToOverlappingTile(o,d,y,G),re=D.getHeightAtTileCoord(Y,te);re&&re.height!==void 0&&(re.hidden?S=re.height:P=Math.max(re.height*K,P||0))}if(P!==void 0)return P;for(let M=0;M<this.layers.length;++M){const D=this.layers[M];if(D.layer.type!=="model"||!D.visible)continue;const{bucket:G,tileID:K}=this.currentBuildingBuckets[M];if(!G)continue;const{tileX:Y,tileY:te}=this._mapCoordToOverlappingTile(o,d,y,K),re=G.getHeightAtTileCoord(Y,te);if(re&&!re.hidden)return re.height===void 0&&S!==void 0?Math.min(re.maxHeight,S)*re.verticalScale:re.height?re.height*re.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Nu(g,o){const d={};for(const y in g)y!=="ref"&&(d[y]=g[y]);return i.bm.forEach(y=>{y in o&&(d[y]=o[y])}),d}function Ru(g){g=g.slice();const o=Object.create(null);for(let d=0;d<g.length;d++)o[g[d].id]=g[d];for(let d=0;d<g.length;d++)"ref"in g[d]&&(g[d]=Nu(g[d],o[g[d].ref]));return g}const hn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Cm(g,o,d){d.push({command:hn.addSource,args:[g,o[g]]})}function Iu(g,o,d){o.push({command:hn.removeSource,args:[g]}),d[g]=!0}function wr(g,o,d,y){Iu(g,d,y),Cm(g,o,d)}function mi(g,o,d){let y;for(y in g[d])if(g[d].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[d][y],o[d][y]))return!1;for(y in o[d])if(o[d].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[d][y],o[d][y]))return!1;return!0}function Gn(g,o,d,y,S,P){let M;for(M in o=o||{},g=g||{})g.hasOwnProperty(M)&&(i.bn(g[M],o[M])||d.push({command:P,args:[y,M,o[M],S]}));for(M in o)o.hasOwnProperty(M)&&!g.hasOwnProperty(M)&&(i.bn(g[M],o[M])||d.push({command:P,args:[y,M,o[M],S]}))}function hs(g){return g.id}function fc(g,o){return g[o.id]=o,g}class ai{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=i.aw(o,0,1);let d=1,y=this._distances[d];const S=o*this.paddedLength+this.padding;for(;y<S&&d<this._distances.length;)y=this._distances[++d];const P=d-1,M=this._distances[P],D=y-M,G=D>0?(S-M)/D:0;return this.points[P].mult(1-G).add(this.points[d].mult(G))}}class qc{constructor(o,d,y){const S=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(o/y),this.yCellCount=Math.ceil(d/y);for(let M=0;M<this.xCellCount*this.yCellCount;M++)S.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,y,S,P){this._forEachCell(d,y,S,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(P)}insertCircle(o,d,y,S){this._forEachCell(d-S,y-S,d+S,y+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(y),this.circles.push(S)}_insertBoxCell(o,d,y,S,P,M){this.boxCells[P].push(M)}_insertCircleCell(o,d,y,S,P,M){this.circleCells[P].push(M)}_query(o,d,y,S,P,M){if(y<0||o>this.width||S<0||d>this.height)return!P&&[];const D=[];if(o<=0&&d<=0&&this.width<=y&&this.height<=S){if(P)return!0;for(let G=0;G<this.boxKeys.length;G++)D.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const K=this.circles[3*G],Y=this.circles[3*G+1],te=this.circles[3*G+2];D.push({key:this.circleKeys[G],x1:K-te,y1:Y-te,x2:K+te,y2:Y+te})}return M?D.filter(M):D}return this._forEachCell(o,d,y,S,this._queryCell,D,{hitTest:P,seenUids:{box:{},circle:{}}},M),P?D.length>0:D}_queryCircle(o,d,y,S,P){const M=o-y,D=o+y,G=d-y,K=d+y;if(D<0||M>this.width||K<0||G>this.height)return!S&&[];const Y=[];return this._forEachCell(M,G,D,K,this._queryCellCircle,Y,{hitTest:S,circle:{x:o,y:d,radius:y},seenUids:{box:{},circle:{}}},P),S?Y.length>0:Y}query(o,d,y,S,P){return this._query(o,d,y,S,!1,P)}hitTest(o,d,y,S,P){return this._query(o,d,y,S,!0,P)}hitTestCircle(o,d,y,S){return this._queryCircle(o,d,y,!0,S)}_queryCell(o,d,y,S,P,M,D,G){const K=D.seenUids,Y=this.boxCells[P];if(Y!==null){const re=this.bboxes;for(const oe of Y)if(!K.box[oe]){K.box[oe]=!0;const ve=4*oe;if(o<=re[ve+2]&&d<=re[ve+3]&&y>=re[ve+0]&&S>=re[ve+1]&&(!G||G(this.boxKeys[oe]))){if(D.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[oe],x1:re[ve],y1:re[ve+1],x2:re[ve+2],y2:re[ve+3]})}}}const te=this.circleCells[P];if(te!==null){const re=this.circles;for(const oe of te)if(!K.circle[oe]){K.circle[oe]=!0;const ve=3*oe;if(this._circleAndRectCollide(re[ve],re[ve+1],re[ve+2],o,d,y,S)&&(!G||G(this.circleKeys[oe]))){if(D.hitTest)return M.push(!0),!0;{const fe=re[ve],be=re[ve+1],xe=re[ve+2];M.push({key:this.circleKeys[oe],x1:fe-xe,y1:be-xe,x2:fe+xe,y2:be+xe})}}}}}_queryCellCircle(o,d,y,S,P,M,D,G){const K=D.circle,Y=D.seenUids,te=this.boxCells[P];if(te!==null){const oe=this.bboxes;for(const ve of te)if(!Y.box[ve]){Y.box[ve]=!0;const fe=4*ve;if(this._circleAndRectCollide(K.x,K.y,K.radius,oe[fe+0],oe[fe+1],oe[fe+2],oe[fe+3])&&(!G||G(this.boxKeys[ve])))return M.push(!0),!0}}const re=this.circleCells[P];if(re!==null){const oe=this.circles;for(const ve of re)if(!Y.circle[ve]){Y.circle[ve]=!0;const fe=3*ve;if(this._circlesCollide(oe[fe],oe[fe+1],oe[fe+2],K.x,K.y,K.radius)&&(!G||G(this.circleKeys[ve])))return M.push(!0),!0}}}_forEachCell(o,d,y,S,P,M,D,G){const K=this._convertToXCellCoord(o),Y=this._convertToYCellCoord(d),te=this._convertToXCellCoord(y),re=this._convertToYCellCoord(S);for(let oe=K;oe<=te;oe++)for(let ve=Y;ve<=re;ve++)if(P.call(this,o,d,y,S,this.xCellCount*ve+oe,M,D,G))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,y,S,P,M){const D=S-o,G=P-d,K=y+M;return K*K>D*D+G*G}_circleAndRectCollide(o,d,y,S,P,M,D){const G=(M-S)/2,K=Math.abs(o-(S+G));if(K>G+y)return!1;const Y=(D-P)/2,te=Math.abs(d-(P+Y));if(te>Y+y)return!1;if(K<=G||te<=Y)return!0;const re=K-G,oe=te-Y;return re*re+oe*oe<=y*y}}const Bo={unknown:0,flipRequired:1,flipNotRequired:2},pc=Math.tan(85*Math.PI/180);function qa(g,o,d,y,S,P,M){const D=i.ab.mat4.create();if(d)if(P.name==="globe"){const G=i.bo(S,o);i.ab.mat4.multiply(D,D,G)}else{const G=i.ab.mat2.invert([],M);D[0]=G[0],D[1]=G[1],D[4]=G[2],D[5]=G[3],y||i.ab.mat4.rotateZ(D,D,S.angle)}else i.ab.mat4.multiply(D,S.labelPlaneMatrix,g);return D}function fa(g,o,d,y,S,P,M){const D=qa(g,o,d,y,S,P,M);return P.name==="globe"&&d||(D[2]=D[6]=D[10]=D[14]=0),D}function fy(g,o,d,y,S,P,M){if(d){if(P.name==="globe"){const D=qa(g,o,d,y,S,P,M);return i.ab.mat4.invert(D,D),i.ab.mat4.multiply(D,g,D),D}{const D=i.ab.mat4.clone(g),G=i.ab.mat4.identity([]);return G[0]=M[0],G[1]=M[1],G[4]=M[2],G[5]=M[3],i.ab.mat4.multiply(D,D,G),y||i.ab.mat4.rotateZ(D,D,-S.angle),D}}return S.glCoordMatrix}function qs(g,o,d,y){const S=[g,o,d,1];d?i.ab.vec4.transformMat4(S,S,y):Ea(S,S,y);const P=S[3];return S[0]/=P,S[1]/=P,S[2]/=P,S}function jd(g,o){return Math.min(.5+g/o*.5,1.5)}function Od(g,o){const d=g[0]/g[3],y=g[1]/g[3];return d>=-o[0]&&d<=o[0]&&y>=-o[1]&&y<=o[1]}function up(g,o,d,y,S,P,M,D,G,K){const Y=d.transform,te=y?g.textSizeData:g.iconSizeData,re=i.bp(te,d.transform.zoom),oe=Y.projection.name==="globe",ve=[256/d.width*2+1,256/d.height*2+1],fe=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;fe.clear();let be=null;oe&&(be=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const xe=g.lineVertexArray,Ce=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,Ue=d.transform.width/d.transform.height;let Be,Xe=!1;for(let qe=0;qe<Ce.length;qe++){const We=Ce.get(qe),{numGlyphs:$e,writingMode:Ke}=We;if(Ke!==i.bq.vertical||Xe||Be===i.bq.horizontal||(Xe=!0),Be=Ke,(We.hidden||Ke===i.bq.vertical)&&!Xe){ta($e,fe);continue}Xe=!1;const it=new i.P(We.tileAnchorX,We.tileAnchorY);let{x:_t,y:mt,z:Mt}=Y.projection.projectTilePoint(it.x,it.y,K.canonical);if(G){const[It,Ht,tr]=G(it);_t+=It,mt+=Ht,Mt+=tr}const jt=[_t,mt,Mt,1];if(i.ab.vec4.transformMat4(jt,jt,o),!Od(jt,ve)){ta($e,fe);continue}const dt=jt[3],Et=jd(d.transform.getCameraToCenterDistance(Y.projection),dt),Ut=i.br(te,re,We),pt=M?Ut/Et:Ut*Et,Dt=qs(_t,mt,Mt,S);if(Dt[3]<=0){ta($e,fe);continue}let kt={};const Yt=M?null:G,Bt=ll(We,pt,!1,D,o,S,P,g.glyphOffsetArray,xe,fe,be,Dt,it,kt,Ue,Yt,Y.projection,K,M);Xe=Bt.useVertical,Yt&&Bt.needsFlipping&&(kt={}),(Bt.notEnoughRoom||Xe||Bt.needsFlipping&&ll(We,pt,!0,D,o,S,P,g.glyphOffsetArray,xe,fe,be,Dt,it,kt,Ue,Yt,Y.projection,K,M).notEnoughRoom)&&ta($e,fe)}y?(g.text.dynamicLayoutVertexBuffer.updateData(fe),be&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(be)):(g.icon.dynamicLayoutVertexBuffer.updateData(fe),be&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(be))}function Sl(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe){const{lineStartIndex:be,glyphStartIndex:xe,segment:Ce}=D,Ue=xe+D.numGlyphs,Be=be+D.lineLength,Xe=o.getoffsetX(xe),qe=o.getoffsetX(Ue-1),We=Al(g*Xe,d,y,S,P,M,Ce,be,Be,G,K,Y,te,re,!0,oe,ve,fe);if(!We)return null;const $e=Al(g*qe,d,y,S,P,M,Ce,be,Be,G,K,Y,te,re,!0,oe,ve,fe);return $e?{first:We,last:$e}:null}function As(g,o,d,y){return g===i.bq.horizontal&&Math.abs(y)>Math.abs(d)?{useVertical:!0}:g===i.bq.vertical?y>0?{needsFlipping:!0}:null:o!==Bo.unknown&&function(S,P){return S===0||Math.abs(P/S)>pc}(d,y)?o===Bo.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function ll(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe,Ce){const Ue=o/24,Be=g.lineOffsetX*Ue,Xe=g.lineOffsetY*Ue,{lineStartIndex:qe,glyphStartIndex:We,numGlyphs:$e,segment:Ke,writingMode:it,flipState:_t}=g,mt=qe+g.lineLength,Mt=jt=>{if(Y){const[pt,Dt,kt]=jt.up,Yt=K.length;i.bs(Y,Yt+0,pt,Dt,kt),i.bs(Y,Yt+1,pt,Dt,kt),i.bs(Y,Yt+2,pt,Dt,kt),i.bs(Y,Yt+3,pt,Dt,kt)}const[dt,Et,Ut]=jt.point;i.bt(K,dt,Et,Ut,jt.angle)};if($e>1){const jt=Sl(Ue,D,Be,Xe,d,te,re,g,G,P,oe,fe,!1,be,xe,Ce);if(!jt)return{notEnoughRoom:!0};if(y&&!d){let[dt,Et,Ut]=jt.first.point,[pt,Dt,kt]=jt.last.point;[dt,Et]=qs(dt,Et,Ut,M),[pt,Dt]=qs(pt,Dt,kt,M);const Yt=As(it,_t,(pt-dt)*ve,Dt-Et);if(g.flipState=Yt&&Yt.needsFlipping?Bo.flipRequired:Bo.flipNotRequired,Yt)return Yt}Mt(jt.first);for(let dt=We+1;dt<We+$e-1;dt++){const Et=Al(Ue*D.getoffsetX(dt),Be,Xe,d,te,re,Ke,qe,mt,G,P,oe,fe,!1,!1,be,xe,Ce);if(!Et)return K.length-=4*(dt-We),{notEnoughRoom:!0};Mt(Et)}Mt(jt.last)}else{if(y&&!d){const dt=qs(re.x,re.y,0,S),Et=qe+Ke+1,Ut=new i.P(G.getx(Et),G.gety(Et)),pt=qs(Ut.x,Ut.y,0,S),Dt=pt[3]>0?pt:Hh(re,Ut,dt,1,S,void 0,be,xe.canonical),kt=As(it,_t,(Dt[0]-dt[0])*ve,Dt[1]-dt[1]);if(g.flipState=kt&&kt.needsFlipping?Bo.flipRequired:Bo.flipNotRequired,kt)return kt}const jt=Al(Ue*D.getoffsetX(We),Be,Xe,d,te,re,Ke,qe,mt,G,P,oe,fe,!1,!1,be,xe,Ce);if(!jt)return{notEnoughRoom:!0};Mt(jt)}return{}}function Ts(g,o,d,y,S){const{x:P,y:M,z:D}=y.projectTilePoint(g.x,g.y,o);if(!S)return qs(P,M,D,d);const[G,K,Y]=S(g);return qs(P+G,M+K,D+Y,d)}function Hh(g,o,d,y,S,P,M,D){const G=Ts(g.sub(o)._unit()._add(g),D,S,M,P);return i.ab.vec3.sub(G,d,G),i.ab.vec3.normalize(G,G),i.ab.vec3.scaleAndAdd(G,d,G,y)}function Al(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe){const Ce=y?g-o:g+o;let Ue=Ce>0?1:-1,Be=0;y&&(Ue*=-1,Be=Math.PI),Ue<0&&(Be+=Math.PI);let Xe=D+M+(Ue>0?0:1)|0,qe=S,We=S,$e=0,Ke=0;const it=Math.abs(Ce),_t=[],mt=[];let Mt=P,jt=Mt;const dt=()=>Hh(jt,Mt,We,it-$e+1,Y,re,fe,be.canonical);for(;$e+Ke<=it;){if(Xe+=Ue,Xe<D||Xe>=G)return null;if(We=qe,jt=Mt,_t.push(We),oe&&mt.push(jt),Mt=new i.P(K.getx(Xe),K.gety(Xe)),qe=te[Xe],!qe){const Ht=Ts(Mt,be.canonical,Y,fe,re);qe=Ht[3]>0?te[Xe]=Ht:dt()}$e+=Ke,Ke=i.ab.vec3.distance(We,qe)}ve&&re&&(te[Xe]&&(qe=dt(),Ke=i.ab.vec3.distance(We,qe)),te[Xe]=qe);const Et=(it-$e)/Ke,Ut=Mt.sub(jt)._mult(Et)._add(jt),pt=i.ab.vec3.sub([],qe,We),Dt=i.ab.vec3.scaleAndAdd([],We,pt,Et);let kt=[0,0,1],Yt=pt[0],Bt=pt[1];if(xe&&(kt=fe.upVector(be.canonical,Ut.x,Ut.y),kt[0]!==0||kt[1]!==0||kt[2]!==1)){const Ht=[kt[2],0,-kt[0]],tr=i.ab.vec3.cross([],kt,Ht);i.ab.vec3.normalize(Ht,Ht),i.ab.vec3.normalize(tr,tr),Yt=i.ab.vec3.dot(pt,Ht),Bt=i.ab.vec3.dot(pt,tr)}if(d){const Ht=i.ab.vec3.cross([],kt,pt);i.ab.vec3.normalize(Ht,Ht),i.ab.vec3.scaleAndAdd(Dt,Dt,Ht,d*Ue)}const It=Be+Math.atan2(Bt,Yt);return _t.push(Dt),oe&&mt.push(Ut),{point:Dt,angle:It,path:_t,tilePath:mt,up:kt}}function ta(g,o){const d=o.length,y=d+4*g;o.resize(y),o.float32.fill(-1/0,4*d,4*y)}function Ea(g,o,d){const y=o[0],S=o[1];return g[0]=d[0]*y+d[4]*S+d[12],g[1]=d[1]*y+d[5]*S+d[13],g[3]=d[3]*y+d[7]*S+d[15],g}const ka=100;class pa{constructor(o,d,y=new qc(o.width+200,o.height+200,25),S=new qc(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=S,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ka,this.screenBottomBoundary=o.height+ka,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=d}placeCollisionBox(o,d,y,S,P,M,D,G){let K=y.projectedAnchorX,Y=y.projectedAnchorY,te=y.projectedAnchorZ;const re=y.elevation,oe=y.tileID,ve=o.getProjection();if(re&&oe){const[qe,We,$e]=ve.upVector(oe.canonical,y.tileAnchorX,y.tileAnchorY),Ke=ve.upVectorScale(oe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;K+=qe*re*Ke,Y+=We*re*Ke,te+=$e*re*Ke}const fe=this.projectAndGetPerspectiveRatio(D,K,Y,te,y.tileID,ve.name==="globe"||!!re||this.transform.pitch>0,ve),be=M*fe.perspectiveRatio,xe=(y.x1*d+S.x-y.padding)*be+fe.point.x,Ce=(y.y1*d+S.y-y.padding)*be+fe.point.y,Ue=(y.x2*d+S.x+y.padding)*be+fe.point.x,Be=(y.y2*d+S.y+y.padding)*be+fe.point.y,Xe=fe.perspectiveRatio<=.55||fe.occluded;return!this.isInsideGrid(xe,Ce,Ue,Be)||!P&&this.grid.hitTest(xe,Ce,Ue,Be,G)||Xe?{box:[],offscreen:!1,occluded:fe.occluded}:{box:[xe,Ce,Ue,Be],offscreen:this.isOffscreen(xe,Ce,Ue,Be),occluded:!1}}placeCollisionCircles(o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe){const be=[],xe=this.transform.elevation,Ce=o.getProjection(),Ue=xe?xe.getAtTileOffsetFunc(fe,this.transform.center.lat,this.transform.worldSize,Ce):null,Be=new i.P(y.tileAnchorX,y.tileAnchorY);let{x:Xe,y:qe,z:We}=Ce.projectTilePoint(Be.x,Be.y,fe.canonical);if(Ue){const[Ut,pt,Dt]=Ue(Be);Xe+=Ut,qe+=pt,We+=Dt}const $e=Ce.name==="globe",Ke=this.projectAndGetPerspectiveRatio(D,Xe,qe,We,fe,$e||!!xe||this.transform.pitch>0,Ce),{perspectiveRatio:it}=Ke,_t=(te?M/it:M*it)/i.bw,mt=qs(Xe,qe,We,G),Mt=Ke.signedDistanceFromCamera>0?Sl(_t,P,y.lineOffsetX*_t,y.lineOffsetY*_t,!1,mt,Be,y,S,G,{},xe&&!te?Ue:null,te&&!!xe,Ce,fe,te):null;let jt=!1,dt=!1,Et=!0;if(Mt&&!Ke.occluded){const Ut=.5*oe*it+ve,pt=new i.P(-100,-100),Dt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),kt=new ai,{first:Yt,last:Bt}=Mt,It=Yt.path.length;let Ht=[];for(let _r=It-1;_r>=1;_r--)Ht.push(Yt.path[_r]);for(let _r=1;_r<Bt.path.length;_r++)Ht.push(Bt.path[_r]);const tr=2.5*Ut;K&&(Ht=Ht.map(([_r,qr,jr],Ir)=>(Ue&&!$e&&(jr=Ue(Ir<It-1?Yt.tilePath[It-1-Ir]:Bt.tilePath[Ir-It+2])[2]),qs(_r,qr,jr,K))),Ht.some(_r=>_r[3]<=0)&&(Ht=[]));let gr=[];if(Ht.length>0){let _r=1/0,qr=-1/0,jr=1/0,Ir=-1/0;for(const Hr of Ht)_r=Math.min(_r,Hr[0]),jr=Math.min(jr,Hr[1]),qr=Math.max(qr,Hr[0]),Ir=Math.max(Ir,Hr[1]);qr>=pt.x&&_r<=Dt.x&&Ir>=pt.y&&jr<=Dt.y&&(gr=[Ht.map(Hr=>new i.P(Hr[0],Hr[1]))],(_r<pt.x||qr>Dt.x||jr<pt.y||Ir>Dt.y)&&(gr=i.bu(gr,pt.x,pt.y,Dt.x,Dt.y)))}for(const _r of gr){kt.reset(_r,.25*Ut);let qr=0;qr=kt.length<=.5*Ut?1:Math.ceil(kt.paddedLength/tr)+1;for(let jr=0;jr<qr;jr++){const Ir=jr/Math.max(qr-1,1),Hr=kt.lerp(Ir),Mn=Hr.x+ka,di=Hr.y+ka;be.push(Mn,di,Ut,0);const Gi=Mn-Ut,Zn=di-Ut,Zr=Mn+Ut,wn=di+Ut;if(Et=Et&&this.isOffscreen(Gi,Zn,Zr,wn),dt=dt||this.isInsideGrid(Gi,Zn,Zr,wn),!d&&this.grid.hitTestCircle(Mn,di,Ut,re)&&(jt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:jt,occluded:!1}}}}return{circles:!Y&&jt||!dt?[]:be,offscreen:Et,collisionDetected:jt,occluded:Ke.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let y=1/0,S=1/0,P=-1/0,M=-1/0;for(const Y of o){const te=new i.P(Y.x+ka,Y.y+ka);y=Math.min(y,te.x),S=Math.min(S,te.y),P=Math.max(P,te.x),M=Math.max(M,te.y),d.push(te)}const D=this.grid.query(y,S,P,M).concat(this.ignoredGrid.query(y,S,P,M)),G={},K={};for(const Y of D){const te=Y.key;if(G[te.bucketInstanceId]===void 0&&(G[te.bucketInstanceId]={}),G[te.bucketInstanceId][te.featureIndex])continue;const re=[new i.P(Y.x1,Y.y1),new i.P(Y.x2,Y.y1),new i.P(Y.x2,Y.y2),new i.P(Y.x1,Y.y2)];i.bv(d,re)&&(G[te.bucketInstanceId][te.featureIndex]=!0,K[te.bucketInstanceId]===void 0&&(K[te.bucketInstanceId]=[]),K[te.bucketInstanceId].push(te.featureIndex))}return K}insertCollisionBox(o,d,y,S,P){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:S,collisionGroupID:P},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,y,S,P){const M=d?this.ignoredGrid:this.grid,D={bucketInstanceId:y,featureIndex:S,collisionGroupID:P};for(let G=0;G<o.length;G+=4)M.insertCircle(D,o[G],o[G+1],o[G+2])}projectAndGetPerspectiveRatio(o,d,y,S,P,M,D){const G=[d,y,S,1];let K=!1;S||this.transform.pitch>0?(i.ab.vec4.transformMat4(G,G,o),this.fogState&&P&&D.name!=="globe"&&(K=function(re,oe,ve,fe,be,xe){const Ce=xe.calculateFogTileMatrix(be),Ue=[oe,ve,fe];return i.ab.vec3.transformMat4(Ue,Ue,Ce),at(re,i.ab.vec3.length(Ue),xe.pitch,xe._fov)}(this.fogState,d,y,S,P.toUnwrapped(),this.transform)>.9)):Ea(G,G,o);const Y=G[3];return{point:new i.P((G[0]/Y+1)/2*this.transform.width+ka,(-G[1]/Y+1)/2*this.transform.height+ka),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:M&&G[2]>Y||K}}isOffscreen(o,d,y,S){return y<ka||o>=this.screenRightBoundary||S<ka||d>this.screenBottomBoundary}isInsideGrid(o,d,y,S){return y>=0&&o<this.gridRightBoundary&&S>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=i.ab.mat4.identity([]);return i.ab.mat4.translate(o,o,[-100,-100,0]),o}}function Gc(g,o,d){const y=o.createTileMatrix(g,g.worldSize,d.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),g.projMatrix,y)}function Wl(g,o,d){if(o.projection.name===d.projection.name)return g.projMatrix;const y=d.clone();return y.setProjection(o.projection),Gc(y,o.getProjection(),g)}function Wc(g,o,d){return o.name===d.projection.name?g.projMatrix:Gc(d,o,g)}class Nd{constructor(o,d,y,S){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):S&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class vo{constructor(o,d,y,S,P,M=!1){this.text=new Nd(o?o.text:null,d,y,P),this.icon=new Nd(o?o.icon:null,d,S,P),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Kh{constructor(o,d,y,S=!1){this.text=o,this.icon=d,this.skipFade=y,this.clipped=S}}class mc{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class I_{constructor(o,d,y,S,P){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=S,this.tileID=P}}class py{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[o]}}function xo(g,o,d,y,S){const{horizontalAlign:P,verticalAlign:M}=i.bD(g),D=-(P-.5)*o,G=-(M-.5)*d,K=i.bC(g,y);return new i.P(D+K[0]*S,G+K[1]*S)}function dp(g,o,d,y,S){const P=new i.P(g,o);return d&&P._rotate(y?S:-S),P}class Em{constructor(o,d,y,S,P,M){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new pa(this.transform,P),this.buildingIndex=M,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new py(y),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,y,S,P=1){const M=y.getBucket(d),D=y.latestFeatureIndex;if(!M||!D||d.fqid!==M.layerIds[0])return;const G=M.layers[0].layout,K=M.layers[0].paint,Y=y.collisionBoxArray,te=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),re=y.tileSize/i.ag,oe=y.tileID.toUnwrapped();this.transform.setProjection(M.projection);const ve=(fe=y.tileID,be=M.getProjection(),xe=this.transform,be.name===this.projection?xe.calculateProjMatrix(fe.toUnwrapped()):Gc(xe,be,fe));var fe,be,xe;const Ce=G.get("text-pitch-alignment")==="map",Ue=G.get("text-rotation-alignment")==="map";d.compileFilter(d.options);const Be=d.dynamicFilter(),Xe=d.dynamicFilterNeedsFeature(),qe=this.transform.calculatePixelsToTileUnitsMatrix(y),We=fa(ve,y.tileID.canonical,Ce,Ue,this.transform,M.getProjection(),qe);let $e=null;if(Ce){const Ut=fy(ve,y.tileID.canonical,Ce,Ue,this.transform,M.getProjection(),qe);$e=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Ut)}let Ke=null;Be&&y.latestFeatureIndex&&(Ke={unwrappedTileID:oe,dynamicFilter:Be,dynamicFilterNeedsFeature:Xe}),this.retainedQueryData[M.bucketInstanceId]=new I_(M.bucketInstanceId,D,M.sourceLayerIndex,M.index,y.tileID);const[it,_t]=M.layers[0].layout.get("text-size-scale-range"),mt=i.aw(P,it,_t),[Mt,jt]=G.get("icon-size-scale-range"),dt=i.aw(P,Mt,jt),Et={bucket:M,layout:G,paint:K,posMatrix:ve,textLabelPlaneMatrix:We,labelToScreenMatrix:$e,clippingData:Ke,scale:te,textPixelRatio:re,holdingForFade:y.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:i.bp(M.textSizeData,this.transform.zoom,mt),partiallyEvaluatedIconSize:i.bp(M.iconSizeData,this.transform.zoom,dt),collisionGroup:this.collisionGroups.get(M.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(S)for(const Ut of M.sortKeyRanges){const{sortKey:pt,symbolInstanceStart:Dt,symbolInstanceEnd:kt}=Ut;o.push({sortKey:pt,symbolInstanceStart:Dt,symbolInstanceEnd:kt,parameters:Et})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Et})}attemptAnchorPlacement(o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe,Ce){const{textOffset0:Ue,textOffset1:Be,crossTileID:Xe}=re,qe=[Ue,Be],We=xo(o,y,S,qe,P),$e=this.collisionIndex.placeCollisionBox(ve,P,d,dp(We.x,We.y,M,D,this.transform.angle),te,G,K,Y.predicate);if(be){const Ke=ve.getSymbolInstanceIconSize(Ce,this.transform.zoom,re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ve,Ke,be,dp(We.x,We.y,M,D,this.transform.angle),te,G,K,Y.predicate).box.length===0)return}if($e.box.length>0){let Ke;return this.prevPlacement&&this.prevPlacement.variableOffsets[Xe]&&this.prevPlacement.placements[Xe]&&this.prevPlacement.placements[Xe].text&&(Ke=this.prevPlacement.variableOffsets[Xe].anchor),this.variableOffsets[Xe]={textOffset:qe,width:y,height:S,anchor:o,textScale:P,prevAnchor:Ke},this.markUsedJustification(ve,o,re,fe),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,fe,re),this.placedOrientations[Xe]=fe),{shift:We,placedGlyphBoxes:$e}}}placeLayerBucketPart(o,d,y,S,P=1){const{bucket:M,layout:D,paint:G,posMatrix:K,textLabelPlaneMatrix:Y,labelToScreenMatrix:te,clippingData:re,textPixelRatio:oe,holdingForFade:ve,collisionBoxArray:fe,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:xe,collisionGroup:Ce,latestFeatureIndex:Ue}=o.parameters,Be=D.get("text-optional"),Xe=D.get("icon-optional"),qe=D.get("text-allow-overlap"),We=D.get("icon-allow-overlap"),$e=D.get("text-rotation-alignment")==="map",Ke=D.get("text-pitch-alignment")==="map",it=D.get("symbol-z-elevate"),_t=G.get("symbol-z-offset"),mt=D.get("symbol-elevation-reference")==="sea",[Mt,jt]=D.get("text-size-scale-range"),[dt,Et]=D.get("icon-size-scale-range"),Ut=i.aw(P,Mt,jt),pt=i.aw(P,dt,Et);this.transform.setProjection(M.projection);let Dt=qe&&(We||!M.hasIconData()||Xe),kt=We&&(qe||!M.hasTextData()||Be);const Yt=!_t.isConstant();!M.collisionArrays&&fe&&M.deserializeCollisionBoxes(fe),y&&S&&M.updateCollisionDebugBuffers(this.transform.zoom,fe,Ut,pt);const Bt=(It,Ht,tr)=>{const{crossTileID:gr,numVerticalGlyphVertices:_r}=It;let qr=null;if(re&&re.dynamicFilterNeedsFeature||Yt){const Pi=this.retainedQueryData[M.bucketInstanceId];qr=Ue.loadFeature({featureIndex:It.featureIndex,bucketIndex:Pi.bucketIndex,sourceLayerIndex:Pi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(re&&!(0,re.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},qr,this.retainedQueryData[M.bucketInstanceId].tileID.canonical,new i.P(It.tileAnchorX,It.tileAnchorY),this.transform.calculateDistanceTileData(re.unwrappedTileID)))return this.placements[gr]=new Kh(!1,!1,!1,!0),void d.add(gr);const jr=_t.evaluate(qr,{});if(d.has(gr))return;if(ve)return void(this.placements[gr]=new Kh(!1,!1,!1));let Ir=!1,Hr=!1,Mn=!0,di=!1,Gi=!1,Zn=null,Zr={box:null,offscreen:null,occluded:null},wn={box:null},Sr=null,kn=null,ei=null,si=0,Qi=0,na=0;tr.textFeatureIndex?si=tr.textFeatureIndex:It.useRuntimeCollisionCircles&&(si=It.featureIndex),tr.verticalTextFeatureIndex&&(Qi=tr.verticalTextFeatureIndex);const Ma=Pi=>{Pi.tileID=this.retainedQueryData[M.bucketInstanceId].tileID;const _i=this.transform.elevation;Pi.elevation=mt?jr:jr+(_i?_i.getAtTileOffset(Pi.tileID,Pi.tileAnchorX,Pi.tileAnchorY):0),Pi.elevation+=It.zOffset},ba=tr.textBox;if(ba){Ma(ba);const Pi=Nn=>{let ia=i.bq.horizontal;if(M.allowVerticalPlacement&&!Nn&&this.prevPlacement){const is=this.prevPlacement.placedOrientations[gr];is&&(this.placedOrientations[gr]=is,ia=is,this.markUsedOrientation(M,ia,It))}return ia},_i=(Nn,ia)=>{if(M.allowVerticalPlacement&&_r>0&&tr.verticalTextBox){for(const is of M.writingModes)if(is===i.bq.vertical?(Zr=ia(),wn=Zr):Zr=Nn(),Zr&&Zr.box&&Zr.box.length)break}else Zr=Nn()};if(D.get("text-variable-anchor")){let Nn=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[gr]){const Ci=this.prevPlacement.variableOffsets[gr];Nn.indexOf(Ci.anchor)>0&&(Nn=Nn.filter(Ds=>Ds!==Ci.anchor),Nn.unshift(Ci.anchor))}const ia=(Ci,Ds,gl)=>{const gs=M.getSymbolInstanceTextSize(be,It,this.transform.zoom,Ht),Po=(Ci.x2-Ci.x1)*gs+2*Ci.padding,Co=(Ci.y2-Ci.y1)*gs+2*Ci.padding,yl=It.hasIconTextFit&&!We?Ds:null;yl&&Ma(yl);let Ni={box:[],offscreen:!1,occluded:!1};const uh=qe?2*Nn.length:Nn.length;for(let Ql=0;Ql<uh;++Ql){const dh=this.attemptAnchorPlacement(Nn[Ql%Nn.length],Ci,Po,Co,gs,$e,Ke,oe,K,Ce,Ql>=Nn.length,It,Ht,M,gl,yl,be,xe);if(dh&&(Ni=dh.placedGlyphBoxes,Ni&&Ni.box&&Ni.box.length)){Ir=!0,Zn=dh.shift;break}}return Ni};_i(()=>ia(ba,tr.iconBox,i.bq.horizontal),()=>{const Ci=tr.verticalTextBox;return Ci&&Ma(Ci),M.allowVerticalPlacement&&!(Zr&&Zr.box&&Zr.box.length)&&_r>0&&Ci?ia(Ci,tr.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Zr&&(Ir=Zr.box,Mn=Zr.offscreen,di=Zr.occluded);const is=Pi(!(!Zr||!Zr.box));if(!Ir&&this.prevPlacement){const Ci=this.prevPlacement.variableOffsets[gr];Ci&&(this.variableOffsets[gr]=Ci,this.markUsedJustification(M,Ci.anchor,It,is))}}else{const Nn=(ia,is)=>{const Ci=M.getSymbolInstanceTextSize(be,It,this.transform.zoom,Ht,P),Ds=this.collisionIndex.placeCollisionBox(M,Ci,ia,new i.P(0,0),qe,oe,K,Ce.predicate);return Ds&&Ds.box&&Ds.box.length&&(this.markUsedOrientation(M,is,It),this.placedOrientations[gr]=is),Ds};_i(()=>Nn(ba,i.bq.horizontal),()=>{const ia=tr.verticalTextBox;return M.allowVerticalPlacement&&_r>0&&ia?(Ma(ia),Nn(ia,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Pi(!!(Zr&&Zr.box&&Zr.box.length))}}if(Sr=Zr,Ir=Sr&&Sr.box&&Sr.box.length>0,Mn=Sr&&Sr.offscreen,di=Sr&&Sr.occluded,It.useRuntimeCollisionCircles){const Pi=M.text.placedSymbolArray.get(It.centerJustifiedTextSymbolIndex>=0?It.centerJustifiedTextSymbolIndex:It.verticalPlacedTextSymbolIndex),_i=i.br(M.textSizeData,be,Pi),Nn=D.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(M,qe,Pi,M.lineVertexArray,M.glyphOffsetArray,_i,K,Y,te,y,Ke,Ce.predicate,It.collisionCircleDiameter*_i/i.bw,Nn,this.retainedQueryData[M.bucketInstanceId].tileID),Ir=qe||kn.circles.length>0&&!kn.collisionDetected,Mn=Mn&&kn.offscreen,di=kn.occluded}if(tr.iconFeatureIndex&&(na=tr.iconFeatureIndex),tr.iconBox){const Pi=_i=>{Ma(_i);const Nn=It.hasIconTextFit&&Zn?dp(Zn.x,Zn.y,$e,Ke,this.transform.angle):new i.P(0,0),ia=M.getSymbolInstanceIconSize(xe,this.transform.zoom,It.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(M,ia,_i,Nn,We,oe,K,Ce.predicate)};wn&&wn.box&&wn.box.length&&tr.verticalIconBox?(ei=Pi(tr.verticalIconBox),Hr=ei.box.length>0):(ei=Pi(tr.iconBox),Hr=ei.box.length>0),Mn=Mn&&ei.offscreen,Gi=ei.occluded}const Es=Be||It.numHorizontalGlyphVertices===0&&_r===0,ks=Xe||It.numIconVertices===0;if(Es||ks?ks?Es||(Hr=Hr&&Ir):Ir=Hr&&Ir:Hr=Ir=Hr&&Ir,Ir&&Sr&&Sr.box&&this.collisionIndex.insertCollisionBox(Sr.box,D.get("text-ignore-placement"),M.bucketInstanceId,wn&&wn.box&&Qi?Qi:si,Ce.ID),Hr&&ei&&this.collisionIndex.insertCollisionBox(ei.box,D.get("icon-ignore-placement"),M.bucketInstanceId,na,Ce.ID),kn&&(Ir&&this.collisionIndex.insertCollisionCircles(kn.circles,D.get("text-ignore-placement"),M.bucketInstanceId,si,Ce.ID),y)){const Pi=M.bucketInstanceId;let _i=this.collisionCircleArrays[Pi];_i===void 0&&(_i=this.collisionCircleArrays[Pi]=new mc);for(let Nn=0;Nn<kn.circles.length;Nn+=4)_i.circles.push(kn.circles[Nn+0]),_i.circles.push(kn.circles[Nn+1]),_i.circles.push(kn.circles[Nn+2]),_i.circles.push(kn.collisionDetected?1:0)}const Oi=M.projection.name!=="globe";Dt=Dt&&(Oi||!di),kt=kt&&(Oi||!Gi),this.placements[gr]=new Kh(Ir||Dt,Hr||kt,Mn||M.justReloaded),d.add(gr)};if(it&&this.buildingIndex&&(this.buildingIndex.updateZOffset(M,this.retainedQueryData[M.bucketInstanceId].tileID),M.updateZOffset()),M.sortFeaturesByY){const It=M.getSortedSymbolIndexes(this.transform.angle);for(let Ht=It.length-1;Ht>=0;--Ht){const tr=It[Ht];Bt(M.symbolInstances.get(tr),tr,M.collisionArrays[tr])}M.hasAnyZOffset&&i.w(`${M.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(M.hasAnyZOffset){const It=M.getSortedIndexesByZOffset();for(let Ht=0;Ht<It.length;++Ht){const tr=It[Ht];Bt(M.symbolInstances.get(tr),tr,M.collisionArrays[tr])}}else for(let It=o.symbolInstanceStart;It<o.symbolInstanceEnd;It++)Bt(M.symbolInstances.get(It),It,M.collisionArrays[It]);if(y&&M.bucketInstanceId in this.collisionCircleArrays){const It=this.collisionCircleArrays[M.bucketInstanceId];i.ab.mat4.invert(It.invProjMatrix,K),It.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1}markUsedJustification(o,d,y,S){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:G,crossTileID:K}=y,Y=i.bB(d),te=S===i.bq.vertical?G:Y==="left"?P:Y==="center"?M:Y==="right"?D:-1;P>=0&&(o.text.placedSymbolArray.get(P).crossTileID=te>=0&&P!==te?0:K),M>=0&&(o.text.placedSymbolArray.get(M).crossTileID=te>=0&&M!==te?0:K),D>=0&&(o.text.placedSymbolArray.get(D).crossTileID=te>=0&&D!==te?0:K),G>=0&&(o.text.placedSymbolArray.get(G).crossTileID=te>=0&&G!==te?0:K)}markUsedOrientation(o,d,y){const S=d===i.bq.horizontal||d===i.bq.horizontalOnly?d:0,P=d===i.bq.vertical?d:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:K}=y,Y=o.text.placedSymbolArray;M>=0&&(Y.get(M).placedOrientation=S),D>=0&&(Y.get(D).placedOrientation=S),G>=0&&(Y.get(G).placedOrientation=S),K>=0&&(Y.get(K).placedOrientation=P)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const S=d?d.symbolFadeChange(o):1,P=d?d.opacities:{},M=d?d.variableOffsets:{},D=d?d.placedOrientations:{};for(const G in this.placements){const K=this.placements[G],Y=P[G];Y?(this.opacities[G]=new vo(Y,S,K.text,K.icon,null,K.clipped),y=y||K.text!==Y.text.placed||K.icon!==Y.icon.placed):(this.opacities[G]=new vo(null,S,K.text,K.icon,K.skipFade,K.clipped),y=y||K.text||K.icon)}for(const G in P){const K=P[G];if(!this.opacities[G]){const Y=new vo(K,S,!1,!1);Y.isHidden()||(this.opacities[G]=Y,y=y||K.text.placed||K.icon.placed)}}for(const G in M)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=M[G]);for(const G in D)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=D[G]);y?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d,y,S){const P=new Set;for(const M of d){const D=M.getBucket(o);D&&M.latestFeatureIndex&&o.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,P,M,M.collisionBoxArray,y,S,M.tileID,o.scope),D.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,M.tileID),D.updateZOffset()))}}updateBucketOpacities(o,d,y,S,P,M,D,G){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const K=o.layers[0].layout,Y=o.layers[0].paint,te=!!o.layers[0].dynamicFilter(),re=new vo(null,0,!1,!1,!0),oe=K.get("text-allow-overlap"),ve=K.get("icon-allow-overlap"),fe=K.get("text-variable-anchor"),be=K.get("text-rotation-alignment")==="map",xe=K.get("text-pitch-alignment")==="map",Ce=Y.get("symbol-z-offset"),Ue=K.get("symbol-elevation-reference")==="sea",Be=!Ce.isConstant(),Xe=new vo(null,0,oe&&(ve||!o.hasIconData()||K.get("icon-optional")),ve&&(oe||!o.hasTextData()||K.get("text-optional")),!0);!o.collisionArrays&&S&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(S);const qe=($e,Ke,it)=>{for(let _t=0;_t<Ke/4;_t++)$e.opacityVertexArray.emplaceBack(it)};let We=0;M&&o.updateReplacement(D,M);for(let $e=0;$e<o.symbolInstances.length;$e++){const Ke=o.symbolInstances.get($e),{numHorizontalGlyphVertices:it,numVerticalGlyphVertices:_t,crossTileID:mt,numIconVertices:Mt,tileAnchorX:jt,tileAnchorY:dt}=Ke;let Et=null;const Ut=this.retainedQueryData[o.bucketInstanceId];Be&&Ke&&Ut&&(Et=y.latestFeatureIndex.loadFeature({featureIndex:Ke.featureIndex,bucketIndex:Ut.bucketIndex,sourceLayerIndex:Ut.sourceLayerIndex,layoutVertexArrayOffset:0}));const pt=Ce.evaluate(Et,{}),Dt=d.has(mt);let kt=this.opacities[mt];Dt?kt=re:kt||(kt=Xe,this.opacities[mt]=kt),d.add(mt);const Yt=it>0||_t>0,Bt=Mt>0,It=this.placedOrientations[mt],Ht=It===i.bq.vertical,tr=It===i.bq.horizontal||It===i.bq.horizontalOnly;!Yt&&!Bt||kt.isHidden()||We++;let gr=!1;if((Yt||Bt)&&M)for(const _r of o.activeReplacements){if(i.bx(_r,P,i.by.Symbol,G)||_r.min.x>jt||jt>_r.max.x||_r.min.y>dt||dt>_r.max.y)continue;const qr=i.bz(jt,dt,D.canonical,_r.footprintTileId.canonical);if(gr=i.bA(qr,_r.footprint),gr)break}if(Yt){const _r=gr?Hl:my(kt.text);qe(o.text,it,Ht?Hl:_r),qe(o.text,_t,tr?Hl:_r);const qr=kt.text.isHidden(),{leftJustifiedTextSymbolIndex:jr,centerJustifiedTextSymbolIndex:Ir,rightJustifiedTextSymbolIndex:Hr,verticalPlacedTextSymbolIndex:Mn}=Ke,di=o.text.placedSymbolArray,Gi=qr||Ht?1:0;jr>=0&&(di.get(jr).hidden=Gi),Ir>=0&&(di.get(Ir).hidden=Gi),Hr>=0&&(di.get(Hr).hidden=Gi),Mn>=0&&(di.get(Mn).hidden=qr||tr?1:0);const Zn=this.variableOffsets[mt];Zn&&this.markUsedJustification(o,Zn.anchor,Ke,It);const Zr=this.placedOrientations[mt];Zr&&(this.markUsedJustification(o,"left",Ke,Zr),this.markUsedOrientation(o,Zr,Ke))}if(Bt){const _r=gr?Hl:my(kt.icon),{placedIconSymbolIndex:qr,verticalPlacedIconSymbolIndex:jr}=Ke,Ir=o.icon.placedSymbolArray,Hr=kt.icon.isHidden()?1:0;qr>=0&&(qe(o.icon,Mt,Ht?Hl:_r),Ir.get(qr).hidden=Hr),jr>=0&&(qe(o.icon,Ke.numVerticalIconVertices,tr?Hl:_r),Ir.get(jr).hidden=Hr)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const _r=o.collisionArrays[$e];if(_r){let qr=new i.P(0,0),jr=!0;if(_r.textBox||_r.verticalTextBox){if(fe){const Hr=this.variableOffsets[mt];Hr?(qr=xo(Hr.anchor,Hr.width,Hr.height,Hr.textOffset,Hr.textScale),be&&qr._rotate(xe?this.transform.angle:-this.transform.angle)):jr=!1}te&&(jr=!kt.clipped),_r.textBox&&hp(o.textCollisionBox.collisionVertexArray,kt.text.placed,!jr||Ht,pt,Ue,qr.x,qr.y),_r.verticalTextBox&&hp(o.textCollisionBox.collisionVertexArray,kt.text.placed,!jr||tr,pt,Ue,qr.x,qr.y)}const Ir=jr&&!!(!tr&&_r.verticalIconBox);_r.iconBox&&hp(o.iconCollisionBox.collisionVertexArray,kt.icon.placed,Ir,pt,Ue,Ke.hasIconTextFit?qr.x:0,Ke.hasIconTextFit?qr.y:0),_r.verticalIconBox&&hp(o.iconCollisionBox.collisionVertexArray,kt.icon.placed,!Ir,pt,Ue,Ke.hasIconTextFit?qr.x:0,Ke.hasIconTextFit?qr.y:0)}}}if(o.fullyClipped=We===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=$e.invProjMatrix,o.placementViewportMatrix=$e.viewportMatrix,o.collisionCircleArray=$e.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>o}setStale(){this.stale=!0}}function hp(g,o,d,y,S,P,M){g.emplaceBack(o?1:0,d?1:0,P||0,M||0,y,S?1:0),g.emplaceBack(o?1:0,d?1:0,P||0,M||0,y,S?1:0),g.emplaceBack(o?1:0,d?1:0,P||0,M||0,y,S?1:0),g.emplaceBack(o?1:0,d?1:0,P||0,M||0,y,S?1:0)}const fp=Math.pow(2,25),D_=Math.pow(2,24),L_=Math.pow(2,17),Zh=Math.pow(2,16),pp=Math.pow(2,9),z_=Math.pow(2,8),Yh=Math.pow(2,1);function my(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,d=Math.floor(127*g.opacity);return d*fp+o*D_+d*L_+o*Zh+d*pp+o*z_+d*Yh+o}const Hl=0;class Du{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,d,y,S,P,M){const D=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(D,S,o[this._currentTileIndex],this._sortAcrossTiles,M),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((G,K)=>G.sortKey-K.sortKey));this._currentPartIndex<D.length;){const G=D[this._currentPartIndex];if(d.placeLayerBucketPart(G,this._seenCrossTileIDs,y,G.symbolInstanceStart===0,M),this._currentPartIndex++,P())return!0}return!1}}class F_{constructor(o,d,y,S,P,M,D,G,K){this.placement=new Em(o,P,M,D,G,K),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(o,d,y,S,P){const M=i.q.now(),D=()=>{const G=i.q.now()-M;return!this._forceFullPlacement&&G>2};for(;this._currentPlacementIndex>=0;){const G=d[o[this._currentPlacementIndex]],K=this.placement.collisionIndex.transform.zoom;if(G.type==="symbol"&&(!G.minzoom||G.minzoom<=K)&&(!G.maxzoom||G.maxzoom>K)){const Y=G,te=Y.layout.get("symbol-z-elevate"),re=Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,oe=Y.layout.get("symbol-z-order"),ve=oe==="viewport-y"||oe==="auto"&&!(oe!=="viewport-y"&&re),fe=Y.layout.get("text-allow-overlap")||Y.layout.get("icon-allow-overlap")||Y.layout.get("text-ignore-placement")||Y.layout.get("icon-ignore-placement"),be=ve&&fe,xe=this._inProgressLayer=this._inProgressLayer||new Du(Y),Ce=i.aC(G.source,G.scope);if(xe.continuePlacement(te||be?S[Ce]:y[Ce],this.placement,this._showCollisionBoxes,G,D,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const gy=512/i.ag/2;class n0{constructor(o,d,y){this.tileID=o,this.bucketInstanceId=y,this.index=new i.bE(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=o.canonical.x*i.ag,P=o.canonical.y*i.ag;for(let M=0;M<d.length;M++){const{key:D,crossTileID:G,tileAnchorX:K,tileAnchorY:Y}=d.get(M),te=Math.floor((S+K)*gy),re=Math.floor((P+Y)*gy);this.index.add(te,re),this.keys.push(D),this.crossTileIDs.push(G)}this.index.finish()}findMatches(o,d,y){const S=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),P=gy/Math.pow(2,d.canonical.z-this.tileID.canonical.z),M=d.canonical.x*i.ag,D=d.canonical.y*i.ag;for(let G=0;G<o.length;G++){const K=o.get(G);if(K.crossTileID)continue;const{key:Y,tileAnchorX:te,tileAnchorY:re}=K,oe=Math.floor((M+te)*P),ve=Math.floor((D+re)*P),fe=this.index.range(oe-S,ve-S,oe+S,ve+S);for(const be of fe){const xe=this.crossTileIDs[be];if(this.keys[be]===Y&&!y.has(xe)){y.add(xe),K.crossTileID=xe;break}}}}}class i0{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class B_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const y in this.indexes){const S=this.indexes[y],P={};for(const M in S){const D=S[M];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+d),P[D.tileID.key]=D}this.indexes[y]=P}this.lng=o}addBucket(o,d,y){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let P=0;P<d.symbolInstances.length;P++)d.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const S=this.usedCrossTileIDs[o.overscaledZ];for(const P in this.indexes){const M=this.indexes[P];if(Number(P)>o.overscaledZ)for(const D in M){const G=M[D];G.tileID.isChildOf(o)&&G.findMatches(d.symbolInstances,o,S)}else{const D=M[o.scaledTo(Number(P)).key];D&&D.findMatches(d.symbolInstances,o,S)}}for(let P=0;P<d.symbolInstances.length;P++){const M=d.symbolInstances.get(P);M.crossTileID||(M.crossTileID=y.generate(),S.add(M.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new n0(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const y of d.crossTileIDs)this.usedCrossTileIDs[o].delete(y)}removeStaleBuckets(o){let d=!1;for(const y in this.indexes){const S=this.indexes[y];for(const P in S)o[S[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,S[P]),delete S[P],d=!0)}return d}}class yy{constructor(){this.layerIndexes={},this.crossTileIDs=new i0,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,y,S){let P=this.layerIndexes[o.fqid];P===void 0&&(P=this.layerIndexes[o.fqid]=new B_);let M=!1;const D={};S.name!=="globe"&&P.handleWrapJump(y);for(const G of d){const K=G.getBucket(o);K&&o.fqid===K.layerIds[0]&&(K.bucketInstanceId||(K.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(G.tileID,K,this.crossTileIDs)&&(M=!0),D[K.bucketInstanceId]=!0)}return P.removeStaleBuckets(D)&&(M=!0),M}pruneUnusedLayers(o){const d={};o.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const Rd=771;class An{constructor(o,d,y,S){this.blendFunction=o,this.blendColor=d,this.mask=y,this.blendEquation=S}}An.Replace=[1,0,1,0],An.disabled=new An(An.Replace,i.aj.transparent,[!1,!1,!1,!1]),An.unblended=new An(An.Replace,i.aj.transparent,[!0,!0,!0,!0]),An.alphaBlended=new An([1,Rd,1,Rd],i.aj.transparent,[!0,!0,!0,!0]),An.alphaBlendedNonPremultiplied=new An([770,Rd,770,Rd],i.aj.transparent,[!0,!0,!0,!0]),An.multiply=new An([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class zr{constructor(o,d,y){this.func=o,this.mask=d,this.range=y}}zr.ReadOnly=!1,zr.ReadWrite=!0,zr.disabled=new zr(519,zr.ReadOnly,[0,1]);const km=7680;class Wr{constructor(o,d,y,S,P,M){this.test=o,this.ref=d,this.mask=y,this.fail=S,this.depthFail=P,this.pass=M}}Wr.disabled=new Wr({func:519,mask:0},0,0,km,km,km);const gc=1029,Mm=2305;class Kr{constructor(o,d,y){this.enable=o,this.mode=d,this.frontFace=y}}function Id(g,o){const d=i.bG(g,3);i.ab.mat4.fromQuat(g,o),i.bI(g,3,d)}function Lu(g,o){const d=i.ab.quat.identity([]);return i.ab.quat.rotateZ(d,d,-o),i.ab.quat.rotateX(d,d,-g),d}function jm(g,o){const d=[g[0],g[1],0],y=[o[0],o[1],0];if(i.ab.vec3.length(d)>=1e-15){const M=i.ab.vec3.normalize([],d);i.ab.vec3.scale(y,M,i.ab.vec3.dot(y,M)),o[0]=y[0],o[1]=y[1]}const S=i.ab.vec3.cross([],o,g);if(i.ab.vec3.len(S)<1e-15)return null;const P=Math.atan2(-S[1],S[0]);return Lu(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),P)}Kr.disabled=new Kr(!1,gc,Mm),Kr.backCCW=new Kr(!0,gc,Mm),Kr.backCW=new Kr(!0,gc,2304),Kr.frontCW=new Kr(!0,1028,2304),Kr.frontCCW=new Kr(!0,1028,Mm);class mp{constructor(o,d){this.position=o,this.orientation=d}get position(){return this._position}set position(o){if(o){const d=o instanceof i.aa?o:new i.aa(o[0],o[1],o[2]);this._renderWorldCopies&&(d.x=i.bF(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(o,d){if(this.orientation=null,!this.position)return;const y=this.position,S=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(o)):0,P=i.aa.fromLngLat(o,S),M=[P.x-y.x,P.y-y.y,P.z-y.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=jm(M,d)}setPitchBearing(o,d){this.orientation=Lu(i.ai(o),i.ai(-d))}}class fs{constructor(o,d){this._transform=i.ab.mat4.identity([]),this.orientation=d,this.position=o}get mercatorPosition(){const o=this.position;return new i.aa(o[0],o[1],o[2])}get position(){const o=i.bG(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var d;o&&i.bI(this._transform,3,[(d=o)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||i.ab.quat.identity([]),o&&Id(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,d){this._orientation=Lu(o,d),Id(this._transform,this._orientation)}forward(){const o=i.bG(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=i.bG(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=i.bG(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,d){const y=new Float64Array(16);return i.ab.mat4.invert(y,this.getWorldToCamera(o,d)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,d,y){const S=this.position;i.ab.vec3.scale(S,S,-o);const P=new Float64Array(16);return i.ab.mat4.fromScaling(P,[y,y,y]),i.ab.mat4.translate(P,P,S),P[10]*=d,P}getWorldToCamera(o,d){const y=new Float64Array(16),S=new Float64Array(4),P=this.position;return i.ab.quat.conjugate(S,this._orientation),i.ab.vec3.scale(P,P,-o),i.ab.mat4.fromQuat(y,S),i.ab.mat4.translate(y,y,P),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=d,y[9]*=d,y[10]*=d,y[11]*=d,y}getCameraToClipPerspective(o,d,y,S){const P=new Float64Array(16);return i.ab.mat4.perspective(P,o,d,y,S),P}getCameraToClipOrthographic(o,d,y,S,P,M){const D=new Float64Array(16);return i.ab.mat4.ortho(D,o,d,y,S,P,M),D}getDistanceToElevation(o,d=!1){const y=o===0?0:i.bH(o,d?i.aS(this.position[1]):this.position[1]),S=this.forward();return(y-this.position[2])/S[2]}clone(){return new fs([...this.position],[...this.orientation])}}const Rs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class lr{constructor(o=0,d=0,y=0,S=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=y,this.right=S}interpolate(o,d,y){return d.top!=null&&o.top!=null&&(this.top=i.af(o.top,d.top,y)),d.bottom!=null&&o.bottom!=null&&(this.bottom=i.af(o.bottom,d.bottom,y)),d.left!=null&&o.left!=null&&(this.left=i.af(o.left,d.left,y)),d.right!=null&&o.right!=null&&(this.right=i.af(o.right,d.right,y)),this}getCenter(o,d){const y=i.aw((this.left+o-this.right)/2,0,o),S=i.aw((this.top+d-this.bottom)/2,0,d);return new i.P(y,S)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new lr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const vy=(g,o,d)=>(1-d)*g+d*o,gp=g=>g*g*g*g*g;class Xh{constructor(o,d,y,S,P,M,D){this.tileSize=512,this._renderWorldCopies=P===void 0||P,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=S??60,this.setProjection(M),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new lr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new fs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const o=new Xh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,d=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(o||y)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const y=this.getProjection(),S=!i.bn(d,y);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const d=o!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const d=-o*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=i.aw(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=i.ai(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let S=0,P=0;for(let M=0;M<d.length;M++){const D=new i.P(d[M][0]*this.width,y+d[M][1]*(this.height-y)),G=o.pointCoordinate(D);if(!G)continue;const K=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);S+=G[3]*K,P+=K}return P===0?NaN:S/P}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*d,S=this._mercatorZfromZoom(o),P=this._mercatorZfromZoom(this._maxZoom),M=Math.max(S-y,P);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let y;y=o.z<this._camera.position[2]?[d.x,d.y,d.z]:[o.x,o.y,o.z];const S=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,y));return i.aw(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let d=!1;if(o.orientation&&!i.ab.quat.exactEquals(o.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(o.orientation)),o.position){const y=[o.position.x,o.position.y,o.position.z];i.ab.vec3.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,d=new mp;return d.position=new i.aa(o[0],o[1],o[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(o){if(!i.ab.quat.length(o))return!1;i.ab.quat.normalize(o,o);const d=i.ab.vec3.transformQuat([],[0,0,-1],o),y=i.ab.vec3.transformQuat([],[0,-1,0],o);if(y[2]<0)return!1;const S=jm(d,y);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(o){const d=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;o[2]=i.aw(o[2],S/y,S/d),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,y){this._unmodified=!1,this._edgeInsets.interpolate(o,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new i.bQ(0,o)];if(this.renderWorldCopies){const y=this.pointCoordinate(new i.P(0,0)),S=this.pointCoordinate(new i.P(this.width,0)),P=this.pointCoordinate(new i.P(this.width,this.height)),M=this.pointCoordinate(new i.P(0,this.height)),D=Math.floor(Math.min(y.x,S.x,P.x,M.x)),G=Math.floor(Math.max(y.x,S.x,P.x,M.x)),K=1;for(let Y=D-K;Y<=G+K;Y++)Y!==0&&d.push(new i.bQ(Y,o))}return d}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,d,y){let S=[];const P=y!==void 0,M=!P;if(M&&this.zoom<d||P&&y[0]===0&&y[1]===0)return S;const D=new Set,G=(Y,te,re,oe,ve)=>{const fe=i.c5(te,Y,re,oe,ve);D.has(fe)||(S.push(new i.aG(Y,te,re,oe,ve)),D.add(fe))};for(let Y=0;Y<o.length;Y++){const te=o[Y];if(M&&te.canonical.z!==d)continue;const re=te.canonical,oe=te.overscaledZ,ve=te.wrap,fe=1<<re.z,be=re.x+1<fe,xe=re.x>0,Ce=re.y+1<fe,Ue=re.y>0,Be=te.wrap-(xe?0:1),Xe=te.wrap+(be?0:1),qe=xe?re.x-1:fe-1,We=be?re.x+1:0;if(P)y[0]<0?(G(oe,Xe,re.z,We,re.y),y[1]<0&&Ce&&(G(oe,ve,re.z,re.x,re.y+1),G(oe,Xe,re.z,We,re.y+1)),y[1]>0&&Ue&&(G(oe,ve,re.z,re.x,re.y-1),G(oe,Xe,re.z,We,re.y-1))):y[0]>0?(G(oe,Be,re.z,qe,re.y),y[1]<0&&Ce&&(G(oe,ve,re.z,re.x,re.y+1),G(oe,Be,re.z,qe,re.y+1)),y[1]>0&&Ue&&(G(oe,ve,re.z,re.x,re.y-1),G(oe,Be,re.z,qe,re.y-1))):y[1]<0&&Ce?G(oe,ve,re.z,re.x,re.y+1):Ue&&G(oe,ve,re.z,re.x,re.y-1);else{const $e=te.visibleQuadrants;1&$e&&(G(oe,Be,re.z,qe,re.y),Ue&&(G(oe,ve,re.z,re.x,re.y-1),G(oe,Be,re.z,qe,re.y-1))),2&$e&&(G(oe,Xe,re.z,We,re.y),Ue&&(G(oe,ve,re.z,re.x,re.y-1),G(oe,Xe,re.z,We,re.y-1))),4&$e&&(G(oe,Be,re.z,qe,re.y),Ce&&(G(oe,ve,re.z,re.x,re.y+1),G(oe,Be,re.z,qe,re.y+1))),8&$e&&(G(oe,Xe,re.z,We,re.y),Ce&&(G(oe,ve,re.z,re.x,re.y+1),G(oe,Xe,re.z,We,re.y+1)))}}const K=[];for(const Y of S)S.some(te=>Y.isChildOf(te))||K.push(Y);if(S=K.filter(Y=>!o.some(te=>!!(Y.overscaledZ<d&&te.isChildOf(Y))||Y.equals(te)||Y.isChildOf(te))),M){const Y=1<<d,te=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),re=[Y*te.x,Y*te.y],oe=4,ve=oe*oe;S=S.filter(fe=>{const be=fe.canonical.x+.5-re[0],xe=fe.canonical.y+.5-re[1];return be*be+xe*xe<ve})}return S}coveringTiles(o){let d=this.coveringZoomLevel(o);const y=d,S=this.elevation&&this.elevation.exaggeration(),P=S&&!o.isTerrainDEM,M=this.projection.name==="mercator";if(o.minzoom!==void 0&&d<o.minzoom)return[];o.maxzoom!==void 0&&d>o.maxzoom&&(d=o.maxzoom);const D=this.locationCoordinate(this.center),G=this.center.lat,K=1<<d,Y=[K*D.x,K*D.y,0],te=this.projection.name==="globe",re=!te,oe=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,re),ve=te?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=K*i.bH(1,this.center.lat),be=this._camera.position[2]/i.bH(1,this.center.lat),xe=[K*ve.x,K*ve.y,be*(re?1:fe)],Ce=te||S,Ue=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Be=this.isLODDisabled(!0)?d:0;let Xe;if(this._elevation&&o.isTerrainDEM)Xe=1e4*this._elevation.exaggeration();else if(this._elevation){const pt=this._elevation.getMinMaxForVisibleTiles();Xe=pt?pt.max:this._centerAltitude}else Xe=this._centerAltitude;const qe=o.isTerrainDEM?-Xe:this._elevation?this._elevation.getMinElevationBelowMSL():0,We=this.projection.isReprojectedInTileSpace?i.bS(this):1,$e=pt=>{const kt=new i.aa(pt.x+25e-6,pt.y,pt.z),Yt=new i.aa(pt.x,pt.y+25e-6,pt.z),Bt=pt.toLngLat(),It=kt.toLngLat(),Ht=Yt.toLngLat(),tr=this.locationCoordinate(Bt),gr=this.locationCoordinate(It),_r=this.locationCoordinate(Ht),qr=Math.hypot(gr.x-tr.x,gr.y-tr.y),jr=Math.hypot(_r.x-tr.x,_r.y-tr.y);return Math.sqrt(qr*jr)*We/25e-6},Ke=pt=>{const Dt=Xe,kt=qe;return{aabb:i.bV(this,K,0,0,0,pt,kt,Dt,this.projection),zoom:0,x:0,y:0,minZ:kt,maxZ:Dt,wrap:pt,fullyVisible:!1}},it=[];let _t=[];const mt=d,Mt=o.reparseOverscaled?y:d,jt=(be-this._centerAltitude)*fe,dt=pt=>{if(!this._elevation||!pt.tileID||!M)return;const Dt=this._elevation.getMinMaxForTile(pt.tileID),kt=pt.aabb;Dt?(kt.min[2]=Dt.min,kt.max[2]=Dt.max,kt.center[2]=(kt.min[2]+kt.max[2])/2):(pt.shouldSplit=Ut(pt),pt.shouldSplit||(kt.min[2]=kt.max[2]=kt.center[2]=this._centerAltitude))},Et=(pt,Dt)=>{if(.707*Dt<pt)return 1;const kt=Dt/pt;return kt/(1.4144271570014144+(Math.pow(1.1,kt-1.4144271570014144+1)-1)/(1.1-1)-1)},Ut=pt=>{if(pt.zoom<Be)return!0;if(pt.zoom===mt)return!1;if(pt.shouldSplit!=null)return pt.shouldSplit;const Dt=pt.aabb.distanceX(xe),kt=pt.aabb.distanceY(xe);let Yt=jt,Bt=1;if(te){Yt=pt.aabb.distanceZ(xe);const jr=Math.pow(2,pt.zoom),Ir=i.aS((pt.y+1)/jr),Hr=i.aS(pt.y/jr),Mn=Math.min(Math.max(G,Ir),Hr),di=i.c9(Mn)/i.c9(G);if(Bt=Mn===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,di/this._mercatorScaleRatio),this.zoom<=i.c6&&pt.zoom===mt-1&&di>=.9)return!0}else if(P&&(Yt=pt.aabb.distanceZ(xe)*fe),this.projection.isReprojectedInTileSpace&&y<=5){const jr=Math.pow(2,pt.zoom),Ir=$e(new i.aa((pt.x+.5)/jr,(pt.y+.5)/jr));Bt=Ir>.85?1:Ir}if(!M){const jr=Math.sqrt(Dt*Dt+kt*kt+Yt*Yt);let Ir=(1<<mt-pt.zoom)*Ue*Bt;return Ir*=Et(Math.max(Yt,jt),jr),jr<Ir}let It=Number.MAX_VALUE,Ht=0;const tr=pt.aabb.getCorners(),gr=[];for(const jr of tr){i.ab.vec3.sub(gr,jr,xe),te||(P?gr[2]*=fe:gr[2]=jt);const Ir=i.ab.vec3.dot(gr,this._camera.forward());Ir<It&&(It=Ir,Ht=Math.abs(gr[2]))}let _r=(1<<mt-pt.zoom)*Ue*Bt;if(_r*=Et(Math.max(Ht,jt),It),It<_r)return!0;const qr=pt.aabb.closestPoint(Y);return qr[0]===Y[0]&&qr[1]===Y[1]};if(this.renderWorldCopies)for(let pt=1;pt<=3;pt++)it.push(Ke(-pt)),it.push(Ke(pt));for(it.push(Ke(0));it.length>0;){const pt=it.pop(),Dt=pt.x,kt=pt.y;let Yt=pt.fullyVisible;const Bt=()=>this.projection.name==="globe"&&(pt.y===0||pt.y===(1<<pt.zoom)-1);if(!Yt){let It=Ce?pt.aabb.intersects(oe):pt.aabb.intersectsFlat(oe);if(It===0&&Bt()){const Ht=new i.bT(pt.zoom,Dt,kt);It=i.bU(this,K,Ht,!0).intersects(oe)}if(It===0)continue;Yt=It===2}if(pt.zoom!==mt&&Ut(pt))for(let It=0;It<4;It++){const Ht=(Dt<<1)+It%2,tr=(kt<<1)+(It>>1),gr={aabb:M?pt.aabb.quadrant(It):i.bV(this,K,pt.zoom+1,Ht,tr,pt.wrap,pt.minZ,pt.maxZ,this.projection),zoom:pt.zoom+1,x:Ht,y:tr,wrap:pt.wrap,fullyVisible:Yt,tileID:void 0,shouldSplit:void 0,minZ:pt.minZ,maxZ:pt.maxZ};P&&!te&&(gr.tileID=new i.aG(pt.zoom+1===mt?Mt:pt.zoom+1,pt.wrap,pt.zoom+1,Ht,tr),dt(gr)),it.push(gr)}else{const It=pt.zoom===mt?Mt:pt.zoom;if(o.minzoom&&o.minzoom>It)continue;let Ht=0;if(!Yt){let qr=Ce?pt.aabb.intersectsPrecise(oe):pt.aabb.intersectsPreciseFlat(oe);if(qr===0&&Bt()){const jr=new i.bT(pt.zoom,Dt,kt);qr=i.bU(this,K,jr,!0).intersectsPrecise(oe)}if(qr===0)continue;if(o.calculateQuadrantVisibility)if(oe.containsPoint(pt.aabb.center))Ht=15;else for(let jr=0;jr<4;jr++)pt.aabb.quadrant(jr).intersects(oe)!==0&&(Ht|=1<<jr)}const tr=Y[0]-(.5+Dt+(pt.wrap<<pt.zoom))*(1<<d-pt.zoom),gr=Y[1]-.5-kt,_r=pt.tileID?pt.tileID:new i.aG(It,pt.wrap,pt.zoom,Dt,kt);o.calculateQuadrantVisibility&&(_r.visibleQuadrants=Ht),_t.push({tileID:_r,distanceSq:tr*tr+gr*gr})}}if(this.fogCullDistSq){const pt=this.fogCullDistSq,Dt=this.horizonLineFromTop();_t=_t.filter(kt=>{const Yt=[0,0,0,1],Bt=[i.ag,i.ag,0,1],It=this.calculateFogTileMatrix(kt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Yt,Yt,It),i.ab.vec4.transformMat4(Bt,Bt,It);const Ht=i.ab.vec4.min([],Yt,Bt),tr=i.ab.vec4.max([],Yt,Bt),gr=i.bW(Ht,tr);if(gr===0)return!0;let _r=!1;const qr=this._elevation;if(qr&&gr>pt&&Dt!==0){const jr=this.calculateProjMatrix(kt.tileID.toUnwrapped());let Ir;o.isTerrainDEM||(Ir=qr.getMinMaxForTile(kt.tileID)),Ir||(Ir={min:qe,max:Xe});const Hr=i.c7(this.rotation),Mn=[Hr[0]*i.ag,Hr[1]*i.ag,Ir.max];i.ab.vec3.transformMat4(Mn,Mn,jr),_r=(1-Mn[1])*this.height*.5<Dt}return gr<pt||_r})}return _t.sort((pt,Dt)=>pt.distanceSq-Dt.distanceSq).map(pt=>pt.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=i.aw(o.lat,-i.bX,i.bX),y=this.projection.project(o.lng,d);return new i.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,d){let y,S;const P=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;y=(d.x-P.x)/D,S=(d.y-P.y)/D}else{const D=this.pointCoordinate(d),G=this.pointCoordinate(P);y=D.x-G.x,S=D.y-G.y}const M=this.locationCoordinate(o);this.setLocation(new i.aa(M.x-y,M.y-S))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,d){const y=d?i.bH(d,o.lat):void 0,S=this.projection.project(o.lng,o.lat);return new i.aa(S.x,S.y,y)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,d){const y=d??this._centerAltitude,S=[o.x,o.y,0,1],P=[o.x,o.y,1,1];i.ab.vec4.transformMat4(S,S,this.pixelMatrixInverse),i.ab.vec4.transformMat4(P,P,this.pixelMatrixInverse);const M=P[3];i.ab.vec4.scale(S,S,1/S[3]),i.ab.vec4.scale(P,P,1/M);const D=S[2],G=P[2];return{p0:S,p1:P,t:D===G?0:(y-D)/(G-D)}}screenPointToMercatorRay(o){const d=[o.x,o.y,0,1],y=[o.x,o.y,1,1];return i.ab.vec4.transformMat4(d,d,this.pixelMatrixInverse),i.ab.vec4.transformMat4(y,y,this.pixelMatrixInverse),i.ab.vec4.scale(d,d,1/d[3]),i.ab.vec4.scale(y,y,1/y[3]),d[2]=i.bH(d[2],this._center.lat)*this.worldSize,y[2]=i.bH(y[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(d,d,1/this.worldSize),i.ab.vec4.scale(y,y,1/this.worldSize),new i.aq([d[0],d[1],d[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],y,d)))}rayIntersectionCoordinate(o){const{p0:d,p1:y,t:S}=o,P=i.bH(d[2],this._center.lat),M=i.bH(y[2],this._center.lat);return new i.aa(i.af(d[0],y[0],S)/this.worldSize,i.af(d[1],y[1],S)/this.worldSize,i.af(P,M,S))}pointCoordinate(o,d=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,d)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let d=this.projection.pointCoordinate3D(this,o.x,o.y);if(d)return new i.aa(d[0],d[1],d[2]);let y=0,S=this.horizonLineFromTop();if(o.y>S)return this.pointCoordinate(o);const P=.02*S,M=o.clone();for(let D=0;D<10&&S-y>P;D++){M.y=i.af(y,S,.66);const G=this.projection.pointCoordinate3D(this,M.x,M.y);G?(S=M.y,d=G):y=M.y}return d?new i.aa(d[0],d[1],d[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(o);const d=this.pointCoordinate(o);return d.y>=0&&d.y<=1}_coordinatePoint(o,d){const y=d&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,S=[o.x*this.worldSize,o.y*this.worldSize,y+o.toAltitude(),1];return i.ab.vec4.transformMat4(S,S,this.pixelMatrix),S[3]>0?new i.P(S[0]/S[3],S[1]/S[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:d}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,P=this.pointLocation3D(new i.P(d,o)),M=this.pointLocation3D(new i.P(S,o)),D=this.pointLocation3D(new i.P(S,y)),G=this.pointLocation3D(new i.P(d,y));let K=Math.min(P.lng,M.lng,D.lng,G.lng),Y=Math.max(P.lng,M.lng,D.lng,G.lng),te=Math.min(P.lat,M.lat,D.lat,G.lat),re=Math.max(P.lat,M.lat,D.lat,G.lat);const oe=Math.pow(2,-this.zoom)/16*270,ve=this.projection.name==="globe"?1:4,fe=(be,xe,Ce,Ue,Be)=>{const Xe=(be+Ce)/2,qe=(xe+Ue)/2,We=new i.P(Xe,qe),{lng:$e,lat:Ke}=this.pointLocation3D(We),it=Math.max(0,K-$e,te-Ke,$e-Y,Ke-re);K=Math.min(K,$e),Y=Math.max(Y,$e),te=Math.min(te,Ke),re=Math.max(re,Ke),(Be<ve||it>oe)&&(fe(be,xe,Xe,qe,Be+1),fe(Xe,qe,Ce,Ue,Be+1))};if(fe(d,o,S,o,1),fe(S,o,S,y,1),fe(S,y,d,y,1),fe(d,y,d,o,1),this.projection.name==="globe"){const[be,xe]=i.bZ(this);be?(re=90,Y=180,K=-180):xe&&(te=-90,Y=180,K=-180)}return new i.az(new i.bO(K,te),new i.bO(Y,re))}_getBoundsRectangular(o,d){const{top:y,left:S}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,D=new i.P(S,y),G=new i.P(M,y),K=new i.P(M,P),Y=new i.P(S,P);let te=this.pointCoordinate(D,o),re=this.pointCoordinate(G,o);const oe=this.pointCoordinate(K,d),ve=this.pointCoordinate(Y,d),fe=(be,xe)=>(xe.y-be.y)/(xe.x-be.x);return te.y>1&&re.y>=0?te=new i.aa((1-ve.y)/fe(ve,te)+ve.x,1):te.y<0&&re.y<=1&&(te=new i.aa(-ve.y/fe(ve,te)+ve.x,0)),re.y>1&&te.y>=0?re=new i.aa((1-oe.y)/fe(oe,re)+oe.x,1):re.y<0&&te.y<=1&&(re=new i.aa(-oe.y/fe(oe,re)+oe.x,0)),new i.az().extend(this.coordinateLocation(te)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(oe))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=o.visibleDemTiles.reduce((y,S)=>{if(S.dem){const P=S.dem.tree;y.min=Math.min(y.min,P.minimums[0]),y.max=Math.max(y.max,P.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*o.exaggeration(),d.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-d*(1-this._horizonShift);return o?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,d){return this.projection.createTileMatrix(this,d,o)}calculateDistanceTileData(o){const d=o.key,y=this._distanceTileDataCache;if(y[d])return y[d];const S=o.canonical,P=1/this.height,M=this.cameraWorldSize,D=M/this.zoomScale(S.z),G=(S.x+Math.pow(2,S.z)*o.wrap)*D,K=S.y*D,Y=this.point;Y.x*=M/this.worldSize,Y.y*=M/this.worldSize;const te=this.angle,re=Math.sin(-te),oe=-Math.cos(-te);return y[d]={bearing:[re,oe],center:[(Y.x-G)*P,(Y.y-K)*P],scale:D/i.ag*P},y[d]}calculateFogTileMatrix(o){const d=o.key,y=this._fogTileMatrixCache;if(y[d])return y[d];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return i.ab.mat4.multiply(S,this.worldToFogMatrix,S),y[d]=new Float32Array(S),y[d]}calculateProjMatrix(o,d=!1,y=!1){const S=o.key;let P;if(P=y?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,P[S])return P[S];const M=this.calculatePosMatrix(o,this.worldSize);let D;return D=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(M,D,M),P[S]=new Float32Array(M),P[S]}calculatePixelsToTileUnitsMatrix(o){const d=o.tileID.key,y=this._pixelsToTileUnitsCache;if(y[d])return y[d];const S=i.b_(o,this);return y[d]=S,y[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,d=i.ab.mat4.fromScaling([],[o,o,o]);return i.ab.mat4.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const d=i.bH(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(d),S=this._camera.forward(),P=i.bH(1,this._center.lat);y[2]/=P,S[2]/=P,i.ab.vec3.normalize(S,S);const M=o.raycast(y,S,o.exaggeration());if(M){const D=i.ab.vec3.scaleAndAdd([],y,S,M),G=new i.aa(D[0],D[1],i.bH(D[2],i.aS(D[1]))),K=(G.z+i.ab.vec3.length([G.x-y[0],G.y-y[1],G.z-y[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(K),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const d=this._elevation,y=i.bH(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(y),P=d.getAtPointOrZero(new i.aa(...S)),M=this.pixelsPerMeter/this.worldSize*P,D=this._minimumHeightOverTerrain(),G=S[2]-M;if(G<=D)if(G<0||o){const K=this.locationCoordinate(this._center,this._centerAltitude),Y=[S[0],S[1],K.z-S[2]],te=i.ab.vec3.length(Y);Y[2]-=(D-G)/this._pixelsPerMercatorPixel;const re=i.ab.vec3.length(Y);if(re===0)return;i.ab.vec3.scale(Y,Y,te/re*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],K.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const re=this.center;return re.lat=i.aw(re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(re.lng=i.aw(re.lng,this.minLng,this.maxLng)),this.center=re,void(this._constraining=!1)}const d=this._unmodified,{x:y,y:S}=this.point;let P=0,M=y,D=S;const G=this.width/2,K=this.height/2,Y=this.worldMinY*this.scale,te=this.worldMaxY*this.scale;if(S-K<Y&&(D=Y+K),S+K>te&&(D=te-K),te-Y<this.height&&(P=Math.max(P,this.height/(te-Y)),D=(te+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const re=this.worldMinX*this.scale,oe=this.worldMaxX*this.scale,ve=this.worldSize/2-(re+oe)/2;M=(y+ve+this.worldSize)%this.worldSize-ve,M-G<re&&(M=re+G),M+G>oe&&(M=oe-G),oe-re<this.width&&(P=Math.max(P,this.width/(oe-re)),M=(oe+re)/2)}M===y&&D===S||(this.center=this.unproject(new i.P(M,D))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const S=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const P=this.projection.zAxisUnit==="meters"?y:1,M=this._camera.getWorldToCamera(this.worldSize,P);let D;const G=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(G[8]=2*-o.x/this.width,G[9]=2*o.y/this.height,this.isOrthographic){let Ke=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),it=Ke*this.aspect,_t=-it,mt=-Ke;it-=o.x,_t-=o.x,Ke+=o.y,mt+=o.y,D=this._camera.getCameraToClipOrthographic(_t,it,mt,Ke,this._nearZ,this._farZ),((Mt,jt,dt,Et)=>{for(let Ut=0;Ut<16;Ut++)Mt[Ut]=vy(jt[Ut],dt[Ut],Et)})(D,D,G,gp(this.pitch>=15?1:this.pitch/15))}else D=G;const K=i.ab.mat4.mul([],G,M);let Y=i.ab.mat4.mul([],D,M);if(this.projection.isReprojectedInTileSpace){const Ke=this.locationCoordinate(this.center),it=i.ab.mat4.identity([]);i.ab.mat4.translate(it,it,[Ke.x*this.worldSize,Ke.y*this.worldSize,0]),i.ab.mat4.multiply(it,it,i.c0(this)),i.ab.mat4.translate(it,it,[-Ke.x*this.worldSize,-Ke.y*this.worldSize,0]),i.ab.mat4.multiply(Y,Y,it),i.ab.mat4.multiply(K,K,it),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],Y,[this.worldSize,this.worldSize,this.worldSize/P,1]),this.projMatrix=Y,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),d){const Ke=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ke[8]=2*-o.x/this.width,Ke[9]=2*o.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Ke,M)}else this.expandedFarZProjMatrix=this.projMatrix;const te=i.ab.mat4.invert([],D);this.frustumCorners=i.c2.fromInvProjectionMatrix(te,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const re=new Float32Array(16);i.ab.mat4.identity(re),i.ab.mat4.scale(re,re,[1,-1,1]),i.ab.mat4.rotateX(re,re,this._pitch),i.ab.mat4.rotateZ(re,re,this.angle);const oe=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(oe);const ve=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;oe[8]=2*-o.x/this.width,oe[9]=2*(o.y+ve)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(re,oe,re);const fe=this.point,be=fe.x,xe=fe.y,Ce=this.width%2/2,Ue=this.height%2/2,Be=Math.cos(this.angle),Xe=Math.sin(this.angle),qe=be-Math.round(be)+Be*Ce+Xe*Ue,We=xe-Math.round(xe)+Be*Ue+Xe*Ce,$e=new Float64Array(Y);if(i.ab.mat4.translate($e,$e,[qe>.5?qe-1:qe,We>.5?We-1:We,0]),this.alignedProjMatrix=$e,Y=i.ab.mat4.create(),i.ab.mat4.scale(Y,Y,[this.width/2,-this.height/2,1]),i.ab.mat4.translate(Y,Y,[1,-1,0]),this.labelPlaneMatrix=Y,Y=i.ab.mat4.create(),i.ab.mat4.scale(Y,Y,[1,-1,1]),i.ab.mat4.translate(Y,Y,[-1,-1,0]),i.ab.mat4.scale(Y,Y,[2/this.width,2/this.height,1]),this.glCoordMatrix=Y,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,K),this._calcFogMatrices(),this._distanceTileDataCache={},Y=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!Y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Ke=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Ke,Ke,M),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,y=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,P=[o,o,d];i.ab.vec3.scale(P,P,S),i.ab.vec3.scale(y,y,-1),i.ab.vec3.multiply(y,y,P);const M=i.ab.mat4.create();i.ab.mat4.translate(M,M,y),i.ab.mat4.scale(M,M,P),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,d,S)}_computeCameraPosition(o){const d=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),S=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-o/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-y[0]*P,S.y/this.worldSize-y[1]*P,o/this.worldSize*this._centerAltitude-y[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],S=o[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(P=Math.min((d-y)/S,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,o,P),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,d=this._camera.forward(),{pitch:y,bearing:S}=this._camera.getPitchBearing(),P=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),D=Math.max((o[2]-P)/Math.cos(y),M),G=this._zoomFromMercatorZ(D);i.ab.vec3.scaleAndAdd(o,o,d,D),this._pitch=i.aw(y,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(S,-Math.PI,Math.PI),this._setZoom(i.aw(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let d=0,y=i.bY,S=0,P=1/0;for(;y-d>1e-6&&y>d;){const M=d+.5*(y-d),D=this.tileSize*Math.pow(2,M),G=this.getCameraToCenterDistance(this.projection,M,D),K=this.scaleZoom(G/(o*this.tileSize)),Y=Math.abs(M-K);Y<P&&(P=Y,S=M),M<K?d=M:y=M}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,d){const y=Math.min(o.x,d.x),S=Math.max(o.x,d.x),P=Math.min(o.y,d.y),M=Math.max(o.y,d.y);if(P<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new i.P(y,P),new i.P(S,M),new i.P(y,M),new i.P(S,P)],G=this.renderWorldCopies?-3:0,K=this.renderWorldCopies?4:1;for(const Y of D){const te=this.pointRayIntersection(Y);if(te.t<0)return!0;const re=this.rayIntersectionCoordinate(te);if(re.x<G||re.y<0||re.x>K||re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(o,d){const y=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,o)),S=this._zoomFromMercatorZ(y)+d;return y-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([d,y,S],P){const M=[d,y,S,1];i.ab.vec4.transformMat4(M,M,P);const D=M[3]=Math.max(M[3],1e-6);return M[0]/=D,M[1]/=D,M[2]/=D,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,o))}}getCameraToCenterDistance(o,d=this.zoom,y=this.worldSize){const S=i.b$(o,d,this.width,this.height,1024),P=o.pixelSpaceConversion(this.center.lat,y,S);let M=.5/Math.tan(.5*this._fov)*this.height*P;return this.isOrthographic&&(M=vy(1,M,gp(this.pitch>=15?1:this.pitch/15))),M}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(o,o,this.globeMatrix),o}getFrustum(o){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const Tl=(g,o)=>{if(o>0&&g.terrain&&i.w("Cutoff is currently disabled on terrain"),o<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=g.transform,y=Math.max(Math.abs(d._zoom-(g.minCutoffZoom-1)),1),S=d.isLODDisabled(!1)?i.ac(60,45,d.pitch):i.ac(30,15,d.pitch),P=d._farZ-d._nearZ,M=o*d.height,D=((1-(G=S))*d.cameraToCenterDistance+G*(d._farZ+M))*y;var G;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(D-d._nearZ)/P,(D-M-d._nearZ)/P]}}},Ra={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Hc{constructor(o,d){this.aabb=o,this.lastCascade=d}}class Jh{add(o,d){const y=this.receivers[o.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],d.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],d.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],d.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],d.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],d.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],d.max[2])):this.receivers[o.key]=new Hc(d,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,d,y){const S=i.cd.fromPoints(o.points);let P=0;for(const M in this.receivers){const D=this.receivers[M];if(!D||!S.intersectsAabb(D.aabb))continue;D.aabb.min=S.closestPoint(D.aabb.min),D.aabb.max=S.closestPoint(D.aabb.max);const G=D.aabb.getCorners();for(let K=0;K<y.length;K++){let Y=!0;for(const te of G){const re=[te[0]*d,te[1]*d,te[2]];if(i.ab.vec3.transformMat4(re,re,y[K].matrix),re[0]<-1||re[0]>1||re[1]<-1||re[1]>1){Y=!1;break}}if(D.lastCascade=K,P=Math.max(P,K),Y)break}}return P+1}}class Dd{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Jh,this._depthMode=new zr(o.context.gl.LEQUAL,zr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(Ra,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(Ra,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(Ra,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,d){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const S=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||S<=0||(this._shadowLayerCount=y.style.order.reduce((ve,fe)=>{const be=y.style._mergedLayers[fe];return ve+(be.hasShadowPass()&&!be.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const P=y.context,M=Ra.shadowMapResolution,D=Ra.shadowMapResolution;if(this._cascades.length===0||Ra.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ve=0;ve<Ra.cascadeCount;++ve){const fe=y._shadowMapDebug,be=P.gl,xe=P.createFramebuffer(M,D,fe,"texture"),Ce=new i.T(P,{width:M,height:D,data:null},be.DEPTH_COMPONENT16);if(xe.depthAttachment.set(Ce.texture),fe){const Ue=new i.T(P,{width:M,height:D,data:null},be.RGBA8);xe.colorAttachment.set(Ue.texture)}this._cascades.push({framebuffer:xe,texture:Ce,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=Kc(d);let G=0;if(o.elevation){const ve=o.elevation,fe=[1e4,-1e4];ve.visibleDemTiles.filter(be=>be.dem).forEach(be=>{const xe=be.dem.tree;fe[0]=Math.min(fe[0],xe.minimums[0]),fe[1]=Math.max(fe[1],xe.maximums[0])}),fe[0]!==1e4&&(G=(fe[1]-fe[0])*ve.exaggeration())}const K=1.5*o.cameraToCenterDistance,Y=3*K,te=new Float64Array(16);for(let ve=0;ve<this._cascades.length;++ve){const fe=this._cascades[ve];let be=o.height/50,xe=1;Ra.cascadeCount===1?xe=Y:ve===0?xe=K:(be=K,xe=Y);const[Ce,Ue]=a0(o,this.shadowDirection,be,xe,Ra.shadowMapResolution,G);fe.scale=o.scale,fe.matrix=Ce,fe.boundingSphereRadius=Ue,i.ab.mat4.invert(te,fe.matrix),fe.frustum=i.bR.fromInvProjectionMatrix(te,1,0,!0),fe.far=xe}const re=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[re].far,this._cascades[re].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ra.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ra.shadowMapResolution,this._uniformValues.u_shadowmap_0=Rs.ShadowMap0,this._uniformValues.u_shadowmap_1=Rs.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const oe=y.transform.elevation;for(const ve of this._groundShadowTiles){let fe={min:0,max:0};if(oe){const be=oe.getMinMaxForTile(ve);be&&(fe=be)}this.addShadowReceiver(ve.toUnwrapped(),fe.min,fe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,d){if(!this.enabled)return;const y=this.painter,S=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),S.viewport.set([0,0,Ra.shadowMapResolution,Ra.shadowMapResolution]);for(let P=0;P<this._numCascadesToRender;++P){y.currentShadowCascade=P,S.bindFramebuffer.set(this._cascades[P].framebuffer.framebuffer),S.clear({color:i.aj.white,depth:1});for(const M of o.order){const D=o._mergedLayers[M];if(!D.hasShadowPass()||D.isHidden(y.transform.zoom))continue;const G=o.getLayerSourceCache(D),K=G?d[G.id]:void 0;(D.type==="model"||K&&K.length)&&y.renderLayer(y,G,D,K)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,d=o.style,y=o.context,S=d.directionalLight,P=d.ambientLight;if(!S||!P)return;const M=[],D=Tl(o,o.longestCutoffRange);D.shouldRenderCutoff&&M.push("RENDER_CUTOFF"),M.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&M.push("NORMAL_OFFSET");const G=yp(d,S,P),K=new zr(y.gl.LEQUAL,zr.ReadOnly,o.depthRangeFor3D);for(const Y of this._groundShadowTiles){const te=Y.toUnwrapped(),re=o.isTileAffectedByFog(Y),oe=o.getOrCreateProgram("groundShadow",{defines:M,overrideFog:re});this.setupShadows(te,oe),o.uploadCommonUniforms(y,oe,te,null,D);const ve={u_matrix:o.transform.calculateProjMatrix(te),u_ground_shadow_factor:G};oe.draw(o,y.gl.TRIANGLES,K,Wr.disabled,An.multiply,Kr.disabled,ve,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,{},o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?An.unblended:An.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const d=this.painter.transform,y=d.calculatePosMatrix(o,d.worldSize);return i.ab.mat4.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(o){return i.ab.mat4.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,d,y,S=0){if(!this.enabled)return;const P=this.painter.transform,M=this.painter.context,D=M.gl,G=this._uniformValues,K=new Float64Array(16),Y=P.calculatePosMatrix(o,P.worldSize);for(let te=0;te<this._cascades.length;te++)i.ab.mat4.multiply(K,this._cascades[te].matrix,Y),G[te===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(K),M.activeTexture.set(D.TEXTURE0+Rs.ShadowMap0+te),this._cascades[te].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const te=i.cc(o.canonical),re=2/P.tileSize*i.ag/Ra.shadowMapResolution,oe=re*this._cascades[0].boundingSphereRadius,ve=re*this._cascades[this._cascades.length-1].boundingSphereRadius,fe=(y==="vector-tile"?1:3)/Math.pow(2,S-o.canonical.z-(1-P.zoom+Math.floor(P.zoom)));G.u_shadow_normal_offset=[te,oe*fe,ve*fe],G.u_shadow_bias=[6e-5,.0012,.012]}else G.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(M,G)}setupShadowsFromMatrix(o,d,y=!1){if(!this.enabled)return;const S=this.painter.context,P=S.gl,M=this._uniformValues,D=new Float64Array(16);for(let G=0;G<Ra.cascadeCount;G++)i.ab.mat4.multiply(D,this._cascades[G].matrix,o),M[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),S.activeTexture.set(P.TEXTURE0+Rs.ShadowMap0+G),this._cascades[G].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=y,y){const G=Ra.normalOffset;M.u_shadow_normal_offset=[1,G,G],M.u_shadow_bias=[6e-5,.0012,.012]}else M.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(S,M)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,d,y,S){if(S[2]>=0)return{};const P=function(G,K,Y){const te=Y/(1<<G.canonical.z);return new i.cd([G.canonical.x*te+G.wrap*Y,G.canonical.y*te+G.wrap*Y,0],[(G.canonical.x+1)*te+G.wrap*Y,(G.canonical.y+1)*te+G.wrap*Y,K])}(o,d,y).getCorners(),M=d/-S[2];S[0]<0?(i.ab.vec3.add(P[0],P[0],[S[0]*M,0,0]),i.ab.vec3.add(P[3],P[3],[S[0]*M,0,0])):S[0]>0&&(i.ab.vec3.add(P[1],P[1],[S[0]*M,0,0]),i.ab.vec3.add(P[2],P[2],[S[0]*M,0,0])),S[1]<0?(i.ab.vec3.add(P[0],P[0],[0,S[1]*M,0]),i.ab.vec3.add(P[1],P[1],[0,S[1]*M,0])):S[1]>0&&(i.ab.vec3.add(P[2],P[2],[0,S[1]*M,0]),i.ab.vec3.add(P[3],P[3],[0,S[1]*M,0]));const D={};return D.vertices=P,D.planes=[zu(P[1],P[0],P[4]),zu(P[2],P[1],P[5]),zu(P[3],P[2],P[6]),zu(P[0],P[3],P[7])],D}addShadowReceiver(o,d,y){this._receivers.add(o,i.cd.fromTileIdAndHeight(o,d,y))}getMaxCascadeForTile(o){const d=this._receivers.get(o);return d&&d.lastCascade?d.lastCascade:0}}function zu(g,o,d){const y=i.ab.vec3.sub([],d,o),S=i.ab.vec3.sub([],g,o),P=i.ab.vec3.cross([],y,S),M=i.ab.vec3.length(P);return M===0?[0,0,1,0]:(i.ab.vec3.scale(P,P,1/M),[P[0],P[1],P[2],-i.ab.vec3.dot(P,o)])}function Kc(g){const o=g.properties.get("direction"),d=i.cb(o.x,o.y,o.z);d[2]=i.aw(d[2],0,75);const y=i.ce([d[0],d[1],d[2]]);return i.ab.vec3.fromValues(y.x,y.y,y.z)}function yp(g,o,d){const y=o.properties.get("color-use-theme")==="none",S=o.properties.get("color"),P=o.properties.get("intensity"),M=o.properties.get("direction"),D=[M.x,M.y,M.z],G=d.properties.get("color-use-theme")==="none",K=d.properties.get("color"),Y=d.properties.get("intensity"),te=Math.max(i.ab.vec3.dot([0,0,1],D),0),re=[0,0,0];i.ab.vec3.scale(re,K.toRenderColor(G?null:g.getLut(o.scope)).toArray01Linear().slice(0,3),Y);const oe=[0,0,0];return i.ab.vec3.scale(oe,S.toRenderColor(y?null:g.getLut(d.scope)).toArray01Linear().slice(0,3),te*P),i.cf([re[0]>0?re[0]/(re[0]+oe[0]):0,re[1]>0?re[1]/(re[1]+oe[1]):0,re[2]>0?re[2]/(re[2]+oe[2]):0])}function a0(g,o,d,y,S,P){const M=g.zoom,D=g.scale,G=g.worldSize,K=1/G,Y=g.aspect,te=Math.sqrt(1+Y*Y)*Math.tan(.5*g.fovX),re=te*te,oe=y-d,ve=y+d;let fe,be;re>oe/ve?(fe=y,be=y*te):(fe=.5*ve*(1+re),be=.5*Math.sqrt(oe*oe+2*(y*y+d*d)*re+ve*ve*re*re));const xe=g.projection.pixelsPerMeter(g.center.lat,G),Ce=g._camera.getCameraToWorldMercator(),Ue=[0,0,-fe*K];i.ab.vec3.transformMat4(Ue,Ue,Ce);let Be=be*K;const Xe=g._edgeInsets;if(!(Xe.left===0&&Xe.top===0&&Xe.right===0&&Xe.bottom===0||Xe.left===Xe.right&&Xe.top===Xe.bottom)){const Yt=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?xe:1),Bt=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,d,y);Bt[8]=2*-g.centerOffset.x/g.width,Bt[9]=2*g.centerOffset.y/g.height;const It=new Float64Array(16);i.ab.mat4.mul(It,Bt,Yt);const Ht=new Float64Array(16);i.ab.mat4.invert(Ht,It);const tr=i.bR.fromInvProjectionMatrix(Ht,G,M,!0);for(const gr of tr.points){const _r=((qe=gr)[0]/=D,qe[1]/=D,qe[2]=i.bH(qe[2],g._center.lat),qe);Be=Math.max(Be,i.ab.vec3.len(i.ab.vec3.subtract([],Ue,_r)))}}var qe;Be*=S/(S-1);const We=Math.acos(o[2]),$e=Math.atan2(-o[0],-o[1]),Ke=new fs;Ke.position=Ue,Ke.setPitchBearing(We,$e);const it=Ke.getWorldToCamera(G,xe),_t=Be*G,mt=Math.min(g._mercatorZfromZoom(17)*G*-2,-2*_t),Mt=Ke.getCameraToClipOrthographic(-_t,_t,-_t,_t,mt,(_t+P*xe)/o[2]),jt=new Float64Array(16);i.ab.mat4.multiply(jt,Mt,it);const dt=i.ab.vec3.fromValues(Math.floor(1e6*Ue[0])/1e6*G,Math.floor(1e6*Ue[1])/1e6*G,0),Et=.5*S,Ut=[0,0,0];i.ab.vec3.transformMat4(Ut,dt,jt),i.ab.vec3.scale(Ut,Ut,Et);const pt=[Math.floor(Ut[0]),Math.floor(Ut[1]),Math.floor(Ut[2])],Dt=[0,0,0];i.ab.vec3.sub(Dt,Ut,pt),i.ab.vec3.scale(Dt,Dt,-1/Et);const kt=new Float64Array(16);return i.ab.mat4.identity(kt),i.ab.mat4.translate(kt,kt,Dt),i.ab.mat4.multiply(jt,kt,jt),[jt,_t]}class Om extends i.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(o,d){return i.aM(this.requestManager.transformRequest(d,i.R.Model).url).then(y=>{if(!y)return;const S=i.aN(y),P=new i.aO(o,void 0,void 0,S);return P.computeBoundsAndApplyParent(),P}).catch(y=>{if(y&&y.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${o} from ${d}: ${y.message}`)))})}load(o,d,y={keepNumReferences:!1}){this.models[d]||(this.models[d]={});const S=Object.keys(o);this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+S.length;const P=[];for(const M of S)P.push(this.loadModel(M,o[M]));Promise.allSettled(P).then(M=>{for(let D=0;D<M.length;D++){const{status:G,value:K}=M[D];if(G==="fulfilled"&&K){const Y=this.models[d][S[D]];this.models[d][S[D]]={model:K,numReferences:y.keepNumReferences&&Y?Y.numReferences:1}}}this.numModelsLoading[d]-=S.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(M=>{this.fire(new i.y(new Error(`Could not load models: ${M.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,d){return!!this.getModel(o,d)}getModel(o,d){return this.models[d]||(this.models[d]={}),this.models[d][o]?this.models[d][o].model:void 0}addModel(o,d,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={}),this.hasModel(o,y)&&this.models[y][o].numReferences++,this.modelUris[y][o]=this.requestManager.normalizeModelURL(d),this.load({[o]:this.modelUris[y][o]},y)}addModels(o,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const y=this.modelUris[d];for(const S in o)this.models[d][S]={},y[S]=this.requestManager.normalizeModelURL(o[S]);this.load(y,d,{keepNumReferences:!0})}reloadModels(o){this.load(this.modelUris[o],o)}addModelsFromBucket(o,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const y={};for(const S of o)this.hasModel(S,d)?this.models[d][S].numReferences++:(this.modelUris[d][S]=this.requestManager.normalizeModelURL(S),y[S]=this.modelUris[d][S]);this.load(y,d)}removeModel(o,d){if(this.models[d]&&this.models[d][o]&&(this.models[d][o].numReferences--,this.models[d][o].numReferences===0)){const y=this.models[d][o].model;delete this.models[d][o],delete this.modelUris[d][o],y.destroy()}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,d){this.models[d]||(this.models[d]={});for(const y in this.models[d])this.models[d][y].model&&this.models[d][y].model.upload(o.context)}}const s0=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),o0={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function xy(g){return g=g||{},Object.assign(g,o0)}class _y extends i.E{constructor(o){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=o,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(o=>{o.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=o.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=o.stylesheet.indoor.buildingFeaturesetId,this._scope=o.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:o=>(o.feature&&o.feature.properties.floorplan&&this.selectFloorplan(o.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(o){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(M,D){const[G,K]=M,{center:Y,radius:te}=D,[re,oe]=Y,ve=Math.abs(G-re);return Math.sqrt((ve>180?360-ve:ve)**2+(K-oe)**2)<=te}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const d={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=new i.P(this._map.transform.width/2,this._map.transform.height/2),S=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],P=this._map.queryRenderedFeatures(o?S:y,d);P.length>0&&(this._selectedFloorplan&&P[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=P[0],this._floorplanSelected(!1)))}_floorplanSelected(o){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(P){const[[M,D],[G,K]]=P,Y=(G-M+360)%360,te=Y>180?360-Y:Y;return{center:[(M+te/2+360)%360,(D+K)/2],radius:Math.sqrt(te**2+(K-D)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const d=this._floorplanStates[this._indoorData.id].selectedBuilding,y=this._floorplanStates[this._indoorData.id].selectedLevel;let S;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const P of this._indoorData.levels)P.id===this._selectedLevel.id&&(S=P.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:S})),d){const P=this._indoorData.buildings.find(M=>M.id===d);this._buildingSelected(P,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(y){const P=this._indoorData.levels.find(M=>M.id===y);this._updateLevels(P,o)}else o&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(o,d){d&&o&&o.extent&&this._map.fitBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=o?o.id:void 0;const y=this._indoorData.levels.filter(S=>o.levels.includes(S.id));this.fire(new i.z("buildingselected",{buildingId:o.id,levels:y}))}_levelSelected(o){if(o==="overview")this._updateLevels(void 0,!0);else{const d=this._indoorData.levels.find(y=>y.id===o);this._updateLevels(d,!0)}this.fire(new i.z("levelselected",{levelId:o==="overview"?void 0:o}))}_updateLevels(o,d){if(!o)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(d&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function y(K){const Y=K.indexOf("/floor/");if(Y===-1)return K;const te=Y+7,re=K.indexOf("/",te);return re===-1?K.slice(te):K.slice(te,re)}this._selectedLevel=o,this._floorplanStates[this._indoorData.id].selectedLevel=o?o.id:void 0;const S=[],P={},M={},D={},G={};for(const K of this._indoorData.levels)if(S.push(K.id),P[K.id]=K.height,M[K.id]=K.base,o){if(this.mergeFloors){const Y=y(o.id),te=y(K.id);D[K.id]=te===Y?"true":"false"}else D[K.id]=K.id===o.id?"true":"false";G[K.id]=K.base<o.base?"true":"false"}else G[K.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",M]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",D]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",G]),o&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!o.isUnderground),d&&o.extent)){const K=this._map.cameraForBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),Y=this._map.getZoom(),te=K.zoom?Math.abs(Y-K.zoom):0;this._map.fitBounds(o.extent,te>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:Y})}}selectFloorplan(o){const d={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(y,d);if(S.length>0){for(const P of S)if(JSON.parse(P.properties["indoor-data"]).floorplanIDs.includes(o)){this._selectedFloorplan=P,this._floorplanSelected(!0);break}}}selectBuilding(o){const d=this._indoorData.buildings.find(y=>y.id===o);this._buildingSelected(d,!0)}selectLevel(o){this._levelSelected(o)}}function V_(g){if(!g.metadata||!g.metadata.content_area)return;const o=i.q.devicePixelRatio,{left:d,top:y,width:S,height:P}=g.metadata.content_area,M=d*o,D=y*o;return[M,D,M+S*o,D+P*o]}function l0(g){if(g)return g.map(([o,d])=>[o*i.q.devicePixelRatio,d*i.q.devicePixelRatio])}const Gs=(g,o)=>zo(g,o&&o.filter(d=>d.identifier!=="source.canvas")),vp=i.ay(hn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),by=i.ay(hn,["setCenter","setZoom","setBearing","setPitch"]),Nm=new Set(["background","sky","slot","custom"]),Qh={version:8,layers:[],sources:{}},wy={duration:300,delay:0};class Vo extends i.E{constructor(o,d={}){super(),this.map=o,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=i.l({},wy),this._buildingIndex=new $c(this),this.crossTileSymbolIndex=new yy,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new Rr,this.dispatcher=d.dispatcher?d.dispatcher:new i.D(i.ci(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new nn(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new i.cj(o._requestManager,d.localFontFamily?i.ck.all:d.localIdeographFontFamily?i.ck.ideographs:i.ck.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Om(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:d.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const y=this;this._rtlTextPluginCallback=Vo.registerForPluginStateChange(S=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(P,M)=>{if(i.cm(P),M&&M.every(D=>D))for(const D in y._sourceCaches){const G=y._sourceCaches[D],K=G.getSource().type;K!=="vector"&&K!=="geojson"||G.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const P=this.getOwnSource(S.sourceId);if(P&&P.vectorLayerIds)for(const M in this._layers){const D=this._layers[M];D.source===P.id&&this._validateLayer(D)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(i.f(o))return o;const d=i.cn(o);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${i.co(JSON.stringify(o))}`}_diffStyle(o,d,y){this.globalId=this._getGlobalId(o);const S=(P,M)=>{try{M(null,this.setState(P,y))}catch(D){M(D,!1)}};if(typeof o=="string"){const P=this.map._requestManager.normalizeStyleURL(o),M=this.map._requestManager.transformRequest(P,i.R.Style);i.n(M,(D,G)=>{D?this.fire(new i.y(D)):G&&S(G,d)})}else typeof o=="object"&&S(o,d)}loadURL(o,d={}){this.fire(new i.z("dataloading",{dataType:"style"}));const y=typeof d.validate=="boolean"?d.validate:!i.f(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,d.accessToken),this.resolvedImports.add(o);const S=this.importsCache.get(o);if(S)return this._load(S,y);const P=this.map._requestManager.transformRequest(o,i.R.Style);this._request=i.n(P,(M,D)=>{if(this._request=null,M)this.fire(new i.y(M));else if(D)return this.importsCache.set(o,D),this._load(D,y)})}loadJSON(o,d={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=i.q.frame(()=>{this._request=null,this._load(o,d.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(Qh,!1)}_loadImports(o,d,y){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const P of o){const M=this._createFragmentStyle(P),D=new Promise(Y=>{M.once("style.import.load",Y),M.once("error",Y)}).then(()=>this.mergeAll());if(S.push(D),this.resolvedImports.has(P.url)){M.loadEmpty();continue}const G=P.data||this.importsCache.get(P.url);G?(M.loadJSON(G,{validate:d}),this._isInternalStyle(G)&&(M.globalId=null)):P.url?M.loadURL(P.url,{validate:d}):M.loadEmpty();const K={style:M,id:P.id,config:P.config};if(y){const Y=this.fragments.findIndex(({id:te})=>te===y);this.fragments=this.fragments.slice(0,Y).concat(K).concat(this.fragments.slice(Y))}else this.fragments.push(K)}return Promise.allSettled(S)}getImportGlobalIds(o=this,d=new Set){for(const y of o.fragments)y.style.globalId&&d.add(y.style.globalId),this.getImportGlobalIds(y.style,d);return[...d.values()]}_createFragmentStyle(o){const d=this.scope?i.aC(o.id,this.scope):o.id;let y;const S=this._initialConfig&&this._initialConfig[d];(o.config||S)&&(y=i.l({},o.config,S));const P=new Vo(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return P.setEventedParent(this.map,{style:P}),P}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,d){const y=o.indoor?xy(o.schema):o.schema;if(this._isInternalStyle(o)){const M=i.l({},Qh,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(M,d)}if(this.updateConfig(this._config,y),d&&Gs(this,Ua(o)))return;this._loaded=!0,this.stylesheet=i.cp(o);const S=()=>{for(const K in o.sources)this.addSource(K,o.sources[K],{validate:!1,isInitialLoad:!0});o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(o.glyphs,this.scope);const M=Ru(this.stylesheet.layers);if(this._order=M.map(K=>K.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const K=this.stylesheet.lights[0];this.light=new ye(K.properties,K.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ye(this.stylesheet.light)),this._layers={};for(const K of M){const Y=i.cu(K,this.scope,this._styleColorTheme.lut,this.options);Y.configDependencies.size!==0&&this._configDependentLayers.add(Y.fqid),Y.setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y;const te=this.getOwnLayerSourceCache(Y),re=!!this.directionalLight&&this.directionalLight.shadowsEnabled();te&&Y.canCastShadows()&&re&&(te.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const D=this.stylesheet.terrain;D&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(D,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const G=this.isRootStyle();o.imports?this._loadImports(o.imports,d).then(()=>{this._reloadImports(),this.fire(new i.z(G?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(G?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const P=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(P){const M=this._evaluateColorThemeData(P);this._loadColorTheme(M).then(()=>{S()}).catch(D=>{i.w(`Couldn't load color theme from the stylesheet: ${D}`),S()})}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,d,y,S,P,M,D,G,K,Y;const te={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(re=>{if(re.stylesheet){if(re.light!=null&&(o=re.light),re.stylesheet.lights)for(const oe of re.stylesheet.lights)oe.type==="ambient"&&re.ambientLight!=null&&(d=re.ambientLight),oe.type==="directional"&&re.directionalLight!=null&&(y=re.directionalLight);S=this._prioritizeTerrain(S,re.terrain,re.stylesheet.terrain),re.stylesheet.fog&&re.fog!=null&&(P=re.fog),re.stylesheet.snow&&re.snow!=null&&(M=re.snow),re.stylesheet.rain&&re.rain!=null&&(D=re.rain),re.stylesheet.camera!=null&&(Y=re.stylesheet.camera),re.stylesheet.projection!=null&&(G=re.stylesheet.projection),re.stylesheet.transition!=null&&(K=re.stylesheet.transition),te[re.scope]=re._styleColorTheme}}),this.light=o,this.ambientLight=d,this.directionalLight=y,this.fog=P,this.snow=M,this.rain=D,this._styleColorThemeForScope=te,S===null?delete this.terrain:this.terrain=S,this.camera=Y||{"camera-projection":"perspective"},this.projection=G||{name:"mercator"},this.transition=i.l({},wy,K),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const d=y=>{for(const S of y.fragments)d(S.style);o(y)};d(this)}_prioritizeTerrain(o,d,y){const S=o&&o.drapeRenderMode===0;return y===null?d&&d.drapeRenderMode===0?d:S?o:null:d!=null&&(!o||S||d&&d.drapeRenderMode===1)?d:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{o=this._prioritizeTerrain(o,d.terrain,d.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(o=d.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},d={},y={};this.forEachFragmentStyle(S=>{for(const P in S._sourceCaches){const M=i.aC(P,S.scope);o[M]=S._sourceCaches[P]}for(const P in S._otherSourceCaches){const M=i.aC(P,S.scope);d[M]=S._otherSourceCaches[P]}for(const P in S._symbolSourceCaches){const M=i.aC(P,S.scope);y[M]=S._symbolSourceCaches[P]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=y}mergeLayers(){const o={},d=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(P=>{for(const M of P._order){const D=P._layers[M];if(D.type==="slot"){const G=i.cq(M);if(o[G])continue;o[G]=[]}D.slot&&o[D.slot]?o[D.slot].push(D):d.push(D)}}),this._mergedOrder=[];const S=(P=[])=>{for(const M of P)if(M.type==="slot"){const D=i.cq(M.id);o[D]&&S(o[D]),this._mergedSlots.push(D)}else{const D=i.aC(M.id,M.scope);this._mergedOrder.push(D),y[D]=M,M.is3D()&&(this._has3DLayers=!0),M.type==="circle"&&(this._hasCircleLayers=!0),M.type==="symbol"&&(this._hasSymbolLayers=!0),M.type==="clip"&&(this._clipLayerPresent=!0)}};S(d),this._mergedOrder.sort((P,M)=>{const D=y[P],G=y[M];return D.hasInitialOcclusionOpacityProperties?G.is3D()?1:0:D.is3D()&&G.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=i.l({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(d,y,S){const P=i.l({},y);for(const D of Object.keys(i.a3.colorTheme))P[D]===void 0&&(P[D]=i.a3.colorTheme[D].default);const M=new i.a4(s0,d,new Map(S));return M.setTransitionOrValue(P,S),M.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const d=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,S)=>{const P="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let M=o;M.startsWith(P)||(M=P+M);const D="mapbox-reserved-lut",G=new Image;G.src=M,G.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},G.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==d)return void y();this._styleColorTheme.lutLoading=!1;const{width:K,height:Y,data:te}=i.q.getImageData(G);if(Y>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(K!==Y*Y)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage(D)&&this.removeImage(D),this.addImage(D,{data:new i.r({width:K,height:Y},te),pixelRatio:1,sdf:!1,usvg:!1,version:0});const re=this.imageManager.getImage(D,this.scope);re?(this._styleColorTheme.lut={image:re.data,data:o},y()):S(new Error("Missing LUT image."))}})}getLut(o){const d=this._styleColorThemeForScope[o];return d?d.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(d,y,S){let P,M,D;const G=i.q.devicePixelRatio>1?"@2x":"";let K=i.n(y.transformRequest(y.normalizeSpriteURL(d,G,".json"),i.R.SpriteJSON),(re,oe)=>{K=null,D||(D=re,P=oe,te())}),Y=i.o(y.transformRequest(y.normalizeSpriteURL(d,G,".png"),i.R.SpriteImage),(re,oe)=>{Y=null,D||(D=re,M=oe,te())});function te(){if(D)S(D);else if(P&&M){const re=i.q.getImageData(M),oe={};for(const ve in P){const{width:fe,height:be,x:xe,y:Ce,sdf:Ue,pixelRatio:Be,stretchX:Xe,stretchY:qe,content:We}=P[ve],$e=new i.r({width:fe,height:be});i.r.copy(re,$e,{x:xe,y:Ce},{x:0,y:0},{width:fe,height:be},null),oe[ve]={data:$e,pixelRatio:Be,sdf:Ue,stretchX:Xe,stretchY:qe,content:We,usvg:!1}}S(null,oe)}}return{cancel(){K&&(K.cancel(),K=null),Y&&(Y.cancel(),Y=null)}}}(o,this.map._requestManager,(d,y)=>{if(this._spriteRequest=null,d)this.fire(new i.y(d));else if(y)for(const S in y)this.imageManager.addImage(S,this.scope,y[S]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(o){if(!i.f(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const d=this.map._spriteFormat==="auto";var y,S;this._spriteRequest=(S=(P,M)=>{if(this._spriteRequest=null,P)d?this._loadSprite(o):this.fire(new i.y(P));else if(M)for(const D in M)this.imageManager.addImage(D,this.scope,M[D]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(o),i.R.Iconset),(P,M)=>{if(P)return void S(P);const D={},G=i.cg(new i.bh(M));for(const K of G.icons){const Y={version:1,pixelRatio:i.q.devicePixelRatio,content:V_(K),stretchX:K.metadata?l0(K.metadata.stretch_x_areas):void 0,stretchY:K.metadata?l0(K.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:K};D[K.name]=Y}S(null,D)}))}_validateLayer(o){const d=this.getOwnSource(o.source);if(!d)return;const y=o.sourceLayer;y&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(y)===-1)&&this.fire(new i.y(new Error(`Source layer "${y}" does not exist on source "${d.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,d)=>{const y=this.fragments[d];return y&&y.style&&(o.data=y.style.serialize()),o})}_serializeSources(){const o={};for(const d in this._sourceCaches){const y=this._sourceCaches[d].getSource();o[y.id]||(o[y.id]=y.serialize())}return o}_serializeLayers(o){const d=[];for(const y of o){const S=this._layers[y];S&&S.type!=="custom"&&d.push(S.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const d=this.getOwnLayer(o);if(d)return d;this.fire(new i.y(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const d=this.getOwnSource(o);if(d)return d;this.fire(new i.y(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,d){const y=this.map.painter;if(y)for(let S=o.minzoom||0;S<(o.maxzoom||25.5);S++){const P=o.getProgramIds();if(P)for(const M of P){const D=o.getDefaultProgramParams(M,d.zoom,this._styleColorTheme.lut);D&&(y.style=this,this.fog&&(y._fogVisible=!0,D.overrideFog=!0,y.getOrCreateProgram(M,D)),y._fogVisible=!1,D.overrideFog=!1,y.getOrCreateProgram(M,D),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(D.overrideRtt=!0,y.getOrCreateProgram(M,D)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const d=this.calculateLightsBrightness();o.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d));const y=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const M=this._changes.getLayerUpdatesByScope();for(const D in M){const{updatedIds:G,removedIds:K}=M[D];(G||K)&&(this._updateWorkerLayers(D,G,K),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const P={};for(const M in this._mergedSourceCaches){const D=this._mergedSourceCaches[M];P[M]=D.used,D.used=!1,D.tileCoverLift=0}for(const M of this._mergedOrder){const D=this._mergedLayers[M];if(D.recalculate(o,this._availableImages),!D.isHidden(o.zoom)){const G=this.getLayerSourceCache(D);G&&(G.used=!0,G.tileCoverLift=Math.max(G.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,o)}):this.precompilePrograms(D,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();for(const M in P){const D=this._mergedSourceCaches[M];P[M]!==D.used&&D.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=this._changes.getUpdatedImages();if(o.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changes.resetUpdatedImages()}}_updateWorkerLayers(o,d,y){const S=this.getFragmentStyle(o);S&&this.dispatcher.broadcast("updateLayers",{layers:d?S._serializeLayers(d):[],scope:o,removedIds:y||[],options:S.options})}setState(o,d){if(this._checkLoaded(),Gs(this,Ua(o)))return!1;(o=i.cp(o)).layers=Ru(o.layers);const y=function(M,D){if(!M)return[{command:hn.setStyle,args:[D]}];let G=[];try{if(!i.bn(M.version,D.version))return[{command:hn.setStyle,args:[D]}];if(i.bn(M.center,D.center)||G.push({command:hn.setCenter,args:[D.center]}),i.bn(M.zoom,D.zoom)||G.push({command:hn.setZoom,args:[D.zoom]}),i.bn(M.bearing,D.bearing)||G.push({command:hn.setBearing,args:[D.bearing]}),i.bn(M.pitch,D.pitch)||G.push({command:hn.setPitch,args:[D.pitch]}),i.bn(M.sprite,D.sprite)||G.push({command:hn.setSprite,args:[D.sprite]}),i.bn(M.glyphs,D.glyphs)||G.push({command:hn.setGlyphs,args:[D.glyphs]}),i.bn(M.imports,D.imports)||function(oe=[],ve=[],fe){ve=ve||[];const be=(oe=oe||[]).map(hs),xe=ve.map(hs),Ce=oe.reduce(fc,{}),Ue=ve.reduce(fc,{}),Be=be.slice();let Xe,qe,We,$e;for(Xe=0,qe=0;Xe<be.length;Xe++)We=be[Xe],Ue.hasOwnProperty(We)?qe++:(fe.push({command:hn.removeImport,args:[We]}),Be.splice(Be.indexOf(We,qe),1));for(Xe=0,qe=0;Xe<xe.length;Xe++)We=xe[xe.length-1-Xe],Be[Be.length-1-Xe]!==We&&(Ce.hasOwnProperty(We)?(fe.push({command:hn.removeImport,args:[We]}),Be.splice(Be.lastIndexOf(We,Be.length-qe),1)):qe++,$e=Be[Be.length-Xe],fe.push({command:hn.addImport,args:[Ue[We],$e]}),Be.splice(Be.length-Xe,0,We));for(const Ke of ve){const it=Ce[Ke.id];it&&!i.bn(it,Ke)&&fe.push({command:hn.updateImport,args:[Ke.id,Ke]})}}(M.imports,D.imports,G),i.bn(M.transition,D.transition)||G.push({command:hn.setTransition,args:[D.transition]}),i.bn(M.light,D.light)||G.push({command:hn.setLight,args:[D.light]}),i.bn(M.fog,D.fog)||G.push({command:hn.setFog,args:[D.fog]}),i.bn(M.snow,D.snow)||G.push({command:hn.setSnow,args:[D.snow]}),i.bn(M.rain,D.rain)||G.push({command:hn.setRain,args:[D.rain]}),i.bn(M.projection,D.projection)||G.push({command:hn.setProjection,args:[D.projection]}),i.bn(M.lights,D.lights)||G.push({command:hn.setLights,args:[D.lights]}),i.bn(M.camera,D.camera)||G.push({command:hn.setCamera,args:[D.camera]}),!i.bn(M["color-theme"],D["color-theme"]))return[{command:hn.setStyle,args:[D]}];const K={},Y=[];(function(oe,ve,fe,be){let xe;for(xe in ve=ve||{},oe=oe||{})oe.hasOwnProperty(xe)&&(ve.hasOwnProperty(xe)||Iu(xe,fe,be));for(xe in ve){if(!ve.hasOwnProperty(xe))continue;const Ce=ve[xe];oe.hasOwnProperty(xe)?i.bn(oe[xe],Ce)||(oe[xe].type==="geojson"&&Ce.type==="geojson"&&mi(oe,ve,xe)?fe.push({command:hn.setGeoJSONSourceData,args:[xe,Ce.data]}):wr(xe,ve,fe,be)):Cm(xe,ve,fe)}})(M.sources,D.sources,Y,K);const te=[];M.layers&&M.layers.forEach(oe=>{oe.source&&K[oe.source]?G.push({command:hn.removeLayer,args:[oe.id]}):te.push(oe)});let re=M.terrain;re&&K[re.source]&&(G.push({command:hn.setTerrain,args:[void 0]}),re=void 0),G=G.concat(Y),i.bn(re,D.terrain)||G.push({command:hn.setTerrain,args:[D.terrain]}),function(oe,ve,fe){ve=ve||[];const be=(oe=oe||[]).map(hs),xe=ve.map(hs),Ce=oe.reduce(fc,{}),Ue=ve.reduce(fc,{}),Be=be.slice(),Xe=Object.create(null);let qe,We,$e,Ke,it,_t,mt;for(qe=0,We=0;qe<be.length;qe++)$e=be[qe],Ue.hasOwnProperty($e)?We++:(fe.push({command:hn.removeLayer,args:[$e]}),Be.splice(Be.indexOf($e,We),1));for(qe=0,We=0;qe<xe.length;qe++)$e=xe[xe.length-1-qe],Be[Be.length-1-qe]!==$e&&(Ce.hasOwnProperty($e)?(fe.push({command:hn.removeLayer,args:[$e]}),Be.splice(Be.lastIndexOf($e,Be.length-We),1)):We++,_t=Be[Be.length-qe],fe.push({command:hn.addLayer,args:[Ue[$e],_t]}),Be.splice(Be.length-qe,0,$e),Xe[$e]=!0);for(qe=0;qe<xe.length;qe++)if($e=xe[qe],Ke=Ce[$e],it=Ue[$e],!Xe[$e]&&!i.bn(Ke,it))if(i.bn(Ke.source,it.source)&&i.bn(Ke["source-layer"],it["source-layer"])&&i.bn(Ke.type,it.type)){for(mt in Gn(Ke.layout,it.layout,fe,$e,null,hn.setLayoutProperty),Gn(Ke.paint,it.paint,fe,$e,null,hn.setPaintProperty),i.bn(Ke.slot,it.slot)||fe.push({command:hn.setSlot,args:[$e,it.slot]}),i.bn(Ke.filter,it.filter)||fe.push({command:hn.setFilter,args:[$e,it.filter]}),i.bn(Ke.minzoom,it.minzoom)&&i.bn(Ke.maxzoom,it.maxzoom)||fe.push({command:hn.setLayerZoomRange,args:[$e,it.minzoom,it.maxzoom]}),Ke)Ke.hasOwnProperty(mt)&&mt!=="layout"&&mt!=="paint"&&mt!=="filter"&&mt!=="metadata"&&mt!=="minzoom"&&mt!=="maxzoom"&&mt!=="slot"&&(mt.indexOf("paint.")===0?Gn(Ke[mt],it[mt],fe,$e,mt.slice(6),hn.setPaintProperty):i.bn(Ke[mt],it[mt])||fe.push({command:hn.setLayerProperty,args:[$e,mt,it[mt]]}));for(mt in it)it.hasOwnProperty(mt)&&!Ke.hasOwnProperty(mt)&&mt!=="layout"&&mt!=="paint"&&mt!=="filter"&&mt!=="metadata"&&mt!=="minzoom"&&mt!=="maxzoom"&&mt!=="slot"&&(mt.indexOf("paint.")===0?Gn(Ke[mt],it[mt],fe,$e,mt.slice(6),hn.setPaintProperty):i.bn(Ke[mt],it[mt])||fe.push({command:hn.setLayerProperty,args:[$e,mt,it[mt]]}))}else fe.push({command:hn.removeLayer,args:[$e]}),_t=Be[Be.lastIndexOf($e)+1],fe.push({command:hn.addLayer,args:[it,_t]})}(te,D.layers,G)}catch(K){console.warn("Unable to compute style diff:",K),G=[{command:hn.setStyle,args:[D]}]}return G}(this.serialize(),o).filter(M=>!(M.command in by));if(y.length===0)return!1;const S=y.filter(M=>!(M.command in vp));if(S.length>0)throw new Error(`Unimplemented: ${S.map(M=>M.command).join(", ")}.`);const P=[];return y.forEach(M=>{P.push(this[M.command].apply(this,M.args))}),d&&Promise.all(P).then(d),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(o,d){return this.getImage(o)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,this.scope,d),this._afterImageUpdated(o),this)}updateImage(o,d,y=!1){this.imageManager.updateImage(o,this.scope,d),y&&this._afterImageUpdated(o)}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._afterImageUpdated(o),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(o),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(o,d,y={}){return this._checkLoaded(),this._validate(ju,`models.${o}`,d,null,y)||(this.modelManager.addModel(o,d,this.scope),this._changes.setDirty()),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,d,y={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(Us,`sources.${o}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const S=ao(o,d,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const P=M=>{const D=(M?"symbol:":"other:")+S.id,G=i.aC(D,this.scope),K=this._sourceCaches[D]=new Fo(G,S,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=K,K.onAdd(this.map)};P(!1),d.type!=="vector"&&d.type!=="geojson"||P(!0),S.onAdd&&S.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const d=this.getOwnSource(o);if(!d)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===o)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(o);for(const S of y){const P=i.cq(S.id);delete this._sourceCaches[P],this._changes.discardSourceCacheUpdate(S.id),S.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,d){this._checkLoaded(),this.getOwnSource(o).setData(d),this._changes.setDirty()}getOwnSource(o){const d=this.getOwnSourceCache(o);return d&&d.getSource()}getOwnSources(){const o=[];for(const d in this._otherSourceCaches){const y=this.getOwnSourceCache(d);y&&o.push(y.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const d in o){const y=o[d]._tiles;for(const S in y){const P=y[S];if(P.state!=="loaded"&&P.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const S of o){if(this._validate(ha,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const P=this.ambientLight;P.set(S),P.updateTransitions(d)}else this.ambientLight=new Ur(S,rr||(rr=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const P=this.directionalLight;P.set(S),P.updateTransitions(d)}else this.directionalLight=new Ur(S,sr||(sr=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=new i.a8(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,d=this.ambientLight;if(!o||!d)return;const y=re=>.2126*(re[0]<=.03928?re[0]/12.92:Math.pow((re[0]+.055)/1.055,2.4))+.7152*(re[1]<=.03928?re[1]/12.92:Math.pow((re[1]+.055)/1.055,2.4))+.0722*(re[2]<=.03928?re[2]/12.92:Math.pow((re[2]+.055)/1.055,2.4)),S=o.properties.get("color").toRenderColor(null).toArray01(),P=o.properties.get("intensity"),M=o.properties.get("direction"),D=1-i.cb(M.x,M.y,M.z)[2]/90,G=y(S)*P*D,K=d.properties.get("color").toRenderColor(null).toArray01(),Y=d.properties.get("intensity"),te=y(K)*Y;return Number(((G+te)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(!o)return this;if(i.cr(o)){const d=i.cs(o),y=this.fragments.find(({id:P})=>P===d);if(!y)throw new Error(`Style import '${o}' not found`);const S=i.cq(o);return y.style.getFragmentStyle(S)}{const d=this.fragments.find(({id:y})=>y===o);return d?d.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const d={},y=(S,P="")=>`${S}::${P}`;this._featuresetSelectors={};for(const S in o){const P=this._featuresetSelectors[S]=[];for(const M of o[S].selectors){if(M.featureNamespace){const G=this.getOwnLayer(M.layer);if(!G){i.w(`Layer is undefined for selector: ${M.layer}`);continue}const K=y(G.source,G.sourceLayer);if(K in d&&d[K]!==M.featureNamespace){i.w(`"featureNamespace ${M.featureNamespace} of featureset ${S}'s selector is not associated to the same source, skip this selector`);continue}d[K]=M.featureNamespace}let D;if(M.properties)for(const G in M.properties){const K=i.U(M.properties[G]);K.result==="success"&&(D=D||{},D[G]=K.value)}P.push({layerId:M.layer,namespace:M.featureNamespace,properties:D,uniqueFeatureID:M._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const d=this.getFragmentStyle(o);if(!d||!d.stylesheet.featuresets)return[];const y=[];for(const S in d.stylesheet.featuresets)y.push({featuresetId:S,importId:d.scope?d.scope:void 0});return y}getFeaturesetLayers(o,d){const y=this.getFragmentStyle(d),S=y.stylesheet.featuresets;if(!S||!S[o])return this.fire(new i.y(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const P=[];for(const M of S[o].selectors){const D=y.getOwnLayer(M.layer);D&&P.push(D)}return P}getConfigProperty(o,d){const y=this.getFragmentStyle(o);if(!y)return null;const S=i.aC(d,y.scope),P=y.options.get(S),M=P?P.value||P.default:null;return M?M.serialize():null}setConfigProperty(o,d,y){const S=this.getFragmentStyle(o);if(!S)return;const P=S.stylesheet.indoor?xy(S.stylesheet.schema):S.stylesheet.schema;if(!P||!P[d])return;const M=i.U(y);if(M.result!=="success")return void Gs(this,M.value);const D=M.value.expression,G=i.aC(d,S.scope),K=S.options.get(G);if(!K)return;let Y;const{minValue:te,maxValue:re,stepValue:oe,type:ve,values:fe}=P[d],be=i.U(P[d].default);be.result==="success"&&(Y=be.value.expression),Y?(this.options.set(G,Object.assign({},K,{value:D,default:Y,minValue:te,maxValue:re,stepValue:oe,type:ve,values:fe})),this.updateConfigDependencies(d)):this.fire(new i.y(new Error(`No schema defined for the config option "${d}" in the "${o}" fragment.`)))}getConfig(o){const d=this.getFragmentStyle(o);if(!d)return null;const y=d.stylesheet.schema;if(!y)return null;const S={};for(const P in y){const M=i.aC(P,d.scope),D=d.options.get(M),G=D?D.value||D.default:null;S[P]=G?G.serialize():null}return S}setConfig(o,d){const y=this.getFragmentStyle(o);y&&(y.updateConfig(d,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const d=this.getFragmentStyle(o);return d?d.stylesheet.schema:null}setSchema(o,d){const y=this.getFragmentStyle(o);y&&(y.stylesheet.schema=d,y.updateConfig(y._config,d),this.updateConfigDependencies())}updateConfig(o,d){if(this._config=o,o||d)if(d)for(const y in d){let S,P;const M=i.U(d[y].default);if(M.result==="success"&&(S=M.value.expression),o&&o[y]!==void 0){const re=i.U(o[y]);re.result==="success"&&(P=re.value.expression)}const{minValue:D,maxValue:G,stepValue:K,type:Y,values:te}=d[y];if(S){const re=i.aC(y,this.scope);this.options.set(re,{default:S,value:P,minValue:D,maxValue:G,stepValue:K,type:Y,values:te})}else this.fire(new i.y(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const d of this._configDependentLayers){const y=this.getLayer(d);if(y){if(o&&!y.configDependencies.has(o))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(d=>{const y=d._styleColorTheme.colorThemeOverride?d._styleColorTheme.colorThemeOverride:d._styleColorTheme.colorTheme;if(y){const S=d._evaluateColorThemeData(y);(!d._styleColorTheme.lut&&S!==""||d._styleColorTheme.lut&&S!==d._styleColorTheme.lut.data)&&d.setColorTheme(y)}}),this._changes.setDirty()}addLayer(o,d,y={}){this._checkLoaded();const S=o.id;if(this._layers[S])return void this.fire(new i.y(new Error(`Layer with id "${S}" already exists on this map`)));let P;if(o.type==="custom"){if(Gs(this,i.ct(o)))return;P=i.cu(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(S,o.source),o=i.cp(o),o=i.l(o,{source:S})),this._validate(Ns,`layers.${S}`,o,{arrayIndex:-1},y))return;P=i.cu(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(P),P.setEventedParent(this,{layer:{id:S}})}P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid);let M=this._order.length;if(d){const Y=this._order.indexOf(d);if(Y===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));P.slot===this._layers[d].slot?M=Y:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(M,0,S),this._layerOrderChanged=!0,this._layers[S]=P;const D=this.getOwnLayerSourceCache(P),G=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&P.canCastShadows()&&G&&(D.castsShadows=!0);const K=this._changes.getRemovedLayer(P);if(K&&P.source&&D&&P.type!=="custom"){this._changes.discardLayerRemoval(P);const Y=i.aC(P.source,P.scope);K.type!==P.type?this._changes.updateSourceCache(Y,"clear"):(this._changes.updateSourceCache(Y,"reload"),D.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),P.scope=this.scope,this.mergeLayers()}moveLayer(o,d){this._checkLoaded();const y=this._checkLayer(o);if(!y||o===d)return;const S=this._order.indexOf(o);this._order.splice(S,1);let P=this._order.length;if(d){const M=this._order.indexOf(d);if(M===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));y.slot===this._layers[d].slot?P=M:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const d=this._checkLayer(o);if(!d)return;d.setEventedParent(null);const y=this._order.indexOf(o);this._order.splice(y,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const S=this.getOwnLayerSourceCache(d);if(S&&S.castsShadows){let P=!1;for(const M in this._layers)if(this._layers[M].source===d.source&&this._layers[M].canCastShadows()){P=!0;break}S.castsShadows=P}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const d in this._layers)if(this._layers[d].type===o)return!0;return!1}setLayerZoomRange(o,d,y){this._checkLoaded();const S=this._checkLayer(o);S&&(S.minzoom===d&&S.maxzoom===y||(d!=null&&(S.minzoom=d),y!=null&&(S.maxzoom=y),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,d){this._checkLoaded();const y=this._checkLayer(o);y&&y.slot!==d&&(y.slot=d,this._updateLayer(y))}setFilter(o,d,y={}){this._checkLoaded();const S=this._checkLayer(o);if(S&&!i.bn(S.filter,d))return d==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(Ui,`layers.${S.id}.filter`,d,{layerType:S.type},y)||(S.filter=i.cp(d),this._updateLayer(S)))}getFilter(o){const d=this._checkLayer(o);if(d)return i.cp(d.filter)}setLayoutProperty(o,d,y,S={}){this._checkLoaded();const P=this._checkLayer(o);if(P&&!i.bn(P.getLayoutProperty(d),y)){if(y!=null&&(!S||S.validate!==!1)&&Gs(P,us.call(Ua,{key:`layers.${o}.layout.${d}`,layerType:P.type,objectKey:d,value:y,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;P.setLayoutProperty(d,y),P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),this._updateLayer(P)}}getLayoutProperty(o,d){const y=this._checkLayer(o);if(y)return y.getLayoutProperty(d)}setPaintProperty(o,d,y,S={}){this._checkLoaded();const P=this._checkLayer(o);if(!P||i.bn(P.getPaintProperty(d),y)||y!=null&&(!S||S.validate!==!1)&&Gs(P,Ss.call(Ua,{key:`layers.${o}.paint.${d}`,layerType:P.type,objectKey:d,value:y,styleSpec:i.a3})))return;const M=P.setPaintProperty(d,y);P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),M&&this._updateLayer(P),this._changes.updatePaintProperties(P)}getPaintProperty(o,d){const y=this._checkLayer(o);if(y)return y.getPaintProperty(d)}setFeatureState(o,d){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:G,importId:K}=o.target,Y=this.getFragmentStyle(K),te=Y.getFeaturesetLayers(G);for(const{source:re,sourceLayer:oe}of te)Y.setFeatureState({id:o.id,source:re,sourceLayer:oe},d)}else if("layerId"in o.target){const{layerId:G}=o.target,K=this.getLayer(G);this.setFeatureState({id:o.id,source:K.source,sourceLayer:K.sourceLayer},d)}return}const y=o.source,S=o.sourceLayer,P=this._checkSource(y);if(!P)return;const M=P.type;if(M==="geojson"&&S)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(M==="vector"&&!S)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const D=this.getOwnSourceCaches(y);for(const G of D)G.setFeatureState(S,o.id,d)}removeFeatureState(o,d){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:G,importId:K}=o.target,Y=this.getFragmentStyle(K),te=Y.getFeaturesetLayers(G);for(const{source:re,sourceLayer:oe}of te)Y.removeFeatureState({id:o.id,source:re,sourceLayer:oe},d)}else if("layerId"in o.target){const{layerId:G}=o.target,K=this.getLayer(G);this.removeFeatureState({id:o.id,source:K.source,sourceLayer:K.sourceLayer},d)}return}const y=o.source,S=this._checkSource(y);if(!S)return;const P=S.type,M=P==="vector"?o.sourceLayer:void 0;if(P==="vector"&&!M)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const D=this.getOwnSourceCaches(y);for(const G of D)G.removeFeatureState(M,o.id,d)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let P;if("featuresetId"in o.target){const{featuresetId:M,importId:D}=o.target,G=this.getFragmentStyle(D),K=G.getFeaturesetLayers(M);for(const{source:Y,sourceLayer:te}of K){const re=G.getFeatureState({id:o.id,source:Y,sourceLayer:te});if(re&&!P)P=re;else if(!i.bn(P,re))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:M}=o.target,D=this.getLayer(M);P=this.getFeatureState({id:o.id,source:D.source,sourceLayer:D.sourceLayer})}return P}const d=o.source,y=o.sourceLayer,S=this._checkSource(d);if(S){if(S.type!=="vector"||y)return o.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(y,o.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=i.l({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),d=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateFilteredLayers(o){for(const d of Object.values(this._mergedLayers))o(d)&&this._updateLayer(d)}_updateLayer(o){this._changes.updateLayer(o);const d=this.getLayerSourceCache(o),y=i.aC(o.source,o.scope),S=this._changes.getUpdatedSourceCaches();o.source&&!S[y]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),d.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const d=D=>this._mergedLayers[D].is3D(),y=this.order,S={},P=[];for(let D=y.length-1;D>=0;D--){const G=y[D];if(d(G)){S[G]=D;for(const K of o){const Y=K[G];if(Y)for(const te of Y)P.push(te)}}}P.sort((D,G)=>G.intersectionZ-D.intersectionZ);const M=[];for(let D=y.length-1;D>=0;D--){const G=y[D];if(d(G))for(let K=P.length-1;K>=0;K--){const Y=P[K].feature;if(Y.layer&&S[Y.layer.id]<D)break;M.push(Y),P.pop()}else for(const K of o){const Y=K[G];if(Y)for(const te of Y)M.push(te.feature)}}return M}queryRenderedFeatures(o,d,y){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate(Ui,"queryRenderedFeatures.filter",d.filter,null,d),S=i.aZ(d.filter));const P={},M=Y=>{if(Nm.has(Y.type))return;const te=this.getOwnLayerSourceCache(Y),re=P[te.id]=P[te.id]||{sourceCache:te,layers:{},has3DLayers:!1};Y.is3D()&&(re.has3DLayers=!0),re.layers[Y.fqid]=re.layers[Y.fqid]||{styleLayer:Y,targets:[]},re.layers[Y.fqid].targets.push({filter:S})};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const Y of d.layers){const te=this._layers[Y];if(!te)return this.fire(new i.y(new Error(`The layer '${Y}' does not exist in the map's style and cannot be queried for features.`))),[];M(te)}}else for(const Y in this._layers)M(this._layers[Y]);const D=this._queryRenderedFeatures(o,P,y),G=this._flattenAndSortRenderedFeatures(D),K=[];for(const Y of G)i.cs(Y.layer.id)===this.scope&&K.push(Y);return K}queryRenderedFeatureset(o,d,y){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate(Ui,"queryRenderedFeatures.filter",d.filter,null,d),S=i.aZ(d.filter));const P="mock",M=[];if(d&&d.target)M.push(Object.assign({},d,{targetId:P,filter:S}));else{const Y=this.getFeaturesetDescriptors();for(const te of Y)M.push({targetId:P,filter:S,target:te});for(const{style:te}of this.fragments){const re=te.getFeaturesetDescriptors();for(const oe of re)M.push({targetId:P,filter:S,target:oe})}}const D=this.queryRenderedTargets(o,M,y),G=[],K=new Set;for(const Y of D)for(const te of Y.variants[P])wl(te,Y,K)||G.push(new i.cw(Y,te));return G}queryRenderedTargets(o,d,y){const S={},P=(D,G,K,Y)=>{const te=S[G.id]=S[G.id]||{sourceCache:G,layers:{},has3DLayers:!1};if(te.layers[D.fqid]=te.layers[D.fqid]||{styleLayer:D,targets:[]},D.is3D()&&(te.has3DLayers=!0),!Y)return K.uniqueFeatureID=!1,void te.layers[D.fqid].targets.push(K);te.layers[D.fqid].targets.push(Object.assign({},K,{namespace:Y.namespace,properties:Y.properties,uniqueFeatureID:Y.uniqueFeatureID}))};for(const D of d)if("featuresetId"in D.target){const{featuresetId:G,importId:K}=D.target,Y=this.getFragmentStyle(K);if(!Y||!Y._featuresetSelectors)continue;const te=Y._featuresetSelectors[G];if(!te){this.fire(new i.y(new Error(`The featureset '${G}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const re of te){const oe=Y.getOwnLayer(re.layerId);oe&&!Nm.has(oe.type)&&P(oe,Y.getOwnLayerSourceCache(oe),D,re)}}else if("layerId"in D.target){const{layerId:G}=D.target,K=this.getLayer(G);if(!K||Nm.has(K.type))continue;P(K,this.getLayerSourceCache(K),D)}const M=this._queryRenderedFeatures(o,S,y);return this._flattenAndSortRenderedFeatures(M)}_queryRenderedFeatures(o,d,y){const S=[],P=!!this.map._showQueryGeometry,M=Vr.createFromScreenPoints(o,y);for(const D in d){const G=Vc(M,d[D],this._availableImages,y,P);Object.keys(G).length&&S.push(G)}if(this.placement)for(const D in d){if(!d[D].sourceCache._onlySymbols)continue;const G=Wh(M.screenGeometry,d[D],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(G).length&&S.push(G)}return S}querySourceFeatures(o,d){const y=d&&d.filter;y&&this._validate(Ui,"querySourceFeatures.filter",y,null,d);let S=[];const P=this.getOwnSourceCaches(o);for(const M of P)S=S.concat(r0(M,d));return S}addSourceType(o,d,y){return Vo.getSourceType(o)?y(new Error(`A source type called "${o}" already exists.`)):(Vo.setSourceType(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,d,y={}){this._checkLoaded();const S=this.light.getLight();let P=!1;for(const D in o)if(!i.bn(o[D],S[D])){P=!0;break}if(!P)return;const M=this._getTransitionParameters();this.light.setLight(o,d,y),this.light.updateTransitions(M)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,d=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),d===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=o;const S=o.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const D="terrain-dem-src";this.addSource(D,y.source),y=i.cp(y),y=i.l(y,{source:D})}const P=i.l({},y),M={};if(this.terrain&&S){P.source=this.terrain.get().source;const D=this.terrain?this.getFragmentStyle(this.terrain.scope):null;D&&(M.style=D.serialize())}if(this._validate(Ta,"terrain",P,M))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&d!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,d),this.fire(new i.z("data",{dataType:"style"}))}else{const P=this.terrain,M=P.get();for(const D of Object.keys(i.a3.terrain))!y.hasOwnProperty(D)&&i.a3.terrain[D].default&&(y[D]=i.a3.terrain[D].default);for(const D in o)if(!i.bn(o[D],M[D])){P.set(o,this.options),this.stylesheet.terrain=o;const G=this._getTransitionParameters({duration:0});P.updateTransitions(G),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const d=this.fog=new wt(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_createSnow(o){const d=this.snow=new Ar(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_createRain(o){const d=this.rain=new $r(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!i.bn(d.get(),o)){d.set(o,this.options),this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const d=this.snow;if(!i.bn(d.get(),o)){d.set(o,this.options),this.stylesheet.snow=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const d=this.rain;if(!i.bn(d.get(),o)){d.set(o,this.options),this.stylesheet.rain=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()},d=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!d)return this._styleColorTheme.lut=null,void o();const y=this._evaluateColorThemeData(d);this._loadColorTheme(y).then(()=>{this.fire(new i.z("colorthemeset")),o()}).catch(S=>{i.w(`Couldn't set color theme: ${S}`)})}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,d){const y=this.getFragmentStyle(o);y&&(y._styleColorTheme.colorThemeOverride=d,y._reloadColorTheme())}_getTransitionParameters(o){return{now:i.q.now(),transition:i.l(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],d=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?o.push(y):d.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...d)}_createTerrain(o,d){const y=this.terrain=new Se(o,d,this.scope,this.options);d===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});y.updateTransitions(S)}_force3DLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="symbol"&&this._updateLayer(d)}}_validate(o,d,y,S,P={}){if(P&&P.validate===!1)return!1;const M=i.l({},this.serialize());return Gs(this,o.call(Ua,i.l({key:d,style:M,value:y,styleSpec:i.a3},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(o){const d=this.getSourceCaches(o);for(const y of d)y.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){const d=this.getSourceCaches(o);for(const y of d)y.resume(),y.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(o=>{o.modelManager.reloadModels(o.scope)})}updateSources(o){let d;this.directionalLight&&(d=Kc(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(o,void 0,void 0,d)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const d=this._sourceCaches[o];d.resume(),d.reload()}}_updatePlacement(o,d,y,S,P,M,D=!1){let G=!1,K=!1;const Y={},te={};for(const re of this._mergedOrder){const oe=this._mergedLayers[re];if(oe.type!=="symbol")continue;const ve=i.aC(oe.source,oe.scope);let fe=Y[ve];if(!fe){const xe=this.getLayerSourceCache(oe);if(!xe)continue;const Ce=xe.getRenderableIds(!0).map(Ue=>xe.getTileByID(Ue));te[ve]=Ce.slice(),fe=Y[ve]=Ce.sort((Ue,Be)=>Be.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(Be.tileID)?-1:1))}const be=this.crossTileSymbolIndex.addLayer(oe,fe,d.center.lng,d.projection);G=G||be}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),d.zoom))&&(this.pauseablePlacement=new F_(d,this._mergedOrder,D,y,S,P,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Y,te,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),K=!0),G&&this.pauseablePlacement.placement.setStale()),K||G){this._buildingIndex.onNewFrame(d.zoom);for(let re=0;re<this._mergedOrder.length;re++){const oe=this._mergedLayers[this._mergedOrder[re]];if(oe.type!=="symbol")continue;const ve=this.isLayerClipped(oe);this.placement.updateLayerOpacities(oe,Y[i.aC(oe.source,oe.scope)],re,ve?M:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,d){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:P})=>P===o.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!d)return y.push(o),this._loadImports([o],!0);const S=y.findIndex(({id:P})=>P===d);return S===-1&&this.fire(new i.y(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,S).concat(o).concat(y.slice(S)),this._loadImports([o],!0,d)}updateImport(o,d){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(o);return S===-1?this:typeof d=="string"?(this.setImportUrl(o,d),this):(d.url&&d.url!==y[S].url&&this.setImportUrl(o,d.url),i.bn(d.config,y[S].config)||this.setImportConfig(o,d.config,d.data.schema),i.bn(d.data,y[S].data)||this.setImportData(o,d.data),this)}moveImport(o,d){this._checkLoaded();let y=this.stylesheet.imports||[];const S=this.getImportIndex(o);if(S===-1)return this;const P=this.getImportIndex(d);if(P===-1)return this;const M=y[S],D=this.fragments[S];return y=y.filter(({id:G})=>G!==o),this.fragments=this.fragments.filter(({id:G})=>G!==o),this.stylesheet.imports=y.slice(0,P).concat(M).concat(y.slice(P)),this.fragments=this.fragments.slice(0,P).concat(D).concat(this.fragments.slice(P)),this.mergeLayers(),this}setImportUrl(o,d){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(o);if(S===-1)return this;y[S].url=d;const P=this.fragments[S];return P.style=this._createFragmentStyle(y[S]),P.style.on("style.import.load",()=>this.mergeAll()),P.style.loadURL(d),this}setImportData(o,d){this._checkLoaded();const y=this.getImportIndex(o),S=this.stylesheet.imports||[];return y===-1?this:d?(this.fragments[y].style.setState(d),this._reloadImports(),this):(delete S[y].data,this.setImportUrl(o,S[y].url))}setImportConfig(o,d,y){this._checkLoaded();const S=this.getImportIndex(o),P=this.stylesheet.imports||[];if(S===-1)return this;d?P[S].config=d:delete P[S].config;const M=this.fragments[S];y&&M.style.stylesheet&&(M.style.stylesheet.schema=y);const D=M.style.stylesheet&&M.style.stylesheet.schema;return M.config=d,M.style.updateConfig(d,D),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const d=this.stylesheet.imports||[],y=this.getImportIndex(o);y!==-1&&(d.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(o){const d=(this.stylesheet.imports||[]).findIndex(y=>y.id===o);return d===-1&&this.fire(new i.y(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),d}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const d in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[d];y&&o.push(y.getSource())}return o}getSource(o,d){const y=this.getSourceCache(o,d);return y&&y.getSource()}getLayerSource(o){const d=this.getLayerSourceCache(o);return d&&d.getSource()}getSourceCache(o,d){const y=i.aC(o,d);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(o){const d=i.aC(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[o]&&d.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&d.push(this._mergedSymbolSourceCaches[o]),d}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const d in o){const y=o[d];y==="reload"?this.reloadSource(d):y==="clear"&&this.clearSource(d)}}updateLayers(o){const d=this._changes.getUpdatedPaintProperties();for(const y of d){const S=this.getLayer(y);S&&S.updateTransitions(o)}}getImages(o,d,y){this.imageManager.getImages(d.icons,d.scope,y),this._updateTilesForChangedImages();const S=P=>{P&&P.setDependencies(d.tileID.key,d.type,d.icons)};S(this._otherSourceCaches[d.source]),S(this._symbolSourceCaches[d.source])}rasterizeImages(o,d,y){this.imageManager.rasterizeImages(d,y)}getGlyphs(o,d,y){this.glyphManager.getGlyphs(d.stacks,d.scope,y)}getResource(o,d,y){return i.cy(d,y)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const d=[];return this._otherSourceCaches[o]&&d.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&d.push(this._symbolSourceCaches[o]),d}_isSourceCacheLoaded(o){const d=this.getOwnSourceCaches(o);return d.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${o}'`))),!1):d.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,d){if(!this._clipLayerPresent&&o.type!=="fill-extrusion")return!1;const y=o.type==="fill-extrusion"&&o.sourceLayer==="building";if(o.is3D()){if(y||d&&d.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Vo.getSourceType=function(g){return ts[g]},Vo.setSourceType=function(g,o){ts[g]=o},Vo.registerForPluginStateChange=i.ch;var Rm=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,xp=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Zc=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,yc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Fu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,_p=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Bu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Yc=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,vc=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ld=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Vu=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const xc=[];Uu(Rm,xc),Uu(Zc,xc),Uu(xp,xc);const zd={"_prelude_fog.vertex.glsl":_p,"_prelude_terrain.vertex.glsl":Fu,"_prelude_shadow.vertex.glsl":Ld,"_prelude_fog.fragment.glsl":Bu,"_prelude_shadow.fragment.glsl":Vu,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Yc,"_prelude_raster_particle.glsl":vc},ef={};Tn("",Fu),Tn(Bu,_p),Tn(Vu,Ld),Tn(Yc,""),Tn(vc,"");const bp=Tn(xp,Zc),tf=Rm;var Fd={background:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Tn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Tn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Tn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Tn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Tn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Tn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Tn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Tn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Tn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Tn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Tn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Tn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Tn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Tn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,yc),skyboxGradient:Tn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,yc),skyboxCapture:Tn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Tn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Tn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Tn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Tn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Tn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Tn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Tn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Uu(g,o){const d=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of d)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=y.split(" ");for(const P of S)o.includes(P)||o.push(P)}}function Tn(g,o){const d=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(K=>{const Y=K.split(" ");return Y[Y.length-1]}),S=[...new Set(S)]);const P={},M=[],D=[];if(g=g.replace(d,(K,Y)=>(D.push(Y),"")),(o=o.replace(d,(K,Y)=>(M.push(Y),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let G=[...xc];Uu(g,G),Uu(o,G);for(const K of[...M,...D])zd[K]||console.error(`Undefined include: ${K}`),ef[K]||(ef[K]=[],Uu(zd[K],ef[K])),G=[...G,...ef[K]];return{fragmentSource:g=g.replace(y,(K,Y,te,re,oe)=>(P[oe]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
in ${te} ${re} ${oe};
#else
uniform ${te} ${re} u_${oe};
#endif
`:Y==="initialize"?`
#ifdef HAS_UNIFORM_u_${oe}
    ${te} ${re} ${oe} = u_${oe};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${te} ${re} ${oe};
#endif
`:Y==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(y,(K,Y,te,re,oe)=>{const ve=re==="float"?"vec2":re,fe=oe.match(/color/)?"color":ve;return Y==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
in ${te} ${re} a_${oe};
#endif
`:P[oe]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${te} ${ve} a_${oe};
out ${te} ${re} ${oe};
#else
uniform ${te} ${re} u_${oe};
#endif
`:Y==="initialize"?fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = a_${oe};
#else
    ${te} ${re} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = unpack_mix_${fe}(a_${oe}, u_${oe}_t);
#else
    ${te} ${re} ${oe} = u_${oe};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${te} ${re} a_${oe};
    out ${te} ${re} ${oe};
#endif
`:Y==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${oe} = a_${oe};
#endif
`:void 0:Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${te} ${ve} a_${oe};
#else
uniform ${te} ${re} u_${oe};
#endif
`:Y==="define-instanced"?fe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${oe}0;
in vec4 a_${oe}1;
in vec4 a_${oe}2;
in vec4 a_${oe}3;
#else
uniform ${te} ${re} u_${oe};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${te} ${ve} a_${oe};
#else
uniform ${te} ${re} u_${oe};
#endif
`:Y==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${te} ${re} ${oe} = a_${oe};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${te} ${re} ${oe} = a_${oe};
#else
    ${te} ${re} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${te} ${re} ${oe} = unpack_mix_${fe}(a_${oe}, u_${oe}_t);
#else
    ${te} ${re} ${oe} = u_${oe};
#endif
`}),staticAttributes:S,usedDefines:G,vertexIncludes:M,fragmentIncludes:D}}class Im{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,d,y,S,P,M,D,G){this.context=o;let K=this.boundPaintVertexBuffers.length!==S.length;for(let te=0;!K&&te<S.length;te++)this.boundPaintVertexBuffers[te]!==S[te]&&(K=!0);let Y=this.boundDynamicVertexBuffers.length!==D.length;for(let te=0;!Y&&te<D.length;te++)this.boundDynamicVertexBuffers[te]!==D[te]&&(Y=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||K||Y||this.boundIndexBuffer!==P||this.boundVertexOffset!==M)this.freshBind(d,y,S,P,M,D,G);else{o.bindVertexArrayOES.set(this.vao);for(const te of D)te&&(te.bind(),G&&te.instanceCount&&te.setVertexAttribDivisor(o.gl,d,G));P&&P.dynamicDraw&&P.bind()}}freshBind(o,d,y,S,P,M,D){const G=o.numAttributes,K=this.context,Y=K.gl;this.vao&&this.destroy(),this.vao=K.gl.createVertexArray(),K.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=S,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=M,d.enableAttributes(Y,o),d.bind(),d.setVertexAttribPointers(Y,o,P);for(const te of y)te.enableAttributes(Y,o),te.bind(),te.setVertexAttribPointers(Y,o,P);for(const te of M)te&&(te.enableAttributes(Y,o),te.bind(),te.setVertexAttribPointers(Y,o,P),D&&te.instanceCount&&te.setVertexAttribDivisor(Y,o,D));S&&S.bind(),K.currentNumAttributes=G}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function $u(g,o){const d=Math.pow(2,o.canonical.z),y=o.canonical.y;return[new i.aa(0,y/d).toLngLat().lat,new i.aa(0,(y+1)/d).toLngLat().lat]}function c0(g,o,d,y,S,P,M){const D=g.context,G=D.gl,K=d.hillshadeFBO;if(!K)return;g.prepareDrawTile();const Y=g.isTileAffectedByFog(o),te=g.getOrCreateProgram("hillshade",{overrideFog:Y});D.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,K.colorAttachment.get());const re=((be,xe,Ce,Ue)=>{const Be=Ce.paint.get("hillshade-shadow-color"),Xe=Ce.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",qe=Ce.paint.get("hillshade-highlight-color"),We=Ce.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",$e=Ce.paint.get("hillshade-accent-color"),Ke=Ce.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",it=Ce.paint.get("hillshade-emissive-strength");let _t=i.ai(Ce.paint.get("hillshade-illumination-direction"));if(Ce.paint.get("hillshade-illumination-anchor")==="viewport")_t-=be.transform.angle;else if(be.style&&be.style.enable3dLights()&&be.style.directionalLight){const Mt=be.style.directionalLight.properties.get("direction"),jt=i.cb(Mt.x,Mt.y,Mt.z);_t=i.ai(jt[1])}const mt=!be.options.moving;return{u_matrix:Ue||be.transform.calculateProjMatrix(xe.tileID.toUnwrapped(),mt),u_image:0,u_latrange:$u(0,xe.tileID),u_light:[Ce.paint.get("hillshade-exaggeration"),_t],u_shadow:Be.toRenderColor(Xe?null:Ce.lut),u_highlight:qe.toRenderColor(We?null:Ce.lut),u_emissive_strength:it,u_accent:$e.toRenderColor(Ke?null:Ce.lut)}})(g,d,y,g.terrain?o.projMatrix:null);g.uploadCommonUniforms(D,te,o.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:ve,tileBoundsSegments:fe}=g.getTileBoundsBuffers(d);te.draw(g,G.TRIANGLES,S,P,M,Kr.disabled,re,y.id,oe,ve,fe)}function u0(g,o,d){if(!o.needsDEMTextureUpload)return;const y=g.context,S=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(d.stride);const P=d.getPixels();o.demTexture?o.demTexture.update(P,{premultiply:!1}):o.demTexture=new i.T(y,P,S.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function wp(g,o,d){const y=g.context,S=y.gl;if(!o.dem)return;const P=o.dem;if(y.activeTexture.set(S.TEXTURE1),u0(g,o,P),!o.demTexture)return;o.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const M=P.dim;y.activeTexture.set(S.TEXTURE0);let D=o.hillshadeFBO;if(!D){const re=new i.T(y,{width:M,height:M,data:null},S.RGBA8);re.bind(S.LINEAR,S.CLAMP_TO_EDGE),D=o.hillshadeFBO=y.createFramebuffer(M,M,!0,"renderbuffer"),D.colorAttachment.set(re.texture)}y.bindFramebuffer.set(D.framebuffer),y.viewport.set([0,0,M,M]);const{tileBoundsBuffer:G,tileBoundsIndexBuffer:K,tileBoundsSegments:Y}=g.getMercatorTileBoundsBuffers(),te=[];g.linearFloatFilteringSupported()&&te.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:te}).draw(g,S.TRIANGLES,zr.disabled,Wr.disabled,An.unblended,Kr.disabled,((re,oe)=>{const ve=oe.stride,fe=i.ab.mat4.create();return i.ab.mat4.ortho(fe,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(fe,fe,[0,-i.ag,0]),{u_matrix:fe,u_image:1,u_dimension:[ve,ve],u_zoom:re.overscaledZ}})(o.tileID,P),d.id,G,K,Y),o.needsHillshadePrepare=!1}class zi{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Dm extends zi{getDefault(){return i.aj.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Lm extends zi{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ca extends zi{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Sp extends zi{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ap extends zi{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class rf extends zi{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class d0 extends zi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Bd extends zi{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Xc extends zi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class Tp extends zi{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ps extends zi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class zm extends zi{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Fm extends zi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Bm extends zi{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Vm extends zi{getDefault(){return i.aj.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class nf extends zi{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class Vd extends zi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Pp extends zi{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Cp extends zi{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let af=class extends zi{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Um extends zi{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class h0 extends zi{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ud extends zi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class U_ extends zi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class $_ extends zi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Sy extends zi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class qu extends zi{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class f0 extends zi{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class sf extends zi{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Pl extends zi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class $d extends zi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Cl extends zi{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class Gu extends Cl{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Ay extends Cl{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class p0 extends Cl{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Wu extends Ay{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const qd=(g,o,d)=>({u_matrix:g,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:d}),cl=(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:d,u_zoom_transition:S,u_merc_center:P,u_image0:0,u_frustum_tl:M,u_frustum_tr:D,u_frustum_br:G,u_frustum_bl:K,u_globe_pos:Y,u_globe_radius:te,u_viewport:re,u_grid_matrix:fe?Float32Array.from(fe):new Float32Array(9),u_skirt_height:oe,u_far_z_cutoff:ve});function of(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const _o=new class{constructor(){this.operations={}}newMorphing(g,o,d,y,S){if(g in this.operations){const P=this.operations[g];P.to.tileID.key!==d.tileID.key&&(P.queued=d)}else this.operations[g]={startTime:y,phase:0,duration:S,from:o,to:d,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const d=this.operations[o];for(d.phase=(g-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},Jc={0:null,1:"TERRAIN_VERTEX_MORPHING"};function El(g,o,d){if(o===0)return 0;const y=o<1&&d===514?.25/o:1;return 6*Math.pow(1.5,22-g)*Math.max(o,1)*y}function ma(g,o){const d=1<<g.z;return!o&&(g.x===0||g.x===d-1)||g.y===0||g.y===d-1}const Ji=g=>({u_matrix:g});function kl(g,o,d,y,S){if(S>0){const P=i.q.now(),M=(P-g.timeAdded)/S,D=o?(P-o.timeAdded)/S:-1,G=d.getSource(),K=y.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),Y=!o||Math.abs(o.tileID.overscaledZ-K)>Math.abs(g.tileID.overscaledZ-K),te=Y&&g.refreshedUponExpiration?1:i.aw(Y?M:1-D,0,1);return g.refreshedUponExpiration&&M>=1&&(g.refreshedUponExpiration=!1),o?{opacity:1,mix:1-te}:{opacity:te,mix:0}}return{opacity:1,mix:0}}class Is extends Fo{constructor(o){const d={type:"raster-dem",maxzoom:o.transform.maxZoom},y=new i.D(i.ci(),null),S=ao("mock-dem",d,y,o.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,d){o.state="loaded",d(null)}}class Uo extends Fo{constructor(o){const d=ao("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new i.D(i.ci(),null),o.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,d,y){if(o.freezeTileCoverage)return;this.transform=o;const S=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,M)=>{if(P[M.key]="",!this._tiles[M.key]){const D=new dc(M,this._source.tileSize*M.overscaleFactor(),o.tileZoom);D.state="loaded",this._tiles[M.key]=D}return P},{});for(const P in this._tiles)P in S||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(o){const d=this.proxyCachedFBO[o];if(d!==void 0){const y=Object.values(d);this.renderCachePool.push(...y),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Qc extends i.aG{constructor(o,d,y){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=d,this.projMatrix=y}}class Kl extends i.cJ{constructor(o,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,S,P]=function(G){const K=new i.b4,Y=new i.aU,te=131;K.reserve(17161),Y.reserve(33800);const re=i.ag/128,oe=i.ag+re/2,ve=oe+re;for(let be=-re;be<ve;be+=re)for(let xe=-re;xe<ve;xe+=re){const Ce=xe<0||xe>oe||be<0||be>oe?24575:0,Ue=i.aw(Math.round(xe),0,i.ag),Be=i.aw(Math.round(be),0,i.ag);K.emplaceBack(Ue+Ce,Be)}const fe=(be,xe)=>{const Ce=xe*te+be;Y.emplaceBack(Ce+1,Ce,Ce+te),Y.emplaceBack(Ce+te,Ce+te+1,Ce+1)};for(let be=1;be<129;be++)for(let xe=1;xe<129;xe++)fe(xe,be);return[0,129].forEach(be=>{for(let xe=0;xe<130;xe++)fe(xe,be),fe(be,xe)}),[K,Y,32768]}(),M=o.context;this.gridBuffer=M.createVertexBuffer(y,i.b6.members),this.gridIndexBuffer=M.createIndexBuffer(S),this.gridSegments=i.b7.simpleSegment(0,0,y.length,S.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,y.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Uo(d.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const D=M.gl;this._overlapStencilMode=new Wr({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Is(d.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,d,y){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const S=o.terrain.properties,P=o.terrain.drapeRenderMode===0,M=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const D=o.terrain&&o.terrain.scope,G=S.get("source"),K=P?this._mockSourceCache:o.getSourceCache(G,D);if(!K)return void i.w(`Couldn't find terrain source "${G}".`);if(this.sourceCache=K,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=M?this.calculateExaggeration(d):S.get("exaggeration"),!d.projection.requiresDraping&&M&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Y=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const te=this.getScaledDemTileSize();this.sourceCache.update(d,te,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Y(),this._initializing=!0),Y(),d.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const d=this._previousCameraAltitude,y=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=y;const S=d!=null?y-d:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const P=o.zoom,M=this._style.terrain;if(!this._previousUpdateTimestamp)return M.getExaggeration(P);let D=P-this._previousZoom;const G=this._previousUpdateTimestamp;let K=P;this._evaluationZoom!=null&&(K=this._evaluationZoom,Math.abs(P-K)>.5&&(D=.5*(P-K+D)),D*S<0&&(K+=D)),this._evaluationZoom=K;const Y=M.getExaggeration(K),te=Y===M.getExaggeration(Math.max(0,K-.1));if(te&&Math.abs(Y-this._exaggeration)<.01)return Y;let re=Math.min(.1,.00375*(this._updateTimestamp-G));return(te||Y<.1||Math.abs(D)<1e-4)&&(re=Math.min(.2,4*re)),i.af(this._exaggeration,Y,re)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=d.getIds().map(G=>{const K=d.getTileByID(G).tileID;return K.projMatrix=y.calculateProjMatrix(K.toUnwrapped()),K});(function(G,K){const Y=K.transform.pointCoordinate(K.transform.getCameraPoint()),te=new i.P(Y.x,Y.y);G.sort((re,oe)=>{if(oe.overscaledZ-re.overscaledZ)return oe.overscaledZ-re.overscaledZ;const ve=new i.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),fe=new i.P(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),be=te.mult(1<<re.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ve)-be.distSqr(fe)})})(S,this.painter);const P=this.proxyToSource||{};this.proxyToSource={},S.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const M=this._style._mergedSourceCaches;for(const G in M){const K=M[G];if(!K.used||(K!==this.sourceCache&&this.resetTileLookupCache(K.id),this._setupProxiedCoordsForOrtho(K,o[G],P),K.usedForTerrain))continue;const Y=o[G];K.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[d.id]=S.map(G=>new Qc(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1;const D={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const K=this.terrainTileForTile[G.key];if(!K)continue;const Y=K.tileID.key;Y in D||(this._visibleDemTiles.push(K),D[Y]=Y)}}_assignTerrainTiles(o){this._initializing||o.forEach(d=>{if(this.terrainTileForTile[d.key])return;const y=this._findTileCoveringTileID(d,this.sourceCache);y&&(this.terrainTileForTile[d.key]=y)})}_prepareDEMTextures(){const o=this.painter.context,d=o.gl;for(const y in this.terrainTileForTile){const S=this.terrainTileForTile[y],P=S.dem;!P||S.demTexture&&!S.needsDEMTextureUpload||(o.activeTexture.set(d.TEXTURE1),u0(this.painter,S,P))}}_prepareDemTileUniforms(o,d,y,S){if(!d||d.demTexture==null)return!1;const P=o.tileID.canonical,M=Math.pow(2,d.tileID.canonical.z-P.z),D=S||"";return y[`u_dem_tl${D}`]=[P.x*M%1,P.y*M%1],y[`u_dem_scale${D}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const d=this._visibleDemTiles.reduce((y,S)=>{if(!S.dem)return y;const P=S.dem.tree.minimums[0];return P>0&&o++,y+P},0);return o?d/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,d=o.gl;o.activeTexture.set(d.TEXTURE2);const y=this._getLoadedAreaMinimum(),S=new i.cK({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(S,{premultiply:!1}):P=this._emptyDEMTexture=new i.T(o,S,d.R32F,{premultiply:!1}),P}setupElevationDraw(o,d,y){const S=this.painter.context,P=S.gl,M={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};M.u_exaggeration=this.exaggeration();let D=null,G=null,K=1;if(y&&y.morphing&&this._useVertexMorphing){const oe=y.morphing.srcDemTile,ve=y.morphing.dstDemTile;K=y.morphing.phase,oe&&ve&&(this._prepareDemTileUniforms(o,oe,M,"_prev")&&(G=oe),this._prepareDemTileUniforms(o,ve,M)&&(D=ve))}const Y=oe=>oe&&oe.demTexture&&this.painter.linearFloatFilteringSupported()?P.LINEAR:P.NEAREST;let te=null;var re;if(this.enabled?G&&D?(te=D.demTexture,S.activeTexture.set(P.TEXTURE4),G.demTexture.bind(Y(G),P.CLAMP_TO_EDGE),M.u_dem_lerp=K):(D=this.terrainTileForTile[o.tileID.key],te=this._prepareDemTileUniforms(o,D,M)?D.demTexture:this.emptyDEMTexture):te=this.emptyDEMTexture,S.activeTexture.set(P.TEXTURE2),te&&(M.u_dem_size=(re=te).size[0]===1?1:re.size[0]-2,te.bind(Y(D),P.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,d,M),y&&y.useMeterToDem&&D){const oe=(1<<D.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=oe}if(y&&y.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),d.setTerrainUniformValues(S,M),this.painter.transform.projection.name==="globe"){const oe=this.globeUniformValues(this.painter.transform,o.tileID.canonical,y&&y.useDenormalizedUpVectorScale);d.setGlobeUniformValues(S,oe)}}globeUniformValues(o,d,y){const S=o.projection;return{u_tile_tl_up:S.upVector(d,0,0),u_tile_tr_up:S.upVector(d,i.ag,0),u_tile_br_up:S.upVector(d,i.ag,i.ag),u_tile_bl_up:S.upVector(d,0,i.ag),u_tile_up_scale:y?i.cL(1):S.upVectorScale(d,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const d=this.painter,y=this.painter.context;o.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,P,M,D,G){if(S.transform.projection.name==="globe")(function(K,Y,te,re,oe){const ve=K.context,fe=ve.gl;let be,xe;const Ce=K.transform,Ue=i.cC(K,ve,Ce),Be=(Mt,jt)=>{if(xe===jt)return;const dt=[Jc[jt],"PROJECTION_GLOBE_VIEW"];Ue&&dt.push("CUSTOM_ANTIALIASING");const Et=K.isTileAffectedByFog(Mt);be=K.getOrCreateProgram("globeRaster",{defines:dt,overrideFog:Et}),xe=jt},Xe=K.colorModeForRenderPass(),qe=new zr(fe.LEQUAL,zr.ReadWrite,K.depthRangeFor3D);_o.update(oe);const We=i.cD(Ce),$e=[i.at(Ce.center.lng),i.aA(Ce.center.lat)],Ke=K.globeSharedBuffers,it=[Ce.width*i.q.devicePixelRatio,Ce.height*i.q.devicePixelRatio],_t=Float32Array.from(Ce.globeMatrix),mt={useDenormalizedUpVectorScale:!0};{const Mt=K.transform,jt=El(Mt.zoom,Y.exaggeration(),Y.sourceCache._source.tileSize);xe=-1;const dt=fe.TRIANGLES;for(const Et of re){const Ut=te.getTile(Et),pt=Wr.disabled,Dt=Y.prevTerrainTileForTile[Et.key],kt=Y.terrainTileForTile[Et.key];of(Dt,kt)&&_o.newMorphing(Et.key,Dt,kt,oe,250),ve.activeTexture.set(fe.TEXTURE0),Ut.texture&&Ut.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const Yt=_o.getMorphValuesForProxy(Et.key),Bt=Yt?1:0;Yt&&i.J(mt,{morphing:{srcDemTile:Yt.from,dstDemTile:Yt.to,phase:i.cB(Yt.phase)}});const It=i.cE(Et.canonical),Ht=i.cF(It.getCenter().lat),tr=i.cG(Et.canonical,It,Ht,Mt.worldSize/Mt._pixelsPerMercatorPixel),gr=i.bb(i.cH(Et.canonical)),_r=cl(Mt.expandedFarZProjMatrix,_t,We,gr,i.ae(Mt.zoom),$e,Mt.frustumCorners.TL,Mt.frustumCorners.TR,Mt.frustumCorners.BR,Mt.frustumCorners.BL,Mt.globeCenterInViewSpace,Mt.globeRadius,it,jt,Mt._farZ,tr);if(Be(Et,Bt),be&&(Y.setupElevationDraw(Ut,be,mt),K.uploadCommonUniforms(ve,be,Et.toUnwrapped()),Ke)){const[qr,jr,Ir]=Ke.getGridBuffers(Ht,jt!==0);be.draw(K,dt,qe,pt,Xe,Kr.backCCW,_r,"globe_raster",qr,jr,Ir)}}}if(Ke&&(K.renderDefaultNorthPole||K.renderDefaultSouthPole)){const Mt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ue&&Mt.push("CUSTOM_ANTIALIASING"),be=K.getOrCreateProgram("globeRaster",{defines:Mt});for(const jt of re){const{x:dt,y:Et,z:Ut}=jt.canonical,pt=Et===0,Dt=Et===(1<<Ut)-1,[kt,Yt,Bt,It]=Ke.getPoleBuffers(Ut,!1);if(It&&(pt||Dt)){const Ht=te.getTile(jt);ve.activeTexture.set(fe.TEXTURE0),Ht.texture&&Ht.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);let tr=i.cI(Ut,dt,Ce);const gr=i.bb(i.cH(jt.canonical)),_r=(qr,jr)=>qr.draw(K,fe.TRIANGLES,qe,Wr.disabled,Xe,Kr.disabled,cl(Ce.expandedFarZProjMatrix,tr,tr,gr,0,$e,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,it,0,Ce._farZ),"globe_pole_raster",jr,Bt,It);Y.setupElevationDraw(Ht,be,mt),K.uploadCommonUniforms(ve,be,jt.toUnwrapped()),pt&&K.renderDefaultNorthPole&&_r(be,kt),Dt&&K.renderDefaultSouthPole&&(tr=i.ab.mat4.scale(i.ab.mat4.create(),tr,[1,-1,1]),_r(be,Yt))}}}})(S,P,M,D,G);else{const K=S.context,Y=K.gl;let te,re;const oe=S.shadowRenderer,ve=Tl(S,S.longestCutoffRange),fe=Xe=>{if(re===Xe)return;const qe=[];qe.push(Jc[Xe]),ve.shouldRenderCutoff&&qe.push("RENDER_CUTOFF"),oe&&(qe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&qe.push("NORMAL_OFFSET")),te=S.getOrCreateProgram("terrainRaster",{defines:qe}),re=Xe},be=S.colorModeForRenderPass(),xe=new zr(Y.LEQUAL,zr.ReadWrite,S.depthRangeFor3D);_o.update(G);const Ce=S.transform,Ue=El(Ce.zoom,P.exaggeration(),P.sourceCache._source.tileSize);let Be=[0,0,0];if(oe){const Xe=S.style.directionalLight,qe=S.style.ambientLight;Xe&&qe&&(Be=yp(S.style,Xe,qe))}{re=-1;const Xe=Y.TRIANGLES,[qe,We]=[P.gridIndexBuffer,P.gridSegments];for(const $e of D){const Ke=M.getTile($e),it=Wr.disabled,_t=P.prevTerrainTileForTile[$e.key],mt=P.terrainTileForTile[$e.key];of(_t,mt)&&_o.newMorphing($e.key,_t,mt,G,250),K.activeTexture.set(Y.TEXTURE0),Ke.texture&&Ke.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const Mt=_o.getMorphValuesForProxy($e.key),jt=Mt?1:0;let dt;Mt&&(dt={morphing:{srcDemTile:Mt.from,dstDemTile:Mt.to,phase:i.cB(Mt.phase)}});const Et=qd($e.projMatrix,ma($e.canonical,Ce.renderWorldCopies)?Ue/10:Ue,Be);if(fe(jt),!te)continue;P.setupElevationDraw(Ke,te,dt);const Ut=$e.toUnwrapped();oe&&oe.setupShadows(Ut,te),S.uploadCommonUniforms(K,te,Ut,null,ve),te.draw(S,Xe,xe,it,be,Kr.backCCW,Et,"terrain_raster",P.gridBuffer,qe,We)}}}}(d,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const d=this.painter,y=this.painter.context,S=this.proxySourceCache,P=this.proxiedCoords[S.id],M=this._drapedRenderBatches.shift(),D=d.style.order,G=[];let K=0;for(const Y of P){const te=S.getTileByID(Y.proxyTileKey),re=S.proxyCachedFBO[Y.key]?S.proxyCachedFBO[Y.key][o]:void 0,oe=re!==void 0?S.renderCache[re]:this.pool[K++],ve=re!==void 0;if(te.texture=oe.tex,ve&&!oe.dirty){G.push(te.tileID);continue}let fe;y.bindFramebuffer.set(oe.fb.framebuffer),this.renderedToTile=!1,oe.dirty&&(y.clear({color:i.aj.transparent,stencil:0}),oe.dirty=!1);for(let be=M.start;be<=M.end;++be){const xe=d.style._mergedLayers[D[be]];if(xe.isHidden(d.transform.zoom))continue;const Ce=d.style.getLayerSourceCache(xe),Ue=Ce?this.proxyToSource[Y.key][Ce.id]:[Y];if(!Ue)continue;const Be=Ue;y.viewport.set([0,0,oe.fb.width,oe.fb.height]),fe!==(Ce?Ce.id:null)&&(this._setupStencil(oe,Ue,xe,Ce),fe=Ce?Ce.id:null),d.renderLayer(d,Ce,xe,Be)}if(this._drapedRenderBatches.length===0)for(const be of this._pendingGroundEffectLayers){const xe=d.style._mergedLayers[D[be]];if(xe.isHidden(d.transform.zoom))continue;const Ce=d.style.getLayerSourceCache(xe),Ue=Ce?this.proxyToSource[Y.key][Ce.id]:[Y];if(!Ue)continue;const Be=Ue;y.viewport.set([0,0,oe.fb.width,oe.fb.height]),fe!==(Ce?Ce.id:null)&&(this._setupStencil(oe,Ue,xe,Ce),fe=Ce?Ce.id:null),d.renderLayer(d,Ce,xe,Be)}this.renderedToTile?(oe.dirty=!0,G.push(te.tileID)):ve||--K,K===5&&(K=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),M.end+1}postRender(){}isLayerOrderingCorrect(o){const d=o.order.length;let y=-1,S=d;for(let P=0;P<d;++P)this._style.isLayerDraped(o._mergedLayers[o.order[P]])?y=Math.max(y,P):S=Math.min(S,P);return S>y}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{o=Math.min(o,d.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,d,y){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const M=P.tileID,D=1<<M.overscaledZ,{x:G,y:K}=M.canonical,Y=G/D,te=(G+1)/D,re=K/D,oe=(K+1)/D;return{minx:Y,miny:re,maxx:te,maxy:oe,t:P.dem.tree.raycastRoot(Y,re,te,oe,o,d,y),tile:P}});S.sort((P,M)=>(P.t!==null?P.t:Number.MAX_VALUE)-(M.t!==null?M.t:Number.MAX_VALUE));for(const P of S){if(P.t==null)return null;const M=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,o,d,y);if(M!=null)return M}return null}_createFBO(){const o=this.painter.context,d=o.gl,y=this.drapeBufferSize;o.activeTexture.set(d.TEXTURE0);const S=new i.T(o,{width:y[0],height:y[1],data:null},d.RGBA8);S.bind(d.LINEAR,d.CLAMP_TO_EDGE);const P=o.createFramebuffer(y[0],y[1],!0,null);return P.colorAttachment.set(S.texture),P.depthAttachment=new Wu(o,P.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:P,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const d=this._style._mergedLayers[o],y=d.isHidden(this.painter.transform.zoom);return d.type==="hillshade"||d.type==="custom"?!y&&d.shouldRedrape():!y&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const y of this._style.getSources())if(y instanceof Ca){o=!0;break}if(!o)return;const d={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],P=this._style.getLayerSourceCache(S);if(P&&!d[P.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof i.a9){d[P.id]=!0;for(const M of this.proxyCoords){const D=this.proxyToSource[M.key][P.id];if(D)for(const G of D)this._clearRenderCacheForTile(P.id,G)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof ds){o=!0;break}if(!o)return;const d={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],P=this._style.getLayerSourceCache(S);if(!P||d[P.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const M=S.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const G=this.proxyToSource[D.key][P.id];if(G)for(const K of G){const Y=kl(P.getTile(K),P.findLoadedParent(K,0),P,this.painter.transform,M);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(P.id,K)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,d=o.length;if(d===0)return;const y=[];this._pendingGroundEffectLayers=[];let S,P=0,M=this._style._mergedLayers[o[P]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++P<d;)M=this._style._mergedLayers[o[P]];for(;P<d;++P){const D=this._style._mergedLayers[o[P]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?S===void 0&&(S=P):(D.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(P),S!==void 0&&(y.push({start:S,end:P-1}),S=void 0)))}if(S!==void 0&&y.push({start:S,end:P-1}),y.length!==0){const D=y[y.length-1];this._pendingGroundEffectLayers.every(G=>G>D.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(o){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const M=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let D=0;D<M.length;++D){const G=Object.values(M[D]);d.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,S=this._tilesDirty;for(let M=y.length-1;M>=0;M--){const D=y[M];if(d.getTileByID(D.key),d.proxyCachedFBO[D.key]!==void 0){const G=o[D.key],K=this.proxyToSource[D.key];let Y=0;for(const te in K){const re=K[te],oe=G[te];if(!oe||oe.length!==re.length||re.some((ve,fe)=>ve!==oe[fe]||S[te]&&S[te].hasOwnProperty(ve.key))){Y=-1;break}++Y}for(const te in d.proxyCachedFBO[D.key])d.renderCache[d.proxyCachedFBO[D.key][te]].dirty=Y<0||Y!==Object.values(G).length}}const P=[...this._drapedRenderBatches];P.sort((M,D)=>D.end-D.start-(M.end-M.start));for(const M of P)for(const D of y){if(d.proxyCachedFBO[D.key])continue;let G=d.renderCachePool.pop();G===void 0&&d.renderCache.length<50&&(G=d.renderCache.length,d.renderCache.push(this._createFBO())),G!==void 0&&(d.proxyCachedFBO[D.key]={},d.proxyCachedFBO[D.key][M.start]=G,d.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(o,d,y,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,M=P.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let D;if(y.isTileClipped())D=d.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):Wr.disabled}_renderTileClippingMasks(o,d){const y=this.painter,S=this.painter.context,P=S.gl;y._tileClippingMaskIDs={},S.setColorMode(An.disabled),S.setDepthMode(zr.disabled);const M=y.getOrCreateProgram("clippingMask");for(const D of o){const G=y._tileClippingMaskIDs[D.key]=--d;M.draw(y,P.TRIANGLES,zr.disabled,new Wr({func:P.ALWAYS,mask:0},G,255,P.KEEP,P.KEEP,P.REPLACE),An.disabled,Kr.disabled,Ji(D.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(o){const d=this.painter.transform;if(o.x<0||o.x>d.width||o.y<0||o.y>d.height)return null;const y=[o.x,o.y,1,1];i.ab.vec4.transformMat4(y,y,d.pixelMatrixInverse),i.ab.vec4.scale(y,y,1/y[3]),y[0]/=d.worldSize,y[1]/=d.worldSize;const S=d._camera.position,P=i.bH(1,d.center.lat),M=[S[0],S[1],S[2]/P,0],D=i.ab.vec3.subtract([],y.slice(0,3),M);i.ab.vec3.normalize(D,D);const G=this.raycast(M,D,this._exaggeration);return G!==null&&G?(i.ab.vec3.scaleAndAdd(M,M,D,G),M[3]=M[2],M[2]*=P,M):null}_setupProxiedCoordsForOrtho(o,d,y){if(o.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(o,d,y);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const S=this.proxiedCoords[o.id]=[],P=this.proxyCoords;for(let G=0;G<P.length;G++){const K=P[G],Y=this._findTileCoveringTileID(K,o);if(Y){const te=this._createProxiedId(K,Y,y[K.key]&&y[K.key][o.id]);S.push(te),this.proxyToSource[K.key][o.id]=[te]}}let M=!1;const D=new Set;for(let G=0;G<d.length;G++){const K=o.getTile(d[G]);if(!K||!K.hasData())continue;const Y=this._findTileCoveringTileID(K.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==K.tileID.canonical.z){const te=this.proxyToSource[Y.tileID.key][o.id],re=this._createProxiedId(Y.tileID,K,y[Y.tileID.key]&&y[Y.tileID.key][o.id]);te?te.splice(te.length-1,0,re):this.proxyToSource[Y.tileID.key][o.id]=[re];const oe=this.proxyToSource[Y.tileID.key][o.id];D.has(oe)||D.add(oe),S.push(re),M=!0}}if(this._sourceTilesOverlap[o.id]=M,M&&this._debugParams.sortTilesHiZFirst)for(const G of D)G.sort((K,Y)=>Y.overscaledZ-K.overscaledZ)}_setupProxiedCoordsForImageSource(o,d,y){if(!o.getSource().loaded())return;const S=this.proxiedCoords[o.id]=[],P=this.proxyCoords,M=o.getSource(),D=M.tileID;if(!D)return;const G=new i.P(D.x,D.y)._div(1<<D.z),K=M.coordinates.map(i.aa.fromLngLat).reduce((te,re)=>(te.min.x=Math.min(te.min.x,re.x-G.x),te.min.y=Math.min(te.min.y,re.y-G.y),te.max.x=Math.max(te.max.x,re.x-G.x),te.max.y=Math.max(te.max.y,re.y-G.y),te),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(te,re)=>{const oe=te.wrap+te.canonical.x/(1<<te.canonical.z),ve=te.canonical.y/(1<<te.canonical.z),fe=i.ag/(1<<te.canonical.z),be=re.wrap+re.canonical.x/(1<<re.canonical.z),xe=re.canonical.y/(1<<re.canonical.z);return oe+fe<be+K.min.x||oe>be+K.max.x||ve+fe<xe+K.min.y||ve>xe+K.max.y};for(let te=0;te<P.length;te++){const re=P[te];for(let oe=0;oe<d.length;oe++){const ve=o.getTile(d[oe]);if(!ve||!ve.hasData()||Y(re,ve.tileID))continue;const fe=this._createProxiedId(re,ve,y[re.key]&&y[re.key][o.id]),be=this.proxyToSource[re.key][o.id];be?be.push(fe):this.proxyToSource[re.key][o.id]=[fe],S.push(fe)}}}_createProxiedId(o,d,y){let S=this.orthoMatrix;if(y){const P=y.find(M=>M.key===d.tileID.key);if(P)return P}if(d.tileID.key!==o.key){const P=o.canonical.z-d.tileID.canonical.z;let M,D,G;S=i.ab.mat4.create();const K=d.tileID.wrap-o.wrap<<o.overscaledZ;P>0?(M=i.ag>>P,D=M*((d.tileID.canonical.x<<P)-o.canonical.x+K),G=M*((d.tileID.canonical.y<<P)-o.canonical.y)):(M=i.ag<<-P,D=i.ag*(d.tileID.canonical.x-(o.canonical.x+K<<-P)),G=i.ag*(d.tileID.canonical.y-(o.canonical.y<<-P))),i.ab.mat4.ortho(S,0,M,0,M,0,1),i.ab.mat4.translate(S,S,[D,G,0])}return new Qc(d.tileID,o.key,S)}_findTileCoveringTileID(o,d){let y=d.getTile(o);if(y&&y.hasData())return y;const S=this._findCoveringTileCache[d.id],P=S[o.key];if(y=P?d.getTileByID(P):null,y&&y.hasData()||P===null)return y;let M=y?y.tileID:o,D=M.overscaledZ;const G=d.getSource().minzoom,K=[];if(!P){const te=d.getSource().maxzoom;if(o.canonical.z>=te){const re=o.canonical.z-te;d.getSource().reparseOverscaled?(D=Math.max(o.canonical.z+2,d.transform.tileZoom),M=new i.aG(D,o.wrap,te,o.canonical.x>>re,o.canonical.y>>re)):re!==0&&(D=te,M=new i.aG(D,o.wrap,te,o.canonical.x>>re,o.canonical.y>>re))}M.key!==o.key&&(K.push(M.key),y=d.getTile(M))}const Y=te=>{K.forEach(re=>{S[re]=te}),K.length=0};for(D-=1;D>=G&&(!y||!y.hasData());D--){y&&Y(y.tileID.key);const te=M.calculateScaledKey(D);if(y=d.getTileByID(te),y&&y.hasData())break;const re=S[te];if(re===null)break;re===void 0?K.push(te):y=d.getTileByID(re)}return Y(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,d){let y=this._tilesDirty[o];y||(y=this._tilesDirty[o]={}),y[d.key]=!0}}function $o(g,o,d){const y=function(D,G,K){const Y=i.ab.vec3.dot(G,D),te=i.ab.vec3.dot(K,[.2126,.7152,.0722]),re=(ve,fe,be)=>(1-be)*ve+be*fe,oe=re(1-.3*Math.min(te,1),1,Math.min(Y+1,1));return re(.92,1,Math.asin(i.aw(G[2],-1,1))/Math.PI+.5)*oe}(g,[0,0,1],o),S=[0,0,0];i.ab.vec3.scale(S,d.slice(0,3),y);const P=[0,0,0];i.ab.vec3.scale(P,o.slice(0,3),g[2]);const M=[0,0,0];return i.ab.vec3.add(M,S,P),i.cf(M)}const $m=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Ty=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Py{static cacheKey(o,d,y,S){let P=`${d}${S?S.cacheKey:""}`;for(const M of y)o.usedDefines.includes(M)&&(P+=`/${M}`);return P}constructor(o,d,y,S,P,M){const D=o.gl;this.program=D.createProgram(),this.configuration=S,this.name=d,this.fixedDefines=[...M];const G=S?S.getBinderAttributes():[],K=(y.staticAttributes||[]).concat(G);let Y=S?S.defines():[];Y=Y.concat(M.map(be=>`#define ${be}`));const te=`#version 300 es
`;let re=te+Y.concat("precision mediump float;",tf,bp.fragmentSource).join(`
`);for(const be of y.fragmentIncludes)re+=`
${zd[be]}`;re+=`
${y.fragmentSource}`;let oe=te+Y.concat("precision highp float;",tf,bp.vertexSource).join(`
`);for(const be of y.vertexIncludes)oe+=`
${zd[be]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(oe+=`
uniform int u_instanceID;
`),oe+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(oe=oe.replaceAll("gl_InstanceID","u_instanceID"));const ve=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(ve,re),D.compileShader(ve),D.attachShader(this.program,ve);const fe=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(fe,oe),D.compileShader(fe),D.attachShader(this.program,fe),this.attributes={},this.numAttributes=K.length;for(let be=0;be<this.numAttributes;be++)if(K[be]){const xe=K[be].startsWith("a_")?K[be]:`a_${K[be]}`;D.bindAttribLocation(this.program,be,xe),this.attributes[xe]=be}D.linkProgram(this.program),D.deleteShader(fe),D.deleteShader(ve),this.fixedUniforms=P(o),this.binderUniforms=S?S.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(be=>({u_instanceID:new i.bN(be)}))(o)),(M.includes("TERRAIN")||d.indexOf("symbol")!==-1||d.indexOf("circle")!==-1)&&(this.terrainUniforms=(be=>({u_dem:new i.bN(be),u_dem_prev:new i.bN(be),u_dem_tl:new i.bK(be),u_dem_scale:new i.bM(be),u_dem_tl_prev:new i.bK(be),u_dem_scale_prev:new i.bM(be),u_dem_size:new i.bM(be),u_dem_lerp:new i.bM(be),u_exaggeration:new i.bM(be),u_depth:new i.bN(be),u_depth_size_inv:new i.bK(be),u_depth_range_unpack:new i.bK(be),u_occluder_half_size:new i.bM(be),u_occlusion_depth_offset:new i.bM(be),u_meter_to_dem:new i.bM(be),u_label_plane_matrix_inv:new i.bJ(be)}))(o)),M.includes("GLOBE")&&(this.globeUniforms=(be=>({u_tile_tl_up:new i.bL(be),u_tile_tr_up:new i.bL(be),u_tile_br_up:new i.bL(be),u_tile_bl_up:new i.bL(be),u_tile_up_scale:new i.bM(be)}))(o)),M.includes("FOG")&&(this.fogUniforms=(be=>({u_fog_matrix:new i.bJ(be),u_fog_range:new i.bK(be),u_fog_color:new i.ca(be),u_fog_horizon_blend:new i.bM(be),u_fog_vertical_limit:new i.bK(be),u_fog_temporal_offset:new i.bM(be),u_frustum_tl:new i.bL(be),u_frustum_tr:new i.bL(be),u_frustum_br:new i.bL(be),u_frustum_bl:new i.bL(be),u_globe_pos:new i.bL(be),u_globe_radius:new i.bM(be),u_globe_transition:new i.bM(be),u_is_globe:new i.bN(be),u_viewport:new i.bK(be)}))(o)),M.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(be=>({u_cutoff_params:new i.ca(be)}))(o)),M.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(be=>({u_lighting_ambient_color:new i.bL(be),u_lighting_directional_dir:new i.bL(be),u_lighting_directional_color:new i.bL(be),u_ground_radiance:new i.bL(be)}))(o)),M.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(be=>({u_light_matrix_0:new i.bJ(be),u_light_matrix_1:new i.bJ(be),u_fade_range:new i.bK(be),u_shadow_normal_offset:new i.bL(be),u_shadow_intensity:new i.bM(be),u_shadow_texel_size:new i.bM(be),u_shadow_map_resolution:new i.bM(be),u_shadow_direction:new i.bL(be),u_shadow_bias:new i.bL(be),u_shadowmap_0:new i.bN(be),u_shadowmap_1:new i.bN(be)}))(o))}}setTerrainUniformValues(o,d){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S]&&y[S].set(this.program,S,d[S])}}setGlobeUniformValues(o,d){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S]&&y[S].set(this.program,S,d[S])}}setFogUniformValues(o,d){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}}setCutoffUniformValues(o,d){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}}setLightsUniformValues(o,d){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}}setShadowUniformValues(o,d){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}_drawDebugWireframe(o,d,y,S,P,M,D,G,K,Y){const te=o.options.wireframe;if(te.terrain===!1&&te.layers2D===!1&&te.layers3D===!1)return;const re=o.context;if(!(!(!te.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!te.layers2D||o._terrain&&o._terrain.renderingToTexture||!$m.includes(this.name))||!(!te.layers3D||!Ty.includes(this.name))))return;const oe=re.gl,ve=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,P,re);if(!ve)return;const fe=[...this.fixedDefines];fe.push("DEBUG_WIREFRAME");const be=o.getOrCreateProgram(this.name,{config:this.configuration,defines:fe});re.program.set(be.program);const xe=(Be,Xe,qe)=>{if(Xe[Be]&&qe[Be])for(const We in Xe[Be])qe[Be][We]&&qe[Be][We].set(qe.program,We,Xe[Be][We].current)};K&&K.setUniforms(be.program,re,be.binderUniforms,D,{zoom:G}),xe("fixedUniforms",this,be),xe("terrainUniforms",this,be),xe("globeUniforms",this,be),xe("fogUniforms",this,be),xe("lightsUniforms",this,be),xe("shadowUniforms",this,be),ve.bind(),re.setColorMode(new An([oe.ONE,oe.ONE_MINUS_SRC_ALPHA,oe.ZERO,oe.ONE],i.aj.transparent,[!0,!0,!0,!1])),re.setDepthMode(new zr(d.func===oe.LESS?oe.LEQUAL:d.func,zr.ReadOnly,d.range)),re.setStencilMode(Wr.disabled);const Ce=3*M.primitiveLength*2,Ue=3*M.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Be=Y||1;for(let Xe=0;Xe<Be;++Xe)be.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Xe),oe.drawElements(oe.LINES,Ce,oe.UNSIGNED_SHORT,Ue)}else Y&&Y>1?oe.drawElementsInstanced(oe.LINES,Ce,oe.UNSIGNED_SHORT,Ue,Y):oe.drawElements(oe.LINES,Ce,oe.UNSIGNED_SHORT,Ue);P.bind(),re.program.set(this.program),re.setDepthMode(d),re.setStencilMode(y),re.setColorMode(S)}checkUniforms(o,d,y){if(this.fixedDefines.includes(d)){for(const S of Object.keys(y))if(!y[S].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${S} not set but required by ${d} being defined`)}}draw(o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be){const xe=o.context,Ce=xe.gl;if(this.failedToCreate)return;xe.program.set(this.program),xe.setDepthMode(y),xe.setStencilMode(S),xe.setColorMode(P),xe.setCullFace(M);for(const Xe of Object.keys(this.fixedUniforms))this.fixedUniforms[Xe].set(this.program,Xe,D[Xe]);ve&&ve.setUniforms(this.program,xe,this.binderUniforms,re,{zoom:oe});const Ue={[Ce.POINTS]:1,[Ce.LINES]:2,[Ce.TRIANGLES]:3,[Ce.LINE_STRIP]:1}[d];this.checkUniforms(G,"RENDER_SHADOWS",this.shadowUniforms);const Be=be&&be>0?1:void 0;for(const Xe of te.get()){const qe=Xe.vaos||(Xe.vaos={});if((qe[G]||(qe[G]=new Im)).bind(xe,this,K,ve?ve.getPaintVertexBuffers():[],Y,Xe.vertexOffset,fe||[],Be),this.forceManualRenderingForInstanceIDShaders){const We=be||1;for(let $e=0;$e<We;++$e)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",$e),Y?Ce.drawElements(d,Xe.primitiveLength*Ue,Ce.UNSIGNED_SHORT,Xe.primitiveOffset*Ue*2):Ce.drawArrays(d,Xe.vertexOffset,Xe.vertexLength)}else be&&be>1?Ce.drawElementsInstanced(d,Xe.primitiveLength*Ue,Ce.UNSIGNED_SHORT,Xe.primitiveOffset*Ue*2,be):Y?Ce.drawElements(d,Xe.primitiveLength*Ue,Ce.UNSIGNED_SHORT,Xe.primitiveOffset*Ue*2):Ce.drawArrays(d,Xe.vertexOffset,Xe.vertexLength);d===Ce.TRIANGLES&&Y&&this._drawDebugWireframe(o,y,S,P,Y,Xe,re,oe,ve,be)}}}function Gd(g,o){const d=Math.pow(2,o.tileID.overscaledZ),y=o.tileSize*Math.pow(2,g.transform.tileZoom)/d,S=y*(o.tileID.canonical.x+o.tileID.wrap*d),P=y*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(o,1,g.transform.tileZoom),u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P]}}const Wd={terrain:0,flat:1},qo=i.ab.mat4.create(),Hd=(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe)=>{const Ce=o.style.light,Ue=Ce.properties.get("position"),Be=[Ue.x,Ue.y,Ue.z],Xe=i.ab.mat3.create();Ce.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Xe,-o.transform.angle),i.ab.vec3.transformMat3(Be,Be,Xe));const qe=Ce.properties.get("color"),We=o.transform,$e={u_matrix:g,u_lightpos:Be,u_lightintensity:Ce.properties.get("intensity"),u_lightcolor:[qe.r,qe.g,qe.b],u_vertical_gradient:+d,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:qo,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Wd[K],u_base_type:Wd[Y],u_ao:S,u_edge_radius:P,u_width_scale:M,u_flood_light_color:ve,u_vertical_scale:fe,u_flood_light_intensity:be,u_ground_shadow_factor:xe};return We.projection.name==="globe"&&($e.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],$e.u_zoom_transition=te,$e.u_inv_rot_matrix=oe,$e.u_merc_center=re,$e.u_up_dir=We.projection.upVector(new i.bT(0,0,0),re[0]*i.ag,re[1]*i.ag),$e.u_height_lift=G),$e},Kd=(g,o,d,y,S,P)=>({u_matrix:g,u_edge_radius:o,u_width_scale:d,u_vertical_scale:y,u_height_type:Wd[S],u_base_type:Wd[P]}),Cy=(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be)=>{const xe=Hd(g,o,d,y,S,P,M,D,K,Y,te,re,oe,ve,fe,be,1,[0,0,0]),Ce={u_height_factor:-Math.pow(2,D.overscaledZ)/G.tileSize/8};return i.l(xe,Gd(o,G),Ce)},Ep=(g,o)=>({u_matrix:g,u_emissive_strength:o}),Ml=(g,o,d,y)=>i.l(Ep(g,o),Gd(d,y)),Hu=(g,o,d)=>({u_matrix:g,u_world:d,u_emissive_strength:o}),Zd=(g,o,d,y,S)=>i.l(Ml(g,o,d,y),{u_world:S}),qm=(g,o,d,y)=>{const S=i.ag/d.tileSize;return{u_matrix:g,u_camera_to_center_distance:o.getCameraToCenterDistance(y),u_extrude_scale:[o.pixelsToGLUnits[0]/S,o.pixelsToGLUnits[1]/S]}},_c=(g,o,d=1)=>({u_matrix:g,u_color:o.toRenderColor(null),u_overlay:0,u_overlay_scale:d}),bo=i.ab.mat4.create(),mr=(g,o,d,y,S,P,M)=>{const D=g.transform,G=D.projection.name==="globe",K=G?i.cN(D.zoom,o.canonical)*D._pixelsPerMercatorPixel:i.ar(d,1,P),Y={u_matrix:o.projMatrix,u_extrude_scale:K,u_intensity:M,u_inv_rot_matrix:bo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){Y.u_inv_rot_matrix=y,Y.u_merc_center=S,Y.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],Y.u_zoom_transition=i.ae(D.zoom);const te=S[0]*i.ag,re=S[1]*i.ag;Y.u_up_dir=D.projection.upVector(new i.bT(0,0,0),te,re)}return Y};function eu(g,[o,d,y,S],[P,M]){if(P===M)return[0,0,0,0];const D=255*(g-1)/(g*(M-P));return[o*D,d*D,y*D,S*D]}function Zl(g,o,[d,y]){return d===y?0:.5/g+(o-d)*(g-1)/(g*(y-d))}const so=(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe,Ce,Ue,Be)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:P,u_scale_parent:K,u_fade_t:Y.mix,u_opacity:Y.opacity*te.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:te.paint.get("raster-brightness-min"),u_brightness_high:te.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(te.paint.get("raster-saturation")),u_contrast_factor:i.cP(te.paint.get("raster-contrast")),u_spin_weights:ul(te.paint.get("raster-hue-rotate")),u_perspective_transform:re,u_raster_elevation:oe,u_zoom_transition:M,u_merc_center:D,u_cutoff_params:G,u_colorization_mix:eu(i.cQ,fe,xe),u_colorization_offset:Zl(i.cQ,be,xe),u_color_ramp:ve,u_texture_offset:[Ue/(Ce+2*Ue),Ce/(Ce+2*Ue)],u_texture_res:[Ce+2*Ue,Ce+2*Ue],u_emissive_strength:Be});function ul(g){g*=Math.PI/180;const o=Math.sin(g),d=Math.cos(g);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const kr=.05,kp=(g,o,d,y,S,P,M,D,G,K,Y,te)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:P,u_scale_parent:K,u_fade_t:Y.mix,u_opacity:Y.opacity,u_image0:0,u_image1:1,u_raster_elevation:te,u_zoom_transition:M,u_merc_center:D,u_cutoff_params:G}),Ey=(g,o,d,y,S,P,M,D,G,K)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_tile_offset:d,u_velocity:y,u_color_ramp:P,u_velocity_res:S,u_max_speed:M,u_uv_offset:D,u_data_scale:[255*G[0],255*G[1]],u_data_offset:K,u_particle_pos_scale:1.1,u_particle_pos_offset:[kr,kr]}),dl=(g,o,d,y,S,P,M,D,G,K)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_velocity:d,u_velocity_res:y,u_max_speed:S,u_speed_factor:P,u_reset_rate:M,u_rand_seed:Math.random(),u_uv_offset:D,u_data_scale:[255*G[0],255*G[1]],u_data_offset:K,u_particle_pos_scale:1.1,u_particle_pos_offset:[kr,kr]}),oo=i.ab.mat4.create(),ga=(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe,Ce,Ue,Be,Xe)=>{const qe=S.transform,We={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:qe.getCameraToCenterDistance(Ce),u_rotate_symbol:+d,u_aspect_ratio:qe.width/qe.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:M,u_coord_matrix:D,u_is_text:+K,u_elevation_from_sea:G?1:0,u_pitch_with_map:+y,u_texsize:Y,u_texsize_icon:te,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:oo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:oo,u_up_vector:[0,-1,0],u_color_adj_mat:Ue,u_icon_transition:Be||0,u_gamma_scale:y?S.transform.getCameraToCenterDistance(Ce)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Xe||1};return Ce.name==="globe"&&(We.u_tile_id=[oe.canonical.x,oe.canonical.y,1<<oe.canonical.z],We.u_zoom_transition=ve,We.u_inv_rot_matrix=be,We.u_merc_center=fe,We.u_camera_forward=qe._camera.forward(),We.u_ecef_origin=i.cR(qe.globeMatrix,oe.toUnwrapped()),We.u_tile_matrix=Float32Array.from(qe.globeMatrix),We.u_up_vector=xe),We},hl=(g,o,d,y)=>({u_matrix:g,u_emissive_strength:o,u_opacity:d,u_color:y}),ky=(g,o,d,y,S,P,M,D,G)=>i.l(function(K,Y,te,re,oe,ve){const{width:fe,height:be}=re.imageManager.getPixelSize(Y),xe=Math.pow(2,ve.tileID.overscaledZ),Ce=ve.tileSize*Math.pow(2,re.transform.tileZoom)/xe,Ue=Ce*(ve.tileID.canonical.x+ve.tileID.wrap*xe),Be=Ce*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl:te.tl,u_pattern_br:te.br,u_texsize:[fe,be],u_pattern_size:te.displaySize,u_pattern_units_to_pixels:oe?[re.transform.width,-1*re.transform.height]:[1/i.ar(ve,1,re.transform.tileZoom),1/i.ar(ve,1,re.transform.tileZoom)],u_pixel_coord_upper:[Ue>>16,Be>>16],u_pixel_coord_lower:[65535&Ue,65535&Be]}}(0,P,M,y,D,G),{u_matrix:g,u_emissive_strength:o,u_opacity:d}),Gm=new Float32Array(i.ab.mat4.identity([])),Yd=(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe=[0,0,0],ve)=>{const fe=S.style.light,be=fe.properties.get("position"),xe=[-be.x,-be.y,be.z],Ce=i.ab.mat3.create();fe.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Ce,-S.transform.angle),i.ab.vec3.transformMat3(xe,xe,Ce));const Ue=Y.alphaMode==="MASK",Be=fe.properties.get("color").toRenderColor(null),Xe=re.paint.get("model-ambient-occlusion-intensity"),qe=re.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),We=re.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:g,u_lighting_matrix:o,u_normal_matrix:d,u_node_matrix:y||Gm,u_lightpos:xe,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[Be.r,Be.g,Be.b],u_camera_pos:oe,u_opacity:P,u_baseTextureIsAlpha:0,u_alphaMask:+Ue,u_alphaCutoff:Y.alphaCutoff,u_baseColorFactor:[M.r,M.g,M.b,M.a],u_emissiveFactor:[D[0],D[1],D[2],1],u_metallicFactor:G,u_roughnessFactor:K,u_baseColorTexture:Rs.BaseColor,u_metallicRoughnessTexture:Rs.MetallicRoughness,u_normalTexture:Rs.Normal,u_occlusionTexture:Rs.Occlusion,u_emissionTexture:Rs.Emission,u_lutTexture:Rs.LUT,u_color_mix:[qe.r,qe.g,qe.b,We],u_aoIntensity:Xe,u_emissive_strength:te,u_occlusionTextureTransform:ve||[0,0,0,0]}},lf=(g,o=Gm,d=Gm)=>({u_matrix:g,u_instance:o,u_node_matrix:d}),Wm={fillExtrusion:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_opacity:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_flood_light_color:new i.bL(g),u_vertical_scale:new i.bM(g),u_flood_light_intensity:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),fillExtrusionDepth:g=>({u_matrix:new i.bJ(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_vertical_scale:new i.bM(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g)}),fillExtrusionPattern:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_height_factor:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g),u_opacity:new i.bM(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new i.bJ(g),u_opacity:new i.bM(g),u_ao_pass:new i.bM(g),u_meter_to_tile:new i.bM(g),u_ao:new i.bK(g),u_flood_light_intensity:new i.bM(g),u_flood_light_color:new i.bL(g),u_attenuation:new i.bM(g),u_edge_radius:new i.bM(g),u_fb:new i.bN(g),u_fb_size:new i.bM(g),u_dynamic_offset:new i.bM(g)}),fill:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g)}),fillPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),fillOutline:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g)}),fillOutlinePattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),circle:i.cS,collisionBox:g=>({u_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_extrude_scale:new i.bK(g)}),collisionCircle:g=>({u_matrix:new i.bJ(g),u_inv_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_viewport_size:new i.bK(g)}),debug:g=>({u_color:new i.cz(g),u_matrix:new i.bJ(g),u_overlay:new i.bN(g),u_overlay_scale:new i.bM(g)}),clippingMask:g=>({u_matrix:new i.bJ(g)}),heatmap:g=>({u_extrude_scale:new i.bM(g),u_intensity:new i.bM(g),u_matrix:new i.bJ(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_up_dir:new i.bL(g)}),heatmapTexture:g=>({u_image:new i.bN(g),u_color_ramp:new i.bN(g),u_opacity:new i.bM(g)}),hillshade:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_latrange:new i.bK(g),u_light:new i.bK(g),u_shadow:new i.cz(g),u_highlight:new i.cz(g),u_emissive_strength:new i.bM(g),u_accent:new i.cz(g)}),hillshadePrepare:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_dimension:new i.bK(g),u_zoom:new i.bM(g)}),line:i.cT,linePattern:i.cU,raster:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_brightness_low:new i.bM(g),u_brightness_high:new i.bM(g),u_saturation_factor:new i.bM(g),u_contrast_factor:new i.bM(g),u_spin_weights:new i.bL(g),u_perspective_transform:new i.bK(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g),u_colorization_mix:new i.ca(g),u_colorization_offset:new i.bM(g),u_color_ramp:new i.bN(g),u_texture_offset:new i.bK(g),u_texture_res:new i.bK(g),u_emissive_strength:new i.bM(g)}),rasterParticle:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g)}),rasterParticleTexture:g=>({u_texture:new i.bN(g),u_opacity:new i.bM(g)}),rasterParticleDraw:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_tile_offset:new i.bK(g),u_velocity:new i.bN(g),u_color_ramp:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),rasterParticleUpdate:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_velocity:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_speed_factor:new i.bM(g),u_reset_rate:new i.bM(g),u_rand_seed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),symbol:g=>({u_is_size_zoom_constant:new i.bN(g),u_is_size_feature_constant:new i.bN(g),u_size_t:new i.bM(g),u_size:new i.bM(g),u_camera_to_center_distance:new i.bM(g),u_rotate_symbol:new i.bN(g),u_aspect_ratio:new i.bM(g),u_fade_change:new i.bM(g),u_matrix:new i.bJ(g),u_label_plane_matrix:new i.bJ(g),u_coord_matrix:new i.bJ(g),u_is_text:new i.bN(g),u_elevation_from_sea:new i.bN(g),u_pitch_with_map:new i.bN(g),u_texsize:new i.bK(g),u_texsize_icon:new i.bK(g),u_texture:new i.bN(g),u_texture_icon:new i.bN(g),u_gamma_scale:new i.bM(g),u_device_pixel_ratio:new i.bM(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_camera_forward:new i.bL(g),u_tile_matrix:new i.bJ(g),u_up_vector:new i.bL(g),u_ecef_origin:new i.bL(g),u_is_halo:new i.bN(g),u_icon_transition:new i.bM(g),u_color_adj_mat:new i.bJ(g),u_scale_factor:new i.bM(g)}),background:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_color:new i.cz(g)}),backgroundPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_image:new i.bN(g),u_pattern_tl:new i.bK(g),u_pattern_br:new i.bK(g),u_texsize:new i.bK(g),u_pattern_size:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_pattern_units_to_pixels:new i.bK(g)}),terrainRaster:g=>({u_matrix:new i.bJ(g),u_image0:new i.bN(g),u_skirt_height:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),skybox:g=>({u_matrix:new i.bJ(g),u_sun_direction:new i.bL(g),u_cubemap:new i.bN(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxGradient:g=>({u_matrix:new i.bJ(g),u_color_ramp:new i.bN(g),u_center_direction:new i.bL(g),u_radius:new i.bM(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxCapture:g=>({u_matrix_3f:new i.cA(g),u_sun_direction:new i.bL(g),u_sun_intensity:new i.bM(g),u_color_tint_r:new i.ca(g),u_color_tint_m:new i.ca(g),u_luminance:new i.bM(g)}),globeRaster:g=>({u_proj_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_image0:new i.bN(g),u_grid_matrix:new i.cA(g),u_skirt_height:new i.bM(g),u_far_z_cutoff:new i.bM(g),u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_globe_pos:new i.bL(g),u_globe_radius:new i.bM(g),u_viewport:new i.bK(g)}),globeAtmosphere:g=>({u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_horizon:new i.bM(g),u_transition:new i.bM(g),u_fadeout_range:new i.bM(g),u_color:new i.ca(g),u_high_color:new i.ca(g),u_space_color:new i.ca(g),u_temporal_offset:new i.bM(g),u_horizon_angle:new i.bM(g)}),model:g=>({u_matrix:new i.bJ(g),u_lighting_matrix:new i.bJ(g),u_normal_matrix:new i.bJ(g),u_node_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_camera_pos:new i.bL(g),u_opacity:new i.bM(g),u_baseColorFactor:new i.ca(g),u_emissiveFactor:new i.ca(g),u_metallicFactor:new i.bM(g),u_roughnessFactor:new i.bM(g),u_baseTextureIsAlpha:new i.bN(g),u_alphaMask:new i.bN(g),u_alphaCutoff:new i.bM(g),u_baseColorTexture:new i.bN(g),u_metallicRoughnessTexture:new i.bN(g),u_normalTexture:new i.bN(g),u_occlusionTexture:new i.bN(g),u_emissionTexture:new i.bN(g),u_lutTexture:new i.bN(g),u_color_mix:new i.ca(g),u_aoIntensity:new i.bM(g),u_emissive_strength:new i.bM(g),u_occlusionTextureTransform:new i.ca(g)}),modelDepth:g=>({u_matrix:new i.bJ(g),u_instance:new i.bJ(g),u_node_matrix:new i.bJ(g)}),groundShadow:g=>({u_matrix:new i.bJ(g),u_ground_shadow_factor:new i.bL(g)}),stars:g=>({u_matrix:new i.bJ(g),u_up:new i.bL(g),u_right:new i.bL(g),u_intensity_multiplier:new i.bM(g)}),snowParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_horizontalOscillationRadius:new i.bM(g),u_horizontalOscillationRate:new i.bM(g),u_boxSize:new i.bM(g),u_billboardSize:new i.bM(g),u_simpleShapeParameters:new i.bK(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_particleColor:new i.ca(g),u_direction:new i.bL(g)}),rainParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_texScreen:new i.bN(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_boxSize:new i.bM(g),u_rainDropletSize:new i.bK(g),u_distortionStrength:new i.bM(g),u_rainDirection:new i.bL(g),u_color:new i.ca(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_shapeDirectionalPower:new i.bM(g),u_shapeNormalPower:new i.bM(g),u_mode:new i.bM(g)}),vignette:g=>({u_vignetteShape:new i.bL(g),u_vignetteColor:new i.ca(g)}),occlusion:g=>({u_matrix:new i.bJ(g),u_anchorPos:new i.bL(g),u_screenSizePx:new i.bK(g),u_occluderSizePx:new i.bK(g),u_color:new i.ca(g)})};class fl{constructor(o,d,y,S){this.id=fl.uniqueIdxCounter,fl.uniqueIdxCounter++,this.context=o;const P=o.gl;this.buffer=P.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),P.bufferData(P.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||S||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=fl.uniqueIdxCounter,fl.uniqueIdxCounter++;const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}fl.uniqueIdxCounter=0;const wo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class pl{constructor(o,d,y,S,P,M){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=S,this.instanceCount=M,this.context=o;const D=o.gl;this.buffer=D.createBuffer(),o.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||P||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let y=0;y<this.attributes.length;y++){const S=d.attributes[this.attributes[y].name];S!==void 0&&o.enableVertexAttribArray(S)}}setVertexAttribPointers(o,d,y){for(let S=0;S<this.attributes.length;S++){const P=this.attributes[S],M=d.attributes[P.name];M!==void 0&&o.vertexAttribPointer(M,P.components,o[wo[P.type]],!1,this.itemSize,P.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(o,d,y){for(let S=0;S<this.attributes.length;S++){const P=d.attributes[this.attributes[S].name];P!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(P,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Mp{constructor(o,d,y,S,P){this.context=o,this.width=d,this.height=y;const M=this.framebuffer=o.gl.createFramebuffer();S&&(this.colorAttachment=new Gu(o,M)),P&&(this.depthAttachmentType=P,this.depthAttachment=P==="renderbuffer"?new Ay(o,M):new p0(o,M))}destroy(){const o=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&o.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&o.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&o.deleteTexture(d)}o.deleteFramebuffer(this.framebuffer)}}class My{constructor(o,d){this.gl=o,this.clearColor=new Dm(this),this.clearDepth=new Lm(this),this.clearStencil=new ca(this),this.colorMask=new Sp(this),this.depthMask=new Ap(this),this.stencilMask=new rf(this),this.stencilFunc=new d0(this),this.stencilOp=new Bd(this),this.stencilTest=new Xc(this),this.depthRange=new Tp(this),this.depthTest=new Ps(this),this.depthFunc=new zm(this),this.blend=new Fm(this),this.blendFunc=new Bm(this),this.blendColor=new Vm(this),this.blendEquation=new nf(this),this.cullFace=new Vd(this),this.cullFaceSide=new Pp(this),this.frontFace=new Cp(this),this.program=new af(this),this.activeTexture=new Um(this),this.viewport=new h0(this),this.bindFramebuffer=new Ud(this),this.bindRenderbuffer=new U_(this),this.bindTexture=new $_(this),this.bindVertexBuffer=new Sy(this),this.bindElementBuffer=new qu(this),this.bindVertexArrayOES=new f0(this),this.pixelStoreUnpack=new sf(this),this.pixelStoreUnpackPremultiplyAlpha=new Pl(this),this.pixelStoreUnpackFlipY=new $d(this),this.options=d?Object.assign({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=d&&!!d.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d,y){return new fl(this,o,d,y)}createVertexBuffer(o,d,y,S,P){return new pl(this,o,d,y,S,P)}createRenderbuffer(o,d,y){const S=this.gl,P=S.createRenderbuffer();return this.bindRenderbuffer.set(P),S.renderbufferStorage(S.RENDERBUFFER,o,d,y),this.bindRenderbuffer.set(null),P}createFramebuffer(o,d,y,S){return new Mp(this,o,d,y,S)}clear({color:o,depth:d,stencil:y,colorMask:S}){const P=this.gl;let M=0;o&&(M|=P.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set(S||[!0,!0,!0,!0])),d!==void 0&&(M|=P.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),y!==void 0&&(M|=P.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),P.clear(M)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){i.bn(o.blendFunction,An.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let bc;function Xd(g,o,d,y,S,P,M){const D=g.context,G=D.gl,K=g.transform,Y=g.getOrCreateProgram("collisionBox"),te=[];let re=0,oe=0;for(let Be=0;Be<y.length;Be++){const Xe=y[Be],qe=o.getTile(Xe),We=qe.getBucket(d);if(!We)continue;const $e=Wl(Xe,We,K);let Ke=$e;S[0]===0&&S[1]===0||(Ke=g.translatePosMatrix($e,qe,S,P));const it=M?We.textCollisionBox:We.iconCollisionBox,_t=We.collisionCircleArray;if(_t.length>0){const mt=i.ab.mat4.create(),Mt=Ke;i.ab.mat4.mul(mt,We.placementInvProjMatrix,K.glCoordMatrix),i.ab.mat4.mul(mt,mt,We.placementViewportMatrix),te.push({circleArray:_t,circleOffset:oe,transform:Mt,invTransform:mt,projection:We.getProjection()}),re+=_t.length/4,oe=re}it&&(g.terrain&&g.terrain.setupElevationDraw(qe,Y),Y.draw(g,G.LINES,zr.disabled,Wr.disabled,g.colorModeForRenderPass(),Kr.disabled,qm(Ke,K,qe,We.getProjection()),d.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,null,K.zoom,null,[it.collisionVertexBuffer,it.collisionVertexBufferExt]))}if(!M||!te.length)return;const ve=g.getOrCreateProgram("collisionCircle"),fe=new i.cV;fe.resize(4*re),fe._trim();let be=0;for(const Be of te)for(let Xe=0;Xe<Be.circleArray.length/4;Xe++){const qe=4*Xe,We=Be.circleArray[qe+0],$e=Be.circleArray[qe+1],Ke=Be.circleArray[qe+2],it=Be.circleArray[qe+3];fe.emplace(be++,We,$e,Ke,it,0),fe.emplace(be++,We,$e,Ke,it,1),fe.emplace(be++,We,$e,Ke,it,2),fe.emplace(be++,We,$e,Ke,it,3)}(!bc||bc.length<2*re)&&(bc=function(Be){const Xe=2*Be,qe=new i.aU;qe.resize(Xe),qe._trim();for(let We=0;We<Xe;We++){const $e=6*We;qe.uint16[$e+0]=4*We+0,qe.uint16[$e+1]=4*We+1,qe.uint16[$e+2]=4*We+2,qe.uint16[$e+3]=4*We+2,qe.uint16[$e+4]=4*We+3,qe.uint16[$e+5]=4*We+0}return qe}(re));const xe=D.createIndexBuffer(bc,!0),Ce=D.createVertexBuffer(fe,i.cW.members,!0);for(const Be of te){const Xe={u_matrix:Be.transform,u_inv_matrix:Be.invTransform,u_camera_to_center_distance:(Ue=K).getCameraToCenterDistance(Be.projection),u_viewport_size:[Ue.width,Ue.height]};ve.draw(g,G.TRIANGLES,zr.disabled,Wr.disabled,g.colorModeForRenderPass(),Kr.disabled,Xe,d.id,Ce,xe,i.b7.simpleSegment(0,2*Be.circleOffset,Be.circleArray.length,Be.circleArray.length/2),null,K.zoom)}var Ue;Ce.destroy(),xe.destroy()}const cf=i.ab.mat4.create();function Go(g){const o=g._camera.getWorldToCamera(g.worldSize,1),d=i.ab.mat4.multiply([],o,g.globeMatrix);i.ab.mat4.invert(d,d);const y=[0,0,0],S=[0,1,0,0];return i.ab.vec4.transformMat4(S,S,d),y[0]=S[0],y[1]=S[1],y[2]=S[2],i.ab.vec3.normalize(y,y),y}function xi({width:g,height:o,anchor:d,textOffset:y,textScale:S},P){const{horizontalAlign:M,verticalAlign:D}=i.bD(d),G=-(M-.5)*g,K=-(D-.5)*o,Y=i.bC(d,y);return new i.P((G/S+Y[0])*P,(K/S+Y[1])*P)}function jp(g,o,d,y,S,P,M,D,G,K,Y){const te=g.text.placedSymbolArray,re=g.text.dynamicLayoutVertexArray,oe=g.icon.dynamicLayoutVertexArray,ve={},fe=g.getProjection(),be=Wc(D,fe,P),xe=P.elevation,Ce=fe.upVectorScale(D.canonical,P.center.lat,P.worldSize).metersToTile;re.clear();for(let Ue=0;Ue<te.length;Ue++){const Be=te.get(Ue),{tileAnchorX:Xe,tileAnchorY:qe,numGlyphs:We}=Be,$e=Be.hidden||!Be.crossTileID||g.allowVerticalPlacement&&!Be.placedOrientation?null:y[Be.crossTileID];if($e){let Ke=0,it=0,_t=0;if(xe){const kt=xe?xe.getAtTileOffset(D,Xe,qe):0,[Yt,Bt,It]=fe.upVector(D.canonical,Xe,qe);Ke=kt*Yt*Ce,it=kt*Bt*Ce,_t=kt*It*Ce}let[mt,Mt,jt,dt]=qs(Be.projectedAnchorX+Ke,Be.projectedAnchorY+it,Be.projectedAnchorZ+_t,d?be:M);const Et=jd(P.getCameraToCenterDistance(fe),dt);let Ut=S.evaluateSizeForFeature(g.textSizeData,K,Be)*Et/i.bw;d&&(Ut*=g.tilePixelRatio/G);const pt=xi($e,Ut);d?({x:mt,y:Mt,z:jt}=fe.projectTilePoint(Xe+pt.x,qe+pt.y,D.canonical),[mt,Mt,jt]=qs(mt+Ke,Mt+it,jt+_t,M)):(o&&pt._rotate(-P.angle),mt+=pt.x,Mt+=pt.y,jt=0);const Dt=g.allowVerticalPlacement&&Be.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let kt=0;kt<We;kt++)i.bt(re,mt,Mt,jt,Dt);Y&&Be.associatedIconIndex>=0&&(ve[Be.associatedIconIndex]={x:mt,y:Mt,z:jt,angle:Dt})}else ta(We,re)}if(Y){oe.clear();const Ue=g.icon.placedSymbolArray;for(let Be=0;Be<Ue.length;Be++){const Xe=Ue.get(Be),{numGlyphs:qe}=Xe,We=ve[Be];if(Xe.hidden||!We)ta(qe,oe);else{const{x:$e,y:Ke,z:it,angle:_t}=We;for(let mt=0;mt<qe;mt++)i.bt(oe,$e,Ke,it,_t)}}g.icon.dynamicLayoutVertexBuffer.updateData(oe)}g.text.dynamicLayoutVertexBuffer.updateData(re)}function Ku(g,o,d,y,S,P,M={}){const D=d.paint.get("icon-translate"),G=d.paint.get("text-translate"),K=d.paint.get("icon-translate-anchor"),Y=d.paint.get("text-translate-anchor"),te=d.layout.get("icon-rotation-alignment"),re=d.layout.get("text-rotation-alignment"),oe=d.layout.get("icon-pitch-alignment"),ve=d.layout.get("text-pitch-alignment"),fe=d.layout.get("icon-keep-upright"),be=d.layout.get("text-keep-upright"),xe=d.paint.get("icon-color-saturation"),Ce=d.paint.get("icon-color-contrast"),Ue=d.paint.get("icon-color-brightness-min"),Be=d.paint.get("icon-color-brightness-max"),Xe=d.layout.get("symbol-elevation-reference")==="sea",qe=g.context,We=qe.gl,$e=g.transform,Ke=te==="map",it=re==="map",_t=oe==="map",mt=ve==="map",Mt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let jt=!1;const dt=g.depthModeForSublayer(0,zr.ReadOnly),Et=[i.at($e.center.lng),i.aA($e.center.lat)],Ut=d.layout.get("text-variable-anchor"),pt=$e.projection.name==="globe",Dt=[],kt=[0,-1,0];for(const Yt of y){const Bt=o.getTile(Yt),It=Bt.getBucket(d);if(!It||It.projection.name==="mercator"&&pt||It.fullyClipped)continue;const Ht=It.projection.name==="globe",tr=Ht?i.ae($e.zoom):0,gr=Wc(Yt,It.getProjection(),$e),_r=$e.calculatePixelsToTileUnitsMatrix(Bt),qr=Ut&&It.hasTextData(),jr=It.hasIconTextFit()&&qr&&It.hasIconData(),Ir=It.getProjection().createInversionMatrix($e,Yt.canonical),Hr=ei=>{$e.depthOcclusionForSymbolsAndCircles&&(d.hasInitialOcclusionOpacityProperties||g.terrain)&&(ei.push("DEPTH_D24"),ei.push("DEPTH_OCCLUSION"))},Mn=()=>{const ei=Ke&&d.layout.get("symbol-placement")!=="point",si=[];Hr(si);const Qi=ei||jr,na=d.paint.get("icon-image-cross-fade").constantOr(0);g.terrainRenderModeElevated()&&_t&&si.push("PITCH_WITH_MAP_TERRAIN"),Ht&&(si.push("PROJECTION_GLOBE_VIEW"),Qi&&si.push("PROJECTED_POS_ON_VIEWPORT")),na>0&&si.push("ICON_TRANSITION"),It.icon.zOffsetVertexBuffer&&si.push("Z_OFFSET"),xe===0&&Ce===0&&Ue===0&&Be===1||si.push("COLOR_ADJUSTMENT"),It.sdfIcons&&si.push("RENDER_SDF");const Ma=It.icon.programConfigurations.get(d.id),ba=g.getOrCreateProgram("symbol",{config:Ma,defines:si}),Es=Bt.imageAtlasTexture?Bt.imageAtlasTexture.size:[0,0],ks=It.iconSizeData,Oi=i.bp(ks,$e.zoom),Pi=_t||$e.pitch!==0,_i=qa(gr,Bt.tileID.canonical,_t,Ke,$e,It.getProjection(),_r),Nn=fy(gr,Bt.tileID.canonical,_t,Ke,$e,It.getProjection(),_r),ia=g.translatePosMatrix(Nn,Bt,D,K,!0),is=g.translatePosMatrix(gr,Bt,D,K),Ci=Qi?cf:_i,Ds=Ke&&!_t&&!ei;let gl=kt;!pt&&!$e.mercatorFromTransition||Ke||(gl=Go($e));const gs=Ht?gl:kt,Po=d.getColorAdjustmentMatrix(xe,Ce,Ue,Be),Co=ga(ks.kind,Oi,Ds,_t,g,is,Ci,ia,Xe,!1,Es,[0,0],!0,Yt,tr,Et,Ir,gs,It.getProjection(),Po,na),yl=Bt.imageAtlasTexture?Bt.imageAtlasTexture:null,Ni=d.layout.get("icon-size").constantOr(0)!==1||It.iconsNeedLinear,uh=It.sdfIcons||g.options.rotating||g.options.zooming||Ni||Pi?We.LINEAR:We.NEAREST,Ql=It.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,dh=g.terrain&&_t&&ei?i.ab.mat4.invert(i.ab.mat4.create(),_i):cf;if(ei&&It.icon){const Af=$e.elevation,Gp=Af?Af.getAtTileOffsetFunc(Yt,$e.center.lat,$e.worldSize,It.getProjection()):null,cg=fa(gr,Bt.tileID.canonical,_t,Ke,$e,It.getProjection(),_r);up(It,gr,g,!1,cg,Nn,_t,fe,Gp,Yt)}return{program:ba,buffers:It.icon,uniformValues:Co,atlasTexture:yl,atlasTextureIcon:null,atlasInterpolation:uh,atlasInterpolationIcon:null,isSDF:It.sdfIcons,hasHalo:Ql,tile:Bt,labelPlaneMatrixInv:dh}},di=()=>{const ei=it&&d.layout.get("symbol-placement")!=="point",si=[],Qi=ei||Ut||jr;g.terrainRenderModeElevated()&&mt&&si.push("PITCH_WITH_MAP_TERRAIN"),Ht&&(si.push("PROJECTION_GLOBE_VIEW"),Qi&&si.push("PROJECTED_POS_ON_VIEWPORT")),It.text.zOffsetVertexBuffer&&si.push("Z_OFFSET"),It.iconsInText&&si.push("RENDER_TEXT_AND_SYMBOL"),si.push("RENDER_SDF"),Hr(si);const na=It.text.programConfigurations.get(d.id),Ma=g.getOrCreateProgram("symbol",{config:na,defines:si});let ba,Es=[0,0],ks=null;const Oi=It.textSizeData;It.iconsInText&&(Es=Bt.imageAtlasTexture?Bt.imageAtlasTexture.size:[0,0],ks=Bt.imageAtlasTexture?Bt.imageAtlasTexture:null,ba=mt||$e.pitch!==0||g.options.rotating||g.options.zooming||Oi.kind==="composite"||Oi.kind==="camera"?We.LINEAR:We.NEAREST);const Pi=Bt.glyphAtlasTexture?Bt.glyphAtlasTexture.size:[0,0],_i=d.layout.get("text-size-scale-range"),Nn=i.aw(g.scaleFactor,_i[0],_i[1]),ia=i.bp(Oi,$e.zoom,Nn),is=qa(gr,Bt.tileID.canonical,mt,it,$e,It.getProjection(),_r),Ci=fy(gr,Bt.tileID.canonical,mt,it,$e,It.getProjection(),_r),Ds=g.translatePosMatrix(Ci,Bt,G,Y,!0),gl=g.translatePosMatrix(gr,Bt,G,Y),gs=Qi?cf:is,Po=it&&!mt&&!ei;let Co=kt;!pt&&!$e.mercatorFromTransition||it||(Co=Go($e));const yl=ga(Oi.kind,ia,Po,mt,g,gl,gs,Ds,Xe,!0,Pi,Es,!0,Yt,tr,Et,Ir,Ht?Co:kt,It.getProjection(),null,null,Nn),Ni=Bt.glyphAtlasTexture?Bt.glyphAtlasTexture:null,uh=We.LINEAR,Ql=d.paint.get("text-halo-width").constantOr(1)!==0,dh=g.terrain&&mt&&ei?i.ab.mat4.invert(i.ab.mat4.create(),is):cf;if(ei&&It.text){const Af=$e.elevation,Gp=Af?Af.getAtTileOffsetFunc(Yt,$e.center.lat,$e.worldSize,It.getProjection()):null,cg=fa(gr,Bt.tileID.canonical,mt,it,$e,It.getProjection(),_r);up(It,gr,g,!0,cg,Ci,mt,be,Gp,Yt)}return{program:Ma,buffers:It.text,uniformValues:yl,atlasTexture:Ni,atlasTextureIcon:ks,atlasInterpolation:uh,atlasInterpolationIcon:ba,isSDF:!0,hasHalo:Ql,tile:Bt,labelPlaneMatrixInv:dh}},Gi=It.icon.segments.get().length,Zn=It.text.segments.get().length,Zr=Gi&&!M.onlyText?Mn():null,wn=Zn&&!M.onlyIcons?di():null,Sr=d.paint.get("icon-opacity").constantOr(1),kn=d.paint.get("text-opacity").constantOr(1);if(Mt&&It.canOverlap){jt=!0;const ei=Sr&&!M.onlyText?It.icon.segments.get():[],si=kn&&!M.onlyIcons?It.text.segments.get():[];for(const Qi of ei)Dt.push({segments:new i.b7([Qi]),sortKey:Qi.sortKey,state:Zr});for(const Qi of si)Dt.push({segments:new i.b7([Qi]),sortKey:Qi.sortKey,state:wn})}else M.onlyText||Dt.push({segments:Sr?It.icon.segments:new i.b7([]),sortKey:0,state:Zr}),M.onlyIcons||Dt.push({segments:kn?It.text.segments:new i.b7([]),sortKey:0,state:wn})}jt&&Dt.sort((Yt,Bt)=>Yt.sortKey-Bt.sortKey);for(const Yt of Dt){const Bt=Yt.state;if(Bt)if(g.terrain?g.terrain.setupElevationDraw(Bt.tile,Bt.program,{useDepthForOcclusion:$e.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Bt.labelPlaneMatrixInv}):g.setupDepthForOcclusion($e.depthOcclusionForSymbolsAndCircles,Bt.program),qe.activeTexture.set(We.TEXTURE0),Bt.atlasTexture&&Bt.atlasTexture.bind(Bt.atlasInterpolation,We.CLAMP_TO_EDGE,!0),Bt.atlasTextureIcon&&(qe.activeTexture.set(We.TEXTURE1),Bt.atlasTextureIcon&&Bt.atlasTextureIcon.bind(Bt.atlasInterpolationIcon,We.CLAMP_TO_EDGE,!0)),g.uploadCommonLightUniforms(g.context,Bt.program),Bt.hasHalo){const It=Bt.uniformValues;It.u_is_halo=1,Jd(Bt.buffers,Yt.segments,d,g,Bt.program,dt,S,P,It,2),It.u_is_halo=0}else{if(Bt.isSDF){const It=Bt.uniformValues;Bt.hasHalo&&(It.u_is_halo=1,Jd(Bt.buffers,Yt.segments,d,g,Bt.program,dt,S,P,It,1)),It.u_is_halo=0}Jd(Bt.buffers,Yt.segments,d,g,Bt.program,dt,S,P,Bt.uniformValues,1)}}}function Jd(g,o,d,y,S,P,M,D,G,K){const Y=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer];S.draw(y,y.context.gl.TRIANGLES,P,M,D,Kr.disabled,G,d.id,g.layoutVertexBuffer,g.indexBuffer,o,d.paint,y.transform.zoom,g.programConfigurations.get(d.id),Y,K)}function Zu(g,o,d,y,S,P,M){const D=g.context.gl,G=d.paint.get("fill-pattern"),K=d.is3D(),Y=K?g.stencilModeFor3D():Wr.disabled,te=G&&G.constantOr(1);let re,oe,ve,fe,be;M?(oe=te&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",re=D.LINES):(oe=te?"fillPattern":"fill",re=D.TRIANGLES);for(const xe of y){const Ce=o.getTile(xe);if(te&&!Ce.patternsLoaded())continue;const Ue=Ce.getBucket(d);if(!Ue)continue;g.prepareDrawTile();const Be=Ue.programConfigurations.get(d.id),Xe=g.isTileAffectedByFog(xe),qe=g.getOrCreateProgram(oe,{config:Be,overrideFog:Xe});te&&(g.context.activeTexture.set(D.TEXTURE0),Ce.imageAtlasTexture&&Ce.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Be.updatePaintBuffers());const We=G.constantOr(null);if(We&&Ce.imageAtlas){const it=Ce.imageAtlas,_t=i.A.from(We).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),mt=it.patternPositions[_t];mt&&Be.setConstantPatternPositions(mt)}const $e=g.translatePosMatrix(xe.projMatrix,Ce,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),Ke=d.paint.get("fill-emissive-strength");if(M){fe=Ue.indexBuffer2,be=Ue.segments2;const it=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];ve=oe==="fillOutlinePattern"&&te?Zd($e,Ke,g,Ce,it):Hu($e,Ke,it)}else fe=Ue.indexBuffer,be=Ue.segments,ve=te?Ml($e,Ke,g,Ce):Ep($e,Ke);g.uploadCommonUniforms(g.context,qe,xe.toUnwrapped()),qe.draw(g,re,S,K?Y:g.stencilModeForClipping(xe),P,Kr.disabled,ve,d.id,Ue.layoutVertexBuffer,fe,be,d.paint,g.transform.zoom,Be,void 0)}}function Qd(g,o,d,y,S,P,M,D){d.resetLayerRenderingStats(g);const G=g.context,K=G.gl,Y=g.transform,te=d.paint.get("fill-extrusion-pattern"),re=te.constantOr(1),oe=d.paint.get("fill-extrusion-opacity"),ve=g.style.enable3dLights(),fe=d.paint.get(ve&&!re?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe],xe=d.layout.get("fill-extrusion-edge-radius"),Ce=xe>0&&!d.paint.get("fill-extrusion-rounded-roof"),Ue=Ce?0:xe,Be=Y.projection.name==="globe"?i.d3():0,Xe=Y.projection.name==="globe",qe=Xe?i.ae(Y.zoom):0,We=[i.at(Y.center.lng),i.aA(Y.center.lat)],$e=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ke=d.paint.get("fill-extrusion-flood-light-color").toRenderColor($e?null:d.lut).toArray01().slice(0,3),it=d.paint.get("fill-extrusion-flood-light-intensity"),_t=d.paint.get("fill-extrusion-vertical-scale"),mt=d.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Mt=d.paint.get("fill-extrusion-height-alignment"),jt=d.paint.get("fill-extrusion-base-alignment"),dt=Tl(g,d.paint.get("fill-extrusion-cutoff-fade-range")),Et=[];let Ut;Xe&&Et.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&Et.push("FAUX_AO"),Ce&&Et.push("ZERO_ROOF_RADIUS"),D&&Et.push("HAS_CENTROID"),it>0&&Et.push("FLOOD_LIGHT"),dt.shouldRenderCutoff&&Et.push("RENDER_CUTOFF"),mt&&Et.push("RENDER_WALL_MODE");const pt=g.renderPass==="shadow",Dt=g.shadowRenderer,kt=pt&&!!Dt;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Yt=[0,0,0];if(Dt){const Ht=g.style.directionalLight,tr=g.style.ambientLight;Ht&&tr&&(Yt=yp(g.style,Ht,tr)),pt||(Et.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Dt.useNormalOffset&&Et.push("NORMAL_OFFSET")),Ut=Et.concat(["SHADOWS_SINGLE_CASCADE"])}const Bt=kt?"fillExtrusionDepth":re?"fillExtrusionPattern":"fillExtrusion",It=d.getLayerRenderingStats();for(const Ht of y){const tr=o.getTile(Ht),gr=tr.getBucket(d);if(!gr||gr.projection.name!==Y.projection.name)continue;let _r=!1;Dt&&(_r=Dt.getMaxCascadeForTile(Ht.toUnwrapped())===0);const qr=g.isTileAffectedByFog(Ht),jr=gr.programConfigurations.get(d.id),Ir=g.getOrCreateProgram(Bt,{config:jr,defines:_r?Ut:Et,overrideFog:qr});if(g.terrain&&g.terrain.setupElevationDraw(tr,Ir,{useMeterToDem:!0}),!gr.centroidVertexBuffer){const wn=Ir.attributes.a_centroid_pos;wn!==void 0&&K.vertexAttrib2f(wn,0,0)}!pt&&Dt&&Dt.setupShadows(tr.tileID.toUnwrapped(),Ir,"vector-tile",tr.tileID.overscaledZ),re&&(g.context.activeTexture.set(K.TEXTURE0),tr.imageAtlasTexture&&tr.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),jr.updatePaintBuffers());const Hr=te.constantOr(null);if(Hr&&tr.imageAtlas){const wn=tr.imageAtlas,Sr=i.A.from(Hr).getPrimary().scaleSelf(i.q.devicePixelRatio),kn=wn.patternPositions[Sr.serialize()];kn&&jr.setConstantPatternPositions(kn)}const Mn=d.paint.get("fill-extrusion-vertical-gradient"),di=1/gr.tileToMeter;let Gi;if(pt&&Dt){if(jl(tr.tileID,gr,g))continue;const wn=Dt.calculateShadowPassMatrixFromTile(tr.tileID.toUnwrapped());Gi=Kd(wn,Ue,di,_t,Mt,jt)}else{const wn=g.translatePosMatrix(Ht.expandedProjMatrix,tr,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Sr=Y.projection.createInversionMatrix(Y,Ht.canonical);Gi=re?Cy(wn,g,Mn,oe,be,Ue,di,Ht,tr,Be,Mt,jt,qe,We,Sr,Ke,_t):Hd(wn,g,Mn,oe,be,Ue,di,Ht,Be,Mt,jt,qe,We,Sr,Ke,_t,it,Yt)}g.uploadCommonUniforms(G,Ir,Ht.toUnwrapped(),null,dt);let Zn=gr.segments;if(Y.projection.name==="mercator"&&!pt&&(Zn=gr.getVisibleSegments(tr.tileID,g.terrain,g.transform.getFrustum(0)),!Zn.get().length))continue;if(It)if(pt)for(const wn of Zn.get())It.numRenderedVerticesInShadowPass+=wn.primitiveLength;else for(const wn of Zn.get())It.numRenderedVerticesInTransparentPass+=wn.primitiveLength;const Zr=[];(g.terrain||D)&&Zr.push(gr.centroidVertexBuffer),Xe&&Zr.push(gr.layoutVertexExtBuffer),mt&&Zr.push(gr.wallVertexBuffer),Ir.draw(g,G.gl.TRIANGLES,S,P,M,Kr.backCCW,Gi,d.id,gr.layoutVertexBuffer,gr.indexBuffer,Zn,d.paint,g.transform.zoom,jr,Zr)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}function Yu(g,o,d,y,S,P,M,D,G,K,Y,te,re,oe,ve,fe,be,xe,Ce){const Ue=g.context,Be=Ue.gl,Xe=g.transform,qe=g.transform.zoom,We=[],$e=Tl(g,d.paint.get("fill-extrusion-cutoff-fade-range"));K==="clear"?(We.push("CLEAR_SUBPASS"),Ce&&(We.push("CLEAR_FROM_TEXTURE"),Ue.activeTexture.set(Be.TEXTURE0),Ce.bind(Be.LINEAR,Be.CLAMP_TO_EDGE))):K==="sdf"&&We.push("SDF_SUBPASS"),be&&We.push("HAS_CENTROID"),$e.shouldRenderCutoff&&We.push("RENDER_CUTOFF");const Ke=d.layout.get("fill-extrusion-edge-radius"),it=(_t,mt,Mt,jt,dt)=>{const Et=mt.programConfigurations.get(d.id),Ut=g.isTileAffectedByFog(_t),pt=g.getOrCreateProgram("fillExtrusionGroundEffect",{config:Et,defines:We,overrideFog:Ut}),Dt=((Yt,Bt,It,Ht,tr,gr,_r,qr,jr,Ir,Hr)=>({u_matrix:Bt,u_opacity:It,u_ao_pass:Ht?1:0,u_meter_to_tile:tr,u_ao:gr,u_flood_light_intensity:_r,u_flood_light_color:qr,u_attenuation:jr,u_edge_radius:Ir,u_fb:0,u_fb_size:Hr,u_dynamic_offset:1}))(0,jt,Y,G,dt,[te,re*dt],oe,ve,fe,qe>=17?0:Ke*dt,Ce?Ce.size[0]:0),kt=[];be&&kt.push(mt.hiddenByLandmarkVertexBuffer),g.uploadCommonUniforms(Ue,pt,_t.toUnwrapped(),null,$e),pt.draw(g,Ue.gl.TRIANGLES,S,P,M,D,Dt,d.id,mt.vertexBuffer,mt.indexBuffer,Mt,d.paint,qe,Et,kt)};for(const _t of y){const mt=o.getTile(_t),Mt=mt.getBucket(d);if(!Mt||Mt.projection.name!==Xe.projection.name||!Mt.groundEffect||Mt.groundEffect&&!Mt.groundEffect.hasData())continue;const jt=Mt.groundEffect,dt=1/Mt.tileToMeter;{const Et=g.translatePosMatrix(_t.projMatrix,mt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ut=jt.getDefaultSegment();it(_t,jt,Ut,Et,dt)}if(xe)for(let Et=0;Et<4;Et++){const Ut=i.d4[Et](_t),pt=o.getTile(Ut);if(!pt)continue;const Dt=pt.getBucket(d);if(!Dt||Dt.projection.name!==Xe.projection.name||!Dt.groundEffect||Dt.groundEffect&&!Dt.groundEffect.hasData())continue;const kt=Dt.groundEffect;let Yt,Bt;Et===0?(Yt=[-i.ag,0,0],Bt=1):Et===1?(Yt=[i.ag,0,0],Bt=0):Et===2?(Yt=[0,-i.ag,0],Bt=3):(Yt=[0,i.ag,0],Bt=2);const It=kt.regionSegments[Bt];if(!It)continue;const Ht=new Float32Array(16);i.ab.mat4.translate(Ht,_t.projMatrix,Yt),it(_t,kt,It,g.translatePosMatrix(Ht,mt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),dt)}}}function Xu(g,o,d,y,S,P,M){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const D=P?P.findDEMTileFor(d):null;if(!(D&&D.dem||M))return;P&&D&&D.dem&&y.selfDEMTileTimestamp!==D.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=D.dem._timestamp);const G=xe=>new i.P(Math.ceil((xe+i.d7)*i.d8),0),K=xe=>{const Ce=o.getSource().minzoom,Ue=Xe=>{const qe=o.getTileByID(Xe);if(qe&&qe.hasData())return qe.getBucket(S)},Be=[0,-1,1];for(const Xe of Be){if(xe.overscaledZ+Xe<Ce)continue;const qe=Ue(xe.calculateScaledKey(xe.overscaledZ+Xe));if(qe)return qe}},Y=[0,0,0],te=(xe,Ce)=>(Y[0]=Math.min(xe.min.y,Ce.min.y),Y[1]=Math.max(xe.max.y,Ce.max.y),Y[2]=i.ag-Ce.min.x>xe.max.x?Ce.min.x-i.ag:xe.max.x,Y),re=(xe,Ce)=>(Y[0]=Math.min(xe.min.x,Ce.min.x),Y[1]=Math.max(xe.max.x,Ce.max.x),Y[2]=i.ag-Ce.min.y>xe.max.y?Ce.min.y-i.ag:xe.max.y,Y),oe=[(xe,Ce)=>te(xe,Ce),(xe,Ce)=>te(Ce,xe),(xe,Ce)=>re(xe,Ce),(xe,Ce)=>re(Ce,xe)],ve=(xe,Ce,Ue,Be,Xe,qe,We)=>{if(!P)return 0;const $e=[[qe?Ue:xe,qe?xe:Ue,0],[qe?Ue:Ce,qe?Ce:Ue,0]],Ke=We<0?i.ag+We:We,it=[qe?Ke:(xe+Ce)/2,qe?(xe+Ce)/2:Ke,0];return Ue===0&&We<0||Ue!==0&&We>0?P.getForTilePoints(Xe,[it],!0,Be):$e.push(it),P.getForTilePoints(d,$e,!0,D),Math.max($e[0][2],$e[1][2],it[2])/P.exaggeration()};for(let xe=0;xe<4;xe++){const Ce=y.borderFeatureIndices[xe];if(Ce.length===0)continue;const Ue=i.d4[xe](d),Be=K(Ue);if(!(Be&&Be instanceof i.d5))continue;const Xe=P?P.findDEMTileFor(Ue):null;if(!(Xe&&Xe.dem||M)||(P&&Xe&&Xe.dem&&y.borderDEMTileTimestamp[xe]!==Xe.dem._timestamp&&(y.borderDoneWithNeighborZ[xe]=-1,y.borderDEMTileTimestamp[xe]=Xe.dem._timestamp),y.borderDoneWithNeighborZ[xe]===Be.canonical.z))continue;Be.centroidVertexArray.length===0&&Be.createCentroidsBuffer();const qe=(xe<2?1:5)-xe,We=Be.borderDoneWithNeighborZ[qe]!==y.canonical.z,$e=Be.borderFeatureIndices[qe];let Ke=0;if(y.canonical.z!==Be.canonical.z){for(const it of Ce)y.showCentroid(y.featuresOnBorder[it]);if(We)for(const it of $e)Be.showCentroid(Be.featuresOnBorder[it]);y.borderDoneWithNeighborZ[xe]=Be.canonical.z,Be.borderDoneWithNeighborZ[qe]=y.canonical.z}for(const it of Ce){const _t=y.featuresOnBorder[it],mt=y.centroidData[_t.centroidDataIndex],Mt=_t.borders[xe];let jt;for(;Ke<$e.length;){jt=Be.featuresOnBorder[$e[Ke]];const dt=jt.borders[qe];if(dt[1]>Mt[0]+3||dt[0]>Mt[0]-3)break;Be.showCentroid(jt),Ke++}if(jt&&Ke<$e.length){const dt=Ke;let Et=0;for(;!(jt.borders[qe][0]>Mt[1]-3)&&(Et++,++Ke!==$e.length);)jt=Be.featuresOnBorder[$e[Ke]];jt=Be.featuresOnBorder[$e[dt]];let Ut=!1;if(Et>=1){const kt=jt.borders[qe];Math.abs(Mt[0]-kt[0])<3&&Math.abs(Mt[1]-kt[1])<3&&(Et=1,Ut=!0,Ke=dt+1)}else if(Et===0){y.showCentroid(_t);continue}const pt=Be.centroidData[jt.centroidDataIndex];M&&Ut&&(((fe=mt).flags|(be=pt).flags)&i.d6?(fe.flags|=i.d6,be.flags|=i.d6):(fe.flags&=~i.d6,be.flags&=~i.d6));const Dt=_t.intersectsCount()>1||jt.intersectsCount()>1;if(Et>1)Ke=dt,mt.centroidXY=pt.centroidXY=new i.P(0,0);else if(Xe&&Xe.dem&&!Dt){const kt=oe[xe](mt,pt),Yt=xe%2?i.ag-1:0,Bt=ve(kt[0],Math.min(i.ag-1,kt[1]),Yt,Xe,Ue,xe<2,kt[2]);mt.centroidXY=pt.centroidXY=G(Bt)}else Dt?mt.centroidXY=pt.centroidXY=new i.P(0,0):(mt.centroidXY=y.encodeBorderCentroid(_t),pt.centroidXY=Be.encodeBorderCentroid(jt));y.writeCentroidToBuffer(mt),Be.writeCentroidToBuffer(pt)}else y.showCentroid(_t)}y.borderDoneWithNeighborZ[xe]=Be.canonical.z,Be.borderDoneWithNeighborZ[qe]=y.canonical.z}var fe,be;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const Ju=[1,0,0],Xt=[0,1,0],ur=[0,0,1];function jl(g,o,d){const y=d.transform,S=d.shadowRenderer;if(!S)return!0;const P=g.toUnwrapped(),M=y.tileSize*S._cascades[d.currentShadowCascade].scale;let D=o.maxHeight;if(y.elevation){const fe=y.elevation.getMinMaxForTile(g);fe&&(D+=fe.max)}const G=[...S.shadowDirection];G[2]=-G[2];const K=S.computeSimplifiedTileShadowVolume(P,D,M,G);if(!K)return!1;const Y=[Ju,Xt,ur,G,[G[0],0,G[2]],[0,G[1],G[2]]],te=y.projection.name==="globe",re=y.scaleZoom(M),oe=i.bR.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,re,!te),ve=S.getCurrentCascadeFrustum();return oe.intersectsPrecise(K.vertices,K.planes,Y)===0||ve.intersectsPrecise(K.vertices,K.planes,Y)===0}function $i(g){return[g[0]*i.d9,g[1]*i.d9,g[2]*i.d9,0]}function xt(g,o,d,y,S,P,M,D,G){const K=y.getSource(),Y=d.globeSharedBuffers;if(!Y)return;let te,re,oe;if(o&&(te=y.getTile(o)),K instanceof i.aJ?(re=K.texture,oe=i.cI(0,0,d.transform)):te&&o&&(re=te.texture,oe=i.cI(o.canonical.z,o.canonical.x,d.transform)),!re||!oe)return;g||(oe=i.ab.mat4.scale(i.ab.mat4.create(),oe,[1,-1,1]));const ve=d.context,fe=ve.gl,be=S.paint.get("raster-resampling")==="nearest"?fe.NEAREST:fe.LINEAR,xe=d.colorModeForDrapableLayerRenderPass(P),Ce=M.defines;Ce.push("GLOBE_POLES");const Ue=new zr(fe.LEQUAL,zr.ReadWrite,d.depthRangeFor3D),Be=Float32Array.from(d.transform.expandedFarZProjMatrix),Xe=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),ve.activeTexture.set(fe.TEXTURE0),re.bind(be,fe.CLAMP_TO_EDGE),ve.activeTexture.set(fe.TEXTURE1),re.bind(be,fe.CLAMP_TO_EDGE),re.useMipmap&&ve.extTextureFilterAnisotropic&&d.transform.pitch>20&&fe.texParameterf(fe.TEXTURE_2D,ve.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ve.extTextureFilterAnisotropicMax);const[qe,We,$e,Ke]=o?Y.getPoleBuffers(o.canonical.z,!1):Y.getPoleBuffers(0,!0),it=S.paint.get("raster-elevation");let _t;g?(_t=qe,d.renderDefaultNorthPole=it!==0):(_t=We,d.renderDefaultSouthPole=it!==0);const mt=$i(M.mix),Mt=((dt,Et,Ut,pt,Dt,kt,Yt,Bt,It,Ht,tr,gr,_r)=>so(dt,Et,Ut,new Float32Array(16),new Float32Array(9),[0,0],pt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},kt,[0,0],Bt,2,Ht,tr,gr,1,0,_r))(Be,Xe,oe,i.ae(d.transform.zoom),0,S,0,it,0,mt,M.offset,M.range,P),jt=d.getOrCreateProgram("raster",{defines:Ce});d.uploadCommonUniforms(ve,jt,null),jt.draw(d,fe.TRIANGLES,Ue,G,xe,D,Mt,S.id,_t,$e,Ke)}function wc(g){const o=g._nearZ,d=g.projection.farthestPixelDistance(g),y=d-o,S=.2*g.height,P=o+S;return[o,d,(P-S-o)/y,(P-o)/y]}function Yl(g,o,d,y){if(g)return o instanceof $a&&g instanceof Uc?o.getTextureDescriptor(g,d,!0):{texture:g.texture,mix:$i(y.mix),offset:y.offset,buffer:0,tileSize:1}}var Op=i.da([{name:"a_index",type:"Int16",components:1}]);class jy{constructor(o,d,y,S){const P={width:y[0],height:y[1],data:null},M=o.gl;this.targetColorTexture=new i.T(o,P,M.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(o,P,M.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(d,S),this.lastInvalidatedAt=0}updateParticleTexture(o,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,S=d.width*d.height;this.particleTexture0=new i.T(this.context,d,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,d,y.RGBA8,{premultiply:!1,useMipmap:!1});const P=new i.db;P.reserve(S);for(let M=0;M<S;M++)P.emplaceBack(M);this.particleIndexBuffer=this.context.createVertexBuffer(P,Op.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Sc(g,o,d){if(!g)return null;const y=o.getTextureDescriptor(g,d,!0);if(!y)return null;let{texture:S,mix:P,offset:M,tileSize:D,buffer:G,format:K}=y;if(!S||!K)return null;let Y=!1;return K==="uint32"&&(Y=!0,P[3]=0,P=eu(i.dc,P,[0,d.paint.get("raster-particle-max-speed")]),M=Zl(i.dc,M,[0,d.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[G/(D+2*G),D/(D+2*G)],tileSize:D,scalarData:Y,scale:P,offset:M,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[K]]}}function tu(g){const o=g._nearZ,d=g.projection.farthestPixelDistance(g),y=d-o,S=.2*g.height,P=o+S;return[o,d,(P-S-o)/y,(P-o)/y]}const ru=new i.aj(1,0,0,1),m0=new i.aj(0,1,0,1),Hm=new i.aj(0,0,1,1),Oy=new i.aj(1,0,1,1),Qu=new i.aj(0,1,1,1);function Ws(g,o,d,y,S,P,M){const D=g.context,G=g.transform,K=D.gl,Y=G.projection.name==="globe",te=Y?["PROJECTION_GLOBE_VIEW"]:[];let re=i.ab.mat4.clone(d.projMatrix);if(Y&&i.ae(G.zoom)>0){const mt=i.ba(d.canonical,G),Mt=i.dd(mt);re=i.ab.mat4.multiply(new Float32Array(16),G.globeMatrix,Mt),i.ab.mat4.multiply(re,G.projMatrix,re)}const oe=i.ab.mat4.create();oe[12]+=2*S/(i.q.devicePixelRatio*G.width),oe[13]+=2*P/(i.q.devicePixelRatio*G.height),i.ab.mat4.multiply(re,oe,re);const ve=g.getOrCreateProgram("debug",{defines:te}),fe=o.getTileByID(d.key);g.terrain&&g.terrain.setupElevationDraw(fe,ve);const be=zr.disabled,xe=Wr.disabled,Ce=g.colorModeForRenderPass(),Ue="$debug";D.activeTexture.set(K.TEXTURE0),g.emptyTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Y?fe._makeGlobeTileDebugBuffers(g.context,G):fe._makeDebugTileBoundsBuffers(g.context,G.projection);const Be=fe._tileDebugBuffer||g.debugBuffer,Xe=fe._tileDebugIndexBuffer||g.debugIndexBuffer,qe=fe._tileDebugSegments||g.debugSegments;if(ve.draw(g,K.LINE_STRIP,be,xe,Ce,Kr.disabled,_c(re,y),Ue,Be,Xe,qe,null,null,null,[fe._globeTileDebugBorderBuffer]),M){const mt=fe.latestRawTileData,Mt=Math.floor((mt&&mt.byteLength||0)/1024);let jt=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(jt+=` => ${d.overscaledZ}`),jt+=` ${fe.state}`,jt+=` ${Mt}kb`,function(dt,Et){dt.initDebugOverlayCanvas();const Ut=dt.debugOverlayCanvas,pt=dt.context.gl,Dt=dt.debugOverlayCanvas.getContext("2d");Dt.clearRect(0,0,Ut.width,Ut.height),Dt.shadowColor="white",Dt.shadowBlur=2,Dt.lineWidth=1.5,Dt.strokeStyle="white",Dt.textBaseline="top",Dt.font="bold 36px Open Sans, sans-serif",Dt.fillText(Et,5,5),Dt.strokeText(Et,5,5),dt.debugOverlayTexture.update(Ut),dt.debugOverlayTexture.bind(pt.LINEAR,pt.CLAMP_TO_EDGE)}(g,jt)}const We=o.getTile(d).tileSize,$e=512/Math.min(We,512)*(d.overscaledZ/G.zoom)*.5,Ke=fe._tileDebugTextBuffer||g.debugBuffer,it=fe._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,_t=fe._tileDebugTextSegments||g.debugSegments;ve.draw(g,K.TRIANGLES,be,xe,An.alphaBlended,Kr.disabled,_c(re,i.aj.transparent,$e),Ue,Ke,it,_t,null,null,null,[fe._globeTileDebugTextBuffer])}function eh(g,o,d,y){ml(g,0,o+d/2,g.transform.width,d,y)}function th(g,o,d,y){ml(g,o-d/2,0,d,g.transform.height,y)}function ml(g,o,d,y,S,P){const M=g.context,D=M.gl;D.enable(D.SCISSOR_TEST),D.scissor(o*i.q.devicePixelRatio,d*i.q.devicePixelRatio,y*i.q.devicePixelRatio,S*i.q.devicePixelRatio),M.clear({color:P}),D.disable(D.SCISSOR_TEST)}const uf=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:So}=uf;function Ac(g,o,d,y){g.emplaceBack(o,d,y)}class Km{constructor(o){this.vertexArray=new i.de,this.indices=new i.aU,Ac(this.vertexArray,-1,-1,1),Ac(this.vertexArray,1,-1,1),Ac(this.vertexArray,-1,1,1),Ac(this.vertexArray,1,1,1),Ac(this.vertexArray,-1,-1,-1),Ac(this.vertexArray,1,-1,-1),Ac(this.vertexArray,-1,1,-1),Ac(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,So),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function fi(g,o,d,y,S,P){const M=g.context.gl,D=o.paint.get("sky-atmosphere-color"),G=o.paint.get("sky-atmosphere-halo-color"),K=o.paint.get("sky-atmosphere-sun-intensity"),Y=((te,re,oe,ve,fe)=>({u_matrix_3f:te,u_sun_direction:re,u_sun_intensity:oe,u_color_tint_r:[ve.r,ve.g,ve.b,ve.a],u_color_tint_m:[fe.r,fe.g,fe.b,fe.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),y),S,K,D,G);M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+P,o.skyboxTexture,0),d.draw(g,M.TRIANGLES,zr.disabled,Wr.disabled,An.unblended,Kr.frontCW,Y,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const Zm=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class rh{constructor(o){const d=new i.df;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const y=new i.aU;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(d,Zm.members),this.indexBuffer=o.createIndexBuffer(y),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ji=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Qn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Ym{constructor(o){this.colorModeAlphaBlendedWriteRGB=new An([1,Rd,1,Rd],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new An([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new Qn,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const d=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new rh(d);const y=this.params.sizeRange,S=this.params.intensityRange,P=function(Y){const te=i.di(30),re=[];for(let oe=0;oe<Y;++oe){const ve=2*Math.PI*te(),fe=Math.acos(1-2*te())-.5*Math.PI;re.push(i.ab.vec3.fromValues(Math.cos(fe)*Math.cos(ve),Math.cos(fe)*Math.sin(ve),Math.sin(fe)))}return re}(this.params.starsCount),M=i.di(300),D=new i.dg,G=new i.aU;let K=0;for(let Y=0;Y<P.length;++Y){const te=i.ab.vec3.scale([],P[Y],200),re=Math.max(0,1+.01*y*(1*M()-.5)),oe=Math.max(0,1+.01*S*(1*M()-.5));D.emplaceBack(te[0],te[1],te[2],-1,-1,re,oe),D.emplaceBack(te[0],te[1],te[2],1,-1,re,oe),D.emplaceBack(te[0],te[1],te[2],1,1,re,oe),D.emplaceBack(te[0],te[1],te[2],-1,1,re,oe),G.emplaceBack(K+0,K+1,K+2),G.emplaceBack(K+0,K+2,K+3),K+=4}this.starsVx=d.createVertexBuffer(D,ji.members),this.starsIdx=d.createIndexBuffer(G),this.starsSegments=i.b7.simpleSegment(0,0,D.length,G.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,d){const y=o.context,S=y.gl,P=o.transform,M=new zr(S.LEQUAL,zr.ReadOnly,[0,1]),D=i.ae(P.zoom),G=o.style.getLut(d.scope),K=d.properties.get("color-use-theme")==="none",Y=d.properties.get("color").toRenderColor(K?null:G).toArray01(),te=d.properties.get("high-color-use-theme")==="none",re=d.properties.get("high-color").toRenderColor(te?null:G).toArray01(),oe=d.properties.get("space-color-use-theme")==="none",ve=d.properties.get("space-color").toRenderColor(oe?null:G).toArray01PremultipliedAlpha(),fe=5e-4,be=i.dh(d.properties.get("horizon-blend"),0,1,fe,.25),xe=i.cC(o,y,P)&&be===fe?P.worldSize/(2*Math.PI*1.025)-1:P.globeRadius,Ce=o.frameCounter/1e3%1,Ue=i.ab.vec3.length(P.globeCenterInViewSpace),Be=Math.sqrt(Math.pow(Ue,2)-Math.pow(xe,2)),Xe=Math.acos(Be/Ue),qe=We=>{const $e=P.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];We&&$e.push("ALPHA_PASS");const Ke=o.getOrCreateProgram("globeAtmosphere",{defines:$e}),it=((mt,Mt,jt,dt,Et,Ut,pt,Dt,kt,Yt,Bt,It)=>({u_frustum_tl:mt,u_frustum_tr:Mt,u_frustum_br:jt,u_frustum_bl:dt,u_horizon:Et,u_transition:Ut,u_fadeout_range:pt,u_color:Dt,u_high_color:kt,u_space_color:Yt,u_temporal_offset:Bt,u_horizon_angle:It}))(P.frustumCorners.TL,P.frustumCorners.TR,P.frustumCorners.BR,P.frustumCorners.BL,P.frustumCorners.horizon,D,be,Y,re,ve,Ce,Xe);o.uploadCommonUniforms(y,Ke);const _t=this.atmosphereBuffer;_t&&Ke.draw(o,S.TRIANGLES,M,Wr.disabled,We?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Kr.backCW,it,We?"atmosphere_glow_alpha":"atmosphere_glow",_t.vertexBuffer,_t.indexBuffer,_t.segments)};qe(!1),qe(!0)}drawStars(o,d){const y=i.aw(d.properties.get("star-intensity"),0,1);if(y===0)return;const S=o.context,P=S.gl,M=o.transform,D=o.getOrCreateProgram("stars"),G=i.ab.quat.identity([]);i.ab.quat.rotateX(G,G,-M._pitch),i.ab.quat.rotateZ(G,G,-M.angle),i.ab.quat.rotateX(G,G,i.ai(M._center.lat)),i.ab.quat.rotateY(G,G,-i.ai(M._center.lng));const K=i.ab.mat4.fromQuat(new Float32Array(16),G),Y=i.ab.mat4.multiply([],M.starsProjMatrix,K),te=i.ab.mat3.fromMat4([],K),re=i.ab.mat3.invert([],te),oe=[0,1,0];i.ab.vec3.transformMat3(oe,oe,re),i.ab.vec3.scale(oe,oe,this.params.sizeMultiplier);const ve=[1,0,0];i.ab.vec3.transformMat3(ve,ve,re),i.ab.vec3.scale(ve,ve,this.params.sizeMultiplier);const fe=(be=oe,xe=ve,Ce=y,{u_matrix:Float32Array.from(Y),u_up:be,u_right:xe,u_intensity_multiplier:Ce});var be,xe,Ce;o.uploadCommonUniforms(S,D),this.starsVx&&this.starsIdx&&D.draw(o,P.TRIANGLES,zr.disabled,Wr.disabled,this.colorModeAlphaBlendedWriteRGB,Kr.disabled,fe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Ao(g,o){const d=[...g],y=o.cameraWorldSizeForFog/o.worldSize,S=i.ab.mat4.identity([]);return i.ab.mat4.scale(S,S,[y,y,1]),i.ab.mat4.multiply(d,S,d),i.ab.mat4.multiply(d,o.worldToFogMatrix,d),d}function ra(g,o,d,y,S){const P=d.material,M=y.context,{baseColorTexture:D,metallicRoughnessTexture:G}=P.pbrMetallicRoughness,{normalTexture:K,occlusionTexture:Y,emissionTexture:te}=P;function re(ve,fe,be){if(ve&&(g.push(fe),M.activeTexture.set(M.gl.TEXTURE0+be),ve.gfxTexture)){const{minFilter:xe,magFilter:Ce,wrapS:Ue,wrapT:Be}=ve.sampler;ve.gfxTexture.bindExtraParam(xe,Ce,Ue,Be)}}re(D,"HAS_TEXTURE_u_baseColorTexture",Rs.BaseColor),re(G,"HAS_TEXTURE_u_metallicRoughnessTexture",Rs.MetallicRoughness),re(K,"HAS_TEXTURE_u_normalTexture",Rs.Normal),re(Y,"HAS_TEXTURE_u_occlusionTexture",Rs.Occlusion),re(te,"HAS_TEXTURE_u_emissionTexture",Rs.Emission),S&&(S.texture||(S.texture=new i.dk(y.context,S.image,[S.image.height,S.image.height,S.image.height],M.gl.RGBA8)),M.activeTexture.set(M.gl.TEXTURE0+Rs.LUT),S.texture&&S.texture.bind(M.gl.LINEAR,M.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(d.texcoordBuffer)),d.colorBuffer&&(g.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(d.colorBuffer)),d.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(d.normalBuffer)),d.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(d.pbrBuffer)),P.alphaMode!=="OPAQUE"&&P.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),P.defined||g.push("DIFFUSE_SHADED");const oe=y.shadowRenderer;oe&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&g.push("NORMAL_OFFSET"))}function ua(g,o,d,y,S,P){const M=d.paint.get("model-opacity").constantOr(1),D=o.context,G=new zr(o.context.gl.LEQUAL,zr.ReadWrite,o.depthRangeFor3D),K=o.transform,Y=g.mesh,te=Y.material,re=te.pbrMetallicRoughness,oe=o.style.fog;let ve;ve=o.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:i.ab.mat4.multiply([],y.zScaleMatrix,g.nodeModelMatrix),i.ab.mat4.multiply(ve,y.negCameraPosMatrix,ve);const fe=i.ab.mat4.invert([],ve);i.ab.mat4.transpose(fe,fe);const be=d.paint.get("model-color-use-theme").constantOr("default")==="none",xe=d.paint.get("model-emissive-strength").constantOr(0),Ce=Yd(new Float32Array(g.worldViewProjection),new Float32Array(ve),new Float32Array(fe),null,o,M,re.baseColorFactor.toRenderColor(null),te.emissiveFactor,re.metallicFactor,re.roughnessFactor,te,xe,d),Ue={defines:[]},Be=[],Xe=o.shadowRenderer;Xe&&(Xe.useNormalOffset=!1),ra(Ue.defines,Be,Y,o,be?null:d.lut);let qe=null;if(oe){const Ke=Ao(g.nodeModelMatrix,o.transform);if(qe=new Float32Array(Ke),K.projection.name!=="globe"){const it=Y.aabb.min,_t=Y.aabb.max,[mt,Mt]=oe.getOpacityForBounds(Ke,it[0],it[1],_t[0],_t[1]);Ue.overrideFog=mt>=Ye||Mt>=Ye}}const We=Tl(o,d.paint.get("model-cutoff-fade-range"));We.shouldRenderCutoff&&Ue.defines.push("RENDER_CUTOFF");const $e=o.getOrCreateProgram("model",Ue);o.uploadCommonUniforms(D,$e,null,qe,We),o.renderPass!=="shadow"&&Xe&&Xe.setupShadowsFromMatrix(g.nodeModelMatrix,$e),$e.draw(o,D.gl.TRIANGLES,G,S,P,Y.material.doubleSided?Kr.disabled:Kr.backCCW,Ce,d.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,d.paint,o.transform.zoom,void 0,Be)}function rs(g,o,d,y,S,P,M){let D;D=g.projection.name==="globe"?i.dl(d,g):[...d],i.ab.mat4.multiply(D,D,o.matrix);const G=i.ab.mat4.multiply([],y,D);if(o.meshes)for(const K of o.meshes){if(K.material.alphaMode!=="BLEND"){M.push({mesh:K,depth:0,modelIndex:S,worldViewProjection:G,nodeModelMatrix:D});continue}const Y=i.ab.vec3.transformMat4([],K.centroid,G);!g.isOrthographic&&Y[2]<=0||P.push({mesh:K,depth:Y[2],modelIndex:S,worldViewProjection:G,nodeModelMatrix:D})}if(o.children)for(const K of o.children)rs(g,K,d,y,S,P,M)}function ed(g,o,d,y){const S=d.shadowRenderer;if(!S)return;const P=S.getShadowPassDepthMode(),M=S.getShadowPassColorMode(),D=S.calculateShadowPassMatrixFromMatrix(o),G=lf(D);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,P,Wr.disabled,M,Kr.backCCW,G,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,d.transform.zoom,void 0,void 0)}function Wo(g,o,d){const y=o.updateZoomBasedPaintProperties(),S=function(P,M,D){let G,K,Y,te=P.terrain?P.terrain.exaggeration():0;if(P.terrain&&te>0){const re=P.terrain,oe=re.findDEMTileFor(D);oe&&oe.dem?G=i.dn.create(re,D,oe):te=0}if(te===0&&(M.terrainElevationMin=0,M.terrainElevationMax=0),te===M.validForExaggeration&&(te===0||G&&G._demTile&&G._demTile.tileID===M.validForDEMTile.id&&G._dem._timestamp===M.validForDEMTile.timestamp))return!1;for(const re in M.instancesPerModel){const oe=M.instancesPerModel[re];for(let ve=0;ve<oe.instancedDataArray.length;++ve){const fe=(G?te*G.getElevationAt(0|oe.instancedDataArray.float32[16*ve],0|oe.instancedDataArray.float32[16*ve+1],!0,!0):0)+oe.instancesEvaluatedElevation[ve];oe.instancedDataArray.float32[16*ve+6]=fe,K=K?Math.min(M.terrainElevationMin,fe):fe,Y=Y?Math.max(M.terrainElevationMax,fe):fe}}return M.terrainElevationMin=K||0,M.terrainElevationMax=Y||0,M.validForExaggeration=te,M.validForDEMTile=G&&G._demTile?{id:G._demTile.tileID,timestamp:G._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,o,d);(y||S)&&(o.uploaded=!1,o.upload(g.context))}const ns={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function Xm(g,o){const d=1<<g.canonical.z,y=o.getFreeCameraOptions().position,S=o.elevation,P=g.canonical.x/d,M=(g.canonical.x+1)/d,D=g.canonical.y/d,G=(g.canonical.y+1)/d;let K=o._centerAltitude;if(S){const oe=S.getMinMaxForTile(g);oe&&oe.max>K&&(K=oe.max)}const Y=i.aw(y.x,P,M)-y.x,te=i.aw(y.y,D,G)-y.y,re=i.bH(K,o.center.lat)-y.z;return o._zoomFromMercatorZ(Math.sqrt(Y*Y+te*te+re*re))}function ps(g,o,d,y,S,P,M){const D=g.context,G=g.renderPass==="shadow",K=g.shadowRenderer,Y=G&&K?K.getShadowPassDepthMode():new zr(D.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D),te=g.isTileAffectedByFog(P);if(d.meshes)for(const re of d.meshes){const oe=["MODEL_POSITION_ON_GPU"],ve=[];let fe,be,xe;y.instancedDataArray.length>20&&oe.push("INSTANCED_ARRAYS");const Ce=Tl(g,o.paint.get("model-cutoff-fade-range"));if(Ce.shouldRenderCutoff&&oe.push("RENDER_CUTOFF"),G&&K)fe=g.getOrCreateProgram("modelDepth",{defines:oe}),be=lf(M.shadowTileMatrix,M.shadowTileMatrix,Float32Array.from(d.matrix)),xe=K.getShadowPassColorMode();else{ra(oe,ve,re,g,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),fe=g.getOrCreateProgram("model",{defines:oe,overrideFog:te});const Be=re.material,Xe=Be.pbrMetallicRoughness,qe=o.paint.get("model-opacity").constantOr(1),We=o.paint.get("model-emissive-strength").constantOr(0);be=Yd(P.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,g,qe,Xe.baseColorFactor.toRenderColor(null),Be.emissiveFactor,Xe.metallicFactor,Xe.roughnessFactor,Be,We,o,S),K&&(M.shadowUniformsInitialized?fe.setShadowUniformValues(D,K.getShadowUniformValues()):(K.setupShadows(P.toUnwrapped(),fe,"model-tile",P.overscaledZ),M.shadowUniformsInitialized=!0)),xe=Ce.shouldRenderCutoff||qe<1||Be.alphaMode!=="OPAQUE"?An.alphaBlended:An.unblended}g.uploadCommonUniforms(D,fe,P.toUnwrapped(),null,Ce);const Ue=re.material.doubleSided?Kr.disabled:Kr.backCCW;if(y.instancedDataArray.length>20)ve.push(y.instancedDataBuffer),fe.draw(g,D.gl.TRIANGLES,Y,Wr.disabled,xe,Ue,be,o.id,re.vertexBuffer,re.indexBuffer,re.segments,o.paint,g.transform.zoom,void 0,ve,y.instancedDataArray.length);else{const Be=G?"u_instance":"u_normal_matrix";for(let Xe=0;Xe<y.instancedDataArray.length;++Xe)be[Be]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Xe,16),fe.draw(g,D.gl.TRIANGLES,Y,Wr.disabled,xe,Ue,be,o.id,re.vertexBuffer,re.indexBuffer,re.segments,o.paint,g.transform.zoom,void 0,ve)}}if(d.children)for(const re of d.children)ps(g,o,re,y,S,P,M)}const Np=[1,-1,1];function Rp(g,o,d,y){if(!d.modelManager)return!0;const S=d.modelManager;if(!d.shadowRenderer)return!0;const P=d.shadowRenderer,M=o.aabb;let D=!0,G=g.maxHeight;if(G===0){let Y=0;for(const te in g.instancesPerModel){const re=S.getModel(te,y);re?Y=Math.max(Y,Math.max(Math.max(re.aabb.max[0],re.aabb.max[1]),re.aabb.max[2])):D=!1}G=g.maxScale*Y*1.41+g.maxVerticalOffset,D&&(g.maxHeight=G)}M.max[2]=G,M.min[2]+=g.terrainElevationMin,M.max[2]+=g.terrainElevationMax,i.ab.vec3.transformMat4(M.min,M.min,o.tileMatrix),i.ab.vec3.transformMat4(M.max,M.max,o.tileMatrix);const K=M.intersects(P.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=K===2),K===0}function nu(g,o){const d=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],S=g.uniformValues.u_cutoff_params[2],P=g.uniformValues.u_cutoff_params[3];return y===d||P===S?1:i.aw(((o-d)/(y-d)-S)/(P-S),0,1)}function Ol(g,o,d,y){if(o.pitch<20)return 1;const S=o.getWorldToCameraMatrix();i.ab.mat4.multiply(S,S,g);const P=i.ab.vec4.fromValues(d.min[0],d.min[1],d.min[2],1);let M=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=M,G=M;P[1]=d.max[1],M=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=M[1]<D[1]?M:D,G=M[1]>G[1]?M:G,P[0]=d.max[0],M=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=M[1]<D[1]?M:D,G=M[1]>G[1]?M:G,P[1]=d.min[1],M=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=M[1]<D[1]?M:D,G=M[1]>G[1]?M:G;const K=i.aw(y[0],0,1),Y=100*o.pixelsPerMeter*i.aw(y[1],0,1),te=i.aw(y[2],0,1),re=i.ab.vec4.lerp(i.ab.vec4.create(),D,G,K),oe=Math.tan(.5*o.fovX),ve=-re[2]*oe;if(Y===0)return re[1]<-Math.abs(ve)?te:1;const fe=(-Math.abs(ve)-re[1])/Y,be=(Ce,Ue,Be)=>(1-Be)*Ce+Be*Ue,xe=i.aw(be(1,te,fe),te,1);return be(1,xe,i.aw((o.pitch-20)/20,0,1))}class Cs{}class nh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,d,y){{const te=this._storage.get(d.id);if(te)return te.lastUsedFrameIdx=o,te.buf}const S=y.gl,P=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),M=new ArrayBuffer(P),D=new Int16Array(M);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(M));const G=new i.dq;for(let te=0;te<P/2;te+=3){const re=D[te],oe=D[te+1],ve=D[te+2];G.emplaceBack(re,oe),G.emplaceBack(oe,ve),G.emplaceBack(ve,re)}const K=y.bindVertexArrayOES.current,Y=new Cs;return Y.buf=new fl(y,G),Y.lastUsedFrameIdx=o,this._storage.set(d.id,Y),y.bindVertexArrayOES.set(K),Y.buf}update(o){for(const[d,y]of this._storage)o-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(d))}destroy(){for(const[o,d]of this._storage)d.buf.destroy(),this._storage.delete(o)}}class df{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Ip=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Jm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class ms{constructor(o,d){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...d,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...d,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Qm=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class eg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,d){const y=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const M=new i.dr,D=new i.aU;M.emplaceBack(-1,-1),M.emplaceBack(1,-1),M.emplaceBack(1,1),M.emplaceBack(-1,1),D.emplaceBack(0,1,2),D.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(M,Qm.members),this.vignetteIdx=o.context.createIndexBuffer(D)}const S=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,y);const M={u_vignetteShape:(P={vignetteShape:[d.start,d.range,Math.pow(10,d.fadePower)],vignetteColor:[d.color.r,d.color.g,d.color.b,d.color.a*d.strength]}).vignetteShape,u_vignetteColor:P.vignetteColor};y.draw(o,o.context.gl.TRIANGLES,zr.disabled,Wr.disabled,An.alphaBlended,Kr.disabled,M,"vignette",this.vignetteVx,this.vignetteIdx,S,{})}var P}}class hf{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,d){const y=o.getFreeCameraOptions().position,S=y.toAltitude(),P=y.toLngLat(),M=i.ai(P.lng),D=i.ai(P.lat),G=o.pixelsPerMeter/d,K=M*i.ds,Y=i.ds*Math.log(Math.tan(Math.PI/4+D/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const te=-this._offsetYPrev+Y,re=-this._elevationPrev+S;this._accumulatedOffsetX+=(-this._offsetXPrev+K)*G,this._accumulatedOffsetY+=te*G,this._accumulatedElevation+=re*G,this._offsetXPrev=K,this._offsetYPrev=Y,this._elevationPrev=S}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function iu(g,o){return[-(g[0]-Math.floor(g[0]/o)*o),-(g[1]-Math.floor(g[1]/o)*o),-(g[2]-Math.floor(g[2]/o)*o)]}function Dp(g){const o=i.di(1323123451230),d=[];for(let y=0;y<g;++y){const S=2*o()-1,P=2*o()-1,M=2*o()-1;d.push(i.ab.vec3.fromValues(S,P,M))}return d}function Xl(g,o,d,y,S){const P=i.aw((S-d)/(y-d),0,1);return(1-P)*g+P*o}class td{constructor(o){this._movement=new hf,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new eg,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,d){const y=o.transform;this._movement.update(y,this._ppmScaleFactor);const S=y.starsProjMatrix,P=i.ab.quat.identity([]);i.ab.quat.rotateX(P,P,i.ai(90)-y._pitch),i.ab.quat.rotateZ(P,P,-y.angle);const M=i.ab.mat4.fromQuat(new Float32Array(16),P),D=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),G=i.ab.mat4.transpose([],D),K=i.ab.mat4.multiply([],G,M),Y=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Y-this._prevTime)*d,this._prevTime=Y,{projectionMatrix:S,modelviewMatrix:K}}}class ih extends td{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new ms(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const d=o.context;if(!this.particlesVx){const y=Dp(this.particlesCount),S=new i.dt,P=new i.aU;let M=0;const D=i.di(1323123451230);for(let G=0;G<y.length;++G){const K=y[G],Y=[2*D()-1,D(),D(),D()];S.emplaceBack(K[0],K[1],K[2],-1,-1,...Y),S.emplaceBack(K[0],K[1],K[2],1,-1,...Y),S.emplaceBack(K[0],K[1],K[2],1,1,...Y),S.emplaceBack(K[0],K[1],K[2],-1,1,...Y),P.emplaceBack(M+0,M+1,M+2),P.emplaceBack(M+0,M+2,M+3),M+=4}this.particlesVx=d.createVertexBuffer(S,Ip.members),this.particlesIdx=d.createIndexBuffer(P)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const d=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=o.transform.zoom;if(d.revealStart>y)return;const S=Xl(0,1,d.revealStart,d.revealStart+d.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const P=structuredClone(this._params);let M=[-P.direction.x,P.direction.y,-100];i.ab.vec3.normalize(M,M);const D=structuredClone(this._vignetteParams);D.strength*=S,P.overrideStyleParameters||(P.intensity=o.style.rain.state.density,P.timeFactor=o.style.rain.state.intensity,P.color=structuredClone(o.style.rain.state.color),M=structuredClone(o.style.rain.state.direction),P.screenThinning.intensity=o.style.rain.state.centerThinning,P.dropletSizeX=o.style.rain.state.dropletSize[0],P.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],P.distortionStrength=100*o.style.rain.state.distortionStrength,D.strength=1,D.color=structuredClone(o.style.rain.state.vignetteColor));const G=this.updateOnRender(o,P.timeFactor),K=o.context,Y=K.gl,te=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new i.T(K,{width:o.width,height:o.height,data:null},Y.RGBA8)),P.distortionStrength>0&&(K.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Y.copyTexSubImage2D(Y.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const re=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(K,re),K.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const oe=[P.color.r,P.color.g,P.color.b,P.color.a],ve=(fe,be)=>{const xe=iu(this._movement.getPosition(),fe),Ce=P.dropletSizeX,Ue=P.dropletSizeX*P.dropletSizeYScale,Be=o.width/2,Xe=o.height/2,qe=Xl(0,P.screenThinning.start,0,1,P.screenThinning.intensity),We=Xl(.001,P.screenThinning.range,0,1,P.screenThinning.intensity),$e=Xl(0,P.screenThinning.particleOffset,0,1,P.screenThinning.intensity),Ke=(it={modelview:G.modelviewMatrix,projection:G.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:xe,velocityConeAperture:P.velocityConeAperture,velocity:P.velocity,boxSize:fe,rainDropletSize:[Ce,Ue],distortionStrength:P.distortionStrength,rainDirection:M,color:oe,screenSize:[te.width,te.height],thinningCenterPos:[Be,Xe],thinningShape:[qe,We,Math.pow(10,P.screenThinning.fadePower)],thinningAffectedRatio:P.screenThinning.affectedRatio,thinningParticleOffset:$e,shapeDirectionalPower:P.shapeDirPower,shapeNormalPower:P.shapeNormalPower,mode:be?0:1},{u_modelview:Float32Array.from(it.modelview),u_projection:Float32Array.from(it.projection),u_time:it.time,u_cam_pos:it.camPos,u_texScreen:0,u_velocityConeAperture:it.velocityConeAperture,u_velocity:it.velocity,u_boxSize:it.boxSize,u_rainDropletSize:it.rainDropletSize,u_distortionStrength:it.distortionStrength,u_rainDirection:it.rainDirection,u_color:it.color,u_screenSize:it.screenSize,u_thinningCenterPos:it.thinningCenterPos,u_thinningShape:it.thinningShape,u_thinningAffectedRatio:it.thinningAffectedRatio,u_thinningParticleOffset:it.thinningParticleOffset,u_shapeDirectionalPower:it.shapeDirectionalPower,u_shapeNormalPower:it.shapeNormalPower,u_mode:it.mode});var it;const _t=Math.round(P.intensity*this.particlesCount),mt=i.b7.simpleSegment(0,0,4*_t,2*_t);re.draw(o,Y.TRIANGLES,zr.disabled,Wr.disabled,An.alphaBlended,Kr.disabled,Ke,"rain_particles",this.particlesVx,this.particlesIdx,mt,{})};P.distortionStrength>0&&ve(P.boxSize,!0),ve(P.boxSize,!1),this._vignette.draw(o,D)}}const ff=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class pf extends td{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new ms(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const d=o.context;if(!this.particlesVx){const y=Dp(this.particlesCount),S=new i.du,P=new i.aU;let M=0;const D=i.di(1323123451230);for(let G=0;G<y.length;++G){const K=y[G],Y=D(),te=D(),re=D(),oe=[G/y.length,Y,te,re],ve=[D(),D()];S.emplaceBack(K[0],K[1],K[2],-1,-1,...oe,...ve),S.emplaceBack(K[0],K[1],K[2],1,-1,...oe,...ve),S.emplaceBack(K[0],K[1],K[2],1,1,...oe,...ve),S.emplaceBack(K[0],K[1],K[2],-1,1,...oe,...ve),P.emplaceBack(M+0,M+1,M+2),P.emplaceBack(M+0,M+2,M+3),M+=4}this.particlesVx=d.createVertexBuffer(S,ff.members),this.particlesIdx=d.createIndexBuffer(P)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const d=structuredClone(this._params);let y=[-d.direction.x,d.direction.y,-100];i.ab.vec3.normalize(y,y);const S=structuredClone(this._vignetteParams),P=d.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},M=o.transform.zoom;if(P.revealStart>M)return;const D=Xl(0,1,P.revealStart,P.revealStart+P.revealRange,M);S.strength*=D,d.overrideStyleParameters||(d.intensity=o.style.snow.state.density,d.timeFactor=o.style.snow.state.intensity,d.color=structuredClone(o.style.snow.state.color),y=structuredClone(o.style.snow.state.direction),d.screenThinning.intensity=o.style.snow.state.centerThinning,d.billboardSize=2.79*o.style.snow.state.flakeSize,S.strength=1,S.color=structuredClone(o.style.snow.state.vignetteColor));const G=this.updateOnRender(o,d.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const K=o.context,Y=K.gl,te=o.transform,re=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(K,re),((oe,ve,fe)=>{const be=iu(this._movement.getPosition(),oe),xe=te.width/2,Ce=te.height/2,Ue=Xl(0,fe.screenThinning.start,0,1,fe.screenThinning.intensity),Be=Xl(.001,fe.screenThinning.range,0,1,fe.screenThinning.intensity),Xe=Xl(0,fe.screenThinning.particleOffset,0,1,fe.screenThinning.intensity),qe=(We={modelview:G.modelviewMatrix,projection:G.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:be,velocityConeAperture:fe.velocityConeAperture,velocity:fe.velocity,horizontalOscillationRadius:fe.horizontalOscillationRadius,horizontalOscillationRate:fe.horizontalOscillationRate,boxSize:oe,billboardSize:1*fe.billboardSize,simpleShapeParameters:[fe.shapeFadeStart,fe.shapeFadePower],screenSize:[te.width,te.height],thinningCenterPos:[xe,Ce],thinningShape:[Ue,Be,Math.pow(10,fe.screenThinning.fadePower)],thinningAffectedRatio:fe.screenThinning.affectedRatio,thinningParticleOffset:Xe,color:[fe.color.r,fe.color.g,fe.color.b,fe.color.a],direction:y},{u_modelview:Float32Array.from(We.modelview),u_projection:Float32Array.from(We.projection),u_time:We.time,u_cam_pos:We.camPos,u_velocityConeAperture:We.velocityConeAperture,u_velocity:We.velocity,u_horizontalOscillationRadius:We.horizontalOscillationRadius,u_horizontalOscillationRate:We.horizontalOscillationRate,u_boxSize:We.boxSize,u_billboardSize:We.billboardSize,u_simpleShapeParameters:We.simpleShapeParameters,u_screenSize:We.screenSize,u_thinningCenterPos:We.thinningCenterPos,u_thinningShape:We.thinningShape,u_thinningAffectedRatio:We.thinningAffectedRatio,u_thinningParticleOffset:We.thinningParticleOffset,u_particleColor:We.color,u_direction:We.direction});var We;const $e=Math.round(fe.intensity*this.particlesCount),Ke=i.b7.simpleSegment(0,0,4*$e,2*$e);this.particlesVx&&this.particlesIdx&&re.draw(o,Y.TRIANGLES,zr.disabled,Wr.disabled,An.alphaBlended,Kr.disabled,qe,"snow_particles",this.particlesVx,this.particlesIdx,Ke,{})})(d.boxSize,0,d),this._vignette.draw(o,S)}}const mf={symbol:function(g,o,d,y,S){if(g.renderPass!=="translucent")return;const P=Wr.disabled,M=g.colorModeForRenderPass(),D=d.layout.get("text-variable-anchor"),G=d.layout.get("text-size-scale-range"),K=i.aw(g.scaleFactor,G[0],G[1]);D&&function(re,oe,ve,fe,be,xe,Ce,Ue){const Be=oe.transform,Xe=be==="map",qe=xe==="map";for(const We of re){const $e=fe.getTile(We),Ke=$e.getBucket(ve);if(!Ke||!Ke.text||!Ke.text.segments.get().length)continue;const it=i.bp(Ke.textSizeData,Be.zoom,Ue),_t=Wc(We,Ke.getProjection(),Be),mt=Be.calculatePixelsToTileUnitsMatrix($e),Mt=qa(_t,$e.tileID.canonical,qe,Xe,Be,Ke.getProjection(),mt),jt=Ke.hasIconTextFit()&&Ke.hasIconData();if(it){const dt=Math.pow(2,Be.zoom-$e.tileID.overscaledZ);jp(Ke,Xe,qe,Ce,i.cX,Be,Mt,We,dt,it,jt)}}}(y,g,d,o,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),S,K);const Y=d.paint.get("icon-opacity").constantOr(1)!==0,te=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Y||te)?Ku(g,o,d,y,P,M):(Y&&Ku(g,o,d,y,P,M,{onlyIcons:!0}),te&&Ku(g,o,d,y,P,M,{onlyText:!0})),o.map.showCollisionBoxes&&(Xd(g,o,d,y,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),Xd(g,o,d,y,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,d,y){if(g.renderPass!=="translucent")return;const S=d.paint.get("circle-opacity"),P=d.paint.get("circle-stroke-width"),M=d.paint.get("circle-stroke-opacity"),D=d.layout.get("circle-sort-key").constantOr(1)!==void 0,G=d.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(P.constantOr(1)===0||M.constantOr(1)===0))return;const K=g.context,Y=K.gl,te=g.transform,re=g.depthModeForSublayer(0,zr.ReadOnly),oe=Wr.disabled,ve=g.colorModeForDrapableLayerRenderPass(G),fe=te.projection.name==="globe",be=[i.at(te.center.lng),i.aA(te.center.lat)],xe=[];for(let Ue=0;Ue<y.length;Ue++){const Be=y[Ue],Xe=o.getTile(Be),qe=Xe.getBucket(d);if(!qe||qe.projection.name!==te.projection.name)continue;const We=qe.programConfigurations.get(d.id),$e=i.cY(d),Ke=g.isTileAffectedByFog(Be);fe&&$e.push("PROJECTION_GLOBE_VIEW"),$e.push("DEPTH_D24"),g.terrain&&te.depthOcclusionForSymbolsAndCircles&&$e.push("DEPTH_OCCLUSION");const it=g.getOrCreateProgram("circle",{config:We,defines:$e,overrideFog:Ke}),_t=qe.layoutVertexBuffer,mt=qe.globeExtVertexBuffer,Mt=qe.indexBuffer,jt=te.projection.createInversionMatrix(te,Be.canonical),dt={programConfiguration:We,program:it,layoutVertexBuffer:_t,globeExtVertexBuffer:mt,indexBuffer:Mt,uniformValues:i.cZ(g,Be,Xe,jt,be,d),tile:Xe};if(D){const Et=qe.segments.get();for(const Ut of Et)xe.push({segments:new i.b7([Ut]),sortKey:Ut.sortKey,state:dt})}else xe.push({segments:qe.segments,sortKey:0,state:dt})}D&&xe.sort((Ue,Be)=>Ue.sortKey-Be.sortKey);const Ce={useDepthForOcclusion:te.depthOcclusionForSymbolsAndCircles};for(const Ue of xe){const{programConfiguration:Be,program:Xe,layoutVertexBuffer:qe,globeExtVertexBuffer:We,indexBuffer:$e,uniformValues:Ke,tile:it}=Ue.state,_t=Ue.segments;g.terrain&&g.terrain.setupElevationDraw(it,Xe,Ce),g.uploadCommonUniforms(K,Xe,it.tileID.toUnwrapped()),Xe.draw(g,Y.TRIANGLES,re,oe,ve,Kr.disabled,Ke,d.id,qe,$e,_t,d.paint,te.zoom,Be,[We])}},heatmap:function(g,o,d,y){if(d.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const S=g.context,P=S.gl,M=Wr.disabled,D=new An([P.ONE,P.ONE,P.ONE,P.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(oe,ve,fe,be){const xe=oe.gl,Ce=ve.width*be,Ue=ve.height*be;oe.activeTexture.set(xe.TEXTURE1),oe.viewport.set([0,0,Ce,Ue]);let Be=fe.heatmapFbo;if(!Be||Be&&(Be.width!==Ce||Be.height!==Ue)){Be&&Be.destroy();const Xe=xe.createTexture();xe.bindTexture(xe.TEXTURE_2D,Xe),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,xe.LINEAR),Be=fe.heatmapFbo=oe.createFramebuffer(Ce,Ue,!0,null),function(qe,We,$e,Ke,it,_t){const mt=qe.gl;mt.texImage2D(mt.TEXTURE_2D,0,qe.extRenderToTextureHalfFloat?mt.RGBA16F:mt.RGBA,it,_t,0,mt.RGBA,qe.extRenderToTextureHalfFloat?mt.HALF_FLOAT:mt.UNSIGNED_BYTE,null),Ke.colorAttachment.set($e)}(oe,0,Xe,Be,Ce,Ue)}else xe.bindTexture(xe.TEXTURE_2D,Be.colorAttachment.get()),oe.bindFramebuffer.set(Be.framebuffer)})(S,g,d,g.transform.projection.name==="globe"?.5:.25),S.clear({color:i.aj.transparent});const G=g.transform,K=G.projection.name==="globe",Y=K?["PROJECTION_GLOBE_VIEW"]:[],te=K?Kr.frontCCW:Kr.disabled,re=[i.at(G.center.lng),i.aA(G.center.lat)];for(let oe=0;oe<y.length;oe++){const ve=y[oe];if(o.hasRenderableParent(ve))continue;const fe=o.getTile(ve),be=fe.getBucket(d);if(!be||be.projection.name!==G.projection.name)continue;const xe=g.isTileAffectedByFog(ve),Ce=be.programConfigurations.get(d.id),Ue=g.getOrCreateProgram("heatmap",{config:Ce,defines:Y,overrideFog:xe}),{zoom:Be}=g.transform;g.terrain&&g.terrain.setupElevationDraw(fe,Ue),g.uploadCommonUniforms(S,Ue,ve.toUnwrapped());const Xe=G.projection.createInversionMatrix(G,ve.canonical);Ue.draw(g,P.TRIANGLES,zr.disabled,M,D,te,mr(g,ve,fe,Xe,re,Be,d.paint.get("heatmap-intensity")),d.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,d.paint,g.transform.zoom,Ce,K?[be.globeExtVertexBuffer]:null)}S.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(S,P){const M=S.context,D=M.gl,G=P.heatmapFbo;if(!G)return;M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,G.colorAttachment.get()),M.activeTexture.set(D.TEXTURE1);let K=P.colorRampTexture;K||(K=P.colorRampTexture=new i.T(M,P.colorRamp,D.RGBA8)),K.bind(D.LINEAR,D.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,D.TRIANGLES,zr.disabled,Wr.disabled,S.colorModeForRenderPass(),Kr.disabled,((Y,te,re,oe)=>({u_image:0,u_color_ramp:1,u_opacity:te.paint.get("heatmap-opacity")}))(0,P),P.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,P.paint,S.transform.zoom)}(g,d))},line:function(g,o,d,y){if(g.renderPass!=="translucent")return;const S=d.paint.get("line-opacity"),P=d.paint.get("line-width");if(S.constantOr(1)===0||P.constantOr(1)===0)return;const M=d.paint.get("line-emissive-strength"),D=d.paint.get("line-occlusion-opacity"),G=d.layout.get("line-elevation-reference"),K=d.layout.get("line-width-unit")==="meters",Y=G==="sea",te=g.context,re=te.gl;if(d.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const oe=d.layout.get("line-cross-slope"),ve=oe!==void 0,fe=oe<1,be=g.colorModeForDrapableLayerRenderPass(M),xe=g.terrain&&g.terrain.renderingToTexture,Ce=xe?1:i.q.devicePixelRatio,Ue=d.paint.get("line-dasharray"),Be=Ue.constantOr(1),Xe=d.layout.get("line-cap"),qe=Ue.constantOr(null),We=Xe.constantOr(null),$e=d.paint.get("line-pattern"),Ke=$e.constantOr(1),it=$e.constantOr(null),_t=d.paint.get("line-opacity").constantOr(1);let mt=!Ke&&_t!==1||g.depthOcclusion&&D>0&&D<1;const Mt=d.paint.get("line-gradient"),jt=Ke?"linePattern":"line",dt=i.c_(d);let Et;if(xe&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(mt=!1),D!==0&&g.depthOcclusion){const pt=d.paint._values["line-opacity"];pt&&pt.value&&pt.value.kind==="constant"?Et=pt.value:i.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}P.value.kind!=="constant"&&P.value.isLineProgressConstant===!1&&dt.push("VARIABLE_LINE_WIDTH");const Ut=(pt,Dt,kt,Yt,Bt)=>{for(const It of pt){const Ht=o.getTile(It);if(Ke&&!Ht.patternsLoaded())continue;const tr=Ht.getBucket(d);if(!tr||tr.hasZOffset&&!Bt||!tr.hasZOffset&&Bt)continue;g.prepareDrawTile();const gr=tr.programConfigurations.get(d.id),_r=g.isTileAffectedByFog(It),qr=g.getOrCreateProgram(jt,{config:gr,defines:Dt,overrideFog:_r,overrideRtt:!Bt&&void 0});if(it&&Ht.imageAtlas){const Zr=i.A.from(it).getPrimary().scaleSelf(Ce).serialize(),wn=Ht.imageAtlas.patternPositions[Zr];wn&&gr.setConstantPatternPositions(wn)}if(!Ke&&qe&&We&&Ht.lineAtlas){const Zr=Ht.lineAtlas.getDash(qe,We);Zr&&gr.setConstantPatternPositions(Zr)}let[jr,Ir]=d.paint.get("line-trim-offset");(We==="round"||We==="square")&&jr!==Ir&&(jr===0&&(jr-=1),Ir===1&&(Ir+=1));const Hr=xe?It.projMatrix:null,Mn=K?1/tr.tileToMeter/i.ar(Ht,1,g.transform.zoom):1,di=K?1/tr.tileToMeter/i.ar(Ht,1,Math.floor(g.transform.zoom)):1,Gi=Ke?i.c$(g,Ht,d,Hr,Ce,Mn,di,[jr,Ir]):i.d0(g,Ht,d,Hr,tr.lineClipsArray.length,Ce,Mn,di,[jr,Ir]);if(Mt){const Zr=tr.gradients[d.id];let wn=Zr.texture;if(d.gradientVersion!==Zr.version){let Sr=256;if(d.stepInterpolant){const kn=o.getSource().maxzoom,ei=It.canonical.z===kn?Math.ceil(1<<g.transform.maxZoom-It.canonical.z):1;Sr=i.aw(i.d1(tr.maxLineLength/i.ag*1024*ei),256,te.maxTextureSize)}Zr.gradient=i.d2({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:Sr,image:Zr.gradient||void 0,clips:tr.lineClipsArray}),Zr.texture?Zr.texture.update(Zr.gradient):Zr.texture=new i.T(te,Zr.gradient,re.RGBA8),Zr.version=d.gradientVersion,wn=Zr.texture}te.activeTexture.set(re.TEXTURE1),wn.bind(d.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}Be&&(te.activeTexture.set(re.TEXTURE0),Ht.lineAtlasTexture&&Ht.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),gr.updatePaintBuffers()),Ke&&(te.activeTexture.set(re.TEXTURE0),Ht.imageAtlasTexture&&Ht.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),gr.updatePaintBuffers()),Bt&&!Y&&g.terrain.setupElevationDraw(Ht,qr),g.uploadCommonUniforms(te,qr,It.toUnwrapped());const Zn=Zr=>{Et!=null&&(Et.value=_t*D),qr.draw(g,re.TRIANGLES,kt,Zr,be,Kr.disabled,Gi,d.id,tr.layoutVertexBuffer,tr.indexBuffer,tr.segments,d.paint,g.transform.zoom,gr,[tr.layoutVertexBuffer2,tr.patternVertexBuffer,tr.zOffsetVertexBuffer]),Et!=null&&(Et.value=_t)};if(mt&&!Bt){const Zr=g.stencilModeForClipping(It).ref;Zr===0&&xe&&te.clear({stencil:0});const wn={func:re.EQUAL,mask:255};Gi.u_alpha_discard_threshold=.8,Zn(new Wr(wn,Zr,255,re.KEEP,re.KEEP,re.INVERT)),Gi.u_alpha_discard_threshold=0,Zn(new Wr(wn,Zr,255,re.KEEP,re.KEEP,re.KEEP))}else mt&&Bt&&(Gi.u_alpha_discard_threshold=.001),Zn(Bt?Yt:g.stencilModeForClipping(It))}};if(d.hasNonElevatedBuckets){const pt=!xe&&g.terrain;D!==0&&pt?i.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has line-z-offset enabled.`):pt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${d.id}.`):Ut(y,dt,g.depthModeForSublayer(0,zr.ReadOnly),Wr.disabled,!1)}if(d.hasElevatedBuckets){dt.push("ELEVATED"),ve&&dt.push(fe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Y&&dt.push("ELEVATION_REFERENCE_SEA");const pt=mt?g.stencilModeFor3D():Wr.disabled,Dt=new zr(g.depthOcclusion?re.GREATER:re.LEQUAL,zr.ReadOnly,g.depthRangeFor3D);g.forceTerrainMode=!0,Ut(y,dt,Dt,pt,!0),g.forceTerrainMode=!1}mt&&(g.resetStencilClippingMasks(),xe&&te.clear({stencil:0})),D===0||g.depthOcclusion||xe||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,o,d,y){const S=d.paint.get("fill-color"),P=d.paint.get("fill-opacity"),M=d.is3D(),D=new zr(g.context.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D);if(P.constantOr(1)===0)return;const G=d.paint.get("fill-emissive-strength"),K=g.colorModeForDrapableLayerRenderPass(G),Y=d.paint.get("fill-pattern"),te=g.opaquePassEnabledForLayer()&&!Y.constantOr(1)&&S.constantOr(i.aj.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===te){const re=M?D:g.depthModeForSublayer(1,g.renderPass==="opaque"?zr.ReadWrite:zr.ReadOnly);Zu(g,o,d,y,re,K,!1)}if(!M&&g.renderPass==="translucent"&&d.paint.get("fill-antialias")){const re=M?D:g.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,zr.ReadOnly);Zu(g,o,d,y,re,K,!0)}},"fill-extrusion":function(g,o,d,y){const S=d.paint.get("fill-extrusion-opacity"),P=g.context,M=P.gl,D=g.terrain,G=D&&D.renderingToTexture;if(S===0)return;const K=g.conflationActive&&g.style.isLayerClipped(d,o.getSource()),Y=g.style.order.indexOf(d.fqid);if(K&&function(te,re,oe,ve,fe){for(const be of ve){const xe=re.getTile(be).getBucket(oe);xe&&(xe.updateReplacement(be,te.replacementSource,fe),xe.uploadCentroid(te.context))}}(g,o,d,y,Y),D||K)for(const te of y){const re=o.getTile(te).getBucket(d);re&&Xu(g.context,o,te,re,d,D,K)}if(g.renderPass==="shadow"&&g.shadowRenderer){const te=g.shadowRenderer;if(D&&S<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const re=te.getShadowPassDepthMode(),oe=te.getShadowPassColorMode();Qd(g,o,d,y,re,Wr.disabled,oe,K)}else if(g.renderPass==="translucent"){const te=!d.paint.get("fill-extrusion-pattern").constantOr(1),re=d.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!G&&re.a!==0){const oe=new zr(g.context.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D);S===1&&te?Qd(g,o,d,y,oe,Wr.disabled,An.unblended,K):(Qd(g,o,d,y,oe,Wr.disabled,An.disabled,K),Qd(g,o,d,y,oe,g.stencilModeFor3D(),g.colorModeForRenderPass(),K),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&te&&(!D&&g.transform.projection.name!=="globe"||G)){const oe=d.paint.get("fill-extrusion-opacity"),ve=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),be=d.paint.get("fill-extrusion-flood-light-intensity"),xe=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ce=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(xe?null:d.lut).toArray01().slice(0,3),Ue=ve>0&&fe>0,Be=be>0,Xe=(We,$e,Ke)=>(1-Ke)*We+Ke*$e,qe=We=>{const $e=g.depthModeForSublayer(1,zr.ReadOnly,M.LEQUAL,!0),Ke=d.paint.get(We?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),it=Xe(.1,3,Ke),_t=g._showOverdrawInspector;if(!_t){const mt=new Wr({func:M.ALWAYS,mask:255},255,255,M.KEEP,M.KEEP,M.REPLACE),Mt=new An([M.ONE,M.ONE,M.ONE,M.ONE],i.aj.transparent,[!1,!1,!1,!0],M.MIN);Yu(g,o,d,y,$e,mt,Mt,Kr.disabled,We,"sdf",oe,ve,fe,be,Ce,it,K,!1)}{const mt=_t?Wr.disabled:new Wr({func:M.EQUAL,mask:255},255,255,M.KEEP,M.DECR,M.DECR),Mt=_t?g.colorModeForRenderPass():new An([M.ONE_MINUS_DST_ALPHA,M.DST_ALPHA,M.ONE,M.ONE],i.aj.transparent,[!0,!0,!0,!0]);Yu(g,o,d,y,$e,mt,Mt,Kr.disabled,We,"color",oe,ve,fe,be,Ce,it,K,!1)}};if(G){const We=($e,Ke,it)=>{const _t=g.depthModeForSublayer(1,zr.ReadOnly,M.LEQUAL,!1),mt=d.paint.get($e?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Mt=Xe(.1,3,mt);{const jt=new An([M.ONE,M.ONE,M.ONE,M.ONE],i.aj.transparent,[!1,!1,!1,!0]);Yu(g,o,d,y,_t,Wr.disabled,jt,Kr.disabled,$e,"clear",oe,ve,fe,be,Ce,Mt,K,Ke)}{const jt=new Wr({func:M.ALWAYS,mask:255},255,255,M.KEEP,M.KEEP,M.REPLACE),dt=new An([M.ONE,M.ONE,M.ONE,M.ONE],i.aj.transparent,[!1,!1,!1,!0],M.MIN);Yu(g,o,d,y,_t,jt,dt,Kr.disabled,$e,"sdf",oe,ve,fe,be,Ce,Mt,K,Ke)}{const jt=$e?M.ZERO:M.ONE_MINUS_DST_ALPHA,dt=new Wr({func:M.EQUAL,mask:255},255,255,M.KEEP,M.DECR,M.DECR),Et=new An([jt,M.DST_ALPHA,M.ONE_MINUS_DST_ALPHA,M.ZERO],i.aj.transparent,[!0,!0,!0,!0]);Yu(g,o,d,y,_t,dt,Et,Kr.disabled,$e,"color",oe,ve,fe,be,Ce,Mt,K,Ke)}{const jt=new An([M.ONE,M.ONE,M.ONE,$e?M.ZERO:M.ONE],i.aj.transparent,[!1,!1,!1,!0],$e?M.FUNC_ADD:M.MAX);Yu(g,o,d,y,_t,Wr.disabled,jt,Kr.disabled,$e,"clear",oe,ve,fe,be,Ce,Mt,K,Ke,it)}};if(Ue||Be){let $e;if(g.prepareDrawTile(),D){const Ke=D.drapeBufferSize[0],it=D.drapeBufferSize[1];$e=D.framebufferCopyTexture,$e&&(!$e||$e.size[0]===Ke&&$e.size[1]===it)||($e&&$e.destroy(),$e=D.framebufferCopyTexture=new i.T(P,new i.r({width:Ke,height:it}),M.RGBA8)),$e.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.copyTexSubImage2D(M.TEXTURE_2D,0,0,0,0,0,Ke,it)}Ue&&We(!0,!1,$e),Be&&We(!1,!0,$e)}}else Ue&&qe(!0),Be&&qe(!1),(Ue||Be)&&g.resetStencilClippingMasks()}}},hillshade:function(g,o,d,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const S=g.context,P=g.terrain&&g.terrain.renderingToTexture,[M,D]=g.renderPass!=="translucent"||P?[{},y]:g.stencilConfigForOverlap(y);for(const G of D){const K=o.getTile(G);if(K.needsHillshadePrepare&&g.renderPass==="offscreen")wp(g,K,d);else if(g.renderPass==="translucent"){const Y=g.depthModeForSublayer(0,zr.ReadOnly),te=d.paint.get("hillshade-emissive-strength"),re=g.colorModeForDrapableLayerRenderPass(te),oe=P&&g.terrain?g.terrain.stencilModeForRTTOverlap(G):M[G.overscaledZ];c0(g,G,K,d,Y,oe,re)}}S.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,d,y,S,P){if(g.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const M=g.transform.projection.name==="globe",D=d.paint.get("raster-elevation")!==0,G=D&&M;if(g.renderElevatedRasterBackface&&!G)return;const K=g.context,Y=K.gl,te=o.getSource(),re=function(qe,We,$e,Ke){const it=We.paint.get("raster-color"),_t=qe.type==="raster-array",mt=[],Mt=We.paint.get("raster-resampling"),jt=We.paint.get("raster-color-mix");let dt=We.paint.get("raster-color-range");const Et=[jt[0],jt[1],jt[2],0],Ut=jt[3];let pt=Mt==="nearest"?Ke.NEAREST:Ke.LINEAR;if(_t&&(mt.push("RASTER_ARRAY"),it||mt.push("RASTER_COLOR"),Mt==="linear"&&mt.push("RASTER_ARRAY_LINEAR"),pt=Ke.NEAREST,!dt&&qe.rasterLayers)){const Dt=qe.rasterLayers.find(({id:kt})=>kt===We.sourceLayer);Dt&&Dt.fields&&Dt.fields.range&&(dt=Dt.fields.range)}if(dt=dt||[0,1],it){mt.push("RASTER_COLOR"),$e.activeTexture.set(Ke.TEXTURE2),We.updateColorRamp(dt);let Dt=We.colorRampTexture;Dt||(Dt=We.colorRampTexture=new i.T($e,We.colorRamp,Ke.RGBA8)),Dt.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE)}return{mix:Et,range:dt,offset:Ut,defines:mt,resampling:pt}}(te,d,K,Y);if(te instanceof i.aJ&&!y.length&&!M)return;const oe=d.paint.get("raster-emissive-strength"),ve=g.colorModeForDrapableLayerRenderPass(oe),fe=g.terrain&&g.terrain.renderingToTexture,be=!g.options.moving,xe=d.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;if(te instanceof i.aJ&&!y.length&&(te.onNorthPole||te.onSouthPole)){const qe=D?g.stencilModeFor3D():Wr.disabled;return void xt(!!te.onNorthPole,null,g,o,d,oe,re,Kr.disabled,qe)}if(!y.length)return;const[Ce,Ue]=te instanceof i.aJ||fe?[{},y]:g.stencilConfigForOverlap(y),Be=Ue[Ue.length-1].overscaledZ;G&&re.defines.push("PROJECTION_GLOBE_VIEW"),D&&re.defines.push("RENDER_CUTOFF");const Xe=(qe,We,$e)=>{for(const Ke of qe){const it=Ke.toUnwrapped(),_t=o.getTile(Ke);if(fe&&(!_t||!_t.hasData()))continue;K.activeTexture.set(Y.TEXTURE0);const mt=Yl(_t,te,d,re);if(!mt||!mt.texture)continue;const{texture:Mt,mix:jt,offset:dt,tileSize:Et,buffer:Ut}=mt;let pt,Dt;fe?(pt=zr.disabled,Dt=Ke.projMatrix):D?(pt=new zr(Y.LEQUAL,zr.ReadWrite,g.depthRangeFor3D),Dt=M?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(it,be)):(pt=g.depthModeForSublayer(Ke.overscaledZ-Be,d.paint.get("raster-opacity")===1?zr.ReadWrite:zr.ReadOnly,Y.LESS),Dt=g.transform.calculateProjMatrix(it,be));const kt=g.terrain&&fe?g.terrain.stencilModeForRTTOverlap(Ke):Ce[Ke.overscaledZ],Yt=P?0:d.paint.get("raster-fade-duration");_t.registerFadeDuration(Yt);const Bt=o.findLoadedParent(Ke,0),It=kl(_t,Bt,o,g.transform,Yt);let Ht,tr;g.terrain&&g.terrain.prepareDrawTile(),K.activeTexture.set(Y.TEXTURE0),Mt.bind(xe,Y.CLAMP_TO_EDGE),K.activeTexture.set(Y.TEXTURE1),Bt?(Bt.texture&&Bt.texture.bind(xe,Y.CLAMP_TO_EDGE),Ht=Math.pow(2,Bt.tileID.overscaledZ-_t.tileID.overscaledZ),tr=[_t.tileID.canonical.x*Ht%1,_t.tileID.canonical.y*Ht%1]):Mt.bind(xe,Y.CLAMP_TO_EDGE),Mt.useMipmap&&K.extTextureFilterAnisotropic&&g.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax);const gr=g.transform;let _r;const qr=D?wc(gr):[0,0,0,0];let jr,Ir,Hr,Mn,di,Gi=0;if(G&&te instanceof i.aJ&&te.coordinates.length>3)jr=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),Ir=Float32Array.from(gr.globeMatrix),Hr=Float32Array.from(i.cD(gr)),Mn=[i.at(gr.center.lng),i.aA(gr.center.lat)],_r=te.elevatedGlobePerspectiveTransform,di=te.elevatedGlobeGridMatrix||new Float32Array(9);else if(G){const Sr=i.cE(Ke.canonical);Gi=i.cF(Sr.getCenter().lat),jr=Float32Array.from(i.bb(i.cH(Ke.canonical))),Ir=Float32Array.from(gr.globeMatrix),Hr=Float32Array.from(i.cD(gr)),Mn=[i.at(gr.center.lng),i.aA(gr.center.lat)],_r=[0,0],di=Float32Array.from(i.cG(Ke.canonical,Sr,Gi,gr.worldSize/gr._pixelsPerMercatorPixel))}else _r=te instanceof i.aJ?te.perspectiveTransform:[0,0],jr=new Float32Array(16),Ir=new Float32Array(9),Hr=new Float32Array(16),Mn=[0,0],di=new Float32Array(9);const Zn=so(Dt,jr,Ir,Hr,di,tr||[0,0],i.ae(g.transform.zoom),Mn,qr,Ht||1,It,d,_r,D?d.paint.get("raster-elevation"):0,2,jt,dt,re.range,Et,Ut,oe),Zr=g.isTileAffectedByFog(Ke),wn=g.getOrCreateProgram("raster",{defines:re.defines,overrideFog:Zr});if(g.uploadCommonUniforms(K,wn,it),te instanceof i.aJ){const Sr=te.elevatedGlobeVertexBuffer,kn=te.elevatedGlobeIndexBuffer;if(fe||!M)te.boundsBuffer&&te.boundsSegments&&wn.draw(g,Y.TRIANGLES,pt,Wr.disabled,ve,Kr.disabled,Zn,d.id,te.boundsBuffer,g.quadTriangleIndexBuffer,te.boundsSegments);else if(Sr&&kn){const ei=gr.zoom<=i.c6?te.elevatedGlobeSegments:te.getSegmentsForLongitude(gr.center.lng);ei&&wn.draw(g,Y.TRIANGLES,pt,Wr.disabled,ve,We,Zn,d.id,Sr,kn,ei)}}else if(G){pt=new zr(Y.LEQUAL,zr.ReadOnly,g.depthRangeFor3D);const Sr=g.globeSharedBuffers;if(Sr){const[kn,ei,si]=Sr.getGridBuffers(Gi,!1);wn.draw(g,Y.TRIANGLES,pt,$e||kt,g.colorModeForRenderPass(),We,Zn,d.id,kn,ei,si)}}else{const{tileBoundsBuffer:Sr,tileBoundsIndexBuffer:kn,tileBoundsSegments:ei}=g.getTileBoundsBuffers(_t);wn.draw(g,Y.TRIANGLES,pt,kt,ve,Kr.disabled,Zn,d.id,Sr,kn,ei)}}if(!(te instanceof i.aJ)&&G)for(const Ke of qe){const it=Ke.canonical.y===(1<<Ke.canonical.z)-1;Ke.canonical.y===0&&xt(!0,Ke,g,o,d,oe,re,We,$e||Wr.disabled),it&&xt(!1,Ke,g,o,d,oe,re,We===Kr.frontCW?Kr.backCW:Kr.frontCW,$e||Wr.disabled)}};G?Xe(Ue,g.renderElevatedRasterBackface?Kr.backCW:Kr.frontCW,g.stencilModeFor3D()):Xe(Ue,Kr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,o,d,y,S,P){g.renderPass==="offscreen"&&function(M,D,G,K){if(!K.length)return;const Y=M.context,te=Y.gl,re=D.getSource();if(!(re instanceof $a))return;const oe=Math.ceil(Math.sqrt(G.paint.get("raster-particle-count")));let ve=G.particlePositionRGBAImage;if(!ve||ve.width!==oe){const Ue=function(Be){const Xe=Be*Be,qe=new Uint8Array(4*Xe),We=function(Ke){return Ke|=0,Ke=Math.imul(2747636419^Ke,2654435769),Ke=Math.imul(Ke^Ke>>>16,2654435769),((Ke=Math.imul(Ke^Ke>>>16,2654435769))>>>0)/4294967296},$e=1/1.1;for(let Ke=0;Ke<Xe;Ke++){const it=$e*(We(2*Ke+0)+kr),_t=$e*(We(2*Ke+1)+kr),mt=255*it%1,Mt=255*_t%1,jt=mt,dt=_t-Mt/255,Et=Mt;qe[4*Ke+0]=255*(it-mt/255),qe[4*Ke+1]=255*jt,qe[4*Ke+2]=255*dt,qe[4*Ke+3]=255*Et}return qe}(oe);ve=G.particlePositionRGBAImage=new i.r({width:oe,height:oe},Ue)}let fe=G.particleFramebuffer;fe?fe.width!==oe&&(fe.destroy(),fe=G.particleFramebuffer=Y.createFramebuffer(oe,oe,!0,null)):fe=G.particleFramebuffer=Y.createFramebuffer(oe,oe,!0,null);const be=[];for(const Ue of K){const Be=D.getTile(Ue);if(!(Be instanceof Uc))continue;const Xe=Sc(Be,re,G);if(!Xe)continue;const qe=[Be.tileSize,Be.tileSize];let We=G.tileFramebuffer;We||(We=G.tileFramebuffer=Y.createFramebuffer(qe[0],qe[1],!0,null));let $e=Be.rasterParticleState;$e||($e=Be.rasterParticleState=new jy(Y,Ue,qe,ve));const Ke=$e.update(G.lastInvalidatedAt);$e.particleTextureDimension!==oe&&$e.updateParticleTexture(Ue,ve);const it=$e.targetColorTexture;$e.targetColorTexture=$e.backgroundColorTexture,$e.backgroundColorTexture=it;const _t=$e.particleTexture0;$e.particleTexture0=$e.particleTexture1,$e.particleTexture1=_t,be.push([Ue,Xe,$e,Ke])}if(be.length===0)return;const xe=i.q.now(),Ce=G.previousDrawTimestamp?.001*(xe-G.previousDrawTimestamp):.0167;if(G.previousDrawTimestamp=xe,G.hasColorMap()){Y.activeTexture.set(te.TEXTURE0+2);let Ue=G.colorRampTexture;Ue||(Ue=G.colorRampTexture=new i.T(Y,G.colorRamp,te.RGBA8)),Ue.bind(te.LINEAR,te.CLAMP_TO_EDGE)}Y.bindFramebuffer.set(G.tileFramebuffer.framebuffer),function(Ue,Be,Xe){const qe=Ue.context,We=qe.gl,$e=Be.tileFramebuffer;qe.activeTexture.set(We.TEXTURE0);const Ke={u_texture:0,u_opacity:1.05*(_t=Be.paint.get("raster-particle-fade-opacity-factor"))/(_t+.05)},it=Ue.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var _t;for(const mt of Xe){const[,,Mt,jt]=mt;$e.colorAttachment.set(Mt.targetColorTexture.texture),qe.viewport.set([0,0,$e.width,$e.height]),qe.clear({color:i.aj.transparent}),jt&&(Mt.backgroundColorTexture.bind(We.NEAREST,We.CLAMP_TO_EDGE),it.draw(Ue,We.TRIANGLES,zr.disabled,Wr.disabled,An.alphaBlended,Kr.disabled,Ke,Be.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments))}}(M,G,be),function(Ue,Be,Xe,qe){const We=Ue.context,$e=We.gl,Ke=Xe.tileFramebuffer,it=Ue.transform.projection.name==="globe",_t=Xe.paint.get("raster-particle-max-speed");for(const mt of qe){const[Mt,jt,dt]=mt;We.activeTexture.set($e.TEXTURE0+0),jt.texture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),Ke.colorAttachment.set(dt.targetColorTexture.texture);const Et=Ue.getOrCreateProgram("rasterParticleDraw",{defines:jt.defines,overrideFog:!1});We.activeTexture.set($e.TEXTURE0+1);const Ut=jt.scalarData?[]:[0,1,2,3].map(kt=>i.d4[kt](Mt));Ut.push(Mt);const pt=Mt.canonical.x,Dt=Mt.canonical.y;for(const kt of Ut){const Yt=Be.getTile(it?kt.wrapped():kt);if(!Yt)continue;const Bt=Yt.rasterParticleState;if(!Bt)continue;const It=kt.canonical.x+(1<<kt.canonical.z)*(kt.wrap-Mt.wrap),Ht=kt.canonical.y;Bt.particleTexture0.bind($e.NEAREST,$e.CLAMP_TO_EDGE);const tr=Ey(1,Bt.particleTexture0.size[0],[It-pt,Ht-Dt],0,jt.texture.size,2,_t,jt.textureOffset,jt.scale,jt.offset);Et.draw(Ue,$e.POINTS,zr.disabled,Wr.disabled,An.alphaBlended,Kr.disabled,tr,Xe.id,Bt.particleIndexBuffer,void 0,Bt.particleSegment)}}}(M,D,G,be),Y.bindFramebuffer.set(G.particleFramebuffer.framebuffer),function(Ue,Be,Xe,qe){const We=Ue.context,$e=We.gl,Ke=Be.paint.get("raster-particle-max-speed"),it=qe*Be.paint.get("raster-particle-speed-factor")*.15,_t=function(Mt){return Math.pow(Mt,6)}(.01+1*Be.paint.get("raster-particle-reset-rate-factor")),mt=Be.particleFramebuffer;We.viewport.set([0,0,mt.width,mt.height]);for(const Mt of Xe){const[,jt,dt]=Mt;We.activeTexture.set($e.TEXTURE0+0),jt.texture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),We.activeTexture.set($e.TEXTURE0+1);const Et=dt.particleTexture0;Et.bind($e.NEAREST,$e.CLAMP_TO_EDGE);const Ut=dl(1,Et.size[0],0,jt.texture.size,Ke,it,_t,jt.textureOffset,jt.scale,jt.offset);mt.colorAttachment.set(dt.particleTexture1.texture),We.clear({color:i.aj.transparent}),Ue.getOrCreateProgram("rasterParticleUpdate",{defines:jt.defines}).draw(Ue,$e.TRIANGLES,zr.disabled,Wr.disabled,An.unblended,Kr.disabled,Ut,Be.id,Ue.viewportBuffer,Ue.quadTriangleIndexBuffer,Ue.viewportSegments)}}(M,G,be,Ce)}(g,o,d,y),g.renderPass==="translucent"&&(function(M,D,G,K,Y){const te=M.context,re=te.gl,oe=D.getSource().tileSize,ve=5*(1-i.ac(i.bY,i.bY+1,M.transform.zoom))*oe+G.paint.get("raster-particle-elevation"),fe=!M.options.moving,be=M.transform.projection.name==="globe";if(!K.length)return;const[xe,Ce]=M.stencilConfigForOverlap(K),Ue=[];be&&Ue.push("PROJECTION_GLOBE_VIEW");const Be=M.stencilModeFor3D();for(const Xe of Ce){const qe=Xe.toUnwrapped(),We=D.getTile(Xe);if(!We.rasterParticleState)continue;const $e=We.rasterParticleState,Ke=100;We.registerFadeDuration(Ke);const it=D.findLoadedParent(Xe,0),_t=kl(We,it,D,M.transform,Ke);let mt,Mt;M.terrain&&M.terrain.prepareDrawTile(),te.activeTexture.set(re.TEXTURE0),$e.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),te.activeTexture.set(re.TEXTURE1),it&&it.rasterParticleState?(it.rasterParticleState.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),mt=Math.pow(2,it.tileID.overscaledZ-We.tileID.overscaledZ),Mt=[We.tileID.canonical.x*mt%1,We.tileID.canonical.y*mt%1]):$e.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const jt=be?Float32Array.from(M.transform.expandedFarZProjMatrix):M.transform.calculateProjMatrix(qe,fe),dt=M.transform,Et=tu(dt),Ut=i.cE(Xe.canonical),pt=i.cF(Ut.getCenter().lat);let Dt,kt,Yt,Bt,It;be?(Dt=Float32Array.from(i.bb(i.cH(Xe.canonical))),kt=Float32Array.from(dt.globeMatrix),Yt=Float32Array.from(i.cD(dt)),Bt=[i.at(dt.center.lng),i.aA(dt.center.lat)],It=Float32Array.from(i.cG(Xe.canonical,Ut,pt,dt.worldSize/dt._pixelsPerMercatorPixel))):(Dt=new Float32Array(16),kt=new Float32Array(9),Yt=new Float32Array(16),Bt=[0,0],It=new Float32Array(9));const Ht=kp(jt,Dt,kt,Yt,It,Mt||[0,0],i.ae(M.transform.zoom),Bt,Et,mt||1,_t,ve),tr=M.isTileAffectedByFog(Xe),gr=M.getOrCreateProgram("rasterParticle",{defines:Ue,overrideFog:tr});if(M.uploadCommonUniforms(te,gr,qe),be){const _r=new zr(re.LEQUAL,zr.ReadOnly,M.depthRangeFor3D),qr=0,jr=M.globeSharedBuffers;if(jr){const[Ir,Hr,Mn]=jr.getGridBuffers(pt,qr!==0);gr.draw(M,re.TRIANGLES,_r,Be,An.alphaBlended,M.renderElevatedRasterBackface?Kr.frontCCW:Kr.backCCW,Ht,G.id,Ir,Hr,Mn)}}else{const _r=M.depthModeForSublayer(0,zr.ReadOnly),qr=xe[Xe.overscaledZ],{tileBoundsBuffer:jr,tileBoundsIndexBuffer:Ir,tileBoundsSegments:Hr}=M.getTileBoundsBuffers(We);gr.draw(M,re.TRIANGLES,_r,qr,An.alphaBlended,Kr.disabled,Ht,G.id,jr,Ir,Hr)}}M.resetStencilClippingMasks()}(g,o,d,y),g.style.map.triggerRepaint())},background:function(g,o,d,y){const S=d.paint.get("background-color"),P=d.paint.get("background-color-use-theme").constantOr("default")==="none",M=d.paint.get("background-opacity"),D=d.paint.get("background-emissive-strength"),G=d.paint.get("background-pitch-alignment")==="viewport";if(M===0)return;const K=g.context,Y=K.gl,te=g.transform,re=te.tileSize,oe=d.paint.get("background-pattern");let ve;if(oe!==void 0&&(oe===null||(ve=g.imageManager.getPattern(oe.toString(),d.scope,g.style.getLut(d.scope)),!ve)))return;const fe=!oe&&S.a===1&&M===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==fe)return;const be=Wr.disabled,xe=g.depthModeForSublayer(0,fe==="opaque"?zr.ReadWrite:zr.ReadOnly),Ce=g.colorModeForDrapableLayerRenderPass(D),Ue=oe?"backgroundPattern":"background";let Be,Xe=y;if(Xe||(Be=g.getBackgroundTiles(),Xe=Object.values(Be).map(qe=>qe.tileID)),oe&&(K.activeTexture.set(Y.TEXTURE0),g.imageManager.bind(g.context,d.scope)),G){const qe=g.getOrCreateProgram(Ue,{overrideFog:!1,overrideRtt:!0}),We=new Float32Array(i.ab.mat4.identity([])),$e=new i.aG(0,0,0,0,0),Ke=oe?ky(We,D,M,g,0,d.scope,ve,G,{tileID:$e,tileSize:re}):hl(We,D,M,S.toRenderColor(P?null:d.lut));qe.draw(g,Y.TRIANGLES,xe,be,Ce,Kr.disabled,Ke,d.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const qe of Xe){const We=g.isTileAffectedByFog(qe),$e=g.getOrCreateProgram(Ue,{overrideFog:We}),Ke=qe.toUnwrapped(),it=y?qe.projMatrix:g.transform.calculateProjMatrix(Ke);g.prepareDrawTile();const _t=o?o.getTile(qe):Be?Be[qe.key]:new dc(qe,re,te.zoom,g),mt=oe?ky(it,D,M,g,0,d.scope,ve,G,{tileID:qe,tileSize:re}):hl(it,D,M,S.toRenderColor(P?null:d.lut));g.uploadCommonUniforms(K,$e,Ke);const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:jt,tileBoundsSegments:dt}=g.getTileBoundsBuffers(_t);$e.draw(g,Y.TRIANGLES,xe,be,Ce,Kr.disabled,mt,d.id,Mt,jt,dt)}},sky:function(g,o,d){const y=g._atmosphere?i.ae(g.transform.zoom):1,S=d.paint.get("sky-opacity")*y;if(S===0)return;const P=g.context,M=d.paint.get("sky-type"),D=new zr(P.gl.LEQUAL,zr.ReadOnly,[0,1]),G=g.frameCounter/1e3%1;M==="atmosphere"?g.renderPass==="offscreen"?d.needsSkyboxCapture(g)&&(function(K,Y,te,re){const oe=K.context,ve=oe.gl;let fe=Y.skyboxFbo;if(!fe){fe=Y.skyboxFbo=oe.createFramebuffer(32,32,!0,null),Y.skyboxGeometry=new Km(oe),Y.skyboxTexture=oe.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,Y.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Ue=0;Ue<6;++Ue)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}oe.bindFramebuffer.set(fe.framebuffer),oe.viewport.set([0,0,32,32]);const be=Y.getCenter(K,!0),xe=K.getOrCreateProgram("skyboxCapture"),Ce=new Float64Array(16);i.ab.mat4.identity(Ce),i.ab.mat4.rotateY(Ce,Ce,.5*-Math.PI),fi(K,Y,xe,Ce,be,0),i.ab.mat4.identity(Ce),i.ab.mat4.rotateY(Ce,Ce,.5*Math.PI),fi(K,Y,xe,Ce,be,1),i.ab.mat4.identity(Ce),i.ab.mat4.rotateX(Ce,Ce,.5*-Math.PI),fi(K,Y,xe,Ce,be,2),i.ab.mat4.identity(Ce),i.ab.mat4.rotateX(Ce,Ce,.5*Math.PI),fi(K,Y,xe,Ce,be,3),i.ab.mat4.identity(Ce),fi(K,Y,xe,Ce,be,4),i.ab.mat4.identity(Ce),i.ab.mat4.rotateY(Ce,Ce,Math.PI),fi(K,Y,xe,Ce,be,5),oe.viewport.set([0,0,K.width,K.height])}(g,d),d.markSkyboxValid(g)):g.renderPass==="sky"&&function(K,Y,te,re,oe){const ve=K.context,fe=ve.gl,be=K.transform,xe=K.getOrCreateProgram("skybox");ve.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Ce=((Ue,Be,Xe,qe,We)=>({u_matrix:Ue,u_sun_direction:Be,u_cubemap:0,u_opacity:qe,u_temporal_offset:We}))(be.skyboxMatrix,Y.getCenter(K,!1),0,re,oe);K.uploadCommonUniforms(ve,xe),xe.draw(K,fe.TRIANGLES,te,Wr.disabled,K.colorModeForRenderPass(),Kr.backCW,Ce,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(g,d,D,S,G):M==="gradient"&&g.renderPass==="sky"&&function(K,Y,te,re,oe){const ve=K.context,fe=ve.gl,be=K.transform,xe=K.getOrCreateProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new Km(ve)),ve.activeTexture.set(fe.TEXTURE0);let Ce=Y.colorRampTexture;Ce||(Ce=Y.colorRampTexture=new i.T(ve,Y.colorRamp,fe.RGBA8)),Ce.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const Ue=((Be,Xe,qe,We,$e)=>({u_matrix:Be,u_color_ramp:0,u_center_direction:Xe,u_radius:i.ai(qe),u_opacity:We,u_temporal_offset:$e}))(be.skyboxMatrix,Y.getCenter(K,!1),Y.paint.get("sky-gradient-radius"),re,oe);K.uploadCommonUniforms(ve,xe),xe.draw(K,fe.TRIANGLES,te,Wr.disabled,K.colorModeForRenderPass(),Kr.backCW,Ue,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(g,d,D,S,G)},debug:function(g,o,d,y,S,P){for(let M=0;M<d.length;M++)if(S){const K=new i.aj(y.r*.8,y.g*.8,y.b*.8,1);Ws(g,o,d[M],y,-1,-1,P),Ws(g,o,d[M],y,-1,1,P),Ws(g,o,d[M],y,1,1,P),Ws(g,o,d[M],y,1,-1,P),Ws(g,o,d[M],K,0,0,P)}else Ws(g,o,d[M],y,0,0,P)},custom:function(g,o,d,y){const S=g.context,P=d.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&d.isDraped(o)){if(g.renderPass==="offscreen"){const M=P.prerender;if(M){if(g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;M.call(P,S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else M.call(P,S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const D=P.renderToTile;if(D){const G=y[0].canonical,K=new i.aa(G.x+y[0].wrap*(1<<G.z),G.y,G.z);S.setDepthMode(zr.disabled),S.setStencilMode(Wr.disabled),S.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),D.call(P,S.gl,K),S.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),S.setStencilMode(Wr.disabled);const M=P.renderingMode==="3d"?new zr(g.context.gl.LEQUAL,zr.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,zr.ReadOnly);if(S.setDepthMode(M),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;P.render(S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else P.render(S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState(),S.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,o,d,y){if(g.renderPass==="opaque")return;const S=d.paint.get("model-opacity").constantOr(1);if(S===0)return;const P=d.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!P||g.terrain&&S<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const M=g.shadowRenderer,D=d.paint.get("model-receive-shadows");M&&(M.useNormalOffset=!0,D||(M.enabled=!1));const G=()=>{M&&(M.useNormalOffset=!0,D||(M.enabled=!0))},K=o.getSource();if(g.renderPass==="light-beam"&&K.type!=="batched-model")return;if(K.type==="vector"||K.type==="geojson")return function(xe,Ce,Ue,Be,Xe){const qe=xe.transform;if(qe.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${qe.projection.name} projection is not yet implemented`);const We=qe.getFreeCameraOptions().position;if(!xe.modelManager)return;const $e=xe.modelManager;Ue.modelManager=$e;const Ke=xe.shadowRenderer;if(!Ue._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const it=Ue._unevaluatedLayout._values["model-id"],_t=Object.assign({},Ue.layout.get("model-id").parameters),mt=xe.style.order.indexOf(Ue.fqid);for(const Mt of Be){const jt=Ce.getTile(Mt).getBucket(Ue);if(!jt||jt.projection.name!==qe.projection.name)continue;const dt=jt.getModelUris();dt&&!jt.modelsRequested&&($e.addModelsFromBucket(dt,Xe),jt.modelsRequested=!0);const Et=Xm(Mt,qe);_t.zoom=Et;const Ut=it.possiblyEvaluate(_t);if(Wo(xe,jt,Mt),ns.shadowUniformsInitialized=!1,ns.useSingleShadowCascade=!!Ke&&Ke.getMaxCascadeForTile(Mt.toUnwrapped())===0,xe.renderPass==="shadow"&&Ke){if(xe.currentShadowCascade===1&&jt.isInsideFirstShadowMapFrustum)continue;const kt=qe.calculatePosMatrix(Mt.toUnwrapped(),qe.worldSize);if(ns.tileMatrix.set(kt),ns.shadowTileMatrix=Float32Array.from(Ke.calculateShadowPassMatrixFromMatrix(kt)),ns.aabb.min.fill(0),ns.aabb.max[0]=ns.aabb.max[1]=i.ag,ns.aabb.max[2]=0,Rp(jt,ns,xe,Ue.scope))continue}const pt=1<<Mt.canonical.z,Dt=[((We.x-Mt.wrap)*pt-Mt.canonical.x)*i.ag,(We.y*pt-Mt.canonical.y)*i.ag,We.z*pt*i.ag];xe.conflationActive&&Object.keys(jt.instancesPerModel).length>0&&xe.style.isLayerClipped(Ue,Ce.getSource())&&jt.updateReplacement(Mt,xe.replacementSource,mt,Xe)&&(jt.uploaded=!1,jt.upload(xe.context));for(let kt in jt.instancesPerModel){const Yt=jt.instancesPerModel[kt];Yt.features.length>0&&(kt=Ut.evaluate(Yt.features[0].feature,{}));const Bt=$e.getModel(kt,Xe);if(Bt&&Bt.uploaded)for(const It of Bt.nodes)ps(xe,Ue,It,Yt,Dt,Mt,ns)}}}(g,o,d,y,K.type==="vector"?d.scope:""),void G();if(!K.loaded())return;if(K.type==="batched-model")return function(xe,Ce,Ue,Be){Ue.resetLayerRenderingStats(xe);const Xe=xe.context,qe=xe.transform,We=xe.style.fog,$e=xe.shadowRenderer;if(qe.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${qe.projection.name} projection is not yet implemented`);const Ke=xe.transform.getFreeCameraOptions().position,it=i.ab.vec3.scale([],[Ke.x,Ke.y,Ke.z],xe.transform.worldSize),_t=i.ab.vec3.negate([],it),mt=i.ab.mat4.identity([]),Mt=i.dj(qe.center.lat,qe.zoom),jt=i.ab.mat4.fromScaling([],[1,1,1/Mt]);i.ab.mat4.translate(mt,mt,_t);const dt=Ue.paint.get("model-opacity").constantOr(1),Et=new zr(Xe.gl.LEQUAL,zr.ReadWrite,xe.depthRangeFor3D),Ut=new zr(Xe.gl.LEQUAL,zr.ReadOnly,xe.depthRangeFor3D),pt=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Dt=xe.renderPass==="shadow",kt=Dt&&$e?$e.getCurrentCascadeFrustum():qe.getFrustum(qe.scaleZoom(qe.worldSize)),Yt=Ue.paint.get("model-front-cutoff"),Bt=Yt[2]<1,It=Tl(xe,Ue.paint.get("model-cutoff-fade-range")),Ht=Ue.getLayerRenderingStats();(function(tr,gr,_r,qr){const jr=tr.terrain?tr.terrain.exaggeration():0,Ir=tr.transform.zoom;for(const Hr of qr){const Mn=gr.getTile(Hr).getBucket(_r);Mn&&(tr.conflationActive&&Mn.updateReplacement(Hr,tr.replacementSource),Mn.evaluateScale(tr,_r),tr.terrain&&jr>0&&Mn.elevationUpdate(tr.terrain,jr,Hr,_r.source),Mn.needsReEvaluation(tr,Ir,_r)&&Mn.evaluate(_r))}})(xe,Ce,Ue,Be),function(){let tr,gr,_r;Bt?(tr=Be.length-1,gr=-1,_r=-1):(tr=0,gr=Be.length,_r=1);const qr=new Float64Array(16),jr=i.ab.vec3.create(),Ir=new i.P(0,0);for(let Hr=tr;Hr!==gr;Hr+=_r){const Mn=Be[Hr],di=Ce.getTile(Mn).getBucket(Ue);if(!di||!di.uploaded)continue;let Gi=!1;$e&&(Gi=$e.getMaxCascadeForTile(Mn.toUnwrapped())===0);const Zn=qe.calculatePosMatrix(Mn.toUnwrapped(),qe.worldSize),Zr=di.modelTraits;!Dt&&Bt&&(i.ab.mat4.invert(qr,Zn),i.ab.vec3.transformMat4(jr,it,qr),Ir.x=jr[0],Ir.y=jr[1]);const wn=[];for(const Sr of di.getNodesInfo()){if(Sr.hiddenByReplacement||!Sr.node.meshes)continue;const kn=Sr.node;let ei=0;xe.terrain&&kn.elevation&&(ei=kn.elevation*xe.terrain.exaggeration());const si=(()=>{const Nn=Sr.aabb;return pt.min=[...Nn.min],pt.max=[...Nn.max],pt.min[2]+=ei,pt.max[2]+=ei,i.ab.vec3.transformMat4(pt.min,pt.min,Zn),i.ab.vec3.transformMat4(pt.max,pt.max,Zn),pt})(),Qi=Sr.evaluatedScale;if(Qi[0]<=1&&Qi[1]<=1&&Qi[2]<=1&&si.intersects(kt)===0)continue;if(!Dt&&Bt){const Nn=.16666666666666666;Sr.cameraCollisionOpacity=it[0]>si.min[0]&&it[0]<si.max[0]&&it[1]>si.min[1]&&it[1]<si.max[1]&&it[2]*Mt<si.max[2]&&kn.footprint&&i.bA(Ir,kn.footprint)?Math.max(Sr.cameraCollisionOpacity-Nn,0):Math.min(1,Sr.cameraCollisionOpacity+Nn)}const na=[...Zn],Ma=kn.anchor?kn.anchor[0]:0,ba=kn.anchor?kn.anchor[1]:0;i.ab.mat4.translate(na,na,[Ma*(Qi[0]-1),ba*(Qi[1]-1),ei]),i.ab.vec3.exactEquals(Qi,i.dm)||i.ab.mat4.scale(na,na,Qi);const Es=i.ab.mat4.multiply([],na,kn.matrix),ks=i.ab.mat4.multiply([],qe.expandedFarZProjMatrix,Es),Oi=i.ab.mat4.multiply([],qe.expandedFarZProjMatrix,na),Pi=i.ab.vec4.transformMat4([],[Ma,ba,ei,1],ks)[2];kn.hidden=!1;let _i=dt;Dt||(Bt&&(_i*=Sr.cameraCollisionOpacity,_i*=Ol(na,qe,Sr.aabb,Yt)),_i*=nu(It,Pi)),_i!==0?wn.push({nodeInfo:Sr,depth:Pi,opacity:_i,wvpForNode:ks,wvpForTile:Oi,nodeModelMatrix:Es,tileModelMatrix:na}):kn.hidden=!0}Dt||wn.sort((Sr,kn)=>!Bt||Sr.opacity===1&&kn.opacity===1?Sr.depth<kn.depth?-1:1:Sr.opacity===1?-1:kn.opacity===1?1:Sr.depth>kn.depth?-1:1);for(const Sr of wn){const kn=Sr.nodeInfo,ei=kn.node;let si=i.ab.mat4.multiply([],jt,Sr.tileModelMatrix);i.ab.mat4.multiply(si,mt,si);const Qi=i.ab.mat4.invert([],si);i.ab.mat4.transpose(Qi,Qi),i.ab.mat4.scale(Qi,Qi,Np),si=i.ab.mat4.multiply(si,si,ei.matrix);const na=xe.renderPass==="light-beam",Ma=Ue.paint.get("model-color-use-theme").constantOr("default")==="none",ba=Zr&i.dp.HasMapboxMeshFeatures,Es=ba?0:kn.evaluatedRMEA[0][2];for(let ks=0;ks<ei.meshes.length;++ks){const Oi=ei.meshes[ks],Pi=ks===ei.lightMeshIndex;let _i=Sr.wvpForNode;if(Pi){if(!na&&!xe.terrain&&xe.shadowRenderer){xe.currentLayer<xe.firstLightBeamLayer&&(xe.firstLightBeamLayer=xe.currentLayer);continue}_i=Sr.wvpForTile}else if(na)continue;const Nn={defines:[]},ia=[];if(!Dt&&$e&&($e.useNormalOffset=!!Oi.normalBuffer),ra(Nn.defines,ia,Oi,xe,Ma?null:Ue.lut),ba||Nn.defines.push("DIFFUSE_SHADED"),Gi&&Nn.defines.push("SHADOWS_SINGLE_CASCADE"),Ht&&(Dt?Ht.numRenderedVerticesInShadowPass+=Oi.vertexArray.length:Ht.numRenderedVerticesInTransparentPass+=Oi.vertexArray.length),Dt){ed(Oi,Sr.nodeModelMatrix,xe,Ue);continue}let is=null;if(We){const Co=Ao(Sr.nodeModelMatrix,xe.transform);if(is=new Float32Array(Co),qe.projection.name!=="globe"){const yl=Oi.aabb.min,Ni=Oi.aabb.max,[uh,Ql]=We.getOpacityForBounds(Co,yl[0],yl[1],Ni[0],Ni[1]);Nn.overrideFog=uh>=Ye||Ql>=Ye}}const Ci=Oi.material;let Ds;Ci.occlusionTexture&&Ci.occlusionTexture.offsetScale&&(Ds=Ci.occlusionTexture.offsetScale,Nn.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const gl=xe.getOrCreateProgram("model",Nn);!Dt&&$e&&$e.setupShadowsFromMatrix(Sr.tileModelMatrix,gl,$e.useNormalOffset),xe.uploadCommonUniforms(Xe,gl,null,is);const gs=Ci.pbrMetallicRoughness;gs.metallicFactor=.9,gs.roughnessFactor=.5;const Po=Yd(new Float32Array(_i),new Float32Array(si),new Float32Array(Qi),new Float32Array(ei.matrix),xe,Sr.opacity,gs.baseColorFactor.toRenderColor(null),Ci.emissiveFactor,gs.metallicFactor,gs.roughnessFactor,Ci,Es,Ue,[0,0,0],Ds);!Pi&&(kn.hasTranslucentParts||Sr.opacity<1)&&gl.draw(xe,Xe.gl.TRIANGLES,Et,Wr.disabled,An.disabled,Kr.backCCW,Po,Ue.id,Oi.vertexBuffer,Oi.indexBuffer,Oi.segments,Ue.paint,xe.transform.zoom,void 0,ia),gl.draw(xe,Xe.gl.TRIANGLES,Pi?Ut:Et,Wr.disabled,Pi||Sr.opacity<1||kn.hasTranslucentParts?An.alphaBlended:An.unblended,Kr.backCCW,Po,Ue.id,Oi.vertexBuffer,Oi.indexBuffer,Oi.segments,Ue.paint,xe.transform.zoom,void 0,ia)}}}}()}(g,o,d,y),void G();if(K.type!=="model")return;const Y=K.getModels(),te=[],re=g.transform.getFreeCameraOptions().position,oe=i.ab.vec3.scale([],[re.x,re.y,re.z],g.transform.worldSize);i.ab.vec3.negate(oe,oe);const ve=[],fe=[];let be=0;for(const xe of Y){const Ce=d.paint.get("model-rotation").constantOr(null),Ue=d.paint.get("model-scale").constantOr(null),Be=d.paint.get("model-translation").constantOr(null);xe.computeModelMatrix(g,Ce,Ue,Be,!0,!0,!1);const Xe=i.ab.mat4.identity([]),qe=i.dj(xe.position.lat,g.transform.zoom),We=i.ab.mat4.fromScaling([],[1,1,1/qe]);i.ab.mat4.translate(Xe,Xe,oe),te.push({zScaleMatrix:We,negCameraPosMatrix:Xe});for(const $e of xe.nodes)rs(g.transform,$e,xe.matrix,g.transform.expandedFarZProjMatrix,be,ve,fe);be++}if(ve.sort((xe,Ce)=>Ce.depth-xe.depth),g.renderPass!=="shadow"){if(S===1)for(const xe of fe)ua(xe,g,d,te[xe.modelIndex],Wr.disabled,g.colorModeForRenderPass());else{for(const xe of fe)ua(xe,g,d,te[xe.modelIndex],Wr.disabled,An.disabled);for(const xe of fe)ua(xe,g,d,te[xe.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const xe of ve)ua(xe,g,d,te[xe.modelIndex],Wr.disabled,g.colorModeForRenderPass());G()}else{for(const xe of fe)ed(xe.mesh,xe.nodeModelMatrix,g,d);for(const xe of ve)ed(xe.mesh,xe.nodeModelMatrix,g,d);G()}}},ah={line:function(g,o,d){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const y=o.getVisibleCoordinates();for(const S of y){const P=o.getTile(S).getBucket(g);if(P&&(P.hasZOffset?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,o,d){const y=o.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,y.type==="vector"?g.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const S=y.getModels();for(const P of S)P.upload(d.context)},raster:function(g,o,d){const y=o.getSource();if(!(y instanceof $a&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const P=g.paint.get("raster-array-band")||y.getInitialBand(S);if(P==null)return;const M=o.getIds().map(D=>o.getTileByID(D));for(const D of M)D.updateNeeded(S,P)&&y.prepareTile(D,S,P)},"raster-particle":function(g,o,d){const y=o.getSource();if(!(y instanceof $a&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const P=g.paint.get("raster-particle-array-band")||y.getInitialBand(S);if(P==null)return;const M=o.getIds().map(D=>o.getTileByID(D));for(const D of M)D.updateNeeded(S,P)&&y.prepareTile(D,S,P)}};class tg{constructor(o,d,y,S,P){this.context=new My(o,d),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=P,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const M=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const G of M)this._debugParams.enabledLayers[G]=!0;P.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),P.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),P.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),P.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),P.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),P.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const G of M)P.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],G);this.occlusionParams=new df(P),this.setup(),this.numSublayers=Fo.maxUnderzooming+Fo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Dd(this),this._wireframeDebugCache=new nh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,D,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=S}updateTerrain(o,d){const y=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Kl(this,o));const S=this._terrain;this.transform.elevation=y?S:null,S.update(o,this.transform,d),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(o){const d=o.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,S]=d.getFovAdjustedRange(this.transform._fov);if(y>S)return void(this.transform.fogCullDistSq=null);const P=y+.78*(S-y);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new Kl(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,d){if(this.width=o*i.q.devicePixelRatio,this.height=d*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const o=this.context,d=new i.b4;d.emplaceBack(0,0),d.emplaceBack(i.ag,0),d.emplaceBack(0,i.ag),d.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=o.createVertexBuffer(d,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const y=new i.b4;y.emplaceBack(0,0),y.emplaceBack(i.ag,0),y.emplaceBack(0,i.ag),y.emplaceBack(i.ag,i.ag),this.debugBuffer=o.createVertexBuffer(y,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const S=new i.b4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(S,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const P=new i.aT;P.emplaceBack(0,0,0,0),P.emplaceBack(i.ag,0,i.ag,0),P.emplaceBack(0,i.ag,0,i.ag),P.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=o.createVertexBuffer(P,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const M=new i.aU;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(M);const D=new i.b5;for(const K of[0,1,3,2,0])D.emplaceBack(K);this.debugIndexBuffer=o.createIndexBuffer(D),this.emptyTexture=new i.T(o,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=i.ab.mat4.create();const G=this.context.gl;this.stencilClearMode=new Wr({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,zr.disabled,this.stencilClearMode,An.disabled,Kr.disabled,Ji(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,d,y){if(!d||this.currentStencilSource===d.id||!o.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const G of y)if(this._tileClippingMaskIDs[G.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=d.id;const S=this.context,P=S.gl;this.nextStencilID+y.length>256&&this.clearStencil(),S.setColorMode(An.disabled),S.setDepthMode(zr.disabled);const M=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of y){const G=d.getTile(D),K=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:te,tileBoundsSegments:re}=this.getTileBoundsBuffers(G);M.draw(this,P.TRIANGLES,zr.disabled,new Wr({func:P.ALWAYS,mask:0},K,255,P.KEEP,P.KEEP,P.REPLACE),An.disabled,Kr.disabled,Ji(D.projMatrix),"$clipping",Y,te,re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new Wr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const d=this.context.gl;return new Wr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,y=o.sort((M,D)=>D.overscaledZ-M.overscaledZ),S=y[y.length-1].overscaledZ,P=y[0].overscaledZ-S+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const M={};for(let D=0;D<P;D++)M[D+S]=new Wr({func:d.GEQUAL,mask:255},D+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=P,[M,y]}return[{[S]:Wr.disabled},y]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new An([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?An.unblended:An.alphaBlended}colorModeForDrapableLayerRenderPass(o){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new An([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,d,y,S=!1){if(this.depthOcclusion)return new zr(this.context.gl.GREATER,zr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return zr.disabled;const P=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new zr(y||this.context.gl.LEQUAL,d,[P,P])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,d=Math.ceil(this.width),y=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),P=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===d&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),d!==0&&y!==0&&(this.depthFBO=new Mp(this.context,d,y,!1,"texture"),this.depthTexture=new i.T(this.context,{width:d,height:y,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),o.bindTexture(o.TEXTURE_2D,P),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,d,y,0,0,d,y,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,d)=>o+d/this._fpsHistory.length,0))}render(o,d){const y=i.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=d;const S=this.style._mergedLayers,P=!(!this.terrain||!this.terrain.enabled),M=()=>this.style._getOrder(P).filter(dt=>{const Et=S[dt];return!(Et.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Et.type]});let D=M(),G=!1,K=!1;for(const dt of D){const Et=S[dt];Et.type==="circle"&&(G=!0),Et.type==="symbol"&&(Et.hasInitialOcclusionOpacityProperties?K=!0:G=!0)}let Y=D.map(dt=>S[dt]);const te=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let re=0,oe=!1;for(const dt in te){const Et=te[dt];Et.used&&(Et.prepare(this.context),Et.getSource().usedInConflation&&++re)}let ve=!1;for(const dt of Y)dt.isHidden(this.transform.zoom)||(dt.type==="clip"&&(ve=!0),this.prepareLayer(dt));const fe={},be={},xe={},Ce={},Ue={};for(const dt in te){const Et=te[dt];fe[dt]=Et.getVisibleCoordinates(),be[dt]=fe[dt].slice().reverse(),xe[dt]=Et.getVisibleCoordinates(!0).reverse(),Ce[dt]=Et.getShadowCasterCoordinates(),Ue[dt]=Et.sortCoordinatesByDistance(fe[dt])}const Be=dt=>{const Et=this.style.getLayerSourceCache(dt);return Et&&Et.used?Et.getSource():null};if(re||ve||this._clippingActiveLastFrame){const dt=[],Et=[];let Ut=0;for(const pt of Y)this.isSourceForClippingOrConflation(pt,Be(pt))&&(dt.push(pt),Et.push(Ut)),Ut++;if(dt&&(ve||dt.length>1)||this._clippingActiveLastFrame){ve=!1;const pt=[];for(let Dt=0;Dt<dt.length;Dt++){const kt=dt[Dt],Yt=Et[Dt],Bt=this.style.getLayerSourceCache(kt);if(!Bt||!Bt.used||!Bt.getSource().usedInConflation&&kt.type!=="clip")continue;let It=i.dx,Ht=i.by.None;const tr=[];let gr=!0;if(kt.type==="clip"){It=Yt;for(const _r of kt.layout.get("clip-layer-types"))Ht|=_r==="model"?i.by.Model:_r==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const _r of kt.layout.get("clip-layer-scope"))tr.push(_r);kt.isHidden(this.transform.zoom)?gr=!1:ve=!0}gr&&pt.push({layer:kt.fqid,cache:Bt,order:It,clipMask:Ht,clipScope:tr})}this.replacementSource.setSources(pt),oe=!0}}this._clippingActiveLastFrame=ve,oe||this.replacementSource.clear(),this.conflationActive=oe,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let dt=0;dt<Y.length;dt++){const Et=Y[dt],Ut=Et.cutoffRange();if(this.longestCutoffRange=Math.max(Ut,this.longestCutoffRange),Ut>0){const pt=Be(Et);pt&&(this.minCutoffZoom=Math.max(pt.minzoom,this.minCutoffZoom)),Et.minzoom&&(this.minCutoffZoom=Math.max(Et.minzoom,this.minCutoffZoom))}Et.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=dt),this._lastOcclusionLayer=dt)}const Xe=this.style&&this.style.fog;Xe?(this._fogVisible=Xe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Xe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(xe),this.opaquePassCutoff=0,D=M(),Y=D.map(dt=>S[dt]));const qe=this._shadowRenderer;if(qe){qe.updateShadowParameters(this.transform,this.style.directionalLight);for(const dt in te)for(const Et of fe[dt]){let Ut={min:0,max:0};this.terrain&&(Ut=this.terrain.getMinMaxForTile(Et)||Ut),qe.addShadowReceiver(Et.toUnwrapped(),Ut.min,Ut.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Ym(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const We=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),$e=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(We&&!this._snow&&(this._snow=new pf(this)),!We&&this._snow&&(this._snow.destroy(),delete this._snow),$e&&!this._rain&&(this._rain=new ih(this)),!$e&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!er.has(this.context.gl))return;this.renderPass="offscreen";for(const dt of Y){const Et=o.getLayerSourceCache(dt);if(!dt.hasOffscreenPass()||dt.isHidden(this.transform.zoom))continue;const Ut=Et?be[Et.id]:void 0;(dt.type==="custom"||dt.type==="raster"||dt.type==="raster-particle"||dt.isSky()||Ut&&Ut.length)&&this.renderLayer(this,Et,dt,Ut)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Ce)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ke=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),it=(()=>{if(d.showOverdrawInspector)return i.aj.black;const dt=this.style.fog;if(dt&&this.transform.projection.supportsFog){const Et=this.style.getLut(dt.scope);if(!Ke){const Ut=dt.properties.get("color-use-theme")==="none",pt=dt.properties.get("color").toRenderColor(Ut?null:Et).toArray01();return new i.aj(...pt)}if(Ke){const Ut=dt.properties.get("space-color-use-theme")==="none",pt=dt.properties.get("space-color").toRenderColor(Ut?null:Et).toArray01();return new i.aj(...pt)}}return i.aj.transparent})();if(this.context.clear({color:it,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ke&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=D.length-1;this.currentLayer>=0;this.currentLayer--){const dt=Y[this.currentLayer],Et=o.getLayerSourceCache(dt);if(dt.isSky())continue;const Ut=Et?(dt.is3D()?Ue:be)[Et.id]:void 0;this._renderTileClippingMasks(dt,Et,Ut),this.renderLayer(this,Et,dt,Ut)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ke&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<D.length;this.currentLayer++){const dt=Y[this.currentLayer],Et=o.getLayerSourceCache(dt);dt.isSky()&&this.renderLayer(this,Et,dt,Et?be[Et.id]:void 0)}function _t(dt,Et){let Ut;return Et&&(Ut=(dt.type==="symbol"?xe:dt.is3D()?Ue:be)[Et.id]),Ut}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<D.length;){const dt=Y[this.currentLayer];if(dt.type==="raster"||dt.type==="raster-particle"){const Et=o.getLayerSourceCache(dt);this.renderLayer(this,Et,dt,_t(dt,Et))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let mt=0;qe&&(mt=qe.getShadowCastingLayerCount());let Mt=!1,jt=-1;for(let dt=0;dt<D.length;++dt){const Et=Y[dt];Et.isHidden(this.transform.zoom)||Et.is3D()&&(jt=dt)}for(K&&jt===-1&&(G=!0);this.currentLayer<D.length;){const dt=Y[this.currentLayer],Et=o.getLayerSourceCache(dt);if(dt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(dt)){if(dt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(G&&!Mt&&this.terrain&&!this.transform.isOrthographic&&(Mt=!0,this.blitDepth()),K&&jt!==-1&&this.currentLayer===jt+1&&!this.transform.isOrthographic&&this.blitDepth(),dt.is3D()||this.terrain||this._renderTileClippingMasks(dt,Et,Et?fe[Et.id]:void 0),this.renderLayer(this,Et,dt,_t(dt,Et)),!this.terrain&&qe&&mt>0&&dt.hasShadowPass()&&--mt==0&&(qe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ut=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ut;this.currentLayer++){const pt=Y[this.currentLayer];if(!pt.hasLightBeamPass())continue;const Dt=o.getLayerSourceCache(pt);this.renderLayer(this,Dt,pt,Dt?be[Dt.id]:void 0)}this.currentLayer=Ut,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ut=this.currentLayer;this.depthOcclusion=!0;for(const pt of this.layersWithOcclusionOpacity){this.currentLayer=pt;const Dt=Y[this.currentLayer],kt=o.getLayerSourceCache(Dt),Yt=kt?be[kt.id]:void 0;Dt.is3D()||this.terrain||this._renderTileClippingMasks(Dt,kt,kt?fe[kt.id]:void 0),this.renderLayer(this,kt,Dt,Yt)}this.depthOcclusion=!1,this.currentLayer=Ut,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let dt=null;Y.forEach(Et=>{const Ut=o.getLayerSourceCache(Et);Ut&&!Et.isHidden(this.transform.zoom)&&Ut.getVisibleCoordinates().length&&(!dt||dt.getSource().maxzoom<Ut.getSource().maxzoom)&&(dt=Ut)}),dt&&this.options.showTileBoundaries&&mf.debug(this,dt,dt.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&mf.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(dt){const Et=dt.transform.padding;eh(dt,dt.transform.height-(Et.top||0),3,ru),eh(dt,Et.bottom||0,3,m0),th(dt,Et.left||0,3,Hm),th(dt,dt.transform.width-(Et.right||0),3,Oy);const Ut=dt.transform.centerPoint;(function(pt,Dt,kt,Yt){ml(pt,Dt-1,kt-10,2,20,Yt),ml(pt,Dt-10,kt-1,20,2,Yt)})(dt,Ut.x,dt.transform.height-Ut.y,Qu)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),oe||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:d}=this.transform.projection,y=!d||!d.includes(o.type);if(ah[o.type]&&(y||this.terrain&&o.type==="custom")){const S=this.style.getLayerSourceCache(o);ah[o.type](o,S,this)}this.gpuTimingEnd()}renderLayer(o,d,y,S){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||S&&S.length)&&(this.id=y.id,this.gpuTimingStart(y),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(y.type)&&(!o.terrain||y.type!=="custom")||y.type==="clip"||mf[y.type](o,d,y,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,y=this.context.gl;let S=this.gpuTimers[o.id];S||(S=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:y.createQuery()}),S.calls++,y.beginQuery(d.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,d=this.context.gl,y=d.createQuery();this.deferredRenderGpuTimeQueries.push(y),d.beginQuery(o.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const d={};for(const y in o){const S=o[y],P=this.context.extTimerQuery,M=P.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;P.deleteQueryEXT(S.query),d[y]=M}return d}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.gl;let y=0;for(const S of o)y+=d.getQueryParameter(S,d.QUERY_RESULT)/1e6,d.deleteQuery(S);return y}translatePosMatrix(o,d,y,S,P){if(!y[0]&&!y[1])return o;const M=P?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(M){const K=Math.sin(M),Y=Math.cos(M);y=[y[0]*Y-y[1]*K,y[0]*K+y[1]*Y]}const D=[P?y[0]:i.ar(d,y[0],this.transform.zoom),P?y[1]:i.ar(d,y[1],this.transform.zoom),0],G=new Float32Array(16);return i.ab.mat4.translate(G,o,D),G}saveTileTexture(o){const d=o.size[0],y=this._tileTextures[d];y?y.push(o):this._tileTextures[d]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,d,y){const S=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,P=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(P.push("LIGHTING_3D_MODE"),P.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||P.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||P.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(P.push("TERRAIN"),this.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&P.push("GLOBE"),!this._fogVisible||S||d!==void 0&&!d||P.push("FOG","FOG_DITHERING"),S&&P.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&P.push("OVERDRAW_INSPECTOR"),P}getOrCreateProgram(o,d){this.cache=this.cache||{};const y=d&&d.defines||[],S=d&&d.config,P=this.currentGlobalDefines(o,d&&d.overrideFog,d&&d.overrideRtt).concat(y),M=Py.cacheKey(Fd[o],o,P,S);return this.cache[M]||(this.cache[M]=new Py(this.context,o,Fd[o],S,Wm[o],P)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,d){if(this.style.enable3dLights()){const y=this.style.directionalLight,S=this.style.ambientLight;if(y&&S){const P=((M,D,G)=>{const K=M.properties.get("direction"),Y=M.properties.get("color-use-theme")==="none",te=M.properties.get("color").toRenderColor(Y?null:G.getLut(M.scope)).toArray01(),re=M.properties.get("intensity"),oe=D.properties.get("color-use-theme")==="none",ve=D.properties.get("color").toRenderColor(oe?null:G.getLut(D.scope)).toArray01(),fe=D.properties.get("intensity"),be=[K.x,K.y,K.z],xe=i.cM(ve,fe),Ce=i.cM(te,re);return{u_lighting_ambient_color:xe,u_lighting_directional_dir:be,u_lighting_directional_color:Ce,u_ground_radiance:$o(be,Ce,xe)}})(y,S,this.style);d.setLightsUniformValues(o,P)}}}uploadCommonUniforms(o,d,y,S,P){if(this.uploadCommonLightUniforms(o,d),this.terrain&&this.terrain.renderingToTexture)return;const M=this.style.fog;if(M){const D=M.getOpacity(this.transform.pitch),G=((K,Y,te,re,oe,ve,fe,be,xe,Ce,Ue,Be)=>{const Xe=K.transform,qe=Y.properties.get("color-use-theme")==="none",We=Y.properties.get("color").toRenderColor(qe?null:K.style.getLut(Y.scope)).toArray01();We[3]=re;const $e=K.frameCounter/1e3%1,[Ke,it]=Y.properties.get("vertical-range");return{u_fog_matrix:te?Xe.calculateFogTileMatrix(te):Be||K.identityMat,u_fog_range:Y.getFovAdjustedRange(Xe._fov),u_fog_color:We,u_fog_horizon_blend:Y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ke,it),it],u_fog_temporal_offset:$e,u_frustum_tl:oe,u_frustum_tr:ve,u_frustum_br:fe,u_frustum_bl:be,u_globe_pos:xe,u_globe_radius:Ce,u_viewport:Ue,u_globe_transition:i.ae(Xe.zoom),u_is_globe:+(Xe.projection.name==="globe")}})(this,M,y,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],S);d.setFogUniformValues(o,G)}P&&d.setCutoffUniformValues(o,P.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,d=o.createTexture();return o.bindTexture(o.TEXTURE_2D,d),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,d=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const S of y)d[S.key]=o[S.key]||new dc(S,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,d){return!(!o.is3D()||o.type!=="clip"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building")&&(!d||d.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[o.key];return d||(this._cachedTileFogOpacities[o.key]=d=this.style.fog.getOpacityForTile(o)),d[0]>=Ye||d[1]>=Ye}setupDepthForOcclusion(o,d,y){const S=this.context,P=S.gl,M=!!y;var D;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(P.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((D=this.depthRangeFor3D)[1]-D[0]),-1-2*D[0]/(D[1]-D[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),S.activeTexture.set(P.TEXTURE0),M||d.setTerrainUniformValues(S,y)}}function Lp(g,o){let d=!1,y=null;const S=()=>{y=null,d&&(g(),y=setTimeout(S,o),d=!1)};return()=>(d=!0,y||S(),y)}class Ny{constructor(o){this._hashName=o&&encodeURIComponent(o),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Lp(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const d=rg(o);if(this._hashName){const y=this._hashName;let S=!1;const P=location.hash.slice(1).split("&").map(M=>{const D=M.split("=")[0];return D===y?(S=!0,`${D}=${d}`):M}).filter(M=>M);return S||P.push(`${y}=${d}`),`#${P.join("&")}`}return`#${d}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(d=y)}),(d&&d[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(d[3]||0):o.getBearing();return o.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function rg(g,o){const d=g.getCenter(),y=Math.round(100*g.getZoom())/100,S=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,S),M=Math.round(d.lng*P)/P,D=Math.round(d.lat*P)/P,G=g.getBearing(),K=g.getPitch();let Y=o?`/${M}/${D}/${y}`:`${y}/${D}/${M}`;return(G||K)&&(Y+="/"+Math.round(10*G)/10),K&&(Y+=`/${Math.round(K)}`),Y}const sh={linearity:.3,easing:i.dy(0,0,.3,1)},Ry=i.l({deceleration:2500,maxSpeed:1400},sh),Iy=i.l({deceleration:20,maxSpeed:1400},sh),Dy=i.l({deceleration:1e3,maxSpeed:360},sh),g0=i.l({deceleration:1e3,maxSpeed:90},sh);class Ly{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=i.q.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)d.zoom+=P.zoomDelta||0,d.bearing+=P.bearingDelta||0,d.pitch+=P.pitchDelta||0,P.panDelta&&d.pan._add(P.panDelta),P.around&&(d.around=P.around),P.pinchAround&&(d.pinchAround=P.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(d.pan.mag()){const P=Fp(d.pan.mag(),y,i.l({},Ry,o||{}));S.offset=d.pan.mult(P.amount/d.pan.mag()),S.center=this._map.transform.center,zp(S,P)}if(d.zoom){const P=Fp(d.zoom,y,Iy);S.zoom=this._map.transform.zoom+P.amount,zp(S,P)}if(d.bearing){const P=Fp(d.bearing,y,Dy);S.bearing=this._map.transform.bearing+i.aw(P.amount,-179,179),zp(S,P)}if(d.pitch){const P=Fp(d.pitch,y,g0);S.pitch=this._map.transform.pitch+P.amount,zp(S,P)}if(S.zoom||S.bearing){const P=d.pinchAround===void 0?d.around:d.pinchAround;S.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function zp(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function Fp(g,o,d){const{maxSpeed:y,linearity:S,deceleration:P}=d,M=i.aw(g*S/(o/1e3),-y,y),D=Math.abs(M)/(P*S);return{easing:d.easing,duration:1e3*D,amount:M*(D/2)}}class To extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y,S={}){const P=ge(d.getCanvasContainer(),y),M=d.unproject(P);super(o,i.l({point:P,lngLat:M,originalEvent:y},S)),this._defaultPrevented=!1,this.target=d}}class gf extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y){const S=o==="touchend"?y.changedTouches:y.touches,P=Te(d.getCanvasContainer(),S),M=P.map(G=>d.unproject(G)),D=P.reduce((G,K,Y,te)=>G.add(K.div(te.length)),new i.P(0,0));super(o,{points:P,point:D,lngLats:M,lngLat:d.unproject(D),originalEvent:y}),this._defaultPrevented=!1}}class zy extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d){super("wheel",{originalEvent:d}),this._defaultPrevented=!1}}class ng{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new zy(this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new To(o.type,this._map,o))}mouseup(o){this._map.fire(new To(o.type,this._map,o))}preclick(o){const d=i.l({},o);d.type="preclick",this._map.fire(new To(d.type,this._map,d))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(o),this._map.fire(new To(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new To(o.type,this._map,o))}mouseover(o){this._map.fire(new To(o.type,this._map,o))}mouseout(o){this._map.fire(new To(o.type,this._map,o))}touchstart(o){return this._firePreventable(new gf(o.type,this._map,o))}touchmove(o){this._map.fire(new gf(o.type,this._map,o))}touchend(o){this._map.fire(new gf(o.type,this._map,o))}touchcancel(o){this._map.fire(new gf(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class q_{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new To(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new To("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new To(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ya{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(ae(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const y=d,S=this._startPos,P=this._lastPos;if(!S||!P||P.equals(y)||!this._box&&y.dist(S)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=B("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const M=Math.min(S.x,y.x),D=Math.max(S.x,y.x),G=Math.min(S.y,y.y),K=Math.max(S.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${G}px)`,this._box.style.width=D-M+"px",this._box.style.height=K-G+"px")})}mouseupWindow(o,d){if(!this._active)return;const y=this._startPos,S=d;if(y&&o.button===0){if(this.reset(),ce(),y.x!==S.x||y.y!==S.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:o})),{cameraAnimation:P=>P.fitScreenCoordinates(y,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ee(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new i.z(o,{originalEvent:d}))}}function ig(g,o){const d={};for(let y=0;y<g.length;y++)d[g[y].identifier]=o[y];return d}class Jl{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),y.length===this.numTouches&&(this.centroid=function(S){const P=new i.P(0,0);for(const M of S)P._add(M);return P.div(S.length)}(d),this.touches=ig(y,d)))}touchmove(o,d,y){if(this.aborted||!this.centroid)return;const S=ig(y,d);for(const P in this.touches){const M=S[P];(!M||M.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(o,d,y){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Bp{constructor(o){this.singleTap=new Jl(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,d,y){this.singleTap.touchstart(o,d,y)}touchmove(o,d,y){this.singleTap.touchmove(o,d,y)}touchend(o,d,y){const S=this.singleTap.touchend(o,d,y);if(S){const P=o.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(S)<30;if(P&&M||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class rd{constructor(){this._zoomIn=new Bp({numTouches:1,numTaps:2}),this._zoomOut=new Bp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,y){this._zoomIn.touchstart(o,d,y),this._zoomOut.touchstart(o,d,y)}touchmove(o,d,y){this._zoomIn.touchmove(o,d,y),this._zoomOut.touchmove(o,d,y)}touchend(o,d,y){const S=this._zoomIn.touchend(o,d,y),P=this._zoomOut.touchend(o,d,y);return S?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(S)},{originalEvent:o})}):P?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(P)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Fy={0:1,2:2};class yf{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,d){return!1}_move(o,d){return{}}mousedown(o,d){if(this._lastPoint)return;const y=Ae(o);this._correctButton(o,y)&&(this._lastPoint=d,this._eventButton=y)}mousemoveWindow(o,d){const y=this._lastPoint;if(y){if(o.preventDefault(),this._eventButton!=null&&function(S,P){const M=Fy[P];return S.buttons===void 0||(S.buttons&M)!==M}(o,this._eventButton))this.reset();else if(this._moved||!(d.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(y,d)}}mouseupWindow(o){this._lastPoint&&Ae(o)===this._eventButton&&(this._moved&&ce(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vp extends yf{mousedown(o,d){super.mousedown(o,d),this._lastPoint&&(this._active=!0)}_correctButton(o,d){return d===0&&!o.ctrlKey}_move(o,d){return{around:d,panDelta:d.sub(o)}}}class Nl extends yf{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const y=.8*(d.x-o.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(o){o.preventDefault()}}class Tc extends yf{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const y=-.5*(d.y-o.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(o){o.preventDefault()}}class da{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(o,d,y){return this._calculateTransform(o,d,y)}touchmove(o,d,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,d,y)}}touchend(o,d,y){this._calculateTransform(o,d,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,y){y.length>0&&(this._active=!0);const S=ig(y,d),P=new i.P(0,0),M=new i.P(0,0);let D=0;for(const K in S){const Y=S[K],te=this._touches[K];te&&(P._add(Y),M._add(Y.sub(te)),D++,S[K]=Y)}if(this._touches=S,D<this._minTouches||!M.mag())return;const G=M.div(D);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(D),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Ho{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,d,y){return{}}touchstart(o,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,y){const S=this._firstTwoTouches;if(!S)return;o.preventDefault();const[P,M]=S,D=vf(y,d,P),G=vf(y,d,M);if(!D||!G)return;const K=this._aroundCenter?null:D.add(G).div(2);return this._move([D,G],K,o)}touchend(o,d,y){if(!this._firstTwoTouches)return;const[S,P]=this._firstTwoTouches,M=vf(y,d,S),D=vf(y,d,P);M&&D||(this._active&&ce(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function vf(g,o,d){for(let y=0;y<g.length;y++)if(g[y].identifier===d)return o[y]}function xf(g,o){return Math.log(g/o)/Math.LN2}class By extends Ho{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(xf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:xf(this._distance,y),pinchAround:d}}}function Vy(g,o){return 180*g.angleWith(o)/Math.PI}class _f extends Ho{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const y=this._vector;if(this._vector=o[0].sub(o[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Vy(this._vector,y),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const S=Vy(o,y);return Math.abs(S)<d}}function ag(g){return Math.abs(g.y)>Math.abs(g.x)}class G_ extends Ho{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,ag(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,y){const S=this._lastPoints;if(!S)return;const P=o[0].sub(S[0]),M=o[1].sub(S[1]);return this._map._cooperativeGestures&&!i.dz()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(P,M,y.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(P.y+M.y)/2*-.5})}gestureBeginsVertically(o,d,y){if(this._valid!==void 0)return this._valid;const S=o.mag()>=2,P=d.mag()>=2;if(!S&&!P)return;if(!S||!P)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const M=o.y>0==d.y>0;return ag(o)&&ag(d)&&M}}const lo={panStep:100,bearingStep:15,pitchStep:10};class Hs{constructor(){const o=lo;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,y=0,S=0,P=0,M=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?y=-1:(o.preventDefault(),P=-1);break;case 39:o.shiftKey?y=1:(o.preventDefault(),P=1);break;case 38:o.shiftKey?S=1:(o.preventDefault(),M=-1);break;case 40:o.shiftKey?S=-1:(o.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(y=0,S=0),{cameraAnimation:D=>{const G=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:nd,zoom:d?Math.round(G)+d*(o.shiftKey?2:1):G,bearing:D.getBearing()+y*this._bearingStep,pitch:D.getPitch()+S*this._pitchStep,offset:[-P*this._panStep,-M*this._panStep],center:D.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function nd(g){return g*(2-g)}const id=4.000244140625,Pc=1/450;class Rl{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Pc,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const y=i.q.now(),S=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,d!==0&&d%id==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=d,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(S*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=ge(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const K=this._type==="wheel"&&Math.abs(this._delta)>id?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*K)));this._delta<0&&Y!==0&&(Y=1/Y);const te=d(),re=Math.pow(2,te),oe=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):re;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(oe*Y))),this._type==="wheel"&&(this._startZoom=te,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:d(),S=this._startZoom,P=this._easing;let M,D=!1;if(this._type==="wheel"&&S&&P){const K=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),Y=P(K);M=i.af(S,y,Y),K<1?this._frameId||(this._frameId=!0):D=!0}else M=y,D=!0;this._active=!0,D&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let G=M-d();return G*this._lastDelta<0&&(G=0),{noInertia:!0,needsRenderFrame:!D,zoomDelta:G,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=i.dA;if(this._prevEase){const y=this._prevEase,S=(i.q.now()-y.start)/y.duration,P=y.easing(S+.01)-y.easing(S),M=.27/Math.sqrt(P*P+1e-4)*.01,D=Math.sqrt(.0729-M*M);d=i.dy(M,D,.25,1)}return this._prevEase={start:i.q.now(),duration:o,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=B("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class au{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class su{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,d){return o.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(o.shiftKey?-1:1),around:y.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ou{constructor(){this._tap=new Bp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,d,y){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=d[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(o,d,y))}touchmove(o,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const S=d[0],P=S.y-this._swipePoint.y;return this._swipePoint=S,o.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(o,d,y)}touchend(o,d,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(o,d,y)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uy{constructor(o,d,y){this._el=o,this._mousePan=d,this._touchPan=y}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class y0{constructor(o,d,y){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class v0{constructor(o,d,y,S){this._el=o,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const bf=g=>g.zoom||g.drag||g.pitch||g.rotate;class sg extends i.z{}class Ks{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,d){const y=i.ab.vec3.sub([],d,o);this.radius=i.ab.vec3.length(y[2]<0?i.ab.vec3.div([],y,this.constants):[y[0],y[1],0])}projectRay(o){i.ab.vec3.div(o,o,this.constants),i.ab.vec3.normalize(o,o),i.ab.vec3.mul(o,o,this.constants);const d=i.ab.vec3.scale([],o,this.radius);if(d[2]>0){const y=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(d,[0,0,1])),S=i.ab.vec3.scale([],i.ab.vec3.normalize([],[d[0],d[1],0]),this.radius),P=i.ab.vec3.add([],d,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],S,y),d),2));d[0]=P[0],d[1]=P[1]}return d}}function ad(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Up{constructor(o,d){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ly(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ks,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),i.aP(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,P,M]of this._listeners){const D=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(P,D,M)}}destroy(){for(const[o,d,y]of this._listeners){const S=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(d,S,y)}}_addDefaultHandlers(o){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new ng(d,o));const S=d.boxZoom=new ya(d,o);this._add("boxZoom",S);const P=new rd,M=new su;d.doubleClickZoom=new au(M,P),this._add("tapZoom",P),this._add("clickZoom",M);const D=new ou;this._add("tapDragZoom",D);const G=d.touchPitch=new G_(d);this._add("touchPitch",G);const K=new Nl(o),Y=new Tc(o);d.dragRotate=new y0(o,K,Y),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const te=new Vp(o),re=new da(d,o);d.dragPan=new Uy(y,te,re),this._add("mousePan",te),this._add("touchPan",re,["touchZoom","touchRotate"]);const oe=new _f,ve=new By;d.touchZoomRotate=new v0(y,ve,oe,D),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new q_(d));const fe=d.scrollZoom=new Rl(d,this);this._add("scrollZoom",fe,["mousePan"]);const be=d.keyboard=new Hs;this._add("keyboard",be);for(const xe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[xe]&&d[xe].enable(o[xe])}_add(o,d,y){this._handlers.push({handlerName:o,handler:d,allowed:y}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!bf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,d,y){for(const S in o)if(S!==y&&(!d||d.indexOf(S)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const d=[];for(const y of o)this._el.contains(y.target)&&d.push(y);return d}handleEvent(o,d){this._updatingCamera=!0;const y=o.type==="renderFrame",S=y?void 0:o,P={needsRenderFrame:!1},M={},D={},G=o.touches?this._getMapTouches(o.touches):void 0,K=G?Te(this._el,G):y?void 0:ge(this._el,o);for(const{handlerName:re,handler:oe,allowed:ve}of this._handlers){if(!oe.isEnabled())continue;let fe;this._blockedByActive(D,ve,re)?oe.reset():oe[d||o.type]&&(fe=oe[d||o.type](o,K,G),this.mergeHandlerResult(P,M,fe,re,S),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||oe.isActive())&&(D[re]=oe)}const Y={};for(const re in this._previousActiveHandlers)D[re]||(Y[re]=S);this._previousActiveHandlers=D,(Object.keys(Y).length||ad(P))&&(this._changes.push([P,M,Y]),this._triggerRenderFrame()),(Object.keys(D).length||ad(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=P;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))}mergeHandlerResult(o,d,y,S,P){if(!y)return;i.l(o,y);const M={handlerName:S,originalEvent:y.originalEvent||P};y.zoomDelta!==void 0&&(d.zoom=M),y.panDelta!==void 0&&(d.drag=M),y.pitchDelta!==void 0&&(d.pitch=M),y.bearingDelta!==void 0&&(d.rotate=M)}_applyChanges(){const o={},d={},y={};for(const[S,P,M]of this._changes)S.panDelta&&(o.panDelta=(o.panDelta||new i.P(0,0))._add(S.panDelta)),S.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(o.around=S.around),S.aroundCoord!==void 0&&(o.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(o.pinchAround=S.pinchAround),S.noInertia&&(o.noInertia=S.noInertia),i.l(d,P),i.l(y,M);this._updateMapTransform(o,d,y),this._changes=[]}_updateMapTransform(o,d,y){const S=this._map,P=S.transform,M=Ce=>[Ce.x,Ce.y,Ce.z];if((Ce=>{const Ue=this._eventsInProgress.drag;return Ue&&!this._handlersById[Ue.handlerName].isActive()})()&&!ad(o)){const Ce=P.zoom;P.cameraElevationReference="sea",this._originalZoom!=null&&P._orthographicProjectionAtLowPitch&&P.projection.name!=="globe"&&P.pitch===0?(P.cameraElevationReference="ground",P.zoom=this._originalZoom):(P.recenterOnTerrain(),P.cameraElevationReference="ground"),Ce!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&S._stop(!0),!ad(o))return void this._fireEvents(d,y,!0);let{panDelta:D,zoomDelta:G,bearingDelta:K,pitchDelta:Y,around:te,aroundCoord:re,pinchAround:oe}=o;P._isCameraConstrained&&(G>0&&(G=0),P._isCameraConstrained=!1),oe!==void 0&&(te=oe),(G||(Ce=>d[Ce]&&!this._eventsInProgress[Ce])("drag"))&&te&&(this._dragOrigin=M(P.pointCoordinate3D(te)),this._originalZoom=P.zoom,this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",S._stop(!0),te=te||S.transform.centerPoint,K&&(P.bearing+=K),Y&&(P.pitch+=Y),P._updateCameraState();const ve=[0,0,0];if(D)if(P.projection.name==="mercator"){const Ce=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(te).dir),Ue=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(te.sub(D)).dir);ve[0]=Ue[0]-Ce[0],ve[1]=Ue[1]-Ce[1]}else{const Ce=P.pointCoordinate(te);if(P.projection.name==="globe"){D=D.rotate(-P.angle);const Ue=P._pixelsPerMercatorPixel/P.worldSize;ve[0]=-D.x*i.dB(i.aS(Ce.y))*Ue,ve[1]=-D.y*i.dB(P.center.lat)*Ue}else{const Ue=P.pointCoordinate(te.sub(D));Ce&&Ue&&(ve[0]=Ue.x-Ce.x,ve[1]=Ue.y-Ce.y)}}const fe=P.zoom,be=[0,0,0];if(G){const Ce=M(re||P.pointCoordinate3D(te)),Ue={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Ce,P._camera.position))};if(Ue.dir[2]<0){const Be=P.zoomDeltaToMovement(Ce,G);i.ab.vec3.scale(be,Ue.dir,Be)}}const xe=i.ab.vec3.add(ve,ve,be);P._translateCameraConstrained(xe),G&&Math.abs(P.zoom-fe)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,y,!0)}_fireEvents(o,d,y){const S=bf(this._eventsInProgress),P=bf(o),M={};for(const Y in o){const{originalEvent:te}=o[Y];this._eventsInProgress[Y]||(M[`${Y}start`]=te),this._eventsInProgress[Y]=o[Y]}!S&&P&&this._fireEvent("movestart",P.originalEvent);for(const Y in M)this._fireEvent(Y,M[Y]);P&&this._fireEvent("move",P.originalEvent);for(const Y in o){const{originalEvent:te}=o[Y];this._fireEvent(Y,te)}const D={};let G;for(const Y in this._eventsInProgress){const{handlerName:te,originalEvent:re}=this._eventsInProgress[Y];this._handlersById[te].isActive()||(delete this._eventsInProgress[Y],G=d[te]||re,D[`${Y}end`]=G)}for(const Y in D)this._fireEvent(Y,D[Y]);const K=bf(this._eventsInProgress);if(y&&(S||P)&&!K){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),te=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;Y?(te(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:G})):(this._map.fire(new i.z("moveend",{originalEvent:G})),te(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new i.z(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new sg("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const x0="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class oh extends i.E{constructor(o,d){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,y){return o=i.P.convert(o).mult(-1),this.panTo(this.transform.center,i.l({offset:o},d),y)}panTo(o,d,y){return this.easeTo(i.l({center:o},d),y)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,y){return this.easeTo(i.l({zoom:o},d),y)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,y){return this.easeTo(i.l({bearing:o},d),y)}resetNorth(o,d){return this.rotateTo(0,i.l({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=i.az.convert(o);const y=d&&d.bearing||0,S=d&&d.pitch||0,P=o.getNorthWest(),M=o.getSouthEast();return this._cameraForBounds(this.transform,P,M,y,S,d)}_extendPadding(o){const d={top:0,right:0,bottom:0,left:0};return o==null?i.l({},d,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:i.l({},d,o)}_extendCameraOptions(o){return(o=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,d){const y=d.max[0]-d.min[0],S=d.max[1]-d.min[1];return y/S>o.aspect?y/(2*Math.tan(.5*o.fovX)*o.aspect):S/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,d,y,S,P,M){const D=o.clone(),G=this._extendCameraOptions(M);D.bearing=S,D.pitch=P;const K=i.bO.convert(d),Y=i.bO.convert(y),te=.5*(K.lat+Y.lat),re=.5*(K.lng+Y.lng),oe=i.dC(te,re),ve=i.ab.vec3.normalize([],oe),fe=i.ab.vec3.normalize([],i.ab.vec3.cross([],ve,[0,1,0])),be=i.ab.vec3.cross([],fe,ve),xe=[fe[0],fe[1],fe[2],0,be[0],be[1],be[2],0,ve[0],ve[1],ve[2],0,0,0,0,1],Ce=[oe,i.dC(K.lat,K.lng),i.dC(Y.lat,K.lng),i.dC(Y.lat,Y.lng),i.dC(K.lat,Y.lng),i.dC(te,K.lng),i.dC(te,Y.lng),i.dC(K.lat,re),i.dC(Y.lat,re)];let Ue=i.cd.fromPoints(Ce.map(kt=>[i.ab.vec3.dot(fe,kt),i.ab.vec3.dot(be,kt),i.ab.vec3.dot(ve,kt)]));const Be=i.ab.vec3.transformMat4([],Ue.center,xe);i.ab.vec3.squaredLength(Be)===0&&i.ab.vec3.set(Be,0,0,1),i.ab.vec3.normalize(Be,Be),i.ab.vec3.scale(Be,Be,i.ax),D.center=i.dD(Be);const Xe=D.getWorldToCameraMatrix(),qe=i.ab.mat4.invert(new Float64Array(16),Xe);Ue=i.cd.applyTransform(Ue,i.ab.mat4.multiply([],Xe,xe));const We=this._extendAABB(Ue,D,G,S);if(!We)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ue=We,i.ab.vec3.transformMat4(Be,Be,Xe);const $e=.5*(Ue.max[2]-Ue.min[2]),Ke=this._minimumAABBFrustumDistance(D,Ue),it=i.ab.vec3.scale([],[0,0,1],$e),_t=i.ab.vec3.add(it,Be,it),mt=Ke+(D.pitch===0?0:i.ab.vec3.distance(Be,_t)),Mt=D.globeCenterInViewSpace,jt=i.ab.vec3.sub([],Be,[Mt[0],Mt[1],Mt[2]]);i.ab.vec3.normalize(jt,jt),i.ab.vec3.scale(jt,jt,mt);const dt=i.ab.vec3.add([],Be,jt);i.ab.vec3.transformMat4(dt,dt,qe);const Et=i.ds/i.ax,Ut=i.ab.vec3.length(dt),pt=i.bH(Math.max(Ut*Et-i.ds,Number.EPSILON),0),Dt=Math.min(D.zoomFromMercatorZAdjusted(pt),G.maxZoom);return Dt>.5*(i.c6+i.bY)?(D.setProjection({name:"mercator"}),D.zoom=Dt,this._cameraForBounds(D,d,y,S,P,M)):{center:D.center,zoom:Dt,bearing:S,pitch:P}}_extendAABB(o,d,y,S){const P=.5*((y.padding.left||0)+(y.padding.right||0)),M=.5*((y.padding.top||0)+(y.padding.bottom||0)),D=M,G=P,K=P,Y=M,te=d.width-(G+K),re=d.height-(D+Y),oe=i.ab.vec3.sub([],o.max,o.min),ve=Math.min(te/oe[0],re/oe[1]),fe=Math.min(d.scaleZoom(d.scale*ve),y.maxZoom);if(isNaN(fe))return null;const be=d.scale/d.zoomScale(fe),xe=new i.cd([o.min[0]-G*be,o.min[1]-Y*be,o.min[2]],[o.max[0]+K*be,o.max[1]+D*be,o.max[2]]),Ce=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new i.P(y.offset.x,y.offset.y):i.P.convert(y.offset)).rotate(-i.ai(S));return xe.center[0]-=Ce.x*be,xe.center[1]+=Ce.y*be,xe}queryTerrainElevation(o,d){const y=this.transform.elevation;return y?(d=i.l({},{exaggerated:!0},d),y.getAtPoint(i.aa.fromLngLat(o),null,d.exaggerated)):null}_cameraForBounds(o,d,y,S,P,M){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,d,y,S,P,M);const D=o.clone(),G=this._extendCameraOptions(M);D.bearing=S,D.pitch=P;const K=i.bO.convert(d),Y=i.bO.convert(y),te=new i.bO(K.lng,Y.lat),re=new i.bO(Y.lng,K.lat),oe=D.project(K),ve=D.project(Y),fe=this.queryTerrainElevation(K),be=this.queryTerrainElevation(Y),xe=this.queryTerrainElevation(te),Ce=this.queryTerrainElevation(re),Ue=[[oe.x,oe.y,Math.min(fe||0,be||0,xe||0,Ce||0)],[ve.x,ve.y,Math.max(fe||0,be||0,xe||0,Ce||0)]];let Be=i.cd.fromPoints(Ue);const Xe=D.getWorldToCameraMatrix(),qe=i.ab.mat4.invert(new Float64Array(16),Xe);Be=i.cd.applyTransform(Be,Xe);const We=this._extendAABB(Be,D,G,S);if(!We)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Be=We;const $e=.5*i.ab.vec3.sub([],Be.max,Be.min)[2],Ke=this._minimumAABBFrustumDistance(D,Be),it=[0,0,1,0];i.ab.vec4.transformMat4(it,it,Xe),i.ab.vec4.normalize(it,it);const _t=i.ab.vec3.scale([],it,Ke+$e),mt=i.ab.vec3.add([],Be.center,_t);i.ab.vec3.transformMat4(Be.center,Be.center,qe),i.ab.vec3.transformMat4(mt,mt,qe);const Mt=D.unproject(new i.P(Be.center[0],Be.center[1])),jt=i.dE(D.projection,Mt),dt=Math.pow(2,jt),Et=Math.min(D._zoomFromMercatorZ(mt[2]*D.pixelsPerMeter*dt/D.worldSize),G.maxZoom);return D.mercatorFromTransition&&Et<.5*(i.c6+i.bY)?(D.setProjection({name:"globe"}),D.zoom=Et,this._cameraForBounds(D,d,y,S,P,M)):{center:Mt,zoom:Et,bearing:S,pitch:P}}fitBounds(o,d,y){const S=this.cameraForBounds(o,d);return this._fitInternal(S,d,y)}fitScreenCoordinates(o,d,y,S,P){const M=i.P.convert(o),D=i.P.convert(d),G=new i.P(Math.min(M.x,D.x),Math.min(M.y,D.y)),K=new i.P(Math.max(M.x,D.x),Math.max(M.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(M,D))return this;const Y=this.transform.pointLocation3D(G),te=this.transform.pointLocation3D(K),re=this.transform.pointLocation3D(new i.P(G.x,K.y)),oe=this.transform.pointLocation3D(new i.P(K.x,G.y)),ve=[Math.min(Y.lng,te.lng,re.lng,oe.lng),Math.min(Y.lat,te.lat,re.lat,oe.lat)],fe=[Math.max(Y.lng,te.lng,re.lng,oe.lng),Math.max(Y.lat,te.lat,re.lat,oe.lat)],be=S&&S.pitch?S.pitch:this.getPitch(),xe=this._cameraForBounds(this.transform,ve,fe,y,be,S);return this._fitInternal(xe,S,P)}_fitInternal(o,d,y){return o?(d=i.l(o,d)).linear?this.easeTo(d,y):this.flyTo(d,y):this}jumpTo(o,d){this.stop();const y=o.preloadOnly?this.transform.clone():this.transform;let S=!1,P=!1,M=!1;"zoom"in o&&y.zoom!==+o.zoom&&(S=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=i.bO.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(P=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(M=!0,y.pitch=+o.pitch);const D=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!y.isPaddingEqual(D))if(o.retainPadding===!1){const G=y.clone();G.padding=D,y.setLocationAtPoint(y.center,G.centerPoint)}else y.padding=D;return o.preloadOnly?(this._preloadTiles(y),this):(this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),S&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),P&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),M&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(x0),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,d){const y=this.transform;if(!y.projection.supportsFreeCamera)return i.w(x0),this;this.stop();const S=y.zoom,P=y.pitch,M=y.bearing;y.setFreeCameraOptions(o);const D=S!==y.zoom,G=P!==y.pitch,K=M!==y.bearing;return this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),D&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),K&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),G&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)),this}easeTo(o,d){this._stop(!1,o.easeId),((o=i.l({offset:[0,0],duration:500,easing:i.dA},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const y=this.transform,S=this.getZoom(),P=this.getBearing(),M=this.getPitch(),D=this.getPadding(),G="zoom"in o?+o.zoom:S,K="bearing"in o?this._normalizeBearing(o.bearing,P):P,Y="pitch"in o?+o.pitch:M,te=this._extendPadding(o.padding),re=i.P.convert(o.offset);let oe,ve,fe;if(y.projection.name==="globe"){const it=i.aa.fromLngLat(y.center),_t=re.rotate(-y.angle);it.x+=_t.x/y.worldSize,it.y+=_t.y/y.worldSize;const mt=it.toLngLat(),Mt=i.bO.convert(o.center||mt);this._normalizeCenter(Mt),oe=y.centerPoint.add(_t),ve=new i.P(it.x,it.y).mult(y.worldSize),fe=new i.P(i.at(Mt.lng),i.aA(Mt.lat)).mult(y.worldSize).sub(ve)}else{oe=y.centerPoint.add(re);const it=y.pointLocation(oe),_t=i.bO.convert(o.center||it);this._normalizeCenter(_t),ve=y.project(it),fe=y.project(_t).sub(ve)}const be=y.zoomScale(G-S);let xe,Ce;o.around&&(xe=i.bO.convert(o.around),Ce=y.locationPoint(xe));const Ue=this._zooming||G!==S,Be=this._rotating||P!==K,Xe=this._pitching||Y!==M,qe=!y.isPaddingEqual(te),We=o.retainPadding===!1?y.clone():y,$e=it=>_t=>{if(Ue&&(it.zoom=i.af(S,G,_t)),Be&&(it.bearing=i.af(P,K,_t)),Xe&&(it.pitch=i.af(M,Y,_t)),qe&&(We.interpolatePadding(D,te,_t),oe=We.centerPoint.add(re)),xe)it.setLocationAtPoint(xe,Ce);else{const mt=it.zoomScale(it.zoom-S),Mt=G>S?Math.min(2,be):Math.max(.5,be),jt=Math.pow(Mt,1-_t),dt=it.unproject(ve.add(fe.mult(_t*jt)).mult(mt));it.setLocationAtPoint(it.renderWorldCopies?dt.wrap():dt,oe)}return o.preloadOnly||this._fireMoveEvents(d),it};if(o.preloadOnly){const it=this._emulate($e,o.duration,y);return this._preloadTiles(it),this}const Ke={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ue,this._rotating=Be,this._pitching=Xe,this._padding=qe,this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,Ke),this._ease($e(y),it=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(d,it)},o),this}_prepareEase(o,d,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||y.moving||this.fire(new i.z("movestart",o)),this._zooming&&!y.zooming&&this.fire(new i.z("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new i.z("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new i.z("pitchstart",o))}_fireMoveEvents(o){this.fire(new i.z("move",o)),this._zooming&&this.fire(new i.z("zoom",o)),this._rotating&&this.fire(new i.z("rotate",o)),this._pitching&&this.fire(new i.z("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,S=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new i.z("zoomend",o)),S&&this.fire(new i.z("rotateend",o)),P&&this.fire(new i.z("pitchend",o)),this.fire(new i.z("moveend",o))}flyTo(o,d){if(this._prefersReducedMotion(o)){const kt=i.ay(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(kt,d)}this.stop(),o=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},o);const y=this.transform,S=this.getZoom(),P=this.getBearing(),M=this.getPitch(),D=this.getPadding(),G="zoom"in o?i.aw(+o.zoom,y.minZoom,y.maxZoom):S,K="bearing"in o?this._normalizeBearing(o.bearing,P):P,Y="pitch"in o?+o.pitch:M,te=this._extendPadding(o.padding),re=y.zoomScale(G-S),oe=i.P.convert(o.offset);let ve=y.centerPoint.add(oe);const fe=y.pointLocation(ve),be=i.bO.convert(o.center||fe);this._normalizeCenter(be);const xe=y.project(fe),Ce=y.project(be).sub(xe);let Ue=o.curve;const Be=Math.max(y.width,y.height),Xe=Be/re,qe=Ce.mag();if("minZoom"in o){const kt=i.aw(Math.min(o.minZoom,S,G),y.minZoom,y.maxZoom),Yt=Be/y.zoomScale(kt-S);Ue=Math.sqrt(Yt/qe*2)}const We=Ue*Ue;function $e(kt){const Yt=(Xe*Xe-Be*Be+(kt?-1:1)*We*We*qe*qe)/(2*(kt?Xe:Be)*We*qe);return Math.log(Math.sqrt(Yt*Yt+1)-Yt)}function Ke(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function it(kt){return(Math.exp(kt)+Math.exp(-kt))/2}const _t=$e(0);let mt=function(kt){return it(_t)/it(_t+Ue*kt)},Mt=function(kt){return Be*((it(_t)*(Ke(Yt=_t+Ue*kt)/it(Yt))-Ke(_t))/We)/qe;var Yt},jt=($e(1)-_t)/Ue;if(Math.abs(qe)<1e-6||!isFinite(jt)){if(Math.abs(Be-Xe)<1e-6)return this.easeTo(o,d);const kt=Xe<Be?-1:1;jt=Math.abs(Math.log(Xe/Be))/Ue,Mt=function(){return 0},mt=function(Yt){return Math.exp(kt*Ue*Yt)}}o.duration="duration"in o?+o.duration:1e3*jt/("screenSpeed"in o?+o.screenSpeed/Ue:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const dt=P!==K,Et=Y!==M,Ut=!y.isPaddingEqual(te),pt=o.retainPadding===!1?y.clone():y,Dt=kt=>Yt=>{const Bt=Yt*jt,It=1/mt(Bt);kt.zoom=Yt===1?G:S+kt.scaleZoom(It),dt&&(kt.bearing=i.af(P,K,Yt)),Et&&(kt.pitch=i.af(M,Y,Yt)),Ut&&(pt.interpolatePadding(D,te,Yt),ve=pt.centerPoint.add(oe));const Ht=Yt===1?be:kt.unproject(xe.add(Ce.mult(Mt(Bt))).mult(It));return kt.setLocationAtPoint(kt.renderWorldCopies?Ht.wrap():Ht,ve),kt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(d),kt};if(o.preloadOnly){const kt=this._emulate(Dt,o.duration,y);return this._preloadTiles(kt),this}return this._zooming=!0,this._rotating=dt,this._pitching=Et,this._padding=Ut,this._prepareEase(d,!1),this._ease(Dt(y),()=>this._afterEase(d),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,d)}if(!o){const y=this.handlers;y&&y.stop(!1)}return this}_ease(o,d,y){y.animate===!1||y.duration===0?(o(1),d()):(this._easeStart=i.q.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,d){o=i.bF(o,-180,180);const y=Math.abs(o-d);return Math.abs(o-360-d)<y&&(o-=360),Math.abs(o+360-d)<y&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const y=o.lng-d.center.lng;o.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,d,y){const S=Math.ceil(15*d/1e3),P=[],M=o(y.clone());for(let D=0;D<=S;D++){const G=M(D/S);P.push(G.clone())}return P}_preloadTiles(o,d){}}class wf{constructor(o={}){this.options=o,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const d=this.options&&this.options.compact,y=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=B("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const S=B("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",y),this._innerContainer=B("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(o){const y=d.reduce((S,P,M)=>(P.value&&(S+=`${P.key}=${P.value}${M<d.length-1?"&":""}`),S),"?");o.href=`${i.e.FEEDBACK_URL}/${y}#${rg(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const d=this._map.style._mergedSourceCaches;for(const S in d){const P=d[S];if(P.used){const M=P.getSource();M.attribution&&o.indexOf(M.attribution)<0&&o.push(M.attribution)}}o.sort((S,P)=>S.length-P.length),o=o.filter((S,P)=>{for(let M=P+1;M<o.length;M++)if(o[M].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const y=o.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,o.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ko{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=B("div","mapboxgl-ctrl");const d=B("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const d in o){const y=o[d].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class co{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const S of y)if(S.id===o)return void(S.cancelled=!0)}run(o=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Zo{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const d=i.cB((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,d,y){this._start=this.getValue(d),this._end=o,this._startTime=d,this._endTime=d+y}}const lh={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class sd extends i.z{constructor(o,d,y,S){const{point:P,lngLat:M,originalEvent:D,target:G}=o;super(o.type,{point:P,lngLat:M,originalEvent:D,target:G}),this.preventDefault=()=>{o.preventDefault()},this.id=d,this.interaction=y,this.feature=S}}class $p{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,d){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const y=d.filter;let S=d.type;y&&this.filters.set(o,i.aZ(y)),S==="mouseover"&&(S="mouseenter"),S==="mouseout"&&(S="mouseleave");const P=this.interactionsByType.get(S)||new Map;S==="mouseenter"||S==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,d)):P.size===0&&this.map.on(S,this.handleType),P.size===0&&this.interactionsByType.set(S,P),P.set(o,d),this.typeById.set(o,S)}get(o){const d=this.typeById.get(o);if(!d)return;const y=this.interactionsByType.get(d);return y?y.get(o):void 0}remove(o){const d=this.typeById.get(o);if(!d)return;this.typeById.delete(o),this.filters.delete(o);const y=this.interactionsByType.get(d);y&&(y.delete(o),d==="mouseenter"||d==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(d,this.handleType))}queryTargets(o,d){const y=[];for(const[S,P]of d)P.target&&y.push({targetId:S,target:P.target,filter:this.filters.get(S)});return this.map.style.queryRenderedTargets(o,y,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const d=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());d.length&&(o.type="mouseenter",this.handleType(o,d));const y=new Map;for(const[S,{feature:P}]of this.prevHoveredFeatures)this.hoveredFeatures.has(S)||y.set(P.id,P);y.size&&(o.type="mouseleave",this.handleType(o,Array.from(y.values())))}handleOut(o){const d=Array.from(this.hoveredFeatures.values()).map(({feature:y})=>y);d.length&&(o.type="mouseleave",this.handleType(o,d)),this.hoveredFeatures.clear()}handleType(o,d){const y=Array.from(this.interactionsByType.get(o.type)).reverse(),S=!!d;d=d||this.queryTargets(o.point,y);const P=o.type==="mouseenter";let M=!1;const D=new Set;for(const G of d){for(const[K,Y]of y){if(!Y.target)continue;const te=G.variants?G.variants[K]:null;if(te){for(const re of te){if(wl(re,G,D,K))continue;const oe=new i.cw(G,re),ve=Ou(re,G,K);S&&(oe.state=this.map.getFeatureState(oe));const fe=P?this.prevHoveredFeatures.get(ve):null,be=new sd(o,K,Y,oe),xe=fe?fe.stop:Y.handler(be);if(P&&this.hoveredFeatures.set(ve,{feature:G,stop:xe}),xe!==!1){M=!0;break}}if(M)break}}if(M)break}if(!M)for(const[G,K]of y){const{handler:Y,target:te}=K;if(!te&&Y(new sd(o,G,K,null))!==!1)break}}}function Kn(g,o){if(Array.isArray(g)&&Array.isArray(o)){const d=new Set(g),y=new Set(o);return d.size===y.size&&g.every(S=>y.has(S))}return i.bn(g,o)}const lu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},qp={showCompass:!0,showZoom:!0,visualizePitch:!1};class uo{constructor(o,d,y=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new Nl({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,y&&(this.mousePitch=new Tc({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(o,d){this.mouseRotate.mousedown(o,d),this.mousePitch&&this.mousePitch.mousedown(o,d),ae()}move(o,d){const y=this.map,S=this.mouseRotate.mousemoveWindow(o,d),P=S&&S.bearingDelta;if(P&&y.setBearing(y.getBearing()+P),this.mousePitch){const M=this.mousePitch.mousemoveWindow(o,d),D=M&&M.pitchDelta;D&&y.setPitch(y.getPitch()+D)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ee(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(i.l({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),ge(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,ge(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Te(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=Te(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function og(g,o,d){if(g=new i.bO(g.lng,g.lat),o){const y=new i.bO(g.lng-360,g.lat),S=new i.bO(g.lng+360,g.lat),P=360*Math.ceil(Math.abs(g.lng-d.center.lng)/360),M=d.locationPoint(g).distSqr(o),D=o.x<0||o.y<0||o.x>d.width||o.y>d.height;d.locationPoint(y).distSqr(o)<M&&(D||Math.abs(y.lng-d.center.lng)<P)?g=y:d.locationPoint(S).distSqr(o)<M&&(D||Math.abs(S.lng-d.center.lng)<P)&&(g=S)}for(;Math.abs(g.lng-d.center.lng)>180;){const y=d.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=d.width&&y.y<=d.height)break;g.lng>d.center.lng?g.lng-=360:g.lng+=360}return g}const Cc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Yo extends i.E{constructor(o,d){if(super(),(o instanceof HTMLElement||d)&&(o=i.l({element:o},d)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=i.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=B("div");const P=41,M=27,D=q("svg",{display:"block",height:P*this._scale+"px",width:M*this._scale+"px",viewBox:`0 0 ${M} ${P}`},this._element),G=q("radialGradient",{id:"shadowGradient"},q("defs",{},D));q("stop",{offset:"10%","stop-opacity":.4},G),q("stop",{offset:"100%","stop-opacity":.05},G),q("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),q("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),q("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),q("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=i.P.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",P=>{P.preventDefault()}),this._element.addEventListener("mousedown",P=>{P.preventDefault()});const y=this._element.classList;for(const P in Cc)y.remove(`mapboxgl-marker-anchor-${P}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const S=o&&o.className?o.className.trim().split(/\s+/):[];y.add(...S),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=i.bO.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const d=o.code,y=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(o){const d=o.originalEvent.target,y=this._element;this._popup&&(d===y||y.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,d=this._pos;if(!o||!d)return!1;const y=o.unproject(d),S=o.getFreeCameraOptions();if(!S.position)return!1;const P=S.position.toLngLat();return P.distanceTo(y)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const d=this._pos;if(!d||d.x<0||d.x>o.transform.width||d.y<0||d.y>o.transform.height)return void this._clearFadeTimer();const y=o.unproject(d);let S;o._showingGlobe()&&i.dH(o.transform,this._lngLat)?S=0:(S=1-o._queryFogOpacity(y),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Cc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const o=this._pos,d=this._map,y=this.getPitchAlignment();if(!d||!o||y!=="map")return"";if(!d._showingGlobe()){const G=d.getPitch();return G?`rotateX(${G}deg)`:""}const S=i.c4(i.dI(d.transform,this._lngLat)),P=o.sub(i.dJ(d.transform)),M=Math.abs(P.x)+Math.abs(P.y);if(M===0)return"";const D=S/M;return`rotateX(${-P.y*D}deg) rotateY(${P.x*D}deg)`}_calculateZTransform(){const o=this._pos,d=this._map;if(!d||!o)return"";let y=0;const S=this.getRotationAlignment();if(S==="map")if(d._showingGlobe()){const P=d.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),M=d.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);y=i.c4(Math.atan2(M.y,M.x))-90}else y=-d.getBearing();else if(S==="horizon"){const P=i.ac(4,6,d.getZoom()),M=i.dJ(d.transform);M.y+=P*d.transform.height;const D=o.sub(M),G=i.c4(Math.atan2(D.y,D.x));y=(G>90?G-270:G+90)*(1-P)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=og(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=i.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const d=this._map;if(!d)return;const y=this._pointerdownPos,S=this._positionDelta;if(y&&S){if(!this._isDragging){const P=this._clickTolerance||d._clickTolerance;if(o.point.dist(y)<P)return;this._isDragging=!0}this._pos=o.point.sub(S),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(o){const d=this._map,y=this._pos;d&&y&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(y),this._pointerdownPos=o.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const d=this._map;return d&&(o?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const qi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Xo={maxWidth:100,unit:"metric"},Fr={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ch={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Zs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lg(g=new i.P(0,0),o="bottom"){if(typeof g=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new i.P(0,g);case"top-left":return new i.P(d,d);case"top-right":return new i.P(-d,d);case"bottom":return new i.P(0,-g);case"bottom-left":return new i.P(d,-d);case"bottom-right":return new i.P(-d,-d);case"left":return new i.P(g,0);case"right":return new i.P(-g,0)}return new i.P(0,0)}return g instanceof i.P||Array.isArray(g)?i.P.convert(g):i.P.convert(g[o]||[0,0])}return{version:_,supported:U.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends oh{constructor(g){A.mark(w.create);const o=g;if((g=i.l({},lu,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&i.dF(window)&&(g.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Xh(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new co,this._domRenderTaskQueue=new co,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},lh,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Zo(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new Qe(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const d=document.getElementById(g.container);if(!d)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=d}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Jm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Up(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||i.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new _y(this),g.hash&&(this._hash=new Ny(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const d=g.bounds;d&&(this.resize(),this.fitBounds(d,i.l({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new wf({customAttribution:g.customAttribution})),this._logoControl=new Ko,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new i.z(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new i.z(`${d.dataType}dataloading`,d))}),this._interactions=new $p(this)}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[o];return o.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new i.z("movestart",g)).fire(new i.z("move",g)),this.fire(new i.z("resize",g)),o&&this.fire(new i.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(i.az.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(o=>o.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(o=>o==="auto"?navigator.language:o):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let d;o==="globe"&&g.zoom>=i.bY?(g.setMercatorFromTransition(),d=!0):o==="mercator"&&g.zoom<i.bY&&(g.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;return o=g.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g){return this.transform.locationPoint3D(i.bO.convert(g))}unproject(g){return this.transform.pointLocation3D(i.P.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,d){const y=S=>{let P=[];if(Array.isArray(o)){const M=o.filter(D=>this.getLayer(D));P=M.length?this.queryRenderedFeatures(S,{layers:M}):[]}else P=this.queryRenderedFeatures(S,{target:o});return P};if(g==="mouseenter"||g==="mouseover"){let S=!1;return{listener:d,targets:o,delegates:{mousemove:M=>{const D=y(M.point);D.length?S||(S=!0,d.call(this,new To(g,this,M.originalEvent,{features:D}))):S=!1},mouseout:()=>{S=!1}}}}if(g==="mouseleave"||g==="mouseout"){let S=!1;return{listener:d,targets:o,delegates:{mousemove:D=>{y(D.point).length?S=!0:S&&(S=!1,d.call(this,new To(g,this,D.originalEvent)))},mouseout:D=>{S&&(S=!1,d.call(this,new To(g,this,D.originalEvent)))}}}}{const S=P=>{const M=y(P.point);M.length&&(P.features=M,d.call(this,P),delete P.features)};return{listener:d,targets:o,delegates:{[g]:S}}}}on(g,o,d){if(typeof o=="function"||d===void 0)return super.on(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(g,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const S in y.delegates)this.on(S,y.delegates[S]);return this}once(g,o,d){if(typeof o=="function"||d===void 0)return super.once(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(g,o,d);for(const S in y.delegates)this.once(S,y.delegates[S]);return this}off(g,o,d){if(typeof o=="function"||d===void 0)return super.off(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._delegatedListeners?this._delegatedListeners[g]:void 0;return y&&(S=>{for(let P=0;P<S.length;P++){const M=S[P];if(M.listener===d&&Kn(M.targets,o)){for(const D in M.delegates)this.off(D,M.delegates[D]);return S.splice(P,1),this}}})(y),this}queryRenderedFeatures(g,o){if(!this.style)return[];if(g===void 0||g instanceof i.P||Array.isArray(g)||o!==void 0||(o=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!o){const P=this.style.queryRenderedFeatures(g,void 0,this.transform),M=this.style.queryRenderedFeatureset(g,void 0,this.transform);return P.concat(M)}let d=!0;if(o.target&&(d=this._isTargetValid(o.target),d&&!o.layers))return this.style.queryRenderedFeatureset(g,o,this.transform);let y=!0;if(o.layers&&Array.isArray(o.layers)){for(const P of o.layers)if(!this._isValidId(P)){y=!1;break}if(y&&!o.target)return this.style.queryRenderedFeatures(g,o,this.transform)}let S=[];return y&&(S=S.concat(this.style.queryRenderedFeatures(g,o,this.transform))),d&&(S=S.concat(this.style.queryRenderedFeatureset(g,o,this.transform))),S}querySourceFeatures(g,o){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,o)}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&i.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(g))}addInteraction(g,o){return this._interactions.add(g,o),this}removeInteraction(g){return this._interactions.remove(g),this}setStyle(g,o){return o=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&g&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(g,(d,y)=>{d?(i.w(`Unable to perform style diff: ${String(d.message||d.error||d)}. Rebuilding the style from scratch.`),this._updateStyle(g,o)):y&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const d=i.l({},o);o&&o.config&&(d.initialConfig=o.config,delete d.config),this.style=new Vo(this,d).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Vo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(g)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const o of g)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(g)}addSource(g,o){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,o,d){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,d)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,o,{pixelRatio:d=1,sdf:y=!1,stretchX:S,stretchY:P,content:M}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:D,height:G,data:K}=i.q.getImageData(o);this.style.addImage(g,{data:new i.r({width:D,height:G},K),pixelRatio:d,stretchX:S,stretchY:P,content:M,sdf:y,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:G}=o,K=o;this.style.addImage(g,{data:new i.r({width:D,height:G},new Uint8Array(K.data)),pixelRatio:d,stretchX:S,stretchY:P,content:M,sdf:y,usvg:!1,version:0,userImage:K}),K.onAdd&&K.onAdd(this,g)}}updateImage(g,o){this._lazyInitEmptyStyle();const d=this.style.getImage(g);if(!d)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?i.q.getImageData(o):o,{width:S,height:P,data:M}=y;if(S===void 0||P===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(d.usvg?d.icon.usvg_tree.width:d.data.width)||P!==(d.usvg?d.icon.usvg_tree.height:d.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${S}, ${P})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`)));const D=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let G=!1;d.usvg?(d.data=new i.r({width:S,height:P},new Uint8Array(M)),d.usvg=!1,d.icon=void 0,G=!0):d.data.replace(M,D),this.style.updateImage(g,d,G)}hasImage(g){return g?!!this.style&&!!this.style.getImage(g):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,o){i.o(this._requestManager.transformRequest(g,i.R.Image),(d,y)=>{o(d,y instanceof HTMLImageElement?i.q.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(g,o){this._lazyInitEmptyStyle(),this.style.addModel(g,o)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,o){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)):this}getSlot(g){const o=this.getLayer(g);return o&&o.slot||null}setSlot(g,o){return this.style.setSlot(g,o),this.style.mergeLayers(),this._update(!0)}addImport(g,o){return this.style.addImport(g,o),this}updateImport(g,o){return typeof o!="string"&&o.id!==g?(this.removeImport(g),this.addImport(o)):(this.style.updateImport(g,o),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,o){return this.style.moveImport(g,o),this._update(!0)}moveLayer(g,o){return this._isValidId(g)?(this.style.moveLayer(g,o),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const o=this.style.getOwnLayer(g);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,o,d){return this._isValidId(g)?(this.style.setLayerZoomRange(g,o,d),this._update(!0)):this}setFilter(g,o,d={}){return this._isValidId(g)?(this.style.setFilter(g,o,d),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,o,d,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,o,d,y),this._update(!0)):this}getPaintProperty(g,o){return this._isValidId(g)?this.style.getPaintProperty(g,o):null}setLayoutProperty(g,o,d,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,o,d,y),this._update(!0)):this}getLayoutProperty(g,o){return this._isValidId(g)?this.style.getLayoutProperty(g,o):null}getSchema(g){return this.style.getSchema(g)}setSchema(g,o){return this.style.setSchema(g,o),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,o){return this.style.setConfig(g,o),this._update(!0)}getConfigProperty(g,o){return this.style.getConfigProperty(g,o)}setConfigProperty(g,o,d){return this.style.setConfigProperty(g,o,d),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const o=g[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,o),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(g),this.transform):0}setFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,o),this._update())}removeFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,o),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let d,y,S,P=this._container;for(;P&&(!y||!S);){const M=window.getComputedStyle(P).transform;M&&M!=="none"&&(d=M.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(y=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(S=d[3])),P=P.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=S?Math.abs(o/S):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=B("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=B("div","mapboxgl-canvas-container",g);this._canvas=B("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=B("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(S=>{y[S]=B("div",`mapboxgl-ctrl-${S}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const d=i.q.devicePixelRatio||1;this._canvas.width=d*Math.ceil(g),this._canvas.height=d*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=i.l({},U.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",g);o?(Lt(o,!0),this.painter=new tg(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(o)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;this.fire(new i.z("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,y=i.q.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=S.createQuery(),S.beginQuery(d.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const P=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const K=this.transform.zoom,Y=this.transform.pitch,te=i.q.now(),re=new i.a8(K,{now:te,fadeDuration:P,pitch:Y,transition:this.style.transition});this.style.update(re)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let M=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),M=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):M=this._updateAverageElevation(y);const D=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),D&&(this._placementDirty=D.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,A.mark(w.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const K=i.q.now()-y;S.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const Y=S.getQueryParameter(o,S.QUERY_RESULT)/1e6;S.deleteQuery(o),this.fire(new i.z("gpu-timing-frame",{cpuTime:K,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const K=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(K);this.fire(new i.z("gpu-timing-layer",{layerTimes:Y}))},50)}if(this.listens("gpu-timing-deferred-render")){const K=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Y=this.painter.queryGpuTimeDeferredRender(K);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:Y}))},50)}const G=this._sourcesDirty||this._styleDirty||this._placementDirty||M;if(G||this._repaint)this.triggerRepaint();else{const K=this.idle();if(K&&(M=this._updateAverageElevation(y,!0)),M)this.triggerRepaint();else if(this._triggerFrame(!1),K&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,A.mark(w.fullLoad),this._performanceMetricsCollection&&nr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const d=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const S=this.transform.averageElevation;let P=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(P)?P=0:this._averageElevationLastSampledAt=g;const M=Math.abs(S-P);if(M>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(P),d(P);this._averageElevation.easeTo(P,g,300)}else if(M>1e-4)return this._averageElevation.jumpTo(P),d(P)}return!!this._averageElevation.isEasing(g)&&d(this._averageElevation.getValue(g))}_authenticate(){De(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===ke||g.status===401)){const o=this.painter.context.gl;Lt(o,!1),this._logoControl instanceof Ko&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Qt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&vr(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const d=this.painter.context.gl,y=d.createFramebuffer();function S(P){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,P,0);const M=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,M),M}return d.bindFramebuffer(d.FRAMEBUFFER,y),this._canvasPixelComparison(S(g),o.canvasCopies.map(S),o.timeStamps)}_canvasPixelComparison(g,o,d){let y=d[1]-d[0];const S=g.length/4;for(let P=0;P<o.length;P++){const M=o[P];let D=0;for(let G=0;G<M.length;G+=4)M[G]===g[G]&&M[G+1]===g[G+1]&&M[G+2]===g[G+2]&&M[G+3]===g[G+3]&&(D+=1);y+=(d[P+2]-d[P+1])*(1-D/S)}return y}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),er.delete(this.painter.context.gl),Kt.remove(),rt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=i.q.frame(o=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(o)}))}_preloadTiles(g){const o=this.style?this.style.getSourceCaches():[];return i.bl(o,(d,y)=>d._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,o){i.dG(g,o)}get version(){return _}},NavigationControl:class{constructor(g={}){this.options=i.l({},qp,g),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),B("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),B("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:o}):d.resetNorth({},{originalEvent:o}))}),this._compassIcon=B("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),d=o===g.getMaxZoom(),y=o===g.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new uo(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const d=B("button",g,this._container);return d.type="button",d.addEventListener("click",o),d}_setButtonTitle(g,o){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",d),g.firstElementChild&&g.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends i.E{constructor(g={}){super();const o=navigator.geolocation;this.options=i.l({geolocation:o},qi,g),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Lp(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,g(d)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>o(d.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),d=g.coords;return!!o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",g)),this._finish()}}_updateCamera(g){const o=new i.bO(g.coords.longitude,g.coords.latitude),d=g.coords.accuracy,y=this._map.getBearing(),S=i.l({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(d),S,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new i.bO(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=i.bH(1,g._center.lat)*g.worldSize,d=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=B("button","mapboxgl-ctrl-geolocate",this._container),B("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=B("div","mapboxgl-user-location"),this._dotElement.appendChild(B("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(B("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Yo({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=B("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:wf,ScaleControl:class{constructor(g={}){this.options=i.l({},Xo,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,d=o._containerHeight/2,y=o._containerWidth/2-g/2,S=o.unproject([y,d]),P=o.unproject([y+g,d]),M=S.distanceTo(P);if(this.options.unit==="imperial"){const D=3.2808*M;D>5280?this._setScale(g,D/5280,"mile"):this._setScale(g,D,"foot")}else this.options.unit==="nautical"?this._setScale(g,M/1852,"nautical-mile"):M>=1e3?this._setScale(g,M/1e3,"kilometer"):this._setScale(g,M,"meter")}_setScale(g,o,d){this._map._requestDomTask(()=>{const y=function(P){const M=Math.pow(10,`${Math.floor(P)}`.length-1);let D=P/M;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(G){const K=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*K)/K}(D),M*D}(o),S=y/o;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(y):`${y}&nbsp;${Fr[d]}`,this._container.style.width=g*S+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=B("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=B("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=B("button","mapboxgl-ctrl-fullscreen",this._controlContainer);B("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(g){super(),this.options=i.l(Object.create(ch),g),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=i.bO.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const o=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=g;y=d.firstChild,y;)o.appendChild(y);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=B("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const d=this._closeButton=B("button","mapboxgl-popup-close-button",o);d.type="button",d.setAttribute("aria-label","Close popup"),d.innerHTML='<span aria-hidden="true">&#215;</span>',d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,d=this._container,y=this._pos;if(!o||!d||!y)return"bottom";const S=d.offsetWidth,P=d.offsetHeight,M=y.x<S/2,D=y.x>o.transform.width-S/2;if(y.y+g<P)return M?"top-left":D?"top-right":"top";if(y.y>o.transform.height-P){if(M)return"bottom-left";if(D)return"bottom-right"}return M?"left":D?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,d=this._content;if(!o||!this._lngLat&&!this._trackPointer||!d)return;let y=this._container;if(y||(y=this._container=B("div","mapboxgl-popup",o.getContainer()),this._tip=B("div","mapboxgl-popup-tip",y),y.appendChild(d)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=og(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const S=this._pos=this._trackPointer&&g instanceof i.P?g:o.project(this._lngLat),P=lg(this.options.offset),M=this._anchor=this._getAnchor(P.y),D=lg(this.options.offset,M),G=S.add(D).round();o._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${Cc[M]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&o._showingGlobe()){const S=i.dH(o.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Zs);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Yo,Style:Vo,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:mp,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(g){i.e.ACCESS_TOKEN=g},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(g){i.e.API_URL=g},get workerCount(){return i.dO.workerCount},set workerCount(g){i.dO.workerCount=g},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){i.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){i.dP(g)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(g){i.dQ.workerUrl=g},get workerClass(){return i.dQ.workerClass},set workerClass(g){i.dQ.workerClass=g},get workerParams(){return i.dQ.workerParams},set workerParams(g){i.dQ.workerParams=g},get dracoUrl(){return i.dR()},set dracoUrl(g){i.dS(g)},get meshoptUrl(){return i.dT()},set meshoptUrl(g){i.dU(g)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var f=a;return f})}(mA)),mA.exports}var pVe=fVe();const KS=oa(pVe),ON={Mati:{lat:6.90543,lng:126.198137},Baganga:{lat:7.138566,lng:126.19839},Banaybanay:{lat:7.052637,lng:126.271871},Caraga:{lat:7.040689,lng:126.405736},Cateel:{lat:7.03907,lng:126.073971},"Governor Generoso":{lat:7.023682,lng:126.135764},Lupon:{lat:6.996579,lng:126.157647},Manay:{lat:6.910817,lng:125.976873},"San Isidro":{lat:7.026718,lng:126.399461},Tarragona:{lat:7.090034,lng:126.217449},Boston:{lat:6.969014,lng:126.235561},Maco:{lat:7.036735,lng:126.414316},Mabini:{lat:7.012285,lng:125.970299},Pantukan:{lat:7.008709,lng:125.964125},Mawab:{lat:7.002258,lng:126.393666},Monkayo:{lat:6.950413,lng:126.203313},"New Bataan":{lat:7.037214,lng:125.949183},Compostela:{lat:7.0845,lng:126.9761},Laak:{lat:6.9046,lng:126.5307},Maragusan:{lat:7.1389,lng:126.2254}};function mVe(e,t="",r=""){if(!e)return null;const n=e.trim().replace(/\s+/g," ");if(ON[n])return ON[n];const a=n.toLowerCase();for(const[l,f]of Object.entries(ON))if(l.toLowerCase().includes(a)||a.includes(l.toLowerCase()))return f;return console.warn(`No coordinates found for municipality: ${e}`),null}const gVe=({analyticsData:e,className:t=""})=>{const[r,n]=H.useState(!1),[a,l]=H.useState("year-over-year"),[f,i]=H.useState(null),[_,w]=H.useState(!1);H.useEffect(()=>{const ae=()=>{const ce=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;n(ce)};ae();const ee=new MutationObserver(ae);ee.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const se=window.matchMedia("(prefers-color-scheme: dark)");return se.addEventListener("change",ae),()=>{ee.disconnect(),se.removeEventListener("change",ae)}},[]),H.useEffect(()=>{if(!e)return;w(!0);const ae=A(e,a);i(ae),w(!1)},[e,a]);const A=(ae,ee)=>{if(!ae||!ae.trends||!ae.trends.monthly)return null;const se=ae.trends.monthly,ce=new Date().getFullYear();switch(ee){case"year-over-year":return E(se,ce);case"quarterly":return O(se);case"monthly-trend":return F(se);case"severity-comparison":return U(ae);default:return null}},E=(ae,ee)=>{const se=ae.filter(Te=>Te._id.year===ee),ce=ae.filter(Te=>Te._id.year===ee-1);return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((Te,Ae)=>{const _e=se.find(ke=>ke._id.month===Ae+1),Ee=ce.find(ke=>ke._id.month===Ae+1);return{month:Te,current:(_e==null?void 0:_e.count)||0,previous:(Ee==null?void 0:Ee.count)||0,change:_e&&Ee?(_e.count-Ee.count)/Ee.count*100:0}})},O=ae=>{const ee=[{name:"Q1",months:[1,2,3]},{name:"Q2",months:[4,5,6]},{name:"Q3",months:[7,8,9]},{name:"Q4",months:[10,11,12]}],se=new Date().getFullYear(),ce=ae.filter(Te=>Te._id.year===se),ge=ae.filter(Te=>Te._id.year===se-1);return ee.map(Te=>{const Ae=ce.filter(Ee=>Te.months.includes(Ee._id.month)).reduce((Ee,ke)=>Ee+ke.count,0),_e=ge.filter(Ee=>Te.months.includes(Ee._id.month)).reduce((Ee,ke)=>Ee+ke.count,0);return{quarter:Te.name,current:Ae,previous:_e,change:_e>0?(Ae-_e)/_e*100:0}})},F=ae=>{const ee=new Date().getFullYear(),se=ae.filter(ce=>ce._id.year===ee);return se.map(ce=>({month:new Date(ce._id.year,ce._id.month-1).toLocaleDateString("en-US",{month:"short"}),accidents:ce.count,cumulative:se.filter(ge=>ge._id.month<=ce._id.month).reduce((ge,Te)=>ge+Te.count,0)}))},U=ae=>{if(!ae.distributions||!ae.distributions.severity)return null;const ee=ae.distributions.severity,se=ee.reduce((ce,ge)=>ce+ge.count,0);return ee.map(ce=>({severity:ce._id.charAt(0).toUpperCase()+ce._id.slice(1),count:ce.count,percentage:(ce.count/se*100).toFixed(1),trend:Math.random()>.5?"up":"down"}))},B=()=>r?["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"]:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],q=()=>{if(!f||_)return u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});switch(a){case"year-over-year":return u.jsx(No,{width:"100%",height:300,children:u.jsxs(YL,{data:f,children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:r?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(ae,ee)=>[ae,ee==="current"?"Current Year":"Previous Year"]}),u.jsx(Uf,{}),u.jsx(xs,{dataKey:"previous",fill:B()[1],fillOpacity:.6,name:"Previous Year"}),u.jsx(xs,{dataKey:"current",fill:B()[0],name:"Current Year"})]})});case"quarterly":return u.jsx(No,{width:"100%",height:300,children:u.jsxs(_d,{data:f,children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"quarter",stroke:r?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:r?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),u.jsx(xs,{dataKey:"current",fill:B()[0],name:"Current Year"}),u.jsx(xs,{dataKey:"previous",fill:B()[1],name:"Previous Year"})]})});case"monthly-trend":return u.jsx(No,{width:"100%",height:300,children:u.jsxs(ZL,{data:f,children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),u.jsx(za,{yAxisId:"left",stroke:r?"#9ca3af":"#6b7280"}),u.jsx(za,{yAxisId:"right",orientation:"right",stroke:r?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),u.jsx(Uf,{}),u.jsx(Qf,{yAxisId:"left",type:"monotone",dataKey:"accidents",stroke:B()[0],strokeWidth:3,name:"Monthly Accidents"}),u.jsx(Qf,{yAxisId:"right",type:"monotone",dataKey:"cumulative",stroke:B()[1],strokeWidth:2,strokeDasharray:"5 5",name:"Cumulative Total"})]})});case"severity-comparison":return u.jsx(No,{width:"100%",height:300,children:u.jsxs(_d,{data:f,children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"severity",stroke:r?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:r?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(ae,ee)=>[ee==="count"?`${ae} accidents`:`${ae}%`,ee==="count"?"Count":"Percentage"]}),u.jsx(xs,{dataKey:"count",fill:B()[2]})]})});default:return null}},W=()=>{switch(a){case"year-over-year":return"Year-over-Year Comparison";case"quarterly":return"Quarterly Analysis";case"monthly-trend":return"Monthly Trend Analysis";case"severity-comparison":return"Severity Distribution Comparison";default:return"Comparison Analysis"}},Z=()=>{switch(a){case"year-over-year":return"Compare current year accident data with previous year";case"quarterly":return"Quarterly breakdown of accident trends";case"monthly-trend":return"Monthly accident patterns with cumulative totals";case"severity-comparison":return"Accident severity distribution analysis";default:return"Comparative analysis of accident data"}},ne=()=>{if(!f||f.length===0)return null;switch(a){case"year-over-year":const ae=f.reduce((ce,ge)=>ce+ge.current,0),ee=f.reduce((ce,ge)=>ce+ge.previous,0),se=ee>0?(ae-ee)/ee*100:0;return u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[u.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Current Year"}),u.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:ae}),u.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Total accidents"})]}),u.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Previous Year"}),u.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:ee}),u.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Total accidents"})]}),u.jsxs("div",{className:`p-3 rounded-lg ${se>=0?"bg-red-50 dark:bg-red-950/20":"bg-green-50 dark:bg-green-950/20"}`,children:[u.jsx("div",{className:`text-sm font-medium ${se>=0?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:"Year-over-Year Change"}),u.jsxs("div",{className:`text-lg font-bold ${se>=0?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:[se>=0?"+":"",se.toFixed(1),"%"]}),u.jsx("div",{className:`text-xs ${se>=0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:se>=0?"Increase":"Decrease"})]})]});default:return null}};return u.jsxs(wi,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[u.jsx(Ii,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(j3,{className:"h-5 w-5 text-purple-500"}),W()]}),u.jsx(ls,{children:Z()})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs(Io,{value:a,onValueChange:l,children:[u.jsx(mo,{className:"w-[180px]",children:u.jsx(Do,{})}),u.jsxs(go,{children:[u.jsx(_n,{value:"year-over-year",children:"Year-over-Year"}),u.jsx(_n,{value:"quarterly",children:"Quarterly"}),u.jsx(_n,{value:"monthly-trend",children:"Monthly Trend"}),u.jsx(_n,{value:"severity-comparison",children:"Severity Comparison"})]})]})})]})}),u.jsxs(Ei,{children:[q(),ne()]})]})},yVe=({accidents:e,className:t=""})=>{const r=H.useRef(null),n=H.useRef(null),[a,l]=H.useState(!1),[f,i]=H.useState(!1),[_,w]=H.useState(!1),[A,E]=H.useState(!0),[O,F]=H.useState(!1),[U,B]=H.useState("all"),[q,W]=H.useState("streets"),[Z,ne]=H.useState(!1);H.useEffect(()=>{const _e=()=>{const Qe=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;w(Qe)};_e();const Ee=new MutationObserver(_e);Ee.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const ke=window.matchMedia("(prefers-color-scheme: dark)");return ke.addEventListener("change",_e),()=>{Ee.disconnect(),ke.removeEventListener("change",_e)}},[]);const ae=_e=>{const Ee={streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-v9",outdoors:"mapbox://styles/mapbox/outdoors-v12",light:"mapbox://styles/mapbox/light-v11",dark:"mapbox://styles/mapbox/dark-v11"};return Ee[_e]||Ee.streets};H.useEffect(()=>{if(!e||e.length===0)return;const _e="pk.eyJ1IjoiY2xhcmVuY2VqYXBpbmFuIiwiYSI6ImNtOGk1NGh3bjA5bWwya3B0a2lzMGk0eDkifQ.Px83G0Hg6bYtv9E9teOTpQ";if(KS.accessToken=_e,!n.current)try{n.current=new KS.Map({container:r.current,style:ae(q),center:[125.971907,6.90543],zoom:9}),n.current.addControl(new KS.NavigationControl,"top-right"),n.current.on("load",()=>{l(!0),ee()}),n.current.on("error",Ee=>{console.error("Map error:",Ee),i(!0)})}catch(Ee){console.error("Map initialization error:",Ee),i(!0);return}return()=>{n.current&&(n.current.remove(),n.current=null)}},[e]),H.useEffect(()=>{if(n.current&&a&&!Z){ne(!0);try{n.current.setStyle(ae(q)),n.current.once("styledata",()=>{ee(),ne(!1)}),setTimeout(()=>{ne(!1)},3e3)}catch(_e){console.error("Style change error:",_e),i(!0),ne(!1)}}},[q,a]),H.useEffect(()=>{a&&n.current&&ee()},[a,A,O,U]);const ee=()=>{if(!n.current||!a)return;const _e=se();n.current.getLayer("clusters")&&n.current.removeLayer("clusters"),n.current.getLayer("cluster-count")&&n.current.removeLayer("cluster-count"),n.current.getLayer("unclustered-point")&&n.current.removeLayer("unclustered-point"),n.current.getLayer("heatmap")&&n.current.removeLayer("heatmap"),n.current.getSource("accidents")&&n.current.removeSource("accidents"),n.current.addSource("accidents",{type:"geojson",data:_e,cluster:A,clusterMaxZoom:14,clusterRadius:50}),A&&(n.current.addLayer({id:"clusters",type:"circle",source:"accidents",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",10,"#f1f075",30,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,10,20,30,25]}}),n.current.addLayer({id:"cluster-count",type:"symbol",source:"accidents",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}})),n.current.addLayer({id:"unclustered-point",type:"circle",source:"accidents",filter:["!",["has","point_count"]],paint:{"circle-color":["case",["==",["get","severity"],"fatal"],"#dc2626",["==",["get","severity"],"severe"],"#ea580c",["==",["get","severity"],"moderate"],"#f59e0b",["==",["get","severity"],"minor"],"#16a34a","#6b7280"],"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),O&&n.current.addLayer({id:"heatmap",type:"heatmap",source:"accidents",maxzoom:15,paint:{"heatmap-weight":["interpolate",["linear"],["case",["==",["get","severity"],"fatal"],4,["==",["get","severity"],"severe"],3,["==",["get","severity"],"moderate"],2,["==",["get","severity"],"minor"],1,0],0,0,1,1,2,2,3,3,4,4],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,15,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,15,20],"heatmap-opacity":["interpolate",["linear"],["zoom"],7,1,15,0]}}),n.current.on("click","clusters",Ee=>{const ke=n.current.queryRenderedFeatures(Ee.point,{layers:["clusters"]}),Qe=ke[0].properties.cluster_id;n.current.getSource("accidents").getClusterExpansionZoom(Qe,(Ze,Ge)=>{Ze||n.current.easeTo({center:ke[0].geometry.coordinates,zoom:Ge})})}),n.current.on("click","unclustered-point",Ee=>{const ke=Ee.features[0].geometry.coordinates.slice(),Qe=Ee.features[0].properties;new KS.Popup().setLngLat(ke).setHTML(ce(Qe)).addTo(n.current)}),n.current.on("mouseenter","clusters",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","clusters",()=>{n.current.getCanvas().style.cursor=""}),n.current.on("mouseenter","unclustered-point",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","unclustered-point",()=>{n.current.getCanvas().style.cursor=""})},se=()=>({type:"FeatureCollection",features:e.filter(Ee=>!(U!=="all"&&Ee.severity!==U)).map(Ee=>{let ke=null;if(Ee.municipality){const Qe=mVe(Ee.municipality,Ee.barangay,Ee.street);Qe&&(ke=[Qe.lng,Qe.lat])}return ke?{type:"Feature",properties:{id:Ee.accident_id,severity:Ee.severity||"unknown",plateNo:Ee.plateNo,vehicle_type:Ee.vehicle_type,municipality:Ee.municipality,barangay:Ee.barangay,street:Ee.street,accident_date:Ee.accident_date,notes:Ee.notes},geometry:{type:"Point",coordinates:ke}}:null}).filter(Ee=>Ee!==null)}),ce=_e=>`
      <div style="padding: 12px; min-width: 220px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
        <h3 style="margin: 0 0 10px 0; font-size: 16px; font-weight: bold; color: #1f2937; border-bottom: 1px solid #e5e7eb; padding-bottom: 6px;">
          ${_e.id||"Accident ID: N/A"}
        </h3>
        <div style="font-size: 13px; line-height: 1.5; color: #374151;">
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Plate:</strong> ${_e.plateNo||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Severity:</strong> 
            <span style="color: ${ge(_e.severity)}; font-weight: bold; text-transform: uppercase;">
              ${_e.severity||"Unknown"}
            </span>
          </p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Vehicle:</strong> ${_e.vehicle_type||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Location:</strong> ${_e.municipality||"N/A"}, ${_e.barangay||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Street:</strong> ${_e.street||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Date:</strong> ${_e.accident_date?new Date(_e.accident_date).toLocaleDateString():"N/A"}</p>
          ${_e.notes?`<p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Notes:</strong> ${_e.notes}</p>`:""}
        </div>
      </div>
    `,ge=_e=>{switch(_e){case"fatal":return"#dc2626";case"severe":return"#ea580c";case"moderate":return"#f59e0b";case"minor":return"#16a34a";default:return"#6b7280"}},Te=()=>{n.current&&n.current.flyTo({center:[125.971907,6.90543],zoom:9,duration:1e3})},Ae=()=>{const _e=["streets","satellite","outdoors","light","dark"],ke=(_e.indexOf(q)+1)%_e.length;i(!1),W(_e[ke])};return f?u.jsxs(wi,{className:t,children:[u.jsx(Ii,{children:u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(mv,{className:"h-5 w-5 text-red-500"}),"Map Error"]})}),u.jsx(Ei,{children:u.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:u.jsxs("div",{className:"text-center text-gray-500",children:[u.jsx("div",{className:"text-lg font-medium",children:"Map unavailable"}),u.jsx("div",{className:"text-sm mb-4",children:"Unable to load map. This might be due to:"}),u.jsxs("ul",{className:"text-xs text-left space-y-1 mb-4",children:[u.jsx("li",{children:" Internet connection issues"}),u.jsx("li",{children:" Mapbox token configuration"}),u.jsx("li",{children:" Style loading problems"})]}),u.jsx("button",{onClick:()=>{i(!1),l(!1),n.current&&(n.current.remove(),n.current=null)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"Retry"})]})})})]}):!e||e.length===0?u.jsxs(wi,{className:t,children:[u.jsx(Ii,{children:u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wx,{className:"h-5 w-5 text-blue-500"}),"Accident Map"]})}),u.jsx(Ei,{children:u.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:u.jsxs("div",{className:"text-center text-gray-500",children:[u.jsx("div",{className:"text-lg font-medium",children:"No location data available"}),u.jsx("div",{className:"text-sm",children:"Accidents in this period don't have coordinate information"})]})})})]}):u.jsxs(wi,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[u.jsx(Ii,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wx,{className:"h-5 w-5 text-blue-500"}),"Accident Map"]}),u.jsx(ls,{children:"Interactive map with clustering, heat layers, and advanced filtering"})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs(eo,{variant:"outline",className:"text-xs",children:[e.length," Accidents"]})})]})}),u.jsx(Ei,{children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-muted/30 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs(Xr,{variant:A?"default":"outline",size:"sm",onClick:()=>E(!A),className:"flex items-center gap-1",children:[u.jsx(IW,{className:"h-4 w-4"}),"Clusters"]}),u.jsxs(Xr,{variant:O?"default":"outline",size:"sm",onClick:()=>F(!O),className:"flex items-center gap-1",children:[u.jsx(uB,{className:"h-4 w-4"}),"Heatmap"]})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("select",{value:U,onChange:_e=>B(_e.target.value),className:"px-2 py-1 text-sm border rounded-md bg-background",children:[u.jsx("option",{value:"all",children:"All Severities"}),u.jsx("option",{value:"fatal",children:"Fatal"}),u.jsx("option",{value:"severe",children:"Severe"}),u.jsx("option",{value:"moderate",children:"Moderate"}),u.jsx("option",{value:"minor",children:"Minor"})]})}),u.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[u.jsxs(Xr,{variant:"outline",size:"sm",onClick:Ae,disabled:Z,className:"flex items-center gap-1",children:[u.jsx(uB,{className:"h-4 w-4"}),Z?"Loading...":"Style"]}),u.jsxs(Xr,{variant:"outline",size:"sm",onClick:Te,className:"flex items-center gap-1",children:[u.jsx(Eue,{className:"h-4 w-4"}),"Reset"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{ref:r,className:"w-full h-96 rounded-lg",style:{minHeight:"400px"}}),u.jsxs("div",{className:`absolute top-4 left-4 rounded-lg shadow-lg p-3 text-xs ${_?"bg-gray-800 border border-gray-700 text-gray-100":"bg-white border border-gray-200 text-gray-900"}`,children:[u.jsx("div",{className:"font-semibold mb-2",children:"Accident Severity"}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-red-600 border-2 border-white"}),u.jsx("span",{children:"Fatal"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 border-2 border-white"}),u.jsx("span",{children:"Severe"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 border-2 border-white"}),u.jsx("span",{children:"Moderate"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 border-2 border-white"}),u.jsx("span",{children:"Minor"})]})]}),A&&u.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-300",children:[u.jsx("div",{className:"font-semibold mb-1",children:"Clusters"}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-400"}),u.jsx("span",{children:"Small"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-400"}),u.jsx("span",{children:"Medium"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-5 h-5 rounded-full bg-pink-400"}),u.jsx("span",{children:"Large"})]})]})]})]})]})]})})]})},vVe=({analyticsData:e,riskData:t,timePeriod:r,selectedSeverity:n,selectedVehicleType:a,className:l=""})=>{const f=()=>{if(!e)return;const A=[];A.push(["Metric","Value","Change"]),A.push(["Total Accidents",e.summary.totalAccidents,e.summary.accidentChange]),A.push(["Fatal Accidents",e.summary.fatalities,e.summary.fatalitiesChange]),A.push(["High Risk Areas",e.distributions.municipality.length,""]),t&&A.push(["High Risk Predictions",t.riskPredictions.highRisk,t.riskPredictions.highRiskPercentage]),A.push(["","",""]),A.push(["Month","Accidents"]),e.trends.monthly.forEach(B=>{const q=new Date(B._id.year,B._id.month-1);A.push([q.toLocaleDateString("en-US",{month:"long",year:"numeric"}),B.count])}),A.push(["",""]),A.push(["Severity","Count"]),e.distributions.severity.forEach(B=>{A.push([B._id,B.count])}),A.push(["",""]),A.push(["Vehicle Type","Count"]),e.distributions.vehicleType.forEach(B=>{A.push([B._id,B.count])}),A.push(["",""]),A.push(["Municipality","Count"]),e.distributions.municipality.forEach(B=>{A.push([B._id,B.count])});const E=A.map(B=>B.map(q=>`"${q}"`).join(",")).join(`
`),O=new Blob([E],{type:"text/csv;charset=utf-8;"}),F=document.createElement("a"),U=URL.createObjectURL(O);F.setAttribute("href",U),F.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.csv`),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F)},i=()=>{if(!e)return;const A={exportInfo:{timestamp:new Date().toISOString(),timePeriod:r,filters:{severity:n,vehicleType:a}},summary:e.summary,trends:e.trends,distributions:e.distributions,riskData:t,mapData:e.mapData},E=JSON.stringify(A,null,2),O=new Blob([E],{type:"application/json;charset=utf-8;"}),F=document.createElement("a"),U=URL.createObjectURL(O);F.setAttribute("href",U),F.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.json`),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F)},_=A=>{alert(`Exporting ${A} chart as image... (Feature requires additional setup)`)},w=()=>{if(!e)return;const A=`
ACCIDENT ANALYTICS REPORT
Generated: ${new Date().toLocaleDateString()}
Time Period: ${r}
Filters: Severity=${n}, Vehicle Type=${a}

SUMMARY
========
Total Accidents: ${e.summary.totalAccidents}
Fatal Accidents: ${e.summary.fatalities}
High Risk Areas: ${e.distributions.municipality.length}
Accident Change: ${e.summary.accidentChange}%

${t?`
RISK ANALYSIS
=============
High Risk Predictions: ${t.riskPredictions.highRisk} (${t.riskPredictions.highRiskPercentage}%)
Medium Risk: ${t.riskPredictions.mediumRisk}
Low Risk: ${t.riskPredictions.lowRisk}
`:""}

MONTHLY TRENDS
==============
${e.trends.monthly.map(U=>`${new Date(U._id.year,U._id.month-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}: ${U.count} accidents`).join(`
`)}

SEVERITY DISTRIBUTION
====================
${e.distributions.severity.map(U=>`${U._id}: ${U.count} accidents`).join(`
`)}

VEHICLE TYPE DISTRIBUTION
=========================
${e.distributions.vehicleType.map(U=>`${U._id}: ${U.count} accidents`).join(`
`)}

TOP MUNICIPALITIES
==================
${e.distributions.municipality.slice(0,10).map(U=>`${U._id}: ${U.count} accidents`).join(`
`)}
    `.trim(),E=new Blob([A],{type:"text/plain;charset=utf-8;"}),O=document.createElement("a"),F=URL.createObjectURL(E);O.setAttribute("href",F),O.setAttribute("download",`accident_report_${r}_${new Date().toISOString().split("T")[0]}.txt`),O.style.visibility="hidden",document.body.appendChild(O),O.click(),document.body.removeChild(O)};return u.jsx("div",{className:`flex items-center gap-2 ${l}`,children:u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[u.jsx(MW,{className:"h-4 w-4"}),"Export"]})}),u.jsxs(zc,{align:"end",className:"w-48",children:[u.jsxs(Aa,{onClick:f,className:"flex items-center gap-2",children:[u.jsx(Uue,{className:"h-4 w-4"}),"Export as CSV"]}),u.jsxs(Aa,{onClick:i,className:"flex items-center gap-2",children:[u.jsx(jv,{className:"h-4 w-4"}),"Export as JSON"]}),u.jsxs(Aa,{onClick:w,className:"flex items-center gap-2",children:[u.jsx(jv,{className:"h-4 w-4"}),"Export Report"]}),u.jsx(Rh,{}),u.jsxs(Aa,{onClick:()=>_("trends"),className:"flex items-center gap-2",children:[u.jsx(j3,{className:"h-4 w-4"}),"Export Trends Chart"]}),u.jsxs(Aa,{onClick:()=>_("severity"),className:"flex items-center gap-2",children:[u.jsx(cB,{className:"h-4 w-4"}),"Export Severity Chart"]}),u.jsxs(Aa,{onClick:()=>_("heatmap"),className:"flex items-center gap-2",children:[u.jsx(cB,{className:"h-4 w-4"}),"Export Heatmap"]})]})]})})},YG={light:["#DC2626","#EA580C","#059669","#2563EB"],dark:["#EF4444","#F97316","#10B981","#3B82F6"]},ZS=({value:e,duration:t=2e3,className:r=""})=>{const[n,a]=H.useState(0),[l,f]=H.useState(!1),i=H.useRef(null);return H.useEffect(()=>{const _=new IntersectionObserver(([w])=>{w.isIntersecting&&f(!0)},{threshold:.1});return i.current&&_.observe(i.current),()=>_.disconnect()},[]),H.useEffect(()=>{if(l){let _;const w=A=>{_||(_=A);const E=Math.min((A-_)/t,1),O=1-Math.pow(1-E,4),F=Math.floor(e*O);a(F),E<1?requestAnimationFrame(w):a(e)};requestAnimationFrame(w)}},[e,t,l]),u.jsx("div",{ref:i,className:`${r} transition-all duration-500 ${l?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"}`,children:n.toLocaleString()})},YS=({percentage:e,color:t="bg-blue-500",delay:r=0})=>{const[n,a]=H.useState(0),[l,f]=H.useState(!1),i=H.useRef(null);return H.useEffect(()=>{const _=new IntersectionObserver(([w])=>{w.isIntersecting&&f(!0)},{threshold:.1});return i.current&&_.observe(i.current),()=>_.disconnect()},[]),H.useEffect(()=>{if(l){const _=setTimeout(()=>{a(e)},r);return()=>clearTimeout(_)}},[l,e,r]),u.jsx("div",{ref:i,className:"mt-2 w-full bg-gray-200 rounded-full h-1.5 overflow-hidden",children:u.jsx("div",{className:`${t} h-1.5 rounded-full transition-all duration-1000 ease-out`,style:{width:`${n}%`}})})};function xVe(){var ke,Qe,Ze,Ge;const[e,t]=H.useState("alltime"),[r,n]=H.useState(null),[a,l]=H.useState(null),[f,i]=H.useState(!0),[_,w]=H.useState(null),[A,E]=H.useState("area"),[O,F]=H.useState(!1),{token:U}=la(),[B,q]=H.useState(!1);H.useEffect(()=>{const Oe=()=>{const ut=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;q(ut)};Oe();const je=new MutationObserver(Oe);je.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const Le=window.matchMedia("(prefers-color-scheme: dark)");return Le.addEventListener("change",Oe),()=>{je.disconnect(),Le.removeEventListener("change",Oe)}},[]);const W=()=>B?YG.dark:YG.light;H.useEffect(()=>{Z()},[e]);const Z=async()=>{var Oe;try{i(!0),w(null);const je=Date.now();console.log(`Fetching analytics data for period: ${e} at ${new Date(je).toISOString()}`);const[Le,ut]=await Promise.all([Wn.get(`/accident/analytics/summary?period=${e}&_t=${je}`,{headers:{Authorization:U}}),Wn.get(`/accident/analytics/risk?period=${e}&_t=${je}`,{headers:{Authorization:U}})]);Le.data.success&&(console.log("Frontend received analytics data:",Le.data.data),console.log("Municipality data:",(Oe=Le.data.data.distributions)==null?void 0:Oe.municipality),n(Le.data.data)),ut.data.success&&l(ut.data.data)}catch(je){console.error("Error fetching accident analytics:",je),w("Failed to load accident analytics data")}finally{i(!1)}},ne=Oe=>{switch(Oe){case"week":return"Last Week";case"month":return"Last Month";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"year":return"Last Year";case"alltime":return"All Time";default:return"Last 6 Months"}},ae=Oe=>Oe.map(je=>({month:`${je._id.year}-${String(je._id.month).padStart(2,"0")}`,accidents:je.count})),ee=Oe=>Oe.map(je=>({name:je._id.charAt(0).toUpperCase()+je._id.slice(1),value:je.count,severity:je._id})),se=({active:Oe,payload:je,label:Le})=>{if(Oe&&je&&je.length){const ut=je[0];Te(r.distributions.municipality).find(rt=>rt.name===ut.name);const ht=W()[2];return u.jsxs("div",{className:"p-3 rounded-lg shadow-lg border transition-all duration-200 ease-in-out",style:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",color:B?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},children:[u.jsxs("p",{className:"font-semibold text-sm mb-1",children:["Municipality: ",Le]}),u.jsxs("p",{className:"text-sm",style:{color:ht,fontWeight:"600"},children:["Accidents: ",ut.value," accidents"]})]})}return null},ce=({active:Oe,payload:je,label:Le})=>{if(Oe&&je&&je.length){const ut=je[0],ze=W();ee(r.distributions.severity);const rt={Fatal:ze[0],Severe:ze[1],Minor:ze[2],Moderate:ze[3]}[ut.name]||ze[0],Qt=B?"#1f2937":"#ffffff",Cr=rt,vr=rt,cr=B?"rgba(0, 0, 0, 0.4)":"rgba(0, 0, 0, 0.15)",nr=B?`${rt}60`:`${rt}30`;return u.jsx("div",{className:"p-3 rounded-lg shadow-lg border transition-all duration-200 ease-in-out",style:{backgroundColor:Qt,border:`2px solid ${Cr}`,boxShadow:`${cr} 0 8px 25px, 0 0 0 1px ${nr}`,fontWeight:"600",backdropFilter:B?"blur(8px)":"none"},children:u.jsx("p",{style:{color:vr,margin:0,fontSize:"14px",fontWeight:"700",textShadow:B?`0 0 12px ${rt}80, 0 0 4px ${rt}40`:`0 0 8px ${rt}60, 0 0 2px ${rt}30`,filter:B?"brightness(1.1)":"brightness(1)"},children:`${ut.name} : ${ut.value}`})})}return null},ge=Oe=>Oe.map(je=>({name:je._id.charAt(0).toUpperCase()+je._id.slice(1),value:je.count,type:je._id})),Te=Oe=>{console.log("formatMunicipalityData input:",Oe);const je=Oe.map(Le=>({name:Le._id,accidents:Le.count,percentage:Oe.length>0?(Le.count/Oe.reduce((ut,ze)=>ut+ze.count,0)*100).toFixed(1):0})).sort((Le,ut)=>ut.accidents-Le.accidents);return console.log("formatMunicipalityData output:",je),je},Ae=Oe=>{const je=Array.from({length:24},(Le,ut)=>({hour:ut,accidents:0}));return Oe==null||Oe.forEach(Le=>{if(Le.accident_date){const ut=new Date(Le.accident_date).getHours();je[ut].accidents++}}),je.map(Le=>({...Le,timeLabel:`${Le.hour}:00`,period:Le.hour<6?"Night":Le.hour<12?"Morning":Le.hour<18?"Afternoon":"Evening"}))},_e=Oe=>{const je=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Le=Array.from({length:7},(ut,ze)=>({day:ze,dayName:je[ze],accidents:0}));return Oe==null||Oe.forEach(ut=>{if(ut.accident_date){const ze=new Date(ut.accident_date).getDay();Le[ze].accidents++}}),Le},Ee=(Oe,je)=>!Oe||!je?[]:[{category:"High Risk",accidents:je.riskPredictions.highRisk,percentage:je.riskPredictions.highRiskPercentage},{category:"Medium Risk",accidents:je.riskPredictions.mediumRisk,percentage:100-je.riskPredictions.highRiskPercentage-je.riskPredictions.lowRiskPercentage},{category:"Low Risk",accidents:je.riskPredictions.lowRisk,percentage:je.riskPredictions.lowRiskPercentage}];return f?u.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6 rounded-lg",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[u.jsx(mv,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),u.jsx("p",{className:"text-muted-foreground",children:"Comprehensive Analysis of Accident Data"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"animate-pulse",children:u.jsx("div",{className:"h-8 bg-muted rounded w-32"})}),u.jsx("div",{className:"animate-pulse",children:u.jsx("div",{className:"h-8 bg-muted rounded w-40"})})]})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-24"})]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(Oe=>u.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-4 bg-muted rounded w-24 mb-2"}),u.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),u.jsx("div",{className:"h-3 bg-muted rounded w-20"})]})},Oe))}),u.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(Oe=>u.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),u.jsx("div",{className:"h-64 bg-muted rounded"})]})},Oe))}),u.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-6 bg-muted rounded w-40 mb-4"}),u.jsx("div",{className:"h-96 bg-muted rounded"})]})})]}):_?u.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-red-500",children:_})})}):u.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[u.jsx(mv,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),u.jsx("p",{className:"text-muted-foreground",children:"Comprehensive analysis of accident data"})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsx(vVe,{analyticsData:r,riskData:a,timePeriod:e})})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(OW,{className:"h-4 w-4 text-muted-foreground"}),u.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-sm text-muted-foreground",children:"Advanced:"}),u.jsxs("button",{onClick:()=>F(!O),className:`px-3 py-2 text-sm font-medium rounded-md transition-colors flex items-center gap-2 ${O?"text-white bg-primary hover:bg-primary/90 dark:text-white dark:bg-primary dark:hover:bg-primary/90":"text-foreground bg-background border border-border hover:bg-muted dark:text-foreground dark:bg-background dark:border-border dark:hover:bg-muted"}`,children:[u.jsx(j3,{className:"h-4 w-4"}),O?"Hide Advanced":"Show Advanced"]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-sm text-muted-foreground",children:"Date:"}),u.jsxs(Io,{value:e,onValueChange:t,children:[u.jsx(mo,{className:"w-[140px]",children:u.jsx(Do,{placeholder:"Select time period"})}),u.jsxs(go,{children:[u.jsx(_n,{value:"week",children:"Last Week"}),u.jsx(_n,{value:"month",children:"Last Month"}),u.jsx(_n,{value:"3months",children:"Last 3 Months"}),u.jsx(_n,{value:"6months",children:"Last 6 Months"}),u.jsx(_n,{value:"year",children:"Last Year"}),u.jsx(_n,{value:"alltime",children:"All Time"})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-sm text-muted-foreground",children:"Chart Type:"}),u.jsxs(Io,{value:A,onValueChange:E,children:[u.jsx(mo,{className:"w-[120px]",children:u.jsx(Do,{})}),u.jsxs(go,{children:[u.jsx(_n,{value:"area",children:"Area Chart"}),u.jsx(_n,{value:"line",children:"Line Chart"}),u.jsx(_n,{value:"bar",children:"Bar Chart"}),u.jsx(_n,{value:"composed",children:"Composed"})]})]})]})]})]}),r&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[u.jsxs(wi,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-blue-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),u.jsxs(Ii,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[u.jsx(Di,{className:"text-sm font-medium",children:"Total Accidents"}),u.jsx(Gf,{className:"h-4 w-4 text-blue-500"})]}),u.jsxs(Ei,{className:"relative z-10",children:[u.jsx(ZS,{value:r.summary.totalAccidents,className:"text-2xl font-bold",duration:1500}),u.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.accidentChange>=0?u.jsx(pB,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):u.jsx(fB,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),Math.abs(r.summary.accidentChange),"% from previous period"]}),u.jsx(YS,{percentage:Math.min(r.summary.totalAccidents/100*100,100),color:"bg-blue-500",delay:200})]})]}),u.jsxs(wi,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-red-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),u.jsxs(Ii,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[u.jsx(Di,{className:"text-sm font-medium",children:"Fatal Accidents"}),u.jsx(mv,{className:"h-4 w-4 text-red-500"})]}),u.jsxs(Ei,{className:"relative z-10",children:[u.jsx(ZS,{value:r.summary.fatalities,className:"text-2xl font-bold text-red-600",duration:1800}),u.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.fatalitiesChange>=0?u.jsx(pB,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):u.jsx(fB,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),r.summary.fatalitiesChange," from previous period"]}),u.jsx(YS,{percentage:Math.min(r.summary.fatalities/10*100,100),color:"bg-red-500",delay:400})]})]}),u.jsxs(wi,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-orange-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),u.jsxs(Ii,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[u.jsx(Di,{className:"text-sm font-medium",children:"High Risk Areas"}),u.jsx(wx,{className:"h-4 w-4 text-orange-500"})]}),u.jsxs(Ei,{className:"relative z-10",children:[u.jsx(ZS,{value:r.distributions.municipality.length,className:"text-2xl font-bold",duration:1600}),u.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Municipalities with accidents"}),u.jsx(YS,{percentage:Math.min(r.distributions.municipality.length/20*100,100),color:"bg-orange-500",delay:600})]})]}),u.jsxs(wi,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[u.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),u.jsxs(Ii,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[u.jsx(Di,{className:"text-sm font-medium",children:"Risk Predictions"}),u.jsx(aB,{className:"h-4 w-4 text-purple-500"})]}),u.jsxs(Ei,{className:"relative z-10",children:[u.jsx(ZS,{value:a?a.riskPredictions.highRiskPercentage:0,className:"text-2xl font-bold",duration:2e3}),u.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High risk predictions"}),u.jsx(YS,{percentage:a?a.riskPredictions.highRiskPercentage:0,color:"bg-purple-500",delay:800})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r&&r.trends.monthly.length>0&&u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[u.jsx(Ii,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wd,{className:"h-5 w-5 text-blue-500 animate-pulse"}),"Accident Trends Over Time"]}),u.jsxs(ls,{children:["Monthly accident frequency for ",ne(e)]})]}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsx(eo,{variant:"outline",className:"text-xs",children:A.toUpperCase()})})]})}),u.jsx(Ei,{children:u.jsxs(No,{width:"100%",height:300,children:[A==="area"&&u.jsxs(gLe,{data:ae(r.trends.monthly),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"month",tickFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:B?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{labelFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827"}}),u.jsx(yu,{type:"monotone",dataKey:"accidents",stroke:W()[0],fill:W()[0],fillOpacity:.3,strokeWidth:3,animationDuration:1500,animationEasing:"ease-out"})]}),A==="line"&&u.jsxs(ZL,{data:ae(r.trends.monthly),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"month",tickFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:B?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{labelFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827"}}),u.jsx(Qf,{type:"monotone",dataKey:"accidents",stroke:W()[0],strokeWidth:3,dot:{fill:W()[0],strokeWidth:2,r:4},activeDot:{r:6,stroke:W()[0],strokeWidth:2},animationDuration:1500,animationEasing:"ease-out"})]}),A==="bar"&&u.jsxs(_d,{data:ae(r.trends.monthly),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"month",tickFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:B?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{labelFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827"}}),u.jsx(xs,{dataKey:"accidents",fill:W()[0],radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"})]}),A==="composed"&&u.jsxs(YL,{data:ae(r.trends.monthly),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"month",tickFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:B?"#9ca3af":"#6b7280"}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{labelFormatter:Oe=>new Date(Oe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827"}}),u.jsx(xs,{dataKey:"accidents",fill:W()[0],fillOpacity:.6,radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"}),u.jsx(Qf,{type:"monotone",dataKey:"accidents",stroke:W()[1],strokeWidth:2,dot:!1,animationDuration:1500,animationEasing:"ease-out"})]})]})})]}),r&&r.distributions.severity.length>0&&u.jsxs(wi,{className:"animate-in slide-in-from-right-5 fade-in duration-700",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(_1,{className:"h-5 w-5 text-orange-500 animate-pulse"}),"Accident Severity Distribution"]}),u.jsx(ls,{children:"Breakdown of accidents by severity level"})]}),u.jsx(Ei,{children:u.jsx(No,{width:"100%",height:300,children:u.jsxs(Zee,{children:[u.jsx(op,{data:ee(r.distributions.severity),cx:"50%",cy:"50%",labelLine:!1,label:({name:Oe,percent:je})=>`${Oe} ${(je*100).toFixed(0)}%`,outerRadius:80,innerRadius:40,fill:"currentColor",dataKey:"value",animationDuration:1500,animationEasing:"ease-out",children:ee(r.distributions.severity).map((Oe,je)=>{const Le=W(),ut={Fatal:Le[0],Severe:Le[1],Minor:Le[2],Moderate:Le[3]};return u.jsx(Xf,{fill:ut[Oe.name]||Le[0]},`cell-${je}`)})}),u.jsx(aa,{content:u.jsx(ce,{})})]})})})]}),r&&r.distributions.vehicleType.length>0&&u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(Gf,{className:"h-5 w-5 text-green-500"}),"Vehicle Type Distribution"]}),u.jsx(ls,{children:"Accidents by vehicle type with enhanced visualization"})]}),u.jsxs(Ei,{children:[u.jsx(No,{width:"100%",height:300,children:u.jsxs(_d,{data:ge(r.distributions.vehicleType),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"name",stroke:B?"#9ca3af":"#6b7280",fontSize:12,angle:-45,textAnchor:"end",height:80}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(Oe,je)=>[`${Oe} accidents`,"Count"],labelFormatter:Oe=>`Vehicle Type: ${Oe}`}),u.jsx(xs,{dataKey:"value",fill:W()[1],radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),u.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const Oe=ge(r.distributions.vehicleType),je=Oe.reduce((ut,ze)=>ut+ze.value,0),Le=Oe.reduce((ut,ze)=>ze.value>ut.value?ze:ut);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Most Common"}),u.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:Le.name}),u.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[Le.value," accidents (",(Le.value/je*100).toFixed(1),"%)"]})]}),u.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Vehicles"}),u.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:Oe.length}),u.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Vehicle types involved"})]})]})})()})]})]}),r&&r.distributions.municipality.length>0&&u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wx,{className:"h-5 w-5 text-orange-500"}),"Top Municipalities by Accidents",((Qe=(ke=r==null?void 0:r.distributions)==null?void 0:ke.municipality)==null?void 0:Qe.some(Oe=>Oe._id==="Mati"))&&u.jsx("span",{className:"ml-2 px-2 py-1 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 text-xs rounded-full border border-red-200 dark:border-red-800",children:"Mati Included"})]}),u.jsxs(ls,{children:["Municipalities with highest accident counts and risk analysis",((Ge=(Ze=r==null?void 0:r.distributions)==null?void 0:Ze.municipality)==null?void 0:Ge.some(Oe=>Oe._id==="Mati"))&&u.jsx("span",{className:"block text-green-600 dark:text-green-400 text-sm mt-1",children:" Mati municipality data has been normalized and included in the analysis"})]})]}),u.jsxs(Ei,{children:[u.jsx(No,{width:"100%",height:300,children:u.jsxs(_d,{data:Te(r.distributions.municipality),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"name",stroke:B?"#9ca3af":"#6b7280",fontSize:11,angle:-45,textAnchor:"end",height:80}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{content:u.jsx(se,{})}),u.jsx(xs,{dataKey:"accidents",radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200",children:Te(r.distributions.municipality).map((Oe,je)=>u.jsx(Xf,{fill:Oe.name==="Mati"?"#ef4444":W()[2]},`cell-${je}`))})]})}),u.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:(()=>{const Oe=Te(r.distributions.municipality),je=Oe.reduce((ht,rt)=>ht+rt.accidents,0),Le=Oe.reduce((ht,rt)=>rt.accidents>ht.accidents?rt:ht),ut=je/Oe.length,ze=Oe.find(ht=>ht.name==="Mati");return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:`p-3 rounded-lg ${Le.name==="Mati"?"bg-red-50 dark:bg-red-950/20 border-2 border-red-200 dark:border-red-800":"bg-orange-50 dark:bg-orange-950/20"}`,children:[u.jsx("div",{className:`text-sm font-medium ${Le.name==="Mati"?"text-red-700 dark:text-red-300":"text-orange-700 dark:text-orange-300"}`,children:Le.name==="Mati"?" Top Municipality":"Highest Risk"}),u.jsx("div",{className:`text-lg font-bold ${Le.name==="Mati"?"text-red-900 dark:text-red-100":"text-orange-900 dark:text-orange-100"}`,children:Le.name}),u.jsxs("div",{className:`text-xs ${Le.name==="Mati"?"text-red-600 dark:text-red-400":"text-orange-600 dark:text-orange-400"}`,children:[Le.accidents," accidents (",Le.percentage,"%)"]})]}),u.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Areas"}),u.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:Oe.length}),u.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Municipalities affected"})]}),u.jsxs("div",{className:`p-3 rounded-lg ${ze?"bg-red-50 dark:bg-red-950/20":"bg-purple-50 dark:bg-purple-950/20"}`,children:[u.jsx("div",{className:`text-sm font-medium ${ze?"text-red-700 dark:text-red-300":"text-purple-700 dark:text-purple-300"}`,children:ze?"Mati Status":"Average"}),u.jsx("div",{className:`text-lg font-bold ${ze?"text-red-900 dark:text-red-100":"text-purple-900 dark:text-purple-100"}`,children:ze?`#${Oe.findIndex(ht=>ht.name==="Mati")+1}`:ut.toFixed(1)}),u.jsx("div",{className:`text-xs ${ze?"text-red-600 dark:text-red-400":"text-purple-600 dark:text-purple-400"}`,children:ze?`${ze.accidents} accidents`:"Accidents per area"})]})]})})()})]})]})]}),a&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsx(Di,{children:"Risk Level Distribution"}),u.jsx(ls,{children:"ML-based risk predictions for accidents"})]}),u.jsx(Ei,{children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),u.jsx("span",{children:"High Risk"})]}),u.jsxs(eo,{variant:"destructive",children:[a.riskPredictions.highRisk," (",a.riskPredictions.highRiskPercentage,"%)"]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),u.jsx("span",{children:"Medium Risk"})]}),u.jsx(eo,{variant:"secondary",children:a.riskPredictions.mediumRisk})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),u.jsx("span",{children:"Low Risk"})]}),u.jsx(eo,{variant:"outline",children:a.riskPredictions.lowRisk})]})]})})]}),u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsx(Di,{children:"Rule-Based Detection"}),u.jsx(ls,{children:"Traditional rule-based risk assessment"})]}),u.jsx(Ei,{children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(mv,{className:"h-4 w-4 text-red-500"}),u.jsx("span",{children:"Flagged (High Risk)"})]}),u.jsxs(eo,{variant:"destructive",children:[a.ruleBasedDetection.flagged," (",a.ruleBasedDetection.flaggedPercentage,"%)"]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(aB,{className:"h-4 w-4 text-green-500"}),u.jsx("span",{children:"Safe (Low Risk)"})]}),u.jsxs(eo,{variant:"outline",children:[a.ruleBasedDetection.safe," (",a.ruleBasedDetection.safePercentage,"%)"]})]})]})})]})]}),O&&r&&u.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(rde,{className:"h-5 w-5 text-yellow-500 animate-pulse"}),u.jsx("h3",{className:"text-xl font-semibold",children:"Advanced Analytics"}),u.jsx(eo,{variant:"secondary",className:"ml-2 animate-pulse",children:"Enhanced Visualizations"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(Jce,{className:"h-5 w-5 text-green-500 animate-pulse"}),"Hourly Accident Distribution"]}),u.jsx(ls,{children:"Accidents by hour of day showing peak times and patterns"})]}),u.jsxs(Ei,{children:[u.jsx(No,{width:"100%",height:300,children:u.jsxs(_d,{data:Ae(r.mapData),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"timeLabel",stroke:B?"#9ca3af":"#6b7280",fontSize:11,interval:1}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(Oe,je)=>[`${Oe} accidents`,"Count"],labelFormatter:Oe=>`Time: ${Oe}`}),u.jsx(xs,{dataKey:"accidents",fill:W()[2],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),u.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const Oe=Ae(r.mapData),je=Oe.reduce((ut,ze)=>ze.accidents>ut.accidents?ze:ut),Le=Oe.reduce((ut,ze)=>ut+ze.accidents,0);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Peak Hour"}),u.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:je.timeLabel}),u.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[je.accidents," accidents"]})]}),u.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Accidents"}),u.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:Le}),u.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Across all hours"})]})]})})()})]})]}),u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-right-5 fade-in duration-700",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(wd,{className:"h-5 w-5 text-purple-500 animate-pulse"}),"Day of Week Analysis"]}),u.jsx(ls,{children:"Accident patterns by day of the week with risk assessment"})]}),u.jsxs(Ei,{children:[u.jsx(No,{width:"100%",height:300,children:u.jsxs(_d,{data:_e(r.mapData),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"dayName",stroke:B?"#9ca3af":"#6b7280",fontSize:12}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(Oe,je)=>[`${Oe} accidents`,"Count"],labelFormatter:Oe=>`Day: ${Oe}`}),u.jsx(xs,{dataKey:"accidents",fill:W()[3],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),u.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const Oe=_e(r.mapData),je=Oe.reduce((ze,ht)=>ht.accidents>ze.accidents?ht:ze),ut=Oe.filter(ze=>ze.day===0||ze.day===6).reduce((ze,ht)=>ze+ht.accidents,0);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Peak Day"}),u.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:je.dayName}),u.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:[je.accidents," accidents"]})]}),u.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[u.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Weekend Total"}),u.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:ut}),u.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Sat + Sun accidents"})]})]})})()})]})]}),a&&u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(IW,{className:"h-5 w-5 text-red-500"}),"Risk Level Correlation"]}),u.jsx(ls,{children:"Relationship between risk levels and accident counts"})]}),u.jsx(Ei,{children:u.jsx(No,{width:"100%",height:300,children:u.jsxs(mLe,{data:Ee(r,a),children:[u.jsx(Xs,{strokeDasharray:"3 3",stroke:B?"#374151":"#e5e7eb"}),u.jsx(La,{dataKey:"category",stroke:B?"#9ca3af":"#6b7280",fontSize:12}),u.jsx(za,{stroke:B?"#9ca3af":"#6b7280"}),u.jsx(aa,{contentStyle:{backgroundColor:B?"#1f2937":"#ffffff",border:B?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827"}}),u.jsx(O_,{dataKey:"accidents",fill:W()[4],r:8})]})})})]}),r&&r.distributions.severity.length>0&&u.jsxs(wi,{className:"group hover:shadow-lg transition-all duration-300",children:[u.jsxs(Ii,{children:[u.jsxs(Di,{className:"flex items-center gap-2",children:[u.jsx(_1,{className:"h-5 w-5 text-orange-500"}),"Severity Distribution (Radial)"]}),u.jsx(ls,{children:"Circular view of accident severity breakdown"})]}),u.jsx(Ei,{children:u.jsx(No,{width:"100%",height:300,children:u.jsxs(yLe,{cx:"50%",cy:"50%",innerRadius:"20%",outerRadius:"80%",data:ee(r.distributions.severity),children:[u.jsx(c2,{dataKey:"value",cornerRadius:4,fill:W()[0]}),u.jsx(aa,{contentStyle:{backgroundColor:B?"#374151":"#ffffff",border:B?"1px solid #4b5563":"1px solid #e5e7eb",borderRadius:"8px",color:B?"#f9fafb":"#111827",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}})]})})})]})]}),u.jsx(gVe,{analyticsData:r,className:"w-full"})]}),r&&r.mapData&&r.mapData.length>0&&u.jsx(yVe,{accidents:r.mapData,className:"w-full"})]})}function _Ve(){return u.jsx("div",{children:u.jsx(xVe,{})})}const bVe=en.object({firstName:en.string().min(1,"First name is required").trim(),middleName:en.string().optional(),lastName:en.string().min(1,"Last name is required").trim(),email:en.string().email("Invalid email address"),password:en.string().min(6,"Password must be at least 6 characters"),confirmPassword:en.string(),role:en.enum(["0","1","2"]).optional()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),wVe=[{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function SVe(){const{userData:e}=la(),[t,r]=H.useState(!1),n=Su(Date.now()),a=Uh({resolver:np(bVe),defaultValues:{firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0}}),l=async f=>{var i,_;try{r(!0);const{confirmPassword:w,...A}=f;(e==null?void 0:e.role)==="1"?A.role="2":(e==null?void 0:e.role)==="0"&&(A.role=f.role||"2"),(await Wn.post("/auth/register",A)).data.success&&(ki.success("Account has been registered successfully",{description:n}),a.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0}))}catch(w){const A=((_=(i=w.response)==null?void 0:i.data)==null?void 0:_.message)||"Failed to register account";ki.error(A,{description:n})}finally{r(!1)}};return u.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:u.jsx("div",{className:"max-w-2xl mx-auto",children:u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(yA,{className:"h-6 w-6"}),u.jsx(Di,{children:"Register New Account"})]}),u.jsx(ls,{children:(e==null?void 0:e.role)==="0"?"Create a new admin or employee account for the LTO system":"Create a new employee account for the LTO system"})]}),u.jsx(Ei,{children:u.jsx(Zv,{...a,children:u.jsxs("form",{onSubmit:a.handleSubmit(l),className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsx(Bn,{control:a.control,name:"firstName",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"First Name *"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter first name",...f})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:a.control,name:"middleName",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Middle Name"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter middle name (optional)",...f})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:a.control,name:"lastName",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Last Name *"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter last name",...f})}),u.jsx(zn,{})]})})]}),u.jsx(Bn,{control:a.control,name:"email",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Email Address *"}),u.jsx(On,{children:u.jsx(Vn,{type:"email",placeholder:"Enter email address",...f})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:a.control,name:"password",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Password *"}),u.jsx(On,{children:u.jsx(Vn,{type:"password",placeholder:"Enter password",...f})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:a.control,name:"confirmPassword",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Confirm Password *"}),u.jsx(On,{children:u.jsx(Vn,{type:"password",placeholder:"Confirm password",...f})}),u.jsx(zn,{})]})}),(e==null?void 0:e.role)==="0"&&u.jsx(Bn,{control:a.control,name:"role",render:({field:f})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Role *"}),u.jsxs(Io,{onValueChange:f.onChange,defaultValue:f.value,children:[u.jsx(On,{children:u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select a role"})})}),u.jsx(go,{children:wVe.map(i=>u.jsx(_n,{value:i.value,children:i.label},i.value))})]}),u.jsx(zn,{})]})}),u.jsxs("div",{className:"flex gap-4 pt-4",children:[u.jsx(Xr,{type:"submit",disabled:t,className:"w-auto px-8",children:t?u.jsxs(u.Fragment,{children:[u.jsx(Lf,{className:"mr-2 h-4 w-4 animate-spin"}),"Registering..."]}):u.jsxs(u.Fragment,{children:[u.jsx(yA,{className:"mr-2 h-4 w-4"}),"Register Account"]})}),u.jsx(Xr,{type:"button",variant:"outline",onClick:()=>{a.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0})},disabled:t,className:"w-auto px-8",children:"Clear Form"})]})]})})})]})})})}const AVe=en.object({userId:en.string().min(1,"User ID is required"),firstName:en.string().min(1,"First name is required").trim(),middleName:en.string().optional(),lastName:en.string().min(1,"Last name is required").trim(),email:en.string().email("Invalid email address"),role:en.enum(["0","1","2"],{required_error:"Please select a role"}),isPasswordChange:en.boolean().optional()}),TVe=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function PVe(){const{userData:e}=la(),[t,r]=H.useState([]),[n,a]=H.useState(!1),[l,f]=H.useState(!1),[i,_]=H.useState(null),[w,A]=H.useState(!1),[E,O]=H.useState(!1),[F,U]=H.useState(null),B=Uh({resolver:np(AVe),defaultValues:{userId:"",firstName:"",middleName:"",lastName:"",email:"",role:"",isPasswordChange:!1}}),q=async()=>{var ge,Te;try{a(!0);const Ae=await Wn.get("/user/all");if(Ae.data.success){let _e=Ae.data.users;(e==null?void 0:e.role)==="1"?_e=_e.filter(Ee=>Ee.role==="2"):(e==null?void 0:e.role)==="0"&&(_e=_e.filter(Ee=>Ee.role==="1"||Ee.role==="2")),r(_e)}}catch(Ae){const _e=((Te=(ge=Ae.response)==null?void 0:ge.data)==null?void 0:Te.message)||"Failed to fetch users";ki.error(_e)}finally{a(!1)}};H.useEffect(()=>{q()},[e]);const W=ge=>{_(ge),A(!0),B.reset({userId:ge._id,firstName:ge.firstName,middleName:ge.middleName||"",lastName:ge.lastName,email:ge.email,role:ge.role,isPasswordChange:ge.isPasswordChange||!1})},Z=ge=>{U(ge),O(!0)},ne=async()=>{var ge,Te;try{f(!0),(await Wn.delete(`/user/${F._id}`)).data.success&&(ki.success("User deleted successfully!"),q())}catch(Ae){const _e=((Te=(ge=Ae.response)==null?void 0:ge.data)==null?void 0:Te.message)||"Failed to delete user";ki.error(_e)}finally{f(!1),O(!1),U(null)}},ae=async ge=>{var Te,Ae;try{f(!0),(await Wn.put(`/user/${ge.userId}`,ge)).data.success&&(ki.success("Account updated successfully!"),q(),A(!1),_(null))}catch(_e){const Ee=((Ae=(Te=_e.response)==null?void 0:Te.data)==null?void 0:Ae.message)||"Failed to update account";ki.error(Ee)}finally{f(!1)}},ee=()=>{_(null),A(!1),B.reset()},se=ge=>{switch(ge){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}},ce=ge=>{switch(ge){case"0":return"Superadmin";case"1":return"Admin";case"2":return"Employee";default:return"Unknown"}};return u.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:u.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[u.jsx(wi,{children:u.jsxs(Ii,{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Nc,{className:"h-6 w-6"}),u.jsx(Di,{children:"Manage User Accounts"})]}),u.jsx(ls,{children:(e==null?void 0:e.role)==="0"?"View and manage admin and employee accounts":"View and manage employee accounts"})]})}),u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsx(Di,{children:"User Accounts"})}),u.jsx(Ei,{children:n?u.jsxs("div",{className:"flex items-center justify-center py-8",children:[u.jsx(Lf,{className:"h-8 w-8 animate-spin"}),u.jsx("span",{className:"ml-2",children:"Loading users..."})]}):t.length===0?u.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"}):u.jsx("div",{className:"rounded-md border",children:u.jsxs(oy,{children:[u.jsx(ly,{children:u.jsxs(Bs,{children:[u.jsx(Js,{children:"Full Name"}),u.jsx(Js,{children:"Email"}),u.jsx(Js,{children:"Role"}),u.jsx(Js,{children:"Created At"}),u.jsx(Js,{children:"Last Updated"}),u.jsx(Js,{className:"w-[50px]",children:"Actions"})]})}),u.jsx(cy,{children:t.map(ge=>u.jsxs(Bs,{children:[u.jsxs(Oa,{className:"font-medium",children:[ge.firstName," ",ge.middleName," ",ge.lastName]}),u.jsx(Oa,{children:ge.email}),u.jsx(Oa,{children:u.jsx(eo,{variant:se(ge.role),children:ce(ge.role)})}),u.jsx(Oa,{children:new Date(ge.createdAt).toLocaleDateString()}),u.jsx(Oa,{children:new Date(ge.updatedAt).toLocaleDateString()}),u.jsx(Oa,{children:u.jsxs(Tu,{children:[u.jsx(Pd,{asChild:!0,children:u.jsxs(Xr,{variant:"ghost",className:"h-8 w-8 p-0",children:[u.jsx("span",{className:"sr-only",children:"Open menu"}),u.jsx(aue,{className:"h-4 w-4"})]})}),u.jsxs(zc,{align:"end",children:[u.jsxs(Aa,{onClick:()=>W(ge),children:[u.jsx(Nc,{className:"mr-2 h-4 w-4"}),"Update"]}),(e==null?void 0:e.role)==="0"&&u.jsxs(Aa,{onClick:()=>Z(ge),className:"text-red-600",children:[u.jsx(Gue,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},ge._id))})]})})})]}),w&&i&&u.jsxs(wi,{children:[u.jsxs(Ii,{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Nc,{className:"h-6 w-6"}),u.jsx(Di,{children:"Update Account Information"})]}),u.jsxs(ls,{children:["Modify the account information for ",i.firstName," ",i.lastName]})]}),u.jsx(Ei,{children:u.jsx(Zv,{...B,children:u.jsxs("form",{onSubmit:B.handleSubmit(ae),className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Bn,{control:B.control,name:"firstName",render:({field:ge})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"First Name *"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter first name",...ge})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:B.control,name:"lastName",render:({field:ge})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Last Name *"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter last name",...ge})}),u.jsx(zn,{})]})})]}),u.jsx(Bn,{control:B.control,name:"middleName",render:({field:ge})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Middle Name"}),u.jsx(On,{children:u.jsx(Vn,{placeholder:"Enter middle name (optional)",...ge})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:B.control,name:"email",render:({field:ge})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Email Address *"}),u.jsx(On,{children:u.jsx(Vn,{type:"email",placeholder:"Enter email address",...ge})}),u.jsx(zn,{})]})}),u.jsx(Bn,{control:B.control,name:"role",render:({field:ge})=>u.jsxs(Dn,{children:[u.jsx(Ln,{children:"Role *"}),u.jsxs(Io,{onValueChange:ge.onChange,value:ge.value,children:[u.jsx(On,{children:u.jsx(mo,{children:u.jsx(Do,{placeholder:"Select a role"})})}),u.jsx(go,{children:TVe.map(Te=>u.jsx(_n,{value:Te.value,children:Te.label},Te.value))})]}),u.jsx(zn,{})]})}),u.jsxs("div",{className:"flex gap-4 pt-4",children:[u.jsx(Xr,{type:"submit",disabled:l,className:"w-auto px-8",children:l?u.jsxs(u.Fragment,{children:[u.jsx(Lf,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Nc,{className:"mr-2 h-4 w-4"}),"Update Account"]})}),u.jsx(Xr,{type:"button",variant:"outline",onClick:ee,disabled:l,className:"w-auto px-8",children:"Cancel"})]})]})})})]}),u.jsx(Sne,{open:E,onOpenChange:O,children:u.jsxs(A4,{children:[u.jsxs(T4,{children:[u.jsx(C4,{children:"Are you sure?"}),u.jsxs(E4,{children:["This action cannot be undone. This will permanently delete the account for"," ",u.jsxs("strong",{children:[F==null?void 0:F.firstName," ",F==null?void 0:F.lastName]}),"."]})]}),u.jsxs(P4,{children:[u.jsx(M4,{children:"Cancel"}),u.jsx(k4,{onClick:ne,disabled:l,className:"bg-red-600 hover:bg-red-700",children:l?u.jsxs(u.Fragment,{children:[u.jsx(Lf,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})})}const NN=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}],XG=[{value:"login",label:"Login"},{value:"logout",label:"Logout"},{value:"register",label:"Registration"},{value:"update",label:"Account Update"},{value:"delete",label:"Delete"},{value:"password_change",label:"Password Change"},{value:"otp_verified",label:"OTP Verification"},{value:"otp_sent",label:"OTP Sent"},{value:"otp_reset",label:"OTP Reset"},{value:"add_driver",label:"Add Driver"},{value:"add_vehicle",label:"Add Vehicle"},{value:"add_accident",label:"Add Accident"},{value:"add_violation",label:"Add Violation"},{value:"update_driver",label:"Update Driver"},{value:"update_vehicle",label:"Update Vehicle"},{value:"update_accident",label:"Update Accident"},{value:"update_violation",label:"Update Violation"},{value:"delete_driver",label:"Delete Driver"},{value:"delete_vehicle",label:"Delete Vehicle"},{value:"delete_accident",label:"Delete Accident"},{value:"delete_violation",label:"Delete Violation"}];function CVe(){const{userData:e}=la(),[t,r]=H.useState([]),[n,a]=H.useState(!1),[l,f]=H.useState(""),[i,_]=H.useState(""),[w,A]=H.useState(""),[E,O]=H.useState(null),[F,U]=H.useState(null),[B,q]=H.useState(1),[W,Z]=H.useState(1),[ne,ae]=H.useState(0),ee=async(_e=1)=>{var Ee,ke;try{a(!0);const Qe=new URLSearchParams({page:_e.toString(),limit:"10"});l&&Qe.append("email",l),w&&w!=="all"&&Qe.append("logType",w),E&&Qe.append("dateFrom",E.toISOString().split("T")[0]),F&&Qe.append("dateTo",F.toISOString().split("T")[0]),(e==null?void 0:e.role)==="1"?i&&i!=="all"?Qe.append("role",i):Qe.append("roles","1,2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?Qe.append("role",i):Qe.append("roles","0,1,2"));const Ze=await Wn.get(`/user/logs?${Qe}`);if(Ze.data.success){let Ge=Ze.data.logs;(e==null?void 0:e.role)==="1"?i&&i!=="all"?Ge=Ge.filter(Oe=>Oe.role===i):Ge=Ge.filter(Oe=>Oe.role==="1"||Oe.role==="2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?Ge=Ge.filter(Oe=>Oe.role===i):Ge=Ge.filter(Oe=>Oe.role==="0"||Oe.role==="1"||Oe.role==="2")),console.log("Raw logs from API:",Ze.data.logs),console.log("Filtered logs:",Ge),r(Ge),Z(Ze.data.totalPages),ae(Ge.length),q(_e)}}catch(Qe){const Ze=((ke=(Ee=Qe.response)==null?void 0:Ee.data)==null?void 0:ke.message)||"Failed to fetch logs";ki.error(Ze)}finally{a(!1)}};H.useEffect(()=>{ee()},[e]);const se=()=>{q(1),ee(1)},ce=()=>{f(""),_(""),A(""),O(null),U(null),q(1),ee(1)},ge=async()=>{try{const _e=new URLSearchParams;l&&_e.append("email",l),i&&_e.append("role",i),w&&_e.append("logType",w),E&&_e.append("dateFrom",E.toISOString().split("T")[0]),F&&_e.append("dateTo",F.toISOString().split("T")[0]);const Ee=await Wn.get(`/user/logs/export?${_e}`,{responseType:"blob"}),ke=window.URL.createObjectURL(new Blob([Ee.data])),Qe=document.createElement("a");Qe.href=ke,Qe.setAttribute("download",`account-logs-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(Qe),Qe.click(),Qe.remove(),window.URL.revokeObjectURL(ke),ki.success("Logs exported successfully!")}catch{ki.error("Failed to export logs")}},Te=_e=>{switch(_e){case"login":return"default";case"logout":return"secondary";case"register":return"outline";case"update":return"default";case"password_change":return"destructive";case"otp_verified":return"secondary";case"otp_sent":return"outline";case"otp_reset":return"destructive";case"add_driver":return"default";case"add_vehicle":return"default";case"add_accident":return"destructive";case"add_violation":return"destructive";case"update_driver":return"secondary";case"update_vehicle":return"secondary";case"update_accident":return"destructive";case"update_violation":return"destructive";case"delete_driver":return"destructive";case"delete_vehicle":return"destructive";case"delete_accident":return"destructive";case"delete_violation":return"destructive";default:return"outline"}},Ae=_e=>{switch(_e){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}};return u.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:u.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[u.jsx(wi,{children:u.jsxs(Ii,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(jv,{className:"h-6 w-6"}),u.jsx(Di,{children:"Account Logs"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(Xr,{onClick:ge,variant:"outline",size:"sm",children:[u.jsx(MW,{className:"mr-2 h-4 w-4"}),"Export Excel"]}),u.jsxs(Xr,{onClick:se,size:"sm",children:[u.jsx(tP,{className:"mr-2 h-4 w-4"}),"Search"]})]})]}),u.jsx(ls,{children:(e==null?void 0:e.role)==="0"?"View and monitor all account activities and system logs (Superadmin, Admin, and Employee)":"View and monitor admin and employee account activities and system logs"})]})}),u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(OW,{className:"h-5 w-5"}),u.jsx(Di,{className:"text-lg",children:"Filters"})]})}),u.jsx(Ei,{children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[u.jsx(Vn,{placeholder:"Search by email",value:l,onChange:_e=>f(_e.target.value),onKeyPress:_e=>_e.key==="Enter"&&se()}),u.jsxs(Io,{value:i,onValueChange:_,children:[u.jsx(mo,{children:u.jsx(Do,{placeholder:"Filter by role"})}),u.jsxs(go,{children:[u.jsx(_n,{value:"all",children:"All Roles"}),NN.filter(_e=>(e==null?void 0:e.role)==="1"?_e.value==="1"||_e.value==="2":(e==null?void 0:e.role)==="0"?_e.value==="0"||_e.value==="1"||_e.value==="2":!1).map(_e=>u.jsx(_n,{value:_e.value,children:_e.label},_e.value))]})]}),u.jsxs(Io,{value:w,onValueChange:A,children:[u.jsx(mo,{children:u.jsx(Do,{placeholder:"Filter by log type"})}),u.jsxs(go,{children:[u.jsx(_n,{value:"all",children:"All Types"}),XG.map(_e=>u.jsx(_n,{value:_e.value,children:_e.label},_e.value))]})]}),u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsxs(Xr,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[u.jsx(wd,{className:"mr-2 h-4 w-4"}),E?Fc(E,"MM/dd/yyyy"):"From date"]})}),u.jsx(Yg,{className:"w-auto p-0",align:"start",children:u.jsx(jw,{mode:"single",selected:E,onSelect:O,initialFocus:!0})})]}),u.jsxs(qv,{children:[u.jsx(Gv,{asChild:!0,children:u.jsxs(Xr,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[u.jsx(wd,{className:"mr-2 h-4 w-4"}),F?Fc(F,"MM/dd/yyyy"):"To date"]})}),u.jsx(Yg,{className:"w-auto p-0",align:"start",children:u.jsx(jw,{mode:"single",selected:F,onSelect:U,initialFocus:!0})})]}),u.jsx(Xr,{onClick:ce,variant:"outline",children:"Clear Filters"})]})})]}),u.jsxs(wi,{children:[u.jsx(Ii,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx(Di,{children:"Account Activity Logs"}),u.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total: ",ne," logs"]})]})}),u.jsx(Ei,{children:n?u.jsxs("div",{className:"flex items-center justify-center py-8",children:[u.jsx(Lf,{className:"h-8 w-8 animate-spin"}),u.jsx("span",{className:"ml-2",children:"Loading logs..."})]}):t.length===0?u.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No logs found matching your criteria"}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"rounded-md border",children:u.jsxs(oy,{children:[u.jsx(ly,{children:u.jsxs(Bs,{children:[u.jsx(Js,{children:"Performed By"}),u.jsx(Js,{children:"Timestamp"}),u.jsx(Js,{children:"User"}),u.jsx(Js,{children:"Email"}),u.jsx(Js,{children:"Role"}),u.jsx(Js,{children:"Activity"}),u.jsx(Js,{children:"Details"}),u.jsx(Js,{children:"IP Address"}),u.jsx(Js,{children:"Status"})]})}),u.jsx(cy,{children:t.map((_e,Ee)=>{var ke,Qe,Ze;return u.jsxs(Bs,{children:[u.jsx(Oa,{children:u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-medium text-sm",children:_e.actorName||"N/A"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:_e.actorEmail||""}),_e.actorRole&&u.jsx(eo,{variant:"outline",className:"w-fit mt-1",children:((ke=NN.find(Ge=>Ge.value===_e.actorRole))==null?void 0:ke.label)||"Unknown"})]})}),u.jsx(Oa,{children:new Date(_e.timestamp).toLocaleString()}),u.jsx(Oa,{children:_e.userName||"N/A"}),u.jsx(Oa,{children:_e.email}),u.jsx(Oa,{children:u.jsx(eo,{variant:Ae(_e.role),children:((Qe=NN.find(Ge=>Ge.value===_e.role))==null?void 0:Qe.label)||"Unknown"})}),u.jsx(Oa,{children:u.jsx(eo,{variant:Te(_e.logType),children:((Ze=XG.find(Ge=>Ge.value===_e.logType))==null?void 0:Ze.label)||_e.logType})}),u.jsx(Oa,{children:u.jsx("span",{className:"text-sm text-muted-foreground",children:_e.details||"N/A"})}),u.jsx(Oa,{children:u.jsx("span",{className:"font-mono text-sm",children:_e.ipAddress==="::1"||_e.ipAddress==="::ffff:127.0.0.1"?"127.0.0.1":_e.ipAddress||"N/A"})}),u.jsx(Oa,{children:u.jsx(eo,{variant:_e.status==="success"?"default":"destructive",children:_e.status})})]},Ee)})})]})}),W>1&&u.jsxs("div",{className:"flex items-center justify-between mt-4",children:[u.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",B," of ",W]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(Xr,{variant:"outline",size:"sm",onClick:()=>ee(B-1),disabled:B===1||n,children:"Previous"}),u.jsx(Xr,{variant:"outline",size:"sm",onClick:()=>ee(B+1),disabled:B===W||n,children:"Next"})]})]})]})})]})]})})}function EVe(){return u.jsxs(u.Fragment,{children:[u.jsx(roe,{closeButton:!0}),u.jsxs(Koe,{children:[u.jsx(Wa,{path:"/login",element:u.jsx(wve,{})}),u.jsx(Wa,{path:"/404",element:u.jsx(x6e,{})}),u.jsx(Wa,{path:"/",element:u.jsx(mBe,{allowedRoles:["superadmin","admin","employee"]}),children:u.jsxs(Wa,{element:u.jsx($Be,{}),children:[u.jsx(Wa,{index:!0,element:u.jsx(pBe,{})}),u.jsx(Wa,{path:"analytics/registration",element:u.jsx(tVe,{})}),u.jsx(Wa,{path:"analytics/violation",element:u.jsx(dVe,{})}),u.jsx(Wa,{path:"analytics/accident",element:u.jsx(_Ve,{})}),u.jsx(Wa,{path:"driver",element:u.jsx(g6e,{})}),u.jsx(Wa,{path:"driver/inactive",element:u.jsx(b6e,{})}),u.jsx(Wa,{path:"driver/:id",element:u.jsx(v6e,{})}),u.jsx(Wa,{path:"driver/:id/edit",element:u.jsx(_6e,{})}),u.jsx(Wa,{path:"vehicle",element:u.jsx(T6e,{})}),u.jsx(Wa,{path:"vehicle/:id",element:u.jsx(C6e,{})}),u.jsx(Wa,{path:"vehicle/:id/edit",element:u.jsx(E6e,{})}),u.jsx(Wa,{path:"violation",element:u.jsx(j6e,{})}),u.jsx(Wa,{path:"violation/:id",element:u.jsx(F6e,{})}),u.jsx(Wa,{path:"violation/:id/edit",element:u.jsx(B6e,{})}),u.jsx(Wa,{path:"accident",element:u.jsx(R6e,{})}),u.jsx(Wa,{path:"accident/:id",element:u.jsx(D6e,{})}),u.jsx(Wa,{path:"accident/:id/edit",element:u.jsx(L6e,{})}),u.jsx(Wa,{path:"account/register",element:u.jsx(MN,{allowedRoles:["admin","superadmin"],children:u.jsx(SVe,{})})}),u.jsx(Wa,{path:"account/update",element:u.jsx(MN,{allowedRoles:["admin","superadmin"],children:u.jsx(PVe,{})})}),u.jsx(Wa,{path:"account/logs",element:u.jsx(MN,{allowedRoles:["admin","superadmin"],children:u.jsx(CVe,{})})})]})}),u.jsx(Wa,{path:"*",element:u.jsx(T3,{to:"/404"})})]})]})}var XS={},JG;function kVe(){if(JG)return XS;JG=1;var e=QG();return XS.createRoot=e.createRoot,XS.hydrateRoot=e.hydrateRoot,XS}var MVe=kVe();const jVe=oa(MVe);jVe.createRoot(document.getElementById("root")).render(u.jsx(Re.StrictMode,{children:u.jsx(yle,{children:u.jsx(_ve,{children:u.jsx(qpe,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:u.jsx(EVe,{})})})})}));
