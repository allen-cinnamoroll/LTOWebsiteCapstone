function Foe(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var S2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ta(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var NC={exports:{}},Ob={},IC={exports:{}},Di={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H5;function Boe(){if(H5)return Di;H5=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),h=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),C=Symbol.iterator;function R(Je){return Je===null||typeof Je!="object"?null:(Je=C&&Je[C]||Je["@@iterator"],typeof Je=="function"?Je:null)}var z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,U={};function G(Je,ht,tt){this.props=Je,this.context=ht,this.refs=U,this.updater=tt||z}G.prototype.isReactComponent={},G.prototype.setState=function(Je,ht){if(typeof Je!="object"&&typeof Je!="function"&&Je!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Je,ht,"setState")},G.prototype.forceUpdate=function(Je){this.updater.enqueueForceUpdate(this,Je,"forceUpdate")};function H(){}H.prototype=G.prototype;function J(Je,ht,tt){this.props=Je,this.context=ht,this.refs=U,this.updater=tt||z}var Q=J.prototype=new H;Q.constructor=J,V(Q,G.prototype),Q.isPureReactComponent=!0;var le=Array.isArray,ne=Object.prototype.hasOwnProperty,de={current:null},ue={key:!0,ref:!0,__self:!0,__source:!0};function ve(Je,ht,tt){var Qt,gr={},sr=null,ur=null;if(ht!=null)for(Qt in ht.ref!==void 0&&(ur=ht.ref),ht.key!==void 0&&(sr=""+ht.key),ht)ne.call(ht,Qt)&&!ue.hasOwnProperty(Qt)&&(gr[Qt]=ht[Qt]);var br=arguments.length-2;if(br===1)gr.children=tt;else if(1<br){for(var Wt=Array(br),Be=0;Be<br;Be++)Wt[Be]=arguments[Be+2];gr.children=Wt}if(Je&&Je.defaultProps)for(Qt in br=Je.defaultProps,br)gr[Qt]===void 0&&(gr[Qt]=br[Qt]);return{$$typeof:e,type:Je,key:sr,ref:ur,props:gr,_owner:de.current}}function Ae(Je,ht){return{$$typeof:e,type:Je.type,key:ht,ref:Je.ref,props:Je.props,_owner:Je._owner}}function Oe(Je){return typeof Je=="object"&&Je!==null&&Je.$$typeof===e}function Se(Je){var ht={"=":"=0",":":"=2"};return"$"+Je.replace(/[=:]/g,function(tt){return ht[tt]})}var ke=/\/+/g;function ze(Je,ht){return typeof Je=="object"&&Je!==null&&Je.key!=null?Se(""+Je.key):ht.toString(36)}function et(Je,ht,tt,Qt,gr){var sr=typeof Je;(sr==="undefined"||sr==="boolean")&&(Je=null);var ur=!1;if(Je===null)ur=!0;else switch(sr){case"string":case"number":ur=!0;break;case"object":switch(Je.$$typeof){case e:case t:ur=!0}}if(ur)return ur=Je,gr=gr(ur),Je=Qt===""?"."+ze(ur,0):Qt,le(gr)?(tt="",Je!=null&&(tt=Je.replace(ke,"$&/")+"/"),et(gr,ht,tt,"",function(Be){return Be})):gr!=null&&(Oe(gr)&&(gr=Ae(gr,tt+(!gr.key||ur&&ur.key===gr.key?"":(""+gr.key).replace(ke,"$&/")+"/")+Je)),ht.push(gr)),1;if(ur=0,Qt=Qt===""?".":Qt+":",le(Je))for(var br=0;br<Je.length;br++){sr=Je[br];var Wt=Qt+ze(sr,br);ur+=et(sr,ht,tt,Wt,gr)}else if(Wt=R(Je),typeof Wt=="function")for(Je=Wt.call(Je),br=0;!(sr=Je.next()).done;)sr=sr.value,Wt=Qt+ze(sr,br++),ur+=et(sr,ht,tt,Wt,gr);else if(sr==="object")throw ht=String(Je),Error("Objects are not valid as a React child (found: "+(ht==="[object Object]"?"object with keys {"+Object.keys(Je).join(", ")+"}":ht)+"). If you meant to render a collection of children, use an array instead.");return ur}function je(Je,ht,tt){if(Je==null)return Je;var Qt=[],gr=0;return et(Je,Qt,"","",function(sr){return ht.call(tt,sr,gr++)}),Qt}function Ne(Je){if(Je._status===-1){var ht=Je._result;ht=ht(),ht.then(function(tt){(Je._status===0||Je._status===-1)&&(Je._status=1,Je._result=tt)},function(tt){(Je._status===0||Je._status===-1)&&(Je._status=2,Je._result=tt)}),Je._status===-1&&(Je._status=0,Je._result=ht)}if(Je._status===1)return Je._result.default;throw Je._result}var Ye={current:null},$e={transition:null},We={ReactCurrentDispatcher:Ye,ReactCurrentBatchConfig:$e,ReactCurrentOwner:de};function Et(){throw Error("act(...) is not supported in production builds of React.")}return Di.Children={map:je,forEach:function(Je,ht,tt){je(Je,function(){ht.apply(this,arguments)},tt)},count:function(Je){var ht=0;return je(Je,function(){ht++}),ht},toArray:function(Je){return je(Je,function(ht){return ht})||[]},only:function(Je){if(!Oe(Je))throw Error("React.Children.only expected to receive a single React element child.");return Je}},Di.Component=G,Di.Fragment=r,Di.Profiler=a,Di.PureComponent=J,Di.StrictMode=n,Di.Suspense=_,Di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=We,Di.act=Et,Di.cloneElement=function(Je,ht,tt){if(Je==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Je+".");var Qt=V({},Je.props),gr=Je.key,sr=Je.ref,ur=Je._owner;if(ht!=null){if(ht.ref!==void 0&&(sr=ht.ref,ur=de.current),ht.key!==void 0&&(gr=""+ht.key),Je.type&&Je.type.defaultProps)var br=Je.type.defaultProps;for(Wt in ht)ne.call(ht,Wt)&&!ue.hasOwnProperty(Wt)&&(Qt[Wt]=ht[Wt]===void 0&&br!==void 0?br[Wt]:ht[Wt])}var Wt=arguments.length-2;if(Wt===1)Qt.children=tt;else if(1<Wt){br=Array(Wt);for(var Be=0;Be<Wt;Be++)br[Be]=arguments[Be+2];Qt.children=br}return{$$typeof:e,type:Je.type,key:gr,ref:sr,props:Qt,_owner:ur}},Di.createContext=function(Je){return Je={$$typeof:h,_currentValue:Je,_currentValue2:Je,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Je.Provider={$$typeof:l,_context:Je},Je.Consumer=Je},Di.createElement=ve,Di.createFactory=function(Je){var ht=ve.bind(null,Je);return ht.type=Je,ht},Di.createRef=function(){return{current:null}},Di.forwardRef=function(Je){return{$$typeof:i,render:Je}},Di.isValidElement=Oe,Di.lazy=function(Je){return{$$typeof:A,_payload:{_status:-1,_result:Je},_init:Ne}},Di.memo=function(Je,ht){return{$$typeof:w,type:Je,compare:ht===void 0?null:ht}},Di.startTransition=function(Je){var ht=$e.transition;$e.transition={};try{Je()}finally{$e.transition=ht}},Di.unstable_act=Et,Di.useCallback=function(Je,ht){return Ye.current.useCallback(Je,ht)},Di.useContext=function(Je){return Ye.current.useContext(Je)},Di.useDebugValue=function(){},Di.useDeferredValue=function(Je){return Ye.current.useDeferredValue(Je)},Di.useEffect=function(Je,ht){return Ye.current.useEffect(Je,ht)},Di.useId=function(){return Ye.current.useId()},Di.useImperativeHandle=function(Je,ht,tt){return Ye.current.useImperativeHandle(Je,ht,tt)},Di.useInsertionEffect=function(Je,ht){return Ye.current.useInsertionEffect(Je,ht)},Di.useLayoutEffect=function(Je,ht){return Ye.current.useLayoutEffect(Je,ht)},Di.useMemo=function(Je,ht){return Ye.current.useMemo(Je,ht)},Di.useReducer=function(Je,ht,tt){return Ye.current.useReducer(Je,ht,tt)},Di.useRef=function(Je){return Ye.current.useRef(Je)},Di.useState=function(Je){return Ye.current.useState(Je)},Di.useSyncExternalStore=function(Je,ht,tt){return Ye.current.useSyncExternalStore(Je,ht,tt)},Di.useTransition=function(){return Ye.current.useTransition()},Di.version="18.3.1",Di}var Z5;function TD(){return Z5||(Z5=1,IC.exports=Boe()),IC.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y5;function Voe(){if(Y5)return Ob;Y5=1;var e=TD(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function h(i,_,w){var A,C={},R=null,z=null;w!==void 0&&(R=""+w),_.key!==void 0&&(R=""+_.key),_.ref!==void 0&&(z=_.ref);for(A in _)n.call(_,A)&&!l.hasOwnProperty(A)&&(C[A]=_[A]);if(i&&i.defaultProps)for(A in _=i.defaultProps,_)C[A]===void 0&&(C[A]=_[A]);return{$$typeof:t,type:i,key:R,ref:z,props:C,_owner:a.current}}return Ob.Fragment=r,Ob.jsx=h,Ob.jsxs=h,Ob}var X5;function Uoe(){return X5||(X5=1,NC.exports=Voe()),NC.exports}var f=Uoe(),K=TD();const Pe=ta(K),$oe=Foe({__proto__:null,default:Pe},[K]);var qoe=(e,t,r,n,a,l,h,i)=>{let _=document.documentElement,w=["light","dark"];function A(z){(Array.isArray(e)?e:[e]).forEach(V=>{let U=V==="class",G=U&&l?a.map(H=>l[H]||H):a;U?(_.classList.remove(...G),_.classList.add(l&&l[z]?l[z]:z)):_.setAttribute(V,z)}),C(z)}function C(z){i&&w.includes(z)&&(_.style.colorScheme=z)}function R(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)A(n);else try{let z=localStorage.getItem(t)||r,V=h&&z==="system"?R():z;A(V)}catch{}},Goe=K.createContext(void 0),Koe={setTheme:e=>{},themes:[]},Woe=()=>{var e;return(e=K.useContext(Goe))!=null?e:Koe};K.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:l,value:h,themes:i,nonce:_,scriptProps:w})=>{let A=JSON.stringify([r,t,l,e,i,h,n,a]).slice(1,-1);return K.createElement("script",{...w,suppressHydrationWarning:!0,nonce:typeof window>"u"?_:"",dangerouslySetInnerHTML:{__html:`(${qoe.toString()})(${A})`}})});var DC={exports:{}},Oc={},LC={exports:{}},zC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J5;function Hoe(){return J5||(J5=1,function(e){function t($e,We){var Et=$e.length;$e.push(We);e:for(;0<Et;){var Je=Et-1>>>1,ht=$e[Je];if(0<a(ht,We))$e[Je]=We,$e[Et]=ht,Et=Je;else break e}}function r($e){return $e.length===0?null:$e[0]}function n($e){if($e.length===0)return null;var We=$e[0],Et=$e.pop();if(Et!==We){$e[0]=Et;e:for(var Je=0,ht=$e.length,tt=ht>>>1;Je<tt;){var Qt=2*(Je+1)-1,gr=$e[Qt],sr=Qt+1,ur=$e[sr];if(0>a(gr,Et))sr<ht&&0>a(ur,gr)?($e[Je]=ur,$e[sr]=Et,Je=sr):($e[Je]=gr,$e[Qt]=Et,Je=Qt);else if(sr<ht&&0>a(ur,Et))$e[Je]=ur,$e[sr]=Et,Je=sr;else break e}}return We}function a($e,We){var Et=$e.sortIndex-We.sortIndex;return Et!==0?Et:$e.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var h=Date,i=h.now();e.unstable_now=function(){return h.now()-i}}var _=[],w=[],A=1,C=null,R=3,z=!1,V=!1,U=!1,G=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q($e){for(var We=r(w);We!==null;){if(We.callback===null)n(w);else if(We.startTime<=$e)n(w),We.sortIndex=We.expirationTime,t(_,We);else break;We=r(w)}}function le($e){if(U=!1,Q($e),!V)if(r(_)!==null)V=!0,Ne(ne);else{var We=r(w);We!==null&&Ye(le,We.startTime-$e)}}function ne($e,We){V=!1,U&&(U=!1,H(ve),ve=-1),z=!0;var Et=R;try{for(Q(We),C=r(_);C!==null&&(!(C.expirationTime>We)||$e&&!Se());){var Je=C.callback;if(typeof Je=="function"){C.callback=null,R=C.priorityLevel;var ht=Je(C.expirationTime<=We);We=e.unstable_now(),typeof ht=="function"?C.callback=ht:C===r(_)&&n(_),Q(We)}else n(_);C=r(_)}if(C!==null)var tt=!0;else{var Qt=r(w);Qt!==null&&Ye(le,Qt.startTime-We),tt=!1}return tt}finally{C=null,R=Et,z=!1}}var de=!1,ue=null,ve=-1,Ae=5,Oe=-1;function Se(){return!(e.unstable_now()-Oe<Ae)}function ke(){if(ue!==null){var $e=e.unstable_now();Oe=$e;var We=!0;try{We=ue(!0,$e)}finally{We?ze():(de=!1,ue=null)}}else de=!1}var ze;if(typeof J=="function")ze=function(){J(ke)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,je=et.port2;et.port1.onmessage=ke,ze=function(){je.postMessage(null)}}else ze=function(){G(ke,0)};function Ne($e){ue=$e,de||(de=!0,ze())}function Ye($e,We){ve=G(function(){$e(e.unstable_now())},We)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($e){$e.callback=null},e.unstable_continueExecution=function(){V||z||(V=!0,Ne(ne))},e.unstable_forceFrameRate=function($e){0>$e||125<$e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ae=0<$e?Math.floor(1e3/$e):5},e.unstable_getCurrentPriorityLevel=function(){return R},e.unstable_getFirstCallbackNode=function(){return r(_)},e.unstable_next=function($e){switch(R){case 1:case 2:case 3:var We=3;break;default:We=R}var Et=R;R=We;try{return $e()}finally{R=Et}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($e,We){switch($e){case 1:case 2:case 3:case 4:case 5:break;default:$e=3}var Et=R;R=$e;try{return We()}finally{R=Et}},e.unstable_scheduleCallback=function($e,We,Et){var Je=e.unstable_now();switch(typeof Et=="object"&&Et!==null?(Et=Et.delay,Et=typeof Et=="number"&&0<Et?Je+Et:Je):Et=Je,$e){case 1:var ht=-1;break;case 2:ht=250;break;case 5:ht=1073741823;break;case 4:ht=1e4;break;default:ht=5e3}return ht=Et+ht,$e={id:A++,callback:We,priorityLevel:$e,startTime:Et,expirationTime:ht,sortIndex:-1},Et>Je?($e.sortIndex=Et,t(w,$e),r(_)===null&&$e===r(w)&&(U?(H(ve),ve=-1):U=!0,Ye(le,Et-Je))):($e.sortIndex=ht,t(_,$e),V||z||(V=!0,Ne(ne))),$e},e.unstable_shouldYield=Se,e.unstable_wrapCallback=function($e){var We=R;return function(){var Et=R;R=We;try{return $e.apply(this,arguments)}finally{R=Et}}}}(zC)),zC}var Q5;function Zoe(){return Q5||(Q5=1,LC.exports=Hoe()),LC.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eB;function Yoe(){if(eB)return Oc;eB=1;var e=TD(),t=Zoe();function r(b){for(var T="https://reactjs.org/docs/error-decoder.html?invariant="+b,B=1;B<arguments.length;B++)T+="&args[]="+encodeURIComponent(arguments[B]);return"Minified React error #"+b+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(b,T){h(b,T),h(b+"Capture",T)}function h(b,T){for(a[b]=T,b=0;b<T.length;b++)n.add(T[b])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A={},C={};function R(b){return _.call(C,b)?!0:_.call(A,b)?!1:w.test(b)?C[b]=!0:(A[b]=!0,!1)}function z(b,T,B,X){if(B!==null&&B.type===0)return!1;switch(typeof T){case"function":case"symbol":return!0;case"boolean":return X?!1:B!==null?!B.acceptsBooleans:(b=b.toLowerCase().slice(0,5),b!=="data-"&&b!=="aria-");default:return!1}}function V(b,T,B,X){if(T===null||typeof T>"u"||z(b,T,B,X))return!0;if(X)return!1;if(B!==null)switch(B.type){case 3:return!T;case 4:return T===!1;case 5:return isNaN(T);case 6:return isNaN(T)||1>T}return!1}function U(b,T,B,X,ce,pe,Le){this.acceptsBooleans=T===2||T===3||T===4,this.attributeName=X,this.attributeNamespace=ce,this.mustUseProperty=B,this.propertyName=b,this.type=T,this.sanitizeURL=pe,this.removeEmptyString=Le}var G={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(b){G[b]=new U(b,0,!1,b,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(b){var T=b[0];G[T]=new U(T,1,!1,b[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(b){G[b]=new U(b,2,!1,b.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(b){G[b]=new U(b,2,!1,b,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(b){G[b]=new U(b,3,!1,b.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(b){G[b]=new U(b,3,!0,b,null,!1,!1)}),["capture","download"].forEach(function(b){G[b]=new U(b,4,!1,b,null,!1,!1)}),["cols","rows","size","span"].forEach(function(b){G[b]=new U(b,6,!1,b,null,!1,!1)}),["rowSpan","start"].forEach(function(b){G[b]=new U(b,5,!1,b.toLowerCase(),null,!1,!1)});var H=/[\-:]([a-z])/g;function J(b){return b[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(b){var T=b.replace(H,J);G[T]=new U(T,1,!1,b,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(b){var T=b.replace(H,J);G[T]=new U(T,1,!1,b,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(b){var T=b.replace(H,J);G[T]=new U(T,1,!1,b,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(b){G[b]=new U(b,1,!1,b.toLowerCase(),null,!1,!1)}),G.xlinkHref=new U("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(b){G[b]=new U(b,1,!1,b.toLowerCase(),null,!0,!0)});function Q(b,T,B,X){var ce=G.hasOwnProperty(T)?G[T]:null;(ce!==null?ce.type!==0:X||!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&(V(T,B,ce,X)&&(B=null),X||ce===null?R(T)&&(B===null?b.removeAttribute(T):b.setAttribute(T,""+B)):ce.mustUseProperty?b[ce.propertyName]=B===null?ce.type===3?!1:"":B:(T=ce.attributeName,X=ce.attributeNamespace,B===null?b.removeAttribute(T):(ce=ce.type,B=ce===3||ce===4&&B===!0?"":""+B,X?b.setAttributeNS(X,T,B):b.setAttribute(T,B))))}var le=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ne=Symbol.for("react.element"),de=Symbol.for("react.portal"),ue=Symbol.for("react.fragment"),ve=Symbol.for("react.strict_mode"),Ae=Symbol.for("react.profiler"),Oe=Symbol.for("react.provider"),Se=Symbol.for("react.context"),ke=Symbol.for("react.forward_ref"),ze=Symbol.for("react.suspense"),et=Symbol.for("react.suspense_list"),je=Symbol.for("react.memo"),Ne=Symbol.for("react.lazy"),Ye=Symbol.for("react.offscreen"),$e=Symbol.iterator;function We(b){return b===null||typeof b!="object"?null:(b=$e&&b[$e]||b["@@iterator"],typeof b=="function"?b:null)}var Et=Object.assign,Je;function ht(b){if(Je===void 0)try{throw Error()}catch(B){var T=B.stack.trim().match(/\n( *(at )?)/);Je=T&&T[1]||""}return`
`+Je+b}var tt=!1;function Qt(b,T){if(!b||tt)return"";tt=!0;var B=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(T)if(T=function(){throw Error()},Object.defineProperty(T.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(T,[])}catch(Ht){var X=Ht}Reflect.construct(b,[],T)}else{try{T.call()}catch(Ht){X=Ht}b.call(T.prototype)}else{try{throw Error()}catch(Ht){X=Ht}b()}}catch(Ht){if(Ht&&X&&typeof Ht.stack=="string"){for(var ce=Ht.stack.split(`
`),pe=X.stack.split(`
`),Le=ce.length-1,gt=pe.length-1;1<=Le&&0<=gt&&ce[Le]!==pe[gt];)gt--;for(;1<=Le&&0<=gt;Le--,gt--)if(ce[Le]!==pe[gt]){if(Le!==1||gt!==1)do if(Le--,gt--,0>gt||ce[Le]!==pe[gt]){var At=`
`+ce[Le].replace(" at new "," at ");return b.displayName&&At.includes("<anonymous>")&&(At=At.replace("<anonymous>",b.displayName)),At}while(1<=Le&&0<=gt);break}}}finally{tt=!1,Error.prepareStackTrace=B}return(b=b?b.displayName||b.name:"")?ht(b):""}function gr(b){switch(b.tag){case 5:return ht(b.type);case 16:return ht("Lazy");case 13:return ht("Suspense");case 19:return ht("SuspenseList");case 0:case 2:case 15:return b=Qt(b.type,!1),b;case 11:return b=Qt(b.type.render,!1),b;case 1:return b=Qt(b.type,!0),b;default:return""}}function sr(b){if(b==null)return null;if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case ue:return"Fragment";case de:return"Portal";case Ae:return"Profiler";case ve:return"StrictMode";case ze:return"Suspense";case et:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case Se:return(b.displayName||"Context")+".Consumer";case Oe:return(b._context.displayName||"Context")+".Provider";case ke:var T=b.render;return b=b.displayName,b||(b=T.displayName||T.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case je:return T=b.displayName||null,T!==null?T:sr(b.type)||"Memo";case Ne:T=b._payload,b=b._init;try{return sr(b(T))}catch{}}return null}function ur(b){var T=b.type;switch(b.tag){case 24:return"Cache";case 9:return(T.displayName||"Context")+".Consumer";case 10:return(T._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return b=T.render,b=b.displayName||b.name||"",T.displayName||(b!==""?"ForwardRef("+b+")":"ForwardRef");case 7:return"Fragment";case 5:return T;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sr(T);case 8:return T===ve?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T}return null}function br(b){switch(typeof b){case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function Wt(b){var T=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(T==="checkbox"||T==="radio")}function Be(b){var T=Wt(b)?"checked":"value",B=Object.getOwnPropertyDescriptor(b.constructor.prototype,T),X=""+b[T];if(!b.hasOwnProperty(T)&&typeof B<"u"&&typeof B.get=="function"&&typeof B.set=="function"){var ce=B.get,pe=B.set;return Object.defineProperty(b,T,{configurable:!0,get:function(){return ce.call(this)},set:function(Le){X=""+Le,pe.call(this,Le)}}),Object.defineProperty(b,T,{enumerable:B.enumerable}),{getValue:function(){return X},setValue:function(Le){X=""+Le},stopTracking:function(){b._valueTracker=null,delete b[T]}}}}function Nr(b){b._valueTracker||(b._valueTracker=Be(b))}function Jt(b){if(!b)return!1;var T=b._valueTracker;if(!T)return!0;var B=T.getValue(),X="";return b&&(X=Wt(b)?b.checked?"true":"false":b.value),b=X,b!==B?(T.setValue(b),!0):!1}function Sn(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}function It(b,T){var B=T.checked;return Et({},T,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:B??b._wrapperState.initialChecked})}function Vn(b,T){var B=T.defaultValue==null?"":T.defaultValue,X=T.checked!=null?T.checked:T.defaultChecked;B=br(T.value!=null?T.value:B),b._wrapperState={initialChecked:X,initialValue:B,controlled:T.type==="checkbox"||T.type==="radio"?T.checked!=null:T.value!=null}}function Un(b,T){T=T.checked,T!=null&&Q(b,"checked",T,!1)}function Xr(b,T){Un(b,T);var B=br(T.value),X=T.type;if(B!=null)X==="number"?(B===0&&b.value===""||b.value!=B)&&(b.value=""+B):b.value!==""+B&&(b.value=""+B);else if(X==="submit"||X==="reset"){b.removeAttribute("value");return}T.hasOwnProperty("value")?Ot(b,T.type,B):T.hasOwnProperty("defaultValue")&&Ot(b,T.type,br(T.defaultValue)),T.checked==null&&T.defaultChecked!=null&&(b.defaultChecked=!!T.defaultChecked)}function rt(b,T,B){if(T.hasOwnProperty("value")||T.hasOwnProperty("defaultValue")){var X=T.type;if(!(X!=="submit"&&X!=="reset"||T.value!==void 0&&T.value!==null))return;T=""+b._wrapperState.initialValue,B||T===b.value||(b.value=T),b.defaultValue=T}B=b.name,B!==""&&(b.name=""),b.defaultChecked=!!b._wrapperState.initialChecked,B!==""&&(b.name=B)}function Ot(b,T,B){(T!=="number"||Sn(b.ownerDocument)!==b)&&(B==null?b.defaultValue=""+b._wrapperState.initialValue:b.defaultValue!==""+B&&(b.defaultValue=""+B))}var Kt=Array.isArray;function Pr(b,T,B,X){if(b=b.options,T){T={};for(var ce=0;ce<B.length;ce++)T["$"+B[ce]]=!0;for(B=0;B<b.length;B++)ce=T.hasOwnProperty("$"+b[B].value),b[B].selected!==ce&&(b[B].selected=ce),ce&&X&&(b[B].defaultSelected=!0)}else{for(B=""+br(B),T=null,ce=0;ce<b.length;ce++){if(b[ce].value===B){b[ce].selected=!0,X&&(b[ce].defaultSelected=!0);return}T!==null||b[ce].disabled||(T=b[ce])}T!==null&&(T.selected=!0)}}function yr(b,T){if(T.dangerouslySetInnerHTML!=null)throw Error(r(91));return Et({},T,{value:void 0,defaultValue:void 0,children:""+b._wrapperState.initialValue})}function wr(b,T){var B=T.value;if(B==null){if(B=T.children,T=T.defaultValue,B!=null){if(T!=null)throw Error(r(92));if(Kt(B)){if(1<B.length)throw Error(r(93));B=B[0]}T=B}T==null&&(T=""),B=T}b._wrapperState={initialValue:br(B)}}function dr(b,T){var B=br(T.value),X=br(T.defaultValue);B!=null&&(B=""+B,B!==b.value&&(b.value=B),T.defaultValue==null&&b.defaultValue!==B&&(b.defaultValue=B)),X!=null&&(b.defaultValue=""+X)}function An(b){var T=b.textContent;T===b._wrapperState.initialValue&&T!==""&&T!==null&&(b.value=T)}function Ti(b){switch(b){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bi(b,T){return b==null||b==="http://www.w3.org/1999/xhtml"?Ti(T):b==="http://www.w3.org/2000/svg"&&T==="foreignObject"?"http://www.w3.org/1999/xhtml":b}var Vi,is=function(b){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(T,B,X,ce){MSApp.execUnsafeLocalFunction(function(){return b(T,B,X,ce)})}:b}(function(b,T){if(b.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in b)b.innerHTML=T;else{for(Vi=Vi||document.createElement("div"),Vi.innerHTML="<svg>"+T.valueOf().toString()+"</svg>",T=Vi.firstChild;b.firstChild;)b.removeChild(b.firstChild);for(;T.firstChild;)b.appendChild(T.firstChild)}});function $a(b,T){if(T){var B=b.firstChild;if(B&&B===b.lastChild&&B.nodeType===3){B.nodeValue=T;return}}b.textContent=T}var Vo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ys=["Webkit","ms","Moz","O"];Object.keys(Vo).forEach(function(b){ys.forEach(function(T){T=T+b.charAt(0).toUpperCase()+b.substring(1),Vo[T]=Vo[b]})});function Qa(b,T,B){return T==null||typeof T=="boolean"||T===""?"":B||typeof T!="number"||T===0||Vo.hasOwnProperty(b)&&Vo[b]?(""+T).trim():T+"px"}function $l(b,T){b=b.style;for(var B in T)if(T.hasOwnProperty(B)){var X=B.indexOf("--")===0,ce=Qa(B,T[B],X);B==="float"&&(B="cssFloat"),X?b.setProperty(B,ce):b[B]=ce}}var _l=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jo(b,T){if(T){if(_l[b]&&(T.children!=null||T.dangerouslySetInnerHTML!=null))throw Error(r(137,b));if(T.dangerouslySetInnerHTML!=null){if(T.children!=null)throw Error(r(60));if(typeof T.dangerouslySetInnerHTML!="object"||!("__html"in T.dangerouslySetInnerHTML))throw Error(r(61))}if(T.style!=null&&typeof T.style!="object")throw Error(r(62))}}function ql(b,T){if(b.indexOf("-")===-1)return typeof T.is=="string";switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rn=null;function eo(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var ku=null,qa=null,Uo=null;function Kn(b){if(b=qd(b)){if(typeof ku!="function")throw Error(r(280));var T=b.stateNode;T&&(T=cf(T),ku(b.stateNode,b.type,T))}}function fa(b){qa?Uo?Uo.push(b):Uo=[b]:qa=b}function Ca(){if(qa){var b=qa,T=Uo;if(Uo=qa=null,Kn(b),T)for(b=0;b<T.length;b++)Kn(T[b])}}function wo(b,T){return b(T)}function xl(){}var Ma=!1;function No(b,T,B){if(Ma)return b(T,B);Ma=!0;try{return wo(b,T,B)}finally{Ma=!1,(qa!==null||Uo!==null)&&(xl(),Ca())}}function Ui(b,T){var B=b.stateNode;if(B===null)return null;var X=cf(B);if(X===null)return null;B=X[T];e:switch(T){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(X=!X.disabled)||(b=b.type,X=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!X;break e;default:b=!1}if(b)return null;if(B&&typeof B!="function")throw Error(r(231,T,typeof B));return B}var So=!1;if(i)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){So=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{So=!1}function ju(b,T,B,X,ce,pe,Le,gt,At){var Ht=Array.prototype.slice.call(arguments,3);try{T.apply(B,Ht)}catch(Ar){this.onError(Ar)}}var Wi=!1,Ds=null,wt=!1,ge=null,we={onError:function(b){Wi=!0,Ds=b}};function Te(b,T,B,X,ce,pe,Le,gt,At){Wi=!1,Ds=null,ju.apply(we,arguments)}function Ge(b,T,B,X,ce,pe,Le,gt,At){if(Te.apply(this,arguments),Wi){if(Wi){var Ht=Ds;Wi=!1,Ds=null}else throw Error(r(198));wt||(wt=!0,ge=Ht)}}function He(b){var T=b,B=b;if(b.alternate)for(;T.return;)T=T.return;else{b=T;do T=b,(T.flags&4098)!==0&&(B=T.return),b=T.return;while(b)}return T.tag===3?B:null}function at(b){if(b.tag===13){var T=b.memoizedState;if(T===null&&(b=b.alternate,b!==null&&(T=b.memoizedState)),T!==null)return T.dehydrated}return null}function mt(b){if(He(b)!==b)throw Error(r(188))}function st(b){var T=b.alternate;if(!T){if(T=He(b),T===null)throw Error(r(188));return T!==b?null:b}for(var B=b,X=T;;){var ce=B.return;if(ce===null)break;var pe=ce.alternate;if(pe===null){if(X=ce.return,X!==null){B=X;continue}break}if(ce.child===pe.child){for(pe=ce.child;pe;){if(pe===B)return mt(ce),b;if(pe===X)return mt(ce),T;pe=pe.sibling}throw Error(r(188))}if(B.return!==X.return)B=ce,X=pe;else{for(var Le=!1,gt=ce.child;gt;){if(gt===B){Le=!0,B=ce,X=pe;break}if(gt===X){Le=!0,X=ce,B=pe;break}gt=gt.sibling}if(!Le){for(gt=pe.child;gt;){if(gt===B){Le=!0,B=pe,X=ce;break}if(gt===X){Le=!0,X=pe,B=ce;break}gt=gt.sibling}if(!Le)throw Error(r(189))}}if(B.alternate!==X)throw Error(r(190))}if(B.tag!==3)throw Error(r(188));return B.stateNode.current===B?b:T}function bt(b){return b=st(b),b!==null?xt(b):null}function xt(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){var T=xt(b);if(T!==null)return T;b=b.sibling}return null}var St=t.unstable_scheduleCallback,Lt=t.unstable_cancelCallback,tr=t.unstable_shouldYield,nr=t.unstable_requestPaint,Sr=t.unstable_now,Vr=t.unstable_getCurrentPriorityLevel,Br=t.unstable_ImmediatePriority,Fr=t.unstable_UserBlockingPriority,Tn=t.unstable_NormalPriority,Hn=t.unstable_LowPriority,vn=t.unstable_IdlePriority,$n=null,Pn=null;function Oa(b){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot($n,b,void 0,(b.current.flags&128)===128)}catch{}}var ho=Math.clz32?Math.clz32:as,Ga=Math.log,to=Math.LN2;function as(b){return b>>>=0,b===0?32:31-(Ga(b)/to|0)|0}var Nu=64,bl=4194304;function $c(b){switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return b&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return b}}function Hh(b,T){var B=b.pendingLanes;if(B===0)return 0;var X=0,ce=b.suspendedLanes,pe=b.pingedLanes,Le=B&268435455;if(Le!==0){var gt=Le&~ce;gt!==0?X=$c(gt):(pe&=Le,pe!==0&&(X=$c(pe)))}else Le=B&~ce,Le!==0?X=$c(Le):pe!==0&&(X=$c(pe));if(X===0)return 0;if(T!==0&&T!==X&&(T&ce)===0&&(ce=X&-X,pe=T&-T,ce>=pe||ce===16&&(pe&4194240)!==0))return T;if((X&4)!==0&&(X|=B&16),T=b.entangledLanes,T!==0)for(b=b.entanglements,T&=X;0<T;)B=31-ho(T),ce=1<<B,X|=b[B],T&=~ce;return X}function Qv(b,T){switch(b){case 1:case 2:case 4:return T+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ay(b,T){for(var B=b.suspendedLanes,X=b.pingedLanes,ce=b.expirationTimes,pe=b.pendingLanes;0<pe;){var Le=31-ho(pe),gt=1<<Le,At=ce[Le];At===-1?((gt&B)===0||(gt&X)!==0)&&(ce[Le]=Qv(gt,T)):At<=T&&(b.expiredLanes|=gt),pe&=~gt}}function np(b){return b=b.pendingLanes&-1073741825,b!==0?b:b&1073741824?1073741824:0}function $o(){var b=Nu;return Nu<<=1,(Nu&4194240)===0&&(Nu=64),b}function il(b){for(var T=[],B=0;31>B;B++)T.push(b);return T}function al(b,T,B){b.pendingLanes|=T,T!==536870912&&(b.suspendedLanes=0,b.pingedLanes=0),b=b.eventTimes,T=31-ho(T),b[T]=B}function dc(b,T){var B=b.pendingLanes&~T;b.pendingLanes=T,b.suspendedLanes=0,b.pingedLanes=0,b.expiredLanes&=T,b.mutableReadLanes&=T,b.entangledLanes&=T,T=b.entanglements;var X=b.eventTimes;for(b=b.expirationTimes;0<B;){var ce=31-ho(B),pe=1<<ce;T[ce]=0,X[ce]=-1,b[ce]=-1,B&=~pe}}function ol(b,T){var B=b.entangledLanes|=T;for(b=b.entanglements;B;){var X=31-ho(B),ce=1<<X;ce&T|b[X]&T&&(b[X]|=T),B&=~ce}}var yi=0;function ip(b){return b&=-b,1<b?4<b?(b&268435455)!==0?16:536870912:4:1}var wm,hc,qc,oy,Sm,Ls=!1,Jn=[],fc=null,Dr=null,Gc=null,Iu=new Map,Du=new Map,dn=[],Am="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lu(b,T){switch(b){case"focusin":case"focusout":fc=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Gc=null;break;case"pointerover":case"pointerout":Iu.delete(T.pointerId);break;case"gotpointercapture":case"lostpointercapture":Du.delete(T.pointerId)}}function _r(b,T,B,X,ce,pe){return b===null||b.nativeEvent!==pe?(b={blockedOn:T,domEventName:B,eventSystemFlags:X,nativeEvent:pe,targetContainers:[ce]},T!==null&&(T=qd(T),T!==null&&hc(T)),b):(b.eventSystemFlags|=X,T=b.targetContainers,ce!==null&&T.indexOf(ce)===-1&&T.push(ce),b)}function pi(b,T,B,X,ce){switch(T){case"focusin":return fc=_r(fc,b,T,B,X,ce),!0;case"dragenter":return Dr=_r(Dr,b,T,B,X,ce),!0;case"mouseover":return Gc=_r(Gc,b,T,B,X,ce),!0;case"pointerover":var pe=ce.pointerId;return Iu.set(pe,_r(Iu.get(pe)||null,b,T,B,X,ce)),!0;case"gotpointercapture":return pe=ce.pointerId,Du.set(pe,_r(Du.get(pe)||null,b,T,B,X,ce)),!0}return!1}function Wn(b){var T=Hu(b.target);if(T!==null){var B=He(T);if(B!==null){if(T=B.tag,T===13){if(T=at(B),T!==null){b.blockedOn=T,Sm(b.priority,function(){qc(B)});return}}else if(T===3&&B.stateNode.current.memoizedState.isDehydrated){b.blockedOn=B.tag===3?B.stateNode.containerInfo:null;return}}}b.blockedOn=null}function fo(b){if(b.blockedOn!==null)return!1;for(var T=b.targetContainers;0<T.length;){var B=kd(b.domEventName,b.eventSystemFlags,T[0],b.nativeEvent);if(B===null){B=b.nativeEvent;var X=new B.constructor(B.type,B);rn=X,B.target.dispatchEvent(X),rn=null}else return T=qd(B),T!==null&&hc(T),b.blockedOn=B,!1;T.shift()}return!0}function pc(b,T,B){fo(b)&&B.delete(T)}function ai(){Ls=!1,fc!==null&&fo(fc)&&(fc=null),Dr!==null&&fo(Dr)&&(Dr=null),Gc!==null&&fo(Gc)&&(Gc=null),Iu.forEach(pc),Du.forEach(pc)}function Kc(b,T){b.blockedOn===T&&(b.blockedOn=null,Ls||(Ls=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ai)))}function zs(b){function T(ce){return Kc(ce,b)}if(0<Jn.length){Kc(Jn[0],b);for(var B=1;B<Jn.length;B++){var X=Jn[B];X.blockedOn===b&&(X.blockedOn=null)}}for(fc!==null&&Kc(fc,b),Dr!==null&&Kc(Dr,b),Gc!==null&&Kc(Gc,b),Iu.forEach(T),Du.forEach(T),B=0;B<dn.length;B++)X=dn[B],X.blockedOn===b&&(X.blockedOn=null);for(;0<dn.length&&(B=dn[0],B.blockedOn===null);)Wn(B),B.blockedOn===null&&dn.shift()}var mc=le.ReactCurrentBatchConfig,Ka=!0;function pa(b,T,B,X){var ce=yi,pe=mc.transition;mc.transition=null;try{yi=1,qo(b,T,B,X)}finally{yi=ce,mc.transition=pe}}function sy(b,T,B,X){var ce=yi,pe=mc.transition;mc.transition=null;try{yi=4,qo(b,T,B,X)}finally{yi=ce,mc.transition=pe}}function qo(b,T,B,X){if(Ka){var ce=kd(b,T,B,X);if(ce===null)Bd(b,T,X,Rd,B),Lu(b,X);else if(pi(ce,b,T,B,X))X.stopPropagation();else if(Lu(b,X),T&4&&-1<Am.indexOf(b)){for(;ce!==null;){var pe=qd(ce);if(pe!==null&&wm(pe),pe=kd(b,T,B,X),pe===null&&Bd(b,T,X,Rd,B),pe===ce)break;ce=pe}ce!==null&&X.stopPropagation()}else Bd(b,T,X,null,B)}}var Rd=null;function kd(b,T,B,X){if(Rd=null,b=eo(X),b=Hu(b),b!==null)if(T=He(b),T===null)b=null;else if(B=T.tag,B===13){if(b=at(T),b!==null)return b;b=null}else if(B===3){if(T.stateNode.current.memoizedState.isDehydrated)return T.tag===3?T.stateNode.containerInfo:null;b=null}else T!==b&&(b=null);return Rd=b,null}function ap(b){switch(b){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vr()){case Br:return 1;case Fr:return 4;case Tn:case Hn:return 16;case vn:return 536870912;default:return 16}default:return 16}}var wl=null,Ao=null,sl=null;function To(){if(sl)return sl;var b,T=Ao,B=T.length,X,ce="value"in wl?wl.value:wl.textContent,pe=ce.length;for(b=0;b<B&&T[b]===ce[b];b++);var Le=B-b;for(X=1;X<=Le&&T[B-X]===ce[pe-X];X++);return sl=ce.slice(b,1<X?1-X:void 0)}function Zh(b){var T=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&T===13&&(b=13)):b=T,b===10&&(b=13),32<=b||b===13?b:0}function Sl(){return!0}function na(){return!1}function Ra(b){function T(B,X,ce,pe,Le){this._reactName=B,this._targetInst=ce,this.type=X,this.nativeEvent=pe,this.target=Le,this.currentTarget=null;for(var gt in b)b.hasOwnProperty(gt)&&(B=b[gt],this[gt]=B?B(pe):pe[gt]);return this.isDefaultPrevented=(pe.defaultPrevented!=null?pe.defaultPrevented:pe.returnValue===!1)?Sl:na,this.isPropagationStopped=na,this}return Et(T.prototype,{preventDefault:function(){this.defaultPrevented=!0;var B=this.nativeEvent;B&&(B.preventDefault?B.preventDefault():typeof B.returnValue!="unknown"&&(B.returnValue=!1),this.isDefaultPrevented=Sl)},stopPropagation:function(){var B=this.nativeEvent;B&&(B.stopPropagation?B.stopPropagation():typeof B.cancelBubble!="unknown"&&(B.cancelBubble=!0),this.isPropagationStopped=Sl)},persist:function(){},isPersistent:Sl}),T}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ma=Ra(ka),Wc=Et({},ka,{view:0,detail:0}),Gl=Ra(Wc),Hc,jd,vs,Yh=Et({},Wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kl,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==vs&&(vs&&b.type==="mousemove"?(Hc=b.screenX-vs.screenX,jd=b.screenY-vs.screenY):jd=Hc=0,vs=b),Hc)},movementY:function(b){return"movementY"in b?b.movementY:jd}}),gc=Ra(Yh),z0=Et({},Yh,{dataTransfer:0}),ly=Ra(z0),_s=Et({},Wc,{relatedTarget:0}),op=Ra(_s),Tm=Et({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),sp=Ra(Tm),lp=Et({},ka,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),F0=Ra(lp),B0=Et({},ka,{data:0}),Xh=Ra(B0),cp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},V0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cy(b){var T=this.nativeEvent;return T.getModifierState?T.getModifierState(b):(b=Jh[b])?!!T[b]:!1}function Kl(){return cy}var zu=Et({},Wc,{key:function(b){if(b.key){var T=cp[b.key]||b.key;if(T!=="Unidentified")return T}return b.type==="keypress"?(b=Zh(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?V0[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kl,charCode:function(b){return b.type==="keypress"?Zh(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?Zh(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),U0=Ra(zu),uy=Et({},Yh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e_=Ra(uy),t_=Et({},Wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kl}),$0=Ra(t_),dy=Et({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nd=Ra(dy),xn=Et({},Yh,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),Lr=Ra(xn),Pm=[9,13,27,32],Gr=i&&"CompositionEvent"in window,yc=null;i&&"documentMode"in document&&(yc=document.documentMode);var Em=i&&"TextEvent"in window&&!yc,Hr=i&&(!Gr||yc&&8<yc&&11>=yc),Id=" ",Fu=!1;function Cm(b,T){switch(b){case"keyup":return Pm.indexOf(T.keyCode)!==-1;case"keydown":return T.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function up(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var po=!1;function Io(b,T){switch(b){case"compositionend":return up(T);case"keypress":return T.which!==32?null:(Fu=!0,Id);case"textInput":return b=T.data,b===Id&&Fu?null:b;default:return null}}function ar(b,T){if(po)return b==="compositionend"||!Gr&&Cm(b,T)?(b=To(),sl=Ao=wl=null,po=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(T.ctrlKey||T.altKey||T.metaKey)||T.ctrlKey&&T.altKey){if(T.char&&1<T.char.length)return T.char;if(T.which)return String.fromCharCode(T.which)}return null;case"compositionend":return Hr&&T.locale!=="ko"?null:T.data;default:return null}}var hy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dp(b){var T=b&&b.nodeName&&b.nodeName.toLowerCase();return T==="input"?!!hy[b.type]:T==="textarea"}function Qh(b,T,B,X){fa(X),T=xp(T,"onChange"),0<T.length&&(B=new ma("onChange","change",null,B,X),b.push({event:B,listeners:T}))}var Al=null,Da=null;function Zc(b){Nm(b,0)}function ef(b){var T=ll(b);if(Jt(T))return b}function Dd(b,T){if(b==="change")return T}var Bu=!1;if(i){var Yc;if(i){var hp="oninput"in document;if(!hp){var r_=document.createElement("div");r_.setAttribute("oninput","return;"),hp=typeof r_.oninput=="function"}Yc=hp}else Yc=!1;Bu=Yc&&(!document.documentMode||9<document.documentMode)}function Mm(){Al&&(Al.detachEvent("onpropertychange",n_),Da=Al=null)}function n_(b){if(b.propertyName==="value"&&ef(Da)){var T=[];Qh(T,Da,b,eo(b)),No(Zc,T)}}function i_(b,T,B){b==="focusin"?(Mm(),Al=T,Da=B,Al.attachEvent("onpropertychange",n_)):b==="focusout"&&Mm()}function fy(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return ef(Da)}function py(b,T){if(b==="click")return ef(T)}function q0(b,T){if(b==="input"||b==="change")return ef(T)}function a_(b,T){return b===T&&(b!==0||1/b===1/T)||b!==b&&T!==T}var Go=typeof Object.is=="function"?Object.is:a_;function fp(b,T){if(Go(b,T))return!0;if(typeof b!="object"||b===null||typeof T!="object"||T===null)return!1;var B=Object.keys(b),X=Object.keys(T);if(B.length!==X.length)return!1;for(X=0;X<B.length;X++){var ce=B[X];if(!_.call(T,ce)||!Go(b[ce],T[ce]))return!1}return!0}function my(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Om(b,T){var B=my(b);b=0;for(var X;B;){if(B.nodeType===3){if(X=b+B.textContent.length,b<=T&&X>=T)return{node:B,offset:T-b};b=X}e:{for(;B;){if(B.nextSibling){B=B.nextSibling;break e}B=B.parentNode}B=void 0}B=my(B)}}function tf(b,T){return b&&T?b===T?!0:b&&b.nodeType===3?!1:T&&T.nodeType===3?tf(b,T.parentNode):"contains"in b?b.contains(T):b.compareDocumentPosition?!!(b.compareDocumentPosition(T)&16):!1:!1}function gy(){for(var b=window,T=Sn();T instanceof b.HTMLIFrameElement;){try{var B=typeof T.contentWindow.location.href=="string"}catch{B=!1}if(B)b=T.contentWindow;else break;T=Sn(b.document)}return T}function Fs(b){var T=b&&b.nodeName&&b.nodeName.toLowerCase();return T&&(T==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||T==="textarea"||b.contentEditable==="true")}function Rm(b){var T=gy(),B=b.focusedElem,X=b.selectionRange;if(T!==B&&B&&B.ownerDocument&&tf(B.ownerDocument.documentElement,B)){if(X!==null&&Fs(B)){if(T=X.start,b=X.end,b===void 0&&(b=T),"selectionStart"in B)B.selectionStart=T,B.selectionEnd=Math.min(b,B.value.length);else if(b=(T=B.ownerDocument||document)&&T.defaultView||window,b.getSelection){b=b.getSelection();var ce=B.textContent.length,pe=Math.min(X.start,ce);X=X.end===void 0?pe:Math.min(X.end,ce),!b.extend&&pe>X&&(ce=X,X=pe,pe=ce),ce=Om(B,pe);var Le=Om(B,X);ce&&Le&&(b.rangeCount!==1||b.anchorNode!==ce.node||b.anchorOffset!==ce.offset||b.focusNode!==Le.node||b.focusOffset!==Le.offset)&&(T=T.createRange(),T.setStart(ce.node,ce.offset),b.removeAllRanges(),pe>X?(b.addRange(T),b.extend(Le.node,Le.offset)):(T.setEnd(Le.node,Le.offset),b.addRange(T)))}}for(T=[],b=B;b=b.parentNode;)b.nodeType===1&&T.push({element:b,left:b.scrollLeft,top:b.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<T.length;B++)b=T[B],b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}var pp=i&&"documentMode"in document&&11>=document.documentMode,Xc=null,vc=null,Vu=null,mp=!1;function Uu(b,T,B){var X=B.window===B?B.document:B.nodeType===9?B:B.ownerDocument;mp||Xc==null||Xc!==Sn(X)||(X=Xc,"selectionStart"in X&&Fs(X)?X={start:X.selectionStart,end:X.selectionEnd}:(X=(X.ownerDocument&&X.ownerDocument.defaultView||window).getSelection(),X={anchorNode:X.anchorNode,anchorOffset:X.anchorOffset,focusNode:X.focusNode,focusOffset:X.focusOffset}),Vu&&fp(Vu,X)||(Vu=X,X=xp(vc,"onSelect"),0<X.length&&(T=new ma("onSelect","select",null,T,B),b.push({event:T,listeners:X}),T.target=Xc)))}function Jc(b,T){var B={};return B[b.toLowerCase()]=T.toLowerCase(),B["Webkit"+b]="webkit"+T,B["Moz"+b]="moz"+T,B}var _c={animationend:Jc("Animation","AnimationEnd"),animationiteration:Jc("Animation","AnimationIteration"),animationstart:Jc("Animation","AnimationStart"),transitionend:Jc("Transition","TransitionEnd")},Ld={},$u={};i&&($u=document.createElement("div").style,"AnimationEvent"in window||(delete _c.animationend.animation,delete _c.animationiteration.animation,delete _c.animationstart.animation),"TransitionEvent"in window||delete _c.transitionend.transition);function xc(b){if(Ld[b])return Ld[b];if(!_c[b])return b;var T=_c[b],B;for(B in T)if(T.hasOwnProperty(B)&&B in $u)return Ld[b]=T[B];return b}var zd=xc("animationend"),rf=xc("animationiteration"),gp=xc("animationstart"),nf=xc("transitionend"),Fd=new Map,qu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bn(b,T){Fd.set(b,T),l(T,[b])}for(var km=0;km<qu.length;km++){var Gu=qu[km],o_=Gu.toLowerCase(),s_=Gu[0].toUpperCase()+Gu.slice(1);bn(o_,"on"+s_)}bn(zd,"onAnimationEnd"),bn(rf,"onAnimationIteration"),bn(gp,"onAnimationStart"),bn("dblclick","onDoubleClick"),bn("focusin","onFocus"),bn("focusout","onBlur"),bn(nf,"onTransitionEnd"),h("onMouseEnter",["mouseout","mouseover"]),h("onMouseLeave",["mouseout","mouseover"]),h("onPointerEnter",["pointerout","pointerover"]),h("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zi=new Set("cancel close invalid load scroll toggle".split(" ").concat(yp));function jm(b,T,B){var X=b.type||"unknown-event";b.currentTarget=B,Ge(X,T,void 0,b),b.currentTarget=null}function Nm(b,T){T=(T&4)!==0;for(var B=0;B<b.length;B++){var X=b[B],ce=X.event;X=X.listeners;e:{var pe=void 0;if(T)for(var Le=X.length-1;0<=Le;Le--){var gt=X[Le],At=gt.instance,Ht=gt.currentTarget;if(gt=gt.listener,At!==pe&&ce.isPropagationStopped())break e;jm(ce,gt,Ht),pe=At}else for(Le=0;Le<X.length;Le++){if(gt=X[Le],At=gt.instance,Ht=gt.currentTarget,gt=gt.listener,At!==pe&&ce.isPropagationStopped())break e;jm(ce,gt,Ht),pe=At}}}if(wt)throw b=ge,wt=!1,ge=null,b}function ca(b,T){var B=T[Wu];B===void 0&&(B=T[Wu]=new Set);var X=b+"__bubble";B.has(X)||(l_(T,b,2,!1),B.add(X))}function vp(b,T,B){var X=0;T&&(X|=4),l_(B,b,X,T)}var _p="_reactListening"+Math.random().toString(36).slice(2);function af(b){if(!b[_p]){b[_p]=!0,n.forEach(function(B){B!=="selectionchange"&&(zi.has(B)||vp(B,!1,b),vp(B,!0,b))});var T=b.nodeType===9?b:b.ownerDocument;T===null||T[_p]||(T[_p]=!0,vp("selectionchange",!1,T))}}function l_(b,T,B,X){switch(ap(T)){case 1:var ce=pa;break;case 4:ce=sy;break;default:ce=qo}B=ce.bind(null,T,B,b),ce=void 0,!So||T!=="touchstart"&&T!=="touchmove"&&T!=="wheel"||(ce=!0),X?ce!==void 0?b.addEventListener(T,B,{capture:!0,passive:ce}):b.addEventListener(T,B,!0):ce!==void 0?b.addEventListener(T,B,{passive:ce}):b.addEventListener(T,B,!1)}function Bd(b,T,B,X,ce){var pe=X;if((T&1)===0&&(T&2)===0&&X!==null)e:for(;;){if(X===null)return;var Le=X.tag;if(Le===3||Le===4){var gt=X.stateNode.containerInfo;if(gt===ce||gt.nodeType===8&&gt.parentNode===ce)break;if(Le===4)for(Le=X.return;Le!==null;){var At=Le.tag;if((At===3||At===4)&&(At=Le.stateNode.containerInfo,At===ce||At.nodeType===8&&At.parentNode===ce))return;Le=Le.return}for(;gt!==null;){if(Le=Hu(gt),Le===null)return;if(At=Le.tag,At===5||At===6){X=pe=Le;continue e}gt=gt.parentNode}}X=X.return}No(function(){var Ht=pe,Ar=eo(B),Mr=[];e:{var Tr=Fd.get(b);if(Tr!==void 0){var Jr=ma,sn=b;switch(b){case"keypress":if(Zh(B)===0)break e;case"keydown":case"keyup":Jr=U0;break;case"focusin":sn="focus",Jr=op;break;case"focusout":sn="blur",Jr=op;break;case"beforeblur":case"afterblur":Jr=op;break;case"click":if(B.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Jr=gc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Jr=ly;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Jr=$0;break;case zd:case rf:case gp:Jr=sp;break;case nf:Jr=Nd;break;case"scroll":Jr=Gl;break;case"wheel":Jr=Lr;break;case"copy":case"cut":case"paste":Jr=F0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Jr=e_}var cn=(T&4)!==0,vo=!cn&&b==="scroll",Ft=cn?Tr!==null?Tr+"Capture":null:Tr;cn=[];for(var Rt=Ht,$t;Rt!==null;){$t=Rt;var kr=$t.stateNode;if($t.tag===5&&kr!==null&&($t=kr,Ft!==null&&(kr=Ui(Rt,Ft),kr!=null&&cn.push(Qc(Rt,kr,$t)))),vo)break;Rt=Rt.return}0<cn.length&&(Tr=new Jr(Tr,sn,null,B,Ar),Mr.push({event:Tr,listeners:cn}))}}if((T&7)===0){e:{if(Tr=b==="mouseover"||b==="pointerover",Jr=b==="mouseout"||b==="pointerout",Tr&&B!==rn&&(sn=B.relatedTarget||B.fromElement)&&(Hu(sn)||sn[Pl]))break e;if((Jr||Tr)&&(Tr=Ar.window===Ar?Ar:(Tr=Ar.ownerDocument)?Tr.defaultView||Tr.parentWindow:window,Jr?(sn=B.relatedTarget||B.toElement,Jr=Ht,sn=sn?Hu(sn):null,sn!==null&&(vo=He(sn),sn!==vo||sn.tag!==5&&sn.tag!==6)&&(sn=null)):(Jr=null,sn=Ht),Jr!==sn)){if(cn=gc,kr="onMouseLeave",Ft="onMouseEnter",Rt="mouse",(b==="pointerout"||b==="pointerover")&&(cn=e_,kr="onPointerLeave",Ft="onPointerEnter",Rt="pointer"),vo=Jr==null?Tr:ll(Jr),$t=sn==null?Tr:ll(sn),Tr=new cn(kr,Rt+"leave",Jr,B,Ar),Tr.target=vo,Tr.relatedTarget=$t,kr=null,Hu(Ar)===Ht&&(cn=new cn(Ft,Rt+"enter",sn,B,Ar),cn.target=$t,cn.relatedTarget=vo,kr=cn),vo=kr,Jr&&sn)t:{for(cn=Jr,Ft=sn,Rt=0,$t=cn;$t;$t=Po($t))Rt++;for($t=0,kr=Ft;kr;kr=Po(kr))$t++;for(;0<Rt-$t;)cn=Po(cn),Rt--;for(;0<$t-Rt;)Ft=Po(Ft),$t--;for(;Rt--;){if(cn===Ft||Ft!==null&&cn===Ft.alternate)break t;cn=Po(cn),Ft=Po(Ft)}cn=null}else cn=null;Jr!==null&&Im(Mr,Tr,Jr,cn,!1),sn!==null&&vo!==null&&Im(Mr,vo,sn,cn,!0)}}e:{if(Tr=Ht?ll(Ht):window,Jr=Tr.nodeName&&Tr.nodeName.toLowerCase(),Jr==="select"||Jr==="input"&&Tr.type==="file")var tn=Dd;else if(dp(Tr))if(Bu)tn=q0;else{tn=fy;var kn=i_}else(Jr=Tr.nodeName)&&Jr.toLowerCase()==="input"&&(Tr.type==="checkbox"||Tr.type==="radio")&&(tn=py);if(tn&&(tn=tn(b,Ht))){Qh(Mr,tn,B,Ar);break e}kn&&kn(b,Tr,Ht),b==="focusout"&&(kn=Tr._wrapperState)&&kn.controlled&&Tr.type==="number"&&Ot(Tr,"number",Tr.value)}switch(kn=Ht?ll(Ht):window,b){case"focusin":(dp(kn)||kn.contentEditable==="true")&&(Xc=kn,vc=Ht,Vu=null);break;case"focusout":Vu=vc=Xc=null;break;case"mousedown":mp=!0;break;case"contextmenu":case"mouseup":case"dragend":mp=!1,Uu(Mr,B,Ar);break;case"selectionchange":if(pp)break;case"keydown":case"keyup":Uu(Mr,B,Ar)}var In;if(Gr)e:{switch(b){case"compositionstart":var si="onCompositionStart";break e;case"compositionend":si="onCompositionEnd";break e;case"compositionupdate":si="onCompositionUpdate";break e}si=void 0}else po?Cm(b,B)&&(si="onCompositionEnd"):b==="keydown"&&B.keyCode===229&&(si="onCompositionStart");si&&(Hr&&B.locale!=="ko"&&(po||si!=="onCompositionStart"?si==="onCompositionEnd"&&po&&(In=To()):(wl=Ar,Ao="value"in wl?wl.value:wl.textContent,po=!0)),kn=xp(Ht,si),0<kn.length&&(si=new Xh(si,b,null,B,Ar),Mr.push({event:si,listeners:kn}),In?si.data=In:(In=up(B),In!==null&&(si.data=In)))),(In=Em?Io(b,B):ar(b,B))&&(Ht=xp(Ht,"onBeforeInput"),0<Ht.length&&(Ar=new Xh("onBeforeInput","beforeinput",null,B,Ar),Mr.push({event:Ar,listeners:Ht}),Ar.data=In))}Nm(Mr,T)})}function Qc(b,T,B){return{instance:b,listener:T,currentTarget:B}}function xp(b,T){for(var B=T+"Capture",X=[];b!==null;){var ce=b,pe=ce.stateNode;ce.tag===5&&pe!==null&&(ce=pe,pe=Ui(b,B),pe!=null&&X.unshift(Qc(b,pe,ce)),pe=Ui(b,T),pe!=null&&X.push(Qc(b,pe,ce))),b=b.return}return X}function Po(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5);return b||null}function Im(b,T,B,X,ce){for(var pe=T._reactName,Le=[];B!==null&&B!==X;){var gt=B,At=gt.alternate,Ht=gt.stateNode;if(At!==null&&At===X)break;gt.tag===5&&Ht!==null&&(gt=Ht,ce?(At=Ui(B,pe),At!=null&&Le.unshift(Qc(B,At,gt))):ce||(At=Ui(B,pe),At!=null&&Le.push(Qc(B,At,gt)))),B=B.return}Le.length!==0&&b.push({event:T,listeners:Le})}var Dm=/\r\n?/g,Lm=/\u0000|\uFFFD/g;function zm(b){return(typeof b=="string"?b:""+b).replace(Dm,`
`).replace(Lm,"")}function of(b,T,B){if(T=zm(T),zm(b)!==T&&B)throw Error(r(425))}function Vd(){}var bp=null,wp=null;function sf(b,T){return b==="textarea"||b==="noscript"||typeof T.children=="string"||typeof T.children=="number"||typeof T.dangerouslySetInnerHTML=="object"&&T.dangerouslySetInnerHTML!==null&&T.dangerouslySetInnerHTML.__html!=null}var Fm=typeof setTimeout=="function"?setTimeout:void 0,c_=typeof clearTimeout=="function"?clearTimeout:void 0,Ud=typeof Promise=="function"?Promise:void 0,G0=typeof queueMicrotask=="function"?queueMicrotask:typeof Ud<"u"?function(b){return Ud.resolve(null).then(b).catch(K0)}:Fm;function K0(b){setTimeout(function(){throw b})}function yy(b,T){var B=T,X=0;do{var ce=B.nextSibling;if(b.removeChild(B),ce&&ce.nodeType===8)if(B=ce.data,B==="/$"){if(X===0){b.removeChild(ce),zs(T);return}X--}else B!=="$"&&B!=="$?"&&B!=="$!"||X++;B=ce}while(B);zs(T)}function Ku(b){for(;b!=null;b=b.nextSibling){var T=b.nodeType;if(T===1||T===3)break;if(T===8){if(T=b.data,T==="$"||T==="$!"||T==="$?")break;if(T==="/$")return null}}return b}function u_(b){b=b.previousSibling;for(var T=0;b;){if(b.nodeType===8){var B=b.data;if(B==="$"||B==="$!"||B==="$?"){if(T===0)return b;T--}else B==="/$"&&T++}b=b.previousSibling}return null}var lf=Math.random().toString(36).slice(2),Tl="__reactFiber$"+lf,$d="__reactProps$"+lf,Pl="__reactContainer$"+lf,Wu="__reactEvents$"+lf,vy="__reactListeners$"+lf,d_="__reactHandles$"+lf;function Hu(b){var T=b[Tl];if(T)return T;for(var B=b.parentNode;B;){if(T=B[Pl]||B[Tl]){if(B=T.alternate,T.child!==null||B!==null&&B.child!==null)for(b=u_(b);b!==null;){if(B=b[Tl])return B;b=u_(b)}return T}b=B,B=b.parentNode}return null}function qd(b){return b=b[Tl]||b[Pl],!b||b.tag!==5&&b.tag!==6&&b.tag!==13&&b.tag!==3?null:b}function ll(b){if(b.tag===5||b.tag===6)return b.stateNode;throw Error(r(33))}function cf(b){return b[$d]||null}var xs=[],eu=-1;function El(b){return{current:b}}function ga(b){0>eu||(b.current=xs[eu],xs[eu]=null,eu--)}function Ji(b,T){eu++,xs[eu]=b.current,b.current=T}var Cl={},Do=El(Cl),Bs=El(!1),tu=Cl;function Wl(b,T){var B=b.type.contextTypes;if(!B)return Cl;var X=b.stateNode;if(X&&X.__reactInternalMemoizedUnmaskedChildContext===T)return X.__reactInternalMemoizedMaskedChildContext;var ce={},pe;for(pe in B)ce[pe]=T[pe];return X&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=T,b.__reactInternalMemoizedMaskedChildContext=ce),ce}function Vs(b){return b=b.childContextTypes,b!=null}function Bm(){ga(Bs),ga(Do)}function _y(b,T,B){if(Do.current!==Cl)throw Error(r(168));Ji(Do,T),Ji(Bs,B)}function xy(b,T,B){var X=b.stateNode;if(T=T.childContextTypes,typeof X.getChildContext!="function")return B;X=X.getChildContext();for(var ce in X)if(!(ce in T))throw Error(r(108,ur(b)||"Unknown",ce));return Et({},B,X)}function Gd(b){return b=(b=b.stateNode)&&b.__reactInternalMemoizedMergedChildContext||Cl,tu=Do.current,Ji(Do,b),Ji(Bs,Bs.current),!0}function Kd(b,T,B){var X=b.stateNode;if(!X)throw Error(r(169));B?(b=xy(b,T,tu),X.__reactInternalMemoizedMergedChildContext=b,ga(Bs),ga(Do),Ji(Do,b)):ga(Bs),Ji(Bs,B)}var Us=null,Wd=!1,Hd=!1;function by(b){Us===null?Us=[b]:Us.push(b)}function Sp(b){Wd=!0,by(b)}function Ml(){if(!Hd&&Us!==null){Hd=!0;var b=0,T=yi;try{var B=Us;for(yi=1;b<B.length;b++){var X=B[b];do X=X(!0);while(X!==null)}Us=null,Wd=!1}catch(ce){throw Us!==null&&(Us=Us.slice(b+1)),St(Br,Ml),ce}finally{yi=T,Hd=!1}}return null}var Zu=[],Zd=0,Vm=null,bc=0,bs=[],hr=0,ru=null,Hl=1,os="";function cl(b,T){Zu[Zd++]=bc,Zu[Zd++]=Vm,Vm=b,bc=T}function Cr(b,T,B){bs[hr++]=Hl,bs[hr++]=os,bs[hr++]=ru,ru=b;var X=Hl;b=os;var ce=32-ho(X)-1;X&=~(1<<ce),B+=1;var pe=32-ho(T)+ce;if(30<pe){var Le=ce-ce%5;pe=(X&(1<<Le)-1).toString(32),X>>=Le,ce-=Le,Hl=1<<32-ho(T)+ce|B<<ce|X,os=pe+b}else Hl=1<<pe|B<<ce|X,os=b}function Ap(b){b.return!==null&&(cl(b,1),Cr(b,1,0))}function wy(b){for(;b===Vm;)Vm=Zu[--Zd],Zu[Zd]=null,bc=Zu[--Zd],Zu[Zd]=null;for(;b===ru;)ru=bs[--hr],bs[hr]=null,os=bs[--hr],bs[hr]=null,Hl=bs[--hr],bs[hr]=null}var ul=null,ss=null,ya=!1,dl=null;function Sy(b,T){var B=Mc(5,null,null,0);B.elementType="DELETED",B.stateNode=T,B.return=b,T=b.deletions,T===null?(b.deletions=[B],b.flags|=16):T.push(B)}function Um(b,T){switch(b.tag){case 5:var B=b.type;return T=T.nodeType!==1||B.toLowerCase()!==T.nodeName.toLowerCase()?null:T,T!==null?(b.stateNode=T,ul=b,ss=Ku(T.firstChild),!0):!1;case 6:return T=b.pendingProps===""||T.nodeType!==3?null:T,T!==null?(b.stateNode=T,ul=b,ss=null,!0):!1;case 13:return T=T.nodeType!==8?null:T,T!==null?(B=ru!==null?{id:Hl,overflow:os}:null,b.memoizedState={dehydrated:T,treeContext:B,retryLane:1073741824},B=Mc(18,null,null,0),B.stateNode=T,B.return=b,b.child=B,ul=b,ss=null,!0):!1;default:return!1}}function Yd(b){return(b.mode&1)!==0&&(b.flags&128)===0}function uf(b){if(ya){var T=ss;if(T){var B=T;if(!Um(b,T)){if(Yd(b))throw Error(r(418));T=Ku(B.nextSibling);var X=ul;T&&Um(b,T)?Sy(X,B):(b.flags=b.flags&-4097|2,ya=!1,ul=b)}}else{if(Yd(b))throw Error(r(418));b.flags=b.flags&-4097|2,ya=!1,ul=b}}}function $m(b){for(b=b.return;b!==null&&b.tag!==5&&b.tag!==3&&b.tag!==13;)b=b.return;ul=b}function hl(b){if(b!==ul)return!1;if(!ya)return $m(b),ya=!0,!1;var T;if((T=b.tag!==3)&&!(T=b.tag!==5)&&(T=b.type,T=T!=="head"&&T!=="body"&&!sf(b.type,b.memoizedProps)),T&&(T=ss)){if(Yd(b))throw ws(),Error(r(418));for(;T;)Sy(b,T),T=Ku(T.nextSibling)}if($m(b),b.tag===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));e:{for(b=b.nextSibling,T=0;b;){if(b.nodeType===8){var B=b.data;if(B==="/$"){if(T===0){ss=Ku(b.nextSibling);break e}T--}else B!=="$"&&B!=="$!"&&B!=="$?"||T++}b=b.nextSibling}ss=null}}else ss=ul?Ku(b.stateNode.nextSibling):null;return!0}function ws(){for(var b=ss;b;)b=Ku(b.nextSibling)}function fl(){ss=ul=null,ya=!1}function Tp(b){dl===null?dl=[b]:dl.push(b)}var Ay=le.ReactCurrentBatchConfig;function wc(b,T,B){if(b=B.ref,b!==null&&typeof b!="function"&&typeof b!="object"){if(B._owner){if(B=B._owner,B){if(B.tag!==1)throw Error(r(309));var X=B.stateNode}if(!X)throw Error(r(147,b));var ce=X,pe=""+b;return T!==null&&T.ref!==null&&typeof T.ref=="function"&&T.ref._stringRef===pe?T.ref:(T=function(Le){var gt=ce.refs;Le===null?delete gt[pe]:gt[pe]=Le},T._stringRef=pe,T)}if(typeof b!="string")throw Error(r(284));if(!B._owner)throw Error(r(290,b))}return b}function Xd(b,T){throw b=Object.prototype.toString.call(T),Error(r(31,b==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":b))}function df(b){var T=b._init;return T(b._payload)}function $s(b){function T(Ft,Rt){if(b){var $t=Ft.deletions;$t===null?(Ft.deletions=[Rt],Ft.flags|=16):$t.push(Rt)}}function B(Ft,Rt){if(!b)return null;for(;Rt!==null;)T(Ft,Rt),Rt=Rt.sibling;return null}function X(Ft,Rt){for(Ft=new Map;Rt!==null;)Rt.key!==null?Ft.set(Rt.key,Rt):Ft.set(Rt.index,Rt),Rt=Rt.sibling;return Ft}function ce(Ft,Rt){return Ft=hh(Ft,Rt),Ft.index=0,Ft.sibling=null,Ft}function pe(Ft,Rt,$t){return Ft.index=$t,b?($t=Ft.alternate,$t!==null?($t=$t.index,$t<Rt?(Ft.flags|=2,Rt):$t):(Ft.flags|=2,Rt)):(Ft.flags|=1048576,Rt)}function Le(Ft){return b&&Ft.alternate===null&&(Ft.flags|=2),Ft}function gt(Ft,Rt,$t,kr){return Rt===null||Rt.tag!==6?(Rt=y_($t,Ft.mode,kr),Rt.return=Ft,Rt):(Rt=ce(Rt,$t),Rt.return=Ft,Rt)}function At(Ft,Rt,$t,kr){var tn=$t.type;return tn===ue?Ar(Ft,Rt,$t.props.children,kr,$t.key):Rt!==null&&(Rt.elementType===tn||typeof tn=="object"&&tn!==null&&tn.$$typeof===Ne&&df(tn)===Rt.type)?(kr=ce(Rt,$t.props),kr.ref=wc(Ft,Rt,$t),kr.return=Ft,kr):(kr=Ly($t.type,$t.key,$t.props,null,Ft.mode,kr),kr.ref=wc(Ft,Rt,$t),kr.return=Ft,kr)}function Ht(Ft,Rt,$t,kr){return Rt===null||Rt.tag!==4||Rt.stateNode.containerInfo!==$t.containerInfo||Rt.stateNode.implementation!==$t.implementation?(Rt=v_($t,Ft.mode,kr),Rt.return=Ft,Rt):(Rt=ce(Rt,$t.children||[]),Rt.return=Ft,Rt)}function Ar(Ft,Rt,$t,kr,tn){return Rt===null||Rt.tag!==7?(Rt=Ef($t,Ft.mode,kr,tn),Rt.return=Ft,Rt):(Rt=ce(Rt,$t),Rt.return=Ft,Rt)}function Mr(Ft,Rt,$t){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return Rt=y_(""+Rt,Ft.mode,$t),Rt.return=Ft,Rt;if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case ne:return $t=Ly(Rt.type,Rt.key,Rt.props,null,Ft.mode,$t),$t.ref=wc(Ft,null,Rt),$t.return=Ft,$t;case de:return Rt=v_(Rt,Ft.mode,$t),Rt.return=Ft,Rt;case Ne:var kr=Rt._init;return Mr(Ft,kr(Rt._payload),$t)}if(Kt(Rt)||We(Rt))return Rt=Ef(Rt,Ft.mode,$t,null),Rt.return=Ft,Rt;Xd(Ft,Rt)}return null}function Tr(Ft,Rt,$t,kr){var tn=Rt!==null?Rt.key:null;if(typeof $t=="string"&&$t!==""||typeof $t=="number")return tn!==null?null:gt(Ft,Rt,""+$t,kr);if(typeof $t=="object"&&$t!==null){switch($t.$$typeof){case ne:return $t.key===tn?At(Ft,Rt,$t,kr):null;case de:return $t.key===tn?Ht(Ft,Rt,$t,kr):null;case Ne:return tn=$t._init,Tr(Ft,Rt,tn($t._payload),kr)}if(Kt($t)||We($t))return tn!==null?null:Ar(Ft,Rt,$t,kr,null);Xd(Ft,$t)}return null}function Jr(Ft,Rt,$t,kr,tn){if(typeof kr=="string"&&kr!==""||typeof kr=="number")return Ft=Ft.get($t)||null,gt(Rt,Ft,""+kr,tn);if(typeof kr=="object"&&kr!==null){switch(kr.$$typeof){case ne:return Ft=Ft.get(kr.key===null?$t:kr.key)||null,At(Rt,Ft,kr,tn);case de:return Ft=Ft.get(kr.key===null?$t:kr.key)||null,Ht(Rt,Ft,kr,tn);case Ne:var kn=kr._init;return Jr(Ft,Rt,$t,kn(kr._payload),tn)}if(Kt(kr)||We(kr))return Ft=Ft.get($t)||null,Ar(Rt,Ft,kr,tn,null);Xd(Rt,kr)}return null}function sn(Ft,Rt,$t,kr){for(var tn=null,kn=null,In=Rt,si=Rt=0,ds=null;In!==null&&si<$t.length;si++){In.index>si?(ds=In,In=null):ds=In.sibling;var Hi=Tr(Ft,In,$t[si],kr);if(Hi===null){In===null&&(In=ds);break}b&&In&&Hi.alternate===null&&T(Ft,In),Rt=pe(Hi,Rt,si),kn===null?tn=Hi:kn.sibling=Hi,kn=Hi,In=ds}if(si===$t.length)return B(Ft,In),ya&&cl(Ft,si),tn;if(In===null){for(;si<$t.length;si++)In=Mr(Ft,$t[si],kr),In!==null&&(Rt=pe(In,Rt,si),kn===null?tn=In:kn.sibling=In,kn=In);return ya&&cl(Ft,si),tn}for(In=X(Ft,In);si<$t.length;si++)ds=Jr(In,Ft,si,$t[si],kr),ds!==null&&(b&&ds.alternate!==null&&In.delete(ds.key===null?si:ds.key),Rt=pe(ds,Rt,si),kn===null?tn=ds:kn.sibling=ds,kn=ds);return b&&In.forEach(function(Cf){return T(Ft,Cf)}),ya&&cl(Ft,si),tn}function cn(Ft,Rt,$t,kr){var tn=We($t);if(typeof tn!="function")throw Error(r(150));if($t=tn.call($t),$t==null)throw Error(r(151));for(var kn=tn=null,In=Rt,si=Rt=0,ds=null,Hi=$t.next();In!==null&&!Hi.done;si++,Hi=$t.next()){In.index>si?(ds=In,In=null):ds=In.sibling;var Cf=Tr(Ft,In,Hi.value,kr);if(Cf===null){In===null&&(In=ds);break}b&&In&&Cf.alternate===null&&T(Ft,In),Rt=pe(Cf,Rt,si),kn===null?tn=Cf:kn.sibling=Cf,kn=Cf,In=ds}if(Hi.done)return B(Ft,In),ya&&cl(Ft,si),tn;if(In===null){for(;!Hi.done;si++,Hi=$t.next())Hi=Mr(Ft,Hi.value,kr),Hi!==null&&(Rt=pe(Hi,Rt,si),kn===null?tn=Hi:kn.sibling=Hi,kn=Hi);return ya&&cl(Ft,si),tn}for(In=X(Ft,In);!Hi.done;si++,Hi=$t.next())Hi=Jr(In,Ft,si,Hi.value,kr),Hi!==null&&(b&&Hi.alternate!==null&&In.delete(Hi.key===null?si:Hi.key),Rt=pe(Hi,Rt,si),kn===null?tn=Hi:kn.sibling=Hi,kn=Hi);return b&&In.forEach(function(TE){return T(Ft,TE)}),ya&&cl(Ft,si),tn}function vo(Ft,Rt,$t,kr){if(typeof $t=="object"&&$t!==null&&$t.type===ue&&$t.key===null&&($t=$t.props.children),typeof $t=="object"&&$t!==null){switch($t.$$typeof){case ne:e:{for(var tn=$t.key,kn=Rt;kn!==null;){if(kn.key===tn){if(tn=$t.type,tn===ue){if(kn.tag===7){B(Ft,kn.sibling),Rt=ce(kn,$t.props.children),Rt.return=Ft,Ft=Rt;break e}}else if(kn.elementType===tn||typeof tn=="object"&&tn!==null&&tn.$$typeof===Ne&&df(tn)===kn.type){B(Ft,kn.sibling),Rt=ce(kn,$t.props),Rt.ref=wc(Ft,kn,$t),Rt.return=Ft,Ft=Rt;break e}B(Ft,kn);break}else T(Ft,kn);kn=kn.sibling}$t.type===ue?(Rt=Ef($t.props.children,Ft.mode,kr,$t.key),Rt.return=Ft,Ft=Rt):(kr=Ly($t.type,$t.key,$t.props,null,Ft.mode,kr),kr.ref=wc(Ft,Rt,$t),kr.return=Ft,Ft=kr)}return Le(Ft);case de:e:{for(kn=$t.key;Rt!==null;){if(Rt.key===kn)if(Rt.tag===4&&Rt.stateNode.containerInfo===$t.containerInfo&&Rt.stateNode.implementation===$t.implementation){B(Ft,Rt.sibling),Rt=ce(Rt,$t.children||[]),Rt.return=Ft,Ft=Rt;break e}else{B(Ft,Rt);break}else T(Ft,Rt);Rt=Rt.sibling}Rt=v_($t,Ft.mode,kr),Rt.return=Ft,Ft=Rt}return Le(Ft);case Ne:return kn=$t._init,vo(Ft,Rt,kn($t._payload),kr)}if(Kt($t))return sn(Ft,Rt,$t,kr);if(We($t))return cn(Ft,Rt,$t,kr);Xd(Ft,$t)}return typeof $t=="string"&&$t!==""||typeof $t=="number"?($t=""+$t,Rt!==null&&Rt.tag===6?(B(Ft,Rt.sibling),Rt=ce(Rt,$t),Rt.return=Ft,Ft=Rt):(B(Ft,Rt),Rt=y_($t,Ft.mode,kr),Rt.return=Ft,Ft=Rt),Le(Ft)):B(Ft,Rt)}return vo}var vi=$s(!0),Pp=$s(!1),Yu=El(null),Jd=null,Xu=null,Qd=null;function Ju(){Qd=Xu=Jd=null}function Qu(b){var T=Yu.current;ga(Yu),b._currentValue=T}function ed(b,T,B){for(;b!==null;){var X=b.alternate;if((b.childLanes&T)!==T?(b.childLanes|=T,X!==null&&(X.childLanes|=T)):X!==null&&(X.childLanes&T)!==T&&(X.childLanes|=T),b===B)break;b=b.return}}function Yt(b,T){Jd=b,Qd=Xu=null,b=b.dependencies,b!==null&&b.firstContext!==null&&((b.lanes&T)!==0&&(ls=!0),b.firstContext=null)}function or(b){var T=b._currentValue;if(Qd!==b)if(b={context:b,memoizedValue:T,next:null},Xu===null){if(Jd===null)throw Error(r(308));Xu=b,Jd.dependencies={lanes:0,firstContext:b}}else Xu=Xu.next=b;return T}var Ol=null;function $i(b){Ol===null?Ol=[b]:Ol.push(b)}function vt(b,T,B,X){var ce=T.interleaved;return ce===null?(B.next=B,$i(T)):(B.next=ce.next,ce.next=B),T.interleaved=B,Sc(b,X)}function Sc(b,T){b.lanes|=T;var B=b.alternate;for(B!==null&&(B.lanes|=T),B=b,b=b.return;b!==null;)b.childLanes|=T,B=b.alternate,B!==null&&(B.childLanes|=T),B=b,b=b.return;return B.tag===3?B.stateNode:null}var Zl=!1;function Ep(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ty(b,T){b=b.updateQueue,T.updateQueue===b&&(T.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,effects:b.effects})}function Ac(b,T){return{eventTime:b,lane:T,tag:0,payload:null,callback:null,next:null}}function nu(b,T,B){var X=b.updateQueue;if(X===null)return null;if(X=X.shared,(Ke&2)!==0){var ce=X.pending;return ce===null?T.next=T:(T.next=ce.next,ce.next=T),X.pending=T,Sc(b,B)}return ce=X.interleaved,ce===null?(T.next=T,$i(X)):(T.next=ce.next,ce.next=T),X.interleaved=T,Sc(b,B)}function iu(b,T,B){if(T=T.updateQueue,T!==null&&(T=T.shared,(B&4194240)!==0)){var X=T.lanes;X&=b.pendingLanes,B|=X,T.lanes=B,ol(b,B)}}function h_(b,T){var B=b.updateQueue,X=b.alternate;if(X!==null&&(X=X.updateQueue,B===X)){var ce=null,pe=null;if(B=B.firstBaseUpdate,B!==null){do{var Le={eventTime:B.eventTime,lane:B.lane,tag:B.tag,payload:B.payload,callback:B.callback,next:null};pe===null?ce=pe=Le:pe=pe.next=Le,B=B.next}while(B!==null);pe===null?ce=pe=T:pe=pe.next=T}else ce=pe=T;B={baseState:X.baseState,firstBaseUpdate:ce,lastBaseUpdate:pe,shared:X.shared,effects:X.effects},b.updateQueue=B;return}b=B.lastBaseUpdate,b===null?B.firstBaseUpdate=T:b.next=T,B.lastBaseUpdate=T}function qm(b,T,B,X){var ce=b.updateQueue;Zl=!1;var pe=ce.firstBaseUpdate,Le=ce.lastBaseUpdate,gt=ce.shared.pending;if(gt!==null){ce.shared.pending=null;var At=gt,Ht=At.next;At.next=null,Le===null?pe=Ht:Le.next=Ht,Le=At;var Ar=b.alternate;Ar!==null&&(Ar=Ar.updateQueue,gt=Ar.lastBaseUpdate,gt!==Le&&(gt===null?Ar.firstBaseUpdate=Ht:gt.next=Ht,Ar.lastBaseUpdate=At))}if(pe!==null){var Mr=ce.baseState;Le=0,Ar=Ht=At=null,gt=pe;do{var Tr=gt.lane,Jr=gt.eventTime;if((X&Tr)===Tr){Ar!==null&&(Ar=Ar.next={eventTime:Jr,lane:0,tag:gt.tag,payload:gt.payload,callback:gt.callback,next:null});e:{var sn=b,cn=gt;switch(Tr=T,Jr=B,cn.tag){case 1:if(sn=cn.payload,typeof sn=="function"){Mr=sn.call(Jr,Mr,Tr);break e}Mr=sn;break e;case 3:sn.flags=sn.flags&-65537|128;case 0:if(sn=cn.payload,Tr=typeof sn=="function"?sn.call(Jr,Mr,Tr):sn,Tr==null)break e;Mr=Et({},Mr,Tr);break e;case 2:Zl=!0}}gt.callback!==null&&gt.lane!==0&&(b.flags|=64,Tr=ce.effects,Tr===null?ce.effects=[gt]:Tr.push(gt))}else Jr={eventTime:Jr,lane:Tr,tag:gt.tag,payload:gt.payload,callback:gt.callback,next:null},Ar===null?(Ht=Ar=Jr,At=Mr):Ar=Ar.next=Jr,Le|=Tr;if(gt=gt.next,gt===null){if(gt=ce.shared.pending,gt===null)break;Tr=gt,gt=Tr.next,Tr.next=null,ce.lastBaseUpdate=Tr,ce.shared.pending=null}}while(!0);if(Ar===null&&(At=Mr),ce.baseState=At,ce.firstBaseUpdate=Ht,ce.lastBaseUpdate=Ar,T=ce.shared.interleaved,T!==null){ce=T;do Le|=ce.lane,ce=ce.next;while(ce!==T)}else pe===null&&(ce.shared.lanes=0);Bt|=Le,b.lanes=Le,b.memoizedState=Mr}}function Py(b,T,B){if(b=T.effects,T.effects=null,b!==null)for(T=0;T<b.length;T++){var X=b[T],ce=X.callback;if(ce!==null){if(X.callback=null,X=B,typeof ce!="function")throw Error(r(191,ce));ce.call(X)}}}var td={},Ko=El(td),eh=El(td),th=El(td);function pl(b){if(b===td)throw Error(r(174));return b}function hf(b,T){switch(Ji(th,T),Ji(eh,b),Ji(Ko,td),b=T.nodeType,b){case 9:case 11:T=(T=T.documentElement)?T.namespaceURI:Bi(null,"");break;default:b=b===8?T.parentNode:T,T=b.namespaceURI||null,b=b.tagName,T=Bi(T,b)}ga(Ko),Ji(Ko,T)}function Ss(){ga(Ko),ga(eh),ga(th)}function Tc(b){pl(th.current);var T=pl(Ko.current),B=Bi(T,b.type);T!==B&&(Ji(eh,b),Ji(Ko,B))}function Gm(b){eh.current===b&&(ga(Ko),ga(eh))}var fi=El(0);function Km(b){for(var T=b;T!==null;){if(T.tag===13){var B=T.memoizedState;if(B!==null&&(B=B.dehydrated,B===null||B.data==="$?"||B.data==="$!"))return T}else if(T.tag===19&&T.memoizedProps.revealOrder!==void 0){if((T.flags&128)!==0)return T}else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===b)break;for(;T.sibling===null;){if(T.return===null||T.return===b)return null;T=T.return}T.sibling.return=T.return,T=T.sibling}return null}var rh=[];function Ri(){for(var b=0;b<rh.length;b++)rh[b]._workInProgressVersionPrimary=null;rh.length=0}var Qn=le.ReactCurrentDispatcher,Wm=le.ReactCurrentBatchConfig,As=0,ia=null,ua=null,ro=null,rd=!1,qs=!1,no=0,Hm=0;function mo(){throw Error(r(321))}function Cp(b,T){if(T===null)return!1;for(var B=0;B<T.length&&B<b.length;B++)if(!Go(b[B],T[B]))return!1;return!0}function Mp(b,T,B,X,ce,pe){if(As=pe,ia=T,T.memoizedState=null,T.updateQueue=null,T.lanes=0,Qn.current=b===null||b.memoizedState===null?W0:va,b=B(X,ce),qs){pe=0;do{if(qs=!1,no=0,25<=pe)throw Error(r(301));pe+=1,ro=ua=null,T.updateQueue=null,Qn.current=tg,b=B(X,ce)}while(qs)}if(Qn.current=eg,T=ua!==null&&ua.next!==null,As=0,ro=ua=ia=null,rd=!1,T)throw Error(r(300));return b}function au(){var b=no!==0;return no=0,b}function Rl(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ro===null?ia.memoizedState=ro=b:ro=ro.next=b,ro}function Eo(){if(ua===null){var b=ia.alternate;b=b!==null?b.memoizedState:null}else b=ua.next;var T=ro===null?ia.memoizedState:ro.next;if(T!==null)ro=T,ua=b;else{if(b===null)throw Error(r(310));ua=b,b={memoizedState:ua.memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},ro===null?ia.memoizedState=ro=b:ro=ro.next=b}return ro}function nh(b,T){return typeof T=="function"?T(b):T}function ff(b){var T=Eo(),B=T.queue;if(B===null)throw Error(r(311));B.lastRenderedReducer=b;var X=ua,ce=X.baseQueue,pe=B.pending;if(pe!==null){if(ce!==null){var Le=ce.next;ce.next=pe.next,pe.next=Le}X.baseQueue=ce=pe,B.pending=null}if(ce!==null){pe=ce.next,X=X.baseState;var gt=Le=null,At=null,Ht=pe;do{var Ar=Ht.lane;if((As&Ar)===Ar)At!==null&&(At=At.next={lane:0,action:Ht.action,hasEagerState:Ht.hasEagerState,eagerState:Ht.eagerState,next:null}),X=Ht.hasEagerState?Ht.eagerState:b(X,Ht.action);else{var Mr={lane:Ar,action:Ht.action,hasEagerState:Ht.hasEagerState,eagerState:Ht.eagerState,next:null};At===null?(gt=At=Mr,Le=X):At=At.next=Mr,ia.lanes|=Ar,Bt|=Ar}Ht=Ht.next}while(Ht!==null&&Ht!==pe);At===null?Le=X:At.next=gt,Go(X,T.memoizedState)||(ls=!0),T.memoizedState=X,T.baseState=Le,T.baseQueue=At,B.lastRenderedState=X}if(b=B.interleaved,b!==null){ce=b;do pe=ce.lane,ia.lanes|=pe,Bt|=pe,ce=ce.next;while(ce!==b)}else ce===null&&(B.lanes=0);return[T.memoizedState,B.dispatch]}function Op(b){var T=Eo(),B=T.queue;if(B===null)throw Error(r(311));B.lastRenderedReducer=b;var X=B.dispatch,ce=B.pending,pe=T.memoizedState;if(ce!==null){B.pending=null;var Le=ce=ce.next;do pe=b(pe,Le.action),Le=Le.next;while(Le!==ce);Go(pe,T.memoizedState)||(ls=!0),T.memoizedState=pe,T.baseQueue===null&&(T.baseState=pe),B.lastRenderedState=pe}return[pe,X]}function Zm(){}function go(b,T){var B=ia,X=Eo(),ce=T(),pe=!Go(X.memoizedState,ce);if(pe&&(X.memoizedState=ce,ls=!0),X=X.queue,ah(pf.bind(null,B,X,b),[b]),X.getSnapshot!==T||pe||ro!==null&&ro.memoizedState.tag&1){if(B.flags|=2048,nd(9,Xm.bind(null,B,X,ce,T),void 0,null),it===null)throw Error(r(349));(As&30)!==0||Ym(B,T,ce)}return ce}function Ym(b,T,B){b.flags|=16384,b={getSnapshot:T,value:B},T=ia.updateQueue,T===null?(T={lastEffect:null,stores:null},ia.updateQueue=T,T.stores=[b]):(B=T.stores,B===null?T.stores=[b]:B.push(b))}function Xm(b,T,B,X){T.value=B,T.getSnapshot=X,ou(T)&&Rp(b)}function pf(b,T,B){return B(function(){ou(T)&&Rp(b)})}function ou(b){var T=b.getSnapshot;b=b.value;try{var B=T();return!Go(b,B)}catch{return!0}}function Rp(b){var T=Sc(b,1);T!==null&&_n(T,b,1,-1)}function Yl(b){var T=Rl();return typeof b=="function"&&(b=b()),T.memoizedState=T.baseState=b,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nh,lastRenderedState:b},T.queue=b,b=b.dispatch=Np.bind(null,ia,b),[T.memoizedState,b]}function nd(b,T,B,X){return b={tag:b,create:T,destroy:B,deps:X,next:null},T=ia.updateQueue,T===null?(T={lastEffect:null,stores:null},ia.updateQueue=T,T.lastEffect=b.next=b):(B=T.lastEffect,B===null?T.lastEffect=b.next=b:(X=B.next,B.next=b,b.next=X,T.lastEffect=b)),b}function ih(){return Eo().memoizedState}function mf(b,T,B,X){var ce=Rl();ia.flags|=b,ce.memoizedState=nd(1|T,B,void 0,X===void 0?null:X)}function gf(b,T,B,X){var ce=Eo();X=X===void 0?null:X;var pe=void 0;if(ua!==null){var Le=ua.memoizedState;if(pe=Le.destroy,X!==null&&Cp(X,Le.deps)){ce.memoizedState=nd(T,B,pe,X);return}}ia.flags|=b,ce.memoizedState=nd(1|T,B,pe,X)}function yf(b,T){return mf(8390656,8,b,T)}function ah(b,T){return gf(2048,8,b,T)}function Jm(b,T){return gf(4,2,b,T)}function kp(b,T){return gf(4,4,b,T)}function Ey(b,T){if(typeof T=="function")return b=b(),T(b),function(){T(null)};if(T!=null)return b=b(),T.current=b,function(){T.current=null}}function Qm(b,T,B){return B=B!=null?B.concat([b]):null,gf(4,4,Ey.bind(null,T,b),B)}function oh(){}function Cy(b,T){var B=Eo();T=T===void 0?null:T;var X=B.memoizedState;return X!==null&&T!==null&&Cp(T,X[1])?X[0]:(B.memoizedState=[b,T],b)}function My(b,T){var B=Eo();T=T===void 0?null:T;var X=B.memoizedState;return X!==null&&T!==null&&Cp(T,X[1])?X[0]:(b=b(),B.memoizedState=[b,T],b)}function Oy(b,T,B){return(As&21)===0?(b.baseState&&(b.baseState=!1,ls=!0),b.memoizedState=B):(Go(B,T)||(B=$o(),ia.lanes|=B,Bt|=B,b.baseState=!0),T)}function f_(b,T){var B=yi;yi=B!==0&&4>B?B:4,b(!0);var X=Wm.transition;Wm.transition={};try{b(!1),T()}finally{yi=B,Wm.transition=X}}function Ry(){return Eo().memoizedState}function jp(b,T,B){var X=Zr(b);if(B={lane:X,action:B,hasEagerState:!1,eagerState:null,next:null},Ts(b))vf(T,B);else if(B=vt(b,T,B,X),B!==null){var ce=Yn();_n(B,b,X,ce),ky(B,T,X)}}function Np(b,T,B){var X=Zr(b),ce={lane:X,action:B,hasEagerState:!1,eagerState:null,next:null};if(Ts(b))vf(T,ce);else{var pe=b.alternate;if(b.lanes===0&&(pe===null||pe.lanes===0)&&(pe=T.lastRenderedReducer,pe!==null))try{var Le=T.lastRenderedState,gt=pe(Le,B);if(ce.hasEagerState=!0,ce.eagerState=gt,Go(gt,Le)){var At=T.interleaved;At===null?(ce.next=ce,$i(T)):(ce.next=At.next,At.next=ce),T.interleaved=ce;return}}catch{}finally{}B=vt(b,T,ce,X),B!==null&&(ce=Yn(),_n(B,b,X,ce),ky(B,T,X))}}function Ts(b){var T=b.alternate;return b===ia||T!==null&&T===ia}function vf(b,T){qs=rd=!0;var B=b.pending;B===null?T.next=T:(T.next=B.next,B.next=T),b.pending=T}function ky(b,T,B){if((B&4194240)!==0){var X=T.lanes;X&=b.pendingLanes,B|=X,T.lanes=B,ol(b,B)}}var eg={readContext:or,useCallback:mo,useContext:mo,useEffect:mo,useImperativeHandle:mo,useInsertionEffect:mo,useLayoutEffect:mo,useMemo:mo,useReducer:mo,useRef:mo,useState:mo,useDebugValue:mo,useDeferredValue:mo,useTransition:mo,useMutableSource:mo,useSyncExternalStore:mo,useId:mo,unstable_isNewReconciler:!1},W0={readContext:or,useCallback:function(b,T){return Rl().memoizedState=[b,T===void 0?null:T],b},useContext:or,useEffect:yf,useImperativeHandle:function(b,T,B){return B=B!=null?B.concat([b]):null,mf(4194308,4,Ey.bind(null,T,b),B)},useLayoutEffect:function(b,T){return mf(4194308,4,b,T)},useInsertionEffect:function(b,T){return mf(4,2,b,T)},useMemo:function(b,T){var B=Rl();return T=T===void 0?null:T,b=b(),B.memoizedState=[b,T],b},useReducer:function(b,T,B){var X=Rl();return T=B!==void 0?B(T):T,X.memoizedState=X.baseState=T,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:T},X.queue=b,b=b.dispatch=jp.bind(null,ia,b),[X.memoizedState,b]},useRef:function(b){var T=Rl();return b={current:b},T.memoizedState=b},useState:Yl,useDebugValue:oh,useDeferredValue:function(b){return Rl().memoizedState=b},useTransition:function(){var b=Yl(!1),T=b[0];return b=f_.bind(null,b[1]),Rl().memoizedState=b,[T,b]},useMutableSource:function(){},useSyncExternalStore:function(b,T,B){var X=ia,ce=Rl();if(ya){if(B===void 0)throw Error(r(407));B=B()}else{if(B=T(),it===null)throw Error(r(349));(As&30)!==0||Ym(X,T,B)}ce.memoizedState=B;var pe={value:B,getSnapshot:T};return ce.queue=pe,yf(pf.bind(null,X,pe,b),[b]),X.flags|=2048,nd(9,Xm.bind(null,X,pe,B,T),void 0,null),B},useId:function(){var b=Rl(),T=it.identifierPrefix;if(ya){var B=os,X=Hl;B=(X&~(1<<32-ho(X)-1)).toString(32)+B,T=":"+T+"R"+B,B=no++,0<B&&(T+="H"+B.toString(32)),T+=":"}else B=Hm++,T=":"+T+"r"+B.toString(32)+":";return b.memoizedState=T},unstable_isNewReconciler:!1},va={readContext:or,useCallback:Cy,useContext:or,useEffect:ah,useImperativeHandle:Qm,useInsertionEffect:Jm,useLayoutEffect:kp,useMemo:My,useReducer:ff,useRef:ih,useState:function(){return ff(nh)},useDebugValue:oh,useDeferredValue:function(b){var T=Eo();return Oy(T,ua.memoizedState,b)},useTransition:function(){var b=ff(nh)[0],T=Eo().memoizedState;return[b,T]},useMutableSource:Zm,useSyncExternalStore:go,useId:Ry,unstable_isNewReconciler:!1},tg={readContext:or,useCallback:Cy,useContext:or,useEffect:ah,useImperativeHandle:Qm,useInsertionEffect:Jm,useLayoutEffect:kp,useMemo:My,useReducer:Op,useRef:ih,useState:function(){return Op(nh)},useDebugValue:oh,useDeferredValue:function(b){var T=Eo();return ua===null?T.memoizedState=b:Oy(T,ua.memoizedState,b)},useTransition:function(){var b=Op(nh)[0],T=Eo().memoizedState;return[b,T]},useMutableSource:Zm,useSyncExternalStore:go,useId:Ry,unstable_isNewReconciler:!1};function Xl(b,T){if(b&&b.defaultProps){T=Et({},T),b=b.defaultProps;for(var B in b)T[B]===void 0&&(T[B]=b[B]);return T}return T}function Ip(b,T,B,X){T=b.memoizedState,B=B(X,T),B=B==null?T:Et({},T,B),b.memoizedState=B,b.lanes===0&&(b.updateQueue.baseState=B)}var id={isMounted:function(b){return(b=b._reactInternals)?He(b)===b:!1},enqueueSetState:function(b,T,B){b=b._reactInternals;var X=Yn(),ce=Zr(b),pe=Ac(X,ce);pe.payload=T,B!=null&&(pe.callback=B),T=nu(b,pe,ce),T!==null&&(_n(T,b,ce,X),iu(T,b,ce))},enqueueReplaceState:function(b,T,B){b=b._reactInternals;var X=Yn(),ce=Zr(b),pe=Ac(X,ce);pe.tag=1,pe.payload=T,B!=null&&(pe.callback=B),T=nu(b,pe,ce),T!==null&&(_n(T,b,ce,X),iu(T,b,ce))},enqueueForceUpdate:function(b,T){b=b._reactInternals;var B=Yn(),X=Zr(b),ce=Ac(B,X);ce.tag=2,T!=null&&(ce.callback=T),T=nu(b,ce,X),T!==null&&(_n(T,b,X,B),iu(T,b,X))}};function jy(b,T,B,X,ce,pe,Le){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(X,pe,Le):T.prototype&&T.prototype.isPureReactComponent?!fp(B,X)||!fp(ce,pe):!0}function _f(b,T,B){var X=!1,ce=Cl,pe=T.contextType;return typeof pe=="object"&&pe!==null?pe=or(pe):(ce=Vs(T)?tu:Do.current,X=T.contextTypes,pe=(X=X!=null)?Wl(b,ce):Cl),T=new T(B,pe),b.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=id,b.stateNode=T,T._reactInternals=b,X&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=ce,b.__reactInternalMemoizedMaskedChildContext=pe),T}function Dp(b,T,B,X){b=T.state,typeof T.componentWillReceiveProps=="function"&&T.componentWillReceiveProps(B,X),typeof T.UNSAFE_componentWillReceiveProps=="function"&&T.UNSAFE_componentWillReceiveProps(B,X),T.state!==b&&id.enqueueReplaceState(T,T.state,null)}function kl(b,T,B,X){var ce=b.stateNode;ce.props=B,ce.state=b.memoizedState,ce.refs={},Ep(b);var pe=T.contextType;typeof pe=="object"&&pe!==null?ce.context=or(pe):(pe=Vs(T)?tu:Do.current,ce.context=Wl(b,pe)),ce.state=b.memoizedState,pe=T.getDerivedStateFromProps,typeof pe=="function"&&(Ip(b,T,pe,B),ce.state=b.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof ce.getSnapshotBeforeUpdate=="function"||typeof ce.UNSAFE_componentWillMount!="function"&&typeof ce.componentWillMount!="function"||(T=ce.state,typeof ce.componentWillMount=="function"&&ce.componentWillMount(),typeof ce.UNSAFE_componentWillMount=="function"&&ce.UNSAFE_componentWillMount(),T!==ce.state&&id.enqueueReplaceState(ce,ce.state,null),qm(b,B,ce,X),ce.state=b.memoizedState),typeof ce.componentDidMount=="function"&&(b.flags|=4194308)}function Pc(b,T){try{var B="",X=T;do B+=gr(X),X=X.return;while(X);var ce=B}catch(pe){ce=`
Error generating stack: `+pe.message+`
`+pe.stack}return{value:b,source:T,stack:ce,digest:null}}function da(b,T,B){return{value:b,source:null,stack:B??null,digest:T??null}}function Gs(b,T){try{console.error(T.value)}catch(B){setTimeout(function(){throw B})}}var xf=typeof WeakMap=="function"?WeakMap:Map;function bf(b,T,B){B=Ac(-1,B),B.tag=3,B.payload={element:null};var X=T.value;return B.callback=function(){er||(er=!0,fr=X),Gs(b,T)},B}function Ny(b,T,B){B=Ac(-1,B),B.tag=3;var X=b.type.getDerivedStateFromError;if(typeof X=="function"){var ce=T.value;B.payload=function(){return X(ce)},B.callback=function(){Gs(b,T)}}var pe=b.stateNode;return pe!==null&&typeof pe.componentDidCatch=="function"&&(B.callback=function(){Gs(b,T),typeof X!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var Le=T.stack;this.componentDidCatch(T.value,{componentStack:Le!==null?Le:""})}),B}function Iy(b,T,B){var X=b.pingCache;if(X===null){X=b.pingCache=new xf;var ce=new Set;X.set(T,ce)}else ce=X.get(T),ce===void 0&&(ce=new Set,X.set(T,ce));ce.has(B)||(ce.add(B),b=uh.bind(null,b,T,B),T.then(b,b))}function wf(b){do{var T;if((T=b.tag===13)&&(T=b.memoizedState,T=T!==null?T.dehydrated!==null:!0),T)return b;b=b.return}while(b!==null);return null}function rg(b,T,B,X,ce){return(b.mode&1)===0?(b===T?b.flags|=65536:(b.flags|=128,B.flags|=131072,B.flags&=-52805,B.tag===1&&(B.alternate===null?B.tag=17:(T=Ac(-1,1),T.tag=2,nu(B,T,1))),B.lanes|=1),b):(b.flags|=65536,b.lanes=ce,b)}var H0=le.ReactCurrentOwner,ls=!1;function Wo(b,T,B,X){T.child=b===null?Pp(T,null,B,X):vi(T,b.child,B,X)}function ad(b,T,B,X,ce){B=B.render;var pe=T.ref;return Yt(T,ce),X=Mp(b,T,B,X,pe,ce),B=au(),b!==null&&!ls?(T.updateQueue=b.updateQueue,T.flags&=-2053,b.lanes&=~ce,Ws(b,T,ce)):(ya&&B&&Ap(T),T.flags|=1,Wo(b,T,X,ce),T.child)}function od(b,T,B,X,ce){if(b===null){var pe=B.type;return typeof pe=="function"&&!Z0(pe)&&pe.defaultProps===void 0&&B.compare===null&&B.defaultProps===void 0?(T.tag=15,T.type=pe,Ec(b,T,pe,X,ce)):(b=Ly(B.type,null,X,T,T.mode,ce),b.ref=T.ref,b.return=T,T.child=b)}if(pe=b.child,(b.lanes&ce)===0){var Le=pe.memoizedProps;if(B=B.compare,B=B!==null?B:fp,B(Le,X)&&b.ref===T.ref)return Ws(b,T,ce)}return T.flags|=1,b=hh(pe,X),b.ref=T.ref,b.return=T,T.child=b}function Ec(b,T,B,X,ce){if(b!==null){var pe=b.memoizedProps;if(fp(pe,X)&&b.ref===T.ref)if(ls=!1,T.pendingProps=X=pe,(b.lanes&ce)!==0)(b.flags&131072)!==0&&(ls=!0);else return T.lanes=b.lanes,Ws(b,T,ce)}return lu(b,T,B,X,ce)}function jl(b,T,B){var X=T.pendingProps,ce=X.children,pe=b!==null?b.memoizedState:null;if(X.mode==="hidden")if((T.mode&1)===0)T.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ji(Mt,Ct),Ct|=B;else{if((B&1073741824)===0)return b=pe!==null?pe.baseLanes|B:B,T.lanes=T.childLanes=1073741824,T.memoizedState={baseLanes:b,cachePool:null,transitions:null},T.updateQueue=null,Ji(Mt,Ct),Ct|=b,null;T.memoizedState={baseLanes:0,cachePool:null,transitions:null},X=pe!==null?pe.baseLanes:B,Ji(Mt,Ct),Ct|=X}else pe!==null?(X=pe.baseLanes|B,T.memoizedState=null):X=B,Ji(Mt,Ct),Ct|=X;return Wo(b,T,ce,B),T.child}function su(b,T){var B=T.ref;(b===null&&B!==null||b!==null&&b.ref!==B)&&(T.flags|=512,T.flags|=2097152)}function lu(b,T,B,X,ce){var pe=Vs(B)?tu:Do.current;return pe=Wl(T,pe),Yt(T,ce),B=Mp(b,T,B,X,pe,ce),X=au(),b!==null&&!ls?(T.updateQueue=b.updateQueue,T.flags&=-2053,b.lanes&=~ce,Ws(b,T,ce)):(ya&&X&&Ap(T),T.flags|=1,Wo(b,T,B,ce),T.child)}function cu(b,T,B,X,ce){if(Vs(B)){var pe=!0;Gd(T)}else pe=!1;if(Yt(T,ce),T.stateNode===null)cs(b,T),_f(T,B,X),kl(T,B,X,ce),X=!0;else if(b===null){var Le=T.stateNode,gt=T.memoizedProps;Le.props=gt;var At=Le.context,Ht=B.contextType;typeof Ht=="object"&&Ht!==null?Ht=or(Ht):(Ht=Vs(B)?tu:Do.current,Ht=Wl(T,Ht));var Ar=B.getDerivedStateFromProps,Mr=typeof Ar=="function"||typeof Le.getSnapshotBeforeUpdate=="function";Mr||typeof Le.UNSAFE_componentWillReceiveProps!="function"&&typeof Le.componentWillReceiveProps!="function"||(gt!==X||At!==Ht)&&Dp(T,Le,X,Ht),Zl=!1;var Tr=T.memoizedState;Le.state=Tr,qm(T,X,Le,ce),At=T.memoizedState,gt!==X||Tr!==At||Bs.current||Zl?(typeof Ar=="function"&&(Ip(T,B,Ar,X),At=T.memoizedState),(gt=Zl||jy(T,B,gt,X,Tr,At,Ht))?(Mr||typeof Le.UNSAFE_componentWillMount!="function"&&typeof Le.componentWillMount!="function"||(typeof Le.componentWillMount=="function"&&Le.componentWillMount(),typeof Le.UNSAFE_componentWillMount=="function"&&Le.UNSAFE_componentWillMount()),typeof Le.componentDidMount=="function"&&(T.flags|=4194308)):(typeof Le.componentDidMount=="function"&&(T.flags|=4194308),T.memoizedProps=X,T.memoizedState=At),Le.props=X,Le.state=At,Le.context=Ht,X=gt):(typeof Le.componentDidMount=="function"&&(T.flags|=4194308),X=!1)}else{Le=T.stateNode,Ty(b,T),gt=T.memoizedProps,Ht=T.type===T.elementType?gt:Xl(T.type,gt),Le.props=Ht,Mr=T.pendingProps,Tr=Le.context,At=B.contextType,typeof At=="object"&&At!==null?At=or(At):(At=Vs(B)?tu:Do.current,At=Wl(T,At));var Jr=B.getDerivedStateFromProps;(Ar=typeof Jr=="function"||typeof Le.getSnapshotBeforeUpdate=="function")||typeof Le.UNSAFE_componentWillReceiveProps!="function"&&typeof Le.componentWillReceiveProps!="function"||(gt!==Mr||Tr!==At)&&Dp(T,Le,X,At),Zl=!1,Tr=T.memoizedState,Le.state=Tr,qm(T,X,Le,ce);var sn=T.memoizedState;gt!==Mr||Tr!==sn||Bs.current||Zl?(typeof Jr=="function"&&(Ip(T,B,Jr,X),sn=T.memoizedState),(Ht=Zl||jy(T,B,Ht,X,Tr,sn,At)||!1)?(Ar||typeof Le.UNSAFE_componentWillUpdate!="function"&&typeof Le.componentWillUpdate!="function"||(typeof Le.componentWillUpdate=="function"&&Le.componentWillUpdate(X,sn,At),typeof Le.UNSAFE_componentWillUpdate=="function"&&Le.UNSAFE_componentWillUpdate(X,sn,At)),typeof Le.componentDidUpdate=="function"&&(T.flags|=4),typeof Le.getSnapshotBeforeUpdate=="function"&&(T.flags|=1024)):(typeof Le.componentDidUpdate!="function"||gt===b.memoizedProps&&Tr===b.memoizedState||(T.flags|=4),typeof Le.getSnapshotBeforeUpdate!="function"||gt===b.memoizedProps&&Tr===b.memoizedState||(T.flags|=1024),T.memoizedProps=X,T.memoizedState=sn),Le.props=X,Le.state=sn,Le.context=At,X=Ht):(typeof Le.componentDidUpdate!="function"||gt===b.memoizedProps&&Tr===b.memoizedState||(T.flags|=4),typeof Le.getSnapshotBeforeUpdate!="function"||gt===b.memoizedProps&&Tr===b.memoizedState||(T.flags|=1024),X=!1)}return Dy(b,T,B,X,pe,ce)}function Dy(b,T,B,X,ce,pe){su(b,T);var Le=(T.flags&128)!==0;if(!X&&!Le)return ce&&Kd(T,B,!1),Ws(b,T,pe);X=T.stateNode,H0.current=T;var gt=Le&&typeof B.getDerivedStateFromError!="function"?null:X.render();return T.flags|=1,b!==null&&Le?(T.child=vi(T,b.child,null,pe),T.child=vi(T,null,gt,pe)):Wo(b,T,gt,pe),T.memoizedState=X.state,ce&&Kd(T,B,!0),T.child}function p_(b){var T=b.stateNode;T.pendingContext?_y(b,T.pendingContext,T.pendingContext!==T.context):T.context&&_y(b,T.context,!1),hf(b,T.containerInfo)}function m_(b,T,B,X,ce){return fl(),Tp(ce),T.flags|=256,Wo(b,T,B,X),T.child}var Sf={dehydrated:null,treeContext:null,retryLane:0};function ng(b){return{baseLanes:b,cachePool:null,transitions:null}}function Ho(b,T,B){var X=T.pendingProps,ce=fi.current,pe=!1,Le=(T.flags&128)!==0,gt;if((gt=Le)||(gt=b!==null&&b.memoizedState===null?!1:(ce&2)!==0),gt?(pe=!0,T.flags&=-129):(b===null||b.memoizedState!==null)&&(ce|=1),Ji(fi,ce&1),b===null)return uf(T),b=T.memoizedState,b!==null&&(b=b.dehydrated,b!==null)?((T.mode&1)===0?T.lanes=1:b.data==="$!"?T.lanes=8:T.lanes=1073741824,null):(Le=X.children,b=X.fallback,pe?(X=T.mode,pe=T.child,Le={mode:"hidden",children:Le},(X&1)===0&&pe!==null?(pe.childLanes=0,pe.pendingProps=Le):pe=zy(Le,X,0,null),b=Ef(b,X,B,null),pe.return=T,b.return=T,pe.sibling=b,T.child=pe,T.child.memoizedState=ng(B),T.memoizedState=Sf,b):sd(T,Le));if(ce=b.memoizedState,ce!==null&&(gt=ce.dehydrated,gt!==null))return g_(b,T,Le,X,gt,ce,B);if(pe){pe=X.fallback,Le=T.mode,ce=b.child,gt=ce.sibling;var At={mode:"hidden",children:X.children};return(Le&1)===0&&T.child!==ce?(X=T.child,X.childLanes=0,X.pendingProps=At,T.deletions=null):(X=hh(ce,At),X.subtreeFlags=ce.subtreeFlags&14680064),gt!==null?pe=hh(gt,pe):(pe=Ef(pe,Le,B,null),pe.flags|=2),pe.return=T,X.return=T,X.sibling=pe,T.child=X,X=pe,pe=T.child,Le=b.child.memoizedState,Le=Le===null?ng(B):{baseLanes:Le.baseLanes|B,cachePool:null,transitions:Le.transitions},pe.memoizedState=Le,pe.childLanes=b.childLanes&~B,T.memoizedState=Sf,X}return pe=b.child,b=pe.sibling,X=hh(pe,{mode:"visible",children:X.children}),(T.mode&1)===0&&(X.lanes=B),X.return=T,X.sibling=null,b!==null&&(B=T.deletions,B===null?(T.deletions=[b],T.flags|=16):B.push(b)),T.child=X,T.memoizedState=null,X}function sd(b,T){return T=zy({mode:"visible",children:T},b.mode,0,null),T.return=b,b.child=T}function Lp(b,T,B,X){return X!==null&&Tp(X),vi(T,b.child,null,B),b=sd(T,T.pendingProps.children),b.flags|=2,T.memoizedState=null,b}function g_(b,T,B,X,ce,pe,Le){if(B)return T.flags&256?(T.flags&=-257,X=da(Error(r(422))),Lp(b,T,Le,X)):T.memoizedState!==null?(T.child=b.child,T.flags|=128,null):(pe=X.fallback,ce=T.mode,X=zy({mode:"visible",children:X.children},ce,0,null),pe=Ef(pe,ce,Le,null),pe.flags|=2,X.return=T,pe.return=T,X.sibling=pe,T.child=X,(T.mode&1)!==0&&vi(T,b.child,null,Le),T.child.memoizedState=ng(Le),T.memoizedState=Sf,pe);if((T.mode&1)===0)return Lp(b,T,Le,null);if(ce.data==="$!"){if(X=ce.nextSibling&&ce.nextSibling.dataset,X)var gt=X.dgst;return X=gt,pe=Error(r(419)),X=da(pe,X,void 0),Lp(b,T,Le,X)}if(gt=(Le&b.childLanes)!==0,ls||gt){if(X=it,X!==null){switch(Le&-Le){case 4:ce=2;break;case 16:ce=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ce=32;break;case 536870912:ce=268435456;break;default:ce=0}ce=(ce&(X.suspendedLanes|Le))!==0?0:ce,ce!==0&&ce!==pe.retryLane&&(pe.retryLane=ce,Sc(b,ce),_n(X,b,ce,-1))}return Rn(),X=da(Error(r(421))),Lp(b,T,Le,X)}return ce.data==="$?"?(T.flags|=128,T.child=b.child,T=dh.bind(null,b),ce._reactRetry=T,null):(b=pe.treeContext,ss=Ku(ce.nextSibling),ul=T,ya=!0,dl=null,b!==null&&(bs[hr++]=Hl,bs[hr++]=os,bs[hr++]=ru,Hl=b.id,os=b.overflow,ru=T),T=sd(T,X.children),T.flags|=4096,T)}function sh(b,T,B){b.lanes|=T;var X=b.alternate;X!==null&&(X.lanes|=T),ed(b.return,T,B)}function Af(b,T,B,X,ce){var pe=b.memoizedState;pe===null?b.memoizedState={isBackwards:T,rendering:null,renderingStartTime:0,last:X,tail:B,tailMode:ce}:(pe.isBackwards=T,pe.rendering=null,pe.renderingStartTime=0,pe.last=X,pe.tail=B,pe.tailMode=ce)}function Ks(b,T,B){var X=T.pendingProps,ce=X.revealOrder,pe=X.tail;if(Wo(b,T,X.children,B),X=fi.current,(X&2)!==0)X=X&1|2,T.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=T.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&sh(b,B,T);else if(b.tag===19)sh(b,B,T);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===T)break e;for(;b.sibling===null;){if(b.return===null||b.return===T)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}X&=1}if(Ji(fi,X),(T.mode&1)===0)T.memoizedState=null;else switch(ce){case"forwards":for(B=T.child,ce=null;B!==null;)b=B.alternate,b!==null&&Km(b)===null&&(ce=B),B=B.sibling;B=ce,B===null?(ce=T.child,T.child=null):(ce=B.sibling,B.sibling=null),Af(T,!1,ce,B,pe);break;case"backwards":for(B=null,ce=T.child,T.child=null;ce!==null;){if(b=ce.alternate,b!==null&&Km(b)===null){T.child=ce;break}b=ce.sibling,ce.sibling=B,B=ce,ce=b}Af(T,!0,B,null,pe);break;case"together":Af(T,!1,null,null,void 0);break;default:T.memoizedState=null}return T.child}function cs(b,T){(T.mode&1)===0&&b!==null&&(b.alternate=null,T.alternate=null,T.flags|=2)}function Ws(b,T,B){if(b!==null&&(T.dependencies=b.dependencies),Bt|=T.lanes,(B&T.childLanes)===0)return null;if(b!==null&&T.child!==b.child)throw Error(r(153));if(T.child!==null){for(b=T.child,B=hh(b,b.pendingProps),T.child=B,B.return=T;b.sibling!==null;)b=b.sibling,B=B.sibling=hh(b,b.pendingProps),B.return=T;B.sibling=null}return T.child}function lh(b,T,B){switch(T.tag){case 3:p_(T),fl();break;case 5:Tc(T);break;case 1:Vs(T.type)&&Gd(T);break;case 4:hf(T,T.stateNode.containerInfo);break;case 10:var X=T.type._context,ce=T.memoizedProps.value;Ji(Yu,X._currentValue),X._currentValue=ce;break;case 13:if(X=T.memoizedState,X!==null)return X.dehydrated!==null?(Ji(fi,fi.current&1),T.flags|=128,null):(B&T.child.childLanes)!==0?Ho(b,T,B):(Ji(fi,fi.current&1),b=Ws(b,T,B),b!==null?b.sibling:null);Ji(fi,fi.current&1);break;case 19:if(X=(B&T.childLanes)!==0,(b.flags&128)!==0){if(X)return Ks(b,T,B);T.flags|=128}if(ce=T.memoizedState,ce!==null&&(ce.rendering=null,ce.tail=null,ce.lastEffect=null),Ji(fi,fi.current),X)break;return null;case 22:case 23:return T.lanes=0,jl(b,T,B)}return Ws(b,T,B)}var ld,zp,Zn,uu;ld=function(b,T){for(var B=T.child;B!==null;){if(B.tag===5||B.tag===6)b.appendChild(B.stateNode);else if(B.tag!==4&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===T)break;for(;B.sibling===null;){if(B.return===null||B.return===T)return;B=B.return}B.sibling.return=B.return,B=B.sibling}},zp=function(){},Zn=function(b,T,B,X){var ce=b.memoizedProps;if(ce!==X){b=T.stateNode,pl(Ko.current);var pe=null;switch(B){case"input":ce=It(b,ce),X=It(b,X),pe=[];break;case"select":ce=Et({},ce,{value:void 0}),X=Et({},X,{value:void 0}),pe=[];break;case"textarea":ce=yr(b,ce),X=yr(b,X),pe=[];break;default:typeof ce.onClick!="function"&&typeof X.onClick=="function"&&(b.onclick=Vd)}jo(B,X);var Le;B=null;for(Ht in ce)if(!X.hasOwnProperty(Ht)&&ce.hasOwnProperty(Ht)&&ce[Ht]!=null)if(Ht==="style"){var gt=ce[Ht];for(Le in gt)gt.hasOwnProperty(Le)&&(B||(B={}),B[Le]="")}else Ht!=="dangerouslySetInnerHTML"&&Ht!=="children"&&Ht!=="suppressContentEditableWarning"&&Ht!=="suppressHydrationWarning"&&Ht!=="autoFocus"&&(a.hasOwnProperty(Ht)?pe||(pe=[]):(pe=pe||[]).push(Ht,null));for(Ht in X){var At=X[Ht];if(gt=ce!=null?ce[Ht]:void 0,X.hasOwnProperty(Ht)&&At!==gt&&(At!=null||gt!=null))if(Ht==="style")if(gt){for(Le in gt)!gt.hasOwnProperty(Le)||At&&At.hasOwnProperty(Le)||(B||(B={}),B[Le]="");for(Le in At)At.hasOwnProperty(Le)&&gt[Le]!==At[Le]&&(B||(B={}),B[Le]=At[Le])}else B||(pe||(pe=[]),pe.push(Ht,B)),B=At;else Ht==="dangerouslySetInnerHTML"?(At=At?At.__html:void 0,gt=gt?gt.__html:void 0,At!=null&&gt!==At&&(pe=pe||[]).push(Ht,At)):Ht==="children"?typeof At!="string"&&typeof At!="number"||(pe=pe||[]).push(Ht,""+At):Ht!=="suppressContentEditableWarning"&&Ht!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ht)?(At!=null&&Ht==="onScroll"&&ca("scroll",b),pe||gt===At||(pe=[])):(pe=pe||[]).push(Ht,At))}B&&(pe=pe||[]).push("style",B);var Ht=pe;(T.updateQueue=Ht)&&(T.flags|=4)}},uu=function(b,T,B,X){B!==X&&(T.flags|=4)};function Fp(b,T){if(!ya)switch(b.tailMode){case"hidden":T=b.tail;for(var B=null;T!==null;)T.alternate!==null&&(B=T),T=T.sibling;B===null?b.tail=null:B.sibling=null;break;case"collapsed":B=b.tail;for(var X=null;B!==null;)B.alternate!==null&&(X=B),B=B.sibling;X===null?T||b.tail===null?b.tail=null:b.tail.sibling=null:X.sibling=null}}function us(b){var T=b.alternate!==null&&b.alternate.child===b.child,B=0,X=0;if(T)for(var ce=b.child;ce!==null;)B|=ce.lanes|ce.childLanes,X|=ce.subtreeFlags&14680064,X|=ce.flags&14680064,ce.return=b,ce=ce.sibling;else for(ce=b.child;ce!==null;)B|=ce.lanes|ce.childLanes,X|=ce.subtreeFlags,X|=ce.flags,ce.return=b,ce=ce.sibling;return b.subtreeFlags|=X,b.childLanes=B,T}function ig(b,T,B){var X=T.pendingProps;switch(wy(T),T.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(T),null;case 1:return Vs(T.type)&&Bm(),us(T),null;case 3:return X=T.stateNode,Ss(),ga(Bs),ga(Do),Ri(),X.pendingContext&&(X.context=X.pendingContext,X.pendingContext=null),(b===null||b.child===null)&&(hl(T)?T.flags|=4:b===null||b.memoizedState.isDehydrated&&(T.flags&256)===0||(T.flags|=1024,dl!==null&&(oi(dl),dl=null))),zp(b,T),us(T),null;case 5:Gm(T);var ce=pl(th.current);if(B=T.type,b!==null&&T.stateNode!=null)Zn(b,T,B,X,ce),b.ref!==T.ref&&(T.flags|=512,T.flags|=2097152);else{if(!X){if(T.stateNode===null)throw Error(r(166));return us(T),null}if(b=pl(Ko.current),hl(T)){X=T.stateNode,B=T.type;var pe=T.memoizedProps;switch(X[Tl]=T,X[$d]=pe,b=(T.mode&1)!==0,B){case"dialog":ca("cancel",X),ca("close",X);break;case"iframe":case"object":case"embed":ca("load",X);break;case"video":case"audio":for(ce=0;ce<yp.length;ce++)ca(yp[ce],X);break;case"source":ca("error",X);break;case"img":case"image":case"link":ca("error",X),ca("load",X);break;case"details":ca("toggle",X);break;case"input":Vn(X,pe),ca("invalid",X);break;case"select":X._wrapperState={wasMultiple:!!pe.multiple},ca("invalid",X);break;case"textarea":wr(X,pe),ca("invalid",X)}jo(B,pe),ce=null;for(var Le in pe)if(pe.hasOwnProperty(Le)){var gt=pe[Le];Le==="children"?typeof gt=="string"?X.textContent!==gt&&(pe.suppressHydrationWarning!==!0&&of(X.textContent,gt,b),ce=["children",gt]):typeof gt=="number"&&X.textContent!==""+gt&&(pe.suppressHydrationWarning!==!0&&of(X.textContent,gt,b),ce=["children",""+gt]):a.hasOwnProperty(Le)&&gt!=null&&Le==="onScroll"&&ca("scroll",X)}switch(B){case"input":Nr(X),rt(X,pe,!0);break;case"textarea":Nr(X),An(X);break;case"select":case"option":break;default:typeof pe.onClick=="function"&&(X.onclick=Vd)}X=ce,T.updateQueue=X,X!==null&&(T.flags|=4)}else{Le=ce.nodeType===9?ce:ce.ownerDocument,b==="http://www.w3.org/1999/xhtml"&&(b=Ti(B)),b==="http://www.w3.org/1999/xhtml"?B==="script"?(b=Le.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild)):typeof X.is=="string"?b=Le.createElement(B,{is:X.is}):(b=Le.createElement(B),B==="select"&&(Le=b,X.multiple?Le.multiple=!0:X.size&&(Le.size=X.size))):b=Le.createElementNS(b,B),b[Tl]=T,b[$d]=X,ld(b,T,!1,!1),T.stateNode=b;e:{switch(Le=ql(B,X),B){case"dialog":ca("cancel",b),ca("close",b),ce=X;break;case"iframe":case"object":case"embed":ca("load",b),ce=X;break;case"video":case"audio":for(ce=0;ce<yp.length;ce++)ca(yp[ce],b);ce=X;break;case"source":ca("error",b),ce=X;break;case"img":case"image":case"link":ca("error",b),ca("load",b),ce=X;break;case"details":ca("toggle",b),ce=X;break;case"input":Vn(b,X),ce=It(b,X),ca("invalid",b);break;case"option":ce=X;break;case"select":b._wrapperState={wasMultiple:!!X.multiple},ce=Et({},X,{value:void 0}),ca("invalid",b);break;case"textarea":wr(b,X),ce=yr(b,X),ca("invalid",b);break;default:ce=X}jo(B,ce),gt=ce;for(pe in gt)if(gt.hasOwnProperty(pe)){var At=gt[pe];pe==="style"?$l(b,At):pe==="dangerouslySetInnerHTML"?(At=At?At.__html:void 0,At!=null&&is(b,At)):pe==="children"?typeof At=="string"?(B!=="textarea"||At!=="")&&$a(b,At):typeof At=="number"&&$a(b,""+At):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(a.hasOwnProperty(pe)?At!=null&&pe==="onScroll"&&ca("scroll",b):At!=null&&Q(b,pe,At,Le))}switch(B){case"input":Nr(b),rt(b,X,!1);break;case"textarea":Nr(b),An(b);break;case"option":X.value!=null&&b.setAttribute("value",""+br(X.value));break;case"select":b.multiple=!!X.multiple,pe=X.value,pe!=null?Pr(b,!!X.multiple,pe,!1):X.defaultValue!=null&&Pr(b,!!X.multiple,X.defaultValue,!0);break;default:typeof ce.onClick=="function"&&(b.onclick=Vd)}switch(B){case"button":case"input":case"select":case"textarea":X=!!X.autoFocus;break e;case"img":X=!0;break e;default:X=!1}}X&&(T.flags|=4)}T.ref!==null&&(T.flags|=512,T.flags|=2097152)}return us(T),null;case 6:if(b&&T.stateNode!=null)uu(b,T,b.memoizedProps,X);else{if(typeof X!="string"&&T.stateNode===null)throw Error(r(166));if(B=pl(th.current),pl(Ko.current),hl(T)){if(X=T.stateNode,B=T.memoizedProps,X[Tl]=T,(pe=X.nodeValue!==B)&&(b=ul,b!==null))switch(b.tag){case 3:of(X.nodeValue,B,(b.mode&1)!==0);break;case 5:b.memoizedProps.suppressHydrationWarning!==!0&&of(X.nodeValue,B,(b.mode&1)!==0)}pe&&(T.flags|=4)}else X=(B.nodeType===9?B:B.ownerDocument).createTextNode(X),X[Tl]=T,T.stateNode=X}return us(T),null;case 13:if(ga(fi),X=T.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(ya&&ss!==null&&(T.mode&1)!==0&&(T.flags&128)===0)ws(),fl(),T.flags|=98560,pe=!1;else if(pe=hl(T),X!==null&&X.dehydrated!==null){if(b===null){if(!pe)throw Error(r(318));if(pe=T.memoizedState,pe=pe!==null?pe.dehydrated:null,!pe)throw Error(r(317));pe[Tl]=T}else fl(),(T.flags&128)===0&&(T.memoizedState=null),T.flags|=4;us(T),pe=!1}else dl!==null&&(oi(dl),dl=null),pe=!0;if(!pe)return T.flags&65536?T:null}return(T.flags&128)!==0?(T.lanes=B,T):(X=X!==null,X!==(b!==null&&b.memoizedState!==null)&&X&&(T.child.flags|=8192,(T.mode&1)!==0&&(b===null||(fi.current&1)!==0?ut===0&&(ut=3):Rn())),T.updateQueue!==null&&(T.flags|=4),us(T),null);case 4:return Ss(),zp(b,T),b===null&&af(T.stateNode.containerInfo),us(T),null;case 10:return Qu(T.type._context),us(T),null;case 17:return Vs(T.type)&&Bm(),us(T),null;case 19:if(ga(fi),pe=T.memoizedState,pe===null)return us(T),null;if(X=(T.flags&128)!==0,Le=pe.rendering,Le===null)if(X)Fp(pe,!1);else{if(ut!==0||b!==null&&(b.flags&128)!==0)for(b=T.child;b!==null;){if(Le=Km(b),Le!==null){for(T.flags|=128,Fp(pe,!1),X=Le.updateQueue,X!==null&&(T.updateQueue=X,T.flags|=4),T.subtreeFlags=0,X=B,B=T.child;B!==null;)pe=B,b=X,pe.flags&=14680066,Le=pe.alternate,Le===null?(pe.childLanes=0,pe.lanes=b,pe.child=null,pe.subtreeFlags=0,pe.memoizedProps=null,pe.memoizedState=null,pe.updateQueue=null,pe.dependencies=null,pe.stateNode=null):(pe.childLanes=Le.childLanes,pe.lanes=Le.lanes,pe.child=Le.child,pe.subtreeFlags=0,pe.deletions=null,pe.memoizedProps=Le.memoizedProps,pe.memoizedState=Le.memoizedState,pe.updateQueue=Le.updateQueue,pe.type=Le.type,b=Le.dependencies,pe.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),B=B.sibling;return Ji(fi,fi.current&1|2),T.child}b=b.sibling}pe.tail!==null&&Sr()>Nt&&(T.flags|=128,X=!0,Fp(pe,!1),T.lanes=4194304)}else{if(!X)if(b=Km(Le),b!==null){if(T.flags|=128,X=!0,B=b.updateQueue,B!==null&&(T.updateQueue=B,T.flags|=4),Fp(pe,!0),pe.tail===null&&pe.tailMode==="hidden"&&!Le.alternate&&!ya)return us(T),null}else 2*Sr()-pe.renderingStartTime>Nt&&B!==1073741824&&(T.flags|=128,X=!0,Fp(pe,!1),T.lanes=4194304);pe.isBackwards?(Le.sibling=T.child,T.child=Le):(B=pe.last,B!==null?B.sibling=Le:T.child=Le,pe.last=Le)}return pe.tail!==null?(T=pe.tail,pe.rendering=T,pe.tail=T.sibling,pe.renderingStartTime=Sr(),T.sibling=null,B=fi.current,Ji(fi,X?B&1|2:B&1),T):(us(T),null);case 22:case 23:return Mo(),X=T.memoizedState!==null,b!==null&&b.memoizedState!==null!==X&&(T.flags|=8192),X&&(T.mode&1)!==0?(Ct&1073741824)!==0&&(us(T),T.subtreeFlags&6&&(T.flags|=8192)):us(T),null;case 24:return null;case 25:return null}throw Error(r(156,T.tag))}function Cc(b,T){switch(wy(T),T.tag){case 1:return Vs(T.type)&&Bm(),b=T.flags,b&65536?(T.flags=b&-65537|128,T):null;case 3:return Ss(),ga(Bs),ga(Do),Ri(),b=T.flags,(b&65536)!==0&&(b&128)===0?(T.flags=b&-65537|128,T):null;case 5:return Gm(T),null;case 13:if(ga(fi),b=T.memoizedState,b!==null&&b.dehydrated!==null){if(T.alternate===null)throw Error(r(340));fl()}return b=T.flags,b&65536?(T.flags=b&-65537|128,T):null;case 19:return ga(fi),null;case 4:return Ss(),null;case 10:return Qu(T.type._context),null;case 22:case 23:return Mo(),null;case 24:return null;default:return null}}var Hs=!1,qi=!1,Zs=typeof WeakSet=="function"?WeakSet:Set,zr=null;function ch(b,T){var B=b.ref;if(B!==null)if(typeof B=="function")try{B(null)}catch(X){Ii(b,T,X)}else B.current=null}function Zo(b,T,B){try{B()}catch(X){Ii(b,T,X)}}var ag=!1;function Tf(b,T){if(bp=Ka,b=gy(),Fs(b)){if("selectionStart"in b)var B={start:b.selectionStart,end:b.selectionEnd};else e:{B=(B=b.ownerDocument)&&B.defaultView||window;var X=B.getSelection&&B.getSelection();if(X&&X.rangeCount!==0){B=X.anchorNode;var ce=X.anchorOffset,pe=X.focusNode;X=X.focusOffset;try{B.nodeType,pe.nodeType}catch{B=null;break e}var Le=0,gt=-1,At=-1,Ht=0,Ar=0,Mr=b,Tr=null;t:for(;;){for(var Jr;Mr!==B||ce!==0&&Mr.nodeType!==3||(gt=Le+ce),Mr!==pe||X!==0&&Mr.nodeType!==3||(At=Le+X),Mr.nodeType===3&&(Le+=Mr.nodeValue.length),(Jr=Mr.firstChild)!==null;)Tr=Mr,Mr=Jr;for(;;){if(Mr===b)break t;if(Tr===B&&++Ht===ce&&(gt=Le),Tr===pe&&++Ar===X&&(At=Le),(Jr=Mr.nextSibling)!==null)break;Mr=Tr,Tr=Mr.parentNode}Mr=Jr}B=gt===-1||At===-1?null:{start:gt,end:At}}else B=null}B=B||{start:0,end:0}}else B=null;for(wp={focusedElem:b,selectionRange:B},Ka=!1,zr=T;zr!==null;)if(T=zr,b=T.child,(T.subtreeFlags&1028)!==0&&b!==null)b.return=T,zr=b;else for(;zr!==null;){T=zr;try{var sn=T.alternate;if((T.flags&1024)!==0)switch(T.tag){case 0:case 11:case 15:break;case 1:if(sn!==null){var cn=sn.memoizedProps,vo=sn.memoizedState,Ft=T.stateNode,Rt=Ft.getSnapshotBeforeUpdate(T.elementType===T.type?cn:Xl(T.type,cn),vo);Ft.__reactInternalSnapshotBeforeUpdate=Rt}break;case 3:var $t=T.stateNode.containerInfo;$t.nodeType===1?$t.textContent="":$t.nodeType===9&&$t.documentElement&&$t.removeChild($t.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(kr){Ii(T,T.return,kr)}if(b=T.sibling,b!==null){b.return=T.return,zr=b;break}zr=T.return}return sn=ag,ag=!1,sn}function g(b,T,B){var X=T.updateQueue;if(X=X!==null?X.lastEffect:null,X!==null){var ce=X=X.next;do{if((ce.tag&b)===b){var pe=ce.destroy;ce.destroy=void 0,pe!==void 0&&Zo(T,B,pe)}ce=ce.next}while(ce!==X)}}function s(b,T){if(T=T.updateQueue,T=T!==null?T.lastEffect:null,T!==null){var B=T=T.next;do{if((B.tag&b)===b){var X=B.create;B.destroy=X()}B=B.next}while(B!==T)}}function u(b){var T=b.ref;if(T!==null){var B=b.stateNode;switch(b.tag){case 5:b=B;break;default:b=B}typeof T=="function"?T(b):T.current=b}}function y(b){var T=b.alternate;T!==null&&(b.alternate=null,y(T)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(T=b.stateNode,T!==null&&(delete T[Tl],delete T[$d],delete T[Wu],delete T[vy],delete T[d_])),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}function S(b){return b.tag===5||b.tag===3||b.tag===4}function P(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||S(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function O(b,T,B){var X=b.tag;if(X===5||X===6)b=b.stateNode,T?B.nodeType===8?B.parentNode.insertBefore(b,T):B.insertBefore(b,T):(B.nodeType===8?(T=B.parentNode,T.insertBefore(b,B)):(T=B,T.appendChild(b)),B=B._reactRootContainer,B!=null||T.onclick!==null||(T.onclick=Vd));else if(X!==4&&(b=b.child,b!==null))for(O(b,T,B),b=b.sibling;b!==null;)O(b,T,B),b=b.sibling}function D(b,T,B){var X=b.tag;if(X===5||X===6)b=b.stateNode,T?B.insertBefore(b,T):B.appendChild(b);else if(X!==4&&(b=b.child,b!==null))for(D(b,T,B),b=b.sibling;b!==null;)D(b,T,B),b=b.sibling}var q=null,W=!1;function Z(b,T,B){for(B=B.child;B!==null;)te(b,T,B),B=B.sibling}function te(b,T,B){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount($n,B)}catch{}switch(B.tag){case 5:qi||ch(B,T);case 6:var X=q,ce=W;q=null,Z(b,T,B),q=X,W=ce,q!==null&&(W?(b=q,B=B.stateNode,b.nodeType===8?b.parentNode.removeChild(B):b.removeChild(B)):q.removeChild(B.stateNode));break;case 18:q!==null&&(W?(b=q,B=B.stateNode,b.nodeType===8?yy(b.parentNode,B):b.nodeType===1&&yy(b,B),zs(b)):yy(q,B.stateNode));break;case 4:X=q,ce=W,q=B.stateNode.containerInfo,W=!0,Z(b,T,B),q=X,W=ce;break;case 0:case 11:case 14:case 15:if(!qi&&(X=B.updateQueue,X!==null&&(X=X.lastEffect,X!==null))){ce=X=X.next;do{var pe=ce,Le=pe.destroy;pe=pe.tag,Le!==void 0&&((pe&2)!==0||(pe&4)!==0)&&Zo(B,T,Le),ce=ce.next}while(ce!==X)}Z(b,T,B);break;case 1:if(!qi&&(ch(B,T),X=B.stateNode,typeof X.componentWillUnmount=="function"))try{X.props=B.memoizedProps,X.state=B.memoizedState,X.componentWillUnmount()}catch(gt){Ii(B,T,gt)}Z(b,T,B);break;case 21:Z(b,T,B);break;case 22:B.mode&1?(qi=(X=qi)||B.memoizedState!==null,Z(b,T,B),qi=X):Z(b,T,B);break;default:Z(b,T,B)}}function re(b){var T=b.updateQueue;if(T!==null){b.updateQueue=null;var B=b.stateNode;B===null&&(B=b.stateNode=new Zs),T.forEach(function(X){var ce=Pf.bind(null,b,X);B.has(X)||(B.add(X),X.then(ce,ce))})}}function ae(b,T){var B=T.deletions;if(B!==null)for(var X=0;X<B.length;X++){var ce=B[X];try{var pe=b,Le=T,gt=Le;e:for(;gt!==null;){switch(gt.tag){case 5:q=gt.stateNode,W=!1;break e;case 3:q=gt.stateNode.containerInfo,W=!0;break e;case 4:q=gt.stateNode.containerInfo,W=!0;break e}gt=gt.return}if(q===null)throw Error(r(160));te(pe,Le,ce),q=null,W=!1;var At=ce.alternate;At!==null&&(At.return=null),ce.return=null}catch(Ht){Ii(ce,T,Ht)}}if(T.subtreeFlags&12854)for(T=T.child;T!==null;)ye(T,b),T=T.sibling}function ye(b,T){var B=b.alternate,X=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:if(ae(T,b),fe(b),X&4){try{g(3,b,b.return),s(3,b)}catch(cn){Ii(b,b.return,cn)}try{g(5,b,b.return)}catch(cn){Ii(b,b.return,cn)}}break;case 1:ae(T,b),fe(b),X&512&&B!==null&&ch(B,B.return);break;case 5:if(ae(T,b),fe(b),X&512&&B!==null&&ch(B,B.return),b.flags&32){var ce=b.stateNode;try{$a(ce,"")}catch(cn){Ii(b,b.return,cn)}}if(X&4&&(ce=b.stateNode,ce!=null)){var pe=b.memoizedProps,Le=B!==null?B.memoizedProps:pe,gt=b.type,At=b.updateQueue;if(b.updateQueue=null,At!==null)try{gt==="input"&&pe.type==="radio"&&pe.name!=null&&Un(ce,pe),ql(gt,Le);var Ht=ql(gt,pe);for(Le=0;Le<At.length;Le+=2){var Ar=At[Le],Mr=At[Le+1];Ar==="style"?$l(ce,Mr):Ar==="dangerouslySetInnerHTML"?is(ce,Mr):Ar==="children"?$a(ce,Mr):Q(ce,Ar,Mr,Ht)}switch(gt){case"input":Xr(ce,pe);break;case"textarea":dr(ce,pe);break;case"select":var Tr=ce._wrapperState.wasMultiple;ce._wrapperState.wasMultiple=!!pe.multiple;var Jr=pe.value;Jr!=null?Pr(ce,!!pe.multiple,Jr,!1):Tr!==!!pe.multiple&&(pe.defaultValue!=null?Pr(ce,!!pe.multiple,pe.defaultValue,!0):Pr(ce,!!pe.multiple,pe.multiple?[]:"",!1))}ce[$d]=pe}catch(cn){Ii(b,b.return,cn)}}break;case 6:if(ae(T,b),fe(b),X&4){if(b.stateNode===null)throw Error(r(162));ce=b.stateNode,pe=b.memoizedProps;try{ce.nodeValue=pe}catch(cn){Ii(b,b.return,cn)}}break;case 3:if(ae(T,b),fe(b),X&4&&B!==null&&B.memoizedState.isDehydrated)try{zs(T.containerInfo)}catch(cn){Ii(b,b.return,cn)}break;case 4:ae(T,b),fe(b);break;case 13:ae(T,b),fe(b),ce=b.child,ce.flags&8192&&(pe=ce.memoizedState!==null,ce.stateNode.isHidden=pe,!pe||ce.alternate!==null&&ce.alternate.memoizedState!==null||(zt=Sr())),X&4&&re(b);break;case 22:if(Ar=B!==null&&B.memoizedState!==null,b.mode&1?(qi=(Ht=qi)||Ar,ae(T,b),qi=Ht):ae(T,b),fe(b),X&8192){if(Ht=b.memoizedState!==null,(b.stateNode.isHidden=Ht)&&!Ar&&(b.mode&1)!==0)for(zr=b,Ar=b.child;Ar!==null;){for(Mr=zr=Ar;zr!==null;){switch(Tr=zr,Jr=Tr.child,Tr.tag){case 0:case 11:case 14:case 15:g(4,Tr,Tr.return);break;case 1:ch(Tr,Tr.return);var sn=Tr.stateNode;if(typeof sn.componentWillUnmount=="function"){X=Tr,B=Tr.return;try{T=X,sn.props=T.memoizedProps,sn.state=T.memoizedState,sn.componentWillUnmount()}catch(cn){Ii(X,B,cn)}}break;case 5:ch(Tr,Tr.return);break;case 22:if(Tr.memoizedState!==null){Fe(Mr);continue}}Jr!==null?(Jr.return=Tr,zr=Jr):Fe(Mr)}Ar=Ar.sibling}e:for(Ar=null,Mr=b;;){if(Mr.tag===5){if(Ar===null){Ar=Mr;try{ce=Mr.stateNode,Ht?(pe=ce.style,typeof pe.setProperty=="function"?pe.setProperty("display","none","important"):pe.display="none"):(gt=Mr.stateNode,At=Mr.memoizedProps.style,Le=At!=null&&At.hasOwnProperty("display")?At.display:null,gt.style.display=Qa("display",Le))}catch(cn){Ii(b,b.return,cn)}}}else if(Mr.tag===6){if(Ar===null)try{Mr.stateNode.nodeValue=Ht?"":Mr.memoizedProps}catch(cn){Ii(b,b.return,cn)}}else if((Mr.tag!==22&&Mr.tag!==23||Mr.memoizedState===null||Mr===b)&&Mr.child!==null){Mr.child.return=Mr,Mr=Mr.child;continue}if(Mr===b)break e;for(;Mr.sibling===null;){if(Mr.return===null||Mr.return===b)break e;Ar===Mr&&(Ar=null),Mr=Mr.return}Ar===Mr&&(Ar=null),Mr.sibling.return=Mr.return,Mr=Mr.sibling}}break;case 19:ae(T,b),fe(b),X&4&&re(b);break;case 21:break;default:ae(T,b),fe(b)}}function fe(b){var T=b.flags;if(T&2){try{e:{for(var B=b.return;B!==null;){if(S(B)){var X=B;break e}B=B.return}throw Error(r(160))}switch(X.tag){case 5:var ce=X.stateNode;X.flags&32&&($a(ce,""),X.flags&=-33);var pe=P(b);D(b,pe,ce);break;case 3:case 4:var Le=X.stateNode.containerInfo,gt=P(b);O(b,gt,Le);break;default:throw Error(r(161))}}catch(At){Ii(b,b.return,At)}b.flags&=-3}T&4096&&(b.flags&=-4097)}function xe(b,T,B){zr=b,_e(b)}function _e(b,T,B){for(var X=(b.mode&1)!==0;zr!==null;){var ce=zr,pe=ce.child;if(ce.tag===22&&X){var Le=ce.memoizedState!==null||Hs;if(!Le){var gt=ce.alternate,At=gt!==null&&gt.memoizedState!==null||qi;gt=Hs;var Ht=qi;if(Hs=Le,(qi=At)&&!Ht)for(zr=ce;zr!==null;)Le=zr,At=Le.child,Le.tag===22&&Le.memoizedState!==null?De(ce):At!==null?(At.return=Le,zr=At):De(ce);for(;pe!==null;)zr=pe,_e(pe),pe=pe.sibling;zr=ce,Hs=gt,qi=Ht}Ee(b)}else(ce.subtreeFlags&8772)!==0&&pe!==null?(pe.return=ce,zr=pe):Ee(b)}}function Ee(b){for(;zr!==null;){var T=zr;if((T.flags&8772)!==0){var B=T.alternate;try{if((T.flags&8772)!==0)switch(T.tag){case 0:case 11:case 15:qi||s(5,T);break;case 1:var X=T.stateNode;if(T.flags&4&&!qi)if(B===null)X.componentDidMount();else{var ce=T.elementType===T.type?B.memoizedProps:Xl(T.type,B.memoizedProps);X.componentDidUpdate(ce,B.memoizedState,X.__reactInternalSnapshotBeforeUpdate)}var pe=T.updateQueue;pe!==null&&Py(T,pe,X);break;case 3:var Le=T.updateQueue;if(Le!==null){if(B=null,T.child!==null)switch(T.child.tag){case 5:B=T.child.stateNode;break;case 1:B=T.child.stateNode}Py(T,Le,B)}break;case 5:var gt=T.stateNode;if(B===null&&T.flags&4){B=gt;var At=T.memoizedProps;switch(T.type){case"button":case"input":case"select":case"textarea":At.autoFocus&&B.focus();break;case"img":At.src&&(B.src=At.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(T.memoizedState===null){var Ht=T.alternate;if(Ht!==null){var Ar=Ht.memoizedState;if(Ar!==null){var Mr=Ar.dehydrated;Mr!==null&&zs(Mr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}qi||T.flags&512&&u(T)}catch(Tr){Ii(T,T.return,Tr)}}if(T===b){zr=null;break}if(B=T.sibling,B!==null){B.return=T.return,zr=B;break}zr=T.return}}function Fe(b){for(;zr!==null;){var T=zr;if(T===b){zr=null;break}var B=T.sibling;if(B!==null){B.return=T.return,zr=B;break}zr=T.return}}function De(b){for(;zr!==null;){var T=zr;try{switch(T.tag){case 0:case 11:case 15:var B=T.return;try{s(4,T)}catch(At){Ii(T,B,At)}break;case 1:var X=T.stateNode;if(typeof X.componentDidMount=="function"){var ce=T.return;try{X.componentDidMount()}catch(At){Ii(T,ce,At)}}var pe=T.return;try{u(T)}catch(At){Ii(T,pe,At)}break;case 5:var Le=T.return;try{u(T)}catch(At){Ii(T,Le,At)}}}catch(At){Ii(T,T.return,At)}if(T===b){zr=null;break}var gt=T.sibling;if(gt!==null){gt.return=T.return,zr=gt;break}zr=T.return}}var Ze=Math.ceil,Ue=le.ReactCurrentDispatcher,qe=le.ReactCurrentOwner,Ve=le.ReactCurrentBatchConfig,Ke=0,it=null,_t=null,pt=0,Ct=0,Mt=El(0),ut=0,Tt=null,Bt=0,ft=0,Dt=0,Pt=null,Zt=null,zt=0,Nt=1/0,qt=null,er=!1,fr=null,mr=null,$r=!1,Or=null,jr=0,Wr=0,Mn=null,hi=-1,Gi=0;function Yn(){return(Ke&6)!==0?Sr():hi!==-1?hi:hi=Sr()}function Zr(b){return(b.mode&1)===0?1:(Ke&2)!==0&&pt!==0?pt&-pt:Ay.transition!==null?(Gi===0&&(Gi=$o()),Gi):(b=yi,b!==0||(b=window.event,b=b===void 0?16:ap(b.type)),b)}function _n(b,T,B,X){if(50<Wr)throw Wr=0,Mn=null,Error(r(185));al(b,B,X),((Ke&2)===0||b!==it)&&(b===it&&((Ke&2)===0&&(ft|=B),ut===4&&aa(b,pt)),xr(b,X),B===1&&Ke===0&&(T.mode&1)===0&&(Nt=Sr()+500,Wd&&Ml()))}function xr(b,T){var B=b.callbackNode;ay(b,T);var X=Hh(b,b===it?pt:0);if(X===0)B!==null&&Lt(B),b.callbackNode=null,b.callbackPriority=0;else if(T=X&-X,b.callbackPriority!==T){if(B!=null&&Lt(B),T===1)b.tag===0?Sp(ja.bind(null,b)):by(ja.bind(null,b)),G0(function(){(Ke&6)===0&&Ml()}),B=null;else{switch(ip(X)){case 1:B=Br;break;case 4:B=Fr;break;case 16:B=Tn;break;case 536870912:B=vn;break;default:B=Tn}B=og(B,En.bind(null,b))}b.callbackPriority=T,b.callbackNode=B}}function En(b,T){if(hi=-1,Gi=0,(Ke&6)!==0)throw Error(r(327));var B=b.callbackNode;if(Es()&&b.callbackNode!==B)return null;var X=Hh(b,b===it?pt:0);if(X===0)return null;if((X&30)!==0||(X&b.expiredLanes)!==0||T)T=oa(b,X);else{T=X;var ce=Ke;Ke|=2;var pe=_i();(it!==b||pt!==T)&&(qt=null,Nt=Sr()+500,ki(b,T));do try{Ei();break}catch(gt){Pi(b,gt)}while(!0);Ju(),Ue.current=pe,Ke=ce,_t!==null?T=0:(it=null,pt=0,T=ut)}if(T!==0){if(T===2&&(ce=np(b),ce!==0&&(X=ce,T=ei(b,ce))),T===1)throw B=Tt,ki(b,0),aa(b,X),xr(b,Sr()),B;if(T===6)aa(b,X);else{if(ce=b.current.alternate,(X&30)===0&&!Qi(ce)&&(T=oa(b,X),T===2&&(pe=np(b),pe!==0&&(X=pe,T=ei(b,pe))),T===1))throw B=Tt,ki(b,0),aa(b,X),xr(b,Sr()),B;switch(b.finishedWork=ce,b.finishedLanes=X,T){case 0:case 1:throw Error(r(345));case 2:yo(b,Zt,qt);break;case 3:if(aa(b,X),(X&130023424)===X&&(T=zt+500-Sr(),10<T)){if(Hh(b,0)!==0)break;if(ce=b.suspendedLanes,(ce&X)!==X){Yn(),b.pingedLanes|=b.suspendedLanes&ce;break}b.timeoutHandle=Fm(yo.bind(null,b,Zt,qt),T);break}yo(b,Zt,qt);break;case 4:if(aa(b,X),(X&4194240)===X)break;for(T=b.eventTimes,ce=-1;0<X;){var Le=31-ho(X);pe=1<<Le,Le=T[Le],Le>ce&&(ce=Le),X&=~pe}if(X=ce,X=Sr()-X,X=(120>X?120:480>X?480:1080>X?1080:1920>X?1920:3e3>X?3e3:4320>X?4320:1960*Ze(X/1960))-X,10<X){b.timeoutHandle=Fm(yo.bind(null,b,Zt,qt),X);break}yo(b,Zt,qt);break;case 5:yo(b,Zt,qt);break;default:throw Error(r(329))}}}return xr(b,Sr()),b.callbackNode===B?En.bind(null,b):null}function ei(b,T){var B=Pt;return b.current.memoizedState.isDehydrated&&(ki(b,T).flags|=256),b=oa(b,T),b!==2&&(T=Zt,Zt=B,T!==null&&oi(T)),b}function oi(b){Zt===null?Zt=b:Zt.push.apply(Zt,b)}function Qi(b){for(var T=b;;){if(T.flags&16384){var B=T.updateQueue;if(B!==null&&(B=B.stores,B!==null))for(var X=0;X<B.length;X++){var ce=B[X],pe=ce.getSnapshot;ce=ce.value;try{if(!Go(pe(),ce))return!1}catch{return!1}}}if(B=T.child,T.subtreeFlags&16384&&B!==null)B.return=T,T=B;else{if(T===b)break;for(;T.sibling===null;){if(T.return===null||T.return===b)return!0;T=T.return}T.sibling.return=T.return,T=T.sibling}}return!0}function aa(b,T){for(T&=~Dt,T&=~ft,b.suspendedLanes|=T,b.pingedLanes&=~T,b=b.expirationTimes;0<T;){var B=31-ho(T),X=1<<B;b[B]=-1,T&=~X}}function ja(b){if((Ke&6)!==0)throw Error(r(327));Es();var T=Hh(b,0);if((T&1)===0)return xr(b,Sr()),null;var B=oa(b,T);if(b.tag!==0&&B===2){var X=np(b);X!==0&&(T=X,B=ei(b,X))}if(B===1)throw B=Tt,ki(b,0),aa(b,T),xr(b,Sr()),B;if(B===6)throw Error(r(345));return b.finishedWork=b.current.alternate,b.finishedLanes=T,yo(b,Zt,qt),xr(b,Sr()),null}function Aa(b,T){var B=Ke;Ke|=1;try{return b(T)}finally{Ke=B,Ke===0&&(Nt=Sr()+500,Wd&&Ml())}}function Co(b){Or!==null&&Or.tag===0&&(Ke&6)===0&&Es();var T=Ke;Ke|=1;var B=Ve.transition,X=yi;try{if(Ve.transition=null,yi=1,b)return b()}finally{yi=X,Ve.transition=B,Ke=T,(Ke&6)===0&&Ml()}}function Mo(){Ct=Mt.current,ga(Mt)}function ki(b,T){b.finishedWork=null,b.finishedLanes=0;var B=b.timeoutHandle;if(B!==-1&&(b.timeoutHandle=-1,c_(B)),_t!==null)for(B=_t.return;B!==null;){var X=B;switch(wy(X),X.tag){case 1:X=X.type.childContextTypes,X!=null&&Bm();break;case 3:Ss(),ga(Bs),ga(Do),Ri();break;case 5:Gm(X);break;case 4:Ss();break;case 13:ga(fi);break;case 19:ga(fi);break;case 10:Qu(X.type._context);break;case 22:case 23:Mo()}B=B.return}if(it=b,_t=b=hh(b.current,null),pt=Ct=T,ut=0,Tt=null,Dt=ft=Bt=0,Zt=Pt=null,Ol!==null){for(T=0;T<Ol.length;T++)if(B=Ol[T],X=B.interleaved,X!==null){B.interleaved=null;var ce=X.next,pe=B.pending;if(pe!==null){var Le=pe.next;pe.next=ce,X.next=Le}B.pending=X}Ol=null}return b}function Pi(b,T){do{var B=_t;try{if(Ju(),Qn.current=eg,rd){for(var X=ia.memoizedState;X!==null;){var ce=X.queue;ce!==null&&(ce.pending=null),X=X.next}rd=!1}if(As=0,ro=ua=ia=null,qs=!1,no=0,qe.current=null,B===null||B.return===null){ut=1,Tt=T,_t=null;break}e:{var pe=b,Le=B.return,gt=B,At=T;if(T=pt,gt.flags|=32768,At!==null&&typeof At=="object"&&typeof At.then=="function"){var Ht=At,Ar=gt,Mr=Ar.tag;if((Ar.mode&1)===0&&(Mr===0||Mr===11||Mr===15)){var Tr=Ar.alternate;Tr?(Ar.updateQueue=Tr.updateQueue,Ar.memoizedState=Tr.memoizedState,Ar.lanes=Tr.lanes):(Ar.updateQueue=null,Ar.memoizedState=null)}var Jr=wf(Le);if(Jr!==null){Jr.flags&=-257,rg(Jr,Le,gt,pe,T),Jr.mode&1&&Iy(pe,Ht,T),T=Jr,At=Ht;var sn=T.updateQueue;if(sn===null){var cn=new Set;cn.add(At),T.updateQueue=cn}else sn.add(At);break e}else{if((T&1)===0){Iy(pe,Ht,T),Rn();break e}At=Error(r(426))}}else if(ya&&gt.mode&1){var vo=wf(Le);if(vo!==null){(vo.flags&65536)===0&&(vo.flags|=256),rg(vo,Le,gt,pe,T),Tp(Pc(At,gt));break e}}pe=At=Pc(At,gt),ut!==4&&(ut=2),Pt===null?Pt=[pe]:Pt.push(pe),pe=Le;do{switch(pe.tag){case 3:pe.flags|=65536,T&=-T,pe.lanes|=T;var Ft=bf(pe,At,T);h_(pe,Ft);break e;case 1:gt=At;var Rt=pe.type,$t=pe.stateNode;if((pe.flags&128)===0&&(typeof Rt.getDerivedStateFromError=="function"||$t!==null&&typeof $t.componentDidCatch=="function"&&(mr===null||!mr.has($t)))){pe.flags|=65536,T&=-T,pe.lanes|=T;var kr=Ny(pe,gt,T);h_(pe,kr);break e}}pe=pe.return}while(pe!==null)}ml(B)}catch(tn){T=tn,_t===B&&B!==null&&(_t=B=B.return);continue}break}while(!0)}function _i(){var b=Ue.current;return Ue.current=eg,b===null?eg:b}function Rn(){(ut===0||ut===3||ut===2)&&(ut=4),it===null||(Bt&268435455)===0&&(ft&268435455)===0||aa(it,pt)}function oa(b,T){var B=Ke;Ke|=2;var X=_i();(it!==b||pt!==T)&&(qt=null,ki(b,T));do try{io();break}catch(ce){Pi(b,ce)}while(!0);if(Ju(),Ke=B,Ue.current=X,_t!==null)throw Error(r(261));return it=null,pt=0,ut}function io(){for(;_t!==null;)Lo(_t)}function Ei(){for(;_t!==null&&!tr();)Lo(_t)}function Lo(b){var T=Bp(b.alternate,b,Ct);b.memoizedProps=b.pendingProps,T===null?ml(b):_t=T,qe.current=null}function ml(b){var T=b;do{var B=T.alternate;if(b=T.return,(T.flags&32768)===0){if(B=ig(B,T,Ct),B!==null){_t=B;return}}else{if(B=Cc(B,T),B!==null){B.flags&=32767,_t=B;return}if(b!==null)b.flags|=32768,b.subtreeFlags=0,b.deletions=null;else{ut=6,_t=null;return}}if(T=T.sibling,T!==null){_t=T;return}_t=T=b}while(T!==null);ut===0&&(ut=5)}function yo(b,T,B){var X=yi,ce=Ve.transition;try{Ve.transition=null,yi=1,Ps(b,T,B,X)}finally{Ve.transition=ce,yi=X}return null}function Ps(b,T,B,X){do Es();while(Or!==null);if((Ke&6)!==0)throw Error(r(327));B=b.finishedWork;var ce=b.finishedLanes;if(B===null)return null;if(b.finishedWork=null,b.finishedLanes=0,B===b.current)throw Error(r(177));b.callbackNode=null,b.callbackPriority=0;var pe=B.lanes|B.childLanes;if(dc(b,pe),b===it&&(_t=it=null,pt=0),(B.subtreeFlags&2064)===0&&(B.flags&2064)===0||$r||($r=!0,og(Tn,function(){return Es(),null})),pe=(B.flags&15990)!==0,(B.subtreeFlags&15990)!==0||pe){pe=Ve.transition,Ve.transition=null;var Le=yi;yi=1;var gt=Ke;Ke|=4,qe.current=null,Tf(b,B),ye(B,b),Rm(wp),Ka=!!bp,wp=bp=null,b.current=B,xe(B),nr(),Ke=gt,yi=Le,Ve.transition=pe}else b.current=B;if($r&&($r=!1,Or=b,jr=ce),pe=b.pendingLanes,pe===0&&(mr=null),Oa(B.stateNode),xr(b,Sr()),T!==null)for(X=b.onRecoverableError,B=0;B<T.length;B++)ce=T[B],X(ce.value,{componentStack:ce.stack,digest:ce.digest});if(er)throw er=!1,b=fr,fr=null,b;return(jr&1)!==0&&b.tag!==0&&Es(),pe=b.pendingLanes,(pe&1)!==0?b===Mn?Wr++:(Wr=0,Mn=b):Wr=0,Ml(),null}function Es(){if(Or!==null){var b=ip(jr),T=Ve.transition,B=yi;try{if(Ve.transition=null,yi=16>b?16:b,Or===null)var X=!1;else{if(b=Or,Or=null,jr=0,(Ke&6)!==0)throw Error(r(331));var ce=Ke;for(Ke|=4,zr=b.current;zr!==null;){var pe=zr,Le=pe.child;if((zr.flags&16)!==0){var gt=pe.deletions;if(gt!==null){for(var At=0;At<gt.length;At++){var Ht=gt[At];for(zr=Ht;zr!==null;){var Ar=zr;switch(Ar.tag){case 0:case 11:case 15:g(8,Ar,pe)}var Mr=Ar.child;if(Mr!==null)Mr.return=Ar,zr=Mr;else for(;zr!==null;){Ar=zr;var Tr=Ar.sibling,Jr=Ar.return;if(y(Ar),Ar===Ht){zr=null;break}if(Tr!==null){Tr.return=Jr,zr=Tr;break}zr=Jr}}}var sn=pe.alternate;if(sn!==null){var cn=sn.child;if(cn!==null){sn.child=null;do{var vo=cn.sibling;cn.sibling=null,cn=vo}while(cn!==null)}}zr=pe}}if((pe.subtreeFlags&2064)!==0&&Le!==null)Le.return=pe,zr=Le;else e:for(;zr!==null;){if(pe=zr,(pe.flags&2048)!==0)switch(pe.tag){case 0:case 11:case 15:g(9,pe,pe.return)}var Ft=pe.sibling;if(Ft!==null){Ft.return=pe.return,zr=Ft;break e}zr=pe.return}}var Rt=b.current;for(zr=Rt;zr!==null;){Le=zr;var $t=Le.child;if((Le.subtreeFlags&2064)!==0&&$t!==null)$t.return=Le,zr=$t;else e:for(Le=Rt;zr!==null;){if(gt=zr,(gt.flags&2048)!==0)try{switch(gt.tag){case 0:case 11:case 15:s(9,gt)}}catch(tn){Ii(gt,gt.return,tn)}if(gt===Le){zr=null;break e}var kr=gt.sibling;if(kr!==null){kr.return=gt.return,zr=kr;break e}zr=gt.return}}if(Ke=ce,Ml(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot($n,b)}catch{}X=!0}return X}finally{yi=B,Ve.transition=T}}return!1}function gl(b,T,B){T=Pc(B,T),T=bf(b,T,1),b=nu(b,T,1),T=Yn(),b!==null&&(al(b,1,T),xr(b,T))}function Ii(b,T,B){if(b.tag===3)gl(b,b,B);else for(;T!==null;){if(T.tag===3){gl(T,b,B);break}else if(T.tag===1){var X=T.stateNode;if(typeof T.type.getDerivedStateFromError=="function"||typeof X.componentDidCatch=="function"&&(mr===null||!mr.has(X))){b=Pc(B,b),b=Ny(T,b,1),T=nu(T,b,1),b=Yn(),T!==null&&(al(T,1,b),xr(T,b));break}}T=T.return}}function uh(b,T,B){var X=b.pingCache;X!==null&&X.delete(T),T=Yn(),b.pingedLanes|=b.suspendedLanes&B,it===b&&(pt&B)===B&&(ut===4||ut===3&&(pt&130023424)===pt&&500>Sr()-zt?ki(b,0):Dt|=B),xr(b,T)}function Jl(b,T){T===0&&((b.mode&1)===0?T=1:(T=bl,bl<<=1,(bl&130023424)===0&&(bl=4194304)));var B=Yn();b=Sc(b,T),b!==null&&(al(b,T,B),xr(b,B))}function dh(b){var T=b.memoizedState,B=0;T!==null&&(B=T.retryLane),Jl(b,B)}function Pf(b,T){var B=0;switch(b.tag){case 13:var X=b.stateNode,ce=b.memoizedState;ce!==null&&(B=ce.retryLane);break;case 19:X=b.stateNode;break;default:throw Error(r(314))}X!==null&&X.delete(T),Jl(b,B)}var Bp;Bp=function(b,T,B){if(b!==null)if(b.memoizedProps!==T.pendingProps||Bs.current)ls=!0;else{if((b.lanes&B)===0&&(T.flags&128)===0)return ls=!1,lh(b,T,B);ls=(b.flags&131072)!==0}else ls=!1,ya&&(T.flags&1048576)!==0&&Cr(T,bc,T.index);switch(T.lanes=0,T.tag){case 2:var X=T.type;cs(b,T),b=T.pendingProps;var ce=Wl(T,Do.current);Yt(T,B),ce=Mp(null,T,X,b,ce,B);var pe=au();return T.flags|=1,typeof ce=="object"&&ce!==null&&typeof ce.render=="function"&&ce.$$typeof===void 0?(T.tag=1,T.memoizedState=null,T.updateQueue=null,Vs(X)?(pe=!0,Gd(T)):pe=!1,T.memoizedState=ce.state!==null&&ce.state!==void 0?ce.state:null,Ep(T),ce.updater=id,T.stateNode=ce,ce._reactInternals=T,kl(T,X,b,B),T=Dy(null,T,X,!0,pe,B)):(T.tag=0,ya&&pe&&Ap(T),Wo(null,T,ce,B),T=T.child),T;case 16:X=T.elementType;e:{switch(cs(b,T),b=T.pendingProps,ce=X._init,X=ce(X._payload),T.type=X,ce=T.tag=DS(X),b=Xl(X,b),ce){case 0:T=lu(null,T,X,b,B);break e;case 1:T=cu(null,T,X,b,B);break e;case 11:T=ad(null,T,X,b,B);break e;case 14:T=od(null,T,X,Xl(X.type,b),B);break e}throw Error(r(306,X,""))}return T;case 0:return X=T.type,ce=T.pendingProps,ce=T.elementType===X?ce:Xl(X,ce),lu(b,T,X,ce,B);case 1:return X=T.type,ce=T.pendingProps,ce=T.elementType===X?ce:Xl(X,ce),cu(b,T,X,ce,B);case 3:e:{if(p_(T),b===null)throw Error(r(387));X=T.pendingProps,pe=T.memoizedState,ce=pe.element,Ty(b,T),qm(T,X,null,B);var Le=T.memoizedState;if(X=Le.element,pe.isDehydrated)if(pe={element:X,isDehydrated:!1,cache:Le.cache,pendingSuspenseBoundaries:Le.pendingSuspenseBoundaries,transitions:Le.transitions},T.updateQueue.baseState=pe,T.memoizedState=pe,T.flags&256){ce=Pc(Error(r(423)),T),T=m_(b,T,X,B,ce);break e}else if(X!==ce){ce=Pc(Error(r(424)),T),T=m_(b,T,X,B,ce);break e}else for(ss=Ku(T.stateNode.containerInfo.firstChild),ul=T,ya=!0,dl=null,B=Pp(T,null,X,B),T.child=B;B;)B.flags=B.flags&-3|4096,B=B.sibling;else{if(fl(),X===ce){T=Ws(b,T,B);break e}Wo(b,T,X,B)}T=T.child}return T;case 5:return Tc(T),b===null&&uf(T),X=T.type,ce=T.pendingProps,pe=b!==null?b.memoizedProps:null,Le=ce.children,sf(X,ce)?Le=null:pe!==null&&sf(X,pe)&&(T.flags|=32),su(b,T),Wo(b,T,Le,B),T.child;case 6:return b===null&&uf(T),null;case 13:return Ho(b,T,B);case 4:return hf(T,T.stateNode.containerInfo),X=T.pendingProps,b===null?T.child=vi(T,null,X,B):Wo(b,T,X,B),T.child;case 11:return X=T.type,ce=T.pendingProps,ce=T.elementType===X?ce:Xl(X,ce),ad(b,T,X,ce,B);case 7:return Wo(b,T,T.pendingProps,B),T.child;case 8:return Wo(b,T,T.pendingProps.children,B),T.child;case 12:return Wo(b,T,T.pendingProps.children,B),T.child;case 10:e:{if(X=T.type._context,ce=T.pendingProps,pe=T.memoizedProps,Le=ce.value,Ji(Yu,X._currentValue),X._currentValue=Le,pe!==null)if(Go(pe.value,Le)){if(pe.children===ce.children&&!Bs.current){T=Ws(b,T,B);break e}}else for(pe=T.child,pe!==null&&(pe.return=T);pe!==null;){var gt=pe.dependencies;if(gt!==null){Le=pe.child;for(var At=gt.firstContext;At!==null;){if(At.context===X){if(pe.tag===1){At=Ac(-1,B&-B),At.tag=2;var Ht=pe.updateQueue;if(Ht!==null){Ht=Ht.shared;var Ar=Ht.pending;Ar===null?At.next=At:(At.next=Ar.next,Ar.next=At),Ht.pending=At}}pe.lanes|=B,At=pe.alternate,At!==null&&(At.lanes|=B),ed(pe.return,B,T),gt.lanes|=B;break}At=At.next}}else if(pe.tag===10)Le=pe.type===T.type?null:pe.child;else if(pe.tag===18){if(Le=pe.return,Le===null)throw Error(r(341));Le.lanes|=B,gt=Le.alternate,gt!==null&&(gt.lanes|=B),ed(Le,B,T),Le=pe.sibling}else Le=pe.child;if(Le!==null)Le.return=pe;else for(Le=pe;Le!==null;){if(Le===T){Le=null;break}if(pe=Le.sibling,pe!==null){pe.return=Le.return,Le=pe;break}Le=Le.return}pe=Le}Wo(b,T,ce.children,B),T=T.child}return T;case 9:return ce=T.type,X=T.pendingProps.children,Yt(T,B),ce=or(ce),X=X(ce),T.flags|=1,Wo(b,T,X,B),T.child;case 14:return X=T.type,ce=Xl(X,T.pendingProps),ce=Xl(X.type,ce),od(b,T,X,ce,B);case 15:return Ec(b,T,T.type,T.pendingProps,B);case 17:return X=T.type,ce=T.pendingProps,ce=T.elementType===X?ce:Xl(X,ce),cs(b,T),T.tag=1,Vs(X)?(b=!0,Gd(T)):b=!1,Yt(T,B),_f(T,X,ce),kl(T,X,ce,B),Dy(null,T,X,!0,b,B);case 19:return Ks(b,T,B);case 22:return jl(b,T,B)}throw Error(r(156,T.tag))};function og(b,T){return St(b,T)}function IS(b,T,B,X){this.tag=b,this.key=B,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=T,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=X,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(b,T,B,X){return new IS(b,T,B,X)}function Z0(b){return b=b.prototype,!(!b||!b.isReactComponent)}function DS(b){if(typeof b=="function")return Z0(b)?1:0;if(b!=null){if(b=b.$$typeof,b===ke)return 11;if(b===je)return 14}return 2}function hh(b,T){var B=b.alternate;return B===null?(B=Mc(b.tag,T,b.key,b.mode),B.elementType=b.elementType,B.type=b.type,B.stateNode=b.stateNode,B.alternate=b,b.alternate=B):(B.pendingProps=T,B.type=b.type,B.flags=0,B.subtreeFlags=0,B.deletions=null),B.flags=b.flags&14680064,B.childLanes=b.childLanes,B.lanes=b.lanes,B.child=b.child,B.memoizedProps=b.memoizedProps,B.memoizedState=b.memoizedState,B.updateQueue=b.updateQueue,T=b.dependencies,B.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext},B.sibling=b.sibling,B.index=b.index,B.ref=b.ref,B}function Ly(b,T,B,X,ce,pe){var Le=2;if(X=b,typeof b=="function")Z0(b)&&(Le=1);else if(typeof b=="string")Le=5;else e:switch(b){case ue:return Ef(B.children,ce,pe,T);case ve:Le=8,ce|=8;break;case Ae:return b=Mc(12,B,T,ce|2),b.elementType=Ae,b.lanes=pe,b;case ze:return b=Mc(13,B,T,ce),b.elementType=ze,b.lanes=pe,b;case et:return b=Mc(19,B,T,ce),b.elementType=et,b.lanes=pe,b;case Ye:return zy(B,ce,pe,T);default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case Oe:Le=10;break e;case Se:Le=9;break e;case ke:Le=11;break e;case je:Le=14;break e;case Ne:Le=16,X=null;break e}throw Error(r(130,b==null?b:typeof b,""))}return T=Mc(Le,B,T,ce),T.elementType=b,T.type=X,T.lanes=pe,T}function Ef(b,T,B,X){return b=Mc(7,b,X,T),b.lanes=B,b}function zy(b,T,B,X){return b=Mc(22,b,X,T),b.elementType=Ye,b.lanes=B,b.stateNode={isHidden:!1},b}function y_(b,T,B){return b=Mc(6,b,null,T),b.lanes=B,b}function v_(b,T,B){return T=Mc(4,b.children!==null?b.children:[],b.key,T),T.lanes=B,T.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},T}function Y0(b,T,B,X,ce){this.tag=T,this.containerInfo=b,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=il(0),this.expirationTimes=il(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=il(0),this.identifierPrefix=X,this.onRecoverableError=ce,this.mutableSourceEagerHydrationData=null}function cd(b,T,B,X,ce,pe,Le,gt,At){return b=new Y0(b,T,B,gt,At),T===1?(T=1,pe===!0&&(T|=8)):T=0,pe=Mc(3,null,null,T),b.current=pe,pe.stateNode=b,pe.memoizedState={element:X,isDehydrated:B,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ep(pe),b}function zo(b,T,B){var X=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:de,key:X==null?null:""+X,children:b,containerInfo:T,implementation:B}}function X0(b){if(!b)return Cl;b=b._reactInternals;e:{if(He(b)!==b||b.tag!==1)throw Error(r(170));var T=b;do{switch(T.tag){case 3:T=T.stateNode.context;break e;case 1:if(Vs(T.type)){T=T.stateNode.__reactInternalMemoizedMergedChildContext;break e}}T=T.return}while(T!==null);throw Error(r(171))}if(b.tag===1){var B=b.type;if(Vs(B))return xy(b,B,T)}return T}function sg(b,T,B,X,ce,pe,Le,gt,At){return b=cd(B,X,!0,b,ce,pe,Le,gt,At),b.context=X0(null),B=b.current,X=Yn(),ce=Zr(B),pe=Ac(X,ce),pe.callback=T??null,nu(B,pe,ce),b.current.lanes=ce,al(b,ce,X),xr(b,X),b}function __(b,T,B,X){var ce=T.current,pe=Yn(),Le=Zr(ce);return B=X0(B),T.context===null?T.context=B:T.pendingContext=B,T=Ac(pe,Le),T.payload={element:b},X=X===void 0?null:X,X!==null&&(T.callback=X),b=nu(ce,T,Le),b!==null&&(_n(b,ce,Le,pe),iu(b,ce,Le)),Le}function x_(b){if(b=b.current,!b.child)return null;switch(b.child.tag){case 5:return b.child.stateNode;default:return b.child.stateNode}}function lg(b,T){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var B=b.retryLane;b.retryLane=B!==0&&B<T?B:T}}function b_(b,T){lg(b,T),(b=b.alternate)&&lg(b,T)}function Vp(){return null}var cg=typeof reportError=="function"?reportError:function(b){console.error(b)};function J0(b){this._internalRoot=b}w_.prototype.render=J0.prototype.render=function(b){var T=this._internalRoot;if(T===null)throw Error(r(409));__(b,T,null,null)},w_.prototype.unmount=J0.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var T=b.containerInfo;Co(function(){__(null,b,null,null)}),T[Pl]=null}};function w_(b){this._internalRoot=b}w_.prototype.unstable_scheduleHydration=function(b){if(b){var T=oy();b={blockedOn:null,target:b,priority:T};for(var B=0;B<dn.length&&T!==0&&T<dn[B].priority;B++);dn.splice(B,0,b),B===0&&Wn(b)}};function Q0(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function S_(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11&&(b.nodeType!==8||b.nodeValue!==" react-mount-point-unstable "))}function LS(){}function AE(b,T,B,X,ce){if(ce){if(typeof X=="function"){var pe=X;X=function(){var Ht=x_(Le);pe.call(Ht)}}var Le=sg(T,X,b,0,null,!1,!1,"",LS);return b._reactRootContainer=Le,b[Pl]=Le.current,af(b.nodeType===8?b.parentNode:b),Co(),Le}for(;ce=b.lastChild;)b.removeChild(ce);if(typeof X=="function"){var gt=X;X=function(){var Ht=x_(At);gt.call(Ht)}}var At=cd(b,0,!1,null,null,!1,!1,"",LS);return b._reactRootContainer=At,b[Pl]=At.current,af(b.nodeType===8?b.parentNode:b),Co(function(){__(T,At,B,X)}),At}function A_(b,T,B,X,ce){var pe=B._reactRootContainer;if(pe){var Le=pe;if(typeof ce=="function"){var gt=ce;ce=function(){var At=x_(Le);gt.call(At)}}__(T,Le,b,ce)}else Le=AE(B,T,b,ce,X);return x_(Le)}wm=function(b){switch(b.tag){case 3:var T=b.stateNode;if(T.current.memoizedState.isDehydrated){var B=$c(T.pendingLanes);B!==0&&(ol(T,B|1),xr(T,Sr()),(Ke&6)===0&&(Nt=Sr()+500,Ml()))}break;case 13:Co(function(){var X=Sc(b,1);if(X!==null){var ce=Yn();_n(X,b,1,ce)}}),b_(b,1)}},hc=function(b){if(b.tag===13){var T=Sc(b,134217728);if(T!==null){var B=Yn();_n(T,b,134217728,B)}b_(b,134217728)}},qc=function(b){if(b.tag===13){var T=Zr(b),B=Sc(b,T);if(B!==null){var X=Yn();_n(B,b,T,X)}b_(b,T)}},oy=function(){return yi},Sm=function(b,T){var B=yi;try{return yi=b,T()}finally{yi=B}},ku=function(b,T,B){switch(T){case"input":if(Xr(b,B),T=B.name,B.type==="radio"&&T!=null){for(B=b;B.parentNode;)B=B.parentNode;for(B=B.querySelectorAll("input[name="+JSON.stringify(""+T)+'][type="radio"]'),T=0;T<B.length;T++){var X=B[T];if(X!==b&&X.form===b.form){var ce=cf(X);if(!ce)throw Error(r(90));Jt(X),Xr(X,ce)}}}break;case"textarea":dr(b,B);break;case"select":T=B.value,T!=null&&Pr(b,!!B.multiple,T,!1)}},wo=Aa,xl=Co;var eb={usingClientEntryPoint:!1,Events:[qd,ll,cf,fa,Ca,Aa]},Fy={findFiberByHostInstance:Hu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ug={bundleType:Fy.bundleType,version:Fy.version,rendererPackageName:Fy.rendererPackageName,rendererConfig:Fy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:le.ReactCurrentDispatcher,findHostInstanceByFiber:function(b){return b=bt(b),b===null?null:b.stateNode},findFiberByHostInstance:Fy.findFiberByHostInstance||Vp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var T_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!T_.isDisabled&&T_.supportsFiber)try{$n=T_.inject(ug),Pn=T_}catch{}}return Oc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eb,Oc.createPortal=function(b,T){var B=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q0(T))throw Error(r(200));return zo(b,T,null,B)},Oc.createRoot=function(b,T){if(!Q0(b))throw Error(r(299));var B=!1,X="",ce=cg;return T!=null&&(T.unstable_strictMode===!0&&(B=!0),T.identifierPrefix!==void 0&&(X=T.identifierPrefix),T.onRecoverableError!==void 0&&(ce=T.onRecoverableError)),T=cd(b,1,!1,null,null,B,!1,X,ce),b[Pl]=T.current,af(b.nodeType===8?b.parentNode:b),new J0(T)},Oc.findDOMNode=function(b){if(b==null)return null;if(b.nodeType===1)return b;var T=b._reactInternals;if(T===void 0)throw typeof b.render=="function"?Error(r(188)):(b=Object.keys(b).join(","),Error(r(268,b)));return b=bt(T),b=b===null?null:b.stateNode,b},Oc.flushSync=function(b){return Co(b)},Oc.hydrate=function(b,T,B){if(!S_(T))throw Error(r(200));return A_(null,b,T,!0,B)},Oc.hydrateRoot=function(b,T,B){if(!Q0(b))throw Error(r(405));var X=B!=null&&B.hydratedSources||null,ce=!1,pe="",Le=cg;if(B!=null&&(B.unstable_strictMode===!0&&(ce=!0),B.identifierPrefix!==void 0&&(pe=B.identifierPrefix),B.onRecoverableError!==void 0&&(Le=B.onRecoverableError)),T=sg(T,null,b,1,B??null,ce,!1,pe,Le),b[Pl]=T.current,af(b),X)for(b=0;b<X.length;b++)B=X[b],ce=B._getVersion,ce=ce(B._source),T.mutableSourceEagerHydrationData==null?T.mutableSourceEagerHydrationData=[B,ce]:T.mutableSourceEagerHydrationData.push(B,ce);return new w_(T)},Oc.render=function(b,T,B){if(!S_(T))throw Error(r(200));return A_(null,b,T,!1,B)},Oc.unmountComponentAtNode=function(b){if(!S_(b))throw Error(r(40));return b._reactRootContainer?(Co(function(){A_(null,null,b,!1,function(){b._reactRootContainer=null,b[Pl]=null})}),!0):!1},Oc.unstable_batchedUpdates=Aa,Oc.unstable_renderSubtreeIntoContainer=function(b,T,B,X){if(!S_(B))throw Error(r(200));if(b==null||b._reactInternals===void 0)throw Error(r(38));return A_(b,T,B,!1,X)},Oc.version="18.3.1-next-f1338f8080-20240426",Oc}var tB;function mK(){if(tB)return DC.exports;tB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),DC.exports=Yoe(),DC.exports}var Fw=mK();const gK=ta(Fw);function Xoe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const Joe=e=>{switch(e){case"success":return tse;case"info":return nse;case"warning":return rse;case"error":return ise;default:return null}},Qoe=Array(12).fill(0),ese=({visible:e,className:t})=>Pe.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Pe.createElement("div",{className:"sonner-spinner"},Qoe.map((r,n)=>Pe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),tse=Pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Pe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),rse=Pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Pe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),nse=Pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Pe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ise=Pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Pe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ase=Pe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Pe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Pe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),ose=()=>{const[e,t]=Pe.useState(document.hidden);return Pe.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let Vj=1;class sse{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...a}=t,l=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:Vj++,h=this.toasts.find(_=>_.id===l),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(l)&&this.dismissedToasts.delete(l),h?this.toasts=this.toasts.map(_=>_.id===l?(this.publish({..._,...t,id:l,title:n}),{..._,...t,id:l,dismissible:i,title:n}):_):this.addToast({title:n,...a,dismissible:i,id:l}),l},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0}))),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let l=n!==void 0,h;const i=a.then(async w=>{if(h=["resolve",w],Pe.isValidElement(w))l=!1,this.create({id:n,type:"default",message:w});else if(cse(w)&&!w.ok){l=!1;const C=typeof r.error=="function"?await r.error(`HTTP error! status: ${w.status}`):r.error,R=typeof r.description=="function"?await r.description(`HTTP error! status: ${w.status}`):r.description,z=typeof C=="object"?C:{message:C};this.create({id:n,type:"error",description:R,...z})}else if(w instanceof Error){l=!1;const C=typeof r.error=="function"?await r.error(w):r.error,R=typeof r.description=="function"?await r.description(w):r.description,z=typeof C=="object"?C:{message:C};this.create({id:n,type:"error",description:R,...z})}else if(r.success!==void 0){l=!1;const C=typeof r.success=="function"?await r.success(w):r.success,R=typeof r.description=="function"?await r.description(w):r.description,z=typeof C=="object"?C:{message:C};this.create({id:n,type:"success",description:R,...z})}}).catch(async w=>{if(h=["reject",w],r.error!==void 0){l=!1;const A=typeof r.error=="function"?await r.error(w):r.error,C=typeof r.description=="function"?await r.description(w):r.description,R=typeof A=="object"?A:{message:A};this.create({id:n,type:"error",description:C,...R})}}).finally(()=>{l&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),_=()=>new Promise((w,A)=>i.then(()=>h[0]==="reject"?A(h[1]):w(h[1])).catch(A));return typeof n!="string"&&typeof n!="number"?{unwrap:_}:Object.assign(n,{unwrap:_})},this.custom=(t,r)=>{const n=(r==null?void 0:r.id)||Vj++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const jc=new sse,lse=(e,t)=>{const r=(t==null?void 0:t.id)||Vj++;return jc.addToast({title:e,...t,id:r}),r},cse=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",use=lse,dse=()=>jc.toasts,hse=()=>jc.getActiveToasts(),Ni=Object.assign(use,{success:jc.success,info:jc.info,warning:jc.warning,error:jc.error,custom:jc.custom,message:jc.message,promise:jc.promise,dismiss:jc.dismiss,loading:jc.loading},{getHistory:dse,getToasts:hse});Xoe("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function A2(e){return e.label!==void 0}const fse=3,pse="24px",mse="16px",rB=4e3,gse=356,yse=14,vse=45,_se=200;function Of(...e){return e.filter(Boolean).join(" ")}function xse(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const bse=e=>{var t,r,n,a,l,h,i,_,w;const{invert:A,toast:C,unstyled:R,interacting:z,setHeights:V,visibleToasts:U,heights:G,index:H,toasts:J,expanded:Q,removeToast:le,defaultRichColors:ne,closeButton:de,style:ue,cancelButtonStyle:ve,actionButtonStyle:Ae,className:Oe="",descriptionClassName:Se="",duration:ke,position:ze,gap:et,expandByDefault:je,classNames:Ne,icons:Ye,closeButtonAriaLabel:$e="Close toast"}=e,[We,Et]=Pe.useState(null),[Je,ht]=Pe.useState(null),[tt,Qt]=Pe.useState(!1),[gr,sr]=Pe.useState(!1),[ur,br]=Pe.useState(!1),[Wt,Be]=Pe.useState(!1),[Nr,Jt]=Pe.useState(!1),[Sn,It]=Pe.useState(0),[Vn,Un]=Pe.useState(0),Xr=Pe.useRef(C.duration||ke||rB),rt=Pe.useRef(null),Ot=Pe.useRef(null),Kt=H===0,Pr=H+1<=U,yr=C.type,wr=C.dismissible!==!1,dr=C.className||"",An=C.descriptionClassName||"",Ti=Pe.useMemo(()=>G.findIndex(Kn=>Kn.toastId===C.id)||0,[G,C.id]),Bi=Pe.useMemo(()=>{var Kn;return(Kn=C.closeButton)!=null?Kn:de},[C.closeButton,de]),Vi=Pe.useMemo(()=>C.duration||ke||rB,[C.duration,ke]),is=Pe.useRef(0),$a=Pe.useRef(0),Vo=Pe.useRef(0),ys=Pe.useRef(null),[Qa,$l]=ze.split("-"),_l=Pe.useMemo(()=>G.reduce((Kn,fa,Ca)=>Ca>=Ti?Kn:Kn+fa.height,0),[G,Ti]),jo=ose(),ql=C.invert||A,rn=yr==="loading";$a.current=Pe.useMemo(()=>Ti*et+_l,[Ti,_l]),Pe.useEffect(()=>{Xr.current=Vi},[Vi]),Pe.useEffect(()=>{Qt(!0)},[]),Pe.useEffect(()=>{const Kn=Ot.current;if(Kn){const fa=Kn.getBoundingClientRect().height;return Un(fa),V(Ca=>[{toastId:C.id,height:fa,position:C.position},...Ca]),()=>V(Ca=>Ca.filter(wo=>wo.toastId!==C.id))}},[V,C.id]),Pe.useLayoutEffect(()=>{if(!tt)return;const Kn=Ot.current,fa=Kn.style.height;Kn.style.height="auto";const Ca=Kn.getBoundingClientRect().height;Kn.style.height=fa,Un(Ca),V(wo=>wo.find(Ma=>Ma.toastId===C.id)?wo.map(Ma=>Ma.toastId===C.id?{...Ma,height:Ca}:Ma):[{toastId:C.id,height:Ca,position:C.position},...wo])},[tt,C.title,C.description,V,C.id]);const eo=Pe.useCallback(()=>{sr(!0),It($a.current),V(Kn=>Kn.filter(fa=>fa.toastId!==C.id)),setTimeout(()=>{le(C)},_se)},[C,le,V,$a]);Pe.useEffect(()=>{if(C.promise&&yr==="loading"||C.duration===1/0||C.type==="loading")return;let Kn;return Q||z||jo?(()=>{if(Vo.current<is.current){const wo=new Date().getTime()-is.current;Xr.current=Xr.current-wo}Vo.current=new Date().getTime()})():(()=>{Xr.current!==1/0&&(is.current=new Date().getTime(),Kn=setTimeout(()=>{C.onAutoClose==null||C.onAutoClose.call(C,C),eo()},Xr.current))})(),()=>clearTimeout(Kn)},[Q,z,C,yr,jo,eo]),Pe.useEffect(()=>{C.delete&&eo()},[eo,C.delete]);function ku(){var Kn;if(Ye!=null&&Ye.loading){var fa;return Pe.createElement("div",{className:Of(Ne==null?void 0:Ne.loader,C==null||(fa=C.classNames)==null?void 0:fa.loader,"sonner-loader"),"data-visible":yr==="loading"},Ye.loading)}return Pe.createElement(ese,{className:Of(Ne==null?void 0:Ne.loader,C==null||(Kn=C.classNames)==null?void 0:Kn.loader),visible:yr==="loading"})}var qa,Uo;return Pe.createElement("li",{tabIndex:0,ref:Ot,className:Of(Oe,dr,Ne==null?void 0:Ne.toast,C==null||(t=C.classNames)==null?void 0:t.toast,Ne==null?void 0:Ne.default,Ne==null?void 0:Ne[yr],C==null||(r=C.classNames)==null?void 0:r[yr]),"data-sonner-toast":"","data-rich-colors":(qa=C.richColors)!=null?qa:ne,"data-styled":!(C.jsx||C.unstyled||R),"data-mounted":tt,"data-promise":!!C.promise,"data-swiped":Nr,"data-removed":gr,"data-visible":Pr,"data-y-position":Qa,"data-x-position":$l,"data-index":H,"data-front":Kt,"data-swiping":ur,"data-dismissible":wr,"data-type":yr,"data-invert":ql,"data-swipe-out":Wt,"data-swipe-direction":Je,"data-expanded":!!(Q||je&&tt),style:{"--index":H,"--toasts-before":H,"--z-index":J.length-H,"--offset":`${gr?Sn:$a.current}px`,"--initial-height":je?"auto":`${Vn}px`,...ue,...C.style},onDragEnd:()=>{br(!1),Et(null),ys.current=null},onPointerDown:Kn=>{rn||!wr||(rt.current=new Date,It($a.current),Kn.target.setPointerCapture(Kn.pointerId),Kn.target.tagName!=="BUTTON"&&(br(!0),ys.current={x:Kn.clientX,y:Kn.clientY}))},onPointerUp:()=>{var Kn,fa,Ca;if(Wt||!wr)return;ys.current=null;const wo=Number(((Kn=Ot.current)==null?void 0:Kn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),xl=Number(((fa=Ot.current)==null?void 0:fa.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ma=new Date().getTime()-((Ca=rt.current)==null?void 0:Ca.getTime()),No=We==="x"?wo:xl,Ui=Math.abs(No)/Ma;if(Math.abs(No)>=vse||Ui>.11){It($a.current),C.onDismiss==null||C.onDismiss.call(C,C),ht(We==="x"?wo>0?"right":"left":xl>0?"down":"up"),eo(),Be(!0);return}else{var So,uo;(So=Ot.current)==null||So.style.setProperty("--swipe-amount-x","0px"),(uo=Ot.current)==null||uo.style.setProperty("--swipe-amount-y","0px")}Jt(!1),br(!1),Et(null)},onPointerMove:Kn=>{var fa,Ca,wo;if(!ys.current||!wr||((fa=window.getSelection())==null?void 0:fa.toString().length)>0)return;const Ma=Kn.clientY-ys.current.y,No=Kn.clientX-ys.current.x;var Ui;const So=(Ui=e.swipeDirections)!=null?Ui:xse(ze);!We&&(Math.abs(No)>1||Math.abs(Ma)>1)&&Et(Math.abs(No)>Math.abs(Ma)?"x":"y");let uo={x:0,y:0};const ju=Wi=>1/(1.5+Math.abs(Wi)/20);if(We==="y"){if(So.includes("top")||So.includes("bottom"))if(So.includes("top")&&Ma<0||So.includes("bottom")&&Ma>0)uo.y=Ma;else{const Wi=Ma*ju(Ma);uo.y=Math.abs(Wi)<Math.abs(Ma)?Wi:Ma}}else if(We==="x"&&(So.includes("left")||So.includes("right")))if(So.includes("left")&&No<0||So.includes("right")&&No>0)uo.x=No;else{const Wi=No*ju(No);uo.x=Math.abs(Wi)<Math.abs(No)?Wi:No}(Math.abs(uo.x)>0||Math.abs(uo.y)>0)&&Jt(!0),(Ca=Ot.current)==null||Ca.style.setProperty("--swipe-amount-x",`${uo.x}px`),(wo=Ot.current)==null||wo.style.setProperty("--swipe-amount-y",`${uo.y}px`)}},Bi&&!C.jsx&&yr!=="loading"?Pe.createElement("button",{"aria-label":$e,"data-disabled":rn,"data-close-button":!0,onClick:rn||!wr?()=>{}:()=>{eo(),C.onDismiss==null||C.onDismiss.call(C,C)},className:Of(Ne==null?void 0:Ne.closeButton,C==null||(n=C.classNames)==null?void 0:n.closeButton)},(Uo=Ye==null?void 0:Ye.close)!=null?Uo:ase):null,yr||C.icon||C.promise?Pe.createElement("div",{"data-icon":"",className:Of(Ne==null?void 0:Ne.icon,C==null||(a=C.classNames)==null?void 0:a.icon)},C.promise||C.type==="loading"&&!C.icon?C.icon||ku():null,C.type!=="loading"?C.icon||(Ye==null?void 0:Ye[yr])||Joe(yr):null):null,Pe.createElement("div",{"data-content":"",className:Of(Ne==null?void 0:Ne.content,C==null||(l=C.classNames)==null?void 0:l.content)},Pe.createElement("div",{"data-title":"",className:Of(Ne==null?void 0:Ne.title,C==null||(h=C.classNames)==null?void 0:h.title)},C.jsx?C.jsx:typeof C.title=="function"?C.title():C.title),C.description?Pe.createElement("div",{"data-description":"",className:Of(Se,An,Ne==null?void 0:Ne.description,C==null||(i=C.classNames)==null?void 0:i.description)},typeof C.description=="function"?C.description():C.description):null),Pe.isValidElement(C.cancel)?C.cancel:C.cancel&&A2(C.cancel)?Pe.createElement("button",{"data-button":!0,"data-cancel":!0,style:C.cancelButtonStyle||ve,onClick:Kn=>{A2(C.cancel)&&wr&&(C.cancel.onClick==null||C.cancel.onClick.call(C.cancel,Kn),eo())},className:Of(Ne==null?void 0:Ne.cancelButton,C==null||(_=C.classNames)==null?void 0:_.cancelButton)},C.cancel.label):null,Pe.isValidElement(C.action)?C.action:C.action&&A2(C.action)?Pe.createElement("button",{"data-button":!0,"data-action":!0,style:C.actionButtonStyle||Ae,onClick:Kn=>{A2(C.action)&&(C.action.onClick==null||C.action.onClick.call(C.action,Kn),!Kn.defaultPrevented&&eo())},className:Of(Ne==null?void 0:Ne.actionButton,C==null||(w=C.classNames)==null?void 0:w.actionButton)},C.action.label):null)};function nB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function wse(e,t){const r={};return[e,t].forEach((n,a)=>{const l=a===1,h=l?"--mobile-offset":"--offset",i=l?mse:pse;function _(w){["top","right","bottom","left"].forEach(A=>{r[`${h}-${A}`]=typeof w=="number"?`${w}px`:w})}typeof n=="number"||typeof n=="string"?_(n):typeof n=="object"?["top","right","bottom","left"].forEach(w=>{n[w]===void 0?r[`${h}-${w}`]=i:r[`${h}-${w}`]=typeof n[w]=="number"?`${n[w]}px`:n[w]}):_(i)}),r}const Sse=Pe.forwardRef(function(t,r){const{invert:n,position:a="bottom-right",hotkey:l=["altKey","KeyT"],expand:h,closeButton:i,className:_,offset:w,mobileOffset:A,theme:C="light",richColors:R,duration:z,style:V,visibleToasts:U=fse,toastOptions:G,dir:H=nB(),gap:J=yse,icons:Q,containerAriaLabel:le="Notifications"}=t,[ne,de]=Pe.useState([]),ue=Pe.useMemo(()=>Array.from(new Set([a].concat(ne.filter(Je=>Je.position).map(Je=>Je.position)))),[ne,a]),[ve,Ae]=Pe.useState([]),[Oe,Se]=Pe.useState(!1),[ke,ze]=Pe.useState(!1),[et,je]=Pe.useState(C!=="system"?C:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Ne=Pe.useRef(null),Ye=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),$e=Pe.useRef(null),We=Pe.useRef(!1),Et=Pe.useCallback(Je=>{de(ht=>{var tt;return(tt=ht.find(Qt=>Qt.id===Je.id))!=null&&tt.delete||jc.dismiss(Je.id),ht.filter(({id:Qt})=>Qt!==Je.id)})},[]);return Pe.useEffect(()=>jc.subscribe(Je=>{if(Je.dismiss){const ht=ne.map(tt=>tt.id===Je.id?{...tt,delete:!0}:tt);requestAnimationFrame(()=>{de(ht)});return}setTimeout(()=>{gK.flushSync(()=>{de(ht=>{const tt=ht.findIndex(Qt=>Qt.id===Je.id);return tt!==-1?[...ht.slice(0,tt),{...ht[tt],...Je},...ht.slice(tt+1)]:[Je,...ht]})})})}),[ne]),Pe.useEffect(()=>{if(C!=="system"){je(C);return}if(C==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?je("dark"):je("light")),typeof window>"u")return;const Je=window.matchMedia("(prefers-color-scheme: dark)");try{Je.addEventListener("change",({matches:ht})=>{je(ht?"dark":"light")})}catch{Je.addListener(({matches:tt})=>{try{je(tt?"dark":"light")}catch(Qt){console.error(Qt)}})}},[C]),Pe.useEffect(()=>{ne.length<=1&&Se(!1)},[ne]),Pe.useEffect(()=>{const Je=ht=>{var tt;if(l.every(sr=>ht[sr]||ht.code===sr)){var gr;Se(!0),(gr=Ne.current)==null||gr.focus()}ht.code==="Escape"&&(document.activeElement===Ne.current||(tt=Ne.current)!=null&&tt.contains(document.activeElement))&&Se(!1)};return document.addEventListener("keydown",Je),()=>document.removeEventListener("keydown",Je)},[l]),Pe.useEffect(()=>{if(Ne.current)return()=>{$e.current&&($e.current.focus({preventScroll:!0}),$e.current=null,We.current=!1)}},[Ne.current]),Pe.createElement("section",{ref:r,"aria-label":`${le} ${Ye}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ue.map((Je,ht)=>{var tt;const[Qt,gr]=Je.split("-");return ne.length?Pe.createElement("ol",{key:Je,dir:H==="auto"?nB():H,tabIndex:-1,ref:Ne,className:_,"data-sonner-toaster":!0,"data-sonner-theme":et,"data-y-position":Qt,"data-lifted":Oe&&ne.length>1&&!h,"data-x-position":gr,style:{"--front-toast-height":`${((tt=ve[0])==null?void 0:tt.height)||0}px`,"--width":`${gse}px`,"--gap":`${J}px`,...V,...wse(w,A)},onBlur:sr=>{We.current&&!sr.currentTarget.contains(sr.relatedTarget)&&(We.current=!1,$e.current&&($e.current.focus({preventScroll:!0}),$e.current=null))},onFocus:sr=>{sr.target instanceof HTMLElement&&sr.target.dataset.dismissible==="false"||We.current||(We.current=!0,$e.current=sr.relatedTarget)},onMouseEnter:()=>Se(!0),onMouseMove:()=>Se(!0),onMouseLeave:()=>{ke||Se(!1)},onDragEnd:()=>Se(!1),onPointerDown:sr=>{sr.target instanceof HTMLElement&&sr.target.dataset.dismissible==="false"||ze(!0)},onPointerUp:()=>ze(!1)},ne.filter(sr=>!sr.position&&ht===0||sr.position===Je).map((sr,ur)=>{var br,Wt;return Pe.createElement(bse,{key:sr.id,icons:Q,index:ur,toast:sr,defaultRichColors:R,duration:(br=G==null?void 0:G.duration)!=null?br:z,className:G==null?void 0:G.className,descriptionClassName:G==null?void 0:G.descriptionClassName,invert:n,visibleToasts:U,closeButton:(Wt=G==null?void 0:G.closeButton)!=null?Wt:i,interacting:ke,position:Je,style:G==null?void 0:G.style,unstyled:G==null?void 0:G.unstyled,classNames:G==null?void 0:G.classNames,cancelButtonStyle:G==null?void 0:G.cancelButtonStyle,actionButtonStyle:G==null?void 0:G.actionButtonStyle,closeButtonAriaLabel:G==null?void 0:G.closeButtonAriaLabel,removeToast:Et,toasts:ne.filter(Be=>Be.position==sr.position),heights:ve.filter(Be=>Be.position==sr.position),setHeights:Ae,expandByDefault:h,gap:J,expanded:Oe,swipeDirections:t.swipeDirections})})):null}))}),Ase=({...e})=>{const{theme:t="system"}=Woe();return f.jsx(Sse,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Rb={},iB;function Tse(){if(iB)return Rb;iB=1,Object.defineProperty(Rb,"__esModule",{value:!0}),Rb.parse=h,Rb.serialize=w;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,l=(()=>{const R=function(){};return R.prototype=Object.create(null),R})();function h(R,z){const V=new l,U=R.length;if(U<2)return V;const G=(z==null?void 0:z.decode)||A;let H=0;do{const J=R.indexOf("=",H);if(J===-1)break;const Q=R.indexOf(";",H),le=Q===-1?U:Q;if(J>le){H=R.lastIndexOf(";",J-1)+1;continue}const ne=i(R,H,J),de=_(R,J,ne),ue=R.slice(ne,de);if(V[ue]===void 0){let ve=i(R,J+1,le),Ae=_(R,le,ve);const Oe=G(R.slice(ve,Ae));V[ue]=Oe}H=le+1}while(H<U);return V}function i(R,z,V){do{const U=R.charCodeAt(z);if(U!==32&&U!==9)return z}while(++z<V);return V}function _(R,z,V){for(;z>V;){const U=R.charCodeAt(--z);if(U!==32&&U!==9)return z+1}return V}function w(R,z,V){const U=(V==null?void 0:V.encode)||encodeURIComponent;if(!e.test(R))throw new TypeError(`argument name is invalid: ${R}`);const G=U(z);if(!t.test(G))throw new TypeError(`argument val is invalid: ${z}`);let H=R+"="+G;if(!V)return H;if(V.maxAge!==void 0){if(!Number.isInteger(V.maxAge))throw new TypeError(`option maxAge is invalid: ${V.maxAge}`);H+="; Max-Age="+V.maxAge}if(V.domain){if(!r.test(V.domain))throw new TypeError(`option domain is invalid: ${V.domain}`);H+="; Domain="+V.domain}if(V.path){if(!n.test(V.path))throw new TypeError(`option path is invalid: ${V.path}`);H+="; Path="+V.path}if(V.expires){if(!C(V.expires)||!Number.isFinite(V.expires.valueOf()))throw new TypeError(`option expires is invalid: ${V.expires}`);H+="; Expires="+V.expires.toUTCString()}if(V.httpOnly&&(H+="; HttpOnly"),V.secure&&(H+="; Secure"),V.partitioned&&(H+="; Partitioned"),V.priority)switch(typeof V.priority=="string"?V.priority.toLowerCase():void 0){case"low":H+="; Priority=Low";break;case"medium":H+="; Priority=Medium";break;case"high":H+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${V.priority}`)}if(V.sameSite)switch(typeof V.sameSite=="string"?V.sameSite.toLowerCase():V.sameSite){case!0:case"strict":H+="; SameSite=Strict";break;case"lax":H+="; SameSite=Lax";break;case"none":H+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${V.sameSite}`)}return H}function A(R){if(R.indexOf("%")===-1)return R;try{return decodeURIComponent(R)}catch{return R}}function C(R){return a.call(R)==="[object Date]"}return Rb}Tse();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var aB="popstate";function Pse(e={}){function t(n,a){let{pathname:l,search:h,hash:i}=n.location;return Uj("",{pathname:l,search:h,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:b1(a)}return Cse(t,r,null,e)}function bo(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Nh(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Ese(){return Math.random().toString(36).substring(2,10)}function oB(e,t){return{usr:e.state,key:e.key,idx:t}}function Uj(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?s0(t):t,state:r,key:t&&t.key||n||Ese()}}function b1({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function s0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function Cse(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:l=!1}=n,h=a.history,i="POP",_=null,w=A();w==null&&(w=0,h.replaceState({...h.state,idx:w},""));function A(){return(h.state||{idx:null}).idx}function C(){i="POP";let G=A(),H=G==null?null:G-w;w=G,_&&_({action:i,location:U.location,delta:H})}function R(G,H){i="PUSH";let J=Uj(U.location,G,H);w=A()+1;let Q=oB(J,w),le=U.createHref(J);try{h.pushState(Q,"",le)}catch(ne){if(ne instanceof DOMException&&ne.name==="DataCloneError")throw ne;a.location.assign(le)}l&&_&&_({action:i,location:U.location,delta:1})}function z(G,H){i="REPLACE";let J=Uj(U.location,G,H);w=A();let Q=oB(J,w),le=U.createHref(J);h.replaceState(Q,"",le),l&&_&&_({action:i,location:U.location,delta:0})}function V(G){let H=a.location.origin!=="null"?a.location.origin:a.location.href,J=typeof G=="string"?G:b1(G);return J=J.replace(/ $/,"%20"),bo(H,`No window.location.(origin|href) available to create URL for href: ${J}`),new URL(J,H)}let U={get action(){return i},get location(){return e(a,h)},listen(G){if(_)throw new Error("A history only accepts one active listener");return a.addEventListener(aB,C),_=G,()=>{a.removeEventListener(aB,C),_=null}},createHref(G){return t(a,G)},createURL:V,encodeLocation(G){let H=V(G);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:R,replace:z,go(G){return h.go(G)}};return U}function yK(e,t,r="/"){return Mse(e,t,r,!1)}function Mse(e,t,r,n){let a=typeof t=="string"?s0(t):t,l=sm(a.pathname||"/",r);if(l==null)return null;let h=vK(e);Ose(h);let i=null;for(let _=0;i==null&&_<h.length;++_){let w=Vse(l);i=Fse(h[_],w,n)}return i}function vK(e,t=[],r=[],n=""){let a=(l,h,i)=>{let _={relativePath:i===void 0?l.path||"":i,caseSensitive:l.caseSensitive===!0,childrenIndex:h,route:l};_.relativePath.startsWith("/")&&(bo(_.relativePath.startsWith(n),`Absolute route path "${_.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(n.length));let w=rm([n,_.relativePath]),A=r.concat(_);l.children&&l.children.length>0&&(bo(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),vK(l.children,t,A,w)),!(l.path==null&&!l.index)&&t.push({path:w,score:Lse(w,l.index),routesMeta:A})};return e.forEach((l,h)=>{var i;if(l.path===""||!((i=l.path)!=null&&i.includes("?")))a(l,h);else for(let _ of _K(l.path))a(l,h,_)}),t}function _K(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let h=_K(n.join("/")),i=[];return i.push(...h.map(_=>_===""?l:[l,_].join("/"))),a&&i.push(...h),i.map(_=>e.startsWith("/")&&_===""?"/":_)}function Ose(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:zse(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var Rse=/^:[\w-]+$/,kse=3,jse=2,Nse=1,Ise=10,Dse=-2,sB=e=>e==="*";function Lse(e,t){let r=e.split("/"),n=r.length;return r.some(sB)&&(n+=Dse),t&&(n+=jse),r.filter(a=>!sB(a)).reduce((a,l)=>a+(Rse.test(l)?kse:l===""?Nse:Ise),n)}function zse(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Fse(e,t,r=!1){let{routesMeta:n}=e,a={},l="/",h=[];for(let i=0;i<n.length;++i){let _=n[i],w=i===n.length-1,A=l==="/"?t:t.slice(l.length)||"/",C=wA({path:_.relativePath,caseSensitive:_.caseSensitive,end:w},A),R=_.route;if(!C&&w&&r&&!n[n.length-1].route.index&&(C=wA({path:_.relativePath,caseSensitive:_.caseSensitive,end:!1},A)),!C)return null;Object.assign(a,C.params),h.push({params:a,pathname:rm([l,C.pathname]),pathnameBase:Gse(rm([l,C.pathnameBase])),route:R}),C.pathnameBase!=="/"&&(l=rm([l,C.pathnameBase]))}return h}function wA(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Bse(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let l=a[0],h=l.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((w,{paramName:A,isOptional:C},R)=>{if(A==="*"){let V=i[R]||"";h=l.slice(0,l.length-V.length).replace(/(.)\/+$/,"$1")}const z=i[R];return C&&!z?w[A]=void 0:w[A]=(z||"").replace(/%2F/g,"/"),w},{}),pathname:l,pathnameBase:h,pattern:e}}function Bse(e,t=!1,r=!0){Nh(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(h,i,_)=>(n.push({paramName:i,isOptional:_!=null}),_?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Vse(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Nh(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function sm(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Use(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?s0(e):e;return{pathname:r?r.startsWith("/")?r:$se(r,t):t,search:Kse(n),hash:Wse(a)}}function $se(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function FC(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qse(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function PD(e){let t=qse(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function ED(e,t,r,n=!1){let a;typeof e=="string"?a=s0(e):(a={...e},bo(!a.pathname||!a.pathname.includes("?"),FC("?","pathname","search",a)),bo(!a.pathname||!a.pathname.includes("#"),FC("#","pathname","hash",a)),bo(!a.search||!a.search.includes("#"),FC("#","search","hash",a)));let l=e===""||a.pathname==="",h=l?"/":a.pathname,i;if(h==null)i=r;else{let C=t.length-1;if(!n&&h.startsWith("..")){let R=h.split("/");for(;R[0]==="..";)R.shift(),C-=1;a.pathname=R.join("/")}i=C>=0?t[C]:"/"}let _=Use(a,i),w=h&&h!=="/"&&h.endsWith("/"),A=(l||h===".")&&r.endsWith("/");return!_.pathname.endsWith("/")&&(w||A)&&(_.pathname+="/"),_}var rm=e=>e.join("/").replace(/\/\/+/g,"/"),Gse=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Kse=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Wse=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Hse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var xK=["POST","PUT","PATCH","DELETE"];new Set(xK);var Zse=["GET",...xK];new Set(Zse);var l0=K.createContext(null);l0.displayName="DataRouter";var oP=K.createContext(null);oP.displayName="DataRouterState";var bK=K.createContext({isTransitioning:!1});bK.displayName="ViewTransition";var Yse=K.createContext(new Map);Yse.displayName="Fetchers";var Xse=K.createContext(null);Xse.displayName="Await";var Vh=K.createContext(null);Vh.displayName="Navigation";var Bw=K.createContext(null);Bw.displayName="Location";var Cd=K.createContext({outlet:null,matches:[],isDataRoute:!1});Cd.displayName="Route";var CD=K.createContext(null);CD.displayName="RouteError";function Jse(e,{relative:t}={}){bo(c0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=K.useContext(Vh),{hash:a,pathname:l,search:h}=Vw(e,{relative:t}),i=l;return r!=="/"&&(i=l==="/"?r:rm([r,l])),n.createHref({pathname:i,search:h,hash:a})}function c0(){return K.useContext(Bw)!=null}function gs(){return bo(c0(),"useLocation() may be used only in the context of a <Router> component."),K.useContext(Bw).location}var wK="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function SK(e){K.useContext(Vh).static||K.useLayoutEffect(e)}function Ua(){let{isDataRoute:e}=K.useContext(Cd);return e?fle():Qse()}function Qse(){bo(c0(),"useNavigate() may be used only in the context of a <Router> component.");let e=K.useContext(l0),{basename:t,navigator:r}=K.useContext(Vh),{matches:n}=K.useContext(Cd),{pathname:a}=gs(),l=JSON.stringify(PD(n)),h=K.useRef(!1);return SK(()=>{h.current=!0}),K.useCallback((_,w={})=>{if(Nh(h.current,wK),!h.current)return;if(typeof _=="number"){r.go(_);return}let A=ED(_,JSON.parse(l),a,w.relative==="path");e==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:rm([t,A.pathname])),(w.replace?r.replace:r.push)(A,w.state,w)},[t,r,l,a,e])}var ele=K.createContext(null);function tle(e){let t=K.useContext(Cd).outlet;return t&&K.createElement(ele.Provider,{value:e},t)}function Jf(){let{matches:e}=K.useContext(Cd),t=e[e.length-1];return t?t.params:{}}function Vw(e,{relative:t}={}){let{matches:r}=K.useContext(Cd),{pathname:n}=gs(),a=JSON.stringify(PD(r));return K.useMemo(()=>ED(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function rle(e,t){return AK(e,t)}function AK(e,t,r,n){var J;bo(c0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:l}=K.useContext(Vh),{matches:h}=K.useContext(Cd),i=h[h.length-1],_=i?i.params:{},w=i?i.pathname:"/",A=i?i.pathnameBase:"/",C=i&&i.route;{let Q=C&&C.path||"";TK(w,!C||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let R=gs(),z;if(t){let Q=typeof t=="string"?s0(t):t;bo(A==="/"||((J=Q.pathname)==null?void 0:J.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),z=Q}else z=R;let V=z.pathname||"/",U=V;if(A!=="/"){let Q=A.replace(/^\//,"").split("/");U="/"+V.replace(/^\//,"").split("/").slice(Q.length).join("/")}let G=!l&&r&&r.matches&&r.matches.length>0?r.matches:yK(e,{pathname:U});Nh(C||G!=null,`No routes matched location "${z.pathname}${z.search}${z.hash}" `),Nh(G==null||G[G.length-1].route.element!==void 0||G[G.length-1].route.Component!==void 0||G[G.length-1].route.lazy!==void 0,`Matched leaf route at location "${z.pathname}${z.search}${z.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=sle(G&&G.map(Q=>Object.assign({},Q,{params:Object.assign({},_,Q.params),pathname:rm([A,a.encodeLocation?a.encodeLocation(Q.pathname).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?A:rm([A,a.encodeLocation?a.encodeLocation(Q.pathnameBase).pathname:Q.pathnameBase])})),h,r,n);return t&&H?K.createElement(Bw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...z},navigationType:"POP"}},H):H}function nle(){let e=hle(),t=Hse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},h=null;return console.error("Error handled by React Router default ErrorBoundary:",e),h=K.createElement(K.Fragment,null,K.createElement("p",null," Hey developer "),K.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",K.createElement("code",{style:l},"ErrorBoundary")," or"," ",K.createElement("code",{style:l},"errorElement")," prop on your route.")),K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},t),r?K.createElement("pre",{style:a},r):null,h)}var ile=K.createElement(nle,null),ale=class extends K.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?K.createElement(Cd.Provider,{value:this.props.routeContext},K.createElement(CD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ole({routeContext:e,match:t,children:r}){let n=K.useContext(l0);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),K.createElement(Cd.Provider,{value:e},r)}function sle(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,l=r==null?void 0:r.errors;if(l!=null){let _=a.findIndex(w=>w.route.id&&(l==null?void 0:l[w.route.id])!==void 0);bo(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,_+1))}let h=!1,i=-1;if(r)for(let _=0;_<a.length;_++){let w=a[_];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(i=_),w.route.id){let{loaderData:A,errors:C}=r,R=w.route.loader&&!A.hasOwnProperty(w.route.id)&&(!C||C[w.route.id]===void 0);if(w.route.lazy||R){h=!0,i>=0?a=a.slice(0,i+1):a=[a[0]];break}}}return a.reduceRight((_,w,A)=>{let C,R=!1,z=null,V=null;r&&(C=l&&w.route.id?l[w.route.id]:void 0,z=w.route.errorElement||ile,h&&(i<0&&A===0?(TK("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,V=null):i===A&&(R=!0,V=w.route.hydrateFallbackElement||null)));let U=t.concat(a.slice(0,A+1)),G=()=>{let H;return C?H=z:R?H=V:w.route.Component?H=K.createElement(w.route.Component,null):w.route.element?H=w.route.element:H=_,K.createElement(ole,{match:w,routeContext:{outlet:_,matches:U,isDataRoute:r!=null},children:H})};return r&&(w.route.ErrorBoundary||w.route.errorElement||A===0)?K.createElement(ale,{location:r.location,revalidation:r.revalidation,component:z,error:C,children:G(),routeContext:{outlet:null,matches:U,isDataRoute:!0}}):G()},null)}function MD(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function lle(e){let t=K.useContext(l0);return bo(t,MD(e)),t}function cle(e){let t=K.useContext(oP);return bo(t,MD(e)),t}function ule(e){let t=K.useContext(Cd);return bo(t,MD(e)),t}function OD(e){let t=ule(e),r=t.matches[t.matches.length-1];return bo(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function dle(){return OD("useRouteId")}function hle(){var n;let e=K.useContext(CD),t=cle("useRouteError"),r=OD("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function fle(){let{router:e}=lle("useNavigate"),t=OD("useNavigate"),r=K.useRef(!1);return SK(()=>{r.current=!0}),K.useCallback(async(a,l={})=>{Nh(r.current,wK),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...l}))},[e,t])}var lB={};function TK(e,t,r){!t&&!lB[e]&&(lB[e]=!0,Nh(!1,r))}K.memo(ple);function ple({routes:e,future:t,state:r}){return AK(e,void 0,r,t)}function RD({to:e,replace:t,state:r,relative:n}){bo(c0(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=K.useContext(Vh);Nh(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=K.useContext(Cd),{pathname:h}=gs(),i=Ua(),_=ED(e,PD(l),h,n==="path"),w=JSON.stringify(_);return K.useEffect(()=>{i(JSON.parse(w),{replace:t,state:r,relative:n})},[i,w,n,t,r]),null}function kD(e){return tle(e.context)}function Fa(e){bo(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function mle({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:l=!1}){bo(!c0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=e.replace(/^\/*/,"/"),i=K.useMemo(()=>({basename:h,navigator:a,static:l,future:{}}),[h,a,l]);typeof r=="string"&&(r=s0(r));let{pathname:_="/",search:w="",hash:A="",state:C=null,key:R="default"}=r,z=K.useMemo(()=>{let V=sm(_,h);return V==null?null:{location:{pathname:V,search:w,hash:A,state:C,key:R},navigationType:n}},[h,_,w,A,C,R,n]);return Nh(z!=null,`<Router basename="${h}"> is not able to match the URL "${_}${w}${A}" because it does not start with the basename, so the <Router> won't render anything.`),z==null?null:K.createElement(Vh.Provider,{value:i},K.createElement(Bw.Provider,{children:t,value:z}))}function gle({children:e,location:t}){return rle($j(e),t)}function $j(e,t=[]){let r=[];return K.Children.forEach(e,(n,a)=>{if(!K.isValidElement(n))return;let l=[...t,a];if(n.type===K.Fragment){r.push.apply(r,$j(n.props.children,l));return}bo(n.type===Fa,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),bo(!n.props.index||!n.props.children,"An index route cannot have child routes.");let h={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(h.children=$j(n.props.children,l)),r.push(h)}),r}var iA="get",aA="application/x-www-form-urlencoded";function sP(e){return e!=null&&typeof e.tagName=="string"}function yle(e){return sP(e)&&e.tagName.toLowerCase()==="button"}function vle(e){return sP(e)&&e.tagName.toLowerCase()==="form"}function _le(e){return sP(e)&&e.tagName.toLowerCase()==="input"}function xle(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function ble(e,t){return e.button===0&&(!t||t==="_self")&&!xle(e)}var T2=null;function wle(){if(T2===null)try{new FormData(document.createElement("form"),0),T2=!1}catch{T2=!0}return T2}var Sle=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function BC(e){return e!=null&&!Sle.has(e)?(Nh(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${aA}"`),null):e}function Ale(e,t){let r,n,a,l,h;if(vle(e)){let i=e.getAttribute("action");n=i?sm(i,t):null,r=e.getAttribute("method")||iA,a=BC(e.getAttribute("enctype"))||aA,l=new FormData(e)}else if(yle(e)||_le(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let _=e.getAttribute("formaction")||i.getAttribute("action");if(n=_?sm(_,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||iA,a=BC(e.getAttribute("formenctype"))||BC(i.getAttribute("enctype"))||aA,l=new FormData(i,e),!wle()){let{name:w,type:A,value:C}=e;if(A==="image"){let R=w?`${w}.`:"";l.append(`${R}x`,"0"),l.append(`${R}y`,"0")}else w&&l.append(w,C)}}else{if(sP(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=iA,n=null,a=aA,h=e}return l&&a==="text/plain"&&(h=l,l=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:l,body:h}}function jD(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function Tle(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Ple(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Ele(e,t,r){let n=await Promise.all(e.map(async a=>{let l=t.routes[a.route.id];if(l){let h=await Tle(l,r);return h.links?h.links():[]}return[]}));return Rle(n.flat(1).filter(Ple).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function cB(e,t,r,n,a,l){let h=(_,w)=>r[w]?_.route.id!==r[w].route.id:!0,i=(_,w)=>{var A;return r[w].pathname!==_.pathname||((A=r[w].route.path)==null?void 0:A.endsWith("*"))&&r[w].params["*"]!==_.params["*"]};return l==="assets"?t.filter((_,w)=>h(_,w)||i(_,w)):l==="data"?t.filter((_,w)=>{var C;let A=n.routes[_.route.id];if(!A||!A.hasLoader)return!1;if(h(_,w)||i(_,w))return!0;if(_.route.shouldRevalidate){let R=_.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((C=r[0])==null?void 0:C.params)||{},nextUrl:new URL(e,window.origin),nextParams:_.params,defaultShouldRevalidate:!0});if(typeof R=="boolean")return R}return!0}):[]}function Cle(e,t,{includeHydrateFallback:r}={}){return Mle(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function Mle(e){return[...new Set(e)]}function Ole(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function Rle(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let l=JSON.stringify(Ole(a));return r.has(l)||(r.add(l),n.push({key:l,link:a})),n},[])}function kle(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&sm(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function PK(){let e=K.useContext(l0);return jD(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function jle(){let e=K.useContext(oP);return jD(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var ND=K.createContext(void 0);ND.displayName="FrameworkContext";function EK(){let e=K.useContext(ND);return jD(e,"You must render this element inside a <HydratedRouter> element"),e}function Nle(e,t){let r=K.useContext(ND),[n,a]=K.useState(!1),[l,h]=K.useState(!1),{onFocus:i,onBlur:_,onMouseEnter:w,onMouseLeave:A,onTouchStart:C}=t,R=K.useRef(null);K.useEffect(()=>{if(e==="render"&&h(!0),e==="viewport"){let U=H=>{H.forEach(J=>{h(J.isIntersecting)})},G=new IntersectionObserver(U,{threshold:.5});return R.current&&G.observe(R.current),()=>{G.disconnect()}}},[e]),K.useEffect(()=>{if(n){let U=setTimeout(()=>{h(!0)},100);return()=>{clearTimeout(U)}}},[n]);let z=()=>{a(!0)},V=()=>{a(!1),h(!1)};return r?e!=="intent"?[l,R,{}]:[l,R,{onFocus:kb(i,z),onBlur:kb(_,V),onMouseEnter:kb(w,z),onMouseLeave:kb(A,V),onTouchStart:kb(C,z)}]:[!1,R,{}]}function kb(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Ile({page:e,...t}){let{router:r}=PK(),n=K.useMemo(()=>yK(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?K.createElement(Lle,{page:e,matches:n,...t}):null}function Dle(e){let{manifest:t,routeModules:r}=EK(),[n,a]=K.useState([]);return K.useEffect(()=>{let l=!1;return Ele(e,t,r).then(h=>{l||a(h)}),()=>{l=!0}},[e,t,r]),n}function Lle({page:e,matches:t,...r}){let n=gs(),{manifest:a,routeModules:l}=EK(),{basename:h}=PK(),{loaderData:i,matches:_}=jle(),w=K.useMemo(()=>cB(e,t,_,a,n,"data"),[e,t,_,a,n]),A=K.useMemo(()=>cB(e,t,_,a,n,"assets"),[e,t,_,a,n]),C=K.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let V=new Set,U=!1;if(t.forEach(H=>{var Q;let J=a.routes[H.route.id];!J||!J.hasLoader||(!w.some(le=>le.route.id===H.route.id)&&H.route.id in i&&((Q=l[H.route.id])!=null&&Q.shouldRevalidate)||J.hasClientLoader?U=!0:V.add(H.route.id))}),V.size===0)return[];let G=kle(e,h);return U&&V.size>0&&G.searchParams.set("_routes",t.filter(H=>V.has(H.route.id)).map(H=>H.route.id).join(",")),[G.pathname+G.search]},[h,i,n,a,w,t,e,l]),R=K.useMemo(()=>Cle(A,a),[A,a]),z=Dle(A);return K.createElement(K.Fragment,null,C.map(V=>K.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...r})),R.map(V=>K.createElement("link",{key:V,rel:"modulepreload",href:V,...r})),z.map(({key:V,link:U})=>K.createElement("link",{key:V,...U})))}function zle(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var CK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{CK&&(window.__reactRouterVersion="7.3.0")}catch{}function Fle({basename:e,children:t,window:r}){let n=K.useRef();n.current==null&&(n.current=Pse({window:r,v5Compat:!0}));let a=n.current,[l,h]=K.useState({action:a.action,location:a.location}),i=K.useCallback(_=>{K.startTransition(()=>h(_))},[h]);return K.useLayoutEffect(()=>a.listen(i),[a,i]),K.createElement(mle,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:a})}var MK=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rs=K.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:l,replace:h,state:i,target:_,to:w,preventScrollReset:A,viewTransition:C,...R},z){let{basename:V}=K.useContext(Vh),U=typeof w=="string"&&MK.test(w),G,H=!1;if(typeof w=="string"&&U&&(G=w,CK))try{let Ae=new URL(window.location.href),Oe=w.startsWith("//")?new URL(Ae.protocol+w):new URL(w),Se=sm(Oe.pathname,V);Oe.origin===Ae.origin&&Se!=null?w=Se+Oe.search+Oe.hash:H=!0}catch{Nh(!1,`<Link to="${w}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let J=Jse(w,{relative:a}),[Q,le,ne]=Nle(n,R),de=$le(w,{replace:h,state:i,target:_,preventScrollReset:A,relative:a,viewTransition:C});function ue(Ae){t&&t(Ae),Ae.defaultPrevented||de(Ae)}let ve=K.createElement("a",{...R,...ne,href:G||J,onClick:H||l?t:ue,ref:zle(z,le),target:_,"data-discover":!U&&r==="render"?"true":void 0});return Q&&!U?K.createElement(K.Fragment,null,ve,K.createElement(Ile,{page:J})):ve});Rs.displayName="Link";var Ble=K.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:l,to:h,viewTransition:i,children:_,...w},A){let C=Vw(h,{relative:w.relative}),R=gs(),z=K.useContext(oP),{navigator:V,basename:U}=K.useContext(Vh),G=z!=null&&Hle(C)&&i===!0,H=V.encodeLocation?V.encodeLocation(C).pathname:C.pathname,J=R.pathname,Q=z&&z.navigation&&z.navigation.location?z.navigation.location.pathname:null;r||(J=J.toLowerCase(),Q=Q?Q.toLowerCase():null,H=H.toLowerCase()),Q&&U&&(Q=sm(Q,U)||Q);const le=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let ne=J===H||!a&&J.startsWith(H)&&J.charAt(le)==="/",de=Q!=null&&(Q===H||!a&&Q.startsWith(H)&&Q.charAt(H.length)==="/"),ue={isActive:ne,isPending:de,isTransitioning:G},ve=ne?t:void 0,Ae;typeof n=="function"?Ae=n(ue):Ae=[n,ne?"active":null,de?"pending":null,G?"transitioning":null].filter(Boolean).join(" ");let Oe=typeof l=="function"?l(ue):l;return K.createElement(Rs,{...w,"aria-current":ve,className:Ae,ref:A,style:Oe,to:h,viewTransition:i},typeof _=="function"?_(ue):_)});Ble.displayName="NavLink";var Vle=K.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:l,method:h=iA,action:i,onSubmit:_,relative:w,preventScrollReset:A,viewTransition:C,...R},z)=>{let V=Kle(),U=Wle(i,{relative:w}),G=h.toLowerCase()==="get"?"get":"post",H=typeof i=="string"&&MK.test(i),J=Q=>{if(_&&_(Q),Q.defaultPrevented)return;Q.preventDefault();let le=Q.nativeEvent.submitter,ne=(le==null?void 0:le.getAttribute("formmethod"))||h;V(le||Q.currentTarget,{fetcherKey:t,method:ne,navigate:r,replace:a,state:l,relative:w,preventScrollReset:A,viewTransition:C})};return K.createElement("form",{ref:z,method:G,action:U,onSubmit:n?_:J,...R,"data-discover":!H&&e==="render"?"true":void 0})});Vle.displayName="Form";function Ule(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function OK(e){let t=K.useContext(l0);return bo(t,Ule(e)),t}function $le(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:l,viewTransition:h}={}){let i=Ua(),_=gs(),w=Vw(e,{relative:l});return K.useCallback(A=>{if(ble(A,t)){A.preventDefault();let C=r!==void 0?r:b1(_)===b1(w);i(e,{replace:C,state:n,preventScrollReset:a,relative:l,viewTransition:h})}},[_,i,w,r,n,t,e,a,l,h])}var qle=0,Gle=()=>`__${String(++qle)}__`;function Kle(){let{router:e}=OK("useSubmit"),{basename:t}=K.useContext(Vh),r=dle();return K.useCallback(async(n,a={})=>{let{action:l,method:h,encType:i,formData:_,body:w}=Ale(n,t);if(a.navigate===!1){let A=a.fetcherKey||Gle();await e.fetch(A,r,a.action||l,{preventScrollReset:a.preventScrollReset,formData:_,body:w,formMethod:a.method||h,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:_,body:w,formMethod:a.method||h,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function Wle(e,{relative:t}={}){let{basename:r}=K.useContext(Vh),n=K.useContext(Cd);bo(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),l={...Vw(e||".",{relative:t})},h=gs();if(e==null){l.search=h.search;let i=new URLSearchParams(l.search),_=i.getAll("index");if(_.some(A=>A==="")){i.delete("index"),_.filter(C=>C).forEach(C=>i.append("index",C));let A=i.toString();l.search=A?`?${A}`:""}}return(!e||e===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:rm([r,l.pathname])),b1(l)}function Hle(e,t={}){let r=K.useContext(bK);bo(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=OK("useViewTransitionState"),a=Vw(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=sm(r.currentLocation.pathname,n)||r.currentLocation.pathname,h=sm(r.nextLocation.pathname,n)||r.nextLocation.pathname;return wA(a.pathname,h)!=null||wA(a.pathname,l)!=null}new TextEncoder;const RK="/assets/lto-C2OlZVWi.svg";function uB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function lP(...e){return t=>{let r=!1;const n=e.map(a=>{const l=uB(a,t);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let a=0;a<n.length;a++){const l=n[a];typeof l=="function"?l():uB(e[a],null)}}}}function Xi(...e){return K.useCallback(lP(...e),e)}var Vl=K.forwardRef((e,t)=>{const{children:r,...n}=e,a=K.Children.toArray(r),l=a.find(Zle);if(l){const h=l.props.children,i=a.map(_=>_===l?K.Children.count(h)>1?K.Children.only(null):K.isValidElement(h)?h.props.children:null:_);return f.jsx(qj,{...n,ref:t,children:K.isValidElement(h)?K.cloneElement(h,void 0,i):null})}return f.jsx(qj,{...n,ref:t,children:r})});Vl.displayName="Slot";var qj=K.forwardRef((e,t)=>{const{children:r,...n}=e;if(K.isValidElement(r)){const a=Xle(r),l=Yle(n,r.props);return r.type!==K.Fragment&&(l.ref=t?lP(t,a):a),K.cloneElement(r,l)}return K.Children.count(r)>1?K.Children.only(null):null});qj.displayName="SlotClone";var ID=({children:e})=>f.jsx(f.Fragment,{children:e});function Zle(e){return K.isValidElement(e)&&e.type===ID}function Yle(e,t){const r={...t};for(const n in t){const a=e[n],l=t[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...i)=>{l(...i),a(...i)}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...e,...r}}function Xle(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function kK(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=kK(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Xn(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=kK(e))&&(n&&(n+=" "),n+=t);return n}const dB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,hB=Xn,u0=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return hB(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:l}=t,h=Object.keys(a).map(w=>{const A=r==null?void 0:r[w],C=l==null?void 0:l[w];if(A===null)return null;const R=dB(A)||dB(C);return a[w][R]}),i=r&&Object.entries(r).reduce((w,A)=>{let[C,R]=A;return R===void 0||(w[C]=R),w},{}),_=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((w,A)=>{let{class:C,className:R,...z}=A;return Object.entries(z).every(V=>{let[U,G]=V;return Array.isArray(G)?G.includes({...l,...i}[U]):{...l,...i}[U]===G})?[...w,C,R]:w},[]);return hB(e,h,_,r==null?void 0:r.class,r==null?void 0:r.className)},DD="-",Jle=e=>{const t=ece(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:h=>{const i=h.split(DD);return i[0]===""&&i.length!==1&&i.shift(),jK(i,t)||Qle(h)},getConflictingClassGroupIds:(h,i)=>{const _=r[h]||[];return i&&n[h]?[..._,...n[h]]:_}}},jK=(e,t)=>{var h;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?jK(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(DD);return(h=t.validators.find(({validator:i})=>i(l)))==null?void 0:h.classGroupId},fB=/^\[(.+)\]$/,Qle=e=>{if(fB.test(e)){const t=fB.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},ece=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)Gj(r[a],n,a,t);return n},Gj=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:pB(t,a);l.classGroupId=r;return}if(typeof a=="function"){if(tce(a)){Gj(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,h])=>{Gj(h,pB(t,l),r,n)})})},pB=(e,t)=>{let r=e;return t.split(DD).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},tce=e=>e.isThemeGetter,rce=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(l,h)=>{r.set(l,h),t++,t>e&&(t=0,n=r,r=new Map)};return{get(l){let h=r.get(l);if(h!==void 0)return h;if((h=n.get(l))!==void 0)return a(l,h),h},set(l,h){r.has(l)?r.set(l,h):a(l,h)}}},Kj="!",Wj=":",nce=Wj.length,ice=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const l=[];let h=0,i=0,_=0,w;for(let V=0;V<a.length;V++){let U=a[V];if(h===0&&i===0){if(U===Wj){l.push(a.slice(_,V)),_=V+nce;continue}if(U==="/"){w=V;continue}}U==="["?h++:U==="]"?h--:U==="("?i++:U===")"&&i--}const A=l.length===0?a:a.substring(_),C=ace(A),R=C!==A,z=w&&w>_?w-_:void 0;return{modifiers:l,hasImportantModifier:R,baseClassName:C,maybePostfixModifierPosition:z}};if(t){const a=t+Wj,l=n;n=h=>h.startsWith(a)?l(h.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:h,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=l=>r({className:l,parseClassName:a})}return n},ace=e=>e.endsWith(Kj)?e.substring(0,e.length-1):e.startsWith(Kj)?e.substring(1):e,oce=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let l=[];return n.forEach(h=>{h[0]==="["||t[h]?(a.push(...l.sort(),h),l=[]):l.push(h)}),a.push(...l.sort()),a}},sce=e=>({cache:rce(e.cacheSize),parseClassName:ice(e),sortModifiers:oce(e),...Jle(e)}),lce=/\s+/,cce=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:l}=t,h=[],i=e.trim().split(lce);let _="";for(let w=i.length-1;w>=0;w-=1){const A=i[w],{isExternal:C,modifiers:R,hasImportantModifier:z,baseClassName:V,maybePostfixModifierPosition:U}=r(A);if(C){_=A+(_.length>0?" "+_:_);continue}let G=!!U,H=n(G?V.substring(0,U):V);if(!H){if(!G){_=A+(_.length>0?" "+_:_);continue}if(H=n(V),!H){_=A+(_.length>0?" "+_:_);continue}G=!1}const J=l(R).join(":"),Q=z?J+Kj:J,le=Q+H;if(h.includes(le))continue;h.push(le);const ne=a(H,G);for(let de=0;de<ne.length;++de){const ue=ne[de];h.push(Q+ue)}_=A+(_.length>0?" "+_:_)}return _};function uce(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=NK(t))&&(n&&(n+=" "),n+=r);return n}const NK=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=NK(e[n]))&&(r&&(r+=" "),r+=t);return r};function dce(e,...t){let r,n,a,l=h;function h(_){const w=t.reduce((A,C)=>C(A),e());return r=sce(w),n=r.cache.get,a=r.cache.set,l=i,i(_)}function i(_){const w=n(_);if(w)return w;const A=cce(_,r);return a(_,A),A}return function(){return l(uce.apply(null,arguments))}}const Ys=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},IK=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,DK=/^\((?:(\w[\w-]*):)?(.+)\)$/i,hce=/^\d+\/\d+$/,fce=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pce=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mce=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,gce=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,yce=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,V_=e=>hce.test(e),Fi=e=>!!e&&!Number.isNaN(Number(e)),Yy=e=>!!e&&Number.isInteger(Number(e)),mB=e=>e.endsWith("%")&&Fi(e.slice(0,-1)),vg=e=>fce.test(e),vce=()=>!0,_ce=e=>pce.test(e)&&!mce.test(e),LD=()=>!1,xce=e=>gce.test(e),bce=e=>yce.test(e),wce=e=>!pn(e)&&!mn(e),Sce=e=>d0(e,FK,LD),pn=e=>IK.test(e),Xy=e=>d0(e,BK,_ce),VC=e=>d0(e,Nce,Fi),Ace=e=>d0(e,LK,LD),Tce=e=>d0(e,zK,bce),Pce=e=>d0(e,LD,xce),mn=e=>DK.test(e),P2=e=>h0(e,BK),Ece=e=>h0(e,Ice),Cce=e=>h0(e,LK),Mce=e=>h0(e,FK),Oce=e=>h0(e,zK),Rce=e=>h0(e,Dce,!0),d0=(e,t,r)=>{const n=IK.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},h0=(e,t,r=!1)=>{const n=DK.exec(e);return n?n[1]?t(n[1]):r:!1},LK=e=>e==="position",kce=new Set(["image","url"]),zK=e=>kce.has(e),jce=new Set(["length","size","percentage"]),FK=e=>jce.has(e),BK=e=>e==="length",Nce=e=>e==="number",Ice=e=>e==="family-name",Dce=e=>e==="shadow",Lce=()=>{const e=Ys("color"),t=Ys("font"),r=Ys("text"),n=Ys("font-weight"),a=Ys("tracking"),l=Ys("leading"),h=Ys("breakpoint"),i=Ys("container"),_=Ys("spacing"),w=Ys("radius"),A=Ys("shadow"),C=Ys("inset-shadow"),R=Ys("drop-shadow"),z=Ys("blur"),V=Ys("perspective"),U=Ys("aspect"),G=Ys("ease"),H=Ys("animate"),J=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],le=()=>["auto","hidden","clip","visible","scroll"],ne=()=>["auto","contain","none"],de=()=>[mn,pn,_],ue=()=>[V_,"full","auto",...de()],ve=()=>[Yy,"none","subgrid",mn,pn],Ae=()=>["auto",{span:["full",Yy,mn,pn]},mn,pn],Oe=()=>[Yy,"auto",mn,pn],Se=()=>["auto","min","max","fr",mn,pn],ke=()=>["start","end","center","between","around","evenly","stretch","baseline"],ze=()=>["start","end","center","stretch"],et=()=>["auto",...de()],je=()=>[V_,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...de()],Ne=()=>[e,mn,pn],Ye=()=>[mB,Xy],$e=()=>["","none","full",w,mn,pn],We=()=>["",Fi,P2,Xy],Et=()=>["solid","dashed","dotted","double"],Je=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ht=()=>["","none",z,mn,pn],tt=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",mn,pn],Qt=()=>["none",Fi,mn,pn],gr=()=>["none",Fi,mn,pn],sr=()=>[Fi,mn,pn],ur=()=>[V_,"full",...de()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[vg],breakpoint:[vg],color:[vce],container:[vg],"drop-shadow":[vg],ease:["in","out","in-out"],font:[wce],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[vg],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[vg],shadow:[vg],spacing:["px",Fi],text:[vg],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",V_,pn,mn,U]}],container:["container"],columns:[{columns:[Fi,pn,mn,i]}],"break-after":[{"break-after":J()}],"break-before":[{"break-before":J()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),pn,mn]}],overflow:[{overflow:le()}],"overflow-x":[{"overflow-x":le()}],"overflow-y":[{"overflow-y":le()}],overscroll:[{overscroll:ne()}],"overscroll-x":[{"overscroll-x":ne()}],"overscroll-y":[{"overscroll-y":ne()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ue()}],"inset-x":[{"inset-x":ue()}],"inset-y":[{"inset-y":ue()}],start:[{start:ue()}],end:[{end:ue()}],top:[{top:ue()}],right:[{right:ue()}],bottom:[{bottom:ue()}],left:[{left:ue()}],visibility:["visible","invisible","collapse"],z:[{z:[Yy,"auto",mn,pn]}],basis:[{basis:[V_,"full","auto",i,...de()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Fi,V_,"auto","initial","none",pn]}],grow:[{grow:["",Fi,mn,pn]}],shrink:[{shrink:["",Fi,mn,pn]}],order:[{order:[Yy,"first","last","none",mn,pn]}],"grid-cols":[{"grid-cols":ve()}],"col-start-end":[{col:Ae()}],"col-start":[{"col-start":Oe()}],"col-end":[{"col-end":Oe()}],"grid-rows":[{"grid-rows":ve()}],"row-start-end":[{row:Ae()}],"row-start":[{"row-start":Oe()}],"row-end":[{"row-end":Oe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Se()}],"auto-rows":[{"auto-rows":Se()}],gap:[{gap:de()}],"gap-x":[{"gap-x":de()}],"gap-y":[{"gap-y":de()}],"justify-content":[{justify:[...ke(),"normal"]}],"justify-items":[{"justify-items":[...ze(),"normal"]}],"justify-self":[{"justify-self":["auto",...ze()]}],"align-content":[{content:["normal",...ke()]}],"align-items":[{items:[...ze(),"baseline"]}],"align-self":[{self:["auto",...ze(),"baseline"]}],"place-content":[{"place-content":ke()}],"place-items":[{"place-items":[...ze(),"baseline"]}],"place-self":[{"place-self":["auto",...ze()]}],p:[{p:de()}],px:[{px:de()}],py:[{py:de()}],ps:[{ps:de()}],pe:[{pe:de()}],pt:[{pt:de()}],pr:[{pr:de()}],pb:[{pb:de()}],pl:[{pl:de()}],m:[{m:et()}],mx:[{mx:et()}],my:[{my:et()}],ms:[{ms:et()}],me:[{me:et()}],mt:[{mt:et()}],mr:[{mr:et()}],mb:[{mb:et()}],ml:[{ml:et()}],"space-x":[{"space-x":de()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":de()}],"space-y-reverse":["space-y-reverse"],size:[{size:je()}],w:[{w:[i,"screen",...je()]}],"min-w":[{"min-w":[i,"screen","none",...je()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[h]},...je()]}],h:[{h:["screen",...je()]}],"min-h":[{"min-h":["screen","none",...je()]}],"max-h":[{"max-h":["screen",...je()]}],"font-size":[{text:["base",r,P2,Xy]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,mn,VC]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",mB,pn]}],"font-family":[{font:[Ece,pn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,mn,pn]}],"line-clamp":[{"line-clamp":[Fi,"none",mn,VC]}],leading:[{leading:[l,...de()]}],"list-image":[{"list-image":["none",mn,pn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",mn,pn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Ne()}],"text-color":[{text:Ne()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Et(),"wavy"]}],"text-decoration-thickness":[{decoration:[Fi,"from-font","auto",mn,Xy]}],"text-decoration-color":[{decoration:Ne()}],"underline-offset":[{"underline-offset":[Fi,"auto",mn,pn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:de()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",mn,pn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",mn,pn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),Cce,Ace]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",Mce,Sce]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Yy,mn,pn],radial:["",mn,pn],conic:[Yy,mn,pn]},Oce,Tce]}],"bg-color":[{bg:Ne()}],"gradient-from-pos":[{from:Ye()}],"gradient-via-pos":[{via:Ye()}],"gradient-to-pos":[{to:Ye()}],"gradient-from":[{from:Ne()}],"gradient-via":[{via:Ne()}],"gradient-to":[{to:Ne()}],rounded:[{rounded:$e()}],"rounded-s":[{"rounded-s":$e()}],"rounded-e":[{"rounded-e":$e()}],"rounded-t":[{"rounded-t":$e()}],"rounded-r":[{"rounded-r":$e()}],"rounded-b":[{"rounded-b":$e()}],"rounded-l":[{"rounded-l":$e()}],"rounded-ss":[{"rounded-ss":$e()}],"rounded-se":[{"rounded-se":$e()}],"rounded-ee":[{"rounded-ee":$e()}],"rounded-es":[{"rounded-es":$e()}],"rounded-tl":[{"rounded-tl":$e()}],"rounded-tr":[{"rounded-tr":$e()}],"rounded-br":[{"rounded-br":$e()}],"rounded-bl":[{"rounded-bl":$e()}],"border-w":[{border:We()}],"border-w-x":[{"border-x":We()}],"border-w-y":[{"border-y":We()}],"border-w-s":[{"border-s":We()}],"border-w-e":[{"border-e":We()}],"border-w-t":[{"border-t":We()}],"border-w-r":[{"border-r":We()}],"border-w-b":[{"border-b":We()}],"border-w-l":[{"border-l":We()}],"divide-x":[{"divide-x":We()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":We()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Et(),"hidden","none"]}],"divide-style":[{divide:[...Et(),"hidden","none"]}],"border-color":[{border:Ne()}],"border-color-x":[{"border-x":Ne()}],"border-color-y":[{"border-y":Ne()}],"border-color-s":[{"border-s":Ne()}],"border-color-e":[{"border-e":Ne()}],"border-color-t":[{"border-t":Ne()}],"border-color-r":[{"border-r":Ne()}],"border-color-b":[{"border-b":Ne()}],"border-color-l":[{"border-l":Ne()}],"divide-color":[{divide:Ne()}],"outline-style":[{outline:[...Et(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Fi,mn,pn]}],"outline-w":[{outline:["",Fi,P2,Xy]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",A,Rce,Pce]}],"shadow-color":[{shadow:Ne()}],"inset-shadow":[{"inset-shadow":["none",mn,pn,C]}],"inset-shadow-color":[{"inset-shadow":Ne()}],"ring-w":[{ring:We()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Ne()}],"ring-offset-w":[{"ring-offset":[Fi,Xy]}],"ring-offset-color":[{"ring-offset":Ne()}],"inset-ring-w":[{"inset-ring":We()}],"inset-ring-color":[{"inset-ring":Ne()}],opacity:[{opacity:[Fi,mn,pn]}],"mix-blend":[{"mix-blend":[...Je(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Je()}],filter:[{filter:["","none",mn,pn]}],blur:[{blur:ht()}],brightness:[{brightness:[Fi,mn,pn]}],contrast:[{contrast:[Fi,mn,pn]}],"drop-shadow":[{"drop-shadow":["","none",R,mn,pn]}],grayscale:[{grayscale:["",Fi,mn,pn]}],"hue-rotate":[{"hue-rotate":[Fi,mn,pn]}],invert:[{invert:["",Fi,mn,pn]}],saturate:[{saturate:[Fi,mn,pn]}],sepia:[{sepia:["",Fi,mn,pn]}],"backdrop-filter":[{"backdrop-filter":["","none",mn,pn]}],"backdrop-blur":[{"backdrop-blur":ht()}],"backdrop-brightness":[{"backdrop-brightness":[Fi,mn,pn]}],"backdrop-contrast":[{"backdrop-contrast":[Fi,mn,pn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Fi,mn,pn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Fi,mn,pn]}],"backdrop-invert":[{"backdrop-invert":["",Fi,mn,pn]}],"backdrop-opacity":[{"backdrop-opacity":[Fi,mn,pn]}],"backdrop-saturate":[{"backdrop-saturate":[Fi,mn,pn]}],"backdrop-sepia":[{"backdrop-sepia":["",Fi,mn,pn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":de()}],"border-spacing-x":[{"border-spacing-x":de()}],"border-spacing-y":[{"border-spacing-y":de()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",mn,pn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Fi,"initial",mn,pn]}],ease:[{ease:["linear","initial",G,mn,pn]}],delay:[{delay:[Fi,mn,pn]}],animate:[{animate:["none",H,mn,pn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[V,mn,pn]}],"perspective-origin":[{"perspective-origin":tt()}],rotate:[{rotate:Qt()}],"rotate-x":[{"rotate-x":Qt()}],"rotate-y":[{"rotate-y":Qt()}],"rotate-z":[{"rotate-z":Qt()}],scale:[{scale:gr()}],"scale-x":[{"scale-x":gr()}],"scale-y":[{"scale-y":gr()}],"scale-z":[{"scale-z":gr()}],"scale-3d":["scale-3d"],skew:[{skew:sr()}],"skew-x":[{"skew-x":sr()}],"skew-y":[{"skew-y":sr()}],transform:[{transform:[mn,pn,"","none","gpu","cpu"]}],"transform-origin":[{origin:tt()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ur()}],"translate-x":[{"translate-x":ur()}],"translate-y":[{"translate-y":ur()}],"translate-z":[{"translate-z":ur()}],"translate-none":["translate-none"],accent:[{accent:Ne()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Ne()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",mn,pn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":de()}],"scroll-mx":[{"scroll-mx":de()}],"scroll-my":[{"scroll-my":de()}],"scroll-ms":[{"scroll-ms":de()}],"scroll-me":[{"scroll-me":de()}],"scroll-mt":[{"scroll-mt":de()}],"scroll-mr":[{"scroll-mr":de()}],"scroll-mb":[{"scroll-mb":de()}],"scroll-ml":[{"scroll-ml":de()}],"scroll-p":[{"scroll-p":de()}],"scroll-px":[{"scroll-px":de()}],"scroll-py":[{"scroll-py":de()}],"scroll-ps":[{"scroll-ps":de()}],"scroll-pe":[{"scroll-pe":de()}],"scroll-pt":[{"scroll-pt":de()}],"scroll-pr":[{"scroll-pr":de()}],"scroll-pb":[{"scroll-pb":de()}],"scroll-pl":[{"scroll-pl":de()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",mn,pn]}],fill:[{fill:["none",...Ne()]}],"stroke-w":[{stroke:[Fi,P2,Xy,VC]}],stroke:[{stroke:["none",...Ne()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}},zce=dce(Lce);function Gt(...e){return zce(Xn(e))}const w1=u0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"sm"}}),Ur=K.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},l)=>{const h=n?Vl:"button";return f.jsx(h,{className:Gt(w1({variant:t,size:r,className:e})),ref:l,...a})});Ur.displayName="Button";/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fce=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VK=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Bce={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vce=K.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:h,...i},_)=>K.createElement("svg",{ref:_,...Bce,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:VK("lucide",a),...i},[...h.map(([w,A])=>K.createElement(w,A)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=(e,t)=>{const r=K.forwardRef(({className:n,...a},l)=>K.createElement(Vce,{ref:l,iconNode:t,className:VK(`lucide-${Fce(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uce=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],gB=hn("Activity",Uce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ce=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],yB=hn("ArrowDown",$ce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qce=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Uw=hn("ArrowLeft",qce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gce=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],vB=hn("ArrowUp",Gce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kce=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Wce=hn("BadgeCheck",Kce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hce=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],_B=hn("BookOpen",Hce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zce=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Mh=hn("Calendar",Zce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yce=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],Av=hn("Car",Yce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xce=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],zD=hn("ChartColumn",Xce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jce=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],S1=hn("ChartPie",Jce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qce=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16c.5-2 1.5-7 4-7 2 0 2 3 4 3 2.5 0 4.5-5 5-7",key:"lw07rv"}]],eue=hn("ChartSpline",Qce);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tue=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],UK=hn("Check",tue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rue=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$K=hn("ChevronDown",rue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nue=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],qK=hn("ChevronLeft",nue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iue=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],vx=hn("ChevronRight",iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aue=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],oue=hn("ChevronUp",aue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sue=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],lue=hn("ChevronsLeft",sue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cue=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],uue=hn("ChevronsRight",cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const due=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],GK=hn("ChevronsUpDown",due);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],fue=hn("CircleAlert",hue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],mue=hn("CircleCheck",pue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],yue=hn("Circle",gue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],_ue=hn("Clock",vue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xue=[["rect",{width:"14",height:"8",x:"5",y:"2",rx:"2",key:"wc9tft"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6 18h2",key:"rwmk9e"}],["path",{d:"M12 18h6",key:"aqd8w3"}]],bue=hn("Computer",xue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wue=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],KK=hn("Download",wue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sue=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Aue=hn("Ellipsis",Sue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tue=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],WK=hn("EyeOff",Tue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pue=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Eue=hn("Eye",Pue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cue=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],A1=hn("FileText",Cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mue=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],HK=hn("Filter",Mue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oue=[["path",{d:"M7 2h10",key:"nczekb"}],["path",{d:"M5 6h14",key:"u2x4p"}],["rect",{width:"18",height:"12",x:"3",y:"10",rx:"2",key:"l0tzu3"}]],Rue=hn("GalleryVerticalEnd",Oue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],xB=hn("Image",kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jue=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],bB=hn("Layers",jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nue=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Sd=hn("LoaderCircle",Nue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iue=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Due=hn("LogOut",Iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lue=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],ZK=hn("Mail",Lue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zue=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],T1=hn("MapPin",zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fue=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],wB=hn("Moon",Fue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],Vue=hn("PanelLeft",Bue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uue=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],$ue=hn("Phone",Uue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const que=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Bv=hn("Plus",que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gue=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Kue=hn("RefreshCw",Gue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wue=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Hue=hn("RotateCcw",Wue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zue=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Yue=hn("Save",Zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xue=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],YK=hn("Search",Xue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jue=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Que=hn("Settings2",Jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ede=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],tde=hn("Shield",ede);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]],UC=hn("SquareActivity",rde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 8h7",key:"kbo1nt"}],["path",{d:"M8 12h6",key:"ikassy"}],["path",{d:"M11 16h5",key:"oq65wt"}]],$C=hn("SquareChartGantt",nde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ide=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Nc=hn("SquarePen",ide);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ade=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],ode=hn("SquareTerminal",ade);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sde=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],SB=hn("Sun",sde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lde=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],cde=hn("Table",lde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ude=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],XK=hn("Target",ude);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dde=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],hde=hn("Trash2",dde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fde=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],FD=hn("Trash",fde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pde=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],AB=hn("TrendingDown",pde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mde=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],TB=hn("TrendingUp",mde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gde=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ux=hn("TriangleAlert",gde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yde=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],SA=hn("UserPlus",yde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vde=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],AA=hn("User",vde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _de=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],JK=hn("Users",_de);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xde=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],P1=hn("X",xde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bde=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],wde=hn("Zap",bde);function an(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Sde(e,t){const r=K.createContext(t),n=l=>{const{children:h,...i}=l,_=K.useMemo(()=>i,Object.values(i));return f.jsx(r.Provider,{value:_,children:h})};n.displayName=e+"Provider";function a(l){const h=K.useContext(r);if(h)return h;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[n,a]}function Md(e,t=[]){let r=[];function n(l,h){const i=K.createContext(h),_=r.length;r=[...r,h];const w=C=>{var H;const{scope:R,children:z,...V}=C,U=((H=R==null?void 0:R[e])==null?void 0:H[_])||i,G=K.useMemo(()=>V,Object.values(V));return f.jsx(U.Provider,{value:G,children:z})};w.displayName=l+"Provider";function A(C,R){var U;const z=((U=R==null?void 0:R[e])==null?void 0:U[_])||i,V=K.useContext(z);if(V)return V;if(h!==void 0)return h;throw new Error(`\`${C}\` must be used within \`${l}\``)}return[w,A]}const a=()=>{const l=r.map(h=>K.createContext(h));return function(i){const _=(i==null?void 0:i[e])||l;return K.useMemo(()=>({[`__scope${e}`]:{...i,[e]:_}}),[i,_])}};return a.scopeName=e,[n,Ade(a,...t)]}function Ade(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const h=n.reduce((i,{useScope:_,scopeName:w})=>{const C=_(l)[`__scope${w}`];return{...i,...C}},{});return K.useMemo(()=>({[`__scope${t.scopeName}`]:h}),[h])}};return r.scopeName=t.scopeName,r}function Eu(e){const t=K.useRef(e);return K.useEffect(()=>{t.current=e}),K.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function kg({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=Tde({defaultProp:t,onChange:r}),l=e!==void 0,h=l?e:n,i=Eu(r),_=K.useCallback(w=>{if(l){const C=typeof w=="function"?w(e):w;C!==e&&i(C)}else a(w)},[l,e,a,i]);return[h,_]}function Tde({defaultProp:e,onChange:t}){const r=K.useState(e),[n]=r,a=K.useRef(n),l=Eu(t);return K.useEffect(()=>{a.current!==n&&(l(n),a.current=n)},[n,a,l]),r}var Pde=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],mi=Pde.reduce((e,t)=>{const r=K.forwardRef((n,a)=>{const{asChild:l,...h}=n,i=l?Vl:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(i,{...h,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function QK(e,t){e&&Fw.flushSync(()=>e.dispatchEvent(t))}function BD(e){const t=e+"CollectionProvider",[r,n]=Md(t),[a,l]=r(t,{collectionRef:{current:null},itemMap:new Map}),h=z=>{const{scope:V,children:U}=z,G=Pe.useRef(null),H=Pe.useRef(new Map).current;return f.jsx(a,{scope:V,itemMap:H,collectionRef:G,children:U})};h.displayName=t;const i=e+"CollectionSlot",_=Pe.forwardRef((z,V)=>{const{scope:U,children:G}=z,H=l(i,U),J=Xi(V,H.collectionRef);return f.jsx(Vl,{ref:J,children:G})});_.displayName=i;const w=e+"CollectionItemSlot",A="data-radix-collection-item",C=Pe.forwardRef((z,V)=>{const{scope:U,children:G,...H}=z,J=Pe.useRef(null),Q=Xi(V,J),le=l(w,U);return Pe.useEffect(()=>(le.itemMap.set(J,{ref:J,...H}),()=>void le.itemMap.delete(J))),f.jsx(Vl,{[A]:"",ref:Q,children:G})});C.displayName=w;function R(z){const V=l(e+"CollectionConsumer",z);return Pe.useCallback(()=>{const G=V.collectionRef.current;if(!G)return[];const H=Array.from(G.querySelectorAll(`[${A}]`));return Array.from(V.itemMap.values()).sort((le,ne)=>H.indexOf(le.ref.current)-H.indexOf(ne.ref.current))},[V.collectionRef,V.itemMap])}return[{Provider:h,Slot:_,ItemSlot:C},R,n]}var Ede=K.createContext(void 0);function VD(e){const t=K.useContext(Ede);return e||t||"ltr"}function Cde(e,t=globalThis==null?void 0:globalThis.document){const r=Eu(e);K.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Mde="DismissableLayer",Hj="dismissableLayer.update",Ode="dismissableLayer.pointerDownOutside",Rde="dismissableLayer.focusOutside",PB,eW=K.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),f0=K.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:h,onDismiss:i,..._}=e,w=K.useContext(eW),[A,C]=K.useState(null),R=(A==null?void 0:A.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,z]=K.useState({}),V=Xi(t,ue=>C(ue)),U=Array.from(w.layers),[G]=[...w.layersWithOutsidePointerEventsDisabled].slice(-1),H=U.indexOf(G),J=A?U.indexOf(A):-1,Q=w.layersWithOutsidePointerEventsDisabled.size>0,le=J>=H,ne=Nde(ue=>{const ve=ue.target,Ae=[...w.branches].some(Oe=>Oe.contains(ve));!le||Ae||(a==null||a(ue),h==null||h(ue),ue.defaultPrevented||i==null||i())},R),de=Ide(ue=>{const ve=ue.target;[...w.branches].some(Oe=>Oe.contains(ve))||(l==null||l(ue),h==null||h(ue),ue.defaultPrevented||i==null||i())},R);return Cde(ue=>{J===w.layers.size-1&&(n==null||n(ue),!ue.defaultPrevented&&i&&(ue.preventDefault(),i()))},R),K.useEffect(()=>{if(A)return r&&(w.layersWithOutsidePointerEventsDisabled.size===0&&(PB=R.body.style.pointerEvents,R.body.style.pointerEvents="none"),w.layersWithOutsidePointerEventsDisabled.add(A)),w.layers.add(A),EB(),()=>{r&&w.layersWithOutsidePointerEventsDisabled.size===1&&(R.body.style.pointerEvents=PB)}},[A,R,r,w]),K.useEffect(()=>()=>{A&&(w.layers.delete(A),w.layersWithOutsidePointerEventsDisabled.delete(A),EB())},[A,w]),K.useEffect(()=>{const ue=()=>z({});return document.addEventListener(Hj,ue),()=>document.removeEventListener(Hj,ue)},[]),f.jsx(mi.div,{..._,ref:V,style:{pointerEvents:Q?le?"auto":"none":void 0,...e.style},onFocusCapture:an(e.onFocusCapture,de.onFocusCapture),onBlurCapture:an(e.onBlurCapture,de.onBlurCapture),onPointerDownCapture:an(e.onPointerDownCapture,ne.onPointerDownCapture)})});f0.displayName=Mde;var kde="DismissableLayerBranch",jde=K.forwardRef((e,t)=>{const r=K.useContext(eW),n=K.useRef(null),a=Xi(t,n);return K.useEffect(()=>{const l=n.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),f.jsx(mi.div,{...e,ref:a})});jde.displayName=kde;function Nde(e,t=globalThis==null?void 0:globalThis.document){const r=Eu(e),n=K.useRef(!1),a=K.useRef(()=>{});return K.useEffect(()=>{const l=i=>{if(i.target&&!n.current){let _=function(){tW(Ode,r,w,{discrete:!0})};const w={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=_,t.addEventListener("click",a.current,{once:!0})):_()}else t.removeEventListener("click",a.current);n.current=!1},h=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(h),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Ide(e,t=globalThis==null?void 0:globalThis.document){const r=Eu(e),n=K.useRef(!1);return K.useEffect(()=>{const a=l=>{l.target&&!n.current&&tW(Rde,r,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function EB(){const e=new CustomEvent(Hj);document.dispatchEvent(e)}function tW(e,t,r,{discrete:n}){const a=r.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?QK(a,l):a.dispatchEvent(l)}var qC=0;function cP(){K.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??CB()),document.body.insertAdjacentElement("beforeend",e[1]??CB()),qC++,()=>{qC===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),qC--}},[])}function CB(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var GC="focusScope.autoFocusOnMount",KC="focusScope.autoFocusOnUnmount",MB={bubbles:!1,cancelable:!0},Dde="FocusScope",$w=K.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...h}=e,[i,_]=K.useState(null),w=Eu(a),A=Eu(l),C=K.useRef(null),R=Xi(t,U=>_(U)),z=K.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;K.useEffect(()=>{if(n){let U=function(Q){if(z.paused||!i)return;const le=Q.target;i.contains(le)?C.current=le:xg(C.current,{select:!0})},G=function(Q){if(z.paused||!i)return;const le=Q.relatedTarget;le!==null&&(i.contains(le)||xg(C.current,{select:!0}))},H=function(Q){if(document.activeElement===document.body)for(const ne of Q)ne.removedNodes.length>0&&xg(i)};document.addEventListener("focusin",U),document.addEventListener("focusout",G);const J=new MutationObserver(H);return i&&J.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",U),document.removeEventListener("focusout",G),J.disconnect()}}},[n,i,z.paused]),K.useEffect(()=>{if(i){RB.add(z);const U=document.activeElement;if(!i.contains(U)){const H=new CustomEvent(GC,MB);i.addEventListener(GC,w),i.dispatchEvent(H),H.defaultPrevented||(Lde(Ude(rW(i)),{select:!0}),document.activeElement===U&&xg(i))}return()=>{i.removeEventListener(GC,w),setTimeout(()=>{const H=new CustomEvent(KC,MB);i.addEventListener(KC,A),i.dispatchEvent(H),H.defaultPrevented||xg(U??document.body,{select:!0}),i.removeEventListener(KC,A),RB.remove(z)},0)}}},[i,w,A,z]);const V=K.useCallback(U=>{if(!r&&!n||z.paused)return;const G=U.key==="Tab"&&!U.altKey&&!U.ctrlKey&&!U.metaKey,H=document.activeElement;if(G&&H){const J=U.currentTarget,[Q,le]=zde(J);Q&&le?!U.shiftKey&&H===le?(U.preventDefault(),r&&xg(Q,{select:!0})):U.shiftKey&&H===Q&&(U.preventDefault(),r&&xg(le,{select:!0})):H===J&&U.preventDefault()}},[r,n,z.paused]);return f.jsx(mi.div,{tabIndex:-1,...h,ref:R,onKeyDown:V})});$w.displayName=Dde;function Lde(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(xg(n,{select:t}),document.activeElement!==r)return}function zde(e){const t=rW(e),r=OB(t,e),n=OB(t.reverse(),e);return[r,n]}function rW(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function OB(e,t){for(const r of e)if(!Fde(r,{upTo:t}))return r}function Fde(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Bde(e){return e instanceof HTMLInputElement&&"select"in e}function xg(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Bde(e)&&t&&e.select()}}var RB=Vde();function Vde(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=kB(e,t),e.unshift(t)},remove(t){var r;e=kB(e,t),(r=e[0])==null||r.resume()}}}function kB(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Ude(e){return e.filter(t=>t.tagName!=="A")}var rl=globalThis!=null&&globalThis.document?K.useLayoutEffect:()=>{},$de=$oe.useId||(()=>{}),qde=0;function Ad(e){const[t,r]=K.useState($de());return rl(()=>{r(n=>n??String(qde++))},[e]),t?`radix-${t}`:""}const Gde=["top","right","bottom","left"],jg=Math.min,yu=Math.max,TA=Math.round,E2=Math.floor,zf=e=>({x:e,y:e}),Kde={left:"right",right:"left",bottom:"top",top:"bottom"},Wde={start:"end",end:"start"};function Zj(e,t,r){return yu(e,jg(t,r))}function lm(e,t){return typeof e=="function"?e(t):e}function cm(e){return e.split("-")[0]}function p0(e){return e.split("-")[1]}function UD(e){return e==="x"?"y":"x"}function $D(e){return e==="y"?"height":"width"}function Ng(e){return["top","bottom"].includes(cm(e))?"y":"x"}function qD(e){return UD(Ng(e))}function Hde(e,t,r){r===void 0&&(r=!1);const n=p0(e),a=qD(e),l=$D(a);let h=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(h=PA(h)),[h,PA(h)]}function Zde(e){const t=PA(e);return[Yj(e),t,Yj(t)]}function Yj(e){return e.replace(/start|end/g,t=>Wde[t])}function Yde(e,t,r){const n=["left","right"],a=["right","left"],l=["top","bottom"],h=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?l:h;default:return[]}}function Xde(e,t,r,n){const a=p0(e);let l=Yde(cm(e),r==="start",n);return a&&(l=l.map(h=>h+"-"+a),t&&(l=l.concat(l.map(Yj)))),l}function PA(e){return e.replace(/left|right|bottom|top/g,t=>Kde[t])}function Jde(e){return{top:0,right:0,bottom:0,left:0,...e}}function nW(e){return typeof e!="number"?Jde(e):{top:e,right:e,bottom:e,left:e}}function EA(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function jB(e,t,r){let{reference:n,floating:a}=e;const l=Ng(t),h=qD(t),i=$D(h),_=cm(t),w=l==="y",A=n.x+n.width/2-a.width/2,C=n.y+n.height/2-a.height/2,R=n[i]/2-a[i]/2;let z;switch(_){case"top":z={x:A,y:n.y-a.height};break;case"bottom":z={x:A,y:n.y+n.height};break;case"right":z={x:n.x+n.width,y:C};break;case"left":z={x:n.x-a.width,y:C};break;default:z={x:n.x,y:n.y}}switch(p0(t)){case"start":z[h]-=R*(r&&w?-1:1);break;case"end":z[h]+=R*(r&&w?-1:1);break}return z}const Qde=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:h}=r,i=l.filter(Boolean),_=await(h.isRTL==null?void 0:h.isRTL(t));let w=await h.getElementRects({reference:e,floating:t,strategy:a}),{x:A,y:C}=jB(w,n,_),R=n,z={},V=0;for(let U=0;U<i.length;U++){const{name:G,fn:H}=i[U],{x:J,y:Q,data:le,reset:ne}=await H({x:A,y:C,initialPlacement:n,placement:R,strategy:a,middlewareData:z,rects:w,platform:h,elements:{reference:e,floating:t}});A=J??A,C=Q??C,z={...z,[G]:{...z[G],...le}},ne&&V<=50&&(V++,typeof ne=="object"&&(ne.placement&&(R=ne.placement),ne.rects&&(w=ne.rects===!0?await h.getElementRects({reference:e,floating:t,strategy:a}):ne.rects),{x:A,y:C}=jB(w,R,_)),U=-1)}return{x:A,y:C,placement:R,strategy:a,middlewareData:z}};async function E1(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:l,rects:h,elements:i,strategy:_}=e,{boundary:w="clippingAncestors",rootBoundary:A="viewport",elementContext:C="floating",altBoundary:R=!1,padding:z=0}=lm(t,e),V=nW(z),G=i[R?C==="floating"?"reference":"floating":C],H=EA(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(G)))==null||r?G:G.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(i.floating)),boundary:w,rootBoundary:A,strategy:_})),J=C==="floating"?{x:n,y:a,width:h.floating.width,height:h.floating.height}:h.reference,Q=await(l.getOffsetParent==null?void 0:l.getOffsetParent(i.floating)),le=await(l.isElement==null?void 0:l.isElement(Q))?await(l.getScale==null?void 0:l.getScale(Q))||{x:1,y:1}:{x:1,y:1},ne=EA(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:J,offsetParent:Q,strategy:_}):J);return{top:(H.top-ne.top+V.top)/le.y,bottom:(ne.bottom-H.bottom+V.bottom)/le.y,left:(H.left-ne.left+V.left)/le.x,right:(ne.right-H.right+V.right)/le.x}}const ehe=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:l,platform:h,elements:i,middlewareData:_}=t,{element:w,padding:A=0}=lm(e,t)||{};if(w==null)return{};const C=nW(A),R={x:r,y:n},z=qD(a),V=$D(z),U=await h.getDimensions(w),G=z==="y",H=G?"top":"left",J=G?"bottom":"right",Q=G?"clientHeight":"clientWidth",le=l.reference[V]+l.reference[z]-R[z]-l.floating[V],ne=R[z]-l.reference[z],de=await(h.getOffsetParent==null?void 0:h.getOffsetParent(w));let ue=de?de[Q]:0;(!ue||!await(h.isElement==null?void 0:h.isElement(de)))&&(ue=i.floating[Q]||l.floating[V]);const ve=le/2-ne/2,Ae=ue/2-U[V]/2-1,Oe=jg(C[H],Ae),Se=jg(C[J],Ae),ke=Oe,ze=ue-U[V]-Se,et=ue/2-U[V]/2+ve,je=Zj(ke,et,ze),Ne=!_.arrow&&p0(a)!=null&&et!==je&&l.reference[V]/2-(et<ke?Oe:Se)-U[V]/2<0,Ye=Ne?et<ke?et-ke:et-ze:0;return{[z]:R[z]+Ye,data:{[z]:je,centerOffset:et-je-Ye,...Ne&&{alignmentOffset:Ye}},reset:Ne}}}),the=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:l,rects:h,initialPlacement:i,platform:_,elements:w}=t,{mainAxis:A=!0,crossAxis:C=!0,fallbackPlacements:R,fallbackStrategy:z="bestFit",fallbackAxisSideDirection:V="none",flipAlignment:U=!0,...G}=lm(e,t);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const H=cm(a),J=Ng(i),Q=cm(i)===i,le=await(_.isRTL==null?void 0:_.isRTL(w.floating)),ne=R||(Q||!U?[PA(i)]:Zde(i)),de=V!=="none";!R&&de&&ne.push(...Xde(i,U,V,le));const ue=[i,...ne],ve=await E1(t,G),Ae=[];let Oe=((n=l.flip)==null?void 0:n.overflows)||[];if(A&&Ae.push(ve[H]),C){const et=Hde(a,h,le);Ae.push(ve[et[0]],ve[et[1]])}if(Oe=[...Oe,{placement:a,overflows:Ae}],!Ae.every(et=>et<=0)){var Se,ke;const et=(((Se=l.flip)==null?void 0:Se.index)||0)+1,je=ue[et];if(je)return{data:{index:et,overflows:Oe},reset:{placement:je}};let Ne=(ke=Oe.filter(Ye=>Ye.overflows[0]<=0).sort((Ye,$e)=>Ye.overflows[1]-$e.overflows[1])[0])==null?void 0:ke.placement;if(!Ne)switch(z){case"bestFit":{var ze;const Ye=(ze=Oe.filter($e=>{if(de){const We=Ng($e.placement);return We===J||We==="y"}return!0}).map($e=>[$e.placement,$e.overflows.filter(We=>We>0).reduce((We,Et)=>We+Et,0)]).sort(($e,We)=>$e[1]-We[1])[0])==null?void 0:ze[0];Ye&&(Ne=Ye);break}case"initialPlacement":Ne=i;break}if(a!==Ne)return{reset:{placement:Ne}}}return{}}}};function NB(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function IB(e){return Gde.some(t=>e[t]>=0)}const rhe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=lm(e,t);switch(n){case"referenceHidden":{const l=await E1(t,{...a,elementContext:"reference"}),h=NB(l,r.reference);return{data:{referenceHiddenOffsets:h,referenceHidden:IB(h)}}}case"escaped":{const l=await E1(t,{...a,altBoundary:!0}),h=NB(l,r.floating);return{data:{escapedOffsets:h,escaped:IB(h)}}}default:return{}}}}};async function nhe(e,t){const{placement:r,platform:n,elements:a}=e,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),h=cm(r),i=p0(r),_=Ng(r)==="y",w=["left","top"].includes(h)?-1:1,A=l&&_?-1:1,C=lm(t,e);let{mainAxis:R,crossAxis:z,alignmentAxis:V}=typeof C=="number"?{mainAxis:C,crossAxis:0,alignmentAxis:null}:{mainAxis:C.mainAxis||0,crossAxis:C.crossAxis||0,alignmentAxis:C.alignmentAxis};return i&&typeof V=="number"&&(z=i==="end"?V*-1:V),_?{x:z*A,y:R*w}:{x:R*w,y:z*A}}const ihe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:l,placement:h,middlewareData:i}=t,_=await nhe(t,e);return h===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+_.x,y:l+_.y,data:{..._,placement:h}}}}},ahe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:l=!0,crossAxis:h=!1,limiter:i={fn:G=>{let{x:H,y:J}=G;return{x:H,y:J}}},..._}=lm(e,t),w={x:r,y:n},A=await E1(t,_),C=Ng(cm(a)),R=UD(C);let z=w[R],V=w[C];if(l){const G=R==="y"?"top":"left",H=R==="y"?"bottom":"right",J=z+A[G],Q=z-A[H];z=Zj(J,z,Q)}if(h){const G=C==="y"?"top":"left",H=C==="y"?"bottom":"right",J=V+A[G],Q=V-A[H];V=Zj(J,V,Q)}const U=i.fn({...t,[R]:z,[C]:V});return{...U,data:{x:U.x-r,y:U.y-n,enabled:{[R]:l,[C]:h}}}}}},ohe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:l,middlewareData:h}=t,{offset:i=0,mainAxis:_=!0,crossAxis:w=!0}=lm(e,t),A={x:r,y:n},C=Ng(a),R=UD(C);let z=A[R],V=A[C];const U=lm(i,t),G=typeof U=="number"?{mainAxis:U,crossAxis:0}:{mainAxis:0,crossAxis:0,...U};if(_){const Q=R==="y"?"height":"width",le=l.reference[R]-l.floating[Q]+G.mainAxis,ne=l.reference[R]+l.reference[Q]-G.mainAxis;z<le?z=le:z>ne&&(z=ne)}if(w){var H,J;const Q=R==="y"?"width":"height",le=["top","left"].includes(cm(a)),ne=l.reference[C]-l.floating[Q]+(le&&((H=h.offset)==null?void 0:H[C])||0)+(le?0:G.crossAxis),de=l.reference[C]+l.reference[Q]+(le?0:((J=h.offset)==null?void 0:J[C])||0)-(le?G.crossAxis:0);V<ne?V=ne:V>de&&(V=de)}return{[R]:z,[C]:V}}}},she=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:l,platform:h,elements:i}=t,{apply:_=()=>{},...w}=lm(e,t),A=await E1(t,w),C=cm(a),R=p0(a),z=Ng(a)==="y",{width:V,height:U}=l.floating;let G,H;C==="top"||C==="bottom"?(G=C,H=R===(await(h.isRTL==null?void 0:h.isRTL(i.floating))?"start":"end")?"left":"right"):(H=C,G=R==="end"?"top":"bottom");const J=U-A.top-A.bottom,Q=V-A.left-A.right,le=jg(U-A[G],J),ne=jg(V-A[H],Q),de=!t.middlewareData.shift;let ue=le,ve=ne;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(ve=Q),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(ue=J),de&&!R){const Oe=yu(A.left,0),Se=yu(A.right,0),ke=yu(A.top,0),ze=yu(A.bottom,0);z?ve=V-2*(Oe!==0||Se!==0?Oe+Se:yu(A.left,A.right)):ue=U-2*(ke!==0||ze!==0?ke+ze:yu(A.top,A.bottom))}await _({...t,availableWidth:ve,availableHeight:ue});const Ae=await h.getDimensions(i.floating);return V!==Ae.width||U!==Ae.height?{reset:{rects:!0}}:{}}}};function uP(){return typeof window<"u"}function m0(e){return iW(e)?(e.nodeName||"").toLowerCase():"#document"}function xu(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Qf(e){var t;return(t=(iW(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function iW(e){return uP()?e instanceof Node||e instanceof xu(e).Node:!1}function Ih(e){return uP()?e instanceof Element||e instanceof xu(e).Element:!1}function qf(e){return uP()?e instanceof HTMLElement||e instanceof xu(e).HTMLElement:!1}function DB(e){return!uP()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof xu(e).ShadowRoot}function qw(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Dh(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function lhe(e){return["table","td","th"].includes(m0(e))}function dP(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function GD(e){const t=KD(),r=Ih(e)?Dh(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function che(e){let t=Ig(e);for(;qf(t)&&!_x(t);){if(GD(t))return t;if(dP(t))return null;t=Ig(t)}return null}function KD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function _x(e){return["html","body","#document"].includes(m0(e))}function Dh(e){return xu(e).getComputedStyle(e)}function hP(e){return Ih(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ig(e){if(m0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||DB(e)&&e.host||Qf(e);return DB(t)?t.host:t}function aW(e){const t=Ig(e);return _x(t)?e.ownerDocument?e.ownerDocument.body:e.body:qf(t)&&qw(t)?t:aW(t)}function C1(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=aW(e),l=a===((n=e.ownerDocument)==null?void 0:n.body),h=xu(a);if(l){const i=Xj(h);return t.concat(h,h.visualViewport||[],qw(a)?a:[],i&&r?C1(i):[])}return t.concat(a,C1(a,[],r))}function Xj(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function oW(e){const t=Dh(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=qf(e),l=a?e.offsetWidth:r,h=a?e.offsetHeight:n,i=TA(r)!==l||TA(n)!==h;return i&&(r=l,n=h),{width:r,height:n,$:i}}function WD(e){return Ih(e)?e:e.contextElement}function dx(e){const t=WD(e);if(!qf(t))return zf(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:l}=oW(t);let h=(l?TA(r.width):r.width)/n,i=(l?TA(r.height):r.height)/a;return(!h||!Number.isFinite(h))&&(h=1),(!i||!Number.isFinite(i))&&(i=1),{x:h,y:i}}const uhe=zf(0);function sW(e){const t=xu(e);return!KD()||!t.visualViewport?uhe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function dhe(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==xu(e)?!1:t}function Tv(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),l=WD(e);let h=zf(1);t&&(n?Ih(n)&&(h=dx(n)):h=dx(e));const i=dhe(l,r,n)?sW(l):zf(0);let _=(a.left+i.x)/h.x,w=(a.top+i.y)/h.y,A=a.width/h.x,C=a.height/h.y;if(l){const R=xu(l),z=n&&Ih(n)?xu(n):n;let V=R,U=Xj(V);for(;U&&n&&z!==V;){const G=dx(U),H=U.getBoundingClientRect(),J=Dh(U),Q=H.left+(U.clientLeft+parseFloat(J.paddingLeft))*G.x,le=H.top+(U.clientTop+parseFloat(J.paddingTop))*G.y;_*=G.x,w*=G.y,A*=G.x,C*=G.y,_+=Q,w+=le,V=xu(U),U=Xj(V)}}return EA({width:A,height:C,x:_,y:w})}function HD(e,t){const r=hP(e).scrollLeft;return t?t.left+r:Tv(Qf(e)).left+r}function lW(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:HD(e,n)),l=n.top+t.scrollTop;return{x:a,y:l}}function hhe(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const l=a==="fixed",h=Qf(n),i=t?dP(t.floating):!1;if(n===h||i&&l)return r;let _={scrollLeft:0,scrollTop:0},w=zf(1);const A=zf(0),C=qf(n);if((C||!C&&!l)&&((m0(n)!=="body"||qw(h))&&(_=hP(n)),qf(n))){const z=Tv(n);w=dx(n),A.x=z.x+n.clientLeft,A.y=z.y+n.clientTop}const R=h&&!C&&!l?lW(h,_,!0):zf(0);return{width:r.width*w.x,height:r.height*w.y,x:r.x*w.x-_.scrollLeft*w.x+A.x+R.x,y:r.y*w.y-_.scrollTop*w.y+A.y+R.y}}function fhe(e){return Array.from(e.getClientRects())}function phe(e){const t=Qf(e),r=hP(e),n=e.ownerDocument.body,a=yu(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),l=yu(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let h=-r.scrollLeft+HD(e);const i=-r.scrollTop;return Dh(n).direction==="rtl"&&(h+=yu(t.clientWidth,n.clientWidth)-a),{width:a,height:l,x:h,y:i}}function mhe(e,t){const r=xu(e),n=Qf(e),a=r.visualViewport;let l=n.clientWidth,h=n.clientHeight,i=0,_=0;if(a){l=a.width,h=a.height;const w=KD();(!w||w&&t==="fixed")&&(i=a.offsetLeft,_=a.offsetTop)}return{width:l,height:h,x:i,y:_}}function ghe(e,t){const r=Tv(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,l=qf(e)?dx(e):zf(1),h=e.clientWidth*l.x,i=e.clientHeight*l.y,_=a*l.x,w=n*l.y;return{width:h,height:i,x:_,y:w}}function LB(e,t,r){let n;if(t==="viewport")n=mhe(e,r);else if(t==="document")n=phe(Qf(e));else if(Ih(t))n=ghe(t,r);else{const a=sW(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return EA(n)}function cW(e,t){const r=Ig(e);return r===t||!Ih(r)||_x(r)?!1:Dh(r).position==="fixed"||cW(r,t)}function yhe(e,t){const r=t.get(e);if(r)return r;let n=C1(e,[],!1).filter(i=>Ih(i)&&m0(i)!=="body"),a=null;const l=Dh(e).position==="fixed";let h=l?Ig(e):e;for(;Ih(h)&&!_x(h);){const i=Dh(h),_=GD(h);!_&&i.position==="fixed"&&(a=null),(l?!_&&!a:!_&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||qw(h)&&!_&&cW(e,h))?n=n.filter(A=>A!==h):a=i,h=Ig(h)}return t.set(e,n),n}function vhe(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const h=[...r==="clippingAncestors"?dP(t)?[]:yhe(t,this._c):[].concat(r),n],i=h[0],_=h.reduce((w,A)=>{const C=LB(t,A,a);return w.top=yu(C.top,w.top),w.right=jg(C.right,w.right),w.bottom=jg(C.bottom,w.bottom),w.left=yu(C.left,w.left),w},LB(t,i,a));return{width:_.right-_.left,height:_.bottom-_.top,x:_.left,y:_.top}}function _he(e){const{width:t,height:r}=oW(e);return{width:t,height:r}}function xhe(e,t,r){const n=qf(t),a=Qf(t),l=r==="fixed",h=Tv(e,!0,l,t);let i={scrollLeft:0,scrollTop:0};const _=zf(0);if(n||!n&&!l)if((m0(t)!=="body"||qw(a))&&(i=hP(t)),n){const R=Tv(t,!0,l,t);_.x=R.x+t.clientLeft,_.y=R.y+t.clientTop}else a&&(_.x=HD(a));const w=a&&!n&&!l?lW(a,i):zf(0),A=h.left+i.scrollLeft-_.x-w.x,C=h.top+i.scrollTop-_.y-w.y;return{x:A,y:C,width:h.width,height:h.height}}function WC(e){return Dh(e).position==="static"}function zB(e,t){if(!qf(e)||Dh(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Qf(e)===r&&(r=r.ownerDocument.body),r}function uW(e,t){const r=xu(e);if(dP(e))return r;if(!qf(e)){let a=Ig(e);for(;a&&!_x(a);){if(Ih(a)&&!WC(a))return a;a=Ig(a)}return r}let n=zB(e,t);for(;n&&lhe(n)&&WC(n);)n=zB(n,t);return n&&_x(n)&&WC(n)&&!GD(n)?r:n||che(e)||r}const bhe=async function(e){const t=this.getOffsetParent||uW,r=this.getDimensions,n=await r(e.floating);return{reference:xhe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function whe(e){return Dh(e).direction==="rtl"}const She={convertOffsetParentRelativeRectToViewportRelativeRect:hhe,getDocumentElement:Qf,getClippingRect:vhe,getOffsetParent:uW,getElementRects:bhe,getClientRects:fhe,getDimensions:_he,getScale:dx,isElement:Ih,isRTL:whe};function dW(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Ahe(e,t){let r=null,n;const a=Qf(e);function l(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function h(i,_){i===void 0&&(i=!1),_===void 0&&(_=1),l();const w=e.getBoundingClientRect(),{left:A,top:C,width:R,height:z}=w;if(i||t(),!R||!z)return;const V=E2(C),U=E2(a.clientWidth-(A+R)),G=E2(a.clientHeight-(C+z)),H=E2(A),Q={rootMargin:-V+"px "+-U+"px "+-G+"px "+-H+"px",threshold:yu(0,jg(1,_))||1};let le=!0;function ne(de){const ue=de[0].intersectionRatio;if(ue!==_){if(!le)return h();ue?h(!1,ue):n=setTimeout(()=>{h(!1,1e-7)},1e3)}ue===1&&!dW(w,e.getBoundingClientRect())&&h(),le=!1}try{r=new IntersectionObserver(ne,{...Q,root:a.ownerDocument})}catch{r=new IntersectionObserver(ne,Q)}r.observe(e)}return h(!0),l}function The(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:_=!1}=n,w=WD(e),A=a||l?[...w?C1(w):[],...C1(t)]:[];A.forEach(H=>{a&&H.addEventListener("scroll",r,{passive:!0}),l&&H.addEventListener("resize",r)});const C=w&&i?Ahe(w,r):null;let R=-1,z=null;h&&(z=new ResizeObserver(H=>{let[J]=H;J&&J.target===w&&z&&(z.unobserve(t),cancelAnimationFrame(R),R=requestAnimationFrame(()=>{var Q;(Q=z)==null||Q.observe(t)})),r()}),w&&!_&&z.observe(w),z.observe(t));let V,U=_?Tv(e):null;_&&G();function G(){const H=Tv(e);U&&!dW(U,H)&&r(),U=H,V=requestAnimationFrame(G)}return r(),()=>{var H;A.forEach(J=>{a&&J.removeEventListener("scroll",r),l&&J.removeEventListener("resize",r)}),C==null||C(),(H=z)==null||H.disconnect(),z=null,_&&cancelAnimationFrame(V)}}const Phe=ihe,Ehe=ahe,Che=the,Mhe=she,Ohe=rhe,FB=ehe,Rhe=ohe,khe=(e,t,r)=>{const n=new Map,a={platform:She,...r},l={...a.platform,_c:n};return Qde(e,t,{...a,platform:l})};var oA=typeof document<"u"?K.useLayoutEffect:K.useEffect;function CA(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!CA(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const l=a[n];if(!(l==="_owner"&&e.$$typeof)&&!CA(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function hW(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function BB(e,t){const r=hW(e);return Math.round(t*r)/r}function HC(e){const t=K.useRef(e);return oA(()=>{t.current=e}),t}function jhe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:h}={},transform:i=!0,whileElementsMounted:_,open:w}=e,[A,C]=K.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[R,z]=K.useState(n);CA(R,n)||z(n);const[V,U]=K.useState(null),[G,H]=K.useState(null),J=K.useCallback($e=>{$e!==de.current&&(de.current=$e,U($e))},[]),Q=K.useCallback($e=>{$e!==ue.current&&(ue.current=$e,H($e))},[]),le=l||V,ne=h||G,de=K.useRef(null),ue=K.useRef(null),ve=K.useRef(A),Ae=_!=null,Oe=HC(_),Se=HC(a),ke=HC(w),ze=K.useCallback(()=>{if(!de.current||!ue.current)return;const $e={placement:t,strategy:r,middleware:R};Se.current&&($e.platform=Se.current),khe(de.current,ue.current,$e).then(We=>{const Et={...We,isPositioned:ke.current!==!1};et.current&&!CA(ve.current,Et)&&(ve.current=Et,Fw.flushSync(()=>{C(Et)}))})},[R,t,r,Se,ke]);oA(()=>{w===!1&&ve.current.isPositioned&&(ve.current.isPositioned=!1,C($e=>({...$e,isPositioned:!1})))},[w]);const et=K.useRef(!1);oA(()=>(et.current=!0,()=>{et.current=!1}),[]),oA(()=>{if(le&&(de.current=le),ne&&(ue.current=ne),le&&ne){if(Oe.current)return Oe.current(le,ne,ze);ze()}},[le,ne,ze,Oe,Ae]);const je=K.useMemo(()=>({reference:de,floating:ue,setReference:J,setFloating:Q}),[J,Q]),Ne=K.useMemo(()=>({reference:le,floating:ne}),[le,ne]),Ye=K.useMemo(()=>{const $e={position:r,left:0,top:0};if(!Ne.floating)return $e;const We=BB(Ne.floating,A.x),Et=BB(Ne.floating,A.y);return i?{...$e,transform:"translate("+We+"px, "+Et+"px)",...hW(Ne.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:We,top:Et}},[r,i,Ne.floating,A.x,A.y]);return K.useMemo(()=>({...A,update:ze,refs:je,elements:Ne,floatingStyles:Ye}),[A,ze,je,Ne,Ye])}const Nhe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?FB({element:n.current,padding:a}).fn(r):{}:n?FB({element:n,padding:a}).fn(r):{}}}},Ihe=(e,t)=>({...Phe(e),options:[e,t]}),Dhe=(e,t)=>({...Ehe(e),options:[e,t]}),Lhe=(e,t)=>({...Rhe(e),options:[e,t]}),zhe=(e,t)=>({...Che(e),options:[e,t]}),Fhe=(e,t)=>({...Mhe(e),options:[e,t]}),Bhe=(e,t)=>({...Ohe(e),options:[e,t]}),Vhe=(e,t)=>({...Nhe(e),options:[e,t]});var Uhe="Arrow",fW=K.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...l}=e;return f.jsx(mi.svg,{...l,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});fW.displayName=Uhe;var $he=fW;function qhe(e){const[t,r]=K.useState(void 0);return rl(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let h,i;if("borderBoxSize"in l){const _=l.borderBoxSize,w=Array.isArray(_)?_[0]:_;h=w.inlineSize,i=w.blockSize}else h=e.offsetWidth,i=e.offsetHeight;r({width:h,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var ZD="Popper",[pW,qg]=Md(ZD),[Ghe,mW]=pW(ZD),gW=e=>{const{__scopePopper:t,children:r}=e,[n,a]=K.useState(null);return f.jsx(Ghe,{scope:t,anchor:n,onAnchorChange:a,children:r})};gW.displayName=ZD;var yW="PopperAnchor",vW=K.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,l=mW(yW,r),h=K.useRef(null),i=Xi(t,h);return K.useEffect(()=>{l.onAnchorChange((n==null?void 0:n.current)||h.current)}),n?null:f.jsx(mi.div,{...a,ref:i})});vW.displayName=yW;var YD="PopperContent",[Khe,Whe]=pW(YD),_W=K.forwardRef((e,t)=>{var ur,br,Wt,Be,Nr,Jt;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:h=0,arrowPadding:i=0,avoidCollisions:_=!0,collisionBoundary:w=[],collisionPadding:A=0,sticky:C="partial",hideWhenDetached:R=!1,updatePositionStrategy:z="optimized",onPlaced:V,...U}=e,G=mW(YD,r),[H,J]=K.useState(null),Q=Xi(t,Sn=>J(Sn)),[le,ne]=K.useState(null),de=qhe(le),ue=(de==null?void 0:de.width)??0,ve=(de==null?void 0:de.height)??0,Ae=n+(l!=="center"?"-"+l:""),Oe=typeof A=="number"?A:{top:0,right:0,bottom:0,left:0,...A},Se=Array.isArray(w)?w:[w],ke=Se.length>0,ze={padding:Oe,boundary:Se.filter(Zhe),altBoundary:ke},{refs:et,floatingStyles:je,placement:Ne,isPositioned:Ye,middlewareData:$e}=jhe({strategy:"fixed",placement:Ae,whileElementsMounted:(...Sn)=>The(...Sn,{animationFrame:z==="always"}),elements:{reference:G.anchor},middleware:[Ihe({mainAxis:a+ve,alignmentAxis:h}),_&&Dhe({mainAxis:!0,crossAxis:!1,limiter:C==="partial"?Lhe():void 0,...ze}),_&&zhe({...ze}),Fhe({...ze,apply:({elements:Sn,rects:It,availableWidth:Vn,availableHeight:Un})=>{const{width:Xr,height:rt}=It.reference,Ot=Sn.floating.style;Ot.setProperty("--radix-popper-available-width",`${Vn}px`),Ot.setProperty("--radix-popper-available-height",`${Un}px`),Ot.setProperty("--radix-popper-anchor-width",`${Xr}px`),Ot.setProperty("--radix-popper-anchor-height",`${rt}px`)}}),le&&Vhe({element:le,padding:i}),Yhe({arrowWidth:ue,arrowHeight:ve}),R&&Bhe({strategy:"referenceHidden",...ze})]}),[We,Et]=wW(Ne),Je=Eu(V);rl(()=>{Ye&&(Je==null||Je())},[Ye,Je]);const ht=(ur=$e.arrow)==null?void 0:ur.x,tt=(br=$e.arrow)==null?void 0:br.y,Qt=((Wt=$e.arrow)==null?void 0:Wt.centerOffset)!==0,[gr,sr]=K.useState();return rl(()=>{H&&sr(window.getComputedStyle(H).zIndex)},[H]),f.jsx("div",{ref:et.setFloating,"data-radix-popper-content-wrapper":"",style:{...je,transform:Ye?je.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:gr,"--radix-popper-transform-origin":[(Be=$e.transformOrigin)==null?void 0:Be.x,(Nr=$e.transformOrigin)==null?void 0:Nr.y].join(" "),...((Jt=$e.hide)==null?void 0:Jt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(Khe,{scope:r,placedSide:We,onArrowChange:ne,arrowX:ht,arrowY:tt,shouldHideArrow:Qt,children:f.jsx(mi.div,{"data-side":We,"data-align":Et,...U,ref:Q,style:{...U.style,animation:Ye?void 0:"none"}})})})});_W.displayName=YD;var xW="PopperArrow",Hhe={top:"bottom",right:"left",bottom:"top",left:"right"},bW=K.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,l=Whe(xW,n),h=Hhe[l.placedSide];return f.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[h]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:f.jsx($he,{...a,ref:r,style:{...a.style,display:"block"}})})});bW.displayName=xW;function Zhe(e){return e!==null}var Yhe=e=>({name:"transformOrigin",options:e,fn(t){var G,H,J;const{placement:r,rects:n,middlewareData:a}=t,h=((G=a.arrow)==null?void 0:G.centerOffset)!==0,i=h?0:e.arrowWidth,_=h?0:e.arrowHeight,[w,A]=wW(r),C={start:"0%",center:"50%",end:"100%"}[A],R=(((H=a.arrow)==null?void 0:H.x)??0)+i/2,z=(((J=a.arrow)==null?void 0:J.y)??0)+_/2;let V="",U="";return w==="bottom"?(V=h?C:`${R}px`,U=`${-_}px`):w==="top"?(V=h?C:`${R}px`,U=`${n.floating.height+_}px`):w==="right"?(V=`${-_}px`,U=h?C:`${z}px`):w==="left"&&(V=`${n.floating.width+_}px`,U=h?C:`${z}px`),{data:{x:V,y:U}}}});function wW(e){const[t,r="center"]=e.split("-");return[t,r]}var fP=gW,Gw=vW,pP=_W,mP=bW,Xhe="Portal",g0=K.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[a,l]=K.useState(!1);rl(()=>l(!0),[]);const h=r||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return h?gK.createPortal(f.jsx(mi.div,{...n,ref:t}),h):null});g0.displayName=Xhe;function Jhe(e,t){return K.useReducer((r,n)=>t[r][n]??r,e)}var Ru=e=>{const{present:t,children:r}=e,n=Qhe(t),a=typeof r=="function"?r({present:n.isPresent}):K.Children.only(r),l=Xi(n.ref,efe(a));return typeof r=="function"||n.isPresent?K.cloneElement(a,{ref:l}):null};Ru.displayName="Presence";function Qhe(e){const[t,r]=K.useState(),n=K.useRef({}),a=K.useRef(e),l=K.useRef("none"),h=e?"mounted":"unmounted",[i,_]=Jhe(h,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return K.useEffect(()=>{const w=C2(n.current);l.current=i==="mounted"?w:"none"},[i]),rl(()=>{const w=n.current,A=a.current;if(A!==e){const R=l.current,z=C2(w);e?_("MOUNT"):z==="none"||(w==null?void 0:w.display)==="none"?_("UNMOUNT"):_(A&&R!==z?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,_]),rl(()=>{if(t){let w;const A=t.ownerDocument.defaultView??window,C=z=>{const U=C2(n.current).includes(z.animationName);if(z.target===t&&U&&(_("ANIMATION_END"),!a.current)){const G=t.style.animationFillMode;t.style.animationFillMode="forwards",w=A.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=G)})}},R=z=>{z.target===t&&(l.current=C2(n.current))};return t.addEventListener("animationstart",R),t.addEventListener("animationcancel",C),t.addEventListener("animationend",C),()=>{A.clearTimeout(w),t.removeEventListener("animationstart",R),t.removeEventListener("animationcancel",C),t.removeEventListener("animationend",C)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:K.useCallback(w=>{w&&(n.current=getComputedStyle(w)),r(w)},[])}}function C2(e){return(e==null?void 0:e.animationName)||"none"}function efe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var ZC="rovingFocusGroup.onEntryFocus",tfe={bubbles:!1,cancelable:!0},gP="RovingFocusGroup",[Jj,SW,rfe]=BD(gP),[nfe,AW]=Md(gP,[rfe]),[ife,afe]=nfe(gP),TW=K.forwardRef((e,t)=>f.jsx(Jj.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(Jj.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(ofe,{...e,ref:t})})}));TW.displayName=gP;var ofe=K.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:l,currentTabStopId:h,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:_,onEntryFocus:w,preventScrollOnEntryFocus:A=!1,...C}=e,R=K.useRef(null),z=Xi(t,R),V=VD(l),[U=null,G]=kg({prop:h,defaultProp:i,onChange:_}),[H,J]=K.useState(!1),Q=Eu(w),le=SW(r),ne=K.useRef(!1),[de,ue]=K.useState(0);return K.useEffect(()=>{const ve=R.current;if(ve)return ve.addEventListener(ZC,Q),()=>ve.removeEventListener(ZC,Q)},[Q]),f.jsx(ife,{scope:r,orientation:n,dir:V,loop:a,currentTabStopId:U,onItemFocus:K.useCallback(ve=>G(ve),[G]),onItemShiftTab:K.useCallback(()=>J(!0),[]),onFocusableItemAdd:K.useCallback(()=>ue(ve=>ve+1),[]),onFocusableItemRemove:K.useCallback(()=>ue(ve=>ve-1),[]),children:f.jsx(mi.div,{tabIndex:H||de===0?-1:0,"data-orientation":n,...C,ref:z,style:{outline:"none",...e.style},onMouseDown:an(e.onMouseDown,()=>{ne.current=!0}),onFocus:an(e.onFocus,ve=>{const Ae=!ne.current;if(ve.target===ve.currentTarget&&Ae&&!H){const Oe=new CustomEvent(ZC,tfe);if(ve.currentTarget.dispatchEvent(Oe),!Oe.defaultPrevented){const Se=le().filter(Ne=>Ne.focusable),ke=Se.find(Ne=>Ne.active),ze=Se.find(Ne=>Ne.id===U),je=[ke,ze,...Se].filter(Boolean).map(Ne=>Ne.ref.current);CW(je,A)}}ne.current=!1}),onBlur:an(e.onBlur,()=>J(!1))})})}),PW="RovingFocusGroupItem",EW=K.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:l,...h}=e,i=Ad(),_=l||i,w=afe(PW,r),A=w.currentTabStopId===_,C=SW(r),{onFocusableItemAdd:R,onFocusableItemRemove:z}=w;return K.useEffect(()=>{if(n)return R(),()=>z()},[n,R,z]),f.jsx(Jj.ItemSlot,{scope:r,id:_,focusable:n,active:a,children:f.jsx(mi.span,{tabIndex:A?0:-1,"data-orientation":w.orientation,...h,ref:t,onMouseDown:an(e.onMouseDown,V=>{n?w.onItemFocus(_):V.preventDefault()}),onFocus:an(e.onFocus,()=>w.onItemFocus(_)),onKeyDown:an(e.onKeyDown,V=>{if(V.key==="Tab"&&V.shiftKey){w.onItemShiftTab();return}if(V.target!==V.currentTarget)return;const U=cfe(V,w.orientation,w.dir);if(U!==void 0){if(V.metaKey||V.ctrlKey||V.altKey||V.shiftKey)return;V.preventDefault();let H=C().filter(J=>J.focusable).map(J=>J.ref.current);if(U==="last")H.reverse();else if(U==="prev"||U==="next"){U==="prev"&&H.reverse();const J=H.indexOf(V.currentTarget);H=w.loop?ufe(H,J+1):H.slice(J+1)}setTimeout(()=>CW(H))}})})})});EW.displayName=PW;var sfe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function lfe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function cfe(e,t,r){const n=lfe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return sfe[n]}function CW(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function ufe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var dfe=TW,hfe=EW,ffe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},U_=new WeakMap,M2=new WeakMap,O2={},YC=0,MW=function(e){return e&&(e.host||MW(e.parentNode))},pfe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=MW(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},mfe=function(e,t,r,n){var a=pfe(t,Array.isArray(e)?e:[e]);O2[r]||(O2[r]=new WeakMap);var l=O2[r],h=[],i=new Set,_=new Set(a),w=function(C){!C||i.has(C)||(i.add(C),w(C.parentNode))};a.forEach(w);var A=function(C){!C||_.has(C)||Array.prototype.forEach.call(C.children,function(R){if(i.has(R))A(R);else try{var z=R.getAttribute(n),V=z!==null&&z!=="false",U=(U_.get(R)||0)+1,G=(l.get(R)||0)+1;U_.set(R,U),l.set(R,G),h.push(R),U===1&&V&&M2.set(R,!0),G===1&&R.setAttribute(r,"true"),V||R.setAttribute(n,"true")}catch(H){console.error("aria-hidden: cannot operate on ",R,H)}})};return A(t),i.clear(),YC++,function(){h.forEach(function(C){var R=U_.get(C)-1,z=l.get(C)-1;U_.set(C,R),l.set(C,z),R||(M2.has(C)||C.removeAttribute(n),M2.delete(C)),z||C.removeAttribute(r)}),YC--,YC||(U_=new WeakMap,U_=new WeakMap,M2=new WeakMap,O2={})}},yP=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=ffe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),mfe(n,a,r,"aria-hidden")):function(){return null}},kf=function(){return kf=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},kf.apply(this,arguments)};function OW(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function gfe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}var sA="right-scroll-bar-position",lA="width-before-scroll-bar",yfe="with-scroll-bars-hidden",vfe="--removed-body-scroll-bar-size";function XC(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function _fe(e,t){var r=K.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var xfe=typeof window<"u"?K.useLayoutEffect:K.useEffect,VB=new WeakMap;function bfe(e,t){var r=_fe(null,function(n){return e.forEach(function(a){return XC(a,n)})});return xfe(function(){var n=VB.get(r);if(n){var a=new Set(n),l=new Set(e),h=r.current;a.forEach(function(i){l.has(i)||XC(i,null)}),l.forEach(function(i){a.has(i)||XC(i,h)})}VB.set(r,e)},[e]),r}function wfe(e){return e}function Sfe(e,t){t===void 0&&(t=wfe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(l){var h=t(l,n);return r.push(h),function(){r=r.filter(function(i){return i!==h})}},assignSyncMedium:function(l){for(n=!0;r.length;){var h=r;r=[],h.forEach(l)}r={push:function(i){return l(i)},filter:function(){return r}}},assignMedium:function(l){n=!0;var h=[];if(r.length){var i=r;r=[],i.forEach(l),h=r}var _=function(){var A=h;h=[],A.forEach(l)},w=function(){return Promise.resolve().then(_)};w(),r={push:function(A){h.push(A),w()},filter:function(A){return h=h.filter(A),r}}}};return a}function Afe(e){e===void 0&&(e={});var t=Sfe(null);return t.options=kf({async:!0,ssr:!1},e),t}var RW=function(e){var t=e.sideCar,r=OW(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return K.createElement(n,kf({},r))};RW.isSideCarExport=!0;function Tfe(e,t){return e.useMedium(t),RW}var kW=Afe(),JC=function(){},vP=K.forwardRef(function(e,t){var r=K.useRef(null),n=K.useState({onScrollCapture:JC,onWheelCapture:JC,onTouchMoveCapture:JC}),a=n[0],l=n[1],h=e.forwardProps,i=e.children,_=e.className,w=e.removeScrollBar,A=e.enabled,C=e.shards,R=e.sideCar,z=e.noIsolation,V=e.inert,U=e.allowPinchZoom,G=e.as,H=G===void 0?"div":G,J=e.gapMode,Q=OW(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),le=R,ne=bfe([r,t]),de=kf(kf({},Q),a);return K.createElement(K.Fragment,null,A&&K.createElement(le,{sideCar:kW,removeScrollBar:w,shards:C,noIsolation:z,inert:V,setCallbacks:l,allowPinchZoom:!!U,lockRef:r,gapMode:J}),h?K.cloneElement(K.Children.only(i),kf(kf({},de),{ref:ne})):K.createElement(H,kf({},de,{className:_,ref:ne}),i))});vP.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};vP.classNames={fullWidth:lA,zeroRight:sA};var Pfe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Efe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Pfe();return t&&e.setAttribute("nonce",t),e}function Cfe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Mfe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Ofe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Efe())&&(Cfe(t,r),Mfe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Rfe=function(){var e=Ofe();return function(t,r){K.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},jW=function(){var e=Rfe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},kfe={left:0,top:0,right:0,gap:0},QC=function(e){return parseInt(e||"",10)||0},jfe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[QC(r),QC(n),QC(a)]},Nfe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return kfe;var t=jfe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Ife=jW(),hx="data-scroll-locked",Dfe=function(e,t,r,n){var a=e.left,l=e.top,h=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(yfe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(hx,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(h,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(sA,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(lA,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(sA," .").concat(sA,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(lA," .").concat(lA,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(hx,`] {
    `).concat(vfe,": ").concat(i,`px;
  }
`)},UB=function(){var e=parseInt(document.body.getAttribute(hx)||"0",10);return isFinite(e)?e:0},Lfe=function(){K.useEffect(function(){return document.body.setAttribute(hx,(UB()+1).toString()),function(){var e=UB()-1;e<=0?document.body.removeAttribute(hx):document.body.setAttribute(hx,e.toString())}},[])},zfe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;Lfe();var l=K.useMemo(function(){return Nfe(a)},[a]);return K.createElement(Ife,{styles:Dfe(l,!t,a,r?"":"!important")})},Qj=!1;if(typeof window<"u")try{var R2=Object.defineProperty({},"passive",{get:function(){return Qj=!0,!0}});window.addEventListener("test",R2,R2),window.removeEventListener("test",R2,R2)}catch{Qj=!1}var $_=Qj?{passive:!1}:!1,Ffe=function(e){return e.tagName==="TEXTAREA"},NW=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Ffe(e)&&r[t]==="visible")},Bfe=function(e){return NW(e,"overflowY")},Vfe=function(e){return NW(e,"overflowX")},$B=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=IW(e,n);if(a){var l=DW(e,n),h=l[1],i=l[2];if(h>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Ufe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},$fe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},IW=function(e,t){return e==="v"?Bfe(t):Vfe(t)},DW=function(e,t){return e==="v"?Ufe(t):$fe(t)},qfe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Gfe=function(e,t,r,n,a){var l=qfe(e,window.getComputedStyle(t).direction),h=l*n,i=r.target,_=t.contains(i),w=!1,A=h>0,C=0,R=0;do{var z=DW(e,i),V=z[0],U=z[1],G=z[2],H=U-G-l*V;(V||H)&&IW(e,i)&&(C+=H,R+=V),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!_&&i!==document.body||_&&(t.contains(i)||t===i));return(A&&Math.abs(C)<1||!A&&Math.abs(R)<1)&&(w=!0),w},k2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},qB=function(e){return[e.deltaX,e.deltaY]},GB=function(e){return e&&"current"in e?e.current:e},Kfe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Wfe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Hfe=0,q_=[];function Zfe(e){var t=K.useRef([]),r=K.useRef([0,0]),n=K.useRef(),a=K.useState(Hfe++)[0],l=K.useState(jW)[0],h=K.useRef(e);K.useEffect(function(){h.current=e},[e]),K.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var U=gfe([e.lockRef.current],(e.shards||[]).map(GB),!0).filter(Boolean);return U.forEach(function(G){return G.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),U.forEach(function(G){return G.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=K.useCallback(function(U,G){if("touches"in U&&U.touches.length===2||U.type==="wheel"&&U.ctrlKey)return!h.current.allowPinchZoom;var H=k2(U),J=r.current,Q="deltaX"in U?U.deltaX:J[0]-H[0],le="deltaY"in U?U.deltaY:J[1]-H[1],ne,de=U.target,ue=Math.abs(Q)>Math.abs(le)?"h":"v";if("touches"in U&&ue==="h"&&de.type==="range")return!1;var ve=$B(ue,de);if(!ve)return!0;if(ve?ne=ue:(ne=ue==="v"?"h":"v",ve=$B(ue,de)),!ve)return!1;if(!n.current&&"changedTouches"in U&&(Q||le)&&(n.current=ne),!ne)return!0;var Ae=n.current||ne;return Gfe(Ae,G,U,Ae==="h"?Q:le)},[]),_=K.useCallback(function(U){var G=U;if(!(!q_.length||q_[q_.length-1]!==l)){var H="deltaY"in G?qB(G):k2(G),J=t.current.filter(function(ne){return ne.name===G.type&&(ne.target===G.target||G.target===ne.shadowParent)&&Kfe(ne.delta,H)})[0];if(J&&J.should){G.cancelable&&G.preventDefault();return}if(!J){var Q=(h.current.shards||[]).map(GB).filter(Boolean).filter(function(ne){return ne.contains(G.target)}),le=Q.length>0?i(G,Q[0]):!h.current.noIsolation;le&&G.cancelable&&G.preventDefault()}}},[]),w=K.useCallback(function(U,G,H,J){var Q={name:U,delta:G,target:H,should:J,shadowParent:Yfe(H)};t.current.push(Q),setTimeout(function(){t.current=t.current.filter(function(le){return le!==Q})},1)},[]),A=K.useCallback(function(U){r.current=k2(U),n.current=void 0},[]),C=K.useCallback(function(U){w(U.type,qB(U),U.target,i(U,e.lockRef.current))},[]),R=K.useCallback(function(U){w(U.type,k2(U),U.target,i(U,e.lockRef.current))},[]);K.useEffect(function(){return q_.push(l),e.setCallbacks({onScrollCapture:C,onWheelCapture:C,onTouchMoveCapture:R}),document.addEventListener("wheel",_,$_),document.addEventListener("touchmove",_,$_),document.addEventListener("touchstart",A,$_),function(){q_=q_.filter(function(U){return U!==l}),document.removeEventListener("wheel",_,$_),document.removeEventListener("touchmove",_,$_),document.removeEventListener("touchstart",A,$_)}},[]);var z=e.removeScrollBar,V=e.inert;return K.createElement(K.Fragment,null,V?K.createElement(l,{styles:Wfe(a)}):null,z?K.createElement(zfe,{gapMode:e.gapMode}):null)}function Yfe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Xfe=Tfe(kW,Zfe);var Kw=K.forwardRef(function(e,t){return K.createElement(vP,kf({},e,{ref:t,sideCar:Xfe}))});Kw.classNames=vP.classNames;var eN=["Enter"," "],Jfe=["ArrowDown","PageUp","Home"],LW=["ArrowUp","PageDown","End"],Qfe=[...Jfe,...LW],epe={ltr:[...eN,"ArrowRight"],rtl:[...eN,"ArrowLeft"]},tpe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ww="Menu",[M1,rpe,npe]=BD(Ww),[Vv,zW]=Md(Ww,[npe,qg,AW]),_P=qg(),FW=AW(),[ipe,Uv]=Vv(Ww),[ape,Hw]=Vv(Ww),BW=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:l,modal:h=!0}=e,i=_P(t),[_,w]=K.useState(null),A=K.useRef(!1),C=Eu(l),R=VD(a);return K.useEffect(()=>{const z=()=>{A.current=!0,document.addEventListener("pointerdown",V,{capture:!0,once:!0}),document.addEventListener("pointermove",V,{capture:!0,once:!0})},V=()=>A.current=!1;return document.addEventListener("keydown",z,{capture:!0}),()=>{document.removeEventListener("keydown",z,{capture:!0}),document.removeEventListener("pointerdown",V,{capture:!0}),document.removeEventListener("pointermove",V,{capture:!0})}},[]),f.jsx(fP,{...i,children:f.jsx(ipe,{scope:t,open:r,onOpenChange:C,content:_,onContentChange:w,children:f.jsx(ape,{scope:t,onClose:K.useCallback(()=>C(!1),[C]),isUsingKeyboardRef:A,dir:R,modal:h,children:n})})})};BW.displayName=Ww;var ope="MenuAnchor",XD=K.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=_P(r);return f.jsx(Gw,{...a,...n,ref:t})});XD.displayName=ope;var JD="MenuPortal",[spe,VW]=Vv(JD,{forceMount:void 0}),UW=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,l=Uv(JD,t);return f.jsx(spe,{scope:t,forceMount:r,children:f.jsx(Ru,{present:r||l.open,children:f.jsx(g0,{asChild:!0,container:a,children:n})})})};UW.displayName=JD;var Td="MenuContent",[lpe,QD]=Vv(Td),$W=K.forwardRef((e,t)=>{const r=VW(Td,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,l=Uv(Td,e.__scopeMenu),h=Hw(Td,e.__scopeMenu);return f.jsx(M1.Provider,{scope:e.__scopeMenu,children:f.jsx(Ru,{present:n||l.open,children:f.jsx(M1.Slot,{scope:e.__scopeMenu,children:h.modal?f.jsx(cpe,{...a,ref:t}):f.jsx(upe,{...a,ref:t})})})})}),cpe=K.forwardRef((e,t)=>{const r=Uv(Td,e.__scopeMenu),n=K.useRef(null),a=Xi(t,n);return K.useEffect(()=>{const l=n.current;if(l)return yP(l)},[]),f.jsx(e3,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:an(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),upe=K.forwardRef((e,t)=>{const r=Uv(Td,e.__scopeMenu);return f.jsx(e3,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),e3=K.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:h,disableOutsidePointerEvents:i,onEntryFocus:_,onEscapeKeyDown:w,onPointerDownOutside:A,onFocusOutside:C,onInteractOutside:R,onDismiss:z,disableOutsideScroll:V,...U}=e,G=Uv(Td,r),H=Hw(Td,r),J=_P(r),Q=FW(r),le=rpe(r),[ne,de]=K.useState(null),ue=K.useRef(null),ve=Xi(t,ue,G.onContentChange),Ae=K.useRef(0),Oe=K.useRef(""),Se=K.useRef(0),ke=K.useRef(null),ze=K.useRef("right"),et=K.useRef(0),je=V?Kw:K.Fragment,Ne=V?{as:Vl,allowPinchZoom:!0}:void 0,Ye=We=>{var ur,br;const Et=Oe.current+We,Je=le().filter(Wt=>!Wt.disabled),ht=document.activeElement,tt=(ur=Je.find(Wt=>Wt.ref.current===ht))==null?void 0:ur.textValue,Qt=Je.map(Wt=>Wt.textValue),gr=wpe(Qt,Et,tt),sr=(br=Je.find(Wt=>Wt.textValue===gr))==null?void 0:br.ref.current;(function Wt(Be){Oe.current=Be,window.clearTimeout(Ae.current),Be!==""&&(Ae.current=window.setTimeout(()=>Wt(""),1e3))})(Et),sr&&setTimeout(()=>sr.focus())};K.useEffect(()=>()=>window.clearTimeout(Ae.current),[]),cP();const $e=K.useCallback(We=>{var Je,ht;return ze.current===((Je=ke.current)==null?void 0:Je.side)&&Ape(We,(ht=ke.current)==null?void 0:ht.area)},[]);return f.jsx(lpe,{scope:r,searchRef:Oe,onItemEnter:K.useCallback(We=>{$e(We)&&We.preventDefault()},[$e]),onItemLeave:K.useCallback(We=>{var Et;$e(We)||((Et=ue.current)==null||Et.focus(),de(null))},[$e]),onTriggerLeave:K.useCallback(We=>{$e(We)&&We.preventDefault()},[$e]),pointerGraceTimerRef:Se,onPointerGraceIntentChange:K.useCallback(We=>{ke.current=We},[]),children:f.jsx(je,{...Ne,children:f.jsx($w,{asChild:!0,trapped:a,onMountAutoFocus:an(l,We=>{var Et;We.preventDefault(),(Et=ue.current)==null||Et.focus({preventScroll:!0})}),onUnmountAutoFocus:h,children:f.jsx(f0,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:w,onPointerDownOutside:A,onFocusOutside:C,onInteractOutside:R,onDismiss:z,children:f.jsx(dfe,{asChild:!0,...Q,dir:H.dir,orientation:"vertical",loop:n,currentTabStopId:ne,onCurrentTabStopIdChange:de,onEntryFocus:an(_,We=>{H.isUsingKeyboardRef.current||We.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(pP,{role:"menu","aria-orientation":"vertical","data-state":aH(G.open),"data-radix-menu-content":"",dir:H.dir,...J,...U,ref:ve,style:{outline:"none",...U.style},onKeyDown:an(U.onKeyDown,We=>{const Je=We.target.closest("[data-radix-menu-content]")===We.currentTarget,ht=We.ctrlKey||We.altKey||We.metaKey,tt=We.key.length===1;Je&&(We.key==="Tab"&&We.preventDefault(),!ht&&tt&&Ye(We.key));const Qt=ue.current;if(We.target!==Qt||!Qfe.includes(We.key))return;We.preventDefault();const sr=le().filter(ur=>!ur.disabled).map(ur=>ur.ref.current);LW.includes(We.key)&&sr.reverse(),xpe(sr)}),onBlur:an(e.onBlur,We=>{We.currentTarget.contains(We.target)||(window.clearTimeout(Ae.current),Oe.current="")}),onPointerMove:an(e.onPointerMove,O1(We=>{const Et=We.target,Je=et.current!==We.clientX;if(We.currentTarget.contains(Et)&&Je){const ht=We.clientX>et.current?"right":"left";ze.current=ht,et.current=We.clientX}}))})})})})})})});$W.displayName=Td;var dpe="MenuGroup",t3=K.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return f.jsx(mi.div,{role:"group",...n,ref:t})});t3.displayName=dpe;var hpe="MenuLabel",qW=K.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return f.jsx(mi.div,{...n,ref:t})});qW.displayName=hpe;var MA="MenuItem",KB="menu.itemSelect",xP=K.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,l=K.useRef(null),h=Hw(MA,e.__scopeMenu),i=QD(MA,e.__scopeMenu),_=Xi(t,l),w=K.useRef(!1),A=()=>{const C=l.current;if(!r&&C){const R=new CustomEvent(KB,{bubbles:!0,cancelable:!0});C.addEventListener(KB,z=>n==null?void 0:n(z),{once:!0}),QK(C,R),R.defaultPrevented?w.current=!1:h.onClose()}};return f.jsx(GW,{...a,ref:_,disabled:r,onClick:an(e.onClick,A),onPointerDown:C=>{var R;(R=e.onPointerDown)==null||R.call(e,C),w.current=!0},onPointerUp:an(e.onPointerUp,C=>{var R;w.current||(R=C.currentTarget)==null||R.click()}),onKeyDown:an(e.onKeyDown,C=>{const R=i.searchRef.current!=="";r||R&&C.key===" "||eN.includes(C.key)&&(C.currentTarget.click(),C.preventDefault())})})});xP.displayName=MA;var GW=K.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...l}=e,h=QD(MA,r),i=FW(r),_=K.useRef(null),w=Xi(t,_),[A,C]=K.useState(!1),[R,z]=K.useState("");return K.useEffect(()=>{const V=_.current;V&&z((V.textContent??"").trim())},[l.children]),f.jsx(M1.ItemSlot,{scope:r,disabled:n,textValue:a??R,children:f.jsx(hfe,{asChild:!0,...i,focusable:!n,children:f.jsx(mi.div,{role:"menuitem","data-highlighted":A?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...l,ref:w,onPointerMove:an(e.onPointerMove,O1(V=>{n?h.onItemLeave(V):(h.onItemEnter(V),V.defaultPrevented||V.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:an(e.onPointerLeave,O1(V=>h.onItemLeave(V))),onFocus:an(e.onFocus,()=>C(!0)),onBlur:an(e.onBlur,()=>C(!1))})})})}),fpe="MenuCheckboxItem",KW=K.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return f.jsx(XW,{scope:e.__scopeMenu,checked:r,children:f.jsx(xP,{role:"menuitemcheckbox","aria-checked":OA(r)?"mixed":r,...a,ref:t,"data-state":n3(r),onSelect:an(a.onSelect,()=>n==null?void 0:n(OA(r)?!0:!r),{checkForDefaultPrevented:!1})})})});KW.displayName=fpe;var WW="MenuRadioGroup",[ppe,mpe]=Vv(WW,{value:void 0,onValueChange:()=>{}}),HW=K.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,l=Eu(n);return f.jsx(ppe,{scope:e.__scopeMenu,value:r,onValueChange:l,children:f.jsx(t3,{...a,ref:t})})});HW.displayName=WW;var ZW="MenuRadioItem",YW=K.forwardRef((e,t)=>{const{value:r,...n}=e,a=mpe(ZW,e.__scopeMenu),l=r===a.value;return f.jsx(XW,{scope:e.__scopeMenu,checked:l,children:f.jsx(xP,{role:"menuitemradio","aria-checked":l,...n,ref:t,"data-state":n3(l),onSelect:an(n.onSelect,()=>{var h;return(h=a.onValueChange)==null?void 0:h.call(a,r)},{checkForDefaultPrevented:!1})})})});YW.displayName=ZW;var r3="MenuItemIndicator",[XW,gpe]=Vv(r3,{checked:!1}),JW=K.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,l=gpe(r3,r);return f.jsx(Ru,{present:n||OA(l.checked)||l.checked===!0,children:f.jsx(mi.span,{...a,ref:t,"data-state":n3(l.checked)})})});JW.displayName=r3;var ype="MenuSeparator",QW=K.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return f.jsx(mi.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});QW.displayName=ype;var vpe="MenuArrow",eH=K.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=_P(r);return f.jsx(mP,{...a,...n,ref:t})});eH.displayName=vpe;var _pe="MenuSub",[E6e,tH]=Vv(_pe),Zb="MenuSubTrigger",rH=K.forwardRef((e,t)=>{const r=Uv(Zb,e.__scopeMenu),n=Hw(Zb,e.__scopeMenu),a=tH(Zb,e.__scopeMenu),l=QD(Zb,e.__scopeMenu),h=K.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:_}=l,w={__scopeMenu:e.__scopeMenu},A=K.useCallback(()=>{h.current&&window.clearTimeout(h.current),h.current=null},[]);return K.useEffect(()=>A,[A]),K.useEffect(()=>{const C=i.current;return()=>{window.clearTimeout(C),_(null)}},[i,_]),f.jsx(XD,{asChild:!0,...w,children:f.jsx(GW,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":aH(r.open),...e,ref:lP(t,a.onTriggerChange),onClick:C=>{var R;(R=e.onClick)==null||R.call(e,C),!(e.disabled||C.defaultPrevented)&&(C.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:an(e.onPointerMove,O1(C=>{l.onItemEnter(C),!C.defaultPrevented&&!e.disabled&&!r.open&&!h.current&&(l.onPointerGraceIntentChange(null),h.current=window.setTimeout(()=>{r.onOpenChange(!0),A()},100))})),onPointerLeave:an(e.onPointerLeave,O1(C=>{var z,V;A();const R=(z=r.content)==null?void 0:z.getBoundingClientRect();if(R){const U=(V=r.content)==null?void 0:V.dataset.side,G=U==="right",H=G?-5:5,J=R[G?"left":"right"],Q=R[G?"right":"left"];l.onPointerGraceIntentChange({area:[{x:C.clientX+H,y:C.clientY},{x:J,y:R.top},{x:Q,y:R.top},{x:Q,y:R.bottom},{x:J,y:R.bottom}],side:U}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(C),C.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:an(e.onKeyDown,C=>{var z;const R=l.searchRef.current!=="";e.disabled||R&&C.key===" "||epe[n.dir].includes(C.key)&&(r.onOpenChange(!0),(z=r.content)==null||z.focus(),C.preventDefault())})})})});rH.displayName=Zb;var nH="MenuSubContent",iH=K.forwardRef((e,t)=>{const r=VW(Td,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,l=Uv(Td,e.__scopeMenu),h=Hw(Td,e.__scopeMenu),i=tH(nH,e.__scopeMenu),_=K.useRef(null),w=Xi(t,_);return f.jsx(M1.Provider,{scope:e.__scopeMenu,children:f.jsx(Ru,{present:n||l.open,children:f.jsx(M1.Slot,{scope:e.__scopeMenu,children:f.jsx(e3,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:w,align:"start",side:h.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:A=>{var C;h.isUsingKeyboardRef.current&&((C=_.current)==null||C.focus()),A.preventDefault()},onCloseAutoFocus:A=>A.preventDefault(),onFocusOutside:an(e.onFocusOutside,A=>{A.target!==i.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:an(e.onEscapeKeyDown,A=>{h.onClose(),A.preventDefault()}),onKeyDown:an(e.onKeyDown,A=>{var z;const C=A.currentTarget.contains(A.target),R=tpe[h.dir].includes(A.key);C&&R&&(l.onOpenChange(!1),(z=i.trigger)==null||z.focus(),A.preventDefault())})})})})})});iH.displayName=nH;function aH(e){return e?"open":"closed"}function OA(e){return e==="indeterminate"}function n3(e){return OA(e)?"indeterminate":e?"checked":"unchecked"}function xpe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function bpe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function wpe(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let h=bpe(e,Math.max(l,0));a.length===1&&(h=h.filter(w=>w!==r));const _=h.find(w=>w.toLowerCase().startsWith(a.toLowerCase()));return _!==r?_:void 0}function Spe(e,t){const{x:r,y:n}=e;let a=!1;for(let l=0,h=t.length-1;l<t.length;h=l++){const i=t[l].x,_=t[l].y,w=t[h].x,A=t[h].y;_>n!=A>n&&r<(w-i)*(n-_)/(A-_)+i&&(a=!a)}return a}function Ape(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Spe(r,t)}function O1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Tpe=BW,Ppe=XD,Epe=UW,Cpe=$W,Mpe=t3,Ope=qW,Rpe=xP,kpe=KW,jpe=HW,Npe=YW,Ipe=JW,Dpe=QW,Lpe=eH,zpe=rH,Fpe=iH,i3="DropdownMenu",[Bpe,C6e]=Md(i3,[zW]),uc=zW(),[Vpe,oH]=Bpe(i3),sH=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:l,onOpenChange:h,modal:i=!0}=e,_=uc(t),w=K.useRef(null),[A=!1,C]=kg({prop:a,defaultProp:l,onChange:h});return f.jsx(Vpe,{scope:t,triggerId:Ad(),triggerRef:w,contentId:Ad(),open:A,onOpenChange:C,onOpenToggle:K.useCallback(()=>C(R=>!R),[C]),modal:i,children:f.jsx(Tpe,{..._,open:A,onOpenChange:C,dir:n,modal:i,children:r})})};sH.displayName=i3;var lH="DropdownMenuTrigger",a3=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,l=oH(lH,r),h=uc(r);return f.jsx(Ppe,{asChild:!0,...h,children:f.jsx(mi.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:lP(t,l.triggerRef),onPointerDown:an(e.onPointerDown,i=>{!n&&i.button===0&&i.ctrlKey===!1&&(l.onOpenToggle(),l.open||i.preventDefault())}),onKeyDown:an(e.onKeyDown,i=>{n||(["Enter"," "].includes(i.key)&&l.onOpenToggle(),i.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});a3.displayName=lH;var Upe="DropdownMenuPortal",cH=e=>{const{__scopeDropdownMenu:t,...r}=e,n=uc(t);return f.jsx(Epe,{...n,...r})};cH.displayName=Upe;var uH="DropdownMenuContent",dH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=oH(uH,r),l=uc(r),h=K.useRef(!1);return f.jsx(Cpe,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...n,ref:t,onCloseAutoFocus:an(e.onCloseAutoFocus,i=>{var _;h.current||(_=a.triggerRef.current)==null||_.focus(),h.current=!1,i.preventDefault()}),onInteractOutside:an(e.onInteractOutside,i=>{const _=i.detail.originalEvent,w=_.button===0&&_.ctrlKey===!0,A=_.button===2||w;(!a.modal||A)&&(h.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dH.displayName=uH;var $pe="DropdownMenuGroup",hH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Mpe,{...a,...n,ref:t})});hH.displayName=$pe;var qpe="DropdownMenuLabel",fH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Ope,{...a,...n,ref:t})});fH.displayName=qpe;var Gpe="DropdownMenuItem",pH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Rpe,{...a,...n,ref:t})});pH.displayName=Gpe;var Kpe="DropdownMenuCheckboxItem",mH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(kpe,{...a,...n,ref:t})});mH.displayName=Kpe;var Wpe="DropdownMenuRadioGroup",Hpe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(jpe,{...a,...n,ref:t})});Hpe.displayName=Wpe;var Zpe="DropdownMenuRadioItem",gH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Npe,{...a,...n,ref:t})});gH.displayName=Zpe;var Ype="DropdownMenuItemIndicator",yH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Ipe,{...a,...n,ref:t})});yH.displayName=Ype;var Xpe="DropdownMenuSeparator",vH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Dpe,{...a,...n,ref:t})});vH.displayName=Xpe;var Jpe="DropdownMenuArrow",Qpe=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Lpe,{...a,...n,ref:t})});Qpe.displayName=Jpe;var eme="DropdownMenuSubTrigger",_H=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(zpe,{...a,...n,ref:t})});_H.displayName=eme;var tme="DropdownMenuSubContent",xH=K.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=uc(r);return f.jsx(Fpe,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});xH.displayName=tme;var rme=sH,nme=a3,ime=cH,bH=dH,ame=hH,wH=fH,SH=pH,AH=mH,TH=gH,PH=yH,EH=vH,CH=_H,MH=xH;const Cu=rme,Pd=nme,ome=ame,sme=K.forwardRef(({className:e,inset:t,children:r,...n},a)=>f.jsxs(CH,{ref:a,className:Gt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n,children:[r,f.jsx(vx,{className:"ml-auto"})]}));sme.displayName=CH.displayName;const lme=K.forwardRef(({className:e,...t},r)=>f.jsx(MH,{ref:r,className:Gt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));lme.displayName=MH.displayName;const Fc=K.forwardRef(({className:e,sideOffset:t=4,...r},n)=>f.jsx(ime,{children:f.jsx(bH,{ref:n,sideOffset:t,className:Gt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md scrollbar-transparent","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Fc.displayName=bH.displayName;const Ea=K.forwardRef(({className:e,inset:t,...r},n)=>f.jsx(SH,{ref:n,className:Gt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",t&&"pl-8",e),...r}));Ea.displayName=SH.displayName;const OH=K.forwardRef(({className:e,children:t,checked:r,...n},a)=>f.jsxs(AH,{ref:a,className:Gt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[f.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:f.jsx(PH,{children:f.jsx(UK,{className:"h-4 w-4"})})}),t]}));OH.displayName=AH.displayName;const cme=K.forwardRef(({className:e,children:t,...r},n)=>f.jsxs(TH,{ref:n,className:Gt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[f.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:f.jsx(PH,{children:f.jsx(yue,{className:"h-2 w-2 fill-current"})})}),t]}));cme.displayName=TH.displayName;const Gg=K.forwardRef(({className:e,inset:t,...r},n)=>f.jsx(wH,{ref:n,className:Gt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Gg.displayName=wH.displayName;const Lh=K.forwardRef(({className:e,...t},r)=>f.jsx(EH,{ref:r,className:Gt("-mx-1 my-1 h-px bg-muted",e),...t}));Lh.displayName=EH.displayName;const RH=K.createContext({theme:"system",setTheme:()=>null});function ume({children:e,defaultTheme:t="system",storageKey:r="vite-ui-theme",...n}){const[a,l]=K.useState(()=>localStorage.getItem(r)||t);K.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),a==="system"){const _=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(_);return}i.classList.add(a)},[a]);const h={theme:a,setTheme:i=>{localStorage.setItem(r,i),l(i)}};return f.jsx(RH.Provider,{...n,value:h,children:e})}const dme=()=>{const e=K.useContext(RH);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};function kH(){const{theme:e,setTheme:t}=dme();return f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"outline",size:"icon",children:[f.jsx(SB,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),f.jsx(wB,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),f.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),f.jsxs(Fc,{align:"end",children:[f.jsxs(Ea,{className:e==="light"&&" border-2 border-primary",onClick:()=>t("light"),children:[f.jsx(SB,{className:"mr-2 h-4 w-4"}),"Light"]}),f.jsxs(Ea,{className:e==="dark"&&" border-2 border-primary",onClick:()=>t("dark"),children:[f.jsx(wB,{className:"mr-2 h-4 w-4"}),"Dark"]}),f.jsxs(Ea,{className:e==="system"&&" border-2 border-primary",onClick:()=>t("system"),children:[f.jsx(bue,{className:"mr-2 h-4 w-4"}),"System"]})]})]})}const hme=()=>{const[e,t]=K.useState(!1);return K.useEffect(()=>{const r=()=>{t(window.scrollY>0)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]),f.jsxs("header",{className:`h-[60px] w-full flex justify-between top-0 left-0 fixed z-50 transition-all duration-300 px-5 lg:px-32 ${e?"bg-primary shadow-md":""}`,children:[f.jsxs("div",{className:"h-full flex items-center gap-2 text-secondary-foreground text-sm font-medium ",children:[f.jsx("img",{src:RK,alt:"",className:"size-10 "}),"Land Transportation Office"]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(kH,{})})]})},fme=()=>f.jsxs(f.Fragment,{children:[f.jsx(hme,{}),f.jsx(kD,{})]}),Fn=K.forwardRef(({className:e,type:t,...r},n)=>f.jsx("input",{type:t,className:Gt("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Fn.displayName="Input";var pme="Label",jH=K.forwardRef((e,t)=>f.jsx(mi.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));jH.displayName=pme;var NH=jH;const mme=u0("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ha=K.forwardRef(({className:e,...t},r)=>f.jsx(NH,{ref:r,className:Gt(mme(),e),...t}));ha.displayName=NH.displayName;var Zw=e=>e.type==="checkbox",cv=e=>e instanceof Date,nc=e=>e==null;const IH=e=>typeof e=="object";var ts=e=>!nc(e)&&!Array.isArray(e)&&IH(e)&&!cv(e),DH=e=>ts(e)&&e.target?Zw(e.target)?e.target.checked:e.target.value:e,gme=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,LH=(e,t)=>e.has(gme(t)),yme=e=>{const t=e.constructor&&e.constructor.prototype;return ts(t)&&t.hasOwnProperty("isPrototypeOf")},o3=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Rc(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(o3&&(e instanceof Blob||n))&&(r||ts(e)))if(t=r?[]:{},!r&&!yme(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=Rc(e[a]));else return e;return t}var bP=e=>Array.isArray(e)?e.filter(Boolean):[],Jo=e=>e===void 0,qr=(e,t,r)=>{if(!t||!ts(e))return r;const n=bP(t.split(/[,[\].]+?/)).reduce((a,l)=>nc(a)?a:a[l],e);return Jo(n)||n===e?Jo(e[t])?r:e[t]:n},xd=e=>typeof e=="boolean",s3=e=>/^\w*$/.test(e),zH=e=>bP(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ba=(e,t,r)=>{let n=-1;const a=s3(t)?[t]:zH(t),l=a.length,h=l-1;for(;++n<l;){const i=a[n];let _=r;if(n!==h){const w=e[i];_=ts(w)||Array.isArray(w)?w:isNaN(+a[n+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;e[i]=_,e=e[i]}return e};const RA={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Th={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},$p={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},FH=Pe.createContext(null),wP=()=>Pe.useContext(FH),vme=e=>{const{children:t,...r}=e;return Pe.createElement(FH.Provider,{value:r},t)};var BH=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(a,l,{get:()=>{const h=l;return t._proxyFormState[h]!==Th.all&&(t._proxyFormState[h]=!n||Th.all),r&&(r[h]=!0),e[h]}});return a},kc=e=>ts(e)&&!Object.keys(e).length,VH=(e,t,r,n)=>{r(e);const{name:a,...l}=e;return kc(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(h=>t[h]===(!n||Th.all))},a1=e=>Array.isArray(e)?e:[e],UH=(e,t,r)=>!e||!t||e===t||a1(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function l3(e){const t=Pe.useRef(e);t.current=e,Pe.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function _me(e){const t=wP(),{control:r=t.control,disabled:n,name:a,exact:l}=e||{},[h,i]=Pe.useState(r._formState),_=Pe.useRef(!0),w=Pe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),A=Pe.useRef(a);return A.current=a,l3({disabled:n,next:C=>_.current&&UH(A.current,C.name,l)&&VH(C,w.current,r._updateFormState)&&i({...r._formState,...C}),subject:r._subjects.state}),Pe.useEffect(()=>(_.current=!0,w.current.isValid&&r._updateValid(!0),()=>{_.current=!1}),[r]),Pe.useMemo(()=>BH(h,r,w.current,!1),[h,r])}var Nf=e=>typeof e=="string",$H=(e,t,r,n,a)=>Nf(e)?(n&&t.watch.add(e),qr(r,e,a)):Array.isArray(e)?e.map(l=>(n&&t.watch.add(l),qr(r,l))):(n&&(t.watchAll=!0),r);function qH(e){const t=wP(),{control:r=t.control,name:n,defaultValue:a,disabled:l,exact:h}=e||{},i=Pe.useRef(n);i.current=n,l3({disabled:l,subject:r._subjects.values,next:A=>{UH(i.current,A.name,h)&&w(Rc($H(i.current,r._names,A.values||r._formValues,!1,a)))}});const[_,w]=Pe.useState(r._getWatch(n,a));return Pe.useEffect(()=>r._removeUnmounted()),_}function xme(e){const t=wP(),{name:r,disabled:n,control:a=t.control,shouldUnregister:l}=e,h=LH(a._names.array,r),i=qH({control:a,name:r,defaultValue:qr(a._formValues,r,qr(a._defaultValues,r,e.defaultValue)),exact:!0}),_=_me({control:a,name:r,exact:!0}),w=Pe.useRef(a.register(r,{...e.rules,value:i,...xd(e.disabled)?{disabled:e.disabled}:{}})),A=Pe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!qr(_.errors,r)},isDirty:{enumerable:!0,get:()=>!!qr(_.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!qr(_.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!qr(_.validatingFields,r)},error:{enumerable:!0,get:()=>qr(_.errors,r)}}),[_,r]),C=Pe.useMemo(()=>({name:r,value:i,...xd(n)||_.disabled?{disabled:_.disabled||n}:{},onChange:R=>w.current.onChange({target:{value:DH(R),name:r},type:RA.CHANGE}),onBlur:()=>w.current.onBlur({target:{value:qr(a._formValues,r),name:r},type:RA.BLUR}),ref:R=>{const z=qr(a._fields,r);z&&R&&(z._f.ref={focus:()=>R.focus(),select:()=>R.select(),setCustomValidity:V=>R.setCustomValidity(V),reportValidity:()=>R.reportValidity()})}}),[r,a._formValues,n,_.disabled,i,a._fields]);return Pe.useEffect(()=>{const R=a._options.shouldUnregister||l,z=(V,U)=>{const G=qr(a._fields,V);G&&G._f&&(G._f.mount=U)};if(z(r,!0),R){const V=Rc(qr(a._options.defaultValues,r));ba(a._defaultValues,r,V),Jo(qr(a._formValues,r))&&ba(a._formValues,r,V)}return!h&&a.register(r),()=>{(h?R&&!a._state.action:R)?a.unregister(r):z(r,!1)}},[r,a,h,l]),Pe.useEffect(()=>{a._updateDisabledField({disabled:n,fields:a._fields,name:r})},[n,r,a]),Pe.useMemo(()=>({field:C,formState:_,fieldState:A}),[C,_,A])}const bme=e=>e.render(xme(e));var GH=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},WB=e=>({isOnSubmit:!e||e===Th.onSubmit,isOnBlur:e===Th.onBlur,isOnChange:e===Th.onChange,isOnAll:e===Th.all,isOnTouch:e===Th.onTouched}),HB=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const o1=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const l=qr(e,a);if(l){const{_f:h,...i}=l;if(h){if(h.refs&&h.refs[0]&&t(h.refs[0],a)&&!n)return!0;if(h.ref&&t(h.ref,h.name)&&!n)return!0;if(o1(i,t))break}else if(ts(i)&&o1(i,t))break}}};var wme=(e,t,r)=>{const n=a1(qr(e,r));return ba(n,"root",t[r]),ba(e,r,n),e},c3=e=>e.type==="file",jf=e=>typeof e=="function",kA=e=>{if(!o3)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},cA=e=>Nf(e),u3=e=>e.type==="radio",jA=e=>e instanceof RegExp;const ZB={value:!1,isValid:!1},YB={value:!0,isValid:!0};var KH=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Jo(e[0].attributes.value)?Jo(e[0].value)||e[0].value===""?YB:{value:e[0].value,isValid:!0}:YB:ZB}return ZB};const XB={isValid:!1,value:null};var WH=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,XB):XB;function JB(e,t,r="validate"){if(cA(e)||Array.isArray(e)&&e.every(cA)||xd(e)&&!e)return{type:r,message:cA(e)?e:"",ref:t}}var G_=e=>ts(e)&&!jA(e)?e:{value:e,message:""},QB=async(e,t,r,n,a,l)=>{const{ref:h,refs:i,required:_,maxLength:w,minLength:A,min:C,max:R,pattern:z,validate:V,name:U,valueAsNumber:G,mount:H}=e._f,J=qr(r,U);if(!H||t.has(U))return{};const Q=i?i[0]:h,le=ke=>{a&&Q.reportValidity&&(Q.setCustomValidity(xd(ke)?"":ke||""),Q.reportValidity())},ne={},de=u3(h),ue=Zw(h),ve=de||ue,Ae=(G||c3(h))&&Jo(h.value)&&Jo(J)||kA(h)&&h.value===""||J===""||Array.isArray(J)&&!J.length,Oe=GH.bind(null,U,n,ne),Se=(ke,ze,et,je=$p.maxLength,Ne=$p.minLength)=>{const Ye=ke?ze:et;ne[U]={type:ke?je:Ne,message:Ye,ref:h,...Oe(ke?je:Ne,Ye)}};if(l?!Array.isArray(J)||!J.length:_&&(!ve&&(Ae||nc(J))||xd(J)&&!J||ue&&!KH(i).isValid||de&&!WH(i).isValid)){const{value:ke,message:ze}=cA(_)?{value:!!_,message:_}:G_(_);if(ke&&(ne[U]={type:$p.required,message:ze,ref:Q,...Oe($p.required,ze)},!n))return le(ze),ne}if(!Ae&&(!nc(C)||!nc(R))){let ke,ze;const et=G_(R),je=G_(C);if(!nc(J)&&!isNaN(J)){const Ne=h.valueAsNumber||J&&+J;nc(et.value)||(ke=Ne>et.value),nc(je.value)||(ze=Ne<je.value)}else{const Ne=h.valueAsDate||new Date(J),Ye=Et=>new Date(new Date().toDateString()+" "+Et),$e=h.type=="time",We=h.type=="week";Nf(et.value)&&J&&(ke=$e?Ye(J)>Ye(et.value):We?J>et.value:Ne>new Date(et.value)),Nf(je.value)&&J&&(ze=$e?Ye(J)<Ye(je.value):We?J<je.value:Ne<new Date(je.value))}if((ke||ze)&&(Se(!!ke,et.message,je.message,$p.max,$p.min),!n))return le(ne[U].message),ne}if((w||A)&&!Ae&&(Nf(J)||l&&Array.isArray(J))){const ke=G_(w),ze=G_(A),et=!nc(ke.value)&&J.length>+ke.value,je=!nc(ze.value)&&J.length<+ze.value;if((et||je)&&(Se(et,ke.message,ze.message),!n))return le(ne[U].message),ne}if(z&&!Ae&&Nf(J)){const{value:ke,message:ze}=G_(z);if(jA(ke)&&!J.match(ke)&&(ne[U]={type:$p.pattern,message:ze,ref:h,...Oe($p.pattern,ze)},!n))return le(ze),ne}if(V){if(jf(V)){const ke=await V(J,r),ze=JB(ke,Q);if(ze&&(ne[U]={...ze,...Oe($p.validate,ze.message)},!n))return le(ze.message),ne}else if(ts(V)){let ke={};for(const ze in V){if(!kc(ke)&&!n)break;const et=JB(await V[ze](J,r),Q,ze);et&&(ke={...et,...Oe(ze,et.message)},le(et.message),n&&(ne[U]=ke))}if(!kc(ke)&&(ne[U]={ref:Q,...ke},!n))return ne}}return le(!0),ne};function Sme(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=Jo(e)?n++:e[t[n++]];return e}function Ame(e){for(const t in e)if(e.hasOwnProperty(t)&&!Jo(e[t]))return!1;return!0}function ks(e,t){const r=Array.isArray(t)?t:s3(t)?[t]:zH(t),n=r.length===1?e:Sme(e,r),a=r.length-1,l=r[a];return n&&delete n[l],a!==0&&(ts(n)&&kc(n)||Array.isArray(n)&&Ame(n))&&ks(e,r.slice(0,-1)),e}var eM=()=>{let e=[];return{get observers(){return e},next:a=>{for(const l of e)l.next&&l.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(l=>l!==a)}}),unsubscribe:()=>{e=[]}}},tN=e=>nc(e)||!IH(e);function Ag(e,t){if(tN(e)||tN(t))return e===t;if(cv(e)&&cv(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r){const l=e[a];if(!n.includes(a))return!1;if(a!=="ref"){const h=t[a];if(cv(l)&&cv(h)||ts(l)&&ts(h)||Array.isArray(l)&&Array.isArray(h)?!Ag(l,h):l!==h)return!1}}return!0}var HH=e=>e.type==="select-multiple",Tme=e=>u3(e)||Zw(e),tM=e=>kA(e)&&e.isConnected,ZH=e=>{for(const t in e)if(jf(e[t]))return!0;return!1};function NA(e,t={}){const r=Array.isArray(e);if(ts(e)||r)for(const n in e)Array.isArray(e[n])||ts(e[n])&&!ZH(e[n])?(t[n]=Array.isArray(e[n])?[]:{},NA(e[n],t[n])):nc(e[n])||(t[n]=!0);return t}function YH(e,t,r){const n=Array.isArray(e);if(ts(e)||n)for(const a in e)Array.isArray(e[a])||ts(e[a])&&!ZH(e[a])?Jo(t)||tN(r[a])?r[a]=Array.isArray(e[a])?NA(e[a],[]):{...NA(e[a])}:YH(e[a],nc(t)?{}:t[a],r[a]):r[a]=!Ag(e[a],t[a]);return r}var jb=(e,t)=>YH(e,t,NA(t)),XH=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>Jo(e)?e:t?e===""?NaN:e&&+e:r&&Nf(e)?new Date(e):n?n(e):e;function rM(e){const t=e.ref;return c3(t)?t.files:u3(t)?WH(e.refs).value:HH(t)?[...t.selectedOptions].map(({value:r})=>r):Zw(t)?KH(e.refs).value:XH(Jo(t.value)?e.ref.value:t.value,e)}var Pme=(e,t,r,n)=>{const a={};for(const l of e){const h=qr(t,l);h&&ba(a,l,h._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},Nb=e=>Jo(e)?e:jA(e)?e.source:ts(e)?jA(e.value)?e.value.source:e.value:e;const eV="AsyncFunction";var Eme=e=>!!e&&!!e.validate&&!!(jf(e.validate)&&e.validate.constructor.name===eV||ts(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===eV)),Cme=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function tV(e,t,r){const n=qr(e,r);if(n||s3(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const l=a.join("."),h=qr(t,l),i=qr(e,l);if(h&&!Array.isArray(h)&&r!==l)return{name:r};if(i&&i.type)return{name:l,error:i};a.pop()}return{name:r}}var Mme=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,Ome=(e,t)=>!bP(qr(e,t)).length&&ks(e,t);const Rme={mode:Th.onSubmit,reValidateMode:Th.onChange,shouldFocusError:!0};function kme(e={}){let t={...Rme,...e},r={submitCount:0,isDirty:!1,isLoading:jf(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=ts(t.defaultValues)||ts(t.values)?Rc(t.defaultValues||t.values)||{}:{},l=t.shouldUnregister?{}:Rc(a),h={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},_,w=0;const A={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},C={values:eM(),array:eM(),state:eM()},R=WB(t.mode),z=WB(t.reValidateMode),V=t.criteriaMode===Th.all,U=rt=>Ot=>{clearTimeout(w),w=setTimeout(rt,Ot)},G=async rt=>{if(!t.disabled&&(A.isValid||rt)){const Ot=t.resolver?kc((await ve()).errors):await Oe(n,!0);Ot!==r.isValid&&C.state.next({isValid:Ot})}},H=(rt,Ot)=>{!t.disabled&&(A.isValidating||A.validatingFields)&&((rt||Array.from(i.mount)).forEach(Kt=>{Kt&&(Ot?ba(r.validatingFields,Kt,Ot):ks(r.validatingFields,Kt))}),C.state.next({validatingFields:r.validatingFields,isValidating:!kc(r.validatingFields)}))},J=(rt,Ot=[],Kt,Pr,yr=!0,wr=!0)=>{if(Pr&&Kt&&!t.disabled){if(h.action=!0,wr&&Array.isArray(qr(n,rt))){const dr=Kt(qr(n,rt),Pr.argA,Pr.argB);yr&&ba(n,rt,dr)}if(wr&&Array.isArray(qr(r.errors,rt))){const dr=Kt(qr(r.errors,rt),Pr.argA,Pr.argB);yr&&ba(r.errors,rt,dr),Ome(r.errors,rt)}if(A.touchedFields&&wr&&Array.isArray(qr(r.touchedFields,rt))){const dr=Kt(qr(r.touchedFields,rt),Pr.argA,Pr.argB);yr&&ba(r.touchedFields,rt,dr)}A.dirtyFields&&(r.dirtyFields=jb(a,l)),C.state.next({name:rt,isDirty:ke(rt,Ot),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ba(l,rt,Ot)},Q=(rt,Ot)=>{ba(r.errors,rt,Ot),C.state.next({errors:r.errors})},le=rt=>{r.errors=rt,C.state.next({errors:r.errors,isValid:!1})},ne=(rt,Ot,Kt,Pr)=>{const yr=qr(n,rt);if(yr){const wr=qr(l,rt,Jo(Kt)?qr(a,rt):Kt);Jo(wr)||Pr&&Pr.defaultChecked||Ot?ba(l,rt,Ot?wr:rM(yr._f)):je(rt,wr),h.mount&&G()}},de=(rt,Ot,Kt,Pr,yr)=>{let wr=!1,dr=!1;const An={name:rt};if(!t.disabled){const Ti=!!(qr(n,rt)&&qr(n,rt)._f&&qr(n,rt)._f.disabled);if(!Kt||Pr){A.isDirty&&(dr=r.isDirty,r.isDirty=An.isDirty=ke(),wr=dr!==An.isDirty);const Bi=Ti||Ag(qr(a,rt),Ot);dr=!!(!Ti&&qr(r.dirtyFields,rt)),Bi||Ti?ks(r.dirtyFields,rt):ba(r.dirtyFields,rt,!0),An.dirtyFields=r.dirtyFields,wr=wr||A.dirtyFields&&dr!==!Bi}if(Kt){const Bi=qr(r.touchedFields,rt);Bi||(ba(r.touchedFields,rt,Kt),An.touchedFields=r.touchedFields,wr=wr||A.touchedFields&&Bi!==Kt)}wr&&yr&&C.state.next(An)}return wr?An:{}},ue=(rt,Ot,Kt,Pr)=>{const yr=qr(r.errors,rt),wr=A.isValid&&xd(Ot)&&r.isValid!==Ot;if(t.delayError&&Kt?(_=U(()=>Q(rt,Kt)),_(t.delayError)):(clearTimeout(w),_=null,Kt?ba(r.errors,rt,Kt):ks(r.errors,rt)),(Kt?!Ag(yr,Kt):yr)||!kc(Pr)||wr){const dr={...Pr,...wr&&xd(Ot)?{isValid:Ot}:{},errors:r.errors,name:rt};r={...r,...dr},C.state.next(dr)}},ve=async rt=>{H(rt,!0);const Ot=await t.resolver(l,t.context,Pme(rt||i.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return H(rt),Ot},Ae=async rt=>{const{errors:Ot}=await ve(rt);if(rt)for(const Kt of rt){const Pr=qr(Ot,Kt);Pr?ba(r.errors,Kt,Pr):ks(r.errors,Kt)}else r.errors=Ot;return Ot},Oe=async(rt,Ot,Kt={valid:!0})=>{for(const Pr in rt){const yr=rt[Pr];if(yr){const{_f:wr,...dr}=yr;if(wr){const An=i.array.has(wr.name),Ti=yr._f&&Eme(yr._f);Ti&&A.validatingFields&&H([Pr],!0);const Bi=await QB(yr,i.disabled,l,V,t.shouldUseNativeValidation&&!Ot,An);if(Ti&&A.validatingFields&&H([Pr]),Bi[wr.name]&&(Kt.valid=!1,Ot))break;!Ot&&(qr(Bi,wr.name)?An?wme(r.errors,Bi,wr.name):ba(r.errors,wr.name,Bi[wr.name]):ks(r.errors,wr.name))}!kc(dr)&&await Oe(dr,Ot,Kt)}}return Kt.valid},Se=()=>{for(const rt of i.unMount){const Ot=qr(n,rt);Ot&&(Ot._f.refs?Ot._f.refs.every(Kt=>!tM(Kt)):!tM(Ot._f.ref))&&sr(rt)}i.unMount=new Set},ke=(rt,Ot)=>!t.disabled&&(rt&&Ot&&ba(l,rt,Ot),!Ag(Je(),a)),ze=(rt,Ot,Kt)=>$H(rt,i,{...h.mount?l:Jo(Ot)?a:Nf(rt)?{[rt]:Ot}:Ot},Kt,Ot),et=rt=>bP(qr(h.mount?l:a,rt,t.shouldUnregister?qr(a,rt,[]):[])),je=(rt,Ot,Kt={})=>{const Pr=qr(n,rt);let yr=Ot;if(Pr){const wr=Pr._f;wr&&(!wr.disabled&&ba(l,rt,XH(Ot,wr)),yr=kA(wr.ref)&&nc(Ot)?"":Ot,HH(wr.ref)?[...wr.ref.options].forEach(dr=>dr.selected=yr.includes(dr.value)):wr.refs?Zw(wr.ref)?wr.refs.length>1?wr.refs.forEach(dr=>(!dr.defaultChecked||!dr.disabled)&&(dr.checked=Array.isArray(yr)?!!yr.find(An=>An===dr.value):yr===dr.value)):wr.refs[0]&&(wr.refs[0].checked=!!yr):wr.refs.forEach(dr=>dr.checked=dr.value===yr):c3(wr.ref)?wr.ref.value="":(wr.ref.value=yr,wr.ref.type||C.values.next({name:rt,values:{...l}})))}(Kt.shouldDirty||Kt.shouldTouch)&&de(rt,yr,Kt.shouldTouch,Kt.shouldDirty,!0),Kt.shouldValidate&&Et(rt)},Ne=(rt,Ot,Kt)=>{for(const Pr in Ot){const yr=Ot[Pr],wr=`${rt}.${Pr}`,dr=qr(n,wr);(i.array.has(rt)||ts(yr)||dr&&!dr._f)&&!cv(yr)?Ne(wr,yr,Kt):je(wr,yr,Kt)}},Ye=(rt,Ot,Kt={})=>{const Pr=qr(n,rt),yr=i.array.has(rt),wr=Rc(Ot);ba(l,rt,wr),yr?(C.array.next({name:rt,values:{...l}}),(A.isDirty||A.dirtyFields)&&Kt.shouldDirty&&C.state.next({name:rt,dirtyFields:jb(a,l),isDirty:ke(rt,wr)})):Pr&&!Pr._f&&!nc(wr)?Ne(rt,wr,Kt):je(rt,wr,Kt),HB(rt,i)&&C.state.next({...r}),C.values.next({name:h.mount?rt:void 0,values:{...l}})},$e=async rt=>{h.mount=!0;const Ot=rt.target;let Kt=Ot.name,Pr=!0;const yr=qr(n,Kt),wr=()=>Ot.type?rM(yr._f):DH(rt),dr=An=>{Pr=Number.isNaN(An)||cv(An)&&isNaN(An.getTime())||Ag(An,qr(l,Kt,An))};if(yr){let An,Ti;const Bi=wr(),Vi=rt.type===RA.BLUR||rt.type===RA.FOCUS_OUT,is=!Cme(yr._f)&&!t.resolver&&!qr(r.errors,Kt)&&!yr._f.deps||Mme(Vi,qr(r.touchedFields,Kt),r.isSubmitted,z,R),$a=HB(Kt,i,Vi);ba(l,Kt,Bi),Vi?(yr._f.onBlur&&yr._f.onBlur(rt),_&&_(0)):yr._f.onChange&&yr._f.onChange(rt);const Vo=de(Kt,Bi,Vi,!1),ys=!kc(Vo)||$a;if(!Vi&&C.values.next({name:Kt,type:rt.type,values:{...l}}),is)return A.isValid&&(t.mode==="onBlur"&&Vi?G():Vi||G()),ys&&C.state.next({name:Kt,...$a?{}:Vo});if(!Vi&&$a&&C.state.next({...r}),t.resolver){const{errors:Qa}=await ve([Kt]);if(dr(Bi),Pr){const $l=tV(r.errors,n,Kt),_l=tV(Qa,n,$l.name||Kt);An=_l.error,Kt=_l.name,Ti=kc(Qa)}}else H([Kt],!0),An=(await QB(yr,i.disabled,l,V,t.shouldUseNativeValidation))[Kt],H([Kt]),dr(Bi),Pr&&(An?Ti=!1:A.isValid&&(Ti=await Oe(n,!0)));Pr&&(yr._f.deps&&Et(yr._f.deps),ue(Kt,Ti,An,Vo))}},We=(rt,Ot)=>{if(qr(r.errors,Ot)&&rt.focus)return rt.focus(),1},Et=async(rt,Ot={})=>{let Kt,Pr;const yr=a1(rt);if(t.resolver){const wr=await Ae(Jo(rt)?rt:yr);Kt=kc(wr),Pr=rt?!yr.some(dr=>qr(wr,dr)):Kt}else rt?(Pr=(await Promise.all(yr.map(async wr=>{const dr=qr(n,wr);return await Oe(dr&&dr._f?{[wr]:dr}:dr)}))).every(Boolean),!(!Pr&&!r.isValid)&&G()):Pr=Kt=await Oe(n);return C.state.next({...!Nf(rt)||A.isValid&&Kt!==r.isValid?{}:{name:rt},...t.resolver||!rt?{isValid:Kt}:{},errors:r.errors}),Ot.shouldFocus&&!Pr&&o1(n,We,rt?yr:i.mount),Pr},Je=rt=>{const Ot={...h.mount?l:a};return Jo(rt)?Ot:Nf(rt)?qr(Ot,rt):rt.map(Kt=>qr(Ot,Kt))},ht=(rt,Ot)=>({invalid:!!qr((Ot||r).errors,rt),isDirty:!!qr((Ot||r).dirtyFields,rt),error:qr((Ot||r).errors,rt),isValidating:!!qr(r.validatingFields,rt),isTouched:!!qr((Ot||r).touchedFields,rt)}),tt=rt=>{rt&&a1(rt).forEach(Ot=>ks(r.errors,Ot)),C.state.next({errors:rt?r.errors:{}})},Qt=(rt,Ot,Kt)=>{const Pr=(qr(n,rt,{_f:{}})._f||{}).ref,yr=qr(r.errors,rt)||{},{ref:wr,message:dr,type:An,...Ti}=yr;ba(r.errors,rt,{...Ti,...Ot,ref:Pr}),C.state.next({name:rt,errors:r.errors,isValid:!1}),Kt&&Kt.shouldFocus&&Pr&&Pr.focus&&Pr.focus()},gr=(rt,Ot)=>jf(rt)?C.values.subscribe({next:Kt=>rt(ze(void 0,Ot),Kt)}):ze(rt,Ot,!0),sr=(rt,Ot={})=>{for(const Kt of rt?a1(rt):i.mount)i.mount.delete(Kt),i.array.delete(Kt),Ot.keepValue||(ks(n,Kt),ks(l,Kt)),!Ot.keepError&&ks(r.errors,Kt),!Ot.keepDirty&&ks(r.dirtyFields,Kt),!Ot.keepTouched&&ks(r.touchedFields,Kt),!Ot.keepIsValidating&&ks(r.validatingFields,Kt),!t.shouldUnregister&&!Ot.keepDefaultValue&&ks(a,Kt);C.values.next({values:{...l}}),C.state.next({...r,...Ot.keepDirty?{isDirty:ke()}:{}}),!Ot.keepIsValid&&G()},ur=({disabled:rt,name:Ot,field:Kt,fields:Pr})=>{(xd(rt)&&h.mount||rt||i.disabled.has(Ot))&&(rt?i.disabled.add(Ot):i.disabled.delete(Ot),de(Ot,rM(Kt?Kt._f:qr(Pr,Ot)._f),!1,!1,!0))},br=(rt,Ot={})=>{let Kt=qr(n,rt);const Pr=xd(Ot.disabled)||xd(t.disabled);return ba(n,rt,{...Kt||{},_f:{...Kt&&Kt._f?Kt._f:{ref:{name:rt}},name:rt,mount:!0,...Ot}}),i.mount.add(rt),Kt?ur({field:Kt,disabled:xd(Ot.disabled)?Ot.disabled:t.disabled,name:rt}):ne(rt,!0,Ot.value),{...Pr?{disabled:Ot.disabled||t.disabled}:{},...t.progressive?{required:!!Ot.required,min:Nb(Ot.min),max:Nb(Ot.max),minLength:Nb(Ot.minLength),maxLength:Nb(Ot.maxLength),pattern:Nb(Ot.pattern)}:{},name:rt,onChange:$e,onBlur:$e,ref:yr=>{if(yr){br(rt,Ot),Kt=qr(n,rt);const wr=Jo(yr.value)&&yr.querySelectorAll&&yr.querySelectorAll("input,select,textarea")[0]||yr,dr=Tme(wr),An=Kt._f.refs||[];if(dr?An.find(Ti=>Ti===wr):wr===Kt._f.ref)return;ba(n,rt,{_f:{...Kt._f,...dr?{refs:[...An.filter(tM),wr,...Array.isArray(qr(a,rt))?[{}]:[]],ref:{type:wr.type,name:rt}}:{ref:wr}}}),ne(rt,!1,void 0,wr)}else Kt=qr(n,rt,{}),Kt._f&&(Kt._f.mount=!1),(t.shouldUnregister||Ot.shouldUnregister)&&!(LH(i.array,rt)&&h.action)&&i.unMount.add(rt)}}},Wt=()=>t.shouldFocusError&&o1(n,We,i.mount),Be=rt=>{xd(rt)&&(C.state.next({disabled:rt}),o1(n,(Ot,Kt)=>{const Pr=qr(n,Kt);Pr&&(Ot.disabled=Pr._f.disabled||rt,Array.isArray(Pr._f.refs)&&Pr._f.refs.forEach(yr=>{yr.disabled=Pr._f.disabled||rt}))},0,!1))},Nr=(rt,Ot)=>async Kt=>{let Pr;Kt&&(Kt.preventDefault&&Kt.preventDefault(),Kt.persist&&Kt.persist());let yr=Rc(l);if(i.disabled.size)for(const wr of i.disabled)ba(yr,wr,void 0);if(C.state.next({isSubmitting:!0}),t.resolver){const{errors:wr,values:dr}=await ve();r.errors=wr,yr=dr}else await Oe(n);if(ks(r.errors,"root"),kc(r.errors)){C.state.next({errors:{}});try{await rt(yr,Kt)}catch(wr){Pr=wr}}else Ot&&await Ot({...r.errors},Kt),Wt(),setTimeout(Wt);if(C.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:kc(r.errors)&&!Pr,submitCount:r.submitCount+1,errors:r.errors}),Pr)throw Pr},Jt=(rt,Ot={})=>{qr(n,rt)&&(Jo(Ot.defaultValue)?Ye(rt,Rc(qr(a,rt))):(Ye(rt,Ot.defaultValue),ba(a,rt,Rc(Ot.defaultValue))),Ot.keepTouched||ks(r.touchedFields,rt),Ot.keepDirty||(ks(r.dirtyFields,rt),r.isDirty=Ot.defaultValue?ke(rt,Rc(qr(a,rt))):ke()),Ot.keepError||(ks(r.errors,rt),A.isValid&&G()),C.state.next({...r}))},Sn=(rt,Ot={})=>{const Kt=rt?Rc(rt):a,Pr=Rc(Kt),yr=kc(rt),wr=yr?a:Pr;if(Ot.keepDefaultValues||(a=Kt),!Ot.keepValues){if(Ot.keepDirtyValues){const dr=new Set([...i.mount,...Object.keys(jb(a,l))]);for(const An of Array.from(dr))qr(r.dirtyFields,An)?ba(wr,An,qr(l,An)):Ye(An,qr(wr,An))}else{if(o3&&Jo(rt))for(const dr of i.mount){const An=qr(n,dr);if(An&&An._f){const Ti=Array.isArray(An._f.refs)?An._f.refs[0]:An._f.ref;if(kA(Ti)){const Bi=Ti.closest("form");if(Bi){Bi.reset();break}}}}n={}}l=t.shouldUnregister?Ot.keepDefaultValues?Rc(a):{}:Rc(wr),C.array.next({values:{...wr}}),C.values.next({values:{...wr}})}i={mount:Ot.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},h.mount=!A.isValid||!!Ot.keepIsValid||!!Ot.keepDirtyValues,h.watch=!!t.shouldUnregister,C.state.next({submitCount:Ot.keepSubmitCount?r.submitCount:0,isDirty:yr?!1:Ot.keepDirty?r.isDirty:!!(Ot.keepDefaultValues&&!Ag(rt,a)),isSubmitted:Ot.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:yr?{}:Ot.keepDirtyValues?Ot.keepDefaultValues&&l?jb(a,l):r.dirtyFields:Ot.keepDefaultValues&&rt?jb(a,rt):Ot.keepDirty?r.dirtyFields:{},touchedFields:Ot.keepTouched?r.touchedFields:{},errors:Ot.keepErrors?r.errors:{},isSubmitSuccessful:Ot.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},It=(rt,Ot)=>Sn(jf(rt)?rt(l):rt,Ot);return{control:{register:br,unregister:sr,getFieldState:ht,handleSubmit:Nr,setError:Qt,_executeSchema:ve,_getWatch:ze,_getDirty:ke,_updateValid:G,_removeUnmounted:Se,_updateFieldArray:J,_updateDisabledField:ur,_getFieldArray:et,_reset:Sn,_resetDefaultValues:()=>jf(t.defaultValues)&&t.defaultValues().then(rt=>{It(rt,t.resetOptions),C.state.next({isLoading:!1})}),_updateFormState:rt=>{r={...r,...rt}},_disableForm:Be,_subjects:C,_proxyFormState:A,_setErrors:le,get _fields(){return n},get _formValues(){return l},get _state(){return h},set _state(rt){h=rt},get _defaultValues(){return a},get _names(){return i},set _names(rt){i=rt},get _formState(){return r},set _formState(rt){r=rt},get _options(){return t},set _options(rt){t={...t,...rt}}},trigger:Et,register:br,handleSubmit:Nr,watch:gr,setValue:Ye,getValues:Je,reset:It,resetField:Jt,clearErrors:tt,unregister:sr,setError:Qt,setFocus:(rt,Ot={})=>{const Kt=qr(n,rt),Pr=Kt&&Kt._f;if(Pr){const yr=Pr.refs?Pr.refs[0]:Pr.ref;yr.focus&&(yr.focus(),Ot.shouldSelect&&jf(yr.select)&&yr.select())}},getFieldState:ht}}function Uh(e={}){const t=Pe.useRef(void 0),r=Pe.useRef(void 0),[n,a]=Pe.useState({isDirty:!1,isValidating:!1,isLoading:jf(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:jf(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...kme(e),formState:n});const l=t.current.control;return l._options=e,l3({subject:l._subjects.state,next:h=>{VH(h,l._proxyFormState,l._updateFormState,!0)&&a({...l._formState})}}),Pe.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),Pe.useEffect(()=>{if(l._proxyFormState.isDirty){const h=l._getDirty();h!==n.isDirty&&l._subjects.state.next({isDirty:h})}},[l,n.isDirty]),Pe.useEffect(()=>{e.values&&!Ag(e.values,r.current)?(l._reset(e.values,l._options.resetOptions),r.current=e.values,a(h=>({...h}))):l._resetDefaultValues()},[e.values,l]),Pe.useEffect(()=>{e.errors&&l._setErrors(e.errors)},[e.errors,l]),Pe.useEffect(()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),Pe.useEffect(()=>{e.shouldUnregister&&l._subjects.values.next({values:l._getWatch()})},[e.shouldUnregister,l]),t.current.formState=BH(n,l),t.current}var Yi;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const l={};for(const h of a)l[h]=h;return l},e.getValidEnumValues=a=>{const l=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),h={};for(const i of l)h[i]=a[i];return e.objectValues(h)},e.objectValues=a=>e.objectKeys(a).map(function(l){return a[l]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const l=[];for(const h in a)Object.prototype.hasOwnProperty.call(a,h)&&l.push(h);return l},e.find=(a,l)=>{for(const h of a)if(l(h))return h},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,l=" | "){return a.map(h=>typeof h=="string"?`'${h}'`:h).join(l)}e.joinValues=n,e.jsonStringifyReplacer=(a,l)=>typeof l=="bigint"?l.toString():l})(Yi||(Yi={}));var rN;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(rN||(rN={}));const nn=Yi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Xp=e=>{switch(typeof e){case"undefined":return nn.undefined;case"string":return nn.string;case"number":return isNaN(e)?nn.nan:nn.number;case"boolean":return nn.boolean;case"function":return nn.function;case"bigint":return nn.bigint;case"symbol":return nn.symbol;case"object":return Array.isArray(e)?nn.array:e===null?nn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?nn.promise:typeof Map<"u"&&e instanceof Map?nn.map:typeof Set<"u"&&e instanceof Set?nn.set:typeof Date<"u"&&e instanceof Date?nn.date:nn.object;default:return nn.unknown}},Rr=Yi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),jme=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class bu extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(l){return l.message},n={_errors:[]},a=l=>{for(const h of l.issues)if(h.code==="invalid_union")h.unionErrors.map(a);else if(h.code==="invalid_return_type")a(h.returnTypeError);else if(h.code==="invalid_arguments")a(h.argumentsError);else if(h.path.length===0)n._errors.push(r(h));else{let i=n,_=0;for(;_<h.path.length;){const w=h.path[_];_===h.path.length-1?(i[w]=i[w]||{_errors:[]},i[w]._errors.push(r(h))):i[w]=i[w]||{_errors:[]},i=i[w],_++}}};return a(this),n}static assert(t){if(!(t instanceof bu))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Yi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}bu.create=e=>new bu(e);const xx=(e,t)=>{let r;switch(e.code){case Rr.invalid_type:e.received===nn.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Rr.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Yi.jsonStringifyReplacer)}`;break;case Rr.unrecognized_keys:r=`Unrecognized key(s) in object: ${Yi.joinValues(e.keys,", ")}`;break;case Rr.invalid_union:r="Invalid input";break;case Rr.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Yi.joinValues(e.options)}`;break;case Rr.invalid_enum_value:r=`Invalid enum value. Expected ${Yi.joinValues(e.options)}, received '${e.received}'`;break;case Rr.invalid_arguments:r="Invalid function arguments";break;case Rr.invalid_return_type:r="Invalid function return type";break;case Rr.invalid_date:r="Invalid date";break;case Rr.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Yi.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Rr.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Rr.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Rr.custom:r="Invalid input";break;case Rr.invalid_intersection_types:r="Intersection results could not be merged";break;case Rr.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Rr.not_finite:r="Number must be finite";break;default:r=t.defaultError,Yi.assertNever(e)}return{message:r}};let JH=xx;function Nme(e){JH=e}function IA(){return JH}const DA=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,l=[...r,...a.path||[]],h={...a,path:l};if(a.message!==void 0)return{...a,path:l,message:a.message};let i="";const _=n.filter(w=>!!w).slice().reverse();for(const w of _)i=w(h,{data:t,defaultError:i}).message;return{...a,path:l,message:i}},Ime=[];function Yr(e,t){const r=IA(),n=DA({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===xx?void 0:xx].filter(a=>!!a)});e.common.issues.push(n)}class Ul{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return di;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const l=await a.key,h=await a.value;n.push({key:l,value:h})}return Ul.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:l,value:h}=a;if(l.status==="aborted"||h.status==="aborted")return di;l.status==="dirty"&&t.dirty(),h.status==="dirty"&&t.dirty(),l.value!=="__proto__"&&(typeof h.value<"u"||a.alwaysSet)&&(n[l.value]=h.value)}return{status:t.value,value:n}}}const di=Object.freeze({status:"aborted"}),J_=e=>({status:"dirty",value:e}),cc=e=>({status:"valid",value:e}),nN=e=>e.status==="aborted",iN=e=>e.status==="dirty",Pv=e=>e.status==="valid",R1=e=>typeof Promise<"u"&&e instanceof Promise;function LA(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function QH(e,t,r,n,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var wn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(wn||(wn={}));var Yb,Xb;class Gf{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const rV=(e,t)=>{if(Pv(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new bu(e.common.issues);return this._error=r,this._error}}};function wi(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(h,i)=>{var _,w;const{message:A}=e;return h.code==="invalid_enum_value"?{message:A??i.defaultError}:typeof i.data>"u"?{message:(_=A??n)!==null&&_!==void 0?_:i.defaultError}:h.code!=="invalid_type"?{message:i.defaultError}:{message:(w=A??r)!==null&&w!==void 0?w:i.defaultError}},description:a}}class Oi{get description(){return this._def.description}_getType(t){return Xp(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Xp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Ul,ctx:{common:t.parent.common,data:t.data,parsedType:Xp(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(R1(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Xp(t)},l=this._parseSync({data:t,path:a.path,parent:a});return rV(a,l)}"~validate"(t){var r,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Xp(t)};if(!this["~standard"].async)try{const l=this._parseSync({data:t,path:[],parent:a});return Pv(l)?{value:l.value}:{issues:a.common.issues}}catch(l){!((n=(r=l==null?void 0:l.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(l=>Pv(l)?{value:l.value}:{issues:a.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Xp(t)},a=this._parse({data:t,path:n.path,parent:n}),l=await(R1(a)?a:Promise.resolve(a));return rV(n,l)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,l)=>{const h=t(a),i=()=>l.addIssue({code:Rr.custom,...n(a)});return typeof Promise<"u"&&h instanceof Promise?h.then(_=>_?!0:(i(),!1)):h?!0:(i(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new zh({schema:this,typeName:li.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Ff.create(this,this._def)}nullable(){return Fg.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Oh.create(this)}promise(){return wx.create(this,this._def)}or(t){return I1.create([this,t],this._def)}and(t){return D1.create(this,t,this._def)}transform(t){return new zh({...wi(this._def),schema:this,typeName:li.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new V1({...wi(this._def),innerType:this,defaultValue:r,typeName:li.ZodDefault})}brand(){return new d3({typeName:li.ZodBranded,type:this,...wi(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new U1({...wi(this._def),innerType:this,catchValue:r,typeName:li.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Yw.create(this,t)}readonly(){return $1.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Dme=/^c[^\s-]{8,}$/i,Lme=/^[0-9a-z]+$/,zme=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Fme=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Bme=/^[a-z0-9_-]{21}$/i,Vme=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ume=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$me=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,qme="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let nM;const Gme=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Kme=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Wme=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Hme=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Zme=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Yme=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,eZ="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Xme=new RegExp(`^${eZ}$`);function tZ(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function Jme(e){return new RegExp(`^${tZ(e)}$`)}function rZ(e){let t=`${eZ}T${tZ(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Qme(e,t){return!!((t==="v4"||!t)&&Gme.test(e)||(t==="v6"||!t)&&Wme.test(e))}function ege(e,t){if(!Vme.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||!a.typ||!a.alg||t&&a.alg!==t)}catch{return!1}}function tge(e,t){return!!((t==="v4"||!t)&&Kme.test(e)||(t==="v6"||!t)&&Hme.test(e))}class Ch extends Oi{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==nn.string){const l=this._getOrReturnCtx(t);return Yr(l,{code:Rr.invalid_type,expected:nn.string,received:l.parsedType}),di}const n=new Ul;let a;for(const l of this._def.checks)if(l.kind==="min")t.data.length<l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="max")t.data.length>l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!1,message:l.message}),n.dirty());else if(l.kind==="length"){const h=t.data.length>l.value,i=t.data.length<l.value;(h||i)&&(a=this._getOrReturnCtx(t,a),h?Yr(a,{code:Rr.too_big,maximum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}):i&&Yr(a,{code:Rr.too_small,minimum:l.value,type:"string",inclusive:!0,exact:!0,message:l.message}),n.dirty())}else if(l.kind==="email")$me.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"email",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="emoji")nM||(nM=new RegExp(qme,"u")),nM.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"emoji",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="uuid")Fme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"uuid",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="nanoid")Bme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"nanoid",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid")Dme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"cuid",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="cuid2")Lme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"cuid2",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="ulid")zme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"ulid",code:Rr.invalid_string,message:l.message}),n.dirty());else if(l.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Yr(a,{validation:"url",code:Rr.invalid_string,message:l.message}),n.dirty()}else l.kind==="regex"?(l.regex.lastIndex=0,l.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"regex",code:Rr.invalid_string,message:l.message}),n.dirty())):l.kind==="trim"?t.data=t.data.trim():l.kind==="includes"?t.data.includes(l.value,l.position)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.invalid_string,validation:{includes:l.value,position:l.position},message:l.message}),n.dirty()):l.kind==="toLowerCase"?t.data=t.data.toLowerCase():l.kind==="toUpperCase"?t.data=t.data.toUpperCase():l.kind==="startsWith"?t.data.startsWith(l.value)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.invalid_string,validation:{startsWith:l.value},message:l.message}),n.dirty()):l.kind==="endsWith"?t.data.endsWith(l.value)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.invalid_string,validation:{endsWith:l.value},message:l.message}),n.dirty()):l.kind==="datetime"?rZ(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.invalid_string,validation:"datetime",message:l.message}),n.dirty()):l.kind==="date"?Xme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.invalid_string,validation:"date",message:l.message}),n.dirty()):l.kind==="time"?Jme(l).test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.invalid_string,validation:"time",message:l.message}),n.dirty()):l.kind==="duration"?Ume.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"duration",code:Rr.invalid_string,message:l.message}),n.dirty()):l.kind==="ip"?Qme(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"ip",code:Rr.invalid_string,message:l.message}),n.dirty()):l.kind==="jwt"?ege(t.data,l.alg)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"jwt",code:Rr.invalid_string,message:l.message}),n.dirty()):l.kind==="cidr"?tge(t.data,l.version)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"cidr",code:Rr.invalid_string,message:l.message}),n.dirty()):l.kind==="base64"?Zme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"base64",code:Rr.invalid_string,message:l.message}),n.dirty()):l.kind==="base64url"?Yme.test(t.data)||(a=this._getOrReturnCtx(t,a),Yr(a,{validation:"base64url",code:Rr.invalid_string,message:l.message}),n.dirty()):Yi.assertNever(l);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:Rr.invalid_string,...wn.errToObj(n)})}_addCheck(t){return new Ch({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...wn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...wn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...wn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...wn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...wn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...wn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...wn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...wn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...wn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...wn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...wn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...wn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...wn.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...wn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...wn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...wn.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...wn.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...wn.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...wn.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...wn.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...wn.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...wn.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...wn.errToObj(r)})}nonempty(t){return this.min(1,wn.errToObj(t))}trim(){return new Ch({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ch({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ch({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Ch.create=e=>{var t;return new Ch({checks:[],typeName:li.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...wi(e)})};function rge(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,l=parseInt(e.toFixed(a).replace(".","")),h=parseInt(t.toFixed(a).replace(".",""));return l%h/Math.pow(10,a)}class Dg extends Oi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==nn.number){const l=this._getOrReturnCtx(t);return Yr(l,{code:Rr.invalid_type,expected:nn.number,received:l.parsedType}),di}let n;const a=new Ul;for(const l of this._def.checks)l.kind==="int"?Yi.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.invalid_type,expected:"integer",received:"float",message:l.message}),a.dirty()):l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.too_small,minimum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.too_big,maximum:l.value,type:"number",inclusive:l.inclusive,exact:!1,message:l.message}),a.dirty()):l.kind==="multipleOf"?rge(t.data,l.value)!==0&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):l.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.not_finite,message:l.message}),a.dirty()):Yi.assertNever(l);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,wn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,wn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,wn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,wn.toString(r))}setLimit(t,r,n,a){return new Dg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:wn.toString(a)}]})}_addCheck(t){return new Dg({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:wn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:wn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:wn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:wn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:wn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:wn.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:wn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:wn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:wn.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Yi.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Dg.create=e=>new Dg({checks:[],typeName:li.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...wi(e)});class Lg extends Oi{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==nn.bigint)return this._getInvalidInput(t);let n;const a=new Ul;for(const l of this._def.checks)l.kind==="min"?(l.inclusive?t.data<l.value:t.data<=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.too_small,type:"bigint",minimum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="max"?(l.inclusive?t.data>l.value:t.data>=l.value)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.too_big,type:"bigint",maximum:l.value,inclusive:l.inclusive,message:l.message}),a.dirty()):l.kind==="multipleOf"?t.data%l.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),Yr(n,{code:Rr.not_multiple_of,multipleOf:l.value,message:l.message}),a.dirty()):Yi.assertNever(l);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Yr(r,{code:Rr.invalid_type,expected:nn.bigint,received:r.parsedType}),di}gte(t,r){return this.setLimit("min",t,!0,wn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,wn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,wn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,wn.toString(r))}setLimit(t,r,n,a){return new Lg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:wn.toString(a)}]})}_addCheck(t){return new Lg({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:wn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:wn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:wn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:wn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:wn.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Lg.create=e=>{var t;return new Lg({checks:[],typeName:li.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...wi(e)})};class k1 extends Oi{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==nn.boolean){const n=this._getOrReturnCtx(t);return Yr(n,{code:Rr.invalid_type,expected:nn.boolean,received:n.parsedType}),di}return cc(t.data)}}k1.create=e=>new k1({typeName:li.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...wi(e)});class Ev extends Oi{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==nn.date){const l=this._getOrReturnCtx(t);return Yr(l,{code:Rr.invalid_type,expected:nn.date,received:l.parsedType}),di}if(isNaN(t.data.getTime())){const l=this._getOrReturnCtx(t);return Yr(l,{code:Rr.invalid_date}),di}const n=new Ul;let a;for(const l of this._def.checks)l.kind==="min"?t.data.getTime()<l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.too_small,message:l.message,inclusive:!0,exact:!1,minimum:l.value,type:"date"}),n.dirty()):l.kind==="max"?t.data.getTime()>l.value&&(a=this._getOrReturnCtx(t,a),Yr(a,{code:Rr.too_big,message:l.message,inclusive:!0,exact:!1,maximum:l.value,type:"date"}),n.dirty()):Yi.assertNever(l);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ev({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:wn.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:wn.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Ev.create=e=>new Ev({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:li.ZodDate,...wi(e)});class zA extends Oi{_parse(t){if(this._getType(t)!==nn.symbol){const n=this._getOrReturnCtx(t);return Yr(n,{code:Rr.invalid_type,expected:nn.symbol,received:n.parsedType}),di}return cc(t.data)}}zA.create=e=>new zA({typeName:li.ZodSymbol,...wi(e)});class j1 extends Oi{_parse(t){if(this._getType(t)!==nn.undefined){const n=this._getOrReturnCtx(t);return Yr(n,{code:Rr.invalid_type,expected:nn.undefined,received:n.parsedType}),di}return cc(t.data)}}j1.create=e=>new j1({typeName:li.ZodUndefined,...wi(e)});class N1 extends Oi{_parse(t){if(this._getType(t)!==nn.null){const n=this._getOrReturnCtx(t);return Yr(n,{code:Rr.invalid_type,expected:nn.null,received:n.parsedType}),di}return cc(t.data)}}N1.create=e=>new N1({typeName:li.ZodNull,...wi(e)});class bx extends Oi{constructor(){super(...arguments),this._any=!0}_parse(t){return cc(t.data)}}bx.create=e=>new bx({typeName:li.ZodAny,...wi(e)});class vv extends Oi{constructor(){super(...arguments),this._unknown=!0}_parse(t){return cc(t.data)}}vv.create=e=>new vv({typeName:li.ZodUnknown,...wi(e)});class um extends Oi{_parse(t){const r=this._getOrReturnCtx(t);return Yr(r,{code:Rr.invalid_type,expected:nn.never,received:r.parsedType}),di}}um.create=e=>new um({typeName:li.ZodNever,...wi(e)});class FA extends Oi{_parse(t){if(this._getType(t)!==nn.undefined){const n=this._getOrReturnCtx(t);return Yr(n,{code:Rr.invalid_type,expected:nn.void,received:n.parsedType}),di}return cc(t.data)}}FA.create=e=>new FA({typeName:li.ZodVoid,...wi(e)});class Oh extends Oi{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==nn.array)return Yr(r,{code:Rr.invalid_type,expected:nn.array,received:r.parsedType}),di;if(a.exactLength!==null){const h=r.data.length>a.exactLength.value,i=r.data.length<a.exactLength.value;(h||i)&&(Yr(r,{code:h?Rr.too_big:Rr.too_small,minimum:i?a.exactLength.value:void 0,maximum:h?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Yr(r,{code:Rr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Yr(r,{code:Rr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((h,i)=>a.type._parseAsync(new Gf(r,h,r.path,i)))).then(h=>Ul.mergeArray(n,h));const l=[...r.data].map((h,i)=>a.type._parseSync(new Gf(r,h,r.path,i)));return Ul.mergeArray(n,l)}get element(){return this._def.type}min(t,r){return new Oh({...this._def,minLength:{value:t,message:wn.toString(r)}})}max(t,r){return new Oh({...this._def,maxLength:{value:t,message:wn.toString(r)}})}length(t,r){return new Oh({...this._def,exactLength:{value:t,message:wn.toString(r)}})}nonempty(t){return this.min(1,t)}}Oh.create=(e,t)=>new Oh({type:e,minLength:null,maxLength:null,exactLength:null,typeName:li.ZodArray,...wi(t)});function X_(e){if(e instanceof Oo){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Ff.create(X_(n))}return new Oo({...e._def,shape:()=>t})}else return e instanceof Oh?new Oh({...e._def,type:X_(e.element)}):e instanceof Ff?Ff.create(X_(e.unwrap())):e instanceof Fg?Fg.create(X_(e.unwrap())):e instanceof Kf?Kf.create(e.items.map(t=>X_(t))):e}class Oo extends Oi{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Yi.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==nn.object){const w=this._getOrReturnCtx(t);return Yr(w,{code:Rr.invalid_type,expected:nn.object,received:w.parsedType}),di}const{status:n,ctx:a}=this._processInputParams(t),{shape:l,keys:h}=this._getCached(),i=[];if(!(this._def.catchall instanceof um&&this._def.unknownKeys==="strip"))for(const w in a.data)h.includes(w)||i.push(w);const _=[];for(const w of h){const A=l[w],C=a.data[w];_.push({key:{status:"valid",value:w},value:A._parse(new Gf(a,C,a.path,w)),alwaysSet:w in a.data})}if(this._def.catchall instanceof um){const w=this._def.unknownKeys;if(w==="passthrough")for(const A of i)_.push({key:{status:"valid",value:A},value:{status:"valid",value:a.data[A]}});else if(w==="strict")i.length>0&&(Yr(a,{code:Rr.unrecognized_keys,keys:i}),n.dirty());else if(w!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const w=this._def.catchall;for(const A of i){const C=a.data[A];_.push({key:{status:"valid",value:A},value:w._parse(new Gf(a,C,a.path,A)),alwaysSet:A in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const w=[];for(const A of _){const C=await A.key,R=await A.value;w.push({key:C,value:R,alwaysSet:A.alwaysSet})}return w}).then(w=>Ul.mergeObjectSync(n,w)):Ul.mergeObjectSync(n,_)}get shape(){return this._def.shape()}strict(t){return wn.errToObj,new Oo({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,l,h,i;const _=(h=(l=(a=this._def).errorMap)===null||l===void 0?void 0:l.call(a,r,n).message)!==null&&h!==void 0?h:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=wn.errToObj(t).message)!==null&&i!==void 0?i:_}:{message:_}}}:{}})}strip(){return new Oo({...this._def,unknownKeys:"strip"})}passthrough(){return new Oo({...this._def,unknownKeys:"passthrough"})}extend(t){return new Oo({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Oo({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:li.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Oo({...this._def,catchall:t})}pick(t){const r={};return Yi.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Oo({...this._def,shape:()=>r})}omit(t){const r={};return Yi.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Oo({...this._def,shape:()=>r})}deepPartial(){return X_(this)}partial(t){const r={};return Yi.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new Oo({...this._def,shape:()=>r})}required(t){const r={};return Yi.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let l=this.shape[n];for(;l instanceof Ff;)l=l._def.innerType;r[n]=l}}),new Oo({...this._def,shape:()=>r})}keyof(){return nZ(Yi.objectKeys(this.shape))}}Oo.create=(e,t)=>new Oo({shape:()=>e,unknownKeys:"strip",catchall:um.create(),typeName:li.ZodObject,...wi(t)});Oo.strictCreate=(e,t)=>new Oo({shape:()=>e,unknownKeys:"strict",catchall:um.create(),typeName:li.ZodObject,...wi(t)});Oo.lazycreate=(e,t)=>new Oo({shape:e,unknownKeys:"strip",catchall:um.create(),typeName:li.ZodObject,...wi(t)});class I1 extends Oi{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(l){for(const i of l)if(i.result.status==="valid")return i.result;for(const i of l)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const h=l.map(i=>new bu(i.ctx.common.issues));return Yr(r,{code:Rr.invalid_union,unionErrors:h}),di}if(r.common.async)return Promise.all(n.map(async l=>{const h={...r,common:{...r.common,issues:[]},parent:null};return{result:await l._parseAsync({data:r.data,path:r.path,parent:h}),ctx:h}})).then(a);{let l;const h=[];for(const _ of n){const w={...r,common:{...r.common,issues:[]},parent:null},A=_._parseSync({data:r.data,path:r.path,parent:w});if(A.status==="valid")return A;A.status==="dirty"&&!l&&(l={result:A,ctx:w}),w.common.issues.length&&h.push(w.common.issues)}if(l)return r.common.issues.push(...l.ctx.common.issues),l.result;const i=h.map(_=>new bu(_));return Yr(r,{code:Rr.invalid_union,unionErrors:i}),di}}get options(){return this._def.options}}I1.create=(e,t)=>new I1({options:e,typeName:li.ZodUnion,...wi(t)});const Hp=e=>e instanceof z1?Hp(e.schema):e instanceof zh?Hp(e.innerType()):e instanceof F1?[e.value]:e instanceof zg?e.options:e instanceof B1?Yi.objectValues(e.enum):e instanceof V1?Hp(e._def.innerType):e instanceof j1?[void 0]:e instanceof N1?[null]:e instanceof Ff?[void 0,...Hp(e.unwrap())]:e instanceof Fg?[null,...Hp(e.unwrap())]:e instanceof d3||e instanceof $1?Hp(e.unwrap()):e instanceof U1?Hp(e._def.innerType):[];class SP extends Oi{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.object)return Yr(r,{code:Rr.invalid_type,expected:nn.object,received:r.parsedType}),di;const n=this.discriminator,a=r.data[n],l=this.optionsMap.get(a);return l?r.common.async?l._parseAsync({data:r.data,path:r.path,parent:r}):l._parseSync({data:r.data,path:r.path,parent:r}):(Yr(r,{code:Rr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),di)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const l of r){const h=Hp(l.shape[t]);if(!h.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of h){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,l)}}return new SP({typeName:li.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...wi(n)})}}function aN(e,t){const r=Xp(e),n=Xp(t);if(e===t)return{valid:!0,data:e};if(r===nn.object&&n===nn.object){const a=Yi.objectKeys(t),l=Yi.objectKeys(e).filter(i=>a.indexOf(i)!==-1),h={...e,...t};for(const i of l){const _=aN(e[i],t[i]);if(!_.valid)return{valid:!1};h[i]=_.data}return{valid:!0,data:h}}else if(r===nn.array&&n===nn.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let l=0;l<e.length;l++){const h=e[l],i=t[l],_=aN(h,i);if(!_.valid)return{valid:!1};a.push(_.data)}return{valid:!0,data:a}}else return r===nn.date&&n===nn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class D1 extends Oi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(l,h)=>{if(nN(l)||nN(h))return di;const i=aN(l.value,h.value);return i.valid?((iN(l)||iN(h))&&r.dirty(),{status:r.value,value:i.data}):(Yr(n,{code:Rr.invalid_intersection_types}),di)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([l,h])=>a(l,h)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}D1.create=(e,t,r)=>new D1({left:e,right:t,typeName:li.ZodIntersection,...wi(r)});class Kf extends Oi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.array)return Yr(n,{code:Rr.invalid_type,expected:nn.array,received:n.parsedType}),di;if(n.data.length<this._def.items.length)return Yr(n,{code:Rr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),di;!this._def.rest&&n.data.length>this._def.items.length&&(Yr(n,{code:Rr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const l=[...n.data].map((h,i)=>{const _=this._def.items[i]||this._def.rest;return _?_._parse(new Gf(n,h,n.path,i)):null}).filter(h=>!!h);return n.common.async?Promise.all(l).then(h=>Ul.mergeArray(r,h)):Ul.mergeArray(r,l)}get items(){return this._def.items}rest(t){return new Kf({...this._def,rest:t})}}Kf.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Kf({items:e,typeName:li.ZodTuple,rest:null,...wi(t)})};class L1 extends Oi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.object)return Yr(n,{code:Rr.invalid_type,expected:nn.object,received:n.parsedType}),di;const a=[],l=this._def.keyType,h=this._def.valueType;for(const i in n.data)a.push({key:l._parse(new Gf(n,i,n.path,i)),value:h._parse(new Gf(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?Ul.mergeObjectAsync(r,a):Ul.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof Oi?new L1({keyType:t,valueType:r,typeName:li.ZodRecord,...wi(n)}):new L1({keyType:Ch.create(),valueType:t,typeName:li.ZodRecord,...wi(r)})}}class BA extends Oi{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.map)return Yr(n,{code:Rr.invalid_type,expected:nn.map,received:n.parsedType}),di;const a=this._def.keyType,l=this._def.valueType,h=[...n.data.entries()].map(([i,_],w)=>({key:a._parse(new Gf(n,i,n.path,[w,"key"])),value:l._parse(new Gf(n,_,n.path,[w,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const _ of h){const w=await _.key,A=await _.value;if(w.status==="aborted"||A.status==="aborted")return di;(w.status==="dirty"||A.status==="dirty")&&r.dirty(),i.set(w.value,A.value)}return{status:r.value,value:i}})}else{const i=new Map;for(const _ of h){const w=_.key,A=_.value;if(w.status==="aborted"||A.status==="aborted")return di;(w.status==="dirty"||A.status==="dirty")&&r.dirty(),i.set(w.value,A.value)}return{status:r.value,value:i}}}}BA.create=(e,t,r)=>new BA({valueType:t,keyType:e,typeName:li.ZodMap,...wi(r)});class Cv extends Oi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==nn.set)return Yr(n,{code:Rr.invalid_type,expected:nn.set,received:n.parsedType}),di;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(Yr(n,{code:Rr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(Yr(n,{code:Rr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const l=this._def.valueType;function h(_){const w=new Set;for(const A of _){if(A.status==="aborted")return di;A.status==="dirty"&&r.dirty(),w.add(A.value)}return{status:r.value,value:w}}const i=[...n.data.values()].map((_,w)=>l._parse(new Gf(n,_,n.path,w)));return n.common.async?Promise.all(i).then(_=>h(_)):h(i)}min(t,r){return new Cv({...this._def,minSize:{value:t,message:wn.toString(r)}})}max(t,r){return new Cv({...this._def,maxSize:{value:t,message:wn.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Cv.create=(e,t)=>new Cv({valueType:e,minSize:null,maxSize:null,typeName:li.ZodSet,...wi(t)});class fx extends Oi{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.function)return Yr(r,{code:Rr.invalid_type,expected:nn.function,received:r.parsedType}),di;function n(i,_){return DA({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,IA(),xx].filter(w=>!!w),issueData:{code:Rr.invalid_arguments,argumentsError:_}})}function a(i,_){return DA({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,IA(),xx].filter(w=>!!w),issueData:{code:Rr.invalid_return_type,returnTypeError:_}})}const l={errorMap:r.common.contextualErrorMap},h=r.data;if(this._def.returns instanceof wx){const i=this;return cc(async function(..._){const w=new bu([]),A=await i._def.args.parseAsync(_,l).catch(z=>{throw w.addIssue(n(_,z)),w}),C=await Reflect.apply(h,this,A);return await i._def.returns._def.type.parseAsync(C,l).catch(z=>{throw w.addIssue(a(C,z)),w})})}else{const i=this;return cc(function(..._){const w=i._def.args.safeParse(_,l);if(!w.success)throw new bu([n(_,w.error)]);const A=Reflect.apply(h,this,w.data),C=i._def.returns.safeParse(A,l);if(!C.success)throw new bu([a(A,C.error)]);return C.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new fx({...this._def,args:Kf.create(t).rest(vv.create())})}returns(t){return new fx({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new fx({args:t||Kf.create([]).rest(vv.create()),returns:r||vv.create(),typeName:li.ZodFunction,...wi(n)})}}class z1 extends Oi{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}z1.create=(e,t)=>new z1({getter:e,typeName:li.ZodLazy,...wi(t)});class F1 extends Oi{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Yr(r,{received:r.data,code:Rr.invalid_literal,expected:this._def.value}),di}return{status:"valid",value:t.data}}get value(){return this._def.value}}F1.create=(e,t)=>new F1({value:e,typeName:li.ZodLiteral,...wi(t)});function nZ(e,t){return new zg({values:e,typeName:li.ZodEnum,...wi(t)})}class zg extends Oi{constructor(){super(...arguments),Yb.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return Yr(r,{expected:Yi.joinValues(n),received:r.parsedType,code:Rr.invalid_type}),di}if(LA(this,Yb)||QH(this,Yb,new Set(this._def.values)),!LA(this,Yb).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return Yr(r,{received:r.data,code:Rr.invalid_enum_value,options:n}),di}return cc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return zg.create(t,{...this._def,...r})}exclude(t,r=this._def){return zg.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Yb=new WeakMap;zg.create=nZ;class B1 extends Oi{constructor(){super(...arguments),Xb.set(this,void 0)}_parse(t){const r=Yi.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==nn.string&&n.parsedType!==nn.number){const a=Yi.objectValues(r);return Yr(n,{expected:Yi.joinValues(a),received:n.parsedType,code:Rr.invalid_type}),di}if(LA(this,Xb)||QH(this,Xb,new Set(Yi.getValidEnumValues(this._def.values))),!LA(this,Xb).has(t.data)){const a=Yi.objectValues(r);return Yr(n,{received:n.data,code:Rr.invalid_enum_value,options:a}),di}return cc(t.data)}get enum(){return this._def.values}}Xb=new WeakMap;B1.create=(e,t)=>new B1({values:e,typeName:li.ZodNativeEnum,...wi(t)});class wx extends Oi{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==nn.promise&&r.common.async===!1)return Yr(r,{code:Rr.invalid_type,expected:nn.promise,received:r.parsedType}),di;const n=r.parsedType===nn.promise?r.data:Promise.resolve(r.data);return cc(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}wx.create=(e,t)=>new wx({type:e,typeName:li.ZodPromise,...wi(t)});class zh extends Oi{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===li.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,l={addIssue:h=>{Yr(n,h),h.fatal?r.abort():r.dirty()},get path(){return n.path}};if(l.addIssue=l.addIssue.bind(l),a.type==="preprocess"){const h=a.transform(n.data,l);if(n.common.async)return Promise.resolve(h).then(async i=>{if(r.value==="aborted")return di;const _=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return _.status==="aborted"?di:_.status==="dirty"||r.value==="dirty"?J_(_.value):_});{if(r.value==="aborted")return di;const i=this._def.schema._parseSync({data:h,path:n.path,parent:n});return i.status==="aborted"?di:i.status==="dirty"||r.value==="dirty"?J_(i.value):i}}if(a.type==="refinement"){const h=i=>{const _=a.refinement(i,l);if(n.common.async)return Promise.resolve(_);if(_ instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?di:(i.status==="dirty"&&r.dirty(),h(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?di:(i.status==="dirty"&&r.dirty(),h(i.value).then(()=>({status:r.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const h=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Pv(h))return h;const i=a.transform(h.value,l);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(h=>Pv(h)?Promise.resolve(a.transform(h.value,l)).then(i=>({status:r.value,value:i})):h);Yi.assertNever(a)}}zh.create=(e,t,r)=>new zh({schema:e,typeName:li.ZodEffects,effect:t,...wi(r)});zh.createWithPreprocess=(e,t,r)=>new zh({schema:t,effect:{type:"preprocess",transform:e},typeName:li.ZodEffects,...wi(r)});class Ff extends Oi{_parse(t){return this._getType(t)===nn.undefined?cc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Ff.create=(e,t)=>new Ff({innerType:e,typeName:li.ZodOptional,...wi(t)});class Fg extends Oi{_parse(t){return this._getType(t)===nn.null?cc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Fg.create=(e,t)=>new Fg({innerType:e,typeName:li.ZodNullable,...wi(t)});class V1 extends Oi{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===nn.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}V1.create=(e,t)=>new V1({innerType:e,typeName:li.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...wi(t)});class U1 extends Oi{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return R1(a)?a.then(l=>({status:"valid",value:l.status==="valid"?l.value:this._def.catchValue({get error(){return new bu(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new bu(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}U1.create=(e,t)=>new U1({innerType:e,typeName:li.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...wi(t)});class VA extends Oi{_parse(t){if(this._getType(t)!==nn.nan){const n=this._getOrReturnCtx(t);return Yr(n,{code:Rr.invalid_type,expected:nn.nan,received:n.parsedType}),di}return{status:"valid",value:t.data}}}VA.create=e=>new VA({typeName:li.ZodNaN,...wi(e)});const nge=Symbol("zod_brand");class d3 extends Oi{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Yw extends Oi{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const l=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?di:l.status==="dirty"?(r.dirty(),J_(l.value)):this._def.out._parseAsync({data:l.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?di:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new Yw({in:t,out:r,typeName:li.ZodPipeline})}}class $1 extends Oi{_parse(t){const r=this._def.innerType._parse(t),n=a=>(Pv(a)&&(a.value=Object.freeze(a.value)),a);return R1(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}$1.create=(e,t)=>new $1({innerType:e,typeName:li.ZodReadonly,...wi(t)});function nV(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function iZ(e,t={},r){return e?bx.create().superRefine((n,a)=>{var l,h;const i=e(n);if(i instanceof Promise)return i.then(_=>{var w,A;if(!_){const C=nV(t,n),R=(A=(w=C.fatal)!==null&&w!==void 0?w:r)!==null&&A!==void 0?A:!0;a.addIssue({code:"custom",...C,fatal:R})}});if(!i){const _=nV(t,n),w=(h=(l=_.fatal)!==null&&l!==void 0?l:r)!==null&&h!==void 0?h:!0;a.addIssue({code:"custom",..._,fatal:w})}}):bx.create()}const ige={object:Oo.lazycreate};var li;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(li||(li={}));const age=(e,t={message:`Input not instance of ${e.name}`})=>iZ(r=>r instanceof e,t),aZ=Ch.create,oZ=Dg.create,oge=VA.create,sge=Lg.create,sZ=k1.create,lge=Ev.create,cge=zA.create,uge=j1.create,dge=N1.create,hge=bx.create,fge=vv.create,pge=um.create,mge=FA.create,gge=Oh.create,yge=Oo.create,vge=Oo.strictCreate,_ge=I1.create,xge=SP.create,bge=D1.create,wge=Kf.create,Sge=L1.create,Age=BA.create,Tge=Cv.create,Pge=fx.create,Ege=z1.create,Cge=F1.create,Mge=zg.create,Oge=B1.create,Rge=wx.create,iV=zh.create,kge=Ff.create,jge=Fg.create,Nge=zh.createWithPreprocess,Ige=Yw.create,Dge=()=>aZ().optional(),Lge=()=>oZ().optional(),zge=()=>sZ().optional(),Fge={string:e=>Ch.create({...e,coerce:!0}),number:e=>Dg.create({...e,coerce:!0}),boolean:e=>k1.create({...e,coerce:!0}),bigint:e=>Lg.create({...e,coerce:!0}),date:e=>Ev.create({...e,coerce:!0})},Bge=di;var en=Object.freeze({__proto__:null,defaultErrorMap:xx,setErrorMap:Nme,getErrorMap:IA,makeIssue:DA,EMPTY_PATH:Ime,addIssueToContext:Yr,ParseStatus:Ul,INVALID:di,DIRTY:J_,OK:cc,isAborted:nN,isDirty:iN,isValid:Pv,isAsync:R1,get util(){return Yi},get objectUtil(){return rN},ZodParsedType:nn,getParsedType:Xp,ZodType:Oi,datetimeRegex:rZ,ZodString:Ch,ZodNumber:Dg,ZodBigInt:Lg,ZodBoolean:k1,ZodDate:Ev,ZodSymbol:zA,ZodUndefined:j1,ZodNull:N1,ZodAny:bx,ZodUnknown:vv,ZodNever:um,ZodVoid:FA,ZodArray:Oh,ZodObject:Oo,ZodUnion:I1,ZodDiscriminatedUnion:SP,ZodIntersection:D1,ZodTuple:Kf,ZodRecord:L1,ZodMap:BA,ZodSet:Cv,ZodFunction:fx,ZodLazy:z1,ZodLiteral:F1,ZodEnum:zg,ZodNativeEnum:B1,ZodPromise:wx,ZodEffects:zh,ZodTransformer:zh,ZodOptional:Ff,ZodNullable:Fg,ZodDefault:V1,ZodCatch:U1,ZodNaN:VA,BRAND:nge,ZodBranded:d3,ZodPipeline:Yw,ZodReadonly:$1,custom:iZ,Schema:Oi,ZodSchema:Oi,late:ige,get ZodFirstPartyTypeKind(){return li},coerce:Fge,any:hge,array:gge,bigint:sge,boolean:sZ,date:lge,discriminatedUnion:xge,effect:iV,enum:Mge,function:Pge,instanceof:age,intersection:bge,lazy:Ege,literal:Cge,map:Age,nan:oge,nativeEnum:Oge,never:pge,null:dge,nullable:jge,number:oZ,object:yge,oboolean:zge,onumber:Lge,optional:kge,ostring:Dge,pipeline:Ige,preprocess:Nge,promise:Rge,record:Sge,set:Tge,strictObject:vge,string:aZ,symbol:cge,transformer:iV,tuple:wge,undefined:uge,union:_ge,unknown:fge,void:mge,NEVER:Bge,ZodIssueCode:Rr,quotelessJson:jme,ZodError:bu});const Vge=en.object({email:en.string().email(),password:en.string().min(6,{message:"Password must be at least 6 characters long"})}),lZ=en.object({plateNo:en.union([en.string().min(1,{message:"Plate number is required"}),en.array(en.string().min(1,{message:"Each plate number must not be empty"})).min(1,{message:"At least one plate number is required"})]).transform(e=>typeof e=="string"?e.split(",").map(t=>t.trim()).filter(t=>t.length>0):e),fileNo:en.string().optional(),ownerRepresentativeName:en.string().min(1,{message:"Owner/Representative name is required"}),purok:en.string().optional(),barangay:en.string().min(1,{message:"Barangay is required"}),municipality:en.string().min(1,{message:"Municipality is required"}),province:en.string().min(1,{message:"Province is required"}),contactNumber:en.string().optional(),emailAddress:en.string().email({message:"Invalid email format"}).optional().or(en.literal("")),hasDriversLicense:en.boolean({required_error:"Please specify if you have a driver's license"}),driversLicenseNumber:en.string().optional(),birthDate:en.date().optional()}).refine(e=>!(e.hasDriversLicense&&!e.driversLicenseNumber),{message:"Driver's license number is required when you have a driver's license",path:["driversLicenseNumber"]}),cZ=en.object({plateNo:en.string().min(1,{message:"Plate number is required"}),fileNo:en.string().min(1,{message:"File number is required"}),engineNo:en.string().min(1,{message:"Engine number is required"}),chassisNo:en.string().min(1,{message:"Chassis number is required"}),make:en.string().min(1,{message:"Make is required"}),bodyType:en.string().min(1,{message:"Body type is required"}),color:en.string().min(1,{message:"Color is required"}),classification:en.string().min(1,{message:"Classification is required"}),dateOfRenewal:en.date().optional(),driver:en.string().optional()}),uZ=en.object({accident_id:en.string().optional(),plateNo:en.string().min(1,{message:"Plate number is required"}),accident_date:en.date({required_error:"Accident date is required"}),street:en.string().min(1,{message:"Street is required"}),barangay:en.string().min(1,{message:"Barangay is required"}),municipality:en.string().min(1,{message:"Municipality is required"}),vehicle_type:en.string().min(1,{message:"Vehicle type is required"}),severity:en.string().min(1,{message:"Severity is required"}),notes:en.string().optional()}),dZ=en.object({topNo:en.string().optional(),firstName:en.string().optional().nullable(),middleInitial:en.string().optional().nullable(),lastName:en.string().optional().nullable(),suffix:en.string().optional().nullable(),violations:en.array(en.string()).optional().nullable(),violationType:en.enum(["confiscated","alarm","impounded"],{required_error:"Violation type is required"}),licenseType:en.string().optional().nullable(),plateNo:en.string().min(1,{message:"Plate number is required"}),dateOfApprehension:en.date({required_error:"Date of apprehension is required"}),apprehendingOfficer:en.string().min(1,{message:"Apprehending officer is required"}),chassisNo:en.string().optional().nullable(),engineNo:en.string().optional().nullable()}).refine(e=>!(e.middleInitial&&e.middleInitial!==null&&e.middleInitial.trim()!==""&&e.middleInitial.length>1),{message:"Middle initial must be 1 character",path:["middleInitial"]}).refine(e=>!(e.licenseType&&e.licenseType!==null&&e.licenseType.trim()!==""&&!["SP","DL","CL","plate","sp receipt","dl receipt","refuse to sur.","dl tempor"].includes(e.licenseType)),{message:"License type must be SP, DL, CL, plate, sp receipt, dl receipt, refuse to sur., or dl tempor",path:["licenseType"]}),Uge=u0("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),$ge=K.forwardRef(({className:e,variant:t,...r},n)=>f.jsx("div",{ref:n,role:"alert",className:Gt(Uge({variant:t}),e),...r}));$ge.displayName="Alert";const qge=K.forwardRef(({className:e,...t},r)=>f.jsx("h5",{ref:r,className:Gt("mb-1 font-medium leading-none tracking-tight",e),...t}));qge.displayName="AlertTitle";const Gge=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("text-sm [&_p]:leading-relaxed",e),...t}));Gge.displayName="AlertDescription";const aV=(e,t,r)=>{if(e&&"reportValidity"in e){const n=qr(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},hZ=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?aV(n.ref,r,e):n&&n.refs&&n.refs.forEach(a=>aV(a,r,e))}},Kge=(e,t)=>{t.shouldUseNativeValidation&&hZ(e,t);const r={};for(const n in e){const a=qr(t.fields,n),l=Object.assign(e[n]||{},{ref:a&&a.ref});if(Wge(t.names||Object.keys(e),n)){const h=Object.assign({},qr(r,n));ba(h,"root",l),ba(r,n,h)}else ba(r,n,l)}return r},Wge=(e,t)=>{const r=oV(t);return e.some(n=>oV(n).match(`^${r}\\.\\d+`))};function oV(e){return e.replace(/\]|\[/g,"")}function Hge(e,t){for(var r={};e.length;){var n=e[0],a=n.code,l=n.message,h=n.path.join(".");if(!r[h])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];r[h]={message:i.message,type:i.code}}else r[h]={message:l,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(A){return A.errors.forEach(function(C){return e.push(C)})}),t){var _=r[h].types,w=_&&_[n.code];r[h]=GH(h,t,r,a,w?[].concat(w,n.message):n.message)}e.shift()}return r}function $h(e,t,r){return r===void 0&&(r={}),function(n,a,l){try{return Promise.resolve(function(h,i){try{var _=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(w){return l.shouldUseNativeValidation&&hZ({},l),{errors:{},values:r.raw?Object.assign({},n):w}})}catch(w){return i(w)}return _&&_.then?_.then(void 0,i):_}(0,function(h){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(h))return{values:{},errors:Kge(Hge(h.errors,!l.shouldUseNativeValidation&&l.criteriaMode==="all"),l)};throw h}))}catch(h){return Promise.reject(h)}}}const $v=vme,fZ=K.createContext({}),qn=({...e})=>f.jsx(fZ.Provider,{value:{name:e.name},children:f.jsx(bme,{...e})}),AP=()=>{const e=K.useContext(fZ),t=K.useContext(pZ),{getFieldState:r,formState:n}=wP(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return{id:l,name:e.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...a}},pZ=K.createContext({}),Dn=K.forwardRef(({className:e,...t},r)=>{const n=K.useId();return f.jsx(pZ.Provider,{value:{id:n},children:f.jsx("div",{ref:r,className:Gt("space-y-2",e),...t})})});Dn.displayName="FormItem";const Ln=K.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=AP();return f.jsx(ha,{ref:r,className:Gt(n&&"text-destructive",e),htmlFor:a,...t})});Ln.displayName="FormLabel";const Nn=K.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:l}=AP();return f.jsx(Vl,{ref:t,id:n,"aria-describedby":r?`${a} ${l}`:`${a}`,"aria-invalid":!!r,...e})});Nn.displayName="FormControl";const Zge=K.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=AP();return f.jsx("p",{ref:r,id:n,className:Gt("text-[0.8rem] text-muted-foreground",e),...t})});Zge.displayName="FormDescription";const zn=K.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:l}=AP(),h=a?String((a==null?void 0:a.message)??""):t;return h?f.jsx("p",{ref:n,id:l,className:Gt("text-[0.8rem] font-medium text-destructive",e),...r,children:h}):null});zn.displayName="FormMessage";function mZ(e,t){return function(){return e.apply(t,arguments)}}const{toString:Yge}=Object.prototype,{getPrototypeOf:h3}=Object,TP=(e=>t=>{const r=Yge.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),qh=e=>(e=e.toLowerCase(),t=>TP(t)===e),PP=e=>t=>typeof t===e,{isArray:y0}=Array,q1=PP("undefined");function Xge(e){return e!==null&&!q1(e)&&e.constructor!==null&&!q1(e.constructor)&&wu(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const gZ=qh("ArrayBuffer");function Jge(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&gZ(e.buffer),t}const Qge=PP("string"),wu=PP("function"),yZ=PP("number"),EP=e=>e!==null&&typeof e=="object",eye=e=>e===!0||e===!1,uA=e=>{if(TP(e)!=="object")return!1;const t=h3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},tye=qh("Date"),rye=qh("File"),nye=qh("Blob"),iye=qh("FileList"),aye=e=>EP(e)&&wu(e.pipe),oye=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||wu(e.append)&&((t=TP(e))==="formdata"||t==="object"&&wu(e.toString)&&e.toString()==="[object FormData]"))},sye=qh("URLSearchParams"),[lye,cye,uye,dye]=["ReadableStream","Request","Response","Headers"].map(qh),hye=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xw(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),y0(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),h=l.length;let i;for(n=0;n<h;n++)i=l[n],t.call(null,e[i],i,e)}}function vZ(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const uv=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_Z=e=>!q1(e)&&e!==uv;function oN(){const{caseless:e}=_Z(this)&&this||{},t={},r=(n,a)=>{const l=e&&vZ(t,a)||a;uA(t[l])&&uA(n)?t[l]=oN(t[l],n):uA(n)?t[l]=oN({},n):y0(n)?t[l]=n.slice():t[l]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Xw(arguments[n],r);return t}const fye=(e,t,r,{allOwnKeys:n}={})=>(Xw(t,(a,l)=>{r&&wu(a)?e[l]=mZ(a,r):e[l]=a},{allOwnKeys:n}),e),pye=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),mye=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},gye=(e,t,r,n)=>{let a,l,h;const i={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),l=a.length;l-- >0;)h=a[l],(!n||n(h,e,t))&&!i[h]&&(t[h]=e[h],i[h]=!0);e=r!==!1&&h3(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},yye=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},vye=e=>{if(!e)return null;if(y0(e))return e;let t=e.length;if(!yZ(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},_ye=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&h3(Uint8Array)),xye=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const l=a.value;t.call(e,l[0],l[1])}},bye=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},wye=qh("HTMLFormElement"),Sye=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),sV=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),Aye=qh("RegExp"),xZ=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Xw(r,(a,l)=>{let h;(h=t(a,l,e))!==!1&&(n[l]=h||a)}),Object.defineProperties(e,n)},Tye=e=>{xZ(e,(t,r)=>{if(wu(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(wu(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Pye=(e,t)=>{const r={},n=a=>{a.forEach(l=>{r[l]=!0})};return y0(e)?n(e):n(String(e).split(t)),r},Eye=()=>{},Cye=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function Mye(e){return!!(e&&wu(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const Oye=e=>{const t=new Array(10),r=(n,a)=>{if(EP(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const l=y0(n)?[]:{};return Xw(n,(h,i)=>{const _=r(h,a+1);!q1(_)&&(l[i]=_)}),t[a]=void 0,l}}return n};return r(e,0)},Rye=qh("AsyncFunction"),kye=e=>e&&(EP(e)||wu(e))&&wu(e.then)&&wu(e.catch),bZ=((e,t)=>e?setImmediate:t?((r,n)=>(uv.addEventListener("message",({source:a,data:l})=>{a===uv&&l===r&&n.length&&n.shift()()},!1),a=>{n.push(a),uv.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",wu(uv.postMessage)),jye=typeof queueMicrotask<"u"?queueMicrotask.bind(uv):typeof process<"u"&&process.nextTick||bZ,rr={isArray:y0,isArrayBuffer:gZ,isBuffer:Xge,isFormData:oye,isArrayBufferView:Jge,isString:Qge,isNumber:yZ,isBoolean:eye,isObject:EP,isPlainObject:uA,isReadableStream:lye,isRequest:cye,isResponse:uye,isHeaders:dye,isUndefined:q1,isDate:tye,isFile:rye,isBlob:nye,isRegExp:Aye,isFunction:wu,isStream:aye,isURLSearchParams:sye,isTypedArray:_ye,isFileList:iye,forEach:Xw,merge:oN,extend:fye,trim:hye,stripBOM:pye,inherits:mye,toFlatObject:gye,kindOf:TP,kindOfTest:qh,endsWith:yye,toArray:vye,forEachEntry:xye,matchAll:bye,isHTMLForm:wye,hasOwnProperty:sV,hasOwnProp:sV,reduceDescriptors:xZ,freezeMethods:Tye,toObjectSet:Pye,toCamelCase:Sye,noop:Eye,toFiniteNumber:Cye,findKey:vZ,global:uv,isContextDefined:_Z,isSpecCompliantForm:Mye,toJSONObject:Oye,isAsyncFn:Rye,isThenable:kye,setImmediate:bZ,asap:jye};function bi(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}rr.inherits(bi,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:rr.toJSONObject(this.config),code:this.code,status:this.status}}});const wZ=bi.prototype,SZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{SZ[e]={value:e}});Object.defineProperties(bi,SZ);Object.defineProperty(wZ,"isAxiosError",{value:!0});bi.from=(e,t,r,n,a,l)=>{const h=Object.create(wZ);return rr.toFlatObject(e,h,function(_){return _!==Error.prototype},i=>i!=="isAxiosError"),bi.call(h,e.message,t,r,n,a),h.cause=e,h.name=e.name,l&&Object.assign(h,l),h};const Nye=null;function sN(e){return rr.isPlainObject(e)||rr.isArray(e)}function AZ(e){return rr.endsWith(e,"[]")?e.slice(0,-2):e}function lV(e,t,r){return e?e.concat(t).map(function(a,l){return a=AZ(a),!r&&l?"["+a+"]":a}).join(r?".":""):t}function Iye(e){return rr.isArray(e)&&!e.some(sN)}const Dye=rr.toFlatObject(rr,{},null,function(t){return/^is[A-Z]/.test(t)});function CP(e,t,r){if(!rr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=rr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(U,G){return!rr.isUndefined(G[U])});const n=r.metaTokens,a=r.visitor||A,l=r.dots,h=r.indexes,_=(r.Blob||typeof Blob<"u"&&Blob)&&rr.isSpecCompliantForm(t);if(!rr.isFunction(a))throw new TypeError("visitor must be a function");function w(V){if(V===null)return"";if(rr.isDate(V))return V.toISOString();if(!_&&rr.isBlob(V))throw new bi("Blob is not supported. Use a Buffer instead.");return rr.isArrayBuffer(V)||rr.isTypedArray(V)?_&&typeof Blob=="function"?new Blob([V]):Buffer.from(V):V}function A(V,U,G){let H=V;if(V&&!G&&typeof V=="object"){if(rr.endsWith(U,"{}"))U=n?U:U.slice(0,-2),V=JSON.stringify(V);else if(rr.isArray(V)&&Iye(V)||(rr.isFileList(V)||rr.endsWith(U,"[]"))&&(H=rr.toArray(V)))return U=AZ(U),H.forEach(function(Q,le){!(rr.isUndefined(Q)||Q===null)&&t.append(h===!0?lV([U],le,l):h===null?U:U+"[]",w(Q))}),!1}return sN(V)?!0:(t.append(lV(G,U,l),w(V)),!1)}const C=[],R=Object.assign(Dye,{defaultVisitor:A,convertValue:w,isVisitable:sN});function z(V,U){if(!rr.isUndefined(V)){if(C.indexOf(V)!==-1)throw Error("Circular reference detected in "+U.join("."));C.push(V),rr.forEach(V,function(H,J){(!(rr.isUndefined(H)||H===null)&&a.call(t,H,rr.isString(J)?J.trim():J,U,R))===!0&&z(H,U?U.concat(J):[J])}),C.pop()}}if(!rr.isObject(e))throw new TypeError("data must be an object");return z(e),t}function cV(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function f3(e,t){this._pairs=[],e&&CP(e,this,t)}const TZ=f3.prototype;TZ.append=function(t,r){this._pairs.push([t,r])};TZ.toString=function(t){const r=t?function(n){return t.call(this,n,cV)}:cV;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function Lye(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function PZ(e,t,r){if(!t)return e;const n=r&&r.encode||Lye;rr.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let l;if(a?l=a(t,r):l=rr.isURLSearchParams(t)?t.toString():new f3(t,r).toString(n),l){const h=e.indexOf("#");h!==-1&&(e=e.slice(0,h)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class uV{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){rr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const EZ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},zye=typeof URLSearchParams<"u"?URLSearchParams:f3,Fye=typeof FormData<"u"?FormData:null,Bye=typeof Blob<"u"?Blob:null,Vye={isBrowser:!0,classes:{URLSearchParams:zye,FormData:Fye,Blob:Bye},protocols:["http","https","file","blob","url","data"]},p3=typeof window<"u"&&typeof document<"u",lN=typeof navigator=="object"&&navigator||void 0,Uye=p3&&(!lN||["ReactNative","NativeScript","NS"].indexOf(lN.product)<0),$ye=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qye=p3&&window.location.href||"http://localhost",Gye=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:p3,hasStandardBrowserEnv:Uye,hasStandardBrowserWebWorkerEnv:$ye,navigator:lN,origin:qye},Symbol.toStringTag,{value:"Module"})),zl={...Gye,...Vye};function Kye(e,t){return CP(e,new zl.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,l){return zl.isNode&&rr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function Wye(e){return rr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Hye(e){const t={},r=Object.keys(e);let n;const a=r.length;let l;for(n=0;n<a;n++)l=r[n],t[l]=e[l];return t}function CZ(e){function t(r,n,a,l){let h=r[l++];if(h==="__proto__")return!0;const i=Number.isFinite(+h),_=l>=r.length;return h=!h&&rr.isArray(a)?a.length:h,_?(rr.hasOwnProp(a,h)?a[h]=[a[h],n]:a[h]=n,!i):((!a[h]||!rr.isObject(a[h]))&&(a[h]=[]),t(r,n,a[h],l)&&rr.isArray(a[h])&&(a[h]=Hye(a[h])),!i)}if(rr.isFormData(e)&&rr.isFunction(e.entries)){const r={};return rr.forEachEntry(e,(n,a)=>{t(Wye(n),a,r,0)}),r}return null}function Zye(e,t,r){if(rr.isString(e))try{return(t||JSON.parse)(e),rr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Jw={transitional:EZ,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,l=rr.isObject(t);if(l&&rr.isHTMLForm(t)&&(t=new FormData(t)),rr.isFormData(t))return a?JSON.stringify(CZ(t)):t;if(rr.isArrayBuffer(t)||rr.isBuffer(t)||rr.isStream(t)||rr.isFile(t)||rr.isBlob(t)||rr.isReadableStream(t))return t;if(rr.isArrayBufferView(t))return t.buffer;if(rr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Kye(t,this.formSerializer).toString();if((i=rr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const _=this.env&&this.env.FormData;return CP(i?{"files[]":t}:t,_&&new _,this.formSerializer)}}return l||a?(r.setContentType("application/json",!1),Zye(t)):t}],transformResponse:[function(t){const r=this.transitional||Jw.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(rr.isResponse(t)||rr.isReadableStream(t))return t;if(t&&rr.isString(t)&&(n&&!this.responseType||a)){const h=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(i){if(h)throw i.name==="SyntaxError"?bi.from(i,bi.ERR_BAD_RESPONSE,this,null,this.response):i}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:zl.classes.FormData,Blob:zl.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};rr.forEach(["delete","get","head","post","put","patch"],e=>{Jw.headers[e]={}});const Yye=rr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Xye=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(h){a=h.indexOf(":"),r=h.substring(0,a).trim().toLowerCase(),n=h.substring(a+1).trim(),!(!r||t[r]&&Yye[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},dV=Symbol("internals");function Ib(e){return e&&String(e).trim().toLowerCase()}function dA(e){return e===!1||e==null?e:rr.isArray(e)?e.map(dA):String(e)}function Jye(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const Qye=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function iM(e,t,r,n,a){if(rr.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!rr.isString(t)){if(rr.isString(n))return t.indexOf(n)!==-1;if(rr.isRegExp(n))return n.test(t)}}function eve(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function tve(e,t){const r=rr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,l,h){return this[n].call(this,t,a,l,h)},configurable:!0})})}let Lc=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function l(i,_,w){const A=Ib(_);if(!A)throw new Error("header name must be a non-empty string");const C=rr.findKey(a,A);(!C||a[C]===void 0||w===!0||w===void 0&&a[C]!==!1)&&(a[C||_]=dA(i))}const h=(i,_)=>rr.forEach(i,(w,A)=>l(w,A,_));if(rr.isPlainObject(t)||t instanceof this.constructor)h(t,r);else if(rr.isString(t)&&(t=t.trim())&&!Qye(t))h(Xye(t),r);else if(rr.isHeaders(t))for(const[i,_]of t.entries())l(_,i,n);else t!=null&&l(r,t,n);return this}get(t,r){if(t=Ib(t),t){const n=rr.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return Jye(a);if(rr.isFunction(r))return r.call(this,a,n);if(rr.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ib(t),t){const n=rr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||iM(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function l(h){if(h=Ib(h),h){const i=rr.findKey(n,h);i&&(!r||iM(n,n[i],i,r))&&(delete n[i],a=!0)}}return rr.isArray(t)?t.forEach(l):l(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const l=r[n];(!t||iM(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const r=this,n={};return rr.forEach(this,(a,l)=>{const h=rr.findKey(n,l);if(h){r[h]=dA(a),delete r[l];return}const i=t?eve(l):String(l).trim();i!==l&&delete r[l],r[i]=dA(a),n[i]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return rr.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&rr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[dV]=this[dV]={accessors:{}}).accessors,a=this.prototype;function l(h){const i=Ib(h);n[i]||(tve(a,h),n[i]=!0)}return rr.isArray(t)?t.forEach(l):l(t),this}};Lc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);rr.reduceDescriptors(Lc.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});rr.freezeMethods(Lc);function aM(e,t){const r=this||Jw,n=t||r,a=Lc.from(n.headers);let l=n.data;return rr.forEach(e,function(i){l=i.call(r,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function MZ(e){return!!(e&&e.__CANCEL__)}function v0(e,t,r){bi.call(this,e??"canceled",bi.ERR_CANCELED,t,r),this.name="CanceledError"}rr.inherits(v0,bi,{__CANCEL__:!0});function OZ(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new bi("Request failed with status code "+r.status,[bi.ERR_BAD_REQUEST,bi.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function rve(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function nve(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,l=0,h;return t=t!==void 0?t:1e3,function(_){const w=Date.now(),A=n[l];h||(h=w),r[a]=_,n[a]=w;let C=l,R=0;for(;C!==a;)R+=r[C++],C=C%e;if(a=(a+1)%e,a===l&&(l=(l+1)%e),w-h<t)return;const z=A&&w-A;return z?Math.round(R*1e3/z):void 0}}function ive(e,t){let r=0,n=1e3/t,a,l;const h=(w,A=Date.now())=>{r=A,a=null,l&&(clearTimeout(l),l=null),e.apply(null,w)};return[(...w)=>{const A=Date.now(),C=A-r;C>=n?h(w,A):(a=w,l||(l=setTimeout(()=>{l=null,h(a)},n-C)))},()=>a&&h(a)]}const UA=(e,t,r=3)=>{let n=0;const a=nve(50,250);return ive(l=>{const h=l.loaded,i=l.lengthComputable?l.total:void 0,_=h-n,w=a(_),A=h<=i;n=h;const C={loaded:h,total:i,progress:i?h/i:void 0,bytes:_,rate:w||void 0,estimated:w&&i&&A?(i-h)/w:void 0,event:l,lengthComputable:i!=null,[t?"download":"upload"]:!0};e(C)},r)},hV=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},fV=e=>(...t)=>rr.asap(()=>e(...t)),ave=zl.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,zl.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(zl.origin),zl.navigator&&/(msie|trident)/i.test(zl.navigator.userAgent)):()=>!0,ove=zl.hasStandardBrowserEnv?{write(e,t,r,n,a,l){const h=[e+"="+encodeURIComponent(t)];rr.isNumber(r)&&h.push("expires="+new Date(r).toGMTString()),rr.isString(n)&&h.push("path="+n),rr.isString(a)&&h.push("domain="+a),l===!0&&h.push("secure"),document.cookie=h.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function sve(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function lve(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function RZ(e,t,r){let n=!sve(t);return e&&n||r==!1?lve(e,t):t}const pV=e=>e instanceof Lc?{...e}:e;function Mv(e,t){t=t||{};const r={};function n(w,A,C,R){return rr.isPlainObject(w)&&rr.isPlainObject(A)?rr.merge.call({caseless:R},w,A):rr.isPlainObject(A)?rr.merge({},A):rr.isArray(A)?A.slice():A}function a(w,A,C,R){if(rr.isUndefined(A)){if(!rr.isUndefined(w))return n(void 0,w,C,R)}else return n(w,A,C,R)}function l(w,A){if(!rr.isUndefined(A))return n(void 0,A)}function h(w,A){if(rr.isUndefined(A)){if(!rr.isUndefined(w))return n(void 0,w)}else return n(void 0,A)}function i(w,A,C){if(C in t)return n(w,A);if(C in e)return n(void 0,w)}const _={url:l,method:l,data:l,baseURL:h,transformRequest:h,transformResponse:h,paramsSerializer:h,timeout:h,timeoutMessage:h,withCredentials:h,withXSRFToken:h,adapter:h,responseType:h,xsrfCookieName:h,xsrfHeaderName:h,onUploadProgress:h,onDownloadProgress:h,decompress:h,maxContentLength:h,maxBodyLength:h,beforeRedirect:h,transport:h,httpAgent:h,httpsAgent:h,cancelToken:h,socketPath:h,responseEncoding:h,validateStatus:i,headers:(w,A,C)=>a(pV(w),pV(A),C,!0)};return rr.forEach(Object.keys(Object.assign({},e,t)),function(A){const C=_[A]||a,R=C(e[A],t[A],A);rr.isUndefined(R)&&C!==i||(r[A]=R)}),r}const kZ=e=>{const t=Mv({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:l,headers:h,auth:i}=t;t.headers=h=Lc.from(h),t.url=PZ(RZ(t.baseURL,t.url),e.params,e.paramsSerializer),i&&h.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):"")));let _;if(rr.isFormData(r)){if(zl.hasStandardBrowserEnv||zl.hasStandardBrowserWebWorkerEnv)h.setContentType(void 0);else if((_=h.getContentType())!==!1){const[w,...A]=_?_.split(";").map(C=>C.trim()).filter(Boolean):[];h.setContentType([w||"multipart/form-data",...A].join("; "))}}if(zl.hasStandardBrowserEnv&&(n&&rr.isFunction(n)&&(n=n(t)),n||n!==!1&&ave(t.url))){const w=a&&l&&ove.read(l);w&&h.set(a,w)}return t},cve=typeof XMLHttpRequest<"u",uve=cve&&function(e){return new Promise(function(r,n){const a=kZ(e);let l=a.data;const h=Lc.from(a.headers).normalize();let{responseType:i,onUploadProgress:_,onDownloadProgress:w}=a,A,C,R,z,V;function U(){z&&z(),V&&V(),a.cancelToken&&a.cancelToken.unsubscribe(A),a.signal&&a.signal.removeEventListener("abort",A)}let G=new XMLHttpRequest;G.open(a.method.toUpperCase(),a.url,!0),G.timeout=a.timeout;function H(){if(!G)return;const Q=Lc.from("getAllResponseHeaders"in G&&G.getAllResponseHeaders()),ne={data:!i||i==="text"||i==="json"?G.responseText:G.response,status:G.status,statusText:G.statusText,headers:Q,config:e,request:G};OZ(function(ue){r(ue),U()},function(ue){n(ue),U()},ne),G=null}"onloadend"in G?G.onloadend=H:G.onreadystatechange=function(){!G||G.readyState!==4||G.status===0&&!(G.responseURL&&G.responseURL.indexOf("file:")===0)||setTimeout(H)},G.onabort=function(){G&&(n(new bi("Request aborted",bi.ECONNABORTED,e,G)),G=null)},G.onerror=function(){n(new bi("Network Error",bi.ERR_NETWORK,e,G)),G=null},G.ontimeout=function(){let le=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const ne=a.transitional||EZ;a.timeoutErrorMessage&&(le=a.timeoutErrorMessage),n(new bi(le,ne.clarifyTimeoutError?bi.ETIMEDOUT:bi.ECONNABORTED,e,G)),G=null},l===void 0&&h.setContentType(null),"setRequestHeader"in G&&rr.forEach(h.toJSON(),function(le,ne){G.setRequestHeader(ne,le)}),rr.isUndefined(a.withCredentials)||(G.withCredentials=!!a.withCredentials),i&&i!=="json"&&(G.responseType=a.responseType),w&&([R,V]=UA(w,!0),G.addEventListener("progress",R)),_&&G.upload&&([C,z]=UA(_),G.upload.addEventListener("progress",C),G.upload.addEventListener("loadend",z)),(a.cancelToken||a.signal)&&(A=Q=>{G&&(n(!Q||Q.type?new v0(null,e,G):Q),G.abort(),G=null)},a.cancelToken&&a.cancelToken.subscribe(A),a.signal&&(a.signal.aborted?A():a.signal.addEventListener("abort",A)));const J=rve(a.url);if(J&&zl.protocols.indexOf(J)===-1){n(new bi("Unsupported protocol "+J+":",bi.ERR_BAD_REQUEST,e));return}G.send(l||null)})},dve=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const l=function(w){if(!a){a=!0,i();const A=w instanceof Error?w:this.reason;n.abort(A instanceof bi?A:new v0(A instanceof Error?A.message:A))}};let h=t&&setTimeout(()=>{h=null,l(new bi(`timeout ${t} of ms exceeded`,bi.ETIMEDOUT))},t);const i=()=>{e&&(h&&clearTimeout(h),h=null,e.forEach(w=>{w.unsubscribe?w.unsubscribe(l):w.removeEventListener("abort",l)}),e=null)};e.forEach(w=>w.addEventListener("abort",l));const{signal:_}=n;return _.unsubscribe=()=>rr.asap(i),_}},hve=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},fve=async function*(e,t){for await(const r of pve(e))yield*hve(r,t)},pve=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},mV=(e,t,r,n)=>{const a=fve(e,t);let l=0,h,i=_=>{h||(h=!0,n&&n(_))};return new ReadableStream({async pull(_){try{const{done:w,value:A}=await a.next();if(w){i(),_.close();return}let C=A.byteLength;if(r){let R=l+=C;r(R)}_.enqueue(new Uint8Array(A))}catch(w){throw i(w),w}},cancel(_){return i(_),a.return()}},{highWaterMark:2})},MP=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",jZ=MP&&typeof ReadableStream=="function",mve=MP&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),NZ=(e,...t)=>{try{return!!e(...t)}catch{return!1}},gve=jZ&&NZ(()=>{let e=!1;const t=new Request(zl.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),gV=64*1024,cN=jZ&&NZ(()=>rr.isReadableStream(new Response("").body)),$A={stream:cN&&(e=>e.body)};MP&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!$A[t]&&($A[t]=rr.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new bi(`Response type '${t}' is not supported`,bi.ERR_NOT_SUPPORT,n)})})})(new Response);const yve=async e=>{if(e==null)return 0;if(rr.isBlob(e))return e.size;if(rr.isSpecCompliantForm(e))return(await new Request(zl.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(rr.isArrayBufferView(e)||rr.isArrayBuffer(e))return e.byteLength;if(rr.isURLSearchParams(e)&&(e=e+""),rr.isString(e))return(await mve(e)).byteLength},vve=async(e,t)=>{const r=rr.toFiniteNumber(e.getContentLength());return r??yve(t)},_ve=MP&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:l,timeout:h,onDownloadProgress:i,onUploadProgress:_,responseType:w,headers:A,withCredentials:C="same-origin",fetchOptions:R}=kZ(e);w=w?(w+"").toLowerCase():"text";let z=dve([a,l&&l.toAbortSignal()],h),V;const U=z&&z.unsubscribe&&(()=>{z.unsubscribe()});let G;try{if(_&&gve&&r!=="get"&&r!=="head"&&(G=await vve(A,n))!==0){let ne=new Request(t,{method:"POST",body:n,duplex:"half"}),de;if(rr.isFormData(n)&&(de=ne.headers.get("content-type"))&&A.setContentType(de),ne.body){const[ue,ve]=hV(G,UA(fV(_)));n=mV(ne.body,gV,ue,ve)}}rr.isString(C)||(C=C?"include":"omit");const H="credentials"in Request.prototype;V=new Request(t,{...R,signal:z,method:r.toUpperCase(),headers:A.normalize().toJSON(),body:n,duplex:"half",credentials:H?C:void 0});let J=await fetch(V);const Q=cN&&(w==="stream"||w==="response");if(cN&&(i||Q&&U)){const ne={};["status","statusText","headers"].forEach(Ae=>{ne[Ae]=J[Ae]});const de=rr.toFiniteNumber(J.headers.get("content-length")),[ue,ve]=i&&hV(de,UA(fV(i),!0))||[];J=new Response(mV(J.body,gV,ue,()=>{ve&&ve(),U&&U()}),ne)}w=w||"text";let le=await $A[rr.findKey($A,w)||"text"](J,e);return!Q&&U&&U(),await new Promise((ne,de)=>{OZ(ne,de,{data:le,headers:Lc.from(J.headers),status:J.status,statusText:J.statusText,config:e,request:V})})}catch(H){throw U&&U(),H&&H.name==="TypeError"&&/fetch/i.test(H.message)?Object.assign(new bi("Network Error",bi.ERR_NETWORK,e,V),{cause:H.cause||H}):bi.from(H,H&&H.code,e,V)}}),uN={http:Nye,xhr:uve,fetch:_ve};rr.forEach(uN,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const yV=e=>`- ${e}`,xve=e=>rr.isFunction(e)||e===null||e===!1,IZ={getAdapter:e=>{e=rr.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let l=0;l<t;l++){r=e[l];let h;if(n=r,!xve(r)&&(n=uN[(h=String(r)).toLowerCase()],n===void 0))throw new bi(`Unknown adapter '${h}'`);if(n)break;a[h||"#"+l]=n}if(!n){const l=Object.entries(a).map(([i,_])=>`adapter ${i} `+(_===!1?"is not supported by the environment":"is not available in the build"));let h=t?l.length>1?`since :
`+l.map(yV).join(`
`):" "+yV(l[0]):"as no adapter specified";throw new bi("There is no suitable adapter to dispatch the request "+h,"ERR_NOT_SUPPORT")}return n},adapters:uN};function oM(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new v0(null,e)}function vV(e){return oM(e),e.headers=Lc.from(e.headers),e.data=aM.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),IZ.getAdapter(e.adapter||Jw.adapter)(e).then(function(n){return oM(e),n.data=aM.call(e,e.transformResponse,n),n.headers=Lc.from(n.headers),n},function(n){return MZ(n)||(oM(e),n&&n.response&&(n.response.data=aM.call(e,e.transformResponse,n.response),n.response.headers=Lc.from(n.response.headers))),Promise.reject(n)})}const DZ="1.8.2",OP={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{OP[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const _V={};OP.transitional=function(t,r,n){function a(l,h){return"[Axios v"+DZ+"] Transitional option '"+l+"'"+h+(n?". "+n:"")}return(l,h,i)=>{if(t===!1)throw new bi(a(h," has been removed"+(r?" in "+r:"")),bi.ERR_DEPRECATED);return r&&!_V[h]&&(_V[h]=!0,console.warn(a(h," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,h,i):!0}};OP.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function bve(e,t,r){if(typeof e!="object")throw new bi("options must be an object",bi.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const l=n[a],h=t[l];if(h){const i=e[l],_=i===void 0||h(i,l,e);if(_!==!0)throw new bi("option "+l+" must be "+_,bi.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new bi("Unknown option "+l,bi.ERR_BAD_OPTION)}}const hA={assertOptions:bve,validators:OP},Rf=hA.validators;let _v=class{constructor(t){this.defaults=t,this.interceptors={request:new uV,response:new uV}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Mv(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:l}=r;n!==void 0&&hA.assertOptions(n,{silentJSONParsing:Rf.transitional(Rf.boolean),forcedJSONParsing:Rf.transitional(Rf.boolean),clarifyTimeoutError:Rf.transitional(Rf.boolean)},!1),a!=null&&(rr.isFunction(a)?r.paramsSerializer={serialize:a}:hA.assertOptions(a,{encode:Rf.function,serialize:Rf.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),hA.assertOptions(r,{baseUrl:Rf.spelling("baseURL"),withXsrfToken:Rf.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let h=l&&rr.merge(l.common,l[r.method]);l&&rr.forEach(["delete","get","head","post","put","patch","common"],V=>{delete l[V]}),r.headers=Lc.concat(h,l);const i=[];let _=!0;this.interceptors.request.forEach(function(U){typeof U.runWhen=="function"&&U.runWhen(r)===!1||(_=_&&U.synchronous,i.unshift(U.fulfilled,U.rejected))});const w=[];this.interceptors.response.forEach(function(U){w.push(U.fulfilled,U.rejected)});let A,C=0,R;if(!_){const V=[vV.bind(this),void 0];for(V.unshift.apply(V,i),V.push.apply(V,w),R=V.length,A=Promise.resolve(r);C<R;)A=A.then(V[C++],V[C++]);return A}R=i.length;let z=r;for(C=0;C<R;){const V=i[C++],U=i[C++];try{z=V(z)}catch(G){U.call(this,G);break}}try{A=vV.call(this,z)}catch(V){return Promise.reject(V)}for(C=0,R=w.length;C<R;)A=A.then(w[C++],w[C++]);return A}getUri(t){t=Mv(this.defaults,t);const r=RZ(t.baseURL,t.url,t.allowAbsoluteUrls);return PZ(r,t.params,t.paramsSerializer)}};rr.forEach(["delete","get","head","options"],function(t){_v.prototype[t]=function(r,n){return this.request(Mv(n||{},{method:t,url:r,data:(n||{}).data}))}});rr.forEach(["post","put","patch"],function(t){function r(n){return function(l,h,i){return this.request(Mv(i||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:h}))}}_v.prototype[t]=r(),_v.prototype[t+"Form"]=r(!0)});let wve=class LZ{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(a=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](a);n._listeners=null}),this.promise.then=a=>{let l;const h=new Promise(i=>{n.subscribe(i),l=i}).then(a);return h.cancel=function(){n.unsubscribe(l)},h},t(function(l,h,i){n.reason||(n.reason=new v0(l,h,i),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new LZ(function(a){t=a}),cancel:t}}};function Sve(e){return function(r){return e.apply(null,r)}}function Ave(e){return rr.isObject(e)&&e.isAxiosError===!0}const dN={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(dN).forEach(([e,t])=>{dN[t]=e});function zZ(e){const t=new _v(e),r=mZ(_v.prototype.request,t);return rr.extend(r,_v.prototype,t,{allOwnKeys:!0}),rr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return zZ(Mv(e,a))},r}const ns=zZ(Jw);ns.Axios=_v;ns.CanceledError=v0;ns.CancelToken=wve;ns.isCancel=MZ;ns.VERSION=DZ;ns.toFormData=CP;ns.AxiosError=bi;ns.Cancel=ns.CanceledError;ns.all=function(t){return Promise.all(t)};ns.spread=Sve;ns.isAxiosError=Ave;ns.mergeConfig=Mv;ns.AxiosHeaders=Lc;ns.formToJSON=e=>CZ(rr.isHTMLForm(e)?new FormData(e):e);ns.getAdapter=IZ.getAdapter;ns.HttpStatusCode=dN;ns.default=ns;const{Axios:R6e,AxiosError:k6e,CanceledError:j6e,isCancel:N6e,CancelToken:I6e,VERSION:D6e,all:L6e,Cancel:z6e,isAxiosError:F6e,spread:B6e,toFormData:V6e,AxiosHeaders:U6e,HttpStatusCode:$6e,formToJSON:q6e,getAdapter:G6e,mergeConfig:K6e}=ns,Tve="https://ltodatamanager.com/api",Bn=ns.create({baseURL:Tve});Bn.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e));Bn.interceptors.response.use(e=>e,e=>{var t,r,n;return((t=e.response)==null?void 0:t.status)===401&&((n=(r=e.config)==null?void 0:r.url)!=null&&n.includes("/auth/login")||(localStorage.removeItem("token"),localStorage.removeItem("userData"),window.location.href="/login")),Promise.reject(e)});class Jb extends Error{}Jb.prototype.name="InvalidTokenError";function Pve(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function Eve(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Pve(t)}catch{return atob(t)}}function j2(e,t){if(typeof e!="string")throw new Jb("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new Jb(`Invalid token specified: missing part #${r+1}`);let a;try{a=Eve(n)}catch(l){throw new Jb(`Invalid token specified: invalid base64 for part #${r+1} (${l.message})`)}try{return JSON.parse(a)}catch(l){throw new Jb(`Invalid token specified: invalid json for part #${r+1} (${l.message})`)}}var m3="Dialog",[FZ,BZ]=Md(m3),[Cve,Gh]=FZ(m3),VZ=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:h=!0}=e,i=K.useRef(null),_=K.useRef(null),[w=!1,A]=kg({prop:n,defaultProp:a,onChange:l});return f.jsx(Cve,{scope:t,triggerRef:i,contentRef:_,contentId:Ad(),titleId:Ad(),descriptionId:Ad(),open:w,onOpenChange:A,onOpenToggle:K.useCallback(()=>A(C=>!C),[A]),modal:h,children:r})};VZ.displayName=m3;var UZ="DialogTrigger",$Z=K.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Gh(UZ,r),l=Xi(t,a.triggerRef);return f.jsx(mi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":v3(a.open),...n,ref:l,onClick:an(e.onClick,a.onOpenToggle)})});$Z.displayName=UZ;var g3="DialogPortal",[Mve,qZ]=FZ(g3,{forceMount:void 0}),GZ=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,l=Gh(g3,t);return f.jsx(Mve,{scope:t,forceMount:r,children:K.Children.map(n,h=>f.jsx(Ru,{present:r||l.open,children:f.jsx(g0,{asChild:!0,container:a,children:h})}))})};GZ.displayName=g3;var qA="DialogOverlay",KZ=K.forwardRef((e,t)=>{const r=qZ(qA,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=Gh(qA,e.__scopeDialog);return l.modal?f.jsx(Ru,{present:n||l.open,children:f.jsx(Ove,{...a,ref:t})}):null});KZ.displayName=qA;var Ove=K.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Gh(qA,r);return f.jsx(Kw,{as:Vl,allowPinchZoom:!0,shards:[a.contentRef],children:f.jsx(mi.div,{"data-state":v3(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Ov="DialogContent",WZ=K.forwardRef((e,t)=>{const r=qZ(Ov,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,l=Gh(Ov,e.__scopeDialog);return f.jsx(Ru,{present:n||l.open,children:l.modal?f.jsx(Rve,{...a,ref:t}):f.jsx(kve,{...a,ref:t})})});WZ.displayName=Ov;var Rve=K.forwardRef((e,t)=>{const r=Gh(Ov,e.__scopeDialog),n=K.useRef(null),a=Xi(t,r.contentRef,n);return K.useEffect(()=>{const l=n.current;if(l)return yP(l)},[]),f.jsx(HZ,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:an(e.onCloseAutoFocus,l=>{var h;l.preventDefault(),(h=r.triggerRef.current)==null||h.focus()}),onPointerDownOutside:an(e.onPointerDownOutside,l=>{const h=l.detail.originalEvent,i=h.button===0&&h.ctrlKey===!0;(h.button===2||i)&&l.preventDefault()}),onFocusOutside:an(e.onFocusOutside,l=>l.preventDefault())})}),kve=K.forwardRef((e,t)=>{const r=Gh(Ov,e.__scopeDialog),n=K.useRef(!1),a=K.useRef(!1);return f.jsx(HZ,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,w;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=l.target;((w=r.triggerRef.current)==null?void 0:w.contains(h))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),HZ=K.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...h}=e,i=Gh(Ov,r),_=K.useRef(null),w=Xi(t,_);return cP(),f.jsxs(f.Fragment,{children:[f.jsx($w,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:f.jsx(f0,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":v3(i.open),...h,ref:w,onDismiss:()=>i.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(Nve,{titleId:i.titleId}),f.jsx(Dve,{contentRef:_,descriptionId:i.descriptionId})]})]})}),y3="DialogTitle",ZZ=K.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Gh(y3,r);return f.jsx(mi.h2,{id:a.titleId,...n,ref:t})});ZZ.displayName=y3;var YZ="DialogDescription",XZ=K.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Gh(YZ,r);return f.jsx(mi.p,{id:a.descriptionId,...n,ref:t})});XZ.displayName=YZ;var JZ="DialogClose",QZ=K.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Gh(JZ,r);return f.jsx(mi.button,{type:"button",...n,ref:t,onClick:an(e.onClick,()=>a.onOpenChange(!1))})});QZ.displayName=JZ;function v3(e){return e?"open":"closed"}var eY="DialogTitleWarning",[jve,tY]=Sde(eY,{contentName:Ov,titleName:y3,docsSlug:"dialog"}),Nve=({titleId:e})=>{const t=tY(eY),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return K.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Ive="DialogDescriptionWarning",Dve=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${tY(Ive).contentName}}.`;return K.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},_3=VZ,Lve=$Z,x3=GZ,Qw=KZ,eS=WZ,tS=ZZ,rS=XZ,RP=QZ;const _0=_3,zve=x3,rY=K.forwardRef(({className:e,...t},r)=>f.jsx(Qw,{ref:r,className:Gt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));rY.displayName=Qw.displayName;const qv=K.forwardRef(({className:e,children:t,...r},n)=>f.jsxs(zve,{children:[f.jsx(rY,{}),f.jsxs(eS,{ref:n,className:Gt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,f.jsxs(RP,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[f.jsx(P1,{className:"h-4 w-4"}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));qv.displayName=eS.displayName;const Gv=({className:e,...t})=>f.jsx("div",{className:Gt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Gv.displayName="DialogHeader";const x0=({className:e,...t})=>f.jsx("div",{className:Gt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});x0.displayName="DialogFooter";const Kv=K.forwardRef(({className:e,...t},r)=>f.jsx(tS,{ref:r,className:Gt("text-lg font-semibold leading-none tracking-tight",e),...t}));Kv.displayName=tS.displayName;const b0=K.forwardRef(({className:e,...t},r)=>f.jsx(rS,{ref:r,className:Gt("text-sm text-muted-foreground",e),...t}));b0.displayName=rS.displayName;const Fve=({isOpen:e,onClose:t,onSuccess:r,userEmail:n})=>{const[a,l]=K.useState(""),[h,i]=K.useState(!1),[_,w]=K.useState(300),[A,C]=K.useState(!1);K.useEffect(()=>{if(_>0&&e){const U=setTimeout(()=>w(_-1),1e3);return()=>clearTimeout(U)}else _===0&&C(!0)},[_,e]),K.useEffect(()=>{e&&(w(300),C(!1),l(""))},[e]);const R=async U=>{var G,H;if(U.preventDefault(),!a||a.length!==6){Ni.error("Please enter a valid 6-digit OTP");return}i(!0);try{const J=await Bn.post("/auth/verify-otp",{email:n,otp:a});J.data.success?(Ni.success("OTP verified successfully!"),r(J.data.token)):Ni.error(J.data.message||"OTP verification failed")}catch(J){const Q=((H=(G=J.response)==null?void 0:G.data)==null?void 0:H.message)||"OTP verification failed";Ni.error(Q)}finally{i(!1)}},z=async()=>{i(!0);try{Ni.info("Please login again to receive a new OTP"),t()}catch{Ni.error("Failed to resend OTP")}finally{i(!1)}},V=U=>{const G=Math.floor(U/60),H=U%60;return`${G}:${H.toString().padStart(2,"0")}`};return f.jsx(_0,{open:e,onOpenChange:t,children:f.jsxs(qv,{className:"sm:max-w-md",children:[f.jsxs(Gv,{children:[f.jsxs(Kv,{className:"flex items-center gap-2",children:[f.jsx(tde,{className:"h-5 w-5 text-blue-600"}),"OTP Verification Required"]}),f.jsx(b0,{children:"Please enter the 6-digit OTP sent to your email address to complete the login process."})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg",children:[f.jsx(ZK,{className:"h-4 w-4 text-blue-600"}),f.jsxs("span",{className:"text-sm text-blue-800",children:["OTP sent to: ",f.jsx("strong",{children:n})]})]}),f.jsxs("form",{onSubmit:R,className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(ha,{htmlFor:"otp",children:"Enter OTP"}),f.jsx(Fn,{id:"otp",type:"text",placeholder:"000000",value:a,onChange:U=>l(U.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest",disabled:h})]}),f.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Time remaining: ",V(_)]}),A&&f.jsx(Ur,{type:"button",variant:"link",size:"sm",onClick:z,disabled:h,className:"p-0 h-auto",children:"Resend OTP"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(Ur,{type:"button",variant:"outline",onClick:t,disabled:h,className:"flex-1",children:"Cancel"}),f.jsx(Ur,{type:"submit",disabled:h||a.length!==6,className:"flex-1",children:h?f.jsxs(f.Fragment,{children:[f.jsx(Sd,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify OTP"})]})]})]})]})})},nY=K.createContext(),Bve=({children:e})=>{const[t,r]=K.useState(null),[n,a]=K.useState(null),[l,h]=K.useState(!1),[i,_]=K.useState(!0),[w,A]=K.useState(!1),C=Ua(),R=K.useRef(!1),z=Q=>Q.exp*1e3<Date.now();K.useEffect(()=>{const Q=localStorage.getItem("token"),le=JSON.parse(localStorage.getItem("userData"));if(Q)try{const ne=j2(Q);z(ne)?(localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1)):(r(Q),a(le),h(!0))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1)}_(!1)},[]);const V=Q=>{const le=j2(Q);if(z(le)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1);return}const ne={userId:le.userId,role:le.role,email:le.email,isPasswordChange:le.isPasswordChange,isOtpVerified:le.isOtpVerified};localStorage.setItem("token",Q),localStorage.setItem("userData",JSON.stringify(ne)),r(Q),a(ne),h(!0)},U=Q=>{const le=j2(Q);if(z(le)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1);return}const ne={userId:le.userId,role:le.role,email:le.email,isPasswordChange:le.isPasswordChange,isOtpVerified:le.isOtpVerified};localStorage.setItem("token",Q),localStorage.setItem("userData",JSON.stringify(ne)),r(Q),a(ne),h(!0)};K.useEffect(()=>{l&&(n!=null&&n.role)&&n.role!=="0"&&n.isOtpVerified===!1?A(!0):A(!1)},[l,n]);const G=Q=>{U(Q),setTimeout(()=>{R.current||(R.current=!0,C("/"),setTimeout(()=>{R.current=!1},100))},100)},H=()=>{A(!1),J()},J=async()=>{try{await Bn.post("/auth/logout")}catch(Q){console.error("Logout API call failed:",Q)}finally{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1),R.current||(R.current=!0,C("/login"),setTimeout(()=>{R.current=!1},100))}};return K.useEffect(()=>{if(l&&t)try{const le=j2(t).exp*1e3-Date.now();if(le>0){const ne=setTimeout(()=>{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1),R.current||(R.current=!0,C("/login"),setTimeout(()=>{R.current=!1},100))},le);return()=>clearTimeout(ne)}else localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1),R.current||(R.current=!0,C("/login"),setTimeout(()=>{R.current=!1},100))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),h(!1)}},[t]),i?f.jsx("div",{className:"h-screen my-auto mx-auto"}):f.jsxs(nY.Provider,{value:{token:t,isAuthenticated:l,login:V,logout:J,updateToken:U,userData:n,setUserData:a},children:[e,f.jsx(Fve,{isOpen:w,onClose:H,onSuccess:G,userEmail:n==null?void 0:n.email})]})},ra=()=>K.useContext(nY);function Vve({className:e,...t}){const[r,n]=K.useState(!1),[a,l]=K.useState(!1),[h,i]=K.useState(null),{login:_,isAuthenticated:w}=ra(),A=Ua(),C=()=>{n(!r)},R=Uh({resolver:$h(Vge),defaultValues:{email:"",password:""}}),z=async V=>{var U,G;try{l(!0),i(null);const{data:H}=await Bn.post("/auth/login",V);if(H){if(l(!1),H.requiresOTP){Ni.success(`OTP has been sent to ${H.email}. Please check your email.`),H.token&&_(H.token);return}H.token&&(_(H.token),A("/"))}}catch(H){console.error("Login error:",H),R.clearErrors(),(((G=(U=H.response)==null?void 0:U.data)==null?void 0:G.message)==="Password is incorrect"?"0":"1")==="0"?R.setError("password",{type:"manual",message:"Password is incorrect"}):R.setError("email",{type:"manual",message:"Email or license number is incorrect"}),l(!1)}};return f.jsx("div",{className:Gt("flex flex-col gap-6",e),...t,children:f.jsx($v,{...R,children:f.jsx("form",{onSubmit:V=>{V.preventDefault(),R.handleSubmit(z)(V)},children:f.jsxs("div",{className:"flex flex-col gap-6",children:[f.jsxs("div",{className:"flex flex-col  gap-2",children:[f.jsx("div",{className:"flex flex-col items-center gap-2 font-medium",children:f.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md",children:f.jsx(Rue,{className:"size-6"})})}),f.jsx("h1",{className:"text-xl font-bold",children:"Login"}),f.jsxs("div",{className:"text-start text-sm",children:["Fill in the form to get started."," "]})]}),f.jsxs("div",{className:"flex flex-col gap-6",children:[f.jsx(qn,{control:R.control,name:"email",render:({field:V})=>f.jsx(Dn,{children:f.jsxs("div",{className:"grid gap-2",children:[f.jsx(Ln,{children:"Email"}),f.jsx(Nn,{children:f.jsx(Fn,{...V,type:"text",placeholder:"m@example.com",autoComplete:"current-email",className:Gt("border border-input focus:ring-0",R.formState.errors.email&&"border-red-500")})}),f.jsx(zn,{})]})})}),f.jsx(qn,{control:R.control,name:"password",render:({field:V})=>f.jsx(Dn,{children:f.jsxs("div",{className:"grid gap-2",children:[f.jsx(Ln,{children:"Password"}),f.jsx(Nn,{children:f.jsxs("div",{className:"relative w-full ",children:[f.jsx(Fn,{...V,type:r?"text":"password",autoComplete:"current-password",className:Gt("border border-input focus:ring-0",R.formState.errors.password&&"border-red-500")}),f.jsx(Ur,{type:"button",size:"icon",variant:"ghost",className:"absolute right-0 top-0 h-full w-min px-3 py-2 hover:bg-transparent",onClick:C,"aria-label":r?"Hide Password":"Show Password",children:r?f.jsx(Eue,{className:"text-gray-500 size-4"}):f.jsx(WK,{className:"text-gray-500 size-4"})})]})}),f.jsx(zn,{})]})})}),f.jsx(Ur,{type:"submit",disabled:a,id:"submit",className:"w-full",children:a?f.jsx(Sd,{className:"w-6 h-6 text-primary-foreground mx-auto animate-spin"}):"Login"})]}),f.jsx("div",{className:"relative text-end text-sm ",children:f.jsx("button",{type:"button",className:"relative z-10 bg-background px-2 text-muted-foreground hover:text-foreground transition-colors",children:"Forgot your password?"})})]})},"login-form")})})}const Uve=()=>f.jsx("div",{className:"flex min-h-svh flex-col items-center justify-center gap-6 bg-background p-6 md:p-10",children:f.jsx("div",{className:"w-full max-w-sm",children:f.jsx(Vve,{})})}),iY=K.createContext({});function $ve(e){const t=K.useRef(null);return t.current===null&&(t.current=e()),t.current}const b3=typeof window<"u",qve=b3?K.useLayoutEffect:K.useEffect,w3=K.createContext(null),aY=K.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Gve(e=!0){const t=K.useContext(w3);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:a}=t,l=K.useId();K.useEffect(()=>{if(e)return a(l)},[e]);const h=K.useCallback(()=>e&&n&&n(l),[l,n,e]);return!r&&n?[!1,h]:[!0]}function S3(e,t){e.indexOf(t)===-1&&e.push(t)}function A3(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Su=e=>e;let oY=Su;const Kve={useManualTiming:!1};function T3(e){let t;return()=>(t===void 0&&(t=e()),t)}const Sx=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class P3{constructor(){this.subscriptions=[]}add(t){return S3(this.subscriptions,t),()=>A3(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let l=0;l<a;l++){const h=this.subscriptions[l];h&&h(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const nm=e=>e*1e3,im=e=>e/1e3;function sY(e,t){return t?e*(1e3/t):0}const Wve=T3(()=>window.ScrollTimeline!==void 0);class Hve{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=r}attachTimeline(t,r){const n=this.animations.map(a=>{if(Wve()&&a.attachTimeline)return a.attachTimeline(t);if(typeof r=="function")return r(a)});return()=>{n.forEach((a,l)=>{a&&a(),this.animations[l].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Zve extends Hve{then(t,r){return Promise.all(this.animations).then(t).catch(r)}}function E3(e,t){return e?e[t]||e.default||e:void 0}const hN=2e4;function lY(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<hN;)t+=r,n=e.next(t);return t>=hN?1/0:t}function C3(e){return typeof e=="function"}function xV(e,t){e.timeline=t,e.onfinish=null}const M3=e=>Array.isArray(e)&&typeof e[0]=="number",Yve={linearEasing:void 0};function Xve(e,t){const r=T3(e);return()=>{var n;return(n=Yve[t])!==null&&n!==void 0?n:r()}}const GA=Xve(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cY=(e,t,r=10)=>{let n="";const a=Math.max(Math.round(t/r),2);for(let l=0;l<a;l++)n+=e(Sx(0,a-1,l))+", ";return`linear(${n.substring(0,n.length-2)})`};function uY(e){return!!(typeof e=="function"&&GA()||!e||typeof e=="string"&&(e in fN||GA())||M3(e)||Array.isArray(e)&&e.every(uY))}const Qb=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,fN={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Qb([0,.65,.55,1]),circOut:Qb([.55,0,1,.45]),backIn:Qb([.31,.01,.66,-.59]),backOut:Qb([.33,1.53,.69,.99])};function dY(e,t){if(e)return typeof e=="function"&&GA()?cY(e,t):M3(e)?Qb(e):Array.isArray(e)?e.map(r=>dY(r,t)||fN.easeOut):fN[e]}const N2=["read","resolveKeyframes","update","preRender","render","postRender"],bV={value:null};function Jve(e,t){let r=new Set,n=new Set,a=!1,l=!1;const h=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1},_=0;function w(C){h.has(C)&&(A.schedule(C),e()),_++,C(i)}const A={schedule:(C,R=!1,z=!1)=>{const U=z&&a?r:n;return R&&h.add(C),U.has(C)||U.add(C),C},cancel:C=>{n.delete(C),h.delete(C)},process:C=>{if(i=C,a){l=!0;return}a=!0,[r,n]=[n,r],r.forEach(w),t&&bV.value&&bV.value.frameloop[t].push(_),_=0,r.clear(),a=!1,l&&(l=!1,A.process(C))}};return A}const Qve=40;function hY(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},l=()=>r=!0,h=N2.reduce((H,J)=>(H[J]=Jve(l,t?J:void 0),H),{}),{read:i,resolveKeyframes:_,update:w,preRender:A,render:C,postRender:R}=h,z=()=>{const H=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(H-a.timestamp,Qve),1),a.timestamp=H,a.isProcessing=!0,i.process(a),_.process(a),w.process(a),A.process(a),C.process(a),R.process(a),a.isProcessing=!1,r&&t&&(n=!1,e(z))},V=()=>{r=!0,n=!0,a.isProcessing||e(z)};return{schedule:N2.reduce((H,J)=>{const Q=h[J];return H[J]=(le,ne=!1,de=!1)=>(r||V(),Q.schedule(le,ne,de)),H},{}),cancel:H=>{for(let J=0;J<N2.length;J++)h[N2[J]].cancel(H)},state:a,steps:h}}const{schedule:Xa,cancel:Bg,state:vl,steps:sM}=hY(typeof requestAnimationFrame<"u"?requestAnimationFrame:Su,!0),{schedule:O3}=hY(queueMicrotask,!1);let fA;function e_e(){fA=void 0}const Bf={now:()=>(fA===void 0&&Bf.set(vl.isProcessing||Kve.useManualTiming?vl.timestamp:performance.now()),fA),set:e=>{fA=e,queueMicrotask(e_e)}},bh={x:!1,y:!1};function fY(){return bh.x||bh.y}function t_e(e){return e==="x"||e==="y"?bh[e]?null:(bh[e]=!0,()=>{bh[e]=!1}):bh.x||bh.y?null:(bh.x=bh.y=!0,()=>{bh.x=bh.y=!1})}function r_e(e,t,r){var n;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const l=(n=void 0)!==null&&n!==void 0?n:a.querySelectorAll(e);return l?Array.from(l):[]}return Array.from(e)}function pY(e,t){const r=r_e(e),n=new AbortController,a={passive:!0,...t,signal:n.signal};return[r,a,()=>n.abort()]}function wV(e){return!(e.pointerType==="touch"||fY())}function n_e(e,t,r={}){const[n,a,l]=pY(e,r),h=i=>{if(!wV(i))return;const{target:_}=i,w=t(_,i);if(typeof w!="function"||!_)return;const A=C=>{wV(C)&&(w(C),_.removeEventListener("pointerleave",A))};_.addEventListener("pointerleave",A,a)};return n.forEach(i=>{i.addEventListener("pointerenter",h,a)}),l}function SV(e,t){const r=`${t}PointerCapture`;if(e.target instanceof Element&&r in e.target&&e.pointerId!==void 0)try{e.target[r](e.pointerId)}catch{}}const mY=(e,t)=>t?e===t?!0:mY(e,t.parentElement):!1,R3=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,i_e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function a_e(e){return i_e.has(e.tagName)||e.tabIndex!==-1}const e1=new WeakSet;function AV(e){return t=>{t.key==="Enter"&&e(t)}}function lM(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const o_e=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=AV(()=>{if(e1.has(r))return;lM(r,"down");const a=AV(()=>{lM(r,"up")}),l=()=>lM(r,"cancel");r.addEventListener("keyup",a,t),r.addEventListener("blur",l,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function TV(e){return R3(e)&&!fY()}function s_e(e,t,r={}){const[n,a,l]=pY(e,r),h=i=>{const _=i.currentTarget;if(!_||!TV(i)||e1.has(_))return;e1.add(_),SV(i,"set");const w=t(_,i),A=(z,V)=>{_.removeEventListener("pointerup",C),_.removeEventListener("pointercancel",R),SV(z,"release"),!(!TV(z)||!e1.has(_))&&(e1.delete(_),typeof w=="function"&&w(z,{success:V}))},C=z=>{(z.isTrusted?l_e(z,_ instanceof Element?_.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?A(z,!1):A(z,!(_ instanceof Element)||mY(_,z.target))},R=z=>{A(z,!1)};_.addEventListener("pointerup",C,a),_.addEventListener("pointercancel",R,a),_.addEventListener("lostpointercapture",R,a)};return n.forEach(i=>{i=r.useGlobalTarget?window:i;let _=!1;i instanceof HTMLElement&&(_=!0,!a_e(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0)),i.addEventListener("pointerdown",h,a),_&&i.addEventListener("focus",w=>o_e(w,a),a)}),l}function l_e(e,t){return e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom}const PV=30,c_e=e=>!isNaN(parseFloat(e));class u_e{constructor(t,r={}){this.version="12.5.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,a=!0)=>{const l=Bf.now();this.updatedAt!==l&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Bf.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=c_e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new P3);const n=this.events[t].add(r);return t==="change"?()=>{n(),Xa.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Bf.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>PV)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,PV);return sY(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function G1(e,t){return new u_e(e,t)}const gY=K.createContext({strict:!1}),EV={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ax={};for(const e in EV)Ax[e]={isEnabled:t=>EV[e].some(r=>!!t[r])};function d_e(e){for(const t in e)Ax[t]={...Ax[t],...e[t]}}const h_e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function KA(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||h_e.has(e)}let yY=e=>!KA(e);function f_e(e){e&&(yY=t=>t.startsWith("on")?!KA(t):e(t))}try{f_e(require("@emotion/is-prop-valid").default)}catch{}function p_e(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(yY(a)||r===!0&&KA(a)||!t&&!KA(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function m_e(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,a)=>a==="create"?e:(t.has(a)||t.set(a,e(a)),t.get(a))})}const kP=K.createContext({});function jP(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function K1(e){return typeof e=="string"||Array.isArray(e)}const k3=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],j3=["initial",...k3];function NP(e){return jP(e.animate)||j3.some(t=>K1(e[t]))}function vY(e){return!!(NP(e)||e.variants)}function g_e(e,t){if(NP(e)){const{initial:r,animate:n}=e;return{initial:r===!1||K1(r)?r:void 0,animate:K1(n)?n:void 0}}return e.inherit!==!1?t:{}}function y_e(e){const{initial:t,animate:r}=g_e(e,K.useContext(kP));return K.useMemo(()=>({initial:t,animate:r}),[CV(t),CV(r)])}function CV(e){return Array.isArray(e)?e.join(" "):e}const v_e=Symbol.for("motionComponentSymbol");function Q_(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function __e(e,t,r){return K.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Q_(r)&&(r.current=n))},[t])}const N3=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),x_e="framerAppearId",_Y="data-"+N3(x_e),xY=K.createContext({});function b_e(e,t,r,n,a){var l,h;const{visualElement:i}=K.useContext(kP),_=K.useContext(gY),w=K.useContext(w3),A=K.useContext(aY).reducedMotion,C=K.useRef(null);n=n||_.renderer,!C.current&&n&&(C.current=n(e,{visualState:t,parent:i,props:r,presenceContext:w,blockInitialAnimation:w?w.initial===!1:!1,reducedMotionConfig:A}));const R=C.current,z=K.useContext(xY);R&&!R.projection&&a&&(R.type==="html"||R.type==="svg")&&w_e(C.current,r,a,z);const V=K.useRef(!1);K.useInsertionEffect(()=>{R&&V.current&&R.update(r,w)});const U=r[_Y],G=K.useRef(!!U&&!(!((l=window.MotionHandoffIsComplete)===null||l===void 0)&&l.call(window,U))&&((h=window.MotionHasOptimisedAnimation)===null||h===void 0?void 0:h.call(window,U)));return qve(()=>{R&&(V.current=!0,window.MotionIsMounted=!0,R.updateFeatures(),O3.render(R.render),G.current&&R.animationState&&R.animationState.animateChanges())}),K.useEffect(()=>{R&&(!G.current&&R.animationState&&R.animationState.animateChanges(),G.current&&(queueMicrotask(()=>{var H;(H=window.MotionHandoffMarkAsComplete)===null||H===void 0||H.call(window,U)}),G.current=!1))}),R}function w_e(e,t,r,n){const{layoutId:a,layout:l,drag:h,dragConstraints:i,layoutScroll:_,layoutRoot:w}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:bY(e.parent)),e.projection.setOptions({layoutId:a,layout:l,alwaysMeasureLayout:!!h||i&&Q_(i),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:n,layoutScroll:_,layoutRoot:w})}function bY(e){if(e)return e.options.allowProjection!==!1?e.projection:bY(e.parent)}function S_e({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){var l,h;e&&d_e(e);function i(w,A){let C;const R={...K.useContext(aY),...w,layoutId:A_e(w)},{isStatic:z}=R,V=y_e(w),U=n(w,z);if(!z&&b3){T_e();const G=P_e(R);C=G.MeasureLayout,V.visualElement=b_e(a,U,R,t,G.ProjectionNode)}return f.jsxs(kP.Provider,{value:V,children:[C&&V.visualElement?f.jsx(C,{visualElement:V.visualElement,...R}):null,r(a,w,__e(U,V.visualElement,A),U,z,V.visualElement)]})}i.displayName=`motion.${typeof a=="string"?a:`create(${(h=(l=a.displayName)!==null&&l!==void 0?l:a.name)!==null&&h!==void 0?h:""})`}`;const _=K.forwardRef(i);return _[v_e]=a,_}function A_e({layoutId:e}){const t=K.useContext(iY).id;return t&&e!==void 0?t+"-"+e:e}function T_e(e,t){K.useContext(gY).strict}function P_e(e){const{drag:t,layout:r}=Ax;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const wY=e=>t=>typeof t=="string"&&t.startsWith(e),I3=wY("--"),E_e=wY("var(--"),D3=e=>E_e(e)?C_e.test(e.split("/*")[0].trim()):!1,C_e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,W1={};function M_e(e){for(const t in e)W1[t]=e[t],I3(t)&&(W1[t].isCSSVariable=!0)}const w0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Wv=new Set(w0);function SY(e,{layout:t,layoutId:r}){return Wv.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!W1[e]||e==="opacity")}const Fl=e=>!!(e&&e.getVelocity),AY=(e,t)=>t&&typeof e=="number"?t.transform(e):e,dm=(e,t,r)=>r>t?t:r<e?e:r,S0={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},H1={...S0,transform:e=>dm(0,1,e)},I2={...S0,default:1},nS=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),bg=nS("deg"),Vf=nS("%"),ri=nS("px"),O_e=nS("vh"),R_e=nS("vw"),MV={...Vf,parse:e=>Vf.parse(e)/100,transform:e=>Vf.transform(e*100)},k_e={borderWidth:ri,borderTopWidth:ri,borderRightWidth:ri,borderBottomWidth:ri,borderLeftWidth:ri,borderRadius:ri,radius:ri,borderTopLeftRadius:ri,borderTopRightRadius:ri,borderBottomRightRadius:ri,borderBottomLeftRadius:ri,width:ri,maxWidth:ri,height:ri,maxHeight:ri,top:ri,right:ri,bottom:ri,left:ri,padding:ri,paddingTop:ri,paddingRight:ri,paddingBottom:ri,paddingLeft:ri,margin:ri,marginTop:ri,marginRight:ri,marginBottom:ri,marginLeft:ri,backgroundPositionX:ri,backgroundPositionY:ri},j_e={rotate:bg,rotateX:bg,rotateY:bg,rotateZ:bg,scale:I2,scaleX:I2,scaleY:I2,scaleZ:I2,skew:bg,skewX:bg,skewY:bg,distance:ri,translateX:ri,translateY:ri,translateZ:ri,x:ri,y:ri,z:ri,perspective:ri,transformPerspective:ri,opacity:H1,originX:MV,originY:MV,originZ:ri},OV={...S0,transform:Math.round},L3={...k_e,...j_e,zIndex:OV,size:ri,fillOpacity:H1,strokeOpacity:H1,numOctaves:OV},N_e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},I_e=w0.length;function D_e(e,t,r){let n="",a=!0;for(let l=0;l<I_e;l++){const h=w0[l],i=e[h];if(i===void 0)continue;let _=!0;if(typeof i=="number"?_=i===(h.startsWith("scale")?1:0):_=parseFloat(i)===0,!_||r){const w=AY(i,L3[h]);if(!_){a=!1;const A=N_e[h]||h;n+=`${A}(${w}) `}r&&(t[h]=w)}}return n=n.trim(),r?n=r(t,a?"":n):a&&(n="none"),n}function z3(e,t,r){const{style:n,vars:a,transformOrigin:l}=e;let h=!1,i=!1;for(const _ in t){const w=t[_];if(Wv.has(_)){h=!0;continue}else if(I3(_)){a[_]=w;continue}else{const A=AY(w,L3[_]);_.startsWith("origin")?(i=!0,l[_]=A):n[_]=A}}if(t.transform||(h||r?n.transform=D_e(t,e.transform,r):n.transform&&(n.transform="none")),i){const{originX:_="50%",originY:w="50%",originZ:A=0}=l;n.transformOrigin=`${_} ${w} ${A}`}}const F3=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function TY(e,t,r){for(const n in t)!Fl(t[n])&&!SY(n,r)&&(e[n]=t[n])}function L_e({transformTemplate:e},t){return K.useMemo(()=>{const r=F3();return z3(r,t,e),Object.assign({},r.vars,r.style)},[t])}function z_e(e,t){const r=e.style||{},n={};return TY(n,r,e),Object.assign(n,L_e(e,t)),n}function F_e(e,t){const r={},n=z_e(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const B_e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function B3(e){return typeof e!="string"||e.includes("-")?!1:!!(B_e.indexOf(e)>-1||/[A-Z]/u.test(e))}const V_e={offset:"stroke-dashoffset",array:"stroke-dasharray"},U_e={offset:"strokeDashoffset",array:"strokeDasharray"};function $_e(e,t,r=1,n=0,a=!0){e.pathLength=1;const l=a?V_e:U_e;e[l.offset]=ri.transform(-n);const h=ri.transform(t),i=ri.transform(r);e[l.array]=`${h} ${i}`}function RV(e,t,r){return typeof e=="string"?e:ri.transform(t+r*e)}function q_e(e,t,r){const n=RV(t,e.x,e.width),a=RV(r,e.y,e.height);return`${n} ${a}`}function V3(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:l,pathLength:h,pathSpacing:i=1,pathOffset:_=0,...w},A,C){if(z3(e,w,C),A){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:R,style:z,dimensions:V}=e;R.transform&&(V&&(z.transform=R.transform),delete R.transform),V&&(a!==void 0||l!==void 0||z.transform)&&(z.transformOrigin=q_e(V,a!==void 0?a:.5,l!==void 0?l:.5)),t!==void 0&&(R.x=t),r!==void 0&&(R.y=r),n!==void 0&&(R.scale=n),h!==void 0&&$_e(R,h,i,_,!1)}const PY=()=>({...F3(),attrs:{}}),U3=e=>typeof e=="string"&&e.toLowerCase()==="svg";function G_e(e,t,r,n){const a=K.useMemo(()=>{const l=PY();return V3(l,t,U3(n),e.transformTemplate),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};TY(l,e.style,e),a.style={...l,...a.style}}return a}function K_e(e=!1){return(r,n,a,{latestValues:l},h)=>{const _=(B3(r)?G_e:F_e)(n,l,h,r),w=p_e(n,typeof r=="string",e),A=r!==K.Fragment?{...w,..._,ref:a}:{},{children:C}=n,R=K.useMemo(()=>Fl(C)?C.get():C,[C]);return K.createElement(r,{...A,children:R})}}function kV(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function $3(e,t,r,n){if(typeof t=="function"){const[a,l]=kV(n);t=t(r!==void 0?r:e.custom,a,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,l]=kV(n);t=t(r!==void 0?r:e.custom,a,l)}return t}const pN=e=>Array.isArray(e),W_e=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),H_e=e=>pN(e)?e[e.length-1]||0:e;function pA(e){const t=Fl(e)?e.get():e;return W_e(t)?t.toValue():t}function Z_e({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:r},n,a,l){const h={latestValues:Y_e(n,a,l,e),renderState:t()};return r&&(h.onMount=i=>r({props:n,current:i,...h}),h.onUpdate=i=>r(i)),h}const EY=e=>(t,r)=>{const n=K.useContext(kP),a=K.useContext(w3),l=()=>Z_e(e,t,n,a);return r?l():$ve(l)};function Y_e(e,t,r,n){const a={},l=n(e,{});for(const R in l)a[R]=pA(l[R]);let{initial:h,animate:i}=e;const _=NP(e),w=vY(e);t&&w&&!_&&e.inherit!==!1&&(h===void 0&&(h=t.initial),i===void 0&&(i=t.animate));let A=r?r.initial===!1:!1;A=A||h===!1;const C=A?i:h;if(C&&typeof C!="boolean"&&!jP(C)){const R=Array.isArray(C)?C:[C];for(let z=0;z<R.length;z++){const V=$3(e,R[z]);if(V){const{transitionEnd:U,transition:G,...H}=V;for(const J in H){let Q=H[J];if(Array.isArray(Q)){const le=A?Q.length-1:0;Q=Q[le]}Q!==null&&(a[J]=Q)}for(const J in U)a[J]=U[J]}}}return a}function q3(e,t,r){var n;const{style:a}=e,l={};for(const h in a)(Fl(a[h])||t.style&&Fl(t.style[h])||SY(h,e)||((n=r==null?void 0:r.getValue(h))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(l[h]=a[h]);return l}const X_e={useVisualState:EY({scrapeMotionValuesFromProps:q3,createRenderState:F3})};function CY(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function MY(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const l in r)e.style.setProperty(l,r[l])}const OY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function RY(e,t,r,n){MY(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(OY.has(a)?a:N3(a),t.attrs[a])}function kY(e,t,r){const n=q3(e,t,r);for(const a in e)if(Fl(e[a])||Fl(t[a])){const l=w0.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[l]=e[a]}return n}const jV=["x","y","width","height","cx","cy","r"],J_e={useVisualState:EY({scrapeMotionValuesFromProps:kY,createRenderState:PY,onUpdate:({props:e,prevProps:t,current:r,renderState:n,latestValues:a})=>{if(!r)return;let l=!!e.drag;if(!l){for(const i in a)if(Wv.has(i)){l=!0;break}}if(!l)return;let h=!t;if(t)for(let i=0;i<jV.length;i++){const _=jV[i];e[_]!==t[_]&&(h=!0)}h&&Xa.read(()=>{CY(r,n),Xa.render(()=>{V3(n,a,U3(r.tagName),e.transformTemplate),RY(r,n)})})}})};function Q_e(e,t){return function(n,{forwardMotionProps:a}={forwardMotionProps:!1}){const h={...B3(n)?J_e:X_e,preloadedFeatures:e,useRender:K_e(a),createVisualElement:t,Component:n};return S_e(h)}}function Z1(e,t,r){const n=e.getProps();return $3(n,t,r!==void 0?r:n.custom,e)}const jY=new Set(["width","height","top","left","right","bottom",...w0]);function exe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,G1(r))}function txe(e,t){const r=Z1(e,t);let{transitionEnd:n={},transition:a={},...l}=r||{};l={...l,...n};for(const h in l){const i=H_e(l[h]);exe(e,h,i)}}function rxe(e){return!!(Fl(e)&&e.add)}function mN(e,t){const r=e.getValue("willChange");if(rxe(r))return r.add(t)}function NY(e){return e.props[_Y]}const IY=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,nxe=1e-7,ixe=12;function axe(e,t,r,n,a){let l,h,i=0;do h=t+(r-t)/2,l=IY(h,n,a)-e,l>0?r=h:t=h;while(Math.abs(l)>nxe&&++i<ixe);return h}function iS(e,t,r,n){if(e===t&&r===n)return Su;const a=l=>axe(l,0,1,e,r);return l=>l===0||l===1?l:IY(a(l),t,n)}const DY=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,LY=e=>t=>1-e(1-t),zY=iS(.33,1.53,.69,.99),G3=LY(zY),FY=DY(G3),BY=e=>(e*=2)<1?.5*G3(e):.5*(2-Math.pow(2,-10*(e-1))),K3=e=>1-Math.sin(Math.acos(e)),VY=LY(K3),UY=DY(K3),$Y=e=>/^0[^.\s]+$/u.test(e);function oxe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||$Y(e):!0}const s1=e=>Math.round(e*1e5)/1e5,W3=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function sxe(e){return e==null}const lxe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,H3=(e,t)=>r=>!!(typeof r=="string"&&lxe.test(r)&&r.startsWith(e)||t&&!sxe(r)&&Object.prototype.hasOwnProperty.call(r,t)),qY=(e,t,r)=>n=>{if(typeof n!="string")return n;const[a,l,h,i]=n.match(W3);return{[e]:parseFloat(a),[t]:parseFloat(l),[r]:parseFloat(h),alpha:i!==void 0?parseFloat(i):1}},cxe=e=>dm(0,255,e),cM={...S0,transform:e=>Math.round(cxe(e))},dv={test:H3("rgb","red"),parse:qY("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+cM.transform(e)+", "+cM.transform(t)+", "+cM.transform(r)+", "+s1(H1.transform(n))+")"};function uxe(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const gN={test:H3("#"),parse:uxe,transform:dv.transform},ex={test:H3("hsl","hue"),parse:qY("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Vf.transform(s1(t))+", "+Vf.transform(s1(r))+", "+s1(H1.transform(n))+")"},Il={test:e=>dv.test(e)||gN.test(e)||ex.test(e),parse:e=>dv.test(e)?dv.parse(e):ex.test(e)?ex.parse(e):gN.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?dv.transform(e):ex.transform(e)},dxe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function hxe(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(W3))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(dxe))===null||r===void 0?void 0:r.length)||0)>0}const GY="number",KY="color",fxe="var",pxe="var(",NV="${}",mxe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Y1(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},a=[];let l=0;const i=t.replace(mxe,_=>(Il.test(_)?(n.color.push(l),a.push(KY),r.push(Il.parse(_))):_.startsWith(pxe)?(n.var.push(l),a.push(fxe),r.push(_)):(n.number.push(l),a.push(GY),r.push(parseFloat(_))),++l,NV)).split(NV);return{values:r,split:i,indexes:n,types:a}}function WY(e){return Y1(e).values}function HY(e){const{split:t,types:r}=Y1(e),n=t.length;return a=>{let l="";for(let h=0;h<n;h++)if(l+=t[h],a[h]!==void 0){const i=r[h];i===GY?l+=s1(a[h]):i===KY?l+=Il.transform(a[h]):l+=a[h]}return l}}const gxe=e=>typeof e=="number"?0:e;function yxe(e){const t=WY(e);return HY(e)(t.map(gxe))}const Vg={test:hxe,parse:WY,createTransformer:HY,getAnimatableNone:yxe},vxe=new Set(["brightness","contrast","saturate","opacity"]);function _xe(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(W3)||[];if(!n)return e;const a=r.replace(n,"");let l=vxe.has(t)?1:0;return n!==r&&(l*=100),t+"("+l+a+")"}const xxe=/\b([a-z-]*)\(.*?\)/gu,yN={...Vg,getAnimatableNone:e=>{const t=e.match(xxe);return t?t.map(_xe).join(" "):e}},bxe={...L3,color:Il,backgroundColor:Il,outlineColor:Il,fill:Il,stroke:Il,borderColor:Il,borderTopColor:Il,borderRightColor:Il,borderBottomColor:Il,borderLeftColor:Il,filter:yN,WebkitFilter:yN},ZY=e=>bxe[e];function YY(e,t){let r=ZY(e);return r!==yN&&(r=Vg),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const wxe=new Set(["auto","none","0"]);function Sxe(e,t,r){let n=0,a;for(;n<e.length&&!a;){const l=e[n];typeof l=="string"&&!wxe.has(l)&&Y1(l).values.length&&(a=e[n]),n++}if(a&&r)for(const l of t)e[l]=YY(r,a)}const hv=e=>e*180/Math.PI,vN=e=>{const t=hv(Math.atan2(e[1],e[0]));return _N(t)},Axe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:vN,rotateZ:vN,skewX:e=>hv(Math.atan(e[1])),skewY:e=>hv(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},_N=e=>(e=e%360,e<0&&(e+=360),e),IV=vN,DV=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),LV=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Txe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:DV,scaleY:LV,scale:e=>(DV(e)+LV(e))/2,rotateX:e=>_N(hv(Math.atan2(e[6],e[5]))),rotateY:e=>_N(hv(Math.atan2(-e[2],e[0]))),rotateZ:IV,rotate:IV,skewX:e=>hv(Math.atan(e[4])),skewY:e=>hv(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function zV(e){return e.includes("scale")?1:0}function xN(e,t){if(!e||e==="none")return zV(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(r)n=Txe,a=r;else{const i=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Axe,a=i}if(!a)return zV(t);const l=n[t],h=a[1].split(",").map(Exe);return typeof l=="function"?l(h):h[l]}const Pxe=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return xN(r,t)};function Exe(e){return parseFloat(e.trim())}const FV=e=>e===S0||e===ri,Cxe=new Set(["x","y","z"]),Mxe=w0.filter(e=>!Cxe.has(e));function Oxe(e){const t=[];return Mxe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Tx={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>xN(t,"x"),y:(e,{transform:t})=>xN(t,"y")};Tx.translateX=Tx.x;Tx.translateY=Tx.y;const xv=new Set;let bN=!1,wN=!1;function XY(){if(wN){const e=Array.from(xv).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const a=Oxe(n);a.length&&(r.set(n,a),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const a=r.get(n);a&&a.forEach(([l,h])=>{var i;(i=n.getValue(l))===null||i===void 0||i.set(h)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}wN=!1,bN=!1,xv.forEach(e=>e.complete()),xv.clear()}function JY(){xv.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(wN=!0)})}function Rxe(){JY(),XY()}class Z3{constructor(t,r,n,a,l,h=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=a,this.element=l,this.isAsync=h}scheduleResolve(){this.isScheduled=!0,this.isAsync?(xv.add(this),bN||(bN=!0,Xa.read(JY),Xa.resolveKeyframes(XY))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:a}=this;for(let l=0;l<t.length;l++)if(t[l]===null)if(l===0){const h=a==null?void 0:a.get(),i=t[t.length-1];if(h!==void 0)t[0]=h;else if(n&&r){const _=n.readValue(r,i);_!=null&&(t[0]=_)}t[0]===void 0&&(t[0]=i),a&&h===void 0&&a.set(t[0])}else t[l]=t[l-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),xv.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,xv.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const QY=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),kxe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function jxe(e){const t=kxe.exec(e);if(!t)return[,];const[,r,n,a]=t;return[`--${r??n}`,a]}function eX(e,t,r=1){const[n,a]=jxe(e);if(!n)return;const l=window.getComputedStyle(t).getPropertyValue(n);if(l){const h=l.trim();return QY(h)?parseFloat(h):h}return D3(a)?eX(a,t,r+1):a}const tX=e=>t=>t.test(e),Nxe={test:e=>e==="auto",parse:e=>e},rX=[S0,ri,Vf,bg,R_e,O_e,Nxe],BV=e=>rX.find(tX(e));class nX extends Z3{constructor(t,r,n,a,l){super(t,r,n,a,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let _=0;_<t.length;_++){let w=t[_];if(typeof w=="string"&&(w=w.trim(),D3(w))){const A=eX(w,r.current);A!==void 0&&(t[_]=A),_===t.length-1&&(this.finalKeyframe=w)}}if(this.resolveNoneKeyframes(),!jY.has(n)||t.length!==2)return;const[a,l]=t,h=BV(a),i=BV(l);if(h!==i)if(FV(h)&&FV(i))for(let _=0;_<t.length;_++){const w=t[_];typeof w=="string"&&(t[_]=parseFloat(w))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let a=0;a<t.length;a++)oxe(t[a])&&n.push(a);n.length&&Sxe(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Tx[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(n,a).jump(a,!1)}measureEndState(){var t;const{element:r,name:n,unresolvedKeyframes:a}=this;if(!r||!r.current)return;const l=r.getValue(n);l&&l.jump(this.measuredOrigin,!1);const h=a.length-1,i=a[h];a[h]=Tx[n](r.measureViewportBox(),window.getComputedStyle(r.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([_,w])=>{r.getValue(_).set(w)}),this.resolveNoneKeyframes()}}const VV=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Vg.test(e)||e==="0")&&!e.startsWith("url("));function Ixe(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function Dxe(e,t,r,n){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],h=VV(a,t),i=VV(l,t);return!h||!i?!1:Ixe(e)||(r==="spring"||C3(r))&&n}const Lxe=e=>e!==null;function IP(e,{repeat:t,repeatType:r="loop"},n){const a=e.filter(Lxe),l=t&&r!=="loop"&&t%2===1?0:a.length-1;return!l||n===void 0?a[l]:n}const zxe=40;class iX{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:a=0,repeatDelay:l=0,repeatType:h="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Bf.now(),this.options={autoplay:t,delay:r,type:n,repeat:a,repeatDelay:l,repeatType:h,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>zxe?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Rxe(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=Bf.now(),this.hasAttemptedResolve=!0;const{name:n,type:a,velocity:l,delay:h,onComplete:i,onUpdate:_,isGenerator:w}=this.options;if(!w&&!Dxe(t,n,a,l))if(h)this.options.duration=0;else{_&&_(IP(t,this.options,r)),i&&i(),this.resolveFinishedPromise();return}const A=this.initPlayback(t,r);A!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...A},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const ko=(e,t,r)=>e+(t-e)*r;function uM(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Fxe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,l=0,h=0;if(!t)a=l=h=r;else{const i=r<.5?r*(1+t):r+t-r*t,_=2*r-i;a=uM(_,i,e+1/3),l=uM(_,i,e),h=uM(_,i,e-1/3)}return{red:Math.round(a*255),green:Math.round(l*255),blue:Math.round(h*255),alpha:n}}function WA(e,t){return r=>r>0?t:e}const dM=(e,t,r)=>{const n=e*e,a=r*(t*t-n)+n;return a<0?0:Math.sqrt(a)},Bxe=[gN,dv,ex],Vxe=e=>Bxe.find(t=>t.test(e));function UV(e){const t=Vxe(e);if(!t)return!1;let r=t.parse(e);return t===ex&&(r=Fxe(r)),r}const $V=(e,t)=>{const r=UV(e),n=UV(t);if(!r||!n)return WA(e,t);const a={...r};return l=>(a.red=dM(r.red,n.red,l),a.green=dM(r.green,n.green,l),a.blue=dM(r.blue,n.blue,l),a.alpha=ko(r.alpha,n.alpha,l),dv.transform(a))},Uxe=(e,t)=>r=>t(e(r)),aS=(...e)=>e.reduce(Uxe),SN=new Set(["none","hidden"]);function $xe(e,t){return SN.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function qxe(e,t){return r=>ko(e,t,r)}function Y3(e){return typeof e=="number"?qxe:typeof e=="string"?D3(e)?WA:Il.test(e)?$V:Wxe:Array.isArray(e)?aX:typeof e=="object"?Il.test(e)?$V:Gxe:WA}function aX(e,t){const r=[...e],n=r.length,a=e.map((l,h)=>Y3(l)(l,t[h]));return l=>{for(let h=0;h<n;h++)r[h]=a[h](l);return r}}function Gxe(e,t){const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=Y3(e[a])(e[a],t[a]));return a=>{for(const l in n)r[l]=n[l](a);return r}}function Kxe(e,t){var r;const n=[],a={color:0,var:0,number:0};for(let l=0;l<t.values.length;l++){const h=t.types[l],i=e.indexes[h][a[h]],_=(r=e.values[i])!==null&&r!==void 0?r:0;n[l]=_,a[h]++}return n}const Wxe=(e,t)=>{const r=Vg.createTransformer(t),n=Y1(e),a=Y1(t);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?SN.has(e)&&!a.values.length||SN.has(t)&&!n.values.length?$xe(e,t):aS(aX(Kxe(n,a),a.values),r):WA(e,t)};function oX(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?ko(e,t,r):Y3(e)(e,t)}const Hxe=5;function sX(e,t,r){const n=Math.max(t-Hxe,0);return sY(r-e(n),t-n)}const Fo={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},qV=.001;function Zxe({duration:e=Fo.duration,bounce:t=Fo.bounce,velocity:r=Fo.velocity,mass:n=Fo.mass}){let a,l,h=1-t;h=dm(Fo.minDamping,Fo.maxDamping,h),e=dm(Fo.minDuration,Fo.maxDuration,im(e)),h<1?(a=w=>{const A=w*h,C=A*e,R=A-r,z=AN(w,h),V=Math.exp(-C);return qV-R/z*V},l=w=>{const C=w*h*e,R=C*r+r,z=Math.pow(h,2)*Math.pow(w,2)*e,V=Math.exp(-C),U=AN(Math.pow(w,2),h);return(-a(w)+qV>0?-1:1)*((R-z)*V)/U}):(a=w=>{const A=Math.exp(-w*e),C=(w-r)*e+1;return-.001+A*C},l=w=>{const A=Math.exp(-w*e),C=(r-w)*(e*e);return A*C});const i=5/e,_=Xxe(a,l,i);if(e=nm(e),isNaN(_))return{stiffness:Fo.stiffness,damping:Fo.damping,duration:e};{const w=Math.pow(_,2)*n;return{stiffness:w,damping:h*2*Math.sqrt(n*w),duration:e}}}const Yxe=12;function Xxe(e,t,r){let n=r;for(let a=1;a<Yxe;a++)n=n-e(n)/t(n);return n}function AN(e,t){return e*Math.sqrt(1-t*t)}const Jxe=["duration","bounce"],Qxe=["stiffness","damping","mass"];function GV(e,t){return t.some(r=>e[r]!==void 0)}function e0e(e){let t={velocity:Fo.velocity,stiffness:Fo.stiffness,damping:Fo.damping,mass:Fo.mass,isResolvedFromDuration:!1,...e};if(!GV(e,Qxe)&&GV(e,Jxe))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),a=n*n,l=2*dm(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:Fo.mass,stiffness:a,damping:l}}else{const r=Zxe(e);t={...t,...r,mass:Fo.mass},t.isResolvedFromDuration=!0}return t}function lX(e=Fo.visualDuration,t=Fo.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:a}=r;const l=r.keyframes[0],h=r.keyframes[r.keyframes.length-1],i={done:!1,value:l},{stiffness:_,damping:w,mass:A,duration:C,velocity:R,isResolvedFromDuration:z}=e0e({...r,velocity:-im(r.velocity||0)}),V=R||0,U=w/(2*Math.sqrt(_*A)),G=h-l,H=im(Math.sqrt(_/A)),J=Math.abs(G)<5;n||(n=J?Fo.restSpeed.granular:Fo.restSpeed.default),a||(a=J?Fo.restDelta.granular:Fo.restDelta.default);let Q;if(U<1){const ne=AN(H,U);Q=de=>{const ue=Math.exp(-U*H*de);return h-ue*((V+U*H*G)/ne*Math.sin(ne*de)+G*Math.cos(ne*de))}}else if(U===1)Q=ne=>h-Math.exp(-H*ne)*(G+(V+H*G)*ne);else{const ne=H*Math.sqrt(U*U-1);Q=de=>{const ue=Math.exp(-U*H*de),ve=Math.min(ne*de,300);return h-ue*((V+U*H*G)*Math.sinh(ve)+ne*G*Math.cosh(ve))/ne}}const le={calculatedDuration:z&&C||null,next:ne=>{const de=Q(ne);if(z)i.done=ne>=C;else{let ue=0;U<1&&(ue=ne===0?nm(V):sX(Q,ne,de));const ve=Math.abs(ue)<=n,Ae=Math.abs(h-de)<=a;i.done=ve&&Ae}return i.value=i.done?h:de,i},toString:()=>{const ne=Math.min(lY(le),hN),de=cY(ue=>le.next(ne*ue).value,ne,30);return ne+"ms "+de}};return le}function KV({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:l=500,modifyTarget:h,min:i,max:_,restDelta:w=.5,restSpeed:A}){const C=e[0],R={done:!1,value:C},z=ve=>i!==void 0&&ve<i||_!==void 0&&ve>_,V=ve=>i===void 0?_:_===void 0||Math.abs(i-ve)<Math.abs(_-ve)?i:_;let U=r*t;const G=C+U,H=h===void 0?G:h(G);H!==G&&(U=H-C);const J=ve=>-U*Math.exp(-ve/n),Q=ve=>H+J(ve),le=ve=>{const Ae=J(ve),Oe=Q(ve);R.done=Math.abs(Ae)<=w,R.value=R.done?H:Oe};let ne,de;const ue=ve=>{z(R.value)&&(ne=ve,de=lX({keyframes:[R.value,V(R.value)],velocity:sX(Q,ve,R.value),damping:a,stiffness:l,restDelta:w,restSpeed:A}))};return ue(0),{calculatedDuration:null,next:ve=>{let Ae=!1;return!de&&ne===void 0&&(Ae=!0,le(ve),ue(ve)),ne!==void 0&&ve>=ne?de.next(ve-ne):(!Ae&&le(ve),R)}}}const t0e=iS(.42,0,1,1),r0e=iS(0,0,.58,1),cX=iS(.42,0,.58,1),n0e=e=>Array.isArray(e)&&typeof e[0]!="number",i0e={linear:Su,easeIn:t0e,easeInOut:cX,easeOut:r0e,circIn:K3,circInOut:UY,circOut:VY,backIn:G3,backInOut:FY,backOut:zY,anticipate:BY},WV=e=>{if(M3(e)){oY(e.length===4);const[t,r,n,a]=e;return iS(t,r,n,a)}else if(typeof e=="string")return i0e[e];return e};function a0e(e,t,r){const n=[],a=r||oX,l=e.length-1;for(let h=0;h<l;h++){let i=a(e[h],e[h+1]);if(t){const _=Array.isArray(t)?t[h]||Su:t;i=aS(_,i)}n.push(i)}return n}function o0e(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const l=e.length;if(oY(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const h=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=a0e(t,n,a),_=i.length,w=A=>{if(h&&A<e[0])return t[0];let C=0;if(_>1)for(;C<e.length-2&&!(A<e[C+1]);C++);const R=Sx(e[C],e[C+1],A);return i[C](R)};return r?A=>w(dm(e[0],e[l-1],A)):w}function s0e(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Sx(0,t,n);e.push(ko(r,1,a))}}function l0e(e){const t=[0];return s0e(t,e.length-1),t}function c0e(e,t){return e.map(r=>r*t)}function u0e(e,t){return e.map(()=>t||cX).splice(0,e.length-1)}function HA({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=n0e(n)?n.map(WV):WV(n),l={done:!1,value:t[0]},h=c0e(r&&r.length===t.length?r:l0e(t),e),i=o0e(h,t,{ease:Array.isArray(a)?a:u0e(t,a)});return{calculatedDuration:e,next:_=>(l.value=i(_),l.done=_>=e,l)}}const d0e=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Xa.update(t,!0),stop:()=>Bg(t),now:()=>vl.isProcessing?vl.timestamp:Bf.now()}},h0e={decay:KV,inertia:KV,tween:HA,keyframes:HA,spring:lX},f0e=e=>e/100;class X3 extends iX{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:_}=this.options;_&&_()};const{name:r,motionValue:n,element:a,keyframes:l}=this.options,h=(a==null?void 0:a.KeyframeResolver)||Z3,i=(_,w)=>this.onKeyframesResolved(_,w);this.resolver=new h(l,i,r,n,a),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:l,velocity:h=0}=this.options,i=C3(r)?r:h0e[r]||HA;let _,w;i!==HA&&typeof t[0]!="number"&&(_=aS(f0e,oX(t[0],t[1])),t=[0,100]);const A=i({...this.options,keyframes:t});l==="mirror"&&(w=i({...this.options,keyframes:[...t].reverse(),velocity:-h})),A.calculatedDuration===null&&(A.calculatedDuration=lY(A));const{calculatedDuration:C}=A,R=C+a,z=R*(n+1)-a;return{generator:A,mirroredGenerator:w,mapPercentToKeyframes:_,calculatedDuration:C,resolvedDuration:R,totalDuration:z}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:n}=this;if(!n){const{keyframes:ve}=this.options;return{done:!0,value:ve[ve.length-1]}}const{finalKeyframe:a,generator:l,mirroredGenerator:h,mapPercentToKeyframes:i,keyframes:_,calculatedDuration:w,totalDuration:A,resolvedDuration:C}=n;if(this.startTime===null)return l.next(0);const{delay:R,repeat:z,repeatType:V,repeatDelay:U,onUpdate:G}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-A/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const H=this.currentTime-R*(this.speed>=0?1:-1),J=this.speed>=0?H<0:H>A;this.currentTime=Math.max(H,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=A);let Q=this.currentTime,le=l;if(z){const ve=Math.min(this.currentTime,A)/C;let Ae=Math.floor(ve),Oe=ve%1;!Oe&&ve>=1&&(Oe=1),Oe===1&&Ae--,Ae=Math.min(Ae,z+1),!!(Ae%2)&&(V==="reverse"?(Oe=1-Oe,U&&(Oe-=U/C)):V==="mirror"&&(le=h)),Q=dm(0,1,Oe)*C}const ne=J?{done:!1,value:_[0]}:le.next(Q);i&&(ne.value=i(ne.value));let{done:de}=ne;!J&&w!==null&&(de=this.speed>=0?this.currentTime>=A:this.currentTime<=0);const ue=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&de);return ue&&a!==void 0&&(ne.value=IP(_,this.options,a)),G&&G(ne.value),ue&&this.finish(),ne}get duration(){const{resolved:t}=this;return t?im(t.calculatedDuration):0}get time(){return im(this.currentTime)}set time(t){t=nm(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=im(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=d0e,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),r&&r();const a=this.driver.now();this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=a):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const p0e=new Set(["opacity","clipPath","filter","transform"]);function m0e(e,t,r,{delay:n=0,duration:a=300,repeat:l=0,repeatType:h="loop",ease:i="easeInOut",times:_}={}){const w={[t]:r};_&&(w.offset=_);const A=dY(i,a);return Array.isArray(A)&&(w.easing=A),e.animate(w,{delay:n,duration:a,easing:Array.isArray(A)?"linear":A,fill:"both",iterations:l+1,direction:h==="reverse"?"alternate":"normal"})}const g0e=T3(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),ZA=10,y0e=2e4;function v0e(e){return C3(e.type)||e.type==="spring"||!uY(e.ease)}function _0e(e,t){const r=new X3({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:e[0]};const a=[];let l=0;for(;!n.done&&l<y0e;)n=r.sample(l),a.push(n.value),l+=ZA;return{times:void 0,keyframes:a,duration:l-ZA,ease:"linear"}}const uX={anticipate:BY,backInOut:FY,circInOut:UY};function x0e(e){return e in uX}class HV extends iX{constructor(t){super(t);const{name:r,motionValue:n,element:a,keyframes:l}=this.options;this.resolver=new nX(l,(h,i)=>this.onKeyframesResolved(h,i),r,n,a),this.resolver.scheduleResolve()}initPlayback(t,r){let{duration:n=300,times:a,ease:l,type:h,motionValue:i,name:_,startTime:w}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof l=="string"&&GA()&&x0e(l)&&(l=uX[l]),v0e(this.options)){const{onComplete:C,onUpdate:R,motionValue:z,element:V,...U}=this.options,G=_0e(t,U);t=G.keyframes,t.length===1&&(t[1]=t[0]),n=G.duration,a=G.times,l=G.ease,h="keyframes"}const A=m0e(i.owner.current,_,t,{...this.options,duration:n,times:a,ease:l});return A.startTime=w??this.calcStartTime(),this.pendingTimeline?(xV(A,this.pendingTimeline),this.pendingTimeline=void 0):A.onfinish=()=>{const{onComplete:C}=this.options;i.set(IP(t,this.options,r)),C&&C(),this.cancel(),this.resolveFinishedPromise()},{animation:A,duration:n,times:a,type:h,ease:l,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return im(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return im(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=nm(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return Su;const{animation:n}=r;xV(n,t)}return Su}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:n,duration:a,type:l,ease:h,times:i}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:w,onUpdate:A,onComplete:C,element:R,...z}=this.options,V=new X3({...z,keyframes:n,duration:a,type:l,ease:h,times:i,isGenerator:!0}),U=nm(this.time);w.setWithVelocity(V.sample(U-ZA).value,V.sample(U).value,ZA)}const{onStop:_}=this.options;_&&_(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:n,repeatDelay:a,repeatType:l,damping:h,type:i}=t;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:_,transformTemplate:w}=r.owner.getProps();return g0e()&&n&&p0e.has(n)&&!_&&!w&&!a&&l!=="mirror"&&h!==0&&i!=="inertia"}}const b0e={type:"spring",stiffness:500,damping:25,restSpeed:10},w0e=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),S0e={type:"keyframes",duration:.8},A0e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},T0e=(e,{keyframes:t})=>t.length>2?S0e:Wv.has(e)?e.startsWith("scale")?w0e(t[1]):b0e:A0e;function P0e({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:l,repeatType:h,repeatDelay:i,from:_,elapsed:w,...A}){return!!Object.keys(A).length}const J3=(e,t,r,n={},a,l)=>h=>{const i=E3(n,e)||{},_=i.delay||n.delay||0;let{elapsed:w=0}=n;w=w-nm(_);let A={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...i,delay:-w,onUpdate:R=>{t.set(R),i.onUpdate&&i.onUpdate(R)},onComplete:()=>{h(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:l?void 0:a};P0e(i)||(A={...A,...T0e(e,A)}),A.duration&&(A.duration=nm(A.duration)),A.repeatDelay&&(A.repeatDelay=nm(A.repeatDelay)),A.from!==void 0&&(A.keyframes[0]=A.from);let C=!1;if((A.type===!1||A.duration===0&&!A.repeatDelay)&&(A.duration=0,A.delay===0&&(C=!0)),A.allowFlatten=!i.type&&!i.ease,C&&!l&&t.get()!==void 0){const R=IP(A.keyframes,i);if(R!==void 0)return Xa.update(()=>{A.onUpdate(R),A.onComplete()}),new Zve([])}return!l&&HV.supports(A)?new HV(A):new X3(A)};function E0e({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function dX(e,t,{delay:r=0,transitionOverride:n,type:a}={}){var l;let{transition:h=e.getDefaultTransition(),transitionEnd:i,..._}=t;n&&(h=n);const w=[],A=a&&e.animationState&&e.animationState.getState()[a];for(const C in _){const R=e.getValue(C,(l=e.latestValues[C])!==null&&l!==void 0?l:null),z=_[C];if(z===void 0||A&&E0e(A,C))continue;const V={delay:r,...E3(h||{},C)};let U=!1;if(window.MotionHandoffAnimation){const H=NY(e);if(H){const J=window.MotionHandoffAnimation(H,C,Xa);J!==null&&(V.startTime=J,U=!0)}}mN(e,C),R.start(J3(C,R,z,e.shouldReduceMotion&&jY.has(C)?{type:!1}:V,e,U));const G=R.animation;G&&w.push(G)}return i&&Promise.all(w).then(()=>{Xa.update(()=>{i&&txe(e,i)})}),w}function TN(e,t,r={}){var n;const a=Z1(e,t,r.type==="exit"?(n=e.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:l=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(l=r.transitionOverride);const h=a?()=>Promise.all(dX(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(w=0)=>{const{delayChildren:A=0,staggerChildren:C,staggerDirection:R}=l;return C0e(e,t,A+w,C,R,r)}:()=>Promise.resolve(),{when:_}=l;if(_){const[w,A]=_==="beforeChildren"?[h,i]:[i,h];return w().then(()=>A())}else return Promise.all([h(),i(r.delay)])}function C0e(e,t,r=0,n=0,a=1,l){const h=[],i=(e.variantChildren.size-1)*n,_=a===1?(w=0)=>w*n:(w=0)=>i-w*n;return Array.from(e.variantChildren).sort(M0e).forEach((w,A)=>{w.notify("AnimationStart",t),h.push(TN(w,t,{...l,delay:r+_(A)}).then(()=>w.notify("AnimationComplete",t)))}),Promise.all(h)}function M0e(e,t){return e.sortNodePosition(t)}function O0e(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(l=>TN(e,l,r));n=Promise.all(a)}else if(typeof t=="string")n=TN(e,t,r);else{const a=typeof t=="function"?Z1(e,t,r.custom):t;n=Promise.all(dX(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function hX(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const R0e=j3.length;function fX(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?fX(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<R0e;r++){const n=j3[r],a=e.props[n];(K1(a)||a===!1)&&(t[n]=a)}return t}const k0e=[...k3].reverse(),j0e=k3.length;function N0e(e){return t=>Promise.all(t.map(({animation:r,options:n})=>O0e(e,r,n)))}function I0e(e){let t=N0e(e),r=ZV(),n=!0;const a=_=>(w,A)=>{var C;const R=Z1(e,A,_==="exit"?(C=e.presenceContext)===null||C===void 0?void 0:C.custom:void 0);if(R){const{transition:z,transitionEnd:V,...U}=R;w={...w,...U,...V}}return w};function l(_){t=_(e)}function h(_){const{props:w}=e,A=fX(e.parent)||{},C=[],R=new Set;let z={},V=1/0;for(let G=0;G<j0e;G++){const H=k0e[G],J=r[H],Q=w[H]!==void 0?w[H]:A[H],le=K1(Q),ne=H===_?J.isActive:null;ne===!1&&(V=G);let de=Q===A[H]&&Q!==w[H]&&le;if(de&&n&&e.manuallyAnimateOnMount&&(de=!1),J.protectedKeys={...z},!J.isActive&&ne===null||!Q&&!J.prevProp||jP(Q)||typeof Q=="boolean")continue;const ue=D0e(J.prevProp,Q);let ve=ue||H===_&&J.isActive&&!de&&le||G>V&&le,Ae=!1;const Oe=Array.isArray(Q)?Q:[Q];let Se=Oe.reduce(a(H),{});ne===!1&&(Se={});const{prevResolvedValues:ke={}}=J,ze={...ke,...Se},et=Ye=>{ve=!0,R.has(Ye)&&(Ae=!0,R.delete(Ye)),J.needsAnimating[Ye]=!0;const $e=e.getValue(Ye);$e&&($e.liveStyle=!1)};for(const Ye in ze){const $e=Se[Ye],We=ke[Ye];if(z.hasOwnProperty(Ye))continue;let Et=!1;pN($e)&&pN(We)?Et=!hX($e,We):Et=$e!==We,Et?$e!=null?et(Ye):R.add(Ye):$e!==void 0&&R.has(Ye)?et(Ye):J.protectedKeys[Ye]=!0}J.prevProp=Q,J.prevResolvedValues=Se,J.isActive&&(z={...z,...Se}),n&&e.blockInitialAnimation&&(ve=!1),ve&&(!(de&&ue)||Ae)&&C.push(...Oe.map(Ye=>({animation:Ye,options:{type:H}})))}if(R.size){const G={};if(typeof w.initial!="boolean"){const H=Z1(e,Array.isArray(w.initial)?w.initial[0]:w.initial);H&&H.transition&&(G.transition=H.transition)}R.forEach(H=>{const J=e.getBaseTarget(H),Q=e.getValue(H);Q&&(Q.liveStyle=!0),G[H]=J??null}),C.push({animation:G})}let U=!!C.length;return n&&(w.initial===!1||w.initial===w.animate)&&!e.manuallyAnimateOnMount&&(U=!1),n=!1,U?t(C):Promise.resolve()}function i(_,w){var A;if(r[_].isActive===w)return Promise.resolve();(A=e.variantChildren)===null||A===void 0||A.forEach(R=>{var z;return(z=R.animationState)===null||z===void 0?void 0:z.setActive(_,w)}),r[_].isActive=w;const C=h(_);for(const R in r)r[R].protectedKeys={};return C}return{animateChanges:h,setActive:i,setAnimateFunction:l,getState:()=>r,reset:()=>{r=ZV(),n=!0}}}function D0e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!hX(t,e):!1}function Jy(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function ZV(){return{animate:Jy(!0),whileInView:Jy(),whileHover:Jy(),whileTap:Jy(),whileDrag:Jy(),whileFocus:Jy(),exit:Jy()}}class Kg{constructor(t){this.isMounted=!1,this.node=t}update(){}}class L0e extends Kg{constructor(t){super(t),t.animationState||(t.animationState=I0e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();jP(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let z0e=0;class F0e extends Kg{constructor(){super(...arguments),this.id=z0e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const B0e={animation:{Feature:L0e},exit:{Feature:F0e}};function X1(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function oS(e){return{point:{x:e.pageX,y:e.pageY}}}const V0e=e=>t=>R3(t)&&e(t,oS(t));function l1(e,t,r,n){return X1(e,t,V0e(r),n)}function pX({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function U0e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function $0e(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const mX=1e-4,q0e=1-mX,G0e=1+mX,gX=.01,K0e=0-gX,W0e=0+gX;function oc(e){return e.max-e.min}function H0e(e,t,r){return Math.abs(e-t)<=r}function YV(e,t,r,n=.5){e.origin=n,e.originPoint=ko(t.min,t.max,e.origin),e.scale=oc(r)/oc(t),e.translate=ko(r.min,r.max,e.origin)-e.originPoint,(e.scale>=q0e&&e.scale<=G0e||isNaN(e.scale))&&(e.scale=1),(e.translate>=K0e&&e.translate<=W0e||isNaN(e.translate))&&(e.translate=0)}function c1(e,t,r,n){YV(e.x,t.x,r.x,n?n.originX:void 0),YV(e.y,t.y,r.y,n?n.originY:void 0)}function XV(e,t,r){e.min=r.min+t.min,e.max=e.min+oc(t)}function Z0e(e,t,r){XV(e.x,t.x,r.x),XV(e.y,t.y,r.y)}function JV(e,t,r){e.min=t.min-r.min,e.max=e.min+oc(t)}function u1(e,t,r){JV(e.x,t.x,r.x),JV(e.y,t.y,r.y)}const QV=()=>({translate:0,scale:1,origin:0,originPoint:0}),tx=()=>({x:QV(),y:QV()}),eU=()=>({min:0,max:0}),Yo=()=>({x:eU(),y:eU()});function gd(e){return[e("x"),e("y")]}function hM(e){return e===void 0||e===1}function PN({scale:e,scaleX:t,scaleY:r}){return!hM(e)||!hM(t)||!hM(r)}function rv(e){return PN(e)||yX(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function yX(e){return tU(e.x)||tU(e.y)}function tU(e){return e&&e!=="0%"}function YA(e,t,r){const n=e-r,a=t*n;return r+a}function rU(e,t,r,n,a){return a!==void 0&&(e=YA(e,a,n)),YA(e,r,n)+t}function EN(e,t=0,r=1,n,a){e.min=rU(e.min,t,r,n,a),e.max=rU(e.max,t,r,n,a)}function vX(e,{x:t,y:r}){EN(e.x,t.translate,t.scale,t.originPoint),EN(e.y,r.translate,r.scale,r.originPoint)}const nU=.999999999999,iU=1.0000000000001;function Y0e(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let l,h;for(let i=0;i<a;i++){l=r[i],h=l.projectionDelta;const{visualElement:_}=l.options;_&&_.props.style&&_.props.style.display==="contents"||(n&&l.options.layoutScroll&&l.scroll&&l!==l.root&&nx(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),h&&(t.x*=h.x.scale,t.y*=h.y.scale,vX(e,h)),n&&rv(l.latestValues)&&nx(e,l.latestValues))}t.x<iU&&t.x>nU&&(t.x=1),t.y<iU&&t.y>nU&&(t.y=1)}function rx(e,t){e.min=e.min+t,e.max=e.max+t}function aU(e,t,r,n,a=.5){const l=ko(e.min,e.max,a);EN(e,t,r,l,n)}function nx(e,t){aU(e.x,t.x,t.scaleX,t.scale,t.originX),aU(e.y,t.y,t.scaleY,t.scale,t.originY)}function _X(e,t){return pX($0e(e.getBoundingClientRect(),t))}function X0e(e,t,r){const n=_X(e,r),{scroll:a}=t;return a&&(rx(n.x,a.offset.x),rx(n.y,a.offset.y)),n}const xX=({current:e})=>e?e.ownerDocument.defaultView:null,oU=(e,t)=>Math.abs(e-t);function J0e(e,t){const r=oU(e.x,t.x),n=oU(e.y,t.y);return Math.sqrt(r**2+n**2)}class bX{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:l=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=pM(this.lastMoveEventInfo,this.history),R=this.startEvent!==null,z=J0e(C.offset,{x:0,y:0})>=3;if(!R&&!z)return;const{point:V}=C,{timestamp:U}=vl;this.history.push({...V,timestamp:U});const{onStart:G,onMove:H}=this.handlers;R||(G&&G(this.lastMoveEvent,C),this.startEvent=this.lastMoveEvent),H&&H(this.lastMoveEvent,C)},this.handlePointerMove=(C,R)=>{this.lastMoveEvent=C,this.lastMoveEventInfo=fM(R,this.transformPagePoint),Xa.update(this.updatePoint,!0)},this.handlePointerUp=(C,R)=>{this.end();const{onEnd:z,onSessionEnd:V,resumeAnimation:U}=this.handlers;if(this.dragSnapToOrigin&&U&&U(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const G=pM(C.type==="pointercancel"?this.lastMoveEventInfo:fM(R,this.transformPagePoint),this.history);this.startEvent&&z&&z(C,G),V&&V(C,G)},!R3(t))return;this.dragSnapToOrigin=l,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const h=oS(t),i=fM(h,this.transformPagePoint),{point:_}=i,{timestamp:w}=vl;this.history=[{..._,timestamp:w}];const{onSessionStart:A}=r;A&&A(t,pM(i,this.history)),this.removeListeners=aS(l1(this.contextWindow,"pointermove",this.handlePointerMove),l1(this.contextWindow,"pointerup",this.handlePointerUp),l1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Bg(this.updatePoint)}}function fM(e,t){return t?{point:t(e.point)}:e}function sU(e,t){return{x:e.x-t.x,y:e.y-t.y}}function pM({point:e},t){return{point:e,delta:sU(e,wX(t)),offset:sU(e,Q0e(t)),velocity:ebe(t,.1)}}function Q0e(e){return e[0]}function wX(e){return e[e.length-1]}function ebe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=wX(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>nm(t)));)r--;if(!n)return{x:0,y:0};const l=im(a.timestamp-n.timestamp);if(l===0)return{x:0,y:0};const h={x:(a.x-n.x)/l,y:(a.y-n.y)/l};return h.x===1/0&&(h.x=0),h.y===1/0&&(h.y=0),h}function tbe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ko(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ko(r,e,n.max):Math.min(e,r)),e}function lU(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function rbe(e,{top:t,left:r,bottom:n,right:a}){return{x:lU(e.x,r,a),y:lU(e.y,t,n)}}function cU(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function nbe(e,t){return{x:cU(e.x,t.x),y:cU(e.y,t.y)}}function ibe(e,t){let r=.5;const n=oc(e),a=oc(t);return a>n?r=Sx(t.min,t.max-n,e.min):n>a&&(r=Sx(e.min,e.max-a,t.min)),dm(0,1,r)}function abe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const CN=.35;function obe(e=CN){return e===!1?e=0:e===!0&&(e=CN),{x:uU(e,"left","right"),y:uU(e,"top","bottom")}}function uU(e,t,r){return{min:dU(e,t),max:dU(e,r)}}function dU(e,t){return typeof e=="number"?e:e[t]||0}const sbe=new WeakMap;class lbe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Yo(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=A=>{const{dragSnapToOrigin:C}=this.getProps();C?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(oS(A).point)},l=(A,C)=>{const{drag:R,dragPropagation:z,onDragStart:V}=this.getProps();if(R&&!z&&(this.openDragLock&&this.openDragLock(),this.openDragLock=t_e(R),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),gd(G=>{let H=this.getAxisMotionValue(G).get()||0;if(Vf.test(H)){const{projection:J}=this.visualElement;if(J&&J.layout){const Q=J.layout.layoutBox[G];Q&&(H=oc(Q)*(parseFloat(H)/100))}}this.originPoint[G]=H}),V&&Xa.postRender(()=>V(A,C)),mN(this.visualElement,"transform");const{animationState:U}=this.visualElement;U&&U.setActive("whileDrag",!0)},h=(A,C)=>{const{dragPropagation:R,dragDirectionLock:z,onDirectionLock:V,onDrag:U}=this.getProps();if(!R&&!this.openDragLock)return;const{offset:G}=C;if(z&&this.currentDirection===null){this.currentDirection=cbe(G),this.currentDirection!==null&&V&&V(this.currentDirection);return}this.updateAxis("x",C.point,G),this.updateAxis("y",C.point,G),this.visualElement.render(),U&&U(A,C)},i=(A,C)=>this.stop(A,C),_=()=>gd(A=>{var C;return this.getAnimationState(A)==="paused"&&((C=this.getAxisMotionValue(A).animation)===null||C===void 0?void 0:C.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new bX(t,{onSessionStart:a,onStart:l,onMove:h,onSessionEnd:i,resumeAnimation:_},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,contextWindow:xX(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&Xa.postRender(()=>l(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!D2(t,a,this.currentDirection))return;const l=this.getAxisMotionValue(t);let h=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(h=tbe(h,this.constraints[t],this.elastic[t])),l.set(h)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,l=this.constraints;r&&Q_(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=rbe(a.layoutBox,r):this.constraints=!1,this.elastic=obe(n),l!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&gd(h=>{this.constraints!==!1&&this.getAxisMotionValue(h)&&(this.constraints[h]=abe(a.layoutBox[h],this.constraints[h]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Q_(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const l=X0e(n,a.root,this.visualElement.getTransformPagePoint());let h=nbe(a.layout.layoutBox,l);if(r){const i=r(U0e(h));this.hasMutatedConstraints=!!i,i&&(h=pX(i))}return h}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:l,dragSnapToOrigin:h,onDragTransitionEnd:i}=this.getProps(),_=this.constraints||{},w=gd(A=>{if(!D2(A,r,this.currentDirection))return;let C=_&&_[A]||{};h&&(C={min:0,max:0});const R=a?200:1e6,z=a?40:1e7,V={type:"inertia",velocity:n?t[A]:0,bounceStiffness:R,bounceDamping:z,timeConstant:750,restDelta:1,restSpeed:10,...l,...C};return this.startAxisValueAnimation(A,V)});return Promise.all(w).then(i)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return mN(this.visualElement,t),n.start(J3(t,n,0,r,this.visualElement,!1))}stopAnimation(){gd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){gd(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){gd(r=>{const{drag:n}=this.getProps();if(!D2(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,l=this.getAxisMotionValue(r);if(a&&a.layout){const{min:h,max:i}=a.layout.layoutBox[r];l.set(t[r]-ko(h,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Q_(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};gd(h=>{const i=this.getAxisMotionValue(h);if(i&&this.constraints!==!1){const _=i.get();a[h]=ibe({min:_,max:_},this.constraints[h])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),gd(h=>{if(!D2(h,t,null))return;const i=this.getAxisMotionValue(h),{min:_,max:w}=this.constraints[h];i.set(ko(_,w,a[h]))})}addListeners(){if(!this.visualElement.current)return;sbe.set(this.visualElement,this);const t=this.visualElement.current,r=l1(t,"pointerdown",_=>{const{drag:w,dragListener:A=!0}=this.getProps();w&&A&&this.start(_)}),n=()=>{const{dragConstraints:_}=this.getProps();Q_(_)&&_.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,l=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),Xa.read(n);const h=X1(window,"resize",()=>this.scalePositionWithinConstraints()),i=a.addEventListener("didUpdate",({delta:_,hasLayoutChanged:w})=>{this.isDragging&&w&&(gd(A=>{const C=this.getAxisMotionValue(A);C&&(this.originPoint[A]+=_[A].translate,C.set(C.get()+_[A].translate))}),this.visualElement.render())});return()=>{h(),r(),l(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:l=!1,dragElastic:h=CN,dragMomentum:i=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:l,dragElastic:h,dragMomentum:i}}}function D2(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function cbe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class ube extends Kg{constructor(t){super(t),this.removeGroupControls=Su,this.removeListeners=Su,this.controls=new lbe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Su}unmount(){this.removeGroupControls(),this.removeListeners()}}const hU=e=>(t,r)=>{e&&Xa.postRender(()=>e(t,r))};class dbe extends Kg{constructor(){super(...arguments),this.removePointerDownListener=Su}onPointerDown(t){this.session=new bX(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:xX(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:hU(t),onStart:hU(r),onMove:n,onEnd:(l,h)=>{delete this.session,a&&Xa.postRender(()=>a(l,h))}}}mount(){this.removePointerDownListener=l1(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const mA={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function fU(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Db={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ri.test(e))e=parseFloat(e);else return e;const r=fU(e,t.target.x),n=fU(e,t.target.y);return`${r}% ${n}%`}},hbe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=Vg.parse(e);if(a.length>5)return n;const l=Vg.createTransformer(e),h=typeof a[0]!="number"?1:0,i=r.x.scale*t.x,_=r.y.scale*t.y;a[0+h]/=i,a[1+h]/=_;const w=ko(i,_,.5);return typeof a[2+h]=="number"&&(a[2+h]/=w),typeof a[3+h]=="number"&&(a[3+h]/=w),l(a)}};class fbe extends K.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:l}=t;M_e(pbe),l&&(r.group&&r.group.add(l),n&&n.register&&a&&n.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),mA.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:l}=this.props,h=n.projection;return h&&(h.isPresent=l,a||t.layoutDependency!==r||r===void 0||t.isPresent!==l?h.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?h.promote():h.relegate()||Xa.postRender(()=>{const i=h.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),O3.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function SX(e){const[t,r]=Gve(),n=K.useContext(iY);return f.jsx(fbe,{...e,layoutGroup:n,switchLayoutGroup:K.useContext(xY),isPresent:t,safeToRemove:r})}const pbe={borderRadius:{...Db,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Db,borderTopRightRadius:Db,borderBottomLeftRadius:Db,borderBottomRightRadius:Db,boxShadow:hbe};function mbe(e,t,r){const n=Fl(e)?e:G1(e);return n.start(J3("",n,t,r)),n.animation}function gbe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const ybe=(e,t)=>e.depth-t.depth;class vbe{constructor(){this.children=[],this.isDirty=!1}add(t){S3(this.children,t),this.isDirty=!0}remove(t){A3(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(ybe),this.isDirty=!1,this.children.forEach(t)}}function _be(e,t){const r=Bf.now(),n=({timestamp:a})=>{const l=a-r;l>=t&&(Bg(n),e(l-t))};return Xa.read(n,!0),()=>Bg(n)}const AX=["TopLeft","TopRight","BottomLeft","BottomRight"],xbe=AX.length,pU=e=>typeof e=="string"?parseFloat(e):e,mU=e=>typeof e=="number"||ri.test(e);function bbe(e,t,r,n,a,l){a?(e.opacity=ko(0,r.opacity!==void 0?r.opacity:1,wbe(n)),e.opacityExit=ko(t.opacity!==void 0?t.opacity:1,0,Sbe(n))):l&&(e.opacity=ko(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let h=0;h<xbe;h++){const i=`border${AX[h]}Radius`;let _=gU(t,i),w=gU(r,i);if(_===void 0&&w===void 0)continue;_||(_=0),w||(w=0),_===0||w===0||mU(_)===mU(w)?(e[i]=Math.max(ko(pU(_),pU(w),n),0),(Vf.test(w)||Vf.test(_))&&(e[i]+="%")):e[i]=w}(t.rotate||r.rotate)&&(e.rotate=ko(t.rotate||0,r.rotate||0,n))}function gU(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const wbe=TX(0,.5,VY),Sbe=TX(.5,.95,Su);function TX(e,t,r){return n=>n<e?0:n>t?1:r(Sx(e,t,n))}function yU(e,t){e.min=t.min,e.max=t.max}function fd(e,t){yU(e.x,t.x),yU(e.y,t.y)}function vU(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function _U(e,t,r,n,a){return e-=t,e=YA(e,1/r,n),a!==void 0&&(e=YA(e,1/a,n)),e}function Abe(e,t=0,r=1,n=.5,a,l=e,h=e){if(Vf.test(t)&&(t=parseFloat(t),t=ko(h.min,h.max,t/100)-h.min),typeof t!="number")return;let i=ko(l.min,l.max,n);e===l&&(i-=t),e.min=_U(e.min,t,r,i,a),e.max=_U(e.max,t,r,i,a)}function xU(e,t,[r,n,a],l,h){Abe(e,t[r],t[n],t[a],t.scale,l,h)}const Tbe=["x","scaleX","originX"],Pbe=["y","scaleY","originY"];function bU(e,t,r,n){xU(e.x,t,Tbe,r?r.x:void 0,n?n.x:void 0),xU(e.y,t,Pbe,r?r.y:void 0,n?n.y:void 0)}function wU(e){return e.translate===0&&e.scale===1}function PX(e){return wU(e.x)&&wU(e.y)}function SU(e,t){return e.min===t.min&&e.max===t.max}function Ebe(e,t){return SU(e.x,t.x)&&SU(e.y,t.y)}function AU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function EX(e,t){return AU(e.x,t.x)&&AU(e.y,t.y)}function TU(e){return oc(e.x)/oc(e.y)}function PU(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Cbe{constructor(){this.members=[]}add(t){S3(this.members,t),t.scheduleRender()}remove(t){if(A3(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const l=this.members[a];if(l.isPresent!==!1){n=l;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Mbe(e,t,r){let n="";const a=e.x.translate/t.x,l=e.y.translate/t.y,h=(r==null?void 0:r.z)||0;if((a||l||h)&&(n=`translate3d(${a}px, ${l}px, ${h}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:w,rotate:A,rotateX:C,rotateY:R,skewX:z,skewY:V}=r;w&&(n=`perspective(${w}px) ${n}`),A&&(n+=`rotate(${A}deg) `),C&&(n+=`rotateX(${C}deg) `),R&&(n+=`rotateY(${R}deg) `),z&&(n+=`skewX(${z}deg) `),V&&(n+=`skewY(${V}deg) `)}const i=e.x.scale*t.x,_=e.y.scale*t.y;return(i!==1||_!==1)&&(n+=`scale(${i}, ${_})`),n||"none"}const mM=["","X","Y","Z"],Obe={visibility:"hidden"},EU=1e3;let Rbe=0;function gM(e,t,r,n){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),n&&(n[e]=0))}function CX(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=NY(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Xa,!(a||l))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&CX(n)}function MX({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(h={},i=t==null?void 0:t()){this.id=Rbe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Nbe),this.nodes.forEach(Fbe),this.nodes.forEach(Bbe),this.nodes.forEach(Ibe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=h,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let _=0;_<this.path.length;_++)this.path[_].shouldResetTransform=!0;this.root===this&&(this.nodes=new vbe)}addEventListener(h,i){return this.eventHandlers.has(h)||this.eventHandlers.set(h,new P3),this.eventHandlers.get(h).add(i)}notifyListeners(h,...i){const _=this.eventHandlers.get(h);_&&_.notify(...i)}hasListeners(h){return this.eventHandlers.has(h)}mount(h,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=gbe(h),this.instance=h;const{layoutId:_,layout:w,visualElement:A}=this.options;if(A&&!A.current&&A.mount(h),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(w||_)&&(this.isLayoutDirty=!0),e){let C;const R=()=>this.root.updateBlockedByResize=!1;e(h,()=>{this.root.updateBlockedByResize=!0,C&&C(),C=_be(R,250),mA.hasAnimatedSinceResize&&(mA.hasAnimatedSinceResize=!1,this.nodes.forEach(MU))})}_&&this.root.registerSharedNode(_,this),this.options.animate!==!1&&A&&(_||w)&&this.addEventListener("didUpdate",({delta:C,hasLayoutChanged:R,hasRelativeLayoutChanged:z,layout:V})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const U=this.options.transition||A.getDefaultTransition()||Gbe,{onLayoutAnimationStart:G,onLayoutAnimationComplete:H}=A.getProps(),J=!this.targetLayout||!EX(this.targetLayout,V),Q=!R&&z;if(this.options.layoutRoot||this.resumeFrom||Q||R&&(J||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(C,Q);const le={...E3(U,"layout"),onPlay:G,onComplete:H};(A.shouldReduceMotion||this.options.layoutRoot)&&(le.delay=0,le.type=!1),this.startAnimation(le)}else R||MU(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=V})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const h=this.getStack();h&&h.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Bg(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Vbe),this.animationId++)}getTransformTemplate(){const{visualElement:h}=this.options;return h&&h.getProps().transformTemplate}willUpdate(h=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&CX(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let A=0;A<this.path.length;A++){const C=this.path[A];C.shouldResetTransform=!0,C.updateScroll("snapshot"),C.options.layoutRoot&&C.willUpdate(!1)}const{layoutId:i,layout:_}=this.options;if(i===void 0&&!_)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),h&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(CU);return}this.isUpdating||this.nodes.forEach(Lbe),this.isUpdating=!1,this.nodes.forEach(zbe),this.nodes.forEach(kbe),this.nodes.forEach(jbe),this.clearAllSnapshots();const i=Bf.now();vl.delta=dm(0,1e3/60,i-vl.timestamp),vl.timestamp=i,vl.isProcessing=!0,sM.update.process(vl),sM.preRender.process(vl),sM.render.process(vl),vl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,O3.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Dbe),this.sharedNodes.forEach(Ube)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Xa.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Xa.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!oc(this.snapshot.measuredBox.x)&&!oc(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let _=0;_<this.path.length;_++)this.path[_].updateScroll();const h=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Yo(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,h?h.layoutBox:void 0)}updateScroll(h="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===h&&(i=!1),i){const _=n(this.instance);this.scroll={animationId:this.root.animationId,phase:h,isRoot:_,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:_}}}resetTransform(){if(!a)return;const h=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!PX(this.projectionDelta),_=this.getTransformTemplate(),w=_?_(this.latestValues,""):void 0,A=w!==this.prevTransformTemplateValue;h&&(i||rv(this.latestValues)||A)&&(a(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(h=!0){const i=this.measurePageBox();let _=this.removeElementScroll(i);return h&&(_=this.removeTransform(_)),Kbe(_),{animationId:this.root.animationId,measuredBox:i,layoutBox:_,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:i}=this.options;if(!i)return Yo();const _=i.measureViewportBox();if(!(((h=this.scroll)===null||h===void 0?void 0:h.wasRoot)||this.path.some(Wbe))){const{scroll:A}=this.root;A&&(rx(_.x,A.offset.x),rx(_.y,A.offset.y))}return _}removeElementScroll(h){var i;const _=Yo();if(fd(_,h),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return _;for(let w=0;w<this.path.length;w++){const A=this.path[w],{scroll:C,options:R}=A;A!==this.root&&C&&R.layoutScroll&&(C.wasRoot&&fd(_,h),rx(_.x,C.offset.x),rx(_.y,C.offset.y))}return _}applyTransform(h,i=!1){const _=Yo();fd(_,h);for(let w=0;w<this.path.length;w++){const A=this.path[w];!i&&A.options.layoutScroll&&A.scroll&&A!==A.root&&nx(_,{x:-A.scroll.offset.x,y:-A.scroll.offset.y}),rv(A.latestValues)&&nx(_,A.latestValues)}return rv(this.latestValues)&&nx(_,this.latestValues),_}removeTransform(h){const i=Yo();fd(i,h);for(let _=0;_<this.path.length;_++){const w=this.path[_];if(!w.instance||!rv(w.latestValues))continue;PN(w.latestValues)&&w.updateSnapshot();const A=Yo(),C=w.measurePageBox();fd(A,C),bU(i,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,A)}return rv(this.latestValues)&&bU(i,this.latestValues),i}setTargetDelta(h){this.targetDelta=h,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(h){this.options={...this.options,...h,crossfade:h.crossfade!==void 0?h.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(h=!1){var i;const _=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=_.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=_.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=_.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==_;if(!(h||w&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:C,layoutId:R}=this.options;if(!(!this.layout||!(C||R))){if(this.resolvedRelativeTargetAt=vl.timestamp,!this.targetDelta&&!this.relativeTarget){const z=this.getClosestProjectingParent();z&&z.layout&&this.animationProgress!==1?(this.relativeParent=z,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Yo(),this.relativeTargetOrigin=Yo(),u1(this.relativeTargetOrigin,this.layout.layoutBox,z.layout.layoutBox),fd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Yo(),this.targetWithTransforms=Yo()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Z0e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):fd(this.target,this.layout.layoutBox),vX(this.target,this.targetDelta)):fd(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const z=this.getClosestProjectingParent();z&&!!z.resumingFrom==!!this.resumingFrom&&!z.options.layoutScroll&&z.target&&this.animationProgress!==1?(this.relativeParent=z,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Yo(),this.relativeTargetOrigin=Yo(),u1(this.relativeTargetOrigin,this.target,z.target),fd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||PN(this.parent.latestValues)||yX(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var h;const i=this.getLead(),_=!!this.resumingFrom||this!==i;let w=!0;if((this.isProjectionDirty||!((h=this.parent)===null||h===void 0)&&h.isProjectionDirty)&&(w=!1),_&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===vl.timestamp&&(w=!1),w)return;const{layout:A,layoutId:C}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(A||C))return;fd(this.layoutCorrected,this.layout.layoutBox);const R=this.treeScale.x,z=this.treeScale.y;Y0e(this.layoutCorrected,this.treeScale,this.path,_),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Yo());const{target:V}=i;if(!V){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(vU(this.prevProjectionDelta.x,this.projectionDelta.x),vU(this.prevProjectionDelta.y,this.projectionDelta.y)),c1(this.projectionDelta,this.layoutCorrected,V,this.latestValues),(this.treeScale.x!==R||this.treeScale.y!==z||!PU(this.projectionDelta.x,this.prevProjectionDelta.x)||!PU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",V))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(h=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),h){const _=this.getStack();_&&_.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=tx(),this.projectionDelta=tx(),this.projectionDeltaWithTransform=tx()}setAnimationOrigin(h,i=!1){const _=this.snapshot,w=_?_.latestValues:{},A={...this.latestValues},C=tx();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const R=Yo(),z=_?_.source:void 0,V=this.layout?this.layout.source:void 0,U=z!==V,G=this.getStack(),H=!G||G.members.length<=1,J=!!(U&&!H&&this.options.crossfade===!0&&!this.path.some(qbe));this.animationProgress=0;let Q;this.mixTargetDelta=le=>{const ne=le/1e3;OU(C.x,h.x,ne),OU(C.y,h.y,ne),this.setTargetDelta(C),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(u1(R,this.layout.layoutBox,this.relativeParent.layout.layoutBox),$be(this.relativeTarget,this.relativeTargetOrigin,R,ne),Q&&Ebe(this.relativeTarget,Q)&&(this.isProjectionDirty=!1),Q||(Q=Yo()),fd(Q,this.relativeTarget)),U&&(this.animationValues=A,bbe(A,w,this.latestValues,ne,J,H)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ne},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(h){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Bg(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Xa.update(()=>{mA.hasAnimatedSinceResize=!0,this.currentAnimation=mbe(0,EU,{...h,onUpdate:i=>{this.mixTargetDelta(i),h.onUpdate&&h.onUpdate(i)},onStop:()=>{},onComplete:()=>{h.onComplete&&h.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const h=this.getStack();h&&h.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(EU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const h=this.getLead();let{targetWithTransforms:i,target:_,layout:w,latestValues:A}=h;if(!(!i||!_||!w)){if(this!==h&&this.layout&&w&&OX(this.options.animationType,this.layout.layoutBox,w.layoutBox)){_=this.target||Yo();const C=oc(this.layout.layoutBox.x);_.x.min=h.target.x.min,_.x.max=_.x.min+C;const R=oc(this.layout.layoutBox.y);_.y.min=h.target.y.min,_.y.max=_.y.min+R}fd(i,_),nx(i,A),c1(this.projectionDeltaWithTransform,this.layoutCorrected,i,A)}}registerSharedNode(h,i){this.sharedNodes.has(h)||this.sharedNodes.set(h,new Cbe),this.sharedNodes.get(h).add(i);const w=i.options.initialPromotionConfig;i.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(i):void 0})}isLead(){const h=this.getStack();return h?h.lead===this:!0}getLead(){var h;const{layoutId:i}=this.options;return i?((h=this.getStack())===null||h===void 0?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:i}=this.options;return i?(h=this.getStack())===null||h===void 0?void 0:h.prevLead:void 0}getStack(){const{layoutId:h}=this.options;if(h)return this.root.sharedNodes.get(h)}promote({needsReset:h,transition:i,preserveFollowOpacity:_}={}){const w=this.getStack();w&&w.promote(this,_),h&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const h=this.getStack();return h?h.relegate(this):!1}resetSkewAndRotation(){const{visualElement:h}=this.options;if(!h)return;let i=!1;const{latestValues:_}=h;if((_.z||_.rotate||_.rotateX||_.rotateY||_.rotateZ||_.skewX||_.skewY)&&(i=!0),!i)return;const w={};_.z&&gM("z",h,w,this.animationValues);for(let A=0;A<mM.length;A++)gM(`rotate${mM[A]}`,h,w,this.animationValues),gM(`skew${mM[A]}`,h,w,this.animationValues);h.render();for(const A in w)h.setStaticValue(A,w[A]),this.animationValues&&(this.animationValues[A]=w[A]);h.scheduleRender()}getProjectionStyles(h){var i,_;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Obe;const w={visibility:""},A=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,w.opacity="",w.pointerEvents=pA(h==null?void 0:h.pointerEvents)||"",w.transform=A?A(this.latestValues,""):"none",w;const C=this.getLead();if(!this.projectionDelta||!this.layout||!C.target){const U={};return this.options.layoutId&&(U.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,U.pointerEvents=pA(h==null?void 0:h.pointerEvents)||""),this.hasProjected&&!rv(this.latestValues)&&(U.transform=A?A({},""):"none",this.hasProjected=!1),U}const R=C.animationValues||C.latestValues;this.applyTransformsToTarget(),w.transform=Mbe(this.projectionDeltaWithTransform,this.treeScale,R),A&&(w.transform=A(R,w.transform));const{x:z,y:V}=this.projectionDelta;w.transformOrigin=`${z.origin*100}% ${V.origin*100}% 0`,C.animationValues?w.opacity=C===this?(_=(i=R.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&_!==void 0?_:1:this.preserveOpacity?this.latestValues.opacity:R.opacityExit:w.opacity=C===this?R.opacity!==void 0?R.opacity:"":R.opacityExit!==void 0?R.opacityExit:0;for(const U in W1){if(R[U]===void 0)continue;const{correct:G,applyTo:H,isCSSVariable:J}=W1[U],Q=w.transform==="none"?R[U]:G(R[U],C);if(H){const le=H.length;for(let ne=0;ne<le;ne++)w[H[ne]]=Q}else J?this.options.visualElement.renderState.vars[U]=Q:w[U]=Q}return this.options.layoutId&&(w.pointerEvents=C===this?pA(h==null?void 0:h.pointerEvents)||"":"none"),w}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(h=>{var i;return(i=h.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(CU),this.root.sharedNodes.clear()}}}function kbe(e){e.updateLayout()}function jbe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:l}=e.options,h=r.source!==e.layout.source;l==="size"?gd(C=>{const R=h?r.measuredBox[C]:r.layoutBox[C],z=oc(R);R.min=n[C].min,R.max=R.min+z}):OX(l,r.layoutBox,n)&&gd(C=>{const R=h?r.measuredBox[C]:r.layoutBox[C],z=oc(n[C]);R.max=R.min+z,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[C].max=e.relativeTarget[C].min+z)});const i=tx();c1(i,n,r.layoutBox);const _=tx();h?c1(_,e.applyTransform(a,!0),r.measuredBox):c1(_,n,r.layoutBox);const w=!PX(i);let A=!1;if(!e.resumeFrom){const C=e.getClosestProjectingParent();if(C&&!C.resumeFrom){const{snapshot:R,layout:z}=C;if(R&&z){const V=Yo();u1(V,r.layoutBox,R.layoutBox);const U=Yo();u1(U,n,z.layoutBox),EX(V,U)||(A=!0),C.options.layoutRoot&&(e.relativeTarget=U,e.relativeTargetOrigin=V,e.relativeParent=C)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:_,layoutDelta:i,hasLayoutChanged:w,hasRelativeLayoutChanged:A})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Nbe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Ibe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Dbe(e){e.clearSnapshot()}function CU(e){e.clearMeasurements()}function Lbe(e){e.isLayoutDirty=!1}function zbe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function MU(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Fbe(e){e.resolveTargetDelta()}function Bbe(e){e.calcProjection()}function Vbe(e){e.resetSkewAndRotation()}function Ube(e){e.removeLeadSnapshot()}function OU(e,t,r){e.translate=ko(t.translate,0,r),e.scale=ko(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function RU(e,t,r,n){e.min=ko(t.min,r.min,n),e.max=ko(t.max,r.max,n)}function $be(e,t,r,n){RU(e.x,t.x,r.x,n),RU(e.y,t.y,r.y,n)}function qbe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Gbe={duration:.45,ease:[.4,0,.1,1]},kU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),jU=kU("applewebkit/")&&!kU("chrome/")?Math.round:Su;function NU(e){e.min=jU(e.min),e.max=jU(e.max)}function Kbe(e){NU(e.x),NU(e.y)}function OX(e,t,r){return e==="position"||e==="preserve-aspect"&&!H0e(TU(t),TU(r),.2)}function Wbe(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const Hbe=MX({attachResizeListener:(e,t)=>X1(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),yM={current:void 0},RX=MX({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!yM.current){const e=new Hbe({});e.mount(window),e.setOptions({layoutScroll:!0}),yM.current=e}return yM.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Zbe={pan:{Feature:dbe},drag:{Feature:ube,ProjectionNode:RX,MeasureLayout:SX}};function IU(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,l=n[a];l&&Xa.postRender(()=>l(t,oS(t)))}class Ybe extends Kg{mount(){const{current:t}=this.node;t&&(this.unmount=n_e(t,(r,n)=>(IU(this.node,n,"Start"),a=>IU(this.node,a,"End"))))}unmount(){}}class Xbe extends Kg{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=aS(X1(this.node.current,"focus",()=>this.onFocus()),X1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function DU(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),l=n[a];l&&Xa.postRender(()=>l(t,oS(t)))}class Jbe extends Kg{mount(){const{current:t}=this.node;t&&(this.unmount=s_e(t,(r,n)=>(DU(this.node,n,"Start"),(a,{success:l})=>DU(this.node,a,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const MN=new WeakMap,vM=new WeakMap,Qbe=e=>{const t=MN.get(e.target);t&&t(e)},e1e=e=>{e.forEach(Qbe)};function t1e({root:e,...t}){const r=e||document;vM.has(r)||vM.set(r,{});const n=vM.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(e1e,{root:e,...t})),n[a]}function r1e(e,t,r){const n=t1e(t);return MN.set(e,r),n.observe(e),()=>{MN.delete(e),n.unobserve(e)}}const n1e={some:0,all:1};class i1e extends Kg{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:l}=t,h={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:n1e[a]},i=_=>{const{isIntersecting:w}=_;if(this.isInView===w||(this.isInView=w,l&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:A,onViewportLeave:C}=this.node.getProps(),R=w?A:C;R&&R(_)};return r1e(this.node.current,h,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(a1e(t,r))&&this.startObserver()}unmount(){}}function a1e({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const o1e={inView:{Feature:i1e},tap:{Feature:Jbe},focus:{Feature:Xbe},hover:{Feature:Ybe}},s1e={layout:{ProjectionNode:RX,MeasureLayout:SX}},ON={current:null},kX={current:!1};function l1e(){if(kX.current=!0,!!b3)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>ON.current=e.matches;e.addListener(t),t()}else ON.current=!1}const c1e=[...rX,Il,Vg],u1e=e=>c1e.find(tX(e)),d1e=new WeakMap;function h1e(e,t,r){for(const n in t){const a=t[n],l=r[n];if(Fl(a))e.addValue(n,a);else if(Fl(l))e.addValue(n,G1(a,{owner:e}));else if(l!==a)if(e.hasValue(n)){const h=e.getValue(n);h.liveStyle===!0?h.jump(a):h.hasAnimated||h.set(a)}else{const h=e.getStaticValue(n);e.addValue(n,G1(h!==void 0?h:a,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const LU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class f1e{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:l,visualState:h},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Z3,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const z=Bf.now();this.renderScheduledAt<z&&(this.renderScheduledAt=z,Xa.render(this.render,!1,!0))};const{latestValues:_,renderState:w,onUpdate:A}=h;this.onUpdate=A,this.latestValues=_,this.baseTarget={..._},this.initialValues=r.initial?{..._}:{},this.renderState=w,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!l,this.isControllingVariants=NP(r),this.isVariantNode=vY(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:C,...R}=this.scrapeMotionValuesFromProps(r,{},this);for(const z in R){const V=R[z];_[z]!==void 0&&Fl(V)&&V.set(_[z],!1)}}mount(t){this.current=t,d1e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),kX.current||l1e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:ON.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Bg(this.notifyUpdate),Bg(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Wv.has(t);n&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Xa.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),l=r.on("renderRequest",this.scheduleRender);let h;window.MotionCheckAppearSync&&(h=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),l(),h&&h(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ax){const r=Ax[t];if(!r)continue;const{isEnabled:n,Feature:a}=r;if(!this.features[t]&&a&&n(this.props)&&(this.features[t]=new a(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Yo()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<LU.length;n++){const a=LU[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const l="on"+a,h=t[l];h&&(this.propEventSubscriptions[a]=this.on(a,h))}this.prevMotionValues=h1e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=G1(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){var n;let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(QY(a)||$Y(a))?a=parseFloat(a):!u1e(a)&&Vg.test(r)&&(a=YY(t,r)),this.setBaseTarget(t,Fl(a)?a.get():a)),Fl(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const h=$3(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);h&&(a=h[t])}if(n&&a!==void 0)return a;const l=this.getBaseTargetFromProps(this.props,t);return l!==void 0&&!Fl(l)?l:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new P3),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class jX extends f1e{constructor(){super(...arguments),this.KeyframeResolver=nX}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Fl(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function p1e(e){return window.getComputedStyle(e)}class m1e extends jX{constructor(){super(...arguments),this.type="html",this.renderInstance=MY}readValueFromInstance(t,r){if(Wv.has(r))return Pxe(t,r);{const n=p1e(t),a=(I3(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return _X(t,r)}build(t,r,n){z3(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return q3(t,r,n)}}class g1e extends jX{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Yo,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&CY(this.current,this.renderState)}}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Wv.has(r)){const n=ZY(r);return n&&n.default||0}return r=OY.has(r)?r:N3(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return kY(t,r,n)}onBindTransform(){this.current&&!this.renderState.dimensions&&Xa.postRender(this.updateDimensions)}build(t,r,n){V3(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,a){RY(t,r,n,a)}mount(t){this.isSVGTag=U3(t.tagName),super.mount(t)}}const y1e=(e,t)=>B3(e)?new g1e(t):new m1e(t,{allowProjection:e!==K.Fragment}),v1e=Q_e({...B0e,...o1e,...Zbe,...s1e},y1e),_1e=m_e(v1e);function XA({className:e,...t}){return f.jsx("div",{className:Gt("animate-pulse rounded-md bg-primary/10",e),...t})}const L2=({name:e,icon:t,value:r,color:n,loading:a,statuses:l=[]})=>f.jsx(_1e.div,{className:" shadow-none border overflow-hidden rounded-xl",children:a?f.jsx(XA,{className:"h-[100px]"}):f.jsxs("div",{className:"md:px-4 md:py-5 p-6",children:[f.jsxs("span",{className:"flex items-center justify-between text-xs text-muted-foreground ",children:[e,f.jsx(t,{size:20,className:"mr-3 text-accent-foreground"})]}),f.jsx("p",{className:"mt-1 text-3xl md:text-4xl tracking-tight font-bold ",children:r}),l.length>0&&f.jsx("div",{className:"space-x-2 mt-2",children:l.map((h,i)=>f.jsx("span",{className:" text-xs py-1 px-2 rounded-md",style:{color:h.color,backgroundColor:h.bgColor},children:h.label},i))})]})});var _M,zU;function Uc(){if(zU)return _M;zU=1;var e=Array.isArray;return _M=e,_M}var xM,FU;function NX(){if(FU)return xM;FU=1;var e=typeof S2=="object"&&S2&&S2.Object===Object&&S2;return xM=e,xM}var bM,BU;function ep(){if(BU)return bM;BU=1;var e=NX(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return bM=r,bM}var wM,VU;function sS(){if(VU)return wM;VU=1;var e=ep(),t=e.Symbol;return wM=t,wM}var SM,UU;function x1e(){if(UU)return SM;UU=1;var e=sS(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function l(h){var i=r.call(h,a),_=h[a];try{h[a]=void 0;var w=!0}catch{}var A=n.call(h);return w&&(i?h[a]=_:delete h[a]),A}return SM=l,SM}var AM,$U;function b1e(){if($U)return AM;$U=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return AM=r,AM}var TM,qU;function ym(){if(qU)return TM;qU=1;var e=sS(),t=x1e(),r=b1e(),n="[object Null]",a="[object Undefined]",l=e?e.toStringTag:void 0;function h(i){return i==null?i===void 0?a:n:l&&l in Object(i)?t(i):r(i)}return TM=h,TM}var PM,GU;function vm(){if(GU)return PM;GU=1;function e(t){return t!=null&&typeof t=="object"}return PM=e,PM}var EM,KU;function A0(){if(KU)return EM;KU=1;var e=ym(),t=vm(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return EM=n,EM}var CM,WU;function Q3(){if(WU)return CM;WU=1;var e=Uc(),t=A0(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(l,h){if(e(l))return!1;var i=typeof l;return i=="number"||i=="symbol"||i=="boolean"||l==null||t(l)?!0:n.test(l)||!r.test(l)||h!=null&&l in Object(h)}return CM=a,CM}var MM,HU;function Wg(){if(HU)return MM;HU=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return MM=e,MM}var OM,ZU;function eL(){if(ZU)return OM;ZU=1;var e=ym(),t=Wg(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",l="[object Proxy]";function h(i){if(!t(i))return!1;var _=e(i);return _==n||_==a||_==r||_==l}return OM=h,OM}var RM,YU;function w1e(){if(YU)return RM;YU=1;var e=ep(),t=e["__core-js_shared__"];return RM=t,RM}var kM,XU;function S1e(){if(XU)return kM;XU=1;var e=w1e(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return kM=r,kM}var jM,JU;function IX(){if(JU)return jM;JU=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return jM=r,jM}var NM,QU;function A1e(){if(QU)return NM;QU=1;var e=eL(),t=S1e(),r=Wg(),n=IX(),a=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,h=Function.prototype,i=Object.prototype,_=h.toString,w=i.hasOwnProperty,A=RegExp("^"+_.call(w).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function C(R){if(!r(R)||t(R))return!1;var z=e(R)?A:l;return z.test(n(R))}return NM=C,NM}var IM,e6;function T1e(){if(e6)return IM;e6=1;function e(t,r){return t==null?void 0:t[r]}return IM=e,IM}var DM,t6;function Hv(){if(t6)return DM;t6=1;var e=A1e(),t=T1e();function r(n,a){var l=t(n,a);return e(l)?l:void 0}return DM=r,DM}var LM,r6;function DP(){if(r6)return LM;r6=1;var e=Hv(),t=e(Object,"create");return LM=t,LM}var zM,n6;function P1e(){if(n6)return zM;n6=1;var e=DP();function t(){this.__data__=e?e(null):{},this.size=0}return zM=t,zM}var FM,i6;function E1e(){if(i6)return FM;i6=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return FM=e,FM}var BM,a6;function C1e(){if(a6)return BM;a6=1;var e=DP(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(l){var h=this.__data__;if(e){var i=h[l];return i===t?void 0:i}return n.call(h,l)?h[l]:void 0}return BM=a,BM}var VM,o6;function M1e(){if(o6)return VM;o6=1;var e=DP(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var l=this.__data__;return e?l[a]!==void 0:r.call(l,a)}return VM=n,VM}var UM,s6;function O1e(){if(s6)return UM;s6=1;var e=DP(),t="__lodash_hash_undefined__";function r(n,a){var l=this.__data__;return this.size+=this.has(n)?0:1,l[n]=e&&a===void 0?t:a,this}return UM=r,UM}var $M,l6;function R1e(){if(l6)return $M;l6=1;var e=P1e(),t=E1e(),r=C1e(),n=M1e(),a=O1e();function l(h){var i=-1,_=h==null?0:h.length;for(this.clear();++i<_;){var w=h[i];this.set(w[0],w[1])}}return l.prototype.clear=e,l.prototype.delete=t,l.prototype.get=r,l.prototype.has=n,l.prototype.set=a,$M=l,$M}var qM,c6;function k1e(){if(c6)return qM;c6=1;function e(){this.__data__=[],this.size=0}return qM=e,qM}var GM,u6;function tL(){if(u6)return GM;u6=1;function e(t,r){return t===r||t!==t&&r!==r}return GM=e,GM}var KM,d6;function LP(){if(d6)return KM;d6=1;var e=tL();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return KM=t,KM}var WM,h6;function j1e(){if(h6)return WM;h6=1;var e=LP(),t=Array.prototype,r=t.splice;function n(a){var l=this.__data__,h=e(l,a);if(h<0)return!1;var i=l.length-1;return h==i?l.pop():r.call(l,h,1),--this.size,!0}return WM=n,WM}var HM,f6;function N1e(){if(f6)return HM;f6=1;var e=LP();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return HM=t,HM}var ZM,p6;function I1e(){if(p6)return ZM;p6=1;var e=LP();function t(r){return e(this.__data__,r)>-1}return ZM=t,ZM}var YM,m6;function D1e(){if(m6)return YM;m6=1;var e=LP();function t(r,n){var a=this.__data__,l=e(a,r);return l<0?(++this.size,a.push([r,n])):a[l][1]=n,this}return YM=t,YM}var XM,g6;function zP(){if(g6)return XM;g6=1;var e=k1e(),t=j1e(),r=N1e(),n=I1e(),a=D1e();function l(h){var i=-1,_=h==null?0:h.length;for(this.clear();++i<_;){var w=h[i];this.set(w[0],w[1])}}return l.prototype.clear=e,l.prototype.delete=t,l.prototype.get=r,l.prototype.has=n,l.prototype.set=a,XM=l,XM}var JM,y6;function rL(){if(y6)return JM;y6=1;var e=Hv(),t=ep(),r=e(t,"Map");return JM=r,JM}var QM,v6;function L1e(){if(v6)return QM;v6=1;var e=R1e(),t=zP(),r=rL();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return QM=n,QM}var eO,_6;function z1e(){if(_6)return eO;_6=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return eO=e,eO}var tO,x6;function FP(){if(x6)return tO;x6=1;var e=z1e();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return tO=t,tO}var rO,b6;function F1e(){if(b6)return rO;b6=1;var e=FP();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return rO=t,rO}var nO,w6;function B1e(){if(w6)return nO;w6=1;var e=FP();function t(r){return e(this,r).get(r)}return nO=t,nO}var iO,S6;function V1e(){if(S6)return iO;S6=1;var e=FP();function t(r){return e(this,r).has(r)}return iO=t,iO}var aO,A6;function U1e(){if(A6)return aO;A6=1;var e=FP();function t(r,n){var a=e(this,r),l=a.size;return a.set(r,n),this.size+=a.size==l?0:1,this}return aO=t,aO}var oO,T6;function nL(){if(T6)return oO;T6=1;var e=L1e(),t=F1e(),r=B1e(),n=V1e(),a=U1e();function l(h){var i=-1,_=h==null?0:h.length;for(this.clear();++i<_;){var w=h[i];this.set(w[0],w[1])}}return l.prototype.clear=e,l.prototype.delete=t,l.prototype.get=r,l.prototype.has=n,l.prototype.set=a,oO=l,oO}var sO,P6;function DX(){if(P6)return sO;P6=1;var e=nL(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var l=function(){var h=arguments,i=a?a.apply(this,h):h[0],_=l.cache;if(_.has(i))return _.get(i);var w=n.apply(this,h);return l.cache=_.set(i,w)||_,w};return l.cache=new(r.Cache||e),l}return r.Cache=e,sO=r,sO}var lO,E6;function $1e(){if(E6)return lO;E6=1;var e=DX(),t=500;function r(n){var a=e(n,function(h){return l.size===t&&l.clear(),h}),l=a.cache;return a}return lO=r,lO}var cO,C6;function q1e(){if(C6)return cO;C6=1;var e=$1e(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var l=[];return a.charCodeAt(0)===46&&l.push(""),a.replace(t,function(h,i,_,w){l.push(_?w.replace(r,"$1"):i||h)}),l});return cO=n,cO}var uO,M6;function iL(){if(M6)return uO;M6=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,l=Array(a);++n<a;)l[n]=r(t[n],n,t);return l}return uO=e,uO}var dO,O6;function G1e(){if(O6)return dO;O6=1;var e=sS(),t=iL(),r=Uc(),n=A0(),a=e?e.prototype:void 0,l=a?a.toString:void 0;function h(i){if(typeof i=="string")return i;if(r(i))return t(i,h)+"";if(n(i))return l?l.call(i):"";var _=i+"";return _=="0"&&1/i==-1/0?"-0":_}return dO=h,dO}var hO,R6;function LX(){if(R6)return hO;R6=1;var e=G1e();function t(r){return r==null?"":e(r)}return hO=t,hO}var fO,k6;function zX(){if(k6)return fO;k6=1;var e=Uc(),t=Q3(),r=q1e(),n=LX();function a(l,h){return e(l)?l:t(l,h)?[l]:r(n(l))}return fO=a,fO}var pO,j6;function BP(){if(j6)return pO;j6=1;var e=A0();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return pO=t,pO}var mO,N6;function aL(){if(N6)return mO;N6=1;var e=zX(),t=BP();function r(n,a){a=e(a,n);for(var l=0,h=a.length;n!=null&&l<h;)n=n[t(a[l++])];return l&&l==h?n:void 0}return mO=r,mO}var gO,I6;function FX(){if(I6)return gO;I6=1;var e=aL();function t(r,n,a){var l=r==null?void 0:e(r,n);return l===void 0?a:l}return gO=t,gO}var K1e=FX();const Au=ta(K1e);var yO,D6;function W1e(){if(D6)return yO;D6=1;function e(t){return t==null}return yO=e,yO}var H1e=W1e();const Gn=ta(H1e);var vO,L6;function Z1e(){if(L6)return vO;L6=1;var e=ym(),t=Uc(),r=vm(),n="[object String]";function a(l){return typeof l=="string"||!t(l)&&r(l)&&e(l)==n}return vO=a,vO}var Y1e=Z1e();const lS=ta(Y1e);var X1e=eL();const Cn=ta(X1e);var J1e=Wg();const T0=ta(J1e);var _O={exports:{}},_a={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z6;function Q1e(){if(z6)return _a;z6=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),h=Symbol.for("react.context"),i=Symbol.for("react.server_context"),_=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),z=Symbol.for("react.offscreen"),V;V=Symbol.for("react.module.reference");function U(G){if(typeof G=="object"&&G!==null){var H=G.$$typeof;switch(H){case e:switch(G=G.type,G){case r:case a:case n:case w:case A:return G;default:switch(G=G&&G.$$typeof,G){case i:case h:case _:case R:case C:case l:return G;default:return H}}case t:return H}}}return _a.ContextConsumer=h,_a.ContextProvider=l,_a.Element=e,_a.ForwardRef=_,_a.Fragment=r,_a.Lazy=R,_a.Memo=C,_a.Portal=t,_a.Profiler=a,_a.StrictMode=n,_a.Suspense=w,_a.SuspenseList=A,_a.isAsyncMode=function(){return!1},_a.isConcurrentMode=function(){return!1},_a.isContextConsumer=function(G){return U(G)===h},_a.isContextProvider=function(G){return U(G)===l},_a.isElement=function(G){return typeof G=="object"&&G!==null&&G.$$typeof===e},_a.isForwardRef=function(G){return U(G)===_},_a.isFragment=function(G){return U(G)===r},_a.isLazy=function(G){return U(G)===R},_a.isMemo=function(G){return U(G)===C},_a.isPortal=function(G){return U(G)===t},_a.isProfiler=function(G){return U(G)===a},_a.isStrictMode=function(G){return U(G)===n},_a.isSuspense=function(G){return U(G)===w},_a.isSuspenseList=function(G){return U(G)===A},_a.isValidElementType=function(G){return typeof G=="string"||typeof G=="function"||G===r||G===a||G===n||G===w||G===A||G===z||typeof G=="object"&&G!==null&&(G.$$typeof===R||G.$$typeof===C||G.$$typeof===l||G.$$typeof===h||G.$$typeof===_||G.$$typeof===V||G.getModuleId!==void 0)},_a.typeOf=U,_a}var F6;function ewe(){return F6||(F6=1,_O.exports=Q1e()),_O.exports}var twe=ewe(),xO,B6;function BX(){if(B6)return xO;B6=1;var e=ym(),t=vm(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return xO=n,xO}var bO,V6;function rwe(){if(V6)return bO;V6=1;var e=BX();function t(r){return e(r)&&r!=+r}return bO=t,bO}var nwe=rwe();const P0=ta(nwe);var iwe=BX();const awe=ta(iwe);var tl=function(t){return t===0?0:t>0?1:-1},fv=function(t){return lS(t)&&t.indexOf("%")===t.length-1},Ir=function(t){return awe(t)&&!P0(t)},Ns=function(t){return Ir(t)||lS(t)},owe=0,Hg=function(t){var r=++owe;return"".concat(t||"").concat(r)},sc=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ir(t)&&!lS(t))return n;var l;if(fv(t)){var h=t.indexOf("%");l=r*parseFloat(t.slice(0,h))/100}else l=+t;return P0(l)&&(l=n),a&&l>r&&(l=r),l},Tg=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},swe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Sa=function(t,r){return Ir(t)&&Ir(r)?function(n){return t+n*(r-t)}:function(){return r}};function JA(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Au(n,t))===r})}var lwe=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,l=0,h=0,i=1/0,_=-1/0,w=0,A=0,C=0;C<r;C++)w=t[C].cx||0,A=t[C].cy||0,n+=w,a+=A,l+=w*A,h+=w*w,i=Math.min(i,w),_=Math.max(_,w);var R=r*h!==n*n?(r*l-n*a)/(r*h-n*n):0;return{xmin:i,xmax:_,a:R,b:(a-R*n)/r}};function px(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function RN(e){"@babel/helpers - typeof";return RN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RN(e)}var cwe=["viewBox","children"],uwe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],U6=["points","pathLength"],wO={svg:cwe,polygon:U6,polyline:U6},oL=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],QA=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(K.isValidElement(t)&&(n=t.props),!T0(n))return null;var a={};return Object.keys(n).forEach(function(l){oL.includes(l)&&(a[l]=r||function(h){return n[l](n,h)})}),a},dwe=function(t,r,n){return function(a){return t(r,n,a),null}},Wf=function(t,r,n){if(!T0(t)||RN(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(l){var h=t[l];oL.includes(l)&&typeof h=="function"&&(a||(a={}),a[l]=dwe(h,r,n))}),a},hwe=["children"],fwe=["children"];function $6(e,t){if(e==null)return{};var r=pwe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function pwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kN(e){"@babel/helpers - typeof";return kN=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kN(e)}var q6={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},am=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},G6=null,SO=null,sL=function e(t){if(t===G6&&Array.isArray(SO))return SO;var r=[];return K.Children.forEach(t,function(n){Gn(n)||(twe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),SO=r,G6=t,r};function Bl(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return am(a)}):n=[am(t)],sL(e).forEach(function(a){var l=Au(a,"type.displayName")||Au(a,"type.name");n.indexOf(l)!==-1&&r.push(a)}),r}function gu(e,t){var r=Bl(e,t);return r&&r[0]}var K6=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Ir(n)||n<=0||!Ir(a)||a<=0)},mwe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],gwe=function(t){return t&&t.type&&lS(t.type)&&mwe.indexOf(t.type)>=0},VX=function(t){return t&&kN(t)==="object"&&"clipDot"in t},ywe=function(t,r,n,a){var l,h=(l=wO==null?void 0:wO[a])!==null&&l!==void 0?l:[];return!Cn(t)&&(a&&h.includes(r)||uwe.includes(r))||n&&oL.includes(r)},on=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(K.isValidElement(t)&&(a=t.props),!T0(a))return null;var l={};return Object.keys(a).forEach(function(h){var i;ywe((i=a)===null||i===void 0?void 0:i[h],h,r,n)&&(l[h]=a[h])}),l},jN=function e(t,r){if(t===r)return!0;var n=K.Children.count(t);if(n!==K.Children.count(r))return!1;if(n===0)return!0;if(n===1)return W6(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var l=t[a],h=r[a];if(Array.isArray(l)||Array.isArray(h)){if(!e(l,h))return!1}else if(!W6(l,h))return!1}return!0},W6=function(t,r){if(Gn(t)&&Gn(r))return!0;if(!Gn(t)&&!Gn(r)){var n=t.props||{},a=n.children,l=$6(n,hwe),h=r.props||{},i=h.children,_=$6(h,fwe);return a&&i?px(l,_)&&jN(a,i):!a&&!i?px(l,_):!1}return!1},H6=function(t,r){var n=[],a={};return sL(t).forEach(function(l,h){if(gwe(l))n.push(l);else if(l){var i=am(l.type),_=r[i]||{},w=_.handler,A=_.once;if(w&&(!A||!a[i])){var C=w(l,i,h);n.push(C),a[i]=!0}}}),n},vwe=function(t){var r=t&&t.type;return r&&q6[r]?q6[r]:null},_we=function(t,r){return sL(r).indexOf(t)},xwe=["children","width","height","viewBox","className","style","title","desc"];function NN(){return NN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NN.apply(this,arguments)}function bwe(e,t){if(e==null)return{};var r=wwe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wwe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function IN(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,l=e.className,h=e.style,i=e.title,_=e.desc,w=bwe(e,xwe),A=a||{width:r,height:n,x:0,y:0},C=Xn("recharts-surface",l);return Pe.createElement("svg",NN({},on(w,!0,"svg"),{className:C,width:r,height:n,style:h,viewBox:"".concat(A.x," ").concat(A.y," ").concat(A.width," ").concat(A.height)}),Pe.createElement("title",null,i),Pe.createElement("desc",null,_),t)}var Swe=["children","className"];function DN(){return DN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DN.apply(this,arguments)}function Awe(e,t){if(e==null)return{};var r=Twe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Twe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var ci=Pe.forwardRef(function(e,t){var r=e.children,n=e.className,a=Awe(e,Swe),l=Xn("recharts-layer",n);return Pe.createElement("g",DN({className:l},on(a,!0),{ref:t}),r)}),Rh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),l=2;l<n;l++)a[l-2]=arguments[l]},AO,Z6;function Pwe(){if(Z6)return AO;Z6=1;function e(t,r,n){var a=-1,l=t.length;r<0&&(r=-r>l?0:l+r),n=n>l?l:n,n<0&&(n+=l),l=r>n?0:n-r>>>0,r>>>=0;for(var h=Array(l);++a<l;)h[a]=t[a+r];return h}return AO=e,AO}var TO,Y6;function Ewe(){if(Y6)return TO;Y6=1;var e=Pwe();function t(r,n,a){var l=r.length;return a=a===void 0?l:a,!n&&a>=l?r:e(r,n,a)}return TO=t,TO}var PO,X6;function UX(){if(X6)return PO;X6=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,l="\\ufe0e\\ufe0f",h="\\u200d",i=RegExp("["+h+e+a+l+"]");function _(w){return i.test(w)}return PO=_,PO}var EO,J6;function Cwe(){if(J6)return EO;J6=1;function e(t){return t.split("")}return EO=e,EO}var CO,Q6;function Mwe(){if(Q6)return CO;Q6=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,l="\\ufe0e\\ufe0f",h="["+e+"]",i="["+a+"]",_="\\ud83c[\\udffb-\\udfff]",w="(?:"+i+"|"+_+")",A="[^"+e+"]",C="(?:\\ud83c[\\udde6-\\uddff]){2}",R="[\\ud800-\\udbff][\\udc00-\\udfff]",z="\\u200d",V=w+"?",U="["+l+"]?",G="(?:"+z+"(?:"+[A,C,R].join("|")+")"+U+V+")*",H=U+V+G,J="(?:"+[A+i+"?",i,C,R,h].join("|")+")",Q=RegExp(_+"(?="+_+")|"+J+H,"g");function le(ne){return ne.match(Q)||[]}return CO=le,CO}var MO,e$;function Owe(){if(e$)return MO;e$=1;var e=Cwe(),t=UX(),r=Mwe();function n(a){return t(a)?r(a):e(a)}return MO=n,MO}var OO,t$;function Rwe(){if(t$)return OO;t$=1;var e=Ewe(),t=UX(),r=Owe(),n=LX();function a(l){return function(h){h=n(h);var i=t(h)?r(h):void 0,_=i?i[0]:h.charAt(0),w=i?e(i,1).join(""):h.slice(1);return _[l]()+w}}return OO=a,OO}var RO,r$;function kwe(){if(r$)return RO;r$=1;var e=Rwe(),t=e("toUpperCase");return RO=t,RO}var jwe=kwe();const VP=ta(jwe);function Za(e){return function(){return e}}const $X=Math.cos,eT=Math.sin,Kh=Math.sqrt,tT=Math.PI,UP=2*tT,LN=Math.PI,zN=2*LN,nv=1e-6,Nwe=zN-nv;function qX(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Iwe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return qX;const r=10**t;return function(n){this._+=n[0];for(let a=1,l=n.length;a<l;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class Dwe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?qX:Iwe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,l,h){this._append`C${+t},${+r},${+n},${+a},${this._x1=+l},${this._y1=+h}`}arcTo(t,r,n,a,l){if(t=+t,r=+r,n=+n,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let h=this._x1,i=this._y1,_=n-t,w=a-r,A=h-t,C=i-r,R=A*A+C*C;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(R>nv)if(!(Math.abs(C*_-w*A)>nv)||!l)this._append`L${this._x1=t},${this._y1=r}`;else{let z=n-h,V=a-i,U=_*_+w*w,G=z*z+V*V,H=Math.sqrt(U),J=Math.sqrt(R),Q=l*Math.tan((LN-Math.acos((U+R-G)/(2*H*J)))/2),le=Q/J,ne=Q/H;Math.abs(le-1)>nv&&this._append`L${t+le*A},${r+le*C}`,this._append`A${l},${l},0,0,${+(C*z>A*V)},${this._x1=t+ne*_},${this._y1=r+ne*w}`}}arc(t,r,n,a,l,h){if(t=+t,r=+r,n=+n,h=!!h,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),_=n*Math.sin(a),w=t+i,A=r+_,C=1^h,R=h?a-l:l-a;this._x1===null?this._append`M${w},${A}`:(Math.abs(this._x1-w)>nv||Math.abs(this._y1-A)>nv)&&this._append`L${w},${A}`,n&&(R<0&&(R=R%zN+zN),R>Nwe?this._append`A${n},${n},0,1,${C},${t-i},${r-_}A${n},${n},0,1,${C},${this._x1=w},${this._y1=A}`:R>nv&&this._append`A${n},${n},0,${+(R>=LN)},${C},${this._x1=t+n*Math.cos(l)},${this._y1=r+n*Math.sin(l)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function lL(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Dwe(t)}function cL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function GX(e){this._context=e}GX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $P(e){return new GX(e)}function KX(e){return e[0]}function WX(e){return e[1]}function HX(e,t){var r=Za(!0),n=null,a=$P,l=null,h=lL(i);e=typeof e=="function"?e:e===void 0?KX:Za(e),t=typeof t=="function"?t:t===void 0?WX:Za(t);function i(_){var w,A=(_=cL(_)).length,C,R=!1,z;for(n==null&&(l=a(z=h())),w=0;w<=A;++w)!(w<A&&r(C=_[w],w,_))===R&&((R=!R)?l.lineStart():l.lineEnd()),R&&l.point(+e(C,w,_),+t(C,w,_));if(z)return l=null,z+""||null}return i.x=function(_){return arguments.length?(e=typeof _=="function"?_:Za(+_),i):e},i.y=function(_){return arguments.length?(t=typeof _=="function"?_:Za(+_),i):t},i.defined=function(_){return arguments.length?(r=typeof _=="function"?_:Za(!!_),i):r},i.curve=function(_){return arguments.length?(a=_,n!=null&&(l=a(n)),i):a},i.context=function(_){return arguments.length?(_==null?n=l=null:l=a(n=_),i):n},i}function z2(e,t,r){var n=null,a=Za(!0),l=null,h=$P,i=null,_=lL(w);e=typeof e=="function"?e:e===void 0?KX:Za(+e),t=typeof t=="function"?t:Za(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?WX:Za(+r);function w(C){var R,z,V,U=(C=cL(C)).length,G,H=!1,J,Q=new Array(U),le=new Array(U);for(l==null&&(i=h(J=_())),R=0;R<=U;++R){if(!(R<U&&a(G=C[R],R,C))===H)if(H=!H)z=R,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),V=R-1;V>=z;--V)i.point(Q[V],le[V]);i.lineEnd(),i.areaEnd()}H&&(Q[R]=+e(G,R,C),le[R]=+t(G,R,C),i.point(n?+n(G,R,C):Q[R],r?+r(G,R,C):le[R]))}if(J)return i=null,J+""||null}function A(){return HX().defined(a).curve(h).context(l)}return w.x=function(C){return arguments.length?(e=typeof C=="function"?C:Za(+C),n=null,w):e},w.x0=function(C){return arguments.length?(e=typeof C=="function"?C:Za(+C),w):e},w.x1=function(C){return arguments.length?(n=C==null?null:typeof C=="function"?C:Za(+C),w):n},w.y=function(C){return arguments.length?(t=typeof C=="function"?C:Za(+C),r=null,w):t},w.y0=function(C){return arguments.length?(t=typeof C=="function"?C:Za(+C),w):t},w.y1=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:Za(+C),w):r},w.lineX0=w.lineY0=function(){return A().x(e).y(t)},w.lineY1=function(){return A().x(e).y(r)},w.lineX1=function(){return A().x(n).y(t)},w.defined=function(C){return arguments.length?(a=typeof C=="function"?C:Za(!!C),w):a},w.curve=function(C){return arguments.length?(h=C,l!=null&&(i=h(l)),w):h},w.context=function(C){return arguments.length?(C==null?l=i=null:i=h(l=C),w):l},w}class ZX{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Lwe(e){return new ZX(e,!0)}function zwe(e){return new ZX(e,!1)}const uL={draw(e,t){const r=Kh(t/tT);e.moveTo(r,0),e.arc(0,0,r,0,UP)}},Fwe={draw(e,t){const r=Kh(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},YX=Kh(1/3),Bwe=YX*2,Vwe={draw(e,t){const r=Kh(t/Bwe),n=r*YX;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Uwe={draw(e,t){const r=Kh(t),n=-r/2;e.rect(n,n,r,r)}},$we=.8908130915292852,XX=eT(tT/10)/eT(7*tT/10),qwe=eT(UP/10)*XX,Gwe=-$X(UP/10)*XX,Kwe={draw(e,t){const r=Kh(t*$we),n=qwe*r,a=Gwe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let l=1;l<5;++l){const h=UP*l/5,i=$X(h),_=eT(h);e.lineTo(_*r,-i*r),e.lineTo(i*n-_*a,_*n+i*a)}e.closePath()}},kO=Kh(3),Wwe={draw(e,t){const r=-Kh(t/(kO*3));e.moveTo(0,r*2),e.lineTo(-kO*r,-r),e.lineTo(kO*r,-r),e.closePath()}},pd=-.5,md=Kh(3)/2,FN=1/Kh(12),Hwe=(FN/2+1)*3,Zwe={draw(e,t){const r=Kh(t/Hwe),n=r/2,a=r*FN,l=n,h=r*FN+r,i=-l,_=h;e.moveTo(n,a),e.lineTo(l,h),e.lineTo(i,_),e.lineTo(pd*n-md*a,md*n+pd*a),e.lineTo(pd*l-md*h,md*l+pd*h),e.lineTo(pd*i-md*_,md*i+pd*_),e.lineTo(pd*n+md*a,pd*a-md*n),e.lineTo(pd*l+md*h,pd*h-md*l),e.lineTo(pd*i+md*_,pd*_-md*i),e.closePath()}};function Ywe(e,t){let r=null,n=lL(a);e=typeof e=="function"?e:Za(e||uL),t=typeof t=="function"?t:Za(t===void 0?64:+t);function a(){let l;if(r||(r=l=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),l)return r=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:Za(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:Za(+l),a):t},a.context=function(l){return arguments.length?(r=l??null,a):r},a}function rT(){}function nT(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function JX(e){this._context=e}JX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:nT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:nT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Xwe(e){return new JX(e)}function QX(e){this._context=e}QX.prototype={areaStart:rT,areaEnd:rT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:nT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Jwe(e){return new QX(e)}function eJ(e){this._context=e}eJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:nT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Qwe(e){return new eJ(e)}function tJ(e){this._context=e}tJ.prototype={areaStart:rT,areaEnd:rT,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function eSe(e){return new tJ(e)}function n$(e){return e<0?-1:1}function i$(e,t,r){var n=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(n||a<0&&-0),h=(r-e._y1)/(a||n<0&&-0),i=(l*a+h*n)/(n+a);return(n$(l)+n$(h))*Math.min(Math.abs(l),Math.abs(h),.5*Math.abs(i))||0}function a$(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function jO(e,t,r){var n=e._x0,a=e._y0,l=e._x1,h=e._y1,i=(l-n)/3;e._context.bezierCurveTo(n+i,a+i*t,l-i,h-i*r,l,h)}function iT(e){this._context=e}iT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jO(this,this._t0,a$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,jO(this,a$(this,r=i$(this,e,t)),r);break;default:jO(this,this._t0,r=i$(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function rJ(e){this._context=new nJ(e)}(rJ.prototype=Object.create(iT.prototype)).point=function(e,t){iT.prototype.point.call(this,t,e)};function nJ(e){this._context=e}nJ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,l){this._context.bezierCurveTo(t,e,n,r,l,a)}};function tSe(e){return new iT(e)}function rSe(e){return new rJ(e)}function iJ(e){this._context=e}iJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=o$(e),a=o$(t),l=0,h=1;h<r;++l,++h)this._context.bezierCurveTo(n[0][l],a[0][l],n[1][l],a[1][l],e[h],t[h]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function o$(e){var t,r=e.length-1,n,a=new Array(r),l=new Array(r),h=new Array(r);for(a[0]=0,l[0]=2,h[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,l[t]=4,h[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,l[r-1]=7,h[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/l[t-1],l[t]-=n,h[t]-=n*h[t-1];for(a[r-1]=h[r-1]/l[r-1],t=r-2;t>=0;--t)a[t]=(h[t]-a[t+1])/l[t];for(l[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function nSe(e){return new iJ(e)}function qP(e,t){this._context=e,this._t=t}qP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function iSe(e){return new qP(e,.5)}function aSe(e){return new qP(e,0)}function oSe(e){return new qP(e,1)}function Px(e,t){if((h=e.length)>1)for(var r=1,n,a,l=e[t[0]],h,i=l.length;r<h;++r)for(a=l,l=e[t[r]],n=0;n<i;++n)l[n][1]+=l[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function BN(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function sSe(e,t){return e[t]}function lSe(e){const t=[];return t.key=e,t}function cSe(){var e=Za([]),t=BN,r=Px,n=sSe;function a(l){var h=Array.from(e.apply(this,arguments),lSe),i,_=h.length,w=-1,A;for(const C of l)for(i=0,++w;i<_;++i)(h[i][w]=[0,+n(C,h[i].key,w,l)]).data=C;for(i=0,A=cL(t(h));i<_;++i)h[A[i]].index=i;return r(h,A),h}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:Za(Array.from(l)),a):e},a.value=function(l){return arguments.length?(n=typeof l=="function"?l:Za(+l),a):n},a.order=function(l){return arguments.length?(t=l==null?BN:typeof l=="function"?l:Za(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(r=l??Px,a):r},a}function uSe(e,t){if((n=e.length)>0){for(var r,n,a=0,l=e[0].length,h;a<l;++a){for(h=r=0;r<n;++r)h+=e[r][a][1]||0;if(h)for(r=0;r<n;++r)e[r][a][1]/=h}Px(e,t)}}function dSe(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,l=n.length;r<l;++r){for(var h=0,i=0;h<a;++h)i+=e[h][r][1]||0;n[r][1]+=n[r][0]=-i/2}Px(e,t)}}function hSe(e,t){if(!(!((h=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,l,h;n<l;++n){for(var i=0,_=0,w=0;i<h;++i){for(var A=e[t[i]],C=A[n][1]||0,R=A[n-1][1]||0,z=(C-R)/2,V=0;V<i;++V){var U=e[t[V]],G=U[n][1]||0,H=U[n-1][1]||0;z+=G-H}_+=C,w+=z*C}a[n-1][1]+=a[n-1][0]=r,_&&(r-=w/_)}a[n-1][1]+=a[n-1][0]=r,Px(e,t)}}function J1(e){"@babel/helpers - typeof";return J1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J1(e)}var fSe=["type","size","sizeType"];function VN(){return VN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VN.apply(this,arguments)}function s$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function l$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s$(Object(r),!0).forEach(function(n){pSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pSe(e,t,r){return t=mSe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mSe(e){var t=gSe(e,"string");return J1(t)=="symbol"?t:t+""}function gSe(e,t){if(J1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(J1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ySe(e,t){if(e==null)return{};var r=vSe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var aJ={symbolCircle:uL,symbolCross:Fwe,symbolDiamond:Vwe,symbolSquare:Uwe,symbolStar:Kwe,symbolTriangle:Wwe,symbolWye:Zwe},_Se=Math.PI/180,xSe=function(t){var r="symbol".concat(VP(t));return aJ[r]||uL},bSe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*_Se;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},wSe=function(t,r){aJ["symbol".concat(VP(t))]=r},GP=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,l=a===void 0?64:a,h=t.sizeType,i=h===void 0?"area":h,_=ySe(t,fSe),w=l$(l$({},_),{},{type:n,size:l,sizeType:i}),A=function(){var G=xSe(n),H=Ywe().type(G).size(bSe(l,i,n));return H()},C=w.className,R=w.cx,z=w.cy,V=on(w,!0);return R===+R&&z===+z&&l===+l?Pe.createElement("path",VN({},V,{className:Xn("recharts-symbols",C),transform:"translate(".concat(R,", ").concat(z,")"),d:A()})):null};GP.registerSymbol=wSe;function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function UN(){return UN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UN.apply(this,arguments)}function c$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function SSe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c$(Object(r),!0).forEach(function(n){Q1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ASe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TSe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,sJ(n.key),n)}}function PSe(e,t,r){return t&&TSe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ESe(e,t,r){return t=aT(t),CSe(e,oJ()?Reflect.construct(t,r||[],aT(e).constructor):t.apply(e,r))}function CSe(e,t){if(t&&(Ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return MSe(e)}function MSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oJ=function(){return!!e})()}function aT(e){return aT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aT(e)}function OSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$N(e,t)}function $N(e,t){return $N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$N(e,t)}function Q1(e,t,r){return t=sJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sJ(e){var t=RSe(e,"string");return Ex(t)=="symbol"?t:t+""}function RSe(e,t){if(Ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _h=32,dL=function(e){function t(){return ASe(this,t),ESe(this,t,arguments)}return OSe(t,e),PSe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,l=_h/2,h=_h/6,i=_h/3,_=n.inactive?a:n.color;if(n.type==="plainline")return Pe.createElement("line",{strokeWidth:4,fill:"none",stroke:_,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:l,x2:_h,y2:l,className:"recharts-legend-icon"});if(n.type==="line")return Pe.createElement("path",{strokeWidth:4,fill:"none",stroke:_,d:"M0,".concat(l,"h").concat(i,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(2*i,",").concat(l,`
            H`).concat(_h,"M").concat(2*i,",").concat(l,`
            A`).concat(h,",").concat(h,",0,1,1,").concat(i,",").concat(l),className:"recharts-legend-icon"});if(n.type==="rect")return Pe.createElement("path",{stroke:"none",fill:_,d:"M0,".concat(_h/8,"h").concat(_h,"v").concat(_h*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(Pe.isValidElement(n.legendIcon)){var w=SSe({},n);return delete w.legendIcon,Pe.cloneElement(n.legendIcon,w)}return Pe.createElement(GP,{fill:_,cx:l,cy:l,size:_h,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,l=a.payload,h=a.iconSize,i=a.layout,_=a.formatter,w=a.inactiveColor,A={x:0,y:0,width:_h,height:_h},C={display:i==="horizontal"?"inline-block":"block",marginRight:10},R={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(z,V){var U=z.formatter||_,G=Xn(Q1(Q1({"recharts-legend-item":!0},"legend-item-".concat(V),!0),"inactive",z.inactive));if(z.type==="none")return null;var H=Cn(z.value)?null:z.value;Rh(!Cn(z.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var J=z.inactive?w:z.color;return Pe.createElement("li",UN({className:G,style:C,key:"legend-item-".concat(V)},Wf(n.props,z,V)),Pe.createElement(IN,{width:h,height:h,viewBox:A,style:R},n.renderIcon(z)),Pe.createElement("span",{className:"recharts-legend-item-text",style:{color:J}},U?U(H,z,V):H))})}},{key:"render",value:function(){var n=this.props,a=n.payload,l=n.layout,h=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:l==="horizontal"?h:"left"};return Pe.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(K.PureComponent);Q1(dL,"displayName","Legend");Q1(dL,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var NO,u$;function kSe(){if(u$)return NO;u$=1;var e=zP();function t(){this.__data__=new e,this.size=0}return NO=t,NO}var IO,d$;function jSe(){if(d$)return IO;d$=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return IO=e,IO}var DO,h$;function NSe(){if(h$)return DO;h$=1;function e(t){return this.__data__.get(t)}return DO=e,DO}var LO,f$;function ISe(){if(f$)return LO;f$=1;function e(t){return this.__data__.has(t)}return LO=e,LO}var zO,p$;function DSe(){if(p$)return zO;p$=1;var e=zP(),t=rL(),r=nL(),n=200;function a(l,h){var i=this.__data__;if(i instanceof e){var _=i.__data__;if(!t||_.length<n-1)return _.push([l,h]),this.size=++i.size,this;i=this.__data__=new r(_)}return i.set(l,h),this.size=i.size,this}return zO=a,zO}var FO,m$;function lJ(){if(m$)return FO;m$=1;var e=zP(),t=kSe(),r=jSe(),n=NSe(),a=ISe(),l=DSe();function h(i){var _=this.__data__=new e(i);this.size=_.size}return h.prototype.clear=t,h.prototype.delete=r,h.prototype.get=n,h.prototype.has=a,h.prototype.set=l,FO=h,FO}var BO,g$;function LSe(){if(g$)return BO;g$=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return BO=t,BO}var VO,y$;function zSe(){if(y$)return VO;y$=1;function e(t){return this.__data__.has(t)}return VO=e,VO}var UO,v$;function cJ(){if(v$)return UO;v$=1;var e=nL(),t=LSe(),r=zSe();function n(a){var l=-1,h=a==null?0:a.length;for(this.__data__=new e;++l<h;)this.add(a[l])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,UO=n,UO}var $O,_$;function uJ(){if(_$)return $O;_$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return $O=e,$O}var qO,x$;function dJ(){if(x$)return qO;x$=1;function e(t,r){return t.has(r)}return qO=e,qO}var GO,b$;function hJ(){if(b$)return GO;b$=1;var e=cJ(),t=uJ(),r=dJ(),n=1,a=2;function l(h,i,_,w,A,C){var R=_&n,z=h.length,V=i.length;if(z!=V&&!(R&&V>z))return!1;var U=C.get(h),G=C.get(i);if(U&&G)return U==i&&G==h;var H=-1,J=!0,Q=_&a?new e:void 0;for(C.set(h,i),C.set(i,h);++H<z;){var le=h[H],ne=i[H];if(w)var de=R?w(ne,le,H,i,h,C):w(le,ne,H,h,i,C);if(de!==void 0){if(de)continue;J=!1;break}if(Q){if(!t(i,function(ue,ve){if(!r(Q,ve)&&(le===ue||A(le,ue,_,w,C)))return Q.push(ve)})){J=!1;break}}else if(!(le===ne||A(le,ne,_,w,C))){J=!1;break}}return C.delete(h),C.delete(i),J}return GO=l,GO}var KO,w$;function FSe(){if(w$)return KO;w$=1;var e=ep(),t=e.Uint8Array;return KO=t,KO}var WO,S$;function BSe(){if(S$)return WO;S$=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,l){n[++r]=[l,a]}),n}return WO=e,WO}var HO,A$;function hL(){if(A$)return HO;A$=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return HO=e,HO}var ZO,T$;function VSe(){if(T$)return ZO;T$=1;var e=sS(),t=FSe(),r=tL(),n=hJ(),a=BSe(),l=hL(),h=1,i=2,_="[object Boolean]",w="[object Date]",A="[object Error]",C="[object Map]",R="[object Number]",z="[object RegExp]",V="[object Set]",U="[object String]",G="[object Symbol]",H="[object ArrayBuffer]",J="[object DataView]",Q=e?e.prototype:void 0,le=Q?Q.valueOf:void 0;function ne(de,ue,ve,Ae,Oe,Se,ke){switch(ve){case J:if(de.byteLength!=ue.byteLength||de.byteOffset!=ue.byteOffset)return!1;de=de.buffer,ue=ue.buffer;case H:return!(de.byteLength!=ue.byteLength||!Se(new t(de),new t(ue)));case _:case w:case R:return r(+de,+ue);case A:return de.name==ue.name&&de.message==ue.message;case z:case U:return de==ue+"";case C:var ze=a;case V:var et=Ae&h;if(ze||(ze=l),de.size!=ue.size&&!et)return!1;var je=ke.get(de);if(je)return je==ue;Ae|=i,ke.set(de,ue);var Ne=n(ze(de),ze(ue),Ae,Oe,Se,ke);return ke.delete(de),Ne;case G:if(le)return le.call(de)==le.call(ue)}return!1}return ZO=ne,ZO}var YO,P$;function fJ(){if(P$)return YO;P$=1;function e(t,r){for(var n=-1,a=r.length,l=t.length;++n<a;)t[l+n]=r[n];return t}return YO=e,YO}var XO,E$;function USe(){if(E$)return XO;E$=1;var e=fJ(),t=Uc();function r(n,a,l){var h=a(n);return t(n)?h:e(h,l(n))}return XO=r,XO}var JO,C$;function $Se(){if(C$)return JO;C$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,l=0,h=[];++n<a;){var i=t[n];r(i,n,t)&&(h[l++]=i)}return h}return JO=e,JO}var QO,M$;function qSe(){if(M$)return QO;M$=1;function e(){return[]}return QO=e,QO}var eR,O$;function GSe(){if(O$)return eR;O$=1;var e=$Se(),t=qSe(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,l=a?function(h){return h==null?[]:(h=Object(h),e(a(h),function(i){return n.call(h,i)}))}:t;return eR=l,eR}var tR,R$;function KSe(){if(R$)return tR;R$=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return tR=e,tR}var rR,k$;function WSe(){if(k$)return rR;k$=1;var e=ym(),t=vm(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return rR=n,rR}var nR,j$;function fL(){if(j$)return nR;j$=1;var e=WSe(),t=vm(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,l=e(function(){return arguments}())?e:function(h){return t(h)&&n.call(h,"callee")&&!a.call(h,"callee")};return nR=l,nR}var t1={exports:{}},iR,N$;function HSe(){if(N$)return iR;N$=1;function e(){return!1}return iR=e,iR}t1.exports;var I$;function pJ(){return I$||(I$=1,function(e,t){var r=ep(),n=HSe(),a=t&&!t.nodeType&&t,l=a&&!0&&e&&!e.nodeType&&e,h=l&&l.exports===a,i=h?r.Buffer:void 0,_=i?i.isBuffer:void 0,w=_||n;e.exports=w}(t1,t1.exports)),t1.exports}var aR,D$;function pL(){if(D$)return aR;D$=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var l=typeof n;return a=a??e,!!a&&(l=="number"||l!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return aR=r,aR}var oR,L$;function mL(){if(L$)return oR;L$=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return oR=t,oR}var sR,z$;function ZSe(){if(z$)return sR;z$=1;var e=ym(),t=mL(),r=vm(),n="[object Arguments]",a="[object Array]",l="[object Boolean]",h="[object Date]",i="[object Error]",_="[object Function]",w="[object Map]",A="[object Number]",C="[object Object]",R="[object RegExp]",z="[object Set]",V="[object String]",U="[object WeakMap]",G="[object ArrayBuffer]",H="[object DataView]",J="[object Float32Array]",Q="[object Float64Array]",le="[object Int8Array]",ne="[object Int16Array]",de="[object Int32Array]",ue="[object Uint8Array]",ve="[object Uint8ClampedArray]",Ae="[object Uint16Array]",Oe="[object Uint32Array]",Se={};Se[J]=Se[Q]=Se[le]=Se[ne]=Se[de]=Se[ue]=Se[ve]=Se[Ae]=Se[Oe]=!0,Se[n]=Se[a]=Se[G]=Se[l]=Se[H]=Se[h]=Se[i]=Se[_]=Se[w]=Se[A]=Se[C]=Se[R]=Se[z]=Se[V]=Se[U]=!1;function ke(ze){return r(ze)&&t(ze.length)&&!!Se[e(ze)]}return sR=ke,sR}var lR,F$;function mJ(){if(F$)return lR;F$=1;function e(t){return function(r){return t(r)}}return lR=e,lR}var r1={exports:{}};r1.exports;var B$;function YSe(){return B$||(B$=1,function(e,t){var r=NX(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,l=a&&a.exports===n,h=l&&r.process,i=function(){try{var _=a&&a.require&&a.require("util").types;return _||h&&h.binding&&h.binding("util")}catch{}}();e.exports=i}(r1,r1.exports)),r1.exports}var cR,V$;function gJ(){if(V$)return cR;V$=1;var e=ZSe(),t=mJ(),r=YSe(),n=r&&r.isTypedArray,a=n?t(n):e;return cR=a,cR}var uR,U$;function XSe(){if(U$)return uR;U$=1;var e=KSe(),t=fL(),r=Uc(),n=pJ(),a=pL(),l=gJ(),h=Object.prototype,i=h.hasOwnProperty;function _(w,A){var C=r(w),R=!C&&t(w),z=!C&&!R&&n(w),V=!C&&!R&&!z&&l(w),U=C||R||z||V,G=U?e(w.length,String):[],H=G.length;for(var J in w)(A||i.call(w,J))&&!(U&&(J=="length"||z&&(J=="offset"||J=="parent")||V&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||a(J,H)))&&G.push(J);return G}return uR=_,uR}var dR,$$;function JSe(){if($$)return dR;$$=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return dR=t,dR}var hR,q$;function yJ(){if(q$)return hR;q$=1;function e(t,r){return function(n){return t(r(n))}}return hR=e,hR}var fR,G$;function QSe(){if(G$)return fR;G$=1;var e=yJ(),t=e(Object.keys,Object);return fR=t,fR}var pR,K$;function e2e(){if(K$)return pR;K$=1;var e=JSe(),t=QSe(),r=Object.prototype,n=r.hasOwnProperty;function a(l){if(!e(l))return t(l);var h=[];for(var i in Object(l))n.call(l,i)&&i!="constructor"&&h.push(i);return h}return pR=a,pR}var mR,W$;function cS(){if(W$)return mR;W$=1;var e=eL(),t=mL();function r(n){return n!=null&&t(n.length)&&!e(n)}return mR=r,mR}var gR,H$;function KP(){if(H$)return gR;H$=1;var e=XSe(),t=e2e(),r=cS();function n(a){return r(a)?e(a):t(a)}return gR=n,gR}var yR,Z$;function t2e(){if(Z$)return yR;Z$=1;var e=USe(),t=GSe(),r=KP();function n(a){return e(a,r,t)}return yR=n,yR}var vR,Y$;function r2e(){if(Y$)return vR;Y$=1;var e=t2e(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(l,h,i,_,w,A){var C=i&t,R=e(l),z=R.length,V=e(h),U=V.length;if(z!=U&&!C)return!1;for(var G=z;G--;){var H=R[G];if(!(C?H in h:n.call(h,H)))return!1}var J=A.get(l),Q=A.get(h);if(J&&Q)return J==h&&Q==l;var le=!0;A.set(l,h),A.set(h,l);for(var ne=C;++G<z;){H=R[G];var de=l[H],ue=h[H];if(_)var ve=C?_(ue,de,H,h,l,A):_(de,ue,H,l,h,A);if(!(ve===void 0?de===ue||w(de,ue,i,_,A):ve)){le=!1;break}ne||(ne=H=="constructor")}if(le&&!ne){var Ae=l.constructor,Oe=h.constructor;Ae!=Oe&&"constructor"in l&&"constructor"in h&&!(typeof Ae=="function"&&Ae instanceof Ae&&typeof Oe=="function"&&Oe instanceof Oe)&&(le=!1)}return A.delete(l),A.delete(h),le}return vR=a,vR}var _R,X$;function n2e(){if(X$)return _R;X$=1;var e=Hv(),t=ep(),r=e(t,"DataView");return _R=r,_R}var xR,J$;function i2e(){if(J$)return xR;J$=1;var e=Hv(),t=ep(),r=e(t,"Promise");return xR=r,xR}var bR,Q$;function vJ(){if(Q$)return bR;Q$=1;var e=Hv(),t=ep(),r=e(t,"Set");return bR=r,bR}var wR,e8;function a2e(){if(e8)return wR;e8=1;var e=Hv(),t=ep(),r=e(t,"WeakMap");return wR=r,wR}var SR,t8;function o2e(){if(t8)return SR;t8=1;var e=n2e(),t=rL(),r=i2e(),n=vJ(),a=a2e(),l=ym(),h=IX(),i="[object Map]",_="[object Object]",w="[object Promise]",A="[object Set]",C="[object WeakMap]",R="[object DataView]",z=h(e),V=h(t),U=h(r),G=h(n),H=h(a),J=l;return(e&&J(new e(new ArrayBuffer(1)))!=R||t&&J(new t)!=i||r&&J(r.resolve())!=w||n&&J(new n)!=A||a&&J(new a)!=C)&&(J=function(Q){var le=l(Q),ne=le==_?Q.constructor:void 0,de=ne?h(ne):"";if(de)switch(de){case z:return R;case V:return i;case U:return w;case G:return A;case H:return C}return le}),SR=J,SR}var AR,r8;function s2e(){if(r8)return AR;r8=1;var e=lJ(),t=hJ(),r=VSe(),n=r2e(),a=o2e(),l=Uc(),h=pJ(),i=gJ(),_=1,w="[object Arguments]",A="[object Array]",C="[object Object]",R=Object.prototype,z=R.hasOwnProperty;function V(U,G,H,J,Q,le){var ne=l(U),de=l(G),ue=ne?A:a(U),ve=de?A:a(G);ue=ue==w?C:ue,ve=ve==w?C:ve;var Ae=ue==C,Oe=ve==C,Se=ue==ve;if(Se&&h(U)){if(!h(G))return!1;ne=!0,Ae=!1}if(Se&&!Ae)return le||(le=new e),ne||i(U)?t(U,G,H,J,Q,le):r(U,G,ue,H,J,Q,le);if(!(H&_)){var ke=Ae&&z.call(U,"__wrapped__"),ze=Oe&&z.call(G,"__wrapped__");if(ke||ze){var et=ke?U.value():U,je=ze?G.value():G;return le||(le=new e),Q(et,je,H,J,le)}}return Se?(le||(le=new e),n(U,G,H,J,Q,le)):!1}return AR=V,AR}var TR,n8;function gL(){if(n8)return TR;n8=1;var e=s2e(),t=vm();function r(n,a,l,h,i){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,l,h,r,i)}return TR=r,TR}var PR,i8;function l2e(){if(i8)return PR;i8=1;var e=lJ(),t=gL(),r=1,n=2;function a(l,h,i,_){var w=i.length,A=w,C=!_;if(l==null)return!A;for(l=Object(l);w--;){var R=i[w];if(C&&R[2]?R[1]!==l[R[0]]:!(R[0]in l))return!1}for(;++w<A;){R=i[w];var z=R[0],V=l[z],U=R[1];if(C&&R[2]){if(V===void 0&&!(z in l))return!1}else{var G=new e;if(_)var H=_(V,U,z,l,h,G);if(!(H===void 0?t(U,V,r|n,_,G):H))return!1}}return!0}return PR=a,PR}var ER,a8;function _J(){if(a8)return ER;a8=1;var e=Wg();function t(r){return r===r&&!e(r)}return ER=t,ER}var CR,o8;function c2e(){if(o8)return CR;o8=1;var e=_J(),t=KP();function r(n){for(var a=t(n),l=a.length;l--;){var h=a[l],i=n[h];a[l]=[h,i,e(i)]}return a}return CR=r,CR}var MR,s8;function xJ(){if(s8)return MR;s8=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return MR=e,MR}var OR,l8;function u2e(){if(l8)return OR;l8=1;var e=l2e(),t=c2e(),r=xJ();function n(a){var l=t(a);return l.length==1&&l[0][2]?r(l[0][0],l[0][1]):function(h){return h===a||e(h,a,l)}}return OR=n,OR}var RR,c8;function d2e(){if(c8)return RR;c8=1;function e(t,r){return t!=null&&r in Object(t)}return RR=e,RR}var kR,u8;function h2e(){if(u8)return kR;u8=1;var e=zX(),t=fL(),r=Uc(),n=pL(),a=mL(),l=BP();function h(i,_,w){_=e(_,i);for(var A=-1,C=_.length,R=!1;++A<C;){var z=l(_[A]);if(!(R=i!=null&&w(i,z)))break;i=i[z]}return R||++A!=C?R:(C=i==null?0:i.length,!!C&&a(C)&&n(z,C)&&(r(i)||t(i)))}return kR=h,kR}var jR,d8;function f2e(){if(d8)return jR;d8=1;var e=d2e(),t=h2e();function r(n,a){return n!=null&&t(n,a,e)}return jR=r,jR}var NR,h8;function p2e(){if(h8)return NR;h8=1;var e=gL(),t=FX(),r=f2e(),n=Q3(),a=_J(),l=xJ(),h=BP(),i=1,_=2;function w(A,C){return n(A)&&a(C)?l(h(A),C):function(R){var z=t(R,A);return z===void 0&&z===C?r(R,A):e(C,z,i|_)}}return NR=w,NR}var IR,f8;function E0(){if(f8)return IR;f8=1;function e(t){return t}return IR=e,IR}var DR,p8;function m2e(){if(p8)return DR;p8=1;function e(t){return function(r){return r==null?void 0:r[t]}}return DR=e,DR}var LR,m8;function g2e(){if(m8)return LR;m8=1;var e=aL();function t(r){return function(n){return e(n,r)}}return LR=t,LR}var zR,g8;function y2e(){if(g8)return zR;g8=1;var e=m2e(),t=g2e(),r=Q3(),n=BP();function a(l){return r(l)?e(n(l)):t(l)}return zR=a,zR}var FR,y8;function tp(){if(y8)return FR;y8=1;var e=u2e(),t=p2e(),r=E0(),n=Uc(),a=y2e();function l(h){return typeof h=="function"?h:h==null?r:typeof h=="object"?n(h)?t(h[0],h[1]):e(h):a(h)}return FR=l,FR}var BR,v8;function bJ(){if(v8)return BR;v8=1;function e(t,r,n,a){for(var l=t.length,h=n+(a?1:-1);a?h--:++h<l;)if(r(t[h],h,t))return h;return-1}return BR=e,BR}var VR,_8;function v2e(){if(_8)return VR;_8=1;function e(t){return t!==t}return VR=e,VR}var UR,x8;function _2e(){if(x8)return UR;x8=1;function e(t,r,n){for(var a=n-1,l=t.length;++a<l;)if(t[a]===r)return a;return-1}return UR=e,UR}var $R,b8;function x2e(){if(b8)return $R;b8=1;var e=bJ(),t=v2e(),r=_2e();function n(a,l,h){return l===l?r(a,l,h):e(a,t,h)}return $R=n,$R}var qR,w8;function b2e(){if(w8)return qR;w8=1;var e=x2e();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return qR=t,qR}var GR,S8;function w2e(){if(S8)return GR;S8=1;function e(t,r,n){for(var a=-1,l=t==null?0:t.length;++a<l;)if(n(r,t[a]))return!0;return!1}return GR=e,GR}var KR,A8;function S2e(){if(A8)return KR;A8=1;function e(){}return KR=e,KR}var WR,T8;function A2e(){if(T8)return WR;T8=1;var e=vJ(),t=S2e(),r=hL(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(l){return new e(l)}:t;return WR=a,WR}var HR,P8;function T2e(){if(P8)return HR;P8=1;var e=cJ(),t=b2e(),r=w2e(),n=dJ(),a=A2e(),l=hL(),h=200;function i(_,w,A){var C=-1,R=t,z=_.length,V=!0,U=[],G=U;if(A)V=!1,R=r;else if(z>=h){var H=w?null:a(_);if(H)return l(H);V=!1,R=n,G=new e}else G=w?[]:U;e:for(;++C<z;){var J=_[C],Q=w?w(J):J;if(J=A||J!==0?J:0,V&&Q===Q){for(var le=G.length;le--;)if(G[le]===Q)continue e;w&&G.push(Q),U.push(J)}else R(G,Q,A)||(G!==U&&G.push(Q),U.push(J))}return U}return HR=i,HR}var ZR,E8;function P2e(){if(E8)return ZR;E8=1;var e=tp(),t=T2e();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return ZR=r,ZR}var E2e=P2e();const C8=ta(E2e);function wJ(e,t,r){return t===!0?C8(e,r):Cn(t)?C8(e,t):e}function Cx(e){"@babel/helpers - typeof";return Cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(e)}var C2e=["ref"];function M8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M8(Object(r),!0).forEach(function(n){WP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M2e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AJ(n.key),n)}}function O2e(e,t,r){return t&&O8(e.prototype,t),r&&O8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R2e(e,t,r){return t=oT(t),k2e(e,SJ()?Reflect.construct(t,r||[],oT(e).constructor):t.apply(e,r))}function k2e(e,t){if(t&&(Cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j2e(e)}function j2e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function SJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(SJ=function(){return!!e})()}function oT(e){return oT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oT(e)}function N2e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qN(e,t)}function qN(e,t){return qN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qN(e,t)}function WP(e,t,r){return t=AJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AJ(e){var t=I2e(e,"string");return Cx(t)=="symbol"?t:t+""}function I2e(e,t){if(Cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function D2e(e,t){if(e==null)return{};var r=L2e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function L2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function z2e(e){return e.value}function F2e(e,t){if(Pe.isValidElement(e))return Pe.cloneElement(e,t);if(typeof e=="function")return Pe.createElement(e,t);t.ref;var r=D2e(t,C2e);return Pe.createElement(dL,r)}var R8=1,kh=function(e){function t(){var r;M2e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=R2e(this,t,[].concat(a)),WP(r,"lastBoundingBox",{width:-1,height:-1}),r}return N2e(t,e),O2e(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>R8||Math.abs(a.height-this.lastBoundingBox.height)>R8)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?qp({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,l=a.layout,h=a.align,i=a.verticalAlign,_=a.margin,w=a.chartWidth,A=a.chartHeight,C,R;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(h==="center"&&l==="vertical"){var z=this.getBBoxSnapshot();C={left:((w||0)-z.width)/2}}else C=h==="right"?{right:_&&_.right||0}:{left:_&&_.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var V=this.getBBoxSnapshot();R={top:((A||0)-V.height)/2}}else R=i==="bottom"?{bottom:_&&_.bottom||0}:{top:_&&_.top||0};return qp(qp({},C),R)}},{key:"render",value:function(){var n=this,a=this.props,l=a.content,h=a.width,i=a.height,_=a.wrapperStyle,w=a.payloadUniqBy,A=a.payload,C=qp(qp({position:"absolute",width:h||"auto",height:i||"auto"},this.getDefaultPosition(_)),_);return Pe.createElement("div",{className:"recharts-legend-wrapper",style:C,ref:function(z){n.wrapperNode=z}},F2e(l,qp(qp({},this.props),{},{payload:wJ(A,w,z2e)})))}}],[{key:"getWithHeight",value:function(n,a){var l=qp(qp({},this.defaultProps),n.props),h=l.layout;return h==="vertical"&&Ir(n.props.height)?{height:n.props.height}:h==="horizontal"?{width:n.props.width||a}:null}}])}(K.PureComponent);WP(kh,"displayName","Legend");WP(kh,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var YR,k8;function B2e(){if(k8)return YR;k8=1;var e=sS(),t=fL(),r=Uc(),n=e?e.isConcatSpreadable:void 0;function a(l){return r(l)||t(l)||!!(n&&l&&l[n])}return YR=a,YR}var XR,j8;function TJ(){if(j8)return XR;j8=1;var e=fJ(),t=B2e();function r(n,a,l,h,i){var _=-1,w=n.length;for(l||(l=t),i||(i=[]);++_<w;){var A=n[_];a>0&&l(A)?a>1?r(A,a-1,l,h,i):e(i,A):h||(i[i.length]=A)}return i}return XR=r,XR}var JR,N8;function V2e(){if(N8)return JR;N8=1;function e(t){return function(r,n,a){for(var l=-1,h=Object(r),i=a(r),_=i.length;_--;){var w=i[t?_:++l];if(n(h[w],w,h)===!1)break}return r}}return JR=e,JR}var QR,I8;function U2e(){if(I8)return QR;I8=1;var e=V2e(),t=e();return QR=t,QR}var ek,D8;function PJ(){if(D8)return ek;D8=1;var e=U2e(),t=KP();function r(n,a){return n&&e(n,a,t)}return ek=r,ek}var tk,L8;function $2e(){if(L8)return tk;L8=1;var e=cS();function t(r,n){return function(a,l){if(a==null)return a;if(!e(a))return r(a,l);for(var h=a.length,i=n?h:-1,_=Object(a);(n?i--:++i<h)&&l(_[i],i,_)!==!1;);return a}}return tk=t,tk}var rk,z8;function yL(){if(z8)return rk;z8=1;var e=PJ(),t=$2e(),r=t(e);return rk=r,rk}var nk,F8;function EJ(){if(F8)return nk;F8=1;var e=yL(),t=cS();function r(n,a){var l=-1,h=t(n)?Array(n.length):[];return e(n,function(i,_,w){h[++l]=a(i,_,w)}),h}return nk=r,nk}var ik,B8;function q2e(){if(B8)return ik;B8=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return ik=e,ik}var ak,V8;function G2e(){if(V8)return ak;V8=1;var e=A0();function t(r,n){if(r!==n){var a=r!==void 0,l=r===null,h=r===r,i=e(r),_=n!==void 0,w=n===null,A=n===n,C=e(n);if(!w&&!C&&!i&&r>n||i&&_&&A&&!w&&!C||l&&_&&A||!a&&A||!h)return 1;if(!l&&!i&&!C&&r<n||C&&a&&h&&!l&&!i||w&&a&&h||!_&&h||!A)return-1}return 0}return ak=t,ak}var ok,U8;function K2e(){if(U8)return ok;U8=1;var e=G2e();function t(r,n,a){for(var l=-1,h=r.criteria,i=n.criteria,_=h.length,w=a.length;++l<_;){var A=e(h[l],i[l]);if(A){if(l>=w)return A;var C=a[l];return A*(C=="desc"?-1:1)}}return r.index-n.index}return ok=t,ok}var sk,$8;function W2e(){if($8)return sk;$8=1;var e=iL(),t=aL(),r=tp(),n=EJ(),a=q2e(),l=mJ(),h=K2e(),i=E0(),_=Uc();function w(A,C,R){C.length?C=e(C,function(U){return _(U)?function(G){return t(G,U.length===1?U[0]:U)}:U}):C=[i];var z=-1;C=e(C,l(r));var V=n(A,function(U,G,H){var J=e(C,function(Q){return Q(U)});return{criteria:J,index:++z,value:U}});return a(V,function(U,G){return h(U,G,R)})}return sk=w,sk}var lk,q8;function H2e(){if(q8)return lk;q8=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return lk=e,lk}var ck,G8;function Z2e(){if(G8)return ck;G8=1;var e=H2e(),t=Math.max;function r(n,a,l){return a=t(a===void 0?n.length-1:a,0),function(){for(var h=arguments,i=-1,_=t(h.length-a,0),w=Array(_);++i<_;)w[i]=h[a+i];i=-1;for(var A=Array(a+1);++i<a;)A[i]=h[i];return A[a]=l(w),e(n,this,A)}}return ck=r,ck}var uk,K8;function Y2e(){if(K8)return uk;K8=1;function e(t){return function(){return t}}return uk=e,uk}var dk,W8;function CJ(){if(W8)return dk;W8=1;var e=Hv(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return dk=t,dk}var hk,H8;function X2e(){if(H8)return hk;H8=1;var e=Y2e(),t=CJ(),r=E0(),n=t?function(a,l){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(l),writable:!0})}:r;return hk=n,hk}var fk,Z8;function J2e(){if(Z8)return fk;Z8=1;var e=800,t=16,r=Date.now;function n(a){var l=0,h=0;return function(){var i=r(),_=t-(i-h);if(h=i,_>0){if(++l>=e)return arguments[0]}else l=0;return a.apply(void 0,arguments)}}return fk=n,fk}var pk,Y8;function Q2e(){if(Y8)return pk;Y8=1;var e=X2e(),t=J2e(),r=t(e);return pk=r,pk}var mk,X8;function eAe(){if(X8)return mk;X8=1;var e=E0(),t=Z2e(),r=Q2e();function n(a,l){return r(t(a,l,e),a+"")}return mk=n,mk}var gk,J8;function HP(){if(J8)return gk;J8=1;var e=tL(),t=cS(),r=pL(),n=Wg();function a(l,h,i){if(!n(i))return!1;var _=typeof h;return(_=="number"?t(i)&&r(h,i.length):_=="string"&&h in i)?e(i[h],l):!1}return gk=a,gk}var yk,Q8;function tAe(){if(Q8)return yk;Q8=1;var e=TJ(),t=W2e(),r=eAe(),n=HP(),a=r(function(l,h){if(l==null)return[];var i=h.length;return i>1&&n(l,h[0],h[1])?h=[]:i>2&&n(h[0],h[1],h[2])&&(h=[h[0]]),t(l,e(h,1),[])});return yk=a,yk}var rAe=tAe();const vL=ta(rAe);function ew(e){"@babel/helpers - typeof";return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(e)}function GN(){return GN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GN.apply(this,arguments)}function nAe(e,t){return sAe(e)||oAe(e,t)||aAe(e,t)||iAe()}function iAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aAe(e,t){if(e){if(typeof e=="string")return e7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e7(e,t)}}function e7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function sAe(e){if(Array.isArray(e))return e}function t7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t7(Object(r),!0).forEach(function(n){lAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lAe(e,t,r){return t=cAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cAe(e){var t=uAe(e,"string");return ew(t)=="symbol"?t:t+""}function uAe(e,t){if(ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dAe(e){return Array.isArray(e)&&Ns(e[0])&&Ns(e[1])?e.join(" ~ "):e}var hAe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,l=a===void 0?{}:a,h=t.itemStyle,i=h===void 0?{}:h,_=t.labelStyle,w=_===void 0?{}:_,A=t.payload,C=t.formatter,R=t.itemSorter,z=t.wrapperClassName,V=t.labelClassName,U=t.label,G=t.labelFormatter,H=t.accessibilityLayer,J=H===void 0?!1:H,Q=function(){if(A&&A.length){var ke={padding:0,margin:0},ze=(R?vL(A,R):A).map(function(et,je){if(et.type==="none")return null;var Ne=vk({display:"block",paddingTop:4,paddingBottom:4,color:et.color||"#000"},i),Ye=et.formatter||C||dAe,$e=et.value,We=et.name,Et=$e,Je=We;if(Ye&&Et!=null&&Je!=null){var ht=Ye($e,We,et,je,A);if(Array.isArray(ht)){var tt=nAe(ht,2);Et=tt[0],Je=tt[1]}else Et=ht}return Pe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(je),style:Ne},Ns(Je)?Pe.createElement("span",{className:"recharts-tooltip-item-name"},Je):null,Ns(Je)?Pe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Pe.createElement("span",{className:"recharts-tooltip-item-value"},Et),Pe.createElement("span",{className:"recharts-tooltip-item-unit"},et.unit||""))});return Pe.createElement("ul",{className:"recharts-tooltip-item-list",style:ke},ze)}return null},le=vk({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),ne=vk({margin:0},w),de=!Gn(U),ue=de?U:"",ve=Xn("recharts-default-tooltip",z),Ae=Xn("recharts-tooltip-label",V);de&&G&&A!==void 0&&A!==null&&(ue=G(U,A));var Oe=J?{role:"status","aria-live":"assertive"}:{};return Pe.createElement("div",GN({className:ve,style:le},Oe),Pe.createElement("p",{className:Ae,style:ne},Pe.isValidElement(ue)?ue:"".concat(ue)),Q())};function tw(e){"@babel/helpers - typeof";return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function F2(e,t,r){return t=fAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fAe(e){var t=pAe(e,"string");return tw(t)=="symbol"?t:t+""}function pAe(e,t){if(tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lb="recharts-tooltip-wrapper",mAe={visibility:"hidden"};function gAe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Xn(Lb,F2(F2(F2(F2({},"".concat(Lb,"-right"),Ir(r)&&t&&Ir(t.x)&&r>=t.x),"".concat(Lb,"-left"),Ir(r)&&t&&Ir(t.x)&&r<t.x),"".concat(Lb,"-bottom"),Ir(n)&&t&&Ir(t.y)&&n>=t.y),"".concat(Lb,"-top"),Ir(n)&&t&&Ir(t.y)&&n<t.y))}function r7(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,l=e.position,h=e.reverseDirection,i=e.tooltipDimension,_=e.viewBox,w=e.viewBoxDimension;if(l&&Ir(l[n]))return l[n];var A=r[n]-i-a,C=r[n]+a;if(t[n])return h[n]?A:C;if(h[n]){var R=A,z=_[n];return R<z?Math.max(C,_[n]):Math.max(A,_[n])}var V=C+i,U=_[n]+w;return V>U?Math.max(A,_[n]):Math.max(C,_[n])}function yAe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function vAe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,l=e.reverseDirection,h=e.tooltipBox,i=e.useTranslate3d,_=e.viewBox,w,A,C;return h.height>0&&h.width>0&&r?(A=r7({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:h.width,viewBox:_,viewBoxDimension:_.width}),C=r7({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:l,tooltipDimension:h.height,viewBox:_,viewBoxDimension:_.height}),w=yAe({translateX:A,translateY:C,useTranslate3d:i})):w=mAe,{cssProperties:w,cssClasses:gAe({translateX:A,translateY:C,coordinate:r})}}function Mx(e){"@babel/helpers - typeof";return Mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mx(e)}function n7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function i7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n7(Object(r),!0).forEach(function(n){WN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OJ(n.key),n)}}function bAe(e,t,r){return t&&xAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wAe(e,t,r){return t=sT(t),SAe(e,MJ()?Reflect.construct(t,r||[],sT(e).constructor):t.apply(e,r))}function SAe(e,t){if(t&&(Mx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AAe(e)}function AAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MJ=function(){return!!e})()}function sT(e){return sT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sT(e)}function TAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KN(e,t)}function KN(e,t){return KN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},KN(e,t)}function WN(e,t,r){return t=OJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OJ(e){var t=PAe(e,"string");return Mx(t)=="symbol"?t:t+""}function PAe(e,t){if(Mx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var a7=1,EAe=function(e){function t(){var r;_Ae(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=wAe(this,t,[].concat(a)),WN(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),WN(r,"handleKeyDown",function(h){if(h.key==="Escape"){var i,_,w,A;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(_=r.props.coordinate)===null||_===void 0?void 0:_.x)!==null&&i!==void 0?i:0,y:(w=(A=r.props.coordinate)===null||A===void 0?void 0:A.y)!==null&&w!==void 0?w:0}})}}),r}return TAe(t,e),bAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>a7||Math.abs(n.height-this.state.lastBoundingBox.height)>a7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,l=a.active,h=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,w=a.children,A=a.coordinate,C=a.hasPayload,R=a.isAnimationActive,z=a.offset,V=a.position,U=a.reverseDirection,G=a.useTranslate3d,H=a.viewBox,J=a.wrapperStyle,Q=vAe({allowEscapeViewBox:h,coordinate:A,offsetTopLeft:z,position:V,reverseDirection:U,tooltipBox:this.state.lastBoundingBox,useTranslate3d:G,viewBox:H}),le=Q.cssClasses,ne=Q.cssProperties,de=i7(i7({transition:R&&l?"transform ".concat(i,"ms ").concat(_):void 0},ne),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&C?"visible":"hidden",position:"absolute",top:0,left:0},J);return Pe.createElement("div",{tabIndex:-1,className:le,style:de,ref:function(ve){n.wrapperNode=ve}},w)}}])}(K.PureComponent),CAe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Wh={isSsr:CAe()};function Ox(e){"@babel/helpers - typeof";return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}function o7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(r),!0).forEach(function(n){_L(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OAe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kJ(n.key),n)}}function RAe(e,t,r){return t&&OAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kAe(e,t,r){return t=lT(t),jAe(e,RJ()?Reflect.construct(t,r||[],lT(e).constructor):t.apply(e,r))}function jAe(e,t){if(t&&(Ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NAe(e)}function NAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function RJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(RJ=function(){return!!e})()}function lT(e){return lT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lT(e)}function IAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HN(e,t)}function HN(e,t){return HN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},HN(e,t)}function _L(e,t,r){return t=kJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kJ(e){var t=DAe(e,"string");return Ox(t)=="symbol"?t:t+""}function DAe(e,t){if(Ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function LAe(e){return e.dataKey}function zAe(e,t){return Pe.isValidElement(e)?Pe.cloneElement(e,t):typeof e=="function"?Pe.createElement(e,t):Pe.createElement(hAe,t)}var wa=function(e){function t(){return MAe(this,t),kAe(this,t,arguments)}return IAe(t,e),RAe(t,[{key:"render",value:function(){var n=this,a=this.props,l=a.active,h=a.allowEscapeViewBox,i=a.animationDuration,_=a.animationEasing,w=a.content,A=a.coordinate,C=a.filterNull,R=a.isAnimationActive,z=a.offset,V=a.payload,U=a.payloadUniqBy,G=a.position,H=a.reverseDirection,J=a.useTranslate3d,Q=a.viewBox,le=a.wrapperStyle,ne=V??[];C&&ne.length&&(ne=wJ(V.filter(function(ue){return ue.value!=null&&(ue.hide!==!0||n.props.includeHidden)}),U,LAe));var de=ne.length>0;return Pe.createElement(EAe,{allowEscapeViewBox:h,animationDuration:i,animationEasing:_,isAnimationActive:R,active:l,coordinate:A,hasPayload:de,offset:z,position:G,reverseDirection:H,useTranslate3d:J,viewBox:Q,wrapperStyle:le},zAe(w,s7(s7({},this.props),{},{payload:ne})))}}])}(K.PureComponent);_L(wa,"displayName","Tooltip");_L(wa,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Wh.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var _k,l7;function FAe(){if(l7)return _k;l7=1;var e=ep(),t=function(){return e.Date.now()};return _k=t,_k}var xk,c7;function BAe(){if(c7)return xk;c7=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return xk=t,xk}var bk,u7;function VAe(){if(u7)return bk;u7=1;var e=BAe(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return bk=r,bk}var wk,d7;function jJ(){if(d7)return wk;d7=1;var e=VAe(),t=Wg(),r=A0(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,i=parseInt;function _(w){if(typeof w=="number")return w;if(r(w))return n;if(t(w)){var A=typeof w.valueOf=="function"?w.valueOf():w;w=t(A)?A+"":A}if(typeof w!="string")return w===0?w:+w;w=e(w);var C=l.test(w);return C||h.test(w)?i(w.slice(2),C?2:8):a.test(w)?n:+w}return wk=_,wk}var Sk,h7;function UAe(){if(h7)return Sk;h7=1;var e=Wg(),t=FAe(),r=jJ(),n="Expected a function",a=Math.max,l=Math.min;function h(i,_,w){var A,C,R,z,V,U,G=0,H=!1,J=!1,Q=!0;if(typeof i!="function")throw new TypeError(n);_=r(_)||0,e(w)&&(H=!!w.leading,J="maxWait"in w,R=J?a(r(w.maxWait)||0,_):R,Q="trailing"in w?!!w.trailing:Q);function le(ze){var et=A,je=C;return A=C=void 0,G=ze,z=i.apply(je,et),z}function ne(ze){return G=ze,V=setTimeout(ve,_),H?le(ze):z}function de(ze){var et=ze-U,je=ze-G,Ne=_-et;return J?l(Ne,R-je):Ne}function ue(ze){var et=ze-U,je=ze-G;return U===void 0||et>=_||et<0||J&&je>=R}function ve(){var ze=t();if(ue(ze))return Ae(ze);V=setTimeout(ve,de(ze))}function Ae(ze){return V=void 0,Q&&A?le(ze):(A=C=void 0,z)}function Oe(){V!==void 0&&clearTimeout(V),G=0,A=U=C=V=void 0}function Se(){return V===void 0?z:Ae(t())}function ke(){var ze=t(),et=ue(ze);if(A=arguments,C=this,U=ze,et){if(V===void 0)return ne(U);if(J)return clearTimeout(V),V=setTimeout(ve,_),le(U)}return V===void 0&&(V=setTimeout(ve,_)),z}return ke.cancel=Oe,ke.flush=Se,ke}return Sk=h,Sk}var Ak,f7;function $Ae(){if(f7)return Ak;f7=1;var e=UAe(),t=Wg(),r="Expected a function";function n(a,l,h){var i=!0,_=!0;if(typeof a!="function")throw new TypeError(r);return t(h)&&(i="leading"in h?!!h.leading:i,_="trailing"in h?!!h.trailing:_),e(a,l,{leading:i,maxWait:l,trailing:_})}return Ak=n,Ak}var qAe=$Ae();const NJ=ta(qAe);function rw(e){"@babel/helpers - typeof";return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(e)}function p7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function B2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p7(Object(r),!0).forEach(function(n){GAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GAe(e,t,r){return t=KAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KAe(e){var t=WAe(e,"string");return rw(t)=="symbol"?t:t+""}function WAe(e,t){if(rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HAe(e,t){return JAe(e)||XAe(e,t)||YAe(e,t)||ZAe()}function ZAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YAe(e,t){if(e){if(typeof e=="string")return m7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m7(e,t)}}function m7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function JAe(e){if(Array.isArray(e))return e}var Qs=K.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,l=e.width,h=l===void 0?"100%":l,i=e.height,_=i===void 0?"100%":i,w=e.minWidth,A=w===void 0?0:w,C=e.minHeight,R=e.maxHeight,z=e.children,V=e.debounce,U=V===void 0?0:V,G=e.id,H=e.className,J=e.onResize,Q=e.style,le=Q===void 0?{}:Q,ne=K.useRef(null),de=K.useRef();de.current=J,K.useImperativeHandle(t,function(){return Object.defineProperty(ne.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ne.current},configurable:!0})});var ue=K.useState({containerWidth:a.width,containerHeight:a.height}),ve=HAe(ue,2),Ae=ve[0],Oe=ve[1],Se=K.useCallback(function(ze,et){Oe(function(je){var Ne=Math.round(ze),Ye=Math.round(et);return je.containerWidth===Ne&&je.containerHeight===Ye?je:{containerWidth:Ne,containerHeight:Ye}})},[]);K.useEffect(function(){var ze=function(We){var Et,Je=We[0].contentRect,ht=Je.width,tt=Je.height;Se(ht,tt),(Et=de.current)===null||Et===void 0||Et.call(de,ht,tt)};U>0&&(ze=NJ(ze,U,{trailing:!0,leading:!1}));var et=new ResizeObserver(ze),je=ne.current.getBoundingClientRect(),Ne=je.width,Ye=je.height;return Se(Ne,Ye),et.observe(ne.current),function(){et.disconnect()}},[Se,U]);var ke=K.useMemo(function(){var ze=Ae.containerWidth,et=Ae.containerHeight;if(ze<0||et<0)return null;Rh(fv(h)||fv(_),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,h,_),Rh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var je=fv(h)?ze:h,Ne=fv(_)?et:_;r&&r>0&&(je?Ne=je/r:Ne&&(je=Ne*r),R&&Ne>R&&(Ne=R)),Rh(je>0||Ne>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,je,Ne,h,_,A,C,r);var Ye=!Array.isArray(z)&&am(z.type).endsWith("Chart");return Pe.Children.map(z,function($e){return Pe.isValidElement($e)?K.cloneElement($e,B2({width:je,height:Ne},Ye?{style:B2({height:"100%",width:"100%",maxHeight:Ne,maxWidth:je},$e.props.style)}:{})):$e})},[r,z,_,R,C,A,Ae,h]);return Pe.createElement("div",{id:G?"".concat(G):void 0,className:Xn("recharts-responsive-container",H),style:B2(B2({},le),{},{width:h,height:_,minWidth:A,minHeight:C,maxHeight:R}),ref:ne},ke)}),hm=function(t){return null};hm.displayName="Cell";function nw(e){"@babel/helpers - typeof";return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(e)}function g7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ZN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g7(Object(r),!0).forEach(function(n){QAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QAe(e,t,r){return t=eTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eTe(e){var t=tTe(e,"string");return nw(t)=="symbol"?t:t+""}function tTe(e,t){if(nw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K_={widthCache:{},cacheCount:0},rTe=2e3,nTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},y7="recharts_measurement_span";function iTe(e){var t=ZN({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var d1=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Wh.isSsr)return{width:0,height:0};var n=iTe(r),a=JSON.stringify({text:t,copyStyle:n});if(K_.widthCache[a])return K_.widthCache[a];try{var l=document.getElementById(y7);l||(l=document.createElement("span"),l.setAttribute("id",y7),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var h=ZN(ZN({},nTe),n);Object.assign(l.style,h),l.textContent="".concat(t);var i=l.getBoundingClientRect(),_={width:i.width,height:i.height};return K_.widthCache[a]=_,++K_.cacheCount>rTe&&(K_.cacheCount=0,K_.widthCache={}),_}catch{return{width:0,height:0}}},aTe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function iw(e){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function cT(e,t){return cTe(e)||lTe(e,t)||sTe(e,t)||oTe()}function oTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sTe(e,t){if(e){if(typeof e=="string")return v7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v7(e,t)}}function v7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function cTe(e){if(Array.isArray(e))return e}function uTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hTe(n.key),n)}}function dTe(e,t,r){return t&&_7(e.prototype,t),r&&_7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hTe(e){var t=fTe(e,"string");return iw(t)=="symbol"?t:t+""}function fTe(e,t){if(iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var x7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,b7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,pTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,mTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,IJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},gTe=Object.keys(IJ),ix="NaN";function yTe(e,t){return e*IJ[t]}var V2=function(){function e(t,r){uTe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!pTe.test(r)&&(this.num=NaN,this.unit=""),gTe.includes(r)&&(this.num=yTe(t,r),this.unit="px")}return dTe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=mTe.exec(r))!==null&&n!==void 0?n:[],l=cT(a,3),h=l[1],i=l[2];return new e(parseFloat(h),i??"")}}])}();function DJ(e){if(e.includes(ix))return ix;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=x7.exec(t))!==null&&r!==void 0?r:[],a=cT(n,4),l=a[1],h=a[2],i=a[3],_=V2.parse(l??""),w=V2.parse(i??""),A=h==="*"?_.multiply(w):_.divide(w);if(A.isNaN())return ix;t=t.replace(x7,A.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var C,R=(C=b7.exec(t))!==null&&C!==void 0?C:[],z=cT(R,4),V=z[1],U=z[2],G=z[3],H=V2.parse(V??""),J=V2.parse(G??""),Q=U==="+"?H.add(J):H.subtract(J);if(Q.isNaN())return ix;t=t.replace(b7,Q.toString())}return t}var w7=/\(([^()]*)\)/;function vTe(e){for(var t=e;t.includes("(");){var r=w7.exec(t),n=cT(r,2),a=n[1];t=t.replace(w7,DJ(a))}return t}function _Te(e){var t=e.replace(/\s+/g,"");return t=vTe(t),t=DJ(t),t}function xTe(e){try{return _Te(e)}catch{return ix}}function Tk(e){var t=xTe(e.slice(5,-1));return t===ix?"":t}var bTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],wTe=["dx","dy","angle","className","breakAll"];function YN(){return YN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YN.apply(this,arguments)}function S7(e,t){if(e==null)return{};var r=STe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function STe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function A7(e,t){return ETe(e)||PTe(e,t)||TTe(e,t)||ATe()}function ATe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TTe(e,t){if(e){if(typeof e=="string")return T7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T7(e,t)}}function T7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;_=!1}else for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function ETe(e){if(Array.isArray(e))return e}var LJ=/[ \f\n\r\t\v\u2028\u2029]+/,zJ=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var l=[];Gn(r)||(n?l=r.toString().split(""):l=r.toString().split(LJ));var h=l.map(function(_){return{word:_,width:d1(_,a).width}}),i=n?0:d1("",a).width;return{wordsWithComputedWidth:h,spaceWidth:i}}catch{return null}},CTe=function(t,r,n,a,l){var h=t.maxLines,i=t.children,_=t.style,w=t.breakAll,A=Ir(h),C=i,R=function(){var je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return je.reduce(function(Ne,Ye){var $e=Ye.word,We=Ye.width,Et=Ne[Ne.length-1];if(Et&&(a==null||l||Et.width+We+n<Number(a)))Et.words.push($e),Et.width+=We+n;else{var Je={words:[$e],width:We};Ne.push(Je)}return Ne},[])},z=R(r),V=function(je){return je.reduce(function(Ne,Ye){return Ne.width>Ye.width?Ne:Ye})};if(!A)return z;for(var U="",G=function(je){var Ne=C.slice(0,je),Ye=zJ({breakAll:w,style:_,children:Ne+U}).wordsWithComputedWidth,$e=R(Ye),We=$e.length>h||V($e).width>Number(a);return[We,$e]},H=0,J=C.length-1,Q=0,le;H<=J&&Q<=C.length-1;){var ne=Math.floor((H+J)/2),de=ne-1,ue=G(de),ve=A7(ue,2),Ae=ve[0],Oe=ve[1],Se=G(ne),ke=A7(Se,1),ze=ke[0];if(!Ae&&!ze&&(H=ne+1),Ae&&ze&&(J=ne-1),!Ae&&ze){le=Oe;break}Q++}return le||z},P7=function(t){var r=Gn(t)?[]:t.toString().split(LJ);return[{words:r}]},MTe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,l=t.style,h=t.breakAll,i=t.maxLines;if((r||n)&&!Wh.isSsr){var _,w,A=zJ({breakAll:h,children:a,style:l});if(A){var C=A.wordsWithComputedWidth,R=A.spaceWidth;_=C,w=R}else return P7(a);return CTe({breakAll:h,children:a,maxLines:i,style:l},_,w,r,n)}return P7(a)},E7="#808080",Rv=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,h=t.lineHeight,i=h===void 0?"1em":h,_=t.capHeight,w=_===void 0?"0.71em":_,A=t.scaleToFit,C=A===void 0?!1:A,R=t.textAnchor,z=R===void 0?"start":R,V=t.verticalAnchor,U=V===void 0?"end":V,G=t.fill,H=G===void 0?E7:G,J=S7(t,bTe),Q=K.useMemo(function(){return MTe({breakAll:J.breakAll,children:J.children,maxLines:J.maxLines,scaleToFit:C,style:J.style,width:J.width})},[J.breakAll,J.children,J.maxLines,C,J.style,J.width]),le=J.dx,ne=J.dy,de=J.angle,ue=J.className,ve=J.breakAll,Ae=S7(J,wTe);if(!Ns(n)||!Ns(l))return null;var Oe=n+(Ir(le)?le:0),Se=l+(Ir(ne)?ne:0),ke;switch(U){case"start":ke=Tk("calc(".concat(w,")"));break;case"middle":ke=Tk("calc(".concat((Q.length-1)/2," * -").concat(i," + (").concat(w," / 2))"));break;default:ke=Tk("calc(".concat(Q.length-1," * -").concat(i,")"));break}var ze=[];if(C){var et=Q[0].width,je=J.width;ze.push("scale(".concat((Ir(je)?je/et:1)/et,")"))}return de&&ze.push("rotate(".concat(de,", ").concat(Oe,", ").concat(Se,")")),ze.length&&(Ae.transform=ze.join(" ")),Pe.createElement("text",YN({},on(Ae,!0),{x:Oe,y:Se,className:Xn("recharts-text",ue),textAnchor:z,fill:H.includes("url")?E7:H}),Q.map(function(Ne,Ye){var $e=Ne.words.join(ve?"":" ");return Pe.createElement("tspan",{x:Oe,dy:Ye===0?ke:i,key:"".concat($e,"-").concat(Ye)},$e)}))};function Og(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function OTe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function xL(e){let t,r,n;e.length!==2?(t=Og,r=(i,_)=>Og(e(i),_),n=(i,_)=>e(i)-_):(t=e===Og||e===OTe?e:RTe,r=e,n=e);function a(i,_,w=0,A=i.length){if(w<A){if(t(_,_)!==0)return A;do{const C=w+A>>>1;r(i[C],_)<0?w=C+1:A=C}while(w<A)}return w}function l(i,_,w=0,A=i.length){if(w<A){if(t(_,_)!==0)return A;do{const C=w+A>>>1;r(i[C],_)<=0?w=C+1:A=C}while(w<A)}return w}function h(i,_,w=0,A=i.length){const C=a(i,_,w,A-1);return C>w&&n(i[C-1],_)>-n(i[C],_)?C-1:C}return{left:a,center:h,right:l}}function RTe(){return 0}function FJ(e){return e===null?NaN:+e}function*kTe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const jTe=xL(Og),uS=jTe.right;xL(FJ).center;class C7 extends Map{constructor(t,r=DTe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(M7(this,t))}has(t){return super.has(M7(this,t))}set(t,r){return super.set(NTe(this,t),r)}delete(t){return super.delete(ITe(this,t))}}function M7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function NTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function ITe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function DTe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function LTe(e=Og){if(e===Og)return BJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function BJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const zTe=Math.sqrt(50),FTe=Math.sqrt(10),BTe=Math.sqrt(2);function uT(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),l=n/Math.pow(10,a),h=l>=zTe?10:l>=FTe?5:l>=BTe?2:1;let i,_,w;return a<0?(w=Math.pow(10,-a)/h,i=Math.round(e*w),_=Math.round(t*w),i/w<e&&++i,_/w>t&&--_,w=-w):(w=Math.pow(10,a)*h,i=Math.round(e/w),_=Math.round(t/w),i*w<e&&++i,_*w>t&&--_),_<i&&.5<=r&&r<2?uT(e,t,r*2):[i,_,w]}function XN(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,l,h]=n?uT(t,e,r):uT(e,t,r);if(!(l>=a))return[];const i=l-a+1,_=new Array(i);if(n)if(h<0)for(let w=0;w<i;++w)_[w]=(l-w)/-h;else for(let w=0;w<i;++w)_[w]=(l-w)*h;else if(h<0)for(let w=0;w<i;++w)_[w]=(a+w)/-h;else for(let w=0;w<i;++w)_[w]=(a+w)*h;return _}function JN(e,t,r){return t=+t,e=+e,r=+r,uT(e,t,r)[2]}function QN(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?JN(t,e,r):JN(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function O7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function R7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function VJ(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?BJ:LTe(a);n>r;){if(n-r>600){const _=n-r+1,w=t-r+1,A=Math.log(_),C=.5*Math.exp(2*A/3),R=.5*Math.sqrt(A*C*(_-C)/_)*(w-_/2<0?-1:1),z=Math.max(r,Math.floor(t-w*C/_+R)),V=Math.min(n,Math.floor(t+(_-w)*C/_+R));VJ(e,t,z,V,a)}const l=e[t];let h=r,i=n;for(zb(e,r,t),a(e[n],l)>0&&zb(e,r,n);h<i;){for(zb(e,h,i),++h,--i;a(e[h],l)<0;)++h;for(;a(e[i],l)>0;)--i}a(e[r],l)===0?zb(e,r,i):(++i,zb(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function zb(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function VTe(e,t,r){if(e=Float64Array.from(kTe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return R7(e);if(t>=1)return O7(e);var n,a=(n-1)*t,l=Math.floor(a),h=O7(VJ(e,l).subarray(0,l+1)),i=R7(e.subarray(l+1));return h+(i-h)*(a-l)}}function UTe(e,t,r=FJ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,l=Math.floor(a),h=+r(e[l],l,e),i=+r(e[l+1],l+1,e);return h+(i-h)*(a-l)}}function $Te(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,l=new Array(a);++n<a;)l[n]=e+n*r;return l}function Od(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function _m(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const eI=Symbol("implicit");function bL(){var e=new C7,t=[],r=[],n=eI;function a(l){let h=e.get(l);if(h===void 0){if(n!==eI)return n;e.set(l,h=t.push(l)-1)}return r[h%r.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new C7;for(const h of l)e.has(h)||e.set(h,t.push(h)-1);return a},a.range=function(l){return arguments.length?(r=Array.from(l),a):r.slice()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return bL(t,r).unknown(n)},Od.apply(a,arguments),a}function aw(){var e=bL().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,l,h,i=!1,_=0,w=0,A=.5;delete e.unknown;function C(){var R=t().length,z=a<n,V=z?a:n,U=z?n:a;l=(U-V)/Math.max(1,R-_+w*2),i&&(l=Math.floor(l)),V+=(U-V-l*(R-_))*A,h=l*(1-_),i&&(V=Math.round(V),h=Math.round(h));var G=$Te(R).map(function(H){return V+l*H});return r(z?G.reverse():G)}return e.domain=function(R){return arguments.length?(t(R),C()):t()},e.range=function(R){return arguments.length?([n,a]=R,n=+n,a=+a,C()):[n,a]},e.rangeRound=function(R){return[n,a]=R,n=+n,a=+a,i=!0,C()},e.bandwidth=function(){return h},e.step=function(){return l},e.round=function(R){return arguments.length?(i=!!R,C()):i},e.padding=function(R){return arguments.length?(_=Math.min(1,w=+R),C()):_},e.paddingInner=function(R){return arguments.length?(_=Math.min(1,R),C()):_},e.paddingOuter=function(R){return arguments.length?(w=+R,C()):w},e.align=function(R){return arguments.length?(A=Math.max(0,Math.min(1,R)),C()):A},e.copy=function(){return aw(t(),[n,a]).round(i).paddingInner(_).paddingOuter(w).align(A)},Od.apply(C(),arguments)}function UJ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return UJ(t())},e}function h1(){return UJ(aw.apply(null,arguments).paddingInner(1))}function wL(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function $J(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function dS(){}var ow=.7,dT=1/ow,mx="\\s*([+-]?\\d+)\\s*",sw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Uf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qTe=/^#([0-9a-f]{3,8})$/,GTe=new RegExp(`^rgb\\(${mx},${mx},${mx}\\)$`),KTe=new RegExp(`^rgb\\(${Uf},${Uf},${Uf}\\)$`),WTe=new RegExp(`^rgba\\(${mx},${mx},${mx},${sw}\\)$`),HTe=new RegExp(`^rgba\\(${Uf},${Uf},${Uf},${sw}\\)$`),ZTe=new RegExp(`^hsl\\(${sw},${Uf},${Uf}\\)$`),YTe=new RegExp(`^hsla\\(${sw},${Uf},${Uf},${sw}\\)$`),k7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};wL(dS,lw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:j7,formatHex:j7,formatHex8:XTe,formatHsl:JTe,formatRgb:N7,toString:N7});function j7(){return this.rgb().formatHex()}function XTe(){return this.rgb().formatHex8()}function JTe(){return qJ(this).formatHsl()}function N7(){return this.rgb().formatRgb()}function lw(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=qTe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?I7(t):r===3?new Ic(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?U2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?U2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=GTe.exec(e))?new Ic(t[1],t[2],t[3],1):(t=KTe.exec(e))?new Ic(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=WTe.exec(e))?U2(t[1],t[2],t[3],t[4]):(t=HTe.exec(e))?U2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ZTe.exec(e))?z7(t[1],t[2]/100,t[3]/100,1):(t=YTe.exec(e))?z7(t[1],t[2]/100,t[3]/100,t[4]):k7.hasOwnProperty(e)?I7(k7[e]):e==="transparent"?new Ic(NaN,NaN,NaN,0):null}function I7(e){return new Ic(e>>16&255,e>>8&255,e&255,1)}function U2(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ic(e,t,r,n)}function QTe(e){return e instanceof dS||(e=lw(e)),e?(e=e.rgb(),new Ic(e.r,e.g,e.b,e.opacity)):new Ic}function tI(e,t,r,n){return arguments.length===1?QTe(e):new Ic(e,t,r,n??1)}function Ic(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}wL(Ic,tI,$J(dS,{brighter(e){return e=e==null?dT:Math.pow(dT,e),new Ic(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ow:Math.pow(ow,e),new Ic(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ic(bv(this.r),bv(this.g),bv(this.b),hT(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:D7,formatHex:D7,formatHex8:ePe,formatRgb:L7,toString:L7}));function D7(){return`#${pv(this.r)}${pv(this.g)}${pv(this.b)}`}function ePe(){return`#${pv(this.r)}${pv(this.g)}${pv(this.b)}${pv((isNaN(this.opacity)?1:this.opacity)*255)}`}function L7(){const e=hT(this.opacity);return`${e===1?"rgb(":"rgba("}${bv(this.r)}, ${bv(this.g)}, ${bv(this.b)}${e===1?")":`, ${e})`}`}function hT(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bv(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pv(e){return e=bv(e),(e<16?"0":"")+e.toString(16)}function z7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ph(e,t,r,n)}function qJ(e){if(e instanceof Ph)return new Ph(e.h,e.s,e.l,e.opacity);if(e instanceof dS||(e=lw(e)),!e)return new Ph;if(e instanceof Ph)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),l=Math.max(t,r,n),h=NaN,i=l-a,_=(l+a)/2;return i?(t===l?h=(r-n)/i+(r<n)*6:r===l?h=(n-t)/i+2:h=(t-r)/i+4,i/=_<.5?l+a:2-l-a,h*=60):i=_>0&&_<1?0:h,new Ph(h,i,_,e.opacity)}function tPe(e,t,r,n){return arguments.length===1?qJ(e):new Ph(e,t,r,n??1)}function Ph(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}wL(Ph,tPe,$J(dS,{brighter(e){return e=e==null?dT:Math.pow(dT,e),new Ph(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ow:Math.pow(ow,e),new Ph(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Ic(Pk(e>=240?e-240:e+120,a,n),Pk(e,a,n),Pk(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ph(F7(this.h),$2(this.s),$2(this.l),hT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=hT(this.opacity);return`${e===1?"hsl(":"hsla("}${F7(this.h)}, ${$2(this.s)*100}%, ${$2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function F7(e){return e=(e||0)%360,e<0?e+360:e}function $2(e){return Math.max(0,Math.min(1,e||0))}function Pk(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const SL=e=>()=>e;function rPe(e,t){return function(r){return e+r*t}}function nPe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function iPe(e){return(e=+e)==1?GJ:function(t,r){return r-t?nPe(t,r,e):SL(isNaN(t)?r:t)}}function GJ(e,t){var r=t-e;return r?rPe(e,r):SL(isNaN(e)?t:e)}const B7=function e(t){var r=iPe(t);function n(a,l){var h=r((a=tI(a)).r,(l=tI(l)).r),i=r(a.g,l.g),_=r(a.b,l.b),w=GJ(a.opacity,l.opacity);return function(A){return a.r=h(A),a.g=i(A),a.b=_(A),a.opacity=w(A),a+""}}return n.gamma=e,n}(1);function aPe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(l){for(a=0;a<r;++a)n[a]=e[a]*(1-l)+t[a]*l;return n}}function oPe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sPe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),l=new Array(r),h;for(h=0;h<n;++h)a[h]=C0(e[h],t[h]);for(;h<r;++h)l[h]=t[h];return function(i){for(h=0;h<n;++h)l[h]=a[h](i);return l}}function lPe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function fT(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function cPe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=C0(e[a],t[a]):n[a]=t[a];return function(l){for(a in r)n[a]=r[a](l);return n}}var rI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ek=new RegExp(rI.source,"g");function uPe(e){return function(){return e}}function dPe(e){return function(t){return e(t)+""}}function hPe(e,t){var r=rI.lastIndex=Ek.lastIndex=0,n,a,l,h=-1,i=[],_=[];for(e=e+"",t=t+"";(n=rI.exec(e))&&(a=Ek.exec(t));)(l=a.index)>r&&(l=t.slice(r,l),i[h]?i[h]+=l:i[++h]=l),(n=n[0])===(a=a[0])?i[h]?i[h]+=a:i[++h]=a:(i[++h]=null,_.push({i:h,x:fT(n,a)})),r=Ek.lastIndex;return r<t.length&&(l=t.slice(r),i[h]?i[h]+=l:i[++h]=l),i.length<2?_[0]?dPe(_[0].x):uPe(t):(t=_.length,function(w){for(var A=0,C;A<t;++A)i[(C=_[A]).i]=C.x(w);return i.join("")})}function C0(e,t){var r=typeof t,n;return t==null||r==="boolean"?SL(t):(r==="number"?fT:r==="string"?(n=lw(t))?(t=n,B7):hPe:t instanceof lw?B7:t instanceof Date?lPe:oPe(t)?aPe:Array.isArray(t)?sPe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?cPe:fT)(e,t)}function AL(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function fPe(e,t){t===void 0&&(t=e,e=C0);for(var r=0,n=t.length-1,a=t[0],l=new Array(n<0?0:n);r<n;)l[r]=e(a,a=t[++r]);return function(h){var i=Math.max(0,Math.min(n-1,Math.floor(h*=n)));return l[i](h-i)}}function pPe(e){return function(){return e}}function pT(e){return+e}var V7=[0,1];function lc(e){return e}function nI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:pPe(isNaN(t)?NaN:.5)}function mPe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function gPe(e,t,r){var n=e[0],a=e[1],l=t[0],h=t[1];return a<n?(n=nI(a,n),l=r(h,l)):(n=nI(n,a),l=r(l,h)),function(i){return l(n(i))}}function yPe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),l=new Array(n),h=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++h<n;)a[h]=nI(e[h],e[h+1]),l[h]=r(t[h],t[h+1]);return function(i){var _=uS(e,i,1,n)-1;return l[_](a[_](i))}}function hS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ZP(){var e=V7,t=V7,r=C0,n,a,l,h=lc,i,_,w;function A(){var R=Math.min(e.length,t.length);return h!==lc&&(h=mPe(e[0],e[R-1])),i=R>2?yPe:gPe,_=w=null,C}function C(R){return R==null||isNaN(R=+R)?l:(_||(_=i(e.map(n),t,r)))(n(h(R)))}return C.invert=function(R){return h(a((w||(w=i(t,e.map(n),fT)))(R)))},C.domain=function(R){return arguments.length?(e=Array.from(R,pT),A()):e.slice()},C.range=function(R){return arguments.length?(t=Array.from(R),A()):t.slice()},C.rangeRound=function(R){return t=Array.from(R),r=AL,A()},C.clamp=function(R){return arguments.length?(h=R?!0:lc,A()):h!==lc},C.interpolate=function(R){return arguments.length?(r=R,A()):r},C.unknown=function(R){return arguments.length?(l=R,C):l},function(R,z){return n=R,a=z,A()}}function TL(){return ZP()(lc,lc)}function vPe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function mT(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Rx(e){return e=mT(Math.abs(e)),e?e[1]:NaN}function _Pe(e,t){return function(r,n){for(var a=r.length,l=[],h=0,i=e[0],_=0;a>0&&i>0&&(_+i+1>n&&(i=Math.max(1,n-_)),l.push(r.substring(a-=i,a+i)),!((_+=i+1)>n));)i=e[h=(h+1)%e.length];return l.reverse().join(t)}}function xPe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var bPe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function cw(e){if(!(t=bPe.exec(e)))throw new Error("invalid format: "+e);var t;return new PL({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}cw.prototype=PL.prototype;function PL(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}PL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function wPe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var KJ;function SPe(e,t){var r=mT(e,t);if(!r)return e+"";var n=r[0],a=r[1],l=a-(KJ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,h=n.length;return l===h?n:l>h?n+new Array(l-h+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+mT(e,Math.max(0,t+l-1))[0]}function U7(e,t){var r=mT(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const $7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:vPe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>U7(e*100,t),r:U7,s:SPe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function q7(e){return e}var G7=Array.prototype.map,K7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function APe(e){var t=e.grouping===void 0||e.thousands===void 0?q7:_Pe(G7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?q7:xPe(G7.call(e.numerals,String)),h=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",_=e.nan===void 0?"NaN":e.nan+"";function w(C){C=cw(C);var R=C.fill,z=C.align,V=C.sign,U=C.symbol,G=C.zero,H=C.width,J=C.comma,Q=C.precision,le=C.trim,ne=C.type;ne==="n"?(J=!0,ne="g"):$7[ne]||(Q===void 0&&(Q=12),le=!0,ne="g"),(G||R==="0"&&z==="=")&&(G=!0,R="0",z="=");var de=U==="$"?r:U==="#"&&/[boxX]/.test(ne)?"0"+ne.toLowerCase():"",ue=U==="$"?n:/[%p]/.test(ne)?h:"",ve=$7[ne],Ae=/[defgprs%]/.test(ne);Q=Q===void 0?6:/[gprs]/.test(ne)?Math.max(1,Math.min(21,Q)):Math.max(0,Math.min(20,Q));function Oe(Se){var ke=de,ze=ue,et,je,Ne;if(ne==="c")ze=ve(Se)+ze,Se="";else{Se=+Se;var Ye=Se<0||1/Se<0;if(Se=isNaN(Se)?_:ve(Math.abs(Se),Q),le&&(Se=wPe(Se)),Ye&&+Se==0&&V!=="+"&&(Ye=!1),ke=(Ye?V==="("?V:i:V==="-"||V==="("?"":V)+ke,ze=(ne==="s"?K7[8+KJ/3]:"")+ze+(Ye&&V==="("?")":""),Ae){for(et=-1,je=Se.length;++et<je;)if(Ne=Se.charCodeAt(et),48>Ne||Ne>57){ze=(Ne===46?a+Se.slice(et+1):Se.slice(et))+ze,Se=Se.slice(0,et);break}}}J&&!G&&(Se=t(Se,1/0));var $e=ke.length+Se.length+ze.length,We=$e<H?new Array(H-$e+1).join(R):"";switch(J&&G&&(Se=t(We+Se,We.length?H-ze.length:1/0),We=""),z){case"<":Se=ke+Se+ze+We;break;case"=":Se=ke+We+Se+ze;break;case"^":Se=We.slice(0,$e=We.length>>1)+ke+Se+ze+We.slice($e);break;default:Se=We+ke+Se+ze;break}return l(Se)}return Oe.toString=function(){return C+""},Oe}function A(C,R){var z=w((C=cw(C),C.type="f",C)),V=Math.max(-8,Math.min(8,Math.floor(Rx(R)/3)))*3,U=Math.pow(10,-V),G=K7[8+V/3];return function(H){return z(U*H)+G}}return{format:w,formatPrefix:A}}var q2,EL,WJ;TPe({thousands:",",grouping:[3],currency:["$",""]});function TPe(e){return q2=APe(e),EL=q2.format,WJ=q2.formatPrefix,q2}function PPe(e){return Math.max(0,-Rx(Math.abs(e)))}function EPe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Rx(t)/3)))*3-Rx(Math.abs(e)))}function CPe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Rx(t)-Rx(e))+1}function HJ(e,t,r,n){var a=QN(e,t,r),l;switch(n=cw(n??",f"),n.type){case"s":{var h=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(l=EPe(a,h))&&(n.precision=l),WJ(n,h)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=CPe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=PPe(a))&&(n.precision=l-(n.type==="%")*2);break}}return EL(n)}function Zg(e){var t=e.domain;return e.ticks=function(r){var n=t();return XN(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return HJ(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,l=n.length-1,h=n[a],i=n[l],_,w,A=10;for(i<h&&(w=h,h=i,i=w,w=a,a=l,l=w);A-- >0;){if(w=JN(h,i,r),w===_)return n[a]=h,n[l]=i,t(n);if(w>0)h=Math.floor(h/w)*w,i=Math.ceil(i/w)*w;else if(w<0)h=Math.ceil(h*w)/w,i=Math.floor(i*w)/w;else break;_=w}return e},e}function gT(){var e=TL();return e.copy=function(){return hS(e,gT())},Od.apply(e,arguments),Zg(e)}function ZJ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,pT),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return ZJ(e).unknown(t)},e=arguments.length?Array.from(e,pT):[0,1],Zg(r)}function YJ(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],l=e[n],h;return l<a&&(h=r,r=n,n=h,h=a,a=l,l=h),e[r]=t.floor(a),e[n]=t.ceil(l),e}function W7(e){return Math.log(e)}function H7(e){return Math.exp(e)}function MPe(e){return-Math.log(-e)}function OPe(e){return-Math.exp(-e)}function RPe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function kPe(e){return e===10?RPe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function jPe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Z7(e){return(t,r)=>-e(-t,r)}function CL(e){const t=e(W7,H7),r=t.domain;let n=10,a,l;function h(){return a=jPe(n),l=kPe(n),r()[0]<0?(a=Z7(a),l=Z7(l),e(MPe,OPe)):e(W7,H7),t}return t.base=function(i){return arguments.length?(n=+i,h()):n},t.domain=function(i){return arguments.length?(r(i),h()):r()},t.ticks=i=>{const _=r();let w=_[0],A=_[_.length-1];const C=A<w;C&&([w,A]=[A,w]);let R=a(w),z=a(A),V,U;const G=i==null?10:+i;let H=[];if(!(n%1)&&z-R<G){if(R=Math.floor(R),z=Math.ceil(z),w>0){for(;R<=z;++R)for(V=1;V<n;++V)if(U=R<0?V/l(-R):V*l(R),!(U<w)){if(U>A)break;H.push(U)}}else for(;R<=z;++R)for(V=n-1;V>=1;--V)if(U=R>0?V/l(-R):V*l(R),!(U<w)){if(U>A)break;H.push(U)}H.length*2<G&&(H=XN(w,A,G))}else H=XN(R,z,Math.min(z-R,G)).map(l);return C?H.reverse():H},t.tickFormat=(i,_)=>{if(i==null&&(i=10),_==null&&(_=n===10?"s":","),typeof _!="function"&&(!(n%1)&&(_=cw(_)).precision==null&&(_.trim=!0),_=EL(_)),i===1/0)return _;const w=Math.max(1,n*i/t.ticks().length);return A=>{let C=A/l(Math.round(a(A)));return C*n<n-.5&&(C*=n),C<=w?_(A):""}},t.nice=()=>r(YJ(r(),{floor:i=>l(Math.floor(a(i))),ceil:i=>l(Math.ceil(a(i)))})),t}function XJ(){const e=CL(ZP()).domain([1,10]);return e.copy=()=>hS(e,XJ()).base(e.base()),Od.apply(e,arguments),e}function Y7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function X7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ML(e){var t=1,r=e(Y7(t),X7(t));return r.constant=function(n){return arguments.length?e(Y7(t=+n),X7(t)):t},Zg(r)}function JJ(){var e=ML(ZP());return e.copy=function(){return hS(e,JJ()).constant(e.constant())},Od.apply(e,arguments)}function J7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function NPe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function IPe(e){return e<0?-e*e:e*e}function OL(e){var t=e(lc,lc),r=1;function n(){return r===1?e(lc,lc):r===.5?e(NPe,IPe):e(J7(r),J7(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Zg(t)}function RL(){var e=OL(ZP());return e.copy=function(){return hS(e,RL()).exponent(e.exponent())},Od.apply(e,arguments),e}function DPe(){return RL.apply(null,arguments).exponent(.5)}function Q7(e){return Math.sign(e)*e*e}function LPe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function QJ(){var e=TL(),t=[0,1],r=!1,n;function a(l){var h=LPe(e(l));return isNaN(h)?n:r?Math.round(h):h}return a.invert=function(l){return e.invert(Q7(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,pT)).map(Q7)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(r=!!l,a):r},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return QJ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Od.apply(a,arguments),Zg(a)}function eQ(){var e=[],t=[],r=[],n;function a(){var h=0,i=Math.max(1,t.length);for(r=new Array(i-1);++h<i;)r[h-1]=UTe(e,h/i);return l}function l(h){return h==null||isNaN(h=+h)?n:t[uS(r,h)]}return l.invertExtent=function(h){var i=t.indexOf(h);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},l.domain=function(h){if(!arguments.length)return e.slice();e=[];for(let i of h)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Og),a()},l.range=function(h){return arguments.length?(t=Array.from(h),a()):t.slice()},l.unknown=function(h){return arguments.length?(n=h,l):n},l.quantiles=function(){return r.slice()},l.copy=function(){return eQ().domain(e).range(t).unknown(n)},Od.apply(l,arguments)}function tQ(){var e=0,t=1,r=1,n=[.5],a=[0,1],l;function h(_){return _!=null&&_<=_?a[uS(n,_,0,r)]:l}function i(){var _=-1;for(n=new Array(r);++_<r;)n[_]=((_+1)*t-(_-r)*e)/(r+1);return h}return h.domain=function(_){return arguments.length?([e,t]=_,e=+e,t=+t,i()):[e,t]},h.range=function(_){return arguments.length?(r=(a=Array.from(_)).length-1,i()):a.slice()},h.invertExtent=function(_){var w=a.indexOf(_);return w<0?[NaN,NaN]:w<1?[e,n[0]]:w>=r?[n[r-1],t]:[n[w-1],n[w]]},h.unknown=function(_){return arguments.length&&(l=_),h},h.thresholds=function(){return n.slice()},h.copy=function(){return tQ().domain([e,t]).range(a).unknown(l)},Od.apply(Zg(h),arguments)}function rQ(){var e=[.5],t=[0,1],r,n=1;function a(l){return l!=null&&l<=l?t[uS(e,l,0,n)]:r}return a.domain=function(l){return arguments.length?(e=Array.from(l),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var h=t.indexOf(l);return[e[h-1],e[h]]},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return rQ().domain(e).range(t).unknown(r)},Od.apply(a,arguments)}const Ck=new Date,Mk=new Date;function Is(e,t,r,n){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const h=a(l),i=a.ceil(l);return l-h<i-l?h:i},a.offset=(l,h)=>(t(l=new Date(+l),h==null?1:Math.floor(h)),l),a.range=(l,h,i)=>{const _=[];if(l=a.ceil(l),i=i==null?1:Math.floor(i),!(l<h)||!(i>0))return _;let w;do _.push(w=new Date(+l)),t(l,i),e(l);while(w<l&&l<h);return _},a.filter=l=>Is(h=>{if(h>=h)for(;e(h),!l(h);)h.setTime(h-1)},(h,i)=>{if(h>=h)if(i<0)for(;++i<=0;)for(;t(h,-1),!l(h););else for(;--i>=0;)for(;t(h,1),!l(h););}),r&&(a.count=(l,h)=>(Ck.setTime(+l),Mk.setTime(+h),e(Ck),e(Mk),Math.floor(r(Ck,Mk))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(n?h=>n(h)%l===0:h=>a.count(0,h)%l===0):a)),a}const yT=Is(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);yT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Is(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):yT);yT.range;const Qp=1e3,wd=Qp*60,em=wd*60,fm=em*24,kL=fm*7,eq=fm*30,Ok=fm*365,mv=Is(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Qp)},(e,t)=>(t-e)/Qp,e=>e.getUTCSeconds());mv.range;const jL=Is(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Qp)},(e,t)=>{e.setTime(+e+t*wd)},(e,t)=>(t-e)/wd,e=>e.getMinutes());jL.range;const NL=Is(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*wd)},(e,t)=>(t-e)/wd,e=>e.getUTCMinutes());NL.range;const IL=Is(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Qp-e.getMinutes()*wd)},(e,t)=>{e.setTime(+e+t*em)},(e,t)=>(t-e)/em,e=>e.getHours());IL.range;const DL=Is(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*em)},(e,t)=>(t-e)/em,e=>e.getUTCHours());DL.range;const fS=Is(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*wd)/fm,e=>e.getDate()-1);fS.range;const YP=Is(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/fm,e=>e.getUTCDate()-1);YP.range;const nQ=Is(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/fm,e=>Math.floor(e/fm));nQ.range;function Zv(e){return Is(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*wd)/kL)}const XP=Zv(0),vT=Zv(1),zPe=Zv(2),FPe=Zv(3),kx=Zv(4),BPe=Zv(5),VPe=Zv(6);XP.range;vT.range;zPe.range;FPe.range;kx.range;BPe.range;VPe.range;function Yv(e){return Is(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/kL)}const JP=Yv(0),_T=Yv(1),UPe=Yv(2),$Pe=Yv(3),jx=Yv(4),qPe=Yv(5),GPe=Yv(6);JP.range;_T.range;UPe.range;$Pe.range;jx.range;qPe.range;GPe.range;const LL=Is(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());LL.range;const zL=Is(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());zL.range;const pm=Is(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());pm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Is(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});pm.range;const mm=Is(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());mm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Is(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});mm.range;function iQ(e,t,r,n,a,l){const h=[[mv,1,Qp],[mv,5,5*Qp],[mv,15,15*Qp],[mv,30,30*Qp],[l,1,wd],[l,5,5*wd],[l,15,15*wd],[l,30,30*wd],[a,1,em],[a,3,3*em],[a,6,6*em],[a,12,12*em],[n,1,fm],[n,2,2*fm],[r,1,kL],[t,1,eq],[t,3,3*eq],[e,1,Ok]];function i(w,A,C){const R=A<w;R&&([w,A]=[A,w]);const z=C&&typeof C.range=="function"?C:_(w,A,C),V=z?z.range(w,+A+1):[];return R?V.reverse():V}function _(w,A,C){const R=Math.abs(A-w)/C,z=xL(([,,G])=>G).right(h,R);if(z===h.length)return e.every(QN(w/Ok,A/Ok,C));if(z===0)return yT.every(Math.max(QN(w,A,C),1));const[V,U]=h[R/h[z-1][2]<h[z][2]/R?z-1:z];return V.every(U)}return[i,_]}const[KPe,WPe]=iQ(mm,zL,JP,nQ,DL,NL),[HPe,ZPe]=iQ(pm,LL,XP,fS,IL,jL);function Rk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kk(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Fb(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function YPe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,l=e.days,h=e.shortDays,i=e.months,_=e.shortMonths,w=Bb(a),A=Vb(a),C=Bb(l),R=Vb(l),z=Bb(h),V=Vb(h),U=Bb(i),G=Vb(i),H=Bb(_),J=Vb(_),Q={a:Ye,A:$e,b:We,B:Et,c:null,d:oq,e:oq,f:_Ee,g:MEe,G:REe,H:gEe,I:yEe,j:vEe,L:aQ,m:xEe,M:bEe,p:Je,q:ht,Q:cq,s:uq,S:wEe,u:SEe,U:AEe,V:TEe,w:PEe,W:EEe,x:null,X:null,y:CEe,Y:OEe,Z:kEe,"%":lq},le={a:tt,A:Qt,b:gr,B:sr,c:null,d:sq,e:sq,f:DEe,g:KEe,G:HEe,H:jEe,I:NEe,j:IEe,L:sQ,m:LEe,M:zEe,p:ur,q:br,Q:cq,s:uq,S:FEe,u:BEe,U:VEe,V:UEe,w:$Ee,W:qEe,x:null,X:null,y:GEe,Y:WEe,Z:ZEe,"%":lq},ne={a:Oe,A:Se,b:ke,B:ze,c:et,d:iq,e:iq,f:hEe,g:nq,G:rq,H:aq,I:aq,j:lEe,L:dEe,m:sEe,M:cEe,p:Ae,q:oEe,Q:pEe,s:mEe,S:uEe,u:tEe,U:rEe,V:nEe,w:eEe,W:iEe,x:je,X:Ne,y:nq,Y:rq,Z:aEe,"%":fEe};Q.x=de(r,Q),Q.X=de(n,Q),Q.c=de(t,Q),le.x=de(r,le),le.X=de(n,le),le.c=de(t,le);function de(Wt,Be){return function(Nr){var Jt=[],Sn=-1,It=0,Vn=Wt.length,Un,Xr,rt;for(Nr instanceof Date||(Nr=new Date(+Nr));++Sn<Vn;)Wt.charCodeAt(Sn)===37&&(Jt.push(Wt.slice(It,Sn)),(Xr=tq[Un=Wt.charAt(++Sn)])!=null?Un=Wt.charAt(++Sn):Xr=Un==="e"?" ":"0",(rt=Be[Un])&&(Un=rt(Nr,Xr)),Jt.push(Un),It=Sn+1);return Jt.push(Wt.slice(It,Sn)),Jt.join("")}}function ue(Wt,Be){return function(Nr){var Jt=Fb(1900,void 0,1),Sn=ve(Jt,Wt,Nr+="",0),It,Vn;if(Sn!=Nr.length)return null;if("Q"in Jt)return new Date(Jt.Q);if("s"in Jt)return new Date(Jt.s*1e3+("L"in Jt?Jt.L:0));if(Be&&!("Z"in Jt)&&(Jt.Z=0),"p"in Jt&&(Jt.H=Jt.H%12+Jt.p*12),Jt.m===void 0&&(Jt.m="q"in Jt?Jt.q:0),"V"in Jt){if(Jt.V<1||Jt.V>53)return null;"w"in Jt||(Jt.w=1),"Z"in Jt?(It=kk(Fb(Jt.y,0,1)),Vn=It.getUTCDay(),It=Vn>4||Vn===0?_T.ceil(It):_T(It),It=YP.offset(It,(Jt.V-1)*7),Jt.y=It.getUTCFullYear(),Jt.m=It.getUTCMonth(),Jt.d=It.getUTCDate()+(Jt.w+6)%7):(It=Rk(Fb(Jt.y,0,1)),Vn=It.getDay(),It=Vn>4||Vn===0?vT.ceil(It):vT(It),It=fS.offset(It,(Jt.V-1)*7),Jt.y=It.getFullYear(),Jt.m=It.getMonth(),Jt.d=It.getDate()+(Jt.w+6)%7)}else("W"in Jt||"U"in Jt)&&("w"in Jt||(Jt.w="u"in Jt?Jt.u%7:"W"in Jt?1:0),Vn="Z"in Jt?kk(Fb(Jt.y,0,1)).getUTCDay():Rk(Fb(Jt.y,0,1)).getDay(),Jt.m=0,Jt.d="W"in Jt?(Jt.w+6)%7+Jt.W*7-(Vn+5)%7:Jt.w+Jt.U*7-(Vn+6)%7);return"Z"in Jt?(Jt.H+=Jt.Z/100|0,Jt.M+=Jt.Z%100,kk(Jt)):Rk(Jt)}}function ve(Wt,Be,Nr,Jt){for(var Sn=0,It=Be.length,Vn=Nr.length,Un,Xr;Sn<It;){if(Jt>=Vn)return-1;if(Un=Be.charCodeAt(Sn++),Un===37){if(Un=Be.charAt(Sn++),Xr=ne[Un in tq?Be.charAt(Sn++):Un],!Xr||(Jt=Xr(Wt,Nr,Jt))<0)return-1}else if(Un!=Nr.charCodeAt(Jt++))return-1}return Jt}function Ae(Wt,Be,Nr){var Jt=w.exec(Be.slice(Nr));return Jt?(Wt.p=A.get(Jt[0].toLowerCase()),Nr+Jt[0].length):-1}function Oe(Wt,Be,Nr){var Jt=z.exec(Be.slice(Nr));return Jt?(Wt.w=V.get(Jt[0].toLowerCase()),Nr+Jt[0].length):-1}function Se(Wt,Be,Nr){var Jt=C.exec(Be.slice(Nr));return Jt?(Wt.w=R.get(Jt[0].toLowerCase()),Nr+Jt[0].length):-1}function ke(Wt,Be,Nr){var Jt=H.exec(Be.slice(Nr));return Jt?(Wt.m=J.get(Jt[0].toLowerCase()),Nr+Jt[0].length):-1}function ze(Wt,Be,Nr){var Jt=U.exec(Be.slice(Nr));return Jt?(Wt.m=G.get(Jt[0].toLowerCase()),Nr+Jt[0].length):-1}function et(Wt,Be,Nr){return ve(Wt,t,Be,Nr)}function je(Wt,Be,Nr){return ve(Wt,r,Be,Nr)}function Ne(Wt,Be,Nr){return ve(Wt,n,Be,Nr)}function Ye(Wt){return h[Wt.getDay()]}function $e(Wt){return l[Wt.getDay()]}function We(Wt){return _[Wt.getMonth()]}function Et(Wt){return i[Wt.getMonth()]}function Je(Wt){return a[+(Wt.getHours()>=12)]}function ht(Wt){return 1+~~(Wt.getMonth()/3)}function tt(Wt){return h[Wt.getUTCDay()]}function Qt(Wt){return l[Wt.getUTCDay()]}function gr(Wt){return _[Wt.getUTCMonth()]}function sr(Wt){return i[Wt.getUTCMonth()]}function ur(Wt){return a[+(Wt.getUTCHours()>=12)]}function br(Wt){return 1+~~(Wt.getUTCMonth()/3)}return{format:function(Wt){var Be=de(Wt+="",Q);return Be.toString=function(){return Wt},Be},parse:function(Wt){var Be=ue(Wt+="",!1);return Be.toString=function(){return Wt},Be},utcFormat:function(Wt){var Be=de(Wt+="",le);return Be.toString=function(){return Wt},Be},utcParse:function(Wt){var Be=ue(Wt+="",!0);return Be.toString=function(){return Wt},Be}}}var tq={"-":"",_:" ",0:"0"},nl=/^\s*\d+/,XPe=/^%/,JPe=/[\\^$*+?|[\]().{}]/g;function la(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",l=a.length;return n+(l<r?new Array(r-l+1).join(t)+a:a)}function QPe(e){return e.replace(JPe,"\\$&")}function Bb(e){return new RegExp("^(?:"+e.map(QPe).join("|")+")","i")}function Vb(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function eEe(e,t,r){var n=nl.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function tEe(e,t,r){var n=nl.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function rEe(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function nEe(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function iEe(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function rq(e,t,r){var n=nl.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function nq(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function aEe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function oEe(e,t,r){var n=nl.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function sEe(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function iq(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function lEe(e,t,r){var n=nl.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function aq(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function cEe(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function uEe(e,t,r){var n=nl.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function dEe(e,t,r){var n=nl.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function hEe(e,t,r){var n=nl.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function fEe(e,t,r){var n=XPe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function pEe(e,t,r){var n=nl.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function mEe(e,t,r){var n=nl.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function oq(e,t){return la(e.getDate(),t,2)}function gEe(e,t){return la(e.getHours(),t,2)}function yEe(e,t){return la(e.getHours()%12||12,t,2)}function vEe(e,t){return la(1+fS.count(pm(e),e),t,3)}function aQ(e,t){return la(e.getMilliseconds(),t,3)}function _Ee(e,t){return aQ(e,t)+"000"}function xEe(e,t){return la(e.getMonth()+1,t,2)}function bEe(e,t){return la(e.getMinutes(),t,2)}function wEe(e,t){return la(e.getSeconds(),t,2)}function SEe(e){var t=e.getDay();return t===0?7:t}function AEe(e,t){return la(XP.count(pm(e)-1,e),t,2)}function oQ(e){var t=e.getDay();return t>=4||t===0?kx(e):kx.ceil(e)}function TEe(e,t){return e=oQ(e),la(kx.count(pm(e),e)+(pm(e).getDay()===4),t,2)}function PEe(e){return e.getDay()}function EEe(e,t){return la(vT.count(pm(e)-1,e),t,2)}function CEe(e,t){return la(e.getFullYear()%100,t,2)}function MEe(e,t){return e=oQ(e),la(e.getFullYear()%100,t,2)}function OEe(e,t){return la(e.getFullYear()%1e4,t,4)}function REe(e,t){var r=e.getDay();return e=r>=4||r===0?kx(e):kx.ceil(e),la(e.getFullYear()%1e4,t,4)}function kEe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+la(t/60|0,"0",2)+la(t%60,"0",2)}function sq(e,t){return la(e.getUTCDate(),t,2)}function jEe(e,t){return la(e.getUTCHours(),t,2)}function NEe(e,t){return la(e.getUTCHours()%12||12,t,2)}function IEe(e,t){return la(1+YP.count(mm(e),e),t,3)}function sQ(e,t){return la(e.getUTCMilliseconds(),t,3)}function DEe(e,t){return sQ(e,t)+"000"}function LEe(e,t){return la(e.getUTCMonth()+1,t,2)}function zEe(e,t){return la(e.getUTCMinutes(),t,2)}function FEe(e,t){return la(e.getUTCSeconds(),t,2)}function BEe(e){var t=e.getUTCDay();return t===0?7:t}function VEe(e,t){return la(JP.count(mm(e)-1,e),t,2)}function lQ(e){var t=e.getUTCDay();return t>=4||t===0?jx(e):jx.ceil(e)}function UEe(e,t){return e=lQ(e),la(jx.count(mm(e),e)+(mm(e).getUTCDay()===4),t,2)}function $Ee(e){return e.getUTCDay()}function qEe(e,t){return la(_T.count(mm(e)-1,e),t,2)}function GEe(e,t){return la(e.getUTCFullYear()%100,t,2)}function KEe(e,t){return e=lQ(e),la(e.getUTCFullYear()%100,t,2)}function WEe(e,t){return la(e.getUTCFullYear()%1e4,t,4)}function HEe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?jx(e):jx.ceil(e),la(e.getUTCFullYear()%1e4,t,4)}function ZEe(){return"+0000"}function lq(){return"%"}function cq(e){return+e}function uq(e){return Math.floor(+e/1e3)}var W_,cQ,uQ;YEe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function YEe(e){return W_=YPe(e),cQ=W_.format,W_.parse,uQ=W_.utcFormat,W_.utcParse,W_}function XEe(e){return new Date(e)}function JEe(e){return e instanceof Date?+e:+new Date(+e)}function FL(e,t,r,n,a,l,h,i,_,w){var A=TL(),C=A.invert,R=A.domain,z=w(".%L"),V=w(":%S"),U=w("%I:%M"),G=w("%I %p"),H=w("%a %d"),J=w("%b %d"),Q=w("%B"),le=w("%Y");function ne(de){return(_(de)<de?z:i(de)<de?V:h(de)<de?U:l(de)<de?G:n(de)<de?a(de)<de?H:J:r(de)<de?Q:le)(de)}return A.invert=function(de){return new Date(C(de))},A.domain=function(de){return arguments.length?R(Array.from(de,JEe)):R().map(XEe)},A.ticks=function(de){var ue=R();return e(ue[0],ue[ue.length-1],de??10)},A.tickFormat=function(de,ue){return ue==null?ne:w(ue)},A.nice=function(de){var ue=R();return(!de||typeof de.range!="function")&&(de=t(ue[0],ue[ue.length-1],de??10)),de?R(YJ(ue,de)):A},A.copy=function(){return hS(A,FL(e,t,r,n,a,l,h,i,_,w))},A}function QEe(){return Od.apply(FL(HPe,ZPe,pm,LL,XP,fS,IL,jL,mv,cQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eCe(){return Od.apply(FL(KPe,WPe,mm,zL,JP,YP,DL,NL,mv,uQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function QP(){var e=0,t=1,r,n,a,l,h=lc,i=!1,_;function w(C){return C==null||isNaN(C=+C)?_:h(a===0?.5:(C=(l(C)-r)*a,i?Math.max(0,Math.min(1,C)):C))}w.domain=function(C){return arguments.length?([e,t]=C,r=l(e=+e),n=l(t=+t),a=r===n?0:1/(n-r),w):[e,t]},w.clamp=function(C){return arguments.length?(i=!!C,w):i},w.interpolator=function(C){return arguments.length?(h=C,w):h};function A(C){return function(R){var z,V;return arguments.length?([z,V]=R,h=C(z,V),w):[h(0),h(1)]}}return w.range=A(C0),w.rangeRound=A(AL),w.unknown=function(C){return arguments.length?(_=C,w):_},function(C){return l=C,r=C(e),n=C(t),a=r===n?0:1/(n-r),w}}function Yg(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function dQ(){var e=Zg(QP()(lc));return e.copy=function(){return Yg(e,dQ())},_m.apply(e,arguments)}function hQ(){var e=CL(QP()).domain([1,10]);return e.copy=function(){return Yg(e,hQ()).base(e.base())},_m.apply(e,arguments)}function fQ(){var e=ML(QP());return e.copy=function(){return Yg(e,fQ()).constant(e.constant())},_m.apply(e,arguments)}function BL(){var e=OL(QP());return e.copy=function(){return Yg(e,BL()).exponent(e.exponent())},_m.apply(e,arguments)}function tCe(){return BL.apply(null,arguments).exponent(.5)}function pQ(){var e=[],t=lc;function r(n){if(n!=null&&!isNaN(n=+n))return t((uS(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Og),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,l)=>VTe(e,l/n))},r.copy=function(){return pQ(t).domain(e)},_m.apply(r,arguments)}function eE(){var e=0,t=.5,r=1,n=1,a,l,h,i,_,w=lc,A,C=!1,R;function z(U){return isNaN(U=+U)?R:(U=.5+((U=+A(U))-l)*(n*U<n*l?i:_),w(C?Math.max(0,Math.min(1,U)):U))}z.domain=function(U){return arguments.length?([e,t,r]=U,a=A(e=+e),l=A(t=+t),h=A(r=+r),i=a===l?0:.5/(l-a),_=l===h?0:.5/(h-l),n=l<a?-1:1,z):[e,t,r]},z.clamp=function(U){return arguments.length?(C=!!U,z):C},z.interpolator=function(U){return arguments.length?(w=U,z):w};function V(U){return function(G){var H,J,Q;return arguments.length?([H,J,Q]=G,w=fPe(U,[H,J,Q]),z):[w(0),w(.5),w(1)]}}return z.range=V(C0),z.rangeRound=V(AL),z.unknown=function(U){return arguments.length?(R=U,z):R},function(U){return A=U,a=U(e),l=U(t),h=U(r),i=a===l?0:.5/(l-a),_=l===h?0:.5/(h-l),n=l<a?-1:1,z}}function mQ(){var e=Zg(eE()(lc));return e.copy=function(){return Yg(e,mQ())},_m.apply(e,arguments)}function gQ(){var e=CL(eE()).domain([.1,1,10]);return e.copy=function(){return Yg(e,gQ()).base(e.base())},_m.apply(e,arguments)}function yQ(){var e=ML(eE());return e.copy=function(){return Yg(e,yQ()).constant(e.constant())},_m.apply(e,arguments)}function VL(){var e=OL(eE());return e.copy=function(){return Yg(e,VL()).exponent(e.exponent())},_m.apply(e,arguments)}function rCe(){return VL.apply(null,arguments).exponent(.5)}const dq=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:aw,scaleDiverging:mQ,scaleDivergingLog:gQ,scaleDivergingPow:VL,scaleDivergingSqrt:rCe,scaleDivergingSymlog:yQ,scaleIdentity:ZJ,scaleImplicit:eI,scaleLinear:gT,scaleLog:XJ,scaleOrdinal:bL,scalePoint:h1,scalePow:RL,scaleQuantile:eQ,scaleQuantize:tQ,scaleRadial:QJ,scaleSequential:dQ,scaleSequentialLog:hQ,scaleSequentialPow:BL,scaleSequentialQuantile:pQ,scaleSequentialSqrt:tCe,scaleSequentialSymlog:fQ,scaleSqrt:DPe,scaleSymlog:JJ,scaleThreshold:rQ,scaleTime:QEe,scaleUtc:eCe,tickFormat:HJ},Symbol.toStringTag,{value:"Module"}));var jk,hq;function tE(){if(hq)return jk;hq=1;var e=A0();function t(r,n,a){for(var l=-1,h=r.length;++l<h;){var i=r[l],_=n(i);if(_!=null&&(w===void 0?_===_&&!e(_):a(_,w)))var w=_,A=i}return A}return jk=t,jk}var Nk,fq;function vQ(){if(fq)return Nk;fq=1;function e(t,r){return t>r}return Nk=e,Nk}var Ik,pq;function nCe(){if(pq)return Ik;pq=1;var e=tE(),t=vQ(),r=E0();function n(a){return a&&a.length?e(a,r,t):void 0}return Ik=n,Ik}var iCe=nCe();const Pg=ta(iCe);var Dk,mq;function _Q(){if(mq)return Dk;mq=1;function e(t,r){return t<r}return Dk=e,Dk}var Lk,gq;function aCe(){if(gq)return Lk;gq=1;var e=tE(),t=_Q(),r=E0();function n(a){return a&&a.length?e(a,r,t):void 0}return Lk=n,Lk}var oCe=aCe();const rE=ta(oCe);var zk,yq;function sCe(){if(yq)return zk;yq=1;var e=iL(),t=tp(),r=EJ(),n=Uc();function a(l,h){var i=n(l)?e:r;return i(l,t(h,3))}return zk=a,zk}var Fk,vq;function lCe(){if(vq)return Fk;vq=1;var e=TJ(),t=sCe();function r(n,a){return e(t(n,a),1)}return Fk=r,Fk}var cCe=lCe();const uCe=ta(cCe);var Bk,_q;function dCe(){if(_q)return Bk;_q=1;var e=gL();function t(r,n){return e(r,n)}return Bk=t,Bk}var hCe=dCe();const Hf=ta(hCe);var M0=1e9,fCe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},$L,xo=!0,Ed="[DecimalError] ",wv=Ed+"Invalid argument: ",UL=Ed+"Exponent out of range: ",O0=Math.floor,iv=Math.pow,pCe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,vu,Js=1e7,so=7,xQ=9007199254740991,xT=O0(xQ/so),un={};un.absoluteValue=un.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};un.comparedTo=un.cmp=function(e){var t,r,n,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(n=l.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return n===a?0:n>a^l.s<0?1:-1};un.decimalPlaces=un.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*so;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};un.dividedBy=un.div=function(e){return om(this,new this.constructor(e))};un.dividedToIntegerBy=un.idiv=function(e){var t=this,r=t.constructor;return Va(om(t,new r(e),0,1),r.precision)};un.equals=un.eq=function(e){return!this.cmp(e)};un.exponent=function(){return ms(this)};un.greaterThan=un.gt=function(e){return this.cmp(e)>0};un.greaterThanOrEqualTo=un.gte=function(e){return this.cmp(e)>=0};un.isInteger=un.isint=function(){return this.e>this.d.length-2};un.isNegative=un.isneg=function(){return this.s<0};un.isPositive=un.ispos=function(){return this.s>0};un.isZero=function(){return this.s===0};un.lessThan=un.lt=function(e){return this.cmp(e)<0};un.lessThanOrEqualTo=un.lte=function(e){return this.cmp(e)<1};un.logarithm=un.log=function(e){var t,r=this,n=r.constructor,a=n.precision,l=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(vu))throw Error(Ed+"NaN");if(r.s<1)throw Error(Ed+(r.s?"NaN":"-Infinity"));return r.eq(vu)?new n(0):(xo=!1,t=om(uw(r,l),uw(e,l),l),xo=!0,Va(t,a))};un.minus=un.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?SQ(t,e):bQ(t,(e.s=-e.s,e))};un.modulo=un.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Ed+"NaN");return r.s?(xo=!1,t=om(r,e,0,1).times(e),xo=!0,r.minus(t)):Va(new n(r),a)};un.naturalExponential=un.exp=function(){return wQ(this)};un.naturalLogarithm=un.ln=function(){return uw(this)};un.negated=un.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};un.plus=un.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?bQ(t,e):SQ(t,(e.s=-e.s,e))};un.precision=un.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(wv+e);if(t=ms(a)+1,n=a.d.length-1,r=n*so+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};un.squareRoot=un.sqrt=function(){var e,t,r,n,a,l,h,i=this,_=i.constructor;if(i.s<1){if(!i.s)return new _(0);throw Error(Ed+"NaN")}for(e=ms(i),xo=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=If(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=O0((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new _(t)):n=new _(a.toString()),r=_.precision,a=h=r+3;;)if(l=n,n=l.plus(om(i,l,h+2)).times(.5),If(l.d).slice(0,h)===(t=If(n.d)).slice(0,h)){if(t=t.slice(h-3,h+1),a==h&&t=="4999"){if(Va(l,r+1,0),l.times(l).eq(i)){n=l;break}}else if(t!="9999")break;h+=4}return xo=!0,Va(n,r)};un.times=un.mul=function(e){var t,r,n,a,l,h,i,_,w,A=this,C=A.constructor,R=A.d,z=(e=new C(e)).d;if(!A.s||!e.s)return new C(0);for(e.s*=A.s,r=A.e+e.e,_=R.length,w=z.length,_<w&&(l=R,R=z,z=l,h=_,_=w,w=h),l=[],h=_+w,n=h;n--;)l.push(0);for(n=w;--n>=0;){for(t=0,a=_+n;a>n;)i=l[a]+z[n]*R[a-n-1]+t,l[a--]=i%Js|0,t=i/Js|0;l[a]=(l[a]+t)%Js|0}for(;!l[--h];)l.pop();return t?++r:l.shift(),e.d=l,e.e=r,xo?Va(e,C.precision):e};un.toDecimalPlaces=un.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Zf(e,0,M0),t===void 0?t=n.rounding:Zf(t,0,8),Va(r,e+ms(r)+1,t))};un.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=kv(n,!0):(Zf(e,0,M0),t===void 0?t=a.rounding:Zf(t,0,8),n=Va(new a(n),e+1,t),r=kv(n,!0,e+1)),r};un.toFixed=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?kv(a):(Zf(e,0,M0),t===void 0?t=l.rounding:Zf(t,0,8),n=Va(new l(a),e+ms(a)+1,t),r=kv(n.abs(),!1,e+ms(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};un.toInteger=un.toint=function(){var e=this,t=e.constructor;return Va(new t(e),ms(e)+1,t.rounding)};un.toNumber=function(){return+this};un.toPower=un.pow=function(e){var t,r,n,a,l,h,i=this,_=i.constructor,w=12,A=+(e=new _(e));if(!e.s)return new _(vu);if(i=new _(i),!i.s){if(e.s<1)throw Error(Ed+"Infinity");return i}if(i.eq(vu))return i;if(n=_.precision,e.eq(vu))return Va(i,n);if(t=e.e,r=e.d.length-1,h=t>=r,l=i.s,h){if((r=A<0?-A:A)<=xQ){for(a=new _(vu),t=Math.ceil(n/so+4),xo=!1;r%2&&(a=a.times(i),bq(a.d,t)),r=O0(r/2),r!==0;)i=i.times(i),bq(i.d,t);return xo=!0,e.s<0?new _(vu).div(a):Va(a,n)}}else if(l<0)throw Error(Ed+"NaN");return l=l<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,xo=!1,a=e.times(uw(i,n+w)),xo=!0,a=wQ(a),a.s=l,a};un.toPrecision=function(e,t){var r,n,a=this,l=a.constructor;return e===void 0?(r=ms(a),n=kv(a,r<=l.toExpNeg||r>=l.toExpPos)):(Zf(e,1,M0),t===void 0?t=l.rounding:Zf(t,0,8),a=Va(new l(a),e,t),r=ms(a),n=kv(a,e<=r||r<=l.toExpNeg,e)),n};un.toSignificantDigits=un.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Zf(e,1,M0),t===void 0?t=n.rounding:Zf(t,0,8)),Va(new n(r),e,t)};un.toString=un.valueOf=un.val=un.toJSON=un[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ms(e),r=e.constructor;return kv(e,t<=r.toExpNeg||t>=r.toExpPos)};function bQ(e,t){var r,n,a,l,h,i,_,w,A=e.constructor,C=A.precision;if(!e.s||!t.s)return t.s||(t=new A(e)),xo?Va(t,C):t;if(_=e.d,w=t.d,h=e.e,a=t.e,_=_.slice(),l=h-a,l){for(l<0?(n=_,l=-l,i=w.length):(n=w,a=h,i=_.length),h=Math.ceil(C/so),i=h>i?h+1:i+1,l>i&&(l=i,n.length=1),n.reverse();l--;)n.push(0);n.reverse()}for(i=_.length,l=w.length,i-l<0&&(l=i,n=w,w=_,_=n),r=0;l;)r=(_[--l]=_[l]+w[l]+r)/Js|0,_[l]%=Js;for(r&&(_.unshift(r),++a),i=_.length;_[--i]==0;)_.pop();return t.d=_,t.e=a,xo?Va(t,C):t}function Zf(e,t,r){if(e!==~~e||e<t||e>r)throw Error(wv+e)}function If(e){var t,r,n,a=e.length-1,l="",h=e[0];if(a>0){for(l+=h,t=1;t<a;t++)n=e[t]+"",r=so-n.length,r&&(l+=Sg(r)),l+=n;h=e[t],n=h+"",r=so-n.length,r&&(l+=Sg(r))}else if(h===0)return"0";for(;h%10===0;)h/=10;return l+h}var om=function(){function e(n,a){var l,h=0,i=n.length;for(n=n.slice();i--;)l=n[i]*a+h,n[i]=l%Js|0,h=l/Js|0;return h&&n.unshift(h),n}function t(n,a,l,h){var i,_;if(l!=h)_=l>h?1:-1;else for(i=_=0;i<l;i++)if(n[i]!=a[i]){_=n[i]>a[i]?1:-1;break}return _}function r(n,a,l){for(var h=0;l--;)n[l]-=h,h=n[l]<a[l]?1:0,n[l]=h*Js+n[l]-a[l];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,l,h){var i,_,w,A,C,R,z,V,U,G,H,J,Q,le,ne,de,ue,ve,Ae=n.constructor,Oe=n.s==a.s?1:-1,Se=n.d,ke=a.d;if(!n.s)return new Ae(n);if(!a.s)throw Error(Ed+"Division by zero");for(_=n.e-a.e,ue=ke.length,ne=Se.length,z=new Ae(Oe),V=z.d=[],w=0;ke[w]==(Se[w]||0);)++w;if(ke[w]>(Se[w]||0)&&--_,l==null?J=l=Ae.precision:h?J=l+(ms(n)-ms(a))+1:J=l,J<0)return new Ae(0);if(J=J/so+2|0,w=0,ue==1)for(A=0,ke=ke[0],J++;(w<ne||A)&&J--;w++)Q=A*Js+(Se[w]||0),V[w]=Q/ke|0,A=Q%ke|0;else{for(A=Js/(ke[0]+1)|0,A>1&&(ke=e(ke,A),Se=e(Se,A),ue=ke.length,ne=Se.length),le=ue,U=Se.slice(0,ue),G=U.length;G<ue;)U[G++]=0;ve=ke.slice(),ve.unshift(0),de=ke[0],ke[1]>=Js/2&&++de;do A=0,i=t(ke,U,ue,G),i<0?(H=U[0],ue!=G&&(H=H*Js+(U[1]||0)),A=H/de|0,A>1?(A>=Js&&(A=Js-1),C=e(ke,A),R=C.length,G=U.length,i=t(C,U,R,G),i==1&&(A--,r(C,ue<R?ve:ke,R))):(A==0&&(i=A=1),C=ke.slice()),R=C.length,R<G&&C.unshift(0),r(U,C,G),i==-1&&(G=U.length,i=t(ke,U,ue,G),i<1&&(A++,r(U,ue<G?ve:ke,G))),G=U.length):i===0&&(A++,U=[0]),V[w++]=A,i&&U[0]?U[G++]=Se[le]||0:(U=[Se[le]],G=1);while((le++<ne||U[0]!==void 0)&&J--)}return V[0]||V.shift(),z.e=_,Va(z,h?l+ms(z)+1:l)}}();function wQ(e,t){var r,n,a,l,h,i,_=0,w=0,A=e.constructor,C=A.precision;if(ms(e)>16)throw Error(UL+ms(e));if(!e.s)return new A(vu);for(xo=!1,i=C,h=new A(.03125);e.abs().gte(.1);)e=e.times(h),w+=5;for(n=Math.log(iv(2,w))/Math.LN10*2+5|0,i+=n,r=a=l=new A(vu),A.precision=i;;){if(a=Va(a.times(e),i),r=r.times(++_),h=l.plus(om(a,r,i)),If(h.d).slice(0,i)===If(l.d).slice(0,i)){for(;w--;)l=Va(l.times(l),i);return A.precision=C,t==null?(xo=!0,Va(l,C)):l}l=h}}function ms(e){for(var t=e.e*so,r=e.d[0];r>=10;r/=10)t++;return t}function Vk(e,t,r){if(t>e.LN10.sd())throw xo=!0,r&&(e.precision=r),Error(Ed+"LN10 precision limit exceeded");return Va(new e(e.LN10),t)}function Sg(e){for(var t="";e--;)t+="0";return t}function uw(e,t){var r,n,a,l,h,i,_,w,A,C=1,R=10,z=e,V=z.d,U=z.constructor,G=U.precision;if(z.s<1)throw Error(Ed+(z.s?"NaN":"-Infinity"));if(z.eq(vu))return new U(0);if(t==null?(xo=!1,w=G):w=t,z.eq(10))return t==null&&(xo=!0),Vk(U,w);if(w+=R,U.precision=w,r=If(V),n=r.charAt(0),l=ms(z),Math.abs(l)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)z=z.times(e),r=If(z.d),n=r.charAt(0),C++;l=ms(z),n>1?(z=new U("0."+r),l++):z=new U(n+"."+r.slice(1))}else return _=Vk(U,w+2,G).times(l+""),z=uw(new U(n+"."+r.slice(1)),w-R).plus(_),U.precision=G,t==null?(xo=!0,Va(z,G)):z;for(i=h=z=om(z.minus(vu),z.plus(vu),w),A=Va(z.times(z),w),a=3;;){if(h=Va(h.times(A),w),_=i.plus(om(h,new U(a),w)),If(_.d).slice(0,w)===If(i.d).slice(0,w))return i=i.times(2),l!==0&&(i=i.plus(Vk(U,w+2,G).times(l+""))),i=om(i,new U(C),w),U.precision=G,t==null?(xo=!0,Va(i,G)):i;i=_,a+=2}}function xq(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=O0(r/so),e.d=[],n=(r+1)%so,r<0&&(n+=so),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=so;n<a;)e.d.push(+t.slice(n,n+=so));t=t.slice(n),n=so-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),xo&&(e.e>xT||e.e<-xT))throw Error(UL+r)}else e.s=0,e.e=0,e.d=[0];return e}function Va(e,t,r){var n,a,l,h,i,_,w,A,C=e.d;for(h=1,l=C[0];l>=10;l/=10)h++;if(n=t-h,n<0)n+=so,a=t,w=C[A=0];else{if(A=Math.ceil((n+1)/so),l=C.length,A>=l)return e;for(w=l=C[A],h=1;l>=10;l/=10)h++;n%=so,a=n-so+h}if(r!==void 0&&(l=iv(10,h-a-1),i=w/l%10|0,_=t<0||C[A+1]!==void 0||w%l,_=r<4?(i||_)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||_||r==6&&(n>0?a>0?w/iv(10,h-a):0:C[A-1])%10&1||r==(e.s<0?8:7))),t<1||!C[0])return _?(l=ms(e),C.length=1,t=t-l-1,C[0]=iv(10,(so-t%so)%so),e.e=O0(-t/so)||0):(C.length=1,C[0]=e.e=e.s=0),e;if(n==0?(C.length=A,l=1,A--):(C.length=A+1,l=iv(10,so-n),C[A]=a>0?(w/iv(10,h-a)%iv(10,a)|0)*l:0),_)for(;;)if(A==0){(C[0]+=l)==Js&&(C[0]=1,++e.e);break}else{if(C[A]+=l,C[A]!=Js)break;C[A--]=0,l=1}for(n=C.length;C[--n]===0;)C.pop();if(xo&&(e.e>xT||e.e<-xT))throw Error(UL+ms(e));return e}function SQ(e,t){var r,n,a,l,h,i,_,w,A,C,R=e.constructor,z=R.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new R(e),xo?Va(t,z):t;if(_=e.d,C=t.d,n=t.e,w=e.e,_=_.slice(),h=w-n,h){for(A=h<0,A?(r=_,h=-h,i=C.length):(r=C,n=w,i=_.length),a=Math.max(Math.ceil(z/so),i)+2,h>a&&(h=a,r.length=1),r.reverse(),a=h;a--;)r.push(0);r.reverse()}else{for(a=_.length,i=C.length,A=a<i,A&&(i=a),a=0;a<i;a++)if(_[a]!=C[a]){A=_[a]<C[a];break}h=0}for(A&&(r=_,_=C,C=r,t.s=-t.s),i=_.length,a=C.length-i;a>0;--a)_[i++]=0;for(a=C.length;a>h;){if(_[--a]<C[a]){for(l=a;l&&_[--l]===0;)_[l]=Js-1;--_[l],_[a]+=Js}_[a]-=C[a]}for(;_[--i]===0;)_.pop();for(;_[0]===0;_.shift())--n;return _[0]?(t.d=_,t.e=n,xo?Va(t,z):t):new R(0)}function kv(e,t,r){var n,a=ms(e),l=If(e.d),h=l.length;return t?(r&&(n=r-h)>0?l=l.charAt(0)+"."+l.slice(1)+Sg(n):h>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+Sg(-a-1)+l,r&&(n=r-h)>0&&(l+=Sg(n))):a>=h?(l+=Sg(a+1-h),r&&(n=r-a-1)>0&&(l=l+"."+Sg(n))):((n=a+1)<h&&(l=l.slice(0,n)+"."+l.slice(n)),r&&(n=r-h)>0&&(a+1===h&&(l+="."),l+=Sg(n))),e.s<0?"-"+l:l}function bq(e,t){if(e.length>t)return e.length=t,!0}function AQ(e){var t,r,n;function a(l){var h=this;if(!(h instanceof a))return new a(l);if(h.constructor=a,l instanceof a){h.s=l.s,h.e=l.e,h.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(wv+l);if(l>0)h.s=1;else if(l<0)l=-l,h.s=-1;else{h.s=0,h.e=0,h.d=[0];return}if(l===~~l&&l<1e7){h.e=0,h.d=[l];return}return xq(h,l.toString())}else if(typeof l!="string")throw Error(wv+l);if(l.charCodeAt(0)===45?(l=l.slice(1),h.s=-1):h.s=1,pCe.test(l))xq(h,l);else throw Error(wv+l)}if(a.prototype=un,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=AQ,a.config=a.set=mCe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function mCe(e){if(!e||typeof e!="object")throw Error(Ed+"Object expected");var t,r,n,a=["precision",1,M0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(O0(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(wv+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(wv+r+": "+n);return this}var $L=AQ(fCe);vu=new $L(1);const Na=$L;function gCe(e){return xCe(e)||_Ce(e)||vCe(e)||yCe()}function yCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vCe(e,t){if(e){if(typeof e=="string")return iI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iI(e,t)}}function _Ce(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function xCe(e){if(Array.isArray(e))return iI(e)}function iI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var bCe=function(t){return t},TQ={},PQ=function(t){return t===TQ},wq=function(t){return function r(){return arguments.length===0||arguments.length===1&&PQ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},wCe=function e(t,r){return t===1?r:wq(function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];var h=a.filter(function(i){return i!==TQ}).length;return h>=t?r.apply(void 0,a):e(t-h,wq(function(){for(var i=arguments.length,_=new Array(i),w=0;w<i;w++)_[w]=arguments[w];var A=a.map(function(C){return PQ(C)?_.shift():C});return r.apply(void 0,gCe(A).concat(_))}))})},nE=function(t){return wCe(t.length,t)},aI=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},SCe=nE(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),ACe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return bCe;var a=r.reverse(),l=a[0],h=a.slice(1);return function(){return h.reduce(function(i,_){return _(i)},l.apply(void 0,arguments))}},oI=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},EQ=function(t){var r=null,n=null;return function(){for(var a=arguments.length,l=new Array(a),h=0;h<a;h++)l[h]=arguments[h];return r&&l.every(function(i,_){return i===r[_]})||(r=l,n=t.apply(void 0,l)),n}};function TCe(e){var t;return e===0?t=1:t=Math.floor(new Na(e).abs().log(10).toNumber())+1,t}function PCe(e,t,r){for(var n=new Na(e),a=0,l=[];n.lt(t)&&a<1e5;)l.push(n.toNumber()),n=n.add(r),a++;return l}var ECe=nE(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),CCe=nE(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),MCe=nE(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const iE={rangeStep:PCe,getDigitCount:TCe,interpolateNumber:ECe,uninterpolateNumber:CCe,uninterpolateTruncation:MCe};function sI(e){return kCe(e)||RCe(e)||CQ(e)||OCe()}function OCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function kCe(e){if(Array.isArray(e))return lI(e)}function dw(e,t){return ICe(e)||NCe(e,t)||CQ(e,t)||jCe()}function jCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CQ(e,t){if(e){if(typeof e=="string")return lI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lI(e,t)}}function lI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NCe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,l=void 0;try{for(var h=e[Symbol.iterator](),i;!(n=(i=h.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(_){a=!0,l=_}finally{try{!n&&h.return!=null&&h.return()}finally{if(a)throw l}}return r}}function ICe(e){if(Array.isArray(e))return e}function MQ(e){var t=dw(e,2),r=t[0],n=t[1],a=r,l=n;return r>n&&(a=n,l=r),[a,l]}function OQ(e,t,r){if(e.lte(0))return new Na(0);var n=iE.getDigitCount(e.toNumber()),a=new Na(10).pow(n),l=e.div(a),h=n!==1?.05:.1,i=new Na(Math.ceil(l.div(h).toNumber())).add(r).mul(h),_=i.mul(a);return t?_:new Na(Math.ceil(_))}function DCe(e,t,r){var n=1,a=new Na(e);if(!a.isint()&&r){var l=Math.abs(e);l<1?(n=new Na(10).pow(iE.getDigitCount(e)-1),a=new Na(Math.floor(a.div(n).toNumber())).mul(n)):l>1&&(a=new Na(Math.floor(e)))}else e===0?a=new Na(Math.floor((t-1)/2)):r||(a=new Na(Math.floor(e)));var h=Math.floor((t-1)/2),i=ACe(SCe(function(_){return a.add(new Na(_-h).mul(n)).toNumber()}),aI);return i(0,t)}function RQ(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Na(0),tickMin:new Na(0),tickMax:new Na(0)};var l=OQ(new Na(t).sub(e).div(r-1),n,a),h;e<=0&&t>=0?h=new Na(0):(h=new Na(e).add(t).div(2),h=h.sub(new Na(h).mod(l)));var i=Math.ceil(h.sub(e).div(l).toNumber()),_=Math.ceil(new Na(t).sub(h).div(l).toNumber()),w=i+_+1;return w>r?RQ(e,t,r,n,a+1):(w<r&&(_=t>0?_+(r-w):_,i=t>0?i:i+(r-w)),{step:l,tickMin:h.sub(new Na(i).mul(l)),tickMax:h.add(new Na(_).mul(l))})}function LCe(e){var t=dw(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=Math.max(a,2),i=MQ([r,n]),_=dw(i,2),w=_[0],A=_[1];if(w===-1/0||A===1/0){var C=A===1/0?[w].concat(sI(aI(0,a-1).map(function(){return 1/0}))):[].concat(sI(aI(0,a-1).map(function(){return-1/0})),[A]);return r>n?oI(C):C}if(w===A)return DCe(w,a,l);var R=RQ(w,A,h,l),z=R.step,V=R.tickMin,U=R.tickMax,G=iE.rangeStep(V,U.add(new Na(.1).mul(z)),z);return r>n?oI(G):G}function zCe(e,t){var r=dw(e,2),n=r[0],a=r[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,h=MQ([n,a]),i=dw(h,2),_=i[0],w=i[1];if(_===-1/0||w===1/0)return[n,a];if(_===w)return[_];var A=Math.max(t,2),C=OQ(new Na(w).sub(_).div(A-1),l,0),R=[].concat(sI(iE.rangeStep(new Na(_),new Na(w).sub(new Na(.99).mul(C)),C)),[w]);return n>a?oI(R):R}var FCe=EQ(LCe),BCe=EQ(zCe),VCe="Invariant failed";function jv(e,t){throw new Error(VCe)}var UCe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Nx(e){"@babel/helpers - typeof";return Nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nx(e)}function bT(){return bT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bT.apply(this,arguments)}function $Ce(e,t){return WCe(e)||KCe(e,t)||GCe(e,t)||qCe()}function qCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GCe(e,t){if(e){if(typeof e=="string")return Sq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sq(e,t)}}function Sq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function WCe(e){if(Array.isArray(e))return e}function HCe(e,t){if(e==null)return{};var r=ZCe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ZCe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function YCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XCe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,NQ(n.key),n)}}function JCe(e,t,r){return t&&XCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function QCe(e,t,r){return t=wT(t),eMe(e,kQ()?Reflect.construct(t,r||[],wT(e).constructor):t.apply(e,r))}function eMe(e,t){if(t&&(Nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tMe(e)}function tMe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kQ=function(){return!!e})()}function wT(e){return wT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wT(e)}function rMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cI(e,t)}function cI(e,t){return cI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},cI(e,t)}function jQ(e,t,r){return t=NQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NQ(e){var t=nMe(e,"string");return Nx(t)=="symbol"?t:t+""}function nMe(e,t){if(Nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var R0=function(e){function t(){return YCe(this,t),QCe(this,t,arguments)}return rMe(t,e),JCe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,l=n.layout,h=n.width,i=n.dataKey,_=n.data,w=n.dataPointFormatter,A=n.xAxis,C=n.yAxis,R=HCe(n,UCe),z=on(R,!1);this.props.direction==="x"&&A.type!=="number"&&jv();var V=_.map(function(U){var G=w(U,i),H=G.x,J=G.y,Q=G.value,le=G.errorVal;if(!le)return null;var ne=[],de,ue;if(Array.isArray(le)){var ve=$Ce(le,2);de=ve[0],ue=ve[1]}else de=ue=le;if(l==="vertical"){var Ae=A.scale,Oe=J+a,Se=Oe+h,ke=Oe-h,ze=Ae(Q-de),et=Ae(Q+ue);ne.push({x1:et,y1:Se,x2:et,y2:ke}),ne.push({x1:ze,y1:Oe,x2:et,y2:Oe}),ne.push({x1:ze,y1:Se,x2:ze,y2:ke})}else if(l==="horizontal"){var je=C.scale,Ne=H+a,Ye=Ne-h,$e=Ne+h,We=je(Q-de),Et=je(Q+ue);ne.push({x1:Ye,y1:Et,x2:$e,y2:Et}),ne.push({x1:Ne,y1:We,x2:Ne,y2:Et}),ne.push({x1:Ye,y1:We,x2:$e,y2:We})}return Pe.createElement(ci,bT({className:"recharts-errorBar",key:"bar-".concat(ne.map(function(Je){return"".concat(Je.x1,"-").concat(Je.x2,"-").concat(Je.y1,"-").concat(Je.y2)}))},z),ne.map(function(Je){return Pe.createElement("line",bT({},Je,{key:"line-".concat(Je.x1,"-").concat(Je.x2,"-").concat(Je.y1,"-").concat(Je.y2)}))}))});return Pe.createElement(ci,{className:"recharts-errorBars"},V)}}])}(Pe.Component);jQ(R0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});jQ(R0,"displayName","ErrorBar");function hw(e){"@babel/helpers - typeof";return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(e)}function Aq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aq(Object(r),!0).forEach(function(n){iMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iMe(e,t,r){return t=aMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aMe(e){var t=oMe(e,"string");return hw(t)=="symbol"?t:t+""}function oMe(e,t){if(hw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(hw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IQ=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,l=t.legendContent,h=gu(r,kh);if(!h)return null;var i=kh.defaultProps,_=i!==void 0?Qy(Qy({},i),h.props):{},w;return h.props&&h.props.payload?w=h.props&&h.props.payload:l==="children"?w=(n||[]).reduce(function(A,C){var R=C.item,z=C.props,V=z.sectors||z.data||[];return A.concat(V.map(function(U){return{type:h.props.iconType||R.props.legendType,value:U.name,color:U.fill,payload:U}}))},[]):w=(n||[]).map(function(A){var C=A.item,R=C.type.defaultProps,z=R!==void 0?Qy(Qy({},R),C.props):{},V=z.dataKey,U=z.name,G=z.legendType,H=z.hide;return{inactive:H,dataKey:V,type:_.iconType||G||"square",color:qL(C),value:U||V,payload:z}}),Qy(Qy(Qy({},_),kh.getWithHeight(h,a)),{},{payload:w,item:h})};function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}function Tq(e){return uMe(e)||cMe(e)||lMe(e)||sMe()}function sMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lMe(e,t){if(e){if(typeof e=="string")return uI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uI(e,t)}}function cMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uMe(e){if(Array.isArray(e))return uI(e)}function uI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pq(Object(r),!0).forEach(function(n){gx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gx(e,t,r){return t=dMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dMe(e){var t=hMe(e,"string");return fw(t)=="symbol"?t:t+""}function hMe(e,t){if(fw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ia(e,t,r){return Gn(e)||Gn(t)?r:Ns(t)?Au(e,t,r):Cn(t)?t(e):r}function f1(e,t,r,n){var a=uCe(e,function(i){return Ia(i,t)});if(r==="number"){var l=a.filter(function(i){return Ir(i)||parseFloat(i)});return l.length?[rE(l),Pg(l)]:[1/0,-1/0]}var h=n?a.filter(function(i){return!Gn(i)}):a;return h.map(function(i){return Ns(i)||i instanceof Date?i:""})}var fMe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,h=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var _=l.range,w=0;w<i;w++){var A=w>0?a[w-1].coordinate:a[i-1].coordinate,C=a[w].coordinate,R=w>=i-1?a[0].coordinate:a[w+1].coordinate,z=void 0;if(tl(C-A)!==tl(R-C)){var V=[];if(tl(R-C)===tl(_[1]-_[0])){z=R;var U=C+_[1]-_[0];V[0]=Math.min(U,(U+A)/2),V[1]=Math.max(U,(U+A)/2)}else{z=A;var G=R+_[1]-_[0];V[0]=Math.min(C,(G+C)/2),V[1]=Math.max(C,(G+C)/2)}var H=[Math.min(C,(z+C)/2),Math.max(C,(z+C)/2)];if(t>H[0]&&t<=H[1]||t>=V[0]&&t<=V[1]){h=a[w].index;break}}else{var J=Math.min(A,R),Q=Math.max(A,R);if(t>(J+C)/2&&t<=(Q+C)/2){h=a[w].index;break}}}else for(var le=0;le<i;le++)if(le===0&&t<=(n[le].coordinate+n[le+1].coordinate)/2||le>0&&le<i-1&&t>(n[le].coordinate+n[le-1].coordinate)/2&&t<=(n[le].coordinate+n[le+1].coordinate)/2||le===i-1&&t>(n[le].coordinate+n[le-1].coordinate)/2){h=n[le].index;break}return h},qL=function(t){var r,n=t,a=n.type.displayName,l=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Bo(Bo({},t.type.defaultProps),t.props):t.props,h=l.stroke,i=l.fill,_;switch(a){case"Line":_=h;break;case"Area":case"Radar":_=h&&h!=="none"?h:i;break;default:_=i;break}return _},pMe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,l=a===void 0?{}:a;if(!l)return{};for(var h={},i=Object.keys(l),_=0,w=i.length;_<w;_++)for(var A=l[i[_]].stackGroups,C=Object.keys(A),R=0,z=C.length;R<z;R++){var V=A[C[R]],U=V.items,G=V.cateAxisId,H=U.filter(function(ue){return am(ue.type).indexOf("Bar")>=0});if(H&&H.length){var J=H[0].type.defaultProps,Q=J!==void 0?Bo(Bo({},J),H[0].props):H[0].props,le=Q.barSize,ne=Q[G];h[ne]||(h[ne]=[]);var de=Gn(le)?r:le;h[ne].push({item:H[0],stackList:H.slice(1),barSize:Gn(de)?void 0:sc(de,n,0)})}}return h},mMe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,l=t.sizeList,h=l===void 0?[]:l,i=t.maxBarSize,_=h.length;if(_<1)return null;var w=sc(r,a,0,!0),A,C=[];if(h[0].barSize===+h[0].barSize){var R=!1,z=a/_,V=h.reduce(function(le,ne){return le+ne.barSize||0},0);V+=(_-1)*w,V>=a&&(V-=(_-1)*w,w=0),V>=a&&z>0&&(R=!0,z*=.9,V=_*z);var U=(a-V)/2>>0,G={offset:U-w,size:0};A=h.reduce(function(le,ne){var de={item:ne.item,position:{offset:G.offset+G.size+w,size:R?z:ne.barSize}},ue=[].concat(Tq(le),[de]);return G=ue[ue.length-1].position,ne.stackList&&ne.stackList.length&&ne.stackList.forEach(function(ve){ue.push({item:ve,position:G})}),ue},C)}else{var H=sc(n,a,0,!0);a-2*H-(_-1)*w<=0&&(w=0);var J=(a-2*H-(_-1)*w)/_;J>1&&(J>>=0);var Q=i===+i?Math.min(J,i):J;A=h.reduce(function(le,ne,de){var ue=[].concat(Tq(le),[{item:ne.item,position:{offset:H+(J+w)*de+(J-Q)/2,size:Q}}]);return ne.stackList&&ne.stackList.length&&ne.stackList.forEach(function(ve){ue.push({item:ve,position:ue[ue.length-1].position})}),ue},C)}return A},gMe=function(t,r,n,a){var l=n.children,h=n.width,i=n.margin,_=h-(i.left||0)-(i.right||0),w=IQ({children:l,legendWidth:_});if(w){var A=a||{},C=A.width,R=A.height,z=w.align,V=w.verticalAlign,U=w.layout;if((U==="vertical"||U==="horizontal"&&V==="middle")&&z!=="center"&&Ir(t[z]))return Bo(Bo({},t),{},gx({},z,t[z]+(C||0)));if((U==="horizontal"||U==="vertical"&&z==="center")&&V!=="middle"&&Ir(t[V]))return Bo(Bo({},t),{},gx({},V,t[V]+(R||0)))}return t},yMe=function(t,r,n){return Gn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},DQ=function(t,r,n,a,l){var h=r.props.children,i=Bl(h,R0).filter(function(w){return yMe(a,l,w.props.direction)});if(i&&i.length){var _=i.map(function(w){return w.props.dataKey});return t.reduce(function(w,A){var C=Ia(A,n);if(Gn(C))return w;var R=Array.isArray(C)?[rE(C),Pg(C)]:[C,C],z=_.reduce(function(V,U){var G=Ia(A,U,0),H=R[0]-Math.abs(Array.isArray(G)?G[0]:G),J=R[1]+Math.abs(Array.isArray(G)?G[1]:G);return[Math.min(H,V[0]),Math.max(J,V[1])]},[1/0,-1/0]);return[Math.min(z[0],w[0]),Math.max(z[1],w[1])]},[1/0,-1/0])}return null},vMe=function(t,r,n,a,l){var h=r.map(function(i){return DQ(t,i,n,l,a)}).filter(function(i){return!Gn(i)});return h&&h.length?h.reduce(function(i,_){return[Math.min(i[0],_[0]),Math.max(i[1],_[1])]},[1/0,-1/0]):null},LQ=function(t,r,n,a,l){var h=r.map(function(_){var w=_.props.dataKey;return n==="number"&&w&&DQ(t,_,w,a)||f1(t,w,n,l)});if(n==="number")return h.reduce(function(_,w){return[Math.min(_[0],w[0]),Math.max(_[1],w[1])]},[1/0,-1/0]);var i={};return h.reduce(function(_,w){for(var A=0,C=w.length;A<C;A++)i[w[A]]||(i[w[A]]=!0,_.push(w[A]));return _},[])},zQ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},FQ=function(t,r,n,a){if(a)return t.map(function(_){return _.coordinate});var l,h,i=t.map(function(_){return _.coordinate===r&&(l=!0),_.coordinate===n&&(h=!0),_.coordinate});return l||i.push(r),h||i.push(n),i},tm=function(t,r,n){if(!t)return null;var a=t.scale,l=t.duplicateDomain,h=t.type,i=t.range,_=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,w=(r||n)&&h==="category"&&a.bandwidth?a.bandwidth()/_:0;if(w=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?tl(i[0]-i[1])*2*w:w,r&&(t.ticks||t.niceTicks)){var A=(t.ticks||t.niceTicks).map(function(C){var R=l?l.indexOf(C):C;return{coordinate:a(R)+w,value:C,offset:w}});return A.filter(function(C){return!P0(C.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(C,R){return{coordinate:a(C)+w,value:C,index:R,offset:w}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(C){return{coordinate:a(C)+w,value:C,offset:w}}):a.domain().map(function(C,R){return{coordinate:a(C)+w,value:l?l[C]:C,index:R,offset:w}})},Uk=new WeakMap,G2=function(t,r){if(typeof r!="function")return t;Uk.has(t)||Uk.set(t,new WeakMap);var n=Uk.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},BQ=function(t,r,n){var a=t.scale,l=t.type,h=t.layout,i=t.axisType;if(a==="auto")return h==="radial"&&i==="radiusAxis"?{scale:aw(),realScaleType:"band"}:h==="radial"&&i==="angleAxis"?{scale:gT(),realScaleType:"linear"}:l==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:h1(),realScaleType:"point"}:l==="category"?{scale:aw(),realScaleType:"band"}:{scale:gT(),realScaleType:"linear"};if(lS(a)){var _="scale".concat(VP(a));return{scale:(dq[_]||h1)(),realScaleType:dq[_]?_:"point"}}return Cn(a)?{scale:a}:{scale:h1(),realScaleType:"point"}},Eq=1e-4,VQ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),l=Math.min(a[0],a[1])-Eq,h=Math.max(a[0],a[1])+Eq,i=t(r[0]),_=t(r[n-1]);(i<l||i>h||_<l||_>h)&&t.domain([r[0],r[n-1]])}},UQ=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},$Q=function(t,r){if(!r||r.length!==2||!Ir(r[0])||!Ir(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),l=[t[0],t[1]];return(!Ir(t[0])||t[0]<n)&&(l[0]=n),(!Ir(t[1])||t[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<n&&(l[1]=n),l},_Me=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,h=0,i=0;i<r;++i){var _=P0(t[i][n][1])?t[i][n][0]:t[i][n][1];_>=0?(t[i][n][0]=l,t[i][n][1]=l+_,l=t[i][n][1]):(t[i][n][0]=h,t[i][n][1]=h+_,h=t[i][n][1])}},xMe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var l=0,h=0;h<r;++h){var i=P0(t[h][n][1])?t[h][n][0]:t[h][n][1];i>=0?(t[h][n][0]=l,t[h][n][1]=l+i,l=t[h][n][1]):(t[h][n][0]=0,t[h][n][1]=0)}},bMe={sign:_Me,expand:uSe,none:Px,silhouette:dSe,wiggle:hSe,positive:xMe},wMe=function(t,r,n){var a=r.map(function(i){return i.props.dataKey}),l=bMe[n],h=cSe().keys(a).value(function(i,_){return+Ia(i,_,0)}).order(BN).offset(l);return h(t)},SMe=function(t,r,n,a,l,h){if(!t)return null;var i=h?r.reverse():r,_={},w=i.reduce(function(C,R){var z,V=(z=R.type)!==null&&z!==void 0&&z.defaultProps?Bo(Bo({},R.type.defaultProps),R.props):R.props,U=V.stackId,G=V.hide;if(G)return C;var H=V[n],J=C[H]||{hasStack:!1,stackGroups:{}};if(Ns(U)){var Q=J.stackGroups[U]||{numericAxisId:n,cateAxisId:a,items:[]};Q.items.push(R),J.hasStack=!0,J.stackGroups[U]=Q}else J.stackGroups[Hg("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[R]};return Bo(Bo({},C),{},gx({},H,J))},_),A={};return Object.keys(w).reduce(function(C,R){var z=w[R];if(z.hasStack){var V={};z.stackGroups=Object.keys(z.stackGroups).reduce(function(U,G){var H=z.stackGroups[G];return Bo(Bo({},U),{},gx({},G,{numericAxisId:n,cateAxisId:a,items:H.items,stackedData:wMe(t,H.items,l)}))},V)}return Bo(Bo({},C),{},gx({},R,z))},A)},qQ=function(t,r){var n=r.realScaleType,a=r.type,l=r.tickCount,h=r.originalDomain,i=r.allowDecimals,_=n||r.scale;if(_!=="auto"&&_!=="linear")return null;if(l&&a==="number"&&h&&(h[0]==="auto"||h[1]==="auto")){var w=t.domain();if(!w.length)return null;var A=FCe(w,l,i);return t.domain([rE(A),Pg(A)]),{niceTicks:A}}if(l&&a==="number"){var C=t.domain(),R=BCe(C,l,i);return{niceTicks:R}}return null};function Ix(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,l=e.index,h=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Gn(a[t.dataKey])){var i=JA(r,"value",a[t.dataKey]);if(i)return i.coordinate+n/2}return r[l]?r[l].coordinate+n/2:null}var _=Ia(a,Gn(h)?t.dataKey:h);return Gn(_)?null:t.scale(_)}var ST=function(t){var r=t.axis,n=t.ticks,a=t.offset,l=t.bandSize,h=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+a:null;var _=Ia(h,r.dataKey,r.domain[i]);return Gn(_)?null:r.scale(_)-l/2+a},GQ=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),l=Math.max(n[0],n[1]);return a<=0&&l>=0?0:l<0?l:a}return n[0]},AMe=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Bo(Bo({},t.type.defaultProps),t.props):t.props,l=a.stackId;if(Ns(l)){var h=r[l];if(h){var i=h.items.indexOf(t);return i>=0?h.stackedData[i]:null}}return null},TMe=function(t){return t.reduce(function(r,n){return[rE(n.concat([r[0]]).filter(Ir)),Pg(n.concat([r[1]]).filter(Ir))]},[1/0,-1/0])},KQ=function(t,r,n){return Object.keys(t).reduce(function(a,l){var h=t[l],i=h.stackedData,_=i.reduce(function(w,A){var C=TMe(A.slice(r,n+1));return[Math.min(w[0],C[0]),Math.max(w[1],C[1])]},[1/0,-1/0]);return[Math.min(_[0],a[0]),Math.max(_[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},Cq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Mq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,dI=function(t,r,n){if(Cn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Ir(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(Cq.test(t[0])){var l=+Cq.exec(t[0])[1];a[0]=r[0]-l}else Cn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Ir(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(Mq.test(t[1])){var h=+Mq.exec(t[1])[1];a[1]=r[1]+h}else Cn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},AT=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var l=vL(r,function(C){return C.coordinate}),h=1/0,i=1,_=l.length;i<_;i++){var w=l[i],A=l[i-1];h=Math.min((w.coordinate||0)-(A.coordinate||0),h)}return h===1/0?0:h}return n?void 0:0},Oq=function(t,r,n){return!t||!t.length||Hf(t,Au(n,"type.defaultProps.domain"))?r:t},GL=function(t,r){var n=t.type.defaultProps?Bo(Bo({},t.type.defaultProps),t.props):t.props,a=n.dataKey,l=n.name,h=n.unit,i=n.formatter,_=n.tooltipType,w=n.chartType,A=n.hide;return Bo(Bo({},on(t,!1)),{},{dataKey:a,unit:h,formatter:i,name:l||a,color:qL(t),value:Ia(r,a),type:_,payload:r,chartType:w,hide:A})};function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function Rq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Zp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rq(Object(r),!0).forEach(function(n){WQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WQ(e,t,r){return t=PMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PMe(e){var t=EMe(e,"string");return pw(t)=="symbol"?t:t+""}function EMe(e,t){if(pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CMe(e,t){return kMe(e)||RMe(e,t)||OMe(e,t)||MMe()}function MMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OMe(e,t){if(e){if(typeof e=="string")return kq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kq(e,t)}}function kq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function kMe(e){if(Array.isArray(e))return e}var TT=Math.PI/180,jMe=function(t){return t*180/Math.PI},sa=function(t,r,n,a){return{x:t+Math.cos(-TT*a)*n,y:r+Math.sin(-TT*a)*n}},HQ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},KL=function(t,r,n,a,l){var h=t.width,i=t.height,_=t.startAngle,w=t.endAngle,A=sc(t.cx,h,h/2),C=sc(t.cy,i,i/2),R=HQ(h,i,n),z=sc(t.innerRadius,R,0),V=sc(t.outerRadius,R,R*.8),U=Object.keys(r);return U.reduce(function(G,H){var J=r[H],Q=J.domain,le=J.reversed,ne;if(Gn(J.range))a==="angleAxis"?ne=[_,w]:a==="radiusAxis"&&(ne=[z,V]),le&&(ne=[ne[1],ne[0]]);else{ne=J.range;var de=ne,ue=CMe(de,2);_=ue[0],w=ue[1]}var ve=BQ(J,l),Ae=ve.realScaleType,Oe=ve.scale;Oe.domain(Q).range(ne),VQ(Oe);var Se=qQ(Oe,Zp(Zp({},J),{},{realScaleType:Ae})),ke=Zp(Zp(Zp({},J),Se),{},{range:ne,radius:V,realScaleType:Ae,scale:Oe,cx:A,cy:C,innerRadius:z,outerRadius:V,startAngle:_,endAngle:w});return Zp(Zp({},G),{},WQ({},H,ke))},{})},NMe=function(t,r){var n=t.x,a=t.y,l=r.x,h=r.y;return Math.sqrt(Math.pow(n-l,2)+Math.pow(a-h,2))},IMe=function(t,r){var n=t.x,a=t.y,l=r.cx,h=r.cy,i=NMe({x:n,y:a},{x:l,y:h});if(i<=0)return{radius:i};var _=(n-l)/i,w=Math.acos(_);return a>h&&(w=2*Math.PI-w),{radius:i,angle:jMe(w),angleInRadian:w}},DMe=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),l=Math.floor(n/360),h=Math.min(a,l);return{startAngle:r-h*360,endAngle:n-h*360}},LMe=function(t,r){var n=r.startAngle,a=r.endAngle,l=Math.floor(n/360),h=Math.floor(a/360),i=Math.min(l,h);return t+i*360},jq=function(t,r){var n=t.x,a=t.y,l=IMe({x:n,y:a},r),h=l.radius,i=l.angle,_=r.innerRadius,w=r.outerRadius;if(h<_||h>w)return!1;if(h===0)return!0;var A=DMe(r),C=A.startAngle,R=A.endAngle,z=i,V;if(C<=R){for(;z>R;)z-=360;for(;z<C;)z+=360;V=z>=C&&z<=R}else{for(;z>C;)z-=360;for(;z<R;)z+=360;V=z>=R&&z<=C}return V?Zp(Zp({},r),{},{radius:h,angle:LMe(z,r)}):null},ZQ=function(t){return!K.isValidElement(t)&&!Cn(t)&&typeof t!="boolean"?t.className:""};function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}var zMe=["offset"];function FMe(e){return $Me(e)||UMe(e)||VMe(e)||BMe()}function BMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VMe(e,t){if(e){if(typeof e=="string")return hI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hI(e,t)}}function UMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Me(e){if(Array.isArray(e))return hI(e)}function hI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qMe(e,t){if(e==null)return{};var r=GMe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GMe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Nq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Os(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nq(Object(r),!0).forEach(function(n){KMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KMe(e,t,r){return t=WMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WMe(e){var t=HMe(e,"string");return mw(t)=="symbol"?t:t+""}function HMe(e,t){if(mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gw(){return gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gw.apply(this,arguments)}var ZMe=function(t){var r=t.value,n=t.formatter,a=Gn(t.children)?r:t.children;return Cn(n)?n(a):a},YMe=function(t,r){var n=tl(r-t),a=Math.min(Math.abs(r-t),360);return n*a},XMe=function(t,r,n){var a=t.position,l=t.viewBox,h=t.offset,i=t.className,_=l,w=_.cx,A=_.cy,C=_.innerRadius,R=_.outerRadius,z=_.startAngle,V=_.endAngle,U=_.clockWise,G=(C+R)/2,H=YMe(z,V),J=H>=0?1:-1,Q,le;a==="insideStart"?(Q=z+J*h,le=U):a==="insideEnd"?(Q=V-J*h,le=!U):a==="end"&&(Q=V+J*h,le=U),le=H<=0?le:!le;var ne=sa(w,A,G,Q),de=sa(w,A,G,Q+(le?1:-1)*359),ue="M".concat(ne.x,",").concat(ne.y,`
    A`).concat(G,",").concat(G,",0,1,").concat(le?0:1,`,
    `).concat(de.x,",").concat(de.y),ve=Gn(t.id)?Hg("recharts-radial-line-"):t.id;return Pe.createElement("text",gw({},n,{dominantBaseline:"central",className:Xn("recharts-radial-bar-label",i)}),Pe.createElement("defs",null,Pe.createElement("path",{id:ve,d:ue})),Pe.createElement("textPath",{xlinkHref:"#".concat(ve)},r))},JMe=function(t){var r=t.viewBox,n=t.offset,a=t.position,l=r,h=l.cx,i=l.cy,_=l.innerRadius,w=l.outerRadius,A=l.startAngle,C=l.endAngle,R=(A+C)/2;if(a==="outside"){var z=sa(h,i,w+n,R),V=z.x,U=z.y;return{x:V,y:U,textAnchor:V>=h?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:h,y:i,textAnchor:"middle",verticalAnchor:"end"};var G=(_+w)/2,H=sa(h,i,G,R),J=H.x,Q=H.y;return{x:J,y:Q,textAnchor:"middle",verticalAnchor:"middle"}},QMe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,l=t.position,h=r,i=h.x,_=h.y,w=h.width,A=h.height,C=A>=0?1:-1,R=C*a,z=C>0?"end":"start",V=C>0?"start":"end",U=w>=0?1:-1,G=U*a,H=U>0?"end":"start",J=U>0?"start":"end";if(l==="top"){var Q={x:i+w/2,y:_-C*a,textAnchor:"middle",verticalAnchor:z};return Os(Os({},Q),n?{height:Math.max(_-n.y,0),width:w}:{})}if(l==="bottom"){var le={x:i+w/2,y:_+A+R,textAnchor:"middle",verticalAnchor:V};return Os(Os({},le),n?{height:Math.max(n.y+n.height-(_+A),0),width:w}:{})}if(l==="left"){var ne={x:i-G,y:_+A/2,textAnchor:H,verticalAnchor:"middle"};return Os(Os({},ne),n?{width:Math.max(ne.x-n.x,0),height:A}:{})}if(l==="right"){var de={x:i+w+G,y:_+A/2,textAnchor:J,verticalAnchor:"middle"};return Os(Os({},de),n?{width:Math.max(n.x+n.width-de.x,0),height:A}:{})}var ue=n?{width:w,height:A}:{};return l==="insideLeft"?Os({x:i+G,y:_+A/2,textAnchor:J,verticalAnchor:"middle"},ue):l==="insideRight"?Os({x:i+w-G,y:_+A/2,textAnchor:H,verticalAnchor:"middle"},ue):l==="insideTop"?Os({x:i+w/2,y:_+R,textAnchor:"middle",verticalAnchor:V},ue):l==="insideBottom"?Os({x:i+w/2,y:_+A-R,textAnchor:"middle",verticalAnchor:z},ue):l==="insideTopLeft"?Os({x:i+G,y:_+R,textAnchor:J,verticalAnchor:V},ue):l==="insideTopRight"?Os({x:i+w-G,y:_+R,textAnchor:H,verticalAnchor:V},ue):l==="insideBottomLeft"?Os({x:i+G,y:_+A-R,textAnchor:J,verticalAnchor:z},ue):l==="insideBottomRight"?Os({x:i+w-G,y:_+A-R,textAnchor:H,verticalAnchor:z},ue):T0(l)&&(Ir(l.x)||fv(l.x))&&(Ir(l.y)||fv(l.y))?Os({x:i+sc(l.x,w),y:_+sc(l.y,A),textAnchor:"end",verticalAnchor:"end"},ue):Os({x:i+w/2,y:_+A/2,textAnchor:"middle",verticalAnchor:"middle"},ue)},eOe=function(t){return"cx"in t&&Ir(t.cx)};function el(e){var t=e.offset,r=t===void 0?5:t,n=qMe(e,zMe),a=Os({offset:r},n),l=a.viewBox,h=a.position,i=a.value,_=a.children,w=a.content,A=a.className,C=A===void 0?"":A,R=a.textBreakAll;if(!l||Gn(i)&&Gn(_)&&!K.isValidElement(w)&&!Cn(w))return null;if(K.isValidElement(w))return K.cloneElement(w,a);var z;if(Cn(w)){if(z=K.createElement(w,a),K.isValidElement(z))return z}else z=ZMe(a);var V=eOe(l),U=on(a,!0);if(V&&(h==="insideStart"||h==="insideEnd"||h==="end"))return XMe(a,z,U);var G=V?JMe(a):QMe(a);return Pe.createElement(Rv,gw({className:Xn("recharts-label",C)},U,G,{breakAll:R}),z)}el.displayName="Label";var YQ=function(t){var r=t.cx,n=t.cy,a=t.angle,l=t.startAngle,h=t.endAngle,i=t.r,_=t.radius,w=t.innerRadius,A=t.outerRadius,C=t.x,R=t.y,z=t.top,V=t.left,U=t.width,G=t.height,H=t.clockWise,J=t.labelViewBox;if(J)return J;if(Ir(U)&&Ir(G)){if(Ir(C)&&Ir(R))return{x:C,y:R,width:U,height:G};if(Ir(z)&&Ir(V))return{x:z,y:V,width:U,height:G}}return Ir(C)&&Ir(R)?{x:C,y:R,width:0,height:0}:Ir(r)&&Ir(n)?{cx:r,cy:n,startAngle:l||a||0,endAngle:h||a||0,innerRadius:w||0,outerRadius:A||_||i||0,clockWise:H}:t.viewBox?t.viewBox:{}},tOe=function(t,r){return t?t===!0?Pe.createElement(el,{key:"label-implicit",viewBox:r}):Ns(t)?Pe.createElement(el,{key:"label-implicit",viewBox:r,value:t}):K.isValidElement(t)?t.type===el?K.cloneElement(t,{key:"label-implicit",viewBox:r}):Pe.createElement(el,{key:"label-implicit",content:t,viewBox:r}):Cn(t)?Pe.createElement(el,{key:"label-implicit",content:t,viewBox:r}):T0(t)?Pe.createElement(el,gw({viewBox:r},t,{key:"label-implicit"})):null:null},rOe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,l=YQ(t),h=Bl(a,el).map(function(_,w){return K.cloneElement(_,{viewBox:r||l,key:"label-".concat(w)})});if(!n)return h;var i=tOe(t.label,r||l);return[i].concat(FMe(h))};el.parseViewBox=YQ;el.renderCallByParent=rOe;var $k,Iq;function nOe(){if(Iq)return $k;Iq=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return $k=e,$k}var iOe=nOe();const XQ=ta(iOe);function yw(e){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}var aOe=["valueAccessor"],oOe=["data","dataKey","clockWise","id","textBreakAll"];function sOe(e){return dOe(e)||uOe(e)||cOe(e)||lOe()}function lOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cOe(e,t){if(e){if(typeof e=="string")return fI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fI(e,t)}}function uOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dOe(e){if(Array.isArray(e))return fI(e)}function fI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PT(){return PT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PT.apply(this,arguments)}function Dq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dq(Object(r),!0).forEach(function(n){hOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hOe(e,t,r){return t=fOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fOe(e){var t=pOe(e,"string");return yw(t)=="symbol"?t:t+""}function pOe(e,t){if(yw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(yw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zq(e,t){if(e==null)return{};var r=mOe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function mOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var gOe=function(t){return Array.isArray(t.value)?XQ(t.value):t.value};function Tu(e){var t=e.valueAccessor,r=t===void 0?gOe:t,n=zq(e,aOe),a=n.data,l=n.dataKey,h=n.clockWise,i=n.id,_=n.textBreakAll,w=zq(n,oOe);return!a||!a.length?null:Pe.createElement(ci,{className:"recharts-label-list"},a.map(function(A,C){var R=Gn(l)?r(A,C):Ia(A&&A.payload,l),z=Gn(i)?{}:{id:"".concat(i,"-").concat(C)};return Pe.createElement(el,PT({},on(A,!0),w,z,{parentViewBox:A.parentViewBox,value:R,textBreakAll:_,viewBox:el.parseViewBox(Gn(h)?A:Lq(Lq({},A),{},{clockWise:h})),key:"label-".concat(C),index:C}))}))}Tu.displayName="LabelList";function yOe(e,t){return e?e===!0?Pe.createElement(Tu,{key:"labelList-implicit",data:t}):Pe.isValidElement(e)||Cn(e)?Pe.createElement(Tu,{key:"labelList-implicit",data:t,content:e}):T0(e)?Pe.createElement(Tu,PT({data:t},e,{key:"labelList-implicit"})):null:null}function vOe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Bl(n,Tu).map(function(h,i){return K.cloneElement(h,{data:t,key:"labelList-".concat(i)})});if(!r)return a;var l=yOe(e.label,t);return[l].concat(sOe(a))}Tu.renderCallByParent=vOe;function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}function pI(){return pI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pI.apply(this,arguments)}function Fq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fq(Object(r),!0).forEach(function(n){_Oe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Oe(e,t,r){return t=xOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xOe(e){var t=bOe(e,"string");return vw(t)=="symbol"?t:t+""}function bOe(e,t){if(vw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wOe=function(t,r){var n=tl(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},K2=function(t){var r=t.cx,n=t.cy,a=t.radius,l=t.angle,h=t.sign,i=t.isExternal,_=t.cornerRadius,w=t.cornerIsExternal,A=_*(i?1:-1)+a,C=Math.asin(_/A)/TT,R=w?l:l+h*C,z=sa(r,n,A,R),V=sa(r,n,a,R),U=w?l-h*C:l,G=sa(r,n,A*Math.cos(C*TT),U);return{center:z,circleTangency:V,lineTangency:G,theta:C}},JQ=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,h=t.startAngle,i=t.endAngle,_=wOe(h,i),w=h+_,A=sa(r,n,l,h),C=sa(r,n,l,w),R="M ".concat(A.x,",").concat(A.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(_)>180),",").concat(+(h>w),`,
    `).concat(C.x,",").concat(C.y,`
  `);if(a>0){var z=sa(r,n,a,h),V=sa(r,n,a,w);R+="L ".concat(V.x,",").concat(V.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(_)>180),",").concat(+(h<=w),`,
            `).concat(z.x,",").concat(z.y," Z")}else R+="L ".concat(r,",").concat(n," Z");return R},SOe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,h=t.cornerRadius,i=t.forceCornerRadius,_=t.cornerIsExternal,w=t.startAngle,A=t.endAngle,C=tl(A-w),R=K2({cx:r,cy:n,radius:l,angle:w,sign:C,cornerRadius:h,cornerIsExternal:_}),z=R.circleTangency,V=R.lineTangency,U=R.theta,G=K2({cx:r,cy:n,radius:l,angle:A,sign:-C,cornerRadius:h,cornerIsExternal:_}),H=G.circleTangency,J=G.lineTangency,Q=G.theta,le=_?Math.abs(w-A):Math.abs(w-A)-U-Q;if(le<0)return i?"M ".concat(V.x,",").concat(V.y,`
        a`).concat(h,",").concat(h,",0,0,1,").concat(h*2,`,0
        a`).concat(h,",").concat(h,",0,0,1,").concat(-h*2,`,0
      `):JQ({cx:r,cy:n,innerRadius:a,outerRadius:l,startAngle:w,endAngle:A});var ne="M ".concat(V.x,",").concat(V.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(z.x,",").concat(z.y,`
    A`).concat(l,",").concat(l,",0,").concat(+(le>180),",").concat(+(C<0),",").concat(H.x,",").concat(H.y,`
    A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(J.x,",").concat(J.y,`
  `);if(a>0){var de=K2({cx:r,cy:n,radius:a,angle:w,sign:C,isExternal:!0,cornerRadius:h,cornerIsExternal:_}),ue=de.circleTangency,ve=de.lineTangency,Ae=de.theta,Oe=K2({cx:r,cy:n,radius:a,angle:A,sign:-C,isExternal:!0,cornerRadius:h,cornerIsExternal:_}),Se=Oe.circleTangency,ke=Oe.lineTangency,ze=Oe.theta,et=_?Math.abs(w-A):Math.abs(w-A)-Ae-ze;if(et<0&&h===0)return"".concat(ne,"L").concat(r,",").concat(n,"Z");ne+="L".concat(ke.x,",").concat(ke.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(Se.x,",").concat(Se.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(et>180),",").concat(+(C>0),",").concat(ue.x,",").concat(ue.y,`
      A`).concat(h,",").concat(h,",0,0,").concat(+(C<0),",").concat(ve.x,",").concat(ve.y,"Z")}else ne+="L".concat(r,",").concat(n,"Z");return ne},AOe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},QQ=function(t){var r=Bq(Bq({},AOe),t),n=r.cx,a=r.cy,l=r.innerRadius,h=r.outerRadius,i=r.cornerRadius,_=r.forceCornerRadius,w=r.cornerIsExternal,A=r.startAngle,C=r.endAngle,R=r.className;if(h<l||A===C)return null;var z=Xn("recharts-sector",R),V=h-l,U=sc(i,V,0,!0),G;return U>0&&Math.abs(A-C)<360?G=SOe({cx:n,cy:a,innerRadius:l,outerRadius:h,cornerRadius:Math.min(U,V/2),forceCornerRadius:_,cornerIsExternal:w,startAngle:A,endAngle:C}):G=JQ({cx:n,cy:a,innerRadius:l,outerRadius:h,startAngle:A,endAngle:C}),Pe.createElement("path",pI({},on(r,!0),{className:z,d:G,role:"img"}))};function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function mI(){return mI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mI.apply(this,arguments)}function Vq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Uq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vq(Object(r),!0).forEach(function(n){TOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TOe(e,t,r){return t=POe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function POe(e){var t=EOe(e,"string");return _w(t)=="symbol"?t:t+""}function EOe(e,t){if(_w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_w(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $q={curveBasisClosed:Jwe,curveBasisOpen:Qwe,curveBasis:Xwe,curveBumpX:Lwe,curveBumpY:zwe,curveLinearClosed:eSe,curveLinear:$P,curveMonotoneX:tSe,curveMonotoneY:rSe,curveNatural:nSe,curveStep:iSe,curveStepAfter:oSe,curveStepBefore:aSe},W2=function(t){return t.x===+t.x&&t.y===+t.y},Ub=function(t){return t.x},$b=function(t){return t.y},COe=function(t,r){if(Cn(t))return t;var n="curve".concat(VP(t));return(n==="curveMonotone"||n==="curveBump")&&r?$q["".concat(n).concat(r==="vertical"?"Y":"X")]:$q[n]||$P},MOe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,l=a===void 0?[]:a,h=t.baseLine,i=t.layout,_=t.connectNulls,w=_===void 0?!1:_,A=COe(n,i),C=w?l.filter(function(U){return W2(U)}):l,R;if(Array.isArray(h)){var z=w?h.filter(function(U){return W2(U)}):h,V=C.map(function(U,G){return Uq(Uq({},U),{},{base:z[G]})});return i==="vertical"?R=z2().y($b).x1(Ub).x0(function(U){return U.base.x}):R=z2().x(Ub).y1($b).y0(function(U){return U.base.y}),R.defined(W2).curve(A),R(V)}return i==="vertical"&&Ir(h)?R=z2().y($b).x1(Ub).x0(h):Ir(h)?R=z2().x(Ub).y1($b).y0(h):R=HX().x(Ub).y($b),R.defined(W2).curve(A),R(C)},Rg=function(t){var r=t.className,n=t.points,a=t.path,l=t.pathRef;if((!n||!n.length)&&!a)return null;var h=n&&n.length?MOe(t):a;return Pe.createElement("path",mI({},on(t,!1),QA(t),{className:Xn("recharts-curve",r),d:h,ref:l}))},qk={exports:{}},Gk,qq;function OOe(){if(qq)return Gk;qq=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Gk=e,Gk}var Kk,Gq;function ROe(){if(Gq)return Kk;Gq=1;var e=OOe();function t(){}function r(){}return r.resetWarningCache=t,Kk=function(){function n(h,i,_,w,A,C){if(C!==e){var R=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw R.name="Invariant Violation",R}}n.isRequired=n;function a(){return n}var l={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return l.PropTypes=l,l},Kk}var Kq;function kOe(){return Kq||(Kq=1,qk.exports=ROe()()),qk.exports}var jOe=kOe();const xa=ta(jOe);var NOe=Object.getOwnPropertyNames,IOe=Object.getOwnPropertySymbols,DOe=Object.prototype.hasOwnProperty;function Wq(e,t){return function(n,a,l){return e(n,a,l)&&t(n,a,l)}}function H2(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var l=a.cache,h=l.get(r),i=l.get(n);if(h&&i)return h===n&&i===r;l.set(r,n),l.set(n,r);var _=e(r,n,a);return l.delete(r),l.delete(n),_}}function Hq(e){return NOe(e).concat(IOe(e))}var LOe=Object.hasOwn||function(e,t){return DOe.call(e,t)};function Xv(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var zOe="__v",FOe="__o",BOe="_owner",Zq=Object.getOwnPropertyDescriptor,Yq=Object.keys;function VOe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function UOe(e,t){return Xv(e.getTime(),t.getTime())}function $Oe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function qOe(e,t){return e===t}function Xq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),l=e.entries(),h,i,_=0;(h=l.next())&&!h.done;){for(var w=t.entries(),A=!1,C=0;(i=w.next())&&!i.done;){if(a[C]){C++;continue}var R=h.value,z=i.value;if(r.equals(R[0],z[0],_,C,e,t,r)&&r.equals(R[1],z[1],R[0],z[0],e,t,r)){A=a[C]=!0;break}C++}if(!A)return!1;_++}return!0}var GOe=Xv;function KOe(e,t,r){var n=Yq(e),a=n.length;if(Yq(t).length!==a)return!1;for(;a-- >0;)if(!eee(e,t,r,n[a]))return!1;return!0}function qb(e,t,r){var n=Hq(e),a=n.length;if(Hq(t).length!==a)return!1;for(var l,h,i;a-- >0;)if(l=n[a],!eee(e,t,r,l)||(h=Zq(e,l),i=Zq(t,l),(h||i)&&(!h||!i||h.configurable!==i.configurable||h.enumerable!==i.enumerable||h.writable!==i.writable)))return!1;return!0}function WOe(e,t){return Xv(e.valueOf(),t.valueOf())}function HOe(e,t){return e.source===t.source&&e.flags===t.flags}function Jq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),l=e.values(),h,i;(h=l.next())&&!h.done;){for(var _=t.values(),w=!1,A=0;(i=_.next())&&!i.done;){if(!a[A]&&r.equals(h.value,i.value,h.value,i.value,e,t,r)){w=a[A]=!0;break}A++}if(!w)return!1}return!0}function ZOe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function YOe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function eee(e,t,r,n){return(n===BOe||n===FOe||n===zOe)&&(e.$$typeof||t.$$typeof)?!0:LOe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var XOe="[object Arguments]",JOe="[object Boolean]",QOe="[object Date]",eRe="[object Error]",tRe="[object Map]",rRe="[object Number]",nRe="[object Object]",iRe="[object RegExp]",aRe="[object Set]",oRe="[object String]",sRe="[object URL]",lRe=Array.isArray,Qq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,eG=Object.assign,cRe=Object.prototype.toString.call.bind(Object.prototype.toString);function uRe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,l=e.areMapsEqual,h=e.areNumbersEqual,i=e.areObjectsEqual,_=e.arePrimitiveWrappersEqual,w=e.areRegExpsEqual,A=e.areSetsEqual,C=e.areTypedArraysEqual,R=e.areUrlsEqual;return function(V,U,G){if(V===U)return!0;if(V==null||U==null)return!1;var H=typeof V;if(H!==typeof U)return!1;if(H!=="object")return H==="number"?h(V,U,G):H==="function"?a(V,U,G):!1;var J=V.constructor;if(J!==U.constructor)return!1;if(J===Object)return i(V,U,G);if(lRe(V))return t(V,U,G);if(Qq!=null&&Qq(V))return C(V,U,G);if(J===Date)return r(V,U,G);if(J===RegExp)return w(V,U,G);if(J===Map)return l(V,U,G);if(J===Set)return A(V,U,G);var Q=cRe(V);return Q===QOe?r(V,U,G):Q===iRe?w(V,U,G):Q===tRe?l(V,U,G):Q===aRe?A(V,U,G):Q===nRe?typeof V.then!="function"&&typeof U.then!="function"&&i(V,U,G):Q===sRe?R(V,U,G):Q===eRe?n(V,U,G):Q===XOe?i(V,U,G):Q===JOe||Q===rRe||Q===oRe?_(V,U,G):!1}}function dRe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?qb:VOe,areDatesEqual:UOe,areErrorsEqual:$Oe,areFunctionsEqual:qOe,areMapsEqual:n?Wq(Xq,qb):Xq,areNumbersEqual:GOe,areObjectsEqual:n?qb:KOe,arePrimitiveWrappersEqual:WOe,areRegExpsEqual:HOe,areSetsEqual:n?Wq(Jq,qb):Jq,areTypedArraysEqual:n?qb:ZOe,areUrlsEqual:YOe};if(r&&(a=eG({},a,r(a))),t){var l=H2(a.areArraysEqual),h=H2(a.areMapsEqual),i=H2(a.areObjectsEqual),_=H2(a.areSetsEqual);a=eG({},a,{areArraysEqual:l,areMapsEqual:h,areObjectsEqual:i,areSetsEqual:_})}return a}function hRe(e){return function(t,r,n,a,l,h,i){return e(t,r,i)}}function fRe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,l=e.strict;if(n)return function(_,w){var A=n(),C=A.cache,R=C===void 0?t?new WeakMap:void 0:C,z=A.meta;return r(_,w,{cache:R,equals:a,meta:z,strict:l})};if(t)return function(_,w){return r(_,w,{cache:new WeakMap,equals:a,meta:void 0,strict:l})};var h={cache:void 0,equals:a,meta:void 0,strict:l};return function(_,w){return r(_,w,h)}}var pRe=Xg();Xg({strict:!0});Xg({circular:!0});Xg({circular:!0,strict:!0});Xg({createInternalComparator:function(){return Xv}});Xg({strict:!0,createInternalComparator:function(){return Xv}});Xg({circular:!0,createInternalComparator:function(){return Xv}});Xg({circular:!0,createInternalComparator:function(){return Xv},strict:!0});function Xg(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,l=e.strict,h=l===void 0?!1:l,i=dRe(e),_=uRe(i),w=n?n(_):hRe(_);return fRe({circular:r,comparator:_,createState:a,equals:w,strict:h})}function mRe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function tG(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(l){r<0&&(r=l),l-r>t?(e(l),r=-1):mRe(a)};requestAnimationFrame(n)}function gI(e){"@babel/helpers - typeof";return gI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gI(e)}function gRe(e){return xRe(e)||_Re(e)||vRe(e)||yRe()}function yRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vRe(e,t){if(e){if(typeof e=="string")return rG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rG(e,t)}}function rG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Re(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xRe(e){if(Array.isArray(e))return e}function bRe(){var e={},t=function(){return null},r=!1,n=function a(l){if(!r){if(Array.isArray(l)){if(!l.length)return;var h=l,i=gRe(h),_=i[0],w=i.slice(1);if(typeof _=="number"){tG(a.bind(null,w),_);return}a(_),tG(a.bind(null,w));return}gI(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){r=!0},start:function(l){r=!1,n(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function nG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nG(Object(r),!0).forEach(function(n){tee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tee(e,t,r){return t=wRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wRe(e){var t=SRe(e,"string");return xw(t)==="symbol"?t:String(t)}function SRe(e,t){if(xw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ARe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(l){return a.includes(l)})})},TRe=function(t){return t},PRe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},p1=function(t,r){return Object.keys(r).reduce(function(n,a){return iG(iG({},n),{},tee({},a,t(a,r[a])))},{})},aG=function(t,r,n){return t.map(function(a){return"".concat(PRe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function ERe(e,t){return ORe(e)||MRe(e,t)||ree(e,t)||CRe()}function CRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function ORe(e){if(Array.isArray(e))return e}function RRe(e){return NRe(e)||jRe(e)||ree(e)||kRe()}function kRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ree(e,t){if(e){if(typeof e=="string")return yI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yI(e,t)}}function jRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NRe(e){if(Array.isArray(e))return yI(e)}function yI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ET=1e-4,nee=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},iee=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},oG=function(t,r){return function(n){var a=nee(t,r);return iee(a,n)}},IRe=function(t,r){return function(n){var a=nee(t,r),l=[].concat(RRe(a.map(function(h,i){return h*i}).slice(1)),[0]);return iee(l,n)}},sG=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],l=r[1],h=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,l=0,h=1,i=1;break;case"ease":a=.25,l=.1,h=.25,i=1;break;case"ease-in":a=.42,l=0,h=1,i=1;break;case"ease-out":a=.42,l=0,h=.58,i=1;break;case"ease-in-out":a=0,l=0,h=.58,i=1;break;default:{var _=r[0].split("(");if(_[0]==="cubic-bezier"&&_[1].split(")")[0].split(",").length===4){var w=_[1].split(")")[0].split(",").map(function(G){return parseFloat(G)}),A=ERe(w,4);a=A[0],l=A[1],h=A[2],i=A[3]}}}var C=oG(a,h),R=oG(l,i),z=IRe(a,h),V=function(H){return H>1?1:H<0?0:H},U=function(H){for(var J=H>1?1:H,Q=J,le=0;le<8;++le){var ne=C(Q)-J,de=z(Q);if(Math.abs(ne-J)<ET||de<ET)return R(Q);Q=V(Q-ne/de)}return R(Q)};return U.isStepper=!1,U},DRe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,l=a===void 0?8:a,h=t.dt,i=h===void 0?17:h,_=function(A,C,R){var z=-(A-C)*n,V=R*l,U=R+(z-V)*i/1e3,G=R*i/1e3+A;return Math.abs(G-C)<ET&&Math.abs(U)<ET?[C,0]:[G,U]};return _.isStepper=!0,_.dt=i,_},LRe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return sG(a);case"spring":return DRe();default:if(a.split("(")[0]==="cubic-bezier")return sG(a)}return typeof a=="function"?a:null};function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function lG(e){return BRe(e)||FRe(e)||aee(e)||zRe()}function zRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FRe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BRe(e){if(Array.isArray(e))return _I(e)}function cG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cG(Object(r),!0).forEach(function(n){vI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vI(e,t,r){return t=VRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VRe(e){var t=URe(e,"string");return bw(t)==="symbol"?t:String(t)}function URe(e,t){if(bw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Re(e,t){return KRe(e)||GRe(e,t)||aee(e,t)||qRe()}function qRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aee(e,t){if(e){if(typeof e=="string")return _I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _I(e,t)}}function _I(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function KRe(e){if(Array.isArray(e))return e}var CT=function(t,r,n){return t+(r-t)*n},xI=function(t){var r=t.from,n=t.to;return r!==n},WRe=function e(t,r,n){var a=p1(function(l,h){if(xI(h)){var i=t(h.from,h.to,h.velocity),_=$Re(i,2),w=_[0],A=_[1];return yl(yl({},h),{},{from:w,velocity:A})}return h},r);return n<1?p1(function(l,h){return xI(h)?yl(yl({},h),{},{velocity:CT(h.velocity,a[l].velocity,n),from:CT(h.from,a[l].from,n)}):h},r):e(t,a,n-1)};const HRe=function(e,t,r,n,a){var l=ARe(e,t),h=l.reduce(function(G,H){return yl(yl({},G),{},vI({},H,[e[H],t[H]]))},{}),i=l.reduce(function(G,H){return yl(yl({},G),{},vI({},H,{from:e[H],velocity:0,to:t[H]}))},{}),_=-1,w,A,C=function(){return null},R=function(){return p1(function(H,J){return J.from},i)},z=function(){return!Object.values(i).filter(xI).length},V=function(H){w||(w=H);var J=H-w,Q=J/r.dt;i=WRe(r,i,Q),a(yl(yl(yl({},e),t),R())),w=H,z()||(_=requestAnimationFrame(C))},U=function(H){A||(A=H);var J=(H-A)/n,Q=p1(function(ne,de){return CT.apply(void 0,lG(de).concat([r(J)]))},h);if(a(yl(yl(yl({},e),t),Q)),J<1)_=requestAnimationFrame(C);else{var le=p1(function(ne,de){return CT.apply(void 0,lG(de).concat([r(1)]))},h);a(yl(yl(yl({},e),t),le))}};return C=r.isStepper?V:U,function(){return requestAnimationFrame(C),function(){cancelAnimationFrame(_)}}};function Dx(e){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(e)}var ZRe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function YRe(e,t){if(e==null)return{};var r=XRe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XRe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Wk(e){return tke(e)||eke(e)||QRe(e)||JRe()}function JRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QRe(e,t){if(e){if(typeof e=="string")return bI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bI(e,t)}}function eke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tke(e){if(Array.isArray(e))return bI(e)}function bI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uG(Object(r),!0).forEach(function(n){n1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n1(e,t,r){return t=oee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oee(n.key),n)}}function ike(e,t,r){return t&&nke(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function oee(e){var t=ake(e,"string");return Dx(t)==="symbol"?t:String(t)}function ake(e,t){if(Dx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wI(e,t)}function wI(e,t){return wI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},wI(e,t)}function ske(e){var t=lke();return function(){var n=MT(e),a;if(t){var l=MT(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return SI(this,a)}}function SI(e,t){if(t&&(Dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AI(e)}function AI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MT(e){return MT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MT(e)}var Bc=function(e){oke(r,e);var t=ske(r);function r(n,a){var l;rke(this,r),l=t.call(this,n,a);var h=l.props,i=h.isActive,_=h.attributeName,w=h.from,A=h.to,C=h.steps,R=h.children,z=h.duration;if(l.handleStyleChange=l.handleStyleChange.bind(AI(l)),l.changeStyle=l.changeStyle.bind(AI(l)),!i||z<=0)return l.state={style:{}},typeof R=="function"&&(l.state={style:A}),SI(l);if(C&&C.length)l.state={style:C[0].style};else if(w){if(typeof R=="function")return l.state={style:w},SI(l);l.state={style:_?n1({},_,w):w}}else l.state={style:{}};return l}return ike(r,[{key:"componentDidMount",value:function(){var a=this.props,l=a.isActive,h=a.canBegin;this.mounted=!0,!(!l||!h)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var l=this.props,h=l.isActive,i=l.canBegin,_=l.attributeName,w=l.shouldReAnimate,A=l.to,C=l.from,R=this.state.style;if(i){if(!h){var z={style:_?n1({},_,A):A};this.state&&R&&(_&&R[_]!==A||!_&&R!==A)&&this.setState(z);return}if(!(pRe(a.to,A)&&a.canBegin&&a.isActive)){var V=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var U=V||w?C:a.to;if(this.state&&R){var G={style:_?n1({},_,U):U};(_&&R[_]!==U||!_&&R!==U)&&this.setState(G)}this.runAnimation(xh(xh({},this.props),{},{from:U,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var l=this,h=a.from,i=a.to,_=a.duration,w=a.easing,A=a.begin,C=a.onAnimationEnd,R=a.onAnimationStart,z=HRe(h,i,LRe(w),_,this.changeStyle),V=function(){l.stopJSAnimation=z()};this.manager.start([R,A,V,_,C])}},{key:"runStepAnimation",value:function(a){var l=this,h=a.steps,i=a.begin,_=a.onAnimationStart,w=h[0],A=w.style,C=w.duration,R=C===void 0?0:C,z=function(U,G,H){if(H===0)return U;var J=G.duration,Q=G.easing,le=Q===void 0?"ease":Q,ne=G.style,de=G.properties,ue=G.onAnimationEnd,ve=H>0?h[H-1]:G,Ae=de||Object.keys(ne);if(typeof le=="function"||le==="spring")return[].concat(Wk(U),[l.runJSAnimation.bind(l,{from:ve.style,to:ne,duration:J,easing:le}),J]);var Oe=aG(Ae,J,le),Se=xh(xh(xh({},ve.style),ne),{},{transition:Oe});return[].concat(Wk(U),[Se,J,ue]).filter(TRe)};return this.manager.start([_].concat(Wk(h.reduce(z,[A,Math.max(R,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=bRe());var l=a.begin,h=a.duration,i=a.attributeName,_=a.to,w=a.easing,A=a.onAnimationStart,C=a.onAnimationEnd,R=a.steps,z=a.children,V=this.manager;if(this.unSubscribe=V.subscribe(this.handleStyleChange),typeof w=="function"||typeof z=="function"||w==="spring"){this.runJSAnimation(a);return}if(R.length>1){this.runStepAnimation(a);return}var U=i?n1({},i,_):_,G=aG(Object.keys(U),h,w);V.start([A,l,xh(xh({},U),{},{transition:G}),h,C])}},{key:"render",value:function(){var a=this.props,l=a.children;a.begin;var h=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var _=YRe(a,ZRe),w=K.Children.count(l),A=this.state.style;if(typeof l=="function")return l(A);if(!i||w===0||h<=0)return l;var C=function(z){var V=z.props,U=V.style,G=U===void 0?{}:U,H=V.className,J=K.cloneElement(z,xh(xh({},_),{},{style:xh(xh({},G),A),className:H}));return J};return w===1?C(K.Children.only(l)):Pe.createElement("div",null,K.Children.map(l,function(R){return C(R)}))}}]),r}(K.PureComponent);Bc.displayName="Animate";Bc.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Bc.propTypes={from:xa.oneOfType([xa.object,xa.string]),to:xa.oneOfType([xa.object,xa.string]),attributeName:xa.string,duration:xa.number,begin:xa.number,easing:xa.oneOfType([xa.string,xa.func]),steps:xa.arrayOf(xa.shape({duration:xa.number.isRequired,style:xa.object.isRequired,easing:xa.oneOfType([xa.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),xa.func]),properties:xa.arrayOf("string"),onAnimationEnd:xa.func})),children:xa.oneOfType([xa.node,xa.func]),isActive:xa.bool,canBegin:xa.bool,onAnimationEnd:xa.func,shouldReAnimate:xa.bool,onAnimationStart:xa.func,onAnimationReStart:xa.func};function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function OT(){return OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OT.apply(this,arguments)}function cke(e,t){return fke(e)||hke(e,t)||dke(e,t)||uke()}function uke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dke(e,t){if(e){if(typeof e=="string")return dG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dG(e,t)}}function dG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function hke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function fke(e){if(Array.isArray(e))return e}function hG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hG(Object(r),!0).forEach(function(n){pke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pke(e,t,r){return t=mke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mke(e){var t=gke(e,"string");return ww(t)=="symbol"?t:t+""}function gke(e,t){if(ww(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ww(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pG=function(t,r,n,a,l){var h=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,_=n>=0?1:-1,w=a>=0&&n>=0||a<0&&n<0?1:0,A;if(h>0&&l instanceof Array){for(var C=[0,0,0,0],R=0,z=4;R<z;R++)C[R]=l[R]>h?h:l[R];A="M".concat(t,",").concat(r+i*C[0]),C[0]>0&&(A+="A ".concat(C[0],",").concat(C[0],",0,0,").concat(w,",").concat(t+_*C[0],",").concat(r)),A+="L ".concat(t+n-_*C[1],",").concat(r),C[1]>0&&(A+="A ".concat(C[1],",").concat(C[1],",0,0,").concat(w,`,
        `).concat(t+n,",").concat(r+i*C[1])),A+="L ".concat(t+n,",").concat(r+a-i*C[2]),C[2]>0&&(A+="A ".concat(C[2],",").concat(C[2],",0,0,").concat(w,`,
        `).concat(t+n-_*C[2],",").concat(r+a)),A+="L ".concat(t+_*C[3],",").concat(r+a),C[3]>0&&(A+="A ".concat(C[3],",").concat(C[3],",0,0,").concat(w,`,
        `).concat(t,",").concat(r+a-i*C[3])),A+="Z"}else if(h>0&&l===+l&&l>0){var V=Math.min(h,l);A="M ".concat(t,",").concat(r+i*V,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t+_*V,",").concat(r,`
            L `).concat(t+n-_*V,",").concat(r,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t+n,",").concat(r+i*V,`
            L `).concat(t+n,",").concat(r+a-i*V,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t+n-_*V,",").concat(r+a,`
            L `).concat(t+_*V,",").concat(r+a,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t,",").concat(r+a-i*V," Z")}else A="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return A},yke=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,l=r.x,h=r.y,i=r.width,_=r.height;if(Math.abs(i)>0&&Math.abs(_)>0){var w=Math.min(l,l+i),A=Math.max(l,l+i),C=Math.min(h,h+_),R=Math.max(h,h+_);return n>=w&&n<=A&&a>=C&&a<=R}return!1},vke={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},WL=function(t){var r=fG(fG({},vke),t),n=K.useRef(),a=K.useState(-1),l=cke(a,2),h=l[0],i=l[1];K.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var le=n.current.getTotalLength();le&&i(le)}catch{}},[]);var _=r.x,w=r.y,A=r.width,C=r.height,R=r.radius,z=r.className,V=r.animationEasing,U=r.animationDuration,G=r.animationBegin,H=r.isAnimationActive,J=r.isUpdateAnimationActive;if(_!==+_||w!==+w||A!==+A||C!==+C||A===0||C===0)return null;var Q=Xn("recharts-rectangle",z);return J?Pe.createElement(Bc,{canBegin:h>0,from:{width:A,height:C,x:_,y:w},to:{width:A,height:C,x:_,y:w},duration:U,animationEasing:V,isActive:J},function(le){var ne=le.width,de=le.height,ue=le.x,ve=le.y;return Pe.createElement(Bc,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:G,duration:U,isActive:H,easing:V},Pe.createElement("path",OT({},on(r,!0),{className:Q,d:pG(ue,ve,ne,de,R),ref:n})))}):Pe.createElement("path",OT({},on(r,!0),{className:Q,d:pG(_,w,A,C,R)}))},_ke=["points","className","baseLinePoints","connectNulls"];function ax(){return ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ax.apply(this,arguments)}function xke(e,t){if(e==null)return{};var r=bke(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function bke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function mG(e){return Tke(e)||Ake(e)||Ske(e)||wke()}function wke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ske(e,t){if(e){if(typeof e=="string")return TI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TI(e,t)}}function Ake(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tke(e){if(Array.isArray(e))return TI(e)}function TI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gG=function(t){return t&&t.x===+t.x&&t.y===+t.y},Pke=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){gG(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),gG(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},m1=function(t,r){var n=Pke(t);r&&(n=[n.reduce(function(l,h){return[].concat(mG(l),mG(h))},[])]);var a=n.map(function(l){return l.reduce(function(h,i,_){return"".concat(h).concat(_===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},Eke=function(t,r,n){var a=m1(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(m1(r.reverse(),n).slice(1))},see=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,l=t.connectNulls,h=xke(t,_ke);if(!r||!r.length)return null;var i=Xn("recharts-polygon",n);if(a&&a.length){var _=h.stroke&&h.stroke!=="none",w=Eke(r,a,l);return Pe.createElement("g",{className:i},Pe.createElement("path",ax({},on(h,!0),{fill:w.slice(-1)==="Z"?h.fill:"none",stroke:"none",d:w})),_?Pe.createElement("path",ax({},on(h,!0),{fill:"none",d:m1(r,l)})):null,_?Pe.createElement("path",ax({},on(h,!0),{fill:"none",d:m1(a,l)})):null)}var A=m1(r,l);return Pe.createElement("path",ax({},on(h,!0),{fill:A.slice(-1)==="Z"?h.fill:"none",className:i,d:A}))};function PI(){return PI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PI.apply(this,arguments)}var k0=function(t){var r=t.cx,n=t.cy,a=t.r,l=t.className,h=Xn("recharts-dot",l);return r===+r&&n===+n&&a===+a?Pe.createElement("circle",PI({},on(t,!1),QA(t),{className:h,cx:r,cy:n,r:a})):null};function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}var Cke=["x","y","top","left","width","height","className"];function EI(){return EI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EI.apply(this,arguments)}function yG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yG(Object(r),!0).forEach(function(n){Oke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oke(e,t,r){return t=Rke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rke(e){var t=kke(e,"string");return Sw(t)=="symbol"?t:t+""}function kke(e,t){if(Sw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jke(e,t){if(e==null)return{};var r=Nke(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Nke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Ike=function(t,r,n,a,l,h){return"M".concat(t,",").concat(l,"v").concat(a,"M").concat(h,",").concat(r,"h").concat(n)},Dke=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,l=a===void 0?0:a,h=t.top,i=h===void 0?0:h,_=t.left,w=_===void 0?0:_,A=t.width,C=A===void 0?0:A,R=t.height,z=R===void 0?0:R,V=t.className,U=jke(t,Cke),G=Mke({x:n,y:l,top:i,left:w,width:C,height:z},U);return!Ir(n)||!Ir(l)||!Ir(C)||!Ir(z)||!Ir(i)||!Ir(w)?null:Pe.createElement("path",EI({},on(G,!0),{className:Xn("recharts-cross",V),d:Ike(n,l,C,z,i,w)}))},Lke=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function zke(e,t){if(e==null)return{};var r=Fke(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gm(){return gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gm.apply(this,arguments)}function vG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vG(Object(r),!0).forEach(function(n){Bke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bke(e,t,r){return t=Vke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vke(e){var t=Uke(e,"string");return Aw(t)=="symbol"?t:t+""}function Uke(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $ke=function(t,r,n,a){var l="";return a.forEach(function(h,i){var _=sa(r,n,t,h);i?l+="L ".concat(_.x,",").concat(_.y):l+="M ".concat(_.x,",").concat(_.y)}),l+="Z",l},qke=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,l=t.outerRadius,h=t.polarAngles,i=t.radialLines;if(!h||!h.length||!i)return null;var _=Tw({stroke:"#ccc"},on(t,!1));return Pe.createElement("g",{className:"recharts-polar-grid-angle"},h.map(function(w){var A=sa(r,n,a,w),C=sa(r,n,l,w);return Pe.createElement("line",gm({},_,{key:"line-".concat(w),x1:A.x,y1:A.y,x2:C.x,y2:C.y}))}))},Gke=function(t){var r=t.cx,n=t.cy,a=t.radius,l=t.index,h=Tw(Tw({stroke:"#ccc"},on(t,!1)),{},{fill:"none"});return Pe.createElement("circle",gm({},h,{className:Xn("recharts-polar-grid-concentric-circle",t.className),key:"circle-".concat(l),cx:r,cy:n,r:a}))},Kke=function(t){var r=t.radius,n=t.index,a=Tw(Tw({stroke:"#ccc"},on(t,!1)),{},{fill:"none"});return Pe.createElement("path",gm({},a,{className:Xn("recharts-polar-grid-concentric-polygon",t.className),key:"path-".concat(n),d:$ke(r,t.cx,t.cy,t.polarAngles)}))},Wke=function(t){var r=t.polarRadius,n=t.gridType;return!r||!r.length?null:Pe.createElement("g",{className:"recharts-polar-grid-concentric"},r.map(function(a,l){var h=l;return n==="circle"?Pe.createElement(Gke,gm({key:h},t,{radius:a,index:l})):Pe.createElement(Kke,gm({key:h},t,{radius:a,index:l}))}))},lee=function(t){var r=t.cx,n=r===void 0?0:r,a=t.cy,l=a===void 0?0:a,h=t.innerRadius,i=h===void 0?0:h,_=t.outerRadius,w=_===void 0?0:_,A=t.gridType,C=A===void 0?"polygon":A,R=t.radialLines,z=R===void 0?!0:R,V=zke(t,Lke);return w<=0?null:Pe.createElement("g",{className:"recharts-polar-grid"},Pe.createElement(qke,gm({cx:n,cy:l,innerRadius:i,outerRadius:w,gridType:C,radialLines:z},V)),Pe.createElement(Wke,gm({cx:n,cy:l,innerRadius:i,outerRadius:w,gridType:C,radialLines:z},V)))};lee.displayName="PolarGrid";var Hk,_G;function Hke(){if(_G)return Hk;_G=1;var e=tE(),t=vQ(),r=tp();function n(a,l){return a&&a.length?e(a,r(l,2),t):void 0}return Hk=n,Hk}var Zke=Hke();const Yke=ta(Zke);var Zk,xG;function Xke(){if(xG)return Zk;xG=1;var e=tE(),t=tp(),r=_Q();function n(a,l){return a&&a.length?e(a,t(l,2),r):void 0}return Zk=n,Zk}var Jke=Xke();const Qke=ta(Jke);var eje=["cx","cy","angle","ticks","axisLine"],tje=["ticks","tick","angle","tickFormatter","stroke"];function Lx(e){"@babel/helpers - typeof";return Lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lx(e)}function g1(){return g1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g1.apply(this,arguments)}function bG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ev(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bG(Object(r),!0).forEach(function(n){aE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wG(e,t){if(e==null)return{};var r=rje(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function rje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function nje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uee(n.key),n)}}function ije(e,t,r){return t&&SG(e.prototype,t),r&&SG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aje(e,t,r){return t=RT(t),oje(e,cee()?Reflect.construct(t,r||[],RT(e).constructor):t.apply(e,r))}function oje(e,t){if(t&&(Lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sje(e)}function sje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cee=function(){return!!e})()}function RT(e){return RT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RT(e)}function lje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CI(e,t)}function CI(e,t){return CI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},CI(e,t)}function aE(e,t,r){return t=uee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uee(e){var t=cje(e,"string");return Lx(t)=="symbol"?t:t+""}function cje(e,t){if(Lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var j0=function(e){function t(){return nje(this,t),aje(this,t,arguments)}return lje(t,e),ije(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,l=this.props,h=l.angle,i=l.cx,_=l.cy;return sa(i,_,a,h)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,l=n.cy,h=n.angle,i=n.ticks,_=Yke(i,function(A){return A.coordinate||0}),w=Qke(i,function(A){return A.coordinate||0});return{cx:a,cy:l,startAngle:h,endAngle:h,innerRadius:w.coordinate||0,outerRadius:_.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,l=n.cy,h=n.angle,i=n.ticks,_=n.axisLine,w=wG(n,eje),A=i.reduce(function(V,U){return[Math.min(V[0],U.coordinate),Math.max(V[1],U.coordinate)]},[1/0,-1/0]),C=sa(a,l,A[0],h),R=sa(a,l,A[1],h),z=ev(ev(ev({},on(w,!1)),{},{fill:"none"},on(_,!1)),{},{x1:C.x,y1:C.y,x2:R.x,y2:R.y});return Pe.createElement("line",g1({className:"recharts-polar-radius-axis-line"},z))}},{key:"renderTicks",value:function(){var n=this,a=this.props,l=a.ticks,h=a.tick,i=a.angle,_=a.tickFormatter,w=a.stroke,A=wG(a,tje),C=this.getTickTextAnchor(),R=on(A,!1),z=on(h,!1),V=l.map(function(U,G){var H=n.getTickValueCoord(U),J=ev(ev(ev(ev({textAnchor:C,transform:"rotate(".concat(90-i,", ").concat(H.x,", ").concat(H.y,")")},R),{},{stroke:"none",fill:w},z),{},{index:G},H),{},{payload:U});return Pe.createElement(ci,g1({className:Xn("recharts-polar-radius-axis-tick",ZQ(h)),key:"tick-".concat(U.coordinate)},Wf(n.props,U,G)),t.renderTickItem(h,J,_?_(U.value,G):U.value))});return Pe.createElement(ci,{className:"recharts-polar-radius-axis-ticks"},V)}},{key:"render",value:function(){var n=this.props,a=n.ticks,l=n.axisLine,h=n.tick;return!a||!a.length?null:Pe.createElement(ci,{className:Xn("recharts-polar-radius-axis",this.props.className)},l&&this.renderAxisLine(),h&&this.renderTicks(),el.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,l){var h;return Pe.isValidElement(n)?h=Pe.cloneElement(n,a):Cn(n)?h=n(a):h=Pe.createElement(Rv,g1({},a,{className:"recharts-polar-radius-axis-tick-value"}),l),h}}])}(K.PureComponent);aE(j0,"displayName","PolarRadiusAxis");aE(j0,"axisType","radiusAxis");aE(j0,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function lv(){return lv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lv.apply(this,arguments)}function AG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AG(Object(r),!0).forEach(function(n){oE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function TG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hee(n.key),n)}}function dje(e,t,r){return t&&TG(e.prototype,t),r&&TG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hje(e,t,r){return t=kT(t),fje(e,dee()?Reflect.construct(t,r||[],kT(e).constructor):t.apply(e,r))}function fje(e,t){if(t&&(zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pje(e)}function pje(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dee=function(){return!!e})()}function kT(e){return kT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kT(e)}function mje(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&MI(e,t)}function MI(e,t){return MI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},MI(e,t)}function oE(e,t,r){return t=hee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hee(e){var t=gje(e,"string");return zx(t)=="symbol"?t:t+""}function gje(e,t){if(zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var yje=Math.PI/180,vje=1e-5,Jv=function(e){function t(){return uje(this,t),hje(this,t,arguments)}return mje(t,e),dje(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,l=a.cx,h=a.cy,i=a.radius,_=a.orientation,w=a.tickSize,A=w||8,C=sa(l,h,i,n.coordinate),R=sa(l,h,i+(_==="inner"?-1:1)*A,n.coordinate);return{x1:C.x,y1:C.y,x2:R.x,y2:R.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,l=Math.cos(-n.coordinate*yje),h;return l>vje?h=a==="outer"?"start":"end":l<-1e-5?h=a==="outer"?"end":"start":h="middle",h}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,l=n.cy,h=n.radius,i=n.axisLine,_=n.axisLineType,w=tv(tv({},on(this.props,!1)),{},{fill:"none"},on(i,!1));if(_==="circle")return Pe.createElement(k0,lv({className:"recharts-polar-angle-axis-line"},w,{cx:a,cy:l,r:h}));var A=this.props.ticks,C=A.map(function(R){return sa(a,l,h,R.coordinate)});return Pe.createElement(see,lv({className:"recharts-polar-angle-axis-line"},w,{points:C}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,l=a.ticks,h=a.tick,i=a.tickLine,_=a.tickFormatter,w=a.stroke,A=on(this.props,!1),C=on(h,!1),R=tv(tv({},A),{},{fill:"none"},on(i,!1)),z=l.map(function(V,U){var G=n.getTickLineCoord(V),H=n.getTickTextAnchor(V),J=tv(tv(tv({textAnchor:H},A),{},{stroke:"none",fill:w},C),{},{index:U,payload:V,x:G.x2,y:G.y2});return Pe.createElement(ci,lv({className:Xn("recharts-polar-angle-axis-tick",ZQ(h)),key:"tick-".concat(V.coordinate)},Wf(n.props,V,U)),i&&Pe.createElement("line",lv({className:"recharts-polar-angle-axis-tick-line"},R,G)),h&&t.renderTickItem(h,J,_?_(V.value,U):V.value))});return Pe.createElement(ci,{className:"recharts-polar-angle-axis-ticks"},z)}},{key:"render",value:function(){var n=this.props,a=n.ticks,l=n.radius,h=n.axisLine;return l<=0||!a||!a.length?null:Pe.createElement(ci,{className:Xn("recharts-polar-angle-axis",this.props.className)},h&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,l){var h;return Pe.isValidElement(n)?h=Pe.cloneElement(n,a):Cn(n)?h=n(a):h=Pe.createElement(Rv,lv({},a,{className:"recharts-polar-angle-axis-tick-value"}),l),h}}])}(K.PureComponent);oE(Jv,"displayName","PolarAngleAxis");oE(Jv,"axisType","angleAxis");oE(Jv,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var Yk,PG;function _je(){if(PG)return Yk;PG=1;var e=yJ(),t=e(Object.getPrototypeOf,Object);return Yk=t,Yk}var Xk,EG;function xje(){if(EG)return Xk;EG=1;var e=ym(),t=_je(),r=vm(),n="[object Object]",a=Function.prototype,l=Object.prototype,h=a.toString,i=l.hasOwnProperty,_=h.call(Object);function w(A){if(!r(A)||e(A)!=n)return!1;var C=t(A);if(C===null)return!0;var R=i.call(C,"constructor")&&C.constructor;return typeof R=="function"&&R instanceof R&&h.call(R)==_}return Xk=w,Xk}var bje=xje();const wje=ta(bje);var Jk,CG;function Sje(){if(CG)return Jk;CG=1;var e=ym(),t=vm(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return Jk=n,Jk}var Aje=Sje();const Tje=ta(Aje);function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function jT(){return jT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jT.apply(this,arguments)}function Pje(e,t){return Oje(e)||Mje(e,t)||Cje(e,t)||Eje()}function Eje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Cje(e,t){if(e){if(typeof e=="string")return MG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MG(e,t)}}function MG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mje(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function Oje(e){if(Array.isArray(e))return e}function OG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function RG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OG(Object(r),!0).forEach(function(n){Rje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rje(e,t,r){return t=kje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kje(e){var t=jje(e,"string");return Pw(t)=="symbol"?t:t+""}function jje(e,t){if(Pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kG=function(t,r,n,a,l){var h=n-a,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-h/2,",").concat(r+l),i+="L ".concat(t+n-h/2-a,",").concat(r+l),i+="L ".concat(t,",").concat(r," Z"),i},Nje={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ije=function(t){var r=RG(RG({},Nje),t),n=K.useRef(),a=K.useState(-1),l=Pje(a,2),h=l[0],i=l[1];K.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var Q=n.current.getTotalLength();Q&&i(Q)}catch{}},[]);var _=r.x,w=r.y,A=r.upperWidth,C=r.lowerWidth,R=r.height,z=r.className,V=r.animationEasing,U=r.animationDuration,G=r.animationBegin,H=r.isUpdateAnimationActive;if(_!==+_||w!==+w||A!==+A||C!==+C||R!==+R||A===0&&C===0||R===0)return null;var J=Xn("recharts-trapezoid",z);return H?Pe.createElement(Bc,{canBegin:h>0,from:{upperWidth:0,lowerWidth:0,height:R,x:_,y:w},to:{upperWidth:A,lowerWidth:C,height:R,x:_,y:w},duration:U,animationEasing:V,isActive:H},function(Q){var le=Q.upperWidth,ne=Q.lowerWidth,de=Q.height,ue=Q.x,ve=Q.y;return Pe.createElement(Bc,{canBegin:h>0,from:"0px ".concat(h===-1?1:h,"px"),to:"".concat(h,"px 0px"),attributeName:"strokeDasharray",begin:G,duration:U,easing:V},Pe.createElement("path",jT({},on(r,!0),{className:J,d:kG(ue,ve,le,ne,de),ref:n})))}):Pe.createElement("g",null,Pe.createElement("path",jT({},on(r,!0),{className:J,d:kG(_,w,A,C,R)})))},Dje=["option","shapeType","propTransformer","activeClassName","isActive"];function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function Lje(e,t){if(e==null)return{};var r=zje(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function zje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function NT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jG(Object(r),!0).forEach(function(n){Fje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fje(e,t,r){return t=Bje(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bje(e){var t=Vje(e,"string");return Ew(t)=="symbol"?t:t+""}function Vje(e,t){if(Ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uje(e,t){return NT(NT({},t),e)}function $je(e,t){return e==="symbols"}function NG(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Pe.createElement(WL,r);case"trapezoid":return Pe.createElement(Ije,r);case"sector":return Pe.createElement(QQ,r);case"symbols":if($je(t))return Pe.createElement(GP,r);break;default:return null}}function qje(e){return K.isValidElement(e)?e.props:e}function Cw(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?Uje:n,l=e.activeClassName,h=l===void 0?"recharts-active-shape":l,i=e.isActive,_=Lje(e,Dje),w;if(K.isValidElement(t))w=K.cloneElement(t,NT(NT({},_),qje(t)));else if(Cn(t))w=t(_);else if(wje(t)&&!Tje(t)){var A=a(t,_);w=Pe.createElement(NG,{shapeType:r,elementProps:A})}else{var C=_;w=Pe.createElement(NG,{shapeType:r,elementProps:C})}return i?Pe.createElement(ci,{className:h},w):w}function sE(e,t){return t!=null&&"trapezoids"in e.props}function lE(e,t){return t!=null&&"sectors"in e.props}function Mw(e,t){return t!=null&&"points"in e.props}function Gje(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,l=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&l}function Kje(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function Wje(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function Hje(e,t){var r;return sE(e,t)?r=Gje:lE(e,t)?r=Kje:Mw(e,t)&&(r=Wje),r}function Zje(e,t){var r;return sE(e,t)?r="trapezoids":lE(e,t)?r="sectors":Mw(e,t)&&(r="points"),r}function Yje(e,t){if(sE(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(lE(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Mw(e,t)?t.payload:{}}function Xje(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=Zje(r,t),l=Yje(r,t),h=n.filter(function(_,w){var A=Hf(l,_),C=r.props[a].filter(function(V){var U=Hje(r,t);return U(V,t)}),R=r.props[a].indexOf(C[C.length-1]),z=w===R;return A&&z}),i=n.indexOf(h[h.length-1]);return i}var gA;function Fx(e){"@babel/helpers - typeof";return Fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fx(e)}function ox(){return ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ox.apply(this,arguments)}function IG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IG(Object(r),!0).forEach(function(n){bd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jje(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function DG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pee(n.key),n)}}function Qje(e,t,r){return t&&DG(e.prototype,t),r&&DG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eNe(e,t,r){return t=IT(t),tNe(e,fee()?Reflect.construct(t,r||[],IT(e).constructor):t.apply(e,r))}function tNe(e,t){if(t&&(Fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rNe(e)}function rNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fee=function(){return!!e})()}function IT(e){return IT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},IT(e)}function nNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OI(e,t)}function OI(e,t){return OI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},OI(e,t)}function bd(e,t,r){return t=pee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pee(e){var t=iNe(e,"string");return Fx(t)=="symbol"?t:t+""}function iNe(e,t){if(Fx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rp=function(e){function t(r){var n;return Jje(this,t),n=eNe(this,t,[r]),bd(n,"pieRef",null),bd(n,"sectorRefs",[]),bd(n,"id",Hg("recharts-pie-")),bd(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Cn(a)&&a()}),bd(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Cn(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return nNe(t,e),Qje(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var l=this.props,h=l.label,i=l.labelLine,_=l.dataKey,w=l.valueKey,A=on(this.props,!1),C=on(h,!1),R=on(i,!1),z=h&&h.offsetRadius||20,V=n.map(function(U,G){var H=(U.startAngle+U.endAngle)/2,J=sa(U.cx,U.cy,U.outerRadius+z,H),Q=Ha(Ha(Ha(Ha({},A),U),{},{stroke:"none"},C),{},{index:G,textAnchor:t.getTextAnchor(J.x,U.cx)},J),le=Ha(Ha(Ha(Ha({},A),U),{},{fill:"none",stroke:U.fill},R),{},{index:G,points:[sa(U.cx,U.cy,U.outerRadius,H),J]}),ne=_;return Gn(_)&&Gn(w)?ne="value":Gn(_)&&(ne=w),Pe.createElement(ci,{key:"label-".concat(U.startAngle,"-").concat(U.endAngle,"-").concat(U.midAngle,"-").concat(G)},i&&t.renderLabelLineItem(i,le,"line"),t.renderLabelItem(h,Q,Ia(U,ne)))});return Pe.createElement(ci,{className:"recharts-pie-labels"},V)}},{key:"renderSectorsStatically",value:function(n){var a=this,l=this.props,h=l.activeShape,i=l.blendStroke,_=l.inactiveShape;return n.map(function(w,A){if((w==null?void 0:w.startAngle)===0&&(w==null?void 0:w.endAngle)===0&&n.length!==1)return null;var C=a.isActiveIndex(A),R=_&&a.hasActiveIndex()?_:null,z=C?h:R,V=Ha(Ha({},w),{},{stroke:i?w.fill:w.stroke,tabIndex:-1});return Pe.createElement(ci,ox({ref:function(G){G&&!a.sectorRefs.includes(G)&&a.sectorRefs.push(G)},tabIndex:-1,className:"recharts-pie-sector"},Wf(a.props,w,A),{key:"sector-".concat(w==null?void 0:w.startAngle,"-").concat(w==null?void 0:w.endAngle,"-").concat(w.midAngle,"-").concat(A)}),Pe.createElement(Cw,ox({option:z,isActive:C,shapeType:"sector"},V)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,l=a.sectors,h=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,C=this.state,R=C.prevSectors,z=C.prevIsAnimationActive;return Pe.createElement(Bc,{begin:i,duration:_,isActive:h,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(A,"-").concat(z),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(V){var U=V.t,G=[],H=l&&l[0],J=H.startAngle;return l.forEach(function(Q,le){var ne=R&&R[le],de=le>0?Au(Q,"paddingAngle",0):0;if(ne){var ue=Sa(ne.endAngle-ne.startAngle,Q.endAngle-Q.startAngle),ve=Ha(Ha({},Q),{},{startAngle:J+de,endAngle:J+ue(U)+de});G.push(ve),J=ve.endAngle}else{var Ae=Q.endAngle,Oe=Q.startAngle,Se=Sa(0,Ae-Oe),ke=Se(U),ze=Ha(Ha({},Q),{},{startAngle:J+de,endAngle:J+ke+de});G.push(ze),J=ze.endAngle}}),Pe.createElement(ci,null,n.renderSectorsStatically(G))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(l){if(!l.altKey)switch(l.key){case"ArrowLeft":{var h=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[h].focus(),a.setState({sectorToFocus:h});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,l=n.isAnimationActive,h=this.state.prevSectors;return l&&a&&a.length&&(!h||!Hf(h,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,l=a.hide,h=a.sectors,i=a.className,_=a.label,w=a.cx,A=a.cy,C=a.innerRadius,R=a.outerRadius,z=a.isAnimationActive,V=this.state.isAnimationFinished;if(l||!h||!h.length||!Ir(w)||!Ir(A)||!Ir(C)||!Ir(R))return null;var U=Xn("recharts-pie",i);return Pe.createElement(ci,{tabIndex:this.props.rootTabIndex,className:U,ref:function(H){n.pieRef=H}},this.renderSectors(),_&&this.renderLabels(h),el.renderCallByParent(this.props,null,!1),(!z||V)&&Tu.renderCallByParent(this.props,h,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,l){if(Pe.isValidElement(n))return Pe.cloneElement(n,a);if(Cn(n))return n(a);var h=Xn("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Pe.createElement(Rg,ox({},a,{key:l,type:"linear",className:h}))}},{key:"renderLabelItem",value:function(n,a,l){if(Pe.isValidElement(n))return Pe.cloneElement(n,a);var h=l;if(Cn(n)&&(h=n(a),Pe.isValidElement(h)))return h;var i=Xn("recharts-pie-label-text",typeof n!="boolean"&&!Cn(n)?n.className:"");return Pe.createElement(Rv,ox({},a,{alignmentBaseline:"middle",className:i}),h)}}])}(K.PureComponent);gA=rp;bd(rp,"displayName","Pie");bd(rp,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Wh.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});bd(rp,"parseDeltaAngle",function(e,t){var r=tl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});bd(rp,"getRealPieData",function(e){var t=e.data,r=e.children,n=on(e,!1),a=Bl(r,hm);return t&&t.length?t.map(function(l,h){return Ha(Ha(Ha({payload:l},n),l),a&&a[h]&&a[h].props)}):a&&a.length?a.map(function(l){return Ha(Ha({},n),l.props)}):[]});bd(rp,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,l=t.height,h=HQ(a,l),i=n+sc(e.cx,a,a/2),_=r+sc(e.cy,l,l/2),w=sc(e.innerRadius,h,0),A=sc(e.outerRadius,h,h*.8),C=e.maxRadius||Math.sqrt(a*a+l*l)/2;return{cx:i,cy:_,innerRadius:w,outerRadius:A,maxRadius:C}});bd(rp,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Ha(Ha({},t.type.defaultProps),t.props):t.props,a=gA.getRealPieData(n);if(!a||!a.length)return null;var l=n.cornerRadius,h=n.startAngle,i=n.endAngle,_=n.paddingAngle,w=n.dataKey,A=n.nameKey,C=n.valueKey,R=n.tooltipType,z=Math.abs(n.minAngle),V=gA.parseCoordinateOfPie(n,r),U=gA.parseDeltaAngle(h,i),G=Math.abs(U),H=w;Gn(w)&&Gn(C)?(Rh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H="value"):Gn(w)&&(Rh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H=C);var J=a.filter(function(ve){return Ia(ve,H,0)!==0}).length,Q=(G>=360?J:J-1)*_,le=G-J*z-Q,ne=a.reduce(function(ve,Ae){var Oe=Ia(Ae,H,0);return ve+(Ir(Oe)?Oe:0)},0),de;if(ne>0){var ue;de=a.map(function(ve,Ae){var Oe=Ia(ve,H,0),Se=Ia(ve,A,Ae),ke=(Ir(Oe)?Oe:0)/ne,ze;Ae?ze=ue.endAngle+tl(U)*_*(Oe!==0?1:0):ze=h;var et=ze+tl(U)*((Oe!==0?z:0)+ke*le),je=(ze+et)/2,Ne=(V.innerRadius+V.outerRadius)/2,Ye=[{name:Se,value:Oe,payload:ve,dataKey:H,type:R}],$e=sa(V.cx,V.cy,Ne,je);return ue=Ha(Ha(Ha({percent:ke,cornerRadius:l,name:Se,tooltipPayload:Ye,midAngle:je,middleRadius:Ne,tooltipPosition:$e},ve),V),{},{value:Ia(ve,H),startAngle:ze,endAngle:et,payload:ve,paddingAngle:tl(U)*_}),ue})}return Ha(Ha({},V),{},{sectors:de,data:a})});var Qk,LG;function aNe(){if(LG)return Qk;LG=1;function e(t){return t&&t.length?t[0]:void 0}return Qk=e,Qk}var ej,zG;function oNe(){return zG||(zG=1,ej=aNe()),ej}var sNe=oNe();const lNe=ta(sNe);var cNe=["key"];function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}function uNe(e,t){if(e==null)return{};var r=dNe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function DT(){return DT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},DT.apply(this,arguments)}function FG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FG(Object(r),!0).forEach(function(n){Jp(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gee(n.key),n)}}function fNe(e,t,r){return t&&BG(e.prototype,t),r&&BG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pNe(e,t,r){return t=LT(t),mNe(e,mee()?Reflect.construct(t,r||[],LT(e).constructor):t.apply(e,r))}function mNe(e,t){if(t&&(Bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gNe(e)}function gNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mee=function(){return!!e})()}function LT(e){return LT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},LT(e)}function yNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&RI(e,t)}function RI(e,t){return RI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},RI(e,t)}function Jp(e,t,r){return t=gee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gee(e){var t=vNe(e,"string");return Bx(t)=="symbol"?t:t+""}function vNe(e,t){if(Bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Vx=function(e){function t(){var r;hNe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=pNe(this,t,[].concat(a)),Jp(r,"state",{isAnimationFinished:!1}),Jp(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Cn(h)&&h()}),Jp(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Cn(h)&&h()}),Jp(r,"handleMouseEnter",function(h){var i=r.props.onMouseEnter;i&&i(r.props,h)}),Jp(r,"handleMouseLeave",function(h){var i=r.props.onMouseLeave;i&&i(r.props,h)}),r}return yNe(t,e),fNe(t,[{key:"renderDots",value:function(n){var a=this.props,l=a.dot,h=a.dataKey,i=on(this.props,!1),_=on(l,!0),w=n.map(function(A,C){var R=rc(rc(rc({key:"dot-".concat(C),r:3},i),_),{},{dataKey:h,cx:A.x,cy:A.y,index:C,payload:A});return t.renderDotItem(l,R)});return Pe.createElement(ci,{className:"recharts-radar-dots"},w)}},{key:"renderPolygonStatically",value:function(n){var a=this.props,l=a.shape,h=a.dot,i=a.isRange,_=a.baseLinePoints,w=a.connectNulls,A;return Pe.isValidElement(l)?A=Pe.cloneElement(l,rc(rc({},this.props),{},{points:n})):Cn(l)?A=l(rc(rc({},this.props),{},{points:n})):A=Pe.createElement(see,DT({},on(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:n,baseLinePoints:i?_:null,connectNulls:w})),Pe.createElement(ci,{className:"recharts-radar-polygon"},A,h?this.renderDots(n):null)}},{key:"renderPolygonWithAnimation",value:function(){var n=this,a=this.props,l=a.points,h=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,C=this.state.prevPoints;return Pe.createElement(Bc,{begin:i,duration:_,isActive:h,easing:w,from:{t:0},to:{t:1},key:"radar-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(R){var z=R.t,V=C&&C.length/l.length,U=l.map(function(G,H){var J=C&&C[Math.floor(H*V)];if(J){var Q=Sa(J.x,G.x),le=Sa(J.y,G.y);return rc(rc({},G),{},{x:Q(z),y:le(z)})}var ne=Sa(G.cx,G.x),de=Sa(G.cy,G.y);return rc(rc({},G),{},{x:ne(z),y:de(z)})});return n.renderPolygonStatically(U)})}},{key:"renderPolygon",value:function(){var n=this.props,a=n.points,l=n.isAnimationActive,h=n.isRange,i=this.state.prevPoints;return l&&a&&a.length&&!h&&(!i||!Hf(i,a))?this.renderPolygonWithAnimation():this.renderPolygonStatically(a)}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.className,h=n.points,i=n.isAnimationActive;if(a||!h||!h.length)return null;var _=this.state.isAnimationFinished,w=Xn("recharts-radar",l);return Pe.createElement(ci,{className:w},this.renderPolygon(),(!i||_)&&Tu.renderCallByParent(this.props,h))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"renderDotItem",value:function(n,a){var l;if(Pe.isValidElement(n))l=Pe.cloneElement(n,a);else if(Cn(n))l=n(a);else{var h=a.key,i=uNe(a,cNe);l=Pe.createElement(k0,DT({},i,{key:h,className:Xn("recharts-radar-dot",typeof n!="boolean"?n.className:"")}))}return l}}])}(K.PureComponent);Jp(Vx,"displayName","Radar");Jp(Vx,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Wh.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Jp(Vx,"getComposedData",function(e){var t=e.radiusAxis,r=e.angleAxis,n=e.displayedData,a=e.dataKey,l=e.bandSize,h=r.cx,i=r.cy,_=!1,w=[],A=r.type!=="number"?l??0:0;n.forEach(function(R,z){var V=Ia(R,r.dataKey,z),U=Ia(R,a),G=r.scale(V)+A,H=Array.isArray(U)?XQ(U):U,J=Gn(H)?void 0:t.scale(H);Array.isArray(U)&&U.length>=2&&(_=!0),w.push(rc(rc({},sa(h,i,J,G)),{},{name:V,value:U,cx:h,cy:i,radius:J,angle:G,payload:R}))});var C=[];return _&&w.forEach(function(R){if(Array.isArray(R.value)){var z=lNe(R.value),V=Gn(z)?void 0:t.scale(z);C.push(rc(rc({},R),{},{radius:V},sa(h,i,V,R.angle)))}else C.push(R)}),{points:w,isRange:_,baseLinePoints:C}});function Ow(e){"@babel/helpers - typeof";return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function kI(){return kI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kI.apply(this,arguments)}function VG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VG(Object(r),!0).forEach(function(n){_Ne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ne(e,t,r){return t=xNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xNe(e){var t=bNe(e,"string");return Ow(t)=="symbol"?t:t+""}function bNe(e,t){if(Ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UG(e){return typeof e=="string"?parseInt(e,10):e}function wNe(e,t){var r="".concat(t.cx||e.cx),n=Number(r),a="".concat(t.cy||e.cy),l=Number(a);return tj(tj(tj({},t),e),{},{cx:n,cy:l})}function $G(e){return Pe.createElement(Cw,kI({shapeType:"sector",propTransformer:wNe},e))}var SNe=["shape","activeShape","activeIndex","cornerRadius"],ANe=["value","background"];function Ux(e){"@babel/helpers - typeof";return Ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ux(e)}function zT(){return zT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zT.apply(this,arguments)}function qG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qG(Object(r),!0).forEach(function(n){Sv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GG(e,t){if(e==null)return{};var r=TNe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TNe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function PNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vee(n.key),n)}}function ENe(e,t,r){return t&&KG(e.prototype,t),r&&KG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CNe(e,t,r){return t=FT(t),MNe(e,yee()?Reflect.construct(t,r||[],FT(e).constructor):t.apply(e,r))}function MNe(e,t){if(t&&(Ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ONe(e)}function ONe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yee=function(){return!!e})()}function FT(e){return FT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},FT(e)}function RNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jI(e,t)}function jI(e,t){return jI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},jI(e,t)}function Sv(e,t,r){return t=vee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vee(e){var t=kNe(e,"string");return Ux(t)=="symbol"?t:t+""}function kNe(e,t){if(Ux(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ux(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pS=function(e){function t(){var r;PNe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=CNe(this,t,[].concat(a)),Sv(r,"state",{isAnimationFinished:!1}),Sv(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Cn(h)&&h()}),Sv(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Cn(h)&&h()}),r}return RNe(t,e),ENe(t,[{key:"getDeltaAngle",value:function(){var n=this.props,a=n.startAngle,l=n.endAngle,h=tl(l-a),i=Math.min(Math.abs(l-a),360);return h*i}},{key:"renderSectorsStatically",value:function(n){var a=this,l=this.props,h=l.shape,i=l.activeShape,_=l.activeIndex,w=l.cornerRadius,A=GG(l,SNe),C=on(A,!1);return n.map(function(R,z){var V=z===_,U=Xs(Xs(Xs(Xs({},C),{},{cornerRadius:UG(w)},R),Wf(a.props,R,z)),{},{className:"recharts-radial-bar-sector ".concat(R.className),forceCornerRadius:A.forceCornerRadius,cornerIsExternal:A.cornerIsExternal,isActive:V,option:V?i:h});return Pe.createElement($G,zT({},U,{key:"sector-".concat(z)}))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,l=a.data,h=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,C=this.state.prevData;return Pe.createElement(Bc,{begin:i,duration:_,isActive:h,easing:w,from:{t:0},to:{t:1},key:"radialBar-".concat(A),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(R){var z=R.t,V=l.map(function(U,G){var H=C&&C[G];if(H){var J=Sa(H.startAngle,U.startAngle),Q=Sa(H.endAngle,U.endAngle);return Xs(Xs({},U),{},{startAngle:J(z),endAngle:Q(z)})}var le=U.endAngle,ne=U.startAngle,de=Sa(ne,le);return Xs(Xs({},U),{},{endAngle:de(z)})});return Pe.createElement(ci,null,n.renderSectorsStatically(V))})}},{key:"renderSectors",value:function(){var n=this.props,a=n.data,l=n.isAnimationActive,h=this.state.prevData;return l&&a&&a.length&&(!h||!Hf(h,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"renderBackground",value:function(n){var a=this,l=this.props.cornerRadius,h=on(this.props.background,!1);return n.map(function(i,_){i.value;var w=i.background,A=GG(i,ANe);if(!w)return null;var C=Xs(Xs(Xs(Xs(Xs({cornerRadius:UG(l)},A),{},{fill:"#eee"},w),h),Wf(a.props,i,_)),{},{index:_,className:Xn("recharts-radial-bar-background-sector",h==null?void 0:h.className),option:w,isActive:!1});return Pe.createElement($G,zT({},C,{key:"sector-".concat(_)}))})}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.data,h=n.className,i=n.background,_=n.isAnimationActive;if(a||!l||!l.length)return null;var w=this.state.isAnimationFinished,A=Xn("recharts-area",h);return Pe.createElement(ci,{className:A},i&&Pe.createElement(ci,{className:"recharts-radial-bar-background"},this.renderBackground(l)),Pe.createElement(ci,{className:"recharts-radial-bar-sectors"},this.renderSectors()),(!_||w)&&Tu.renderCallByParent(Xs({},this.props),l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(K.PureComponent);Sv(pS,"displayName","RadialBar");Sv(pS,"defaultProps",{angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!Wh.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1});Sv(pS,"getComposedData",function(e){var t=e.item,r=e.props,n=e.radiusAxis,a=e.radiusAxisTicks,l=e.angleAxis,h=e.angleAxisTicks,i=e.displayedData,_=e.dataKey,w=e.stackedData,A=e.barPosition,C=e.bandSize,R=e.dataStartIndex,z=UQ(A,t);if(!z)return null;var V=l.cx,U=l.cy,G=r.layout,H=t.props,J=H.children,Q=H.minPointSize,le=G==="radial"?l:n,ne=w?le.scale.domain():null,de=GQ({numericAxis:le}),ue=Bl(J,hm),ve=i.map(function(Ae,Oe){var Se,ke,ze,et,je,Ne;if(w?Se=$Q(w[R+Oe],ne):(Se=Ia(Ae,_),Array.isArray(Se)||(Se=[de,Se])),G==="radial"){ke=ST({axis:n,ticks:a,bandSize:C,offset:z.offset,entry:Ae,index:Oe}),je=l.scale(Se[1]),et=l.scale(Se[0]),ze=ke+z.size;var Ye=je-et;if(Math.abs(Q)>0&&Math.abs(Ye)<Math.abs(Q)){var $e=tl(Ye||Q)*(Math.abs(Q)-Math.abs(Ye));je+=$e}Ne={background:{cx:V,cy:U,innerRadius:ke,outerRadius:ze,startAngle:r.startAngle,endAngle:r.endAngle}}}else{ke=n.scale(Se[0]),ze=n.scale(Se[1]),et=ST({axis:l,ticks:h,bandSize:C,offset:z.offset,entry:Ae,index:Oe}),je=et+z.size;var We=ze-ke;if(Math.abs(Q)>0&&Math.abs(We)<Math.abs(Q)){var Et=tl(We||Q)*(Math.abs(Q)-Math.abs(We));ze+=Et}}return Xs(Xs(Xs(Xs({},Ae),Ne),{},{payload:Ae,value:w?Se:Se[1],cx:V,cy:U,innerRadius:ke,outerRadius:ze,startAngle:et,endAngle:je},ue&&ue[Oe]&&ue[Oe].props),{},{tooltipPayload:[GL(t,Ae)],tooltipPosition:sa(V,U,(ke+ze)/2,(et+je)/2)})});return{data:ve,layout:G}});var rj,WG;function jNe(){if(WG)return rj;WG=1;var e=Math.ceil,t=Math.max;function r(n,a,l,h){for(var i=-1,_=t(e((a-n)/(l||1)),0),w=Array(_);_--;)w[h?_:++i]=n,n+=l;return w}return rj=r,rj}var nj,HG;function _ee(){if(HG)return nj;HG=1;var e=jJ(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-1/0){var l=a<0?-1:1;return l*r}return a===a?a:0}return nj=n,nj}var ij,ZG;function NNe(){if(ZG)return ij;ZG=1;var e=jNe(),t=HP(),r=_ee();function n(a){return function(l,h,i){return i&&typeof i!="number"&&t(l,h,i)&&(h=i=void 0),l=r(l),h===void 0?(h=l,l=0):h=r(h),i=i===void 0?l<h?1:-1:r(i),e(l,h,i,a)}}return ij=n,ij}var aj,YG;function INe(){if(YG)return aj;YG=1;var e=NNe(),t=e();return aj=t,aj}var DNe=INe();const BT=ta(DNe);function Rw(e){"@babel/helpers - typeof";return Rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rw(e)}function XG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function JG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XG(Object(r),!0).forEach(function(n){xee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xee(e,t,r){return t=LNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LNe(e){var t=zNe(e,"string");return Rw(t)=="symbol"?t:t+""}function zNe(e,t){if(Rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FNe=["Webkit","Moz","O","ms"],BNe=function(t,r){var n=t.replace(/(\w)/,function(l){return l.toUpperCase()}),a=FNe.reduce(function(l,h){return JG(JG({},l),{},xee({},h+n,r))},{});return a[t]=r,a};function $x(e){"@babel/helpers - typeof";return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}function VT(){return VT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VT.apply(this,arguments)}function QG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function oj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QG(Object(r),!0).forEach(function(n){mu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function e9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wee(n.key),n)}}function UNe(e,t,r){return t&&e9(e.prototype,t),r&&e9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Ne(e,t,r){return t=UT(t),qNe(e,bee()?Reflect.construct(t,r||[],UT(e).constructor):t.apply(e,r))}function qNe(e,t){if(t&&($x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GNe(e)}function GNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bee=function(){return!!e})()}function UT(e){return UT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},UT(e)}function KNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NI(e,t)}function NI(e,t){return NI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},NI(e,t)}function mu(e,t,r){return t=wee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wee(e){var t=WNe(e,"string");return $x(t)=="symbol"?t:t+""}function WNe(e,t){if($x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var HNe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,l=t.x,h=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var _=r.length,w=h1().domain(BT(0,_)).range([l,l+h-i]),A=w.domain().map(function(C){return w(C)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:w(n),endX:w(a),scale:w,scaleValues:A}},t9=function(t){return t.changedTouches&&!!t.changedTouches.length},qx=function(e){function t(r){var n;return VNe(this,t),n=$Ne(this,t,[r]),mu(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),mu(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),mu(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,l=a.endIndex,h=a.onDragEnd,i=a.startIndex;h==null||h({endIndex:l,startIndex:i})}),n.detachDragEndListener()}),mu(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),mu(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),mu(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),mu(n,"handleSlideDragStart",function(a){var l=t9(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return KNe(t,e),UNe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,l=n.endX,h=this.state.scaleValues,i=this.props,_=i.gap,w=i.data,A=w.length-1,C=Math.min(a,l),R=Math.max(a,l),z=t.getIndexInRange(h,C),V=t.getIndexInRange(h,R);return{startIndex:z-z%_,endIndex:V===A?A:V-V%_}}},{key:"getTextOfTick",value:function(n){var a=this.props,l=a.data,h=a.tickFormatter,i=a.dataKey,_=Ia(l[n],i,n);return Cn(h)?h(_,n):_}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,l=a.slideMoveStartX,h=a.startX,i=a.endX,_=this.props,w=_.x,A=_.width,C=_.travellerWidth,R=_.startIndex,z=_.endIndex,V=_.onChange,U=n.pageX-l;U>0?U=Math.min(U,w+A-C-i,w+A-C-h):U<0&&(U=Math.max(U,w-h,w-i));var G=this.getIndex({startX:h+U,endX:i+U});(G.startIndex!==R||G.endIndex!==z)&&V&&V(G),this.setState({startX:h+U,endX:i+U,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var l=t9(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,l=a.brushMoveStartX,h=a.movingTravellerId,i=a.endX,_=a.startX,w=this.state[h],A=this.props,C=A.x,R=A.width,z=A.travellerWidth,V=A.onChange,U=A.gap,G=A.data,H={startX:this.state.startX,endX:this.state.endX},J=n.pageX-l;J>0?J=Math.min(J,C+R-z-w):J<0&&(J=Math.max(J,C-w)),H[h]=w+J;var Q=this.getIndex(H),le=Q.startIndex,ne=Q.endIndex,de=function(){var ve=G.length-1;return h==="startX"&&(i>_?le%U===0:ne%U===0)||i<_&&ne===ve||h==="endX"&&(i>_?ne%U===0:le%U===0)||i>_&&ne===ve};this.setState(mu(mu({},h,w+J),"brushMoveStartX",n.pageX),function(){V&&de()&&V(Q)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var l=this,h=this.state,i=h.scaleValues,_=h.startX,w=h.endX,A=this.state[a],C=i.indexOf(A);if(C!==-1){var R=C+n;if(!(R===-1||R>=i.length)){var z=i[R];a==="startX"&&z>=w||a==="endX"&&z<=_||this.setState(mu({},a,z),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,l=n.y,h=n.width,i=n.height,_=n.fill,w=n.stroke;return Pe.createElement("rect",{stroke:w,fill:_,x:a,y:l,width:h,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,l=n.y,h=n.width,i=n.height,_=n.data,w=n.children,A=n.padding,C=K.Children.only(w);return C?Pe.cloneElement(C,{x:a,y:l,width:h,height:i,margin:A,compact:!0,data:_}):null}},{key:"renderTravellerLayer",value:function(n,a){var l,h,i=this,_=this.props,w=_.y,A=_.travellerWidth,C=_.height,R=_.traveller,z=_.ariaLabel,V=_.data,U=_.startIndex,G=_.endIndex,H=Math.max(n,this.props.x),J=oj(oj({},on(this.props,!1)),{},{x:H,y:w,width:A,height:C}),Q=z||"Min value: ".concat((l=V[U])===null||l===void 0?void 0:l.name,", Max value: ").concat((h=V[G])===null||h===void 0?void 0:h.name);return Pe.createElement(ci,{tabIndex:0,role:"slider","aria-label":Q,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(ne){["ArrowLeft","ArrowRight"].includes(ne.key)&&(ne.preventDefault(),ne.stopPropagation(),i.handleTravellerMoveKeyboard(ne.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(R,J))}},{key:"renderSlide",value:function(n,a){var l=this.props,h=l.y,i=l.height,_=l.stroke,w=l.travellerWidth,A=Math.min(n,a)+w,C=Math.max(Math.abs(a-n)-w,0);return Pe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:_,fillOpacity:.2,x:A,y:h,width:C,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,l=n.endIndex,h=n.y,i=n.height,_=n.travellerWidth,w=n.stroke,A=this.state,C=A.startX,R=A.endX,z=5,V={pointerEvents:"none",fill:w};return Pe.createElement(ci,{className:"recharts-brush-texts"},Pe.createElement(Rv,VT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(C,R)-z,y:h+i/2},V),this.getTextOfTick(a)),Pe.createElement(Rv,VT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(C,R)+_+z,y:h+i/2},V),this.getTextOfTick(l)))}},{key:"render",value:function(){var n=this.props,a=n.data,l=n.className,h=n.children,i=n.x,_=n.y,w=n.width,A=n.height,C=n.alwaysShowText,R=this.state,z=R.startX,V=R.endX,U=R.isTextActive,G=R.isSlideMoving,H=R.isTravellerMoving,J=R.isTravellerFocused;if(!a||!a.length||!Ir(i)||!Ir(_)||!Ir(w)||!Ir(A)||w<=0||A<=0)return null;var Q=Xn("recharts-brush",l),le=Pe.Children.count(h)===1,ne=BNe("userSelect","none");return Pe.createElement(ci,{className:Q,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ne},this.renderBackground(),le&&this.renderPanorama(),this.renderSlide(z,V),this.renderTravellerLayer(z,"startX"),this.renderTravellerLayer(V,"endX"),(U||G||H||J||C)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,l=n.y,h=n.width,i=n.height,_=n.stroke,w=Math.floor(l+i/2)-1;return Pe.createElement(Pe.Fragment,null,Pe.createElement("rect",{x:a,y:l,width:h,height:i,fill:_,stroke:"none"}),Pe.createElement("line",{x1:a+1,y1:w,x2:a+h-1,y2:w,fill:"none",stroke:"#fff"}),Pe.createElement("line",{x1:a+1,y1:w+2,x2:a+h-1,y2:w+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var l;return Pe.isValidElement(n)?l=Pe.cloneElement(n,a):Cn(n)?l=n(a):l=t.renderDefaultTraveller(a),l}},{key:"getDerivedStateFromProps",value:function(n,a){var l=n.data,h=n.width,i=n.x,_=n.travellerWidth,w=n.updateId,A=n.startIndex,C=n.endIndex;if(l!==a.prevData||w!==a.prevUpdateId)return oj({prevData:l,prevTravellerWidth:_,prevUpdateId:w,prevX:i,prevWidth:h},l&&l.length?HNe({data:l,width:h,x:i,travellerWidth:_,startIndex:A,endIndex:C}):{scale:null,scaleValues:null});if(a.scale&&(h!==a.prevWidth||i!==a.prevX||_!==a.prevTravellerWidth)){a.scale.range([i,i+h-_]);var R=a.scale.domain().map(function(z){return a.scale(z)});return{prevData:l,prevTravellerWidth:_,prevUpdateId:w,prevX:i,prevWidth:h,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:R}}return null}},{key:"getIndexInRange",value:function(n,a){for(var l=n.length,h=0,i=l-1;i-h>1;){var _=Math.floor((h+i)/2);n[_]>a?i=_:h=_}return a>=n[i]?i:h}}])}(K.PureComponent);mu(qx,"displayName","Brush");mu(qx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var sj,r9;function ZNe(){if(r9)return sj;r9=1;var e=yL();function t(r,n){var a;return e(r,function(l,h,i){return a=n(l,h,i),!a}),!!a}return sj=t,sj}var lj,n9;function YNe(){if(n9)return lj;n9=1;var e=uJ(),t=tp(),r=ZNe(),n=Uc(),a=HP();function l(h,i,_){var w=n(h)?e:r;return _&&a(h,i,_)&&(i=void 0),w(h,t(i,3))}return lj=l,lj}var XNe=YNe();const JNe=ta(XNe);var $f=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},cj,i9;function QNe(){if(i9)return cj;i9=1;var e=CJ();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return cj=t,cj}var uj,a9;function eIe(){if(a9)return uj;a9=1;var e=QNe(),t=PJ(),r=tp();function n(a,l){var h={};return l=r(l,3),t(a,function(i,_,w){e(h,_,l(i,_,w))}),h}return uj=n,uj}var tIe=eIe();const rIe=ta(tIe);var dj,o9;function nIe(){if(o9)return dj;o9=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return dj=e,dj}var hj,s9;function iIe(){if(s9)return hj;s9=1;var e=yL();function t(r,n){var a=!0;return e(r,function(l,h,i){return a=!!n(l,h,i),a}),a}return hj=t,hj}var fj,l9;function aIe(){if(l9)return fj;l9=1;var e=nIe(),t=iIe(),r=tp(),n=Uc(),a=HP();function l(h,i,_){var w=n(h)?e:t;return _&&a(h,i,_)&&(i=void 0),w(h,r(i,3))}return fj=l,fj}var oIe=aIe();const See=ta(oIe);var sIe=["x","y"];function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function II(){return II=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},II.apply(this,arguments)}function c9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c9(Object(r),!0).forEach(function(n){lIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lIe(e,t,r){return t=cIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cIe(e){var t=uIe(e,"string");return kw(t)=="symbol"?t:t+""}function uIe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dIe(e,t){if(e==null)return{};var r=hIe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function fIe(e,t){var r=e.x,n=e.y,a=dIe(e,sIe),l="".concat(r),h=parseInt(l,10),i="".concat(n),_=parseInt(i,10),w="".concat(t.height||a.height),A=parseInt(w,10),C="".concat(t.width||a.width),R=parseInt(C,10);return Gb(Gb(Gb(Gb(Gb({},t),a),h?{x:h}:{}),_?{y:_}:{}),{},{height:A,width:R,name:t.name,radius:t.radius})}function u9(e){return Pe.createElement(Cw,II({shapeType:"rectangle",propTransformer:fIe,activeClassName:"recharts-active-bar"},e))}var pIe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var l=typeof n=="number";return l?t(n,a):(l||jv(),r)}},mIe=["value","background"],Aee;function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function gIe(e,t){if(e==null)return{};var r=yIe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $T(){return $T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$T.apply(this,arguments)}function d9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d9(Object(r),!0).forEach(function(n){Eg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pee(n.key),n)}}function _Ie(e,t,r){return t&&h9(e.prototype,t),r&&h9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xIe(e,t,r){return t=qT(t),bIe(e,Tee()?Reflect.construct(t,r||[],qT(e).constructor):t.apply(e,r))}function bIe(e,t){if(t&&(Gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wIe(e)}function wIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tee=function(){return!!e})()}function qT(e){return qT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qT(e)}function SIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DI(e,t)}function DI(e,t){return DI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},DI(e,t)}function Eg(e,t,r){return t=Pee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pee(e){var t=AIe(e,"string");return Gx(t)=="symbol"?t:t+""}function AIe(e,t){if(Gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ro=function(e){function t(){var r;vIe(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=xIe(this,t,[].concat(a)),Eg(r,"state",{isAnimationFinished:!1}),Eg(r,"id",Hg("recharts-bar-")),Eg(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),h&&h()}),Eg(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),h&&h()}),r}return SIe(t,e),_Ie(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,l=this.props,h=l.shape,i=l.dataKey,_=l.activeIndex,w=l.activeBar,A=on(this.props,!1);return n&&n.map(function(C,R){var z=R===_,V=z?w:h,U=hs(hs(hs({},A),C),{},{isActive:z,option:V,index:R,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Pe.createElement(ci,$T({className:"recharts-bar-rectangle"},Wf(a.props,C,R),{key:"rectangle-".concat(C==null?void 0:C.x,"-").concat(C==null?void 0:C.y,"-").concat(C==null?void 0:C.value)}),Pe.createElement(u9,U))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,l=a.data,h=a.layout,i=a.isAnimationActive,_=a.animationBegin,w=a.animationDuration,A=a.animationEasing,C=a.animationId,R=this.state.prevData;return Pe.createElement(Bc,{begin:_,duration:w,isActive:i,easing:A,from:{t:0},to:{t:1},key:"bar-".concat(C),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(z){var V=z.t,U=l.map(function(G,H){var J=R&&R[H];if(J){var Q=Sa(J.x,G.x),le=Sa(J.y,G.y),ne=Sa(J.width,G.width),de=Sa(J.height,G.height);return hs(hs({},G),{},{x:Q(V),y:le(V),width:ne(V),height:de(V)})}if(h==="horizontal"){var ue=Sa(0,G.height),ve=ue(V);return hs(hs({},G),{},{y:G.y+G.height-ve,height:ve})}var Ae=Sa(0,G.width),Oe=Ae(V);return hs(hs({},G),{},{width:Oe})});return Pe.createElement(ci,null,n.renderRectanglesStatically(U))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,l=n.isAnimationActive,h=this.state.prevData;return l&&a&&a.length&&(!h||!Hf(h,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,l=a.data,h=a.dataKey,i=a.activeIndex,_=on(this.props.background,!1);return l.map(function(w,A){w.value;var C=w.background,R=gIe(w,mIe);if(!C)return null;var z=hs(hs(hs(hs(hs({},R),{},{fill:"#eee"},C),_),Wf(n.props,w,A)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:h,index:A,className:"recharts-bar-background-rectangle"});return Pe.createElement(u9,$T({key:"background-bar-".concat(A),option:n.props.background,isActive:A===i},z))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,h=l.data,i=l.xAxis,_=l.yAxis,w=l.layout,A=l.children,C=Bl(A,R0);if(!C)return null;var R=w==="vertical"?h[0].height/2:h[0].width/2,z=function(G,H){var J=Array.isArray(G.value)?G.value[1]:G.value;return{x:G.x,y:G.y,value:J,errorVal:Ia(G,H)}},V={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Pe.createElement(ci,V,C.map(function(U){return Pe.cloneElement(U,{key:"error-bar-".concat(a,"-").concat(U.props.dataKey),data:h,xAxis:i,yAxis:_,layout:w,offset:R,dataPointFormatter:z})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.data,h=n.className,i=n.xAxis,_=n.yAxis,w=n.left,A=n.top,C=n.width,R=n.height,z=n.isAnimationActive,V=n.background,U=n.id;if(a||!l||!l.length)return null;var G=this.state.isAnimationFinished,H=Xn("recharts-bar",h),J=i&&i.allowDataOverflow,Q=_&&_.allowDataOverflow,le=J||Q,ne=Gn(U)?this.id:U;return Pe.createElement(ci,{className:H},J||Q?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(ne)},Pe.createElement("rect",{x:J?w:w-C/2,y:Q?A:A-R/2,width:J?C:C*2,height:Q?R:R*2}))):null,Pe.createElement(ci,{className:"recharts-bar-rectangles",clipPath:le?"url(#clipPath-".concat(ne,")"):null},V?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(le,ne),(!z||G)&&Tu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(K.PureComponent);Aee=Ro;Eg(Ro,"displayName","Bar");Eg(Ro,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Wh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Eg(Ro,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,l=e.xAxis,h=e.yAxis,i=e.xAxisTicks,_=e.yAxisTicks,w=e.stackedData,A=e.dataStartIndex,C=e.displayedData,R=e.offset,z=UQ(n,r);if(!z)return null;var V=t.layout,U=r.type.defaultProps,G=U!==void 0?hs(hs({},U),r.props):r.props,H=G.dataKey,J=G.children,Q=G.minPointSize,le=V==="horizontal"?h:l,ne=w?le.scale.domain():null,de=GQ({numericAxis:le}),ue=Bl(J,hm),ve=C.map(function(Ae,Oe){var Se,ke,ze,et,je,Ne;w?Se=$Q(w[A+Oe],ne):(Se=Ia(Ae,H),Array.isArray(Se)||(Se=[de,Se]));var Ye=pIe(Q,Aee.defaultProps.minPointSize)(Se[1],Oe);if(V==="horizontal"){var $e,We=[h.scale(Se[0]),h.scale(Se[1])],Et=We[0],Je=We[1];ke=ST({axis:l,ticks:i,bandSize:a,offset:z.offset,entry:Ae,index:Oe}),ze=($e=Je??Et)!==null&&$e!==void 0?$e:void 0,et=z.size;var ht=Et-Je;if(je=Number.isNaN(ht)?0:ht,Ne={x:ke,y:h.y,width:et,height:h.height},Math.abs(Ye)>0&&Math.abs(je)<Math.abs(Ye)){var tt=tl(je||Ye)*(Math.abs(Ye)-Math.abs(je));ze-=tt,je+=tt}}else{var Qt=[l.scale(Se[0]),l.scale(Se[1])],gr=Qt[0],sr=Qt[1];if(ke=gr,ze=ST({axis:h,ticks:_,bandSize:a,offset:z.offset,entry:Ae,index:Oe}),et=sr-gr,je=z.size,Ne={x:l.x,y:ze,width:l.width,height:je},Math.abs(Ye)>0&&Math.abs(et)<Math.abs(Ye)){var ur=tl(et||Ye)*(Math.abs(Ye)-Math.abs(et));et+=ur}}return hs(hs(hs({},Ae),{},{x:ke,y:ze,width:et,height:je,value:w?Se:Se[1],payload:Ae,background:Ne},ue&&ue[Oe]&&ue[Oe].props),{},{tooltipPayload:[GL(r,Ae)],tooltipPosition:{x:ke+et/2,y:ze+je/2}})});return hs({data:ve,layout:V},R)});function jw(e){"@babel/helpers - typeof";return jw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jw(e)}function TIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eee(n.key),n)}}function PIe(e,t,r){return t&&f9(e.prototype,t),r&&f9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function p9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p9(Object(r),!0).forEach(function(n){cE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cE(e,t,r){return t=Eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eee(e){var t=EIe(e,"string");return jw(t)=="symbol"?t:t+""}function EIe(e,t){if(jw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mS=function(t,r,n,a,l){var h=t.width,i=t.height,_=t.layout,w=t.children,A=Object.keys(r),C={left:n.left,leftMirror:n.left,right:h-n.right,rightMirror:h-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},R=!!gu(w,Ro);return A.reduce(function(z,V){var U=r[V],G=U.orientation,H=U.domain,J=U.padding,Q=J===void 0?{}:J,le=U.mirror,ne=U.reversed,de="".concat(G).concat(le?"Mirror":""),ue,ve,Ae,Oe,Se;if(U.type==="number"&&(U.padding==="gap"||U.padding==="no-gap")){var ke=H[1]-H[0],ze=1/0,et=U.categoricalDomain.sort();if(et.forEach(function(Qt,gr){gr>0&&(ze=Math.min((Qt||0)-(et[gr-1]||0),ze))}),Number.isFinite(ze)){var je=ze/ke,Ne=U.layout==="vertical"?n.height:n.width;if(U.padding==="gap"&&(ue=je*Ne/2),U.padding==="no-gap"){var Ye=sc(t.barCategoryGap,je*Ne),$e=je*Ne/2;ue=$e-Ye-($e-Ye)/Ne*Ye}}}a==="xAxis"?ve=[n.left+(Q.left||0)+(ue||0),n.left+n.width-(Q.right||0)-(ue||0)]:a==="yAxis"?ve=_==="horizontal"?[n.top+n.height-(Q.bottom||0),n.top+(Q.top||0)]:[n.top+(Q.top||0)+(ue||0),n.top+n.height-(Q.bottom||0)-(ue||0)]:ve=U.range,ne&&(ve=[ve[1],ve[0]]);var We=BQ(U,l,R),Et=We.scale,Je=We.realScaleType;Et.domain(H).range(ve),VQ(Et);var ht=qQ(Et,Sh(Sh({},U),{},{realScaleType:Je}));a==="xAxis"?(Se=G==="top"&&!le||G==="bottom"&&le,Ae=n.left,Oe=C[de]-Se*U.height):a==="yAxis"&&(Se=G==="left"&&!le||G==="right"&&le,Ae=C[de]-Se*U.width,Oe=n.top);var tt=Sh(Sh(Sh({},U),ht),{},{realScaleType:Je,x:Ae,y:Oe,scale:Et,width:a==="xAxis"?n.width:U.width,height:a==="yAxis"?n.height:U.height});return tt.bandSize=AT(tt,ht),!U.hide&&a==="xAxis"?C[de]+=(Se?-1:1)*tt.height:U.hide||(C[de]+=(Se?-1:1)*tt.width),Sh(Sh({},z),{},cE({},V,tt))},{})},Cee=function(t,r){var n=t.x,a=t.y,l=r.x,h=r.y;return{x:Math.min(n,l),y:Math.min(a,h),width:Math.abs(l-n),height:Math.abs(h-a)}},CIe=function(t){var r=t.x1,n=t.y1,a=t.x2,l=t.y2;return Cee({x:r,y:n},{x:a,y:l})},Mee=function(){function e(t){TIe(this,e),this.scale=t}return PIe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,l=n.position;if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var h=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+h}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(a){var _=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+_}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],l=n[n.length-1];return a<=l?r>=a&&r<=l:r>=l&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();cE(Mee,"EPS",1e-4);var HL=function(t){var r=Object.keys(t).reduce(function(n,a){return Sh(Sh({},n),{},cE({},a,Mee.create(t[a])))},{});return Sh(Sh({},r),{},{apply:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=l.bandAware,i=l.position;return rIe(a,function(_,w){return r[w].apply(_,{bandAware:h,position:i})})},isInRange:function(a){return See(a,function(l,h){return r[h].isInRange(l)})}})};function MIe(e){return(e%180+180)%180}var OIe=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=MIe(a),h=l*Math.PI/180,i=Math.atan(n/r),_=h>i&&h<Math.PI-i?n/Math.sin(h):r/Math.cos(h);return Math.abs(_)},pj,m9;function RIe(){if(m9)return pj;m9=1;var e=tp(),t=cS(),r=KP();function n(a){return function(l,h,i){var _=Object(l);if(!t(l)){var w=e(h,3);l=r(l),h=function(C){return w(_[C],C,_)}}var A=a(l,h,i);return A>-1?_[w?l[A]:A]:void 0}}return pj=n,pj}var mj,g9;function kIe(){if(g9)return mj;g9=1;var e=_ee();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return mj=t,mj}var gj,y9;function jIe(){if(y9)return gj;y9=1;var e=bJ(),t=tp(),r=kIe(),n=Math.max;function a(l,h,i){var _=l==null?0:l.length;if(!_)return-1;var w=i==null?0:r(i);return w<0&&(w=n(_+w,0)),e(l,t(h,3),w)}return gj=a,gj}var yj,v9;function NIe(){if(v9)return yj;v9=1;var e=RIe(),t=jIe(),r=e(t);return yj=r,yj}var IIe=NIe();const DIe=ta(IIe);var LIe=DX();const zIe=ta(LIe);var FIe=zIe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),ZL=K.createContext(void 0),YL=K.createContext(void 0),Oee=K.createContext(void 0),Ree=K.createContext({}),kee=K.createContext(void 0),jee=K.createContext(0),Nee=K.createContext(0),_9=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,l=r.offset,h=t.clipPathId,i=t.children,_=t.width,w=t.height,A=FIe(l);return Pe.createElement(ZL.Provider,{value:n},Pe.createElement(YL.Provider,{value:a},Pe.createElement(Ree.Provider,{value:l},Pe.createElement(Oee.Provider,{value:A},Pe.createElement(kee.Provider,{value:h},Pe.createElement(jee.Provider,{value:w},Pe.createElement(Nee.Provider,{value:_},i)))))))},BIe=function(){return K.useContext(kee)},Iee=function(t){var r=K.useContext(ZL);r==null&&jv();var n=r[t];return n==null&&jv(),n},VIe=function(){var t=K.useContext(ZL);return Tg(t)},UIe=function(){var t=K.useContext(YL),r=DIe(t,function(n){return See(n.domain,Number.isFinite)});return r||Tg(t)},Dee=function(t){var r=K.useContext(YL);r==null&&jv();var n=r[t];return n==null&&jv(),n},$Ie=function(){var t=K.useContext(Oee);return t},qIe=function(){return K.useContext(Ree)},XL=function(){return K.useContext(Nee)},JL=function(){return K.useContext(jee)};function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function GIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KIe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zee(n.key),n)}}function WIe(e,t,r){return t&&KIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function HIe(e,t,r){return t=GT(t),ZIe(e,Lee()?Reflect.construct(t,r||[],GT(e).constructor):t.apply(e,r))}function ZIe(e,t){if(t&&(Kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YIe(e)}function YIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lee=function(){return!!e})()}function GT(e){return GT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},GT(e)}function XIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LI(e,t)}function LI(e,t){return LI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LI(e,t)}function x9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function b9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x9(Object(r),!0).forEach(function(n){QL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QL(e,t,r){return t=zee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zee(e){var t=JIe(e,"string");return Kx(t)=="symbol"?t:t+""}function JIe(e,t){if(Kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function QIe(e,t){return nDe(e)||rDe(e,t)||tDe(e,t)||eDe()}function eDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tDe(e,t){if(e){if(typeof e=="string")return w9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w9(e,t)}}function w9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function nDe(e){if(Array.isArray(e))return e}function zI(){return zI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zI.apply(this,arguments)}var iDe=function(t,r){var n;return Pe.isValidElement(t)?n=Pe.cloneElement(t,r):Cn(t)?n=t(r):n=Pe.createElement("line",zI({},r,{className:"recharts-reference-line-line"})),n},aDe=function(t,r,n,a,l,h,i,_,w){var A=l.x,C=l.y,R=l.width,z=l.height;if(n){var V=w.y,U=t.y.apply(V,{position:h});if($f(w,"discard")&&!t.y.isInRange(U))return null;var G=[{x:A+R,y:U},{x:A,y:U}];return _==="left"?G.reverse():G}if(r){var H=w.x,J=t.x.apply(H,{position:h});if($f(w,"discard")&&!t.x.isInRange(J))return null;var Q=[{x:J,y:C+z},{x:J,y:C}];return i==="top"?Q.reverse():Q}if(a){var le=w.segment,ne=le.map(function(de){return t.apply(de,{position:h})});return $f(w,"discard")&&JNe(ne,function(de){return!t.isInRange(de)})?null:ne}return null};function oDe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,l=e.yAxisId,h=e.shape,i=e.className,_=e.alwaysShow,w=BIe(),A=Iee(a),C=Dee(l),R=$Ie();if(!w||!R)return null;Rh(_===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var z=HL({x:A.scale,y:C.scale}),V=Ns(t),U=Ns(r),G=n&&n.length===2,H=aDe(z,V,U,G,R,e.position,A.orientation,C.orientation,e);if(!H)return null;var J=QIe(H,2),Q=J[0],le=Q.x,ne=Q.y,de=J[1],ue=de.x,ve=de.y,Ae=$f(e,"hidden")?"url(#".concat(w,")"):void 0,Oe=b9(b9({clipPath:Ae},on(e,!0)),{},{x1:le,y1:ne,x2:ue,y2:ve});return Pe.createElement(ci,{className:Xn("recharts-reference-line",i)},iDe(h,Oe),el.renderCallByParent(e,CIe({x1:le,y1:ne,x2:ue,y2:ve})))}var e4=function(e){function t(){return GIe(this,t),HIe(this,t,arguments)}return XIe(t,e),WIe(t,[{key:"render",value:function(){return Pe.createElement(oDe,this.props)}}])}(Pe.Component);QL(e4,"displayName","ReferenceLine");QL(e4,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function FI(){return FI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FI.apply(this,arguments)}function Wx(e){"@babel/helpers - typeof";return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}function S9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function A9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S9(Object(r),!0).forEach(function(n){uE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bee(n.key),n)}}function cDe(e,t,r){return t&&lDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function uDe(e,t,r){return t=KT(t),dDe(e,Fee()?Reflect.construct(t,r||[],KT(e).constructor):t.apply(e,r))}function dDe(e,t){if(t&&(Wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hDe(e)}function hDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fee=function(){return!!e})()}function KT(e){return KT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},KT(e)}function fDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BI(e,t)}function BI(e,t){return BI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},BI(e,t)}function uE(e,t,r){return t=Bee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bee(e){var t=pDe(e,"string");return Wx(t)=="symbol"?t:t+""}function pDe(e,t){if(Wx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var mDe=function(t){var r=t.x,n=t.y,a=t.xAxis,l=t.yAxis,h=HL({x:a.scale,y:l.scale}),i=h.apply({x:r,y:n},{bandAware:!0});return $f(t,"discard")&&!h.isInRange(i)?null:i},dE=function(e){function t(){return sDe(this,t),uDe(this,t,arguments)}return fDe(t,e),cDe(t,[{key:"render",value:function(){var n=this.props,a=n.x,l=n.y,h=n.r,i=n.alwaysShow,_=n.clipPathId,w=Ns(a),A=Ns(l);if(Rh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!w||!A)return null;var C=mDe(this.props);if(!C)return null;var R=C.x,z=C.y,V=this.props,U=V.shape,G=V.className,H=$f(this.props,"hidden")?"url(#".concat(_,")"):void 0,J=A9(A9({clipPath:H},on(this.props,!0)),{},{cx:R,cy:z});return Pe.createElement(ci,{className:Xn("recharts-reference-dot",G)},t.renderDot(U,J),el.renderCallByParent(this.props,{x:R-h,y:z-h,width:2*h,height:2*h}))}}])}(Pe.Component);uE(dE,"displayName","ReferenceDot");uE(dE,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});uE(dE,"renderDot",function(e,t){var r;return Pe.isValidElement(e)?r=Pe.cloneElement(e,t):Cn(e)?r=e(t):r=Pe.createElement(k0,FI({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function VI(){return VI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VI.apply(this,arguments)}function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function T9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T9(Object(r),!0).forEach(function(n){hE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Uee(n.key),n)}}function vDe(e,t,r){return t&&yDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _De(e,t,r){return t=WT(t),xDe(e,Vee()?Reflect.construct(t,r||[],WT(e).constructor):t.apply(e,r))}function xDe(e,t){if(t&&(Hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bDe(e)}function bDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vee=function(){return!!e})()}function WT(e){return WT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WT(e)}function wDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UI(e,t)}function UI(e,t){return UI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},UI(e,t)}function hE(e,t,r){return t=Uee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uee(e){var t=SDe(e,"string");return Hx(t)=="symbol"?t:t+""}function SDe(e,t){if(Hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ADe=function(t,r,n,a,l){var h=l.x1,i=l.x2,_=l.y1,w=l.y2,A=l.xAxis,C=l.yAxis;if(!A||!C)return null;var R=HL({x:A.scale,y:C.scale}),z={x:t?R.x.apply(h,{position:"start"}):R.x.rangeMin,y:n?R.y.apply(_,{position:"start"}):R.y.rangeMin},V={x:r?R.x.apply(i,{position:"end"}):R.x.rangeMax,y:a?R.y.apply(w,{position:"end"}):R.y.rangeMax};return $f(l,"discard")&&(!R.isInRange(z)||!R.isInRange(V))?null:Cee(z,V)},fE=function(e){function t(){return gDe(this,t),_De(this,t,arguments)}return wDe(t,e),vDe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,l=n.x2,h=n.y1,i=n.y2,_=n.className,w=n.alwaysShow,A=n.clipPathId;Rh(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var C=Ns(a),R=Ns(l),z=Ns(h),V=Ns(i),U=this.props.shape;if(!C&&!R&&!z&&!V&&!U)return null;var G=ADe(C,R,z,V,this.props);if(!G&&!U)return null;var H=$f(this.props,"hidden")?"url(#".concat(A,")"):void 0;return Pe.createElement(ci,{className:Xn("recharts-reference-area",_)},t.renderRect(U,P9(P9({clipPath:H},on(this.props,!0)),G)),el.renderCallByParent(this.props,G))}}])}(Pe.Component);hE(fE,"displayName","ReferenceArea");hE(fE,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});hE(fE,"renderRect",function(e,t){var r;return Pe.isValidElement(e)?r=Pe.cloneElement(e,t):Cn(e)?r=e(t):r=Pe.createElement(WL,VI({},t,{className:"recharts-reference-area-rect"})),r});function $ee(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function TDe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return OIe(n,r)}function PDe(e,t,r){var n=r==="width",a=e.x,l=e.y,h=e.width,i=e.height;return t===1?{start:n?a:l,end:n?a+h:l+i}:{start:n?a+h:l+i,end:n?a:l}}function HT(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var l=r();return e*(t-e*l/2-n)>=0&&e*(t+e*l/2-a)<=0}function EDe(e,t){return $ee(e,t+1)}function CDe(e,t,r,n,a){for(var l=(n||[]).slice(),h=t.start,i=t.end,_=0,w=1,A=h,C=function(){var V=n==null?void 0:n[_];if(V===void 0)return{v:$ee(n,w)};var U=_,G,H=function(){return G===void 0&&(G=r(V,U)),G},J=V.coordinate,Q=_===0||HT(e,J,H,A,i);Q||(_=0,A=h,w+=1),Q&&(A=J+e*(H()/2+a),_+=w)},R;w<=l.length;)if(R=C(),R)return R.v;return[]}function Nw(e){"@babel/helpers - typeof";return Nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nw(e)}function E9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E9(Object(r),!0).forEach(function(n){MDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MDe(e,t,r){return t=ODe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ODe(e){var t=RDe(e,"string");return Nw(t)=="symbol"?t:t+""}function RDe(e,t){if(Nw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kDe(e,t,r,n,a){for(var l=(n||[]).slice(),h=l.length,i=t.start,_=t.end,w=function(R){var z=l[R],V,U=function(){return V===void 0&&(V=r(z,R)),V};if(R===h-1){var G=e*(z.coordinate+e*U()/2-_);l[R]=z=Dl(Dl({},z),{},{tickCoord:G>0?z.coordinate-G*e:z.coordinate})}else l[R]=z=Dl(Dl({},z),{},{tickCoord:z.coordinate});var H=HT(e,z.tickCoord,U,i,_);H&&(_=z.tickCoord-e*(U()/2+a),l[R]=Dl(Dl({},z),{},{isShow:!0}))},A=h-1;A>=0;A--)w(A);return l}function jDe(e,t,r,n,a,l){var h=(n||[]).slice(),i=h.length,_=t.start,w=t.end;if(l){var A=n[i-1],C=r(A,i-1),R=e*(A.coordinate+e*C/2-w);h[i-1]=A=Dl(Dl({},A),{},{tickCoord:R>0?A.coordinate-R*e:A.coordinate});var z=HT(e,A.tickCoord,function(){return C},_,w);z&&(w=A.tickCoord-e*(C/2+a),h[i-1]=Dl(Dl({},A),{},{isShow:!0}))}for(var V=l?i-1:i,U=function(J){var Q=h[J],le,ne=function(){return le===void 0&&(le=r(Q,J)),le};if(J===0){var de=e*(Q.coordinate-e*ne()/2-_);h[J]=Q=Dl(Dl({},Q),{},{tickCoord:de<0?Q.coordinate-de*e:Q.coordinate})}else h[J]=Q=Dl(Dl({},Q),{},{tickCoord:Q.coordinate});var ue=HT(e,Q.tickCoord,ne,_,w);ue&&(_=Q.tickCoord+e*(ne()/2+a),h[J]=Dl(Dl({},Q),{},{isShow:!0}))},G=0;G<V;G++)U(G);return h}function t4(e,t,r){var n=e.tick,a=e.ticks,l=e.viewBox,h=e.minTickGap,i=e.orientation,_=e.interval,w=e.tickFormatter,A=e.unit,C=e.angle;if(!a||!a.length||!n)return[];if(Ir(_)||Wh.isSsr)return EDe(a,typeof _=="number"&&Ir(_)?_:0);var R=[],z=i==="top"||i==="bottom"?"width":"height",V=A&&z==="width"?d1(A,{fontSize:t,letterSpacing:r}):{width:0,height:0},U=function(Q,le){var ne=Cn(w)?w(Q.value,le):Q.value;return z==="width"?TDe(d1(ne,{fontSize:t,letterSpacing:r}),V,C):d1(ne,{fontSize:t,letterSpacing:r})[z]},G=a.length>=2?tl(a[1].coordinate-a[0].coordinate):1,H=PDe(l,G,z);return _==="equidistantPreserveStart"?CDe(G,H,U,a,h):(_==="preserveStart"||_==="preserveStartEnd"?R=jDe(G,H,U,a,h,_==="preserveStartEnd"):R=kDe(G,H,U,a,h),R.filter(function(J){return J.isShow}))}var NDe=["viewBox"],IDe=["viewBox"],DDe=["ticks"];function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function sx(){return sx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sx.apply(this,arguments)}function C9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C9(Object(r),!0).forEach(function(n){r4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vj(e,t){if(e==null)return{};var r=LDe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function LDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gee(n.key),n)}}function FDe(e,t,r){return t&&M9(e.prototype,t),r&&M9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function BDe(e,t,r){return t=ZT(t),VDe(e,qee()?Reflect.construct(t,r||[],ZT(e).constructor):t.apply(e,r))}function VDe(e,t){if(t&&(Zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UDe(e)}function UDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qee=function(){return!!e})()}function ZT(e){return ZT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ZT(e)}function $De(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$I(e,t)}function $I(e,t){return $I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$I(e,t)}function r4(e,t,r){return t=Gee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gee(e){var t=qDe(e,"string");return Zx(t)=="symbol"?t:t+""}function qDe(e,t){if(Zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var N0=function(e){function t(r){var n;return zDe(this,t),n=BDe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return $De(t,e),FDe(t,[{key:"shouldComponentUpdate",value:function(n,a){var l=n.viewBox,h=vj(n,NDe),i=this.props,_=i.viewBox,w=vj(i,IDe);return!px(l,_)||!px(h,w)||!px(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,l=a.x,h=a.y,i=a.width,_=a.height,w=a.orientation,A=a.tickSize,C=a.mirror,R=a.tickMargin,z,V,U,G,H,J,Q=C?-1:1,le=n.tickSize||A,ne=Ir(n.tickCoord)?n.tickCoord:n.coordinate;switch(w){case"top":z=V=n.coordinate,G=h+ +!C*_,U=G-Q*le,J=U-Q*R,H=ne;break;case"left":U=G=n.coordinate,V=l+ +!C*i,z=V-Q*le,H=z-Q*R,J=ne;break;case"right":U=G=n.coordinate,V=l+ +C*i,z=V+Q*le,H=z+Q*R,J=ne;break;default:z=V=n.coordinate,G=h+ +C*_,U=G+Q*le,J=U+Q*R,H=ne;break}return{line:{x1:z,y1:U,x2:V,y2:G},tick:{x:H,y:J}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,h;switch(a){case"left":h=l?"start":"end";break;case"right":h=l?"end":"start";break;default:h="middle";break}return h}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,l=n.mirror,h="end";switch(a){case"left":case"right":h="middle";break;case"top":h=l?"start":"end";break;default:h=l?"end":"start";break}return h}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,l=n.y,h=n.width,i=n.height,_=n.orientation,w=n.mirror,A=n.axisLine,C=tc(tc(tc({},on(this.props,!1)),on(A,!1)),{},{fill:"none"});if(_==="top"||_==="bottom"){var R=+(_==="top"&&!w||_==="bottom"&&w);C=tc(tc({},C),{},{x1:a,y1:l+R*i,x2:a+h,y2:l+R*i})}else{var z=+(_==="left"&&!w||_==="right"&&w);C=tc(tc({},C),{},{x1:a+z*h,y1:l,x2:a+z*h,y2:l+i})}return Pe.createElement("line",sx({},C,{className:Xn("recharts-cartesian-axis-line",Au(A,"className"))}))}},{key:"renderTicks",value:function(n,a,l){var h=this,i=this.props,_=i.tickLine,w=i.stroke,A=i.tick,C=i.tickFormatter,R=i.unit,z=t4(tc(tc({},this.props),{},{ticks:n}),a,l),V=this.getTickTextAnchor(),U=this.getTickVerticalAnchor(),G=on(this.props,!1),H=on(A,!1),J=tc(tc({},G),{},{fill:"none"},on(_,!1)),Q=z.map(function(le,ne){var de=h.getTickLineCoord(le),ue=de.line,ve=de.tick,Ae=tc(tc(tc(tc({textAnchor:V,verticalAnchor:U},G),{},{stroke:"none",fill:w},H),ve),{},{index:ne,payload:le,visibleTicksCount:z.length,tickFormatter:C});return Pe.createElement(ci,sx({className:"recharts-cartesian-axis-tick",key:"tick-".concat(le.value,"-").concat(le.coordinate,"-").concat(le.tickCoord)},Wf(h.props,le,ne)),_&&Pe.createElement("line",sx({},J,ue,{className:Xn("recharts-cartesian-axis-tick-line",Au(_,"className"))})),A&&t.renderTickItem(A,Ae,"".concat(Cn(C)?C(le.value,ne):le.value).concat(R||"")))});return Pe.createElement("g",{className:"recharts-cartesian-axis-ticks"},Q)}},{key:"render",value:function(){var n=this,a=this.props,l=a.axisLine,h=a.width,i=a.height,_=a.ticksGenerator,w=a.className,A=a.hide;if(A)return null;var C=this.props,R=C.ticks,z=vj(C,DDe),V=R;return Cn(_)&&(V=R&&R.length>0?_(this.props):_(z)),h<=0||i<=0||!V||!V.length?null:Pe.createElement(ci,{className:Xn("recharts-cartesian-axis",w),ref:function(G){n.layerReference=G}},l&&this.renderAxisLine(),this.renderTicks(V,this.state.fontSize,this.state.letterSpacing),el.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,l){var h;return Pe.isValidElement(n)?h=Pe.cloneElement(n,a):Cn(n)?h=n(a):h=Pe.createElement(Rv,sx({},a,{className:"recharts-cartesian-axis-tick-value"}),l),h}}])}(K.Component);r4(N0,"displayName","CartesianAxis");r4(N0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var GDe=["x1","y1","x2","y2","key"],KDe=["offset"];function Nv(e){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function O9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ll(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O9(Object(r),!0).forEach(function(n){WDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WDe(e,t,r){return t=HDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HDe(e){var t=ZDe(e,"string");return Nv(t)=="symbol"?t:t+""}function ZDe(e,t){if(Nv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gv(){return gv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gv.apply(this,arguments)}function R9(e,t){if(e==null)return{};var r=YDe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var XDe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,l=t.y,h=t.width,i=t.height,_=t.ry;return Pe.createElement("rect",{x:a,y:l,ry:_,width:h,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function Kee(e,t){var r;if(Pe.isValidElement(e))r=Pe.cloneElement(e,t);else if(Cn(e))r=e(t);else{var n=t.x1,a=t.y1,l=t.x2,h=t.y2,i=t.key,_=R9(t,GDe),w=on(_,!1);w.offset;var A=R9(w,KDe);r=Pe.createElement("line",gv({},A,{x1:n,y1:a,x2:l,y2:h,fill:"none",key:i}))}return r}function JDe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,l=e.horizontalPoints;if(!a||!l||!l.length)return null;var h=l.map(function(i,_){var w=Ll(Ll({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(_),index:_});return Kee(a,w)});return Pe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},h)}function QDe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,l=e.verticalPoints;if(!a||!l||!l.length)return null;var h=l.map(function(i,_){var w=Ll(Ll({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(_),index:_});return Kee(a,w)});return Pe.createElement("g",{className:"recharts-cartesian-grid-vertical"},h)}function e3e(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,l=e.width,h=e.height,i=e.horizontalPoints,_=e.horizontal,w=_===void 0?!0:_;if(!w||!t||!t.length)return null;var A=i.map(function(R){return Math.round(R+a-a)}).sort(function(R,z){return R-z});a!==A[0]&&A.unshift(0);var C=A.map(function(R,z){var V=!A[z+1],U=V?a+h-R:A[z+1]-R;if(U<=0)return null;var G=z%t.length;return Pe.createElement("rect",{key:"react-".concat(z),y:R,x:n,height:U,width:l,stroke:"none",fill:t[G],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Pe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},C)}function t3e(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,l=e.x,h=e.y,i=e.width,_=e.height,w=e.verticalPoints;if(!r||!n||!n.length)return null;var A=w.map(function(R){return Math.round(R+l-l)}).sort(function(R,z){return R-z});l!==A[0]&&A.unshift(0);var C=A.map(function(R,z){var V=!A[z+1],U=V?l+i-R:A[z+1]-R;if(U<=0)return null;var G=z%n.length;return Pe.createElement("rect",{key:"react-".concat(z),x:R,y:h,width:U,height:_,stroke:"none",fill:n[G],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Pe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},C)}var r3e=function(t,r){var n=t.xAxis,a=t.width,l=t.height,h=t.offset;return FQ(t4(Ll(Ll(Ll({},N0.defaultProps),n),{},{ticks:tm(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),h.left,h.left+h.width,r)},n3e=function(t,r){var n=t.yAxis,a=t.width,l=t.height,h=t.offset;return FQ(t4(Ll(Ll(Ll({},N0.defaultProps),n),{},{ticks:tm(n,!0),viewBox:{x:0,y:0,width:a,height:l}})),h.top,h.top+h.height,r)},H_={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function js(e){var t,r,n,a,l,h,i=XL(),_=JL(),w=qIe(),A=Ll(Ll({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:H_.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:H_.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:H_.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:H_.horizontalFill,vertical:(l=e.vertical)!==null&&l!==void 0?l:H_.vertical,verticalFill:(h=e.verticalFill)!==null&&h!==void 0?h:H_.verticalFill,x:Ir(e.x)?e.x:w.left,y:Ir(e.y)?e.y:w.top,width:Ir(e.width)?e.width:w.width,height:Ir(e.height)?e.height:w.height}),C=A.x,R=A.y,z=A.width,V=A.height,U=A.syncWithTicks,G=A.horizontalValues,H=A.verticalValues,J=VIe(),Q=UIe();if(!Ir(z)||z<=0||!Ir(V)||V<=0||!Ir(C)||C!==+C||!Ir(R)||R!==+R)return null;var le=A.verticalCoordinatesGenerator||r3e,ne=A.horizontalCoordinatesGenerator||n3e,de=A.horizontalPoints,ue=A.verticalPoints;if((!de||!de.length)&&Cn(ne)){var ve=G&&G.length,Ae=ne({yAxis:Q?Ll(Ll({},Q),{},{ticks:ve?G:Q.ticks}):void 0,width:i,height:_,offset:w},ve?!0:U);Rh(Array.isArray(Ae),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Nv(Ae),"]")),Array.isArray(Ae)&&(de=Ae)}if((!ue||!ue.length)&&Cn(le)){var Oe=H&&H.length,Se=le({xAxis:J?Ll(Ll({},J),{},{ticks:Oe?H:J.ticks}):void 0,width:i,height:_,offset:w},Oe?!0:U);Rh(Array.isArray(Se),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Nv(Se),"]")),Array.isArray(Se)&&(ue=Se)}return Pe.createElement("g",{className:"recharts-cartesian-grid"},Pe.createElement(XDe,{fill:A.fill,fillOpacity:A.fillOpacity,x:A.x,y:A.y,width:A.width,height:A.height,ry:A.ry}),Pe.createElement(JDe,gv({},A,{offset:w,horizontalPoints:de,xAxis:J,yAxis:Q})),Pe.createElement(QDe,gv({},A,{offset:w,verticalPoints:ue,xAxis:J,yAxis:Q})),Pe.createElement(e3e,gv({},A,{horizontalPoints:de})),Pe.createElement(t3e,gv({},A,{verticalPoints:ue})))}js.displayName="CartesianGrid";var i3e=["type","layout","connectNulls","ref"],a3e=["key"];function Yx(e){"@babel/helpers - typeof";return Yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yx(e)}function k9(e,t){if(e==null)return{};var r=o3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function y1(){return y1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y1.apply(this,arguments)}function j9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j9(Object(r),!0).forEach(function(n){Ah(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z_(e){return u3e(e)||c3e(e)||l3e(e)||s3e()}function s3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l3e(e,t){if(e){if(typeof e=="string")return qI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qI(e,t)}}function c3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function u3e(e){if(Array.isArray(e))return qI(e)}function qI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hee(n.key),n)}}function h3e(e,t,r){return t&&N9(e.prototype,t),r&&N9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function f3e(e,t,r){return t=YT(t),p3e(e,Wee()?Reflect.construct(t,r||[],YT(e).constructor):t.apply(e,r))}function p3e(e,t){if(t&&(Yx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return m3e(e)}function m3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wee=function(){return!!e})()}function YT(e){return YT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},YT(e)}function g3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&GI(e,t)}function GI(e,t){return GI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},GI(e,t)}function Ah(e,t,r){return t=Hee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hee(e){var t=y3e(e,"string");return Yx(t)=="symbol"?t:t+""}function y3e(e,t){if(Yx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var _u=function(e){function t(){var r;d3e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=f3e(this,t,[].concat(a)),Ah(r,"state",{isAnimationFinished:!0,totalLength:0}),Ah(r,"generateSimpleStrokeDasharray",function(h,i){return"".concat(i,"px ").concat(h-i,"px")}),Ah(r,"getStrokeDasharray",function(h,i,_){var w=_.reduce(function(H,J){return H+J});if(!w)return r.generateSimpleStrokeDasharray(i,h);for(var A=Math.floor(h/w),C=h%w,R=i-h,z=[],V=0,U=0;V<_.length;U+=_[V],++V)if(U+_[V]>C){z=[].concat(Z_(_.slice(0,V)),[C-U]);break}var G=z.length%2===0?[0,R]:[R];return[].concat(Z_(t.repeat(_,A)),Z_(z),G).map(function(H){return"".concat(H,"px")}).join(", ")}),Ah(r,"id",Hg("recharts-line-")),Ah(r,"pathRef",function(h){r.mainCurve=h}),Ah(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Ah(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return g3e(t,e),h3e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,h=l.points,i=l.xAxis,_=l.yAxis,w=l.layout,A=l.children,C=Bl(A,R0);if(!C)return null;var R=function(U,G){return{x:U.x,y:U.y,value:U.value,errorVal:Ia(U.payload,G)}},z={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Pe.createElement(ci,z,C.map(function(V){return Pe.cloneElement(V,{key:"bar-".concat(V.props.dataKey),data:h,xAxis:i,yAxis:_,layout:w,dataPointFormatter:R})}))}},{key:"renderDots",value:function(n,a,l){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var i=this.props,_=i.dot,w=i.points,A=i.dataKey,C=on(this.props,!1),R=on(_,!0),z=w.map(function(U,G){var H=pu(pu(pu({key:"dot-".concat(G),r:3},C),R),{},{value:U.value,dataKey:A,cx:U.x,cy:U.y,index:G,payload:U.payload});return t.renderDotItem(_,H)}),V={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return Pe.createElement(ci,y1({className:"recharts-line-dots",key:"dots"},V),z)}},{key:"renderCurveStatically",value:function(n,a,l,h){var i=this.props,_=i.type,w=i.layout,A=i.connectNulls;i.ref;var C=k9(i,i3e),R=pu(pu(pu({},on(C,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(l,")"):null,points:n},h),{},{type:_,layout:w,connectNulls:A});return Pe.createElement(Rg,y1({},R,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var l=this,h=this.props,i=h.points,_=h.strokeDasharray,w=h.isAnimationActive,A=h.animationBegin,C=h.animationDuration,R=h.animationEasing,z=h.animationId,V=h.animateNewValues,U=h.width,G=h.height,H=this.state,J=H.prevPoints,Q=H.totalLength;return Pe.createElement(Bc,{begin:A,duration:C,isActive:w,easing:R,from:{t:0},to:{t:1},key:"line-".concat(z),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(le){var ne=le.t;if(J){var de=J.length/i.length,ue=i.map(function(ke,ze){var et=Math.floor(ze*de);if(J[et]){var je=J[et],Ne=Sa(je.x,ke.x),Ye=Sa(je.y,ke.y);return pu(pu({},ke),{},{x:Ne(ne),y:Ye(ne)})}if(V){var $e=Sa(U*2,ke.x),We=Sa(G/2,ke.y);return pu(pu({},ke),{},{x:$e(ne),y:We(ne)})}return pu(pu({},ke),{},{x:ke.x,y:ke.y})});return l.renderCurveStatically(ue,n,a)}var ve=Sa(0,Q),Ae=ve(ne),Oe;if(_){var Se="".concat(_).split(/[,\s]+/gim).map(function(ke){return parseFloat(ke)});Oe=l.getStrokeDasharray(Ae,Q,Se)}else Oe=l.generateSimpleStrokeDasharray(Q,Ae);return l.renderCurveStatically(i,n,a,{strokeDasharray:Oe})})}},{key:"renderCurve",value:function(n,a){var l=this.props,h=l.points,i=l.isAnimationActive,_=this.state,w=_.prevPoints,A=_.totalLength;return i&&h&&h.length&&(!w&&A>0||!Hf(w,h))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(h,n,a)}},{key:"render",value:function(){var n,a=this.props,l=a.hide,h=a.dot,i=a.points,_=a.className,w=a.xAxis,A=a.yAxis,C=a.top,R=a.left,z=a.width,V=a.height,U=a.isAnimationActive,G=a.id;if(l||!i||!i.length)return null;var H=this.state.isAnimationFinished,J=i.length===1,Q=Xn("recharts-line",_),le=w&&w.allowDataOverflow,ne=A&&A.allowDataOverflow,de=le||ne,ue=Gn(G)?this.id:G,ve=(n=on(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Ae=ve.r,Oe=Ae===void 0?3:Ae,Se=ve.strokeWidth,ke=Se===void 0?2:Se,ze=VX(h)?h:{},et=ze.clipDot,je=et===void 0?!0:et,Ne=Oe*2+ke;return Pe.createElement(ci,{className:Q},le||ne?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(ue)},Pe.createElement("rect",{x:le?R:R-z/2,y:ne?C:C-V/2,width:le?z:z*2,height:ne?V:V*2})),!je&&Pe.createElement("clipPath",{id:"clipPath-dots-".concat(ue)},Pe.createElement("rect",{x:R-Ne/2,y:C-Ne/2,width:z+Ne,height:V+Ne}))):null,!J&&this.renderCurve(de,ue),this.renderErrorBar(de,ue),(J||h)&&this.renderDots(de,je,ue),(!U||H)&&Tu.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var l=n.length%2!==0?[].concat(Z_(n),[0]):n,h=[],i=0;i<a;++i)h=[].concat(Z_(h),Z_(l));return h}},{key:"renderDotItem",value:function(n,a){var l;if(Pe.isValidElement(n))l=Pe.cloneElement(n,a);else if(Cn(n))l=n(a);else{var h=a.key,i=k9(a,a3e),_=Xn("recharts-line-dot",typeof n!="boolean"?n.className:"");l=Pe.createElement(k0,y1({key:h},i,{className:_}))}return l}}])}(K.PureComponent);Ah(_u,"displayName","Line");Ah(_u,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Wh.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Ah(_u,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,l=e.yAxisTicks,h=e.dataKey,i=e.bandSize,_=e.displayedData,w=e.offset,A=t.layout,C=_.map(function(R,z){var V=Ia(R,h);return A==="horizontal"?{x:Ix({axis:r,ticks:a,bandSize:i,entry:R,index:z}),y:Gn(V)?null:n.scale(V),value:V,payload:R}:{x:Gn(V)?null:r.scale(V),y:Ix({axis:n,ticks:l,bandSize:i,entry:R,index:z}),value:V,payload:R}});return pu({points:C,layout:A},w)});var v3e=["layout","type","stroke","connectNulls","isRange","ref"],_3e=["key"],Zee;function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function Yee(e,t){if(e==null)return{};var r=x3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function x3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yv(){return yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yv.apply(this,arguments)}function I9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I9(Object(r),!0).forEach(function(n){Df(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jee(n.key),n)}}function w3e(e,t,r){return t&&D9(e.prototype,t),r&&D9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S3e(e,t,r){return t=XT(t),A3e(e,Xee()?Reflect.construct(t,r||[],XT(e).constructor):t.apply(e,r))}function A3e(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T3e(e)}function T3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xee=function(){return!!e})()}function XT(e){return XT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XT(e)}function P3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&KI(e,t)}function KI(e,t){return KI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},KI(e,t)}function Df(e,t,r){return t=Jee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jee(e){var t=E3e(e,"string");return Xx(t)=="symbol"?t:t+""}function E3e(e,t){if(Xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var xm=function(e){function t(){var r;b3e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=S3e(this,t,[].concat(a)),Df(r,"state",{isAnimationFinished:!0}),Df(r,"id",Hg("recharts-area-")),Df(r,"handleAnimationEnd",function(){var h=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Cn(h)&&h()}),Df(r,"handleAnimationStart",function(){var h=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Cn(h)&&h()}),r}return P3e(t,e),w3e(t,[{key:"renderDots",value:function(n,a,l){var h=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(h&&!i)return null;var _=this.props,w=_.dot,A=_.points,C=_.dataKey,R=on(this.props,!1),z=on(w,!0),V=A.map(function(G,H){var J=wg(wg(wg({key:"dot-".concat(H),r:3},R),z),{},{index:H,cx:G.x,cy:G.y,dataKey:C,value:G.value,payload:G.payload,points:A});return t.renderDotItem(w,J)}),U={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(l,")"):null};return Pe.createElement(ci,yv({className:"recharts-area-dots"},U),V)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,l=a.baseLine,h=a.points,i=a.strokeWidth,_=h[0].x,w=h[h.length-1].x,A=n*Math.abs(_-w),C=Pg(h.map(function(R){return R.y||0}));return Ir(l)&&typeof l=="number"?C=Math.max(l,C):l&&Array.isArray(l)&&l.length&&(C=Math.max(Pg(l.map(function(R){return R.y||0})),C)),Ir(C)?Pe.createElement("rect",{x:_<w?_:_-A,y:0,width:A,height:Math.floor(C+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,l=a.baseLine,h=a.points,i=a.strokeWidth,_=h[0].y,w=h[h.length-1].y,A=n*Math.abs(_-w),C=Pg(h.map(function(R){return R.x||0}));return Ir(l)&&typeof l=="number"?C=Math.max(l,C):l&&Array.isArray(l)&&l.length&&(C=Math.max(Pg(l.map(function(R){return R.x||0})),C)),Ir(C)?Pe.createElement("rect",{x:0,y:_<w?_:_-A,width:C+(i?parseInt("".concat(i),10):1),height:Math.floor(A)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,l,h){var i=this.props,_=i.layout,w=i.type,A=i.stroke,C=i.connectNulls,R=i.isRange;i.ref;var z=Yee(i,v3e);return Pe.createElement(ci,{clipPath:l?"url(#clipPath-".concat(h,")"):null},Pe.createElement(Rg,yv({},on(z,!0),{points:n,connectNulls:C,type:w,baseLine:a,layout:_,stroke:"none",className:"recharts-area-area"})),A!=="none"&&Pe.createElement(Rg,yv({},on(this.props,!1),{className:"recharts-area-curve",layout:_,type:w,connectNulls:C,fill:"none",points:n})),A!=="none"&&R&&Pe.createElement(Rg,yv({},on(this.props,!1),{className:"recharts-area-curve",layout:_,type:w,connectNulls:C,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var l=this,h=this.props,i=h.points,_=h.baseLine,w=h.isAnimationActive,A=h.animationBegin,C=h.animationDuration,R=h.animationEasing,z=h.animationId,V=this.state,U=V.prevPoints,G=V.prevBaseLine;return Pe.createElement(Bc,{begin:A,duration:C,isActive:w,easing:R,from:{t:0},to:{t:1},key:"area-".concat(z),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(H){var J=H.t;if(U){var Q=U.length/i.length,le=i.map(function(ve,Ae){var Oe=Math.floor(Ae*Q);if(U[Oe]){var Se=U[Oe],ke=Sa(Se.x,ve.x),ze=Sa(Se.y,ve.y);return wg(wg({},ve),{},{x:ke(J),y:ze(J)})}return ve}),ne;if(Ir(_)&&typeof _=="number"){var de=Sa(G,_);ne=de(J)}else if(Gn(_)||P0(_)){var ue=Sa(G,0);ne=ue(J)}else ne=_.map(function(ve,Ae){var Oe=Math.floor(Ae*Q);if(G[Oe]){var Se=G[Oe],ke=Sa(Se.x,ve.x),ze=Sa(Se.y,ve.y);return wg(wg({},ve),{},{x:ke(J),y:ze(J)})}return ve});return l.renderAreaStatically(le,ne,n,a)}return Pe.createElement(ci,null,Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"animationClipPath-".concat(a)},l.renderClipRect(J))),Pe.createElement(ci,{clipPath:"url(#animationClipPath-".concat(a,")")},l.renderAreaStatically(i,_,n,a)))})}},{key:"renderArea",value:function(n,a){var l=this.props,h=l.points,i=l.baseLine,_=l.isAnimationActive,w=this.state,A=w.prevPoints,C=w.prevBaseLine,R=w.totalLength;return _&&h&&h.length&&(!A&&R>0||!Hf(A,h)||!Hf(C,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(h,i,n,a)}},{key:"render",value:function(){var n,a=this.props,l=a.hide,h=a.dot,i=a.points,_=a.className,w=a.top,A=a.left,C=a.xAxis,R=a.yAxis,z=a.width,V=a.height,U=a.isAnimationActive,G=a.id;if(l||!i||!i.length)return null;var H=this.state.isAnimationFinished,J=i.length===1,Q=Xn("recharts-area",_),le=C&&C.allowDataOverflow,ne=R&&R.allowDataOverflow,de=le||ne,ue=Gn(G)?this.id:G,ve=(n=on(h,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Ae=ve.r,Oe=Ae===void 0?3:Ae,Se=ve.strokeWidth,ke=Se===void 0?2:Se,ze=VX(h)?h:{},et=ze.clipDot,je=et===void 0?!0:et,Ne=Oe*2+ke;return Pe.createElement(ci,{className:Q},le||ne?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(ue)},Pe.createElement("rect",{x:le?A:A-z/2,y:ne?w:w-V/2,width:le?z:z*2,height:ne?V:V*2})),!je&&Pe.createElement("clipPath",{id:"clipPath-dots-".concat(ue)},Pe.createElement("rect",{x:A-Ne/2,y:w-Ne/2,width:z+Ne,height:V+Ne}))):null,J?null:this.renderArea(de,ue),(h||J)&&this.renderDots(de,je,ue),(!U||H)&&Tu.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(K.PureComponent);Zee=xm;Df(xm,"displayName","Area");Df(xm,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Wh.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Df(xm,"getBaseValue",function(e,t,r,n){var a=e.layout,l=e.baseValue,h=t.props.baseValue,i=h??l;if(Ir(i)&&typeof i=="number")return i;var _=a==="horizontal"?n:r,w=_.scale.domain();if(_.type==="number"){var A=Math.max(w[0],w[1]),C=Math.min(w[0],w[1]);return i==="dataMin"?C:i==="dataMax"||A<0?A:Math.max(Math.min(w[0],w[1]),0)}return i==="dataMin"?w[0]:i==="dataMax"?w[1]:w[0]});Df(xm,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,l=e.xAxisTicks,h=e.yAxisTicks,i=e.bandSize,_=e.dataKey,w=e.stackedData,A=e.dataStartIndex,C=e.displayedData,R=e.offset,z=t.layout,V=w&&w.length,U=Zee.getBaseValue(t,r,n,a),G=z==="horizontal",H=!1,J=C.map(function(le,ne){var de;V?de=w[A+ne]:(de=Ia(le,_),Array.isArray(de)?H=!0:de=[U,de]);var ue=de[1]==null||V&&Ia(le,_)==null;return G?{x:Ix({axis:n,ticks:l,bandSize:i,entry:le,index:ne}),y:ue?null:a.scale(de[1]),value:de,payload:le}:{x:ue?null:n.scale(de[1]),y:Ix({axis:a,ticks:h,bandSize:i,entry:le,index:ne}),value:de,payload:le}}),Q;return V||H?Q=J.map(function(le){var ne=Array.isArray(le.value)?le.value[0]:null;return G?{x:le.x,y:ne!=null&&le.y!=null?a.scale(ne):null}:{x:ne!=null?n.scale(ne):null,y:le.y}}):Q=G?a.scale(U):n.scale(U),wg({points:J,baseLine:Q,layout:z,isRange:H},R)});Df(xm,"renderDotItem",function(e,t){var r;if(Pe.isValidElement(e))r=Pe.cloneElement(e,t);else if(Cn(e))r=e(t);else{var n=Xn("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,l=Yee(t,_3e);r=Pe.createElement(k0,yv({},l,{key:a,className:n}))}return r});function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function C3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tte(n.key),n)}}function O3e(e,t,r){return t&&M3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function R3e(e,t,r){return t=JT(t),k3e(e,Qee()?Reflect.construct(t,r||[],JT(e).constructor):t.apply(e,r))}function k3e(e,t){if(t&&(Jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j3e(e)}function j3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qee=function(){return!!e})()}function JT(e){return JT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JT(e)}function N3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WI(e,t)}function WI(e,t){return WI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},WI(e,t)}function ete(e,t,r){return t=tte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tte(e){var t=I3e(e,"string");return Jx(t)=="symbol"?t:t+""}function I3e(e,t){if(Jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gS=function(e){function t(){return C3e(this,t),R3e(this,t,arguments)}return N3e(t,e),O3e(t,[{key:"render",value:function(){return null}}])}(Pe.Component);ete(gS,"displayName","ZAxis");ete(gS,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var D3e=["option","isActive"];function v1(){return v1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v1.apply(this,arguments)}function L3e(e,t){if(e==null)return{};var r=z3e(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function z3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function F3e(e){var t=e.option,r=e.isActive,n=L3e(e,D3e);return typeof t=="string"?Pe.createElement(Cw,v1({option:Pe.createElement(GP,v1({type:t},n)),isActive:r,shapeType:"symbols"},n)):Pe.createElement(Cw,v1({option:t,isActive:r,shapeType:"symbols"},n))}function Qx(e){"@babel/helpers - typeof";return Qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qx(e)}function _1(){return _1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_1.apply(this,arguments)}function L9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _d(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L9(Object(r),!0).forEach(function(n){Cg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z9(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nte(n.key),n)}}function V3e(e,t,r){return t&&z9(e.prototype,t),r&&z9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function U3e(e,t,r){return t=QT(t),$3e(e,rte()?Reflect.construct(t,r||[],QT(e).constructor):t.apply(e,r))}function $3e(e,t){if(t&&(Qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q3e(e)}function q3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rte=function(){return!!e})()}function QT(e){return QT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QT(e)}function G3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},HI(e,t)}function Cg(e,t,r){return t=nte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nte(e){var t=K3e(e,"string");return Qx(t)=="symbol"?t:t+""}function K3e(e,t){if(Qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var I0=function(e){function t(){var r;B3e(this,t);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return r=U3e(this,t,[].concat(a)),Cg(r,"state",{isAnimationFinished:!1}),Cg(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),Cg(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),Cg(r,"id",Hg("recharts-scatter-")),r}return G3e(t,e),V3e(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,l=this.props,h=l.shape,i=l.activeShape,_=l.activeIndex,w=on(this.props,!1);return n.map(function(A,C){var R=_===C,z=R?i:h,V=_d(_d({},w),A);return Pe.createElement(ci,_1({className:"recharts-scatter-symbol",key:"symbol-".concat(A==null?void 0:A.cx,"-").concat(A==null?void 0:A.cy,"-").concat(A==null?void 0:A.size,"-").concat(C)},Wf(a.props,A,C),{role:"img"}),Pe.createElement(F3e,_1({option:z,isActive:R,key:"symbol-".concat(C)},V)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,l=a.points,h=a.isAnimationActive,i=a.animationBegin,_=a.animationDuration,w=a.animationEasing,A=a.animationId,C=this.state.prevPoints;return Pe.createElement(Bc,{begin:i,duration:_,isActive:h,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(R){var z=R.t,V=l.map(function(U,G){var H=C&&C[G];if(H){var J=Sa(H.cx,U.cx),Q=Sa(H.cy,U.cy),le=Sa(H.size,U.size);return _d(_d({},U),{},{cx:J(z),cy:Q(z),size:le(z)})}var ne=Sa(0,U.size);return _d(_d({},U),{},{size:ne(z)})});return Pe.createElement(ci,null,n.renderSymbolsStatically(V))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,l=n.isAnimationActive,h=this.state.prevPoints;return l&&a&&a.length&&(!h||!Hf(h,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,l=a.points,h=a.xAxis,i=a.yAxis,_=a.children,w=Bl(_,R0);return w?w.map(function(A,C){var R=A.props,z=R.direction,V=R.dataKey;return Pe.cloneElement(A,{key:"".concat(z,"-").concat(V,"-").concat(l[C]),data:l,xAxis:h,yAxis:i,layout:z==="x"?"vertical":"horizontal",dataPointFormatter:function(G,H){return{x:G.cx,y:G.cy,value:z==="x"?+G.node.x:+G.node.y,errorVal:Ia(G,H)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,l=n.line,h=n.lineType,i=n.lineJointType,_=on(this.props,!1),w=on(l,!1),A,C;if(h==="joint")A=a.map(function(Q){return{x:Q.cx,y:Q.cy}});else if(h==="fitting"){var R=lwe(a),z=R.xmin,V=R.xmax,U=R.a,G=R.b,H=function(le){return U*le+G};A=[{x:z,y:H(z)},{x:V,y:H(V)}]}var J=_d(_d(_d({},_),{},{fill:"none",stroke:_&&_.fill},w),{},{points:A});return Pe.isValidElement(l)?C=Pe.cloneElement(l,J):Cn(l)?C=l(J):C=Pe.createElement(Rg,_1({},J,{type:i})),Pe.createElement(ci,{className:"recharts-scatter-line",key:"recharts-scatter-line"},C)}},{key:"render",value:function(){var n=this.props,a=n.hide,l=n.points,h=n.line,i=n.className,_=n.xAxis,w=n.yAxis,A=n.left,C=n.top,R=n.width,z=n.height,V=n.id,U=n.isAnimationActive;if(a||!l||!l.length)return null;var G=this.state.isAnimationFinished,H=Xn("recharts-scatter",i),J=_&&_.allowDataOverflow,Q=w&&w.allowDataOverflow,le=J||Q,ne=Gn(V)?this.id:V;return Pe.createElement(ci,{className:H,clipPath:le?"url(#clipPath-".concat(ne,")"):null},J||Q?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(ne)},Pe.createElement("rect",{x:J?A:A-R/2,y:Q?C:C-z/2,width:J?R:R*2,height:Q?z:z*2}))):null,h&&this.renderLine(),this.renderErrorBar(),Pe.createElement(ci,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!U||G)&&Tu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(K.PureComponent);Cg(I0,"displayName","Scatter");Cg(I0,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Wh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Cg(I0,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,l=e.displayedData,h=e.xAxisTicks,i=e.yAxisTicks,_=e.offset,w=a.props.tooltipType,A=Bl(a.props.children,hm),C=Gn(t.dataKey)?a.props.dataKey:t.dataKey,R=Gn(r.dataKey)?a.props.dataKey:r.dataKey,z=n&&n.dataKey,V=n?n.range:gS.defaultProps.range,U=V&&V[0],G=t.scale.bandwidth?t.scale.bandwidth():0,H=r.scale.bandwidth?r.scale.bandwidth():0,J=l.map(function(Q,le){var ne=Ia(Q,C),de=Ia(Q,R),ue=!Gn(z)&&Ia(Q,z)||"-",ve=[{name:Gn(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:ne,payload:Q,dataKey:C,type:w},{name:Gn(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:de,payload:Q,dataKey:R,type:w}];ue!=="-"&&ve.push({name:n.name||n.dataKey,unit:n.unit||"",value:ue,payload:Q,dataKey:z,type:w});var Ae=Ix({axis:t,ticks:h,bandSize:G,entry:Q,index:le,dataKey:C}),Oe=Ix({axis:r,ticks:i,bandSize:H,entry:Q,index:le,dataKey:R}),Se=ue!=="-"?n.scale(ue):U,ke=Math.sqrt(Math.max(Se,0)/Math.PI);return _d(_d({},Q),{},{cx:Ae,cy:Oe,x:Ae-ke,y:Oe-ke,xAxis:t,yAxis:r,zAxis:n,width:2*ke,height:2*ke,size:Se,node:{x:ne,y:de,z:ue},tooltipPayload:ve,tooltipPosition:{x:Ae,y:Oe},payload:Q},A&&A[le]&&A[le].props)});return _d({points:J},_)});function e0(e){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(e)}function W3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ote(n.key),n)}}function Z3e(e,t,r){return t&&H3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y3e(e,t,r){return t=eP(t),X3e(e,ite()?Reflect.construct(t,r||[],eP(e).constructor):t.apply(e,r))}function X3e(e,t){if(t&&(e0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J3e(e)}function J3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ite(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ite=function(){return!!e})()}function eP(e){return eP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eP(e)}function Q3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZI(e,t)}function ZI(e,t){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZI(e,t)}function ate(e,t,r){return t=ote(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ote(e){var t=eLe(e,"string");return e0(t)=="symbol"?t:t+""}function eLe(e,t){if(e0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(e0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function YI(){return YI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YI.apply(this,arguments)}function tLe(e){var t=e.xAxisId,r=XL(),n=JL(),a=Iee(t);return a==null?null:Pe.createElement(N0,YI({},a,{className:Xn("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(h){return tm(h,!0)}}))}var lo=function(e){function t(){return W3e(this,t),Y3e(this,t,arguments)}return Q3e(t,e),Z3e(t,[{key:"render",value:function(){return Pe.createElement(tLe,this.props)}}])}(Pe.Component);ate(lo,"displayName","XAxis");ate(lo,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function rLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,cte(n.key),n)}}function iLe(e,t,r){return t&&nLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aLe(e,t,r){return t=tP(t),oLe(e,ste()?Reflect.construct(t,r||[],tP(e).constructor):t.apply(e,r))}function oLe(e,t){if(t&&(t0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sLe(e)}function sLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ste(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ste=function(){return!!e})()}function tP(e){return tP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tP(e)}function lLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XI(e,t)}function XI(e,t){return XI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},XI(e,t)}function lte(e,t,r){return t=cte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cte(e){var t=cLe(e,"string");return t0(t)=="symbol"?t:t+""}function cLe(e,t){if(t0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(t0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JI.apply(this,arguments)}var uLe=function(t){var r=t.yAxisId,n=XL(),a=JL(),l=Dee(r);return l==null?null:Pe.createElement(N0,JI({},l,{className:Xn("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return tm(i,!0)}}))},co=function(e){function t(){return rLe(this,t),aLe(this,t,arguments)}return lLe(t,e),iLe(t,[{key:"render",value:function(){return Pe.createElement(uLe,this.props)}}])}(Pe.Component);lte(co,"displayName","YAxis");lte(co,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function F9(e){return pLe(e)||fLe(e)||hLe(e)||dLe()}function dLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hLe(e,t){if(e){if(typeof e=="string")return QI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return QI(e,t)}}function fLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pLe(e){if(Array.isArray(e))return QI(e)}function QI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var eD=function(t,r,n,a,l){var h=Bl(t,e4),i=Bl(t,dE),_=[].concat(F9(h),F9(i)),w=Bl(t,fE),A="".concat(a,"Id"),C=a[0],R=r;if(_.length&&(R=_.reduce(function(U,G){if(G.props[A]===n&&$f(G.props,"extendDomain")&&Ir(G.props[C])){var H=G.props[C];return[Math.min(U[0],H),Math.max(U[1],H)]}return U},R)),w.length){var z="".concat(C,"1"),V="".concat(C,"2");R=w.reduce(function(U,G){if(G.props[A]===n&&$f(G.props,"extendDomain")&&Ir(G.props[z])&&Ir(G.props[V])){var H=G.props[z],J=G.props[V];return[Math.min(U[0],H,J),Math.max(U[1],H,J)]}return U},R)}return l&&l.length&&(R=l.reduce(function(U,G){return Ir(G)?[Math.min(U[0],G),Math.max(U[1],G)]:U},R)),R},_j={exports:{}},B9;function mLe(){return B9||(B9=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(_,w,A){this.fn=_,this.context=w,this.once=A||!1}function l(_,w,A,C,R){if(typeof A!="function")throw new TypeError("The listener must be a function");var z=new a(A,C||_,R),V=r?r+w:w;return _._events[V]?_._events[V].fn?_._events[V]=[_._events[V],z]:_._events[V].push(z):(_._events[V]=z,_._eventsCount++),_}function h(_,w){--_._eventsCount===0?_._events=new n:delete _._events[w]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var w=[],A,C;if(this._eventsCount===0)return w;for(C in A=this._events)t.call(A,C)&&w.push(r?C.slice(1):C);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(A)):w},i.prototype.listeners=function(w){var A=r?r+w:w,C=this._events[A];if(!C)return[];if(C.fn)return[C.fn];for(var R=0,z=C.length,V=new Array(z);R<z;R++)V[R]=C[R].fn;return V},i.prototype.listenerCount=function(w){var A=r?r+w:w,C=this._events[A];return C?C.fn?1:C.length:0},i.prototype.emit=function(w,A,C,R,z,V){var U=r?r+w:w;if(!this._events[U])return!1;var G=this._events[U],H=arguments.length,J,Q;if(G.fn){switch(G.once&&this.removeListener(w,G.fn,void 0,!0),H){case 1:return G.fn.call(G.context),!0;case 2:return G.fn.call(G.context,A),!0;case 3:return G.fn.call(G.context,A,C),!0;case 4:return G.fn.call(G.context,A,C,R),!0;case 5:return G.fn.call(G.context,A,C,R,z),!0;case 6:return G.fn.call(G.context,A,C,R,z,V),!0}for(Q=1,J=new Array(H-1);Q<H;Q++)J[Q-1]=arguments[Q];G.fn.apply(G.context,J)}else{var le=G.length,ne;for(Q=0;Q<le;Q++)switch(G[Q].once&&this.removeListener(w,G[Q].fn,void 0,!0),H){case 1:G[Q].fn.call(G[Q].context);break;case 2:G[Q].fn.call(G[Q].context,A);break;case 3:G[Q].fn.call(G[Q].context,A,C);break;case 4:G[Q].fn.call(G[Q].context,A,C,R);break;default:if(!J)for(ne=1,J=new Array(H-1);ne<H;ne++)J[ne-1]=arguments[ne];G[Q].fn.apply(G[Q].context,J)}}return!0},i.prototype.on=function(w,A,C){return l(this,w,A,C,!1)},i.prototype.once=function(w,A,C){return l(this,w,A,C,!0)},i.prototype.removeListener=function(w,A,C,R){var z=r?r+w:w;if(!this._events[z])return this;if(!A)return h(this,z),this;var V=this._events[z];if(V.fn)V.fn===A&&(!R||V.once)&&(!C||V.context===C)&&h(this,z);else{for(var U=0,G=[],H=V.length;U<H;U++)(V[U].fn!==A||R&&!V[U].once||C&&V[U].context!==C)&&G.push(V[U]);G.length?this._events[z]=G.length===1?G[0]:G:h(this,z)}return this},i.prototype.removeAllListeners=function(w){var A;return w?(A=r?r+w:w,this._events[A]&&h(this,A)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i}(_j)),_j.exports}var gLe=mLe();const yLe=ta(gLe);var xj=new yLe,bj="recharts.syncMouseEvents";function Iw(e){"@babel/helpers - typeof";return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iw(e)}function vLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ute(n.key),n)}}function xLe(e,t,r){return t&&_Le(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function wj(e,t,r){return t=ute(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ute(e){var t=bLe(e,"string");return Iw(t)=="symbol"?t:t+""}function bLe(e,t){if(Iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var wLe=function(){function e(){vLe(this,e),wj(this,"activeIndex",0),wj(this,"coordinateList",[]),wj(this,"layout","horizontal")}return xLe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,l=a===void 0?null:a,h=r.container,i=h===void 0?null:h,_=r.layout,w=_===void 0?null:_,A=r.offset,C=A===void 0?null:A,R=r.mouseHandlerCallback,z=R===void 0?null:R;this.coordinateList=(n=l??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=w??this.layout,this.offset=C??this.offset,this.mouseHandlerCallback=z??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),l=a.x,h=a.y,i=a.height,_=this.coordinateList[this.activeIndex].coordinate,w=((r=window)===null||r===void 0?void 0:r.scrollX)||0,A=((n=window)===null||n===void 0?void 0:n.scrollY)||0,C=l+_+w,R=h+this.offset.top+i/2+A;this.mouseHandlerCallback({pageX:C,pageY:R})}}}])}();function SLe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&Ir(n)&&Ir(a))return!0}return!1}function ALe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function dte(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,l=e.endAngle,h=sa(t,r,n,a),i=sa(t,r,n,l);return{points:[h,i],cx:t,cy:r,radius:n,startAngle:a,endAngle:l}}function TLe(e,t,r){var n,a,l,h;if(e==="horizontal")n=t.x,l=n,a=r.top,h=r.top+r.height;else if(e==="vertical")a=t.y,h=a,n=r.left,l=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,_=t.cy,w=t.innerRadius,A=t.outerRadius,C=t.angle,R=sa(i,_,w,C),z=sa(i,_,A,C);n=R.x,a=R.y,l=z.x,h=z.y}else return dte(t);return[{x:n,y:a},{x:l,y:h}]}function Dw(e){"@babel/helpers - typeof";return Dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(e)}function V9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Z2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V9(Object(r),!0).forEach(function(n){PLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PLe(e,t,r){return t=ELe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ELe(e){var t=CLe(e,"string");return Dw(t)=="symbol"?t:t+""}function CLe(e,t){if(Dw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MLe(e){var t,r,n=e.element,a=e.tooltipEventType,l=e.isActive,h=e.activeCoordinate,i=e.activePayload,_=e.offset,w=e.activeTooltipIndex,A=e.tooltipAxisBandSize,C=e.layout,R=e.chartName,z=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!z||!l||!h||R!=="ScatterChart"&&a!=="axis")return null;var V,U=Rg;if(R==="ScatterChart")V=h,U=Dke;else if(R==="BarChart")V=ALe(C,h,_,A),U=WL;else if(C==="radial"){var G=dte(h),H=G.cx,J=G.cy,Q=G.radius,le=G.startAngle,ne=G.endAngle;V={cx:H,cy:J,startAngle:le,endAngle:ne,innerRadius:Q,outerRadius:Q},U=QQ}else V={points:TLe(C,h,_)},U=Rg;var de=Z2(Z2(Z2(Z2({stroke:"#ccc",pointerEvents:"none"},_),V),on(z,!1)),{},{payload:i,payloadIndex:w,className:Xn("recharts-tooltip-cursor",z.className)});return K.isValidElement(z)?K.cloneElement(z,de):K.createElement(U,de)}var OLe=["item"],RLe=["children","className","width","height","style","compact","title","desc"];function r0(e){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r0(e)}function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lx.apply(this,arguments)}function U9(e,t){return NLe(e)||jLe(e,t)||fte(e,t)||kLe()}function kLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,l,h,i=[],_=!0,w=!1;try{if(l=(r=r.call(e)).next,t!==0)for(;!(_=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);_=!0);}catch(A){w=!0,a=A}finally{try{if(!_&&r.return!=null&&(h=r.return(),Object(h)!==h))return}finally{if(w)throw a}}return i}}function NLe(e){if(Array.isArray(e))return e}function $9(e,t){if(e==null)return{};var r=ILe(e,t),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ILe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function DLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pte(n.key),n)}}function zLe(e,t,r){return t&&LLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function FLe(e,t,r){return t=rP(t),BLe(e,hte()?Reflect.construct(t,r||[],rP(e).constructor):t.apply(e,r))}function BLe(e,t){if(t&&(r0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VLe(e)}function VLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hte=function(){return!!e})()}function rP(e){return rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rP(e)}function ULe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tD(e,t)}function tD(e,t){return tD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tD(e,t)}function n0(e){return GLe(e)||qLe(e)||fte(e)||$Le()}function $Le(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fte(e,t){if(e){if(typeof e=="string")return rD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rD(e,t)}}function qLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function GLe(e){if(Array.isArray(e))return rD(e)}function rD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function q9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q9(Object(r),!0).forEach(function(n){ti(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ti(e,t,r){return t=pte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pte(e){var t=KLe(e,"string");return r0(t)=="symbol"?t:t+""}function KLe(e,t){if(r0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(r0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WLe={xAxis:["bottom","top"],yAxis:["left","right"]},HLe={width:"100%",height:"100%"},mte={x:0,y:0};function Y2(e){return e}var ZLe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},YLe=function(t,r,n,a){var l=r.find(function(A){return A&&A.index===n});if(l){if(t==="horizontal")return{x:l.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:l.coordinate};if(t==="centric"){var h=l.coordinate,i=a.radius;return lr(lr(lr({},a),sa(a.cx,a.cy,i,h)),{},{angle:h,radius:i})}var _=l.coordinate,w=a.angle;return lr(lr(lr({},a),sa(a.cx,a.cy,_,w)),{},{angle:w,radius:_})}return mte},pE=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,l=r.dataEndIndex,h=(n??[]).reduce(function(i,_){var w=_.props.data;return w&&w.length?[].concat(n0(i),n0(w)):i},[]);return h.length>0?h:t&&t.length&&Ir(a)&&Ir(l)?t.slice(a,l+1):[]};function gte(e){return e==="number"?[0,"auto"]:void 0}var nD=function(t,r,n,a){var l=t.graphicalItems,h=t.tooltipAxis,i=pE(r,t);return n<0||!l||!l.length||n>=i.length?null:l.reduce(function(_,w){var A,C=(A=w.props.data)!==null&&A!==void 0?A:r;C&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(C=C.slice(t.dataStartIndex,t.dataEndIndex+1));var R;if(h.dataKey&&!h.allowDuplicatedCategory){var z=C===void 0?i:C;R=JA(z,h.dataKey,a)}else R=C&&C[n]||i[n];return R?[].concat(n0(_),[GL(w,R)]):_},[])},G9=function(t,r,n,a){var l=a||{x:t.chartX,y:t.chartY},h=ZLe(l,n),i=t.orderedTooltipTicks,_=t.tooltipAxis,w=t.tooltipTicks,A=fMe(h,i,w,_);if(A>=0&&w){var C=w[A]&&w[A].value,R=nD(t,r,A,C),z=YLe(n,i,A,l);return{activeTooltipIndex:A,activeLabel:C,activePayload:R,activeCoordinate:z}}return null},XLe=function(t,r){var n=r.axes,a=r.graphicalItems,l=r.axisType,h=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,w=r.dataEndIndex,A=t.layout,C=t.children,R=t.stackOffset,z=zQ(A,l);return n.reduce(function(V,U){var G,H=U.type.defaultProps!==void 0?lr(lr({},U.type.defaultProps),U.props):U.props,J=H.type,Q=H.dataKey,le=H.allowDataOverflow,ne=H.allowDuplicatedCategory,de=H.scale,ue=H.ticks,ve=H.includeHidden,Ae=H[h];if(V[Ae])return V;var Oe=pE(t.data,{graphicalItems:a.filter(function(ht){var tt,Qt=h in ht.props?ht.props[h]:(tt=ht.type.defaultProps)===null||tt===void 0?void 0:tt[h];return Qt===Ae}),dataStartIndex:_,dataEndIndex:w}),Se=Oe.length,ke,ze,et;SLe(H.domain,le,J)&&(ke=dI(H.domain,null,le),z&&(J==="number"||de!=="auto")&&(et=f1(Oe,Q,"category")));var je=gte(J);if(!ke||ke.length===0){var Ne,Ye=(Ne=H.domain)!==null&&Ne!==void 0?Ne:je;if(Q){if(ke=f1(Oe,Q,J),J==="category"&&z){var $e=swe(ke);ne&&$e?(ze=ke,ke=BT(0,Se)):ne||(ke=Oq(Ye,ke,U).reduce(function(ht,tt){return ht.indexOf(tt)>=0?ht:[].concat(n0(ht),[tt])},[]))}else if(J==="category")ne?ke=ke.filter(function(ht){return ht!==""&&!Gn(ht)}):ke=Oq(Ye,ke,U).reduce(function(ht,tt){return ht.indexOf(tt)>=0||tt===""||Gn(tt)?ht:[].concat(n0(ht),[tt])},[]);else if(J==="number"){var We=vMe(Oe,a.filter(function(ht){var tt,Qt,gr=h in ht.props?ht.props[h]:(tt=ht.type.defaultProps)===null||tt===void 0?void 0:tt[h],sr="hide"in ht.props?ht.props.hide:(Qt=ht.type.defaultProps)===null||Qt===void 0?void 0:Qt.hide;return gr===Ae&&(ve||!sr)}),Q,l,A);We&&(ke=We)}z&&(J==="number"||de!=="auto")&&(et=f1(Oe,Q,"category"))}else z?ke=BT(0,Se):i&&i[Ae]&&i[Ae].hasStack&&J==="number"?ke=R==="expand"?[0,1]:KQ(i[Ae].stackGroups,_,w):ke=LQ(Oe,a.filter(function(ht){var tt=h in ht.props?ht.props[h]:ht.type.defaultProps[h],Qt="hide"in ht.props?ht.props.hide:ht.type.defaultProps.hide;return tt===Ae&&(ve||!Qt)}),J,A,!0);if(J==="number")ke=eD(C,ke,Ae,l,ue),Ye&&(ke=dI(Ye,ke,le));else if(J==="category"&&Ye){var Et=Ye,Je=ke.every(function(ht){return Et.indexOf(ht)>=0});Je&&(ke=Et)}}return lr(lr({},V),{},ti({},Ae,lr(lr({},H),{},{axisType:l,domain:ke,categoricalDomain:et,duplicateDomain:ze,originalDomain:(G=H.domain)!==null&&G!==void 0?G:je,isCategorical:z,layout:A})))},{})},JLe=function(t,r){var n=r.graphicalItems,a=r.Axis,l=r.axisType,h=r.axisIdKey,i=r.stackGroups,_=r.dataStartIndex,w=r.dataEndIndex,A=t.layout,C=t.children,R=pE(t.data,{graphicalItems:n,dataStartIndex:_,dataEndIndex:w}),z=R.length,V=zQ(A,l),U=-1;return n.reduce(function(G,H){var J=H.type.defaultProps!==void 0?lr(lr({},H.type.defaultProps),H.props):H.props,Q=J[h],le=gte("number");if(!G[Q]){U++;var ne;return V?ne=BT(0,z):i&&i[Q]&&i[Q].hasStack?(ne=KQ(i[Q].stackGroups,_,w),ne=eD(C,ne,Q,l)):(ne=dI(le,LQ(R,n.filter(function(de){var ue,ve,Ae=h in de.props?de.props[h]:(ue=de.type.defaultProps)===null||ue===void 0?void 0:ue[h],Oe="hide"in de.props?de.props.hide:(ve=de.type.defaultProps)===null||ve===void 0?void 0:ve.hide;return Ae===Q&&!Oe}),"number",A),a.defaultProps.allowDataOverflow),ne=eD(C,ne,Q,l)),lr(lr({},G),{},ti({},Q,lr(lr({axisType:l},a.defaultProps),{},{hide:!0,orientation:Au(WLe,"".concat(l,".").concat(U%2),null),domain:ne,originalDomain:le,isCategorical:V,layout:A})))}return G},{})},QLe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,l=r.AxisComp,h=r.graphicalItems,i=r.stackGroups,_=r.dataStartIndex,w=r.dataEndIndex,A=t.children,C="".concat(a,"Id"),R=Bl(A,l),z={};return R&&R.length?z=XLe(t,{axes:R,graphicalItems:h,axisType:a,axisIdKey:C,stackGroups:i,dataStartIndex:_,dataEndIndex:w}):h&&h.length&&(z=JLe(t,{Axis:l,graphicalItems:h,axisType:a,axisIdKey:C,stackGroups:i,dataStartIndex:_,dataEndIndex:w})),z},e4e=function(t){var r=Tg(t),n=tm(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:vL(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:AT(r,n)}},K9=function(t){var r=t.children,n=t.defaultShowTooltip,a=gu(r,qx),l=0,h=0;return t.data&&t.data.length!==0&&(h=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(l=a.props.startIndex),a.props.endIndex>=0&&(h=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:h,activeTooltipIndex:-1,isTooltipActive:!!n}},t4e=function(t){return!t||!t.length?!1:t.some(function(r){var n=am(r&&r.type);return n&&n.indexOf("Bar")>=0})},W9=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},r4e=function(t,r){var n=t.props,a=t.graphicalItems,l=t.xAxisMap,h=l===void 0?{}:l,i=t.yAxisMap,_=i===void 0?{}:i,w=n.width,A=n.height,C=n.children,R=n.margin||{},z=gu(C,qx),V=gu(C,kh),U=Object.keys(_).reduce(function(ne,de){var ue=_[de],ve=ue.orientation;return!ue.mirror&&!ue.hide?lr(lr({},ne),{},ti({},ve,ne[ve]+ue.width)):ne},{left:R.left||0,right:R.right||0}),G=Object.keys(h).reduce(function(ne,de){var ue=h[de],ve=ue.orientation;return!ue.mirror&&!ue.hide?lr(lr({},ne),{},ti({},ve,Au(ne,"".concat(ve))+ue.height)):ne},{top:R.top||0,bottom:R.bottom||0}),H=lr(lr({},G),U),J=H.bottom;z&&(H.bottom+=z.props.height||qx.defaultProps.height),V&&r&&(H=gMe(H,a,n,r));var Q=w-H.left-H.right,le=A-H.top-H.bottom;return lr(lr({brushBottom:J},H),{},{width:Math.max(Q,0),height:Math.max(le,0)})},n4e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Jg=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,l=a===void 0?"axis":a,h=t.validateTooltipEventTypes,i=h===void 0?["axis"]:h,_=t.axisComponents,w=t.legendContent,A=t.formatAxisMap,C=t.defaultProps,R=function(H,J){var Q=J.graphicalItems,le=J.stackGroups,ne=J.offset,de=J.updateId,ue=J.dataStartIndex,ve=J.dataEndIndex,Ae=H.barSize,Oe=H.layout,Se=H.barGap,ke=H.barCategoryGap,ze=H.maxBarSize,et=W9(Oe),je=et.numericAxisName,Ne=et.cateAxisName,Ye=t4e(Q),$e=[];return Q.forEach(function(We,Et){var Je=pE(H.data,{graphicalItems:[We],dataStartIndex:ue,dataEndIndex:ve}),ht=We.type.defaultProps!==void 0?lr(lr({},We.type.defaultProps),We.props):We.props,tt=ht.dataKey,Qt=ht.maxBarSize,gr=ht["".concat(je,"Id")],sr=ht["".concat(Ne,"Id")],ur={},br=_.reduce(function(Pr,yr){var wr=J["".concat(yr.axisType,"Map")],dr=ht["".concat(yr.axisType,"Id")];wr&&wr[dr]||yr.axisType==="zAxis"||jv();var An=wr[dr];return lr(lr({},Pr),{},ti(ti({},yr.axisType,An),"".concat(yr.axisType,"Ticks"),tm(An)))},ur),Wt=br[Ne],Be=br["".concat(Ne,"Ticks")],Nr=le&&le[gr]&&le[gr].hasStack&&AMe(We,le[gr].stackGroups),Jt=am(We.type).indexOf("Bar")>=0,Sn=AT(Wt,Be),It=[],Vn=Ye&&pMe({barSize:Ae,stackGroups:le,totalSize:n4e(br,Ne)});if(Jt){var Un,Xr,rt=Gn(Qt)?ze:Qt,Ot=(Un=(Xr=AT(Wt,Be,!0))!==null&&Xr!==void 0?Xr:rt)!==null&&Un!==void 0?Un:0;It=mMe({barGap:Se,barCategoryGap:ke,bandSize:Ot!==Sn?Ot:Sn,sizeList:Vn[sr],maxBarSize:rt}),Ot!==Sn&&(It=It.map(function(Pr){return lr(lr({},Pr),{},{position:lr(lr({},Pr.position),{},{offset:Pr.position.offset-Ot/2})})}))}var Kt=We&&We.type&&We.type.getComposedData;Kt&&$e.push({props:lr(lr({},Kt(lr(lr({},br),{},{displayedData:Je,props:H,dataKey:tt,item:We,bandSize:Sn,barPosition:It,offset:ne,stackedData:Nr,layout:Oe,dataStartIndex:ue,dataEndIndex:ve}))),{},ti(ti(ti({key:We.key||"item-".concat(Et)},je,br[je]),Ne,br[Ne]),"animationId",de)),childIndex:_we(We,H.children),item:We})}),$e},z=function(H,J){var Q=H.props,le=H.dataStartIndex,ne=H.dataEndIndex,de=H.updateId;if(!K6({props:Q}))return null;var ue=Q.children,ve=Q.layout,Ae=Q.stackOffset,Oe=Q.data,Se=Q.reverseStackOrder,ke=W9(ve),ze=ke.numericAxisName,et=ke.cateAxisName,je=Bl(ue,n),Ne=SMe(Oe,je,"".concat(ze,"Id"),"".concat(et,"Id"),Ae,Se),Ye=_.reduce(function(ht,tt){var Qt="".concat(tt.axisType,"Map");return lr(lr({},ht),{},ti({},Qt,QLe(Q,lr(lr({},tt),{},{graphicalItems:je,stackGroups:tt.axisType===ze&&Ne,dataStartIndex:le,dataEndIndex:ne}))))},{}),$e=r4e(lr(lr({},Ye),{},{props:Q,graphicalItems:je}),J==null?void 0:J.legendBBox);Object.keys(Ye).forEach(function(ht){Ye[ht]=A(Q,Ye[ht],$e,ht.replace("Map",""),r)});var We=Ye["".concat(et,"Map")],Et=e4e(We),Je=R(Q,lr(lr({},Ye),{},{dataStartIndex:le,dataEndIndex:ne,updateId:de,graphicalItems:je,stackGroups:Ne,offset:$e}));return lr(lr({formattedGraphicalItems:Je,graphicalItems:je,offset:$e,stackGroups:Ne},Et),Ye)},V=function(G){function H(J){var Q,le,ne;return DLe(this,H),ne=FLe(this,H,[J]),ti(ne,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ti(ne,"accessibilityManager",new wLe),ti(ne,"handleLegendBBoxUpdate",function(de){if(de){var ue=ne.state,ve=ue.dataStartIndex,Ae=ue.dataEndIndex,Oe=ue.updateId;ne.setState(lr({legendBBox:de},z({props:ne.props,dataStartIndex:ve,dataEndIndex:Ae,updateId:Oe},lr(lr({},ne.state),{},{legendBBox:de}))))}}),ti(ne,"handleReceiveSyncEvent",function(de,ue,ve){if(ne.props.syncId===de){if(ve===ne.eventEmitterSymbol&&typeof ne.props.syncMethod!="function")return;ne.applySyncEvent(ue)}}),ti(ne,"handleBrushChange",function(de){var ue=de.startIndex,ve=de.endIndex;if(ue!==ne.state.dataStartIndex||ve!==ne.state.dataEndIndex){var Ae=ne.state.updateId;ne.setState(function(){return lr({dataStartIndex:ue,dataEndIndex:ve},z({props:ne.props,dataStartIndex:ue,dataEndIndex:ve,updateId:Ae},ne.state))}),ne.triggerSyncEvent({dataStartIndex:ue,dataEndIndex:ve})}}),ti(ne,"handleMouseEnter",function(de){var ue=ne.getMouseInfo(de);if(ue){var ve=lr(lr({},ue),{},{isTooltipActive:!0});ne.setState(ve),ne.triggerSyncEvent(ve);var Ae=ne.props.onMouseEnter;Cn(Ae)&&Ae(ve,de)}}),ti(ne,"triggeredAfterMouseMove",function(de){var ue=ne.getMouseInfo(de),ve=ue?lr(lr({},ue),{},{isTooltipActive:!0}):{isTooltipActive:!1};ne.setState(ve),ne.triggerSyncEvent(ve);var Ae=ne.props.onMouseMove;Cn(Ae)&&Ae(ve,de)}),ti(ne,"handleItemMouseEnter",function(de){ne.setState(function(){return{isTooltipActive:!0,activeItem:de,activePayload:de.tooltipPayload,activeCoordinate:de.tooltipPosition||{x:de.cx,y:de.cy}}})}),ti(ne,"handleItemMouseLeave",function(){ne.setState(function(){return{isTooltipActive:!1}})}),ti(ne,"handleMouseMove",function(de){de.persist(),ne.throttleTriggeredAfterMouseMove(de)}),ti(ne,"handleMouseLeave",function(de){ne.throttleTriggeredAfterMouseMove.cancel();var ue={isTooltipActive:!1};ne.setState(ue),ne.triggerSyncEvent(ue);var ve=ne.props.onMouseLeave;Cn(ve)&&ve(ue,de)}),ti(ne,"handleOuterEvent",function(de){var ue=vwe(de),ve=Au(ne.props,"".concat(ue));if(ue&&Cn(ve)){var Ae,Oe;/.*touch.*/i.test(ue)?Oe=ne.getMouseInfo(de.changedTouches[0]):Oe=ne.getMouseInfo(de),ve((Ae=Oe)!==null&&Ae!==void 0?Ae:{},de)}}),ti(ne,"handleClick",function(de){var ue=ne.getMouseInfo(de);if(ue){var ve=lr(lr({},ue),{},{isTooltipActive:!0});ne.setState(ve),ne.triggerSyncEvent(ve);var Ae=ne.props.onClick;Cn(Ae)&&Ae(ve,de)}}),ti(ne,"handleMouseDown",function(de){var ue=ne.props.onMouseDown;if(Cn(ue)){var ve=ne.getMouseInfo(de);ue(ve,de)}}),ti(ne,"handleMouseUp",function(de){var ue=ne.props.onMouseUp;if(Cn(ue)){var ve=ne.getMouseInfo(de);ue(ve,de)}}),ti(ne,"handleTouchMove",function(de){de.changedTouches!=null&&de.changedTouches.length>0&&ne.throttleTriggeredAfterMouseMove(de.changedTouches[0])}),ti(ne,"handleTouchStart",function(de){de.changedTouches!=null&&de.changedTouches.length>0&&ne.handleMouseDown(de.changedTouches[0])}),ti(ne,"handleTouchEnd",function(de){de.changedTouches!=null&&de.changedTouches.length>0&&ne.handleMouseUp(de.changedTouches[0])}),ti(ne,"handleDoubleClick",function(de){var ue=ne.props.onDoubleClick;if(Cn(ue)){var ve=ne.getMouseInfo(de);ue(ve,de)}}),ti(ne,"handleContextMenu",function(de){var ue=ne.props.onContextMenu;if(Cn(ue)){var ve=ne.getMouseInfo(de);ue(ve,de)}}),ti(ne,"triggerSyncEvent",function(de){ne.props.syncId!==void 0&&xj.emit(bj,ne.props.syncId,de,ne.eventEmitterSymbol)}),ti(ne,"applySyncEvent",function(de){var ue=ne.props,ve=ue.layout,Ae=ue.syncMethod,Oe=ne.state.updateId,Se=de.dataStartIndex,ke=de.dataEndIndex;if(de.dataStartIndex!==void 0||de.dataEndIndex!==void 0)ne.setState(lr({dataStartIndex:Se,dataEndIndex:ke},z({props:ne.props,dataStartIndex:Se,dataEndIndex:ke,updateId:Oe},ne.state)));else if(de.activeTooltipIndex!==void 0){var ze=de.chartX,et=de.chartY,je=de.activeTooltipIndex,Ne=ne.state,Ye=Ne.offset,$e=Ne.tooltipTicks;if(!Ye)return;if(typeof Ae=="function")je=Ae($e,de);else if(Ae==="value"){je=-1;for(var We=0;We<$e.length;We++)if($e[We].value===de.activeLabel){je=We;break}}var Et=lr(lr({},Ye),{},{x:Ye.left,y:Ye.top}),Je=Math.min(ze,Et.x+Et.width),ht=Math.min(et,Et.y+Et.height),tt=$e[je]&&$e[je].value,Qt=nD(ne.state,ne.props.data,je),gr=$e[je]?{x:ve==="horizontal"?$e[je].coordinate:Je,y:ve==="horizontal"?ht:$e[je].coordinate}:mte;ne.setState(lr(lr({},de),{},{activeLabel:tt,activeCoordinate:gr,activePayload:Qt,activeTooltipIndex:je}))}else ne.setState(de)}),ti(ne,"renderCursor",function(de){var ue,ve=ne.state,Ae=ve.isTooltipActive,Oe=ve.activeCoordinate,Se=ve.activePayload,ke=ve.offset,ze=ve.activeTooltipIndex,et=ve.tooltipAxisBandSize,je=ne.getTooltipEventType(),Ne=(ue=de.props.active)!==null&&ue!==void 0?ue:Ae,Ye=ne.props.layout,$e=de.key||"_recharts-cursor";return Pe.createElement(MLe,{key:$e,activeCoordinate:Oe,activePayload:Se,activeTooltipIndex:ze,chartName:r,element:de,isActive:Ne,layout:Ye,offset:ke,tooltipAxisBandSize:et,tooltipEventType:je})}),ti(ne,"renderPolarAxis",function(de,ue,ve){var Ae=Au(de,"type.axisType"),Oe=Au(ne.state,"".concat(Ae,"Map")),Se=de.type.defaultProps,ke=Se!==void 0?lr(lr({},Se),de.props):de.props,ze=Oe&&Oe[ke["".concat(Ae,"Id")]];return K.cloneElement(de,lr(lr({},ze),{},{className:Xn(Ae,ze.className),key:de.key||"".concat(ue,"-").concat(ve),ticks:tm(ze,!0)}))}),ti(ne,"renderPolarGrid",function(de){var ue=de.props,ve=ue.radialLines,Ae=ue.polarAngles,Oe=ue.polarRadius,Se=ne.state,ke=Se.radiusAxisMap,ze=Se.angleAxisMap,et=Tg(ke),je=Tg(ze),Ne=je.cx,Ye=je.cy,$e=je.innerRadius,We=je.outerRadius;return K.cloneElement(de,{polarAngles:Array.isArray(Ae)?Ae:tm(je,!0).map(function(Et){return Et.coordinate}),polarRadius:Array.isArray(Oe)?Oe:tm(et,!0).map(function(Et){return Et.coordinate}),cx:Ne,cy:Ye,innerRadius:$e,outerRadius:We,key:de.key||"polar-grid",radialLines:ve})}),ti(ne,"renderLegend",function(){var de=ne.state.formattedGraphicalItems,ue=ne.props,ve=ue.children,Ae=ue.width,Oe=ue.height,Se=ne.props.margin||{},ke=Ae-(Se.left||0)-(Se.right||0),ze=IQ({children:ve,formattedGraphicalItems:de,legendWidth:ke,legendContent:w});if(!ze)return null;var et=ze.item,je=$9(ze,OLe);return K.cloneElement(et,lr(lr({},je),{},{chartWidth:Ae,chartHeight:Oe,margin:Se,onBBoxUpdate:ne.handleLegendBBoxUpdate}))}),ti(ne,"renderTooltip",function(){var de,ue=ne.props,ve=ue.children,Ae=ue.accessibilityLayer,Oe=gu(ve,wa);if(!Oe)return null;var Se=ne.state,ke=Se.isTooltipActive,ze=Se.activeCoordinate,et=Se.activePayload,je=Se.activeLabel,Ne=Se.offset,Ye=(de=Oe.props.active)!==null&&de!==void 0?de:ke;return K.cloneElement(Oe,{viewBox:lr(lr({},Ne),{},{x:Ne.left,y:Ne.top}),active:Ye,label:je,payload:Ye?et:[],coordinate:ze,accessibilityLayer:Ae})}),ti(ne,"renderBrush",function(de){var ue=ne.props,ve=ue.margin,Ae=ue.data,Oe=ne.state,Se=Oe.offset,ke=Oe.dataStartIndex,ze=Oe.dataEndIndex,et=Oe.updateId;return K.cloneElement(de,{key:de.key||"_recharts-brush",onChange:G2(ne.handleBrushChange,de.props.onChange),data:Ae,x:Ir(de.props.x)?de.props.x:Se.left,y:Ir(de.props.y)?de.props.y:Se.top+Se.height+Se.brushBottom-(ve.bottom||0),width:Ir(de.props.width)?de.props.width:Se.width,startIndex:ke,endIndex:ze,updateId:"brush-".concat(et)})}),ti(ne,"renderReferenceElement",function(de,ue,ve){if(!de)return null;var Ae=ne,Oe=Ae.clipPathId,Se=ne.state,ke=Se.xAxisMap,ze=Se.yAxisMap,et=Se.offset,je=de.type.defaultProps||{},Ne=de.props,Ye=Ne.xAxisId,$e=Ye===void 0?je.xAxisId:Ye,We=Ne.yAxisId,Et=We===void 0?je.yAxisId:We;return K.cloneElement(de,{key:de.key||"".concat(ue,"-").concat(ve),xAxis:ke[$e],yAxis:ze[Et],viewBox:{x:et.left,y:et.top,width:et.width,height:et.height},clipPathId:Oe})}),ti(ne,"renderActivePoints",function(de){var ue=de.item,ve=de.activePoint,Ae=de.basePoint,Oe=de.childIndex,Se=de.isRange,ke=[],ze=ue.props.key,et=ue.item.type.defaultProps!==void 0?lr(lr({},ue.item.type.defaultProps),ue.item.props):ue.item.props,je=et.activeDot,Ne=et.dataKey,Ye=lr(lr({index:Oe,dataKey:Ne,cx:ve.x,cy:ve.y,r:4,fill:qL(ue.item),strokeWidth:2,stroke:"#fff",payload:ve.payload,value:ve.value},on(je,!1)),QA(je));return ke.push(H.renderActiveDot(je,Ye,"".concat(ze,"-activePoint-").concat(Oe))),Ae?ke.push(H.renderActiveDot(je,lr(lr({},Ye),{},{cx:Ae.x,cy:Ae.y}),"".concat(ze,"-basePoint-").concat(Oe))):Se&&ke.push(null),ke}),ti(ne,"renderGraphicChild",function(de,ue,ve){var Ae=ne.filterFormatItem(de,ue,ve);if(!Ae)return null;var Oe=ne.getTooltipEventType(),Se=ne.state,ke=Se.isTooltipActive,ze=Se.tooltipAxis,et=Se.activeTooltipIndex,je=Se.activeLabel,Ne=ne.props.children,Ye=gu(Ne,wa),$e=Ae.props,We=$e.points,Et=$e.isRange,Je=$e.baseLine,ht=Ae.item.type.defaultProps!==void 0?lr(lr({},Ae.item.type.defaultProps),Ae.item.props):Ae.item.props,tt=ht.activeDot,Qt=ht.hide,gr=ht.activeBar,sr=ht.activeShape,ur=!!(!Qt&&ke&&Ye&&(tt||gr||sr)),br={};Oe!=="axis"&&Ye&&Ye.props.trigger==="click"?br={onClick:G2(ne.handleItemMouseEnter,de.props.onClick)}:Oe!=="axis"&&(br={onMouseLeave:G2(ne.handleItemMouseLeave,de.props.onMouseLeave),onMouseEnter:G2(ne.handleItemMouseEnter,de.props.onMouseEnter)});var Wt=K.cloneElement(de,lr(lr({},Ae.props),br));function Be(yr){return typeof ze.dataKey=="function"?ze.dataKey(yr.payload):null}if(ur)if(et>=0){var Nr,Jt;if(ze.dataKey&&!ze.allowDuplicatedCategory){var Sn=typeof ze.dataKey=="function"?Be:"payload.".concat(ze.dataKey.toString());Nr=JA(We,Sn,je),Jt=Et&&Je&&JA(Je,Sn,je)}else Nr=We==null?void 0:We[et],Jt=Et&&Je&&Je[et];if(sr||gr){var It=de.props.activeIndex!==void 0?de.props.activeIndex:et;return[K.cloneElement(de,lr(lr(lr({},Ae.props),br),{},{activeIndex:It})),null,null]}if(!Gn(Nr))return[Wt].concat(n0(ne.renderActivePoints({item:Ae,activePoint:Nr,basePoint:Jt,childIndex:et,isRange:Et})))}else{var Vn,Un=(Vn=ne.getItemByXY(ne.state.activeCoordinate))!==null&&Vn!==void 0?Vn:{graphicalItem:Wt},Xr=Un.graphicalItem,rt=Xr.item,Ot=rt===void 0?de:rt,Kt=Xr.childIndex,Pr=lr(lr(lr({},Ae.props),br),{},{activeIndex:Kt});return[K.cloneElement(Ot,Pr),null,null]}return Et?[Wt,null,null]:[Wt,null]}),ti(ne,"renderCustomized",function(de,ue,ve){return K.cloneElement(de,lr(lr({key:"recharts-customized-".concat(ve)},ne.props),ne.state))}),ti(ne,"renderMap",{CartesianGrid:{handler:Y2,once:!0},ReferenceArea:{handler:ne.renderReferenceElement},ReferenceLine:{handler:Y2},ReferenceDot:{handler:ne.renderReferenceElement},XAxis:{handler:Y2},YAxis:{handler:Y2},Brush:{handler:ne.renderBrush,once:!0},Bar:{handler:ne.renderGraphicChild},Line:{handler:ne.renderGraphicChild},Area:{handler:ne.renderGraphicChild},Radar:{handler:ne.renderGraphicChild},RadialBar:{handler:ne.renderGraphicChild},Scatter:{handler:ne.renderGraphicChild},Pie:{handler:ne.renderGraphicChild},Funnel:{handler:ne.renderGraphicChild},Tooltip:{handler:ne.renderCursor,once:!0},PolarGrid:{handler:ne.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ne.renderPolarAxis},PolarRadiusAxis:{handler:ne.renderPolarAxis},Customized:{handler:ne.renderCustomized}}),ne.clipPathId="".concat((Q=J.id)!==null&&Q!==void 0?Q:Hg("recharts"),"-clip"),ne.throttleTriggeredAfterMouseMove=NJ(ne.triggeredAfterMouseMove,(le=J.throttleDelay)!==null&&le!==void 0?le:1e3/60),ne.state={},ne}return ULe(H,G),zLe(H,[{key:"componentDidMount",value:function(){var Q,le;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(Q=this.props.margin.left)!==null&&Q!==void 0?Q:0,top:(le=this.props.margin.top)!==null&&le!==void 0?le:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var Q=this.props,le=Q.children,ne=Q.data,de=Q.height,ue=Q.layout,ve=gu(le,wa);if(ve){var Ae=ve.props.defaultIndex;if(!(typeof Ae!="number"||Ae<0||Ae>this.state.tooltipTicks.length-1)){var Oe=this.state.tooltipTicks[Ae]&&this.state.tooltipTicks[Ae].value,Se=nD(this.state,ne,Ae,Oe),ke=this.state.tooltipTicks[Ae].coordinate,ze=(this.state.offset.top+de)/2,et=ue==="horizontal",je=et?{x:ke,y:ze}:{y:ke,x:ze},Ne=this.state.formattedGraphicalItems.find(function($e){var We=$e.item;return We.type.name==="Scatter"});Ne&&(je=lr(lr({},je),Ne.props.points[Ae].tooltipPosition),Se=Ne.props.points[Ae].tooltipPayload);var Ye={activeTooltipIndex:Ae,isTooltipActive:!0,activeLabel:Oe,activePayload:Se,activeCoordinate:je};this.setState(Ye),this.renderCursor(ve),this.accessibilityManager.setIndex(Ae)}}}},{key:"getSnapshotBeforeUpdate",value:function(Q,le){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==le.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==Q.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==Q.margin){var ne,de;this.accessibilityManager.setDetails({offset:{left:(ne=this.props.margin.left)!==null&&ne!==void 0?ne:0,top:(de=this.props.margin.top)!==null&&de!==void 0?de:0}})}return null}},{key:"componentDidUpdate",value:function(Q){jN([gu(Q.children,wa)],[gu(this.props.children,wa)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var Q=gu(this.props.children,wa);if(Q&&typeof Q.props.shared=="boolean"){var le=Q.props.shared?"axis":"item";return i.indexOf(le)>=0?le:l}return l}},{key:"getMouseInfo",value:function(Q){if(!this.container)return null;var le=this.container,ne=le.getBoundingClientRect(),de=aTe(ne),ue={chartX:Math.round(Q.pageX-de.left),chartY:Math.round(Q.pageY-de.top)},ve=ne.width/le.offsetWidth||1,Ae=this.inRange(ue.chartX,ue.chartY,ve);if(!Ae)return null;var Oe=this.state,Se=Oe.xAxisMap,ke=Oe.yAxisMap,ze=this.getTooltipEventType();if(ze!=="axis"&&Se&&ke){var et=Tg(Se).scale,je=Tg(ke).scale,Ne=et&&et.invert?et.invert(ue.chartX):null,Ye=je&&je.invert?je.invert(ue.chartY):null;return lr(lr({},ue),{},{xValue:Ne,yValue:Ye})}var $e=G9(this.state,this.props.data,this.props.layout,Ae);return $e?lr(lr({},ue),$e):null}},{key:"inRange",value:function(Q,le){var ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,de=this.props.layout,ue=Q/ne,ve=le/ne;if(de==="horizontal"||de==="vertical"){var Ae=this.state.offset,Oe=ue>=Ae.left&&ue<=Ae.left+Ae.width&&ve>=Ae.top&&ve<=Ae.top+Ae.height;return Oe?{x:ue,y:ve}:null}var Se=this.state,ke=Se.angleAxisMap,ze=Se.radiusAxisMap;if(ke&&ze){var et=Tg(ke);return jq({x:ue,y:ve},et)}return null}},{key:"parseEventsOfWrapper",value:function(){var Q=this.props.children,le=this.getTooltipEventType(),ne=gu(Q,wa),de={};ne&&le==="axis"&&(ne.props.trigger==="click"?de={onClick:this.handleClick}:de={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var ue=QA(this.props,this.handleOuterEvent);return lr(lr({},ue),de)}},{key:"addListener",value:function(){xj.on(bj,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){xj.removeListener(bj,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(Q,le,ne){for(var de=this.state.formattedGraphicalItems,ue=0,ve=de.length;ue<ve;ue++){var Ae=de[ue];if(Ae.item===Q||Ae.props.key===Q.key||le===am(Ae.item.type)&&ne===Ae.childIndex)return Ae}return null}},{key:"renderClipPath",value:function(){var Q=this.clipPathId,le=this.state.offset,ne=le.left,de=le.top,ue=le.height,ve=le.width;return Pe.createElement("defs",null,Pe.createElement("clipPath",{id:Q},Pe.createElement("rect",{x:ne,y:de,height:ue,width:ve})))}},{key:"getXScales",value:function(){var Q=this.state.xAxisMap;return Q?Object.entries(Q).reduce(function(le,ne){var de=U9(ne,2),ue=de[0],ve=de[1];return lr(lr({},le),{},ti({},ue,ve.scale))},{}):null}},{key:"getYScales",value:function(){var Q=this.state.yAxisMap;return Q?Object.entries(Q).reduce(function(le,ne){var de=U9(ne,2),ue=de[0],ve=de[1];return lr(lr({},le),{},ti({},ue,ve.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(Q){var le;return(le=this.state.xAxisMap)===null||le===void 0||(le=le[Q])===null||le===void 0?void 0:le.scale}},{key:"getYScaleByAxisId",value:function(Q){var le;return(le=this.state.yAxisMap)===null||le===void 0||(le=le[Q])===null||le===void 0?void 0:le.scale}},{key:"getItemByXY",value:function(Q){var le=this.state,ne=le.formattedGraphicalItems,de=le.activeItem;if(ne&&ne.length)for(var ue=0,ve=ne.length;ue<ve;ue++){var Ae=ne[ue],Oe=Ae.props,Se=Ae.item,ke=Se.type.defaultProps!==void 0?lr(lr({},Se.type.defaultProps),Se.props):Se.props,ze=am(Se.type);if(ze==="Bar"){var et=(Oe.data||[]).find(function($e){return yke(Q,$e)});if(et)return{graphicalItem:Ae,payload:et}}else if(ze==="RadialBar"){var je=(Oe.data||[]).find(function($e){return jq(Q,$e)});if(je)return{graphicalItem:Ae,payload:je}}else if(sE(Ae,de)||lE(Ae,de)||Mw(Ae,de)){var Ne=Xje({graphicalItem:Ae,activeTooltipItem:de,itemData:ke.data}),Ye=ke.activeIndex===void 0?Ne:ke.activeIndex;return{graphicalItem:lr(lr({},Ae),{},{childIndex:Ye}),payload:Mw(Ae,de)?ke.data[Ne]:Ae.props.data[Ne]}}}return null}},{key:"render",value:function(){var Q=this;if(!K6(this))return null;var le=this.props,ne=le.children,de=le.className,ue=le.width,ve=le.height,Ae=le.style,Oe=le.compact,Se=le.title,ke=le.desc,ze=$9(le,RLe),et=on(ze,!1);if(Oe)return Pe.createElement(_9,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Pe.createElement(IN,lx({},et,{width:ue,height:ve,title:Se,desc:ke}),this.renderClipPath(),H6(ne,this.renderMap)));if(this.props.accessibilityLayer){var je,Ne;et.tabIndex=(je=this.props.tabIndex)!==null&&je!==void 0?je:0,et.role=(Ne=this.props.role)!==null&&Ne!==void 0?Ne:"application",et.onKeyDown=function($e){Q.accessibilityManager.keyboardEvent($e)},et.onFocus=function(){Q.accessibilityManager.focus()}}var Ye=this.parseEventsOfWrapper();return Pe.createElement(_9,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Pe.createElement("div",lx({className:Xn("recharts-wrapper",de),style:lr({position:"relative",cursor:"default",width:ue,height:ve},Ae)},Ye,{ref:function(We){Q.container=We}}),Pe.createElement(IN,lx({},et,{width:ue,height:ve,title:Se,desc:ke,style:HLe}),this.renderClipPath(),H6(ne,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(K.Component);ti(V,"displayName",r),ti(V,"defaultProps",lr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},C)),ti(V,"getDerivedStateFromProps",function(G,H){var J=G.dataKey,Q=G.data,le=G.children,ne=G.width,de=G.height,ue=G.layout,ve=G.stackOffset,Ae=G.margin,Oe=H.dataStartIndex,Se=H.dataEndIndex;if(H.updateId===void 0){var ke=K9(G);return lr(lr(lr({},ke),{},{updateId:0},z(lr(lr({props:G},ke),{},{updateId:0}),H)),{},{prevDataKey:J,prevData:Q,prevWidth:ne,prevHeight:de,prevLayout:ue,prevStackOffset:ve,prevMargin:Ae,prevChildren:le})}if(J!==H.prevDataKey||Q!==H.prevData||ne!==H.prevWidth||de!==H.prevHeight||ue!==H.prevLayout||ve!==H.prevStackOffset||!px(Ae,H.prevMargin)){var ze=K9(G),et={chartX:H.chartX,chartY:H.chartY,isTooltipActive:H.isTooltipActive},je=lr(lr({},G9(H,Q,ue)),{},{updateId:H.updateId+1}),Ne=lr(lr(lr({},ze),et),je);return lr(lr(lr({},Ne),z(lr({props:G},Ne),H)),{},{prevDataKey:J,prevData:Q,prevWidth:ne,prevHeight:de,prevLayout:ue,prevStackOffset:ve,prevMargin:Ae,prevChildren:le})}if(!jN(le,H.prevChildren)){var Ye,$e,We,Et,Je=gu(le,qx),ht=Je&&(Ye=($e=Je.props)===null||$e===void 0?void 0:$e.startIndex)!==null&&Ye!==void 0?Ye:Oe,tt=Je&&(We=(Et=Je.props)===null||Et===void 0?void 0:Et.endIndex)!==null&&We!==void 0?We:Se,Qt=ht!==Oe||tt!==Se,gr=!Gn(Q),sr=gr&&!Qt?H.updateId:H.updateId+1;return lr(lr({updateId:sr},z(lr(lr({props:G},H),{},{updateId:sr,dataStartIndex:ht,dataEndIndex:tt}),H)),{},{prevChildren:le,dataStartIndex:ht,dataEndIndex:tt})}return null}),ti(V,"renderActiveDot",function(G,H,J){var Q;return K.isValidElement(G)?Q=K.cloneElement(G,H):Cn(G)?Q=G(H):Q=Pe.createElement(k0,H),Pe.createElement(ci,{className:"recharts-active-dot",key:J},Q)});var U=K.forwardRef(function(H,J){return Pe.createElement(V,lx({},H,{ref:J}))});return U.displayName=V.displayName,U},n4=Jg({chartName:"LineChart",GraphicalChild:_u,axisComponents:[{axisType:"xAxis",AxisComp:lo},{axisType:"yAxis",AxisComp:co}],formatAxisMap:mS}),Eh=Jg({chartName:"BarChart",GraphicalChild:Ro,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:lo},{axisType:"yAxis",AxisComp:co}],formatAxisMap:mS}),yte=Jg({chartName:"PieChart",GraphicalChild:rp,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Jv},{axisType:"radiusAxis",AxisComp:j0}],formatAxisMap:KL,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),i4e=Jg({chartName:"RadarChart",GraphicalChild:Vx,axisComponents:[{axisType:"angleAxis",AxisComp:Jv},{axisType:"radiusAxis",AxisComp:j0}],formatAxisMap:KL,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),a4e=Jg({chartName:"ScatterChart",GraphicalChild:I0,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:lo},{axisType:"yAxis",AxisComp:co},{axisType:"zAxis",AxisComp:gS}],formatAxisMap:mS}),o4e=Jg({chartName:"AreaChart",GraphicalChild:xm,axisComponents:[{axisType:"xAxis",AxisComp:lo},{axisType:"yAxis",AxisComp:co}],formatAxisMap:mS}),s4e=Jg({chartName:"RadialBarChart",GraphicalChild:pS,legendContent:"children",defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"angleAxis",AxisComp:Jv},{axisType:"radiusAxis",AxisComp:j0}],formatAxisMap:KL,defaultProps:{layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),vte=Jg({chartName:"ComposedChart",GraphicalChild:[_u,xm,Ro,I0],axisComponents:[{axisType:"xAxis",AxisComp:lo},{axisType:"yAxis",AxisComp:co},{axisType:"zAxis",AxisComp:gS}],formatAxisMap:mS});function H9(e,[t,r]){return Math.min(r,Math.max(t,e))}function l4e(e){const t=K.useRef({value:e,previous:e});return K.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var c4e="VisuallyHidden",i4=K.forwardRef((e,t)=>f.jsx(mi.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));i4.displayName=c4e;var u4e=i4,d4e=[" ","Enter","ArrowUp","ArrowDown"],h4e=[" ","Enter"],yS="Select",[mE,gE,f4e]=BD(yS),[D0,H6e]=Md(yS,[f4e,qg]),yE=qg(),[p4e,Qg]=D0(yS),[m4e,g4e]=D0(yS),_te=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:l,value:h,defaultValue:i,onValueChange:_,dir:w,name:A,autoComplete:C,disabled:R,required:z,form:V}=e,U=yE(t),[G,H]=K.useState(null),[J,Q]=K.useState(null),[le,ne]=K.useState(!1),de=VD(w),[ue=!1,ve]=kg({prop:n,defaultProp:a,onChange:l}),[Ae,Oe]=kg({prop:h,defaultProp:i,onChange:_}),Se=K.useRef(null),ke=G?V||!!G.closest("form"):!0,[ze,et]=K.useState(new Set),je=Array.from(ze).map(Ne=>Ne.props.value).join(";");return f.jsx(fP,{...U,children:f.jsxs(p4e,{required:z,scope:t,trigger:G,onTriggerChange:H,valueNode:J,onValueNodeChange:Q,valueNodeHasChildren:le,onValueNodeHasChildrenChange:ne,contentId:Ad(),value:Ae,onValueChange:Oe,open:ue,onOpenChange:ve,dir:de,triggerPointerDownPosRef:Se,disabled:R,children:[f.jsx(mE.Provider,{scope:t,children:f.jsx(m4e,{scope:e.__scopeSelect,onNativeOptionAdd:K.useCallback(Ne=>{et(Ye=>new Set(Ye).add(Ne))},[]),onNativeOptionRemove:K.useCallback(Ne=>{et(Ye=>{const $e=new Set(Ye);return $e.delete(Ne),$e})},[]),children:r})}),ke?f.jsxs(Gte,{"aria-hidden":!0,required:z,tabIndex:-1,name:A,autoComplete:C,value:Ae,onChange:Ne=>Oe(Ne.target.value),disabled:R,form:V,children:[Ae===void 0?f.jsx("option",{value:""}):null,Array.from(ze)]},je):null]})})};_te.displayName=yS;var xte="SelectTrigger",bte=K.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,l=yE(r),h=Qg(xte,r),i=h.disabled||n,_=Xi(t,h.onTriggerChange),w=gE(r),A=K.useRef("touch"),[C,R,z]=Kte(U=>{const G=w().filter(Q=>!Q.disabled),H=G.find(Q=>Q.value===h.value),J=Wte(G,U,H);J!==void 0&&h.onValueChange(J.value)}),V=U=>{i||(h.onOpenChange(!0),z()),U&&(h.triggerPointerDownPosRef.current={x:Math.round(U.pageX),y:Math.round(U.pageY)})};return f.jsx(Gw,{asChild:!0,...l,children:f.jsx(mi.button,{type:"button",role:"combobox","aria-controls":h.contentId,"aria-expanded":h.open,"aria-required":h.required,"aria-autocomplete":"none",dir:h.dir,"data-state":h.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":qte(h.value)?"":void 0,...a,ref:_,onClick:an(a.onClick,U=>{U.currentTarget.focus(),A.current!=="mouse"&&V(U)}),onPointerDown:an(a.onPointerDown,U=>{A.current=U.pointerType;const G=U.target;G.hasPointerCapture(U.pointerId)&&G.releasePointerCapture(U.pointerId),U.button===0&&U.ctrlKey===!1&&U.pointerType==="mouse"&&(V(U),U.preventDefault())}),onKeyDown:an(a.onKeyDown,U=>{const G=C.current!=="";!(U.ctrlKey||U.altKey||U.metaKey)&&U.key.length===1&&R(U.key),!(G&&U.key===" ")&&d4e.includes(U.key)&&(V(),U.preventDefault())})})})});bte.displayName=xte;var wte="SelectValue",Ste=K.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:l,placeholder:h="",...i}=e,_=Qg(wte,r),{onValueNodeHasChildrenChange:w}=_,A=l!==void 0,C=Xi(t,_.onValueNodeChange);return rl(()=>{w(A)},[w,A]),f.jsx(mi.span,{...i,ref:C,style:{pointerEvents:"none"},children:qte(_.value)?f.jsx(f.Fragment,{children:h}):l})});Ste.displayName=wte;var y4e="SelectIcon",Ate=K.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return f.jsx(mi.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});Ate.displayName=y4e;var v4e="SelectPortal",Tte=e=>f.jsx(g0,{asChild:!0,...e});Tte.displayName=v4e;var Iv="SelectContent",Pte=K.forwardRef((e,t)=>{const r=Qg(Iv,e.__scopeSelect),[n,a]=K.useState();if(rl(()=>{a(new DocumentFragment)},[]),!r.open){const l=n;return l?Fw.createPortal(f.jsx(Ete,{scope:e.__scopeSelect,children:f.jsx(mE.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),l):null}return f.jsx(Cte,{...e,ref:t})});Pte.displayName=Iv;var wh=10,[Ete,ey]=D0(Iv),_4e="SelectContentImpl",Cte=K.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:h,side:i,sideOffset:_,align:w,alignOffset:A,arrowPadding:C,collisionBoundary:R,collisionPadding:z,sticky:V,hideWhenDetached:U,avoidCollisions:G,...H}=e,J=Qg(Iv,r),[Q,le]=K.useState(null),[ne,de]=K.useState(null),ue=Xi(t,ur=>le(ur)),[ve,Ae]=K.useState(null),[Oe,Se]=K.useState(null),ke=gE(r),[ze,et]=K.useState(!1),je=K.useRef(!1);K.useEffect(()=>{if(Q)return yP(Q)},[Q]),cP();const Ne=K.useCallback(ur=>{const[br,...Wt]=ke().map(Jt=>Jt.ref.current),[Be]=Wt.slice(-1),Nr=document.activeElement;for(const Jt of ur)if(Jt===Nr||(Jt==null||Jt.scrollIntoView({block:"nearest"}),Jt===br&&ne&&(ne.scrollTop=0),Jt===Be&&ne&&(ne.scrollTop=ne.scrollHeight),Jt==null||Jt.focus(),document.activeElement!==Nr))return},[ke,ne]),Ye=K.useCallback(()=>Ne([ve,Q]),[Ne,ve,Q]);K.useEffect(()=>{ze&&Ye()},[ze,Ye]);const{onOpenChange:$e,triggerPointerDownPosRef:We}=J;K.useEffect(()=>{if(Q){let ur={x:0,y:0};const br=Be=>{var Nr,Jt;ur={x:Math.abs(Math.round(Be.pageX)-(((Nr=We.current)==null?void 0:Nr.x)??0)),y:Math.abs(Math.round(Be.pageY)-(((Jt=We.current)==null?void 0:Jt.y)??0))}},Wt=Be=>{ur.x<=10&&ur.y<=10?Be.preventDefault():Q.contains(Be.target)||$e(!1),document.removeEventListener("pointermove",br),We.current=null};return We.current!==null&&(document.addEventListener("pointermove",br),document.addEventListener("pointerup",Wt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",br),document.removeEventListener("pointerup",Wt,{capture:!0})}}},[Q,$e,We]),K.useEffect(()=>{const ur=()=>$e(!1);return window.addEventListener("blur",ur),window.addEventListener("resize",ur),()=>{window.removeEventListener("blur",ur),window.removeEventListener("resize",ur)}},[$e]);const[Et,Je]=Kte(ur=>{const br=ke().filter(Nr=>!Nr.disabled),Wt=br.find(Nr=>Nr.ref.current===document.activeElement),Be=Wte(br,ur,Wt);Be&&setTimeout(()=>Be.ref.current.focus())}),ht=K.useCallback((ur,br,Wt)=>{const Be=!je.current&&!Wt;(J.value!==void 0&&J.value===br||Be)&&(Ae(ur),Be&&(je.current=!0))},[J.value]),tt=K.useCallback(()=>Q==null?void 0:Q.focus(),[Q]),Qt=K.useCallback((ur,br,Wt)=>{const Be=!je.current&&!Wt;(J.value!==void 0&&J.value===br||Be)&&Se(ur)},[J.value]),gr=n==="popper"?iD:Mte,sr=gr===iD?{side:i,sideOffset:_,align:w,alignOffset:A,arrowPadding:C,collisionBoundary:R,collisionPadding:z,sticky:V,hideWhenDetached:U,avoidCollisions:G}:{};return f.jsx(Ete,{scope:r,content:Q,viewport:ne,onViewportChange:de,itemRefCallback:ht,selectedItem:ve,onItemLeave:tt,itemTextRefCallback:Qt,focusSelectedItem:Ye,selectedItemText:Oe,position:n,isPositioned:ze,searchRef:Et,children:f.jsx(Kw,{as:Vl,allowPinchZoom:!0,children:f.jsx($w,{asChild:!0,trapped:J.open,onMountAutoFocus:ur=>{ur.preventDefault()},onUnmountAutoFocus:an(a,ur=>{var br;(br=J.trigger)==null||br.focus({preventScroll:!0}),ur.preventDefault()}),children:f.jsx(f0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:h,onFocusOutside:ur=>ur.preventDefault(),onDismiss:()=>J.onOpenChange(!1),children:f.jsx(gr,{role:"listbox",id:J.contentId,"data-state":J.open?"open":"closed",dir:J.dir,onContextMenu:ur=>ur.preventDefault(),...H,...sr,onPlaced:()=>et(!0),ref:ue,style:{display:"flex",flexDirection:"column",outline:"none",...H.style},onKeyDown:an(H.onKeyDown,ur=>{const br=ur.ctrlKey||ur.altKey||ur.metaKey;if(ur.key==="Tab"&&ur.preventDefault(),!br&&ur.key.length===1&&Je(ur.key),["ArrowUp","ArrowDown","Home","End"].includes(ur.key)){let Be=ke().filter(Nr=>!Nr.disabled).map(Nr=>Nr.ref.current);if(["ArrowUp","End"].includes(ur.key)&&(Be=Be.slice().reverse()),["ArrowUp","ArrowDown"].includes(ur.key)){const Nr=ur.target,Jt=Be.indexOf(Nr);Be=Be.slice(Jt+1)}setTimeout(()=>Ne(Be)),ur.preventDefault()}})})})})})})});Cte.displayName=_4e;var x4e="SelectItemAlignedPosition",Mte=K.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,l=Qg(Iv,r),h=ey(Iv,r),[i,_]=K.useState(null),[w,A]=K.useState(null),C=Xi(t,ue=>A(ue)),R=gE(r),z=K.useRef(!1),V=K.useRef(!0),{viewport:U,selectedItem:G,selectedItemText:H,focusSelectedItem:J}=h,Q=K.useCallback(()=>{if(l.trigger&&l.valueNode&&i&&w&&U&&G&&H){const ue=l.trigger.getBoundingClientRect(),ve=w.getBoundingClientRect(),Ae=l.valueNode.getBoundingClientRect(),Oe=H.getBoundingClientRect();if(l.dir!=="rtl"){const Nr=Oe.left-ve.left,Jt=Ae.left-Nr,Sn=ue.left-Jt,It=ue.width+Sn,Vn=Math.max(It,ve.width),Un=window.innerWidth-wh,Xr=H9(Jt,[wh,Math.max(wh,Un-Vn)]);i.style.minWidth=It+"px",i.style.left=Xr+"px"}else{const Nr=ve.right-Oe.right,Jt=window.innerWidth-Ae.right-Nr,Sn=window.innerWidth-ue.right-Jt,It=ue.width+Sn,Vn=Math.max(It,ve.width),Un=window.innerWidth-wh,Xr=H9(Jt,[wh,Math.max(wh,Un-Vn)]);i.style.minWidth=It+"px",i.style.right=Xr+"px"}const Se=R(),ke=window.innerHeight-wh*2,ze=U.scrollHeight,et=window.getComputedStyle(w),je=parseInt(et.borderTopWidth,10),Ne=parseInt(et.paddingTop,10),Ye=parseInt(et.borderBottomWidth,10),$e=parseInt(et.paddingBottom,10),We=je+Ne+ze+$e+Ye,Et=Math.min(G.offsetHeight*5,We),Je=window.getComputedStyle(U),ht=parseInt(Je.paddingTop,10),tt=parseInt(Je.paddingBottom,10),Qt=ue.top+ue.height/2-wh,gr=ke-Qt,sr=G.offsetHeight/2,ur=G.offsetTop+sr,br=je+Ne+ur,Wt=We-br;if(br<=Qt){const Nr=Se.length>0&&G===Se[Se.length-1].ref.current;i.style.bottom="0px";const Jt=w.clientHeight-U.offsetTop-U.offsetHeight,Sn=Math.max(gr,sr+(Nr?tt:0)+Jt+Ye),It=br+Sn;i.style.height=It+"px"}else{const Nr=Se.length>0&&G===Se[0].ref.current;i.style.top="0px";const Sn=Math.max(Qt,je+U.offsetTop+(Nr?ht:0)+sr)+Wt;i.style.height=Sn+"px",U.scrollTop=br-Qt+U.offsetTop}i.style.margin=`${wh}px 0`,i.style.minHeight=Et+"px",i.style.maxHeight=ke+"px",n==null||n(),requestAnimationFrame(()=>z.current=!0)}},[R,l.trigger,l.valueNode,i,w,U,G,H,l.dir,n]);rl(()=>Q(),[Q]);const[le,ne]=K.useState();rl(()=>{w&&ne(window.getComputedStyle(w).zIndex)},[w]);const de=K.useCallback(ue=>{ue&&V.current===!0&&(Q(),J==null||J(),V.current=!1)},[Q,J]);return f.jsx(w4e,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:z,onScrollButtonChange:de,children:f.jsx("div",{ref:_,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:le},children:f.jsx(mi.div,{...a,ref:C,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Mte.displayName=x4e;var b4e="SelectPopperPosition",iD=K.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=wh,...l}=e,h=yE(r);return f.jsx(pP,{...h,...l,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});iD.displayName=b4e;var[w4e,a4]=D0(Iv,{}),aD="SelectViewport",Ote=K.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,l=ey(aD,r),h=a4(aD,r),i=Xi(t,l.onViewportChange),_=K.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),f.jsx(mE.Slot,{scope:r,children:f.jsx(mi.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:an(a.onScroll,w=>{const A=w.currentTarget,{contentWrapper:C,shouldExpandOnScrollRef:R}=h;if(R!=null&&R.current&&C){const z=Math.abs(_.current-A.scrollTop);if(z>0){const V=window.innerHeight-wh*2,U=parseFloat(C.style.minHeight),G=parseFloat(C.style.height),H=Math.max(U,G);if(H<V){const J=H+z,Q=Math.min(V,J),le=J-Q;C.style.height=Q+"px",C.style.bottom==="0px"&&(A.scrollTop=le>0?le:0,C.style.justifyContent="flex-end")}}}_.current=A.scrollTop})})})]})});Ote.displayName=aD;var Rte="SelectGroup",[S4e,A4e]=D0(Rte),kte=K.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Ad();return f.jsx(S4e,{scope:r,id:a,children:f.jsx(mi.div,{role:"group","aria-labelledby":a,...n,ref:t})})});kte.displayName=Rte;var jte="SelectLabel",Nte=K.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=A4e(jte,r);return f.jsx(mi.div,{id:a.id,...n,ref:t})});Nte.displayName=jte;var nP="SelectItem",[T4e,Ite]=D0(nP),Dte=K.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:l,...h}=e,i=Qg(nP,r),_=ey(nP,r),w=i.value===n,[A,C]=K.useState(l??""),[R,z]=K.useState(!1),V=Xi(t,J=>{var Q;return(Q=_.itemRefCallback)==null?void 0:Q.call(_,J,n,a)}),U=Ad(),G=K.useRef("touch"),H=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(T4e,{scope:r,value:n,disabled:a,textId:U,isSelected:w,onItemTextChange:K.useCallback(J=>{C(Q=>Q||((J==null?void 0:J.textContent)??"").trim())},[]),children:f.jsx(mE.ItemSlot,{scope:r,value:n,disabled:a,textValue:A,children:f.jsx(mi.div,{role:"option","aria-labelledby":U,"data-highlighted":R?"":void 0,"aria-selected":w&&R,"data-state":w?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...h,ref:V,onFocus:an(h.onFocus,()=>z(!0)),onBlur:an(h.onBlur,()=>z(!1)),onClick:an(h.onClick,()=>{G.current!=="mouse"&&H()}),onPointerUp:an(h.onPointerUp,()=>{G.current==="mouse"&&H()}),onPointerDown:an(h.onPointerDown,J=>{G.current=J.pointerType}),onPointerMove:an(h.onPointerMove,J=>{var Q;G.current=J.pointerType,a?(Q=_.onItemLeave)==null||Q.call(_):G.current==="mouse"&&J.currentTarget.focus({preventScroll:!0})}),onPointerLeave:an(h.onPointerLeave,J=>{var Q;J.currentTarget===document.activeElement&&((Q=_.onItemLeave)==null||Q.call(_))}),onKeyDown:an(h.onKeyDown,J=>{var le;((le=_.searchRef)==null?void 0:le.current)!==""&&J.key===" "||(h4e.includes(J.key)&&H(),J.key===" "&&J.preventDefault())})})})})});Dte.displayName=nP;var i1="SelectItemText",Lte=K.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...l}=e,h=Qg(i1,r),i=ey(i1,r),_=Ite(i1,r),w=g4e(i1,r),[A,C]=K.useState(null),R=Xi(t,H=>C(H),_.onItemTextChange,H=>{var J;return(J=i.itemTextRefCallback)==null?void 0:J.call(i,H,_.value,_.disabled)}),z=A==null?void 0:A.textContent,V=K.useMemo(()=>f.jsx("option",{value:_.value,disabled:_.disabled,children:z},_.value),[_.disabled,_.value,z]),{onNativeOptionAdd:U,onNativeOptionRemove:G}=w;return rl(()=>(U(V),()=>G(V)),[U,G,V]),f.jsxs(f.Fragment,{children:[f.jsx(mi.span,{id:_.textId,...l,ref:R}),_.isSelected&&h.valueNode&&!h.valueNodeHasChildren?Fw.createPortal(l.children,h.valueNode):null]})});Lte.displayName=i1;var zte="SelectItemIndicator",Fte=K.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return Ite(zte,r).isSelected?f.jsx(mi.span,{"aria-hidden":!0,...n,ref:t}):null});Fte.displayName=zte;var oD="SelectScrollUpButton",Bte=K.forwardRef((e,t)=>{const r=ey(oD,e.__scopeSelect),n=a4(oD,e.__scopeSelect),[a,l]=K.useState(!1),h=Xi(t,n.onScrollButtonChange);return rl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=_.scrollTop>0;l(w)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?f.jsx(Ute,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop-_.offsetHeight)}}):null});Bte.displayName=oD;var sD="SelectScrollDownButton",Vte=K.forwardRef((e,t)=>{const r=ey(sD,e.__scopeSelect),n=a4(sD,e.__scopeSelect),[a,l]=K.useState(!1),h=Xi(t,n.onScrollButtonChange);return rl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=_.scrollHeight-_.clientHeight,A=Math.ceil(_.scrollTop)<w;l(A)};const _=r.viewport;return i(),_.addEventListener("scroll",i),()=>_.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?f.jsx(Ute,{...e,ref:h,onAutoScroll:()=>{const{viewport:i,selectedItem:_}=r;i&&_&&(i.scrollTop=i.scrollTop+_.offsetHeight)}}):null});Vte.displayName=sD;var Ute=K.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,l=ey("SelectScrollButton",r),h=K.useRef(null),i=gE(r),_=K.useCallback(()=>{h.current!==null&&(window.clearInterval(h.current),h.current=null)},[]);return K.useEffect(()=>()=>_(),[_]),rl(()=>{var A;const w=i().find(C=>C.ref.current===document.activeElement);(A=w==null?void 0:w.ref.current)==null||A.scrollIntoView({block:"nearest"})},[i]),f.jsx(mi.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:an(a.onPointerDown,()=>{h.current===null&&(h.current=window.setInterval(n,50))}),onPointerMove:an(a.onPointerMove,()=>{var w;(w=l.onItemLeave)==null||w.call(l),h.current===null&&(h.current=window.setInterval(n,50))}),onPointerLeave:an(a.onPointerLeave,()=>{_()})})}),P4e="SelectSeparator",$te=K.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return f.jsx(mi.div,{"aria-hidden":!0,...n,ref:t})});$te.displayName=P4e;var lD="SelectArrow",E4e=K.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=yE(r),l=Qg(lD,r),h=ey(lD,r);return l.open&&h.position==="popper"?f.jsx(mP,{...a,...n,ref:t}):null});E4e.displayName=lD;function qte(e){return e===""||e===void 0}var Gte=K.forwardRef((e,t)=>{const{value:r,...n}=e,a=K.useRef(null),l=Xi(t,a),h=l4e(r);return K.useEffect(()=>{const i=a.current,_=window.HTMLSelectElement.prototype,A=Object.getOwnPropertyDescriptor(_,"value").set;if(h!==r&&A){const C=new Event("change",{bubbles:!0});A.call(i,r),i.dispatchEvent(C)}},[h,r]),f.jsx(i4,{asChild:!0,children:f.jsx("select",{...n,ref:l,defaultValue:r})})});Gte.displayName="BubbleSelect";function Kte(e){const t=Eu(e),r=K.useRef(""),n=K.useRef(0),a=K.useCallback(h=>{const i=r.current+h;t(i),function _(w){r.current=w,window.clearTimeout(n.current),w!==""&&(n.current=window.setTimeout(()=>_(""),1e3))}(i)},[t]),l=K.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return K.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,l]}function Wte(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,l=r?e.indexOf(r):-1;let h=C4e(e,Math.max(l,0));a.length===1&&(h=h.filter(w=>w!==r));const _=h.find(w=>w.textValue.toLowerCase().startsWith(a.toLowerCase()));return _!==r?_:void 0}function C4e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var M4e=_te,Hte=bte,O4e=Ste,R4e=Ate,k4e=Tte,Zte=Pte,j4e=Ote,N4e=kte,Yte=Nte,Xte=Dte,I4e=Lte,D4e=Fte,Jte=Bte,Qte=Vte,ere=$te;const fs=M4e,tre=N4e,ps=O4e,Qo=K.forwardRef(({className:e,children:t,...r},n)=>f.jsxs(Hte,{ref:n,className:Gt("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,f.jsx(R4e,{asChild:!0,children:f.jsx($K,{className:"h-4 w-4 opacity-50"})})]}));Qo.displayName=Hte.displayName;const rre=K.forwardRef(({className:e,...t},r)=>f.jsx(Jte,{ref:r,className:Gt("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(oue,{className:"h-4 w-4"})}));rre.displayName=Jte.displayName;const nre=K.forwardRef(({className:e,...t},r)=>f.jsx(Qte,{ref:r,className:Gt("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx($K,{className:"h-4 w-4"})}));nre.displayName=Qte.displayName;const es=K.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>f.jsx(k4e,{children:f.jsxs(Zte,{ref:a,className:Gt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[f.jsx(rre,{}),f.jsx(j4e,{className:Gt("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),f.jsx(nre,{})]})}));es.displayName=Zte.displayName;const ire=K.forwardRef(({className:e,...t},r)=>f.jsx(Yte,{ref:r,className:Gt("px-2 py-1.5 text-sm font-semibold",e),...t}));ire.displayName=Yte.displayName;const Kr=K.forwardRef(({className:e,children:t,...r},n)=>f.jsxs(Xte,{ref:n,className:Gt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[f.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:f.jsx(D4e,{children:f.jsx(UK,{className:"h-4 w-4"})})}),f.jsx(I4e,{children:t})]}));Kr.displayName=Xte.displayName;const L4e=K.forwardRef(({className:e,...t},r)=>f.jsx(ere,{ref:r,className:Gt("-mx-1 my-1 h-px bg-muted",e),...t}));L4e.displayName=ere.displayName;const Ai=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("rounded-xl md:border bg-card text-card-foreground md:shadow",e),...t}));Ai.displayName="Card";const Ci=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("flex flex-col space-y-1.5 p-6",e),...t}));Ci.displayName="CardHeader";const Mi=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("font-semibold leading-none tracking-tight",e),...t}));Mi.displayName="CardTitle";const Ya=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("text-sm text-muted-foreground",e),...t}));Ya.displayName="CardDescription";const ji=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("p-6 pt-0",e),...t}));ji.displayName="CardContent";const vS=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,className:Gt("flex items-center p-6 pt-0",e),...t}));vS.displayName="CardFooter";const z4e={light:"",dark:".dark"},are=K.createContext(null);function ore(){const e=K.useContext(are);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const o4=K.forwardRef(({id:e,className:t,children:r,config:n,...a},l)=>{const h=K.useId(),i=`chart-${e||h.replace(/:/g,"")}`;return f.jsx(are.Provider,{value:{config:n},children:f.jsxs("div",{"data-chart":i,ref:l,className:Gt("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[f.jsx(F4e,{id:i,config:n}),f.jsx(Qs,{children:r})]})})});o4.displayName="Chart";const F4e=({id:e,config:t})=>{const r=Object.entries(t).filter(([,n])=>n.theme||n.color);return r.length?f.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(z4e).map(([n,a])=>`
${a} [data-chart=${e}] {
${r.map(([l,h])=>{var _;const i=((_=h.theme)==null?void 0:_[n])||h.color;return i?`  --color-${l}: ${i};`:null}).join(`
`)}
}
`).join(`
`)}}):null},sre=wa,s4=K.forwardRef(({active:e,payload:t,className:r,indicator:n="dot",hideLabel:a=!1,hideIndicator:l=!1,label:h,labelFormatter:i,labelClassName:_,formatter:w,color:A,nameKey:C,labelKey:R},z)=>{const{config:V}=ore(),U=K.useMemo(()=>{var ne;if(a||!(t!=null&&t.length))return null;const[H]=t,J=`${R||(H==null?void 0:H.dataKey)||(H==null?void 0:H.name)||"value"}`,Q=cD(V,H,J),le=!R&&typeof h=="string"?((ne=V[h])==null?void 0:ne.label)||h:Q==null?void 0:Q.label;return i?f.jsx("div",{className:Gt("font-medium",_),children:i(le,t)}):le?f.jsx("div",{className:Gt("font-medium",_),children:le}):null},[h,i,t,a,_,V,R]);if(!e||!(t!=null&&t.length))return null;const G=t.length===1&&n!=="dot";return f.jsxs("div",{ref:z,className:Gt("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[G?null:U,f.jsx("div",{className:"grid gap-1.5",children:t.map((H,J)=>{const Q=`${C||H.name||H.dataKey||"value"}`,le=cD(V,H,Q),ne=A||H.payload.fill||H.color;return f.jsx("div",{className:Gt("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:w&&(H==null?void 0:H.value)!==void 0&&H.name?w(H.value,H.name,H,J,H.payload):f.jsxs(f.Fragment,{children:[le!=null&&le.icon?f.jsx(le.icon,{}):!l&&f.jsx("div",{className:Gt("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":G&&n==="dashed"}),style:{"--color-bg":ne,"--color-border":ne}}),f.jsxs("div",{className:Gt("flex flex-1 justify-between leading-none",G?"items-end":"items-center"),children:[f.jsxs("div",{className:"grid gap-1.5",children:[G?U:null,f.jsx("span",{className:"text-muted-foreground",children:(le==null?void 0:le.label)||H.name})]}),H.value&&f.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:H.value.toLocaleString()})]})]})},H.dataKey)})})]})});s4.displayName="ChartTooltip";const B4e=kh,lre=K.forwardRef(({className:e,hideIcon:t=!1,payload:r,verticalAlign:n="bottom",nameKey:a},l)=>{const{config:h}=ore();return r!=null&&r.length?f.jsx("div",{ref:l,className:Gt("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",e),children:r.map(i=>{const _=`${a||i.dataKey||"value"}`,w=cD(h,i,_);return f.jsxs("div",{className:Gt("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[w!=null&&w.icon&&!t?f.jsx(w.icon,{}):f.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:i.color}}),w==null?void 0:w.label]},i.value)})}):null});lre.displayName="ChartLegend";function cD(e,t,r){if(typeof t!="object"||t===null)return;const n="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=r;return r in t&&typeof t[r]=="string"?a=t[r]:n&&r in n&&typeof n[r]=="string"&&(a=n[r]),a in e?e[a]:e[r]}const Z9={views:{label:"Page Views"},violations:{label:"Violations",color:"hsl(var(--chart-1))"},accidents:{label:"Accidents",color:"hsl(var(--chart-2))"}};function V4e(){const[e,t]=K.useState("violations"),[r,n]=K.useState("all"),[a,l]=K.useState([]),[h,i]=K.useState(!0),[_,w]=K.useState(null),{token:A}=ra();K.useEffect(()=>{C()},[r]);const C=async()=>{try{i(!0),w(null);const{data:V}=await Bn.get(`/dashboard/chart?period=${r}`,{headers:{Authorization:A}});if(V.success){const U=V.data.chartData.map(G=>{let H="";return r==="week"?H=`${G.year}-${String(G.month).padStart(2,"0")}-${String(G.day).padStart(2,"0")}`:r==="years"?H=`${G.year}-01-01`:H=`${G.year}-${String(G.month).padStart(2,"0")}-01`,{date:H,violations:G.violations||0,accidents:G.accidents||0}});l(U)}}catch(V){console.error("Error fetching chart data:",V),w("Failed to load chart data")}finally{i(!1)}},R=K.useMemo(()=>({violations:a.reduce((V,U)=>V+U.violations,0),accidents:a.reduce((V,U)=>V+U.accidents,0)}),[a]),z=V=>{switch(V){case"week":return"Last Week";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"months":return"Last 12 Months";case"year":return"Last Year";case"years":return"Last 5 Years";case"all":return"All Time";default:return"All Time"}};return f.jsxs(Ai,{className:"md:shadow-none border",children:[f.jsxs(Ci,{className:"flex flex-col items-stretch space-y-0 border-b p-0 sm:flex-row",children:[f.jsxs("div",{className:"flex flex-1 flex-col justify-center gap-1 px-6 py-5 sm:py-6",children:[f.jsx(Mi,{children:"Violation & Accidents Overview"}),f.jsxs(Ya,{children:["Showing violation and accident frequency for ",z(r)]}),f.jsx("div",{className:"mt-2",children:f.jsxs(fs,{value:r,onValueChange:n,children:[f.jsx(Qo,{className:"w-[180px]",children:f.jsx(ps,{placeholder:"Select time period"})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"week",children:"Last Week"}),f.jsx(Kr,{value:"3months",children:"Last 3 Months"}),f.jsx(Kr,{value:"6months",children:"Last 6 Months"}),f.jsx(Kr,{value:"months",children:"Last 12 Months"}),f.jsx(Kr,{value:"year",children:"Last Year"}),f.jsx(Kr,{value:"years",children:"Last 5 Years"}),f.jsx(Kr,{value:"all",children:"All Time"})]})]})})]}),f.jsx("div",{className:"flex",children:["violations","accidents"].map(V=>f.jsxs("button",{"data-active":e===V,className:"relative z-30 flex flex-1 flex-col justify-center gap-1 border-t px-6 py-4 text-left even:border-l data-[active=true]:bg-muted/50 sm:border-l sm:border-t-0 sm:px-8 sm:py-6",onClick:()=>t(V),children:[f.jsx("span",{className:"text-xs text-muted-foreground",children:Z9[V].label}),f.jsx("span",{className:"text-lg font-bold leading-none sm:text-3xl",children:h?"...":R[V].toLocaleString()})]},V))})]}),f.jsx(ji,{className:"px-2 sm:p-6",children:h?f.jsx("div",{className:"flex items-center justify-center h-[250px]",children:f.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})}):_?f.jsx("div",{className:"flex items-center justify-center h-[250px]",children:f.jsx("div",{className:"text-red-500",children:_})}):a.length===0?f.jsx("div",{className:"flex items-center justify-center h-[250px]",children:f.jsx("div",{className:"text-muted-foreground",children:"No data available for the selected period"})}):f.jsx(o4,{config:Z9,className:"aspect-auto h-[250px] w-full",children:f.jsxs(Eh,{accessibilityLayer:!0,data:a,margin:{left:12,right:12},children:[f.jsx(js,{vertical:!1}),f.jsx(lo,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:V=>{const U=new Date(V);return r==="week"?U.toLocaleDateString("en-US",{month:"short",day:"numeric"}):r==="years"?U.toLocaleDateString("en-US",{year:"numeric"}):U.toLocaleDateString("en-US",{month:"short",year:"numeric"})}}),f.jsx(sre,{content:f.jsx(s4,{className:"w-[150px]",nameKey:"views",labelFormatter:V=>{const U=new Date(V);return r==="week"?U.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):r==="years"?U.toLocaleDateString("en-US",{year:"numeric"}):U.toLocaleDateString("en-US",{month:"short",year:"numeric"})}})}),f.jsx(Ro,{dataKey:e,fill:`var(--color-${e})`})]})})})]})}function ea(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Mu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ic(e,t){const r=ea(e);return isNaN(t)?Mu(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Fh(e,t){const r=ea(e);if(isNaN(t))return Mu(e,NaN);if(!t)return r;const n=r.getDate(),a=Mu(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const l=a.getDate();return n>=l?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const l4=6048e5,U4e=864e5;let $4e={};function _S(){return $4e}function Yf(e,t){var i,_,w,A;const r=_S(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.weekStartsOn)??0,a=ea(e),l=a.getDay(),h=(l<n?7:0)+l-n;return a.setDate(a.getDate()-h),a.setHours(0,0,0,0),a}function Dv(e){return Yf(e,{weekStartsOn:1})}function cre(e){const t=ea(e),r=t.getFullYear(),n=Mu(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=Dv(n),l=Mu(e,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const h=Dv(l);return t.getTime()>=a.getTime()?r+1:t.getTime()>=h.getTime()?r:r-1}function i0(e){const t=ea(e);return t.setHours(0,0,0,0),t}function iP(e){const t=ea(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Lf(e,t){const r=i0(e),n=i0(t),a=+r-iP(r),l=+n-iP(n);return Math.round((a-l)/U4e)}function q4e(e){const t=cre(e),r=Mu(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Dv(r)}function uD(e,t){const r=t*7;return ic(e,r)}function G4e(e,t){return Fh(e,t*12)}function K4e(e){let t;return e.forEach(function(r){const n=ea(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function W4e(e){let t;return e.forEach(r=>{const n=ea(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function Dc(e,t){const r=i0(e),n=i0(t);return+r==+n}function c4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function H4e(e){if(!c4(e)&&typeof e!="number")return!1;const t=ea(e);return!isNaN(Number(t))}function Lw(e,t){const r=ea(e),n=ea(t),a=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return a*12+l}function Z4e(e,t,r){const n=Yf(e,r),a=Yf(t,r),l=+n-iP(n),h=+a-iP(a);return Math.round((l-h)/l4)}function u4(e){const t=ea(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function zc(e){const t=ea(e);return t.setDate(1),t.setHours(0,0,0,0),t}function ure(e){const t=ea(e),r=Mu(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function d4(e,t){var i,_,w,A;const r=_S(),n=(t==null?void 0:t.weekStartsOn)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.weekStartsOn)??r.weekStartsOn??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.weekStartsOn)??0,a=ea(e),l=a.getDay(),h=(l<n?-7:0)+6-(l-n);return a.setDate(a.getDate()+h),a.setHours(23,59,59,999),a}function dre(e){return d4(e,{weekStartsOn:1})}const Y4e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},X4e=(e,t,r)=>{let n;const a=Y4e[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Sj(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const J4e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Q4e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},eze={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},tze={date:Sj({formats:J4e,defaultWidth:"full"}),time:Sj({formats:Q4e,defaultWidth:"full"}),dateTime:Sj({formats:eze,defaultWidth:"full"})},rze={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},nze=(e,t,r,n)=>rze[e];function Kb(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const h=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):h;a=e.formattingValues[i]||e.formattingValues[h]}else{const h=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[i]||e.values[h]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const ize={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},aze={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},oze={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sze={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},lze={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},cze={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},uze=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},dze={ordinalNumber:uze,era:Kb({values:ize,defaultWidth:"wide"}),quarter:Kb({values:aze,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Kb({values:oze,defaultWidth:"wide"}),day:Kb({values:sze,defaultWidth:"wide"}),dayPeriod:Kb({values:lze,defaultWidth:"wide",formattingValues:cze,defaultFormattingWidth:"wide"})};function Wb(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const h=l[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],_=Array.isArray(i)?fze(i,C=>C.test(h)):hze(i,C=>C.test(h));let w;w=e.valueCallback?e.valueCallback(_):_,w=r.valueCallback?r.valueCallback(w):w;const A=t.slice(h.length);return{value:w,rest:A}}}function hze(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function fze(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function pze(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],l=t.match(e.parsePattern);if(!l)return null;let h=e.valueCallback?e.valueCallback(l[0]):l[0];h=r.valueCallback?r.valueCallback(h):h;const i=t.slice(a.length);return{value:h,rest:i}}}const mze=/^(\d+)(th|st|nd|rd)?/i,gze=/\d+/i,yze={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vze={any:[/^b/i,/^(a|c)/i]},_ze={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},xze={any:[/1/i,/2/i,/3/i,/4/i]},bze={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},wze={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Sze={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Aze={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Tze={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Pze={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Eze={ordinalNumber:pze({matchPattern:mze,parsePattern:gze,valueCallback:e=>parseInt(e,10)}),era:Wb({matchPatterns:yze,defaultMatchWidth:"wide",parsePatterns:vze,defaultParseWidth:"any"}),quarter:Wb({matchPatterns:_ze,defaultMatchWidth:"wide",parsePatterns:xze,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Wb({matchPatterns:bze,defaultMatchWidth:"wide",parsePatterns:wze,defaultParseWidth:"any"}),day:Wb({matchPatterns:Sze,defaultMatchWidth:"wide",parsePatterns:Aze,defaultParseWidth:"any"}),dayPeriod:Wb({matchPatterns:Tze,defaultMatchWidth:"any",parsePatterns:Pze,defaultParseWidth:"any"})},hre={code:"en-US",formatDistance:X4e,formatLong:tze,formatRelative:nze,localize:dze,match:Eze,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Cze(e){const t=ea(e);return Lf(t,ure(t))+1}function fre(e){const t=ea(e),r=+Dv(t)-+q4e(t);return Math.round(r/l4)+1}function pre(e,t){var A,C,R,z;const r=ea(e),n=r.getFullYear(),a=_S(),l=(t==null?void 0:t.firstWeekContainsDate)??((C=(A=t==null?void 0:t.locale)==null?void 0:A.options)==null?void 0:C.firstWeekContainsDate)??a.firstWeekContainsDate??((z=(R=a.locale)==null?void 0:R.options)==null?void 0:z.firstWeekContainsDate)??1,h=Mu(e,0);h.setFullYear(n+1,0,l),h.setHours(0,0,0,0);const i=Yf(h,t),_=Mu(e,0);_.setFullYear(n,0,l),_.setHours(0,0,0,0);const w=Yf(_,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=w.getTime()?n:n-1}function Mze(e,t){var i,_,w,A;const r=_S(),n=(t==null?void 0:t.firstWeekContainsDate)??((_=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:_.firstWeekContainsDate)??r.firstWeekContainsDate??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.firstWeekContainsDate)??1,a=pre(e,t),l=Mu(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),Yf(l,t)}function mre(e,t){const r=ea(e),n=+Yf(r,t)-+Mze(r,t);return Math.round(n/l4)+1}function Pa(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const _g={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Pa(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Pa(r+1,2)},d(e,t){return Pa(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Pa(e.getHours()%12||12,t.length)},H(e,t){return Pa(e.getHours(),t.length)},m(e,t){return Pa(e.getMinutes(),t.length)},s(e,t){return Pa(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Pa(a,t.length)}},Y_={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Y9={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return _g.y(e,t)},Y:function(e,t,r,n){const a=pre(e,n),l=a>0?a:1-a;if(t==="YY"){const h=l%100;return Pa(h,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):Pa(l,t.length)},R:function(e,t){const r=cre(e);return Pa(r,t.length)},u:function(e,t){const r=e.getFullYear();return Pa(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Pa(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Pa(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return _g.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Pa(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=mre(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Pa(a,t.length)},I:function(e,t,r){const n=fre(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Pa(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):_g.d(e,t)},D:function(e,t,r){const n=Cze(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Pa(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return Pa(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return Pa(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Pa(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Y_.noon:n===0?a=Y_.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Y_.evening:n>=12?a=Y_.afternoon:n>=4?a=Y_.morning:a=Y_.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return _g.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):_g.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Pa(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Pa(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):_g.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):_g.s(e,t)},S:function(e,t){return _g.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return J9(n);case"XXXX":case"XX":return av(n);case"XXXXX":case"XXX":default:return av(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return J9(n);case"xxxx":case"xx":return av(n);case"xxxxx":case"xxx":default:return av(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+X9(n,":");case"OOOO":default:return"GMT"+av(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+X9(n,":");case"zzzz":default:return"GMT"+av(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Pa(n,t.length)},T:function(e,t,r){const n=e.getTime();return Pa(n,t.length)}};function X9(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?r+String(a):r+String(a)+t+Pa(l,2)}function J9(e,t){return e%60===0?(e>0?"-":"+")+Pa(Math.abs(e)/60,2):av(e,t)}function av(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Pa(Math.trunc(n/60),2),l=Pa(n%60,2);return r+a+t+l}const Q9=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},gre=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Oze=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Q9(e,t);let l;switch(n){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",Q9(n,t)).replace("{{time}}",gre(a,t))},Rze={p:gre,P:Oze},kze=/^D+$/,jze=/^Y+$/,Nze=["D","DD","YY","YYYY"];function Ize(e){return kze.test(e)}function Dze(e){return jze.test(e)}function Lze(e,t,r){const n=zze(e,t,r);if(console.warn(n),Nze.includes(e))throw new RangeError(n)}function zze(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Fze=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Bze=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Vze=/^'([^]*?)'?$/,Uze=/''/g,$ze=/[a-zA-Z]/;function Vc(e,t,r){var A,C,R,z,V,U,G,H;const n=_S(),a=(r==null?void 0:r.locale)??n.locale??hre,l=(r==null?void 0:r.firstWeekContainsDate)??((C=(A=r==null?void 0:r.locale)==null?void 0:A.options)==null?void 0:C.firstWeekContainsDate)??n.firstWeekContainsDate??((z=(R=n.locale)==null?void 0:R.options)==null?void 0:z.firstWeekContainsDate)??1,h=(r==null?void 0:r.weekStartsOn)??((U=(V=r==null?void 0:r.locale)==null?void 0:V.options)==null?void 0:U.weekStartsOn)??n.weekStartsOn??((H=(G=n.locale)==null?void 0:G.options)==null?void 0:H.weekStartsOn)??0,i=ea(e);if(!H4e(i))throw new RangeError("Invalid time value");let _=t.match(Bze).map(J=>{const Q=J[0];if(Q==="p"||Q==="P"){const le=Rze[Q];return le(J,a.formatLong)}return J}).join("").match(Fze).map(J=>{if(J==="''")return{isToken:!1,value:"'"};const Q=J[0];if(Q==="'")return{isToken:!1,value:qze(J)};if(Y9[Q])return{isToken:!0,value:J};if(Q.match($ze))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Q+"`");return{isToken:!1,value:J}});a.localize.preprocessor&&(_=a.localize.preprocessor(i,_));const w={firstWeekContainsDate:l,weekStartsOn:h,locale:a};return _.map(J=>{if(!J.isToken)return J.value;const Q=J.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Dze(Q)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Ize(Q))&&Lze(Q,t,String(e));const le=Y9[Q[0]];return le(i,Q,a.localize,w)}).join("")}function qze(e){const t=e.match(Vze);return t?t[1].replace(Uze,"'"):e}function Gze(e){const t=ea(e),r=t.getFullYear(),n=t.getMonth(),a=Mu(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function Kze(e){return Math.trunc(+ea(e)/1e3)}function Wze(e){const t=ea(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Hze(e,t){return Z4e(Wze(e),zc(e),t)+1}function dD(e,t){const r=ea(e),n=ea(t);return r.getTime()>n.getTime()}function yre(e,t){const r=ea(e),n=ea(t);return+r<+n}function h4(e,t){const r=ea(e),n=ea(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Zze(e,t){const r=ea(e),n=ea(t);return r.getFullYear()===n.getFullYear()}function Aj(e,t){return ic(e,-t)}function yA(e,t){const r=ea(e),n=r.getFullYear(),a=r.getDate(),l=Mu(e,0);l.setFullYear(n,t,15),l.setHours(0,0,0,0);const h=Gze(l);return r.setMonth(t,Math.min(a,h)),r}function hD(e,t){const r=ea(e);return isNaN(+r)?Mu(e,NaN):(r.setFullYear(t),r)}var ui=function(){return ui=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},ui.apply(this,arguments)};function Yze(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function vre(e,t,r){for(var n=0,a=t.length,l;n<a;n++)(l||!(n in t))&&(l||(l=Array.prototype.slice.call(t,0,n)),l[n]=t[n]);return e.concat(l||Array.prototype.slice.call(t))}function xS(e){return e.mode==="multiple"}function bS(e){return e.mode==="range"}function vE(e){return e.mode==="single"}var Xze={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Jze(e,t){return Vc(e,"LLLL y",t)}function Qze(e,t){return Vc(e,"d",t)}function eFe(e,t){return Vc(e,"LLLL",t)}function tFe(e){return"".concat(e)}function rFe(e,t){return Vc(e,"cccccc",t)}function nFe(e,t){return Vc(e,"yyyy",t)}var iFe=Object.freeze({__proto__:null,formatCaption:Jze,formatDay:Qze,formatMonthCaption:eFe,formatWeekNumber:tFe,formatWeekdayName:rFe,formatYearCaption:nFe}),aFe=function(e,t,r){return Vc(e,"do MMMM (EEEE)",r)},oFe=function(){return"Month: "},sFe=function(){return"Go to next month"},lFe=function(){return"Go to previous month"},cFe=function(e,t){return Vc(e,"cccc",t)},uFe=function(e){return"Week n. ".concat(e)},dFe=function(){return"Year: "},hFe=Object.freeze({__proto__:null,labelDay:aFe,labelMonthDropdown:oFe,labelNext:sFe,labelPrevious:lFe,labelWeekNumber:uFe,labelWeekday:cFe,labelYearDropdown:dFe});function fFe(){var e="buttons",t=Xze,r=hre,n={},a={},l=1,h={},i=new Date;return{captionLayout:e,classNames:t,formatters:iFe,labels:hFe,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:l,styles:h,today:i,mode:"default"}}function pFe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,l=e.fromDate,h=e.toDate;return n?l=zc(n):t&&(l=new Date(t,0,1)),a?h=u4(a):r&&(h=new Date(r,11,31)),{fromDate:l?i0(l):void 0,toDate:h?i0(h):void 0}}var _re=K.createContext(void 0);function mFe(e){var t,r=e.initialProps,n=fFe(),a=pFe(r),l=a.fromDate,h=a.toDate,i=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;i!=="buttons"&&(!l||!h)&&(i="buttons");var _;(vE(r)||xS(r)||bS(r))&&(_=r.onSelect);var w=ui(ui(ui({},n),r),{captionLayout:i,classNames:ui(ui({},n.classNames),r.classNames),components:ui({},r.components),formatters:ui(ui({},n.formatters),r.formatters),fromDate:l,labels:ui(ui({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:ui(ui({},n.modifiers),r.modifiers),modifiersClassNames:ui(ui({},n.modifiersClassNames),r.modifiersClassNames),onSelect:_,styles:ui(ui({},n.styles),r.styles),toDate:h});return f.jsx(_re.Provider,{value:w,children:e.children})}function Ja(){var e=K.useContext(_re);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function xre(e){var t=Ja(),r=t.locale,n=t.classNames,a=t.styles,l=t.formatters.formatCaption;return f.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:l(e.displayMonth,{locale:r})})}function gFe(e){return f.jsx("svg",ui({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:f.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function bre(e){var t,r,n=e.onChange,a=e.value,l=e.children,h=e.caption,i=e.className,_=e.style,w=Ja(),A=(r=(t=w.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:gFe;return f.jsxs("div",{className:i,style:_,children:[f.jsx("span",{className:w.classNames.vhidden,children:e["aria-label"]}),f.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:w.classNames.dropdown,style:w.styles.dropdown,value:a,onChange:n,children:l}),f.jsxs("div",{className:w.classNames.caption_label,style:w.styles.caption_label,"aria-hidden":"true",children:[h,f.jsx(A,{className:w.classNames.dropdown_icon,style:w.styles.dropdown_icon})]})]})}function yFe(e){var t,r=Ja(),n=r.fromDate,a=r.toDate,l=r.styles,h=r.locale,i=r.formatters.formatMonthCaption,_=r.classNames,w=r.components,A=r.labels.labelMonthDropdown;if(!n)return f.jsx(f.Fragment,{});if(!a)return f.jsx(f.Fragment,{});var C=[];if(Zze(n,a))for(var R=zc(n),z=n.getMonth();z<=a.getMonth();z++)C.push(yA(R,z));else for(var R=zc(new Date),z=0;z<=11;z++)C.push(yA(R,z));var V=function(G){var H=Number(G.target.value),J=yA(zc(e.displayMonth),H);e.onChange(J)},U=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:bre;return f.jsx(U,{name:"months","aria-label":A(),className:_.dropdown_month,style:l.dropdown_month,onChange:V,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:h}),children:C.map(function(G){return f.jsx("option",{value:G.getMonth(),children:i(G,{locale:h})},G.getMonth())})})}function vFe(e){var t,r=e.displayMonth,n=Ja(),a=n.fromDate,l=n.toDate,h=n.locale,i=n.styles,_=n.classNames,w=n.components,A=n.formatters.formatYearCaption,C=n.labels.labelYearDropdown,R=[];if(!a)return f.jsx(f.Fragment,{});if(!l)return f.jsx(f.Fragment,{});for(var z=a.getFullYear(),V=l.getFullYear(),U=z;U<=V;U++)R.push(hD(ure(new Date),U));var G=function(J){var Q=hD(zc(r),Number(J.target.value));e.onChange(Q)},H=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:bre;return f.jsx(H,{name:"years","aria-label":C(),className:_.dropdown_year,style:i.dropdown_year,onChange:G,value:r.getFullYear(),caption:A(r,{locale:h}),children:R.map(function(J){return f.jsx("option",{value:J.getFullYear(),children:A(J,{locale:h})},J.getFullYear())})})}function _Fe(e,t){var r=K.useState(e),n=r[0],a=r[1],l=t===void 0?n:t;return[l,a]}function xFe(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,l=e.toDate,h=e.fromDate,i=e.numberOfMonths,_=i===void 0?1:i;if(l&&Lw(l,a)<0){var w=-1*(_-1);a=Fh(l,w)}return h&&Lw(a,h)<0&&(a=h),zc(a)}function bFe(){var e=Ja(),t=xFe(e),r=_Fe(t,e.month),n=r[0],a=r[1],l=function(h){var i;if(!e.disableNavigation){var _=zc(h);a(_),(i=e.onMonthChange)===null||i===void 0||i.call(e,_)}};return[n,l]}function wFe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=zc(e),l=zc(Fh(a,n)),h=Lw(l,a),i=[],_=0;_<h;_++){var w=Fh(a,_);i.push(w)}return r&&(i=i.reverse()),i}function SFe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,h=n?l:1,i=zc(e);if(!r)return Fh(i,h);var _=Lw(r,e);if(!(_<l))return Fh(i,h)}}function AFe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,h=n?l:1,i=zc(e);if(!r)return Fh(i,-h);var _=Lw(i,r);if(!(_<=0))return Fh(i,-h)}}var wre=K.createContext(void 0);function TFe(e){var t=Ja(),r=bFe(),n=r[0],a=r[1],l=wFe(n,t),h=SFe(n,t),i=AFe(n,t),_=function(C){return l.some(function(R){return h4(C,R)})},w=function(C,R){_(C)||(R&&yre(C,R)?a(Fh(C,1+t.numberOfMonths*-1)):a(C))},A={currentMonth:n,displayMonths:l,goToMonth:a,goToDate:w,previousMonth:i,nextMonth:h,isDateDisplayed:_};return f.jsx(wre.Provider,{value:A,children:e.children})}function wS(){var e=K.useContext(wre);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function eK(e){var t,r=Ja(),n=r.classNames,a=r.styles,l=r.components,h=wS().goToMonth,i=function(A){h(Fh(A,e.displayIndex?-e.displayIndex:0))},_=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:xre,w=f.jsx(_,{id:e.id,displayMonth:e.displayMonth});return f.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[f.jsx("div",{className:n.vhidden,children:w}),f.jsx(yFe,{onChange:i,displayMonth:e.displayMonth}),f.jsx(vFe,{onChange:i,displayMonth:e.displayMonth})]})}function PFe(e){return f.jsx("svg",ui({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:f.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function EFe(e){return f.jsx("svg",ui({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:f.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var aP=K.forwardRef(function(e,t){var r=Ja(),n=r.classNames,a=r.styles,l=[n.button_reset,n.button];e.className&&l.push(e.className);var h=l.join(" "),i=ui(ui({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),f.jsx("button",ui({},e,{ref:t,type:"button",className:h,style:i}))});function CFe(e){var t,r,n=Ja(),a=n.dir,l=n.locale,h=n.classNames,i=n.styles,_=n.labels,w=_.labelPrevious,A=_.labelNext,C=n.components;if(!e.nextMonth&&!e.previousMonth)return f.jsx(f.Fragment,{});var R=w(e.previousMonth,{locale:l}),z=[h.nav_button,h.nav_button_previous].join(" "),V=A(e.nextMonth,{locale:l}),U=[h.nav_button,h.nav_button_next].join(" "),G=(t=C==null?void 0:C.IconRight)!==null&&t!==void 0?t:EFe,H=(r=C==null?void 0:C.IconLeft)!==null&&r!==void 0?r:PFe;return f.jsxs("div",{className:h.nav,style:i.nav,children:[!e.hidePrevious&&f.jsx(aP,{name:"previous-month","aria-label":R,className:z,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?f.jsx(G,{className:h.nav_icon,style:i.nav_icon}):f.jsx(H,{className:h.nav_icon,style:i.nav_icon})}),!e.hideNext&&f.jsx(aP,{name:"next-month","aria-label":V,className:U,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?f.jsx(H,{className:h.nav_icon,style:i.nav_icon}):f.jsx(G,{className:h.nav_icon,style:i.nav_icon})})]})}function tK(e){var t=Ja().numberOfMonths,r=wS(),n=r.previousMonth,a=r.nextMonth,l=r.goToMonth,h=r.displayMonths,i=h.findIndex(function(V){return h4(e.displayMonth,V)}),_=i===0,w=i===h.length-1,A=t>1&&(_||!w),C=t>1&&(w||!_),R=function(){n&&l(n)},z=function(){a&&l(a)};return f.jsx(CFe,{displayMonth:e.displayMonth,hideNext:A,hidePrevious:C,nextMonth:a,previousMonth:n,onPreviousClick:R,onNextClick:z})}function MFe(e){var t,r=Ja(),n=r.classNames,a=r.disableNavigation,l=r.styles,h=r.captionLayout,i=r.components,_=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:xre,w;return a?w=f.jsx(_,{id:e.id,displayMonth:e.displayMonth}):h==="dropdown"?w=f.jsx(eK,{displayMonth:e.displayMonth,id:e.id}):h==="dropdown-buttons"?w=f.jsxs(f.Fragment,{children:[f.jsx(eK,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),f.jsx(tK,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):w=f.jsxs(f.Fragment,{children:[f.jsx(_,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),f.jsx(tK,{displayMonth:e.displayMonth,id:e.id})]}),f.jsx("div",{className:n.caption,style:l.caption,children:w})}function OFe(e){var t=Ja(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?f.jsx("tfoot",{className:a,style:n.tfoot,children:f.jsx("tr",{children:f.jsx("td",{colSpan:8,children:r})})}):f.jsx(f.Fragment,{})}function RFe(e,t,r){for(var n=r?Dv(new Date):Yf(new Date,{locale:e,weekStartsOn:t}),a=[],l=0;l<7;l++){var h=ic(n,l);a.push(h)}return a}function kFe(){var e=Ja(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,l=e.weekStartsOn,h=e.ISOWeek,i=e.formatters.formatWeekdayName,_=e.labels.labelWeekday,w=RFe(a,l,h);return f.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&f.jsx("td",{style:r.head_cell,className:t.head_cell}),w.map(function(A,C){return f.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":_(A,{locale:a}),children:i(A,{locale:a})},C)})]})}function jFe(){var e,t=Ja(),r=t.classNames,n=t.styles,a=t.components,l=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:kFe;return f.jsx("thead",{style:n.head,className:r.head,children:f.jsx(l,{})})}function NFe(e){var t=Ja(),r=t.locale,n=t.formatters.formatDay;return f.jsx(f.Fragment,{children:n(e.date,{locale:r})})}var f4=K.createContext(void 0);function IFe(e){if(!xS(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return f.jsx(f4.Provider,{value:t,children:e.children})}return f.jsx(DFe,{initialProps:e.initialProps,children:e.children})}function DFe(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,l=t.max,h=function(w,A,C){var R,z;(R=t.onDayClick)===null||R===void 0||R.call(t,w,A,C);var V=!!(A.selected&&a&&(n==null?void 0:n.length)===a);if(!V){var U=!!(!A.selected&&l&&(n==null?void 0:n.length)===l);if(!U){var G=n?vre([],n):[];if(A.selected){var H=G.findIndex(function(J){return Dc(w,J)});G.splice(H,1)}else G.push(w);(z=t.onSelect)===null||z===void 0||z.call(t,G,w,A,C)}}},i={disabled:[]};n&&i.disabled.push(function(w){var A=l&&n.length>l-1,C=n.some(function(R){return Dc(R,w)});return!!(A&&!C)});var _={selected:n,onDayClick:h,modifiers:i};return f.jsx(f4.Provider,{value:_,children:r})}function p4(){var e=K.useContext(f4);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function LFe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Dc(a,e)&&Dc(n,e)?void 0:Dc(a,e)?{from:a,to:void 0}:Dc(n,e)?void 0:dD(n,e)?{from:e,to:a}:{from:n,to:e}:a?dD(e,a)?{from:a,to:e}:{from:e,to:a}:n?yre(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var m4=K.createContext(void 0);function zFe(e){if(!bS(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return f.jsx(m4.Provider,{value:t,children:e.children})}return f.jsx(FFe,{initialProps:e.initialProps,children:e.children})}function FFe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},l=a.from,h=a.to,i=t.min,_=t.max,w=function(z,V,U){var G,H;(G=t.onDayClick)===null||G===void 0||G.call(t,z,V,U);var J=LFe(z,n);(H=t.onSelect)===null||H===void 0||H.call(t,J,z,V,U)},A={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(A.range_start=[l],h?(A.range_end=[h],Dc(l,h)||(A.range_middle=[{after:l,before:h}])):A.range_end=[l]):h&&(A.range_start=[h],A.range_end=[h]),i&&(l&&!h&&A.disabled.push({after:Aj(l,i-1),before:ic(l,i-1)}),l&&h&&A.disabled.push({after:l,before:ic(l,i-1)}),!l&&h&&A.disabled.push({after:Aj(h,i-1),before:ic(h,i-1)})),_){if(l&&!h&&(A.disabled.push({before:ic(l,-_+1)}),A.disabled.push({after:ic(l,_-1)})),l&&h){var C=Lf(h,l)+1,R=_-C;A.disabled.push({before:Aj(l,R)}),A.disabled.push({after:ic(h,R)})}!l&&h&&(A.disabled.push({before:ic(h,-_+1)}),A.disabled.push({after:ic(h,_-1)}))}return f.jsx(m4.Provider,{value:{selected:n,onDayClick:w,modifiers:A},children:r})}function g4(){var e=K.useContext(m4);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function vA(e){return Array.isArray(e)?vre([],e):e!==void 0?[e]:[]}function BFe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=vA(a)}),t}var Bh;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Bh||(Bh={}));var VFe=Bh.Selected,Gp=Bh.Disabled,UFe=Bh.Hidden,$Fe=Bh.Today,Tj=Bh.RangeEnd,Pj=Bh.RangeMiddle,Ej=Bh.RangeStart,qFe=Bh.Outside;function GFe(e,t,r){var n,a=(n={},n[VFe]=vA(e.selected),n[Gp]=vA(e.disabled),n[UFe]=vA(e.hidden),n[$Fe]=[e.today],n[Tj]=[],n[Pj]=[],n[Ej]=[],n[qFe]=[],n);return e.fromDate&&a[Gp].push({before:e.fromDate}),e.toDate&&a[Gp].push({after:e.toDate}),xS(e)?a[Gp]=a[Gp].concat(t.modifiers[Gp]):bS(e)&&(a[Gp]=a[Gp].concat(r.modifiers[Gp]),a[Ej]=r.modifiers[Ej],a[Pj]=r.modifiers[Pj],a[Tj]=r.modifiers[Tj]),a}var Sre=K.createContext(void 0);function KFe(e){var t=Ja(),r=p4(),n=g4(),a=GFe(t,r,n),l=BFe(t.modifiers),h=ui(ui({},a),l);return f.jsx(Sre.Provider,{value:h,children:e.children})}function Are(){var e=K.useContext(Sre);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function WFe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function HFe(e){return!!(e&&typeof e=="object"&&"from"in e)}function ZFe(e){return!!(e&&typeof e=="object"&&"after"in e)}function YFe(e){return!!(e&&typeof e=="object"&&"before"in e)}function XFe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function JFe(e,t){var r,n=t.from,a=t.to;if(n&&a){var l=Lf(a,n)<0;l&&(r=[a,n],n=r[0],a=r[1]);var h=Lf(e,n)>=0&&Lf(a,e)>=0;return h}return a?Dc(a,e):n?Dc(n,e):!1}function QFe(e){return c4(e)}function e5e(e){return Array.isArray(e)&&e.every(c4)}function t5e(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(QFe(r))return Dc(e,r);if(e5e(r))return r.includes(e);if(HFe(r))return JFe(e,r);if(XFe(r))return r.dayOfWeek.includes(e.getDay());if(WFe(r)){var n=Lf(r.before,e),a=Lf(r.after,e),l=n>0,h=a<0,i=dD(r.before,r.after);return i?h&&l:l||h}return ZFe(r)?Lf(e,r.after)>0:YFe(r)?Lf(r.before,e)>0:typeof r=="function"?r(e):!1})}function y4(e,t,r){var n=Object.keys(t).reduce(function(l,h){var i=t[h];return t5e(e,i)&&l.push(h),l},[]),a={};return n.forEach(function(l){return a[l]=!0}),r&&!h4(e,r)&&(a.outside=!0),a}function r5e(e,t){for(var r=zc(e[0]),n=u4(e[e.length-1]),a,l,h=r;h<=n;){var i=y4(h,t),_=!i.disabled&&!i.hidden;if(!_){h=ic(h,1);continue}if(i.selected)return h;i.today&&!l&&(l=h),a||(a=h),h=ic(h,1)}return l||a}var n5e=365;function Tre(e,t){var r=t.moveBy,n=t.direction,a=t.context,l=t.modifiers,h=t.retry,i=h===void 0?{count:0,lastFocused:e}:h,_=a.weekStartsOn,w=a.fromDate,A=a.toDate,C=a.locale,R={day:ic,week:uD,month:Fh,year:G4e,startOfWeek:function(G){return a.ISOWeek?Dv(G):Yf(G,{locale:C,weekStartsOn:_})},endOfWeek:function(G){return a.ISOWeek?dre(G):d4(G,{locale:C,weekStartsOn:_})}},z=R[r](e,n==="after"?1:-1);n==="before"&&w?z=K4e([w,z]):n==="after"&&A&&(z=W4e([A,z]));var V=!0;if(l){var U=y4(z,l);V=!U.disabled&&!U.hidden}return V?z:i.count>n5e?i.lastFocused:Tre(z,{moveBy:r,direction:n,context:a,modifiers:l,retry:ui(ui({},i),{count:i.count+1})})}var Pre=K.createContext(void 0);function i5e(e){var t=wS(),r=Are(),n=K.useState(),a=n[0],l=n[1],h=K.useState(),i=h[0],_=h[1],w=r5e(t.displayMonths,r),A=a??(i&&t.isDateDisplayed(i))?i:w,C=function(){_(a),l(void 0)},R=function(G){l(G)},z=Ja(),V=function(G,H){if(a){var J=Tre(a,{moveBy:G,direction:H,context:z,modifiers:r});Dc(a,J)||(t.goToDate(J,a),R(J))}},U={focusedDay:a,focusTarget:A,blur:C,focus:R,focusDayAfter:function(){return V("day","after")},focusDayBefore:function(){return V("day","before")},focusWeekAfter:function(){return V("week","after")},focusWeekBefore:function(){return V("week","before")},focusMonthBefore:function(){return V("month","before")},focusMonthAfter:function(){return V("month","after")},focusYearBefore:function(){return V("year","before")},focusYearAfter:function(){return V("year","after")},focusStartOfWeek:function(){return V("startOfWeek","before")},focusEndOfWeek:function(){return V("endOfWeek","after")}};return f.jsx(Pre.Provider,{value:U,children:e.children})}function v4(){var e=K.useContext(Pre);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function a5e(e,t){var r=Are(),n=y4(e,r,t);return n}var _4=K.createContext(void 0);function o5e(e){if(!vE(e.initialProps)){var t={selected:void 0};return f.jsx(_4.Provider,{value:t,children:e.children})}return f.jsx(s5e,{initialProps:e.initialProps,children:e.children})}function s5e(e){var t=e.initialProps,r=e.children,n=function(l,h,i){var _,w,A;if((_=t.onDayClick)===null||_===void 0||_.call(t,l,h,i),h.selected&&!t.required){(w=t.onSelect)===null||w===void 0||w.call(t,void 0,l,h,i);return}(A=t.onSelect)===null||A===void 0||A.call(t,l,l,h,i)},a={selected:t.selected,onDayClick:n};return f.jsx(_4.Provider,{value:a,children:r})}function Ere(){var e=K.useContext(_4);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function l5e(e,t){var r=Ja(),n=Ere(),a=p4(),l=g4(),h=v4(),i=h.focusDayAfter,_=h.focusDayBefore,w=h.focusWeekAfter,A=h.focusWeekBefore,C=h.blur,R=h.focus,z=h.focusMonthBefore,V=h.focusMonthAfter,U=h.focusYearBefore,G=h.focusYearAfter,H=h.focusStartOfWeek,J=h.focusEndOfWeek,Q=function(Ye){var $e,We,Et,Je;vE(r)?($e=n.onDayClick)===null||$e===void 0||$e.call(n,e,t,Ye):xS(r)?(We=a.onDayClick)===null||We===void 0||We.call(a,e,t,Ye):bS(r)?(Et=l.onDayClick)===null||Et===void 0||Et.call(l,e,t,Ye):(Je=r.onDayClick)===null||Je===void 0||Je.call(r,e,t,Ye)},le=function(Ye){var $e;R(e),($e=r.onDayFocus)===null||$e===void 0||$e.call(r,e,t,Ye)},ne=function(Ye){var $e;C(),($e=r.onDayBlur)===null||$e===void 0||$e.call(r,e,t,Ye)},de=function(Ye){var $e;($e=r.onDayMouseEnter)===null||$e===void 0||$e.call(r,e,t,Ye)},ue=function(Ye){var $e;($e=r.onDayMouseLeave)===null||$e===void 0||$e.call(r,e,t,Ye)},ve=function(Ye){var $e;($e=r.onDayPointerEnter)===null||$e===void 0||$e.call(r,e,t,Ye)},Ae=function(Ye){var $e;($e=r.onDayPointerLeave)===null||$e===void 0||$e.call(r,e,t,Ye)},Oe=function(Ye){var $e;($e=r.onDayTouchCancel)===null||$e===void 0||$e.call(r,e,t,Ye)},Se=function(Ye){var $e;($e=r.onDayTouchEnd)===null||$e===void 0||$e.call(r,e,t,Ye)},ke=function(Ye){var $e;($e=r.onDayTouchMove)===null||$e===void 0||$e.call(r,e,t,Ye)},ze=function(Ye){var $e;($e=r.onDayTouchStart)===null||$e===void 0||$e.call(r,e,t,Ye)},et=function(Ye){var $e;($e=r.onDayKeyUp)===null||$e===void 0||$e.call(r,e,t,Ye)},je=function(Ye){var $e;switch(Ye.key){case"ArrowLeft":Ye.preventDefault(),Ye.stopPropagation(),r.dir==="rtl"?i():_();break;case"ArrowRight":Ye.preventDefault(),Ye.stopPropagation(),r.dir==="rtl"?_():i();break;case"ArrowDown":Ye.preventDefault(),Ye.stopPropagation(),w();break;case"ArrowUp":Ye.preventDefault(),Ye.stopPropagation(),A();break;case"PageUp":Ye.preventDefault(),Ye.stopPropagation(),Ye.shiftKey?U():z();break;case"PageDown":Ye.preventDefault(),Ye.stopPropagation(),Ye.shiftKey?G():V();break;case"Home":Ye.preventDefault(),Ye.stopPropagation(),H();break;case"End":Ye.preventDefault(),Ye.stopPropagation(),J();break}($e=r.onDayKeyDown)===null||$e===void 0||$e.call(r,e,t,Ye)},Ne={onClick:Q,onFocus:le,onBlur:ne,onKeyDown:je,onKeyUp:et,onMouseEnter:de,onMouseLeave:ue,onPointerEnter:ve,onPointerLeave:Ae,onTouchCancel:Oe,onTouchEnd:Se,onTouchMove:ke,onTouchStart:ze};return Ne}function c5e(){var e=Ja(),t=Ere(),r=p4(),n=g4(),a=vE(e)?t.selected:xS(e)?r.selected:bS(e)?n.selected:void 0;return a}function u5e(e){return Object.values(Bh).includes(e)}function d5e(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(u5e(n)){var l=e.classNames["day_".concat(n)];l&&r.push(l)}}),r}function h5e(e,t){var r=ui({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=ui(ui({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function f5e(e,t,r){var n,a,l,h=Ja(),i=v4(),_=a5e(e,t),w=l5e(e,_),A=c5e(),C=!!(h.onDayClick||h.mode!=="default");K.useEffect(function(){var de;_.outside||i.focusedDay&&C&&Dc(i.focusedDay,e)&&((de=r.current)===null||de===void 0||de.focus())},[i.focusedDay,e,r,C,_.outside]);var R=d5e(h,_).join(" "),z=h5e(h,_),V=!!(_.outside&&!h.showOutsideDays||_.hidden),U=(l=(a=h.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:NFe,G=f.jsx(U,{date:e,displayMonth:t,activeModifiers:_}),H={style:z,className:R,children:G,role:"gridcell"},J=i.focusTarget&&Dc(i.focusTarget,e)&&!_.outside,Q=i.focusedDay&&Dc(i.focusedDay,e),le=ui(ui(ui({},H),(n={disabled:_.disabled,role:"gridcell"},n["aria-selected"]=_.selected,n.tabIndex=Q||J?0:-1,n)),w),ne={isButton:C,isHidden:V,activeModifiers:_,selectedDays:A,buttonProps:le,divProps:H};return ne}function p5e(e){var t=K.useRef(null),r=f5e(e.date,e.displayMonth,t);return r.isHidden?f.jsx("div",{role:"gridcell"}):r.isButton?f.jsx(aP,ui({name:"day",ref:t},r.buttonProps)):f.jsx("div",ui({},r.divProps))}function m5e(e){var t=e.number,r=e.dates,n=Ja(),a=n.onWeekNumberClick,l=n.styles,h=n.classNames,i=n.locale,_=n.labels.labelWeekNumber,w=n.formatters.formatWeekNumber,A=w(Number(t),{locale:i});if(!a)return f.jsx("span",{className:h.weeknumber,style:l.weeknumber,children:A});var C=_(Number(t),{locale:i}),R=function(z){a(t,r,z)};return f.jsx(aP,{name:"week-number","aria-label":C,className:h.weeknumber,style:l.weeknumber,onClick:R,children:A})}function g5e(e){var t,r,n=Ja(),a=n.styles,l=n.classNames,h=n.showWeekNumber,i=n.components,_=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:p5e,w=(r=i==null?void 0:i.WeekNumber)!==null&&r!==void 0?r:m5e,A;return h&&(A=f.jsx("td",{className:l.cell,style:a.cell,children:f.jsx(w,{number:e.weekNumber,dates:e.dates})})),f.jsxs("tr",{className:l.row,style:a.row,children:[A,e.dates.map(function(C){return f.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:f.jsx(_,{displayMonth:e.displayMonth,date:C})},Kze(C))})]})}function rK(e,t,r){for(var n=r!=null&&r.ISOWeek?dre(t):d4(t,r),a=r!=null&&r.ISOWeek?Dv(e):Yf(e,r),l=Lf(n,a),h=[],i=0;i<=l;i++)h.push(ic(a,i));var _=h.reduce(function(w,A){var C=r!=null&&r.ISOWeek?fre(A):mre(A,r),R=w.find(function(z){return z.weekNumber===C});return R?(R.dates.push(A),w):(w.push({weekNumber:C,dates:[A]}),w)},[]);return _}function y5e(e,t){var r=rK(zc(e),u4(e),t);if(t!=null&&t.useFixedWeeks){var n=Hze(e,t);if(n<6){var a=r[r.length-1],l=a.dates[a.dates.length-1],h=uD(l,6-n),i=rK(uD(l,1),h,t);r.push.apply(r,i)}}return r}function v5e(e){var t,r,n,a=Ja(),l=a.locale,h=a.classNames,i=a.styles,_=a.hideHead,w=a.fixedWeeks,A=a.components,C=a.weekStartsOn,R=a.firstWeekContainsDate,z=a.ISOWeek,V=y5e(e.displayMonth,{useFixedWeeks:!!w,ISOWeek:z,locale:l,weekStartsOn:C,firstWeekContainsDate:R}),U=(t=A==null?void 0:A.Head)!==null&&t!==void 0?t:jFe,G=(r=A==null?void 0:A.Row)!==null&&r!==void 0?r:g5e,H=(n=A==null?void 0:A.Footer)!==null&&n!==void 0?n:OFe;return f.jsxs("table",{id:e.id,className:h.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!_&&f.jsx(U,{}),f.jsx("tbody",{className:h.tbody,style:i.tbody,children:V.map(function(J){return f.jsx(G,{displayMonth:e.displayMonth,dates:J.dates,weekNumber:J.weekNumber},J.weekNumber)})}),f.jsx(H,{displayMonth:e.displayMonth})]})}function _5e(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var x5e=_5e()?K.useLayoutEffect:K.useEffect,Cj=!1,b5e=0;function nK(){return"react-day-picker-".concat(++b5e)}function w5e(e){var t,r=e??(Cj?nK():null),n=K.useState(r),a=n[0],l=n[1];return x5e(function(){a===null&&l(nK())},[]),K.useEffect(function(){Cj===!1&&(Cj=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function S5e(e){var t,r,n=Ja(),a=n.dir,l=n.classNames,h=n.styles,i=n.components,_=wS().displayMonths,w=w5e(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),A=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,C=[l.month],R=h.month,z=e.displayIndex===0,V=e.displayIndex===_.length-1,U=!z&&!V;a==="rtl"&&(t=[z,V],V=t[0],z=t[1]),z&&(C.push(l.caption_start),R=ui(ui({},R),h.caption_start)),V&&(C.push(l.caption_end),R=ui(ui({},R),h.caption_end)),U&&(C.push(l.caption_between),R=ui(ui({},R),h.caption_between));var G=(r=i==null?void 0:i.Caption)!==null&&r!==void 0?r:MFe;return f.jsxs("div",{className:C.join(" "),style:R,children:[f.jsx(G,{id:w,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),f.jsx(v5e,{id:A,"aria-labelledby":w,displayMonth:e.displayMonth})]},e.displayIndex)}function A5e(e){var t=Ja(),r=t.classNames,n=t.styles;return f.jsx("div",{className:r.months,style:n.months,children:e.children})}function T5e(e){var t,r,n=e.initialProps,a=Ja(),l=v4(),h=wS(),i=K.useState(!1),_=i[0],w=i[1];K.useEffect(function(){a.initialFocus&&l.focusTarget&&(_||(l.focus(l.focusTarget),w(!0)))},[a.initialFocus,_,l.focus,l.focusTarget,l]);var A=[a.classNames.root,a.className];a.numberOfMonths>1&&A.push(a.classNames.multiple_months),a.showWeekNumber&&A.push(a.classNames.with_weeknumber);var C=ui(ui({},a.styles.root),a.style),R=Object.keys(n).filter(function(V){return V.startsWith("data-")}).reduce(function(V,U){var G;return ui(ui({},V),(G={},G[U]=n[U],G))},{}),z=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:A5e;return f.jsx("div",ui({className:A.join(" "),style:C,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},R,{children:f.jsx(z,{children:h.displayMonths.map(function(V,U){return f.jsx(S5e,{displayIndex:U,displayMonth:V},U)})})}))}function P5e(e){var t=e.children,r=Yze(e,["children"]);return f.jsx(mFe,{initialProps:r,children:f.jsx(TFe,{children:f.jsx(o5e,{initialProps:r,children:f.jsx(IFe,{initialProps:r,children:f.jsx(zFe,{initialProps:r,children:f.jsx(KFe,{children:f.jsx(i5e,{children:t})})})})})})})}function E5e(e){return f.jsx(P5e,ui({},e,{children:f.jsx(T5e,{initialProps:e})}))}function zw({className:e,classNames:t,showOutsideDays:r=!0,...n}){return f.jsx(E5e,{showOutsideDays:r,className:Gt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-start pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Gt(w1({variant:"outline"}),"h-7 w-7 bg-transparent hidden p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:Gt("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:Gt(w1({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:a,...l})=>f.jsx(qK,{className:Gt("h-4 w-4",a),...l}),IconRight:({className:a,...l})=>f.jsx(vx,{className:Gt("h-4 w-4",a),...l})},...n})}zw.displayName="Calendar";function C5e(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var M5e=["color"],SS=K.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=C5e(e,M5e);return K.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a,{ref:t}),K.createElement("path",{d:"M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z",fill:n,fillRule:"evenodd",clipRule:"evenodd"}))}),x4="Avatar",[O5e,Z6e]=Md(x4),[R5e,Cre]=O5e(x4),Mre=K.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[a,l]=K.useState("idle");return f.jsx(R5e,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:f.jsx(mi.span,{...n,ref:t})})});Mre.displayName=x4;var Ore="AvatarImage",Rre=K.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...l}=e,h=Cre(Ore,r),i=k5e(n,l.referrerPolicy),_=Eu(w=>{a(w),h.onImageLoadingStatusChange(w)});return rl(()=>{i!=="idle"&&_(i)},[i,_]),i==="loaded"?f.jsx(mi.img,{...l,ref:t,src:n}):null});Rre.displayName=Ore;var kre="AvatarFallback",jre=K.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=e,l=Cre(kre,r),[h,i]=K.useState(n===void 0);return K.useEffect(()=>{if(n!==void 0){const _=window.setTimeout(()=>i(!0),n);return()=>window.clearTimeout(_)}},[n]),h&&l.imageLoadingStatus!=="loaded"?f.jsx(mi.span,{...a,ref:t}):null});jre.displayName=kre;function k5e(e,t){const[r,n]=K.useState("idle");return rl(()=>{if(!e){n("error");return}let a=!0;const l=new window.Image,h=i=>()=>{a&&n(i)};return n("loading"),l.onload=h("loaded"),l.onerror=h("error"),l.src=e,t&&(l.referrerPolicy=t),()=>{a=!1}},[e,t]),r}var Nre=Mre,Ire=Rre,Dre=jre;const fD=K.forwardRef(({className:e,...t},r)=>f.jsx(Nre,{ref:r,className:Gt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));fD.displayName=Nre.displayName;const pD=K.forwardRef(({className:e,...t},r)=>f.jsx(Ire,{ref:r,className:Gt("aspect-square h-full w-full",e),...t}));pD.displayName=Ire.displayName;const mD=K.forwardRef(({className:e,...t},r)=>f.jsx(Dre,{ref:r,className:Gt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));mD.displayName=Dre.displayName;function b4({column:e,title:t,className:r}){return e.getCanSort()?f.jsx("div",{className:Gt("flex items-center space-x-2",r),children:f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[f.jsx("span",{children:t}),e.getIsSorted()==="desc"?f.jsx(yB,{}):e.getIsSorted()==="asc"?f.jsx(vB,{}):f.jsx(GK,{})]})}),f.jsxs(Fc,{align:"start",children:[f.jsxs(Ea,{onClick:()=>e.toggleSorting(!1),children:[f.jsx(vB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),f.jsxs(Ea,{onClick:()=>e.toggleSorting(!0),children:[f.jsx(yB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:()=>e.toggleVisibility(!1),children:[f.jsx(WK,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):f.jsx("div",{className:Gt(r),children:t})}const j5e=u0("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ac({className:e,variant:t,...r}){return f.jsx("div",{className:Gt(j5e({variant:t}),e),...r})}const N5e=(e,t,r)=>[{accessorKey:"accident_id",header:"Accident ID",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("accident_id")})},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("plateNo")})},{accessorKey:"accident_date",header:"Date",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("accident_date")})},{accessorKey:"street",header:"Street",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("street")})},{accessorKey:"barangay",header:"Barangay",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("barangay")})},{accessorKey:"municipality",header:"Municipality",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("municipality")})},{accessorKey:"vehicle_type",header:"Vehicle Type",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("vehicle_type")})},{accessorKey:"severity",header:"Severity",cell:({row:n})=>{const a=n.getValue("severity"),l={minor:"text-green-600 bg-green-100",moderate:"text-yellow-600 bg-yellow-100",severe:"text-orange-600 bg-orange-100",fatal:"text-red-600 bg-red-100"};return f.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium inline-block ${l[a]||"text-gray-600 bg-gray-100"}`,children:a})}},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,l=h=>{h.stopPropagation(),e(a._id)};return f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[f.jsx("span",{className:"sr-only",children:"Open menu"}),f.jsx(SS,{className:"h-4 w-4"})]})}),f.jsxs(Fc,{align:"end",children:[f.jsx(Gg,{children:"Actions"}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:l,children:["Edit",f.jsx(Nc,{})]})]})]})}}],I5e=e=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:t})=>f.jsx("div",{className:"",children:t.getValue("plateNo")})},{accessorKey:"ownerRepresentativeName",header:({column:t})=>f.jsx(b4,{column:t,title:"Owner/Representative Name"}),cell:({row:t})=>f.jsx("div",{className:"",children:t.getValue("ownerRepresentativeName")})},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:t})=>{const r=t.getValue("hasDriversLicense"),n=t.original.driversLicenseNumber;return f.jsx("div",{className:"",children:r?f.jsxs("div",{children:[f.jsx("div",{className:"font-semibold text-green-600",children:"Yes"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground",children:n})]}):f.jsx("div",{className:"font-semibold text-red-600",children:"No"})})}},{accessorKey:"birthDate",header:"Birthday",cell:({row:t})=>{const r=t.getValue("birthDate");return f.jsx("div",{className:"",children:r?new Date(r).toLocaleDateString():"None"})}},{accessorKey:"contactNumber",header:"Contact Number",cell:({row:t})=>{const r=t.getValue("contactNumber");return f.jsx("div",{className:"",children:r||"None"})}},{accessorKey:"emailAddress",header:"Email Address",cell:({row:t})=>{const r=t.getValue("emailAddress");return f.jsx("div",{className:"",children:r||"None"})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const r=t.original,n=a=>{a.stopPropagation(),e(r._id)};return f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[f.jsx("span",{className:"sr-only",children:"Open menu"}),f.jsx(SS,{className:"h-4 w-4"})]})}),f.jsxs(Fc,{align:"end",children:[f.jsx(Gg,{children:"Actions"}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:n,children:["Activate",f.jsx(Bv,{})]})]})]})}}],D5e=(e,t)=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:r})=>{const n=r.getValue("plateNo"),a=Array.isArray(n)?n:[n];return f.jsx("div",{className:"",children:a.join(", ")})}},{accessorKey:"ownerRepresentativeName",header:({column:r})=>f.jsx(b4,{column:r,title:"Owner/Representative Name"}),cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("ownerRepresentativeName")})},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:r})=>{const n=r.getValue("hasDriversLicense"),a=r.original.driversLicenseNumber;return f.jsx("div",{className:"",children:n?f.jsxs("div",{children:[f.jsx("div",{className:"font-semibold text-green-600",children:"Yes"}),a&&f.jsx("div",{className:"text-xs text-muted-foreground",children:a})]}):f.jsx("div",{className:"font-semibold text-red-600",children:"No"})})}},{accessorKey:"birthDate",header:"Birthday",cell:({row:r})=>{const n=r.getValue("birthDate");if(!n)return f.jsx("div",{className:"",children:"None"});const a=new Date(n);return isNaN(a.getTime())?f.jsx("div",{className:"",children:"Invalid Date"}):f.jsx("div",{className:"",children:a.toLocaleDateString()})}},{accessorKey:"contactNumber",header:"Contact Number",cell:({row:r})=>{const n=r.getValue("contactNumber");return f.jsx("div",{className:"",children:n||"None"})}},{accessorKey:"emailAddress",header:"Email Address",cell:({row:r})=>{const n=r.getValue("emailAddress");return f.jsx("div",{className:"",children:n||"None"})}},{id:"actions",enableHiding:!1,cell:({row:r})=>{const n=r.original,a=h=>{h.stopPropagation(),e(n._id)},l=h=>{h.stopPropagation(),t(n._id)};return f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[f.jsx("span",{className:"sr-only",children:"Open menu"}),f.jsx(SS,{className:"h-4 w-4"})]})}),f.jsxs(Fc,{className:"text-xs",align:"end",children:[f.jsx(Gg,{children:"Actions"}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:a,children:["Edit ",f.jsx(Nc,{})]}),f.jsxs(Ea,{onClick:l,children:["Deactivate",f.jsx(FD,{})]})]})]})}}],L5e=(e,t,r)=>[{accessorKey:"topNo",header:"TOP NO.",cell:({row:n})=>f.jsx("div",{className:"font-medium",children:n.getValue("topNo")})},{accessorKey:"firstName",header:"Full Name",cell:({row:n})=>{const a=n.getValue("firstName"),l=n.original.middleInitial,h=n.original.lastName,i=n.original.suffix;if((a==="None"||!a)&&(l==="None"||!l)&&(h==="None"||!h)&&(i==="None"||!i))return f.jsx("div",{className:"",children:"None"});const _=[a];return l&&l!=="None"&&_.push(l),h&&h!=="None"&&_.push(h),i&&i!=="None"&&_.push(i),f.jsx("div",{className:"",children:_.join(" ")})}},{accessorKey:"violations",header:"Violations",cell:({row:n})=>{const a=n.getValue("violations");return f.jsx("div",{className:"max-w-xs",children:a&&a.length>0&&a[0]!=="None"?Array.isArray(a)?a.join(", "):a:"None"})}},{accessorKey:"violationType",header:"Type",cell:({row:n})=>{const a=n.getValue("violationType"),l=i=>{switch(i){case"confiscated":return"Confiscated";case"alarm":return"Alarm";case"impounded":return"Impounded";default:return"Unknown"}},h=i=>{switch(i){case"confiscated":return"bg-blue-100 text-blue-800";case"alarm":return"bg-red-100 text-red-800";case"impounded":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h(a)}`,children:l(a)})}},{accessorKey:"licenseType",header:"License Type",cell:({row:n})=>{const a=n.getValue("licenseType");return f.jsx("div",{className:"",children:a&&a!=="None"&&a!=="N/A"?a:"N/A"})}},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("plateNo")})},{accessorKey:"dateOfApprehension",header:({column:n})=>f.jsx(b4,{column:n,title:"Date of Apprehension"}),cell:({row:n})=>{const a=n.getValue("dateOfApprehension");return f.jsx("div",{className:"",children:a?new Date(a).toLocaleDateString():"None"})}},{accessorKey:"apprehendingOfficer",header:"Officer",cell:({row:n})=>f.jsx("div",{className:"",children:n.getValue("apprehendingOfficer")||"None"})},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,l=h=>{h.stopPropagation(),e(a._id)};return f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[f.jsx("span",{className:"sr-only",children:"Open menu"}),f.jsx(SS,{className:"h-4 w-4"})]})}),f.jsxs(Fc,{align:"end",children:[f.jsx(Gg,{children:"Actions"}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:l,children:["Edit",f.jsx(Nc,{})]})]})]})}}],z5e=()=>[{accessorKey:"id",header:"Log ID",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("id")})},{accessorKey:"type",header:"Type ",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("type")})},{accessorKey:"message",header:"Message ",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("message")})},{accessorKey:"timestamp",header:"Timestamp",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("timestamp")})}],F5e=()=>[{accessorKey:"id",header:"Log ID",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("id")})},{accessorKey:"fullname",header:"Driver",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("fullname")})},{accessorKey:"type",header:"Type ",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("type")})},{accessorKey:"createdAt",header:"Timestamp",cell:({row:e})=>f.jsx("div",{className:"",children:e.getValue("createdAt")})}],B5e=(e,t)=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("plateNo")})},{accessorKey:"fileNo",header:"File No.",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("fileNo")})},{accessorKey:"engineNo",header:"Engine No.",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("engineNo")})},{accessorKey:"chassisNo",header:"Chassis No.",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("chassisNo")})},{accessorKey:"make",header:"Make",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("make")})},{accessorKey:"bodyType",header:"Body Type",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("bodyType")})},{accessorKey:"color",header:"Color",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("color")})},{accessorKey:"classification",header:"Classification",cell:({row:r})=>f.jsx("div",{className:"",children:r.getValue("classification")})},{accessorKey:"dateOfRenewal",header:"Date of Renewal",cell:({row:r})=>{const n=r.getValue("dateOfRenewal");return f.jsx("div",{className:"",children:n?new Date(n).toLocaleDateString():"Not set"})}},{accessorKey:"status",header:"Status",cell:({row:r})=>{const n=r.original.status,a=r.original.expirationInfo,l=n==="1"||n===1;return f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-sm",children:[l?f.jsx(mue,{className:"h-4 w-4 text-green-600"}):f.jsx(fue,{className:"h-4 w-4 text-red-600"}),f.jsx("span",{className:`text-sm font-medium ${l?"text-green-700":"text-red-700"}`,children:l?"Active":"Expired"})]}),a&&f.jsxs("div",{className:"text-xs text-muted-foreground px-2",children:[f.jsxs("div",{children:["Last 2 digits: ",a.lastTwoDigits]}),f.jsxs("div",{children:[a.week," week of ",a.month]}),a.expirationDate&&f.jsxs("div",{children:["Expires: ",new Date(a.expirationDate).toLocaleDateString()]})]})]})}},{id:"actions",enableHiding:!1,cell:({row:r})=>{const n=r.original,a=l=>{l.stopPropagation(),e(n._id)};return f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",className:"h-5 w-5 p-0",children:[f.jsx("span",{className:"sr-only",children:"Open menu"}),f.jsx(SS,{className:"h-4 w-4"})]})}),f.jsxs(Fc,{align:"end",children:[f.jsx(Gg,{children:"Actions"}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:a,children:["Edit",f.jsx(Nc,{})]})]})]})}}];/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Mg(e,t){return typeof e=="function"?e(t):e}function Ou(e,t){return r=>{t.setState(n=>({...n,[e]:Mg(r,n[e])}))}}function _E(e){return e instanceof Function}function V5e(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function U5e(e,t){const r=[],n=a=>{a.forEach(l=>{r.push(l);const h=t(l);h!=null&&h.length&&n(h)})};return n(e),r}function ni(e,t,r){let n=[],a;return l=>{let h;r.key&&r.debug&&(h=Date.now());const i=e(l);if(!(i.length!==n.length||i.some((A,C)=>n[C]!==A)))return a;n=i;let w;if(r.key&&r.debug&&(w=Date.now()),a=t(...i),r==null||r.onChange==null||r.onChange(a),r.key&&r.debug&&r!=null&&r.debug()){const A=Math.round((Date.now()-h)*100)/100,C=Math.round((Date.now()-w)*100)/100,R=C/16,z=(V,U)=>{for(V=String(V);V.length<U;)V=" "+V;return V};console.info(`%c ${z(C,5)} /${z(A,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*R,120))}deg 100% 31%);`,r==null?void 0:r.key)}return a}}function ii(e,t,r,n){return{debug:()=>{var a;return(a=e==null?void 0:e.debugAll)!=null?a:e[t]},key:!1,onChange:n}}function $5e(e,t,r,n){const a=()=>{var h;return(h=l.getValue())!=null?h:e.options.renderFallbackValue},l={id:`${t.id}_${r.id}`,row:t,column:r,getValue:()=>t.getValue(n),renderValue:a,getContext:ni(()=>[e,r,t,l],(h,i,_,w)=>({table:h,column:i,row:_,cell:w,getValue:w.getValue,renderValue:w.renderValue}),ii(e.options,"debugCells"))};return e._features.forEach(h=>{h.createCell==null||h.createCell(l,r,t,e)},{}),l}function q5e(e,t,r,n){var a,l;const i={...e._getDefaultColumnDef(),...t},_=i.accessorKey;let w=(a=(l=i.id)!=null?l:_?typeof String.prototype.replaceAll=="function"?_.replaceAll(".","_"):_.replace(/\./g,"_"):void 0)!=null?a:typeof i.header=="string"?i.header:void 0,A;if(i.accessorFn?A=i.accessorFn:_&&(_.includes(".")?A=R=>{let z=R;for(const U of _.split(".")){var V;z=(V=z)==null?void 0:V[U]}return z}:A=R=>R[i.accessorKey]),!w)throw new Error;let C={id:`${String(w)}`,accessorFn:A,parent:n,depth:r,columnDef:i,columns:[],getFlatColumns:ni(()=>[!0],()=>{var R;return[C,...(R=C.columns)==null?void 0:R.flatMap(z=>z.getFlatColumns())]},ii(e.options,"debugColumns")),getLeafColumns:ni(()=>[e._getOrderColumnsFn()],R=>{var z;if((z=C.columns)!=null&&z.length){let V=C.columns.flatMap(U=>U.getLeafColumns());return R(V)}return[C]},ii(e.options,"debugColumns"))};for(const R of e._features)R.createColumn==null||R.createColumn(C,e);return C}const Nl="debugHeaders";function iK(e,t,r){var n;let l={id:(n=r.id)!=null?n:t.id,column:t,index:r.index,isPlaceholder:!!r.isPlaceholder,placeholderId:r.placeholderId,depth:r.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const h=[],i=_=>{_.subHeaders&&_.subHeaders.length&&_.subHeaders.map(i),h.push(_)};return i(l),h},getContext:()=>({table:e,header:l,column:t})};return e._features.forEach(h=>{h.createHeader==null||h.createHeader(l,e)}),l}const G5e={createTable:e=>{e.getHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>{var l,h;const i=(l=n==null?void 0:n.map(C=>r.find(R=>R.id===C)).filter(Boolean))!=null?l:[],_=(h=a==null?void 0:a.map(C=>r.find(R=>R.id===C)).filter(Boolean))!=null?h:[],w=r.filter(C=>!(n!=null&&n.includes(C.id))&&!(a!=null&&a.includes(C.id)));return X2(t,[...i,...w,..._],e)},ii(e.options,Nl)),e.getCenterHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>(r=r.filter(l=>!(n!=null&&n.includes(l.id))&&!(a!=null&&a.includes(l.id))),X2(t,r,e,"center")),ii(e.options,Nl)),e.getLeftHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,r,n)=>{var a;const l=(a=n==null?void 0:n.map(h=>r.find(i=>i.id===h)).filter(Boolean))!=null?a:[];return X2(t,l,e,"left")},ii(e.options,Nl)),e.getRightHeaderGroups=ni(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,r,n)=>{var a;const l=(a=n==null?void 0:n.map(h=>r.find(i=>i.id===h)).filter(Boolean))!=null?a:[];return X2(t,l,e,"right")},ii(e.options,Nl)),e.getFooterGroups=ni(()=>[e.getHeaderGroups()],t=>[...t].reverse(),ii(e.options,Nl)),e.getLeftFooterGroups=ni(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),ii(e.options,Nl)),e.getCenterFooterGroups=ni(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),ii(e.options,Nl)),e.getRightFooterGroups=ni(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),ii(e.options,Nl)),e.getFlatHeaders=ni(()=>[e.getHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Nl)),e.getLeftFlatHeaders=ni(()=>[e.getLeftHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Nl)),e.getCenterFlatHeaders=ni(()=>[e.getCenterHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Nl)),e.getRightFlatHeaders=ni(()=>[e.getRightHeaderGroups()],t=>t.map(r=>r.headers).flat(),ii(e.options,Nl)),e.getCenterLeafHeaders=ni(()=>[e.getCenterFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ii(e.options,Nl)),e.getLeftLeafHeaders=ni(()=>[e.getLeftFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ii(e.options,Nl)),e.getRightLeafHeaders=ni(()=>[e.getRightFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ii(e.options,Nl)),e.getLeafHeaders=ni(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,r,n)=>{var a,l,h,i,_,w;return[...(a=(l=t[0])==null?void 0:l.headers)!=null?a:[],...(h=(i=r[0])==null?void 0:i.headers)!=null?h:[],...(_=(w=n[0])==null?void 0:w.headers)!=null?_:[]].map(A=>A.getLeafHeaders()).flat()},ii(e.options,Nl))}};function X2(e,t,r,n){var a,l;let h=0;const i=function(R,z){z===void 0&&(z=1),h=Math.max(h,z),R.filter(V=>V.getIsVisible()).forEach(V=>{var U;(U=V.columns)!=null&&U.length&&i(V.columns,z+1)},0)};i(e);let _=[];const w=(R,z)=>{const V={depth:z,id:[n,`${z}`].filter(Boolean).join("_"),headers:[]},U=[];R.forEach(G=>{const H=[...U].reverse()[0],J=G.column.depth===V.depth;let Q,le=!1;if(J&&G.column.parent?Q=G.column.parent:(Q=G.column,le=!0),H&&(H==null?void 0:H.column)===Q)H.subHeaders.push(G);else{const ne=iK(r,Q,{id:[n,z,Q.id,G==null?void 0:G.id].filter(Boolean).join("_"),isPlaceholder:le,placeholderId:le?`${U.filter(de=>de.column===Q).length}`:void 0,depth:z,index:U.length});ne.subHeaders.push(G),U.push(ne)}V.headers.push(G),G.headerGroup=V}),_.push(V),z>0&&w(U,z-1)},A=t.map((R,z)=>iK(r,R,{depth:h,index:z}));w(A,h-1),_.reverse();const C=R=>R.filter(V=>V.column.getIsVisible()).map(V=>{let U=0,G=0,H=[0];V.subHeaders&&V.subHeaders.length?(H=[],C(V.subHeaders).forEach(Q=>{let{colSpan:le,rowSpan:ne}=Q;U+=le,H.push(ne)})):U=1;const J=Math.min(...H);return G=G+J,V.colSpan=U,V.rowSpan=G,{colSpan:U,rowSpan:G}});return C((a=(l=_[0])==null?void 0:l.headers)!=null?a:[]),_}const w4=(e,t,r,n,a,l,h)=>{let i={id:t,index:n,original:r,depth:a,parentId:h,_valuesCache:{},_uniqueValuesCache:{},getValue:_=>{if(i._valuesCache.hasOwnProperty(_))return i._valuesCache[_];const w=e.getColumn(_);if(w!=null&&w.accessorFn)return i._valuesCache[_]=w.accessorFn(i.original,n),i._valuesCache[_]},getUniqueValues:_=>{if(i._uniqueValuesCache.hasOwnProperty(_))return i._uniqueValuesCache[_];const w=e.getColumn(_);if(w!=null&&w.accessorFn)return w.columnDef.getUniqueValues?(i._uniqueValuesCache[_]=w.columnDef.getUniqueValues(i.original,n),i._uniqueValuesCache[_]):(i._uniqueValuesCache[_]=[i.getValue(_)],i._uniqueValuesCache[_])},renderValue:_=>{var w;return(w=i.getValue(_))!=null?w:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>U5e(i.subRows,_=>_.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let _=[],w=i;for(;;){const A=w.getParentRow();if(!A)break;_.push(A),w=A}return _.reverse()},getAllCells:ni(()=>[e.getAllLeafColumns()],_=>_.map(w=>$5e(e,i,w,w.id)),ii(e.options,"debugRows")),_getAllCellsByColumnId:ni(()=>[i.getAllCells()],_=>_.reduce((w,A)=>(w[A.column.id]=A,w),{}),ii(e.options,"debugRows"))};for(let _=0;_<e._features.length;_++){const w=e._features[_];w==null||w.createRow==null||w.createRow(i,e)}return i},K5e={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},Lre=(e,t,r)=>{var n,a;const l=r==null||(n=r.toString())==null?void 0:n.toLowerCase();return!!(!((a=e.getValue(t))==null||(a=a.toString())==null||(a=a.toLowerCase())==null)&&a.includes(l))};Lre.autoRemove=e=>jh(e);const zre=(e,t,r)=>{var n;return!!(!((n=e.getValue(t))==null||(n=n.toString())==null)&&n.includes(r))};zre.autoRemove=e=>jh(e);const Fre=(e,t,r)=>{var n;return((n=e.getValue(t))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(r==null?void 0:r.toLowerCase())};Fre.autoRemove=e=>jh(e);const Bre=(e,t,r)=>{var n;return(n=e.getValue(t))==null?void 0:n.includes(r)};Bre.autoRemove=e=>jh(e);const Vre=(e,t,r)=>!r.some(n=>{var a;return!((a=e.getValue(t))!=null&&a.includes(n))});Vre.autoRemove=e=>jh(e)||!(e!=null&&e.length);const Ure=(e,t,r)=>r.some(n=>{var a;return(a=e.getValue(t))==null?void 0:a.includes(n)});Ure.autoRemove=e=>jh(e)||!(e!=null&&e.length);const $re=(e,t,r)=>e.getValue(t)===r;$re.autoRemove=e=>jh(e);const qre=(e,t,r)=>e.getValue(t)==r;qre.autoRemove=e=>jh(e);const S4=(e,t,r)=>{let[n,a]=r;const l=e.getValue(t);return l>=n&&l<=a};S4.resolveFilterValue=e=>{let[t,r]=e,n=typeof t!="number"?parseFloat(t):t,a=typeof r!="number"?parseFloat(r):r,l=t===null||Number.isNaN(n)?-1/0:n,h=r===null||Number.isNaN(a)?1/0:a;if(l>h){const i=l;l=h,h=i}return[l,h]};S4.autoRemove=e=>jh(e)||jh(e[0])&&jh(e[1]);const Yp={includesString:Lre,includesStringSensitive:zre,equalsString:Fre,arrIncludes:Bre,arrIncludesAll:Vre,arrIncludesSome:Ure,equals:$re,weakEquals:qre,inNumberRange:S4};function jh(e){return e==null||e===""}const W5e={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Ou("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);return typeof n=="string"?Yp.includesString:typeof n=="number"?Yp.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?Yp.equals:Array.isArray(n)?Yp.arrIncludes:Yp.weakEquals},e.getFilterFn=()=>{var r,n;return _E(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(r=(n=t.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?r:Yp[e.columnDef.filterFn]},e.getCanFilter=()=>{var r,n,a;return((r=e.columnDef.enableColumnFilter)!=null?r:!0)&&((n=t.options.enableColumnFilters)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var r;return(r=t.getState().columnFilters)==null||(r=r.find(n=>n.id===e.id))==null?void 0:r.value},e.getFilterIndex=()=>{var r,n;return(r=(n=t.getState().columnFilters)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.setFilterValue=r=>{t.setColumnFilters(n=>{const a=e.getFilterFn(),l=n==null?void 0:n.find(A=>A.id===e.id),h=Mg(r,l?l.value:void 0);if(aK(a,h,e)){var i;return(i=n==null?void 0:n.filter(A=>A.id!==e.id))!=null?i:[]}const _={id:e.id,value:h};if(l){var w;return(w=n==null?void 0:n.map(A=>A.id===e.id?_:A))!=null?w:[]}return n!=null&&n.length?[...n,_]:[_]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const r=e.getAllLeafColumns(),n=a=>{var l;return(l=Mg(t,a))==null?void 0:l.filter(h=>{const i=r.find(_=>_.id===h.id);if(i){const _=i.getFilterFn();if(aK(_,h.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=t=>{var r,n;e.setColumnFilters(t?[]:(r=(n=e.initialState)==null?void 0:n.columnFilters)!=null?r:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function aK(e,t,r){return(e&&e.autoRemove?e.autoRemove(t,r):!1)||typeof t>"u"||typeof t=="string"&&!t}const H5e=(e,t,r)=>r.reduce((n,a)=>{const l=a.getValue(e);return n+(typeof l=="number"?l:0)},0),Z5e=(e,t,r)=>{let n;return r.forEach(a=>{const l=a.getValue(e);l!=null&&(n>l||n===void 0&&l>=l)&&(n=l)}),n},Y5e=(e,t,r)=>{let n;return r.forEach(a=>{const l=a.getValue(e);l!=null&&(n<l||n===void 0&&l>=l)&&(n=l)}),n},X5e=(e,t,r)=>{let n,a;return r.forEach(l=>{const h=l.getValue(e);h!=null&&(n===void 0?h>=h&&(n=a=h):(n>h&&(n=h),a<h&&(a=h)))}),[n,a]},J5e=(e,t)=>{let r=0,n=0;if(t.forEach(a=>{let l=a.getValue(e);l!=null&&(l=+l)>=l&&(++r,n+=l)}),r)return n/r},Q5e=(e,t)=>{if(!t.length)return;const r=t.map(l=>l.getValue(e));if(!V5e(r))return;if(r.length===1)return r[0];const n=Math.floor(r.length/2),a=r.sort((l,h)=>l-h);return r.length%2!==0?a[n]:(a[n-1]+a[n])/2},eBe=(e,t)=>Array.from(new Set(t.map(r=>r.getValue(e))).values()),tBe=(e,t)=>new Set(t.map(r=>r.getValue(e))).size,rBe=(e,t)=>t.length,Mj={sum:H5e,min:Z5e,max:Y5e,extent:X5e,mean:J5e,median:Q5e,unique:eBe,uniqueCount:tBe,count:rBe},nBe={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,r;return(t=(r=e.getValue())==null||r.toString==null?void 0:r.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Ou("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(r=>r!=null&&r.includes(e.id)?r.filter(n=>n!==e.id):[...r??[],e.id])},e.getCanGroup=()=>{var r,n;return((r=e.columnDef.enableGrouping)!=null?r:!0)&&((n=t.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.includes(e.id)},e.getGroupedIndex=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const r=e.getCanGroup();return()=>{r&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);if(typeof n=="number")return Mj.sum;if(Object.prototype.toString.call(n)==="[object Date]")return Mj.extent},e.getAggregationFn=()=>{var r,n;if(!e)throw new Error;return _E(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(r=(n=t.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?r:Mj[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var r,n;e.setGrouping(t?[]:(r=(n=e.initialState)==null?void 0:n.grouping)!=null?r:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=r=>{if(e._groupingValuesCache.hasOwnProperty(r))return e._groupingValuesCache[r];const n=t.getColumn(r);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[r]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[r]):e.getValue(r)},e._groupingValuesCache={}},createCell:(e,t,r,n)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===r.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var a;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((a=r.subRows)!=null&&a.length)}}};function iBe(e,t,r){if(!(t!=null&&t.length)||!r)return e;const n=e.filter(l=>!t.includes(l.id));return r==="remove"?n:[...t.map(l=>e.find(h=>h.id===l)).filter(Boolean),...n]}const aBe={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Ou("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=ni(r=>[x1(t,r)],r=>r.findIndex(n=>n.id===e.id),ii(t.options,"debugColumns")),e.getIsFirstColumn=r=>{var n;return((n=x1(t,r)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=r=>{var n;const a=x1(t,r);return((n=a[a.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var r;e.setColumnOrder(t?[]:(r=e.initialState.columnOrder)!=null?r:[])},e._getOrderColumnsFn=ni(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,r,n)=>a=>{let l=[];if(!(t!=null&&t.length))l=a;else{const h=[...t],i=[...a];for(;i.length&&h.length;){const _=h.shift(),w=i.findIndex(A=>A.id===_);w>-1&&l.push(i.splice(w,1)[0])}l=[...l,...i]}return iBe(l,r,n)},ii(e.options,"debugTable"))}},Oj=()=>({left:[],right:[]}),oBe={getInitialState:e=>({columnPinning:Oj(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Ou("columnPinning",e)}),createColumn:(e,t)=>{e.pin=r=>{const n=e.getLeafColumns().map(a=>a.id).filter(Boolean);t.setColumnPinning(a=>{var l,h;if(r==="right"){var i,_;return{left:((i=a==null?void 0:a.left)!=null?i:[]).filter(C=>!(n!=null&&n.includes(C))),right:[...((_=a==null?void 0:a.right)!=null?_:[]).filter(C=>!(n!=null&&n.includes(C))),...n]}}if(r==="left"){var w,A;return{left:[...((w=a==null?void 0:a.left)!=null?w:[]).filter(C=>!(n!=null&&n.includes(C))),...n],right:((A=a==null?void 0:a.right)!=null?A:[]).filter(C=>!(n!=null&&n.includes(C)))}}return{left:((l=a==null?void 0:a.left)!=null?l:[]).filter(C=>!(n!=null&&n.includes(C))),right:((h=a==null?void 0:a.right)!=null?h:[]).filter(C=>!(n!=null&&n.includes(C)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var a,l,h;return((a=n.columnDef.enablePinning)!=null?a:!0)&&((l=(h=t.options.enableColumnPinning)!=null?h:t.options.enablePinning)!=null?l:!0)}),e.getIsPinned=()=>{const r=e.getLeafColumns().map(i=>i.id),{left:n,right:a}=t.getState().columnPinning,l=r.some(i=>n==null?void 0:n.includes(i)),h=r.some(i=>a==null?void 0:a.includes(i));return l?"left":h?"right":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();return a?(r=(n=t.getState().columnPinning)==null||(n=n[a])==null?void 0:n.indexOf(e.id))!=null?r:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=ni(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(r,n,a)=>{const l=[...n??[],...a??[]];return r.filter(h=>!l.includes(h.column.id))},ii(t.options,"debugRows")),e.getLeftVisibleCells=ni(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(r,n)=>(n??[]).map(l=>r.find(h=>h.column.id===l)).filter(Boolean).map(l=>({...l,position:"left"})),ii(t.options,"debugRows")),e.getRightVisibleCells=ni(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(r,n)=>(n??[]).map(l=>r.find(h=>h.column.id===l)).filter(Boolean).map(l=>({...l,position:"right"})),ii(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var r,n;return e.setColumnPinning(t?Oj():(r=(n=e.initialState)==null?void 0:n.columnPinning)!=null?r:Oj())},e.getIsSomeColumnsPinned=t=>{var r;const n=e.getState().columnPinning;if(!t){var a,l;return!!((a=n.left)!=null&&a.length||(l=n.right)!=null&&l.length)}return!!((r=n[t])!=null&&r.length)},e.getLeftLeafColumns=ni(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ii(e.options,"debugColumns")),e.getRightLeafColumns=ni(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ii(e.options,"debugColumns")),e.getCenterLeafColumns=ni(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n)=>{const a=[...r??[],...n??[]];return t.filter(l=>!a.includes(l.id))},ii(e.options,"debugColumns"))}},J2={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},Rj=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),sBe={getDefaultColumnDef:()=>J2,getInitialState:e=>({columnSizing:{},columnSizingInfo:Rj(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Ou("columnSizing",e),onColumnSizingInfoChange:Ou("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var r,n,a;const l=t.getState().columnSizing[e.id];return Math.min(Math.max((r=e.columnDef.minSize)!=null?r:J2.minSize,(n=l??e.columnDef.size)!=null?n:J2.size),(a=e.columnDef.maxSize)!=null?a:J2.maxSize)},e.getStart=ni(r=>[r,x1(t,r),t.getState().columnSizing],(r,n)=>n.slice(0,e.getIndex(r)).reduce((a,l)=>a+l.getSize(),0),ii(t.options,"debugColumns")),e.getAfter=ni(r=>[r,x1(t,r),t.getState().columnSizing],(r,n)=>n.slice(e.getIndex(r)+1).reduce((a,l)=>a+l.getSize(),0),ii(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(r=>{let{[e.id]:n,...a}=r;return a})},e.getCanResize=()=>{var r,n;return((r=e.columnDef.enableResizing)!=null?r:!0)&&((n=t.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let r=0;const n=a=>{if(a.subHeaders.length)a.subHeaders.forEach(n);else{var l;r+=(l=a.column.getSize())!=null?l:0}};return n(e),r},e.getStart=()=>{if(e.index>0){const r=e.headerGroup.headers[e.index-1];return r.getStart()+r.getSize()}return 0},e.getResizeHandler=r=>{const n=t.getColumn(e.column.id),a=n==null?void 0:n.getCanResize();return l=>{if(!n||!a||(l.persist==null||l.persist(),kj(l)&&l.touches&&l.touches.length>1))return;const h=e.getSize(),i=e?e.getLeafHeaders().map(H=>[H.column.id,H.column.getSize()]):[[n.id,n.getSize()]],_=kj(l)?Math.round(l.touches[0].clientX):l.clientX,w={},A=(H,J)=>{typeof J=="number"&&(t.setColumnSizingInfo(Q=>{var le,ne;const de=t.options.columnResizeDirection==="rtl"?-1:1,ue=(J-((le=Q==null?void 0:Q.startOffset)!=null?le:0))*de,ve=Math.max(ue/((ne=Q==null?void 0:Q.startSize)!=null?ne:0),-.999999);return Q.columnSizingStart.forEach(Ae=>{let[Oe,Se]=Ae;w[Oe]=Math.round(Math.max(Se+Se*ve,0)*100)/100}),{...Q,deltaOffset:ue,deltaPercentage:ve}}),(t.options.columnResizeMode==="onChange"||H==="end")&&t.setColumnSizing(Q=>({...Q,...w})))},C=H=>A("move",H),R=H=>{A("end",H),t.setColumnSizingInfo(J=>({...J,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},z=r||typeof document<"u"?document:null,V={moveHandler:H=>C(H.clientX),upHandler:H=>{z==null||z.removeEventListener("mousemove",V.moveHandler),z==null||z.removeEventListener("mouseup",V.upHandler),R(H.clientX)}},U={moveHandler:H=>(H.cancelable&&(H.preventDefault(),H.stopPropagation()),C(H.touches[0].clientX),!1),upHandler:H=>{var J;z==null||z.removeEventListener("touchmove",U.moveHandler),z==null||z.removeEventListener("touchend",U.upHandler),H.cancelable&&(H.preventDefault(),H.stopPropagation()),R((J=H.touches[0])==null?void 0:J.clientX)}},G=lBe()?{passive:!1}:!1;kj(l)?(z==null||z.addEventListener("touchmove",U.moveHandler,G),z==null||z.addEventListener("touchend",U.upHandler,G)):(z==null||z.addEventListener("mousemove",V.moveHandler,G),z==null||z.addEventListener("mouseup",V.upHandler,G)),t.setColumnSizingInfo(H=>({...H,startOffset:_,startSize:h,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var r;e.setColumnSizing(t?{}:(r=e.initialState.columnSizing)!=null?r:{})},e.resetHeaderSizeInfo=t=>{var r;e.setColumnSizingInfo(t?Rj():(r=e.initialState.columnSizingInfo)!=null?r:Rj())},e.getTotalSize=()=>{var t,r;return(t=(r=e.getHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,r;return(t=(r=e.getLeftHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,r;return(t=(r=e.getCenterHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,r;return(t=(r=e.getRightHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0}}};let Q2=null;function lBe(){if(typeof Q2=="boolean")return Q2;let e=!1;try{const t={get passive(){return e=!0,!1}},r=()=>{};window.addEventListener("test",r,t),window.removeEventListener("test",r)}catch{e=!1}return Q2=e,Q2}function kj(e){return e.type==="touchstart"}const cBe={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Ou("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=r=>{e.getCanHide()&&t.setColumnVisibility(n=>({...n,[e.id]:r??!e.getIsVisible()}))},e.getIsVisible=()=>{var r,n;const a=e.columns;return(r=a.length?a.some(l=>l.getIsVisible()):(n=t.getState().columnVisibility)==null?void 0:n[e.id])!=null?r:!0},e.getCanHide=()=>{var r,n;return((r=e.columnDef.enableHiding)!=null?r:!0)&&((n=t.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>r=>{e.toggleVisibility==null||e.toggleVisibility(r.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=ni(()=>[e.getAllCells(),t.getState().columnVisibility],r=>r.filter(n=>n.column.getIsVisible()),ii(t.options,"debugRows")),e.getVisibleCells=ni(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(r,n,a)=>[...r,...n,...a],ii(t.options,"debugRows"))},createTable:e=>{const t=(r,n)=>ni(()=>[n(),n().filter(a=>a.getIsVisible()).map(a=>a.id).join("_")],a=>a.filter(l=>l.getIsVisible==null?void 0:l.getIsVisible()),ii(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=r=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(r),e.resetColumnVisibility=r=>{var n;e.setColumnVisibility(r?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=r=>{var n;r=(n=r)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((a,l)=>({...a,[l.id]:r||!(l.getCanHide!=null&&l.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(r=>!(r.getIsVisible!=null&&r.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(r=>r.getIsVisible==null?void 0:r.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>r=>{var n;e.toggleAllColumnsVisible((n=r.target)==null?void 0:n.checked)}}};function x1(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const uBe={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},dBe={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Ou("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var r;const n=(r=e.getCoreRowModel().flatRows[0])==null||(r=r._getAllCellsByColumnId()[t.id])==null?void 0:r.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var r,n,a,l;return((r=e.columnDef.enableGlobalFilter)!=null?r:!0)&&((n=t.options.enableGlobalFilter)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&((l=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?l:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>Yp.includesString,e.getGlobalFilterFn=()=>{var t,r;const{globalFilterFn:n}=e.options;return _E(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(t=(r=e.options.filterFns)==null?void 0:r[n])!=null?t:Yp[n]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},hBe={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Ou("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,r=!1;e._autoResetExpanded=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(r)return;r=!0,e._queue(()=>{e.resetExpanded(),r=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var a,l;e.setExpanded(n?{}:(a=(l=e.initialState)==null?void 0:l.expanded)!=null?a:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(a=>!a.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(l=>{const h=l.split(".");n=Math.max(n,h.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=r=>{t.setExpanded(n=>{var a;const l=n===!0?!0:!!(n!=null&&n[e.id]);let h={};if(n===!0?Object.keys(t.getRowModel().rowsById).forEach(i=>{h[i]=!0}):h=n,r=(a=r)!=null?a:!l,!l&&r)return{...h,[e.id]:!0};if(l&&!r){const{[e.id]:i,..._}=h;return _}return n})},e.getIsExpanded=()=>{var r;const n=t.getState().expanded;return!!((r=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?r:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var r,n,a;return(r=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?r:((n=t.options.enableExpanding)!=null?n:!0)&&!!((a=e.subRows)!=null&&a.length)},e.getIsAllParentsExpanded=()=>{let r=!0,n=e;for(;r&&n.parentId;)n=t.getRow(n.parentId,!0),r=n.getIsExpanded();return r},e.getToggleExpandedHandler=()=>{const r=e.getCanExpand();return()=>{r&&e.toggleExpanded()}}}},gD=0,yD=10,jj=()=>({pageIndex:gD,pageSize:yD}),fBe={getInitialState:e=>({...e,pagination:{...jj(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Ou("pagination",e)}),createTable:e=>{let t=!1,r=!1;e._autoResetPageIndex=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(r)return;r=!0,e._queue(()=>{e.resetPageIndex(),r=!1})}},e.setPagination=n=>{const a=l=>Mg(n,l);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(a)},e.resetPagination=n=>{var a;e.setPagination(n?jj():(a=e.initialState.pagination)!=null?a:jj())},e.setPageIndex=n=>{e.setPagination(a=>{let l=Mg(n,a.pageIndex);const h=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return l=Math.max(0,Math.min(l,h)),{...a,pageIndex:l}})},e.resetPageIndex=n=>{var a,l;e.setPageIndex(n?gD:(a=(l=e.initialState)==null||(l=l.pagination)==null?void 0:l.pageIndex)!=null?a:gD)},e.resetPageSize=n=>{var a,l;e.setPageSize(n?yD:(a=(l=e.initialState)==null||(l=l.pagination)==null?void 0:l.pageSize)!=null?a:yD)},e.setPageSize=n=>{e.setPagination(a=>{const l=Math.max(1,Mg(n,a.pageSize)),h=a.pageSize*a.pageIndex,i=Math.floor(h/l);return{...a,pageIndex:i,pageSize:l}})},e.setPageCount=n=>e.setPagination(a=>{var l;let h=Mg(n,(l=e.options.pageCount)!=null?l:-1);return typeof h=="number"&&(h=Math.max(-1,h)),{...a,pageCount:h}}),e.getPageOptions=ni(()=>[e.getPageCount()],n=>{let a=[];return n&&n>0&&(a=[...new Array(n)].fill(null).map((l,h)=>h)),a},ii(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,a=e.getPageCount();return a===-1?!0:a===0?!1:n<a-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},Nj=()=>({top:[],bottom:[]}),pBe={getInitialState:e=>({rowPinning:Nj(),...e}),getDefaultOptions:e=>({onRowPinningChange:Ou("rowPinning",e)}),createRow:(e,t)=>{e.pin=(r,n,a)=>{const l=n?e.getLeafRows().map(_=>{let{id:w}=_;return w}):[],h=a?e.getParentRows().map(_=>{let{id:w}=_;return w}):[],i=new Set([...h,e.id,...l]);t.setRowPinning(_=>{var w,A;if(r==="bottom"){var C,R;return{top:((C=_==null?void 0:_.top)!=null?C:[]).filter(U=>!(i!=null&&i.has(U))),bottom:[...((R=_==null?void 0:_.bottom)!=null?R:[]).filter(U=>!(i!=null&&i.has(U))),...Array.from(i)]}}if(r==="top"){var z,V;return{top:[...((z=_==null?void 0:_.top)!=null?z:[]).filter(U=>!(i!=null&&i.has(U))),...Array.from(i)],bottom:((V=_==null?void 0:_.bottom)!=null?V:[]).filter(U=>!(i!=null&&i.has(U)))}}return{top:((w=_==null?void 0:_.top)!=null?w:[]).filter(U=>!(i!=null&&i.has(U))),bottom:((A=_==null?void 0:_.bottom)!=null?A:[]).filter(U=>!(i!=null&&i.has(U)))}})},e.getCanPin=()=>{var r;const{enableRowPinning:n,enablePinning:a}=t.options;return typeof n=="function"?n(e):(r=n??a)!=null?r:!0},e.getIsPinned=()=>{const r=[e.id],{top:n,bottom:a}=t.getState().rowPinning,l=r.some(i=>n==null?void 0:n.includes(i)),h=r.some(i=>a==null?void 0:a.includes(i));return l?"top":h?"bottom":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();if(!a)return-1;const l=(r=a==="top"?t.getTopRows():t.getBottomRows())==null?void 0:r.map(h=>{let{id:i}=h;return i});return(n=l==null?void 0:l.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var r,n;return e.setRowPinning(t?Nj():(r=(n=e.initialState)==null?void 0:n.rowPinning)!=null?r:Nj())},e.getIsSomeRowsPinned=t=>{var r;const n=e.getState().rowPinning;if(!t){var a,l;return!!((a=n.top)!=null&&a.length||(l=n.bottom)!=null&&l.length)}return!!((r=n[t])!=null&&r.length)},e._getPinnedRows=(t,r,n)=>{var a;return((a=e.options.keepPinnedRows)==null||a?(r??[]).map(h=>{const i=e.getRow(h,!0);return i.getIsAllParentsExpanded()?i:null}):(r??[]).map(h=>t.find(i=>i.id===h))).filter(Boolean).map(h=>({...h,position:n}))},e.getTopRows=ni(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,r)=>e._getPinnedRows(t,r,"top"),ii(e.options,"debugRows")),e.getBottomRows=ni(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,r)=>e._getPinnedRows(t,r,"bottom"),ii(e.options,"debugRows")),e.getCenterRows=ni(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,r,n)=>{const a=new Set([...r??[],...n??[]]);return t.filter(l=>!a.has(l.id))},ii(e.options,"debugRows"))}},mBe={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Ou("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var r;return e.setRowSelection(t?{}:(r=e.initialState.rowSelection)!=null?r:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(r=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const n={...r},a=e.getPreGroupedRowModel().flatRows;return t?a.forEach(l=>{l.getCanSelect()&&(n[l.id]=!0)}):a.forEach(l=>{delete n[l.id]}),n})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(r=>{const n=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),a={...r};return e.getRowModel().rows.forEach(l=>{vD(a,l.id,n,!0,e)}),a}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=ni(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,r)=>Object.keys(t).length?Ij(e,r):{rows:[],flatRows:[],rowsById:{}},ii(e.options,"debugTable")),e.getFilteredSelectedRowModel=ni(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,r)=>Object.keys(t).length?Ij(e,r):{rows:[],flatRows:[],rowsById:{}},ii(e.options,"debugTable")),e.getGroupedSelectedRowModel=ni(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,r)=>Object.keys(t).length?Ij(e,r):{rows:[],flatRows:[],rowsById:{}},ii(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:r}=e.getState();let n=!!(t.length&&Object.keys(r).length);return n&&t.some(a=>a.getCanSelect()&&!r[a.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(a=>a.getCanSelect()),{rowSelection:r}=e.getState();let n=!!t.length;return n&&t.some(a=>!r[a.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var t;const r=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return r>0&&r<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(r=>r.getCanSelect()).some(r=>r.getIsSelected()||r.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(r,n)=>{const a=e.getIsSelected();t.setRowSelection(l=>{var h;if(r=typeof r<"u"?r:!a,e.getCanSelect()&&a===r)return l;const i={...l};return vD(i,e.id,r,(h=n==null?void 0:n.selectChildren)!=null?h:!0,t),i})},e.getIsSelected=()=>{const{rowSelection:r}=t.getState();return A4(e,r)},e.getIsSomeSelected=()=>{const{rowSelection:r}=t.getState();return _D(e,r)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:r}=t.getState();return _D(e,r)==="all"},e.getCanSelect=()=>{var r;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(r=t.options.enableRowSelection)!=null?r:!0},e.getCanSelectSubRows=()=>{var r;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(r=t.options.enableSubRowSelection)!=null?r:!0},e.getCanMultiSelect=()=>{var r;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(r=t.options.enableMultiRowSelection)!=null?r:!0},e.getToggleSelectedHandler=()=>{const r=e.getCanSelect();return n=>{var a;r&&e.toggleSelected((a=n.target)==null?void 0:a.checked)}}}},vD=(e,t,r,n,a)=>{var l;const h=a.getRow(t,!0);r?(h.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),h.getCanSelect()&&(e[t]=!0)):delete e[t],n&&(l=h.subRows)!=null&&l.length&&h.getCanSelectSubRows()&&h.subRows.forEach(i=>vD(e,i.id,r,n,a))};function Ij(e,t){const r=e.getState().rowSelection,n=[],a={},l=function(h,i){return h.map(_=>{var w;const A=A4(_,r);if(A&&(n.push(_),a[_.id]=_),(w=_.subRows)!=null&&w.length&&(_={..._,subRows:l(_.subRows)}),A)return _}).filter(Boolean)};return{rows:l(t.rows),flatRows:n,rowsById:a}}function A4(e,t){var r;return(r=t[e.id])!=null?r:!1}function _D(e,t,r){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let a=!0,l=!1;return e.subRows.forEach(h=>{if(!(l&&!a)&&(h.getCanSelect()&&(A4(h,t)?l=!0:a=!1),h.subRows&&h.subRows.length)){const i=_D(h,t);i==="all"?l=!0:(i==="some"&&(l=!0),a=!1)}}),a?"all":l?"some":!1}const xD=/([0-9]+)/gm,gBe=(e,t,r)=>Gre(Ug(e.getValue(r)).toLowerCase(),Ug(t.getValue(r)).toLowerCase()),yBe=(e,t,r)=>Gre(Ug(e.getValue(r)),Ug(t.getValue(r))),vBe=(e,t,r)=>T4(Ug(e.getValue(r)).toLowerCase(),Ug(t.getValue(r)).toLowerCase()),_Be=(e,t,r)=>T4(Ug(e.getValue(r)),Ug(t.getValue(r))),xBe=(e,t,r)=>{const n=e.getValue(r),a=t.getValue(r);return n>a?1:n<a?-1:0},bBe=(e,t,r)=>T4(e.getValue(r),t.getValue(r));function T4(e,t){return e===t?0:e>t?1:-1}function Ug(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function Gre(e,t){const r=e.split(xD).filter(Boolean),n=t.split(xD).filter(Boolean);for(;r.length&&n.length;){const a=r.shift(),l=n.shift(),h=parseInt(a,10),i=parseInt(l,10),_=[h,i].sort();if(isNaN(_[0])){if(a>l)return 1;if(l>a)return-1;continue}if(isNaN(_[1]))return isNaN(h)?-1:1;if(h>i)return 1;if(i>h)return-1}return r.length-n.length}const Hb={alphanumeric:gBe,alphanumericCaseSensitive:yBe,text:vBe,textCaseSensitive:_Be,datetime:xBe,basic:bBe},wBe={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Ou("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const r=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const a of r){const l=a==null?void 0:a.getValue(e.id);if(Object.prototype.toString.call(l)==="[object Date]")return Hb.datetime;if(typeof l=="string"&&(n=!0,l.split(xD).length>1))return Hb.alphanumeric}return n?Hb.text:Hb.basic},e.getAutoSortDir=()=>{const r=t.getFilteredRowModel().flatRows[0];return typeof(r==null?void 0:r.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var r,n;if(!e)throw new Error;return _E(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(r=(n=t.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?r:Hb[e.columnDef.sortingFn]},e.toggleSorting=(r,n)=>{const a=e.getNextSortingOrder(),l=typeof r<"u"&&r!==null;t.setSorting(h=>{const i=h==null?void 0:h.find(z=>z.id===e.id),_=h==null?void 0:h.findIndex(z=>z.id===e.id);let w=[],A,C=l?r:a==="desc";if(h!=null&&h.length&&e.getCanMultiSort()&&n?i?A="toggle":A="add":h!=null&&h.length&&_!==h.length-1?A="replace":i?A="toggle":A="replace",A==="toggle"&&(l||a||(A="remove")),A==="add"){var R;w=[...h,{id:e.id,desc:C}],w.splice(0,w.length-((R=t.options.maxMultiSortColCount)!=null?R:Number.MAX_SAFE_INTEGER))}else A==="toggle"?w=h.map(z=>z.id===e.id?{...z,desc:C}:z):A==="remove"?w=h.filter(z=>z.id!==e.id):w=[{id:e.id,desc:C}];return w})},e.getFirstSortDir=()=>{var r,n;return((r=(n=e.columnDef.sortDescFirst)!=null?n:t.options.sortDescFirst)!=null?r:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=r=>{var n,a;const l=e.getFirstSortDir(),h=e.getIsSorted();return h?h!==l&&((n=t.options.enableSortingRemoval)==null||n)&&(!(r&&(a=t.options.enableMultiRemove)!=null)||a)?!1:h==="desc"?"asc":"desc":l},e.getCanSort=()=>{var r,n;return((r=e.columnDef.enableSorting)!=null?r:!0)&&((n=t.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var r,n;return(r=(n=e.columnDef.enableMultiSort)!=null?n:t.options.enableMultiSort)!=null?r:!!e.accessorFn},e.getIsSorted=()=>{var r;const n=(r=t.getState().sorting)==null?void 0:r.find(a=>a.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var r,n;return(r=(n=t.getState().sorting)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.clearSorting=()=>{t.setSorting(r=>r!=null&&r.length?r.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const r=e.getCanSort();return n=>{r&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var r,n;e.setSorting(t?[]:(r=(n=e.initialState)==null?void 0:n.sorting)!=null?r:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},SBe=[G5e,cBe,aBe,oBe,K5e,W5e,uBe,dBe,wBe,nBe,hBe,fBe,pBe,mBe,sBe];function ABe(e){var t,r;const n=[...SBe,...(t=e._features)!=null?t:[]];let a={_features:n};const l=a._features.reduce((R,z)=>Object.assign(R,z.getDefaultOptions==null?void 0:z.getDefaultOptions(a)),{}),h=R=>a.options.mergeOptions?a.options.mergeOptions(l,R):{...l,...R};let _={...{},...(r=e.initialState)!=null?r:{}};a._features.forEach(R=>{var z;_=(z=R.getInitialState==null?void 0:R.getInitialState(_))!=null?z:_});const w=[];let A=!1;const C={_features:n,options:{...l,...e},initialState:_,_queue:R=>{w.push(R),A||(A=!0,Promise.resolve().then(()=>{for(;w.length;)w.shift()();A=!1}).catch(z=>setTimeout(()=>{throw z})))},reset:()=>{a.setState(a.initialState)},setOptions:R=>{const z=Mg(R,a.options);a.options=h(z)},getState:()=>a.options.state,setState:R=>{a.options.onStateChange==null||a.options.onStateChange(R)},_getRowId:(R,z,V)=>{var U;return(U=a.options.getRowId==null?void 0:a.options.getRowId(R,z,V))!=null?U:`${V?[V.id,z].join("."):z}`},getCoreRowModel:()=>(a._getCoreRowModel||(a._getCoreRowModel=a.options.getCoreRowModel(a)),a._getCoreRowModel()),getRowModel:()=>a.getPaginationRowModel(),getRow:(R,z)=>{let V=(z?a.getPrePaginationRowModel():a.getRowModel()).rowsById[R];if(!V&&(V=a.getCoreRowModel().rowsById[R],!V))throw new Error;return V},_getDefaultColumnDef:ni(()=>[a.options.defaultColumn],R=>{var z;return R=(z=R)!=null?z:{},{header:V=>{const U=V.header.column.columnDef;return U.accessorKey?U.accessorKey:U.accessorFn?U.id:null},cell:V=>{var U,G;return(U=(G=V.renderValue())==null||G.toString==null?void 0:G.toString())!=null?U:null},...a._features.reduce((V,U)=>Object.assign(V,U.getDefaultColumnDef==null?void 0:U.getDefaultColumnDef()),{}),...R}},ii(e,"debugColumns")),_getColumnDefs:()=>a.options.columns,getAllColumns:ni(()=>[a._getColumnDefs()],R=>{const z=function(V,U,G){return G===void 0&&(G=0),V.map(H=>{const J=q5e(a,H,G,U),Q=H;return J.columns=Q.columns?z(Q.columns,J,G+1):[],J})};return z(R)},ii(e,"debugColumns")),getAllFlatColumns:ni(()=>[a.getAllColumns()],R=>R.flatMap(z=>z.getFlatColumns()),ii(e,"debugColumns")),_getAllFlatColumnsById:ni(()=>[a.getAllFlatColumns()],R=>R.reduce((z,V)=>(z[V.id]=V,z),{}),ii(e,"debugColumns")),getAllLeafColumns:ni(()=>[a.getAllColumns(),a._getOrderColumnsFn()],(R,z)=>{let V=R.flatMap(U=>U.getLeafColumns());return z(V)},ii(e,"debugColumns")),getColumn:R=>a._getAllFlatColumnsById()[R]};Object.assign(a,C);for(let R=0;R<a._features.length;R++){const z=a._features[R];z==null||z.createTable==null||z.createTable(a)}return a}function AS(){return e=>ni(()=>[e.options.data],t=>{const r={rows:[],flatRows:[],rowsById:{}},n=function(a,l,h){l===void 0&&(l=0);const i=[];for(let w=0;w<a.length;w++){const A=w4(e,e._getRowId(a[w],w,h),a[w],w,l,void 0,h==null?void 0:h.id);if(r.flatRows.push(A),r.rowsById[A.id]=A,i.push(A),e.options.getSubRows){var _;A.originalSubRows=e.options.getSubRows(a[w],w),(_=A.originalSubRows)!=null&&_.length&&(A.subRows=n(A.originalSubRows,l+1,A))}}return i};return r.rows=n(t),r},ii(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function TBe(e){const t=[],r=n=>{var a;t.push(n),(a=n.subRows)!=null&&a.length&&n.getIsExpanded()&&n.subRows.forEach(r)};return e.rows.forEach(r),{rows:t,flatRows:e.flatRows,rowsById:e.rowsById}}function PBe(e,t,r){return r.options.filterFromLeafRows?EBe(e,t,r):CBe(e,t,r)}function EBe(e,t,r){var n;const a=[],l={},h=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(_,w){w===void 0&&(w=0);const A=[];for(let R=0;R<_.length;R++){var C;let z=_[R];const V=w4(r,z.id,z.original,z.index,z.depth,void 0,z.parentId);if(V.columnFilters=z.columnFilters,(C=z.subRows)!=null&&C.length&&w<h){if(V.subRows=i(z.subRows,w+1),z=V,t(z)&&!V.subRows.length){A.push(z),l[z.id]=z,a.push(z);continue}if(t(z)||V.subRows.length){A.push(z),l[z.id]=z,a.push(z);continue}}else z=V,t(z)&&(A.push(z),l[z.id]=z,a.push(z))}return A};return{rows:i(e),flatRows:a,rowsById:l}}function CBe(e,t,r){var n;const a=[],l={},h=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(_,w){w===void 0&&(w=0);const A=[];for(let R=0;R<_.length;R++){let z=_[R];if(t(z)){var C;if((C=z.subRows)!=null&&C.length&&w<h){const U=w4(r,z.id,z.original,z.index,z.depth,void 0,z.parentId);U.subRows=i(z.subRows,w+1),z=U}A.push(z),a.push(z),l[z.id]=z}}return A};return{rows:i(e),flatRows:a,rowsById:l}}function TS(){return e=>ni(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,r,n)=>{if(!t.rows.length||!(r!=null&&r.length)&&!n){for(let R=0;R<t.flatRows.length;R++)t.flatRows[R].columnFilters={},t.flatRows[R].columnFiltersMeta={};return t}const a=[],l=[];(r??[]).forEach(R=>{var z;const V=e.getColumn(R.id);if(!V)return;const U=V.getFilterFn();U&&a.push({id:R.id,filterFn:U,resolvedValue:(z=U.resolveFilterValue==null?void 0:U.resolveFilterValue(R.value))!=null?z:R.value})});const h=(r??[]).map(R=>R.id),i=e.getGlobalFilterFn(),_=e.getAllLeafColumns().filter(R=>R.getCanGlobalFilter());n&&i&&_.length&&(h.push("__global__"),_.forEach(R=>{var z;l.push({id:R.id,filterFn:i,resolvedValue:(z=i.resolveFilterValue==null?void 0:i.resolveFilterValue(n))!=null?z:n})}));let w,A;for(let R=0;R<t.flatRows.length;R++){const z=t.flatRows[R];if(z.columnFilters={},a.length)for(let V=0;V<a.length;V++){w=a[V];const U=w.id;z.columnFilters[U]=w.filterFn(z,U,w.resolvedValue,G=>{z.columnFiltersMeta[U]=G})}if(l.length){for(let V=0;V<l.length;V++){A=l[V];const U=A.id;if(A.filterFn(z,U,A.resolvedValue,G=>{z.columnFiltersMeta[U]=G})){z.columnFilters.__global__=!0;break}}z.columnFilters.__global__!==!0&&(z.columnFilters.__global__=!1)}}const C=R=>{for(let z=0;z<h.length;z++)if(R.columnFilters[h[z]]===!1)return!1;return!0};return PBe(t.rows,C,e)},ii(e.options,"debugTable","getFilteredRowModel",()=>e._autoResetPageIndex()))}function PS(e){return t=>ni(()=>[t.getState().pagination,t.getPrePaginationRowModel(),t.options.paginateExpandedRows?void 0:t.getState().expanded],(r,n)=>{if(!n.rows.length)return n;const{pageSize:a,pageIndex:l}=r;let{rows:h,flatRows:i,rowsById:_}=n;const w=a*l,A=w+a;h=h.slice(w,A);let C;t.options.paginateExpandedRows?C={rows:h,flatRows:i,rowsById:_}:C=TBe({rows:h,flatRows:i,rowsById:_}),C.flatRows=[];const R=z=>{C.flatRows.push(z),z.subRows.length&&z.subRows.forEach(R)};return C.rows.forEach(R),C},ii(t.options,"debugTable"))}function ES(){return e=>ni(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,r)=>{if(!r.rows.length||!(t!=null&&t.length))return r;const n=e.getState().sorting,a=[],l=n.filter(_=>{var w;return(w=e.getColumn(_.id))==null?void 0:w.getCanSort()}),h={};l.forEach(_=>{const w=e.getColumn(_.id);w&&(h[_.id]={sortUndefined:w.columnDef.sortUndefined,invertSorting:w.columnDef.invertSorting,sortingFn:w.getSortingFn()})});const i=_=>{const w=_.map(A=>({...A}));return w.sort((A,C)=>{for(let z=0;z<l.length;z+=1){var R;const V=l[z],U=h[V.id],G=U.sortUndefined,H=(R=V==null?void 0:V.desc)!=null?R:!1;let J=0;if(G){const Q=A.getValue(V.id),le=C.getValue(V.id),ne=Q===void 0,de=le===void 0;if(ne||de){if(G==="first")return ne?-1:1;if(G==="last")return ne?1:-1;J=ne&&de?0:ne?G:-G}}if(J===0&&(J=U.sortingFn(A,C,V.id)),J!==0)return H&&(J*=-1),U.invertSorting&&(J*=-1),J}return A.index-C.index}),w.forEach(A=>{var C;a.push(A),(C=A.subRows)!=null&&C.length&&(A.subRows=i(A.subRows))}),w};return{rows:i(r.rows),flatRows:a,rowsById:r.rowsById}},ii(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function Xf(e,t){return e?MBe(e)?K.createElement(e,t):e:null}function MBe(e){return OBe(e)||typeof e=="function"||RBe(e)}function OBe(e){return typeof e=="function"&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}function RBe(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function CS(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[r]=K.useState(()=>({current:ABe(t)})),[n,a]=K.useState(()=>r.current.initialState);return r.current.setOptions(l=>({...l,...e,state:{...n,...e.state},onStateChange:h=>{a(h),e.onStateChange==null||e.onStateChange(h)}})),r.current}const ty=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{className:"relative w-full overflow-auto",children:f.jsx("table",{ref:r,className:Gt("w-full caption-bottom text-sm",e),...t})}));ty.displayName="Table";const ry=K.forwardRef(({className:e,...t},r)=>f.jsx("thead",{ref:r,className:Gt("[&_tr]:border-b",e),...t}));ry.displayName="TableHeader";const ny=K.forwardRef(({className:e,...t},r)=>f.jsx("tbody",{ref:r,className:Gt("[&_tr:last-child]:border-0",e),...t}));ny.displayName="TableBody";const kBe=K.forwardRef(({className:e,...t},r)=>f.jsx("tfoot",{ref:r,className:Gt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));kBe.displayName="TableFooter";const rs=K.forwardRef(({className:e,...t},r)=>f.jsx("tr",{ref:r,className:Gt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));rs.displayName="TableRow";const Xo=K.forwardRef(({className:e,...t},r)=>f.jsx("th",{ref:r,className:Gt("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Xo.displayName="TableHead";const Ba=K.forwardRef(({className:e,...t},r)=>f.jsx("td",{ref:r,className:Gt("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Ba.displayName="TableCell";const jBe=K.forwardRef(({className:e,...t},r)=>f.jsx("caption",{ref:r,className:Gt("mt-4 text-sm text-muted-foreground",e),...t}));jBe.displayName="TableCaption";const MS=({rowCount:e,cellCount:t})=>f.jsx(f.Fragment,{children:Array.from({length:e}).map((r,n)=>f.jsx(rs,{children:Array.from({length:t}).map((a,l)=>f.jsx(Ba,{children:f.jsx(XA,{className:"h-5"})},l))},n))});function OS({table:e}){return f.jsxs(Cu,{children:[f.jsx(a3,{asChild:!0,children:f.jsxs(Ur,{variant:"outline",size:"sm",className:"ml-auto hidden h-8 lg:flex",children:[f.jsx(Que,{}),"View"]})}),f.jsxs(Fc,{align:"end",className:"w-[150px]",children:[f.jsx(Gg,{children:"Toggle columns"}),f.jsx(Lh,{}),e.getAllColumns().filter(t=>typeof t.accessorFn<"u"&&t.getCanHide()).map(t=>f.jsx(OH,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:r=>t.toggleVisibility(!!r),children:t.id},t.id))]})]})}function RS({table:e}){return f.jsx("div",{className:"flex items-center justify-end px-2",children:f.jsxs("div",{className:"flex items-center space-x-4 lg:space-x-5",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("p",{className:"text-xs font-medium",children:"Rows per page"}),f.jsxs(fs,{value:`${e.getState().pagination.pageSize}`,onValueChange:t=>{e.setPageSize(Number(t))},children:[f.jsx(Qo,{className:"h-7 w-[60px]",children:f.jsx(ps,{placeholder:e.getState().pagination.pageSize})}),f.jsx(es,{side:"top",children:[10,20,30,40,50].map(t=>f.jsx(Kr,{value:`${t}`,children:t},t))})]})]}),f.jsxs("div",{className:"flex w-[100px] items-center justify-center text-xs font-medium",children:["Page ",e.getState().pagination.pageIndex+1," of"," ",e.getPageCount()]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs(Ur,{variant:"outline",className:"hidden h-7 w-7 rounded-sm  p-0 lg:flex",onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),children:[f.jsx("span",{className:"sr-only",children:"Go to first page"}),f.jsx(lue,{})]}),f.jsxs(Ur,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),children:[f.jsx("span",{className:"sr-only",children:"Go to previous page"}),f.jsx(qK,{})]}),f.jsxs(Ur,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),children:[f.jsx("span",{className:"sr-only",children:"Go to next page"}),f.jsx(vx,{})]}),f.jsxs(Ur,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),children:[f.jsx("span",{className:"sr-only",children:"Go to last page"}),f.jsx(uue,{})]})]})]})})}const P4=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:l,loading:h,showAddButton:i=!1,onAdd:_,onAction:w})=>{var de;const[A,C]=Pe.useState([]),[R,z]=Pe.useState([]),[V,U]=Pe.useState({}),[G,H]=Pe.useState({pageIndex:0,pageSize:10}),[J,Q]=Pe.useState(""),le=r,ne=CS({data:l,columns:a(w),onSortingChange:C,onColumnFiltersChange:z,onPaginationChange:H,getCoreRowModel:AS(),getPaginationRowModel:PS(),getSortedRowModel:ES(),getFilteredRowModel:TS(),onColumnVisibilityChange:U,onGlobalFilterChange:Q,globalFilterFn:(ue,ve,Ae)=>le.some(Oe=>{const Se=ue.getValue(Oe);return String(Se).toLowerCase().includes(Ae.toLowerCase())}),state:{pagination:G,sorting:A,columnFilters:R,columnVisibility:V,globalFilter:J}});return f.jsxs(f.Fragment,{children:[f.jsx(ha,{className:"font-semibold",children:t}),f.jsxs("div",{className:`md:flex items-center  ${e?"justify-between  py-4":"justify-end pb-4"}`,children:[f.jsx(Fn,{placeholder:e,value:J??"",onChange:ue=>Q(ue.target.value),className:e?"hidden md:inline md:max-w-sm flex-shrink":"hidden"}),f.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[f.jsxs(Ur,{onClick:_,size:"sm",className:i?"w-min flex items-center gap-2":"hidden",children:[f.jsx(Bv,{}),f.jsx("span",{className:"hidden lg:inline",children:i})]}),f.jsx(OS,{table:ne})]})]}),f.jsx("div",{className:"rounded-md  border flex-1 overflow-hidden",children:f.jsxs(ty,{children:[f.jsx(ry,{className:"text-xs md:text-sm bg-muted",children:ne.getHeaderGroups().map(ue=>f.jsx(rs,{children:ue.headers.map(ve=>f.jsx(Xo,{children:Xf(ve.column.columnDef.header,ve.getContext())},ve.id))},ue.id))}),f.jsx(ny,{className:"text-xs md:text-sm",children:h?f.jsx(MS,{rowCount:5,cellCount:ne.getAllColumns().length}):(de=ne.getRowModel().rows)!=null&&de.length?ne.getRowModel().rows.map(ue=>f.jsx(rs,{"data-state":ue.getIsSelected()&&"selected",children:ue.getVisibleCells().map(ve=>f.jsx(Ba,{children:Xf(ve.column.columnDef.cell,ve.getContext())},ve.id))},ue.id)):f.jsx(rs,{className:"hover:bg-transparent",children:f.jsx(Ba,{colSpan:ne.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),f.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(RS,{table:ne})})]})},Dj=e=>e.charAt(0).toUpperCase()+e.slice(1),Kre=e=>({get:t=>e[t]||null}),Pu=e=>new Date(e).toLocaleString("en-PH",{weekday:"long",year:"numeric",month:"long",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),Wre=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),Lv=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"2-digit",timeZone:"Asia/Manila"}),NBe=Kre({0:"Registration",1:"Violation",2:"Accident"}),IBe=()=>{const[e,t]=K.useState([]),{token:r}=ra(),[n,a]=K.useState(!0);return K.useEffect(()=>{async function l(){try{const{data:h}=await Bn.get("/logs",{headers:{Authorization:r}});if(h.success){const i=h.data.map(_=>({id:_._id,fullname:_.driver.fullname,type:NBe.get(_.type),createdAt:Wre(_.createdAt)}));t(i)}}catch(h){console.log(h)}finally{a(!1)}}l()},[]),f.jsx("div",{className:"w-full",children:f.jsx(P4,{tableColumn:F5e,data:e})})},DBe=()=>{const[e,t]=K.useState(!0),[r,n]=K.useState({vehicles:{total:0,active:0,expired:0},drivers:{total:0},violations:{total:0,recent:0,byType:[]},accidents:{total:0},trends:{monthlyViolations:[]}}),{token:a}=ra();K.useEffect(()=>{l()},[]);const l=async()=>{try{t(!0);const{data:h}=await Bn.get("/dashboard/stats",{headers:{Authorization:a}});h.success&&n(h.data)}catch(h){console.error("Error fetching dashboard stats:",h)}finally{t(!1)}};return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsx("section",{className:"text-3xl font-bold",children:"Dashboard"}),f.jsxs("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-4",children:[f.jsx(L2,{name:"Registered Vehicles",value:e?"...":r.vehicles.total.toString(),icon:Av,statuses:[{label:`${r.vehicles.active} Active`,color:"#047857",bgColor:"#d1fae5"},{label:`${r.vehicles.expired} Expired`,color:"#dc2626",bgColor:"#fee2e2"}]}),f.jsx(L2,{name:"Registered Drivers",value:e?"...":r.drivers.total.toString(),icon:JK}),f.jsx(L2,{name:"Violations",value:e?"...":r.violations.total.toString(),icon:eue}),f.jsx(L2,{name:"Accidents",value:e?"...":r.accidents.total.toString(),icon:S1})]}),f.jsx(V4e,{}),f.jsxs("section",{className:"flex gap-4 flex-col lg:flex-row",children:[f.jsx(IBe,{}),f.jsx("div",{className:"p-5 border w-full lg:w-min rounded-lg ",children:f.jsx(zw,{mode:"single",className:"w-full"})})]})]})},LBe=({allowedRoles:e})=>{const t={employee:"2",admin:"1",superadmin:"0"},{isAuthenticated:r,isLoading:n,userData:a}=ra(),l=gs(),h=a==null?void 0:a.role;if(n)return f.jsx("div",{className:"h-screen my-auto mx-auto"});const i=e.map(_=>t[_]);return r&&i.includes(h)?f.jsx(kD,{}):f.jsx(RD,{to:"/login",state:{from:l},replace:!0})},Lj=({allowedRoles:e,children:t})=>{const{userData:r}=ra(),n=gs(),a=r==null?void 0:r.role;if(loading)return f.jsx("div",{children:"Loading..."});const l={employee:"2",admin:"1",superadmin:"0"};return e.map(i=>l[i]).includes(a)?t:f.jsx(RD,{to:"/",state:{from:n},replace:!0})},zj=768;function zBe(){const[e,t]=K.useState(void 0);return K.useEffect(()=>{const r=window.matchMedia(`(max-width: ${zj-1}px)`),n=()=>{t(window.innerWidth<zj)};return r.addEventListener("change",n),t(window.innerWidth<zj),()=>r.removeEventListener("change",n)},[]),!!e}var FBe="Separator",oK="horizontal",BBe=["horizontal","vertical"],Hre=K.forwardRef((e,t)=>{const{decorative:r,orientation:n=oK,...a}=e,l=VBe(n)?n:oK,i=r?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return f.jsx(mi.div,{"data-orientation":l,...i,...a,ref:t})});Hre.displayName=FBe;function VBe(e){return BBe.includes(e)}var Zre=Hre;const E4=K.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},a)=>f.jsx(Zre,{ref:a,decorative:r,orientation:t,className:Gt("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));E4.displayName=Zre.displayName;const UBe=_3,$Be=x3,Yre=K.forwardRef(({className:e,...t},r)=>f.jsx(Qw,{className:Gt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Yre.displayName=Qw.displayName;const qBe=u0("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Xre=K.forwardRef(({side:e="right",className:t,children:r,...n},a)=>f.jsxs($Be,{children:[f.jsx(Yre,{}),f.jsxs(eS,{ref:a,className:Gt(qBe({side:e}),t),...n,children:[f.jsxs(RP,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[f.jsx(P1,{className:"h-4 w-4"}),f.jsx("span",{className:"sr-only",children:"Close"})]}),r]})]}));Xre.displayName=eS.displayName;const Jre=({className:e,...t})=>f.jsx("div",{className:Gt("flex flex-col space-y-2 text-center sm:text-left",e),...t});Jre.displayName="SheetHeader";const Qre=K.forwardRef(({className:e,...t},r)=>f.jsx(tS,{ref:r,className:Gt("text-lg font-semibold text-foreground",e),...t}));Qre.displayName=tS.displayName;const ene=K.forwardRef(({className:e,...t},r)=>f.jsx(rS,{ref:r,className:Gt("text-sm text-muted-foreground",e),...t}));ene.displayName=rS.displayName;var[xE,Y6e]=Md("Tooltip",[qg]),bE=qg(),tne="TooltipProvider",GBe=700,bD="tooltip.open",[KBe,C4]=xE(tne),rne=e=>{const{__scopeTooltip:t,delayDuration:r=GBe,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:l}=e,[h,i]=K.useState(!0),_=K.useRef(!1),w=K.useRef(0);return K.useEffect(()=>{const A=w.current;return()=>window.clearTimeout(A)},[]),f.jsx(KBe,{scope:t,isOpenDelayed:h,delayDuration:r,onOpen:K.useCallback(()=>{window.clearTimeout(w.current),i(!1)},[]),onClose:K.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>i(!0),n)},[n]),isPointerInTransitRef:_,onPointerInTransitChange:K.useCallback(A=>{_.current=A},[]),disableHoverableContent:a,children:l})};rne.displayName=tne;var wE="Tooltip",[WBe,kS]=xE(wE),nne=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a=!1,onOpenChange:l,disableHoverableContent:h,delayDuration:i}=e,_=C4(wE,e.__scopeTooltip),w=bE(t),[A,C]=K.useState(null),R=Ad(),z=K.useRef(0),V=h??_.disableHoverableContent,U=i??_.delayDuration,G=K.useRef(!1),[H=!1,J]=kg({prop:n,defaultProp:a,onChange:ue=>{ue?(_.onOpen(),document.dispatchEvent(new CustomEvent(bD))):_.onClose(),l==null||l(ue)}}),Q=K.useMemo(()=>H?G.current?"delayed-open":"instant-open":"closed",[H]),le=K.useCallback(()=>{window.clearTimeout(z.current),z.current=0,G.current=!1,J(!0)},[J]),ne=K.useCallback(()=>{window.clearTimeout(z.current),z.current=0,J(!1)},[J]),de=K.useCallback(()=>{window.clearTimeout(z.current),z.current=window.setTimeout(()=>{G.current=!0,J(!0),z.current=0},U)},[U,J]);return K.useEffect(()=>()=>{z.current&&(window.clearTimeout(z.current),z.current=0)},[]),f.jsx(fP,{...w,children:f.jsx(WBe,{scope:t,contentId:R,open:H,stateAttribute:Q,trigger:A,onTriggerChange:C,onTriggerEnter:K.useCallback(()=>{_.isOpenDelayed?de():le()},[_.isOpenDelayed,de,le]),onTriggerLeave:K.useCallback(()=>{V?ne():(window.clearTimeout(z.current),z.current=0)},[ne,V]),onOpen:le,onClose:ne,disableHoverableContent:V,children:r})})};nne.displayName=wE;var wD="TooltipTrigger",ine=K.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=kS(wD,r),l=C4(wD,r),h=bE(r),i=K.useRef(null),_=Xi(t,i,a.onTriggerChange),w=K.useRef(!1),A=K.useRef(!1),C=K.useCallback(()=>w.current=!1,[]);return K.useEffect(()=>()=>document.removeEventListener("pointerup",C),[C]),f.jsx(Gw,{asChild:!0,...h,children:f.jsx(mi.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:_,onPointerMove:an(e.onPointerMove,R=>{R.pointerType!=="touch"&&!A.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),A.current=!0)}),onPointerLeave:an(e.onPointerLeave,()=>{a.onTriggerLeave(),A.current=!1}),onPointerDown:an(e.onPointerDown,()=>{w.current=!0,document.addEventListener("pointerup",C,{once:!0})}),onFocus:an(e.onFocus,()=>{w.current||a.onOpen()}),onBlur:an(e.onBlur,a.onClose),onClick:an(e.onClick,a.onClose)})})});ine.displayName=wD;var M4="TooltipPortal",[HBe,ZBe]=xE(M4,{forceMount:void 0}),ane=e=>{const{__scopeTooltip:t,forceMount:r,children:n,container:a}=e,l=kS(M4,t);return f.jsx(HBe,{scope:t,forceMount:r,children:f.jsx(Ru,{present:r||l.open,children:f.jsx(g0,{asChild:!0,container:a,children:n})})})};ane.displayName=M4;var a0="TooltipContent",one=K.forwardRef((e,t)=>{const r=ZBe(a0,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...l}=e,h=kS(a0,e.__scopeTooltip);return f.jsx(Ru,{present:n||h.open,children:h.disableHoverableContent?f.jsx(sne,{side:a,...l,ref:t}):f.jsx(YBe,{side:a,...l,ref:t})})}),YBe=K.forwardRef((e,t)=>{const r=kS(a0,e.__scopeTooltip),n=C4(a0,e.__scopeTooltip),a=K.useRef(null),l=Xi(t,a),[h,i]=K.useState(null),{trigger:_,onClose:w}=r,A=a.current,{onPointerInTransitChange:C}=n,R=K.useCallback(()=>{i(null),C(!1)},[C]),z=K.useCallback((V,U)=>{const G=V.currentTarget,H={x:V.clientX,y:V.clientY},J=eVe(H,G.getBoundingClientRect()),Q=tVe(H,J),le=rVe(U.getBoundingClientRect()),ne=iVe([...Q,...le]);i(ne),C(!0)},[C]);return K.useEffect(()=>()=>R(),[R]),K.useEffect(()=>{if(_&&A){const V=G=>z(G,A),U=G=>z(G,_);return _.addEventListener("pointerleave",V),A.addEventListener("pointerleave",U),()=>{_.removeEventListener("pointerleave",V),A.removeEventListener("pointerleave",U)}}},[_,A,z,R]),K.useEffect(()=>{if(h){const V=U=>{const G=U.target,H={x:U.clientX,y:U.clientY},J=(_==null?void 0:_.contains(G))||(A==null?void 0:A.contains(G)),Q=!nVe(H,h);J?R():Q&&(R(),w())};return document.addEventListener("pointermove",V),()=>document.removeEventListener("pointermove",V)}},[_,A,h,w,R]),f.jsx(sne,{...e,ref:l})}),[XBe,JBe]=xE(wE,{isInside:!1}),sne=K.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:h,...i}=e,_=kS(a0,r),w=bE(r),{onClose:A}=_;return K.useEffect(()=>(document.addEventListener(bD,A),()=>document.removeEventListener(bD,A)),[A]),K.useEffect(()=>{if(_.trigger){const C=R=>{const z=R.target;z!=null&&z.contains(_.trigger)&&A()};return window.addEventListener("scroll",C,{capture:!0}),()=>window.removeEventListener("scroll",C,{capture:!0})}},[_.trigger,A]),f.jsx(f0,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:h,onFocusOutside:C=>C.preventDefault(),onDismiss:A,children:f.jsxs(pP,{"data-state":_.stateAttribute,...w,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(ID,{children:n}),f.jsx(XBe,{scope:r,isInside:!0,children:f.jsx(u4e,{id:_.contentId,role:"tooltip",children:a||n})})]})})});one.displayName=a0;var lne="TooltipArrow",QBe=K.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=bE(r);return JBe(lne,r).isInside?null:f.jsx(mP,{...a,...n,ref:t})});QBe.displayName=lne;function eVe(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(r,n,a,l)){case l:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function tVe(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function rVe(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function nVe(e,t){const{x:r,y:n}=e;let a=!1;for(let l=0,h=t.length-1;l<t.length;h=l++){const i=t[l].x,_=t[l].y,w=t[h].x,A=t[h].y;_>n!=A>n&&r<(w-i)*(n-_)/(A-_)+i&&(a=!a)}return a}function iVe(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),aVe(t)}function aVe(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const l=t[t.length-1],h=t[t.length-2];if((l.x-h.x)*(a.y-h.y)>=(l.y-h.y)*(a.x-h.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const l=r[r.length-1],h=r[r.length-2];if((l.x-h.x)*(a.y-h.y)>=(l.y-h.y)*(a.x-h.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var oVe=rne,sVe=nne,lVe=ine,cVe=ane,cne=one;const uVe=oVe,dVe=sVe,hVe=lVe,une=K.forwardRef(({className:e,sideOffset:t=4,...r},n)=>f.jsx(cVe,{children:f.jsx(cne,{ref:n,sideOffset:t,className:Gt("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));une.displayName=cne.displayName;const fVe="sidebar_state",pVe=60*60*24*7,mVe="16rem",gVe="18rem",yVe="3rem",vVe="b",dne=K.createContext(null);function L0(){const e=K.useContext(dne);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const hne=K.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:r,className:n,style:a,children:l,...h},i)=>{const _=zBe(),[w,A]=K.useState(!1),[C,R]=K.useState(e),z=t??C,V=K.useCallback(J=>{const Q=typeof J=="function"?J(z):J;r?r(Q):R(Q),document.cookie=`${fVe}=${Q}; path=/; max-age=${pVe}`},[r,z]),U=K.useCallback(()=>_?A(J=>!J):V(J=>!J),[_,V,A]);K.useEffect(()=>{const J=Q=>{Q.key===vVe&&(Q.metaKey||Q.ctrlKey)&&(Q.preventDefault(),U())};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[U]);const G=z?"expanded":"collapsed",H=K.useMemo(()=>({state:G,open:z,setOpen:V,isMobile:_,openMobile:w,setOpenMobile:A,toggleSidebar:U}),[G,z,V,_,w,A,U]);return f.jsx(dne.Provider,{value:H,children:f.jsx(uVe,{delayDuration:0,children:f.jsx("div",{style:{"--sidebar-width":mVe,"--sidebar-width-icon":yVe,...a},className:Gt("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:i,...h,children:l})})})});hne.displayName="SidebarProvider";const fne=K.forwardRef(({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:n,children:a,...l},h)=>{const{isMobile:i,state:_,openMobile:w,setOpenMobile:A}=L0();return r==="none"?f.jsx("div",{className:Gt("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:h,...l,children:a}):i?f.jsx(UBe,{open:w,onOpenChange:A,...l,children:f.jsxs(Xre,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":gVe},side:e,children:[f.jsxs(Jre,{className:"sr-only",children:[f.jsx(Qre,{children:"Sidebar"}),f.jsx(ene,{children:"Displays the mobile sidebar."})]}),f.jsx("div",{className:"flex h-full w-full flex-col",children:a})]})}):f.jsxs("div",{ref:h,className:"group peer hidden text-sidebar-foreground md:block","data-state":_,"data-collapsible":_==="collapsed"?r:"","data-variant":t,"data-side":e,children:[f.jsx("div",{className:Gt("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),f.jsx("div",{className:Gt("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...l,children:f.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});fne.displayName="Sidebar";const pne=K.forwardRef(({className:e,onClick:t,...r},n)=>{const{toggleSidebar:a}=L0();return f.jsxs(Ur,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Gt("h-7 w-7",e),onClick:l=>{t==null||t(l),a()},...r,children:[f.jsx(Vue,{}),f.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});pne.displayName="SidebarTrigger";const mne=K.forwardRef(({className:e,...t},r)=>{const{toggleSidebar:n}=L0();return f.jsx("button",{ref:r,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:Gt("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});mne.displayName="SidebarRail";const gne=K.forwardRef(({className:e,...t},r)=>f.jsx("main",{ref:r,className:Gt("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));gne.displayName="SidebarInset";const _Ve=K.forwardRef(({className:e,...t},r)=>f.jsx(Fn,{ref:r,"data-sidebar":"input",className:Gt("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));_Ve.displayName="SidebarInput";const yne=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,"data-sidebar":"header",className:Gt("flex flex-col gap-2 p-2",e),...t}));yne.displayName="SidebarHeader";const vne=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,"data-sidebar":"footer",className:Gt("flex flex-col gap-2 p-2",e),...t}));vne.displayName="SidebarFooter";const xVe=K.forwardRef(({className:e,...t},r)=>f.jsx(E4,{ref:r,"data-sidebar":"separator",className:Gt("mx-2 w-auto bg-sidebar-border",e),...t}));xVe.displayName="SidebarSeparator";const _ne=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,"data-sidebar":"content",className:Gt("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));_ne.displayName="SidebarContent";const _A=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,"data-sidebar":"group",className:Gt("relative flex w-full min-w-0 flex-col p-2",e),...t}));_A.displayName="SidebarGroup";const xA=K.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?Vl:"div";return f.jsx(a,{ref:n,"data-sidebar":"group-label",className:Gt("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...r})});xA.displayName="SidebarGroupLabel";const bVe=K.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?Vl:"button";return f.jsx(a,{ref:n,"data-sidebar":"group-action",className:Gt("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...r})});bVe.displayName="SidebarGroupAction";const wVe=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,"data-sidebar":"group-content",className:Gt("w-full text-sm",e),...t}));wVe.displayName="SidebarGroupContent";const cx=K.forwardRef(({className:e,...t},r)=>f.jsx("ul",{ref:r,"data-sidebar":"menu",className:Gt("flex w-full min-w-0 flex-col gap-1",e),...t}));cx.displayName="SidebarMenu";const yd=K.forwardRef(({className:e,...t},r)=>f.jsx("li",{ref:r,"data-sidebar":"menu-item",className:Gt("group/menu-item relative",e),...t}));yd.displayName="SidebarMenuItem";const SVe=u0("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),vd=K.forwardRef(({asChild:e=!1,isActive:t=!1,variant:r="default",size:n="default",tooltip:a,className:l,...h},i)=>{const _=e?Vl:"button",{isMobile:w,state:A}=L0(),C=f.jsx(_,{ref:i,"data-sidebar":"menu-button","data-size":n,"data-active":t,className:Gt(SVe({variant:r,size:n}),l),...h});return a?(typeof a=="string"&&(a={children:a}),f.jsxs(dVe,{children:[f.jsx(hVe,{asChild:!0,children:C}),f.jsx(une,{side:"right",align:"center",hidden:A!=="collapsed"||w,...a})]})):C});vd.displayName="SidebarMenuButton";const AVe=K.forwardRef(({className:e,asChild:t=!1,showOnHover:r=!1,...n},a)=>{const l=t?Vl:"button";return f.jsx(l,{ref:a,"data-sidebar":"menu-action",className:Gt("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...n})});AVe.displayName="SidebarMenuAction";const TVe=K.forwardRef(({className:e,...t},r)=>f.jsx("div",{ref:r,"data-sidebar":"menu-badge",className:Gt("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));TVe.displayName="SidebarMenuBadge";const PVe=K.forwardRef(({className:e,showIcon:t=!1,...r},n)=>{const a=K.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return f.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:Gt("flex h-8 items-center gap-2 rounded-md px-2",e),...r,children:[t&&f.jsx(XA,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),f.jsx(XA,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});PVe.displayName="SidebarMenuSkeleton";const SD=K.forwardRef(({className:e,...t},r)=>f.jsx("ul",{ref:r,"data-sidebar":"menu-sub",className:Gt("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));SD.displayName="SidebarMenuSub";const ov=K.forwardRef(({...e},t)=>f.jsx("li",{ref:t,...e}));ov.displayName="SidebarMenuSubItem";const sv=K.forwardRef(({asChild:e=!1,size:t="md",isActive:r,className:n,...a},l)=>{const h=e?Vl:"a";return f.jsx(h,{ref:l,"data-sidebar":"menu-sub-button","data-size":t,"data-active":r,className:Gt("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...a})});sv.displayName="SidebarMenuSubButton";var O4="Collapsible",[EVe,X6e]=Md(O4),[CVe,R4]=EVe(O4),xne=K.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:l,onOpenChange:h,...i}=e,[_=!1,w]=kg({prop:n,defaultProp:a,onChange:h});return f.jsx(CVe,{scope:r,disabled:l,contentId:Ad(),open:_,onOpenToggle:K.useCallback(()=>w(A=>!A),[w]),children:f.jsx(mi.div,{"data-state":j4(_),"data-disabled":l?"":void 0,...i,ref:t})})});xne.displayName=O4;var bne="CollapsibleTrigger",wne=K.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=R4(bne,r);return f.jsx(mi.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":j4(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:an(e.onClick,a.onOpenToggle)})});wne.displayName=bne;var k4="CollapsibleContent",Sne=K.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=R4(k4,e.__scopeCollapsible);return f.jsx(Ru,{present:r||a.open,children:({present:l})=>f.jsx(MVe,{...n,ref:t,present:l})})});Sne.displayName=k4;var MVe=K.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...l}=e,h=R4(k4,r),[i,_]=K.useState(n),w=K.useRef(null),A=Xi(t,w),C=K.useRef(0),R=C.current,z=K.useRef(0),V=z.current,U=h.open||i,G=K.useRef(U),H=K.useRef(void 0);return K.useEffect(()=>{const J=requestAnimationFrame(()=>G.current=!1);return()=>cancelAnimationFrame(J)},[]),rl(()=>{const J=w.current;if(J){H.current=H.current||{transitionDuration:J.style.transitionDuration,animationName:J.style.animationName},J.style.transitionDuration="0s",J.style.animationName="none";const Q=J.getBoundingClientRect();C.current=Q.height,z.current=Q.width,G.current||(J.style.transitionDuration=H.current.transitionDuration,J.style.animationName=H.current.animationName),_(n)}},[h.open,n]),f.jsx(mi.div,{"data-state":j4(h.open),"data-disabled":h.disabled?"":void 0,id:h.contentId,hidden:!U,...l,ref:A,style:{"--radix-collapsible-content-height":R?`${R}px`:void 0,"--radix-collapsible-content-width":V?`${V}px`:void 0,...e.style},children:U&&a})});function j4(e){return e?"open":"closed"}var OVe=xne;const sK=OVe,lK=wne,cK=Sne;function RVe(){const{isMobile:e}=L0(),{logout:t,userData:r}=ra(),n=()=>{t()};return f.jsx(cx,{children:f.jsx(yd,{children:f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(vd,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[f.jsxs(fD,{className:"h-8 w-8 rounded-lg",children:[f.jsx(pD,{src:r.avatar,alt:r.email}),f.jsx(mD,{className:"rounded-lg font-bold",children:r.email.charAt(0)})]}),f.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:f.jsx("span",{className:"truncate font-semibold",children:r.email})}),f.jsx(GK,{className:"ml-auto size-4"})]})}),f.jsxs(Fc,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:e?"bottom":"right",align:"end",sideOffset:4,children:[f.jsx(Gg,{className:"p-0 font-normal",children:f.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[f.jsxs(fD,{className:"h-8 w-8 rounded-lg",children:[f.jsx(pD,{src:r.avatar,alt:r.email}),f.jsx(mD,{className:"rounded-lg font-bold",children:r.email.charAt(0)})]}),f.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:f.jsx("span",{className:"truncate font-semibold",children:r.email})})]})}),f.jsx(Lh,{}),f.jsx(ome,{children:f.jsxs(Ea,{children:[f.jsx(Wce,{}),"Account"]})}),f.jsx(Lh,{}),f.jsxs(Ea,{onSelect:n,children:[f.jsx(Due,{}),"Log out"]})]})]})})})}function kVe(e){const t=gs(),{userData:r}=ra(),{state:n}=L0(),[a,l]=K.useState(!1),[h,i]=K.useState(!1),_=n==="collapsed",w=R=>{l(R),R&&i(!1)},A=R=>{i(R),R&&l(!1)},C=(r==null?void 0:r.role)==="0"||(r==null?void 0:r.role)==="1";return r==null||r.role,f.jsxs(fne,{collapsible:"icon",...e,children:[f.jsx(yne,{className:"group-data-[collapsible=icon]:flex group-data-[collapsible=icon]:justify-center",children:f.jsx(cx,{children:f.jsx(yd,{children:f.jsxs(vd,{tooltip:"LTO WebSystem",className:"group-data-[collapsible=icon]:justify-center",children:[f.jsx("div",{className:"flex aspect-square size-8 items-center justify-center rounded-lg text-sidebar-primary-foreground group-data-[collapsible=icon]:size-6",children:f.jsx("img",{src:RK,className:"h-7 w-7 object-contain group-data-[collapsible=icon]:h-6 group-data-[collapsible=icon]:w-6",alt:"LTO Logo"})}),f.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight group-data-[collapsible=icon]:hidden",children:[f.jsx("span",{className:"truncate font-semibold",children:"LTO WebSystem"}),f.jsx("span",{className:"truncate text-xs",children:"Land Transportation Office"})]})]})})})}),f.jsxs(_ne,{children:[f.jsxs(_A,{children:[f.jsx(xA,{children:"Menu"}),f.jsxs(cx,{className:"",children:[f.jsx(yd,{children:f.jsx(vd,{isActive:t.pathname==="/",asChild:!0,children:f.jsxs(Rs,{to:"/",children:[f.jsx(ode,{}),f.jsx("span",{children:"Dashboard"})]})})}),f.jsx(yd,{children:f.jsx(vd,{isActive:t.pathname==="/vehicle",asChild:!0,children:f.jsxs(Rs,{to:"/vehicle",children:[f.jsx(Av,{}),f.jsx("span",{children:"Manage Vehicles"})]})})}),f.jsx(yd,{children:f.jsx(vd,{isActive:t.pathname==="/driver",asChild:!0,children:f.jsxs(Rs,{to:"/driver",children:[f.jsx(JK,{}),f.jsx("span",{children:"Manage Drivers"})]})})}),f.jsx(yd,{children:f.jsx(vd,{isActive:t.pathname==="/violation",asChild:!0,children:f.jsxs(Rs,{to:"/violation",children:[f.jsx($C,{}),f.jsx("span",{children:"Manage Violations"})]})})}),f.jsx(yd,{children:f.jsx(vd,{isActive:t.pathname==="/accident",asChild:!0,children:f.jsxs(Rs,{to:"/accident",children:[f.jsx(UC,{}),f.jsx("span",{children:"Manage Accidents"})]})})})]})]}),f.jsxs(_A,{children:[f.jsx(xA,{children:"Analytics"}),f.jsx(cx,{children:_?f.jsx(yd,{children:f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(vd,{tooltip:"Analytics",children:[f.jsx(S1,{}),f.jsx("span",{children:"Analytics"})]})}),f.jsxs(Fc,{side:"right",align:"start",className:"w-48",children:[f.jsx(Ea,{asChild:!0,children:f.jsxs(Rs,{to:"/analytics/registration",className:"flex items-center gap-2",children:[f.jsx(_B,{className:"h-4 w-4"}),f.jsx("span",{children:"Registration"})]})}),f.jsx(Ea,{asChild:!0,children:f.jsxs(Rs,{to:"/analytics/violation",className:"flex items-center gap-2",children:[f.jsx($C,{className:"h-4 w-4"}),f.jsx("span",{children:"Violation"})]})}),f.jsx(Ea,{asChild:!0,children:f.jsxs(Rs,{to:"/analytics/accident",className:"flex items-center gap-2",children:[f.jsx(UC,{className:"h-4 w-4"}),f.jsx("span",{children:"Accident"})]})})]})]})}):f.jsx(sK,{asChild:!0,className:"group/collapsible",open:a,onOpenChange:w,children:f.jsxs(yd,{children:[f.jsx(lK,{asChild:!0,children:f.jsxs(vd,{children:[f.jsx(S1,{}),f.jsx("span",{children:"Analytics"}),f.jsx(vx,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),f.jsx(cK,{children:f.jsxs(SD,{children:[f.jsx(ov,{children:f.jsx(sv,{isActive:t.pathname==="/analytics/registration",asChild:!0,children:f.jsxs(Rs,{to:"/analytics/registration",children:[f.jsx(_B,{}),f.jsx("span",{children:"Registration"})]})})}),f.jsx(ov,{children:f.jsx(sv,{isActive:t.pathname==="/analytics/violation",asChild:!0,children:f.jsxs(Rs,{to:"/analytics/violation",children:[f.jsx($C,{}),f.jsx("span",{children:"Violation"})]})})}),f.jsx(ov,{children:f.jsx(sv,{isActive:t.pathname==="/analytics/accident",asChild:!0,children:f.jsxs(Rs,{to:"/analytics/accident",children:[f.jsx(UC,{}),f.jsx("span",{children:"Accident"})]})})})]})})]})})})]}),C&&f.jsxs(_A,{children:[f.jsx(xA,{children:"Account Management"}),f.jsx(cx,{children:_?f.jsx(yd,{children:f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(vd,{tooltip:"Manage Account",children:[f.jsx(AA,{}),f.jsx("span",{children:"Manage Account"})]})}),f.jsxs(Fc,{side:"right",align:"start",className:"w-48",children:[f.jsx(Ea,{asChild:!0,children:f.jsxs(Rs,{to:"/account/register",className:"flex items-center gap-2",children:[f.jsx(SA,{className:"h-4 w-4"}),f.jsx("span",{children:"Register Account"})]})}),f.jsx(Ea,{asChild:!0,children:f.jsxs(Rs,{to:"/account/update",className:"flex items-center gap-2",children:[f.jsx(Nc,{className:"h-4 w-4"}),f.jsx("span",{children:"Update Account"})]})}),f.jsx(Ea,{asChild:!0,children:f.jsxs(Rs,{to:"/account/logs",className:"flex items-center gap-2",children:[f.jsx(A1,{className:"h-4 w-4"}),f.jsx("span",{children:"View Account Logs"})]})})]})]})}):f.jsx(sK,{asChild:!0,className:"group/collapsible",open:h,onOpenChange:A,children:f.jsxs(yd,{children:[f.jsx(lK,{asChild:!0,children:f.jsxs(vd,{children:[f.jsx(AA,{}),f.jsx("span",{children:"Manage Account"}),f.jsx(vx,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),f.jsx(cK,{children:f.jsxs(SD,{children:[f.jsx(ov,{children:f.jsx(sv,{isActive:t.pathname==="/account/register",asChild:!0,children:f.jsxs(Rs,{to:"/account/register",children:[f.jsx(SA,{}),f.jsx("span",{children:"Register Account"})]})})}),f.jsx(ov,{children:f.jsx(sv,{isActive:t.pathname==="/account/update",asChild:!0,children:f.jsxs(Rs,{to:"/account/update",children:[f.jsx(Nc,{}),f.jsx("span",{children:"Update Account"})]})})}),f.jsx(ov,{children:f.jsx(sv,{isActive:t.pathname==="/account/logs",asChild:!0,children:f.jsxs(Rs,{to:"/account/logs",children:[f.jsx(A1,{}),f.jsx("span",{children:"View Account Logs"})]})})})]})})]})})})]})]}),f.jsx(vne,{children:f.jsx(RVe,{})}),f.jsx(mne,{})]})}const Ane=K.forwardRef(({...e},t)=>f.jsx("nav",{ref:t,"aria-label":"breadcrumb",...e}));Ane.displayName="Breadcrumb";const Tne=K.forwardRef(({className:e,...t},r)=>f.jsx("ol",{ref:r,className:Gt("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...t}));Tne.displayName="BreadcrumbList";const AD=K.forwardRef(({className:e,...t},r)=>f.jsx("li",{ref:r,className:Gt("inline-flex items-center gap-1.5",e),...t}));AD.displayName="BreadcrumbItem";const Pne=K.forwardRef(({asChild:e,className:t,...r},n)=>{const a=e?Vl:"a";return f.jsx(a,{ref:n,className:Gt("transition-colors hover:text-foreground",t),...r})});Pne.displayName="BreadcrumbLink";const Ene=K.forwardRef(({className:e,...t},r)=>f.jsx("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:Gt("font-normal text-foreground",e),...t}));Ene.displayName="BreadcrumbPage";const Cne=({children:e,className:t,...r})=>f.jsx("li",{role:"presentation","aria-hidden":"true",className:Gt("[&>svg]:w-3.5 [&>svg]:h-3.5",t),...r,children:e??f.jsx(vx,{})});Cne.displayName="BreadcrumbSeparator";const jVe=()=>(Ua(),f.jsx(f.Fragment,{children:f.jsxs(hne,{children:[f.jsx(kVe,{}),f.jsxs(gne,{children:[f.jsxs("header",{className:"flex justify-between border-b bg-gray backdrop-blur-lg h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12",children:[f.jsxs("div",{className:"flex items-center gap-2 px-4",children:[f.jsx(pne,{className:"-ml-1"}),f.jsx(E4,{orientation:"vertical",className:"mr-2 h-4"}),f.jsx(Ane,{children:f.jsxs(Tne,{children:[f.jsx(AD,{className:"hidden md:block",children:f.jsx(Pne,{href:"#",children:"Dashboard"})}),f.jsx(Cne,{className:"hidden md:block"}),f.jsx(AD,{children:f.jsx(Ene,{children:"Overview"})})]})})]}),f.jsx("div",{className:"px-4 md:px-8",children:f.jsx(kH,{})})]}),f.jsx("main",{className:"md:p-4 ",children:f.jsx(kD,{})})]})]})})),NVe=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:l,loading:h,onNavigate:i,onAdd:_,onRowClick:w,onEdit:A,onDelete:C})=>{var ve;const[R,z]=Pe.useState([]),[V,U]=Pe.useState([]),[G,H]=Pe.useState({}),[J,Q]=Pe.useState({pageIndex:0,pageSize:10}),[le,ne]=Pe.useState(""),de=r,ue=CS({data:l,columns:a(A,C),onSortingChange:z,onColumnFiltersChange:U,onPaginationChange:Q,getCoreRowModel:AS(),getPaginationRowModel:PS(),getSortedRowModel:ES(),getFilteredRowModel:TS(),onColumnVisibilityChange:H,onGlobalFilterChange:ne,globalFilterFn:(Ae,Oe,Se)=>de.some(ke=>{const ze=Ae.getValue(ke);return String(ze).toLowerCase().includes(Se.toLowerCase())}),state:{pagination:J,sorting:R,columnFilters:V,columnVisibility:G,globalFilter:le}});return f.jsxs(f.Fragment,{children:[f.jsx(ha,{className:"font-semibold",children:t}),f.jsxs("div",{className:`md:flex items-center justify-between  py-4
        `,children:[f.jsx(Fn,{placeholder:"Search Driver...",value:le??"",onChange:Ae=>ne(Ae.target.value),className:"hidden md:inline md:max-w-sm flex-shrink"}),f.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[f.jsxs(Ur,{onClick:_,className:"w-min flex items-center gap-2",children:[f.jsx(Bv,{}),f.jsx("span",{className:"hidden lg:inline",children:"Add Driver"})]}),f.jsxs(Ur,{onClick:i,variant:"outline",className:"w-min flex items-center gap-2",children:[f.jsx(FD,{}),f.jsx("span",{className:"hidden lg:inline",children:"Bin"})]}),f.jsx(OS,{table:ue})]})]}),f.jsx("div",{className:"rounded-md  border flex-1 overflow-hidden",children:f.jsxs(ty,{children:[f.jsx(ry,{className:"text-xs md:text-sm bg-muted",children:ue.getHeaderGroups().map(Ae=>f.jsx(rs,{children:Ae.headers.map(Oe=>f.jsx(Xo,{children:Xf(Oe.column.columnDef.header,Oe.getContext())},Oe.id))},Ae.id))}),f.jsx(ny,{className:"text-xs md:text-sm",children:h?f.jsx(MS,{rowCount:5,cellCount:ue.getAllColumns().length}):(ve=ue.getRowModel().rows)!=null&&ve.length?ue.getRowModel().rows.map(Ae=>f.jsx(rs,{onClick:()=>w(Ae.original),"data-state":Ae.getIsSelected()&&"selected",children:Ae.getVisibleCells().map(Oe=>f.jsx(Ba,{children:Xf(Oe.column.columnDef.cell,Oe.getContext())},Oe.id))},Ae.id)):f.jsx(rs,{className:"hover:bg-transparent",children:f.jsx(Ba,{colSpan:ue.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),f.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(RS,{table:ue})})]})};var Mne="AlertDialog",[IVe,J6e]=Md(Mne,[BZ]),bm=BZ(),One=e=>{const{__scopeAlertDialog:t,...r}=e,n=bm(t);return f.jsx(_3,{...n,...r,modal:!0})};One.displayName=Mne;var DVe="AlertDialogTrigger",LVe=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=bm(r);return f.jsx(Lve,{...a,...n,ref:t})});LVe.displayName=DVe;var zVe="AlertDialogPortal",Rne=e=>{const{__scopeAlertDialog:t,...r}=e,n=bm(t);return f.jsx(x3,{...n,...r})};Rne.displayName=zVe;var FVe="AlertDialogOverlay",kne=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=bm(r);return f.jsx(Qw,{...a,...n,ref:t})});kne.displayName=FVe;var yx="AlertDialogContent",[BVe,VVe]=IVe(yx),jne=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,l=bm(r),h=K.useRef(null),i=Xi(t,h),_=K.useRef(null);return f.jsx(jve,{contentName:yx,titleName:Nne,docsSlug:"alert-dialog",children:f.jsx(BVe,{scope:r,cancelRef:_,children:f.jsxs(eS,{role:"alertdialog",...l,...a,ref:i,onOpenAutoFocus:an(a.onOpenAutoFocus,w=>{var A;w.preventDefault(),(A=_.current)==null||A.focus({preventScroll:!0})}),onPointerDownOutside:w=>w.preventDefault(),onInteractOutside:w=>w.preventDefault(),children:[f.jsx(ID,{children:n}),f.jsx($Ve,{contentRef:h})]})})})});jne.displayName=yx;var Nne="AlertDialogTitle",Ine=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=bm(r);return f.jsx(tS,{...a,...n,ref:t})});Ine.displayName=Nne;var Dne="AlertDialogDescription",Lne=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=bm(r);return f.jsx(rS,{...a,...n,ref:t})});Lne.displayName=Dne;var UVe="AlertDialogAction",zne=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=bm(r);return f.jsx(RP,{...a,...n,ref:t})});zne.displayName=UVe;var Fne="AlertDialogCancel",Bne=K.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=VVe(Fne,r),l=bm(r),h=Xi(t,a);return f.jsx(RP,{...l,...n,ref:h})});Bne.displayName=Fne;var $Ve=({contentRef:e})=>{const t=`\`${yx}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${yx}\` by passing a \`${Dne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${yx}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return K.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},qVe=One,GVe=Rne,Vne=kne,Une=jne,$ne=zne,qne=Bne,Gne=Ine,Kne=Lne;const Wne=qVe,KVe=GVe,Hne=K.forwardRef(({className:e,...t},r)=>f.jsx(Vne,{className:Gt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Hne.displayName=Vne.displayName;const N4=K.forwardRef(({className:e,...t},r)=>f.jsxs(KVe,{children:[f.jsx(Hne,{}),f.jsx(Une,{ref:r,className:Gt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));N4.displayName=Une.displayName;const I4=({className:e,...t})=>f.jsx("div",{className:Gt("flex flex-col space-y-2 text-center sm:text-left",e),...t});I4.displayName="AlertDialogHeader";const D4=({className:e,...t})=>f.jsx("div",{className:Gt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});D4.displayName="AlertDialogFooter";const L4=K.forwardRef(({className:e,...t},r)=>f.jsx(Gne,{ref:r,className:Gt("text-lg font-semibold",e),...t}));L4.displayName=Gne.displayName;const z4=K.forwardRef(({className:e,...t},r)=>f.jsx(Kne,{ref:r,className:Gt("text-sm text-muted-foreground",e),...t}));z4.displayName=Kne.displayName;const F4=K.forwardRef(({className:e,...t},r)=>f.jsx($ne,{ref:r,className:Gt(w1({variant:"outline"}),e),...t}));F4.displayName=$ne.displayName;const B4=K.forwardRef(({className:e,...t},r)=>f.jsx(qne,{ref:r,className:Gt(w1(),"mt-2 sm:mt-0",e),...t}));B4.displayName=qne.displayName;const V4=({open:e,onOpenChange:t,confirm:r,cancel:n,title:a,description:l})=>f.jsx(Wne,{open:e,onOpenChange:t,children:f.jsxs(N4,{className:"",children:[f.jsxs(I4,{children:[f.jsx(L4,{children:a}),f.jsx(z4,{children:l})]}),f.jsxs(D4,{children:[f.jsx(B4,{onClick:n,children:"Cancel"}),f.jsx(F4,{onClick:r,children:"Continue"})]})]})});var U4="Popover",[Zne,Q6e]=Md(U4,[qg]),jS=qg(),[WVe,iy]=Zne(U4),Yne=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:h=!1}=e,i=jS(t),_=K.useRef(null),[w,A]=K.useState(!1),[C=!1,R]=kg({prop:n,defaultProp:a,onChange:l});return f.jsx(fP,{...i,children:f.jsx(WVe,{scope:t,contentId:Ad(),triggerRef:_,open:C,onOpenChange:R,onOpenToggle:K.useCallback(()=>R(z=>!z),[R]),hasCustomAnchor:w,onCustomAnchorAdd:K.useCallback(()=>A(!0),[]),onCustomAnchorRemove:K.useCallback(()=>A(!1),[]),modal:h,children:r})})};Yne.displayName=U4;var Xne="PopoverAnchor",HVe=K.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=iy(Xne,r),l=jS(r),{onCustomAnchorAdd:h,onCustomAnchorRemove:i}=a;return K.useEffect(()=>(h(),()=>i()),[h,i]),f.jsx(Gw,{...l,...n,ref:t})});HVe.displayName=Xne;var Jne="PopoverTrigger",Qne=K.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=iy(Jne,r),l=jS(r),h=Xi(t,a.triggerRef),i=f.jsx(mi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":iie(a.open),...n,ref:h,onClick:an(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:f.jsx(Gw,{asChild:!0,...l,children:i})});Qne.displayName=Jne;var $4="PopoverPortal",[ZVe,YVe]=Zne($4,{forceMount:void 0}),eie=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,l=iy($4,t);return f.jsx(ZVe,{scope:t,forceMount:r,children:f.jsx(Ru,{present:r||l.open,children:f.jsx(g0,{asChild:!0,container:a,children:n})})})};eie.displayName=$4;var o0="PopoverContent",tie=K.forwardRef((e,t)=>{const r=YVe(o0,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,l=iy(o0,e.__scopePopover);return f.jsx(Ru,{present:n||l.open,children:l.modal?f.jsx(XVe,{...a,ref:t}):f.jsx(JVe,{...a,ref:t})})});tie.displayName=o0;var XVe=K.forwardRef((e,t)=>{const r=iy(o0,e.__scopePopover),n=K.useRef(null),a=Xi(t,n),l=K.useRef(!1);return K.useEffect(()=>{const h=n.current;if(h)return yP(h)},[]),f.jsx(Kw,{as:Vl,allowPinchZoom:!0,children:f.jsx(rie,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:an(e.onCloseAutoFocus,h=>{var i;h.preventDefault(),l.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:an(e.onPointerDownOutside,h=>{const i=h.detail.originalEvent,_=i.button===0&&i.ctrlKey===!0,w=i.button===2||_;l.current=w},{checkForDefaultPrevented:!1}),onFocusOutside:an(e.onFocusOutside,h=>h.preventDefault(),{checkForDefaultPrevented:!1})})})}),JVe=K.forwardRef((e,t)=>{const r=iy(o0,e.__scopePopover),n=K.useRef(!1),a=K.useRef(!1);return f.jsx(rie,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var h,i;(h=e.onCloseAutoFocus)==null||h.call(e,l),l.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{var _,w;(_=e.onInteractOutside)==null||_.call(e,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const h=l.target;((w=r.triggerRef.current)==null?void 0:w.contains(h))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),rie=K.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:h,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:w,onInteractOutside:A,...C}=e,R=iy(o0,r),z=jS(r);return cP(),f.jsx($w,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:f.jsx(f0,{asChild:!0,disableOutsidePointerEvents:h,onInteractOutside:A,onEscapeKeyDown:i,onPointerDownOutside:_,onFocusOutside:w,onDismiss:()=>R.onOpenChange(!1),children:f.jsx(pP,{"data-state":iie(R.open),role:"dialog",id:R.contentId,...z,...C,ref:t,style:{...C.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),nie="PopoverClose",QVe=K.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=iy(nie,r);return f.jsx(mi.button,{type:"button",...n,ref:t,onClick:an(e.onClick,()=>a.onOpenChange(!1))})});QVe.displayName=nie;var eUe="PopoverArrow",tUe=K.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=jS(r);return f.jsx(mP,{...a,...n,ref:t})});tUe.displayName=eUe;function iie(e){return e?"open":"closed"}var rUe=Yne,nUe=Qne,iUe=eie,aie=tie;const zv=rUe,Fv=nUe,$g=K.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>f.jsx(iUe,{children:f.jsx(aie,{ref:a,align:t,sideOffset:r,className:Gt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));$g.displayName=aie.displayName;const NS=({fieldValue:e,dateValue:t})=>{const r=new Date,[n,a]=K.useState(e||r),[l,h]=K.useState((e||r).getFullYear()),[i,_]=K.useState((e||r).getMonth()),w=R=>{h(R);const z=hD(n,R);a(z),t&&t(z)},A=R=>{_(R);const z=yA(n,R);a(z),t&&t(z)},C=R=>{R&&(a(R),h(R.getFullYear()),_(R.getMonth()),t&&t(R))};return K.useEffect(()=>{e&&(a(e),h(e.getFullYear()),_(e.getMonth()))},[e]),f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(fs,{onValueChange:R=>A(parseInt(R,10)),value:i.toString(),children:[f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select Month"})}),f.jsx(es,{children:Array.from({length:12},(R,z)=>f.jsx(Kr,{value:z.toString(),children:Vc(new Date(2e3,z,1),"MMMM")},z))})]}),f.jsxs(fs,{onValueChange:R=>w(parseInt(R,10)),value:l.toString(),children:[f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select Year"})}),f.jsx(es,{children:Array.from({length:150},(R,z)=>{const V=new Date().getFullYear()-50+z;return f.jsx(Kr,{value:V.toString(),children:V},V)})})]})]}),f.jsx("div",{className:"border rounded-md",children:f.jsx(zw,{mode:"single",selected:n,onSelect:C,disabled:R=>R<new Date("1900-01-01"),fromYear:1900,toYear:new Date().getFullYear()+10,month:n,onMonthChange:R=>{a(R),h(R.getFullYear()),_(R.getMonth())}})}),f.jsx("div",{className:"flex justify-end",children:f.jsx(Ur,{type:"button",variant:"outline",onClick:()=>{_(r.getMonth()),h(r.getFullYear()),a(r),t&&t(r)},children:"Today"})})]})},Kp={region:"DAVAO ORIENTAL",municipalities:{BANAYBANAY:{barangays:{CABANGCALAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CAGANGANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CALUBIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAUSWAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MOGBONGCOGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},PANIKIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PINTATAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PISO PROPER":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"PUNTA LINAO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"RANG-AY":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BOSTON:{barangays:{CAATIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABASAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CARMEN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAWAYANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SIBAJAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SIMULAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BAGANGA:{barangays:{BACULIN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BATAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATIANO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BINONDO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBONAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMPAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DAPNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},KINABLANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBAJON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHANUB:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MIKIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SALINGCOMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICTOR":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAOQUEGUE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CARAGA:{barangays:{ALVAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CANINGAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON LEON BALANTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMIAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANORIGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MERCEDES:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PALMA GIL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PICHON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN LUIS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN PEDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SANTA FE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANTIAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SOBRECAREY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CATEEL:{barangays:{ABIJOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ALEGRIA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ALIWAGWAG:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ARAGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BAYBAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGLAHUS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAINIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MALIBAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ALFONSO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN RAFAEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTA FILOMENA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAYTAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]}}},"GOVERNOR GENEROSO":{barangays:{ANITAP:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"CRISPIN DELA CRUZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON AURELIO CHICOTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAVIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUZON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGDUG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"MANUEL ROXAS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MONTSERRAT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},NANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},OREGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},PUNDAGUITAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SERGIO OSMEA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SUROP:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABEBE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"TANDANG SORA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TIBANBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TIBLAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"UPPER TIBANBAN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},LUPON:{barangays:{BAGUMBAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABADIANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CALAPAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},COCORNON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CORPORACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON MARIANO MARCOS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ILANGAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANTAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMBAHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACANGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGSAYSAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAHAYAHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MARAGATAS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MARAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW VISAYAS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGBOA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGUGPO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},MANAY:{barangays:{CAPASNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAYAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CONCEPCION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DEL PILAR":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},GUZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"HOLY CROSS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBOG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MABINI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MANREZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW TAOKANGA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"OLD MACOPA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},RIZAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN FERMIN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN IGNACIO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ZARAGOSA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},"CITY OF MATI":{barangays:{BADAS:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BUSO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABUAYA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CULIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAHICAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON ENRIQUE LOPEZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON MARTIN MARUNDAN":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON SALVADOR LOPEZ, SR.":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAWIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LIBUDON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LUBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACAMBOL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAMALI:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MATIAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAYO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAINZ:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANGHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABAKID:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGBINONGA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGUIBO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMISAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},"SAN ISIDRO":{barangays:{BAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATOBATO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BITAOGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMBALEON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DUGMANON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},IBA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"LA UNION":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"LAPU-LAPU":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANIKLING:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ROQUE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTO ROSARIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SUDLON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TALISAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},TARRAGONA:{barangays:{CABAGAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DADONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},JOVELLAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCATAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGANDA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},OMPAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TOMOAONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TUBAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}}}},aUe=({form:e,onLocationChange:t})=>{const[r,n]=K.useState(""),[a,l]=K.useState(""),[h,i]=K.useState(""),[_,w]=K.useState(""),[A,C]=K.useState(""),[R,z]=K.useState(""),U=Object.keys(Kp.municipalities).filter(ue=>ue.toLowerCase().includes(_.toLowerCase())),H=(r?Object.keys(Kp.municipalities[r].barangays):[]).filter(ue=>ue.toLowerCase().includes(A.toLowerCase())),Q=(r&&a?Kp.municipalities[r].barangays[a].puroks:[]).filter(ue=>ue.toLowerCase().includes(R.toLowerCase())),le=ue=>{n(ue),l(""),i(""),w(""),C(""),z(""),e.setValue("municipality",ue),e.setValue("barangay",""),e.setValue("purok",""),e.setValue("province",Kp.region),t&&t({region:Kp.region,municipality:ue,barangay:"",purok:""})},ne=ue=>{l(ue),i(""),C(""),z(""),e.setValue("barangay",ue),e.setValue("purok",""),t&&t({region:Kp.region,municipality:r,barangay:ue,purok:""})},de=ue=>{i(ue),z(""),e.setValue("purok",ue),t&&t({region:Kp.region,municipality:r,barangay:a,purok:ue})};return K.useEffect(()=>{e.setValue("province",Kp.region)},[e]),K.useEffect(()=>{const ue=ve=>{(_||A||R)&&!ve.target.closest(".relative")&&(w(""),C(""),z(""))};return document.addEventListener("mousedown",ue),()=>{document.removeEventListener("mousedown",ue)}},[_,A,R]),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Province"}),f.jsx("div",{className:"mt-1 p-3 bg-muted rounded-md border",children:f.jsx("span",{className:"text-sm font-medium",children:Kp.region})})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Municipality"}),f.jsxs("div",{className:"relative",children:[f.jsx(Fn,{type:"text",placeholder:"Type to search municipality...",value:r||_,onChange:ue=>{const ve=ue.target.value;w(ve),r&&ve!==r&&(n(""),l(""),i(""),e.setValue("municipality",""),e.setValue("barangay",""),e.setValue("purok",""))},className:Gt("mt-1",e.formState.errors.municipality&&"border-red-400")}),_&&f.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:U.length>0?U.map(ue=>f.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>le(ue),children:ue},ue)):f.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No municipalities found"})})]}),e.formState.errors.municipality&&f.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.municipality.message})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Barangay"}),f.jsxs("div",{className:"relative",children:[f.jsx(Fn,{type:"text",placeholder:r?"Type to search barangay...":"Select municipality first",value:a||A,onChange:ue=>{const ve=ue.target.value;C(ve),a&&ve!==a&&(l(""),e.setValue("barangay",""),e.setValue("purok",""))},disabled:!r,className:Gt("mt-1",!r&&"opacity-50 cursor-not-allowed",e.formState.errors.barangay&&"border-red-400")}),r&&A&&f.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:H.length>0?H.map(ue=>f.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ne(ue),children:ue},ue)):f.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No barangays found"})})]}),e.formState.errors.barangay&&f.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.barangay.message})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Purok"}),f.jsxs("div",{className:"relative",children:[f.jsx(Fn,{type:"text",placeholder:a?"Type to search purok...":"Select barangay first",value:h||R,onChange:ue=>{const ve=ue.target.value;z(ve),h&&ve!==h&&(i(""),e.setValue("purok",""))},disabled:!a,className:Gt("mt-1",!a&&"opacity-50 cursor-not-allowed",e.formState.errors.purok&&"border-red-400")}),a&&R&&f.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:Q.length>0?Q.map(ue=>f.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>de(ue),children:ue},ue)):f.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No puroks found"})})]}),e.formState.errors.purok&&f.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.purok.message})]})]})]})},oie=({onSubmit:e,form:t,submitting:r})=>{const n=Ua();return f.jsx($v,{...t,children:f.jsx("form",{id:"driver-form",onSubmit:t.handleSubmit(e),children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(ha,{children:"Vehicle Information"}),f.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-x-3",children:[f.jsx(qn,{control:t.control,name:"plateNo",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No. (comma-separated for multiple)"}),f.jsx(Nn,{children:f.jsx(Fn,{...a,type:"text",placeholder:"ABC-123, DEF-456",value:Array.isArray(a.value)?a.value.join(", "):a.value||"",onChange:l=>{const h=l.target.value,i=h.split(",").map(_=>_.trim()).filter(_=>_.length>0);a.onChange(i.length>0?i:h)},className:Gt("border border-input focus:ring-0",t.formState.errors.plateNo&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"fileNo",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.fileNo&&"text-red-400"),children:"File No. (Optional)"}),f.jsx(Nn,{children:f.jsx(Fn,{...a,type:"text",className:Gt("border border-input focus:ring-0",t.formState.errors.fileNo&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"ownerRepresentativeName",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.ownerRepresentativeName&&"text-red-400"),children:"Owner/Representative Name"}),f.jsx(Nn,{children:f.jsx(Fn,{...a,type:"text",className:Gt("border border-input focus:ring-0",t.formState.errors.ownerRepresentativeName&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})})]})]}),f.jsxs("div",{children:[f.jsx(ha,{children:"Personal Information"}),f.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[f.jsx(qn,{control:t.control,name:"birthDate",render:({field:a})=>f.jsxs(Dn,{className:"lg:col-span-3",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.birthDate&&"text-red-400"),children:"Birthday (Optional)"}),f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsx(Nn,{children:f.jsxs(Ur,{variant:"outline",className:Gt("w-full text-left font-normal justify-start",!a.value&&"text-muted-foreground",t.formState.errors.birthDate&&"border-red-400"),children:[f.jsx(Mh,{className:"h-4 w-4 opacity-50"}),a.value?Vc(a.value,"PPP"):f.jsx("span",{children:"Pick a date"})]})})}),f.jsx($g,{className:"w-auto p-2 space-y-2",align:"start",children:f.jsx(NS,{fieldValue:a.value,dateValue:l=>t.setValue("birthDate",l,{shouldValidate:!0})})})]}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"contactNumber",render:({field:a})=>f.jsxs(Dn,{className:"lg:col-span-3",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.contactNumber&&"text-red-400"),children:"Contact Number (Optional)"}),f.jsx(Nn,{children:f.jsx(Fn,{...a,type:"tel",className:Gt("text-muted-foreground",t.formState.errors.contactNumber&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"emailAddress",render:({field:a})=>f.jsxs(Dn,{className:"lg:col-span-3",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.emailAddress&&"text-red-400"),children:"Email Address (Optional)"}),f.jsx(Nn,{children:f.jsx(Fn,{...a,type:"email",className:Gt("text-muted-foreground",t.formState.errors.emailAddress&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})})]})]}),f.jsxs("div",{children:[f.jsx(ha,{children:"Address"}),f.jsx("div",{className:"mt-4",children:f.jsx(aUe,{form:t,onLocationChange:a=>{console.log("Location changed:",a)}})})]}),f.jsxs("div",{children:[f.jsx(ha,{children:"Driver's License Information"}),f.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[f.jsx(qn,{control:t.control,name:"hasDriversLicense",render:({field:a})=>{var l;return f.jsxs(Dn,{className:"lg:col-span-3",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.hasDriversLicense&&"text-red-400"),children:"Do you have Driver's License?"}),f.jsxs(fs,{onValueChange:h=>a.onChange(h==="true"),value:((l=a.value)==null?void 0:l.toString())||"",children:[f.jsx(Nn,{children:f.jsx(Qo,{className:Gt("text-muted-foreground",t.formState.errors.hasDriversLicense&&"border-red-400"),children:f.jsx(ps,{placeholder:"Choose option"})})}),f.jsx(es,{children:f.jsxs(tre,{children:[f.jsx(Kr,{value:"true",children:"Yes"}),f.jsx(Kr,{value:"false",children:"No"})]})})]}),f.jsx(zn,{className:"text-xs text-red-400"})]})}}),f.jsx(qn,{control:t.control,name:"driversLicenseNumber",render:({field:a})=>f.jsxs(Dn,{className:"lg:col-span-3",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.driversLicenseNumber&&"text-red-400"),children:"Driver's License Number"}),f.jsx(Nn,{children:f.jsx(Fn,{...a,type:"text",className:Gt("text-muted-foreground",t.formState.errors.driversLicenseNumber&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx("div",{className:"lg:col-span-6"})]})]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Ur,{disabled:r,id:"submit",className:"w-20",children:r?f.jsx(Sd,{className:"w-6 h-6 text-primary-foreground mx-auto animate-spin"}):"Submit"}),f.jsx(Ur,{type:"button",variant:"secondary",onClick:()=>n(-1),children:"Cancel"})]})]})})})},oUe=({open:e,onOpenChange:t,onDriverAdded:r})=>{const[n,a]=K.useState(!1),{token:l}=ra(),h=Pu(Date.now()),i=Uh({resolver:$h(lZ),defaultValues:{plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}}),_=async A=>{var C,R;a(!0);try{const z={plateNo:A.plateNo,fileNo:A.fileNo,ownerRepresentativeName:A.ownerRepresentativeName,purok:A.purok,barangay:A.barangay,municipality:A.municipality,province:A.province,contactNumber:A.contactNumber,emailAddress:A.emailAddress,hasDriversLicense:A.hasDriversLicense,driversLicenseNumber:A.driversLicenseNumber};A.birthDate&&(z.birthDate=A.birthDate);const{data:V}=await Bn.post("/driver",z,{headers:{Authorization:l}});V.success&&(Ni.success("Driver has been added",{description:h}),i.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t(!1),r&&r())}catch(z){console.log(z);const V=((R=(C=z.response)==null?void 0:C.data)==null?void 0:R.message)||"Failed to add driver";Ni.error(V,{description:h})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t(A)};return f.jsx(_0,{open:e,onOpenChange:w,children:f.jsxs(qv,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[f.jsxs(Gv,{children:[f.jsxs(Kv,{className:"flex items-center gap-2",children:[f.jsx(AA,{className:"h-5 w-5"}),"Add New Driver"]}),f.jsx(b0,{children:"Fill in the required fields to add a new driver record to the system."})]}),f.jsx("div",{className:"space-y-6",children:f.jsx(oie,{form:i,onSubmit:_,submitting:n})}),f.jsxs(x0,{className:"flex gap-2",children:[f.jsx(Ur,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,children:"Cancel"}),f.jsxs(Ur,{type:"submit",form:"driver-form",disabled:n,className:"flex items-center gap-2",children:[n&&f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Driver"]})]})]})})},sUe=()=>{const[e,t]=K.useState([]),{token:r}=ra(),n=Ua(),a=gs(),[l,h]=K.useState(!0),[i,_]=K.useState(!1),[w,A]=K.useState(""),[C,R]=K.useState(!1);K.useEffect(()=>{z()},[]);const z=async()=>{try{const{data:ue}=await Bn.get("/driver",{headers:{Authorization:r}}),Ae=ue.data.map(Oe=>({_id:Oe._id,plateNo:Oe.plateNo,ownerRepresentativeName:Oe.ownerRepresentativeName,fullname:Oe.fullname,birthDate:Oe.birthDate,contactNumber:Oe.contactNumber,emailAddress:Oe.emailAddress,hasDriversLicense:Oe.hasDriversLicense,driversLicenseNumber:Oe.driversLicenseNumber,isActive:Oe.isActive})).filter(Oe=>Oe.isActive);t(Ae),h(!1)}catch(ue){h(!1),console.log(ue)}},V=async()=>{R(!0)},U=ue=>{n(`/driver/${ue._id}`)},G=ue=>{n(`/driver/${ue}/edit`)},H=()=>{n(`${a.pathname}/inactive`)},J=ue=>{_(!0),A(ue)},Q=()=>{ne(!1),_(!1)},le=()=>{_(!1)},ne=async ue=>{const ve=async()=>{var Ae,Oe;try{return(await Bn.patch(`/driver/${w}`,{isActive:ue},{headers:{Authorization:r}})).data}catch(Se){const ke=((Oe=(Ae=Se.response)==null?void 0:Ae.data)==null?void 0:Oe.message)||"An error occurred";throw new Error(ke)}finally{await z()}};Ni.promise(ve(),{loading:"Loading...",success:"Driver deactivated",error:Ae=>Ae.message||"Failed to update driver"})},de=()=>{z()};return f.jsxs("div",{className:"p-4",children:[f.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Drivers"}),f.jsx("section",{children:f.jsx(NVe,{data:e,filters:["fullname","plateNo","ownerRepresentativeName"],tableColumn:D5e,onAdd:V,loading:l,onRowClick:U,onEdit:G,onDelete:J,onNavigate:H})}),f.jsx(V4,{open:i,onOpenChange:_,confirm:Q,cancel:le,title:"Are you sure?",description:"This action cannot be undone. This will deactivate the driver."}),f.jsx(oUe,{open:C,onOpenChange:R,onDriverAdded:de})]})},lUe={desktop:{label:"Violations",color:"hsl(var(--chart-1))"},mobile:{label:"Accident",color:"hsl(var(--chart-2))"}};function cUe({driverId:e}){const[t,r]=K.useState("all"),[n,a]=K.useState([]),[l,h]=K.useState([]),[i,_]=K.useState(!0),[w,A]=K.useState(null),{token:C}=ra();K.useEffect(()=>{e&&R()},[t,e]);const R=async()=>{try{_(!0),A(null);const{data:V}=await Bn.get(`/dashboard/driver-chart?period=${t}&driverId=${e}`,{headers:{Authorization:C}});if(V.success){const U=V.data.chartData.map(G=>{let H="";return t==="week"?H=new Date(G.year,G.month-1,G.day).toLocaleDateString("en-US",{weekday:"short"}):t==="years"?H=G.year.toString():H=new Date(G.year,G.month-1).toLocaleDateString("en-US",{month:"long"}),{month:H,desktop:G.violations||0,mobile:G.accidents||0}});a(U),h(V.data.violations||[])}}catch(V){console.error("Error fetching driver chart data:",V),A("Failed to load chart data")}finally{_(!1)}},z=V=>{switch(V){case"week":return"Last Week";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"months":return"Last 12 Months";case"year":return"Last Year";case"years":return"Last 5 Years";case"all":return"All Time";default:return"All Time"}};return f.jsxs("div",{className:"p-6",children:[f.jsxs("div",{className:"items-center pb-4",children:[f.jsx("h1",{className:"font-semibold leading-none tracking-tight",children:"Driver Violation & Accidents Overview"}),f.jsxs("p",{className:"text-muted-foreground text-sm",children:["Showing violation and accident frequency for ",z(t)]}),f.jsx("div",{className:"mt-2",children:f.jsxs(fs,{value:t,onValueChange:r,children:[f.jsx(Qo,{className:"w-[180px]",children:f.jsx(ps,{placeholder:"Select time period"})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"week",children:"Last Week"}),f.jsx(Kr,{value:"3months",children:"Last 3 Months"}),f.jsx(Kr,{value:"6months",children:"Last 6 Months"}),f.jsx(Kr,{value:"months",children:"Last 12 Months"}),f.jsx(Kr,{value:"year",children:"Last Year"}),f.jsx(Kr,{value:"years",children:"Last 5 Years"}),f.jsx(Kr,{value:"all",children:"All Time"})]})]})})]}),f.jsx("div",{children:i?f.jsx("div",{className:"flex items-center justify-center h-[250px]",children:f.jsx("div",{className:"text-muted-foreground",children:"Loading chart data..."})}):w?f.jsx("div",{className:"flex items-center justify-center h-[250px]",children:f.jsx("div",{className:"text-red-500",children:w})}):n.length===0?f.jsx("div",{className:"flex items-center justify-center h-[250px]",children:f.jsx("div",{className:"text-muted-foreground",children:"No data available for the selected period"})}):f.jsx(o4,{config:lUe,className:"mx-auto aspect-square max-h-[250px]",children:f.jsxs(i4e,{data:n,margin:{top:-40,bottom:-10},children:[f.jsx(sre,{cursor:!1,content:f.jsx(s4,{indicator:"line"})}),f.jsx(Jv,{dataKey:"month"}),f.jsx(lee,{}),f.jsx(Vx,{dataKey:"desktop",fill:"var(--color-desktop)",fillOpacity:.6}),f.jsx(Vx,{dataKey:"mobile",fill:"var(--color-mobile)"}),f.jsx(B4e,{className:"mt-8",content:f.jsx(lre,{})})]})})}),!i&&!w&&l.length>0&&f.jsxs("div",{className:"mt-6",children:[f.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Violations for ",z(t)]}),f.jsx("div",{className:"flex flex-wrap gap-2 max-h-60 overflow-y-auto scrollbar-transparent",children:l.map((V,U)=>V.violations&&V.violations.length>0?V.violations.map((G,H)=>f.jsx("span",{className:"inline-block bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 text-sm px-3 py-2 rounded-lg font-medium",children:G},`${V._id||U}-${H}`)):null)})]}),!i&&!w&&l.length===0&&f.jsx("div",{className:"mt-6 text-center text-muted-foreground",children:f.jsx("p",{children:"No violations found for the selected period"})})]})}const uUe=Kre({0:"Registration",1:"Violation",2:"Accident"}),dUe=()=>{const e=Jf(),[t,r]=K.useState([]),{token:n,userData:a}=ra(),[l,h]=K.useState(!0);return K.useEffect(()=>{async function i(){try{const{data:_}=await Bn.get(`/logs/${e.id}`,{headers:{Authorization:n}});if(_.success){const w=_.data.map(A=>({id:A._id,fullname:A.driver.fullname,type:uUe.get(A.type),message:A.message,timestamp:Wre(A.createdAt)}));r(w)}}catch(_){console.log(_)}finally{h(!1)}}i()},[]),f.jsxs(Ai,{className:"lg:col-span-3  border md:shadow-none",children:[f.jsx(Ci,{children:f.jsx(Mi,{className:"text-2xl font-bold",children:"Driver Logs"})}),f.jsx(ji,{children:f.jsx(P4,{tableColumn:z5e,data:t})})]})},hUe=()=>{var H,J,Q,le,ne;const e=Jf(),[t,r]=K.useState(!0),{token:n}=ra(),[a,l]=K.useState(),[h,i]=K.useState(!1),[_,w]=K.useState(!1),A=gs(),C=Ua(),R=async()=>{try{const{data:de}=await Bn.get(`/driver/${e.id}`,{headers:{Authorization:n}});de&&l(de.data)}catch(de){de.response.status&&C("/404")}};K.useEffect(()=>{R()},[]);const z=()=>{i(!0)},V=()=>{G(!1),i(!1)},U=()=>{i(!1)},G=async de=>{const ue=e.id;w(!0);const ve=async()=>{var Ae,Oe;try{return(await Bn.patch(`/driver/${ue}`,{isActive:de},{headers:{Authorization:n}})).data}catch(Se){const ke=((Oe=(Ae=Se.response)==null?void 0:Ae.data)==null?void 0:Oe.message)||"An error occurred";throw new Error(ke)}finally{w(!1),C(-1)}};Ni.promise(ve(),{loading:"Loading...",success:"Driver updated successfully",error:Ae=>Ae.message||"Failed to update driver"})};return f.jsxs(f.Fragment,{children:[f.jsxs(Ai,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[f.jsxs(Ci,{className:"border-b",children:[f.jsx(Mi,{className:"text-3xl font-bold",children:a==null?void 0:a.fullname}),f.jsx(Ya,{children:a==null?void 0:a.plateNo})]}),f.jsx(ji,{className:"pt-6",children:f.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[f.jsx("h2",{className:"text-muted-foreground ",children:"Plate No.:"}),f.jsx("p",{className:"font-semibold w-full",children:a==null?void 0:a.plateNo}),f.jsx("h2",{className:"text-muted-foreground ",children:"Owner/Representative Name:"}),f.jsx("p",{className:"font-semibold w-full",children:a==null?void 0:a.ownerRepresentativeName}),f.jsx("h2",{className:"text-muted-foreground ",children:"Date of Birth:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.birthDate?Lv(a.birthDate):"None"}),f.jsx("h2",{className:"text-muted-foreground ",children:"Contact Number:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.contactNumber)||"None"}),f.jsx("h2",{className:"text-muted-foreground ",children:"Email Address:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.emailAddress)||"None"}),f.jsx("h2",{className:"text-muted-foreground ",children:"Has Driver's License:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.hasDriversLicense?"Yes":"No"}),f.jsx("h2",{className:"text-muted-foreground ",children:"Driver's License Number:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.driversLicenseNumber)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground ",children:"Purok:"}),f.jsx("p",{className:"font-semibold w-full",children:((H=a==null?void 0:a.address)==null?void 0:H.purok)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground ",children:"Barangay:"}),f.jsx("p",{className:"font-semibold w-full",children:(J=a==null?void 0:a.address)==null?void 0:J.barangay}),f.jsx("h2",{className:"text-muted-foreground ",children:"Municipality:"}),f.jsx("p",{className:"font-semibold w-full",children:(Q=a==null?void 0:a.address)==null?void 0:Q.municipality}),f.jsx("h2",{className:"text-muted-foreground ",children:"Province:"}),f.jsx("p",{className:"font-semibold w-full",children:(le=a==null?void 0:a.address)==null?void 0:le.province}),f.jsx("h2",{className:"text-muted-foreground ",children:"Region:"}),f.jsx("p",{className:"font-semibold w-full",children:(ne=a==null?void 0:a.address)==null?void 0:ne.region})]})}),f.jsxs(vS,{className:"gap-2 text-sm ",children:[f.jsxs(Ur,{onClick:()=>C(`${A.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[f.jsx(Nc,{}),"Edit"]}),f.jsxs(Ur,{className:"font-semibold border border-destructive bg-red-100 text-destructive hover:bg-red-200/70 dark:bg-red-300 dark:hover:bg-red-300/80",onClick:z,children:[f.jsx(FD,{}),"Deactivate"]})]})]}),f.jsx(V4,{open:h,onOpenChange:i,cancel:U,confirm:V,title:"Are you sure?",description:" This action cannot be undone. This will deactivate the driver"})]})},fUe=()=>{const e=Jf(),t=Ua();return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:f.jsxs(Ur,{variant:"outline",className:"shadow-none",onClick:()=>t(-1),children:[f.jsx(Uw,{})," Back"]})}),f.jsxs("div",{className:"grid lg:grid-cols-3 gap-4  p-4 md:p-0",children:[f.jsx(hUe,{}),f.jsx("div",{className:"row-span-2 border rounded-md  overflow-hidden ",children:f.jsx(cUe,{driverId:e.id})}),f.jsx(dUe,{})]})]})},pUe=()=>{const e=Ua();return f.jsxs("div",{className:"flex flex-col justify-center items-center h-screen",children:[f.jsx("h1",{className:"font-bold text-[80px] md:text-[100px] lg:text-[300px] text-muted-foreground leading-none",children:"404"}),f.jsx("p",{className:"text-lg mb-5",children:"Oops... Page not found."}),f.jsx(Ur,{variant:"outline",size:"lg",onClick:()=>e("/"),children:"Go to Home"})]})},mUe=()=>{const[e,t]=K.useState(!1),{token:r}=ra(),n=Jf(),a=Pu(Date.now()),[l,h]=K.useState({}),i=Ua(),_=Uh({resolver:$h(lZ),defaultValues:{plateNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}}),{reset:w}=_;K.useEffect(()=>{Object.keys(l).length>0&&w(l)},[l,w]),K.useEffect(()=>{A()},[n.id,r]);const A=async()=>{var z,V,U,G,H,J,Q,le,ne,de,ue,ve,Ae,Oe,Se;const R=n.id;try{const{data:ke}=await Bn.get(`/driver/${R}`,{headers:{Authorization:r}});if(ke){const ze={plateNo:(z=ke.data)==null?void 0:z.plateNo,ownerRepresentativeName:(V=ke.data)==null?void 0:V.ownerRepresentativeName,purok:(G=(U=ke.data)==null?void 0:U.address)==null?void 0:G.purok,barangay:(J=(H=ke.data)==null?void 0:H.address)==null?void 0:J.barangay,municipality:(le=(Q=ke.data)==null?void 0:Q.address)==null?void 0:le.municipality,province:((de=(ne=ke.data)==null?void 0:ne.address)==null?void 0:de.province)||"Davao Oriental",contactNumber:(ue=ke.data)==null?void 0:ue.contactNumber,emailAddress:(ve=ke.data)==null?void 0:ve.emailAddress,hasDriversLicense:(Ae=ke.data)==null?void 0:Ae.hasDriversLicense,driversLicenseNumber:(Oe=ke.data)==null?void 0:Oe.driversLicenseNumber,birthDate:new Date((Se=ke.data)==null?void 0:Se.birthDate)};h(ze)}}catch(ke){console.log(ke)}},C=async R=>{t(!0);try{const z={plateNo:R.plateNo,ownerRepresentativeName:R.ownerRepresentativeName,address:{purok:R.purok,barangay:R.barangay,municipality:R.municipality,province:R.province},contactNumber:R.contactNumber,emailAddress:R.emailAddress,hasDriversLicense:R.hasDriversLicense,driversLicenseNumber:R.driversLicenseNumber,birthDate:R.birthDate},{data:V}=await Bn.patch(`/driver/${n.id}`,z,{headers:{Authorization:r}});V.success&&(Ni.success("Driver updated",{description:a}),i(-1))}catch(z){console.log(z);const V=z.response.data.message;Ni.error(V,{description:`${a}`})}finally{t(!1)}};return f.jsx(f.Fragment,{children:f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsx(Mi,{className:"text-xl md:text-3xl font-bold",children:"Edit Driver"}),f.jsx(Ya,{children:"Fill in required fields to edit driver."})]}),f.jsx(ji,{children:f.jsx(oie,{form:_,onSubmit:C,submitting:e})})]})})},gUe=()=>{const[e,t]=K.useState([]),[r,n]=K.useState(!1),[a,l]=K.useState(""),[h,i]=K.useState(!0),_=Ua(),{token:w}=ra();K.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:U}=await Bn.get("/driver",{headers:{Authorization:w}}),H=U.data.map(J=>({_id:J._id,plateNo:J.plateNo,ownerRepresentativeName:J.ownerRepresentativeName,fullname:J.fullname,birthDate:Lv(J.birthDate),contactNumber:J.contactNumber,emailAddress:J.emailAddress,hasDriversLicense:J.hasDriversLicense,driversLicenseNumber:J.driversLicenseNumber,isActive:J.isActive})).filter(J=>J.isActive===!1);t(H),i(!1)}catch(U){i(!1),console.log(U)}},C=U=>{n(!0),l(U)},R=()=>{V(!0),n(!1)},z=()=>{n(!1)},V=async U=>{const G=async()=>{var H,J;try{return(await Bn.patch(`/driver/${a}`,{isActive:U},{headers:{Authorization:w}})).data}catch(Q){const le=((J=(H=Q.response)==null?void 0:H.data)==null?void 0:J.message)||"An error occurred";throw new Error(le)}finally{await A()}};Ni.promise(G(),{loading:"Loading...",success:"Driver activated",error:H=>H.message||"Failed to update driver"})};return f.jsxs("div",{className:"p-4",children:[f.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Deleted Drivers"}),f.jsx("div",{className:" pt-4 md:px-0 md:pt-0",children:f.jsxs(Ur,{variant:"outline",className:"shadow-none",onClick:()=>_(-1),children:[f.jsx(Uw,{})," Back"]})}),f.jsx("section",{children:f.jsx(P4,{data:e,searchPlaceholder:"Search Driver...",filters:["fullname","plateNo","ownerRepresentativeName"],tableColumn:I5e,loading:h,onAction:C})}),f.jsx(V4,{open:r,onOpenChange:n,cancel:z,confirm:R,title:"Are you sure?",description:"This action cannot be undone. This will activate the driver."})]})},yUe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:l,onAdd:h,onEdit:i,onRenewal:_,submitting:w})=>{var de;const[A,C]=Pe.useState([]),[R,z]=Pe.useState([]),[V,U]=Pe.useState({}),[G,H]=Pe.useState({pageIndex:0,pageSize:10}),[J,Q]=Pe.useState(""),le=t,ne=CS({data:n,columns:r(i,w),onSortingChange:C,onColumnFiltersChange:z,onPaginationChange:H,getCoreRowModel:AS(),getPaginationRowModel:PS(),getSortedRowModel:ES(),getFilteredRowModel:TS(),onColumnVisibilityChange:U,onGlobalFilterChange:Q,globalFilterFn:(ue,ve,Ae)=>le.some(Oe=>{const Se=ue.getValue(Oe);return String(Se).toLowerCase().includes(Ae.toLowerCase())}),state:{pagination:G,sorting:A,columnFilters:R,columnVisibility:V,globalFilter:J}});return f.jsxs(f.Fragment,{children:[f.jsx(ha,{className:"font-semibold",children:e}),f.jsxs("div",{className:`md:flex items-center justify-between  py-4
        `,children:[f.jsx(Fn,{placeholder:"Search Vehicle...",value:J??"",onChange:ue=>Q(ue.target.value),className:"hidden h-8 md:inline md:max-w-sm flex-shrink"}),f.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[f.jsxs(Ur,{onClick:h,className:"w-min flex items-center gap-2",children:[f.jsx(Bv,{}),f.jsx("span",{className:"hidden lg:inline",children:"Add Vehicle"})]}),f.jsxs(Ur,{onClick:_,variant:"outline",className:"w-min flex items-center gap-2",children:[f.jsx(Kue,{}),f.jsx("span",{className:"hidden lg:inline",children:"Renewal"})]}),f.jsx(OS,{table:ne})]})]}),f.jsx("div",{className:"rounded-md  border flex-1 overflow-hidden",children:f.jsxs(ty,{children:[f.jsx(ry,{className:"text-xs md:text-sm bg-muted",children:ne.getHeaderGroups().map(ue=>f.jsx(rs,{children:ue.headers.map(ve=>f.jsx(Xo,{children:Xf(ve.column.columnDef.header,ve.getContext())},ve.id))},ue.id))}),f.jsx(ny,{className:"text-xs md:text-sm",children:a?f.jsx(MS,{rowCount:5,cellCount:ne.getAllColumns().length}):(de=ne.getRowModel().rows)!=null&&de.length?ne.getRowModel().rows.map(ue=>f.jsx(rs,{onClick:()=>l(ue.original),"data-state":ue.getIsSelected()&&"selected",children:ue.getVisibleCells().map(ve=>f.jsx(Ba,{children:Xf(ve.column.columnDef.cell,ve.getContext())},ve.id))},ue.id)):f.jsx(rs,{className:"hover:bg-transparent",children:f.jsx(Ba,{colSpan:ne.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),f.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(RS,{table:ne})})]})},vUe=({open:e,onOpenChange:t,onVehicleUpdated:r})=>{const[n,a]=K.useState(""),[l,h]=K.useState(!1),[i,_]=K.useState(null),[w,A]=K.useState(""),[C,R]=K.useState(null),[z,V]=K.useState(!1),[U,G]=K.useState(!1),{token:H}=ra(),J=async()=>{var ue,ve;if(!n.trim()){A("Please enter a plate number");return}h(!0),A(""),_(null);try{const{data:Ae}=await Bn.get(`/vehicle/owner/${n.trim()}`,{headers:{Authorization:H}});Ae.success?(_(Ae.data),R(Ae.data.vehicle.dateOfRenewal?new Date(Ae.data.vehicle.dateOfRenewal):new Date),G(!1)):A(Ae.message||"Failed to fetch vehicle information")}catch(Ae){console.error("Error fetching vehicle data:",Ae),A(((ve=(ue=Ae.response)==null?void 0:ue.data)==null?void 0:ve.message)||"Vehicle not found or error occurred while fetching data")}finally{h(!1)}},Q=()=>{a(""),_(null),A(""),R(null),V(!1),G(!1),t(!1)},le=async()=>{var ue,ve;if(!i||!C){A("Please select a renewal date");return}V(!0),A("");try{const{data:Ae}=await Bn.patch(`/vehicle/${i.vehicle._id}`,{dateOfRenewal:C.toISOString()},{headers:{Authorization:H}});if(Ae.success){G(!0),Ni.success("Vehicle Updated Successfully",{description:`Renewal date updated for ${i.vehicle.plateNo}`});try{const{data:Oe}=await Bn.get(`/vehicle/owner/${n.trim()}`,{headers:{Authorization:H}});Oe.success&&(_(Oe.data),R(Oe.data.vehicle.dateOfRenewal?new Date(Oe.data.vehicle.dateOfRenewal):new Date),r&&r())}catch(Oe){console.error("Error refreshing vehicle data:",Oe)}}else A(Ae.message||"Failed to update renewal date")}catch(Ae){console.error("Error updating renewal date:",Ae),A(((ve=(ue=Ae.response)==null?void 0:ue.data)==null?void 0:ve.message)||"Failed to update renewal date")}finally{V(!1)}},ne=ue=>ue==="1"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",de=ue=>ue==="1"?"Active":"Expired";return f.jsx(_0,{open:e,onOpenChange:t,children:f.jsxs(qv,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[f.jsx(Gv,{children:f.jsxs(Kv,{className:"flex items-center gap-2",children:[f.jsx(Av,{className:"h-5 w-5"}),"Vehicle Renewal Information"]})}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(ha,{htmlFor:"plateNo",children:"Plate Number"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(Fn,{id:"plateNo",placeholder:"Enter plate number (e.g., ABC123)",value:n,onChange:ue=>a(ue.target.value.toUpperCase()),onKeyPress:ue=>ue.key==="Enter"&&J(),className:"flex-1"}),f.jsx(Ur,{onClick:J,disabled:l,className:"px-6",children:l?f.jsx(Sd,{className:"h-4 w-4 animate-spin"}):f.jsx(YK,{className:"h-4 w-4"})})]})]}),w&&f.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:f.jsx("p",{className:"text-sm text-red-600",children:w})}),U&&f.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:f.jsx("p",{className:"text-sm text-green-600",children:"Renewal date updated successfully!"})})]}),i&&f.jsxs("div",{className:"space-y-4",children:[f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsxs(Mi,{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"flex items-center gap-2",children:[f.jsx(Av,{className:"h-4 w-4"}),"Vehicle Information"]}),f.jsx(ac,{className:ne(i.vehicle.status),children:de(i.vehicle.status)})]})}),f.jsx(ji,{className:"space-y-3",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Plate Number"}),f.jsx("p",{className:"text-sm font-semibold",children:i.vehicle.plateNo})]}),f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Make & Model"}),f.jsxs("p",{className:"text-sm",children:[i.vehicle.make," ",i.vehicle.bodyType]})]}),f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Color"}),f.jsx("p",{className:"text-sm",children:i.vehicle.color})]}),f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Last Renewal"}),f.jsx("p",{className:"text-sm",children:i.vehicle.dateOfRenewal?Pu(i.vehicle.dateOfRenewal):"Not set"})]})]})})]}),f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(Mh,{className:"h-4 w-4"}),"Update Renewal Date"]})}),f.jsxs(ji,{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"New Renewal Date"}),f.jsx("div",{className:"mt-2",children:f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsxs(Ur,{variant:"outline",className:Gt("w-full justify-start text-left font-normal",!C&&"text-muted-foreground"),children:[f.jsx(Mh,{className:"mr-2 h-4 w-4"}),C?Pu(C):"Pick a date"]})}),f.jsx($g,{className:"w-auto p-0",align:"start",children:f.jsx(NS,{fieldValue:C,dateValue:R})})]})})]}),f.jsx("div",{className:"flex justify-end",children:f.jsxs(Ur,{onClick:le,disabled:z||!C,className:"flex items-center gap-2",children:[z?f.jsx(Sd,{className:"h-4 w-4 animate-spin"}):f.jsx(Yue,{className:"h-4 w-4"}),z?"Updating...":"Update Renewal Date"]})})]})]}),f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(AA,{className:"h-4 w-4"}),"Owner Information"]})}),f.jsxs(ji,{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Owner Name"}),f.jsx("p",{className:"text-sm font-semibold",children:i.owner.name})]}),i.owner.address&&f.jsxs("div",{children:[f.jsxs(ha,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[f.jsx(T1,{className:"h-3 w-3"}),"Address"]}),f.jsxs("p",{className:"text-sm",children:[i.owner.address.purok&&`${i.owner.address.purok}, `,i.owner.address.barangay,", ",i.owner.address.municipality,f.jsx("br",{}),i.owner.address.province,", ",i.owner.address.region]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.owner.contactNumber&&f.jsxs("div",{children:[f.jsxs(ha,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[f.jsx($ue,{className:"h-3 w-3"}),"Contact Number"]}),f.jsx("p",{className:"text-sm",children:i.owner.contactNumber})]}),i.owner.emailAddress&&f.jsxs("div",{children:[f.jsxs(ha,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[f.jsx(ZK,{className:"h-3 w-3"}),"Email"]}),f.jsx("p",{className:"text-sm",children:i.owner.emailAddress})]})]}),i.owner.driversLicenseNumber&&f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Driver's License"}),f.jsx("p",{className:"text-sm",children:i.owner.driversLicenseNumber})]})]})]}),i.expirationInfo&&f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(Mh,{className:"h-4 w-4"}),"Expiration Information"]})}),f.jsx(ji,{className:"space-y-3",children:f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Expiration Month"}),f.jsx("p",{className:"text-sm font-semibold",children:i.expirationInfo.month})]}),f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Week"}),f.jsxs("p",{className:"text-sm capitalize",children:[i.expirationInfo.week," week"]})]}),f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Expiration Date"}),f.jsx("p",{className:"text-sm",children:i.expirationInfo.expirationDate?Pu(i.expirationInfo.expirationDate):"Not calculated"})]}),f.jsxs("div",{children:[f.jsx(ha,{className:"text-sm font-medium text-gray-600",children:"Status"}),f.jsx(ac,{className:i.expirationInfo.isExpired?"bg-red-100 text-red-800":"bg-green-100 text-green-800",children:i.expirationInfo.isExpired?"Expired":"Active"})]})]})})]})]})]}),f.jsx(x0,{children:f.jsx(Ur,{variant:"outline",onClick:Q,children:"Close"})})]})})},sie=({onSubmit:e,form:t,submitting:r,hideDateOfRenewal:n=!1})=>{const a=Ua();gs();const{token:l}=ra(),[h,i]=K.useState(""),[_,w]=K.useState([]),[A,C]=K.useState(!1),[R,z]=K.useState(null),[V,U]=K.useState(!1);K.useEffect(()=>{const le=setTimeout(async()=>{if(h.length>=2){C(!0),U(!1);try{const{data:ne}=await Bn.get(`/driver/search?name=${encodeURIComponent(h)}`,{headers:{Authorization:l}});ne.success&&(w(ne.data),ne.data.length===0&&h.length>=3&&U(!0))}catch(ne){console.error("Error searching drivers:",ne),w([]),h.length>=3&&U(!0)}finally{C(!1)}}else w([]),U(!1)},300);return()=>clearTimeout(le)},[h,l]);const G=Q=>{z(Q),t.setValue("driver",Q._id),i(Q.ownerRepresentativeName),w([])},H=()=>{z(null),t.setValue("driver",null),i(""),w([]),U(!1)},J=()=>{const Q=t.getValues();sessionStorage.setItem("vehicleFormData",JSON.stringify(Q)),sessionStorage.setItem("driverSearchTerm",h),sessionStorage.setItem("returnToVehicleForm","true"),a("/driver/create")};return K.useEffect(()=>{if(sessionStorage.getItem("returnToVehicleForm")==="true"){const le=sessionStorage.getItem("vehicleFormData"),ne=sessionStorage.getItem("driverSearchTerm"),de=sessionStorage.getItem("newDriverId"),ue=sessionStorage.getItem("newDriverName");if(le){const ve=JSON.parse(le);Object.keys(ve).forEach(Ae=>{ve[Ae]!==void 0&&ve[Ae]!==null&&t.setValue(Ae,ve[Ae])})}ne&&i(ne),de&&ue&&(t.setValue("driver",de),i(ue),z({_id:de,ownerRepresentativeName:ue}),Ni.info("Driver was created successfully. Please complete the vehicle registration.",{description:"The driver has been added to your system. Fill in the remaining vehicle details and submit."})),sessionStorage.removeItem("vehicleFormData"),sessionStorage.removeItem("driverSearchTerm"),sessionStorage.removeItem("returnToVehicleForm"),sessionStorage.removeItem("newDriverId"),sessionStorage.removeItem("newDriverName")}},[t]),f.jsx($v,{...t,children:f.jsx("form",{id:"vehicle-form",onSubmit:t.handleSubmit(e),children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(ha,{children:"Vehicle Information"}),f.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[f.jsx(qn,{control:t.control,name:"plateNo",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",placeholder:"ABC-123",className:Gt("text-muted-foreground",t.formState.errors.plateNo&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"fileNo",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",className:Gt("text-muted-foreground",t.formState.errors.fileNo&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"engineNo",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.engineNo&&"text-red-400"),children:"Engine No."}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",className:Gt("text-muted-foreground",t.formState.errors.engineNo&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})})]})]}),f.jsxs("div",{children:[f.jsx(ha,{children:"Vehicle Details"}),f.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[f.jsx(qn,{control:t.control,name:"chassisNo",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.chassisNo&&"text-red-400"),children:"Chassis No."}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",className:Gt("text-muted-foreground",t.formState.errors.chassisNo&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"make",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.make&&"text-red-400"),children:"Make"}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",className:Gt("text-muted-foreground",t.formState.errors.make&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"bodyType",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.bodyType&&"text-red-400"),children:"Body Type"}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",className:Gt("text-muted-foreground",t.formState.errors.bodyType&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})})]})]}),f.jsxs("div",{children:[f.jsx(ha,{children:"Vehicle Specifications"}),f.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[f.jsx(qn,{control:t.control,name:"color",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.color&&"text-red-400"),children:"Color"}),f.jsx(Nn,{children:f.jsx(Fn,{...Q,type:"text",className:Gt("text-muted-foreground",t.formState.errors.color&&"border-red-400")})}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),f.jsx(qn,{control:t.control,name:"classification",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.classification&&"text-red-400"),children:"Classification"}),f.jsxs(fs,{onValueChange:Q.onChange,defaultValue:Q.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{className:Gt("text-muted-foreground",t.formState.errors.classification&&"border-red-400"),children:f.jsx(ps,{placeholder:"Select classification"})})}),f.jsx(es,{children:f.jsxs(tre,{children:[f.jsx(ire,{children:"Classifications"}),f.jsx(Kr,{value:"Private",children:"Private"}),f.jsx(Kr,{value:"For Hire",children:"For Hire"}),f.jsx(Kr,{value:"Government",children:"Government"})]})})]}),f.jsx(zn,{className:"text-xs text-red-400"})]})}),!n&&f.jsx(qn,{control:t.control,name:"dateOfRenewal",render:({field:Q})=>f.jsxs(Dn,{className:"lg:col-span-2",children:[f.jsx(Ln,{className:Gt("text-muted-foreground",t.formState.errors.dateOfRenewal&&"text-red-400"),children:"Date of Renewal (Optional)"}),f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsx(Nn,{children:f.jsxs(Ur,{variant:"outline",className:Gt("w-full pl-3 text-left font-normal text-muted-foreground",!Q.value&&"text-muted-foreground",t.formState.errors.dateOfRenewal&&"border-red-400"),children:[Q.value?Vc(Q.value,"PPP"):f.jsx("span",{children:"Pick a date"}),f.jsx(Mh,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),f.jsx($g,{className:"w-auto p-0",align:"start",children:f.jsx(NS,{fieldValue:Q.value,dateValue:Q.onChange})})]}),f.jsx(zn,{className:"text-xs text-red-400"})]})})]})]}),f.jsxs("div",{children:[f.jsx(ha,{children:"Driver/Owner Information (Optional)"}),f.jsx("div",{className:"mt-2",children:f.jsx(qn,{control:t.control,name:"driver",render:({field:Q})=>f.jsxs(Dn,{children:[f.jsx(Ln,{className:"text-muted-foreground",children:"Search and Select Driver/Owner"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"flex gap-2",children:f.jsxs("div",{className:"flex-1 relative",children:[f.jsx(Fn,{placeholder:"Type driver/owner name to search...",value:h,onChange:le=>i(le.target.value),className:"pr-10"}),A&&f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:f.jsx(Sd,{className:"h-4 w-4 animate-spin text-muted-foreground"})}),!A&&h&&f.jsx("button",{type:"button",onClick:H,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:f.jsx(P1,{className:"h-4 w-4"})})]})}),(_.length>0||V)&&f.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[_.map(le=>f.jsxs("div",{className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onClick:()=>G(le),children:[f.jsx("div",{className:"font-medium",children:le.ownerRepresentativeName}),f.jsxs("div",{className:"text-sm text-muted-foreground",children:["Birthdate: ",le.birthDate?new Date(le.birthDate).toLocaleDateString():"Not provided"]}),f.jsxs("div",{className:"text-sm text-muted-foreground",children:["Current vehicles: ",le.plateNo||"None"]})]},le._id)),V&&_.length===0&&f.jsxs("div",{className:"p-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 bg-blue-25",onClick:J,children:[f.jsxs("div",{className:"font-medium text-blue-600",children:['+ Add "',h,'" as new driver']}),f.jsx("div",{className:"text-sm text-blue-500",children:"Click to create a new driver record"})]})]}),R&&f.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-md",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"font-medium text-green-800",children:["Selected: ",R.ownerRepresentativeName]}),f.jsxs("div",{className:"text-sm text-green-600",children:["Birthdate: ",R.birthDate?new Date(R.birthDate).toLocaleDateString():"Not provided"]}),f.jsxs("div",{className:"text-sm text-green-600",children:["Current vehicles: ",R.plateNo||"None"]})]}),f.jsx(Ur,{type:"button",variant:"ghost",size:"sm",onClick:H,className:"text-green-600 hover:text-green-800",children:f.jsx(P1,{className:"h-4 w-4"})})]})})]}),f.jsx(zn,{className:"text-xs text-red-400"})]})})})]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Ur,{disabled:r,id:"submit",className:"w-20",children:r?f.jsx(Sd,{className:"w-6 h-6 text-primary-foreground mx-auto animate-spin"}):"Submit"}),f.jsx(Ur,{type:"button",variant:"secondary",onClick:()=>a(-1),children:"Cancel"})]})]})})})},_Ue=({open:e,onOpenChange:t,onVehicleAdded:r})=>{const[n,a]=K.useState(!1),{token:l}=ra(),h=Pu(Date.now()),i=Uh({resolver:$h(cZ),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}}),_=async A=>{var C,R;a(!0);try{const z={plateNo:A.plateNo,fileNo:A.fileNo,engineNo:A.engineNo,chassisNo:A.chassisNo,make:A.make,bodyType:A.bodyType,color:A.color,classification:A.classification,driver:A.driver};A.dateOfRenewal&&(z.dateOfRenewal=A.dateOfRenewal);const{data:V}=await Bn.post("/vehicle",z,{headers:{Authorization:l}});V.success&&(Ni.success("Vehicle has been added",{description:h}),i.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(!1),r&&r())}catch(z){console.log(z);const V=((R=(C=z.response)==null?void 0:C.data)==null?void 0:R.message)||"Failed to add vehicle";Ni.error(V,{description:h})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(A)};return f.jsx(_0,{open:e,onOpenChange:w,children:f.jsxs(qv,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[f.jsxs(Gv,{children:[f.jsxs(Kv,{className:"flex items-center gap-2",children:[f.jsx(Av,{className:"h-5 w-5"}),"Add New Vehicle"]}),f.jsx(b0,{children:"Fill in the required fields to add a new vehicle record to the system."})]}),f.jsx("div",{className:"space-y-6",children:f.jsx(sie,{form:i,onSubmit:_,submitting:n})}),f.jsxs(x0,{className:"flex gap-2",children:[f.jsx(Ur,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,children:"Cancel"}),f.jsxs(Ur,{type:"submit",form:"vehicle-form",disabled:n,className:"flex items-center gap-2",children:[n&&f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Vehicle"]})]})]})})},xUe=()=>{const[e,t]=K.useState([]),{token:r}=ra(),n=Ua();gs();const[a,l]=K.useState(!0);Pu(Date.now());const[h,i]=K.useState(!1),[_,w]=K.useState(!1),[A,C]=K.useState(!1);K.useEffect(()=>{R()},[]);const R=async()=>{try{const{data:Q}=await Bn.get("/vehicle",{headers:{Authorization:r}}),le=Q.data.map(ne=>({_id:ne._id,plateNo:ne.plateNo,fileNo:ne.fileNo,engineNo:ne.engineNo,chassisNo:ne.chassisNo,make:ne.make,bodyType:ne.bodyType,color:ne.color,classification:ne.classification,dateOfRenewal:ne.dateOfRenewal,status:ne.status}));t(le)}catch(Q){console.log(Q)}finally{l(!1)}},z=async()=>{C(!0)},V=Q=>{const le=Q._id;n(`/vehicle/${le}`)},U=Q=>{n(`/vehicle/${Q}/edit`)},G=()=>{w(!0)},H=()=>{R()},J=()=>{R()};return f.jsxs("div",{className:"p-4",children:[f.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Vehicles"}),f.jsx("section",{children:f.jsx(yUe,{data:e,filters:["plateNo","fileNo","engineNo","chassisNo","make","bodyType","color","classification","status"],tableColumn:B5e,onAdd:z,loading:a,onRowClick:V,onEdit:U,onRenewal:G,submitting:h})}),f.jsx(vUe,{open:_,onOpenChange:w,onVehicleUpdated:H}),f.jsx(_Ue,{open:A,onOpenChange:C,onVehicleAdded:J})]})},bUe=()=>{const e=Jf(),[t,r]=K.useState(!0),{token:n}=ra(),[a,l]=K.useState(),[h,i]=K.useState(!1),[_,w]=K.useState(!1),A=gs(),C=Ua(),R=async()=>{try{r(!0);const{data:z}=await Bn.get(`/vehicle/${e.id}`,{headers:{Authorization:n}});z&&l(z.data)}catch(z){console.error("Error fetching vehicle:",z),Ni.error("Failed to load vehicle data")}finally{r(!1)}};return K.useEffect(()=>{R()},[]),t?f.jsx(Ai,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:f.jsx(ji,{className:"p-6",children:f.jsx("div",{className:"flex items-center justify-center",children:f.jsx("div",{className:"text-muted-foreground",children:"Loading vehicle data..."})})})}):f.jsx(f.Fragment,{children:f.jsxs(Ai,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[f.jsxs(Ci,{className:"border-b",children:[f.jsx(Mi,{className:"text-3xl font-bold",children:a!=null&&a.make?Dj(a.make):"N/A"}),f.jsx(Ya,{children:(a==null?void 0:a.plateNo)||"N/A"})]}),f.jsx(ji,{className:"p-0 pb-6",children:f.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[f.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Vehicle Information"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate Number:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"File Number:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.fileNo)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Engine Number:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.engineNo)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Chassis Number:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.chassisNo)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Make:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.make?Dj(a.make):"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Body Type:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.bodyType)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Color:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.color?Dj(a.color):"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Classification:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.classification)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Date of Renewal:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.dateOfRenewal?Lv(a.dateOfRenewal):"Not set"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Status:"}),f.jsx("p",{className:"font-semibold w-full",children:f.jsx("span",{className:`px-2 py-1 rounded text-xs ${(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"Active":"Expired"})})]})}),f.jsx(vS,{className:"gap-2 text-sm ",children:f.jsxs(Ur,{onClick:()=>C(`${A.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[f.jsx(Nc,{}),"Edit"]})})]})})},wUe=()=>{const e=Ua();return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:f.jsxs(Ur,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[f.jsx(Uw,{})," Back"]})}),f.jsx("div",{className:"p-4 md:p-0",children:f.jsx(bUe,{})})]})},SUe=()=>{const[e,t]=K.useState(!1),{token:r}=ra(),n=Jf(),a=Pu(Date.now()),[l,h]=K.useState({}),i=Ua(),_=Uh({resolver:$h(cZ),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0}}),{reset:w}=_;K.useEffect(()=>{Object.keys(l).length>0&&w(l)},[l,w]),K.useEffect(()=>{A()},[n.id,r]);const A=async()=>{var z,V,U,G,H,J,Q,le;const R=n.id;try{const{data:ne}=await Bn.get(`/vehicle/${R}`,{headers:{Authorization:r}});if(ne){const de={plateNo:(z=ne.data)==null?void 0:z.plateNo,fileNo:(V=ne.data)==null?void 0:V.fileNo,engineNo:(U=ne.data)==null?void 0:U.engineNo,chassisNo:(G=ne.data)==null?void 0:G.chassisNo,make:(H=ne.data)==null?void 0:H.make,bodyType:(J=ne.data)==null?void 0:J.bodyType,color:(Q=ne.data)==null?void 0:Q.color,classification:(le=ne.data)==null?void 0:le.classification};h(de)}}catch(ne){console.log(ne)}},C=async R=>{var z,V;t(!0);try{const U={plateNo:R.plateNo,fileNo:R.fileNo,engineNo:R.engineNo,chassisNo:R.chassisNo,make:R.make,bodyType:R.bodyType,color:R.color,classification:R.classification},{data:G}=await Bn.patch(`/vehicle/${n.id}`,U,{headers:{Authorization:r}});G.success&&(Ni.success("Vehicle updated",{description:a}),i(-1))}catch(U){console.log(U);const G=((V=(z=U.response)==null?void 0:z.data)==null?void 0:V.message)||"An error occurred";Ni.error(G,{description:`${a}`})}finally{t(!1)}};return f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsx(Mi,{className:"text-xl md:text-3xl font-bold",children:"Edit Vehicle"}),f.jsx(Ya,{children:"Fill in required fields to edit vehicle."})]}),f.jsx(ji,{children:f.jsx(sie,{form:_,onSubmit:C,submitting:e,hideDateOfRenewal:!0})})]})},AUe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:l,onAdd:h,onEdit:i,onUpdateStatus:_,submitting:w})=>{var de;const[A,C]=Pe.useState([]),[R,z]=Pe.useState([]),[V,U]=Pe.useState({}),[G,H]=Pe.useState({pageIndex:0,pageSize:10}),[J,Q]=Pe.useState(""),le=t,ne=CS({data:n,columns:r(i,_,w),onSortingChange:C,onColumnFiltersChange:z,onPaginationChange:H,getCoreRowModel:AS(),getPaginationRowModel:PS(),getSortedRowModel:ES(),getFilteredRowModel:TS(),onColumnVisibilityChange:U,onGlobalFilterChange:Q,globalFilterFn:(ue,ve,Ae)=>le.some(Oe=>{const Se=ue.getValue(Oe);return String(Se).toLowerCase().includes(Ae.toLowerCase())}),state:{pagination:G,sorting:A,columnFilters:R,columnVisibility:V,globalFilter:J}});return f.jsxs(f.Fragment,{children:[f.jsx(ha,{className:"font-semibold",children:e}),f.jsxs("div",{className:"md:flex items-center justify-between py-4",children:[f.jsx(Fn,{placeholder:"Search Violation...",value:J??"",onChange:ue=>Q(ue.target.value),className:"hidden h-8 md:inline md:max-w-sm flex-shrink"}),f.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[f.jsxs(Ur,{onClick:h,className:"w-min flex items-center gap-2",children:[f.jsx(Bv,{}),f.jsx("span",{className:"hidden lg:inline",children:"Add Violation"})]}),f.jsx(OS,{table:ne})]})]}),f.jsx("div",{className:"rounded-md border flex-1 overflow-hidden",children:f.jsxs(ty,{children:[f.jsx(ry,{className:"text-xs md:text-sm bg-muted",children:ne.getHeaderGroups().map(ue=>f.jsx(rs,{children:ue.headers.map(ve=>f.jsx(Xo,{children:Xf(ve.column.columnDef.header,ve.getContext())},ve.id))},ue.id))}),f.jsx(ny,{className:"text-xs md:text-sm",children:a?f.jsx(MS,{rowCount:5,cellCount:ne.getAllColumns().length}):(de=ne.getRowModel().rows)!=null&&de.length?ne.getRowModel().rows.map(ue=>f.jsx(rs,{onClick:()=>l(ue.original),"data-state":ue.getIsSelected()&&"selected",children:ue.getVisibleCells().map(ve=>f.jsx(Ba,{children:Xf(ve.column.columnDef.cell,ve.getContext())},ve.id))},ue.id)):f.jsx(rs,{className:"hover:bg-transparent",children:f.jsx(Ba,{colSpan:ne.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),f.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(RS,{table:ne})})]})},lie=({form:e,onSubmit:t,submitting:r})=>{const n=Ua(),[a,l]=K.useState([]);qH({control:e.control,name:"violationType",defaultValue:"confiscated"}),K.useEffect(()=>{a.length===0&&(l([""]),e.setValue("violations",[""]))},[a.length,e]);const h=()=>{l([...a,""])},i=A=>{if(a.length>1){const C=a.filter((R,z)=>z!==A);l(C),e.setValue("violations",C)}},_=(A,C)=>{const R=[...a];R[A]=C,l(R),e.setValue("violations",R)},w=A=>{console.log("=== FORM COMPONENT SUBMIT ==="),console.log("Form submitted with data:",A),console.log("Form state:",e.formState),console.log("Form errors:",e.formState.errors),t(A)};return f.jsx($v,{...e,children:f.jsxs("form",{id:"violation-form",onSubmit:e.handleSubmit(w),className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(qn,{control:e.control,name:"topNo",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"TOP NO."}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"TOP-0001",...A})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"violationType",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Violation Type"}),f.jsxs(fs,{onValueChange:A.onChange,defaultValue:A.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select violation type"})})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"confiscated",children:"Confiscated"}),f.jsx(Kr,{value:"alarm",children:"Alarm"}),f.jsx(Kr,{value:"impounded",children:"Impounded"})]})]}),f.jsx(zn,{})]})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Apprehension Details"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(qn,{control:e.control,name:"firstName",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"First Name"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"John",...A})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"middleInitial",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Middle Initial"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"D",maxLength:1,...A})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"lastName",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Last Name"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Doe",...A})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"suffix",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Suffix"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Jr.",...A})}),f.jsx(zn,{})]})})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Violations"}),f.jsxs("div",{className:"space-y-2",children:[a.map((A,C)=>f.jsxs("div",{className:"flex gap-2",children:[f.jsx(Fn,{placeholder:`Violation ${C+1}`,value:A,onChange:R=>_(C,R.target.value)}),a.length>1&&f.jsx(Ur,{type:"button",variant:"outline",size:"icon",onClick:()=>i(C),children:f.jsx(P1,{className:"h-4 w-4"})})]},C)),f.jsxs(Ur,{type:"button",variant:"outline",onClick:h,className:"w-full",children:[f.jsx(Bv,{className:"h-4 w-4 mr-2"}),"Add Violation"]})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"License Type"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(qn,{control:e.control,name:"licenseType",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"License Type"}),f.jsxs(fs,{onValueChange:A.onChange,defaultValue:A.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select license type"})})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"SP",children:"SP (Student Permit)"}),f.jsx(Kr,{value:"DL",children:"DL (Driver's License)"}),f.jsx(Kr,{value:"CL",children:"CL (Commercial License)"}),f.jsx(Kr,{value:"plate",children:"Plate"}),f.jsx(Kr,{value:"sp receipt",children:"SP Receipt"}),f.jsx(Kr,{value:"dl receipt",children:"DL Receipt"}),f.jsx(Kr,{value:"refuse to sur.",children:"Refuse to Sur."}),f.jsx(Kr,{value:"dl tempor",children:"DL Tempor"})]})]}),f.jsx(zn,{})]})}),f.jsx("div",{})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Vehicle Details"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(qn,{control:e.control,name:"plateNo",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Plate No."}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"ABC-1234",...A})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"chassisNo",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Chassis No. (Optional)"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Chassis Number",...A})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"engineNo",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Engine No. (Optional)"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Engine Number",...A})}),f.jsx(zn,{})]})})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Apprehension Information"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(qn,{control:e.control,name:"dateOfApprehension",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Date of Apprehension"}),f.jsx(Nn,{children:f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsx(Nn,{children:f.jsxs(Ur,{variant:"outline",className:Gt("w-full pl-3 text-left font-normal",!A.value&&"text-muted-foreground"),children:[A.value?Vc(A.value,"PPP"):f.jsx("span",{children:"Pick a date"}),f.jsx(Mh,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),f.jsx($g,{className:"w-auto p-0",align:"start",children:f.jsx(NS,{fieldValue:A.value,dateValue:A.onChange})})]})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"apprehendingOfficer",render:({field:A})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Apprehending Officer"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Officer Name",...A})}),f.jsx(zn,{})]})})]})]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Ur,{type:"submit",disabled:r,onClick:()=>{console.log("=== SUBMIT BUTTON CLICKED ==="),console.log("Form state:",e.formState),console.log("Form errors:",e.formState.errors),console.log("Form values:",e.getValues())},children:r?"Submitting...":"Submit"}),f.jsx(Ur,{type:"button",variant:"secondary",onClick:()=>n(-1),children:"Cancel"})]})]})})},TUe=({open:e,onOpenChange:t,onViolationAdded:r})=>{const[n,a]=K.useState(!1),{token:l}=ra(),h=Pu(Date.now()),i=Uh({resolver:$h(dZ),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),_=async A=>{var C,R;a(!0);try{const z={topNo:A.topNo,firstName:A.firstName,middleInitial:A.middleInitial,lastName:A.lastName,suffix:A.suffix,violations:A.violations,violationType:A.violationType,licenseType:A.licenseType,plateNo:A.plateNo,apprehendingOfficer:A.apprehendingOfficer,chassisNo:A.chassisNo,engineNo:A.engineNo};A.dateOfApprehension&&(z.dateOfApprehension=A.dateOfApprehension);const{data:V}=await Bn.post("/violations",z,{headers:{Authorization:l}});V.success&&(Ni.success("Violation has been added",{description:h}),i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(!1),r&&r())}catch(z){console.log(z);const V=((R=(C=z.response)==null?void 0:C.data)==null?void 0:R.message)||"Failed to add violation";Ni.error(V,{description:h})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(A)};return f.jsx(_0,{open:e,onOpenChange:w,children:f.jsxs(qv,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[f.jsxs(Gv,{children:[f.jsxs(Kv,{className:"flex items-center gap-2",children:[f.jsx(ux,{className:"h-5 w-5"}),"Add New Violation"]}),f.jsx(b0,{children:"Fill in the required fields to add a new violation record to the system."})]}),f.jsx("div",{className:"space-y-6",children:f.jsx(lie,{form:i,onSubmit:_,submitting:n})}),f.jsxs(x0,{className:"flex gap-2",children:[f.jsx(Ur,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,children:"Cancel"}),f.jsxs(Ur,{type:"submit",form:"violation-form",disabled:n,className:"flex items-center gap-2",children:[n&&f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Violation"]})]})]})})},PUe=()=>{const[e,t]=K.useState([]),{token:r}=ra(),n=Ua();gs();const[a,l]=K.useState(!0),[h,i]=K.useState(!1),[_,w]=K.useState(!1);K.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:U}=await Bn.get("/violations",{headers:{Authorization:r}}),G=U.data.map(H=>({_id:H._id,topNo:H.topNo||"N/A",firstName:H.firstName||"N/A",middleInitial:H.middleInitial||"",lastName:H.lastName||"N/A",suffix:H.suffix||"",violations:H.violations||[],violationType:H.violationType||"confiscated",licenseType:H.licenseType||null,plateNo:H.plateNo||"N/A",dateOfApprehension:H.dateOfApprehension,apprehendingOfficer:H.apprehendingOfficer||"N/A"}));t(G)}catch(U){console.log(U)}finally{l(!1)}},C=()=>{w(!0)},R=U=>{const G=U._id;n(`/violation/${G}`)},z=U=>{n(`/violation/${U}/edit`)},V=()=>{A()};return f.jsxs("div",{className:"p-4",children:[f.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Violations"}),f.jsx("section",{children:f.jsx(AUe,{data:e,filters:["topNo","firstName","lastName","violations","violationType","licenseType","plateNo","dateOfApprehension","apprehendingOfficer"],tableColumn:L5e,onAdd:C,loading:a,onRowClick:R,onEdit:z,onUpdateStatus:()=>{},submitting:h})}),f.jsx(TUe,{open:_,onOpenChange:w,onViolationAdded:V})]})},EUe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:l,onAdd:h,onEdit:i,onUpdateStatus:_,submitting:w})=>{var de;const[A,C]=Pe.useState([]),[R,z]=Pe.useState([]),[V,U]=Pe.useState({}),[G,H]=Pe.useState({pageIndex:0,pageSize:10}),[J,Q]=Pe.useState(""),le=t,ne=CS({data:n,columns:r(i,_,w),onSortingChange:C,onColumnFiltersChange:z,onPaginationChange:H,getCoreRowModel:AS(),getPaginationRowModel:PS(),getSortedRowModel:ES(),getFilteredRowModel:TS(),onColumnVisibilityChange:U,onGlobalFilterChange:Q,globalFilterFn:(ue,ve,Ae)=>le.some(Oe=>{const Se=ue.getValue(Oe);return String(Se).toLowerCase().includes(Ae.toLowerCase())}),state:{pagination:G,sorting:A,columnFilters:R,columnVisibility:V,globalFilter:J}});return f.jsxs(f.Fragment,{children:[f.jsx(ha,{className:"font-semibold",children:e}),f.jsxs("div",{className:"md:flex items-center justify-between py-4",children:[f.jsx(Fn,{placeholder:"Search Accident...",value:J??"",onChange:ue=>Q(ue.target.value),className:"hidden h-8 md:inline md:max-w-sm flex-shrink"}),f.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[f.jsxs(Ur,{onClick:h,className:"w-min flex items-center gap-2",children:[f.jsx(Bv,{}),f.jsx("span",{className:"hidden lg:inline",children:"Add Accident"})]}),f.jsx(OS,{table:ne})]})]}),f.jsx("div",{className:"rounded-md border flex-1 overflow-hidden",children:f.jsxs(ty,{children:[f.jsx(ry,{className:"text-xs md:text-sm bg-muted",children:ne.getHeaderGroups().map(ue=>f.jsx(rs,{children:ue.headers.map(ve=>f.jsx(Xo,{children:Xf(ve.column.columnDef.header,ve.getContext())},ve.id))},ue.id))}),f.jsx(ny,{className:"text-xs md:text-sm",children:a?f.jsx(MS,{rowCount:5,cellCount:ne.getAllColumns().length}):(de=ne.getRowModel().rows)!=null&&de.length?ne.getRowModel().rows.map(ue=>f.jsx(rs,{onClick:()=>l(ue.original),"data-state":ue.getIsSelected()&&"selected",children:ue.getVisibleCells().map(ve=>f.jsx(Ba,{children:Xf(ve.column.columnDef.cell,ve.getContext())},ve.id))},ue.id)):f.jsx(rs,{className:"hover:bg-transparent",children:f.jsx(Ba,{colSpan:ne.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:f.jsxs("div",{className:"flex flex-col items-center justify-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),f.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})}),f.jsx("div",{className:"mt-4",children:f.jsx(RS,{table:ne})})]})},cie=K.forwardRef(({className:e,...t},r)=>f.jsx("textarea",{className:Gt("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));cie.displayName="Textarea";const uie=({form:e,onSubmit:t,submitting:r})=>{const n=Ua();return f.jsx($v,{...e,children:f.jsxs("form",{id:"accident-form",onSubmit:e.handleSubmit(t),className:"space-y-4",children:[f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.jsx(qn,{control:e.control,name:"accident_id",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Accident ID"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"ACC-0001",...a})}),f.jsx(zn,{})]})})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(qn,{control:e.control,name:"plateNo",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Plate No."}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter vehicle plate number",...a})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"accident_date",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Accident Date"}),f.jsx(Nn,{children:f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsx(Nn,{children:f.jsxs(Ur,{variant:"outline",className:Gt("w-full text-left font-normal justify-start",!a.value&&"text-muted-foreground"),children:[f.jsx(Mh,{className:"h-4 w-4 opacity-50"}),a.value?Vc(a.value,"PPP"):f.jsx("span",{children:"Pick a date"})]})})}),f.jsx($g,{className:"w-auto p-2 space-y-2",align:"start",children:f.jsx(NS,{fieldValue:a.value,dateValue:l=>e.setValue("accident_date",l,{shouldValidate:!0})})})]})}),f.jsx(zn,{})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(qn,{control:e.control,name:"street",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Street"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Street",...a})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"barangay",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Barangay"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Barangay",...a})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"municipality",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Municipality"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Municipality",...a})}),f.jsx(zn,{})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(qn,{control:e.control,name:"vehicle_type",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Vehicle Type"}),f.jsxs(fs,{onValueChange:a.onChange,defaultValue:a.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select vehicle type"})})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"motorcycle",children:"Motorcycle"}),f.jsx(Kr,{value:"car",children:"Car"}),f.jsx(Kr,{value:"truck",children:"Truck"}),f.jsx(Kr,{value:"bus",children:"Bus"}),f.jsx(Kr,{value:"van",children:"Van"}),f.jsx(Kr,{value:"jeepney",children:"Jeepney"}),f.jsx(Kr,{value:"tricycle",children:"Tricycle"}),f.jsx(Kr,{value:"other",children:"Other"})]})]}),f.jsx(zn,{})]})}),f.jsx(qn,{control:e.control,name:"severity",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Severity"}),f.jsxs(fs,{onValueChange:a.onChange,defaultValue:a.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select severity"})})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"minor",children:"Minor"}),f.jsx(Kr,{value:"moderate",children:"Moderate"}),f.jsx(Kr,{value:"severe",children:"Severe"}),f.jsx(Kr,{value:"fatal",children:"Fatal"})]})]}),f.jsx(zn,{})]})})]}),f.jsx(qn,{control:e.control,name:"notes",render:({field:a})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Notes"}),f.jsx(Nn,{children:f.jsx(cie,{placeholder:"Enter additional notes about the accident...",className:"resize-none",rows:3,...a})}),f.jsx(zn,{})]})}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(Ur,{type:"submit",disabled:r,children:r?"Submitting...":"Submit"}),f.jsx(Ur,{type:"button",variant:"secondary",onClick:()=>n(-1),children:"Cancel"})]})]})})},CUe=({open:e,onOpenChange:t,onAccidentAdded:r})=>{const[n,a]=K.useState(!1),{token:l}=ra(),h=Pu(Date.now()),i=Uh({resolver:$h(uZ),defaultValues:{accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}}),_=async A=>{var C,R;a(!0);try{const z={accident_id:A.accident_id,plateNo:A.plateNo,accident_date:A.accident_date?A.accident_date.toISOString():null,street:A.street,barangay:A.barangay,municipality:A.municipality,vehicle_type:A.vehicle_type,severity:A.severity,notes:A.notes};console.log("Sending accident data:",z);const{data:V}=await Bn.post("/accident",z,{headers:{Authorization:l}});V.success&&(Ni.success("Accident has been added",{description:h}),i.reset({accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}),t(!1),r&&r())}catch(z){const V=((R=(C=z==null?void 0:z.response)==null?void 0:C.data)==null?void 0:R.message)||"Failed to add accident";Ni.error(V,{description:h})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}),t(A)};return f.jsx(_0,{open:e,onOpenChange:w,children:f.jsxs(qv,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[f.jsxs(Gv,{children:[f.jsxs(Kv,{className:"flex items-center gap-2",children:[f.jsx(ux,{className:"h-5 w-5"}),"Add New Accident"]}),f.jsx(b0,{children:"Fill in the required fields to add a new accident record to the system."})]}),f.jsx("div",{className:"space-y-6",children:f.jsx(uie,{form:i,onSubmit:_,submitting:n})}),f.jsxs(x0,{className:"flex gap-2",children:[f.jsx(Ur,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,children:"Cancel"}),f.jsxs(Ur,{type:"submit",form:"accident-form",disabled:n,className:"flex items-center gap-2",children:[n&&f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Accident"]})]})]})})},MUe=()=>{const[e,t]=K.useState([]),{token:r}=ra(),n=Ua();gs();const[a,l]=K.useState(!0),[h,i]=K.useState(!1),[_,w]=K.useState(!1);K.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:U}=await Bn.get("/accident",{headers:{Authorization:r}}),G=U.data.map(H=>({_id:H._id,accident_id:H.accident_id,plateNo:H.plateNo||"N/A",accident_date:Lv(H.accident_date),street:H.street,barangay:H.barangay,municipality:H.municipality,vehicle_type:H.vehicle_type||"N/A",severity:H.severity||"N/A",notes:H.notes||""}));t(G)}catch(U){console.log(U)}finally{l(!1)}},C=()=>{w(!0)},R=U=>{const G=U._id;n(`/accident/${G}`)},z=U=>{n(`/accident/${U}/edit`)},V=()=>{A()};return f.jsxs("div",{className:"p-4",children:[f.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Accidents"}),f.jsx("section",{children:f.jsx(EUe,{data:e,filters:["accident_id","plateNo","accident_date","street","barangay","municipality","vehicle_type","severity"],tableColumn:N5e,onAdd:C,loading:a,onRowClick:R,onEdit:z,onUpdateStatus:()=>{},submitting:h})}),f.jsx(CUe,{open:_,onOpenChange:w,onAccidentAdded:V})]})},OUe=()=>{const e=Jf(),[t,r]=K.useState(!0),{token:n}=ra(),[a,l]=K.useState(),h=gs(),i=Ua(),_=async()=>{try{const{data:w}=await Bn.get(`/accident/${e.id}`,{headers:{Authorization:n}});w&&l(w.data)}catch{}r(!1)};return K.useEffect(()=>{_()},[]),t?f.jsx("div",{children:"Loading..."}):f.jsxs(Ai,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[f.jsxs(Ci,{className:"border-b",children:[f.jsxs(Mi,{className:"text-3xl font-bold",children:["Accident #",(a==null?void 0:a.accident_id)||"Details"]}),f.jsx(Ya,{children:(a==null?void 0:a.description)||"No description available."})]}),f.jsx(ji,{className:"p-0 pb-6",children:f.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[f.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Accident Information"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Date:"}),f.jsx("p",{className:"font-semibold w-full",children:Lv(a==null?void 0:a.accident_date)}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Location:"}),f.jsx("p",{className:"font-semibold w-full",children:`${(a==null?void 0:a.street)||""}, ${(a==null?void 0:a.barangay)||""}, ${(a==null?void 0:a.municipality)||""}`}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate No:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Vehicle Type:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.vehicle_type)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Severity:"}),f.jsx("p",{className:"font-semibold w-full",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(a==null?void 0:a.severity)==="minor"?"text-green-600 bg-green-100":(a==null?void 0:a.severity)==="moderate"?"text-yellow-600 bg-yellow-100":(a==null?void 0:a.severity)==="severe"?"text-orange-600 bg-orange-100":(a==null?void 0:a.severity)==="fatal"?"text-red-600 bg-red-100":"text-gray-600 bg-gray-100"}`,children:(a==null?void 0:a.severity)||"N/A"})}),(a==null?void 0:a.notes)&&f.jsxs(f.Fragment,{children:[f.jsx("h2",{className:"text-muted-foreground px-6",children:"Notes:"}),f.jsx("p",{className:"font-semibold w-full col-span-2",children:a.notes})]}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Last Edited:"}),f.jsx("p",{className:"font-semibold w-full",children:Lv(a==null?void 0:a.time_edited)})]})}),f.jsx(vS,{className:"gap-2 text-sm ",children:f.jsxs(Ur,{onClick:()=>i(`${h.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[f.jsx(Nc,{}),"Edit"]})})]})},RUe=()=>{const e=Ua();return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:f.jsxs(Ur,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[f.jsx(Uw,{})," Back"]})}),f.jsx("div",{className:"p-4 md:p-0",children:f.jsx(OUe,{})})]})},kUe=()=>{const[e,t]=K.useState(!1),{token:r}=ra(),n=Jf(),a=Pu(Date.now()),l=Ua(),h=Uh({resolver:$h(uZ),defaultValues:{accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}}),{reset:i}=h;K.useEffect(()=>{_()},[n.id,r]);const _=async()=>{const A=n.id;try{const{data:C}=await Bn.get(`/accident/${A}`,{headers:{Authorization:r}});if(C!=null&&C.data){const R=C.data;i({accident_id:R.accident_id,plateNo:R.plateNo||"",accident_date:new Date(R.accident_date),street:R.street,barangay:R.barangay,municipality:R.municipality,vehicle_type:R.vehicle_type||"",severity:R.severity||"",notes:R.notes||""})}}catch(C){console.log(C)}},w=async A=>{var C,R;t(!0);try{const z={accident_id:A.accident_id,plateNo:A.plateNo,accident_date:A.accident_date?A.accident_date.toISOString():null,street:A.street,barangay:A.barangay,municipality:A.municipality,vehicle_type:A.vehicle_type,severity:A.severity,notes:A.notes},{data:V}=await Bn.patch(`/accident/${n.id}`,z,{headers:{Authorization:r}});V.success&&(Ni.success("Accident updated",{description:a}),l(-1))}catch(z){const V=((R=(C=z==null?void 0:z.response)==null?void 0:C.data)==null?void 0:R.message)||"Failed to update accident";Ni.error(V,{description:`${a}`})}finally{t(!1)}};return f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsx(Mi,{className:"text-xl md:text-3xl font-bold",children:"Edit Accident"}),f.jsx(Ya,{children:"Update accident details."})]}),f.jsx(ji,{children:f.jsx(uie,{form:h,onSubmit:w,submitting:e})})]})},jUe=()=>{const e=Jf(),[t,r]=K.useState(!0),{token:n}=ra(),[a,l]=K.useState(),h=gs(),i=Ua(),_=async()=>{try{const{data:w}=await Bn.get(`/violations/${e.id}`,{headers:{Authorization:n}});w&&l(w.data)}catch{}r(!1)};return K.useEffect(()=>{_()},[]),t?f.jsx("div",{children:"Loading..."}):f.jsxs(Ai,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[f.jsxs(Ci,{className:"border-b",children:[f.jsxs(Mi,{className:"text-3xl font-bold",children:["TOP #",(a==null?void 0:a.topNo)||"Details"]}),f.jsx(Ya,{children:(a==null?void 0:a.remarks)||"No remarks available."})]}),f.jsx(ji,{className:"p-0 pb-6",children:f.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[f.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Apprehension Details"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Name:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.firstName&&(a!=null&&a.lastName)?`${a.firstName}${a.middleInitial?` ${a.middleInitial}.`:""} ${a.lastName}${a.suffix?` ${a.suffix}`:""}`:"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Violations:"}),f.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.violations&&Array.isArray(a.violations)?a.violations.join(", "):"N/A"}),f.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1 mt-4",children:"Confiscated Item"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"License Type:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.licenseType)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate No:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Date of Apprehension:"}),f.jsx("p",{className:"font-semibold w-full",children:Lv(a==null?void 0:a.dateOfApprehension)}),f.jsx("h2",{className:"text-muted-foreground px-6",children:"Apprehending Officer:"}),f.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.apprehendingOfficer)||"N/A"})]})}),f.jsx(vS,{className:"gap-2 text-sm ",children:f.jsxs(Ur,{onClick:()=>i(`${h.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[f.jsx(Nc,{}),"Edit"]})})]})},NUe=()=>{const e=Ua();return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:f.jsxs(Ur,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[f.jsx(Uw,{})," Back"]})}),f.jsx("div",{className:"p-4 md:p-0",children:f.jsx(jUe,{})})]})},IUe=()=>{const[e,t]=K.useState(!1),{token:r}=ra(),n=Jf(),a=Pu(Date.now()),l=Ua(),h=Uh({resolver:$h(dZ),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),{reset:i}=h;K.useEffect(()=>{_()},[n.id,r]);const _=async()=>{const A=n.id;try{const{data:C}=await Bn.get(`/violations/${A}`,{headers:{Authorization:r}});if(C!=null&&C.data){const R=C.data,z=R.violationType||"confiscated";i({topNo:R.topNo||"",firstName:R.firstName||"",middleInitial:R.middleInitial||"",lastName:R.lastName||"",suffix:R.suffix||"",violations:R.violations||[""],violationType:z,licenseType:R.licenseType||void 0,plateNo:R.plateNo||"",dateOfApprehension:R.dateOfApprehension?new Date(R.dateOfApprehension):void 0,apprehendingOfficer:R.apprehendingOfficer||""})}}catch(C){console.log(C)}},w=async A=>{var C,R;t(!0);try{const z={topNo:A.topNo,violationType:A.violationType,plateNo:A.plateNo,dateOfApprehension:A.dateOfApprehension,apprehendingOfficer:A.apprehendingOfficer};A.violationType==="confiscated"?(z.firstName=A.firstName,z.middleInitial=A.middleInitial,z.lastName=A.lastName,z.suffix=A.suffix,z.violations=A.violations?A.violations.filter(U=>U.trim()!==""):[],z.licenseType=A.licenseType):A.violationType==="impounded"?(z.firstName=A.firstName,z.middleInitial=A.middleInitial,z.lastName=A.lastName,z.suffix=A.suffix,z.violations=A.violations?A.violations.filter(U=>U.trim()!==""):[],z.licenseType=null):A.violationType==="alarm"&&(z.firstName=null,z.middleInitial=null,z.lastName=null,z.suffix=null,z.violations=null,z.licenseType=null);const{data:V}=await Bn.patch(`/violations/${n.id}`,z,{headers:{Authorization:r}});V.success&&(Ni.success("Violation updated",{description:a}),l(-1))}catch(z){const V=((R=(C=z==null?void 0:z.response)==null?void 0:C.data)==null?void 0:R.message)||"Failed to update violation";Ni.error(V,{description:`${a}`})}finally{t(!1)}};return f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsx(Mi,{className:"text-xl md:text-3xl font-bold",children:"Edit Violation"}),f.jsx(Ya,{children:"Update violation details."})]}),f.jsx(ji,{children:f.jsx(lie,{form:h,onSubmit:w,submitting:e})})]})},DUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Bn.get("/dashboard/registration-analytics",{params:r})).data}catch(r){throw console.error("Error fetching registration analytics:",r),r}},SE=e=>["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(e)+1,LUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Bn.get("/dashboard/municipality-registration-totals",{params:r})).data}catch(r){throw console.error("Error fetching municipality registration totals:",r),r}},zUe=async(e,t=null,r=null)=>{try{const n={municipality:e};return t&&(n.month=t),r&&(n.year=r),(await Bn.get("/dashboard/barangay-registration-totals",{params:n})).data}catch(n){throw console.error("Error fetching barangay registration totals:",n),n}},FUe=async(e=null,t=null,r=null)=>{try{const n={};return e&&(n.startYear=e),t&&(n.endYear=t),r&&(n.municipality=r),(await Bn.get("/dashboard/yearly-vehicle-trends",{params:n})).data}catch(n){throw console.error("Error fetching yearly vehicle trends:",n),n}},BUe=async(e,t=null)=>{try{const r={year:e};return t&&(r.municipality=t),(await Bn.get("/dashboard/monthly-vehicle-trends",{params:r})).data}catch(r){throw console.error("Error fetching monthly vehicle trends:",r),r}},VUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Bn.get("/dashboard/owner-municipality-data",{params:r})).data}catch(r){throw console.error("Error fetching owner municipality data:",r),r}},UUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await Bn.get("/dashboard/vehicle-classification-data",{params:r})).data}catch(r){throw console.error("Error fetching vehicle classification data:",r),r}},$Ue=({isOpen:e,onClose:t,municipality:r,selectedMonth:n,selectedYear:a,municipalitiesList:l=[]})=>{var et,je;const[h,i]=K.useState([]),[_,w]=K.useState(!1),[A,C]=K.useState(null),[R,z]=K.useState("desc"),[V,U]=K.useState(!1),[G,H]=K.useState(!1),[J,Q]=K.useState(0),[le,ne]=K.useState("right"),[de,ue]=K.useState(!1);K.useEffect(()=>{if(e&&r&&l.length>0){const Ne=l.findIndex(Ye=>Ye.municipality===r);Q(Ne>=0?Ne:0)}},[e,r,l]),K.useEffect(()=>{e&&r&&ve()},[e,r,n,a]),K.useEffect(()=>{H(!!e)},[e]);const ve=async(Ne=r)=>{try{w(!0),C(null);let Ye=null,$e=null;n&&n!=="All"&&(Ye=["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(n)+1),a&&a!=="All"&&($e=a),console.log("Fetching barangay data for",Ne,"with:",{monthNumber:Ye,yearValue:$e,selectedMonth:n,selectedYear:a});const We=await zUe(Ne,Ye,$e);i(We.data||[])}catch(Ye){console.error("Error fetching barangay data:",Ye),C("Error loading barangay data")}finally{w(!1)}},Ae=()=>{J>0&&(ne("left"),ue(!0),setTimeout(()=>{const Ne=J-1;Q(Ne);const Ye=l[Ne].municipality;ve(Ye),setTimeout(()=>ue(!1),100)},200))},Oe=()=>{J<l.length-1&&(ne("right"),ue(!0),setTimeout(()=>{const Ne=J+1;Q(Ne);const Ye=l[Ne].municipality;ve(Ye),setTimeout(()=>ue(!1),100)},200))},Se=Ne=>Ne.toLocaleString(),ke=()=>{U(!0),z(Ne=>Ne==="desc"?"asc":"desc"),setTimeout(()=>U(!1),300)},ze=[...h].sort((Ne,Ye)=>R==="desc"?Ye.vehicles-Ne.vehicles:Ne.vehicles-Ye.vehicles);return e?f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4",children:f.jsxs("div",{className:`bg-gray-100 border border-gray-200/50 rounded-2xl p-4 sm:p-6 w-full max-w-4xl h-[90vh] sm:h-[85vh] overflow-hidden dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] dark:!border-[#2A2A3E]/50 dark:!shadow-2xl flex flex-col transition-all duration-500 ease-out transform ${G?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-4"}`,children:[f.jsxs("div",{className:"bg-gray-100 dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] border-b border-gray-200/50 dark:border-gray-700/30 pb-4 mb-4 flex-shrink-0",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-4",children:[f.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[f.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl shadow-lg",children:f.jsxs("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("path",{d:"M3 3v18h18"}),f.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),f.jsx("path",{d:"M16 5l3 3-3 3"})]})}),f.jsxs("div",{className:"flex items-center gap-3",children:[l.length>1&&f.jsx(f.Fragment,{children:f.jsx("button",{onClick:Ae,disabled:J===0,className:`p-2 rounded-xl transition-all duration-300 transform ${J===0?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Previous Municipality",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})}),f.jsxs("div",{className:"overflow-hidden",children:[f.jsx("h2",{className:`text-xl sm:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent dark:from-blue-400 dark:to-purple-400 transition-all duration-500 ease-in-out ${de?le==="left"?"opacity-0 transform translate-x-4 scale-95":"opacity-0 transform -translate-x-4 scale-95":"opacity-100 transform translate-x-0 scale-100"}`,children:((et=l[J])==null?void 0:et.municipality)||r}),f.jsxs("p",{className:`text-sm text-muted-foreground mt-1 transition-all duration-500 ease-in-out ${de?"opacity-0 transform translate-y-2":"opacity-100 transform translate-y-0"}`,children:["Barangay Registration Data",a==="All"&&n&&n!=="All"&&f.jsxs("span",{className:"ml-2 text-xs",children:["(",n," across all years)"]})]})]}),l.length>1&&f.jsx("button",{onClick:Oe,disabled:J===l.length-1,className:`p-2 rounded-xl transition-all duration-300 transform ${J===l.length-1?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Next Municipality",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),f.jsx("button",{onClick:t,className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-all duration-200 hover:scale-105",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[f.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-3 border border-blue-200/50 dark:border-blue-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-md flex items-center justify-center",children:f.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),f.jsx("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Total Barangays"})]}),f.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:h.length})]}),f.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-3 border border-green-200/50 dark:border-green-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-md flex items-center justify-center",children:f.jsxs("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0M15 17a2 2 0 104 0"})]})}),f.jsx("div",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Total Vehicles"})]}),f.jsx("div",{className:"text-xl font-bold text-green-900 dark:text-green-100",children:Se(h.reduce((Ne,Ye)=>Ne+Ye.vehicles,0))})]}),f.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-xl p-3 border border-orange-200/50 dark:border-orange-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded-md flex items-center justify-center",children:f.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),f.jsx("div",{className:"text-xs font-medium text-orange-700 dark:text-orange-300",children:"Zero Registrations"})]}),f.jsx("div",{className:"text-xl font-bold text-orange-900 dark:text-orange-100",children:h.filter(Ne=>Ne.vehicles===0).length})]})]})]}),f.jsx("div",{className:"overflow-y-auto flex-1 scrollbar-hide overflow-x-hidden min-h-0",children:f.jsx("div",{className:`transition-all duration-500 ease-in-out ${de?le==="left"?"opacity-0 transform translate-x-6 scale-98":"opacity-0 transform -translate-x-6 scale-98":"opacity-100 transform translate-x-0 scale-100"}`,children:_?f.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):A?f.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-red-500",children:f.jsx("p",{children:A})}):h.length===0?f.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-muted-foreground",children:f.jsxs("p",{children:["No barangay data available for ",((je=l[J])==null?void 0:je.municipality)||r]})}):f.jsx("div",{children:f.jsx("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-2xl border border-gray-200/50 dark:border-gray-700/30 overflow-hidden min-h-[400px] overflow-x-auto",children:f.jsxs("table",{className:"w-full min-w-[600px]",children:[f.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:"Barangay Name"}),f.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 select-none",onClick:ke,children:f.jsxs("div",{className:"flex items-center gap-2",children:["Total Registered Vehicles",f.jsxs("div",{className:"flex flex-col",children:[f.jsx("svg",{className:`w-3 h-3 ${R==="desc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),f.jsx("svg",{className:`w-3 h-3 ${R==="asc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})]})}),f.jsx("tbody",{className:"bg-white dark:bg-gray-800/30 divide-y divide-gray-200/50 dark:divide-gray-700/30",children:ze.map((Ne,Ye)=>{const $e=Ne.vehicles===0;return f.jsxs("tr",{className:`hover:bg-gray-50/80 dark:hover:bg-gray-700/50 transition-all duration-200 ${$e?"bg-gradient-to-r from-red-50/80 to-red-100/50 dark:from-red-900/20 dark:to-red-800/10 border-l-4 border-red-500":""}`,style:{animation:`smoothFadeIn 0.6s ease-out ${Ye*.03}s both`},children:[f.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center mr-4 shadow-sm ${$e?"bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900/40 dark:to-red-800/40":"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/40"}`,children:f.jsx("span",{className:`text-sm font-bold ${$e?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"}`,children:Ye+1})}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`text-base font-semibold ${$e?"text-red-800 dark:text-red-200":"text-gray-800 dark:text-gray-200"}`,children:Ne.barangay}),$e&&f.jsx("span",{className:"px-3 py-1 text-xs font-semibold bg-gradient-to-r from-red-100 to-red-200 text-red-800 dark:from-red-900/40 dark:to-red-800/40 dark:text-red-200 rounded-full shadow-sm",children:"No Registrations"})]})]})}),f.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:f.jsx("div",{className:`text-lg font-bold ${$e?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-200"}`,children:Se(Ne.vehicles)})})]},Ne.barangay)})})]})})})})})]})}):null},qUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=K.useState([]),[l,h]=K.useState(!1),[i,_]=K.useState(null),[w,A]=K.useState(!1),[C,R]=K.useState("desc"),[z,V]=K.useState(!1),[U,G]=K.useState(!1),[H,J]=K.useState(null),[Q,le]=K.useState(!1);K.useEffect(()=>{const ze=()=>{le(window.innerWidth<640)};return ze(),window.addEventListener("resize",ze),()=>window.removeEventListener("resize",ze)},[]);const ne=async()=>{try{h(!0),_(null);let ze=null,et=null;e&&e!=="All"&&(ze=SE(e)),t&&t!=="All"&&(et=t),console.log("Fetching municipality data with:",{monthNumber:ze,yearValue:et,selectedMonth:e,selectedYear:t}),console.log("Title condition check:",{selectedYear:t,selectedMonth:e,yearIsAll:t==="All",monthIsNotAll:e!=="All",shouldShowSuffix:t==="All"&&e&&e!=="All"});const je=await LUe(ze,et);console.log("Municipality data response:",je),je.success?a(je.data):(_("Failed to fetch municipality data"),a([]))}catch(ze){console.error("Error fetching municipality data:",ze),_("Error loading municipality data")}finally{h(!1)}};K.useEffect(()=>{ne(),V(!1)},[]),K.useEffect(()=>{ne(),V(!1)},[e,t]);const de=[...n].sort((ze,et)=>C==="asc"?ze.vehicles-et.vehicles:et.vehicles-ze.vehicles),ue=de.slice(0,5);console.log("Municipality data processing:",{rawData:n,sortedData:de,top5:ue,hasData:n.length>0}),K.useEffect(()=>{if(n.length>0){const ze=setTimeout(()=>V(!0),100);return()=>clearTimeout(ze)}},[n]);const ve=ze=>ze.map((et,je)=>({name:et.municipality,vehicles:et.vehicles,index:je,totalCount:ze.length})),Ae=(ze,et)=>{if(C==="asc"){if(ze<5)return ze===0?"#dc2626":ze===1?"#ea580c":ze===2?"#d97706":ze===3?"#ca8a04":"#eab308";if(ze>=5&&ze<et-5)return"#84cc16";if(ze>=et-5)return ze===et-1?"#1d4ed8":ze===et-2?"#2563eb":ze===et-3?"#3b82f6":ze===et-4?"#60a5fa":"#93c5fd"}else{if(ze<5)return ze===0?"#1d4ed8":ze===1?"#2563eb":ze===2?"#3b82f6":ze===3?"#60a5fa":"#93c5fd";if(ze>=5&&ze<et-5)return"#84cc16";if(ze>=et-5)return ze===et-1?"#dc2626":ze===et-2?"#ea580c":ze===et-3?"#d97706":ze===et-4?"#ca8a04":"#eab308"}return"#3b82f6"},Oe=({active:ze,payload:et,label:je})=>{if(ze&&et&&et.length){const Ne=et[0].value,Ye=de.length>0?(Ne/Math.max(...de.map($e=>$e.vehicles))*100).toFixed(1):0;return f.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-blue-500 to-purple-500"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:je}),f.jsxs("p",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[f.jsx("span",{className:"font-semibold text-lg",children:Ne.toLocaleString()})," vehicles"]}),f.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:[Ye,"% of highest"]})]})]})})}return null},Se=ze=>{J(ze),G(!0)},ke=()=>{G(!1),J(null)};return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-gray-100 border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent min-h-[400px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("path",{d:"M3 3v18h18"}),f.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),f.jsx("path",{d:"M16 5l3 3-3 3"})]})}),f.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["DavOr Vehicle Registration Rankings",t==="All"&&e&&e!=="All"&&f.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&f.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("button",{onClick:()=>R(C==="asc"?"desc":"asc"),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors flex items-center gap-1",title:`Sort ${C==="asc"?"Highest to Lowest":"Lowest to Highest"}`,children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:C==="asc"?f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"}):f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}),C==="asc"?"":""]}),f.jsx("button",{onClick:()=>A(!0),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors",children:"View All"})]})]}),f.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[l||r?f.jsx("div",{className:"flex items-center justify-center w-full h-full",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:f.jsx("p",{children:i})}):ue.length===0?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:f.jsx("p",{children:"No data available"})}):f.jsx(Qs,{width:"100%",height:"100%",minHeight:320,children:f.jsxs(Eh,{data:ve(ue),margin:{top:10,right:10,left:5,bottom:20},barCategoryGap:"10%",children:[f.jsx(js,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),f.jsx(lo,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:20,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:ze=>ze.length>12?ze.substring(0,12)+"...":ze}),f.jsx(co,{stroke:"#6b7280",fontSize:9,tickFormatter:ze=>ze.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:50}),f.jsx(wa,{content:f.jsx(Oe,{})}),f.jsx(Ro,{dataKey:"vehicles",radius:[8,8,0,0],onClick:ze=>Se(ze.name),style:{cursor:"pointer"},maxBarSize:120,children:ve(ue).map((ze,et)=>{const je=Ae(ze.index,ze.totalCount);return f.jsx(hm,{fill:je,stroke:je,strokeWidth:2,style:{filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15))",transition:"all 0.3s ease"}},`cell-${et}`)})})]})}),ue.length>0&&f.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:Q?"10px":"12px",fontWeight:"200",paddingTop:"0px",paddingBottom:"4px",textAlign:"center"},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-700"}),f.jsx("span",{children:"High"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),f.jsx("span",{children:"Medium-high"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),f.jsx("span",{children:"Medium"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),f.jsx("span",{children:"Low"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),f.jsx("span",{children:"Lowest"})]})]})]})]}),w&&f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 border border-gray-200 rounded-xl p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden shadow-2xl dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsxs("svg",{className:"w-6 h-6 text-foreground",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("path",{d:"M3 3v18h18"}),f.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),f.jsx("path",{d:"M16 5l3 3-3 3"})]})}),f.jsxs("h2",{className:"text-2xl font-bold text-foreground",children:["All Municipalities",t==="All"&&e&&e!=="All"&&f.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&f.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]})]}),f.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-muted rounded-md transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsx("div",{className:"h-[500px]",children:f.jsx(Qs,{width:"100%",height:"100%",minHeight:320,children:f.jsxs(Eh,{data:ve(de),margin:{top:20,right:10,left:10,bottom:60},barCategoryGap:"5%",children:[f.jsx(js,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),f.jsx(lo,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:5,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:ze=>ze.length>12?ze.substring(0,12)+"...":ze}),f.jsx(co,{stroke:"#6b7280",fontSize:12,tickFormatter:ze=>ze.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:60}),f.jsx(wa,{content:f.jsx(Oe,{})}),f.jsx(Ro,{dataKey:"vehicles",radius:[6,6,0,0],onClick:ze=>Se(ze.name),style:{cursor:"pointer"},maxBarSize:80,children:ve(de).map((ze,et)=>{const je=Ae(ze.index,ze.totalCount);return f.jsx(hm,{fill:je,stroke:je,strokeWidth:1.5,style:{filter:"drop-shadow(0 3px 6px rgba(0, 0, 0, 0.12))",transition:"all 0.3s ease"}},`cell-${et}`)})})]})})})]})}),f.jsx($Ue,{isOpen:U,onClose:ke,municipality:H,selectedMonth:e,selectedYear:t,municipalitiesList:de})]})},GUe=()=>{const[e,t]=K.useState([]),[r,n]=K.useState(!1);K.useEffect(()=>{const tt=()=>{n(window.innerWidth<640)};return tt(),window.addEventListener("resize",tt),()=>window.removeEventListener("resize",tt)},[]),K.useEffect(()=>{const tt=document.createElement("style");return tt.textContent=`
      .scrollbar-hide {
        -ms-overflow-style: none;  /* Internet Explorer 10+ */
        scrollbar-width: none;  /* Firefox */
      }
      .scrollbar-hide::-webkit-scrollbar { 
        display: none;  /* Safari and Chrome */
      }
    `,document.head.appendChild(tt),()=>{document.head.removeChild(tt)}},[]);const[a,l]=K.useState(!1),[h,i]=K.useState(null),[_,w]=K.useState(!1),[A,C]=K.useState(!1),[R,z]=K.useState(""),[V,U]=K.useState(""),[G,H]=K.useState(!1),[J,Q]=K.useState("year"),[le,ne]=K.useState(!1),[de,ue]=K.useState(""),[ve,Ae]=K.useState(()=>localStorage.getItem("vehicleTrendMunicipality")||"All"),[Oe,Se]=K.useState(!1),ke=new Date().getFullYear(),ze=["All","BAGANGA","BANAYBANAY","BOSTON","CARAGA","CATEEL","GOVERNOR GENEROSO","LUPON","MANAY","SAN ISIDRO","TARRAGONA","CITY OF MATI"],et=async(tt,Qt,gr=null)=>{try{l(!0),i(null);const sr=gr||ve;console.log("Fetching yearly trend data with:",{startYear:tt,endYear:Qt,municipality:sr});const ur=await FUe(tt,Qt,sr);if(console.log("Yearly trend data response:",ur),ur.success){const br=ur.data.map(Wt=>Wt.total===0?{...Wt,total:0,active:0,expired:0,noRegistration:0}:{...Wt,noRegistration:null});t(br)}else i("Failed to fetch yearly trend data"),t([])}catch(sr){console.error("Error fetching yearly trend data:",sr),i("Error loading yearly trend data")}finally{l(!1)}},je=async(tt,Qt=null)=>{try{l(!0),i(null);const gr=Qt||ve;console.log("Fetching monthly trend data for year:",tt,"municipality:",gr);const sr=await BUe(tt,gr);if(console.log("Monthly trend data response:",sr),sr.success){const ur=sr.data.map(br=>br.total===0?{...br,total:0,active:0,expired:0,noRegistration:0}:{...br,noRegistration:null});t(ur)}else i("Failed to fetch monthly trend data"),t([])}catch(gr){console.error("Error fetching monthly trend data:",gr),i("Error loading monthly trend data")}finally{l(!1)}},Ne=()=>{w(!0)},Ye=()=>{const tt=parseInt(R),Qt=parseInt(V);if(i(null),!tt||!Qt){i("Please enter both start and end years");return}if(tt<2e3){i(`Start year ${tt} is too early. Please enter a year from 2000 onwards`);return}if(Qt>ke){i(`End year ${Qt} is in the future. Please enter a year up to ${ke}`);return}if(tt>Qt){i(`Start year ${tt} cannot be later than end year ${Qt}`);return}H(!0),localStorage.setItem("vehicleTrendCustomStartYear",tt.toString()),localStorage.setItem("vehicleTrendCustomEndYear",Qt.toString()),localStorage.setItem("vehicleTrendIsCustomRange","true"),J==="year"&&et(tt,Qt,ve),C(!1)},$e=()=>{H(!1),z(""),U(""),i(null),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),J==="year"&&et(ke-4,ke,ve),C(!1)},We=tt=>{Q(tt),localStorage.setItem("vehicleTrendViewType",tt),tt==="year"?(H(!1),z(""),U(""),et(ke-4,ke,ve),w(!1)):tt==="month"?(ne(!0),w(!1)):tt==="customRange"&&w(!1)},Et=tt=>{ue(tt),localStorage.setItem("vehicleTrendSelectedYear",tt),i(null),ne(!1),je(tt,ve)},Je=tt=>{Ae(tt),localStorage.setItem("vehicleTrendMunicipality",tt),Se(!1),J==="year"?G&&R&&V?et(parseInt(R),parseInt(V),tt):et(ke-4,ke,tt):J==="month"&&de&&je(de,tt)};K.useEffect(()=>{const tt=localStorage.getItem("vehicleTrendMunicipality")||"All";et(ke-4,ke,tt),localStorage.setItem("vehicleTrendViewType","year"),localStorage.removeItem("vehicleTrendSelectedYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear")},[]),K.useEffect(()=>{const tt=Qt=>{_&&!Qt.target.closest(".filter-dropdown")&&w(!1)};return document.addEventListener("mousedown",tt),()=>{document.removeEventListener("mousedown",tt)}},[_]),K.useEffect(()=>{J==="month"&&!de&&(Q("year"),H(!1),z(""),U(""),et(ke-4,ke,ve))},[J,de]);const ht=({active:tt,payload:Qt,label:gr})=>tt&&Qt&&Qt.length?f.jsxs("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-blue-500 to-purple-500"}),f.jsxs("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:[" ",gr]})]}),Qt.filter(sr=>sr.value!==null).map((sr,ur)=>{const br=Qt.some(Wt=>Wt.dataKey==="noRegistration"&&Wt.value===0);return f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:sr.color}}),f.jsxs("p",{className:"text-sm",children:[f.jsxs("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[sr.dataKey==="total"?"Total":sr.dataKey==="active"?"Active":sr.dataKey==="expired"?"Expired":"No Registration",":"]}),f.jsx("span",{className:"ml-2 text-blue-600 dark:text-blue-400 font-semibold",children:sr.dataKey==="noRegistration"?"No Data":br&&sr.value===0?"No Registration":sr.value.toLocaleString()})]})]},ur)})]}):null;return f.jsxs("div",{className:"bg-gray-100 border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent min-h-[400px] flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsxs("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("path",{d:"M3 3v18h18"}),f.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),f.jsx("path",{d:"M16 5l3 3-3 3"})]})}),f.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["Vehicle Registration Trends",f.jsxs("span",{className:"text-muted-foreground font-normal ml-2",style:{fontSize:"10px"},children:[J==="year"?G?`By Year (${R}-${V})`:"By Year (Last 5 Years)":`By Month (${de||"Select Year"})`,ve!=="All"&&f.jsxs("span",{className:"text-primary font-medium",children:[" ",ve]})]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative",children:[f.jsx("button",{onClick:Ne,className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Filter options",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),_&&f.jsx("div",{className:"filter-dropdown absolute right-0 top-full mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:f.jsxs("div",{className:"p-2",children:[f.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"View Type"}),f.jsx("button",{onClick:()=>We("year"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${J==="year"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Year"}),f.jsx("button",{onClick:()=>We("month"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${J==="month"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Month"}),f.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 my-1"}),f.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"Date Range"}),f.jsx("button",{onClick:()=>{w(!1),C(!0)},className:"w-full text-left px-2 py-2 text-sm rounded-md transition-colors text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Custom Range"})]})})]}),f.jsx("button",{onClick:()=>Se(!0),className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Location options",children:f.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),f.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[a?f.jsx("div",{className:"flex items-center justify-center w-full h-full",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):h?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:f.jsx("p",{children:h})}):e.length===0?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:f.jsx("p",{children:"No data available"})}):f.jsx(Qs,{width:"100%",height:"100%",minHeight:320,children:f.jsxs(n4,{data:e,margin:{top:10,right:20,left:0,bottom:20},children:[f.jsx(js,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),f.jsx(lo,{dataKey:J==="year"?"year":"month",stroke:"#6b7280",fontSize:r?10:12,tick:{fill:"#6b7280",fontWeight:500},angle:r?-45:0,textAnchor:r?"end":"middle",height:r?60:30}),f.jsx(co,{stroke:"#6b7280",fontSize:r?10:12,tickFormatter:tt=>tt.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:r?60:80}),f.jsx(wa,{content:f.jsx(ht,{})}),f.jsx(_u,{type:"monotone",dataKey:"total",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2},name:"Total Vehicles"}),f.jsx(_u,{type:"monotone",dataKey:"active",stroke:"#10b981",strokeWidth:4,dot:{fill:"#10b981",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#10b981",strokeWidth:2},name:"Active Vehicles"}),f.jsx(_u,{type:"monotone",dataKey:"expired",stroke:"#ef4444",strokeWidth:3,dot:{fill:"#ef4444",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#ef4444",strokeWidth:2},name:"Expired Vehicles"}),f.jsx(_u,{type:"monotone",dataKey:"noRegistration",stroke:"#9ca3af",strokeWidth:2,strokeDasharray:"5 5",dot:{fill:"#9ca3af",strokeWidth:2,r:3},activeDot:{r:5,stroke:"#9ca3af",strokeWidth:2},name:"No Registration",connectNulls:!1})]})}),e.length>0&&f.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:r?"10px":"12px",fontWeight:"200",paddingTop:"0px",textAlign:"center"},children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),f.jsx("span",{children:"Total Vehicles"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),f.jsx("span",{children:"Active Vehicles"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),f.jsx("span",{children:"Expired Vehicles"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-500"}),f.jsx("span",{children:"No Registration"})]})]})]}),A&&f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Filter Date Range"})]}),f.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Year"}),f.jsx("input",{type:"number",value:R,onChange:tt=>z(tt.target.value),placeholder:"e.g., 2020",min:"2000",max:ke,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Year"}),f.jsx("input",{type:"number",value:V,onChange:tt=>U(tt.target.value),placeholder:"e.g., 2025",min:"2000",max:ke,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]})]}),h&&f.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:f.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:h})}),f.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[f.jsx("button",{onClick:Ye,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply Filter"}),f.jsx("button",{onClick:$e,className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Reset"})]}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:"Default range: Last 5 years (2021 - 2025)"})]})]})}),le&&f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),f.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Select Year for Monthly View"})]}),f.jsx("button",{onClick:()=>ne(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:f.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter a year to view monthly vehicle registration trends:"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Year"}),f.jsx("input",{type:"number",value:de,onChange:tt=>ue(tt.target.value),placeholder:"e.g., 2025",min:"2000",max:ke,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",onKeyPress:tt=>{if(tt.key==="Enter"){const Qt=parseInt(de);Qt>=2e3&&Qt<=ke&&Et(Qt)}}})]}),h&&f.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:f.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:h})}),f.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[f.jsx("button",{onClick:()=>{const tt=parseInt(de);tt>=2e3&&tt<=ke?Et(tt):i(`Please enter a valid year between 2000 and ${ke}`)},className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply"}),f.jsx("button",{onClick:()=>ne(!1),className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Cancel"})]}),f.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:["Available years: 2000 - ",ke]})]})]})}),Oe&&f.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:f.jsxs("div",{className:"bg-gradient-to-br from-white via-gray-50 to-white border border-gray-200/50 rounded-2xl p-8 w-full max-w-[600px] shadow-2xl dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 dark:border-gray-700/50 animate-in zoom-in-95 duration-300",children:[f.jsxs("div",{className:"flex items-center justify-between mb-8",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/10 rounded-xl",children:f.jsxs("svg",{className:"w-7 h-7 text-primary",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),f.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Select Municipality"}),f.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter data by location"})]})]}),f.jsx("button",{onClick:()=>Se(!1),className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all duration-200 group",children:f.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4 border border-blue-200/50 dark:border-blue-700/50",children:f.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:" Choose a municipality to view its specific vehicle registration trends"})}),f.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-80 overflow-y-auto scrollbar-hide",children:ze.map((tt,Qt)=>f.jsxs("button",{onClick:()=>Je(tt),className:`group relative p-4 text-left rounded-xl transition-all duration-300 border-2 ${ve===tt?"bg-gradient-to-r from-primary to-primary/80 text-white border-primary shadow-lg shadow-primary/25 transform scale-[1.02]":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:border-primary/50 hover:bg-primary/5 dark:hover:bg-primary/10 hover:shadow-md hover:transform hover:scale-[1.01]"}`,style:{animationDelay:`${Qt*50}ms`},children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${ve===tt?"bg-white":"bg-primary/60 group-hover:bg-primary"}`}),f.jsx("span",{className:"font-medium",children:tt})]}),ve===tt&&f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}),tt==="All"&&f.jsx("p",{className:"text-xs opacity-75 mt-1",children:"View all municipalities combined"})]},tt))}),f.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),f.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Currently selected:"}),f.jsx("span",{className:"text-sm font-semibold text-primary",children:ve})]})})]})]})})]})},KUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=K.useState([]),[l,h]=K.useState(!1),[i,_]=K.useState(null),[w,A]=K.useState(!1),[C,R]=K.useState(!1);K.useEffect(()=>{const H=()=>{R(window.innerWidth<640)};return H(),window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[]);const z=async()=>{try{h(!0),_(null);let H=null,J=null;e&&e!=="All"&&(H=SE(e)),t&&t!=="All"&&(J=t),console.log("Fetching owner municipality data with:",{monthNumber:H,yearValue:J,selectedMonth:e,selectedYear:t});const Q=await VUe(H,J);console.log("Owner municipality data response:",Q),Q.success?a(Q.data):(_("Failed to fetch owner municipality data"),a([]))}catch(H){console.error("Error fetching owner municipality data:",H),_("Error loading owner municipality data")}finally{h(!1)}};K.useEffect(()=>{z(),A(!1)},[]),K.useEffect(()=>{z(),A(!1)},[e,t]),K.useEffect(()=>{if(n.length>0){const H=setTimeout(()=>A(!0),100);return()=>clearTimeout(H)}},[n]);const V=H=>H.map(J=>({name:J.municipality,withLicense:J.withLicense,withoutLicense:J.withoutLicense,total:J.totalOwners})),U=({active:H,payload:J,label:Q})=>{var le,ne;if(H&&J&&J.length){const de=((le=J.find(Ae=>Ae.dataKey==="withLicense"))==null?void 0:le.value)||0,ue=((ne=J.find(Ae=>Ae.dataKey==="withoutLicense"))==null?void 0:ne.value)||0,ve=de+ue;return f.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:Q}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),f.jsxs("span",{className:"text-green-600 dark:text-green-400 text-xs",children:[f.jsx("span",{className:"font-semibold",children:de.toLocaleString()})," With License"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),f.jsxs("span",{className:"text-orange-600 dark:text-orange-400 text-xs",children:[f.jsx("span",{className:"font-semibold",children:ue.toLocaleString()})," Without License"]})]}),f.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 pt-1",children:f.jsxs("span",{className:"text-gray-700 dark:text-gray-300 text-xs font-semibold",children:["Total: ",ve.toLocaleString()]})})]})]})})}return null},G=({payload:H})=>f.jsx("div",{className:"flex justify-center gap-6 mt-4",children:H.map((J,Q)=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:J.color}}),f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:J.value})]},Q))});return f.jsxs("div",{className:"bg-gray-100 border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent min-h-[400px] flex flex-col",children:[f.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsx("svg",{className:"w-6 h-6 text-foreground",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[f.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Registered Owners by Municipality"}),t==="All"&&e&&e!=="All"&&f.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&f.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),f.jsx("div",{className:"h-80 w-full min-h-[320px] flex-1",children:l||r?f.jsx("div",{className:"flex items-center justify-center w-full h-full",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:f.jsx("p",{children:i})}):n.length===0?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:f.jsx("p",{children:"No data available"})}):f.jsx(Qs,{width:"100%",height:"100%",minHeight:320,children:f.jsxs(Eh,{data:V(n),margin:{top:20,right:C?20:50,left:C?5:10,bottom:20},barCategoryGap:"10%",children:[f.jsx(js,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),f.jsx(lo,{dataKey:"name",stroke:"#6b7280",fontSize:C?9:11,height:C?60:50,interval:C?0:40,angle:C?-45:0,textAnchor:C?"end":"middle",tick:{fill:"#6b7280",fontWeight:500},tickFormatter:H=>C?H.length>8?H.substring(0,8)+"...":H:H.length>12?H.substring(0,12)+"...":H}),f.jsx(co,{stroke:"#6b7280",fontSize:C?10:12,tickFormatter:H=>H.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:C?60:80}),f.jsx(wa,{content:f.jsx(U,{})}),f.jsx(kh,{content:f.jsx(G,{})}),f.jsx(Ro,{dataKey:"withLicense",stackId:"owners",name:"With Driver's License",fill:"#10b981",radius:[0,0,0,0],maxBarSize:C?80:120}),f.jsx(Ro,{dataKey:"withoutLicense",stackId:"owners",name:"Without Driver's License",fill:"#f97316",radius:[4,4,0,0],maxBarSize:C?80:120})]})})})]})},WUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=K.useState([]),[l,h]=K.useState(!1),[i,_]=K.useState(null),[w,A]=K.useState(!1),[C,R]=K.useState(!1);K.useEffect(()=>{const J=()=>{R(window.innerWidth<640)};return J(),window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]);const z=async()=>{try{h(!0),_(null);let J=null,Q=null;e&&e!=="All"&&(J=SE(e)),t&&t!=="All"&&(Q=t),console.log("Fetching vehicle classification data with:",{monthNumber:J,yearValue:Q,selectedMonth:e,selectedYear:t});const le=await UUe(J,Q);console.log("Vehicle classification data response:",le),le.success?a(le.data):(_("Failed to fetch vehicle classification data"),a([]))}catch(J){console.error("Error fetching vehicle classification data:",J),_("Error loading vehicle classification data")}finally{h(!1)}};K.useEffect(()=>{z(),A(!1)},[]),K.useEffect(()=>{z(),A(!1)},[e,t]),K.useEffect(()=>{if(n.length>0){const J=setTimeout(()=>A(!0),100);return()=>clearTimeout(J)}},[n]);const V=J=>J.map(Q=>({name:Q.classification,value:Q.count,percentage:Q.percentage})),U=["#3b82f6","#ef4444","#f59e0b"],G=({active:J,payload:Q})=>{if(J&&Q&&Q.length){const le=Q[0];return f.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:le.name}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:le.color}}),f.jsxs("span",{className:"text-gray-700 dark:text-gray-300 text-xs",children:[f.jsx("span",{className:"font-semibold",children:le.value.toLocaleString()})," vehicles"]})]}),f.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 pt-1",children:f.jsxs("span",{className:"text-gray-700 dark:text-gray-300 text-xs font-semibold",children:[le.payload.percentage,"% of total"]})})]})]})})}return null},H=({payload:J})=>f.jsx("div",{className:"flex flex-wrap justify-center gap-4 mt-4",children:J.map((Q,le)=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Q.color}}),f.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:Q.value})]},le))});return f.jsxs("div",{className:"bg-gray-100 border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent min-h-[400px] flex flex-col",children:[f.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:f.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:f.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[f.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Vehicle Classification"}),t==="All"&&e&&e!=="All"&&f.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&f.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),f.jsx("div",{className:"h-80 w-full min-h-[320px] flex-1",children:l||r?f.jsx("div",{className:"flex items-center justify-center w-full h-full",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:f.jsx("p",{children:i})}):n.length===0?f.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:f.jsx("p",{children:"No data available"})}):f.jsx(Qs,{width:"100%",height:"100%",minHeight:320,children:f.jsxs(yte,{children:[f.jsx(rp,{data:V(n),cx:"50%",cy:"50%",labelLine:!1,label:({name:J,percentage:Q})=>`${J} ${Q}%`,outerRadius:C?80:100,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:1e3,animationEasing:"ease-out",children:V(n).map((J,Q)=>f.jsx(hm,{fill:U[Q%U.length],stroke:"#fff",strokeWidth:2},`cell-${Q}`))}),f.jsx(wa,{content:f.jsx(G,{})}),f.jsx(kh,{content:f.jsx(H,{})})]})})})]})},Wp=(e,t=2e3)=>{const[r,n]=K.useState(0);return K.useEffect(()=>{let a;const h=i=>{a||(a=i);const _=Math.min((i-a)/t,1),w=1-Math.pow(1-_,4),A=Math.floor(0+(e-0)*w);n(A),_<1&&requestAnimationFrame(h)};requestAnimationFrame(h)},[e,t]),r};function HUe(){var Ne,Ye,$e,We,Et,Je,ht,tt,Qt,gr,sr,ur,br,Wt,Be,Nr,Jt,Sn,It,Vn,Un;const[e,t]=K.useState(""),[r,n]=K.useState(""),[a,l]=K.useState(!1),[h,i]=K.useState(!1),[_,w]=K.useState(null),[A,C]=K.useState(!1),[R,z]=K.useState(null),V=K.useRef(null),U=K.useRef(null),G=Wp(((Ne=_==null?void 0:_.vehicles)==null?void 0:Ne.total)||0),H=Wp(((Ye=_==null?void 0:_.vehicles)==null?void 0:Ye.active)||0),J=Wp((($e=_==null?void 0:_.vehicles)==null?void 0:$e.expired)||0),Q=Wp(((We=_==null?void 0:_.drivers)==null?void 0:We.total)||0),le=Wp(((Et=_==null?void 0:_.drivers)==null?void 0:Et.withLicense)||0),ne=Wp(((Je=_==null?void 0:_.drivers)==null?void 0:Je.withoutLicense)||0),de=Wp(((ht=_==null?void 0:_.plateClassification)==null?void 0:ht.total)||0),ue=Wp(((tt=_==null?void 0:_.plateClassification)==null?void 0:tt.permanent)||0),ve=Wp(((Qt=_==null?void 0:_.plateClassification)==null?void 0:Qt.temporary)||0),Ae=["All","January","February","March","April","May","June","July","August","September","October","November","December"],Oe=new Date().getFullYear(),Se=["All",...Array.from({length:7},(Xr,rt)=>(Oe+rt).toString())];K.useEffect(()=>{const Xr=rt=>{V.current&&!V.current.contains(rt.target)&&l(!1),U.current&&!U.current.contains(rt.target)&&i(!1)};return document.addEventListener("mousedown",Xr),()=>{document.removeEventListener("mousedown",Xr)}},[]);const ke=Xr=>{t(Xr),l(!1)},ze=Xr=>{n(Xr),i(!1)},et=(Xr,rt)=>!Xr&&!rt||Xr==="All"&&rt==="All"?"All Time":Xr==="All"&&rt&&rt!=="All"?`All Months in ${rt}`:Xr&&Xr!=="All"&&rt==="All"?`All ${Xr}s (All Years)`:Xr&&Xr!=="All"&&rt&&rt!=="All"?`${Xr} ${rt}`:Xr&&Xr!=="All"&&!rt?`All ${Xr}s (All Years)`:!Xr&&rt&&rt!=="All"?`All Months in ${rt}`:"All Time",je=async(Xr,rt)=>{try{C(!0),z(null);let Ot=null,Kt=null;Xr&&Xr!=="All"&&(Ot=SE(Xr)),rt&&rt!=="All"&&(Kt=rt);const Pr=await DUe(Ot,Kt);Pr.success?w(Pr.data):z("Failed to fetch analytics data")}catch(Ot){console.error("Error fetching analytics data:",Ot),z("Error loading analytics data")}finally{C(!1)}};return K.useEffect(()=>{je("All","All")},[]),K.useEffect(()=>{e||r?je(e,r):je("All","All")},[e,r]),f.jsxs("div",{className:"container mx-auto p-6",children:[f.jsxs("div",{className:"registration-analytics-header",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"registration-analytics-title",children:"Registration Analytics"}),f.jsxs("p",{className:"registration-analytics-subtitle",children:["Vehicle and Owners Registration Analytics for: ",et(e,r)]})]}),f.jsxs("div",{className:"registration-analytics-controls",children:[f.jsxs("div",{className:"registration-analytics-dropdown",ref:V,children:[f.jsxs("button",{className:`registration-analytics-dropdown-button ${e?"":"placeholder"}`,onClick:()=>l(!a),children:[f.jsx("span",{children:e||"Month"}),f.jsx("svg",{className:`registration-analytics-chevron ${a?"open":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),a&&f.jsx("div",{className:"registration-analytics-dropdown-content",style:{position:"absolute",right:0,top:"100%",marginTop:"8px",width:"180px",backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",zIndex:50,maxHeight:"200px",overflowY:"auto"},children:Ae.map(Xr=>f.jsx("div",{className:"registration-analytics-dropdown-item",onClick:()=>ke(Xr),style:{padding:"8px 16px",fontSize:"14px",color:"hsl(var(--foreground))",cursor:"pointer",transition:"background-color 150ms"},onMouseEnter:rt=>rt.target.style.backgroundColor="hsl(var(--accent))",onMouseLeave:rt=>rt.target.style.backgroundColor="transparent",children:Xr},Xr))})]}),f.jsxs("div",{className:"registration-analytics-dropdown",ref:U,children:[f.jsxs("button",{className:`registration-analytics-dropdown-button ${r?"":"placeholder"}`,onClick:()=>i(!h),children:[f.jsx("span",{children:r||"Year"}),f.jsx("svg",{className:`registration-analytics-chevron ${h?"open":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&f.jsx("div",{className:"registration-analytics-dropdown-content",style:{position:"absolute",right:0,top:"100%",marginTop:"8px",width:"192px",backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",zIndex:50,maxHeight:"200px",overflowY:"auto"},children:Se.map(Xr=>f.jsx("div",{className:"registration-analytics-dropdown-item",onClick:()=>ze(Xr),style:{padding:"8px 16px",fontSize:"14px",color:"hsl(var(--foreground))",cursor:"pointer",transition:"background-color 150ms"},onMouseEnter:rt=>rt.target.style.backgroundColor="hsl(var(--accent))",onMouseLeave:rt=>rt.target.style.backgroundColor="transparent",children:Xr},Xr))})]})]})]}),R&&f.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:f.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:R})}),f.jsx("div",{className:"registration-analytics-fade-in",children:f.jsxs("div",{className:"mb-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[f.jsxs("div",{className:"group relative bg-gray-100 border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent hover:border-blue-300 dark:hover:border-blue-600",children:[f.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),f.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Registered Vehicles"}),f.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:A?"...":G})]}),f.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:f.jsxs("svg",{className:"w-6 h-6 text-blue-500 group-hover:text-blue-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),f.jsx("circle",{cx:"7",cy:"17",r:"2"}),f.jsx("path",{d:"M9 17h6"}),f.jsx("circle",{cx:"17",cy:"17",r:"2"})]})})]}),f.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[f.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[A?"...":H," Active"]}),f.jsx("span",{className:"mx-2",children:""}),f.jsxs("span",{className:"text-red-600 dark:text-red-400 font-medium",children:[A?"...":J," Expired"]})]}),f.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[f.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((gr=_==null?void 0:_.vehicles)==null?void 0:gr.active)||0)/(((sr=_==null?void 0:_.vehicles)==null?void 0:sr.total)||1)*100,100)}%`}}),f.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((ur=_==null?void 0:_.vehicles)==null?void 0:ur.expired)||0)/(((br=_==null?void 0:_.vehicles)==null?void 0:br.total)||1)*100,100)}%`}})]})]}),f.jsxs("div",{className:"group relative bg-gray-100 border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent hover:border-green-300 dark:hover:border-green-600",children:[f.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-green-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),f.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Registered Owners"}),f.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:A?"...":Q})]}),f.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:f.jsx("svg",{className:"w-6 h-6 text-green-500 group-hover:text-green-600 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),f.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[f.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[A?"...":le," With License"]}),f.jsx("span",{className:"mx-2",children:""}),f.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[A?"...":ne," Without License"]})]}),f.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[f.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Wt=_==null?void 0:_.drivers)==null?void 0:Wt.withLicense)||0)/(((Be=_==null?void 0:_.drivers)==null?void 0:Be.total)||1)*100,100)}%`}}),f.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Nr=_==null?void 0:_.drivers)==null?void 0:Nr.withoutLicense)||0)/(((Jt=_==null?void 0:_.drivers)==null?void 0:Jt.total)||1)*100,100)}%`}})]})]}),f.jsxs("div",{className:"group relative bg-gray-100 border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-black dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent hover:border-purple-300 dark:hover:border-purple-600",children:[f.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-purple-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),f.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Plate Classification"}),f.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:A?"...":de})]}),f.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:f.jsxs("svg",{className:"w-6 h-6 text-purple-500 group-hover:text-purple-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[f.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2",ry:"2"}),f.jsx("rect",{x:"4",y:"8",width:"16",height:"8",rx:"1",ry:"1"}),f.jsx("path",{d:"M8 10h2"}),f.jsx("path",{d:"M12 10h2"}),f.jsx("path",{d:"M16 10h2"}),f.jsx("path",{d:"M8 12h2"}),f.jsx("path",{d:"M12 12h2"}),f.jsx("path",{d:"M16 12h2"})]})})]}),f.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[f.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[A?"...":ue," Permanent"]}),f.jsx("span",{className:"mx-2",children:""}),f.jsxs("span",{className:"text-purple-400 dark:text-purple-400 font-medium",children:[A?"...":ve," Temporary"]})]}),f.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[f.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Sn=_==null?void 0:_.plateClassification)==null?void 0:Sn.permanent)||0)/(((It=_==null?void 0:_.plateClassification)==null?void 0:It.total)||1)*100,100)}%`}}),f.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Vn=_==null?void 0:_.plateClassification)==null?void 0:Vn.temporary)||0)/(((Un=_==null?void 0:_.plateClassification)==null?void 0:Un.total)||1)*100,100)}%`}})]})]})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-6",children:[f.jsx("div",{className:"flex-1 lg:flex-1",children:f.jsx(qUe,{selectedMonth:e,selectedYear:r,loading:A})}),f.jsx("div",{className:"flex-1 lg:flex-1",children:f.jsx(GUe,{})})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[f.jsx("div",{className:"flex-1 lg:flex-1",children:f.jsx(WUe,{selectedMonth:e,selectedYear:r,loading:A})}),f.jsx("div",{className:"flex-1 lg:flex-1",children:f.jsx(KUe,{selectedMonth:e,selectedYear:r,loading:A})})]})]})})]})}function ZUe(){return f.jsx("div",{children:f.jsx(HUe,{})})}const YUe=async(e={},t=null)=>{try{const r=new URLSearchParams;t&&r.append("year",t),e&&typeof e=="object"&&Object.keys(e).forEach(h=>{e[h]!==null&&e[h]!==void 0&&r.append(h,e[h])});const n=r.toString(),a=`/violations/analytics${n?`?${n}`:""}`;return(await Bn.get(a)).data}catch(r){throw console.error("Error fetching violation analytics:",r),r}};function XUe({displayData:e,loading:t,totalViolations:r,totalTrafficViolators:n,topOfficer:a}){var l,h,i,_;return t?f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((w,A)=>f.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 animate-pulse",children:f.jsxs("div",{className:"flex items-center",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-2"}),f.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded mb-1"}),f.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded"})]}),f.jsx("div",{className:"ml-4",children:f.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-full"})})]})},A))}):f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-blue-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-blue-500/10 to-blue-600/5 rounded-full -translate-y-4 translate-x-4"}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),f.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Total Violations"})]}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:r.toLocaleString()}),f.jsx("p",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"All time violations"})]}),f.jsx("div",{className:"ml-3",children:f.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500/50 to-blue-600/50 rounded-lg flex items-center justify-center shadow-md",children:f.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})})]})]}),f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-green-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-green-500/10 to-green-600/5 rounded-full -translate-y-4 translate-x-4"}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),f.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Traffic Violators"})]}),f.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:n.toLocaleString()}),f.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"Unique violators"})]}),f.jsx("div",{className:"ml-3",children:f.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500/50 to-green-600/50 rounded-lg flex items-center justify-center shadow-md",children:f.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]})]}),f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-orange-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-orange-500/10 to-orange-600/5 rounded-full -translate-y-4 translate-x-4"}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),f.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Most Common"})]}),f.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white truncate mb-1",children:((h=(l=e==null?void 0:e.mostCommonViolations)==null?void 0:l[0])==null?void 0:h._id)||"N/A"}),f.jsxs("p",{className:"text-xs font-medium text-orange-600 dark:text-orange-400",children:[((_=(i=e==null?void 0:e.mostCommonViolations)==null?void 0:i[0])==null?void 0:_.count)||0," occurrences"]})]}),f.jsx("div",{className:"ml-3",children:f.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-orange-500/50 to-orange-600/50 rounded-lg flex items-center justify-center shadow-md",children:f.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})})]})]}),f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-purple-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-gradient-to-br from-purple-500/10 to-purple-600/5 rounded-full -translate-y-4 translate-x-4"}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),f.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Top Officer"})]}),f.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white truncate mb-1",children:(a==null?void 0:a.officerName)||"N/A"}),f.jsxs("p",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:[(a==null?void 0:a.violationCount)||0," violations"]})]}),f.jsx("div",{className:"ml-3",children:f.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500/50 to-purple-600/50 rounded-lg flex items-center justify-center shadow-md",children:f.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})})]})]})]})}function JUe({data:e,title:t,type:r,loading:n}){if(n)return f.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),f.jsx("div",{className:"space-y-3",children:[...Array(5)].map((_,w)=>f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-20 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsx("div",{className:"w-12 h-4 bg-gray-200 dark:bg-gray-700 rounded"})]},w))})]})});if(!e||e.length===0)return f.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t}),f.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),f.jsx("p",{children:"No data available"})]})]});const a=Math.max(...e.map(_=>_.count||_.violationCount||0)),l=e.slice(0,5),h=_=>["bg-gradient-to-r from-blue-500 to-blue-600","bg-gradient-to-r from-green-500 to-green-600","bg-gradient-to-r from-yellow-500 to-yellow-600","bg-gradient-to-r from-red-500 to-red-600","bg-gradient-to-r from-purple-500 to-purple-600"][_]||"bg-gradient-to-r from-gray-500 to-gray-600",i=_=>["text-blue-600 dark:text-blue-400","text-green-600 dark:text-green-400","text-yellow-600 dark:text-yellow-400","text-red-600 dark:text-red-400","text-purple-600 dark:text-purple-400"][_]||"text-gray-600 dark:text-gray-400";return f.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-2"}),t]}),f.jsx("div",{className:"space-y-4",children:l.map((_,w)=>{const A=_.count||_.violationCount||0,C=a>0?A/a*100:0,R=r==="officers"?_.officerName||"Unknown Officer":_._id||"Unknown Item";return f.jsxs("div",{className:"space-y-2 p-3 border border-gray-200 dark:border-gray-600 rounded-lg",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:R}),f.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r==="officers"?"Apprehending Officer":"Violation Type"})]}),f.jsxs("div",{className:"text-right ml-3",children:[f.jsx("div",{className:`text-lg font-bold ${i(w)}`,children:A.toLocaleString()}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r==="officers"?"apprehensions":"violations"})]})]}),f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 border border-gray-300 dark:border-gray-600",children:f.jsx("div",{className:`h-3 rounded-full ${h(w)} transition-all duration-1000 ease-out`,style:{width:`${C}%`}})}),f.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[f.jsxs("span",{children:["Rank #",w+1]}),f.jsxs("span",{children:[C.toFixed(1),"% of max"]})]})]},w)})}),l.length<5&&f.jsxs("div",{className:"mt-4 text-center text-sm text-gray-500 dark:text-gray-400",children:["Only ",l.length," ",r==="officers"?"officers":"items"," available"]})]})}function QUe({data:e,title:t,loading:r}){if(r)return f.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),f.jsx("div",{className:"flex items-center justify-center",children:f.jsx("div",{className:"w-48 h-48 bg-gray-200 dark:bg-gray-700 rounded-full"})}),f.jsx("div",{className:"mt-6 space-y-3",children:[...Array(5)].map((C,R)=>f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsx("div",{className:"w-12 h-4 bg-gray-200 dark:bg-gray-700 rounded"})]},R))})]})});if(!e||e.length===0)return f.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t}),f.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),f.jsx("p",{children:"No data available"})]})]});const n=e.reduce((C,R)=>C+(R.count||0),0),a=e.slice(0,5);let l=0;const h=a.map((C,R)=>{const z=C.count||0,V=n>0?z/n*100:0,U=l,G=l+V/100*360;return l=G,{...C,percentage:V,startAngle:U,endAngle:G,index:R}}),i=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],_=C=>i[C]||"#6B7280",w=(C,R,z=80)=>{const G=A(100,100,z,R),H=A(100,100,z,C),J=R-C<=180?"0":"1";return["M",100,100,"L",G.x,G.y,"A",z,z,0,J,0,H.x,H.y,"Z"].join(" ")},A=(C,R,z,V)=>{const U=(V-90)*Math.PI/180;return{x:C+z*Math.cos(U),y:R+z*Math.sin(U)}};return f.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-2"}),t]}),f.jsxs("div",{className:"flex flex-col lg:flex-row items-center space-y-6 lg:space-y-0 lg:space-x-6",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsxs("svg",{width:"200",height:"200",viewBox:"0 0 200 200",className:"mx-auto",children:[h.map((C,R)=>f.jsx("path",{d:w(C.startAngle,C.endAngle),fill:_(R),stroke:"white",strokeWidth:"2",className:"hover:opacity-80 transition-opacity duration-200"},R)),f.jsx("circle",{cx:"100",cy:"100",r:"40",fill:"white",className:"dark:fill-gray-900"}),f.jsx("text",{x:"100",y:"95",textAnchor:"middle",className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Total"}),f.jsx("text",{x:"100",y:"110",textAnchor:"middle",className:"text-lg font-bold text-gray-900 dark:text-white",children:n.toLocaleString()})]})}),f.jsx("div",{className:"flex-1 space-y-3",children:h.map((C,R)=>{var z;return f.jsxs("div",{className:"flex items-center justify-between p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:_(R)}}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:C._id||"Unknown"}),f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[C.percentage.toFixed(1),"% of total"]})]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-white",children:((z=C.count)==null?void 0:z.toLocaleString())||0}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"violations"})]})]},R)})})]}),a.length<5&&f.jsxs("div",{className:"mt-4 text-center text-sm text-gray-500 dark:text-gray-400",children:["Only ",a.length," violation types available"]})]})}function e6e({displayData:e,loading:t,setIsLineChartModalOpen:r}){if(t)return f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[f.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),f.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"})]})}),f.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),f.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded"})]})})]});const n=(e==null?void 0:e.violationsByType)||[];n.reduce((h,i)=>h+(i.count||0),0);const a=(e==null?void 0:e.yearlyTrends)||[],l=Math.max(...a.map(h=>h.count||0),1);return f.jsxs("div",{className:"space-y-6 mb-8",children:[f.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Yearly Trends"}),f.jsx("button",{onClick:()=>r(!0),className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"View Details "})]}),f.jsx("div",{className:"space-y-4",children:a.length>0?a.slice(0,5).map((h,i)=>{var A;const _=l>0?(h.count||0)/l*100:0,w=((A=h._id)==null?void 0:A.year)||"Unknown";return f.jsxs("div",{className:"space-y-2 p-3 border border-gray-200 dark:border-gray-600 rounded-lg",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:w}),f.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[h.count||0," violations"]})]}),f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 border border-gray-300 dark:border-gray-600",children:f.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-blue-500 to-purple-500",style:{width:`${_}%`}})})]},w)}):f.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No yearly trend data available"})}),a.length>5&&f.jsx("div",{className:"mt-4 text-center",children:f.jsxs("button",{onClick:()=>r(!0),className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:["View all ",a.length," years "]})})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsx("div",{className:"lg:col-span-2",children:f.jsx(JUe,{data:(e==null?void 0:e.topOfficers)||[],title:"Top 5 Apprehending Officers",type:"officers",loading:t})}),f.jsx("div",{className:"lg:col-span-1",children:f.jsx(QUe,{data:n,title:"Violation Types Distribution",loading:t})})]})]})}function t6e({displayData:e,loading:t,currentViolations:r,startIndex:n,endIndex:a,totalViolationItems:l,currentPage:h,totalPages:i,handlePrevPage:_,handleNextPage:w}){return t?f.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),f.jsx("div",{className:"space-y-3",children:[...Array(5)].map((A,C)=>f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsxs("div",{className:"flex-1 space-y-2",children:[f.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]}),f.jsx("div",{className:"w-16 h-6 bg-gray-200 dark:bg-gray-700 rounded"})]},C))})]})}):f.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-600 rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Top Violations Ranking"}),r.length>0?f.jsx("div",{className:"space-y-3 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:r.map((A,C)=>{const R=n+C+1,z=U=>U===1?"bg-yellow-100 dark:bg-yellow-900/20 text-yellow-800 dark:text-yellow-400":U===2?"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300":U===3?"bg-orange-100 dark:bg-orange-900/20 text-orange-800 dark:text-orange-400":"bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-400",V=U=>U===1?"":U===2?"":U===3?"":U;return f.jsxs("div",{className:"flex items-center space-x-4 p-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors bg-white dark:bg-gray-900",children:[f.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${z(R)}`,children:V(R)}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:A._id||"Unknown Violation"}),f.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[A.count||0," occurrences"]})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white",children:A.count||0}),f.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"violations"})]})]},A._id||C)})}):f.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),f.jsx("p",{children:"No violation data available"})]}),r.length>0&&i>1&&f.jsx("div",{className:"mt-6 pt-4 border-t-2 border-gray-300 dark:border-gray-600",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Showing ",n+1," to ",Math.min(a,l)," of ",l," violations"]}),f.jsxs("div",{className:"flex space-x-3",children:[f.jsxs("button",{onClick:_,disabled:h===1,className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),f.jsx("span",{children:"Previous"})]}),f.jsx("div",{className:"flex items-center space-x-2",children:f.jsxs("span",{className:"px-4 py-2 text-sm font-semibold text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border-2 border-gray-300 dark:border-gray-600 rounded-lg",children:["Page ",h," of ",i]})}),f.jsxs("button",{onClick:w,disabled:h===i,className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[f.jsx("span",{children:"Next"}),f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})]})}function r6e({displayData:e,loading:t,getCombinationRecommendation:r}){if(t)return f.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"animate-pulse",children:[f.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),f.jsx("div",{className:"space-y-4",children:[...Array(3)].map((l,h)=>f.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded"}),f.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),f.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})},h))})]})});const n=(e==null?void 0:e.violationCombinations)||[],a=(e==null?void 0:e.violationPatterns)||[];return f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Violation Combinations & Recommendations"}),n.length>0||a.length>0?f.jsxs("div",{className:"space-y-4",children:[n.slice(0,5).map((l,h)=>{const i=l.violations||[],_=l.count||0,w=r(i);return f.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[f.jsx("div",{className:"flex items-start justify-between mb-2",children:f.jsxs("div",{className:"flex-1",children:[f.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:i.map((A,C)=>f.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-400",children:A},C))}),f.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[_," occurrence",_!==1?"s":""]})]})}),f.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/10 border-l-4 border-yellow-400 rounded-r",children:[f.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-300 font-medium",children:"Recommended Action:"}),f.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mt-1",children:w})]})]},h)}),a.slice(0,3).map((l,h)=>{const i=l.pattern||"Unknown Pattern",_=l.frequency||0,w=l.description||"No description available";return f.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[f.jsx("div",{className:"flex items-start justify-between mb-2",children:f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:i}),f.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:w}),f.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Frequency: ",_," cases"]})]})}),f.jsxs("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/10 border-l-4 border-blue-400 rounded-r",children:[f.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-300 font-medium",children:"Pattern Analysis:"}),f.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400 mt-1",children:"This pattern indicates recurring violation behaviors that may require targeted enforcement strategies."})]})]},`pattern-${h}`)}),(n.length>5||a.length>3)&&f.jsx("div",{className:"text-center pt-4",children:f.jsx("button",{className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium",children:"View All Combinations "})})]}):f.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),f.jsx("p",{children:"No violation combination data available"})]})]})}function n6e({isLineChartModalOpen:e,setIsLineChartModalOpen:t,selectedYearRange:r,setSelectedYearRange:n,filteredYearlyData:a,loading:l}){if(!e)return null;const h=["2020-2023","2015-2020","2010-2015","2005-2010","All"],i=A=>{n(A)},w=Math.max(...a.map(A=>A.count||0),1);return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Violation Trends Over Time"}),f.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[f.jsxs("div",{className:"mb-6",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Year Range:"}),f.jsx("div",{className:"flex flex-wrap gap-2",children:h.map(A=>f.jsx("button",{onClick:()=>i(A),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${r===A?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:A},A))})]}),f.jsx("div",{className:"bg-gray-50 dark:bg-black border border-gray-200 dark:border-gray-700 rounded-lg p-6",children:l?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a.length>0?f.jsxs("div",{className:"space-y-4",children:[f.jsxs("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:["Violation Count by Year (",r,")"]}),f.jsx("div",{className:"space-y-3",children:a.sort((A,C)=>{var R,z;return(((R=A._id)==null?void 0:R.year)||0)-(((z=C._id)==null?void 0:z.year)||0)}).map((A,C)=>{var H;const R=((H=A._id)==null?void 0:H.year)||"Unknown",z=A.count||0,V=w>0?z/w*100:0,U=["bg-blue-500","bg-green-500","bg-yellow-500","bg-red-500","bg-purple-500"],G=U[C%U.length];return f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:R}),f.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[z.toLocaleString()," violations"]})]}),f.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-6 relative",children:f.jsx("div",{className:`h-6 rounded-full ${G} flex items-center justify-end pr-2`,style:{width:`${V}%`},children:f.jsx("span",{className:"text-xs font-medium text-white",children:z>0?z.toLocaleString():""})})})]},R)})}),f.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 p-4 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.length}),f.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Years Covered"})]}),f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 p-4 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.reduce((A,C)=>A+(C.count||0),0).toLocaleString()}),f.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Violations"})]}),f.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-700 p-4 rounded-lg",children:[f.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:a.length>0?Math.round(a.reduce((A,C)=>A+(C.count||0),0)/a.length).toLocaleString():0}),f.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Average per Year"})]})]})]}):f.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[f.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),f.jsx("p",{children:"No data available for the selected year range"})]})})]}),f.jsx("div",{className:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700",children:f.jsx("button",{onClick:()=>t(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Close"})})]})})}function i6e({selectedYear:e,setSelectedYear:t,isYearDropdownOpen:r,setIsYearDropdownOpen:n,years:a,yearDropdownRef:l,handleYearSelect:h}){return f.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[f.jsxs("div",{className:"relative",ref:l,children:[f.jsxs("button",{onClick:()=>n(!r),className:"flex items-center justify-between w-48 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-black border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("span",{className:"truncate",children:e?`Year ${e}`:"All Time"}),f.jsx("svg",{className:`w-5 h-5 ml-2 transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&f.jsx("div",{className:"absolute z-10 w-48 mt-1 bg-white dark:bg-black border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto",children:a.map(i=>f.jsx("button",{onClick:()=>h(i),className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${e===i?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300"}`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{children:i==="All"?"All Time":`Year ${i}`}),e===i&&f.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},i))})]}),f.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),f.jsx("span",{children:e&&e!=="All"?`Filtered by ${e}`:"Showing all data"})]}),e&&e!=="All"&&f.jsx("button",{onClick:()=>h("All"),className:"px-3 py-1 text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:"Clear Filters"})]})}const uK=(e,t=2e3)=>{const[r,n]=K.useState(0);return K.useEffect(()=>{let a;const h=i=>{a||(a=i);const _=Math.min((i-a)/t,1),w=1-Math.pow(1-_,4),A=Math.floor(0+(e-0)*w);n(A),_<1&&requestAnimationFrame(h)};requestAnimationFrame(h)},[e,t]),r};function a6e(){var $e,We,Et;const[e,t]=K.useState(""),[r,n]=K.useState(!1),[a,l]=K.useState(null),[h,i]=K.useState(!1),[_,w]=K.useState(null),[A,C]=K.useState(1),R=10,[z,V]=K.useState(!1),[U,G]=K.useState("2020-2023"),H=K.useRef(null);new Date().getFullYear();const J=["All",...Array.from({length:19},(Je,ht)=>(2005+ht).toString())],le=(()=>{if(!(a!=null&&a.yearlyTrends))return[];if(!U.includes("-")){const tt=parseInt(U);return a.yearlyTrends.filter(Qt=>{var gr;return((gr=Qt._id)==null?void 0:gr.year)===tt})}const[Je,ht]=U.split("-").map(Number);return a.yearlyTrends.filter(tt=>{var Qt,gr;return((Qt=tt._id)==null?void 0:Qt.year)>=Je&&((gr=tt._id)==null?void 0:gr.year)<=ht})})(),ne=uK((a==null?void 0:a.totalViolations)||0),de=uK((a==null?void 0:a.totalTrafficViolators)||0);K.useEffect(()=>{const Je=ht=>{H.current&&!H.current.contains(ht.target)&&n(!1)};return document.addEventListener("mousedown",Je),()=>{document.removeEventListener("mousedown",Je)}},[]);const ue=Je=>{t(Je),n(!1)},ve=Je=>!Je||Je==="All"?"All Time":`Year ${Je}`,Ae=async Je=>{var ht,tt;try{i(!0),w(null);let Qt=null;Je&&Je!=="All"&&(Qt=Je);const gr=await YUe({},Qt);if(gr&&gr.success)l(gr.data),Je&&Je!=="All"&&gr.data.totalViolations===0?w(`No violation data available for year ${Je}. Please try a different year.`):w(null);else{const sr=(gr==null?void 0:gr.message)||"Failed to fetch analytics data";w(sr),console.error("API returned error:",sr)}}catch(Qt){console.error("Error fetching analytics data:",Qt);const gr=((tt=(ht=Qt.response)==null?void 0:ht.data)==null?void 0:tt.message)||Qt.message||"Error loading analytics data";w(gr)}finally{i(!1)}};K.useEffect(()=>{Ae("All")},[]),K.useEffect(()=>{Ae(e||"All")},[e]);const Oe=(($e=a==null?void 0:a.mostCommonViolations)==null?void 0:$e.length)||0,Se=Math.ceil(Oe/R),ke=(A-1)*R,ze=ke+R,et=((We=a==null?void 0:a.mostCommonViolations)==null?void 0:We.slice(ke,ze))||[],je=()=>{C(Je=>Math.max(Je-1,1))},Ne=()=>{C(Je=>Math.min(Je+1,Se))},Ye=Je=>{const ht=Je.map(tt=>tt.toLowerCase());return ht.some(tt=>tt.includes("no helmet"))&&ht.some(tt=>tt.includes("no license"))?"Immediate impoundment - High risk rider without proper documentation":ht.some(tt=>tt.includes("speeding"))&&ht.some(tt=>tt.includes("no license"))?"Vehicle impoundment and court hearing - Reckless driving without license":ht.some(tt=>tt.includes("no registration"))&&ht.some(tt=>tt.includes("no license"))?"Complete documentation check and vehicle impoundment until compliance":ht.some(tt=>tt.includes("drunk"))||ht.some(tt=>tt.includes("alcohol"))?"Immediate arrest and breathalyzer test - Zero tolerance policy":ht.some(tt=>tt.includes("reckless"))&&ht.some(tt=>tt.includes("speeding"))?"License suspension and mandatory driver education program":ht.some(tt=>tt.includes("confiscated"))||ht.some(tt=>tt.includes("impound"))?"Severe violation - Court hearing and possible vehicle forfeiture":ht.some(tt=>tt.includes("no license"))||ht.some(tt=>tt.includes("no registration"))?"Documentation violation - Vehicle impoundment until proper documents provided":ht.some(tt=>tt.includes("helmet"))||ht.some(tt=>tt.includes("safety"))?"Safety violation - Fine and safety education requirement":ht.some(tt=>tt.includes("speeding"))||ht.some(tt=>tt.includes("traffic"))?"Traffic violation - Fine and license demerit points":"Standard fine and documentation review"};return f.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen",children:[f.jsxs("div",{className:"mb-8",children:[f.jsxs("div",{className:"mb-6",children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Violation Analytics"}),f.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Complete Traffic Violation Analytics Dashboard for: ",ve(e),a&&f.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",children:" Live Data"}),!a&&!h&&f.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",children:"No Data"})]})]}),f.jsx(i6e,{selectedYear:e,setSelectedYear:t,isYearDropdownOpen:r,setIsYearDropdownOpen:n,years:J,yearDropdownRef:H,handleYearSelect:ue})]}),_&&f.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:_}),f.jsx("button",{onClick:()=>Ae(e||"All"),className:"ml-4 px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}),f.jsx(XUe,{displayData:a,loading:h,totalViolations:ne,totalTrafficViolators:de,topOfficer:(Et=a==null?void 0:a.topOfficers)==null?void 0:Et[0]}),f.jsx(e6e,{displayData:a,loading:h,setIsLineChartModalOpen:V}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[f.jsx(t6e,{displayData:a,loading:h,currentViolations:et,startIndex:ke,endIndex:ze,totalViolationItems:Oe,currentPage:A,totalPages:Se,handlePrevPage:je,handleNextPage:Ne}),f.jsx(r6e,{displayData:a,loading:h,getCombinationRecommendation:Ye})]}),f.jsx(n6e,{isLineChartModalOpen:z,setIsLineChartModalOpen:V,selectedYearRange:U,setSelectedYearRange:G,filteredYearlyData:le,loading:h})]})}function o6e(){return f.jsx("div",{children:f.jsx(a6e,{})})}var bA={exports:{}},s6e=bA.exports,dK;function l6e(){return dK||(dK=1,function(e,t){(function(r,n){e.exports=n()})(s6e,function(){var r,n,a;function l(i,_){if(!r)r=_;else if(!n)n=_;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",A={};r(A),a=_(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}l(["exports"],function(i){function _(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var w,A={},C={};function R(){if(w)return C;w=1,Object.defineProperty(C,"__esModule",{value:!0}),C.setMatrixArrayType=function(v){C.ARRAY_TYPE=o=v},C.toRadian=function(v){return v*p},C.equals=function(v,m){return Math.abs(v-m)<=d*Math.max(1,Math.abs(v),Math.abs(m))},C.RANDOM=C.ARRAY_TYPE=C.EPSILON=void 0;var d=1e-6;C.EPSILON=d;var o=typeof Float32Array<"u"?Float32Array:Array;C.ARRAY_TYPE=o;var c=Math.random;C.RANDOM=c;var p=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var v=0,m=arguments.length;m--;)v+=arguments[m]*arguments[m];return Math.sqrt(v)}),C}var z,V={};function U(){if(z)return V;function d(m){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(m)}z=1,Object.defineProperty(V,"__esModule",{value:!0}),V.create=function(){var m=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m},V.clone=function(m){var x=new o.ARRAY_TYPE(4);return x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3],x},V.copy=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3],m},V.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m},V.fromValues=function(m,x,M,j){var F=new o.ARRAY_TYPE(4);return F[0]=m,F[1]=x,F[2]=M,F[3]=j,F},V.set=function(m,x,M,j,F){return m[0]=x,m[1]=M,m[2]=j,m[3]=F,m},V.transpose=function(m,x){if(m===x){var M=x[1];m[1]=x[2],m[2]=M}else m[0]=x[0],m[1]=x[2],m[2]=x[1],m[3]=x[3];return m},V.invert=function(m,x){var M=x[0],j=x[1],F=x[2],E=x[3],N=M*E-F*j;return N?(m[0]=E*(N=1/N),m[1]=-j*N,m[2]=-F*N,m[3]=M*N,m):null},V.adjoint=function(m,x){var M=x[0];return m[0]=x[3],m[1]=-x[1],m[2]=-x[2],m[3]=M,m},V.determinant=function(m){return m[0]*m[3]-m[2]*m[1]},V.multiply=p,V.rotate=function(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=Math.sin(M),k=Math.cos(M);return m[0]=j*k+E*L,m[1]=F*k+N*L,m[2]=j*-L+E*k,m[3]=F*-L+N*k,m},V.scale=function(m,x,M){var j=x[1],F=x[2],E=x[3],N=M[0],L=M[1];return m[0]=x[0]*N,m[1]=j*N,m[2]=F*L,m[3]=E*L,m},V.fromRotation=function(m,x){var M=Math.sin(x),j=Math.cos(x);return m[0]=j,m[1]=M,m[2]=-M,m[3]=j,m},V.fromScaling=function(m,x){return m[0]=x[0],m[1]=0,m[2]=0,m[3]=x[1],m},V.str=function(m){return"mat2("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+")"},V.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3])},V.LDU=function(m,x,M,j){return m[2]=j[2]/j[0],M[0]=j[0],M[1]=j[1],M[3]=j[3]-m[2]*M[1],[m,x,M]},V.add=function(m,x,M){return m[0]=x[0]+M[0],m[1]=x[1]+M[1],m[2]=x[2]+M[2],m[3]=x[3]+M[3],m},V.subtract=v,V.exactEquals=function(m,x){return m[0]===x[0]&&m[1]===x[1]&&m[2]===x[2]&&m[3]===x[3]},V.equals=function(m,x){var M=m[0],j=m[1],F=m[2],E=m[3],N=x[0],L=x[1],k=x[2],I=x[3];return Math.abs(M-N)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(j-L)<=o.EPSILON*Math.max(1,Math.abs(j),Math.abs(L))&&Math.abs(F-k)<=o.EPSILON*Math.max(1,Math.abs(F),Math.abs(k))&&Math.abs(E-I)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(I))},V.multiplyScalar=function(m,x,M){return m[0]=x[0]*M,m[1]=x[1]*M,m[2]=x[2]*M,m[3]=x[3]*M,m},V.multiplyScalarAndAdd=function(m,x,M,j){return m[0]=x[0]+M[0]*j,m[1]=x[1]+M[1]*j,m[2]=x[2]+M[2]*j,m[3]=x[3]+M[3]*j,m},V.sub=V.mul=void 0;var o=function(m,x){if(m&&m.__esModule)return m;if(m===null||d(m)!=="object"&&typeof m!="function")return{default:m};var M=c(void 0);if(M&&M.has(m))return M.get(m);var j={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in m)if(E!=="default"&&Object.prototype.hasOwnProperty.call(m,E)){var N=F?Object.getOwnPropertyDescriptor(m,E):null;N&&(N.get||N.set)?Object.defineProperty(j,E,N):j[E]=m[E]}return j.default=m,M&&M.set(m,j),j}(R());function c(m){if(typeof WeakMap!="function")return null;var x=new WeakMap,M=new WeakMap;return(c=function(j){return j?M:x})(m)}function p(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=M[0],k=M[1],I=M[2],$=M[3];return m[0]=j*L+E*k,m[1]=F*L+N*k,m[2]=j*I+E*$,m[3]=F*I+N*$,m}function v(m,x,M){return m[0]=x[0]-M[0],m[1]=x[1]-M[1],m[2]=x[2]-M[2],m[3]=x[3]-M[3],m}return V.mul=p,V.sub=v,V}var G,H={};function J(){if(G)return H;function d(m){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(m)}G=1,Object.defineProperty(H,"__esModule",{value:!0}),H.create=function(){var m=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[4]=0,m[5]=0),m[0]=1,m[3]=1,m},H.clone=function(m){var x=new o.ARRAY_TYPE(6);return x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3],x[4]=m[4],x[5]=m[5],x},H.copy=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3],m[4]=x[4],m[5]=x[5],m},H.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=0,m[5]=0,m},H.fromValues=function(m,x,M,j,F,E){var N=new o.ARRAY_TYPE(6);return N[0]=m,N[1]=x,N[2]=M,N[3]=j,N[4]=F,N[5]=E,N},H.set=function(m,x,M,j,F,E,N){return m[0]=x,m[1]=M,m[2]=j,m[3]=F,m[4]=E,m[5]=N,m},H.invert=function(m,x){var M=x[0],j=x[1],F=x[2],E=x[3],N=x[4],L=x[5],k=M*E-j*F;return k?(m[0]=E*(k=1/k),m[1]=-j*k,m[2]=-F*k,m[3]=M*k,m[4]=(F*L-E*N)*k,m[5]=(j*N-M*L)*k,m):null},H.determinant=function(m){return m[0]*m[3]-m[1]*m[2]},H.multiply=p,H.rotate=function(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=x[4],k=x[5],I=Math.sin(M),$=Math.cos(M);return m[0]=j*$+E*I,m[1]=F*$+N*I,m[2]=j*-I+E*$,m[3]=F*-I+N*$,m[4]=L,m[5]=k,m},H.scale=function(m,x,M){var j=x[1],F=x[2],E=x[3],N=x[4],L=x[5],k=M[0],I=M[1];return m[0]=x[0]*k,m[1]=j*k,m[2]=F*I,m[3]=E*I,m[4]=N,m[5]=L,m},H.translate=function(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=x[4],k=x[5],I=M[0],$=M[1];return m[0]=j,m[1]=F,m[2]=E,m[3]=N,m[4]=j*I+E*$+L,m[5]=F*I+N*$+k,m},H.fromRotation=function(m,x){var M=Math.sin(x),j=Math.cos(x);return m[0]=j,m[1]=M,m[2]=-M,m[3]=j,m[4]=0,m[5]=0,m},H.fromScaling=function(m,x){return m[0]=x[0],m[1]=0,m[2]=0,m[3]=x[1],m[4]=0,m[5]=0,m},H.fromTranslation=function(m,x){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=x[0],m[5]=x[1],m},H.str=function(m){return"mat2d("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+")"},H.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],1)},H.add=function(m,x,M){return m[0]=x[0]+M[0],m[1]=x[1]+M[1],m[2]=x[2]+M[2],m[3]=x[3]+M[3],m[4]=x[4]+M[4],m[5]=x[5]+M[5],m},H.subtract=v,H.multiplyScalar=function(m,x,M){return m[0]=x[0]*M,m[1]=x[1]*M,m[2]=x[2]*M,m[3]=x[3]*M,m[4]=x[4]*M,m[5]=x[5]*M,m},H.multiplyScalarAndAdd=function(m,x,M,j){return m[0]=x[0]+M[0]*j,m[1]=x[1]+M[1]*j,m[2]=x[2]+M[2]*j,m[3]=x[3]+M[3]*j,m[4]=x[4]+M[4]*j,m[5]=x[5]+M[5]*j,m},H.exactEquals=function(m,x){return m[0]===x[0]&&m[1]===x[1]&&m[2]===x[2]&&m[3]===x[3]&&m[4]===x[4]&&m[5]===x[5]},H.equals=function(m,x){var M=m[0],j=m[1],F=m[2],E=m[3],N=m[4],L=m[5],k=x[0],I=x[1],$=x[2],Y=x[3],ee=x[4],oe=x[5];return Math.abs(M-k)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(k))&&Math.abs(j-I)<=o.EPSILON*Math.max(1,Math.abs(j),Math.abs(I))&&Math.abs(F-$)<=o.EPSILON*Math.max(1,Math.abs(F),Math.abs($))&&Math.abs(E-Y)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(Y))&&Math.abs(N-ee)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(ee))&&Math.abs(L-oe)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(oe))},H.sub=H.mul=void 0;var o=function(m,x){if(m&&m.__esModule)return m;if(m===null||d(m)!=="object"&&typeof m!="function")return{default:m};var M=c(void 0);if(M&&M.has(m))return M.get(m);var j={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in m)if(E!=="default"&&Object.prototype.hasOwnProperty.call(m,E)){var N=F?Object.getOwnPropertyDescriptor(m,E):null;N&&(N.get||N.set)?Object.defineProperty(j,E,N):j[E]=m[E]}return j.default=m,M&&M.set(m,j),j}(R());function c(m){if(typeof WeakMap!="function")return null;var x=new WeakMap,M=new WeakMap;return(c=function(j){return j?M:x})(m)}function p(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=x[4],k=x[5],I=M[0],$=M[1],Y=M[2],ee=M[3],oe=M[4],se=M[5];return m[0]=j*I+E*$,m[1]=F*I+N*$,m[2]=j*Y+E*ee,m[3]=F*Y+N*ee,m[4]=j*oe+E*se+L,m[5]=F*oe+N*se+k,m}function v(m,x,M){return m[0]=x[0]-M[0],m[1]=x[1]-M[1],m[2]=x[2]-M[2],m[3]=x[3]-M[3],m[4]=x[4]-M[4],m[5]=x[5]-M[5],m}return H.mul=p,H.sub=v,H}var Q,le={};function ne(){if(Q)return le;function d(m){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},d(m)}Q=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=function(){var m=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[5]=0,m[6]=0,m[7]=0),m[0]=1,m[4]=1,m[8]=1,m},le.fromMat4=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[4],m[4]=x[5],m[5]=x[6],m[6]=x[8],m[7]=x[9],m[8]=x[10],m},le.clone=function(m){var x=new o.ARRAY_TYPE(9);return x[0]=m[0],x[1]=m[1],x[2]=m[2],x[3]=m[3],x[4]=m[4],x[5]=m[5],x[6]=m[6],x[7]=m[7],x[8]=m[8],x},le.copy=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=x[2],m[3]=x[3],m[4]=x[4],m[5]=x[5],m[6]=x[6],m[7]=x[7],m[8]=x[8],m},le.fromValues=function(m,x,M,j,F,E,N,L,k){var I=new o.ARRAY_TYPE(9);return I[0]=m,I[1]=x,I[2]=M,I[3]=j,I[4]=F,I[5]=E,I[6]=N,I[7]=L,I[8]=k,I},le.set=function(m,x,M,j,F,E,N,L,k,I){return m[0]=x,m[1]=M,m[2]=j,m[3]=F,m[4]=E,m[5]=N,m[6]=L,m[7]=k,m[8]=I,m},le.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},le.transpose=function(m,x){if(m===x){var M=x[1],j=x[2],F=x[5];m[1]=x[3],m[2]=x[6],m[3]=M,m[5]=x[7],m[6]=j,m[7]=F}else m[0]=x[0],m[1]=x[3],m[2]=x[6],m[3]=x[1],m[4]=x[4],m[5]=x[7],m[6]=x[2],m[7]=x[5],m[8]=x[8];return m},le.invert=function(m,x){var M=x[0],j=x[1],F=x[2],E=x[3],N=x[4],L=x[5],k=x[6],I=x[7],$=x[8],Y=$*N-L*I,ee=-$*E+L*k,oe=I*E-N*k,se=M*Y+j*ee+F*oe;return se?(m[0]=Y*(se=1/se),m[1]=(-$*j+F*I)*se,m[2]=(L*j-F*N)*se,m[3]=ee*se,m[4]=($*M-F*k)*se,m[5]=(-L*M+F*E)*se,m[6]=oe*se,m[7]=(-I*M+j*k)*se,m[8]=(N*M-j*E)*se,m):null},le.adjoint=function(m,x){var M=x[0],j=x[1],F=x[2],E=x[3],N=x[4],L=x[5],k=x[6],I=x[7],$=x[8];return m[0]=N*$-L*I,m[1]=F*I-j*$,m[2]=j*L-F*N,m[3]=L*k-E*$,m[4]=M*$-F*k,m[5]=F*E-M*L,m[6]=E*I-N*k,m[7]=j*k-M*I,m[8]=M*N-j*E,m},le.determinant=function(m){var x=m[3],M=m[4],j=m[5],F=m[6],E=m[7],N=m[8];return m[0]*(N*M-j*E)+m[1]*(-N*x+j*F)+m[2]*(E*x-M*F)},le.multiply=p,le.translate=function(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=x[4],k=x[5],I=x[6],$=x[7],Y=x[8],ee=M[0],oe=M[1];return m[0]=j,m[1]=F,m[2]=E,m[3]=N,m[4]=L,m[5]=k,m[6]=ee*j+oe*N+I,m[7]=ee*F+oe*L+$,m[8]=ee*E+oe*k+Y,m},le.rotate=function(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=x[4],k=x[5],I=x[6],$=x[7],Y=x[8],ee=Math.sin(M),oe=Math.cos(M);return m[0]=oe*j+ee*N,m[1]=oe*F+ee*L,m[2]=oe*E+ee*k,m[3]=oe*N-ee*j,m[4]=oe*L-ee*F,m[5]=oe*k-ee*E,m[6]=I,m[7]=$,m[8]=Y,m},le.scale=function(m,x,M){var j=M[0],F=M[1];return m[0]=j*x[0],m[1]=j*x[1],m[2]=j*x[2],m[3]=F*x[3],m[4]=F*x[4],m[5]=F*x[5],m[6]=x[6],m[7]=x[7],m[8]=x[8],m},le.fromTranslation=function(m,x){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=x[0],m[7]=x[1],m[8]=1,m},le.fromRotation=function(m,x){var M=Math.sin(x),j=Math.cos(x);return m[0]=j,m[1]=M,m[2]=0,m[3]=-M,m[4]=j,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},le.fromScaling=function(m,x){return m[0]=x[0],m[1]=0,m[2]=0,m[3]=0,m[4]=x[1],m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},le.fromMat2d=function(m,x){return m[0]=x[0],m[1]=x[1],m[2]=0,m[3]=x[2],m[4]=x[3],m[5]=0,m[6]=x[4],m[7]=x[5],m[8]=1,m},le.fromQuat=function(m,x){var M=x[0],j=x[1],F=x[2],E=x[3],N=M+M,L=j+j,k=F+F,I=M*N,$=j*N,Y=j*L,ee=F*N,oe=F*L,se=F*k,ie=E*N,he=E*L,me=E*k;return m[0]=1-Y-se,m[3]=$-me,m[6]=ee+he,m[1]=$+me,m[4]=1-I-se,m[7]=oe-ie,m[2]=ee-he,m[5]=oe+ie,m[8]=1-I-Y,m},le.normalFromMat4=function(m,x){var M=x[0],j=x[1],F=x[2],E=x[3],N=x[4],L=x[5],k=x[6],I=x[7],$=x[8],Y=x[9],ee=x[10],oe=x[11],se=x[12],ie=x[13],he=x[14],me=x[15],be=M*L-j*N,Re=M*k-F*N,Me=M*I-E*N,Ce=j*k-F*L,Xe=j*I-E*L,Ie=F*I-E*k,Qe=$*ie-Y*se,ot=$*he-ee*se,nt=$*me-oe*se,lt=Y*he-ee*ie,dt=Y*me-oe*ie,yt=ee*me-oe*he,ct=be*yt-Re*dt+Me*lt+Ce*nt-Xe*ot+Ie*Qe;return ct?(m[0]=(L*yt-k*dt+I*lt)*(ct=1/ct),m[1]=(k*nt-N*yt-I*ot)*ct,m[2]=(N*dt-L*nt+I*Qe)*ct,m[3]=(F*dt-j*yt-E*lt)*ct,m[4]=(M*yt-F*nt+E*ot)*ct,m[5]=(j*nt-M*dt-E*Qe)*ct,m[6]=(ie*Ie-he*Xe+me*Ce)*ct,m[7]=(he*Me-se*Ie-me*Re)*ct,m[8]=(se*Xe-ie*Me+me*be)*ct,m):null},le.projection=function(m,x,M){return m[0]=2/x,m[1]=0,m[2]=0,m[3]=0,m[4]=-2/M,m[5]=0,m[6]=-1,m[7]=1,m[8]=1,m},le.str=function(m){return"mat3("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+", "+m[6]+", "+m[7]+", "+m[8]+")"},le.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8])},le.add=function(m,x,M){return m[0]=x[0]+M[0],m[1]=x[1]+M[1],m[2]=x[2]+M[2],m[3]=x[3]+M[3],m[4]=x[4]+M[4],m[5]=x[5]+M[5],m[6]=x[6]+M[6],m[7]=x[7]+M[7],m[8]=x[8]+M[8],m},le.subtract=v,le.multiplyScalar=function(m,x,M){return m[0]=x[0]*M,m[1]=x[1]*M,m[2]=x[2]*M,m[3]=x[3]*M,m[4]=x[4]*M,m[5]=x[5]*M,m[6]=x[6]*M,m[7]=x[7]*M,m[8]=x[8]*M,m},le.multiplyScalarAndAdd=function(m,x,M,j){return m[0]=x[0]+M[0]*j,m[1]=x[1]+M[1]*j,m[2]=x[2]+M[2]*j,m[3]=x[3]+M[3]*j,m[4]=x[4]+M[4]*j,m[5]=x[5]+M[5]*j,m[6]=x[6]+M[6]*j,m[7]=x[7]+M[7]*j,m[8]=x[8]+M[8]*j,m},le.exactEquals=function(m,x){return m[0]===x[0]&&m[1]===x[1]&&m[2]===x[2]&&m[3]===x[3]&&m[4]===x[4]&&m[5]===x[5]&&m[6]===x[6]&&m[7]===x[7]&&m[8]===x[8]},le.equals=function(m,x){var M=m[0],j=m[1],F=m[2],E=m[3],N=m[4],L=m[5],k=m[6],I=m[7],$=m[8],Y=x[0],ee=x[1],oe=x[2],se=x[3],ie=x[4],he=x[5],me=x[6],be=x[7],Re=x[8];return Math.abs(M-Y)<=o.EPSILON*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(j-ee)<=o.EPSILON*Math.max(1,Math.abs(j),Math.abs(ee))&&Math.abs(F-oe)<=o.EPSILON*Math.max(1,Math.abs(F),Math.abs(oe))&&Math.abs(E-se)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(se))&&Math.abs(N-ie)<=o.EPSILON*Math.max(1,Math.abs(N),Math.abs(ie))&&Math.abs(L-he)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(he))&&Math.abs(k-me)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(me))&&Math.abs(I-be)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(be))&&Math.abs($-Re)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(Re))},le.sub=le.mul=void 0;var o=function(m,x){if(m&&m.__esModule)return m;if(m===null||d(m)!=="object"&&typeof m!="function")return{default:m};var M=c(void 0);if(M&&M.has(m))return M.get(m);var j={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in m)if(E!=="default"&&Object.prototype.hasOwnProperty.call(m,E)){var N=F?Object.getOwnPropertyDescriptor(m,E):null;N&&(N.get||N.set)?Object.defineProperty(j,E,N):j[E]=m[E]}return j.default=m,M&&M.set(m,j),j}(R());function c(m){if(typeof WeakMap!="function")return null;var x=new WeakMap,M=new WeakMap;return(c=function(j){return j?M:x})(m)}function p(m,x,M){var j=x[0],F=x[1],E=x[2],N=x[3],L=x[4],k=x[5],I=x[6],$=x[7],Y=x[8],ee=M[0],oe=M[1],se=M[2],ie=M[3],he=M[4],me=M[5],be=M[6],Re=M[7],Me=M[8];return m[0]=ee*j+oe*N+se*I,m[1]=ee*F+oe*L+se*$,m[2]=ee*E+oe*k+se*Y,m[3]=ie*j+he*N+me*I,m[4]=ie*F+he*L+me*$,m[5]=ie*E+he*k+me*Y,m[6]=be*j+Re*N+Me*I,m[7]=be*F+Re*L+Me*$,m[8]=be*E+Re*k+Me*Y,m}function v(m,x,M){return m[0]=x[0]-M[0],m[1]=x[1]-M[1],m[2]=x[2]-M[2],m[3]=x[3]-M[3],m[4]=x[4]-M[4],m[5]=x[5]-M[5],m[6]=x[6]-M[6],m[7]=x[7]-M[7],m[8]=x[8]-M[8],m}return le.mul=p,le.sub=v,le}var de,ue={};function ve(){if(de)return ue;function d(E){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},d(E)}de=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.create=function(){var E=new o.ARRAY_TYPE(16);return o.ARRAY_TYPE!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E},ue.clone=function(E){var N=new o.ARRAY_TYPE(16);return N[0]=E[0],N[1]=E[1],N[2]=E[2],N[3]=E[3],N[4]=E[4],N[5]=E[5],N[6]=E[6],N[7]=E[7],N[8]=E[8],N[9]=E[9],N[10]=E[10],N[11]=E[11],N[12]=E[12],N[13]=E[13],N[14]=E[14],N[15]=E[15],N},ue.copy=function(E,N){return E[0]=N[0],E[1]=N[1],E[2]=N[2],E[3]=N[3],E[4]=N[4],E[5]=N[5],E[6]=N[6],E[7]=N[7],E[8]=N[8],E[9]=N[9],E[10]=N[10],E[11]=N[11],E[12]=N[12],E[13]=N[13],E[14]=N[14],E[15]=N[15],E},ue.fromValues=function(E,N,L,k,I,$,Y,ee,oe,se,ie,he,me,be,Re,Me){var Ce=new o.ARRAY_TYPE(16);return Ce[0]=E,Ce[1]=N,Ce[2]=L,Ce[3]=k,Ce[4]=I,Ce[5]=$,Ce[6]=Y,Ce[7]=ee,Ce[8]=oe,Ce[9]=se,Ce[10]=ie,Ce[11]=he,Ce[12]=me,Ce[13]=be,Ce[14]=Re,Ce[15]=Me,Ce},ue.set=function(E,N,L,k,I,$,Y,ee,oe,se,ie,he,me,be,Re,Me,Ce){return E[0]=N,E[1]=L,E[2]=k,E[3]=I,E[4]=$,E[5]=Y,E[6]=ee,E[7]=oe,E[8]=se,E[9]=ie,E[10]=he,E[11]=me,E[12]=be,E[13]=Re,E[14]=Me,E[15]=Ce,E},ue.identity=p,ue.transpose=function(E,N){if(E===N){var L=N[1],k=N[2],I=N[3],$=N[6],Y=N[7],ee=N[11];E[1]=N[4],E[2]=N[8],E[3]=N[12],E[4]=L,E[6]=N[9],E[7]=N[13],E[8]=k,E[9]=$,E[11]=N[14],E[12]=I,E[13]=Y,E[14]=ee}else E[0]=N[0],E[1]=N[4],E[2]=N[8],E[3]=N[12],E[4]=N[1],E[5]=N[5],E[6]=N[9],E[7]=N[13],E[8]=N[2],E[9]=N[6],E[10]=N[10],E[11]=N[14],E[12]=N[3],E[13]=N[7],E[14]=N[11],E[15]=N[15];return E},ue.invert=function(E,N){var L=N[0],k=N[1],I=N[2],$=N[3],Y=N[4],ee=N[5],oe=N[6],se=N[7],ie=N[8],he=N[9],me=N[10],be=N[11],Re=N[12],Me=N[13],Ce=N[14],Xe=N[15],Ie=L*ee-k*Y,Qe=L*oe-I*Y,ot=L*se-$*Y,nt=k*oe-I*ee,lt=k*se-$*ee,dt=I*se-$*oe,yt=ie*Me-he*Re,ct=ie*Ce-me*Re,jt=ie*Xe-be*Re,Vt=he*Ce-me*Me,kt=he*Xe-be*Me,cr=me*Xe-be*Ce,ir=Ie*cr-Qe*kt+ot*Vt+nt*jt-lt*ct+dt*yt;return ir?(E[0]=(ee*cr-oe*kt+se*Vt)*(ir=1/ir),E[1]=(I*kt-k*cr-$*Vt)*ir,E[2]=(Me*dt-Ce*lt+Xe*nt)*ir,E[3]=(me*lt-he*dt-be*nt)*ir,E[4]=(oe*jt-Y*cr-se*ct)*ir,E[5]=(L*cr-I*jt+$*ct)*ir,E[6]=(Ce*ot-Re*dt-Xe*Qe)*ir,E[7]=(ie*dt-me*ot+be*Qe)*ir,E[8]=(Y*kt-ee*jt+se*yt)*ir,E[9]=(k*jt-L*kt-$*yt)*ir,E[10]=(Re*lt-Me*ot+Xe*Ie)*ir,E[11]=(he*ot-ie*lt-be*Ie)*ir,E[12]=(ee*ct-Y*Vt-oe*yt)*ir,E[13]=(L*Vt-k*ct+I*yt)*ir,E[14]=(Me*Qe-Re*nt-Ce*Ie)*ir,E[15]=(ie*nt-he*Qe+me*Ie)*ir,E):null},ue.adjoint=function(E,N){var L=N[0],k=N[1],I=N[2],$=N[3],Y=N[4],ee=N[5],oe=N[6],se=N[7],ie=N[8],he=N[9],me=N[10],be=N[11],Re=N[12],Me=N[13],Ce=N[14],Xe=N[15];return E[0]=ee*(me*Xe-be*Ce)-he*(oe*Xe-se*Ce)+Me*(oe*be-se*me),E[1]=-(k*(me*Xe-be*Ce)-he*(I*Xe-$*Ce)+Me*(I*be-$*me)),E[2]=k*(oe*Xe-se*Ce)-ee*(I*Xe-$*Ce)+Me*(I*se-$*oe),E[3]=-(k*(oe*be-se*me)-ee*(I*be-$*me)+he*(I*se-$*oe)),E[4]=-(Y*(me*Xe-be*Ce)-ie*(oe*Xe-se*Ce)+Re*(oe*be-se*me)),E[5]=L*(me*Xe-be*Ce)-ie*(I*Xe-$*Ce)+Re*(I*be-$*me),E[6]=-(L*(oe*Xe-se*Ce)-Y*(I*Xe-$*Ce)+Re*(I*se-$*oe)),E[7]=L*(oe*be-se*me)-Y*(I*be-$*me)+ie*(I*se-$*oe),E[8]=Y*(he*Xe-be*Me)-ie*(ee*Xe-se*Me)+Re*(ee*be-se*he),E[9]=-(L*(he*Xe-be*Me)-ie*(k*Xe-$*Me)+Re*(k*be-$*he)),E[10]=L*(ee*Xe-se*Me)-Y*(k*Xe-$*Me)+Re*(k*se-$*ee),E[11]=-(L*(ee*be-se*he)-Y*(k*be-$*he)+ie*(k*se-$*ee)),E[12]=-(Y*(he*Ce-me*Me)-ie*(ee*Ce-oe*Me)+Re*(ee*me-oe*he)),E[13]=L*(he*Ce-me*Me)-ie*(k*Ce-I*Me)+Re*(k*me-I*he),E[14]=-(L*(ee*Ce-oe*Me)-Y*(k*Ce-I*Me)+Re*(k*oe-I*ee)),E[15]=L*(ee*me-oe*he)-Y*(k*me-I*he)+ie*(k*oe-I*ee),E},ue.determinant=function(E){var N=E[0],L=E[1],k=E[2],I=E[3],$=E[4],Y=E[5],ee=E[6],oe=E[7],se=E[8],ie=E[9],he=E[10],me=E[11],be=E[12],Re=E[13],Me=E[14],Ce=E[15];return(N*Y-L*$)*(he*Ce-me*Me)-(N*ee-k*$)*(ie*Ce-me*Re)+(N*oe-I*$)*(ie*Me-he*Re)+(L*ee-k*Y)*(se*Ce-me*be)-(L*oe-I*Y)*(se*Me-he*be)+(k*oe-I*ee)*(se*Re-ie*be)},ue.multiply=v,ue.translate=function(E,N,L){var k,I,$,Y,ee,oe,se,ie,he,me,be,Re,Me=L[0],Ce=L[1],Xe=L[2];return N===E?(E[12]=N[0]*Me+N[4]*Ce+N[8]*Xe+N[12],E[13]=N[1]*Me+N[5]*Ce+N[9]*Xe+N[13],E[14]=N[2]*Me+N[6]*Ce+N[10]*Xe+N[14],E[15]=N[3]*Me+N[7]*Ce+N[11]*Xe+N[15]):(I=N[1],$=N[2],Y=N[3],ee=N[4],oe=N[5],se=N[6],ie=N[7],he=N[8],me=N[9],be=N[10],Re=N[11],E[0]=k=N[0],E[1]=I,E[2]=$,E[3]=Y,E[4]=ee,E[5]=oe,E[6]=se,E[7]=ie,E[8]=he,E[9]=me,E[10]=be,E[11]=Re,E[12]=k*Me+ee*Ce+he*Xe+N[12],E[13]=I*Me+oe*Ce+me*Xe+N[13],E[14]=$*Me+se*Ce+be*Xe+N[14],E[15]=Y*Me+ie*Ce+Re*Xe+N[15]),E},ue.scale=function(E,N,L){var k=L[0],I=L[1],$=L[2];return E[0]=N[0]*k,E[1]=N[1]*k,E[2]=N[2]*k,E[3]=N[3]*k,E[4]=N[4]*I,E[5]=N[5]*I,E[6]=N[6]*I,E[7]=N[7]*I,E[8]=N[8]*$,E[9]=N[9]*$,E[10]=N[10]*$,E[11]=N[11]*$,E[12]=N[12],E[13]=N[13],E[14]=N[14],E[15]=N[15],E},ue.rotate=function(E,N,L,k){var I,$,Y,ee,oe,se,ie,he,me,be,Re,Me,Ce,Xe,Ie,Qe,ot,nt,lt,dt,yt,ct,jt,Vt,kt=k[0],cr=k[1],ir=k[2],Xt=Math.hypot(kt,cr,ir);return Xt<o.EPSILON?null:(kt*=Xt=1/Xt,cr*=Xt,ir*=Xt,I=Math.sin(L),$=Math.cos(L),oe=N[1],se=N[2],ie=N[3],me=N[5],be=N[6],Re=N[7],Ce=N[9],Xe=N[10],Ie=N[11],Qe=kt*kt*(Y=1-$)+$,lt=kt*cr*Y-ir*I,dt=cr*cr*Y+$,yt=ir*cr*Y+kt*I,ct=kt*ir*Y+cr*I,jt=cr*ir*Y-kt*I,Vt=ir*ir*Y+$,E[0]=(ee=N[0])*Qe+(he=N[4])*(ot=cr*kt*Y+ir*I)+(Me=N[8])*(nt=ir*kt*Y-cr*I),E[1]=oe*Qe+me*ot+Ce*nt,E[2]=se*Qe+be*ot+Xe*nt,E[3]=ie*Qe+Re*ot+Ie*nt,E[4]=ee*lt+he*dt+Me*yt,E[5]=oe*lt+me*dt+Ce*yt,E[6]=se*lt+be*dt+Xe*yt,E[7]=ie*lt+Re*dt+Ie*yt,E[8]=ee*ct+he*jt+Me*Vt,E[9]=oe*ct+me*jt+Ce*Vt,E[10]=se*ct+be*jt+Xe*Vt,E[11]=ie*ct+Re*jt+Ie*Vt,N!==E&&(E[12]=N[12],E[13]=N[13],E[14]=N[14],E[15]=N[15]),E)},ue.rotateX=function(E,N,L){var k=Math.sin(L),I=Math.cos(L),$=N[4],Y=N[5],ee=N[6],oe=N[7],se=N[8],ie=N[9],he=N[10],me=N[11];return N!==E&&(E[0]=N[0],E[1]=N[1],E[2]=N[2],E[3]=N[3],E[12]=N[12],E[13]=N[13],E[14]=N[14],E[15]=N[15]),E[4]=$*I+se*k,E[5]=Y*I+ie*k,E[6]=ee*I+he*k,E[7]=oe*I+me*k,E[8]=se*I-$*k,E[9]=ie*I-Y*k,E[10]=he*I-ee*k,E[11]=me*I-oe*k,E},ue.rotateY=function(E,N,L){var k=Math.sin(L),I=Math.cos(L),$=N[0],Y=N[1],ee=N[2],oe=N[3],se=N[8],ie=N[9],he=N[10],me=N[11];return N!==E&&(E[4]=N[4],E[5]=N[5],E[6]=N[6],E[7]=N[7],E[12]=N[12],E[13]=N[13],E[14]=N[14],E[15]=N[15]),E[0]=$*I-se*k,E[1]=Y*I-ie*k,E[2]=ee*I-he*k,E[3]=oe*I-me*k,E[8]=$*k+se*I,E[9]=Y*k+ie*I,E[10]=ee*k+he*I,E[11]=oe*k+me*I,E},ue.rotateZ=function(E,N,L){var k=Math.sin(L),I=Math.cos(L),$=N[0],Y=N[1],ee=N[2],oe=N[3],se=N[4],ie=N[5],he=N[6],me=N[7];return N!==E&&(E[8]=N[8],E[9]=N[9],E[10]=N[10],E[11]=N[11],E[12]=N[12],E[13]=N[13],E[14]=N[14],E[15]=N[15]),E[0]=$*I+se*k,E[1]=Y*I+ie*k,E[2]=ee*I+he*k,E[3]=oe*I+me*k,E[4]=se*I-$*k,E[5]=ie*I-Y*k,E[6]=he*I-ee*k,E[7]=me*I-oe*k,E},ue.fromTranslation=function(E,N){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=N[0],E[13]=N[1],E[14]=N[2],E[15]=1,E},ue.fromScaling=function(E,N){return E[0]=N[0],E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=N[1],E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=N[2],E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},ue.fromRotation=function(E,N,L){var k,I,$,Y=L[0],ee=L[1],oe=L[2],se=Math.hypot(Y,ee,oe);return se<o.EPSILON?null:(Y*=se=1/se,ee*=se,oe*=se,k=Math.sin(N),I=Math.cos(N),E[0]=Y*Y*($=1-I)+I,E[1]=ee*Y*$+oe*k,E[2]=oe*Y*$-ee*k,E[3]=0,E[4]=Y*ee*$-oe*k,E[5]=ee*ee*$+I,E[6]=oe*ee*$+Y*k,E[7]=0,E[8]=Y*oe*$+ee*k,E[9]=ee*oe*$-Y*k,E[10]=oe*oe*$+I,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E)},ue.fromXRotation=function(E,N){var L=Math.sin(N),k=Math.cos(N);return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=k,E[6]=L,E[7]=0,E[8]=0,E[9]=-L,E[10]=k,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},ue.fromYRotation=function(E,N){var L=Math.sin(N),k=Math.cos(N);return E[0]=k,E[1]=0,E[2]=-L,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=L,E[9]=0,E[10]=k,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},ue.fromZRotation=function(E,N){var L=Math.sin(N),k=Math.cos(N);return E[0]=k,E[1]=L,E[2]=0,E[3]=0,E[4]=-L,E[5]=k,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},ue.fromRotationTranslation=m,ue.fromQuat2=function(E,N){var L=new o.ARRAY_TYPE(3),k=-N[0],I=-N[1],$=-N[2],Y=N[3],ee=N[4],oe=N[5],se=N[6],ie=N[7],he=k*k+I*I+$*$+Y*Y;return he>0?(L[0]=2*(ee*Y+ie*k+oe*$-se*I)/he,L[1]=2*(oe*Y+ie*I+se*k-ee*$)/he,L[2]=2*(se*Y+ie*$+ee*I-oe*k)/he):(L[0]=2*(ee*Y+ie*k+oe*$-se*I),L[1]=2*(oe*Y+ie*I+se*k-ee*$),L[2]=2*(se*Y+ie*$+ee*I-oe*k)),m(E,N,L),E},ue.getTranslation=function(E,N){return E[0]=N[12],E[1]=N[13],E[2]=N[14],E},ue.getScaling=x,ue.getRotation=function(E,N){var L=new o.ARRAY_TYPE(3);x(L,N);var k=1/L[0],I=1/L[1],$=1/L[2],Y=N[0]*k,ee=N[1]*I,oe=N[2]*$,se=N[4]*k,ie=N[5]*I,he=N[6]*$,me=N[8]*k,be=N[9]*I,Re=N[10]*$,Me=Y+ie+Re,Ce=0;return Me>0?(Ce=2*Math.sqrt(Me+1),E[3]=.25*Ce,E[0]=(he-be)/Ce,E[1]=(me-oe)/Ce,E[2]=(ee-se)/Ce):Y>ie&&Y>Re?(Ce=2*Math.sqrt(1+Y-ie-Re),E[3]=(he-be)/Ce,E[0]=.25*Ce,E[1]=(ee+se)/Ce,E[2]=(me+oe)/Ce):ie>Re?(Ce=2*Math.sqrt(1+ie-Y-Re),E[3]=(me-oe)/Ce,E[0]=(ee+se)/Ce,E[1]=.25*Ce,E[2]=(he+be)/Ce):(Ce=2*Math.sqrt(1+Re-Y-ie),E[3]=(ee-se)/Ce,E[0]=(me+oe)/Ce,E[1]=(he+be)/Ce,E[2]=.25*Ce),E},ue.fromRotationTranslationScale=function(E,N,L,k){var I=N[0],$=N[1],Y=N[2],ee=N[3],oe=I+I,se=$+$,ie=Y+Y,he=I*oe,me=I*se,be=I*ie,Re=$*se,Me=$*ie,Ce=Y*ie,Xe=ee*oe,Ie=ee*se,Qe=ee*ie,ot=k[0],nt=k[1],lt=k[2];return E[0]=(1-(Re+Ce))*ot,E[1]=(me+Qe)*ot,E[2]=(be-Ie)*ot,E[3]=0,E[4]=(me-Qe)*nt,E[5]=(1-(he+Ce))*nt,E[6]=(Me+Xe)*nt,E[7]=0,E[8]=(be+Ie)*lt,E[9]=(Me-Xe)*lt,E[10]=(1-(he+Re))*lt,E[11]=0,E[12]=L[0],E[13]=L[1],E[14]=L[2],E[15]=1,E},ue.fromRotationTranslationScaleOrigin=function(E,N,L,k,I){var $=N[0],Y=N[1],ee=N[2],oe=N[3],se=$+$,ie=Y+Y,he=ee+ee,me=$*se,be=$*ie,Re=$*he,Me=Y*ie,Ce=Y*he,Xe=ee*he,Ie=oe*se,Qe=oe*ie,ot=oe*he,nt=k[0],lt=k[1],dt=k[2],yt=I[0],ct=I[1],jt=I[2],Vt=(1-(Me+Xe))*nt,kt=(be+ot)*nt,cr=(Re-Qe)*nt,ir=(be-ot)*lt,Xt=(1-(me+Xe))*lt,Ut=(Ce+Ie)*lt,Er=(Re+Qe)*dt,pr=(Ce-Ie)*dt,vr=(1-(me+Me))*dt;return E[0]=Vt,E[1]=kt,E[2]=cr,E[3]=0,E[4]=ir,E[5]=Xt,E[6]=Ut,E[7]=0,E[8]=Er,E[9]=pr,E[10]=vr,E[11]=0,E[12]=L[0]+yt-(Vt*yt+ir*ct+Er*jt),E[13]=L[1]+ct-(kt*yt+Xt*ct+pr*jt),E[14]=L[2]+jt-(cr*yt+Ut*ct+vr*jt),E[15]=1,E},ue.fromQuat=function(E,N){var L=N[0],k=N[1],I=N[2],$=N[3],Y=L+L,ee=k+k,oe=I+I,se=L*Y,ie=k*Y,he=k*ee,me=I*Y,be=I*ee,Re=I*oe,Me=$*Y,Ce=$*ee,Xe=$*oe;return E[0]=1-he-Re,E[1]=ie+Xe,E[2]=me-Ce,E[3]=0,E[4]=ie-Xe,E[5]=1-se-Re,E[6]=be+Me,E[7]=0,E[8]=me+Ce,E[9]=be-Me,E[10]=1-se-he,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},ue.frustum=function(E,N,L,k,I,$,Y){var ee=1/(L-N),oe=1/(I-k),se=1/($-Y);return E[0]=2*$*ee,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=2*$*oe,E[6]=0,E[7]=0,E[8]=(L+N)*ee,E[9]=(I+k)*oe,E[10]=(Y+$)*se,E[11]=-1,E[12]=0,E[13]=0,E[14]=Y*$*2*se,E[15]=0,E},ue.perspectiveNO=M,ue.perspectiveZO=function(E,N,L,k,I){var $,Y=1/Math.tan(N/2);return E[0]=Y/L,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=Y,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,I!=null&&I!==1/0?(E[10]=I*($=1/(k-I)),E[14]=I*k*$):(E[10]=-1,E[14]=-k),E},ue.perspectiveFromFieldOfView=function(E,N,L,k){var I=Math.tan(N.upDegrees*Math.PI/180),$=Math.tan(N.downDegrees*Math.PI/180),Y=Math.tan(N.leftDegrees*Math.PI/180),ee=Math.tan(N.rightDegrees*Math.PI/180),oe=2/(Y+ee),se=2/(I+$);return E[0]=oe,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=se,E[6]=0,E[7]=0,E[8]=-(Y-ee)*oe*.5,E[9]=(I-$)*se*.5,E[10]=k/(L-k),E[11]=-1,E[12]=0,E[13]=0,E[14]=k*L/(L-k),E[15]=0,E},ue.orthoNO=j,ue.orthoZO=function(E,N,L,k,I,$,Y){var ee=1/(N-L),oe=1/(k-I),se=1/($-Y);return E[0]=-2*ee,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*oe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=se,E[11]=0,E[12]=(N+L)*ee,E[13]=(I+k)*oe,E[14]=$*se,E[15]=1,E},ue.lookAt=function(E,N,L,k){var I,$,Y,ee,oe,se,ie,he,me,be,Re=N[0],Me=N[1],Ce=N[2],Xe=k[0],Ie=k[1],Qe=k[2],ot=L[0],nt=L[1],lt=L[2];return Math.abs(Re-ot)<o.EPSILON&&Math.abs(Me-nt)<o.EPSILON&&Math.abs(Ce-lt)<o.EPSILON?p(E):(ie=Re-ot,he=Me-nt,me=Ce-lt,I=Ie*(me*=be=1/Math.hypot(ie,he,me))-Qe*(he*=be),$=Qe*(ie*=be)-Xe*me,Y=Xe*he-Ie*ie,(be=Math.hypot(I,$,Y))?(I*=be=1/be,$*=be,Y*=be):(I=0,$=0,Y=0),ee=he*Y-me*$,oe=me*I-ie*Y,se=ie*$-he*I,(be=Math.hypot(ee,oe,se))?(ee*=be=1/be,oe*=be,se*=be):(ee=0,oe=0,se=0),E[0]=I,E[1]=ee,E[2]=ie,E[3]=0,E[4]=$,E[5]=oe,E[6]=he,E[7]=0,E[8]=Y,E[9]=se,E[10]=me,E[11]=0,E[12]=-(I*Re+$*Me+Y*Ce),E[13]=-(ee*Re+oe*Me+se*Ce),E[14]=-(ie*Re+he*Me+me*Ce),E[15]=1,E)},ue.targetTo=function(E,N,L,k){var I=N[0],$=N[1],Y=N[2],ee=k[0],oe=k[1],se=k[2],ie=I-L[0],he=$-L[1],me=Y-L[2],be=ie*ie+he*he+me*me;be>0&&(ie*=be=1/Math.sqrt(be),he*=be,me*=be);var Re=oe*me-se*he,Me=se*ie-ee*me,Ce=ee*he-oe*ie;return(be=Re*Re+Me*Me+Ce*Ce)>0&&(Re*=be=1/Math.sqrt(be),Me*=be,Ce*=be),E[0]=Re,E[1]=Me,E[2]=Ce,E[3]=0,E[4]=he*Ce-me*Me,E[5]=me*Re-ie*Ce,E[6]=ie*Me-he*Re,E[7]=0,E[8]=ie,E[9]=he,E[10]=me,E[11]=0,E[12]=I,E[13]=$,E[14]=Y,E[15]=1,E},ue.str=function(E){return"mat4("+E[0]+", "+E[1]+", "+E[2]+", "+E[3]+", "+E[4]+", "+E[5]+", "+E[6]+", "+E[7]+", "+E[8]+", "+E[9]+", "+E[10]+", "+E[11]+", "+E[12]+", "+E[13]+", "+E[14]+", "+E[15]+")"},ue.frob=function(E){return Math.hypot(E[0],E[1],E[2],E[3],E[4],E[5],E[6],E[7],E[8],E[9],E[10],E[11],E[12],E[13],E[14],E[15])},ue.add=function(E,N,L){return E[0]=N[0]+L[0],E[1]=N[1]+L[1],E[2]=N[2]+L[2],E[3]=N[3]+L[3],E[4]=N[4]+L[4],E[5]=N[5]+L[5],E[6]=N[6]+L[6],E[7]=N[7]+L[7],E[8]=N[8]+L[8],E[9]=N[9]+L[9],E[10]=N[10]+L[10],E[11]=N[11]+L[11],E[12]=N[12]+L[12],E[13]=N[13]+L[13],E[14]=N[14]+L[14],E[15]=N[15]+L[15],E},ue.subtract=F,ue.multiplyScalar=function(E,N,L){return E[0]=N[0]*L,E[1]=N[1]*L,E[2]=N[2]*L,E[3]=N[3]*L,E[4]=N[4]*L,E[5]=N[5]*L,E[6]=N[6]*L,E[7]=N[7]*L,E[8]=N[8]*L,E[9]=N[9]*L,E[10]=N[10]*L,E[11]=N[11]*L,E[12]=N[12]*L,E[13]=N[13]*L,E[14]=N[14]*L,E[15]=N[15]*L,E},ue.multiplyScalarAndAdd=function(E,N,L,k){return E[0]=N[0]+L[0]*k,E[1]=N[1]+L[1]*k,E[2]=N[2]+L[2]*k,E[3]=N[3]+L[3]*k,E[4]=N[4]+L[4]*k,E[5]=N[5]+L[5]*k,E[6]=N[6]+L[6]*k,E[7]=N[7]+L[7]*k,E[8]=N[8]+L[8]*k,E[9]=N[9]+L[9]*k,E[10]=N[10]+L[10]*k,E[11]=N[11]+L[11]*k,E[12]=N[12]+L[12]*k,E[13]=N[13]+L[13]*k,E[14]=N[14]+L[14]*k,E[15]=N[15]+L[15]*k,E},ue.exactEquals=function(E,N){return E[0]===N[0]&&E[1]===N[1]&&E[2]===N[2]&&E[3]===N[3]&&E[4]===N[4]&&E[5]===N[5]&&E[6]===N[6]&&E[7]===N[7]&&E[8]===N[8]&&E[9]===N[9]&&E[10]===N[10]&&E[11]===N[11]&&E[12]===N[12]&&E[13]===N[13]&&E[14]===N[14]&&E[15]===N[15]},ue.equals=function(E,N){var L=E[0],k=E[1],I=E[2],$=E[3],Y=E[4],ee=E[5],oe=E[6],se=E[7],ie=E[8],he=E[9],me=E[10],be=E[11],Re=E[12],Me=E[13],Ce=E[14],Xe=E[15],Ie=N[0],Qe=N[1],ot=N[2],nt=N[3],lt=N[4],dt=N[5],yt=N[6],ct=N[7],jt=N[8],Vt=N[9],kt=N[10],cr=N[11],ir=N[12],Xt=N[13],Ut=N[14],Er=N[15];return Math.abs(L-Ie)<=o.EPSILON*Math.max(1,Math.abs(L),Math.abs(Ie))&&Math.abs(k-Qe)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(Qe))&&Math.abs(I-ot)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(ot))&&Math.abs($-nt)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(nt))&&Math.abs(Y-lt)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(lt))&&Math.abs(ee-dt)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(dt))&&Math.abs(oe-yt)<=o.EPSILON*Math.max(1,Math.abs(oe),Math.abs(yt))&&Math.abs(se-ct)<=o.EPSILON*Math.max(1,Math.abs(se),Math.abs(ct))&&Math.abs(ie-jt)<=o.EPSILON*Math.max(1,Math.abs(ie),Math.abs(jt))&&Math.abs(he-Vt)<=o.EPSILON*Math.max(1,Math.abs(he),Math.abs(Vt))&&Math.abs(me-kt)<=o.EPSILON*Math.max(1,Math.abs(me),Math.abs(kt))&&Math.abs(be-cr)<=o.EPSILON*Math.max(1,Math.abs(be),Math.abs(cr))&&Math.abs(Re-ir)<=o.EPSILON*Math.max(1,Math.abs(Re),Math.abs(ir))&&Math.abs(Me-Xt)<=o.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Xt))&&Math.abs(Ce-Ut)<=o.EPSILON*Math.max(1,Math.abs(Ce),Math.abs(Ut))&&Math.abs(Xe-Er)<=o.EPSILON*Math.max(1,Math.abs(Xe),Math.abs(Er))},ue.sub=ue.mul=ue.ortho=ue.perspective=void 0;var o=function(E,N){if(E&&E.__esModule)return E;if(E===null||d(E)!=="object"&&typeof E!="function")return{default:E};var L=c(void 0);if(L&&L.has(E))return L.get(E);var k={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in E)if($!=="default"&&Object.prototype.hasOwnProperty.call(E,$)){var Y=I?Object.getOwnPropertyDescriptor(E,$):null;Y&&(Y.get||Y.set)?Object.defineProperty(k,$,Y):k[$]=E[$]}return k.default=E,L&&L.set(E,k),k}(R());function c(E){if(typeof WeakMap!="function")return null;var N=new WeakMap,L=new WeakMap;return(c=function(k){return k?L:N})(E)}function p(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function v(E,N,L){var k=N[0],I=N[1],$=N[2],Y=N[3],ee=N[4],oe=N[5],se=N[6],ie=N[7],he=N[8],me=N[9],be=N[10],Re=N[11],Me=N[12],Ce=N[13],Xe=N[14],Ie=N[15],Qe=L[0],ot=L[1],nt=L[2],lt=L[3];return E[0]=Qe*k+ot*ee+nt*he+lt*Me,E[1]=Qe*I+ot*oe+nt*me+lt*Ce,E[2]=Qe*$+ot*se+nt*be+lt*Xe,E[3]=Qe*Y+ot*ie+nt*Re+lt*Ie,E[4]=(Qe=L[4])*k+(ot=L[5])*ee+(nt=L[6])*he+(lt=L[7])*Me,E[5]=Qe*I+ot*oe+nt*me+lt*Ce,E[6]=Qe*$+ot*se+nt*be+lt*Xe,E[7]=Qe*Y+ot*ie+nt*Re+lt*Ie,E[8]=(Qe=L[8])*k+(ot=L[9])*ee+(nt=L[10])*he+(lt=L[11])*Me,E[9]=Qe*I+ot*oe+nt*me+lt*Ce,E[10]=Qe*$+ot*se+nt*be+lt*Xe,E[11]=Qe*Y+ot*ie+nt*Re+lt*Ie,E[12]=(Qe=L[12])*k+(ot=L[13])*ee+(nt=L[14])*he+(lt=L[15])*Me,E[13]=Qe*I+ot*oe+nt*me+lt*Ce,E[14]=Qe*$+ot*se+nt*be+lt*Xe,E[15]=Qe*Y+ot*ie+nt*Re+lt*Ie,E}function m(E,N,L){var k=N[0],I=N[1],$=N[2],Y=N[3],ee=k+k,oe=I+I,se=$+$,ie=k*ee,he=k*oe,me=k*se,be=I*oe,Re=I*se,Me=$*se,Ce=Y*ee,Xe=Y*oe,Ie=Y*se;return E[0]=1-(be+Me),E[1]=he+Ie,E[2]=me-Xe,E[3]=0,E[4]=he-Ie,E[5]=1-(ie+Me),E[6]=Re+Ce,E[7]=0,E[8]=me+Xe,E[9]=Re-Ce,E[10]=1-(ie+be),E[11]=0,E[12]=L[0],E[13]=L[1],E[14]=L[2],E[15]=1,E}function x(E,N){var L=N[4],k=N[5],I=N[6],$=N[8],Y=N[9],ee=N[10];return E[0]=Math.hypot(N[0],N[1],N[2]),E[1]=Math.hypot(L,k,I),E[2]=Math.hypot($,Y,ee),E}function M(E,N,L,k,I){var $,Y=1/Math.tan(N/2);return E[0]=Y/L,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=Y,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,I!=null&&I!==1/0?(E[10]=(I+k)*($=1/(k-I)),E[14]=2*I*k*$):(E[10]=-1,E[14]=-2*k),E}function j(E,N,L,k,I,$,Y){var ee=1/(N-L),oe=1/(k-I),se=1/($-Y);return E[0]=-2*ee,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*oe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*se,E[11]=0,E[12]=(N+L)*ee,E[13]=(I+k)*oe,E[14]=(Y+$)*se,E[15]=1,E}function F(E,N,L){return E[0]=N[0]-L[0],E[1]=N[1]-L[1],E[2]=N[2]-L[2],E[3]=N[3]-L[3],E[4]=N[4]-L[4],E[5]=N[5]-L[5],E[6]=N[6]-L[6],E[7]=N[7]-L[7],E[8]=N[8]-L[8],E[9]=N[9]-L[9],E[10]=N[10]-L[10],E[11]=N[11]-L[11],E[12]=N[12]-L[12],E[13]=N[13]-L[13],E[14]=N[14]-L[14],E[15]=N[15]-L[15],E}return ue.perspective=M,ue.ortho=j,ue.mul=v,ue.sub=F,ue}var Ae,Oe={},Se={};function ke(){if(Ae)return Se;function d(I){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},d(I)}Ae=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.create=p,Se.clone=function(I){var $=new o.ARRAY_TYPE(3);return $[0]=I[0],$[1]=I[1],$[2]=I[2],$},Se.length=v,Se.fromValues=function(I,$,Y){var ee=new o.ARRAY_TYPE(3);return ee[0]=I,ee[1]=$,ee[2]=Y,ee},Se.copy=function(I,$){return I[0]=$[0],I[1]=$[1],I[2]=$[2],I},Se.set=function(I,$,Y,ee){return I[0]=$,I[1]=Y,I[2]=ee,I},Se.add=function(I,$,Y){return I[0]=$[0]+Y[0],I[1]=$[1]+Y[1],I[2]=$[2]+Y[2],I},Se.subtract=m,Se.multiply=x,Se.divide=M,Se.ceil=function(I,$){return I[0]=Math.ceil($[0]),I[1]=Math.ceil($[1]),I[2]=Math.ceil($[2]),I},Se.floor=function(I,$){return I[0]=Math.floor($[0]),I[1]=Math.floor($[1]),I[2]=Math.floor($[2]),I},Se.min=function(I,$,Y){return I[0]=Math.min($[0],Y[0]),I[1]=Math.min($[1],Y[1]),I[2]=Math.min($[2],Y[2]),I},Se.max=function(I,$,Y){return I[0]=Math.max($[0],Y[0]),I[1]=Math.max($[1],Y[1]),I[2]=Math.max($[2],Y[2]),I},Se.round=function(I,$){return I[0]=Math.round($[0]),I[1]=Math.round($[1]),I[2]=Math.round($[2]),I},Se.scale=function(I,$,Y){return I[0]=$[0]*Y,I[1]=$[1]*Y,I[2]=$[2]*Y,I},Se.scaleAndAdd=function(I,$,Y,ee){return I[0]=$[0]+Y[0]*ee,I[1]=$[1]+Y[1]*ee,I[2]=$[2]+Y[2]*ee,I},Se.distance=j,Se.squaredDistance=F,Se.squaredLength=E,Se.negate=function(I,$){return I[0]=-$[0],I[1]=-$[1],I[2]=-$[2],I},Se.inverse=function(I,$){return I[0]=1/$[0],I[1]=1/$[1],I[2]=1/$[2],I},Se.normalize=function(I,$){var Y=$[0],ee=$[1],oe=$[2],se=Y*Y+ee*ee+oe*oe;return se>0&&(se=1/Math.sqrt(se)),I[0]=$[0]*se,I[1]=$[1]*se,I[2]=$[2]*se,I},Se.dot=N,Se.cross=function(I,$,Y){var ee=$[0],oe=$[1],se=$[2],ie=Y[0],he=Y[1],me=Y[2];return I[0]=oe*me-se*he,I[1]=se*ie-ee*me,I[2]=ee*he-oe*ie,I},Se.lerp=function(I,$,Y,ee){var oe=$[0],se=$[1],ie=$[2];return I[0]=oe+ee*(Y[0]-oe),I[1]=se+ee*(Y[1]-se),I[2]=ie+ee*(Y[2]-ie),I},Se.hermite=function(I,$,Y,ee,oe,se){var ie=se*se,he=ie*(2*se-3)+1,me=ie*(se-2)+se,be=ie*(se-1),Re=ie*(3-2*se);return I[0]=$[0]*he+Y[0]*me+ee[0]*be+oe[0]*Re,I[1]=$[1]*he+Y[1]*me+ee[1]*be+oe[1]*Re,I[2]=$[2]*he+Y[2]*me+ee[2]*be+oe[2]*Re,I},Se.bezier=function(I,$,Y,ee,oe,se){var ie=1-se,he=ie*ie,me=se*se,be=he*ie,Re=3*se*he,Me=3*me*ie,Ce=me*se;return I[0]=$[0]*be+Y[0]*Re+ee[0]*Me+oe[0]*Ce,I[1]=$[1]*be+Y[1]*Re+ee[1]*Me+oe[1]*Ce,I[2]=$[2]*be+Y[2]*Re+ee[2]*Me+oe[2]*Ce,I},Se.random=function(I,$){$=$||1;var Y=2*o.RANDOM()*Math.PI,ee=2*o.RANDOM()-1,oe=Math.sqrt(1-ee*ee)*$;return I[0]=Math.cos(Y)*oe,I[1]=Math.sin(Y)*oe,I[2]=ee*$,I},Se.transformMat4=function(I,$,Y){var ee=$[0],oe=$[1],se=$[2],ie=Y[3]*ee+Y[7]*oe+Y[11]*se+Y[15];return I[0]=(Y[0]*ee+Y[4]*oe+Y[8]*se+Y[12])/(ie=ie||1),I[1]=(Y[1]*ee+Y[5]*oe+Y[9]*se+Y[13])/ie,I[2]=(Y[2]*ee+Y[6]*oe+Y[10]*se+Y[14])/ie,I},Se.transformMat3=function(I,$,Y){var ee=$[0],oe=$[1],se=$[2];return I[0]=ee*Y[0]+oe*Y[3]+se*Y[6],I[1]=ee*Y[1]+oe*Y[4]+se*Y[7],I[2]=ee*Y[2]+oe*Y[5]+se*Y[8],I},Se.transformQuat=function(I,$,Y){var ee=Y[0],oe=Y[1],se=Y[2],ie=$[0],he=$[1],me=$[2],be=oe*me-se*he,Re=se*ie-ee*me,Me=ee*he-oe*ie,Ce=oe*Me-se*Re,Xe=se*be-ee*Me,Ie=ee*Re-oe*be,Qe=2*Y[3];return Re*=Qe,Me*=Qe,Xe*=2,Ie*=2,I[0]=ie+(be*=Qe)+(Ce*=2),I[1]=he+Re+Xe,I[2]=me+Me+Ie,I},Se.rotateX=function(I,$,Y,ee){var oe=[],se=[];return oe[0]=$[0]-Y[0],oe[1]=$[1]-Y[1],oe[2]=$[2]-Y[2],se[0]=oe[0],se[1]=oe[1]*Math.cos(ee)-oe[2]*Math.sin(ee),se[2]=oe[1]*Math.sin(ee)+oe[2]*Math.cos(ee),I[0]=se[0]+Y[0],I[1]=se[1]+Y[1],I[2]=se[2]+Y[2],I},Se.rotateY=function(I,$,Y,ee){var oe=[],se=[];return oe[0]=$[0]-Y[0],oe[1]=$[1]-Y[1],oe[2]=$[2]-Y[2],se[0]=oe[2]*Math.sin(ee)+oe[0]*Math.cos(ee),se[1]=oe[1],se[2]=oe[2]*Math.cos(ee)-oe[0]*Math.sin(ee),I[0]=se[0]+Y[0],I[1]=se[1]+Y[1],I[2]=se[2]+Y[2],I},Se.rotateZ=function(I,$,Y,ee){var oe=[],se=[];return oe[0]=$[0]-Y[0],oe[1]=$[1]-Y[1],oe[2]=$[2]-Y[2],se[0]=oe[0]*Math.cos(ee)-oe[1]*Math.sin(ee),se[1]=oe[0]*Math.sin(ee)+oe[1]*Math.cos(ee),se[2]=oe[2],I[0]=se[0]+Y[0],I[1]=se[1]+Y[1],I[2]=se[2]+Y[2],I},Se.angle=function(I,$){var Y=I[0],ee=I[1],oe=I[2],se=$[0],ie=$[1],he=$[2],me=Math.sqrt(Y*Y+ee*ee+oe*oe)*Math.sqrt(se*se+ie*ie+he*he),be=me&&N(I,$)/me;return Math.acos(Math.min(Math.max(be,-1),1))},Se.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I},Se.str=function(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"},Se.exactEquals=function(I,$){return I[0]===$[0]&&I[1]===$[1]&&I[2]===$[2]},Se.equals=function(I,$){var Y=I[0],ee=I[1],oe=I[2],se=$[0],ie=$[1],he=$[2];return Math.abs(Y-se)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(se))&&Math.abs(ee-ie)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(ie))&&Math.abs(oe-he)<=o.EPSILON*Math.max(1,Math.abs(oe),Math.abs(he))},Se.forEach=Se.sqrLen=Se.len=Se.sqrDist=Se.dist=Se.div=Se.mul=Se.sub=void 0;var o=function(I,$){if(I&&I.__esModule)return I;if(I===null||d(I)!=="object"&&typeof I!="function")return{default:I};var Y=c(void 0);if(Y&&Y.has(I))return Y.get(I);var ee={},oe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in I)if(se!=="default"&&Object.prototype.hasOwnProperty.call(I,se)){var ie=oe?Object.getOwnPropertyDescriptor(I,se):null;ie&&(ie.get||ie.set)?Object.defineProperty(ee,se,ie):ee[se]=I[se]}return ee.default=I,Y&&Y.set(I,ee),ee}(R());function c(I){if(typeof WeakMap!="function")return null;var $=new WeakMap,Y=new WeakMap;return(c=function(ee){return ee?Y:$})(I)}function p(){var I=new o.ARRAY_TYPE(3);return o.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function v(I){return Math.hypot(I[0],I[1],I[2])}function m(I,$,Y){return I[0]=$[0]-Y[0],I[1]=$[1]-Y[1],I[2]=$[2]-Y[2],I}function x(I,$,Y){return I[0]=$[0]*Y[0],I[1]=$[1]*Y[1],I[2]=$[2]*Y[2],I}function M(I,$,Y){return I[0]=$[0]/Y[0],I[1]=$[1]/Y[1],I[2]=$[2]/Y[2],I}function j(I,$){return Math.hypot($[0]-I[0],$[1]-I[1],$[2]-I[2])}function F(I,$){var Y=$[0]-I[0],ee=$[1]-I[1],oe=$[2]-I[2];return Y*Y+ee*ee+oe*oe}function E(I){var $=I[0],Y=I[1],ee=I[2];return $*$+Y*Y+ee*ee}function N(I,$){return I[0]*$[0]+I[1]*$[1]+I[2]*$[2]}Se.sub=m,Se.mul=x,Se.div=M,Se.dist=j,Se.sqrDist=F,Se.len=v,Se.sqrLen=E;var L,k=(L=p(),function(I,$,Y,ee,oe,se){var ie,he;for($||($=3),Y||(Y=0),he=ee?Math.min(ee*$+Y,I.length):I.length,ie=Y;ie<he;ie+=$)L[0]=I[ie],L[1]=I[ie+1],L[2]=I[ie+2],oe(L,L,se),I[ie]=L[0],I[ie+1]=L[1],I[ie+2]=L[2];return I});return Se.forEach=k,Se}var ze,et,je={};function Ne(){if(ze)return je;function d(k){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},d(k)}ze=1,Object.defineProperty(je,"__esModule",{value:!0}),je.create=p,je.clone=function(k){var I=new o.ARRAY_TYPE(4);return I[0]=k[0],I[1]=k[1],I[2]=k[2],I[3]=k[3],I},je.fromValues=function(k,I,$,Y){var ee=new o.ARRAY_TYPE(4);return ee[0]=k,ee[1]=I,ee[2]=$,ee[3]=Y,ee},je.copy=function(k,I){return k[0]=I[0],k[1]=I[1],k[2]=I[2],k[3]=I[3],k},je.set=function(k,I,$,Y,ee){return k[0]=I,k[1]=$,k[2]=Y,k[3]=ee,k},je.add=function(k,I,$){return k[0]=I[0]+$[0],k[1]=I[1]+$[1],k[2]=I[2]+$[2],k[3]=I[3]+$[3],k},je.subtract=v,je.multiply=m,je.divide=x,je.ceil=function(k,I){return k[0]=Math.ceil(I[0]),k[1]=Math.ceil(I[1]),k[2]=Math.ceil(I[2]),k[3]=Math.ceil(I[3]),k},je.floor=function(k,I){return k[0]=Math.floor(I[0]),k[1]=Math.floor(I[1]),k[2]=Math.floor(I[2]),k[3]=Math.floor(I[3]),k},je.min=function(k,I,$){return k[0]=Math.min(I[0],$[0]),k[1]=Math.min(I[1],$[1]),k[2]=Math.min(I[2],$[2]),k[3]=Math.min(I[3],$[3]),k},je.max=function(k,I,$){return k[0]=Math.max(I[0],$[0]),k[1]=Math.max(I[1],$[1]),k[2]=Math.max(I[2],$[2]),k[3]=Math.max(I[3],$[3]),k},je.round=function(k,I){return k[0]=Math.round(I[0]),k[1]=Math.round(I[1]),k[2]=Math.round(I[2]),k[3]=Math.round(I[3]),k},je.scale=function(k,I,$){return k[0]=I[0]*$,k[1]=I[1]*$,k[2]=I[2]*$,k[3]=I[3]*$,k},je.scaleAndAdd=function(k,I,$,Y){return k[0]=I[0]+$[0]*Y,k[1]=I[1]+$[1]*Y,k[2]=I[2]+$[2]*Y,k[3]=I[3]+$[3]*Y,k},je.distance=M,je.squaredDistance=j,je.length=F,je.squaredLength=E,je.negate=function(k,I){return k[0]=-I[0],k[1]=-I[1],k[2]=-I[2],k[3]=-I[3],k},je.inverse=function(k,I){return k[0]=1/I[0],k[1]=1/I[1],k[2]=1/I[2],k[3]=1/I[3],k},je.normalize=function(k,I){var $=I[0],Y=I[1],ee=I[2],oe=I[3],se=$*$+Y*Y+ee*ee+oe*oe;return se>0&&(se=1/Math.sqrt(se)),k[0]=$*se,k[1]=Y*se,k[2]=ee*se,k[3]=oe*se,k},je.dot=function(k,I){return k[0]*I[0]+k[1]*I[1]+k[2]*I[2]+k[3]*I[3]},je.cross=function(k,I,$,Y){var ee=$[0]*Y[1]-$[1]*Y[0],oe=$[0]*Y[2]-$[2]*Y[0],se=$[0]*Y[3]-$[3]*Y[0],ie=$[1]*Y[2]-$[2]*Y[1],he=$[1]*Y[3]-$[3]*Y[1],me=$[2]*Y[3]-$[3]*Y[2],be=I[0],Re=I[1],Me=I[2],Ce=I[3];return k[0]=Re*me-Me*he+Ce*ie,k[1]=-be*me+Me*se-Ce*oe,k[2]=be*he-Re*se+Ce*ee,k[3]=-be*ie+Re*oe-Me*ee,k},je.lerp=function(k,I,$,Y){var ee=I[0],oe=I[1],se=I[2],ie=I[3];return k[0]=ee+Y*($[0]-ee),k[1]=oe+Y*($[1]-oe),k[2]=se+Y*($[2]-se),k[3]=ie+Y*($[3]-ie),k},je.random=function(k,I){var $,Y,ee,oe,se,ie;I=I||1;do se=($=2*o.RANDOM()-1)*$+(Y=2*o.RANDOM()-1)*Y;while(se>=1);do ie=(ee=2*o.RANDOM()-1)*ee+(oe=2*o.RANDOM()-1)*oe;while(ie>=1);var he=Math.sqrt((1-se)/ie);return k[0]=I*$,k[1]=I*Y,k[2]=I*ee*he,k[3]=I*oe*he,k},je.transformMat4=function(k,I,$){var Y=I[0],ee=I[1],oe=I[2],se=I[3];return k[0]=$[0]*Y+$[4]*ee+$[8]*oe+$[12]*se,k[1]=$[1]*Y+$[5]*ee+$[9]*oe+$[13]*se,k[2]=$[2]*Y+$[6]*ee+$[10]*oe+$[14]*se,k[3]=$[3]*Y+$[7]*ee+$[11]*oe+$[15]*se,k},je.transformQuat=function(k,I,$){var Y=I[0],ee=I[1],oe=I[2],se=$[0],ie=$[1],he=$[2],me=$[3],be=me*Y+ie*oe-he*ee,Re=me*ee+he*Y-se*oe,Me=me*oe+se*ee-ie*Y,Ce=-se*Y-ie*ee-he*oe;return k[0]=be*me+Ce*-se+Re*-he-Me*-ie,k[1]=Re*me+Ce*-ie+Me*-se-be*-he,k[2]=Me*me+Ce*-he+be*-ie-Re*-se,k[3]=I[3],k},je.zero=function(k){return k[0]=0,k[1]=0,k[2]=0,k[3]=0,k},je.str=function(k){return"vec4("+k[0]+", "+k[1]+", "+k[2]+", "+k[3]+")"},je.exactEquals=function(k,I){return k[0]===I[0]&&k[1]===I[1]&&k[2]===I[2]&&k[3]===I[3]},je.equals=function(k,I){var $=k[0],Y=k[1],ee=k[2],oe=k[3],se=I[0],ie=I[1],he=I[2],me=I[3];return Math.abs($-se)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(se))&&Math.abs(Y-ie)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(ie))&&Math.abs(ee-he)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(he))&&Math.abs(oe-me)<=o.EPSILON*Math.max(1,Math.abs(oe),Math.abs(me))},je.forEach=je.sqrLen=je.len=je.sqrDist=je.dist=je.div=je.mul=je.sub=void 0;var o=function(k,I){if(k&&k.__esModule)return k;if(k===null||d(k)!=="object"&&typeof k!="function")return{default:k};var $=c(void 0);if($&&$.has(k))return $.get(k);var Y={},ee=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in k)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(k,oe)){var se=ee?Object.getOwnPropertyDescriptor(k,oe):null;se&&(se.get||se.set)?Object.defineProperty(Y,oe,se):Y[oe]=k[oe]}return Y.default=k,$&&$.set(k,Y),Y}(R());function c(k){if(typeof WeakMap!="function")return null;var I=new WeakMap,$=new WeakMap;return(c=function(Y){return Y?$:I})(k)}function p(){var k=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(k[0]=0,k[1]=0,k[2]=0,k[3]=0),k}function v(k,I,$){return k[0]=I[0]-$[0],k[1]=I[1]-$[1],k[2]=I[2]-$[2],k[3]=I[3]-$[3],k}function m(k,I,$){return k[0]=I[0]*$[0],k[1]=I[1]*$[1],k[2]=I[2]*$[2],k[3]=I[3]*$[3],k}function x(k,I,$){return k[0]=I[0]/$[0],k[1]=I[1]/$[1],k[2]=I[2]/$[2],k[3]=I[3]/$[3],k}function M(k,I){return Math.hypot(I[0]-k[0],I[1]-k[1],I[2]-k[2],I[3]-k[3])}function j(k,I){var $=I[0]-k[0],Y=I[1]-k[1],ee=I[2]-k[2],oe=I[3]-k[3];return $*$+Y*Y+ee*ee+oe*oe}function F(k){return Math.hypot(k[0],k[1],k[2],k[3])}function E(k){var I=k[0],$=k[1],Y=k[2],ee=k[3];return I*I+$*$+Y*Y+ee*ee}je.sub=v,je.mul=m,je.div=x,je.dist=M,je.sqrDist=j,je.len=F,je.sqrLen=E;var N,L=(N=p(),function(k,I,$,Y,ee,oe){var se,ie;for(I||(I=4),$||($=0),ie=Y?Math.min(Y*I+$,k.length):k.length,se=$;se<ie;se+=I)N[0]=k[se],N[1]=k[se+1],N[2]=k[se+2],N[3]=k[se+3],ee(N,N,oe),k[se]=N[0],k[se+1]=N[1],k[se+2]=N[2],k[se+3]=N[3];return k});return je.forEach=L,je}function Ye(){if(et)return Oe;function d(Ie){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Qe){return typeof Qe}:function(Qe){return Qe&&typeof Symbol=="function"&&Qe.constructor===Symbol&&Qe!==Symbol.prototype?"symbol":typeof Qe},d(Ie)}et=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=M,Oe.identity=function(Ie){return Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=1,Ie},Oe.setAxisAngle=j,Oe.getAxisAngle=function(Ie,Qe){var ot=2*Math.acos(Qe[3]),nt=Math.sin(ot/2);return nt>o.EPSILON?(Ie[0]=Qe[0]/nt,Ie[1]=Qe[1]/nt,Ie[2]=Qe[2]/nt):(Ie[0]=1,Ie[1]=0,Ie[2]=0),ot},Oe.getAngle=function(Ie,Qe){var ot=$(Ie,Qe);return Math.acos(2*ot*ot-1)},Oe.multiply=F,Oe.rotateX=function(Ie,Qe,ot){ot*=.5;var nt=Qe[0],lt=Qe[1],dt=Qe[2],yt=Qe[3],ct=Math.sin(ot),jt=Math.cos(ot);return Ie[0]=nt*jt+yt*ct,Ie[1]=lt*jt+dt*ct,Ie[2]=dt*jt-lt*ct,Ie[3]=yt*jt-nt*ct,Ie},Oe.rotateY=function(Ie,Qe,ot){ot*=.5;var nt=Qe[0],lt=Qe[1],dt=Qe[2],yt=Qe[3],ct=Math.sin(ot),jt=Math.cos(ot);return Ie[0]=nt*jt-dt*ct,Ie[1]=lt*jt+yt*ct,Ie[2]=dt*jt+nt*ct,Ie[3]=yt*jt-lt*ct,Ie},Oe.rotateZ=function(Ie,Qe,ot){ot*=.5;var nt=Qe[0],lt=Qe[1],dt=Qe[2],yt=Qe[3],ct=Math.sin(ot),jt=Math.cos(ot);return Ie[0]=nt*jt+lt*ct,Ie[1]=lt*jt-nt*ct,Ie[2]=dt*jt+yt*ct,Ie[3]=yt*jt-dt*ct,Ie},Oe.calculateW=function(Ie,Qe){var ot=Qe[0],nt=Qe[1],lt=Qe[2];return Ie[0]=ot,Ie[1]=nt,Ie[2]=lt,Ie[3]=Math.sqrt(Math.abs(1-ot*ot-nt*nt-lt*lt)),Ie},Oe.exp=E,Oe.ln=N,Oe.pow=function(Ie,Qe,ot){return N(Ie,Qe),I(Ie,Ie,ot),E(Ie,Ie),Ie},Oe.slerp=L,Oe.random=function(Ie){var Qe=o.RANDOM(),ot=o.RANDOM(),nt=o.RANDOM(),lt=Math.sqrt(1-Qe),dt=Math.sqrt(Qe);return Ie[0]=lt*Math.sin(2*Math.PI*ot),Ie[1]=lt*Math.cos(2*Math.PI*ot),Ie[2]=dt*Math.sin(2*Math.PI*nt),Ie[3]=dt*Math.cos(2*Math.PI*nt),Ie},Oe.invert=function(Ie,Qe){var ot=Qe[0],nt=Qe[1],lt=Qe[2],dt=Qe[3],yt=ot*ot+nt*nt+lt*lt+dt*dt,ct=yt?1/yt:0;return Ie[0]=-ot*ct,Ie[1]=-nt*ct,Ie[2]=-lt*ct,Ie[3]=dt*ct,Ie},Oe.conjugate=function(Ie,Qe){return Ie[0]=-Qe[0],Ie[1]=-Qe[1],Ie[2]=-Qe[2],Ie[3]=Qe[3],Ie},Oe.fromMat3=k,Oe.fromEuler=function(Ie,Qe,ot,nt){var lt=.5*Math.PI/180;Qe*=lt,ot*=lt,nt*=lt;var dt=Math.sin(Qe),yt=Math.cos(Qe),ct=Math.sin(ot),jt=Math.cos(ot),Vt=Math.sin(nt),kt=Math.cos(nt);return Ie[0]=dt*jt*kt-yt*ct*Vt,Ie[1]=yt*ct*kt+dt*jt*Vt,Ie[2]=yt*jt*Vt-dt*ct*kt,Ie[3]=yt*jt*kt+dt*ct*Vt,Ie},Oe.str=function(Ie){return"quat("+Ie[0]+", "+Ie[1]+", "+Ie[2]+", "+Ie[3]+")"},Oe.setAxes=Oe.sqlerp=Oe.rotationTo=Oe.equals=Oe.exactEquals=Oe.normalize=Oe.sqrLen=Oe.squaredLength=Oe.len=Oe.length=Oe.lerp=Oe.dot=Oe.scale=Oe.mul=Oe.add=Oe.set=Oe.copy=Oe.fromValues=Oe.clone=void 0;var o=x(R()),c=x(ne()),p=x(ke()),v=x(Ne());function m(Ie){if(typeof WeakMap!="function")return null;var Qe=new WeakMap,ot=new WeakMap;return(m=function(nt){return nt?ot:Qe})(Ie)}function x(Ie,Qe){if(Ie&&Ie.__esModule)return Ie;if(Ie===null||d(Ie)!=="object"&&typeof Ie!="function")return{default:Ie};var ot=m(Qe);if(ot&&ot.has(Ie))return ot.get(Ie);var nt={},lt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var dt in Ie)if(dt!=="default"&&Object.prototype.hasOwnProperty.call(Ie,dt)){var yt=lt?Object.getOwnPropertyDescriptor(Ie,dt):null;yt&&(yt.get||yt.set)?Object.defineProperty(nt,dt,yt):nt[dt]=Ie[dt]}return nt.default=Ie,ot&&ot.set(Ie,nt),nt}function M(){var Ie=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(Ie[0]=0,Ie[1]=0,Ie[2]=0),Ie[3]=1,Ie}function j(Ie,Qe,ot){ot*=.5;var nt=Math.sin(ot);return Ie[0]=nt*Qe[0],Ie[1]=nt*Qe[1],Ie[2]=nt*Qe[2],Ie[3]=Math.cos(ot),Ie}function F(Ie,Qe,ot){var nt=Qe[0],lt=Qe[1],dt=Qe[2],yt=Qe[3],ct=ot[0],jt=ot[1],Vt=ot[2],kt=ot[3];return Ie[0]=nt*kt+yt*ct+lt*Vt-dt*jt,Ie[1]=lt*kt+yt*jt+dt*ct-nt*Vt,Ie[2]=dt*kt+yt*Vt+nt*jt-lt*ct,Ie[3]=yt*kt-nt*ct-lt*jt-dt*Vt,Ie}function E(Ie,Qe){var ot=Qe[0],nt=Qe[1],lt=Qe[2],dt=Qe[3],yt=Math.sqrt(ot*ot+nt*nt+lt*lt),ct=Math.exp(dt),jt=yt>0?ct*Math.sin(yt)/yt:0;return Ie[0]=ot*jt,Ie[1]=nt*jt,Ie[2]=lt*jt,Ie[3]=ct*Math.cos(yt),Ie}function N(Ie,Qe){var ot=Qe[0],nt=Qe[1],lt=Qe[2],dt=Qe[3],yt=Math.sqrt(ot*ot+nt*nt+lt*lt),ct=yt>0?Math.atan2(yt,dt)/yt:0;return Ie[0]=ot*ct,Ie[1]=nt*ct,Ie[2]=lt*ct,Ie[3]=.5*Math.log(ot*ot+nt*nt+lt*lt+dt*dt),Ie}function L(Ie,Qe,ot,nt){var lt,dt,yt,ct,jt,Vt=Qe[0],kt=Qe[1],cr=Qe[2],ir=Qe[3],Xt=ot[0],Ut=ot[1],Er=ot[2],pr=ot[3];return(dt=Vt*Xt+kt*Ut+cr*Er+ir*pr)<0&&(dt=-dt,Xt=-Xt,Ut=-Ut,Er=-Er,pr=-pr),1-dt>o.EPSILON?(lt=Math.acos(dt),yt=Math.sin(lt),ct=Math.sin((1-nt)*lt)/yt,jt=Math.sin(nt*lt)/yt):(ct=1-nt,jt=nt),Ie[0]=ct*Vt+jt*Xt,Ie[1]=ct*kt+jt*Ut,Ie[2]=ct*cr+jt*Er,Ie[3]=ct*ir+jt*pr,Ie}function k(Ie,Qe){var ot,nt=Qe[0]+Qe[4]+Qe[8];if(nt>0)ot=Math.sqrt(nt+1),Ie[3]=.5*ot,Ie[0]=(Qe[5]-Qe[7])*(ot=.5/ot),Ie[1]=(Qe[6]-Qe[2])*ot,Ie[2]=(Qe[1]-Qe[3])*ot;else{var lt=0;Qe[4]>Qe[0]&&(lt=1),Qe[8]>Qe[3*lt+lt]&&(lt=2);var dt=(lt+1)%3,yt=(lt+2)%3;ot=Math.sqrt(Qe[3*lt+lt]-Qe[3*dt+dt]-Qe[3*yt+yt]+1),Ie[lt]=.5*ot,Ie[3]=(Qe[3*dt+yt]-Qe[3*yt+dt])*(ot=.5/ot),Ie[dt]=(Qe[3*dt+lt]+Qe[3*lt+dt])*ot,Ie[yt]=(Qe[3*yt+lt]+Qe[3*lt+yt])*ot}return Ie}Oe.clone=v.clone,Oe.fromValues=v.fromValues,Oe.copy=v.copy,Oe.set=v.set,Oe.add=v.add,Oe.mul=F;var I=v.scale;Oe.scale=I;var $=v.dot;Oe.dot=$,Oe.lerp=v.lerp;var Y=v.length;Oe.length=Y,Oe.len=Y;var ee=v.squaredLength;Oe.squaredLength=ee,Oe.sqrLen=ee;var oe=v.normalize;Oe.normalize=oe,Oe.exactEquals=v.exactEquals,Oe.equals=v.equals;var se,ie,he,me=(se=p.create(),ie=p.fromValues(1,0,0),he=p.fromValues(0,1,0),function(Ie,Qe,ot){var nt=p.dot(Qe,ot);return nt<-.999999?(p.cross(se,ie,Qe),p.len(se)<1e-6&&p.cross(se,he,Qe),p.normalize(se,se),j(Ie,se,Math.PI),Ie):nt>.999999?(Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=1,Ie):(p.cross(se,Qe,ot),Ie[0]=se[0],Ie[1]=se[1],Ie[2]=se[2],Ie[3]=1+nt,oe(Ie,Ie))});Oe.rotationTo=me;var be,Re,Me=(be=M(),Re=M(),function(Ie,Qe,ot,nt,lt,dt){return L(be,Qe,lt,dt),L(Re,ot,nt,dt),L(Ie,be,Re,2*dt*(1-dt)),Ie});Oe.sqlerp=Me;var Ce,Xe=(Ce=c.create(),function(Ie,Qe,ot,nt){return Ce[0]=ot[0],Ce[3]=ot[1],Ce[6]=ot[2],Ce[1]=nt[0],Ce[4]=nt[1],Ce[7]=nt[2],Ce[2]=-Qe[0],Ce[5]=-Qe[1],Ce[8]=-Qe[2],oe(Ie,k(Ie,Ce))});return Oe.setAxes=Xe,Oe}var $e,We={};function Et(){if($e)return We;function d(L){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},d(L)}$e=1,Object.defineProperty(We,"__esModule",{value:!0}),We.create=function(){var L=new o.ARRAY_TYPE(8);return o.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0,L[4]=0,L[5]=0,L[6]=0,L[7]=0),L[3]=1,L},We.clone=function(L){var k=new o.ARRAY_TYPE(8);return k[0]=L[0],k[1]=L[1],k[2]=L[2],k[3]=L[3],k[4]=L[4],k[5]=L[5],k[6]=L[6],k[7]=L[7],k},We.fromValues=function(L,k,I,$,Y,ee,oe,se){var ie=new o.ARRAY_TYPE(8);return ie[0]=L,ie[1]=k,ie[2]=I,ie[3]=$,ie[4]=Y,ie[5]=ee,ie[6]=oe,ie[7]=se,ie},We.fromRotationTranslationValues=function(L,k,I,$,Y,ee,oe){var se=new o.ARRAY_TYPE(8);se[0]=L,se[1]=k,se[2]=I,se[3]=$;var ie=.5*Y,he=.5*ee,me=.5*oe;return se[4]=ie*$+he*I-me*k,se[5]=he*$+me*L-ie*I,se[6]=me*$+ie*k-he*L,se[7]=-ie*L-he*k-me*I,se},We.fromRotationTranslation=x,We.fromTranslation=function(L,k){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=.5*k[0],L[5]=.5*k[1],L[6]=.5*k[2],L[7]=0,L},We.fromRotation=function(L,k){return L[0]=k[0],L[1]=k[1],L[2]=k[2],L[3]=k[3],L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},We.fromMat4=function(L,k){var I=c.create();p.getRotation(I,k);var $=new o.ARRAY_TYPE(3);return p.getTranslation($,k),x(L,I,$),L},We.copy=M,We.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},We.set=function(L,k,I,$,Y,ee,oe,se,ie){return L[0]=k,L[1]=I,L[2]=$,L[3]=Y,L[4]=ee,L[5]=oe,L[6]=se,L[7]=ie,L},We.getDual=function(L,k){return L[0]=k[4],L[1]=k[5],L[2]=k[6],L[3]=k[7],L},We.setDual=function(L,k){return L[4]=k[0],L[5]=k[1],L[6]=k[2],L[7]=k[3],L},We.getTranslation=function(L,k){var I=k[4],$=k[5],Y=k[6],ee=k[7],oe=-k[0],se=-k[1],ie=-k[2],he=k[3];return L[0]=2*(I*he+ee*oe+$*ie-Y*se),L[1]=2*($*he+ee*se+Y*oe-I*ie),L[2]=2*(Y*he+ee*ie+I*se-$*oe),L},We.translate=function(L,k,I){var $=k[0],Y=k[1],ee=k[2],oe=k[3],se=.5*I[0],ie=.5*I[1],he=.5*I[2],me=k[4],be=k[5],Re=k[6],Me=k[7];return L[0]=$,L[1]=Y,L[2]=ee,L[3]=oe,L[4]=oe*se+Y*he-ee*ie+me,L[5]=oe*ie+ee*se-$*he+be,L[6]=oe*he+$*ie-Y*se+Re,L[7]=-$*se-Y*ie-ee*he+Me,L},We.rotateX=function(L,k,I){var $=-k[0],Y=-k[1],ee=-k[2],oe=k[3],se=k[4],ie=k[5],he=k[6],me=k[7],be=se*oe+me*$+ie*ee-he*Y,Re=ie*oe+me*Y+he*$-se*ee,Me=he*oe+me*ee+se*Y-ie*$,Ce=me*oe-se*$-ie*Y-he*ee;return c.rotateX(L,k,I),L[4]=be*(oe=L[3])+Ce*($=L[0])+Re*(ee=L[2])-Me*(Y=L[1]),L[5]=Re*oe+Ce*Y+Me*$-be*ee,L[6]=Me*oe+Ce*ee+be*Y-Re*$,L[7]=Ce*oe-be*$-Re*Y-Me*ee,L},We.rotateY=function(L,k,I){var $=-k[0],Y=-k[1],ee=-k[2],oe=k[3],se=k[4],ie=k[5],he=k[6],me=k[7],be=se*oe+me*$+ie*ee-he*Y,Re=ie*oe+me*Y+he*$-se*ee,Me=he*oe+me*ee+se*Y-ie*$,Ce=me*oe-se*$-ie*Y-he*ee;return c.rotateY(L,k,I),L[4]=be*(oe=L[3])+Ce*($=L[0])+Re*(ee=L[2])-Me*(Y=L[1]),L[5]=Re*oe+Ce*Y+Me*$-be*ee,L[6]=Me*oe+Ce*ee+be*Y-Re*$,L[7]=Ce*oe-be*$-Re*Y-Me*ee,L},We.rotateZ=function(L,k,I){var $=-k[0],Y=-k[1],ee=-k[2],oe=k[3],se=k[4],ie=k[5],he=k[6],me=k[7],be=se*oe+me*$+ie*ee-he*Y,Re=ie*oe+me*Y+he*$-se*ee,Me=he*oe+me*ee+se*Y-ie*$,Ce=me*oe-se*$-ie*Y-he*ee;return c.rotateZ(L,k,I),L[4]=be*(oe=L[3])+Ce*($=L[0])+Re*(ee=L[2])-Me*(Y=L[1]),L[5]=Re*oe+Ce*Y+Me*$-be*ee,L[6]=Me*oe+Ce*ee+be*Y-Re*$,L[7]=Ce*oe-be*$-Re*Y-Me*ee,L},We.rotateByQuatAppend=function(L,k,I){var $=I[0],Y=I[1],ee=I[2],oe=I[3],se=k[0],ie=k[1],he=k[2],me=k[3];return L[0]=se*oe+me*$+ie*ee-he*Y,L[1]=ie*oe+me*Y+he*$-se*ee,L[2]=he*oe+me*ee+se*Y-ie*$,L[3]=me*oe-se*$-ie*Y-he*ee,L[4]=(se=k[4])*oe+(me=k[7])*$+(ie=k[5])*ee-(he=k[6])*Y,L[5]=ie*oe+me*Y+he*$-se*ee,L[6]=he*oe+me*ee+se*Y-ie*$,L[7]=me*oe-se*$-ie*Y-he*ee,L},We.rotateByQuatPrepend=function(L,k,I){var $=k[0],Y=k[1],ee=k[2],oe=k[3],se=I[0],ie=I[1],he=I[2],me=I[3];return L[0]=$*me+oe*se+Y*he-ee*ie,L[1]=Y*me+oe*ie+ee*se-$*he,L[2]=ee*me+oe*he+$*ie-Y*se,L[3]=oe*me-$*se-Y*ie-ee*he,L[4]=$*(me=I[7])+oe*(se=I[4])+Y*(he=I[6])-ee*(ie=I[5]),L[5]=Y*me+oe*ie+ee*se-$*he,L[6]=ee*me+oe*he+$*ie-Y*se,L[7]=oe*me-$*se-Y*ie-ee*he,L},We.rotateAroundAxis=function(L,k,I,$){if(Math.abs($)<o.EPSILON)return M(L,k);var Y=Math.hypot(I[0],I[1],I[2]);$*=.5;var ee=Math.sin($),oe=ee*I[0]/Y,se=ee*I[1]/Y,ie=ee*I[2]/Y,he=Math.cos($),me=k[0],be=k[1],Re=k[2],Me=k[3];L[0]=me*he+Me*oe+be*ie-Re*se,L[1]=be*he+Me*se+Re*oe-me*ie,L[2]=Re*he+Me*ie+me*se-be*oe,L[3]=Me*he-me*oe-be*se-Re*ie;var Ce=k[4],Xe=k[5],Ie=k[6],Qe=k[7];return L[4]=Ce*he+Qe*oe+Xe*ie-Ie*se,L[5]=Xe*he+Qe*se+Ie*oe-Ce*ie,L[6]=Ie*he+Qe*ie+Ce*se-Xe*oe,L[7]=Qe*he-Ce*oe-Xe*se-Ie*ie,L},We.add=function(L,k,I){return L[0]=k[0]+I[0],L[1]=k[1]+I[1],L[2]=k[2]+I[2],L[3]=k[3]+I[3],L[4]=k[4]+I[4],L[5]=k[5]+I[5],L[6]=k[6]+I[6],L[7]=k[7]+I[7],L},We.multiply=j,We.scale=function(L,k,I){return L[0]=k[0]*I,L[1]=k[1]*I,L[2]=k[2]*I,L[3]=k[3]*I,L[4]=k[4]*I,L[5]=k[5]*I,L[6]=k[6]*I,L[7]=k[7]*I,L},We.lerp=function(L,k,I,$){var Y=1-$;return F(k,I)<0&&($=-$),L[0]=k[0]*Y+I[0]*$,L[1]=k[1]*Y+I[1]*$,L[2]=k[2]*Y+I[2]*$,L[3]=k[3]*Y+I[3]*$,L[4]=k[4]*Y+I[4]*$,L[5]=k[5]*Y+I[5]*$,L[6]=k[6]*Y+I[6]*$,L[7]=k[7]*Y+I[7]*$,L},We.invert=function(L,k){var I=N(k);return L[0]=-k[0]/I,L[1]=-k[1]/I,L[2]=-k[2]/I,L[3]=k[3]/I,L[4]=-k[4]/I,L[5]=-k[5]/I,L[6]=-k[6]/I,L[7]=k[7]/I,L},We.conjugate=function(L,k){return L[0]=-k[0],L[1]=-k[1],L[2]=-k[2],L[3]=k[3],L[4]=-k[4],L[5]=-k[5],L[6]=-k[6],L[7]=k[7],L},We.normalize=function(L,k){var I=N(k);if(I>0){I=Math.sqrt(I);var $=k[0]/I,Y=k[1]/I,ee=k[2]/I,oe=k[3]/I,se=k[4],ie=k[5],he=k[6],me=k[7],be=$*se+Y*ie+ee*he+oe*me;L[0]=$,L[1]=Y,L[2]=ee,L[3]=oe,L[4]=(se-$*be)/I,L[5]=(ie-Y*be)/I,L[6]=(he-ee*be)/I,L[7]=(me-oe*be)/I}return L},We.str=function(L){return"quat2("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+")"},We.exactEquals=function(L,k){return L[0]===k[0]&&L[1]===k[1]&&L[2]===k[2]&&L[3]===k[3]&&L[4]===k[4]&&L[5]===k[5]&&L[6]===k[6]&&L[7]===k[7]},We.equals=function(L,k){var I=L[0],$=L[1],Y=L[2],ee=L[3],oe=L[4],se=L[5],ie=L[6],he=L[7],me=k[0],be=k[1],Re=k[2],Me=k[3],Ce=k[4],Xe=k[5],Ie=k[6],Qe=k[7];return Math.abs(I-me)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(me))&&Math.abs($-be)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(be))&&Math.abs(Y-Re)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Re))&&Math.abs(ee-Me)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(Me))&&Math.abs(oe-Ce)<=o.EPSILON*Math.max(1,Math.abs(oe),Math.abs(Ce))&&Math.abs(se-Xe)<=o.EPSILON*Math.max(1,Math.abs(se),Math.abs(Xe))&&Math.abs(ie-Ie)<=o.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Ie))&&Math.abs(he-Qe)<=o.EPSILON*Math.max(1,Math.abs(he),Math.abs(Qe))},We.sqrLen=We.squaredLength=We.len=We.length=We.dot=We.mul=We.setReal=We.getReal=void 0;var o=m(R()),c=m(Ye()),p=m(ve());function v(L){if(typeof WeakMap!="function")return null;var k=new WeakMap,I=new WeakMap;return(v=function($){return $?I:k})(L)}function m(L,k){if(L&&L.__esModule)return L;if(L===null||d(L)!=="object"&&typeof L!="function")return{default:L};var I=v(k);if(I&&I.has(L))return I.get(L);var $={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ee in L)if(ee!=="default"&&Object.prototype.hasOwnProperty.call(L,ee)){var oe=Y?Object.getOwnPropertyDescriptor(L,ee):null;oe&&(oe.get||oe.set)?Object.defineProperty($,ee,oe):$[ee]=L[ee]}return $.default=L,I&&I.set(L,$),$}function x(L,k,I){var $=.5*I[0],Y=.5*I[1],ee=.5*I[2],oe=k[0],se=k[1],ie=k[2],he=k[3];return L[0]=oe,L[1]=se,L[2]=ie,L[3]=he,L[4]=$*he+Y*ie-ee*se,L[5]=Y*he+ee*oe-$*ie,L[6]=ee*he+$*se-Y*oe,L[7]=-$*oe-Y*se-ee*ie,L}function M(L,k){return L[0]=k[0],L[1]=k[1],L[2]=k[2],L[3]=k[3],L[4]=k[4],L[5]=k[5],L[6]=k[6],L[7]=k[7],L}function j(L,k,I){var $=k[0],Y=k[1],ee=k[2],oe=k[3],se=I[4],ie=I[5],he=I[6],me=I[7],be=k[4],Re=k[5],Me=k[6],Ce=k[7],Xe=I[0],Ie=I[1],Qe=I[2],ot=I[3];return L[0]=$*ot+oe*Xe+Y*Qe-ee*Ie,L[1]=Y*ot+oe*Ie+ee*Xe-$*Qe,L[2]=ee*ot+oe*Qe+$*Ie-Y*Xe,L[3]=oe*ot-$*Xe-Y*Ie-ee*Qe,L[4]=$*me+oe*se+Y*he-ee*ie+be*ot+Ce*Xe+Re*Qe-Me*Ie,L[5]=Y*me+oe*ie+ee*se-$*he+Re*ot+Ce*Ie+Me*Xe-be*Qe,L[6]=ee*me+oe*he+$*ie-Y*se+Me*ot+Ce*Qe+be*Ie-Re*Xe,L[7]=oe*me-$*se-Y*ie-ee*he+Ce*ot-be*Xe-Re*Ie-Me*Qe,L}We.getReal=c.copy,We.setReal=c.copy,We.mul=j;var F=c.dot;We.dot=F;var E=c.length;We.length=E,We.len=E;var N=c.squaredLength;return We.squaredLength=N,We.sqrLen=N,We}var Je,ht,tt={};function Qt(){if(Je)return tt;function d(k){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},d(k)}Je=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.create=p,tt.clone=function(k){var I=new o.ARRAY_TYPE(2);return I[0]=k[0],I[1]=k[1],I},tt.fromValues=function(k,I){var $=new o.ARRAY_TYPE(2);return $[0]=k,$[1]=I,$},tt.copy=function(k,I){return k[0]=I[0],k[1]=I[1],k},tt.set=function(k,I,$){return k[0]=I,k[1]=$,k},tt.add=function(k,I,$){return k[0]=I[0]+$[0],k[1]=I[1]+$[1],k},tt.subtract=v,tt.multiply=m,tt.divide=x,tt.ceil=function(k,I){return k[0]=Math.ceil(I[0]),k[1]=Math.ceil(I[1]),k},tt.floor=function(k,I){return k[0]=Math.floor(I[0]),k[1]=Math.floor(I[1]),k},tt.min=function(k,I,$){return k[0]=Math.min(I[0],$[0]),k[1]=Math.min(I[1],$[1]),k},tt.max=function(k,I,$){return k[0]=Math.max(I[0],$[0]),k[1]=Math.max(I[1],$[1]),k},tt.round=function(k,I){return k[0]=Math.round(I[0]),k[1]=Math.round(I[1]),k},tt.scale=function(k,I,$){return k[0]=I[0]*$,k[1]=I[1]*$,k},tt.scaleAndAdd=function(k,I,$,Y){return k[0]=I[0]+$[0]*Y,k[1]=I[1]+$[1]*Y,k},tt.distance=M,tt.squaredDistance=j,tt.length=F,tt.squaredLength=E,tt.negate=function(k,I){return k[0]=-I[0],k[1]=-I[1],k},tt.inverse=function(k,I){return k[0]=1/I[0],k[1]=1/I[1],k},tt.normalize=function(k,I){var $=I[0],Y=I[1],ee=$*$+Y*Y;return ee>0&&(ee=1/Math.sqrt(ee)),k[0]=I[0]*ee,k[1]=I[1]*ee,k},tt.dot=function(k,I){return k[0]*I[0]+k[1]*I[1]},tt.cross=function(k,I,$){var Y=I[0]*$[1]-I[1]*$[0];return k[0]=k[1]=0,k[2]=Y,k},tt.lerp=function(k,I,$,Y){var ee=I[0],oe=I[1];return k[0]=ee+Y*($[0]-ee),k[1]=oe+Y*($[1]-oe),k},tt.random=function(k,I){I=I||1;var $=2*o.RANDOM()*Math.PI;return k[0]=Math.cos($)*I,k[1]=Math.sin($)*I,k},tt.transformMat2=function(k,I,$){var Y=I[0],ee=I[1];return k[0]=$[0]*Y+$[2]*ee,k[1]=$[1]*Y+$[3]*ee,k},tt.transformMat2d=function(k,I,$){var Y=I[0],ee=I[1];return k[0]=$[0]*Y+$[2]*ee+$[4],k[1]=$[1]*Y+$[3]*ee+$[5],k},tt.transformMat3=function(k,I,$){var Y=I[0],ee=I[1];return k[0]=$[0]*Y+$[3]*ee+$[6],k[1]=$[1]*Y+$[4]*ee+$[7],k},tt.transformMat4=function(k,I,$){var Y=I[0],ee=I[1];return k[0]=$[0]*Y+$[4]*ee+$[12],k[1]=$[1]*Y+$[5]*ee+$[13],k},tt.rotate=function(k,I,$,Y){var ee=I[0]-$[0],oe=I[1]-$[1],se=Math.sin(Y),ie=Math.cos(Y);return k[0]=ee*ie-oe*se+$[0],k[1]=ee*se+oe*ie+$[1],k},tt.angle=function(k,I){var $=k[0],Y=k[1],ee=I[0],oe=I[1],se=Math.sqrt($*$+Y*Y)*Math.sqrt(ee*ee+oe*oe);return Math.acos(Math.min(Math.max(se&&($*ee+Y*oe)/se,-1),1))},tt.zero=function(k){return k[0]=0,k[1]=0,k},tt.str=function(k){return"vec2("+k[0]+", "+k[1]+")"},tt.exactEquals=function(k,I){return k[0]===I[0]&&k[1]===I[1]},tt.equals=function(k,I){var $=k[0],Y=k[1],ee=I[0],oe=I[1];return Math.abs($-ee)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(ee))&&Math.abs(Y-oe)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(oe))},tt.forEach=tt.sqrLen=tt.sqrDist=tt.dist=tt.div=tt.mul=tt.sub=tt.len=void 0;var o=function(k,I){if(k&&k.__esModule)return k;if(k===null||d(k)!=="object"&&typeof k!="function")return{default:k};var $=c(void 0);if($&&$.has(k))return $.get(k);var Y={},ee=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in k)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(k,oe)){var se=ee?Object.getOwnPropertyDescriptor(k,oe):null;se&&(se.get||se.set)?Object.defineProperty(Y,oe,se):Y[oe]=k[oe]}return Y.default=k,$&&$.set(k,Y),Y}(R());function c(k){if(typeof WeakMap!="function")return null;var I=new WeakMap,$=new WeakMap;return(c=function(Y){return Y?$:I})(k)}function p(){var k=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(k[0]=0,k[1]=0),k}function v(k,I,$){return k[0]=I[0]-$[0],k[1]=I[1]-$[1],k}function m(k,I,$){return k[0]=I[0]*$[0],k[1]=I[1]*$[1],k}function x(k,I,$){return k[0]=I[0]/$[0],k[1]=I[1]/$[1],k}function M(k,I){return Math.hypot(I[0]-k[0],I[1]-k[1])}function j(k,I){var $=I[0]-k[0],Y=I[1]-k[1];return $*$+Y*Y}function F(k){return Math.hypot(k[0],k[1])}function E(k){var I=k[0],$=k[1];return I*I+$*$}tt.len=F,tt.sub=v,tt.mul=m,tt.div=x,tt.dist=M,tt.sqrDist=j,tt.sqrLen=E;var N,L=(N=p(),function(k,I,$,Y,ee,oe){var se,ie;for(I||(I=2),$||($=0),ie=Y?Math.min(Y*I+$,k.length):k.length,se=$;se<ie;se+=I)N[0]=k[se],N[1]=k[se+1],ee(N,N,oe),k[se]=N[0],k[se+1]=N[1];return k});return tt.forEach=L,tt}function gr(){if(ht)return A;function d(k){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},d(k)}ht=1,Object.defineProperty(A,"__esModule",{value:!0}),A.vec4=A.vec3=A.vec2=A.quat2=A.quat=A.mat4=A.mat3=A.mat2d=A.mat2=A.glMatrix=void 0;var o=L(R());A.glMatrix=o;var c=L(U());A.mat2=c;var p=L(J());A.mat2d=p;var v=L(ne());A.mat3=v;var m=L(ve());A.mat4=m;var x=L(Ye());A.quat=x;var M=L(Et());A.quat2=M;var j=L(Qt());A.vec2=j;var F=L(ke());A.vec3=F;var E=L(Ne());function N(k){if(typeof WeakMap!="function")return null;var I=new WeakMap,$=new WeakMap;return(N=function(Y){return Y?$:I})(k)}function L(k,I){if(k&&k.__esModule)return k;if(k===null||d(k)!=="object"&&typeof k!="function")return{default:k};var $=N(I);if($&&$.has(k))return $.get(k);var Y={},ee=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in k)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(k,oe)){var se=ee?Object.getOwnPropertyDescriptor(k,oe):null;se&&(se.get||se.set)?Object.defineProperty(Y,oe,se):Y[oe]=k[oe]}return Y.default=k,$&&$.set(k,Y),Y}return A.vec4=E,A}var sr,ur,br,Wt,Be=gr(),Nr=function(){if(ur)return sr;function d(o,c,p,v){this.cx=3*o,this.bx=3*(p-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(v-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=c,this.p2x=p,this.p2y=v}return ur=1,sr=d,d.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,c){if(c===void 0&&(c=1e-6),o<0)return 0;if(o>1)return 1;for(var p=o,v=0;v<8;v++){var m=this.sampleCurveX(p)-o;if(Math.abs(m)<c)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=m/x}var M=0,j=1;for(p=o,v=0;v<20&&(m=this.sampleCurveX(p),!(Math.abs(m-o)<c));v++)o>m?M=p:j=p,p=.5*(j-M)+M;return p},solve:function(o,c){return this.sampleCurveY(this.solveCurveX(o,c))}},sr}(),Jt=_(Nr);function Sn(){if(Wt)return br;function d(o,c){this.x=o,this.y=c}return Wt=1,br=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,c){return this.clone()._rotateAround(o,c)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var c=o.x-this.x,p=o.y-this.y;return c*c+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,c){return Math.atan2(this.x*c-this.y*o,this.x*o+this.y*c)},_matMult:function(o){var c=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=c,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var c=Math.cos(o),p=Math.sin(o),v=p*this.x+c*this.y;return this.x=c*this.x-p*this.y,this.y=v,this},_rotateAround:function(o,c){var p=Math.cos(o),v=Math.sin(o),m=c.y+v*(this.x-c.x)+p*(this.y-c.y);return this.x=c.x+p*(this.x-c.x)-v*(this.y-c.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(o){return o instanceof d?o:Array.isArray(o)?new d(o[0],o[1]):o},br}var It=_(Sn());function Vn(d,o){if(Array.isArray(d)){if(!Array.isArray(o)||d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(!Vn(d[c],o[c]))return!1;return!0}if(typeof d=="object"&&d!==null&&o!==null){if(typeof o!="object"||Object.keys(d).length!==Object.keys(o).length)return!1;for(const c in d)if(!Vn(d[c],o[c]))return!1;return!0}return d===o}const Un=Math.PI/180,Xr=180/Math.PI;function rt(d){return d*Un}function Ot(d){return d*Xr}const Kt=[[0,0],[1,0],[1,1],[0,1]];function Pr(d){if(d<=0)return 0;if(d>=1)return 1;const o=d*d,c=o*d;return 4*(d<.5?c:3*(d-o)+c-.75)}function yr(d,o,c,p){const v=new Jt(d,o,c,p);return function(m){return v.solve(m)}}const wr=yr(.25,.1,.25,1);function dr(d,o,c){return Math.min(c,Math.max(o,d))}function An(d,o,c){return(c=dr((c-d)/(o-d),0,1))*c*(3-2*c)}function Ti(d,o,c){const p=c-o,v=((d-o)%p+p)%p+o;return v===o?c:v}function Bi(d,o,c){if(!d.length)return c(null,[]);let p=d.length;const v=new Array(d.length);let m=null;d.forEach((x,M)=>{o(x,(j,F)=>{j&&(m=j),v[M]=F,--p==0&&c(m,v)})})}function Vi(d,...o){for(const c of o)for(const p in c)d[p]=c[p];return d}let is=1;function $a(){return is++}function Vo(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function ys(d,o){d.forEach(c=>{o[c]&&(o[c]=o[c].bind(o))})}function Qa(d,o){return d.indexOf(o,d.length-o.length)!==-1}function $l(d,o,c){const p={};for(const v in d)p[v]=o.call(this,d[v],v,d);return p}function _l(d,o,c){const p={};for(const v in d)o.call(this,d[v],v,d)&&(p[v]=d[v]);return p}function jo(d){return Array.isArray(d)?d.map(jo):typeof d=="object"&&d?$l(d,jo):d}const ql={};function rn(d){ql[d]||(typeof console<"u"&&console.warn(d),ql[d]=!0)}function eo(d,o,c){return(c.y-d.y)*(o.x-d.x)>(o.y-d.y)*(c.x-d.x)}function ku(d){let o=0;for(let c,p,v=0,m=d.length,x=m-1;v<m;x=v++)c=d[v],p=d[x],o+=(p.x-c.x)*(c.y+p.y);return o}function qa([d,o,c]){const p=rt(o+90),v=rt(c);return{x:d*Math.cos(p)*Math.sin(v),y:d*Math.sin(p)*Math.sin(v),z:d*Math.cos(v),azimuthal:o,polar:c}}function Uo(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Kn(d){const o={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,p,v,m)=>{const x=v||m;return o[p]=!x||x.toLowerCase(),""}),o["max-age"]){const c=parseInt(o["max-age"],10);isNaN(c)?delete o["max-age"]:o["max-age"]=c}return o}let fa=null;function Ca(d,o){return[d[4*o],d[4*o+1],d[4*o+2],d[4*o+3]]}function wo(d,o,c,p){for(;o<c;){const v=o+c>>1;d[v]<p?o=v+1:c=v}return o}function xl(d,o,c,p){for(;o<c;){const v=o+c>>1;d[v]<=p?o=v+1:c=v}return o}function Ma(d){return d>0?1/(1.001-d):1+d}function No(d){return d>0?1-1/(1.001-d):-d}const Ui={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ui.API_URL)return null;try{const d=new URL(Ui.API_URL);return d.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":d.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function So(d){return Ui.API_URL_REGEX.test(d)}function uo(d){return Ui.API_SPRITE_REGEX.test(d)}let ju,Wi,Ds,wt,ge,we;function Te(){return ju==null&&(ju=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),ju}const Ge={now:()=>wt!==void 0?wt:performance.now(),setNow(d){wt=d},restoreNow(){wt=void 0},frame(d){const o=requestAnimationFrame(d);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(d,o=0){const{width:c,height:p}=d;ge||(ge=document.createElement("canvas"));const v=ge.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(c>ge.width||p>ge.height)&&(ge.width=c,ge.height=p),v.clearRect(-o,-o,c+2*o,p+2*o),v.drawImage(d,0,0,c,p),v.getImageData(-o,-o,c+2*o,p+2*o)},resolveURL:d=>(Wi||(Wi=document.createElement("a")),Wi.href=d,Wi.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ds==null&&(Ds=window.matchMedia("(prefers-reduced-motion: reduce)")),Ds.matches)},hasCanvasFingerprintNoise(){if(we!==void 0)return we;if(!Te())return we=!1,!1;const d=new OffscreenCanvas(85,1),o=d.getContext("2d",{willReadFrequently:!0});let c=0;for(let v=0;v<d.width;++v)o.fillStyle=`rgba(${c++},${c++},${c++}, 255)`,o.fillRect(v,0,1,1);const p=o.getImageData(0,0,d.width,d.height);c=0;for(let v=0;v<p.data.length;++v)if(v%4!=3&&c++!==p.data[v])return we=!0,!0;return we=!1,!1}};function He(d,o){const c=d.indexOf("?");if(c<0)return`${d}?${new URLSearchParams(o).toString()}`;const p=new URLSearchParams(d.slice(c));for(const v in o)p.set(v,o[v]);return`${d.slice(0,c)}?${p.toString()}`}function at(d,o={persistentParams:[]}){const c=d.indexOf("?");if(c<0)return d;const p=new URLSearchParams,v=new URLSearchParams(d.slice(c));for(const x of o.persistentParams){const M=v.get(x);M&&p.set(x,M)}const m=p.toString();return`${d.slice(0,c)}${m.length>0?`?${m}`:""}`}const mt="mapbox-tiles";let st=500,bt=50;const xt=["language","worldview","jobid"];let St,Lt;function tr(){try{return caches}catch{}}function nr(){const d=tr();d&&St==null&&(St=d.open(mt))}let Sr=1/0;const Vr={supported:!1,testSupport:function(d){!Tn&&Fr&&(Hn?$n(d):Br=d)}};let Br,Fr,Tn=!1,Hn=!1;const vn=typeof self<"u"?self:{};function $n(d){const o=d.createTexture();d.bindTexture(d.TEXTURE_2D,o);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,Fr),d.isContextLost())return;Vr.supported=!0}catch{}d.deleteTexture(o),Tn=!0}vn.document&&(Fr=vn.document.createElement("img"),Fr.onload=function(){Br&&$n(Br),Br=null,Hn=!0},Fr.onerror=function(){Tn=!0,Br=null},Fr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Pn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Pn);class Oa extends Error{constructor(o,c,p){c===401&&So(p)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=c,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ho=Uo()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ga=function(d,o){if(!(/^file:/.test(c=d.url)||/^file:/.test(ho())&&!/^\w+:/.test(c))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(p,v){const m=new AbortController,x=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:ho(),referrerPolicy:p.referrerPolicy,signal:m.signal});let M=!1,j=!1;const F=(E=x.url).indexOf("sku=")>0&&So(E);var E;p.type==="json"&&x.headers.set("Accept","application/json");const N=(k,I,$)=>{if(j)return;if(k&&k.message!=="SecurityError"&&rn(k.toString()),I&&$)return L(I);const Y=Date.now();fetch(x).then(ee=>{if(ee.ok){const oe=F?ee.clone():null;return L(ee,oe,Y)}return v(new Oa(ee.statusText,ee.status,p.url))}).catch(ee=>{ee.name!=="AbortError"&&v(new Error(`${ee.message} ${p.url}`))})},L=(k,I,$)=>{(p.type==="arrayBuffer"?k.arrayBuffer():p.type==="json"?k.json():k.text()).then(Y=>{j||(I&&$&&function(ee,oe,se){if(nr(),St==null)return;const ie=Kn(oe.headers.get("Cache-Control")||"");if(ie["no-store"])return;const he={status:oe.status,statusText:oe.statusText,headers:new Headers};oe.headers.forEach((Re,Me)=>he.headers.set(Me,Re)),ie["max-age"]&&he.headers.set("Expires",new Date(se+1e3*ie["max-age"]).toUTCString());const me=he.headers.get("Expires");if(!me||new Date(me).getTime()-se<42e4)return;let be=at(ee.url,{persistentParams:xt});if(oe.status===206){const Re=ee.headers.get("Range");if(!Re)return;he.status=200,be=He(be,{range:Re})}(function(Re,Me){if(Lt===void 0)try{new Response(new ReadableStream),Lt=!0}catch{Lt=!1}Lt?Me(Re.body):Re.blob().then(Me)})(oe,Re=>{const Me=new Response((Ce=oe.status)!==200&&Ce!==404&&[101,103,204,205,304].includes(Ce)?null:Re,he);var Ce;nr(),St!=null&&St.then(Xe=>Xe.put(be,Me)).catch(Xe=>rn(Xe.message))})}(x,I,$),M=!0,v(null,Y,k.headers.get("Cache-Control"),k.headers.get("Expires")))}).catch(Y=>{j||v(new Error(Y.message))})};return F?function(k,I){if(nr(),St==null)return I(null);St.then($=>{let Y=at(k.url,{persistentParams:xt});const ee=k.headers.get("Range");ee&&(Y=He(Y,{range:ee})),$.match(Y).then(oe=>{const se=function(ie){if(!ie)return!1;const he=new Date(ie.headers.get("Expires")||0),me=Kn(ie.headers.get("Cache-Control")||"");return he>Date.now()&&!me["no-cache"]}(oe);$.delete(Y),se&&$.put(Y,oe.clone()),I(null,oe,se)}).catch(I)}).catch(I)}(x,N):N(null,null),{cancel:()=>{j=!0,M||m.abort()}}}(d,o);if(Uo()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",d,o,void 0,!0)}var c;return function(p,v){const m=new XMLHttpRequest;m.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const x in p.headers)m.setRequestHeader(x,p.headers[x]);return p.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=p.credentials==="include",m.onerror=()=>{v(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let x=m.response;if(p.type==="json")try{x=JSON.parse(m.response)}catch(M){return v(M)}v(null,x,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else v(new Oa(m.statusText,m.status,p.url))},m.send(p.body),{cancel:()=>m.abort()}}(d,o)},to=function(d,o){return Ga(Vi(d,{type:"arrayBuffer"}),o)};function as(d){const o=document.createElement("a");return o.href=d,o.protocol===location.protocol&&o.host===location.host}const Nu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let bl,$c;bl=[],$c=0;const Hh=function(d,o){if(Vr.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),$c>=Ui.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:d,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return bl.push(m),m}$c++;let c=!1;const p=()=>{if(!c)for(c=!0,$c--;bl.length&&$c<Ui.MAX_PARALLEL_IMAGE_REQUESTS;){const m=bl.shift(),{requestParameters:x,callback:M,cancelled:j}=m;j||(m.cancel=Hh(x,M).cancel)}},v=to(d,(m,x,M,j)=>{p(),m?o(m):x&&(self.createImageBitmap?function(F,E){const N=new Blob([new Uint8Array(F)],{type:"image/png"});createImageBitmap(N).then(L=>{E(null,L)}).catch(L=>{E(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(F,E)=>o(F,E,M,j)):function(F,E){const N=new Image;N.onload=()=>{E(null,N),URL.revokeObjectURL(N.src),N.onload=null,requestAnimationFrame(()=>{N.src=Nu})},N.onerror=()=>E(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(F)],{type:"image/png"});N.src=F.byteLength?URL.createObjectURL(L):Nu}(x,(F,E)=>o(F,E,M,j)))});return{cancel:()=>{v.cancel(),p()}}};var Qv,ay,np,$o={exports:{}},il={exports:{}},al={exports:{}},dc=function(){if(np)return $o.exports;np=1;var d=(Qv||(Qv=1,il.exports=function(c,p){var v,m,x,M,j,F,E,N;for(m=c.length-(v=3&c.length),x=p,j=3432918353,F=461845907,N=0;N<m;)E=255&c.charCodeAt(N)|(255&c.charCodeAt(++N))<<8|(255&c.charCodeAt(++N))<<16|(255&c.charCodeAt(++N))<<24,++N,x=27492+(65535&(M=5*(65535&(x=(x^=E=(65535&(E=(E=(65535&E)*j+(((E>>>16)*j&65535)<<16)&4294967295)<<15|E>>>17))*F+(((E>>>16)*F&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(E=0,v){case 3:E^=(255&c.charCodeAt(N+2))<<16;case 2:E^=(255&c.charCodeAt(N+1))<<8;case 1:x^=E=(65535&(E=(E=(65535&(E^=255&c.charCodeAt(N)))*j+(((E>>>16)*j&65535)<<16)&4294967295)<<15|E>>>17))*F+(((E>>>16)*F&65535)<<16)&4294967295}return x^=c.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),il.exports),o=(ay||(ay=1,al.exports=function(c,p){for(var v,m=c.length,x=p^m,M=0;m>=4;)v=1540483477*(65535&(v=255&c.charCodeAt(M)|(255&c.charCodeAt(++M))<<8|(255&c.charCodeAt(++M))<<16|(255&c.charCodeAt(++M))<<24))+((1540483477*(v>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),m-=4,++M;switch(m){case 3:x^=(255&c.charCodeAt(M+2))<<16;case 2:x^=(255&c.charCodeAt(M+1))<<8;case 1:x=1540483477*(65535&(x^=255&c.charCodeAt(M)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),al.exports);return $o.exports=d,$o.exports.murmur3=d,$o.exports.murmur2=o,$o.exports}(),ol=_(dc);class yi{constructor(o,...c){Vi(this,c[0]||{}),this.type=o}}class ip extends yi{constructor(o,c={}){super("error",Vi({error:o},c))}}function wm(d,o,c){c[d]&&c[d].indexOf(o)!==-1||(c[d]=c[d]||[],c[d].push(o))}function hc(d,o,c){if(c&&c[d]){const p=c[d].indexOf(o);p!==-1&&c[d].splice(p,1)}}class qc{on(o,c){return this._listeners=this._listeners||{},wm(o,c,this._listeners),this}off(o,c){return hc(o,c,this._listeners),hc(o,c,this._oneTimeListeners),this}once(o,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},wm(o,c,this._oneTimeListeners),this):new Promise(p=>this.once(o,p))}fire(o,c){const p=typeof o=="string"?new yi(o,c):o,v=p.type;if(this.listens(v)){p.target=this;const m=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const j of m)j.call(this,p);const x=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const j of x)hc(v,j,this._oneTimeListeners),j.call(this,p);const M=this._eventedParent;M&&(Vi(p,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),M.fire(p))}else p instanceof ip&&console.error(p.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,c){return this._eventedParent=o,this._eventedParentData=c,this}}var oy,Sm={},Ls=function(){if(oy)return Sm;oy=1;var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(m){return(m=Math.round(m))<0?0:m>255?255:m}function c(m){return o(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function p(m){return(x=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:x>1?1:x;var x}function v(m,x,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?m+(x-m)*M*6:2*M<1?x:3*M<2?m+(x-m)*(2/3-M)*6:m}try{Sm.parseCSSColor=function(m){var x,M=m.replace(/ /g,"").toLowerCase();if(M in d)return d[M].slice();if(M[0]==="#")return M.length===4?(x=parseInt(M.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:M.length===7&&(x=parseInt(M.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var j=M.indexOf("("),F=M.indexOf(")");if(j!==-1&&F+1===M.length){var E=M.substr(0,j),N=M.substr(j+1,F-(j+1)).split(","),L=1;switch(E){case"rgba":if(N.length!==4)return null;L=p(N.pop());case"rgb":return N.length!==3?null:[c(N[0]),c(N[1]),c(N[2]),L];case"hsla":if(N.length!==4)return null;L=p(N.pop());case"hsl":if(N.length!==3)return null;var k=(parseFloat(N[0])%360+360)%360/360,I=p(N[1]),$=p(N[2]),Y=$<=.5?$*(I+1):$+I-$*I,ee=2*$-Y;return[o(255*v(ee,Y,k+1/3)),o(255*v(ee,Y,k)),o(255*v(ee,Y,k-1/3)),L];default:return null}}return null}}catch{}return Sm}();class Jn{constructor(o,c,p,v=1){this.r=o,this.g=c,this.b=p,this.a=v}static parse(o){if(!o)return;if(o instanceof Jn)return o;if(typeof o!="string")return;const c=Ls.parseCSSColor(o);return c?new Jn(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3]):void 0}toStringPremultipliedAlpha(){const[o,c,p,v]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(c)},${Math.round(p)},${v})`}toString(){const[o,c,p,v]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*c)},${Math.round(255*p)},${v})`}toRenderColor(o){const{r:c,g:p,b:v,a:m}=this;return new fc(o,c,p,v,m)}clone(){return new Jn(this.r,this.g,this.b,this.a)}}class fc{constructor(o,c,p,v,m){if(o){const x=o.image.height,M=x*x;c=m===0?0:c/m*(x-1),p=m===0?0:p/m*(x-1),v=m===0?0:v/m*(x-1);const j=Math.floor(c),F=Math.floor(p),E=Math.floor(v),N=Math.ceil(c),L=Math.ceil(p),k=Math.ceil(v),I=c-j,$=p-F,Y=v-E,ee=o.image.data,oe=4*(j+F*M+E*x),se=4*(j+F*M+k*x),ie=4*(j+L*M+E*x),he=4*(j+L*M+k*x),me=4*(N+F*M+E*x),be=4*(N+F*M+k*x),Re=4*(N+L*M+E*x),Me=4*(N+L*M+k*x);if(oe<0||Me>=ee.length)throw new Error("out of range");this.r=Dr(Dr(Dr(ee[oe],ee[se],Y),Dr(ee[ie],ee[he],Y),$),Dr(Dr(ee[me],ee[be],Y),Dr(ee[Re],ee[Me],Y),$),I)/255*m,this.g=Dr(Dr(Dr(ee[oe+1],ee[se+1],Y),Dr(ee[ie+1],ee[he+1],Y),$),Dr(Dr(ee[me+1],ee[be+1],Y),Dr(ee[Re+1],ee[Me+1],Y),$),I)/255*m,this.b=Dr(Dr(Dr(ee[oe+2],ee[se+2],Y),Dr(ee[ie+2],ee[he+2],Y),$),Dr(Dr(ee[me+2],ee[be+2],Y),Dr(ee[Re+2],ee[Me+2],Y),$),I)/255*m,this.a=m}else this.r=c,this.g=p,this.b=v,this.a=m}toArray(){const{r:o,g:c,b:p,a:v}=this;return v===0?[0,0,0,0]:[255*o/v,255*c/v,255*p/v,v]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:o,g:c,b:p,a:v}=this,m=Math.min(Math.max(o/v,0),1),x=Math.min(Math.max(c/v,0),1),M=Math.min(Math.max(p/v,0),1),j=Math.min(m,x,M),F=Math.max(m,x,M),E=(j+F)/2;if(j===F)return[0,0,100*E,v];const N=F-j,L=E>.5?N/(2-F-j):N/(F+j);let k=0;return F===m?k=(x-M)/N+(x<M?6:0):F===x?k=(M-m)/N+2:F===M&&(k=(m-x)/N+4),k*=60,[Math.min(Math.max(k,0),360),Math.min(Math.max(100*L,0),100),Math.min(Math.max(100*E,0),100),v]}toArray01(){const{r:o,g:c,b:p,a:v}=this;return v===0?[0,0,0,0]:[o/v,c/v,p/v,v]}toArray01Scaled(o){const{r:c,g:p,b:v,a:m}=this;return m===0?[0,0,0]:[c/m*o,p/m*o,v/m*o]}toArray01PremultipliedAlpha(){const{r:o,g:c,b:p,a:v}=this;return[o,c,p,v]}toArray01Linear(){const{r:o,g:c,b:p,a:v}=this;return v===0?[0,0,0,0]:[Math.pow(o/v,2.2),Math.pow(c/v,2.2),Math.pow(p/v,2.2),v]}}function Dr(d,o,c){return d*(1-c)+o*c}function Gc(d,o,c){return d.map((p,v)=>Dr(p,o[v],c))}Jn.black=new Jn(0,0,0,1),Jn.white=new Jn(1,1,1,1),Jn.transparent=new Jn(0,0,0,0),Jn.red=new Jn(1,0,0,1),Jn.blue=new Jn(0,0,1,1);var Iu=Object.freeze({__proto__:null,array:Gc,color:function(d,o,c){return new Jn(Dr(d.r,o.r,c),Dr(d.g,o.g,c),Dr(d.b,o.b,c),Dr(d.a,o.a,c))},number:Dr});function Du(d,...o){for(const c of o)for(const p in c)d[p]=c[p];return d}class dn extends Error{constructor(o,c){super(c),this.message=c,this.key=o}}class Am{constructor(o,c=[]){this.parent=o,this.bindings={};for(const[p,v]of c)this.bindings[p]=v}concat(o){return new Am(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Lu={kind:"null"},_r={kind:"number"},pi={kind:"string"},Wn={kind:"boolean"},fo={kind:"color"},pc={kind:"object"},ai={kind:"value"},Kc={kind:"collator"},zs={kind:"formatted"},mc={kind:"resolvedImage"};function Ka(d,o){return{kind:"array",itemType:d,N:o}}function pa(d){if(d.kind==="array"){const o=pa(d.itemType);return typeof d.N=="number"?`array<${o}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${o}>`}return d.kind}const sy=[Lu,_r,pi,Wn,fo,zs,pc,Ka(ai),mc];function qo(d,o){if(o.kind==="error")return null;if(d.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!qo(d.itemType,o.itemType))&&(typeof d.N!="number"||d.N===o.N))return null}else{if(d.kind===o.kind)return null;if(d.kind==="value"){for(const c of sy)if(!qo(c,o))return null}}return`Expected ${pa(d)} but found ${pa(o)} instead.`}function Rd(d,o){return o.some(c=>c.kind===d.kind)}function kd(d,o){return o.some(c=>c==="null"?d===null:c==="array"?Array.isArray(d):c==="object"?d&&!Array.isArray(d)&&typeof d=="object":c===typeof d)}class ap{constructor(o,c,p){this.sensitivity=o?c?"variant":"case":c?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,c){return this.collator.compare(o,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class wl{constructor(o,c,p,v,m){this.text=o.normalize?o.normalize():o,this.image=c,this.scale=p,this.fontStack=v,this.textColor=m}}class Ao{constructor(o){this.sections=o}static fromString(o){return new Ao([new wl(o,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.namePrimary)}static factory(o){return o instanceof Ao?o:Ao.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const c of this.sections){if(c.image){o.push(["image",c.image.namePrimary]);continue}o.push(c.text);const p={};c.fontStack&&(p["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(p["font-scale"]=c.scale),c.textColor&&(p["text-color"]=["rgba"].concat(c.textColor.toRenderColor(null).toArray())),o.push(p)}return o}}class sl{constructor(o,c){if(this.id=o,this.options=c||{params:{}},this.options.transform){const{a:p,b:v,c:m,d:x,e:M,f:j}=this.options.transform;this.options.transform=new DOMMatrix([p,v,m,x,M,j])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(o){return JSON.parse(o).id}static deserializeFromString(o){const c=JSON.parse(o),{a:p,b:v,c:m,d:x,e:M,f:j}=c.options.transform;return new DOMMatrix([p,v,m,x,M,j]),new sl(c.id,c.options)}scaleSelf(o){return this.options.transform=this.options.transform.scale(o),this}serialize(){const o={id:this.id};this.options&&(o.options=this.options);const{a:c,b:p,c:v,d:m,e:x,f:M}=this.options.transform;return o.options.transform={a:c,b:p,c:v,d:m,e:x,f:M},JSON.stringify(o)}}class To{constructor(o){this.namePrimary=o.namePrimary,o.nameSecondary&&(this.nameSecondary=o.nameSecondary),o.optionsPrimary&&(this.optionsPrimary=o.optionsPrimary),o.optionsSecondary&&(this.optionsSecondary=o.optionsSecondary),this.available=o.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new sl(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new sl(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(o){return typeof o=="string"?To.build(o):o}static build(o,c,p,v){return o?new To({namePrimary:o,nameSecondary:c,optionsPrimary:p,optionsSecondary:v,available:!1}):null}}function Zh(d,o,c,p){return typeof d=="number"&&d>=0&&d<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof c=="number"&&c>=0&&c<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[d,o,c,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[d,o,c,p]:[d,o,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Sl(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Jn||d instanceof ap||d instanceof Ao||d instanceof To)return!0;if(Array.isArray(d)){for(const o of d)if(!Sl(o))return!1;return!0}if(typeof d=="object"){for(const o in d)if(!Sl(d[o]))return!1;return!0}return!1}function na(d){if(d===null)return Lu;if(typeof d=="string")return pi;if(typeof d=="boolean")return Wn;if(typeof d=="number")return _r;if(d instanceof Jn)return fo;if(d instanceof ap)return Kc;if(d instanceof Ao)return zs;if(d instanceof To)return mc;if(Array.isArray(d)){const o=d.length;let c;for(const p of d){const v=na(p);if(c){if(c===v)continue;c=ai;break}c=v}return Ka(c||ai,o)}return pc}function Ra(d){const o=typeof d;return d===null?"":o==="string"||o==="number"||o==="boolean"?String(d):d instanceof Jn?d.toStringPremultipliedAlpha():d instanceof Ao||d instanceof To?d.toString():JSON.stringify(d)}class ka{constructor(o,c){this.type=o,this.value=c}static parse(o,c){if(o.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Sl(o[1]))return c.error("invalid value");const p=o[1];let v=na(p);const m=c.expectedType;return v.kind!=="array"||v.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(v=m),new ka(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Jn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Ao?this.value.serialize():this.value}}class ma{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Wc={string:pi,number:_r,boolean:Wn,object:pc};class Gl{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");let p,v=1;const m=o[0];if(m==="array"){let M,j;if(o.length>2){const F=o[1];if(typeof F!="string"||!(F in Wc)||F==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);M=Wc[F],v++}else M=ai;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return c.error('The length argument to "array" must be a positive integer literal',2);j=o[2],v++}p=Ka(M,j)}else p=Wc[m];const x=[];for(;v<o.length;v++){const M=c.parse(o[v],v,ai);if(!M)return null;x.push(M)}return new Gl(p,x)}evaluate(o){for(let c=0;c<this.args.length;c++){const p=this.args[c].evaluate(o);if(!qo(this.type,na(p)))return p;if(c===this.args.length-1)throw new ma(`The expression ${JSON.stringify(this.args[c].serialize())} evaluated to ${pa(na(p))} but was expected to be of type ${pa(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,c=[o.kind];if(o.kind==="array"){const p=o.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){c.push(p.kind);const v=o.N;(typeof v=="number"||this.args.length>1)&&c.push(v)}}return c.concat(this.args.map(p=>p.serialize()))}}class Hc{constructor(o){this.type=zs,this.sections=o}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const p=o[1];if(!Array.isArray(p)&&typeof p=="object")return c.error("First argument must be an image or text section.");const v=[];let m=!1;for(let x=1;x<=o.length-1;++x){const M=o[x];if(m&&typeof M=="object"&&!Array.isArray(M)){m=!1;let j=null;if(M["font-scale"]&&(j=c.parseObjectValue(M["font-scale"],x,"font-scale",_r),!j))return null;let F=null;if(M["text-font"]&&(F=c.parseObjectValue(M["text-font"],x,"text-font",Ka(pi)),!F))return null;let E=null;if(M["text-color"]&&(E=c.parseObjectValue(M["text-color"],x,"text-color",fo),!E))return null;const N=v[v.length-1];N.scale=j,N.font=F,N.textColor=E}else{const j=c.parse(o[x],x,ai);if(!j)return null;const F=j.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,v.push({content:j,scale:null,font:null,textColor:null})}}return new Hc(v)}evaluate(o){return new Ao(this.sections.map(c=>{const p=c.content.evaluate(o);return na(p)===mc?new wl("",p,null,null,null):new wl(Ra(p),null,c.scale?c.scale.evaluate(o):null,c.font?c.font.evaluate(o).join(","):null,c.textColor?c.textColor.evaluate(o):null)}))}eachChild(o){for(const c of this.sections)o(c.content),c.scale&&o(c.scale),c.font&&o(c.font),c.textColor&&o(c.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const c of this.sections){o.push(c.content.serialize());const p={};c.scale&&(p["font-scale"]=c.scale.serialize()),c.font&&(p["text-font"]=c.font.serialize()),c.textColor&&(p["text-color"]=c.textColor.serialize()),o.push(p)}return o}}class jd{constructor(o,c,p,v){this._imageWarnHistory={},this.type=mc,this.inputPrimary=o,this.inputSecondary=c,this.inputPrimaryParams=p,this.inputSecondaryParams=v}static parse(o,c){if(o.length<2)return c.error("Expected two or more arguments.");let p=1;const v=[];function m(){if(p<o.length){const M=c.parse(o[p],p++,pi);return M?(v.push({image:M,options:void 0}),!0):(c.error(v.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function x(){if(p<o.length){if((M=o[p])===null||typeof M!="object"||Array.isArray(M))return!0;const j=o[p].params,F=c.concat(p);if(!j)return p++,!0;if(typeof j!="object"||j.constructor!==Object)return F.error('Image options "params" should be an object'),!1;const E={},N=F.concat(void 0,"params");for(const L in j){if(!L)return N.error("Image parameter name should be non-empty"),!1;const k=N.concat(void 0,L).parse(j[L],void 0,fo,void 0,{typeAnnotation:"coerce"});if(!k)return!1;E[L]=k}return v[v.length-1].options=E,p++,!0}var M;return!0}for(let M=0;M<2;M++)if(!m()||!x())return;return new jd(v[0].image,v[1]?v[1].image:void 0,v[0].options,v[1]?v[1].options:void 0)}evaluateParams(o,c){const p={};if(c){for(const v in c)if(c[v])try{const m=c[v].evaluate(o),x=`Ignoring image parameter "${v}" with semi-transparent color ${m.toString()}`;if(m.a!==1){this._imageWarnHistory[x]||(console.warn(x),this._imageWarnHistory[x]=!0);continue}p[v]=m}catch{continue}if(Object.keys(p).length!==0)return{params:p}}}evaluate(o){const c=To.build(this.inputPrimary.evaluate(o),this.inputSecondary?this.inputSecondary.evaluate(o):void 0,this.inputPrimaryParams?this.evaluateParams(o,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(o,this.inputSecondaryParams):void 0);return c&&o.availableImages&&(c.available=o.availableImages.indexOf(c.namePrimary)>-1,c.nameSecondary&&c.available&&o.availableImages&&(c.available=o.availableImages.indexOf(c.nameSecondary)>-1)),c}eachChild(o){if(o(this.inputPrimary),this.inputPrimaryParams)for(const c in this.inputPrimaryParams)this.inputPrimaryParams[c]&&o(this.inputPrimaryParams[c]);if(this.inputSecondary&&(o(this.inputSecondary),this.inputSecondaryParams))for(const c in this.inputSecondaryParams)this.inputSecondaryParams[c]&&o(this.inputSecondaryParams[c])}outputDefined(){return!1}serializeParams(o){const c={};if(o){for(const p in o)o[p]&&(c[p]=o[p].serialize());return{params:c}}}serialize(){const o=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&o.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(o.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&o.push(this.serializeParams(this.inputSecondaryParams))),o}}function vs(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}const Yh={"to-boolean":Wn,"to-color":fo,"to-number":_r,"to-string":pi};class gc{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expected at least one argument.");const p=o[0],v=[];let m=Lu;if(p==="to-array"){if(!Array.isArray(o[1]))return null;const x=o[1].length;if(c.expectedType){if(c.expectedType.kind!=="array")return c.error(`Expected ${c.expectedType.kind} but found array.`);m=Ka(c.expectedType.itemType,x)}else{if(!(x>0&&Sl(o[1][0])))return null;m=Ka(na(o[1][0]),x)}for(let M=0;M<x;M++){const j=o[1][M];let F;if(vs(j)==="array")F=c.parse(j,void 0,m.itemType);else{const E=vs(j);if(E!==m.itemType.kind)return c.error(`Expected ${m.itemType.kind} but found ${E}.`);F=c.registry.literal.parse(["literal",j===void 0?null:j],c)}if(!F)return null;v.push(F)}}else{if((p==="to-boolean"||p==="to-string")&&o.length!==2)return c.error("Expected one argument.");m=Yh[p];for(let x=1;x<o.length;x++){const M=c.parse(o[x],x,ai);if(!M)return null;v.push(M)}}return new gc(m,v)}evaluate(o){if(this.type.kind==="boolean")return!!this.args[0].evaluate(o);if(this.type.kind==="color"){let c,p;for(const v of this.args){if(c=v.evaluate(o),p=null,c instanceof Jn)return c;if(typeof c=="string"){const m=o.parseColor(c);if(m)return m}else if(Array.isArray(c)&&(p=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Zh(c[0],c[1],c[2],c[3]),!p))return new Jn(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new ma(p||`Could not parse color from value '${typeof c=="string"?c:String(JSON.stringify(c))}'`)}if(this.type.kind==="number"){let c=null;for(const p of this.args){if(c=p.evaluate(o),c===null)return 0;const v=Number(c);if(!isNaN(v))return v}throw new ma(`Could not convert ${JSON.stringify(c)} to number.`)}return this.type.kind==="formatted"?Ao.fromString(Ra(this.args[0].evaluate(o))):this.type.kind==="resolvedImage"?To.build(Ra(this.args[0].evaluate(o))):this.type.kind==="array"?this.args.map(c=>c.evaluate(o)):Ra(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Hc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new jd(this.args[0]).serialize();const o=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(c=>{o.push(c.serialize())}),o}}const z0=["Unknown","Point","LineString","Polygon"];class ly{constructor(o,c){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=c}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?z0[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,c=this.featureDistanceData.scale,{x:p,y:v}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*c-o[0])+this.featureDistanceData.bearing[1]*(v*c-o[1])}return 0}parseColor(o){let c=this._parseColorCache[o];return c||(c=this._parseColorCache[o]=Jn.parse(o)),c}getConfig(o){return this.options?this.options.get(o):null}}class _s{constructor(o,c,p,v,m){this.name=o,this.type=c,this._evaluate=p,this.args=v,this._overloadIndex=m}evaluate(o){if(!this._evaluate){const c=_s.definitions[this.name];this._evaluate=Array.isArray(c)?c[2]:c.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,c){const p=o[0],v=_s.definitions[p];if(!v)return c.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(v)?v[0]:v.type,x=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,M=[];let j=null,F=-1;for(const[E,N]of x){if(Array.isArray(E)&&E.length!==o.length-1)continue;M.push(E),F++,j=new rf(c.registry,c.path,null,c.scope,void 0,c._scope,c.options);const L=[];let k=!1;for(let I=1;I<o.length;I++){const $=o[I],Y=Array.isArray(E)?E[I-1]:E.type,ee=j.parse($,1+L.length,Y);if(!ee){k=!0;break}L.push(ee)}if(!k)if(Array.isArray(E)&&E.length!==L.length)j.error(`Expected ${E.length} arguments, but found ${L.length} instead.`);else{for(let I=0;I<L.length;I++){const $=Array.isArray(E)?E[I]:E.type,Y=L[I];j.concat(I+1).checkSubtype($,Y.type)}if(j.errors.length===0)return new _s(p,m,N,L,F)}}if(M.length===1)c.errors.push(...j.errors);else{const E=(M.length?M:x.map(([L])=>L)).map(op).join(" | "),N=[];for(let L=1;L<o.length;L++){const k=c.parse(o[L],1+N.length);if(!k)return null;N.push(pa(k.type))}c.error(`Expected arguments of type ${E}, but found (${N.join(", ")}) instead.`)}return null}static register(o,c){_s.definitions=c;for(const p in c)o[p]=_s}}function op(d){return Array.isArray(d)?`(${d.map(pa).join(", ")})`:`(${pa(d.type)}...)`}class Tm{constructor(o,c,p){this.type=Kc,this.locale=p,this.caseSensitive=o,this.diacriticSensitive=c}static parse(o,c){if(o.length!==2)return c.error("Expected one argument.");const p=o[1];if(typeof p!="object"||Array.isArray(p))return c.error("Collator options argument must be an object.");const v=p["case-sensitive"]===void 0?c.parse(!1,1,Wn):c.parseObjectValue(p["case-sensitive"],1,"case-sensitive",Wn);if(!v)return null;const m=p["diacritic-sensitive"]===void 0?c.parse(!1,1,Wn):c.parseObjectValue(p["diacritic-sensitive"],1,"diacritic-sensitive",Wn);if(!m)return null;let x=null;return p.locale&&(x=c.parseObjectValue(p.locale,1,"locale",pi),!x)?null:new Tm(v,m,x)}evaluate(o){return new ap(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function sp(d,o,c=0,p=d.length-1,v=F0){for(;p>c;){if(p-c>600){const j=p-c+1,F=o-c+1,E=Math.log(j),N=.5*Math.exp(2*E/3),L=.5*Math.sqrt(E*N*(j-N)/j)*(F-j/2<0?-1:1);sp(d,o,Math.max(c,Math.floor(o-F*N/j+L)),Math.min(p,Math.floor(o+(j-F)*N/j+L)),v)}const m=d[o];let x=c,M=p;for(lp(d,c,o),v(d[p],m)>0&&lp(d,c,p);x<M;){for(lp(d,x,M),x++,M--;v(d[x],m)<0;)x++;for(;v(d[M],m)>0;)M--}v(d[c],m)===0?lp(d,c,M):(M++,lp(d,M,p)),M<=o&&(c=M+1),o<=M&&(p=M-1)}}function lp(d,o,c){const p=d[o];d[o]=d[c],d[c]=p}function F0(d,o){return d<o?-1:d>o?1:0}function B0(d){let o=0;for(let c,p,v=0,m=d.length,x=m-1;v<m;x=v++)c=d[v],p=d[x],o+=(p.x-c.x)*(c.y+p.y);return o}function Xh(d,o){d[0]=Math.min(d[0],o[0]),d[1]=Math.min(d[1],o[1]),d[2]=Math.max(d[2],o[0]),d[3]=Math.max(d[3],o[1])}function cp(d,o){return!(d[0]<=o[0]||d[2]>=o[2]||d[1]<=o[1]||d[3]>=o[3])}function V0(d,o,c){const p=d[0]-o[0],v=d[1]-o[1],m=d[0]-c[0],x=d[1]-c[1];return p*x-m*v==0&&p*m<=0&&v*x<=0}function Jh(d,o,c=!1){let p=!1;for(let M=0,j=o.length;M<j;M++){const F=o[M];for(let E=0,N=F.length,L=N-1;E<N;L=E++){const k=F[L],I=F[E];if(V0(d,k,I))return c;(m=k)[1]>(v=d)[1]!=(x=I)[1]>v[1]&&v[0]<(x[0]-m[0])*(v[1]-m[1])/(x[1]-m[1])+m[0]&&(p=!p)}}var v,m,x;return p}function cy(d,o,c,p){const v=p[0]-c[0],m=p[1]-c[1],x=(d[0]-c[0])*m-v*(d[1]-c[1]),M=(o[0]-c[0])*m-v*(o[1]-c[1]);return x>0&&M<0||x<0&&M>0}function Kl(d,o,c,p){return(v=[p[0]-c[0],p[1]-c[1]])[0]*(m=[o[0]-d[0],o[1]-d[1]])[1]-v[1]*m[0]!=0&&!(!cy(d,o,c,p)||!cy(c,p,d,o));var v,m}const zu=8192;function U0(d,o){const c=(180+d[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,v=Math.pow(2,o.z);return[Math.round(c*v*zu),Math.round(p*v*zu)]}function uy(d,o){for(let c=0;c<o.length;c++)if(Jh(d,o[c]))return!0;return!1}function e_(d,o,c){for(const p of c)for(let v=0,m=p.length,x=m-1;v<m;x=v++)if(Kl(d,o,p[x],p[v]))return!0;return!1}function t_(d,o){for(let c=0;c<d.length;++c)if(!Jh(d[c],o))return!1;for(let c=0;c<d.length-1;++c)if(e_(d[c],d[c+1],o))return!1;return!0}function $0(d,o){for(let c=0;c<o.length;c++)if(t_(d,o[c]))return!0;return!1}function dy(d,o,c){const p=[];for(let v=0;v<d.length;v++){const m=[];for(let x=0;x<d[v].length;x++){const M=U0(d[v][x],c);Xh(o,M),m.push(M)}p.push(m)}return p}function Nd(d,o,c){const p=[];for(let v=0;v<d.length;v++){const m=dy(d[v],o,c);p.push(m)}return p}function xn(d,o,c,p){if(d[0]<c[0]||d[0]>c[2]){const v=.5*p;let m=d[0]-c[0]>v?-p:c[0]-d[0]>v?p:0;m===0&&(m=d[0]-c[2]>v?-p:c[2]-d[0]>v?p:0),d[0]+=m}Xh(o,d)}function Lr(d,o,c,p){const v=Math.pow(2,p.z)*zu,m=[p.x*zu,p.y*zu],x=[];if(!d)return x;for(const M of d)for(const j of M){const F=[j.x+m[0],j.y+m[1]];xn(F,o,c,v),x.push(F)}return x}function Pm(d,o,c,p){const v=Math.pow(2,p.z)*zu,m=[p.x*zu,p.y*zu],x=[];if(!d)return x;for(const j of d){const F=[];for(const E of j){const N=[E.x+m[0],E.y+m[1]];Xh(o,N),F.push(N)}x.push(F)}if(o[2]-o[0]<=v/2){(M=o)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const j of x)for(const F of j)xn(F,o,c,v)}var M;return x}class Gr{constructor(o,c){this.type=Wn,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Sl(o[1])){const p=o[1];if(p.type==="FeatureCollection")for(let v=0;v<p.features.length;++v){const m=p.features[v].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Gr(p,p.features[v].geometry)}else if(p.type==="Feature"){const v=p.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Gr(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Gr(p,p)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(c,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(p.type==="Polygon"){const M=dy(p.coordinates,m,x),j=Lr(c.geometry(),v,m,x);if(!cp(v,m))return!1;for(const F of j)if(!Jh(F,M))return!1}if(p.type==="MultiPolygon"){const M=Nd(p.coordinates,m,x),j=Lr(c.geometry(),v,m,x);if(!cp(v,m))return!1;for(const F of j)if(!uy(F,M))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(c,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],x=c.canonicalID();if(!x)return!1;if(p.type==="Polygon"){const M=dy(p.coordinates,m,x),j=Pm(c.geometry(),v,m,x);if(!cp(v,m))return!1;for(const F of j)if(!t_(F,M))return!1}if(p.type==="MultiPolygon"){const M=Nd(p.coordinates,m,x),j=Pm(c.geometry(),v,m,x);if(!cp(v,m))return!1;for(const F of j)if(!$0(F,M))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const yc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Em=1/298.257223563,Hr=Em*(2-Em),Id=Math.PI/180;class Fu{static fromTile(o,c,p){const v=Math.PI*(1-2*(o+.5)/Math.pow(2,c)),m=Math.atan(.5*(Math.exp(v)-Math.exp(-v)))/Id;return new Fu(m,p)}static get units(){return yc}constructor(o,c){if(o===void 0)throw new Error("No latitude given.");if(c&&!yc[c])throw new Error(`Unknown unit ${c}. Use one of: ${Object.keys(yc).join(", ")}`);const p=6378.137*Id*(c?yc[c]:1),v=Math.cos(o*Id),m=1/(1-Hr*(1-v*v)),x=Math.sqrt(m);this.kx=p*x*v,this.ky=p*x*m*(1-Hr)}distance(o,c){const p=po(o[0]-c[0])*this.kx,v=(o[1]-c[1])*this.ky;return Math.sqrt(p*p+v*v)}bearing(o,c){const p=po(c[0]-o[0])*this.kx;return Math.atan2(p,(c[1]-o[1])*this.ky)/Id}destination(o,c,p){const v=p*Id;return this.offset(o,Math.sin(v)*c,Math.cos(v)*c)}offset(o,c,p){return[o[0]+c/this.kx,o[1]+p/this.ky]}lineDistance(o){let c=0;for(let p=0;p<o.length-1;p++)c+=this.distance(o[p],o[p+1]);return c}area(o){let c=0;for(let p=0;p<o.length;p++){const v=o[p];for(let m=0,x=v.length,M=x-1;m<x;M=m++)c+=po(v[m][0]-v[M][0])*(v[m][1]+v[M][1])*(p?-1:1)}return Math.abs(c)/2*this.kx*this.ky}along(o,c){let p=0;if(c<=0)return o[0];for(let v=0;v<o.length-1;v++){const m=o[v],x=o[v+1],M=this.distance(m,x);if(p+=M,p>c)return up(m,x,(c-(p-M))/M)}return o[o.length-1]}pointToSegmentDistance(o,c,p){let[v,m]=c,x=po(p[0]-v)*this.kx,M=(p[1]-m)*this.ky;if(x!==0||M!==0){const j=(po(o[0]-v)*this.kx*x+(o[1]-m)*this.ky*M)/(x*x+M*M);j>1?(v=p[0],m=p[1]):j>0&&(v+=x/this.kx*j,m+=M/this.ky*j)}return x=po(o[0]-v)*this.kx,M=(o[1]-m)*this.ky,Math.sqrt(x*x+M*M)}pointOnLine(o,c){let p=1/0,v=o[0][0],m=o[0][1],x=0,M=0;for(let j=0;j<o.length-1;j++){let F=o[j][0],E=o[j][1],N=po(o[j+1][0]-F)*this.kx,L=(o[j+1][1]-E)*this.ky,k=0;N===0&&L===0||(k=(po(c[0]-F)*this.kx*N+(c[1]-E)*this.ky*L)/(N*N+L*L),k>1?(F=o[j+1][0],E=o[j+1][1]):k>0&&(F+=N/this.kx*k,E+=L/this.ky*k)),N=po(c[0]-F)*this.kx,L=(c[1]-E)*this.ky;const I=N*N+L*L;I<p&&(p=I,v=F,m=E,x=j,M=k)}return{point:[v,m],index:x,t:Math.max(0,Math.min(1,M))}}lineSlice(o,c,p){let v=this.pointOnLine(p,o),m=this.pointOnLine(p,c);if(v.index>m.index||v.index===m.index&&v.t>m.t){const F=v;v=m,m=F}const x=[v.point],M=v.index+1,j=m.index;!Cm(p[M],x[0])&&M<=j&&x.push(p[M]);for(let F=M+1;F<=j;F++)x.push(p[F]);return Cm(p[j],m.point)||x.push(m.point),x}lineSliceAlong(o,c,p){let v=0;const m=[];for(let x=0;x<p.length-1;x++){const M=p[x],j=p[x+1],F=this.distance(M,j);if(v+=F,v>o&&m.length===0&&m.push(up(M,j,(o-(v-F))/F)),v>=c)return m.push(up(M,j,(c-(v-F))/F)),m;v>o&&m.push(j)}return m}bufferPoint(o,c){const p=c/this.ky,v=c/this.kx;return[o[0]-v,o[1]-p,o[0]+v,o[1]+p]}bufferBBox(o,c){const p=c/this.ky,v=c/this.kx;return[o[0]-v,o[1]-p,o[2]+v,o[3]+p]}insideBBox(o,c){return po(o[0]-c[0])>=0&&po(o[0]-c[2])<=0&&o[1]>=c[1]&&o[1]<=c[3]}}function Cm(d,o){return d[0]===o[0]&&d[1]===o[1]}function up(d,o,c){const p=po(o[0]-d[0]);return[d[0]+p*c,d[1]+(o[1]-d[1])*c]}function po(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}class Io{constructor(o=[],c=(p,v)=>p<v?-1:p>v?1:0){if(this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:c,compare:p}=this,v=c[o];for(;o>0;){const m=o-1>>1,x=c[m];if(p(v,x)>=0)break;c[o]=x,o=m}c[o]=v}_down(o){const{data:c,compare:p}=this,v=this.length>>1,m=c[o];for(;o<v;){let x=1+(o<<1);const M=x+1;if(M<this.length&&p(c[M],c[x])<0&&(x=M),p(c[x],m)>=0)break;c[o]=c[x],o=x}c[o]=m}}var ar=8192;function hy(d,o){return o.dist-d.dist}const dp=100,Qh=50;function Al(d){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==d.length)return!1;for(let c=0;c<o.length;c++)if(o[c]!==d[c])return!1;return!0}function Da(d){return d[1]-d[0]+1}function Zc(d,o){const c=d[1]>=d[0]&&d[1]<o;return c||console.warn("Distance Expression: Index is out of range"),c}function ef(d,o){if(d[0]>d[1])return[null,null];const c=Da(d);if(o){if(c===2)return[d,null];const p=Math.floor(c/2);return[[d[0],d[0]+p],[d[0]+p,d[1]]]}{if(c===1)return[d,null];const p=Math.floor(c/2)-1;return[[d[0],d[0]+p],[d[0]+p+1,d[1]]]}}function Dd(d,o){const c=[1/0,1/0,-1/0,-1/0];if(!Zc(o,d.length))return c;for(let p=o[0];p<=o[1];++p)Xh(c,d[p]);return c}function Bu(d){const o=[1/0,1/0,-1/0,-1/0];for(let c=0;c<d.length;++c)for(let p=0;p<d[c].length;++p)Xh(o,d[c][p]);return o}function Yc(d,o,c){if(Al(d)||Al(o))return NaN;let p=0,v=0;return d[2]<o[0]&&(p=o[0]-d[2]),d[0]>o[2]&&(p=d[0]-o[2]),d[1]>o[3]&&(v=d[1]-o[3]),d[3]<o[1]&&(v=o[1]-d[3]),c.distance([0,0],[p,v])}function hp(d){return 360*d-180}function r_(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function Mm(d,o){const c=Math.pow(2,o.z),p=(d.y/ar+o.y)/c;return[hp((d.x/ar+o.x)/c),r_(p)]}function n_(d,o){const c=[];for(let p=0;p<d.length;++p)c.push(Mm(d[p],o));return c}function i_(d,o,c){const p=c.pointOnLine(o,d).point;return c.distance(d,p)}function fy(d,o,c,p,v){const m=c.slice(p[0],p[1]+1);let x=1/0;for(let M=o[0];M<=o[1];++M)if((x=Math.min(x,i_(d[M],m,v)))===0)return 0;return x}function py(d,o,c,p,v){const m=Math.min(v.pointToSegmentDistance(d,c,p),v.pointToSegmentDistance(o,c,p)),x=Math.min(v.pointToSegmentDistance(c,d,o),v.pointToSegmentDistance(p,d,o));return Math.min(m,x)}function q0(d,o,c,p,v){if(!Zc(o,d.length)||!Zc(p,c.length))return NaN;let m=1/0;for(let x=o[0];x<o[1];++x)for(let M=p[0];M<p[1];++M){if(Kl(d[x],d[x+1],c[M],c[M+1]))return 0;m=Math.min(m,py(d[x],d[x+1],c[M],c[M+1],v))}return m}function a_(d,o,c,p,v){if(!Zc(o,d.length)||!Zc(p,c.length))return NaN;let m=1/0;for(let x=o[0];x<=o[1];++x)for(let M=p[0];M<=p[1];++M)if((m=Math.min(m,v.distance(d[x],c[M])))===0)return m;return m}function Go(d,o,c){if(Jh(d,o,!0))return 0;let p=1/0;for(const v of o){const m=v.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(v[0]!==v[m-1]&&(p=Math.min(p,c.pointToSegmentDistance(d,v[m-1],v[0])))===0||(p=Math.min(p,i_(d,v,c)))===0)return p}return p}function fp(d,o,c,p){if(!Zc(o,d.length))return NaN;for(let m=o[0];m<=o[1];++m)if(Jh(d[m],c,!0))return 0;let v=1/0;for(let m=o[0];m<o[1];++m)for(const x of c)for(let M=0,j=x.length,F=j-1;M<j;F=M++){if(Kl(d[m],d[m+1],x[F],x[M]))return 0;v=Math.min(v,py(d[m],d[m+1],x[F],x[M],p))}return v}function my(d,o){for(const c of d)for(let p=0;p<=c.length-1;++p)if(Jh(c[p],o,!0))return!0;return!1}function Om(d,o,c,p=1/0){const v=Bu(d),m=Bu(o);if(p!==1/0&&Yc(v,m,c)>=p)return p;if(cp(v,m)){if(my(d,o))return 0}else if(my(o,d))return 0;let x=p;for(const M of d)for(let j=0,F=M.length,E=F-1;j<F;E=j++)for(const N of o)for(let L=0,k=N.length,I=k-1;L<k;I=L++){if(Kl(M[E],M[j],N[I],N[L]))return 0;x=Math.min(x,py(M[E],M[j],N[I],N[L],c))}return x}function tf(d,o,c,p,v,m,x){if(m===null||x===null)return;const M=Yc(Dd(p,m),Dd(v,x),c);M<o&&d.push({dist:M,range1:m,range2:x})}function gy(d,o,c,p,v=1/0){let m=Math.min(p.distance(d[0],c[0][0]),v);if(m===0)return m;const x=new Io([{dist:0,range1:[0,d.length-1],range2:[0,0]}],hy),M=o?Qh:dp,j=Bu(c);for(;x.length;){const F=x.pop();if(F.dist>=m)continue;const E=F.range1;if(Da(E)<=M){if(!Zc(E,d.length))return NaN;if(o){const N=fp(d,E,c,p);if((m=Math.min(m,N))===0)return m}else for(let N=E[0];N<=E[1];++N){const L=Go(d[N],c,p);if((m=Math.min(m,L))===0)return m}}else{const N=ef(E,o);if(N[0]!==null){const L=Yc(Dd(d,N[0]),j,p);L<m&&x.push({dist:L,range1:N[0],range2:[0,0]})}if(N[1]!==null){const L=Yc(Dd(d,N[1]),j,p);L<m&&x.push({dist:L,range1:N[1],range2:[0,0]})}}}return m}function Fs(d,o,c,p,v,m=1/0){let x=Math.min(m,v.distance(d[0],c[0]));if(x===0)return x;const M=new Io([{dist:0,range1:[0,d.length-1],range2:[0,c.length-1]}],hy),j=o?Qh:dp,F=p?Qh:dp;for(;M.length;){const E=M.pop();if(E.dist>=x)continue;const N=E.range1,L=E.range2;if(Da(N)<=j&&Da(L)<=F){if(!Zc(N,d.length)||!Zc(L,c.length))return NaN;if(o&&p?x=Math.min(x,q0(d,N,c,L,v)):o||p?o&&!p?x=Math.min(x,fy(c,L,d,N,v)):!o&&p&&(x=Math.min(x,fy(d,N,c,L,v))):x=Math.min(x,a_(d,N,c,L,v)),x===0)return x}else{const k=ef(N,o),I=ef(L,p);tf(M,x,v,d,c,k[0],I[0]),tf(M,x,v,d,c,k[0],I[1]),tf(M,x,v,d,c,k[1],I[0]),tf(M,x,v,d,c,k[1],I[1])}}return x}function Rm(d,o,c,p,v=1/0){let m=v;const x=Dd(d,[0,d.length-1]);for(const M of c)if(!(m!==1/0&&Yc(x,Dd(M,[0,M.length-1]),p)>=m)&&(m=Math.min(m,Fs(d,o,M,!0,p,m)),m===0))return m;return m}function pp(d,o,c,p,v=1/0){let m=v;const x=Dd(d,[0,d.length-1]);for(const M of c){if(m!==1/0&&Yc(x,Bu(M),p)>=m)continue;const j=gy(d,o,M,p,m);if(isNaN(j))return j;if((m=Math.min(m,j))===0)return m}return m}function Xc(d){return d==="Point"||d==="MultiPoint"||d==="LineString"||d==="MultiLineString"||d==="Polygon"||d==="MultiPolygon"}class vc{constructor(o,c){this.type=_r,this.geojson=o,this.geometries=c}static parse(o,c){if(o.length!==2)return c.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(Sl(o[1])){const p=o[1];if(p.type==="FeatureCollection"){for(let v=0;v<p.features.length;++v)if(Xc(p.features[v].geometry.type))return new vc(p,p.features[v].geometry)}else if(p.type==="Feature"){if(Xc(p.geometry.type))return new vc(p,p.geometry)}else if(Xc(p.type))return new vc(p,p)}return c.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const c=o.geometry(),p=o.canonicalID();if(c!=null&&p!=null){if(o.geometryType()==="Point")return function(v,m,x){const M=[];for(const F of v)for(const E of F)M.push(Mm(E,m));const j=new Fu(M[0][1],"meters");return x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString"?Fs(M,!1,x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",j):x.type==="MultiLineString"?Rm(M,!1,x.coordinates,j):x.type==="Polygon"||x.type==="MultiPolygon"?pp(M,!1,x.type==="Polygon"?[x.coordinates]:x.coordinates,j):null}(c,p,this.geometries);if(o.geometryType()==="LineString")return function(v,m,x){const M=[];for(const F of v){const E=[];for(const N of F)E.push(Mm(N,m));M.push(E)}const j=new Fu(M[0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return Rm(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",M,j);if(x.type==="MultiLineString"){let F=1/0;for(let E=0;E<x.coordinates.length;E++){const N=Rm(x.coordinates[E],!0,M,j,F);if(isNaN(N))return N;if((F=Math.min(F,N))===0)return F}return F}if(x.type==="Polygon"||x.type==="MultiPolygon"){let F=1/0;for(let E=0;E<M.length;E++){const N=pp(M[E],!0,x.type==="Polygon"?[x.coordinates]:x.coordinates,j,F);if(isNaN(N))return N;if((F=Math.min(F,N))===0)return F}return F}return null}(c,p,this.geometries);if(o.geometryType()==="Polygon")return function(v,m,x){const M=[];for(const F of function(E,N){const L=E.length;if(L<=1)return[E];const k=[];let I,$;for(let Y=0;Y<L;Y++){const ee=B0(E[Y]);ee!==0&&(E[Y].area=Math.abs(ee),$===void 0&&($=ee<0),$===ee<0?(I&&k.push(I),I=[E[Y]]):I.push(E[Y]))}return I&&k.push(I),k}(v)){const E=[];for(let N=0;N<F.length;++N)E.push(n_(F[N],m));M.push(E)}const j=new Fu(M[0][0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return pp(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",M,j);if(x.type==="MultiLineString"){let F=1/0;for(let E=0;E<x.coordinates.length;E++){const N=pp(x.coordinates[E],!0,M,j,F);if(isNaN(N))return N;if((F=Math.min(F,N))===0)return F}return F}return x.type==="Polygon"||x.type==="MultiPolygon"?function(F,E,N){let L=1/0;for(const k of F)for(const I of E){const $=Om(k,I,N,L);if(isNaN($))return $;if((L=Math.min(L,$))===0)return L}return L}(x.type==="Polygon"?[x.coordinates]:x.coordinates,M,j):null}(c,p,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Vu(d,o){switch(d){case"string":return Ra(o);case"number":return+o;case"boolean":return!!o;case"color":return Jn.parse(o);case"formatted":return Ao.fromString(Ra(o));case"resolvedImage":return To.build(Ra(o))}return o}function mp(d,o,c,p){return p!==void 0&&(d=p*Math.round(d/p)),o!==void 0&&d<o&&(d=o),c!==void 0&&d>c&&(d=c),d}class Uu{constructor(o,c,p){this.type=o,this.key=c,this.scope=p}static parse(o,c){let p=c.expectedType;if(p==null&&(p=ai),o.length<2||o.length>3)return c.error("Invalid number of arguments for 'config' expression.");const v=c.parse(o[1],1);if(!(v instanceof ka))return c.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const m=c.parse(o[2],2);return m instanceof ka?new Uu(p,Ra(v.value),Ra(m.value)):c.error("Scope of 'config' expression must be a string literal.")}return new Uu(p,Ra(v.value))}evaluate(o){const c=[this.key,this.scope,o.scope].filter(Boolean).join(""),p=o.getConfig(c);if(!p)return null;const{type:v,value:m,values:x,minValue:M,maxValue:j,stepValue:F}=p,E=p.default.evaluate(o);let N=E;if(m){const L=o.scope;o.scope=(L||"").split("").slice(1).join(""),N=m.evaluate(o),o.scope=L}return v&&(N=Vu(v,N)),N===void 0||M===void 0&&j===void 0&&F===void 0||(typeof N=="number"?N=mp(N,M,j,F):Array.isArray(N)&&(N=N.map(L=>typeof L=="number"?mp(L,M,j,F):L))),m!==void 0&&N!==void 0&&x&&!x.includes(N)&&(N=E,v&&(N=Vu(v,N))),(v&&v!==this.type||N!==void 0&&na(N)!==this.type)&&(N=Vu(this.type.kind,N)),N}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function Jc(d){if(d instanceof _s&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Gr||d instanceof vc)return!1;let o=!0;return d.eachChild(c=>{o&&!Jc(c)&&(o=!1)}),o}function _c(d){if(d instanceof _s&&d.name==="feature-state")return!1;let o=!0;return d.eachChild(c=>{o&&!_c(c)&&(o=!1)}),o}function Ld(d){if(d instanceof Uu)return new Set([d.key]);let o=new Set;return d.eachChild(c=>{o=new Set([...o,...Ld(c)])}),o}function $u(d,o){if(d instanceof _s&&o.indexOf(d.name)>=0)return!1;let c=!0;return d.eachChild(p=>{c&&!$u(p,o)&&(c=!1)}),c}class xc{constructor(o,c){this.type=c.type,this.name=o,this.boundExpression=c}static parse(o,c){if(o.length!==2||typeof o[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");const p=o[1];return c.scope.has(p)?new xc(p,c.scope.get(p)):c.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class zd{constructor(o,c=[],p,v=new Am,m=[],x,M){this.registry=o,this.path=c,this.key=c.map(j=>typeof j=="string"?`['${j}']`:`[${j}]`).join(""),this.scope=v,this.errors=m,this.expectedType=p,this._scope=x,this.options=M}parse(o,c,p,v,m={}){return c||p?this.concat(c,null,p,v)._parse(o,m):this._parse(o,m)}parseObjectValue(o,c,p,v,m,x={}){return this.concat(c,p,v,m)._parse(o,x)}_parse(o,c){function p(v,m,x){return x==="assert"?new Gl(m,[v]):x==="coerce"?new gc(m,[v]):v}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=typeof o[0]=="string"?this.registry[o[0]]:void 0;if(v){let m=v.parse(o,this);if(!m)return null;if(this.expectedType){const x=this.expectedType,M=m.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||M.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(x,M))return null}else m=p(m,x,c.typeAnnotation||"coerce");else m=p(m,x,c.typeAnnotation||"assert")}if(!(m instanceof ka)&&m.type.kind!=="resolvedImage"&&gp(m)){const x=new ly(this._scope,this.options);try{m=new ka(m.type,m.evaluate(x))}catch(M){return this.error(M.message),null}}return m}return gc.parse(["to-array",o],this)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,c,p,v){let m=typeof o=="number"?this.path.concat(o):this.path;m=typeof c=="string"?m.concat(c):m;const x=v?this.scope.concat(v):this.scope;return new zd(this.registry,m,p||null,x,this.errors,this._scope,this.options)}error(o,...c){const p=`${this.key}${c.map(v=>`[${v}]`).join("")}`;this.errors.push(new dn(p,o))}checkSubtype(o,c){const p=qo(o,c);return p&&this.error(p),p}}var rf=zd;function gp(d){if(d instanceof xc)return gp(d.boundExpression);if(d instanceof _s&&d.name==="error"||d instanceof Tm||d instanceof Gr||d instanceof vc||d instanceof Uu)return!1;const o=d instanceof gc||d instanceof Gl;let c=!0;return d.eachChild(p=>{c=o?c&&gp(p):c&&p instanceof ka}),!!c&&Jc(d)&&$u(d,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function nf(d,o){const c=d.length-1;let p,v,m=0,x=c,M=0;for(;m<=x;)if(M=Math.floor((m+x)/2),p=d[M],v=d[M+1],p<=o){if(M===c||o<v)return M;m=M+1}else{if(!(p>o))throw new ma("Input is not a number.");x=M-1}return 0}class Fd{constructor(o,c,p){this.type=o,this.input=c,this.labels=[],this.outputs=[];for(const[v,m]of p)this.labels.push(v),this.outputs.push(m)}static parse(o,c){if(o.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return c.error("Expected an even number of arguments.");const p=c.parse(o[1],1,_r);if(!p)return null;const v=[];let m=null;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);for(let x=1;x<o.length;x+=2){const M=x===1?-1/0:o[x],j=o[x+1],F=x,E=x+1;if(typeof M!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(v.length&&v[v.length-1][0]>=M)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const N=c.parse(j,E,m);if(!N)return null;m=m||N.type,v.push([M,N])}return new Fd(m,p,v)}evaluate(o){const c=this.labels,p=this.outputs;if(c.length===1)return p[0].evaluate(o);const v=this.input.evaluate(o);if(v<=c[0])return p[0].evaluate(o);const m=c.length;return v>=c[m-1]?p[m-1].evaluate(o):p[nf(c,v)].evaluate(o)}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let c=0;c<this.labels.length;c++)c>0&&o.push(this.labels[c]),o.push(this.outputs[c].serialize());return o}}const qu=.95047,bn=1.08883,km=4/29,Gu=6/29,o_=3*Gu*Gu,s_=Gu*Gu*Gu,yp=Math.PI/180,zi=180/Math.PI;function jm(d){return d>s_?Math.pow(d,1/3):d/o_+km}function Nm(d){return d>Gu?d*d*d:o_*(d-km)}function ca(d){return 255*(d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055)}function vp(d){return(d/=255)<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function _p(d){const o=vp(d.r),c=vp(d.g),p=vp(d.b),v=jm((.4124564*o+.3575761*c+.1804375*p)/qu),m=jm((.2126729*o+.7151522*c+.072175*p)/1);return{l:116*m-16,a:500*(v-m),b:200*(m-jm((.0193339*o+.119192*c+.9503041*p)/bn)),alpha:d.a}}function af(d){let o=(d.l+16)/116,c=isNaN(d.a)?o:o+d.a/500,p=isNaN(d.b)?o:o-d.b/200;return o=1*Nm(o),c=qu*Nm(c),p=bn*Nm(p),new Jn(ca(3.2404542*c-1.5371385*o-.4985314*p),ca(-.969266*c+1.8760108*o+.041556*p),ca(.0556434*c-.2040259*o+1.0572252*p),d.alpha)}function l_(d,o,c){const p=o-d;return d+c*(p>180||p<-180?p-360*Math.round(p/360):p)}const Bd={forward:_p,reverse:af,interpolate:function(d,o,c){return{l:Dr(d.l,o.l,c),a:Dr(d.a,o.a,c),b:Dr(d.b,o.b,c),alpha:Dr(d.alpha,o.alpha,c)}}},Qc={forward:function(d){const{l:o,a:c,b:p}=_p(d),v=Math.atan2(p,c)*zi;return{h:v<0?v+360:v,c:Math.sqrt(c*c+p*p),l:o,alpha:d.a}},reverse:function(d){const o=d.h*yp,c=d.c;return af({l:d.l,a:Math.cos(o)*c,b:Math.sin(o)*c,alpha:d.alpha})},interpolate:function(d,o,c){return{h:l_(d.h,o.h,c),c:Dr(d.c,o.c,c),l:Dr(d.l,o.l,c),alpha:Dr(d.alpha,o.alpha,c)}}};var xp=Object.freeze({__proto__:null,hcl:Qc,lab:Bd});class Po{constructor(o,c,p,v,m,x){this.type=o,this.operator=c,this.interpolation=p,this.input=v,this.dynamicStops=m,this.labels=[],this.outputs=[];for(const[M,j]of x)this.labels.push(M),this.outputs.push(j)}static interpolationFactor(o,c,p,v){let m=0;if(o.name==="exponential")m=Im(c,o.base,p,v);else if(o.name==="linear")m=Im(c,1,p,v);else if(o.name==="cubic-bezier"){const x=o.controlPoints;m=new Jt(x[0],x[1],x[2],x[3]).solve(Im(c,1,p,v))}return m}static parse(o,c){let[p,v,m,...x]=o;if(!Array.isArray(v)||v.length===0)return c.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const F=v[1];if(typeof F!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:F}}else{if(v[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const F=v.slice(1);if(F.length!==4||F.some(E=>typeof E!="number"||E<0||E>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:F}}}if(o.length-1<3)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(m=c.parse(m,2,_r),!m)return null;const M=[];let j=null;if(p==="interpolate-hcl"||p==="interpolate-lab"?j=fo:c.expectedType&&c.expectedType.kind!=="value"&&(j=c.expectedType),o.length-1==3){const F=c.parse(x[0],3,ai);return F?new Po(j,p,v,m,F,M):null}for(let F=0;F<x.length;F+=2){const E=x[F],N=x[F+1],L=F+3,k=F+4;if(typeof E!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(M.length&&M[M.length-1][0]>=E)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const I=c.parse(N,k,j);if(!I)return null;j=j||I.type,M.push([E,I])}return j.kind==="number"||j.kind==="color"||j.kind==="array"&&j.itemType.kind==="number"&&typeof j.N=="number"?new Po(j,p,v,m,null,M):c.error(`Type ${pa(j)} is not interpolatable.`)}evaluate(o){let c=this.labels,p=this.outputs;if(this.dynamicStops){const E=this.dynamicStops.evaluate(o);if(E.length%2!=0)throw new ma("Expected an even number of arguments.");c=[],p=[];for(let N=0;N<E.length;N+=2){const L=E[N],k=new ka(_r,E[N+1]);if(typeof L!="number")throw new ma('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(c.length&&c[c.length-1]>=L)throw new ma('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');c.push(L),p.push(k)}if(c.length===0)throw new ma("Expected at least one input/output pair.")}if(c.length===1)return p[0].evaluate(o);const v=this.input.evaluate(o);if(v<=c[0])return p[0].evaluate(o);const m=c.length;if(v>=c[m-1])return p[m-1].evaluate(o);const x=nf(c,v),M=Po.interpolationFactor(this.interpolation,v,c[x],c[x+1]),j=p[x].evaluate(o),F=p[x+1].evaluate(o);return this.operator==="interpolate"?Iu[this.type.kind.toLowerCase()](j,F,M):this.operator==="interpolate-hcl"?Qc.reverse(Qc.interpolate(Qc.forward(j),Qc.forward(F),M)):Bd.reverse(Bd.interpolate(Bd.forward(j),Bd.forward(F),M))}eachChild(o){o(this.input);for(const c of this.outputs)o(c)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const c=[this.operator,o,this.input.serialize()];if(this.dynamicStops)c.push(this.dynamicStops.serialize());else for(let p=0;p<this.labels.length;p++)c.push(this.labels[p],this.outputs[p].serialize());return c}}function Im(d,o,c,p){const v=p-c,m=d-c;return v===0?0:o===1?m/v:(Math.pow(o,m)-1)/(Math.pow(o,v)-1)}class Dm{constructor(o,c){this.type=o,this.args=c}static parse(o,c){if(o.length<2)return c.error("Expectected at least one argument.");let p=null;const v=c.expectedType;v&&v.kind!=="value"&&(p=v);const m=[];for(const M of o.slice(1)){const j=c.parse(M,1+m.length,p,void 0,{typeAnnotation:"omit"});if(!j)return null;p=p||j.type,m.push(j)}const x=v&&m.some(M=>qo(v,M.type));return new Dm(x?ai:p,m)}evaluate(o){let c,p=null,v=0;for(const m of this.args){if(v++,p=m.evaluate(o),p&&p instanceof To&&!p.available&&(c||(c=p),p=null,v===this.args.length))return c;if(p!==null)break}return p}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(c=>{o.push(c.serialize())}),o}}class Lm{constructor(o,c){this.type=c.type,this.bindings=[].concat(o),this.result=c}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const c of this.bindings)o(c[1]);o(this.result)}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const p=[];for(let m=1;m<o.length-1;m+=2){const x=o[m];if(typeof x!="string")return c.error(`Expected string, but found ${typeof x} instead.`,m);if(/[^a-zA-Z0-9_]/.test(x))return c.error("Variable names must contain only alphanumeric characters or '_'.",m);const M=c.parse(o[m+1],m+1);if(!M)return null;p.push([x,M])}const v=c.parse(o[o.length-1],o.length-1,c.expectedType,p);return v?new Lm(p,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[c,p]of this.bindings)o.push(c,p.serialize());return o.push(this.result.serialize()),o}}class zm{constructor(o,c,p){this.type=o,this.index=c,this.input=p}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const p=c.parse(o[1],1,_r),v=c.parse(o[2],2,Ka(c.expectedType||ai));return p&&v?new zm(v.type.itemType,p,v):null}evaluate(o){const c=this.index.evaluate(o),p=this.input.evaluate(o);if(c<0)throw new ma(`Array index out of bounds: ${c} < 0.`);if(c>p.length-1)throw new ma(`Array index out of bounds: ${c} > ${p.length-1}.`);if(c===Math.floor(c))return p[c];const v=Math.floor(c),m=Math.ceil(c),x=p[v],M=p[m];if(typeof x!="number"||typeof M!="number")throw new ma(`Cannot interpolate between non-number values at index ${c}.`);const j=c-v;return x*(1-j)+M*j}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class of{constructor(o,c){this.type=Wn,this.needle=o,this.haystack=c}static parse(o,c){if(o.length!==3)return c.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const p=c.parse(o[1],1,ai),v=c.parse(o[2],2,ai);return p&&v?Rd(p.type,[Wn,pi,_r,Lu,ai])?new of(p,v):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${pa(p.type)} instead`):null}evaluate(o){const c=this.needle.evaluate(o),p=this.haystack.evaluate(o);if(p==null)return!1;if(!kd(c,["boolean","string","number","null"]))throw new ma(`Expected first argument to be of type boolean, string, number or null, but found ${pa(na(c))} instead.`);if(!kd(p,["string","array"]))throw new ma(`Expected second argument to be of type array or string, but found ${pa(na(p))} instead.`);return p.indexOf(c)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Vd{constructor(o,c,p){this.type=_r,this.needle=o,this.haystack=c,this.fromIndex=p}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const p=c.parse(o[1],1,ai),v=c.parse(o[2],2,ai);if(!p||!v)return null;if(!Rd(p.type,[Wn,pi,_r,Lu,ai]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${pa(p.type)} instead`);if(o.length===4){const m=c.parse(o[3],3,_r);return m?new Vd(p,v,m):null}return new Vd(p,v)}evaluate(o){const c=this.needle.evaluate(o),p=this.haystack.evaluate(o);if(!kd(c,["boolean","string","number","null"]))throw new ma(`Expected first argument to be of type boolean, string, number or null, but found ${pa(na(c))} instead.`);if(!kd(p,["string","array"]))throw new ma(`Expected second argument to be of type array or string, but found ${pa(na(p))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(o);return p.indexOf(c,v)}return p.indexOf(c)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class bp{constructor(o,c,p,v,m,x){this.inputType=o,this.type=c,this.input=p,this.cases=v,this.outputs=m,this.otherwise=x}static parse(o,c){if(o.length<5)return c.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return c.error("Expected an even number of arguments.");let p,v;c.expectedType&&c.expectedType.kind!=="value"&&(v=c.expectedType);const m={},x=[];for(let F=2;F<o.length-1;F+=2){let E=o[F];const N=o[F+1];Array.isArray(E)||(E=[E]);const L=c.concat(F);if(E.length===0)return L.error("Expected at least one branch label.");for(const I of E){if(typeof I!="number"&&typeof I!="string")return L.error("Branch labels must be numbers or strings.");if(typeof I=="number"&&Math.abs(I)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof I=="number"&&Math.floor(I)!==I)return L.error("Numeric branch labels must be integer values.");if(p){if(L.checkSubtype(p,na(I)))return null}else p=na(I);if(m[String(I)]!==void 0)return L.error("Branch labels must be unique.");m[String(I)]=x.length}const k=c.parse(N,F,v);if(!k)return null;v=v||k.type,x.push(k)}const M=c.parse(o[1],1,ai);if(!M)return null;const j=c.parse(o[o.length-1],o.length-1,v);return j?M.type.kind!=="value"&&c.concat(1).checkSubtype(p,M.type)?null:new bp(p,v,M,m,x,j):null}evaluate(o){const c=this.input.evaluate(o);return(na(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],c=Object.keys(this.cases).sort(),p=[],v={};for(const x of c){const M=v[this.cases[x]];M===void 0?(v[this.cases[x]]=p.length,p.push([this.cases[x],[x]])):p[M][1].push(x)}const m=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,M]of p)o.push(M.length===1?m(M[0]):M.map(m)),o.push(this.outputs[x].serialize());return o.push(this.otherwise.serialize()),o}}class wp{constructor(o,c,p){this.type=o,this.branches=c,this.otherwise=p}static parse(o,c){if(o.length<4)return c.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return c.error("Expected an odd number of arguments.");let p;c.expectedType&&c.expectedType.kind!=="value"&&(p=c.expectedType);const v=[];for(let x=1;x<o.length-1;x+=2){const M=c.parse(o[x],x,Wn);if(!M)return null;const j=c.parse(o[x+1],x+1,p);if(!j)return null;v.push([M,j]),p=p||j.type}const m=c.parse(o[o.length-1],o.length-1,p);return m?new wp(p,v,m):null}evaluate(o){for(const[c,p]of this.branches)if(c.evaluate(o))return p.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[c,p]of this.branches)o(c),o(p);o(this.otherwise)}outputDefined(){return this.branches.every(([o,c])=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(c=>{o.push(c.serialize())}),o}}class sf{constructor(o,c,p,v){this.type=o,this.input=c,this.beginIndex=p,this.endIndex=v}static parse(o,c){if(o.length<=2||o.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const p=c.parse(o[1],1,ai),v=c.parse(o[2],2,_r);if(!p||!v)return null;if(!Rd(p.type,[Ka(ai),pi,ai]))return c.error(`Expected first argument to be of type array or string, but found ${pa(p.type)} instead`);if(o.length===4){const m=c.parse(o[3],3,_r);return m?new sf(p.type,p,v,m):null}return new sf(p.type,p,v)}evaluate(o){const c=this.input.evaluate(o),p=this.beginIndex.evaluate(o);if(!kd(c,["string","array"]))throw new ma(`Expected first argument to be of type array or string, but found ${pa(na(c))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(o);return c.slice(p,v)}return c.slice(p)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Fm(d,o){return d==="=="||d==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function c_(d,o,c,p){return p.compare(o,c)===0}function Ud(d,o,c){const p=d!=="=="&&d!=="!=";return class die{constructor(m,x,M){this.type=Wn,this.lhs=m,this.rhs=x,this.collator=M,this.hasUntypedArgument=m.type.kind==="value"||x.type.kind==="value"}static parse(m,x){if(m.length!==3&&m.length!==4)return x.error("Expected two or three arguments.");const M=m[0];let j=x.parse(m[1],1,ai);if(!j)return null;if(!Fm(M,j.type))return x.concat(1).error(`"${M}" comparisons are not supported for type '${pa(j.type)}'.`);let F=x.parse(m[2],2,ai);if(!F)return null;if(!Fm(M,F.type))return x.concat(2).error(`"${M}" comparisons are not supported for type '${pa(F.type)}'.`);if(j.type.kind!==F.type.kind&&j.type.kind!=="value"&&F.type.kind!=="value")return x.error(`Cannot compare types '${pa(j.type)}' and '${pa(F.type)}'.`);p&&(j.type.kind==="value"&&F.type.kind!=="value"?j=new Gl(F.type,[j]):j.type.kind!=="value"&&F.type.kind==="value"&&(F=new Gl(j.type,[F])));let E=null;if(m.length===4){if(j.type.kind!=="string"&&F.type.kind!=="string"&&j.type.kind!=="value"&&F.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(E=x.parse(m[3],3,Kc),!E)return null}return new die(j,F,E)}evaluate(m){const x=this.lhs.evaluate(m),M=this.rhs.evaluate(m);if(p&&this.hasUntypedArgument){const j=na(x),F=na(M);if(j.kind!==F.kind||j.kind!=="string"&&j.kind!=="number")throw new ma(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${j.kind}, ${F.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const j=na(x),F=na(M);if(j.kind!=="string"||F.kind!=="string")return o(m,x,M)}return this.collator?c(m,x,M,this.collator.evaluate(m)):o(m,x,M)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[d];return this.eachChild(x=>{m.push(x.serialize())}),m}}}const G0=Ud("==",function(d,o,c){return o===c},c_),K0=Ud("!=",function(d,o,c){return o!==c},function(d,o,c,p){return!c_(0,o,c,p)}),yy=Ud("<",function(d,o,c){return o<c},function(d,o,c,p){return p.compare(o,c)<0}),Ku=Ud(">",function(d,o,c){return o>c},function(d,o,c,p){return p.compare(o,c)>0}),u_=Ud("<=",function(d,o,c){return o<=c},function(d,o,c,p){return p.compare(o,c)<=0}),lf=Ud(">=",function(d,o,c){return o>=c},function(d,o,c,p){return p.compare(o,c)>=0});class Tl{constructor(o,c,p,v,m,x){this.type=pi,this.number=o,this.locale=c,this.currency=p,this.unit=v,this.minFractionDigits=m,this.maxFractionDigits=x}static parse(o,c){if(o.length!==3)return c.error("Expected two arguments.");const p=c.parse(o[1],1,_r);if(!p)return null;const v=o[2];if(typeof v!="object"||Array.isArray(v))return c.error("NumberFormat options argument must be an object.");let m=null;if(v.locale&&(m=c.parseObjectValue(v.locale,2,"locale",pi),!m))return null;let x=null;if(v.currency&&(x=c.parseObjectValue(v.currency,2,"currency",pi),!x))return null;let M=null;if(v.unit&&(M=c.parseObjectValue(v.unit,2,"unit",pi),!M))return null;let j=null;if(v["min-fraction-digits"]&&(j=c.parseObjectValue(v["min-fraction-digits"],2,"min-fraction-digits",_r),!j))return null;let F=null;return v["max-fraction-digits"]&&(F=c.parseObjectValue(v["max-fraction-digits"],2,"max-fraction-digits",_r),!F)?null:new Tl(p,m,x,M,j,F)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class $d{constructor(o){this.type=_r,this.input=o}static parse(o,c){if(o.length!==2)return c.error(`Expected 1 argument, but found ${o.length-1} instead.`);const p=c.parse(o[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${pa(p.type)} instead.`):new $d(p):null}evaluate(o){const c=this.input.evaluate(o);if(typeof c=="string"||Array.isArray(c))return c.length;throw new ma(`Expected value to be of type string or array, but found ${pa(na(c))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(c=>{o.push(c.serialize())}),o}}function Pl(d){return function(){d=1831565813+(d|=0)|0;let o=Math.imul(d^d>>>15,1|d);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const Wu={"==":G0,"!=":K0,">":Ku,"<":yy,">=":lf,"<=":u_,array:Gl,at:zm,boolean:Gl,case:wp,coalesce:Dm,collator:Tm,format:Hc,image:jd,in:of,"index-of":Vd,interpolate:Po,"interpolate-hcl":Po,"interpolate-lab":Po,length:$d,let:Lm,literal:ka,match:bp,number:Gl,"number-format":Tl,object:Gl,slice:sf,step:Fd,string:Gl,"to-boolean":gc,"to-color":gc,"to-number":gc,"to-string":gc,var:xc,within:Gr,distance:vc,config:Uu};function vy(d,[o,c,p,v]){o=o.evaluate(d),c=c.evaluate(d),p=p.evaluate(d);const m=v?v.evaluate(d):1,x=Zh(o,c,p,m);if(x)throw new ma(x);return new Jn(o/255*m,c/255*m,p/255*m,m)}function d_(d,[o,c,p,v]){o=o.evaluate(d),c=c.evaluate(d),p=p.evaluate(d);const m=v?v.evaluate(d):1,x=function(F,E,N,L){return typeof F=="number"&&F>=0&&F<=360?typeof E=="number"&&E>=0&&E<=100&&typeof N=="number"&&N>=0&&N<=100?L===void 0||typeof L=="number"&&L>=0&&L<=1?null:`Invalid hsla value [${[F,E,N,L].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof L=="number"?[F,E,N,L]:[F,E,N]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof L=="number"?[F,E,N,L]:[F,E,N]).join(", ")}]: 'h' must be between 0 and 360.`}(o,c,p,m);if(x)throw new ma(x);const M=`hsla(${o}, ${c}%, ${p}%, ${m})`,j=Jn.parse(M);if(!j)throw new ma(`Failed to parse HSLA color: ${M}`);return j}function Hu(d,o){return d in o}function qd(d,o){const c=o[d];return c===void 0?null:c}function ll(d){return{type:d}}function cf(d){return{result:"success",value:d}}function xs(d){return{result:"error",value:d}}function eu(d,o){return!!d&&!!d.parameters&&d.parameters.indexOf(o)>-1}function El(d){return d["property-type"]==="data-driven"}function ga(d){return eu(d.expression,"measure-light")}function Ji(d){return eu(d.expression,"zoom")}function Cl(d){return!!d.expression&&d.expression.interpolated}function Do(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}function Bs(d){return d}function tu(d,o){const c=o.type==="color",p=d.stops&&typeof d.stops[0][0]=="object",v=p||!(p||d.property!==void 0),m=d.type||(Cl(o)?"exponential":"interval");if(c&&((d=Du({},d)).stops&&(d.stops=d.stops.map(F=>[F[0],Jn.parse(F[1])])),d.default=Jn.parse(d.default?d.default:o.default)),d.colorSpace&&d.colorSpace!=="rgb"&&!xp[d.colorSpace])throw new Error(`Unknown color space: ${d.colorSpace}`);let x,M,j;if(m==="exponential")x=_y;else if(m==="interval")x=Bm;else if(m==="categorical"){x=Vs,M=Object.create(null);for(const F of d.stops)M[F[0]]=F[1];j=typeof d.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);x=xy}if(p){const F={},E=[];for(let k=0;k<d.stops.length;k++){const I=d.stops[k],$=I[0].zoom;F[$]===void 0&&(F[$]={zoom:$,type:d.type,property:d.property,default:d.default,stops:[]},E.push($)),F[$].stops.push([I[0].value,I[1]])}const N=[];for(const k of E)N.push([F[k].zoom,tu(F[k],o)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:Po.interpolationFactor.bind(void 0,L),zoomStops:N.map(k=>k[0]),evaluate:({zoom:k},I)=>_y({stops:N,base:d.base},o,k).evaluate(k,I)}}if(v){const F=m==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Po.interpolationFactor.bind(void 0,F),zoomStops:d.stops.map(E=>E[0]),evaluate:({zoom:E})=>x(d,o,E,M,j)}}return{kind:"source",evaluate(F,E){const N=E&&E.properties?E.properties[d.property]:void 0;return N===void 0?Wl(d.default,o.default):x(d,o,N,M,j)}}}function Wl(d,o,c){return d!==void 0?d:o!==void 0?o:c!==void 0?c:void 0}function Vs(d,o,c,p,v){return Wl(typeof c===v?p[c]:void 0,d.default,o.default)}function Bm(d,o,c){if(vs(c)!=="number")return Wl(d.default,o.default);const p=d.stops.length;if(p===1||c<=d.stops[0][0])return d.stops[0][1];if(c>=d.stops[p-1][0])return d.stops[p-1][1];const v=nf(d.stops.map(m=>m[0]),c);return d.stops[v][1]}function _y(d,o,c){const p=d.base!==void 0?d.base:1;if(vs(c)!=="number")return Wl(d.default,o.default);const v=d.stops.length;if(v===1||c<=d.stops[0][0])return d.stops[0][1];if(c>=d.stops[v-1][0])return d.stops[v-1][1];const m=nf(d.stops.map(E=>E[0]),c),x=function(E,N,L,k){const I=k-L,$=E-L;return I===0?0:N===1?$/I:(Math.pow(N,$)-1)/(Math.pow(N,I)-1)}(c,p,d.stops[m][0],d.stops[m+1][0]),M=d.stops[m][1],j=d.stops[m+1][1];let F=Iu[o.type]||Bs;if(d.colorSpace&&d.colorSpace!=="rgb"){const E=xp[d.colorSpace];F=(N,L)=>E.reverse(E.interpolate(E.forward(N),E.forward(L),x))}return typeof M.evaluate=="function"?{evaluate(...E){const N=M.evaluate.apply(void 0,E),L=j.evaluate.apply(void 0,E);if(N!==void 0&&L!==void 0)return F(N,L,x)}}:F(M,j,x)}function xy(d,o,c){return o.type==="color"?c=Jn.parse(c):o.type==="formatted"?c=Ao.fromString(c.toString()):o.type==="resolvedImage"?c=To.build(c.toString()):vs(c)===o.type||o.type==="enum"&&o.values[c]||(c=void 0),Wl(c,d.default,o.default)}_s.register(Wu,{error:[{kind:"error"},[pi],(d,[o])=>{throw new ma(o.evaluate(d))}],typeof:[pi,[ai],(d,[o])=>pa(na(o.evaluate(d)))],"to-rgba":[Ka(_r,4),[fo],(d,[o])=>o.evaluate(d).toRenderColor(null).toArray()],"to-hsla":[Ka(_r,4),[fo],(d,[o])=>o.evaluate(d).toRenderColor(null).toHslaArray()],rgb:[fo,[_r,_r,_r],vy],rgba:[fo,[_r,_r,_r,_r],vy],hsl:[fo,[_r,_r,_r],d_],hsla:[fo,[_r,_r,_r,_r],d_],has:{type:Wn,overloads:[[[pi],(d,[o])=>Hu(o.evaluate(d),d.properties())],[[pi,pc],(d,[o,c])=>Hu(o.evaluate(d),c.evaluate(d))]]},get:{type:ai,overloads:[[[pi],(d,[o])=>qd(o.evaluate(d),d.properties())],[[pi,pc],(d,[o,c])=>qd(o.evaluate(d),c.evaluate(d))]]},"feature-state":[ai,[pi],(d,[o])=>qd(o.evaluate(d),d.featureState||{})],properties:[pc,[],d=>d.properties()],"geometry-type":[pi,[],d=>d.geometryType()],id:[ai,[],d=>d.id()],zoom:[_r,[],d=>d.globals.zoom],pitch:[_r,[],d=>d.globals.pitch||0],"distance-from-center":[_r,[],d=>d.distanceFromCenter()],"measure-light":[_r,[pi],(d,[o])=>d.measureLight(o.evaluate(d))],"heatmap-density":[_r,[],d=>d.globals.heatmapDensity||0],"line-progress":[_r,[],d=>d.globals.lineProgress||0],"raster-value":[_r,[],d=>d.globals.rasterValue||0],"raster-particle-speed":[_r,[],d=>d.globals.rasterParticleSpeed||0],"sky-radial-progress":[_r,[],d=>d.globals.skyRadialProgress||0],accumulated:[ai,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[_r,ll(_r),(d,o)=>{let c=0;for(const p of o)c+=p.evaluate(d);return c}],"*":[_r,ll(_r),(d,o)=>{let c=1;for(const p of o)c*=p.evaluate(d);return c}],"-":{type:_r,overloads:[[[_r,_r],(d,[o,c])=>o.evaluate(d)-c.evaluate(d)],[[_r],(d,[o])=>-o.evaluate(d)]]},"/":[_r,[_r,_r],(d,[o,c])=>o.evaluate(d)/c.evaluate(d)],"%":[_r,[_r,_r],(d,[o,c])=>o.evaluate(d)%c.evaluate(d)],ln2:[_r,[],()=>Math.LN2],pi:[_r,[],()=>Math.PI],e:[_r,[],()=>Math.E],"^":[_r,[_r,_r],(d,[o,c])=>Math.pow(o.evaluate(d),c.evaluate(d))],sqrt:[_r,[_r],(d,[o])=>Math.sqrt(o.evaluate(d))],log10:[_r,[_r],(d,[o])=>Math.log(o.evaluate(d))/Math.LN10],ln:[_r,[_r],(d,[o])=>Math.log(o.evaluate(d))],log2:[_r,[_r],(d,[o])=>Math.log(o.evaluate(d))/Math.LN2],sin:[_r,[_r],(d,[o])=>Math.sin(o.evaluate(d))],cos:[_r,[_r],(d,[o])=>Math.cos(o.evaluate(d))],tan:[_r,[_r],(d,[o])=>Math.tan(o.evaluate(d))],asin:[_r,[_r],(d,[o])=>Math.asin(o.evaluate(d))],acos:[_r,[_r],(d,[o])=>Math.acos(o.evaluate(d))],atan:[_r,[_r],(d,[o])=>Math.atan(o.evaluate(d))],min:[_r,ll(_r),(d,o)=>Math.min(...o.map(c=>c.evaluate(d)))],max:[_r,ll(_r),(d,o)=>Math.max(...o.map(c=>c.evaluate(d)))],abs:[_r,[_r],(d,[o])=>Math.abs(o.evaluate(d))],round:[_r,[_r],(d,[o])=>{const c=o.evaluate(d);return c<0?-Math.round(-c):Math.round(c)}],floor:[_r,[_r],(d,[o])=>Math.floor(o.evaluate(d))],ceil:[_r,[_r],(d,[o])=>Math.ceil(o.evaluate(d))],"filter-==":[Wn,[pi,ai],(d,[o,c])=>d.properties()[o.value]===c.value],"filter-id-==":[Wn,[ai],(d,[o])=>d.id()===o.value],"filter-type-==":[Wn,[pi],(d,[o])=>d.geometryType()===o.value],"filter-<":[Wn,[pi,ai],(d,[o,c])=>{const p=d.properties()[o.value],v=c.value;return typeof p==typeof v&&p<v}],"filter-id-<":[Wn,[ai],(d,[o])=>{const c=d.id(),p=o.value;return typeof c==typeof p&&c<p}],"filter->":[Wn,[pi,ai],(d,[o,c])=>{const p=d.properties()[o.value],v=c.value;return typeof p==typeof v&&p>v}],"filter-id->":[Wn,[ai],(d,[o])=>{const c=d.id(),p=o.value;return typeof c==typeof p&&c>p}],"filter-<=":[Wn,[pi,ai],(d,[o,c])=>{const p=d.properties()[o.value],v=c.value;return typeof p==typeof v&&p<=v}],"filter-id-<=":[Wn,[ai],(d,[o])=>{const c=d.id(),p=o.value;return typeof c==typeof p&&c<=p}],"filter->=":[Wn,[pi,ai],(d,[o,c])=>{const p=d.properties()[o.value],v=c.value;return typeof p==typeof v&&p>=v}],"filter-id->=":[Wn,[ai],(d,[o])=>{const c=d.id(),p=o.value;return typeof c==typeof p&&c>=p}],"filter-has":[Wn,[ai],(d,[o])=>o.value in d.properties()],"filter-has-id":[Wn,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Wn,[Ka(pi)],(d,[o])=>o.value.indexOf(d.geometryType())>=0],"filter-id-in":[Wn,[Ka(ai)],(d,[o])=>o.value.indexOf(d.id())>=0],"filter-in-small":[Wn,[pi,Ka(ai)],(d,[o,c])=>c.value.indexOf(d.properties()[o.value])>=0],"filter-in-large":[Wn,[pi,Ka(ai)],(d,[o,c])=>function(p,v,m,x){for(;m<=x;){const M=m+x>>1;if(v[M]===p)return!0;v[M]>p?x=M-1:m=M+1}return!1}(d.properties()[o.value],c.value,0,c.value.length-1)],all:{type:Wn,overloads:[[[Wn,Wn],(d,[o,c])=>o.evaluate(d)&&c.evaluate(d)],[ll(Wn),(d,o)=>{for(const c of o)if(!c.evaluate(d))return!1;return!0}]]},any:{type:Wn,overloads:[[[Wn,Wn],(d,[o,c])=>o.evaluate(d)||c.evaluate(d)],[ll(Wn),(d,o)=>{for(const c of o)if(c.evaluate(d))return!0;return!1}]]},"!":[Wn,[Wn],(d,[o])=>!o.evaluate(d)],"is-supported-script":[Wn,[pi],(d,[o])=>{const c=d.globals&&d.globals.isSupportedScript;return!c||c(o.evaluate(d))}],upcase:[pi,[pi],(d,[o])=>o.evaluate(d).toUpperCase()],downcase:[pi,[pi],(d,[o])=>o.evaluate(d).toLowerCase()],concat:[pi,ll(ai),(d,o)=>o.map(c=>Ra(c.evaluate(d))).join("")],"resolved-locale":[pi,[Kc],(d,[o])=>o.evaluate(d).resolvedLocale()],random:[_r,[_r,_r,ai],(d,o)=>{const[c,p,v]=o.map(x=>x.evaluate(d));if(c>p||c===p)return c;let m;if(typeof v=="string")m=function(x){let M=0;if(x.length===0)return M;for(let j=0;j<x.length;j++)M=(M<<5)-M+x.charCodeAt(j),M|=0;return M}(v);else{if(typeof v!="number")throw new ma(`Invalid seed input: ${v}`);m=v}return c+Pl(m)()*(p-c)}]});class Gd{constructor(o,c,p,v){this.expression=o,this._warningHistory={},this._evaluator=new ly(p,v),this._defaultValue=c?function(m){return m.type==="color"&&(Do(m.default)||Array.isArray(m.default))?new Jn(0,0,0,0):m.type==="color"?Jn.parse(m.default)||null:m.default===void 0?null:m.default}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this.configDependencies=Ld(o)}evaluateWithoutErrorHandling(o,c,p,v,m,x,M,j){return this._evaluator.globals=o,this._evaluator.feature=c,this._evaluator.featureState=p,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=j||null,this.expression.evaluate(this._evaluator)}evaluate(o,c,p,v,m,x,M,j){this._evaluator.globals=o,this._evaluator.feature=c||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=j||null;try{const F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new ma(`Expected value to be one of ${Object.keys(this._enumValues).map(E=>JSON.stringify(E)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${F.message}`)),this._defaultValue}}}function Kd(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in Wu}function Us(d,o,c,p){const v=new rf(Wu,[],o?function(x){const M={color:fo,string:pi,number:_r,enum:pi,boolean:Wn,formatted:zs,resolvedImage:mc};return x.type==="array"?Ka(M[x.value]||ai,x.length):M[x.type]}(o):void 0,void 0,void 0,c,p),m=v.parse(d,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?cf(new Gd(m,o,c,p)):xs(v.errors)}class Wd{constructor(o,c,p,v){this.kind=o,this._styleExpression=c,this.isLightConstant=p,this.isLineProgressConstant=v,this.isStateDependent=o!=="constant"&&!_c(c.expression),this.configDependencies=Ld(c.expression)}evaluateWithoutErrorHandling(o,c,p,v,m,x){return this._styleExpression.evaluateWithoutErrorHandling(o,c,p,v,m,x)}evaluate(o,c,p,v,m,x){return this._styleExpression.evaluate(o,c,p,v,m,x)}}class Hd{constructor(o,c,p,v,m,x){this.kind=o,this.zoomStops=p,this._styleExpression=c,this.isStateDependent=o!=="camera"&&!_c(c.expression),this.isLightConstant=m,this.isLineProgressConstant=x,this.configDependencies=Ld(c.expression),this.interpolationType=v}evaluateWithoutErrorHandling(o,c,p,v,m,x){return this._styleExpression.evaluateWithoutErrorHandling(o,c,p,v,m,x)}evaluate(o,c,p,v,m,x){return this._styleExpression.evaluate(o,c,p,v,m,x)}interpolationFactor(o,c,p){return this.interpolationType?Po.interpolationFactor(this.interpolationType,o,c,p):0}}function by(d,o,c,p){if((d=Us(d,o,c,p)).result==="error")return d;const v=d.value.expression,m=Jc(v);if(!m&&!El(o))return xs([new dn("","data expressions not supported")]);const x=$u(v,["zoom","pitch","distance-from-center"]);if(!x&&!Ji(o))return xs([new dn("","zoom expressions not supported")]);const M=$u(v,["measure-light"]);if(!M&&!ga(o))return xs([new dn("","measure-light expression not supported")]);const j=$u(v,["line-progress"]);if(!j&&!function(N){return eu(N.expression,"line-progress")}(o))return xs([new dn("","line-progress expression not supported")]);const F=o.expression&&o.expression.relaxZoomRestriction,E=Ml(v);return E||x||F?E instanceof dn?xs([E]):E instanceof Po&&!Cl(o)?xs([new dn("",'"interpolate" expressions cannot be used with this property')]):cf(E?new Hd(m&&j?"camera":"composite",d.value,E.labels,E instanceof Po?E.interpolation:void 0,M,j):new Wd(m&&j?"constant":"source",d.value,M,j)):xs([new dn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Sp{constructor(o,c){this._parameters=o,this._specification=c,Du(this,tu(this._parameters,this._specification))}static deserialize(o){return new Sp(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function Ml(d){let o=null;if(d instanceof Lm)o=Ml(d.result);else if(d instanceof Dm){for(const c of d.args)if(o=Ml(c),o)break}else(d instanceof Fd||d instanceof Po)&&d.input instanceof _s&&d.input.name==="zoom"&&(o=d);return o instanceof dn||d.eachChild(c=>{const p=Ml(c);p instanceof dn?o=p:o&&p&&o!==p&&(o=new dn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var Zu,Zd,Vm=function(){if(Zd)return Zu;Zd=1,Zu=o;var d=3;function o(c,p,v){var m=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var x=new Int32Array(this.arrayBuffer);c=x[0],this.d=(p=x[1])+2*(v=x[2]);for(var M=0;M<this.d*this.d;M++){var j=x[d+M],F=x[d+M+1];m.push(j===F?null:x.subarray(j,F))}var E=x[d+m.length+1];this.keys=x.subarray(x[d+m.length],E),this.bboxes=x.subarray(E),this.insert=this._insertReadonly}else{this.d=p+2*v;for(var N=0;N<this.d*this.d;N++)m.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=c,this.padding=v,this.scale=p/c,this.uid=0;var L=v/p*c;this.min=-L,this.max=c+L}return o.prototype.insert=function(c,p,v,m,x){this._forEachCell(p,v,m,x,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(m),this.bboxes.push(x)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(c,p,v,m,x,M){this.cells[x].push(M)},o.prototype.query=function(c,p,v,m,x){var M=this.min,j=this.max;if(c<=M&&p<=M&&j<=v&&j<=m&&!x)return Array.prototype.slice.call(this.keys);var F=[];return this._forEachCell(c,p,v,m,this._queryCell,F,{},x),F},o.prototype._queryCell=function(c,p,v,m,x,M,j,F){var E=this.cells[x];if(E!==null)for(var N=this.keys,L=this.bboxes,k=0;k<E.length;k++){var I=E[k];if(j[I]===void 0){var $=4*I;(F?F(L[$+0],L[$+1],L[$+2],L[$+3]):c<=L[$+2]&&p<=L[$+3]&&v>=L[$+0]&&m>=L[$+1])?(j[I]=!0,M.push(N[I])):j[I]=!1}}},o.prototype._forEachCell=function(c,p,v,m,x,M,j,F){for(var E=this._convertToCellCoord(c),N=this._convertToCellCoord(p),L=this._convertToCellCoord(v),k=this._convertToCellCoord(m),I=E;I<=L;I++)for(var $=N;$<=k;$++){var Y=this.d*$+I;if((!F||F(this._convertFromCellCoord(I),this._convertFromCellCoord($),this._convertFromCellCoord(I+1),this._convertFromCellCoord($+1)))&&x.call(this,c,p,v,m,Y,M,j,F))return}},o.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},o.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,p=d+this.cells.length+1+1,v=0,m=0;m<this.cells.length;m++)v+=this.cells[m].length;var x=new Int32Array(p+v+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var M=p,j=0;j<c.length;j++){var F=c[j];x[d+j]=M,x.set(F,M),M+=F.length}return x[d+c.length]=M,x.set(this.keys,M),x[d+c.length+1]=M+=this.keys.length,x.set(this.bboxes,M),M+=this.bboxes.length,x.buffer},Zu}(),bc=_(Vm);const bs={};function hr(d,o,c={}){Object.defineProperty(d,"_classRegistryKey",{value:o,writable:!1}),bs[o]={klass:d,omit:c.omit||[]}}hr(Object,"Object"),bc.serialize=function(d,o){const c=d.toArrayBuffer();return o&&o.add(c),{buffer:c}},bc.deserialize=function(d){return new bc(d.buffer)},Object.defineProperty(bc,"name",{value:"Grid"}),hr(bc,"Grid"),typeof DOMMatrix<"u"&&hr(DOMMatrix,"DOMMatrix"),hr(Jn,"Color"),hr(Error,"Error"),hr(Ao,"Formatted"),hr(wl,"FormattedSection"),hr(Oa,"AJAXError"),hr(To,"ResolvedImage"),hr(Sp,"StylePropertyFunction"),hr(Gd,"StyleExpression",{omit:["_evaluator"]}),hr(sl,"ImageIdWithOptions"),hr(Hd,"ZoomDependentExpression"),hr(Wd,"ZoomConstantExpression"),hr(_s,"CompoundExpression",{omit:["_evaluate"]});for(const d in Wu)bs[Wu[d]._classRegistryKey]||hr(Wu[d],`Expression${d}`);function ru(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function Hl(d){return self.ImageBitmap&&d instanceof ImageBitmap}function os(d,o){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(ru(d)||Hl(d))return o&&o.add(d),d;if(ArrayBuffer.isView(d))return o&&o.add(d.buffer),d;if(d instanceof ImageData)return o&&o.add(d.data.buffer),d;if(Array.isArray(d)){const c=[];for(const p of d)c.push(os(p,o));return c}if(d instanceof Map){const c={$name:"Map"};for(const[p,v]of d.entries())c[p]=os(v);return c}if(d instanceof Set){const c={$name:"Set"};let p=0;for(const v of d.values())c[++p]=os(v);return c}if(typeof d=="object"){const c=d.constructor,p=c._classRegistryKey;if(!p)throw new Error(`Can't serialize object of unregistered class "${p}".`);const v=c.serialize?c.serialize(d,o):{};if(!c.serialize){for(const m in d)d.hasOwnProperty(m)&&(bs[p].omit.indexOf(m)>=0||(v[m]=os(d[m],o)));d instanceof Error&&(v.message=d.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(v.$name=p),v}throw new Error("can't serialize object of type "+typeof d)}function cl(d){if(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||ru(d)||Hl(d)||ArrayBuffer.isView(d)||d instanceof ImageData)return d;if(Array.isArray(d))return d.map(cl);if(typeof d=="object"){const o=d.$name||"Object";if(o==="Map"){const v=new Map;for(const m of Object.keys(d))m!=="$name"&&v.set(m,cl(d[m]));return v}if(o==="Set"){const v=new Set;for(const m of Object.keys(d))m!=="$name"&&v.add(cl(d[m]));return v}const{klass:c}=bs[o];if(!c)throw new Error(`Can't deserialize unregistered class "${o}".`);if(c.deserialize)return c.deserialize(d);const p=Object.create(c.prototype);for(const v of Object.keys(d))v!=="$name"&&(p[v]=cl(d[v]));return p}throw new Error("can't deserialize object of type "+typeof d)}const Cr={"Latin-1 Supplement":d=>d>=128&&d<=255,Arabic:d=>d>=1536&&d<=1791,"Arabic Supplement":d=>d>=1872&&d<=1919,"Arabic Extended-A":d=>d>=2208&&d<=2303,"Hangul Jamo":d=>d>=4352&&d<=4607,"Unified Canadian Aboriginal Syllabics":d=>d>=5120&&d<=5759,Khmer:d=>d>=6016&&d<=6143,"Unified Canadian Aboriginal Syllabics Extended":d=>d>=6320&&d<=6399,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"CJK Radicals Supplement":d=>d>=11904&&d<=12031,"Kangxi Radicals":d=>d>=12032&&d<=12255,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Bopomofo:d=>d>=12544&&d<=12591,"Hangul Compatibility Jamo":d=>d>=12592&&d<=12687,Kanbun:d=>d>=12688&&d<=12703,"Bopomofo Extended":d=>d>=12704&&d<=12735,"CJK Strokes":d=>d>=12736&&d<=12783,"Katakana Phonetic Extensions":d=>d>=12784&&d<=12799,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"CJK Unified Ideographs Extension A":d=>d>=13312&&d<=19903,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Yi Syllables":d=>d>=40960&&d<=42127,"Yi Radicals":d=>d>=42128&&d<=42191,"Hangul Jamo Extended-A":d=>d>=43360&&d<=43391,"Hangul Syllables":d=>d>=44032&&d<=55215,"Hangul Jamo Extended-B":d=>d>=55216&&d<=55295,"Private Use Area":d=>d>=57344&&d<=63743,"CJK Compatibility Ideographs":d=>d>=63744&&d<=64255,"Arabic Presentation Forms-A":d=>d>=64336&&d<=65023,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Arabic Presentation Forms-B":d=>d>=65136&&d<=65279,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519,Osage:d=>d>=66736&&d<=66815,"CJK Unified Ideographs Extension B":d=>d>=131072&&d<=173791};function Ap(d){for(const o of d)if(ss(o.charCodeAt(0)))return!0;return!1}function wy(d){for(const o of d)if(!ul(o.charCodeAt(0)))return!1;return!0}function ul(d){return!(Cr.Arabic(d)||Cr["Arabic Supplement"](d)||Cr["Arabic Extended-A"](d)||Cr["Arabic Presentation Forms-A"](d)||Cr["Arabic Presentation Forms-B"](d))}function ss(d){return!(d!==746&&d!==747&&(d<4352||!(Cr["Bopomofo Extended"](d)||Cr.Bopomofo(d)||Cr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||Cr["CJK Compatibility Ideographs"](d)||Cr["CJK Compatibility"](d)||Cr["CJK Radicals Supplement"](d)||Cr["CJK Strokes"](d)||!(!Cr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||Cr["CJK Unified Ideographs Extension A"](d)||Cr["CJK Unified Ideographs"](d)||Cr["Enclosed CJK Letters and Months"](d)||Cr["Hangul Compatibility Jamo"](d)||Cr["Hangul Jamo Extended-A"](d)||Cr["Hangul Jamo Extended-B"](d)||Cr["Hangul Jamo"](d)||Cr["Hangul Syllables"](d)||Cr.Hiragana(d)||Cr["Ideographic Description Characters"](d)||Cr.Kanbun(d)||Cr["Kangxi Radicals"](d)||Cr["Katakana Phonetic Extensions"](d)||Cr.Katakana(d)&&d!==12540||!(!Cr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!Cr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||Cr["Unified Canadian Aboriginal Syllabics"](d)||Cr["Unified Canadian Aboriginal Syllabics Extended"](d)||Cr["Vertical Forms"](d)||Cr["Yijing Hexagram Symbols"](d)||Cr["Yi Syllables"](d)||Cr["Yi Radicals"](d))))}function ya(d){return!(ss(d)||function(o){return!!(Cr["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||Cr["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||Cr["Letterlike Symbols"](o)||Cr["Number Forms"](o)||Cr["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||Cr["Control Pictures"](o)&&o!==9251||Cr["Optical Character Recognition"](o)||Cr["Enclosed Alphanumerics"](o)||Cr["Geometric Shapes"](o)||Cr["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||Cr["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||Cr["CJK Symbols and Punctuation"](o)||Cr.Katakana(o)||Cr["Private Use Area"](o)||Cr["CJK Compatibility Forms"](o)||Cr["Small Form Variants"](o)||Cr["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(d))}function dl(d){return d>=1424&&d<=2303||Cr["Arabic Presentation Forms-A"](d)||Cr["Arabic Presentation Forms-B"](d)}function Sy(d,o){return!(!o&&dl(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||Cr.Khmer(d))}function Um(d){for(const o of d)if(dl(o.charCodeAt(0)))return!0;return!1}const Yd="deferred",uf="loading",$m="loaded";let hl=null,ws="unavailable",fl=null;const Tp=function(d){d&&typeof d=="string"&&d.indexOf("NetworkError")>-1&&(ws="error"),hl&&hl(d)};function Ay(){wc.fire(new yi("pluginStateChange",{pluginStatus:ws,pluginURL:fl}))}const wc=new qc,Xd=function(){return ws},df=function(){if(ws!==Yd||!fl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ws=uf,Ay(),fl&&to({url:fl},d=>{d?Tp(d):(ws=$m,Ay())})},$s={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ws===$m||$s.applyArabicShaping!=null,isLoading:()=>ws===uf,setState(d){ws=d.pluginStatus,fl=d.pluginURL},isParsed:()=>$s.applyArabicShaping!=null&&$s.processBidirectionalText!=null&&$s.processStyledBidirectionalText!=null,getPluginURL:()=>fl};class vi{constructor(o,c){this.zoom=o,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.transition=c.transition,this.pitch=c.pitch,this.brightness=c.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(c,p){for(const v of c)if(!Sy(v.charCodeAt(0),p))return!1;return!0}(o,$s.isLoaded())}}class Pp{constructor(o,c,p,v){this.property=o,this.value=c,this.expression=function(m,x,M,j){if(Do(m))return new Sp(m,x);if(Kd(m)||Array.isArray(m)&&m.length>0){const F=by(m,x,M,j);if(F.result==="error")throw new Error(F.value.map(E=>`${E.key}: ${E.message}`).join(", "));return F.value}{let F=m;return typeof m=="string"&&x.type==="color"&&(F=Jn.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>F}}}(c===void 0?o.specification.default:c,o.specification,p,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(o,c,p){return this.property.possiblyEvaluate(this,o,c,p)}}class Yu{constructor(o,c,p){this.property=o,this.value=new Pp(o,void 0,c,p)}transitioned(o,c){return new Xu(this.property,this.value,c,Vi({},o.transition,this.transition),o.now)}untransitioned(){return new Xu(this.property,this.value,null,{},0)}}class Jd{constructor(o,c,p){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=c,this._options=p,this.configDependencies=new Set}getValue(o){return jo(this._values[o].value.value)}setValue(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new Yu(this._values[o].property,this._scope,this._options)),this._values[o].value=new Pp(this._values[o].property,c===null?void 0:jo(c),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,c){c&&(this._options=c);const p=this._properties.properties;if(o)for(const v in o){const m=o[v];if(Qa(v,"-transition")){const x=v.slice(0,-11);p[x]&&this.setTransition(x,m)}else p.hasOwnProperty(v)&&this.setValue(v,m)}}getTransition(o){return jo(this._values[o].transition)}setTransition(o,c){this._values.hasOwnProperty(o)||(this._values[o]=new Yu(this._values[o].property)),this._values[o].transition=jo(c)||void 0}serialize(){const o={};for(const c of Object.keys(this._values)){const p=this.getValue(c);p!==void 0&&(o[c]=p);const v=this.getTransition(c);v!==void 0&&(o[`${c}-transition`]=v)}return o}transitioned(o,c){const p=new Qd(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(o,c._values[v]);return p}untransitioned(){const o=new Qd(this._properties);for(const c of Object.keys(this._values))o._values[c]=this._values[c].untransitioned();return o}}class Xu{constructor(o,c,p,v,m){const x=v.delay||0,M=v.duration||0;m=m||0,this.property=o,this.value=c,this.begin=m+x,this.end=this.begin+M,o.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(o,c,p){const v=o.now||0,m=this.value.possiblyEvaluate(o,c,p),x=this.prior;if(x){if(v>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(v<this.begin)return x.possiblyEvaluate(o,c,p);{const M=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(o,c,p),m,Pr(M))}}return m}}class Qd{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,c,p){const v=new ed(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(o,c,p);return v}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class Ju{constructor(o,c,p){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=c,this._options=p,this.configDependencies=new Set}getValue(o){return jo(this._values[o].value)}setValue(o,c){this._values[o]=new Pp(this._values[o].property,c===null?void 0:jo(c),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const c of Object.keys(this._values)){const p=this.getValue(c);p!==void 0&&(o[c]=p)}return o}possiblyEvaluate(o,c,p){const v=new ed(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(o,c,p);return v}}class Qu{constructor(o,c,p){this.property=o,this.value=c,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,c,p,v){return this.property.evaluate(this.value,this.parameters,o,c,p,v)}}class ed{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Yt{constructor(o){this.specification=o}possiblyEvaluate(o,c){return o.expression.evaluate(c)}interpolate(o,c,p){const v=Iu[this.specification.type];return v?v(o,c,p):o}}class or{constructor(o,c){this.specification=o,this.overrides=c}possiblyEvaluate(o,c,p,v){return new Qu(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(c,null,{},p,v)}:o.expression,c)}interpolate(o,c,p){if(o.value.kind!=="constant"||c.value.kind!=="constant")return o;if(o.value.value===void 0||c.value.value===void 0)return new Qu(this,{kind:"constant",value:void 0},o.parameters);const v=Iu[this.specification.type];return v?new Qu(this,{kind:"constant",value:v(o.value.value,c.value.value,p)},o.parameters):o}evaluate(o,c,p,v,m,x){return o.kind==="constant"?o.value:o.evaluate(c,p,v,m,x)}}class Ol{constructor(o){this.specification=o}possiblyEvaluate(o,c,p,v){return!!o.expression.evaluate(c,null,{},p,v)}interpolate(){return!1}}class $i{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const c=new vi(0,{});for(const p in o){const v=o[p];v.specification.overridable&&this.overridableProperties.push(p);const m=this.defaultPropertyValues[p]=new Pp(v,void 0),x=this.defaultTransitionablePropertyValues[p]=new Yu(v);this.defaultTransitioningPropertyValues[p]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=m.possiblyEvaluate(c)}}}hr(or,"DataDrivenProperty"),hr(Yt,"DataConstantProperty"),hr(Ol,"ColorRampProperty");var vt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function Sc(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Zl(d){if(Array.isArray(d))return d.map(Zl);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const o={};for(const c in d)o[c]=Zl(d[c]);return o}return Sc(d)}function Ep(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const o of d.slice(1))if(!Ep(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}function Ty(d,o="",c=null,p="fill"){if(d==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ep(d)||(d=td(d));const v=d;let m=!0;try{m=function(E){if(!iu(E))return E;let N=Zl(E);return nu(N),N=Ac(N),N}(v)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(v,null,2)}
        `)}let x=null,M=null;if(p!=="background"&&p!=="sky"&&p!=="slot"){M=vt[`filter_${p}`];const E=Us(m,M,o,c);if(E.result==="error")throw new Error(E.value.map(N=>`${N.key}: ${N.message}`).join(", "));x=(N,L,k)=>E.value.evaluate(N,L,{},k)}let j=null,F=null;if(m!==v){const E=Us(v,M,o,c);if(E.result==="error")throw new Error(E.value.map(N=>`${N.key}: ${N.message}`).join(", "));j=(N,L,k,I,$)=>E.value.evaluate(N,L,{},k,void 0,void 0,I,$),F=!Jc(E.value.expression)}return{filter:x,dynamicFilter:j||void 0,needGeometry:Py(m),needFeature:!!F}}function Ac(d){if(!Array.isArray(d))return d;const o=function(c){if(h_.has(c[0])){for(let p=1;p<c.length;p++)if(iu(c[p]))return!0}return c}(d);return o===!0?o:o.map(c=>Ac(c))}function nu(d){let o=!1;const c=[];if(d[0]==="case"){for(let p=1;p<d.length-1;p+=2)o=o||iu(d[p]),c.push(d[p+1]);c.push(d[d.length-1])}else if(d[0]==="match"){o=o||iu(d[1]);for(let p=2;p<d.length-1;p+=2)c.push(d[p+1]);c.push(d[d.length-1])}else if(d[0]==="step"){o=o||iu(d[1]);for(let p=1;p<d.length-1;p+=2)c.push(d[p+1])}o&&(d.length=0,d.push("any",...c));for(let p=1;p<d.length;p++)nu(d[p])}function iu(d){if(!Array.isArray(d))return!1;if((o=d[0])==="pitch"||o==="distance-from-center")return!0;var o;for(let c=1;c<d.length;c++)if(iu(d[c]))return!0;return!1}const h_=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function qm(d,o){return d<o?-1:d>o?1:0}function Py(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let o=1;o<d.length;o++)if(Py(d[o]))return!0;return!1}function td(d){if(!d)return!0;const o=d[0];return d.length<=1?o!=="any":o==="=="?Ko(d[1],d[2],"=="):o==="!="?pl(Ko(d[1],d[2],"==")):o==="<"||o===">"||o==="<="||o===">="?Ko(d[1],d[2],o):o==="any"?(c=d.slice(1),["any"].concat(c.map(td))):o==="all"?["all"].concat(d.slice(1).map(td)):o==="none"?["all"].concat(d.slice(1).map(td).map(pl)):o==="in"?eh(d[1],d.slice(2)):o==="!in"?pl(eh(d[1],d.slice(2))):o==="has"?th(d[1]):o!=="!has"||pl(th(d[1]));var c}function Ko(d,o,c){switch(d){case"$type":return[`filter-type-${c}`,o];case"$id":return[`filter-id-${c}`,o];default:return[`filter-${c}`,d,o]}}function eh(d,o){if(o.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(c=>typeof c!=typeof o[0])?["filter-in-large",d,["literal",o.sort(qm)]]:["filter-in-small",d,["literal",o]]}}function th(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function pl(d){return["!",d]}const hf="";function Ss(d,o){return o?`${d}${hf}${o}`:d}const Tc="-transition",Gm=new Set(["fill","line","background","hillshade","raster"]);class fi extends qc{constructor(o,c,p,v,m){if(super(),this.id=o.id,this.fqid=Ss(this.id,p),this.type=o.type,this.scope=p,this.lut=v,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,o.type!=="custom"){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&o.type!=="background"&&o.type!=="sky"&&o.type!=="slot"){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const x=Us(this.filter,vt[`filter_${o.type}`]);x.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...x.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),c.layout&&(this._unevaluatedLayout=new Ju(c.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),c.paint){this._transitionablePaint=new Jd(c.paint,this.scope,m);for(const x in o.paint)this.setPaintProperty(x,o.paint[x]);for(const x in o.layout)this.setLayoutProperty(x,o.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ed(c.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D()&&Gm.has(this.type)}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,c){if(this.type==="custom"&&o==="visibility")return void(this.visibility=c);const p=this._unevaluatedLayout;p._properties.properties[o]&&(p.setValue(o,c),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),o==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return Qa(o,Tc)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,c){const p=this._transitionablePaint,v=p._properties.properties;if(Qa(o,Tc)){const N=o.slice(0,-11);return v[N]&&p.setTransition(N,c||void 0),!1}if(!v[o])return!1;const m=p._values[o],x=m.value.isDataDriven(),M=m.value;p.setValue(o,c),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const j=p._values[o].value,F=j.isDataDriven(),E=Qa(o,"pattern")||o==="line-dasharray";return F||x||E||this._handleOverridablePaintPropertyUpdate(o,M,j)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,c,p){return null}_handleOverridablePaintPropertyUpdate(o,c,p){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,c){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,c)}serialize(){return _l({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const c=this.paint.get(o);if(c instanceof Qu&&El(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=Ty(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&(o.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,c,p,v,m,x,M,j,F){}}const Km={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class rh{constructor(o,c){this._structArray=o,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ri{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,c){return o._trim(),c&&(o.isTransferred=!0,c.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const c=Object.create(this.prototype);return c.arrayBuffer=o.arrayBuffer,c.length=o.length,c.capacity=o.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Qn(d,o=1){let c=0,p=0;return{members:d.map(v=>{const m=Km[v.type].BYTES_PER_ELEMENT,x=c=Wm(c,Math.max(o,m)),M=v.components||1;return p=Math.max(p,m),c+=m*M,{name:v.name,type:v.type,components:M,offset:x}}),size:Wm(c,Math.max(p,o)),alignment:o}}function Wm(d,o){return Math.ceil(d/o)*o}class As extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c){const p=this.length;return this.resize(p+1),this.emplace(p,o,c)}emplace(o,c,p){const v=2*o;return this.int16[v+0]=c,this.int16[v+1]=p,o}}As.prototype.bytesPerElement=4,hr(As,"StructArrayLayout2i4");class ia extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,p)}emplace(o,c,p,v){const m=3*o;return this.int16[m+0]=c,this.int16[m+1]=p,this.int16[m+2]=v,o}}ia.prototype.bytesPerElement=6,hr(ia,"StructArrayLayout3i6");class ua extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,p,v)}emplace(o,c,p,v,m){const x=4*o;return this.int16[x+0]=c,this.int16[x+1]=p,this.int16[x+2]=v,this.int16[x+3]=m,o}}ua.prototype.bytesPerElement=8,hr(ua,"StructArrayLayout4i8");class ro extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,o,c,p,v,m)}emplace(o,c,p,v,m,x){const M=5*o;return this.int16[M+0]=c,this.int16[M+1]=p,this.int16[M+2]=v,this.int16[M+3]=m,this.int16[M+4]=x,o}}ro.prototype.bytesPerElement=10,hr(ro,"StructArrayLayout5i10");class rd extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M){const j=this.length;return this.resize(j+1),this.emplace(j,o,c,p,v,m,x,M)}emplace(o,c,p,v,m,x,M,j){const F=6*o,E=12*o,N=3*o;return this.int16[F+0]=c,this.int16[F+1]=p,this.uint8[E+4]=v,this.uint8[E+5]=m,this.uint8[E+6]=x,this.uint8[E+7]=M,this.float32[N+2]=j,o}}rd.prototype.bytesPerElement=12,hr(rd,"StructArrayLayout2i4ub1f12");class qs extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,p)}emplace(o,c,p,v){const m=3*o;return this.float32[m+0]=c,this.float32[m+1]=p,this.float32[m+2]=v,o}}qs.prototype.bytesPerElement=12,hr(qs,"StructArrayLayout3f12");class no extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,o,c,p,v,m)}emplace(o,c,p,v,m,x){const M=6*o,j=3*o;return this.uint16[M+0]=c,this.uint16[M+1]=p,this.uint16[M+2]=v,this.uint16[M+3]=m,this.float32[j+2]=x,o}}no.prototype.bytesPerElement=12,hr(no,"StructArrayLayout4ui1f12");class Hm extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,p,v)}emplace(o,c,p,v,m){const x=4*o;return this.uint16[x+0]=c,this.uint16[x+1]=p,this.uint16[x+2]=v,this.uint16[x+3]=m,o}}Hm.prototype.bytesPerElement=8,hr(Hm,"StructArrayLayout4ui8");class mo extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,p,v,m,x)}emplace(o,c,p,v,m,x,M){const j=6*o;return this.int16[j+0]=c,this.int16[j+1]=p,this.int16[j+2]=v,this.int16[j+3]=m,this.int16[j+4]=x,this.int16[j+5]=M,o}}mo.prototype.bytesPerElement=12,hr(mo,"StructArrayLayout6i12");class Cp extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F,E,N,L){const k=this.length;return this.resize(k+1),this.emplace(k,o,c,p,v,m,x,M,j,F,E,N,L)}emplace(o,c,p,v,m,x,M,j,F,E,N,L,k){const I=12*o;return this.int16[I+0]=c,this.int16[I+1]=p,this.int16[I+2]=v,this.int16[I+3]=m,this.uint16[I+4]=x,this.uint16[I+5]=M,this.uint16[I+6]=j,this.uint16[I+7]=F,this.int16[I+8]=E,this.int16[I+9]=N,this.int16[I+10]=L,this.int16[I+11]=k,o}}Cp.prototype.bytesPerElement=24,hr(Cp,"StructArrayLayout4i4ui4i24");class Mp extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,p,v,m,x)}emplace(o,c,p,v,m,x,M){const j=10*o,F=5*o;return this.int16[j+0]=c,this.int16[j+1]=p,this.int16[j+2]=v,this.float32[F+2]=m,this.float32[F+3]=x,this.float32[F+4]=M,o}}Mp.prototype.bytesPerElement=20,hr(Mp,"StructArrayLayout3i3f20");class au extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,p,v)}emplace(o,c,p,v,m){const x=4*o;return this.float32[x+0]=c,this.float32[x+1]=p,this.float32[x+2]=v,this.float32[x+3]=m,o}}au.prototype.bytesPerElement=16,hr(au,"StructArrayLayout4f16");class Rl extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint32[1*o+0]=c,o}}Rl.prototype.bytesPerElement=4,hr(Rl,"StructArrayLayout1ul4");class Eo extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c){const p=this.length;return this.resize(p+1),this.emplace(p,o,c)}emplace(o,c,p){const v=2*o;return this.uint16[v+0]=c,this.uint16[v+1]=p,o}}Eo.prototype.bytesPerElement=4,hr(Eo,"StructArrayLayout2ui4");class nh extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F,E,N,L,k){const I=this.length;return this.resize(I+1),this.emplace(I,o,c,p,v,m,x,M,j,F,E,N,L,k)}emplace(o,c,p,v,m,x,M,j,F,E,N,L,k,I){const $=20*o,Y=10*o;return this.int16[$+0]=c,this.int16[$+1]=p,this.int16[$+2]=v,this.int16[$+3]=m,this.int16[$+4]=x,this.float32[Y+3]=M,this.float32[Y+4]=j,this.float32[Y+5]=F,this.float32[Y+6]=E,this.int16[$+14]=N,this.uint32[Y+8]=L,this.uint16[$+18]=k,this.uint16[$+19]=I,o}}nh.prototype.bytesPerElement=40,hr(nh,"StructArrayLayout5i4f1i1ul2ui40");class ff extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M){const j=this.length;return this.resize(j+1),this.emplace(j,o,c,p,v,m,x,M)}emplace(o,c,p,v,m,x,M,j){const F=8*o;return this.int16[F+0]=c,this.int16[F+1]=p,this.int16[F+2]=v,this.int16[F+4]=m,this.int16[F+5]=x,this.int16[F+6]=M,this.int16[F+7]=j,o}}ff.prototype.bytesPerElement=16,hr(ff,"StructArrayLayout3i2i2i16");class Op extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,o,c,p,v,m)}emplace(o,c,p,v,m,x){const M=4*o,j=8*o;return this.float32[M+0]=c,this.float32[M+1]=p,this.float32[M+2]=v,this.int16[j+6]=m,this.int16[j+7]=x,o}}Op.prototype.bytesPerElement=16,hr(Op,"StructArrayLayout2f1f2i16");class Zm extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x){const M=this.length;return this.resize(M+1),this.emplace(M,o,c,p,v,m,x)}emplace(o,c,p,v,m,x,M){const j=20*o,F=5*o;return this.uint8[j+0]=c,this.uint8[j+1]=p,this.float32[F+1]=v,this.float32[F+2]=m,this.float32[F+3]=x,this.float32[F+4]=M,o}}Zm.prototype.bytesPerElement=20,hr(Zm,"StructArrayLayout2ub4f20");class go extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,p){const v=this.length;return this.resize(v+1),this.emplace(v,o,c,p)}emplace(o,c,p,v){const m=3*o;return this.uint16[m+0]=c,this.uint16[m+1]=p,this.uint16[m+2]=v,o}}go.prototype.bytesPerElement=6,hr(go,"StructArrayLayout3ui6");class Ym extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee,oe,se,ie,he){const me=this.length;return this.resize(me+1),this.emplace(me,o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee,oe,se,ie,he)}emplace(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee,oe,se,ie,he,me){const be=30*o,Re=15*o,Me=60*o;return this.int16[be+0]=c,this.int16[be+1]=p,this.int16[be+2]=v,this.float32[Re+2]=m,this.float32[Re+3]=x,this.uint16[be+8]=M,this.uint16[be+9]=j,this.uint32[Re+5]=F,this.uint32[Re+6]=E,this.uint32[Re+7]=N,this.uint16[be+16]=L,this.uint16[be+17]=k,this.uint16[be+18]=I,this.float32[Re+10]=$,this.float32[Re+11]=Y,this.uint8[Me+48]=ee,this.uint8[Me+49]=oe,this.uint8[Me+50]=se,this.uint32[Re+13]=ie,this.int16[be+28]=he,this.uint8[Me+58]=me,o}}Ym.prototype.bytesPerElement=60,hr(Ym,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Xm extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee,oe,se,ie,he,me,be,Re,Me,Ce,Xe,Ie,Qe,ot,nt,lt){const dt=this.length;return this.resize(dt+1),this.emplace(dt,o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee,oe,se,ie,he,me,be,Re,Me,Ce,Xe,Ie,Qe,ot,nt,lt)}emplace(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee,oe,se,ie,he,me,be,Re,Me,Ce,Xe,Ie,Qe,ot,nt,lt,dt){const yt=20*o,ct=40*o,jt=80*o;return this.float32[yt+0]=c,this.float32[yt+1]=p,this.int16[ct+4]=v,this.int16[ct+5]=m,this.int16[ct+6]=x,this.int16[ct+7]=M,this.int16[ct+8]=j,this.int16[ct+9]=F,this.int16[ct+10]=E,this.int16[ct+11]=N,this.int16[ct+12]=L,this.uint16[ct+13]=k,this.uint16[ct+14]=I,this.uint16[ct+15]=$,this.uint16[ct+16]=Y,this.uint16[ct+17]=ee,this.uint16[ct+18]=oe,this.uint16[ct+19]=se,this.uint16[ct+20]=ie,this.uint16[ct+21]=he,this.uint16[ct+22]=me,this.uint16[ct+23]=be,this.uint16[ct+24]=Re,this.uint16[ct+25]=Me,this.uint16[ct+26]=Ce,this.uint16[ct+27]=Xe,this.uint32[yt+14]=Ie,this.float32[yt+15]=Qe,this.float32[yt+16]=ot,this.float32[yt+17]=nt,this.float32[yt+18]=lt,this.uint8[jt+76]=dt,o}}Xm.prototype.bytesPerElement=80,hr(Xm,"StructArrayLayout2f9i15ui1ul4f1ub80");class pf extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.float32[1*o+0]=c,o}}pf.prototype.bytesPerElement=4,hr(pf,"StructArrayLayout1f4");class ou extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m){const x=this.length;return this.resize(x+1),this.emplace(x,o,c,p,v,m)}emplace(o,c,p,v,m,x){const M=5*o;return this.float32[M+0]=c,this.float32[M+1]=p,this.float32[M+2]=v,this.float32[M+3]=m,this.float32[M+4]=x,o}}ou.prototype.bytesPerElement=20,hr(ou,"StructArrayLayout5f20");class Rp extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M){const j=this.length;return this.resize(j+1),this.emplace(j,o,c,p,v,m,x,M)}emplace(o,c,p,v,m,x,M,j){const F=7*o;return this.float32[F+0]=c,this.float32[F+1]=p,this.float32[F+2]=v,this.float32[F+3]=m,this.float32[F+4]=x,this.float32[F+5]=M,this.float32[F+6]=j,o}}Rp.prototype.bytesPerElement=28,hr(Rp,"StructArrayLayout7f28");class Yl extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F,E,N){const L=this.length;return this.resize(L+1),this.emplace(L,o,c,p,v,m,x,M,j,F,E,N)}emplace(o,c,p,v,m,x,M,j,F,E,N,L){const k=11*o;return this.float32[k+0]=c,this.float32[k+1]=p,this.float32[k+2]=v,this.float32[k+3]=m,this.float32[k+4]=x,this.float32[k+5]=M,this.float32[k+6]=j,this.float32[k+7]=F,this.float32[k+8]=E,this.float32[k+9]=N,this.float32[k+10]=L,o}}Yl.prototype.bytesPerElement=44,hr(Yl,"StructArrayLayout11f44");class nd extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F){const E=this.length;return this.resize(E+1),this.emplace(E,o,c,p,v,m,x,M,j,F)}emplace(o,c,p,v,m,x,M,j,F,E){const N=9*o;return this.float32[N+0]=c,this.float32[N+1]=p,this.float32[N+2]=v,this.float32[N+3]=m,this.float32[N+4]=x,this.float32[N+5]=M,this.float32[N+6]=j,this.float32[N+7]=F,this.float32[N+8]=E,o}}nd.prototype.bytesPerElement=36,hr(nd,"StructArrayLayout9f36");class ih extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c){const p=this.length;return this.resize(p+1),this.emplace(p,o,c)}emplace(o,c,p){const v=2*o;return this.float32[v+0]=c,this.float32[v+1]=p,o}}ih.prototype.bytesPerElement=8,hr(ih,"StructArrayLayout2f8");class mf extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,c,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,o,c,p,v)}emplace(o,c,p,v,m){const x=6*o;return this.uint32[3*o+0]=c,this.uint16[x+2]=p,this.uint16[x+3]=v,this.uint16[x+4]=m,o}}mf.prototype.bytesPerElement=12,hr(mf,"StructArrayLayout1ul3ui12");class gf extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint16[1*o+0]=c,o}}gf.prototype.bytesPerElement=2,hr(gf,"StructArrayLayout1ui2");class yf extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y){const ee=this.length;return this.resize(ee+1),this.emplace(ee,o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y)}emplace(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee){const oe=16*o;return this.float32[oe+0]=c,this.float32[oe+1]=p,this.float32[oe+2]=v,this.float32[oe+3]=m,this.float32[oe+4]=x,this.float32[oe+5]=M,this.float32[oe+6]=j,this.float32[oe+7]=F,this.float32[oe+8]=E,this.float32[oe+9]=N,this.float32[oe+10]=L,this.float32[oe+11]=k,this.float32[oe+12]=I,this.float32[oe+13]=$,this.float32[oe+14]=Y,this.float32[oe+15]=ee,o}}yf.prototype.bytesPerElement=64,hr(yf,"StructArrayLayout16f64");class ah extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,c,p,v,m,x,M){const j=this.length;return this.resize(j+1),this.emplace(j,o,c,p,v,m,x,M)}emplace(o,c,p,v,m,x,M,j){const F=10*o,E=5*o;return this.uint16[F+0]=c,this.uint16[F+1]=p,this.uint16[F+2]=v,this.uint16[F+3]=m,this.float32[E+2]=x,this.float32[E+3]=M,this.float32[E+4]=j,o}}ah.prototype.bytesPerElement=20,hr(ah,"StructArrayLayout4ui3f20");class Jm extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.int16[1*o+0]=c,o}}Jm.prototype.bytesPerElement=2,hr(Jm,"StructArrayLayout1i2");class kp extends Ri{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const c=this.length;return this.resize(c+1),this.emplace(c,o)}emplace(o,c){return this.uint8[1*o+0]=c,o}}kp.prototype.bytesPerElement=1,hr(kp,"StructArrayLayout1ub1");class Ey extends rh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ey.prototype.size=40;class Qm extends nh{get(o){return new Ey(this,o)}}hr(Qm,"CollisionBoxArray");class oh extends rh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}oh.prototype.size=60;class Cy extends Ym{get(o){return new oh(this,o)}}hr(Cy,"PlacedSymbolArray");class My extends rh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}My.prototype.size=80;class Oy extends Xm{get(o){return new My(this,o)}}hr(Oy,"SymbolInstanceArray");class f_ extends pf{getoffsetX(o){return this.float32[1*o+0]}}hr(f_,"GlyphOffsetArray");class Ry extends As{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}hr(Ry,"SymbolLineVertexArray");class jp extends rh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}jp.prototype.size=12;class Np extends mf{get(o){return new jp(this,o)}}hr(Np,"FeatureIndexArray");class Ts extends Eo{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}hr(Ts,"FillExtrusionCentroidArray");class vf extends rh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}vf.prototype.size=6;class ky extends ia{get(o){return new vf(this,o)}}hr(ky,"FillExtrusionWallArray");const eg=Qn([{name:"a_pos",components:2,type:"Int16"}],4),W0=Qn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class va{constructor(o=[]){this.segments=o}_prepareSegment(o,c,p,v){let m=this.segments[this.segments.length-1];return o>va.MAX_VERTEX_ARRAY_LENGTH&&rn(`Max vertices per segment is ${va.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!m||m.vertexLength+o>va.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==v)&&(m={vertexOffset:c,primitiveOffset:p,vertexLength:0,primitiveLength:0},v!==void 0&&(m.sortKey=v),this.segments.push(m)),m}prepareSegment(o,c,p,v){return this._prepareSegment(o,c.length,p.length,v)}get(){return this.segments}destroy(){for(const o of this.segments)for(const c in o.vaos)o.vaos[c].destroy()}static simpleSegment(o,c,p,v){return new va([{vertexOffset:o,primitiveOffset:c,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function tg(d,o){return 256*(d=dr(Math.floor(d),0,255))+dr(Math.floor(o),0,255)}va.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,hr(va,"SegmentVector");const Xl=Qn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ip=Qn([{name:"a_dash",components:4,type:"Uint16"}]);class id{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,c,p,v){this.ids.push(jy(o)),this.positions.push(c,p,v)}eachPosition(o,c){const p=jy(o);let v=0,m=this.ids.length-1;for(;v<m;){const x=v+m>>1;this.ids[x]>=p?m=x:v=x+1}for(;this.ids[v]===p;)c(this.positions[3*v],this.positions[3*v+1],this.positions[3*v+2]),v++}static serialize(o,c){const p=new Float64Array(o.ids),v=new Uint32Array(o.positions);return _f(p,v,0,p.length-1),c&&(c.add(p.buffer),c.add(v.buffer)),{ids:p,positions:v}}static deserialize(o){const c=new id;let p;c.ids=o.ids,c.positions=o.positions;for(const v of c.ids)v!==p&&c.uniqueIds.push(v),p=v;return c.indexed=!0,c}}function jy(d){const o=+d;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:ol(String(d))}function _f(d,o,c,p){for(;c<p;){const v=d[c+p>>1];let m=c-1,x=p+1;for(;;){do m++;while(d[m]<v);do x--;while(d[x]>v);if(m>=x)break;Dp(d,m,x),Dp(o,3*m,3*x),Dp(o,3*m+1,3*x+1),Dp(o,3*m+2,3*x+2)}x-c<p-x?(_f(d,o,c,x),c=x+1):(_f(d,o,x+1,p),p=x)}}function Dp(d,o,c){const p=d[o];d[o]=d[c],d[c]=p}hr(id,"FeaturePositionMap");class kl{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,c){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,c),this.initialized=!0),!!this.location}set(o,c,p){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Pc extends kl{constructor(o){super(o),this.current=0}set(o,c,p){this.fetchUniformLocation(o,c)&&this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}}class da extends kl{constructor(o){super(o),this.current=0}set(o,c,p){this.fetchUniformLocation(o,c)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class Gs extends kl{constructor(o){super(o),this.current=[0,0]}set(o,c,p){this.fetchUniformLocation(o,c)&&(p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1])))}}class xf extends kl{constructor(o){super(o),this.current=[0,0,0]}set(o,c,p){this.fetchUniformLocation(o,c)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2])))}}class bf extends kl{constructor(o){super(o),this.current=[0,0,0,0]}set(o,c,p){this.fetchUniformLocation(o,c)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Ny extends kl{constructor(o){super(o),this.current=Jn.transparent.toRenderColor(null)}set(o,c,p){this.fetchUniformLocation(o,c)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const Iy=new Float32Array(16);class wf extends kl{constructor(o){super(o),this.current=Iy}set(o,c,p){if(this.fetchUniformLocation(o,c)){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let v=1;v<16;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}}}const rg=new Float32Array(9),H0=new Float32Array(4);class ls extends kl{constructor(o){super(o),this.current=H0}set(o,c,p){if(this.fetchUniformLocation(o,c)){for(let v=0;v<4;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix2fv(this.location,!1,p);break}}}}function Wo(d){return[tg(255*d.r,255*d.g),tg(255*d.b,255*d.a)]}class ad{constructor(o,c,p,v){this.value=o,this.uniformNames=c.map(m=>`u_${m}`),this.type=p,this.context=v}setUniform(o,c,p,v,m){const x=v.constantOr(this.value);c.set(o,m,x instanceof Jn?x.toRenderColor(this.ignoreLut?null:this.context.lut):x)}getBinding(o,c){return this.type==="color"?new Ny(o):new da(o)}}class od{constructor(o,c){this.uniformNames=c.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,c,p,v,m){const x=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;x&&c.set(o,m,x)}getBinding(o,c){return c==="u_pattern"||c==="u_dash"?new bf(o):new da(o)}}class Ec{constructor(o,c,p,v){this.expression=o,this.type=p,this.maxValue=0,this.paintVertexAttributes=c.map(m=>({name:`a_${m}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(o,c,p,v,m,x,M){const j=this.paintVertexArray.length,F=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new vi(0,{brightness:x}),c,{},m,v,M):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new vi(0,{brightness:x}),c,{},m,v,M)==="none"),this.paintVertexArray.resize(o),this._setPaintValue(j,o,F,this.context)}updatePaintArray(o,c,p,v,m,x,M){const j=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:M},p,v,void 0,m):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:M},p,v,void 0,m)==="none"),this._setPaintValue(o,c,j,this.context)}_setPaintValue(o,c,p,v){if(this.type==="color"){const m=Wo(p.toRenderColor(this.ignoreLut?null:v.lut));for(let x=o;x<c;x++)this.paintVertexArray.emplace(x,m[0],m[1])}else{for(let m=o;m<c;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class jl{constructor(o,c,p,v,m,x){this.expression=o,this.uniformNames=c.map(M=>`u_${M}_t`),this.type=p,this.useIntegerZoom=v,this.context=m,this.maxValue=0,this.paintVertexAttributes=c.map(M=>({name:`a_${M}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(o,c,p,v,m,x,M){const j=this.expression.evaluate(new vi(this.context.zoom,{brightness:x}),c,{},m,v,M),F=this.expression.evaluate(new vi(this.context.zoom+1,{brightness:x}),c,{},m,v,M);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new vi(this.context.zoom,{brightness:x}),c,{},m,v,M)==="none");const E=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(E,o,j,F,this.context)}updatePaintArray(o,c,p,v,m,x,M){const j=this.expression.evaluate({zoom:this.context.zoom,brightness:M},p,v,void 0,m),F=this.expression.evaluate({zoom:this.context.zoom+1,brightness:M},p,v,void 0,m);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:M},p,v,void 0,m)==="none"),this._setPaintValue(o,c,j,F,this.context)}_setPaintValue(o,c,p,v,m){if(this.type==="color"){const x=Wo(p.toRenderColor(this.ignoreLut?null:m.lut)),M=Wo(p.toRenderColor(this.ignoreLut?null:m.lut));for(let j=o;j<c;j++)this.paintVertexArray.emplace(j,x[0],x[1],M[0],M[1])}else{for(let x=o;x<c;x++)this.paintVertexArray.emplace(x,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,c,p,v,m){const x=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,M=dr(this.expression.interpolationFactor(x,this.context.zoom,this.context.zoom+1),0,1);c.set(o,m,M)}getBinding(o,c){return new da(o)}}class su{constructor(o,c,p,v,m){this.expression=o,this.layerId=m,this.paintVertexAttributes=(p==="array"?Ip:Xl).members;for(let x=0;x<c.length;++x);this.paintVertexArray=new v}populatePaintArray(o,c,p,v){const m=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(m,o,c.patterns&&c.patterns[this.layerId],p)}updatePaintArray(o,c,p,v,m,x,M){this._setPaintValues(o,c,p.patterns&&p.patterns[this.layerId],x)}_setPaintValues(o,c,p,v){if(!v||!p)return;const m=v[p];if(!m)return;const{tl:x,br:M,pixelRatio:j}=m;for(let F=o;F<c;F++)this.paintVertexArray.emplace(F,x[0],x[1],M[0],M[1],j)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class lu{constructor(o,c,p=()=>!0){this.binders={},this._buffers=[],this.context=c;const v=[];for(const m in o.paint._values){const x=o.paint.get(m),M=o.paint.get(`${m}-use-theme`);if(m.endsWith("-use-theme")||!p(m)||!(x instanceof Qu&&El(x.property.specification)))continue;const j=p_(m,o.type),F=x.value,E=x.property.specification.type,N=!!x.property.useIntegerZoom,L=m==="line-dasharray"||m.endsWith("pattern"),k=m==="line-dasharray"&&o.layout.get("line-cap").value.kind!=="constant"||M&&M.value.kind!=="constant";if(F.kind!=="constant"||k)if(F.kind==="source"||k||L){const I=ng(m,E,"source");this.binders[m]=L?new su(F,j,E,I,o.id):new Ec(F,j,E,I),v.push(`/a_${m}`)}else{const I=ng(m,E,"composite");this.binders[m]=new jl(F,j,E,N,c,I),v.push(`/z_${m}`)}else this.binders[m]=L?new od(F.value,j):new ad(F.value,j,E,c),v.push(`/u_${m}`);M&&(this.binders[m].ignoreLut=M.constantOr("default")==="none",this.binders[m].lutExpression=M.value,this.binders[m].checkUseTheme=!0)}this.cacheKey=v.sort().join("")}getMaxValue(o){const c=this.binders[o];return c instanceof Ec||c instanceof jl?c.maxValue:0}populatePaintArrays(o,c,p,v,m,x,M){for(const j in this.binders){const F=this.binders[j];F.context=this.context,F instanceof Ec||F instanceof jl||F instanceof su?F.populatePaintArray(o,c,p,v,m,x,M):F.lutExpression&&F instanceof ad&&F.lutExpression&&(F.lutExpression.kind==="composite"||F.lutExpression.kind==="source")&&(F.ignoreLut=F.lutExpression.evaluate(new vi(0,{brightness:x}),c,{},m,v,M)==="none")}}setConstantPatternPositions(o){for(const c in this.binders){const p=this.binders[c];p instanceof od&&p.setConstantPatternPositions(o)}}updatePaintArrays(o,c,p,v,m,x,M,j,F){let E=!1;const N=Object.keys(o),L=N.length!==0&&!j,k=L?N:c.uniqueIds;this.context.lut=m.lut;for(const I in this.binders){const $=this.binders[I];if($.context=this.context,($ instanceof Ec||$ instanceof jl||$ instanceof su)&&$.expression&&$.expression.kind&&$.expression.kind!=="constant"&&($.expression.isStateDependent===!0||$.expression.isLightConstant===!1)){const Y=m.paint.get(I);$.expression=Y.value;for(const ee of k){const oe=o[ee.toString()];c.eachPosition(ee,(se,ie,he)=>{const me=v.feature(se);$.updatePaintArray(ie,he,me,oe,x,M,F)})}if(!L)for(const ee of p.uniqueIds){const oe=o[ee.toString()];p.eachPosition(ee,(se,ie,he)=>{const me=v.feature(se);$.updatePaintArray(ie,he,me,oe,x,M,F)})}E=!0}}return E}defines(){const o=[];for(const c in this.binders){const p=this.binders[c];(p instanceof ad||p instanceof od)&&o.push(...p.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return o}getBinderAttributes(){const o=[];for(const c in this.binders){const p=this.binders[c];if(p instanceof Ec||p instanceof jl||p instanceof su)for(let v=0;v<p.paintVertexAttributes.length;v++)o.push(p.paintVertexAttributes[v].name)}return o}getBinderUniforms(){const o=[];for(const c in this.binders){const p=this.binders[c];if(p instanceof ad||p instanceof od||p instanceof jl)for(const v of p.uniformNames)o.push(v)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const c=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof ad||v instanceof od||v instanceof jl)for(const m of v.uniformNames)c.push({name:m,property:p,binding:v.getBinding(o,m)})}return c}setUniforms(o,c,p,v,m){for(const{name:x,property:M,binding:j}of p){if(this.binders[M].checkUseTheme&&this.binders[M]instanceof ad){const F=v.get(`${M}-use-theme`);F.isConstant()&&(this.binders[M].ignoreLut=F.constantOr("default")==="none")}this.binders[M].setUniform(o,j,m,v.get(M),x)}}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Ec||c instanceof jl||c instanceof su)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(o){for(const c in this.binders){const p=this.binders[c];(p instanceof Ec||p instanceof jl||p instanceof su)&&p.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const c=this.binders[o];(c instanceof Ec||c instanceof jl||c instanceof su)&&c.destroy()}}}class cu{constructor(o,c,p=()=>!0){this.programConfigurations={};for(const v of o)this.programConfigurations[v.id]=new lu(v,c,p);this.needsUpload=!1,this._featureMap=new id,this._featureMapWithoutIds=new id,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,c,p,v,m,x,M,j){for(const F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(o,c,v,m,x,M,j);c.id!==void 0?this._featureMap.add(c.id,p,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,p,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,c,p,v,m,x,M){for(const j of p)this.needsUpload=this.programConfigurations[j.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,c,j,v,m,x,M||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Dy={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function p_(d,o){return Dy[d]||[d.replace(`${o}-`,"").replace(/-/g,"_")]}const m_={"line-pattern":{source:no,composite:no},"fill-pattern":{source:no,composite:no},"fill-extrusion-pattern":{source:no,composite:no},"line-dasharray":{source:Hm,composite:Hm}},Sf={color:{source:ih,composite:au},number:{source:pf,composite:ih}};function ng(d,o,c){const p=m_[d];return p&&p[c]||Sf[o][c]}hr(ad,"ConstantBinder"),hr(od,"PatternConstantBinder"),hr(Ec,"SourceExpressionBinder"),hr(su,"PatternCompositeBinder"),hr(jl,"CompositeExpressionBinder"),hr(lu,"ProgramConfiguration",{omit:["_buffers"]}),hr(cu,"ProgramConfigurationSet");const Ho=ar/Math.PI/2,sd=5,Lp=6,g_=16383,sh=64,Af=[sh,32,16],Ks=-Ho,cs=Ho;function Ws(d,o,c,p=Ho){return c=rt(c),[d*Math.sin(c)*p,-o*p,d*Math.cos(c)*p]}function lh(d,o,c){return Ws(Math.cos(rt(d)),Math.sin(rt(d)),o,c)}const ld=63710088e-1,zp=2*Math.PI*ld;class Zn{constructor(o,c){if(isNaN(o)||isNaN(c))throw new Error(`Invalid LngLat object: (${o}, ${c})`);if(this.lng=+o,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Zn(Ti(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const c=Math.PI/180,p=this.lat*c,v=o.lat*c,m=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((o.lng-this.lng)*c);return ld*Math.acos(Math.min(m,1))}toBounds(o=0){const c=360*o/40075017,p=c/Math.cos(Math.PI/180*this.lat);return new uu({lng:this.lng-p,lat:this.lat-c},{lng:this.lng+p,lat:this.lat+c})}toEcef(o){return lh(this.lat,this.lng,Ho+o*Ho/ld)}static convert(o){if(o instanceof Zn)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new Zn(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new Zn(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class uu{constructor(o,c){if(o)if(c)this.setSouthWest(o).setNorthEast(c);else if(o.length===4){const p=o;this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]])}else{const p=o;this.setSouthWest(p[0]).setNorthEast(p[1])}}setNorthEast(o){return this._ne=o instanceof Zn?new Zn(o.lng,o.lat):Zn.convert(o),this}setSouthWest(o){return this._sw=o instanceof Zn?new Zn(o.lng,o.lat):Zn.convert(o),this}extend(o){const c=this._sw,p=this._ne;let v,m;if(o instanceof Zn)v=o,m=o;else{if(!(o instanceof uu))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(uu.convert(o)):this.extend(Zn.convert(o)):typeof o=="object"&&o!==null&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(Zn.convert(o)):this;if(v=o._sw,m=o._ne,!v||!m)return this}return c||p?(c.lng=Math.min(v.lng,c.lng),c.lat=Math.min(v.lat,c.lat),p.lng=Math.max(m.lng,p.lng),p.lat=Math.max(m.lat,p.lat)):(this._sw=new Zn(v.lng,v.lat),this._ne=new Zn(m.lng,m.lat)),this}getCenter(){return new Zn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Zn(this.getWest(),this.getNorth())}getSouthEast(){return new Zn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:c,lat:p}=Zn.convert(o);let v=this._sw.lng<=c&&c<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=c&&c>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(o){if(o)return o instanceof uu?o:new uu(o)}}const Fp=0,us=25.5;function ig(d){return zp*Math.cos(d*Math.PI/180)}function Cc(d){return(180+d)/360}function Hs(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function qi(d,o){return d/ig(o)}function Zs(d){return 360*d-180}function zr(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function ch(d,o){return d*ig(zr(o))}const Zo=85.051129;function ag(d){return Math.cos(rt(dr(d,-85.051129,Zo)))}function Tf(d,o){const c=dr(o,Fp,us),p=Math.pow(2,c);return ag(d)*zp/(512*p)}function g(d){return 1/Math.cos(d*Math.PI/180)}function s(d,o=0){const c=Math.exp(Math.PI*(1-(d.y+o/ar)/(1<<d.z)*2));return 80150034*c/(c*c+1)/ar/(1<<d.z)}class u{constructor(o,c,p=0){this.x=+o,this.y=+c,this.z=+p}static fromLngLat(o,c=0){const p=Zn.convert(o);return new u(Cc(p.lng),Hs(p.lat),qi(c,p.lat))}toLngLat(){return new Zn(Zs(this.x),zr(this.y))}toAltitude(){return ch(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/zp*g(zr(this.y))}}function y(d,o,c,p,v,m,x,M,j){const F=(o+p)/2,E=(c+v)/2,N=new It(F,E);M(N),function(L,k,I,$,Y,ee){const oe=I-Y,se=$-ee;return Math.abs(($-k)*oe-(I-L)*se)/Math.hypot(oe,se)}(N.x,N.y,m.x,m.y,x.x,x.y)>=j?(y(d,o,c,F,E,m,N,M,j),y(d,F,E,p,v,N,x,M,j)):d.push(x)}function S(d,o,c){let p=d[0],v=p.x,m=p.y;o(p);const x=[p];for(let M=1;M<d.length;M++){const j=d[M],{x:F,y:E}=j;o(j),y(x,v,m,F,E,p,j,o,c),v=F,m=E,p=j}return x}function P(d,o,c,p){if(p(o,c)){const v=o.add(c)._mult(.5);P(d,o,v,p),P(d,v,c,p)}else d.push(c)}function O(d,o){let c=d[0];const p=[c];for(let v=1;v<d.length;v++){const m=d[v];P(p,c,m,o),c=m}return p}const D=Math.pow(2,14)-1,q=-D-1;function W(d,o){const c=Math.round(d.x*o),p=Math.round(d.y*o);return d.x=dr(c,q,D),d.y=dr(p,q,D),(c<d.x||c>d.x+1||p<d.y||p>d.y+1)&&rn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d}function Z(d,o,c){const p=d.loadGeometry(),v=d.extent,m=ar/v;if(o&&c&&c.projection.isReprojectedInTileSpace){const x=1<<o.z,{scale:M,x:j,y:F,projection:E}=c,N=L=>{const k=Zs((o.x+L.x/v)/x),I=zr((o.y+L.y/v)/x),$=E.project(k,I);L.x=($.x*M-j)*v,L.y=($.y*M-F)*v};for(let L=0;L<p.length;L++)if(d.type!==1)p[L]=S(p[L],N,1);else{const k=[];for(const I of p[L])I.x<0||I.x>=v||I.y<0||I.y>=v||(N(I),k.push(I));p[L]=k}}for(const x of p)for(const M of x)W(M,m);return p}function te(d,o){return{type:d.type,id:d.id,properties:d.properties,geometry:o?Z(d):[]}}function re(d,o,c,p,v){d.emplaceBack(2*o+(p+1)/2,2*c+(v+1)/2)}function ae(d,o,c){d.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class ye{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new As,this.indexArray=new go,this.segments=new va,this.programConfigurations=new cu(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}updateFootprints(o,c){}populate(o,c,p,v){const m=this.layers[0],x=[];let M=null;m.type==="circle"&&(M=m.layout.get("circle-sort-key"));for(const{feature:F,id:E,index:N,sourceLayerIndex:L}of o){const k=this.layers[0]._featureFilter.needGeometry,I=te(F,k);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),I,p))continue;const $=M?M.evaluate(I,{},p):void 0,Y={id:E,properties:F.properties,type:F.type,sourceLayerIndex:L,index:N,geometry:k?I.geometry:Z(F,p,v),patterns:{},sortKey:$};x.push(Y)}M&&x.sort((F,E)=>F.sortKey-E.sortKey);let j=null;v.projection.name==="globe"&&(this.globeExtVertexArray=new mo,j=v.projection);for(const F of x){const{geometry:E,index:N,sourceLayerIndex:L}=F,k=o[N].feature;this.addFeature(F,E,N,c.availableImages,p,j,c.brightness),c.featureIndex.insert(k,E,N,L,this.index)}}update(o,c,p,v,m,x,M){this.programConfigurations.updatePaintArrays(o,c,m,p,v,x,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,eg.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,W0.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,c,p,v,m,x,M){for(const j of c)for(const F of j){const E=F.x,N=F.y;if(E<0||E>=ar||N<0||N>=ar)continue;if(x){const I=x.projectTilePoint(E,N,m),$=x.upVector(m,E,N),Y=this.globeExtVertexArray;ae(Y,I,$),ae(Y,I,$),ae(Y,I,$),ae(Y,I,$)}const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),k=L.vertexLength;re(this.layoutVertexArray,E,N,-1,-1),re(this.layoutVertexArray,E,N,1,-1),re(this.layoutVertexArray,E,N,1,1),re(this.layoutVertexArray,E,N,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+2,k+3),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,{},v,m,M)}}function fe(d,o){for(let c=0;c<d.length;c++)if(Ve(o,d[c]))return!0;for(let c=0;c<o.length;c++)if(Ve(d,o[c]))return!0;return!!Fe(d,o)}function xe(d,o,c){return!!Ve(d,o)||!!Ze(o,d,c)}function _e(d,o){if(d.length===1)return qe(o,d[0]);for(let c=0;c<o.length;c++){const p=o[c];for(let v=0;v<p.length;v++)if(Ve(d,p[v]))return!0}for(let c=0;c<d.length;c++)if(qe(o,d[c]))return!0;for(let c=0;c<o.length;c++)if(Fe(d,o[c]))return!0;return!1}function Ee(d,o,c){if(d.length>1){if(Fe(d,o))return!0;for(let p=0;p<o.length;p++)if(Ze(o[p],d,c))return!0}for(let p=0;p<d.length;p++)if(Ze(d[p],o,c))return!0;return!1}function Fe(d,o){if(d.length===0||o.length===0)return!1;for(let c=0;c<d.length-1;c++){const p=d[c],v=d[c+1];for(let m=0;m<o.length-1;m++)if(De(p,v,o[m],o[m+1]))return!0}return!1}function De(d,o,c,p){return eo(d,c,p)!==eo(o,c,p)&&eo(d,o,c)!==eo(d,o,p)}function Ze(d,o,c){const p=c*c;if(o.length===1)return d.distSqr(o[0])<p;for(let v=1;v<o.length;v++)if(Ue(d,o[v-1],o[v])<p)return!0;return!1}function Ue(d,o,c){const p=o.distSqr(c);if(p===0)return d.distSqr(o);const v=((d.x-o.x)*(c.x-o.x)+(d.y-o.y)*(c.y-o.y))/p;return d.distSqr(v<0?o:v>1?c:c.sub(o)._mult(v)._add(o))}function qe(d,o){let c,p,v,m=!1;for(let x=0;x<d.length;x++){c=d[x];for(let M=0,j=c.length-1;M<c.length;j=M++)p=c[M],v=c[j],p.y>o.y!=v.y>o.y&&o.x<(v.x-p.x)*(o.y-p.y)/(v.y-p.y)+p.x&&(m=!m)}return m}function Ve(d,o){let c=!1;for(let p=0,v=d.length-1;p<d.length;v=p++){const m=d[p],x=d[v];m.y>o.y!=x.y>o.y&&o.x<(x.x-m.x)*(o.y-m.y)/(x.y-m.y)+m.x&&(c=!c)}return c}function Ke(d,o,c,p,v){for(const x of d)if(o<=x.x&&c<=x.y&&p>=x.x&&v>=x.y)return!0;const m=[new It(o,c),new It(o,v),new It(p,v),new It(p,c)];if(d.length>2){for(const x of m)if(Ve(d,x))return!0}for(let x=0;x<d.length-1;x++)if(it(d[x],d[x+1],m))return!0;return!1}function it(d,o,c){const p=c[0],v=c[2];if(d.x<p.x&&o.x<p.x||d.x>v.x&&o.x>v.x||d.y<p.y&&o.y<p.y||d.y>v.y&&o.y>v.y)return!1;const m=eo(d,o,c[0]);return m!==eo(d,o,c[1])||m!==eo(d,o,c[2])||m!==eo(d,o,c[3])}function _t(d,o,c,p,v,m){let x=o.y-d.y,M=d.x-o.x;if(m=m||0){const j=x*x+M*M;if(j===0)return!0;const F=Math.sqrt(j);x/=F,M/=F}return!((c.x-d.x)*x+(c.y-d.y)*M-m<0||(p.x-d.x)*x+(p.y-d.y)*M-m<0||(v.x-d.x)*x+(v.y-d.y)*M-m<0)}function pt(d,o,c,p,v,m,x){return!(_t(d,o,p,v,m,x)||_t(o,c,p,v,m,x)||_t(c,d,p,v,m,x)||_t(p,v,d,o,c,x)||_t(v,m,d,o,c,x)||_t(m,p,d,o,c,x))}function Ct(d,o,c){const p=o.paint.get(d).value;return p.kind==="constant"?p.value:c.programConfigurations.get(o.id).getMaxValue(d)}function Mt(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function ut(d,o,c,p,v){if(!o[0]&&!o[1])return d;const m=It.convert(o)._mult(v);c==="viewport"&&m._rotate(-p);const x=[];for(let M=0;M<d.length;M++)x.push(d[M].sub(m));return x}function Tt(d,o,c,p){const v=It.convert(d)._mult(p);return o==="viewport"&&v._rotate(-c),v}let Bt,ft;hr(ye,"CircleBucket",{omit:["layers"]});var Dt,Pt={exports:{}},Zt=(Dt||(Dt=1,function(d,o){(function(c){function p(m,x,M){var j=v(256*m,256*(x=Math.pow(2,M)-x-1),M),F=v(256*(m+1),256*(x+1),M);return j[0]+","+j[1]+","+F[0]+","+F[1]}function v(m,x,M){var j=2*Math.PI*6378137/256/Math.pow(2,M);return[m*j-2*Math.PI*6378137/2,x*j-2*Math.PI*6378137/2]}c.getURL=function(m,x,M,j,F,E){return E=E||{},m+"?"+["bbox="+p(M,j,F),"format="+(E.format||"image/png"),"service="+(E.service||"WMS"),"version="+(E.version||"1.1.1"),"request="+(E.request||"GetMap"),"srs="+(E.srs||"EPSG:3857"),"width="+(E.width||256),"height="+(E.height||256),"layers="+x].join("&")},c.getTileBBox=p,c.getMercCoords=v,Object.defineProperty(c,"__esModule",{value:!0})})(o)}(0,Pt.exports)),Pt.exports);class zt{constructor(o,c,p){this.z=o,this.x=c,this.y=p,this.key=er(0,o,o,c,p)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,c){const p=Zt.getTileBBox(this.x,this.y,this.z),v=function(m,x,M){let j,F="";for(let E=m;E>0;E--)j=1<<E-1,F+=(x&j?1:0)+(M&j?2:0);return F}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Nt{constructor(o,c){this.wrap=o,this.canonical=c,this.key=er(o,c.z,c.z,c.x,c.y)}}class qt{constructor(o,c,p,v,m){this.overscaledZ=o,this.wrap=c,this.canonical=new zt(p,+v,+m),this.key=c===0&&o===p?this.canonical.key:er(c,o,p,v,m)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const c=this.canonical.z-o;return o>this.canonical.z?new qt(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new qt(o,this.wrap,o,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(o,c=!0){if(this.overscaledZ===o&&c)return this.key;if(o>this.canonical.z)return er(this.wrap*+c,o,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-o;return er(this.wrap*+c,o,o,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const c=this.canonical.z-o.canonical.z;return o.overscaledZ===0||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>c&&o.canonical.y===this.canonical.y>>c}children(o){if(this.overscaledZ>=o)return[new qt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new qt(c,this.wrap,c,p,v),new qt(c,this.wrap,c,p+1,v),new qt(c,this.wrap,c,p,v+1),new qt(c,this.wrap,c,p+1,v+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new qt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new qt(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Nt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function er(d,o,c,p,v){const m=1<<Math.min(c,22);let x=m*(v%m)+p%m;return d&&c<22&&(x+=m*m*((d<0?-2*d-1:2*d)%(1<<2*(22-c)))),16*(32*x+c)+(o-c)}const fr=[d=>{let o=d.canonical.x-1,c=d.wrap;return o<0&&(o=(1<<d.canonical.z)-1,c--),new qt(d.overscaledZ,c,d.canonical.z,o,d.canonical.y)},d=>{let o=d.canonical.x+1,c=d.wrap;return o===1<<d.canonical.z&&(o=0,c++),new qt(d.overscaledZ,c,d.canonical.z,o,d.canonical.y)},d=>new qt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,(d.canonical.y===0?1<<d.canonical.z:d.canonical.y)-1),d=>new qt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y===(1<<d.canonical.z)-1?0:d.canonical.y+1)];hr(zt,"CanonicalTileID"),hr(qt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const mr=Qn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:$r}=mr,Or=Qn([{name:"a_pos_3",components:3,type:"Int16"}]);var jr=Qn([{name:"a_pos",type:"Int16",components:2}]);class Wr{constructor(o,c){this.pos=o,this.dir=c}intersectsPlane(o,c,p){const v=Be.vec3.dot(c,this.dir);if(Math.abs(v)<1e-6)return!1;const m=((o[0]-this.pos[0])*c[0]+(o[1]-this.pos[1])*c[1]+(o[2]-this.pos[2])*c[2])/v;return p[0]=this.pos[0]+this.dir[0]*m,p[1]=this.pos[1]+this.dir[1]*m,p[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(o,c,p){if(Be.vec3.equals(this.pos,o)||c===0)return p[0]=p[1]=p[2]=0,!1;const[v,m,x]=this.dir,M=this.pos[0]-o[0],j=this.pos[1]-o[1],F=this.pos[2]-o[2],E=v*v+m*m+x*x,N=2*(M*v+j*m+F*x),L=N*N-4*E*(M*M+j*j+F*F-c*c);if(L<0){const k=Math.max(-N/2,0),I=M+v*k,$=j+m*k,Y=F+x*k,ee=Math.hypot(I,$,Y);return p[0]=I*c/ee,p[1]=$*c/ee,p[2]=Y*c/ee,!1}{const k=(-N-Math.sqrt(L))/(2*E);if(k<0){const I=Math.hypot(M,j,F);return p[0]=M*c/I,p[1]=j*c/I,p[2]=F*c/I,!1}return p[0]=M+v*k,p[1]=j+m*k,p[2]=F+x*k,!0}}}class Mn{constructor(o,c,p,v,m){this.TL=o,this.TR=c,this.BR=p,this.BL=v,this.horizon=m}static fromInvProjectionMatrix(o,c,p){const v=[-1,1,1],m=[1,1,1],x=[1,-1,1],M=[-1,-1,1],j=Be.vec3.transformMat4(v,v,o),F=Be.vec3.transformMat4(m,m,o),E=Be.vec3.transformMat4(x,x,o),N=Be.vec3.transformMat4(M,M,o);return new Mn(j,F,E,N,c/p)}}function hi(d,o,c){let p=1/0,v=-1/0;const m=[];for(const x of d){Be.vec3.sub(m,x,o);const M=Be.vec3.dot(m,c);p=Math.min(p,M),v=Math.max(v,M)}return[p,v]}function Gi(d,o){let c=!0;for(let p=0;p<d.planes.length;p++){const v=d.planes[p];let m=0;for(let x=0;x<o.length;x++)m+=Be.vec3.dot(v,o[x])+v[3]>=0;if(m===0)return 0;m!==o.length&&(c=!1)}return c?2:1}function Yn(d,o){for(const c of d.projections){const p=hi(o,d.points[0],c.axis);if(c.projection[1]<p[0]||c.projection[0]>p[1])return 0}return 1}function Zr(d,o){let c=0;const p=[0,0,0,0];for(let v=0;v<d.length;v++)p[0]=d[v][0],p[1]=d[v][1],p[2]=d[v][2],p[3]=1,Be.vec4.dot(p,o)>=0&&c++;return c}class _n{constructor(o,c){this.points=o||new Array(8).fill([0,0,0]),this.planes=c||new Array(6).fill([0,0,0,0]),this.bounds=xr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Be.vec3.sub([],this.points[2],this.points[3]),Be.vec3.sub([],this.points[0],this.points[3]),Be.vec3.sub([],this.points[4],this.points[0]),Be.vec3.sub([],this.points[5],this.points[1]),Be.vec3.sub([],this.points[6],this.points[2]),Be.vec3.sub([],this.points[7],this.points[3])];for(const p of this.frustumEdges){const v=[0,-p[2],p[1]],m=[p[2],0,-p[0]];this.projections.push({axis:v,projection:hi(this.points,this.points[0],v)}),this.projections.push({axis:m,projection:hi(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(o,c,p,v){const m=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(F=>{const E=Be.vec4.transformMat4([],F,o),N=1/E[3]/c*m;return Be.vec4.mul(E,E,[N,N,v?1/E[3]:N,N])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(F=>{const E=Be.vec3.sub([],x[F[0]],x[F[1]]),N=Be.vec3.sub([],x[F[2]],x[F[1]]),L=Be.vec3.normalize([],Be.vec3.cross([],E,N)),k=-Be.vec3.dot(L,x[F[1]]);return L.concat(k)}),j=[];for(let F=0;F<x.length;F++)j.push([x[F][0],x[F][1],x[F][2]]);return new _n(j,M)}intersectsPrecise(o,c,p){for(let v=0;v<c.length;v++)if(!Zr(o,c[v]))return 0;for(let v=0;v<this.planes.length;v++)if(!Zr(o,this.planes[v]))return 0;for(const v of p)for(const m of this.frustumEdges){const x=Be.vec3.cross([],v,m),M=Be.vec3.length(x);if(M===0)continue;Be.vec3.scale(x,x,1/M);const j=hi(this.points,this.points[0],x),F=hi(o,this.points[0],x);if(j[0]>F[1]||F[0]>j[1])return 0}return 1}containsPoint(o){for(const c of this.planes){const p=c[3];if(Be.vec3.dot([c[0],c[1],c[2]],o)+p<0)return!1}return!0}}class xr{static fromPoints(o){const c=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const v of o)Be.vec3.min(c,c,v),Be.vec3.max(p,p,v);return new xr(c,p)}static fromTileIdAndHeight(o,c,p){const v=1<<o.canonical.z,m=o.canonical.x,x=o.canonical.y;return new xr([m/v,x/v,c],[(m+1)/v,(x+1)/v,p])}static applyTransform(o,c){const p=o.getCorners();for(let v=0;v<p.length;++v)Be.vec3.transformMat4(p[v],p[v],c);return xr.fromPoints(p)}static applyTransformFast(o,c){const p=[c[12],c[13],c[14]],v=[...p];for(let m=0;m<3;m++)for(let x=0;x<3;x++){const M=c[4*x+m],j=M*o.min[x],F=M*o.max[x];p[m]+=Math.min(j,F),v[m]+=Math.max(j,F)}return new xr(p,v)}static projectAabbCorners(o,c){const p=o.getCorners();for(let v=0;v<p.length;++v)Be.vec3.transformMat4(p[v],p[v],c);return p}constructor(o,c){this.min=o,this.max=c,this.center=Be.vec3.scale([],Be.vec3.add([],this.min,this.max),.5)}quadrant(o){const c=[o%2==0,o<2],p=Be.vec3.clone(this.min),v=Be.vec3.clone(this.max);for(let m=0;m<c.length;m++)p[m]=c[m]?this.min[m]:this.center[m],v[m]=c[m]?this.center[m]:this.max[m];return v[2]=this.max[2],new xr(p,v)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,c=this.max;return[[o[0],o[1],o[2]],[c[0],o[1],o[2]],[c[0],c[1],o[2]],[o[0],c[1],o[2]],[o[0],o[1],c[2]],[c[0],o[1],c[2]],[c[0],c[1],c[2]],[o[0],c[1],c[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?Gi(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?Gi(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,c){return c||this.intersects(o)?Yn(o,this.getCorners()):0}intersectsPreciseFlat(o,c){return c||this.intersectsFlat(o)?Yn(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let c=0;c<3;++c)if(this.min[c]>o.max[c]||o.min[c]>this.max[c])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],o.min[c]),this.max[c]=Math.max(this.max[c],o.max[c])}encapsulatePoint(o){for(let c=0;c<3;c++)this.min[c]=Math.min(this.min[c],o[c]),this.max[c]=Math.max(this.max[c],o[c])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function En(d){return d*Ho/ld}hr(xr,"Aabb");const ei=[new xr([Ks,Ks,Ks],[cs,cs,cs]),new xr([Ks,Ks,Ks],[0,0,cs]),new xr([0,Ks,Ks],[cs,0,cs]),new xr([Ks,0,Ks],[0,cs,cs]),new xr([0,0,Ks],[cs,cs,cs])];function oi(d,o,c,p=!0){const v=Be.vec3.scale([],d._camera.position,d.worldSize),m=[o,c,1,1];Be.vec4.transformMat4(m,m,d.pixelMatrixInverse),Be.vec4.scale(m,m,1/m[3]);const x=Be.vec3.sub([],m,v),M=Be.vec3.normalize([],x),j=d.globeMatrix,F=[j[12],j[13],j[14]],E=Be.vec3.sub([],F,v),N=Be.vec3.length(E),L=Be.vec3.normalize([],E),k=d.worldSize/(2*Math.PI),I=Be.vec3.dot(L,M),$=Math.asin(k/N);if($<Math.acos(I)){if(!p)return null;const Xe=[],Ie=[];Be.vec3.scale(Xe,M,N/I),Be.vec3.normalize(Ie,Be.vec3.sub(Ie,Xe,E)),Be.vec3.normalize(M,Be.vec3.add(M,E,Be.vec3.scale(M,Ie,Math.tan($)*N)))}const Y=[];new Wr(v,M).closestPointOnSphere(F,k,Y);const ee=Be.vec3.normalize([],Ca(j,0)),oe=Be.vec3.normalize([],Ca(j,1)),se=Be.vec3.normalize([],Ca(j,2)),ie=Be.vec3.dot(ee,Y),he=Be.vec3.dot(oe,Y),me=Be.vec3.dot(se,Y),be=Ot(Math.asin(-he/k));let Re=Ot(Math.atan2(ie,me));Re=d.center.lng+function(Xe,Ie){const Qe=(Ie-Xe+180)%360-180;return Qe<-180?Qe+360:Qe}(d.center.lng,Re);const Me=Cc(Re),Ce=dr(Hs(be),0,1);return new u(Me,Ce)}class Qi{constructor(o,c,p){this.a=Be.vec3.sub([],o,p),this.b=Be.vec3.sub([],c,p),this.center=p;const v=Be.vec3.normalize([],this.a),m=Be.vec3.normalize([],this.b);this.angle=Math.acos(Be.vec3.dot(v,m))}}function aa(d,o){if(d.angle===0)return null;let c;return c=d.a[o]===0?1/d.angle*.5*Math.PI:1/d.angle*Math.atan(d.b[o]/d.a[o]/Math.sin(d.angle)-1/Math.tan(d.angle)),c<0||c>1?null:function(p,v,m,x){const M=Math.sin(m);return p*(Math.sin((1-x)*m)/M)+v*(Math.sin(x*m)/M)}(d.a[o],d.b[o],d.angle,dr(c,0,1))+d.center[o]}function ja(d){if(d.z<=1)return ei[d.z+2*d.y+d.x];const o=Pi(ki(d));return xr.fromPoints(o)}function Aa(d,o,c){return Be.vec3.scale(d,d,1-c),Be.vec3.scaleAndAdd(d,d,o,c)}function Co(d,o,c){for(const p of d)Be.vec3.transformMat4(p,p,o),Be.vec3.scale(p,p,c)}function Mo(d,o,c,p){const v=o/d.worldSize,m=d.globeMatrix;if(c.z<=1){const Me=ja(c).getCorners();return Co(Me,m,v),xr.fromPoints(Me)}const x=ki(c,p),M=Pi(x,Ho+En(d._tileCoverLift));Co(M,m,v);const j=Number.MAX_VALUE,F=[-j,-j,-j],E=[j,j,j];if(x.contains(d.center)){for(const Xe of M)Be.vec3.min(E,E,Xe),Be.vec3.max(F,F,Xe);F[2]=0;const Me=d.point,Ce=[Me.x*v,Me.y*v,0];return Be.vec3.min(E,E,Ce),Be.vec3.max(F,F,Ce),new xr(E,F)}if(d._tileCoverLift>0){for(const Me of M)Be.vec3.min(E,E,Me),Be.vec3.max(F,F,Me);return new xr(E,F)}const N=[m[12]*v,m[13]*v,m[14]*v],L=x.getCenter(),k=dr(d.center.lat,-85.051129,Zo),I=dr(L.lat,-85.051129,Zo),$=Cc(d.center.lng),Y=Hs(k);let ee=$-Cc(L.lng);const oe=Y-Hs(I);ee>.5?ee-=1:ee<-.5&&(ee+=1);let se=0;if(Math.abs(ee)>Math.abs(oe))se=ee>=0?1:3;else{se=oe>=0?0:2;const Me=[m[4]*v,m[5]*v,m[6]*v],Ce=-Math.sin(rt(oe>=0?x.getSouth():x.getNorth()))*Ho;Be.vec3.scaleAndAdd(N,N,Me,Ce)}const ie=M[se],he=M[(se+1)%4],me=new Qi(ie,he,N),be=[aa(me,0)||ie[0],aa(me,1)||ie[1],aa(me,2)||ie[2]],Re=Ps(d.zoom);if(Re>0){const Me=function({x:Xe,y:Ie,z:Qe},ot,nt,lt,dt){const yt=1/(1<<Qe);let ct=Xe*yt,jt=ct+yt,Vt=Ie*yt,kt=Vt+yt,cr=0;const ir=(ct+jt)/2-lt;return ir>.5?cr=-1:ir<-.5&&(cr=1),ct=((ct+cr)*ot-(lt*=ot))*nt+lt,jt=((jt+cr)*ot-lt)*nt+lt,Vt=(Vt*ot-(dt*=ot))*nt+dt,kt=(kt*ot-dt)*nt+dt,[[ct,kt,0],[jt,kt,0],[jt,Vt,0],[ct,Vt,0]]}(c,o,d._pixelsPerMercatorPixel,$,Y);for(let Xe=0;Xe<M.length;Xe++)Aa(M[Xe],Me[Xe],Re);const Ce=Be.vec3.add([],Me[se],Me[(se+1)%4]);Be.vec3.scale(Ce,Ce,.5),Aa(be,Ce,Re)}for(const Me of M)Be.vec3.min(E,E,Me),Be.vec3.max(F,F,Me);return E[2]=Math.min(ie[2],he[2]),Be.vec3.min(E,E,be),Be.vec3.max(F,F,be),new xr(E,F)}function ki({x:d,y:o,z:c},p=!1){const v=1/(1<<c),m=new Zn(Zs(d*v),o===(1<<c)-1&&p?-90:zr((o+1)*v)),x=new Zn(Zs((d+1)*v),o===0&&p?90:zr(o*v));return new uu(m,x)}function Pi(d,o=Ho){const c=rt(d.getNorth()),p=rt(d.getSouth()),v=Math.cos(c),m=Math.cos(p),x=Math.sin(c),M=Math.sin(p),j=d.getWest(),F=d.getEast();return[Ws(m,M,j,o),Ws(m,M,F,o),Ws(v,x,F,o),Ws(v,x,j,o)]}function _i(d,o,c,p){const v=1<<c.z,m=(d/ar+c.x)/v;return lh(zr((o/ar+c.y)/v),Zs(m),p)}function Rn({min:d,max:o}){return g_/Math.max(o[0]-d[0],o[1]-d[1],o[2]-d[2])}const oa=new Float64Array(16);function io(d){const o=Rn(d),c=Be.mat4.fromScaling(oa,[o,o,o]);return Be.mat4.translate(c,c,Be.vec3.negate([],d.min))}function Ei(d){const o=Be.mat4.fromTranslation(oa,d.min),c=1/Rn(d);return Be.mat4.scale(o,o,[c,c,c])}function Lo(d){const o=ar/(2*Math.PI);return d/(2*Math.PI)/o}function ml(d,o){return ar/(512*Math.pow(2,d))*Rn(ja(o))}function yo(d,o,c,p,v){const m=Lo(c),x=[d,o,-c/(2*Math.PI)],M=Be.mat4.identity(new Float64Array(16));return Be.mat4.translate(M,M,x),Be.mat4.scale(M,M,[m,m,m]),Be.mat4.rotateX(M,M,rt(-v)),Be.mat4.rotateY(M,M,rt(-p)),M}function Ps(d){return An(sd,Lp,d)}function Es(d,o){const c=lh(o.lat,o.lng),p=function(m){const x=lh(m._center.lat,m._center.lng),M=Be.vec3.fromValues(0,1,0);let j=Be.vec3.cross([],M,x);const F=Be.mat4.fromRotation([],-m.angle,x);j=Be.vec3.transformMat4(j,j,F),Be.mat4.fromRotation(F,-m._pitch,j);const E=Be.vec3.normalize([],x);return Be.vec3.scale(E,E,En(m.cameraToCenterDistance/m.pixelsPerMeter)),Be.vec3.transformMat4(E,E,F),Be.vec3.add([],x,E)}(d),v=Be.vec3.subtract([],p,c);return Be.vec3.angle(v,c)}function gl(d,o){return Es(d,o)>Math.PI/2*1.01}const Ii=rt(85),uh=Math.cos(Ii),Jl=Math.sin(Ii),dh=Be.mat4.create(),Pf=d=>{const o=[];return d.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o};function Bp(d,o,c,p,v,m,x,M,j){if(m&&d.queryGeometry.isAboveHorizon)return!1;m&&(j*=d.pixelToTileUnitsFactor);const F=d.tileID.canonical,E=c.projection.upVectorScale(F,c.center.lat,c.worldSize).metersToTile;for(const N of o)for(const L of N){const k=L.add(M),I=v&&c.elevation?c.elevation.exaggeration()*v.getElevationAt(k.x,k.y,!0):0,$=c.projection.projectTilePoint(k.x,k.y,F);if(I>0){const se=c.projection.upVector(F,k.x,k.y);$.x+=se[0]*E*I,$.y+=se[1]*E*I,$.z+=se[2]*E*I}const Y=m?k:og($.x,$.y,$.z,p),ee=m?d.tilespaceRays.map(se=>Z0(se,I)):d.queryGeometry.screenGeometry,oe=Be.vec4.transformMat4([],[$.x,$.y,$.z,1],p);if(!x&&m?j*=oe[3]/c.cameraToCenterDistance:x&&!m&&(j*=c.cameraToCenterDistance/oe[3]),m){const se=zr((L.y/ar+F.y)/(1<<F.z));j/=c.projection.pixelsPerMeter(se,1)/qi(1,se)}if(xe(ee,Y,j))return!0}return!1}function og(d,o,c,p){const v=Be.vec4.transformMat4([],[d,o,c,1],p);return new It(v[0]/v[3],v[1]/v[3])}const IS=Be.vec3.fromValues(0,0,0),Mc=Be.vec3.fromValues(0,0,1);function Z0(d,o){const c=Be.vec3.create();return IS[2]=o,d.intersectsPlane(IS,Mc,c),new It(c[0],c[1])}class DS extends ye{}let hh,Ly,Ef,zy;function y_(d,{width:o,height:c},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==o*c*p)throw new RangeError("mismatched image size")}else v=new Uint8Array(o*c*p);return d.width=o,d.height=c,d.data=v,d}function v_(d,o,c){const{width:p,height:v}=o;p===d.width&&v===d.height||(Y0(d,o,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,p),height:Math.min(d.height,v)},c,null),d.width=p,d.height=v,d.data=o.data)}function Y0(d,o,c,p,v,m,x,M){if(v.width===0||v.height===0)return o;if(v.width>d.width||v.height>d.height||c.x>d.width-v.width||c.y>d.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>o.width||v.height>o.height||p.x>o.width-v.width||p.y>o.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const j=d.data,F=o.data,E=m===4&&M;for(let N=0;N<v.height;N++){const L=((c.y+N)*d.width+c.x)*m,k=((p.y+N)*o.width+p.x)*m;if(E)for(let I=0;I<v.width;I++){const $=L+I*m+3,Y=k+I*m;F[Y+0]=255,F[Y+1]=255,F[Y+2]=255,F[Y+3]=j[$]}else if(x)for(let I=0;I<v.width;I++){const $=L+I*m,Y=k+I*m,ee=j[$+3],oe=new Jn(j[$+0]/255*ee,j[$+1]/255*ee,j[$+2]/255*ee,ee).toRenderColor(x).toArray();F[Y+0]=oe[0],F[Y+1]=oe[1],F[Y+2]=oe[2],F[Y+3]=oe[3]}else for(let I=0;I<v.width*m;I++)F[k+I]=j[L+I]}return o}hr(DS,"HeatmapBucket",{omit:["layers"]});class cd{constructor(o,c){y_(this,o,1,c)}resize(o){v_(this,new cd(o),1)}clone(){return new cd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,p,v,m){Y0(o,c,p,v,m,1,null)}}class zo{constructor(o,c){y_(this,o,4,c)}resize(o){v_(this,new zo(o),4)}replace(o,c){c?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new zo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,c,p,v,m,x,M){Y0(o,c,p,v,m,4,x,M)}}class X0{constructor(o,c){this.width=o.width,this.height=o.height,this.data=c instanceof Uint8Array?new Float32Array(c.buffer):c}}function sg(d){const o={},c=d.resolution||256,p=d.clips?d.clips.length:1,v=d.image||new zo({width:c,height:p}),m=(x,M,j)=>{o[d.evaluationKey]=j;const F=d.expression.evaluate(o);F&&(v.data[x+M+0]=Math.floor(255*F.r/F.a),v.data[x+M+1]=Math.floor(255*F.g/F.a),v.data[x+M+2]=Math.floor(255*F.b/F.a),v.data[x+M+3]=Math.floor(255*F.a))};if(d.clips)for(let x=0,M=0;x<p;++x,M+=4*c)for(let j=0,F=0;j<c;j++,F+=4){const E=j/(c-1),{start:N,end:L}=d.clips[x];m(M,F,N*(1-E)+L*E)}else for(let x=0,M=0;x<c;x++,M+=4)m(0,M,x/(c-1));return v}hr(cd,"AlphaImage"),hr(zo,"RGBAImage");const __=Qn([{name:"a_pos",components:2,type:"Int16"}],4),{members:x_}=__;function lg(d,o,c=2){const p=o&&o.length,v=p?o[0]*c:d.length;let m=b_(d,0,v,c,!0);const x=[];if(!m||m.next===m.prev)return x;let M,j,F;if(p&&(m=function(E,N,L,k){const I=[];for(let $=0,Y=N.length;$<Y;$++){const ee=b_(E,N[$]*k,$<Y-1?N[$+1]*k:E.length,k,!1);ee===ee.next&&(ee.steiner=!0),I.push(Fy(ee))}I.sort(LS);for(let $=0;$<I.length;$++)L=AE(I[$],L);return L}(d,o,m,c)),d.length>80*c){M=1/0,j=1/0;let E=-1/0,N=-1/0;for(let L=c;L<v;L+=c){const k=d[L],I=d[L+1];k<M&&(M=k),I<j&&(j=I),k>E&&(E=k),I>N&&(N=I)}F=Math.max(E-M,N-j),F=F!==0?32767/F:0}return cg(m,x,c,M,j,F,0),x}function b_(d,o,c,p,v){let m;if(v===function(x,M,j,F){let E=0;for(let N=M,L=j-F;N<j;N+=F)E+=(x[L]-x[N])*(x[N+1]+x[L+1]),L=N;return E}(d,o,c,p)>0)for(let x=o;x<c;x+=p)m=gt(x/p|0,d[x],d[x+1],m);else for(let x=c-p;x>=o;x-=p)m=gt(x/p|0,d[x],d[x+1],m);return m&&T(m,m.next)&&(At(m),m=m.next),m}function Vp(d,o){if(!d)return d;o||(o=d);let c,p=d;do if(c=!1,p.steiner||!T(p,p.next)&&b(p.prev,p,p.next)!==0)p=p.next;else{if(At(p),p=o=p.prev,p===p.next)break;c=!0}while(c||p!==o);return o}function cg(d,o,c,p,v,m,x){if(!d)return;!x&&m&&function(j,F,E,N){let L=j;do L.z===0&&(L.z=eb(L.x,L.y,F,E,N)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==j);L.prevZ.nextZ=null,L.prevZ=null,function(k){let I,$=1;do{let Y,ee=k;k=null;let oe=null;for(I=0;ee;){I++;let se=ee,ie=0;for(let me=0;me<$&&(ie++,se=se.nextZ,se);me++);let he=$;for(;ie>0||he>0&&se;)ie!==0&&(he===0||!se||ee.z<=se.z)?(Y=ee,ee=ee.nextZ,ie--):(Y=se,se=se.nextZ,he--),oe?oe.nextZ=Y:k=Y,Y.prevZ=oe,oe=Y;ee=se}oe.nextZ=null,$*=2}while(I>1)}(L)}(d,p,v,m);let M=d;for(;d.prev!==d.next;){const j=d.prev,F=d.next;if(m?w_(d,p,v,m):J0(d))o.push(j.i,d.i,F.i),At(d),d=F.next,M=F.next;else if((d=F)===M){x?x===1?cg(d=Q0(Vp(d),o),o,c,p,v,m,2):x===2&&S_(d,o,c,p,v,m):cg(Vp(d),o,c,p,v,m,1);break}}}function J0(d){const o=d.prev,c=d,p=d.next;if(b(o,c,p)>=0)return!1;const v=o.x,m=c.x,x=p.x,M=o.y,j=c.y,F=p.y,E=v<m?v<x?v:x:m<x?m:x,N=M<j?M<F?M:F:j<F?j:F,L=v>m?v>x?v:x:m>x?m:x,k=M>j?M>F?M:F:j>F?j:F;let I=p.next;for(;I!==o;){if(I.x>=E&&I.x<=L&&I.y>=N&&I.y<=k&&ug(v,M,m,j,x,F,I.x,I.y)&&b(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function w_(d,o,c,p){const v=d.prev,m=d,x=d.next;if(b(v,m,x)>=0)return!1;const M=v.x,j=m.x,F=x.x,E=v.y,N=m.y,L=x.y,k=M<j?M<F?M:F:j<F?j:F,I=E<N?E<L?E:L:N<L?N:L,$=M>j?M>F?M:F:j>F?j:F,Y=E>N?E>L?E:L:N>L?N:L,ee=eb(k,I,o,c,p),oe=eb($,Y,o,c,p);let se=d.prevZ,ie=d.nextZ;for(;se&&se.z>=ee&&ie&&ie.z<=oe;){if(se.x>=k&&se.x<=$&&se.y>=I&&se.y<=Y&&se!==v&&se!==x&&ug(M,E,j,N,F,L,se.x,se.y)&&b(se.prev,se,se.next)>=0||(se=se.prevZ,ie.x>=k&&ie.x<=$&&ie.y>=I&&ie.y<=Y&&ie!==v&&ie!==x&&ug(M,E,j,N,F,L,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;se&&se.z>=ee;){if(se.x>=k&&se.x<=$&&se.y>=I&&se.y<=Y&&se!==v&&se!==x&&ug(M,E,j,N,F,L,se.x,se.y)&&b(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;ie&&ie.z<=oe;){if(ie.x>=k&&ie.x<=$&&ie.y>=I&&ie.y<=Y&&ie!==v&&ie!==x&&ug(M,E,j,N,F,L,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function Q0(d,o){let c=d;do{const p=c.prev,v=c.next.next;!T(p,v)&&B(p,c,c.next,v)&&pe(p,v)&&pe(v,p)&&(o.push(p.i,c.i,v.i),At(c),At(c.next),c=d=v),c=c.next}while(c!==d);return Vp(c)}function S_(d,o,c,p,v,m){let x=d;do{let M=x.next.next;for(;M!==x.prev;){if(x.i!==M.i&&T_(x,M)){let j=Le(x,M);return x=Vp(x,x.next),j=Vp(j,j.next),cg(x,o,c,p,v,m,0),void cg(j,o,c,p,v,m,0)}M=M.next}x=x.next}while(x!==d)}function LS(d,o){return d.x-o.x}function AE(d,o){const c=function(v,m){let x=m;const M=v.x,j=v.y;let F,E=-1/0;do{if(j<=x.y&&j>=x.next.y&&x.next.y!==x.y){const $=x.x+(j-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if($<=M&&$>E&&(E=$,F=x.x<x.next.x?x:x.next,$===M))return F}x=x.next}while(x!==m);if(!F)return null;const N=F,L=F.x,k=F.y;let I=1/0;x=F;do{if(M>=x.x&&x.x>=L&&M!==x.x&&ug(j<k?M:E,j,L,k,j<k?E:M,j,x.x,x.y)){const $=Math.abs(j-x.y)/(M-x.x);pe(x,v)&&($<I||$===I&&(x.x>F.x||x.x===F.x&&A_(F,x)))&&(F=x,I=$)}x=x.next}while(x!==N);return F}(d,o);if(!c)return o;const p=Le(c,d);return Vp(p,p.next),Vp(c,c.next)}function A_(d,o){return b(d.prev,d,o.prev)<0&&b(o.next,d,d.next)<0}function eb(d,o,c,p,v){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-c)*v|0)|d<<8))|d<<4))|d<<2))|d<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-p)*v|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Fy(d){let o=d,c=d;do(o.x<c.x||o.x===c.x&&o.y<c.y)&&(c=o),o=o.next;while(o!==d);return c}function ug(d,o,c,p,v,m,x,M){return(v-x)*(o-M)>=(d-x)*(m-M)&&(d-x)*(p-M)>=(c-x)*(o-M)&&(c-x)*(m-M)>=(v-x)*(p-M)}function T_(d,o){return d.next.i!==o.i&&d.prev.i!==o.i&&!function(c,p){let v=c;do{if(v.i!==c.i&&v.next.i!==c.i&&v.i!==p.i&&v.next.i!==p.i&&B(v,v.next,c,p))return!0;v=v.next}while(v!==c);return!1}(d,o)&&(pe(d,o)&&pe(o,d)&&function(c,p){let v=c,m=!1;const x=(c.x+p.x)/2,M=(c.y+p.y)/2;do v.y>M!=v.next.y>M&&v.next.y!==v.y&&x<(v.next.x-v.x)*(M-v.y)/(v.next.y-v.y)+v.x&&(m=!m),v=v.next;while(v!==c);return m}(d,o)&&(b(d.prev,d,o.prev)||b(d,o.prev,o))||T(d,o)&&b(d.prev,d,d.next)>0&&b(o.prev,o,o.next)>0)}function b(d,o,c){return(o.y-d.y)*(c.x-o.x)-(o.x-d.x)*(c.y-o.y)}function T(d,o){return d.x===o.x&&d.y===o.y}function B(d,o,c,p){const v=ce(b(d,o,c)),m=ce(b(d,o,p)),x=ce(b(c,p,d)),M=ce(b(c,p,o));return v!==m&&x!==M||!(v!==0||!X(d,c,o))||!(m!==0||!X(d,p,o))||!(x!==0||!X(c,d,p))||!(M!==0||!X(c,o,p))}function X(d,o,c){return o.x<=Math.max(d.x,c.x)&&o.x>=Math.min(d.x,c.x)&&o.y<=Math.max(d.y,c.y)&&o.y>=Math.min(d.y,c.y)}function ce(d){return d>0?1:d<0?-1:0}function pe(d,o){return b(d.prev,d,d.next)<0?b(d,o,d.next)>=0&&b(d,d.prev,o)>=0:b(d,o,d.prev)<0||b(d,d.next,o)<0}function Le(d,o){const c=Ht(d.i,d.x,d.y),p=Ht(o.i,o.x,o.y),v=d.next,m=o.prev;return d.next=o,o.prev=d,c.next=v,v.prev=c,p.next=c,c.prev=p,m.next=p,p.prev=m,p}function gt(d,o,c,p){const v=Ht(d,o,c);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function At(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function Ht(d,o,c){return{i:d,x:o,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ar(d,o){const c=d.length;if(c<=1)return[d];const p=[];let v,m;for(let x=0;x<c;x++){const M=ku(d[x]);M!==0&&(d[x].area=Math.abs(M),m===void 0&&(m=M<0),m===M<0?(v&&p.push(v),v=[d[x]]):v.push(d[x]))}if(v&&p.push(v),o>1)for(let x=0;x<p.length;x++)p[x].length<=o||(sp(p[x],o,1,p[x].length-1,Mr),p[x]=p[x].slice(0,o));return p}function Mr(d,o){return o.area-d.area}function Tr(d,o,c=1){if(!d)return null;const p=typeof d=="string"?d:d.getPrimary().id;o[p]||(o[p]=[]);const v=To.from(p).getPrimary().scaleSelf(c);return o[p].push(v),v.serialize()}function Jr(d,o,c,p){const v=p.patternDependencies;let m=!1;for(const x of o){const M=x.paint.get(`${d}-pattern`);M.isConstant()||(m=!0),Tr(M.constantOr(null),v,c)&&(m=!0)}return m}function sn(d,o,c,p,v,m){const x=m.patternDependencies;for(const M of o){const j=M.paint.get(`${d}-pattern`).value;if(j.kind!=="constant"){let F=j.evaluate({zoom:p},c,{},m.availableImages);F=F&&F.name?F.name:F;const E=Tr(F,x,v);E&&(c.patterns[M.id]=E)}}return c}class cn{constructor(o){this.zoom=o.zoom,this.pixelRatio=o.pixelRatio,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new As,this.indexArray=new go,this.indexArray2=new Eo,this.programConfigurations=new cu(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new va,this.segments2=new va,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.projection=o.projection}updateFootprints(o,c){}populate(o,c,p,v){this.hasPattern=Jr("fill",this.layers,this.pixelRatio,c);const m=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:M,id:j,index:F,sourceLayerIndex:E}of o){const N=this.layers[0]._featureFilter.needGeometry,L=te(M,N);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),L,p))continue;const k=m?m.evaluate(L,{},p,c.availableImages):void 0,I={id:j,properties:M.properties,type:M.type,sourceLayerIndex:E,index:F,geometry:N?L.geometry:Z(M,p,v),patterns:{},sortKey:k};x.push(I)}m&&x.sort((M,j)=>M.sortKey-j.sortKey);for(const M of x){const{geometry:j,index:F,sourceLayerIndex:E}=M;if(this.hasPattern){const N=sn("fill",this.layers,M,this.zoom,this.pixelRatio,c);this.patternFeatures.push(N)}else this.addFeature(M,j,F,p,{},c.availableImages,c.brightness,c.elevationFeatures);c.featureIndex.insert(o[F].feature,j,F,E,this.index)}}update(o,c,p,v,m,x,M){this.programConfigurations.updatePaintArrays(o,c,m,p,v,x,M)}addFeatures(o,c,p,v,m,x){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,c,p,v,x,o.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,x_),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,c,p,v,m,x=[],M,j){for(const F of Ar(c,500)){let E=0;for(const Y of F)E+=Y.length;const N=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),L=N.vertexLength,k=[],I=[];for(const Y of F){if(Y.length===0)continue;Y!==F[0]&&I.push(k.length/2);const ee=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),oe=ee.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(oe+Y.length-1,oe),k.push(Y[0].x),k.push(Y[0].y);for(let se=1;se<Y.length;se++)this.layoutVertexArray.emplaceBack(Y[se].x,Y[se].y),this.indexArray2.emplaceBack(oe+se-1,oe+se),k.push(Y[se].x),k.push(Y[se].y);ee.vertexLength+=Y.length,ee.primitiveLength+=Y.length}const $=lg(k,I);for(let Y=0;Y<$.length;Y+=3)this.indexArray.emplaceBack(L+$[Y],L+$[Y+1],L+$[Y+2]);N.vertexLength+=E,N.primitiveLength+=$.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,m,x,v,M)}}let vo,Ft,Rt,$t;hr(cn,"FillBucket",{omit:["layers","patternFeatures"]});class kr{constructor(o,c,p,v){if(this.triangleCount=c.length/3,this.min=new It(0,0),this.max=new It(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||o.length===0)return;const[m,x]=[o[0].clone(),o[0].clone()];for(let N=1;N<o.length;++N){const L=o[N];m.x=Math.min(m.x,L.x),m.y=Math.min(m.y,L.y),x.x=Math.max(x.x,L.x),x.y=Math.max(x.y,L.y)}if(v){const N=Math.ceil(Math.max(x.x-m.x,x.y-m.y)/v);p=Math.max(p,N)}if(p===0)return;this.min=m,this.max=x;const M=this.max.sub(this.min);M.x=Math.max(M.x,1),M.y=Math.max(M.y,1);const j=Math.max(M.x,M.y)/p;this.cellsX=Math.max(1,Math.ceil(M.x/j)),this.cellsY=Math.max(1,Math.ceil(M.y/j)),this.xScale=1/j,this.yScale=1/j;const F=[];for(let N=0;N<this.triangleCount;N++){const L=o[c[3*N+0]].sub(this.min),k=o[c[3*N+1]].sub(this.min),I=o[c[3*N+2]].sub(this.min),$=tn(Math.floor(Math.min(L.x,k.x,I.x)),this.xScale,this.cellsX),Y=tn(Math.floor(Math.max(L.x,k.x,I.x)),this.xScale,this.cellsX),ee=tn(Math.floor(Math.min(L.y,k.y,I.y)),this.yScale,this.cellsY),oe=tn(Math.floor(Math.max(L.y,k.y,I.y)),this.yScale,this.cellsY),se=new It(0,0),ie=new It(0,0),he=new It(0,0),me=new It(0,0);for(let be=ee;be<=oe;++be){se.y=ie.y=be*j,he.y=me.y=(be+1)*j;for(let Re=$;Re<=Y;++Re)se.x=he.x=Re*j,ie.x=me.x=(Re+1)*j,(pt(L,k,I,se,ie,me)||pt(L,k,I,se,me,he))&&F.push({cellIdx:be*this.cellsX+Re,triIdx:N})}}if(F.length===0)return;F.sort((N,L)=>N.cellIdx-L.cellIdx||N.triIdx-L.triIdx);let E=0;for(;E<F.length;){const N=F[E].cellIdx,L={start:this.payload.length,len:0};for(;E<F.length&&F[E].cellIdx===N;)++L.len,this.payload.push(F[E++].triIdx);this.cells[N]=L}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,c){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const p=tn(o.x-this.min.x,this.xScale,this.cellsX),v=tn(o.y-this.min.y,this.yScale,this.cellsY),m=this.cells[v*this.cellsX+p];if(m){this._lazyInitLookup();for(let x=0;x<m.len;x++){const M=this.payload[m.start+x],j=Math.floor(M/8),F=1<<M%8;if(!(this.lookup[j]&F)&&(this.lookup[j]|=F,c.push(M),c.length===this.triangleCount))return}}}query(o,c,p){if(this.triangleCount===0||this.cells.length===0||o.x>this.max.x||this.min.x>c.x||o.y>this.max.y||this.min.y>c.y)return;this._lazyInitLookup();const v=tn(o.x-this.min.x,this.xScale,this.cellsX),m=tn(c.x-this.min.x,this.xScale,this.cellsX),x=tn(o.y-this.min.y,this.yScale,this.cellsY),M=tn(c.y-this.min.y,this.yScale,this.cellsY);for(let j=x;j<=M;j++)for(let F=v;F<=m;F++){const E=this.cells[j*this.cellsX+F];if(E)for(let N=0;N<E.len;N++){const L=this.payload[E.start+N],k=Math.floor(L/8),I=1<<L%8;if(!(this.lookup[k]&I)&&(this.lookup[k]|=I,p.push(L),p.length===this.triangleCount))return}}}}function tn(d,o,c){return Math.max(0,Math.min(c-1,Math.floor(d*o)))}hr(kr,"TriangleGridIndex");class kn{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.footprints=[]}updateFootprints(o,c){for(const p of this.footprints)c.push({footprint:p,id:o})}populate(o,c,p,v){const m=[];for(const{feature:x,id:M,index:j,sourceLayerIndex:F}of o){const E=this.layers[0]._featureFilter.needGeometry,N=te(x,E);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),N,p))continue;const L={id:M,properties:x.properties,type:x.type,sourceLayerIndex:F,index:j,geometry:E?N.geometry:Z(x,p,v),patterns:{}};m.push(L)}for(const x of m){const{geometry:M,index:j,sourceLayerIndex:F}=x;this.addFeature(x,M,j,p,{},c.availableImages,c.brightness),c.featureIndex.insert(o[j].feature,M,j,F,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(o){}update(o,c,p,v,m,x,M){}destroy(){}addFeature(o,c,p,v,m,x=[],M){for(const j of Ar(c,2)){const F=[],E=[],N=[],L=new It(1/0,1/0),k=new It(-1/0,-1/0);for(const Y of j)if(Y.length!==0){Y!==j[0]&&N.push(E.length/2);for(let ee=0;ee<Y.length;ee++)E.push(Y[ee].x),E.push(Y[ee].y),F.push(Y[ee]),L.x=Math.min(L.x,Y[ee].x),L.y=Math.min(L.y,Y[ee].y),k.x=Math.max(k.x,Y[ee].x),k.y=Math.max(k.y,Y[ee].y)}const I=lg(E,N),$=new kr(F,I,8,256);this.footprints.push({vertices:F,indices:I,grid:$,min:L,max:k})}}}hr(kn,"ClipBucket",{omit:["layers"]});const In=Qn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),si=Qn([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),ds=Qn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Hi=Qn([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Cf=Qn([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),TE=Qn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:hie}=In;var PE,q4,EE,G4,CE,K4,W4,zS={};function H4(){if(q4)return PE;q4=1;var d=Sn();function o(v,m,x,M,j){this.properties={},this.extent=x,this.type=0,this._pbf=v,this._geometry=-1,this._keys=M,this._values=j,v.readFields(c,this,m)}function c(v,m,x){v==1?m.id=x.readVarint():v==2?function(M,j){for(var F=M.readVarint()+M.pos;M.pos<F;){var E=j._keys[M.readVarint()],N=j._values[M.readVarint()];j.properties[E]=N}}(x,m):v==3?m.type=x.readVarint():v==4&&(m._geometry=x.pos)}function p(v){for(var m,x,M=0,j=0,F=v.length,E=F-1;j<F;E=j++)M+=((x=v[E]).x-(m=v[j]).x)*(m.y+x.y);return M}return PE=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var m,x=v.readVarint()+v.pos,M=1,j=0,F=0,E=0,N=[];v.pos<x;){if(j<=0){var L=v.readVarint();M=7&L,j=L>>3}if(j--,M===1||M===2)F+=v.readSVarint(),E+=v.readSVarint(),M===1&&(m&&N.push(m),m=[]),m.push(new d(F,E));else{if(M!==7)throw new Error("unknown command "+M);m&&m.push(m[0].clone())}}return m&&N.push(m),N},o.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var m=v.readVarint()+v.pos,x=1,M=0,j=0,F=0,E=1/0,N=-1/0,L=1/0,k=-1/0;v.pos<m;){if(M<=0){var I=v.readVarint();x=7&I,M=I>>3}if(M--,x===1||x===2)(j+=v.readSVarint())<E&&(E=j),j>N&&(N=j),(F+=v.readSVarint())<L&&(L=F),F>k&&(k=F);else if(x!==7)throw new Error("unknown command "+x)}return[E,L,N,k]},o.prototype.toGeoJSON=function(v,m,x){var M,j,F=this.extent*Math.pow(2,x),E=this.extent*v,N=this.extent*m,L=this.loadGeometry(),k=o.types[this.type];function I(ee){for(var oe=0;oe<ee.length;oe++){var se=ee[oe];ee[oe]=[360*(se.x+E)/F-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+N)/F)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(M=0;M<L.length;M++)$[M]=L[M][0];I(L=$);break;case 2:for(M=0;M<L.length;M++)I(L[M]);break;case 3:for(L=function(ee){var oe=ee.length;if(oe<=1)return[ee];for(var se,ie,he=[],me=0;me<oe;me++){var be=p(ee[me]);be!==0&&(ie===void 0&&(ie=be<0),ie===be<0?(se&&he.push(se),se=[ee[me]]):se.push(ee[me]))}return se&&he.push(se),he}(L),M=0;M<L.length;M++)for(j=0;j<L[M].length;j++)I(L[M][j])}L.length===1?L=L[0]:k="Multi"+k;var Y={type:"Feature",geometry:{type:k,coordinates:L},properties:this.properties};return"id"in this&&(Y.id=this.id),Y},PE}function Z4(){if(G4)return EE;G4=1;var d=H4();function o(p,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(c,this,v),this.length=this._features.length}function c(p,v,m){p===15?v.version=m.readVarint():p===1?v.name=m.readString():p===5?v.extent=m.readVarint():p===2?v._features.push(m.pos):p===3?v._keys.push(m.readString()):p===4&&v._values.push(function(x){for(var M=null,j=x.readVarint()+x.pos;x.pos<j;){var F=x.readVarint()>>3;M=F===1?x.readString():F===2?x.readFloat():F===3?x.readDouble():F===4?x.readVarint64():F===5?x.readVarint():F===6?x.readSVarint():F===7?x.readBoolean():null}return M}(m))}return EE=o,o.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var v=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,v,this.extent,this._keys,this._values)},EE}function Y4(){return W4||(W4=1,zS.VectorTile=function(){if(K4)return CE;K4=1;var d=Z4();function o(c,p,v){if(c===3){var m=new d(v,v.readVarint()+v.pos);m.length&&(p[m.name]=m)}}return CE=function(c,p){this.layers=c.readFields(o,{},p)},CE}(),zS.VectorTileFeature=H4(),zS.VectorTileLayer=Z4()),zS}var P_=Y4();class By extends It{constructor(o,c,p){super(o,c),this.z=p}}class X4 extends By{constructor(o,c,p,v){super(o,c,p),this.w=v}}function FS(d,o,c,p){const v=[],m=p===0?(x,M,j,F,E,N)=>{x.push(new It(N,j+(N-M)/(F-M)*(E-j)))}:(x,M,j,F,E,N)=>{x.push(new It(M+(N-j)/(E-j)*(F-M),N))};for(const x of d){const M=[];for(const j of x){if(j.length<=2)continue;const F=[];for(let L=0;L<j.length-1;L++){const k=j[L].x,I=j[L].y,$=j[L+1].x,Y=j[L+1].y,ee=p===0?k:I,oe=p===0?$:Y;ee<o?oe>o&&m(F,k,I,$,Y,o):ee>c?oe<c&&m(F,k,I,$,Y,c):F.push(j[L]),oe<o&&ee>=o&&m(F,k,I,$,Y,o),oe>c&&ee<=c&&m(F,k,I,$,Y,c)}let E=j[j.length-1];const N=p===0?E.x:E.y;N>=o&&N<=c&&F.push(E),F.length&&(E=F[F.length-1],F[0].x===E.x&&F[0].y===E.y||F.push(F[0]),M.push(F))}M.length&&v.push(M)}return v}function J4(d,o,c,p){const v=c==="x"?"y":"x",m=(p-d[c])/(o[c]-d[c]);d[v]=d[v]+(o[v]-d[v])*m,d[c]=p,d.hasOwnProperty("z")&&(d.z=Dr(d.z,o.z,m)),d.hasOwnProperty("w")&&(d.w=Dr(d.w,o.w,m))}function Q4(d,o,c,p){const v=c,m=p;for(const x of["x","y"]){let M=d,j=o;M[x]>=j[x]&&(M=o,j=d),M[x]<v&&j[x]>v&&J4(M,j,x,v),M[x]<m&&j[x]>m&&J4(j,M,x,m)}}const BS=Number.MAX_SAFE_INTEGER;function ez(d,o,c,p){return d.order<o||d.order===BS||!(d.clipMask&c)||function(v,m){return m.length!==0&&m.find(x=>x===v)===void 0}(p,d.clipScope)}function VS(d,o){return d.x-o.x||d.y-o.y}function tz(d,o){return VS(d.min,o.min)===0&&VS(d.max,o.max)===0}function ME(d,o){return!(d.min.x>o.max.x||d.max.x<o.min.x||d.min.y>o.max.y||d.max.y<o.min.y)}function OE(d,o){if(d.length!==o.length)return!1;for(let c=0;c<d.length;c++)if(d[c].sourceId!==o[c].sourceId||!tz(d[c],o[c])||d[c].order!==o[c].order||d[c].clipMask!==o[c].clipMask||!Vn(d[c].clipScope,o[c].clipScope))return!1;return!0}function rz(d,o,c){const p=1/ar,v=1/(1<<c.canonical.z),m=(o.x*p+c.canonical.x)*v+c.wrap,x=(o.y*p+c.canonical.y)*v;return{min:new It((d.x*p+c.canonical.x)*v+c.wrap,(d.y*p+c.canonical.y)*v),max:new It(m,x)}}function fie(d,o,c){const p=1<<c.canonical.z,v=((o.x-c.wrap)*p-c.canonical.x)*ar,m=(o.y*p-c.canonical.y)*ar;return{min:new It(((d.x-c.wrap)*p-c.canonical.x)*ar,(d.y*p-c.canonical.y)*ar),max:new It(v,m)}}function nz(d,o,c,p,v,m,x){const M=d.indices,j=d.vertices,F=[];for(let E=p;E<p+v;E+=3){const N=o[c[E+0]+m],L=o[c[E+1]+m],k=o[c[E+2]+m],I=Math.min(N.x,L.x,k.x),$=Math.max(N.x,L.x,k.x),Y=Math.min(N.y,L.y,k.y),ee=Math.max(N.y,L.y,k.y);F.length=0,d.grid.query(new It(I,Y),new It($,ee),F);for(let oe=0;oe<F.length;oe++){const se=F[oe];if(pt(j[M[3*se+0]],j[M[3*se+1]],j[M[3*se+2]],N,L,k,x))return!0}}return!1}function iz(d,o,c,p){if(!d||!c)return!1;let v=d.vertices;if(!o.canonical.equals(p.canonical)||o.wrap!==p.wrap){if(c.vertices.length<d.vertices.length)return iz(c,p,d,o);const m=o.canonical,x=p.canonical,M=Math.pow(2,x.z-m.z);v=d.vertices.map(j=>new It((j.x+m.x*ar)*M-x.x*ar,(j.y+m.y*ar)*M-x.y*ar))}return nz(c,v,d.indices,0,d.indices.length,0,0)}function az(d,o,c,p){const v=Math.pow(2,p.z-c.z);return new It((d+c.x*ar)*v-p.x*ar,(o+c.y*ar)*v-p.y*ar)}function oz(d,o){const c=[];o.grid.queryPoint(d,c);const p=o.indices,v=o.vertices;for(let m=0;m<c.length;m++){const x=c[m];if(Ve([v[p[3*x+0]],v[p[3*x+1]],v[p[3*x+2]]],d))return!0}return!1}const RE=[new It(0,0),new It(ar,0),new It(ar,ar),new It(0,ar)];function sz(d,o){const c=[];let p=[];if(!o||d.length<2)return[d];if(d.length===2)return it(d[0],d[1],RE)?[d]:[];for(let v=0;v<d.length+2;v++){const m=d[v%d.length],x=d[(v+1)%d.length],M=it(v===0?d[d.length-1]:d[(v-1)%d.length],m,RE),j=it(m,x,RE),F=M||j;F&&p.push(m),F&&j||p.length>0&&(p.length>1&&c.push(p),p=[])}return p.length>1&&c.push(p),c}const kE=P_.VectorTileFeature.types,pie=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],mie=["fill-extrusion-flood-light-ground-radius"],gie=Math.pow(2,13),yie=Math.pow(2,15)-1,lz=new It(0,1),dg=2147483648;function tb(d,o,c,p,v,m,x,M){d.emplaceBack((o<<1)+x,(c<<1)+m,(Math.floor(p*gie)<<1)+v,Math.round(M))}function rb(d,o,c){d.emplaceBack(o.x*ar,o.y*ar,c?1:0)}function US(d,o,c,p,v,m){d.emplaceBack(o.x,o.y,(c.x<<1)+p,(c.y<<1)+v,m)}function nb(d,o,c){d.emplaceBack(o.x,o.y,o.z,c[0]*16384,c[1]*16384,c[2]*16384)}class cz{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class uz{constructor(){this.centroidXY=new It(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new It(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new It(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new It(this.max.x-this.min.x,this.max.y-this.min.y)}}class dz{constructor(){this.acc=new It(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,c){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=c.x,o.min.y=o.max.y=c.y)}appendEdge(o,c,p){this.accCount++,this.acc._add(c);let v=!!this.borders;c.x<o.min.x?(o.min.x=c.x,v=!0):c.x>o.max.x&&(o.max.x=c.x,v=!0),c.y<o.min.y?(o.min.y=c.y,v=!0):c.y>o.max.y&&(o.max.y=c.y,v=!0),((c.x===0||c.x===ar)&&c.x===p.x)!=((c.y===0||c.y===ar)&&c.y===p.y)&&this.processBorderOverlap(c,p),v&&this.checkBorderIntersection(c,p)}checkBorderIntersection(o,c){c.x<0!=o.x<0&&this.addBorderIntersection(0,Dr(c.y,o.y,(0-c.x)/(o.x-c.x))),c.x>ar!=o.x>ar&&this.addBorderIntersection(1,Dr(c.y,o.y,(ar-c.x)/(o.x-c.x))),c.y<0!=o.y<0&&this.addBorderIntersection(2,Dr(c.x,o.x,(0-c.y)/(o.y-c.y))),c.y>ar!=o.y>ar&&this.addBorderIntersection(3,Dr(c.x,o.x,(ar-c.y)/(o.y-c.y)))}addBorderIntersection(o,c){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[o];c<p[0]&&(p[0]=c),c>p[1]&&(p[1]=c)}processBorderOverlap(o,c){if(o.x===c.x){if(o.y===c.y)return;const p=o.x===0?0:1;this.addBorderIntersection(p,c.y),this.addBorderIntersection(p,o.y)}else{const p=o.y===0?2:3;this.addBorderIntersection(p,c.x),this.addBorderIntersection(p,o.x)}}centroid(){return this.accCount===0?new It(0,0):new It(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,c)=>o+ +(c[0]!==Number.MAX_VALUE),0):0}}function hz(d,o){const c=d.add(o)._unit(),p=dr(d.x*c.x+d.y*c.y,-1,1);var v,m,x;return x=Math.acos(p),Math.min(4,Math.max(-4,Math.tan(x)))/4*yie*((v=d).x*(m=o).y-v.y*m.x<0?-1:1)}const vie=[d=>d.x<0,d=>d.x>ar,d=>d.y<0,d=>d.y>ar];function _ie(d,o,c,p){const v=[4];if(p===0)return v;c._mult(p);const m=d.sub(c),x=o.sub(c),M=[d,o,m,x];for(let j=0;j<4;j++)for(const F of M)if(vie[j](F)){v.push(j);break}return v}class fz{constructor(o){this.vertexArray=new ro,this.indexArray=new go,this.programConfigurations=new cu(o.layers,{zoom:o.zoom,lut:o.lut},c=>mie.includes(c)),this._segments=new va,this.hiddenByLandmarkVertexArray=new kp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new va}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(o,c,p,v=!1){const m=o.length;if(m>2){let x=Math.max(0,this._segments.get().length-1);const M=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[x].length);let j;x!==this._segments.get().length-1&&(x++,this._segmentToGroundQuads[x]=[],this._segmentToRegionTriCounts[x]=[0,0,0,0,0]);{const F=o[0],E=o[1];j=hz(F.sub(o[m-1])._perp()._unit(),E.sub(F)._perp()._unit())}for(let F=0;F<m;F++){const E=F===m-1?0:F+1,N=o[F],L=o[E],k=o[E===m-1?0:E+1],I=L.sub(N)._perp()._unit(),$=hz(I,k.sub(L)._perp()._unit()),Y=j,ee=$;if(jE(N,L,c)||v&&gz(N,c)&&gz(L,c)){j=$;continue}const oe=M.vertexLength;US(this.vertexArray,N,L,1,1,Y),US(this.vertexArray,N,L,1,0,Y),US(this.vertexArray,N,L,0,1,ee),US(this.vertexArray,N,L,0,0,ee),M.vertexLength+=4;const se=_ie(N,L,I,p);for(const ie of se)this._segmentToGroundQuads[x].push({id:oe,region:ie}),this._segmentToRegionTriCounts[x][ie]+=2,M.primitiveLength+=2;j=$}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),c=o.length;for(let p=0;p<c;p++)this._segmentToGroundQuads[p].sort((v,m)=>v.region-m.region);for(let p=0;p<c;p++){const v=this._segmentToGroundQuads[p],m=o[p],x=this._segmentToRegionTriCounts[p];x.reduce((j,F)=>j+F,0);let M=0;for(let j=0;j<=4;j++){const F=x[j];if(F!==0){let E=this.regionSegments[j];E||(E=this.regionSegments[j]=new va);const N={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+M,vertexLength:m.vertexLength,primitiveLength:F};E.get().push(N)}M+=F}for(let j=0;j<v.length;j++){const F=v[j].id;this.indexArray.emplaceBack(F,F+1,F+3),this.indexArray.emplaceBack(F,F+3,F+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,c,p,v,m,x){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,c,p,v,m,x)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,si.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,c,p,v,m,x,M){this.hasData()&&this.programConfigurations.updatePaintArrays(o,c,p,v,m,x,M)}updateHiddenByLandmark(o){if(!this.hasData())return;const c=o.groundVertexCount+o.groundVertexArrayOffset;if(o.groundVertexCount===0)return;const p=o.flags&dg?1:0;for(let v=o.groundVertexArrayOffset;v<c;++v)this.hiddenByLandmarkVertexArray.emplace(v,p);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,Cf.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const c=this.regionSegments[o];c&&c.destroy()}}}}class $S{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.pixelRatio=o.pixelRatio,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new go,this.footprintVertices=new As,this.footprintSegments=[],this.layoutVertexArray=new ua,this.centroidVertexArray=new Ts,this.wallVertexArray=new ky,this.indexArray=new go,this.programConfigurations=new cu(o.layers,{zoom:o.zoom,lut:o.lut},c=>pie.includes(c)),this.segments=new va,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.groundEffect=new fz(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,c){}populate(o,c,p,v){this.features=[],this.hasPattern=Jr("fill-extrusion",this.layers,this.pixelRatio,c),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=s(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:x,index:M,sourceLayerIndex:j}of o){const F=this.layers[0]._featureFilter.needGeometry,E=te(m,F);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),E,p))continue;const N={id:x,sourceLayerIndex:j,index:M,geometry:F?E.geometry:Z(m,p,v),properties:m.properties,type:m.type,patterns:{}},L=this.layoutVertexArray.length,k=kE[N.type]==="Polygon";if(this.hasPattern)this.features.push(sn("fill-extrusion",this.layers,N,this.zoom,this.pixelRatio,c));else if(this.wallMode)for(const I of N.geometry)for(const $ of sz(I,k))this.addFeature(N,[$],M,p,{},c.availableImages,v,c.brightness);else this.addFeature(N,N.geometry,M,p,{},c.availableImages,v,c.brightness);c.featureIndex.insert(m,N.geometry,M,j,this.index,L)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,c,p,v,m,x){for(const M of this.features){const j=kE[M.type]==="Polygon",{geometry:F}=M;if(this.wallMode)for(const E of F)for(const N of sz(E,j))this.addFeature(M,[N],M.index,c,p,v,m,x);else this.addFeature(M,F,M.index,c,p,v,m,x)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(o,c,p,v,m,x,M){this.programConfigurations.updatePaintArrays(o,c,m,p,v,x,M),this.groundEffect.update(o,c,m,p,v,x,M)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,hie),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,Hi.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,TE.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,ds.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,c,p,v,m,x,M,j){const F=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,E=[new It(0,0),new It(ar,ar)],N=M.projection,L=N.name==="globe",k=this.wallMode||kE[o.type]==="Polygon",I=new dz;I.centroidDataIndex=this.centroidData.length;const $=new uz,Y=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},v)<=0,ee=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},v);let oe;if($.height=ee,$.vertexArrayOffset=this.layoutVertexArray.length,$.groundVertexArrayOffset=this.groundEffect.vertexArray.length,L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new mo),this.wallMode){if(L)return void rn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(c.length!==1)return;oe=function(Ce){const Xe=Ce[0].x===Ce[Ce.length-1].x&&Ce[0].y===Ce[Ce.length-1].y;(function(Xt){let Ut=0;const Er=Xt.length;for(let pr=0;pr<Er;pr++)Ut+=(Xt[(pr+1)%Er].x-Xt[pr].x)*(Xt[(pr+1)%Er].y+Xt[pr].y);return Ut>=0})(Ce)||(Ce=Ce.reverse());const Qe={geometry:[],joinNormals:[],indices:[]},ot=[],nt=[],lt=[];let dt=Ce.length;for(;dt>=2&&Ce[dt-1].equals(Ce[dt-2]);)dt--;if(dt<(Xe?3:2))return Qe;let yt,ct,jt,Vt,kt,cr=0;for(;cr<dt-1&&Ce[cr].equals(Ce[cr+1]);)cr++;Xe&&(yt=Ce[dt-2],kt=Ce[cr].sub(yt)._unit()._perp());for(let Xt=cr;Xt<dt;Xt++){if(jt=Xt===dt-1?Xe?Ce[cr+1]:void 0:Ce[Xt+1],jt&&Ce[Xt].equals(jt))continue;kt&&(Vt=kt),yt&&(ct=yt),yt=Ce[Xt],kt=jt?jt.sub(yt)._unit()._perp():Vt,Vt=Vt||kt;let Ut=Vt.add(kt);Ut.x===0&&Ut.y===0||Ut._unit();const Er=Ut.x*kt.x+Ut.y*kt.y,pr=Er!==0?1/Er:1/0,vr=Vt.x*kt.y-Vt.y*kt.x>0;let Qr="miter";const fn=2;Qr==="miter"&&pr>fn&&(Qr="bevel"),Qr==="bevel"&&(pr>100&&(Qr="flipbevel"),pr<fn&&(Qr="miter"));const gn=(yn,On,jn,Li)=>{const Si=new It(yn.x,yn.y),ln=new It(yn.x,yn.y);Si.x+=On.x*Li,Si.y+=On.y*Li,ln.x-=On.x*Math.max(jn,1),ln.y-=On.y*Math.max(jn,1),lt.push(On),ot.push(Si),nt.push(ln)};if(Qr==="miter")Ut._mult(pr),gn(yt,Ut,0,0);else if(Qr==="flipbevel")Ut=kt.mult(-1),gn(yt,Ut,0,0),gn(yt,Ut.mult(-1),0,0);else{const yn=-Math.sqrt(pr*pr-1),On=vr?yn:0,jn=vr?0:yn;ct&&gn(yt,Vt,On,jn),jt&&gn(yt,kt,On,jn)}}Qe.geometry=[...ot,...nt.reverse(),ot[0]],Qe.joinNormals=[...lt,...lt.reverse(),lt[lt.length-1]];const ir=Qe.geometry.length-1;for(let Xt=0;Xt<ir/2;Xt++)if(Xt+1<ir/2){let Ut=Xt,Er=Xt+1,pr=ir-1-Xt,vr=ir-2-Xt;Ut=Ut===0?ir-1:Ut-1,Er=Er===0?ir-1:Er-1,pr=pr===0?ir-1:pr-1,vr=vr===0?ir-1:vr-1,Qe.indices.push(pr),Qe.indices.push(Er),Qe.indices.push(Ut),Qe.indices.push(pr),Qe.indices.push(vr),Qe.indices.push(Er)}return Qe}(c[0]),c=[oe.geometry]}const se=(Ce,Xe)=>Ce<(Xe.length-1)/2||Ce===Xe.length-1,ie=this.wallMode?[c]:Ar(c,500);for(let Ce=ie.length-1;Ce>=0;Ce--){const Xe=ie[Ce];(Xe.length===0||(he=Xe[0]).every(Ie=>Ie.x<=0)||he.every(Ie=>Ie.x>=ar)||he.every(Ie=>Ie.y<=0)||he.every(Ie=>Ie.y>=ar))&&ie.splice(Ce,1)}var he;let me;if(L)me=xz(ie,E,v);else{me=[];for(const Ce of ie)me.push({polygon:Ce,bounds:E})}const be=k?this.edgeRadius:0,Re=be>0&&this.zoom<17,Me=(Ce,Xe)=>{if(Ce.length===0)return!1;const Ie=Ce[Ce.length-1];return Xe.x===Ie.x&&Xe.y===Ie.y};for(const{polygon:Ce,bounds:Xe}of me){let Ie=0,Qe=0;for(const dt of Ce)k&&!dt[0].equals(dt[dt.length-1])&&dt.push(dt[0]),Qe+=k?dt.length-1:dt.length;const ot=this.segments.prepareSegment((k?5:4)*Qe,this.layoutVertexArray,this.indexArray);$.footprintSegIdx<0&&($.footprintSegIdx=this.footprintSegments.length),$.polygonSegIdx<0&&($.polygonSegIdx=this.polygonSegments.length);const nt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},lt=new cz;if(lt.vertexOffset=this.footprintVertices.length,lt.indexOffset=3*this.footprintIndices.length,lt.ringIndices=[],k){const dt=[],yt=[];Ie=ot.vertexLength;for(let jt=0;jt<Ce.length;jt++){const Vt=Ce[jt];Vt.length&&jt!==0&&yt.push(dt.length/2);const kt=[];let cr,ir;cr=Vt[1].sub(Vt[0])._perp()._unit(),lt.ringIndices.push(Vt.length-1);for(let Xt=1;Xt<Vt.length;Xt++){const Ut=Vt[Xt],Er=Vt[Xt===Vt.length-1?1:Xt+1],pr=Ut.clone();if(be){ir=Er.sub(Ut)._perp()._unit();const vr=cr.add(ir)._unit(),Qr=be*Math.min(4,1/(cr.x*vr.x+cr.y*vr.y));pr.x+=Qr*vr.x,pr.y+=Qr*vr.y,pr.x=Math.round(pr.x),pr.y=Math.round(pr.y),cr=ir}if(!Y||be!==0&&!Re||Me(kt,pr)||kt.push(pr),tb(this.layoutVertexArray,pr.x,pr.y,0,0,1,1,0),this.wallMode){const vr=se(Xt,Vt);rb(this.wallVertexArray,oe.joinNormals[Xt],!vr)}ot.vertexLength++,this.footprintVertices.emplaceBack(Ut.x,Ut.y),dt.push(Ut.x,Ut.y),L&&nb(this.layoutVertexExtArray,N.projectTilePoint(pr.x,pr.y,v),N.upVector(v,pr.x,pr.y))}Y&&(be===0||Re)&&(kt.length!==0&&Me(kt,kt[0])&&kt.pop(),this.groundEffect.addData(kt,Xe,F))}const ct=this.wallMode?oe.indices:lg(dt,yt);for(let jt=0;jt<ct.length;jt+=3)this.footprintIndices.emplaceBack(lt.vertexOffset+ct[jt+0],lt.vertexOffset+ct[jt+1],lt.vertexOffset+ct[jt+2]),this.indexArray.emplaceBack(Ie+ct[jt],Ie+ct[jt+2],Ie+ct[jt+1]),ot.primitiveLength++;lt.indexCount+=ct.length,lt.vertexCount+=this.footprintVertices.length-lt.vertexOffset}for(let dt=0;dt<Ce.length;dt++){const yt=Ce[dt];I.startRing($,yt[0]);let ct=yt.length>4&&yz(yt[yt.length-2],yt[0],yt[1]),jt=be?xie(yt[yt.length-2],yt[0],yt[1],be):0;const Vt=[];let kt,cr,ir;cr=yt[1].sub(yt[0])._perp()._unit();let Xt=!0;for(let Ut=1,Er=0;Ut<yt.length;Ut++){let pr=yt[Ut-1],vr=yt[Ut];const Qr=yt[Ut===yt.length-1?1:Ut+1];if(I.appendEdge($,vr,pr),jE(vr,pr,Xe)){be&&(cr=Qr.sub(vr)._perp()._unit(),Xt=!Xt);continue}const fn=vr.sub(pr)._perp(),gn=fn.x/(Math.abs(fn.x)+Math.abs(fn.y)),yn=fn.y>0?1:0,On=pr.dist(vr);if(Er+On>32768&&(Er=0),be){ir=Qr.sub(vr)._perp()._unit();let ln=mz(pr,vr,Qr,pz(cr,ir),be);isNaN(ln)&&(ln=0);const gi=vr.sub(pr)._unit();pr=pr.add(gi.mult(jt))._round(),vr=vr.add(gi.mult(-ln))._round(),jt=ln,cr=ir,Y&&this.zoom>=17&&(Me(Vt,pr)||Vt.push(pr),Me(Vt,vr)||Vt.push(vr))}const jn=ot.vertexLength,Li=yt.length>4&&yz(pr,vr,Qr);let Si=vz(Er,ct,Xt);if(tb(this.layoutVertexArray,pr.x,pr.y,gn,yn,0,0,Si),tb(this.layoutVertexArray,pr.x,pr.y,gn,yn,0,1,Si),this.wallMode){const ln=se(Ut-1,yt),gi=oe.joinNormals[Ut-1];rb(this.wallVertexArray,gi,ln),rb(this.wallVertexArray,gi,ln)}if(Er+=On,Si=vz(Er,Li,!Xt),ct=Li,tb(this.layoutVertexArray,vr.x,vr.y,gn,yn,0,0,Si),tb(this.layoutVertexArray,vr.x,vr.y,gn,yn,0,1,Si),this.wallMode){const ln=se(Ut,yt),gi=oe.joinNormals[Ut];rb(this.wallVertexArray,gi,ln),rb(this.wallVertexArray,gi,ln)}if(ot.vertexLength+=4,this.indexArray.emplaceBack(jn+0,jn+1,jn+2),this.indexArray.emplaceBack(jn+1,jn+3,jn+2),ot.primitiveLength+=2,be){const ln=Ie+(Ut===1?yt.length-2:Ut-2),gi=Ut===1?Ie:ln+1;if(this.indexArray.emplaceBack(jn+1,ln,jn+3),this.indexArray.emplaceBack(ln,gi,jn+3),ot.primitiveLength+=2,kt===void 0&&(kt=jn),!jE(Qr,yt[Ut],Xe)){const xi=Ut===yt.length-1?kt:ot.vertexLength;this.indexArray.emplaceBack(jn+2,jn+3,xi),this.indexArray.emplaceBack(jn+3,xi+1,xi),this.indexArray.emplaceBack(jn+3,gi,xi+1),ot.primitiveLength+=3}Xt=!Xt}if(L){const ln=this.layoutVertexExtArray,gi=N.projectTilePoint(pr.x,pr.y,v),xi=N.projectTilePoint(vr.x,vr.y,v),Zi=N.upVector(v,pr.x,pr.y),La=N.upVector(v,vr.x,vr.y);nb(ln,gi,Zi),nb(ln,gi,Zi),nb(ln,xi,La),nb(ln,xi,La)}}k&&(Ie+=yt.length-1),Y&&be&&this.zoom>=17&&(Vt.length!==0&&Me(Vt,Vt[0])&&Vt.pop(),this.groundEffect.addData(Vt,Xe,F,be>0))}this.footprintSegments.push(lt),nt.triangleCount=this.indexArray.length-nt.triangleArrayOffset,this.polygonSegments.push(nt),++$.footprintSegLen,++$.polygonSegLen}if($.vertexCount=this.layoutVertexArray.length-$.vertexArrayOffset,$.groundVertexCount=this.groundEffect.vertexArray.length-$.groundVertexArrayOffset,$.vertexCount!==0){if($.centroidXY=I.borders?lz:this.encodeCentroid(I,$),this.centroidData.push($),I.borders){this.featuresOnBorder.push(I);const Ce=this.featuresOnBorder.length-1;for(let Xe=0;Xe<I.borders.length;Xe++)I.borders[Xe][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Xe].push(Ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,m,x,v,j),this.groundEffect.addPaintPropertiesData(o,p,m,x,v,j),this.maxHeight=Math.max(this.maxHeight,ee)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((c,p)=>this.featuresOnBorder[c].borders[o][0]-this.featuresOnBorder[p].borders[o][0])}splitToSubtiles(){const o=[];for(let M=0;M<this.centroidData.length;M++){const j=this.centroidData[M],F=+(j.min.y+j.max.y>ar),E=2*F+(+(j.min.x+j.max.x>ar)^F);for(let N=0;N<j.polygonSegLen;N++){const L=j.polygonSegIdx+N;o.push({centroidIdx:M,subtile:E,polygonSegmentIdx:L,triangleSegmentIdx:this.polygonSegments[L].triangleSegIdx})}}const c=new go;o.sort((M,j)=>M.triangleSegmentIdx===j.triangleSegmentIdx?M.subtile-j.subtile:M.triangleSegmentIdx-j.triangleSegmentIdx);let p=0,v=0,m=0;for(const M of o){if(M.triangleSegmentIdx!==p)break;m++}const x=o.length;for(;v!==o.length;){p=o[v].triangleSegmentIdx;let M=0,j=v,F=v;for(let E=j;E<m&&o[E].subtile===M;E++)F++;for(;j!==m;){const E=o[j];M=E.subtile;const N=this.centroidData[E.centroidIdx].min.clone(),L=this.centroidData[E.centroidIdx].max.clone(),k={vertexOffset:this.segments.segments[p].vertexOffset,primitiveOffset:c.length,vertexLength:this.segments.segments[p].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let I=j;I<F;I++){const $=o[I],Y=this.polygonSegments[$.polygonSegmentIdx],ee=this.centroidData[$.centroidIdx].min,oe=this.centroidData[$.centroidIdx].max,se=this.indexArray.uint16;for(let ie=Y.triangleArrayOffset;ie<Y.triangleArrayOffset+Y.triangleCount;ie++)c.emplaceBack(se[3*ie],se[3*ie+1],se[3*ie+2]);k.primitiveLength+=Y.triangleCount,N.x=Math.min(N.x,ee.x),N.y=Math.min(N.y,ee.y),L.x=Math.max(L.x,oe.x),L.y=Math.max(L.y,oe.y)}k.primitiveLength>0&&this.triangleSubSegments.push({segment:k,min:N,max:L}),j=F;for(let I=j;I<m&&o[I].subtile===o[j].subtile;I++)F++}v=m;for(let E=v;E<x&&o[E].triangleSegmentIdx===o[v].triangleSegmentIdx;E++)m++}c._trim(),this.indexArray=c}getVisibleSegments(o,c,p){const v=new va;if(this.wallMode){for(const $ of this.triangleSubSegments)v.segments.push($.segment);return v}let m=0,x=0;const M=1<<o.canonical.z;if(c){const $=c.getMinMaxForTile(o);$&&(m=$.min,x=$.max)}x+=this.maxHeight;const j=o.toUnwrapped();let F;const E=[j.canonical.x/M+j.wrap,j.canonical.y/M],N=[(j.canonical.x+1)/M+j.wrap,(j.canonical.y+1)/M],L=($,Y,ee)=>[$[0]*(1-ee[0])+Y[0]*ee[0],$[1]*(1-ee[1])+Y[1]*ee[1]],k=[],I=[];for(const $ of this.triangleSubSegments){k[0]=$.min.x/ar,k[1]=$.min.y/ar,I[0]=$.max.x/ar,I[1]=$.max.y/ar;const Y=L(E,N,k),ee=L(E,N,I);if(new xr([Y[0],Y[1],m],[ee[0],ee[1],x]).intersectsPrecise(p)===0){F&&(v.segments.push(F),F=void 0);continue}const oe=$.segment;F&&F.vertexOffset!==oe.vertexOffset&&(v.segments.push(F),F=void 0),F?(F.vertexLength+=oe.vertexLength,F.primitiveLength+=oe.primitiveLength):F={vertexOffset:oe.vertexOffset,primitiveLength:oe.primitiveLength,vertexLength:oe.vertexLength,primitiveOffset:oe.primitiveOffset,sortKey:void 0,vaos:{}}}return F&&v.segments.push(F),v}encodeCentroid(o,c){const p=o.centroid(),v=c.span(),m=Math.min(7,Math.round(v.x*this.tileToMeter/10)),x=Math.min(7,Math.round(v.y*this.tileToMeter/10));return new It(dr(p.x,1,ar-1)<<3|m,dr(p.y,1,ar-1)<<3|x)}encodeBorderCentroid(o){if(!o.borders)return new It(0,0);const c=o.borders,p=Number.MAX_VALUE;if(c[0][0]!==p||c[1][0]!==p){const v=c[0][0]!==p?0:1;return new It(6|(c[0][0]!==p?0:65528),(c[v][0]+c[v][1])/2<<3|6)}{const v=c[2][0]!==p?2:3;return new It((c[v][0]+c[v][1])/2<<3|6,6|(c[2][0]!==p?0:65528))}}showCentroid(o){const c=this.centroidData[o.centroidDataIndex];c.flags&=dg,c.centroidXY.x=0,c.centroidXY.y=0,this.writeCentroidToBuffer(c)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const c=o.vertexArrayOffset,p=o.vertexCount+o.vertexArrayOffset,v=o.flags&dg?lz:o.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(c);if(this.centroidVertexArray.geta_centroid_pos1(c)!==v.y||m!==v.x){for(let x=c;x<p;++x)this.centroidVertexArray.emplace(x,v.x,v.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,c,p){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const v=c.getReplacementRegionsForTile(o.toUnwrapped());if(OE(this.activeReplacements,v))return;if(this.activeReplacements=v,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const x of this.centroidData)x.flags&=2147483647;const m=[];for(const x of this.activeReplacements){if(x.order<p)continue;const M=Math.max(1,Math.pow(2,x.footprintTileId.canonical.z-o.canonical.z));for(const j of this.centroidData)if(!(j.flags&dg||x.min.x>j.max.x||j.min.x>x.max.x||x.min.y>j.max.y||j.min.y>x.max.y))for(let F=0;F<j.footprintSegLen;F++){const E=this.footprintSegments[j.footprintSegIdx+F];if(m.length=0,bie(this.footprintVertices,E.vertexOffset,E.vertexCount,x.footprintTileId.canonical,o.canonical,m),nz(x.footprint,m,this.footprintIndices.uint16,E.indexOffset,E.indexCount,-E.vertexOffset,-M)){j.flags|=dg;break}}}for(const x of this.centroidData)this.writeCentroidToBuffer(x);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,c,p){let v=!1;for(let m=0;m<p.footprintSegLen;m++){const x=this.footprintSegments[p.footprintSegIdx+m];let M=0;for(const j of x.ringIndices){for(let F=M,E=j+M-1;F<j+M;E=F++){const N=this.footprintVertices.int16[2*(F+x.vertexOffset)+0],L=this.footprintVertices.int16[2*(F+x.vertexOffset)+1],k=this.footprintVertices.int16[2*(E+x.vertexOffset)+1];L>c!=k>c&&o<(this.footprintVertices.int16[2*(E+x.vertexOffset)+0]-N)*(c-L)/(k-L)+N&&(v=!v)}M=j}}return v}getHeightAtTileCoord(o,c){let p=Number.NEGATIVE_INFINITY,v=!0;const m=4*(o+ar)*ar+(c+ar);if(this.partLookup.hasOwnProperty(m)){const x=this.partLookup[m];return x?{height:x.height,hidden:!!(x.flags&dg)}:void 0}for(const x of this.centroidData)o>x.max.x||x.min.x>o||c>x.max.y||x.min.y>c||this.footprintContainsPoint(o,c,x)&&x&&x.height>p&&(p=x.height,this.partLookup[m]=x,v=!!(x.flags&dg));if(p!==Number.NEGATIVE_INFINITY)return{height:p,hidden:v};this.partLookup[m]=void 0}}function pz(d,o){const c=d.add(o)._unit();return d.x*c.x+d.y*c.y}function xie(d,o,c,p){const v=o.sub(d)._perp()._unit(),m=c.sub(o)._perp()._unit();return mz(d,o,c,pz(v,m),p)}function mz(d,o,c,p,v){const m=Math.sqrt(1-p*p);return Math.min(d.dist(o)/3,o.dist(c)/3,v*m/p)}function jE(d,o,c){return d.x<c[0].x&&o.x<c[0].x||d.x>c[1].x&&o.x>c[1].x||d.y<c[0].y&&o.y<c[0].y||d.y>c[1].y&&o.y>c[1].y}function gz(d,o){return d.x<o[0].x||d.x>o[1].x||d.y<o[0].y||d.y>o[1].y}function yz(d,o,c){if(d.x<0||d.x>=ar||o.x<0||o.x>=ar||c.x<0||c.x>=ar)return!1;const p=c.sub(o),v=p.perp(),m=d.sub(o);return(p.x*m.x+p.y*m.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(m.x*m.x+m.y*m.y))>-.866&&v.x*m.x+v.y*m.y<0}function vz(d,o,c){const p=o?2|d:-3&d;return c?1|p:-2&p}function _z(){const d=Math.PI/32,o=Math.tan(d),c=ld;return c*Math.sqrt(1+2*o*o)-c}function xz(d,o,c){const p=1<<c.z,v=Zs(c.x/p),m=Zs((c.x+1)/p),x=zr(c.y/p),M=zr((c.y+1)/p);return function(j,F,E,N,L=0,k){const I=[];if(!j.length||!E||!N)return I;const $=(me,be)=>{for(const Re of me)I.push({polygon:Re,bounds:be})},Y=Math.ceil(Math.log2(E)),ee=Math.ceil(Math.log2(N)),oe=Y-ee,se=[];for(let me=0;me<Math.abs(oe);me++)se.push(oe>0?0:1);for(let me=0;me<Math.min(Y,ee);me++)se.push(0),se.push(1);let ie=j;if(ie=FS(ie,F[0].y-L,F[1].y+L,1),ie=FS(ie,F[0].x-L,F[1].x+L,0),!ie.length)return I;const he=[];for(se.length?he.push({polygons:ie,bounds:F,depth:0}):$(ie,F);he.length;){const me=he.pop(),be=me.depth,Re=se[be],Me=me.bounds[0],Ce=me.bounds[1],Xe=Re===0?Me.x:Me.y,Ie=Re===0?Ce.x:Ce.y,Qe=k?k(Re,Xe,Ie):.5*(Xe+Ie),ot=FS(me.polygons,Xe-L,Qe+L,Re),nt=FS(me.polygons,Qe-L,Ie+L,Re);if(ot.length){const lt=[Me,new It(Re===0?Qe:Ce.x,Re===1?Qe:Ce.y)];se.length>be+1?he.push({polygons:ot,bounds:lt,depth:be+1}):$(ot,lt)}if(nt.length){const lt=[new It(Re===0?Qe:Me.x,Re===1?Qe:Me.y),Ce];se.length>be+1?he.push({polygons:nt,bounds:lt,depth:be+1}):$(nt,lt)}}return I}(d,o,Math.ceil((m-v)/11.25),Math.ceil((x-M)/11.25),1,(j,F,E)=>{if(j===0)return .5*(F+E);{const N=zr((c.y+F/ar)/p);return(Hs(.5*(zr((c.y+E/ar)/p)+N))*p-c.y)*ar}})}function bie(d,o,c,p,v,m){const x=Math.pow(2,p.z-v.z);for(let M=0;M<c;M++){let j=d.int16[2*(M+o)+0],F=d.int16[2*(M+o)+1];j=(j+v.x*ar)*x-p.x*ar,F=(F+v.y*ar)*x-p.y*ar,m.push(new It(j,F))}}let bz,wz;function ib(d,o){return d.x*o.x+d.y*o.y}function Sz(d,o){if(d.length===1){let c=0;const p=o[c++];let v;for(;!v||p.equals(v);)if(v=o[c++],!v)return 1/0;for(;c<o.length;c++){const m=o[c],x=d[0],M=v.sub(p),j=m.sub(p),F=x.sub(p),E=ib(M,M),N=ib(M,j),L=ib(j,j),k=ib(F,M),I=ib(F,j),$=E*L-N*N,Y=(L*k-N*I)/$,ee=(E*I-N*k)/$,oe=p.z*(1-Y-ee)+v.z*Y+m.z*ee;if(isFinite(oe))return oe}return 1/0}{let c=1/0;for(const p of o)c=Math.min(c,p.z);return c}}function Az(d,o,c,p,v,m,x,M){const j=x*v.getElevationAt(d,o,!0,!0),F=m[0]!==0,E=F?m[1]===0?x*(m[0]/7-450):x*function(N,L,k){const I=Math.floor(L[0]/8),$=Math.floor(L[1]/8),Y=10*(L[0]-8*I),ee=10*(L[1]-8*$),oe=N.getElevationAt(I,$,!0,!0),se=N.getMeterToDEM(k),ie=Math.floor(.5*(Y*se-1)),he=Math.floor(.5*(ee*se-1)),me=N.tileCoordToPixel(I,$),be=2*ie+1,Re=2*he+1,Me=function(nt,lt,dt,yt,ct){return[nt.getElevationAtPixel(lt,dt,!0),nt.getElevationAtPixel(lt+ct,dt,!0),nt.getElevationAtPixel(lt,dt+ct,!0),nt.getElevationAtPixel(lt+yt,dt+ct,!0)]}(N,me.x-ie,me.y-he,be,Re),Ce=Math.abs(Me[0]-Me[1]),Xe=Math.abs(Me[2]-Me[3]),Ie=Math.abs(Me[0]-Me[2])+Math.abs(Me[1]-Me[3]),Qe=Math.min(.25,.5*se*(Ce+Xe)/be),ot=Math.min(.25,.5*se*Ie/Re);return oe+Math.max(Qe*Y,ot*ee)}(v,m,M):j;return{base:j+(c===0?-1:c),top:F?Math.max(E+p,j+c+2):j+p}}hr($S,"FillExtrusionBucket",{omit:["layers","features"]}),hr(uz,"PartData"),hr(cz,"FootprintSegment"),hr(dz,"BorderCentroidData"),hr(fz,"GroundEffect");const wie=Qn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Sie=Qn([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Aie}=wie,Tie=Qn([{name:"a_packed",components:3,type:"Float32"}]),{members:Pie}=Tie,Eie=Qn([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Cie}=Eie;class Tz{constructor(o,c){this.width=o,this.height=c,this.nextRow=0,this.image=new cd({width:o,height:c}),this.positions={},this.uploaded=!1}getDash(o,c){const p=this.getKey(o,c);return this.positions[p]}trim(){const o=this.width,c=this.height=Vo(this.nextRow);this.image.resize({width:o,height:c})}getKey(o,c){return o.join(",")+c}getDashRanges(o,c,p){const v=[];let m=o.length%2==1?-o[o.length-1]*p:0,x=o[0]*p,M=!0;v.push({left:m,right:x,isDash:M,zeroLength:o[0]===0});let j=o[0];for(let F=1;F<o.length;F++){M=!M;const E=o[F];m=j*p,j+=E,x=j*p,v.push({left:m,right:x,isDash:M,zeroLength:E===0})}return v}addRoundDash(o,c,p){const v=c/2;for(let m=-p;m<=p;m++){const x=this.width*(this.nextRow+p+m);let M=0,j=o[M];for(let F=0;F<this.width;F++){F/j.right>1&&(j=o[++M]);const E=Math.abs(F-j.left),N=Math.abs(F-j.right),L=Math.min(E,N);let k;const I=m/p*(v+1);if(j.isDash){const $=v-Math.abs(I);k=Math.sqrt(L*L+$*$)}else k=v-Math.sqrt(L*L+I*I);this.image.data[x+F]=Math.max(0,Math.min(255,k+128))}}}addRegularDash(o,c){for(let j=o.length-1;j>=0;--j){const F=o[j],E=o[j+1];F.zeroLength?o.splice(j,1):E&&E.isDash===F.isDash&&(E.left=F.left,o.splice(j,1))}const p=o[0],v=o[o.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const m=this.width*this.nextRow;let x=0,M=o[x];for(let j=0;j<this.width;j++){j/M.right>1&&(M=o[++x]);const F=Math.abs(j-M.left),E=Math.abs(j-M.right),N=Math.min(F,E);this.image.data[m+j]=Math.max(0,Math.min(255,(M.isDash?N:-N)+c+128))}}addDash(o,c){const p=this.getKey(o,c);if(this.positions[p])return this.positions[p];const v=c==="round",m=v?7:0,x=2*m+1;if(this.nextRow+x>this.height)return rn("LineAtlas out of space"),null;o.length===0&&o.push(1);let M=0;for(let E=0;E<o.length;E++)o[E]<0&&(rn("Negative value is found in line dasharray, replacing values with 0"),o[E]=0),M+=o[E];if(M!==0){const E=this.width/M,N=this.getDashRanges(o,this.width,E);v?this.addRoundDash(N,E,m):this.addRegularDash(N,c==="square"?.5*E:0)}const j=this.nextRow+m;this.nextRow+=x;const F={tl:[j,m],br:[M,0]};return this.positions[p]=F,F}}hr(Tz,"LineAtlas");const Mie=P_.VectorTileFeature.types,Oie=Math.cos(Math.PI/180*37.5),Rie=Math.cos(Math.PI/180*5);class NE{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.pixelRatio=o.pixelRatio,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new rd,this.layoutVertexArray2=new qs,this.patternVertexArray=new qs,this.indexArray=new go,this.programConfigurations=new cu(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new va,this.maxLineLength=0,this.zOffsetVertexArray=new qs,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:ar/64}updateFootprints(o,c){}populate(o,c,p,v){this.hasPattern=Jr("line",this.layers,this.pixelRatio,c);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=s(p);const x=this.layers[0].layout.get("line-z-offset"),M=x.isConstant()&&!x.constantOr(0),j=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=j==="sea"||j==="ground"||!M&&j==="none",this.hasZOffset&&j==="none"&&rn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const F=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&F!==void 0;const E=[];for(const{feature:I,id:$,index:Y,sourceLayerIndex:ee}of o){const oe=this.layers[0]._featureFilter.needGeometry,se=te(I,oe);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),se,p))continue;const ie=m?m.evaluate(se,{},p):void 0,he={id:$,properties:I.properties,type:I.type,sourceLayerIndex:ee,index:Y,geometry:oe?se.geometry:Z(I,p,v),patterns:{},sortKey:ie};E.push(he)}m&&E.sort((I,$)=>I.sortKey-$.sortKey);const{lineAtlas:N,featureIndex:L}=c,k=this.addConstantDashes(N);for(const I of E){const{geometry:$,index:Y,sourceLayerIndex:ee}=I;if(k&&this.addFeatureDashes(I,N),this.hasPattern){const oe=sn("line",this.layers,I,this.zoom,this.pixelRatio,c);this.patternFeatures.push(oe)}else this.addFeature(I,$,Y,p,N.positions,c.availableImages,c.brightness);L.insert(o[Y].feature,$,Y,ee,this.index)}}addConstantDashes(o){let c=!1;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,m=p.layout.get("line-cap").value;if(v.kind!=="constant"||m.kind!=="constant")c=!0;else{const x=m.value,M=v.value;if(!M)continue;o.addDash(M,x)}}return c}addFeatureDashes(o,c){const p=this.zoom;for(const v of this.layers){const m=v.paint.get("line-dasharray").value,x=v.layout.get("line-cap").value;if(m.kind==="constant"&&x.kind==="constant")continue;let M,j;if(m.kind==="constant"){if(M=m.value,!M)continue}else M=m.evaluate({zoom:p},o);j=x.kind==="constant"?x.value:x.evaluate({zoom:p},o),c.addDash(M,j),o.patterns[v.id]=c.getKey(M,j)}}update(o,c,p,v,m,x,M){this.programConfigurations.updatePaintArrays(o,c,m,p,v,x,M)}addFeatures(o,c,p,v,m,x){for(const M of this.patternFeatures)this.addFeature(M,M.geometry,M.index,c,p,v,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,Pie)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,Cie)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Sie.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Aie),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,c,p,v,m,x,M){const j=this.layers[0].layout,F=j.get("line-join").evaluate(o,{}),E=j.get("line-cap").evaluate(o,{}),N=j.get("line-miter-limit"),L=j.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=j.get("line-z-offset").value;const k=this.layers[0].paint.get("line-width").value;k.kind!=="constant"&&k.isLineProgressConstant===!1&&(this.variableWidthValue=k);for(const I of c)this.addLine(I,o,v,F,E,N,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,p,m,x,v,M)}addLine(o,c,p,v,m,x,M){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const j=v==="none";if(this.patternJoinNone=this.hasPattern&&j,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let se=0;se<o.length-1;se++)this.totalDistance+=o[se].dist(o[se+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const F=Mie[c.type]==="Polygon";let E=o.length;for(;E>=2&&o[E-1].equals(o[E-2]);)E--;let N=0;for(;N<E-1&&o[N].equals(o[N+1]);)N++;if(E<(F?3:2))return;v==="bevel"&&(x=1.05);const L=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let k,I,$,Y,ee,oe;this.e1=this.e2=-1,F&&(k=o[E-2],ee=o[N].sub(k)._unit()._perp());for(let se=N;se<E;se++){if($=se===E-1?F?o[N+1]:void 0:o[se+1],$&&o[se].equals($))continue;ee&&(Y=ee),k&&(I=k),k=o[se],oe=this.evaluateLineProgressFeatures(I?I.dist(k):0),ee=$?$.sub(k)._unit()._perp():Y,Y=Y||ee;const ie=I&&$;let he=ie?v:F||j?"butt":m;const me=Y.x*ee.x+Y.y*ee.y;if(j){const ot=function(nt){if(nt.patternJoinNone){const lt=nt.segmentPoints.length/2,dt=nt.lineSoFar-nt.segmentStart;for(let yt=0;yt<lt;++yt){const ct=nt.segmentPoints[2*yt+1],jt=Math.round(nt.segmentPoints[2*yt])+.5+.25*ct;nt.patternVertexArray.emplaceBack(jt,dt,nt.segmentStart),nt.patternVertexArray.emplaceBack(jt,dt,nt.segmentStart)}nt.segmentPoints.length=0}nt.e1=nt.e2=-1};if(ie&&me<Rie){this.updateDistance(I,k),this.addCurrentVertex(k,Y,1,1,L,oe),ot(this),this.addCurrentVertex(k,ee,-1,-1,L,oe);continue}if(I){if(!$){this.updateDistance(I,k),this.addCurrentVertex(k,Y,1,1,L,oe),ot(this);continue}he="miter"}}let be=Y.add(ee);be.x===0&&be.y===0||be._unit();const Re=be.x*ee.x+be.y*ee.y,Me=Re!==0?1/Re:1/0,Ce=2*Math.sqrt(2-2*Re),Xe=Re<Oie&&I&&$,Ie=Y.x*ee.y-Y.y*ee.x>0,Qe=this.overscaling<=16?15*ar/(512*this.overscaling):0;if(ie&&he==="round"){if(Me<M)he="miter";else if(Me<=2){const ot=IE(k,-10,ar+10);he=this.hasZOffset&&(ot||this.hasCrossSlope)?"miter":"fakeround"}}if(he==="miter"&&Me>x&&(he="bevel"),he==="bevel"&&(Me>2&&(he="flipbevel"),Me<x&&(he="miter")),I&&!(he==="miter"&&Xe)&&this.updateDistance(I,k),he==="miter")if(Xe){const ot=k.dist(I);if(ot>2*Qe){const lt=k.sub(k.sub(I)._mult(Qe/ot)._round());this.updateDistance(I,lt),this.addCurrentVertex(lt,Y,0,0,L,oe),I=lt}this.updateDistance(I,k),be._mult(Me),this.addCurrentVertex(k,be,0,0,L,oe);const nt=k.dist($);if(nt>2*Qe){const lt=k.add($.sub(k)._mult(Qe/nt)._round());this.updateDistance(k,lt),this.addCurrentVertex(lt,ee,0,0,L,oe),k=lt}}else be._mult(Me),this.addCurrentVertex(k,be,0,0,L,oe);else if(he==="flipbevel"){if(Me>100)be=ee.mult(-1);else{const ot=Me*Y.add(ee).mag()/Y.sub(ee).mag();be._perp()._mult(ot*(Ie?-1:1))}this.addCurrentVertex(k,be,0,0,L,oe),this.addCurrentVertex(k,be.mult(-1),0,0,L,oe)}else if(he==="bevel"||he==="fakeround"){oe!=null&&I&&this.addCurrentVertex(k,Y,-1,-1,L,oe);const ot=k.dist(I)<=2*Qe&&he!=="bevel",nt=be.mult(Ie?1:-1);nt._mult(Me);const lt=ee.mult(Ie?-1:1),dt=Y.mult(Ie?-1:1),yt=this.evaluateLineProgressFeatures(this.distance);if(oe==null&&(this.addHalfVertex(k,nt.x,nt.y,!1,!Ie,0,L,yt),ot||this.addHalfVertex(k,nt.x+2*dt.x,nt.y+2*dt.y,!1,Ie,0,L,yt)),he==="fakeround"){const ct=Math.round(180*Ce/Math.PI/20);this.addHalfVertex(k,dt.x,dt.y,!1,Ie,0,L,yt);for(let jt=0;jt<ct;jt++){let Vt=jt/ct;if(Vt!==.5){const cr=Vt-.5;Vt+=Vt*cr*(Vt-1)*((1.0904+me*(me*(3.55645-1.43519*me)-3.2452))*cr*cr+(.848013+me*(.215638*me-1.06021)))}const kt=lt.sub(dt)._mult(Vt)._add(dt)._unit();this.addHalfVertex(k,kt.x,kt.y,!1,Ie,0,L,yt)}this.addHalfVertex(k,lt.x,lt.y,!1,Ie,0,L,yt)}ot||oe!=null||this.addHalfVertex(k,nt.x+2*lt.x,nt.y+2*lt.y,!1,Ie,0,L,yt),oe!=null&&$&&this.addCurrentVertex(k,ee,1,1,L,oe)}else he==="butt"?this.addCurrentVertex(k,be,0,0,L,oe):he==="square"?(I||this.addCurrentVertex(k,be,-1,-1,L,oe),this.addCurrentVertex(k,be,0,0,L,oe),I&&this.addCurrentVertex(k,be,1,1,L,oe)):he==="round"&&(I&&(this.addCurrentVertex(k,Y,0,0,L,oe),this.addCurrentVertex(k,Y,1,1,L,oe,!0)),$&&(this.addCurrentVertex(k,ee,-1,-1,L,oe,!0),this.addCurrentVertex(k,ee,0,0,L,oe)))}}addVerticesTo(o,c,p,v,m,x,M,j,F,E){const N=(c.w-o.w)/this.tessellationStep|0;let L=0;const k=this.scaledDistance;if(N>1){this.lineSoFar=o.w;const $=(c.x-o.x)/N,Y=(c.y-o.y)/N,ee=(c.z-o.z)/N,oe=(c.w-o.w)/N;for(let se=1;se<N;++se){o.x+=$,o.y+=Y,o.z+=ee,this.lineSoFar+=oe,L+=oe;const ie=this.evaluateLineProgressFeatures(this.prevDistance+L);this.scaledDistance=(this.prevDistance+L)/this.totalDistance,this.addHalfVertex(o,p,v,E,!1,M,F,ie),this.addHalfVertex(o,m,x,E,!0,-j,F,ie)}}this.lineSoFar=c.w,this.scaledDistance=k;const I=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(c,p,v,E,!1,M,F,I),this.addHalfVertex(c,m,x,E,!0,-j,F,I)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):rn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let c=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(c=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:c}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:c}:{zOffset:0,variableWidth:c}}addCurrentVertex(o,c,p,v,m,x,M=!1){const j=c.x+c.y*p,F=c.y-c.x*p,E=c.y*v-c.x,N=-c.y-c.x*v;if(x!=null){const L=this.hasZOffset,k=-10,I=ar+10,$=x.zOffset,Y=new X4(o.x,o.y,$,this.lineSoFar),ee=!!L&&IE(o,k,I),oe=this.lineSoFar,se=this.distance;if(this.currentVertex)if(ee){const ie=this.currentVertexIsOutside,he=this.currentVertex,me=new X4(o.x,o.y,$,this.lineSoFar);if(Q4(he,me,k,I),!IE(me,k,I)){if(ie){this.e1=this.e2=-1,this.distance-=he.dist(Y),this.lineSoFar=he.w;const be=this.evaluateLineProgressFeatures(he.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(he,j,F,M,!1,p,m,be),this.addHalfVertex(he,E,N,M,!0,-v,m,be),this.prevDistance=this.distance}this.distance=this.prevDistance+he.dist(me),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(he,me,j,F,E,N,p,v,m,M),this.distance=se,this.scaledDistance=this.distance/this.totalDistance}}else{const ie=this.currentVertex;if(this.currentVertexIsOutside){Q4(ie,Y,k,I),this.e1=this.e2=-1,this.distance-=ie.dist(Y),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ie.w;const he=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,j,F,M,!1,p,m,he),this.addHalfVertex(ie,E,N,M,!0,-v,m,he),this.prevDistance=this.distance,this.distance=se,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ie,Y,j,F,E,N,p,v,m,M)}else ee||(this.addHalfVertex(o,j,F,M,!1,p,m,x),this.addHalfVertex(o,E,N,M,!0,-v,m,x));this.currentVertex=Y,this.currentVertexIsOutside=ee,this.lineSoFar=oe}else this.addHalfVertex(o,j,F,M,!1,p,m,x),this.addHalfVertex(o,E,N,M,!0,-v,m,x)}addHalfVertex({x:o,y:c},p,v,m,x,M,j,F){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),x||this.segmentPoints.push(this.lineSoFar-this.segmentStart,M)),this.layoutVertexArray.emplaceBack((o<<1)+(m?1:0),(c<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(M===0?0:M<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const N=Dr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,N)}const E=j.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),j.primitiveLength++),x?this.e2=E:this.e1=E,F!=null&&this.zOffsetVertexArray.emplaceBack(F.zOffset,F.variableWidth,F.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,c){this.prevDistance=this.distance,this.distance+=o.dist(c),this.updateScaledDistance()}}function IE(d,o,c){return d.x<o||d.x>c||d.y<o||d.y>c}let Pz,Ez;function Cz(d,o,c){return o*(ar/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}hr(NE,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Mz=(d,o,c)=>(1-c)*d+c*o;function Oz(d,o){return 1/Cz(d,1,o.tileZoom)}function Rz(d,o,c,p){return d.translatePosMatrix(p||o.tileID.projMatrix,o,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const kz=d=>{const o=[];jz(d)&&o.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const c=d.paint.get("line-trim-offset");c[0]===0&&c[1]===0||o.push("RENDER_LINE_TRIM_OFFSET"),d.paint.get("line-border-width").constantOr(1)!==0&&o.push("RENDER_LINE_BORDER");const p=d.layout.get("line-join").constantOr("miter")==="none",v=!!d.paint.get("line-pattern").constantOr(1);return p&&v&&o.push("LINE_JOIN_NONE"),o};function jz(d){const o=d.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}let DE;const Nz=()=>DE||(DE={layout:Pz||(Pz=new $i({"line-cap":new or(vt.layout_line["line-cap"]),"line-join":new or(vt.layout_line["line-join"]),"line-miter-limit":new Yt(vt.layout_line["line-miter-limit"]),"line-round-limit":new Yt(vt.layout_line["line-round-limit"]),"line-sort-key":new or(vt.layout_line["line-sort-key"]),"line-z-offset":new or(vt.layout_line["line-z-offset"]),"line-elevation-reference":new Yt(vt.layout_line["line-elevation-reference"]),"line-cross-slope":new Yt(vt.layout_line["line-cross-slope"]),visibility:new Yt(vt.layout_line.visibility),"line-width-unit":new Yt(vt.layout_line["line-width-unit"])})),paint:Ez||(Ez=new $i({"line-opacity":new or(vt.paint_line["line-opacity"]),"line-color":new or(vt.paint_line["line-color"]),"line-translate":new Yt(vt.paint_line["line-translate"]),"line-translate-anchor":new Yt(vt.paint_line["line-translate-anchor"]),"line-width":new or(vt.paint_line["line-width"]),"line-gap-width":new or(vt.paint_line["line-gap-width"]),"line-offset":new or(vt.paint_line["line-offset"]),"line-blur":new or(vt.paint_line["line-blur"]),"line-dasharray":new or(vt.paint_line["line-dasharray"]),"line-pattern":new or(vt.paint_line["line-pattern"]),"line-gradient":new Ol(vt.paint_line["line-gradient"]),"line-trim-offset":new Yt(vt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Yt(vt.paint_line["line-trim-fade-range"]),"line-trim-color":new Yt(vt.paint_line["line-trim-color"]),"line-emissive-strength":new Yt(vt.paint_line["line-emissive-strength"]),"line-border-width":new or(vt.paint_line["line-border-width"]),"line-border-color":new or(vt.paint_line["line-border-color"]),"line-occlusion-opacity":new Yt(vt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},DE);class kie extends or{possiblyEvaluate(o,c){return c=new vi(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,transition:c.transition}),super.possiblyEvaluate(o,c)}evaluate(o,c,p,v){return c=Vi({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(o,c,p,v)}}let ab;function Iz(d,o){return o>0?o+2*d:d}const jie=Qn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Nie=Qn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Iie=Qn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Qn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Die=Qn([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Lie=Qn([{name:"a_texb",components:2,type:"Uint16"}]),zie=Qn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),Fie=Qn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Qn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Dz=Qn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Bie=Qn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Qn([{name:"triangle",components:3,type:"Uint16"}]),Qn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Qn([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Qn([{type:"Float32",name:"offsetX"}]),Qn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Cs=24;const fh=128;function LE(d,o,c,p,v){if(d.kind==="camera")return d.maxSize;if(d.kind==="composite"){const m=o.possiblyEvaluate(new vi(d.maxZoom),c).evaluate(v,{},c),x=o.possiblyEvaluate(new vi(d.minZoom),c).evaluate(v,{},c);return Math.max(m,x)}return o.possiblyEvaluate(new vi(p)).evaluate(v,{},c)}function zE(d,o){const{expression:c}=o;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new vi(d+1))};if(c.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=c;let m=0;for(;m<p.length&&p[m]<=d;)m++;m=Math.max(0,m-1);let x=m;for(;x<p.length&&p[x]<d+1;)x++;x=Math.min(p.length-1,x);const M=p[m],j=p[x];return c.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:j,interpolationType:v}:{kind:"camera",minZoom:M,maxZoom:j,minSize:c.evaluate(new vi(M)),maxSize:c.evaluate(new vi(j)),interpolationType:v}}}function qS(d,{uSize:o,uSizeT:c},{lowerSize:p,upperSize:v}){return d.kind==="source"?p/fh:d.kind==="composite"?Dr(p/fh,v/fh,c):o}function E_(d,o,c=1){let p=0,v=0;if(d.kind==="constant")v=d.layoutSize*c;else if(d.kind!=="source"){const{interpolationType:m,minZoom:x,maxZoom:M}=d,j=m?dr(Po.interpolationFactor(m,o,x,M),0,1):0;d.kind==="camera"?v=Dr(d.minSize,d.maxSize,j)*c:p=j*c}return{uSizeT:p,uSize:v}}var Vie=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:fh,evaluateSizeForFeature:qS,evaluateSizeForZoom:E_,getRasterizedIconSize:LE,getSizeData:zE});function Uie(d,o,c){return d.sections.forEach(p=>{p.text=function(v,m,x){const M=m.layout.get("text-transform").evaluate(x,{});return M==="uppercase"?v=v.toLocaleUpperCase():M==="lowercase"&&(v=v.toLocaleLowerCase()),$s.applyArabicShaping&&(v=$s.applyArabicShaping(v)),v}(p.text,o,c)}),d}const ob={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function $ie(d){return d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""}function qie(d){return d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""||d===""}var Lz,FE,zz,BE={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Gie(){return Lz||(Lz=1,BE.read=function(d,o,c,p,v){var m,x,M=8*v-p-1,j=(1<<M)-1,F=j>>1,E=-7,N=c?v-1:0,L=c?-1:1,k=d[o+N];for(N+=L,m=k&(1<<-E)-1,k>>=-E,E+=M;E>0;m=256*m+d[o+N],N+=L,E-=8);for(x=m&(1<<-E)-1,m>>=-E,E+=p;E>0;x=256*x+d[o+N],N+=L,E-=8);if(m===0)m=1-F;else{if(m===j)return x?NaN:1/0*(k?-1:1);x+=Math.pow(2,p),m-=F}return(k?-1:1)*x*Math.pow(2,m-p)},BE.write=function(d,o,c,p,v,m){var x,M,j,F=8*m-v-1,E=(1<<F)-1,N=E>>1,L=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,k=p?0:m-1,I=p?1:-1,$=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(M=isNaN(o)?1:0,x=E):(x=Math.floor(Math.log(o)/Math.LN2),o*(j=Math.pow(2,-x))<1&&(x--,j*=2),(o+=x+N>=1?L/j:L*Math.pow(2,1-N))*j>=2&&(x++,j/=2),x+N>=E?(M=0,x=E):x+N>=1?(M=(o*j-1)*Math.pow(2,v),x+=N):(M=o*Math.pow(2,N-1)*Math.pow(2,v),x=0));v>=8;d[c+k]=255&M,k+=I,M/=256,v-=8);for(x=x<<v|M,F+=v;F>0;d[c+k]=255&x,k+=I,x/=256,F-=8);d[c+k-I]|=128*$}),BE}function Fz(){if(zz)return FE;zz=1,FE=o;var d=Gie();function o(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var c=4294967296,p=1/c,v=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ie){return ie.type===o.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function x(ie,he,me){return me?4294967296*he+(ie>>>0):4294967296*(he>>>0)+(ie>>>0)}function M(ie,he,me){var be=he<=16383?1:he<=2097151?2:he<=268435455?3:Math.floor(Math.log(he)/(7*Math.LN2));me.realloc(be);for(var Re=me.pos-1;Re>=ie;Re--)me.buf[Re+be]=me.buf[Re]}function j(ie,he){for(var me=0;me<ie.length;me++)he.writeVarint(ie[me])}function F(ie,he){for(var me=0;me<ie.length;me++)he.writeSVarint(ie[me])}function E(ie,he){for(var me=0;me<ie.length;me++)he.writeFloat(ie[me])}function N(ie,he){for(var me=0;me<ie.length;me++)he.writeDouble(ie[me])}function L(ie,he){for(var me=0;me<ie.length;me++)he.writeBoolean(ie[me])}function k(ie,he){for(var me=0;me<ie.length;me++)he.writeFixed32(ie[me])}function I(ie,he){for(var me=0;me<ie.length;me++)he.writeSFixed32(ie[me])}function $(ie,he){for(var me=0;me<ie.length;me++)he.writeFixed64(ie[me])}function Y(ie,he){for(var me=0;me<ie.length;me++)he.writeSFixed64(ie[me])}function ee(ie,he){return(ie[he]|ie[he+1]<<8|ie[he+2]<<16)+16777216*ie[he+3]}function oe(ie,he,me){ie[me]=he,ie[me+1]=he>>>8,ie[me+2]=he>>>16,ie[me+3]=he>>>24}function se(ie,he){return(ie[he]|ie[he+1]<<8|ie[he+2]<<16)+(ie[he+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function(ie,he,me){for(me=me||this.length;this.pos<me;){var be=this.readVarint(),Re=be>>3,Me=this.pos;this.type=7&be,ie(Re,he,this),this.pos===Me&&this.skip(be)}return he},readMessage:function(ie,he){return this.readFields(ie,he,this.readVarint()+this.pos)},readFixed32:function(){var ie=ee(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=se(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=ee(this.buf,this.pos)+ee(this.buf,this.pos+4)*c;return this.pos+=8,ie},readSFixed64:function(){var ie=ee(this.buf,this.pos)+se(this.buf,this.pos+4)*c;return this.pos+=8,ie},readFloat:function(){var ie=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var he,me,be=this.buf;return he=127&(me=be[this.pos++]),me<128?he:(he|=(127&(me=be[this.pos++]))<<7,me<128?he:(he|=(127&(me=be[this.pos++]))<<14,me<128?he:(he|=(127&(me=be[this.pos++]))<<21,me<128?he:function(Re,Me,Ce){var Xe,Ie,Qe=Ce.buf;if(Xe=(112&(Ie=Qe[Ce.pos++]))>>4,Ie<128||(Xe|=(127&(Ie=Qe[Ce.pos++]))<<3,Ie<128)||(Xe|=(127&(Ie=Qe[Ce.pos++]))<<10,Ie<128)||(Xe|=(127&(Ie=Qe[Ce.pos++]))<<17,Ie<128)||(Xe|=(127&(Ie=Qe[Ce.pos++]))<<24,Ie<128)||(Xe|=(1&(Ie=Qe[Ce.pos++]))<<31,Ie<128))return x(Re,Xe,Me);throw new Error("Expected varint not more than 10 bytes")}(he|=(15&(me=be[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,he=this.pos;return this.pos=ie,ie-he>=12&&v?function(me,be,Re){return v.decode(me.subarray(be,Re))}(this.buf,he,ie):function(me,be,Re){for(var Me="",Ce=be;Ce<Re;){var Xe,Ie,Qe,ot=me[Ce],nt=null,lt=ot>239?4:ot>223?3:ot>191?2:1;if(Ce+lt>Re)break;lt===1?ot<128&&(nt=ot):lt===2?(192&(Xe=me[Ce+1]))==128&&(nt=(31&ot)<<6|63&Xe)<=127&&(nt=null):lt===3?(Ie=me[Ce+2],(192&(Xe=me[Ce+1]))==128&&(192&Ie)==128&&((nt=(15&ot)<<12|(63&Xe)<<6|63&Ie)<=2047||nt>=55296&&nt<=57343)&&(nt=null)):lt===4&&(Ie=me[Ce+2],Qe=me[Ce+3],(192&(Xe=me[Ce+1]))==128&&(192&Ie)==128&&(192&Qe)==128&&((nt=(15&ot)<<18|(63&Xe)<<12|(63&Ie)<<6|63&Qe)<=65535||nt>=1114112)&&(nt=null)),nt===null?(nt=65533,lt=1):nt>65535&&(nt-=65536,Me+=String.fromCharCode(nt>>>10&1023|55296),nt=56320|1023&nt),Me+=String.fromCharCode(nt),Ce+=lt}return Me}(this.buf,he,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,he=this.buf.subarray(this.pos,ie);return this.pos=ie,he},readPackedVarint:function(ie,he){if(this.type!==o.Bytes)return ie.push(this.readVarint(he));var me=m(this);for(ie=ie||[];this.pos<me;)ie.push(this.readVarint(he));return ie},readPackedSVarint:function(ie){if(this.type!==o.Bytes)return ie.push(this.readSVarint());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==o.Bytes)return ie.push(this.readBoolean());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==o.Bytes)return ie.push(this.readFloat());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==o.Bytes)return ie.push(this.readDouble());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==o.Bytes)return ie.push(this.readFixed32());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==o.Bytes)return ie.push(this.readSFixed32());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==o.Bytes)return ie.push(this.readFixed64());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==o.Bytes)return ie.push(this.readSFixed64());var he=m(this);for(ie=ie||[];this.pos<he;)ie.push(this.readSFixed64());return ie},skip:function(ie){var he=7&ie;if(he===o.Varint)for(;this.buf[this.pos++]>127;);else if(he===o.Bytes)this.pos=this.readVarint()+this.pos;else if(he===o.Fixed32)this.pos+=4;else{if(he!==o.Fixed64)throw new Error("Unimplemented type: "+he);this.pos+=8}},writeTag:function(ie,he){this.writeVarint(ie<<3|he)},realloc:function(ie){for(var he=this.length||16;he<this.pos+ie;)he*=2;if(he!==this.length){var me=new Uint8Array(he);me.set(this.buf),this.buf=me,this.length=he}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),oe(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),oe(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),oe(this.buf,-1&ie,this.pos),oe(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),oe(this.buf,-1&ie,this.pos),oe(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(he,me){var be,Re;if(he>=0?(be=he%4294967296|0,Re=he/4294967296|0):(Re=~(-he/4294967296),4294967295^(be=~(-he%4294967296))?be=be+1|0:(be=0,Re=Re+1|0)),he>=18446744073709552e3||he<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");me.realloc(10),function(Me,Ce,Xe){Xe.buf[Xe.pos++]=127&Me|128,Me>>>=7,Xe.buf[Xe.pos++]=127&Me|128,Me>>>=7,Xe.buf[Xe.pos++]=127&Me|128,Me>>>=7,Xe.buf[Xe.pos++]=127&Me|128,Xe.buf[Xe.pos]=127&(Me>>>=7)}(be,0,me),function(Me,Ce){var Xe=(7&Me)<<4;Ce.buf[Ce.pos++]|=Xe|((Me>>>=3)?128:0),Me&&(Ce.buf[Ce.pos++]=127&Me|((Me>>>=7)?128:0),Me&&(Ce.buf[Ce.pos++]=127&Me|((Me>>>=7)?128:0),Me&&(Ce.buf[Ce.pos++]=127&Me|((Me>>>=7)?128:0),Me&&(Ce.buf[Ce.pos++]=127&Me|((Me>>>=7)?128:0),Me&&(Ce.buf[Ce.pos++]=127&Me)))))}(Re,me)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var he=this.pos;this.pos=function(be,Re,Me){for(var Ce,Xe,Ie=0;Ie<Re.length;Ie++){if((Ce=Re.charCodeAt(Ie))>55295&&Ce<57344){if(!Xe){Ce>56319||Ie+1===Re.length?(be[Me++]=239,be[Me++]=191,be[Me++]=189):Xe=Ce;continue}if(Ce<56320){be[Me++]=239,be[Me++]=191,be[Me++]=189,Xe=Ce;continue}Ce=Xe-55296<<10|Ce-56320|65536,Xe=null}else Xe&&(be[Me++]=239,be[Me++]=191,be[Me++]=189,Xe=null);Ce<128?be[Me++]=Ce:(Ce<2048?be[Me++]=Ce>>6|192:(Ce<65536?be[Me++]=Ce>>12|224:(be[Me++]=Ce>>18|240,be[Me++]=Ce>>12&63|128),be[Me++]=Ce>>6&63|128),be[Me++]=63&Ce|128)}return Me}(this.buf,ie,this.pos);var me=this.pos-he;me>=128&&M(he,me,this),this.pos=he-1,this.writeVarint(me),this.pos+=me},writeFloat:function(ie){this.realloc(4),d.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),d.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var he=ie.length;this.writeVarint(he),this.realloc(he);for(var me=0;me<he;me++)this.buf[this.pos++]=ie[me]},writeRawMessage:function(ie,he){this.pos++;var me=this.pos;ie(he,this);var be=this.pos-me;be>=128&&M(me,be,this),this.pos=me-1,this.writeVarint(be),this.pos+=be},writeMessage:function(ie,he,me){this.writeTag(ie,o.Bytes),this.writeRawMessage(he,me)},writePackedVarint:function(ie,he){he.length&&this.writeMessage(ie,j,he)},writePackedSVarint:function(ie,he){he.length&&this.writeMessage(ie,F,he)},writePackedBoolean:function(ie,he){he.length&&this.writeMessage(ie,L,he)},writePackedFloat:function(ie,he){he.length&&this.writeMessage(ie,E,he)},writePackedDouble:function(ie,he){he.length&&this.writeMessage(ie,N,he)},writePackedFixed32:function(ie,he){he.length&&this.writeMessage(ie,k,he)},writePackedSFixed32:function(ie,he){he.length&&this.writeMessage(ie,I,he)},writePackedFixed64:function(ie,he){he.length&&this.writeMessage(ie,$,he)},writePackedSFixed64:function(ie,he){he.length&&this.writeMessage(ie,Y,he)},writeBytesField:function(ie,he){this.writeTag(ie,o.Bytes),this.writeBytes(he)},writeFixed32Field:function(ie,he){this.writeTag(ie,o.Fixed32),this.writeFixed32(he)},writeSFixed32Field:function(ie,he){this.writeTag(ie,o.Fixed32),this.writeSFixed32(he)},writeFixed64Field:function(ie,he){this.writeTag(ie,o.Fixed64),this.writeFixed64(he)},writeSFixed64Field:function(ie,he){this.writeTag(ie,o.Fixed64),this.writeSFixed64(he)},writeVarintField:function(ie,he){this.writeTag(ie,o.Varint),this.writeVarint(he)},writeSVarintField:function(ie,he){this.writeTag(ie,o.Varint),this.writeSVarint(he)},writeStringField:function(ie,he){this.writeTag(ie,o.Bytes),this.writeString(he)},writeFloatField:function(ie,he){this.writeTag(ie,o.Fixed32),this.writeFloat(he)},writeDoubleField:function(ie,he){this.writeTag(ie,o.Fixed64),this.writeDouble(he)},writeBooleanField:function(ie,he){this.writeVarintField(ie,!!he)}},FE}var GS=_(Fz());const VE=3;function Kie(d,o,c){o.glyphs=[],d===1&&c.readMessage(Wie,o)}function Wie(d,o,c){if(d===3){const{id:p,bitmap:v,width:m,height:x,left:M,top:j,advance:F}=c.readMessage(Hie,{});o.glyphs.push({id:p,bitmap:new cd({width:m+2*VE,height:x+2*VE},v),metrics:{width:m,height:x,left:M,top:j,advance:F}})}else d===4?o.ascender=c.readSVarint():d===5&&(o.descender=c.readSVarint())}function Hie(d,o,c){d===1?o.id=c.readVarint():d===2?o.bitmap=c.readBytes():d===3?o.width=c.readVarint():d===4?o.height=c.readVarint():d===5?o.left=c.readSVarint():d===6?o.top=c.readSVarint():d===7&&(o.advance=c.readVarint())}const Zie=VE,du={horizontal:1,vertical:2,horizontalOnly:3};class sb{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,c){const p=new sb;return p.scale=o||1,p.fontStack=c,p}static forImage(o){const c=new sb;return c.image=o,c}}class C_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,c){const p=new C_;for(let v=0;v<o.sections.length;v++){const m=o.sections[v];m.image?p.addImageSection(m):p.addTextSection(m,c)}return p}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(c,p){let v="";for(let m=0;m<c.length;m++){const x=c.charCodeAt(m+1)||null,M=c.charCodeAt(m-1)||null;v+=!p&&(x&&ya(x)&&!ob[c[m+1]]||M&&ya(M)&&!ob[c[m-1]])||!ob[c[m]]?c[m]:ob[c[m]]}return v}(this.text,o)}trim(){let o=0;for(let p=0;p<this.text.length&&KS[this.text.charCodeAt(p)];p++)o++;let c=this.text.length;for(let p=this.text.length-1;p>=0&&p>=o&&KS[this.text.charCodeAt(p)];p--)c--;this.text=this.text.substring(o,c),this.sectionIndex=this.sectionIndex.slice(o,c)}substring(o,c){const p=new C_;return p.text=this.text.substring(o,c),p.sectionIndex=this.sectionIndex.slice(o,c),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,c)=>Math.max(o,this.sections[c].scale),0)}addTextSection(o,c){this.text+=o.text,this.sections.push(sb.forText(o.scale,o.fontStack||c));const p=this.sections.length-1;for(let v=0;v<o.text.length;++v)this.sectionIndex.push(p)}addImageSection(o){const c=o.image&&o.image.namePrimary?o.image.getPrimary():null;if(!c)return void rn("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(sb.forImage(c)),this.sectionIndex.push(this.sections.length-1)):rn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function UE(d,o,c,p,v,m,x,M,j,F,E,N,L,k,I){const $=C_.fromFeature(d,v);N===du.vertical&&$.verticalizePunctuation(L);let Y=[];const ee=function(me,be,Re,Me,Ce,Xe){if(!me)return[];const Ie=[],Qe=function(dt,yt,ct,jt,Vt,kt){let cr=0;for(let ir=0;ir<dt.length();ir++){const Xt=dt.getSection(ir);cr+=Bz(dt.getCodePoint(ir),Xt,jt,Vt,yt,kt)}return cr/Math.max(1,Math.ceil(cr/ct))}(me,be,Re,Me,Ce,Xe),ot=me.text.indexOf("")>=0;let nt=0;for(let dt=0;dt<me.length();dt++){const yt=me.getSection(dt),ct=me.getCodePoint(dt);if(KS[ct]||(nt+=Bz(ct,yt,Me,Ce,be,Xe)),dt<me.length()-1){const jt=!((lt=ct)<11904||!(Cr["Bopomofo Extended"](lt)||Cr.Bopomofo(lt)||Cr["CJK Compatibility Forms"](lt)||Cr["CJK Compatibility Ideographs"](lt)||Cr["CJK Compatibility"](lt)||Cr["CJK Radicals Supplement"](lt)||Cr["CJK Strokes"](lt)||Cr["CJK Symbols and Punctuation"](lt)||Cr["CJK Unified Ideographs Extension A"](lt)||Cr["CJK Unified Ideographs"](lt)||Cr["Enclosed CJK Letters and Months"](lt)||Cr["Halfwidth and Fullwidth Forms"](lt)||Cr.Hiragana(lt)||Cr["Ideographic Description Characters"](lt)||Cr["Kangxi Radicals"](lt)||Cr["Katakana Phonetic Extensions"](lt)||Cr.Katakana(lt)||Cr["Vertical Forms"](lt)||Cr["Yi Radicals"](lt)||Cr["Yi Syllables"](lt)));(Yie[ct]||jt||yt.image)&&Ie.push(Uz(dt+1,nt,Qe,Ie,Xie(ct,me.getCodePoint(dt+1),jt&&ot),!1))}}var lt;return $z(Uz(me.length(),nt,Qe,Ie,0,!0))}($,F,m,o,p,k),{processBidirectionalText:oe,processStyledBidirectionalText:se}=$s;if(oe&&$.sections.length===1){const me=oe($.toString(),ee);for(const be of me){const Re=new C_;Re.text=be,Re.sections=$.sections;for(let Me=0;Me<be.length;Me++)Re.sectionIndex.push(0);Y.push(Re)}}else if(se){const me=se($.text,$.sectionIndex,ee);for(const be of me){const Re=new C_;Re.text=be[0],Re.sectionIndex=be[1],Re.sections=$.sections,Y.push(Re)}}else Y=function(me,be){const Re=[],Me=me.text;let Ce=0;for(const Xe of be)Re.push(me.substring(Ce,Xe)),Ce=Xe;return Ce<Me.length&&Re.push(me.substring(Ce,Me.length)),Re}($,ee);const ie=[],he={positionedLines:ie,text:$.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(me,be,Re,Me,Ce,Xe,Ie,Qe,ot,nt,lt,dt){let yt=0,ct=0,jt=0;const Vt=Qe==="right"?1:Qe==="left"?0:.5;let kt=!1;for(const pr of Ce){const vr=pr.getSections();for(const Qr of vr){if(Qr.image)continue;const fn=be[Qr.fontStack];if(fn&&(kt=fn.ascender!==void 0&&fn.descender!==void 0,!kt))break}if(!kt)break}let cr=0;for(const pr of Ce){pr.trim();const vr=pr.getMaxScale(),Qr=(vr-1)*Cs,fn={positionedGlyphs:[],lineOffset:0};me.positionedLines[cr]=fn;const gn=fn.positionedGlyphs;let yn=0;if(!pr.length()){ct+=Xe,++cr;continue}let On=0,jn=0;for(let Si=0;Si<pr.length();Si++){const ln=pr.getSection(Si),gi=pr.getSectionIndex(Si),xi=pr.getCodePoint(Si);let Zi=ln.scale,La=null,oo=null,za=null,Ta=Cs,Wa=0;const _o=!(ot===du.horizontal||!lt&&!ss(xi)||lt&&(KS[xi]||(ir=xi,Cr.Arabic(ir)||Cr["Arabic Supplement"](ir)||Cr["Arabic Extended-A"](ir)||Cr["Arabic Presentation Forms-A"](ir)||Cr["Arabic Presentation Forms-B"](ir))));if(ln.image){const Ms=Me[ln.image.serialize()];if(!Ms)continue;za=ln.image.id,me.iconsInText=me.iconsInText||!0,oo=Ms.paddedRect;const Ki=Ms.displaySize;Zi=Zi*Cs/dt,La={width:Ki[0],height:Ki[1],left:0,top:-3,advance:_o?Ki[1]:Ki[0],localGlyph:!1},Wa=kt?-La.height*Zi:vr*Cs-17-Ki[1]*Zi,Ta=La.advance;const Ql=(_o?Ki[0]:Ki[1])*Zi-Cs*vr;Ql>0&&Ql>yn&&(yn=Ql)}else{const Ms=Re[ln.fontStack];if(!Ms)continue;Ms[xi]&&(oo=Ms[xi]);const Ki=be[ln.fontStack];if(!Ki)continue;const Ql=Ki.glyphs[xi];if(!Ql)continue;if(La=Ql.metrics,Ta=xi!==8203?Cs:0,kt){const vh=Ki.ascender!==void 0?Math.abs(Ki.ascender):0,dd=Ki.descender!==void 0?Math.abs(Ki.descender):0,hd=(vh+dd)*Zi;On<hd&&(On=hd,jn=(vh-dd)/2*Zi),Wa=-vh*Zi}else Wa=(vr-Zi)*Cs-17}_o?(me.verticalizable=!0,gn.push({glyph:xi,imageName:za,x:yt,y:ct+Wa,vertical:_o,scale:Zi,localGlyph:La.localGlyph,fontStack:ln.fontStack,sectionIndex:gi,metrics:La,rect:oo}),yt+=Ta*Zi+nt):(gn.push({glyph:xi,imageName:za,x:yt,y:ct+Wa,vertical:_o,scale:Zi,localGlyph:La.localGlyph,fontStack:ln.fontStack,sectionIndex:gi,metrics:La,rect:oo}),yt+=La.advance*Zi+nt)}gn.length!==0&&(jt=Math.max(yt-nt,jt),kt?qz(gn,Vt,yn,jn,Xe*vr/2):qz(gn,Vt,yn,0,Xe/2)),yt=0;const Li=Xe*vr+yn;fn.lineOffset=Math.max(yn,Qr),ct+=Li,++cr}var ir;const Xt=ct,{horizontalAlign:Ut,verticalAlign:Er}=$E(Ie);(function(pr,vr,Qr,fn,gn,yn){const On=(vr-Qr)*gn,jn=-yn*fn;for(const Li of pr)for(const Si of Li.positionedGlyphs)Si.x+=On,Si.y+=jn})(me.positionedLines,Vt,Ut,Er,jt,Xt),me.top+=-Er*Xt,me.bottom=me.top+Xt,me.left+=-Ut*jt,me.right=me.left+jt,me.hasBaseline=kt}(he,o,c,p,Y,x,M,j,N,F,L,I),!function(me){for(const be of me)if(be.positionedGlyphs.length!==0)return!1;return!0}(ie)&&he}const KS={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Yie={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Bz(d,o,c,p,v,m){if(o.image){const x=p[o.image.serialize()];return x?x.displaySize[0]*o.scale*Cs/m+v:0}{const x=c[o.fontStack],M=x&&x.glyphs[d];return M?M.metrics.advance*o.scale+v:0}}function Vz(d,o,c,p){const v=Math.pow(d-o,2);return p?d<o?v/2:2*v:v+Math.abs(c)*c}function Xie(d,o,c){let p=0;return d===10&&(p-=1e4),c&&(p+=150),d!==40&&d!==65288||(p+=50),o!==41&&o!==65289||(p+=50),p}function Uz(d,o,c,p,v,m){let x=null,M=Vz(o,c,v,m);for(const j of p){const F=Vz(o-j.x,c,v,m)+j.badness;F<=M&&(x=j,M=F)}return{index:d,x:o,priorBreak:x,badness:M}}function $z(d){return d?$z(d.priorBreak).concat(d.index):[]}function $E(d){let o=.5,c=.5;switch(d){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:o,verticalAlign:c}}function qz(d,o,c,p,v){if(!(o||c||p||v))return;const m=d.length-1,x=d[m],M=(x.x+x.metrics.advance*x.scale)*o;for(let j=0;j<=m;j++)d[j].x-=M,d[j].y+=c+p+v}function Jie(d,o,c,p){const{horizontalAlign:v,verticalAlign:m}=$E(p),x=c[0]-d.displaySize[0]*v,M=c[1]-d.displaySize[1]*m;return{imagePrimary:d,imageSecondary:o,top:M,bottom:M+d.displaySize[1],left:x,right:x+d.displaySize[0]}}function Gz(d,o,c,p,v,m){const x=d.imagePrimary;let M;if(x.content){const Y=x.content,ee=x.pixelRatio||1;M=[Y[0]/ee,Y[1]/ee,x.displaySize[0]-Y[2]/ee,x.displaySize[1]-Y[3]/ee]}const j=o.left*m,F=o.right*m;let E,N,L,k;c==="width"||c==="both"?(k=v[0]+j-p[3],N=v[0]+F+p[1]):(k=v[0]+(j+F-x.displaySize[0])/2,N=k+x.displaySize[0]);const I=o.top*m,$=o.bottom*m;return c==="height"||c==="both"?(E=v[1]+I-p[0],L=v[1]+$+p[2]):(E=v[1]+(I+$-x.displaySize[1])/2,L=E+x.displaySize[1]),{imagePrimary:x,imageSecondary:void 0,top:E,right:N,bottom:L,left:k,collisionPadding:M}}class Up extends It{constructor(o,c,p,v,m){super(o,c),this.angle=v,this.z=p,m!==void 0&&(this.segment=m)}clone(){return new Up(this.x,this.y,this.z,this.angle,this.segment)}}function Kz(d,o,c,p,v){if(o.segment===void 0)return!0;let m=o,x=o.segment+1,M=0;for(;M>-c/2;){if(x--,x<0)return!1;M-=d[x].dist(m),m=d[x]}M+=d[x].dist(d[x+1]),x++;const j=[];let F=0;for(;M<c/2;){const E=d[x],N=d[x+1];if(!N)return!1;let L=d[x-1].angleTo(E)-E.angleTo(N);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),j.push({distance:M,angleDelta:L}),F+=L;M-j[0].distance>p;)F-=j.shift().angleDelta;if(F>v)return!1;x++,M+=E.dist(N)}return!0}function Wz(d){let o=0;for(let c=0;c<d.length-1;c++)o+=d[c].dist(d[c+1]);return o}function Hz(d,o,c){return d?.6*o*c:0}function Zz(d,o){return Math.max(d?d.right-d.left:0,o?o.right-o.left:0)}function Qie(d,o,c,p,v,m){const x=Hz(c,v,m),M=Zz(c,p)*m;let j=0;const F=Wz(d)/2;for(let E=0;E<d.length-1;E++){const N=d[E],L=d[E+1],k=N.dist(L);if(j+k>F){const I=(F-j)/k,$=Dr(N.x,L.x,I),Y=Dr(N.y,L.y,I),ee=new Up($,Y,0,L.angleTo(N),E);return!x||Kz(d,ee,M,x,o)?ee:void 0}j+=k}}function eae(d,o,c,p,v,m,x,M,j){const F=Hz(p,m,x),E=Zz(p,v),N=E*x,L=d[0].x===0||d[0].x===j||d[0].y===0||d[0].y===j;return o-N<o/4&&(o=N+o/4),Yz(d,L?o/2*M%o:(E/2+2*m)*x*M%o,o,F,c,N,L,!1,j)}function Yz(d,o,c,p,v,m,x,M,j){const F=m/2,E=Wz(d);let N=0,L=o-c,k=[];for(let I=0;I<d.length-1;I++){const $=d[I],Y=d[I+1],ee=$.dist(Y),oe=Y.angleTo($);for(;L+c<N+ee;){L+=c;const se=(L-N)/ee,ie=Dr($.x,Y.x,se),he=Dr($.y,Y.y,se);if(ie>=0&&ie<j&&he>=0&&he<j&&L-F>=0&&L+F<=E){const me=new Up(ie,he,0,oe,I);p&&!Kz(d,me,m,p,v)||k.push(me)}}N+=ee}return M||k.length||x||(k=Yz(d,N/2,c,p,v,m,x,!0,j)),k}function Xz(d,o,c,p,v){const m=[];for(let x=0;x<d.length;x++){const M=d[x];let j;for(let F=0;F<M.length-1;F++){let E=M[F],N=M[F+1];E.x<o&&N.x<o||(E.x<o?E=new It(o,E.y+(o-E.x)/(N.x-E.x)*(N.y-E.y))._round():N.x<o&&(N=new It(o,E.y+(o-E.x)/(N.x-E.x)*(N.y-E.y))._round()),E.y<c&&N.y<c||(E.y<c?E=new It(E.x+(c-E.y)/(N.y-E.y)*(N.x-E.x),c)._round():N.y<c&&(N=new It(E.x+(c-E.y)/(N.y-E.y)*(N.x-E.x),c)._round()),E.x>=p&&N.x>=p||(E.x>=p?E=new It(p,E.y+(p-E.x)/(N.x-E.x)*(N.y-E.y))._round():N.x>=p&&(N=new It(p,E.y+(p-E.x)/(N.x-E.x)*(N.y-E.y))._round()),E.y>=v&&N.y>=v||(E.y>=v?E=new It(E.x+(v-E.y)/(N.y-E.y)*(N.x-E.x),v)._round():N.y>=v&&(N=new It(E.x+(v-E.y)/(N.y-E.y)*(N.x-E.x),v)._round()),j&&E.equals(j[j.length-1])||(j=[E],m.push(j)),j.push(N)))))}}return m}function Jz(d){let o=0,c=0;for(const x of d)o+=x.w*x.h,c=Math.max(c,x.w);d.sort((x,M)=>M.h-x.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),c),h:1/0}];let v=0,m=0;for(const x of d)for(let M=p.length-1;M>=0;M--){const j=p[M];if(!(x.w>j.w||x.h>j.h)){if(x.x=j.x,x.y=j.y,m=Math.max(m,x.y+x.h),v=Math.max(v,x.x+x.w),x.w===j.w&&x.h===j.h){const F=p.pop();M<p.length&&(p[M]=F)}else x.h===j.h?(j.x+=x.w,j.w-=x.w):x.w===j.w?(j.y+=x.h,j.h-=x.h):(p.push({x:j.x+x.w,y:j.y,w:j.w-x.w,h:x.h}),j.y+=x.h,j.h-=x.h);break}}return{w:v,h:m,fill:o/(v*m)||0}}hr(Up,"Anchor");const lb=1;class cb{static getImagePositionScale(o,c,p){return c&&o&&o.options&&o.options.transform?{x:o.options.transform.a,y:o.options.transform.d}:{x:p,y:p}}constructor(o,{pixelRatio:c,version:p,stretchX:v,stretchY:m,content:x,sdf:M,usvg:j},F,E){this.paddedRect=o,this.pixelRatio=c,this.stretchX=v,this.stretchY=m,this.content=x,this.version=p,this.padding=F,this.sdf=M,this.scale=cb.getImagePositionScale(E,j,c)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class Qz{constructor(o,c,p){const v={},m={};this.haveRenderCallbacks=[];const x=[];this.addImages(o,v,lb,x),this.addImages(c,m,2,x);const{w:M,h:j}=Jz(x),F=new zo({width:M||1,height:j||1});for(const E in o){const N=o[E],L=v[E].paddedRect;zo.copy(N.data,F,{x:0,y:0},{x:L.x+lb,y:L.y+lb},N.data,p,N.sdf)}for(const E in c){const N=c[E],L=m[E].paddedRect;let k=m[E].padding;const I=L.x+k,$=L.y+k,Y=N.data.width,ee=N.data.height;k=k>1?k-1:k,zo.copy(N.data,F,{x:0,y:0},{x:I,y:$},N.data,p),zo.copy(N.data,F,{x:0,y:ee-k},{x:I,y:$-k},{width:Y,height:k},p),zo.copy(N.data,F,{x:0,y:0},{x:I,y:$+ee},{width:Y,height:k},p),zo.copy(N.data,F,{x:Y-k,y:0},{x:I-k,y:$},{width:k,height:ee},p),zo.copy(N.data,F,{x:0,y:0},{x:I+Y,y:$},{width:k,height:ee},p),zo.copy(N.data,F,{x:Y-k,y:ee-k},{x:I-k,y:$-k},{width:k,height:k},p),zo.copy(N.data,F,{x:0,y:ee-k},{x:I+Y,y:$-k},{width:k,height:k},p),zo.copy(N.data,F,{x:0,y:0},{x:I+Y,y:$+ee},{width:k,height:k},p),zo.copy(N.data,F,{x:Y-k,y:0},{x:I-k,y:$+ee},{width:k,height:k},p)}this.lut=p,this.image=F,this.iconPositions=v,this.patternPositions=m}addImages(o,c,p,v){for(const m in o){const x=o[m],M={x:0,y:0,w:x.data.width+2*p,h:x.data.height+2*p};v.push(M);const j=sl.deserializeFromString(m);c[m]=new cb(M,x,p,j),x.hasRenderCallback&&this.haveRenderCallbacks.push(j.id)}}patchUpdatedImages(o,c,p){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(v=>o.hasImage(v,p)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,p);for(const v in o.getUpdatedImages(p)){for(const m of Object.keys(this.iconPositions))sl.deserializeId(m)===v&&this.patchUpdatedImage(this.iconPositions[m],o.getImage(v,p),c);for(const m of Object.keys(this.patternPositions))sl.deserializeId(m)===v&&this.patchUpdatedImage(this.patternPositions[m],o.getImage(v,p),c)}}patchUpdatedImage(o,c,p){if(!o||!c||o.version===c.version)return;o.version=c.version;const[v,m]=o.tl,x=o.sdf;if(this.lut||x){const M={width:c.data.width,height:c.data.height},j=new zo(M);zo.copy(c.data,j,{x:0,y:0},{x:0,y:0},M,this.lut,x),p.update(j,{position:{x:v,y:m}})}else p.update(c.data,{position:{x:v,y:m}})}}hr(cb,"ImagePosition"),hr(Qz,"ImageAtlas");const WS=1e20;function eF(d,o,c,p,v,m,x,M,j){for(let F=o;F<o+p;F++)tF(d,c*m+F,m,v,x,M,j);for(let F=c;F<c+v;F++)tF(d,F*m+o,1,p,x,M,j)}function tF(d,o,c,p,v,m,x){m[0]=0,x[0]=-1e20,x[1]=WS,v[0]=d[o];for(let M=1,j=0,F=0;M<p;M++){v[M]=d[o+M*c];const E=M*M;do{const N=m[j];F=(v[M]-v[N]+E-N*N)/(M-N)/2}while(F<=x[j]&&--j>-1);j++,m[j]=M,x[j]=F,x[j+1]=WS}for(let M=0,j=0;M<p;M++){for(;x[j+1]<M;)j++;const F=m[j],E=M-F;d[o+M*c]=v[F]+E*E}}const ph=2,qE={none:0,ideographs:1,all:2};class M_{constructor(o,c,p){this.requestManager=o,this.localGlyphMode=c,this.localFontFamily=p,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,c){this.urls[c]=o}getGlyphs(o,c,p){const v=[],m=this.urls[c]||Ui.GLYPHS_URL;for(const x in o)for(const M of o[x])v.push({stack:x,id:M});Bi(v,({stack:x,id:M},j)=>{let F=this.entries[x];F||(F=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=F.glyphs[M];if(E!==void 0)return void j(null,{stack:x,id:M,glyph:E});if(E=this._tinySDF(F,x,M),E)return F.glyphs[M]=E,void j(null,{stack:x,id:M,glyph:E});const N=Math.floor(M/256);if(256*N>65535)return rn("glyphs > 65535 not supported"),void j(null,{stack:x,id:M,glyph:E});if(F.ranges[N])return void j(null,{stack:x,id:M,glyph:E});let L=F.requests[N];L||(L=F.requests[N]=[],M_.loadGlyphRange(x,N,m,this.requestManager,(k,I)=>{if(I){F.ascender=I.ascender,F.descender=I.descender;for(const $ in I.glyphs)this._doesCharSupportLocalGlyph(+$)||(F.glyphs[+$]=I.glyphs[+$]);F.ranges[N]=!0}for(const $ of L)$(k,I);delete F.requests[N]})),L.push((k,I)=>{k?j(k):I&&j(null,{stack:x,id:M,glyph:I.glyphs[M]||null})})},(x,M)=>{if(x)p(x);else if(M){const j={};for(const{stack:F,id:E,glyph:N}of M)j[F]===void 0&&(j[F]={}),j[F].glyphs===void 0&&(j[F].glyphs={}),j[F].glyphs[E]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics},j[F].ascender=this.entries[F].ascender,j[F].descender=this.entries[F].descender;p(null,j)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==qE.none&&(this.localGlyphMode===qE.all?!!this.localFontFamily:!!this.localFontFamily&&(Cr["CJK Unified Ideographs"](o)||Cr["Hangul Syllables"](o)||Cr.Hiragana(o)||Cr.Katakana(o)||Cr["CJK Symbols and Punctuation"](o)||Cr["CJK Unified Ideographs Extension A"](o)||Cr["CJK Unified Ideographs Extension B"](o)||Cr.Osage(o)))}_tinySDF(o,c,p){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let m=o.tinySDF;if(!m){let $="400";/bold/i.test(c)?$="900":/medium/i.test(c)?$="500":/light/i.test(c)&&($="200"),m=o.tinySDF=new M_.TinySDF({fontFamily:v,fontWeight:$,fontSize:24*ph,buffer:3*ph,radius:8*ph}),m.fontWeight=$}if(this.localGlyphs[m.fontWeight][p])return this.localGlyphs[m.fontWeight][p];const x=String.fromCodePoint(p),{data:M,width:j,height:F,glyphWidth:E,glyphHeight:N,glyphLeft:L,glyphTop:k,glyphAdvance:I}=m.draw(x);return this.localGlyphs[m.fontWeight][p]={id:p,bitmap:new cd({width:j,height:F},M),metrics:{width:E/ph,height:N/ph,left:L/ph,top:k/ph-27,advance:I/ph,localGlyph:!0}}}}M_.loadGlyphRange=function(d,o,c,p,v){const m=256*o,x=m+255,M=p.transformRequest(p.normalizeGlyphsURL(c).replace("{fontstack}",d).replace("{range}",`${m}-${x}`),Pn.Glyphs);to(M,(j,F)=>{if(j)v(j);else if(F){const E={},N=function(L){return new GS(L).readFields(Kie,{})}(F);for(const L of N.glyphs)E[L.id]=L;v(null,{glyphs:E,ascender:N.ascender,descender:N.descender})}})},M_.TinySDF=class{constructor({fontSize:d=24,buffer:o=3,radius:c=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=o,this.cutoff=p,this.radius=c;const M=this.size=d+4*o,j=this._createCanvas(M),F=this.ctx=j.getContext("2d",{willReadFrequently:!0});F.font=`${x} ${m} ${d}px ${v}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(d){const o=document.createElement("canvas");return o.width=o.height=d,o}draw(d){const{width:o,actualBoundingBoxAscent:c,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:m}=this.ctx.measureText(d),x=Math.ceil(c),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-v))),j=Math.min(this.size-this.buffer,x+Math.ceil(p)),F=M+2*this.buffer,E=j+2*this.buffer,N=Math.max(F*E,0),L=new Uint8ClampedArray(N),k={data:L,width:F,height:E,glyphWidth:M,glyphHeight:j,glyphTop:x,glyphLeft:0,glyphAdvance:o};if(M===0||j===0)return k;const{ctx:I,buffer:$,gridInner:Y,gridOuter:ee}=this;I.clearRect($,$,M,j),I.fillText(d,$,$+x);const oe=I.getImageData($,$,M,j);ee.fill(WS,0,N),Y.fill(0,0,N);for(let se=0;se<j;se++)for(let ie=0;ie<M;ie++){const he=oe.data[4*(se*M+ie)+3]/255;if(he===0)continue;const me=(se+$)*F+ie+$;if(he===1)ee[me]=0,Y[me]=WS;else{const be=.5-he;ee[me]=be>0?be*be:0,Y[me]=be<0?be*be:0}}eF(ee,0,0,F,E,F,this.f,this.v,this.z),eF(Y,$,$,M,j,F,this.f,this.v,this.z);for(let se=0;se<N;se++){const ie=Math.sqrt(ee[se])-Math.sqrt(Y[se]);L[se]=Math.round(255-255*(ie/this.radius+this.cutoff))}return k}};const Vy=lb;function rF(d,o){return d+o[1]-o[0]}function nF(d,o,c,p,v=1){const m=[],x=d.imagePrimary,M=x.pixelRatio,j=x.paddedRect.w-2*Vy,F=x.paddedRect.h-2*Vy,E=(d.right-d.left)*v,N=(d.bottom-d.top)*v,L=x.stretchX||[[0,j]],k=x.stretchY||[[0,F]],I=L.reduce(rF,0),$=k.reduce(rF,0),Y=j-I,ee=F-$;let oe=0,se=I,ie=0,he=$,me=0,be=Y,Re=0,Me=ee;if(x.content&&p){const Xe=x.content;oe=HS(L,0,Xe[0]),ie=HS(k,0,Xe[1]),se=HS(L,Xe[0],Xe[2]),he=HS(k,Xe[1],Xe[3]),me=Xe[0]-oe,Re=Xe[1]-ie,be=Xe[2]-Xe[0]-se,Me=Xe[3]-Xe[1]-he}const Ce=(Xe,Ie,Qe,ot)=>{const nt=ZS(Xe.stretch-oe,se,E,d.left*v),lt=YS(Xe.fixed-me,be,Xe.stretch,I),dt=ZS(Ie.stretch-ie,he,N,d.top*v),yt=YS(Ie.fixed-Re,Me,Ie.stretch,$),ct=ZS(Qe.stretch-oe,se,E,d.left*v),jt=YS(Qe.fixed-me,be,Qe.stretch,I),Vt=ZS(ot.stretch-ie,he,N,d.top*v),kt=YS(ot.fixed-Re,Me,ot.stretch,$),cr=new It(nt,dt),ir=new It(ct,dt),Xt=new It(ct,Vt),Ut=new It(nt,Vt),Er=new It(lt/M,yt/M),pr=new It(jt/M,kt/M),vr=o*Math.PI/180;if(vr){const jn=Math.sin(vr),Li=Math.cos(vr),Si=[Li,-jn,jn,Li];cr._matMult(Si),ir._matMult(Si),Ut._matMult(Si),Xt._matMult(Si)}const Qr=Xe.stretch+Xe.fixed,fn=Qe.stretch+Qe.fixed,gn=Ie.stretch+Ie.fixed,yn=ot.stretch+ot.fixed,On=d.imageSecondary;return{tl:cr,tr:ir,bl:Ut,br:Xt,texPrimary:{x:x.paddedRect.x+Vy+Qr,y:x.paddedRect.y+Vy+gn,w:fn-Qr,h:yn-gn},texSecondary:On?{x:On.paddedRect.x+Vy+Qr,y:On.paddedRect.y+Vy+gn,w:fn-Qr,h:yn-gn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Er,pixelOffsetBR:pr,minFontScaleX:be/M/E,minFontScaleY:Me/M/N,isSDF:c}};if(p&&(x.stretchX||x.stretchY)){const Xe=iF(L,Y,I),Ie=iF(k,ee,$);for(let Qe=0;Qe<Xe.length-1;Qe++){const ot=Xe[Qe],nt=Xe[Qe+1];for(let lt=0;lt<Ie.length-1;lt++)m.push(Ce(ot,Ie[lt],nt,Ie[lt+1]))}}else m.push(Ce({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:j+1},{fixed:0,stretch:F+1}));return m}function HS(d,o,c){let p=0;for(const v of d)p+=Math.max(o,Math.min(c,v[1]))-Math.max(o,Math.min(c,v[0]));return p}function iF(d,o,c){const p=[{fixed:-1,stretch:0}];for(const[v,m]of d){const x=p[p.length-1];p.push({fixed:v-x.stretch,stretch:x.stretch}),p.push({fixed:v-x.stretch,stretch:x.stretch+(m-v)})}return p.push({fixed:o+Vy,stretch:c}),p}function ZS(d,o,c,p){return d/o*c+p}function YS(d,o,c,p){return d-o*c/p}function tae(d,o,c,p){const v=o+d.positionedLines[p].lineOffset;return p===0?c+v/2:c+(v+(o+d.positionedLines[p-1].lineOffset))/2}function rae(d,o=1,c=!1){let p=1/0,v=1/0,m=-1/0,x=-1/0;const M=d[0];for(let k=0;k<M.length;k++){const I=M[k];(!k||I.x<p)&&(p=I.x),(!k||I.y<v)&&(v=I.y),(!k||I.x>m)&&(m=I.x),(!k||I.y>x)&&(x=I.y)}const j=Math.min(m-p,x-v);let F=j/2;const E=new Io([],nae);if(j===0)return new It(p,v);for(let k=p;k<m;k+=j)for(let I=v;I<x;I+=j)E.push(new O_(k+F,I+F,F,d));let N=function(k){let I=0,$=0,Y=0;const ee=k[0];for(let oe=0,se=ee.length,ie=se-1;oe<se;ie=oe++){const he=ee[oe],me=ee[ie],be=he.x*me.y-me.x*he.y;$+=(he.x+me.x)*be,Y+=(he.y+me.y)*be,I+=3*be}return new O_($/I,Y/I,0,k)}(d),L=E.length;for(;E.length;){const k=E.pop();(k.d>N.d||!N.d)&&(N=k,c&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,L)),k.max-N.d<=o||(F=k.h/2,E.push(new O_(k.p.x-F,k.p.y-F,F,d)),E.push(new O_(k.p.x+F,k.p.y-F,F,d)),E.push(new O_(k.p.x-F,k.p.y+F,F,d)),E.push(new O_(k.p.x+F,k.p.y+F,F,d)),L+=4)}return c&&(console.log(`num probes: ${L}`),console.log(`best distance: ${N.d}`)),N.p}function nae(d,o){return o.max-d.max}class O_{constructor(o,c,p,v){this.p=new It(o,c),this.h=p,this.d=function(m,x){let M=!1,j=1/0;for(let F=0;F<x.length;F++){const E=x[F];for(let N=0,L=E.length,k=L-1;N<L;k=N++){const I=E[N],$=E[k];I.y>m.y!=$.y>m.y&&m.x<($.x-I.x)*(m.y-I.y)/($.y-I.y)+I.x&&(M=!M),j=Math.min(j,Ue(m,I,$))}}return(M?1:-1)*Math.sqrt(j)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const GE=Number.POSITIVE_INFINITY,iae=Math.sqrt(2);function aF(d,[o,c]){let p=0,v=0;if(c===GE){o<0&&(o=0);const m=o/iae;switch(d){case"top-right":case"top-left":v=m-7;break;case"bottom-right":case"bottom-left":v=7-m;break;case"bottom":v=7-o;break;case"top":v=o-7}switch(d){case"top-right":case"bottom-right":p=-m;break;case"top-left":case"bottom-left":p=m;break;case"left":p=o;break;case"right":p=-o}}else{switch(o=Math.abs(o),c=Math.abs(c),d){case"top-right":case"top-left":case"top":v=c-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-c}switch(d){case"top-right":case"bottom-right":case"right":p=-o;break;case"top-left":case"bottom-left":case"left":p=o}}return[p,v]}function KE(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function aae(d,o,c,p,v,m,x,M,j,F,E,N,L,k,I){let $=m.textMaxSize.evaluate(o,{},N);$===void 0?$=x*m.textScaleFactor:$*=m.textScaleFactor;const Y=d.layers[0].layout,ee=Y.get("icon-offset").evaluate(o,{},N),oe=sF(c.horizontal)||c.vertical,se=L.name==="globe",ie=Cs,he=x*m.textScaleFactor/ie,me=d.tilePixelRatio*$/ie,be=(nt=d.overscaling,d.zoom>18&&nt>2&&(nt>>=1),Math.max(ar/(512*nt),1)*Y.get("symbol-spacing")),Re=Y.get("text-padding")*d.tilePixelRatio,Me=Y.get("icon-padding")*d.tilePixelRatio,Ce=rt(Y.get("text-max-angle")),Xe=Y.get("text-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",Ie=Y.get("icon-rotation-alignment")==="map"&&Y.get("symbol-placement")!=="point",Qe=Y.get("symbol-placement"),ot=be/2;var nt;const lt=Y.get("icon-text-fit").evaluate(o,{},N),dt=Y.get("icon-text-fit-padding").evaluate(o,{},N),yt=lt!=="none";let ct;d.hasAnyIconTextFit===!1&&yt&&(d.hasAnyIconTextFit=!0),p&&yt&&(d.allowVerticalPlacement&&c.vertical&&(ct=Gz(p,c.vertical,lt,dt,ee,he)),oe&&(p=Gz(p,oe,lt,dt,ee,he)));const jt=(Vt,kt,cr)=>{if(kt.x<0||kt.x>=ar||kt.y<0||kt.y>=ar)return;let ir=null;if(se){const{x:Xt,y:Ut,z:Er}=L.projectTilePoint(kt.x,kt.y,cr);ir={anchor:new Up(Xt,Ut,Er,0,void 0),up:L.upVector(cr,kt.x,kt.y)}}(function(Xt,Ut,Er,pr,vr,Qr,fn,gn,yn,On,jn,Li,Si,ln,gi,xi,Zi,La,oo,za,Ta,Wa,_o,Ms,Ki,Ql,vh){const dd=Xt.addToLineVertexArray(Ut,pr);let hd,Ky,gg,Wy,Cb,V5,U5,$5=0,q5=0,G5=0,K5=0,EC=-1,CC=-1;const Mf={};let W5=ol("");const Hy=Er?Er.anchor:Ut,MC=yn.layout.get("icon-text-fit").evaluate(Ta,{},Ki)!=="none";let OC=0,RC=0;if(yn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[OC,RC]=yn.layout.get("text-offset").evaluate(Ta,{},Ki).map(fu=>fu*Cs):(OC=yn.layout.get("text-radial-offset").evaluate(Ta,{},Ki)*Cs,RC=GE),Xt.allowVerticalPlacement&&vr.vertical){const fu=vr.vertical;if(gi)V5=WE(fu),gn&&(U5=WE(gn));else{const ec=yn.layout.get("text-rotate").evaluate(Ta,{},Ki)+90;gg=XS(On,Hy,Ut,jn,Li,Si,fu,ln,ec,xi),gn&&(Wy=XS(On,Hy,Ut,jn,Li,Si,gn,La,ec))}}if(Qr){const fu=Xt.iconSizeData,ec=yn.layout.get("icon-rotate").evaluate(Ta,{},Ki),Mb=nF(Qr,ec,_o,MC,Wa.iconScaleFactor),jC=gn?nF(gn,ec,_o,MC,Wa.iconScaleFactor):void 0;Ky=XS(On,Hy,Ut,jn,Li,Si,Qr,La,ec,null),$5=4*Mb.length;let Zy=null;fu.kind==="source"?(Zy=[fh*yn.layout.get("icon-size").evaluate(Ta,{},Ki)*Wa.iconScaleFactor],Zy[0]>hg&&rn(`${Xt.layerIds[0]}: Value for "icon-size" is >= ${ub}. Reduce your "icon-size".`)):fu.kind==="composite"&&(Zy=[fh*Wa.compositeIconSizes[0].evaluate(Ta,{},Ki)*Wa.iconScaleFactor,fh*Wa.compositeIconSizes[1].evaluate(Ta,{},Ki)*Wa.iconScaleFactor],(Zy[0]>hg||Zy[1]>hg)&&rn(`${Xt.layerIds[0]}: Value for "icon-size" is >= ${ub}. Reduce your "icon-size".`)),Xt.addSymbols(Xt.icon,Mb,Zy,za,oo,Ta,!1,Er,Ut,dd.lineStartIndex,dd.lineLength,-1,Ms,Ki,Ql,vh),EC=Xt.icon.placedSymbolArray.length-1,jC&&(q5=4*jC.length,Xt.addSymbols(Xt.icon,jC,Zy,za,oo,Ta,du.vertical,Er,Ut,dd.lineStartIndex,dd.lineLength,-1,Ms,Ki,Ql,vh),CC=Xt.icon.placedSymbolArray.length-1)}for(const fu in vr.horizontal){const ec=vr.horizontal[fu];hd||(W5=ol(ec.text),gi?Cb=WE(ec):hd=XS(On,Hy,Ut,jn,Li,Si,ec,ln,yn.layout.get("text-rotate").evaluate(Ta,{},Ki),xi));const Mb=ec.positionedLines.length===1;if(G5+=oF(Xt,Er,Ut,ec,fn,yn,gi,Ta,xi,dd,vr.vertical?du.horizontal:du.horizontalOnly,Mb?Object.keys(vr.horizontal):[fu],Mf,EC,Wa,Ms,Ki,Ql),Mb)break}vr.vertical&&(K5+=oF(Xt,Er,Ut,vr.vertical,fn,yn,gi,Ta,xi,dd,du.vertical,["vertical"],Mf,CC,Wa,Ms,Ki,Ql));let yg=-1;const kC=(fu,ec)=>fu?Math.max(fu,ec):ec;yg=kC(Cb,yg),yg=kC(V5,yg),yg=kC(U5,yg);const zoe=yg>-1?1:0;Xt.glyphOffsetArray.length>=65535&&rn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ta.sortKey!==void 0&&Xt.addToSortKeyRanges(Xt.symbolInstances.length,Ta.sortKey),Xt.symbolInstances.emplaceBack(Ut.x,Ut.y,Hy.x,Hy.y,Hy.z,Mf.right>=0?Mf.right:-1,Mf.center>=0?Mf.center:-1,Mf.left>=0?Mf.left:-1,Mf.vertical>=0?Mf.vertical:-1,EC,CC,W5,hd!==void 0?hd:Xt.collisionBoxArray.length,hd!==void 0?hd+1:Xt.collisionBoxArray.length,gg!==void 0?gg:Xt.collisionBoxArray.length,gg!==void 0?gg+1:Xt.collisionBoxArray.length,Ky!==void 0?Ky:Xt.collisionBoxArray.length,Ky!==void 0?Ky+1:Xt.collisionBoxArray.length,Wy||Xt.collisionBoxArray.length,Wy?Wy+1:Xt.collisionBoxArray.length,jn,G5,K5,$5,q5,zoe,0,OC,RC,yg,0,MC?1:0)})(d,kt,ir,Vt,c,p,v,ct,d.layers[0],d.collisionBoxArray,o.index,o.sourceLayerIndex,d.index,Re,Xe,j,0,Me,Ie,ee,o,m,F,E,N,k,I)};if(Qe==="line")for(const Vt of Xz(o.geometry,0,0,ar,ar)){const kt=eae(Vt,be,Ce,c.vertical||oe,p,ie,me,d.overscaling,ar);for(const cr of kt)oe&&oae(d,oe.text,ot,cr)||jt(Vt,cr,N)}else if(Qe==="line-center"){for(const Vt of o.geometry)if(Vt.length>1){const kt=Qie(Vt,Ce,c.vertical||oe,p,ie,me);kt&&jt(Vt,kt,N)}}else if(o.type==="Polygon")for(const Vt of Ar(o.geometry,0)){const kt=rae(Vt,16);jt(Vt[0],new Up(kt.x,kt.y,0,0,void 0),N)}else if(o.type==="LineString")for(const Vt of o.geometry)jt(Vt,new Up(Vt[0].x,Vt[0].y,0,0,void 0),N);else if(o.type==="Point")for(const Vt of o.geometry)for(const kt of Vt)jt([kt],new Up(kt.x,kt.y,0,0,void 0),N)}const ub=255,hg=ub*fh;function oF(d,o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y,ee){const oe=function(he,me,be,Re,Me,Ce,Xe,Ie){const Qe=[];if(me.positionedLines.length===0)return Qe;const ot=Re.layout.get("text-rotate").evaluate(Ce,{})*Math.PI/180,nt=function(jt){const Vt=jt[0],kt=jt[1],cr=Vt*kt;return cr>0?[Vt,-kt]:cr<0?[-Vt,kt]:Vt===0?[kt,Vt]:[kt,-Vt]}(be);let lt=Math.abs(me.top-me.bottom);for(const jt of me.positionedLines)lt-=jt.lineOffset;const dt=me.positionedLines.length,yt=lt/dt;let ct=me.top-be[1];for(let jt=0;jt<dt;++jt){const Vt=me.positionedLines[jt];ct=tae(me,yt,ct,jt);for(const kt of Vt.positionedGlyphs){if(!kt.rect)continue;const cr=kt.rect||{};let ir=Zie+1,Xt=!0,Ut=1,Er=0;if(kt.imageName){const za=Xe[To.build(kt.imageName).getSerializedPrimary()];if(!za)continue;if(za.sdf){rn("SDF images are not supported in formatted text and will be ignored.");continue}Xt=!1,Ut=za.pixelRatio,ir=lb/Ut}const pr=(Me||Ie)&&kt.vertical,vr=kt.metrics.advance*kt.scale/2,Qr=kt.metrics,fn=kt.rect;if(fn===null)continue;Ie&&me.verticalizable&&(Er=kt.imageName?vr-kt.metrics.width*kt.scale/2:0);const gn=Me?[kt.x+vr,kt.y]:[0,0];let yn=[0,0],On=[0,0],jn=!1;Me||(pr?(On=[kt.x+vr+nt[0],kt.y+nt[1]-Er],jn=!0):yn=[kt.x+vr+be[0],kt.y+be[1]-Er]);const Li=fn.w*kt.scale/(Ut*(kt.localGlyph?ph:1)),Si=fn.h*kt.scale/(Ut*(kt.localGlyph?ph:1));let ln,gi,xi,Zi;if(pr){const za=kt.y-ct,Ta=new It(-vr,vr-za),Wa=-Math.PI/2,_o=new It(...On);ln=new It(-vr+yn[0],yn[1]),ln._rotateAround(Wa,Ta)._add(_o),ln.x+=-za+vr,ln.y-=(Qr.left-ir)*kt.scale;const Ms=kt.imageName?Qr.advance*kt.scale:Cs*kt.scale,Ki=String.fromCodePoint(kt.glyph);$ie(Ki)?ln.x+=(1-ir)*kt.scale:qie(Ki)?ln.x+=Ms-Qr.height*kt.scale+(-ir-1)*kt.scale:ln.x+=kt.imageName||Qr.width+2*ir===fn.w&&Qr.height+2*ir===fn.h?(Ms-Si)/2:(Ms-(Qr.height+2*ir)*kt.scale)/2,gi=new It(ln.x,ln.y-Li),xi=new It(ln.x+Si,ln.y),Zi=new It(ln.x+Si,ln.y-Li)}else{const za=(Qr.left-ir)*kt.scale-vr+yn[0],Ta=(-Qr.top-ir)*kt.scale+yn[1],Wa=za+Li,_o=Ta+Si;ln=new It(za,Ta),gi=new It(Wa,Ta),xi=new It(za,_o),Zi=new It(Wa,_o)}if(ot){let za;za=Me?new It(0,0):jn?new It(nt[0],nt[1]):new It(be[0],be[1]),ln._rotateAround(ot,za),gi._rotateAround(ot,za),xi._rotateAround(ot,za),Zi._rotateAround(ot,za)}const La=new It(0,0),oo=new It(0,0);Qe.push({tl:ln,tr:gi,bl:xi,br:Zi,texPrimary:cr,texSecondary:void 0,writingMode:me.writingMode,glyphOffset:gn,sectionIndex:kt.sectionIndex,isSDF:Xt,pixelOffsetTL:La,pixelOffsetBR:oo,minFontScaleX:0,minFontScaleY:0})}}return Qe}(0,p,j,m,x,M,v,d.allowVerticalPlacement),se=d.textSizeData;let ie=null;se.kind==="source"?(ie=[fh*m.layout.get("text-size").evaluate(M,{},Y)*I.textScaleFactor],ie[0]>hg&&rn(`${d.layerIds[0]}: Value for "text-size" is >= ${ub}. Reduce your "text-size".`)):se.kind==="composite"&&(ie=[fh*I.compositeTextSizes[0].evaluate(M,{},Y)*I.textScaleFactor,fh*I.compositeTextSizes[1].evaluate(M,{},Y)*I.textScaleFactor],(ie[0]>hg||ie[1]>hg)&&rn(`${d.layerIds[0]}: Value for "text-size" is >= ${ub}. Reduce your "text-size".`)),d.addSymbols(d.text,oe,ie,j,x,M,E,o,c,F.lineStartIndex,F.lineLength,k,$,Y,ee,!1);for(const he of N)L[he]=d.text.placedSymbolArray.length-1;return 4*oe.length}function sF(d){for(const o in d)return d[o];return null}function XS(d,o,c,p,v,m,x,M,j,F){let E=x.top,N=x.bottom,L=x.left,k=x.right;const I=x.collisionPadding;if(I&&(L-=I[0],E-=I[1],k+=I[2],N+=I[3]),j){const $=new It(L,E),Y=new It(k,E),ee=new It(L,N),oe=new It(k,N),se=rt(j);let ie=new It(0,0);F&&(ie=new It(F[0],F[1])),$._rotateAround(se,ie),Y._rotateAround(se,ie),ee._rotateAround(se,ie),oe._rotateAround(se,ie),L=Math.min($.x,Y.x,ee.x,oe.x),k=Math.max($.x,Y.x,ee.x,oe.x),E=Math.min($.y,Y.y,ee.y,oe.y),N=Math.max($.y,Y.y,ee.y,oe.y)}return d.emplaceBack(o.x,o.y,o.z,c.x,c.y,L,E,k,N,M,p,v,m),d.length-1}function WE(d){d.collisionPadding&&(d.top-=d.collisionPadding[1],d.bottom+=d.collisionPadding[3]);const o=d.bottom-d.top;return o>0?Math.max(10,o):null}function oae(d,o,c,p){const v=d.compareText;if(o in v){const m=v[o];for(let x=m.length-1;x>=0;x--)if(p.dist(m[x])<c)return!0}else v[o]=[];return v[o].push(p),!1}function lF(d,o){const c=d.fovAboveCenter,p=d.elevation?d.elevation.getMinElevationBelowMSL()*o:0,v=(d._camera.position[2]*d.worldSize-p)/Math.cos(d._pitch),m=Math.sin(c)*v/Math.sin(Math.max(Math.PI/2-d._pitch-c,.01));let x=Math.sin(d._pitch)*m+v;const M=v*(1/d._horizonShift);if(!d.elevation||d.elevation.exaggeration()===0){let j=Math.max(d.zoom-17,0);d.isOrthographic&&(j/=10),x*=1+j}return Math.min(1.01*x,M)}function db(d,o){if(!o.isReprojectedInTileSpace)return{scale:1<<d.z,x:d.x,y:d.y,x2:d.x+1,y2:d.y+1,projection:o};const c=Math.pow(2,-d.z),p=d.x*c,v=(d.x+1)*c,m=d.y*c,x=(d.y+1)*c,M=Zs(p),j=Zs(v),F=zr(m),E=zr(x),N=o.project(M,F),L=o.project(j,F),k=o.project(j,E),I=o.project(M,E);let $=Math.min(N.x,L.x,k.x,I.x),Y=Math.min(N.y,L.y,k.y,I.y),ee=Math.max(N.x,L.x,k.x,I.x),oe=Math.max(N.y,L.y,k.y,I.y);const se=c/16;function ie(me,be,Re,Me,Ce,Xe){const Ie=(Re+Ce)/2,Qe=(Me+Xe)/2,ot=o.project(Zs(Ie),zr(Qe)),nt=Math.max(0,$-ot.x,Y-ot.y,ot.x-ee,ot.y-oe);$=Math.min($,ot.x),ee=Math.max(ee,ot.x),Y=Math.min(Y,ot.y),oe=Math.max(oe,ot.y),nt>se&&(ie(me,ot,Re,Me,Ie,Qe),ie(ot,be,Ie,Qe,Ce,Xe))}ie(N,L,p,m,v,m),ie(L,k,v,m,v,x),ie(k,I,v,x,p,x),ie(I,N,p,x,p,m),$-=se,Y-=se,ee+=se,oe+=se;const he=1/Math.max(ee-$,oe-Y);return{scale:he,x:$*he,y:Y*he,x2:ee*he,y2:oe*he,projection:o}}function cF(d,{x:o,y:c},p=0){return new It(((o-p)*d.scale-d.x)*ar,(c*d.scale-d.y)*ar)}const sae=Be.mat4.identity(new Float32Array(16));class fg{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,c){return{x:0,y:0,z:0}}unproject(o,c){return new Zn(0,0)}projectTilePoint(o,c,p){return{x:o,y:c,z:0}}locationPoint(o,c,p=!0){return o._coordinatePoint(o.locationCoordinate(c),p)}pixelsPerMeter(o,c){return qi(1,o)*c}pixelSpaceConversion(o,c,p){return 1}farthestPixelDistance(o){return lF(o,o.pixelsPerMeter)}pointCoordinate(o,c,p,v){const m=o.horizonLineFromTop(!1),x=new It(c,Math.max(m,p));return o.rayIntersectionCoordinate(o.pointRayIntersection(x,v))}pointCoordinate3D(o,c,p){const v=new It(c,p);if(o.elevation)return o.elevation.pointCoordinate(v);{const m=this.pointCoordinate(o,v.x,v.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(o,c){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,c.x,c.y);const p=o.horizonLineFromTop();return c.y<p}createInversionMatrix(o,c){return sae}createTileMatrix(o,c,p){let v,m,x;const M=p.canonical,j=Be.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const F=db(M,this);v=1,m=F.x+p.wrap*F.scale,x=F.y,Be.mat4.scale(j,j,[v/F.scale,v/F.scale,o.pixelsPerMeter/c])}else v=c/o.zoomScale(M.z),m=(M.x+Math.pow(2,M.z)*p.wrap)*v,x=M.y*v;return Be.mat4.translate(j,j,[m,x,0]),Be.mat4.scale(j,j,[v/ar,v/ar,1]),j}upVector(o,c,p){return[0,0,1]}upVectorScale(o,c,p){return{metersToTile:1}}}class lae extends fg{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[c,p]=this.parallels=o.parallels||[29.5,45.5],v=Math.sin(rt(c));this.n=(v+Math.sin(rt(p)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(o,c){const{n:p,c:v,r0:m}=this,x=rt(o-this.center[0]),M=rt(c),j=Math.sqrt(v-2*p*Math.sin(M))/p;return{x:j*Math.sin(x*p),y:j*Math.cos(x*p)-m,z:0}}unproject(o,c){const{n:p,c:v,r0:m}=this,x=m+c;let M=Math.atan2(o,Math.abs(x))*Math.sign(x);x*p<0&&(M-=Math.PI*Math.sign(o)*Math.sign(x));const j=rt(this.center[0])*p;M=Ti(M,-Math.PI-j,Math.PI-j);const F=dr(Ot(M/p)+this.center[0],-180,180),E=Math.asin(dr((v-(o*o+x*x)*p*p)/(2*p),-1,1)),N=dr(Ot(E),-85.051129,Zo);return new Zn(F,N)}}const hb=1.340264,fb=-.081106,pb=893e-6,mb=.003796,JS=Math.sqrt(3)/2;class cae extends fg{project(o,c){c=c/180*Math.PI,o=o/180*Math.PI;const p=Math.asin(JS*Math.sin(c)),v=p*p,m=v*v*v;return{x:.5*(o*Math.cos(p)/(JS*(hb+3*fb*v+m*(7*pb+9*mb*v)))/Math.PI+.5),y:1-.5*(p*(hb+fb*v+m*(pb+mb*v))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let p=c=(2*(1-c)-1)*Math.PI,v=p*p,m=v*v*v;for(let E,N,L,k=0;k<12&&(N=p*(hb+fb*v+m*(pb+mb*v))-c,L=hb+3*fb*v+m*(7*pb+9*mb*v),E=N/L,p=dr(p-E,-Math.PI/3,Math.PI/3),v=p*p,m=v*v*v,!(Math.abs(E)<1e-12));++k);const x=JS*o*(hb+3*fb*v+m*(7*pb+9*mb*v))/Math.cos(p),M=Math.asin(Math.sin(p)/JS),j=dr(180*x/Math.PI,-180,180),F=dr(180*M/Math.PI,-85.051129,Zo);return new Zn(j,F)}}class uae extends fg{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){return{x:.5+o/360,y:.5-c/360,z:0}}unproject(o,c){const p=360*(o-.5),v=dr(360*(.5-c),-85.051129,Zo);return new Zn(p,v)}}const R_=Math.PI/2;function QS(d){return Math.tan((R_+d)/2)}class dae extends fg{constructor(o){super(o),this.center=o.center||[0,30];const[c,p]=this.parallels=o.parallels||[30,30];let v=rt(c),m=rt(p);this.southernCenter=v+m<0,this.southernCenter&&(v=-v,m=-m);const x=Math.cos(v),M=QS(v);this.n=v===m?Math.sin(v):Math.log(x/Math.cos(m))/Math.log(QS(m)/M),this.f=x*Math.pow(QS(v),this.n)/this.n}project(o,c){c=rt(c),this.southernCenter&&(c=-c),o=rt(o-this.center[0]);const p=1e-6,{n:v,f:m}=this;m>0?c<-R_+p&&(c=-R_+p):c>R_-p&&(c=R_-p);const x=m/Math.pow(QS(c),v);let M=x*Math.sin(v*o),j=m-x*Math.cos(v*o);return M=.5*(M/Math.PI+.5),j=.5*(j/Math.PI+.5),{x:M,y:this.southernCenter?j:1-j,z:0}}unproject(o,c){o=(2*o-.5)*Math.PI,this.southernCenter&&(c=1-c),c=(2*(1-c)-.5)*Math.PI;const{n:p,f:v}=this,m=v-c,x=Math.sign(m),M=Math.sign(p)*Math.sqrt(o*o+m*m);let j=Math.atan2(o,Math.abs(m))*x;m*p<0&&(j-=Math.PI*Math.sign(o)*x);const F=dr(Ot(j/p)+this.center[0],-180,180),E=dr(Ot(2*Math.atan(Math.pow(v/M,1/p))-R_),-85.051129,Zo);return new Zn(F,this.southernCenter?-E:E)}}class uF extends fg{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,c){return{x:Cc(o),y:Hs(c),z:0}}unproject(o,c){const p=Zs(o),v=zr(c);return new Zn(p,v)}}const dF=rt(Zo);class hae extends fg{project(o,c){const p=(c=rt(c))*c,v=p*p;return{x:.5*((o=rt(o))*(.8707-.131979*p+v*(v*(.003971*p-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(c*(1.007226+p*(.015085+v*(.028874*p-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(o,c){o=(2*o-.5)*Math.PI;let p=c=(2*(1-c)-1)*Math.PI,v=25,m=0,x=p*p;do{x=p*p;const F=x*x;m=(p*(1.007226+x*(.015085+F*(.028874*x-.044475-.005916*F)))-c)/(1.007226+x*(.045255+F*(.259866*x-.311325-.005916*11*F))),p=dr(p-m,-dF,dF)}while(Math.abs(m)>1e-6&&--v>0);x=p*p;const M=dr(Ot(o/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),j=Ot(p);return new Zn(M,j)}}const hF=rt(Zo);class fae extends fg{project(o,c){c=rt(c),o=rt(o);const p=Math.cos(c),v=2/Math.PI,m=Math.acos(p*Math.cos(o/2)),x=Math.sin(m)/m,M=.5*(o*v+2*p*Math.sin(o/2)/x)||0,j=.5*(c+Math.sin(c)/x)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(j/Math.PI+1),z:0}}unproject(o,c){let p=o=(2*o-.5)*Math.PI,v=c=(2*(1-c)-1)*Math.PI,m=25;const x=1e-6;let M=0,j=0;do{const F=Math.cos(v),E=Math.sin(v),N=2*E*F,L=E*E,k=F*F,I=Math.cos(p/2),$=Math.sin(p/2),Y=2*I*$,ee=$*$,oe=1-k*I*I,se=oe?1/oe:0,ie=oe?Math.acos(F*I)*Math.sqrt(1/oe):0,he=.5*(2*ie*F*$+2*p/Math.PI)-o,me=.5*(ie*E+v)-c,be=.5*se*(k*ee+ie*F*I*L)+1/Math.PI,Re=se*(Y*N/4-ie*E*$),Me=.125*se*(N*$-ie*E*k*Y),Ce=.5*se*(L*I+ie*ee*F)+.5,Xe=Re*Me-Ce*be;M=(me*Re-he*Ce)/Xe,j=(he*Me-me*be)/Xe,p=dr(p-M,-Math.PI,Math.PI),v=dr(v-j,-hF,hF)}while((Math.abs(M)>x||Math.abs(j)>x)&&--m>0);return new Zn(Ot(p),Ot(v))}}class fF extends fg{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(rt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,c){const{scale:p,cosPhi:v}=this;return{x:rt(o)*v*p+.5,y:-Math.sin(rt(c))/v*p+.5,z:0}}unproject(o,c){const{scale:p,cosPhi:v}=this,m=-(c-.5)/p,x=dr(Ot((o-.5)/p)/v,-180,180),M=Math.asin(dr(m*v,-1,1)),j=dr(Ot(M),-85.051129,Zo);return new Zn(x,j)}}class pae extends uF{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,c,p){const v=_i(o,c,p),m=io(ja(p));return Be.vec3.transformMat4(v,v,m),{x:v[0],y:v[1],z:v[2]}}locationPoint(o,c){const p=lh(c.lat,c.lng),v=Be.vec3.normalize([],p),m=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(c),o._centerAltitude):o._centerAltitude,x=qi(1,0)*ar*m;Be.vec3.scaleAndAdd(p,p,v,x);const M=Be.mat4.identity(new Float64Array(16));return Be.mat4.multiply(M,o.pixelMatrix,o.globeMatrix),Be.vec3.transformMat4(p,p,M),new It(p[0],p[1])}pixelsPerMeter(o,c){return qi(1,0)*c}pixelSpaceConversion(o,c,p){const v=qi(1,o)*c,m=Dr(qi(1,45)*c,v,p);return this.pixelsPerMeter(o,c)/m}createTileMatrix(o,c,p){const v=Ei(ja(p.canonical));return Be.mat4.multiply(new Float64Array(16),o.globeMatrix,v)}createInversionMatrix(o,c){const{center:p}=o,v=io(ja(c));return Be.mat4.rotateY(v,v,rt(p.lng)),Be.mat4.rotateX(v,v,rt(p.lat)),Be.mat4.scale(v,v,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(o,c,p,v){return oi(o,c,p,!0)||new u(0,0)}pointCoordinate3D(o,c,p){const v=this.pointCoordinate(o,c,p,0);return[v.x,v.y,v.z]}isPointAboveHorizon(o,c){return!oi(o,c.x,c.y,!1)}farthestPixelDistance(o){const c=function(v,m){const x=v.cameraToCenterDistance,M=v._centerAltitude*m,j=v._camera,F=v._camera.forward(),E=Be.vec3.add([],Be.vec3.scale([],F,-x),[0,0,M]),N=v.worldSize/(2*Math.PI),L=[0,0,-N],k=v.width/v.height,I=Math.tan(v.fovAboveCenter),$=Be.vec3.scale([],j.up(),I),Y=Be.vec3.scale([],j.right(),I*k),ee=Be.vec3.normalize([],Be.vec3.add([],Be.vec3.add([],F,$),Y)),oe=[];let se;if(new Wr(E,ee).closestPointOnSphere(L,N,oe)){const ie=Be.vec3.add([],oe,L),he=Be.vec3.sub([],ie,E);se=Math.cos(v.fovAboveCenter)*Be.vec3.length(he)}else{const ie=Be.vec3.sub([],E,L),he=Be.vec3.sub([],L,E);Be.vec3.normalize(he,he);const me=Be.vec3.length(ie)-N;se=Math.sqrt(me*(me+2*N));const be=Math.acos(se/(N+me))-Math.acos(Be.vec3.dot(F,he));se*=Math.cos(be)}return 1.01*se}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),p=Ps(o.zoom);if(p>0){const v=lF(o,qi(1,o.center.lat)*o.worldSize),m=o.worldSize/(2*Math.PI),x=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Dr(c,v+m*(1-Math.cos(x)),Math.pow(p,10))}return c}upVector(o,c,p){return _i(c,p,o,1)}upVectorScale(o){return{metersToTile:En(Rn(ja(o)))}}}function pF(d){const o=d.parallels,c=!!o&&Math.abs(o[0]+o[1])<.01;switch(d.name){case"mercator":return new uF(d);case"equirectangular":return new uae(d);case"naturalEarth":return new hae(d);case"equalEarth":return new cae(d);case"winkelTripel":return new fae(d);case"albers":return c?new fF(d):new lae(d);case"lambertConformalConic":return c?new fF(d):new dae(d);case"globe":return new pae(d)}throw new Error(`Invalid projection name: ${d.name}`)}const mae=P_.VectorTileFeature.types,gae=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function e2(d,o,c,p,v,m,x,M,j,F,E,N,L){const k=M?Math.min(hg,Math.round(M[0])):0,I=M?Math.min(hg,Math.round(M[1])):0;d.emplaceBack(o,c,Math.round(32*p),Math.round(32*v),m,x,(k<<1)+(j?1:0),I,16*F,16*E,256*N,256*L)}function t2(d,o,c){d.emplaceBack(o,c)}function r2(d,o,c,p,v,m,x){d.emplaceBack(o,c,p,v,m,x)}function n2(d,o,c,p,v){d.emplaceBack(o,c,p,v),d.emplaceBack(o,c,p,v),d.emplaceBack(o,c,p,v),d.emplaceBack(o,c,p,v)}function yae(d){for(const o of d.sections)if(Um(o.text))return!0;return!1}class HE{constructor(o){this.layoutVertexArray=new Cp,this.indexArray=new go,this.programConfigurations=o,this.segments=new va,this.dynamicLayoutVertexArray=new au,this.opacityVertexArray=new Rl,this.placedSymbolArray=new Cy,this.iconTransitioningVertexArray=new Eo,this.globeExtVertexArray=new Mp,this.zOffsetVertexArray=new pf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(o,c,p,v,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,jie.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Iie.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,gae,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,Lie.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Nie.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Die.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}hr(HE,"SymbolBuffers");class ZE{constructor(o,c,p){this.layoutVertexArray=new o,this.layoutAttributes=c,this.indexArray=new p,this.segments=new va,this.collisionVertexArray=new Zm,this.collisionVertexArrayExt=new au}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,zie.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,Fie.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}hr(ZE,"CollisionBuffers");class i2{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(x=>x.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Be.mat4.identity([]),this.placementViewportMatrix=Be.mat4.identity([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zE(this.zoom,c["text-size"]),this.iconSizeData=zE(this.zoom,c["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),m=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(x=>du[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=p.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new HE(new cu(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new HE(new cu(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new f_,this.lineVertexArray=new Ry,this.symbolInstances=new Oy}calculateGlyphDependencies(o,c,p,v,m){for(const x of o){const M=x.codePointAt(0);if(M===void 0)break;if(c[M]=!0,v&&m&&M<=65535){const j=ob[x];j&&(c[j.charCodeAt(0)]=!0)}}}updateFootprints(o,c){}updateReplacement(o,c){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!OE(this.activeReplacements,p)&&(this.activeReplacements=p,!0)}populate(o,c,p,v){const m=this.layers[0],x=m.layout,M=this.projection.name==="globe",j=x.get("text-font"),F=x.get("text-field"),E=x.get("icon-image"),[N,L]=x.get("icon-size-scale-range"),k=dr(c.scaleFactor||1,N,L),I=(F.value.kind!=="constant"||F.value.value instanceof Ao&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(j.value.kind!=="constant"||j.value.value.length>0),$=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,Y=x.get("symbol-sort-key");if(this.features=[],!I&&!$)return;const ee=c.iconDependencies,oe=c.glyphDependencies,se=c.availableImages,ie=new vi(this.zoom);for(const{feature:he,id:me,index:be,sourceLayerIndex:Re}of o){const Me=m._featureFilter.needGeometry,Ce=te(he,Me);if(!m._featureFilter.filter(ie,Ce,p))continue;if(Me||(Ce.geometry=Z(he,p,v)),M&&he.type!==1&&p.z<=5){const nt=Ce.geometry,lt=.98078528056,dt=(yt,ct)=>{const jt=_i(yt.x,yt.y,p,1),Vt=_i(ct.x,ct.y,p,1);return Be.vec3.dot(jt,Vt)<lt};for(let yt=0;yt<nt.length;yt++)nt[yt]=O(nt[yt],dt)}let Xe,Ie;if(I){const nt=m.getValueAndResolveTokens("text-field",Ce,p,se),lt=Ao.factory(nt);yae(lt)&&(this.hasRTLText=!0),(!this.hasRTLText||Xd()==="unavailable"||this.hasRTLText&&$s.isParsed())&&(Xe=Uie(lt,m,Ce))}if($){const nt=m.getValueAndResolveTokens("icon-image",Ce,p,se);Ie=nt instanceof To?nt:To.build(nt)}if(!Xe&&!Ie)continue;const Qe=this.sortFeaturesByKey?Y.evaluate(Ce,{},p):void 0,ot={id:me,text:Xe,icon:Ie,index:be,sourceLayerIndex:Re,geometry:Ce.geometry,properties:he.properties,type:mae[he.type],sortKey:Qe};if(this.features.push(ot),Ie){const nt=LE(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],p,this.zoom,ot)*k*this.pixelRatio,lt=Ie.getPrimary().scaleSelf(nt);if(ee[lt.id]=ee[lt.id]||[],ee[lt.id].push(lt),Ie.nameSecondary){const dt=Ie.getSecondary().scaleSelf(nt);ee[dt.id]=ee[dt.id]||[],ee[dt.id].push(dt)}}if(Xe){const nt=j.evaluate(Ce,{},p).join(","),lt=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(du.vertical)>=0;for(const dt of Xe.sections)if(dt.image){const yt=dt.image.getPrimary().scaleSelf(this.pixelRatio);ee[yt.id]=ee[yt.id]||[],ee[yt.id].push(yt)}else{const yt=Ap(Xe.toString()),ct=dt.fontStack||nt,jt=oe[ct]=oe[ct]||{};this.calculateGlyphDependencies(dt.text,jt,lt,this.allowVerticalPlacement,yt)}}}x.get("symbol-placement")==="line"&&(this.features=function(he){const me={},be={},Re=[];let Me=0;function Ce(ot){Re.push(he[ot]),Me++}function Xe(ot,nt,lt){const dt=be[ot];return delete be[ot],be[nt]=dt,Re[dt].geometry[0].pop(),Re[dt].geometry[0]=Re[dt].geometry[0].concat(lt[0]),dt}function Ie(ot,nt,lt){const dt=me[nt];return delete me[nt],me[ot]=dt,Re[dt].geometry[0].shift(),Re[dt].geometry[0]=lt[0].concat(Re[dt].geometry[0]),dt}function Qe(ot,nt,lt){const dt=lt?nt[0][nt[0].length-1]:nt[0][0];return`${ot}:${dt.x}:${dt.y}`}for(let ot=0;ot<he.length;ot++){const nt=he[ot],lt=nt.geometry,dt=nt.text?nt.text.toString():null;if(!dt){Ce(ot);continue}const yt=Qe(dt,lt),ct=Qe(dt,lt,!0);if(yt in be&&ct in me&&be[yt]!==me[ct]){const jt=Ie(yt,ct,lt),Vt=Xe(yt,ct,Re[jt].geometry);delete me[yt],delete be[ct],be[Qe(dt,Re[Vt].geometry,!0)]=Vt,Re[jt].geometry=null}else yt in be?Xe(yt,ct,lt):ct in me?Ie(yt,ct,lt):(Ce(ot),me[yt]=Me-1,be[ct]=Me-1)}return Re.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,me)=>he.sortKey-me.sortKey)}update(o,c,p,v,m,x,M){this.text.programConfigurations.updatePaintArrays(o,c,m,p,v,x,M),this.icon.programConfigurations.updatePaintArrays(o,c,m,p,v,x,M)}updateZOffset(){const o=(m,x,M)=>{p+=x,p>m.length&&m.resize(p);for(let j=-x;j<0;j++)m.emplace(j+p,M)},c=(m,x,M)=>{v+=x,v>m.length&&m.resize(v);for(let j=-x;j<0;j++)m.emplace(j+v,M)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let p=0,v=0;for(let m=0;m<this.symbolInstances.length;m++){const x=this.symbolInstances.get(m),{numHorizontalGlyphVertices:M,numVerticalGlyphVertices:j,numIconVertices:F}=x,E=x.zOffset,N=F>0;if((M>0||j>0)&&(o(this.text.zOffsetVertexArray,M,E),o(this.text.zOffsetVertexArray,j,E)),N){const{placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:k}=x;L>=0&&c(this.icon.zOffsetVertexArray,F,E),k>=0&&c(this.icon.zOffsetVertexArray,x.numVerticalIconVertices,E)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=pF(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,c){const p=this.lineVertexArray.length;if(o.segment!==void 0)for(const{x:v,y:m}of c)this.lineVertexArray.emplaceBack(v,m);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(o,c,p,v,m,x,M,j,F,E,N,L,k,I,$,Y){const ee=o.indexArray,oe=o.layoutVertexArray,se=o.globeExtVertexArray,ie=o.segments.prepareSegment(4*c.length,oe,ee,this.canOverlap?x.sortKey:void 0),he=this.glyphOffsetArray.length,me=ie.vertexLength,be=this.allowVerticalPlacement&&M===du.vertical?Math.PI/2:0,Re=x.text&&x.text.sections;for(let Ce=0;Ce<c.length;Ce++){const{tl:Xe,tr:Ie,bl:Qe,br:ot,texPrimary:nt,texSecondary:lt,pixelOffsetTL:dt,pixelOffsetBR:yt,minFontScaleX:ct,minFontScaleY:jt,glyphOffset:Vt,isSDF:kt,sectionIndex:cr}=c[Ce],ir=ie.vertexLength,Xt=Vt[1];if(e2(oe,F.x,F.y,Xe.x,Xt+Xe.y,nt.x,nt.y,p,kt,dt.x,dt.y,ct,jt),e2(oe,F.x,F.y,Ie.x,Xt+Ie.y,nt.x+nt.w,nt.y,p,kt,yt.x,dt.y,ct,jt),e2(oe,F.x,F.y,Qe.x,Xt+Qe.y,nt.x,nt.y+nt.h,p,kt,dt.x,yt.y,ct,jt),e2(oe,F.x,F.y,ot.x,Xt+ot.y,nt.x+nt.w,nt.y+nt.h,p,kt,yt.x,yt.y,ct,jt),j){const{x:Ut,y:Er,z:pr}=j.anchor,[vr,Qr,fn]=j.up;r2(se,Ut,Er,pr,vr,Qr,fn),r2(se,Ut,Er,pr,vr,Qr,fn),r2(se,Ut,Er,pr,vr,Qr,fn),r2(se,Ut,Er,pr,vr,Qr,fn),n2(o.dynamicLayoutVertexArray,Ut,Er,pr,be)}else n2(o.dynamicLayoutVertexArray,F.x,F.y,F.z,be);if(Y){const Ut=lt||nt;t2(o.iconTransitioningVertexArray,Ut.x,Ut.y),t2(o.iconTransitioningVertexArray,Ut.x+Ut.w,Ut.y),t2(o.iconTransitioningVertexArray,Ut.x,Ut.y+Ut.h),t2(o.iconTransitioningVertexArray,Ut.x+Ut.w,Ut.y+Ut.h)}ee.emplaceBack(ir,ir+1,ir+2),ee.emplaceBack(ir+1,ir+2,ir+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Vt[0]),Ce!==c.length-1&&cr===c[Ce+1].sectionIndex||o.programConfigurations.populatePaintArrays(oe.length,x,x.index,{},k,I,$,Re&&Re[cr])}const Me=j?j.anchor:F;o.placedSymbolArray.emplaceBack(Me.x,Me.y,Me.z,F.x,F.y,he,this.glyphOffsetArray.length-he,me,E,N,F.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],M,0,!1,0,L,0)}_commitLayoutVertex(o,c,p,v,m,x,M){o.emplaceBack(c,p,v,m,x,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(o,c,p,v,m,x,M){const j=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),F=j.vertexLength,E=M.tileAnchorX,N=M.tileAnchorY;for(let k=0;k<4;k++)p.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(p.collisionVertexArrayExt,c,o.padding,M.zOffset),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,E,N,new It(o.x1,o.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,E,N,new It(o.x2,o.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,E,N,new It(o.x2,o.y2)),this._commitLayoutVertex(p.layoutVertexArray,v,m,x,E,N,new It(o.x1,o.y2)),j.vertexLength+=4;const L=p.indexArray;L.emplaceBack(F,F+1),L.emplaceBack(F+1,F+2),L.emplaceBack(F+2,F+3),L.emplaceBack(F+3,F),j.primitiveLength+=4}_addTextDebugCollisionBoxes(o,c,p,v,m,x){for(let M=v;M<m;M++){const j=p.get(M),F=this.getSymbolInstanceTextSize(o,x,c,M);this._addCollisionDebugVertices(j,F,this.textCollisionBox,j.projectedAnchorX,j.projectedAnchorY,j.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(o,c,p,v,m,x){for(let M=v;M<m;M++){const j=p.get(M),F=this.getSymbolInstanceIconSize(o,c,x.placedIconSymbolIndex);this._addCollisionDebugVertices(j,F,this.iconCollisionBox,j.projectedAnchorX,j.projectedAnchorY,j.projectedAnchorZ,x)}}generateCollisionDebugBuffers(o,c,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ZE(ff,Dz.members,Eo),this.iconCollisionBox=new ZE(ff,Dz.members,Eo);const v=E_(this.iconSizeData,o),m=E_(this.textSizeData,o,p);for(let x=0;x<this.symbolInstances.length;x++){const M=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(m,o,c,M.textBoxStartIndex,M.textBoxEndIndex,M),this._addTextDebugCollisionBoxes(m,o,c,M.verticalTextBoxStartIndex,M.verticalTextBoxEndIndex,M),this._addIconDebugCollisionBoxes(v,o,c,M.iconBoxStartIndex,M.iconBoxEndIndex,M),this._addIconDebugCollisionBoxes(v,o,c,M.verticalIconBoxStartIndex,M.verticalIconBoxEndIndex,M)}}getSymbolInstanceTextSize(o,c,p,v){const m=this.text.placedSymbolArray.get(c.rightJustifiedTextSymbolIndex>=0?c.rightJustifiedTextSymbolIndex:c.centerJustifiedTextSymbolIndex>=0?c.centerJustifiedTextSymbolIndex:c.leftJustifiedTextSymbolIndex>=0?c.leftJustifiedTextSymbolIndex:c.verticalPlacedTextSymbolIndex>=0?c.verticalPlacedTextSymbolIndex:v),x=qS(this.textSizeData,o,m)/Cs;return this.tilePixelRatio*x}getSymbolInstanceIconSize(o,c,p){const v=this.icon.placedSymbolArray.get(p),m=qS(this.iconSizeData,o,v);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(o,c,p,v){o.emplaceBack(c,-p,-p,v),o.emplaceBack(c,p,-p,v),o.emplaceBack(c,p,p,v),o.emplaceBack(c,-p,p,v)}_updateTextDebugCollisionBoxes(o,c,p,v,m,x,M){for(let j=v;j<m;j++){const F=p.get(j),E=this.getSymbolInstanceTextSize(o,x,c,j);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,E,F.padding,x.zOffset)}}_updateIconDebugCollisionBoxes(o,c,p,v,m,x,M){for(let j=v;j<m;j++){const F=p.get(j),E=this.getSymbolInstanceIconSize(o,c,x.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,E,F.padding,x.zOffset)}}updateCollisionDebugBuffers(o,c,p,v){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=E_(this.iconSizeData,o,v),x=E_(this.textSizeData,o,p);for(let M=0;M<this.symbolInstances.length;M++){const j=this.symbolInstances.get(M);this._updateTextDebugCollisionBoxes(x,o,c,j.textBoxStartIndex,j.textBoxEndIndex,j,p),this._updateTextDebugCollisionBoxes(x,o,c,j.verticalTextBoxStartIndex,j.verticalTextBoxEndIndex,j,p),this._updateIconDebugCollisionBoxes(m,o,c,j.iconBoxStartIndex,j.iconBoxEndIndex,j,v),this._updateIconDebugCollisionBoxes(m,o,c,j.verticalIconBoxStartIndex,j.verticalIconBoxEndIndex,j,v)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,c,p,v,m,x,M,j,F){const E={};if(c<p){const{x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie,featureIndex:he}=o.get(c);E.textBox={x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie},E.textFeatureIndex=he}if(v<m){const{x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie,featureIndex:he}=o.get(v);E.verticalTextBox={x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie},E.verticalTextFeatureIndex=he}if(x<M){const{x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie,featureIndex:he}=o.get(x);E.iconBox={x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie},E.iconFeatureIndex=he}if(j<F){const{x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie,featureIndex:he}=o.get(j);E.verticalIconBox={x1:N,y1:L,x2:k,y2:I,padding:$,projectedAnchorX:Y,projectedAnchorY:ee,projectedAnchorZ:oe,tileAnchorX:se,tileAnchorY:ie},E.verticalIconFeatureIndex=he}return E}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const p=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,c){const p=o.placedSymbolArray.get(c),v=p.vertexStartIndex+4*p.numGlyphs;for(let m=p.vertexStartIndex;m<v;m+=4)o.indexArray.emplaceBack(m,m+1,m+2),o.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const c=Math.sin(o),p=Math.cos(o),v=[],m=[],x=[];for(let M=0;M<this.symbolInstances.length;++M){x.push(M);const j=this.symbolInstances.get(M);v.push(0|Math.round(c*j.tileAnchorX+p*j.tileAnchorY)),m.push(j.featureIndex)}return x.sort((M,j)=>v[M]-v[j]||m[j]-m[M]),x}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,c)=>this.symbolInstances.get(c).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,c){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===c?p.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const p=this.symbolInstances.get(c);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:j,verticalPlacedIconSymbolIndex:F}=p;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),m>=0&&m!==v&&this.addIndicesForPlacedSymbol(this.text,m),x>=0&&x!==m&&x!==v&&this.addIndicesForPlacedSymbol(this.text,x),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),j>=0&&this.addIndicesForPlacedSymbol(this.icon,j),F>=0&&this.addIndicesForPlacedSymbol(this.icon,F)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let mF,gF,YE;hr(i2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),i2.addDynamicAttributes=n2;class yF{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Lu,this.defaultValue=o}evaluate(o){if(o.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(o.formattedSection))return c.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}hr(yF,"FormatSectionOverride",{omit:["defaultValue"]});const XE=()=>YE||(YE={layout:mF||(mF=new $i({"symbol-placement":new Yt(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new Yt(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Yt(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new or(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Yt(vt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Yt(vt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Yt(vt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Yt(vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Yt(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Yt(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Yt(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new or(vt.layout_symbol["icon-size"]),"icon-size-scale-range":new Yt(vt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new or(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new or(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new or(vt.layout_symbol["icon-image"]),"icon-rotate":new or(vt.layout_symbol["icon-rotate"]),"icon-padding":new Yt(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new Yt(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new or(vt.layout_symbol["icon-offset"]),"icon-anchor":new or(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Yt(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Yt(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Yt(vt.layout_symbol["text-rotation-alignment"]),"text-field":new or(vt.layout_symbol["text-field"]),"text-font":new or(vt.layout_symbol["text-font"]),"text-size":new or(vt.layout_symbol["text-size"]),"text-size-scale-range":new Yt(vt.layout_symbol["text-size-scale-range"]),"text-max-width":new or(vt.layout_symbol["text-max-width"]),"text-line-height":new or(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new or(vt.layout_symbol["text-letter-spacing"]),"text-justify":new or(vt.layout_symbol["text-justify"]),"text-radial-offset":new or(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Yt(vt.layout_symbol["text-variable-anchor"]),"text-anchor":new or(vt.layout_symbol["text-anchor"]),"text-max-angle":new Yt(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new Yt(vt.layout_symbol["text-writing-mode"]),"text-rotate":new or(vt.layout_symbol["text-rotate"]),"text-padding":new Yt(vt.layout_symbol["text-padding"]),"text-keep-upright":new Yt(vt.layout_symbol["text-keep-upright"]),"text-transform":new or(vt.layout_symbol["text-transform"]),"text-offset":new or(vt.layout_symbol["text-offset"]),"text-allow-overlap":new Yt(vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Yt(vt.layout_symbol["text-ignore-placement"]),"text-optional":new Yt(vt.layout_symbol["text-optional"]),visibility:new Yt(vt.layout_symbol.visibility)})),paint:gF||(gF=new $i({"icon-opacity":new or(vt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new or(vt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new or(vt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new or(vt.paint_symbol["text-emissive-strength"]),"icon-color":new or(vt.paint_symbol["icon-color"]),"icon-halo-color":new or(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new or(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new or(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new Yt(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Yt(vt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new or(vt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new or(vt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new or(vt.paint_symbol["text-occlusion-opacity"]),"text-color":new or(vt.paint_symbol["text-color"],{runtimeType:fo,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new or(vt.paint_symbol["text-halo-color"]),"text-halo-width":new or(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new or(vt.paint_symbol["text-halo-blur"]),"text-translate":new Yt(vt.paint_symbol["text-translate"]),"text-translate-anchor":new Yt(vt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Yt(vt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Yt(vt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Yt(vt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Yt(vt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new or(vt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},YE);class a2 extends fi{constructor(o,c,p,v){super(o,XE(),c,p,v),this._colorAdjustmentMatrix=Be.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=o.paint!==void 0&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,c){super.recalculate(o,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const m of p)v.indexOf(m)<0&&v.push(m);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,c,p,v){return this._saturation===o&&this._contrast===c&&this._brightnessMin===p&&this._brightnessMax===v||(this._colorAdjustmentMatrix=function(m,x,M,j){m=No(m),x=Ma(x);const F=Be.mat4.create(),E=m/3,N=1-2*E,L=[N,E,E,0,E,N,E,0,E,E,N,0,0,0,0,1],k=.5-.5*x,I=j-M;return Be.mat4.multiply(F,[I,0,0,0,0,I,0,0,0,0,I,0,M,M,M,1],[x,0,0,0,0,x,0,0,0,0,x,0,k,k,k,1]),Be.mat4.multiply(F,F,L),F}(o,c,p,v),this._saturation=o,this._contrast=c,this._brightnessMin=p,this._brightnessMax=v),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,c,p,v){const m=this.layout.get(o).evaluate(c,{},p,v),x=this._unevaluatedLayout._values[o];return x.isDataDriven()||Kd(x.value)||!m?m:function(M,j){return j.replace(/{([^{}]+)}/g,(F,E)=>E in M?String(M[E]):"")}(c.properties,m)}createBucket(o){return new i2(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of XE().paint.overridableProperties){if(!a2.hasPaintOverride(this.layout,o))continue;const c=this.paint.get(o),p=new yF(c),v=new Gd(p,c.property.specification,this.scope,this.options);let m=null;m=c.value.kind==="constant"||c.value.kind==="source"?new Wd("source",v):new Hd("composite",v,c.value.zoomStops,c.value._interpolationType),this.paint._values[o]=new Qu(c.property,m,c.parameters)}}_handleOverridablePaintPropertyUpdate(o,c,p){return!(!this.layout||c.isDataDriven()||p.isDataDriven())&&a2.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,c){const p=o.get("text-field"),v=XE().paint.properties[c];let m=!1;const x=M=>{for(const j of M)if(v.overrides&&v.overrides.hasOverride(j))return void(m=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Ao)x(p.value.value.sections);else if(p.value.kind==="source"){const M=F=>{m||(F instanceof ka&&na(F.value)===zs?x(F.value.sections):F instanceof Hc?x(F.sections):F.eachChild(M))},j=p.value;j._styleExpression&&M(j._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,c,p){return{config:new lu(this,{zoom:c,lut:p}),overrideFog:!1}}}let vF,_F,xF,bF;var JE=Qn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function QE(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function eC(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class tC{constructor(o,c,p,v){this.context=o,this.format=p,this.useMipmap=v&&v.useMipmap,this.texture=o.gl.createTexture(),this.update(c,{premultiply:v&&v.premultiply})}update(o,c){const p=o&&o instanceof HTMLVideoElement&&o.width===0?o.videoWidth:o.width,v=o&&o instanceof HTMLVideoElement&&o.height===0?o.videoHeight:o.height,{context:m}=this,{gl:x}=m,{x:M,y:j}=c&&c.position?c.position:{x:0,y:0},F=M+p,E=j+v;!this.size||this.size[0]===F&&this.size[1]===E||(x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(this.texture),this.texture=x.createTexture(),this.size=null),x.bindTexture(x.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA8&&(!c||c.premultiply!==!1));const N=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&F>0&&E>0){const L=this.useMipmap?Math.floor(Math.log2(Math.max(F,E)))+1:1;x.texStorage2D(x.TEXTURE_2D,L,this.format,F,E),this.size=[F,E]}if(this.size)if(N)x.texSubImage2D(x.TEXTURE_2D,0,M,j,QE(this.format),eC(this.format),o);else{const L=o.data;L&&x.texSubImage2D(x.TEXTURE_2D,0,M,j,p,v,QE(this.format),eC(this.format),L)}this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(o,c,p=!1){const{context:v}=this,{gl:m}=v;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!p?o===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,c),this.wrapS=c)}bindExtraParam(o,c,p,v){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),c!==this.magFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,c),this.magFilter=c),o!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap?o===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),p!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,p),this.wrapS=p),v!==this.wrapT&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,v),this.wrapT=v)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class o2{constructor(o,c){this.context=o,this.texture=c}bind(o,c){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),o!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,o),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,o),this.minFilter=o),c!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,c),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,c),this.wrapS=c)}}function s2(d,o,c,p,v,m,x,M){const j=[d,o,1,c,p,1,v,m,1],F=[x,M,1],E=Be.mat3.adjoint([],j),[N,L,k]=Be.vec3.transformMat3(F,F,E);return Be.mat3.multiply(j,j,[N,0,0,0,L,0,0,0,k])}function wF(d,o,c,p,v,m,x,M){const j=function(F,E,N,L,k,I,$,Y){const ee=s2(0,0,1,0,1,1,0,1),oe=s2(F,E,N,L,k,I,$,Y),se=Be.mat3.adjoint([],ee);return Be.mat3.multiply(oe,oe,se)}(d,o,c,p,v,m,x,M);return[j[2]/j[8]/ar,j[5]/j[8]/ar]}function l2(d){return[d[0],Math.min(Math.max(d[1],-85.051129),Zo)]}class SF extends qc{constructor(o,c,p,v){super(),this.id=o,this.dispatcher=p,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(v),this.options=c,this._dirty=!1}load(o,c){if(this._loaded=c||!1,this.fire(new yi("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=Hh(this.map._requestManager.transformRequest(this.url,Pn.Image),(p,v)=>{this._imageRequest=null,this._loaded=!0,p?this.fire(new ip(p)):v&&(this.image=v instanceof HTMLImageElement?Ge.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new o2(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new yi("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof o2||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let c=o[0][1],p=o[0][1];for(const m of o)m[1]>p&&(p=m[1]),m[1]<c&&(c=m[1]);const v=(p+c)/2;if(v>Zo?this.onNorthPole=!0:v<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=o.map(u.fromLngLat);this.tileID=function(x){let M=1/0,j=1/0,F=-1/0,E=-1/0;for(const $ of x)M=Math.min(M,$.x),j=Math.min(j,$.y),F=Math.max(F,$.x),E=Math.max(E,$.y);const N=Math.max(F-M,E-j),L=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),k=Math.pow(2,L);let I=Math.floor((M+F)/2*k);return I>1&&(I-=1),new zt(L,I,Math.floor((j+E)/2*k))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new yi("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const ee in this.tiles){const oe=this.tiles[ee];oe.state!=="loaded"&&(oe.state="loaded",oe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const c=db(new zt(0,0,0),this.map.transform.projection),p=[c.projection.project(this.coordinates[0][0],this.coordinates[0][1]),c.projection.project(this.coordinates[1][0],this.coordinates[1][1]),c.projection.project(this.coordinates[2][0],this.coordinates[2][1]),c.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(ee){const oe=ee[1].x-ee[0].x,se=ee[1].y-ee[0].y,ie=ee[2].x-ee[1].x,he=ee[2].y-ee[1].y,me=ee[3].x-ee[2].x,be=ee[3].y-ee[2].y,Re=ee[0].x-ee[3].x,Me=ee[0].y-ee[3].y,Ce=oe*he-ie*se,Xe=ie*be-me*he,Ie=me*Me-Re*be,Qe=Re*se-oe*Me;return Ce>0&&Xe>0&&Ie>0&&Qe>0||Ce<0&&Xe<0&&Ie<0&&Qe<0}(p))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const v=db(this.tileID,this.map.transform.projection),[m,x,M,j]=this.coordinates.map(ee=>{const oe=v.projection.project(ee[0],ee[1]);return cF(v,oe)._round()});this.perspectiveTransform=wF(m.x,m.y,x.x,x.y,M.x,M.y,j.x,j.y);const F=this._boundsArray=new ua;F.emplaceBack(m.x,m.y,0,0),F.emplaceBack(x.x,x.y,ar,0),F.emplaceBack(j.x,j.y,0,ar),F.emplaceBack(M.x,M.y,ar,ar),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(F,JE.members),this.boundsSegments=va.simpleSegment(0,0,4,2);const E=[],N=[l2((L=this.coordinates)[0]),l2(L[1]),l2(L[2]),l2(L[3])];var L;const[k,I,$,Y]=function(ee){let oe=ee[0][0],se=oe,ie=ee[0][1],he=ie;for(let me=1;me<ee.length;me++)ee[me][0]<oe?oe=ee[me][0]:ee[me][0]>se&&(se=ee[me][0]),ee[me][1]<ie?ie=ee[me][1]:ee[me][1]>he&&(he=ee[me][1]);return[oe,ie,se-oe,he-ie]}(N);{const ee=new ua,[oe,se,ie,he]=function(dt){let yt=dt[0].x,ct=yt,jt=dt[0].y,Vt=jt;for(let kt=1;kt<dt.length;kt++)dt[kt].x<yt?yt=dt[kt].x:dt[kt].x>ct&&(ct=dt[kt].x),dt[kt].y<jt?jt=dt[kt].y:dt[kt].y>Vt&&(Vt=dt[kt].y);return[yt,jt,ct-yt,Vt-jt]}(p),me=dt=>[(dt.x-oe)/ie,(dt.y-se)/he],[be,Re,Me,Ce]=p.map(me),Xe=function(dt,yt,ct,jt,Vt,kt,cr,ir){const Xt=s2(0,0,1,0,1,1,0,1),Ut=s2(dt,yt,ct,jt,Vt,kt,cr,ir),Er=Be.mat3.adjoint([],Ut);return Be.mat3.multiply(Xt,Xt,Er)}(be[0],be[1],Re[0],Re[1],Me[0],Me[1],Ce[0],Ce[1]);this.elevatedGlobePerspectiveTransform=wF(be[0],be[1],Re[0],Re[1],Me[0],Me[1],Ce[0],Ce[1]);const Ie=(dt,yt)=>{E.push(dt.lng);const ct=Math.round((dt.lng-k)/$*ar),jt=Math.round((dt.lat-I)/Y*ar),Vt=me(yt),kt=Be.vec3.transformMat3([],[Vt[0],Vt[1],1],Xe),cr=Math.round(kt[0]/kt[2]*ar),ir=Math.round(kt[1]/kt[2]*ar);ee.emplaceBack(ct,jt,cr,ir)},Qe=p[3].x-p[0].x,ot=p[3].y-p[0].y,nt=p[2].x-p[1].x,lt=p[2].y-p[1].y;for(let dt=0;dt<65;dt++){const yt=dt/64,ct=[p[0].x+yt*Qe,p[0].y+yt*ot],jt=[p[1].x+yt*nt,p[1].y+yt*lt],Vt=jt[0]-ct[0],kt=jt[1]-ct[1];for(let cr=0;cr<65;cr++){const ir=cr/64,Xt={x:ct[0]+Vt*ir,y:ct[1]+kt*ir};Ie(c.projection.unproject(Xt.x,Xt.y),Xt)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(ee,JE.members)}{this.maxLongitudeTriangleSize=0;let ee=[],oe=new go;const se=(ie,he,me)=>{oe.emplaceBack(ie,he,me);const be=E[ie],Re=E[he],Me=E[me],Ce=Math.min(Math.min(be,Re),Me),Xe=Math.max(Math.max(be,Re),Me)-Ce;Xe>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Xe),ee.push(Ce+Xe/2)};for(let ie=0;ie<64;ie++)for(let he=0;he<64;he++){const me=65*ie+he,be=me+1,Re=me+65,Me=Re+1;se(me,Re,be),se(be,Re,Me)}[ee,oe]=function(ie,he){const me=Array.from({length:ie.length},(Me,Ce)=>Ce);me.sort((Me,Ce)=>ie[Me]-ie[Ce]);const be=[],Re=new go;for(let Me=0;Me<me.length;Me++){const Ce=me[Me];be.push(ie[Ce]);const Xe=3*Ce,Ie=Xe+1;Re.emplaceBack(he.uint16[Xe],he.uint16[Ie],he.uint16[Ie+1])}return[be,Re]}(ee,oe),this.elevatedGlobeTrianglesCenterLongitudes=ee,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(oe)}this.elevatedGlobeSegments=va.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,$/ar,0,Y/ar,0,0,I,k,0])}prepare(){const o=Object.keys(this.tiles).length!==0;if(this.tileID&&!o)return;const c=this.map.painter.context,p=c.gl;!this._dirty||this.texture instanceof o2||(this.texture?this.texture.update(this.image):(this.texture=new tC(c,this.image,p.RGBA8),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(c)}loadTile(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const c=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!c)return null;const p=this.elevatedGlobeTrianglesCenterLongitudes;let v=(m=o+180)+360*Math.round((p[0]-m)/360);var m;const x=new va,M=(N,L)=>{x.segments.push({vertexOffset:0,primitiveOffset:N,vertexLength:c.segments[0].vertexLength,primitiveLength:L,sortKey:void 0,vaos:{}})},j=.51*this.maxLongitudeTriangleSize;if(Math.abs(p[0]-v)<=j){const N=xl(p,0,p.length,v+j);return N===p.length||M(N,wo(p,N+1,p.length,v+360-j)-N),x}v<p[0]&&(v+=360);const F=wo(p,0,p.length,v-j);if(F===p.length)return M(0,p.length),x;M(0,F-0);const E=xl(p,F+1,p.length,v+j);return E!==p.length&&M(E,p.length-E),x}}const vae=(Math.pow(256,2)-1)/16907520;class AF extends fi{constructor(o,c,p,v){super(o,{layout:xF||(xF=new $i({visibility:new Yt(vt.layout_raster.visibility)})),paint:bF||(bF=new $i({"raster-opacity":new Yt(vt.paint_raster["raster-opacity"]),"raster-color":new Ol(vt.paint_raster["raster-color"]),"raster-color-mix":new Yt(vt.paint_raster["raster-color-mix"]),"raster-color-range":new Yt(vt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Yt(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Yt(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Yt(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new Yt(vt.paint_raster["raster-saturation"]),"raster-contrast":new Yt(vt.paint_raster["raster-contrast"]),"raster-resampling":new Yt(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new Yt(vt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Yt(vt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Yt(vt.paint_raster["raster-array-band"]),"raster-elevation":new Yt(vt.paint_raster["raster-elevation"]),"raster-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},c,p,v),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof SF&&(o._source.onNorthPole||o._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(o){o!=="raster-color"&&o!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const c=this._transitionablePaint._values["raster-color"].value.expression,[p,v]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(p)&&isNaN(v)||p===this._curRampRange[0]&&v===this._curRampRange[1]||(this.colorRamp=sg({expression:c,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:p,end:v}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[p,v])}}let TF,PF,EF,CF,MF;class OF extends fi{constructor(o,c,p,v){super(o,{layout:TF||(TF=new $i({visibility:new Yt(vt["layout_raster-particle"].visibility)})),paint:PF||(PF=new $i({"raster-particle-array-band":new Yt(vt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Yt(vt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Ol(vt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Yt(vt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Yt(vt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Yt(vt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Yt(vt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Yt(vt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},c,p,v),this._updateColorRamp(),this.lastInvalidatedAt=Ge.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){o!=="raster-particle-color"&&o!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),o==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,c=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=sg({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:c}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ge.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class _ae extends fi{constructor(o,c){super(o,{},c,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(o){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function rC(d,o,c){const p=[0,0,1],v=Be.quat.identity([]);return Be.quat.rotateY(v,v,c?-rt(d)+Math.PI:rt(d)),Be.quat.rotateX(v,v,-rt(o)),Be.vec3.transformQuat(p,p,v),Be.vec3.normalize(p,p)}function RF(d,o){const c=c2(d.projection,d.zoom,d.width,d.height),p=function(m,x,M,j,F){const E=new Zn(M.lng-180*pg,M.lat),N=new Zn(M.lng+180*pg,M.lat),L=m.project(E.lng,E.lat),k=m.project(N.lng,N.lat),I=-Math.atan2(k.y-L.y,k.x-L.x),$=u.fromLngLat(M);$.y=dr($.y,-1+pg,1-pg);const Y=$.toLngLat(),ee=m.project(Y.lng,Y.lat),oe=u.fromLngLat(Y);oe.x+=pg;const se=oe.toLngLat(),ie=m.project(se.lng,se.lat),he=jF(ie.x-ee.x,ie.y-ee.y,I),me=u.fromLngLat(Y);me.y+=pg;const be=me.toLngLat(),Re=m.project(be.lng,be.lat),Me=jF(Re.x-ee.x,Re.y-ee.y,I),Ce=Math.abs(he.x)/Math.abs(Me.y),Xe=Be.mat4.identity([]);Be.mat4.rotateZ(Xe,Xe,-I*(1-(F?0:j)));const Ie=Be.mat4.identity([]);return Be.mat4.scale(Ie,Ie,[1,1-(1-Ce)*j,1]),Ie[4]=-Me.x/Me.y*j,Be.mat4.rotateZ(Ie,Ie,I),Be.mat4.multiply(Ie,Xe,Ie),Ie}(d.projection,0,d.center,c,o),v=kF(d);return Be.mat4.scale(p,p,[v,v,1]),p}function kF(d){const o=d.projection,c=c2(d.projection,d.zoom,d.width,d.height),p=nC(o,d.center),v=nC(o,Zn.convert(o.center));return Math.pow(2,p*c+(1-c)*v)}function c2(d,o,c,p,v=1/0){const m=d.range;if(!m)return 0;const x=Math.min(v,Math.max(c,p)),M=Math.log(x/1024)/Math.LN2;return An(m[0]+M,m[1]+M,o)}const pg=1/4e4;function nC(d,o){const c=dr(o.lat,-85.051129,Zo),p=new Zn(o.lng-180*pg,c),v=new Zn(o.lng+180*pg,c),m=d.project(p.lng,c),x=d.project(v.lng,c),M=u.fromLngLat(p),j=u.fromLngLat(v),F=x.x-m.x,E=x.y-m.y,N=j.x-M.x,L=j.y-M.y,k=Math.sqrt((N*N+L*L)/(F*F+E*E));return Math.log(k)/Math.LN2}function jF(d,o,c){const p=Math.cos(c),v=Math.sin(c);return{x:d*p-o*v,y:d*v+o*p}}function NF(d,o,c){Be.mat4.identity(d),Be.mat4.rotateZ(d,d,rt(o[2])),Be.mat4.rotateX(d,d,rt(o[0])),Be.mat4.rotateY(d,d,rt(o[1])),Be.mat4.scale(d,d,c),Be.mat4.multiply(d,d,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function u2(d,o,c,p,v,m,x,M){const j=[c[0]-o[0],c[1]-o[1],0],F=[p[0]-o[0],p[1]-o[1],0];if(Be.vec3.length(j)<1e-12||Be.vec3.length(F)<1e-12)return Be.quat.identity(d);const E=Be.vec3.cross([],j,F);Be.vec3.normalize(E,E),Be.vec3.subtract(F,p,o),j[2]=(m-v)*M,F[2]=(x-v)*M;const N=j;return Be.vec3.cross(N,j,F),Be.vec3.normalize(N,N),Be.quat.rotationTo(d,E,N)}function iC(d,o,c=!1){const p=Ps(o.zoom),v=function(m,x,M){const j=x.worldSize,F=[m[12],m[13],m[14]],E=zr(F[1]/j),N=Zs(F[0]/j),L=Be.mat4.identity([]),k=qi(1,E)*j,I=qi(1,0)*j*Tf(E,x.zoom),$=1/Lo(j);let Y=I*$;if(M){const ie=c2(x.projection,x.zoom,x.width,x.height,1024);Y=$*x.projection.pixelSpaceConversion(x.center.lat,j,ie)}const ee=lh(E,N);Be.vec3.add(ee,ee,Be.vec3.scale([],Be.vec3.normalize([],ee),k*Y*F[2]));const oe=function(ie){const he=[ie[0],ie[1],ie[2]];let me=[0,1,0];const be=Be.vec3.cross([],me,he);return Be.vec3.cross(me,he,be),Be.vec3.squaredLength(me)===0&&(me=[0,1,0],Be.vec3.cross(be,he,me)),Be.vec3.normalize(be,be),Be.vec3.normalize(me,me),Be.vec3.normalize(he,he),[be[0],be[1],be[2],0,me[0],me[1],me[2],0,he[0],he[1],he[2],0,ie[0],ie[1],ie[2],1]}(ee);Be.mat4.scale(L,L,[Y,Y,Y*k]),Be.mat4.translate(L,L,[-F[0],-F[1],-F[2]]);const se=Be.mat4.multiply([],x.globeMatrix,oe);return Be.mat4.multiply(se,se,L),Be.mat4.multiply(se,se,m),se}(d,o,c);if(p>0){const m=function(x,M){const j=M.worldSize,F=qi(1,0)*j*Tf(M.center.lat,M.zoom)/Lo(j),E=qi(1,M.center.lat)*j,N=Be.mat4.identity([]);return Be.mat4.rotateY(N,N,rt(M.center.lng)),Be.mat4.rotateX(N,N,rt(M.center.lat)),Be.mat4.translate(N,N,[0,0,Ho]),Be.mat4.scale(N,N,[F,F,F*E]),Be.mat4.translate(N,N,[M.point.x-.5*j,M.point.y-.5*j,0]),Be.mat4.multiply(N,N,x),Be.mat4.multiply(N,M.globeMatrix,N)}(d,o);return function(x,M,j){const F=(I,$,Y)=>{const ee=Be.vec3.length(I),oe=Be.vec3.length($),se=Aa(I,$,Y);return Be.vec3.scale(se,se,1/Be.vec3.length(se)*Dr(ee,oe,Y))},E=F([x[0],x[1],x[2]],[M[0],M[1],M[2]],j),N=F([x[4],x[5],x[6]],[M[4],M[5],M[6]],j),L=F([x[8],x[9],x[10]],[M[8],M[9],M[10]],j),k=Aa([x[12],x[13],x[14]],[M[12],M[13],M[14]],j);return[E[0],E[1],E[2],0,N[0],N[1],N[2],0,L[0],L[1],L[2],0,k[0],k[1],k[2],1]}(v,m,p)}return v}function IF(d,o,c,p){const v=xr.projectAabbCorners(p,c);let m=Number.MAX_VALUE,x=-1;for(let F=0;F<v.length;++F){const E=v[F];E[0]=(.5*E[0]+.5)*o.width,E[1]=(.5-.5*E[1])*o.height,E[2]<m&&(x=F,m=E[2])}const M=F=>new It(v[F][0],v[F][1]);let j;switch(x){case 0:case 6:j=[M(1),M(5),M(4),M(7),M(3),M(2),M(1)];break;case 1:case 7:j=[M(0),M(4),M(5),M(6),M(2),M(3),M(0)];break;case 3:case 5:j=[M(1),M(0),M(4),M(7),M(6),M(2),M(1)];break;default:j=[M(1),M(5),M(6),M(7),M(3),M(0),M(1)]}if(fe(d,j))return m}const xae=Qn([{name:"a_pos_3f",components:3,type:"Float32"}]),bae=Qn([{name:"a_color_3f",components:3,type:"Float32"}]),wae=Qn([{name:"a_color_4f",components:4,type:"Float32"}]),Sae=Qn([{name:"a_uv_2f",components:2,type:"Float32"}]),Aae=Qn([{name:"a_normal_3f",components:3,type:"Float32"}]),Tae=Qn([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Pae=Qn([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),DF={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class d2{constructor(o,c,p,v){this.message=(o?`${o}: `:"")+p,v&&(this.identifier=v),c!=null&&c.__line__&&(this.line=c.__line__)}}function LF(d,o){const c=d.indexOf("://")===-1;try{return new URL(d,c&&o?"http://example.com":void 0),!0}catch{return!1}}class zF{constructor(o,c){this.feature=o,this.instancedDataOffset=c,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class FF{constructor(){this.instancedDataArray=new yf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class aC{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(c=>c.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(o,c){}populate(o,c,p,v){this.tileToMeter=s(p);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:x,id:M,index:j,sourceLayerIndex:F}of o){const E=M??(x.properties&&x.properties.hasOwnProperty("id")?x.properties.id:void 0),N=te(x,m);if(!this.layers[0]._featureFilter.filter(new vi(this.zoom),N,p))continue;const L={id:E,sourceLayerIndex:F,index:j,geometry:m?N.geometry:Z(x,p,v),properties:x.properties,type:x.type,patterns:{}},k=this.addFeature(L,L.geometry,N);k&&c.featureIndex.insert(x,L.geometry,j,F,this.index,this.instancesPerModel[k].instancedDataArray.length,ar/32)}this.lookup=null}update(o,c,p,v){for(const m in this.instancesPerModel){const x=this.instancesPerModel[m];for(const M in o)x.idToFeaturesIndex.hasOwnProperty(M)&&(this.evaluate(x.features[x.idToFeaturesIndex[M]],o[M],x,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const c in this.instancesPerModel){const p=this.instancesPerModel[c];for(const v of p.features){const m=this.layers[0],x=v.feature,M=this.canonical,j=m.paint.get("model-rotation").evaluate(x,{},M),F=m.paint.get("model-scale").evaluate(x,{},M),E=m.paint.get("model-translation").evaluate(x,{},M);Be.vec3.exactEquals(v.rotation,j)&&Be.vec3.exactEquals(v.scale,F)&&Be.vec3.exactEquals(v.translation,E)||(this.evaluate(v,v.featureStates,p,!0),o=!0)}}return o}updateReplacement(o,c,p,v){if(c.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=c.updateTime;const m=c.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(OE(this.activeReplacements,m))return!1;this.activeReplacements=m;let x=!1;for(const M in this.instancesPerModel){const j=this.instancesPerModel[M],F=j.instancedDataArray;for(const E of j.features){const N=E.instancedDataOffset,L=E.instancedDataCount;for(let k=0;k<L;k++){const I=16*(k+N);let $=F.float32[I+0];const Y=$>ar;$=Y?$-ar:$;const ee=Math.floor($),oe=F.float32[I+1];let se=!1;for(const ie of this.activeReplacements)if(!ez(ie,p,DF.Model,v)&&!(ie.min.x>ee||ee>ie.max.x||ie.min.y>oe||oe>ie.max.y)&&(se=oz(az(ee,oe,o.canonical,ie.footprintTileId.canonical),ie.footprint),se))break;F.float32[I]=se?$+ar:$,x=x||se!==Y}}}return x}isEmpty(){for(const o in this.instancesPerModel)if(this.instancesPerModel[o].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const c in this.instancesPerModel){const p=this.instancesPerModel[c];p.instancedDataArray.length<0||p.instancedDataArray.length===0||(p.instancedDataBuffer?p.instancedDataBuffer.updateData(p.instancedDataArray):p.instancedDataBuffer=o.createVertexBuffer(p.instancedDataArray,Tae.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const c in this.instancesPerModel){const p=this.instancesPerModel[c];p.instancedDataArray.length!==0&&p.instancedDataBuffer&&p.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris)for(const c of this.modelUris)o.removeModel(c,"")}addFeature(o,c,p){const v=this.layers[0],m=v.layout.get("model-id").evaluate(p,{},this.canonical);if(!m)return rn(`modelId is not evaluated for layer ${v.id} and it is not going to get rendered.`),m;LF(m,!1)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new FF);const x=this.instancesPerModel[m],M=x.instancedDataArray,j=new zF(p,M.length);for(const F of c)for(const E of F){if(E.x<0||E.x>=ar||E.y<0||E.y>=ar)continue;const N=(this.lookupDim-1)/ar,L=this.lookupDim*(E.y*N|0)+E.x*N|0;if(this.lookup){if(this.lookup[L]!==0)continue;this.lookup[L]=1}this.instanceCount++;const k=M.length;M.resize(k+1),x.instancesEvaluatedElevation.push(0),M.float32[16*k]=E.x,M.float32[16*k+1]=E.y}return j.instancedDataCount=x.instancedDataArray.length-j.instancedDataOffset,j.instancedDataCount>0&&(o.id&&(x.idToFeaturesIndex[o.id]=x.features.length),x.features.push(j),this.evaluate(j,{},x,!1)),m}getModelUris(){return this.modelUris}evaluate(o,c,p,v){const m=this.layers[0],x=o.feature,M=this.canonical,j=o.rotation=m.paint.get("model-rotation").evaluate(x,c,M),F=o.scale=m.paint.get("model-scale").evaluate(x,c,M),E=o.translation=m.paint.get("model-translation").evaluate(x,c,M),N=m.paint.get("model-color").evaluate(x,c,M);N.a=m.paint.get("model-color-mix-intensity").evaluate(x,c,M);const L=[];this.maxVerticalOffset<E[2]&&(this.maxVerticalOffset=E[2]),this.maxScale=Math.max(Math.max(this.maxScale,F[0]),Math.max(F[1],F[2])),NF(L,j,F);const k=Math.round(100*N.a)+N.b/1.05;for(let I=0;I<o.instancedDataCount;++I){const $=o.instancedDataOffset+I,Y=16*$,ee=p.instancedDataArray.float32;let oe=0;v&&(oe=ee[Y+6]-p.instancesEvaluatedElevation[$]);const se=0|ee[Y+1];ee[Y]=(0|ee[Y])+N.r/1.05,ee[Y+1]=se+N.g/1.05,ee[Y+2]=k,ee[Y+3]=1/(M.z>10?this.tileToMeter:s(M,se)),ee[Y+4]=E[0],ee[Y+5]=E[1],ee[Y+6]=E[2]+oe,ee[Y+7]=L[0],ee[Y+8]=L[1],ee[Y+9]=L[2],ee[Y+10]=L[4],ee[Y+11]=L[5],ee[Y+12]=L[6],ee[Y+13]=L[8],ee[Y+14]=L[9],ee[Y+15]=L[10],p.instancesEvaluatedElevation[$]=E[2]}}}let BF,VF;hr(aC,"ModelBucket",{omit:["layers"]}),hr(FF,"PerModelAttributes"),hr(zF,"ModelFeature");const Uy=64,k_={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function UF(d,o,c,p,v,m,x,M,j,F=!1){const E=c.zoom,N=c.project(p),L=Tf(p.lat,E),k=1/L;Be.mat4.identity(d),Be.mat4.translate(d,d,[N.x+x[0]*k,N.y+x[1]*k,x[2]]);let I=1,$=1;const Y=c.worldSize;if(F){if(c.projection.name==="mercator"){let ie=0;c.elevation&&(ie=c.elevation.getAtPointOrZero(new u(N.x/Y,N.y/Y),0));const he=Be.vec4.transformMat4([],[N.x,N.y,ie,1],c.projMatrix)[3]/c.cameraToCenterDistance;I=he,$=he*Tf(c.center.lat,E)}else if(c.projection.name==="globe"){const ie=iC(d,c),he=Be.mat4.multiply([],c.projMatrix,ie),me=[0,0,0,1];Be.vec4.transformMat4(me,me,he);const be=me[3]/c.cameraToCenterDistance,Re=Ps(E),Me=c.projection.pixelsPerMeter(p.lat,Y)*Tf(p.lat,E),Ce=c.projection.pixelsPerMeter(c.center.lat,Y)*Tf(c.center.lat,E);I=be/Dr(Me,ag(c.center.lat),Re),$=be*L/Me,I*=Ce,$*=Ce}}else I=k;Be.mat4.scale(d,d,[I,I,$]);const ee=[...d],oe=o.orientation,se=[];if(NF(se,[oe[0]+v[0],oe[1]+v[1],oe[2]+v[2]],m),Be.mat4.multiply(d,ee,se),M&&c.elevation){let ie=0;const he=[];if(j&&c.elevation){ie=function(Re,Me,Ce,Xe,Ie){const Qe=Me.elevation;if(!Qe)return 0;const ot=xr.projectAabbCorners(Ce,Xe),nt=qi(1,Ie.lat)*Me.worldSize,lt=function(Er,pr){const vr=[0,0,1],Qr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const fn of Qr){const gn=Er[fn.corners[0]],yn=Er[fn.corners[1]],On=Er[fn.corners[2]],jn=[yn[0]-gn[0],yn[1]-gn[1],pr*(yn[2]-gn[2])],Li=Be.vec3.cross(jn,jn,[On[0]-gn[0],On[1]-gn[1],pr*(On[2]-gn[2])]);Be.vec3.normalize(Li,Li),fn.dotProductWithUp=Be.vec3.dot(Li,vr)}return Qr.sort((fn,gn)=>fn.dotProductWithUp-gn.dotProductWithUp),Qr[0].corners}(ot,nt),dt=ot[lt[0]],yt=ot[lt[1]],ct=ot[lt[2]],jt=ot[lt[3]],Vt=Qe.getAtPointOrZero(new u(dt[0]/Me.worldSize,dt[1]/Me.worldSize),0),kt=Qe.getAtPointOrZero(new u(yt[0]/Me.worldSize,yt[1]/Me.worldSize),0),cr=Qe.getAtPointOrZero(new u(ct[0]/Me.worldSize,ct[1]/Me.worldSize),0),ir=Qe.getAtPointOrZero(new u(jt[0]/Me.worldSize,jt[1]/Me.worldSize),0),Xt=(Vt+ir)/2,Ut=(kt+cr)/2;return Xt>Ut?kt<cr?u2(Re,yt,jt,dt,kt,ir,Vt,nt):u2(Re,ct,dt,jt,cr,Vt,ir,nt):Vt<ir?u2(Re,dt,yt,ct,Vt,kt,cr,nt):u2(Re,jt,ct,yt,ir,cr,kt,nt),Math.max(Xt,Ut)}(he,c,o.aabb,d,p);const me=Be.mat4.fromQuat([],he),be=Be.mat4.multiply([],me,se);Be.mat4.multiply(d,ee,be)}else ie=c.elevation.getAtPointOrZero(new u(N.x/Y,N.y/Y),0);ie!==0&&(d[14]+=ie)}}function gb(d,o,c=!1){d.uploaded||(d.gfxTexture=new tC(o,d.image,c?o.gl.R8:o.gl.RGBA8,{useMipmap:d.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),d.uploaded=!0,d.image=null)}function Eae(d,o,c){d.indexBuffer=o.createIndexBuffer(d.indexArray,!1,!0),d.vertexBuffer=o.createVertexBuffer(d.vertexArray,xae.members,!1,!0),d.normalArray&&(d.normalBuffer=o.createVertexBuffer(d.normalArray,Aae.members,!1,!0)),d.texcoordArray&&(d.texcoordBuffer=o.createVertexBuffer(d.texcoordArray,Sae.members,!1,!0)),d.colorArray&&(d.colorBuffer=o.createVertexBuffer(d.colorArray,(d.colorArray.bytesPerElement===12?bae:wae).members,!1,!0)),d.featureArray&&(d.pbrBuffer=o.createVertexBuffer(d.featureArray,Pae.members,!0)),d.segments=va.simpleSegment(0,0,d.vertexArray.length,d.indexArray.length);const p=d.material;p.pbrMetallicRoughness.baseColorTexture&&gb(p.pbrMetallicRoughness.baseColorTexture,o),p.pbrMetallicRoughness.metallicRoughnessTexture&&gb(p.pbrMetallicRoughness.metallicRoughnessTexture,o),p.normalTexture&&gb(p.normalTexture,o),p.occlusionTexture&&gb(p.occlusionTexture,o,c),p.emissionTexture&&gb(p.emissionTexture,o)}function oC(d,o,c){if(d.meshes)for(const p of d.meshes)Eae(p,o,c);if(d.children)for(const p of d.children)oC(p,o,c)}function h2(d){if(d.meshes)for(const o of d.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(d.children)for(const o of d.children)h2(o)}function sC(d){if(d.meshes)for(const c of d.meshes)c.vertexBuffer&&(c.vertexBuffer.destroy(),c.indexBuffer.destroy(),c.normalBuffer&&c.normalBuffer.destroy(),c.texcoordBuffer&&c.texcoordBuffer.destroy(),c.colorBuffer&&c.colorBuffer.destroy(),c.pbrBuffer&&c.pbrBuffer.destroy(),c.segments.destroy(),c.material&&((o=c.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(d.children)for(const c of d.children)sC(c)}class j_{constructor(o,c,p){this._demTile=o,this._dem=this._demTile.dem,this._scale=c,this._offset=p}static create(o,c,p){const v=p||o.findDEMTileFor(c);if(!v||!v.dem)return;const m=v.dem,x=v.tileID,M=1<<c.canonical.z-x.canonical.z;return new j_(v,m.dim/ar/M,[(c.canonical.x/M-x.canonical.x)*m.dim,(c.canonical.y/M-x.canonical.y)*m.dim])}tileCoordToPixel(o,c){const p=c*this._scale+this._offset[1],v=Math.floor(o*this._scale+this._offset[0]),m=Math.floor(p);return new It(v,m)}getElevationAt(o,c,p,v){const m=o*this._scale+this._offset[0],x=c*this._scale+this._offset[1],M=Math.floor(m),j=Math.floor(x),F=this._dem;return v=!!v,p?Dr(Dr(F.get(M,j,v),F.get(M,j+1,v),x-j),Dr(F.get(M+1,j,v),F.get(M+1,j+1,v),x-j),m-M):F.get(M,j,v)}getElevationAtPixel(o,c,p){return this._dem.get(o,c,!!p)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*qi(1,o)*this._dem.stride}}const lC=new Float32Array(262144),$y=new Uint8Array(262144);function $F(d){let o=0;if(d.meshes)for(const c of d.meshes)o=Math.max(o,c.aabb.max[2]);if(d.children)for(const c of d.children)o=Math.max(o,$F(c));return o}function qF(d,o,c){if(d.meshes)for(const p of d.meshes){if(p.aabb.min[0]===1/0)continue;const v=xr.applyTransform(p.aabb,d.matrix);c.insert(o,v.min[0],v.min[1],v.max[0],v.max[1])}if(d.children)for(const p of d.children)qF(p,o,c)}const GF=["","wall","door","roof","window","lamp","logo"];class KF{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:$F(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const c=new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const p of this.node.meshes)this.node.lightMeshIndex!==o&&(p.transformedAabb=xr.applyTransformFast(p.aabb,this.node.matrix),c.encapsulate(p.transformedAabb)),o++;this.aabb=c}return this.aabb}}class f2{constructor(o,c,p,v,m,x,M){this.id=p,this.layers=o,this.layerIds=this.layers.map(j=>j.fqid),this.stateDependentLayerIds=this.layers.filter(j=>j.isStateDependent()).map(j=>j.id),this.modelTraits|=k_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,v&&(this.modelTraits|=k_.HasMapboxMeshFeatures),m&&(this.modelTraits|=k_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const j of c)this.nodesInfo.push(new KF(j)),qF(j,M.featureIndexArray.length,M.grid),M.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,M.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,c){for(const p of this.getNodesInfo()){const v=p.node;v.footprint&&c.push({footprint:v.footprint,id:o})}}update(o){const c=Object.keys(o).length!==0;if(c&&!this.stateDependentLayers.length)return;const p=c?this.stateDependentLayers:this.layers;if(!Vn(o,this.states))for(const v of p)this.evaluate(v,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const c=this.getNodesInfo();for(const p of c){const v=p.node;this.uploaded?this.updatePbrBuffer(v):oC(v,o,!0)}for(const p of c)h2(p.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let c=!1;if(!o.meshes)return c;for(const p of o.meshes)p.pbrBuffer&&(p.pbrBuffer.updateData(p.featureArray),c=!0);return c}needsReEvaluation(o,c,p){const v=o.transform.projectionOptions,m=o.style.getBrightness(),x=this.brightness!==m;if(!this.uploaded||this.dirty||v.name!==this.projection.name||yb(p.paint.get("model-color").value,x)||yb(p.paint.get("model-color-mix-intensity").value,x)||yb(p.paint.get("model-roughness").value,x)||yb(p.paint.get("model-emissive-strength").value,x)||yb(p.paint.get("model-height-based-emissive-strength-multiplier").value,x)){this.projection=v,this.brightness=m;const M=this.getNodesInfo();for(const j of M)j.state=null;return!0}return!1}evaluateScale(o,c){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const p=this.getNodesInfo(),v=this.id.canonical;for(const m of p){const x=m.feature;m.evaluatedScale=c.paint.get("model-scale").evaluate(x,{},v)}}evaluate(o,c){const p=this.getNodesInfo();for(const v of p){if(!v.node.meshes)continue;const m=v.feature,x=c&&c[m.id];if(Vn(x,v.state))continue;v.state=structuredClone(x);const M=v.node.meshes&&v.node.meshes[0].featureData,j=v.evaluatedColor[2],F=v.evaluatedRMEA[2],E=this.id.canonical;if(v.hasTranslucentParts=!1,M){for(let N=0;N<GF.length;N++){const L=GF[N];L.length&&(m.properties.part=L);const k=o.paint.get("model-color").evaluate(m,x,E).toRenderColor(null),I=o.paint.get("model-color-mix-intensity").evaluate(m,x,E);v.evaluatedColor[N]=[k.r,k.g,k.b,I],v.evaluatedRMEA[N][0]=o.paint.get("model-roughness").evaluate(m,x,E),v.evaluatedRMEA[N][2]=o.paint.get("model-emissive-strength").evaluate(m,x,E),v.evaluatedRMEA[N][3]=k.a,v.emissionHeightBasedParams[N]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,x,E),!v.hasTranslucentParts&&k.a<1&&(v.hasTranslucentParts=!0)}delete m.properties.part,Mae(v,j!==v.evaluatedColor[2]||F!==v.evaluatedRMEA[2],this.modelTraits)}else v.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(m,x,E);v.evaluatedScale=o.paint.get("model-scale").evaluate(m,x,E),this.updatePbrBuffer(v.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,c,p,v){const m=o.findDEMTileFor(p);if(m&&(m.tileID.canonical!==this.terrainTile||c!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const x=j_.create(o,p,m);if(!x)return;this.modelTraits&k_.HasMapboxMeshFeatures&&this.updateDEM(o,x,p,v);for(const M of this.getNodesInfo()){const j=M.node;if(!j.footprint||!j.footprint.vertices||!j.footprint.vertices.length)continue;const F=j.footprint.vertices;let E=x.getElevationAt(F[0].x,F[0].y,!0,!0);for(let N=1;N<F.length;N++)E=Math.min(E,x.getElevationAt(F[N].x,F[N].y,!0,!0));j.elevation=E}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=c}}updateDEM(o,c,p,v){let m=c._dem._modifiedForSources[v];if(m===void 0&&(c._dem._modifiedForSources[v]=[],m=c._dem._modifiedForSources[v]),m.includes(p.canonical))return;const x=c._dem.dim;m.push(p.canonical);let M=!1;for(const j of this.getNodesInfo()){const F=j.node;if(!F.footprint||!F.footprint.grid)continue;const E=F.footprint.grid,N=c.tileCoordToPixel(E.min.x,E.min.y),L=c.tileCoordToPixel(E.max.x,E.max.y),k=Math.min(Math.min(x-L.y,N.x),Math.min(N.y,x-L.x));if(k<0)continue;const I=dr(k,2,5);let $=Math.max(0,N.x-I),Y=Math.max(0,N.y-I),ee=Math.min(L.x+I,x-1),oe=Math.min(L.y+I,x-1);for(let me=Y;me<=oe;++me)for(let be=$;be<=ee;++be)$y[me*x+be]=255;let se=0,ie=0;for(let me=0;me<E.cellsY;++me)for(let be=0;be<E.cellsX;++be){if(!E.cells[me*E.cellsX+be])continue;const Re=c.tileCoordToPixel(E.min.x+be/E.xScale,E.min.y+me/E.yScale),Me=c.tileCoordToPixel(E.min.x+(be+1)/E.xScale,E.min.y+(me+1)/E.yScale);for(let Ce=Re.y;Ce<=Math.min(Me.y+1,x-1);++Ce)for(let Xe=Re.x;Xe<=Math.min(Me.x+1,x-1);++Xe)$y[Ce*x+Xe]===255&&($y[Ce*x+Xe]=0,se+=c.getElevationAtPixel(Xe,Ce),ie++)}const he=se/ie;$=Math.max(1,N.x-I),Y=Math.max(1,N.y-I),ee=Math.min(L.x+I,x-2),oe=Math.min(L.y+I,x-2),M=!0;for(let me=Y;me<=oe;++me)for(let be=$;be<=ee;++be)$y[me*x+be]===0&&(lC[me*x+be]=c._dem.set(be,me,he));for(let me=1;me<I;++me){$=Math.max(1,N.x-me),Y=Math.max(1,N.y-me),ee=Math.min(L.x+me,x-2),oe=Math.min(L.y+me,x-2);for(let be=Y;be<=oe;++be)for(let Re=$;Re<=ee;++Re){const Me=be*x+Re;if($y[Me]===255){let Ce=0,Xe=0,Ie=-1,Qe=-1;for(let ot=-1;ot<=1;++ot)for(let nt=-1;nt<=1;++nt){const lt=(be+ot)*x+Re+nt;if($y[lt]>=me)continue;const dt=lC[lt],yt=Math.abs(dt);yt>Xe&&(Ce=dt,Xe=yt,Ie=nt,Qe=ot)}if(Xe>.1){const ot=1-(me+.5*Math.abs(Ie*Qe))/I;let nt=c._dem.get(Re,be)+Ce*ot;const lt=c._dem.get(Re+Ie,be+Qe),dt=c._dem.get(Re-Ie,be-Qe,!0);(nt-lt)*(nt-dt)>0&&(nt=(lt+dt)/2),lC[Me]=c._dem.set(Re,be,nt),$y[Me]=me}}}}}M&&(c._demTile.needsDEMTextureUpload=!0,c._dem._timestamp=Ge.now())}getNodesInfo(){return this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const c of o)h2(c.node),sC(c.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,c){if(c.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=c.updateTime;const p=c.getReplacementRegionsForTile(o.toUnwrapped()),v=this.getNodesInfo();for(let m=0;m<this.nodesInfo.length;m++){const x=v[m].node;v[m].hiddenByReplacement=!!x.footprint&&!p.find(M=>M.footprint===x.footprint)}}getHeightAtTileCoord(o,c){const p=this.getNodesInfo(),v=[],m=[0,0,0],x=Be.mat4.identity([]);for(let M=0;M<this.nodesInfo.length;M++){const j=p[M],F=j.node.meshes[0],E=F.transformedAabb;if(o<E.min[0]||c<E.min[1]||o>E.max[0]||c>E.max[1])continue;if(j.node.hidden===!0)return{height:1/0,maxHeight:j.feature.properties.height,hidden:!1,verticalScale:j.evaluatedScale[2]};Be.mat4.invert(x,j.node.matrix),m[0]=o,m[1]=c,Be.vec3.transformMat4(m,m,x);const N=(m[0]-F.aabb.min[0])/(F.aabb.max[0]-F.aabb.min[0])*Uy|0,L=Math.min(63,(m[1]-F.aabb.min[1])/(F.aabb.max[1]-F.aabb.min[1])*Uy|0)*Uy+Math.min(63,N),k=F.heightmap[L];if(!(k<0&&j.node.footprint))return j.hiddenByReplacement?void 0:{height:k,maxHeight:j.feature.properties.height,hidden:!1,verticalScale:j.evaluatedScale[2]};if(j.node.footprint.grid.query(new It(o,c),new It(o,c),v),v.length>0)return{height:void 0,maxHeight:j.feature.properties.height,hidden:j.hiddenByReplacement,verticalScale:j.evaluatedScale[2]}}}}function yb(d,o){return!d.isLightConstant&&o}function Cae(d,o,c,p,v,m,x,M){let j=(61440&o|(61440&o)>>4)>>8,F=(3840&o|(3840&o)>>4)>>4,E=240&o|(240&o)>>4;c[3]>0&&(j=Dr(j,255*c[0],c[3]),F=Dr(F,255*c[1],c[3]),E=Dr(E,255*c[2],c[3]));const N=j<<8|F,L=E<<8|Math.floor(255*p[3]),k=function(me){const be=dr(me,0,2);return Math.min(Math.round(.5*be*255),255)}(p[2])<<8|15*p[0]<<4|15*p[1],I=dr(v[0],0,1),$=dr(v[1],0,1),Y=dr(v[2],0,1),ee=dr(v[3],0,1);let oe,se,ie,he;if(I!==$&&x!==m&&$!==I){const me=x-m;se=1/(me*($-I)),ie=-(m+me*I)/(me*($-I));const be=dr(v[4],-1,1);he=Math.pow(10,be),oe=255*Y<<8|255*ee}else oe=65535,se=0,ie=1,he=1;if(d.emplaceBack(N,L,k,oe,se,ie,he),M){const me=M.length;M.clear();for(let be=0;be<me;be++)M.emplaceBack(N,L,k,oe,se,ie,he)}}function Mae(d,o,c){const p=d.node;let v=0;const m=c&k_.HasMeshoptCompression;for(const x of p.meshes){if(p.lights&&p.lightMeshIndex===v||!x.featureData)continue;x.featureArray=new ah,x.featureArray.reserve(x.featureData.length);let M=o;for(const j of x.featureData){const F=m?65535&j:j>>16&65535,E=m?j>>16&65535:65535&j,N=(15&E)<8?15&E:0,L=d.evaluatedRMEA[N],k=d.evaluatedColor[N],I=d.emissionHeightBasedParams[N];let $;if(M&&N===2&&p.lights&&($=new ah,$.resize(10*p.lights.length)),Cae(x.featureArray,F,k,L,I,x.aabb.min[2],x.aabb.max[2],$),$&&M){M=!1;const Y=p.meshes[p.lightMeshIndex];Y.featureArray=$,Y.featureArray._trim()}}x.featureArray._trim(),v++}}function WF(d,o,c,p){const v=1<<d.z;o.lat=zr((p/ar+d.y)/v),o.lng=Zs((c/ar+d.x)/v)}hr(f2,"Tiled3dModelBucket",{omit:["layers"]}),hr(KF,"Tiled3dModelFeature");const Oae={circle:class extends fi{constructor(d,o,c,p){super(d,{layout:Bt||(Bt=new $i({"circle-sort-key":new or(vt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Yt(vt.layout_circle["circle-elevation-reference"]),visibility:new Yt(vt.layout_circle.visibility)})),paint:ft||(ft=new $i({"circle-radius":new or(vt.paint_circle["circle-radius"]),"circle-color":new or(vt.paint_circle["circle-color"]),"circle-blur":new or(vt.paint_circle["circle-blur"]),"circle-opacity":new or(vt.paint_circle["circle-opacity"]),"circle-translate":new Yt(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new Yt(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Yt(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Yt(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new or(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new or(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new or(vt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Yt(vt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p)}createBucket(d){return new ye(d)}queryRadius(d){const o=d;return Ct("circle-radius",this,o)+Ct("circle-stroke-width",this,o)+Mt(this.paint.get("circle-translate"))}queryIntersectsFeature(d,o,c,p,v,m,x,M){const j=Tt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,d.pixelToTileUnitsFactor),F=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c);return Bp(d,p,m,x,M,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",j,F)}getProgramIds(){return["circle"]}getDefaultProgramParams(d,o,c){const p=Pf(this);return{config:new lu(this,{zoom:o,lut:c}),defines:p,overrideFog:!1}}},heatmap:class extends fi{createBucket(d){return new DS(d)}constructor(d,o,c,p){super(d,{layout:hh||(hh=new $i({visibility:new Yt(vt.layout_heatmap.visibility)})),paint:Ly||(Ly=new $i({"heatmap-radius":new or(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new or(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Yt(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ol(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Yt(vt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(d){return Ct("heatmap-radius",this,d)}queryIntersectsFeature(d,o,c,p,v,m,x,M){const j=this.paint.get("heatmap-radius").evaluate(o,c);return Bp(d,p,m,x,M,!0,!0,new It(0,0),j)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(d,o,c){return d==="heatmap"?{config:new lu(this,{zoom:o,lut:c}),overrideFog:!1}:{}}},hillshade:class extends fi{constructor(d,o,c,p){super(d,{layout:Ef||(Ef=new $i({visibility:new Yt(vt.layout_hillshade.visibility)})),paint:zy||(zy=new $i({"hillshade-illumination-direction":new Yt(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Yt(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Yt(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Yt(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Yt(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Yt(vt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Yt(vt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(d,o,c){return{overrideFog:!1}}},fill:class extends fi{constructor(d,o,c,p){super(d,{layout:vo||(vo=new $i({"fill-sort-key":new or(vt.layout_fill["fill-sort-key"]),visibility:new Yt(vt.layout_fill.visibility),"fill-elevation-reference":new Yt(vt.layout_fill["fill-elevation-reference"])})),paint:Ft||(Ft=new $i({"fill-antialias":new Yt(vt.paint_fill["fill-antialias"]),"fill-opacity":new or(vt.paint_fill["fill-opacity"]),"fill-color":new or(vt.paint_fill["fill-color"]),"fill-outline-color":new or(vt.paint_fill["fill-outline-color"]),"fill-translate":new Yt(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new Yt(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new or(vt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Yt(vt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new or(vt.paint_fill["fill-z-offset"]),"fill-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p)}getProgramIds(){const d=this.paint.get("fill-pattern"),o=d&&d.constantOr(1),c=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&c.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),c}getDefaultProgramParams(d,o,c){return{config:new lu(this,{zoom:o,lut:c}),overrideFog:!1}}recalculate(d,o){super.recalculate(d,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new cn(d)}queryRadius(){return Mt(this.paint.get("fill-translate"))}queryIntersectsFeature(d,o,c,p,v,m){return!d.queryGeometry.isAboveHorizon&&_e(ut(d.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,d.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends fi{constructor(d,o,c,p){super(d,{layout:bz||(bz=new $i({visibility:new Yt(vt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Yt(vt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:wz||(wz=new $i({"fill-extrusion-opacity":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new or(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new or(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new or(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new or(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new or(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new or(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new or(vt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new or(vt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Yt(vt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new $S(d)}queryRadius(){return Mt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(d,o,c,p,v,m,x,M,j){const F=Tt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,d.pixelToTileUnitsFactor),E=this.paint.get("fill-extrusion-height").evaluate(o,c),N=this.paint.get("fill-extrusion-base").evaluate(o,c),L=[0,0],k=M&&m.elevation,I=m.elevation?m.elevation.exaggeration():1,$=d.tile.getBucket(this);if(k&&$ instanceof $S){const ie=$.centroidVertexArray,he=j+1;he<ie.length&&(L[0]=ie.geta_centroid_pos0(he),L[1]=ie.geta_centroid_pos1(he))}if(L[0]===0&&L[1]===1)return!1;m.projection.name==="globe"&&(p=xz([p],[new It(0,0),new It(ar,ar)],d.tileID.canonical).map(ie=>ie.polygon).flat());const Y=k?M:null,[ee,oe]=function(ie,he,me,be,Re,Me,Ce,Xe,Ie,Qe,ot){return ie.projection.name==="globe"?function(nt,lt,dt,yt,ct,jt,Vt,kt,cr,ir,Xt){const Ut=[],Er=[],pr=nt.projection.upVectorScale(Xt,nt.center.lat,nt.worldSize).metersToTile,vr=[0,0,0,1],Qr=[0,0,0,1],fn=(yn,On,jn,Li)=>{yn[0]=On,yn[1]=jn,yn[2]=Li,yn[3]=1},gn=_z();dt>0&&(dt+=gn),yt+=gn;for(const yn of lt){const On=[],jn=[];for(const Li of yn){const Si=Li.x+ct.x,ln=Li.y+ct.y,gi=nt.projection.projectTilePoint(Si,ln,Xt),xi=nt.projection.upVector(Xt,Li.x,Li.y);let Zi=dt,La=yt;if(Vt){const oo=Az(Si,ln,dt,yt,Vt,kt,cr,ir);Zi+=oo.base,La+=oo.top}dt!==0?fn(vr,gi.x+xi[0]*pr*Zi,gi.y+xi[1]*pr*Zi,gi.z+xi[2]*pr*Zi):fn(vr,gi.x,gi.y,gi.z),fn(Qr,gi.x+xi[0]*pr*La,gi.y+xi[1]*pr*La,gi.z+xi[2]*pr*La),Be.vec3.transformMat4(vr,vr,jt),Be.vec3.transformMat4(Qr,Qr,jt),On.push(new By(vr[0],vr[1],vr[2])),jn.push(new By(Qr[0],Qr[1],Qr[2]))}Ut.push(On),Er.push(jn)}return[Ut,Er]}(ie,he,me,be,Re,Me,Ce,Xe,Ie,Qe,ot):Ce?function(nt,lt,dt,yt,ct,jt,Vt,kt,cr){const ir=[],Xt=[],Ut=[0,0,0,1];for(const Er of nt){const pr=[],vr=[];for(const Qr of Er){const fn=Qr.x+yt.x,gn=Qr.y+yt.y,yn=Az(fn,gn,lt,dt,jt,Vt,kt,cr);Ut[0]=fn,Ut[1]=gn,Ut[2]=yn.base,Ut[3]=1,Be.vec4.transformMat4(Ut,Ut,ct),Ut[3]=Math.max(Ut[3],1e-5);const On=new By(Ut[0]/Ut[3],Ut[1]/Ut[3],Ut[2]/Ut[3]);Ut[0]=fn,Ut[1]=gn,Ut[2]=yn.top,Ut[3]=1,Be.vec4.transformMat4(Ut,Ut,ct),Ut[3]=Math.max(Ut[3],1e-5);const jn=new By(Ut[0]/Ut[3],Ut[1]/Ut[3],Ut[2]/Ut[3]);pr.push(On),vr.push(jn)}ir.push(pr),Xt.push(vr)}return[ir,Xt]}(he,me,be,Re,Me,Ce,Xe,Ie,Qe):function(nt,lt,dt,yt,ct){const jt=[],Vt=[],kt=ct[8]*lt,cr=ct[9]*lt,ir=ct[10]*lt,Xt=ct[11]*lt,Ut=ct[8]*dt,Er=ct[9]*dt,pr=ct[10]*dt,vr=ct[11]*dt;for(const Qr of nt){const fn=[],gn=[];for(const yn of Qr){const On=yn.x+yt.x,jn=yn.y+yt.y,Li=ct[0]*On+ct[4]*jn+ct[12],Si=ct[1]*On+ct[5]*jn+ct[13],ln=ct[2]*On+ct[6]*jn+ct[14],gi=ct[3]*On+ct[7]*jn+ct[15],xi=Li+kt,Zi=Si+cr,La=ln+ir,oo=Math.max(gi+Xt,1e-5),za=Li+Ut,Ta=Si+Er,Wa=ln+pr,_o=Math.max(gi+vr,1e-5);fn.push(new By(xi/oo,Zi/oo,La/oo)),gn.push(new By(za/_o,Ta/_o,Wa/_o))}jt.push(fn),Vt.push(gn)}return[jt,Vt]}(he,me,be,Re,Me)}(m,p,N,E,F,x,Y,L,I,m.center.lat,d.tileID.canonical),se=d.queryGeometry;return function(ie,he,me){let be=1/0;_e(me,he)&&(be=Sz(me,he[0]));for(let Re=0;Re<he.length;Re++){const Me=he[Re],Ce=ie[Re];for(let Xe=0;Xe<Me.length-1;Xe++){const Ie=Me[Xe],Qe=[Ie,Me[Xe+1],Ce[Xe+1],Ce[Xe],Ie];fe(me,Qe)&&(be=Math.min(be,Sz(me,Qe)))}}return be!==1/0&&be}(ee,oe,se.isPointQuery()?se.screenBounds:se.screenGeometry)}},line:class extends fi{constructor(d,o,c,p){const v=Nz();super(d,v,o,c,p),v.layout&&(this.layout=new ed(v.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(d){if(d==="line-gradient"){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Fd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(d,o){super.recalculate(d,o),this.paint._values["line-floorwidth"]=(()=>{if(ab)return ab;const c=Nz();return ab=new kie(c.paint.properties["line-width"].specification),ab.useIntegerZoom=!0,ab})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new NE(d)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(d,o,c){const p=kz(this);return{config:new lu(this,{zoom:o,lut:c}),defines:p,overrideFog:!1}}queryRadius(d){const o=d,c=Iz(Ct("line-width",this,o),Ct("line-gap-width",this,o)),p=Ct("line-offset",this,o);return c/2+Math.abs(p)+Mt(this.paint.get("line-translate"))}queryIntersectsFeature(d,o,c,p,v,m){if(d.queryGeometry.isAboveHorizon)return!1;const x=ut(d.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,d.pixelToTileUnitsFactor),M=d.pixelToTileUnitsFactor/2*Iz(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),j=this.paint.get("line-offset").evaluate(o,c);return j&&(p=function(F,E){const N=[],L=new It(0,0);for(let k=0;k<F.length;k++){const I=F[k],$=[];for(let Y=0;Y<I.length;Y++){const ee=I[Y],oe=I[Y+1],se=Y===0?L:ee.sub(I[Y-1])._unit()._perp(),ie=Y===I.length-1?L:oe.sub(ee)._unit()._perp(),he=se._add(ie)._unit();he._mult(1/(he.x*ie.x+he.y*ie.y)),$.push(he._mult(E)._add(ee))}N.push($)}return N}(p,j*d.pixelToTileUnitsFactor)),function(F,E,N){for(let L=0;L<E.length;L++){const k=E[L];if(F.length>=3){for(let I=0;I<k.length;I++)if(Ve(F,k[I]))return!0}if(Ee(F,k,N))return!0}return!1}(x,p,M)}isTileClipped(){return!0}isDraped(d){return!this.hasElevatedBuckets}},symbol:a2,background:class extends fi{constructor(d,o,c,p){super(d,{layout:vF||(vF=new $i({visibility:new Yt(vt.layout_background.visibility)})),paint:_F||(_F=new $i({"background-pitch-alignment":new Yt(vt.paint_background["background-pitch-alignment"]),"background-color":new Yt(vt.paint_background["background-color"]),"background-pattern":new Yt(vt.paint_background["background-pattern"]),"background-opacity":new Yt(vt.paint_background["background-opacity"]),"background-emissive-strength":new Yt(vt.paint_background["background-emissive-strength"]),"background-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(d,o,c){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:AF,"raster-particle":OF,sky:class extends fi{constructor(d,o,c,p){super(d,{layout:EF||(EF=new $i({visibility:new Yt(vt.layout_sky.visibility)})),paint:CF||(CF=new $i({"sky-type":new Yt(vt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Yt(vt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Yt(vt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Yt(vt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Yt(vt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ol(vt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Yt(vt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Yt(vt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Yt(vt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){d==="sky-gradient"?this._updateColorRamp():d!=="sky-atmosphere-sun"&&d!=="sky-atmosphere-halo-color"&&d!=="sky-atmosphere-color"&&d!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=sg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(d){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=d.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(d,o){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),v=!p,m=d.style.light,x=m.properties.get("position");return v&&m.properties.get("anchor")==="viewport"&&rn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?rC(x.azimuthal,90-x.polar,o):rC(p[0],90-p[1],o)}const c=this.paint.get("sky-gradient-center");return rC(c[0],90-c[1],o)}isSky(){return!0}markSkyboxValid(d){this._skyboxInvalidated=!1,this._lightPosition=d.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const d=this.paint.get("sky-type");return d==="atmosphere"?["skyboxCapture","skybox"]:d==="gradient"?["skyboxGradient"]:null}},slot:class extends fi{constructor(d,o,c,p){super(d,{paint:MF||(MF=new $i({}))},o,null)}},model:class extends fi{constructor(d,o,c,p){super(d,{layout:BF||(BF=new $i({visibility:new Yt(vt.layout_model.visibility),"model-id":new or(vt.layout_model["model-id"])})),paint:VF||(VF=new $i({"model-opacity":new or(vt.paint_model["model-opacity"]),"model-rotation":new or(vt.paint_model["model-rotation"]),"model-scale":new or(vt.paint_model["model-scale"]),"model-translation":new or(vt.paint_model["model-translation"]),"model-color":new or(vt.paint_model["model-color"]),"model-color-mix-intensity":new or(vt.paint_model["model-color-mix-intensity"]),"model-type":new Yt(vt.paint_model["model-type"]),"model-cast-shadows":new Yt(vt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Yt(vt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Yt(vt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new or(vt.paint_model["model-emissive-strength"]),"model-roughness":new or(vt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new or(vt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Yt(vt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Yt(vt.paint_model["model-front-cutoff"]),"model-color-use-theme":new or({type:"string",default:"default","property-type":"data-driven"})}))},o,c,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new aC(d)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(d){return d instanceof f2?ar-1:0}queryIntersectsFeature(d,o,c,p,v,m){if(!this.modelManager)return!1;const x=this.modelManager,M=d.tile.getBucket(this);if(!(M&&M instanceof aC))return!1;for(const j in M.instancesPerModel){const F=M.instancesPerModel[j],E=o.id!==void 0?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(F.idToFeaturesIndex.hasOwnProperty(E)){const N=F.features[F.idToFeaturesIndex[E]],L=x.getModel(j,this.scope);if(!L)return!1;let k=Be.mat4.create();const I=new Zn(0,0),$=M.canonical;let Y=Number.MAX_VALUE;for(let ee=0;ee<N.instancedDataCount;++ee){const oe=16*(N.instancedDataOffset+ee),se=F.instancedDataArray.float32,ie=[se[oe+4],se[oe+5],se[oe+6]];WF($,I,se[oe],0|se[oe+1]),UF(k,L,m,I,N.rotation,N.scale,ie,!1,!1,!1),m.projection.name==="globe"&&(k=iC(k,m));const he=Be.mat4.multiply([],m.projMatrix,k),me=d.queryGeometry,be=IF(me.isPointQuery()?me.screenBounds:me.screenGeometry,m,he,L.aabb);be!=null&&(Y=Math.min(be,Y))}return Y!==Number.MAX_VALUE&&Y}}return!1}_handleOverridablePaintPropertyUpdate(d,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven()||d!=="model-color"&&d!=="model-color-mix-intensity"&&d!=="model-rotation"&&d!=="model-scale"&&d!=="model-translation"&&d!=="model-emissive-strength")}_isPropertyZoomDependent(d){const o=this._transitionablePaint._values[d];return o!=null&&o.value!=null&&o.value.expression!=null&&o.value.expression instanceof Hd}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends fi{constructor(d,o,c,p){super(d,{layout:Rt||(Rt=new $i({"clip-layer-types":new Yt(vt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Yt(vt.layout_clip["clip-layer-scope"])})),paint:$t||($t=new $i({}))},o,c,p)}recalculate(d,o){super.recalculate(d,o)}createBucket(d){return new kn(d)}isTileClipped(){return!0}is3D(){return!0}}};class Rae{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class kae{constructor(){this.tasks={},this.taskQueue=[],ys(["process"],this),this.invoker=new Rae(this.process),this.nextId=0}add(o,c){const p=this.nextId++,v=function({type:m,isSymbolTile:x,zoom:M}){return M=M||0,m==="message"?0:m!=="maybePrepare"||x?m!=="parseTile"||x?m==="parseTile"&&x?300-M:m==="maybePrepare"&&x?400-M:500:200-M:100-M}(c);if(v===0){try{o()}finally{}return null}return this.tasks[p]={fn:o,metadata:c,priority:v,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const o=this.pick();if(o===null)return;const c=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!c)return;c.fn()}finally{}}pick(){let o=null,c=1/0;for(let v=0;v<this.taskQueue.length;v++){const m=this.tasks[this.taskQueue[v]];m.priority<c&&(c=m.priority,o=v)}if(o===null)return null;const p=this.taskQueue[o];return this.taskQueue.splice(o,1),p}remove(){this.invoker.remove()}}class HF{constructor(o,c,p){this.target=o,this.parent=c,this.mapId=p,this.callbacks={},this.cancelCallbacks={},ys(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new kae}send(o,c,p,v,m=!1,x){const M=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=x,this.callbacks[M]=p);const j=new Set;return this.target.postMessage({id:M,type:o,hasCallback:!!p,targetMapId:v,mustQueue:m,sourceMapId:this.mapId,data:os(c,j)},j),{cancel:()=>{p&&delete this.callbacks[M],this.target.postMessage({id:M,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(o){const c=o.data,p=c.id;if(p&&(!c.targetMapId||this.mapId===c.targetMapId))if(c.type==="<cancel>"){const v=this.cancelCallbacks[p];delete this.cancelCallbacks[p],v&&v.cancel()}else if(c.mustQueue||Uo()){const v=this.callbacks[p],m=this.scheduler.add(()=>this.processTask(p,c),v&&v.metadata||{type:"message"});m&&(this.cancelCallbacks[p]=m)}else this.processTask(p,c)}processTask(o,c){if(delete this.cancelCallbacks[o],c.type==="<response>"){const p=this.callbacks[o];delete this.callbacks[o],p&&(c.error?p(cl(c.error)):p(null,cl(c.data)))}else{const p=new Set,v=c.hasCallback?(x,M)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:x?os(x):null,data:os(M,p)},p)}:()=>{},m=cl(c.data);if(this.parent[c.type])this.parent[c.type](c.sourceMapId,m,v);else if(this.parent.getWorkerSource){const x=c.type.split(".");this.parent.getWorkerSource(c.sourceMapId,x[0],m.source,m.scope)[x[1]](m,v)}else v(new Error(`Could not find function ${c.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var vb={workerUrl:"",workerClass:null,workerParams:void 0};const cC="mapboxgl_preloaded_worker_pool";class qy{constructor(){this.active={}}acquire(o,c=qy.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<c;)this.workers.push(vb.workerClass!=null?new vb.workerClass:new self.Worker(vb.workerUrl,vb.workerParams));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.workers&&this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[cC]}numActive(){return Object.keys(this.active).length}}qy.workerCount=2;class N_{constructor(o,c,p="Worker",v=qy.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=$a();const m=this.workerPool.acquire(this.id,v);for(let x=0;x<m.length;x++){const M=new N_.Actor(m[x],c,this.id);M.name=`${p} ${x}`,this.actors.push(M)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,c,p){Bi(this.actors,(v,m)=>{v.send(o,c,m)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}let _b,uC;function p2(){return _b||(_b=new qy),_b}N_.Actor=HF;const dC=new Jn(0,0,0);var hC=(d=>(d[d.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",d[d.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",d[d.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",d))(hC||{}),m2=(d=>(d[d.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",d[d.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",d[d.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",d[d.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",d))(m2||{}),xb=(d=>(d[d.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",d[d.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",d[d.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",d[d.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",d[d.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",d))(xb||{}),ZF=(d=>(d[d.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",d[d.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",d[d.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",d))(ZF||{}),I_=(d=>(d[d.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",d[d.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",d[d.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",d[d.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",d[d.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",d[d.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",d))(I_||{}),YF=(d=>(d[d.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",d[d.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",d[d.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",d))(YF||{});function jae(d,o,c){d===1&&o.icons.push(function(p,v){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:x}=m;if(x.content_area){const{content_area:M}=x;M.top==null&&(M.top=M.left),M.width==null&&(M.width=m.usvg_tree.width),M.height==null&&(M.height=M.width)}return x.stretch_x&&x.stretch_x.length&&XF(x,"x"),x.stretch_y&&x.stretch_y.length&&XF(x,"y"),m}(p.readFields(Nae,{name:void 0},v))}(c,c.readVarint()+c.pos))}function XF(d,o){const c=[],p=d[`stretch_${o}`];let v=null;for(let m=0;m<p.length;m++)v===null?v=c.length===0?p[0]:c[c.length-1][1]+p[m]:(c.push([v,v+p[m]]),v=null);d[`stretch_${o}_areas`]=c}function Nae(d,o,c){d===1?o.name=c.readString():d===2?o.metadata=function(p,v){return p.readFields(Iae,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},v)}(c,c.readVarint()+c.pos):d===3&&(o.usvg_tree=function(p,v){return p.readFields(zae,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},v)}(c,c.readVarint()+c.pos),o.data="usvg_tree")}function Iae(d,o,c){d===1?o.stretch_x=c.readPackedVarint():d===2?o.stretch_y=c.readPackedVarint():d===3?o.content_area=function(p,v){return p.readFields(Dae,{left:0},v)}(c,c.readVarint()+c.pos):d===4&&o.variables.push(function(p,v){return p.readFields(Lae,{name:void 0},v)}(c,c.readVarint()+c.pos))}function Dae(d,o,c){d===1?o.left=c.readVarint():d===2?o.width=c.readVarint():d===3?o.top=c.readVarint():d===4&&(o.height=c.readVarint())}function Lae(d,o,c){d===1?o.name=c.readString():d===2&&(o.rgb_color=v2(c.readVarint()),o.value="rgb_color")}function zae(d,o,c){d===1?o.width=o.height=c.readVarint():d===2?o.height=c.readVarint():d===3?o.children.push(g2(c,c.readVarint()+c.pos)):d===4?o.linear_gradients.push(function(p,v){return p.readFields(Gae,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},v)}(c,c.readVarint()+c.pos)):d===5?o.radial_gradients.push(function(p,v){return p.readFields(Wae,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},v)}(c,c.readVarint()+c.pos)):d===7?o.clip_paths.push(function(p,v){return p.readFields(Hae,{children:[]},v)}(c,c.readVarint()+c.pos)):d===8&&o.masks.push(function(p,v){const m=p.readFields(Zae,{left:0,width:20,mask_type:1,children:[]},v);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(c,c.readVarint()+c.pos))}function g2(d,o){return d.readFields(Fae,{},o)}function Fae(d,o,c){d===1?(o.group=function(p,v){return p.readFields(Bae,{opacity:255,children:[]},v)}(c,c.readVarint()+c.pos),o.node="group"):d===2&&(o.path=function(p,v){return p.readFields(Uae,{paint_order:1,commands:[],step:1,diffs:[],rule:1},v)}(c,c.readVarint()+c.pos),o.node="path")}function Bae(d,o,c){d===1?o.transform=y2(c,c.readVarint()+c.pos):d===2?o.opacity=c.readVarint():d===5?o.clip_path_idx=c.readVarint():d===6?o.mask_idx=c.readVarint():d===7&&o.children.push(g2(c,c.readVarint()+c.pos))}function y2(d,o){return d.readFields(Vae,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function Vae(d,o,c){d===1?o.sx=c.readFloat():d===2?o.ky=c.readFloat():d===3?o.kx=c.readFloat():d===4?o.sy=c.readFloat():d===5?o.tx=c.readFloat():d===6&&(o.ty=c.readFloat())}function Uae(d,o,c){d===1?o.fill=function(p,v){return p.readFields($ae,{rgb_color:dC,paint:"rgb_color",opacity:255},v)}(c,c.readVarint()+c.pos):d===2?o.stroke=function(p,v){return p.readFields(qae,{rgb_color:dC,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},v)}(c,c.readVarint()+c.pos):d===3?o.paint_order=c.readVarint():d===5?c.readPackedVarint(o.commands):d===6?o.step=c.readFloat():d===7?c.readPackedSVarint(o.diffs):d===8&&(o.rule=c.readVarint())}function $ae(d,o,c){d===1?(o.rgb_color=v2(c.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=c.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=c.readVarint(),o.paint="radial_gradient_idx"):d===5&&(o.opacity=c.readVarint())}function v2(d){return new Jn((d>>16&255)/255,(d>>8&255)/255,(255&d)/255,1)}function qae(d,o,c){d===1?(o.rgb_color=v2(c.readVarint()),o.paint="rgb_color"):d===2?(o.linear_gradient_idx=c.readVarint(),o.paint="linear_gradient_idx"):d===3?(o.radial_gradient_idx=c.readVarint(),o.paint="radial_gradient_idx"):d===5?c.readPackedFloat(o.dasharray):d===6?o.dashoffset=c.readFloat():d===7?o.miterlimit=c.readFloat():d===8?o.opacity=c.readVarint():d===9?o.width=c.readFloat():d===10?o.linecap=c.readVarint():d===11&&(o.linejoin=c.readVarint())}function Gae(d,o,c){d===1?o.transform=y2(c,c.readVarint()+c.pos):d===2?o.spread_method=c.readVarint():d===3?o.stops.push(JF(c,c.readVarint()+c.pos)):d===4?o.x1=c.readFloat():d===5?o.y1=c.readFloat():d===6?o.x2=c.readFloat():d===7&&(o.y2=c.readFloat())}function JF(d,o){return d.readFields(Kae,{offset:0,opacity:255,rgb_color:dC},o)}function Kae(d,o,c){d===1?o.offset=c.readFloat():d===2?o.opacity=c.readVarint():d===3&&(o.rgb_color=v2(c.readVarint()))}function Wae(d,o,c){d===1?o.transform=y2(c,c.readVarint()+c.pos):d===2?o.spread_method=c.readVarint():d===3?o.stops.push(JF(c,c.readVarint()+c.pos)):d===4?o.cx=c.readFloat():d===5?o.cy=c.readFloat():d===6?o.r=c.readFloat():d===7?o.fx=c.readFloat():d===8?o.fy=c.readFloat():d===9&&(o.fr=c.readFloat())}function Hae(d,o,c){d===1?o.transform=y2(c,c.readVarint()+c.pos):d===2?o.clip_path_idx=c.readVarint():d===3&&o.children.push(g2(c,c.readVarint()+c.pos))}function Zae(d,o,c){d===1?o.left=o.top=c.readFloat():d===2?o.width=o.height=c.readFloat():d===3?o.top=c.readFloat():d===4?o.height=c.readFloat():d===5?o.mask_type=c.readVarint():d===6?o.mask_idx=c.readVarint():d===7&&o.children.push(g2(c,c.readVarint()+c.pos))}class Yae{static calculate(o,c){const p=new Map,v=new Map;if(Object.keys(o).length===0)return p;c.forEach(m=>{v.set(m.name,m.rgb_color||new Jn(0,0,0))});for(const[m,x]of Object.entries(o))v.has(m)?p.set(v.get(m).toStringPremultipliedAlpha(),x):console.warn(`Ignoring unknown image variable "${m}"`);return p}}function D_(d,o=255,c){const p=o/255,v=d.toStringPremultipliedAlpha(),m=c.has(v)?c.get(v).clone():d.clone();return m.a=p,m.toString()}function bb(d,o){if(!Te()){const c=document.createElement("canvas");return c.width=d,c.height=o,c}return new OffscreenCanvas(d,o)}function Xae(d,o){const c=Yae.calculate(o.params,d.metadata?d.metadata.variables:[]),p=d.usvg_tree,v=p.width,m=p.height,x=o.transform?o.transform:new DOMMatrix,M=Math.max(1,Math.round(v*x.a)),j=Math.max(1,Math.round(m*x.d)),F=new DOMMatrix([M/v,0,0,j/m,0,0]),E=bb(M,j).getContext("2d");return fC(E,F,p,p,c),E.getImageData(0,0,M,j)}function fC(d,o,c,p,v){for(const m of p.children)QF(d,o,c,m,v)}function QF(d,o,c,p,v){p.group?(d.save(),function(m,x,M,j,F){const E=j.mask_idx!=null?M.masks[j.mask_idx]:null,N=j.clip_path_idx!=null?M.clip_paths[j.clip_path_idx]:null;if(j.transform&&(x=_2(j.transform).preMultiplySelf(x)),!function(I,$,Y){return I.opacity!==255||$||Y}(j,N!=null,E!=null))return void fC(m,x,M,j,F);const L=bb(m.canvas.width,m.canvas.height),k=L.getContext("2d");fC(k,x,M,j,F),N&&o5(k,x,M,N),E&&s5(k,x,M,E,F),m.globalAlpha=j.opacity/255,m.drawImage(L,0,0)}(d,o,c,p.group,v),d.restore()):p.path&&(d.save(),function(m,x,M,j,F){const E=l5(j);m.setTransform(x),j.paint_order===ZF.PAINT_ORDER_FILL_AND_STROKE?(e5(m,M,j,E,F),r5(m,M,j,E,F)):(r5(m,M,j,E,F),e5(m,M,j,E,F))}(d,o,c,p.path,v),d.restore())}function e5(d,o,c,p,v){const m=c.fill;if(!m)return;const x=m.opacity/255;switch(m.paint){case"rgb_color":d.fillStyle=D_(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":d.fillStyle=n5(d,o.linear_gradients[m.linear_gradient_idx],x,v);break;case"radial_gradient_idx":d.fillStyle=i5(d,o.radial_gradients[m.radial_gradient_idx],x,v)}d.fill(p,t5(c))}function t5(d){return d.rule===hC.PATH_RULE_NON_ZERO?"nonzero":d.rule===hC.PATH_RULE_EVEN_ODD?"evenodd":void 0}function r5(d,o,c,p,v){const m=c.stroke;if(!m)return;d.lineWidth=m.width,d.miterLimit=m.miterlimit,d.setLineDash(m.dasharray),d.lineDashOffset=m.dashoffset;const x=m.opacity/255;switch(m.paint){case"rgb_color":d.strokeStyle=D_(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":d.strokeStyle=n5(d,o.linear_gradients[m.linear_gradient_idx],x,v);break;case"radial_gradient_idx":d.strokeStyle=i5(d,o.radial_gradients[m.radial_gradient_idx],x,v)}switch(m.linejoin){case xb.LINE_JOIN_MITER_CLIP:case xb.LINE_JOIN_MITER:d.lineJoin="miter";break;case xb.LINE_JOIN_ROUND:d.lineJoin="round";break;case xb.LINE_JOIN_BEVEL:d.lineJoin="bevel"}switch(m.linecap){case m2.LINE_CAP_BUTT:d.lineCap="butt";break;case m2.LINE_CAP_ROUND:d.lineCap="round";break;case m2.LINE_CAP_SQUARE:d.lineCap="square"}d.stroke(p)}function n5(d,o,c,p){if(o.stops.length===1){const L=o.stops[0];return D_(L.rgb_color,L.opacity*c,p)}const v=_2(o.transform),{x1:m,y1:x,x2:M,y2:j}=o,F=v.transformPoint(new DOMPoint(m,x)),E=v.transformPoint(new DOMPoint(M,j)),N=d.createLinearGradient(F.x,F.y,E.x,E.y);for(const L of o.stops)N.addColorStop(L.offset,D_(L.rgb_color,L.opacity*c,p));return N}function i5(d,o,c,p){if(o.stops.length===1){const L=o.stops[0];return D_(L.rgb_color,L.opacity*c,p)}const v=_2(o.transform),{fx:m,fy:x,cx:M,cy:j}=o,F=v.transformPoint(new DOMPoint(m,x)),E=v.transformPoint(new DOMPoint(M,j)),N=d.createRadialGradient(F.x,F.y,0,E.x,E.y,o.r*((v.a+v.d)/2));for(const L of o.stops)N.addColorStop(L.offset,D_(L.rgb_color,L.opacity*c,p));return N}function a5(d,o,c,p){const v=p.transform?_2(p.transform).preMultiplySelf(o):o,m=bb(d.canvas.width,d.canvas.height),x=m.getContext("2d");for(const j of p.children)if(j.group)a5(x,v,c,j.group);else if(j.path){const F=j.path,E=new Path2D;E.addPath(l5(F),v),x.fill(E,t5(F))}const M=p.clip_path_idx!=null?c.clip_paths[p.clip_path_idx]:null;M&&o5(x,v,c,M),d.globalCompositeOperation="source-over",d.drawImage(m,0,0)}function o5(d,o,c,p){const v=bb(d.canvas.width,d.canvas.height);a5(v.getContext("2d"),o,c,p),d.globalCompositeOperation="destination-in",d.drawImage(v,0,0)}function s5(d,o,c,p,v){if(p.children.length===0)return;const m=p.mask_idx!=null?c.masks[p.mask_idx]:null;m&&s5(d,o,c,m,v);const x=d.canvas.width,M=d.canvas.height,j=bb(x,M),F=j.getContext("2d"),E=p.width,N=p.height,L=p.left,k=p.top,I=new Path2D,$=new Path2D;$.rect(L,k,E,N),I.addPath($,o),F.clip(I);for(const oe of p.children)QF(F,o,c,oe,v);const Y=F.getImageData(0,0,x,M),ee=Y.data;if(p.mask_type===YF.MASK_TYPE_LUMINANCE)for(let oe=0;oe<ee.length;oe+=4)ee[oe+3]=ee[oe+3]/255*(.2126*ee[oe]+.7152*ee[oe+1]+.0722*ee[oe+2]);F.putImageData(Y,0,0),d.globalCompositeOperation="destination-in",d.drawImage(j,0,0)}function _2(d){return d?new DOMMatrix([d.sx,d.ky,d.kx,d.sy,d.tx,d.ty]):new DOMMatrix}function l5(d){const o=new Path2D,c=d.step;let p=d.diffs[0]*c,v=d.diffs[1]*c;o.moveTo(p,v);for(let m=0,x=2;m<d.commands.length;m++)switch(d.commands[m]){case I_.PATH_COMMAND_MOVE:p+=d.diffs[x++]*c,v+=d.diffs[x++]*c,o.moveTo(p,v);break;case I_.PATH_COMMAND_LINE:p+=d.diffs[x++]*c,v+=d.diffs[x++]*c,o.lineTo(p,v);break;case I_.PATH_COMMAND_QUAD:{const M=p+d.diffs[x++]*c,j=v+d.diffs[x++]*c;p=M+d.diffs[x++]*c,v=j+d.diffs[x++]*c,o.quadraticCurveTo(M,j,p,v);break}case I_.PATH_COMMAND_CUBIC:{const M=p+d.diffs[x++]*c,j=v+d.diffs[x++]*c,F=M+d.diffs[x++]*c,E=j+d.diffs[x++]*c;p=F+d.diffs[x++]*c,v=E+d.diffs[x++]*c,o.bezierCurveTo(M,j,F,E,p,v);break}case I_.PATH_COMMAND_CLOSE:o.closePath()}return o}class pC{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const c=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,c),c}put(o,c){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,c)}delete(o){this.cache.delete(o)}}class mC{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new zo(o,o.data)}getFromCache(o,c,p){return this.cacheMap.has(p)||this.cacheMap.set(p,new pC(150)),this.cacheMap.get(p).get(Ss(o.serialize(),c))}setInCache(o,c,p,v){this.cacheDependenciesMap.has(v)||this.cacheDependenciesMap.set(v,new Map),this.cacheMap.has(v)||this.cacheMap.set(v,new pC(150));const m=this.cacheDependenciesMap.get(v);m.get(Ss(o.id,p))||m.set(Ss(o.id,p),new Set);const x=this.cacheMap.get(v),M=o.serialize();m.get(Ss(o.id,p)).add(M),x.put(Ss(o.serialize(),p),c)}removeImagesFromCacheByIds(o,c,p=""){if(!this.cacheMap.has(p)||!this.cacheDependenciesMap.has(p))return;const v=this.cacheMap.get(p),m=this.cacheDependenciesMap.get(p);for(const x of o)if(m.has(Ss(x,c))){for(const M of m.get(Ss(x,c)))v.delete(M);m.delete(Ss(x,c))}}rasterize(o,c,p,v,m=Xae){const x=this.getFromCache(o,p,v);if(x)return x.clone();const M=m(c.icon,o.options),j=mC._getImage(M);return this.setInCache(o,j,p,v),j.clone()}}class c5{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,c){const p=this.toIdx(o,c);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(o,c){return this.leaves[this.toIdx(o,c)]}toIdx(o,c){return c*this.size+o}}function u5(d,o,c,p){let v=0,m=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(p[x])<1e-15){if(c[x]<d[x]||c[x]>o[x])return null}else{const M=1/p[x];let j=(d[x]-c[x])*M,F=(o[x]-c[x])*M;if(j>F){const E=j;j=F,F=E}if(j>v&&(v=j),F<m&&(m=F),v>m)return null}return v}function d5(d,o,c,p,v,m,x,M,j,F,E){const N=p-d,L=v-o,k=m-c,I=x-d,$=M-o,Y=j-c,ee=E[1]*Y-E[2]*$,oe=E[2]*I-E[0]*Y,se=E[0]*$-E[1]*I,ie=N*ee+L*oe+k*se;if(Math.abs(ie)<1e-15)return null;const he=1/ie,me=F[0]-d,be=F[1]-o,Re=F[2]-c,Me=(me*ee+be*oe+Re*se)*he;if(Me<0||Me>1)return null;const Ce=be*k-Re*L,Xe=Re*N-me*k,Ie=me*L-be*N,Qe=(E[0]*Ce+E[1]*Xe+E[2]*Ie)*he;return Qe<0||Me+Qe>1?null:(I*Ce+$*Xe+Y*Ie)*he}function h5(d,o,c){return(d-o)/(c-o)}function f5(d,o,c,p,v,m,x,M,j){const F=1<<c,E=m-p,N=x-v,L=(d+1)/F*E+p,k=(o+0)/F*N+v,I=(o+1)/F*N+v;M[0]=(d+0)/F*E+p,M[1]=k,j[0]=L,j[1]=I}class p5{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const c=function(m){const x=Math.ceil(Math.log2(m.dim/8)),M=[];let j=Math.ceil(Math.pow(2,x));const F=1/j,E=(k,I,$,Y,ee)=>{const oe=Y?1:0,se=(k+1)*$-oe,ie=I*$,he=(I+1)*$-oe;ee[0]=k*$,ee[1]=ie,ee[2]=se,ee[3]=he};let N=new c5(j);const L=[];for(let k=0;k<j*j;k++){E(k%j,Math.floor(k/j),F,!1,L);const I=mg(L[0],L[1],m),$=mg(L[2],L[1],m),Y=mg(L[2],L[3],m),ee=mg(L[0],L[3],m);N.minimums.push(Math.min(I,$,Y,ee)),N.maximums.push(Math.max(I,$,Y,ee)),N.leaves.push(1)}for(M.push(N),j/=2;j>=1;j/=2){const k=M[M.length-1];N=new c5(j);for(let I=0;I<j*j;I++){E(I%j,Math.floor(I/j),2,!0,L);const $=k.getElevation(L[0],L[1]),Y=k.getElevation(L[2],L[1]),ee=k.getElevation(L[2],L[3]),oe=k.getElevation(L[0],L[3]),se=k.isLeaf(L[0],L[1]),ie=k.isLeaf(L[2],L[1]),he=k.isLeaf(L[2],L[3]),me=k.isLeaf(L[0],L[3]),be=Math.min($.min,Y.min,ee.min,oe.min),Re=Math.max($.max,Y.max,ee.max,oe.max),Me=se&&ie&&he&&me;N.maximums.push(Re),N.minimums.push(be),N.leaves.push(Re-be<=5&&Me?1:0)}M.push(N)}return M}(this.dem),p=c.length-1,v=c[p];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(c,0,0,p,0)}raycastRoot(o,c,p,v,m,x,M=1){return u5([o,c,-100],[p,v,this.maximums[0]*M],m,x)}raycast(o,c,p,v,m,x,M=1){if(!this.nodeCount)return null;const j=this.raycastRoot(o,c,p,v,m,x,M);if(j==null)return null;const F=[],E=[],N=[],L=[],k=[{idx:0,t:j,nodex:0,nodey:0,depth:0}];for(;k.length>0;){const{idx:I,t:$,nodex:Y,nodey:ee,depth:oe}=k.pop();if(this.leaves[I]){f5(Y,ee,oe,o,c,p,v,N,L);const ie=1<<oe,he=(Y+0)/ie,me=(Y+1)/ie,be=(ee+0)/ie,Re=(ee+1)/ie,Me=mg(he,be,this.dem)*M,Ce=mg(me,be,this.dem)*M,Xe=mg(me,Re,this.dem)*M,Ie=mg(he,Re,this.dem)*M,Qe=d5(N[0],N[1],Me,L[0],N[1],Ce,L[0],L[1],Xe,m,x),ot=d5(L[0],L[1],Xe,N[0],L[1],Ie,N[0],N[1],Me,m,x),nt=Math.min(Qe!==null?Qe:Number.MAX_VALUE,ot!==null?ot:Number.MAX_VALUE);if(nt!==Number.MAX_VALUE)return nt;{const lt=Be.vec3.scaleAndAdd([],m,x,$);if(m5(Me,Ce,Ie,Xe,h5(lt[0],N[0],L[0]),h5(lt[1],N[1],L[1]))>=lt[2])return $}continue}let se=0;for(let ie=0;ie<this._siblingOffset.length;ie++){f5((Y<<1)+this._siblingOffset[ie][0],(ee<<1)+this._siblingOffset[ie][1],oe+1,o,c,p,v,N,L),N[2]=-100,L[2]=this.maximums[this.childOffsets[I]+ie]*M;const he=u5(N,L,m,x);if(he!=null){const me=he;F[ie]=me;let be=!1;for(let Re=0;Re<se&&!be;Re++)me>=F[E[Re]]&&(E.splice(Re,0,ie),be=!0);be||(E[se]=ie),se++}}for(let ie=0;ie<se;ie++){const he=E[ie];k.push({idx:this.childOffsets[I]+he,t:F[he],nodex:(Y<<1)+this._siblingOffset[he][0],nodey:(ee<<1)+this._siblingOffset[he][1],depth:oe+1})}}return null}_addNode(o,c,p){return this.minimums.push(o),this.maximums.push(c),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(o,c,p,v,m){if(o[v].isLeaf(c,p)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const x=v-1,M=o[x];let j=0,F=0;for(let E=0;E<this._siblingOffset.length;E++){const N=2*c+this._siblingOffset[E][0],L=2*p+this._siblingOffset[E][1],k=M.getElevation(N,L),I=M.isLeaf(N,L),$=this._addNode(k.min,k.max,I);I&&(j|=1<<E),F||(F=$)}for(let E=0;E<this._siblingOffset.length;E++)j&1<<E||this._construct(o,2*c+this._siblingOffset[E][0],2*p+this._siblingOffset[E][1],x,F+E)}}function m5(d,o,c,p,v,m){return Dr(Dr(d,c,m),Dr(o,p,m),v)}function mg(d,o,c){const p=c.dim,v=dr(d*p-.5,0,p-1),m=dr(o*p-.5,0,p-1),x=Math.floor(v),M=Math.floor(m),j=Math.min(x+1,p-1),F=Math.min(M+1,p-1);return m5(c.get(x,M),c.get(j,M),c.get(x,F),c.get(j,F),v-x,m-M)}const Jae={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Qae(d,o,c){return(256*d*256+256*o+c)/10-1e4}function eoe(d,o,c){return 256*d+o+c/256-32768}class x2{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,c,p,v=!1){if(this.uid=o,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void rn(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const m=this.dim=c.height-2,x=new Uint32Array(c.data.buffer);if(this.pixels=new Uint8Array(c.data.buffer),this.floatView=new Float32Array(c.data.buffer),this.borderReady=v,this._modifiedForSources={},!v){for(let j=0;j<m;j++)x[this._idx(-1,j)]=x[this._idx(0,j)],x[this._idx(m,j)]=x[this._idx(m-1,j)],x[this._idx(j,-1)]=x[this._idx(j,0)],x[this._idx(j,m)]=x[this._idx(j,m-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(m,-1)]=x[this._idx(m-1,0)],x[this._idx(-1,m)]=x[this._idx(0,m-1)],x[this._idx(m,m)]=x[this._idx(m-1,m-1)]}const M=p==="terrarium"?eoe:Qae;for(let j=0;j<x.length;++j){const F=4*j;this.floatView[j]=M(this.pixels[F],this.pixels[F+1],this.pixels[F+2])}this._timestamp=Ge.now()}_buildQuadTree(){this._tree=new p5(this)}get(o,c,p=!1){p&&(o=dr(o,-1,this.dim),c=dr(c,-1,this.dim));const v=this._idx(o,c);return this.floatView[v]}set(o,c,p){const v=this._idx(o,c),m=this.floatView[v];return this.floatView[v]=p,p-m}static getUnpackVector(o){return Jae[o]}_idx(o,c){if(o<-1||o>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(o+1)}static pack(o,c){const p=[0,0,0,0],v=x2.getUnpackVector(c);let m=Math.floor((o+v[3])/v[2]);return p[2]=m%256,m=Math.floor(m/256),p[1]=m%256,m=Math.floor(m/256),p[0]=m,p}getPixels(){return new X0({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,c,p){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let v=c*this.dim,m=c*this.dim+this.dim,x=p*this.dim,M=p*this.dim+this.dim;switch(c){case-1:v=m-1;break;case 1:m=v+1}switch(p){case-1:x=M-1;break;case 1:M=x+1}const j=-c*this.dim,F=-p*this.dim;for(let E=x;E<M;E++)for(let N=v;N<m;N++){const L=4*this._idx(N,E),k=4*this._idx(N+j,E+F);this.pixels[L+0]=o.pixels[k+0],this.pixels[L+1]=o.pixels[k+1],this.pixels[L+2]=o.pixels[k+2],this.pixels[L+3]=o.pixels[k+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function toe(d,o,c){d===1?o.headerLength=c.readFixed32():d===2?o.x=c.readVarint():d===3?o.y=c.readVarint():d===4?o.z=c.readVarint():d===5&&o.layers.push(function(p,v){return p.readFields(ooe,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},v)}(c,c.readVarint()+c.pos))}function roe(d,o,c){d===1?(o.delta_filter=function(p,v){return p.readFields(noe,{blockSize:0},v)}(c,c.readVarint()+c.pos),o.filter="delta_filter"):d===2?(c.readVarint(),o.filter="zigzag_filter"):d===3?(c.readVarint(),o.filter="bitshuffle_filter"):d===4&&(c.readVarint(),o.filter="byteshuffle_filter")}function noe(d,o,c){d===1&&(o.blockSize=c.readVarint())}function ioe(d,o,c){d===1?(c.readVarint(),o.codec="gzip_data"):d===2?(c.readVarint(),o.codec="jpeg_image"):d===3?(c.readVarint(),o.codec="webp_image"):d===4&&(c.readVarint(),o.codec="png_image")}function aoe(d,o,c){let p=0,v=0;d===1?o.firstByte=c.readFixed64():d===2?o.lastByte=c.readFixed64():d===3?o.filters.push(function(m,x){return m.readFields(roe,{},x)}(c,c.readVarint()+c.pos)):d===4?o.codec=function(m,x){return m.readFields(ioe,{},x)}(c,c.readVarint()+c.pos):d===5?v=c.readFloat():d===6?p=c.readFloat():d===7?o.bands.push(c.readString()):d===8?o.offset=c.readDouble():d===9&&(o.scale=c.readDouble()),o.offset===0&&(o.offset=v),o.scale===0&&(o.scale=p)}function ooe(d,o,c){d===1?o.version=c.readVarint():d===2?o.name=c.readString():d===3?o.units=c.readString():d===4?o.tileSize=c.readVarint():d===5?o.buffer=c.readVarint():d===6?o.pixelFormat=c.readVarint():d===7&&o.dataIndex.push(function(p,v){return p.readFields(aoe,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},v)}(c,c.readVarint()+c.pos))}function soe(d,o,c){if(d===2)(function(p,v,m){p.readFields(loe,m,v)})(c,c.readVarint()+c.pos,o);else if(d===3)throw new Error("Not implemented")}function loe(d,o,c){if(d===1){let p=0;const v=c.readVarint()+c.pos;for(;c.pos<v;)o[p++]=c.readVarint()}}function coe(d,o){if(o.length!==4)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let c=o[3];for(let p=2;p>=1;p--){const v=p===1?1:0,m=p===2?1:0;for(let x=0;x<o[0];x++){const M=o[1]*x;for(let j=v;j<o[1];j++){const F=o[2]*(j+M);for(let E=m;E<o[2];E++){const N=o[3]*(E+F);for(let L=0;L<o[3];L++){const k=N+L;d[k]+=d[k-c]}}}}c*=o[p]}return d}function uoe(d){for(let o=0,c=d.length;o<c;o++)d[o]=d[o]>>>1^-(1&d[o]);return d}function doe(d,o){switch(o){case"uint32":return d;case"uint16":for(let c=0;c<d.length;c+=2){const p=d[c],v=d[c+1];d[c]=(240&p)>>4|(61440&p)>>8|(240&v)<<4|61440&v,d[c+1]=15&p|(3840&p)>>4|(15&v)<<8|(3840&v)<<4}return d;case"uint8":for(let c=0;c<d.length;c+=4){const p=d[c],v=d[c+1],m=d[c+2],x=d[c+3];d[c+0]=(192&p)>>6|(192&v)>>4|(192&m)>>2|192&x,d[c+1]=(48&p)>>4|(48&v)>>2|48&m|(48&x)<<2,d[c+2]=(12&p)>>2|12&v|(12&m)<<2|(12&x)<<4,d[c+3]=3&p|(3&v)<<2|(3&m)<<4|(3&x)<<6}return d;default:throw new Error(`Invalid pixel format, "${o}"`)}}hr(x2,"DEMData"),hr(p5,"DemMinMaxQuadTree",{omit:["dem"]});var hu=Uint8Array,wb=Uint16Array,hoe=Int32Array,g5=new hu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),y5=new hu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),foe=new hu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),v5=function(d,o){for(var c=new wb(31),p=0;p<31;++p)c[p]=o+=1<<d[p-1];var v=new hoe(c[30]);for(p=1;p<30;++p)for(var m=c[p];m<c[p+1];++m)v[m]=m-c[p]<<5|p;return{b:c,r:v}},_5=v5(g5,2),x5=_5.b,poe=_5.r;x5[28]=258,poe[258]=28;for(var moe=v5(y5,0).b,b5=new wb(32768),ao=0;ao<32768;++ao){var L_=(43690&ao)>>1|(21845&ao)<<1;b5[ao]=((65280&(L_=(61680&(L_=(52428&L_)>>2|(13107&L_)<<2))>>4|(3855&L_)<<4))>>8|(255&L_)<<8)>>1}var Sb=function(d,o,c){for(var p=d.length,v=0,m=new wb(o);v<p;++v)d[v]&&++m[d[v]-1];var x,M=new wb(o);for(v=1;v<o;++v)M[v]=M[v-1]+m[v-1]<<1;x=new wb(1<<o);var j=15-o;for(v=0;v<p;++v)if(d[v])for(var F=v<<4|d[v],E=o-d[v],N=M[d[v]-1]++<<E,L=N|(1<<E)-1;N<=L;++N)x[b5[N]>>j]=F;return x},Ab=new hu(288);for(ao=0;ao<144;++ao)Ab[ao]=8;for(ao=144;ao<256;++ao)Ab[ao]=9;for(ao=256;ao<280;++ao)Ab[ao]=7;for(ao=280;ao<288;++ao)Ab[ao]=8;var w5=new hu(32);for(ao=0;ao<32;++ao)w5[ao]=5;var goe=Sb(Ab,9),yoe=Sb(w5,5),gC=function(d){for(var o=d[0],c=1;c<d.length;++c)d[c]>o&&(o=d[c]);return o},mh=function(d,o,c){var p=o/8|0;return(d[p]|d[p+1]<<8)>>(7&o)&c},yC=function(d,o){var c=o/8|0;return(d[c]|d[c+1]<<8|d[c+2]<<16)>>(7&o)},voe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],gh=function(d,o,c){var p=new Error(o||voe[d]);if(p.code=d,Error.captureStackTrace&&Error.captureStackTrace(p,gh),!c)throw p;return p},_oe=new hu(0),xoe=typeof TextDecoder<"u"&&new TextDecoder;try{xoe.decode(_oe,{stream:!0})}catch{}const boe={gzip_data:"gzip"};class ud extends Error{constructor(o){super(o),this.name="MRTError"}}const woe={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},S5={uint32:1,uint16:2,uint8:4},Soe={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let vC;class _C{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const c=this.layers[o];if(!c)throw new ud(`Layer '${o}' not found`);return c}getHeaderLength(o){const c=new Uint8Array(o),p=new DataView(o);if(c[0]!==13)throw new ud("File is not a valid MRT.");return p.getUint32(1,!0)}parseHeader(o){const c=new Uint8Array(o),p=this.getHeaderLength(o);if(c.length<p)throw new ud(`Expected header with length >= ${p} but got buffer of length ${c.length}`);const v=function(m,x){return m.readFields(toe,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new vC(c.subarray(0,p)));if(!isNaN(this.x)&&(this.x!==v.x||this.y!==v.y||this.z!==v.z))throw new ud(`Invalid attempt to parse header ${v.z}/${v.x}/${v.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=v.x,this.y=v.y,this.z=v.z;for(const m of v.layers)this.layers[m.name]=new Aoe(m,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const c=[],p=this.getLayer(o.layerName);for(let v of o.blockIndices){const m=p.dataIndex[v],x=m.firstByte-o.firstByte,M=m.lastByte-o.firstByte;if(p._blocksInProgress.has(v))continue;const j={layerName:p.name,firstByte:x,lastByte:M,pixelFormat:p.pixelFormat,blockIndex:v,blockShape:[m.bands.length].concat(p.bandShape),buffer:p.buffer,codec:m.codec.codec,filters:m.filters.map(F=>F.filter)};p._blocksInProgress.add(v),c.push(j)}return new A5(c,()=>{c.forEach(v=>p._blocksInProgress.delete(v.blockIndex))},(v,m)=>{if(c.forEach(x=>p._blocksInProgress.delete(x.blockIndex)),v)throw v;m.forEach(x=>{this.getLayer(x.layerName).processDecodedData(x)})})}}class Aoe{constructor({version:o,name:c,units:p,tileSize:v,pixelFormat:m,buffer:x,dataIndex:M},j){if(this.version=o,this.version!==1)throw new ud(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=c,this.units=p,this.tileSize=v,this.buffer=x,this.pixelFormat=woe[m],this.dataIndex=M,this.bandShape=[v+2*x,v+2*x,S5[this.pixelFormat]],this._decodedBlocks=new pC(j?j.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return S5[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const c=o.blockIndex.toString();this._decodedBlocks.get(c)||this._decodedBlocks.put(c,o.data)}getBlockForBand(o){let c=0;switch(typeof o){case"string":for(const[p,v]of this.dataIndex.entries()){for(const[m,x]of v.bands.entries())if(x===o)return{bandIndex:c+m,blockIndex:p,blockBandIndex:m};c+=v.bands.length}break;case"number":for(const[p,v]of this.dataIndex.entries()){if(o>=c&&o<c+v.bands.length)return{bandIndex:o,blockIndex:p,blockBandIndex:o-c};c+=v.bands.length}break;default:throw new ud(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}throw new ud(`Band not found: ${JSON.stringify(o)}`)}getDataRange(o){let c=1/0,p=-1/0;const v=[],m=new Set;for(const x of o){const{blockIndex:M}=this.getBlockForBand(x);if(M<0)throw new ud(`Invalid band: ${JSON.stringify(x)}`);const j=this.dataIndex[M];v.includes(M)||v.push(M),m.add(M),c=Math.min(c,j.firstByte),p=Math.max(p,j.lastByte)}if(m.size>this.cacheSize)throw new ud(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:c,lastByte:p,blockIndices:v}}hasBand(o){const{blockIndex:c}=this.getBlockForBand(o);return c>=0}hasDataForBand(o){const{blockIndex:c}=this.getBlockForBand(o);return c>=0&&!!this._decodedBlocks.get(c.toString())}getBandView(o){const{blockIndex:c,blockBandIndex:p}=this.getBlockForBand(o),v=this._decodedBlocks.get(c.toString());if(!v)throw new ud(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[c],x=this.bandShape.reduce((F,E)=>F*E,1),M=p*x,j=v.subarray(M,M+x);return{data:j,bytes:new Uint8Array(j.buffer).subarray(j.byteOffset,j.byteOffset+j.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}_C.setPbf=function(d){vC=d};class A5{constructor(o,c,p){this.tasks=o,this._onCancel=c,this._onComplete=p,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,c){this._finalized||(this._onComplete(o,c),this._finalized=!0)}}_C.performDecoding=function(d,o){const c=new Uint8Array(d);return Promise.all(o.tasks.map(p=>{const{layerName:v,firstByte:m,lastByte:x,pixelFormat:M,blockShape:j,blockIndex:F,filters:E,codec:N}=p,L=c.subarray(m,x+1),k=new Uint32Array(j[0]*j[1]*j[2]);let I;if(N!=="gzip_data")throw new ud(`Unhandled codec: ${N}`);return I=function($,Y){if(!globalThis.DecompressionStream&&Y==="gzip_data")return Promise.resolve(((ie=function(be){be[0]==31&&be[1]==139&&be[2]==8||gh(6,"invalid gzip data");var Re=be[3],Me=10;4&Re&&(Me+=2+(be[10]|be[11]<<8));for(var Ce=(Re>>3&1)+(Re>>4&1);Ce>0;Ce-=!be[Me++]);return Me+(2&Re)}(se=$))+8>se.length&&gh(6,"invalid gzip data"),function(be,Re,Me,Ce){var Xe=be.length;if(!Xe||Re.f&&!Re.l)return Me||new hu(0);var Ie=!Me,Qe=Ie||Re.i!=2,ot=Re.i;Ie&&(Me=new hu(3*Xe));var nt,lt,dt=function(gg){var Wy=Me.length;if(gg>Wy){var Cb=new hu(Math.max(2*Wy,gg));Cb.set(Me),Me=Cb}},yt=Re.f||0,ct=Re.p||0,jt=Re.b||0,Vt=Re.l,kt=Re.d,cr=Re.m,ir=Re.n,Xt=8*Xe;do{if(!Vt){yt=mh(be,ct,1);var Ut=mh(be,ct+1,3);if(ct+=3,!Ut){var Er=be[(ln=4+((ct+7)/8|0))-4]|be[ln-3]<<8,pr=ln+Er;if(pr>Xe){ot&&gh(0);break}Qe&&dt(jt+Er),Me.set(be.subarray(ln,pr),jt),Re.b=jt+=Er,Re.p=ct=8*pr,Re.f=yt;continue}if(Ut==1)Vt=goe,kt=yoe,cr=9,ir=5;else if(Ut==2){var vr=mh(be,ct,31)+257,Qr=mh(be,ct+10,15)+4,fn=vr+mh(be,ct+5,31)+1;ct+=14;for(var gn=new hu(fn),yn=new hu(19),On=0;On<Qr;++On)yn[foe[On]]=mh(be,ct+3*On,7);ct+=3*Qr;var jn=gC(yn),Li=(1<<jn)-1,Si=Sb(yn,jn);for(On=0;On<fn;){var ln,gi=Si[mh(be,ct,Li)];if(ct+=15&gi,(ln=gi>>4)<16)gn[On++]=ln;else{var xi=0,Zi=0;for(ln==16?(Zi=3+mh(be,ct,3),ct+=2,xi=gn[On-1]):ln==17?(Zi=3+mh(be,ct,7),ct+=3):ln==18&&(Zi=11+mh(be,ct,127),ct+=7);Zi--;)gn[On++]=xi}}var La=gn.subarray(0,vr),oo=gn.subarray(vr);cr=gC(La),ir=gC(oo),Vt=Sb(La,cr),kt=Sb(oo,ir)}else gh(1);if(ct>Xt){ot&&gh(0);break}}Qe&&dt(jt+131072);for(var za=(1<<cr)-1,Ta=(1<<ir)-1,Wa=ct;;Wa=ct){var _o=(xi=Vt[yC(be,ct)&za])>>4;if((ct+=15&xi)>Xt){ot&&gh(0);break}if(xi||gh(2),_o<256)Me[jt++]=_o;else{if(_o==256){Wa=ct,Vt=null;break}var Ms=_o-254;_o>264&&(Ms=mh(be,ct,(1<<(vh=g5[On=_o-257]))-1)+x5[On],ct+=vh);var Ki=kt[yC(be,ct)&Ta],Ql=Ki>>4;if(Ki||gh(3),ct+=15&Ki,oo=moe[Ql],Ql>3){var vh=y5[Ql];oo+=yC(be,ct)&(1<<vh)-1,ct+=vh}if(ct>Xt){ot&&gh(0);break}Qe&&dt(jt+131072);var dd=jt+Ms;if(jt<oo){var hd=0-oo,Ky=Math.min(oo,dd);for(hd+jt<0&&gh(3);jt<Ky;++jt)Me[jt]=(void 0)[hd+jt]}for(;jt<dd;++jt)Me[jt]=Me[jt-oo]}}Re.l=Vt,Re.p=Wa,Re.b=jt,Re.f=yt,Vt&&(yt=1,Re.m=cr,Re.d=kt,Re.n=ir)}while(!yt);return jt!=Me.length&&Ie?(nt=Me,((lt=jt)==null||lt>nt.length)&&(lt=nt.length),new hu(nt.subarray(0,lt))):Me.subarray(0,jt)}(se.subarray(ie,-8),{i:2},new hu(((ee=se)[(oe=ee.length)-4]|ee[oe-3]<<8|ee[oe-2]<<16|ee[oe-1]<<24)>>>0))));var ee,oe,se,ie;const he=boe[Y];if(!he)throw new Error(`Unhandled codec: ${Y}`);const me=new globalThis.DecompressionStream(he);return new Response(new Blob([$]).stream().pipeThrough(me)).arrayBuffer().then(be=>new Uint8Array(be))}(L,N).then($=>(function(Y,ee){Y.readFields(soe,ee)}(new vC($),k),new Soe[M](k.buffer))),I.then($=>{for(let Y=E.length-1;Y>=0;Y--)switch(E[Y]){case"delta_filter":coe($,j);break;case"zigzag_filter":uoe($);break;case"bitshuffle_filter":doe($,M);break;default:throw new ud(`Unhandled filter "${E[Y]}"`)}return{layerName:v,blockIndex:F,data:$}}).catch($=>{throw $})}))},hr(A5,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let Tb,xC,yh,z_,bC,F_=null;function T5(){return Uo()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:xC||Ui.DRACO_URL}function P5(){if(Uo()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(z_)return z_;const d=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return z_=WebAssembly.validate(d)?Ui.MESHOPT_SIMD_URL:Ui.MESHOPT_URL,z_}const b2={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Toe={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Pb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function E5(d,o,c){const p=c.json.bufferViews.length,v=c.buffers.length;o.bufferView=p,c.json.bufferViews[p]={buffer:v,byteLength:d.byteLength},c.buffers[v]=d}const wC="KHR_draco_mesh_compression";function Poe(d,o){const c=d.extensions&&d.extensions[wC];if(!c)return;const p=new yh.Decoder,v=R5(o,c.bufferView),m=new yh.Mesh;if(!p.DecodeArrayToMesh(v,v.byteLength,m))throw new Error("Failed to decode Draco mesh");const x=o.json.accessors[d.indices],M=b2[x.componentType],j=x.count*M.BYTES_PER_ELEMENT,F=yh._malloc(j);M===Uint16Array?p.GetTrianglesUInt16Array(m,j,F):p.GetTrianglesUInt32Array(m,j,F),E5(yh.memory.buffer.slice(F,F+j),x,o),yh._free(F);for(const E of Object.keys(c.attributes)){const N=p.GetAttributeByUniqueId(m,c.attributes[E]),L=o.json.accessors[d.attributes[E]],k=Toe[L.componentType],I=L.count*Pb[L.type]*b2[L.componentType].BYTES_PER_ELEMENT,$=yh._malloc(I);p.GetAttributeDataArrayForAllPoints(m,N,yh[k],I,$),E5(yh.memory.buffer.slice($,$+I),L,o),yh._free($)}p.destroy(),m.destroy(),delete d.extensions[wC]}const w2="EXT_meshopt_compression";function Eoe(d,o){if(!d.extensions||!d.extensions[w2])return;const c=d.extensions[w2],p=new Uint8Array(o.buffers[c.buffer],c.byteOffset||0,c.byteLength||0),v=new Uint8Array(c.count*c.byteStride);bC.decodeGltfBuffer(v,c.count,c.byteStride,p,c.mode,c.filter),d.buffer=o.buffers.length,d.byteOffset=0,o.buffers[d.buffer]=v.buffer,delete d.extensions[w2]}const C5=1179937895,M5=new TextDecoder("utf8");function O5(d,o){return new URL(d,o).href}function Coe(d,o,c,p){return fetch(O5(d.uri,p)).then(v=>v.arrayBuffer()).then(v=>{o.buffers[c]=v})}function R5(d,o){const c=d.json.bufferViews[o];return new Uint8Array(d.buffers[c.buffer],c.byteOffset||0,c.byteLength)}function Moe(d,o,c,p){if(d.uri){const v=O5(d.uri,p);return fetch(v).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{o.images[c]=m})}if(d.bufferView!==void 0){const v=R5(o,d.bufferView),m=new Blob([v],{type:d.mimeType});return createImageBitmap(m).then(x=>{o.images[c]=x})}}function k5(d,o=0,c){const p={json:null,images:[],buffers:[]};if(new Uint32Array(d,o,1)[0]===C5){const E=new Uint32Array(d,o);let N=2;const L=(E[N++]>>2)-3,k=E[N++]>>2;if(N++,p.json=JSON.parse(M5.decode(E.subarray(N,N+k))),N+=k,N<L){const I=E[N++];N++;const $=o+(N<<2);p.buffers[0]=d.slice($,$+I)}}else p.json=JSON.parse(M5.decode(new Uint8Array(d,o)));const{buffers:v,images:m,meshes:x,extensionsUsed:M,bufferViews:j}=p.json;let F=Promise.resolve();if(v){const E=[];for(let N=0;N<v.length;N++){const L=v[N];L.uri?E.push(Coe(L,p,N,c)):p.buffers[N]||(p.buffers[N]=null)}F=Promise.all(E)}return F.then(()=>{const E=[],N=M&&M.includes(wC),L=M&&M.includes(w2);if(N&&E.push(function(){if(!yh)return Tb??(Tb=function(k){let I,$=null;function Y(){I=new Uint8Array($.buffer)}function ee(){throw new Error("Unexpected Draco error.")}const oe={a:{a:ee,d:function(se,ie,he){return I.copyWithin(se,ie,ie+he)},c:function(se){const ie=I.length,he=Math.max(se>>>0,Math.ceil(1.2*ie)),me=Math.ceil((he-ie)/65536);try{return $.grow(me),Y(),!0}catch{return!1}},b:ee}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(k,oe):k.then(se=>se.arrayBuffer()).then(se=>WebAssembly.instantiate(se,oe))).then(se=>{const{Rb:ie,Qb:he,P:me,T:be,X:Re,Ja:Me,La:Ce,Qa:Xe,Va:Ie,Wa:Qe,eb:ot,jb:nt,f:lt,e:dt,yb:yt,zb:ct,Ab:jt,Bb:Vt,Db:kt,Gb:cr}=se.instance.exports;$=dt;const ir=(()=>{let Xt=0,Ut=0,Er=0,pr=0;return vr=>{Er&&(ie(pr),ie(Xt),Ut+=Er,Er=Xt=0),Xt||(Ut+=128,Xt=he(Ut));const Qr=vr.length+7&-8;let fn=Xt;Qr>=Ut&&(Er=Qr,fn=pr=he(Qr));for(let gn=0;gn<vr.length;gn++)I[fn+gn]=vr[gn];return fn}})();return Y(),lt(),{memory:dt,_free:ie,_malloc:he,Mesh:class{constructor(){this.ptr=me()}destroy(){be(this.ptr)}},Decoder:class{constructor(){this.ptr=Me()}destroy(){nt(this.ptr)}DecodeArrayToMesh(Xt,Ut,Er){const pr=ir(Xt),vr=Ce(this.ptr,pr,Ut,Er.ptr);return!!Re(vr)}GetAttributeByUniqueId(Xt,Ut){return{ptr:Xe(this.ptr,Xt.ptr,Ut)}}GetTrianglesUInt16Array(Xt,Ut,Er){Ie(this.ptr,Xt.ptr,Ut,Er)}GetTrianglesUInt32Array(Xt,Ut,Er){Qe(this.ptr,Xt.ptr,Ut,Er)}GetAttributeDataArrayForAllPoints(Xt,Ut,Er,pr,vr){ot(this.ptr,Xt.ptr,Ut.ptr,Er,pr,vr)}},DT_INT8:yt(),DT_UINT8:ct(),DT_INT16:jt(),DT_UINT16:Vt(),DT_UINT32:kt(),DT_FLOAT32:cr()}})}(fetch(T5())),Tb.then(k=>{yh=k,Tb=void 0}))}()),L&&E.push(function(){if(bC)return;const k=function(I){let $;const Y=WebAssembly.instantiateStreaming(I,{}).then(se=>{$=se.instance,$.exports.__wasm_call_ctors()}),ee={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},oe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Y,supported:!0,decodeGltfBuffer(se,ie,he,me,be,Re){(function(Me,Ce,Xe,Ie,Qe,ot,nt){const lt=Me.exports.sbrk,dt=Ie+3&-4,yt=lt(dt*Qe),ct=lt(ot.length),jt=new Uint8Array(Me.exports.memory.buffer);jt.set(ot,ct);const Vt=Ce(yt,Ie,Qe,ct,ot.length);if(Vt===0&&nt&&nt(yt,dt,Qe),Xe.set(jt.subarray(yt,yt+Ie*Qe)),lt(yt-lt(0)),Vt!==0)throw new Error(`Malformed buffer data: ${Vt}`)})($,$.exports[oe[be]],se,ie,he,me,$.exports[ee[Re]])}}}(fetch(P5()));return k.ready.then(()=>{bC=k})}()),m)for(let k=0;k<m.length;k++)E.push(Moe(m[k],p,k,c));return(E.length?Promise.all(E):Promise.resolve()).then(()=>{if(N&&x)for(const{primitives:k}of x)for(const I of k)Poe(I,p);if(L&&x&&j)for(const k of j)Eoe(k,p);return p})})}function Gy(d,o){const c=d.json.bufferViews[o.bufferView],p=b2[o.componentType];return new p(d.buffers[c.buffer],(o.byteOffset||0)+(c.byteOffset||0),o.count*(c.byteStride&&c.byteStride!==Pb[o.type]*p.BYTES_PER_ELEMENT?c.byteStride/p.BYTES_PER_ELEMENT:Pb[o.type]))}function SC(d,o,c,p){const v=b2[o.componentType],m=function(E){switch(E){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(v),x=d.json.bufferViews[o.bufferView],M=x.byteStride?x.byteStride/v.BYTES_PER_ELEMENT:Pb[o.type],j=c.float32,F=j.length/c.capacity;for(let E=0,N=0;E<o.count*M;E+=M,N+=F)for(let L=0;L<F;L++)j[N+L]=p[E+L]*m;c._trim()}function Ooe(d,o,c){const p=d.indices,v=d.attributes,m={};m.indexArray=new go;const x=o.json.accessors[p],M=x.count/3;m.indexArray.reserve(M);const j=Gy(o,x);for(let L=0;L<M;L++)m.indexArray.emplaceBack(j[3*L],j[3*L+1],j[3*L+2]);m.indexArray._trim(),m.vertexArray=new qs;const F=o.json.accessors[v.POSITION];m.vertexArray.reserve(F.count);const E=Gy(o,F);for(let L=0;L<F.count;L++)m.vertexArray.emplaceBack(E[3*L],E[3*L+1],E[3*L+2]);if(m.vertexArray._trim(),m.aabb=new xr(F.min,F.max),m.centroid=function(L,k){const I=[0,0,0],$=L.length;if($>0){for(let Y=0;Y<$;Y++){const ee=3*L[Y];I[0]+=k[ee],I[1]+=k[ee+1],I[2]+=k[ee+2]}I[0]/=$,I[1]/=$,I[2]/=$}return I}(j,E),v.COLOR_0!==void 0){const L=o.json.accessors[v.COLOR_0],k=Pb[L.type],I=Gy(o,L);m.colorArray=k===3?new qs:new au,m.colorArray.resize(L.count),SC(o,L,m.colorArray,I)}if(v.NORMAL!==void 0){m.normalArray=new qs;const L=o.json.accessors[v.NORMAL];m.normalArray.resize(L.count);const k=Gy(o,L);SC(o,L,m.normalArray,k)}if(v.TEXCOORD_0!==void 0&&c.length>0){m.texcoordArray=new ih;const L=o.json.accessors[v.TEXCOORD_0];m.texcoordArray.resize(L.count);const k=Gy(o,L);SC(o,L,m.texcoordArray,k)}if(v._FEATURE_ID_RGBA4444!==void 0){const L=o.json.accessors[v._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=Gy(o,L))}v._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(Gy(o,o.json.accessors[v._FEATURE_RGBA4444]).buffer));const N=d.material;return m.material=function(L,k){const{emissiveFactor:I=[0,0,0],alphaMode:$="OPAQUE",alphaCutoff:Y=.5,normalTexture:ee,occlusionTexture:oe,emissiveTexture:se,doubleSided:ie}=L,{baseColorFactor:he=[1,1,1,1],metallicFactor:me=1,roughnessFactor:be=1,baseColorTexture:Re,metallicRoughnessTexture:Me}=L.pbrMetallicRoughness||{},Ce=oe?k[oe.index]:void 0;if(oe&&oe.extensions&&oe.extensions.KHR_texture_transform&&Ce){const Xe=oe.extensions.KHR_texture_transform;Ce.offsetScale=[Xe.offset[0],Xe.offset[1],Xe.scale[0],Xe.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Jn(...he),metallicFactor:me,roughnessFactor:be,baseColorTexture:Re?k[Re.index]:void 0,metallicRoughnessTexture:Me?k[Me.index]:void 0},doubleSided:ie,emissiveFactor:I,alphaMode:$,alphaCutoff:Y,normalTexture:ee?k[ee.index]:void 0,occlusionTexture:Ce,emissionTexture:se?k[se.index]:void 0,defined:L.defined===void 0}}(N!==void 0?o.json.materials[N]:{defined:!1},c),m}function j5(d,o,c){const{matrix:p,rotation:v,translation:m,scale:x,mesh:M,extras:j,children:F}=d,E={};if(E.matrix=p||Be.mat4.fromRotationTranslationScale([],v||[0,0,0,1],m||[0,0,0],x||[1,1,1]),M!==void 0){E.meshes=c[M];const N=E.anchor=[0,0];for(const L of E.meshes){const{min:k,max:I}=L.aabb;N[0]+=k[0]+I[0],N[1]+=k[1]+I[1]}N[0]=Math.floor(N[0]/E.meshes.length/2),N[1]=Math.floor(N[1]/E.meshes.length/2)}if(j&&(j.id&&(E.id=j.id),j.lights&&(E.lights=function(N){if(!N.length)return[];const L=function(ee){const oe=atob(ee),se=new Uint8Array(oe.length);for(let ie=0;ie<oe.length;ie++)se[ie]=oe.codePointAt(ie);return se}(N),k=[],I=L.length/24,$=new Uint16Array(L.buffer),Y=new Float32Array(L.buffer);for(let ee=0;ee<I;ee++){const oe=$[2*ee*6]/30,se=$[2*ee*6+1]/30,ie=$[2*ee*6+10]/100,he=Y[6*ee+1],me=Y[6*ee+2],be=Y[6*ee+3],Re=Y[6*ee+4],Me=be-he,Ce=Re-me,Xe=Math.hypot(Me,Ce);k.push({pos:[he+.5*Me,me+.5*Ce,se],normal:[Ce/Xe,-Me/Xe,0],width:Xe,height:oe,depth:ie,points:[he,me,be,Re]})}return k}(j.lights))),F){const N=[];for(const L of F)N.push(j5(o.json.nodes[L],o,c));E.children=N}return E}function Roe(d){if(d.vertices.length===0||d.indices.length===0)return null;const o=new kr(d.vertices,d.indices,8,256),[c,p]=[o.min.clone(),o.max.clone()];return{vertices:d.vertices,indices:d.indices,grid:o,min:c,max:p}}function koe(d){if(!d.extras||!d.extras.ground)return null;const o=d.extras.ground;if(!o||!Array.isArray(o)||o.length===0)return null;const c=o[0];if(!c||!Array.isArray(c)||c.length===0)return null;const p=[];for(const x of c){if(!Array.isArray(x)||x.length!==2)continue;const M=x[0],j=x[1];typeof M=="number"&&typeof j=="number"&&p.push(new It(M,j))}if(p.length<3)return null;p.length>1&&p[p.length-1].equals(p[0])&&p.pop();let v=0;for(let x=0;x<p.length;x++){const M=p[x],j=p[(x+1)%p.length],F=p[(x+2)%p.length];v+=(M.x-j.x)*(F.y-j.y)-(F.x-j.x)*(M.y-j.y)}v>0&&p.reverse();const m=lg(p.flatMap(x=>[x.x,x.y]),[]);return m.length===0?null:{vertices:p,indices:m}}function joe(d,o){const c=[],p=[];let v=0;const m=[];for(const x of d){v=c.length;const M=x.vertexArray.float32,j=x.indexArray.uint16;for(let F=0;F<x.vertexArray.length;F++)m[0]=M[3*F+0],m[1]=M[3*F+1],m[2]=M[3*F+2],Be.vec3.transformMat4(m,m,o),c.push(new It(m[0],m[1]));for(let F=0;F<3*x.indexArray.length;F++)p.push(j[F]+v)}if(p.length%3!=0)return null;for(let x=0;x<p.length;x+=3){const M=c[p[x+0]],j=c[p[x+1]],F=c[p[x+2]];(M.x-j.x)*(F.y-j.y)-(F.x-j.x)*(M.y-j.y)>0&&([p[x+1],p[x+2]]=[p[x+2],p[x+1]])}return{vertices:c,indices:p}}function N5(d){const o=function(j,F){const E=[],N=WebGL2RenderingContext;if(j.json.textures)for(const L of j.json.textures){const k={magFilter:N.LINEAR,minFilter:N.NEAREST,wrapS:N.REPEAT,wrapT:N.REPEAT};L.sampler!==void 0&&Object.assign(k,j.json.samplers[L.sampler]),E.push({image:F[L.source],sampler:k,uploaded:!1})}return E}(d,d.images),c=function(j,F){const E=[];for(const N of j.json.meshes){const L=[];for(const k of N.primitives)L.push(Ooe(k,j,F));E.push(L)}return E}(d,o),{scenes:p,scene:v,nodes:m}=d.json,x=p?p[v||0].nodes:m,M=[];for(const j of x)M.push(j5(m[j],d,c));return function(j,F,E){const N={},L=new Set;for(let k=0;k<j.length;k++){const I=E[F[k]];if(!I.extras)continue;const $=I.extras["mapbox:footprint:version"],Y=I.extras["mapbox:footprint:id"];($||Y)&&L.add(k),$==="1.0.0"&&Y&&(N[Y]=k)}for(let k=0;k<j.length;k++){if(L.has(k))continue;const I=j[k],$=E[F[k]];if(!$.extras)continue;let Y=null;I.id in N&&(Y=joe(j[N[I.id]].meshes,I.matrix)),Y||(Y=koe($)),Y&&(I.footprint=Roe(Y))}if(L.size>0){const k=Array.from(L.values()).sort((I,$)=>I-$);for(let I=k.length-1;I>=0;I--)j.splice(k[I],1)}}(M,x,d.json.nodes),M}function Noe(d){d.heightmap=new Float32Array(4096),d.heightmap.fill(-1);const o=d.vertexArray.float32,c=d.aabb.min[0]-1,p=d.aabb.min[1]-1,v=Uy/(d.aabb.max[0]-c+2),m=Uy/(d.aabb.max[1]-p+2);for(let x=0;x<o.length;x+=3){const M=o[x+2],j=(o[x+0]-c)*v|0,F=(o[x+1]-p)*m|0;M>d.heightmap[F*Uy+j]&&(d.heightmap[F*Uy+j]=M)}}function Ioe(d,o){const c={};c.indexArray=new go,c.indexArray.reserve(4*d.length),c.vertexArray=new qs,c.vertexArray.reserve(10*d.length),c.colorArray=new au,c.vertexArray.reserve(10*d.length);let p=0;for(const x of d){const M=Math.min(10,Math.max(4,1.3*x.height))*o,j=[-x.normal[1],x.normal[0],0],F=Math.min(.29,.1*x.width/x.depth),E=x.width-2*x.depth*o*(F+.01),N=Be.vec3.scaleAndAdd([],x.pos,j,E/2),L=Be.vec3.scaleAndAdd([],x.pos,j,-E/2),k=[N[0],N[1],N[2]+x.height],I=[L[0],L[1],L[2]+x.height],$=Be.vec3.scaleAndAdd([],x.normal,j,F);Be.vec3.scale($,$,M);const Y=Be.vec3.scaleAndAdd([],x.normal,j,-F);Be.vec3.scale(Y,Y,M),Be.vec3.add($,N,$),Be.vec3.add(Y,L,Y),N[2]+=.1,L[2]+=.1,c.vertexArray.emplaceBack($[0],$[1],$[2]),c.vertexArray.emplaceBack(Y[0],Y[1],Y[2]),c.vertexArray.emplaceBack(N[0],N[1],N[2]),c.vertexArray.emplaceBack(L[0],L[1],L[2]),c.vertexArray.emplaceBack(k[0],k[1],k[2]),c.vertexArray.emplaceBack(I[0],I[1],I[2]),c.vertexArray.emplaceBack(N[0],N[1],N[2]),c.vertexArray.emplaceBack(L[0],L[1],L[2]),c.vertexArray.emplaceBack($[0],$[1],$[2]),c.vertexArray.emplaceBack(Y[0],Y[1],Y[2]);const ee=E/M/2;c.colorArray.emplaceBack(-ee-F,-1,ee,.8),c.colorArray.emplaceBack(ee+F,-1,ee,.8),c.colorArray.emplaceBack(-ee,0,ee,1.3),c.colorArray.emplaceBack(ee,0,ee,1.3),c.colorArray.emplaceBack(ee+F,-.8,ee,.7),c.colorArray.emplaceBack(ee+F,-.8,ee,.7),c.colorArray.emplaceBack(0,0,ee,1.3),c.colorArray.emplaceBack(0,0,ee,1.3),c.colorArray.emplaceBack(ee+F,-1.2,ee,.8),c.colorArray.emplaceBack(ee+F,-1.2,ee,.8),c.indexArray.emplaceBack(6+p,4+p,8+p),c.indexArray.emplaceBack(7+p,9+p,5+p),c.indexArray.emplaceBack(0+p,1+p,2+p),c.indexArray.emplaceBack(1+p,3+p,2+p),p+=10}const v={defined:!0,emissiveFactor:[0,0,0]},m={};return m.baseColorFactor=Jn.white,v.pbrMetallicRoughness=m,c.material=v,c.aabb=new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),c}class I5{constructor(o){this._stringToNumber={},this._numberToString=[];for(let c=0;c<o.length;c++){const p=o[c];this._stringToNumber[p]=c,this._numberToString[c]=p}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const Doe=["id","tile","layer","source","sourceLayer","state"];class B_{constructor(o,c,p,v,m){this.type="Feature",this._vectorTileFeature=o,this._z=c,this._x=p,this._y=v,this.properties=o.properties,this.id=m}clone(){const o=new B_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state=Object.assign({},this.state)),this.layer&&(o.layer=Object.assign({},this.layer)),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const c of Doe)this[c]!==void 0&&(o[c]=this[c]);return o}}class D5{constructor(o,c){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new bc(ar,16,0),this.featureIndexArray=new Np,this.promoteId=c,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,c,p,v,m,x=0,M=0){const j=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,m,x);const F=this.grid;for(let E=0;E<c.length;E++){const N=c[E],L=[1/0,1/0,-1/0,-1/0];for(let k=0;k<N.length;k++){const I=N[k];L[0]=Math.min(L[0],I.x),L[1]=Math.min(L[1],I.y),L[2]=Math.max(L[2],I.x),L[3]=Math.max(L[3],I.y)}M!==0&&(L[0]-=M,L[1]-=M,L[2]+=M,L[3]+=M),L[0]<ar&&L[1]<ar&&L[2]>=0&&L[3]>=0&&F.insert(j,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new P_.VectorTile(new GS(this.rawTileData)).layers,this.sourceLayerCoder=new I5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,c){const{tilespaceGeometry:p,transform:v,tileTransform:m,pixelPosMatrix:x,availableImages:M}=c;this.loadVTLayers(),this.serializedLayersCache.clear();const j=p.bufferedTilespaceBounds,F=this.grid.query(j.min.x,j.min.y,j.max.x,j.max.y,(k,I,$,Y)=>Ke(p.bufferedTilespaceGeometry,k,I,$,Y));F.sort(Loe);let E=null;v.elevation&&F.length>0&&(E=j_.create(v.elevation,this.tileID));const N={};let L;for(let k=0;k<F.length;k++){const I=F[k];if(I===L)continue;L=I;const $=this.featureIndexArray.get(I);let Y=null;this.is3DTile?this.loadMatchingModelFeature(N,$,o,p,v):this.loadMatchingFeature(N,$,o,M,(ee,oe,se,ie=0)=>(Y||(Y=Z(ee,this.tileID.canonical,m)),oe.queryIntersectsFeature(p,ee,se,Y,this.z,v,x,E,ie)))}return N}loadMatchingFeature(o,c,p,v,m){const{featureIndex:x,bucketIndex:M,sourceLayerIndex:j,layoutVertexArrayOffset:F}=c,E=this.bucketLayerIDs[M],N=p.layers,L=Object.keys(N);if(L.length&&!function(ee,oe){for(let se=0;se<ee.length;se++)if(oe.indexOf(ee[se])>=0)return!0;return!1}(L,E))return;const k=p.sourceCache,I=this.sourceLayerCoder.decode(j),$=this.vtLayers[I].feature(x),Y=this.getId($,I);for(let ee=0;ee<E.length;ee++){const oe=E[ee];if(!N[oe])continue;const{styleLayer:se,targets:ie}=N[oe];let he={};Y!==void 0&&(he=k.getFeatureState(se.sourceLayer,Y));const me=!m||m($,se,he,F);if(!me)continue;const be=new B_($,this.z,this.x,this.y,Y);be.tile=this.tileID.canonical,be.state=he;let Re=this.serializedLayersCache.get(oe);Re||(Re=se.serialize(),Re.id=oe,this.serializedLayersCache.set(oe,Re)),be.source=Re.source,be.sourceLayer=Re["source-layer"],be.layer=Vi({},Re),be.layer.paint=L5(Re.paint,se.paint,$,he,v),be.layer.layout=L5(Re.layout,se.layout,$,he,v);let Me=!1;for(const Ce of ie){this.updateFeatureProperties(be,Ce);const{filter:Xe}=Ce;if(Xe){if($.properties=be.properties,Xe.needGeometry){const Ie=te($,!0);if(!Xe.filter(new vi(this.tileID.overscaledZ),Ie,this.tileID.canonical))continue}else if(!Xe.filter(new vi(this.tileID.overscaledZ),$))continue}Me=!0,Ce.targetId&&this.addFeatureVariant(be,Ce)}Me&&this.appendToResult(o,oe,x,be,me)}}loadMatchingModelFeature(o,c,p,v,m){const x=this.bucketLayerIDs[0][0],M=p.layers;if(!M[x])return;const{styleLayer:j,targets:F}=M[x];if(j.type!=="model")return;const E=v.tile,N=c.featureIndex,L=E.getBucket(j);if(!(L&&L instanceof f2))return;const k=function(Re,Me,Ce,Xe){const Ie=Re.getNodesInfo()[Me];if(Ie.hiddenByReplacement||!Ie.node.meshes)return;let Qe=Number.MAX_VALUE;const ot=Ie.node,nt=Ce.tile,lt=Xe.calculatePosMatrix(nt.tileID.toUnwrapped(),Xe.worldSize),dt=Ie.evaluatedScale;let yt=0;Xe.elevation&&ot.elevation&&(yt=ot.elevation*Xe.elevation.exaggeration()),Be.mat4.translate(lt,lt,[(ot.anchor?ot.anchor[0]:0)*(dt[0]-1),(ot.anchor?ot.anchor[1]:0)*(dt[1]-1),yt]),Be.mat4.scale(lt,lt,dt);const ct=Ce.queryGeometry,jt=ct.isPointQuery()?ct.screenBounds:ct.screenGeometry,Vt=function(cr){const ir=Be.mat4.multiply([],lt,cr.matrix);Be.mat4.multiply(ir,Xe.expandedFarZProjMatrix,ir);for(let Xt=0;Xt<cr.meshes.length;++Xt){const Ut=cr.meshes[Xt];if(Xt===cr.lightMeshIndex)continue;const Er=IF(jt,Xe,ir,Ut.aabb);Er!=null&&(Qe=Math.min(Er,Qe))}if(cr.children)for(const Xt of cr.children)Vt(Xt)};if(Vt(ot),Qe===Number.MAX_VALUE)return;const kt=new Zn(0,0);return WF(nt.tileID.canonical,kt,Ie.node.anchor[0],Ie.node.anchor[1]),{intersectionZ:Qe,position:kt,feature:Ie.feature}}(L,N,v,m);if(!k)return;const{z:I,x:$,y:Y}=E.tileID.canonical,{feature:ee,intersectionZ:oe,position:se}=k;let ie={};ee.id!==void 0&&(ie=p.sourceCache.getFeatureState(j.sourceLayer,ee.id));const he=new B_({},I,$,Y,ee.id);he.tile=this.tileID.canonical,he.state=ie,he.properties=ee.properties,he.geometry={type:"Point",coordinates:[se.lng,se.lat]};let me=this.serializedLayersCache.get(x);me||(me=j.serialize(),me.id=x,this.serializedLayersCache.set(x,me)),he.source=me.source,he.sourceLayer=me["source-layer"],he.layer=Vi({},me);let be=!1;for(const Re of F){this.updateFeatureProperties(he,Re);const{filter:Me}=Re;if(Me){if(ee.properties=he.properties,Me.needGeometry){if(!Me.filter(new vi(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!Me.filter(new vi(this.tileID.overscaledZ),ee))continue}be=!0,Re.targetId&&this.addFeatureVariant(he,Re)}be&&this.appendToResult(o,x,N,he,oe)}updateFeatureProperties(o,c,p){if(c.properties){const v={};for(const m in c.properties){const x=c.properties[m].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,p);x!=null&&(v[m]=x)}o.properties=v}}addFeatureVariant(o,c,p){const v={target:c.target,namespace:c.namespace,uniqueFeatureID:c.uniqueFeatureID};c.properties&&(v.properties=o.properties),o.variants=o.variants||{},o.variants[c.targetId]=o.variants[c.targetId]||[],o.variants[c.targetId].push(v)}appendToResult(o,c,p,v,m){let x=o[c];x===void 0&&(x=o[c]=[]),x.push({featureIndex:p,feature:v,intersectionZ:m})}lookupSymbolFeatures(o,c,p,v,m){const x={};this.loadVTLayers();for(const M of o)this.loadMatchingFeature(x,{bucketIndex:c,sourceLayerIndex:p,featureIndex:M,layoutVertexArrayOffset:0},v,m);return x}loadFeature(o){const{featureIndex:c,sourceLayerIndex:p}=o;this.loadVTLayers();const v=this.sourceLayerCoder.decode(p),m=this.vtFeatures[v];if(m[c])return m[c];const x=this.vtLayers[v].feature(c);return m[c]=x,x}hasLayer(o){for(const c of this.bucketLayerIDs)for(const p of c)if(o===p)return!0;return!1}getId(o,c){let p=o.id;if(this.promoteId){const v=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[c];if(v!=null)if(Array.isArray(v)){if(!this.promoteIdExpression){const m=Us(v);if(m.result!=="success"){const x=m.value.map(M=>`${M.key}: ${M.message}`).join(", ");return void rn(`Failed to create expression for promoteId: ${x}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new ly),p=this.promoteIdExpression.evaluate({zoom:0},o)}else p=o.properties[v];typeof p=="boolean"&&(p=Number(p))}return p}}function L5(d,o,c,p,v){return $l(d,(m,x)=>{const M=o instanceof ed?o.get(x):null;return M&&M.evaluate?M.evaluate(c,p,v):M})}function Loe(d,o){return o-d}hr(D5,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const z5=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class AC{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,p]=new Uint8Array(o,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const m=z5[15&p];if(!m)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(o,2,1),[M]=new Uint32Array(o,4,1);return new AC(M,x,m,o)}constructor(o,c=64,p=Float64Array,v){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=p,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const m=z5.indexOf(this.ArrayType),x=2*o*this.ArrayType.BYTES_PER_ELEMENT,M=o*this.IndexArrayType.BYTES_PER_ELEMENT,j=(8-M%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+M+j,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+x+M+j),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+M+j,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=o)}add(o,c){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=o,this.coords[this._pos++]=c,p}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return TC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,c,p,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:x,nodeSize:M}=this,j=[0,m.length-1,0],F=[];for(;j.length;){const E=j.pop()||0,N=j.pop()||0,L=j.pop()||0;if(N-L<=M){for(let Y=L;Y<=N;Y++){const ee=x[2*Y],oe=x[2*Y+1];ee>=o&&ee<=p&&oe>=c&&oe<=v&&F.push(m[Y])}continue}const k=L+N>>1,I=x[2*k],$=x[2*k+1];I>=o&&I<=p&&$>=c&&$<=v&&F.push(m[k]),(E===0?o<=I:c<=$)&&(j.push(L),j.push(k-1),j.push(1-E)),(E===0?p>=I:v>=$)&&(j.push(k+1),j.push(N),j.push(1-E))}return F}within(o,c,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:m,nodeSize:x}=this,M=[0,v.length-1,0],j=[],F=p*p;for(;M.length;){const E=M.pop()||0,N=M.pop()||0,L=M.pop()||0;if(N-L<=x){for(let Y=L;Y<=N;Y++)B5(m[2*Y],m[2*Y+1],o,c)<=F&&j.push(v[Y]);continue}const k=L+N>>1,I=m[2*k],$=m[2*k+1];B5(I,$,o,c)<=F&&j.push(v[k]),(E===0?o-p<=I:c-p<=$)&&(M.push(L),M.push(k-1),M.push(1-E)),(E===0?o+p>=I:c+p>=$)&&(M.push(k+1),M.push(N),M.push(1-E))}return j}}function TC(d,o,c,p,v,m){if(v-p<=c)return;const x=p+v>>1;F5(d,o,x,p,v,m),TC(d,o,c,p,x-1,1-m),TC(d,o,c,x+1,v,1-m)}function F5(d,o,c,p,v,m){for(;v>p;){if(v-p>600){const F=v-p+1,E=c-p+1,N=Math.log(F),L=.5*Math.exp(2*N/3),k=.5*Math.sqrt(N*L*(F-L)/F)*(E-F/2<0?-1:1);F5(d,o,c,Math.max(p,Math.floor(c-E*L/F+k)),Math.min(v,Math.floor(c+(F-E)*L/F+k)),m)}const x=o[2*c+m];let M=p,j=v;for(Eb(d,o,p,c),o[2*v+m]>x&&Eb(d,o,p,v);M<j;){for(Eb(d,o,M,j),M++,j--;o[2*M+m]<x;)M++;for(;o[2*j+m]>x;)j--}o[2*p+m]===x?Eb(d,o,p,j):(j++,Eb(d,o,j,v)),j<=c&&(p=j+1),c<=j&&(v=j-1)}}function Eb(d,o,c,p){PC(d,c,p),PC(o,2*c,2*p),PC(o,2*c+1,2*p+1)}function PC(d,o,c){const p=d[o];d[o]=d[c],d[c]=p}function B5(d,o,c,p){const v=d-c,m=o-p;return v*v+m*m}i.$=Ep,i.A=To,i.B=2,i.C=cb,i.D=N_,i.E=qc,i.F=Jz,i.G=class extends d2{},i.H=vs,i.I=mC,i.J=Du,i.K=Sc,i.L=Cl,i.M=El,i.N=Ji,i.O=Kd,i.P=It,i.Q=Zl,i.R=Pn,i.S=by,i.T=tC,i.U=Us,i.V=d2,i.W=_c,i.X=$u,i.Y=Jc,i.Z=_s,i._=Ls,i.a=function(d){return Ui.API_CDN_URL_REGEX.test(d)},i.a$=B_,i.a0=Do,i.a1=ga,i.a2=function(d){const o=d.value;let c=[];if(!o)return c;const p=vs(o);return p!=="string"?(c=c.concat([new d2(d.key,o,`string expected, "${p}" found`)]),c):(LF(o,!0)||(c=c.concat([new d2(d.key,o,`invalid url "${o}"`)])),c)},i.a3=vt,i.a4=Jd,i.a5=$i,i.a6=Yt,i.a7=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return qa(d.expression.evaluate(o))}interpolate(d,o,c){return{x:Dr(d.x,o.x,c),y:Dr(d.y,o.y,c),z:Dr(d.z,o.z,c),azimuthal:Dr(d.azimuthal,o.azimuthal,c),polar:Dr(d.polar,o.polar,c)}}},i.a8=vi,i.a9=Hd,i.aA=Hs,i.aB=class{constructor(d){this.entries={},this.scheduler=d}request(d,o,c,p){const v=this.entries[d]=this.entries[d]||{callbacks:[]};if(v.result){const[m,x]=v.result;return this.scheduler?this.scheduler.add(()=>{p(m,x)},o):p(m,x),()=>{}}return v.callbacks.push(p),v.cancel||(v.cancel=c((m,x)=>{v.result=[m,x];for(const M of v.callbacks)this.scheduler?this.scheduler.add(()=>{M(m,x)},o):M(m,x);setTimeout(()=>delete this.entries[d],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(m=>m!==p),v.callbacks.length||(v.cancel(),delete this.entries[d]))}}},i.aC=Ss,i.aD=function(d,o,c){const p=JSON.stringify(d.request);return d.data&&(this.deduped.entries[p]={result:[null,d.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:d.isSymbolTile,zoom:d.tileZoom},v=>{const m=to(d.request,(x,M,j,F)=>{x?v(x):M&&v(null,{vectorTile:c?void 0:new P_.VectorTile(new GS(M)),rawData:M,cacheControl:j,expires:F})});return()=>{m.cancel(),v()}},o)},i.aE=function(d){Sr++,Sr>bt&&(d.getActor().send("enforceCacheSizeLimit",st),Sr=0)},i.aF=function(d){return d<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))},i.aG=qt,i.aH=AF,i.aI=OF,i.aJ=SF,i.aK=function(d,o){const c=document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let p=0;p<d.length;p++){const v=document.createElement("source");as(d[p])||(c.crossOrigin="Anonymous"),v.src=d[p],c.appendChild(v)}return{cancel:()=>{}}},i.aL=o2,i.aM=function(d){return fetch(d).then(o=>o.arrayBuffer()).then(o=>k5(o,0,d))},i.aN=N5,i.aO=class{constructor(d,o,c,p){this.id=d,this.position=o!=null?new Zn(o[0],o[1]):new Zn(0,0),this.orientation=c??[0,0,0],this.nodes=p,this.uploaded=!1,this.aabb=new xr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(d,o){if(Be.mat4.multiply(d.matrix,o,d.matrix),d.meshes)for(const c of d.meshes){const p=xr.applyTransformFast(c.aabb,d.matrix);this.aabb.encapsulate(p)}if(d.children)for(const c of d.children)this._applyTransformations(c,d.matrix)}computeBoundsAndApplyParent(){const d=Be.mat4.identity([]);for(const o of this.nodes)this._applyTransformations(o,d)}computeModelMatrix(d,o,c,p,v,m,x=!1){UF(this.matrix,this,d.transform,this.position,o,c,p,v,m,x)}upload(d){if(!this.uploaded){for(const o of this.nodes)oC(o,d);for(const o of this.nodes)h2(o);this.uploaded=!0}}destroy(){for(const d of this.nodes)sC(d)}},i.aP=ys,i.aQ=db,i.aR=Zs,i.aS=zr,i.aT=ua,i.aU=go,i.aV=$a,i.aW=Qm,i.aX=i2,i.aY=function(){$s.isLoading()||$s.isLoaded()||Xd()!=="deferred"||df()},i.aZ=Ty,i.a_=te,i.aa=u,i.ab=Be,i.ac=An,i.ad=ed,i.ae=Ps,i.af=Dr,i.ag=ar,i.ah=Gc,i.ai=rt,i.aj=Jn,i.ak=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return function([c,p]){const v=qa([1,c,p]);return{x:v.x,y:v.y,z:v.z}}(d.expression.evaluate(o))}interpolate(d,o,c){return{x:Dr(d.x,o.x,c),y:Dr(d.y,o.y,c),z:Dr(d.z,o.z,c)}}},i.al=function(d,o,c=0,p=!0){const v=new It(c,c),m=d.sub(v),x=o.add(v),M=[m,new It(x.x,m.y),x,new It(m.x,x.y)];return p&&M.push(m.clone()),M},i.am=function(d,o){const c=[];for(let p=0;p<d.length;p++){const v=Ti(p-1,-1,d.length-1),m=Ti(p+1,-1,d.length-1),x=d[p],M=d[m],j=d[v].sub(x).unit(),F=M.sub(x).unit(),E=F.angleWithSep(j.x,j.y),N=j.add(F).unit().mult(-1*o/Math.sin(E/2));c.push(x.add(N))}return c},i.an=cF,i.ao=Ke,i.ap=function(d,o,c=0){return Be.vec3.fromValues(((o.x-c)*d.scale-d.x)*ar,(o.y*d.scale-d.y)*ar,ch(o.z,o.y))},i.aq=Wr,i.ar=Cz,i.as=function(d){let o=1/0,c=1/0,p=-1/0,v=-1/0;for(const m of d)o=Math.min(o,m.x),c=Math.min(c,m.y),p=Math.max(p,m.x),v=Math.max(v,m.y);return{min:new It(o,c),max:new It(p,v)}},i.at=Cc,i.au=Ve,i.av=S,i.aw=dr,i.ax=Ho,i.ay=function(d,o){const c={};for(let p=0;p<o.length;p++){const v=o[p];v in d&&(c[v]=d[v])}return c},i.az=uu,i.b=function(d){return Ui.API_FONTS_REGEX.test(d)},i.b$=c2,i.b0=Kn,i.b1=NE,i.b2=cn,i.b3=Z,i.b4=As,i.b5=gf,i.b6=jr,i.b7=va,i.b8=lg,i.b9=JE,i.bA=oz,i.bB=KE,i.bC=aF,i.bD=$E,i.bE=AC,i.bF=Ti,i.bG=Ca,i.bH=qi,i.bI=function(d,o,c){d[4*o+0]=c[0],d[4*o+1]=c[1],d[4*o+2]=c[2],d[4*o+3]=c[3]},i.bJ=wf,i.bK=Gs,i.bL=xf,i.bM=da,i.bN=Pc,i.bO=Zn,i.bP=pF,i.bQ=Nt,i.bR=_n,i.bS=kF,i.bT=zt,i.bU=Mo,i.bV=function(d,o,c,p,v,m,x,M,j){if(j.name==="globe")return Mo(d,o,new zt(c,p,v),!1);const F=db({z:c,x:p,y:v},j);return new xr([(m+F.x/F.scale)*o,o*(F.y/F.scale),x],[(m+F.x2/F.scale)*o,o*(F.y2/F.scale),M])},i.bW=function(d,o,c){let p=0;for(let v=0;v<2;++v)d[v]>0&&(p+=(d[v]-0)*(d[v]-0)),o[v]<0&&(p+=(0-o[v])*(0-o[v]));return p},i.bX=Zo,i.bY=Lp,i.bZ=function(d){const o=Be.mat4.identity(new Float64Array(16));Be.mat4.multiply(o,d.pixelMatrix,d.globeMatrix);const c=[0,Ks,0],p=[0,cs,0];return Be.vec3.transformMat4(c,c,o),Be.vec3.transformMat4(p,p,o),[c[0]>0&&c[0]<=d.width&&c[1]>0&&c[1]<=d.height&&!gl(d,new Zn(d.center.lat,90)),p[0]>0&&p[0]<=d.width&&p[1]>0&&p[1]<=d.height&&!gl(d,new Zn(d.center.lat,-90))]},i.b_=function(d,o){const{scale:c}=d.tileTransform,p=c*ar/(d.tileSize*Math.pow(2,o.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return Be.mat2.scale(new Float32Array(4),o.inverseAdjustmentMatrix,[p,p])},i.ba=function(d,o){const c=Ps(o.zoom);if(c===0)return ja(d);const p=ki(d),v=Pi(p),m=Cc(p.getWest())*o.worldSize,x=Cc(p.getEast())*o.worldSize,M=Hs(p.getNorth())*o.worldSize,j=Hs(p.getSouth())*o.worldSize,F=[m,M,0],E=[x,M,0],N=[m,j,0],L=[x,j,0],k=Be.mat4.invert([],o.globeMatrix);return Be.vec3.transformMat4(F,F,k),Be.vec3.transformMat4(E,E,k),Be.vec3.transformMat4(N,N,k),Be.vec3.transformMat4(L,L,k),v[0]=Aa(v[0],N,c),v[1]=Aa(v[1],L,c),v[2]=Aa(v[2],E,c),v[3]=Aa(v[3],F,c),xr.fromPoints(v)},i.bb=io,i.bc=_i,i.bd=Aa,i.be=ia,i.bf=Or,i.bg=_C,i.bh=GS,i.bi=to,i.bj=function(d){const o=[];for(const c in d)o.push(d[c]);return o},i.bk=function(d,o){const c=[];for(const p in d)p in o||c.push(p);return c},i.bl=Bi,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=Vn,i.bo=function(d,o){const{x:c,y:p}=d.point,v=yo(c,p,d.worldSize/d._pixelsPerMercatorPixel,0,0);return Be.mat4.multiply(v,v,Ei(ja(o)))},i.bp=E_,i.bq=du,i.br=qS,i.bs=function(d,o,c,p,v){const m=5*o+2;d.float32[m+0]=c,d.float32[m+1]=p,d.float32[m+2]=v},i.bt=n2,i.bu=Xz,i.bv=fe,i.bw=Cs,i.bx=ez,i.by=DF,i.bz=az,i.c=uo,i.c$=(d,o,c,p,v,m,x,M)=>{const j=d.transform,F=j.pitch<15?Mz(.07,.7,dr((14-j.zoom)/5,0,1)):.07,E=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Rz(d,o,c,p),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:j.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:v,u_width_scale:m,u_floor_width_scale:x,u_image:0,u_tile_units_to_pixels:Oz(o,j),u_units_to_pixels:[1/j.pixelsToGLUnits[0],1/j.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:M,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(E?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:F,u_tile_to_meter:s(o.tileID.canonical,0)}},i.c0=RF,i.c1=function(d){const o=RF(d,!0);return Be.mat2.invert([],[o[0],o[1],o[4],o[5]])},i.c2=Mn,i.c3=function(d){const{x:o,y:c}=d.point,{lng:p,lat:v}=d._center;return yo(o,c,d.worldSize,p,v)},i.c4=Ot,i.c5=er,i.c6=sd,i.c7=function(d){const o=Math.round((d+45+360)%360/90)%4;return Kt[o]},i.c8=45,i.c9=ig,i.cA=class extends kl{constructor(d){super(d),this.current=rg}set(d,o,c){if(this.fetchUniformLocation(d,o)){for(let p=0;p<9;p++)if(c[p]!==this.current[p]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}},i.cB=Pr,i.cC=function(d,o,c){const p=Ps(c.zoom),v=d.style.map._antialias,m=d.terrain&&d.terrain.exaggeration()>0;return p===0&&!v&&!m},i.cD=function(d){const o=d.pixelsPerMeter,c=o/qi(1,d.center.lat),p=Be.mat4.identity(new Float64Array(16));return Be.mat4.translate(p,p,[d.point.x,d.point.y,0]),Be.mat4.scale(p,p,[c,c,o]),Float32Array.from(p)},i.cE=ki,i.cF=function(d){const o=Zo-5;d=dr(d,-80.051129,o)/o*90;const c=Math.pow(Math.abs(Math.sin(rt(d))),3);return Math.round(c*(Af.length-1))},i.cG=function(d,o,c,p){const v=o.getNorth(),m=o.getSouth(),x=o.getWest(),M=o.getEast(),j=1<<d.z,F=M-x,E=v-m,N=F/sh,L=-E/Af[c],k=[0,N,0,L,0,0,v,x,0];if(d.z>0){const I=180/p;Be.mat3.multiply(k,k,[I/F+1,0,0,0,I/E+1,0,-.5*I/N,.5*I/L,1])}return k[2]=j,k[5]=d.x,k[8]=d.y,k},i.cH=ja,i.cI=function(d,o,c){const p=Be.mat4.identity(new Float64Array(16)),v=(o/(1<<d)-.5)*Math.PI*2;return Be.mat4.rotateY(p,c.globeMatrix,v),Float32Array.from(p)},i.cJ=class{isDataAvailableAtPoint(d){const o=this._source();if(this.isUsingMockSource()||!o||d.y<0||d.y>1)return!1;const c=o.getSource().maxzoom,p=1<<c,v=Math.floor(d.x),m=Math.floor((d.x-v)*p),x=Math.floor(d.y*p),M=this.findDEMTileFor(new qt(c,v,c,m,x));return!(!M||!M.dem)}getAtPointOrZero(d,o=0){return this.getAtPoint(d,o)||0}getAtPoint(d,o,c=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const p=this._source();if(!p||d.y<0||d.y>1)return o;const v=p.getSource().maxzoom,m=1<<v,x=Math.floor(d.x),M=d.x-x,j=new qt(v,x,v,Math.floor(M*m),Math.floor(d.y*m)),F=this.findDEMTileFor(j);if(!F||!F.dem)return o;const E=F.dem,N=1<<F.tileID.canonical.z,L=(M*N-F.tileID.canonical.x)*E.dim,k=(d.y*N-F.tileID.canonical.y)*E.dim,I=Math.floor(L),$=Math.floor(k);return(c?this.exaggeration():1)*Dr(Dr(E.get(I,$),E.get(I,$+1),k-$),Dr(E.get(I+1,$),E.get(I+1,$+1),k-$),L-I)}getAtTileOffset(d,o,c){const p=1<<d.canonical.z;return this.getAtPointOrZero(new u(d.wrap+(d.canonical.x+o/ar)/p,(d.canonical.y+c/ar)/p))}getAtTileOffsetFunc(d,o,c,p){return v=>{const m=this.getAtTileOffset(d,v.x,v.y),x=p.upVector(d.canonical,v.x,v.y),M=p.upVectorScale(d.canonical,o,c).metersToTile;return Be.vec3.scale(x,x,m*M),x}}getForTilePoints(d,o,c,p){if(this.isUsingMockSource())return!1;const v=j_.create(this,d,p);return!!v&&(o.forEach(m=>{m[2]=this.exaggeration()*v.getElevationAt(m[0],m[1],c)}),!0)}getMinMaxForTile(d){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(d);if(!o||!o.dem)return null;const c=o.dem.tree,p=o.tileID,v=1<<d.canonical.z-p.canonical.z;let m=d.canonical.x/v-p.canonical.x,x=d.canonical.y/v-p.canonical.y,M=0;for(let j=0;j<d.canonical.z-p.canonical.z&&!c.leaves[M];j++){m*=2,x*=2;const F=2*Math.floor(x)+Math.floor(m);M=c.childOffsets[M]+F,m%=1,x%=1}return{min:this.exaggeration()*c.minimums[M],max:this.exaggeration()*c.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(d,o,c){throw new Error("Pure virtual method called.")}pointCoordinate(d){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(d){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const d=this.visibleDemTiles;if(d.length===0)return null;let o=!1,c=Number.MAX_VALUE,p=Number.MIN_VALUE;for(const v of d){const m=this.getMinMaxForTile(v.tileID);m&&(c=Math.min(c,m.min),p=Math.max(p,m.max),o=!0)}return o?{min:c,max:p}:null}},i.cK=X0,i.cL=En,i.cM=function(d,o){return[Math.pow(d[0],2.2)*o,Math.pow(d[1],2.2)*o,Math.pow(d[2],2.2)*o]},i.cN=ml,i.cO=No,i.cP=Ma,i.cQ=256,i.cR=function(d,o){const c=[0,0,0],p=io(ja(o.canonical));return Be.vec3.transformMat4(c,c,p),Be.vec3.transformMat4(c,c,d),c},i.cS=d=>({u_camera_to_center_distance:new da(d),u_extrude_scale:new ls(d),u_device_pixel_ratio:new da(d),u_matrix:new wf(d),u_inv_rot_matrix:new wf(d),u_merc_center:new Gs(d),u_tile_id:new xf(d),u_zoom_transition:new da(d),u_up_dir:new xf(d),u_emissive_strength:new da(d)}),i.cT=d=>({u_matrix:new wf(d),u_pixels_to_tile_units:new ls(d),u_device_pixel_ratio:new da(d),u_width_scale:new da(d),u_floor_width_scale:new da(d),u_units_to_pixels:new Gs(d),u_dash_image:new Pc(d),u_gradient_image:new Pc(d),u_image_height:new da(d),u_texsize:new Gs(d),u_tile_units_to_pixels:new da(d),u_alpha_discard_threshold:new da(d),u_trim_offset:new Gs(d),u_trim_fade_range:new Gs(d),u_trim_color:new bf(d),u_emissive_strength:new da(d),u_zbias_factor:new da(d),u_tile_to_meter:new da(d)}),i.cU=d=>({u_matrix:new wf(d),u_texsize:new Gs(d),u_pixels_to_tile_units:new ls(d),u_device_pixel_ratio:new da(d),u_width_scale:new da(d),u_floor_width_scale:new da(d),u_image:new Pc(d),u_units_to_pixels:new Gs(d),u_tile_units_to_pixels:new da(d),u_alpha_discard_threshold:new da(d),u_trim_offset:new Gs(d),u_trim_fade_range:new Gs(d),u_trim_color:new bf(d),u_emissive_strength:new da(d),u_zbias_factor:new da(d),u_tile_to_meter:new da(d)}),i.cV=Op,i.cW=Bie,i.cX=Vie,i.cY=Pf,i.cZ=(d,o,c,p,v,m)=>{const x=d.transform,M=x.projection.name==="globe";let j;if(m.paint.get("circle-pitch-alignment")==="map")if(M){const E=ml(x.zoom,o.canonical)*x._pixelsPerMercatorPixel;j=Float32Array.from([E,0,0,E])}else j=x.calculatePixelsToTileUnitsMatrix(c);else j=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const F={u_camera_to_center_distance:d.transform.getCameraToCenterDistance(x.projection),u_matrix:d.translatePosMatrix(o.projMatrix,c,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ge.devicePixelRatio,u_extrude_scale:j,u_inv_rot_matrix:dh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(M){F.u_inv_rot_matrix=p,F.u_merc_center=v,F.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],F.u_zoom_transition=Ps(x.zoom);const E=v[0]*ar,N=v[1]*ar;F.u_up_dir=x.projection.upVector(new zt(0,0,0),E,N)}return F},i.c_=kz,i.ca=bf,i.cb=function(d,o,c){const p=Math.sqrt(d*d+o*o+c*c),v=p>0?Math.acos(c/p)*Xr:0;let m=d!==0||o!==0?Math.atan2(-o,-d)*Xr+90:0;return m<0&&(m+=360),[p,m,v]},i.cc=s,i.cd=xr,i.ce=qa,i.cf=function(d){return[Math.pow(d[0],1/2.2),Math.pow(d[1],1/2.2),Math.pow(d[2],1/2.2)]},i.cg=function(d,o){return d.readFields(jae,{icons:[]},o)},i.ch=function(d){return d({pluginStatus:ws,pluginURL:fl}),wc.on("pluginStateChange",d),d},i.ci=p2,i.cj=M_,i.ck=qE,i.cl=ho,i.cm=Tp,i.cn=at,i.co=ol,i.cp=jo,i.cq=function(d){const o=d.indexOf(hf);return o>=0?d.slice(0,o):d},i.cr=function(d){return d.indexOf(hf)>=0},i.cs=function(d){const o=d.indexOf(hf);return o>=0?d.slice(o+1):""},i.ct=function(d){const o=[],c=d.id;return c===void 0&&o.push({message:`layers.${c}: missing required property "id"`}),d.render===void 0&&o.push({message:`layers.${c}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&o.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),o},i.cu=function(d,o,c,p){return d.type==="custom"?new _ae(d,o):new Oae[d.type](d,o,c,p)},i.cv=_l,i.cw=class extends B_{constructor(d,o){super(d._vectorTileFeature,d._z,d._x,d._y,d.id),d.state&&(this.state=Object.assign({},d.state)),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=d.source,this.sourceLayer=d.sourceLayer,this.layer=d.layer)}toJSON(){const d=super.toJSON();return d.target=this.target,d.namespace=this.namespace,d}},i.cx=wc,i.cy=Ga,i.cz=Ny,i.d=function(d){return Ui.API_TILEJSON_REGEX.test(d)},i.d$=D5,i.d0=(d,o,c,p,v,m,x,M,j)=>{const F=d.transform,E=F.calculatePixelsToTileUnitsMatrix(o),N=c.paint.get("line-trim-color-use-theme").constantOr("default")==="none",L=F.pitch<15?Mz(.07,.7,dr((14-F.zoom)/5,0,1)):.07;return{u_matrix:Rz(d,o,c,p),u_pixels_to_tile_units:E,u_device_pixel_ratio:m,u_width_scale:x,u_floor_width_scale:M,u_units_to_pixels:[1/F.pixelsToGLUnits[0],1/F.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:jz(c)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Oz(o,d.transform),u_alpha_discard_threshold:0,u_trim_offset:j,u_trim_fade_range:c.paint.get("line-trim-fade-range"),u_trim_color:c.paint.get("line-trim-color").toRenderColor(N?null:c.lut).toArray01(),u_emissive_strength:c.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:s(o.tileID.canonical,0)}},i.d1=Vo,i.d2=sg,i.d3=_z,i.d4=fr,i.d5=$S,i.d6=dg,i.d7=450,i.d8=7,i.d9=vae,i.dA=wr,i.dB=g,i.dC=lh,i.dD=function([d,o,c]){const p=Math.hypot(d,o,c),v=Math.atan2(d,c),m=.5*Math.PI-Math.acos(-o/p);return new Zn(Ot(v),Ot(m))},i.dE=nC,i.dF=function(d){const o=d.navigator?d.navigator.userAgent:null;return!!function(c){if(fa==null){const p=c.navigator?c.navigator.userAgent:null;fa=!!c.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return fa}(d)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(d,o){st=d,bt=o},i.dH=gl,i.dI=Es,i.dJ=function(d){const o=[0,0,0],c=Be.mat4.identity(new Float64Array(16));return Be.mat4.multiply(c,d.pixelMatrix,d.globeMatrix),Be.vec3.transformMat4(o,o,c),new It(o[0],o[1])},i.dK=function(d,o,c=!1){if(ws===Yd||ws===uf||ws===$m)throw new Error("setRTLTextPlugin cannot be called multiple times.");fl=Ge.resolveURL(d),ws=Yd,hl=o,Ay(),c||df()},i.dL=Xd,i.dM=function(){p2().acquire(cC)},i.dN=function(){const d=_b;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(cC),_b=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=qy,i.dP=function(d){const o=tr();if(!o)return;const c=o.delete(mt);d&&c.catch(d).then(()=>d())},i.dQ=vb,i.dR=T5,i.dS=function(d){xC=Ge.resolveURL(d),F_||(F_=new N_(p2(),new qc)),F_.broadcast("setDracoUrl",xC)},i.dT=P5,i.dU=function(d){z_=Ge.resolveURL(d),F_||(F_=new N_(p2(),new qc)),F_.broadcast("setMeshoptUrl",z_)},i.dV=hr,i.dW=cd,i.dX=ph,i.dY=P_,i.dZ=class{constructor(d,o){this.pos=d,this.dir=o}intersectsPlane(d,o,c){const p=Be.vec2.dot(o,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((d[0]-this.pos[0])*o[0]+(d[1]-this.pos[1])*o[1])/p;return c[0]=this.pos[0]+this.dir[0]*v,c[1]=this.pos[1]+this.dir[1]*v,!0}},i.d_=I5,i.da=Qn,i.db=Jm,i.dc=256,i.dd=Ei,i.de=qs,i.df=ou,i.dg=Rp,i.dh=function(d,o,c,p,v){return dr((d-o)/(c-o)*(v-p)+p,p,v)},i.di=Pl,i.dj=Tf,i.dk=class{constructor(d,o,c,p){this.context=d,this.format=p,this.size=c,this.texture=d.gl.createTexture();const[v,m,x]=this.size,{gl:M}=d;M.bindTexture(M.TEXTURE_3D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),M.texImage3D(M.TEXTURE_3D,0,this.format,v,m,x,0,QE(this.format),eC(this.format),o.data)}bind(d,o){const{context:c}=this,{gl:p}=c;p.bindTexture(p.TEXTURE_3D,this.texture),d!==this.minFilter&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MAG_FILTER,d),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MIN_FILTER,d),this.minFilter=d),o!==this.wrapS&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_S,o),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}},i.dl=iC,i.dm=[1,1,1],i.dn=j_,i.dp=k_,i.dq=Eo,i.dr=ih,i.ds=ld,i.dt=nd,i.du=Yl,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new It(1/0,1/0),max:new It(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(d,o=!1){const c=rz(new It(0,0),new It(ar,ar),d),p=[];if(o&&!ME(c,this._globalClipBounds))return p;for(const v of this._activeRegions){if(v.hiddenByOverlap||!ME(c,v))continue;const m=fie(v.min,v.max,d);p.push({min:m.min,max:m.max,sourceId:this._sourceIds[v.priority],footprint:v.footprint,footprintTileId:v.tileId,order:v.order,clipMask:v.clipMask,clipScope:v.clipScope})}return p}setSources(d){this._setSources(d.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const c=[];for(const p of o.cache.getVisibleCoordinates()){const v=o.cache.getTile(p).buckets[o.layer];v&&v.updateFootprints(p.toUnwrapped(),c)}return c},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(d){const o=d.getFootprints();if(o.length===0)return;const c=d.getOrder(),p=d.getClipMask(),v=d.getClipScope();for(const m of o){if(!m.footprint)continue;const x=rz(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:x.min,max:x.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:c,clipMask:p,clipScope:v})}this._sourceIds.push(d.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,c)=>o.priority-c.priority||VS(o.min,c.min)||VS(o.max,c.max)||o.order-c.order||o.clipMask-c.clipMask||function(p,v){const m=(x,M)=>x+M;return p.length-v.length||p.reduce(m,"").localeCompare(v.reduce(m,""))}(o.clipScope,c.clipScope));let d=this._activeRegions.length!==this._prevRegions.length;if(!d){let o=0;for(;!d&&o!==this._activeRegions.length;){const c=this._activeRegions[o],p=this._prevRegions[o];d=c.priority!==p.priority||!tz(c,p)||c.order!==p.order||c.clipMask!==p.clipMask||!Vn(c.clipScope,p.clipScope),++o}}if(d){++this._updateTime;for(const c of this._activeRegions)c.order!==BS&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,c.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,c.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,c.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,c.max.y));const o=c=>{const p=this._activeRegions;if(c>=p.length)return c;const v=p[c].priority;for(;c<p.length&&p[c].priority===v;)++c;return c};if(this._sourceIds.length>1){let c=0,p=o(c);for(;c!==p;){let v=c;const m=c;for(;v!==p;){const x=this._activeRegions[v];x.hiddenByOverlap=!1;for(let M=0;M<m;M++){const j=this._activeRegions[M];if(!j.hiddenByOverlap&&x.order===BS&&ME(x,j)&&(x.hiddenByOverlap=iz(x.footprint,x.tileId,j.footprint,j.tileId),x.hiddenByOverlap))break}++v}c=p,p=o(c)}}}}_setSources(d){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=d.length-1;o>=0;o--)this._addSource(d[o]);this._computeReplacement()}},i.dw=class{constructor(d){this._createGrid(d),this._createPoles(d)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const d of this._poleSegments)d.destroy();for(const d of this._gridSegments)d.withSkirts.destroy(),d.withoutSkirts.destroy()}_fillGridMeshWithLods(d,o){const c=new As,p=new go,v=[],m=d+1+2,x=o[0]+1,M=o[0]+1+(1+o.length),j=(F,E,N)=>{let L=F===m-1?F-2:F===0?F:F-1;return L+=N?24575:0,[L,E]};for(let F=0;F<m;++F)c.emplaceBack(...j(F,0,!0));for(let F=0;F<x;++F)for(let E=0;E<m;++E)c.emplaceBack(...j(E,F,(E===0||E===m-1)&&!0));for(let F=0;F<o.length;++F){const E=o[F];for(let N=0;N<m;++N)c.emplaceBack(...j(N,E,!0))}for(let F=0;F<o.length;++F){const E=p.length,N=o[F]+1+2,L=new go;for(let $=0;$<N-1;$++){const Y=$===N-2,ee=Y?m*(M-o.length+F-$):m;for(let oe=0;oe<m-1;oe++){const se=$*m+oe;$===0||Y||oe===0||oe===m-2?(L.emplaceBack(se+1,se,se+ee),L.emplaceBack(se+ee,se+ee+1,se+1)):(p.emplaceBack(se+1,se,se+ee),p.emplaceBack(se+ee,se+ee+1,se+1))}}const k=va.simpleSegment(0,E,c.length,p.length-E);for(let $=0;$<L.uint16.length;$+=3)p.emplaceBack(L.uint16[$],L.uint16[$+1],L.uint16[$+2]);const I=va.simpleSegment(0,E,c.length,p.length-E);v.push({withoutSkirts:k,withSkirts:I})}return{vertices:c,indices:p,segments:v}}_createGrid(d){const o=this._fillGridMeshWithLods(sh,Af);this._gridSegments=o.segments,this._gridBuffer=d.createVertexBuffer(o.vertices,jr.members),this._gridIndexBuffer=d.createIndexBuffer(o.indices,!0)}_createPoles(d){const o=new go;for(let x=0;x<=sh;x++)o.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=d.createIndexBuffer(o,!0);const c=new ou,p=new ou,v=new ou,m=new ou;this._poleSegments=[];for(let x=0,M=0;x<sd;x++){const j=360/(1<<x);c.emplaceBack(0,-Ho,0,.5,0),p.emplaceBack(0,-Ho,0,.5,1),v.emplaceBack(0,-Ho,0,.5,.5),m.emplaceBack(0,-Ho,0,.5,.5);for(let F=0;F<=sh;F++){let E=F/sh,N=0;const L=Dr(0,j,E),[k,I,$]=Ws(uh,Jl,L,Ho);c.emplaceBack(k,I,$,E,N),p.emplaceBack(k,I,$,E,1-N);const Y=rt(L);E=.5+.5*Math.sin(Y),N=.5+.5*Math.cos(Y),v.emplaceBack(k,I,$,E,N),m.emplaceBack(k,I,$,E,1-N)}this._poleSegments.push(va.simpleSegment(M,0,66,64)),M+=66}this._poleNorthVertexBuffer=d.createVertexBuffer(c,$r,!1),this._poleSouthVertexBuffer=d.createVertexBuffer(p,$r,!1),this._texturedPoleNorthVertexBuffer=d.createVertexBuffer(v,$r,!1),this._texturedPoleSouthVertexBuffer=d.createVertexBuffer(m,$r,!1)}getGridBuffers(d,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[d].withSkirts:this._gridSegments[d].withoutSkirts]}getPoleBuffers(d,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[d]]}},i.dx=BS,i.dy=yr,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=Ui,i.e0=Tz,i.e1=$l,i.e2=sl,i.e3=Qz,i.e4=function(d,o,c,p,v,m,x,M,j,F,E=1,N,L){d.createArrays(),d.tilePixelRatio=ar/(512*d.overscaling),d.compareText={},d.iconsNeedLinear=!1;const k=d.layers[0].layout,I=d.layers[0]._unevaluatedLayout._values,$={};$.scaleFactor=E,$.textSizeScaleRange=k.get("text-size-scale-range"),$.iconSizeScaleRange=k.get("icon-size-scale-range");const[Y,ee]=$.textSizeScaleRange,[oe,se]=$.iconSizeScaleRange;if($.textScaleFactor=dr($.scaleFactor,Y,ee),$.iconScaleFactor=dr($.scaleFactor,oe,se),d.textSizeData.kind==="composite"){const{minZoom:be,maxZoom:Re}=d.textSizeData;$.compositeTextSizes=[I["text-size"].possiblyEvaluate(new vi(be),M),I["text-size"].possiblyEvaluate(new vi(Re),M)]}if(d.iconSizeData.kind==="composite"){const{minZoom:be,maxZoom:Re}=d.iconSizeData;$.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new vi(be),M),I["icon-size"].possiblyEvaluate(new vi(Re),M)]}$.layoutTextSize=I["text-size"].possiblyEvaluate(new vi(j+1),M),$.layoutIconSize=I["icon-size"].possiblyEvaluate(new vi(j+1),M),$.textMaxSize=I["text-size"].possiblyEvaluate(new vi(18),M);const ie=k.get("text-rotation-alignment")==="map"&&k.get("symbol-placement")!=="point",he=k.get("text-size");let me=!1;for(const be of d.features)if(be.icon&&be.icon.nameSecondary){me=!0;break}for(const be of d.features){const Re=k.get("text-font").evaluate(be,{},M).join(","),Me=he.evaluate(be,{},M)*$.textScaleFactor,Ce=$.layoutTextSize.evaluate(be,{},M)*$.textScaleFactor,Xe=($.layoutIconSize.evaluate(be,{},M),{horizontal:{},vertical:void 0}),Ie=be.text;let Qe,ot=[0,0];if(Ie){const dt=Ie.toString(),yt=k.get("text-letter-spacing").evaluate(be,{},M)*Cs,ct=k.get("text-line-height").evaluate(be,{},M)*Cs,jt=wy(dt)?yt:0,Vt=k.get("text-anchor").evaluate(be,{},M),kt=k.get("text-variable-anchor");if(!kt){const Er=k.get("text-radial-offset").evaluate(be,{},M);ot=Er?aF(Vt,[Er*Cs,GE]):k.get("text-offset").evaluate(be,{},M).map(pr=>pr*Cs)}let cr=ie?"center":k.get("text-justify").evaluate(be,{},M);const ir=k.get("symbol-placement")==="point",Xt=ir?k.get("text-max-width").evaluate(be,{},M)*Cs:1/0,Ut=Er=>{d.allowVerticalPlacement&&Ap(dt)&&(Xe.vertical=UE(Ie,o,c,v,Re,Xt,ct,Vt,Er,jt,ot,du.vertical,!0,Ce,Me))};if(!ie&&kt){const Er=cr==="auto"?kt.map(vr=>KE(vr)):[cr];let pr=!1;for(let vr=0;vr<Er.length;vr++){const Qr=Er[vr];if(!Xe.horizontal[Qr])if(pr)Xe.horizontal[Qr]=Xe.horizontal[0];else{const fn=UE(Ie,o,c,v,Re,Xt,ct,"center",Qr,jt,ot,du.horizontal,!1,Ce,Me);fn&&(Xe.horizontal[Qr]=fn,pr=fn.positionedLines.length===1)}}Ut("left")}else{if(cr==="auto"&&(cr=KE(Vt)),ir||k.get("text-writing-mode").indexOf("horizontal")>=0||!Ap(dt)){const Er=UE(Ie,o,c,v,Re,Xt,ct,Vt,cr,jt,ot,du.horizontal,!1,Ce,Me);Er&&(Xe.horizontal[cr]=Er)}Ut(ir?"left":cr)}}let nt=!1;if(be.icon&&be.icon.namePrimary){const dt=LE(d.iconSizeData,I["icon-size"],M,d.zoom,be)*$.iconScaleFactor*N,yt=be.icon.getPrimary().scaleSelf(dt).serialize(),ct=p[yt];ct&&(Qe=Jie(v[yt],be.icon.nameSecondary?v[be.icon.getSecondary().scaleSelf(dt).serialize()]:void 0,k.get("icon-offset").evaluate(be,{},M),k.get("icon-anchor").evaluate(be,{},M)),nt=ct.sdf,d.sdfIcons===void 0?d.sdfIcons=ct.sdf:d.sdfIcons!==ct.sdf&&rn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ct.pixelRatio!==d.pixelRatio||k.get("icon-rotate").constantOr(1)!==0)&&(d.iconsNeedLinear=!0))}const lt=sF(Xe.horizontal)||Xe.vertical;d.iconsInText||(d.iconsInText=!!lt&&lt.iconsInText),(lt||Qe)&&aae(d,be,Xe,Qe,p,$,Ce,0,ot,nt,x,M,F,L,me)}m&&d.generateCollisionDebugBuffers(j,d.collisionBoxArray,$.textScaleFactor)},i.e5=x2,i.e6=Sn,i.e7=Y4,i.e8=Fz,i.e9=_,i.ea=function(d){let o=0;if(new Uint32Array(d,0,1)[0]!==C5){const c=new Uint32Array(d,0,7),[,,p,v,m,x]=c;o=c.byteLength+v+m+x+m,(p!==d.byteLength||o>=d.byteLength)&&rn("Invalid b3dm header information.")}return k5(d,o)},i.eb=function(d,o){const c=N5(d);for(const p of c){for(const v of p.meshes)Noe(v);p.lights&&(p.lightMeshIndex=p.meshes.length,p.meshes.push(Ioe(p.lights,o)))}return c},i.ec=f2,i.ed=HF,i.ee=$s,i.ef=function(d){nr(),St!=null&&St.then(o=>{o.keys().then(c=>{for(let p=0;p<c.length-d;p++)o.delete(c[p])})})},i.f=function(d){return d.indexOf("mapbox:")===0},i.g=function(d,o){return Ga(Vi(d,{method:"GET"}),o)},i.h=So,i.i=function(d){return Ui.API_STYLE_REGEX.test(d)&&!uo(d)},i.j=function(d){return decodeURIComponent(atob(d).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(d){return btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(o,c)=>String.fromCharCode(+("0x"+c))))},i.l=Vi,i.m=Vr,i.n=function(d,o){return Ga(Vi(d,{type:"json"}),o)},i.o=Hh,i.p=function(d,o){return Ga(Vi(d,{method:"POST"}),o)},i.q=Ge,i.r=zo,i.s=function(d){try{const o=self[d];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=Te,i.u=function(){return function d(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,d)}()},i.v=function(d){return!!d&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d)},i.w=rn,i.x=function(){return uC||(uC=new qy),uC},i.y=ip,i.z=yi}),l(["./shared"],function(i){function _(wt){const ge=wt?wt.url.toString():void 0;return ge?performance.getEntriesByName(ge):[]}function w(wt){if(typeof wt=="number"||typeof wt=="boolean"||typeof wt=="string"||wt==null)return JSON.stringify(wt);if(Array.isArray(wt)){let we="[";for(const Te of wt)we+=`${w(Te)},`;return`${we}]`}let ge="{";for(const we of Object.keys(wt).sort())ge+=`${we}:${w(wt[we])},`;return`${ge}}`}function A(wt){let ge="";for(const we of i.bm)(wt.type!=="model"||we!=="minzoom"&&we!=="maxzoom")&&(ge+=`/${w(wt[we])}`);return ge}class C{constructor(ge){this.keyCache={},this._layers={},this._layerConfigs={},ge&&this.replace(ge)}replace(ge,we){this._layerConfigs={},this._layers={},this.update(ge,[],we)}update(ge,we,Te){this._options=Te;for(const He of ge)this._layerConfigs[He.id]=He,(this._layers[He.id]=i.cu(He,this.scope,null,this._options)).compileFilter(Te),this.keyCache[He.id]&&delete this.keyCache[He.id];for(const He of we)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};const Ge=function(He,at){const mt={};for(let bt=0;bt<He.length;bt++){const xt=He[bt];let St=at&&at[xt.id];!St&&(St=A(xt),xt.type==="line"&&xt.paint)&&function tr(nr){return typeof nr=="string"&&nr==="line-progress"||(Array.isArray(nr)?nr.some(tr):!(!nr||typeof nr!="object")&&Object.values(nr).some(tr))}(xt.paint["line-width"])&&(St+=`/${w(xt.paint["line-width"])}`),at&&(at[xt.id]=St);let Lt=mt[St];Lt||(Lt=mt[St]=[]),Lt.push(xt)}const st=[];for(const bt in mt)st.push(mt[bt]);return st}(i.bj(this._layerConfigs),this.keyCache);for(const He of Ge){const at=He.map(Lt=>this._layers[Lt.id]),mt=at[0];if(mt.visibility==="none")continue;const st=mt.source||"";let bt=this.familiesBySource[st];bt||(bt=this.familiesBySource[st]={});const xt=mt.sourceLayer||"_geojsonTileLayer";let St=bt[xt];St||(St=bt[xt]=[]),St.push(at)}}}const R=1*i.dX;class z{constructor(ge){const we={},Te=[];for(const mt in ge){const st=ge[mt],bt=we[mt]={};for(const xt in st.glyphs){const St=st.glyphs[+xt];if(!St||St.bitmap.width===0||St.bitmap.height===0)continue;const Lt=St.metrics.localGlyph?R:1,tr={x:0,y:0,w:St.bitmap.width+2*Lt,h:St.bitmap.height+2*Lt};Te.push(tr),bt[xt]=tr}}const{w:Ge,h:He}=i.F(Te),at=new i.dW({width:Ge||1,height:He||1});for(const mt in ge){const st=ge[mt];for(const bt in st.glyphs){const xt=st.glyphs[+bt];if(!xt||xt.bitmap.width===0||xt.bitmap.height===0)continue;const St=we[mt][bt],Lt=xt.metrics.localGlyph?R:1;i.dW.copy(xt.bitmap,at,{x:0,y:0},{x:St.x+Lt,y:St.y+Lt},xt.bitmap)}}this.image=at,this.positions=we}}i.dV(z,"GlyphAtlas");const V="3d_elevation_id",U="hd_road_elevation";class G{constructor(){this._valid=!1}reset(ge){return this.feature=ge,this._valid=!0,this._geometry=ge.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(ge,we){return this._valid&&ge(we(this._geometry)),this}require(ge,we,Te){return this.get(ge,!0,we,Te)}optional(ge,we,Te){return this.get(ge,!1,we,Te)}success(){return this._valid}get(ge,we,Te,Ge){const He=this.feature.properties.hasOwnProperty(ge)?+this.feature.properties[ge]:void 0;return this._valid&&He!==void 0?Te(Ge?Ge(He):He):we&&(this._valid=!1),this}}class H{constructor(ge,we){this.featureFunc=ge,this.vertexFunc=we}parseFeature(ge,we,Te){return this.featureFunc(ge,we,Te)}parseVertex(ge,we,Te){return this.vertexFunc(ge,we,Te)}}const J=new H((wt,ge,we)=>wt.reset(ge).require(V,Te=>{we.id=Te}).optional("fixed_height_relative",Te=>{we.constantHeight=Te},le.decodeRelativeHeight).geometry(Te=>{we.bounds=Te},le.computeBounds).success(),(wt,ge,we)=>wt.reset(ge).require(V,Te=>{we.id=Te}).require("elevation_idx",Te=>{we.idx=Te}).require("extent",Te=>{we.extent=Te}).require("height_relative",Te=>{we.height=Te},le.decodeRelativeHeight).geometry(Te=>{we.position=Te},le.getPoint).success()),Q=new H((wt,ge,we)=>wt.reset(ge).require(V,Te=>{we.id=Te}).optional("fixed_height",Te=>{we.constantHeight=Te},le.decodeMetricHeight).geometry(Te=>{we.bounds=Te},le.computeBounds).success(),(wt,ge,we)=>wt.reset(ge).require(V,Te=>{we.id=Te}).require("elevation_idx",Te=>{we.idx=Te}).require("extent",Te=>{we.extent=Te}).require("height",Te=>{we.height=Te},le.decodeMetricHeight).geometry(Te=>{we.position=Te},le.getPoint).success());class le{static computeBounds(ge){const we=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Te=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const Ge of ge[0])we.x>Ge.x&&(we.x=Ge.x),we.y>Ge.y&&(we.y=Ge.y),Te.x<Ge.x&&(Te.x=Ge.x),Te.y<Ge.y&&(Te.y=Ge.y);return{min:we,max:Te}}static getPoint(ge){return i.ab.vec2.fromValues(ge[0][0].x,ge[0][0].y)}static decodeRelativeHeight(ge){return 1e-4*ge*5}static decodeMetricHeight(ge){return 1e-4*ge}static parse(ge){const we=[],Te=[],Ge=ge.length,He=new G;for(let mt=0;mt<Ge;mt++){const st=ge.feature(mt),bt=st.properties.hasOwnProperty("version")?String(st.properties.version):void 0,xt=(at=bt)?at==="1.0.1"?Q:void 0:J;if(xt===void 0){i.w(`Unknown elevation feature version number ${bt||"(unknown)"}`);continue}const St=st.properties.hasOwnProperty("type")?st.properties.type:void 0;if(St){if(i.dY.VectorTileFeature.types[st.type]==="Point"&&St==="curve_point"){const Lt={};xt.parseVertex(He,st,Lt)&&we.push(Lt)}else if(i.dY.VectorTileFeature.types[st.type]==="Polygon"&&St==="curve_meta"){const Lt={};xt.parseFeature(He,st,Lt)&&Te.push(Lt)}}}var at;return{vertices:we,features:Te}}}class ne{constructor(ge,we,Te,Ge,He,at){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=ge,this.heightRange={min:Te,max:Te},this.safeArea=we,this.constantHeight=Te,this.constantHeight==null&&(this.constantHeight!=null||Ge.length!==0)){this.vertices=Ge,this.edges=He,this.edges=this.edges.filter(mt=>mt.a<this.vertices.length&&mt.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[mt.a].position,this.vertices[mt.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const mt of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,mt.height),this.heightRange.max=Math.max(this.heightRange.max,mt.height);for(const mt of this.edges){const st=this.vertices[mt.a].position,bt=this.vertices[mt.b].position,xt=i.ab.vec2.subtract(i.ab.vec2.create(),bt,st),St=i.ab.vec2.length(xt),Lt=i.ab.vec2.scale(i.ab.vec2.create(),xt,1/St);this.edgeProps.push({vec:xt,dir:Lt,len:St});const tr=this.vertexProps[mt.a].dir,nr=this.vertexProps[mt.b].dir;i.ab.vec2.add(tr,tr,Lt),i.ab.vec2.add(nr,nr,Lt)}for(const mt of this.vertexProps)mt.dir[0]===0&&mt.dir[1]===0||i.ab.vec2.normalize(mt.dir,mt.dir);this.tessellate(at)}}pointElevation(ge){if(this.constantHeight!=null)return this.constantHeight;const we=this.getClosestEdge(ge);if(we==null)return 0;const[Te,Ge]=we;return(1-(He=Ge))*this.vertices[this.edges[Te].a].height+He*this.vertices[this.edges[Te].b].height;var He}getClosestEdge(ge){if(this.edges.length===0)return;let we=0,Te=Number.POSITIVE_INFINITY,Ge=0;const He=i.ab.vec2.fromValues(ge.x,ge.y);for(let at=0;at<this.edges.length;at++){const mt=this.edges[at],st=this.edgeProps[at].dir,bt=new i.dZ(He,this.edgeProps[at].dir),xt=this.vertices[mt.a].position,St=this.vertices[mt.b].position,Lt=i.ab.vec2.create(),tr=i.ab.vec2.create(),nr=bt.intersectsPlane(xt,this.vertexProps[mt.a].dir,Lt),Sr=bt.intersectsPlane(St,this.vertexProps[mt.b].dir,tr);if(!nr||!Sr)continue;const Vr=i.ab.vec2.subtract(i.ab.vec2.create(),tr,Lt),Br=i.ab.vec2.subtract(i.ab.vec2.create(),He,Lt),Fr=i.ab.vec2.dot(Vr,Vr),Tn=Fr>0?i.ab.vec2.dot(Br,Vr)/Fr:0,Hn=i.aw(Tn,0,1),vn=Math.abs((Tn-Hn)*this.edgeProps[at].len),$n=i.ab.vec2.subtract(i.ab.vec2.create(),He,xt),Pn=vn+Math.abs(i.ab.vec2.dot($n,i.ab.vec2.fromValues(st[1],-st[0])));Pn<Te&&(we=at,Te=Pn,Ge=Hn)}return[we,Ge]}tessellate(ge){for(let we=this.edges.length-1;we>=0;--we){const Te=this.edges[we].a,Ge=this.edges[we].b,{position:He,height:at,extent:mt}=this.vertices[Te],{position:st,height:bt,extent:xt}=this.vertices[Ge],St=this.vertexProps[Te].dir,Lt=this.vertexProps[Ge].dir,tr=i.ab.vec3.fromValues(He[0]/ge,He[1]/ge,at),nr=i.ab.vec3.fromValues(st[0]/ge,st[1]/ge,bt),Sr=i.ab.vec3.fromValues(St[1],-St[0],0);i.ab.vec3.scale(Sr,Sr,mt);const Vr=i.ab.vec3.fromValues(Lt[1],-Lt[0],0);if(i.ab.vec3.scale(Vr,Vr,xt),this.distSqLines(i.ab.vec3.fromValues(tr[0]+.5*Sr[0],tr[1]+.5*Sr[1],tr[2]+.5*Sr[2]),i.ab.vec3.fromValues(nr[0]-.5*Vr[0],nr[1]-.5*Vr[1],nr[2]-.5*Vr[2]),i.ab.vec3.fromValues(tr[0]-.5*Sr[0],tr[1]-.5*Sr[1],tr[2]-.5*Sr[2]),i.ab.vec3.fromValues(nr[0]+.5*Vr[0],nr[1]+.5*Vr[1],nr[2]+.5*Vr[2]))<=.05*.05)continue;const Br=this.vertices.length,Fr=i.ab.vec2.add(i.ab.vec2.create(),He,st);this.vertices.push({position:i.ab.vec2.scale(Fr,Fr,.5),height:.5*(at+bt),extent:.5*(mt+xt)});const Tn=i.ab.vec2.add(i.ab.vec2.create(),St,Lt);this.vertexProps.push({dir:i.ab.vec2.normalize(Tn,Tn)}),this.edges.splice(we,1),this.edgeProps.splice(we,1),this.edges.push({a:Te,b:Br}),this.edges.push({a:Br,b:Ge});const Hn=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[Br].position,He),vn=i.ab.vec2.length(Hn),$n={vec:Hn,dir:i.ab.vec2.scale(i.ab.vec2.create(),Hn,1/vn),len:vn};this.edgeProps.push($n),this.edgeProps.push($n)}}distSqLines(ge,we,Te,Ge){const He=i.ab.vec3.subtract(i.ab.vec3.create(),we,ge),at=i.ab.vec3.subtract(i.ab.vec3.create(),Ge,Te),mt=i.ab.vec3.subtract(i.ab.vec3.create(),ge,Te),st=i.ab.vec3.dot(He,He),bt=i.ab.vec3.dot(He,at),xt=i.ab.vec3.dot(He,mt),St=i.ab.vec3.dot(at,at),Lt=i.ab.vec3.dot(at,mt),tr=st*St-bt*bt;if(tr===0){const Fr=i.ab.vec3.dot(mt,at)/i.ab.vec3.dot(at,at),Tn=i.ab.vec3.lerp(i.ab.vec3.create(),Te,Ge,Fr);return i.ab.vec3.squaredDistance(Tn,ge)}const nr=(bt*Lt-xt*St)/tr,Sr=(st*Lt-bt*xt)/tr,Vr=i.ab.vec3.lerp(i.ab.vec3.create(),ge,we,nr),Br=i.ab.vec3.lerp(i.ab.vec3.create(),Te,Ge,Sr);return i.ab.vec3.squaredDistance(Vr,Br)}}class de{static parseFrom(ge,we){const Te=le.parse(ge);if(!Te)return[];let{vertices:Ge,features:He}=Te;const at=1/i.cc(we);He.sort((xt,St)=>xt.id-St.id),Ge.sort((xt,St)=>xt.id-St.id||xt.idx-St.idx),Ge=Ge.filter((xt,St,Lt)=>St===Lt.findIndex(tr=>tr.id===xt.id&&tr.idx===xt.idx));const mt=new Array;let st=0;const bt=Ge.length;for(const xt of He){if(xt.constantHeight){mt.push(new ne(xt.id,xt.bounds,xt.constantHeight));continue}for(;st!==bt&&Ge[st].id<xt.id;)st++;if(st===bt||Ge[st].id!==xt.id)continue;const St=new Array,Lt=new Array,tr=st;for(;st!==bt&&Ge[st].id===xt.id;){const nr=Ge[st];if(St.push({position:nr.position,height:nr.height,extent:nr.extent}),st!==tr&&Ge[st-1].idx===nr.idx-1){const Sr=st-tr;Lt.push({a:Sr-1,b:Sr})}st++}mt.push(new ne(xt.id,xt.bounds,void 0,St,Lt,at))}return mt}}i.dV(ne,"ElevationFeature");class ue{constructor(ge){this.tileID=new i.aG(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.lut=ge.lut,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.scope=ge.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ge.showCollisionBoxes,this.collectResourceTiming=!!ge.request&&ge.request.collectResourceTiming,this.promoteId=ge.promoteId,this.isSymbolTile=ge.isSymbolTile,this.tileTransform=i.aQ(ge.tileID.canonical,ge.projection),this.projection=ge.projection,this.worldview=ge.worldview,this.localizableLayerIds=ge.localizableLayerIds,this.brightness=ge.brightness,this.extraShadowCaster=!!ge.extraShadowCaster,this.tessellationStep=ge.tessellationStep,this.scaleFactor=ge.scaleFactor}parse(ge,we,Te,Ge,He){this.status="parsing",this.data=ge,this.collisionBoxArray=new i.aW;const at=new i.d_(Object.keys(ge.layers).sort()),mt=new i.d$(this.tileID,this.promoteId);mt.bucketLayerIDs=[];const st={},bt=new i.e0(256,256),xt={featureIndex:mt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:bt,availableImages:Te,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},St=we.familiesBySource[this.source];for(const Fr in St){const Tn=ge.layers[Fr];if(!Tn)continue;let Hn=!1,vn=!1,$n=!1;for(const Ga of St[Fr])Ga[0].type==="symbol"?Hn=!0:vn=!0,Ga[0].is3D()&&Ga[0].type!=="model"&&($n=!0);if(this.extraShadowCaster&&!$n||this.isSymbolTile===!0&&!Hn||this.isSymbolTile===!1&&!vn)continue;Tn.version===1&&i.w(`Vector tile source "${this.source}" layer "${Fr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pn=at.encode(Fr),Oa=[];let ho=!1;for(let Ga=0,to=0;Ga<Tn.length;Ga++){const as=Tn.feature(Ga),Nu=mt.getId(as,Fr);if(this.localizableLayerIds&&this.localizableLayerIds.has(Fr)){const bl=as.properties?as.properties.worldview:null;if(this.worldview&&typeof bl=="string")if(bl==="all")as.properties.$localized=!0;else{if(!bl.split(",").includes(this.worldview))continue;as.properties.$localized=!0,as.properties.worldview=this.worldview}}!ho&&as.properties&&as.properties.hasOwnProperty(V)&&(ho=!0),Oa.push({feature:as,id:Nu,index:to,sourceLayerIndex:Pn}),to++}ho&&ge.layers.hasOwnProperty(U)&&(xt.elevationFeatures=de.parseFrom(ge.layers[U],this.canonical));for(const Ga of St[Fr]){const to=Ga[0];(!this.extraShadowCaster||to.is3D()&&to.type!=="model")&&(this.isSymbolTile!==void 0&&to.type==="symbol"!==this.isSymbolTile||to.minzoom&&this.zoom<Math.floor(to.minzoom)||to.maxzoom&&this.zoom>=to.maxzoom||to.visibility!=="none"&&(ve(Ga,this.zoom,xt.brightness,Te),(st[to.id]=to.createBucket({index:mt.bucketLayerIDs.length,layers:Ga,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Oa,xt,this.tileID.canonical,this.tileTransform),mt.bucketLayerIDs.push(Ga.map(as=>i.aC(as.id,as.scope)))))}}let Lt,tr,nr,Sr;bt.trim();const Vr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Br=()=>{if(Lt)return this.status="done",He(Lt);if(this.extraShadowCaster)this.status="done",He(null,{buckets:i.bj(st).filter(Fr=>!Fr.isEmpty()),featureIndex:mt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:xt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(tr&&nr&&Sr){const Fr=new z(tr),Tn=new i.e3(nr,Sr,this.lut);for(const Hn in st){const vn=st[Hn];vn instanceof i.aX?(ve(vn.layers,this.zoom,xt.brightness,Te),i.e4(vn,tr,Fr.positions,nr,Tn.iconPositions,this.showCollisionBoxes,Te,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):vn.hasPattern&&(vn instanceof i.b1||vn instanceof i.b2||vn instanceof i.d5)&&(ve(vn.layers,this.zoom,xt.brightness,Te),vn.addFeatures(xt,this.tileID.canonical,Tn.patternPositions,Te,this.tileTransform,this.brightness))}this.status="done",He(null,{buckets:i.bj(st).filter(Hn=>!Hn.isEmpty()),featureIndex:mt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Fr.image,lineAtlas:bt,imageAtlas:Tn,brightness:xt.brightness})}};if(!this.extraShadowCaster){const Fr=i.e1(xt.glyphDependencies,vn=>Object.keys(vn).map(Number));Object.keys(Fr).length?Ge.send("getGlyphs",{uid:this.uid,stacks:Fr,scope:this.scope},(vn,$n)=>{Lt||(Lt=vn,tr=$n,Br())},void 0,!1,Vr):tr={};const Tn=Object.keys(xt.iconDependencies);Tn.length?Ge.send("getImages",{icons:Tn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(vn,$n)=>{if(Lt)return;Lt=vn;const Pn={};Object.values($n).some(Oa=>Oa.usvg)?this.rasterize(Ge,Pn,$n,xt.iconDependencies,()=>{nr=Pn,Br()}):(this.fillImageMap(Pn,xt.iconDependencies,$n),nr=Pn,Br())},void 0,!1,Vr):nr={};const Hn=Object.keys(xt.patternDependencies);Hn.length?Ge.send("getImages",{icons:Hn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(vn,$n)=>{if(!Lt){Lt=vn;const Pn={};Object.values($n).some(Oa=>Oa.usvg)?this.rasterize(Ge,Pn,$n,xt.patternDependencies,()=>{Sr=Pn,Br()}):(this.fillImageMap(Pn,xt.patternDependencies,$n),Sr=Pn,Br())}},void 0,!1,Vr):Sr={}}Br()}fillImageMap(ge,we,Te){for(const Ge in Te){const He=we[Ge]||[];for(const at of He)Te[at.id].usvg||(ge[at.serialize()]=Te[at.id])}}getImageTaskQueue(ge,we,Te){const Ge={};for(const He in we){const at=Te[He]||[];for(const mt of at){const st=mt.serialize();we[mt.id].usvg?Ge[st]||(Ge[st]=mt):ge[st]=we[mt.id]}}return Ge}rasterize(ge,we,Te,Ge,He){const at=this.getImageTaskQueue(we,Te,Ge);this.rasterizeTask=ge.send("rasterizeImages",{scope:this.scope,imageTasks:at},(mt,st)=>{if(!mt)for(const bt in st){const{id:xt}=i.e2.deserializeFromString(bt);we[bt]=Object.assign({},Te[xt],{data:st[bt]})}He()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function ve(wt,ge,we,Te){const Ge=new i.a8(ge,{brightness:we});for(const He of wt)He.recalculate(Ge,Te)}class Ae extends i.E{constructor(ge,we,Te,Ge,He,at){super(),this.actor=ge,this.layerIndex=we,this.availableImages=Te,this.loadVectorData=He||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(ge.scheduler),this.isSpriteLoaded=Ge,this.scheduler=ge.scheduler,this.brightness=at}loadTile(ge,we){const Te=ge.uid,Ge=ge&&ge.request,He=Ge&&Ge.collectResourceTiming,at=this.loading[Te]=new ue(ge);at.abort=this.loadVectorData(ge,(mt,st)=>{const bt=!this.loading[Te];if(delete this.loading[Te],at.cancelRasterize(),bt||mt||!st)return at.status="done",bt||(this.loaded[Te]=at),we(mt);const xt=st.rawData,St={};st.expires&&(St.expires=st.expires),st.cacheControl&&(St.cacheControl=st.cacheControl),at.vectorTile=st.vectorTile||new i.dY.VectorTile(new i.bh(xt));const Lt=()=>{at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.actor,(tr,nr)=>{if(tr||!nr)return we(tr);const Sr={};if(He){const Vr=_(Ge);Vr.length>0&&(Sr.resourceTiming=JSON.parse(JSON.stringify(Vr)))}we(null,i.l({rawTileData:xt.slice(0)},nr,St,Sr))})};this.isSpriteLoaded?Lt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Lt,{type:"parseTile",isSymbolTile:ge.isSymbolTile,zoom:ge.tileZoom}):Lt()}),this.loaded=this.loaded||{},this.loaded[Te]=at})}reloadTile(ge,we){const Te=this.loaded,Ge=ge.uid;if(Te&&Te[Ge]){const He=Te[Ge];He.scaleFactor=ge.scaleFactor,He.showCollisionBoxes=ge.showCollisionBoxes,He.projection=ge.projection,He.brightness=ge.brightness,He.tileTransform=i.aQ(ge.tileID.canonical,ge.projection),He.extraShadowCaster=ge.extraShadowCaster,He.lut=ge.lut;const at=(mt,st)=>{const bt=He.reloadCallback;bt&&(delete He.reloadCallback,He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.actor,bt)),we(mt,st)};He.status==="parsing"?He.reloadCallback=at:He.status==="done"&&(He.vectorTile?He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.actor,at):at())}else we(null,void 0)}abortTile(ge,we){const Te=ge.uid,Ge=this.loading[Te];Ge&&(Ge.abort&&Ge.abort(),delete this.loading[Te]),we()}removeTile(ge,we){const Te=this.loaded,Ge=ge.uid;Te&&Te[Ge]&&delete Te[Ge],we()}}class Oe{loadTile(ge,we){const{uid:Te,encoding:Ge,rawImageData:He,padding:at}=ge,mt=ImageBitmap&&He instanceof ImageBitmap?this.getImageData(He,at):He;we(null,new i.e5(Te,mt,Ge,at<1))}getImageData(ge,we){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ge.width,ge.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ge.width,this.offscreenCanvas.height=ge.height,this.offscreenCanvasContext.drawImage(ge,0,0,ge.width,ge.height);const Te=this.offscreenCanvasContext.getImageData(-we,-we,ge.width+2*we,ge.height+2*we);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Te}}i.bg.setPbf(i.bh);class Se{decodeRasterArray({task:ge,buffer:we},Te){i.bg.performDecoding(we,ge).then(Ge=>{Te(null,Ge)},Ge=>{Te(Ge)})}}const ke=i.dY.VectorTileFeature.prototype.toGeoJSON;class ze{constructor(ge){this._feature=ge,this.extent=i.ag,this.type=ge.type,this.properties=ge.tags,"id"in ge&&!isNaN(ge.id)&&(this.id=parseInt(ge.id,10))}loadGeometry(){if(this._feature.type===1){const ge=[];for(const we of this._feature.geometry)ge.push([new i.P(we[0],we[1])]);return ge}{const ge=[];for(const we of this._feature.geometry){const Te=[];for(const Ge of we)Te.push(new i.P(Ge[0],Ge[1]));ge.push(Te)}return ge}}toGeoJSON(ge,we,Te){return ke.call(this,ge,we,Te)}}class et{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=ge.length,this._features=ge}feature(ge){return new ze(this._features[ge])}}const je=64/4096,Ne=128;class Ye{constructor(){this.features=new Map}clear(){this.features.clear()}load(ge=[],we){for(const Te of ge){const Ge=Te.id;if(Ge==null)continue;let He=this.features.get(Ge);He&&this.updateCache(He,we),Te.geometry?(He=We(Te),this.updateCache(He,we),this.features.set(Ge,He)):this.features.delete(Ge),this.updateCache(He,we)}}updateCache(ge,we){for(const{canonical:Te,uid:Ge}of Object.values(we)){const{z:He,x:at,y:mt}=Te;$e(ge,Math.pow(2,He),at,mt)&&delete we[Ge]}}getTile(ge,we,Te){const Ge=Math.pow(2,ge),He=[];for(const at of this.features.values())$e(at,Ge,we,Te)&&He.push(tt(at,Ge,we,Te));return{features:He}}getFeatures(){return[...this.features.values()]}}function $e({minX:wt,minY:ge,maxX:we,maxY:Te},Ge,He,at){return wt<(He+1+je)/Ge&&ge<(at+1+je)/Ge&&we>(He-je)/Ge&&Te>(at-je)/Ge}function We(wt){const{id:ge,geometry:we,properties:Te}=wt;if(!we)return;if(we.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ge,coordinates:He}=we,at={id:ge,type:1,geometry:[],tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},mt=at.geometry;if(Ge==="Point")Et(He,mt,at);else if(Ge==="MultiPoint")for(const st of He)Et(st,mt,at);else if(Ge==="LineString")at.type=2,Je(He,mt,at);else if(Ge==="MultiLineString")at.type=2,ht(He,mt,at);else if(Ge==="Polygon")at.type=3,ht(He,mt,at,!0);else{if(Ge!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");at.type=3;for(const st of He)ht(st,mt,at,!0)}return at}function Et([wt,ge],we,Te){const Ge=i.at(wt);let He=i.aA(ge);He=He<0?0:He>1?1:He,we.push(Ge,He),Te.minX=Math.min(Te.minX,Ge),Te.minY=Math.min(Te.minY,He),Te.maxX=Math.max(Te.maxX,Ge),Te.maxY=Math.max(Te.maxY,He)}function Je(wt,ge,we,Te=!1,Ge=!1){const He=[];for(const at of wt)Et(at,He,we);ge.push(He),Te&&function(at,mt){let st=0;for(let bt=0,xt=at.length,St=xt-2;bt<xt;St=bt,bt+=2)st+=(at[bt]-at[St])*(at[bt+1]+at[St+1]);if(st>0===mt)for(let bt=0,xt=at.length;bt<xt/2;bt+=2){const St=at[bt],Lt=at[bt+1];at[bt]=at[xt-2-bt],at[bt+1]=at[xt-1-bt],at[xt-2-bt]=St,at[xt-1-bt]=Lt}}(He,Ge)}function ht(wt,ge,we,Te=!1){for(let Ge=0;Ge<wt.length;Ge++)Je(wt[Ge],ge,we,Te,Ge===0)}function tt(wt,ge,we,Te){const{id:Ge,type:He,geometry:at,tags:mt}=wt,st=[];if(He===1)(function(bt,xt,St,Lt,tr){for(let nr=0;nr<bt.length;nr+=2){const Sr=Math.round(i.ag*(bt[nr+0]*xt-St)),Vr=Math.round(i.ag*(bt[nr+1]*xt-Lt));tr.push([Sr,Vr])}})(at,ge,we,Te,st);else for(const bt of at)Qt(bt,ge,we,Te,st);return{id:Ge,type:He,geometry:st,tags:mt}}function Qt(wt,ge,we,Te,Ge){const at=i.ag+Ne;let mt;for(let st=0;st<wt.length-2;st+=2){let bt=Math.round(i.ag*(wt[st+0]*ge-we)),xt=Math.round(i.ag*(wt[st+1]*ge-Te)),St=Math.round(i.ag*(wt[st+2]*ge-we)),Lt=Math.round(i.ag*(wt[st+3]*ge-Te));const tr=St-bt,nr=Lt-xt;bt<-128&&St<-128||(bt<-128?(xt+=Math.round(nr*((-128-bt)/tr)),bt=-128):St<-128&&(Lt=xt+Math.round(nr*((-128-bt)/tr)),St=-128),xt<-128&&Lt<-128||(xt<-128?(bt+=Math.round(tr*((-128-xt)/nr)),xt=-128):Lt<-128&&(St=bt+Math.round(tr*((-128-xt)/nr)),Lt=-128),bt>=at&&St>=at||(bt>=at?(xt+=Math.round(nr*((at-bt)/tr)),bt=at):St>=at&&(Lt=xt+Math.round(nr*((at-bt)/tr)),St=at),xt>=at&&Lt>=at||(xt>=at?(bt+=Math.round(tr*((at-xt)/nr)),xt=at):Lt>=at&&(St=bt+Math.round(tr*((at-xt)/nr)),Lt=at),mt&&bt===mt[mt.length-1][0]&&xt===mt[mt.length-1][1]||(mt=[[bt,xt]],Ge.push(mt)),mt.push([St,Lt])))))}}var gr,sr,ur,br={exports:{}},Wt=function(){if(ur)return br.exports;ur=1;var wt=i.e8(),ge=function(){if(sr)return gr;sr=1;var xt=i.e6(),St=i.e7().VectorTileFeature;function Lt(nr,Sr){this.options=Sr||{},this.features=nr,this.length=nr.length}function tr(nr,Sr){this.id=typeof nr.id=="number"?nr.id:void 0,this.type=nr.type,this.rawGeometry=nr.type===1?[nr.geometry]:nr.geometry,this.properties=nr.tags,this.extent=Sr||4096}return gr=Lt,Lt.prototype.feature=function(nr){return new tr(this.features[nr],this.options.extent)},tr.prototype.loadGeometry=function(){var nr=this.rawGeometry;this.geometry=[];for(var Sr=0;Sr<nr.length;Sr++){for(var Vr=nr[Sr],Br=[],Fr=0;Fr<Vr.length;Fr++)Br.push(new xt(Vr[Fr][0],Vr[Fr][1]));this.geometry.push(Br)}return this.geometry},tr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var nr=this.geometry,Sr=1/0,Vr=-1/0,Br=1/0,Fr=-1/0,Tn=0;Tn<nr.length;Tn++)for(var Hn=nr[Tn],vn=0;vn<Hn.length;vn++){var $n=Hn[vn];Sr=Math.min(Sr,$n.x),Vr=Math.max(Vr,$n.x),Br=Math.min(Br,$n.y),Fr=Math.max(Fr,$n.y)}return[Sr,Br,Vr,Fr]},tr.prototype.toGeoJSON=St.prototype.toGeoJSON,gr}();function we(xt){var St=new wt;return function(Lt,tr){for(var nr in Lt.layers)tr.writeMessage(3,Te,Lt.layers[nr])}(xt,St),St.finish()}function Te(xt,St){var Lt;St.writeVarintField(15,xt.version||1),St.writeStringField(1,xt.name||""),St.writeVarintField(5,xt.extent||4096);var tr={keys:[],values:[],keycache:{},valuecache:{}};for(Lt=0;Lt<xt.length;Lt++)tr.feature=xt.feature(Lt),St.writeMessage(2,Ge,tr);var nr=tr.keys;for(Lt=0;Lt<nr.length;Lt++)St.writeStringField(3,nr[Lt]);var Sr=tr.values;for(Lt=0;Lt<Sr.length;Lt++)St.writeMessage(4,bt,Sr[Lt])}function Ge(xt,St){var Lt=xt.feature;Lt.id!==void 0&&St.writeVarintField(1,Lt.id),St.writeMessage(2,He,xt),St.writeVarintField(3,Lt.type),St.writeMessage(4,st,Lt)}function He(xt,St){var Lt=xt.feature,tr=xt.keys,nr=xt.values,Sr=xt.keycache,Vr=xt.valuecache;for(var Br in Lt.properties){var Fr=Lt.properties[Br],Tn=Sr[Br];if(Fr!==null){Tn===void 0&&(tr.push(Br),Sr[Br]=Tn=tr.length-1),St.writeVarint(Tn);var Hn=typeof Fr;Hn!=="string"&&Hn!=="boolean"&&Hn!=="number"&&(Fr=JSON.stringify(Fr));var vn=Hn+":"+Fr,$n=Vr[vn];$n===void 0&&(nr.push(Fr),Vr[vn]=$n=nr.length-1),St.writeVarint($n)}}}function at(xt,St){return(St<<3)+(7&xt)}function mt(xt){return xt<<1^xt>>31}function st(xt,St){for(var Lt=xt.loadGeometry(),tr=xt.type,nr=0,Sr=0,Vr=Lt.length,Br=0;Br<Vr;Br++){var Fr=Lt[Br],Tn=1;tr===1&&(Tn=Fr.length),St.writeVarint(at(1,Tn));for(var Hn=tr===3?Fr.length-1:Fr.length,vn=0;vn<Hn;vn++){vn===1&&tr!==1&&St.writeVarint(at(2,Hn-1));var $n=Fr[vn].x-nr,Pn=Fr[vn].y-Sr;St.writeVarint(mt($n)),St.writeVarint(mt(Pn)),nr+=$n,Sr+=Pn}tr===3&&St.writeVarint(at(7,1))}}function bt(xt,St){var Lt=typeof xt;Lt==="string"?St.writeStringField(1,xt):Lt==="boolean"?St.writeBooleanField(7,xt):Lt==="number"&&(xt%1!=0?St.writeDoubleField(3,xt):xt<0?St.writeSVarintField(6,xt):St.writeVarintField(5,xt))}return br.exports=we,br.exports.fromVectorTileJs=we,br.exports.fromGeojsonVt=function(xt,St){St=St||{};var Lt={};for(var tr in xt)Lt[tr]=new ge(xt[tr].features,St),Lt[tr].name=tr,Lt[tr].version=St.version,Lt[tr].extent=St.extent;return we({layers:Lt})},br.exports.GeoJSONWrapper=ge,br.exports}(),Be=i.e9(Wt);const Nr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:wt=>wt},Jt=Math.fround||(Sn=new Float32Array(1),wt=>(Sn[0]=+wt,Sn[0]));var Sn;const It=3,Vn=5,Un=6;class Xr{constructor(ge){this.options=Object.assign(Object.create(Nr),ge),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ge){const{log:we,minZoom:Te,maxZoom:Ge}=this.options;we&&console.time("total time");const He=`prepare ${ge.length} points`;we&&console.time(He),this.points=ge;const at=[];for(let st=0;st<ge.length;st++){const bt=ge[st];if(!bt.geometry)continue;const[xt,St]=bt.geometry.coordinates,Lt=Jt(Kt(xt)),tr=Jt(Pr(St));at.push(Lt,tr,1/0,st,-1,1),this.options.reduce&&at.push(0)}let mt=this.trees[Ge+1]=this._createTree(at);we&&console.timeEnd(He);for(let st=Ge;st>=Te;st--){const bt=+Date.now();mt=this.trees[st]=this._createTree(this._cluster(mt,st)),we&&console.log("z%d: %d clusters in %dms",st,mt.numItems,+Date.now()-bt)}return we&&console.timeEnd("total time"),this}getClusters(ge,we){let Te=((ge[0]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,ge[1]));let He=ge[2]===180?180:((ge[2]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,ge[3]));if(ge[2]-ge[0]>=360)Te=-180,He=180;else if(Te>He){const St=this.getClusters([Te,Ge,180,at],we),Lt=this.getClusters([-180,Ge,He,at],we);return St.concat(Lt)}const mt=this.trees[this._limitZoom(we)],st=mt.range(Kt(Te),Pr(at),Kt(He),Pr(Ge)),bt=mt.data,xt=[];for(const St of st){const Lt=this.stride*St;xt.push(bt[Lt+Vn]>1?rt(bt,Lt,this.clusterProps):this.points[bt[Lt+It]])}return xt}getChildren(ge){const we=this._getOriginId(ge),Te=this._getOriginZoom(ge),Ge="No cluster with the specified id.",He=this.trees[Te];if(!He)throw new Error(Ge);const at=He.data;if(we*this.stride>=at.length)throw new Error(Ge);const mt=this.options.radius/(this.options.extent*Math.pow(2,Te-1)),st=He.within(at[we*this.stride],at[we*this.stride+1],mt),bt=[];for(const xt of st){const St=xt*this.stride;at[St+4]===ge&&bt.push(at[St+Vn]>1?rt(at,St,this.clusterProps):this.points[at[St+It]])}if(bt.length===0)throw new Error(Ge);return bt}getLeaves(ge,we,Te){const Ge=[];return this._appendLeaves(Ge,ge,we=we||10,Te=Te||0,0),Ge}getTile(ge,we,Te){const Ge=this.trees[this._limitZoom(ge)],He=Math.pow(2,ge),{extent:at,radius:mt}=this.options,st=mt/at,bt=(Te-st)/He,xt=(Te+1+st)/He,St={features:[]};return this._addTileFeatures(Ge.range((we-st)/He,bt,(we+1+st)/He,xt),Ge.data,we,Te,He,St),we===0&&this._addTileFeatures(Ge.range(1-st/He,bt,1,xt),Ge.data,He,Te,He,St),we===He-1&&this._addTileFeatures(Ge.range(0,bt,st/He,xt),Ge.data,-1,Te,He,St),St.features.length?St:null}getClusterExpansionZoom(ge){let we=this._getOriginZoom(ge)-1;for(;we<=this.options.maxZoom;){const Te=this.getChildren(ge);if(we++,Te.length!==1)break;ge=Te[0].properties.cluster_id}return we}_appendLeaves(ge,we,Te,Ge,He){const at=this.getChildren(we);for(const mt of at){const st=mt.properties;if(st&&st.cluster?He+st.point_count<=Ge?He+=st.point_count:He=this._appendLeaves(ge,st.cluster_id,Te,Ge,He):He<Ge?He++:ge.push(mt),ge.length===Te)break}return He}_createTree(ge){const we=new i.bE(ge.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Te=0;Te<ge.length;Te+=this.stride)we.add(ge[Te],ge[Te+1]);return we.finish(),we.data=ge,we}_addTileFeatures(ge,we,Te,Ge,He,at){for(const mt of ge){const st=mt*this.stride,bt=we[st+Vn]>1;let xt,St,Lt;if(bt)xt=Ot(we,st,this.clusterProps),St=we[st],Lt=we[st+1];else{const Sr=this.points[we[st+It]];xt=Sr.properties;const[Vr,Br]=Sr.geometry.coordinates;St=Kt(Vr),Lt=Pr(Br)}const tr={type:1,geometry:[[Math.round(this.options.extent*(St*He-Te)),Math.round(this.options.extent*(Lt*He-Ge))]],tags:xt};let nr;nr=bt||this.options.generateId?we[st+It]:this.points[we[st+It]].id,nr!==void 0&&(tr.id=nr),at.features.push(tr)}}_limitZoom(ge){return Math.max(this.options.minZoom,Math.min(Math.floor(+ge),this.options.maxZoom+1))}_cluster(ge,we){const{radius:Te,extent:Ge,reduce:He,minPoints:at}=this.options,mt=Te/(Ge*Math.pow(2,we)),st=ge.data,bt=[],xt=this.stride;for(let St=0;St<st.length;St+=xt){if(st[St+2]<=we)continue;st[St+2]=we;const Lt=st[St],tr=st[St+1],nr=ge.within(st[St],st[St+1],mt),Sr=st[St+Vn];let Vr=Sr;for(const Br of nr){const Fr=Br*xt;st[Fr+2]>we&&(Vr+=st[Fr+Vn])}if(Vr>Sr&&Vr>=at){let Br,Fr=Lt*Sr,Tn=tr*Sr,Hn=-1;const vn=(St/xt<<5)+(we+1)+this.points.length;for(const $n of nr){const Pn=$n*xt;if(st[Pn+2]<=we)continue;st[Pn+2]=we;const Oa=st[Pn+Vn];Fr+=st[Pn]*Oa,Tn+=st[Pn+1]*Oa,st[Pn+4]=vn,He&&(Br||(Br=this._map(st,St,!0),Hn=this.clusterProps.length,this.clusterProps.push(Br)),He(Br,this._map(st,Pn)))}st[St+4]=vn,bt.push(Fr/Vr,Tn/Vr,1/0,vn,-1,Vr),He&&bt.push(Hn)}else{for(let Br=0;Br<xt;Br++)bt.push(st[St+Br]);if(Vr>1)for(const Br of nr){const Fr=Br*xt;if(!(st[Fr+2]<=we)){st[Fr+2]=we;for(let Tn=0;Tn<xt;Tn++)bt.push(st[Fr+Tn])}}}}return bt}_getOriginId(ge){return ge-this.points.length>>5}_getOriginZoom(ge){return(ge-this.points.length)%32}_map(ge,we,Te){if(ge[we+Vn]>1){const at=this.clusterProps[ge[we+Un]];return Te?Object.assign({},at):at}const Ge=this.points[ge[we+It]].properties,He=this.options.map(Ge);return Te&&He===Ge?Object.assign({},He):He}}function rt(wt,ge,we){return{type:"Feature",id:wt[ge+It],properties:Ot(wt,ge,we),geometry:{type:"Point",coordinates:[(Te=wt[ge],360*(Te-.5)),yr(wt[ge+1])]}};var Te}function Ot(wt,ge,we){const Te=wt[ge+Vn],Ge=Te>=1e4?`${Math.round(Te/1e3)}k`:Te>=1e3?Math.round(Te/100)/10+"k":Te,He=wt[ge+Un],at=He===-1?{}:Object.assign({},we[He]);return Object.assign(at,{cluster:!0,cluster_id:wt[ge+It],point_count:Te,point_count_abbreviated:Ge})}function Kt(wt){return wt/360+.5}function Pr(wt){const ge=Math.sin(wt*Math.PI/180),we=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return we<0?0:we>1?1:we}function yr(wt){const ge=(180-360*wt)*Math.PI/180;return 360*Math.atan(Math.exp(ge))/Math.PI-90}function wr(wt,ge,we,Te){let Ge=Te;const He=ge+(we-ge>>1);let at,mt=we-ge;const st=wt[ge],bt=wt[ge+1],xt=wt[we],St=wt[we+1];for(let Lt=ge+3;Lt<we;Lt+=3){const tr=dr(wt[Lt],wt[Lt+1],st,bt,xt,St);if(tr>Ge)at=Lt,Ge=tr;else if(tr===Ge){const nr=Math.abs(Lt-He);nr<mt&&(at=Lt,mt=nr)}}Ge>Te&&(at-ge>3&&wr(wt,ge,at,Te),wt[at+2]=Ge,we-at>3&&wr(wt,at,we,Te))}function dr(wt,ge,we,Te,Ge,He){let at=Ge-we,mt=He-Te;if(at!==0||mt!==0){const st=((wt-we)*at+(ge-Te)*mt)/(at*at+mt*mt);st>1?(we=Ge,Te=He):st>0&&(we+=at*st,Te+=mt*st)}return at=wt-we,mt=ge-Te,at*at+mt*mt}function An(wt,ge,we,Te){const Ge={id:wt??null,type:ge,geometry:we,tags:Te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ge==="Point"||ge==="MultiPoint"||ge==="LineString")Ti(Ge,we);else if(ge==="Polygon")Ti(Ge,we[0]);else if(ge==="MultiLineString")for(const He of we)Ti(Ge,He);else if(ge==="MultiPolygon")for(const He of we)Ti(Ge,He[0]);return Ge}function Ti(wt,ge){for(let we=0;we<ge.length;we+=3)wt.minX=Math.min(wt.minX,ge[we]),wt.minY=Math.min(wt.minY,ge[we+1]),wt.maxX=Math.max(wt.maxX,ge[we]),wt.maxY=Math.max(wt.maxY,ge[we+1])}function Bi(wt,ge,we,Te){if(!ge.geometry)return;const Ge=ge.geometry.coordinates;if(Ge&&Ge.length===0)return;const He=ge.geometry.type,at=Math.pow(we.tolerance/((1<<we.maxZoom)*we.extent),2);let mt=[],st=ge.id;if(we.promoteId?st=ge.properties[we.promoteId]:we.generateId&&(st=Te||0),He==="Point")Vi(Ge,mt);else if(He==="MultiPoint")for(const bt of Ge)Vi(bt,mt);else if(He==="LineString")is(Ge,mt,at,!1);else if(He==="MultiLineString"){if(we.lineMetrics){for(const bt of Ge)mt=[],is(bt,mt,at,!1),wt.push(An(st,"LineString",mt,ge.properties));return}$a(Ge,mt,at,!1)}else if(He==="Polygon")$a(Ge,mt,at,!0);else{if(He!=="MultiPolygon"){if(He==="GeometryCollection"){for(const bt of ge.geometry.geometries)Bi(wt,{id:st,geometry:bt,properties:ge.properties},we,Te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const bt of Ge){const xt=[];$a(bt,xt,at,!0),mt.push(xt)}}wt.push(An(st,He,mt,ge.properties))}function Vi(wt,ge){ge.push(Vo(wt[0]),ys(wt[1]),0)}function is(wt,ge,we,Te){let Ge,He,at=0;for(let st=0;st<wt.length;st++){const bt=Vo(wt[st][0]),xt=ys(wt[st][1]);ge.push(bt,xt,0),st>0&&(at+=Te?(Ge*xt-bt*He)/2:Math.sqrt(Math.pow(bt-Ge,2)+Math.pow(xt-He,2))),Ge=bt,He=xt}const mt=ge.length-3;ge[2]=1,wr(ge,0,mt,we),ge[mt+2]=1,ge.size=Math.abs(at),ge.start=0,ge.end=ge.size}function $a(wt,ge,we,Te){for(let Ge=0;Ge<wt.length;Ge++){const He=[];is(wt[Ge],He,we,Te),ge.push(He)}}function Vo(wt){return wt/360+.5}function ys(wt){const ge=Math.sin(wt*Math.PI/180),we=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return we<0?0:we>1?1:we}function Qa(wt,ge,we,Te,Ge,He,at,mt){if(Te/=ge,He>=(we/=ge)&&at<Te)return wt;if(at<we||He>=Te)return null;const st=[];for(const bt of wt){const xt=bt.geometry;let St=bt.type;const Lt=Ge===0?bt.minX:bt.minY,tr=Ge===0?bt.maxX:bt.maxY;if(Lt>=we&&tr<Te){st.push(bt);continue}if(tr<we||Lt>=Te)continue;let nr=[];if(St==="Point"||St==="MultiPoint")$l(xt,nr,we,Te,Ge);else if(St==="LineString")_l(xt,nr,we,Te,Ge,!1,mt.lineMetrics);else if(St==="MultiLineString")ql(xt,nr,we,Te,Ge,!1);else if(St==="Polygon")ql(xt,nr,we,Te,Ge,!0);else if(St==="MultiPolygon")for(const Sr of xt){const Vr=[];ql(Sr,Vr,we,Te,Ge,!0),Vr.length&&nr.push(Vr)}if(nr.length){if(mt.lineMetrics&&St==="LineString"){for(const Sr of nr)st.push(An(bt.id,St,Sr,bt.tags));continue}St!=="LineString"&&St!=="MultiLineString"||(nr.length===1?(St="LineString",nr=nr[0]):St="MultiLineString"),St!=="Point"&&St!=="MultiPoint"||(St=nr.length===3?"Point":"MultiPoint"),st.push(An(bt.id,St,nr,bt.tags))}}return st.length?st:null}function $l(wt,ge,we,Te,Ge){for(let He=0;He<wt.length;He+=3){const at=wt[He+Ge];at>=we&&at<=Te&&rn(ge,wt[He],wt[He+1],wt[He+2])}}function _l(wt,ge,we,Te,Ge,He,at){let mt=jo(wt);const st=Ge===0?eo:ku;let bt,xt,St=wt.start;for(let Vr=0;Vr<wt.length-3;Vr+=3){const Br=wt[Vr],Fr=wt[Vr+1],Tn=wt[Vr+2],Hn=wt[Vr+3],vn=wt[Vr+4],$n=Ge===0?Br:Fr,Pn=Ge===0?Hn:vn;let Oa=!1;at&&(bt=Math.sqrt(Math.pow(Br-Hn,2)+Math.pow(Fr-vn,2))),$n<we?Pn>we&&(xt=st(mt,Br,Fr,Hn,vn,we),at&&(mt.start=St+bt*xt)):$n>Te?Pn<Te&&(xt=st(mt,Br,Fr,Hn,vn,Te),at&&(mt.start=St+bt*xt)):rn(mt,Br,Fr,Tn),Pn<we&&$n>=we&&(xt=st(mt,Br,Fr,Hn,vn,we),Oa=!0),Pn>Te&&$n<=Te&&(xt=st(mt,Br,Fr,Hn,vn,Te),Oa=!0),!He&&Oa&&(at&&(mt.end=St+bt*xt),ge.push(mt),mt=jo(wt)),at&&(St+=bt)}let Lt=wt.length-3;const tr=wt[Lt],nr=wt[Lt+1],Sr=Ge===0?tr:nr;Sr>=we&&Sr<=Te&&rn(mt,tr,nr,wt[Lt+2]),Lt=mt.length-3,He&&Lt>=3&&(mt[Lt]!==mt[0]||mt[Lt+1]!==mt[1])&&rn(mt,mt[0],mt[1],mt[2]),mt.length&&ge.push(mt)}function jo(wt){const ge=[];return ge.size=wt.size,ge.start=wt.start,ge.end=wt.end,ge}function ql(wt,ge,we,Te,Ge,He){for(const at of wt)_l(at,ge,we,Te,Ge,He,!1)}function rn(wt,ge,we,Te){wt.push(ge,we,Te)}function eo(wt,ge,we,Te,Ge,He){const at=(He-ge)/(Te-ge);return rn(wt,He,we+(Ge-we)*at,1),at}function ku(wt,ge,we,Te,Ge,He){const at=(He-we)/(Ge-we);return rn(wt,ge+(Te-ge)*at,He,1),at}function qa(wt,ge){const we=[];for(let Te=0;Te<wt.length;Te++){const Ge=wt[Te],He=Ge.type;let at;if(He==="Point"||He==="MultiPoint"||He==="LineString")at=Uo(Ge.geometry,ge);else if(He==="MultiLineString"||He==="Polygon"){at=[];for(const mt of Ge.geometry)at.push(Uo(mt,ge))}else if(He==="MultiPolygon"){at=[];for(const mt of Ge.geometry){const st=[];for(const bt of mt)st.push(Uo(bt,ge));at.push(st)}}we.push(An(Ge.id,He,at,Ge.tags))}return we}function Uo(wt,ge){const we=[];we.size=wt.size,wt.start!==void 0&&(we.start=wt.start,we.end=wt.end);for(let Te=0;Te<wt.length;Te+=3)we.push(wt[Te]+ge,wt[Te+1],wt[Te+2]);return we}function Kn(wt,ge){if(wt.transformed)return wt;const we=1<<wt.z,Te=wt.x,Ge=wt.y;for(const He of wt.features){const at=He.geometry,mt=He.type;if(He.geometry=[],mt===1)for(let st=0;st<at.length;st+=2)He.geometry.push(fa(at[st],at[st+1],ge,we,Te,Ge));else for(let st=0;st<at.length;st++){const bt=[];for(let xt=0;xt<at[st].length;xt+=2)bt.push(fa(at[st][xt],at[st][xt+1],ge,we,Te,Ge));He.geometry.push(bt)}}return wt.transformed=!0,wt}function fa(wt,ge,we,Te,Ge,He){return[Math.round(we*(wt*Te-Ge)),Math.round(we*(ge*Te-He))]}function Ca(wt,ge,we,Te,Ge){const He=ge===Ge.maxZoom?0:Ge.tolerance/((1<<ge)*Ge.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:wt.length,source:null,x:we,y:Te,z:ge,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const mt of wt)wo(at,mt,He,Ge);return at}function wo(wt,ge,we,Te){const Ge=ge.geometry,He=ge.type,at=[];if(wt.minX=Math.min(wt.minX,ge.minX),wt.minY=Math.min(wt.minY,ge.minY),wt.maxX=Math.max(wt.maxX,ge.maxX),wt.maxY=Math.max(wt.maxY,ge.maxY),He==="Point"||He==="MultiPoint")for(let mt=0;mt<Ge.length;mt+=3)at.push(Ge[mt],Ge[mt+1]),wt.numPoints++,wt.numSimplified++;else if(He==="LineString")xl(at,Ge,wt,we,!1,!1);else if(He==="MultiLineString"||He==="Polygon")for(let mt=0;mt<Ge.length;mt++)xl(at,Ge[mt],wt,we,He==="Polygon",mt===0);else if(He==="MultiPolygon")for(let mt=0;mt<Ge.length;mt++){const st=Ge[mt];for(let bt=0;bt<st.length;bt++)xl(at,st[bt],wt,we,!0,bt===0)}if(at.length){let mt=ge.tags||null;if(He==="LineString"&&Te.lineMetrics){mt={};for(const bt in ge.tags)mt[bt]=ge.tags[bt];mt.mapbox_clip_start=Ge.start/Ge.size,mt.mapbox_clip_end=Ge.end/Ge.size}const st={geometry:at,type:He==="Polygon"||He==="MultiPolygon"?3:He==="LineString"||He==="MultiLineString"?2:1,tags:mt};ge.id!==null&&(st.id=ge.id),wt.features.push(st)}}function xl(wt,ge,we,Te,Ge,He){const at=Te*Te;if(Te>0&&ge.size<(Ge?at:Te))return void(we.numPoints+=ge.length/3);const mt=[];for(let st=0;st<ge.length;st+=3)(Te===0||ge[st+2]>at)&&(we.numSimplified++,mt.push(ge[st],ge[st+1])),we.numPoints++;Ge&&function(st,bt){let xt=0;for(let St=0,Lt=st.length,tr=Lt-2;St<Lt;tr=St,St+=2)xt+=(st[St]-st[tr])*(st[St+1]+st[tr+1]);if(xt>0===bt)for(let St=0,Lt=st.length;St<Lt/2;St+=2){const tr=st[St],nr=st[St+1];st[St]=st[Lt-2-St],st[St+1]=st[Lt-1-St],st[Lt-2-St]=tr,st[Lt-1-St]=nr}}(mt,He),wt.push(mt)}const Ma={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class No{constructor(ge,we){const Te=(we=this.options=function(He,at){for(const mt in at)He[mt]=at[mt];return He}(Object.create(Ma),we)).debug;if(Te&&console.time("preprocess data"),we.maxZoom<0||we.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(we.promoteId&&we.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ge=function(He,at){const mt=[];if(He.type==="FeatureCollection")for(let st=0;st<He.features.length;st++)Bi(mt,He.features[st],at,st);else Bi(mt,He.type==="Feature"?He:{geometry:He},at);return mt}(ge,we);this.tiles={},this.tileCoords=[],Te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",we.indexMaxZoom,we.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ge=function(He,at){const mt=at.buffer/at.extent;let st=He;const bt=Qa(He,1,-1-mt,mt,0,-1,2,at),xt=Qa(He,1,1-mt,2+mt,0,-1,2,at);return(bt||xt)&&(st=Qa(He,1,-mt,1+mt,0,-1,2,at)||[],bt&&(st=qa(bt,1).concat(st)),xt&&(st=st.concat(qa(xt,-1)))),st}(Ge,we),Ge.length&&this.splitTile(Ge,0,0,0),Te&&(Ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ge,we,Te,Ge,He,at,mt){const st=[ge,we,Te,Ge],bt=this.options,xt=bt.debug;for(;st.length;){Ge=st.pop(),Te=st.pop(),we=st.pop(),ge=st.pop();const St=1<<we,Lt=Ui(we,Te,Ge);let tr=this.tiles[Lt];if(!tr&&(xt>1&&console.time("creation"),tr=this.tiles[Lt]=Ca(ge,we,Te,Ge,bt),this.tileCoords.push({z:we,x:Te,y:Ge}),xt)){xt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",we,Te,Ge,tr.numFeatures,tr.numPoints,tr.numSimplified),console.timeEnd("creation"));const Oa=`z${we}`;this.stats[Oa]=(this.stats[Oa]||0)+1,this.total++}if(tr.source=ge,He==null){if(we===bt.indexMaxZoom||tr.numPoints<=bt.indexMaxPoints)continue}else{if(we===bt.maxZoom||we===He)continue;if(He!=null){const Oa=He-we;if(Te!==at>>Oa||Ge!==mt>>Oa)continue}}if(tr.source=null,ge.length===0)continue;xt>1&&console.time("clipping");const nr=.5*bt.buffer/bt.extent,Sr=.5-nr,Vr=.5+nr,Br=1+nr;let Fr=null,Tn=null,Hn=null,vn=null,$n=Qa(ge,St,Te-nr,Te+Vr,0,tr.minX,tr.maxX,bt),Pn=Qa(ge,St,Te+Sr,Te+Br,0,tr.minX,tr.maxX,bt);ge=null,$n&&(Fr=Qa($n,St,Ge-nr,Ge+Vr,1,tr.minY,tr.maxY,bt),Tn=Qa($n,St,Ge+Sr,Ge+Br,1,tr.minY,tr.maxY,bt),$n=null),Pn&&(Hn=Qa(Pn,St,Ge-nr,Ge+Vr,1,tr.minY,tr.maxY,bt),vn=Qa(Pn,St,Ge+Sr,Ge+Br,1,tr.minY,tr.maxY,bt),Pn=null),xt>1&&console.timeEnd("clipping"),st.push(Fr||[],we+1,2*Te,2*Ge),st.push(Tn||[],we+1,2*Te,2*Ge+1),st.push(Hn||[],we+1,2*Te+1,2*Ge),st.push(vn||[],we+1,2*Te+1,2*Ge+1)}}getTile(ge,we,Te){ge=+ge,we=+we,Te=+Te;const Ge=this.options,{extent:He,debug:at}=Ge;if(ge<0||ge>24)return null;const mt=1<<ge,st=Ui(ge,we=we+mt&mt-1,Te);if(this.tiles[st])return Kn(this.tiles[st],He);at>1&&console.log("drilling down to z%d-%d-%d",ge,we,Te);let bt,xt=ge,St=we,Lt=Te;for(;!bt&&xt>0;)xt--,St>>=1,Lt>>=1,bt=this.tiles[Ui(xt,St,Lt)];return bt&&bt.source?(at>1&&(console.log("found parent tile z%d-%d-%d",xt,St,Lt),console.time("drilling down")),this.splitTile(bt.source,xt,St,Lt,ge,we,Te),at>1&&console.timeEnd("drilling down"),this.tiles[st]?Kn(this.tiles[st],He):null):null}}function Ui(wt,ge,we){return 32*((1<<wt)*we+ge)+wt}function So(wt,ge){const we=wt.tileID.canonical;if(!this._geoJSONIndex)return void ge(null,null);const Te=this._geoJSONIndex.getTile(we.z,we.x,we.y);if(!Te)return void ge(null,null);const Ge=new et(Te.features);let He=Be(Ge);He.byteOffset===0&&He.byteLength===He.buffer.byteLength||(He=new Uint8Array(He)),ge(null,{vectorTile:Ge,rawData:He.buffer})}class uo extends Ae{constructor(ge,we,Te,Ge,He,at){super(ge,we,Te,Ge,So,at),He&&(this.loadGeoJSON=He),this._dynamicIndex=new Ye}loadData(ge,we){const Te=ge&&ge.request,Ge=Te&&Te.collectResourceTiming;this.loadGeoJSON(ge,(He,at)=>{if(He||!at)return we(He);if(typeof at!="object")return we(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));{try{if(ge.filter){const st=i.U(ge.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(st.result==="error")throw new Error(st.value.map(bt=>`${bt.key}: ${bt.message}`).join(", "));at.features=at.features.filter(bt=>st.value.evaluate({zoom:0},bt))}ge.dynamic?(at.type==="Feature"&&(at={type:"FeatureCollection",features:[at]}),ge.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(at.features,this.loaded),ge.cluster&&(at.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ge.cluster?new Xr(function({superclusterOptions:st,clusterProperties:bt}){if(!bt||!st)return st;const xt={},St={},Lt={accumulated:null,zoom:0},tr={properties:null},nr=Object.keys(bt);for(const Sr of nr){const[Vr,Br]=bt[Sr],Fr=i.U(Br),Tn=i.U(typeof Vr=="string"?[Vr,["accumulated"],["get",Sr]]:Vr);xt[Sr]=Fr.value,St[Sr]=Tn.value}return st.map=Sr=>{tr.properties=Sr;const Vr={};for(const Br of nr)Vr[Br]=xt[Br].evaluate(Lt,tr);return Vr},st.reduce=(Sr,Vr)=>{tr.properties=Vr;for(const Br of nr)Lt.accumulated=Sr[Br],Sr[Br]=St[Br].evaluate(Lt,tr)},st}(ge)).load(at.features):ge.dynamic?this._dynamicIndex:function(st,bt){return new No(st,bt)}(at,ge.geojsonVtOptions)}catch(st){return we(st)}const mt={};if(Ge){const st=_(Te);st&&(mt.resourceTiming={},mt.resourceTiming[ge.source]=JSON.parse(JSON.stringify(st)))}we(null,mt)}})}reloadTile(ge,we){const Te=this.loaded;return Te&&Te[ge.uid]?ge.partial?we(null,void 0):super.reloadTile(ge,we):this.loadTile(ge,we)}loadGeoJSON(ge,we){if(ge.request)i.n(ge.request,we);else{if(typeof ge.data!="string")return we(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));try{return we(null,JSON.parse(ge.data))}catch{return we(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ge,we){try{we(null,this._geoJSONIndex.getClusterExpansionZoom(ge.clusterId))}catch(Te){we(Te)}}getClusterChildren(ge,we){try{we(null,this._geoJSONIndex.getChildren(ge.clusterId))}catch(Te){we(Te)}}getClusterLeaves(ge,we){try{we(null,this._geoJSONIndex.getLeaves(ge.clusterId,ge.limit,ge.offset))}catch(Te){we(Te)}}}class ju{constructor(ge,we){this.tileID=new i.aG(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),this.tileZoom=ge.tileZoom,this.uid=ge.uid,this.zoom=ge.zoom,this.canonical=ge.tileID.canonical,this.pixelRatio=ge.pixelRatio,this.tileSize=ge.tileSize,this.source=ge.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ge.projection,this.brightness=we}parse(ge,we,Te,Ge){this.status="parsing";const He=new i.aG(Te.tileID.overscaledZ,Te.tileID.wrap,Te.tileID.canonical.z,Te.tileID.canonical.x,Te.tileID.canonical.y),at=[],mt=we.familiesBySource[Te.source],st=new i.d$(He,Te.promoteId);return st.bucketLayerIDs=[],st.is3DTile=!0,i.ea(ge).then(bt=>{if(!bt)return Ge(new Error("Could not parse tile"));const xt=i.eb(bt,1/i.cc(Te.tileID.canonical)),St=bt.json.extensionsUsed&&bt.json.extensionsUsed.includes("MAPBOX_mesh_features")||bt.json.asset.extras&&bt.json.asset.extras.MAPBOX_mesh_features,Lt=bt.json.extensionsUsed&&bt.json.extensionsUsed.includes("EXT_meshopt_compression"),tr=new i.a8(this.zoom,{brightness:this.brightness});for(const nr in mt)for(const Sr of mt[nr]){const Vr=Sr[0];st.bucketLayerIDs.push(Sr.map(Fr=>i.aC(Fr.id,Fr.scope))),Vr.recalculate(tr,[]);const Br=new i.ec(Sr,xt,He,St,Lt,this.brightness,st);St||(Br.needsUpload=!0),at.push(Br),Br.evaluate(Vr)}this.status="done",Ge(null,{buckets:at,featureIndex:st,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(bt=>Ge(new Error(bt.message)))}}class Wi{constructor(ge,we,Te,Ge,He,at){this.actor=ge,this.layerIndex=we,this.availableImages=Te,this.brightness=at,this.loading={},this.loaded={}}loadTile(ge,we){const Te=ge.uid,Ge=this.loading[Te]=new ju(ge,this.brightness);i.bi(ge.request,(He,at)=>{const mt=!this.loading[Te];return delete this.loading[Te],mt||He?(Ge.status="done",mt||(this.loaded[Te]=Ge),we(He)):at&&at.byteLength!==0?void Ge.parse(at,this.layerIndex,ge,(st,bt)=>{Ge.status="done",this.loaded=this.loaded||{},this.loaded[Te]=Ge,st||!bt?we(st):we(null,bt)}):(Ge.status="done",this.loaded[Te]=Ge,we())})}reloadTile(ge,we){const Te=this.loaded,Ge=ge.uid;if(Te&&Te[Ge]){const He=Te[Ge];He.projection=ge.projection,He.brightness=ge.brightness;const at=(mt,st)=>{He.reloadCallback&&(delete He.reloadCallback,this.loadTile(ge,we)),we(mt,st)};He.status==="parsing"?He.reloadCallback=at:He.status==="done"&&this.loadTile(ge,we)}}abortTile(ge,we){const Te=ge.uid;this.loading[Te]&&delete this.loading[Te],we()}removeTile(ge,we){const Te=this.loaded,Ge=ge.uid;Te&&Te[Ge]&&delete Te[Ge],we()}}class Ds{constructor(ge){this.self=ge,this.actor=new i.ed(ge,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:Ae,geojson:uo,"batched-model":Wi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(we,Te)=>{if(this.workerSourceTypes[we])throw new Error(`Worker source with name "${we}" already registered.`);this.workerSourceTypes[we]=Te},this.self.registerRTLTextPlugin=we=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=we.applyArabicShaping,i.ee.processBidirectionalText=we.processBidirectionalText,i.ee.processStyledBidirectionalText=we.processStyledBidirectionalText}}clearCaches(ge,we,Te){delete this.layerIndexes[ge],delete this.availableImages[ge],delete this.workerSources[ge],delete this.demWorkerSources[ge],delete this.rasterArrayWorkerSource,Te()}checkIfReady(ge,we,Te){Te()}setReferrer(ge,we){this.referrer=we}spriteLoaded(ge,{scope:we,isLoaded:Te}){if(this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.isSpriteLoaded[ge][we]=Te,this.workerSources[ge]&&this.workerSources[ge][we])for(const Ge in this.workerSources[ge][we]){const He=this.workerSources[ge][we][Ge];for(const at in He){const mt=He[at];mt instanceof Ae&&(mt.isSpriteLoaded=Te,mt.fire(new i.z("isSpriteLoaded")))}}}setImages(ge,{scope:we,images:Te},Ge){if(this.availableImages[ge]||(this.availableImages[ge]={}),this.availableImages[ge][we]=Te,this.workerSources[ge]&&this.workerSources[ge][we]){for(const He in this.workerSources[ge][we]){const at=this.workerSources[ge][we][He];for(const mt in at)at[mt].availableImages=Te}Ge()}else Ge()}setProjection(ge,we){this.projections[ge]=i.bP(we)}setBrightness(ge,we,Te){this.brightness=we,Te()}setLayers(ge,we,Te){this.getLayerIndex(ge,we.scope).replace(we.layers,we.options),Te()}updateLayers(ge,we,Te){this.getLayerIndex(ge,we.scope).update(we.layers,we.removedIds,we.options),Te()}loadTile(ge,we,Te){we.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,we.type,we.source,we.scope).loadTile(we,Te)}loadDEMTile(ge,we,Te){this.getDEMWorkerSource(ge,we.source,we.scope).loadTile(we,Te)}decodeRasterArray(ge,we,Te){this.getRasterArrayWorkerSource().decodeRasterArray(we,Te)}reloadTile(ge,we,Te){we.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,we.type,we.source,we.scope).reloadTile(we,Te)}abortTile(ge,we,Te){this.getWorkerSource(ge,we.type,we.source,we.scope).abortTile(we,Te)}removeTile(ge,we,Te){this.getWorkerSource(ge,we.type,we.source,we.scope).removeTile(we,Te)}removeSource(ge,we,Te){if(!(this.workerSources[ge]&&this.workerSources[ge][we.scope]&&this.workerSources[ge][we.scope][we.type]&&this.workerSources[ge][we.scope][we.type][we.source]))return;const Ge=this.workerSources[ge][we.scope][we.type][we.source];delete this.workerSources[ge][we.scope][we.type][we.source],Ge.removeSource!==void 0?Ge.removeSource(we,Te):Te()}loadWorkerSource(ge,we,Te){try{this.self.importScripts(we.url),Te()}catch(Ge){Te(Ge.toString())}}syncRTLPluginState(ge,we,Te){try{i.ee.setState(we);const Ge=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&Ge!=null){this.self.importScripts(Ge);const He=i.ee.isParsed();Te(He?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ge}`),He)}}catch(Ge){Te(Ge.toString())}}setDracoUrl(ge,we){this.dracoUrl=we}getAvailableImages(ge,we){this.availableImages[ge]||(this.availableImages[ge]={});let Te=this.availableImages[ge][we];return Te||(Te=[]),Te}getLayerIndex(ge,we){this.layerIndexes[ge]||(this.layerIndexes[ge]={});let Te=this.layerIndexes[ge][we];return Te||(Te=this.layerIndexes[ge][we]=new C,Te.scope=we),Te}getWorkerSource(ge,we,Te,Ge){return this.workerSources[ge]||(this.workerSources[ge]={}),this.workerSources[ge][Ge]||(this.workerSources[ge][Ge]={}),this.workerSources[ge][Ge][we]||(this.workerSources[ge][Ge][we]={}),this.isSpriteLoaded[ge]||(this.isSpriteLoaded[ge]={}),this.workerSources[ge][Ge][we][Te]||(this.workerSources[ge][Ge][we][Te]=new this.workerSourceTypes[we]({send:(He,at,mt,st,bt,xt)=>{this.actor.send(He,at,mt,ge,bt,xt)},scheduler:this.actor.scheduler},this.getLayerIndex(ge,Ge),this.getAvailableImages(ge,Ge),this.isSpriteLoaded[ge][Ge],void 0,this.brightness)),this.workerSources[ge][Ge][we][Te]}rasterizeImages(ge,we,Te){const{imageTasks:Ge,scope:He}=we,at={};for(const mt in Ge){const{image:st,imageIdWithOptions:bt}=Ge[mt];at[mt]=this.imageRasterizer.rasterize(bt,st,He,ge)}Te(void 0,at)}removeRasterizedImages(ge,we,Te){const{imageIds:Ge,scope:He}=we;this.imageRasterizer.removeImagesFromCacheByIds(Ge,He,ge),Te()}getDEMWorkerSource(ge,we,Te){return this.demWorkerSources[ge]||(this.demWorkerSources[ge]={}),this.demWorkerSources[ge][Te]||(this.demWorkerSources[ge][Te]={}),this.demWorkerSources[ge][Te][we]||(this.demWorkerSources[ge][Te][we]=new Oe),this.demWorkerSources[ge][Te][we]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new Se),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ge,we){i.ef(we)}getWorkerPerformanceMetrics(ge,we,Te){Te(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ds(self)),Ds}),l(["./shared"],function(i){var _="3.10.0";const w={create:"create",load:"load",fullLoad:"fullLoad"},A={mark(g){performance.mark(g)},measure(g,s,u){performance.measure(g,s,u)}};function C(g){const s=g.name.split("?")[0];return i.a(s)&&s.includes("mapbox-gl.js")?"javascript":i.a(s)&&s.includes("mapbox-gl.css")?"css":i.b(s)?"fontRange":i.c(s)?"sprite":i.i(s)?"style":i.d(s)?"tilejson":"other"}var R,z={},V=function(){if(R)return z;function g(y){return!s(y)}function s(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var P,O,D=new Blob([""],{type:"text/javascript"}),q=URL.createObjectURL(D);try{O=new Worker(q),P=!0}catch{P=!1}return O&&O.terminate(),URL.revokeObjectURL(q),P}()?function(){var P=document.createElement("canvas");P.width=P.height=1;var O=P.getContext("2d");if(!O)return!1;var D=O.getImageData(0,0,1,1);return D&&D.width===P.width}()?(u[S=y&&y.failIfMajorPerformanceCaveat]===void 0&&(u[S]=function(P){var O,D=function(q){var W=document.createElement("canvas"),Z=Object.create(g.webGLContextAttributes);return Z.failIfMajorPerformanceCaveat=q,W.getContext("webgl2",Z)}(P);if(!D)return!1;try{O=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!O||D.isContextLost())&&(D.shaderSource(O,"void main() {}"),D.compileShader(O),D.getShaderParameter(O,D.COMPILE_STATUS)===!0)}(S)),u[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}R=1,z.supported=g,z.notSupportedReason=s;var u={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},z}();function U(g,s,u){const y=document.createElement(g);return s!=null&&(y.className=s),u&&u.appendChild(y),y}function G(g,s,u){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const S of Object.keys(s))y.setAttributeNS(null,S,String(s[S]));return u&&u.appendChild(y),y}const H=typeof document<"u"?document.documentElement&&document.documentElement.style:null,J=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Q;function le(){H&&J&&(Q=H[J],H[J]="none")}function ne(){H&&J&&(H[J]=Q)}function de(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",de,!0)}function ue(){window.addEventListener("click",de,!0),window.setTimeout(()=>{window.removeEventListener("click",de,!0)},0)}function ve(g,s){const u=g.getBoundingClientRect();return Se(g,u,s)}function Ae(g,s){const u=g.getBoundingClientRect(),y=[];for(let S=0;S<s.length;S++)y.push(Se(g,u,s[S]));return y}function Oe(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function Se(g,s,u){const y=g.offsetWidth===s.width?1:g.offsetWidth/s.width;return new i.P((u.clientX-s.left)*y,(u.clientY-s.top)*y)}const ke="01",ze="NO_ACCESS_TOKEN";class et{constructor(s,u,y){this._transformRequestFn=s,this._customAccessToken=u,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const s=function(){let u="";for(let y=0;y<10;y++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ke,u].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,u){return this._transformRequestFn&&this._transformRequestFn(s,u)||{url:s}}normalizeStyleURL(s,u){if(!i.f(s))return s;const y=Ne(s);return y.params.push(`sdk=js-${_}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeGlyphsURL(s,u){if(!i.f(s))return s;const y=Ne(s);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeModelURL(s,u){if(!i.f(s))return s;const y=Ne(s);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||u)}normalizeSourceURL(s,u,y,S){if(!i.f(s))return s;const P=Ne(s);return P.path=`/v4/${P.authority}.json`,P.params.push("secure"),y&&P.params.push(`language=${y}`),S&&P.params.push(`worldview=${S}`),this._makeAPIURL(P,this._customAccessToken||u)}normalizeIconsetURL(s,u){const y=Ne(s);return i.f(s)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||u)):Ye(y)}normalizeSpriteURL(s,u,y,S){const P=Ne(s);return i.f(s)?(P.path=`/styles/v1${P.path}/sprite${u}${y}`,this._makeAPIURL(P,this._customAccessToken||S)):(P.path+=`${u}${y}`,Ye(P))}normalizeTileURL(s,u,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!i.f(s))return s;const S=Ne(s);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||y&&S.authority!=="raster"&&y===512?"@2x":""}${i.m.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${i.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${i.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${i.e.TILE_URL_VERSION}${S.path}`);const P=this._customAccessToken||function(O){for(const D of O){const q=D.match(/^access_token=(.*)$/);if(q)return q[1]}return null}(S.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&P&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,P)}canonicalizeTileURL(s,u){const y=Ne(s);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return s;let S="mapbox://";y.path.match(/^\/raster\/v1\//)?S+=`raster/${y.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${y.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${y.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let P=y.params;return u&&(P=P.filter(O=>!O.match(/^access_token=/))),P.length&&(S+=`?${P.join("&")}`),S}canonicalizeTileset(s,u){const y=!!u&&i.f(u),S=[];for(const P of s.tiles||[])i.h(P)?S.push(this.canonicalizeTileURL(P,y)):S.push(P);return S}_makeAPIURL(s,u){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=Ne(i.e.API_URL);if(s.protocol=S.protocol,s.authority=S.authority,s.protocol==="http"){const P=s.params.indexOf("secure");P>=0&&s.params.splice(P,1)}if(S.path!=="/"&&(s.path=`${S.path}${s.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Ye(s);if(u=u||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return s.params=s.params.filter(P=>P.indexOf("access_token")===-1),s.params.push(`access_token=${u||""}`),Ye(s)}}const je=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ne(g){const s=g.match(je);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function Ye(g){const s=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${s}`}const $e="mapbox.eventData";function We(g){if(!g)return null;const s=g.split(".");if(!s||s.length!==3)return null;try{return JSON.parse(i.j(s[1]))}catch{return null}}class Et{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const u=We(i.e.ACCESS_TOKEN);let y="";return y=u&&u.u?i.k(u.u):i.e.ACCESS_TOKEN||"",s?`${$e}.${s}:${y}`:`${$e}:${y}`}fetchEventData(){const s=i.s("localStorage"),u=this.getStorageKey(),y=this.getStorageKey("uuid");if(s)try{const S=localStorage.getItem(u);S&&(this.eventData=JSON.parse(S));const P=localStorage.getItem(y);P&&(this.anonId=P)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const s=i.s("localStorage"),u=this.getStorageKey(),y=this.getStorageKey("uuid"),S=this.anonId;if(s&&S)try{localStorage.setItem(y,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,u,y,S){if(!i.e.EVENTS_URL)return;const P=Ne(i.e.EVENTS_URL);P.params.push(`access_token=${S||i.e.ACCESS_TOKEN||""}`);const O={event:this.type,created:new Date(s).toISOString()},D=u?i.l(O,u):O,q={url:Ye(P),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=i.p(q,W=>{this.pendingRequest=null,y(W),this.saveEventData(),this.processRequests(S)})}queueRequest(s,u){this.queue.push(s),this.processRequests(u)}}const Je=new class extends Et{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,s){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(u=>i.f(u)||i.h(u))&&this.queueRequest(Date.now(),s)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=We(i.e.ACCESS_TOKEN),u=s?s.u:i.e.ACCESS_TOKEN;let y=u!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),y=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const P=new Date(this.eventData.lastSuccess),O=new Date(S),D=(S-this.eventData.lastSuccess)/864e5;y=y||D>=1||D<-1||P.getDate()!==O.getDate()}else y=!0;y?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:ke,"enabled.telemetry":!1,userId:this.anonId},P=>{P||(this.eventData.lastSuccess=S,this.eventData.tokenU=u)},g):this.processRequests()}},ht=Je.postTurnstileEvent.bind(Je),tt=new class extends Et{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,s,u,y){this.skuToken=s,this.errorCb=y,i.e.EVENTS_URL&&(u||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},u):this.errorCb(new Error(ze)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:_,skuId:ke,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):s&&(this.success[s]=!0)},g))}remove(){this.errorCb=null}},Qt=tt.postMapLoadEvent.bind(tt),gr=new class extends Et{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let s=this.mapInstanceIdMap.get(g);return s||(s=i.u(),this.mapInstanceIdMap.set(g,s)),s}getEventId(g){const s=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,s+1),s}postStyleLoadEvent(g,s){const{map:u,style:y,importedStyles:S}=s;if(!i.e.EVENTS_URL||!g&&!i.e.ACCESS_TOKEN)return;const P=this.getMapInstanceId(u),O={mapInstanceId:P,eventId:this.getEventId(P),style:y};S.length&&(O.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:O},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,payload:u}=this.queue.shift();this.postEvent(s,u,()=>{},g)}},sr=gr.postStyleLoadEvent.bind(gr),ur=new class extends Et{constructor(){super("gljs.performance")}postPerformanceEvent(g,s){i.e.EVENTS_URL&&(g||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:s,performanceData:u}=this.queue.shift(),y=function(S){const P=performance.getEntriesByType("resource"),O=performance.getEntriesByType("mark"),D=function(ae){const ye={};if(ae){for(const fe in ae)if(fe!=="other")for(const xe of ae[fe]){const _e=`${fe}ResolveRangeMin`,Ee=`${fe}ResolveRangeMax`,Fe=`${fe}RequestCount`,De=`${fe}RequestCachedCount`;ye[_e]=Math.min(ye[_e]||1/0,xe.startTime),ye[Ee]=Math.max(ye[Ee]||-1/0,xe.responseEnd);const Ze=Ue=>{ye[Ue]===void 0&&(ye[Ue]=0),++ye[Ue]};xe.transferSize!==void 0&&xe.transferSize===0&&Ze(De),Ze(Fe)}}return ye}(function(ae,ye){const fe={};if(ae)for(const xe of ae){const _e=ye(xe);fe[_e]===void 0&&(fe[_e]=[]),fe[_e].push(xe)}return fe}(P,C)),q=window.devicePixelRatio,W=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Z=W?W.effectiveType:void 0,te={counters:[],metadata:[],attributes:[]},re=(ae,ye,fe)=>{fe!=null&&ae.push({name:ye,value:fe.toString()})};for(const ae in D)re(te.counters,ae,D[ae]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(re(te.counters,"interactionRangeMin",S.interactionRange[0]),re(te.counters,"interactionRangeMax",S.interactionRange[1])),O)for(const ae of Object.keys(w)){const ye=w[ae],fe=O.find(xe=>xe.name===ye);fe&&re(te.counters,ye,fe.startTime)}return re(te.counters,"visibilityHidden",S.visibilityHidden),re(te.attributes,"style",function(ae){if(ae)for(const ye of ae){const fe=ye.name.split("?")[0];if(i.i(fe)){const xe=fe.split("/").slice(-2);if(xe.length===2)return`mapbox://styles/${xe[0]}/${xe[1]}`}}}(P)),re(te.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),re(te.attributes,"fogEnabled",S.fogEnabled?"true":"false"),re(te.attributes,"projection",S.projection),re(te.attributes,"zoom",S.zoom),re(te.metadata,"devicePixelRatio",q),re(te.metadata,"connectionEffectiveType",Z),re(te.metadata,"navigatorUserAgent",navigator.userAgent),re(te.metadata,"screenWidth",window.screen.width),re(te.metadata,"screenHeight",window.screen.height),re(te.metadata,"windowWidth",window.innerWidth),re(te.metadata,"windowHeight",window.innerHeight),re(te.metadata,"mapWidth",S.width/q),re(te.metadata,"mapHeight",S.height/q),re(te.metadata,"webglRenderer",S.renderer),re(te.metadata,"webglVendor",S.vendor),re(te.metadata,"sdkVersion",_),re(te.metadata,"sdkIdentifier","mapbox-gl-js"),te}(u);for(const S of y.metadata);for(const S of y.counters);for(const S of y.attributes);this.postEvent(s,y,()=>{},g)}},br=ur.postPerformanceEvent.bind(ur),Wt=new class extends Et{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,s,u,y){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const S=Ne(i.e.API_URL+i.e.SESSION_PATH);S.params.push(`sku=${s||""}`),S.params.push(`access_token=${y||i.e.ACCESS_TOKEN||""}`);const P={url:Ye(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(P,O=>{this.pendingRequest=null,u(O),this.saveEventData(),this.processRequests(y)})}getSessionAPI(g,s,u,y){this.skuToken=s,this.errorCb=y,i.e.SESSION_PATH&&i.e.API_URL&&(u||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},u):this.errorCb(new Error(ze)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:s,timestamp:u}=this.queue.shift();s&&this.success[s]||this.getSession(u,this.skuToken,y=>{y?this.errorCb(y):s&&(this.success[s]=!0)},g)}remove(){this.errorCb=null}},Be=Wt.getSessionAPI.bind(Wt),Nr=new Set;function Jt(g,s){s?Nr.add(g):Nr.delete(g)}class Sn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,u){this._updatedSourceCaches[s]=u,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const u=s.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(s.id),this.setDirty()}removeLayer(s){const u=s.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][s.id]=s,this._updatedLayers[u].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const u in this._updatedLayers)s[u]=s[u]||{},s[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)s[u]=s[u]||{},s[u].removedIds=Object.keys(this._removedLayers[u]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(s){this._updatedImages.add(s),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function It(g){const{userImage:s}=g;return!!(s&&s.render&&s.render())&&(g.data.replace(new Uint8Array(s.data.buffer)),!0)}class Vn extends i.E{constructor(s){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=s,s!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(s){this.images[s]={},this.loaded[s]=!1,this.updatedImages[s]={},this.patterns[s]={},this.callbackDispatchedThisFrame[s]={},this.atlasImage[s]=new i.r({width:1,height:1})}isLoaded(){for(const s in this.loaded)if(!this.loaded[s])return!1;return!0}setLoaded(s,u){if(this.loaded[u]!==s&&(this.loaded[u]=s,s)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,u,S);this.requestors=[]}}hasImage(s,u){return!!this.getImage(s,u)}getImage(s,u){return this.images[u][s]}addImage(s,u,y){this._validate(s,y)&&(this.images[u][s]=y)}_validate(s,u){let y=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new i.y(new Error(`Image "${s}" has invalid "stretchX" value`))),y=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new i.y(new Error(`Image "${s}" has invalid "stretchY" value`))),y=!1),this._validateContent(u.content,u)||(this.fire(new i.y(new Error(`Image "${s}" has invalid "content" value`))),y=!1),y}_validateStretch(s,u){if(!s)return!0;let y=0;for(const S of s){if(S[0]<y||S[1]<S[0]||u<S[1])return!1;y=S[1]}return!0}_validateContent(s,u){return s?s.length!==4||!u.usvg&&(s[0]<0||u.data.width<s[0]||s[1]<0||u.data.height<s[1]||s[2]<0||u.data.width<s[2]||s[3]<0||u.data.height<s[3])?!1:!(s[2]<s[0]||s[3]<s[1]):!0}updateImage(s,u,y){y.version=this.images[u][s].version+1,this.images[u][s]=y,this.updatedImages[u][s]=!0,this.removeFromImageRasterizerCache(s,u)}removeFromImageRasterizerCache(s,u){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([s],u))}removeImage(s,u){const y=this.images[u][s];delete this.images[u][s],delete this.patterns[u][s],this.removeFromImageRasterizerCache(s,u),y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(s){return Object.keys(this.images[s])}getImages(s,u,y){let S=!0;const P=!!this.loaded[u];if(!P)for(const O of s)this.images[u][O]||(S=!1);P||S?this._notify(s,u,y):this.requestors.push({ids:s,scope:u,callback:y})}rasterizeImages({scope:s,imageTasks:u},y){const S={};for(const P in u){const O=u[P],D=this.getImage(O.id,s);D&&(S[P]={image:D,imageIdWithOptions:O})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:S,scope:s},y):this.rasterizeImagesInMainThread({imageTasks:S,scope:s},y)}rasterizeImagesInMainThread(s,u){const{imageTasks:y,scope:S}=s,P={};for(const O in y){const{image:D,imageIdWithOptions:q}=y[O];P[O]=this.imageRasterizer.rasterize(q,D,S,"")}u(void 0,P)}getUpdatedImages(s){return this.updatedImages[s]}_notify(s,u,y){const S={};for(const P of s){this.images[u][P]||this.fire(new i.z("styleimagemissing",{id:P}));const O=this.images[u][P];O?S[P]={data:O.usvg?null:O.data.clone(),pixelRatio:O.pixelRatio,sdf:O.sdf,usvg:O.usvg,version:O.version,stretchX:O.stretchX,stretchY:O.stretchY,content:O.content,hasRenderCallback:!!(O.userImage&&O.userImage.render)}:i.w(`Image "${P}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,S)}getPixelSize(s){const{width:u,height:y}=this.atlasImage[s];return{width:u,height:y}}getPattern(s,u,y){const S=this.patterns[u][s],P=this.getImage(s,u);if(!P)return null;if(S&&S.position.version===P.version)return S.position;if(S)S.position.version=P.version;else{P.usvg&&!P.data&&(P.data=this.imageRasterizer.rasterize(i.A.from(s).getPrimary(),P,u,""));const O={w:P.data.width+2*i.B,h:P.data.height+2*i.B,x:0,y:0},D=new i.C(O,P,i.B);this.patterns[u][s]={bin:O,position:D}}return this._updatePatternAtlas(u,y),this.patterns[u][s].position}bind(s,u){const y=s.gl;let S=this.atlasTexture[u];S?this.dirty&&(S.update(this.atlasImage[u]),this.dirty=!1):(S=new i.T(s,this.atlasImage[u],y.RGBA8),this.atlasTexture[u]=S),S.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(s,u){const y=[];for(const D in this.patterns[s])y.push(this.patterns[s][D].bin);const{w:S,h:P}=i.F(y),O=this.atlasImage[s];O.resize({width:S||1,height:P||1});for(const D in this.patterns[s]){const{bin:q,position:W}=this.patterns[s][D];let Z=W.padding;const te=q.x+Z,re=q.y+Z,ae=this.images[s][D].data,ye=ae.width,fe=ae.height;Z=Z>1?Z-1:Z,i.r.copy(ae,O,{x:0,y:0},{x:te,y:re},{width:ye,height:fe},u),i.r.copy(ae,O,{x:0,y:fe-Z},{x:te,y:re-Z},{width:ye,height:Z},u),i.r.copy(ae,O,{x:0,y:0},{x:te,y:re+fe},{width:ye,height:Z},u),i.r.copy(ae,O,{x:ye-Z,y:0},{x:te-Z,y:re},{width:Z,height:fe},u),i.r.copy(ae,O,{x:0,y:0},{x:te+ye,y:re},{width:Z,height:fe},u),i.r.copy(ae,O,{x:ye-Z,y:fe-Z},{x:te-Z,y:re-Z},{width:Z,height:Z},u),i.r.copy(ae,O,{x:0,y:fe-Z},{x:te+ye,y:re-Z},{width:Z,height:Z},u),i.r.copy(ae,O,{x:0,y:0},{x:te+ye,y:re+fe},{width:Z,height:Z},u),i.r.copy(ae,O,{x:ye-Z,y:0},{x:te-Z,y:re+fe},{width:Z,height:Z},u)}this.dirty=!0}beginFrame(){for(const s in this.images)this.callbackDispatchedThisFrame[s]={}}dispatchRenderCallbacks(s,u){for(const y of s){if(this.callbackDispatchedThisFrame[u][y])continue;this.callbackDispatchedThisFrame[u][y]=!0;const S=this.images[u][y];It(S)&&this.updateImage(y,u,S)}}}function Un(g){const s=g.key,u=g.value,y=g.valueSpec||{},S=g.objectElementValidators||{},P=g.style,O=g.styleSpec;let D=[];const q=i.H(u);if(q!=="object")return[new i.V(s,u,`object expected, ${q} found`)];for(const W in u){const Z=W.split(".")[0];let te;S[Z]?te=S[Z]:y[Z]?te=rn:S["*"]?te=S["*"]:y["*"]&&(te=rn),te?D=D.concat(te({key:(s&&`${s}.`)+W,value:u[W],valueSpec:y[Z]||y["*"],style:P,styleSpec:O,object:u,objectKey:W},u)):D.push(new i.G(s,u[W],`unknown property "${W}"`))}for(const W in y)S[W]||y[W].required&&y[W].default===void 0&&u[W]===void 0&&D.push(new i.V(s,u,`missing required property "${W}"`));return D}function Xr(g){const s=g.value,u=g.valueSpec,y=g.style,S=g.styleSpec,P=g.key,O=g.arrayElementValidator||rn;if(i.H(s)!=="array")return[new i.V(P,s,`array expected, ${i.H(s)} found`)];if(u.length&&s.length!==u.length)return[new i.V(P,s,`array length ${u.length} expected, length ${s.length} found`)];if(u["min-length"]&&s.length<u["min-length"])return[new i.V(P,s,`array length at least ${u["min-length"]} expected, length ${s.length} found`)];let D={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};S.$version<7&&(D.function=u.function),i.H(u.value)==="object"&&(D=u.value);let q=[];for(let W=0;W<s.length;W++)q=q.concat(O({array:s,arrayIndex:W,value:s[W],valueSpec:D,style:y,styleSpec:S,key:`${P}[${W}]`},!0));return q}function rt(g){const s=g.key,u=g.value,y=g.valueSpec;let S=i.H(u);if(S==="number"&&u!=u&&(S="NaN"),S!=="number")return[new i.V(s,u,`number expected, ${S} found`)];if("minimum"in y){let P=y.minimum;if(i.H(y.minimum)==="array"&&(P=y.minimum[g.arrayIndex]),u<P)return[new i.V(s,u,`${u} is less than the minimum value ${P}`)]}if("maximum"in y){let P=y.maximum;if(i.H(y.maximum)==="array"&&(P=y.maximum[g.arrayIndex]),u>P)return[new i.V(s,u,`${u} is greater than the maximum value ${P}`)]}return[]}function Ot(g){const s=g.valueSpec,u=i.K(g.value.type);let y,S,P,O={};const D=u!=="categorical"&&g.value.property===void 0,q=!D,W=i.H(g.value.stops)==="array"&&i.H(g.value.stops[0])==="array"&&i.H(g.value.stops[0][0])==="object",Z=Un({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(ae){if(u==="identity")return[new i.V(ae.key,ae.value,'identity function may not have a "stops" property')];let ye=[];const fe=ae.value;return ye=ye.concat(Xr({key:ae.key,value:fe,valueSpec:ae.valueSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:te})),i.H(fe)==="array"&&fe.length===0&&ye.push(new i.V(ae.key,fe,"array must have at least one stop")),ye},default:function(ae){return rn({key:ae.key,value:ae.value,valueSpec:s,style:ae.style,styleSpec:ae.styleSpec})}}});return u==="identity"&&D&&Z.push(new i.V(g.key,g.value,'missing required property "property"')),u==="identity"||g.value.stops||Z.push(new i.V(g.key,g.value,'missing required property "stops"')),u==="exponential"&&g.valueSpec.expression&&!i.L(g.valueSpec)&&Z.push(new i.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(q&&!i.M(g.valueSpec)?Z.push(new i.V(g.key,g.value,"property functions not supported")):D&&!i.N(g.valueSpec)&&Z.push(new i.V(g.key,g.value,"zoom functions not supported"))),u!=="categorical"&&!W||g.value.property!==void 0||Z.push(new i.V(g.key,g.value,'"property" property is required')),Z;function te(ae){let ye=[];const fe=ae.value,xe=ae.key;if(i.H(fe)!=="array")return[new i.V(xe,fe,`array expected, ${i.H(fe)} found`)];if(fe.length!==2)return[new i.V(xe,fe,`array length 2 expected, length ${fe.length} found`)];if(W){if(i.H(fe[0])!=="object")return[new i.V(xe,fe,`object expected, ${i.H(fe[0])} found`)];if(fe[0].zoom===void 0)return[new i.V(xe,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new i.V(xe,fe,"object stop key must have value")];const _e=i.K(fe[0].zoom);if(typeof _e!="number")return[new i.V(xe,fe[0].zoom,"stop zoom values must be numbers")];if(P&&P>_e)return[new i.V(xe,fe[0].zoom,"stop zoom values must appear in ascending order")];_e!==P&&(P=_e,S=void 0,O={}),ye=ye.concat(Un({key:`${xe}[0]`,value:fe[0],valueSpec:{zoom:{}},style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:rt,value:re}}))}else ye=ye.concat(re({key:`${xe}[0]`,value:fe[0],style:ae.style,styleSpec:ae.styleSpec},fe));return i.O(i.Q(fe[1]))?ye.concat([new i.V(`${xe}[1]`,fe[1],"expressions are not allowed in function stops.")]):ye.concat(rn({key:`${xe}[1]`,value:fe[1],valueSpec:s,style:ae.style,styleSpec:ae.styleSpec}))}function re(ae,ye){const fe=i.H(ae.value),xe=i.K(ae.value),_e=ae.value!==null?ae.value:ye;if(y){if(fe!==y)return[new i.V(ae.key,_e,`${fe} stop domain type must match previous stop domain type ${y}`)]}else y=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean"&&typeof xe!="number"&&typeof xe!="string"&&typeof xe!="boolean")return[new i.V(ae.key,_e,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&u!=="categorical"){let Ee=`number expected, ${fe} found`;return i.M(s)&&u===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(ae.key,_e,Ee)]}return u!=="categorical"||fe!=="number"||typeof xe=="number"&&isFinite(xe)&&Math.floor(xe)===xe?u!=="categorical"&&fe==="number"&&typeof xe=="number"&&typeof S=="number"&&S!==void 0&&xe<S?[new i.V(ae.key,_e,"stop domain values must appear in ascending order")]:(S=xe,u==="categorical"&&xe in O?[new i.V(ae.key,_e,"stop domain values must be unique")]:(O[xe]=!0,[])):[new i.V(ae.key,_e,`integer expected, found ${String(xe)}`)]}}function Kt(g){const s=(g.expressionContext==="property"?i.S:i.U)(i.Q(g.value),g.valueSpec);if(s.result==="error")return s.value.map(y=>new i.V(`${g.key}${y.key}`,g.value,y.message));const u=s.value.expression||s.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!u.outputDefined())return[new i.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!i.W(u))return[new i.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return Pr(u,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!i.X(u,["zoom","feature-state"]))return[new i.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!i.Y(u))return[new i.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Pr(g,s){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const S of s.valueSpec.expression.parameters)u.delete(S);if(u.size===0)return[];const y=[];return g instanceof i.Z&&u.has(g.name)?[new i.V(s.key,s.value,`["${g.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(g.eachChild(S=>{y.push(...Pr(S,s))}),y)}function yr(g){const s=g.key,u=g.value,y=g.valueSpec,S=[];return Array.isArray(y.values)?y.values.indexOf(i.K(u))===-1&&S.push(new i.V(s,u,`expected one of [${y.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(y.values).indexOf(i.K(u))===-1&&S.push(new i.V(s,u,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(u)} found`)),S}function wr(g){return i.$(i.Q(g.value))?Kt(i.J({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):dr(g)}function dr(g){const s=g.value,u=g.key;if(i.H(s)!=="array")return[new i.V(u,s,`array expected, ${i.H(s)} found`)];const y=g.styleSpec;let S,P=[];if(s.length<1)return[new i.V(u,s,"filter array must have at least 1 element")];switch(P=P.concat(yr({key:`${u}[0]`,value:s[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),i.K(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&i.K(s[1])==="$type"&&P.push(new i.V(u,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":s.length!==3&&P.push(new i.V(u,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(S=i.H(s[1]),S!=="string"&&P.push(new i.V(`${u}[1]`,s[1],`string expected, ${S} found`)));for(let O=2;O<s.length;O++)S=i.H(s[O]),i.K(s[1])==="$type"?P=P.concat(yr({key:`${u}[${O}]`,value:s[O],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&P.push(new i.V(`${u}[${O}]`,s[O],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let O=1;O<s.length;O++)P=P.concat(dr({key:`${u}[${O}]`,value:s[O],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":S=i.H(s[1]),s.length!==2?P.push(new i.V(u,s,`filter array for "${s[0]}" operator must have 2 elements`)):S!=="string"&&P.push(new i.V(`${u}[1]`,s[1],`string expected, ${S} found`))}return P}function An(g,s){const u=g.key,y=g.style,S=g.layer,P=g.styleSpec,O=g.value,D=g.objectKey,q=P[`${s}_${g.layerType}`];if(!q)return[];const W=D.match(/^(.*)-use-theme$/);if(s==="paint"&&W&&q[W[1]])return i.O(O)?[].concat(rn({key:g.key,value:O,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:P,expressionContext:"property",propertyType:s,propertyKey:D})):rn({key:u,value:O,valueSpec:{type:"string"},style:y,styleSpec:P});const Z=D.match(/^(.*)-transition$/);if(s==="paint"&&Z&&q[Z[1]]&&q[Z[1]].transition)return rn({key:u,value:O,valueSpec:P.transition,style:y,styleSpec:P});const te=g.valueSpec||q[D];if(!te)return[new i.G(u,O,`unknown property "${D}"`)];let re;if(i.H(O)==="string"&&i.M(te)&&!te.tokens&&(re=/^{([^}]+)}$/.exec(O))){const ye=`\`{ "type": "identity", "property": ${re?JSON.stringify(re[1]):'"_"'} }\``;return[new i.V(u,O,`"${D}" does not support interpolation syntax
Use an identity property function instead: ${ye}.`)]}const ae=[];if(g.layerType==="symbol")D!=="text-field"||!y||y.glyphs||y.imports||ae.push(new i.V(u,O,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&i.a0(i.Q(O))&&i.K(O.type)==="identity"&&ae.push(new i.V(u,O,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&s==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&i.M(te)&&(i.a1(te)||i.N(te))){const ye=i.S(i.Q(O),te),fe=ye.value.expression||ye.value._styleExpression.expression;fe&&!i.X(fe,["measure-light"])&&(D==="model-emissive-strength"&&i.Y(fe)&&i.W(fe)||ae.push(new i.V(u,O,`${D} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ae.concat(rn({key:g.key,value:O,valueSpec:te,style:y,styleSpec:P,expressionContext:"property",propertyType:s,propertyKey:D}))}function Ti(g){return An(g,"paint")}function Bi(g){return An(g,"layout")}function Vi(g){let s=[];const u=g.value,y=g.key,S=g.style,P=g.styleSpec;u.type||u.ref||s.push(new i.V(y,u,'either "type" or "ref" is required'));let O=i.K(u.type);const D=i.K(u.ref);if(u.id){const q=i.K(u.id);for(let W=0;W<g.arrayIndex;W++){const Z=S.layers[W];i.K(Z.id)===q&&s.push(new i.V(y,u.id,`duplicate layer id "${u.id}", previously used at line ${Z.id.__line__}`))}}if("ref"in u){let q;["type","source","source-layer","filter","layout"].forEach(W=>{W in u&&s.push(new i.V(y,u[W],`"${W}" is prohibited for ref layers`))}),S.layers.forEach(W=>{i.K(W.id)===D&&(q=W)}),q?q.ref?s.push(new i.V(y,u.ref,"ref cannot reference another ref layer")):O=i.K(q.type):typeof D=="string"&&s.push(new i.V(y,u.ref,`ref layer "${D}" not found`))}else if(O!=="background"&&O!=="sky"&&O!=="slot")if(u.source){const q=S.sources&&S.sources[u.source],W=q&&i.K(q.type);q?W==="vector"&&O==="raster"?s.push(new i.V(y,u.source,`layer "${u.id}" requires a raster source`)):W==="raster"&&O!=="raster"?s.push(new i.V(y,u.source,`layer "${u.id}" requires a vector source`)):W!=="vector"||u["source-layer"]?W==="raster-dem"&&O!=="hillshade"?s.push(new i.V(y,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):W!=="raster-array"||["raster","raster-particle"].includes(O)?O!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||W==="geojson"&&q.lineMetrics?O==="raster-particle"&&W!=="raster-array"&&s.push(new i.V(y,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):s.push(new i.V(y,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new i.V(y,u.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new i.V(y,u,`layer "${u.id}" must specify a "source-layer"`)):s.push(new i.V(y,u.source,`source "${u.source}" not found`))}else s.push(new i.V(y,u,'missing required property "source"'));return s=s.concat(Un({key:y,value:u,valueSpec:P.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>rn({key:`${y}.type`,value:u.type,valueSpec:P.layer.type,style:g.style,styleSpec:g.styleSpec,object:u,objectKey:"type"}),filter:q=>wr(i.J({layerType:O},q)),layout:q=>Un({layer:u,key:q.key,value:q.value,valueSpec:{},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":W=>Bi(i.J({layerType:O},W))}}),paint:q=>Un({layer:u,key:q.key,value:q.value,valueSpec:{},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":W=>Ti(i.J({layerType:O,layer:u},W))}})}})),s}function is(g){const s=g.value,u=g.key,y=i.H(s);return y!=="string"?[new i.V(u,s,`string expected, ${y} found`)]:[]}const $a={promoteId:function g({key:s,value:u}){if(i.H(u)==="string")return is({key:s,value:u});if(Array.isArray(u)){const y=[],S=i.Q(u),P=i.U(S);return P.result==="error"&&P.value.forEach(O=>{y.push(new i.V(`${s}${O.key}`,null,`${O.message}`))}),i.X(P.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new i.V(`${s}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const S in u)y.push(...g({key:`${s}.${S}`,value:u[S]}));return y}}};function Vo(g){const s=g.value,u=g.key,y=g.styleSpec,S=g.style;if(!s.type)return[new i.V(u,s,'"type" is required')];const P=i.K(s.type);let O=[];switch(["vector","raster","raster-dem","raster-array"].includes(P)&&(s.url||s.tiles||O.push(new i.G(u,s,'Either "url" or "tiles" is required.'))),P){case"vector":case"raster":case"raster-dem":case"raster-array":return O=O.concat(Un({key:u,value:s,valueSpec:y[`source_${P.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:$a})),O;case"geojson":if(O=Un({key:u,value:s,valueSpec:y.source_geojson,style:S,styleSpec:y,objectElementValidators:$a}),s.cluster)for(const D in s.clusterProperties){const[q,W]=s.clusterProperties[D],Z=typeof q=="string"?[q,["accumulated"],["get",D]]:q;O.push(...Kt({key:`${u}.${D}.map`,value:W,expressionContext:"cluster-map"})),O.push(...Kt({key:`${u}.${D}.reduce`,value:Z,expressionContext:"cluster-reduce"}))}return O;case"video":return Un({key:u,value:s,valueSpec:y.source_video,style:S,styleSpec:y});case"image":return Un({key:u,value:s,valueSpec:y.source_image,style:S,styleSpec:y});case"canvas":return[new i.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return yr({key:`${u}.type`,value:s.type,valueSpec:{values:ys(y)}})}}function ys(g){return g.source.reduce((s,u)=>{const y=g[u];return y.type.type==="enum"&&(s=s.concat(Object.keys(y.type.values))),s},[])}function Qa(g){const s=g.value,u=g.styleSpec,y=u.light,S=g.style;let P=[];const O=i.H(s);if(s===void 0)return P;if(O!=="object")return P=P.concat([new i.V("light",s,`object expected, ${O} found`)]),P;for(const D in s){const q=D.match(/^(.*)-transition$/),W=D.match(/^(.*)-use-theme$/);P=P.concat(W&&y[W[1]]?rn({key:D,value:s[D],valueSpec:{type:"string"},style:S,styleSpec:u}):q&&y[q[1]]&&y[q[1]].transition?rn({key:D,value:s[D],valueSpec:u.transition,style:S,styleSpec:u}):y[D]?rn({key:D,value:s[D],valueSpec:y[D],style:S,styleSpec:u}):[new i.V(D,s[D],`unknown property "${D}"`)])}return P}function $l(g){const s=g.value;let u=[];if(!s)return u;const y=i.H(s);if(y!=="object")return u=u.concat([new i.V("light-3d",s,`object expected, ${y} found`)]),u;const S=g.styleSpec,P=S["light-3d"],O=g.key,D=g.style,q=g.style.lights;for(const te of["type","id"])if(!(te in s))return u=u.concat([new i.V("light-3d",s,`missing property ${te} on light`)]),u;if(s.type&&q)for(let te=0;te<g.arrayIndex;te++){const re=i.K(s.type),ae=q[te];i.K(ae.type)===re&&u.push(new i.V(O,s.id,`duplicate light type "${s.type}", previously defined at line ${ae.id.__line__}`))}const W=`properties_light_${s.type}`;if(!(W in S))return u=u.concat([new i.V("light-3d",s,`Invalid light type ${s.type}`)]),u;const Z=S[W];for(const te in s)if(te==="properties"){const re=s[te],ae=i.H(re);if(ae!=="object")return u=u.concat([new i.V("properties",re,`object expected, ${ae} found`)]),u;for(const ye in re)u=u.concat(Z[ye]?rn({key:ye,value:re[ye],valueSpec:Z[ye],style:D,styleSpec:S}):[new i.G(g.key,re[ye],`unknown property "${ye}"`)])}else{const re=te.match(/^(.*)-transition$/),ae=te.match(/^(.*)-use-theme$/);u=u.concat(ae&&P[ae[1]]?rn({key:te,value:s[te],valueSpec:{type:"string"},style:D,styleSpec:S}):re&&P[re[1]]&&P[re[1]].transition?rn({key:te,value:s[te],valueSpec:S.transition,style:D,styleSpec:S}):P[te]?rn({key:te,value:s[te],valueSpec:P[te],style:D,styleSpec:S}):[new i.G(te,s[te],`unknown property "${te}"`)])}return u}function _l(g){const s=g.value,u=g.key,y=g.style,S=g.styleSpec,P=S.terrain;let O=[];const D=i.H(s);if(s===void 0||D==="null")return O;if(D!=="object")return O=O.concat([new i.V("terrain",s,`object expected, ${D} found`)]),O;for(const q in s){const W=q.match(/^(.*)-transition$/),Z=q.match(/^(.*)-use-theme$/);O=O.concat(Z&&P[Z[1]]?rn({key:q,value:s[q],valueSpec:{type:"string"},style:y,styleSpec:S}):W&&P[W[1]]&&P[W[1]].transition?rn({key:q,value:s[q],valueSpec:S.transition,style:y,styleSpec:S}):P[q]?rn({key:q,value:s[q],valueSpec:P[q],style:y,styleSpec:S}):[new i.G(q,s[q],`unknown property "${q}"`)])}if(s.source){const q=y.sources&&y.sources[s.source],W=q&&i.K(q.type);q?W!=="raster-dem"&&O.push(new i.V(u,s.source,`terrain cannot be used with a source of type ${String(W)}, it only be used with a "raster-dem" source type`)):O.push(new i.V(u,s.source,`source "${s.source}" not found`))}else O.push(new i.V(u,s,'terrain is missing required property "source"'));return O}function jo(g){const s=g.value,u=g.style,y=g.styleSpec,S=y.fog;let P=[];const O=i.H(s);if(s===void 0)return P;if(O!=="object")return P=P.concat([new i.V("fog",s,`object expected, ${O} found`)]),P;for(const D in s){const q=D.match(/^(.*)-transition$/),W=D.match(/^(.*)-use-theme$/);P=P.concat(W&&S[W[1]]?rn({key:D,value:s[D],valueSpec:{type:"string"},style:u,styleSpec:y}):q&&S[q[1]]&&S[q[1]].transition?rn({key:D,value:s[D],valueSpec:y.transition,style:u,styleSpec:y}):S[D]?rn({key:D,value:s[D],valueSpec:S[D],style:u,styleSpec:y}):[new i.G(D,s[D],`unknown property "${D}"`)])}return P}const ql={"*":()=>[],array:Xr,boolean:function(g){const s=g.value,u=g.key,y=i.H(s);return y!=="boolean"?[new i.V(u,s,`boolean expected, ${y} found`)]:[]},number:rt,color:function(g){const s=g.key,u=g.value,y=i.H(u);return y!=="string"?[new i.V(s,u,`color expected, ${y} found`)]:i._.parseCSSColor(u)===null?[new i.V(s,u,`color expected, "${u}" found`)]:[]},enum:yr,filter:wr,function:Ot,layer:Vi,object:Un,source:Vo,model:i.a2,light:Qa,"light-3d":$l,terrain:_l,fog:jo,string:is,formatted:function(g){return is(g).length===0?[]:Kt(g)},resolvedImage:function(g){return is(g).length===0?[]:Kt(g)},projection:function(g){const s=g.value,u=g.styleSpec,y=u.projection,S=g.style;let P=[];const O=i.H(s);if(O==="object")for(const D in s)P=P.concat(rn({key:D,value:s[D],valueSpec:y[D],style:S,styleSpec:u}));else O!=="string"&&(P=P.concat([new i.V("projection",s,`object or string expected, ${O} found`)]));return P},import:function(g){const{value:s,styleSpec:u}=g,{data:y,...S}=s;Object.defineProperty(S,"__line__",{value:s.__line__,enumerable:!1});let P=Un(i.J({},g,{value:S,valueSpec:u.import}));return i.K(S.id)===""&&P.push(new i.V(`${g.key}.id`,S,"import id can't be an empty string")),y&&(P=P.concat(ku(y,u,{key:`${g.key}.data`}))),P}};function rn(g,s=!1){const u=g.value,y=g.valueSpec,S=g.styleSpec;if(y.expression&&i.a0(i.K(u)))return Ot(g);if(y.expression&&i.O(i.Q(u)))return Kt(g);if(y.type&&ql[y.type]){const P=ql[y.type](g);return s===!0&&P.length>0&&i.H(g.value)==="array"?Kt(g):P}return Un(i.J({},g,{valueSpec:y.type?S[y.type]:y}))}function eo(g){const s=g.value,u=g.key,y=is(g);return y.length||(s.indexOf("{fontstack}")===-1&&y.push(new i.V(u,s,'"glyphs" url must include a "{fontstack}" token')),s.indexOf("{range}")===-1&&y.push(new i.V(u,s,'"glyphs" url must include a "{range}" token'))),y}function ku(g,s=i.a3,u={}){return rn({key:u.key||"",value:g,valueSpec:s.$root,styleSpec:s,style:g,objectElementValidators:{glyphs:eo,"*":()=>[]}})}function qa(g,s=i.a3){return Wi(ku(g,s))}const Uo=g=>Wi(Vo(g)),Kn=g=>Wi(Qa(g)),fa=g=>Wi($l(g)),Ca=g=>Wi(_l(g)),wo=g=>Wi(jo(g)),xl=g=>Wi(function(s){const u=s.value,y=s.style,S=s.styleSpec,P=S.snow;let O=[];const D=i.H(u);if(u===void 0)return O;if(D!=="object")return O=O.concat([new i.V("snow",u,`object expected, ${D} found`)]),O;for(const q in u){const W=q.match(/^(.*)-transition$/);O=O.concat(W&&P[W[1]]&&P[W[1]].transition?rn({key:q,value:u[q],valueSpec:S.transition,style:y,styleSpec:S}):P[q]?rn({key:q,value:u[q],valueSpec:P[q],style:y,styleSpec:S}):[new i.G(q,u[q],`unknown property "${q}"`)])}return O}(g)),Ma=g=>Wi(function(s){const u=s.value,y=s.style,S=s.styleSpec,P=S.rain;let O=[];const D=i.H(u);if(u===void 0)return O;if(D!=="object")return O=O.concat([new i.V("rain",u,`object expected, ${D} found`)]),O;for(const q in u){const W=q.match(/^(.*)-transition$/);O=O.concat(W&&P[W[1]]&&P[W[1]].transition?rn({key:q,value:u[q],valueSpec:S.transition,style:y,styleSpec:S}):P[q]?rn({key:q,value:u[q],valueSpec:P[q],style:y,styleSpec:S}):[new i.G(q,u[q],`unknown property "${q}"`)])}return O}(g)),No=g=>Wi(Vi(g)),Ui=g=>Wi(wr(g)),So=g=>Wi(Ti(g)),uo=g=>Wi(Bi(g)),ju=g=>Wi(i.a2(g));function Wi(g){return g.slice().sort((s,u)=>s.line&&u.line?s.line-u.line:0)}function Ds(g,s){let u=!1;if(s&&s.length)for(const y of s)y instanceof i.G?i.w(y.message):(g.fire(new i.y(new Error(y.message))),u=!0);return u}let wt;class ge extends i.E{constructor(s,u="flat"){super(),this._transitionable=new i.a4(wt||(wt=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(s,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,u,y={}){this._validate(Kn,s,y)||(this._transitionable.setTransitionOrValue(s),this.id=u)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,y){return(!y||y.validate!==!1)&&Ds(this,s.call(qa,i.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let we=class extends i.E{constructor(g,s,u,y){super(),this.scope=u,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),u,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(g,s){this._transitionable.setTransitionOrValue(g,s)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new i.a8(g)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const s=g.value.expression;if(!s)return null;let u=-1,y=-1,S=1;for(const P of s.zoomStops)S=s.evaluate(new i.a8(P)),S>.01?(u=P,y=-1):y=P;return S<.01&&u>0&&y>u?[u,y]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof i.a9}};const Te=45,Ge=65,He=.05;function at(g,s,u,y){const S=i.ac(Te,Ge,u),[P,O]=mt(g,y);let D=1-Math.min(1,Math.exp((s-P)/(O-P)*-6));return D*=D*D,D=Math.min(1,1.00747*D),D*S*g.alpha}function mt(g,s){const u=.5/Math.tan(.5*s);return[g.range[0]+u,g.range[1]+u]}function st(g,s,u,y,S){const P=i.ab.vec3.transformMat4([],[s,u,y],S.mercatorFogMatrix);return at(g,i.ab.vec3.length(P),S.pitch,S._fov)}function bt(g,s,u,y,S,P,O){const D=[[u,y,0],[S,y,0],[S,P,0],[u,P,0]];let q=Number.MAX_VALUE,W=-Number.MAX_VALUE;for(const Z of D){const te=i.ab.vec3.transformMat4([],Z,s),re=i.ab.vec3.length(te);q=Math.min(q,re),W=Math.max(W,re)}return[at(g,q,O.pitch,O._fov),at(g,W,O.pitch,O._fov)]}class xt extends i.E{constructor(s,u,y,S){super();const P=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(P,y,new Map(S)),this.set(s,S),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new i.ad(P),this.scope=y}get state(){const s=this._transform,u=s.projection.name==="globe",y=i.ae(s.zoom),S=this.properties.get("range"),P=[.5,3];return{range:u?[i.af(P[0],S[0],y),i.af(P[1],S[1],y)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,u,y={}){if(this._validate(wo,s,y))return;const S=i.l({},s);for(const P of Object.keys(i.a3.fog))S[P]===void 0&&(S[P]=i.a3.fog[P].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(Te,Ge,s))*u.a}getOpacityAtLatLng(s,u){return this._transform.projection.supportsFog?function(y,S,P){const O=i.aa.fromLngLat(S),D=P.elevation?P.elevation.getAtPointOrZero(O):0;return st(y,O.x,O.y,D,P)}(this.state,s,u):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(s.toUnwrapped());return bt(this.state,u,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(s,u,y,S,P){return this._transform.projection.supportsFog?bt(this.state,s,u,y,S,P,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?mt(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const y of u){const S=s.points[y];let P;if(S[2]>=0)P=S;else{const O=s.points[y-4];P=i.ah(O,S,O[2]/(O[2]-S[2]))}if(st(this.state,P[0],P[1],0,this._transform)>=He)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,u,y){return(!y||y.validate!==!1)&&Ds(this,s.call(qa,i.l({value:u,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let St,Lt,tr,nr,Sr=class extends i.E{constructor(g,s,u,y){super();const S=St||(St=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(S,u,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(S),this.scope=u}get state(){const g=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),y=i.ai(u[0]),S=-Math.max(i.ai(u[1]),.01),P=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],O=this.properties.get("vignette"),D=this.properties.get("vignette-color");return D.a=O,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(s.r,s.g,s.b,s.a*g),direction:P,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:D}}get(){return this._transitionable.serialize()}set(g,s,u={}){if(this._validate(xl,g,u))return;const y=i.l({},g);for(const S of Object.keys(i.a3.snow))y[S]===void 0&&(y[S]=i.a3.snow[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,s,u){return(!u||u.validate!==!1)&&Ds(this,g.call(qa,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},Vr=class extends i.E{constructor(g,s,u,y){super();const S=Lt||(Lt=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(S,u,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(S),this.scope=u}get state(){const g=this.properties.get("opacity"),s=this.properties.get("color"),u=this.properties.get("direction"),y=i.ai(u[0]),S=-Math.max(i.ai(u[1]),.01),P=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],O=this.properties.get("vignette-color");return O.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(s.r,s.g,s.b,s.a*g),direction:P,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:O}}get(){return this._transitionable.serialize()}set(g,s,u={}){if(this._validate(Ma,g,u))return;const y=i.l({},g);for(const S of Object.keys(i.a3.rain))y[S]===void 0&&(y[S]=i.a3.rain[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,s,u){return(!u||u.validate!==!1)&&Ds(this,g.call(qa,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class Br extends i.E{constructor(s,u,y,S){super(),this.scope=y,this._options=s,this.properties=new i.ad(u),this._transitionable=new i.a4(u,y,new Map(S)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,u){this._options=s,this._transitionable.setTransitionOrValue(s.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Fr{constructor(s,u,y,S){this.screenBounds=s,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(s,u){let y,S;if(s instanceof i.P||typeof s[0]=="number"){const P=i.P.convert(s);y=[P],S=u.isPointAboveHorizon(P)}else{const P=i.P.convert(s[0]),O=i.P.convert(s[1]);y=[P,O],S=i.al(P,O).every(D=>u.isPointAboveHorizon(D))}return new Fr(y,u.getCameraPoint(),S,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(s){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const u=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.al(u,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<y.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?S[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(S[3]=this.cameraPoint)),i.am(S,s)}bufferedCameraGeometryGlobe(s){const u=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.al(u,y,s),P=this.cameraPoint.clone();switch(3*((P.y>u.y)+(P.y>y.y))+((P.x>u.x)+(P.x>y.x))){case 0:S[0]=P,S[4]=P.clone();break;case 1:S.splice(1,0,P);break;case 2:S[1]=P;break;case 3:S.splice(4,0,P);break;case 5:S.splice(2,0,P);break;case 6:S[3]=P;break;case 7:S.splice(3,0,P);break;case 8:S[2]=P}return S}containsTile(s,u,y,S=0){const P=s.queryPadding/u._pixelsPerMercatorPixel+1,O=y?this._bufferedCameraMercator(P,u):this._bufferedScreenMercator(P,u);let D=s.tileID.wrap+(O.unwrapped?S:0);const q=O.polygon.map(xe=>i.an(s.tileTransform,xe,D));if(!i.ao(q,0,0,i.ag,i.ag))return;D=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const W=this.screenGeometryMercator.polygon.map(xe=>i.ap(s.tileTransform,xe,D)),Z=W.map(xe=>new i.P(xe[0],xe[1])),te=u.getFreeCameraOptions().position||new i.aa(0,0,0),re=i.ap(s.tileTransform,te,D),ae=W.map(xe=>{const _e=i.ab.vec3.sub(xe,xe,re);return i.ab.vec3.normalize(_e,_e),new i.aq(re,_e)}),ye=i.ar(s,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Z,tilespaceRays:ae,bufferedTilespaceGeometry:q,bufferedTilespaceBounds:(fe=i.as(q),fe.min.x=i.aw(fe.min.x,0,i.ag),fe.min.y=i.aw(fe.min.y,0,i.ag),fe.max.x=i.aw(fe.max.x,0,i.ag),fe.max.y=i.aw(fe.max.y,0,i.ag),fe),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:ye};var fe}_bufferedScreenMercator(s,u){const y=vn(s);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let S;return S=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(s),u):{polygon:this.bufferedScreenGeometry(s).map(P=>u.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[y]=S,S}}_bufferedCameraMercator(s,u){const y=vn(s);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let S;return S=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),u):{polygon:this.bufferedCameraGeometry(s).map(P=>u.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[y]=S,S}}_projectAndResample(s,u){const y=function(P,O){const D=i.ab.mat4.multiply([],O.pixelMatrix,O.globeMatrix),q=[0,-i.ax,0,1],W=[0,i.ax,0,1],Z=[0,0,0,1];i.ab.vec4.transformMat4(q,q,D),i.ab.vec4.transformMat4(W,W,D),i.ab.vec4.transformMat4(Z,Z,D);const te=new i.P(q[0]/q[3],q[1]/q[3]),re=new i.P(W[0]/W[3],W[1]/W[3]),ae=i.au(P,te)&&q[3]<Z[3],ye=i.au(P,re)&&W[3]<Z[3];if(!ae&&!ye)return null;const fe=function(qe,Ve,Ke){for(let it=1;it<qe.length;it++){const _t=Hn(Ve.pointCoordinate3D(qe[it-1]).x),pt=Hn(Ve.pointCoordinate3D(qe[it]).x);if(Ke<0){if(_t<pt)return{idx:it,t:-_t/(pt-1-_t)}}else if(pt<_t)return{idx:it,t:(1-_t)/(pt+1-_t)}}return null}(P,O,ae?-1:1);if(!fe)return null;const{idx:xe,t:_e}=fe;let Ee=xe>1?Tn(P.slice(0,xe),O):[],Fe=xe<P.length?Tn(P.slice(xe),O):[];Ee=Ee.map(qe=>new i.P(Hn(qe.x),qe.y)),Fe=Fe.map(qe=>new i.P(Hn(qe.x),qe.y));const De=[...Ee];De.length===0&&De.push(Fe[Fe.length-1]);const Ze=i.af(De[De.length-1].y,(Fe.length===0?Ee[0]:Fe[0]).y,_e);let Ue;return Ue=ae?[new i.P(0,Ze),new i.P(0,0),new i.P(1,0),new i.P(1,Ze)]:[new i.P(1,Ze),new i.P(1,1),new i.P(0,1),new i.P(0,Ze)],De.push(...Ue),Fe.length===0?De.push(Ee[0]):De.push(...Fe),{polygon:De.map(qe=>new i.aa(qe.x,qe.y)),unwrapped:!1}}(s,u);if(y)return y;const S=function(P,O){let D=!1,q=-1/0,W=0;for(let te=0;te<P.length-1;te++)P[te].x>q&&(q=P[te].x,W=te);for(let te=0;te<P.length-1;te++){const re=(W+te)%(P.length-1),ae=P[re],ye=P[re+1];Math.abs(ae.x-ye.x)>.5&&(ae.x<ye.x?(ae.x+=1,re===0&&(P[P.length-1].x+=1)):(ye.x+=1,re+1===P.length-1&&(P[0].x+=1)),D=!0)}const Z=i.at(O.center.lng);return D&&Z<Math.abs(Z-1)&&P.forEach(te=>{te.x-=1}),{polygon:P,unwrapped:D}}(Tn(s,u).map(P=>new i.P(Hn(P.x),P.y)),u);return{polygon:S.polygon.map(P=>new i.aa(P.x,P.y)),unwrapped:S.unwrapped}}}function Tn(g,s){return i.av(g,u=>{const y=s.pointCoordinate3D(u);u.x=y.x,u.y=y.y},1/256)}function Hn(g){return g<0?1+g%1:g%1}function vn(g){return 100*g|0}function $n(g,s,u,y,S){const P=function(D,q){if(D)return S(D);if(q){if(g.url&&q.tiles&&g.tiles&&delete g.tiles,q.variants){if(!Array.isArray(q.variants))return S(new Error("variants must be an array"));for(const Z of q.variants){if(Z==null||typeof Z!="object"||Z.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(Z.capabilities))return S(new Error("capabilities must be an array"));if(Z.capabilities.length===1&&Z.capabilities[0]==="meshopt"){q=i.l(q,Z);break}}}const W=i.ay(i.l({},q,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);W.tiles=s.canonicalizeTileset(W,g.url),S(null,W)}},O=function(D,q,W){if(!D)return null;if(!q&&!W)return D;W=W||D.worldview_default;const Z=Object.values(D.language||{});if(Z.length===0)return null;const te=Object.values(D.worldview||{});if(te.length===0)return null;const re=Z.every(ye=>ye===q),ae=te.every(ye=>ye===W);return re&&ae?D:q in(D.language_options||{})||W in(D.worldview_options||{})?null:D.language_options&&D.worldview_options?D:null}(g.data,u,y);return O?i.q.frame(()=>P(null,O)):g.url?i.n(s.transformRequest(s.normalizeSourceURL(g.url,null,u,y),i.R.Source),P):i.q.frame(()=>{const{data:D,...q}=g;P(null,q)})}class Pn{constructor(s,u,y){this.bounds=i.az.convert(this.validateBounds(s)),this.minzoom=u||0,this.maxzoom=y||24}validateBounds(s){return Array.isArray(s)&&s.length===4?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const u=Math.pow(2,s.z),y=Math.floor(i.at(this.bounds.getWest())*u),S=Math.floor(i.aA(this.bounds.getNorth())*u),P=Math.ceil(i.at(this.bounds.getEast())*u),O=Math.ceil(i.aA(this.bounds.getSouth())*u);return s.x>=y&&s.x<P&&s.y>=S&&s.y<O}}class Oa extends i.E{constructor(s,u,y,S){if(super(),this.id=s,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(u,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new i.aB}load(s){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,u,y,(S,P)=>{if(this._tileJSONRequest=null,this._loaded=!0,S)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new i.y(S));else if(P){if(i.l(this,P),this.hasWorldviews=!!P.worldview_options,P.worldview_default&&(this.worldviewDefault=P.worldview_default),P.vector_layers){this.vectorLayers=P.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const O of P.vector_layers)this.vectorLayerIds.push(O.id),P.worldview&&P.worldview[O.source]&&this.localizableLayerIds.add(O.id)}P.bounds&&(this.tileBounds=new Pn(P.bounds,this.minzoom,this.maxzoom)),ht(P.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}s&&s(S)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(s,u){const y=s.tileID.canonical.url(this.tiles,this.scheme),S=this.map._requestManager.normalizeTileURL(y),P=this.map._requestManager.transformRequest(S,i.R.Tile),O=this.map.style?this.map.style.getLut(this.scope):null,D=O?{image:O.image.clone()}:null,q={request:P,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:D,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(y)&&(q.worldview=this.map.getWorldview()||this.worldviewDefault,q.localizableLayerIds=this.localizableLayerIds),q.request.collectResourceTiming=this._collectResourceTiming,s.actor&&s.state!=="expired")s.state==="loading"?s.reloadCallback=u:s.request=s.actor.send("reloadTile",q,W.bind(this));else if(s.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",q,W.bind(this),void 0,!0);else{const Z=i.aD.call({deduped:this._deduped},q,(te,re)=>{te||!re?W.call(this,te):(q.data={cacheControl:re.cacheControl,expires:re.expires,rawData:re.rawData.slice(0)},s.actor&&s.actor.send("loadTile",q,W.bind(this),void 0,!0))},!0);s.request={cancel:Z}}function W(Z,te){return delete s.request,s.aborted?u(null):Z&&Z.status!==404?u(Z):(te&&te.resourceTiming&&(s.resourceTiming=te.resourceTiming),this.map._refreshExpiredTiles&&te&&s.setExpiryData(te),s.loadVectorData(te,this.map.painter),i.aE(this.dispatcher),u(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,u){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ho extends i.E{constructor(s,u,y,S){super(),this.id=s,this.dispatcher=y,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},u),i.l(this,i.ay(u,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=$n(this._options,this.map._requestManager,null,null,(u,y)=>{this._tileJSONRequest=null,this._loaded=!0,u?this.fire(new i.y(u)):y&&(i.l(this,y),y.raster_layers&&(this.rasterLayers=y.raster_layers,this.rasterLayerIds=this.rasterLayers.map(S=>S.id)),y.bounds&&(this.tileBounds=new Pn(y.bounds,this.minzoom,this.maxzoom)),ht(y.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),s&&s(u)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,u){const y=i.q.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);s.request=i.o(this.map._requestManager.transformRequest(S,i.R.Tile),(P,O,D,q)=>(delete s.request,s.aborted?(s.state="unloaded",u(null)):P?(s.state="errored",u(P)):O?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:D,expires:q}),s.setTexture(O,this.map.painter),s.state="loaded",i.aE(this.dispatcher),void u(null)):u(null)))}abortTile(s,u){s.request&&(s.request.cancel(),delete s.request),u&&u()}unloadTile(s,u){s.texture&&s.texture instanceof i.T?(s.destroy(!0),s.texture&&s.texture instanceof i.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ga extends ho{constructor(s,u,y,S){super(s,u,y,S),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},u)}triggerRepaint(s){const u=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);u&&u.enabled&&y&&u._clearRenderCacheForTile(y.id,s.tileID),this.map.triggerRepaint()}loadTile(s,u){const y=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(y,i.R.Tile);s.requestParams=S,s.actor||(s.actor=this.dispatcher.getActor()),s.request=s.fetchHeader(void 0,(P,O,D,q)=>{if(delete s.request,s.aborted)return s.state="unloaded",u(null);if(P)return P.code===20?void 0:(s.state="errored",u(P));this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:D,expires:q}),s.state="empty",u(null)})}unloadTile(s,u){const y=s.texture;y&&y instanceof i.T?(s.destroy(!0),this.map.painter.saveTileTexture(y)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,u,y){s._isHeaderLoaded&&(s.state!=="empty"&&(s.state="reloading"),s.fetchBand(u,y,(S,P)=>{if(S)return s.state="errored",this.fire(new i.y(S)),void this.triggerRepaint(s);P&&(s.setTexture(P,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:P})=>P===s),y=u&&u.fields,S=y&&y.bands&&y.bands;return S?S[0]:0}getTextureDescriptor(s,u,y){if(!s)return;const S=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let P=null;u instanceof i.aH?P=u.paint.get("raster-array-band"):u instanceof i.aI&&(P=u.paint.get("raster-particle-array-band"));const O=P||this.getInitialBand(S);if(O!=null)if(s.textureDescriptor){if(!s.updateNeeded(S,O)||y)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,S,O)}}const to={vector:Oa,raster:ho,"raster-dem":class extends ho{constructor(g,s,u,y){super(g,s,u,y),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(g,s){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(S,P){S&&(g.state="errored",s(S)),P&&(g.dem=P,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",s(null))}g.request=i.o(this.map._requestManager.transformRequest(u,i.R.Tile),(function(S,P,O,D){if(delete g.request,g.aborted)g.state="unloaded",s(null);else if(S)g.state="errored",s(S);else if(P){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:O,expires:D});const q=ImageBitmap&&P instanceof ImageBitmap&&i.t(),W=1-(P.width-i.aF(P.width))/2;W<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const Z=q?P:i.q.getImageData(P,W),te={uid:g.uid,coord:g.tileID,source:this.id,scope:this.scope,rawImageData:Z,encoding:this.encoding,padding:W};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",te,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const s=g.canonical,u=Math.pow(2,s.z),y=(s.x-1+u)%u,S=s.x===0?g.wrap-1:g.wrap,P=(s.x+1+u)%u,O=s.x+1===u?g.wrap+1:g.wrap,D={};return D[new i.aG(g.overscaledZ,S,s.z,y,s.y).key]={backfilled:!1},D[new i.aG(g.overscaledZ,O,s.z,P,s.y).key]={backfilled:!1},s.y>0&&(D[new i.aG(g.overscaledZ,S,s.z,y,s.y-1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,g.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,O,s.z,P,s.y-1).key]={backfilled:!1}),s.y+1<u&&(D[new i.aG(g.overscaledZ,S,s.z,y,s.y+1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,g.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},D[new i.aG(g.overscaledZ,O,s.z,P,s.y+1).key]={backfilled:!1}),D}},"raster-array":Ga,geojson:class extends i.E{constructor(g,s,u,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(y),this._data=s.data,this._options=i.l({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.minzoom!==void 0&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const S=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*S,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*S,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:i.ag,radius:(s.clusterRadius!==void 0?s.clusterRadius:50)*S,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const s=new Map;for(const u of this._data.features)s.set(u.id,u);for(const u of g.features)s.set(u.id,u);this._data.features=[...s.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},s),this}getClusterChildren(g,s){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},s),this}getClusterLeaves(g,s,u,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:s,offset:u},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const s=i.l({append:g},this.workerOptions);s.scope=this.scope;const u=this._data;typeof u=="string"?(s.request=this.map._requestManager.transformRequest(i.q.resolveURL(u),i.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(y,S)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new i.y(y));else{const P={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(P.resourceTiming=S.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new i.z("data",P)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,s){const u=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,S=y?{image:y.image.clone()}:null,P=this._partialReload,O={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:P};g.request=this.actor.send(u,O,(D,q)=>P&&!q?(g.state="loaded",s(null)):(delete g.request,g.destroy(),g.aborted?s(null):D?s(D):(g.loadVectorData(q,this.map.painter,u==="reloadTile"),s(null))),void 0,u==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,s){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(g,s,u,y){super(g,s,u,y),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const s of g.urls)this.urls.push(this.map._requestManager.transformRequest(s,i.R.Source).url);i.aK(this.urls,(s,u)=>{this._loaded=!0,s?this.fire(new i.y(s)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const s=this.video.seekable;g<s.start(0)||g>s.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,s=g.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(g,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(g,s,u,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const g=[];for(const s in this._options.models){const u=this._options.models[s],y=i.aM(this.map._requestManager.transformRequest(u.uri,i.R.Model).url).then(S=>{if(!S)return;const P=i.aN(S),O=new i.aO(s,u.position,u.orientation,P);O.computeBoundsAndApplyParent(),this.models.push(O)}).catch(S=>{this.fire(new i.y(new Error(`Could not load model ${s} from ${u.uri}: ${S.message}`)))});g.push(y)}return Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this.fire(new i.y(new Error(`Could not load models: ${s.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,s){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(g,s,u,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=$n(this._options,this.map._requestManager,s,u,(y,S)=>{this._tileJSONRequest=null,this._loaded=!0,y?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new i.y(y))):S&&(i.l(this,S),S.bounds&&(this.tileBounds=new Pn(S.bounds,this.minzoom,this.maxzoom)),ht(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,s){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(u,i.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=s;else{if(g.buckets){const P=Object.values(g.buckets);for(const O of P)O.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,S.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,S.bind(this),void 0,!0);function S(P,O){return g.aborted?s(null):P&&P.status!==404?s(P):(this.map._refreshExpiredTiles&&O&&g.setExpiryData(O),g.loadModelData(O,this.map.painter),g.state="loaded",void s(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(g,s,u,y){super(g,s,u,y),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(P=>typeof P!="number"))||this.fire(new i.y(new i.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends i.E{constructor(g,s,u,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=s,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Pn(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:s,y:u,z:y}=g.canonical;return this._implementation.hasTile({x:s,y:u,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,s){const{x:u,y,z:S}=g.tileID.canonical,P=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:u,y,z:S},{signal:P.signal})).then((function(O){return delete g.request,g.aborted?(g.state="unloaded",s(null)):O===void 0?(g.state="errored",s(null)):O===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",s(null)):function(D){return D instanceof ImageData||D instanceof HTMLCanvasElement||D instanceof ImageBitmap||D instanceof HTMLImageElement}(O)?(this.loadTileData(g,O),g.state="loaded",void s(null)):(g.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(O=>{O.code!==20&&(g.state="errored",s(O))}),g.request.cancel=()=>P.abort()}loadTileData(g,s){g.setTexture(s,this.map.painter)}unloadTile(g,s){if(g.texture&&g.texture instanceof i.T?(g.destroy(!0),g.texture&&g.texture instanceof i.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:u,y,z:S}=g.tileID.canonical;this._implementation.unloadTile({x:u,y,z:S})}s&&s()}abortTile(g,s){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},as=function(g,s,u,y){const S=new to[s.type](g,s,u,y);if(S.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${S.id}`);return i.aP(["load","abort","unload","serialize","prepare"],S),S};function Nu(g,s,u=""){return`${u}:${s.id||""}:${s.layer.id}:${function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:S,importId:P}=y;return`featureset:${S}${P?`:import:${P}`:""}`}}(g.target)}`}function bl(g,s,u,y=""){if(g.uniqueFeatureID){const S=Nu(g,s,y);if(u.has(S))return!0;u.add(S)}return!1}function $c(g,s,u,y,S=!1){const P=s.sourceCache.transform,O=s.sourceCache.tilesIn(g,s.has3DLayers,S);O.sort(ay);const D=[];for(const q of O){const W=q.tile.queryRenderedFeatures(s,q,u,y,P,S);Object.keys(W).length&&D.push({wrappedTileID:q.tile.tileID.wrapped().key,queryResults:W})}return D.length===0?{}:function(q){const W={},Z={};for(const te of q){const re=te.queryResults,ae=te.wrappedTileID,ye=Z[ae]=Z[ae]||{};for(const fe in re){const xe=re[fe],_e=ye[fe]=ye[fe]||{},Ee=W[fe]=W[fe]||[];for(const Fe of xe)_e[Fe.featureIndex]||(_e[Fe.featureIndex]=!0,Ee.push(Fe))}}return W}(D)}function Hh(g,s,u,y,S){const P={},O=y.queryRenderedSymbols(g),D=[];for(const q of Object.keys(O).map(Number))D.push(S[q]);D.sort(ay);for(const q of D){const W=q.featureIndex.lookupSymbolFeatures(O[q.bucketInstanceId],q.bucketIndex,q.sourceLayerIndex,s,u);for(const Z in W){const te=P[Z]=P[Z]||[],re=W[Z];re.sort((ae,ye)=>{const fe=q.featureSortOrder;if(fe){const xe=fe.indexOf(ae.featureIndex);return fe.indexOf(ye.featureIndex)-xe}return ye.featureIndex-ae.featureIndex});for(const ae of re)te.push(ae)}}return P}function Qv(g,s){const u=g.getRenderableIds().map(P=>g.getTileByID(P)),y=[],S={};for(let P=0;P<u.length;P++){const O=u[P],D=O.tileID.canonical.key;S[D]||(S[D]=!0,O.querySourceFeatures(y,s))}return y}function ay(g,s){const u=g.tileID,y=s.tileID;return u.overscaledZ-y.overscaledZ||u.canonical.y-y.canonical.y||u.wrap-y.wrap||u.canonical.x-y.canonical.x}function np(g,s){const u={};if(!s)return u;for(const y of g){const S=y.layerIds.map(P=>s.getLayer(P)).filter(Boolean);if(S.length!==0){y.layers=S,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(P=>S.filter(O=>O.id===P)[0]));for(const P of S)u[P.fqid]=y}}return u}const $o=32,il=33,al=new Uint16Array(8184);for(let g=0;g<2046;g++){let s=g+2,u=0,y=0,S=0,P=0,O=0,D=0;for(1&s?S=P=O=$o:u=y=D=$o;(s>>=1)>1;){const W=u+S>>1,Z=y+P>>1;1&s?(S=u,P=y,u=O,y=D):(u=S,y=P,S=O,P=D),O=W,D=Z}const q=4*g;al[q+0]=u,al[q+1]=y,al[q+2]=S,al[q+3]=P}const dc=new Uint16Array(2178),ol=new Uint8Array(1089),yi=new Uint16Array(1089);function ip(g){return g===0?-.03125:g===32?.03125:0}const wm={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class hc{constructor(s,u,y,S,P){this.tileID=s,this.uid=i.aV(),this.uses=0,this.tileSize=u,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=P,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection)}registerFadeDuration(s){const u=s+this.timeAdded;u<i.q.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,u,y){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=np(s.buckets,u.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const P=this.buckets[S];if(P instanceof i.aX){if(this.hasSymbolBuckets=!0,!y)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const P=this.buckets[S];if(P instanceof i.aX&&P.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const S in this.buckets){const P=this.buckets[S],O=u.style.getOwnLayer(S);if(!O)continue;const D=O.queryRadius(P);this.queryPadding=Math.max(this.queryPadding,D)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,u,y){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets=Object.assign({},this.buckets,np(s.buckets,u.style)),s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const S in this.buckets){const P=this.buckets[S];P.uploadPending()&&P.upload(s)}const u=s.gl,y=this.imageAtlas;if(y&&!y.uploaded){const S=!!Object.keys(y.patternPositions).length;this.imageAtlasTexture=new i.T(s,y.image,u.RGBA8,{useMipmap:S}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(s,this.glyphAtlasImage,u.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(s,this.lineAtlas.image,u.R8),this.lineAtlas.uploaded=!0)}prepare(s,u,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,y),!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=u.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==S),this._lastUpdatedBrightness=S))}queryRenderedFeatures(s,u,y,S,P,O){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const D=function(q,W){const Z=i.ab.mat4.fromScaling([],[.5*q.width,.5*-q.height,1]);return i.ab.mat4.translate(Z,Z,[1,-1,0]),i.ab.mat4.multiply(Z,Z,q.calculateProjMatrix(W.toUnwrapped())),Float32Array.from(Z)}(P,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:u,pixelPosMatrix:D,transform:S,availableImages:y,tileTransform:this.tileTransform})}querySourceFeatures(s,u){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const S=y.loadVTLayers(),P=u?u.sourceLayer:"",O=S._geojsonTileLayer||S[P];if(!O)return;const D=i.aZ(u&&u.filter),{z:q,x:W,y:Z}=this.tileID.canonical,te={z:q,x:W,y:Z};for(let re=0;re<O.length;re++){const ae=O.feature(re);if(D.needGeometry){const xe=i.a_(ae,!0);if(!D.filter(new i.a8(this.tileID.overscaledZ),xe,this.tileID.canonical))continue}else if(!D.filter(new i.a8(this.tileID.overscaledZ),ae))continue;const ye=y.getId(ae,P),fe=new i.a$(ae,q,W,Z,ye);fe.tile=te,s.push(fe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const u=this.expirationTime;if(s.cacheControl){const y=i.b0(s.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const y=Date.now();let S=!1;if(this.expirationTime>y)S=!1;else if(u)if(this.expirationTime<u)S=!0;else{const P=this.expirationTime-u;P?this.expirationTime=y+Math.max(P,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,u){if(!this.latestFeatureIndex||!s.style)return;const y=this.latestFeatureIndex.loadVTLayers(),S=s.style.listImages(),P=s.style.getBrightness();for(const O in this.buckets){if(!s.style.hasLayer(O))continue;const D=this.buckets[O],q=D.layers[0],W=q.sourceLayer||"_geojsonTileLayer",Z=y[W],te=s.style.getLayerSourceCache(q);let re={};te&&(re=te._state.getState(W,void 0));const ae=this.imageAtlas&&this.imageAtlas.patternPositions||{},ye=Object.keys(re).length>0&&!u;ye&&!D.stateDependentLayers.length&&!u||D.update(re,Z,S,ae,ye?D.stateDependentLayers:D.layers,u,P),(D instanceof i.b1||D instanceof i.b2)&&s._terrain&&s._terrain.enabled&&te&&D.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(te.id,this.tileID);const fe=s&&s.style&&s.style.getOwnLayer(O);fe&&(this.queryPadding=Math.max(this.queryPadding,fe.queryRadius(D)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=i.q.now()+s}setTexture(s,u){const y=u.context,S=y.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s):(this.texture=new i.T(y,s,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(s,u){const y={};for(const S of u)y[S]=!0;this.dependencies[s]=y}hasDependency(s,u){for(const y of s){const S=this.dependencies[y];if(S){for(const P of u)if(S[P])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const y=i.b3(wm,this.tileID.canonical,this.tileTransform)[0],S=new i.b4,P=new i.b5;for(let O=0;O<y.length;O++){const{x:D,y:q}=y[O];S.emplaceBack(D,q),P.emplaceBack(O)}P.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(P),this._tileDebugBuffer=s.createVertexBuffer(S,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,S.length,P.length)}_makeTileBoundsBuffers(s,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const y=i.b3(wm,this.tileID.canonical,this.tileTransform)[0];let S,P;if(this.isRaster){const O=function(D,q){const W=i.aQ(D,q),Z=Math.pow(2,D.z);for(let xe=0;xe<il;xe++)for(let _e=0;_e<il;_e++){const Ee=i.aR((D.x+(_e+ip(_e))/$o)/Z),Fe=i.aS((D.y+(xe+ip(xe))/$o)/Z),De=q.project(Ee,Fe),Ze=xe*il+_e;dc[2*Ze+0]=Math.round((De.x*W.scale-W.x)*i.ag),dc[2*Ze+1]=Math.round((De.y*W.scale-W.y)*i.ag)}ol.fill(0),yi.fill(0);for(let xe=2045;xe>=0;xe--){const _e=4*xe,Ee=al[_e+0],Fe=al[_e+1],De=al[_e+2],Ze=al[_e+3],Ue=Ee+De>>1,qe=Fe+Ze>>1,Ve=Ue+qe-Fe,Ke=qe+Ee-Ue,it=Fe*il+Ee,_t=Ze*il+De,pt=qe*il+Ue,Ct=Math.hypot((dc[2*it+0]+dc[2*_t+0])/2-dc[2*pt+0],(dc[2*it+1]+dc[2*_t+1])/2-dc[2*pt+1])>=16;ol[pt]=ol[pt]||(Ct?1:0),xe<1022&&(ol[pt]=ol[pt]||ol[(Fe+Ke>>1)*il+(Ee+Ve>>1)]||ol[(Ze+Ke>>1)*il+(De+Ve>>1)])}const te=new i.aT,re=new i.aU;let ae=0;function ye(xe,_e){const Ee=_e*il+xe;return yi[Ee]===0&&(te.emplaceBack(dc[2*Ee+0],dc[2*Ee+1],xe*i.ag/$o,_e*i.ag/$o),yi[Ee]=++ae),yi[Ee]-1}function fe(xe,_e,Ee,Fe,De,Ze){const Ue=xe+Ee>>1,qe=_e+Fe>>1;if(Math.abs(xe-De)+Math.abs(_e-Ze)>1&&ol[qe*il+Ue])fe(De,Ze,xe,_e,Ue,qe),fe(Ee,Fe,De,Ze,Ue,qe);else{const Ve=ye(xe,_e),Ke=ye(Ee,Fe),it=ye(De,Ze);re.emplaceBack(Ve,Ke,it)}}return fe(0,0,$o,$o,$o,0),fe($o,$o,0,0,0,$o),{vertices:te,indices:re}}(this.tileID.canonical,u);S=O.vertices,P=O.indices}else{S=new i.aT,P=new i.aU;for(const{x:D,y:q}of y)S.emplaceBack(D,q,0,0);const O=i.b8(S.int16,void 0,4);for(let D=0;D<O.length;D+=3)P.emplaceBack(O[D],O[D+1],O[D+2])}this._tileBoundsBuffer=s.createVertexBuffer(S,i.b9.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(P),this._tileBoundsSegments=i.b7.simpleSegment(0,0,S.length,P.length)}_makeGlobeTileDebugBuffers(s,u){const y=u.projection;if(!y||y.name!=="globe"||u.freezeTileCoverage)return;const S=this.tileID.canonical,P=i.ba(S,u),O=i.bb(P),D=i.ae(u.zoom);let q;D>0&&(q=i.ab.mat4.invert(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,S,u,O,q,D),this._makeGlobeTileDebugTextBuffer(s,S,u,O,q,D)}_globePoint(s,u,y,S,P,O,D){let q=i.bc(s,u,y);if(O){const W=1<<y.z,Z=i.at(S.center.lng),te=i.aA(S.center.lat),re=(y.x+.5)/W-Z;let ae=0;re>.5?ae=-1:re<-.5&&(ae=1);let ye=(s/i.ag+y.x)/W+ae,fe=(u/i.ag+y.y)/W;ye=(ye-Z)*S._pixelsPerMercatorPixel+Z,fe=(fe-te)*S._pixelsPerMercatorPixel+te;const xe=[ye*S.worldSize,fe*S.worldSize,0];i.ab.vec3.transformMat4(xe,xe,O),q=i.bd(q,xe,D)}return i.ab.vec3.transformMat4(q,q,P)}_makeGlobeTileDebugBorderBuffer(s,u,y,S,P,O){const D=new i.b4,q=new i.b5,W=new i.be,Z=(re,ae,ye,fe,xe)=>{const _e=(ye-re)/(xe-1),Ee=(fe-ae)/(xe-1),Fe=D.length;for(let De=0;De<xe;De++){const Ze=re+De*_e,Ue=ae+De*Ee;D.emplaceBack(Ze,Ue);const qe=this._globePoint(Ze,Ue,u,y,S,P,O);W.emplaceBack(qe[0],qe[1],qe[2]),q.emplaceBack(Fe+De)}},te=i.ag;Z(0,0,te,0,16),Z(te,0,te,te,16),Z(te,te,0,te,16),Z(0,te,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(q),this._tileDebugBuffer=s.createVertexBuffer(D,i.b6.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(W,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,D.length,q.length)}_makeGlobeTileDebugTextBuffer(s,u,y,S,P,O){const D=i.ag/4,q=new i.b4,W=new i.aU,Z=new i.be,te=25;W.reserve(32),q.reserve(te),Z.reserve(te);const re=(ae,ye)=>te*ae+ye;for(let ae=0;ae<te;ae++){const ye=ae*D;for(let fe=0;fe<te;fe++){const xe=fe*D;q.emplaceBack(xe,ye);const _e=this._globePoint(xe,ye,u,y,S,P,O);Z.emplaceBack(_e[0],_e[1],_e[2])}}for(let ae=0;ae<4;ae++)for(let ye=0;ye<4;ye++){const fe=re(ae,ye),xe=re(ae,ye+1),_e=re(ae+1,ye),Ee=re(ae+1,ye+1);W.emplaceBack(fe,xe,_e),W.emplaceBack(_e,xe,Ee)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(W),this._tileDebugTextBuffer=s.createVertexBuffer(q,i.b6.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(Z,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,te,32)}destroy(s=!1){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class qc extends hc{constructor(s,u,y,S,P){super(s,u,y,S,P),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(s,u){const y=u.context,S=y.gl;this.texture=this.texture||u.getTileTexture(s.width),this.texture&&this.texture instanceof i.T?this.texture.update(s,{premultiply:!1}):this.texture=new i.T(y,s,S.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,u){const y=this._mrt=new i.bg(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=i.bi(S,(P,O,D,q)=>{if(P)u(P);else try{const W=y.getHeaderLength(O);if(W>s)return void(this.request=this.fetchHeader(W,u));y.parseHeader(O),this._isHeaderLoaded=!0;let Z=0;for(const te of Object.values(y.layers))Z=Math.max(Z,te.dataIndex[te.dataIndex.length-1].last_byte);O.byteLength>=Z&&(this.entireBuffer=O),u(null,this.entireBuffer||O,D,q)}catch(W){u(W)}}),this.request}fetchBand(s,u,y){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void y(new Error("Tile header is not ready"));const P=this.actor;if(!P)return void y(new Error("Can't fetch tile band without an actor"));let O;const D=(te,re)=>{O.complete(te,re),te?y(te):(this.updateTextureDescriptor(s,u),y(null,this.textureDescriptor&&this.textureDescriptor.img))},q=(te,re)=>{if(te)return y(te);const ae=P.send("decodeRasterArray",{buffer:re,task:O},D,void 0,!0);this._workQueue.push(()=>{ae&&ae.cancel(),O.cancel()})},W=S.getLayer(s);if(!W)return void y(new Error(`Unknown sourceLayer "${s}"`));if(W.hasDataForBand(u))return this.updateTextureDescriptor(s,u),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const Z=W.getDataRange([u]);if(O=S.createDecodingTask(Z),!O||O.tasks.length)if(this.flushQueues(),this.entireBuffer)q(null,this.entireBuffer.slice(Z.firstByte,Z.lastByte+1));else{const te=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Z.firstByte}-${Z.lastByte}`}}),re=i.bi(te,q);this._fetchQueue.push(()=>{re.cancel(),O.cancel()})}else y(null)}updateNeeded(s,u){return(!this.textureDescriptor||this.textureDescriptor.band!==u||this.textureDescriptor.layer!==s)&&this.state!=="errored"}updateTextureDescriptor(s,u){if(!this._mrt)return;const y=this._mrt.getLayer(s);if(!y||!y.hasBand(u)||!y.hasDataForBand(u))return;const{bytes:S,tileSize:P,buffer:O,offset:D,scale:q}=y.getBandView(u),W=P+2*O,Z={data:S,width:W,height:W},te=this.texture;te&&te instanceof i.T&&te.update(Z,{premultiply:!1}),this.textureDescriptor={layer:s,band:u,img:Z,buffer:O,offset:D,tileSize:P,format:y.pixelFormat,mix:[q,256*q,65536*q,16777216*q]}}}class oy{constructor(s,u){this.max=s,this.onRemove=u,this.reset()}reset(){for(const s in this.data)for(const u of this.data[s])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(s,u,y){const S=s.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const P={value:u,timeout:void 0};if(y!==void 0&&(P.timeout=setTimeout(()=>{this.remove(s,P)},y)),this.data[S].push(P),this.order.push(S),this.order.length>this.max){const O=this._getAndRemoveByKey(this.order[0]);O&&this.onRemove(O)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const u=this.data[s].shift();return u.timeout&&clearTimeout(u.timeout),this.data[s].length===0&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),u.value}getByKey(s){const u=this.data[s];return u?u[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,u){if(!this.has(s))return this;const y=s.wrapped().key,S=u===void 0?0:this.data[y].indexOf(u),P=this.data[y][S];return this.data[y].splice(S,1),P.timeout&&clearTimeout(P.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(P.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(s){const u=[];for(const y in this.data)for(const S of this.data[y])s(S.value)||u.push(S);for(const y of u)this.remove(y.value.tileID,y)}}class Sm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,u,y){const S=String(u);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][S]=this.stateChanges[s][S]||{},i.l(this.stateChanges[s][S],y),this.deletedStates[s]===null){this.deletedStates[s]={};for(const P in this.state[s])P!==S&&(this.deletedStates[s][P]=null)}else if(this.deletedStates[s]&&this.deletedStates[s][S]===null){this.deletedStates[s][S]={};for(const P in this.state[s][S])y[P]||(this.deletedStates[s][S][P]=null)}else for(const P in y)this.deletedStates[s]&&this.deletedStates[s][S]&&this.deletedStates[s][S][P]===null&&delete this.deletedStates[s][S][P]}removeFeatureState(s,u,y){if(this.deletedStates[s]===null)return;const S=String(u);if(this.deletedStates[s]=this.deletedStates[s]||{},y&&u!==void 0)this.deletedStates[s][S]!==null&&(this.deletedStates[s][S]=this.deletedStates[s][S]||{},this.deletedStates[s][S][y]=null);else if(u!==void 0)if(this.stateChanges[s]&&this.stateChanges[s][S])for(y in this.deletedStates[s][S]={},this.stateChanges[s][S])this.deletedStates[s][S][y]=null;else this.deletedStates[s][S]=null;else this.deletedStates[s]=null}getState(s,u){const y=this.state[s]||{},S=this.stateChanges[s]||{},P=this.deletedStates[s];if(P===null)return{};if(u!==void 0){const D=String(u),q=i.l({},y[D],S[D]);if(P){const W=P[u];if(W===null)return{};for(const Z in W)delete q[Z]}return q}const O=i.l({},y,S);if(P)for(const D in P)delete O[D];return O}initializeTileState(s,u){s.refreshFeatureState(u)}coalesceChanges(s,u){const y={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const P={};for(const O in this.stateChanges[S])this.state[S][O]||(this.state[S][O]={}),i.l(this.state[S][O],this.stateChanges[S][O]),P[O]=this.state[S][O];y[S]=P}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const P={};if(this.deletedStates[S]===null)for(const O in this.state[S])P[O]={},this.state[S][O]={};else for(const O in this.deletedStates[S]){if(this.deletedStates[S][O]===null)this.state[S][O]={};else if(this.state[S][O])for(const D of Object.keys(this.deletedStates[S][O]))delete this.state[S][O][D];P[O]=this.state[S][O]}y[S]=y[S]||{},i.l(y[S],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const S in s)s[S].refreshFeatureState(u)}}class Ls extends i.E{constructor(s,u,y){super(),this.id=s,this._onlySymbols=y,u.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new oy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Sm,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(s){this.map=s,this._minTileCacheSize=this._minTileCacheSize===void 0&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const u=this._tiles[s];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,u){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,u)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const y=this._tiles[u];y.upload(s),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(s=>s.tileID).sort(Jn).map(s=>s.key)}getRenderableIds(s,u){const y=[];for(const S in this._tiles)this._isIdRenderable(+S,s,u)&&y.push(this._tiles[S]);return s?y.sort((S,P)=>{const O=S.tileID,D=P.tileID,q=new i.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle),W=new i.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return O.overscaledZ-D.overscaledZ||W.y-q.y||W.x-q.x}).map(S=>S.tileID.key):y.map(S=>S.tileID).sort(Jn).map(S=>S.key)}hasRenderableParent(s){const u=this.findLoadedParent(s,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(s,u,y){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(u||!this._tiles[s].holdingForFade())&&(y||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)this._tiles[s].state!=="errored"&&this._reloadTile(+s,"reloading")}}_reloadTile(s,u){const y=this._tiles[s];y&&(y.state!=="loading"&&(y.state=u),this._loadTile(y,this._tileLoaded.bind(this,y,s,u)))}_tileLoaded(s,u,y,S){if(S)if(s.state="errored",S.status!==404)this._source.fire(new i.y(S,{tile:s}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const P=this.map.painter.terrain;this.update(this.transform,P.getScaledDemTileSize(),!0),P.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=i.q.now(),y==="expired"&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(u,s),this._source.type==="raster-dem"&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const u=this.getRenderableIds();for(let S=0;S<u.length;S++){const P=u[S];if(s.neighboringTiles&&s.neighboringTiles[P]){const O=this.getTileByID(P);y(s,O),y(O,s)}}function y(S,P){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let O=P.tileID.canonical.x-S.tileID.canonical.x;const D=P.tileID.canonical.y-S.tileID.canonical.y,q=Math.pow(2,S.tileID.canonical.z),W=P.tileID.key;O===0&&D===0||Math.abs(D)>1||(Math.abs(O)>1&&(Math.abs(O+q)===1?O+=q:Math.abs(O-q)===1&&(O-=q)),P.dem&&S.dem&&(S.dem.backfillBorder(P.dem,O,D),S.neighboringTiles&&S.neighboringTiles[W]&&(S.neighboringTiles[W].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,u,y,S){for(const P in this._tiles){let O=this._tiles[P];if(S[P]||!O.hasData()||O.tileID.overscaledZ<=u||O.tileID.overscaledZ>y)continue;let D=O.tileID;for(;O&&O.tileID.overscaledZ>u+1;){const W=O.tileID.scaledTo(O.tileID.overscaledZ-1);O=this._tiles[W.key],O&&O.hasData()&&(D=W)}let q=D;for(;q.overscaledZ>u;)if(q=q.scaledTo(q.overscaledZ-1),s[q.key]){S[D.key]=D;break}}}findLoadedParent(s,u){if(s.key in this._loadedParentTiles){const y=this._loadedParentTiles[s.key];return y&&y.tileID.overscaledZ>=u?y:null}for(let y=s.overscaledZ-1;y>=u;y--){const S=s.scaledTo(y),P=this._getLoadedTile(S);if(P)return P}}_getLoadedTile(s){const u=this._tiles[s.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,u){u=u||this._source.tileSize;const y=Math.ceil(s.width/u)+1,S=Math.ceil(s.height/u)+1,P=Math.floor(y*S*5),O=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,P):P,D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,O):O;this._cache.setMaxSize(D)}handleWrapJump(s){const u=Math.round((s-(this._prevLng===void 0?s:this._prevLng))/360);if(this._prevLng=s,u){const y={};for(const S in this._tiles){const P=this._tiles[S];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+u),y[P.tileID.key]=P}this._tiles=y;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(s,u,y,S){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(s,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let O,D=this._source.maxzoom;const q=this.map&&this.map.painter?this.map.painter._terrain:null;if(q&&q.sourceCache===this&&q.attenuationRange()){const te=q.attenuationRange()[0],re=Math.floor(te)-Math.log2(q.getDemUpscale());D>re&&(D=re)}if(this.used||this.usedForTerrain){if(this._source.tileID)O=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(te=>new i.aG(te.canonical.z,te.wrap,te.canonical.z,te.canonical.x,te.canonical.y));else if(this.tileCoverLift!==0){const te=s.clone();te.tileCoverLift=this.tileCoverLift,O=te.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&s.projection.name==="globe"&&(O.push(new i.aG(1,0,1,0,0)),O.push(new i.aG(1,0,1,1,0)),O.push(new i.aG(1,0,1,0,1)),O.push(new i.aG(1,0,1,1,1)))}else if(O=s.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const te=this._source.hasTile.bind(this._source);O=O.filter(re=>te(re))}}else O=[];if(O.length>0&&this.castsShadows&&S&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!fc(this._source.type)){const te=s.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),re=Math.min(te,this._source.maxzoom);if(P){const ae=s.extendTileCover(O,re);for(const ye of ae)O.push(ye)}else{const ae=s.extendTileCover(O,re,S);for(const ye of ae)this._shadowCasterTiles[ye.key]=!0,O.push(ye)}}const W=this._updateRetainedTiles(O);if(fc(this._source.type)&&O.length!==0){const te={},re={},ae=Object.keys(W);for(const fe of ae){const xe=W[fe],_e=this._tiles[fe];if(!_e||_e.fadeEndTime&&_e.fadeEndTime<=i.q.now())continue;const Ee=this.findLoadedParent(xe,Math.max(xe.overscaledZ-Ls.maxOverzooming,this._source.minzoom));Ee&&(this._addTile(Ee.tileID),te[Ee.tileID.key]=Ee.tileID),re[fe]=xe}const ye=O[O.length-1].overscaledZ;for(const fe in this._tiles){const xe=this._tiles[fe];if(W[fe]||!xe.hasData())continue;let _e=xe.tileID;for(;_e.overscaledZ>ye;){_e=_e.scaledTo(_e.overscaledZ-1);const Ee=this._tiles[_e.key];if(Ee&&Ee.hasData()&&re[_e.key]){W[fe]=xe.tileID;break}}}for(const fe in te)W[fe]||(this._coveredTiles[fe]=!0,W[fe]=te[fe])}for(const te in W)this._tiles[te].clearFadeHold();const Z=i.bk(this._tiles,W);for(const te of Z){const re=this._tiles[te];re.hasSymbolBuckets&&!re.holdingForFade()?re.setHoldDuration(this.map._fadeDuration):re.hasSymbolBuckets&&!re.symbolFadeFinished()||this._removeTile(+te)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const u={};if(s.length===0)return u;const y={},S=s.reduce((W,Z)=>Math.min(W,Z.overscaledZ),1/0),P=s[0].overscaledZ,O=Math.max(P-Ls.maxOverzooming,this._source.minzoom),D=Math.max(P+Ls.maxUnderzooming,this._source.minzoom),q={};for(const W of s){const Z=this._addTile(W);u[W.key]=W,Z.hasData()||S<this._source.maxzoom&&(q[W.key]=W)}this._retainLoadedChildren(q,S,D,u);for(const W of s){let Z=this._tiles[W.key];if(Z.hasData())continue;if(W.canonical.z>=this._source.maxzoom){const re=W.children(this._source.maxzoom)[0],ae=this.getTile(re);if(ae&&ae.hasData()){u[re.key]=re;continue}}else{const re=W.children(this._source.maxzoom);if(u[re[0].key]&&u[re[1].key]&&u[re[2].key]&&u[re[3].key])continue}let te=Z.wasRequested();for(let re=W.overscaledZ-1;re>=O;--re){const ae=W.scaledTo(re);if(y[ae.key]||(y[ae.key]=!0,Z=this.getTile(ae),!Z&&te&&(Z=this._addTile(ae)),Z&&(u[ae.key]=ae,te=Z.wasRequested(),Z.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const u=[];let y,S=this._tiles[s].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){y=this._loadedParentTiles[S.key];break}u.push(S.key);const P=S.scaledTo(S.overscaledZ-1);if(y=this._getLoadedTile(P),y)break;S=P}for(const P of u)this._loadedParentTiles[P]=y}}_addTile(s){let u=this._tiles[s.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),u;u=this._cache.getAndRemove(s),u&&(this._setTileReloadTimer(s.key,u),u.tileID=s,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,u)));const y=!!u;if(!y){const S=this.map?this.map.painter:null,P=this._source.tileSize*s.overscaleFactor();u=this._source.type==="raster-array"?new qc(s,P,this.transform.tileZoom,S,this._isRaster):new hc(s,P,this.transform.tileZoom,S,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,s.key,u.state))}return u?(u.uses++,this._tiles[s.key]=u,y||this._source.fire(new i.z("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(s,u){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const y=u.getExpiryTimeout();y&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},y))}_removeTile(s){const u=this._tiles[s];u&&(u.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,u,y){const S=[],P=this.transform;if(!P)return S;const O=P.projection.name==="globe",D=i.at(P.center.lng);for(const q in this._tiles){const W=this._tiles[q];if(y&&W.clearQueryDebugViz(),W.holdingForFade())continue;let Z;if(O){const te=W.tileID.canonical;if(te.z===0){const re=[Math.abs(i.aw(D,...Dr(te,-1))-D),Math.abs(i.aw(D,...Dr(te,1))-D)];Z=[0,2*re.indexOf(Math.min(...re))-1]}else{const re=[Math.abs(i.aw(D,...Dr(te,-1))-D),Math.abs(i.aw(D,...Dr(te,0))-D),Math.abs(i.aw(D,...Dr(te,1))-D)];Z=[re.indexOf(Math.min(...re))-1]}}else Z=[0];for(const te of Z){const re=s.containsTile(W,P,u,te);re&&S.push(re)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,u){const y=this.getRenderableIds(s,u).map(P=>this._tiles[P].tileID),S=this.transform.projection.name==="globe";for(const P of y)P.projMatrix=this.transform.calculateProjMatrix(P.toUnwrapped()),P.expandedProjMatrix=S?this.transform.calculateProjMatrix(P.toUnwrapped(),!1,!0):P.projMatrix;return y}sortCoordinatesByDistance(s){const u=s.slice(),y=this.transform._camera.position,S=this.transform._camera.forward(),P={};for(const O of u){const D=1/(1<<O.canonical.z);P[O.key]=((O.canonical.x+.5)*D+O.wrap-y[0])*S[0]+((O.canonical.y+.5)*D-y[1])*S[1]-y[2]*S[2]}return u.sort((O,D)=>P[O.key]-P[D.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(fc(this._source.type))for(const s in this._tiles){const u=this._tiles[s];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(s,u,y){this._state.updateState(s=s||"_geojsonTileLayer",u,y)}removeFeatureState(s,u,y){this._state.removeFeatureState(s=s||"_geojsonTileLayer",u,y)}getFeatureState(s,u){return this._state.getState(s=s||"_geojsonTileLayer",u)}setDependencies(s,u,y){const S=this._tiles[s];S&&S.setDependencies(u,y)}reloadTilesForDependencies(s,u){for(const y in this._tiles)this._tiles[y].hasDependency(s,u)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(s,u))}_preloadTiles(s,u){if(!this._sourceLoaded){const q=()=>{this._sourceLoaded&&(this._source.off("data",q),this._preloadTiles(s,u))};return void this._source.on("data",q)}const y=new Map,S=Array.isArray(s)?s:[s],P=this.map.painter.terrain,O=this.usedForTerrain&&P?P.getScaledDemTileSize():this._source.tileSize;for(const q of S){const W=q.coveringTiles({tileSize:O,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Z of W)y.set(Z.key,Z);this.usedForTerrain&&q.updateElevation(!1)}const D=Array.from(y.values());i.bl(D,(q,W)=>{const Z=new hc(q,this._source.tileSize*q.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Z,te=>{this._source.type==="raster-dem"&&Z.dem&&this._backfillDEM(Z),W(te,Z)})},u)}}function Jn(g,s){const u=Math.abs(2*g.wrap)-+(g.wrap<0),y=Math.abs(2*s.wrap)-+(s.wrap<0);return g.overscaledZ-s.overscaledZ||y-u||s.canonical.y-g.canonical.y||s.canonical.x-g.canonical.x}function fc(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Dr(g,s){const u=1<<g.z;return[g.x/u+s,(g.x+1)/u+s]}Ls.maxOverzooming=10,Ls.maxUnderzooming=3;class Gc{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,u=!1;for(const y in this.style._mergedLayers){const S=this.style._mergedLayers[y];if(S.type==="fill-extrusion")this.layers.push({layer:S,visible:s,visibilityChanged:u});else if(S.type==="model"){const P=this.style.getLayerSource(S);P&&P.type==="batched-model"&&this.layers.push({layer:S,visible:s,visibilityChanged:u})}}}onNewFrame(s){this.layersGotHidden=!1;for(const u of this.layers){const y=u.layer;let S=!1;y.type==="fill-extrusion"?S=!y.isHidden(s)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(S=!y.isHidden(s)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!S&&u.visible,u.visible=S}}updateZOffset(s,u){this.currentBuildingBuckets=[];for(const S of this.layers){const P=S.layer,O=this.style.getLayerSourceCache(P);let D=1;P.type==="fill-extrusion"&&(D=S.visible?P.paint.get("fill-extrusion-vertical-scale"):0);let q=O?O.getTile(u):null;if(!q&&O&&u.canonical.z>O.getSource().minzoom){let W=u.scaledTo(Math.min(O.getSource().maxzoom,u.overscaledZ-1));for(;W.overscaledZ>=O.getSource().minzoom&&(q=O.getTile(W),!q&&W.overscaledZ!==0);)W=W.scaledTo(W.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:q?q.getBucket(P):null,tileID:q?q.tileID:u,verticalScale:D})}s.hasAnyZOffset=!1;let y=!1;for(let S=0;S<s.symbolInstances.length;S++){const P=s.symbolInstances.get(S),O=P.zOffset,D=this._getHeightAtTileOffset(u,P.tileAnchorX,P.tileAnchorY);P.zOffset=D!==Number.NEGATIVE_INFINITY?D:O,y||O===P.zOffset||(y=!0),s.hasAnyZOffset||P.zOffset===0||(s.hasAnyZOffset=!0)}y&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,u,y,S){let P=u,O=y;if(s.canonical.z!==S.canonical.z){const D=S.canonical,q=1/(1<<s.canonical.z-D.z);P=(u+s.canonical.x*i.ag)*q-D.x*i.ag|0,O=(y+s.canonical.y*i.ag)*q-D.y*i.ag|0}return{tileX:P,tileY:O}}_getHeightAtTileOffset(s,u,y){let S,P;for(let O=0;O<this.layers.length;++O){if(this.layers[O].layer.type!=="fill-extrusion")continue;const{bucket:D,tileID:q,verticalScale:W}=this.currentBuildingBuckets[O];if(!D)continue;const{tileX:Z,tileY:te}=this._mapCoordToOverlappingTile(s,u,y,q),re=D.getHeightAtTileCoord(Z,te);re&&re.height!==void 0&&(re.hidden?S=re.height:P=Math.max(re.height*W,P||0))}if(P!==void 0)return P;for(let O=0;O<this.layers.length;++O){const D=this.layers[O];if(D.layer.type!=="model"||!D.visible)continue;const{bucket:q,tileID:W}=this.currentBuildingBuckets[O];if(!q)continue;const{tileX:Z,tileY:te}=this._mapCoordToOverlappingTile(s,u,y,W),re=q.getHeightAtTileCoord(Z,te);if(re&&!re.hidden)return re.height===void 0&&S!==void 0?Math.min(re.maxHeight,S)*re.verticalScale:re.height?re.height*re.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Iu(g,s){const u={};for(const y in g)y!=="ref"&&(u[y]=g[y]);return i.bm.forEach(y=>{y in s&&(u[y]=s[y])}),u}function Du(g){g=g.slice();const s=Object.create(null);for(let u=0;u<g.length;u++)s[g[u].id]=g[u];for(let u=0;u<g.length;u++)"ref"in g[u]&&(g[u]=Iu(g[u],s[g[u].ref]));return g}const dn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Am(g,s,u){u.push({command:dn.addSource,args:[g,s[g]]})}function Lu(g,s,u){s.push({command:dn.removeSource,args:[g]}),u[g]=!0}function _r(g,s,u,y){Lu(g,u,y),Am(g,s,u)}function pi(g,s,u){let y;for(y in g[u])if(g[u].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[u][y],s[u][y]))return!1;for(y in s[u])if(s[u].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[u][y],s[u][y]))return!1;return!0}function Wn(g,s,u,y,S,P){let O;for(O in s=s||{},g=g||{})g.hasOwnProperty(O)&&(i.bn(g[O],s[O])||u.push({command:P,args:[y,O,s[O],S]}));for(O in s)s.hasOwnProperty(O)&&!g.hasOwnProperty(O)&&(i.bn(g[O],s[O])||u.push({command:P,args:[y,O,s[O],S]}))}function fo(g){return g.id}function pc(g,s){return g[s.id]=s,g}class ai{constructor(s,u){this.reset(s,u)}reset(s,u){this.points=s||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(this.points.length===1)return this.points[0];s=i.aw(s,0,1);let u=1,y=this._distances[u];const S=s*this.paddedLength+this.padding;for(;y<S&&u<this._distances.length;)y=this._distances[++u];const P=u-1,O=this._distances[P],D=y-O,q=D>0?(S-O)/D:0;return this.points[P].mult(1-q).add(this.points[u].mult(q))}}class Kc{constructor(s,u,y){const S=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(s/y),this.yCellCount=Math.ceil(u/y);for(let O=0;O<this.xCellCount*this.yCellCount;O++)S.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=u,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,u,y,S,P){this._forEachCell(u,y,S,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(u),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(P)}insertCircle(s,u,y,S){this._forEachCell(u-S,y-S,u+S,y+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(u),this.circles.push(y),this.circles.push(S)}_insertBoxCell(s,u,y,S,P,O){this.boxCells[P].push(O)}_insertCircleCell(s,u,y,S,P,O){this.circleCells[P].push(O)}_query(s,u,y,S,P,O){if(y<0||s>this.width||S<0||u>this.height)return!P&&[];const D=[];if(s<=0&&u<=0&&this.width<=y&&this.height<=S){if(P)return!0;for(let q=0;q<this.boxKeys.length;q++)D.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(let q=0;q<this.circleKeys.length;q++){const W=this.circles[3*q],Z=this.circles[3*q+1],te=this.circles[3*q+2];D.push({key:this.circleKeys[q],x1:W-te,y1:Z-te,x2:W+te,y2:Z+te})}return O?D.filter(O):D}return this._forEachCell(s,u,y,S,this._queryCell,D,{hitTest:P,seenUids:{box:{},circle:{}}},O),P?D.length>0:D}_queryCircle(s,u,y,S,P){const O=s-y,D=s+y,q=u-y,W=u+y;if(D<0||O>this.width||W<0||q>this.height)return!S&&[];const Z=[];return this._forEachCell(O,q,D,W,this._queryCellCircle,Z,{hitTest:S,circle:{x:s,y:u,radius:y},seenUids:{box:{},circle:{}}},P),S?Z.length>0:Z}query(s,u,y,S,P){return this._query(s,u,y,S,!1,P)}hitTest(s,u,y,S,P){return this._query(s,u,y,S,!0,P)}hitTestCircle(s,u,y,S){return this._queryCircle(s,u,y,!0,S)}_queryCell(s,u,y,S,P,O,D,q){const W=D.seenUids,Z=this.boxCells[P];if(Z!==null){const re=this.bboxes;for(const ae of Z)if(!W.box[ae]){W.box[ae]=!0;const ye=4*ae;if(s<=re[ye+2]&&u<=re[ye+3]&&y>=re[ye+0]&&S>=re[ye+1]&&(!q||q(this.boxKeys[ae]))){if(D.hitTest)return O.push(!0),!0;O.push({key:this.boxKeys[ae],x1:re[ye],y1:re[ye+1],x2:re[ye+2],y2:re[ye+3]})}}}const te=this.circleCells[P];if(te!==null){const re=this.circles;for(const ae of te)if(!W.circle[ae]){W.circle[ae]=!0;const ye=3*ae;if(this._circleAndRectCollide(re[ye],re[ye+1],re[ye+2],s,u,y,S)&&(!q||q(this.circleKeys[ae]))){if(D.hitTest)return O.push(!0),!0;{const fe=re[ye],xe=re[ye+1],_e=re[ye+2];O.push({key:this.circleKeys[ae],x1:fe-_e,y1:xe-_e,x2:fe+_e,y2:xe+_e})}}}}}_queryCellCircle(s,u,y,S,P,O,D,q){const W=D.circle,Z=D.seenUids,te=this.boxCells[P];if(te!==null){const ae=this.bboxes;for(const ye of te)if(!Z.box[ye]){Z.box[ye]=!0;const fe=4*ye;if(this._circleAndRectCollide(W.x,W.y,W.radius,ae[fe+0],ae[fe+1],ae[fe+2],ae[fe+3])&&(!q||q(this.boxKeys[ye])))return O.push(!0),!0}}const re=this.circleCells[P];if(re!==null){const ae=this.circles;for(const ye of re)if(!Z.circle[ye]){Z.circle[ye]=!0;const fe=3*ye;if(this._circlesCollide(ae[fe],ae[fe+1],ae[fe+2],W.x,W.y,W.radius)&&(!q||q(this.circleKeys[ye])))return O.push(!0),!0}}}_forEachCell(s,u,y,S,P,O,D,q){const W=this._convertToXCellCoord(s),Z=this._convertToYCellCoord(u),te=this._convertToXCellCoord(y),re=this._convertToYCellCoord(S);for(let ae=W;ae<=te;ae++)for(let ye=Z;ye<=re;ye++)if(P.call(this,s,u,y,S,this.xCellCount*ye+ae,O,D,q))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,u,y,S,P,O){const D=S-s,q=P-u,W=y+O;return W*W>D*D+q*q}_circleAndRectCollide(s,u,y,S,P,O,D){const q=(O-S)/2,W=Math.abs(s-(S+q));if(W>q+y)return!1;const Z=(D-P)/2,te=Math.abs(u-(P+Z));if(te>Z+y)return!1;if(W<=q||te<=Z)return!0;const re=W-q,ae=te-Z;return re*re+ae*ae<=y*y}}const zs={unknown:0,flipRequired:1,flipNotRequired:2},mc=Math.tan(85*Math.PI/180);function Ka(g,s,u,y,S,P,O){const D=i.ab.mat4.create();if(u)if(P.name==="globe"){const q=i.bo(S,s);i.ab.mat4.multiply(D,D,q)}else{const q=i.ab.mat2.invert([],O);D[0]=q[0],D[1]=q[1],D[4]=q[2],D[5]=q[3],y||i.ab.mat4.rotateZ(D,D,S.angle)}else i.ab.mat4.multiply(D,S.labelPlaneMatrix,g);return D}function pa(g,s,u,y,S,P,O){const D=Ka(g,s,u,y,S,P,O);return P.name==="globe"&&u||(D[2]=D[6]=D[10]=D[14]=0),D}function sy(g,s,u,y,S,P,O){if(u){if(P.name==="globe"){const D=Ka(g,s,u,y,S,P,O);return i.ab.mat4.invert(D,D),i.ab.mat4.multiply(D,g,D),D}{const D=i.ab.mat4.clone(g),q=i.ab.mat4.identity([]);return q[0]=O[0],q[1]=O[1],q[4]=O[2],q[5]=O[3],i.ab.mat4.multiply(D,D,q),y||i.ab.mat4.rotateZ(D,D,-S.angle),D}}return S.glCoordMatrix}function qo(g,s,u,y){const S=[g,s,u,1];u?i.ab.vec4.transformMat4(S,S,y):Ra(S,S,y);const P=S[3];return S[0]/=P,S[1]/=P,S[2]/=P,S}function Rd(g,s){return Math.min(.5+g/s*.5,1.5)}function kd(g,s){const u=g[0]/g[3],y=g[1]/g[3];return u>=-s[0]&&u<=s[0]&&y>=-s[1]&&y<=s[1]}function ap(g,s,u,y,S,P,O,D,q,W){const Z=u.transform,te=y?g.textSizeData:g.iconSizeData,re=i.bp(te,u.transform.zoom),ae=Z.projection.name==="globe",ye=[256/u.width*2+1,256/u.height*2+1],fe=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;fe.clear();let xe=null;ae&&(xe=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const _e=g.lineVertexArray,Ee=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,Fe=u.transform.width/u.transform.height;let De,Ze=!1;for(let Ue=0;Ue<Ee.length;Ue++){const qe=Ee.get(Ue),{numGlyphs:Ve,writingMode:Ke}=qe;if(Ke!==i.bq.vertical||Ze||De===i.bq.horizontal||(Ze=!0),De=Ke,(qe.hidden||Ke===i.bq.vertical)&&!Ze){na(Ve,fe);continue}Ze=!1;const it=new i.P(qe.tileAnchorX,qe.tileAnchorY);let{x:_t,y:pt,z:Ct}=Z.projection.projectTilePoint(it.x,it.y,W.canonical);if(q){const[Nt,qt,er]=q(it);_t+=Nt,pt+=qt,Ct+=er}const Mt=[_t,pt,Ct,1];if(i.ab.vec4.transformMat4(Mt,Mt,s),!kd(Mt,ye)){na(Ve,fe);continue}const ut=Mt[3],Tt=Rd(u.transform.getCameraToCenterDistance(Z.projection),ut),Bt=i.br(te,re,qe),ft=O?Bt/Tt:Bt*Tt,Dt=qo(_t,pt,Ct,S);if(Dt[3]<=0){na(Ve,fe);continue}let Pt={};const Zt=O?null:q,zt=sl(qe,ft,!1,D,s,S,P,g.glyphOffsetArray,_e,fe,xe,Dt,it,Pt,Fe,Zt,Z.projection,W,O);Ze=zt.useVertical,Zt&&zt.needsFlipping&&(Pt={}),(zt.notEnoughRoom||Ze||zt.needsFlipping&&sl(qe,ft,!0,D,s,S,P,g.glyphOffsetArray,_e,fe,xe,Dt,it,Pt,Fe,Zt,Z.projection,W,O).notEnoughRoom)&&na(Ve,fe)}y?(g.text.dynamicLayoutVertexBuffer.updateData(fe),xe&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(xe)):(g.icon.dynamicLayoutVertexBuffer.updateData(fe),xe&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(xe))}function wl(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe){const{lineStartIndex:xe,glyphStartIndex:_e,segment:Ee}=D,Fe=_e+D.numGlyphs,De=xe+D.lineLength,Ze=s.getoffsetX(_e),Ue=s.getoffsetX(Fe-1),qe=Sl(g*Ze,u,y,S,P,O,Ee,xe,De,q,W,Z,te,re,!0,ae,ye,fe);if(!qe)return null;const Ve=Sl(g*Ue,u,y,S,P,O,Ee,xe,De,q,W,Z,te,re,!0,ae,ye,fe);return Ve?{first:qe,last:Ve}:null}function Ao(g,s,u,y){return g===i.bq.horizontal&&Math.abs(y)>Math.abs(u)?{useVertical:!0}:g===i.bq.vertical?y>0?{needsFlipping:!0}:null:s!==zs.unknown&&function(S,P){return S===0||Math.abs(P/S)>mc}(u,y)?s===zs.flipRequired?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function sl(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e,Ee){const Fe=s/24,De=g.lineOffsetX*Fe,Ze=g.lineOffsetY*Fe,{lineStartIndex:Ue,glyphStartIndex:qe,numGlyphs:Ve,segment:Ke,writingMode:it,flipState:_t}=g,pt=Ue+g.lineLength,Ct=Mt=>{if(Z){const[ft,Dt,Pt]=Mt.up,Zt=W.length;i.bs(Z,Zt+0,ft,Dt,Pt),i.bs(Z,Zt+1,ft,Dt,Pt),i.bs(Z,Zt+2,ft,Dt,Pt),i.bs(Z,Zt+3,ft,Dt,Pt)}const[ut,Tt,Bt]=Mt.point;i.bt(W,ut,Tt,Bt,Mt.angle)};if(Ve>1){const Mt=wl(Fe,D,De,Ze,u,te,re,g,q,P,ae,fe,!1,xe,_e,Ee);if(!Mt)return{notEnoughRoom:!0};if(y&&!u){let[ut,Tt,Bt]=Mt.first.point,[ft,Dt,Pt]=Mt.last.point;[ut,Tt]=qo(ut,Tt,Bt,O),[ft,Dt]=qo(ft,Dt,Pt,O);const Zt=Ao(it,_t,(ft-ut)*ye,Dt-Tt);if(g.flipState=Zt&&Zt.needsFlipping?zs.flipRequired:zs.flipNotRequired,Zt)return Zt}Ct(Mt.first);for(let ut=qe+1;ut<qe+Ve-1;ut++){const Tt=Sl(Fe*D.getoffsetX(ut),De,Ze,u,te,re,Ke,Ue,pt,q,P,ae,fe,!1,!1,xe,_e,Ee);if(!Tt)return W.length-=4*(ut-qe),{notEnoughRoom:!0};Ct(Tt)}Ct(Mt.last)}else{if(y&&!u){const ut=qo(re.x,re.y,0,S),Tt=Ue+Ke+1,Bt=new i.P(q.getx(Tt),q.gety(Tt)),ft=qo(Bt.x,Bt.y,0,S),Dt=ft[3]>0?ft:Zh(re,Bt,ut,1,S,void 0,xe,_e.canonical),Pt=Ao(it,_t,(Dt[0]-ut[0])*ye,Dt[1]-ut[1]);if(g.flipState=Pt&&Pt.needsFlipping?zs.flipRequired:zs.flipNotRequired,Pt)return Pt}const Mt=Sl(Fe*D.getoffsetX(qe),De,Ze,u,te,re,Ke,Ue,pt,q,P,ae,fe,!1,!1,xe,_e,Ee);if(!Mt)return{notEnoughRoom:!0};Ct(Mt)}return{}}function To(g,s,u,y,S){const{x:P,y:O,z:D}=y.projectTilePoint(g.x,g.y,s);if(!S)return qo(P,O,D,u);const[q,W,Z]=S(g);return qo(P+q,O+W,D+Z,u)}function Zh(g,s,u,y,S,P,O,D){const q=To(g.sub(s)._unit()._add(g),D,S,O,P);return i.ab.vec3.sub(q,u,q),i.ab.vec3.normalize(q,q),i.ab.vec3.scaleAndAdd(q,u,q,y)}function Sl(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e){const Ee=y?g-s:g+s;let Fe=Ee>0?1:-1,De=0;y&&(Fe*=-1,De=Math.PI),Fe<0&&(De+=Math.PI);let Ze=D+O+(Fe>0?0:1)|0,Ue=S,qe=S,Ve=0,Ke=0;const it=Math.abs(Ee),_t=[],pt=[];let Ct=P,Mt=Ct;const ut=()=>Zh(Mt,Ct,qe,it-Ve+1,Z,re,fe,xe.canonical);for(;Ve+Ke<=it;){if(Ze+=Fe,Ze<D||Ze>=q)return null;if(qe=Ue,Mt=Ct,_t.push(qe),ae&&pt.push(Mt),Ct=new i.P(W.getx(Ze),W.gety(Ze)),Ue=te[Ze],!Ue){const qt=To(Ct,xe.canonical,Z,fe,re);Ue=qt[3]>0?te[Ze]=qt:ut()}Ve+=Ke,Ke=i.ab.vec3.distance(qe,Ue)}ye&&re&&(te[Ze]&&(Ue=ut(),Ke=i.ab.vec3.distance(qe,Ue)),te[Ze]=Ue);const Tt=(it-Ve)/Ke,Bt=Ct.sub(Mt)._mult(Tt)._add(Mt),ft=i.ab.vec3.sub([],Ue,qe),Dt=i.ab.vec3.scaleAndAdd([],qe,ft,Tt);let Pt=[0,0,1],Zt=ft[0],zt=ft[1];if(_e&&(Pt=fe.upVector(xe.canonical,Bt.x,Bt.y),Pt[0]!==0||Pt[1]!==0||Pt[2]!==1)){const qt=[Pt[2],0,-Pt[0]],er=i.ab.vec3.cross([],Pt,qt);i.ab.vec3.normalize(qt,qt),i.ab.vec3.normalize(er,er),Zt=i.ab.vec3.dot(ft,qt),zt=i.ab.vec3.dot(ft,er)}if(u){const qt=i.ab.vec3.cross([],Pt,ft);i.ab.vec3.normalize(qt,qt),i.ab.vec3.scaleAndAdd(Dt,Dt,qt,u*Fe)}const Nt=De+Math.atan2(zt,Zt);return _t.push(Dt),ae&&pt.push(Bt),{point:Dt,angle:Nt,path:_t,tilePath:pt,up:Pt}}function na(g,s){const u=s.length,y=u+4*g;s.resize(y),s.float32.fill(-1/0,4*u,4*y)}function Ra(g,s,u){const y=s[0],S=s[1];return g[0]=u[0]*y+u[4]*S+u[12],g[1]=u[1]*y+u[5]*S+u[13],g[3]=u[3]*y+u[7]*S+u[15],g}const ka=100;class ma{constructor(s,u,y=new Kc(s.width+200,s.height+200,25),S=new Kc(s.width+200,s.height+200,25)){this.transform=s,this.grid=y,this.ignoredGrid=S,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+ka,this.screenBottomBoundary=s.height+ka,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=u}placeCollisionBox(s,u,y,S,P,O,D,q){let W=y.projectedAnchorX,Z=y.projectedAnchorY,te=y.projectedAnchorZ;const re=y.elevation,ae=y.tileID,ye=s.getProjection();if(re&&ae){const[Ue,qe,Ve]=ye.upVector(ae.canonical,y.tileAnchorX,y.tileAnchorY),Ke=ye.upVectorScale(ae.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=Ue*re*Ke,Z+=qe*re*Ke,te+=Ve*re*Ke}const fe=this.projectAndGetPerspectiveRatio(D,W,Z,te,y.tileID,ye.name==="globe"||!!re||this.transform.pitch>0,ye),xe=O*fe.perspectiveRatio,_e=(y.x1*u+S.x-y.padding)*xe+fe.point.x,Ee=(y.y1*u+S.y-y.padding)*xe+fe.point.y,Fe=(y.x2*u+S.x+y.padding)*xe+fe.point.x,De=(y.y2*u+S.y+y.padding)*xe+fe.point.y,Ze=fe.perspectiveRatio<=.55||fe.occluded;return!this.isInsideGrid(_e,Ee,Fe,De)||!P&&this.grid.hitTest(_e,Ee,Fe,De,q)||Ze?{box:[],offscreen:!1,occluded:fe.occluded}:{box:[_e,Ee,Fe,De],offscreen:this.isOffscreen(_e,Ee,Fe,De),occluded:!1}}placeCollisionCircles(s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe){const xe=[],_e=this.transform.elevation,Ee=s.getProjection(),Fe=_e?_e.getAtTileOffsetFunc(fe,this.transform.center.lat,this.transform.worldSize,Ee):null,De=new i.P(y.tileAnchorX,y.tileAnchorY);let{x:Ze,y:Ue,z:qe}=Ee.projectTilePoint(De.x,De.y,fe.canonical);if(Fe){const[Bt,ft,Dt]=Fe(De);Ze+=Bt,Ue+=ft,qe+=Dt}const Ve=Ee.name==="globe",Ke=this.projectAndGetPerspectiveRatio(D,Ze,Ue,qe,fe,Ve||!!_e||this.transform.pitch>0,Ee),{perspectiveRatio:it}=Ke,_t=(te?O/it:O*it)/i.bw,pt=qo(Ze,Ue,qe,q),Ct=Ke.signedDistanceFromCamera>0?wl(_t,P,y.lineOffsetX*_t,y.lineOffsetY*_t,!1,pt,De,y,S,q,{},_e&&!te?Fe:null,te&&!!_e,Ee,fe,te):null;let Mt=!1,ut=!1,Tt=!0;if(Ct&&!Ke.occluded){const Bt=.5*ae*it+ye,ft=new i.P(-100,-100),Dt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Pt=new ai,{first:Zt,last:zt}=Ct,Nt=Zt.path.length;let qt=[];for(let mr=Nt-1;mr>=1;mr--)qt.push(Zt.path[mr]);for(let mr=1;mr<zt.path.length;mr++)qt.push(zt.path[mr]);const er=2.5*Bt;W&&(qt=qt.map(([mr,$r,Or],jr)=>(Fe&&!Ve&&(Or=Fe(jr<Nt-1?Zt.tilePath[Nt-1-jr]:zt.tilePath[jr-Nt+2])[2]),qo(mr,$r,Or,W))),qt.some(mr=>mr[3]<=0)&&(qt=[]));let fr=[];if(qt.length>0){let mr=1/0,$r=-1/0,Or=1/0,jr=-1/0;for(const Wr of qt)mr=Math.min(mr,Wr[0]),Or=Math.min(Or,Wr[1]),$r=Math.max($r,Wr[0]),jr=Math.max(jr,Wr[1]);$r>=ft.x&&mr<=Dt.x&&jr>=ft.y&&Or<=Dt.y&&(fr=[qt.map(Wr=>new i.P(Wr[0],Wr[1]))],(mr<ft.x||$r>Dt.x||Or<ft.y||jr>Dt.y)&&(fr=i.bu(fr,ft.x,ft.y,Dt.x,Dt.y)))}for(const mr of fr){Pt.reset(mr,.25*Bt);let $r=0;$r=Pt.length<=.5*Bt?1:Math.ceil(Pt.paddedLength/er)+1;for(let Or=0;Or<$r;Or++){const jr=Or/Math.max($r-1,1),Wr=Pt.lerp(jr),Mn=Wr.x+ka,hi=Wr.y+ka;xe.push(Mn,hi,Bt,0);const Gi=Mn-Bt,Yn=hi-Bt,Zr=Mn+Bt,_n=hi+Bt;if(Tt=Tt&&this.isOffscreen(Gi,Yn,Zr,_n),ut=ut||this.isInsideGrid(Gi,Yn,Zr,_n),!u&&this.grid.hitTestCircle(Mn,hi,Bt,re)&&(Mt=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:Mt,occluded:!1}}}}return{circles:!Z&&Mt||!ut?[]:xe,offscreen:Tt,collisionDetected:Mt,occluded:Ke.occluded}}queryRenderedSymbols(s){if(s.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let y=1/0,S=1/0,P=-1/0,O=-1/0;for(const Z of s){const te=new i.P(Z.x+ka,Z.y+ka);y=Math.min(y,te.x),S=Math.min(S,te.y),P=Math.max(P,te.x),O=Math.max(O,te.y),u.push(te)}const D=this.grid.query(y,S,P,O).concat(this.ignoredGrid.query(y,S,P,O)),q={},W={};for(const Z of D){const te=Z.key;if(q[te.bucketInstanceId]===void 0&&(q[te.bucketInstanceId]={}),q[te.bucketInstanceId][te.featureIndex])continue;const re=[new i.P(Z.x1,Z.y1),new i.P(Z.x2,Z.y1),new i.P(Z.x2,Z.y2),new i.P(Z.x1,Z.y2)];i.bv(u,re)&&(q[te.bucketInstanceId][te.featureIndex]=!0,W[te.bucketInstanceId]===void 0&&(W[te.bucketInstanceId]=[]),W[te.bucketInstanceId].push(te.featureIndex))}return W}insertCollisionBox(s,u,y,S,P){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:S,collisionGroupID:P},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,u,y,S,P){const O=u?this.ignoredGrid:this.grid,D={bucketInstanceId:y,featureIndex:S,collisionGroupID:P};for(let q=0;q<s.length;q+=4)O.insertCircle(D,s[q],s[q+1],s[q+2])}projectAndGetPerspectiveRatio(s,u,y,S,P,O,D){const q=[u,y,S,1];let W=!1;S||this.transform.pitch>0?(i.ab.vec4.transformMat4(q,q,s),this.fogState&&P&&D.name!=="globe"&&(W=function(re,ae,ye,fe,xe,_e){const Ee=_e.calculateFogTileMatrix(xe),Fe=[ae,ye,fe];return i.ab.vec3.transformMat4(Fe,Fe,Ee),at(re,i.ab.vec3.length(Fe),_e.pitch,_e._fov)}(this.fogState,u,y,S,P.toUnwrapped(),this.transform)>.9)):Ra(q,q,s);const Z=q[3];return{point:new i.P((q[0]/Z+1)/2*this.transform.width+ka,(-q[1]/Z+1)/2*this.transform.height+ka),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/Z*.5,1.5),signedDistanceFromCamera:Z,occluded:O&&q[2]>Z||W}}isOffscreen(s,u,y,S){return y<ka||s>=this.screenRightBoundary||S<ka||u>this.screenBottomBoundary}isInsideGrid(s,u,y,S){return y>=0&&s<this.gridRightBoundary&&S>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const s=i.ab.mat4.identity([]);return i.ab.mat4.translate(s,s,[-100,-100,0]),s}}function Wc(g,s,u){const y=s.createTileMatrix(g,g.worldSize,u.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),g.projMatrix,y)}function Gl(g,s,u){if(s.projection.name===u.projection.name)return g.projMatrix;const y=u.clone();return y.setProjection(s.projection),Wc(y,s.getProjection(),g)}function Hc(g,s,u){return s.name===u.projection.name?g.projMatrix:Wc(u,s,g)}class jd{constructor(s,u,y,S){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?u:-u))):S&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class vs{constructor(s,u,y,S,P,O=!1){this.text=new jd(s?s.text:null,u,y,P),this.icon=new jd(s?s.icon:null,u,S,P),this.clipped=O}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yh{constructor(s,u,y,S=!1){this.text=s,this.icon=u,this.skipFade=y,this.clipped=S}}class gc{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class z0{constructor(s,u,y,S,P){this.bucketInstanceId=s,this.featureIndex=u,this.sourceLayerIndex=y,this.bucketIndex=S,this.tileID=P}}class ly{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const u=++this.maxGroupID;this.collisionGroups[s]={ID:u,predicate:y=>y.collisionGroupID===u}}return this.collisionGroups[s]}}function _s(g,s,u,y,S){const{horizontalAlign:P,verticalAlign:O}=i.bD(g),D=-(P-.5)*s,q=-(O-.5)*u,W=i.bC(g,y);return new i.P(D+W[0]*S,q+W[1]*S)}function op(g,s,u,y,S){const P=new i.P(g,s);return u&&P._rotate(y?S:-S),P}class Tm{constructor(s,u,y,S,P,O){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new ma(this.transform,P),this.buildingIndex=O,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new ly(y),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,u,y,S,P=1){const O=y.getBucket(u),D=y.latestFeatureIndex;if(!O||!D||u.fqid!==O.layerIds[0])return;const q=O.layers[0].layout,W=O.layers[0].paint,Z=y.collisionBoxArray,te=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),re=y.tileSize/i.ag,ae=y.tileID.toUnwrapped();this.transform.setProjection(O.projection);const ye=(fe=y.tileID,xe=O.getProjection(),_e=this.transform,xe.name===this.projection?_e.calculateProjMatrix(fe.toUnwrapped()):Wc(_e,xe,fe));var fe,xe,_e;const Ee=q.get("text-pitch-alignment")==="map",Fe=q.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const De=u.dynamicFilter(),Ze=u.dynamicFilterNeedsFeature(),Ue=this.transform.calculatePixelsToTileUnitsMatrix(y),qe=pa(ye,y.tileID.canonical,Ee,Fe,this.transform,O.getProjection(),Ue);let Ve=null;if(Ee){const Bt=sy(ye,y.tileID.canonical,Ee,Fe,this.transform,O.getProjection(),Ue);Ve=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Bt)}let Ke=null;De&&y.latestFeatureIndex&&(Ke={unwrappedTileID:ae,dynamicFilter:De,dynamicFilterNeedsFeature:Ze}),this.retainedQueryData[O.bucketInstanceId]=new z0(O.bucketInstanceId,D,O.sourceLayerIndex,O.index,y.tileID);const[it,_t]=O.layers[0].layout.get("text-size-scale-range"),pt=i.aw(P,it,_t),[Ct,Mt]=q.get("icon-size-scale-range"),ut=i.aw(P,Ct,Mt),Tt={bucket:O,layout:q,paint:W,posMatrix:ye,textLabelPlaneMatrix:qe,labelToScreenMatrix:Ve,clippingData:Ke,scale:te,textPixelRatio:re,holdingForFade:y.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:i.bp(O.textSizeData,this.transform.zoom,pt),partiallyEvaluatedIconSize:i.bp(O.iconSizeData,this.transform.zoom,ut),collisionGroup:this.collisionGroups.get(O.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(S)for(const Bt of O.sortKeyRanges){const{sortKey:ft,symbolInstanceStart:Dt,symbolInstanceEnd:Pt}=Bt;s.push({sortKey:ft,symbolInstanceStart:Dt,symbolInstanceEnd:Pt,parameters:Tt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:O.symbolInstances.length,parameters:Tt})}attemptAnchorPlacement(s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e,Ee){const{textOffset0:Fe,textOffset1:De,crossTileID:Ze}=re,Ue=[Fe,De],qe=_s(s,y,S,Ue,P),Ve=this.collisionIndex.placeCollisionBox(ye,P,u,op(qe.x,qe.y,O,D,this.transform.angle),te,q,W,Z.predicate);if(xe){const Ke=ye.getSymbolInstanceIconSize(Ee,this.transform.zoom,re.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ye,Ke,xe,op(qe.x,qe.y,O,D,this.transform.angle),te,q,W,Z.predicate).box.length===0)return}if(Ve.box.length>0){let Ke;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ze]&&this.prevPlacement.placements[Ze]&&this.prevPlacement.placements[Ze].text&&(Ke=this.prevPlacement.variableOffsets[Ze].anchor),this.variableOffsets[Ze]={textOffset:Ue,width:y,height:S,anchor:s,textScale:P,prevAnchor:Ke},this.markUsedJustification(ye,s,re,fe),ye.allowVerticalPlacement&&(this.markUsedOrientation(ye,fe,re),this.placedOrientations[Ze]=fe),{shift:qe,placedGlyphBoxes:Ve}}}placeLayerBucketPart(s,u,y,S,P=1){const{bucket:O,layout:D,paint:q,posMatrix:W,textLabelPlaneMatrix:Z,labelToScreenMatrix:te,clippingData:re,textPixelRatio:ae,holdingForFade:ye,collisionBoxArray:fe,partiallyEvaluatedTextSize:xe,partiallyEvaluatedIconSize:_e,collisionGroup:Ee,latestFeatureIndex:Fe}=s.parameters,De=D.get("text-optional"),Ze=D.get("icon-optional"),Ue=D.get("text-allow-overlap"),qe=D.get("icon-allow-overlap"),Ve=D.get("text-rotation-alignment")==="map",Ke=D.get("text-pitch-alignment")==="map",it=D.get("symbol-z-elevate"),_t=q.get("symbol-z-offset"),pt=D.get("symbol-elevation-reference")==="sea",[Ct,Mt]=D.get("text-size-scale-range"),[ut,Tt]=D.get("icon-size-scale-range"),Bt=i.aw(P,Ct,Mt),ft=i.aw(P,ut,Tt);this.transform.setProjection(O.projection);let Dt=Ue&&(qe||!O.hasIconData()||Ze),Pt=qe&&(Ue||!O.hasTextData()||De);const Zt=!_t.isConstant();!O.collisionArrays&&fe&&O.deserializeCollisionBoxes(fe),y&&S&&O.updateCollisionDebugBuffers(this.transform.zoom,fe,Bt,ft);const zt=(Nt,qt,er)=>{const{crossTileID:fr,numVerticalGlyphVertices:mr}=Nt;let $r=null;if(re&&re.dynamicFilterNeedsFeature||Zt){const Pi=this.retainedQueryData[O.bucketInstanceId];$r=Fe.loadFeature({featureIndex:Nt.featureIndex,bucketIndex:Pi.bucketIndex,sourceLayerIndex:Pi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(re&&!(0,re.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},$r,this.retainedQueryData[O.bucketInstanceId].tileID.canonical,new i.P(Nt.tileAnchorX,Nt.tileAnchorY),this.transform.calculateDistanceTileData(re.unwrappedTileID)))return this.placements[fr]=new Yh(!1,!1,!1,!0),void u.add(fr);const Or=_t.evaluate($r,{});if(u.has(fr))return;if(ye)return void(this.placements[fr]=new Yh(!1,!1,!1));let jr=!1,Wr=!1,Mn=!0,hi=!1,Gi=!1,Yn=null,Zr={box:null,offscreen:null,occluded:null},_n={box:null},xr=null,En=null,ei=null,oi=0,Qi=0,aa=0;er.textFeatureIndex?oi=er.textFeatureIndex:Nt.useRuntimeCollisionCircles&&(oi=Nt.featureIndex),er.verticalTextFeatureIndex&&(Qi=er.verticalTextFeatureIndex);const ja=Pi=>{Pi.tileID=this.retainedQueryData[O.bucketInstanceId].tileID;const _i=this.transform.elevation;Pi.elevation=pt?Or:Or+(_i?_i.getAtTileOffset(Pi.tileID,Pi.tileAnchorX,Pi.tileAnchorY):0),Pi.elevation+=Nt.zOffset},Aa=er.textBox;if(Aa){ja(Aa);const Pi=Rn=>{let oa=i.bq.horizontal;if(O.allowVerticalPlacement&&!Rn&&this.prevPlacement){const io=this.prevPlacement.placedOrientations[fr];io&&(this.placedOrientations[fr]=io,oa=io,this.markUsedOrientation(O,oa,Nt))}return oa},_i=(Rn,oa)=>{if(O.allowVerticalPlacement&&mr>0&&er.verticalTextBox){for(const io of O.writingModes)if(io===i.bq.vertical?(Zr=oa(),_n=Zr):Zr=Rn(),Zr&&Zr.box&&Zr.box.length)break}else Zr=Rn()};if(D.get("text-variable-anchor")){let Rn=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[fr]){const Ei=this.prevPlacement.variableOffsets[fr];Rn.indexOf(Ei.anchor)>0&&(Rn=Rn.filter(Lo=>Lo!==Ei.anchor),Rn.unshift(Ei.anchor))}const oa=(Ei,Lo,ml)=>{const yo=O.getSymbolInstanceTextSize(xe,Nt,this.transform.zoom,qt),Ps=(Ei.x2-Ei.x1)*yo+2*Ei.padding,Es=(Ei.y2-Ei.y1)*yo+2*Ei.padding,gl=Nt.hasIconTextFit&&!qe?Lo:null;gl&&ja(gl);let Ii={box:[],offscreen:!1,occluded:!1};const uh=Ue?2*Rn.length:Rn.length;for(let Jl=0;Jl<uh;++Jl){const dh=this.attemptAnchorPlacement(Rn[Jl%Rn.length],Ei,Ps,Es,yo,Ve,Ke,ae,W,Ee,Jl>=Rn.length,Nt,qt,O,ml,gl,xe,_e);if(dh&&(Ii=dh.placedGlyphBoxes,Ii&&Ii.box&&Ii.box.length)){jr=!0,Yn=dh.shift;break}}return Ii};_i(()=>oa(Aa,er.iconBox,i.bq.horizontal),()=>{const Ei=er.verticalTextBox;return Ei&&ja(Ei),O.allowVerticalPlacement&&!(Zr&&Zr.box&&Zr.box.length)&&mr>0&&Ei?oa(Ei,er.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Zr&&(jr=Zr.box,Mn=Zr.offscreen,hi=Zr.occluded);const io=Pi(!(!Zr||!Zr.box));if(!jr&&this.prevPlacement){const Ei=this.prevPlacement.variableOffsets[fr];Ei&&(this.variableOffsets[fr]=Ei,this.markUsedJustification(O,Ei.anchor,Nt,io))}}else{const Rn=(oa,io)=>{const Ei=O.getSymbolInstanceTextSize(xe,Nt,this.transform.zoom,qt,P),Lo=this.collisionIndex.placeCollisionBox(O,Ei,oa,new i.P(0,0),Ue,ae,W,Ee.predicate);return Lo&&Lo.box&&Lo.box.length&&(this.markUsedOrientation(O,io,Nt),this.placedOrientations[fr]=io),Lo};_i(()=>Rn(Aa,i.bq.horizontal),()=>{const oa=er.verticalTextBox;return O.allowVerticalPlacement&&mr>0&&oa?(ja(oa),Rn(oa,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Pi(!!(Zr&&Zr.box&&Zr.box.length))}}if(xr=Zr,jr=xr&&xr.box&&xr.box.length>0,Mn=xr&&xr.offscreen,hi=xr&&xr.occluded,Nt.useRuntimeCollisionCircles){const Pi=O.text.placedSymbolArray.get(Nt.centerJustifiedTextSymbolIndex>=0?Nt.centerJustifiedTextSymbolIndex:Nt.verticalPlacedTextSymbolIndex),_i=i.br(O.textSizeData,xe,Pi),Rn=D.get("text-padding");En=this.collisionIndex.placeCollisionCircles(O,Ue,Pi,O.lineVertexArray,O.glyphOffsetArray,_i,W,Z,te,y,Ke,Ee.predicate,Nt.collisionCircleDiameter*_i/i.bw,Rn,this.retainedQueryData[O.bucketInstanceId].tileID),jr=Ue||En.circles.length>0&&!En.collisionDetected,Mn=Mn&&En.offscreen,hi=En.occluded}if(er.iconFeatureIndex&&(aa=er.iconFeatureIndex),er.iconBox){const Pi=_i=>{ja(_i);const Rn=Nt.hasIconTextFit&&Yn?op(Yn.x,Yn.y,Ve,Ke,this.transform.angle):new i.P(0,0),oa=O.getSymbolInstanceIconSize(_e,this.transform.zoom,Nt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(O,oa,_i,Rn,qe,ae,W,Ee.predicate)};_n&&_n.box&&_n.box.length&&er.verticalIconBox?(ei=Pi(er.verticalIconBox),Wr=ei.box.length>0):(ei=Pi(er.iconBox),Wr=ei.box.length>0),Mn=Mn&&ei.offscreen,Gi=ei.occluded}const Co=De||Nt.numHorizontalGlyphVertices===0&&mr===0,Mo=Ze||Nt.numIconVertices===0;if(Co||Mo?Mo?Co||(Wr=Wr&&jr):jr=Wr&&jr:Wr=jr=Wr&&jr,jr&&xr&&xr.box&&this.collisionIndex.insertCollisionBox(xr.box,D.get("text-ignore-placement"),O.bucketInstanceId,_n&&_n.box&&Qi?Qi:oi,Ee.ID),Wr&&ei&&this.collisionIndex.insertCollisionBox(ei.box,D.get("icon-ignore-placement"),O.bucketInstanceId,aa,Ee.ID),En&&(jr&&this.collisionIndex.insertCollisionCircles(En.circles,D.get("text-ignore-placement"),O.bucketInstanceId,oi,Ee.ID),y)){const Pi=O.bucketInstanceId;let _i=this.collisionCircleArrays[Pi];_i===void 0&&(_i=this.collisionCircleArrays[Pi]=new gc);for(let Rn=0;Rn<En.circles.length;Rn+=4)_i.circles.push(En.circles[Rn+0]),_i.circles.push(En.circles[Rn+1]),_i.circles.push(En.circles[Rn+2]),_i.circles.push(En.collisionDetected?1:0)}const ki=O.projection.name!=="globe";Dt=Dt&&(ki||!hi),Pt=Pt&&(ki||!Gi),this.placements[fr]=new Yh(jr||Dt,Wr||Pt,Mn||O.justReloaded),u.add(fr)};if(it&&this.buildingIndex&&(this.buildingIndex.updateZOffset(O,this.retainedQueryData[O.bucketInstanceId].tileID),O.updateZOffset()),O.sortFeaturesByY){const Nt=O.getSortedSymbolIndexes(this.transform.angle);for(let qt=Nt.length-1;qt>=0;--qt){const er=Nt[qt];zt(O.symbolInstances.get(er),er,O.collisionArrays[er])}O.hasAnyZOffset&&i.w(`${O.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(O.hasAnyZOffset){const Nt=O.getSortedIndexesByZOffset();for(let qt=0;qt<Nt.length;++qt){const er=Nt[qt];zt(O.symbolInstances.get(er),er,O.collisionArrays[er])}}else for(let Nt=s.symbolInstanceStart;Nt<s.symbolInstanceEnd;Nt++)zt(O.symbolInstances.get(Nt),Nt,O.collisionArrays[Nt]);if(y&&O.bucketInstanceId in this.collisionCircleArrays){const Nt=this.collisionCircleArrays[O.bucketInstanceId];i.ab.mat4.invert(Nt.invProjMatrix,W),Nt.viewportMatrix=this.collisionIndex.getViewportMatrix()}O.justReloaded=!1}markUsedJustification(s,u,y,S){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:q,crossTileID:W}=y,Z=i.bB(u),te=S===i.bq.vertical?q:Z==="left"?P:Z==="center"?O:Z==="right"?D:-1;P>=0&&(s.text.placedSymbolArray.get(P).crossTileID=te>=0&&P!==te?0:W),O>=0&&(s.text.placedSymbolArray.get(O).crossTileID=te>=0&&O!==te?0:W),D>=0&&(s.text.placedSymbolArray.get(D).crossTileID=te>=0&&D!==te?0:W),q>=0&&(s.text.placedSymbolArray.get(q).crossTileID=te>=0&&q!==te?0:W)}markUsedOrientation(s,u,y){const S=u===i.bq.horizontal||u===i.bq.horizontalOnly?u:0,P=u===i.bq.vertical?u:0,{leftJustifiedTextSymbolIndex:O,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:q,verticalPlacedTextSymbolIndex:W}=y,Z=s.text.placedSymbolArray;O>=0&&(Z.get(O).placedOrientation=S),D>=0&&(Z.get(D).placedOrientation=S),q>=0&&(Z.get(q).placedOrientation=S),W>=0&&(Z.get(W).placedOrientation=P)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let y=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const S=u?u.symbolFadeChange(s):1,P=u?u.opacities:{},O=u?u.variableOffsets:{},D=u?u.placedOrientations:{};for(const q in this.placements){const W=this.placements[q],Z=P[q];Z?(this.opacities[q]=new vs(Z,S,W.text,W.icon,null,W.clipped),y=y||W.text!==Z.text.placed||W.icon!==Z.icon.placed):(this.opacities[q]=new vs(null,S,W.text,W.icon,W.skipFade,W.clipped),y=y||W.text||W.icon)}for(const q in P){const W=P[q];if(!this.opacities[q]){const Z=new vs(W,S,!1,!1);Z.isHidden()||(this.opacities[q]=Z,y=y||W.text.placed||W.icon.placed)}}for(const q in O)this.variableOffsets[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.variableOffsets[q]=O[q]);for(const q in D)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=D[q]);y?this.lastPlacementChangeTime=s:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:s)}updateLayerOpacities(s,u,y,S){const P=new Set;for(const O of u){const D=O.getBucket(s);D&&O.latestFeatureIndex&&s.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,P,O,O.collisionBoxArray,y,S,O.tileID,s.scope),D.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(D,O.tileID),D.updateZOffset()))}}updateBucketOpacities(s,u,y,S,P,O,D,q){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const W=s.layers[0].layout,Z=s.layers[0].paint,te=!!s.layers[0].dynamicFilter(),re=new vs(null,0,!1,!1,!0),ae=W.get("text-allow-overlap"),ye=W.get("icon-allow-overlap"),fe=W.get("text-variable-anchor"),xe=W.get("text-rotation-alignment")==="map",_e=W.get("text-pitch-alignment")==="map",Ee=Z.get("symbol-z-offset"),Fe=W.get("symbol-elevation-reference")==="sea",De=!Ee.isConstant(),Ze=new vs(null,0,ae&&(ye||!s.hasIconData()||W.get("icon-optional")),ye&&(ae||!s.hasTextData()||W.get("text-optional")),!0);!s.collisionArrays&&S&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(S);const Ue=(Ve,Ke,it)=>{for(let _t=0;_t<Ke/4;_t++)Ve.opacityVertexArray.emplaceBack(it)};let qe=0;O&&s.updateReplacement(D,O);for(let Ve=0;Ve<s.symbolInstances.length;Ve++){const Ke=s.symbolInstances.get(Ve),{numHorizontalGlyphVertices:it,numVerticalGlyphVertices:_t,crossTileID:pt,numIconVertices:Ct,tileAnchorX:Mt,tileAnchorY:ut}=Ke;let Tt=null;const Bt=this.retainedQueryData[s.bucketInstanceId];De&&Ke&&Bt&&(Tt=y.latestFeatureIndex.loadFeature({featureIndex:Ke.featureIndex,bucketIndex:Bt.bucketIndex,sourceLayerIndex:Bt.sourceLayerIndex,layoutVertexArrayOffset:0}));const ft=Ee.evaluate(Tt,{}),Dt=u.has(pt);let Pt=this.opacities[pt];Dt?Pt=re:Pt||(Pt=Ze,this.opacities[pt]=Pt),u.add(pt);const Zt=it>0||_t>0,zt=Ct>0,Nt=this.placedOrientations[pt],qt=Nt===i.bq.vertical,er=Nt===i.bq.horizontal||Nt===i.bq.horizontalOnly;!Zt&&!zt||Pt.isHidden()||qe++;let fr=!1;if((Zt||zt)&&O)for(const mr of s.activeReplacements){if(i.bx(mr,P,i.by.Symbol,q)||mr.min.x>Mt||Mt>mr.max.x||mr.min.y>ut||ut>mr.max.y)continue;const $r=i.bz(Mt,ut,D.canonical,mr.footprintTileId.canonical);if(fr=i.bA($r,mr.footprint),fr)break}if(Zt){const mr=fr?Kl:cy(Pt.text);Ue(s.text,it,qt?Kl:mr),Ue(s.text,_t,er?Kl:mr);const $r=Pt.text.isHidden(),{leftJustifiedTextSymbolIndex:Or,centerJustifiedTextSymbolIndex:jr,rightJustifiedTextSymbolIndex:Wr,verticalPlacedTextSymbolIndex:Mn}=Ke,hi=s.text.placedSymbolArray,Gi=$r||qt?1:0;Or>=0&&(hi.get(Or).hidden=Gi),jr>=0&&(hi.get(jr).hidden=Gi),Wr>=0&&(hi.get(Wr).hidden=Gi),Mn>=0&&(hi.get(Mn).hidden=$r||er?1:0);const Yn=this.variableOffsets[pt];Yn&&this.markUsedJustification(s,Yn.anchor,Ke,Nt);const Zr=this.placedOrientations[pt];Zr&&(this.markUsedJustification(s,"left",Ke,Zr),this.markUsedOrientation(s,Zr,Ke))}if(zt){const mr=fr?Kl:cy(Pt.icon),{placedIconSymbolIndex:$r,verticalPlacedIconSymbolIndex:Or}=Ke,jr=s.icon.placedSymbolArray,Wr=Pt.icon.isHidden()?1:0;$r>=0&&(Ue(s.icon,Ct,qt?Kl:mr),jr.get($r).hidden=Wr),Or>=0&&(Ue(s.icon,Ke.numVerticalIconVertices,er?Kl:mr),jr.get(Or).hidden=Wr)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const mr=s.collisionArrays[Ve];if(mr){let $r=new i.P(0,0),Or=!0;if(mr.textBox||mr.verticalTextBox){if(fe){const Wr=this.variableOffsets[pt];Wr?($r=_s(Wr.anchor,Wr.width,Wr.height,Wr.textOffset,Wr.textScale),xe&&$r._rotate(_e?this.transform.angle:-this.transform.angle)):Or=!1}te&&(Or=!Pt.clipped),mr.textBox&&sp(s.textCollisionBox.collisionVertexArray,Pt.text.placed,!Or||qt,ft,Fe,$r.x,$r.y),mr.verticalTextBox&&sp(s.textCollisionBox.collisionVertexArray,Pt.text.placed,!Or||er,ft,Fe,$r.x,$r.y)}const jr=Or&&!!(!er&&mr.verticalIconBox);mr.iconBox&&sp(s.iconCollisionBox.collisionVertexArray,Pt.icon.placed,jr,ft,Fe,Ke.hasIconTextFit?$r.x:0,Ke.hasIconTextFit?$r.y:0),mr.verticalIconBox&&sp(s.iconCollisionBox.collisionVertexArray,Pt.icon.placed,!jr,ft,Fe,Ke.hasIconTextFit?$r.x:0,Ke.hasIconTextFit?$r.y:0)}}}if(s.fullyClipped=qe===0,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const Ve=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=Ve.invProjMatrix,s.placementViewportMatrix=Ve.viewportMatrix,s.collisionCircleArray=Ve.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return this.fadeDuration===0?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,u){const y=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*y>s}setStale(){this.stale=!0}}function sp(g,s,u,y,S,P,O){g.emplaceBack(s?1:0,u?1:0,P||0,O||0,y,S?1:0),g.emplaceBack(s?1:0,u?1:0,P||0,O||0,y,S?1:0),g.emplaceBack(s?1:0,u?1:0,P||0,O||0,y,S?1:0),g.emplaceBack(s?1:0,u?1:0,P||0,O||0,y,S?1:0)}const lp=Math.pow(2,25),F0=Math.pow(2,24),B0=Math.pow(2,17),Xh=Math.pow(2,16),cp=Math.pow(2,9),V0=Math.pow(2,8),Jh=Math.pow(2,1);function cy(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const s=g.placed?1:0,u=Math.floor(127*g.opacity);return u*lp+s*F0+u*B0+s*Xh+u*cp+s*V0+u*Jh+s}const Kl=0;class zu{constructor(s){this._sortAcrossTiles=s.layout.get("symbol-z-order")!=="viewport-y"&&s.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,u,y,S,P,O){const D=this._bucketParts;for(;this._currentTileIndex<s.length;)if(u.getBucketParts(D,S,s[this._currentTileIndex],this._sortAcrossTiles,O),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((q,W)=>q.sortKey-W.sortKey));this._currentPartIndex<D.length;){const q=D[this._currentPartIndex];if(u.placeLayerBucketPart(q,this._seenCrossTileIDs,y,q.symbolInstanceStart===0,O),this._currentPartIndex++,P())return!0}return!1}}class U0{constructor(s,u,y,S,P,O,D,q,W){this.placement=new Tm(s,P,O,D,q,W),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(s,u,y,S,P){const O=i.q.now(),D=()=>{const q=i.q.now()-O;return!this._forceFullPlacement&&q>2};for(;this._currentPlacementIndex>=0;){const q=u[s[this._currentPlacementIndex]],W=this.placement.collisionIndex.transform.zoom;if(q.type==="symbol"&&(!q.minzoom||q.minzoom<=W)&&(!q.maxzoom||q.maxzoom>W)){const Z=q,te=Z.layout.get("symbol-z-elevate"),re=Z.layout.get("symbol-sort-key").constantOr(1)!==void 0,ae=Z.layout.get("symbol-z-order"),ye=ae==="viewport-y"||ae==="auto"&&!(ae!=="viewport-y"&&re),fe=Z.layout.get("text-allow-overlap")||Z.layout.get("icon-allow-overlap")||Z.layout.get("text-ignore-placement")||Z.layout.get("icon-ignore-placement"),xe=ye&&fe,_e=this._inProgressLayer=this._inProgressLayer||new zu(Z),Ee=i.aC(q.source,q.scope);if(_e.continuePlacement(te||xe?S[Ee]:y[Ee],this.placement,this._showCollisionBoxes,q,D,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const uy=512/i.ag/2;class e_{constructor(s,u,y){this.tileID=s,this.bucketInstanceId=y,this.index=new i.bE(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=s.canonical.x*i.ag,P=s.canonical.y*i.ag;for(let O=0;O<u.length;O++){const{key:D,crossTileID:q,tileAnchorX:W,tileAnchorY:Z}=u.get(O),te=Math.floor((S+W)*uy),re=Math.floor((P+Z)*uy);this.index.add(te,re),this.keys.push(D),this.crossTileIDs.push(q)}this.index.finish()}findMatches(s,u,y){const S=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),P=uy/Math.pow(2,u.canonical.z-this.tileID.canonical.z),O=u.canonical.x*i.ag,D=u.canonical.y*i.ag;for(let q=0;q<s.length;q++){const W=s.get(q);if(W.crossTileID)continue;const{key:Z,tileAnchorX:te,tileAnchorY:re}=W,ae=Math.floor((O+te)*P),ye=Math.floor((D+re)*P),fe=this.index.range(ae-S,ye-S,ae+S,ye+S);for(const xe of fe){const _e=this.crossTileIDs[xe];if(this.keys[xe]===Z&&!y.has(_e)){y.add(_e),W.crossTileID=_e;break}}}}}class t_{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $0{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const u=Math.round((s-this.lng)/360);if(u!==0)for(const y in this.indexes){const S=this.indexes[y],P={};for(const O in S){const D=S[O];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+u),P[D.tileID.key]=D}this.indexes[y]=P}this.lng=s}addBucket(s,u,y){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let P=0;P<u.symbolInstances.length;P++)u.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const S=this.usedCrossTileIDs[s.overscaledZ];for(const P in this.indexes){const O=this.indexes[P];if(Number(P)>s.overscaledZ)for(const D in O){const q=O[D];q.tileID.isChildOf(s)&&q.findMatches(u.symbolInstances,s,S)}else{const D=O[s.scaledTo(Number(P)).key];D&&D.findMatches(u.symbolInstances,s,S)}}for(let P=0;P<u.symbolInstances.length;P++){const O=u.symbolInstances.get(P);O.crossTileID||(O.crossTileID=y.generate(),S.add(O.crossTileID))}return this.indexes[s.overscaledZ]===void 0&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new e_(s,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(s,u){for(const y of u.crossTileIDs)this.usedCrossTileIDs[s].delete(y)}removeStaleBuckets(s){let u=!1;for(const y in this.indexes){const S=this.indexes[y];for(const P in S)s[S[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,S[P]),delete S[P],u=!0)}return u}}class dy{constructor(){this.layerIndexes={},this.crossTileIDs=new t_,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,u,y,S){let P=this.layerIndexes[s.fqid];P===void 0&&(P=this.layerIndexes[s.fqid]=new $0);let O=!1;const D={};S.name!=="globe"&&P.handleWrapJump(y);for(const q of u){const W=q.getBucket(s);W&&s.fqid===W.layerIds[0]&&(W.bucketInstanceId||(W.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(q.tileID,W,this.crossTileIDs)&&(O=!0),D[W.bucketInstanceId]=!0)}return P.removeStaleBuckets(D)&&(O=!0),O}pruneUnusedLayers(s){const u={};s.forEach(y=>{u[y]=!0});for(const y in this.layerIndexes)u[y]||delete this.layerIndexes[y]}}const Nd=771;class xn{constructor(s,u,y,S){this.blendFunction=s,this.blendColor=u,this.mask=y,this.blendEquation=S}}xn.Replace=[1,0,1,0],xn.disabled=new xn(xn.Replace,i.aj.transparent,[!1,!1,!1,!1]),xn.unblended=new xn(xn.Replace,i.aj.transparent,[!0,!0,!0,!0]),xn.alphaBlended=new xn([1,Nd,1,Nd],i.aj.transparent,[!0,!0,!0,!0]),xn.alphaBlendedNonPremultiplied=new xn([770,Nd,770,Nd],i.aj.transparent,[!0,!0,!0,!0]),xn.multiply=new xn([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class Lr{constructor(s,u,y){this.func=s,this.mask=u,this.range=y}}Lr.ReadOnly=!1,Lr.ReadWrite=!0,Lr.disabled=new Lr(519,Lr.ReadOnly,[0,1]);const Pm=7680;class Gr{constructor(s,u,y,S,P,O){this.test=s,this.ref=u,this.mask=y,this.fail=S,this.depthFail=P,this.pass=O}}Gr.disabled=new Gr({func:519,mask:0},0,0,Pm,Pm,Pm);const yc=1029,Em=2305;class Hr{constructor(s,u,y){this.enable=s,this.mode=u,this.frontFace=y}}function Id(g,s){const u=i.bG(g,3);i.ab.mat4.fromQuat(g,s),i.bI(g,3,u)}function Fu(g,s){const u=i.ab.quat.identity([]);return i.ab.quat.rotateZ(u,u,-s),i.ab.quat.rotateX(u,u,-g),u}function Cm(g,s){const u=[g[0],g[1],0],y=[s[0],s[1],0];if(i.ab.vec3.length(u)>=1e-15){const O=i.ab.vec3.normalize([],u);i.ab.vec3.scale(y,O,i.ab.vec3.dot(y,O)),s[0]=y[0],s[1]=y[1]}const S=i.ab.vec3.cross([],s,g);if(i.ab.vec3.len(S)<1e-15)return null;const P=Math.atan2(-S[1],S[0]);return Fu(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),P)}Hr.disabled=new Hr(!1,yc,Em),Hr.backCCW=new Hr(!0,yc,Em),Hr.backCW=new Hr(!0,yc,2304),Hr.frontCW=new Hr(!0,1028,2304),Hr.frontCCW=new Hr(!0,1028,Em);class up{constructor(s,u){this.position=s,this.orientation=u}get position(){return this._position}set position(s){if(s){const u=s instanceof i.aa?s:new i.aa(s[0],s[1],s[2]);this._renderWorldCopies&&(u.x=i.bF(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(s,u){if(this.orientation=null,!this.position)return;const y=this.position,S=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(s)):0,P=i.aa.fromLngLat(s,S),O=[P.x-y.x,P.y-y.y,P.z-y.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=Cm(O,u)}setPitchBearing(s,u){this.orientation=Fu(i.ai(s),i.ai(-u))}}class po{constructor(s,u){this._transform=i.ab.mat4.identity([]),this.orientation=u,this.position=s}get mercatorPosition(){const s=this.position;return new i.aa(s[0],s[1],s[2])}get position(){const s=i.bG(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var u;s&&i.bI(this._transform,3,[(u=s)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||i.ab.quat.identity([]),s&&Id(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,u){this._orientation=Fu(s,u),Id(this._transform,this._orientation)}forward(){const s=i.bG(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=i.bG(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=i.bG(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,u){const y=new Float64Array(16);return i.ab.mat4.invert(y,this.getWorldToCamera(s,u)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,u,y){const S=this.position;i.ab.vec3.scale(S,S,-s);const P=new Float64Array(16);return i.ab.mat4.fromScaling(P,[y,y,y]),i.ab.mat4.translate(P,P,S),P[10]*=u,P}getWorldToCamera(s,u){const y=new Float64Array(16),S=new Float64Array(4),P=this.position;return i.ab.quat.conjugate(S,this._orientation),i.ab.vec3.scale(P,P,-s),i.ab.mat4.fromQuat(y,S),i.ab.mat4.translate(y,y,P),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=u,y[9]*=u,y[10]*=u,y[11]*=u,y}getCameraToClipPerspective(s,u,y,S){const P=new Float64Array(16);return i.ab.mat4.perspective(P,s,u,y,S),P}getCameraToClipOrthographic(s,u,y,S,P,O){const D=new Float64Array(16);return i.ab.mat4.ortho(D,s,u,y,S,P,O),D}getDistanceToElevation(s,u=!1){const y=s===0?0:i.bH(s,u?i.aS(this.position[1]):this.position[1]),S=this.forward();return(y-this.position[2])/S[2]}clone(){return new po([...this.position],[...this.orientation])}}const Io={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class ar{constructor(s=0,u=0,y=0,S=0){if(isNaN(s)||s<0||isNaN(u)||u<0||isNaN(y)||y<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=u,this.left=y,this.right=S}interpolate(s,u,y){return u.top!=null&&s.top!=null&&(this.top=i.af(s.top,u.top,y)),u.bottom!=null&&s.bottom!=null&&(this.bottom=i.af(s.bottom,u.bottom,y)),u.left!=null&&s.left!=null&&(this.left=i.af(s.left,u.left,y)),u.right!=null&&s.right!=null&&(this.right=i.af(s.right,u.right,y)),this}getCenter(s,u){const y=i.aw((this.left+s-this.right)/2,0,s),S=i.aw((this.top+u-this.bottom)/2,0,u);return new i.P(y,S)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const hy=(g,s,u)=>(1-u)*g+u*s,dp=g=>g*g*g*g*g;class Qh{constructor(s,u,y,S,P,O,D){this.tileSize=512,this._renderWorldCopies=P===void 0||P,this._minZoom=s||0,this._maxZoom=u||22,this._minPitch=y??0,this._maxPitch=S??60,this.setProjection(O),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ar,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new po,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const s=new Qh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(s,u=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(s||y)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const y=this.getProjection(),S=!i.bn(u,y);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const u=s!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(s){s===void 0?s=!0:s===null&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const u=-s*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const u=i.aw(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=i.ai(s),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const u=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let S=0,P=0;for(let O=0;O<u.length;O++){const D=new i.P(u[O][0]*this.width,y+u[O][1]*(this.height-y)),q=s.pointCoordinate(D);if(!q)continue;const W=1/Math.hypot(q[0]-this._camera.position[0],q[1]-this._camera.position[1]);S+=q[3]*W,P+=W}return P===0?NaN:S/P}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const s=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*u,S=this._mercatorZfromZoom(s),P=this._mercatorZfromZoom(this._maxZoom),O=Math.max(S-y,P);this._setZoom(this._zoomFromMercatorZ(O))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let y;y=s.z<this._camera.position[2]?[u.x,u.y,u.z]:[s.x,s.y,s.z];const S=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,y));return i.aw(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let u=!1;if(s.orientation&&!i.ab.quat.exactEquals(s.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(s.orientation)),s.position){const y=[s.position.x,s.position.y,s.position.z];i.ab.vec3.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,u=new up;return u.position=new i.aa(s[0],s[1],s[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(s){if(!i.ab.quat.length(s))return!1;i.ab.quat.normalize(s,s);const u=i.ab.vec3.transformQuat([],[0,0,-1],s),y=i.ab.vec3.transformQuat([],[0,-1,0],s);if(y[2]<0)return!1;const S=Cm(u,y);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(s){const u=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;s[2]=i.aw(s[2],S/y,S/u),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,u,y){this._unmodified=!1,this._edgeInsets.interpolate(s,u,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const u=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(s){const u=[new i.bQ(0,s)];if(this.renderWorldCopies){const y=this.pointCoordinate(new i.P(0,0)),S=this.pointCoordinate(new i.P(this.width,0)),P=this.pointCoordinate(new i.P(this.width,this.height)),O=this.pointCoordinate(new i.P(0,this.height)),D=Math.floor(Math.min(y.x,S.x,P.x,O.x)),q=Math.floor(Math.max(y.x,S.x,P.x,O.x)),W=1;for(let Z=D-W;Z<=q+W;Z++)Z!==0&&u.push(new i.bQ(Z,s))}return u}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,u,y){let S=[];const P=y!==void 0,O=!P;if(O&&this.zoom<u||P&&y[0]===0&&y[1]===0)return S;const D=new Set,q=(Z,te,re,ae,ye)=>{const fe=i.c5(te,Z,re,ae,ye);D.has(fe)||(S.push(new i.aG(Z,te,re,ae,ye)),D.add(fe))};for(let Z=0;Z<s.length;Z++){const te=s[Z];if(O&&te.canonical.z!==u)continue;const re=te.canonical,ae=te.overscaledZ,ye=te.wrap,fe=1<<re.z,xe=re.x+1<fe,_e=re.x>0,Ee=re.y+1<fe,Fe=re.y>0,De=te.wrap-(_e?0:1),Ze=te.wrap+(xe?0:1),Ue=_e?re.x-1:fe-1,qe=xe?re.x+1:0;if(P)y[0]<0?(q(ae,Ze,re.z,qe,re.y),y[1]<0&&Ee&&(q(ae,ye,re.z,re.x,re.y+1),q(ae,Ze,re.z,qe,re.y+1)),y[1]>0&&Fe&&(q(ae,ye,re.z,re.x,re.y-1),q(ae,Ze,re.z,qe,re.y-1))):y[0]>0?(q(ae,De,re.z,Ue,re.y),y[1]<0&&Ee&&(q(ae,ye,re.z,re.x,re.y+1),q(ae,De,re.z,Ue,re.y+1)),y[1]>0&&Fe&&(q(ae,ye,re.z,re.x,re.y-1),q(ae,De,re.z,Ue,re.y-1))):y[1]<0&&Ee?q(ae,ye,re.z,re.x,re.y+1):Fe&&q(ae,ye,re.z,re.x,re.y-1);else{const Ve=te.visibleQuadrants;1&Ve&&(q(ae,De,re.z,Ue,re.y),Fe&&(q(ae,ye,re.z,re.x,re.y-1),q(ae,De,re.z,Ue,re.y-1))),2&Ve&&(q(ae,Ze,re.z,qe,re.y),Fe&&(q(ae,ye,re.z,re.x,re.y-1),q(ae,Ze,re.z,qe,re.y-1))),4&Ve&&(q(ae,De,re.z,Ue,re.y),Ee&&(q(ae,ye,re.z,re.x,re.y+1),q(ae,De,re.z,Ue,re.y+1))),8&Ve&&(q(ae,Ze,re.z,qe,re.y),Ee&&(q(ae,ye,re.z,re.x,re.y+1),q(ae,Ze,re.z,qe,re.y+1)))}}const W=[];for(const Z of S)S.some(te=>Z.isChildOf(te))||W.push(Z);if(S=W.filter(Z=>!s.some(te=>!!(Z.overscaledZ<u&&te.isChildOf(Z))||Z.equals(te)||Z.isChildOf(te))),O){const Z=1<<u,te=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),re=[Z*te.x,Z*te.y],ae=4,ye=ae*ae;S=S.filter(fe=>{const xe=fe.canonical.x+.5-re[0],_e=fe.canonical.y+.5-re[1];return xe*xe+_e*_e<ye})}return S}coveringTiles(s){let u=this.coveringZoomLevel(s);const y=u,S=this.elevation&&this.elevation.exaggeration(),P=S&&!s.isTerrainDEM,O=this.projection.name==="mercator";if(s.minzoom!==void 0&&u<s.minzoom)return[];s.maxzoom!==void 0&&u>s.maxzoom&&(u=s.maxzoom);const D=this.locationCoordinate(this.center),q=this.center.lat,W=1<<u,Z=[W*D.x,W*D.y,0],te=this.projection.name==="globe",re=!te,ae=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,re),ye=te?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=W*i.bH(1,this.center.lat),xe=this._camera.position[2]/i.bH(1,this.center.lat),_e=[W*ye.x,W*ye.y,xe*(re?1:fe)],Ee=te||S,Fe=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),De=this.isLODDisabled(!0)?u:0;let Ze;if(this._elevation&&s.isTerrainDEM)Ze=1e4*this._elevation.exaggeration();else if(this._elevation){const ft=this._elevation.getMinMaxForVisibleTiles();Ze=ft?ft.max:this._centerAltitude}else Ze=this._centerAltitude;const Ue=s.isTerrainDEM?-Ze:this._elevation?this._elevation.getMinElevationBelowMSL():0,qe=this.projection.isReprojectedInTileSpace?i.bS(this):1,Ve=ft=>{const Pt=new i.aa(ft.x+25e-6,ft.y,ft.z),Zt=new i.aa(ft.x,ft.y+25e-6,ft.z),zt=ft.toLngLat(),Nt=Pt.toLngLat(),qt=Zt.toLngLat(),er=this.locationCoordinate(zt),fr=this.locationCoordinate(Nt),mr=this.locationCoordinate(qt),$r=Math.hypot(fr.x-er.x,fr.y-er.y),Or=Math.hypot(mr.x-er.x,mr.y-er.y);return Math.sqrt($r*Or)*qe/25e-6},Ke=ft=>{const Dt=Ze,Pt=Ue;return{aabb:i.bV(this,W,0,0,0,ft,Pt,Dt,this.projection),zoom:0,x:0,y:0,minZ:Pt,maxZ:Dt,wrap:ft,fullyVisible:!1}},it=[];let _t=[];const pt=u,Ct=s.reparseOverscaled?y:u,Mt=(xe-this._centerAltitude)*fe,ut=ft=>{if(!this._elevation||!ft.tileID||!O)return;const Dt=this._elevation.getMinMaxForTile(ft.tileID),Pt=ft.aabb;Dt?(Pt.min[2]=Dt.min,Pt.max[2]=Dt.max,Pt.center[2]=(Pt.min[2]+Pt.max[2])/2):(ft.shouldSplit=Bt(ft),ft.shouldSplit||(Pt.min[2]=Pt.max[2]=Pt.center[2]=this._centerAltitude))},Tt=(ft,Dt)=>{if(.707*Dt<ft)return 1;const Pt=Dt/ft;return Pt/(1.4144271570014144+(Math.pow(1.1,Pt-1.4144271570014144+1)-1)/(1.1-1)-1)},Bt=ft=>{if(ft.zoom<De)return!0;if(ft.zoom===pt)return!1;if(ft.shouldSplit!=null)return ft.shouldSplit;const Dt=ft.aabb.distanceX(_e),Pt=ft.aabb.distanceY(_e);let Zt=Mt,zt=1;if(te){Zt=ft.aabb.distanceZ(_e);const Or=Math.pow(2,ft.zoom),jr=i.aS((ft.y+1)/Or),Wr=i.aS(ft.y/Or),Mn=Math.min(Math.max(q,jr),Wr),hi=i.c9(Mn)/i.c9(q);if(zt=Mn===q?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,hi/this._mercatorScaleRatio),this.zoom<=i.c6&&ft.zoom===pt-1&&hi>=.9)return!0}else if(P&&(Zt=ft.aabb.distanceZ(_e)*fe),this.projection.isReprojectedInTileSpace&&y<=5){const Or=Math.pow(2,ft.zoom),jr=Ve(new i.aa((ft.x+.5)/Or,(ft.y+.5)/Or));zt=jr>.85?1:jr}if(!O){const Or=Math.sqrt(Dt*Dt+Pt*Pt+Zt*Zt);let jr=(1<<pt-ft.zoom)*Fe*zt;return jr*=Tt(Math.max(Zt,Mt),Or),Or<jr}let Nt=Number.MAX_VALUE,qt=0;const er=ft.aabb.getCorners(),fr=[];for(const Or of er){i.ab.vec3.sub(fr,Or,_e),te||(P?fr[2]*=fe:fr[2]=Mt);const jr=i.ab.vec3.dot(fr,this._camera.forward());jr<Nt&&(Nt=jr,qt=Math.abs(fr[2]))}let mr=(1<<pt-ft.zoom)*Fe*zt;if(mr*=Tt(Math.max(qt,Mt),Nt),Nt<mr)return!0;const $r=ft.aabb.closestPoint(Z);return $r[0]===Z[0]&&$r[1]===Z[1]};if(this.renderWorldCopies)for(let ft=1;ft<=3;ft++)it.push(Ke(-ft)),it.push(Ke(ft));for(it.push(Ke(0));it.length>0;){const ft=it.pop(),Dt=ft.x,Pt=ft.y;let Zt=ft.fullyVisible;const zt=()=>this.projection.name==="globe"&&(ft.y===0||ft.y===(1<<ft.zoom)-1);if(!Zt){let Nt=Ee?ft.aabb.intersects(ae):ft.aabb.intersectsFlat(ae);if(Nt===0&&zt()){const qt=new i.bT(ft.zoom,Dt,Pt);Nt=i.bU(this,W,qt,!0).intersects(ae)}if(Nt===0)continue;Zt=Nt===2}if(ft.zoom!==pt&&Bt(ft))for(let Nt=0;Nt<4;Nt++){const qt=(Dt<<1)+Nt%2,er=(Pt<<1)+(Nt>>1),fr={aabb:O?ft.aabb.quadrant(Nt):i.bV(this,W,ft.zoom+1,qt,er,ft.wrap,ft.minZ,ft.maxZ,this.projection),zoom:ft.zoom+1,x:qt,y:er,wrap:ft.wrap,fullyVisible:Zt,tileID:void 0,shouldSplit:void 0,minZ:ft.minZ,maxZ:ft.maxZ};P&&!te&&(fr.tileID=new i.aG(ft.zoom+1===pt?Ct:ft.zoom+1,ft.wrap,ft.zoom+1,qt,er),ut(fr)),it.push(fr)}else{const Nt=ft.zoom===pt?Ct:ft.zoom;if(s.minzoom&&s.minzoom>Nt)continue;let qt=0;if(!Zt){let $r=Ee?ft.aabb.intersectsPrecise(ae):ft.aabb.intersectsPreciseFlat(ae);if($r===0&&zt()){const Or=new i.bT(ft.zoom,Dt,Pt);$r=i.bU(this,W,Or,!0).intersectsPrecise(ae)}if($r===0)continue;if(s.calculateQuadrantVisibility)if(ae.containsPoint(ft.aabb.center))qt=15;else for(let Or=0;Or<4;Or++)ft.aabb.quadrant(Or).intersects(ae)!==0&&(qt|=1<<Or)}const er=Z[0]-(.5+Dt+(ft.wrap<<ft.zoom))*(1<<u-ft.zoom),fr=Z[1]-.5-Pt,mr=ft.tileID?ft.tileID:new i.aG(Nt,ft.wrap,ft.zoom,Dt,Pt);s.calculateQuadrantVisibility&&(mr.visibleQuadrants=qt),_t.push({tileID:mr,distanceSq:er*er+fr*fr})}}if(this.fogCullDistSq){const ft=this.fogCullDistSq,Dt=this.horizonLineFromTop();_t=_t.filter(Pt=>{const Zt=[0,0,0,1],zt=[i.ag,i.ag,0,1],Nt=this.calculateFogTileMatrix(Pt.tileID.toUnwrapped());i.ab.vec4.transformMat4(Zt,Zt,Nt),i.ab.vec4.transformMat4(zt,zt,Nt);const qt=i.ab.vec4.min([],Zt,zt),er=i.ab.vec4.max([],Zt,zt),fr=i.bW(qt,er);if(fr===0)return!0;let mr=!1;const $r=this._elevation;if($r&&fr>ft&&Dt!==0){const Or=this.calculateProjMatrix(Pt.tileID.toUnwrapped());let jr;s.isTerrainDEM||(jr=$r.getMinMaxForTile(Pt.tileID)),jr||(jr={min:Ue,max:Ze});const Wr=i.c7(this.rotation),Mn=[Wr[0]*i.ag,Wr[1]*i.ag,jr.max];i.ab.vec3.transformMat4(Mn,Mn,Or),mr=(1-Mn[1])*this.height*.5<Dt}return fr<ft||mr})}return _t.sort((ft,Dt)=>ft.distanceSq-Dt.distanceSq).map(ft=>ft.tileID)}resize(s,u){this.width=s,this.height=u,this.pixelsToGLUnits=[2/s,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const u=i.aw(s.lat,-i.bX,i.bX),y=this.projection.project(s.lng,u);return new i.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,u){let y,S;const P=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;y=(u.x-P.x)/D,S=(u.y-P.y)/D}else{const D=this.pointCoordinate(u),q=this.pointCoordinate(P);y=D.x-q.x,S=D.y-q.y}const O=this.locationCoordinate(s);this.setLocation(new i.aa(O.x-y,O.y-S))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s){return this.projection.locationPoint(this,s)}locationPoint3D(s){return this.projection.locationPoint(this,s,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s){return this.coordinateLocation(this.pointCoordinate3D(s))}locationCoordinate(s,u){const y=u?i.bH(u,s.lat):void 0,S=this.projection.project(s.lng,s.lat);return new i.aa(S.x,S.y,y)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,u){const y=u??this._centerAltitude,S=[s.x,s.y,0,1],P=[s.x,s.y,1,1];i.ab.vec4.transformMat4(S,S,this.pixelMatrixInverse),i.ab.vec4.transformMat4(P,P,this.pixelMatrixInverse);const O=P[3];i.ab.vec4.scale(S,S,1/S[3]),i.ab.vec4.scale(P,P,1/O);const D=S[2],q=P[2];return{p0:S,p1:P,t:D===q?0:(y-D)/(q-D)}}screenPointToMercatorRay(s){const u=[s.x,s.y,0,1],y=[s.x,s.y,1,1];return i.ab.vec4.transformMat4(u,u,this.pixelMatrixInverse),i.ab.vec4.transformMat4(y,y,this.pixelMatrixInverse),i.ab.vec4.scale(u,u,1/u[3]),i.ab.vec4.scale(y,y,1/y[3]),u[2]=i.bH(u[2],this._center.lat)*this.worldSize,y[2]=i.bH(y[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(u,u,1/this.worldSize),i.ab.vec4.scale(y,y,1/this.worldSize),new i.aq([u[0],u[1],u[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],y,u)))}rayIntersectionCoordinate(s){const{p0:u,p1:y,t:S}=s,P=i.bH(u[2],this._center.lat),O=i.bH(y[2],this._center.lat);return new i.aa(i.af(u[0],y[0],S)/this.worldSize,i.af(u[1],y[1],S)/this.worldSize,i.af(P,O,S))}pointCoordinate(s,u=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,u)}pointCoordinate3D(s){if(!this.elevation)return this.pointCoordinate(s);let u=this.projection.pointCoordinate3D(this,s.x,s.y);if(u)return new i.aa(u[0],u[1],u[2]);let y=0,S=this.horizonLineFromTop();if(s.y>S)return this.pointCoordinate(s);const P=.02*S,O=s.clone();for(let D=0;D<10&&S-y>P;D++){O.y=i.af(y,S,.66);const q=this.projection.pointCoordinate3D(this,O.x,O.y);q?(S=O.y,u=q):y=O.y}return u?new i.aa(u[0],u[1],u[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(s);const u=this.pointCoordinate(s);return u.y>=0&&u.y<=1}_coordinatePoint(s,u){const y=u&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,S=[s.x*this.worldSize,s.y*this.worldSize,y+s.toAltitude(),1];return i.ab.vec4.transformMat4(S,S,this.pixelMatrix),S[3]>0?new i.P(S[0]/S[3],S[1]/S[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:u}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,P=this.pointLocation3D(new i.P(u,s)),O=this.pointLocation3D(new i.P(S,s)),D=this.pointLocation3D(new i.P(S,y)),q=this.pointLocation3D(new i.P(u,y));let W=Math.min(P.lng,O.lng,D.lng,q.lng),Z=Math.max(P.lng,O.lng,D.lng,q.lng),te=Math.min(P.lat,O.lat,D.lat,q.lat),re=Math.max(P.lat,O.lat,D.lat,q.lat);const ae=Math.pow(2,-this.zoom)/16*270,ye=this.projection.name==="globe"?1:4,fe=(xe,_e,Ee,Fe,De)=>{const Ze=(xe+Ee)/2,Ue=(_e+Fe)/2,qe=new i.P(Ze,Ue),{lng:Ve,lat:Ke}=this.pointLocation3D(qe),it=Math.max(0,W-Ve,te-Ke,Ve-Z,Ke-re);W=Math.min(W,Ve),Z=Math.max(Z,Ve),te=Math.min(te,Ke),re=Math.max(re,Ke),(De<ye||it>ae)&&(fe(xe,_e,Ze,Ue,De+1),fe(Ze,Ue,Ee,Fe,De+1))};if(fe(u,s,S,s,1),fe(S,s,S,y,1),fe(S,y,u,y,1),fe(u,y,u,s,1),this.projection.name==="globe"){const[xe,_e]=i.bZ(this);xe?(re=90,Z=180,W=-180):_e&&(te=-90,Z=180,W=-180)}return new i.az(new i.bO(W,te),new i.bO(Z,re))}_getBoundsRectangular(s,u){const{top:y,left:S}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,O=this.width-this._edgeInsets.right,D=new i.P(S,y),q=new i.P(O,y),W=new i.P(O,P),Z=new i.P(S,P);let te=this.pointCoordinate(D,s),re=this.pointCoordinate(q,s);const ae=this.pointCoordinate(W,u),ye=this.pointCoordinate(Z,u),fe=(xe,_e)=>(_e.y-xe.y)/(_e.x-xe.x);return te.y>1&&re.y>=0?te=new i.aa((1-ye.y)/fe(ye,te)+ye.x,1):te.y<0&&re.y<=1&&(te=new i.aa(-ye.y/fe(ye,te)+ye.x,0)),re.y>1&&te.y>=0?re=new i.aa((1-ae.y)/fe(ae,re)+ae.x,1):re.y<0&&te.y<=1&&(re=new i.aa(-ae.y/fe(ae,re)+ae.x,0)),new i.az().extend(this.coordinateLocation(te)).extend(this.coordinateLocation(re)).extend(this.coordinateLocation(ye)).extend(this.coordinateLocation(ae))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=s.visibleDemTiles.reduce((y,S)=>{if(S.dem){const P=S.dem.tree;y.min=Math.min(y.min,P.minimums[0]),y.max=Math.max(y.max,P.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*s.exaggeration(),u.max*s.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-u*(1-this._horizonShift);return s?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,u){return this.projection.createTileMatrix(this,u,s)}calculateDistanceTileData(s){const u=s.key,y=this._distanceTileDataCache;if(y[u])return y[u];const S=s.canonical,P=1/this.height,O=this.cameraWorldSize,D=O/this.zoomScale(S.z),q=(S.x+Math.pow(2,S.z)*s.wrap)*D,W=S.y*D,Z=this.point;Z.x*=O/this.worldSize,Z.y*=O/this.worldSize;const te=this.angle,re=Math.sin(-te),ae=-Math.cos(-te);return y[u]={bearing:[re,ae],center:[(Z.x-q)*P,(Z.y-W)*P],scale:D/i.ag*P},y[u]}calculateFogTileMatrix(s){const u=s.key,y=this._fogTileMatrixCache;if(y[u])return y[u];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return i.ab.mat4.multiply(S,this.worldToFogMatrix,S),y[u]=new Float32Array(S),y[u]}calculateProjMatrix(s,u=!1,y=!1){const S=s.key;let P;if(P=y?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,P[S])return P[S];const O=this.calculatePosMatrix(s,this.worldSize);let D;return D=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(O,D,O),P[S]=new Float32Array(O),P[S]}calculatePixelsToTileUnitsMatrix(s){const u=s.tileID.key,y=this._pixelsToTileUnitsCache;if(y[u])return y[u];const S=i.b_(s,this);return y[u]=S,y[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const s=1/this.worldSize,u=i.ab.mat4.fromScaling([],[s,s,s]);return i.ab.mat4.multiply(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const s=this._elevation;this._updateCameraState();const u=i.bH(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(u),S=this._camera.forward(),P=i.bH(1,this._center.lat);y[2]/=P,S[2]/=P,i.ab.vec3.normalize(S,S);const O=s.raycast(y,S,s.exaggeration());if(O){const D=i.ab.vec3.scaleAndAdd([],y,S,O),q=new i.aa(D[0],D[1],i.bH(D[2],i.aS(D[1]))),W=(q.z+i.ab.vec3.length([q.x-y[0],q.y-y[1],q.z-y[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(W),this._centerAltitude=q.toAltitude(),this._center=this.coordinateLocation(q),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const u=this._elevation,y=i.bH(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(y),P=u.getAtPointOrZero(new i.aa(...S)),O=this.pixelsPerMeter/this.worldSize*P,D=this._minimumHeightOverTerrain(),q=S[2]-O;if(q<=D)if(q<0||s){const W=this.locationCoordinate(this._center,this._centerAltitude),Z=[S[0],S[1],W.z-S[2]],te=i.ab.vec3.length(Z);Z[2]-=(D-q)/this._pixelsPerMercatorPixel;const re=i.ab.vec3.length(Z);if(re===0)return;i.ab.vec3.scale(Z,Z,te/re*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],W.z*this._pixelsPerMercatorPixel-Z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const re=this.center;return re.lat=i.aw(re.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(re.lng=i.aw(re.lng,this.minLng,this.maxLng)),this.center=re,void(this._constraining=!1)}const u=this._unmodified,{x:y,y:S}=this.point;let P=0,O=y,D=S;const q=this.width/2,W=this.height/2,Z=this.worldMinY*this.scale,te=this.worldMaxY*this.scale;if(S-W<Z&&(D=Z+W),S+W>te&&(D=te-W),te-Z<this.height&&(P=Math.max(P,this.height/(te-Z)),D=(te+Z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const re=this.worldMinX*this.scale,ae=this.worldMaxX*this.scale,ye=this.worldSize/2-(re+ae)/2;O=(y+ye+this.worldSize)%this.worldSize-ye,O-q<re&&(O=re+q),O+q>ae&&(O=ae-q),ae-re<this.width&&(P=Math.max(P,this.width/(ae-re)),O=(ae+re)/2)}O===y&&D===S||(this.center=this.unproject(new i.P(O,D))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,u=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const S=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const P=this.projection.zAxisUnit==="meters"?y:1,O=this._camera.getWorldToCamera(this.worldSize,P);let D;const q=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(q[8]=2*-s.x/this.width,q[9]=2*s.y/this.height,this.isOrthographic){let Ke=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),it=Ke*this.aspect,_t=-it,pt=-Ke;it-=s.x,_t-=s.x,Ke+=s.y,pt+=s.y,D=this._camera.getCameraToClipOrthographic(_t,it,pt,Ke,this._nearZ,this._farZ),((Ct,Mt,ut,Tt)=>{for(let Bt=0;Bt<16;Bt++)Ct[Bt]=hy(Mt[Bt],ut[Bt],Tt)})(D,D,q,dp(this.pitch>=15?1:this.pitch/15))}else D=q;const W=i.ab.mat4.mul([],q,O);let Z=i.ab.mat4.mul([],D,O);if(this.projection.isReprojectedInTileSpace){const Ke=this.locationCoordinate(this.center),it=i.ab.mat4.identity([]);i.ab.mat4.translate(it,it,[Ke.x*this.worldSize,Ke.y*this.worldSize,0]),i.ab.mat4.multiply(it,it,i.c0(this)),i.ab.mat4.translate(it,it,[-Ke.x*this.worldSize,-Ke.y*this.worldSize,0]),i.ab.mat4.multiply(Z,Z,it),i.ab.mat4.multiply(W,W,it),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],Z,[this.worldSize,this.worldSize,this.worldSize/P,1]),this.projMatrix=Z,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),u){const Ke=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ke[8]=2*-s.x/this.width,Ke[9]=2*s.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Ke,O)}else this.expandedFarZProjMatrix=this.projMatrix;const te=i.ab.mat4.invert([],D);this.frustumCorners=i.c2.fromInvProjectionMatrix(te,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const re=new Float32Array(16);i.ab.mat4.identity(re),i.ab.mat4.scale(re,re,[1,-1,1]),i.ab.mat4.rotateX(re,re,this._pitch),i.ab.mat4.rotateZ(re,re,this.angle);const ae=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(ae);const ye=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ae[8]=2*-s.x/this.width,ae[9]=2*(s.y+ye)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(re,ae,re);const fe=this.point,xe=fe.x,_e=fe.y,Ee=this.width%2/2,Fe=this.height%2/2,De=Math.cos(this.angle),Ze=Math.sin(this.angle),Ue=xe-Math.round(xe)+De*Ee+Ze*Fe,qe=_e-Math.round(_e)+De*Fe+Ze*Ee,Ve=new Float64Array(Z);if(i.ab.mat4.translate(Ve,Ve,[Ue>.5?Ue-1:Ue,qe>.5?qe-1:qe,0]),this.alignedProjMatrix=Ve,Z=i.ab.mat4.create(),i.ab.mat4.scale(Z,Z,[this.width/2,-this.height/2,1]),i.ab.mat4.translate(Z,Z,[1,-1,0]),this.labelPlaneMatrix=Z,Z=i.ab.mat4.create(),i.ab.mat4.scale(Z,Z,[1,-1,1]),i.ab.mat4.translate(Z,Z,[-1,-1,0]),i.ab.mat4.scale(Z,Z,[2/this.width,2/this.height,1]),this.glCoordMatrix=Z,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,W),this._calcFogMatrices(),this._distanceTileDataCache={},Z=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!Z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Z,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Ke=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Ke,Ke,O),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,y=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,P=[s,s,u];i.ab.vec3.scale(P,P,S),i.ab.vec3.scale(y,y,-1),i.ab.vec3.multiply(y,y,P);const O=i.ab.mat4.create();i.ab.mat4.translate(O,O,y),i.ab.mat4.scale(O,O,P),this.mercatorFogMatrix=O,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,u,S)}_computeCameraPosition(s){const u=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),S=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-s/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-y[0]*P,S.y/this.worldSize-y[1]*P,s/this.worldSize*this._centerAltitude-y[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],S=s[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(P=Math.min((u-y)/S,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,s,P),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,u=this._camera.forward(),{pitch:y,bearing:S}=this._camera.getPitchBearing(),P=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,O=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),D=Math.max((s[2]-P)/Math.cos(y),O),q=this._zoomFromMercatorZ(D);i.ab.vec3.scaleAndAdd(s,s,u,D),this._pitch=i.aw(y,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(S,-Math.PI,Math.PI),this._setZoom(i.aw(q,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let u=0,y=i.bY,S=0,P=1/0;for(;y-u>1e-6&&y>u;){const O=u+.5*(y-u),D=this.tileSize*Math.pow(2,O),q=this.getCameraToCenterDistance(this.projection,O,D),W=this.scaleZoom(q/(s*this.tileSize)),Z=Math.abs(O-W);Z<P&&(P=Z,S=O),O<W?u=O:y=O}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,u){const y=Math.min(s.x,u.x),S=Math.max(s.x,u.x),P=Math.min(s.y,u.y),O=Math.max(s.y,u.y);if(P<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new i.P(y,P),new i.P(S,O),new i.P(y,O),new i.P(S,P)],q=this.renderWorldCopies?-3:0,W=this.renderWorldCopies?4:1;for(const Z of D){const te=this.pointRayIntersection(Z);if(te.t<0)return!0;const re=this.rayIntersectionCoordinate(te);if(re.x<q||re.y<0||re.x>W||re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(s,u){const y=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,s)),S=this._zoomFromMercatorZ(y)+u;return y-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const s=function([u,y,S],P){const O=[u,y,S,1];i.ab.vec4.transformMat4(O,O,P);const D=O[3]=Math.max(O[3],1e-6);return O[0]/=D,O[1]/=D,O[2]/=D,O}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,s))}}getCameraToCenterDistance(s,u=this.zoom,y=this.worldSize){const S=i.b$(s,u,this.width,this.height,1024),P=s.pixelSpaceConversion(this.center.lat,y,S);let O=.5/Math.tan(.5*this._fov)*this.height*P;return this.isOrthographic&&(O=hy(1,O,dp(this.pitch>=15?1:this.pitch/15))),O}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(s,s,this.globeMatrix),s}getFrustum(s){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,this.projection.zAxisUnit==="meters")}}const Al=(g,s)=>{if(s>0&&g.terrain&&i.w("Cutoff is currently disabled on terrain"),s<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=g.transform,y=Math.max(Math.abs(u._zoom-(g.minCutoffZoom-1)),1),S=u.isLODDisabled(!1)?i.ac(60,45,u.pitch):i.ac(30,15,u.pitch),P=u._farZ-u._nearZ,O=s*u.height,D=((1-(q=S))*u.cameraToCenterDistance+q*(u._farZ+O))*y;var q;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(D-u._nearZ)/P,(D-O-u._nearZ)/P]}}},Da={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Zc{constructor(s,u){this.aabb=s,this.lastCascade=u}}class ef{add(s,u){const y=this.receivers[s.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],u.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],u.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],u.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],u.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],u.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],u.max[2])):this.receivers[s.key]=new Zc(u,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,u,y){const S=i.cd.fromPoints(s.points);let P=0;for(const O in this.receivers){const D=this.receivers[O];if(!D||!S.intersectsAabb(D.aabb))continue;D.aabb.min=S.closestPoint(D.aabb.min),D.aabb.max=S.closestPoint(D.aabb.max);const q=D.aabb.getCorners();for(let W=0;W<y.length;W++){let Z=!0;for(const te of q){const re=[te[0]*u,te[1]*u,te[2]];if(i.ab.vec3.transformMat4(re,re,y[W].matrix),re[0]<-1||re[0]>1||re[1]<-1||re[1]>1){Z=!1;break}}if(D.lastCascade=W,P=Math.max(P,W),Z)break}}return P+1}}class Dd{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new ef,this._depthMode=new Lr(s.context.gl.LEQUAL,Lr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(Da,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(Da,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(Da,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,u){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!u||!u.properties)return;const S=u.properties.get("shadow-intensity");if(!u.shadowsEnabled()||S<=0||(this._shadowLayerCount=y.style.order.reduce((ye,fe)=>{const xe=y.style._mergedLayers[fe];return ye+(xe.hasShadowPass()&&!xe.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const P=y.context,O=Da.shadowMapResolution,D=Da.shadowMapResolution;if(this._cascades.length===0||Da.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ye=0;ye<Da.cascadeCount;++ye){const fe=y._shadowMapDebug,xe=P.gl,_e=P.createFramebuffer(O,D,fe,"texture"),Ee=new i.T(P,{width:O,height:D,data:null},xe.DEPTH_COMPONENT16);if(_e.depthAttachment.set(Ee.texture),fe){const Fe=new i.T(P,{width:O,height:D,data:null},xe.RGBA8);_e.colorAttachment.set(Fe.texture)}this._cascades.push({framebuffer:_e,texture:Ee,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=Yc(u);let q=0;if(s.elevation){const ye=s.elevation,fe=[1e4,-1e4];ye.visibleDemTiles.filter(xe=>xe.dem).forEach(xe=>{const _e=xe.dem.tree;fe[0]=Math.min(fe[0],_e.minimums[0]),fe[1]=Math.max(fe[1],_e.maximums[0])}),fe[0]!==1e4&&(q=(fe[1]-fe[0])*ye.exaggeration())}const W=1.5*s.cameraToCenterDistance,Z=3*W,te=new Float64Array(16);for(let ye=0;ye<this._cascades.length;++ye){const fe=this._cascades[ye];let xe=s.height/50,_e=1;Da.cascadeCount===1?_e=Z:ye===0?_e=W:(xe=W,_e=Z);const[Ee,Fe]=r_(s,this.shadowDirection,xe,_e,Da.shadowMapResolution,q);fe.scale=s.scale,fe.matrix=Ee,fe.boundingSphereRadius=Fe,i.ab.mat4.invert(te,fe.matrix),fe.frustum=i.bR.fromInvProjectionMatrix(te,1,0,!0),fe.far=_e}const re=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[re].far,this._cascades[re].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Da.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Da.shadowMapResolution,this._uniformValues.u_shadowmap_0=Io.ShadowMap0,this._uniformValues.u_shadowmap_1=Io.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ae=y.transform.elevation;for(const ye of this._groundShadowTiles){let fe={min:0,max:0};if(ae){const xe=ae.getMinMaxForTile(ye);xe&&(fe=xe)}this.addShadowReceiver(ye.toUnwrapped(),fe.min,fe.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,u){if(!this.enabled)return;const y=this.painter,S=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),S.viewport.set([0,0,Da.shadowMapResolution,Da.shadowMapResolution]);for(let P=0;P<this._numCascadesToRender;++P){y.currentShadowCascade=P,S.bindFramebuffer.set(this._cascades[P].framebuffer.framebuffer),S.clear({color:i.aj.white,depth:1});for(const O of s.order){const D=s._mergedLayers[O];if(!D.hasShadowPass()||D.isHidden(y.transform.zoom))continue;const q=s.getLayerSourceCache(D),W=q?u[q.id]:void 0;(D.type==="model"||W&&W.length)&&y.renderLayer(y,q,D,W)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,u=s.style,y=s.context,S=u.directionalLight,P=u.ambientLight;if(!S||!P)return;const O=[],D=Al(s,s.longestCutoffRange);D.shouldRenderCutoff&&O.push("RENDER_CUTOFF"),O.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&O.push("NORMAL_OFFSET");const q=hp(u,S,P),W=new Lr(y.gl.LEQUAL,Lr.ReadOnly,s.depthRangeFor3D);for(const Z of this._groundShadowTiles){const te=Z.toUnwrapped(),re=s.isTileAffectedByFog(Z),ae=s.getOrCreateProgram("groundShadow",{defines:O,overrideFog:re});this.setupShadows(te,ae),s.uploadCommonUniforms(y,ae,te,null,D);const ye={u_matrix:s.transform.calculateProjMatrix(te),u_ground_shadow_factor:q};ae.draw(s,y.gl.TRIANGLES,W,Gr.disabled,xn.multiply,Hr.disabled,ye,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,{},s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?xn.unblended:xn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const u=this.painter.transform,y=u.calculatePosMatrix(s,u.worldSize);return i.ab.mat4.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(s){return i.ab.mat4.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,u,y,S=0){if(!this.enabled)return;const P=this.painter.transform,O=this.painter.context,D=O.gl,q=this._uniformValues,W=new Float64Array(16),Z=P.calculatePosMatrix(s,P.worldSize);for(let te=0;te<this._cascades.length;te++)i.ab.mat4.multiply(W,this._cascades[te].matrix,Z),q[te===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(W),O.activeTexture.set(D.TEXTURE0+Io.ShadowMap0+te),this._cascades[te].texture.bind(D.NEAREST,D.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const te=i.cc(s.canonical),re=2/P.tileSize*i.ag/Da.shadowMapResolution,ae=re*this._cascades[0].boundingSphereRadius,ye=re*this._cascades[this._cascades.length-1].boundingSphereRadius,fe=(y==="vector-tile"?1:3)/Math.pow(2,S-s.canonical.z-(1-P.zoom+Math.floor(P.zoom)));q.u_shadow_normal_offset=[te,ae*fe,ye*fe],q.u_shadow_bias=[6e-5,.0012,.012]}else q.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(O,q)}setupShadowsFromMatrix(s,u,y=!1){if(!this.enabled)return;const S=this.painter.context,P=S.gl,O=this._uniformValues,D=new Float64Array(16);for(let q=0;q<Da.cascadeCount;q++)i.ab.mat4.multiply(D,this._cascades[q].matrix,s),O[q===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),S.activeTexture.set(P.TEXTURE0+Io.ShadowMap0+q),this._cascades[q].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=y,y){const q=Da.normalOffset;O.u_shadow_normal_offset=[1,q,q],O.u_shadow_bias=[6e-5,.0012,.012]}else O.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(S,O)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,u,y,S){if(S[2]>=0)return{};const P=function(q,W,Z){const te=Z/(1<<q.canonical.z);return new i.cd([q.canonical.x*te+q.wrap*Z,q.canonical.y*te+q.wrap*Z,0],[(q.canonical.x+1)*te+q.wrap*Z,(q.canonical.y+1)*te+q.wrap*Z,W])}(s,u,y).getCorners(),O=u/-S[2];S[0]<0?(i.ab.vec3.add(P[0],P[0],[S[0]*O,0,0]),i.ab.vec3.add(P[3],P[3],[S[0]*O,0,0])):S[0]>0&&(i.ab.vec3.add(P[1],P[1],[S[0]*O,0,0]),i.ab.vec3.add(P[2],P[2],[S[0]*O,0,0])),S[1]<0?(i.ab.vec3.add(P[0],P[0],[0,S[1]*O,0]),i.ab.vec3.add(P[1],P[1],[0,S[1]*O,0])):S[1]>0&&(i.ab.vec3.add(P[2],P[2],[0,S[1]*O,0]),i.ab.vec3.add(P[3],P[3],[0,S[1]*O,0]));const D={};return D.vertices=P,D.planes=[Bu(P[1],P[0],P[4]),Bu(P[2],P[1],P[5]),Bu(P[3],P[2],P[6]),Bu(P[0],P[3],P[7])],D}addShadowReceiver(s,u,y){this._receivers.add(s,i.cd.fromTileIdAndHeight(s,u,y))}getMaxCascadeForTile(s){const u=this._receivers.get(s);return u&&u.lastCascade?u.lastCascade:0}}function Bu(g,s,u){const y=i.ab.vec3.sub([],u,s),S=i.ab.vec3.sub([],g,s),P=i.ab.vec3.cross([],y,S),O=i.ab.vec3.length(P);return O===0?[0,0,1,0]:(i.ab.vec3.scale(P,P,1/O),[P[0],P[1],P[2],-i.ab.vec3.dot(P,s)])}function Yc(g){const s=g.properties.get("direction"),u=i.cb(s.x,s.y,s.z);u[2]=i.aw(u[2],0,75);const y=i.ce([u[0],u[1],u[2]]);return i.ab.vec3.fromValues(y.x,y.y,y.z)}function hp(g,s,u){const y=s.properties.get("color-use-theme")==="none",S=s.properties.get("color"),P=s.properties.get("intensity"),O=s.properties.get("direction"),D=[O.x,O.y,O.z],q=u.properties.get("color-use-theme")==="none",W=u.properties.get("color"),Z=u.properties.get("intensity"),te=Math.max(i.ab.vec3.dot([0,0,1],D),0),re=[0,0,0];i.ab.vec3.scale(re,W.toRenderColor(q?null:g.getLut(s.scope)).toArray01Linear().slice(0,3),Z);const ae=[0,0,0];return i.ab.vec3.scale(ae,S.toRenderColor(y?null:g.getLut(u.scope)).toArray01Linear().slice(0,3),te*P),i.cf([re[0]>0?re[0]/(re[0]+ae[0]):0,re[1]>0?re[1]/(re[1]+ae[1]):0,re[2]>0?re[2]/(re[2]+ae[2]):0])}function r_(g,s,u,y,S,P){const O=g.zoom,D=g.scale,q=g.worldSize,W=1/q,Z=g.aspect,te=Math.sqrt(1+Z*Z)*Math.tan(.5*g.fovX),re=te*te,ae=y-u,ye=y+u;let fe,xe;re>ae/ye?(fe=y,xe=y*te):(fe=.5*ye*(1+re),xe=.5*Math.sqrt(ae*ae+2*(y*y+u*u)*re+ye*ye*re*re));const _e=g.projection.pixelsPerMeter(g.center.lat,q),Ee=g._camera.getCameraToWorldMercator(),Fe=[0,0,-fe*W];i.ab.vec3.transformMat4(Fe,Fe,Ee);let De=xe*W;const Ze=g._edgeInsets;if(!(Ze.left===0&&Ze.top===0&&Ze.right===0&&Ze.bottom===0||Ze.left===Ze.right&&Ze.top===Ze.bottom)){const Zt=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?_e:1),zt=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,u,y);zt[8]=2*-g.centerOffset.x/g.width,zt[9]=2*g.centerOffset.y/g.height;const Nt=new Float64Array(16);i.ab.mat4.mul(Nt,zt,Zt);const qt=new Float64Array(16);i.ab.mat4.invert(qt,Nt);const er=i.bR.fromInvProjectionMatrix(qt,q,O,!0);for(const fr of er.points){const mr=((Ue=fr)[0]/=D,Ue[1]/=D,Ue[2]=i.bH(Ue[2],g._center.lat),Ue);De=Math.max(De,i.ab.vec3.len(i.ab.vec3.subtract([],Fe,mr)))}}var Ue;De*=S/(S-1);const qe=Math.acos(s[2]),Ve=Math.atan2(-s[0],-s[1]),Ke=new po;Ke.position=Fe,Ke.setPitchBearing(qe,Ve);const it=Ke.getWorldToCamera(q,_e),_t=De*q,pt=Math.min(g._mercatorZfromZoom(17)*q*-2,-2*_t),Ct=Ke.getCameraToClipOrthographic(-_t,_t,-_t,_t,pt,(_t+P*_e)/s[2]),Mt=new Float64Array(16);i.ab.mat4.multiply(Mt,Ct,it);const ut=i.ab.vec3.fromValues(Math.floor(1e6*Fe[0])/1e6*q,Math.floor(1e6*Fe[1])/1e6*q,0),Tt=.5*S,Bt=[0,0,0];i.ab.vec3.transformMat4(Bt,ut,Mt),i.ab.vec3.scale(Bt,Bt,Tt);const ft=[Math.floor(Bt[0]),Math.floor(Bt[1]),Math.floor(Bt[2])],Dt=[0,0,0];i.ab.vec3.sub(Dt,Bt,ft),i.ab.vec3.scale(Dt,Dt,-1/Tt);const Pt=new Float64Array(16);return i.ab.mat4.identity(Pt),i.ab.mat4.translate(Pt,Pt,Dt),i.ab.mat4.multiply(Mt,Pt,Mt),[Mt,_t]}class Mm extends i.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(s,u){return i.aM(this.requestManager.transformRequest(u,i.R.Model).url).then(y=>{if(!y)return;const S=i.aN(y),P=new i.aO(s,void 0,void 0,S);return P.computeBoundsAndApplyParent(),P}).catch(y=>{if(y&&y.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${s} from ${u}: ${y.message}`)))})}load(s,u,y={keepNumReferences:!1}){this.models[u]||(this.models[u]={});const S=Object.keys(s);this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+S.length;const P=[];for(const O of S)P.push(this.loadModel(O,s[O]));Promise.allSettled(P).then(O=>{for(let D=0;D<O.length;D++){const{status:q,value:W}=O[D];if(q==="fulfilled"&&W){const Z=this.models[u][S[D]];this.models[u][S[D]]={model:W,numReferences:y.keepNumReferences&&Z?Z.numReferences:1}}}this.numModelsLoading[u]-=S.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(O=>{this.fire(new i.y(new Error(`Could not load models: ${O.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,u){return!!this.getModel(s,u)}getModel(s,u){return this.models[u]||(this.models[u]={}),this.models[u][s]?this.models[u][s].model:void 0}addModel(s,u,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={}),this.hasModel(s,y)&&this.models[y][s].numReferences++,this.modelUris[y][s]=this.requestManager.normalizeModelURL(u),this.load({[s]:this.modelUris[y][s]},y)}addModels(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const y=this.modelUris[u];for(const S in s)this.models[u][S]={},y[S]=this.requestManager.normalizeModelURL(s[S]);this.load(y,u,{keepNumReferences:!0})}reloadModels(s){this.load(this.modelUris[s],s)}addModelsFromBucket(s,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const y={};for(const S of s)this.hasModel(S,u)?this.models[u][S].numReferences++:(this.modelUris[u][S]=this.requestManager.normalizeModelURL(S),y[S]=this.modelUris[u][S]);this.load(y,u)}removeModel(s,u){if(this.models[u]&&this.models[u][s]&&(this.models[u][s].numReferences--,this.models[u][s].numReferences===0)){const y=this.models[u][s].model;delete this.models[u][s],delete this.modelUris[u][s],y.destroy()}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,u){this.models[u]||(this.models[u]={});for(const y in this.models[u])this.models[u][y].model&&this.models[u][y].model.upload(s.context)}}const n_=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),i_={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function fy(g){return g=g||{},Object.assign(g,i_)}class py extends i.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(O,D){const[q,W]=O,{center:Z,radius:te}=D,[re,ae]=Z,ye=Math.abs(q-re);return Math.sqrt((ye>180?360-ye:ye)**2+(W-ae)**2)<=te}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=new i.P(this._map.transform.width/2,this._map.transform.height/2),S=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],P=this._map.queryRenderedFeatures(s?S:y,u);P.length>0&&(this._selectedFloorplan&&P[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=P[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(P){const[[O,D],[q,W]]=P,Z=(q-O+360)%360,te=Z>180?360-Z:Z;return{center:[(O+te/2+360)%360,(D+W)/2],radius:Math.sqrt(te**2+(W-D)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const u=this._floorplanStates[this._indoorData.id].selectedBuilding,y=this._floorplanStates[this._indoorData.id].selectedLevel;let S;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const P of this._indoorData.levels)P.id===this._selectedLevel.id&&(S=P.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:S})),u){const P=this._indoorData.buildings.find(O=>O.id===u);this._buildingSelected(P,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(y){const P=this._indoorData.levels.find(O=>O.id===y);this._updateLevels(P,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,u){u&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const y=this._indoorData.levels.filter(S=>s.levels.includes(S.id));this.fire(new i.z("buildingselected",{buildingId:s.id,levels:y}))}_levelSelected(s){if(s==="overview")this._updateLevels(void 0,!0);else{const u=this._indoorData.levels.find(y=>y.id===s);this._updateLevels(u,!0)}this.fire(new i.z("levelselected",{levelId:s==="overview"?void 0:s}))}_updateLevels(s,u){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(u&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function y(W){const Z=W.indexOf("/floor/");if(Z===-1)return W;const te=Z+7,re=W.indexOf("/",te);return re===-1?W.slice(te):W.slice(te,re)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const S=[],P={},O={},D={},q={};for(const W of this._indoorData.levels)if(S.push(W.id),P[W.id]=W.height,O[W.id]=W.base,s){if(this.mergeFloors){const Z=y(s.id),te=y(W.id);D[W.id]=te===Z?"true":"false"}else D[W.id]=W.id===s.id?"true":"false";q[W.id]=W.base<s.base?"true":"false"}else q[W.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",O]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",D]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",q]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),u&&s.extent)){const W=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),Z=this._map.getZoom(),te=W.zoom?Math.abs(Z-W.zoom):0;this._map.fitBounds(s.extent,te>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:Z})}}selectFloorplan(s){const u={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(y,u);if(S.length>0){for(const P of S)if(JSON.parse(P.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=P,this._floorplanSelected(!0);break}}}selectBuilding(s){const u=this._indoorData.buildings.find(y=>y.id===s);this._buildingSelected(u,!0)}selectLevel(s){this._levelSelected(s)}}function q0(g){if(!g.metadata||!g.metadata.content_area)return;const s=i.q.devicePixelRatio,{left:u,top:y,width:S,height:P}=g.metadata.content_area,O=u*s,D=y*s;return[O,D,O+S*s,D+P*s]}function a_(g){if(g)return g.map(([s,u])=>[s*i.q.devicePixelRatio,u*i.q.devicePixelRatio])}const Go=(g,s)=>Ds(g,s&&s.filter(u=>u.identifier!=="source.canvas")),fp=i.ay(dn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),my=i.ay(dn,["setCenter","setZoom","setBearing","setPitch"]),Om=new Set(["background","sky","slot","custom"]),tf={version:8,layers:[],sources:{}},gy={duration:300,delay:0};class Fs extends i.E{constructor(s,u={}){super(),this.map=s,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=i.l({},gy),this._buildingIndex=new Gc(this),this.crossTileSymbolIndex=new dy,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=u.styleChanges||new Sn,this.dispatcher=u.dispatcher?u.dispatcher:new i.D(i.ci(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new Vn(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new i.cj(s._requestManager,u.localFontFamily?i.ck.all:u.localIdeographFontFamily?i.ck.ideographs:i.ck.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new Mm(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const y=this;this._rtlTextPluginCallback=Fs.registerForPluginStateChange(S=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(P,O)=>{if(i.cm(P),O&&O.every(D=>D))for(const D in y._sourceCaches){const q=y._sourceCaches[D],W=q.getSource().type;W!=="vector"&&W!=="geojson"||q.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const P=this.getOwnSource(S.sourceId);if(P&&P.vectorLayerIds)for(const O in this._layers){const D=this._layers[O];D.source===P.id&&this._validateLayer(D)}})}load(s){return s?(typeof s=="string"?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if(typeof s=="string"){if(i.f(s))return s;const u=i.cn(s);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${i.co(JSON.stringify(s))}`}_diffStyle(s,u,y){this.globalId=this._getGlobalId(s);const S=(P,O)=>{try{O(null,this.setState(P,y))}catch(D){O(D,!1)}};if(typeof s=="string"){const P=this.map._requestManager.normalizeStyleURL(s),O=this.map._requestManager.transformRequest(P,i.R.Style);i.n(O,(D,q)=>{D?this.fire(new i.y(D)):q&&S(q,u)})}else typeof s=="object"&&S(s,u)}loadURL(s,u={}){this.fire(new i.z("dataloading",{dataType:"style"}));const y=typeof u.validate=="boolean"?u.validate:!i.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,u.accessToken),this.resolvedImports.add(s);const S=this.importsCache.get(s);if(S)return this._load(S,y);const P=this.map._requestManager.transformRequest(s,i.R.Style);this._request=i.n(P,(O,D)=>{if(this._request=null,O)this.fire(new i.y(O));else if(D)return this.importsCache.set(s,D),this._load(D,y)})}loadJSON(s,u={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=i.q.frame(()=>{this._request=null,this._load(s,u.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(tf,!1)}_loadImports(s,u,y){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const P of s){const O=this._createFragmentStyle(P),D=new Promise(Z=>{O.once("style.import.load",Z),O.once("error",Z)}).then(()=>this.mergeAll());if(S.push(D),this.resolvedImports.has(P.url)){O.loadEmpty();continue}const q=P.data||this.importsCache.get(P.url);q?(O.loadJSON(q,{validate:u}),this._isInternalStyle(q)&&(O.globalId=null)):P.url?O.loadURL(P.url,{validate:u}):O.loadEmpty();const W={style:O,id:P.id,config:P.config};if(y){const Z=this.fragments.findIndex(({id:te})=>te===y);this.fragments=this.fragments.slice(0,Z).concat(W).concat(this.fragments.slice(Z))}else this.fragments.push(W)}return Promise.allSettled(S)}getImportGlobalIds(s=this,u=new Set){for(const y of s.fragments)y.style.globalId&&u.add(y.style.globalId),this.getImportGlobalIds(y.style,u);return[...u.values()]}_createFragmentStyle(s){const u=this.scope?i.aC(s.id,this.scope):s.id;let y;const S=this._initialConfig&&this._initialConfig[u];(s.config||S)&&(y=i.l({},s.config,S));const P=new Fs(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return P.setEventedParent(this.map,{style:P}),P}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&s.fragment!==!1)}_load(s,u){const y=s.indoor?fy(s.schema):s.schema;if(this._isInternalStyle(s)){const O=i.l({},tf,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(O,u)}if(this.updateConfig(this._config,y),u&&Go(this,qa(s)))return;this._loaded=!0,this.stylesheet=i.cp(s);const S=()=>{for(const W in s.sources)this.addSource(W,s.sources[W],{validate:!1,isInitialLoad:!0});s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(s.glyphs,this.scope);const O=Du(this.stylesheet.layers);if(this._order=O.map(W=>W.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const W=this.stylesheet.lights[0];this.light=new ge(W.properties,W.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ge(this.stylesheet.light)),this._layers={};for(const W of O){const Z=i.cu(W,this.scope,this._styleColorTheme.lut,this.options);Z.configDependencies.size!==0&&this._configDependentLayers.add(Z.fqid),Z.setEventedParent(this,{layer:{id:Z.id}}),this._layers[Z.id]=Z;const te=this.getOwnLayerSourceCache(Z),re=!!this.directionalLight&&this.directionalLight.shadowsEnabled();te&&Z.canCastShadows()&&re&&(te.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const D=this.stylesheet.terrain;D&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(D,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const q=this.isRootStyle();s.imports?this._loadImports(s.imports,u).then(()=>{this._reloadImports(),this.fire(new i.z(q?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(q?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const P=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(P){const O=this._evaluateColorThemeData(P);this._loadColorTheme(O).then(()=>{S()}).catch(D=>{i.w(`Couldn't load color theme from the stylesheet: ${D}`),S()})}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let s,u,y,S,P,O,D,q,W,Z;const te={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(re=>{if(re.stylesheet){if(re.light!=null&&(s=re.light),re.stylesheet.lights)for(const ae of re.stylesheet.lights)ae.type==="ambient"&&re.ambientLight!=null&&(u=re.ambientLight),ae.type==="directional"&&re.directionalLight!=null&&(y=re.directionalLight);S=this._prioritizeTerrain(S,re.terrain,re.stylesheet.terrain),re.stylesheet.fog&&re.fog!=null&&(P=re.fog),re.stylesheet.snow&&re.snow!=null&&(O=re.snow),re.stylesheet.rain&&re.rain!=null&&(D=re.rain),re.stylesheet.camera!=null&&(Z=re.stylesheet.camera),re.stylesheet.projection!=null&&(q=re.stylesheet.projection),re.stylesheet.transition!=null&&(W=re.stylesheet.transition),te[re.scope]=re._styleColorTheme}}),this.light=s,this.ambientLight=u,this.directionalLight=y,this.fog=P,this.snow=O,this.rain=D,this._styleColorThemeForScope=te,S===null?delete this.terrain:this.terrain=S,this.camera=Z||{"camera-projection":"perspective"},this.projection=q||{name:"mercator"},this.transition=i.l({},gy,W),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const u=y=>{for(const S of y.fragments)u(S.style);s(y)};u(this)}_prioritizeTerrain(s,u,y){const S=s&&s.drapeRenderMode===0;return y===null?u&&u.drapeRenderMode===0?u:S?s:null:u!=null&&(!s||S||u&&u.drapeRenderMode===1)?u:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{s=this._prioritizeTerrain(s,u.terrain,u.stylesheet.terrain)}),s===null?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(s=u.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},u={},y={};this.forEachFragmentStyle(S=>{for(const P in S._sourceCaches){const O=i.aC(P,S.scope);s[O]=S._sourceCaches[P]}for(const P in S._otherSourceCaches){const O=i.aC(P,S.scope);u[O]=S._otherSourceCaches[P]}for(const P in S._symbolSourceCaches){const O=i.aC(P,S.scope);y[O]=S._symbolSourceCaches[P]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=y}mergeLayers(){const s={},u=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(P=>{for(const O of P._order){const D=P._layers[O];if(D.type==="slot"){const q=i.cq(O);if(s[q])continue;s[q]=[]}D.slot&&s[D.slot]?s[D.slot].push(D):u.push(D)}}),this._mergedOrder=[];const S=(P=[])=>{for(const O of P)if(O.type==="slot"){const D=i.cq(O.id);s[D]&&S(s[D]),this._mergedSlots.push(D)}else{const D=i.aC(O.id,O.scope);this._mergedOrder.push(D),y[D]=O,O.is3D()&&(this._has3DLayers=!0),O.type==="circle"&&(this._hasCircleLayers=!0),O.type==="symbol"&&(this._hasSymbolLayers=!0),O.type==="clip"&&(this._clipLayerPresent=!0)}};S(u),this._mergedOrder.sort((P,O)=>{const D=y[P],q=y[O];return D.hasInitialOcclusionOpacityProperties?q.is3D()?1:0:D.is3D()&&q.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=i.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(u,y,S){const P=i.l({},y);for(const D of Object.keys(i.a3.colorTheme))P[D]===void 0&&(P[D]=i.a3.colorTheme[D].default);const O=new i.a4(n_,u,new Map(S));return O.setTransitionOrValue(P,S),O.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,S)=>{const P="data:image/png;base64,";if(!s||s.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let O=s;O.startsWith(P)||(O=P+O);const D="mapbox-reserved-lut",q=new Image;q.src=O,q.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},q.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void y();this._styleColorTheme.lutLoading=!1;const{width:W,height:Z,data:te}=i.q.getImageData(q);if(Z>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(W!==Z*Z)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage(D)&&this.removeImage(D),this.addImage(D,{data:new i.r({width:W,height:Z},te),pixelRatio:1,sdf:!1,usvg:!1,version:0});const re=this.imageManager.getImage(D,this.scope);re?(this._styleColorTheme.lut={image:re.data,data:s},y()):S(new Error("Missing LUT image."))}})}getLut(s){const u=this._styleColorThemeForScope[s];return u?u.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(u,y,S){let P,O,D;const q=i.q.devicePixelRatio>1?"@2x":"";let W=i.n(y.transformRequest(y.normalizeSpriteURL(u,q,".json"),i.R.SpriteJSON),(re,ae)=>{W=null,D||(D=re,P=ae,te())}),Z=i.o(y.transformRequest(y.normalizeSpriteURL(u,q,".png"),i.R.SpriteImage),(re,ae)=>{Z=null,D||(D=re,O=ae,te())});function te(){if(D)S(D);else if(P&&O){const re=i.q.getImageData(O),ae={};for(const ye in P){const{width:fe,height:xe,x:_e,y:Ee,sdf:Fe,pixelRatio:De,stretchX:Ze,stretchY:Ue,content:qe}=P[ye],Ve=new i.r({width:fe,height:xe});i.r.copy(re,Ve,{x:_e,y:Ee},{x:0,y:0},{width:fe,height:xe},null),ae[ye]={data:Ve,pixelRatio:De,sdf:Fe,stretchX:Ze,stretchY:Ue,content:qe,usvg:!1}}S(null,ae)}}return{cancel(){W&&(W.cancel(),W=null),Z&&(Z.cancel(),Z=null)}}}(s,this.map._requestManager,(u,y)=>{if(this._spriteRequest=null,u)this.fire(new i.y(u));else if(y)for(const S in y)this.imageManager.addImage(S,this.scope,y[S]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(s){if(!i.f(s)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(s);const u=this.map._spriteFormat==="auto";var y,S;this._spriteRequest=(S=(P,O)=>{if(this._spriteRequest=null,P)u?this._loadSprite(s):this.fire(new i.y(P));else if(O)for(const D in O)this.imageManager.addImage(D,this.scope,O[D]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(s),i.R.Iconset),(P,O)=>{if(P)return void S(P);const D={},q=i.cg(new i.bh(O));for(const W of q.icons){const Z={version:1,pixelRatio:i.q.devicePixelRatio,content:q0(W),stretchX:W.metadata?a_(W.metadata.stretch_x_areas):void 0,stretchY:W.metadata?a_(W.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:W};D[W.name]=Z}S(null,D)}))}_validateLayer(s){const u=this.getOwnSource(s.source);if(!u)return;const y=s.sourceLayer;y&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(y)===-1)&&this.fire(new i.y(new Error(`Source layer "${y}" does not exist on source "${u.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,u)=>{const y=this.fragments[u];return y&&y.style&&(s.data=y.style.serialize()),s})}_serializeSources(){const s={};for(const u in this._sourceCaches){const y=this._sourceCaches[u].getSource();s[y.id]||(s[y.id]=y.serialize())}return s}_serializeLayers(s){const u=[];for(const y of s){const S=this._layers[y];S&&S.type!=="custom"&&u.push(S.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const u=this.getOwnLayer(s);if(u)return u;this.fire(new i.y(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const u=this.getOwnSource(s);if(u)return u;this.fire(new i.y(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,u){const y=this.map.painter;if(y)for(let S=s.minzoom||0;S<(s.maxzoom||25.5);S++){const P=s.getProgramIds();if(P)for(const O of P){const D=s.getDefaultProgramParams(O,u.zoom,this._styleColorTheme.lut);D&&(y.style=this,this.fog&&(y._fogVisible=!0,D.overrideFog=!0,y.getOrCreateProgram(O,D)),y._fogVisible=!1,D.overrideFog=!1,y.getOrCreateProgram(O,D),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(D.overrideRtt=!0,y.getOrCreateProgram(O,D)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const u=this.calculateLightsBrightness();s.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u));const y=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const O=this._changes.getLayerUpdatesByScope();for(const D in O){const{updatedIds:q,removedIds:W}=O[D];(q||W)&&(this._updateWorkerLayers(D,q,W),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const P={};for(const O in this._mergedSourceCaches){const D=this._mergedSourceCaches[O];P[O]=D.used,D.used=!1,D.tileCoverLift=0}for(const O of this._mergedOrder){const D=this._mergedLayers[O];if(D.recalculate(s,this._availableImages),!D.isHidden(s.zoom)){const q=this.getLayerSourceCache(D);q&&(q.used=!0,q.tileCoverLift=Math.max(q.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,s)}):this.precompilePrograms(D,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();for(const O in P){const D=this._mergedSourceCaches[O];P[O]!==D.used&&D.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=this._changes.getUpdatedImages();if(s.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],s);this._changes.resetUpdatedImages()}}_updateWorkerLayers(s,u,y){const S=this.getFragmentStyle(s);S&&this.dispatcher.broadcast("updateLayers",{layers:u?S._serializeLayers(u):[],scope:s,removedIds:y||[],options:S.options})}setState(s,u){if(this._checkLoaded(),Go(this,qa(s)))return!1;(s=i.cp(s)).layers=Du(s.layers);const y=function(O,D){if(!O)return[{command:dn.setStyle,args:[D]}];let q=[];try{if(!i.bn(O.version,D.version))return[{command:dn.setStyle,args:[D]}];if(i.bn(O.center,D.center)||q.push({command:dn.setCenter,args:[D.center]}),i.bn(O.zoom,D.zoom)||q.push({command:dn.setZoom,args:[D.zoom]}),i.bn(O.bearing,D.bearing)||q.push({command:dn.setBearing,args:[D.bearing]}),i.bn(O.pitch,D.pitch)||q.push({command:dn.setPitch,args:[D.pitch]}),i.bn(O.sprite,D.sprite)||q.push({command:dn.setSprite,args:[D.sprite]}),i.bn(O.glyphs,D.glyphs)||q.push({command:dn.setGlyphs,args:[D.glyphs]}),i.bn(O.imports,D.imports)||function(ae=[],ye=[],fe){ye=ye||[];const xe=(ae=ae||[]).map(fo),_e=ye.map(fo),Ee=ae.reduce(pc,{}),Fe=ye.reduce(pc,{}),De=xe.slice();let Ze,Ue,qe,Ve;for(Ze=0,Ue=0;Ze<xe.length;Ze++)qe=xe[Ze],Fe.hasOwnProperty(qe)?Ue++:(fe.push({command:dn.removeImport,args:[qe]}),De.splice(De.indexOf(qe,Ue),1));for(Ze=0,Ue=0;Ze<_e.length;Ze++)qe=_e[_e.length-1-Ze],De[De.length-1-Ze]!==qe&&(Ee.hasOwnProperty(qe)?(fe.push({command:dn.removeImport,args:[qe]}),De.splice(De.lastIndexOf(qe,De.length-Ue),1)):Ue++,Ve=De[De.length-Ze],fe.push({command:dn.addImport,args:[Fe[qe],Ve]}),De.splice(De.length-Ze,0,qe));for(const Ke of ye){const it=Ee[Ke.id];it&&!i.bn(it,Ke)&&fe.push({command:dn.updateImport,args:[Ke.id,Ke]})}}(O.imports,D.imports,q),i.bn(O.transition,D.transition)||q.push({command:dn.setTransition,args:[D.transition]}),i.bn(O.light,D.light)||q.push({command:dn.setLight,args:[D.light]}),i.bn(O.fog,D.fog)||q.push({command:dn.setFog,args:[D.fog]}),i.bn(O.snow,D.snow)||q.push({command:dn.setSnow,args:[D.snow]}),i.bn(O.rain,D.rain)||q.push({command:dn.setRain,args:[D.rain]}),i.bn(O.projection,D.projection)||q.push({command:dn.setProjection,args:[D.projection]}),i.bn(O.lights,D.lights)||q.push({command:dn.setLights,args:[D.lights]}),i.bn(O.camera,D.camera)||q.push({command:dn.setCamera,args:[D.camera]}),!i.bn(O["color-theme"],D["color-theme"]))return[{command:dn.setStyle,args:[D]}];const W={},Z=[];(function(ae,ye,fe,xe){let _e;for(_e in ye=ye||{},ae=ae||{})ae.hasOwnProperty(_e)&&(ye.hasOwnProperty(_e)||Lu(_e,fe,xe));for(_e in ye){if(!ye.hasOwnProperty(_e))continue;const Ee=ye[_e];ae.hasOwnProperty(_e)?i.bn(ae[_e],Ee)||(ae[_e].type==="geojson"&&Ee.type==="geojson"&&pi(ae,ye,_e)?fe.push({command:dn.setGeoJSONSourceData,args:[_e,Ee.data]}):_r(_e,ye,fe,xe)):Am(_e,ye,fe)}})(O.sources,D.sources,Z,W);const te=[];O.layers&&O.layers.forEach(ae=>{ae.source&&W[ae.source]?q.push({command:dn.removeLayer,args:[ae.id]}):te.push(ae)});let re=O.terrain;re&&W[re.source]&&(q.push({command:dn.setTerrain,args:[void 0]}),re=void 0),q=q.concat(Z),i.bn(re,D.terrain)||q.push({command:dn.setTerrain,args:[D.terrain]}),function(ae,ye,fe){ye=ye||[];const xe=(ae=ae||[]).map(fo),_e=ye.map(fo),Ee=ae.reduce(pc,{}),Fe=ye.reduce(pc,{}),De=xe.slice(),Ze=Object.create(null);let Ue,qe,Ve,Ke,it,_t,pt;for(Ue=0,qe=0;Ue<xe.length;Ue++)Ve=xe[Ue],Fe.hasOwnProperty(Ve)?qe++:(fe.push({command:dn.removeLayer,args:[Ve]}),De.splice(De.indexOf(Ve,qe),1));for(Ue=0,qe=0;Ue<_e.length;Ue++)Ve=_e[_e.length-1-Ue],De[De.length-1-Ue]!==Ve&&(Ee.hasOwnProperty(Ve)?(fe.push({command:dn.removeLayer,args:[Ve]}),De.splice(De.lastIndexOf(Ve,De.length-qe),1)):qe++,_t=De[De.length-Ue],fe.push({command:dn.addLayer,args:[Fe[Ve],_t]}),De.splice(De.length-Ue,0,Ve),Ze[Ve]=!0);for(Ue=0;Ue<_e.length;Ue++)if(Ve=_e[Ue],Ke=Ee[Ve],it=Fe[Ve],!Ze[Ve]&&!i.bn(Ke,it))if(i.bn(Ke.source,it.source)&&i.bn(Ke["source-layer"],it["source-layer"])&&i.bn(Ke.type,it.type)){for(pt in Wn(Ke.layout,it.layout,fe,Ve,null,dn.setLayoutProperty),Wn(Ke.paint,it.paint,fe,Ve,null,dn.setPaintProperty),i.bn(Ke.slot,it.slot)||fe.push({command:dn.setSlot,args:[Ve,it.slot]}),i.bn(Ke.filter,it.filter)||fe.push({command:dn.setFilter,args:[Ve,it.filter]}),i.bn(Ke.minzoom,it.minzoom)&&i.bn(Ke.maxzoom,it.maxzoom)||fe.push({command:dn.setLayerZoomRange,args:[Ve,it.minzoom,it.maxzoom]}),Ke)Ke.hasOwnProperty(pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&pt!=="slot"&&(pt.indexOf("paint.")===0?Wn(Ke[pt],it[pt],fe,Ve,pt.slice(6),dn.setPaintProperty):i.bn(Ke[pt],it[pt])||fe.push({command:dn.setLayerProperty,args:[Ve,pt,it[pt]]}));for(pt in it)it.hasOwnProperty(pt)&&!Ke.hasOwnProperty(pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&pt!=="slot"&&(pt.indexOf("paint.")===0?Wn(Ke[pt],it[pt],fe,Ve,pt.slice(6),dn.setPaintProperty):i.bn(Ke[pt],it[pt])||fe.push({command:dn.setLayerProperty,args:[Ve,pt,it[pt]]}))}else fe.push({command:dn.removeLayer,args:[Ve]}),_t=De[De.lastIndexOf(Ve)+1],fe.push({command:dn.addLayer,args:[it,_t]})}(te,D.layers,q)}catch(W){console.warn("Unable to compute style diff:",W),q=[{command:dn.setStyle,args:[D]}]}return q}(this.serialize(),s).filter(O=>!(O.command in my));if(y.length===0)return!1;const S=y.filter(O=>!(O.command in fp));if(S.length>0)throw new Error(`Unimplemented: ${S.map(O=>O.command).join(", ")}.`);const P=[];return y.forEach(O=>{P.push(this[O.command].apply(this,O.args))}),u&&Promise.all(P).then(u),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(s,u){return this.getImage(s)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(s,this.scope,u),this._afterImageUpdated(s),this)}updateImage(s,u,y=!1){this.imageManager.updateImage(s,this.scope,u),y&&this._afterImageUpdated(s)}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._afterImageUpdated(s),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(s),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(s,u,y={}){return this._checkLoaded(),this._validate(ju,`models.${s}`,u,null,y)||(this.modelManager.addModel(s,u,this.scope),this._changes.setDirty()),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,u,y={}){if(this._checkLoaded(),this.getOwnSource(s)!==void 0)throw new Error(`There is already a source with ID "${s}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(Uo,`sources.${s}`,u,null,y))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const S=as(s,u,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const P=O=>{const D=(O?"symbol:":"other:")+S.id,q=i.aC(D,this.scope),W=this._sourceCaches[D]=new Ls(q,S,O);(O?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=W,W.onAdd(this.map)};P(!1),u.type!=="vector"&&u.type!=="geojson"||P(!0),S.onAdd&&S.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const u=this.getOwnSource(s);if(!u)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===s)return this.fire(new i.y(new Error(`Source "${s}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new i.y(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(s);for(const S of y){const P=i.cq(S.id);delete this._sourceCaches[P],this._changes.discardSourceCacheUpdate(S.id),S.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,u){this._checkLoaded(),this.getOwnSource(s).setData(u),this._changes.setDirty()}getOwnSource(s){const u=this.getOwnSourceCache(s);return u&&u.getSource()}getOwnSources(){const s=[];for(const u in this._otherSourceCaches){const y=this.getOwnSourceCache(u);y&&s.push(y.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const u in s){const y=s[u]._tiles;for(const S in y){const P=y[S];if(P.state!=="loaded"&&P.state!=="errored")return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const S of s){if(this._validate(fa,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const P=this.ambientLight;P.set(S),P.updateTransitions(u)}else this.ambientLight=new Br(S,tr||(tr=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const P=this.directionalLight;P.set(S),P.updateTransitions(u)}else this.directionalLight=new Br(S,nr||(nr=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=new i.a8(this.z||0,u);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,u=this.ambientLight;if(!s||!u)return;const y=re=>.2126*(re[0]<=.03928?re[0]/12.92:Math.pow((re[0]+.055)/1.055,2.4))+.7152*(re[1]<=.03928?re[1]/12.92:Math.pow((re[1]+.055)/1.055,2.4))+.0722*(re[2]<=.03928?re[2]/12.92:Math.pow((re[2]+.055)/1.055,2.4)),S=s.properties.get("color").toRenderColor(null).toArray01(),P=s.properties.get("intensity"),O=s.properties.get("direction"),D=1-i.cb(O.x,O.y,O.z)[2]/90,q=y(S)*P*D,W=u.properties.get("color").toRenderColor(null).toArray01(),Z=u.properties.get("intensity"),te=y(W)*Z;return Number(((q+te)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(!s)return this;if(i.cr(s)){const u=i.cs(s),y=this.fragments.find(({id:P})=>P===u);if(!y)throw new Error(`Style import '${s}' not found`);const S=i.cq(s);return y.style.getFragmentStyle(S)}{const u=this.fragments.find(({id:y})=>y===s);return u?u.style:void 0}}setFeaturesetSelectors(s){if(!s)return;const u={},y=(S,P="")=>`${S}::${P}`;this._featuresetSelectors={};for(const S in s){const P=this._featuresetSelectors[S]=[];for(const O of s[S].selectors){if(O.featureNamespace){const q=this.getOwnLayer(O.layer);if(!q){i.w(`Layer is undefined for selector: ${O.layer}`);continue}const W=y(q.source,q.sourceLayer);if(W in u&&u[W]!==O.featureNamespace){i.w(`"featureNamespace ${O.featureNamespace} of featureset ${S}'s selector is not associated to the same source, skip this selector`);continue}u[W]=O.featureNamespace}let D;if(O.properties)for(const q in O.properties){const W=i.U(O.properties[q]);W.result==="success"&&(D=D||{},D[q]=W.value)}P.push({layerId:O.layer,namespace:O.featureNamespace,properties:D,uniqueFeatureID:O._uniqueFeatureID})}}}getFeaturesetDescriptors(s){const u=this.getFragmentStyle(s);if(!u||!u.stylesheet.featuresets)return[];const y=[];for(const S in u.stylesheet.featuresets)y.push({featuresetId:S,importId:u.scope?u.scope:void 0});return y}getFeaturesetLayers(s,u){const y=this.getFragmentStyle(u),S=y.stylesheet.featuresets;if(!S||!S[s])return this.fire(new i.y(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const P=[];for(const O of S[s].selectors){const D=y.getOwnLayer(O.layer);D&&P.push(D)}return P}getConfigProperty(s,u){const y=this.getFragmentStyle(s);if(!y)return null;const S=i.aC(u,y.scope),P=y.options.get(S),O=P?P.value||P.default:null;return O?O.serialize():null}setConfigProperty(s,u,y){const S=this.getFragmentStyle(s);if(!S)return;const P=S.stylesheet.indoor?fy(S.stylesheet.schema):S.stylesheet.schema;if(!P||!P[u])return;const O=i.U(y);if(O.result!=="success")return void Go(this,O.value);const D=O.value.expression,q=i.aC(u,S.scope),W=S.options.get(q);if(!W)return;let Z;const{minValue:te,maxValue:re,stepValue:ae,type:ye,values:fe}=P[u],xe=i.U(P[u].default);xe.result==="success"&&(Z=xe.value.expression),Z?(this.options.set(q,Object.assign({},W,{value:D,default:Z,minValue:te,maxValue:re,stepValue:ae,type:ye,values:fe})),this.updateConfigDependencies(u)):this.fire(new i.y(new Error(`No schema defined for the config option "${u}" in the "${s}" fragment.`)))}getConfig(s){const u=this.getFragmentStyle(s);if(!u)return null;const y=u.stylesheet.schema;if(!y)return null;const S={};for(const P in y){const O=i.aC(P,u.scope),D=u.options.get(O),q=D?D.value||D.default:null;S[P]=q?q.serialize():null}return S}setConfig(s,u){const y=this.getFragmentStyle(s);y&&(y.updateConfig(u,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const u=this.getFragmentStyle(s);return u?u.stylesheet.schema:null}setSchema(s,u){const y=this.getFragmentStyle(s);y&&(y.stylesheet.schema=u,y.updateConfig(y._config,u),this.updateConfigDependencies())}updateConfig(s,u){if(this._config=s,s||u)if(u)for(const y in u){let S,P;const O=i.U(u[y].default);if(O.result==="success"&&(S=O.value.expression),s&&s[y]!==void 0){const re=i.U(s[y]);re.result==="success"&&(P=re.value.expression)}const{minValue:D,maxValue:q,stepValue:W,type:Z,values:te}=u[y];if(S){const re=i.aC(y,this.scope);this.options.set(re,{default:S,value:P,minValue:D,maxValue:q,stepValue:W,type:Z,values:te})}else this.fire(new i.y(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const u of this._configDependentLayers){const y=this.getLayer(u);if(y){if(s&&!y.configDependencies.has(s))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const y=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(y){const S=u._evaluateColorThemeData(y);(!u._styleColorTheme.lut&&S!==""||u._styleColorTheme.lut&&S!==u._styleColorTheme.lut.data)&&u.setColorTheme(y)}}),this._changes.setDirty()}addLayer(s,u,y={}){this._checkLoaded();const S=s.id;if(this._layers[S])return void this.fire(new i.y(new Error(`Layer with id "${S}" already exists on this map`)));let P;if(s.type==="custom"){if(Go(this,i.ct(s)))return;P=i.cu(s,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof s.source=="object"&&(this.addSource(S,s.source),s=i.cp(s),s=i.l(s,{source:S})),this._validate(No,`layers.${S}`,s,{arrayIndex:-1},y))return;P=i.cu(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(P),P.setEventedParent(this,{layer:{id:S}})}P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid);let O=this._order.length;if(u){const Z=this._order.indexOf(u);if(Z===-1)return void this.fire(new i.y(new Error(`Layer with id "${u}" does not exist on this map.`)));P.slot===this._layers[u].slot?O=Z:i.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(O,0,S),this._layerOrderChanged=!0,this._layers[S]=P;const D=this.getOwnLayerSourceCache(P),q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&P.canCastShadows()&&q&&(D.castsShadows=!0);const W=this._changes.getRemovedLayer(P);if(W&&P.source&&D&&P.type!=="custom"){this._changes.discardLayerRemoval(P);const Z=i.aC(P.source,P.scope);W.type!==P.type?this._changes.updateSourceCache(Z,"clear"):(this._changes.updateSourceCache(Z,"reload"),D.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),P.scope=this.scope,this.mergeLayers()}moveLayer(s,u){this._checkLoaded();const y=this._checkLayer(s);if(!y||s===u)return;const S=this._order.indexOf(s);this._order.splice(S,1);let P=this._order.length;if(u){const O=this._order.indexOf(u);if(O===-1)return void this.fire(new i.y(new Error(`Layer with id "${u}" does not exist on this map.`)));y.slot===this._layers[u].slot?P=O:i.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const u=this._checkLayer(s);if(!u)return;u.setEventedParent(null);const y=this._order.indexOf(s);this._order.splice(y,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const S=this.getOwnLayerSourceCache(u);if(S&&S.castsShadows){let P=!1;for(const O in this._layers)if(this._layers[O].source===u.source&&this._layers[O].canCastShadows()){P=!0;break}S.castsShadows=P}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const u in this._layers)if(this._layers[u].type===s)return!0;return!1}setLayerZoomRange(s,u,y){this._checkLoaded();const S=this._checkLayer(s);S&&(S.minzoom===u&&S.maxzoom===y||(u!=null&&(S.minzoom=u),y!=null&&(S.maxzoom=y),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,u){this._checkLoaded();const y=this._checkLayer(s);y&&y.slot!==u&&(y.slot=u,this._updateLayer(y))}setFilter(s,u,y={}){this._checkLoaded();const S=this._checkLayer(s);if(S&&!i.bn(S.filter,u))return u==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(Ui,`layers.${S.id}.filter`,u,{layerType:S.type},y)||(S.filter=i.cp(u),this._updateLayer(S)))}getFilter(s){const u=this._checkLayer(s);if(u)return i.cp(u.filter)}setLayoutProperty(s,u,y,S={}){this._checkLoaded();const P=this._checkLayer(s);if(P&&!i.bn(P.getLayoutProperty(u),y)){if(y!=null&&(!S||S.validate!==!1)&&Go(P,uo.call(qa,{key:`layers.${s}.layout.${u}`,layerType:P.type,objectKey:u,value:y,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;P.setLayoutProperty(u,y),P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),this._updateLayer(P)}}getLayoutProperty(s,u){const y=this._checkLayer(s);if(y)return y.getLayoutProperty(u)}setPaintProperty(s,u,y,S={}){this._checkLoaded();const P=this._checkLayer(s);if(!P||i.bn(P.getPaintProperty(u),y)||y!=null&&(!S||S.validate!==!1)&&Go(P,So.call(qa,{key:`layers.${s}.paint.${u}`,layerType:P.type,objectKey:u,value:y,styleSpec:i.a3})))return;const O=P.setPaintProperty(u,y);P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),O&&this._updateLayer(P),this._changes.updatePaintProperties(P)}getPaintProperty(s,u){const y=this._checkLayer(s);if(y)return y.getPaintProperty(u)}setFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:q,importId:W}=s.target,Z=this.getFragmentStyle(W),te=Z.getFeaturesetLayers(q);for(const{source:re,sourceLayer:ae}of te)Z.setFeatureState({id:s.id,source:re,sourceLayer:ae},u)}else if("layerId"in s.target){const{layerId:q}=s.target,W=this.getLayer(q);this.setFeatureState({id:s.id,source:W.source,sourceLayer:W.sourceLayer},u)}return}const y=s.source,S=s.sourceLayer,P=this._checkSource(y);if(!P)return;const O=P.type;if(O==="geojson"&&S)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(O==="vector"&&!S)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));s.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const D=this.getOwnSourceCaches(y);for(const q of D)q.setFeatureState(S,s.id,u)}removeFeatureState(s,u){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:q,importId:W}=s.target,Z=this.getFragmentStyle(W),te=Z.getFeaturesetLayers(q);for(const{source:re,sourceLayer:ae}of te)Z.removeFeatureState({id:s.id,source:re,sourceLayer:ae},u)}else if("layerId"in s.target){const{layerId:q}=s.target,W=this.getLayer(q);this.removeFeatureState({id:s.id,source:W.source,sourceLayer:W.sourceLayer},u)}return}const y=s.source,S=this._checkSource(y);if(!S)return;const P=S.type,O=P==="vector"?s.sourceLayer:void 0;if(P==="vector"&&!O)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof s.id!="string"&&typeof s.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const D=this.getOwnSourceCaches(y);for(const q of D)q.removeFeatureState(O,s.id,u)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let P;if("featuresetId"in s.target){const{featuresetId:O,importId:D}=s.target,q=this.getFragmentStyle(D),W=q.getFeaturesetLayers(O);for(const{source:Z,sourceLayer:te}of W){const re=q.getFeatureState({id:s.id,source:Z,sourceLayer:te});if(re&&!P)P=re;else if(!i.bn(P,re))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:O}=s.target,D=this.getLayer(O);P=this.getFeatureState({id:s.id,source:D.source,sourceLayer:D.sourceLayer})}return P}const u=s.source,y=s.sourceLayer,S=this._checkSource(u);if(S){if(S.type!=="vector"||y)return s.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(y,s.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=i.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),u=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateFilteredLayers(s){for(const u of Object.values(this._mergedLayers))s(u)&&this._updateLayer(u)}_updateLayer(s){this._changes.updateLayer(s);const u=this.getLayerSourceCache(s),y=i.aC(s.source,s.scope),S=this._changes.getUpdatedSourceCaches();s.source&&!S[y]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),u.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const u=D=>this._mergedLayers[D].is3D(),y=this.order,S={},P=[];for(let D=y.length-1;D>=0;D--){const q=y[D];if(u(q)){S[q]=D;for(const W of s){const Z=W[q];if(Z)for(const te of Z)P.push(te)}}}P.sort((D,q)=>q.intersectionZ-D.intersectionZ);const O=[];for(let D=y.length-1;D>=0;D--){const q=y[D];if(u(q))for(let W=P.length-1;W>=0;W--){const Z=P[W].feature;if(Z.layer&&S[Z.layer.id]<D)break;O.push(Z),P.pop()}else for(const W of s){const Z=W[q];if(Z)for(const te of Z)O.push(te.feature)}}return O}queryRenderedFeatures(s,u,y){let S;u&&!Array.isArray(u)&&u.filter&&(this._validate(Ui,"queryRenderedFeatures.filter",u.filter,null,u),S=i.aZ(u.filter));const P={},O=Z=>{if(Om.has(Z.type))return;const te=this.getOwnLayerSourceCache(Z),re=P[te.id]=P[te.id]||{sourceCache:te,layers:{},has3DLayers:!1};Z.is3D()&&(re.has3DLayers=!0),re.layers[Z.fqid]=re.layers[Z.fqid]||{styleLayer:Z,targets:[]},re.layers[Z.fqid].targets.push({filter:S})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const Z of u.layers){const te=this._layers[Z];if(!te)return this.fire(new i.y(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];O(te)}}else for(const Z in this._layers)O(this._layers[Z]);const D=this._queryRenderedFeatures(s,P,y),q=this._flattenAndSortRenderedFeatures(D),W=[];for(const Z of q)i.cs(Z.layer.id)===this.scope&&W.push(Z);return W}queryRenderedFeatureset(s,u,y){let S;u&&!Array.isArray(u)&&u.filter&&(this._validate(Ui,"queryRenderedFeatures.filter",u.filter,null,u),S=i.aZ(u.filter));const P="mock",O=[];if(u&&u.target)O.push(Object.assign({},u,{targetId:P,filter:S}));else{const Z=this.getFeaturesetDescriptors();for(const te of Z)O.push({targetId:P,filter:S,target:te});for(const{style:te}of this.fragments){const re=te.getFeaturesetDescriptors();for(const ae of re)O.push({targetId:P,filter:S,target:ae})}}const D=this.queryRenderedTargets(s,O,y),q=[],W=new Set;for(const Z of D)for(const te of Z.variants[P])bl(te,Z,W)||q.push(new i.cw(Z,te));return q}queryRenderedTargets(s,u,y){const S={},P=(D,q,W,Z)=>{const te=S[q.id]=S[q.id]||{sourceCache:q,layers:{},has3DLayers:!1};if(te.layers[D.fqid]=te.layers[D.fqid]||{styleLayer:D,targets:[]},D.is3D()&&(te.has3DLayers=!0),!Z)return W.uniqueFeatureID=!1,void te.layers[D.fqid].targets.push(W);te.layers[D.fqid].targets.push(Object.assign({},W,{namespace:Z.namespace,properties:Z.properties,uniqueFeatureID:Z.uniqueFeatureID}))};for(const D of u)if("featuresetId"in D.target){const{featuresetId:q,importId:W}=D.target,Z=this.getFragmentStyle(W);if(!Z||!Z._featuresetSelectors)continue;const te=Z._featuresetSelectors[q];if(!te){this.fire(new i.y(new Error(`The featureset '${q}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const re of te){const ae=Z.getOwnLayer(re.layerId);ae&&!Om.has(ae.type)&&P(ae,Z.getOwnLayerSourceCache(ae),D,re)}}else if("layerId"in D.target){const{layerId:q}=D.target,W=this.getLayer(q);if(!W||Om.has(W.type))continue;P(W,this.getLayerSourceCache(W),D)}const O=this._queryRenderedFeatures(s,S,y);return this._flattenAndSortRenderedFeatures(O)}_queryRenderedFeatures(s,u,y){const S=[],P=!!this.map._showQueryGeometry,O=Fr.createFromScreenPoints(s,y);for(const D in u){const q=$c(O,u[D],this._availableImages,y,P);Object.keys(q).length&&S.push(q)}if(this.placement)for(const D in u){if(!u[D].sourceCache._onlySymbols)continue;const q=Hh(O.screenGeometry,u[D],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(q).length&&S.push(q)}return S}querySourceFeatures(s,u){const y=u&&u.filter;y&&this._validate(Ui,"querySourceFeatures.filter",y,null,u);let S=[];const P=this.getOwnSourceCaches(s);for(const O of P)S=S.concat(Qv(O,u));return S}addSourceType(s,u,y){return Fs.getSourceType(s)?y(new Error(`A source type called "${s}" already exists.`)):(Fs.setSourceType(s,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:u.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,u,y={}){this._checkLoaded();const S=this.light.getLight();let P=!1;for(const D in s)if(!i.bn(s[D],S[D])){P=!0;break}if(!P)return;const O=this._getTransitionParameters();this.light.setLight(s,u,y),this.light.updateTransitions(O)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,u=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,s===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=s;const S=s.source==null;if(u===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const D="terrain-dem-src";this.addSource(D,y.source),y=i.cp(y),y=i.l(y,{source:D})}const P=i.l({},y),O={};if(this.terrain&&S){P.source=this.terrain.get().source;const D=this.terrain?this.getFragmentStyle(this.terrain.scope):null;D&&(O.style=D.serialize())}if(this._validate(Ca,"terrain",P,O))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&u!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,u),this.fire(new i.z("data",{dataType:"style"}))}else{const P=this.terrain,O=P.get();for(const D of Object.keys(i.a3.terrain))!y.hasOwnProperty(D)&&i.a3.terrain[D].default&&(y[D]=i.a3.terrain[D].default);for(const D in s)if(!i.bn(s[D],O[D])){P.set(s,this.options),this.stylesheet.terrain=s;const q=this._getTransitionParameters({duration:0});P.updateTransitions(q),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const u=this.fog=new xt(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_createSnow(s){const u=this.snow=new Sr(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_createRain(s){const u=this.rain=new Vr(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.fog=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.snow=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!i.bn(u.get(),s)){u.set(s,this.options),this.stylesheet.rain=u.get();const y=this._getTransitionParameters({duration:0});u.updateTransitions(y)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void s();const y=this._evaluateColorThemeData(u);this._loadColorTheme(y).then(()=>{this.fire(new i.z("colorthemeset")),s()}).catch(S=>{i.w(`Couldn't set color theme: ${S}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,u){const y=this.getFragmentStyle(s);y&&(y._styleColorTheme.colorThemeOverride=u,y._reloadColorTheme())}_getTransitionParameters(s){return{now:i.q.now(),transition:i.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],u=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?s.push(y):u.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...u)}_createTerrain(s,u){const y=this.terrain=new we(s,u,this.scope,this.options);u===1&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});y.updateTransitions(S)}_force3DLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const u=this._layers[s];u.type==="symbol"&&this._updateLayer(u)}}_validate(s,u,y,S,P={}){if(P&&P.validate===!1)return!1;const O=i.l({},this.serialize());return Go(this,s.call(qa,i.l({key:u,style:O,value:y,styleSpec:i.a3},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(s){const u=this.getSourceCaches(s);for(const y of u)y.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const u=this.getSourceCaches(s);for(const y of u)y.resume(),y.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(s=>{s.modelManager.reloadModels(s.scope)})}updateSources(s){let u;this.directionalLight&&(u=Yc(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(s,void 0,void 0,u)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const u=this._sourceCaches[s];u.resume(),u.reload()}}_updatePlacement(s,u,y,S,P,O,D=!1){let q=!1,W=!1;const Z={},te={};for(const re of this._mergedOrder){const ae=this._mergedLayers[re];if(ae.type!=="symbol")continue;const ye=i.aC(ae.source,ae.scope);let fe=Z[ye];if(!fe){const _e=this.getLayerSourceCache(ae);if(!_e)continue;const Ee=_e.getRenderableIds(!0).map(Fe=>_e.getTileByID(Fe));te[ye]=Ee.slice(),fe=Z[ye]=Ee.sort((Fe,De)=>De.tileID.overscaledZ-Fe.tileID.overscaledZ||(Fe.tileID.isLessThan(De.tileID)?-1:1))}const xe=this.crossTileSymbolIndex.addLayer(ae,fe,u.center.lng,u.projection);q=q||xe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),u.zoom))&&(this.pauseablePlacement=new U0(u,this._mergedOrder,D,y,S,P,this.placement,this.fog&&u.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Z,te,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),W=!0),q&&this.pauseablePlacement.placement.setStale()),W||q){this._buildingIndex.onNewFrame(u.zoom);for(let re=0;re<this._mergedOrder.length;re++){const ae=this._mergedLayers[this._mergedOrder[re]];if(ae.type!=="symbol")continue;const ye=this.isLayerClipped(ae);this.placement.updateLayerOpacities(ae,Z[i.aC(ae.source,ae.scope)],re,ye?O:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,u){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:P})=>P===s.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!u)return y.push(s),this._loadImports([s],!0);const S=y.findIndex(({id:P})=>P===u);return S===-1&&this.fire(new i.y(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,S).concat(s).concat(y.slice(S)),this._loadImports([s],!0,u)}updateImport(s,u){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(s);return S===-1?this:typeof u=="string"?(this.setImportUrl(s,u),this):(u.url&&u.url!==y[S].url&&this.setImportUrl(s,u.url),i.bn(u.config,y[S].config)||this.setImportConfig(s,u.config,u.data.schema),i.bn(u.data,y[S].data)||this.setImportData(s,u.data),this)}moveImport(s,u){this._checkLoaded();let y=this.stylesheet.imports||[];const S=this.getImportIndex(s);if(S===-1)return this;const P=this.getImportIndex(u);if(P===-1)return this;const O=y[S],D=this.fragments[S];return y=y.filter(({id:q})=>q!==s),this.fragments=this.fragments.filter(({id:q})=>q!==s),this.stylesheet.imports=y.slice(0,P).concat(O).concat(y.slice(P)),this.fragments=this.fragments.slice(0,P).concat(D).concat(this.fragments.slice(P)),this.mergeLayers(),this}setImportUrl(s,u){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(s);if(S===-1)return this;y[S].url=u;const P=this.fragments[S];return P.style=this._createFragmentStyle(y[S]),P.style.on("style.import.load",()=>this.mergeAll()),P.style.loadURL(u),this}setImportData(s,u){this._checkLoaded();const y=this.getImportIndex(s),S=this.stylesheet.imports||[];return y===-1?this:u?(this.fragments[y].style.setState(u),this._reloadImports(),this):(delete S[y].data,this.setImportUrl(s,S[y].url))}setImportConfig(s,u,y){this._checkLoaded();const S=this.getImportIndex(s),P=this.stylesheet.imports||[];if(S===-1)return this;u?P[S].config=u:delete P[S].config;const O=this.fragments[S];y&&O.style.stylesheet&&(O.style.stylesheet.schema=y);const D=O.style.stylesheet&&O.style.stylesheet.schema;return O.config=u,O.style.updateConfig(u,D),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const u=this.stylesheet.imports||[],y=this.getImportIndex(s);y!==-1&&(u.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(s){const u=(this.stylesheet.imports||[]).findIndex(y=>y.id===s);return u===-1&&this.fire(new i.y(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),u}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const u in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[u];y&&s.push(y.getSource())}return s}getSource(s,u){const y=this.getSourceCache(s,u);return y&&y.getSource()}getLayerSource(s){const u=this.getLayerSourceCache(s);return u&&u.getSource()}getSourceCache(s,u){const y=i.aC(s,u);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(s){const u=i.aC(s.source,s.scope);return s.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(s){if(s==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[s]&&u.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&u.push(this._mergedSymbolSourceCaches[s]),u}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const u in s){const y=s[u];y==="reload"?this.reloadSource(u):y==="clear"&&this.clearSource(u)}}updateLayers(s){const u=this._changes.getUpdatedPaintProperties();for(const y of u){const S=this.getLayer(y);S&&S.updateTransitions(s)}}getImages(s,u,y){this.imageManager.getImages(u.icons,u.scope,y),this._updateTilesForChangedImages();const S=P=>{P&&P.setDependencies(u.tileID.key,u.type,u.icons)};S(this._otherSourceCaches[u.source]),S(this._symbolSourceCaches[u.source])}rasterizeImages(s,u,y){this.imageManager.rasterizeImages(u,y)}getGlyphs(s,u,y){this.glyphManager.getGlyphs(u.stacks,u.scope,y)}getResource(s,u,y){return i.cy(u,y)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return s.type==="symbol"?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const u=[];return this._otherSourceCaches[s]&&u.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&u.push(this._symbolSourceCaches[s]),u}_isSourceCacheLoaded(s){const u=this.getOwnSourceCaches(s);return u.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${s}'`))),!1):u.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,u){if(!this._clipLayerPresent&&s.type!=="fill-extrusion")return!1;const y=s.type==="fill-extrusion"&&s.sourceLayer==="building";if(s.is3D()){if(y||u&&u.type==="batched-model"||s.type==="model")return!0}else if(s.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Fs.getSourceType=function(g){return to[g]},Fs.setSourceType=function(g,s){to[g]=s},Fs.registerForPluginStateChange=i.ch;var Rm=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,pp=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Xc=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,vc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Vu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,mp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Uu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Jc=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,_c=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ld=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,$u=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const xc=[];qu(Rm,xc),qu(Xc,xc),qu(pp,xc);const zd={"_prelude_fog.vertex.glsl":mp,"_prelude_terrain.vertex.glsl":Vu,"_prelude_shadow.vertex.glsl":Ld,"_prelude_fog.fragment.glsl":Uu,"_prelude_shadow.fragment.glsl":$u,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Jc,"_prelude_raster_particle.glsl":_c},rf={};bn("",Vu),bn(Uu,mp),bn($u,Ld),bn(Jc,""),bn(_c,"");const gp=bn(pp,Xc),nf=Rm;var Fd={background:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:bn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:bn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:bn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:bn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:bn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:bn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:bn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:bn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:bn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:bn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:bn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:bn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:bn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:bn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:bn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:bn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,vc),skyboxGradient:bn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,vc),skyboxCapture:bn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:bn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:bn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:bn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:bn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:bn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:bn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:bn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:bn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function qu(g,s){const u=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of u)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=y.split(" ");for(const P of S)s.includes(P)||s.push(P)}}function bn(g,s){const u=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(W=>{const Z=W.split(" ");return Z[Z.length-1]}),S=[...new Set(S)]);const P={},O=[],D=[];if(g=g.replace(u,(W,Z)=>(D.push(Z),"")),(s=s.replace(u,(W,Z)=>(O.push(Z),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let q=[...xc];qu(g,q),qu(s,q);for(const W of[...O,...D])zd[W]||console.error(`Undefined include: ${W}`),rf[W]||(rf[W]=[],qu(zd[W],rf[W])),q=[...q,...rf[W]];return{fragmentSource:g=g.replace(y,(W,Z,te,re,ae)=>(P[ae]=!0,Z==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
in ${te} ${re} ${ae};
#else
uniform ${te} ${re} u_${ae};
#endif
`:Z==="initialize"?`
#ifdef HAS_UNIFORM_u_${ae}
    ${te} ${re} ${ae} = u_${ae};
#endif
`:Z==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${te} ${re} ${ae};
#endif
`:Z==="initialize-attribute"?"":void 0)),vertexSource:s=s.replace(y,(W,Z,te,re,ae)=>{const ye=re==="float"?"vec2":re,fe=ae.match(/color/)?"color":ye;return Z==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
in ${te} ${re} a_${ae};
#endif
`:P[ae]?Z==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${te} ${ye} a_${ae};
out ${te} ${re} ${ae};
#else
uniform ${te} ${re} u_${ae};
#endif
`:Z==="initialize"?fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = a_${ae};
#else
    ${te} ${re} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${ae} = unpack_mix_${fe}(a_${ae}, u_${ae}_t);
#else
    ${te} ${re} ${ae} = u_${ae};
#endif
`:Z==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    in ${te} ${re} a_${ae};
    out ${te} ${re} ${ae};
#endif
`:Z==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${ae} = a_${ae};
#endif
`:void 0:Z==="define"?`
#ifndef HAS_UNIFORM_u_${ae}
uniform lowp float u_${ae}_t;
in ${te} ${ye} a_${ae};
#else
uniform ${te} ${re} u_${ae};
#endif
`:Z==="define-instanced"?fe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ae}0;
in vec4 a_${ae}1;
in vec4 a_${ae}2;
in vec4 a_${ae}3;
#else
uniform ${te} ${re} u_${ae};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${te} ${ye} a_${ae};
#else
uniform ${te} ${re} u_${ae};
#endif
`:Z==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ae}
    ${te} ${re} ${ae} = a_${ae};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${ae}
    ${te} ${re} ${ae} = a_${ae};
#else
    ${te} ${re} ${ae} = u_${ae};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ae}
    ${te} ${re} ${ae} = unpack_mix_${fe}(a_${ae}, u_${ae}_t);
#else
    ${te} ${re} ${ae} = u_${ae};
#endif
`}),staticAttributes:S,usedDefines:q,vertexIncludes:O,fragmentIncludes:D}}class km{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,u,y,S,P,O,D,q){this.context=s;let W=this.boundPaintVertexBuffers.length!==S.length;for(let te=0;!W&&te<S.length;te++)this.boundPaintVertexBuffers[te]!==S[te]&&(W=!0);let Z=this.boundDynamicVertexBuffers.length!==D.length;for(let te=0;!Z&&te<D.length;te++)this.boundDynamicVertexBuffers[te]!==D[te]&&(Z=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==y||W||Z||this.boundIndexBuffer!==P||this.boundVertexOffset!==O)this.freshBind(u,y,S,P,O,D,q);else{s.bindVertexArrayOES.set(this.vao);for(const te of D)te&&(te.bind(),q&&te.instanceCount&&te.setVertexAttribDivisor(s.gl,u,q));P&&P.dynamicDraw&&P.bind()}}freshBind(s,u,y,S,P,O,D){const q=s.numAttributes,W=this.context,Z=W.gl;this.vao&&this.destroy(),this.vao=W.gl.createVertexArray(),W.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=S,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=O,u.enableAttributes(Z,s),u.bind(),u.setVertexAttribPointers(Z,s,P);for(const te of y)te.enableAttributes(Z,s),te.bind(),te.setVertexAttribPointers(Z,s,P);for(const te of O)te&&(te.enableAttributes(Z,s),te.bind(),te.setVertexAttribPointers(Z,s,P),D&&te.instanceCount&&te.setVertexAttribDivisor(Z,s,D));S&&S.bind(),W.currentNumAttributes=q}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Gu(g,s){const u=Math.pow(2,s.canonical.z),y=s.canonical.y;return[new i.aa(0,y/u).toLngLat().lat,new i.aa(0,(y+1)/u).toLngLat().lat]}function o_(g,s,u,y,S,P,O){const D=g.context,q=D.gl,W=u.hillshadeFBO;if(!W)return;g.prepareDrawTile();const Z=g.isTileAffectedByFog(s),te=g.getOrCreateProgram("hillshade",{overrideFog:Z});D.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,W.colorAttachment.get());const re=((xe,_e,Ee,Fe)=>{const De=Ee.paint.get("hillshade-shadow-color"),Ze=Ee.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ue=Ee.paint.get("hillshade-highlight-color"),qe=Ee.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ve=Ee.paint.get("hillshade-accent-color"),Ke=Ee.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",it=Ee.paint.get("hillshade-emissive-strength");let _t=i.ai(Ee.paint.get("hillshade-illumination-direction"));if(Ee.paint.get("hillshade-illumination-anchor")==="viewport")_t-=xe.transform.angle;else if(xe.style&&xe.style.enable3dLights()&&xe.style.directionalLight){const Ct=xe.style.directionalLight.properties.get("direction"),Mt=i.cb(Ct.x,Ct.y,Ct.z);_t=i.ai(Mt[1])}const pt=!xe.options.moving;return{u_matrix:Fe||xe.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),pt),u_image:0,u_latrange:Gu(0,_e.tileID),u_light:[Ee.paint.get("hillshade-exaggeration"),_t],u_shadow:De.toRenderColor(Ze?null:Ee.lut),u_highlight:Ue.toRenderColor(qe?null:Ee.lut),u_emissive_strength:it,u_accent:Ve.toRenderColor(Ke?null:Ee.lut)}})(g,u,y,g.terrain?s.projMatrix:null);g.uploadCommonUniforms(D,te,s.toUnwrapped());const{tileBoundsBuffer:ae,tileBoundsIndexBuffer:ye,tileBoundsSegments:fe}=g.getTileBoundsBuffers(u);te.draw(g,q.TRIANGLES,S,P,O,Hr.disabled,re,y.id,ae,ye,fe)}function s_(g,s,u){if(!s.needsDEMTextureUpload)return;const y=g.context,S=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||g.getTileTexture(u.stride);const P=u.getPixels();s.demTexture?s.demTexture.update(P,{premultiply:!1}):s.demTexture=new i.T(y,P,S.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function yp(g,s,u){const y=g.context,S=y.gl;if(!s.dem)return;const P=s.dem;if(y.activeTexture.set(S.TEXTURE1),s_(g,s,P),!s.demTexture)return;s.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const O=P.dim;y.activeTexture.set(S.TEXTURE0);let D=s.hillshadeFBO;if(!D){const re=new i.T(y,{width:O,height:O,data:null},S.RGBA8);re.bind(S.LINEAR,S.CLAMP_TO_EDGE),D=s.hillshadeFBO=y.createFramebuffer(O,O,!0,"renderbuffer"),D.colorAttachment.set(re.texture)}y.bindFramebuffer.set(D.framebuffer),y.viewport.set([0,0,O,O]);const{tileBoundsBuffer:q,tileBoundsIndexBuffer:W,tileBoundsSegments:Z}=g.getMercatorTileBoundsBuffers(),te=[];g.linearFloatFilteringSupported()&&te.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:te}).draw(g,S.TRIANGLES,Lr.disabled,Gr.disabled,xn.unblended,Hr.disabled,((re,ae)=>{const ye=ae.stride,fe=i.ab.mat4.create();return i.ab.mat4.ortho(fe,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(fe,fe,[0,-i.ag,0]),{u_matrix:fe,u_image:1,u_dimension:[ye,ye],u_zoom:re.overscaledZ}})(s.tileID,P),u.id,q,W,Z),s.needsHillshadePrepare=!1}class zi{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jm extends zi{getDefault(){return i.aj.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class Nm extends zi{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class ca extends zi{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class vp extends zi{getDefault(){return[!0,!0,!0,!0]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class _p extends zi{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class af extends zi{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class l_ extends zi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const u=this.current;(s.func!==u.func||s.ref!==u.ref||s.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class Bd extends zi{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class Qc extends zi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=s,this.dirty=!1}}class xp extends zi{getDefault(){return[0,1]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class Po extends zi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=s,this.dirty=!1}}class Im extends zi{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Dm extends zi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.BLEND):u.disable(u.BLEND),this.current=s,this.dirty=!1}}class Lm extends zi{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class zm extends zi{getDefault(){return i.aj.transparent}set(s){const u=this.current;(s.r!==u.r||s.g!==u.g||s.b!==u.b||s.a!==u.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class of extends zi{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Vd extends zi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;s?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=s,this.dirty=!1}}class bp extends zi{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class wp extends zi{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let sf=class extends zi{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Fm extends zi{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class c_ extends zi{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const u=this.current;(s[0]!==u[0]||s[1]!==u[1]||s[2]!==u[2]||s[3]!==u[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class Ud extends zi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class G0 extends zi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class K0 extends zi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class yy extends zi{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class Ku extends zi{getDefault(){return null}set(s){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class u_ extends zi{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class lf extends zi{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Tl extends zi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class $d extends zi{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class Pl extends zi{constructor(s,u){super(s),this.context=s,this.parent=u}getDefault(){return null}}class Wu extends Pl{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class vy extends Pl{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class d_ extends Pl{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Hu extends vy{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const qd=(g,s,u)=>({u_matrix:g,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:u}),ll=(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:u,u_zoom_transition:S,u_merc_center:P,u_image0:0,u_frustum_tl:O,u_frustum_tr:D,u_frustum_br:q,u_frustum_bl:W,u_globe_pos:Z,u_globe_radius:te,u_viewport:re,u_grid_matrix:fe?Float32Array.from(fe):new Float32Array(9),u_skirt_height:ae,u_far_z_cutoff:ye});function cf(g,s){return g!=null&&s!=null&&!(!g.hasData()||!s.hasData())&&g.demTexture!=null&&s.demTexture!=null&&g.tileID.key!==s.tileID.key}const xs=new class{constructor(){this.operations={}}newMorphing(g,s,u,y,S){if(g in this.operations){const P=this.operations[g];P.to.tileID.key!==u.tileID.key&&(P.queued=u)}else this.operations[g]={startTime:y,phase:0,duration:S,from:s,to:u,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const s=this.operations[g];return{from:s.from,to:s.to,phase:s.phase}}update(g){for(const s in this.operations){const u=this.operations[s];for(u.phase=(g-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,g)){delete this.operations[s];break}}}_nextOp(g,s){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=s,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},eu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function El(g,s,u){if(s===0)return 0;const y=s<1&&u===514?.25/s:1;return 6*Math.pow(1.5,22-g)*Math.max(s,1)*y}function ga(g,s){const u=1<<g.z;return!s&&(g.x===0||g.x===u-1)||g.y===0||g.y===u-1}const Ji=g=>({u_matrix:g});function Cl(g,s,u,y,S){if(S>0){const P=i.q.now(),O=(P-g.timeAdded)/S,D=s?(P-s.timeAdded)/S:-1,q=u.getSource(),W=y.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),Z=!s||Math.abs(s.tileID.overscaledZ-W)>Math.abs(g.tileID.overscaledZ-W),te=Z&&g.refreshedUponExpiration?1:i.aw(Z?O:1-D,0,1);return g.refreshedUponExpiration&&O>=1&&(g.refreshedUponExpiration=!1),s?{opacity:1,mix:1-te}:{opacity:te,mix:0}}return{opacity:1,mix:0}}class Do extends Ls{constructor(s){const u={type:"raster-dem",maxzoom:s.transform.maxZoom},y=new i.D(i.ci(),null),S=as("mock-dem",u,y,s.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,u){s.state="loaded",u(null)}}class Bs extends Ls{constructor(s){const u=as("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new i.D(i.ci(),null),s.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,u,y){if(s.freezeTileCoverage)return;this.transform=s;const S=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,O)=>{if(P[O.key]="",!this._tiles[O.key]){const D=new hc(O,this._source.tileSize*O.overscaleFactor(),s.tileZoom);D.state="loaded",this._tiles[O.key]=D}return P},{});for(const P in this._tiles)P in S||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(s){const u=this.proxyCachedFBO[s];if(u!==void 0){const y=Object.values(u);this.renderCachePool.push(...y),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class tu extends i.aG{constructor(s,u,y){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=u,this.projMatrix=y}}class Wl extends i.cJ{constructor(s,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,S,P]=function(q){const W=new i.b4,Z=new i.aU,te=131;W.reserve(17161),Z.reserve(33800);const re=i.ag/128,ae=i.ag+re/2,ye=ae+re;for(let xe=-re;xe<ye;xe+=re)for(let _e=-re;_e<ye;_e+=re){const Ee=_e<0||_e>ae||xe<0||xe>ae?24575:0,Fe=i.aw(Math.round(_e),0,i.ag),De=i.aw(Math.round(xe),0,i.ag);W.emplaceBack(Fe+Ee,De)}const fe=(xe,_e)=>{const Ee=_e*te+xe;Z.emplaceBack(Ee+1,Ee,Ee+te),Z.emplaceBack(Ee+te,Ee+te+1,Ee+1)};for(let xe=1;xe<129;xe++)for(let _e=1;_e<129;_e++)fe(_e,xe);return[0,129].forEach(xe=>{for(let _e=0;_e<130;_e++)fe(_e,xe),fe(xe,_e)}),[W,Z,32768]}(),O=s.context;this.gridBuffer=O.createVertexBuffer(y,i.b6.members),this.gridIndexBuffer=O.createIndexBuffer(S),this.gridSegments=i.b7.simpleSegment(0,0,y.length,S.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,y.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Bs(u.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const D=O.gl;this._overlapStencilMode=new Gr({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Do(u.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,u,y){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const S=s.terrain.properties,P=s.terrain.drapeRenderMode===0,O=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const D=s.terrain&&s.terrain.scope,q=S.get("source"),W=P?this._mockSourceCache:s.getSourceCache(q,D);if(!W)return void i.w(`Couldn't find terrain source "${q}".`);if(this.sourceCache=W,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=O?this.calculateExaggeration(u):S.get("exaggeration"),!u.projection.requiresDraping&&O&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Z=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const te=this.getScaledDemTileSize();this.sourceCache.update(u,te,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Z(),this._initializing=!0),Z(),u.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const u=this._previousCameraAltitude,y=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=y;const S=u!=null?y-u:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const P=s.zoom,O=this._style.terrain;if(!this._previousUpdateTimestamp)return O.getExaggeration(P);let D=P-this._previousZoom;const q=this._previousUpdateTimestamp;let W=P;this._evaluationZoom!=null&&(W=this._evaluationZoom,Math.abs(P-W)>.5&&(D=.5*(P-W+D)),D*S<0&&(W+=D)),this._evaluationZoom=W;const Z=O.getExaggeration(W),te=Z===O.getExaggeration(Math.max(0,W-.1));if(te&&Math.abs(Z-this._exaggeration)<.01)return Z;let re=Math.min(.1,.00375*(this._updateTimestamp-q));return(te||Z<.1||Math.abs(D)<1e-4)&&(re=Math.min(.2,4*re)),i.af(this._exaggeration,Z,re)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&s.dataType==="source"?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):s.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=u.getIds().map(q=>{const W=u.getTileByID(q).tileID;return W.projMatrix=y.calculateProjMatrix(W.toUnwrapped()),W});(function(q,W){const Z=W.transform.pointCoordinate(W.transform.getCameraPoint()),te=new i.P(Z.x,Z.y);q.sort((re,ae)=>{if(ae.overscaledZ-re.overscaledZ)return ae.overscaledZ-re.overscaledZ;const ye=new i.P(re.canonical.x+(1<<re.canonical.z)*re.wrap,re.canonical.y),fe=new i.P(ae.canonical.x+(1<<ae.canonical.z)*ae.wrap,ae.canonical.y),xe=te.mult(1<<re.canonical.z);return xe.x-=.5,xe.y-=.5,xe.distSqr(ye)-xe.distSqr(fe)})})(S,this.painter);const P=this.proxyToSource||{};this.proxyToSource={},S.forEach(q=>{this.proxyToSource[q.key]={}}),this.terrainTileForTile={};const O=this._style._mergedSourceCaches;for(const q in O){const W=O[q];if(!W.used||(W!==this.sourceCache&&this.resetTileLookupCache(W.id),this._setupProxiedCoordsForOrtho(W,s[q],P),W.usedForTerrain))continue;const Z=s[q];W.getSource().reparseOverscaled&&this._assignTerrainTiles(Z)}this.proxiedCoords[u.id]=S.map(q=>new tu(q,q.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1;const D={};this._visibleDemTiles=[];for(const q of this.proxyCoords){const W=this.terrainTileForTile[q.key];if(!W)continue;const Z=W.tileID.key;Z in D||(this._visibleDemTiles.push(W),D[Z]=Z)}}_assignTerrainTiles(s){this._initializing||s.forEach(u=>{if(this.terrainTileForTile[u.key])return;const y=this._findTileCoveringTileID(u,this.sourceCache);y&&(this.terrainTileForTile[u.key]=y)})}_prepareDEMTextures(){const s=this.painter.context,u=s.gl;for(const y in this.terrainTileForTile){const S=this.terrainTileForTile[y],P=S.dem;!P||S.demTexture&&!S.needsDEMTextureUpload||(s.activeTexture.set(u.TEXTURE1),s_(this.painter,S,P))}}_prepareDemTileUniforms(s,u,y,S){if(!u||u.demTexture==null)return!1;const P=s.tileID.canonical,O=Math.pow(2,u.tileID.canonical.z-P.z),D=S||"";return y[`u_dem_tl${D}`]=[P.x*O%1,P.y*O%1],y[`u_dem_scale${D}`]=O,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const u=this._visibleDemTiles.reduce((y,S)=>{if(!S.dem)return y;const P=S.dem.tree.minimums[0];return P>0&&s++,y+P},0);return s?u/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,u=s.gl;s.activeTexture.set(u.TEXTURE2);const y=this._getLoadedAreaMinimum(),S=new i.cK({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(S,{premultiply:!1}):P=this._emptyDEMTexture=new i.T(s,S,u.R32F,{premultiply:!1}),P}setupElevationDraw(s,u,y){const S=this.painter.context,P=S.gl,O={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};O.u_exaggeration=this.exaggeration();let D=null,q=null,W=1;if(y&&y.morphing&&this._useVertexMorphing){const ae=y.morphing.srcDemTile,ye=y.morphing.dstDemTile;W=y.morphing.phase,ae&&ye&&(this._prepareDemTileUniforms(s,ae,O,"_prev")&&(q=ae),this._prepareDemTileUniforms(s,ye,O)&&(D=ye))}const Z=ae=>ae&&ae.demTexture&&this.painter.linearFloatFilteringSupported()?P.LINEAR:P.NEAREST;let te=null;var re;if(this.enabled?q&&D?(te=D.demTexture,S.activeTexture.set(P.TEXTURE4),q.demTexture.bind(Z(q),P.CLAMP_TO_EDGE),O.u_dem_lerp=W):(D=this.terrainTileForTile[s.tileID.key],te=this._prepareDemTileUniforms(s,D,O)?D.demTexture:this.emptyDEMTexture):te=this.emptyDEMTexture,S.activeTexture.set(P.TEXTURE2),te&&(O.u_dem_size=(re=te).size[0]===1?1:re.size[0]-2,te.bind(Z(D),P.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,u,O),y&&y.useMeterToDem&&D){const ae=(1<<D.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;O.u_meter_to_dem=ae}if(y&&y.labelPlaneMatrixInv&&(O.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),u.setTerrainUniformValues(S,O),this.painter.transform.projection.name==="globe"){const ae=this.globeUniformValues(this.painter.transform,s.tileID.canonical,y&&y.useDenormalizedUpVectorScale);u.setGlobeUniformValues(S,ae)}}globeUniformValues(s,u,y){const S=s.projection;return{u_tile_tl_up:S.upVector(u,0,0),u_tile_tr_up:S.upVector(u,i.ag,0),u_tile_br_up:S.upVector(u,i.ag,i.ag),u_tile_bl_up:S.upVector(u,0,i.ag),u_tile_up_scale:y?i.cL(1):S.upVectorScale(u,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const u=this.painter,y=this.painter.context;s.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,P,O,D,q){if(S.transform.projection.name==="globe")(function(W,Z,te,re,ae){const ye=W.context,fe=ye.gl;let xe,_e;const Ee=W.transform,Fe=i.cC(W,ye,Ee),De=(Ct,Mt)=>{if(_e===Mt)return;const ut=[eu[Mt],"PROJECTION_GLOBE_VIEW"];Fe&&ut.push("CUSTOM_ANTIALIASING");const Tt=W.isTileAffectedByFog(Ct);xe=W.getOrCreateProgram("globeRaster",{defines:ut,overrideFog:Tt}),_e=Mt},Ze=W.colorModeForRenderPass(),Ue=new Lr(fe.LEQUAL,Lr.ReadWrite,W.depthRangeFor3D);xs.update(ae);const qe=i.cD(Ee),Ve=[i.at(Ee.center.lng),i.aA(Ee.center.lat)],Ke=W.globeSharedBuffers,it=[Ee.width*i.q.devicePixelRatio,Ee.height*i.q.devicePixelRatio],_t=Float32Array.from(Ee.globeMatrix),pt={useDenormalizedUpVectorScale:!0};{const Ct=W.transform,Mt=El(Ct.zoom,Z.exaggeration(),Z.sourceCache._source.tileSize);_e=-1;const ut=fe.TRIANGLES;for(const Tt of re){const Bt=te.getTile(Tt),ft=Gr.disabled,Dt=Z.prevTerrainTileForTile[Tt.key],Pt=Z.terrainTileForTile[Tt.key];cf(Dt,Pt)&&xs.newMorphing(Tt.key,Dt,Pt,ae,250),ye.activeTexture.set(fe.TEXTURE0),Bt.texture&&Bt.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const Zt=xs.getMorphValuesForProxy(Tt.key),zt=Zt?1:0;Zt&&i.J(pt,{morphing:{srcDemTile:Zt.from,dstDemTile:Zt.to,phase:i.cB(Zt.phase)}});const Nt=i.cE(Tt.canonical),qt=i.cF(Nt.getCenter().lat),er=i.cG(Tt.canonical,Nt,qt,Ct.worldSize/Ct._pixelsPerMercatorPixel),fr=i.bb(i.cH(Tt.canonical)),mr=ll(Ct.expandedFarZProjMatrix,_t,qe,fr,i.ae(Ct.zoom),Ve,Ct.frustumCorners.TL,Ct.frustumCorners.TR,Ct.frustumCorners.BR,Ct.frustumCorners.BL,Ct.globeCenterInViewSpace,Ct.globeRadius,it,Mt,Ct._farZ,er);if(De(Tt,zt),xe&&(Z.setupElevationDraw(Bt,xe,pt),W.uploadCommonUniforms(ye,xe,Tt.toUnwrapped()),Ke)){const[$r,Or,jr]=Ke.getGridBuffers(qt,Mt!==0);xe.draw(W,ut,Ue,ft,Ze,Hr.backCCW,mr,"globe_raster",$r,Or,jr)}}}if(Ke&&(W.renderDefaultNorthPole||W.renderDefaultSouthPole)){const Ct=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Fe&&Ct.push("CUSTOM_ANTIALIASING"),xe=W.getOrCreateProgram("globeRaster",{defines:Ct});for(const Mt of re){const{x:ut,y:Tt,z:Bt}=Mt.canonical,ft=Tt===0,Dt=Tt===(1<<Bt)-1,[Pt,Zt,zt,Nt]=Ke.getPoleBuffers(Bt,!1);if(Nt&&(ft||Dt)){const qt=te.getTile(Mt);ye.activeTexture.set(fe.TEXTURE0),qt.texture&&qt.texture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);let er=i.cI(Bt,ut,Ee);const fr=i.bb(i.cH(Mt.canonical)),mr=($r,Or)=>$r.draw(W,fe.TRIANGLES,Ue,Gr.disabled,Ze,Hr.disabled,ll(Ee.expandedFarZProjMatrix,er,er,fr,0,Ve,Ee.frustumCorners.TL,Ee.frustumCorners.TR,Ee.frustumCorners.BR,Ee.frustumCorners.BL,Ee.globeCenterInViewSpace,Ee.globeRadius,it,0,Ee._farZ),"globe_pole_raster",Or,zt,Nt);Z.setupElevationDraw(qt,xe,pt),W.uploadCommonUniforms(ye,xe,Mt.toUnwrapped()),ft&&W.renderDefaultNorthPole&&mr(xe,Pt),Dt&&W.renderDefaultSouthPole&&(er=i.ab.mat4.scale(i.ab.mat4.create(),er,[1,-1,1]),mr(xe,Zt))}}}})(S,P,O,D,q);else{const W=S.context,Z=W.gl;let te,re;const ae=S.shadowRenderer,ye=Al(S,S.longestCutoffRange),fe=Ze=>{if(re===Ze)return;const Ue=[];Ue.push(eu[Ze]),ye.shouldRenderCutoff&&Ue.push("RENDER_CUTOFF"),ae&&(Ue.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&Ue.push("NORMAL_OFFSET")),te=S.getOrCreateProgram("terrainRaster",{defines:Ue}),re=Ze},xe=S.colorModeForRenderPass(),_e=new Lr(Z.LEQUAL,Lr.ReadWrite,S.depthRangeFor3D);xs.update(q);const Ee=S.transform,Fe=El(Ee.zoom,P.exaggeration(),P.sourceCache._source.tileSize);let De=[0,0,0];if(ae){const Ze=S.style.directionalLight,Ue=S.style.ambientLight;Ze&&Ue&&(De=hp(S.style,Ze,Ue))}{re=-1;const Ze=Z.TRIANGLES,[Ue,qe]=[P.gridIndexBuffer,P.gridSegments];for(const Ve of D){const Ke=O.getTile(Ve),it=Gr.disabled,_t=P.prevTerrainTileForTile[Ve.key],pt=P.terrainTileForTile[Ve.key];cf(_t,pt)&&xs.newMorphing(Ve.key,_t,pt,q,250),W.activeTexture.set(Z.TEXTURE0),Ke.texture&&Ke.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const Ct=xs.getMorphValuesForProxy(Ve.key),Mt=Ct?1:0;let ut;Ct&&(ut={morphing:{srcDemTile:Ct.from,dstDemTile:Ct.to,phase:i.cB(Ct.phase)}});const Tt=qd(Ve.projMatrix,ga(Ve.canonical,Ee.renderWorldCopies)?Fe/10:Fe,De);if(fe(Mt),!te)continue;P.setupElevationDraw(Ke,te,ut);const Bt=Ve.toUnwrapped();ae&&ae.setupShadows(Bt,te),S.uploadCommonUniforms(W,te,Bt,null,ye),te.draw(S,Ze,_e,it,xe,Hr.backCCW,Tt,"terrain_raster",P.gridBuffer,Ue,qe)}}}}(u,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(this._drapedRenderBatches.length===0)return s+1;this.renderingToTexture=!0;const u=this.painter,y=this.painter.context,S=this.proxySourceCache,P=this.proxiedCoords[S.id],O=this._drapedRenderBatches.shift(),D=u.style.order,q=[];let W=0;for(const Z of P){const te=S.getTileByID(Z.proxyTileKey),re=S.proxyCachedFBO[Z.key]?S.proxyCachedFBO[Z.key][s]:void 0,ae=re!==void 0?S.renderCache[re]:this.pool[W++],ye=re!==void 0;if(te.texture=ae.tex,ye&&!ae.dirty){q.push(te.tileID);continue}let fe;y.bindFramebuffer.set(ae.fb.framebuffer),this.renderedToTile=!1,ae.dirty&&(y.clear({color:i.aj.transparent,stencil:0}),ae.dirty=!1);for(let xe=O.start;xe<=O.end;++xe){const _e=u.style._mergedLayers[D[xe]];if(_e.isHidden(u.transform.zoom))continue;const Ee=u.style.getLayerSourceCache(_e),Fe=Ee?this.proxyToSource[Z.key][Ee.id]:[Z];if(!Fe)continue;const De=Fe;y.viewport.set([0,0,ae.fb.width,ae.fb.height]),fe!==(Ee?Ee.id:null)&&(this._setupStencil(ae,Fe,_e,Ee),fe=Ee?Ee.id:null),u.renderLayer(u,Ee,_e,De)}if(this._drapedRenderBatches.length===0)for(const xe of this._pendingGroundEffectLayers){const _e=u.style._mergedLayers[D[xe]];if(_e.isHidden(u.transform.zoom))continue;const Ee=u.style.getLayerSourceCache(_e),Fe=Ee?this.proxyToSource[Z.key][Ee.id]:[Z];if(!Fe)continue;const De=Fe;y.viewport.set([0,0,ae.fb.width,ae.fb.height]),fe!==(Ee?Ee.id:null)&&(this._setupStencil(ae,Fe,_e,Ee),fe=Ee?Ee.id:null),u.renderLayer(u,Ee,_e,De)}this.renderedToTile?(ae.dirty=!0,q.push(te.tileID)):ye||--W,W===5&&(W=0,this.renderToBackBuffer(q))}return this.renderToBackBuffer(q),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,u.width,u.height]),O.end+1}postRender(){}isLayerOrderingCorrect(s){const u=s.order.length;let y=-1,S=u;for(let P=0;P<u;++P)this._style.isLayerDraped(s._mergedLayers[s.order[P]])?y=Math.max(y,P):S=Math.min(S,P);return S>y}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{s=Math.min(s,u.dem.tree.minimums[0])}),s===0?s:(s-30)*this._exaggeration}raycast(s,u,y){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const O=P.tileID,D=1<<O.overscaledZ,{x:q,y:W}=O.canonical,Z=q/D,te=(q+1)/D,re=W/D,ae=(W+1)/D;return{minx:Z,miny:re,maxx:te,maxy:ae,t:P.dem.tree.raycastRoot(Z,re,te,ae,s,u,y),tile:P}});S.sort((P,O)=>(P.t!==null?P.t:Number.MAX_VALUE)-(O.t!==null?O.t:Number.MAX_VALUE));for(const P of S){if(P.t==null)return null;const O=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,s,u,y);if(O!=null)return O}return null}_createFBO(){const s=this.painter.context,u=s.gl,y=this.drapeBufferSize;s.activeTexture.set(u.TEXTURE0);const S=new i.T(s,{width:y[0],height:y[1],data:null},u.RGBA8);S.bind(u.LINEAR,u.CLAMP_TO_EDGE);const P=s.createFramebuffer(y[0],y[1],!0,null);return P.colorAttachment.set(S.texture),P.depthAttachment=new Hu(s,P.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:P,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const u=this._style._mergedLayers[s],y=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!y&&u.shouldRedrape():!y&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const y of this._style.getSources())if(y instanceof Oa){s=!0;break}if(!s)return;const u={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],P=this._style.getLayerSourceCache(S);if(P&&!u[P.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof i.a9){u[P.id]=!0;for(const O of this.proxyCoords){const D=this.proxyToSource[O.key][P.id];if(D)for(const q of D)this._clearRenderCacheForTile(P.id,q)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof ho){s=!0;break}if(!s)return;const u={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],P=this._style.getLayerSourceCache(S);if(!P||u[P.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const O=S.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const q=this.proxyToSource[D.key][P.id];if(q)for(const W of q){const Z=Cl(P.getTile(W),P.findLoadedParent(W,0),P,this.painter.transform,O);(Z.opacity!==1||Z.mix!==0)&&this._clearRenderCacheForTile(P.id,W)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,u=s.length;if(u===0)return;const y=[];this._pendingGroundEffectLayers=[];let S,P=0,O=this._style._mergedLayers[s[P]];for(;!this._style.isLayerDraped(O)&&O.isHidden(this.painter.transform.zoom)&&++P<u;)O=this._style._mergedLayers[s[P]];for(;P<u;++P){const D=this._style._mergedLayers[s[P]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?S===void 0&&(S=P):(D.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(P),S!==void 0&&(y.push({start:S,end:P-1}),S=void 0)))}if(S!==void 0&&y.push({start:S,end:P-1}),y.length!==0){const D=y[y.length-1];this._pendingGroundEffectLayers.every(q=>q>D.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(s){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const O=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let D=0;D<O.length;++D){const q=Object.values(O[D]);u.renderCachePool.push(...q)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,S=this._tilesDirty;for(let O=y.length-1;O>=0;O--){const D=y[O];if(u.getTileByID(D.key),u.proxyCachedFBO[D.key]!==void 0){const q=s[D.key],W=this.proxyToSource[D.key];let Z=0;for(const te in W){const re=W[te],ae=q[te];if(!ae||ae.length!==re.length||re.some((ye,fe)=>ye!==ae[fe]||S[te]&&S[te].hasOwnProperty(ye.key))){Z=-1;break}++Z}for(const te in u.proxyCachedFBO[D.key])u.renderCache[u.proxyCachedFBO[D.key][te]].dirty=Z<0||Z!==Object.values(q).length}}const P=[...this._drapedRenderBatches];P.sort((O,D)=>D.end-D.start-(O.end-O.start));for(const O of P)for(const D of y){if(u.proxyCachedFBO[D.key])continue;let q=u.renderCachePool.pop();q===void 0&&u.renderCache.length<50&&(q=u.renderCache.length,u.renderCache.push(this._createFBO())),q!==void 0&&(u.proxyCachedFBO[D.key]={},u.proxyCachedFBO[D.key][O.start]=q,u.renderCache[q].dirty=!0)}this._tilesDirty={}}_setupStencil(s,u,y,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,O=P.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let D;if(y.isTileClipped())D=u.length,this._overlapStencilMode.test={func:O.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:O.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Gr.disabled}_renderTileClippingMasks(s,u){const y=this.painter,S=this.painter.context,P=S.gl;y._tileClippingMaskIDs={},S.setColorMode(xn.disabled),S.setDepthMode(Lr.disabled);const O=y.getOrCreateProgram("clippingMask");for(const D of s){const q=y._tileClippingMaskIDs[D.key]=--u;O.draw(y,P.TRIANGLES,Lr.disabled,new Gr({func:P.ALWAYS,mask:0},q,255,P.KEEP,P.KEEP,P.REPLACE),xn.disabled,Hr.disabled,Ji(D.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(s){const u=this.painter.transform;if(s.x<0||s.x>u.width||s.y<0||s.y>u.height)return null;const y=[s.x,s.y,1,1];i.ab.vec4.transformMat4(y,y,u.pixelMatrixInverse),i.ab.vec4.scale(y,y,1/y[3]),y[0]/=u.worldSize,y[1]/=u.worldSize;const S=u._camera.position,P=i.bH(1,u.center.lat),O=[S[0],S[1],S[2]/P,0],D=i.ab.vec3.subtract([],y.slice(0,3),O);i.ab.vec3.normalize(D,D);const q=this.raycast(O,D,this._exaggeration);return q!==null&&q?(i.ab.vec3.scaleAndAdd(O,O,D,q),O[3]=O[2],O[2]*=P,O):null}_setupProxiedCoordsForOrtho(s,u,y){if(s.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(s,u,y);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const S=this.proxiedCoords[s.id]=[],P=this.proxyCoords;for(let q=0;q<P.length;q++){const W=P[q],Z=this._findTileCoveringTileID(W,s);if(Z){const te=this._createProxiedId(W,Z,y[W.key]&&y[W.key][s.id]);S.push(te),this.proxyToSource[W.key][s.id]=[te]}}let O=!1;const D=new Set;for(let q=0;q<u.length;q++){const W=s.getTile(u[q]);if(!W||!W.hasData())continue;const Z=this._findTileCoveringTileID(W.tileID,this.proxySourceCache);if(Z&&Z.tileID.canonical.z!==W.tileID.canonical.z){const te=this.proxyToSource[Z.tileID.key][s.id],re=this._createProxiedId(Z.tileID,W,y[Z.tileID.key]&&y[Z.tileID.key][s.id]);te?te.splice(te.length-1,0,re):this.proxyToSource[Z.tileID.key][s.id]=[re];const ae=this.proxyToSource[Z.tileID.key][s.id];D.has(ae)||D.add(ae),S.push(re),O=!0}}if(this._sourceTilesOverlap[s.id]=O,O&&this._debugParams.sortTilesHiZFirst)for(const q of D)q.sort((W,Z)=>Z.overscaledZ-W.overscaledZ)}_setupProxiedCoordsForImageSource(s,u,y){if(!s.getSource().loaded())return;const S=this.proxiedCoords[s.id]=[],P=this.proxyCoords,O=s.getSource(),D=O.tileID;if(!D)return;const q=new i.P(D.x,D.y)._div(1<<D.z),W=O.coordinates.map(i.aa.fromLngLat).reduce((te,re)=>(te.min.x=Math.min(te.min.x,re.x-q.x),te.min.y=Math.min(te.min.y,re.y-q.y),te.max.x=Math.max(te.max.x,re.x-q.x),te.max.y=Math.max(te.max.y,re.y-q.y),te),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Z=(te,re)=>{const ae=te.wrap+te.canonical.x/(1<<te.canonical.z),ye=te.canonical.y/(1<<te.canonical.z),fe=i.ag/(1<<te.canonical.z),xe=re.wrap+re.canonical.x/(1<<re.canonical.z),_e=re.canonical.y/(1<<re.canonical.z);return ae+fe<xe+W.min.x||ae>xe+W.max.x||ye+fe<_e+W.min.y||ye>_e+W.max.y};for(let te=0;te<P.length;te++){const re=P[te];for(let ae=0;ae<u.length;ae++){const ye=s.getTile(u[ae]);if(!ye||!ye.hasData()||Z(re,ye.tileID))continue;const fe=this._createProxiedId(re,ye,y[re.key]&&y[re.key][s.id]),xe=this.proxyToSource[re.key][s.id];xe?xe.push(fe):this.proxyToSource[re.key][s.id]=[fe],S.push(fe)}}}_createProxiedId(s,u,y){let S=this.orthoMatrix;if(y){const P=y.find(O=>O.key===u.tileID.key);if(P)return P}if(u.tileID.key!==s.key){const P=s.canonical.z-u.tileID.canonical.z;let O,D,q;S=i.ab.mat4.create();const W=u.tileID.wrap-s.wrap<<s.overscaledZ;P>0?(O=i.ag>>P,D=O*((u.tileID.canonical.x<<P)-s.canonical.x+W),q=O*((u.tileID.canonical.y<<P)-s.canonical.y)):(O=i.ag<<-P,D=i.ag*(u.tileID.canonical.x-(s.canonical.x+W<<-P)),q=i.ag*(u.tileID.canonical.y-(s.canonical.y<<-P))),i.ab.mat4.ortho(S,0,O,0,O,0,1),i.ab.mat4.translate(S,S,[D,q,0])}return new tu(u.tileID,s.key,S)}_findTileCoveringTileID(s,u){let y=u.getTile(s);if(y&&y.hasData())return y;const S=this._findCoveringTileCache[u.id],P=S[s.key];if(y=P?u.getTileByID(P):null,y&&y.hasData()||P===null)return y;let O=y?y.tileID:s,D=O.overscaledZ;const q=u.getSource().minzoom,W=[];if(!P){const te=u.getSource().maxzoom;if(s.canonical.z>=te){const re=s.canonical.z-te;u.getSource().reparseOverscaled?(D=Math.max(s.canonical.z+2,u.transform.tileZoom),O=new i.aG(D,s.wrap,te,s.canonical.x>>re,s.canonical.y>>re)):re!==0&&(D=te,O=new i.aG(D,s.wrap,te,s.canonical.x>>re,s.canonical.y>>re))}O.key!==s.key&&(W.push(O.key),y=u.getTile(O))}const Z=te=>{W.forEach(re=>{S[re]=te}),W.length=0};for(D-=1;D>=q&&(!y||!y.hasData());D--){y&&Z(y.tileID.key);const te=O.calculateScaledKey(D);if(y=u.getTileByID(te),y&&y.hasData())break;const re=S[te];if(re===null)break;re===void 0?W.push(te):y=u.getTileByID(re)}return Z(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,u){let y=this._tilesDirty[s];y||(y=this._tilesDirty[s]={}),y[u.key]=!0}}function Vs(g,s,u){const y=function(D,q,W){const Z=i.ab.vec3.dot(q,D),te=i.ab.vec3.dot(W,[.2126,.7152,.0722]),re=(ye,fe,xe)=>(1-xe)*ye+xe*fe,ae=re(1-.3*Math.min(te,1),1,Math.min(Z+1,1));return re(.92,1,Math.asin(i.aw(q[2],-1,1))/Math.PI+.5)*ae}(g,[0,0,1],s),S=[0,0,0];i.ab.vec3.scale(S,u.slice(0,3),y);const P=[0,0,0];i.ab.vec3.scale(P,s.slice(0,3),g[2]);const O=[0,0,0];return i.ab.vec3.add(O,S,P),i.cf(O)}const Bm=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],_y=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class xy{static cacheKey(s,u,y,S){let P=`${u}${S?S.cacheKey:""}`;for(const O of y)s.usedDefines.includes(O)&&(P+=`/${O}`);return P}constructor(s,u,y,S,P,O){const D=s.gl;this.program=D.createProgram(),this.configuration=S,this.name=u,this.fixedDefines=[...O];const q=S?S.getBinderAttributes():[],W=(y.staticAttributes||[]).concat(q);let Z=S?S.defines():[];Z=Z.concat(O.map(xe=>`#define ${xe}`));const te=`#version 300 es
`;let re=te+Z.concat("precision mediump float;",nf,gp.fragmentSource).join(`
`);for(const xe of y.fragmentIncludes)re+=`
${zd[xe]}`;re+=`
${y.fragmentSource}`;let ae=te+Z.concat("precision highp float;",nf,gp.vertexSource).join(`
`);for(const xe of y.vertexIncludes)ae+=`
${zd[xe]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ae+=`
uniform int u_instanceID;
`),ae+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ae=ae.replaceAll("gl_InstanceID","u_instanceID"));const ye=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(ye,re),D.compileShader(ye),D.attachShader(this.program,ye);const fe=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(fe,ae),D.compileShader(fe),D.attachShader(this.program,fe),this.attributes={},this.numAttributes=W.length;for(let xe=0;xe<this.numAttributes;xe++)if(W[xe]){const _e=W[xe].startsWith("a_")?W[xe]:`a_${W[xe]}`;D.bindAttribLocation(this.program,xe,_e),this.attributes[_e]=xe}D.linkProgram(this.program),D.deleteShader(fe),D.deleteShader(ye),this.fixedUniforms=P(s),this.binderUniforms=S?S.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(xe=>({u_instanceID:new i.bN(xe)}))(s)),(O.includes("TERRAIN")||u.indexOf("symbol")!==-1||u.indexOf("circle")!==-1)&&(this.terrainUniforms=(xe=>({u_dem:new i.bN(xe),u_dem_prev:new i.bN(xe),u_dem_tl:new i.bK(xe),u_dem_scale:new i.bM(xe),u_dem_tl_prev:new i.bK(xe),u_dem_scale_prev:new i.bM(xe),u_dem_size:new i.bM(xe),u_dem_lerp:new i.bM(xe),u_exaggeration:new i.bM(xe),u_depth:new i.bN(xe),u_depth_size_inv:new i.bK(xe),u_depth_range_unpack:new i.bK(xe),u_occluder_half_size:new i.bM(xe),u_occlusion_depth_offset:new i.bM(xe),u_meter_to_dem:new i.bM(xe),u_label_plane_matrix_inv:new i.bJ(xe)}))(s)),O.includes("GLOBE")&&(this.globeUniforms=(xe=>({u_tile_tl_up:new i.bL(xe),u_tile_tr_up:new i.bL(xe),u_tile_br_up:new i.bL(xe),u_tile_bl_up:new i.bL(xe),u_tile_up_scale:new i.bM(xe)}))(s)),O.includes("FOG")&&(this.fogUniforms=(xe=>({u_fog_matrix:new i.bJ(xe),u_fog_range:new i.bK(xe),u_fog_color:new i.ca(xe),u_fog_horizon_blend:new i.bM(xe),u_fog_vertical_limit:new i.bK(xe),u_fog_temporal_offset:new i.bM(xe),u_frustum_tl:new i.bL(xe),u_frustum_tr:new i.bL(xe),u_frustum_br:new i.bL(xe),u_frustum_bl:new i.bL(xe),u_globe_pos:new i.bL(xe),u_globe_radius:new i.bM(xe),u_globe_transition:new i.bM(xe),u_is_globe:new i.bN(xe),u_viewport:new i.bK(xe)}))(s)),O.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(xe=>({u_cutoff_params:new i.ca(xe)}))(s)),O.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(xe=>({u_lighting_ambient_color:new i.bL(xe),u_lighting_directional_dir:new i.bL(xe),u_lighting_directional_color:new i.bL(xe),u_ground_radiance:new i.bL(xe)}))(s)),O.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(xe=>({u_light_matrix_0:new i.bJ(xe),u_light_matrix_1:new i.bJ(xe),u_fade_range:new i.bK(xe),u_shadow_normal_offset:new i.bL(xe),u_shadow_intensity:new i.bM(xe),u_shadow_texel_size:new i.bM(xe),u_shadow_map_resolution:new i.bM(xe),u_shadow_direction:new i.bL(xe),u_shadow_bias:new i.bL(xe),u_shadowmap_0:new i.bN(xe),u_shadowmap_1:new i.bN(xe)}))(s))}}setTerrainUniformValues(s,u){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S]&&y[S].set(this.program,S,u[S])}}setGlobeUniformValues(s,u){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S]&&y[S].set(this.program,S,u[S])}}setFogUniformValues(s,u){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}}setCutoffUniformValues(s,u){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}}setLightsUniformValues(s,u){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}}setShadowUniformValues(s,u){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;s.program.set(this.program);for(const S in u)y[S].set(this.program,S,u[S])}_drawDebugWireframe(s,u,y,S,P,O,D,q,W,Z){const te=s.options.wireframe;if(te.terrain===!1&&te.layers2D===!1&&te.layers3D===!1)return;const re=s.context;if(!(!(!te.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!te.layers2D||s._terrain&&s._terrain.renderingToTexture||!Bm.includes(this.name))||!(!te.layers3D||!_y.includes(this.name))))return;const ae=re.gl,ye=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,P,re);if(!ye)return;const fe=[...this.fixedDefines];fe.push("DEBUG_WIREFRAME");const xe=s.getOrCreateProgram(this.name,{config:this.configuration,defines:fe});re.program.set(xe.program);const _e=(De,Ze,Ue)=>{if(Ze[De]&&Ue[De])for(const qe in Ze[De])Ue[De][qe]&&Ue[De][qe].set(Ue.program,qe,Ze[De][qe].current)};W&&W.setUniforms(xe.program,re,xe.binderUniforms,D,{zoom:q}),_e("fixedUniforms",this,xe),_e("terrainUniforms",this,xe),_e("globeUniforms",this,xe),_e("fogUniforms",this,xe),_e("lightsUniforms",this,xe),_e("shadowUniforms",this,xe),ye.bind(),re.setColorMode(new xn([ae.ONE,ae.ONE_MINUS_SRC_ALPHA,ae.ZERO,ae.ONE],i.aj.transparent,[!0,!0,!0,!1])),re.setDepthMode(new Lr(u.func===ae.LESS?ae.LEQUAL:u.func,Lr.ReadOnly,u.range)),re.setStencilMode(Gr.disabled);const Ee=3*O.primitiveLength*2,Fe=3*O.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const De=Z||1;for(let Ze=0;Ze<De;++Ze)xe.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ze),ae.drawElements(ae.LINES,Ee,ae.UNSIGNED_SHORT,Fe)}else Z&&Z>1?ae.drawElementsInstanced(ae.LINES,Ee,ae.UNSIGNED_SHORT,Fe,Z):ae.drawElements(ae.LINES,Ee,ae.UNSIGNED_SHORT,Fe);P.bind(),re.program.set(this.program),re.setDepthMode(u),re.setStencilMode(y),re.setColorMode(S)}checkUniforms(s,u,y){if(this.fixedDefines.includes(u)){for(const S of Object.keys(y))if(!y[S].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${S} not set but required by ${u} being defined`)}}draw(s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe){const _e=s.context,Ee=_e.gl;if(this.failedToCreate)return;_e.program.set(this.program),_e.setDepthMode(y),_e.setStencilMode(S),_e.setColorMode(P),_e.setCullFace(O);for(const Ze of Object.keys(this.fixedUniforms))this.fixedUniforms[Ze].set(this.program,Ze,D[Ze]);ye&&ye.setUniforms(this.program,_e,this.binderUniforms,re,{zoom:ae});const Fe={[Ee.POINTS]:1,[Ee.LINES]:2,[Ee.TRIANGLES]:3,[Ee.LINE_STRIP]:1}[u];this.checkUniforms(q,"RENDER_SHADOWS",this.shadowUniforms);const De=xe&&xe>0?1:void 0;for(const Ze of te.get()){const Ue=Ze.vaos||(Ze.vaos={});if((Ue[q]||(Ue[q]=new km)).bind(_e,this,W,ye?ye.getPaintVertexBuffers():[],Z,Ze.vertexOffset,fe||[],De),this.forceManualRenderingForInstanceIDShaders){const qe=xe||1;for(let Ve=0;Ve<qe;++Ve)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ve),Z?Ee.drawElements(u,Ze.primitiveLength*Fe,Ee.UNSIGNED_SHORT,Ze.primitiveOffset*Fe*2):Ee.drawArrays(u,Ze.vertexOffset,Ze.vertexLength)}else xe&&xe>1?Ee.drawElementsInstanced(u,Ze.primitiveLength*Fe,Ee.UNSIGNED_SHORT,Ze.primitiveOffset*Fe*2,xe):Z?Ee.drawElements(u,Ze.primitiveLength*Fe,Ee.UNSIGNED_SHORT,Ze.primitiveOffset*Fe*2):Ee.drawArrays(u,Ze.vertexOffset,Ze.vertexLength);u===Ee.TRIANGLES&&Z&&this._drawDebugWireframe(s,y,S,P,Z,Ze,re,ae,ye,xe)}}}function Gd(g,s){const u=Math.pow(2,s.tileID.overscaledZ),y=s.tileSize*Math.pow(2,g.transform.tileZoom)/u,S=y*(s.tileID.canonical.x+s.tileID.wrap*u),P=y*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(s,1,g.transform.tileZoom),u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P]}}const Kd={terrain:0,flat:1},Us=i.ab.mat4.create(),Wd=(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e)=>{const Ee=s.style.light,Fe=Ee.properties.get("position"),De=[Fe.x,Fe.y,Fe.z],Ze=i.ab.mat3.create();Ee.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Ze,-s.transform.angle),i.ab.vec3.transformMat3(De,De,Ze));const Ue=Ee.properties.get("color"),qe=s.transform,Ve={u_matrix:g,u_lightpos:De,u_lightintensity:Ee.properties.get("intensity"),u_lightcolor:[Ue.r,Ue.g,Ue.b],u_vertical_gradient:+u,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Us,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Kd[W],u_base_type:Kd[Z],u_ao:S,u_edge_radius:P,u_width_scale:O,u_flood_light_color:ye,u_vertical_scale:fe,u_flood_light_intensity:xe,u_ground_shadow_factor:_e};return qe.projection.name==="globe"&&(Ve.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],Ve.u_zoom_transition=te,Ve.u_inv_rot_matrix=ae,Ve.u_merc_center=re,Ve.u_up_dir=qe.projection.upVector(new i.bT(0,0,0),re[0]*i.ag,re[1]*i.ag),Ve.u_height_lift=q),Ve},Hd=(g,s,u,y,S,P)=>({u_matrix:g,u_edge_radius:s,u_width_scale:u,u_vertical_scale:y,u_height_type:Kd[S],u_base_type:Kd[P]}),by=(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe)=>{const _e=Wd(g,s,u,y,S,P,O,D,W,Z,te,re,ae,ye,fe,xe,1,[0,0,0]),Ee={u_height_factor:-Math.pow(2,D.overscaledZ)/q.tileSize/8};return i.l(_e,Gd(s,q),Ee)},Sp=(g,s)=>({u_matrix:g,u_emissive_strength:s}),Ml=(g,s,u,y)=>i.l(Sp(g,s),Gd(u,y)),Zu=(g,s,u)=>({u_matrix:g,u_world:u,u_emissive_strength:s}),Zd=(g,s,u,y,S)=>i.l(Ml(g,s,u,y),{u_world:S}),Vm=(g,s,u,y)=>{const S=i.ag/u.tileSize;return{u_matrix:g,u_camera_to_center_distance:s.getCameraToCenterDistance(y),u_extrude_scale:[s.pixelsToGLUnits[0]/S,s.pixelsToGLUnits[1]/S]}},bc=(g,s,u=1)=>({u_matrix:g,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:u}),bs=i.ab.mat4.create(),hr=(g,s,u,y,S,P,O)=>{const D=g.transform,q=D.projection.name==="globe",W=q?i.cN(D.zoom,s.canonical)*D._pixelsPerMercatorPixel:i.ar(u,1,P),Z={u_matrix:s.projMatrix,u_extrude_scale:W,u_intensity:O,u_inv_rot_matrix:bs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(q){Z.u_inv_rot_matrix=y,Z.u_merc_center=S,Z.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],Z.u_zoom_transition=i.ae(D.zoom);const te=S[0]*i.ag,re=S[1]*i.ag;Z.u_up_dir=D.projection.upVector(new i.bT(0,0,0),te,re)}return Z};function ru(g,[s,u,y,S],[P,O]){if(P===O)return[0,0,0,0];const D=255*(g-1)/(g*(O-P));return[s*D,u*D,y*D,S*D]}function Hl(g,s,[u,y]){return u===y?0:.5/g+(s-u)*(g-1)/(g*(y-u))}const os=(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e,Ee,Fe,De)=>({u_matrix:g,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:P,u_scale_parent:W,u_fade_t:Z.mix,u_opacity:Z.opacity*te.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:te.paint.get("raster-brightness-min"),u_brightness_high:te.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(te.paint.get("raster-saturation")),u_contrast_factor:i.cP(te.paint.get("raster-contrast")),u_spin_weights:cl(te.paint.get("raster-hue-rotate")),u_perspective_transform:re,u_raster_elevation:ae,u_zoom_transition:O,u_merc_center:D,u_cutoff_params:q,u_colorization_mix:ru(i.cQ,fe,_e),u_colorization_offset:Hl(i.cQ,xe,_e),u_color_ramp:ye,u_texture_offset:[Fe/(Ee+2*Fe),Ee/(Ee+2*Fe)],u_texture_res:[Ee+2*Fe,Ee+2*Fe],u_emissive_strength:De});function cl(g){g*=Math.PI/180;const s=Math.sin(g),u=Math.cos(g);return[(2*u+1)/3,(-Math.sqrt(3)*s-u+1)/3,(Math.sqrt(3)*s-u+1)/3]}const Cr=.05,Ap=(g,s,u,y,S,P,O,D,q,W,Z,te)=>({u_matrix:g,u_normalize_matrix:s,u_globe_matrix:u,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:P,u_scale_parent:W,u_fade_t:Z.mix,u_opacity:Z.opacity,u_image0:0,u_image1:1,u_raster_elevation:te,u_zoom_transition:O,u_merc_center:D,u_cutoff_params:q}),wy=(g,s,u,y,S,P,O,D,q,W)=>({u_particle_texture:g,u_particle_texture_side_len:s,u_tile_offset:u,u_velocity:y,u_color_ramp:P,u_velocity_res:S,u_max_speed:O,u_uv_offset:D,u_data_scale:[255*q[0],255*q[1]],u_data_offset:W,u_particle_pos_scale:1.1,u_particle_pos_offset:[Cr,Cr]}),ul=(g,s,u,y,S,P,O,D,q,W)=>({u_particle_texture:g,u_particle_texture_side_len:s,u_velocity:u,u_velocity_res:y,u_max_speed:S,u_speed_factor:P,u_reset_rate:O,u_rand_seed:Math.random(),u_uv_offset:D,u_data_scale:[255*q[0],255*q[1]],u_data_offset:W,u_particle_pos_scale:1.1,u_particle_pos_offset:[Cr,Cr]}),ss=i.ab.mat4.create(),ya=(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e,Ee,Fe,De,Ze)=>{const Ue=S.transform,qe={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ue.getCameraToCenterDistance(Ee),u_rotate_symbol:+u,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:O,u_coord_matrix:D,u_is_text:+W,u_elevation_from_sea:q?1:0,u_pitch_with_map:+y,u_texsize:Z,u_texsize_icon:te,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ss,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ss,u_up_vector:[0,-1,0],u_color_adj_mat:Fe,u_icon_transition:De||0,u_gamma_scale:y?S.transform.getCameraToCenterDistance(Ee)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Ze||1};return Ee.name==="globe"&&(qe.u_tile_id=[ae.canonical.x,ae.canonical.y,1<<ae.canonical.z],qe.u_zoom_transition=ye,qe.u_inv_rot_matrix=xe,qe.u_merc_center=fe,qe.u_camera_forward=Ue._camera.forward(),qe.u_ecef_origin=i.cR(Ue.globeMatrix,ae.toUnwrapped()),qe.u_tile_matrix=Float32Array.from(Ue.globeMatrix),qe.u_up_vector=_e),qe},dl=(g,s,u,y)=>({u_matrix:g,u_emissive_strength:s,u_opacity:u,u_color:y}),Sy=(g,s,u,y,S,P,O,D,q)=>i.l(function(W,Z,te,re,ae,ye){const{width:fe,height:xe}=re.imageManager.getPixelSize(Z),_e=Math.pow(2,ye.tileID.overscaledZ),Ee=ye.tileSize*Math.pow(2,re.transform.tileZoom)/_e,Fe=Ee*(ye.tileID.canonical.x+ye.tileID.wrap*_e),De=Ee*ye.tileID.canonical.y;return{u_image:0,u_pattern_tl:te.tl,u_pattern_br:te.br,u_texsize:[fe,xe],u_pattern_size:te.displaySize,u_pattern_units_to_pixels:ae?[re.transform.width,-1*re.transform.height]:[1/i.ar(ye,1,re.transform.tileZoom),1/i.ar(ye,1,re.transform.tileZoom)],u_pixel_coord_upper:[Fe>>16,De>>16],u_pixel_coord_lower:[65535&Fe,65535&De]}}(0,P,O,y,D,q),{u_matrix:g,u_emissive_strength:s,u_opacity:u}),Um=new Float32Array(i.ab.mat4.identity([])),Yd=(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae=[0,0,0],ye)=>{const fe=S.style.light,xe=fe.properties.get("position"),_e=[-xe.x,-xe.y,xe.z],Ee=i.ab.mat3.create();fe.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Ee,-S.transform.angle),i.ab.vec3.transformMat3(_e,_e,Ee));const Fe=Z.alphaMode==="MASK",De=fe.properties.get("color").toRenderColor(null),Ze=re.paint.get("model-ambient-occlusion-intensity"),Ue=re.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),qe=re.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:g,u_lighting_matrix:s,u_normal_matrix:u,u_node_matrix:y||Um,u_lightpos:_e,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_camera_pos:ae,u_opacity:P,u_baseTextureIsAlpha:0,u_alphaMask:+Fe,u_alphaCutoff:Z.alphaCutoff,u_baseColorFactor:[O.r,O.g,O.b,O.a],u_emissiveFactor:[D[0],D[1],D[2],1],u_metallicFactor:q,u_roughnessFactor:W,u_baseColorTexture:Io.BaseColor,u_metallicRoughnessTexture:Io.MetallicRoughness,u_normalTexture:Io.Normal,u_occlusionTexture:Io.Occlusion,u_emissionTexture:Io.Emission,u_lutTexture:Io.LUT,u_color_mix:[Ue.r,Ue.g,Ue.b,qe],u_aoIntensity:Ze,u_emissive_strength:te,u_occlusionTextureTransform:ye||[0,0,0,0]}},uf=(g,s=Um,u=Um)=>({u_matrix:g,u_instance:s,u_node_matrix:u}),$m={fillExtrusion:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_opacity:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_flood_light_color:new i.bL(g),u_vertical_scale:new i.bM(g),u_flood_light_intensity:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),fillExtrusionDepth:g=>({u_matrix:new i.bJ(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_vertical_scale:new i.bM(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g)}),fillExtrusionPattern:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_height_factor:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g),u_opacity:new i.bM(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new i.bJ(g),u_opacity:new i.bM(g),u_ao_pass:new i.bM(g),u_meter_to_tile:new i.bM(g),u_ao:new i.bK(g),u_flood_light_intensity:new i.bM(g),u_flood_light_color:new i.bL(g),u_attenuation:new i.bM(g),u_edge_radius:new i.bM(g),u_fb:new i.bN(g),u_fb_size:new i.bM(g),u_dynamic_offset:new i.bM(g)}),fill:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g)}),fillPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),fillOutline:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g)}),fillOutlinePattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),circle:i.cS,collisionBox:g=>({u_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_extrude_scale:new i.bK(g)}),collisionCircle:g=>({u_matrix:new i.bJ(g),u_inv_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_viewport_size:new i.bK(g)}),debug:g=>({u_color:new i.cz(g),u_matrix:new i.bJ(g),u_overlay:new i.bN(g),u_overlay_scale:new i.bM(g)}),clippingMask:g=>({u_matrix:new i.bJ(g)}),heatmap:g=>({u_extrude_scale:new i.bM(g),u_intensity:new i.bM(g),u_matrix:new i.bJ(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_up_dir:new i.bL(g)}),heatmapTexture:g=>({u_image:new i.bN(g),u_color_ramp:new i.bN(g),u_opacity:new i.bM(g)}),hillshade:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_latrange:new i.bK(g),u_light:new i.bK(g),u_shadow:new i.cz(g),u_highlight:new i.cz(g),u_emissive_strength:new i.bM(g),u_accent:new i.cz(g)}),hillshadePrepare:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_dimension:new i.bK(g),u_zoom:new i.bM(g)}),line:i.cT,linePattern:i.cU,raster:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_brightness_low:new i.bM(g),u_brightness_high:new i.bM(g),u_saturation_factor:new i.bM(g),u_contrast_factor:new i.bM(g),u_spin_weights:new i.bL(g),u_perspective_transform:new i.bK(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g),u_colorization_mix:new i.ca(g),u_colorization_offset:new i.bM(g),u_color_ramp:new i.bN(g),u_texture_offset:new i.bK(g),u_texture_res:new i.bK(g),u_emissive_strength:new i.bM(g)}),rasterParticle:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g)}),rasterParticleTexture:g=>({u_texture:new i.bN(g),u_opacity:new i.bM(g)}),rasterParticleDraw:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_tile_offset:new i.bK(g),u_velocity:new i.bN(g),u_color_ramp:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),rasterParticleUpdate:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_velocity:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_speed_factor:new i.bM(g),u_reset_rate:new i.bM(g),u_rand_seed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),symbol:g=>({u_is_size_zoom_constant:new i.bN(g),u_is_size_feature_constant:new i.bN(g),u_size_t:new i.bM(g),u_size:new i.bM(g),u_camera_to_center_distance:new i.bM(g),u_rotate_symbol:new i.bN(g),u_aspect_ratio:new i.bM(g),u_fade_change:new i.bM(g),u_matrix:new i.bJ(g),u_label_plane_matrix:new i.bJ(g),u_coord_matrix:new i.bJ(g),u_is_text:new i.bN(g),u_elevation_from_sea:new i.bN(g),u_pitch_with_map:new i.bN(g),u_texsize:new i.bK(g),u_texsize_icon:new i.bK(g),u_texture:new i.bN(g),u_texture_icon:new i.bN(g),u_gamma_scale:new i.bM(g),u_device_pixel_ratio:new i.bM(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_camera_forward:new i.bL(g),u_tile_matrix:new i.bJ(g),u_up_vector:new i.bL(g),u_ecef_origin:new i.bL(g),u_is_halo:new i.bN(g),u_icon_transition:new i.bM(g),u_color_adj_mat:new i.bJ(g),u_scale_factor:new i.bM(g)}),background:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_color:new i.cz(g)}),backgroundPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_image:new i.bN(g),u_pattern_tl:new i.bK(g),u_pattern_br:new i.bK(g),u_texsize:new i.bK(g),u_pattern_size:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_pattern_units_to_pixels:new i.bK(g)}),terrainRaster:g=>({u_matrix:new i.bJ(g),u_image0:new i.bN(g),u_skirt_height:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),skybox:g=>({u_matrix:new i.bJ(g),u_sun_direction:new i.bL(g),u_cubemap:new i.bN(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxGradient:g=>({u_matrix:new i.bJ(g),u_color_ramp:new i.bN(g),u_center_direction:new i.bL(g),u_radius:new i.bM(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxCapture:g=>({u_matrix_3f:new i.cA(g),u_sun_direction:new i.bL(g),u_sun_intensity:new i.bM(g),u_color_tint_r:new i.ca(g),u_color_tint_m:new i.ca(g),u_luminance:new i.bM(g)}),globeRaster:g=>({u_proj_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_image0:new i.bN(g),u_grid_matrix:new i.cA(g),u_skirt_height:new i.bM(g),u_far_z_cutoff:new i.bM(g),u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_globe_pos:new i.bL(g),u_globe_radius:new i.bM(g),u_viewport:new i.bK(g)}),globeAtmosphere:g=>({u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_horizon:new i.bM(g),u_transition:new i.bM(g),u_fadeout_range:new i.bM(g),u_color:new i.ca(g),u_high_color:new i.ca(g),u_space_color:new i.ca(g),u_temporal_offset:new i.bM(g),u_horizon_angle:new i.bM(g)}),model:g=>({u_matrix:new i.bJ(g),u_lighting_matrix:new i.bJ(g),u_normal_matrix:new i.bJ(g),u_node_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_camera_pos:new i.bL(g),u_opacity:new i.bM(g),u_baseColorFactor:new i.ca(g),u_emissiveFactor:new i.ca(g),u_metallicFactor:new i.bM(g),u_roughnessFactor:new i.bM(g),u_baseTextureIsAlpha:new i.bN(g),u_alphaMask:new i.bN(g),u_alphaCutoff:new i.bM(g),u_baseColorTexture:new i.bN(g),u_metallicRoughnessTexture:new i.bN(g),u_normalTexture:new i.bN(g),u_occlusionTexture:new i.bN(g),u_emissionTexture:new i.bN(g),u_lutTexture:new i.bN(g),u_color_mix:new i.ca(g),u_aoIntensity:new i.bM(g),u_emissive_strength:new i.bM(g),u_occlusionTextureTransform:new i.ca(g)}),modelDepth:g=>({u_matrix:new i.bJ(g),u_instance:new i.bJ(g),u_node_matrix:new i.bJ(g)}),groundShadow:g=>({u_matrix:new i.bJ(g),u_ground_shadow_factor:new i.bL(g)}),stars:g=>({u_matrix:new i.bJ(g),u_up:new i.bL(g),u_right:new i.bL(g),u_intensity_multiplier:new i.bM(g)}),snowParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_horizontalOscillationRadius:new i.bM(g),u_horizontalOscillationRate:new i.bM(g),u_boxSize:new i.bM(g),u_billboardSize:new i.bM(g),u_simpleShapeParameters:new i.bK(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_particleColor:new i.ca(g),u_direction:new i.bL(g)}),rainParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_texScreen:new i.bN(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_boxSize:new i.bM(g),u_rainDropletSize:new i.bK(g),u_distortionStrength:new i.bM(g),u_rainDirection:new i.bL(g),u_color:new i.ca(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_shapeDirectionalPower:new i.bM(g),u_shapeNormalPower:new i.bM(g),u_mode:new i.bM(g)}),vignette:g=>({u_vignetteShape:new i.bL(g),u_vignetteColor:new i.ca(g)}),occlusion:g=>({u_matrix:new i.bJ(g),u_anchorPos:new i.bL(g),u_screenSizePx:new i.bK(g),u_occluderSizePx:new i.bK(g),u_color:new i.ca(g)})};class hl{constructor(s,u,y,S){this.id=hl.uniqueIdxCounter,hl.uniqueIdxCounter++,this.context=s;const P=s.gl;this.buffer=P.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),s.bindElementBuffer.set(this.buffer),P.bufferData(P.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||S||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(s){this.id=hl.uniqueIdxCounter,hl.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,s.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}hl.uniqueIdxCounter=0;const ws={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fl{constructor(s,u,y,S,P,O){this.length=u.length,this.attributes=y,this.itemSize=u.bytesPerElement,this.dynamicDraw=S,this.instanceCount=O,this.context=s;const D=s.gl;this.buffer=D.createBuffer(),s.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||P||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,u){for(let y=0;y<this.attributes.length;y++){const S=u.attributes[this.attributes[y].name];S!==void 0&&s.enableVertexAttribArray(S)}}setVertexAttribPointers(s,u,y){for(let S=0;S<this.attributes.length;S++){const P=this.attributes[S],O=u.attributes[P.name];O!==void 0&&s.vertexAttribPointer(O,P.components,s[ws[P.type]],!1,this.itemSize,P.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(s,u,y){for(let S=0;S<this.attributes.length;S++){const P=u.attributes[this.attributes[S].name];P!==void 0&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(P,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Tp{constructor(s,u,y,S,P){this.context=s,this.width=u,this.height=y;const O=this.framebuffer=s.gl.createFramebuffer();S&&(this.colorAttachment=new Wu(s,O)),P&&(this.depthAttachmentType=P,this.depthAttachment=P==="renderbuffer"?new vy(s,O):new d_(s,O))}destroy(){const s=this.context.gl;if(this.colorAttachment){const u=this.colorAttachment.get();u&&s.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&s.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&s.deleteTexture(u)}s.deleteFramebuffer(this.framebuffer)}}class Ay{constructor(s,u){this.gl=s,this.clearColor=new jm(this),this.clearDepth=new Nm(this),this.clearStencil=new ca(this),this.colorMask=new vp(this),this.depthMask=new _p(this),this.stencilMask=new af(this),this.stencilFunc=new l_(this),this.stencilOp=new Bd(this),this.stencilTest=new Qc(this),this.depthRange=new xp(this),this.depthTest=new Po(this),this.depthFunc=new Im(this),this.blend=new Dm(this),this.blendFunc=new Lm(this),this.blendColor=new zm(this),this.blendEquation=new of(this),this.cullFace=new Vd(this),this.cullFaceSide=new bp(this),this.frontFace=new wp(this),this.program=new sf(this),this.activeTexture=new Fm(this),this.viewport=new c_(this),this.bindFramebuffer=new Ud(this),this.bindRenderbuffer=new G0(this),this.bindTexture=new K0(this),this.bindVertexBuffer=new yy(this),this.bindElementBuffer=new Ku(this),this.bindVertexArrayOES=new u_(this),this.pixelStoreUnpack=new lf(this),this.pixelStoreUnpackPremultiplyAlpha=new Tl(this),this.pixelStoreUnpackFlipY=new $d(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,u,y){return new hl(this,s,u,y)}createVertexBuffer(s,u,y,S,P){return new fl(this,s,u,y,S,P)}createRenderbuffer(s,u,y){const S=this.gl,P=S.createRenderbuffer();return this.bindRenderbuffer.set(P),S.renderbufferStorage(S.RENDERBUFFER,s,u,y),this.bindRenderbuffer.set(null),P}createFramebuffer(s,u,y,S){return new Tp(this,s,u,y,S)}clear({color:s,depth:u,stencil:y,colorMask:S}){const P=this.gl;let O=0;s&&(O|=P.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(S||[!0,!0,!0,!0])),u!==void 0&&(O|=P.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),y!==void 0&&(O|=P.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),P.clear(O)}setCullFace(s){s.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){i.bn(s.blendFunction,xn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let wc;function Xd(g,s,u,y,S,P,O){const D=g.context,q=D.gl,W=g.transform,Z=g.getOrCreateProgram("collisionBox"),te=[];let re=0,ae=0;for(let De=0;De<y.length;De++){const Ze=y[De],Ue=s.getTile(Ze),qe=Ue.getBucket(u);if(!qe)continue;const Ve=Gl(Ze,qe,W);let Ke=Ve;S[0]===0&&S[1]===0||(Ke=g.translatePosMatrix(Ve,Ue,S,P));const it=O?qe.textCollisionBox:qe.iconCollisionBox,_t=qe.collisionCircleArray;if(_t.length>0){const pt=i.ab.mat4.create(),Ct=Ke;i.ab.mat4.mul(pt,qe.placementInvProjMatrix,W.glCoordMatrix),i.ab.mat4.mul(pt,pt,qe.placementViewportMatrix),te.push({circleArray:_t,circleOffset:ae,transform:Ct,invTransform:pt,projection:qe.getProjection()}),re+=_t.length/4,ae=re}it&&(g.terrain&&g.terrain.setupElevationDraw(Ue,Z),Z.draw(g,q.LINES,Lr.disabled,Gr.disabled,g.colorModeForRenderPass(),Hr.disabled,Vm(Ke,W,Ue,qe.getProjection()),u.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,null,W.zoom,null,[it.collisionVertexBuffer,it.collisionVertexBufferExt]))}if(!O||!te.length)return;const ye=g.getOrCreateProgram("collisionCircle"),fe=new i.cV;fe.resize(4*re),fe._trim();let xe=0;for(const De of te)for(let Ze=0;Ze<De.circleArray.length/4;Ze++){const Ue=4*Ze,qe=De.circleArray[Ue+0],Ve=De.circleArray[Ue+1],Ke=De.circleArray[Ue+2],it=De.circleArray[Ue+3];fe.emplace(xe++,qe,Ve,Ke,it,0),fe.emplace(xe++,qe,Ve,Ke,it,1),fe.emplace(xe++,qe,Ve,Ke,it,2),fe.emplace(xe++,qe,Ve,Ke,it,3)}(!wc||wc.length<2*re)&&(wc=function(De){const Ze=2*De,Ue=new i.aU;Ue.resize(Ze),Ue._trim();for(let qe=0;qe<Ze;qe++){const Ve=6*qe;Ue.uint16[Ve+0]=4*qe+0,Ue.uint16[Ve+1]=4*qe+1,Ue.uint16[Ve+2]=4*qe+2,Ue.uint16[Ve+3]=4*qe+2,Ue.uint16[Ve+4]=4*qe+3,Ue.uint16[Ve+5]=4*qe+0}return Ue}(re));const _e=D.createIndexBuffer(wc,!0),Ee=D.createVertexBuffer(fe,i.cW.members,!0);for(const De of te){const Ze={u_matrix:De.transform,u_inv_matrix:De.invTransform,u_camera_to_center_distance:(Fe=W).getCameraToCenterDistance(De.projection),u_viewport_size:[Fe.width,Fe.height]};ye.draw(g,q.TRIANGLES,Lr.disabled,Gr.disabled,g.colorModeForRenderPass(),Hr.disabled,Ze,u.id,Ee,_e,i.b7.simpleSegment(0,2*De.circleOffset,De.circleArray.length,De.circleArray.length/2),null,W.zoom)}var Fe;Ee.destroy(),_e.destroy()}const df=i.ab.mat4.create();function $s(g){const s=g._camera.getWorldToCamera(g.worldSize,1),u=i.ab.mat4.multiply([],s,g.globeMatrix);i.ab.mat4.invert(u,u);const y=[0,0,0],S=[0,1,0,0];return i.ab.vec4.transformMat4(S,S,u),y[0]=S[0],y[1]=S[1],y[2]=S[2],i.ab.vec3.normalize(y,y),y}function vi({width:g,height:s,anchor:u,textOffset:y,textScale:S},P){const{horizontalAlign:O,verticalAlign:D}=i.bD(u),q=-(O-.5)*g,W=-(D-.5)*s,Z=i.bC(u,y);return new i.P((q/S+Z[0])*P,(W/S+Z[1])*P)}function Pp(g,s,u,y,S,P,O,D,q,W,Z){const te=g.text.placedSymbolArray,re=g.text.dynamicLayoutVertexArray,ae=g.icon.dynamicLayoutVertexArray,ye={},fe=g.getProjection(),xe=Hc(D,fe,P),_e=P.elevation,Ee=fe.upVectorScale(D.canonical,P.center.lat,P.worldSize).metersToTile;re.clear();for(let Fe=0;Fe<te.length;Fe++){const De=te.get(Fe),{tileAnchorX:Ze,tileAnchorY:Ue,numGlyphs:qe}=De,Ve=De.hidden||!De.crossTileID||g.allowVerticalPlacement&&!De.placedOrientation?null:y[De.crossTileID];if(Ve){let Ke=0,it=0,_t=0;if(_e){const Pt=_e?_e.getAtTileOffset(D,Ze,Ue):0,[Zt,zt,Nt]=fe.upVector(D.canonical,Ze,Ue);Ke=Pt*Zt*Ee,it=Pt*zt*Ee,_t=Pt*Nt*Ee}let[pt,Ct,Mt,ut]=qo(De.projectedAnchorX+Ke,De.projectedAnchorY+it,De.projectedAnchorZ+_t,u?xe:O);const Tt=Rd(P.getCameraToCenterDistance(fe),ut);let Bt=S.evaluateSizeForFeature(g.textSizeData,W,De)*Tt/i.bw;u&&(Bt*=g.tilePixelRatio/q);const ft=vi(Ve,Bt);u?({x:pt,y:Ct,z:Mt}=fe.projectTilePoint(Ze+ft.x,Ue+ft.y,D.canonical),[pt,Ct,Mt]=qo(pt+Ke,Ct+it,Mt+_t,O)):(s&&ft._rotate(-P.angle),pt+=ft.x,Ct+=ft.y,Mt=0);const Dt=g.allowVerticalPlacement&&De.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let Pt=0;Pt<qe;Pt++)i.bt(re,pt,Ct,Mt,Dt);Z&&De.associatedIconIndex>=0&&(ye[De.associatedIconIndex]={x:pt,y:Ct,z:Mt,angle:Dt})}else na(qe,re)}if(Z){ae.clear();const Fe=g.icon.placedSymbolArray;for(let De=0;De<Fe.length;De++){const Ze=Fe.get(De),{numGlyphs:Ue}=Ze,qe=ye[De];if(Ze.hidden||!qe)na(Ue,ae);else{const{x:Ve,y:Ke,z:it,angle:_t}=qe;for(let pt=0;pt<Ue;pt++)i.bt(ae,Ve,Ke,it,_t)}}g.icon.dynamicLayoutVertexBuffer.updateData(ae)}g.text.dynamicLayoutVertexBuffer.updateData(re)}function Yu(g,s,u,y,S,P,O={}){const D=u.paint.get("icon-translate"),q=u.paint.get("text-translate"),W=u.paint.get("icon-translate-anchor"),Z=u.paint.get("text-translate-anchor"),te=u.layout.get("icon-rotation-alignment"),re=u.layout.get("text-rotation-alignment"),ae=u.layout.get("icon-pitch-alignment"),ye=u.layout.get("text-pitch-alignment"),fe=u.layout.get("icon-keep-upright"),xe=u.layout.get("text-keep-upright"),_e=u.paint.get("icon-color-saturation"),Ee=u.paint.get("icon-color-contrast"),Fe=u.paint.get("icon-color-brightness-min"),De=u.paint.get("icon-color-brightness-max"),Ze=u.layout.get("symbol-elevation-reference")==="sea",Ue=g.context,qe=Ue.gl,Ve=g.transform,Ke=te==="map",it=re==="map",_t=ae==="map",pt=ye==="map",Ct=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Mt=!1;const ut=g.depthModeForSublayer(0,Lr.ReadOnly),Tt=[i.at(Ve.center.lng),i.aA(Ve.center.lat)],Bt=u.layout.get("text-variable-anchor"),ft=Ve.projection.name==="globe",Dt=[],Pt=[0,-1,0];for(const Zt of y){const zt=s.getTile(Zt),Nt=zt.getBucket(u);if(!Nt||Nt.projection.name==="mercator"&&ft||Nt.fullyClipped)continue;const qt=Nt.projection.name==="globe",er=qt?i.ae(Ve.zoom):0,fr=Hc(Zt,Nt.getProjection(),Ve),mr=Ve.calculatePixelsToTileUnitsMatrix(zt),$r=Bt&&Nt.hasTextData(),Or=Nt.hasIconTextFit()&&$r&&Nt.hasIconData(),jr=Nt.getProjection().createInversionMatrix(Ve,Zt.canonical),Wr=ei=>{Ve.depthOcclusionForSymbolsAndCircles&&(u.hasInitialOcclusionOpacityProperties||g.terrain)&&(ei.push("DEPTH_D24"),ei.push("DEPTH_OCCLUSION"))},Mn=()=>{const ei=Ke&&u.layout.get("symbol-placement")!=="point",oi=[];Wr(oi);const Qi=ei||Or,aa=u.paint.get("icon-image-cross-fade").constantOr(0);g.terrainRenderModeElevated()&&_t&&oi.push("PITCH_WITH_MAP_TERRAIN"),qt&&(oi.push("PROJECTION_GLOBE_VIEW"),Qi&&oi.push("PROJECTED_POS_ON_VIEWPORT")),aa>0&&oi.push("ICON_TRANSITION"),Nt.icon.zOffsetVertexBuffer&&oi.push("Z_OFFSET"),_e===0&&Ee===0&&Fe===0&&De===1||oi.push("COLOR_ADJUSTMENT"),Nt.sdfIcons&&oi.push("RENDER_SDF");const ja=Nt.icon.programConfigurations.get(u.id),Aa=g.getOrCreateProgram("symbol",{config:ja,defines:oi}),Co=zt.imageAtlasTexture?zt.imageAtlasTexture.size:[0,0],Mo=Nt.iconSizeData,ki=i.bp(Mo,Ve.zoom),Pi=_t||Ve.pitch!==0,_i=Ka(fr,zt.tileID.canonical,_t,Ke,Ve,Nt.getProjection(),mr),Rn=sy(fr,zt.tileID.canonical,_t,Ke,Ve,Nt.getProjection(),mr),oa=g.translatePosMatrix(Rn,zt,D,W,!0),io=g.translatePosMatrix(fr,zt,D,W),Ei=Qi?df:_i,Lo=Ke&&!_t&&!ei;let ml=Pt;!ft&&!Ve.mercatorFromTransition||Ke||(ml=$s(Ve));const yo=qt?ml:Pt,Ps=u.getColorAdjustmentMatrix(_e,Ee,Fe,De),Es=ya(Mo.kind,ki,Lo,_t,g,io,Ei,oa,Ze,!1,Co,[0,0],!0,Zt,er,Tt,jr,yo,Nt.getProjection(),Ps,aa),gl=zt.imageAtlasTexture?zt.imageAtlasTexture:null,Ii=u.layout.get("icon-size").constantOr(0)!==1||Nt.iconsNeedLinear,uh=Nt.sdfIcons||g.options.rotating||g.options.zooming||Ii||Pi?qe.LINEAR:qe.NEAREST,Jl=Nt.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,dh=g.terrain&&_t&&ei?i.ab.mat4.invert(i.ab.mat4.create(),_i):df;if(ei&&Nt.icon){const Pf=Ve.elevation,Bp=Pf?Pf.getAtTileOffsetFunc(Zt,Ve.center.lat,Ve.worldSize,Nt.getProjection()):null,og=pa(fr,zt.tileID.canonical,_t,Ke,Ve,Nt.getProjection(),mr);ap(Nt,fr,g,!1,og,Rn,_t,fe,Bp,Zt)}return{program:Aa,buffers:Nt.icon,uniformValues:Es,atlasTexture:gl,atlasTextureIcon:null,atlasInterpolation:uh,atlasInterpolationIcon:null,isSDF:Nt.sdfIcons,hasHalo:Jl,tile:zt,labelPlaneMatrixInv:dh}},hi=()=>{const ei=it&&u.layout.get("symbol-placement")!=="point",oi=[],Qi=ei||Bt||Or;g.terrainRenderModeElevated()&&pt&&oi.push("PITCH_WITH_MAP_TERRAIN"),qt&&(oi.push("PROJECTION_GLOBE_VIEW"),Qi&&oi.push("PROJECTED_POS_ON_VIEWPORT")),Nt.text.zOffsetVertexBuffer&&oi.push("Z_OFFSET"),Nt.iconsInText&&oi.push("RENDER_TEXT_AND_SYMBOL"),oi.push("RENDER_SDF"),Wr(oi);const aa=Nt.text.programConfigurations.get(u.id),ja=g.getOrCreateProgram("symbol",{config:aa,defines:oi});let Aa,Co=[0,0],Mo=null;const ki=Nt.textSizeData;Nt.iconsInText&&(Co=zt.imageAtlasTexture?zt.imageAtlasTexture.size:[0,0],Mo=zt.imageAtlasTexture?zt.imageAtlasTexture:null,Aa=pt||Ve.pitch!==0||g.options.rotating||g.options.zooming||ki.kind==="composite"||ki.kind==="camera"?qe.LINEAR:qe.NEAREST);const Pi=zt.glyphAtlasTexture?zt.glyphAtlasTexture.size:[0,0],_i=u.layout.get("text-size-scale-range"),Rn=i.aw(g.scaleFactor,_i[0],_i[1]),oa=i.bp(ki,Ve.zoom,Rn),io=Ka(fr,zt.tileID.canonical,pt,it,Ve,Nt.getProjection(),mr),Ei=sy(fr,zt.tileID.canonical,pt,it,Ve,Nt.getProjection(),mr),Lo=g.translatePosMatrix(Ei,zt,q,Z,!0),ml=g.translatePosMatrix(fr,zt,q,Z),yo=Qi?df:io,Ps=it&&!pt&&!ei;let Es=Pt;!ft&&!Ve.mercatorFromTransition||it||(Es=$s(Ve));const gl=ya(ki.kind,oa,Ps,pt,g,ml,yo,Lo,Ze,!0,Pi,Co,!0,Zt,er,Tt,jr,qt?Es:Pt,Nt.getProjection(),null,null,Rn),Ii=zt.glyphAtlasTexture?zt.glyphAtlasTexture:null,uh=qe.LINEAR,Jl=u.paint.get("text-halo-width").constantOr(1)!==0,dh=g.terrain&&pt&&ei?i.ab.mat4.invert(i.ab.mat4.create(),io):df;if(ei&&Nt.text){const Pf=Ve.elevation,Bp=Pf?Pf.getAtTileOffsetFunc(Zt,Ve.center.lat,Ve.worldSize,Nt.getProjection()):null,og=pa(fr,zt.tileID.canonical,pt,it,Ve,Nt.getProjection(),mr);ap(Nt,fr,g,!0,og,Ei,pt,xe,Bp,Zt)}return{program:ja,buffers:Nt.text,uniformValues:gl,atlasTexture:Ii,atlasTextureIcon:Mo,atlasInterpolation:uh,atlasInterpolationIcon:Aa,isSDF:!0,hasHalo:Jl,tile:zt,labelPlaneMatrixInv:dh}},Gi=Nt.icon.segments.get().length,Yn=Nt.text.segments.get().length,Zr=Gi&&!O.onlyText?Mn():null,_n=Yn&&!O.onlyIcons?hi():null,xr=u.paint.get("icon-opacity").constantOr(1),En=u.paint.get("text-opacity").constantOr(1);if(Ct&&Nt.canOverlap){Mt=!0;const ei=xr&&!O.onlyText?Nt.icon.segments.get():[],oi=En&&!O.onlyIcons?Nt.text.segments.get():[];for(const Qi of ei)Dt.push({segments:new i.b7([Qi]),sortKey:Qi.sortKey,state:Zr});for(const Qi of oi)Dt.push({segments:new i.b7([Qi]),sortKey:Qi.sortKey,state:_n})}else O.onlyText||Dt.push({segments:xr?Nt.icon.segments:new i.b7([]),sortKey:0,state:Zr}),O.onlyIcons||Dt.push({segments:En?Nt.text.segments:new i.b7([]),sortKey:0,state:_n})}Mt&&Dt.sort((Zt,zt)=>Zt.sortKey-zt.sortKey);for(const Zt of Dt){const zt=Zt.state;if(zt)if(g.terrain?g.terrain.setupElevationDraw(zt.tile,zt.program,{useDepthForOcclusion:Ve.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:zt.labelPlaneMatrixInv}):g.setupDepthForOcclusion(Ve.depthOcclusionForSymbolsAndCircles,zt.program),Ue.activeTexture.set(qe.TEXTURE0),zt.atlasTexture&&zt.atlasTexture.bind(zt.atlasInterpolation,qe.CLAMP_TO_EDGE,!0),zt.atlasTextureIcon&&(Ue.activeTexture.set(qe.TEXTURE1),zt.atlasTextureIcon&&zt.atlasTextureIcon.bind(zt.atlasInterpolationIcon,qe.CLAMP_TO_EDGE,!0)),g.uploadCommonLightUniforms(g.context,zt.program),zt.hasHalo){const Nt=zt.uniformValues;Nt.u_is_halo=1,Jd(zt.buffers,Zt.segments,u,g,zt.program,ut,S,P,Nt,2),Nt.u_is_halo=0}else{if(zt.isSDF){const Nt=zt.uniformValues;zt.hasHalo&&(Nt.u_is_halo=1,Jd(zt.buffers,Zt.segments,u,g,zt.program,ut,S,P,Nt,1)),Nt.u_is_halo=0}Jd(zt.buffers,Zt.segments,u,g,zt.program,ut,S,P,zt.uniformValues,1)}}}function Jd(g,s,u,y,S,P,O,D,q,W){const Z=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer];S.draw(y,y.context.gl.TRIANGLES,P,O,D,Hr.disabled,q,u.id,g.layoutVertexBuffer,g.indexBuffer,s,u.paint,y.transform.zoom,g.programConfigurations.get(u.id),Z,W)}function Xu(g,s,u,y,S,P,O){const D=g.context.gl,q=u.paint.get("fill-pattern"),W=u.is3D(),Z=W?g.stencilModeFor3D():Gr.disabled,te=q&&q.constantOr(1);let re,ae,ye,fe,xe;O?(ae=te&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",re=D.LINES):(ae=te?"fillPattern":"fill",re=D.TRIANGLES);for(const _e of y){const Ee=s.getTile(_e);if(te&&!Ee.patternsLoaded())continue;const Fe=Ee.getBucket(u);if(!Fe)continue;g.prepareDrawTile();const De=Fe.programConfigurations.get(u.id),Ze=g.isTileAffectedByFog(_e),Ue=g.getOrCreateProgram(ae,{config:De,overrideFog:Ze});te&&(g.context.activeTexture.set(D.TEXTURE0),Ee.imageAtlasTexture&&Ee.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),De.updatePaintBuffers());const qe=q.constantOr(null);if(qe&&Ee.imageAtlas){const it=Ee.imageAtlas,_t=i.A.from(qe).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),pt=it.patternPositions[_t];pt&&De.setConstantPatternPositions(pt)}const Ve=g.translatePosMatrix(_e.projMatrix,Ee,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),Ke=u.paint.get("fill-emissive-strength");if(O){fe=Fe.indexBuffer2,xe=Fe.segments2;const it=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];ye=ae==="fillOutlinePattern"&&te?Zd(Ve,Ke,g,Ee,it):Zu(Ve,Ke,it)}else fe=Fe.indexBuffer,xe=Fe.segments,ye=te?Ml(Ve,Ke,g,Ee):Sp(Ve,Ke);g.uploadCommonUniforms(g.context,Ue,_e.toUnwrapped()),Ue.draw(g,re,S,W?Z:g.stencilModeForClipping(_e),P,Hr.disabled,ye,u.id,Fe.layoutVertexBuffer,fe,xe,u.paint,g.transform.zoom,De,void 0)}}function Qd(g,s,u,y,S,P,O,D){u.resetLayerRenderingStats(g);const q=g.context,W=q.gl,Z=g.transform,te=u.paint.get("fill-extrusion-pattern"),re=te.constantOr(1),ae=u.paint.get("fill-extrusion-opacity"),ye=g.style.enable3dLights(),fe=u.paint.get(ye&&!re?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),xe=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe],_e=u.layout.get("fill-extrusion-edge-radius"),Ee=_e>0&&!u.paint.get("fill-extrusion-rounded-roof"),Fe=Ee?0:_e,De=Z.projection.name==="globe"?i.d3():0,Ze=Z.projection.name==="globe",Ue=Ze?i.ae(Z.zoom):0,qe=[i.at(Z.center.lng),i.aA(Z.center.lat)],Ve=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ke=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ve?null:u.lut).toArray01().slice(0,3),it=u.paint.get("fill-extrusion-flood-light-intensity"),_t=u.paint.get("fill-extrusion-vertical-scale"),pt=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,Ct=u.paint.get("fill-extrusion-height-alignment"),Mt=u.paint.get("fill-extrusion-base-alignment"),ut=Al(g,u.paint.get("fill-extrusion-cutoff-fade-range")),Tt=[];let Bt;Ze&&Tt.push("PROJECTION_GLOBE_VIEW"),xe[0]>0&&Tt.push("FAUX_AO"),Ee&&Tt.push("ZERO_ROOF_RADIUS"),D&&Tt.push("HAS_CENTROID"),it>0&&Tt.push("FLOOD_LIGHT"),ut.shouldRenderCutoff&&Tt.push("RENDER_CUTOFF"),pt&&Tt.push("RENDER_WALL_MODE");const ft=g.renderPass==="shadow",Dt=g.shadowRenderer,Pt=ft&&!!Dt;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Zt=[0,0,0];if(Dt){const qt=g.style.directionalLight,er=g.style.ambientLight;qt&&er&&(Zt=hp(g.style,qt,er)),ft||(Tt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Dt.useNormalOffset&&Tt.push("NORMAL_OFFSET")),Bt=Tt.concat(["SHADOWS_SINGLE_CASCADE"])}const zt=Pt?"fillExtrusionDepth":re?"fillExtrusionPattern":"fillExtrusion",Nt=u.getLayerRenderingStats();for(const qt of y){const er=s.getTile(qt),fr=er.getBucket(u);if(!fr||fr.projection.name!==Z.projection.name)continue;let mr=!1;Dt&&(mr=Dt.getMaxCascadeForTile(qt.toUnwrapped())===0);const $r=g.isTileAffectedByFog(qt),Or=fr.programConfigurations.get(u.id),jr=g.getOrCreateProgram(zt,{config:Or,defines:mr?Bt:Tt,overrideFog:$r});if(g.terrain&&g.terrain.setupElevationDraw(er,jr,{useMeterToDem:!0}),!fr.centroidVertexBuffer){const _n=jr.attributes.a_centroid_pos;_n!==void 0&&W.vertexAttrib2f(_n,0,0)}!ft&&Dt&&Dt.setupShadows(er.tileID.toUnwrapped(),jr,"vector-tile",er.tileID.overscaledZ),re&&(g.context.activeTexture.set(W.TEXTURE0),er.imageAtlasTexture&&er.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Or.updatePaintBuffers());const Wr=te.constantOr(null);if(Wr&&er.imageAtlas){const _n=er.imageAtlas,xr=i.A.from(Wr).getPrimary().scaleSelf(i.q.devicePixelRatio),En=_n.patternPositions[xr.serialize()];En&&Or.setConstantPatternPositions(En)}const Mn=u.paint.get("fill-extrusion-vertical-gradient"),hi=1/fr.tileToMeter;let Gi;if(ft&&Dt){if(Ol(er.tileID,fr,g))continue;const _n=Dt.calculateShadowPassMatrixFromTile(er.tileID.toUnwrapped());Gi=Hd(_n,Fe,hi,_t,Ct,Mt)}else{const _n=g.translatePosMatrix(qt.expandedProjMatrix,er,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),xr=Z.projection.createInversionMatrix(Z,qt.canonical);Gi=re?by(_n,g,Mn,ae,xe,Fe,hi,qt,er,De,Ct,Mt,Ue,qe,xr,Ke,_t):Wd(_n,g,Mn,ae,xe,Fe,hi,qt,De,Ct,Mt,Ue,qe,xr,Ke,_t,it,Zt)}g.uploadCommonUniforms(q,jr,qt.toUnwrapped(),null,ut);let Yn=fr.segments;if(Z.projection.name==="mercator"&&!ft&&(Yn=fr.getVisibleSegments(er.tileID,g.terrain,g.transform.getFrustum(0)),!Yn.get().length))continue;if(Nt)if(ft)for(const _n of Yn.get())Nt.numRenderedVerticesInShadowPass+=_n.primitiveLength;else for(const _n of Yn.get())Nt.numRenderedVerticesInTransparentPass+=_n.primitiveLength;const Zr=[];(g.terrain||D)&&Zr.push(fr.centroidVertexBuffer),Ze&&Zr.push(fr.layoutVertexExtBuffer),pt&&Zr.push(fr.wallVertexBuffer),jr.draw(g,q.gl.TRIANGLES,S,P,O,Hr.backCCW,Gi,u.id,fr.layoutVertexBuffer,fr.indexBuffer,Yn,u.paint,g.transform.zoom,Or,Zr)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}function Ju(g,s,u,y,S,P,O,D,q,W,Z,te,re,ae,ye,fe,xe,_e,Ee){const Fe=g.context,De=Fe.gl,Ze=g.transform,Ue=g.transform.zoom,qe=[],Ve=Al(g,u.paint.get("fill-extrusion-cutoff-fade-range"));W==="clear"?(qe.push("CLEAR_SUBPASS"),Ee&&(qe.push("CLEAR_FROM_TEXTURE"),Fe.activeTexture.set(De.TEXTURE0),Ee.bind(De.LINEAR,De.CLAMP_TO_EDGE))):W==="sdf"&&qe.push("SDF_SUBPASS"),xe&&qe.push("HAS_CENTROID"),Ve.shouldRenderCutoff&&qe.push("RENDER_CUTOFF");const Ke=u.layout.get("fill-extrusion-edge-radius"),it=(_t,pt,Ct,Mt,ut)=>{const Tt=pt.programConfigurations.get(u.id),Bt=g.isTileAffectedByFog(_t),ft=g.getOrCreateProgram("fillExtrusionGroundEffect",{config:Tt,defines:qe,overrideFog:Bt}),Dt=((Zt,zt,Nt,qt,er,fr,mr,$r,Or,jr,Wr)=>({u_matrix:zt,u_opacity:Nt,u_ao_pass:qt?1:0,u_meter_to_tile:er,u_ao:fr,u_flood_light_intensity:mr,u_flood_light_color:$r,u_attenuation:Or,u_edge_radius:jr,u_fb:0,u_fb_size:Wr,u_dynamic_offset:1}))(0,Mt,Z,q,ut,[te,re*ut],ae,ye,fe,Ue>=17?0:Ke*ut,Ee?Ee.size[0]:0),Pt=[];xe&&Pt.push(pt.hiddenByLandmarkVertexBuffer),g.uploadCommonUniforms(Fe,ft,_t.toUnwrapped(),null,Ve),ft.draw(g,Fe.gl.TRIANGLES,S,P,O,D,Dt,u.id,pt.vertexBuffer,pt.indexBuffer,Ct,u.paint,Ue,Tt,Pt)};for(const _t of y){const pt=s.getTile(_t),Ct=pt.getBucket(u);if(!Ct||Ct.projection.name!==Ze.projection.name||!Ct.groundEffect||Ct.groundEffect&&!Ct.groundEffect.hasData())continue;const Mt=Ct.groundEffect,ut=1/Ct.tileToMeter;{const Tt=g.translatePosMatrix(_t.projMatrix,pt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Bt=Mt.getDefaultSegment();it(_t,Mt,Bt,Tt,ut)}if(_e)for(let Tt=0;Tt<4;Tt++){const Bt=i.d4[Tt](_t),ft=s.getTile(Bt);if(!ft)continue;const Dt=ft.getBucket(u);if(!Dt||Dt.projection.name!==Ze.projection.name||!Dt.groundEffect||Dt.groundEffect&&!Dt.groundEffect.hasData())continue;const Pt=Dt.groundEffect;let Zt,zt;Tt===0?(Zt=[-i.ag,0,0],zt=1):Tt===1?(Zt=[i.ag,0,0],zt=0):Tt===2?(Zt=[0,-i.ag,0],zt=3):(Zt=[0,i.ag,0],zt=2);const Nt=Pt.regionSegments[zt];if(!Nt)continue;const qt=new Float32Array(16);i.ab.mat4.translate(qt,_t.projMatrix,Zt),it(_t,Pt,Nt,g.translatePosMatrix(qt,pt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),ut)}}}function Qu(g,s,u,y,S,P,O){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const D=P?P.findDEMTileFor(u):null;if(!(D&&D.dem||O))return;P&&D&&D.dem&&y.selfDEMTileTimestamp!==D.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=D.dem._timestamp);const q=_e=>new i.P(Math.ceil((_e+i.d7)*i.d8),0),W=_e=>{const Ee=s.getSource().minzoom,Fe=Ze=>{const Ue=s.getTileByID(Ze);if(Ue&&Ue.hasData())return Ue.getBucket(S)},De=[0,-1,1];for(const Ze of De){if(_e.overscaledZ+Ze<Ee)continue;const Ue=Fe(_e.calculateScaledKey(_e.overscaledZ+Ze));if(Ue)return Ue}},Z=[0,0,0],te=(_e,Ee)=>(Z[0]=Math.min(_e.min.y,Ee.min.y),Z[1]=Math.max(_e.max.y,Ee.max.y),Z[2]=i.ag-Ee.min.x>_e.max.x?Ee.min.x-i.ag:_e.max.x,Z),re=(_e,Ee)=>(Z[0]=Math.min(_e.min.x,Ee.min.x),Z[1]=Math.max(_e.max.x,Ee.max.x),Z[2]=i.ag-Ee.min.y>_e.max.y?Ee.min.y-i.ag:_e.max.y,Z),ae=[(_e,Ee)=>te(_e,Ee),(_e,Ee)=>te(Ee,_e),(_e,Ee)=>re(_e,Ee),(_e,Ee)=>re(Ee,_e)],ye=(_e,Ee,Fe,De,Ze,Ue,qe)=>{if(!P)return 0;const Ve=[[Ue?Fe:_e,Ue?_e:Fe,0],[Ue?Fe:Ee,Ue?Ee:Fe,0]],Ke=qe<0?i.ag+qe:qe,it=[Ue?Ke:(_e+Ee)/2,Ue?(_e+Ee)/2:Ke,0];return Fe===0&&qe<0||Fe!==0&&qe>0?P.getForTilePoints(Ze,[it],!0,De):Ve.push(it),P.getForTilePoints(u,Ve,!0,D),Math.max(Ve[0][2],Ve[1][2],it[2])/P.exaggeration()};for(let _e=0;_e<4;_e++){const Ee=y.borderFeatureIndices[_e];if(Ee.length===0)continue;const Fe=i.d4[_e](u),De=W(Fe);if(!(De&&De instanceof i.d5))continue;const Ze=P?P.findDEMTileFor(Fe):null;if(!(Ze&&Ze.dem||O)||(P&&Ze&&Ze.dem&&y.borderDEMTileTimestamp[_e]!==Ze.dem._timestamp&&(y.borderDoneWithNeighborZ[_e]=-1,y.borderDEMTileTimestamp[_e]=Ze.dem._timestamp),y.borderDoneWithNeighborZ[_e]===De.canonical.z))continue;De.centroidVertexArray.length===0&&De.createCentroidsBuffer();const Ue=(_e<2?1:5)-_e,qe=De.borderDoneWithNeighborZ[Ue]!==y.canonical.z,Ve=De.borderFeatureIndices[Ue];let Ke=0;if(y.canonical.z!==De.canonical.z){for(const it of Ee)y.showCentroid(y.featuresOnBorder[it]);if(qe)for(const it of Ve)De.showCentroid(De.featuresOnBorder[it]);y.borderDoneWithNeighborZ[_e]=De.canonical.z,De.borderDoneWithNeighborZ[Ue]=y.canonical.z}for(const it of Ee){const _t=y.featuresOnBorder[it],pt=y.centroidData[_t.centroidDataIndex],Ct=_t.borders[_e];let Mt;for(;Ke<Ve.length;){Mt=De.featuresOnBorder[Ve[Ke]];const ut=Mt.borders[Ue];if(ut[1]>Ct[0]+3||ut[0]>Ct[0]-3)break;De.showCentroid(Mt),Ke++}if(Mt&&Ke<Ve.length){const ut=Ke;let Tt=0;for(;!(Mt.borders[Ue][0]>Ct[1]-3)&&(Tt++,++Ke!==Ve.length);)Mt=De.featuresOnBorder[Ve[Ke]];Mt=De.featuresOnBorder[Ve[ut]];let Bt=!1;if(Tt>=1){const Pt=Mt.borders[Ue];Math.abs(Ct[0]-Pt[0])<3&&Math.abs(Ct[1]-Pt[1])<3&&(Tt=1,Bt=!0,Ke=ut+1)}else if(Tt===0){y.showCentroid(_t);continue}const ft=De.centroidData[Mt.centroidDataIndex];O&&Bt&&(((fe=pt).flags|(xe=ft).flags)&i.d6?(fe.flags|=i.d6,xe.flags|=i.d6):(fe.flags&=~i.d6,xe.flags&=~i.d6));const Dt=_t.intersectsCount()>1||Mt.intersectsCount()>1;if(Tt>1)Ke=ut,pt.centroidXY=ft.centroidXY=new i.P(0,0);else if(Ze&&Ze.dem&&!Dt){const Pt=ae[_e](pt,ft),Zt=_e%2?i.ag-1:0,zt=ye(Pt[0],Math.min(i.ag-1,Pt[1]),Zt,Ze,Fe,_e<2,Pt[2]);pt.centroidXY=ft.centroidXY=q(zt)}else Dt?pt.centroidXY=ft.centroidXY=new i.P(0,0):(pt.centroidXY=y.encodeBorderCentroid(_t),ft.centroidXY=De.encodeBorderCentroid(Mt));y.writeCentroidToBuffer(pt),De.writeCentroidToBuffer(ft)}else y.showCentroid(_t)}y.borderDoneWithNeighborZ[_e]=De.canonical.z,De.borderDoneWithNeighborZ[Ue]=y.canonical.z}var fe,xe;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const ed=[1,0,0],Yt=[0,1,0],or=[0,0,1];function Ol(g,s,u){const y=u.transform,S=u.shadowRenderer;if(!S)return!0;const P=g.toUnwrapped(),O=y.tileSize*S._cascades[u.currentShadowCascade].scale;let D=s.maxHeight;if(y.elevation){const fe=y.elevation.getMinMaxForTile(g);fe&&(D+=fe.max)}const q=[...S.shadowDirection];q[2]=-q[2];const W=S.computeSimplifiedTileShadowVolume(P,D,O,q);if(!W)return!1;const Z=[ed,Yt,or,q,[q[0],0,q[2]],[0,q[1],q[2]]],te=y.projection.name==="globe",re=y.scaleZoom(O),ae=i.bR.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,re,!te),ye=S.getCurrentCascadeFrustum();return ae.intersectsPrecise(W.vertices,W.planes,Z)===0||ye.intersectsPrecise(W.vertices,W.planes,Z)===0}function $i(g){return[g[0]*i.d9,g[1]*i.d9,g[2]*i.d9,0]}function vt(g,s,u,y,S,P,O,D,q){const W=y.getSource(),Z=u.globeSharedBuffers;if(!Z)return;let te,re,ae;if(s&&(te=y.getTile(s)),W instanceof i.aJ?(re=W.texture,ae=i.cI(0,0,u.transform)):te&&s&&(re=te.texture,ae=i.cI(s.canonical.z,s.canonical.x,u.transform)),!re||!ae)return;g||(ae=i.ab.mat4.scale(i.ab.mat4.create(),ae,[1,-1,1]));const ye=u.context,fe=ye.gl,xe=S.paint.get("raster-resampling")==="nearest"?fe.NEAREST:fe.LINEAR,_e=u.colorModeForDrapableLayerRenderPass(P),Ee=O.defines;Ee.push("GLOBE_POLES");const Fe=new Lr(fe.LEQUAL,Lr.ReadWrite,u.depthRangeFor3D),De=Float32Array.from(u.transform.expandedFarZProjMatrix),Ze=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),ye.activeTexture.set(fe.TEXTURE0),re.bind(xe,fe.CLAMP_TO_EDGE),ye.activeTexture.set(fe.TEXTURE1),re.bind(xe,fe.CLAMP_TO_EDGE),re.useMipmap&&ye.extTextureFilterAnisotropic&&u.transform.pitch>20&&fe.texParameterf(fe.TEXTURE_2D,ye.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ye.extTextureFilterAnisotropicMax);const[Ue,qe,Ve,Ke]=s?Z.getPoleBuffers(s.canonical.z,!1):Z.getPoleBuffers(0,!0),it=S.paint.get("raster-elevation");let _t;g?(_t=Ue,u.renderDefaultNorthPole=it!==0):(_t=qe,u.renderDefaultSouthPole=it!==0);const pt=$i(O.mix),Ct=((ut,Tt,Bt,ft,Dt,Pt,Zt,zt,Nt,qt,er,fr,mr)=>os(ut,Tt,Bt,new Float32Array(16),new Float32Array(9),[0,0],ft,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Pt,[0,0],zt,2,qt,er,fr,1,0,mr))(De,Ze,ae,i.ae(u.transform.zoom),0,S,0,it,0,pt,O.offset,O.range,P),Mt=u.getOrCreateProgram("raster",{defines:Ee});u.uploadCommonUniforms(ye,Mt,null),Mt.draw(u,fe.TRIANGLES,Fe,q,_e,D,Ct,S.id,_t,Ve,Ke)}function Sc(g){const s=g._nearZ,u=g.projection.farthestPixelDistance(g),y=u-s,S=.2*g.height,P=s+S;return[s,u,(P-S-s)/y,(P-s)/y]}function Zl(g,s,u,y){if(g)return s instanceof Ga&&g instanceof qc?s.getTextureDescriptor(g,u,!0):{texture:g.texture,mix:$i(y.mix),offset:y.offset,buffer:0,tileSize:1}}var Ep=i.da([{name:"a_index",type:"Int16",components:1}]);class Ty{constructor(s,u,y,S){const P={width:y[0],height:y[1],data:null},O=s.gl;this.targetColorTexture=new i.T(s,P,O.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(s,P,O.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(u,S),this.lastInvalidatedAt=0}updateParticleTexture(s,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,S=u.width*u.height;this.particleTexture0=new i.T(this.context,u,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,u,y.RGBA8,{premultiply:!1,useMipmap:!1});const P=new i.db;P.reserve(S);for(let O=0;O<S;O++)P.emplaceBack(O);this.particleIndexBuffer=this.context.createVertexBuffer(P,Ep.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Ac(g,s,u){if(!g)return null;const y=s.getTextureDescriptor(g,u,!0);if(!y)return null;let{texture:S,mix:P,offset:O,tileSize:D,buffer:q,format:W}=y;if(!S||!W)return null;let Z=!1;return W==="uint32"&&(Z=!0,P[3]=0,P=ru(i.dc,P,[0,u.paint.get("raster-particle-max-speed")]),O=Hl(i.dc,O,[0,u.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[q/(D+2*q),D/(D+2*q)],tileSize:D,scalarData:Z,scale:P,offset:O,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[W]]}}function nu(g){const s=g._nearZ,u=g.projection.farthestPixelDistance(g),y=u-s,S=.2*g.height,P=s+S;return[s,u,(P-S-s)/y,(P-s)/y]}const iu=new i.aj(1,0,0,1),h_=new i.aj(0,1,0,1),qm=new i.aj(0,0,1,1),Py=new i.aj(1,0,1,1),td=new i.aj(0,1,1,1);function Ko(g,s,u,y,S,P,O){const D=g.context,q=g.transform,W=D.gl,Z=q.projection.name==="globe",te=Z?["PROJECTION_GLOBE_VIEW"]:[];let re=i.ab.mat4.clone(u.projMatrix);if(Z&&i.ae(q.zoom)>0){const pt=i.ba(u.canonical,q),Ct=i.dd(pt);re=i.ab.mat4.multiply(new Float32Array(16),q.globeMatrix,Ct),i.ab.mat4.multiply(re,q.projMatrix,re)}const ae=i.ab.mat4.create();ae[12]+=2*S/(i.q.devicePixelRatio*q.width),ae[13]+=2*P/(i.q.devicePixelRatio*q.height),i.ab.mat4.multiply(re,ae,re);const ye=g.getOrCreateProgram("debug",{defines:te}),fe=s.getTileByID(u.key);g.terrain&&g.terrain.setupElevationDraw(fe,ye);const xe=Lr.disabled,_e=Gr.disabled,Ee=g.colorModeForRenderPass(),Fe="$debug";D.activeTexture.set(W.TEXTURE0),g.emptyTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Z?fe._makeGlobeTileDebugBuffers(g.context,q):fe._makeDebugTileBoundsBuffers(g.context,q.projection);const De=fe._tileDebugBuffer||g.debugBuffer,Ze=fe._tileDebugIndexBuffer||g.debugIndexBuffer,Ue=fe._tileDebugSegments||g.debugSegments;if(ye.draw(g,W.LINE_STRIP,xe,_e,Ee,Hr.disabled,bc(re,y),Fe,De,Ze,Ue,null,null,null,[fe._globeTileDebugBorderBuffer]),O){const pt=fe.latestRawTileData,Ct=Math.floor((pt&&pt.byteLength||0)/1024);let Mt=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Mt+=` => ${u.overscaledZ}`),Mt+=` ${fe.state}`,Mt+=` ${Ct}kb`,function(ut,Tt){ut.initDebugOverlayCanvas();const Bt=ut.debugOverlayCanvas,ft=ut.context.gl,Dt=ut.debugOverlayCanvas.getContext("2d");Dt.clearRect(0,0,Bt.width,Bt.height),Dt.shadowColor="white",Dt.shadowBlur=2,Dt.lineWidth=1.5,Dt.strokeStyle="white",Dt.textBaseline="top",Dt.font="bold 36px Open Sans, sans-serif",Dt.fillText(Tt,5,5),Dt.strokeText(Tt,5,5),ut.debugOverlayTexture.update(Bt),ut.debugOverlayTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE)}(g,Mt)}const qe=s.getTile(u).tileSize,Ve=512/Math.min(qe,512)*(u.overscaledZ/q.zoom)*.5,Ke=fe._tileDebugTextBuffer||g.debugBuffer,it=fe._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,_t=fe._tileDebugTextSegments||g.debugSegments;ye.draw(g,W.TRIANGLES,xe,_e,xn.alphaBlended,Hr.disabled,bc(re,i.aj.transparent,Ve),Fe,Ke,it,_t,null,null,null,[fe._globeTileDebugTextBuffer])}function eh(g,s,u,y){pl(g,0,s+u/2,g.transform.width,u,y)}function th(g,s,u,y){pl(g,s-u/2,0,u,g.transform.height,y)}function pl(g,s,u,y,S,P){const O=g.context,D=O.gl;D.enable(D.SCISSOR_TEST),D.scissor(s*i.q.devicePixelRatio,u*i.q.devicePixelRatio,y*i.q.devicePixelRatio,S*i.q.devicePixelRatio),O.clear({color:P}),D.disable(D.SCISSOR_TEST)}const hf=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ss}=hf;function Tc(g,s,u,y){g.emplaceBack(s,u,y)}class Gm{constructor(s){this.vertexArray=new i.de,this.indices=new i.aU,Tc(this.vertexArray,-1,-1,1),Tc(this.vertexArray,1,-1,1),Tc(this.vertexArray,-1,1,1),Tc(this.vertexArray,1,1,1),Tc(this.vertexArray,-1,-1,-1),Tc(this.vertexArray,1,-1,-1),Tc(this.vertexArray,-1,1,-1),Tc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,Ss),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function fi(g,s,u,y,S,P){const O=g.context.gl,D=s.paint.get("sky-atmosphere-color"),q=s.paint.get("sky-atmosphere-halo-color"),W=s.paint.get("sky-atmosphere-sun-intensity"),Z=((te,re,ae,ye,fe)=>({u_matrix_3f:te,u_sun_direction:re,u_sun_intensity:ae,u_color_tint_r:[ye.r,ye.g,ye.b,ye.a],u_color_tint_m:[fe.r,fe.g,fe.b,fe.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),y),S,W,D,q);O.framebufferTexture2D(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.TEXTURE_CUBE_MAP_POSITIVE_X+P,s.skyboxTexture,0),u.draw(g,O.TRIANGLES,Lr.disabled,Gr.disabled,xn.unblended,Hr.frontCW,Z,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const Km=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class rh{constructor(s){const u=new i.df;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const y=new i.aU;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(u,Km.members),this.indexBuffer=s.createIndexBuffer(y),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ri=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Qn{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Wm{constructor(s){this.colorModeAlphaBlendedWriteRGB=new xn([1,Nd,1,Nd],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new xn([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new Qn,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const u=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new rh(u);const y=this.params.sizeRange,S=this.params.intensityRange,P=function(Z){const te=i.di(30),re=[];for(let ae=0;ae<Z;++ae){const ye=2*Math.PI*te(),fe=Math.acos(1-2*te())-.5*Math.PI;re.push(i.ab.vec3.fromValues(Math.cos(fe)*Math.cos(ye),Math.cos(fe)*Math.sin(ye),Math.sin(fe)))}return re}(this.params.starsCount),O=i.di(300),D=new i.dg,q=new i.aU;let W=0;for(let Z=0;Z<P.length;++Z){const te=i.ab.vec3.scale([],P[Z],200),re=Math.max(0,1+.01*y*(1*O()-.5)),ae=Math.max(0,1+.01*S*(1*O()-.5));D.emplaceBack(te[0],te[1],te[2],-1,-1,re,ae),D.emplaceBack(te[0],te[1],te[2],1,-1,re,ae),D.emplaceBack(te[0],te[1],te[2],1,1,re,ae),D.emplaceBack(te[0],te[1],te[2],-1,1,re,ae),q.emplaceBack(W+0,W+1,W+2),q.emplaceBack(W+0,W+2,W+3),W+=4}this.starsVx=u.createVertexBuffer(D,Ri.members),this.starsIdx=u.createIndexBuffer(q),this.starsSegments=i.b7.simpleSegment(0,0,D.length,q.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,u){const y=s.context,S=y.gl,P=s.transform,O=new Lr(S.LEQUAL,Lr.ReadOnly,[0,1]),D=i.ae(P.zoom),q=s.style.getLut(u.scope),W=u.properties.get("color-use-theme")==="none",Z=u.properties.get("color").toRenderColor(W?null:q).toArray01(),te=u.properties.get("high-color-use-theme")==="none",re=u.properties.get("high-color").toRenderColor(te?null:q).toArray01(),ae=u.properties.get("space-color-use-theme")==="none",ye=u.properties.get("space-color").toRenderColor(ae?null:q).toArray01PremultipliedAlpha(),fe=5e-4,xe=i.dh(u.properties.get("horizon-blend"),0,1,fe,.25),_e=i.cC(s,y,P)&&xe===fe?P.worldSize/(2*Math.PI*1.025)-1:P.globeRadius,Ee=s.frameCounter/1e3%1,Fe=i.ab.vec3.length(P.globeCenterInViewSpace),De=Math.sqrt(Math.pow(Fe,2)-Math.pow(_e,2)),Ze=Math.acos(De/Fe),Ue=qe=>{const Ve=P.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];qe&&Ve.push("ALPHA_PASS");const Ke=s.getOrCreateProgram("globeAtmosphere",{defines:Ve}),it=((pt,Ct,Mt,ut,Tt,Bt,ft,Dt,Pt,Zt,zt,Nt)=>({u_frustum_tl:pt,u_frustum_tr:Ct,u_frustum_br:Mt,u_frustum_bl:ut,u_horizon:Tt,u_transition:Bt,u_fadeout_range:ft,u_color:Dt,u_high_color:Pt,u_space_color:Zt,u_temporal_offset:zt,u_horizon_angle:Nt}))(P.frustumCorners.TL,P.frustumCorners.TR,P.frustumCorners.BR,P.frustumCorners.BL,P.frustumCorners.horizon,D,xe,Z,re,ye,Ee,Ze);s.uploadCommonUniforms(y,Ke);const _t=this.atmosphereBuffer;_t&&Ke.draw(s,S.TRIANGLES,O,Gr.disabled,qe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Hr.backCW,it,qe?"atmosphere_glow_alpha":"atmosphere_glow",_t.vertexBuffer,_t.indexBuffer,_t.segments)};Ue(!1),Ue(!0)}drawStars(s,u){const y=i.aw(u.properties.get("star-intensity"),0,1);if(y===0)return;const S=s.context,P=S.gl,O=s.transform,D=s.getOrCreateProgram("stars"),q=i.ab.quat.identity([]);i.ab.quat.rotateX(q,q,-O._pitch),i.ab.quat.rotateZ(q,q,-O.angle),i.ab.quat.rotateX(q,q,i.ai(O._center.lat)),i.ab.quat.rotateY(q,q,-i.ai(O._center.lng));const W=i.ab.mat4.fromQuat(new Float32Array(16),q),Z=i.ab.mat4.multiply([],O.starsProjMatrix,W),te=i.ab.mat3.fromMat4([],W),re=i.ab.mat3.invert([],te),ae=[0,1,0];i.ab.vec3.transformMat3(ae,ae,re),i.ab.vec3.scale(ae,ae,this.params.sizeMultiplier);const ye=[1,0,0];i.ab.vec3.transformMat3(ye,ye,re),i.ab.vec3.scale(ye,ye,this.params.sizeMultiplier);const fe=(xe=ae,_e=ye,Ee=y,{u_matrix:Float32Array.from(Z),u_up:xe,u_right:_e,u_intensity_multiplier:Ee});var xe,_e,Ee;s.uploadCommonUniforms(S,D),this.starsVx&&this.starsIdx&&D.draw(s,P.TRIANGLES,Lr.disabled,Gr.disabled,this.colorModeAlphaBlendedWriteRGB,Hr.disabled,fe,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function As(g,s){const u=[...g],y=s.cameraWorldSizeForFog/s.worldSize,S=i.ab.mat4.identity([]);return i.ab.mat4.scale(S,S,[y,y,1]),i.ab.mat4.multiply(u,S,u),i.ab.mat4.multiply(u,s.worldToFogMatrix,u),u}function ia(g,s,u,y,S){const P=u.material,O=y.context,{baseColorTexture:D,metallicRoughnessTexture:q}=P.pbrMetallicRoughness,{normalTexture:W,occlusionTexture:Z,emissionTexture:te}=P;function re(ye,fe,xe){if(ye&&(g.push(fe),O.activeTexture.set(O.gl.TEXTURE0+xe),ye.gfxTexture)){const{minFilter:_e,magFilter:Ee,wrapS:Fe,wrapT:De}=ye.sampler;ye.gfxTexture.bindExtraParam(_e,Ee,Fe,De)}}re(D,"HAS_TEXTURE_u_baseColorTexture",Io.BaseColor),re(q,"HAS_TEXTURE_u_metallicRoughnessTexture",Io.MetallicRoughness),re(W,"HAS_TEXTURE_u_normalTexture",Io.Normal),re(Z,"HAS_TEXTURE_u_occlusionTexture",Io.Occlusion),re(te,"HAS_TEXTURE_u_emissionTexture",Io.Emission),S&&(S.texture||(S.texture=new i.dk(y.context,S.image,[S.image.height,S.image.height,S.image.height],O.gl.RGBA8)),O.activeTexture.set(O.gl.TEXTURE0+Io.LUT),S.texture&&S.texture.bind(O.gl.LINEAR,O.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(u.texcoordBuffer)),u.colorBuffer&&(g.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(u.colorBuffer)),u.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(u.normalBuffer)),u.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(u.pbrBuffer)),P.alphaMode!=="OPAQUE"&&P.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),P.defined||g.push("DIFFUSE_SHADED");const ae=y.shadowRenderer;ae&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ae.useNormalOffset&&g.push("NORMAL_OFFSET"))}function ua(g,s,u,y,S,P){const O=u.paint.get("model-opacity").constantOr(1),D=s.context,q=new Lr(s.context.gl.LEQUAL,Lr.ReadWrite,s.depthRangeFor3D),W=s.transform,Z=g.mesh,te=Z.material,re=te.pbrMetallicRoughness,ae=s.style.fog;let ye;ye=s.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:i.ab.mat4.multiply([],y.zScaleMatrix,g.nodeModelMatrix),i.ab.mat4.multiply(ye,y.negCameraPosMatrix,ye);const fe=i.ab.mat4.invert([],ye);i.ab.mat4.transpose(fe,fe);const xe=u.paint.get("model-color-use-theme").constantOr("default")==="none",_e=u.paint.get("model-emissive-strength").constantOr(0),Ee=Yd(new Float32Array(g.worldViewProjection),new Float32Array(ye),new Float32Array(fe),null,s,O,re.baseColorFactor.toRenderColor(null),te.emissiveFactor,re.metallicFactor,re.roughnessFactor,te,_e,u),Fe={defines:[]},De=[],Ze=s.shadowRenderer;Ze&&(Ze.useNormalOffset=!1),ia(Fe.defines,De,Z,s,xe?null:u.lut);let Ue=null;if(ae){const Ke=As(g.nodeModelMatrix,s.transform);if(Ue=new Float32Array(Ke),W.projection.name!=="globe"){const it=Z.aabb.min,_t=Z.aabb.max,[pt,Ct]=ae.getOpacityForBounds(Ke,it[0],it[1],_t[0],_t[1]);Fe.overrideFog=pt>=He||Ct>=He}}const qe=Al(s,u.paint.get("model-cutoff-fade-range"));qe.shouldRenderCutoff&&Fe.defines.push("RENDER_CUTOFF");const Ve=s.getOrCreateProgram("model",Fe);s.uploadCommonUniforms(D,Ve,null,Ue,qe),s.renderPass!=="shadow"&&Ze&&Ze.setupShadowsFromMatrix(g.nodeModelMatrix,Ve),Ve.draw(s,D.gl.TRIANGLES,q,S,P,Z.material.doubleSided?Hr.disabled:Hr.backCCW,Ee,u.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,u.paint,s.transform.zoom,void 0,De)}function ro(g,s,u,y,S,P,O){let D;D=g.projection.name==="globe"?i.dl(u,g):[...u],i.ab.mat4.multiply(D,D,s.matrix);const q=i.ab.mat4.multiply([],y,D);if(s.meshes)for(const W of s.meshes){if(W.material.alphaMode!=="BLEND"){O.push({mesh:W,depth:0,modelIndex:S,worldViewProjection:q,nodeModelMatrix:D});continue}const Z=i.ab.vec3.transformMat4([],W.centroid,q);!g.isOrthographic&&Z[2]<=0||P.push({mesh:W,depth:Z[2],modelIndex:S,worldViewProjection:q,nodeModelMatrix:D})}if(s.children)for(const W of s.children)ro(g,W,u,y,S,P,O)}function rd(g,s,u,y){const S=u.shadowRenderer;if(!S)return;const P=S.getShadowPassDepthMode(),O=S.getShadowPassColorMode(),D=S.calculateShadowPassMatrixFromMatrix(s),q=uf(D);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,P,Gr.disabled,O,Hr.backCCW,q,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,u.transform.zoom,void 0,void 0)}function qs(g,s,u){const y=s.updateZoomBasedPaintProperties(),S=function(P,O,D){let q,W,Z,te=P.terrain?P.terrain.exaggeration():0;if(P.terrain&&te>0){const re=P.terrain,ae=re.findDEMTileFor(D);ae&&ae.dem?q=i.dn.create(re,D,ae):te=0}if(te===0&&(O.terrainElevationMin=0,O.terrainElevationMax=0),te===O.validForExaggeration&&(te===0||q&&q._demTile&&q._demTile.tileID===O.validForDEMTile.id&&q._dem._timestamp===O.validForDEMTile.timestamp))return!1;for(const re in O.instancesPerModel){const ae=O.instancesPerModel[re];for(let ye=0;ye<ae.instancedDataArray.length;++ye){const fe=(q?te*q.getElevationAt(0|ae.instancedDataArray.float32[16*ye],0|ae.instancedDataArray.float32[16*ye+1],!0,!0):0)+ae.instancesEvaluatedElevation[ye];ae.instancedDataArray.float32[16*ye+6]=fe,W=W?Math.min(O.terrainElevationMin,fe):fe,Z=Z?Math.max(O.terrainElevationMax,fe):fe}}return O.terrainElevationMin=W||0,O.terrainElevationMax=Z||0,O.validForExaggeration=te,O.validForDEMTile=q&&q._demTile?{id:q._demTile.tileID,timestamp:q._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,s,u);(y||S)&&(s.uploaded=!1,s.upload(g.context))}const no={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function Hm(g,s){const u=1<<g.canonical.z,y=s.getFreeCameraOptions().position,S=s.elevation,P=g.canonical.x/u,O=(g.canonical.x+1)/u,D=g.canonical.y/u,q=(g.canonical.y+1)/u;let W=s._centerAltitude;if(S){const ae=S.getMinMaxForTile(g);ae&&ae.max>W&&(W=ae.max)}const Z=i.aw(y.x,P,O)-y.x,te=i.aw(y.y,D,q)-y.y,re=i.bH(W,s.center.lat)-y.z;return s._zoomFromMercatorZ(Math.sqrt(Z*Z+te*te+re*re))}function mo(g,s,u,y,S,P,O){const D=g.context,q=g.renderPass==="shadow",W=g.shadowRenderer,Z=q&&W?W.getShadowPassDepthMode():new Lr(D.gl.LEQUAL,Lr.ReadWrite,g.depthRangeFor3D),te=g.isTileAffectedByFog(P);if(u.meshes)for(const re of u.meshes){const ae=["MODEL_POSITION_ON_GPU"],ye=[];let fe,xe,_e;y.instancedDataArray.length>20&&ae.push("INSTANCED_ARRAYS");const Ee=Al(g,s.paint.get("model-cutoff-fade-range"));if(Ee.shouldRenderCutoff&&ae.push("RENDER_CUTOFF"),q&&W)fe=g.getOrCreateProgram("modelDepth",{defines:ae}),xe=uf(O.shadowTileMatrix,O.shadowTileMatrix,Float32Array.from(u.matrix)),_e=W.getShadowPassColorMode();else{ia(ae,ye,re,g,s.paint.get("model-color-use-theme").constantOr("default")==="none"?null:s.lut),fe=g.getOrCreateProgram("model",{defines:ae,overrideFog:te});const De=re.material,Ze=De.pbrMetallicRoughness,Ue=s.paint.get("model-opacity").constantOr(1),qe=s.paint.get("model-emissive-strength").constantOr(0);xe=Yd(P.expandedProjMatrix,Float32Array.from(u.matrix),new Float32Array(16),null,g,Ue,Ze.baseColorFactor.toRenderColor(null),De.emissiveFactor,Ze.metallicFactor,Ze.roughnessFactor,De,qe,s,S),W&&(O.shadowUniformsInitialized?fe.setShadowUniformValues(D,W.getShadowUniformValues()):(W.setupShadows(P.toUnwrapped(),fe,"model-tile",P.overscaledZ),O.shadowUniformsInitialized=!0)),_e=Ee.shouldRenderCutoff||Ue<1||De.alphaMode!=="OPAQUE"?xn.alphaBlended:xn.unblended}g.uploadCommonUniforms(D,fe,P.toUnwrapped(),null,Ee);const Fe=re.material.doubleSided?Hr.disabled:Hr.backCCW;if(y.instancedDataArray.length>20)ye.push(y.instancedDataBuffer),fe.draw(g,D.gl.TRIANGLES,Z,Gr.disabled,_e,Fe,xe,s.id,re.vertexBuffer,re.indexBuffer,re.segments,s.paint,g.transform.zoom,void 0,ye,y.instancedDataArray.length);else{const De=q?"u_instance":"u_normal_matrix";for(let Ze=0;Ze<y.instancedDataArray.length;++Ze)xe[De]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Ze,16),fe.draw(g,D.gl.TRIANGLES,Z,Gr.disabled,_e,Fe,xe,s.id,re.vertexBuffer,re.indexBuffer,re.segments,s.paint,g.transform.zoom,void 0,ye)}}if(u.children)for(const re of u.children)mo(g,s,re,y,S,P,O)}const Cp=[1,-1,1];function Mp(g,s,u,y){if(!u.modelManager)return!0;const S=u.modelManager;if(!u.shadowRenderer)return!0;const P=u.shadowRenderer,O=s.aabb;let D=!0,q=g.maxHeight;if(q===0){let Z=0;for(const te in g.instancesPerModel){const re=S.getModel(te,y);re?Z=Math.max(Z,Math.max(Math.max(re.aabb.max[0],re.aabb.max[1]),re.aabb.max[2])):D=!1}q=g.maxScale*Z*1.41+g.maxVerticalOffset,D&&(g.maxHeight=q)}O.max[2]=q,O.min[2]+=g.terrainElevationMin,O.max[2]+=g.terrainElevationMax,i.ab.vec3.transformMat4(O.min,O.min,s.tileMatrix),i.ab.vec3.transformMat4(O.max,O.max,s.tileMatrix);const W=O.intersects(P.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=W===2),W===0}function au(g,s){const u=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],S=g.uniformValues.u_cutoff_params[2],P=g.uniformValues.u_cutoff_params[3];return y===u||P===S?1:i.aw(((s-u)/(y-u)-S)/(P-S),0,1)}function Rl(g,s,u,y){if(s.pitch<20)return 1;const S=s.getWorldToCameraMatrix();i.ab.mat4.multiply(S,S,g);const P=i.ab.vec4.fromValues(u.min[0],u.min[1],u.min[2],1);let O=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=O,q=O;P[1]=u.max[1],O=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=O[1]<D[1]?O:D,q=O[1]>q[1]?O:q,P[0]=u.max[0],O=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=O[1]<D[1]?O:D,q=O[1]>q[1]?O:q,P[1]=u.min[1],O=i.ab.vec4.transformMat4(i.ab.vec4.create(),P,S),D=O[1]<D[1]?O:D,q=O[1]>q[1]?O:q;const W=i.aw(y[0],0,1),Z=100*s.pixelsPerMeter*i.aw(y[1],0,1),te=i.aw(y[2],0,1),re=i.ab.vec4.lerp(i.ab.vec4.create(),D,q,W),ae=Math.tan(.5*s.fovX),ye=-re[2]*ae;if(Z===0)return re[1]<-Math.abs(ye)?te:1;const fe=(-Math.abs(ye)-re[1])/Z,xe=(Ee,Fe,De)=>(1-De)*Ee+De*Fe,_e=i.aw(xe(1,te,fe),te,1);return xe(1,_e,i.aw((s.pitch-20)/20,0,1))}class Eo{}class nh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,u,y){{const te=this._storage.get(u.id);if(te)return te.lastUsedFrameIdx=s,te.buf}const S=y.gl,P=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),O=new ArrayBuffer(P),D=new Int16Array(O);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(O));const q=new i.dq;for(let te=0;te<P/2;te+=3){const re=D[te],ae=D[te+1],ye=D[te+2];q.emplaceBack(re,ae),q.emplaceBack(ae,ye),q.emplaceBack(ye,re)}const W=y.bindVertexArrayOES.current,Z=new Eo;return Z.buf=new hl(y,q),Z.lastUsedFrameIdx=s,this._storage.set(u.id,Z),y.bindVertexArrayOES.set(W),Z.buf}update(s){for(const[u,y]of this._storage)s-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(u))}destroy(){for(const[s,u]of this._storage)u.buf.destroy(),this._storage.delete(s)}}class ff{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Op=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Zm{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class go{constructor(s,u){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...u,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...u,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Ym=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class Xm{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,u){const y=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const O=new i.dr,D=new i.aU;O.emplaceBack(-1,-1),O.emplaceBack(1,-1),O.emplaceBack(1,1),O.emplaceBack(-1,1),D.emplaceBack(0,1,2),D.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(O,Ym.members),this.vignetteIdx=s.context.createIndexBuffer(D)}const S=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,y);const O={u_vignetteShape:(P={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:P.vignetteColor};y.draw(s,s.context.gl.TRIANGLES,Lr.disabled,Gr.disabled,xn.alphaBlended,Hr.disabled,O,"vignette",this.vignetteVx,this.vignetteIdx,S,{})}var P}}class pf{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,u){const y=s.getFreeCameraOptions().position,S=y.toAltitude(),P=y.toLngLat(),O=i.ai(P.lng),D=i.ai(P.lat),q=s.pixelsPerMeter/u,W=O*i.ds,Z=i.ds*Math.log(Math.tan(Math.PI/4+D/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const te=-this._offsetYPrev+Z,re=-this._elevationPrev+S;this._accumulatedOffsetX+=(-this._offsetXPrev+W)*q,this._accumulatedOffsetY+=te*q,this._accumulatedElevation+=re*q,this._offsetXPrev=W,this._offsetYPrev=Z,this._elevationPrev=S}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function ou(g,s){return[-(g[0]-Math.floor(g[0]/s)*s),-(g[1]-Math.floor(g[1]/s)*s),-(g[2]-Math.floor(g[2]/s)*s)]}function Rp(g){const s=i.di(1323123451230),u=[];for(let y=0;y<g;++y){const S=2*s()-1,P=2*s()-1,O=2*s()-1;u.push(i.ab.vec3.fromValues(S,P,O))}return u}function Yl(g,s,u,y,S){const P=i.aw((S-u)/(y-u),0,1);return(1-P)*g+P*s}class nd{constructor(s){this._movement=new pf,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Xm,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,u){const y=s.transform;this._movement.update(y,this._ppmScaleFactor);const S=y.starsProjMatrix,P=i.ab.quat.identity([]);i.ab.quat.rotateX(P,P,i.ai(90)-y._pitch),i.ab.quat.rotateZ(P,P,-y.angle);const O=i.ab.mat4.fromQuat(new Float32Array(16),P),D=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),q=i.ab.mat4.transpose([],D),W=i.ab.mat4.multiply([],q,O),Z=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Z-this._prevTime)*u,this._prevTime=Z,{projectionMatrix:S,modelviewMatrix:W}}}class ih extends nd{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new go(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const y=Rp(this.particlesCount),S=new i.dt,P=new i.aU;let O=0;const D=i.di(1323123451230);for(let q=0;q<y.length;++q){const W=y[q],Z=[2*D()-1,D(),D(),D()];S.emplaceBack(W[0],W[1],W[2],-1,-1,...Z),S.emplaceBack(W[0],W[1],W[2],1,-1,...Z),S.emplaceBack(W[0],W[1],W[2],1,1,...Z),S.emplaceBack(W[0],W[1],W[2],-1,1,...Z),P.emplaceBack(O+0,O+1,O+2),P.emplaceBack(O+0,O+2,O+3),O+=4}this.particlesVx=u.createVertexBuffer(S,Op.members),this.particlesIdx=u.createIndexBuffer(P)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=s.transform.zoom;if(u.revealStart>y)return;const S=Yl(0,1,u.revealStart,u.revealStart+u.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const P=structuredClone(this._params);let O=[-P.direction.x,P.direction.y,-100];i.ab.vec3.normalize(O,O);const D=structuredClone(this._vignetteParams);D.strength*=S,P.overrideStyleParameters||(P.intensity=s.style.rain.state.density,P.timeFactor=s.style.rain.state.intensity,P.color=structuredClone(s.style.rain.state.color),O=structuredClone(s.style.rain.state.direction),P.screenThinning.intensity=s.style.rain.state.centerThinning,P.dropletSizeX=s.style.rain.state.dropletSize[0],P.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],P.distortionStrength=100*s.style.rain.state.distortionStrength,D.strength=1,D.color=structuredClone(s.style.rain.state.vignetteColor));const q=this.updateOnRender(s,P.timeFactor),W=s.context,Z=W.gl,te=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new i.T(W,{width:s.width,height:s.height,data:null},Z.RGBA8)),P.distortionStrength>0&&(W.activeTexture.set(Z.TEXTURE0),this.screenTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Z.copyTexSubImage2D(Z.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const re=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(W,re),W.activeTexture.set(Z.TEXTURE0),this.screenTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const ae=[P.color.r,P.color.g,P.color.b,P.color.a],ye=(fe,xe)=>{const _e=ou(this._movement.getPosition(),fe),Ee=P.dropletSizeX,Fe=P.dropletSizeX*P.dropletSizeYScale,De=s.width/2,Ze=s.height/2,Ue=Yl(0,P.screenThinning.start,0,1,P.screenThinning.intensity),qe=Yl(.001,P.screenThinning.range,0,1,P.screenThinning.intensity),Ve=Yl(0,P.screenThinning.particleOffset,0,1,P.screenThinning.intensity),Ke=(it={modelview:q.modelviewMatrix,projection:q.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:_e,velocityConeAperture:P.velocityConeAperture,velocity:P.velocity,boxSize:fe,rainDropletSize:[Ee,Fe],distortionStrength:P.distortionStrength,rainDirection:O,color:ae,screenSize:[te.width,te.height],thinningCenterPos:[De,Ze],thinningShape:[Ue,qe,Math.pow(10,P.screenThinning.fadePower)],thinningAffectedRatio:P.screenThinning.affectedRatio,thinningParticleOffset:Ve,shapeDirectionalPower:P.shapeDirPower,shapeNormalPower:P.shapeNormalPower,mode:xe?0:1},{u_modelview:Float32Array.from(it.modelview),u_projection:Float32Array.from(it.projection),u_time:it.time,u_cam_pos:it.camPos,u_texScreen:0,u_velocityConeAperture:it.velocityConeAperture,u_velocity:it.velocity,u_boxSize:it.boxSize,u_rainDropletSize:it.rainDropletSize,u_distortionStrength:it.distortionStrength,u_rainDirection:it.rainDirection,u_color:it.color,u_screenSize:it.screenSize,u_thinningCenterPos:it.thinningCenterPos,u_thinningShape:it.thinningShape,u_thinningAffectedRatio:it.thinningAffectedRatio,u_thinningParticleOffset:it.thinningParticleOffset,u_shapeDirectionalPower:it.shapeDirectionalPower,u_shapeNormalPower:it.shapeNormalPower,u_mode:it.mode});var it;const _t=Math.round(P.intensity*this.particlesCount),pt=i.b7.simpleSegment(0,0,4*_t,2*_t);re.draw(s,Z.TRIANGLES,Lr.disabled,Gr.disabled,xn.alphaBlended,Hr.disabled,Ke,"rain_particles",this.particlesVx,this.particlesIdx,pt,{})};P.distortionStrength>0&&ye(P.boxSize,!0),ye(P.boxSize,!1),this._vignette.draw(s,D)}}const mf=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class gf extends nd{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new go(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const u=s.context;if(!this.particlesVx){const y=Rp(this.particlesCount),S=new i.du,P=new i.aU;let O=0;const D=i.di(1323123451230);for(let q=0;q<y.length;++q){const W=y[q],Z=D(),te=D(),re=D(),ae=[q/y.length,Z,te,re],ye=[D(),D()];S.emplaceBack(W[0],W[1],W[2],-1,-1,...ae,...ye),S.emplaceBack(W[0],W[1],W[2],1,-1,...ae,...ye),S.emplaceBack(W[0],W[1],W[2],1,1,...ae,...ye),S.emplaceBack(W[0],W[1],W[2],-1,1,...ae,...ye),P.emplaceBack(O+0,O+1,O+2),P.emplaceBack(O+0,O+2,O+3),O+=4}this.particlesVx=u.createVertexBuffer(S,mf.members),this.particlesIdx=u.createIndexBuffer(P)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const u=structuredClone(this._params);let y=[-u.direction.x,u.direction.y,-100];i.ab.vec3.normalize(y,y);const S=structuredClone(this._vignetteParams),P=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},O=s.transform.zoom;if(P.revealStart>O)return;const D=Yl(0,1,P.revealStart,P.revealStart+P.revealRange,O);S.strength*=D,u.overrideStyleParameters||(u.intensity=s.style.snow.state.density,u.timeFactor=s.style.snow.state.intensity,u.color=structuredClone(s.style.snow.state.color),y=structuredClone(s.style.snow.state.direction),u.screenThinning.intensity=s.style.snow.state.centerThinning,u.billboardSize=2.79*s.style.snow.state.flakeSize,S.strength=1,S.color=structuredClone(s.style.snow.state.vignetteColor));const q=this.updateOnRender(s,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const W=s.context,Z=W.gl,te=s.transform,re=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(W,re),((ae,ye,fe)=>{const xe=ou(this._movement.getPosition(),ae),_e=te.width/2,Ee=te.height/2,Fe=Yl(0,fe.screenThinning.start,0,1,fe.screenThinning.intensity),De=Yl(.001,fe.screenThinning.range,0,1,fe.screenThinning.intensity),Ze=Yl(0,fe.screenThinning.particleOffset,0,1,fe.screenThinning.intensity),Ue=(qe={modelview:q.modelviewMatrix,projection:q.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:xe,velocityConeAperture:fe.velocityConeAperture,velocity:fe.velocity,horizontalOscillationRadius:fe.horizontalOscillationRadius,horizontalOscillationRate:fe.horizontalOscillationRate,boxSize:ae,billboardSize:1*fe.billboardSize,simpleShapeParameters:[fe.shapeFadeStart,fe.shapeFadePower],screenSize:[te.width,te.height],thinningCenterPos:[_e,Ee],thinningShape:[Fe,De,Math.pow(10,fe.screenThinning.fadePower)],thinningAffectedRatio:fe.screenThinning.affectedRatio,thinningParticleOffset:Ze,color:[fe.color.r,fe.color.g,fe.color.b,fe.color.a],direction:y},{u_modelview:Float32Array.from(qe.modelview),u_projection:Float32Array.from(qe.projection),u_time:qe.time,u_cam_pos:qe.camPos,u_velocityConeAperture:qe.velocityConeAperture,u_velocity:qe.velocity,u_horizontalOscillationRadius:qe.horizontalOscillationRadius,u_horizontalOscillationRate:qe.horizontalOscillationRate,u_boxSize:qe.boxSize,u_billboardSize:qe.billboardSize,u_simpleShapeParameters:qe.simpleShapeParameters,u_screenSize:qe.screenSize,u_thinningCenterPos:qe.thinningCenterPos,u_thinningShape:qe.thinningShape,u_thinningAffectedRatio:qe.thinningAffectedRatio,u_thinningParticleOffset:qe.thinningParticleOffset,u_particleColor:qe.color,u_direction:qe.direction});var qe;const Ve=Math.round(fe.intensity*this.particlesCount),Ke=i.b7.simpleSegment(0,0,4*Ve,2*Ve);this.particlesVx&&this.particlesIdx&&re.draw(s,Z.TRIANGLES,Lr.disabled,Gr.disabled,xn.alphaBlended,Hr.disabled,Ue,"snow_particles",this.particlesVx,this.particlesIdx,Ke,{})})(u.boxSize,0,u),this._vignette.draw(s,S)}}const yf={symbol:function(g,s,u,y,S){if(g.renderPass!=="translucent")return;const P=Gr.disabled,O=g.colorModeForRenderPass(),D=u.layout.get("text-variable-anchor"),q=u.layout.get("text-size-scale-range"),W=i.aw(g.scaleFactor,q[0],q[1]);D&&function(re,ae,ye,fe,xe,_e,Ee,Fe){const De=ae.transform,Ze=xe==="map",Ue=_e==="map";for(const qe of re){const Ve=fe.getTile(qe),Ke=Ve.getBucket(ye);if(!Ke||!Ke.text||!Ke.text.segments.get().length)continue;const it=i.bp(Ke.textSizeData,De.zoom,Fe),_t=Hc(qe,Ke.getProjection(),De),pt=De.calculatePixelsToTileUnitsMatrix(Ve),Ct=Ka(_t,Ve.tileID.canonical,Ue,Ze,De,Ke.getProjection(),pt),Mt=Ke.hasIconTextFit()&&Ke.hasIconData();if(it){const ut=Math.pow(2,De.zoom-Ve.tileID.overscaledZ);Pp(Ke,Ze,Ue,Ee,i.cX,De,Ct,qe,ut,it,Mt)}}}(y,g,u,s,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),S,W);const Z=u.paint.get("icon-opacity").constantOr(1)!==0,te=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Z||te)?Yu(g,s,u,y,P,O):(Z&&Yu(g,s,u,y,P,O,{onlyIcons:!0}),te&&Yu(g,s,u,y,P,O,{onlyText:!0})),s.map.showCollisionBoxes&&(Xd(g,s,u,y,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Xd(g,s,u,y,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(g,s,u,y){if(g.renderPass!=="translucent")return;const S=u.paint.get("circle-opacity"),P=u.paint.get("circle-stroke-width"),O=u.paint.get("circle-stroke-opacity"),D=u.layout.get("circle-sort-key").constantOr(1)!==void 0,q=u.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(P.constantOr(1)===0||O.constantOr(1)===0))return;const W=g.context,Z=W.gl,te=g.transform,re=g.depthModeForSublayer(0,Lr.ReadOnly),ae=Gr.disabled,ye=g.colorModeForDrapableLayerRenderPass(q),fe=te.projection.name==="globe",xe=[i.at(te.center.lng),i.aA(te.center.lat)],_e=[];for(let Fe=0;Fe<y.length;Fe++){const De=y[Fe],Ze=s.getTile(De),Ue=Ze.getBucket(u);if(!Ue||Ue.projection.name!==te.projection.name)continue;const qe=Ue.programConfigurations.get(u.id),Ve=i.cY(u),Ke=g.isTileAffectedByFog(De);fe&&Ve.push("PROJECTION_GLOBE_VIEW"),Ve.push("DEPTH_D24"),g.terrain&&te.depthOcclusionForSymbolsAndCircles&&Ve.push("DEPTH_OCCLUSION");const it=g.getOrCreateProgram("circle",{config:qe,defines:Ve,overrideFog:Ke}),_t=Ue.layoutVertexBuffer,pt=Ue.globeExtVertexBuffer,Ct=Ue.indexBuffer,Mt=te.projection.createInversionMatrix(te,De.canonical),ut={programConfiguration:qe,program:it,layoutVertexBuffer:_t,globeExtVertexBuffer:pt,indexBuffer:Ct,uniformValues:i.cZ(g,De,Ze,Mt,xe,u),tile:Ze};if(D){const Tt=Ue.segments.get();for(const Bt of Tt)_e.push({segments:new i.b7([Bt]),sortKey:Bt.sortKey,state:ut})}else _e.push({segments:Ue.segments,sortKey:0,state:ut})}D&&_e.sort((Fe,De)=>Fe.sortKey-De.sortKey);const Ee={useDepthForOcclusion:te.depthOcclusionForSymbolsAndCircles};for(const Fe of _e){const{programConfiguration:De,program:Ze,layoutVertexBuffer:Ue,globeExtVertexBuffer:qe,indexBuffer:Ve,uniformValues:Ke,tile:it}=Fe.state,_t=Fe.segments;g.terrain&&g.terrain.setupElevationDraw(it,Ze,Ee),g.uploadCommonUniforms(W,Ze,it.tileID.toUnwrapped()),Ze.draw(g,Z.TRIANGLES,re,ae,ye,Hr.disabled,Ke,u.id,Ue,Ve,_t,u.paint,te.zoom,De,[qe])}},heatmap:function(g,s,u,y){if(u.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const S=g.context,P=S.gl,O=Gr.disabled,D=new xn([P.ONE,P.ONE,P.ONE,P.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(ae,ye,fe,xe){const _e=ae.gl,Ee=ye.width*xe,Fe=ye.height*xe;ae.activeTexture.set(_e.TEXTURE1),ae.viewport.set([0,0,Ee,Fe]);let De=fe.heatmapFbo;if(!De||De&&(De.width!==Ee||De.height!==Fe)){De&&De.destroy();const Ze=_e.createTexture();_e.bindTexture(_e.TEXTURE_2D,Ze),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MAG_FILTER,_e.LINEAR),De=fe.heatmapFbo=ae.createFramebuffer(Ee,Fe,!0,null),function(Ue,qe,Ve,Ke,it,_t){const pt=Ue.gl;pt.texImage2D(pt.TEXTURE_2D,0,Ue.extRenderToTextureHalfFloat?pt.RGBA16F:pt.RGBA,it,_t,0,pt.RGBA,Ue.extRenderToTextureHalfFloat?pt.HALF_FLOAT:pt.UNSIGNED_BYTE,null),Ke.colorAttachment.set(Ve)}(ae,0,Ze,De,Ee,Fe)}else _e.bindTexture(_e.TEXTURE_2D,De.colorAttachment.get()),ae.bindFramebuffer.set(De.framebuffer)})(S,g,u,g.transform.projection.name==="globe"?.5:.25),S.clear({color:i.aj.transparent});const q=g.transform,W=q.projection.name==="globe",Z=W?["PROJECTION_GLOBE_VIEW"]:[],te=W?Hr.frontCCW:Hr.disabled,re=[i.at(q.center.lng),i.aA(q.center.lat)];for(let ae=0;ae<y.length;ae++){const ye=y[ae];if(s.hasRenderableParent(ye))continue;const fe=s.getTile(ye),xe=fe.getBucket(u);if(!xe||xe.projection.name!==q.projection.name)continue;const _e=g.isTileAffectedByFog(ye),Ee=xe.programConfigurations.get(u.id),Fe=g.getOrCreateProgram("heatmap",{config:Ee,defines:Z,overrideFog:_e}),{zoom:De}=g.transform;g.terrain&&g.terrain.setupElevationDraw(fe,Fe),g.uploadCommonUniforms(S,Fe,ye.toUnwrapped());const Ze=q.projection.createInversionMatrix(q,ye.canonical);Fe.draw(g,P.TRIANGLES,Lr.disabled,O,D,te,hr(g,ye,fe,Ze,re,De,u.paint.get("heatmap-intensity")),u.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,u.paint,g.transform.zoom,Ee,W?[xe.globeExtVertexBuffer]:null)}S.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(S,P){const O=S.context,D=O.gl,q=P.heatmapFbo;if(!q)return;O.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,q.colorAttachment.get()),O.activeTexture.set(D.TEXTURE1);let W=P.colorRampTexture;W||(W=P.colorRampTexture=new i.T(O,P.colorRamp,D.RGBA8)),W.bind(D.LINEAR,D.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,D.TRIANGLES,Lr.disabled,Gr.disabled,S.colorModeForRenderPass(),Hr.disabled,((Z,te,re,ae)=>({u_image:0,u_color_ramp:1,u_opacity:te.paint.get("heatmap-opacity")}))(0,P),P.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,P.paint,S.transform.zoom)}(g,u))},line:function(g,s,u,y){if(g.renderPass!=="translucent")return;const S=u.paint.get("line-opacity"),P=u.paint.get("line-width");if(S.constantOr(1)===0||P.constantOr(1)===0)return;const O=u.paint.get("line-emissive-strength"),D=u.paint.get("line-occlusion-opacity"),q=u.layout.get("line-elevation-reference"),W=u.layout.get("line-width-unit")==="meters",Z=q==="sea",te=g.context,re=te.gl;if(u.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const ae=u.layout.get("line-cross-slope"),ye=ae!==void 0,fe=ae<1,xe=g.colorModeForDrapableLayerRenderPass(O),_e=g.terrain&&g.terrain.renderingToTexture,Ee=_e?1:i.q.devicePixelRatio,Fe=u.paint.get("line-dasharray"),De=Fe.constantOr(1),Ze=u.layout.get("line-cap"),Ue=Fe.constantOr(null),qe=Ze.constantOr(null),Ve=u.paint.get("line-pattern"),Ke=Ve.constantOr(1),it=Ve.constantOr(null),_t=u.paint.get("line-opacity").constantOr(1);let pt=!Ke&&_t!==1||g.depthOcclusion&&D>0&&D<1;const Ct=u.paint.get("line-gradient"),Mt=Ke?"linePattern":"line",ut=i.c_(u);let Tt;if(_e&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(pt=!1),D!==0&&g.depthOcclusion){const ft=u.paint._values["line-opacity"];ft&&ft.value&&ft.value.kind==="constant"?Tt=ft.value:i.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}P.value.kind!=="constant"&&P.value.isLineProgressConstant===!1&&ut.push("VARIABLE_LINE_WIDTH");const Bt=(ft,Dt,Pt,Zt,zt)=>{for(const Nt of ft){const qt=s.getTile(Nt);if(Ke&&!qt.patternsLoaded())continue;const er=qt.getBucket(u);if(!er||er.hasZOffset&&!zt||!er.hasZOffset&&zt)continue;g.prepareDrawTile();const fr=er.programConfigurations.get(u.id),mr=g.isTileAffectedByFog(Nt),$r=g.getOrCreateProgram(Mt,{config:fr,defines:Dt,overrideFog:mr,overrideRtt:!zt&&void 0});if(it&&qt.imageAtlas){const Zr=i.A.from(it).getPrimary().scaleSelf(Ee).serialize(),_n=qt.imageAtlas.patternPositions[Zr];_n&&fr.setConstantPatternPositions(_n)}if(!Ke&&Ue&&qe&&qt.lineAtlas){const Zr=qt.lineAtlas.getDash(Ue,qe);Zr&&fr.setConstantPatternPositions(Zr)}let[Or,jr]=u.paint.get("line-trim-offset");(qe==="round"||qe==="square")&&Or!==jr&&(Or===0&&(Or-=1),jr===1&&(jr+=1));const Wr=_e?Nt.projMatrix:null,Mn=W?1/er.tileToMeter/i.ar(qt,1,g.transform.zoom):1,hi=W?1/er.tileToMeter/i.ar(qt,1,Math.floor(g.transform.zoom)):1,Gi=Ke?i.c$(g,qt,u,Wr,Ee,Mn,hi,[Or,jr]):i.d0(g,qt,u,Wr,er.lineClipsArray.length,Ee,Mn,hi,[Or,jr]);if(Ct){const Zr=er.gradients[u.id];let _n=Zr.texture;if(u.gradientVersion!==Zr.version){let xr=256;if(u.stepInterpolant){const En=s.getSource().maxzoom,ei=Nt.canonical.z===En?Math.ceil(1<<g.transform.maxZoom-Nt.canonical.z):1;xr=i.aw(i.d1(er.maxLineLength/i.ag*1024*ei),256,te.maxTextureSize)}Zr.gradient=i.d2({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:xr,image:Zr.gradient||void 0,clips:er.lineClipsArray}),Zr.texture?Zr.texture.update(Zr.gradient):Zr.texture=new i.T(te,Zr.gradient,re.RGBA8),Zr.version=u.gradientVersion,_n=Zr.texture}te.activeTexture.set(re.TEXTURE1),_n.bind(u.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}De&&(te.activeTexture.set(re.TEXTURE0),qt.lineAtlasTexture&&qt.lineAtlasTexture.bind(re.LINEAR,re.REPEAT),fr.updatePaintBuffers()),Ke&&(te.activeTexture.set(re.TEXTURE0),qt.imageAtlasTexture&&qt.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),fr.updatePaintBuffers()),zt&&!Z&&g.terrain.setupElevationDraw(qt,$r),g.uploadCommonUniforms(te,$r,Nt.toUnwrapped());const Yn=Zr=>{Tt!=null&&(Tt.value=_t*D),$r.draw(g,re.TRIANGLES,Pt,Zr,xe,Hr.disabled,Gi,u.id,er.layoutVertexBuffer,er.indexBuffer,er.segments,u.paint,g.transform.zoom,fr,[er.layoutVertexBuffer2,er.patternVertexBuffer,er.zOffsetVertexBuffer]),Tt!=null&&(Tt.value=_t)};if(pt&&!zt){const Zr=g.stencilModeForClipping(Nt).ref;Zr===0&&_e&&te.clear({stencil:0});const _n={func:re.EQUAL,mask:255};Gi.u_alpha_discard_threshold=.8,Yn(new Gr(_n,Zr,255,re.KEEP,re.KEEP,re.INVERT)),Gi.u_alpha_discard_threshold=0,Yn(new Gr(_n,Zr,255,re.KEEP,re.KEEP,re.KEEP))}else pt&&zt&&(Gi.u_alpha_discard_threshold=.001),Yn(zt?Zt:g.stencilModeForClipping(Nt))}};if(u.hasNonElevatedBuckets){const ft=!_e&&g.terrain;D!==0&&ft?i.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):ft?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):Bt(y,ut,g.depthModeForSublayer(0,Lr.ReadOnly),Gr.disabled,!1)}if(u.hasElevatedBuckets){ut.push("ELEVATED"),ye&&ut.push(fe?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Z&&ut.push("ELEVATION_REFERENCE_SEA");const ft=pt?g.stencilModeFor3D():Gr.disabled,Dt=new Lr(g.depthOcclusion?re.GREATER:re.LEQUAL,Lr.ReadOnly,g.depthRangeFor3D);g.forceTerrainMode=!0,Bt(y,ut,Dt,ft,!0),g.forceTerrainMode=!1}pt&&(g.resetStencilClippingMasks(),_e&&te.clear({stencil:0})),D===0||g.depthOcclusion||_e||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,s,u,y){const S=u.paint.get("fill-color"),P=u.paint.get("fill-opacity"),O=u.is3D(),D=new Lr(g.context.gl.LEQUAL,Lr.ReadWrite,g.depthRangeFor3D);if(P.constantOr(1)===0)return;const q=u.paint.get("fill-emissive-strength"),W=g.colorModeForDrapableLayerRenderPass(q),Z=u.paint.get("fill-pattern"),te=g.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&S.constantOr(i.aj.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===te){const re=O?D:g.depthModeForSublayer(1,g.renderPass==="opaque"?Lr.ReadWrite:Lr.ReadOnly);Xu(g,s,u,y,re,W,!1)}if(!O&&g.renderPass==="translucent"&&u.paint.get("fill-antialias")){const re=O?D:g.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,Lr.ReadOnly);Xu(g,s,u,y,re,W,!0)}},"fill-extrusion":function(g,s,u,y){const S=u.paint.get("fill-extrusion-opacity"),P=g.context,O=P.gl,D=g.terrain,q=D&&D.renderingToTexture;if(S===0)return;const W=g.conflationActive&&g.style.isLayerClipped(u,s.getSource()),Z=g.style.order.indexOf(u.fqid);if(W&&function(te,re,ae,ye,fe){for(const xe of ye){const _e=re.getTile(xe).getBucket(ae);_e&&(_e.updateReplacement(xe,te.replacementSource,fe),_e.uploadCentroid(te.context))}}(g,s,u,y,Z),D||W)for(const te of y){const re=s.getTile(te).getBucket(u);re&&Qu(g.context,s,te,re,u,D,W)}if(g.renderPass==="shadow"&&g.shadowRenderer){const te=g.shadowRenderer;if(D&&S<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const re=te.getShadowPassDepthMode(),ae=te.getShadowPassColorMode();Qd(g,s,u,y,re,Gr.disabled,ae,W)}else if(g.renderPass==="translucent"){const te=!u.paint.get("fill-extrusion-pattern").constantOr(1),re=u.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!q&&re.a!==0){const ae=new Lr(g.context.gl.LEQUAL,Lr.ReadWrite,g.depthRangeFor3D);S===1&&te?Qd(g,s,u,y,ae,Gr.disabled,xn.unblended,W):(Qd(g,s,u,y,ae,Gr.disabled,xn.disabled,W),Qd(g,s,u,y,ae,g.stencilModeFor3D(),g.colorModeForRenderPass(),W),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&te&&(!D&&g.transform.projection.name!=="globe"||q)){const ae=u.paint.get("fill-extrusion-opacity"),ye=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),fe=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),xe=u.paint.get("fill-extrusion-flood-light-intensity"),_e=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ee=u.paint.get("fill-extrusion-flood-light-color").toRenderColor(_e?null:u.lut).toArray01().slice(0,3),Fe=ye>0&&fe>0,De=xe>0,Ze=(qe,Ve,Ke)=>(1-Ke)*qe+Ke*Ve,Ue=qe=>{const Ve=g.depthModeForSublayer(1,Lr.ReadOnly,O.LEQUAL,!0),Ke=u.paint.get(qe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),it=Ze(.1,3,Ke),_t=g._showOverdrawInspector;if(!_t){const pt=new Gr({func:O.ALWAYS,mask:255},255,255,O.KEEP,O.KEEP,O.REPLACE),Ct=new xn([O.ONE,O.ONE,O.ONE,O.ONE],i.aj.transparent,[!1,!1,!1,!0],O.MIN);Ju(g,s,u,y,Ve,pt,Ct,Hr.disabled,qe,"sdf",ae,ye,fe,xe,Ee,it,W,!1)}{const pt=_t?Gr.disabled:new Gr({func:O.EQUAL,mask:255},255,255,O.KEEP,O.DECR,O.DECR),Ct=_t?g.colorModeForRenderPass():new xn([O.ONE_MINUS_DST_ALPHA,O.DST_ALPHA,O.ONE,O.ONE],i.aj.transparent,[!0,!0,!0,!0]);Ju(g,s,u,y,Ve,pt,Ct,Hr.disabled,qe,"color",ae,ye,fe,xe,Ee,it,W,!1)}};if(q){const qe=(Ve,Ke,it)=>{const _t=g.depthModeForSublayer(1,Lr.ReadOnly,O.LEQUAL,!1),pt=u.paint.get(Ve?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ct=Ze(.1,3,pt);{const Mt=new xn([O.ONE,O.ONE,O.ONE,O.ONE],i.aj.transparent,[!1,!1,!1,!0]);Ju(g,s,u,y,_t,Gr.disabled,Mt,Hr.disabled,Ve,"clear",ae,ye,fe,xe,Ee,Ct,W,Ke)}{const Mt=new Gr({func:O.ALWAYS,mask:255},255,255,O.KEEP,O.KEEP,O.REPLACE),ut=new xn([O.ONE,O.ONE,O.ONE,O.ONE],i.aj.transparent,[!1,!1,!1,!0],O.MIN);Ju(g,s,u,y,_t,Mt,ut,Hr.disabled,Ve,"sdf",ae,ye,fe,xe,Ee,Ct,W,Ke)}{const Mt=Ve?O.ZERO:O.ONE_MINUS_DST_ALPHA,ut=new Gr({func:O.EQUAL,mask:255},255,255,O.KEEP,O.DECR,O.DECR),Tt=new xn([Mt,O.DST_ALPHA,O.ONE_MINUS_DST_ALPHA,O.ZERO],i.aj.transparent,[!0,!0,!0,!0]);Ju(g,s,u,y,_t,ut,Tt,Hr.disabled,Ve,"color",ae,ye,fe,xe,Ee,Ct,W,Ke)}{const Mt=new xn([O.ONE,O.ONE,O.ONE,Ve?O.ZERO:O.ONE],i.aj.transparent,[!1,!1,!1,!0],Ve?O.FUNC_ADD:O.MAX);Ju(g,s,u,y,_t,Gr.disabled,Mt,Hr.disabled,Ve,"clear",ae,ye,fe,xe,Ee,Ct,W,Ke,it)}};if(Fe||De){let Ve;if(g.prepareDrawTile(),D){const Ke=D.drapeBufferSize[0],it=D.drapeBufferSize[1];Ve=D.framebufferCopyTexture,Ve&&(!Ve||Ve.size[0]===Ke&&Ve.size[1]===it)||(Ve&&Ve.destroy(),Ve=D.framebufferCopyTexture=new i.T(P,new i.r({width:Ke,height:it}),O.RGBA8)),Ve.bind(O.LINEAR,O.CLAMP_TO_EDGE),O.copyTexSubImage2D(O.TEXTURE_2D,0,0,0,0,0,Ke,it)}Fe&&qe(!0,!1,Ve),De&&qe(!1,!0,Ve)}}else Fe&&Ue(!0),De&&Ue(!1),(Fe||De)&&g.resetStencilClippingMasks()}}},hillshade:function(g,s,u,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const S=g.context,P=g.terrain&&g.terrain.renderingToTexture,[O,D]=g.renderPass!=="translucent"||P?[{},y]:g.stencilConfigForOverlap(y);for(const q of D){const W=s.getTile(q);if(W.needsHillshadePrepare&&g.renderPass==="offscreen")yp(g,W,u);else if(g.renderPass==="translucent"){const Z=g.depthModeForSublayer(0,Lr.ReadOnly),te=u.paint.get("hillshade-emissive-strength"),re=g.colorModeForDrapableLayerRenderPass(te),ae=P&&g.terrain?g.terrain.stencilModeForRTTOverlap(q):O[q.overscaledZ];o_(g,q,W,u,Z,ae,re)}}S.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,s,u,y,S,P){if(g.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const O=g.transform.projection.name==="globe",D=u.paint.get("raster-elevation")!==0,q=D&&O;if(g.renderElevatedRasterBackface&&!q)return;const W=g.context,Z=W.gl,te=s.getSource(),re=function(Ue,qe,Ve,Ke){const it=qe.paint.get("raster-color"),_t=Ue.type==="raster-array",pt=[],Ct=qe.paint.get("raster-resampling"),Mt=qe.paint.get("raster-color-mix");let ut=qe.paint.get("raster-color-range");const Tt=[Mt[0],Mt[1],Mt[2],0],Bt=Mt[3];let ft=Ct==="nearest"?Ke.NEAREST:Ke.LINEAR;if(_t&&(pt.push("RASTER_ARRAY"),it||pt.push("RASTER_COLOR"),Ct==="linear"&&pt.push("RASTER_ARRAY_LINEAR"),ft=Ke.NEAREST,!ut&&Ue.rasterLayers)){const Dt=Ue.rasterLayers.find(({id:Pt})=>Pt===qe.sourceLayer);Dt&&Dt.fields&&Dt.fields.range&&(ut=Dt.fields.range)}if(ut=ut||[0,1],it){pt.push("RASTER_COLOR"),Ve.activeTexture.set(Ke.TEXTURE2),qe.updateColorRamp(ut);let Dt=qe.colorRampTexture;Dt||(Dt=qe.colorRampTexture=new i.T(Ve,qe.colorRamp,Ke.RGBA8)),Dt.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE)}return{mix:Tt,range:ut,offset:Bt,defines:pt,resampling:ft}}(te,u,W,Z);if(te instanceof i.aJ&&!y.length&&!O)return;const ae=u.paint.get("raster-emissive-strength"),ye=g.colorModeForDrapableLayerRenderPass(ae),fe=g.terrain&&g.terrain.renderingToTexture,xe=!g.options.moving,_e=u.paint.get("raster-resampling")==="nearest"?Z.NEAREST:Z.LINEAR;if(te instanceof i.aJ&&!y.length&&(te.onNorthPole||te.onSouthPole)){const Ue=D?g.stencilModeFor3D():Gr.disabled;return void vt(!!te.onNorthPole,null,g,s,u,ae,re,Hr.disabled,Ue)}if(!y.length)return;const[Ee,Fe]=te instanceof i.aJ||fe?[{},y]:g.stencilConfigForOverlap(y),De=Fe[Fe.length-1].overscaledZ;q&&re.defines.push("PROJECTION_GLOBE_VIEW"),D&&re.defines.push("RENDER_CUTOFF");const Ze=(Ue,qe,Ve)=>{for(const Ke of Ue){const it=Ke.toUnwrapped(),_t=s.getTile(Ke);if(fe&&(!_t||!_t.hasData()))continue;W.activeTexture.set(Z.TEXTURE0);const pt=Zl(_t,te,u,re);if(!pt||!pt.texture)continue;const{texture:Ct,mix:Mt,offset:ut,tileSize:Tt,buffer:Bt}=pt;let ft,Dt;fe?(ft=Lr.disabled,Dt=Ke.projMatrix):D?(ft=new Lr(Z.LEQUAL,Lr.ReadWrite,g.depthRangeFor3D),Dt=O?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(it,xe)):(ft=g.depthModeForSublayer(Ke.overscaledZ-De,u.paint.get("raster-opacity")===1?Lr.ReadWrite:Lr.ReadOnly,Z.LESS),Dt=g.transform.calculateProjMatrix(it,xe));const Pt=g.terrain&&fe?g.terrain.stencilModeForRTTOverlap(Ke):Ee[Ke.overscaledZ],Zt=P?0:u.paint.get("raster-fade-duration");_t.registerFadeDuration(Zt);const zt=s.findLoadedParent(Ke,0),Nt=Cl(_t,zt,s,g.transform,Zt);let qt,er;g.terrain&&g.terrain.prepareDrawTile(),W.activeTexture.set(Z.TEXTURE0),Ct.bind(_e,Z.CLAMP_TO_EDGE),W.activeTexture.set(Z.TEXTURE1),zt?(zt.texture&&zt.texture.bind(_e,Z.CLAMP_TO_EDGE),qt=Math.pow(2,zt.tileID.overscaledZ-_t.tileID.overscaledZ),er=[_t.tileID.canonical.x*qt%1,_t.tileID.canonical.y*qt%1]):Ct.bind(_e,Z.CLAMP_TO_EDGE),Ct.useMipmap&&W.extTextureFilterAnisotropic&&g.transform.pitch>20&&Z.texParameterf(Z.TEXTURE_2D,W.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,W.extTextureFilterAnisotropicMax);const fr=g.transform;let mr;const $r=D?Sc(fr):[0,0,0,0];let Or,jr,Wr,Mn,hi,Gi=0;if(q&&te instanceof i.aJ&&te.coordinates.length>3)Or=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),jr=Float32Array.from(fr.globeMatrix),Wr=Float32Array.from(i.cD(fr)),Mn=[i.at(fr.center.lng),i.aA(fr.center.lat)],mr=te.elevatedGlobePerspectiveTransform,hi=te.elevatedGlobeGridMatrix||new Float32Array(9);else if(q){const xr=i.cE(Ke.canonical);Gi=i.cF(xr.getCenter().lat),Or=Float32Array.from(i.bb(i.cH(Ke.canonical))),jr=Float32Array.from(fr.globeMatrix),Wr=Float32Array.from(i.cD(fr)),Mn=[i.at(fr.center.lng),i.aA(fr.center.lat)],mr=[0,0],hi=Float32Array.from(i.cG(Ke.canonical,xr,Gi,fr.worldSize/fr._pixelsPerMercatorPixel))}else mr=te instanceof i.aJ?te.perspectiveTransform:[0,0],Or=new Float32Array(16),jr=new Float32Array(9),Wr=new Float32Array(16),Mn=[0,0],hi=new Float32Array(9);const Yn=os(Dt,Or,jr,Wr,hi,er||[0,0],i.ae(g.transform.zoom),Mn,$r,qt||1,Nt,u,mr,D?u.paint.get("raster-elevation"):0,2,Mt,ut,re.range,Tt,Bt,ae),Zr=g.isTileAffectedByFog(Ke),_n=g.getOrCreateProgram("raster",{defines:re.defines,overrideFog:Zr});if(g.uploadCommonUniforms(W,_n,it),te instanceof i.aJ){const xr=te.elevatedGlobeVertexBuffer,En=te.elevatedGlobeIndexBuffer;if(fe||!O)te.boundsBuffer&&te.boundsSegments&&_n.draw(g,Z.TRIANGLES,ft,Gr.disabled,ye,Hr.disabled,Yn,u.id,te.boundsBuffer,g.quadTriangleIndexBuffer,te.boundsSegments);else if(xr&&En){const ei=fr.zoom<=i.c6?te.elevatedGlobeSegments:te.getSegmentsForLongitude(fr.center.lng);ei&&_n.draw(g,Z.TRIANGLES,ft,Gr.disabled,ye,qe,Yn,u.id,xr,En,ei)}}else if(q){ft=new Lr(Z.LEQUAL,Lr.ReadOnly,g.depthRangeFor3D);const xr=g.globeSharedBuffers;if(xr){const[En,ei,oi]=xr.getGridBuffers(Gi,!1);_n.draw(g,Z.TRIANGLES,ft,Ve||Pt,g.colorModeForRenderPass(),qe,Yn,u.id,En,ei,oi)}}else{const{tileBoundsBuffer:xr,tileBoundsIndexBuffer:En,tileBoundsSegments:ei}=g.getTileBoundsBuffers(_t);_n.draw(g,Z.TRIANGLES,ft,Pt,ye,Hr.disabled,Yn,u.id,xr,En,ei)}}if(!(te instanceof i.aJ)&&q)for(const Ke of Ue){const it=Ke.canonical.y===(1<<Ke.canonical.z)-1;Ke.canonical.y===0&&vt(!0,Ke,g,s,u,ae,re,qe,Ve||Gr.disabled),it&&vt(!1,Ke,g,s,u,ae,re,qe===Hr.frontCW?Hr.backCW:Hr.frontCW,Ve||Gr.disabled)}};q?Ze(Fe,g.renderElevatedRasterBackface?Hr.backCW:Hr.frontCW,g.stencilModeFor3D()):Ze(Fe,Hr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,s,u,y,S,P){g.renderPass==="offscreen"&&function(O,D,q,W){if(!W.length)return;const Z=O.context,te=Z.gl,re=D.getSource();if(!(re instanceof Ga))return;const ae=Math.ceil(Math.sqrt(q.paint.get("raster-particle-count")));let ye=q.particlePositionRGBAImage;if(!ye||ye.width!==ae){const Fe=function(De){const Ze=De*De,Ue=new Uint8Array(4*Ze),qe=function(Ke){return Ke|=0,Ke=Math.imul(2747636419^Ke,2654435769),Ke=Math.imul(Ke^Ke>>>16,2654435769),((Ke=Math.imul(Ke^Ke>>>16,2654435769))>>>0)/4294967296},Ve=1/1.1;for(let Ke=0;Ke<Ze;Ke++){const it=Ve*(qe(2*Ke+0)+Cr),_t=Ve*(qe(2*Ke+1)+Cr),pt=255*it%1,Ct=255*_t%1,Mt=pt,ut=_t-Ct/255,Tt=Ct;Ue[4*Ke+0]=255*(it-pt/255),Ue[4*Ke+1]=255*Mt,Ue[4*Ke+2]=255*ut,Ue[4*Ke+3]=255*Tt}return Ue}(ae);ye=q.particlePositionRGBAImage=new i.r({width:ae,height:ae},Fe)}let fe=q.particleFramebuffer;fe?fe.width!==ae&&(fe.destroy(),fe=q.particleFramebuffer=Z.createFramebuffer(ae,ae,!0,null)):fe=q.particleFramebuffer=Z.createFramebuffer(ae,ae,!0,null);const xe=[];for(const Fe of W){const De=D.getTile(Fe);if(!(De instanceof qc))continue;const Ze=Ac(De,re,q);if(!Ze)continue;const Ue=[De.tileSize,De.tileSize];let qe=q.tileFramebuffer;qe||(qe=q.tileFramebuffer=Z.createFramebuffer(Ue[0],Ue[1],!0,null));let Ve=De.rasterParticleState;Ve||(Ve=De.rasterParticleState=new Ty(Z,Fe,Ue,ye));const Ke=Ve.update(q.lastInvalidatedAt);Ve.particleTextureDimension!==ae&&Ve.updateParticleTexture(Fe,ye);const it=Ve.targetColorTexture;Ve.targetColorTexture=Ve.backgroundColorTexture,Ve.backgroundColorTexture=it;const _t=Ve.particleTexture0;Ve.particleTexture0=Ve.particleTexture1,Ve.particleTexture1=_t,xe.push([Fe,Ze,Ve,Ke])}if(xe.length===0)return;const _e=i.q.now(),Ee=q.previousDrawTimestamp?.001*(_e-q.previousDrawTimestamp):.0167;if(q.previousDrawTimestamp=_e,q.hasColorMap()){Z.activeTexture.set(te.TEXTURE0+2);let Fe=q.colorRampTexture;Fe||(Fe=q.colorRampTexture=new i.T(Z,q.colorRamp,te.RGBA8)),Fe.bind(te.LINEAR,te.CLAMP_TO_EDGE)}Z.bindFramebuffer.set(q.tileFramebuffer.framebuffer),function(Fe,De,Ze){const Ue=Fe.context,qe=Ue.gl,Ve=De.tileFramebuffer;Ue.activeTexture.set(qe.TEXTURE0);const Ke={u_texture:0,u_opacity:1.05*(_t=De.paint.get("raster-particle-fade-opacity-factor"))/(_t+.05)},it=Fe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var _t;for(const pt of Ze){const[,,Ct,Mt]=pt;Ve.colorAttachment.set(Ct.targetColorTexture.texture),Ue.viewport.set([0,0,Ve.width,Ve.height]),Ue.clear({color:i.aj.transparent}),Mt&&(Ct.backgroundColorTexture.bind(qe.NEAREST,qe.CLAMP_TO_EDGE),it.draw(Fe,qe.TRIANGLES,Lr.disabled,Gr.disabled,xn.alphaBlended,Hr.disabled,Ke,De.id,Fe.viewportBuffer,Fe.quadTriangleIndexBuffer,Fe.viewportSegments))}}(O,q,xe),function(Fe,De,Ze,Ue){const qe=Fe.context,Ve=qe.gl,Ke=Ze.tileFramebuffer,it=Fe.transform.projection.name==="globe",_t=Ze.paint.get("raster-particle-max-speed");for(const pt of Ue){const[Ct,Mt,ut]=pt;qe.activeTexture.set(Ve.TEXTURE0+0),Mt.texture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),Ke.colorAttachment.set(ut.targetColorTexture.texture);const Tt=Fe.getOrCreateProgram("rasterParticleDraw",{defines:Mt.defines,overrideFog:!1});qe.activeTexture.set(Ve.TEXTURE0+1);const Bt=Mt.scalarData?[]:[0,1,2,3].map(Pt=>i.d4[Pt](Ct));Bt.push(Ct);const ft=Ct.canonical.x,Dt=Ct.canonical.y;for(const Pt of Bt){const Zt=De.getTile(it?Pt.wrapped():Pt);if(!Zt)continue;const zt=Zt.rasterParticleState;if(!zt)continue;const Nt=Pt.canonical.x+(1<<Pt.canonical.z)*(Pt.wrap-Ct.wrap),qt=Pt.canonical.y;zt.particleTexture0.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE);const er=wy(1,zt.particleTexture0.size[0],[Nt-ft,qt-Dt],0,Mt.texture.size,2,_t,Mt.textureOffset,Mt.scale,Mt.offset);Tt.draw(Fe,Ve.POINTS,Lr.disabled,Gr.disabled,xn.alphaBlended,Hr.disabled,er,Ze.id,zt.particleIndexBuffer,void 0,zt.particleSegment)}}}(O,D,q,xe),Z.bindFramebuffer.set(q.particleFramebuffer.framebuffer),function(Fe,De,Ze,Ue){const qe=Fe.context,Ve=qe.gl,Ke=De.paint.get("raster-particle-max-speed"),it=Ue*De.paint.get("raster-particle-speed-factor")*.15,_t=function(Ct){return Math.pow(Ct,6)}(.01+1*De.paint.get("raster-particle-reset-rate-factor")),pt=De.particleFramebuffer;qe.viewport.set([0,0,pt.width,pt.height]);for(const Ct of Ze){const[,Mt,ut]=Ct;qe.activeTexture.set(Ve.TEXTURE0+0),Mt.texture.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),qe.activeTexture.set(Ve.TEXTURE0+1);const Tt=ut.particleTexture0;Tt.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE);const Bt=ul(1,Tt.size[0],0,Mt.texture.size,Ke,it,_t,Mt.textureOffset,Mt.scale,Mt.offset);pt.colorAttachment.set(ut.particleTexture1.texture),qe.clear({color:i.aj.transparent}),Fe.getOrCreateProgram("rasterParticleUpdate",{defines:Mt.defines}).draw(Fe,Ve.TRIANGLES,Lr.disabled,Gr.disabled,xn.unblended,Hr.disabled,Bt,De.id,Fe.viewportBuffer,Fe.quadTriangleIndexBuffer,Fe.viewportSegments)}}(O,q,xe,Ee)}(g,s,u,y),g.renderPass==="translucent"&&(function(O,D,q,W,Z){const te=O.context,re=te.gl,ae=D.getSource().tileSize,ye=5*(1-i.ac(i.bY,i.bY+1,O.transform.zoom))*ae+q.paint.get("raster-particle-elevation"),fe=!O.options.moving,xe=O.transform.projection.name==="globe";if(!W.length)return;const[_e,Ee]=O.stencilConfigForOverlap(W),Fe=[];xe&&Fe.push("PROJECTION_GLOBE_VIEW");const De=O.stencilModeFor3D();for(const Ze of Ee){const Ue=Ze.toUnwrapped(),qe=D.getTile(Ze);if(!qe.rasterParticleState)continue;const Ve=qe.rasterParticleState,Ke=100;qe.registerFadeDuration(Ke);const it=D.findLoadedParent(Ze,0),_t=Cl(qe,it,D,O.transform,Ke);let pt,Ct;O.terrain&&O.terrain.prepareDrawTile(),te.activeTexture.set(re.TEXTURE0),Ve.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),te.activeTexture.set(re.TEXTURE1),it&&it.rasterParticleState?(it.rasterParticleState.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),pt=Math.pow(2,it.tileID.overscaledZ-qe.tileID.overscaledZ),Ct=[qe.tileID.canonical.x*pt%1,qe.tileID.canonical.y*pt%1]):Ve.targetColorTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE);const Mt=xe?Float32Array.from(O.transform.expandedFarZProjMatrix):O.transform.calculateProjMatrix(Ue,fe),ut=O.transform,Tt=nu(ut),Bt=i.cE(Ze.canonical),ft=i.cF(Bt.getCenter().lat);let Dt,Pt,Zt,zt,Nt;xe?(Dt=Float32Array.from(i.bb(i.cH(Ze.canonical))),Pt=Float32Array.from(ut.globeMatrix),Zt=Float32Array.from(i.cD(ut)),zt=[i.at(ut.center.lng),i.aA(ut.center.lat)],Nt=Float32Array.from(i.cG(Ze.canonical,Bt,ft,ut.worldSize/ut._pixelsPerMercatorPixel))):(Dt=new Float32Array(16),Pt=new Float32Array(9),Zt=new Float32Array(16),zt=[0,0],Nt=new Float32Array(9));const qt=Ap(Mt,Dt,Pt,Zt,Nt,Ct||[0,0],i.ae(O.transform.zoom),zt,Tt,pt||1,_t,ye),er=O.isTileAffectedByFog(Ze),fr=O.getOrCreateProgram("rasterParticle",{defines:Fe,overrideFog:er});if(O.uploadCommonUniforms(te,fr,Ue),xe){const mr=new Lr(re.LEQUAL,Lr.ReadOnly,O.depthRangeFor3D),$r=0,Or=O.globeSharedBuffers;if(Or){const[jr,Wr,Mn]=Or.getGridBuffers(ft,$r!==0);fr.draw(O,re.TRIANGLES,mr,De,xn.alphaBlended,O.renderElevatedRasterBackface?Hr.frontCCW:Hr.backCCW,qt,q.id,jr,Wr,Mn)}}else{const mr=O.depthModeForSublayer(0,Lr.ReadOnly),$r=_e[Ze.overscaledZ],{tileBoundsBuffer:Or,tileBoundsIndexBuffer:jr,tileBoundsSegments:Wr}=O.getTileBoundsBuffers(qe);fr.draw(O,re.TRIANGLES,mr,$r,xn.alphaBlended,Hr.disabled,qt,q.id,Or,jr,Wr)}}O.resetStencilClippingMasks()}(g,s,u,y),g.style.map.triggerRepaint())},background:function(g,s,u,y){const S=u.paint.get("background-color"),P=u.paint.get("background-color-use-theme").constantOr("default")==="none",O=u.paint.get("background-opacity"),D=u.paint.get("background-emissive-strength"),q=u.paint.get("background-pitch-alignment")==="viewport";if(O===0)return;const W=g.context,Z=W.gl,te=g.transform,re=te.tileSize,ae=u.paint.get("background-pattern");let ye;if(ae!==void 0&&(ae===null||(ye=g.imageManager.getPattern(ae.toString(),u.scope,g.style.getLut(u.scope)),!ye)))return;const fe=!ae&&S.a===1&&O===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==fe)return;const xe=Gr.disabled,_e=g.depthModeForSublayer(0,fe==="opaque"?Lr.ReadWrite:Lr.ReadOnly),Ee=g.colorModeForDrapableLayerRenderPass(D),Fe=ae?"backgroundPattern":"background";let De,Ze=y;if(Ze||(De=g.getBackgroundTiles(),Ze=Object.values(De).map(Ue=>Ue.tileID)),ae&&(W.activeTexture.set(Z.TEXTURE0),g.imageManager.bind(g.context,u.scope)),q){const Ue=g.getOrCreateProgram(Fe,{overrideFog:!1,overrideRtt:!0}),qe=new Float32Array(i.ab.mat4.identity([])),Ve=new i.aG(0,0,0,0,0),Ke=ae?Sy(qe,D,O,g,0,u.scope,ye,q,{tileID:Ve,tileSize:re}):dl(qe,D,O,S.toRenderColor(P?null:u.lut));Ue.draw(g,Z.TRIANGLES,_e,xe,Ee,Hr.disabled,Ke,u.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const Ue of Ze){const qe=g.isTileAffectedByFog(Ue),Ve=g.getOrCreateProgram(Fe,{overrideFog:qe}),Ke=Ue.toUnwrapped(),it=y?Ue.projMatrix:g.transform.calculateProjMatrix(Ke);g.prepareDrawTile();const _t=s?s.getTile(Ue):De?De[Ue.key]:new hc(Ue,re,te.zoom,g),pt=ae?Sy(it,D,O,g,0,u.scope,ye,q,{tileID:Ue,tileSize:re}):dl(it,D,O,S.toRenderColor(P?null:u.lut));g.uploadCommonUniforms(W,Ve,Ke);const{tileBoundsBuffer:Ct,tileBoundsIndexBuffer:Mt,tileBoundsSegments:ut}=g.getTileBoundsBuffers(_t);Ve.draw(g,Z.TRIANGLES,_e,xe,Ee,Hr.disabled,pt,u.id,Ct,Mt,ut)}},sky:function(g,s,u){const y=g._atmosphere?i.ae(g.transform.zoom):1,S=u.paint.get("sky-opacity")*y;if(S===0)return;const P=g.context,O=u.paint.get("sky-type"),D=new Lr(P.gl.LEQUAL,Lr.ReadOnly,[0,1]),q=g.frameCounter/1e3%1;O==="atmosphere"?g.renderPass==="offscreen"?u.needsSkyboxCapture(g)&&(function(W,Z,te,re){const ae=W.context,ye=ae.gl;let fe=Z.skyboxFbo;if(!fe){fe=Z.skyboxFbo=ae.createFramebuffer(32,32,!0,null),Z.skyboxGeometry=new Gm(ae),Z.skyboxTexture=ae.gl.createTexture(),ye.bindTexture(ye.TEXTURE_CUBE_MAP,Z.skyboxTexture),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_S,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_WRAP_T,ye.CLAMP_TO_EDGE),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MIN_FILTER,ye.LINEAR),ye.texParameteri(ye.TEXTURE_CUBE_MAP,ye.TEXTURE_MAG_FILTER,ye.LINEAR);for(let Fe=0;Fe<6;++Fe)ye.texImage2D(ye.TEXTURE_CUBE_MAP_POSITIVE_X+Fe,0,ye.RGBA,32,32,0,ye.RGBA,ye.UNSIGNED_BYTE,null)}ae.bindFramebuffer.set(fe.framebuffer),ae.viewport.set([0,0,32,32]);const xe=Z.getCenter(W,!0),_e=W.getOrCreateProgram("skyboxCapture"),Ee=new Float64Array(16);i.ab.mat4.identity(Ee),i.ab.mat4.rotateY(Ee,Ee,.5*-Math.PI),fi(W,Z,_e,Ee,xe,0),i.ab.mat4.identity(Ee),i.ab.mat4.rotateY(Ee,Ee,.5*Math.PI),fi(W,Z,_e,Ee,xe,1),i.ab.mat4.identity(Ee),i.ab.mat4.rotateX(Ee,Ee,.5*-Math.PI),fi(W,Z,_e,Ee,xe,2),i.ab.mat4.identity(Ee),i.ab.mat4.rotateX(Ee,Ee,.5*Math.PI),fi(W,Z,_e,Ee,xe,3),i.ab.mat4.identity(Ee),fi(W,Z,_e,Ee,xe,4),i.ab.mat4.identity(Ee),i.ab.mat4.rotateY(Ee,Ee,Math.PI),fi(W,Z,_e,Ee,xe,5),ae.viewport.set([0,0,W.width,W.height])}(g,u),u.markSkyboxValid(g)):g.renderPass==="sky"&&function(W,Z,te,re,ae){const ye=W.context,fe=ye.gl,xe=W.transform,_e=W.getOrCreateProgram("skybox");ye.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_CUBE_MAP,Z.skyboxTexture);const Ee=((Fe,De,Ze,Ue,qe)=>({u_matrix:Fe,u_sun_direction:De,u_cubemap:0,u_opacity:Ue,u_temporal_offset:qe}))(xe.skyboxMatrix,Z.getCenter(W,!1),0,re,ae);W.uploadCommonUniforms(ye,_e),_e.draw(W,fe.TRIANGLES,te,Gr.disabled,W.colorModeForRenderPass(),Hr.backCW,Ee,"skybox",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(g,u,D,S,q):O==="gradient"&&g.renderPass==="sky"&&function(W,Z,te,re,ae){const ye=W.context,fe=ye.gl,xe=W.transform,_e=W.getOrCreateProgram("skyboxGradient");Z.skyboxGeometry||(Z.skyboxGeometry=new Gm(ye)),ye.activeTexture.set(fe.TEXTURE0);let Ee=Z.colorRampTexture;Ee||(Ee=Z.colorRampTexture=new i.T(ye,Z.colorRamp,fe.RGBA8)),Ee.bind(fe.LINEAR,fe.CLAMP_TO_EDGE);const Fe=((De,Ze,Ue,qe,Ve)=>({u_matrix:De,u_color_ramp:0,u_center_direction:Ze,u_radius:i.ai(Ue),u_opacity:qe,u_temporal_offset:Ve}))(xe.skyboxMatrix,Z.getCenter(W,!1),Z.paint.get("sky-gradient-radius"),re,ae);W.uploadCommonUniforms(ye,_e),_e.draw(W,fe.TRIANGLES,te,Gr.disabled,W.colorModeForRenderPass(),Hr.backCW,Fe,"skyboxGradient",Z.skyboxGeometry.vertexBuffer,Z.skyboxGeometry.indexBuffer,Z.skyboxGeometry.segment)}(g,u,D,S,q)},debug:function(g,s,u,y,S,P){for(let O=0;O<u.length;O++)if(S){const W=new i.aj(y.r*.8,y.g*.8,y.b*.8,1);Ko(g,s,u[O],y,-1,-1,P),Ko(g,s,u[O],y,-1,1,P),Ko(g,s,u[O],y,1,1,P),Ko(g,s,u[O],y,1,-1,P),Ko(g,s,u[O],W,0,0,P)}else Ko(g,s,u[O],y,0,0,P)},custom:function(g,s,u,y){const S=g.context,P=u.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&u.isDraped(s)){if(g.renderPass==="offscreen"){const O=P.prerender;if(O){if(g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;O.call(P,S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else O.call(P,S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const D=P.renderToTile;if(D){const q=y[0].canonical,W=new i.aa(q.x+y[0].wrap*(1<<q.z),q.y,q.z);S.setDepthMode(Lr.disabled),S.setStencilMode(Gr.disabled),S.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),D.call(P,S.gl,W),S.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),S.setStencilMode(Gr.disabled);const O=P.renderingMode==="3d"?new Lr(g.context.gl.LEQUAL,Lr.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,Lr.ReadOnly);if(S.setDepthMode(O),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;P.render(S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else P.render(S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState(),S.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,s,u,y){if(g.renderPass==="opaque")return;const S=u.paint.get("model-opacity").constantOr(1);if(S===0)return;const P=u.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!P||g.terrain&&S<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const O=g.shadowRenderer,D=u.paint.get("model-receive-shadows");O&&(O.useNormalOffset=!0,D||(O.enabled=!1));const q=()=>{O&&(O.useNormalOffset=!0,D||(O.enabled=!0))},W=s.getSource();if(g.renderPass==="light-beam"&&W.type!=="batched-model")return;if(W.type==="vector"||W.type==="geojson")return function(_e,Ee,Fe,De,Ze){const Ue=_e.transform;if(Ue.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Ue.projection.name} projection is not yet implemented`);const qe=Ue.getFreeCameraOptions().position;if(!_e.modelManager)return;const Ve=_e.modelManager;Fe.modelManager=Ve;const Ke=_e.shadowRenderer;if(!Fe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const it=Fe._unevaluatedLayout._values["model-id"],_t=Object.assign({},Fe.layout.get("model-id").parameters),pt=_e.style.order.indexOf(Fe.fqid);for(const Ct of De){const Mt=Ee.getTile(Ct).getBucket(Fe);if(!Mt||Mt.projection.name!==Ue.projection.name)continue;const ut=Mt.getModelUris();ut&&!Mt.modelsRequested&&(Ve.addModelsFromBucket(ut,Ze),Mt.modelsRequested=!0);const Tt=Hm(Ct,Ue);_t.zoom=Tt;const Bt=it.possiblyEvaluate(_t);if(qs(_e,Mt,Ct),no.shadowUniformsInitialized=!1,no.useSingleShadowCascade=!!Ke&&Ke.getMaxCascadeForTile(Ct.toUnwrapped())===0,_e.renderPass==="shadow"&&Ke){if(_e.currentShadowCascade===1&&Mt.isInsideFirstShadowMapFrustum)continue;const Pt=Ue.calculatePosMatrix(Ct.toUnwrapped(),Ue.worldSize);if(no.tileMatrix.set(Pt),no.shadowTileMatrix=Float32Array.from(Ke.calculateShadowPassMatrixFromMatrix(Pt)),no.aabb.min.fill(0),no.aabb.max[0]=no.aabb.max[1]=i.ag,no.aabb.max[2]=0,Mp(Mt,no,_e,Fe.scope))continue}const ft=1<<Ct.canonical.z,Dt=[((qe.x-Ct.wrap)*ft-Ct.canonical.x)*i.ag,(qe.y*ft-Ct.canonical.y)*i.ag,qe.z*ft*i.ag];_e.conflationActive&&Object.keys(Mt.instancesPerModel).length>0&&_e.style.isLayerClipped(Fe,Ee.getSource())&&Mt.updateReplacement(Ct,_e.replacementSource,pt,Ze)&&(Mt.uploaded=!1,Mt.upload(_e.context));for(let Pt in Mt.instancesPerModel){const Zt=Mt.instancesPerModel[Pt];Zt.features.length>0&&(Pt=Bt.evaluate(Zt.features[0].feature,{}));const zt=Ve.getModel(Pt,Ze);if(zt&&zt.uploaded)for(const Nt of zt.nodes)mo(_e,Fe,Nt,Zt,Dt,Ct,no)}}}(g,s,u,y,W.type==="vector"?u.scope:""),void q();if(!W.loaded())return;if(W.type==="batched-model")return function(_e,Ee,Fe,De){Fe.resetLayerRenderingStats(_e);const Ze=_e.context,Ue=_e.transform,qe=_e.style.fog,Ve=_e.shadowRenderer;if(Ue.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Ue.projection.name} projection is not yet implemented`);const Ke=_e.transform.getFreeCameraOptions().position,it=i.ab.vec3.scale([],[Ke.x,Ke.y,Ke.z],_e.transform.worldSize),_t=i.ab.vec3.negate([],it),pt=i.ab.mat4.identity([]),Ct=i.dj(Ue.center.lat,Ue.zoom),Mt=i.ab.mat4.fromScaling([],[1,1,1/Ct]);i.ab.mat4.translate(pt,pt,_t);const ut=Fe.paint.get("model-opacity").constantOr(1),Tt=new Lr(Ze.gl.LEQUAL,Lr.ReadWrite,_e.depthRangeFor3D),Bt=new Lr(Ze.gl.LEQUAL,Lr.ReadOnly,_e.depthRangeFor3D),ft=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Dt=_e.renderPass==="shadow",Pt=Dt&&Ve?Ve.getCurrentCascadeFrustum():Ue.getFrustum(Ue.scaleZoom(Ue.worldSize)),Zt=Fe.paint.get("model-front-cutoff"),zt=Zt[2]<1,Nt=Al(_e,Fe.paint.get("model-cutoff-fade-range")),qt=Fe.getLayerRenderingStats();(function(er,fr,mr,$r){const Or=er.terrain?er.terrain.exaggeration():0,jr=er.transform.zoom;for(const Wr of $r){const Mn=fr.getTile(Wr).getBucket(mr);Mn&&(er.conflationActive&&Mn.updateReplacement(Wr,er.replacementSource),Mn.evaluateScale(er,mr),er.terrain&&Or>0&&Mn.elevationUpdate(er.terrain,Or,Wr,mr.source),Mn.needsReEvaluation(er,jr,mr)&&Mn.evaluate(mr))}})(_e,Ee,Fe,De),function(){let er,fr,mr;zt?(er=De.length-1,fr=-1,mr=-1):(er=0,fr=De.length,mr=1);const $r=new Float64Array(16),Or=i.ab.vec3.create(),jr=new i.P(0,0);for(let Wr=er;Wr!==fr;Wr+=mr){const Mn=De[Wr],hi=Ee.getTile(Mn).getBucket(Fe);if(!hi||!hi.uploaded)continue;let Gi=!1;Ve&&(Gi=Ve.getMaxCascadeForTile(Mn.toUnwrapped())===0);const Yn=Ue.calculatePosMatrix(Mn.toUnwrapped(),Ue.worldSize),Zr=hi.modelTraits;!Dt&&zt&&(i.ab.mat4.invert($r,Yn),i.ab.vec3.transformMat4(Or,it,$r),jr.x=Or[0],jr.y=Or[1]);const _n=[];for(const xr of hi.getNodesInfo()){if(xr.hiddenByReplacement||!xr.node.meshes)continue;const En=xr.node;let ei=0;_e.terrain&&En.elevation&&(ei=En.elevation*_e.terrain.exaggeration());const oi=(()=>{const Rn=xr.aabb;return ft.min=[...Rn.min],ft.max=[...Rn.max],ft.min[2]+=ei,ft.max[2]+=ei,i.ab.vec3.transformMat4(ft.min,ft.min,Yn),i.ab.vec3.transformMat4(ft.max,ft.max,Yn),ft})(),Qi=xr.evaluatedScale;if(Qi[0]<=1&&Qi[1]<=1&&Qi[2]<=1&&oi.intersects(Pt)===0)continue;if(!Dt&&zt){const Rn=.16666666666666666;xr.cameraCollisionOpacity=it[0]>oi.min[0]&&it[0]<oi.max[0]&&it[1]>oi.min[1]&&it[1]<oi.max[1]&&it[2]*Ct<oi.max[2]&&En.footprint&&i.bA(jr,En.footprint)?Math.max(xr.cameraCollisionOpacity-Rn,0):Math.min(1,xr.cameraCollisionOpacity+Rn)}const aa=[...Yn],ja=En.anchor?En.anchor[0]:0,Aa=En.anchor?En.anchor[1]:0;i.ab.mat4.translate(aa,aa,[ja*(Qi[0]-1),Aa*(Qi[1]-1),ei]),i.ab.vec3.exactEquals(Qi,i.dm)||i.ab.mat4.scale(aa,aa,Qi);const Co=i.ab.mat4.multiply([],aa,En.matrix),Mo=i.ab.mat4.multiply([],Ue.expandedFarZProjMatrix,Co),ki=i.ab.mat4.multiply([],Ue.expandedFarZProjMatrix,aa),Pi=i.ab.vec4.transformMat4([],[ja,Aa,ei,1],Mo)[2];En.hidden=!1;let _i=ut;Dt||(zt&&(_i*=xr.cameraCollisionOpacity,_i*=Rl(aa,Ue,xr.aabb,Zt)),_i*=au(Nt,Pi)),_i!==0?_n.push({nodeInfo:xr,depth:Pi,opacity:_i,wvpForNode:Mo,wvpForTile:ki,nodeModelMatrix:Co,tileModelMatrix:aa}):En.hidden=!0}Dt||_n.sort((xr,En)=>!zt||xr.opacity===1&&En.opacity===1?xr.depth<En.depth?-1:1:xr.opacity===1?-1:En.opacity===1?1:xr.depth>En.depth?-1:1);for(const xr of _n){const En=xr.nodeInfo,ei=En.node;let oi=i.ab.mat4.multiply([],Mt,xr.tileModelMatrix);i.ab.mat4.multiply(oi,pt,oi);const Qi=i.ab.mat4.invert([],oi);i.ab.mat4.transpose(Qi,Qi),i.ab.mat4.scale(Qi,Qi,Cp),oi=i.ab.mat4.multiply(oi,oi,ei.matrix);const aa=_e.renderPass==="light-beam",ja=Fe.paint.get("model-color-use-theme").constantOr("default")==="none",Aa=Zr&i.dp.HasMapboxMeshFeatures,Co=Aa?0:En.evaluatedRMEA[0][2];for(let Mo=0;Mo<ei.meshes.length;++Mo){const ki=ei.meshes[Mo],Pi=Mo===ei.lightMeshIndex;let _i=xr.wvpForNode;if(Pi){if(!aa&&!_e.terrain&&_e.shadowRenderer){_e.currentLayer<_e.firstLightBeamLayer&&(_e.firstLightBeamLayer=_e.currentLayer);continue}_i=xr.wvpForTile}else if(aa)continue;const Rn={defines:[]},oa=[];if(!Dt&&Ve&&(Ve.useNormalOffset=!!ki.normalBuffer),ia(Rn.defines,oa,ki,_e,ja?null:Fe.lut),Aa||Rn.defines.push("DIFFUSE_SHADED"),Gi&&Rn.defines.push("SHADOWS_SINGLE_CASCADE"),qt&&(Dt?qt.numRenderedVerticesInShadowPass+=ki.vertexArray.length:qt.numRenderedVerticesInTransparentPass+=ki.vertexArray.length),Dt){rd(ki,xr.nodeModelMatrix,_e,Fe);continue}let io=null;if(qe){const Es=As(xr.nodeModelMatrix,_e.transform);if(io=new Float32Array(Es),Ue.projection.name!=="globe"){const gl=ki.aabb.min,Ii=ki.aabb.max,[uh,Jl]=qe.getOpacityForBounds(Es,gl[0],gl[1],Ii[0],Ii[1]);Rn.overrideFog=uh>=He||Jl>=He}}const Ei=ki.material;let Lo;Ei.occlusionTexture&&Ei.occlusionTexture.offsetScale&&(Lo=Ei.occlusionTexture.offsetScale,Rn.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ml=_e.getOrCreateProgram("model",Rn);!Dt&&Ve&&Ve.setupShadowsFromMatrix(xr.tileModelMatrix,ml,Ve.useNormalOffset),_e.uploadCommonUniforms(Ze,ml,null,io);const yo=Ei.pbrMetallicRoughness;yo.metallicFactor=.9,yo.roughnessFactor=.5;const Ps=Yd(new Float32Array(_i),new Float32Array(oi),new Float32Array(Qi),new Float32Array(ei.matrix),_e,xr.opacity,yo.baseColorFactor.toRenderColor(null),Ei.emissiveFactor,yo.metallicFactor,yo.roughnessFactor,Ei,Co,Fe,[0,0,0],Lo);!Pi&&(En.hasTranslucentParts||xr.opacity<1)&&ml.draw(_e,Ze.gl.TRIANGLES,Tt,Gr.disabled,xn.disabled,Hr.backCCW,Ps,Fe.id,ki.vertexBuffer,ki.indexBuffer,ki.segments,Fe.paint,_e.transform.zoom,void 0,oa),ml.draw(_e,Ze.gl.TRIANGLES,Pi?Bt:Tt,Gr.disabled,Pi||xr.opacity<1||En.hasTranslucentParts?xn.alphaBlended:xn.unblended,Hr.backCCW,Ps,Fe.id,ki.vertexBuffer,ki.indexBuffer,ki.segments,Fe.paint,_e.transform.zoom,void 0,oa)}}}}()}(g,s,u,y),void q();if(W.type!=="model")return;const Z=W.getModels(),te=[],re=g.transform.getFreeCameraOptions().position,ae=i.ab.vec3.scale([],[re.x,re.y,re.z],g.transform.worldSize);i.ab.vec3.negate(ae,ae);const ye=[],fe=[];let xe=0;for(const _e of Z){const Ee=u.paint.get("model-rotation").constantOr(null),Fe=u.paint.get("model-scale").constantOr(null),De=u.paint.get("model-translation").constantOr(null);_e.computeModelMatrix(g,Ee,Fe,De,!0,!0,!1);const Ze=i.ab.mat4.identity([]),Ue=i.dj(_e.position.lat,g.transform.zoom),qe=i.ab.mat4.fromScaling([],[1,1,1/Ue]);i.ab.mat4.translate(Ze,Ze,ae),te.push({zScaleMatrix:qe,negCameraPosMatrix:Ze});for(const Ve of _e.nodes)ro(g.transform,Ve,_e.matrix,g.transform.expandedFarZProjMatrix,xe,ye,fe);xe++}if(ye.sort((_e,Ee)=>Ee.depth-_e.depth),g.renderPass!=="shadow"){if(S===1)for(const _e of fe)ua(_e,g,u,te[_e.modelIndex],Gr.disabled,g.colorModeForRenderPass());else{for(const _e of fe)ua(_e,g,u,te[_e.modelIndex],Gr.disabled,xn.disabled);for(const _e of fe)ua(_e,g,u,te[_e.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const _e of ye)ua(_e,g,u,te[_e.modelIndex],Gr.disabled,g.colorModeForRenderPass());q()}else{for(const _e of fe)rd(_e.mesh,_e.nodeModelMatrix,g,u);for(const _e of ye)rd(_e.mesh,_e.nodeModelMatrix,g,u);q()}}},ah={line:function(g,s,u){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(s){const y=s.getVisibleCoordinates();for(const S of y){const P=s.getTile(S).getBucket(g);if(P&&(P.hasZOffset?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,s,u){const y=s.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,y.type==="vector"?g.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const S=y.getModels();for(const P of S)P.upload(u.context)},raster:function(g,s,u){const y=s.getSource();if(!(y instanceof Ga&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const P=g.paint.get("raster-array-band")||y.getInitialBand(S);if(P==null)return;const O=s.getIds().map(D=>s.getTileByID(D));for(const D of O)D.updateNeeded(S,P)&&y.prepareTile(D,S,P)},"raster-particle":function(g,s,u){const y=s.getSource();if(!(y instanceof Ga&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const P=g.paint.get("raster-particle-array-band")||y.getInitialBand(S);if(P==null)return;const O=s.getIds().map(D=>s.getTileByID(D));for(const D of O)D.updateNeeded(S,P)&&y.prepareTile(D,S,P)}};class Jm{constructor(s,u,y,S,P){this.context=new Ay(s,u),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=P,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const O=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const q of O)this._debugParams.enabledLayers[q]=!0;P.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),P.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),P.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),P.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),P.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),P.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const q of O)P.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],q);this.occlusionParams=new ff(P),this.setup(),this.numSublayers=Ls.maxUnderzooming+Ls.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Dd(this),this._wireframeDebugCache=new nh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const D=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,D,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=S}updateTerrain(s,u){const y=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Wl(this,s));const S=this._terrain;this.transform.elevation=y?S:null,S.update(s,this.transform,u),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(s){const u=s.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,S]=u.getFovAdjustedRange(this.transform._fov);if(y>S)return void(this.transform.fogCullDistSq=null);const P=y+.78*(S-y);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new Wl(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,u){if(this.width=s*i.q.devicePixelRatio,this.height=u*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const s=this.context,u=new i.b4;u.emplaceBack(0,0),u.emplaceBack(i.ag,0),u.emplaceBack(0,i.ag),u.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=s.createVertexBuffer(u,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const y=new i.b4;y.emplaceBack(0,0),y.emplaceBack(i.ag,0),y.emplaceBack(0,i.ag),y.emplaceBack(i.ag,i.ag),this.debugBuffer=s.createVertexBuffer(y,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const S=new i.b4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(S,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const P=new i.aT;P.emplaceBack(0,0,0,0),P.emplaceBack(i.ag,0,i.ag,0),P.emplaceBack(0,i.ag,0,i.ag),P.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=s.createVertexBuffer(P,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const O=new i.aU;O.emplaceBack(0,1,2),O.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(O);const D=new i.b5;for(const W of[0,1,3,2,0])D.emplaceBack(W);this.debugIndexBuffer=s.createIndexBuffer(D),this.emptyTexture=new i.T(s,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=i.ab.mat4.create();const q=this.context.gl;this.stencilClearMode=new Gr({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,Lr.disabled,this.stencilClearMode,xn.disabled,Hr.disabled,Ji(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,u,y){if(!u||this.currentStencilSource===u.id||!s.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const q of y)if(this._tileClippingMaskIDs[q.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=u.id;const S=this.context,P=S.gl;this.nextStencilID+y.length>256&&this.clearStencil(),S.setColorMode(xn.disabled),S.setDepthMode(Lr.disabled);const O=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of y){const q=u.getTile(D),W=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:Z,tileBoundsIndexBuffer:te,tileBoundsSegments:re}=this.getTileBoundsBuffers(q);O.draw(this,P.TRIANGLES,Lr.disabled,new Gr({func:P.ALWAYS,mask:0},W,255,P.KEEP,P.KEEP,P.REPLACE),xn.disabled,Hr.disabled,Ji(D.projMatrix),"$clipping",Z,te,re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,u=this.context.gl;return new Gr({func:u.NOTEQUAL,mask:255},s,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const u=this.context.gl;return new Gr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(s){const u=this.context.gl,y=s.sort((O,D)=>D.overscaledZ-O.overscaledZ),S=y[y.length-1].overscaledZ,P=y[0].overscaledZ-S+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const O={};for(let D=0;D<P;D++)O[D+S]=new Gr({func:u.GEQUAL,mask:255},D+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=P,[O,y]}return[{[S]:Gr.disabled},y]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new xn([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?xn.unblended:xn.alphaBlended}colorModeForDrapableLayerRenderPass(s){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new xn([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,s===void 0?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,u,y,S=!1){if(this.depthOcclusion)return new Lr(this.context.gl.GREATER,Lr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return Lr.disabled;const P=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new Lr(y||this.context.gl.LEQUAL,u,[P,P])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,u=Math.ceil(this.width),y=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),P=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&y!==0&&(this.depthFBO=new Tp(this.context,u,y,!1,"texture"),this.depthTexture=new i.T(this.context,{width:u,height:y,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),s.bindTexture(s.TEXTURE_2D,P),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,u,y,0,0,u,y,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,u)=>s+u/this._fpsHistory.length,0))}render(s,u){const y=i.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=u;const S=this.style._mergedLayers,P=!(!this.terrain||!this.terrain.enabled),O=()=>this.style._getOrder(P).filter(ut=>{const Tt=S[ut];return!(Tt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Tt.type]});let D=O(),q=!1,W=!1;for(const ut of D){const Tt=S[ut];Tt.type==="circle"&&(q=!0),Tt.type==="symbol"&&(Tt.hasInitialOcclusionOpacityProperties?W=!0:q=!0)}let Z=D.map(ut=>S[ut]);const te=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let re=0,ae=!1;for(const ut in te){const Tt=te[ut];Tt.used&&(Tt.prepare(this.context),Tt.getSource().usedInConflation&&++re)}let ye=!1;for(const ut of Z)ut.isHidden(this.transform.zoom)||(ut.type==="clip"&&(ye=!0),this.prepareLayer(ut));const fe={},xe={},_e={},Ee={},Fe={};for(const ut in te){const Tt=te[ut];fe[ut]=Tt.getVisibleCoordinates(),xe[ut]=fe[ut].slice().reverse(),_e[ut]=Tt.getVisibleCoordinates(!0).reverse(),Ee[ut]=Tt.getShadowCasterCoordinates(),Fe[ut]=Tt.sortCoordinatesByDistance(fe[ut])}const De=ut=>{const Tt=this.style.getLayerSourceCache(ut);return Tt&&Tt.used?Tt.getSource():null};if(re||ye||this._clippingActiveLastFrame){const ut=[],Tt=[];let Bt=0;for(const ft of Z)this.isSourceForClippingOrConflation(ft,De(ft))&&(ut.push(ft),Tt.push(Bt)),Bt++;if(ut&&(ye||ut.length>1)||this._clippingActiveLastFrame){ye=!1;const ft=[];for(let Dt=0;Dt<ut.length;Dt++){const Pt=ut[Dt],Zt=Tt[Dt],zt=this.style.getLayerSourceCache(Pt);if(!zt||!zt.used||!zt.getSource().usedInConflation&&Pt.type!=="clip")continue;let Nt=i.dx,qt=i.by.None;const er=[];let fr=!0;if(Pt.type==="clip"){Nt=Zt;for(const mr of Pt.layout.get("clip-layer-types"))qt|=mr==="model"?i.by.Model:mr==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const mr of Pt.layout.get("clip-layer-scope"))er.push(mr);Pt.isHidden(this.transform.zoom)?fr=!1:ye=!0}fr&&ft.push({layer:Pt.fqid,cache:zt,order:Nt,clipMask:qt,clipScope:er})}this.replacementSource.setSources(ft),ae=!0}}this._clippingActiveLastFrame=ye,ae||this.replacementSource.clear(),this.conflationActive=ae,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ut=0;ut<Z.length;ut++){const Tt=Z[ut],Bt=Tt.cutoffRange();if(this.longestCutoffRange=Math.max(Bt,this.longestCutoffRange),Bt>0){const ft=De(Tt);ft&&(this.minCutoffZoom=Math.max(ft.minzoom,this.minCutoffZoom)),Tt.minzoom&&(this.minCutoffZoom=Math.max(Tt.minzoom,this.minCutoffZoom))}Tt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ut),this._lastOcclusionLayer=ut)}const Ze=this.style&&this.style.fog;Ze?(this._fogVisible=Ze.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ze.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0,D=O(),Z=D.map(ut=>S[ut]));const Ue=this._shadowRenderer;if(Ue){Ue.updateShadowParameters(this.transform,this.style.directionalLight);for(const ut in te)for(const Tt of fe[ut]){let Bt={min:0,max:0};this.terrain&&(Bt=this.terrain.getMinMaxForTile(Tt)||Bt),Ue.addShadowReceiver(Tt.toUnwrapped(),Bt.min,Bt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Wm(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const qe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ve=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(qe&&!this._snow&&(this._snow=new gf(this)),!qe&&this._snow&&(this._snow.destroy(),delete this._snow),Ve&&!this._rain&&(this._rain=new ih(this)),!Ve&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Nr.has(this.context.gl))return;this.renderPass="offscreen";for(const ut of Z){const Tt=s.getLayerSourceCache(ut);if(!ut.hasOffscreenPass()||ut.isHidden(this.transform.zoom))continue;const Bt=Tt?xe[Tt.id]:void 0;(ut.type==="custom"||ut.type==="raster"||ut.type==="raster-particle"||ut.isSky()||Bt&&Bt.length)&&this.renderLayer(this,Tt,ut,Bt)}this.depthRangeFor3D=[0,1-(Z.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Ee)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ke=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),it=(()=>{if(u.showOverdrawInspector)return i.aj.black;const ut=this.style.fog;if(ut&&this.transform.projection.supportsFog){const Tt=this.style.getLut(ut.scope);if(!Ke){const Bt=ut.properties.get("color-use-theme")==="none",ft=ut.properties.get("color").toRenderColor(Bt?null:Tt).toArray01();return new i.aj(...ft)}if(Ke){const Bt=ut.properties.get("space-color-use-theme")==="none",ft=ut.properties.get("space-color").toRenderColor(Bt?null:Tt).toArray01();return new i.aj(...ft)}}return i.aj.transparent})();if(this.context.clear({color:it,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ke&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=D.length-1;this.currentLayer>=0;this.currentLayer--){const ut=Z[this.currentLayer],Tt=s.getLayerSourceCache(ut);if(ut.isSky())continue;const Bt=Tt?(ut.is3D()?Fe:xe)[Tt.id]:void 0;this._renderTileClippingMasks(ut,Tt,Bt),this.renderLayer(this,Tt,ut,Bt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ke&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<D.length;this.currentLayer++){const ut=Z[this.currentLayer],Tt=s.getLayerSourceCache(ut);ut.isSky()&&this.renderLayer(this,Tt,ut,Tt?xe[Tt.id]:void 0)}function _t(ut,Tt){let Bt;return Tt&&(Bt=(ut.type==="symbol"?_e:ut.is3D()?Fe:xe)[Tt.id]),Bt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<D.length;){const ut=Z[this.currentLayer];if(ut.type==="raster"||ut.type==="raster-particle"){const Tt=s.getLayerSourceCache(ut);this.renderLayer(this,Tt,ut,_t(ut,Tt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let pt=0;Ue&&(pt=Ue.getShadowCastingLayerCount());let Ct=!1,Mt=-1;for(let ut=0;ut<D.length;++ut){const Tt=Z[ut];Tt.isHidden(this.transform.zoom)||Tt.is3D()&&(Mt=ut)}for(W&&Mt===-1&&(q=!0);this.currentLayer<D.length;){const ut=Z[this.currentLayer],Tt=s.getLayerSourceCache(ut);if(ut.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ut)){if(ut.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(q&&!Ct&&this.terrain&&!this.transform.isOrthographic&&(Ct=!0,this.blitDepth()),W&&Mt!==-1&&this.currentLayer===Mt+1&&!this.transform.isOrthographic&&this.blitDepth(),ut.is3D()||this.terrain||this._renderTileClippingMasks(ut,Tt,Tt?fe[Tt.id]:void 0),this.renderLayer(this,Tt,ut,_t(ut,Tt)),!this.terrain&&Ue&&pt>0&&ut.hasShadowPass()&&--pt==0&&(Ue.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Bt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Bt;this.currentLayer++){const ft=Z[this.currentLayer];if(!ft.hasLightBeamPass())continue;const Dt=s.getLayerSourceCache(ft);this.renderLayer(this,Dt,ft,Dt?xe[Dt.id]:void 0)}this.currentLayer=Bt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Bt=this.currentLayer;this.depthOcclusion=!0;for(const ft of this.layersWithOcclusionOpacity){this.currentLayer=ft;const Dt=Z[this.currentLayer],Pt=s.getLayerSourceCache(Dt),Zt=Pt?xe[Pt.id]:void 0;Dt.is3D()||this.terrain||this._renderTileClippingMasks(Dt,Pt,Pt?fe[Pt.id]:void 0),this.renderLayer(this,Pt,Dt,Zt)}this.depthOcclusion=!1,this.currentLayer=Bt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ut=null;Z.forEach(Tt=>{const Bt=s.getLayerSourceCache(Tt);Bt&&!Tt.isHidden(this.transform.zoom)&&Bt.getVisibleCoordinates().length&&(!ut||ut.getSource().maxzoom<Bt.getSource().maxzoom)&&(ut=Bt)}),ut&&this.options.showTileBoundaries&&yf.debug(this,ut,ut.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&yf.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ut){const Tt=ut.transform.padding;eh(ut,ut.transform.height-(Tt.top||0),3,iu),eh(ut,Tt.bottom||0,3,h_),th(ut,Tt.left||0,3,qm),th(ut,ut.transform.width-(Tt.right||0),3,Py);const Bt=ut.transform.centerPoint;(function(ft,Dt,Pt,Zt){pl(ft,Dt-1,Pt-10,2,20,Zt),pl(ft,Dt-10,Pt-1,20,2,Zt)})(ut,Bt.x,ut.transform.height-Bt.y,td)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ae||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:u}=this.transform.projection,y=!u||!u.includes(s.type);if(ah[s.type]&&(y||this.terrain&&s.type==="custom")){const S=this.style.getLayerSourceCache(s);ah[s.type](s,S,this)}this.gpuTimingEnd()}renderLayer(s,u,y,S){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||S&&S.length)&&(this.id=y.id,this.gpuTimingStart(y),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(y.type)&&(!s.terrain||y.type!=="custom")||y.type==="clip"||yf[y.type](s,u,y,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,y=this.context.gl;let S=this.gpuTimers[s.id];S||(S=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:y.createQuery()}),S.calls++,y.beginQuery(u.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,u=this.context.gl,y=u.createQuery();this.deferredRenderGpuTimeQueries.push(y),u.beginQuery(s.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const u={};for(const y in s){const S=s[y],P=this.context.extTimerQuery,O=P.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;P.deleteQueryEXT(S.query),u[y]=O}return u}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let y=0;for(const S of s)y+=u.getQueryParameter(S,u.QUERY_RESULT)/1e6,u.deleteQuery(S);return y}translatePosMatrix(s,u,y,S,P){if(!y[0]&&!y[1])return s;const O=P?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(O){const W=Math.sin(O),Z=Math.cos(O);y=[y[0]*Z-y[1]*W,y[0]*W+y[1]*Z]}const D=[P?y[0]:i.ar(u,y[0],this.transform.zoom),P?y[1]:i.ar(u,y[1],this.transform.zoom),0],q=new Float32Array(16);return i.ab.mat4.translate(q,s,D),q}saveTileTexture(s){const u=s.size[0],y=this._tileTextures[u];y?y.push(s):this._tileTextures[u]=[s]}getTileTexture(s){const u=this._tileTextures[s];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(s,u,y){const S=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,P=[];return this.style&&this.style.enable3dLights()&&(s==="globeRaster"||s==="terrainRaster"?(P.push("LIGHTING_3D_MODE"),P.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||P.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||P.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(P.push("TERRAIN"),this.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&P.push("GLOBE"),!this._fogVisible||S||u!==void 0&&!u||P.push("FOG","FOG_DITHERING"),S&&P.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&P.push("OVERDRAW_INSPECTOR"),P}getOrCreateProgram(s,u){this.cache=this.cache||{};const y=u&&u.defines||[],S=u&&u.config,P=this.currentGlobalDefines(s,u&&u.overrideFog,u&&u.overrideRtt).concat(y),O=xy.cacheKey(Fd[s],s,P,S);return this.cache[O]||(this.cache[O]=new xy(this.context,s,Fd[s],S,$m[s],P)),this.cache[O]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,u){if(this.style.enable3dLights()){const y=this.style.directionalLight,S=this.style.ambientLight;if(y&&S){const P=((O,D,q)=>{const W=O.properties.get("direction"),Z=O.properties.get("color-use-theme")==="none",te=O.properties.get("color").toRenderColor(Z?null:q.getLut(O.scope)).toArray01(),re=O.properties.get("intensity"),ae=D.properties.get("color-use-theme")==="none",ye=D.properties.get("color").toRenderColor(ae?null:q.getLut(D.scope)).toArray01(),fe=D.properties.get("intensity"),xe=[W.x,W.y,W.z],_e=i.cM(ye,fe),Ee=i.cM(te,re);return{u_lighting_ambient_color:_e,u_lighting_directional_dir:xe,u_lighting_directional_color:Ee,u_ground_radiance:Vs(xe,Ee,_e)}})(y,S,this.style);u.setLightsUniformValues(s,P)}}}uploadCommonUniforms(s,u,y,S,P){if(this.uploadCommonLightUniforms(s,u),this.terrain&&this.terrain.renderingToTexture)return;const O=this.style.fog;if(O){const D=O.getOpacity(this.transform.pitch),q=((W,Z,te,re,ae,ye,fe,xe,_e,Ee,Fe,De)=>{const Ze=W.transform,Ue=Z.properties.get("color-use-theme")==="none",qe=Z.properties.get("color").toRenderColor(Ue?null:W.style.getLut(Z.scope)).toArray01();qe[3]=re;const Ve=W.frameCounter/1e3%1,[Ke,it]=Z.properties.get("vertical-range");return{u_fog_matrix:te?Ze.calculateFogTileMatrix(te):De||W.identityMat,u_fog_range:Z.getFovAdjustedRange(Ze._fov),u_fog_color:qe,u_fog_horizon_blend:Z.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ke,it),it],u_fog_temporal_offset:Ve,u_frustum_tl:ae,u_frustum_tr:ye,u_frustum_br:fe,u_frustum_bl:xe,u_globe_pos:_e,u_globe_radius:Ee,u_viewport:Fe,u_globe_transition:i.ae(Ze.zoom),u_is_globe:+(Ze.projection.name==="globe")}})(this,O,y,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],S);u.setFogUniformValues(s,q)}P&&u.setCutoffUniformValues(s,P.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,u=s.createTexture();return s.bindTexture(s.TEXTURE_2D,u),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&s.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const s=this._backgroundTiles,u=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const S of y)u[S.key]=s[S.key]||new hc(S,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,u){return!(!s.is3D()||s.type!=="clip"&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||s.sourceLayer!=="building")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[s.key];return u||(this._cachedTileFogOpacities[s.key]=u=this.style.fog.getOpacityForTile(s)),u[0]>=He||u[1]>=He}setupDepthForOcclusion(s,u,y){const S=this.context,P=S.gl,O=!!y;var D;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(P.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((D=this.depthRangeFor3D)[1]-D[0]),-1-2*D[0]/(D[1]-D[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),S.activeTexture.set(P.TEXTURE0),O||u.setTerrainUniformValues(S,y)}}function kp(g,s){let u=!1,y=null;const S=()=>{y=null,u&&(g(),y=setTimeout(S,s),u=!1)};return()=>(u=!0,y||S(),y)}class Ey{constructor(s){this._hashName=s&&encodeURIComponent(s),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=kp(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const u=Qm(s);if(this._hashName){const y=this._hashName;let S=!1;const P=location.hash.slice(1).split("&").map(O=>{const D=O.split("=")[0];return D===y?(S=!0,`${D}=${u}`):O}).filter(O=>O);return S||P.push(`${y}=${u}`),`#${P.join("&")}`}return`#${u}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let u;return s.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(u=y)}),(u&&u[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(y=>isNaN(y))){const y=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(u[3]||0):s.getBearing();return s.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:y,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Qm(g,s){const u=g.getCenter(),y=Math.round(100*g.getZoom())/100,S=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,S),O=Math.round(u.lng*P)/P,D=Math.round(u.lat*P)/P,q=g.getBearing(),W=g.getPitch();let Z=s?`/${O}/${D}/${y}`:`${y}/${D}/${O}`;return(q||W)&&(Z+="/"+Math.round(10*q)/10),W&&(Z+=`/${Math.round(W)}`),Z}const oh={linearity:.3,easing:i.dy(0,0,.3,1)},Cy=i.l({deceleration:2500,maxSpeed:1400},oh),My=i.l({deceleration:20,maxSpeed:1400},oh),Oy=i.l({deceleration:1e3,maxSpeed:360},oh),f_=i.l({deceleration:1e3,maxSpeed:90},oh);class Ry{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,u=i.q.now();for(;s.length>0&&u-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)u.zoom+=P.zoomDelta||0,u.bearing+=P.bearingDelta||0,u.pitch+=P.pitchDelta||0,P.panDelta&&u.pan._add(P.panDelta),P.around&&(u.around=P.around),P.pinchAround&&(u.pinchAround=P.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(u.pan.mag()){const P=Np(u.pan.mag(),y,i.l({},Cy,s||{}));S.offset=u.pan.mult(P.amount/u.pan.mag()),S.center=this._map.transform.center,jp(S,P)}if(u.zoom){const P=Np(u.zoom,y,My);S.zoom=this._map.transform.zoom+P.amount,jp(S,P)}if(u.bearing){const P=Np(u.bearing,y,Oy);S.bearing=this._map.transform.bearing+i.aw(P.amount,-179,179),jp(S,P)}if(u.pitch){const P=Np(u.pitch,y,f_);S.pitch=this._map.transform.pitch+P.amount,jp(S,P)}if(S.zoom||S.bearing){const P=u.pinchAround===void 0?u.around:u.pinchAround;S.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function jp(g,s){(!g.duration||g.duration<s.duration)&&(g.duration=s.duration,g.easing=s.easing)}function Np(g,s,u){const{maxSpeed:y,linearity:S,deceleration:P}=u,O=i.aw(g*S/(s/1e3),-y,y),D=Math.abs(O)/(P*S);return{easing:u.easing,duration:1e3*D,amount:O*(D/2)}}class Ts extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,y,S={}){const P=ve(u.getCanvasContainer(),y),O=u.unproject(P);super(s,i.l({point:P,lngLat:O,originalEvent:y},S)),this._defaultPrevented=!1,this.target=u}}class vf extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u,y){const S=s==="touchend"?y.changedTouches:y.touches,P=Ae(u.getCanvasContainer(),S),O=P.map(q=>u.unproject(q)),D=P.reduce((q,W,Z,te)=>q.add(W.div(te.length)),new i.P(0,0));super(s,{points:P,point:D,lngLats:O,lngLat:u.unproject(D),originalEvent:y}),this._defaultPrevented=!1}}class ky extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class eg{constructor(s,u){this._map=s,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new ky(this._map,s))}mousedown(s,u){return this._mousedownPos=u,this._firePreventable(new Ts(s.type,this._map,s))}mouseup(s){this._map.fire(new Ts(s.type,this._map,s))}preclick(s){const u=i.l({},s);u.type="preclick",this._map.fire(new Ts(u.type,this._map,u))}click(s,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(s),this._map.fire(new Ts(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new Ts(s.type,this._map,s))}mouseover(s){this._map.fire(new Ts(s.type,this._map,s))}mouseout(s){this._map.fire(new Ts(s.type,this._map,s))}touchstart(s){return this._firePreventable(new vf(s.type,this._map,s))}touchmove(s){this._map.fire(new vf(s.type,this._map,s))}touchend(s){this._map.fire(new vf(s.type,this._map,s))}touchcancel(s){this._map.fire(new vf(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class W0{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new Ts(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ts("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new Ts(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class va{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,u){this.isEnabled()&&s.shiftKey&&s.button===0&&(le(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(s,u){if(!this._active)return;const y=u,S=this._startPos,P=this._lastPos;if(!S||!P||P.equals(y)||!this._box&&y.dist(S)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=U("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const O=Math.min(S.x,y.x),D=Math.max(S.x,y.x),q=Math.min(S.y,y.y),W=Math.max(S.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${O}px,${q}px)`,this._box.style.width=D-O+"px",this._box.style.height=W-q+"px")})}mouseupWindow(s,u){if(!this._active)return;const y=this._startPos,S=u;if(y&&s.button===0){if(this.reset(),ue(),y.x!==S.x||y.y!==S.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:s})),{cameraAnimation:P=>P.fitScreenCoordinates(y,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&s.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ne(),delete this._startPos,delete this._lastPos}_fireEvent(s,u){return this._map.fire(new i.z(s,{originalEvent:u}))}}function tg(g,s){const u={};for(let y=0;y<g.length;y++)u[g[y].identifier]=s[y];return u}class Xl{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,u,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=s.timeStamp),y.length===this.numTouches&&(this.centroid=function(S){const P=new i.P(0,0);for(const O of S)P._add(O);return P.div(S.length)}(u),this.touches=tg(y,u)))}touchmove(s,u,y){if(this.aborted||!this.centroid)return;const S=tg(y,u);for(const P in this.touches){const O=S[P];(!O||O.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(s,u,y){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Ip{constructor(s){this.singleTap=new Xl(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,u,y){this.singleTap.touchstart(s,u,y)}touchmove(s,u,y){this.singleTap.touchmove(s,u,y)}touchend(s,u,y){const S=this.singleTap.touchend(s,u,y);if(S){const P=s.timeStamp-this.lastTime<500,O=!this.lastTap||this.lastTap.dist(S)<30;if(P&&O||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class id{constructor(){this._zoomIn=new Ip({numTouches:1,numTaps:2}),this._zoomOut=new Ip({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,u,y){this._zoomIn.touchstart(s,u,y),this._zoomOut.touchstart(s,u,y)}touchmove(s,u,y){this._zoomIn.touchmove(s,u,y),this._zoomOut.touchmove(s,u,y)}touchend(s,u,y){const S=this._zoomIn.touchend(s,u,y),P=this._zoomOut.touchend(s,u,y);return S?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()+1,around:O.unproject(S)},{originalEvent:s})}):P?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:O=>O.easeTo({duration:300,zoom:O.getZoom()-1,around:O.unproject(P)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const jy={0:1,2:2};class _f{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,u){return!1}_move(s,u){return{}}mousedown(s,u){if(this._lastPoint)return;const y=Oe(s);this._correctButton(s,y)&&(this._lastPoint=u,this._eventButton=y)}mousemoveWindow(s,u){const y=this._lastPoint;if(y){if(s.preventDefault(),this._eventButton!=null&&function(S,P){const O=jy[P];return S.buttons===void 0||(S.buttons&O)!==O}(s,this._eventButton))this.reset();else if(this._moved||!(u.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(y,u)}}mouseupWindow(s){this._lastPoint&&Oe(s)===this._eventButton&&(this._moved&&ue(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dp extends _f{mousedown(s,u){super.mousedown(s,u),this._lastPoint&&(this._active=!0)}_correctButton(s,u){return u===0&&!s.ctrlKey}_move(s,u){return{around:u,panDelta:u.sub(s)}}}class kl extends _f{_correctButton(s,u){return u===0&&s.ctrlKey||u===2}_move(s,u){const y=.8*(u.x-s.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(s){s.preventDefault()}}class Pc extends _f{_correctButton(s,u){return u===0&&s.ctrlKey||u===2}_move(s,u){const y=-.5*(u.y-s.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(s){s.preventDefault()}}class da{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(s,u,y){return this._calculateTransform(s,u,y)}touchmove(s,u,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,u,y)}}touchend(s,u,y){this._calculateTransform(s,u,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,u,y){y.length>0&&(this._active=!0);const S=tg(y,u),P=new i.P(0,0),O=new i.P(0,0);let D=0;for(const W in S){const Z=S[W],te=this._touches[W];te&&(P._add(Z),O._add(Z.sub(te)),D++,S[W]=Z)}if(this._touches=S,D<this._minTouches||!O.mag())return;const q=O.div(D);return this._sum._add(q),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(D),panDelta:q}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=U("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Gs{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,u,y){return{}}touchstart(s,u,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([u[0],u[1]]))}touchmove(s,u,y){const S=this._firstTwoTouches;if(!S)return;s.preventDefault();const[P,O]=S,D=xf(y,u,P),q=xf(y,u,O);if(!D||!q)return;const W=this._aroundCenter?null:D.add(q).div(2);return this._move([D,q],W,s)}touchend(s,u,y){if(!this._firstTwoTouches)return;const[S,P]=this._firstTwoTouches,O=xf(y,u,S),D=xf(y,u,P);O&&D||(this._active&&ue(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&s.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function xf(g,s,u){for(let y=0;y<g.length;y++)if(g[y].identifier===u)return s[y]}function bf(g,s){return Math.log(g/s)/Math.LN2}class Ny extends Gs{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,u){const y=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(bf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bf(this._distance,y),pinchAround:u}}}function Iy(g,s){return 180*g.angleWith(s)/Math.PI}class wf extends Gs{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,u){const y=this._vector;if(this._vector=s[0].sub(s[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Iy(this._vector,y),pinchAround:u}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const u=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const S=Iy(s,y);return Math.abs(S)<u}}function rg(g){return Math.abs(g.y)>Math.abs(g.x)}class H0 extends Gs{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,rg(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,u,y){const S=this._lastPoints;if(!S)return;const P=s[0].sub(S[0]),O=s[1].sub(S[1]);return this._map._cooperativeGestures&&!i.dz()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(P,O,y.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(P.y+O.y)/2*-.5})}gestureBeginsVertically(s,u,y){if(this._valid!==void 0)return this._valid;const S=s.mag()>=2,P=u.mag()>=2;if(!S&&!P)return;if(!S||!P)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const O=s.y>0==u.y>0;return rg(s)&&rg(u)&&O}}const ls={panStep:100,bearingStep:15,pitchStep:10};class Wo{constructor(){const s=ls;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let u=0,y=0,S=0,P=0,O=0;switch(s.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:s.shiftKey?y=-1:(s.preventDefault(),P=-1);break;case 39:s.shiftKey?y=1:(s.preventDefault(),P=1);break;case 38:s.shiftKey?S=1:(s.preventDefault(),O=-1);break;case 40:s.shiftKey?S=-1:(s.preventDefault(),O=1);break;default:return}return this._rotationDisabled&&(y=0,S=0),{cameraAnimation:D=>{const q=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:ad,zoom:u?Math.round(q)+u*(s.shiftKey?2:1):q,bearing:D.getBearing()+y*this._bearingStep,pitch:D.getPitch()+S*this._pitchStep,offset:[-P*this._panStep,-O*this._panStep],center:D.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ad(g){return g*(2-g)}const od=4.000244140625,Ec=1/450;class jl{constructor(s,u){this._map=s,this._el=s.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ec,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&s.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const y=i.q.now(),S=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,u!==0&&u%od==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(S*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),s.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=s,this._delta-=u,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=ve(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;this._type==="wheel"&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(this._delta!==0){const W=this._type==="wheel"&&Math.abs(this._delta)>od?this._wheelZoomRate:this._defaultZoomRate;let Z=2/(1+Math.exp(-Math.abs(this._delta*W)));this._delta<0&&Z!==0&&(Z=1/Z);const te=u(),re=Math.pow(2,te),ae=typeof this._targetZoom=="number"?s.zoomScale(this._targetZoom):re;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(ae*Z))),this._type==="wheel"&&(this._startZoom=te,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:u(),S=this._startZoom,P=this._easing;let O,D=!1;if(this._type==="wheel"&&S&&P){const W=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),Z=P(W);O=i.af(S,y,Z),W<1?this._frameId||(this._frameId=!0):D=!0}else O=y,D=!0;this._active=!0,D&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let q=O-u();return q*this._lastDelta<0&&(q=0),{noInertia:!0,needsRenderFrame:!D,zoomDelta:q,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let u=i.dA;if(this._prevEase){const y=this._prevEase,S=(i.q.now()-y.start)/y.duration,P=y.easing(S+.01)-y.easing(S),O=.27/Math.sqrt(P*P+1e-4)*.01,D=Math.sqrt(.0729-O*O);u=i.dy(O,D,.25,1)}return this._prevEase={start:i.q.now(),duration:s,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=U("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class su{constructor(s,u){this._clickZoom=s,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class lu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,u){return s.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(s.shiftKey?-1:1),around:y.unproject(u)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cu{constructor(){this._tap=new Ip({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,u,y){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=u[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(s,u,y))}touchmove(s,u,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const S=u[0],P=S.y-this._swipePoint.y;return this._swipePoint=S,s.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(s,u,y)}touchend(s,u,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(s,u,y)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dy{constructor(s,u,y){this._el=s,this._mousePan=u,this._touchPan=y}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class p_{constructor(s,u,y){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=u,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class m_{constructor(s,u,y,S){this._el=s,this._touchZoom=u,this._touchRotate=y,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Sf=g=>g.zoom||g.drag||g.pitch||g.rotate;class ng extends i.z{}class Ho{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,u){const y=i.ab.vec3.sub([],u,s);this.radius=i.ab.vec3.length(y[2]<0?i.ab.vec3.div([],y,this.constants):[y[0],y[1],0])}projectRay(s){i.ab.vec3.div(s,s,this.constants),i.ab.vec3.normalize(s,s),i.ab.vec3.mul(s,s,this.constants);const u=i.ab.vec3.scale([],s,this.radius);if(u[2]>0){const y=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(u,[0,0,1])),S=i.ab.vec3.scale([],i.ab.vec3.normalize([],[u[0],u[1],0]),this.radius),P=i.ab.vec3.add([],u,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],S,y),u),2));u[0]=P[0],u[1]=P[1]}return u}}function sd(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Lp{constructor(s,u){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ry(s),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ho,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),i.aP(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,P,O]of this._listeners){const D=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(P,D,O)}}destroy(){for(const[s,u,y]of this._listeners){const S=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(u,S,y)}}_addDefaultHandlers(s){const u=this._map,y=u.getCanvasContainer();this._add("mapEvent",new eg(u,s));const S=u.boxZoom=new va(u,s);this._add("boxZoom",S);const P=new id,O=new lu;u.doubleClickZoom=new su(O,P),this._add("tapZoom",P),this._add("clickZoom",O);const D=new cu;this._add("tapDragZoom",D);const q=u.touchPitch=new H0(u);this._add("touchPitch",q);const W=new kl(s),Z=new Pc(s);u.dragRotate=new p_(s,W,Z),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",Z,["mouseRotate"]);const te=new Dp(s),re=new da(u,s);u.dragPan=new Dy(y,te,re),this._add("mousePan",te),this._add("touchPan",re,["touchZoom","touchRotate"]);const ae=new wf,ye=new Ny;u.touchZoomRotate=new m_(y,ye,ae,D),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",ye,["touchPan","touchRotate"]),this._add("blockableMapEvent",new W0(u));const fe=u.scrollZoom=new jl(u,this);this._add("scrollZoom",fe,["mousePan"]);const xe=u.keyboard=new Wo;this._add("keyboard",xe);for(const _e of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[_e]&&u[_e].enable(s[_e])}_add(s,u,y){this._handlers.push({handlerName:s,handler:u,allowed:y}),this._handlersById[s]=u}stop(s){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,u,y){for(const S in s)if(S!==y&&(!u||u.indexOf(S)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const u=[];for(const y of s)this._el.contains(y.target)&&u.push(y);return u}handleEvent(s,u){this._updatingCamera=!0;const y=s.type==="renderFrame",S=y?void 0:s,P={needsRenderFrame:!1},O={},D={},q=s.touches?this._getMapTouches(s.touches):void 0,W=q?Ae(this._el,q):y?void 0:ve(this._el,s);for(const{handlerName:re,handler:ae,allowed:ye}of this._handlers){if(!ae.isEnabled())continue;let fe;this._blockedByActive(D,ye,re)?ae.reset():ae[u||s.type]&&(fe=ae[u||s.type](s,W,q),this.mergeHandlerResult(P,O,fe,re,S),fe&&fe.needsRenderFrame&&this._triggerRenderFrame()),(fe||ae.isActive())&&(D[re]=ae)}const Z={};for(const re in this._previousActiveHandlers)D[re]||(Z[re]=S);this._previousActiveHandlers=D,(Object.keys(Z).length||sd(P))&&(this._changes.push([P,O,Z]),this._triggerRenderFrame()),(Object.keys(D).length||sd(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=P;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))}mergeHandlerResult(s,u,y,S,P){if(!y)return;i.l(s,y);const O={handlerName:S,originalEvent:y.originalEvent||P};y.zoomDelta!==void 0&&(u.zoom=O),y.panDelta!==void 0&&(u.drag=O),y.pitchDelta!==void 0&&(u.pitch=O),y.bearingDelta!==void 0&&(u.rotate=O)}_applyChanges(){const s={},u={},y={};for(const[S,P,O]of this._changes)S.panDelta&&(s.panDelta=(s.panDelta||new i.P(0,0))._add(S.panDelta)),S.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(s.around=S.around),S.aroundCoord!==void 0&&(s.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(s.pinchAround=S.pinchAround),S.noInertia&&(s.noInertia=S.noInertia),i.l(u,P),i.l(y,O);this._updateMapTransform(s,u,y),this._changes=[]}_updateMapTransform(s,u,y){const S=this._map,P=S.transform,O=Ee=>[Ee.x,Ee.y,Ee.z];if((Ee=>{const Fe=this._eventsInProgress.drag;return Fe&&!this._handlersById[Fe.handlerName].isActive()})()&&!sd(s)){const Ee=P.zoom;P.cameraElevationReference="sea",this._originalZoom!=null&&P._orthographicProjectionAtLowPitch&&P.projection.name!=="globe"&&P.pitch===0?(P.cameraElevationReference="ground",P.zoom=this._originalZoom):(P.recenterOnTerrain(),P.cameraElevationReference="ground"),Ee!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&S._stop(!0),!sd(s))return void this._fireEvents(u,y,!0);let{panDelta:D,zoomDelta:q,bearingDelta:W,pitchDelta:Z,around:te,aroundCoord:re,pinchAround:ae}=s;P._isCameraConstrained&&(q>0&&(q=0),P._isCameraConstrained=!1),ae!==void 0&&(te=ae),(q||(Ee=>u[Ee]&&!this._eventsInProgress[Ee])("drag"))&&te&&(this._dragOrigin=O(P.pointCoordinate3D(te)),this._originalZoom=P.zoom,this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",S._stop(!0),te=te||S.transform.centerPoint,W&&(P.bearing+=W),Z&&(P.pitch+=Z),P._updateCameraState();const ye=[0,0,0];if(D)if(P.projection.name==="mercator"){const Ee=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(te).dir),Fe=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(te.sub(D)).dir);ye[0]=Fe[0]-Ee[0],ye[1]=Fe[1]-Ee[1]}else{const Ee=P.pointCoordinate(te);if(P.projection.name==="globe"){D=D.rotate(-P.angle);const Fe=P._pixelsPerMercatorPixel/P.worldSize;ye[0]=-D.x*i.dB(i.aS(Ee.y))*Fe,ye[1]=-D.y*i.dB(P.center.lat)*Fe}else{const Fe=P.pointCoordinate(te.sub(D));Ee&&Fe&&(ye[0]=Fe.x-Ee.x,ye[1]=Fe.y-Ee.y)}}const fe=P.zoom,xe=[0,0,0];if(q){const Ee=O(re||P.pointCoordinate3D(te)),Fe={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Ee,P._camera.position))};if(Fe.dir[2]<0){const De=P.zoomDeltaToMovement(Ee,q);i.ab.vec3.scale(xe,Fe.dir,De)}}const _e=i.ab.vec3.add(ye,ye,xe);P._translateCameraConstrained(_e),q&&Math.abs(P.zoom-fe)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(u,y,!0)}_fireEvents(s,u,y){const S=Sf(this._eventsInProgress),P=Sf(s),O={};for(const Z in s){const{originalEvent:te}=s[Z];this._eventsInProgress[Z]||(O[`${Z}start`]=te),this._eventsInProgress[Z]=s[Z]}!S&&P&&this._fireEvent("movestart",P.originalEvent);for(const Z in O)this._fireEvent(Z,O[Z]);P&&this._fireEvent("move",P.originalEvent);for(const Z in s){const{originalEvent:te}=s[Z];this._fireEvent(Z,te)}const D={};let q;for(const Z in this._eventsInProgress){const{handlerName:te,originalEvent:re}=this._eventsInProgress[Z];this._handlersById[te].isActive()||(delete this._eventsInProgress[Z],q=u[te]||re,D[`${Z}end`]=q)}for(const Z in D)this._fireEvent(Z,D[Z]);const W=Sf(this._eventsInProgress);if(y&&(S||P)&&!W){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),te=re=>re!==0&&-this._bearingSnap<re&&re<this._bearingSnap;Z?(te(Z.bearing||this._map.getBearing())&&(Z.bearing=0),this._map.easeTo(Z,{originalEvent:q})):(this._map.fire(new i.z("moveend",{originalEvent:q})),te(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,u){this._map.fire(new i.z(s,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new ng("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const g_="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class sh extends i.E{constructor(s,u){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(s,u){return this.jumpTo({center:s},u)}panBy(s,u,y){return s=i.P.convert(s).mult(-1),this.panTo(this.transform.center,i.l({offset:s},u),y)}panTo(s,u,y){return this.easeTo(i.l({center:s},u),y)}getZoom(){return this.transform.zoom}setZoom(s,u){return this.jumpTo({zoom:s},u),this}zoomTo(s,u,y){return this.easeTo(i.l({zoom:s},u),y)}zoomIn(s,u){return this.zoomTo(this.getZoom()+1,s,u),this}zoomOut(s,u){return this.zoomTo(this.getZoom()-1,s,u),this}getBearing(){return this.transform.bearing}setBearing(s,u){return this.jumpTo({bearing:s},u),this}getPadding(){return this.transform.padding}setPadding(s,u){return this.jumpTo({padding:s},u),this}rotateTo(s,u,y){return this.easeTo(i.l({bearing:s},u),y)}resetNorth(s,u){return this.rotateTo(0,i.l({duration:1e3},s),u),this}resetNorthPitch(s,u){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},s),u),this}snapToNorth(s,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,u):this}getPitch(){return this.transform.pitch}setPitch(s,u){return this.jumpTo({pitch:s},u),this}cameraForBounds(s,u){s=i.az.convert(s);const y=u&&u.bearing||0,S=u&&u.pitch||0,P=s.getNorthWest(),O=s.getSouthEast();return this._cameraForBounds(this.transform,P,O,y,S,u)}_extendPadding(s){const u={top:0,right:0,bottom:0,left:0};return s==null?i.l({},u,this.transform.padding):typeof s=="number"?{top:s,bottom:s,right:s,left:s}:i.l({},u,s)}_extendCameraOptions(s){return(s=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,u){const y=u.max[0]-u.min[0],S=u.max[1]-u.min[1];return y/S>s.aspect?y/(2*Math.tan(.5*s.fovX)*s.aspect):S/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,u,y,S,P,O){const D=s.clone(),q=this._extendCameraOptions(O);D.bearing=S,D.pitch=P;const W=i.bO.convert(u),Z=i.bO.convert(y),te=.5*(W.lat+Z.lat),re=.5*(W.lng+Z.lng),ae=i.dC(te,re),ye=i.ab.vec3.normalize([],ae),fe=i.ab.vec3.normalize([],i.ab.vec3.cross([],ye,[0,1,0])),xe=i.ab.vec3.cross([],fe,ye),_e=[fe[0],fe[1],fe[2],0,xe[0],xe[1],xe[2],0,ye[0],ye[1],ye[2],0,0,0,0,1],Ee=[ae,i.dC(W.lat,W.lng),i.dC(Z.lat,W.lng),i.dC(Z.lat,Z.lng),i.dC(W.lat,Z.lng),i.dC(te,W.lng),i.dC(te,Z.lng),i.dC(W.lat,re),i.dC(Z.lat,re)];let Fe=i.cd.fromPoints(Ee.map(Pt=>[i.ab.vec3.dot(fe,Pt),i.ab.vec3.dot(xe,Pt),i.ab.vec3.dot(ye,Pt)]));const De=i.ab.vec3.transformMat4([],Fe.center,_e);i.ab.vec3.squaredLength(De)===0&&i.ab.vec3.set(De,0,0,1),i.ab.vec3.normalize(De,De),i.ab.vec3.scale(De,De,i.ax),D.center=i.dD(De);const Ze=D.getWorldToCameraMatrix(),Ue=i.ab.mat4.invert(new Float64Array(16),Ze);Fe=i.cd.applyTransform(Fe,i.ab.mat4.multiply([],Ze,_e));const qe=this._extendAABB(Fe,D,q,S);if(!qe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Fe=qe,i.ab.vec3.transformMat4(De,De,Ze);const Ve=.5*(Fe.max[2]-Fe.min[2]),Ke=this._minimumAABBFrustumDistance(D,Fe),it=i.ab.vec3.scale([],[0,0,1],Ve),_t=i.ab.vec3.add(it,De,it),pt=Ke+(D.pitch===0?0:i.ab.vec3.distance(De,_t)),Ct=D.globeCenterInViewSpace,Mt=i.ab.vec3.sub([],De,[Ct[0],Ct[1],Ct[2]]);i.ab.vec3.normalize(Mt,Mt),i.ab.vec3.scale(Mt,Mt,pt);const ut=i.ab.vec3.add([],De,Mt);i.ab.vec3.transformMat4(ut,ut,Ue);const Tt=i.ds/i.ax,Bt=i.ab.vec3.length(ut),ft=i.bH(Math.max(Bt*Tt-i.ds,Number.EPSILON),0),Dt=Math.min(D.zoomFromMercatorZAdjusted(ft),q.maxZoom);return Dt>.5*(i.c6+i.bY)?(D.setProjection({name:"mercator"}),D.zoom=Dt,this._cameraForBounds(D,u,y,S,P,O)):{center:D.center,zoom:Dt,bearing:S,pitch:P}}_extendAABB(s,u,y,S){const P=.5*((y.padding.left||0)+(y.padding.right||0)),O=.5*((y.padding.top||0)+(y.padding.bottom||0)),D=O,q=P,W=P,Z=O,te=u.width-(q+W),re=u.height-(D+Z),ae=i.ab.vec3.sub([],s.max,s.min),ye=Math.min(te/ae[0],re/ae[1]),fe=Math.min(u.scaleZoom(u.scale*ye),y.maxZoom);if(isNaN(fe))return null;const xe=u.scale/u.zoomScale(fe),_e=new i.cd([s.min[0]-q*xe,s.min[1]-Z*xe,s.min[2]],[s.max[0]+W*xe,s.max[1]+D*xe,s.max[2]]),Ee=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new i.P(y.offset.x,y.offset.y):i.P.convert(y.offset)).rotate(-i.ai(S));return _e.center[0]-=Ee.x*xe,_e.center[1]+=Ee.y*xe,_e}queryTerrainElevation(s,u){const y=this.transform.elevation;return y?(u=i.l({},{exaggerated:!0},u),y.getAtPoint(i.aa.fromLngLat(s),null,u.exaggerated)):null}_cameraForBounds(s,u,y,S,P,O){if(s.projection.name==="globe")return this._cameraForBoundsOnGlobe(s,u,y,S,P,O);const D=s.clone(),q=this._extendCameraOptions(O);D.bearing=S,D.pitch=P;const W=i.bO.convert(u),Z=i.bO.convert(y),te=new i.bO(W.lng,Z.lat),re=new i.bO(Z.lng,W.lat),ae=D.project(W),ye=D.project(Z),fe=this.queryTerrainElevation(W),xe=this.queryTerrainElevation(Z),_e=this.queryTerrainElevation(te),Ee=this.queryTerrainElevation(re),Fe=[[ae.x,ae.y,Math.min(fe||0,xe||0,_e||0,Ee||0)],[ye.x,ye.y,Math.max(fe||0,xe||0,_e||0,Ee||0)]];let De=i.cd.fromPoints(Fe);const Ze=D.getWorldToCameraMatrix(),Ue=i.ab.mat4.invert(new Float64Array(16),Ze);De=i.cd.applyTransform(De,Ze);const qe=this._extendAABB(De,D,q,S);if(!qe)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");De=qe;const Ve=.5*i.ab.vec3.sub([],De.max,De.min)[2],Ke=this._minimumAABBFrustumDistance(D,De),it=[0,0,1,0];i.ab.vec4.transformMat4(it,it,Ze),i.ab.vec4.normalize(it,it);const _t=i.ab.vec3.scale([],it,Ke+Ve),pt=i.ab.vec3.add([],De.center,_t);i.ab.vec3.transformMat4(De.center,De.center,Ue),i.ab.vec3.transformMat4(pt,pt,Ue);const Ct=D.unproject(new i.P(De.center[0],De.center[1])),Mt=i.dE(D.projection,Ct),ut=Math.pow(2,Mt),Tt=Math.min(D._zoomFromMercatorZ(pt[2]*D.pixelsPerMeter*ut/D.worldSize),q.maxZoom);return D.mercatorFromTransition&&Tt<.5*(i.c6+i.bY)?(D.setProjection({name:"globe"}),D.zoom=Tt,this._cameraForBounds(D,u,y,S,P,O)):{center:Ct,zoom:Tt,bearing:S,pitch:P}}fitBounds(s,u,y){const S=this.cameraForBounds(s,u);return this._fitInternal(S,u,y)}fitScreenCoordinates(s,u,y,S,P){const O=i.P.convert(s),D=i.P.convert(u),q=new i.P(Math.min(O.x,D.x),Math.min(O.y,D.y)),W=new i.P(Math.max(O.x,D.x),Math.max(O.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(O,D))return this;const Z=this.transform.pointLocation3D(q),te=this.transform.pointLocation3D(W),re=this.transform.pointLocation3D(new i.P(q.x,W.y)),ae=this.transform.pointLocation3D(new i.P(W.x,q.y)),ye=[Math.min(Z.lng,te.lng,re.lng,ae.lng),Math.min(Z.lat,te.lat,re.lat,ae.lat)],fe=[Math.max(Z.lng,te.lng,re.lng,ae.lng),Math.max(Z.lat,te.lat,re.lat,ae.lat)],xe=S&&S.pitch?S.pitch:this.getPitch(),_e=this._cameraForBounds(this.transform,ye,fe,y,xe,S);return this._fitInternal(_e,S,P)}_fitInternal(s,u,y){return s?(u=i.l(s,u)).linear?this.easeTo(u,y):this.flyTo(u,y):this}jumpTo(s,u){this.stop();const y=s.preloadOnly?this.transform.clone():this.transform;let S=!1,P=!1,O=!1;"zoom"in s&&y.zoom!==+s.zoom&&(S=!0,y.zoom=+s.zoom),s.center!==void 0&&(y.center=i.bO.convert(s.center)),"bearing"in s&&y.bearing!==+s.bearing&&(P=!0,y.bearing=+s.bearing),"pitch"in s&&y.pitch!==+s.pitch&&(O=!0,y.pitch=+s.pitch);const D=typeof s.padding=="number"?this._extendPadding(s.padding):s.padding;if(s.padding!=null&&!y.isPaddingEqual(D))if(s.retainPadding===!1){const q=y.clone();q.padding=D,y.setLocationAtPoint(y.center,q.centerPoint)}else y.padding=D;return s.preloadOnly?(this._preloadTiles(y),this):(this.fire(new i.z("movestart",u)).fire(new i.z("move",u)),S&&this.fire(new i.z("zoomstart",u)).fire(new i.z("zoom",u)).fire(new i.z("zoomend",u)),P&&this.fire(new i.z("rotatestart",u)).fire(new i.z("rotate",u)).fire(new i.z("rotateend",u)),O&&this.fire(new i.z("pitchstart",u)).fire(new i.z("pitch",u)).fire(new i.z("pitchend",u)),this.fire(new i.z("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(g_),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,u){const y=this.transform;if(!y.projection.supportsFreeCamera)return i.w(g_),this;this.stop();const S=y.zoom,P=y.pitch,O=y.bearing;y.setFreeCameraOptions(s);const D=S!==y.zoom,q=P!==y.pitch,W=O!==y.bearing;return this.fire(new i.z("movestart",u)).fire(new i.z("move",u)),D&&this.fire(new i.z("zoomstart",u)).fire(new i.z("zoom",u)).fire(new i.z("zoomend",u)),W&&this.fire(new i.z("rotatestart",u)).fire(new i.z("rotate",u)).fire(new i.z("rotateend",u)),q&&this.fire(new i.z("pitchstart",u)).fire(new i.z("pitch",u)).fire(new i.z("pitchend",u)),this.fire(new i.z("moveend",u)),this}easeTo(s,u){this._stop(!1,s.easeId),((s=i.l({offset:[0,0],duration:500,easing:i.dA},s)).animate===!1||this._prefersReducedMotion(s))&&(s.duration=0);const y=this.transform,S=this.getZoom(),P=this.getBearing(),O=this.getPitch(),D=this.getPadding(),q="zoom"in s?+s.zoom:S,W="bearing"in s?this._normalizeBearing(s.bearing,P):P,Z="pitch"in s?+s.pitch:O,te=this._extendPadding(s.padding),re=i.P.convert(s.offset);let ae,ye,fe;if(y.projection.name==="globe"){const it=i.aa.fromLngLat(y.center),_t=re.rotate(-y.angle);it.x+=_t.x/y.worldSize,it.y+=_t.y/y.worldSize;const pt=it.toLngLat(),Ct=i.bO.convert(s.center||pt);this._normalizeCenter(Ct),ae=y.centerPoint.add(_t),ye=new i.P(it.x,it.y).mult(y.worldSize),fe=new i.P(i.at(Ct.lng),i.aA(Ct.lat)).mult(y.worldSize).sub(ye)}else{ae=y.centerPoint.add(re);const it=y.pointLocation(ae),_t=i.bO.convert(s.center||it);this._normalizeCenter(_t),ye=y.project(it),fe=y.project(_t).sub(ye)}const xe=y.zoomScale(q-S);let _e,Ee;s.around&&(_e=i.bO.convert(s.around),Ee=y.locationPoint(_e));const Fe=this._zooming||q!==S,De=this._rotating||P!==W,Ze=this._pitching||Z!==O,Ue=!y.isPaddingEqual(te),qe=s.retainPadding===!1?y.clone():y,Ve=it=>_t=>{if(Fe&&(it.zoom=i.af(S,q,_t)),De&&(it.bearing=i.af(P,W,_t)),Ze&&(it.pitch=i.af(O,Z,_t)),Ue&&(qe.interpolatePadding(D,te,_t),ae=qe.centerPoint.add(re)),_e)it.setLocationAtPoint(_e,Ee);else{const pt=it.zoomScale(it.zoom-S),Ct=q>S?Math.min(2,xe):Math.max(.5,xe),Mt=Math.pow(Ct,1-_t),ut=it.unproject(ye.add(fe.mult(_t*Mt)).mult(pt));it.setLocationAtPoint(it.renderWorldCopies?ut.wrap():ut,ae)}return s.preloadOnly||this._fireMoveEvents(u),it};if(s.preloadOnly){const it=this._emulate(Ve,s.duration,y);return this._preloadTiles(it),this}const Ke={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Fe,this._rotating=De,this._pitching=Ze,this._padding=Ue,this._easeId=s.easeId,this._prepareEase(u,s.noMoveStart,Ke),this._ease(Ve(y),it=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(u,it)},s),this}_prepareEase(s,u,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||y.moving||this.fire(new i.z("movestart",s)),this._zooming&&!y.zooming&&this.fire(new i.z("zoomstart",s)),this._rotating&&!y.rotating&&this.fire(new i.z("rotatestart",s)),this._pitching&&!y.pitching&&this.fire(new i.z("pitchstart",s))}_fireMoveEvents(s){this.fire(new i.z("move",s)),this._zooming&&this.fire(new i.z("zoom",s)),this._rotating&&this.fire(new i.z("rotate",s)),this._pitching&&this.fire(new i.z("pitch",s))}_afterEase(s,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,S=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new i.z("zoomend",s)),S&&this.fire(new i.z("rotateend",s)),P&&this.fire(new i.z("pitchend",s)),this.fire(new i.z("moveend",s))}flyTo(s,u){if(this._prefersReducedMotion(s)){const Pt=i.ay(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Pt,u)}this.stop(),s=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},s);const y=this.transform,S=this.getZoom(),P=this.getBearing(),O=this.getPitch(),D=this.getPadding(),q="zoom"in s?i.aw(+s.zoom,y.minZoom,y.maxZoom):S,W="bearing"in s?this._normalizeBearing(s.bearing,P):P,Z="pitch"in s?+s.pitch:O,te=this._extendPadding(s.padding),re=y.zoomScale(q-S),ae=i.P.convert(s.offset);let ye=y.centerPoint.add(ae);const fe=y.pointLocation(ye),xe=i.bO.convert(s.center||fe);this._normalizeCenter(xe);const _e=y.project(fe),Ee=y.project(xe).sub(_e);let Fe=s.curve;const De=Math.max(y.width,y.height),Ze=De/re,Ue=Ee.mag();if("minZoom"in s){const Pt=i.aw(Math.min(s.minZoom,S,q),y.minZoom,y.maxZoom),Zt=De/y.zoomScale(Pt-S);Fe=Math.sqrt(Zt/Ue*2)}const qe=Fe*Fe;function Ve(Pt){const Zt=(Ze*Ze-De*De+(Pt?-1:1)*qe*qe*Ue*Ue)/(2*(Pt?Ze:De)*qe*Ue);return Math.log(Math.sqrt(Zt*Zt+1)-Zt)}function Ke(Pt){return(Math.exp(Pt)-Math.exp(-Pt))/2}function it(Pt){return(Math.exp(Pt)+Math.exp(-Pt))/2}const _t=Ve(0);let pt=function(Pt){return it(_t)/it(_t+Fe*Pt)},Ct=function(Pt){return De*((it(_t)*(Ke(Zt=_t+Fe*Pt)/it(Zt))-Ke(_t))/qe)/Ue;var Zt},Mt=(Ve(1)-_t)/Fe;if(Math.abs(Ue)<1e-6||!isFinite(Mt)){if(Math.abs(De-Ze)<1e-6)return this.easeTo(s,u);const Pt=Ze<De?-1:1;Mt=Math.abs(Math.log(Ze/De))/Fe,Ct=function(){return 0},pt=function(Zt){return Math.exp(Pt*Fe*Zt)}}s.duration="duration"in s?+s.duration:1e3*Mt/("screenSpeed"in s?+s.screenSpeed/Fe:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const ut=P!==W,Tt=Z!==O,Bt=!y.isPaddingEqual(te),ft=s.retainPadding===!1?y.clone():y,Dt=Pt=>Zt=>{const zt=Zt*Mt,Nt=1/pt(zt);Pt.zoom=Zt===1?q:S+Pt.scaleZoom(Nt),ut&&(Pt.bearing=i.af(P,W,Zt)),Tt&&(Pt.pitch=i.af(O,Z,Zt)),Bt&&(ft.interpolatePadding(D,te,Zt),ye=ft.centerPoint.add(ae));const qt=Zt===1?xe:Pt.unproject(_e.add(Ee.mult(Ct(zt))).mult(Nt));return Pt.setLocationAtPoint(Pt.renderWorldCopies?qt.wrap():qt,ye),Pt._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(u),Pt};if(s.preloadOnly){const Pt=this._emulate(Dt,s.duration,y);return this._preloadTiles(Pt),this}return this._zooming=!0,this._rotating=ut,this._pitching=Tt,this._padding=Bt,this._prepareEase(u,!1),this._ease(Dt(y),()=>this._afterEase(u),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,u)}if(!s){const y=this.handlers;y&&y.stop(!1)}return this}_ease(s,u,y){y.animate===!1||y.duration===0?(s(1),u()):(this._easeStart=i.q.now(),this._easeOptions=y,this._onEaseFrame=s,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,u){s=i.bF(s,-180,180);const y=Math.abs(s-u);return Math.abs(s-360-u)<y&&(s-=360),Math.abs(s+360-u)<y&&(s+=360),s}_normalizeCenter(s){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const y=s.lng-u.center.lng;s.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,u,y){const S=Math.ceil(15*u/1e3),P=[],O=s(y.clone());for(let D=0;D<=S;D++){const q=O(D/S);P.push(q.clone())}return P}_preloadTiles(s,u){}}class Af{constructor(s={}){this.options=s,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const u=this.options&&this.options.compact,y=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=U("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=U("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const S=U("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",y),this._innerContainer=U("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(s){const y=u.reduce((S,P,O)=>(P.value&&(S+=`${P.key}=${P.value}${O<u.length-1?"&":""}`),S),"?");s.href=`${i.e.FEEDBACK_URL}/${y}#${Qm(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const u=this._map.style._mergedSourceCaches;for(const S in u){const P=u[S];if(P.used){const O=P.getSource();O.attribution&&s.indexOf(O.attribution)<0&&s.push(O.attribution)}}s.sort((S,P)=>S.length-P.length),s=s.filter((S,P)=>{for(let O=P+1;O<s.length;O++)if(s[O].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const y=s.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,s.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ks{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=U("div","mapboxgl-ctrl");const u=U("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&s.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(Object.entries(s).length===0)return!0;for(const u in s){const y=s[u].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const u=s[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class cs{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const u=++this._id;return this._queue.push({callback:s,id:u,cancelled:!1}),u}remove(s){const u=this._currentlyRunning,y=u?this._queue.concat(u):this._queue;for(const S of y)if(S.id===s)return void(S.cancelled=!0)}run(s=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const y of u)if(!y.cancelled&&(y.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Ws{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const u=i.cB((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,u,y){this._start=this.getValue(u),this._end=s,this._startTime=u,this._endTime=u+y}}const lh={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class ld extends i.z{constructor(s,u,y,S){const{point:P,lngLat:O,originalEvent:D,target:q}=s;super(s.type,{point:P,lngLat:O,originalEvent:D,target:q}),this.preventDefault=()=>{s.preventDefault()},this.id=u,this.interaction=y,this.feature=S}}class zp{constructor(s){this.map=s,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(s,u){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const y=u.filter;let S=u.type;y&&this.filters.set(s,i.aZ(y)),S==="mouseover"&&(S="mouseenter"),S==="mouseout"&&(S="mouseleave");const P=this.interactionsByType.get(S)||new Map;S==="mouseenter"||S==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(s,u)):P.size===0&&this.map.on(S,this.handleType),P.size===0&&this.interactionsByType.set(S,P),P.set(s,u),this.typeById.set(s,S)}get(s){const u=this.typeById.get(s);if(!u)return;const y=this.interactionsByType.get(u);return y?y.get(s):void 0}remove(s){const u=this.typeById.get(s);if(!u)return;this.typeById.delete(s),this.filters.delete(s);const y=this.interactionsByType.get(u);y&&(y.delete(s),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(s),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(u,this.handleType))}queryTargets(s,u){const y=[];for(const[S,P]of u)P.target&&y.push({targetId:S,target:P.target,filter:this.filters.get(S)});return this.map.style.queryRenderedTargets(s,y,this.map.transform)}handleMove(s){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(s.point,Array.from(this.delegatedInteractions).reverse());u.length&&(s.type="mouseenter",this.handleType(s,u));const y=new Map;for(const[S,{feature:P}]of this.prevHoveredFeatures)this.hoveredFeatures.has(S)||y.set(P.id,P);y.size&&(s.type="mouseleave",this.handleType(s,Array.from(y.values())))}handleOut(s){const u=Array.from(this.hoveredFeatures.values()).map(({feature:y})=>y);u.length&&(s.type="mouseleave",this.handleType(s,u)),this.hoveredFeatures.clear()}handleType(s,u){const y=Array.from(this.interactionsByType.get(s.type)).reverse(),S=!!u;u=u||this.queryTargets(s.point,y);const P=s.type==="mouseenter";let O=!1;const D=new Set;for(const q of u){for(const[W,Z]of y){if(!Z.target)continue;const te=q.variants?q.variants[W]:null;if(te){for(const re of te){if(bl(re,q,D,W))continue;const ae=new i.cw(q,re),ye=Nu(re,q,W);S&&(ae.state=this.map.getFeatureState(ae));const fe=P?this.prevHoveredFeatures.get(ye):null,xe=new ld(s,W,Z,ae),_e=fe?fe.stop:Z.handler(xe);if(P&&this.hoveredFeatures.set(ye,{feature:q,stop:_e}),_e!==!1){O=!0;break}}if(O)break}}if(O)break}if(!O)for(const[q,W]of y){const{handler:Z,target:te}=W;if(!te&&Z(new ld(s,q,W,null))!==!1)break}}}function Zn(g,s){if(Array.isArray(g)&&Array.isArray(s)){const u=new Set(g),y=new Set(s);return u.size===y.size&&g.every(S=>y.has(S))}return i.bn(g,s)}const uu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Fp={showCompass:!0,showZoom:!0,visualizePitch:!1};class us{constructor(s,u,y=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new kl({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,y&&(this.mousePitch=new Pc({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(s,u){this.mouseRotate.mousedown(s,u),this.mousePitch&&this.mousePitch.mousedown(s,u),le()}move(s,u){const y=this.map,S=this.mouseRotate.mousemoveWindow(s,u),P=S&&S.bearingDelta;if(P&&y.setBearing(y.getBearing()+P),this.mousePitch){const O=this.mousePitch.mousemoveWindow(s,u),D=O&&O.pitchDelta;D&&y.setPitch(y.getPitch()+D)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ne(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(i.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),ve(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,ve(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){s.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ae(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){s.targetTouches.length!==1?this.reset():(this._lastPos=Ae(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){s.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function ig(g,s,u){if(g=new i.bO(g.lng,g.lat),s){const y=new i.bO(g.lng-360,g.lat),S=new i.bO(g.lng+360,g.lat),P=360*Math.ceil(Math.abs(g.lng-u.center.lng)/360),O=u.locationPoint(g).distSqr(s),D=s.x<0||s.y<0||s.x>u.width||s.y>u.height;u.locationPoint(y).distSqr(s)<O&&(D||Math.abs(y.lng-u.center.lng)<P)?g=y:u.locationPoint(S).distSqr(s)<O&&(D||Math.abs(S.lng-u.center.lng)<P)&&(g=S)}for(;Math.abs(g.lng-u.center.lng)>180;){const y=u.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=u.width&&y.y<=u.height)break;g.lng>u.center.lng?g.lng-=360:g.lng+=360}return g}const Cc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Hs extends i.E{constructor(s,u){if(super(),(s instanceof HTMLElement||u)&&(s=i.l({element:s},u)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=s&&s.occludedOpacity||.2,s&&s.element)this._element=s.element,this._offset=i.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=U("div");const P=41,O=27,D=G("svg",{display:"block",height:P*this._scale+"px",width:O*this._scale+"px",viewBox:`0 0 ${O} ${P}`},this._element),q=G("radialGradient",{id:"shadowGradient"},G("defs",{},D));G("stop",{offset:"10%","stop-opacity":.4},q),G("stop",{offset:"100%","stop-opacity":.05},q),G("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),G("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),G("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),G("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=i.P.convert(s&&s.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",P=>{P.preventDefault()}),this._element.addEventListener("mousedown",P=>{P.preventDefault()});const y=this._element.classList;for(const P in Cc)y.remove(`mapboxgl-marker-anchor-${P}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const S=s&&s.className?s.className.trim().split(/\s+/):[];y.add(...S),this._popup=null}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=i.bO.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=s,s._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const u=s.code,y=s.charCode||s.keyCode;u!=="Space"&&u!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(s){const u=s.originalEvent.target,y=this._element;this._popup&&(u===y||y.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,u=this._pos;if(!s||!u)return!1;const y=s.unproject(u),S=s.getFreeCameraOptions();if(!S.position)return!1;const P=S.position.toLngLat();return P.distanceTo(y)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const u=this._pos;if(!u||u.x<0||u.x>s.transform.width||u.y<0||u.y>s.transform.height)return void this._clearFadeTimer();const y=s.unproject(u);let S;s._showingGlobe()&&i.dH(s.transform,this._lngLat)?S=0:(S=1-s._queryFogOpacity(y),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${s.x}px,${s.y}px)
            ${Cc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const s=this._pos,u=this._map,y=this.getPitchAlignment();if(!u||!s||y!=="map")return"";if(!u._showingGlobe()){const q=u.getPitch();return q?`rotateX(${q}deg)`:""}const S=i.c4(i.dI(u.transform,this._lngLat)),P=s.sub(i.dJ(u.transform)),O=Math.abs(P.x)+Math.abs(P.y);if(O===0)return"";const D=S/O;return`rotateX(${-P.y*D}deg) rotateY(${P.x*D}deg)`}_calculateZTransform(){const s=this._pos,u=this._map;if(!u||!s)return"";let y=0;const S=this.getRotationAlignment();if(S==="map")if(u._showingGlobe()){const P=u.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),O=u.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);y=i.c4(Math.atan2(O.y,O.x))-90}else y=-u.getBearing();else if(S==="horizon"){const P=i.ac(4,6,u.getZoom()),O=i.dJ(u.transform);O.y+=P*u.transform.height;const D=s.sub(O),q=i.c4(Math.atan2(D.y,D.x));y=(q>90?q-270:q+90)*(1-P)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=ig(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat),s===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=i.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const u=this._map;if(!u)return;const y=this._pointerdownPos,S=this._positionDelta;if(y&&S){if(!this._isDragging){const P=this._clickTolerance||u._clickTolerance;if(s.point.dist(y)<P)return;this._isDragging=!0}this._pos=s.point.sub(S),this._lngLat=u.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(s){const u=this._map,y=this._pos;u&&y&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(y),this._pointerdownPos=s.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const u=this._map;return u&&(s?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const qi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Zs={maxWidth:100,unit:"metric"},zr={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ch={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Zo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ag(g=new i.P(0,0),s="bottom"){if(typeof g=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(s){case"top":return new i.P(0,g);case"top-left":return new i.P(u,u);case"top-right":return new i.P(-u,u);case"bottom":return new i.P(0,-g);case"bottom-left":return new i.P(u,-u);case"bottom-right":return new i.P(-u,-u);case"left":return new i.P(g,0);case"right":return new i.P(-g,0)}return new i.P(0,0)}return g instanceof i.P||Array.isArray(g)?i.P.convert(g):i.P.convert(g[s]||[0,0])}return{version:_,supported:V.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends sh{constructor(g){A.mark(w.create);const s=g;if((g=i.l({},uu,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&i.dF(window)&&(g.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qh(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new cs,this._domRenderTaskQueue=new cs,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},lh,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ws(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new et(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const u=document.getElementById(g.container);if(!u)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=u}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Zm),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Lp(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||i.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new py(this),g.hash&&(this._hash=new Ey(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){s.center==null&&s.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const u=g.bounds;u&&(this.resize(),this.fitBounds(u,i.l({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new Af({customAttribution:g.customAttribution})),this._logoControl=new Ks,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new i.z(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new i.z(`${u.dataType}dataloading`,u))}),this._interactions=new zp(this)}_getMapId(){return this._mapId}addControl(g,s){if(s===void 0&&(s=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[s];return s.indexOf("bottom")!==-1?y.insertBefore(u,y.firstChild):y.appendChild(u),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(g);return s>-1&&this._controls.splice(s,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new i.z("movestart",g)).fire(new i.z("move",g)),this.fire(new i.z("resize",g)),s&&this.fire(new i.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(i.az.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>s.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(s=>s==="auto"?navigator.language:s):g}setLanguage(g){const s=this._parseLanguage(g);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,s=g.projection.name;let u;s==="globe"&&g.zoom>=i.bY?(g.setMercatorFromTransition(),u=!0):s==="mercator"&&g.zoom<i.bY&&(g.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,s){return this._updateProjection(g||s||{name:"mercator"})}_updateProjection(g){let s;return s=g.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g){return this.transform.locationPoint3D(i.bO.convert(g))}unproject(g){return this.transform.pointLocation3D(i.P.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,s,u){const y=S=>{let P=[];if(Array.isArray(s)){const O=s.filter(D=>this.getLayer(D));P=O.length?this.queryRenderedFeatures(S,{layers:O}):[]}else P=this.queryRenderedFeatures(S,{target:s});return P};if(g==="mouseenter"||g==="mouseover"){let S=!1;return{listener:u,targets:s,delegates:{mousemove:O=>{const D=y(O.point);D.length?S||(S=!0,u.call(this,new Ts(g,this,O.originalEvent,{features:D}))):S=!1},mouseout:()=>{S=!1}}}}if(g==="mouseleave"||g==="mouseout"){let S=!1;return{listener:u,targets:s,delegates:{mousemove:D=>{y(D.point).length?S=!0:S&&(S=!1,u.call(this,new Ts(g,this,D.originalEvent)))},mouseout:D=>{S&&(S=!1,u.call(this,new Ts(g,this,D.originalEvent)))}}}}{const S=P=>{const O=y(P.point);O.length&&(P.features=O,u.call(this,P),delete P.features)};return{listener:u,targets:s,delegates:{[g]:S}}}}on(g,s,u){if(typeof s=="function"||u===void 0)return super.on(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const y=this._createDelegatedListener(g,s,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const S in y.delegates)this.on(S,y.delegates[S]);return this}once(g,s,u){if(typeof s=="function"||u===void 0)return super.once(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const y=this._createDelegatedListener(g,s,u);for(const S in y.delegates)this.once(S,y.delegates[S]);return this}off(g,s,u){if(typeof s=="function"||u===void 0)return super.off(g,s);if(typeof s=="string"&&(s=[s]),!this._areTargetsValid(s))return this;const y=this._delegatedListeners?this._delegatedListeners[g]:void 0;return y&&(S=>{for(let P=0;P<S.length;P++){const O=S[P];if(O.listener===u&&Zn(O.targets,s)){for(const D in O.delegates)this.off(D,O.delegates[D]);return S.splice(P,1),this}}})(y),this}queryRenderedFeatures(g,s){if(!this.style)return[];if(g===void 0||g instanceof i.P||Array.isArray(g)||s!==void 0||(s=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!s){const P=this.style.queryRenderedFeatures(g,void 0,this.transform),O=this.style.queryRenderedFeatureset(g,void 0,this.transform);return P.concat(O)}let u=!0;if(s.target&&(u=this._isTargetValid(s.target),u&&!s.layers))return this.style.queryRenderedFeatureset(g,s,this.transform);let y=!0;if(s.layers&&Array.isArray(s.layers)){for(const P of s.layers)if(!this._isValidId(P)){y=!1;break}if(y&&!s.target)return this.style.queryRenderedFeatures(g,s,this.transform)}let S=[];return y&&(S=S.concat(this.style.queryRenderedFeatures(g,s,this.transform))),u&&(S=S.concat(this.style.queryRenderedFeatureset(g,s,this.transform))),S}querySourceFeatures(g,s){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,s)}isPointOnSurface(g){const{name:s}=this.transform.projection;return s!=="globe"&&s!=="mercator"&&i.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(g))}addInteraction(g,s){return this._interactions.add(g,s),this}removeInteraction(g){return this._interactions.remove(g),this}setStyle(g,s){return s=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&g&&s.diff!==!1&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(g,(u,y)=>{u?(i.w(`Unable to perform style diff: ${String(u.message||u.error||u)}. Rebuilding the style from scratch.`),this._updateStyle(g,s)):y&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(g,s))}_getUIString(g){const s=this._locale[g];if(s==null)throw new Error(`Missing UI string '${g}'`);return s}_updateStyle(g,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const u=i.l({},s);s&&s.config&&(u.initialConfig=s.config,delete u.config),this.style=new Fs(this,u).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Fs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(g)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const s of g)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(g)}addSource(g,s){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,s),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,s,u){this._lazyInitEmptyStyle(),this.style.addSourceType(g,s,u)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,s,{pixelRatio:u=1,sdf:y=!1,stretchX:S,stretchY:P,content:O}={}){if(this._lazyInitEmptyStyle(),s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:D,height:q,data:W}=i.q.getImageData(s);this.style.addImage(g,{data:new i.r({width:D,height:q},W),pixelRatio:u,stretchX:S,stretchY:P,content:O,sdf:y,version:0,usvg:!1})}else if(s.width===void 0||s.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:q}=s,W=s;this.style.addImage(g,{data:new i.r({width:D,height:q},new Uint8Array(W.data)),pixelRatio:u,stretchX:S,stretchY:P,content:O,sdf:y,usvg:!1,version:0,userImage:W}),W.onAdd&&W.onAdd(this,g)}}updateImage(g,s){this._lazyInitEmptyStyle();const u=this.style.getImage(g);if(!u)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?i.q.getImageData(s):s,{width:S,height:P,data:O}=y;if(S===void 0||P===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(u.usvg?u.icon.usvg_tree.width:u.data.width)||P!==(u.usvg?u.icon.usvg_tree.height:u.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${S}, ${P})
                must be that same as the previous version of the image
                (${u.data.width}, ${u.data.height})`)));const D=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let q=!1;u.usvg?(u.data=new i.r({width:S,height:P},new Uint8Array(O)),u.usvg=!1,u.icon=void 0,q=!0):u.data.replace(O,D),this.style.updateImage(g,u,q)}hasImage(g){return g?!!this.style&&!!this.style.getImage(g):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,s){i.o(this._requestManager.transformRequest(g,i.R.Image),(u,y)=>{s(u,y instanceof HTMLImageElement?i.q.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(g,s){this._lazyInitEmptyStyle(),this.style.addModel(g,s)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,s){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,s),this._update(!0)):this}getSlot(g){const s=this.getLayer(g);return s&&s.slot||null}setSlot(g,s){return this.style.setSlot(g,s),this.style.mergeLayers(),this._update(!0)}addImport(g,s){return this.style.addImport(g,s),this}updateImport(g,s){return typeof s!="string"&&s.id!==g?(this.removeImport(g),this.addImport(s)):(this.style.updateImport(g,s),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,s){return this.style.moveImport(g,s),this._update(!0)}moveLayer(g,s){return this._isValidId(g)?(this.style.moveLayer(g,s),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const s=this.style.getOwnLayer(g);return s?s.type==="custom"?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,s,u){return this._isValidId(g)?(this.style.setLayerZoomRange(g,s,u),this._update(!0)):this}setFilter(g,s,u={}){return this._isValidId(g)?(this.style.setFilter(g,s,u),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,s,u,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,s,u,y),this._update(!0)):this}getPaintProperty(g,s){return this._isValidId(g)?this.style.getPaintProperty(g,s):null}setLayoutProperty(g,s,u,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,s,u,y),this._update(!0)):this}getLayoutProperty(g,s){return this._isValidId(g)?this.style.getLayoutProperty(g,s):null}getSchema(g){return this.style.getSchema(g)}setSchema(g,s){return this.style.setSchema(g,s),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,s){return this.style.setConfig(g,s),this._update(!0)}getConfigProperty(g,s){return this.style.getConfigProperty(g,s)}setConfigProperty(g,s,u){return this.style.setConfigProperty(g,s,u),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const s=g[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,s),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(g),this.transform):0}setFeatureState(g,s){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,s),this._update())}removeFeatureState(g,s){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,s),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let u,y,S,P=this._container;for(;P&&(!y||!S);){const O=window.getComputedStyle(P).transform;O&&O!=="none"&&(u=O.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(y=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(S=u[3])),P=P.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=S?Math.abs(s/S):s}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=U("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=U("div","mapboxgl-canvas-container",g);this._canvas=U("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=U("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(S=>{y[S]=U("div",`mapboxgl-ctrl-${S}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,s){const u=i.q.devicePixelRatio||1;this._canvas.width=u*Math.ceil(g),this._canvas.height=u*Math.ceil(s),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${s}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const s=this._markers.indexOf(g);s!==-1&&this._markers.splice(s,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const s=this._popups.indexOf(g);s!==-1&&this._popups.splice(s,1)}_setupPainter(){const g=i.l({},V.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",g);s?(Jt(s,!0),this.painter=new Jm(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",u=>{u.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(s)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let s;this.fire(new i.z("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,y=i.q.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=S.createQuery(),S.beginQuery(u.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const P=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const W=this.transform.zoom,Z=this.transform.pitch,te=i.q.now(),re=new i.a8(W,{now:te,fadeDuration:P,pitch:Z,transition:this.style.transition});this.style.update(re)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let O=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),O=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):O=this._updateAverageElevation(y);const D=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),D&&(this._placementDirty=D.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,A.mark(w.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const W=i.q.now()-y;S.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const Z=S.getQueryParameter(s,S.QUERY_RESULT)/1e6;S.deleteQuery(s),this.fire(new i.z("gpu-timing-frame",{cpuTime:W,gpuTime:Z}))},50)}if(this.listens("gpu-timing-layer")){const W=this.painter.collectGpuTimers();setTimeout(()=>{const Z=this.painter.queryGpuTimers(W);this.fire(new i.z("gpu-timing-layer",{layerTimes:Z}))},50)}if(this.listens("gpu-timing-deferred-render")){const W=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Z=this.painter.queryGpuTimeDeferredRender(W);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:Z}))},50)}const q=this._sourcesDirty||this._styleDirty||this._placementDirty||O;if(q||this._repaint)this.triggerRepaint();else{const W=this.idle();if(W&&(O=this._updateAverageElevation(y,!0)),O)this.triggerRepaint();else if(this._triggerFrame(!1),W&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Z=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:Z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,A.mark(w.fullLoad),this._performanceMetricsCollection&&br(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const s of this._markers)g&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!g||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(g,s=!1){const u=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(s||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const S=this.transform.averageElevation;let P=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(P)?P=0:this._averageElevationLastSampledAt=g;const O=Math.abs(S-P);if(O>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(P),u(P);this._averageElevation.easeTo(P,g,300)}else if(O>1e-4)return this._averageElevation.jumpTo(P),u(P)}return!!this._averageElevation.isEasing(g)&&u(this._averageElevation.getValue(g))}_authenticate(){Be(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===ze||g.status===401)){const s=this.painter.context.gl;Jt(s,!1),this._logoControl instanceof Ks&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Qt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&sr(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const u=this.painter.context.gl,y=u.createFramebuffer();function S(P){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,P,0);const O=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,O),O}return u.bindFramebuffer(u.FRAMEBUFFER,y),this._canvasPixelComparison(S(g),s.canvasCopies.map(S),s.timeStamps)}_canvasPixelComparison(g,s,u){let y=u[1]-u[0];const S=g.length/4;for(let P=0;P<s.length;P++){const O=s[P];let D=0;for(let q=0;q<O.length;q+=4)O[q]===g[q]&&O[q+1]===g[q+1]&&O[q+2]===g[q+2]&&O[q+3]===g[q+3]&&(D+=1);y+=(u[P+2]-u[P+1])*(1-D/S)}return y}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Nr.delete(this.painter.context.gl),Wt.remove(),tt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=i.q.frame(s=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(s)}))}_preloadTiles(g){const s=this.style?this.style.getSourceCaches():[];return i.bl(s,(u,y)=>u._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,s){i.dG(g,s)}get version(){return _}},NavigationControl:class{constructor(g={}){this.options=i.l({},Fp,g),this._container=U("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),U("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),U("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:s}):u.resetNorth({},{originalEvent:s}))}),this._compassIcon=U("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const s=g.getZoom(),u=s===g.getMaxZoom(),y=s===g.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new us(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,s){const u=U("button",g,this._container);return u.type="button",u.addEventListener("click",s),u}_setButtonTitle(g,s){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${s}`);g.setAttribute("aria-label",u),g.firstElementChild&&g.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends i.E{constructor(g={}){super();const s=navigator.geolocation;this.options=i.l({geolocation:s},qi,g),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=kp(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=U("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const s=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,g(u)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>s(u.state!=="denied")).catch(()=>s()):s()}_isOutOfMapMaxBounds(g){const s=this._map.getMaxBounds(),u=g.coords;return!!s&&(u.longitude<s.getWest()||u.longitude>s.getEast()||u.latitude<s.getSouth()||u.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",g)),this._finish()}}_updateCamera(g){const s=new i.bO(g.coords.longitude,g.coords.latitude),u=g.coords.accuracy,y=this._map.getBearing(),S=i.l({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(u),S,{geolocateSource:!0})}_updateMarker(g){if(g){const s=new i.bO(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,s=i.bH(1,g._center.lat)*g.worldSize,u=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=U("button","mapboxgl-ctrl-geolocate",this._container),U("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=U("div","mapboxgl-user-location"),this._dotElement.appendChild(U("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(U("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Hs({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=U("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Hs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(s=>{s==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Af,ScaleControl:class{constructor(g={}){this.options=i.l({},Zs,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,s=this._map,u=s._containerHeight/2,y=s._containerWidth/2-g/2,S=s.unproject([y,u]),P=s.unproject([y+g,u]),O=S.distanceTo(P);if(this.options.unit==="imperial"){const D=3.2808*O;D>5280?this._setScale(g,D/5280,"mile"):this._setScale(g,D,"foot")}else this.options.unit==="nautical"?this._setScale(g,O/1852,"nautical-mile"):O>=1e3?this._setScale(g,O/1e3,"kilometer"):this._setScale(g,O,"meter")}_setScale(g,s,u){this._map._requestDomTask(()=>{const y=function(P){const O=Math.pow(10,`${Math.floor(P)}`.length-1);let D=P/O;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:function(q){const W=Math.pow(10,Math.ceil(-Math.log(q)/Math.LN10));return Math.round(q*W)/W}(D),O*D}(s),S=y/s;this._container.innerHTML=this._isNumberFormatSupported&&u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(y):`${y}&nbsp;${zr[u]}`,this._container.style.width=g*S+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=U("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=U("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=U("button","mapboxgl-ctrl-fullscreen",this._controlContainer);U("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(g){super(),this.options=i.l(Object.create(ch),g),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=i.bO.convert(g),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const s=document.createDocumentFragment(),u=document.createElement("body");let y;for(u.innerHTML=g;y=u.firstChild,y;)s.appendChild(y);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=U("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(g),this.options.closeButton){const u=this._closeButton=U("button","mapboxgl-popup-close-button",s);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let s;return this._classList.delete(g)?s=!1:(this._classList.add(g),s=!0),this._updateClassList(),s}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const s=this._map,u=this._container,y=this._pos;if(!s||!u||!y)return"bottom";const S=u.offsetWidth,P=u.offsetHeight,O=y.x<S/2,D=y.x>s.transform.width-S/2;if(y.y+g<P)return O?"top-left":D?"top-right":"top";if(y.y>s.transform.height-P){if(O)return"bottom-left";if(D)return"bottom-right"}return O?"left":D?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),g.className=s.join(" ")}_update(g){const s=this._map,u=this._content;if(!s||!this._lngLat&&!this._trackPointer||!u)return;let y=this._container;if(y||(y=this._container=U("div","mapboxgl-popup",s.getContainer()),this._tip=U("div","mapboxgl-popup-tip",y),y.appendChild(u)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ig(this._lngLat,this._pos,s.transform)),!this._trackPointer||g){const S=this._pos=this._trackPointer&&g instanceof i.P?g:s.project(this._lngLat),P=ag(this.options.offset),O=this._anchor=this._getAnchor(P.y),D=ag(this.options.offset,O),q=S.add(D).round();s._requestDomTask(()=>{this._container&&O&&(this._container.style.transform=`${Cc[O]} translate(${q.x}px,${q.y}px)`)})}if(!this._marker&&s._showingGlobe()){const S=i.dH(s.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Zo);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Hs,Style:Fs,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:up,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(g){i.e.ACCESS_TOKEN=g},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(g){i.e.API_URL=g},get workerCount(){return i.dO.workerCount},set workerCount(g){i.dO.workerCount=g},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){i.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){i.dP(g)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(g){i.dQ.workerUrl=g},get workerClass(){return i.dQ.workerClass},set workerClass(g){i.dQ.workerClass=g},get workerParams(){return i.dQ.workerParams},set workerParams(g){i.dQ.workerParams=g},get dracoUrl(){return i.dR()},set dracoUrl(g){i.dS(g)},get meshoptUrl(){return i.dT()},set meshoptUrl(g){i.dU(g)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var h=a;return h})}(bA)),bA.exports}var c6e=l6e();const eA=ta(c6e),Fj={Mati:{lat:6.90543,lng:126.198137},Baganga:{lat:7.138566,lng:126.19839},Banaybanay:{lat:7.052637,lng:126.271871},Caraga:{lat:7.040689,lng:126.405736},Cateel:{lat:7.03907,lng:126.073971},"Governor Generoso":{lat:7.023682,lng:126.135764},Lupon:{lat:6.996579,lng:126.157647},Manay:{lat:6.910817,lng:125.976873},"San Isidro":{lat:7.026718,lng:126.399461},Tarragona:{lat:7.090034,lng:126.217449},Boston:{lat:6.969014,lng:126.235561},Maco:{lat:7.036735,lng:126.414316},Mabini:{lat:7.012285,lng:125.970299},Pantukan:{lat:7.008709,lng:125.964125},Mawab:{lat:7.002258,lng:126.393666},Monkayo:{lat:6.950413,lng:126.203313},"New Bataan":{lat:7.037214,lng:125.949183},Compostela:{lat:7.0845,lng:126.9761},Laak:{lat:6.9046,lng:126.5307},Maragusan:{lat:7.1389,lng:126.2254}};function u6e(e,t="",r=""){if(!e)return null;const n=e.trim().replace(/\s+/g," ");if(Fj[n])return Fj[n];const a=n.toLowerCase();for(const[l,h]of Object.entries(Fj))if(l.toLowerCase().includes(a)||a.includes(l.toLowerCase()))return h;return console.warn(`No coordinates found for municipality: ${e}`),null}const d6e=({analyticsData:e,className:t=""})=>{const[r,n]=K.useState(!1),[a,l]=K.useState("year-over-year"),[h,i]=K.useState(null),[_,w]=K.useState(!1);K.useEffect(()=>{const le=()=>{const ue=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;n(ue)};le();const ne=new MutationObserver(le);ne.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const de=window.matchMedia("(prefers-color-scheme: dark)");return de.addEventListener("change",le),()=>{ne.disconnect(),de.removeEventListener("change",le)}},[]),K.useEffect(()=>{if(!e)return;w(!0);const le=A(e,a);i(le),w(!1)},[e,a]);const A=(le,ne)=>{if(!le||!le.trends||!le.trends.monthly)return null;const de=le.trends.monthly,ue=new Date().getFullYear();switch(ne){case"year-over-year":return C(de,ue);case"quarterly":return R(de);case"monthly-trend":return z(de);case"severity-comparison":return V(le);default:return null}},C=(le,ne)=>{const de=le.filter(Ae=>Ae._id.year===ne),ue=le.filter(Ae=>Ae._id.year===ne-1);return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((Ae,Oe)=>{const Se=de.find(ze=>ze._id.month===Oe+1),ke=ue.find(ze=>ze._id.month===Oe+1);return{month:Ae,current:(Se==null?void 0:Se.count)||0,previous:(ke==null?void 0:ke.count)||0,change:Se&&ke?(Se.count-ke.count)/ke.count*100:0}})},R=le=>{const ne=[{name:"Q1",months:[1,2,3]},{name:"Q2",months:[4,5,6]},{name:"Q3",months:[7,8,9]},{name:"Q4",months:[10,11,12]}],de=new Date().getFullYear(),ue=le.filter(Ae=>Ae._id.year===de),ve=le.filter(Ae=>Ae._id.year===de-1);return ne.map(Ae=>{const Oe=ue.filter(ke=>Ae.months.includes(ke._id.month)).reduce((ke,ze)=>ke+ze.count,0),Se=ve.filter(ke=>Ae.months.includes(ke._id.month)).reduce((ke,ze)=>ke+ze.count,0);return{quarter:Ae.name,current:Oe,previous:Se,change:Se>0?(Oe-Se)/Se*100:0}})},z=le=>{const ne=new Date().getFullYear(),de=le.filter(ue=>ue._id.year===ne);return de.map(ue=>({month:new Date(ue._id.year,ue._id.month-1).toLocaleDateString("en-US",{month:"short"}),accidents:ue.count,cumulative:de.filter(ve=>ve._id.month<=ue._id.month).reduce((ve,Ae)=>ve+Ae.count,0)}))},V=le=>{if(!le.distributions||!le.distributions.severity)return null;const ne=le.distributions.severity,de=ne.reduce((ue,ve)=>ue+ve.count,0);return ne.map(ue=>({severity:ue._id.charAt(0).toUpperCase()+ue._id.slice(1),count:ue.count,percentage:(ue.count/de*100).toFixed(1),trend:Math.random()>.5?"up":"down"}))},U=()=>r?["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"]:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],G=()=>{if(!h||_)return f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});switch(a){case"year-over-year":return f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(vte,{data:h,children:[f.jsx(js,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:r?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(le,ne)=>[le,ne==="current"?"Current Year":"Previous Year"]}),f.jsx(kh,{}),f.jsx(Ro,{dataKey:"previous",fill:U()[1],fillOpacity:.6,name:"Previous Year"}),f.jsx(Ro,{dataKey:"current",fill:U()[0],name:"Current Year"})]})});case"quarterly":return f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(Eh,{data:h,children:[f.jsx(js,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"quarter",stroke:r?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:r?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),f.jsx(Ro,{dataKey:"current",fill:U()[0],name:"Current Year"}),f.jsx(Ro,{dataKey:"previous",fill:U()[1],name:"Previous Year"})]})});case"monthly-trend":return f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(n4,{data:h,children:[f.jsx(js,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),f.jsx(co,{yAxisId:"left",stroke:r?"#9ca3af":"#6b7280"}),f.jsx(co,{yAxisId:"right",orientation:"right",stroke:r?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),f.jsx(kh,{}),f.jsx(_u,{yAxisId:"left",type:"monotone",dataKey:"accidents",stroke:U()[0],strokeWidth:3,name:"Monthly Accidents"}),f.jsx(_u,{yAxisId:"right",type:"monotone",dataKey:"cumulative",stroke:U()[1],strokeWidth:2,strokeDasharray:"5 5",name:"Cumulative Total"})]})});case"severity-comparison":return f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(Eh,{data:h,children:[f.jsx(js,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"severity",stroke:r?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:r?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(le,ne)=>[ne==="count"?`${le} accidents`:`${le}%`,ne==="count"?"Count":"Percentage"]}),f.jsx(Ro,{dataKey:"count",fill:U()[2]})]})});default:return null}},H=()=>{switch(a){case"year-over-year":return"Year-over-Year Comparison";case"quarterly":return"Quarterly Analysis";case"monthly-trend":return"Monthly Trend Analysis";case"severity-comparison":return"Severity Distribution Comparison";default:return"Comparison Analysis"}},J=()=>{switch(a){case"year-over-year":return"Compare current year accident data with previous year";case"quarterly":return"Quarterly breakdown of accident trends";case"monthly-trend":return"Monthly accident patterns with cumulative totals";case"severity-comparison":return"Accident severity distribution analysis";default:return"Comparative analysis of accident data"}},Q=()=>{if(!h||h.length===0)return null;switch(a){case"year-over-year":const le=h.reduce((ue,ve)=>ue+ve.current,0),ne=h.reduce((ue,ve)=>ue+ve.previous,0),de=ne>0?(le-ne)/ne*100:0;return f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[f.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Current Year"}),f.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:le}),f.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Total accidents"})]}),f.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Previous Year"}),f.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:ne}),f.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Total accidents"})]}),f.jsxs("div",{className:`p-3 rounded-lg ${de>=0?"bg-red-50 dark:bg-red-950/20":"bg-green-50 dark:bg-green-950/20"}`,children:[f.jsx("div",{className:`text-sm font-medium ${de>=0?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:"Year-over-Year Change"}),f.jsxs("div",{className:`text-lg font-bold ${de>=0?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:[de>=0?"+":"",de.toFixed(1),"%"]}),f.jsx("div",{className:`text-xs ${de>=0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:de>=0?"Increase":"Decrease"})]})]});default:return null}};return f.jsxs(Ai,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[f.jsx(Ci,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(zD,{className:"h-5 w-5 text-purple-500"}),H()]}),f.jsx(Ya,{children:J()})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs(fs,{value:a,onValueChange:l,children:[f.jsx(Qo,{className:"w-[180px]",children:f.jsx(ps,{})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"year-over-year",children:"Year-over-Year"}),f.jsx(Kr,{value:"quarterly",children:"Quarterly"}),f.jsx(Kr,{value:"monthly-trend",children:"Monthly Trend"}),f.jsx(Kr,{value:"severity-comparison",children:"Severity Comparison"})]})]})})]})}),f.jsxs(ji,{children:[G(),Q()]})]})},h6e=({accidents:e,className:t=""})=>{const r=K.useRef(null),n=K.useRef(null),[a,l]=K.useState(!1),[h,i]=K.useState(!1),[_,w]=K.useState(!1),[A,C]=K.useState(!0),[R,z]=K.useState(!1),[V,U]=K.useState("all"),[G,H]=K.useState("streets"),[J,Q]=K.useState(!1);K.useEffect(()=>{const Se=()=>{const et=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;w(et)};Se();const ke=new MutationObserver(Se);ke.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const ze=window.matchMedia("(prefers-color-scheme: dark)");return ze.addEventListener("change",Se),()=>{ke.disconnect(),ze.removeEventListener("change",Se)}},[]);const le=Se=>{const ke={streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-v9",outdoors:"mapbox://styles/mapbox/outdoors-v12",light:"mapbox://styles/mapbox/light-v11",dark:"mapbox://styles/mapbox/dark-v11"};return ke[Se]||ke.streets};K.useEffect(()=>{if(!e||e.length===0)return;const Se="pk.eyJ1IjoiY2xhcmVuY2VqYXBpbmFuIiwiYSI6ImNtOGk1NGh3bjA5bWwya3B0a2lzMGk0eDkifQ.Px83G0Hg6bYtv9E9teOTpQ";if(eA.accessToken=Se,!n.current)try{n.current=new eA.Map({container:r.current,style:le(G),center:[125.971907,6.90543],zoom:9}),n.current.addControl(new eA.NavigationControl,"top-right"),n.current.on("load",()=>{l(!0),ne()}),n.current.on("error",ke=>{console.error("Map error:",ke),i(!0)})}catch(ke){console.error("Map initialization error:",ke),i(!0);return}return()=>{n.current&&(n.current.remove(),n.current=null)}},[e]),K.useEffect(()=>{if(n.current&&a&&!J){Q(!0);try{n.current.setStyle(le(G)),n.current.once("styledata",()=>{ne(),Q(!1)}),setTimeout(()=>{Q(!1)},3e3)}catch(Se){console.error("Style change error:",Se),i(!0),Q(!1)}}},[G,a]),K.useEffect(()=>{a&&n.current&&ne()},[a,A,R,V]);const ne=()=>{if(!n.current||!a)return;const Se=de();n.current.getLayer("clusters")&&n.current.removeLayer("clusters"),n.current.getLayer("cluster-count")&&n.current.removeLayer("cluster-count"),n.current.getLayer("unclustered-point")&&n.current.removeLayer("unclustered-point"),n.current.getLayer("heatmap")&&n.current.removeLayer("heatmap"),n.current.getSource("accidents")&&n.current.removeSource("accidents"),n.current.addSource("accidents",{type:"geojson",data:Se,cluster:A,clusterMaxZoom:14,clusterRadius:50}),A&&(n.current.addLayer({id:"clusters",type:"circle",source:"accidents",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",10,"#f1f075",30,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,10,20,30,25]}}),n.current.addLayer({id:"cluster-count",type:"symbol",source:"accidents",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}})),n.current.addLayer({id:"unclustered-point",type:"circle",source:"accidents",filter:["!",["has","point_count"]],paint:{"circle-color":["case",["==",["get","severity"],"fatal"],"#dc2626",["==",["get","severity"],"severe"],"#ea580c",["==",["get","severity"],"moderate"],"#f59e0b",["==",["get","severity"],"minor"],"#16a34a","#6b7280"],"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),R&&n.current.addLayer({id:"heatmap",type:"heatmap",source:"accidents",maxzoom:15,paint:{"heatmap-weight":["interpolate",["linear"],["case",["==",["get","severity"],"fatal"],4,["==",["get","severity"],"severe"],3,["==",["get","severity"],"moderate"],2,["==",["get","severity"],"minor"],1,0],0,0,1,1,2,2,3,3,4,4],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,15,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,15,20],"heatmap-opacity":["interpolate",["linear"],["zoom"],7,1,15,0]}}),n.current.on("click","clusters",ke=>{const ze=n.current.queryRenderedFeatures(ke.point,{layers:["clusters"]}),et=ze[0].properties.cluster_id;n.current.getSource("accidents").getClusterExpansionZoom(et,(je,Ne)=>{je||n.current.easeTo({center:ze[0].geometry.coordinates,zoom:Ne})})}),n.current.on("click","unclustered-point",ke=>{const ze=ke.features[0].geometry.coordinates.slice(),et=ke.features[0].properties;new eA.Popup().setLngLat(ze).setHTML(ue(et)).addTo(n.current)}),n.current.on("mouseenter","clusters",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","clusters",()=>{n.current.getCanvas().style.cursor=""}),n.current.on("mouseenter","unclustered-point",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","unclustered-point",()=>{n.current.getCanvas().style.cursor=""})},de=()=>({type:"FeatureCollection",features:e.filter(ke=>!(V!=="all"&&ke.severity!==V)).map(ke=>{let ze=null;if(ke.municipality){const et=u6e(ke.municipality,ke.barangay,ke.street);et&&(ze=[et.lng,et.lat])}return ze?{type:"Feature",properties:{id:ke.accident_id,severity:ke.severity||"unknown",plateNo:ke.plateNo,vehicle_type:ke.vehicle_type,municipality:ke.municipality,barangay:ke.barangay,street:ke.street,accident_date:ke.accident_date,notes:ke.notes},geometry:{type:"Point",coordinates:ze}}:null}).filter(ke=>ke!==null)}),ue=Se=>`
      <div style="padding: 12px; min-width: 220px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
        <h3 style="margin: 0 0 10px 0; font-size: 16px; font-weight: bold; color: #1f2937; border-bottom: 1px solid #e5e7eb; padding-bottom: 6px;">
          ${Se.id||"Accident ID: N/A"}
        </h3>
        <div style="font-size: 13px; line-height: 1.5; color: #374151;">
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Plate:</strong> ${Se.plateNo||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Severity:</strong> 
            <span style="color: ${ve(Se.severity)}; font-weight: bold; text-transform: uppercase;">
              ${Se.severity||"Unknown"}
            </span>
          </p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Vehicle:</strong> ${Se.vehicle_type||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Location:</strong> ${Se.municipality||"N/A"}, ${Se.barangay||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Street:</strong> ${Se.street||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Date:</strong> ${Se.accident_date?new Date(Se.accident_date).toLocaleDateString():"N/A"}</p>
          ${Se.notes?`<p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Notes:</strong> ${Se.notes}</p>`:""}
        </div>
      </div>
    `,ve=Se=>{switch(Se){case"fatal":return"#dc2626";case"severe":return"#ea580c";case"moderate":return"#f59e0b";case"minor":return"#16a34a";default:return"#6b7280"}},Ae=()=>{n.current&&n.current.flyTo({center:[125.971907,6.90543],zoom:9,duration:1e3})},Oe=()=>{const Se=["streets","satellite","outdoors","light","dark"],ze=(Se.indexOf(G)+1)%Se.length;i(!1),H(Se[ze])};return h?f.jsxs(Ai,{className:t,children:[f.jsx(Ci,{children:f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(ux,{className:"h-5 w-5 text-red-500"}),"Map Error"]})}),f.jsx(ji,{children:f.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:f.jsxs("div",{className:"text-center text-gray-500",children:[f.jsx("div",{className:"text-lg font-medium",children:"Map unavailable"}),f.jsx("div",{className:"text-sm mb-4",children:"Unable to load map. This might be due to:"}),f.jsxs("ul",{className:"text-xs text-left space-y-1 mb-4",children:[f.jsx("li",{children:" Internet connection issues"}),f.jsx("li",{children:" Mapbox token configuration"}),f.jsx("li",{children:" Style loading problems"})]}),f.jsx("button",{onClick:()=>{i(!1),l(!1),n.current&&(n.current.remove(),n.current=null)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"Retry"})]})})})]}):!e||e.length===0?f.jsxs(Ai,{className:t,children:[f.jsx(Ci,{children:f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(T1,{className:"h-5 w-5 text-blue-500"}),"Enhanced Accident Map"]})}),f.jsx(ji,{children:f.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:f.jsxs("div",{className:"text-center text-gray-500",children:[f.jsx("div",{className:"text-lg font-medium",children:"No location data available"}),f.jsx("div",{className:"text-sm",children:"Accidents in this period don't have coordinate information"})]})})})]}):f.jsxs(Ai,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[f.jsx(Ci,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(T1,{className:"h-5 w-5 text-blue-500"}),"Enhanced Accident Map"]}),f.jsx(Ya,{children:"Interactive map with clustering, heat layers, and advanced filtering"})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs(ac,{variant:"outline",className:"text-xs",children:[e.length," Accidents"]})})]})}),f.jsx(ji,{children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-muted/30 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs(Ur,{variant:A?"default":"outline",size:"sm",onClick:()=>C(!A),className:"flex items-center gap-1",children:[f.jsx(XK,{className:"h-4 w-4"}),"Clusters"]}),f.jsxs(Ur,{variant:R?"default":"outline",size:"sm",onClick:()=>z(!R),className:"flex items-center gap-1",children:[f.jsx(bB,{className:"h-4 w-4"}),"Heatmap"]})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("select",{value:V,onChange:Se=>U(Se.target.value),className:"px-2 py-1 text-sm border rounded-md bg-background",children:[f.jsx("option",{value:"all",children:"All Severities"}),f.jsx("option",{value:"fatal",children:"Fatal"}),f.jsx("option",{value:"severe",children:"Severe"}),f.jsx("option",{value:"moderate",children:"Moderate"}),f.jsx("option",{value:"minor",children:"Minor"})]})}),f.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[f.jsxs(Ur,{variant:"outline",size:"sm",onClick:Oe,disabled:J,className:"flex items-center gap-1",children:[f.jsx(bB,{className:"h-4 w-4"}),J?"Loading...":"Style"]}),f.jsxs(Ur,{variant:"outline",size:"sm",onClick:Ae,className:"flex items-center gap-1",children:[f.jsx(Hue,{className:"h-4 w-4"}),"Reset"]})]})]}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{ref:r,className:"w-full h-96 rounded-lg",style:{minHeight:"400px"}}),f.jsxs("div",{className:`absolute top-4 left-4 rounded-lg shadow-lg p-3 text-xs ${_?"bg-gray-800 border border-gray-700 text-gray-100":"bg-white border border-gray-200 text-gray-900"}`,children:[f.jsx("div",{className:"font-semibold mb-2",children:"Accident Severity"}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-red-600 border-2 border-white"}),f.jsx("span",{children:"Fatal"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 border-2 border-white"}),f.jsx("span",{children:"Severe"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 border-2 border-white"}),f.jsx("span",{children:"Moderate"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 border-2 border-white"}),f.jsx("span",{children:"Minor"})]})]}),A&&f.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-300",children:[f.jsx("div",{className:"font-semibold mb-1",children:"Clusters"}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-400"}),f.jsx("span",{children:"Small"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-400"}),f.jsx("span",{children:"Medium"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-5 h-5 rounded-full bg-pink-400"}),f.jsx("span",{children:"Large"})]})]})]})]})]})]})})]})},f6e=({analyticsData:e,riskData:t,timePeriod:r,selectedSeverity:n,selectedVehicleType:a,className:l=""})=>{const h=()=>{if(!e)return;const A=[];A.push(["Metric","Value","Change"]),A.push(["Total Accidents",e.summary.totalAccidents,e.summary.accidentChange]),A.push(["Fatal Accidents",e.summary.fatalities,e.summary.fatalitiesChange]),A.push(["High Risk Areas",e.distributions.municipality.length,""]),t&&A.push(["High Risk Predictions",t.riskPredictions.highRisk,t.riskPredictions.highRiskPercentage]),A.push(["","",""]),A.push(["Month","Accidents"]),e.trends.monthly.forEach(U=>{const G=new Date(U._id.year,U._id.month-1);A.push([G.toLocaleDateString("en-US",{month:"long",year:"numeric"}),U.count])}),A.push(["",""]),A.push(["Severity","Count"]),e.distributions.severity.forEach(U=>{A.push([U._id,U.count])}),A.push(["",""]),A.push(["Vehicle Type","Count"]),e.distributions.vehicleType.forEach(U=>{A.push([U._id,U.count])}),A.push(["",""]),A.push(["Municipality","Count"]),e.distributions.municipality.forEach(U=>{A.push([U._id,U.count])});const C=A.map(U=>U.map(G=>`"${G}"`).join(",")).join(`
`),R=new Blob([C],{type:"text/csv;charset=utf-8;"}),z=document.createElement("a"),V=URL.createObjectURL(R);z.setAttribute("href",V),z.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.csv`),z.style.visibility="hidden",document.body.appendChild(z),z.click(),document.body.removeChild(z)},i=()=>{if(!e)return;const A={exportInfo:{timestamp:new Date().toISOString(),timePeriod:r,filters:{severity:n,vehicleType:a}},summary:e.summary,trends:e.trends,distributions:e.distributions,riskData:t,mapData:e.mapData},C=JSON.stringify(A,null,2),R=new Blob([C],{type:"application/json;charset=utf-8;"}),z=document.createElement("a"),V=URL.createObjectURL(R);z.setAttribute("href",V),z.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.json`),z.style.visibility="hidden",document.body.appendChild(z),z.click(),document.body.removeChild(z)},_=A=>{alert(`Exporting ${A} chart as image... (Feature requires additional setup)`)},w=()=>{if(!e)return;const A=`
ACCIDENT ANALYTICS REPORT
Generated: ${new Date().toLocaleDateString()}
Time Period: ${r}
Filters: Severity=${n}, Vehicle Type=${a}

SUMMARY
========
Total Accidents: ${e.summary.totalAccidents}
Fatal Accidents: ${e.summary.fatalities}
High Risk Areas: ${e.distributions.municipality.length}
Accident Change: ${e.summary.accidentChange}%

${t?`
RISK ANALYSIS
=============
High Risk Predictions: ${t.riskPredictions.highRisk} (${t.riskPredictions.highRiskPercentage}%)
Medium Risk: ${t.riskPredictions.mediumRisk}
Low Risk: ${t.riskPredictions.lowRisk}
`:""}

MONTHLY TRENDS
==============
${e.trends.monthly.map(V=>`${new Date(V._id.year,V._id.month-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}: ${V.count} accidents`).join(`
`)}

SEVERITY DISTRIBUTION
====================
${e.distributions.severity.map(V=>`${V._id}: ${V.count} accidents`).join(`
`)}

VEHICLE TYPE DISTRIBUTION
=========================
${e.distributions.vehicleType.map(V=>`${V._id}: ${V.count} accidents`).join(`
`)}

TOP MUNICIPALITIES
==================
${e.distributions.municipality.slice(0,10).map(V=>`${V._id}: ${V.count} accidents`).join(`
`)}
    `.trim(),C=new Blob([A],{type:"text/plain;charset=utf-8;"}),R=document.createElement("a"),z=URL.createObjectURL(C);R.setAttribute("href",z),R.setAttribute("download",`accident_report_${r}_${new Date().toISOString().split("T")[0]}.txt`),R.style.visibility="hidden",document.body.appendChild(R),R.click(),document.body.removeChild(R)};return f.jsx("div",{className:`flex items-center gap-2 ${l}`,children:f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[f.jsx(KK,{className:"h-4 w-4"}),"Export"]})}),f.jsxs(Fc,{align:"end",className:"w-48",children:[f.jsxs(Ea,{onClick:h,className:"flex items-center gap-2",children:[f.jsx(cde,{className:"h-4 w-4"}),"Export as CSV"]}),f.jsxs(Ea,{onClick:i,className:"flex items-center gap-2",children:[f.jsx(A1,{className:"h-4 w-4"}),"Export as JSON"]}),f.jsxs(Ea,{onClick:w,className:"flex items-center gap-2",children:[f.jsx(A1,{className:"h-4 w-4"}),"Export Report"]}),f.jsx(Lh,{}),f.jsxs(Ea,{onClick:()=>_("trends"),className:"flex items-center gap-2",children:[f.jsx(zD,{className:"h-4 w-4"}),"Export Trends Chart"]}),f.jsxs(Ea,{onClick:()=>_("severity"),className:"flex items-center gap-2",children:[f.jsx(xB,{className:"h-4 w-4"}),"Export Severity Chart"]}),f.jsxs(Ea,{onClick:()=>_("heatmap"),className:"flex items-center gap-2",children:[f.jsx(xB,{className:"h-4 w-4"}),"Export Heatmap"]})]})]})})},hK={light:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],dark:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"]},tA=({value:e,duration:t=2e3,className:r=""})=>{const[n,a]=K.useState(0),[l,h]=K.useState(!1),i=K.useRef(null);return K.useEffect(()=>{const _=new IntersectionObserver(([w])=>{w.isIntersecting&&h(!0)},{threshold:.1});return i.current&&_.observe(i.current),()=>_.disconnect()},[]),K.useEffect(()=>{if(l){let _;const w=A=>{_||(_=A);const C=Math.min((A-_)/t,1),R=1-Math.pow(1-C,4),z=Math.floor(e*R);a(z),C<1?requestAnimationFrame(w):a(e)};requestAnimationFrame(w)}},[e,t,l]),f.jsx("div",{ref:i,className:`${r} transition-all duration-500 ${l?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"}`,children:n.toLocaleString()})},rA=({percentage:e,color:t="bg-blue-500",delay:r=0})=>{const[n,a]=K.useState(0),[l,h]=K.useState(!1),i=K.useRef(null);return K.useEffect(()=>{const _=new IntersectionObserver(([w])=>{w.isIntersecting&&h(!0)},{threshold:.1});return i.current&&_.observe(i.current),()=>_.disconnect()},[]),K.useEffect(()=>{if(l){const _=setTimeout(()=>{a(e)},r);return()=>clearTimeout(_)}},[l,e,r]),f.jsx("div",{ref:i,className:"mt-2 w-full bg-gray-200 rounded-full h-1.5 overflow-hidden",children:f.jsx("div",{className:`${t} h-1.5 rounded-full transition-all duration-1000 ease-out`,style:{width:`${n}%`}})})};function p6e(){const[e,t]=K.useState("6months"),[r,n]=K.useState(null),[a,l]=K.useState(null),[h,i]=K.useState(!0),[_,w]=K.useState(null),[A,C]=K.useState("all"),[R,z]=K.useState("all"),[V,U]=K.useState("area"),[G,H]=K.useState(!1),{token:J}=ra(),[Q,le]=K.useState(!1);K.useEffect(()=>{const je=()=>{const $e=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;le($e)};je();const Ne=new MutationObserver(je);Ne.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const Ye=window.matchMedia("(prefers-color-scheme: dark)");return Ye.addEventListener("change",je),()=>{Ne.disconnect(),Ye.removeEventListener("change",je)}},[]);const ne=()=>Q?hK.dark:hK.light;K.useEffect(()=>{de()},[e]);const de=async()=>{try{i(!0),w(null);const[je,Ne]=await Promise.all([Bn.get(`/accident/analytics/summary?period=${e}`,{headers:{Authorization:J}}),Bn.get(`/accident/analytics/risk?period=${e}`,{headers:{Authorization:J}})]);je.data.success&&n(je.data.data),Ne.data.success&&l(Ne.data.data)}catch(je){console.error("Error fetching accident analytics:",je),w("Failed to load accident analytics data")}finally{i(!1)}},ue=je=>{switch(je){case"week":return"Last Week";case"month":return"Last Month";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"year":return"Last Year";case"alltime":return"All Time";default:return"Last 6 Months"}},ve=je=>je.map(Ne=>({month:`${Ne._id.year}-${String(Ne._id.month).padStart(2,"0")}`,accidents:Ne.count})),Ae=je=>je.map(Ne=>({name:Ne._id.charAt(0).toUpperCase()+Ne._id.slice(1),value:Ne.count,severity:Ne._id})),Oe=je=>je.map(Ne=>({name:Ne._id.charAt(0).toUpperCase()+Ne._id.slice(1),value:Ne.count,type:Ne._id})),Se=je=>je.map(Ne=>({name:Ne._id,accidents:Ne.count})),ke=je=>{const Ne=Array.from({length:24},(Ye,$e)=>({hour:$e,accidents:0}));return je==null||je.forEach(Ye=>{if(Ye.accident_date){const $e=new Date(Ye.accident_date).getHours();Ne[$e].accidents++}}),Ne.map(Ye=>({...Ye,timeLabel:`${Ye.hour}:00`,period:Ye.hour<6?"Night":Ye.hour<12?"Morning":Ye.hour<18?"Afternoon":"Evening"}))},ze=je=>{const Ne=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ye=Array.from({length:7},($e,We)=>({day:We,dayName:Ne[We],accidents:0}));return je==null||je.forEach($e=>{if($e.accident_date){const We=new Date($e.accident_date).getDay();Ye[We].accidents++}}),Ye},et=(je,Ne)=>!je||!Ne?[]:[{category:"High Risk",accidents:Ne.riskPredictions.highRisk,percentage:Ne.riskPredictions.highRiskPercentage},{category:"Medium Risk",accidents:Ne.riskPredictions.mediumRisk,percentage:100-Ne.riskPredictions.highRiskPercentage-Ne.riskPredictions.lowRiskPercentage},{category:"Low Risk",accidents:Ne.riskPredictions.lowRisk,percentage:Ne.riskPredictions.lowRiskPercentage}];return h?f.jsx("div",{className:"container mx-auto p-6",children:f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),f.jsx("div",{className:"text-muted-foreground animate-pulse",children:"Loading accident analytics..."}),f.jsx("div",{className:"text-xs text-muted-foreground",children:"Preparing interactive visualizations"})]})})}):_?f.jsx("div",{className:"container mx-auto p-6",children:f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"text-red-500",children:_})})}):f.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[f.jsxs("div",{children:[f.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[f.jsx(ux,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),f.jsxs("p",{className:"text-muted-foreground",children:["Comprehensive analysis of accident data for ",ue(e)]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(f6e,{analyticsData:r,riskData:a,timePeriod:e,selectedSeverity:A,selectedVehicleType:R}),f.jsxs("button",{onClick:()=>H(!G),className:"px-3 py-2 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors flex items-center gap-2",children:[f.jsx(zD,{className:"h-4 w-4"}),G?"Hide Advanced":"Show Advanced"]}),f.jsxs(fs,{value:e,onValueChange:t,children:[f.jsx(Qo,{className:"w-[180px]",children:f.jsx(ps,{placeholder:"Select time period"})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"week",children:"Last Week"}),f.jsx(Kr,{value:"month",children:"Last Month"}),f.jsx(Kr,{value:"3months",children:"Last 3 Months"}),f.jsx(Kr,{value:"6months",children:"Last 6 Months"}),f.jsx(Kr,{value:"year",children:"Last Year"}),f.jsx(Kr,{value:"alltime",children:"All Time"})]})]})]})]}),f.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(HK,{className:"h-4 w-4 text-muted-foreground"}),f.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{className:"text-sm text-muted-foreground",children:"Severity:"}),f.jsxs(fs,{value:A,onValueChange:C,children:[f.jsx(Qo,{className:"w-[140px]",children:f.jsx(ps,{})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"all",children:"All Severities"}),f.jsx(Kr,{value:"fatal",children:"Fatal"}),f.jsx(Kr,{value:"severe",children:"Severe"}),f.jsx(Kr,{value:"moderate",children:"Moderate"}),f.jsx(Kr,{value:"minor",children:"Minor"})]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{className:"text-sm text-muted-foreground",children:"Vehicle Type:"}),f.jsxs(fs,{value:R,onValueChange:z,children:[f.jsx(Qo,{className:"w-[140px]",children:f.jsx(ps,{})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"all",children:"All Types"}),f.jsx(Kr,{value:"car",children:"Car"}),f.jsx(Kr,{value:"motorcycle",children:"Motorcycle"}),f.jsx(Kr,{value:"truck",children:"Truck"}),f.jsx(Kr,{value:"bus",children:"Bus"}),f.jsx(Kr,{value:"van",children:"Van"})]})]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{className:"text-sm text-muted-foreground",children:"Chart Type:"}),f.jsxs(fs,{value:V,onValueChange:U,children:[f.jsx(Qo,{className:"w-[120px]",children:f.jsx(ps,{})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"area",children:"Area Chart"}),f.jsx(Kr,{value:"line",children:"Line Chart"}),f.jsx(Kr,{value:"bar",children:"Bar Chart"}),f.jsx(Kr,{value:"composed",children:"Composed"})]})]})]})]})]}),r&&f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[f.jsxs(Ai,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-blue-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),f.jsxs(Ci,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[f.jsx(Mi,{className:"text-sm font-medium",children:"Total Accidents"}),f.jsx(Av,{className:"h-4 w-4 text-blue-500"})]}),f.jsxs(ji,{className:"relative z-10",children:[f.jsx(tA,{value:r.summary.totalAccidents,className:"text-2xl font-bold",duration:1500}),f.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.accidentChange>=0?f.jsx(TB,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):f.jsx(AB,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),Math.abs(r.summary.accidentChange),"% from previous period"]}),f.jsx(rA,{percentage:Math.min(r.summary.totalAccidents/100*100,100),color:"bg-blue-500",delay:200})]})]}),f.jsxs(Ai,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-red-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),f.jsxs(Ci,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[f.jsx(Mi,{className:"text-sm font-medium",children:"Fatal Accidents"}),f.jsx(ux,{className:"h-4 w-4 text-red-500"})]}),f.jsxs(ji,{className:"relative z-10",children:[f.jsx(tA,{value:r.summary.fatalities,className:"text-2xl font-bold text-red-600",duration:1800}),f.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.fatalitiesChange>=0?f.jsx(TB,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):f.jsx(AB,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),r.summary.fatalitiesChange," from previous period"]}),f.jsx(rA,{percentage:Math.min(r.summary.fatalities/10*100,100),color:"bg-red-500",delay:400})]})]}),f.jsxs(Ai,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-orange-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),f.jsxs(Ci,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[f.jsx(Mi,{className:"text-sm font-medium",children:"High Risk Areas"}),f.jsx(T1,{className:"h-4 w-4 text-orange-500"})]}),f.jsxs(ji,{className:"relative z-10",children:[f.jsx(tA,{value:r.distributions.municipality.length,className:"text-2xl font-bold",duration:1600}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Municipalities with accidents"}),f.jsx(rA,{percentage:Math.min(r.distributions.municipality.length/20*100,100),color:"bg-orange-500",delay:600})]})]}),f.jsxs(Ai,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[f.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),f.jsxs(Ci,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[f.jsx(Mi,{className:"text-sm font-medium",children:"Risk Predictions"}),f.jsx(gB,{className:"h-4 w-4 text-purple-500"})]}),f.jsxs(ji,{className:"relative z-10",children:[f.jsx(tA,{value:a?a.riskPredictions.highRiskPercentage:0,className:"text-2xl font-bold",duration:2e3}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High risk predictions"}),f.jsx(rA,{percentage:a?a.riskPredictions.highRiskPercentage:0,color:"bg-purple-500",delay:800})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r&&r.trends.monthly.length>0&&f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[f.jsx(Ci,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(Mh,{className:"h-5 w-5 text-blue-500 animate-pulse"}),"Accident Trends Over Time"]}),f.jsxs(Ya,{children:["Monthly accident frequency for ",ue(e)]})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ac,{variant:"outline",className:"text-xs",children:V.toUpperCase()})})]})}),f.jsx(ji,{children:f.jsxs(Qs,{width:"100%",height:300,children:[V==="area"&&f.jsxs(o4e,{data:ve(r.trends.monthly),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"month",tickFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{labelFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}}),f.jsx(xm,{type:"monotone",dataKey:"accidents",stroke:ne()[0],fill:ne()[0],fillOpacity:.3,strokeWidth:3,animationDuration:1500,animationEasing:"ease-out"})]}),V==="line"&&f.jsxs(n4,{data:ve(r.trends.monthly),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"month",tickFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{labelFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}}),f.jsx(_u,{type:"monotone",dataKey:"accidents",stroke:ne()[0],strokeWidth:3,dot:{fill:ne()[0],strokeWidth:2,r:4},activeDot:{r:6,stroke:ne()[0],strokeWidth:2},animationDuration:1500,animationEasing:"ease-out"})]}),V==="bar"&&f.jsxs(Eh,{data:ve(r.trends.monthly),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"month",tickFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{labelFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}}),f.jsx(Ro,{dataKey:"accidents",fill:ne()[0],radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"})]}),V==="composed"&&f.jsxs(vte,{data:ve(r.trends.monthly),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"month",tickFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{labelFormatter:je=>new Date(je).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}}),f.jsx(Ro,{dataKey:"accidents",fill:ne()[0],fillOpacity:.6,radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"}),f.jsx(_u,{type:"monotone",dataKey:"accidents",stroke:ne()[1],strokeWidth:2,dot:!1,animationDuration:1500,animationEasing:"ease-out"})]})]})})]}),r&&r.distributions.severity.length>0&&f.jsxs(Ai,{className:"animate-in slide-in-from-right-5 fade-in duration-700",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(S1,{className:"h-5 w-5 text-orange-500 animate-pulse"}),"Accident Severity Distribution"]}),f.jsx(Ya,{children:"Breakdown of accidents by severity level"})]}),f.jsx(ji,{children:f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(yte,{children:[f.jsx(rp,{data:Ae(r.distributions.severity),cx:"50%",cy:"50%",labelLine:!1,label:({name:je,percent:Ne})=>`${je} ${(Ne*100).toFixed(0)}%`,outerRadius:80,fill:"currentColor",dataKey:"value",animationDuration:1500,animationEasing:"ease-out",children:Ae(r.distributions.severity).map((je,Ne)=>f.jsx(hm,{fill:ne()[Ne%ne().length]},`cell-${Ne}`))}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}})]})})})]}),r&&r.distributions.vehicleType.length>0&&f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(Av,{className:"h-5 w-5 text-green-500"}),"Vehicle Type Distribution"]}),f.jsx(Ya,{children:"Accidents by vehicle type with enhanced visualization"})]}),f.jsxs(ji,{children:[f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(Eh,{data:Oe(r.distributions.vehicleType),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"name",stroke:Q?"#9ca3af":"#6b7280",fontSize:12,angle:-45,textAnchor:"end",height:80}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(je,Ne)=>[`${je} accidents`,"Count"],labelFormatter:je=>`Vehicle Type: ${je}`}),f.jsx(Ro,{dataKey:"value",fill:ne()[1],radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),f.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const je=Oe(r.distributions.vehicleType),Ne=je.reduce(($e,We)=>$e+We.value,0),Ye=je.reduce(($e,We)=>We.value>$e.value?We:$e);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Most Common"}),f.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:Ye.name}),f.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[Ye.value," accidents (",(Ye.value/Ne*100).toFixed(1),"%)"]})]}),f.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Vehicles"}),f.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:je.length}),f.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Vehicle types involved"})]})]})})()})]})]}),r&&r.distributions.municipality.length>0&&f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(T1,{className:"h-5 w-5 text-orange-500"}),"Top Municipalities by Accidents"]}),f.jsx(Ya,{children:"Municipalities with highest accident counts and risk analysis"})]}),f.jsxs(ji,{children:[f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(Eh,{data:Se(r.distributions.municipality),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"name",stroke:Q?"#9ca3af":"#6b7280",fontSize:11,angle:-45,textAnchor:"end",height:80}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(je,Ne)=>[`${je} accidents`,"Count"],labelFormatter:je=>`Municipality: ${je}`}),f.jsx(Ro,{dataKey:"accidents",fill:ne()[2],radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),f.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:(()=>{const je=Se(r.distributions.municipality),Ne=je.reduce((We,Et)=>We+Et.accidents,0),Ye=je.reduce((We,Et)=>Et.accidents>We.accidents?Et:We),$e=Ne/je.length;return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Highest Risk"}),f.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:Ye.name}),f.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:[Ye.accidents," accidents"]})]}),f.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Areas"}),f.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:je.length}),f.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Municipalities affected"})]}),f.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Average"}),f.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:$e.toFixed(1)}),f.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Accidents per area"})]})]})})()})]})]})]}),a&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsx(Mi,{children:"Risk Level Distribution"}),f.jsx(Ya,{children:"ML-based risk predictions for accidents"})]}),f.jsx(ji,{children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),f.jsx("span",{children:"High Risk"})]}),f.jsxs(ac,{variant:"destructive",children:[a.riskPredictions.highRisk," (",a.riskPredictions.highRiskPercentage,"%)"]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),f.jsx("span",{children:"Medium Risk"})]}),f.jsx(ac,{variant:"secondary",children:a.riskPredictions.mediumRisk})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),f.jsx("span",{children:"Low Risk"})]}),f.jsx(ac,{variant:"outline",children:a.riskPredictions.lowRisk})]})]})})]}),f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsx(Mi,{children:"Rule-Based Detection"}),f.jsx(Ya,{children:"Traditional rule-based risk assessment"})]}),f.jsx(ji,{children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ux,{className:"h-4 w-4 text-red-500"}),f.jsx("span",{children:"Flagged (High Risk)"})]}),f.jsxs(ac,{variant:"destructive",children:[a.ruleBasedDetection.flagged," (",a.ruleBasedDetection.flaggedPercentage,"%)"]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(gB,{className:"h-4 w-4 text-green-500"}),f.jsx("span",{children:"Safe (Low Risk)"})]}),f.jsxs(ac,{variant:"outline",children:[a.ruleBasedDetection.safe," (",a.ruleBasedDetection.safePercentage,"%)"]})]})]})})]})]}),G&&r&&f.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsx(wde,{className:"h-5 w-5 text-yellow-500 animate-pulse"}),f.jsx("h3",{className:"text-xl font-semibold",children:"Advanced Analytics"}),f.jsx(ac,{variant:"secondary",className:"ml-2 animate-pulse",children:"Enhanced Visualizations"})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(_ue,{className:"h-5 w-5 text-green-500 animate-pulse"}),"Hourly Accident Distribution"]}),f.jsx(Ya,{children:"Accidents by hour of day showing peak times and patterns"})]}),f.jsxs(ji,{children:[f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(Eh,{data:ke(r.mapData),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"timeLabel",stroke:Q?"#9ca3af":"#6b7280",fontSize:11,interval:1}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(je,Ne)=>[`${je} accidents`,"Count"],labelFormatter:je=>`Time: ${je}`}),f.jsx(Ro,{dataKey:"accidents",fill:ne()[2],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),f.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const je=ke(r.mapData),Ne=je.reduce(($e,We)=>We.accidents>$e.accidents?We:$e),Ye=je.reduce(($e,We)=>$e+We.accidents,0);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Peak Hour"}),f.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:Ne.timeLabel}),f.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[Ne.accidents," accidents"]})]}),f.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Accidents"}),f.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:Ye}),f.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Across all hours"})]})]})})()})]})]}),f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-right-5 fade-in duration-700",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(Mh,{className:"h-5 w-5 text-purple-500 animate-pulse"}),"Day of Week Analysis"]}),f.jsx(Ya,{children:"Accident patterns by day of the week with risk assessment"})]}),f.jsxs(ji,{children:[f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(Eh,{data:ze(r.mapData),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"dayName",stroke:Q?"#9ca3af":"#6b7280",fontSize:12}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(je,Ne)=>[`${je} accidents`,"Count"],labelFormatter:je=>`Day: ${je}`}),f.jsx(Ro,{dataKey:"accidents",fill:ne()[3],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),f.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const je=ze(r.mapData),Ne=je.reduce((We,Et)=>Et.accidents>We.accidents?Et:We),$e=je.filter(We=>We.day===0||We.day===6).reduce((We,Et)=>We+Et.accidents,0);return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Peak Day"}),f.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:Ne.dayName}),f.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:[Ne.accidents," accidents"]})]}),f.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[f.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Weekend Total"}),f.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:$e}),f.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Sat + Sun accidents"})]})]})})()})]})]}),a&&f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(XK,{className:"h-5 w-5 text-red-500"}),"Risk Level Correlation"]}),f.jsx(Ya,{children:"Relationship between risk levels and accident counts"})]}),f.jsx(ji,{children:f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(a4e,{data:et(r,a),children:[f.jsx(js,{strokeDasharray:"3 3",stroke:Q?"#374151":"#e5e7eb"}),f.jsx(lo,{dataKey:"category",stroke:Q?"#9ca3af":"#6b7280",fontSize:12}),f.jsx(co,{stroke:Q?"#9ca3af":"#6b7280"}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}}),f.jsx(I0,{dataKey:"accidents",fill:ne()[4],r:8})]})})})]}),r&&r.distributions.severity.length>0&&f.jsxs(Ai,{className:"group hover:shadow-lg transition-all duration-300",children:[f.jsxs(Ci,{children:[f.jsxs(Mi,{className:"flex items-center gap-2",children:[f.jsx(S1,{className:"h-5 w-5 text-orange-500"}),"Severity Distribution (Radial)"]}),f.jsx(Ya,{children:"Circular view of accident severity breakdown"})]}),f.jsx(ji,{children:f.jsx(Qs,{width:"100%",height:300,children:f.jsxs(s4e,{cx:"50%",cy:"50%",innerRadius:"20%",outerRadius:"80%",data:Ae(r.distributions.severity),children:[f.jsx(pS,{dataKey:"value",cornerRadius:4,fill:ne()[0]}),f.jsx(wa,{contentStyle:{backgroundColor:Q?"#1f2937":"#ffffff",border:Q?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:Q?"#f9fafb":"#111827"}})]})})})]})]}),f.jsx(d6e,{analyticsData:r,className:"w-full"})]}),r&&r.mapData&&r.mapData.length>0&&f.jsx(h6e,{accidents:r.mapData,className:"w-full"})]})}function m6e(){return f.jsx("div",{children:f.jsx(p6e,{})})}const g6e=en.object({firstName:en.string().min(1,"First name is required").trim(),middleName:en.string().optional(),lastName:en.string().min(1,"Last name is required").trim(),email:en.string().email("Invalid email address"),password:en.string().min(6,"Password must be at least 6 characters"),confirmPassword:en.string(),role:en.enum(["0","1","2"]).optional()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),y6e=[{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function v6e(){const{userData:e}=ra(),[t,r]=K.useState(!1),n=Pu(Date.now()),a=Uh({resolver:$h(g6e),defaultValues:{firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0}}),l=async h=>{var i,_;try{r(!0);const{confirmPassword:w,...A}=h;(e==null?void 0:e.role)==="1"?A.role="2":(e==null?void 0:e.role)==="0"&&(A.role=h.role||"2"),(await Bn.post("/auth/register",A)).data.success&&(Ni.success("Account has been registered successfully",{description:n}),a.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0}))}catch(w){const A=((_=(i=w.response)==null?void 0:i.data)==null?void 0:_.message)||"Failed to register account";Ni.error(A,{description:n})}finally{r(!1)}};return f.jsx("div",{className:"container mx-auto py-8 px-4",children:f.jsx("div",{className:"max-w-2xl mx-auto",children:f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(SA,{className:"h-6 w-6"}),f.jsx(Mi,{children:"Register New Account"})]}),f.jsx(Ya,{children:(e==null?void 0:e.role)==="0"?"Create a new admin or employee account for the LTO system":"Create a new employee account for the LTO system"})]}),f.jsx(ji,{children:f.jsx($v,{...a,children:f.jsxs("form",{onSubmit:a.handleSubmit(l),className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(qn,{control:a.control,name:"firstName",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"First Name *"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter first name",...h})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:a.control,name:"middleName",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Middle Name"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter middle name (optional)",...h})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:a.control,name:"lastName",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Last Name *"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter last name",...h})}),f.jsx(zn,{})]})})]}),f.jsx(qn,{control:a.control,name:"email",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Email Address *"}),f.jsx(Nn,{children:f.jsx(Fn,{type:"email",placeholder:"Enter email address",...h})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:a.control,name:"password",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Password *"}),f.jsx(Nn,{children:f.jsx(Fn,{type:"password",placeholder:"Enter password",...h})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:a.control,name:"confirmPassword",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Confirm Password *"}),f.jsx(Nn,{children:f.jsx(Fn,{type:"password",placeholder:"Confirm password",...h})}),f.jsx(zn,{})]})}),(e==null?void 0:e.role)==="0"&&f.jsx(qn,{control:a.control,name:"role",render:({field:h})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Role *"}),f.jsxs(fs,{onValueChange:h.onChange,defaultValue:h.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select a role"})})}),f.jsx(es,{children:y6e.map(i=>f.jsx(Kr,{value:i.value,children:i.label},i.value))})]}),f.jsx(zn,{})]})}),f.jsxs("div",{className:"flex gap-4 pt-4",children:[f.jsx(Ur,{type:"submit",disabled:t,className:"w-auto px-8",children:t?f.jsxs(f.Fragment,{children:[f.jsx(Sd,{className:"mr-2 h-4 w-4 animate-spin"}),"Registering..."]}):f.jsxs(f.Fragment,{children:[f.jsx(SA,{className:"mr-2 h-4 w-4"}),"Register Account"]})}),f.jsx(Ur,{type:"button",variant:"outline",onClick:()=>{a.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0})},disabled:t,className:"w-auto px-8",children:"Clear Form"})]})]})})})]})})})}const _6e=en.object({userId:en.string().min(1,"User ID is required"),firstName:en.string().min(1,"First name is required").trim(),middleName:en.string().optional(),lastName:en.string().min(1,"Last name is required").trim(),email:en.string().email("Invalid email address"),role:en.enum(["0","1","2"],{required_error:"Please select a role"}),isPasswordChange:en.boolean().optional()}),x6e=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function b6e(){const{userData:e}=ra(),[t,r]=K.useState([]),[n,a]=K.useState(!1),[l,h]=K.useState(!1),[i,_]=K.useState(null),[w,A]=K.useState(!1),[C,R]=K.useState(!1),[z,V]=K.useState(null),U=Uh({resolver:$h(_6e),defaultValues:{userId:"",firstName:"",middleName:"",lastName:"",email:"",role:"",isPasswordChange:!1}}),G=async()=>{var ve,Ae;try{a(!0);const Oe=await Bn.get("/user/all");if(Oe.data.success){let Se=Oe.data.users;(e==null?void 0:e.role)==="1"?Se=Se.filter(ke=>ke.role==="2"):(e==null?void 0:e.role)==="0"&&(Se=Se.filter(ke=>ke.role==="1"||ke.role==="2")),r(Se)}}catch(Oe){const Se=((Ae=(ve=Oe.response)==null?void 0:ve.data)==null?void 0:Ae.message)||"Failed to fetch users";Ni.error(Se)}finally{a(!1)}};K.useEffect(()=>{G()},[e]);const H=ve=>{_(ve),A(!0),U.reset({userId:ve._id,firstName:ve.firstName,middleName:ve.middleName||"",lastName:ve.lastName,email:ve.email,role:ve.role,isPasswordChange:ve.isPasswordChange||!1})},J=ve=>{V(ve),R(!0)},Q=async()=>{var ve,Ae;try{h(!0),(await Bn.delete(`/user/${z._id}`)).data.success&&(Ni.success("User deleted successfully!"),G())}catch(Oe){const Se=((Ae=(ve=Oe.response)==null?void 0:ve.data)==null?void 0:Ae.message)||"Failed to delete user";Ni.error(Se)}finally{h(!1),R(!1),V(null)}},le=async ve=>{var Ae,Oe;try{h(!0),(await Bn.put(`/user/${ve.userId}`,ve)).data.success&&(Ni.success("Account updated successfully!"),G(),A(!1),_(null))}catch(Se){const ke=((Oe=(Ae=Se.response)==null?void 0:Ae.data)==null?void 0:Oe.message)||"Failed to update account";Ni.error(ke)}finally{h(!1)}},ne=()=>{_(null),A(!1),U.reset()},de=ve=>{switch(ve){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}},ue=ve=>{switch(ve){case"0":return"Superadmin";case"1":return"Admin";case"2":return"Employee";default:return"Unknown"}};return f.jsx("div",{className:"container mx-auto py-8 px-4",children:f.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[f.jsx(Ai,{children:f.jsxs(Ci,{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Nc,{className:"h-6 w-6"}),f.jsx(Mi,{children:"Manage User Accounts"})]}),f.jsx(Ya,{children:(e==null?void 0:e.role)==="0"?"View and manage admin and employee accounts":"View and manage employee accounts"})]})}),f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsx(Mi,{children:"User Accounts"})}),f.jsx(ji,{children:n?f.jsxs("div",{className:"flex items-center justify-center py-8",children:[f.jsx(Sd,{className:"h-8 w-8 animate-spin"}),f.jsx("span",{className:"ml-2",children:"Loading users..."})]}):t.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"}):f.jsx("div",{className:"rounded-md border",children:f.jsxs(ty,{children:[f.jsx(ry,{children:f.jsxs(rs,{children:[f.jsx(Xo,{children:"Full Name"}),f.jsx(Xo,{children:"Email"}),f.jsx(Xo,{children:"Role"}),f.jsx(Xo,{children:"Created At"}),f.jsx(Xo,{children:"Last Updated"}),f.jsx(Xo,{className:"w-[50px]",children:"Actions"})]})}),f.jsx(ny,{children:t.map(ve=>f.jsxs(rs,{children:[f.jsxs(Ba,{className:"font-medium",children:[ve.firstName," ",ve.middleName," ",ve.lastName]}),f.jsx(Ba,{children:ve.email}),f.jsx(Ba,{children:f.jsx(ac,{variant:de(ve.role),children:ue(ve.role)})}),f.jsx(Ba,{children:new Date(ve.createdAt).toLocaleDateString()}),f.jsx(Ba,{children:new Date(ve.updatedAt).toLocaleDateString()}),f.jsx(Ba,{children:f.jsxs(Cu,{children:[f.jsx(Pd,{asChild:!0,children:f.jsxs(Ur,{variant:"ghost",className:"h-8 w-8 p-0",children:[f.jsx("span",{className:"sr-only",children:"Open menu"}),f.jsx(Aue,{className:"h-4 w-4"})]})}),f.jsxs(Fc,{align:"end",children:[f.jsxs(Ea,{onClick:()=>H(ve),children:[f.jsx(Nc,{className:"mr-2 h-4 w-4"}),"Update"]}),(e==null?void 0:e.role)==="0"&&f.jsxs(Ea,{onClick:()=>J(ve),className:"text-red-600",children:[f.jsx(hde,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},ve._id))})]})})})]}),w&&i&&f.jsxs(Ai,{children:[f.jsxs(Ci,{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Nc,{className:"h-6 w-6"}),f.jsx(Mi,{children:"Update Account Information"})]}),f.jsxs(Ya,{children:["Modify the account information for ",i.firstName," ",i.lastName]})]}),f.jsx(ji,{children:f.jsx($v,{...U,children:f.jsxs("form",{onSubmit:U.handleSubmit(le),className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(qn,{control:U.control,name:"firstName",render:({field:ve})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"First Name *"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter first name",...ve})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:U.control,name:"lastName",render:({field:ve})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Last Name *"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter last name",...ve})}),f.jsx(zn,{})]})})]}),f.jsx(qn,{control:U.control,name:"middleName",render:({field:ve})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Middle Name"}),f.jsx(Nn,{children:f.jsx(Fn,{placeholder:"Enter middle name (optional)",...ve})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:U.control,name:"email",render:({field:ve})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Email Address *"}),f.jsx(Nn,{children:f.jsx(Fn,{type:"email",placeholder:"Enter email address",...ve})}),f.jsx(zn,{})]})}),f.jsx(qn,{control:U.control,name:"role",render:({field:ve})=>f.jsxs(Dn,{children:[f.jsx(Ln,{children:"Role *"}),f.jsxs(fs,{onValueChange:ve.onChange,value:ve.value,children:[f.jsx(Nn,{children:f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Select a role"})})}),f.jsx(es,{children:x6e.map(Ae=>f.jsx(Kr,{value:Ae.value,children:Ae.label},Ae.value))})]}),f.jsx(zn,{})]})}),f.jsxs("div",{className:"flex gap-4 pt-4",children:[f.jsx(Ur,{type:"submit",disabled:l,className:"w-auto px-8",children:l?f.jsxs(f.Fragment,{children:[f.jsx(Sd,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Nc,{className:"mr-2 h-4 w-4"}),"Update Account"]})}),f.jsx(Ur,{type:"button",variant:"outline",onClick:ne,disabled:l,className:"w-auto px-8",children:"Cancel"})]})]})})})]}),f.jsx(Wne,{open:C,onOpenChange:R,children:f.jsxs(N4,{children:[f.jsxs(I4,{children:[f.jsx(L4,{children:"Are you sure?"}),f.jsxs(z4,{children:["This action cannot be undone. This will permanently delete the account for"," ",f.jsxs("strong",{children:[z==null?void 0:z.firstName," ",z==null?void 0:z.lastName]}),"."]})]}),f.jsxs(D4,{children:[f.jsx(B4,{children:"Cancel"}),f.jsx(F4,{onClick:Q,disabled:l,className:"bg-red-600 hover:bg-red-700",children:l?f.jsxs(f.Fragment,{children:[f.jsx(Sd,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})})}const Bj=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}],fK=[{value:"login",label:"Login"},{value:"logout",label:"Logout"},{value:"register",label:"Registration"},{value:"update",label:"Account Update"},{value:"delete",label:"Delete"},{value:"password_change",label:"Password Change"},{value:"otp_verified",label:"OTP Verification"},{value:"otp_sent",label:"OTP Sent"},{value:"otp_reset",label:"OTP Reset"},{value:"add_driver",label:"Add Driver"},{value:"add_vehicle",label:"Add Vehicle"},{value:"add_accident",label:"Add Accident"},{value:"add_violation",label:"Add Violation"},{value:"update_driver",label:"Update Driver"},{value:"update_vehicle",label:"Update Vehicle"},{value:"update_accident",label:"Update Accident"},{value:"update_violation",label:"Update Violation"},{value:"delete_driver",label:"Delete Driver"},{value:"delete_vehicle",label:"Delete Vehicle"},{value:"delete_accident",label:"Delete Accident"},{value:"delete_violation",label:"Delete Violation"}];function w6e(){const{userData:e}=ra(),[t,r]=K.useState([]),[n,a]=K.useState(!1),[l,h]=K.useState(""),[i,_]=K.useState(""),[w,A]=K.useState(""),[C,R]=K.useState(null),[z,V]=K.useState(null),[U,G]=K.useState(1),[H,J]=K.useState(1),[Q,le]=K.useState(0),ne=async(Se=1)=>{var ke,ze;try{a(!0);const et=new URLSearchParams({page:Se.toString(),limit:"10"});l&&et.append("email",l),w&&w!=="all"&&et.append("logType",w),C&&et.append("dateFrom",C.toISOString().split("T")[0]),z&&et.append("dateTo",z.toISOString().split("T")[0]),(e==null?void 0:e.role)==="1"?i&&i!=="all"?et.append("role",i):et.append("roles","1,2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?et.append("role",i):et.append("roles","0,1,2"));const je=await Bn.get(`/user/logs?${et}`);if(je.data.success){let Ne=je.data.logs;(e==null?void 0:e.role)==="1"?i&&i!=="all"?Ne=Ne.filter(Ye=>Ye.role===i):Ne=Ne.filter(Ye=>Ye.role==="1"||Ye.role==="2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?Ne=Ne.filter(Ye=>Ye.role===i):Ne=Ne.filter(Ye=>Ye.role==="0"||Ye.role==="1"||Ye.role==="2")),console.log("Raw logs from API:",je.data.logs),console.log("Filtered logs:",Ne),r(Ne),J(je.data.totalPages),le(Ne.length),G(Se)}}catch(et){const je=((ze=(ke=et.response)==null?void 0:ke.data)==null?void 0:ze.message)||"Failed to fetch logs";Ni.error(je)}finally{a(!1)}};K.useEffect(()=>{ne()},[e]);const de=()=>{G(1),ne(1)},ue=()=>{h(""),_(""),A(""),R(null),V(null),G(1),ne(1)},ve=async()=>{try{const Se=new URLSearchParams;l&&Se.append("email",l),i&&Se.append("role",i),w&&Se.append("logType",w),C&&Se.append("dateFrom",C.toISOString().split("T")[0]),z&&Se.append("dateTo",z.toISOString().split("T")[0]);const ke=await Bn.get(`/user/logs/export?${Se}`,{responseType:"blob"}),ze=window.URL.createObjectURL(new Blob([ke.data])),et=document.createElement("a");et.href=ze,et.setAttribute("download",`account-logs-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(et),et.click(),et.remove(),window.URL.revokeObjectURL(ze),Ni.success("Logs exported successfully!")}catch{Ni.error("Failed to export logs")}},Ae=Se=>{switch(Se){case"login":return"default";case"logout":return"secondary";case"register":return"outline";case"update":return"default";case"password_change":return"destructive";case"otp_verified":return"secondary";case"otp_sent":return"outline";case"otp_reset":return"destructive";case"add_driver":return"default";case"add_vehicle":return"default";case"add_accident":return"destructive";case"add_violation":return"destructive";case"update_driver":return"secondary";case"update_vehicle":return"secondary";case"update_accident":return"destructive";case"update_violation":return"destructive";case"delete_driver":return"destructive";case"delete_vehicle":return"destructive";case"delete_accident":return"destructive";case"delete_violation":return"destructive";default:return"outline"}},Oe=Se=>{switch(Se){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}};return f.jsx("div",{className:"container mx-auto py-8 px-4",children:f.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[f.jsx(Ai,{children:f.jsxs(Ci,{children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(A1,{className:"h-6 w-6"}),f.jsx(Mi,{children:"Account Logs"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(Ur,{onClick:ve,variant:"outline",size:"sm",children:[f.jsx(KK,{className:"mr-2 h-4 w-4"}),"Export Excel"]}),f.jsxs(Ur,{onClick:de,size:"sm",children:[f.jsx(YK,{className:"mr-2 h-4 w-4"}),"Search"]})]})]}),f.jsx(Ya,{children:(e==null?void 0:e.role)==="0"?"View and monitor all account activities and system logs (Superadmin, Admin, and Employee)":"View and monitor admin and employee account activities and system logs"})]})}),f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(HK,{className:"h-5 w-5"}),f.jsx(Mi,{className:"text-lg",children:"Filters"})]})}),f.jsx(ji,{children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[f.jsx(Fn,{placeholder:"Search by email",value:l,onChange:Se=>h(Se.target.value),onKeyPress:Se=>Se.key==="Enter"&&de()}),f.jsxs(fs,{value:i,onValueChange:_,children:[f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Filter by role"})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"all",children:"All Roles"}),Bj.filter(Se=>(e==null?void 0:e.role)==="1"?Se.value==="1"||Se.value==="2":(e==null?void 0:e.role)==="0"?Se.value==="0"||Se.value==="1"||Se.value==="2":!1).map(Se=>f.jsx(Kr,{value:Se.value,children:Se.label},Se.value))]})]}),f.jsxs(fs,{value:w,onValueChange:A,children:[f.jsx(Qo,{children:f.jsx(ps,{placeholder:"Filter by log type"})}),f.jsxs(es,{children:[f.jsx(Kr,{value:"all",children:"All Types"}),fK.map(Se=>f.jsx(Kr,{value:Se.value,children:Se.label},Se.value))]})]}),f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsxs(Ur,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[f.jsx(Mh,{className:"mr-2 h-4 w-4"}),C?Vc(C,"MM/dd/yyyy"):"From date"]})}),f.jsx($g,{className:"w-auto p-0",align:"start",children:f.jsx(zw,{mode:"single",selected:C,onSelect:R,initialFocus:!0})})]}),f.jsxs(zv,{children:[f.jsx(Fv,{asChild:!0,children:f.jsxs(Ur,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[f.jsx(Mh,{className:"mr-2 h-4 w-4"}),z?Vc(z,"MM/dd/yyyy"):"To date"]})}),f.jsx($g,{className:"w-auto p-0",align:"start",children:f.jsx(zw,{mode:"single",selected:z,onSelect:V,initialFocus:!0})})]}),f.jsx(Ur,{onClick:ue,variant:"outline",children:"Clear Filters"})]})})]}),f.jsxs(Ai,{children:[f.jsx(Ci,{children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(Mi,{children:"Account Activity Logs"}),f.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total: ",Q," logs"]})]})}),f.jsx(ji,{children:n?f.jsxs("div",{className:"flex items-center justify-center py-8",children:[f.jsx(Sd,{className:"h-8 w-8 animate-spin"}),f.jsx("span",{className:"ml-2",children:"Loading logs..."})]}):t.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No logs found matching your criteria"}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"rounded-md border",children:f.jsxs(ty,{children:[f.jsx(ry,{children:f.jsxs(rs,{children:[f.jsx(Xo,{children:"Performed By"}),f.jsx(Xo,{children:"Timestamp"}),f.jsx(Xo,{children:"User"}),f.jsx(Xo,{children:"Email"}),f.jsx(Xo,{children:"Role"}),f.jsx(Xo,{children:"Activity"}),f.jsx(Xo,{children:"Details"}),f.jsx(Xo,{children:"IP Address"}),f.jsx(Xo,{children:"Status"})]})}),f.jsx(ny,{children:t.map((Se,ke)=>{var ze,et,je;return f.jsxs(rs,{children:[f.jsx(Ba,{children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"font-medium text-sm",children:Se.actorName||"N/A"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:Se.actorEmail||""}),Se.actorRole&&f.jsx(ac,{variant:"outline",className:"w-fit mt-1",children:((ze=Bj.find(Ne=>Ne.value===Se.actorRole))==null?void 0:ze.label)||"Unknown"})]})}),f.jsx(Ba,{children:new Date(Se.timestamp).toLocaleString()}),f.jsx(Ba,{children:Se.userName||"N/A"}),f.jsx(Ba,{children:Se.email}),f.jsx(Ba,{children:f.jsx(ac,{variant:Oe(Se.role),children:((et=Bj.find(Ne=>Ne.value===Se.role))==null?void 0:et.label)||"Unknown"})}),f.jsx(Ba,{children:f.jsx(ac,{variant:Ae(Se.logType),children:((je=fK.find(Ne=>Ne.value===Se.logType))==null?void 0:je.label)||Se.logType})}),f.jsx(Ba,{children:f.jsx("span",{className:"text-sm text-muted-foreground",children:Se.details||"N/A"})}),f.jsx(Ba,{children:f.jsx("span",{className:"font-mono text-sm",children:Se.ipAddress==="::1"||Se.ipAddress==="::ffff:127.0.0.1"?"127.0.0.1":Se.ipAddress||"N/A"})}),f.jsx(Ba,{children:f.jsx(ac,{variant:Se.status==="success"?"default":"destructive",children:Se.status})})]},ke)})})]})}),H>1&&f.jsxs("div",{className:"flex items-center justify-between mt-4",children:[f.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",U," of ",H]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(Ur,{variant:"outline",size:"sm",onClick:()=>ne(U-1),disabled:U===1||n,children:"Previous"}),f.jsx(Ur,{variant:"outline",size:"sm",onClick:()=>ne(U+1),disabled:U===H||n,children:"Next"})]})]})]})})]})]})})}function S6e(){return f.jsxs(f.Fragment,{children:[f.jsx(Ase,{closeButton:!0}),f.jsxs(gle,{children:[f.jsxs(Fa,{path:"/",element:f.jsx(fme,{}),children:[f.jsx(Fa,{path:"/login",element:f.jsx(Uve,{})}),f.jsx(Fa,{path:"/404",element:f.jsx(pUe,{})})]}),f.jsx(Fa,{path:"/",element:f.jsx(LBe,{allowedRoles:["superadmin","admin","employee"]}),children:f.jsxs(Fa,{element:f.jsx(jVe,{}),children:[f.jsx(Fa,{index:!0,element:f.jsx(DBe,{})}),f.jsx(Fa,{path:"/analytics/registration",element:f.jsx(ZUe,{})}),f.jsx(Fa,{path:"/analytics/violation",element:f.jsx(o6e,{})}),f.jsx(Fa,{path:"/analytics/accident",element:f.jsx(m6e,{})}),f.jsx(Fa,{path:"/driver",element:f.jsx(sUe,{})}),f.jsx(Fa,{path:"/driver/inactive",element:f.jsx(gUe,{})}),f.jsx(Fa,{path:"/driver/:id",element:f.jsx(fUe,{})}),f.jsx(Fa,{path:"/driver/:id/edit",element:f.jsx(mUe,{})}),f.jsx(Fa,{path:"/vehicle",element:f.jsx(xUe,{})}),f.jsx(Fa,{path:"/vehicle/:id",element:f.jsx(wUe,{})}),f.jsx(Fa,{path:"/vehicle/:id/edit",element:f.jsx(SUe,{})}),f.jsx(Fa,{path:"/violation",element:f.jsx(PUe,{})}),f.jsx(Fa,{path:"/violation/:id",element:f.jsx(NUe,{})}),f.jsx(Fa,{path:"/violation/:id/edit",element:f.jsx(IUe,{})}),f.jsx(Fa,{path:"/accident",element:f.jsx(MUe,{})}),f.jsx(Fa,{path:"/accident/:id",element:f.jsx(RUe,{})}),f.jsx(Fa,{path:"/accident/:id/edit",element:f.jsx(kUe,{})}),f.jsx(Fa,{path:"/account/register",element:f.jsx(Lj,{allowedRoles:["admin","superadmin"],children:f.jsx(v6e,{})})}),f.jsx(Fa,{path:"/account/update",element:f.jsx(Lj,{allowedRoles:["admin","superadmin"],children:f.jsx(b6e,{})})}),f.jsx(Fa,{path:"/account/logs",element:f.jsx(Lj,{allowedRoles:["admin","superadmin"],children:f.jsx(w6e,{})})})]})}),f.jsx(Fa,{path:"*",element:f.jsx(RD,{to:"/404"})})]})]})}var nA={},pK;function A6e(){if(pK)return nA;pK=1;var e=mK();return nA.createRoot=e.createRoot,nA.hydrateRoot=e.hydrateRoot,nA}var T6e=A6e();const P6e=ta(T6e);P6e.createRoot(document.getElementById("root")).render(f.jsx(Pe.StrictMode,{children:f.jsx(Fle,{children:f.jsx(Bve,{children:f.jsx(ume,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:f.jsx(S6e,{})})})})}));
