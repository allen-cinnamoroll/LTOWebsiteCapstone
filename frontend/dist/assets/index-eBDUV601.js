function toe(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const c=Object.getOwnPropertyDescriptor(n,a);c&&Object.defineProperty(e,a,c.get?c:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(a){if(a.ep)return;a.ep=!0;const c=r(a);fetch(a.href,c)}})();var TS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function la(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wj={exports:{}},Mb={},Hj={exports:{}},Ri={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gB;function roe(){if(gB)return Ri;gB=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),f=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),P=Symbol.iterator;function E(Xe){return Xe===null||typeof Xe!="object"?null:(Xe=P&&Xe[P]||Xe["@@iterator"],typeof Xe=="function"?Xe:null)}var D={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,L={};function $(Xe,ot,qe){this.props=Xe,this.context=ot,this.refs=L,this.updater=qe||D}$.prototype.isReactComponent={},$.prototype.setState=function(Xe,ot){if(typeof Xe!="object"&&typeof Xe!="function"&&Xe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Xe,ot,"setState")},$.prototype.forceUpdate=function(Xe){this.updater.enqueueForceUpdate(this,Xe,"forceUpdate")};function H(){}H.prototype=$.prototype;function K(Xe,ot,qe){this.props=Xe,this.context=ot,this.refs=L,this.updater=qe||D}var Q=K.prototype=new H;Q.constructor=K,V(Q,$.prototype),Q.isPureReactComponent=!0;var ae=Array.isArray,ee=Object.prototype.hasOwnProperty,se={current:null},ce={key:!0,ref:!0,__self:!0,__source:!0};function he(Xe,ot,qe){var Lt,Zt={},Xt=null,rr=null;if(ot!=null)for(Lt in ot.ref!==void 0&&(rr=ot.ref),ot.key!==void 0&&(Xt=""+ot.key),ot)ee.call(ot,Lt)&&!ce.hasOwnProperty(Lt)&&(Zt[Lt]=ot[Lt]);var ir=arguments.length-2;if(ir===1)Zt.children=qe;else if(1<ir){for(var Bt=Array(ir),De=0;De<ir;De++)Bt[De]=arguments[De+2];Zt.children=Bt}if(Xe&&Xe.defaultProps)for(Lt in ir=Xe.defaultProps,ir)Zt[Lt]===void 0&&(Zt[Lt]=ir[Lt]);return{$$typeof:e,type:Xe,key:Xt,ref:rr,props:Zt,_owner:se.current}}function Pe(Xe,ot){return{$$typeof:e,type:Xe.type,key:ot,ref:Xe.ref,props:Xe.props,_owner:Xe._owner}}function Ne(Xe){return typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===e}function pe(Xe){var ot={"=":"=0",":":"=2"};return"$"+Xe.replace(/[=:]/g,function(qe){return ot[qe]})}var je=/\/+/g;function xe(Xe,ot){return typeof Xe=="object"&&Xe!==null&&Xe.key!=null?pe(""+Xe.key):ot.toString(36)}function Ce(Xe,ot,qe,Lt,Zt){var Xt=typeof Xe;(Xt==="undefined"||Xt==="boolean")&&(Xe=null);var rr=!1;if(Xe===null)rr=!0;else switch(Xt){case"string":case"number":rr=!0;break;case"object":switch(Xe.$$typeof){case e:case t:rr=!0}}if(rr)return rr=Xe,Zt=Zt(rr),Xe=Lt===""?"."+xe(rr,0):Lt,ae(Zt)?(qe="",Xe!=null&&(qe=Xe.replace(je,"$&/")+"/"),Ce(Zt,ot,qe,"",function(De){return De})):Zt!=null&&(Ne(Zt)&&(Zt=Pe(Zt,qe+(!Zt.key||rr&&rr.key===Zt.key?"":(""+Zt.key).replace(je,"$&/")+"/")+Xe)),ot.push(Zt)),1;if(rr=0,Lt=Lt===""?".":Lt+":",ae(Xe))for(var ir=0;ir<Xe.length;ir++){Xt=Xe[ir];var Bt=Lt+xe(Xt,ir);rr+=Ce(Xt,ot,qe,Bt,Zt)}else if(Bt=E(Xe),typeof Bt=="function")for(Xe=Bt.call(Xe),ir=0;!(Xt=Xe.next()).done;)Xt=Xt.value,Bt=Lt+xe(Xt,ir++),rr+=Ce(Xt,ot,qe,Bt,Zt);else if(Xt==="object")throw ot=String(Xe),Error("Objects are not valid as a React child (found: "+(ot==="[object Object]"?"object with keys {"+Object.keys(Xe).join(", ")+"}":ot)+"). If you meant to render a collection of children, use an array instead.");return rr}function ze(Xe,ot,qe){if(Xe==null)return Xe;var Lt=[],Zt=0;return Ce(Xe,Lt,"","",function(Xt){return ot.call(qe,Xt,Zt++)}),Lt}function Te(Xe){if(Xe._status===-1){var ot=Xe._result;ot=ot(),ot.then(function(qe){(Xe._status===0||Xe._status===-1)&&(Xe._status=1,Xe._result=qe)},function(qe){(Xe._status===0||Xe._status===-1)&&(Xe._status=2,Xe._result=qe)}),Xe._status===-1&&(Xe._status=0,Xe._result=ot)}if(Xe._status===1)return Xe._result.default;throw Xe._result}var Re={current:null},Fe={transition:null},He={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:Fe,ReactCurrentOwner:se};function mt(){throw Error("act(...) is not supported in production builds of React.")}return Ri.Children={map:ze,forEach:function(Xe,ot,qe){ze(Xe,function(){ot.apply(this,arguments)},qe)},count:function(Xe){var ot=0;return ze(Xe,function(){ot++}),ot},toArray:function(Xe){return ze(Xe,function(ot){return ot})||[]},only:function(Xe){if(!Ne(Xe))throw Error("React.Children.only expected to receive a single React element child.");return Xe}},Ri.Component=$,Ri.Fragment=r,Ri.Profiler=a,Ri.PureComponent=K,Ri.StrictMode=n,Ri.Suspense=x,Ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=He,Ri.act=mt,Ri.cloneElement=function(Xe,ot,qe){if(Xe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Xe+".");var Lt=V({},Xe.props),Zt=Xe.key,Xt=Xe.ref,rr=Xe._owner;if(ot!=null){if(ot.ref!==void 0&&(Xt=ot.ref,rr=se.current),ot.key!==void 0&&(Zt=""+ot.key),Xe.type&&Xe.type.defaultProps)var ir=Xe.type.defaultProps;for(Bt in ot)ee.call(ot,Bt)&&!ce.hasOwnProperty(Bt)&&(Lt[Bt]=ot[Bt]===void 0&&ir!==void 0?ir[Bt]:ot[Bt])}var Bt=arguments.length-2;if(Bt===1)Lt.children=qe;else if(1<Bt){ir=Array(Bt);for(var De=0;De<Bt;De++)ir[De]=arguments[De+2];Lt.children=ir}return{$$typeof:e,type:Xe.type,key:Zt,ref:Xt,props:Lt,_owner:rr}},Ri.createContext=function(Xe){return Xe={$$typeof:f,_currentValue:Xe,_currentValue2:Xe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Xe.Provider={$$typeof:c,_context:Xe},Xe.Consumer=Xe},Ri.createElement=he,Ri.createFactory=function(Xe){var ot=he.bind(null,Xe);return ot.type=Xe,ot},Ri.createRef=function(){return{current:null}},Ri.forwardRef=function(Xe){return{$$typeof:i,render:Xe}},Ri.isValidElement=Ne,Ri.lazy=function(Xe){return{$$typeof:A,_payload:{_status:-1,_result:Xe},_init:Te}},Ri.memo=function(Xe,ot){return{$$typeof:w,type:Xe,compare:ot===void 0?null:ot}},Ri.startTransition=function(Xe){var ot=Fe.transition;Fe.transition={};try{Xe()}finally{Fe.transition=ot}},Ri.unstable_act=mt,Ri.useCallback=function(Xe,ot){return Re.current.useCallback(Xe,ot)},Ri.useContext=function(Xe){return Re.current.useContext(Xe)},Ri.useDebugValue=function(){},Ri.useDeferredValue=function(Xe){return Re.current.useDeferredValue(Xe)},Ri.useEffect=function(Xe,ot){return Re.current.useEffect(Xe,ot)},Ri.useId=function(){return Re.current.useId()},Ri.useImperativeHandle=function(Xe,ot,qe){return Re.current.useImperativeHandle(Xe,ot,qe)},Ri.useInsertionEffect=function(Xe,ot){return Re.current.useInsertionEffect(Xe,ot)},Ri.useLayoutEffect=function(Xe,ot){return Re.current.useLayoutEffect(Xe,ot)},Ri.useMemo=function(Xe,ot){return Re.current.useMemo(Xe,ot)},Ri.useReducer=function(Xe,ot,qe){return Re.current.useReducer(Xe,ot,qe)},Ri.useRef=function(Xe){return Re.current.useRef(Xe)},Ri.useState=function(Xe){return Re.current.useState(Xe)},Ri.useSyncExternalStore=function(Xe,ot,qe){return Re.current.useSyncExternalStore(Xe,ot,qe)},Ri.useTransition=function(){return Re.current.useTransition()},Ri.version="18.3.1",Ri}var yB;function B3(){return yB||(yB=1,Hj.exports=roe()),Hj.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vB;function noe(){if(vB)return Mb;vB=1;var e=B3(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function f(i,x,w){var A,P={},E=null,D=null;w!==void 0&&(E=""+w),x.key!==void 0&&(E=""+x.key),x.ref!==void 0&&(D=x.ref);for(A in x)n.call(x,A)&&!c.hasOwnProperty(A)&&(P[A]=x[A]);if(i&&i.defaultProps)for(A in x=i.defaultProps,x)P[A]===void 0&&(P[A]=x[A]);return{$$typeof:t,type:i,key:E,ref:D,props:P,_owner:a.current}}return Mb.Fragment=r,Mb.jsx=f,Mb.jsxs=f,Mb}var xB;function ioe(){return xB||(xB=1,Wj.exports=noe()),Wj.exports}var l=ioe(),W=B3();const Oe=la(W),OW=toe({__proto__:null,default:Oe},[W]);var aoe=(e,t,r,n,a,c,f,i)=>{let x=document.documentElement,w=["light","dark"];function A(D){(Array.isArray(e)?e:[e]).forEach(V=>{let L=V==="class",$=L&&c?a.map(H=>c[H]||H):a;L?(x.classList.remove(...$),x.classList.add(c&&c[D]?c[D]:D)):x.setAttribute(V,D)}),P(D)}function P(D){i&&w.includes(D)&&(x.style.colorScheme=D)}function E(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)A(n);else try{let D=localStorage.getItem(t)||r,V=f&&D==="system"?E():D;A(V)}catch{}},soe=W.createContext(void 0),ooe={setTheme:e=>{},themes:[]},loe=()=>{var e;return(e=W.useContext(soe))!=null?e:ooe};W.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:c,value:f,themes:i,nonce:x,scriptProps:w})=>{let A=JSON.stringify([r,t,c,e,i,f,n,a]).slice(1,-1);return W.createElement("script",{...w,suppressHydrationWarning:!0,nonce:typeof window>"u"?x:"",dangerouslySetInnerHTML:{__html:`(${aoe.toString()})(${A})`}})});var Kj={exports:{}},$c={},Zj={exports:{}},Yj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _B;function coe(){return _B||(_B=1,function(e){function t(Fe,He){var mt=Fe.length;Fe.push(He);e:for(;0<mt;){var Xe=mt-1>>>1,ot=Fe[Xe];if(0<a(ot,He))Fe[Xe]=He,Fe[mt]=ot,mt=Xe;else break e}}function r(Fe){return Fe.length===0?null:Fe[0]}function n(Fe){if(Fe.length===0)return null;var He=Fe[0],mt=Fe.pop();if(mt!==He){Fe[0]=mt;e:for(var Xe=0,ot=Fe.length,qe=ot>>>1;Xe<qe;){var Lt=2*(Xe+1)-1,Zt=Fe[Lt],Xt=Lt+1,rr=Fe[Xt];if(0>a(Zt,mt))Xt<ot&&0>a(rr,Zt)?(Fe[Xe]=rr,Fe[Xt]=mt,Xe=Xt):(Fe[Xe]=Zt,Fe[Lt]=mt,Xe=Lt);else if(Xt<ot&&0>a(rr,mt))Fe[Xe]=rr,Fe[Xt]=mt,Xe=Xt;else break e}}return He}function a(Fe,He){var mt=Fe.sortIndex-He.sortIndex;return mt!==0?mt:Fe.id-He.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var f=Date,i=f.now();e.unstable_now=function(){return f.now()-i}}var x=[],w=[],A=1,P=null,E=3,D=!1,V=!1,L=!1,$=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Q(Fe){for(var He=r(w);He!==null;){if(He.callback===null)n(w);else if(He.startTime<=Fe)n(w),He.sortIndex=He.expirationTime,t(x,He);else break;He=r(w)}}function ae(Fe){if(L=!1,Q(Fe),!V)if(r(x)!==null)V=!0,Te(ee);else{var He=r(w);He!==null&&Re(ae,He.startTime-Fe)}}function ee(Fe,He){V=!1,L&&(L=!1,H(he),he=-1),D=!0;var mt=E;try{for(Q(He),P=r(x);P!==null&&(!(P.expirationTime>He)||Fe&&!pe());){var Xe=P.callback;if(typeof Xe=="function"){P.callback=null,E=P.priorityLevel;var ot=Xe(P.expirationTime<=He);He=e.unstable_now(),typeof ot=="function"?P.callback=ot:P===r(x)&&n(x),Q(He)}else n(x);P=r(x)}if(P!==null)var qe=!0;else{var Lt=r(w);Lt!==null&&Re(ae,Lt.startTime-He),qe=!1}return qe}finally{P=null,E=mt,D=!1}}var se=!1,ce=null,he=-1,Pe=5,Ne=-1;function pe(){return!(e.unstable_now()-Ne<Pe)}function je(){if(ce!==null){var Fe=e.unstable_now();Ne=Fe;var He=!0;try{He=ce(!0,Fe)}finally{He?xe():(se=!1,ce=null)}}else se=!1}var xe;if(typeof K=="function")xe=function(){K(je)};else if(typeof MessageChannel<"u"){var Ce=new MessageChannel,ze=Ce.port2;Ce.port1.onmessage=je,xe=function(){ze.postMessage(null)}}else xe=function(){$(je,0)};function Te(Fe){ce=Fe,se||(se=!0,xe())}function Re(Fe,He){he=$(function(){Fe(e.unstable_now())},He)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Fe){Fe.callback=null},e.unstable_continueExecution=function(){V||D||(V=!0,Te(ee))},e.unstable_forceFrameRate=function(Fe){0>Fe||125<Fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Pe=0<Fe?Math.floor(1e3/Fe):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return r(x)},e.unstable_next=function(Fe){switch(E){case 1:case 2:case 3:var He=3;break;default:He=E}var mt=E;E=He;try{return Fe()}finally{E=mt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Fe,He){switch(Fe){case 1:case 2:case 3:case 4:case 5:break;default:Fe=3}var mt=E;E=Fe;try{return He()}finally{E=mt}},e.unstable_scheduleCallback=function(Fe,He,mt){var Xe=e.unstable_now();switch(typeof mt=="object"&&mt!==null?(mt=mt.delay,mt=typeof mt=="number"&&0<mt?Xe+mt:Xe):mt=Xe,Fe){case 1:var ot=-1;break;case 2:ot=250;break;case 5:ot=1073741823;break;case 4:ot=1e4;break;default:ot=5e3}return ot=mt+ot,Fe={id:A++,callback:He,priorityLevel:Fe,startTime:mt,expirationTime:ot,sortIndex:-1},mt>Xe?(Fe.sortIndex=mt,t(w,Fe),r(x)===null&&Fe===r(w)&&(L?(H(he),he=-1):L=!0,Re(ae,mt-Xe))):(Fe.sortIndex=ot,t(x,Fe),V||D||(V=!0,Te(ee))),Fe},e.unstable_shouldYield=pe,e.unstable_wrapCallback=function(Fe){var He=E;return function(){var mt=E;E=He;try{return Fe.apply(this,arguments)}finally{E=mt}}}}(Yj)),Yj}var bB;function uoe(){return bB||(bB=1,Zj.exports=coe()),Zj.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wB;function doe(){if(wB)return $c;wB=1;var e=B3(),t=uoe();function r(b){for(var T="https://reactjs.org/docs/error-decoder.html?invariant="+b,U=1;U<arguments.length;U++)T+="&args[]="+encodeURIComponent(arguments[U]);return"Minified React error #"+b+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function c(b,T){f(b,T),f(b+"Capture",T)}function f(b,T){for(a[b]=T,b=0;b<T.length;b++)n.add(T[b])}var i=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),x=Object.prototype.hasOwnProperty,w=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A={},P={};function E(b){return x.call(P,b)?!0:x.call(A,b)?!1:w.test(b)?P[b]=!0:(A[b]=!0,!1)}function D(b,T,U,J){if(U!==null&&U.type===0)return!1;switch(typeof T){case"function":case"symbol":return!0;case"boolean":return J?!1:U!==null?!U.acceptsBooleans:(b=b.toLowerCase().slice(0,5),b!=="data-"&&b!=="aria-");default:return!1}}function V(b,T,U,J){if(T===null||typeof T>"u"||D(b,T,U,J))return!0;if(J)return!1;if(U!==null)switch(U.type){case 3:return!T;case 4:return T===!1;case 5:return isNaN(T);case 6:return isNaN(T)||1>T}return!1}function L(b,T,U,J,de,ge,Ue){this.acceptsBooleans=T===2||T===3||T===4,this.attributeName=J,this.attributeNamespace=de,this.mustUseProperty=U,this.propertyName=b,this.type=T,this.sanitizeURL=ge,this.removeEmptyString=Ue}var $={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(b){$[b]=new L(b,0,!1,b,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(b){var T=b[0];$[T]=new L(T,1,!1,b[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(b){$[b]=new L(b,2,!1,b.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(b){$[b]=new L(b,2,!1,b,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(b){$[b]=new L(b,3,!1,b.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(b){$[b]=new L(b,3,!0,b,null,!1,!1)}),["capture","download"].forEach(function(b){$[b]=new L(b,4,!1,b,null,!1,!1)}),["cols","rows","size","span"].forEach(function(b){$[b]=new L(b,6,!1,b,null,!1,!1)}),["rowSpan","start"].forEach(function(b){$[b]=new L(b,5,!1,b.toLowerCase(),null,!1,!1)});var H=/[\-:]([a-z])/g;function K(b){return b[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(b){var T=b.replace(H,K);$[T]=new L(T,1,!1,b,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(b){var T=b.replace(H,K);$[T]=new L(T,1,!1,b,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(b){var T=b.replace(H,K);$[T]=new L(T,1,!1,b,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(b){$[b]=new L(b,1,!1,b.toLowerCase(),null,!1,!1)}),$.xlinkHref=new L("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(b){$[b]=new L(b,1,!1,b.toLowerCase(),null,!0,!0)});function Q(b,T,U,J){var de=$.hasOwnProperty(T)?$[T]:null;(de!==null?de.type!==0:J||!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&(V(T,U,de,J)&&(U=null),J||de===null?E(T)&&(U===null?b.removeAttribute(T):b.setAttribute(T,""+U)):de.mustUseProperty?b[de.propertyName]=U===null?de.type===3?!1:"":U:(T=de.attributeName,J=de.attributeNamespace,U===null?b.removeAttribute(T):(de=de.type,U=de===3||de===4&&U===!0?"":""+U,J?b.setAttributeNS(J,T,U):b.setAttribute(T,U))))}var ae=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ee=Symbol.for("react.element"),se=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),he=Symbol.for("react.strict_mode"),Pe=Symbol.for("react.profiler"),Ne=Symbol.for("react.provider"),pe=Symbol.for("react.context"),je=Symbol.for("react.forward_ref"),xe=Symbol.for("react.suspense"),Ce=Symbol.for("react.suspense_list"),ze=Symbol.for("react.memo"),Te=Symbol.for("react.lazy"),Re=Symbol.for("react.offscreen"),Fe=Symbol.iterator;function He(b){return b===null||typeof b!="object"?null:(b=Fe&&b[Fe]||b["@@iterator"],typeof b=="function"?b:null)}var mt=Object.assign,Xe;function ot(b){if(Xe===void 0)try{throw Error()}catch(U){var T=U.stack.trim().match(/\n( *(at )?)/);Xe=T&&T[1]||""}return`
`+Xe+b}var qe=!1;function Lt(b,T){if(!b||qe)return"";qe=!0;var U=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(T)if(T=function(){throw Error()},Object.defineProperty(T.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(T,[])}catch(Jt){var J=Jt}Reflect.construct(b,[],T)}else{try{T.call()}catch(Jt){J=Jt}b.call(T.prototype)}else{try{throw Error()}catch(Jt){J=Jt}b()}}catch(Jt){if(Jt&&J&&typeof Jt.stack=="string"){for(var de=Jt.stack.split(`
`),ge=J.stack.split(`
`),Ue=de.length-1,yt=ge.length-1;1<=Ue&&0<=yt&&de[Ue]!==ge[yt];)yt--;for(;1<=Ue&&0<=yt;Ue--,yt--)if(de[Ue]!==ge[yt]){if(Ue!==1||yt!==1)do if(Ue--,yt--,0>yt||de[Ue]!==ge[yt]){var Nt=`
`+de[Ue].replace(" at new "," at ");return b.displayName&&Nt.includes("<anonymous>")&&(Nt=Nt.replace("<anonymous>",b.displayName)),Nt}while(1<=Ue&&0<=yt);break}}}finally{qe=!1,Error.prepareStackTrace=U}return(b=b?b.displayName||b.name:"")?ot(b):""}function Zt(b){switch(b.tag){case 5:return ot(b.type);case 16:return ot("Lazy");case 13:return ot("Suspense");case 19:return ot("SuspenseList");case 0:case 2:case 15:return b=Lt(b.type,!1),b;case 11:return b=Lt(b.type.render,!1),b;case 1:return b=Lt(b.type,!0),b;default:return""}}function Xt(b){if(b==null)return null;if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b;switch(b){case ce:return"Fragment";case se:return"Portal";case Pe:return"Profiler";case he:return"StrictMode";case xe:return"Suspense";case Ce:return"SuspenseList"}if(typeof b=="object")switch(b.$$typeof){case pe:return(b.displayName||"Context")+".Consumer";case Ne:return(b._context.displayName||"Context")+".Provider";case je:var T=b.render;return b=b.displayName,b||(b=T.displayName||T.name||"",b=b!==""?"ForwardRef("+b+")":"ForwardRef"),b;case ze:return T=b.displayName||null,T!==null?T:Xt(b.type)||"Memo";case Te:T=b._payload,b=b._init;try{return Xt(b(T))}catch{}}return null}function rr(b){var T=b.type;switch(b.tag){case 24:return"Cache";case 9:return(T.displayName||"Context")+".Consumer";case 10:return(T._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return b=T.render,b=b.displayName||b.name||"",T.displayName||(b!==""?"ForwardRef("+b+")":"ForwardRef");case 7:return"Fragment";case 5:return T;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xt(T);case 8:return T===he?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T}return null}function ir(b){switch(typeof b){case"boolean":case"number":case"string":case"undefined":return b;case"object":return b;default:return""}}function Bt(b){var T=b.type;return(b=b.nodeName)&&b.toLowerCase()==="input"&&(T==="checkbox"||T==="radio")}function De(b){var T=Bt(b)?"checked":"value",U=Object.getOwnPropertyDescriptor(b.constructor.prototype,T),J=""+b[T];if(!b.hasOwnProperty(T)&&typeof U<"u"&&typeof U.get=="function"&&typeof U.set=="function"){var de=U.get,ge=U.set;return Object.defineProperty(b,T,{configurable:!0,get:function(){return de.call(this)},set:function(Ue){J=""+Ue,ge.call(this,Ue)}}),Object.defineProperty(b,T,{enumerable:U.enumerable}),{getValue:function(){return J},setValue:function(Ue){J=""+Ue},stopTracking:function(){b._valueTracker=null,delete b[T]}}}}function jr(b){b._valueTracker||(b._valueTracker=De(b))}function Dt(b){if(!b)return!1;var T=b._valueTracker;if(!T)return!0;var U=T.getValue(),J="";return b&&(J=Bt(b)?b.checked?"true":"false":b.value),b=J,b!==U?(T.setValue(b),!0):!1}function Cr(b){if(b=b||(typeof document<"u"?document:void 0),typeof b>"u")return null;try{return b.activeElement||b.body}catch{return b.body}}function At(b,T){var U=T.checked;return mt({},T,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:U??b._wrapperState.initialChecked})}function qr(b,T){var U=T.defaultValue==null?"":T.defaultValue,J=T.checked!=null?T.checked:T.defaultChecked;U=ir(T.value!=null?T.value:U),b._wrapperState={initialChecked:J,initialValue:U,controlled:T.type==="checkbox"||T.type==="radio"?T.checked!=null:T.value!=null}}function an(b,T){T=T.checked,T!=null&&Q(b,"checked",T,!1)}function Jn(b,T){an(b,T);var U=ir(T.value),J=T.type;if(U!=null)J==="number"?(U===0&&b.value===""||b.value!=U)&&(b.value=""+U):b.value!==""+U&&(b.value=""+U);else if(J==="submit"||J==="reset"){b.removeAttribute("value");return}T.hasOwnProperty("value")?xt(b,T.type,U):T.hasOwnProperty("defaultValue")&&xt(b,T.type,ir(T.defaultValue)),T.checked==null&&T.defaultChecked!=null&&(b.defaultChecked=!!T.defaultChecked)}function tt(b,T,U){if(T.hasOwnProperty("value")||T.hasOwnProperty("defaultValue")){var J=T.type;if(!(J!=="submit"&&J!=="reset"||T.value!==void 0&&T.value!==null))return;T=""+b._wrapperState.initialValue,U||T===b.value||(b.value=T),b.defaultValue=T}U=b.name,U!==""&&(b.name=""),b.defaultChecked=!!b._wrapperState.initialChecked,U!==""&&(b.name=U)}function xt(b,T,U){(T!=="number"||Cr(b.ownerDocument)!==b)&&(U==null?b.defaultValue=""+b._wrapperState.initialValue:b.defaultValue!==""+U&&(b.defaultValue=""+U))}var Mt=Array.isArray;function lr(b,T,U,J){if(b=b.options,T){T={};for(var de=0;de<U.length;de++)T["$"+U[de]]=!0;for(U=0;U<b.length;U++)de=T.hasOwnProperty("$"+b[U].value),b[U].selected!==de&&(b[U].selected=de),de&&J&&(b[U].defaultSelected=!0)}else{for(U=""+ir(U),T=null,de=0;de<b.length;de++){if(b[de].value===U){b[de].selected=!0,J&&(b[de].defaultSelected=!0);return}T!==null||b[de].disabled||(T=b[de])}T!==null&&(T.selected=!0)}}function cr(b,T){if(T.dangerouslySetInnerHTML!=null)throw Error(r(91));return mt({},T,{value:void 0,defaultValue:void 0,children:""+b._wrapperState.initialValue})}function xr(b,T){var U=T.value;if(U==null){if(U=T.children,T=T.defaultValue,U!=null){if(T!=null)throw Error(r(92));if(Mt(U)){if(1<U.length)throw Error(r(93));U=U[0]}T=U}T==null&&(T=""),U=T}b._wrapperState={initialValue:ir(U)}}function ur(b,T){var U=ir(T.value),J=ir(T.defaultValue);U!=null&&(U=""+U,U!==b.value&&(b.value=U),T.defaultValue==null&&b.defaultValue!==U&&(b.defaultValue=U)),J!=null&&(b.defaultValue=""+J)}function tn(b){var T=b.textContent;T===b._wrapperState.initialValue&&T!==""&&T!==null&&(b.value=T)}function Gn(b){switch(b){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gi(b,T){return b==null||b==="http://www.w3.org/1999/xhtml"?Gn(T):b==="http://www.w3.org/2000/svg"&&T==="foreignObject"?"http://www.w3.org/1999/xhtml":b}var Ui,uo=function(b){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(T,U,J,de){MSApp.execUnsafeLocalFunction(function(){return b(T,U,J,de)})}:b}(function(b,T){if(b.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in b)b.innerHTML=T;else{for(Ui=Ui||document.createElement("div"),Ui.innerHTML="<svg>"+T.valueOf().toString()+"</svg>",T=Ui.firstChild;b.firstChild;)b.removeChild(b.firstChild);for(;T.firstChild;)b.appendChild(T.firstChild)}});function Va(b,T){if(T){var U=b.firstChild;if(U&&U===b.lastChild&&U.nodeType===3){U.nodeValue=T;return}}b.textContent=T}var Ks={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},To=["Webkit","ms","Moz","O"];Object.keys(Ks).forEach(function(b){To.forEach(function(T){T=T+b.charAt(0).toUpperCase()+b.substring(1),Ks[T]=Ks[b]})});function es(b,T,U){return T==null||typeof T=="boolean"||T===""?"":U||typeof T!="number"||T===0||Ks.hasOwnProperty(b)&&Ks[b]?(""+T).trim():T+"px"}function rc(b,T){b=b.style;for(var U in T)if(T.hasOwnProperty(U)){var J=U.indexOf("--")===0,de=es(U,T[U],J);U==="float"&&(U="cssFloat"),J?b.setProperty(U,de):b[U]=de}}var kl=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fs(b,T){if(T){if(kl[b]&&(T.children!=null||T.dangerouslySetInnerHTML!=null))throw Error(r(137,b));if(T.dangerouslySetInnerHTML!=null){if(T.children!=null)throw Error(r(60));if(typeof T.dangerouslySetInnerHTML!="object"||!("__html"in T.dangerouslySetInnerHTML))throw Error(r(61))}if(T.style!=null&&typeof T.style!="object")throw Error(r(62))}}function nc(b,T){if(b.indexOf("-")===-1)return typeof T.is=="string";switch(b){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=null;function ts(b){return b=b.target||b.srcElement||window,b.correspondingUseElement&&(b=b.correspondingUseElement),b.nodeType===3?b.parentNode:b}var Uu=null,Ua=null,Zs=null;function Wn(b){if(b=rh(b)){if(typeof Uu!="function")throw Error(r(280));var T=b.stateNode;T&&(T=gf(T),Uu(b.stateNode,b.type,T))}}function fa(b){Ua?Zs?Zs.push(b):Zs=[b]:Ua=b}function Pa(){if(Ua){var b=Ua,T=Zs;if(Zs=Ua=null,Wn(b),T)for(b=0;b<T.length;b++)Wn(T[b])}}function Cs(b,T){return b(T)}function El(){}var Na=!1;function Bs(b,T,U){if(Na)return b(T,U);Na=!0;try{return Cs(b,T,U)}finally{Na=!1,(Ua!==null||Zs!==null)&&(El(),Pa())}}function $i(b,T){var U=b.stateNode;if(U===null)return null;var J=gf(U);if(J===null)return null;U=J[T];e:switch(T){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(J=!J.disabled)||(b=b.type,J=!(b==="button"||b==="input"||b==="select"||b==="textarea")),b=!J;break e;default:b=!1}if(b)return null;if(U&&typeof U!="function")throw Error(r(231,T,typeof U));return U}var ks=!1;if(i)try{var ms={};Object.defineProperty(ms,"passive",{get:function(){ks=!0}}),window.addEventListener("test",ms,ms),window.removeEventListener("test",ms,ms)}catch{ks=!1}function $u(b,T,U,J,de,ge,Ue,yt,Nt){var Jt=Array.prototype.slice.call(arguments,3);try{T.apply(U,Jt)}catch(Tr){this.onError(Tr)}}var Ki=!1,Go=null,Tt=!1,ve=null,Ae={onError:function(b){Ki=!0,Go=b}};function ke(b,T,U,J,de,ge,Ue,yt,Nt){Ki=!1,Go=null,$u.apply(Ae,arguments)}function Ze(b,T,U,J,de,ge,Ue,yt,Nt){if(ke.apply(this,arguments),Ki){if(Ki){var Jt=Go;Ki=!1,Go=null}else throw Error(r(198));Tt||(Tt=!0,ve=Jt)}}function Je(b){var T=b,U=b;if(b.alternate)for(;T.return;)T=T.return;else{b=T;do T=b,(T.flags&4098)!==0&&(U=T.return),b=T.return;while(b)}return T.tag===3?U:null}function at(b){if(b.tag===13){var T=b.memoizedState;if(T===null&&(b=b.alternate,b!==null&&(T=b.memoizedState)),T!==null)return T.dehydrated}return null}function gt(b){if(Je(b)!==b)throw Error(r(188))}function lt(b){var T=b.alternate;if(!T){if(T=Je(b),T===null)throw Error(r(188));return T!==b?null:b}for(var U=b,J=T;;){var de=U.return;if(de===null)break;var ge=de.alternate;if(ge===null){if(J=de.return,J!==null){U=J;continue}break}if(de.child===ge.child){for(ge=de.child;ge;){if(ge===U)return gt(de),b;if(ge===J)return gt(de),T;ge=ge.sibling}throw Error(r(188))}if(U.return!==J.return)U=de,J=ge;else{for(var Ue=!1,yt=de.child;yt;){if(yt===U){Ue=!0,U=de,J=ge;break}if(yt===J){Ue=!0,J=de,U=ge;break}yt=yt.sibling}if(!Ue){for(yt=ge.child;yt;){if(yt===U){Ue=!0,U=ge,J=de;break}if(yt===J){Ue=!0,J=ge,U=de;break}yt=yt.sibling}if(!Ue)throw Error(r(189))}}if(U.alternate!==J)throw Error(r(190))}if(U.tag!==3)throw Error(r(188));return U.stateNode.current===U?b:T}function St(b){return b=lt(b),b!==null?wt(b):null}function wt(b){if(b.tag===5||b.tag===6)return b;for(b=b.child;b!==null;){var T=wt(b);if(T!==null)return T;b=b.sibling}return null}var Pt=t.unstable_scheduleCallback,Vt=t.unstable_cancelCallback,ar=t.unstable_shouldYield,or=t.unstable_requestPaint,Ar=t.unstable_now,Gr=t.unstable_getCurrentPriorityLevel,$r=t.unstable_ImmediatePriority,Ur=t.unstable_UserBlockingPriority,On=t.unstable_NormalPriority,Kn=t.unstable_LowPriority,wn=t.unstable_IdlePriority,Un=null,Rn=null;function ja(b){if(Rn&&typeof Rn.onCommitFiberRoot=="function")try{Rn.onCommitFiberRoot(Un,b,void 0,(b.current.flags&128)===128)}catch{}}var gs=Math.clz32?Math.clz32:ho,$a=Math.log,rs=Math.LN2;function ho(b){return b>>>=0,b===0?32:31-($a(b)/rs|0)|0}var qu=64,Ml=4194304;function Qc(b){switch(b&-b){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return b&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return b}}function tf(b,T){var U=b.pendingLanes;if(U===0)return 0;var J=0,de=b.suspendedLanes,ge=b.pingedLanes,Ue=U&268435455;if(Ue!==0){var yt=Ue&~de;yt!==0?J=Qc(yt):(ge&=Ue,ge!==0&&(J=Qc(ge)))}else Ue=U&~de,Ue!==0?J=Qc(Ue):ge!==0&&(J=Qc(ge));if(J===0)return 0;if(T!==0&&T!==J&&(T&de)===0&&(de=J&-J,ge=T&-T,de>=ge||de===16&&(ge&4194240)!==0))return T;if((J&4)!==0&&(J|=U&16),T=b.entangledLanes,T!==0)for(b=b.entanglements,T&=J;0<T;)U=31-gs(T),de=1<<U,J|=b[U],T&=~de;return J}function ov(b,T){switch(b){case 1:case 2:case 4:return T+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vy(b,T){for(var U=b.suspendedLanes,J=b.pingedLanes,de=b.expirationTimes,ge=b.pendingLanes;0<ge;){var Ue=31-gs(ge),yt=1<<Ue,Nt=de[Ue];Nt===-1?((yt&U)===0||(yt&J)!==0)&&(de[Ue]=ov(yt,T)):Nt<=T&&(b.expiredLanes|=yt),ge&=~yt}}function mp(b){return b=b.pendingLanes&-1073741825,b!==0?b:b&1073741824?1073741824:0}function Ys(){var b=qu;return qu<<=1,(qu&4194240)===0&&(qu=64),b}function fl(b){for(var T=[],U=0;31>U;U++)T.push(b);return T}function pl(b,T,U){b.pendingLanes|=T,T!==536870912&&(b.suspendedLanes=0,b.pingedLanes=0),b=b.eventTimes,T=31-gs(T),b[T]=U}function Ac(b,T){var U=b.pendingLanes&~T;b.pendingLanes=T,b.suspendedLanes=0,b.pingedLanes=0,b.expiredLanes&=T,b.mutableReadLanes&=T,b.entangledLanes&=T,T=b.entanglements;var J=b.eventTimes;for(b=b.expirationTimes;0<U;){var de=31-gs(U),ge=1<<de;T[de]=0,J[de]=-1,b[de]=-1,U&=~ge}}function ml(b,T){var U=b.entangledLanes|=T;for(b=b.entanglements;U;){var J=31-gs(U),de=1<<J;de&T|b[J]&T&&(b[J]|=T),U&=~de}}var _i=0;function gp(b){return b&=-b,1<b?4<b?(b&268435455)!==0?16:536870912:4:1}var Rm,Tc,eu,xy,Im,Wo=!1,Qn=[],Pc=null,Fr=null,tu=null,Gu=new Map,Wu=new Map,fn=[],Dm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hu(b,T){switch(b){case"focusin":case"focusout":Pc=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":tu=null;break;case"pointerover":case"pointerout":Gu.delete(T.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wu.delete(T.pointerId)}}function wr(b,T,U,J,de,ge){return b===null||b.nativeEvent!==ge?(b={blockedOn:T,domEventName:U,eventSystemFlags:J,nativeEvent:ge,targetContainers:[de]},T!==null&&(T=rh(T),T!==null&&Tc(T)),b):(b.eventSystemFlags|=J,T=b.targetContainers,de!==null&&T.indexOf(de)===-1&&T.push(de),b)}function yi(b,T,U,J,de){switch(T){case"focusin":return Pc=wr(Pc,b,T,U,J,de),!0;case"dragenter":return Fr=wr(Fr,b,T,U,J,de),!0;case"mouseover":return tu=wr(tu,b,T,U,J,de),!0;case"pointerover":var ge=de.pointerId;return Gu.set(ge,wr(Gu.get(ge)||null,b,T,U,J,de)),!0;case"gotpointercapture":return ge=de.pointerId,Wu.set(ge,wr(Wu.get(ge)||null,b,T,U,J,de)),!0}return!1}function Hn(b){var T=id(b.target);if(T!==null){var U=Je(T);if(U!==null){if(T=U.tag,T===13){if(T=at(U),T!==null){b.blockedOn=T,Im(b.priority,function(){eu(U)});return}}else if(T===3&&U.stateNode.current.memoizedState.isDehydrated){b.blockedOn=U.tag===3?U.stateNode.containerInfo:null;return}}}b.blockedOn=null}function ys(b){if(b.blockedOn!==null)return!1;for(var T=b.targetContainers;0<T.length;){var U=qd(b.domEventName,b.eventSystemFlags,T[0],b.nativeEvent);if(U===null){U=b.nativeEvent;var J=new U.constructor(U.type,U);sn=J,U.target.dispatchEvent(J),sn=null}else return T=rh(U),T!==null&&Tc(T),b.blockedOn=U,!1;T.shift()}return!0}function Nc(b,T,U){ys(b)&&U.delete(T)}function si(){Wo=!1,Pc!==null&&ys(Pc)&&(Pc=null),Fr!==null&&ys(Fr)&&(Fr=null),tu!==null&&ys(tu)&&(tu=null),Gu.forEach(Nc),Wu.forEach(Nc)}function ru(b,T){b.blockedOn===T&&(b.blockedOn=null,Wo||(Wo=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,si)))}function Ho(b){function T(de){return ru(de,b)}if(0<Qn.length){ru(Qn[0],b);for(var U=1;U<Qn.length;U++){var J=Qn[U];J.blockedOn===b&&(J.blockedOn=null)}}for(Pc!==null&&ru(Pc,b),Fr!==null&&ru(Fr,b),tu!==null&&ru(tu,b),Gu.forEach(T),Wu.forEach(T),U=0;U<fn.length;U++)J=fn[U],J.blockedOn===b&&(J.blockedOn=null);for(;0<fn.length&&(U=fn[0],U.blockedOn===null);)Hn(U),U.blockedOn===null&&fn.shift()}var jc=ae.ReactCurrentBatchConfig,qa=!0;function pa(b,T,U,J){var de=_i,ge=jc.transition;jc.transition=null;try{_i=1,Xs(b,T,U,J)}finally{_i=de,jc.transition=ge}}function _y(b,T,U,J){var de=_i,ge=jc.transition;jc.transition=null;try{_i=4,Xs(b,T,U,J)}finally{_i=de,jc.transition=ge}}function Xs(b,T,U,J){if(qa){var de=qd(b,T,U,J);if(de===null)Jd(b,T,J,$d,U),Hu(b,J);else if(yi(de,b,T,U,J))J.stopPropagation();else if(Hu(b,J),T&4&&-1<Dm.indexOf(b)){for(;de!==null;){var ge=rh(de);if(ge!==null&&Rm(ge),ge=qd(b,T,U,J),ge===null&&Jd(b,T,J,$d,U),ge===de)break;de=ge}de!==null&&J.stopPropagation()}else Jd(b,T,J,null,U)}}var $d=null;function qd(b,T,U,J){if($d=null,b=ts(J),b=id(b),b!==null)if(T=Je(b),T===null)b=null;else if(U=T.tag,U===13){if(b=at(T),b!==null)return b;b=null}else if(U===3){if(T.stateNode.current.memoizedState.isDehydrated)return T.tag===3?T.stateNode.containerInfo:null;b=null}else T!==b&&(b=null);return $d=b,null}function yp(b){switch(b){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gr()){case $r:return 1;case Ur:return 4;case On:case Kn:return 16;case wn:return 536870912;default:return 16}default:return 16}}var Ol=null,Es=null,gl=null;function Ms(){if(gl)return gl;var b,T=Es,U=T.length,J,de="value"in Ol?Ol.value:Ol.textContent,ge=de.length;for(b=0;b<U&&T[b]===de[b];b++);var Ue=U-b;for(J=1;J<=Ue&&T[U-J]===de[ge-J];J++);return gl=de.slice(b,1<J?1-J:void 0)}function rf(b){var T=b.keyCode;return"charCode"in b?(b=b.charCode,b===0&&T===13&&(b=13)):b=T,b===10&&(b=13),32<=b||b===13?b:0}function Rl(){return!0}function na(){return!1}function Ca(b){function T(U,J,de,ge,Ue){this._reactName=U,this._targetInst=de,this.type=J,this.nativeEvent=ge,this.target=Ue,this.currentTarget=null;for(var yt in b)b.hasOwnProperty(yt)&&(U=b[yt],this[yt]=U?U(ge):ge[yt]);return this.isDefaultPrevented=(ge.defaultPrevented!=null?ge.defaultPrevented:ge.returnValue===!1)?Rl:na,this.isPropagationStopped=na,this}return mt(T.prototype,{preventDefault:function(){this.defaultPrevented=!0;var U=this.nativeEvent;U&&(U.preventDefault?U.preventDefault():typeof U.returnValue!="unknown"&&(U.returnValue=!1),this.isDefaultPrevented=Rl)},stopPropagation:function(){var U=this.nativeEvent;U&&(U.stopPropagation?U.stopPropagation():typeof U.cancelBubble!="unknown"&&(U.cancelBubble=!0),this.isPropagationStopped=Rl)},persist:function(){},isPersistent:Rl}),T}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(b){return b.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ma=Ca(ka),nu=mt({},ka,{view:0,detail:0}),ic=Ca(nu),iu,Gd,Po,nf=mt({},nu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ac,button:0,buttons:0,relatedTarget:function(b){return b.relatedTarget===void 0?b.fromElement===b.srcElement?b.toElement:b.fromElement:b.relatedTarget},movementX:function(b){return"movementX"in b?b.movementX:(b!==Po&&(Po&&b.type==="mousemove"?(iu=b.screenX-Po.screenX,Gd=b.screenY-Po.screenY):Gd=iu=0,Po=b),iu)},movementY:function(b){return"movementY"in b?b.movementY:Gd}}),Cc=Ca(nf),B_=mt({},nf,{dataTransfer:0}),by=Ca(B_),No=mt({},nu,{relatedTarget:0}),vp=Ca(No),Lm=mt({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),xp=Ca(Lm),_p=mt({},ka,{clipboardData:function(b){return"clipboardData"in b?b.clipboardData:window.clipboardData}}),V_=Ca(_p),U_=mt({},ka,{data:0}),af=Ca(U_),bp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wy(b){var T=this.nativeEvent;return T.getModifierState?T.getModifierState(b):(b=sf[b])?!!T[b]:!1}function ac(){return wy}var Ku=mt({},nu,{key:function(b){if(b.key){var T=bp[b.key]||b.key;if(T!=="Unidentified")return T}return b.type==="keypress"?(b=rf(b),b===13?"Enter":String.fromCharCode(b)):b.type==="keydown"||b.type==="keyup"?$_[b.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ac,charCode:function(b){return b.type==="keypress"?rf(b):0},keyCode:function(b){return b.type==="keydown"||b.type==="keyup"?b.keyCode:0},which:function(b){return b.type==="keypress"?rf(b):b.type==="keydown"||b.type==="keyup"?b.keyCode:0}}),q_=Ca(Ku),Sy=mt({},nf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lv=Ca(Sy),cv=mt({},nu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ac}),G_=Ca(cv),Ay=mt({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wd=Ca(Ay),An=mt({},nf,{deltaX:function(b){return"deltaX"in b?b.deltaX:"wheelDeltaX"in b?-b.wheelDeltaX:0},deltaY:function(b){return"deltaY"in b?b.deltaY:"wheelDeltaY"in b?-b.wheelDeltaY:"wheelDelta"in b?-b.wheelDelta:0},deltaZ:0,deltaMode:0}),Br=Ca(An),zm=[9,13,27,32],Kr=i&&"CompositionEvent"in window,kc=null;i&&"documentMode"in document&&(kc=document.documentMode);var Fm=i&&"TextEvent"in window&&!kc,Yr=i&&(!Kr||kc&&8<kc&&11>=kc),Hd=" ",Zu=!1;function Bm(b,T){switch(b){case"keyup":return zm.indexOf(T.keyCode)!==-1;case"keydown":return T.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wp(b){return b=b.detail,typeof b=="object"&&"data"in b?b.data:null}var vs=!1;function Vs(b,T){switch(b){case"compositionend":return wp(T);case"keypress":return T.which!==32?null:(Zu=!0,Hd);case"textInput":return b=T.data,b===Hd&&Zu?null:b;default:return null}}function hr(b,T){if(vs)return b==="compositionend"||!Kr&&Bm(b,T)?(b=Ms(),gl=Es=Ol=null,vs=!1,b):null;switch(b){case"paste":return null;case"keypress":if(!(T.ctrlKey||T.altKey||T.metaKey)||T.ctrlKey&&T.altKey){if(T.char&&1<T.char.length)return T.char;if(T.which)return String.fromCharCode(T.which)}return null;case"compositionend":return Yr&&T.locale!=="ko"?null:T.data;default:return null}}var Ty={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sp(b){var T=b&&b.nodeName&&b.nodeName.toLowerCase();return T==="input"?!!Ty[b.type]:T==="textarea"}function of(b,T,U,J){fa(J),T=Mp(T,"onChange"),0<T.length&&(U=new ma("onChange","change",null,U,J),b.push({event:U,listeners:T}))}var Il=null,Ia=null;function au(b){Wm(b,0)}function lf(b){var T=yl(b);if(Dt(T))return b}function Kd(b,T){if(b==="change")return T}var Yu=!1;if(i){var su;if(i){var Ap="oninput"in document;if(!Ap){var uv=document.createElement("div");uv.setAttribute("oninput","return;"),Ap=typeof uv.oninput=="function"}su=Ap}else su=!1;Yu=su&&(!document.documentMode||9<document.documentMode)}function Vm(){Il&&(Il.detachEvent("onpropertychange",dv),Ia=Il=null)}function dv(b){if(b.propertyName==="value"&&lf(Ia)){var T=[];of(T,Ia,b,ts(b)),Bs(au,T)}}function hv(b,T,U){b==="focusin"?(Vm(),Il=T,Ia=U,Il.attachEvent("onpropertychange",dv)):b==="focusout"&&Vm()}function Py(b){if(b==="selectionchange"||b==="keyup"||b==="keydown")return lf(Ia)}function Ny(b,T){if(b==="click")return lf(T)}function W_(b,T){if(b==="input"||b==="change")return lf(T)}function fv(b,T){return b===T&&(b!==0||1/b===1/T)||b!==b&&T!==T}var Js=typeof Object.is=="function"?Object.is:fv;function Tp(b,T){if(Js(b,T))return!0;if(typeof b!="object"||b===null||typeof T!="object"||T===null)return!1;var U=Object.keys(b),J=Object.keys(T);if(U.length!==J.length)return!1;for(J=0;J<U.length;J++){var de=U[J];if(!x.call(T,de)||!Js(b[de],T[de]))return!1}return!0}function jy(b){for(;b&&b.firstChild;)b=b.firstChild;return b}function Um(b,T){var U=jy(b);b=0;for(var J;U;){if(U.nodeType===3){if(J=b+U.textContent.length,b<=T&&J>=T)return{node:U,offset:T-b};b=J}e:{for(;U;){if(U.nextSibling){U=U.nextSibling;break e}U=U.parentNode}U=void 0}U=jy(U)}}function cf(b,T){return b&&T?b===T?!0:b&&b.nodeType===3?!1:T&&T.nodeType===3?cf(b,T.parentNode):"contains"in b?b.contains(T):b.compareDocumentPosition?!!(b.compareDocumentPosition(T)&16):!1:!1}function Cy(){for(var b=window,T=Cr();T instanceof b.HTMLIFrameElement;){try{var U=typeof T.contentWindow.location.href=="string"}catch{U=!1}if(U)b=T.contentWindow;else break;T=Cr(b.document)}return T}function Ko(b){var T=b&&b.nodeName&&b.nodeName.toLowerCase();return T&&(T==="input"&&(b.type==="text"||b.type==="search"||b.type==="tel"||b.type==="url"||b.type==="password")||T==="textarea"||b.contentEditable==="true")}function $m(b){var T=Cy(),U=b.focusedElem,J=b.selectionRange;if(T!==U&&U&&U.ownerDocument&&cf(U.ownerDocument.documentElement,U)){if(J!==null&&Ko(U)){if(T=J.start,b=J.end,b===void 0&&(b=T),"selectionStart"in U)U.selectionStart=T,U.selectionEnd=Math.min(b,U.value.length);else if(b=(T=U.ownerDocument||document)&&T.defaultView||window,b.getSelection){b=b.getSelection();var de=U.textContent.length,ge=Math.min(J.start,de);J=J.end===void 0?ge:Math.min(J.end,de),!b.extend&&ge>J&&(de=J,J=ge,ge=de),de=Um(U,ge);var Ue=Um(U,J);de&&Ue&&(b.rangeCount!==1||b.anchorNode!==de.node||b.anchorOffset!==de.offset||b.focusNode!==Ue.node||b.focusOffset!==Ue.offset)&&(T=T.createRange(),T.setStart(de.node,de.offset),b.removeAllRanges(),ge>J?(b.addRange(T),b.extend(Ue.node,Ue.offset)):(T.setEnd(Ue.node,Ue.offset),b.addRange(T)))}}for(T=[],b=U;b=b.parentNode;)b.nodeType===1&&T.push({element:b,left:b.scrollLeft,top:b.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<T.length;U++)b=T[U],b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}var Pp=i&&"documentMode"in document&&11>=document.documentMode,ou=null,Ec=null,Xu=null,Np=!1;function Ju(b,T,U){var J=U.window===U?U.document:U.nodeType===9?U:U.ownerDocument;Np||ou==null||ou!==Cr(J)||(J=ou,"selectionStart"in J&&Ko(J)?J={start:J.selectionStart,end:J.selectionEnd}:(J=(J.ownerDocument&&J.ownerDocument.defaultView||window).getSelection(),J={anchorNode:J.anchorNode,anchorOffset:J.anchorOffset,focusNode:J.focusNode,focusOffset:J.focusOffset}),Xu&&Tp(Xu,J)||(Xu=J,J=Mp(Ec,"onSelect"),0<J.length&&(T=new ma("onSelect","select",null,T,U),b.push({event:T,listeners:J}),T.target=ou)))}function lu(b,T){var U={};return U[b.toLowerCase()]=T.toLowerCase(),U["Webkit"+b]="webkit"+T,U["Moz"+b]="moz"+T,U}var Mc={animationend:lu("Animation","AnimationEnd"),animationiteration:lu("Animation","AnimationIteration"),animationstart:lu("Animation","AnimationStart"),transitionend:lu("Transition","TransitionEnd")},Zd={},Qu={};i&&(Qu=document.createElement("div").style,"AnimationEvent"in window||(delete Mc.animationend.animation,delete Mc.animationiteration.animation,delete Mc.animationstart.animation),"TransitionEvent"in window||delete Mc.transitionend.transition);function Oc(b){if(Zd[b])return Zd[b];if(!Mc[b])return b;var T=Mc[b],U;for(U in T)if(T.hasOwnProperty(U)&&U in Qu)return Zd[b]=T[U];return b}var Yd=Oc("animationend"),uf=Oc("animationiteration"),jp=Oc("animationstart"),df=Oc("transitionend"),Xd=new Map,ed="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tn(b,T){Xd.set(b,T),c(T,[b])}for(var qm=0;qm<ed.length;qm++){var td=ed[qm],pv=td.toLowerCase(),mv=td[0].toUpperCase()+td.slice(1);Tn(pv,"on"+mv)}Tn(Yd,"onAnimationEnd"),Tn(uf,"onAnimationIteration"),Tn(jp,"onAnimationStart"),Tn("dblclick","onDoubleClick"),Tn("focusin","onFocus"),Tn("focusout","onBlur"),Tn(df,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bi=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cp));function Gm(b,T,U){var J=b.type||"unknown-event";b.currentTarget=U,Ze(J,T,void 0,b),b.currentTarget=null}function Wm(b,T){T=(T&4)!==0;for(var U=0;U<b.length;U++){var J=b[U],de=J.event;J=J.listeners;e:{var ge=void 0;if(T)for(var Ue=J.length-1;0<=Ue;Ue--){var yt=J[Ue],Nt=yt.instance,Jt=yt.currentTarget;if(yt=yt.listener,Nt!==ge&&de.isPropagationStopped())break e;Gm(de,yt,Jt),ge=Nt}else for(Ue=0;Ue<J.length;Ue++){if(yt=J[Ue],Nt=yt.instance,Jt=yt.currentTarget,yt=yt.listener,Nt!==ge&&de.isPropagationStopped())break e;Gm(de,yt,Jt),ge=Nt}}}if(Tt)throw b=ve,Tt=!1,ve=null,b}function ca(b,T){var U=T[nd];U===void 0&&(U=T[nd]=new Set);var J=b+"__bubble";U.has(J)||(gv(T,b,2,!1),U.add(J))}function kp(b,T,U){var J=0;T&&(J|=4),gv(U,b,J,T)}var Ep="_reactListening"+Math.random().toString(36).slice(2);function hf(b){if(!b[Ep]){b[Ep]=!0,n.forEach(function(U){U!=="selectionchange"&&(Bi.has(U)||kp(U,!1,b),kp(U,!0,b))});var T=b.nodeType===9?b:b.ownerDocument;T===null||T[Ep]||(T[Ep]=!0,kp("selectionchange",!1,T))}}function gv(b,T,U,J){switch(yp(T)){case 1:var de=pa;break;case 4:de=_y;break;default:de=Xs}U=de.bind(null,T,U,b),de=void 0,!ks||T!=="touchstart"&&T!=="touchmove"&&T!=="wheel"||(de=!0),J?de!==void 0?b.addEventListener(T,U,{capture:!0,passive:de}):b.addEventListener(T,U,!0):de!==void 0?b.addEventListener(T,U,{passive:de}):b.addEventListener(T,U,!1)}function Jd(b,T,U,J,de){var ge=J;if((T&1)===0&&(T&2)===0&&J!==null)e:for(;;){if(J===null)return;var Ue=J.tag;if(Ue===3||Ue===4){var yt=J.stateNode.containerInfo;if(yt===de||yt.nodeType===8&&yt.parentNode===de)break;if(Ue===4)for(Ue=J.return;Ue!==null;){var Nt=Ue.tag;if((Nt===3||Nt===4)&&(Nt=Ue.stateNode.containerInfo,Nt===de||Nt.nodeType===8&&Nt.parentNode===de))return;Ue=Ue.return}for(;yt!==null;){if(Ue=id(yt),Ue===null)return;if(Nt=Ue.tag,Nt===5||Nt===6){J=ge=Ue;continue e}yt=yt.parentNode}}J=J.return}Bs(function(){var Jt=ge,Tr=ts(U),Mr=[];e:{var Pr=Xd.get(b);if(Pr!==void 0){var Qr=ma,cn=b;switch(b){case"keypress":if(rf(U)===0)break e;case"keydown":case"keyup":Qr=q_;break;case"focusin":cn="focus",Qr=vp;break;case"focusout":cn="blur",Qr=vp;break;case"beforeblur":case"afterblur":Qr=vp;break;case"click":if(U.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qr=Cc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qr=by;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qr=G_;break;case Yd:case uf:case jp:Qr=xp;break;case df:Qr=Wd;break;case"scroll":Qr=ic;break;case"wheel":Qr=Br;break;case"copy":case"cut":case"paste":Qr=V_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qr=lv}var dn=(T&4)!==0,ws=!dn&&b==="scroll",qt=dn?Pr!==null?Pr+"Capture":null:Pr;dn=[];for(var Ot=Jt,Kt;Ot!==null;){Kt=Ot;var Ir=Kt.stateNode;if(Kt.tag===5&&Ir!==null&&(Kt=Ir,qt!==null&&(Ir=$i(Ot,qt),Ir!=null&&dn.push(cu(Ot,Ir,Kt)))),ws)break;Ot=Ot.return}0<dn.length&&(Pr=new Qr(Pr,cn,null,U,Tr),Mr.push({event:Pr,listeners:dn}))}}if((T&7)===0){e:{if(Pr=b==="mouseover"||b==="pointerover",Qr=b==="mouseout"||b==="pointerout",Pr&&U!==sn&&(cn=U.relatedTarget||U.fromElement)&&(id(cn)||cn[Ll]))break e;if((Qr||Pr)&&(Pr=Tr.window===Tr?Tr:(Pr=Tr.ownerDocument)?Pr.defaultView||Pr.parentWindow:window,Qr?(cn=U.relatedTarget||U.toElement,Qr=Jt,cn=cn?id(cn):null,cn!==null&&(ws=Je(cn),cn!==ws||cn.tag!==5&&cn.tag!==6)&&(cn=null)):(Qr=null,cn=Jt),Qr!==cn)){if(dn=Cc,Ir="onMouseLeave",qt="onMouseEnter",Ot="mouse",(b==="pointerout"||b==="pointerover")&&(dn=lv,Ir="onPointerLeave",qt="onPointerEnter",Ot="pointer"),ws=Qr==null?Pr:yl(Qr),Kt=cn==null?Pr:yl(cn),Pr=new dn(Ir,Ot+"leave",Qr,U,Tr),Pr.target=ws,Pr.relatedTarget=Kt,Ir=null,id(Tr)===Jt&&(dn=new dn(qt,Ot+"enter",cn,U,Tr),dn.target=Kt,dn.relatedTarget=ws,Ir=dn),ws=Ir,Qr&&cn)t:{for(dn=Qr,qt=cn,Ot=0,Kt=dn;Kt;Kt=Os(Kt))Ot++;for(Kt=0,Ir=qt;Ir;Ir=Os(Ir))Kt++;for(;0<Ot-Kt;)dn=Os(dn),Ot--;for(;0<Kt-Ot;)qt=Os(qt),Kt--;for(;Ot--;){if(dn===qt||qt!==null&&dn===qt.alternate)break t;dn=Os(dn),qt=Os(qt)}dn=null}else dn=null;Qr!==null&&Hm(Mr,Pr,Qr,dn,!1),cn!==null&&ws!==null&&Hm(Mr,ws,cn,dn,!0)}}e:{if(Pr=Jt?yl(Jt):window,Qr=Pr.nodeName&&Pr.nodeName.toLowerCase(),Qr==="select"||Qr==="input"&&Pr.type==="file")var nn=Kd;else if(Sp(Pr))if(Yu)nn=W_;else{nn=Py;var Fn=hv}else(Qr=Pr.nodeName)&&Qr.toLowerCase()==="input"&&(Pr.type==="checkbox"||Pr.type==="radio")&&(nn=Ny);if(nn&&(nn=nn(b,Jt))){of(Mr,nn,U,Tr);break e}Fn&&Fn(b,Pr,Jt),b==="focusout"&&(Fn=Pr._wrapperState)&&Fn.controlled&&Pr.type==="number"&&xt(Pr,"number",Pr.value)}switch(Fn=Jt?yl(Jt):window,b){case"focusin":(Sp(Fn)||Fn.contentEditable==="true")&&(ou=Fn,Ec=Jt,Xu=null);break;case"focusout":Xu=Ec=ou=null;break;case"mousedown":Np=!0;break;case"contextmenu":case"mouseup":case"dragend":Np=!1,Ju(Mr,U,Tr);break;case"selectionchange":if(Pp)break;case"keydown":case"keyup":Ju(Mr,U,Tr)}var Vn;if(Kr)e:{switch(b){case"compositionstart":var li="onCompositionStart";break e;case"compositionend":li="onCompositionEnd";break e;case"compositionupdate":li="onCompositionUpdate";break e}li=void 0}else vs?Bm(b,U)&&(li="onCompositionEnd"):b==="keydown"&&U.keyCode===229&&(li="onCompositionStart");li&&(Yr&&U.locale!=="ko"&&(vs||li!=="onCompositionStart"?li==="onCompositionEnd"&&vs&&(Vn=Ms()):(Ol=Tr,Es="value"in Ol?Ol.value:Ol.textContent,vs=!0)),Fn=Mp(Jt,li),0<Fn.length&&(li=new af(li,b,null,U,Tr),Mr.push({event:li,listeners:Fn}),Vn?li.data=Vn:(Vn=wp(U),Vn!==null&&(li.data=Vn)))),(Vn=Fm?Vs(b,U):hr(b,U))&&(Jt=Mp(Jt,"onBeforeInput"),0<Jt.length&&(Tr=new af("onBeforeInput","beforeinput",null,U,Tr),Mr.push({event:Tr,listeners:Jt}),Tr.data=Vn))}Wm(Mr,T)})}function cu(b,T,U){return{instance:b,listener:T,currentTarget:U}}function Mp(b,T){for(var U=T+"Capture",J=[];b!==null;){var de=b,ge=de.stateNode;de.tag===5&&ge!==null&&(de=ge,ge=$i(b,U),ge!=null&&J.unshift(cu(b,ge,de)),ge=$i(b,T),ge!=null&&J.push(cu(b,ge,de))),b=b.return}return J}function Os(b){if(b===null)return null;do b=b.return;while(b&&b.tag!==5);return b||null}function Hm(b,T,U,J,de){for(var ge=T._reactName,Ue=[];U!==null&&U!==J;){var yt=U,Nt=yt.alternate,Jt=yt.stateNode;if(Nt!==null&&Nt===J)break;yt.tag===5&&Jt!==null&&(yt=Jt,de?(Nt=$i(U,ge),Nt!=null&&Ue.unshift(cu(U,Nt,yt))):de||(Nt=$i(U,ge),Nt!=null&&Ue.push(cu(U,Nt,yt)))),U=U.return}Ue.length!==0&&b.push({event:T,listeners:Ue})}var Km=/\r\n?/g,Zm=/\u0000|\uFFFD/g;function Ym(b){return(typeof b=="string"?b:""+b).replace(Km,`
`).replace(Zm,"")}function ff(b,T,U){if(T=Ym(T),Ym(b)!==T&&U)throw Error(r(425))}function Qd(){}var Op=null,Rp=null;function pf(b,T){return b==="textarea"||b==="noscript"||typeof T.children=="string"||typeof T.children=="number"||typeof T.dangerouslySetInnerHTML=="object"&&T.dangerouslySetInnerHTML!==null&&T.dangerouslySetInnerHTML.__html!=null}var Xm=typeof setTimeout=="function"?setTimeout:void 0,yv=typeof clearTimeout=="function"?clearTimeout:void 0,eh=typeof Promise=="function"?Promise:void 0,H_=typeof queueMicrotask=="function"?queueMicrotask:typeof eh<"u"?function(b){return eh.resolve(null).then(b).catch(K_)}:Xm;function K_(b){setTimeout(function(){throw b})}function ky(b,T){var U=T,J=0;do{var de=U.nextSibling;if(b.removeChild(U),de&&de.nodeType===8)if(U=de.data,U==="/$"){if(J===0){b.removeChild(de),Ho(T);return}J--}else U!=="$"&&U!=="$?"&&U!=="$!"||J++;U=de}while(U);Ho(T)}function rd(b){for(;b!=null;b=b.nextSibling){var T=b.nodeType;if(T===1||T===3)break;if(T===8){if(T=b.data,T==="$"||T==="$!"||T==="$?")break;if(T==="/$")return null}}return b}function vv(b){b=b.previousSibling;for(var T=0;b;){if(b.nodeType===8){var U=b.data;if(U==="$"||U==="$!"||U==="$?"){if(T===0)return b;T--}else U==="/$"&&T++}b=b.previousSibling}return null}var mf=Math.random().toString(36).slice(2),Dl="__reactFiber$"+mf,th="__reactProps$"+mf,Ll="__reactContainer$"+mf,nd="__reactEvents$"+mf,Ey="__reactListeners$"+mf,xv="__reactHandles$"+mf;function id(b){var T=b[Dl];if(T)return T;for(var U=b.parentNode;U;){if(T=U[Ll]||U[Dl]){if(U=T.alternate,T.child!==null||U!==null&&U.child!==null)for(b=vv(b);b!==null;){if(U=b[Dl])return U;b=vv(b)}return T}b=U,U=b.parentNode}return null}function rh(b){return b=b[Dl]||b[Ll],!b||b.tag!==5&&b.tag!==6&&b.tag!==13&&b.tag!==3?null:b}function yl(b){if(b.tag===5||b.tag===6)return b.stateNode;throw Error(r(33))}function gf(b){return b[th]||null}var jo=[],uu=-1;function zl(b){return{current:b}}function ga(b){0>uu||(b.current=jo[uu],jo[uu]=null,uu--)}function Qi(b,T){uu++,jo[uu]=b.current,b.current=T}var Fl={},Us=zl(Fl),Zo=zl(!1),du=Fl;function sc(b,T){var U=b.type.contextTypes;if(!U)return Fl;var J=b.stateNode;if(J&&J.__reactInternalMemoizedUnmaskedChildContext===T)return J.__reactInternalMemoizedMaskedChildContext;var de={},ge;for(ge in U)de[ge]=T[ge];return J&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=T,b.__reactInternalMemoizedMaskedChildContext=de),de}function Yo(b){return b=b.childContextTypes,b!=null}function Jm(){ga(Zo),ga(Us)}function My(b,T,U){if(Us.current!==Fl)throw Error(r(168));Qi(Us,T),Qi(Zo,U)}function Oy(b,T,U){var J=b.stateNode;if(T=T.childContextTypes,typeof J.getChildContext!="function")return U;J=J.getChildContext();for(var de in J)if(!(de in T))throw Error(r(108,rr(b)||"Unknown",de));return mt({},U,J)}function nh(b){return b=(b=b.stateNode)&&b.__reactInternalMemoizedMergedChildContext||Fl,du=Us.current,Qi(Us,b),Qi(Zo,Zo.current),!0}function ih(b,T,U){var J=b.stateNode;if(!J)throw Error(r(169));U?(b=Oy(b,T,du),J.__reactInternalMemoizedMergedChildContext=b,ga(Zo),ga(Us),Qi(Us,b)):ga(Zo),Qi(Zo,U)}var Xo=null,ah=!1,sh=!1;function Ry(b){Xo===null?Xo=[b]:Xo.push(b)}function Ip(b){ah=!0,Ry(b)}function Bl(){if(!sh&&Xo!==null){sh=!0;var b=0,T=_i;try{var U=Xo;for(_i=1;b<U.length;b++){var J=U[b];do J=J(!0);while(J!==null)}Xo=null,ah=!1}catch(de){throw Xo!==null&&(Xo=Xo.slice(b+1)),Pt($r,Bl),de}finally{_i=T,sh=!1}}return null}var ad=[],oh=0,Qm=null,Rc=0,Co=[],gr=0,hu=null,oc=1,fo="";function vl(b,T){ad[oh++]=Rc,ad[oh++]=Qm,Qm=b,Rc=T}function Er(b,T,U){Co[gr++]=oc,Co[gr++]=fo,Co[gr++]=hu,hu=b;var J=oc;b=fo;var de=32-gs(J)-1;J&=~(1<<de),U+=1;var ge=32-gs(T)+de;if(30<ge){var Ue=de-de%5;ge=(J&(1<<Ue)-1).toString(32),J>>=Ue,de-=Ue,oc=1<<32-gs(T)+de|U<<de|J,fo=ge+b}else oc=1<<ge|U<<de|J,fo=b}function Dp(b){b.return!==null&&(vl(b,1),Er(b,1,0))}function Iy(b){for(;b===Qm;)Qm=ad[--oh],ad[oh]=null,Rc=ad[--oh],ad[oh]=null;for(;b===hu;)hu=Co[--gr],Co[gr]=null,fo=Co[--gr],Co[gr]=null,oc=Co[--gr],Co[gr]=null}var xl=null,po=null,ya=!1,_l=null;function Dy(b,T){var U=Uc(5,null,null,0);U.elementType="DELETED",U.stateNode=T,U.return=b,T=b.deletions,T===null?(b.deletions=[U],b.flags|=16):T.push(U)}function eg(b,T){switch(b.tag){case 5:var U=b.type;return T=T.nodeType!==1||U.toLowerCase()!==T.nodeName.toLowerCase()?null:T,T!==null?(b.stateNode=T,xl=b,po=rd(T.firstChild),!0):!1;case 6:return T=b.pendingProps===""||T.nodeType!==3?null:T,T!==null?(b.stateNode=T,xl=b,po=null,!0):!1;case 13:return T=T.nodeType!==8?null:T,T!==null?(U=hu!==null?{id:oc,overflow:fo}:null,b.memoizedState={dehydrated:T,treeContext:U,retryLane:1073741824},U=Uc(18,null,null,0),U.stateNode=T,U.return=b,b.child=U,xl=b,po=null,!0):!1;default:return!1}}function lh(b){return(b.mode&1)!==0&&(b.flags&128)===0}function yf(b){if(ya){var T=po;if(T){var U=T;if(!eg(b,T)){if(lh(b))throw Error(r(418));T=rd(U.nextSibling);var J=xl;T&&eg(b,T)?Dy(J,U):(b.flags=b.flags&-4097|2,ya=!1,xl=b)}}else{if(lh(b))throw Error(r(418));b.flags=b.flags&-4097|2,ya=!1,xl=b}}}function tg(b){for(b=b.return;b!==null&&b.tag!==5&&b.tag!==3&&b.tag!==13;)b=b.return;xl=b}function bl(b){if(b!==xl)return!1;if(!ya)return tg(b),ya=!0,!1;var T;if((T=b.tag!==3)&&!(T=b.tag!==5)&&(T=b.type,T=T!=="head"&&T!=="body"&&!pf(b.type,b.memoizedProps)),T&&(T=po)){if(lh(b))throw ko(),Error(r(418));for(;T;)Dy(b,T),T=rd(T.nextSibling)}if(tg(b),b.tag===13){if(b=b.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));e:{for(b=b.nextSibling,T=0;b;){if(b.nodeType===8){var U=b.data;if(U==="/$"){if(T===0){po=rd(b.nextSibling);break e}T--}else U!=="$"&&U!=="$!"&&U!=="$?"||T++}b=b.nextSibling}po=null}}else po=xl?rd(b.stateNode.nextSibling):null;return!0}function ko(){for(var b=po;b;)b=rd(b.nextSibling)}function wl(){po=xl=null,ya=!1}function Lp(b){_l===null?_l=[b]:_l.push(b)}var Ly=ae.ReactCurrentBatchConfig;function Ic(b,T,U){if(b=U.ref,b!==null&&typeof b!="function"&&typeof b!="object"){if(U._owner){if(U=U._owner,U){if(U.tag!==1)throw Error(r(309));var J=U.stateNode}if(!J)throw Error(r(147,b));var de=J,ge=""+b;return T!==null&&T.ref!==null&&typeof T.ref=="function"&&T.ref._stringRef===ge?T.ref:(T=function(Ue){var yt=de.refs;Ue===null?delete yt[ge]:yt[ge]=Ue},T._stringRef=ge,T)}if(typeof b!="string")throw Error(r(284));if(!U._owner)throw Error(r(290,b))}return b}function ch(b,T){throw b=Object.prototype.toString.call(T),Error(r(31,b==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":b))}function vf(b){var T=b._init;return T(b._payload)}function Jo(b){function T(qt,Ot){if(b){var Kt=qt.deletions;Kt===null?(qt.deletions=[Ot],qt.flags|=16):Kt.push(Ot)}}function U(qt,Ot){if(!b)return null;for(;Ot!==null;)T(qt,Ot),Ot=Ot.sibling;return null}function J(qt,Ot){for(qt=new Map;Ot!==null;)Ot.key!==null?qt.set(Ot.key,Ot):qt.set(Ot.index,Ot),Ot=Ot.sibling;return qt}function de(qt,Ot){return qt=Ah(qt,Ot),qt.index=0,qt.sibling=null,qt}function ge(qt,Ot,Kt){return qt.index=Kt,b?(Kt=qt.alternate,Kt!==null?(Kt=Kt.index,Kt<Ot?(qt.flags|=2,Ot):Kt):(qt.flags|=2,Ot)):(qt.flags|=1048576,Ot)}function Ue(qt){return b&&qt.alternate===null&&(qt.flags|=2),qt}function yt(qt,Ot,Kt,Ir){return Ot===null||Ot.tag!==6?(Ot=Tv(Kt,qt.mode,Ir),Ot.return=qt,Ot):(Ot=de(Ot,Kt),Ot.return=qt,Ot)}function Nt(qt,Ot,Kt,Ir){var nn=Kt.type;return nn===ce?Tr(qt,Ot,Kt.props.children,Ir,Kt.key):Ot!==null&&(Ot.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===Te&&vf(nn)===Ot.type)?(Ir=de(Ot,Kt.props),Ir.ref=Ic(qt,Ot,Kt),Ir.return=qt,Ir):(Ir=Yy(Kt.type,Kt.key,Kt.props,null,qt.mode,Ir),Ir.ref=Ic(qt,Ot,Kt),Ir.return=qt,Ir)}function Jt(qt,Ot,Kt,Ir){return Ot===null||Ot.tag!==4||Ot.stateNode.containerInfo!==Kt.containerInfo||Ot.stateNode.implementation!==Kt.implementation?(Ot=Pv(Kt,qt.mode,Ir),Ot.return=qt,Ot):(Ot=de(Ot,Kt.children||[]),Ot.return=qt,Ot)}function Tr(qt,Ot,Kt,Ir,nn){return Ot===null||Ot.tag!==7?(Ot=Rf(Kt,qt.mode,Ir,nn),Ot.return=qt,Ot):(Ot=de(Ot,Kt),Ot.return=qt,Ot)}function Mr(qt,Ot,Kt){if(typeof Ot=="string"&&Ot!==""||typeof Ot=="number")return Ot=Tv(""+Ot,qt.mode,Kt),Ot.return=qt,Ot;if(typeof Ot=="object"&&Ot!==null){switch(Ot.$$typeof){case ee:return Kt=Yy(Ot.type,Ot.key,Ot.props,null,qt.mode,Kt),Kt.ref=Ic(qt,null,Ot),Kt.return=qt,Kt;case se:return Ot=Pv(Ot,qt.mode,Kt),Ot.return=qt,Ot;case Te:var Ir=Ot._init;return Mr(qt,Ir(Ot._payload),Kt)}if(Mt(Ot)||He(Ot))return Ot=Rf(Ot,qt.mode,Kt,null),Ot.return=qt,Ot;ch(qt,Ot)}return null}function Pr(qt,Ot,Kt,Ir){var nn=Ot!==null?Ot.key:null;if(typeof Kt=="string"&&Kt!==""||typeof Kt=="number")return nn!==null?null:yt(qt,Ot,""+Kt,Ir);if(typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case ee:return Kt.key===nn?Nt(qt,Ot,Kt,Ir):null;case se:return Kt.key===nn?Jt(qt,Ot,Kt,Ir):null;case Te:return nn=Kt._init,Pr(qt,Ot,nn(Kt._payload),Ir)}if(Mt(Kt)||He(Kt))return nn!==null?null:Tr(qt,Ot,Kt,Ir,null);ch(qt,Kt)}return null}function Qr(qt,Ot,Kt,Ir,nn){if(typeof Ir=="string"&&Ir!==""||typeof Ir=="number")return qt=qt.get(Kt)||null,yt(Ot,qt,""+Ir,nn);if(typeof Ir=="object"&&Ir!==null){switch(Ir.$$typeof){case ee:return qt=qt.get(Ir.key===null?Kt:Ir.key)||null,Nt(Ot,qt,Ir,nn);case se:return qt=qt.get(Ir.key===null?Kt:Ir.key)||null,Jt(Ot,qt,Ir,nn);case Te:var Fn=Ir._init;return Qr(qt,Ot,Kt,Fn(Ir._payload),nn)}if(Mt(Ir)||He(Ir))return qt=qt.get(Kt)||null,Tr(Ot,qt,Ir,nn,null);ch(Ot,Ir)}return null}function cn(qt,Ot,Kt,Ir){for(var nn=null,Fn=null,Vn=Ot,li=Ot=0,vo=null;Vn!==null&&li<Kt.length;li++){Vn.index>li?(vo=Vn,Vn=null):vo=Vn.sibling;var Zi=Pr(qt,Vn,Kt[li],Ir);if(Zi===null){Vn===null&&(Vn=vo);break}b&&Vn&&Zi.alternate===null&&T(qt,Vn),Ot=ge(Zi,Ot,li),Fn===null?nn=Zi:Fn.sibling=Zi,Fn=Zi,Vn=vo}if(li===Kt.length)return U(qt,Vn),ya&&vl(qt,li),nn;if(Vn===null){for(;li<Kt.length;li++)Vn=Mr(qt,Kt[li],Ir),Vn!==null&&(Ot=ge(Vn,Ot,li),Fn===null?nn=Vn:Fn.sibling=Vn,Fn=Vn);return ya&&vl(qt,li),nn}for(Vn=J(qt,Vn);li<Kt.length;li++)vo=Qr(Vn,qt,li,Kt[li],Ir),vo!==null&&(b&&vo.alternate!==null&&Vn.delete(vo.key===null?li:vo.key),Ot=ge(vo,Ot,li),Fn===null?nn=vo:Fn.sibling=vo,Fn=vo);return b&&Vn.forEach(function(If){return T(qt,If)}),ya&&vl(qt,li),nn}function dn(qt,Ot,Kt,Ir){var nn=He(Kt);if(typeof nn!="function")throw Error(r(150));if(Kt=nn.call(Kt),Kt==null)throw Error(r(151));for(var Fn=nn=null,Vn=Ot,li=Ot=0,vo=null,Zi=Kt.next();Vn!==null&&!Zi.done;li++,Zi=Kt.next()){Vn.index>li?(vo=Vn,Vn=null):vo=Vn.sibling;var If=Pr(qt,Vn,Zi.value,Ir);if(If===null){Vn===null&&(Vn=vo);break}b&&Vn&&If.alternate===null&&T(qt,Vn),Ot=ge(If,Ot,li),Fn===null?nn=If:Fn.sibling=If,Fn=If,Vn=vo}if(Zi.done)return U(qt,Vn),ya&&vl(qt,li),nn;if(Vn===null){for(;!Zi.done;li++,Zi=Kt.next())Zi=Mr(qt,Zi.value,Ir),Zi!==null&&(Ot=ge(Zi,Ot,li),Fn===null?nn=Zi:Fn.sibling=Zi,Fn=Zi);return ya&&vl(qt,li),nn}for(Vn=J(qt,Vn);!Zi.done;li++,Zi=Kt.next())Zi=Qr(Vn,qt,li,Zi.value,Ir),Zi!==null&&(b&&Zi.alternate!==null&&Vn.delete(Zi.key===null?li:Zi.key),Ot=ge(Zi,Ot,li),Fn===null?nn=Zi:Fn.sibling=Zi,Fn=Zi);return b&&Vn.forEach(function(LN){return T(qt,LN)}),ya&&vl(qt,li),nn}function ws(qt,Ot,Kt,Ir){if(typeof Kt=="object"&&Kt!==null&&Kt.type===ce&&Kt.key===null&&(Kt=Kt.props.children),typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case ee:e:{for(var nn=Kt.key,Fn=Ot;Fn!==null;){if(Fn.key===nn){if(nn=Kt.type,nn===ce){if(Fn.tag===7){U(qt,Fn.sibling),Ot=de(Fn,Kt.props.children),Ot.return=qt,qt=Ot;break e}}else if(Fn.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===Te&&vf(nn)===Fn.type){U(qt,Fn.sibling),Ot=de(Fn,Kt.props),Ot.ref=Ic(qt,Fn,Kt),Ot.return=qt,qt=Ot;break e}U(qt,Fn);break}else T(qt,Fn);Fn=Fn.sibling}Kt.type===ce?(Ot=Rf(Kt.props.children,qt.mode,Ir,Kt.key),Ot.return=qt,qt=Ot):(Ir=Yy(Kt.type,Kt.key,Kt.props,null,qt.mode,Ir),Ir.ref=Ic(qt,Ot,Kt),Ir.return=qt,qt=Ir)}return Ue(qt);case se:e:{for(Fn=Kt.key;Ot!==null;){if(Ot.key===Fn)if(Ot.tag===4&&Ot.stateNode.containerInfo===Kt.containerInfo&&Ot.stateNode.implementation===Kt.implementation){U(qt,Ot.sibling),Ot=de(Ot,Kt.children||[]),Ot.return=qt,qt=Ot;break e}else{U(qt,Ot);break}else T(qt,Ot);Ot=Ot.sibling}Ot=Pv(Kt,qt.mode,Ir),Ot.return=qt,qt=Ot}return Ue(qt);case Te:return Fn=Kt._init,ws(qt,Ot,Fn(Kt._payload),Ir)}if(Mt(Kt))return cn(qt,Ot,Kt,Ir);if(He(Kt))return dn(qt,Ot,Kt,Ir);ch(qt,Kt)}return typeof Kt=="string"&&Kt!==""||typeof Kt=="number"?(Kt=""+Kt,Ot!==null&&Ot.tag===6?(U(qt,Ot.sibling),Ot=de(Ot,Kt),Ot.return=qt,qt=Ot):(U(qt,Ot),Ot=Tv(Kt,qt.mode,Ir),Ot.return=qt,qt=Ot),Ue(qt)):U(qt,Ot)}return ws}var bi=Jo(!0),zp=Jo(!1),sd=zl(null),uh=null,od=null,dh=null;function ld(){dh=od=uh=null}function cd(b){var T=sd.current;ga(sd),b._currentValue=T}function ud(b,T,U){for(;b!==null;){var J=b.alternate;if((b.childLanes&T)!==T?(b.childLanes|=T,J!==null&&(J.childLanes|=T)):J!==null&&(J.childLanes&T)!==T&&(J.childLanes|=T),b===U)break;b=b.return}}function er(b,T){uh=b,dh=od=null,b=b.dependencies,b!==null&&b.firstContext!==null&&((b.lanes&T)!==0&&(mo=!0),b.firstContext=null)}function fr(b){var T=b._currentValue;if(dh!==b)if(b={context:b,memoizedValue:T,next:null},od===null){if(uh===null)throw Error(r(308));od=b,uh.dependencies={lanes:0,firstContext:b}}else od=od.next=b;return T}var Vl=null;function qi(b){Vl===null?Vl=[b]:Vl.push(b)}function _t(b,T,U,J){var de=T.interleaved;return de===null?(U.next=U,qi(T)):(U.next=de.next,de.next=U),T.interleaved=U,Dc(b,J)}function Dc(b,T){b.lanes|=T;var U=b.alternate;for(U!==null&&(U.lanes|=T),U=b,b=b.return;b!==null;)b.childLanes|=T,U=b.alternate,U!==null&&(U.childLanes|=T),U=b,b=b.return;return U.tag===3?U.stateNode:null}var lc=!1;function Fp(b){b.updateQueue={baseState:b.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zy(b,T){b=b.updateQueue,T.updateQueue===b&&(T.updateQueue={baseState:b.baseState,firstBaseUpdate:b.firstBaseUpdate,lastBaseUpdate:b.lastBaseUpdate,shared:b.shared,effects:b.effects})}function Lc(b,T){return{eventTime:b,lane:T,tag:0,payload:null,callback:null,next:null}}function fu(b,T,U){var J=b.updateQueue;if(J===null)return null;if(J=J.shared,(Ye&2)!==0){var de=J.pending;return de===null?T.next=T:(T.next=de.next,de.next=T),J.pending=T,Dc(b,U)}return de=J.interleaved,de===null?(T.next=T,qi(J)):(T.next=de.next,de.next=T),J.interleaved=T,Dc(b,U)}function pu(b,T,U){if(T=T.updateQueue,T!==null&&(T=T.shared,(U&4194240)!==0)){var J=T.lanes;J&=b.pendingLanes,U|=J,T.lanes=U,ml(b,U)}}function _v(b,T){var U=b.updateQueue,J=b.alternate;if(J!==null&&(J=J.updateQueue,U===J)){var de=null,ge=null;if(U=U.firstBaseUpdate,U!==null){do{var Ue={eventTime:U.eventTime,lane:U.lane,tag:U.tag,payload:U.payload,callback:U.callback,next:null};ge===null?de=ge=Ue:ge=ge.next=Ue,U=U.next}while(U!==null);ge===null?de=ge=T:ge=ge.next=T}else de=ge=T;U={baseState:J.baseState,firstBaseUpdate:de,lastBaseUpdate:ge,shared:J.shared,effects:J.effects},b.updateQueue=U;return}b=U.lastBaseUpdate,b===null?U.firstBaseUpdate=T:b.next=T,U.lastBaseUpdate=T}function rg(b,T,U,J){var de=b.updateQueue;lc=!1;var ge=de.firstBaseUpdate,Ue=de.lastBaseUpdate,yt=de.shared.pending;if(yt!==null){de.shared.pending=null;var Nt=yt,Jt=Nt.next;Nt.next=null,Ue===null?ge=Jt:Ue.next=Jt,Ue=Nt;var Tr=b.alternate;Tr!==null&&(Tr=Tr.updateQueue,yt=Tr.lastBaseUpdate,yt!==Ue&&(yt===null?Tr.firstBaseUpdate=Jt:yt.next=Jt,Tr.lastBaseUpdate=Nt))}if(ge!==null){var Mr=de.baseState;Ue=0,Tr=Jt=Nt=null,yt=ge;do{var Pr=yt.lane,Qr=yt.eventTime;if((J&Pr)===Pr){Tr!==null&&(Tr=Tr.next={eventTime:Qr,lane:0,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null});e:{var cn=b,dn=yt;switch(Pr=T,Qr=U,dn.tag){case 1:if(cn=dn.payload,typeof cn=="function"){Mr=cn.call(Qr,Mr,Pr);break e}Mr=cn;break e;case 3:cn.flags=cn.flags&-65537|128;case 0:if(cn=dn.payload,Pr=typeof cn=="function"?cn.call(Qr,Mr,Pr):cn,Pr==null)break e;Mr=mt({},Mr,Pr);break e;case 2:lc=!0}}yt.callback!==null&&yt.lane!==0&&(b.flags|=64,Pr=de.effects,Pr===null?de.effects=[yt]:Pr.push(yt))}else Qr={eventTime:Qr,lane:Pr,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null},Tr===null?(Jt=Tr=Qr,Nt=Mr):Tr=Tr.next=Qr,Ue|=Pr;if(yt=yt.next,yt===null){if(yt=de.shared.pending,yt===null)break;Pr=yt,yt=Pr.next,Pr.next=null,de.lastBaseUpdate=Pr,de.shared.pending=null}}while(!0);if(Tr===null&&(Nt=Mr),de.baseState=Nt,de.firstBaseUpdate=Jt,de.lastBaseUpdate=Tr,T=de.shared.interleaved,T!==null){de=T;do Ue|=de.lane,de=de.next;while(de!==T)}else ge===null&&(de.shared.lanes=0);Gt|=Ue,b.lanes=Ue,b.memoizedState=Mr}}function Fy(b,T,U){if(b=T.effects,T.effects=null,b!==null)for(T=0;T<b.length;T++){var J=b[T],de=J.callback;if(de!==null){if(J.callback=null,J=U,typeof de!="function")throw Error(r(191,de));de.call(J)}}}var dd={},Qs=zl(dd),hh=zl(dd),fh=zl(dd);function Sl(b){if(b===dd)throw Error(r(174));return b}function xf(b,T){switch(Qi(fh,T),Qi(hh,b),Qi(Qs,dd),b=T.nodeType,b){case 9:case 11:T=(T=T.documentElement)?T.namespaceURI:gi(null,"");break;default:b=b===8?T.parentNode:T,T=b.namespaceURI||null,b=b.tagName,T=gi(T,b)}ga(Qs),Qi(Qs,T)}function Eo(){ga(Qs),ga(hh),ga(fh)}function zc(b){Sl(fh.current);var T=Sl(Qs.current),U=gi(T,b.type);T!==U&&(Qi(hh,b),Qi(Qs,U))}function ng(b){hh.current===b&&(ga(Qs),ga(hh))}var pi=zl(0);function ig(b){for(var T=b;T!==null;){if(T.tag===13){var U=T.memoizedState;if(U!==null&&(U=U.dehydrated,U===null||U.data==="$?"||U.data==="$!"))return T}else if(T.tag===19&&T.memoizedProps.revealOrder!==void 0){if((T.flags&128)!==0)return T}else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===b)break;for(;T.sibling===null;){if(T.return===null||T.return===b)return null;T=T.return}T.sibling.return=T.return,T=T.sibling}return null}var ph=[];function Ei(){for(var b=0;b<ph.length;b++)ph[b]._workInProgressVersionPrimary=null;ph.length=0}var ei=ae.ReactCurrentDispatcher,ag=ae.ReactCurrentBatchConfig,Mo=0,ia=null,ua=null,ns=null,hd=!1,Qo=!1,is=0,sg=0;function xs(){throw Error(r(321))}function Bp(b,T){if(T===null)return!1;for(var U=0;U<T.length&&U<b.length;U++)if(!Js(b[U],T[U]))return!1;return!0}function Vp(b,T,U,J,de,ge){if(Mo=ge,ia=T,T.memoizedState=null,T.updateQueue=null,T.lanes=0,ei.current=b===null||b.memoizedState===null?Z_:va,b=U(J,de),Qo){ge=0;do{if(Qo=!1,is=0,25<=ge)throw Error(r(301));ge+=1,ns=ua=null,T.updateQueue=null,ei.current=fg,b=U(J,de)}while(Qo)}if(ei.current=hg,T=ua!==null&&ua.next!==null,Mo=0,ns=ua=ia=null,hd=!1,T)throw Error(r(300));return b}function mu(){var b=is!==0;return is=0,b}function Ul(){var b={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ns===null?ia.memoizedState=ns=b:ns=ns.next=b,ns}function Rs(){if(ua===null){var b=ia.alternate;b=b!==null?b.memoizedState:null}else b=ua.next;var T=ns===null?ia.memoizedState:ns.next;if(T!==null)ns=T,ua=b;else{if(b===null)throw Error(r(310));ua=b,b={memoizedState:ua.memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},ns===null?ia.memoizedState=ns=b:ns=ns.next=b}return ns}function mh(b,T){return typeof T=="function"?T(b):T}function _f(b){var T=Rs(),U=T.queue;if(U===null)throw Error(r(311));U.lastRenderedReducer=b;var J=ua,de=J.baseQueue,ge=U.pending;if(ge!==null){if(de!==null){var Ue=de.next;de.next=ge.next,ge.next=Ue}J.baseQueue=de=ge,U.pending=null}if(de!==null){ge=de.next,J=J.baseState;var yt=Ue=null,Nt=null,Jt=ge;do{var Tr=Jt.lane;if((Mo&Tr)===Tr)Nt!==null&&(Nt=Nt.next={lane:0,action:Jt.action,hasEagerState:Jt.hasEagerState,eagerState:Jt.eagerState,next:null}),J=Jt.hasEagerState?Jt.eagerState:b(J,Jt.action);else{var Mr={lane:Tr,action:Jt.action,hasEagerState:Jt.hasEagerState,eagerState:Jt.eagerState,next:null};Nt===null?(yt=Nt=Mr,Ue=J):Nt=Nt.next=Mr,ia.lanes|=Tr,Gt|=Tr}Jt=Jt.next}while(Jt!==null&&Jt!==ge);Nt===null?Ue=J:Nt.next=yt,Js(J,T.memoizedState)||(mo=!0),T.memoizedState=J,T.baseState=Ue,T.baseQueue=Nt,U.lastRenderedState=J}if(b=U.interleaved,b!==null){de=b;do ge=de.lane,ia.lanes|=ge,Gt|=ge,de=de.next;while(de!==b)}else de===null&&(U.lanes=0);return[T.memoizedState,U.dispatch]}function Up(b){var T=Rs(),U=T.queue;if(U===null)throw Error(r(311));U.lastRenderedReducer=b;var J=U.dispatch,de=U.pending,ge=T.memoizedState;if(de!==null){U.pending=null;var Ue=de=de.next;do ge=b(ge,Ue.action),Ue=Ue.next;while(Ue!==de);Js(ge,T.memoizedState)||(mo=!0),T.memoizedState=ge,T.baseQueue===null&&(T.baseState=ge),U.lastRenderedState=ge}return[ge,J]}function og(){}function _s(b,T){var U=ia,J=Rs(),de=T(),ge=!Js(J.memoizedState,de);if(ge&&(J.memoizedState=de,mo=!0),J=J.queue,yh(bf.bind(null,U,J,b),[b]),J.getSnapshot!==T||ge||ns!==null&&ns.memoizedState.tag&1){if(U.flags|=2048,fd(9,cg.bind(null,U,J,de,T),void 0,null),it===null)throw Error(r(349));(Mo&30)!==0||lg(U,T,de)}return de}function lg(b,T,U){b.flags|=16384,b={getSnapshot:T,value:U},T=ia.updateQueue,T===null?(T={lastEffect:null,stores:null},ia.updateQueue=T,T.stores=[b]):(U=T.stores,U===null?T.stores=[b]:U.push(b))}function cg(b,T,U,J){T.value=U,T.getSnapshot=J,gu(T)&&$p(b)}function bf(b,T,U){return U(function(){gu(T)&&$p(b)})}function gu(b){var T=b.getSnapshot;b=b.value;try{var U=T();return!Js(b,U)}catch{return!0}}function $p(b){var T=Dc(b,1);T!==null&&Sn(T,b,1,-1)}function cc(b){var T=Ul();return typeof b=="function"&&(b=b()),T.memoizedState=T.baseState=b,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:b},T.queue=b,b=b.dispatch=Wp.bind(null,ia,b),[T.memoizedState,b]}function fd(b,T,U,J){return b={tag:b,create:T,destroy:U,deps:J,next:null},T=ia.updateQueue,T===null?(T={lastEffect:null,stores:null},ia.updateQueue=T,T.lastEffect=b.next=b):(U=T.lastEffect,U===null?T.lastEffect=b.next=b:(J=U.next,U.next=b,b.next=J,T.lastEffect=b)),b}function gh(){return Rs().memoizedState}function wf(b,T,U,J){var de=Ul();ia.flags|=b,de.memoizedState=fd(1|T,U,void 0,J===void 0?null:J)}function Sf(b,T,U,J){var de=Rs();J=J===void 0?null:J;var ge=void 0;if(ua!==null){var Ue=ua.memoizedState;if(ge=Ue.destroy,J!==null&&Bp(J,Ue.deps)){de.memoizedState=fd(T,U,ge,J);return}}ia.flags|=b,de.memoizedState=fd(1|T,U,ge,J)}function Af(b,T){return wf(8390656,8,b,T)}function yh(b,T){return Sf(2048,8,b,T)}function ug(b,T){return Sf(4,2,b,T)}function qp(b,T){return Sf(4,4,b,T)}function By(b,T){if(typeof T=="function")return b=b(),T(b),function(){T(null)};if(T!=null)return b=b(),T.current=b,function(){T.current=null}}function dg(b,T,U){return U=U!=null?U.concat([b]):null,Sf(4,4,By.bind(null,T,b),U)}function vh(){}function Vy(b,T){var U=Rs();T=T===void 0?null:T;var J=U.memoizedState;return J!==null&&T!==null&&Bp(T,J[1])?J[0]:(U.memoizedState=[b,T],b)}function Uy(b,T){var U=Rs();T=T===void 0?null:T;var J=U.memoizedState;return J!==null&&T!==null&&Bp(T,J[1])?J[0]:(b=b(),U.memoizedState=[b,T],b)}function $y(b,T,U){return(Mo&21)===0?(b.baseState&&(b.baseState=!1,mo=!0),b.memoizedState=U):(Js(U,T)||(U=Ys(),ia.lanes|=U,Gt|=U,b.baseState=!0),T)}function bv(b,T){var U=_i;_i=U!==0&&4>U?U:4,b(!0);var J=ag.transition;ag.transition={};try{b(!1),T()}finally{_i=U,ag.transition=J}}function qy(){return Rs().memoizedState}function Gp(b,T,U){var J=Xr(b);if(U={lane:J,action:U,hasEagerState:!1,eagerState:null,next:null},Oo(b))Tf(T,U);else if(U=_t(b,T,U,J),U!==null){var de=Yn();Sn(U,b,J,de),Gy(U,T,J)}}function Wp(b,T,U){var J=Xr(b),de={lane:J,action:U,hasEagerState:!1,eagerState:null,next:null};if(Oo(b))Tf(T,de);else{var ge=b.alternate;if(b.lanes===0&&(ge===null||ge.lanes===0)&&(ge=T.lastRenderedReducer,ge!==null))try{var Ue=T.lastRenderedState,yt=ge(Ue,U);if(de.hasEagerState=!0,de.eagerState=yt,Js(yt,Ue)){var Nt=T.interleaved;Nt===null?(de.next=de,qi(T)):(de.next=Nt.next,Nt.next=de),T.interleaved=de;return}}catch{}finally{}U=_t(b,T,de,J),U!==null&&(de=Yn(),Sn(U,b,J,de),Gy(U,T,J))}}function Oo(b){var T=b.alternate;return b===ia||T!==null&&T===ia}function Tf(b,T){Qo=hd=!0;var U=b.pending;U===null?T.next=T:(T.next=U.next,U.next=T),b.pending=T}function Gy(b,T,U){if((U&4194240)!==0){var J=T.lanes;J&=b.pendingLanes,U|=J,T.lanes=U,ml(b,U)}}var hg={readContext:fr,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},Z_={readContext:fr,useCallback:function(b,T){return Ul().memoizedState=[b,T===void 0?null:T],b},useContext:fr,useEffect:Af,useImperativeHandle:function(b,T,U){return U=U!=null?U.concat([b]):null,wf(4194308,4,By.bind(null,T,b),U)},useLayoutEffect:function(b,T){return wf(4194308,4,b,T)},useInsertionEffect:function(b,T){return wf(4,2,b,T)},useMemo:function(b,T){var U=Ul();return T=T===void 0?null:T,b=b(),U.memoizedState=[b,T],b},useReducer:function(b,T,U){var J=Ul();return T=U!==void 0?U(T):T,J.memoizedState=J.baseState=T,b={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:b,lastRenderedState:T},J.queue=b,b=b.dispatch=Gp.bind(null,ia,b),[J.memoizedState,b]},useRef:function(b){var T=Ul();return b={current:b},T.memoizedState=b},useState:cc,useDebugValue:vh,useDeferredValue:function(b){return Ul().memoizedState=b},useTransition:function(){var b=cc(!1),T=b[0];return b=bv.bind(null,b[1]),Ul().memoizedState=b,[T,b]},useMutableSource:function(){},useSyncExternalStore:function(b,T,U){var J=ia,de=Ul();if(ya){if(U===void 0)throw Error(r(407));U=U()}else{if(U=T(),it===null)throw Error(r(349));(Mo&30)!==0||lg(J,T,U)}de.memoizedState=U;var ge={value:U,getSnapshot:T};return de.queue=ge,Af(bf.bind(null,J,ge,b),[b]),J.flags|=2048,fd(9,cg.bind(null,J,ge,U,T),void 0,null),U},useId:function(){var b=Ul(),T=it.identifierPrefix;if(ya){var U=fo,J=oc;U=(J&~(1<<32-gs(J)-1)).toString(32)+U,T=":"+T+"R"+U,U=is++,0<U&&(T+="H"+U.toString(32)),T+=":"}else U=sg++,T=":"+T+"r"+U.toString(32)+":";return b.memoizedState=T},unstable_isNewReconciler:!1},va={readContext:fr,useCallback:Vy,useContext:fr,useEffect:yh,useImperativeHandle:dg,useInsertionEffect:ug,useLayoutEffect:qp,useMemo:Uy,useReducer:_f,useRef:gh,useState:function(){return _f(mh)},useDebugValue:vh,useDeferredValue:function(b){var T=Rs();return $y(T,ua.memoizedState,b)},useTransition:function(){var b=_f(mh)[0],T=Rs().memoizedState;return[b,T]},useMutableSource:og,useSyncExternalStore:_s,useId:qy,unstable_isNewReconciler:!1},fg={readContext:fr,useCallback:Vy,useContext:fr,useEffect:yh,useImperativeHandle:dg,useInsertionEffect:ug,useLayoutEffect:qp,useMemo:Uy,useReducer:Up,useRef:gh,useState:function(){return Up(mh)},useDebugValue:vh,useDeferredValue:function(b){var T=Rs();return ua===null?T.memoizedState=b:$y(T,ua.memoizedState,b)},useTransition:function(){var b=Up(mh)[0],T=Rs().memoizedState;return[b,T]},useMutableSource:og,useSyncExternalStore:_s,useId:qy,unstable_isNewReconciler:!1};function uc(b,T){if(b&&b.defaultProps){T=mt({},T),b=b.defaultProps;for(var U in b)T[U]===void 0&&(T[U]=b[U]);return T}return T}function Hp(b,T,U,J){T=b.memoizedState,U=U(J,T),U=U==null?T:mt({},T,U),b.memoizedState=U,b.lanes===0&&(b.updateQueue.baseState=U)}var pd={isMounted:function(b){return(b=b._reactInternals)?Je(b)===b:!1},enqueueSetState:function(b,T,U){b=b._reactInternals;var J=Yn(),de=Xr(b),ge=Lc(J,de);ge.payload=T,U!=null&&(ge.callback=U),T=fu(b,ge,de),T!==null&&(Sn(T,b,de,J),pu(T,b,de))},enqueueReplaceState:function(b,T,U){b=b._reactInternals;var J=Yn(),de=Xr(b),ge=Lc(J,de);ge.tag=1,ge.payload=T,U!=null&&(ge.callback=U),T=fu(b,ge,de),T!==null&&(Sn(T,b,de,J),pu(T,b,de))},enqueueForceUpdate:function(b,T){b=b._reactInternals;var U=Yn(),J=Xr(b),de=Lc(U,J);de.tag=2,T!=null&&(de.callback=T),T=fu(b,de,J),T!==null&&(Sn(T,b,J,U),pu(T,b,J))}};function Wy(b,T,U,J,de,ge,Ue){return b=b.stateNode,typeof b.shouldComponentUpdate=="function"?b.shouldComponentUpdate(J,ge,Ue):T.prototype&&T.prototype.isPureReactComponent?!Tp(U,J)||!Tp(de,ge):!0}function Pf(b,T,U){var J=!1,de=Fl,ge=T.contextType;return typeof ge=="object"&&ge!==null?ge=fr(ge):(de=Yo(T)?du:Us.current,J=T.contextTypes,ge=(J=J!=null)?sc(b,de):Fl),T=new T(U,ge),b.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=pd,b.stateNode=T,T._reactInternals=b,J&&(b=b.stateNode,b.__reactInternalMemoizedUnmaskedChildContext=de,b.__reactInternalMemoizedMaskedChildContext=ge),T}function Kp(b,T,U,J){b=T.state,typeof T.componentWillReceiveProps=="function"&&T.componentWillReceiveProps(U,J),typeof T.UNSAFE_componentWillReceiveProps=="function"&&T.UNSAFE_componentWillReceiveProps(U,J),T.state!==b&&pd.enqueueReplaceState(T,T.state,null)}function $l(b,T,U,J){var de=b.stateNode;de.props=U,de.state=b.memoizedState,de.refs={},Fp(b);var ge=T.contextType;typeof ge=="object"&&ge!==null?de.context=fr(ge):(ge=Yo(T)?du:Us.current,de.context=sc(b,ge)),de.state=b.memoizedState,ge=T.getDerivedStateFromProps,typeof ge=="function"&&(Hp(b,T,ge,U),de.state=b.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof de.getSnapshotBeforeUpdate=="function"||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(T=de.state,typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount(),T!==de.state&&pd.enqueueReplaceState(de,de.state,null),rg(b,U,de,J),de.state=b.memoizedState),typeof de.componentDidMount=="function"&&(b.flags|=4194308)}function Fc(b,T){try{var U="",J=T;do U+=Zt(J),J=J.return;while(J);var de=U}catch(ge){de=`
Error generating stack: `+ge.message+`
`+ge.stack}return{value:b,source:T,stack:de,digest:null}}function da(b,T,U){return{value:b,source:null,stack:U??null,digest:T??null}}function el(b,T){try{console.error(T.value)}catch(U){setTimeout(function(){throw U})}}var Nf=typeof WeakMap=="function"?WeakMap:Map;function jf(b,T,U){U=Lc(-1,U),U.tag=3,U.payload={element:null};var J=T.value;return U.callback=function(){nr||(nr=!0,yr=J),el(b,T)},U}function Hy(b,T,U){U=Lc(-1,U),U.tag=3;var J=b.type.getDerivedStateFromError;if(typeof J=="function"){var de=T.value;U.payload=function(){return J(de)},U.callback=function(){el(b,T)}}var ge=b.stateNode;return ge!==null&&typeof ge.componentDidCatch=="function"&&(U.callback=function(){el(b,T),typeof J!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var Ue=T.stack;this.componentDidCatch(T.value,{componentStack:Ue!==null?Ue:""})}),U}function Ky(b,T,U){var J=b.pingCache;if(J===null){J=b.pingCache=new Nf;var de=new Set;J.set(T,de)}else de=J.get(T),de===void 0&&(de=new Set,J.set(T,de));de.has(U)||(de.add(U),b=wh.bind(null,b,T,U),T.then(b,b))}function Cf(b){do{var T;if((T=b.tag===13)&&(T=b.memoizedState,T=T!==null?T.dehydrated!==null:!0),T)return b;b=b.return}while(b!==null);return null}function pg(b,T,U,J,de){return(b.mode&1)===0?(b===T?b.flags|=65536:(b.flags|=128,U.flags|=131072,U.flags&=-52805,U.tag===1&&(U.alternate===null?U.tag=17:(T=Lc(-1,1),T.tag=2,fu(U,T,1))),U.lanes|=1),b):(b.flags|=65536,b.lanes=de,b)}var Y_=ae.ReactCurrentOwner,mo=!1;function eo(b,T,U,J){T.child=b===null?zp(T,null,U,J):bi(T,b.child,U,J)}function md(b,T,U,J,de){U=U.render;var ge=T.ref;return er(T,de),J=Vp(b,T,U,J,ge,de),U=mu(),b!==null&&!mo?(T.updateQueue=b.updateQueue,T.flags&=-2053,b.lanes&=~de,rl(b,T,de)):(ya&&U&&Dp(T),T.flags|=1,eo(b,T,J,de),T.child)}function gd(b,T,U,J,de){if(b===null){var ge=U.type;return typeof ge=="function"&&!X_(ge)&&ge.defaultProps===void 0&&U.compare===null&&U.defaultProps===void 0?(T.tag=15,T.type=ge,Bc(b,T,ge,J,de)):(b=Yy(U.type,null,J,T,T.mode,de),b.ref=T.ref,b.return=T,T.child=b)}if(ge=b.child,(b.lanes&de)===0){var Ue=ge.memoizedProps;if(U=U.compare,U=U!==null?U:Tp,U(Ue,J)&&b.ref===T.ref)return rl(b,T,de)}return T.flags|=1,b=Ah(ge,J),b.ref=T.ref,b.return=T,T.child=b}function Bc(b,T,U,J,de){if(b!==null){var ge=b.memoizedProps;if(Tp(ge,J)&&b.ref===T.ref)if(mo=!1,T.pendingProps=J=ge,(b.lanes&de)!==0)(b.flags&131072)!==0&&(mo=!0);else return T.lanes=b.lanes,rl(b,T,de)}return vu(b,T,U,J,de)}function ql(b,T,U){var J=T.pendingProps,de=J.children,ge=b!==null?b.memoizedState:null;if(J.mode==="hidden")if((T.mode&1)===0)T.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qi(Et,kt),kt|=U;else{if((U&1073741824)===0)return b=ge!==null?ge.baseLanes|U:U,T.lanes=T.childLanes=1073741824,T.memoizedState={baseLanes:b,cachePool:null,transitions:null},T.updateQueue=null,Qi(Et,kt),kt|=b,null;T.memoizedState={baseLanes:0,cachePool:null,transitions:null},J=ge!==null?ge.baseLanes:U,Qi(Et,kt),kt|=J}else ge!==null?(J=ge.baseLanes|U,T.memoizedState=null):J=U,Qi(Et,kt),kt|=J;return eo(b,T,de,U),T.child}function yu(b,T){var U=T.ref;(b===null&&U!==null||b!==null&&b.ref!==U)&&(T.flags|=512,T.flags|=2097152)}function vu(b,T,U,J,de){var ge=Yo(U)?du:Us.current;return ge=sc(T,ge),er(T,de),U=Vp(b,T,U,J,ge,de),J=mu(),b!==null&&!mo?(T.updateQueue=b.updateQueue,T.flags&=-2053,b.lanes&=~de,rl(b,T,de)):(ya&&J&&Dp(T),T.flags|=1,eo(b,T,U,de),T.child)}function xu(b,T,U,J,de){if(Yo(U)){var ge=!0;nh(T)}else ge=!1;if(er(T,de),T.stateNode===null)go(b,T),Pf(T,U,J),$l(T,U,J,de),J=!0;else if(b===null){var Ue=T.stateNode,yt=T.memoizedProps;Ue.props=yt;var Nt=Ue.context,Jt=U.contextType;typeof Jt=="object"&&Jt!==null?Jt=fr(Jt):(Jt=Yo(U)?du:Us.current,Jt=sc(T,Jt));var Tr=U.getDerivedStateFromProps,Mr=typeof Tr=="function"||typeof Ue.getSnapshotBeforeUpdate=="function";Mr||typeof Ue.UNSAFE_componentWillReceiveProps!="function"&&typeof Ue.componentWillReceiveProps!="function"||(yt!==J||Nt!==Jt)&&Kp(T,Ue,J,Jt),lc=!1;var Pr=T.memoizedState;Ue.state=Pr,rg(T,J,Ue,de),Nt=T.memoizedState,yt!==J||Pr!==Nt||Zo.current||lc?(typeof Tr=="function"&&(Hp(T,U,Tr,J),Nt=T.memoizedState),(yt=lc||Wy(T,U,yt,J,Pr,Nt,Jt))?(Mr||typeof Ue.UNSAFE_componentWillMount!="function"&&typeof Ue.componentWillMount!="function"||(typeof Ue.componentWillMount=="function"&&Ue.componentWillMount(),typeof Ue.UNSAFE_componentWillMount=="function"&&Ue.UNSAFE_componentWillMount()),typeof Ue.componentDidMount=="function"&&(T.flags|=4194308)):(typeof Ue.componentDidMount=="function"&&(T.flags|=4194308),T.memoizedProps=J,T.memoizedState=Nt),Ue.props=J,Ue.state=Nt,Ue.context=Jt,J=yt):(typeof Ue.componentDidMount=="function"&&(T.flags|=4194308),J=!1)}else{Ue=T.stateNode,zy(b,T),yt=T.memoizedProps,Jt=T.type===T.elementType?yt:uc(T.type,yt),Ue.props=Jt,Mr=T.pendingProps,Pr=Ue.context,Nt=U.contextType,typeof Nt=="object"&&Nt!==null?Nt=fr(Nt):(Nt=Yo(U)?du:Us.current,Nt=sc(T,Nt));var Qr=U.getDerivedStateFromProps;(Tr=typeof Qr=="function"||typeof Ue.getSnapshotBeforeUpdate=="function")||typeof Ue.UNSAFE_componentWillReceiveProps!="function"&&typeof Ue.componentWillReceiveProps!="function"||(yt!==Mr||Pr!==Nt)&&Kp(T,Ue,J,Nt),lc=!1,Pr=T.memoizedState,Ue.state=Pr,rg(T,J,Ue,de);var cn=T.memoizedState;yt!==Mr||Pr!==cn||Zo.current||lc?(typeof Qr=="function"&&(Hp(T,U,Qr,J),cn=T.memoizedState),(Jt=lc||Wy(T,U,Jt,J,Pr,cn,Nt)||!1)?(Tr||typeof Ue.UNSAFE_componentWillUpdate!="function"&&typeof Ue.componentWillUpdate!="function"||(typeof Ue.componentWillUpdate=="function"&&Ue.componentWillUpdate(J,cn,Nt),typeof Ue.UNSAFE_componentWillUpdate=="function"&&Ue.UNSAFE_componentWillUpdate(J,cn,Nt)),typeof Ue.componentDidUpdate=="function"&&(T.flags|=4),typeof Ue.getSnapshotBeforeUpdate=="function"&&(T.flags|=1024)):(typeof Ue.componentDidUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=4),typeof Ue.getSnapshotBeforeUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=1024),T.memoizedProps=J,T.memoizedState=cn),Ue.props=J,Ue.state=cn,Ue.context=Nt,J=Jt):(typeof Ue.componentDidUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=4),typeof Ue.getSnapshotBeforeUpdate!="function"||yt===b.memoizedProps&&Pr===b.memoizedState||(T.flags|=1024),J=!1)}return Zy(b,T,U,J,ge,de)}function Zy(b,T,U,J,de,ge){yu(b,T);var Ue=(T.flags&128)!==0;if(!J&&!Ue)return de&&ih(T,U,!1),rl(b,T,ge);J=T.stateNode,Y_.current=T;var yt=Ue&&typeof U.getDerivedStateFromError!="function"?null:J.render();return T.flags|=1,b!==null&&Ue?(T.child=bi(T,b.child,null,ge),T.child=bi(T,null,yt,ge)):eo(b,T,yt,ge),T.memoizedState=J.state,de&&ih(T,U,!0),T.child}function wv(b){var T=b.stateNode;T.pendingContext?My(b,T.pendingContext,T.pendingContext!==T.context):T.context&&My(b,T.context,!1),xf(b,T.containerInfo)}function Sv(b,T,U,J,de){return wl(),Lp(de),T.flags|=256,eo(b,T,U,J),T.child}var kf={dehydrated:null,treeContext:null,retryLane:0};function mg(b){return{baseLanes:b,cachePool:null,transitions:null}}function to(b,T,U){var J=T.pendingProps,de=pi.current,ge=!1,Ue=(T.flags&128)!==0,yt;if((yt=Ue)||(yt=b!==null&&b.memoizedState===null?!1:(de&2)!==0),yt?(ge=!0,T.flags&=-129):(b===null||b.memoizedState!==null)&&(de|=1),Qi(pi,de&1),b===null)return yf(T),b=T.memoizedState,b!==null&&(b=b.dehydrated,b!==null)?((T.mode&1)===0?T.lanes=1:b.data==="$!"?T.lanes=8:T.lanes=1073741824,null):(Ue=J.children,b=J.fallback,ge?(J=T.mode,ge=T.child,Ue={mode:"hidden",children:Ue},(J&1)===0&&ge!==null?(ge.childLanes=0,ge.pendingProps=Ue):ge=Xy(Ue,J,0,null),b=Rf(b,J,U,null),ge.return=T,b.return=T,ge.sibling=b,T.child=ge,T.child.memoizedState=mg(U),T.memoizedState=kf,b):yd(T,Ue));if(de=b.memoizedState,de!==null&&(yt=de.dehydrated,yt!==null))return Av(b,T,Ue,J,yt,de,U);if(ge){ge=J.fallback,Ue=T.mode,de=b.child,yt=de.sibling;var Nt={mode:"hidden",children:J.children};return(Ue&1)===0&&T.child!==de?(J=T.child,J.childLanes=0,J.pendingProps=Nt,T.deletions=null):(J=Ah(de,Nt),J.subtreeFlags=de.subtreeFlags&14680064),yt!==null?ge=Ah(yt,ge):(ge=Rf(ge,Ue,U,null),ge.flags|=2),ge.return=T,J.return=T,J.sibling=ge,T.child=J,J=ge,ge=T.child,Ue=b.child.memoizedState,Ue=Ue===null?mg(U):{baseLanes:Ue.baseLanes|U,cachePool:null,transitions:Ue.transitions},ge.memoizedState=Ue,ge.childLanes=b.childLanes&~U,T.memoizedState=kf,J}return ge=b.child,b=ge.sibling,J=Ah(ge,{mode:"visible",children:J.children}),(T.mode&1)===0&&(J.lanes=U),J.return=T,J.sibling=null,b!==null&&(U=T.deletions,U===null?(T.deletions=[b],T.flags|=16):U.push(b)),T.child=J,T.memoizedState=null,J}function yd(b,T){return T=Xy({mode:"visible",children:T},b.mode,0,null),T.return=b,b.child=T}function Zp(b,T,U,J){return J!==null&&Lp(J),bi(T,b.child,null,U),b=yd(T,T.pendingProps.children),b.flags|=2,T.memoizedState=null,b}function Av(b,T,U,J,de,ge,Ue){if(U)return T.flags&256?(T.flags&=-257,J=da(Error(r(422))),Zp(b,T,Ue,J)):T.memoizedState!==null?(T.child=b.child,T.flags|=128,null):(ge=J.fallback,de=T.mode,J=Xy({mode:"visible",children:J.children},de,0,null),ge=Rf(ge,de,Ue,null),ge.flags|=2,J.return=T,ge.return=T,J.sibling=ge,T.child=J,(T.mode&1)!==0&&bi(T,b.child,null,Ue),T.child.memoizedState=mg(Ue),T.memoizedState=kf,ge);if((T.mode&1)===0)return Zp(b,T,Ue,null);if(de.data==="$!"){if(J=de.nextSibling&&de.nextSibling.dataset,J)var yt=J.dgst;return J=yt,ge=Error(r(419)),J=da(ge,J,void 0),Zp(b,T,Ue,J)}if(yt=(Ue&b.childLanes)!==0,mo||yt){if(J=it,J!==null){switch(Ue&-Ue){case 4:de=2;break;case 16:de=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:de=32;break;case 536870912:de=268435456;break;default:de=0}de=(de&(J.suspendedLanes|Ue))!==0?0:de,de!==0&&de!==ge.retryLane&&(ge.retryLane=de,Dc(b,de),Sn(J,b,de,-1))}return zn(),J=da(Error(r(421))),Zp(b,T,Ue,J)}return de.data==="$?"?(T.flags|=128,T.child=b.child,T=Sh.bind(null,b),de._reactRetry=T,null):(b=ge.treeContext,po=rd(de.nextSibling),xl=T,ya=!0,_l=null,b!==null&&(Co[gr++]=oc,Co[gr++]=fo,Co[gr++]=hu,oc=b.id,fo=b.overflow,hu=T),T=yd(T,J.children),T.flags|=4096,T)}function xh(b,T,U){b.lanes|=T;var J=b.alternate;J!==null&&(J.lanes|=T),ud(b.return,T,U)}function Ef(b,T,U,J,de){var ge=b.memoizedState;ge===null?b.memoizedState={isBackwards:T,rendering:null,renderingStartTime:0,last:J,tail:U,tailMode:de}:(ge.isBackwards=T,ge.rendering=null,ge.renderingStartTime=0,ge.last=J,ge.tail=U,ge.tailMode=de)}function tl(b,T,U){var J=T.pendingProps,de=J.revealOrder,ge=J.tail;if(eo(b,T,J.children,U),J=pi.current,(J&2)!==0)J=J&1|2,T.flags|=128;else{if(b!==null&&(b.flags&128)!==0)e:for(b=T.child;b!==null;){if(b.tag===13)b.memoizedState!==null&&xh(b,U,T);else if(b.tag===19)xh(b,U,T);else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===T)break e;for(;b.sibling===null;){if(b.return===null||b.return===T)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}J&=1}if(Qi(pi,J),(T.mode&1)===0)T.memoizedState=null;else switch(de){case"forwards":for(U=T.child,de=null;U!==null;)b=U.alternate,b!==null&&ig(b)===null&&(de=U),U=U.sibling;U=de,U===null?(de=T.child,T.child=null):(de=U.sibling,U.sibling=null),Ef(T,!1,de,U,ge);break;case"backwards":for(U=null,de=T.child,T.child=null;de!==null;){if(b=de.alternate,b!==null&&ig(b)===null){T.child=de;break}b=de.sibling,de.sibling=U,U=de,de=b}Ef(T,!0,U,null,ge);break;case"together":Ef(T,!1,null,null,void 0);break;default:T.memoizedState=null}return T.child}function go(b,T){(T.mode&1)===0&&b!==null&&(b.alternate=null,T.alternate=null,T.flags|=2)}function rl(b,T,U){if(b!==null&&(T.dependencies=b.dependencies),Gt|=T.lanes,(U&T.childLanes)===0)return null;if(b!==null&&T.child!==b.child)throw Error(r(153));if(T.child!==null){for(b=T.child,U=Ah(b,b.pendingProps),T.child=U,U.return=T;b.sibling!==null;)b=b.sibling,U=U.sibling=Ah(b,b.pendingProps),U.return=T;U.sibling=null}return T.child}function _h(b,T,U){switch(T.tag){case 3:wv(T),wl();break;case 5:zc(T);break;case 1:Yo(T.type)&&nh(T);break;case 4:xf(T,T.stateNode.containerInfo);break;case 10:var J=T.type._context,de=T.memoizedProps.value;Qi(sd,J._currentValue),J._currentValue=de;break;case 13:if(J=T.memoizedState,J!==null)return J.dehydrated!==null?(Qi(pi,pi.current&1),T.flags|=128,null):(U&T.child.childLanes)!==0?to(b,T,U):(Qi(pi,pi.current&1),b=rl(b,T,U),b!==null?b.sibling:null);Qi(pi,pi.current&1);break;case 19:if(J=(U&T.childLanes)!==0,(b.flags&128)!==0){if(J)return tl(b,T,U);T.flags|=128}if(de=T.memoizedState,de!==null&&(de.rendering=null,de.tail=null,de.lastEffect=null),Qi(pi,pi.current),J)break;return null;case 22:case 23:return T.lanes=0,ql(b,T,U)}return rl(b,T,U)}var vd,Yp,Zn,_u;vd=function(b,T){for(var U=T.child;U!==null;){if(U.tag===5||U.tag===6)b.appendChild(U.stateNode);else if(U.tag!==4&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===T)break;for(;U.sibling===null;){if(U.return===null||U.return===T)return;U=U.return}U.sibling.return=U.return,U=U.sibling}},Yp=function(){},Zn=function(b,T,U,J){var de=b.memoizedProps;if(de!==J){b=T.stateNode,Sl(Qs.current);var ge=null;switch(U){case"input":de=At(b,de),J=At(b,J),ge=[];break;case"select":de=mt({},de,{value:void 0}),J=mt({},J,{value:void 0}),ge=[];break;case"textarea":de=cr(b,de),J=cr(b,J),ge=[];break;default:typeof de.onClick!="function"&&typeof J.onClick=="function"&&(b.onclick=Qd)}Fs(U,J);var Ue;U=null;for(Jt in de)if(!J.hasOwnProperty(Jt)&&de.hasOwnProperty(Jt)&&de[Jt]!=null)if(Jt==="style"){var yt=de[Jt];for(Ue in yt)yt.hasOwnProperty(Ue)&&(U||(U={}),U[Ue]="")}else Jt!=="dangerouslySetInnerHTML"&&Jt!=="children"&&Jt!=="suppressContentEditableWarning"&&Jt!=="suppressHydrationWarning"&&Jt!=="autoFocus"&&(a.hasOwnProperty(Jt)?ge||(ge=[]):(ge=ge||[]).push(Jt,null));for(Jt in J){var Nt=J[Jt];if(yt=de!=null?de[Jt]:void 0,J.hasOwnProperty(Jt)&&Nt!==yt&&(Nt!=null||yt!=null))if(Jt==="style")if(yt){for(Ue in yt)!yt.hasOwnProperty(Ue)||Nt&&Nt.hasOwnProperty(Ue)||(U||(U={}),U[Ue]="");for(Ue in Nt)Nt.hasOwnProperty(Ue)&&yt[Ue]!==Nt[Ue]&&(U||(U={}),U[Ue]=Nt[Ue])}else U||(ge||(ge=[]),ge.push(Jt,U)),U=Nt;else Jt==="dangerouslySetInnerHTML"?(Nt=Nt?Nt.__html:void 0,yt=yt?yt.__html:void 0,Nt!=null&&yt!==Nt&&(ge=ge||[]).push(Jt,Nt)):Jt==="children"?typeof Nt!="string"&&typeof Nt!="number"||(ge=ge||[]).push(Jt,""+Nt):Jt!=="suppressContentEditableWarning"&&Jt!=="suppressHydrationWarning"&&(a.hasOwnProperty(Jt)?(Nt!=null&&Jt==="onScroll"&&ca("scroll",b),ge||yt===Nt||(ge=[])):(ge=ge||[]).push(Jt,Nt))}U&&(ge=ge||[]).push("style",U);var Jt=ge;(T.updateQueue=Jt)&&(T.flags|=4)}},_u=function(b,T,U,J){U!==J&&(T.flags|=4)};function Xp(b,T){if(!ya)switch(b.tailMode){case"hidden":T=b.tail;for(var U=null;T!==null;)T.alternate!==null&&(U=T),T=T.sibling;U===null?b.tail=null:U.sibling=null;break;case"collapsed":U=b.tail;for(var J=null;U!==null;)U.alternate!==null&&(J=U),U=U.sibling;J===null?T||b.tail===null?b.tail=null:b.tail.sibling=null:J.sibling=null}}function yo(b){var T=b.alternate!==null&&b.alternate.child===b.child,U=0,J=0;if(T)for(var de=b.child;de!==null;)U|=de.lanes|de.childLanes,J|=de.subtreeFlags&14680064,J|=de.flags&14680064,de.return=b,de=de.sibling;else for(de=b.child;de!==null;)U|=de.lanes|de.childLanes,J|=de.subtreeFlags,J|=de.flags,de.return=b,de=de.sibling;return b.subtreeFlags|=J,b.childLanes=U,T}function gg(b,T,U){var J=T.pendingProps;switch(Iy(T),T.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yo(T),null;case 1:return Yo(T.type)&&Jm(),yo(T),null;case 3:return J=T.stateNode,Eo(),ga(Zo),ga(Us),Ei(),J.pendingContext&&(J.context=J.pendingContext,J.pendingContext=null),(b===null||b.child===null)&&(bl(T)?T.flags|=4:b===null||b.memoizedState.isDehydrated&&(T.flags&256)===0||(T.flags|=1024,_l!==null&&(oi(_l),_l=null))),Yp(b,T),yo(T),null;case 5:ng(T);var de=Sl(fh.current);if(U=T.type,b!==null&&T.stateNode!=null)Zn(b,T,U,J,de),b.ref!==T.ref&&(T.flags|=512,T.flags|=2097152);else{if(!J){if(T.stateNode===null)throw Error(r(166));return yo(T),null}if(b=Sl(Qs.current),bl(T)){J=T.stateNode,U=T.type;var ge=T.memoizedProps;switch(J[Dl]=T,J[th]=ge,b=(T.mode&1)!==0,U){case"dialog":ca("cancel",J),ca("close",J);break;case"iframe":case"object":case"embed":ca("load",J);break;case"video":case"audio":for(de=0;de<Cp.length;de++)ca(Cp[de],J);break;case"source":ca("error",J);break;case"img":case"image":case"link":ca("error",J),ca("load",J);break;case"details":ca("toggle",J);break;case"input":qr(J,ge),ca("invalid",J);break;case"select":J._wrapperState={wasMultiple:!!ge.multiple},ca("invalid",J);break;case"textarea":xr(J,ge),ca("invalid",J)}Fs(U,ge),de=null;for(var Ue in ge)if(ge.hasOwnProperty(Ue)){var yt=ge[Ue];Ue==="children"?typeof yt=="string"?J.textContent!==yt&&(ge.suppressHydrationWarning!==!0&&ff(J.textContent,yt,b),de=["children",yt]):typeof yt=="number"&&J.textContent!==""+yt&&(ge.suppressHydrationWarning!==!0&&ff(J.textContent,yt,b),de=["children",""+yt]):a.hasOwnProperty(Ue)&&yt!=null&&Ue==="onScroll"&&ca("scroll",J)}switch(U){case"input":jr(J),tt(J,ge,!0);break;case"textarea":jr(J),tn(J);break;case"select":case"option":break;default:typeof ge.onClick=="function"&&(J.onclick=Qd)}J=de,T.updateQueue=J,J!==null&&(T.flags|=4)}else{Ue=de.nodeType===9?de:de.ownerDocument,b==="http://www.w3.org/1999/xhtml"&&(b=Gn(U)),b==="http://www.w3.org/1999/xhtml"?U==="script"?(b=Ue.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild)):typeof J.is=="string"?b=Ue.createElement(U,{is:J.is}):(b=Ue.createElement(U),U==="select"&&(Ue=b,J.multiple?Ue.multiple=!0:J.size&&(Ue.size=J.size))):b=Ue.createElementNS(b,U),b[Dl]=T,b[th]=J,vd(b,T,!1,!1),T.stateNode=b;e:{switch(Ue=nc(U,J),U){case"dialog":ca("cancel",b),ca("close",b),de=J;break;case"iframe":case"object":case"embed":ca("load",b),de=J;break;case"video":case"audio":for(de=0;de<Cp.length;de++)ca(Cp[de],b);de=J;break;case"source":ca("error",b),de=J;break;case"img":case"image":case"link":ca("error",b),ca("load",b),de=J;break;case"details":ca("toggle",b),de=J;break;case"input":qr(b,J),de=At(b,J),ca("invalid",b);break;case"option":de=J;break;case"select":b._wrapperState={wasMultiple:!!J.multiple},de=mt({},J,{value:void 0}),ca("invalid",b);break;case"textarea":xr(b,J),de=cr(b,J),ca("invalid",b);break;default:de=J}Fs(U,de),yt=de;for(ge in yt)if(yt.hasOwnProperty(ge)){var Nt=yt[ge];ge==="style"?rc(b,Nt):ge==="dangerouslySetInnerHTML"?(Nt=Nt?Nt.__html:void 0,Nt!=null&&uo(b,Nt)):ge==="children"?typeof Nt=="string"?(U!=="textarea"||Nt!=="")&&Va(b,Nt):typeof Nt=="number"&&Va(b,""+Nt):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(a.hasOwnProperty(ge)?Nt!=null&&ge==="onScroll"&&ca("scroll",b):Nt!=null&&Q(b,ge,Nt,Ue))}switch(U){case"input":jr(b),tt(b,J,!1);break;case"textarea":jr(b),tn(b);break;case"option":J.value!=null&&b.setAttribute("value",""+ir(J.value));break;case"select":b.multiple=!!J.multiple,ge=J.value,ge!=null?lr(b,!!J.multiple,ge,!1):J.defaultValue!=null&&lr(b,!!J.multiple,J.defaultValue,!0);break;default:typeof de.onClick=="function"&&(b.onclick=Qd)}switch(U){case"button":case"input":case"select":case"textarea":J=!!J.autoFocus;break e;case"img":J=!0;break e;default:J=!1}}J&&(T.flags|=4)}T.ref!==null&&(T.flags|=512,T.flags|=2097152)}return yo(T),null;case 6:if(b&&T.stateNode!=null)_u(b,T,b.memoizedProps,J);else{if(typeof J!="string"&&T.stateNode===null)throw Error(r(166));if(U=Sl(fh.current),Sl(Qs.current),bl(T)){if(J=T.stateNode,U=T.memoizedProps,J[Dl]=T,(ge=J.nodeValue!==U)&&(b=xl,b!==null))switch(b.tag){case 3:ff(J.nodeValue,U,(b.mode&1)!==0);break;case 5:b.memoizedProps.suppressHydrationWarning!==!0&&ff(J.nodeValue,U,(b.mode&1)!==0)}ge&&(T.flags|=4)}else J=(U.nodeType===9?U:U.ownerDocument).createTextNode(J),J[Dl]=T,T.stateNode=J}return yo(T),null;case 13:if(ga(pi),J=T.memoizedState,b===null||b.memoizedState!==null&&b.memoizedState.dehydrated!==null){if(ya&&po!==null&&(T.mode&1)!==0&&(T.flags&128)===0)ko(),wl(),T.flags|=98560,ge=!1;else if(ge=bl(T),J!==null&&J.dehydrated!==null){if(b===null){if(!ge)throw Error(r(318));if(ge=T.memoizedState,ge=ge!==null?ge.dehydrated:null,!ge)throw Error(r(317));ge[Dl]=T}else wl(),(T.flags&128)===0&&(T.memoizedState=null),T.flags|=4;yo(T),ge=!1}else _l!==null&&(oi(_l),_l=null),ge=!0;if(!ge)return T.flags&65536?T:null}return(T.flags&128)!==0?(T.lanes=U,T):(J=J!==null,J!==(b!==null&&b.memoizedState!==null)&&J&&(T.child.flags|=8192,(T.mode&1)!==0&&(b===null||(pi.current&1)!==0?dt===0&&(dt=3):zn())),T.updateQueue!==null&&(T.flags|=4),yo(T),null);case 4:return Eo(),Yp(b,T),b===null&&hf(T.stateNode.containerInfo),yo(T),null;case 10:return cd(T.type._context),yo(T),null;case 17:return Yo(T.type)&&Jm(),yo(T),null;case 19:if(ga(pi),ge=T.memoizedState,ge===null)return yo(T),null;if(J=(T.flags&128)!==0,Ue=ge.rendering,Ue===null)if(J)Xp(ge,!1);else{if(dt!==0||b!==null&&(b.flags&128)!==0)for(b=T.child;b!==null;){if(Ue=ig(b),Ue!==null){for(T.flags|=128,Xp(ge,!1),J=Ue.updateQueue,J!==null&&(T.updateQueue=J,T.flags|=4),T.subtreeFlags=0,J=U,U=T.child;U!==null;)ge=U,b=J,ge.flags&=14680066,Ue=ge.alternate,Ue===null?(ge.childLanes=0,ge.lanes=b,ge.child=null,ge.subtreeFlags=0,ge.memoizedProps=null,ge.memoizedState=null,ge.updateQueue=null,ge.dependencies=null,ge.stateNode=null):(ge.childLanes=Ue.childLanes,ge.lanes=Ue.lanes,ge.child=Ue.child,ge.subtreeFlags=0,ge.deletions=null,ge.memoizedProps=Ue.memoizedProps,ge.memoizedState=Ue.memoizedState,ge.updateQueue=Ue.updateQueue,ge.type=Ue.type,b=Ue.dependencies,ge.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),U=U.sibling;return Qi(pi,pi.current&1|2),T.child}b=b.sibling}ge.tail!==null&&Ar()>zt&&(T.flags|=128,J=!0,Xp(ge,!1),T.lanes=4194304)}else{if(!J)if(b=ig(Ue),b!==null){if(T.flags|=128,J=!0,U=b.updateQueue,U!==null&&(T.updateQueue=U,T.flags|=4),Xp(ge,!0),ge.tail===null&&ge.tailMode==="hidden"&&!Ue.alternate&&!ya)return yo(T),null}else 2*Ar()-ge.renderingStartTime>zt&&U!==1073741824&&(T.flags|=128,J=!0,Xp(ge,!1),T.lanes=4194304);ge.isBackwards?(Ue.sibling=T.child,T.child=Ue):(U=ge.last,U!==null?U.sibling=Ue:T.child=Ue,ge.last=Ue)}return ge.tail!==null?(T=ge.tail,ge.rendering=T,ge.tail=T.sibling,ge.renderingStartTime=Ar(),T.sibling=null,U=pi.current,Qi(pi,J?U&1|2:U&1),T):(yo(T),null);case 22:case 23:return Ds(),J=T.memoizedState!==null,b!==null&&b.memoizedState!==null!==J&&(T.flags|=8192),J&&(T.mode&1)!==0?(kt&1073741824)!==0&&(yo(T),T.subtreeFlags&6&&(T.flags|=8192)):yo(T),null;case 24:return null;case 25:return null}throw Error(r(156,T.tag))}function Vc(b,T){switch(Iy(T),T.tag){case 1:return Yo(T.type)&&Jm(),b=T.flags,b&65536?(T.flags=b&-65537|128,T):null;case 3:return Eo(),ga(Zo),ga(Us),Ei(),b=T.flags,(b&65536)!==0&&(b&128)===0?(T.flags=b&-65537|128,T):null;case 5:return ng(T),null;case 13:if(ga(pi),b=T.memoizedState,b!==null&&b.dehydrated!==null){if(T.alternate===null)throw Error(r(340));wl()}return b=T.flags,b&65536?(T.flags=b&-65537|128,T):null;case 19:return ga(pi),null;case 4:return Eo(),null;case 10:return cd(T.type._context),null;case 22:case 23:return Ds(),null;case 24:return null;default:return null}}var nl=!1,Gi=!1,il=typeof WeakSet=="function"?WeakSet:Set,Vr=null;function bh(b,T){var U=b.ref;if(U!==null)if(typeof U=="function")try{U(null)}catch(J){Oi(b,T,J)}else U.current=null}function ro(b,T,U){try{U()}catch(J){Oi(b,T,J)}}var yg=!1;function Mf(b,T){if(Op=qa,b=Cy(),Ko(b)){if("selectionStart"in b)var U={start:b.selectionStart,end:b.selectionEnd};else e:{U=(U=b.ownerDocument)&&U.defaultView||window;var J=U.getSelection&&U.getSelection();if(J&&J.rangeCount!==0){U=J.anchorNode;var de=J.anchorOffset,ge=J.focusNode;J=J.focusOffset;try{U.nodeType,ge.nodeType}catch{U=null;break e}var Ue=0,yt=-1,Nt=-1,Jt=0,Tr=0,Mr=b,Pr=null;t:for(;;){for(var Qr;Mr!==U||de!==0&&Mr.nodeType!==3||(yt=Ue+de),Mr!==ge||J!==0&&Mr.nodeType!==3||(Nt=Ue+J),Mr.nodeType===3&&(Ue+=Mr.nodeValue.length),(Qr=Mr.firstChild)!==null;)Pr=Mr,Mr=Qr;for(;;){if(Mr===b)break t;if(Pr===U&&++Jt===de&&(yt=Ue),Pr===ge&&++Tr===J&&(Nt=Ue),(Qr=Mr.nextSibling)!==null)break;Mr=Pr,Pr=Mr.parentNode}Mr=Qr}U=yt===-1||Nt===-1?null:{start:yt,end:Nt}}else U=null}U=U||{start:0,end:0}}else U=null;for(Rp={focusedElem:b,selectionRange:U},qa=!1,Vr=T;Vr!==null;)if(T=Vr,b=T.child,(T.subtreeFlags&1028)!==0&&b!==null)b.return=T,Vr=b;else for(;Vr!==null;){T=Vr;try{var cn=T.alternate;if((T.flags&1024)!==0)switch(T.tag){case 0:case 11:case 15:break;case 1:if(cn!==null){var dn=cn.memoizedProps,ws=cn.memoizedState,qt=T.stateNode,Ot=qt.getSnapshotBeforeUpdate(T.elementType===T.type?dn:uc(T.type,dn),ws);qt.__reactInternalSnapshotBeforeUpdate=Ot}break;case 3:var Kt=T.stateNode.containerInfo;Kt.nodeType===1?Kt.textContent="":Kt.nodeType===9&&Kt.documentElement&&Kt.removeChild(Kt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ir){Oi(T,T.return,Ir)}if(b=T.sibling,b!==null){b.return=T.return,Vr=b;break}Vr=T.return}return cn=yg,yg=!1,cn}function g(b,T,U){var J=T.updateQueue;if(J=J!==null?J.lastEffect:null,J!==null){var de=J=J.next;do{if((de.tag&b)===b){var ge=de.destroy;de.destroy=void 0,ge!==void 0&&ro(T,U,ge)}de=de.next}while(de!==J)}}function o(b,T){if(T=T.updateQueue,T=T!==null?T.lastEffect:null,T!==null){var U=T=T.next;do{if((U.tag&b)===b){var J=U.create;U.destroy=J()}U=U.next}while(U!==T)}}function d(b){var T=b.ref;if(T!==null){var U=b.stateNode;switch(b.tag){case 5:b=U;break;default:b=U}typeof T=="function"?T(b):T.current=b}}function y(b){var T=b.alternate;T!==null&&(b.alternate=null,y(T)),b.child=null,b.deletions=null,b.sibling=null,b.tag===5&&(T=b.stateNode,T!==null&&(delete T[Dl],delete T[th],delete T[nd],delete T[Ey],delete T[xv])),b.stateNode=null,b.return=null,b.dependencies=null,b.memoizedProps=null,b.memoizedState=null,b.pendingProps=null,b.stateNode=null,b.updateQueue=null}function S(b){return b.tag===5||b.tag===3||b.tag===4}function N(b){e:for(;;){for(;b.sibling===null;){if(b.return===null||S(b.return))return null;b=b.return}for(b.sibling.return=b.return,b=b.sibling;b.tag!==5&&b.tag!==6&&b.tag!==18;){if(b.flags&2||b.child===null||b.tag===4)continue e;b.child.return=b,b=b.child}if(!(b.flags&2))return b.stateNode}}function k(b,T,U){var J=b.tag;if(J===5||J===6)b=b.stateNode,T?U.nodeType===8?U.parentNode.insertBefore(b,T):U.insertBefore(b,T):(U.nodeType===8?(T=U.parentNode,T.insertBefore(b,U)):(T=U,T.appendChild(b)),U=U._reactRootContainer,U!=null||T.onclick!==null||(T.onclick=Qd));else if(J!==4&&(b=b.child,b!==null))for(k(b,T,U),b=b.sibling;b!==null;)k(b,T,U),b=b.sibling}function z(b,T,U){var J=b.tag;if(J===5||J===6)b=b.stateNode,T?U.insertBefore(b,T):U.appendChild(b);else if(J!==4&&(b=b.child,b!==null))for(z(b,T,U),b=b.sibling;b!==null;)z(b,T,U),b=b.sibling}var G=null,Z=!1;function Y(b,T,U){for(U=U.child;U!==null;)re(b,T,U),U=U.sibling}function re(b,T,U){if(Rn&&typeof Rn.onCommitFiberUnmount=="function")try{Rn.onCommitFiberUnmount(Un,U)}catch{}switch(U.tag){case 5:Gi||bh(U,T);case 6:var J=G,de=Z;G=null,Y(b,T,U),G=J,Z=de,G!==null&&(Z?(b=G,U=U.stateNode,b.nodeType===8?b.parentNode.removeChild(U):b.removeChild(U)):G.removeChild(U.stateNode));break;case 18:G!==null&&(Z?(b=G,U=U.stateNode,b.nodeType===8?ky(b.parentNode,U):b.nodeType===1&&ky(b,U),Ho(b)):ky(G,U.stateNode));break;case 4:J=G,de=Z,G=U.stateNode.containerInfo,Z=!0,Y(b,T,U),G=J,Z=de;break;case 0:case 11:case 14:case 15:if(!Gi&&(J=U.updateQueue,J!==null&&(J=J.lastEffect,J!==null))){de=J=J.next;do{var ge=de,Ue=ge.destroy;ge=ge.tag,Ue!==void 0&&((ge&2)!==0||(ge&4)!==0)&&ro(U,T,Ue),de=de.next}while(de!==J)}Y(b,T,U);break;case 1:if(!Gi&&(bh(U,T),J=U.stateNode,typeof J.componentWillUnmount=="function"))try{J.props=U.memoizedProps,J.state=U.memoizedState,J.componentWillUnmount()}catch(yt){Oi(U,T,yt)}Y(b,T,U);break;case 21:Y(b,T,U);break;case 22:U.mode&1?(Gi=(J=Gi)||U.memoizedState!==null,Y(b,T,U),Gi=J):Y(b,T,U);break;default:Y(b,T,U)}}function ne(b){var T=b.updateQueue;if(T!==null){b.updateQueue=null;var U=b.stateNode;U===null&&(U=b.stateNode=new il),T.forEach(function(J){var de=Of.bind(null,b,J);U.has(J)||(U.add(J),J.then(de,de))})}}function oe(b,T){var U=T.deletions;if(U!==null)for(var J=0;J<U.length;J++){var de=U[J];try{var ge=b,Ue=T,yt=Ue;e:for(;yt!==null;){switch(yt.tag){case 5:G=yt.stateNode,Z=!1;break e;case 3:G=yt.stateNode.containerInfo,Z=!0;break e;case 4:G=yt.stateNode.containerInfo,Z=!0;break e}yt=yt.return}if(G===null)throw Error(r(160));re(ge,Ue,de),G=null,Z=!1;var Nt=de.alternate;Nt!==null&&(Nt.return=null),de.return=null}catch(Jt){Oi(de,T,Jt)}}if(T.subtreeFlags&12854)for(T=T.child;T!==null;)_e(T,b),T=T.sibling}function _e(b,T){var U=b.alternate,J=b.flags;switch(b.tag){case 0:case 11:case 14:case 15:if(oe(T,b),me(b),J&4){try{g(3,b,b.return),o(3,b)}catch(dn){Oi(b,b.return,dn)}try{g(5,b,b.return)}catch(dn){Oi(b,b.return,dn)}}break;case 1:oe(T,b),me(b),J&512&&U!==null&&bh(U,U.return);break;case 5:if(oe(T,b),me(b),J&512&&U!==null&&bh(U,U.return),b.flags&32){var de=b.stateNode;try{Va(de,"")}catch(dn){Oi(b,b.return,dn)}}if(J&4&&(de=b.stateNode,de!=null)){var ge=b.memoizedProps,Ue=U!==null?U.memoizedProps:ge,yt=b.type,Nt=b.updateQueue;if(b.updateQueue=null,Nt!==null)try{yt==="input"&&ge.type==="radio"&&ge.name!=null&&an(de,ge),nc(yt,Ue);var Jt=nc(yt,ge);for(Ue=0;Ue<Nt.length;Ue+=2){var Tr=Nt[Ue],Mr=Nt[Ue+1];Tr==="style"?rc(de,Mr):Tr==="dangerouslySetInnerHTML"?uo(de,Mr):Tr==="children"?Va(de,Mr):Q(de,Tr,Mr,Jt)}switch(yt){case"input":Jn(de,ge);break;case"textarea":ur(de,ge);break;case"select":var Pr=de._wrapperState.wasMultiple;de._wrapperState.wasMultiple=!!ge.multiple;var Qr=ge.value;Qr!=null?lr(de,!!ge.multiple,Qr,!1):Pr!==!!ge.multiple&&(ge.defaultValue!=null?lr(de,!!ge.multiple,ge.defaultValue,!0):lr(de,!!ge.multiple,ge.multiple?[]:"",!1))}de[th]=ge}catch(dn){Oi(b,b.return,dn)}}break;case 6:if(oe(T,b),me(b),J&4){if(b.stateNode===null)throw Error(r(162));de=b.stateNode,ge=b.memoizedProps;try{de.nodeValue=ge}catch(dn){Oi(b,b.return,dn)}}break;case 3:if(oe(T,b),me(b),J&4&&U!==null&&U.memoizedState.isDehydrated)try{Ho(T.containerInfo)}catch(dn){Oi(b,b.return,dn)}break;case 4:oe(T,b),me(b);break;case 13:oe(T,b),me(b),de=b.child,de.flags&8192&&(ge=de.memoizedState!==null,de.stateNode.isHidden=ge,!ge||de.alternate!==null&&de.alternate.memoizedState!==null||($t=Ar())),J&4&&ne(b);break;case 22:if(Tr=U!==null&&U.memoizedState!==null,b.mode&1?(Gi=(Jt=Gi)||Tr,oe(T,b),Gi=Jt):oe(T,b),me(b),J&8192){if(Jt=b.memoizedState!==null,(b.stateNode.isHidden=Jt)&&!Tr&&(b.mode&1)!==0)for(Vr=b,Tr=b.child;Tr!==null;){for(Mr=Vr=Tr;Vr!==null;){switch(Pr=Vr,Qr=Pr.child,Pr.tag){case 0:case 11:case 14:case 15:g(4,Pr,Pr.return);break;case 1:bh(Pr,Pr.return);var cn=Pr.stateNode;if(typeof cn.componentWillUnmount=="function"){J=Pr,U=Pr.return;try{T=J,cn.props=T.memoizedProps,cn.state=T.memoizedState,cn.componentWillUnmount()}catch(dn){Oi(J,U,dn)}}break;case 5:bh(Pr,Pr.return);break;case 22:if(Pr.memoizedState!==null){$e(Mr);continue}}Qr!==null?(Qr.return=Pr,Vr=Qr):$e(Mr)}Tr=Tr.sibling}e:for(Tr=null,Mr=b;;){if(Mr.tag===5){if(Tr===null){Tr=Mr;try{de=Mr.stateNode,Jt?(ge=de.style,typeof ge.setProperty=="function"?ge.setProperty("display","none","important"):ge.display="none"):(yt=Mr.stateNode,Nt=Mr.memoizedProps.style,Ue=Nt!=null&&Nt.hasOwnProperty("display")?Nt.display:null,yt.style.display=es("display",Ue))}catch(dn){Oi(b,b.return,dn)}}}else if(Mr.tag===6){if(Tr===null)try{Mr.stateNode.nodeValue=Jt?"":Mr.memoizedProps}catch(dn){Oi(b,b.return,dn)}}else if((Mr.tag!==22&&Mr.tag!==23||Mr.memoizedState===null||Mr===b)&&Mr.child!==null){Mr.child.return=Mr,Mr=Mr.child;continue}if(Mr===b)break e;for(;Mr.sibling===null;){if(Mr.return===null||Mr.return===b)break e;Tr===Mr&&(Tr=null),Mr=Mr.return}Tr===Mr&&(Tr=null),Mr.sibling.return=Mr.return,Mr=Mr.sibling}}break;case 19:oe(T,b),me(b),J&4&&ne(b);break;case 21:break;default:oe(T,b),me(b)}}function me(b){var T=b.flags;if(T&2){try{e:{for(var U=b.return;U!==null;){if(S(U)){var J=U;break e}U=U.return}throw Error(r(160))}switch(J.tag){case 5:var de=J.stateNode;J.flags&32&&(Va(de,""),J.flags&=-33);var ge=N(b);z(b,ge,de);break;case 3:case 4:var Ue=J.stateNode.containerInfo,yt=N(b);k(b,yt,Ue);break;default:throw Error(r(161))}}catch(Nt){Oi(b,b.return,Nt)}b.flags&=-3}T&4096&&(b.flags&=-4097)}function we(b,T,U){Vr=b,be(b)}function be(b,T,U){for(var J=(b.mode&1)!==0;Vr!==null;){var de=Vr,ge=de.child;if(de.tag===22&&J){var Ue=de.memoizedState!==null||nl;if(!Ue){var yt=de.alternate,Nt=yt!==null&&yt.memoizedState!==null||Gi;yt=nl;var Jt=Gi;if(nl=Ue,(Gi=Nt)&&!Jt)for(Vr=de;Vr!==null;)Ue=Vr,Nt=Ue.child,Ue.tag===22&&Ue.memoizedState!==null?Ve(de):Nt!==null?(Nt.return=Ue,Vr=Nt):Ve(de);for(;ge!==null;)Vr=ge,be(ge),ge=ge.sibling;Vr=de,nl=yt,Gi=Jt}Ee(b)}else(de.subtreeFlags&8772)!==0&&ge!==null?(ge.return=de,Vr=ge):Ee(b)}}function Ee(b){for(;Vr!==null;){var T=Vr;if((T.flags&8772)!==0){var U=T.alternate;try{if((T.flags&8772)!==0)switch(T.tag){case 0:case 11:case 15:Gi||o(5,T);break;case 1:var J=T.stateNode;if(T.flags&4&&!Gi)if(U===null)J.componentDidMount();else{var de=T.elementType===T.type?U.memoizedProps:uc(T.type,U.memoizedProps);J.componentDidUpdate(de,U.memoizedState,J.__reactInternalSnapshotBeforeUpdate)}var ge=T.updateQueue;ge!==null&&Fy(T,ge,J);break;case 3:var Ue=T.updateQueue;if(Ue!==null){if(U=null,T.child!==null)switch(T.child.tag){case 5:U=T.child.stateNode;break;case 1:U=T.child.stateNode}Fy(T,Ue,U)}break;case 5:var yt=T.stateNode;if(U===null&&T.flags&4){U=yt;var Nt=T.memoizedProps;switch(T.type){case"button":case"input":case"select":case"textarea":Nt.autoFocus&&U.focus();break;case"img":Nt.src&&(U.src=Nt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(T.memoizedState===null){var Jt=T.alternate;if(Jt!==null){var Tr=Jt.memoizedState;if(Tr!==null){var Mr=Tr.dehydrated;Mr!==null&&Ho(Mr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Gi||T.flags&512&&d(T)}catch(Pr){Oi(T,T.return,Pr)}}if(T===b){Vr=null;break}if(U=T.sibling,U!==null){U.return=T.return,Vr=U;break}Vr=T.return}}function $e(b){for(;Vr!==null;){var T=Vr;if(T===b){Vr=null;break}var U=T.sibling;if(U!==null){U.return=T.return,Vr=U;break}Vr=T.return}}function Ve(b){for(;Vr!==null;){var T=Vr;try{switch(T.tag){case 0:case 11:case 15:var U=T.return;try{o(4,T)}catch(Nt){Oi(T,U,Nt)}break;case 1:var J=T.stateNode;if(typeof J.componentDidMount=="function"){var de=T.return;try{J.componentDidMount()}catch(Nt){Oi(T,de,Nt)}}var ge=T.return;try{d(T)}catch(Nt){Oi(T,ge,Nt)}break;case 5:var Ue=T.return;try{d(T)}catch(Nt){Oi(T,Ue,Nt)}}}catch(Nt){Oi(T,T.return,Nt)}if(T===b){Vr=null;break}var yt=T.sibling;if(yt!==null){yt.return=T.return,Vr=yt;break}Vr=T.return}}var Qe=Math.ceil,We=ae.ReactCurrentDispatcher,Ke=ae.ReactCurrentOwner,Ge=ae.ReactCurrentBatchConfig,Ye=0,it=null,bt=null,pt=0,kt=0,Et=zl(0),dt=0,jt=null,Gt=0,ft=0,Ft=0,Ct=null,Qt=null,$t=0,zt=1/0,Yt=null,nr=!1,yr=null,_r=null,Wr=!1,Or=null,Lr=0,Zr=0,Dn=null,hi=-1,Wi=0;function Yn(){return(Ye&6)!==0?Ar():hi!==-1?hi:hi=Ar()}function Xr(b){return(b.mode&1)===0?1:(Ye&2)!==0&&pt!==0?pt&-pt:Ly.transition!==null?(Wi===0&&(Wi=Ys()),Wi):(b=_i,b!==0||(b=window.event,b=b===void 0?16:yp(b.type)),b)}function Sn(b,T,U,J){if(50<Zr)throw Zr=0,Dn=null,Error(r(185));pl(b,U,J),((Ye&2)===0||b!==it)&&(b===it&&((Ye&2)===0&&(ft|=U),dt===4&&aa(b,pt)),Sr(b,J),U===1&&Ye===0&&(T.mode&1)===0&&(zt=Ar()+500,ah&&Bl()))}function Sr(b,T){var U=b.callbackNode;vy(b,T);var J=tf(b,b===it?pt:0);if(J===0)U!==null&&Vt(U),b.callbackNode=null,b.callbackPriority=0;else if(T=J&-J,b.callbackPriority!==T){if(U!=null&&Vt(U),T===1)b.tag===0?Ip(Ea.bind(null,b)):Ry(Ea.bind(null,b)),H_(function(){(Ye&6)===0&&Bl()}),U=null;else{switch(gp(J)){case 1:U=$r;break;case 4:U=Ur;break;case 16:U=On;break;case 536870912:U=wn;break;default:U=On}U=vg(U,In.bind(null,b))}b.callbackPriority=T,b.callbackNode=U}}function In(b,T){if(hi=-1,Wi=0,(Ye&6)!==0)throw Error(r(327));var U=b.callbackNode;if(Io()&&b.callbackNode!==U)return null;var J=tf(b,b===it?pt:0);if(J===0)return null;if((J&30)!==0||(J&b.expiredLanes)!==0||T)T=sa(b,J);else{T=J;var de=Ye;Ye|=2;var ge=wi();(it!==b||pt!==T)&&(Yt=null,zt=Ar()+500,Mi(b,T));do try{ji();break}catch(yt){Ni(b,yt)}while(!0);ld(),We.current=ge,Ye=de,bt!==null?T=0:(it=null,pt=0,T=dt)}if(T!==0){if(T===2&&(de=mp(b),de!==0&&(J=de,T=ti(b,de))),T===1)throw U=jt,Mi(b,0),aa(b,J),Sr(b,Ar()),U;if(T===6)aa(b,J);else{if(de=b.current.alternate,(J&30)===0&&!ea(de)&&(T=sa(b,J),T===2&&(ge=mp(b),ge!==0&&(J=ge,T=ti(b,ge))),T===1))throw U=jt,Mi(b,0),aa(b,J),Sr(b,Ar()),U;switch(b.finishedWork=de,b.finishedLanes=J,T){case 0:case 1:throw Error(r(345));case 2:bs(b,Qt,Yt);break;case 3:if(aa(b,J),(J&130023424)===J&&(T=$t+500-Ar(),10<T)){if(tf(b,0)!==0)break;if(de=b.suspendedLanes,(de&J)!==J){Yn(),b.pingedLanes|=b.suspendedLanes&de;break}b.timeoutHandle=Xm(bs.bind(null,b,Qt,Yt),T);break}bs(b,Qt,Yt);break;case 4:if(aa(b,J),(J&4194240)===J)break;for(T=b.eventTimes,de=-1;0<J;){var Ue=31-gs(J);ge=1<<Ue,Ue=T[Ue],Ue>de&&(de=Ue),J&=~ge}if(J=de,J=Ar()-J,J=(120>J?120:480>J?480:1080>J?1080:1920>J?1920:3e3>J?3e3:4320>J?4320:1960*Qe(J/1960))-J,10<J){b.timeoutHandle=Xm(bs.bind(null,b,Qt,Yt),J);break}bs(b,Qt,Yt);break;case 5:bs(b,Qt,Yt);break;default:throw Error(r(329))}}}return Sr(b,Ar()),b.callbackNode===U?In.bind(null,b):null}function ti(b,T){var U=Ct;return b.current.memoizedState.isDehydrated&&(Mi(b,T).flags|=256),b=sa(b,T),b!==2&&(T=Qt,Qt=U,T!==null&&oi(T)),b}function oi(b){Qt===null?Qt=b:Qt.push.apply(Qt,b)}function ea(b){for(var T=b;;){if(T.flags&16384){var U=T.updateQueue;if(U!==null&&(U=U.stores,U!==null))for(var J=0;J<U.length;J++){var de=U[J],ge=de.getSnapshot;de=de.value;try{if(!Js(ge(),de))return!1}catch{return!1}}}if(U=T.child,T.subtreeFlags&16384&&U!==null)U.return=T,T=U;else{if(T===b)break;for(;T.sibling===null;){if(T.return===null||T.return===b)return!0;T=T.return}T.sibling.return=T.return,T=T.sibling}}return!0}function aa(b,T){for(T&=~Ft,T&=~ft,b.suspendedLanes|=T,b.pingedLanes&=~T,b=b.expirationTimes;0<T;){var U=31-gs(T),J=1<<U;b[U]=-1,T&=~J}}function Ea(b){if((Ye&6)!==0)throw Error(r(327));Io();var T=tf(b,0);if((T&1)===0)return Sr(b,Ar()),null;var U=sa(b,T);if(b.tag!==0&&U===2){var J=mp(b);J!==0&&(T=J,U=ti(b,J))}if(U===1)throw U=jt,Mi(b,0),aa(b,T),Sr(b,Ar()),U;if(U===6)throw Error(r(345));return b.finishedWork=b.current.alternate,b.finishedLanes=T,bs(b,Qt,Yt),Sr(b,Ar()),null}function Sa(b,T){var U=Ye;Ye|=1;try{return b(T)}finally{Ye=U,Ye===0&&(zt=Ar()+500,ah&&Bl())}}function Is(b){Or!==null&&Or.tag===0&&(Ye&6)===0&&Io();var T=Ye;Ye|=1;var U=Ge.transition,J=_i;try{if(Ge.transition=null,_i=1,b)return b()}finally{_i=J,Ge.transition=U,Ye=T,(Ye&6)===0&&Bl()}}function Ds(){kt=Et.current,ga(Et)}function Mi(b,T){b.finishedWork=null,b.finishedLanes=0;var U=b.timeoutHandle;if(U!==-1&&(b.timeoutHandle=-1,yv(U)),bt!==null)for(U=bt.return;U!==null;){var J=U;switch(Iy(J),J.tag){case 1:J=J.type.childContextTypes,J!=null&&Jm();break;case 3:Eo(),ga(Zo),ga(Us),Ei();break;case 5:ng(J);break;case 4:Eo();break;case 13:ga(pi);break;case 19:ga(pi);break;case 10:cd(J.type._context);break;case 22:case 23:Ds()}U=U.return}if(it=b,bt=b=Ah(b.current,null),pt=kt=T,dt=0,jt=null,Ft=ft=Gt=0,Qt=Ct=null,Vl!==null){for(T=0;T<Vl.length;T++)if(U=Vl[T],J=U.interleaved,J!==null){U.interleaved=null;var de=J.next,ge=U.pending;if(ge!==null){var Ue=ge.next;ge.next=de,J.next=Ue}U.pending=J}Vl=null}return b}function Ni(b,T){do{var U=bt;try{if(ld(),ei.current=hg,hd){for(var J=ia.memoizedState;J!==null;){var de=J.queue;de!==null&&(de.pending=null),J=J.next}hd=!1}if(Mo=0,ns=ua=ia=null,Qo=!1,is=0,Ke.current=null,U===null||U.return===null){dt=1,jt=T,bt=null;break}e:{var ge=b,Ue=U.return,yt=U,Nt=T;if(T=pt,yt.flags|=32768,Nt!==null&&typeof Nt=="object"&&typeof Nt.then=="function"){var Jt=Nt,Tr=yt,Mr=Tr.tag;if((Tr.mode&1)===0&&(Mr===0||Mr===11||Mr===15)){var Pr=Tr.alternate;Pr?(Tr.updateQueue=Pr.updateQueue,Tr.memoizedState=Pr.memoizedState,Tr.lanes=Pr.lanes):(Tr.updateQueue=null,Tr.memoizedState=null)}var Qr=Cf(Ue);if(Qr!==null){Qr.flags&=-257,pg(Qr,Ue,yt,ge,T),Qr.mode&1&&Ky(ge,Jt,T),T=Qr,Nt=Jt;var cn=T.updateQueue;if(cn===null){var dn=new Set;dn.add(Nt),T.updateQueue=dn}else cn.add(Nt);break e}else{if((T&1)===0){Ky(ge,Jt,T),zn();break e}Nt=Error(r(426))}}else if(ya&&yt.mode&1){var ws=Cf(Ue);if(ws!==null){(ws.flags&65536)===0&&(ws.flags|=256),pg(ws,Ue,yt,ge,T),Lp(Fc(Nt,yt));break e}}ge=Nt=Fc(Nt,yt),dt!==4&&(dt=2),Ct===null?Ct=[ge]:Ct.push(ge),ge=Ue;do{switch(ge.tag){case 3:ge.flags|=65536,T&=-T,ge.lanes|=T;var qt=jf(ge,Nt,T);_v(ge,qt);break e;case 1:yt=Nt;var Ot=ge.type,Kt=ge.stateNode;if((ge.flags&128)===0&&(typeof Ot.getDerivedStateFromError=="function"||Kt!==null&&typeof Kt.componentDidCatch=="function"&&(_r===null||!_r.has(Kt)))){ge.flags|=65536,T&=-T,ge.lanes|=T;var Ir=Hy(ge,yt,T);_v(ge,Ir);break e}}ge=ge.return}while(ge!==null)}Al(U)}catch(nn){T=nn,bt===U&&U!==null&&(bt=U=U.return);continue}break}while(!0)}function wi(){var b=We.current;return We.current=hg,b===null?hg:b}function zn(){(dt===0||dt===3||dt===2)&&(dt=4),it===null||(Gt&268435455)===0&&(ft&268435455)===0||aa(it,pt)}function sa(b,T){var U=Ye;Ye|=2;var J=wi();(it!==b||pt!==T)&&(Yt=null,Mi(b,T));do try{as();break}catch(de){Ni(b,de)}while(!0);if(ld(),Ye=U,We.current=J,bt!==null)throw Error(r(261));return it=null,pt=0,dt}function as(){for(;bt!==null;)$s(bt)}function ji(){for(;bt!==null&&!ar();)$s(bt)}function $s(b){var T=Jp(b.alternate,b,kt);b.memoizedProps=b.pendingProps,T===null?Al(b):bt=T,Ke.current=null}function Al(b){var T=b;do{var U=T.alternate;if(b=T.return,(T.flags&32768)===0){if(U=gg(U,T,kt),U!==null){bt=U;return}}else{if(U=Vc(U,T),U!==null){U.flags&=32767,bt=U;return}if(b!==null)b.flags|=32768,b.subtreeFlags=0,b.deletions=null;else{dt=6,bt=null;return}}if(T=T.sibling,T!==null){bt=T;return}bt=T=b}while(T!==null);dt===0&&(dt=5)}function bs(b,T,U){var J=_i,de=Ge.transition;try{Ge.transition=null,_i=1,Ro(b,T,U,J)}finally{Ge.transition=de,_i=J}return null}function Ro(b,T,U,J){do Io();while(Or!==null);if((Ye&6)!==0)throw Error(r(327));U=b.finishedWork;var de=b.finishedLanes;if(U===null)return null;if(b.finishedWork=null,b.finishedLanes=0,U===b.current)throw Error(r(177));b.callbackNode=null,b.callbackPriority=0;var ge=U.lanes|U.childLanes;if(Ac(b,ge),b===it&&(bt=it=null,pt=0),(U.subtreeFlags&2064)===0&&(U.flags&2064)===0||Wr||(Wr=!0,vg(On,function(){return Io(),null})),ge=(U.flags&15990)!==0,(U.subtreeFlags&15990)!==0||ge){ge=Ge.transition,Ge.transition=null;var Ue=_i;_i=1;var yt=Ye;Ye|=4,Ke.current=null,Mf(b,U),_e(U,b),$m(Rp),qa=!!Op,Rp=Op=null,b.current=U,we(U),or(),Ye=yt,_i=Ue,Ge.transition=ge}else b.current=U;if(Wr&&(Wr=!1,Or=b,Lr=de),ge=b.pendingLanes,ge===0&&(_r=null),ja(U.stateNode),Sr(b,Ar()),T!==null)for(J=b.onRecoverableError,U=0;U<T.length;U++)de=T[U],J(de.value,{componentStack:de.stack,digest:de.digest});if(nr)throw nr=!1,b=yr,yr=null,b;return(Lr&1)!==0&&b.tag!==0&&Io(),ge=b.pendingLanes,(ge&1)!==0?b===Dn?Zr++:(Zr=0,Dn=b):Zr=0,Bl(),null}function Io(){if(Or!==null){var b=gp(Lr),T=Ge.transition,U=_i;try{if(Ge.transition=null,_i=16>b?16:b,Or===null)var J=!1;else{if(b=Or,Or=null,Lr=0,(Ye&6)!==0)throw Error(r(331));var de=Ye;for(Ye|=4,Vr=b.current;Vr!==null;){var ge=Vr,Ue=ge.child;if((Vr.flags&16)!==0){var yt=ge.deletions;if(yt!==null){for(var Nt=0;Nt<yt.length;Nt++){var Jt=yt[Nt];for(Vr=Jt;Vr!==null;){var Tr=Vr;switch(Tr.tag){case 0:case 11:case 15:g(8,Tr,ge)}var Mr=Tr.child;if(Mr!==null)Mr.return=Tr,Vr=Mr;else for(;Vr!==null;){Tr=Vr;var Pr=Tr.sibling,Qr=Tr.return;if(y(Tr),Tr===Jt){Vr=null;break}if(Pr!==null){Pr.return=Qr,Vr=Pr;break}Vr=Qr}}}var cn=ge.alternate;if(cn!==null){var dn=cn.child;if(dn!==null){cn.child=null;do{var ws=dn.sibling;dn.sibling=null,dn=ws}while(dn!==null)}}Vr=ge}}if((ge.subtreeFlags&2064)!==0&&Ue!==null)Ue.return=ge,Vr=Ue;else e:for(;Vr!==null;){if(ge=Vr,(ge.flags&2048)!==0)switch(ge.tag){case 0:case 11:case 15:g(9,ge,ge.return)}var qt=ge.sibling;if(qt!==null){qt.return=ge.return,Vr=qt;break e}Vr=ge.return}}var Ot=b.current;for(Vr=Ot;Vr!==null;){Ue=Vr;var Kt=Ue.child;if((Ue.subtreeFlags&2064)!==0&&Kt!==null)Kt.return=Ue,Vr=Kt;else e:for(Ue=Ot;Vr!==null;){if(yt=Vr,(yt.flags&2048)!==0)try{switch(yt.tag){case 0:case 11:case 15:o(9,yt)}}catch(nn){Oi(yt,yt.return,nn)}if(yt===Ue){Vr=null;break e}var Ir=yt.sibling;if(Ir!==null){Ir.return=yt.return,Vr=Ir;break e}Vr=yt.return}}if(Ye=de,Bl(),Rn&&typeof Rn.onPostCommitFiberRoot=="function")try{Rn.onPostCommitFiberRoot(Un,b)}catch{}J=!0}return J}finally{_i=U,Ge.transition=T}}return!1}function Tl(b,T,U){T=Fc(U,T),T=jf(b,T,1),b=fu(b,T,1),T=Yn(),b!==null&&(pl(b,1,T),Sr(b,T))}function Oi(b,T,U){if(b.tag===3)Tl(b,b,U);else for(;T!==null;){if(T.tag===3){Tl(T,b,U);break}else if(T.tag===1){var J=T.stateNode;if(typeof T.type.getDerivedStateFromError=="function"||typeof J.componentDidCatch=="function"&&(_r===null||!_r.has(J))){b=Fc(U,b),b=Hy(T,b,1),T=fu(T,b,1),b=Yn(),T!==null&&(pl(T,1,b),Sr(T,b));break}}T=T.return}}function wh(b,T,U){var J=b.pingCache;J!==null&&J.delete(T),T=Yn(),b.pingedLanes|=b.suspendedLanes&U,it===b&&(pt&U)===U&&(dt===4||dt===3&&(pt&130023424)===pt&&500>Ar()-$t?Mi(b,0):Ft|=U),Sr(b,T)}function dc(b,T){T===0&&((b.mode&1)===0?T=1:(T=Ml,Ml<<=1,(Ml&130023424)===0&&(Ml=4194304)));var U=Yn();b=Dc(b,T),b!==null&&(pl(b,T,U),Sr(b,U))}function Sh(b){var T=b.memoizedState,U=0;T!==null&&(U=T.retryLane),dc(b,U)}function Of(b,T){var U=0;switch(b.tag){case 13:var J=b.stateNode,de=b.memoizedState;de!==null&&(U=de.retryLane);break;case 19:J=b.stateNode;break;default:throw Error(r(314))}J!==null&&J.delete(T),dc(b,U)}var Jp;Jp=function(b,T,U){if(b!==null)if(b.memoizedProps!==T.pendingProps||Zo.current)mo=!0;else{if((b.lanes&U)===0&&(T.flags&128)===0)return mo=!1,_h(b,T,U);mo=(b.flags&131072)!==0}else mo=!1,ya&&(T.flags&1048576)!==0&&Er(T,Rc,T.index);switch(T.lanes=0,T.tag){case 2:var J=T.type;go(b,T),b=T.pendingProps;var de=sc(T,Us.current);er(T,U),de=Vp(null,T,J,b,de,U);var ge=mu();return T.flags|=1,typeof de=="object"&&de!==null&&typeof de.render=="function"&&de.$$typeof===void 0?(T.tag=1,T.memoizedState=null,T.updateQueue=null,Yo(J)?(ge=!0,nh(T)):ge=!1,T.memoizedState=de.state!==null&&de.state!==void 0?de.state:null,Fp(T),de.updater=pd,T.stateNode=de,de._reactInternals=T,$l(T,J,b,U),T=Zy(null,T,J,!0,ge,U)):(T.tag=0,ya&&ge&&Dp(T),eo(null,T,de,U),T=T.child),T;case 16:J=T.elementType;e:{switch(go(b,T),b=T.pendingProps,de=J._init,J=de(J._payload),T.type=J,de=T.tag=z2(J),b=uc(J,b),de){case 0:T=vu(null,T,J,b,U);break e;case 1:T=xu(null,T,J,b,U);break e;case 11:T=md(null,T,J,b,U);break e;case 14:T=gd(null,T,J,uc(J.type,b),U);break e}throw Error(r(306,J,""))}return T;case 0:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:uc(J,de),vu(b,T,J,de,U);case 1:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:uc(J,de),xu(b,T,J,de,U);case 3:e:{if(wv(T),b===null)throw Error(r(387));J=T.pendingProps,ge=T.memoizedState,de=ge.element,zy(b,T),rg(T,J,null,U);var Ue=T.memoizedState;if(J=Ue.element,ge.isDehydrated)if(ge={element:J,isDehydrated:!1,cache:Ue.cache,pendingSuspenseBoundaries:Ue.pendingSuspenseBoundaries,transitions:Ue.transitions},T.updateQueue.baseState=ge,T.memoizedState=ge,T.flags&256){de=Fc(Error(r(423)),T),T=Sv(b,T,J,U,de);break e}else if(J!==de){de=Fc(Error(r(424)),T),T=Sv(b,T,J,U,de);break e}else for(po=rd(T.stateNode.containerInfo.firstChild),xl=T,ya=!0,_l=null,U=zp(T,null,J,U),T.child=U;U;)U.flags=U.flags&-3|4096,U=U.sibling;else{if(wl(),J===de){T=rl(b,T,U);break e}eo(b,T,J,U)}T=T.child}return T;case 5:return zc(T),b===null&&yf(T),J=T.type,de=T.pendingProps,ge=b!==null?b.memoizedProps:null,Ue=de.children,pf(J,de)?Ue=null:ge!==null&&pf(J,ge)&&(T.flags|=32),yu(b,T),eo(b,T,Ue,U),T.child;case 6:return b===null&&yf(T),null;case 13:return to(b,T,U);case 4:return xf(T,T.stateNode.containerInfo),J=T.pendingProps,b===null?T.child=bi(T,null,J,U):eo(b,T,J,U),T.child;case 11:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:uc(J,de),md(b,T,J,de,U);case 7:return eo(b,T,T.pendingProps,U),T.child;case 8:return eo(b,T,T.pendingProps.children,U),T.child;case 12:return eo(b,T,T.pendingProps.children,U),T.child;case 10:e:{if(J=T.type._context,de=T.pendingProps,ge=T.memoizedProps,Ue=de.value,Qi(sd,J._currentValue),J._currentValue=Ue,ge!==null)if(Js(ge.value,Ue)){if(ge.children===de.children&&!Zo.current){T=rl(b,T,U);break e}}else for(ge=T.child,ge!==null&&(ge.return=T);ge!==null;){var yt=ge.dependencies;if(yt!==null){Ue=ge.child;for(var Nt=yt.firstContext;Nt!==null;){if(Nt.context===J){if(ge.tag===1){Nt=Lc(-1,U&-U),Nt.tag=2;var Jt=ge.updateQueue;if(Jt!==null){Jt=Jt.shared;var Tr=Jt.pending;Tr===null?Nt.next=Nt:(Nt.next=Tr.next,Tr.next=Nt),Jt.pending=Nt}}ge.lanes|=U,Nt=ge.alternate,Nt!==null&&(Nt.lanes|=U),ud(ge.return,U,T),yt.lanes|=U;break}Nt=Nt.next}}else if(ge.tag===10)Ue=ge.type===T.type?null:ge.child;else if(ge.tag===18){if(Ue=ge.return,Ue===null)throw Error(r(341));Ue.lanes|=U,yt=Ue.alternate,yt!==null&&(yt.lanes|=U),ud(Ue,U,T),Ue=ge.sibling}else Ue=ge.child;if(Ue!==null)Ue.return=ge;else for(Ue=ge;Ue!==null;){if(Ue===T){Ue=null;break}if(ge=Ue.sibling,ge!==null){ge.return=Ue.return,Ue=ge;break}Ue=Ue.return}ge=Ue}eo(b,T,de.children,U),T=T.child}return T;case 9:return de=T.type,J=T.pendingProps.children,er(T,U),de=fr(de),J=J(de),T.flags|=1,eo(b,T,J,U),T.child;case 14:return J=T.type,de=uc(J,T.pendingProps),de=uc(J.type,de),gd(b,T,J,de,U);case 15:return Bc(b,T,T.type,T.pendingProps,U);case 17:return J=T.type,de=T.pendingProps,de=T.elementType===J?de:uc(J,de),go(b,T),T.tag=1,Yo(J)?(b=!0,nh(T)):b=!1,er(T,U),Pf(T,J,de),$l(T,J,de,U),Zy(null,T,J,!0,b,U);case 19:return tl(b,T,U);case 22:return ql(b,T,U)}throw Error(r(156,T.tag))};function vg(b,T){return Pt(b,T)}function L2(b,T,U,J){this.tag=b,this.key=U,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=T,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=J,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Uc(b,T,U,J){return new L2(b,T,U,J)}function X_(b){return b=b.prototype,!(!b||!b.isReactComponent)}function z2(b){if(typeof b=="function")return X_(b)?1:0;if(b!=null){if(b=b.$$typeof,b===je)return 11;if(b===ze)return 14}return 2}function Ah(b,T){var U=b.alternate;return U===null?(U=Uc(b.tag,T,b.key,b.mode),U.elementType=b.elementType,U.type=b.type,U.stateNode=b.stateNode,U.alternate=b,b.alternate=U):(U.pendingProps=T,U.type=b.type,U.flags=0,U.subtreeFlags=0,U.deletions=null),U.flags=b.flags&14680064,U.childLanes=b.childLanes,U.lanes=b.lanes,U.child=b.child,U.memoizedProps=b.memoizedProps,U.memoizedState=b.memoizedState,U.updateQueue=b.updateQueue,T=b.dependencies,U.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext},U.sibling=b.sibling,U.index=b.index,U.ref=b.ref,U}function Yy(b,T,U,J,de,ge){var Ue=2;if(J=b,typeof b=="function")X_(b)&&(Ue=1);else if(typeof b=="string")Ue=5;else e:switch(b){case ce:return Rf(U.children,de,ge,T);case he:Ue=8,de|=8;break;case Pe:return b=Uc(12,U,T,de|2),b.elementType=Pe,b.lanes=ge,b;case xe:return b=Uc(13,U,T,de),b.elementType=xe,b.lanes=ge,b;case Ce:return b=Uc(19,U,T,de),b.elementType=Ce,b.lanes=ge,b;case Re:return Xy(U,de,ge,T);default:if(typeof b=="object"&&b!==null)switch(b.$$typeof){case Ne:Ue=10;break e;case pe:Ue=9;break e;case je:Ue=11;break e;case ze:Ue=14;break e;case Te:Ue=16,J=null;break e}throw Error(r(130,b==null?b:typeof b,""))}return T=Uc(Ue,U,T,de),T.elementType=b,T.type=J,T.lanes=ge,T}function Rf(b,T,U,J){return b=Uc(7,b,J,T),b.lanes=U,b}function Xy(b,T,U,J){return b=Uc(22,b,J,T),b.elementType=Re,b.lanes=U,b.stateNode={isHidden:!1},b}function Tv(b,T,U){return b=Uc(6,b,null,T),b.lanes=U,b}function Pv(b,T,U){return T=Uc(4,b.children!==null?b.children:[],b.key,T),T.lanes=U,T.stateNode={containerInfo:b.containerInfo,pendingChildren:null,implementation:b.implementation},T}function J_(b,T,U,J,de){this.tag=T,this.containerInfo=b,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=fl(0),this.expirationTimes=fl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fl(0),this.identifierPrefix=J,this.onRecoverableError=de,this.mutableSourceEagerHydrationData=null}function xd(b,T,U,J,de,ge,Ue,yt,Nt){return b=new J_(b,T,U,yt,Nt),T===1?(T=1,ge===!0&&(T|=8)):T=0,ge=Uc(3,null,null,T),b.current=ge,ge.stateNode=b,ge.memoizedState={element:J,isDehydrated:U,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fp(ge),b}function qs(b,T,U){var J=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:se,key:J==null?null:""+J,children:b,containerInfo:T,implementation:U}}function Q_(b){if(!b)return Fl;b=b._reactInternals;e:{if(Je(b)!==b||b.tag!==1)throw Error(r(170));var T=b;do{switch(T.tag){case 3:T=T.stateNode.context;break e;case 1:if(Yo(T.type)){T=T.stateNode.__reactInternalMemoizedMergedChildContext;break e}}T=T.return}while(T!==null);throw Error(r(171))}if(b.tag===1){var U=b.type;if(Yo(U))return Oy(b,U,T)}return T}function xg(b,T,U,J,de,ge,Ue,yt,Nt){return b=xd(U,J,!0,b,de,ge,Ue,yt,Nt),b.context=Q_(null),U=b.current,J=Yn(),de=Xr(U),ge=Lc(J,de),ge.callback=T??null,fu(U,ge,de),b.current.lanes=de,pl(b,de,J),Sr(b,J),b}function Nv(b,T,U,J){var de=T.current,ge=Yn(),Ue=Xr(de);return U=Q_(U),T.context===null?T.context=U:T.pendingContext=U,T=Lc(ge,Ue),T.payload={element:b},J=J===void 0?null:J,J!==null&&(T.callback=J),b=fu(de,T,Ue),b!==null&&(Sn(b,de,Ue,ge),pu(b,de,Ue)),Ue}function jv(b){if(b=b.current,!b.child)return null;switch(b.child.tag){case 5:return b.child.stateNode;default:return b.child.stateNode}}function _g(b,T){if(b=b.memoizedState,b!==null&&b.dehydrated!==null){var U=b.retryLane;b.retryLane=U!==0&&U<T?U:T}}function Cv(b,T){_g(b,T),(b=b.alternate)&&_g(b,T)}function Qp(){return null}var bg=typeof reportError=="function"?reportError:function(b){console.error(b)};function eb(b){this._internalRoot=b}kv.prototype.render=eb.prototype.render=function(b){var T=this._internalRoot;if(T===null)throw Error(r(409));Nv(b,T,null,null)},kv.prototype.unmount=eb.prototype.unmount=function(){var b=this._internalRoot;if(b!==null){this._internalRoot=null;var T=b.containerInfo;Is(function(){Nv(null,b,null,null)}),T[Ll]=null}};function kv(b){this._internalRoot=b}kv.prototype.unstable_scheduleHydration=function(b){if(b){var T=xy();b={blockedOn:null,target:b,priority:T};for(var U=0;U<fn.length&&T!==0&&T<fn[U].priority;U++);fn.splice(U,0,b),U===0&&Hn(b)}};function tb(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11)}function Ev(b){return!(!b||b.nodeType!==1&&b.nodeType!==9&&b.nodeType!==11&&(b.nodeType!==8||b.nodeValue!==" react-mount-point-unstable "))}function F2(){}function DN(b,T,U,J,de){if(de){if(typeof J=="function"){var ge=J;J=function(){var Jt=jv(Ue);ge.call(Jt)}}var Ue=xg(T,J,b,0,null,!1,!1,"",F2);return b._reactRootContainer=Ue,b[Ll]=Ue.current,hf(b.nodeType===8?b.parentNode:b),Is(),Ue}for(;de=b.lastChild;)b.removeChild(de);if(typeof J=="function"){var yt=J;J=function(){var Jt=jv(Nt);yt.call(Jt)}}var Nt=xd(b,0,!1,null,null,!1,!1,"",F2);return b._reactRootContainer=Nt,b[Ll]=Nt.current,hf(b.nodeType===8?b.parentNode:b),Is(function(){Nv(T,Nt,U,J)}),Nt}function Mv(b,T,U,J,de){var ge=U._reactRootContainer;if(ge){var Ue=ge;if(typeof de=="function"){var yt=de;de=function(){var Nt=jv(Ue);yt.call(Nt)}}Nv(T,Ue,b,de)}else Ue=DN(U,T,b,de,J);return jv(Ue)}Rm=function(b){switch(b.tag){case 3:var T=b.stateNode;if(T.current.memoizedState.isDehydrated){var U=Qc(T.pendingLanes);U!==0&&(ml(T,U|1),Sr(T,Ar()),(Ye&6)===0&&(zt=Ar()+500,Bl()))}break;case 13:Is(function(){var J=Dc(b,1);if(J!==null){var de=Yn();Sn(J,b,1,de)}}),Cv(b,1)}},Tc=function(b){if(b.tag===13){var T=Dc(b,134217728);if(T!==null){var U=Yn();Sn(T,b,134217728,U)}Cv(b,134217728)}},eu=function(b){if(b.tag===13){var T=Xr(b),U=Dc(b,T);if(U!==null){var J=Yn();Sn(U,b,T,J)}Cv(b,T)}},xy=function(){return _i},Im=function(b,T){var U=_i;try{return _i=b,T()}finally{_i=U}},Uu=function(b,T,U){switch(T){case"input":if(Jn(b,U),T=U.name,U.type==="radio"&&T!=null){for(U=b;U.parentNode;)U=U.parentNode;for(U=U.querySelectorAll("input[name="+JSON.stringify(""+T)+'][type="radio"]'),T=0;T<U.length;T++){var J=U[T];if(J!==b&&J.form===b.form){var de=gf(J);if(!de)throw Error(r(90));Dt(J),Jn(J,de)}}}break;case"textarea":ur(b,U);break;case"select":T=U.value,T!=null&&lr(b,!!U.multiple,T,!1)}},Cs=Sa,El=Is;var rb={usingClientEntryPoint:!1,Events:[rh,yl,gf,fa,Pa,Sa]},Jy={findFiberByHostInstance:id,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wg={bundleType:Jy.bundleType,version:Jy.version,rendererPackageName:Jy.rendererPackageName,rendererConfig:Jy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ae.ReactCurrentDispatcher,findHostInstanceByFiber:function(b){return b=St(b),b===null?null:b.stateNode},findFiberByHostInstance:Jy.findFiberByHostInstance||Qp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ov=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ov.isDisabled&&Ov.supportsFiber)try{Un=Ov.inject(wg),Rn=Ov}catch{}}return $c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rb,$c.createPortal=function(b,T){var U=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tb(T))throw Error(r(200));return qs(b,T,null,U)},$c.createRoot=function(b,T){if(!tb(b))throw Error(r(299));var U=!1,J="",de=bg;return T!=null&&(T.unstable_strictMode===!0&&(U=!0),T.identifierPrefix!==void 0&&(J=T.identifierPrefix),T.onRecoverableError!==void 0&&(de=T.onRecoverableError)),T=xd(b,1,!1,null,null,U,!1,J,de),b[Ll]=T.current,hf(b.nodeType===8?b.parentNode:b),new eb(T)},$c.findDOMNode=function(b){if(b==null)return null;if(b.nodeType===1)return b;var T=b._reactInternals;if(T===void 0)throw typeof b.render=="function"?Error(r(188)):(b=Object.keys(b).join(","),Error(r(268,b)));return b=St(T),b=b===null?null:b.stateNode,b},$c.flushSync=function(b){return Is(b)},$c.hydrate=function(b,T,U){if(!Ev(T))throw Error(r(200));return Mv(null,b,T,!0,U)},$c.hydrateRoot=function(b,T,U){if(!tb(b))throw Error(r(405));var J=U!=null&&U.hydratedSources||null,de=!1,ge="",Ue=bg;if(U!=null&&(U.unstable_strictMode===!0&&(de=!0),U.identifierPrefix!==void 0&&(ge=U.identifierPrefix),U.onRecoverableError!==void 0&&(Ue=U.onRecoverableError)),T=xg(T,null,b,1,U??null,de,!1,ge,Ue),b[Ll]=T.current,hf(b),J)for(b=0;b<J.length;b++)U=J[b],de=U._getVersion,de=de(U._source),T.mutableSourceEagerHydrationData==null?T.mutableSourceEagerHydrationData=[U,de]:T.mutableSourceEagerHydrationData.push(U,de);return new kv(T)},$c.render=function(b,T,U){if(!Ev(T))throw Error(r(200));return Mv(null,b,T,!1,U)},$c.unmountComponentAtNode=function(b){if(!Ev(b))throw Error(r(40));return b._reactRootContainer?(Is(function(){Mv(null,null,b,!1,function(){b._reactRootContainer=null,b[Ll]=null})}),!0):!1},$c.unstable_batchedUpdates=Sa,$c.unstable_renderSubtreeIntoContainer=function(b,T,U,J){if(!Ev(U))throw Error(r(200));if(b==null||b._reactInternals===void 0)throw Error(r(38));return Mv(b,T,U,!1,J)},$c.version="18.3.1-next-f1338f8080-20240426",$c}var SB;function RW(){if(SB)return Kj.exports;SB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Kj.exports=doe(),Kj.exports}var zw=RW();const IW=la(zw);function hoe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const foe=e=>{switch(e){case"success":return goe;case"info":return voe;case"warning":return yoe;case"error":return xoe;default:return null}},poe=Array(12).fill(0),moe=({visible:e,className:t})=>Oe.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Oe.createElement("div",{className:"sonner-spinner"},poe.map((r,n)=>Oe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),goe=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),yoe=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),voe=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),xoe=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Oe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),_oe=Oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Oe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Oe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),boe=()=>{const[e,t]=Oe.useState(document.hidden);return Oe.useEffect(()=>{const r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e};let XO=1;class woe{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;const{message:n,...a}=t,c=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:XO++,f=this.toasts.find(x=>x.id===c),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(c)&&this.dismissedToasts.delete(c),f?this.toasts=this.toasts.map(x=>x.id===c?(this.publish({...x,...t,id:c,title:n}),{...x,...t,id:c,dismissible:i,title:n}):x):this.addToast({title:n,...a,dismissible:i,id:c}),c},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:t,dismiss:!0}))),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const a=Promise.resolve(t instanceof Function?t():t);let c=n!==void 0,f;const i=a.then(async w=>{if(f=["resolve",w],Oe.isValidElement(w))c=!1,this.create({id:n,type:"default",message:w});else if(Aoe(w)&&!w.ok){c=!1;const P=typeof r.error=="function"?await r.error(`HTTP error! status: ${w.status}`):r.error,E=typeof r.description=="function"?await r.description(`HTTP error! status: ${w.status}`):r.description,D=typeof P=="object"?P:{message:P};this.create({id:n,type:"error",description:E,...D})}else if(w instanceof Error){c=!1;const P=typeof r.error=="function"?await r.error(w):r.error,E=typeof r.description=="function"?await r.description(w):r.description,D=typeof P=="object"?P:{message:P};this.create({id:n,type:"error",description:E,...D})}else if(r.success!==void 0){c=!1;const P=typeof r.success=="function"?await r.success(w):r.success,E=typeof r.description=="function"?await r.description(w):r.description,D=typeof P=="object"?P:{message:P};this.create({id:n,type:"success",description:E,...D})}}).catch(async w=>{if(f=["reject",w],r.error!==void 0){c=!1;const A=typeof r.error=="function"?await r.error(w):r.error,P=typeof r.description=="function"?await r.description(w):r.description,E=typeof A=="object"?A:{message:A};this.create({id:n,type:"error",description:P,...E})}}).finally(()=>{c&&(this.dismiss(n),n=void 0),r.finally==null||r.finally.call(r)}),x=()=>new Promise((w,A)=>i.then(()=>f[0]==="reject"?A(f[1]):w(f[1])).catch(A));return typeof n!="string"&&typeof n!="number"?{unwrap:x}:Object.assign(n,{unwrap:x})},this.custom=(t,r)=>{const n=(r==null?void 0:r.id)||XO++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Wc=new woe,Soe=(e,t)=>{const r=(t==null?void 0:t.id)||XO++;return Wc.addToast({title:e,...t,id:r}),r},Aoe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Toe=Soe,Poe=()=>Wc.toasts,Noe=()=>Wc.getActiveToasts(),Mn=Object.assign(Toe,{success:Wc.success,info:Wc.info,warning:Wc.warning,error:Wc.error,custom:Wc.custom,message:Wc.message,promise:Wc.promise,dismiss:Wc.dismiss,loading:Wc.loading},{getHistory:Poe,getToasts:Noe});hoe("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function PS(e){return e.label!==void 0}const joe=3,Coe="24px",koe="16px",AB=4e3,Eoe=356,Moe=14,Ooe=45,Roe=200;function Lf(...e){return e.filter(Boolean).join(" ")}function Ioe(e){const[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}const Doe=e=>{var t,r,n,a,c,f,i,x,w;const{invert:A,toast:P,unstyled:E,interacting:D,setHeights:V,visibleToasts:L,heights:$,index:H,toasts:K,expanded:Q,removeToast:ae,defaultRichColors:ee,closeButton:se,style:ce,cancelButtonStyle:he,actionButtonStyle:Pe,className:Ne="",descriptionClassName:pe="",duration:je,position:xe,gap:Ce,expandByDefault:ze,classNames:Te,icons:Re,closeButtonAriaLabel:Fe="Close toast"}=e,[He,mt]=Oe.useState(null),[Xe,ot]=Oe.useState(null),[qe,Lt]=Oe.useState(!1),[Zt,Xt]=Oe.useState(!1),[rr,ir]=Oe.useState(!1),[Bt,De]=Oe.useState(!1),[jr,Dt]=Oe.useState(!1),[Cr,At]=Oe.useState(0),[qr,an]=Oe.useState(0),Jn=Oe.useRef(P.duration||je||AB),tt=Oe.useRef(null),xt=Oe.useRef(null),Mt=H===0,lr=H+1<=L,cr=P.type,xr=P.dismissible!==!1,ur=P.className||"",tn=P.descriptionClassName||"",Gn=Oe.useMemo(()=>$.findIndex(Wn=>Wn.toastId===P.id)||0,[$,P.id]),gi=Oe.useMemo(()=>{var Wn;return(Wn=P.closeButton)!=null?Wn:se},[P.closeButton,se]),Ui=Oe.useMemo(()=>P.duration||je||AB,[P.duration,je]),uo=Oe.useRef(0),Va=Oe.useRef(0),Ks=Oe.useRef(0),To=Oe.useRef(null),[es,rc]=xe.split("-"),kl=Oe.useMemo(()=>$.reduce((Wn,fa,Pa)=>Pa>=Gn?Wn:Wn+fa.height,0),[$,Gn]),Fs=boe(),nc=P.invert||A,sn=cr==="loading";Va.current=Oe.useMemo(()=>Gn*Ce+kl,[Gn,kl]),Oe.useEffect(()=>{Jn.current=Ui},[Ui]),Oe.useEffect(()=>{Lt(!0)},[]),Oe.useEffect(()=>{const Wn=xt.current;if(Wn){const fa=Wn.getBoundingClientRect().height;return an(fa),V(Pa=>[{toastId:P.id,height:fa,position:P.position},...Pa]),()=>V(Pa=>Pa.filter(Cs=>Cs.toastId!==P.id))}},[V,P.id]),Oe.useLayoutEffect(()=>{if(!qe)return;const Wn=xt.current,fa=Wn.style.height;Wn.style.height="auto";const Pa=Wn.getBoundingClientRect().height;Wn.style.height=fa,an(Pa),V(Cs=>Cs.find(Na=>Na.toastId===P.id)?Cs.map(Na=>Na.toastId===P.id?{...Na,height:Pa}:Na):[{toastId:P.id,height:Pa,position:P.position},...Cs])},[qe,P.title,P.description,V,P.id]);const ts=Oe.useCallback(()=>{Xt(!0),At(Va.current),V(Wn=>Wn.filter(fa=>fa.toastId!==P.id)),setTimeout(()=>{ae(P)},Roe)},[P,ae,V,Va]);Oe.useEffect(()=>{if(P.promise&&cr==="loading"||P.duration===1/0||P.type==="loading")return;let Wn;return Q||D||Fs?(()=>{if(Ks.current<uo.current){const Cs=new Date().getTime()-uo.current;Jn.current=Jn.current-Cs}Ks.current=new Date().getTime()})():(()=>{Jn.current!==1/0&&(uo.current=new Date().getTime(),Wn=setTimeout(()=>{P.onAutoClose==null||P.onAutoClose.call(P,P),ts()},Jn.current))})(),()=>clearTimeout(Wn)},[Q,D,P,cr,Fs,ts]),Oe.useEffect(()=>{P.delete&&ts()},[ts,P.delete]);function Uu(){var Wn;if(Re!=null&&Re.loading){var fa;return Oe.createElement("div",{className:Lf(Te==null?void 0:Te.loader,P==null||(fa=P.classNames)==null?void 0:fa.loader,"sonner-loader"),"data-visible":cr==="loading"},Re.loading)}return Oe.createElement(moe,{className:Lf(Te==null?void 0:Te.loader,P==null||(Wn=P.classNames)==null?void 0:Wn.loader),visible:cr==="loading"})}var Ua,Zs;return Oe.createElement("li",{tabIndex:0,ref:xt,className:Lf(Ne,ur,Te==null?void 0:Te.toast,P==null||(t=P.classNames)==null?void 0:t.toast,Te==null?void 0:Te.default,Te==null?void 0:Te[cr],P==null||(r=P.classNames)==null?void 0:r[cr]),"data-sonner-toast":"","data-rich-colors":(Ua=P.richColors)!=null?Ua:ee,"data-styled":!(P.jsx||P.unstyled||E),"data-mounted":qe,"data-promise":!!P.promise,"data-swiped":jr,"data-removed":Zt,"data-visible":lr,"data-y-position":es,"data-x-position":rc,"data-index":H,"data-front":Mt,"data-swiping":rr,"data-dismissible":xr,"data-type":cr,"data-invert":nc,"data-swipe-out":Bt,"data-swipe-direction":Xe,"data-expanded":!!(Q||ze&&qe),style:{"--index":H,"--toasts-before":H,"--z-index":K.length-H,"--offset":`${Zt?Cr:Va.current}px`,"--initial-height":ze?"auto":`${qr}px`,...ce,...P.style},onDragEnd:()=>{ir(!1),mt(null),To.current=null},onPointerDown:Wn=>{sn||!xr||(tt.current=new Date,At(Va.current),Wn.target.setPointerCapture(Wn.pointerId),Wn.target.tagName!=="BUTTON"&&(ir(!0),To.current={x:Wn.clientX,y:Wn.clientY}))},onPointerUp:()=>{var Wn,fa,Pa;if(Bt||!xr)return;To.current=null;const Cs=Number(((Wn=xt.current)==null?void 0:Wn.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),El=Number(((fa=xt.current)==null?void 0:fa.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Na=new Date().getTime()-((Pa=tt.current)==null?void 0:Pa.getTime()),Bs=He==="x"?Cs:El,$i=Math.abs(Bs)/Na;if(Math.abs(Bs)>=Ooe||$i>.11){At(Va.current),P.onDismiss==null||P.onDismiss.call(P,P),ot(He==="x"?Cs>0?"right":"left":El>0?"down":"up"),ts(),De(!0);return}else{var ks,ms;(ks=xt.current)==null||ks.style.setProperty("--swipe-amount-x","0px"),(ms=xt.current)==null||ms.style.setProperty("--swipe-amount-y","0px")}Dt(!1),ir(!1),mt(null)},onPointerMove:Wn=>{var fa,Pa,Cs;if(!To.current||!xr||((fa=window.getSelection())==null?void 0:fa.toString().length)>0)return;const Na=Wn.clientY-To.current.y,Bs=Wn.clientX-To.current.x;var $i;const ks=($i=e.swipeDirections)!=null?$i:Ioe(xe);!He&&(Math.abs(Bs)>1||Math.abs(Na)>1)&&mt(Math.abs(Bs)>Math.abs(Na)?"x":"y");let ms={x:0,y:0};const $u=Ki=>1/(1.5+Math.abs(Ki)/20);if(He==="y"){if(ks.includes("top")||ks.includes("bottom"))if(ks.includes("top")&&Na<0||ks.includes("bottom")&&Na>0)ms.y=Na;else{const Ki=Na*$u(Na);ms.y=Math.abs(Ki)<Math.abs(Na)?Ki:Na}}else if(He==="x"&&(ks.includes("left")||ks.includes("right")))if(ks.includes("left")&&Bs<0||ks.includes("right")&&Bs>0)ms.x=Bs;else{const Ki=Bs*$u(Bs);ms.x=Math.abs(Ki)<Math.abs(Bs)?Ki:Bs}(Math.abs(ms.x)>0||Math.abs(ms.y)>0)&&Dt(!0),(Pa=xt.current)==null||Pa.style.setProperty("--swipe-amount-x",`${ms.x}px`),(Cs=xt.current)==null||Cs.style.setProperty("--swipe-amount-y",`${ms.y}px`)}},gi&&!P.jsx&&cr!=="loading"?Oe.createElement("button",{"aria-label":Fe,"data-disabled":sn,"data-close-button":!0,onClick:sn||!xr?()=>{}:()=>{ts(),P.onDismiss==null||P.onDismiss.call(P,P)},className:Lf(Te==null?void 0:Te.closeButton,P==null||(n=P.classNames)==null?void 0:n.closeButton)},(Zs=Re==null?void 0:Re.close)!=null?Zs:_oe):null,cr||P.icon||P.promise?Oe.createElement("div",{"data-icon":"",className:Lf(Te==null?void 0:Te.icon,P==null||(a=P.classNames)==null?void 0:a.icon)},P.promise||P.type==="loading"&&!P.icon?P.icon||Uu():null,P.type!=="loading"?P.icon||(Re==null?void 0:Re[cr])||foe(cr):null):null,Oe.createElement("div",{"data-content":"",className:Lf(Te==null?void 0:Te.content,P==null||(c=P.classNames)==null?void 0:c.content)},Oe.createElement("div",{"data-title":"",className:Lf(Te==null?void 0:Te.title,P==null||(f=P.classNames)==null?void 0:f.title)},P.jsx?P.jsx:typeof P.title=="function"?P.title():P.title),P.description?Oe.createElement("div",{"data-description":"",className:Lf(pe,tn,Te==null?void 0:Te.description,P==null||(i=P.classNames)==null?void 0:i.description)},typeof P.description=="function"?P.description():P.description):null),Oe.isValidElement(P.cancel)?P.cancel:P.cancel&&PS(P.cancel)?Oe.createElement("button",{"data-button":!0,"data-cancel":!0,style:P.cancelButtonStyle||he,onClick:Wn=>{PS(P.cancel)&&xr&&(P.cancel.onClick==null||P.cancel.onClick.call(P.cancel,Wn),ts())},className:Lf(Te==null?void 0:Te.cancelButton,P==null||(x=P.classNames)==null?void 0:x.cancelButton)},P.cancel.label):null,Oe.isValidElement(P.action)?P.action:P.action&&PS(P.action)?Oe.createElement("button",{"data-button":!0,"data-action":!0,style:P.actionButtonStyle||Pe,onClick:Wn=>{PS(P.action)&&(P.action.onClick==null||P.action.onClick.call(P.action,Wn),!Wn.defaultPrevented&&ts())},className:Lf(Te==null?void 0:Te.actionButton,P==null||(w=P.classNames)==null?void 0:w.actionButton)},P.action.label):null)};function TB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Loe(e,t){const r={};return[e,t].forEach((n,a)=>{const c=a===1,f=c?"--mobile-offset":"--offset",i=c?koe:Coe;function x(w){["top","right","bottom","left"].forEach(A=>{r[`${f}-${A}`]=typeof w=="number"?`${w}px`:w})}typeof n=="number"||typeof n=="string"?x(n):typeof n=="object"?["top","right","bottom","left"].forEach(w=>{n[w]===void 0?r[`${f}-${w}`]=i:r[`${f}-${w}`]=typeof n[w]=="number"?`${n[w]}px`:n[w]}):x(i)}),r}const zoe=Oe.forwardRef(function(t,r){const{invert:n,position:a="bottom-right",hotkey:c=["altKey","KeyT"],expand:f,closeButton:i,className:x,offset:w,mobileOffset:A,theme:P="light",richColors:E,duration:D,style:V,visibleToasts:L=joe,toastOptions:$,dir:H=TB(),gap:K=Moe,icons:Q,containerAriaLabel:ae="Notifications"}=t,[ee,se]=Oe.useState([]),ce=Oe.useMemo(()=>Array.from(new Set([a].concat(ee.filter(Xe=>Xe.position).map(Xe=>Xe.position)))),[ee,a]),[he,Pe]=Oe.useState([]),[Ne,pe]=Oe.useState(!1),[je,xe]=Oe.useState(!1),[Ce,ze]=Oe.useState(P!=="system"?P:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Te=Oe.useRef(null),Re=c.join("+").replace(/Key/g,"").replace(/Digit/g,""),Fe=Oe.useRef(null),He=Oe.useRef(!1),mt=Oe.useCallback(Xe=>{se(ot=>{var qe;return(qe=ot.find(Lt=>Lt.id===Xe.id))!=null&&qe.delete||Wc.dismiss(Xe.id),ot.filter(({id:Lt})=>Lt!==Xe.id)})},[]);return Oe.useEffect(()=>Wc.subscribe(Xe=>{if(Xe.dismiss){const ot=ee.map(qe=>qe.id===Xe.id?{...qe,delete:!0}:qe);requestAnimationFrame(()=>{se(ot)});return}setTimeout(()=>{IW.flushSync(()=>{se(ot=>{const qe=ot.findIndex(Lt=>Lt.id===Xe.id);return qe!==-1?[...ot.slice(0,qe),{...ot[qe],...Xe},...ot.slice(qe+1)]:[Xe,...ot]})})})}),[ee]),Oe.useEffect(()=>{if(P!=="system"){ze(P);return}if(P==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ze("dark"):ze("light")),typeof window>"u")return;const Xe=window.matchMedia("(prefers-color-scheme: dark)");try{Xe.addEventListener("change",({matches:ot})=>{ze(ot?"dark":"light")})}catch{Xe.addListener(({matches:qe})=>{try{ze(qe?"dark":"light")}catch(Lt){console.error(Lt)}})}},[P]),Oe.useEffect(()=>{ee.length<=1&&pe(!1)},[ee]),Oe.useEffect(()=>{const Xe=ot=>{var qe;if(c.every(Xt=>ot[Xt]||ot.code===Xt)){var Zt;pe(!0),(Zt=Te.current)==null||Zt.focus()}ot.code==="Escape"&&(document.activeElement===Te.current||(qe=Te.current)!=null&&qe.contains(document.activeElement))&&pe(!1)};return document.addEventListener("keydown",Xe),()=>document.removeEventListener("keydown",Xe)},[c]),Oe.useEffect(()=>{if(Te.current)return()=>{Fe.current&&(Fe.current.focus({preventScroll:!0}),Fe.current=null,He.current=!1)}},[Te.current]),Oe.createElement("section",{ref:r,"aria-label":`${ae} ${Re}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},ce.map((Xe,ot)=>{var qe;const[Lt,Zt]=Xe.split("-");return ee.length?Oe.createElement("ol",{key:Xe,dir:H==="auto"?TB():H,tabIndex:-1,ref:Te,className:x,"data-sonner-toaster":!0,"data-sonner-theme":Ce,"data-y-position":Lt,"data-lifted":Ne&&ee.length>1&&!f,"data-x-position":Zt,style:{"--front-toast-height":`${((qe=he[0])==null?void 0:qe.height)||0}px`,"--width":`${Eoe}px`,"--gap":`${K}px`,...V,...Loe(w,A)},onBlur:Xt=>{He.current&&!Xt.currentTarget.contains(Xt.relatedTarget)&&(He.current=!1,Fe.current&&(Fe.current.focus({preventScroll:!0}),Fe.current=null))},onFocus:Xt=>{Xt.target instanceof HTMLElement&&Xt.target.dataset.dismissible==="false"||He.current||(He.current=!0,Fe.current=Xt.relatedTarget)},onMouseEnter:()=>pe(!0),onMouseMove:()=>pe(!0),onMouseLeave:()=>{je||pe(!1)},onDragEnd:()=>pe(!1),onPointerDown:Xt=>{Xt.target instanceof HTMLElement&&Xt.target.dataset.dismissible==="false"||xe(!0)},onPointerUp:()=>xe(!1)},ee.filter(Xt=>!Xt.position&&ot===0||Xt.position===Xe).map((Xt,rr)=>{var ir,Bt;return Oe.createElement(Doe,{key:Xt.id,icons:Q,index:rr,toast:Xt,defaultRichColors:E,duration:(ir=$==null?void 0:$.duration)!=null?ir:D,className:$==null?void 0:$.className,descriptionClassName:$==null?void 0:$.descriptionClassName,invert:n,visibleToasts:L,closeButton:(Bt=$==null?void 0:$.closeButton)!=null?Bt:i,interacting:je,position:Xe,style:$==null?void 0:$.style,unstyled:$==null?void 0:$.unstyled,classNames:$==null?void 0:$.classNames,cancelButtonStyle:$==null?void 0:$.cancelButtonStyle,actionButtonStyle:$==null?void 0:$.actionButtonStyle,closeButtonAriaLabel:$==null?void 0:$.closeButtonAriaLabel,removeToast:mt,toasts:ee.filter(De=>De.position==Xt.position),heights:he.filter(De=>De.position==Xt.position),setHeights:Pe,expandByDefault:f,gap:K,expanded:Ne,swipeDirections:t.swipeDirections})})):null}))}),Foe=({...e})=>{const{theme:t="system"}=loe();return l.jsx(zoe,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Ob={},PB;function Boe(){if(PB)return Ob;PB=1,Object.defineProperty(Ob,"__esModule",{value:!0}),Ob.parse=f,Ob.serialize=w;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,c=(()=>{const E=function(){};return E.prototype=Object.create(null),E})();function f(E,D){const V=new c,L=E.length;if(L<2)return V;const $=(D==null?void 0:D.decode)||A;let H=0;do{const K=E.indexOf("=",H);if(K===-1)break;const Q=E.indexOf(";",H),ae=Q===-1?L:Q;if(K>ae){H=E.lastIndexOf(";",K-1)+1;continue}const ee=i(E,H,K),se=x(E,K,ee),ce=E.slice(ee,se);if(V[ce]===void 0){let he=i(E,K+1,ae),Pe=x(E,ae,he);const Ne=$(E.slice(he,Pe));V[ce]=Ne}H=ae+1}while(H<L);return V}function i(E,D,V){do{const L=E.charCodeAt(D);if(L!==32&&L!==9)return D}while(++D<V);return V}function x(E,D,V){for(;D>V;){const L=E.charCodeAt(--D);if(L!==32&&L!==9)return D+1}return V}function w(E,D,V){const L=(V==null?void 0:V.encode)||encodeURIComponent;if(!e.test(E))throw new TypeError(`argument name is invalid: ${E}`);const $=L(D);if(!t.test($))throw new TypeError(`argument val is invalid: ${D}`);let H=E+"="+$;if(!V)return H;if(V.maxAge!==void 0){if(!Number.isInteger(V.maxAge))throw new TypeError(`option maxAge is invalid: ${V.maxAge}`);H+="; Max-Age="+V.maxAge}if(V.domain){if(!r.test(V.domain))throw new TypeError(`option domain is invalid: ${V.domain}`);H+="; Domain="+V.domain}if(V.path){if(!n.test(V.path))throw new TypeError(`option path is invalid: ${V.path}`);H+="; Path="+V.path}if(V.expires){if(!P(V.expires)||!Number.isFinite(V.expires.valueOf()))throw new TypeError(`option expires is invalid: ${V.expires}`);H+="; Expires="+V.expires.toUTCString()}if(V.httpOnly&&(H+="; HttpOnly"),V.secure&&(H+="; Secure"),V.partitioned&&(H+="; Partitioned"),V.priority)switch(typeof V.priority=="string"?V.priority.toLowerCase():void 0){case"low":H+="; Priority=Low";break;case"medium":H+="; Priority=Medium";break;case"high":H+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${V.priority}`)}if(V.sameSite)switch(typeof V.sameSite=="string"?V.sameSite.toLowerCase():V.sameSite){case!0:case"strict":H+="; SameSite=Strict";break;case"lax":H+="; SameSite=Lax";break;case"none":H+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${V.sameSite}`)}return H}function A(E){if(E.indexOf("%")===-1)return E;try{return decodeURIComponent(E)}catch{return E}}function P(E){return a.call(E)==="[object Date]"}return Ob}Boe();/**
 * react-router v7.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var NB="popstate";function Voe(e={}){function t(n,a){let{pathname:c,search:f,hash:i}=n.location;return JO("",{pathname:c,search:f,hash:i},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:A1(a)}return $oe(t,r,null,e)}function js(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function $h(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Uoe(){return Math.random().toString(36).substring(2,10)}function jB(e,t){return{usr:e.state,key:e.key,idx:t}}function JO(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?f_(t):t,state:r,key:t&&t.key||n||Uoe()}}function A1({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function f_(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function $oe(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:c=!1}=n,f=a.history,i="POP",x=null,w=A();w==null&&(w=0,f.replaceState({...f.state,idx:w},""));function A(){return(f.state||{idx:null}).idx}function P(){i="POP";let $=A(),H=$==null?null:$-w;w=$,x&&x({action:i,location:L.location,delta:H})}function E($,H){i="PUSH";let K=JO(L.location,$,H);w=A()+1;let Q=jB(K,w),ae=L.createHref(K);try{f.pushState(Q,"",ae)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;a.location.assign(ae)}c&&x&&x({action:i,location:L.location,delta:1})}function D($,H){i="REPLACE";let K=JO(L.location,$,H);w=A();let Q=jB(K,w),ae=L.createHref(K);f.replaceState(Q,"",ae),c&&x&&x({action:i,location:L.location,delta:0})}function V($){let H=a.location.origin!=="null"?a.location.origin:a.location.href,K=typeof $=="string"?$:A1($);return K=K.replace(/ $/,"%20"),js(H,`No window.location.(origin|href) available to create URL for href: ${K}`),new URL(K,H)}let L={get action(){return i},get location(){return e(a,f)},listen($){if(x)throw new Error("A history only accepts one active listener");return a.addEventListener(NB,P),x=$,()=>{a.removeEventListener(NB,P),x=null}},createHref($){return t(a,$)},createURL:V,encodeLocation($){let H=V($);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:E,replace:D,go($){return f.go($)}};return L}function DW(e,t,r="/"){return qoe(e,t,r,!1)}function qoe(e,t,r,n){let a=typeof t=="string"?f_(t):t,c=ym(a.pathname||"/",r);if(c==null)return null;let f=LW(e);Goe(f);let i=null;for(let x=0;i==null&&x<f.length;++x){let w=rle(c);i=ele(f[x],w,n)}return i}function LW(e,t=[],r=[],n=""){let a=(c,f,i)=>{let x={relativePath:i===void 0?c.path||"":i,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};x.relativePath.startsWith("/")&&(js(x.relativePath.startsWith(n),`Absolute route path "${x.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(n.length));let w=hm([n,x.relativePath]),A=r.concat(x);c.children&&c.children.length>0&&(js(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),LW(c.children,t,A,w)),!(c.path==null&&!c.index)&&t.push({path:w,score:Joe(w,c.index),routesMeta:A})};return e.forEach((c,f)=>{var i;if(c.path===""||!((i=c.path)!=null&&i.includes("?")))a(c,f);else for(let x of zW(c.path))a(c,f,x)}),t}function zW(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),c=r.replace(/\?$/,"");if(n.length===0)return a?[c,""]:[c];let f=zW(n.join("/")),i=[];return i.push(...f.map(x=>x===""?c:[c,x].join("/"))),a&&i.push(...f),i.map(x=>e.startsWith("/")&&x===""?"/":x)}function Goe(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Qoe(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var Woe=/^:[\w-]+$/,Hoe=3,Koe=2,Zoe=1,Yoe=10,Xoe=-2,CB=e=>e==="*";function Joe(e,t){let r=e.split("/"),n=r.length;return r.some(CB)&&(n+=Xoe),t&&(n+=Koe),r.filter(a=>!CB(a)).reduce((a,c)=>a+(Woe.test(c)?Hoe:c===""?Zoe:Yoe),n)}function Qoe(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function ele(e,t,r=!1){let{routesMeta:n}=e,a={},c="/",f=[];for(let i=0;i<n.length;++i){let x=n[i],w=i===n.length-1,A=c==="/"?t:t.slice(c.length)||"/",P=jA({path:x.relativePath,caseSensitive:x.caseSensitive,end:w},A),E=x.route;if(!P&&w&&r&&!n[n.length-1].route.index&&(P=jA({path:x.relativePath,caseSensitive:x.caseSensitive,end:!1},A)),!P)return null;Object.assign(a,P.params),f.push({params:a,pathname:hm([c,P.pathname]),pathnameBase:sle(hm([c,P.pathnameBase])),route:E}),P.pathnameBase!=="/"&&(c=hm([c,P.pathnameBase]))}return f}function jA(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=tle(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let c=a[0],f=c.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:n.reduce((w,{paramName:A,isOptional:P},E)=>{if(A==="*"){let V=i[E]||"";f=c.slice(0,c.length-V.length).replace(/(.)\/+$/,"$1")}const D=i[E];return P&&!D?w[A]=void 0:w[A]=(D||"").replace(/%2F/g,"/"),w},{}),pathname:c,pathnameBase:f,pattern:e}}function tle(e,t=!1,r=!0){$h(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(f,i,x)=>(n.push({paramName:i,isOptional:x!=null}),x?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function rle(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return $h(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ym(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function nle(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?f_(e):e;return{pathname:r?r.startsWith("/")?r:ile(r,t):t,search:ole(n),hash:lle(a)}}function ile(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Xj(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ale(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function V3(e){let t=ale(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function U3(e,t,r,n=!1){let a;typeof e=="string"?a=f_(e):(a={...e},js(!a.pathname||!a.pathname.includes("?"),Xj("?","pathname","search",a)),js(!a.pathname||!a.pathname.includes("#"),Xj("#","pathname","hash",a)),js(!a.search||!a.search.includes("#"),Xj("#","search","hash",a)));let c=e===""||a.pathname==="",f=c?"/":a.pathname,i;if(f==null)i=r;else{let P=t.length-1;if(!n&&f.startsWith("..")){let E=f.split("/");for(;E[0]==="..";)E.shift(),P-=1;a.pathname=E.join("/")}i=P>=0?t[P]:"/"}let x=nle(a,i),w=f&&f!=="/"&&f.endsWith("/"),A=(c||f===".")&&r.endsWith("/");return!x.pathname.endsWith("/")&&(w||A)&&(x.pathname+="/"),x}var hm=e=>e.join("/").replace(/\/\/+/g,"/"),sle=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ole=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,lle=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function cle(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var FW=["POST","PUT","PATCH","DELETE"];new Set(FW);var ule=["GET",...FW];new Set(ule);var p_=W.createContext(null);p_.displayName="DataRouter";var fP=W.createContext(null);fP.displayName="DataRouterState";var BW=W.createContext({isTransitioning:!1});BW.displayName="ViewTransition";var dle=W.createContext(new Map);dle.displayName="Fetchers";var hle=W.createContext(null);hle.displayName="Await";var Xh=W.createContext(null);Xh.displayName="Navigation";var Fw=W.createContext(null);Fw.displayName="Location";var Bd=W.createContext({outlet:null,matches:[],isDataRoute:!1});Bd.displayName="Route";var $3=W.createContext(null);$3.displayName="RouteError";function fle(e,{relative:t}={}){js(m_(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=W.useContext(Xh),{hash:a,pathname:c,search:f}=Bw(e,{relative:t}),i=c;return r!=="/"&&(i=c==="/"?r:hm([r,c])),n.createHref({pathname:i,search:f,hash:a})}function m_(){return W.useContext(Fw)!=null}function co(){return js(m_(),"useLocation() may be used only in the context of a <Router> component."),W.useContext(Fw).location}var VW="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function UW(e){W.useContext(Xh).static||W.useLayoutEffect(e)}function wa(){let{isDataRoute:e}=W.useContext(Bd);return e?jle():ple()}function ple(){js(m_(),"useNavigate() may be used only in the context of a <Router> component.");let e=W.useContext(p_),{basename:t,navigator:r}=W.useContext(Xh),{matches:n}=W.useContext(Bd),{pathname:a}=co(),c=JSON.stringify(V3(n)),f=W.useRef(!1);return UW(()=>{f.current=!0}),W.useCallback((x,w={})=>{if($h(f.current,VW),!f.current)return;if(typeof x=="number"){r.go(x);return}let A=U3(x,JSON.parse(c),a,w.relative==="path");e==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:hm([t,A.pathname])),(w.replace?r.replace:r.push)(A,w.state,w)},[t,r,c,a,e])}var mle=W.createContext(null);function gle(e){let t=W.useContext(Bd).outlet;return t&&W.createElement(mle.Provider,{value:e},t)}function oy(){let{matches:e}=W.useContext(Bd),t=e[e.length-1];return t?t.params:{}}function Bw(e,{relative:t}={}){let{matches:r}=W.useContext(Bd),{pathname:n}=co(),a=JSON.stringify(V3(r));return W.useMemo(()=>U3(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function yle(e,t){return $W(e,t)}function $W(e,t,r,n){var K;js(m_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:c}=W.useContext(Xh),{matches:f}=W.useContext(Bd),i=f[f.length-1],x=i?i.params:{},w=i?i.pathname:"/",A=i?i.pathnameBase:"/",P=i&&i.route;{let Q=P&&P.path||"";qW(w,!P||Q.endsWith("*")||Q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${Q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${Q}"> to <Route path="${Q==="/"?"*":`${Q}/*`}">.`)}let E=co(),D;if(t){let Q=typeof t=="string"?f_(t):t;js(A==="/"||((K=Q.pathname)==null?void 0:K.startsWith(A)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${Q.pathname}" was given in the \`location\` prop.`),D=Q}else D=E;let V=D.pathname||"/",L=V;if(A!=="/"){let Q=A.replace(/^\//,"").split("/");L="/"+V.replace(/^\//,"").split("/").slice(Q.length).join("/")}let $=!c&&r&&r.matches&&r.matches.length>0?r.matches:DW(e,{pathname:L});$h(P||$!=null,`No routes matched location "${D.pathname}${D.search}${D.hash}" `),$h($==null||$[$.length-1].route.element!==void 0||$[$.length-1].route.Component!==void 0||$[$.length-1].route.lazy!==void 0,`Matched leaf route at location "${D.pathname}${D.search}${D.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=wle($&&$.map(Q=>Object.assign({},Q,{params:Object.assign({},x,Q.params),pathname:hm([A,a.encodeLocation?a.encodeLocation(Q.pathname).pathname:Q.pathname]),pathnameBase:Q.pathnameBase==="/"?A:hm([A,a.encodeLocation?a.encodeLocation(Q.pathnameBase).pathname:Q.pathnameBase])})),f,r,n);return t&&H?W.createElement(Fw.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...D},navigationType:"POP"}},H):H}function vle(){let e=Nle(),t=cle(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},c={padding:"2px 4px",backgroundColor:n},f=null;return console.error("Error handled by React Router default ErrorBoundary:",e),f=W.createElement(W.Fragment,null,W.createElement("p",null,"💿 Hey developer 👋"),W.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",W.createElement("code",{style:c},"ErrorBoundary")," or"," ",W.createElement("code",{style:c},"errorElement")," prop on your route.")),W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},t),r?W.createElement("pre",{style:a},r):null,f)}var xle=W.createElement(vle,null),_le=class extends W.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?W.createElement(Bd.Provider,{value:this.props.routeContext},W.createElement($3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ble({routeContext:e,match:t,children:r}){let n=W.useContext(p_);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),W.createElement(Bd.Provider,{value:e},r)}function wle(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,c=r==null?void 0:r.errors;if(c!=null){let x=a.findIndex(w=>w.route.id&&(c==null?void 0:c[w.route.id])!==void 0);js(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),a=a.slice(0,Math.min(a.length,x+1))}let f=!1,i=-1;if(r)for(let x=0;x<a.length;x++){let w=a[x];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(i=x),w.route.id){let{loaderData:A,errors:P}=r,E=w.route.loader&&!A.hasOwnProperty(w.route.id)&&(!P||P[w.route.id]===void 0);if(w.route.lazy||E){f=!0,i>=0?a=a.slice(0,i+1):a=[a[0]];break}}}return a.reduceRight((x,w,A)=>{let P,E=!1,D=null,V=null;r&&(P=c&&w.route.id?c[w.route.id]:void 0,D=w.route.errorElement||xle,f&&(i<0&&A===0?(qW("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,V=null):i===A&&(E=!0,V=w.route.hydrateFallbackElement||null)));let L=t.concat(a.slice(0,A+1)),$=()=>{let H;return P?H=D:E?H=V:w.route.Component?H=W.createElement(w.route.Component,null):w.route.element?H=w.route.element:H=x,W.createElement(ble,{match:w,routeContext:{outlet:x,matches:L,isDataRoute:r!=null},children:H})};return r&&(w.route.ErrorBoundary||w.route.errorElement||A===0)?W.createElement(_le,{location:r.location,revalidation:r.revalidation,component:D,error:P,children:$(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):$()},null)}function q3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Sle(e){let t=W.useContext(p_);return js(t,q3(e)),t}function Ale(e){let t=W.useContext(fP);return js(t,q3(e)),t}function Tle(e){let t=W.useContext(Bd);return js(t,q3(e)),t}function G3(e){let t=Tle(e),r=t.matches[t.matches.length-1];return js(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function Ple(){return G3("useRouteId")}function Nle(){var n;let e=W.useContext($3),t=Ale("useRouteError"),r=G3("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function jle(){let{router:e}=Sle("useNavigate"),t=G3("useNavigate"),r=W.useRef(!1);return UW(()=>{r.current=!0}),W.useCallback(async(a,c={})=>{$h(r.current,VW),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...c}))},[e,t])}var kB={};function qW(e,t,r){!t&&!kB[e]&&(kB[e]=!0,$h(!1,r))}W.memo(Cle);function Cle({routes:e,future:t,state:r}){return $W(e,void 0,r,t)}function W3({to:e,replace:t,state:r,relative:n}){js(m_(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=W.useContext(Xh);$h(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=W.useContext(Bd),{pathname:f}=co(),i=wa(),x=U3(e,V3(c),f,n==="path"),w=JSON.stringify(x);return W.useEffect(()=>{i(JSON.parse(w),{replace:t,state:r,relative:n})},[i,w,n,t,r]),null}function GW(e){return gle(e.context)}function za(e){js(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function kle({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:c=!1}){js(!m_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=e.replace(/^\/*/,"/"),i=W.useMemo(()=>({basename:f,navigator:a,static:c,future:{}}),[f,a,c]);typeof r=="string"&&(r=f_(r));let{pathname:x="/",search:w="",hash:A="",state:P=null,key:E="default"}=r,D=W.useMemo(()=>{let V=ym(x,f);return V==null?null:{location:{pathname:V,search:w,hash:A,state:P,key:E},navigationType:n}},[f,x,w,A,P,E,n]);return $h(D!=null,`<Router basename="${f}"> is not able to match the URL "${x}${w}${A}" because it does not start with the basename, so the <Router> won't render anything.`),D==null?null:W.createElement(Xh.Provider,{value:i},W.createElement(Fw.Provider,{children:t,value:D}))}function Ele({children:e,location:t}){return yle(QO(e),t)}function QO(e,t=[]){let r=[];return W.Children.forEach(e,(n,a)=>{if(!W.isValidElement(n))return;let c=[...t,a];if(n.type===W.Fragment){r.push.apply(r,QO(n.props.children,c));return}js(n.type===za,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),js(!n.props.index||!n.props.children,"An index route cannot have child routes.");let f={id:n.props.id||c.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(f.children=QO(n.props.children,c)),r.push(f)}),r}var uA="get",dA="application/x-www-form-urlencoded";function pP(e){return e!=null&&typeof e.tagName=="string"}function Mle(e){return pP(e)&&e.tagName.toLowerCase()==="button"}function Ole(e){return pP(e)&&e.tagName.toLowerCase()==="form"}function Rle(e){return pP(e)&&e.tagName.toLowerCase()==="input"}function Ile(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Dle(e,t){return e.button===0&&(!t||t==="_self")&&!Ile(e)}var NS=null;function Lle(){if(NS===null)try{new FormData(document.createElement("form"),0),NS=!1}catch{NS=!0}return NS}var zle=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Jj(e){return e!=null&&!zle.has(e)?($h(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dA}"`),null):e}function Fle(e,t){let r,n,a,c,f;if(Ole(e)){let i=e.getAttribute("action");n=i?ym(i,t):null,r=e.getAttribute("method")||uA,a=Jj(e.getAttribute("enctype"))||dA,c=new FormData(e)}else if(Mle(e)||Rle(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let x=e.getAttribute("formaction")||i.getAttribute("action");if(n=x?ym(x,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||uA,a=Jj(e.getAttribute("formenctype"))||Jj(i.getAttribute("enctype"))||dA,c=new FormData(i,e),!Lle()){let{name:w,type:A,value:P}=e;if(A==="image"){let E=w?`${w}.`:"";c.append(`${E}x`,"0"),c.append(`${E}y`,"0")}else w&&c.append(w,P)}}else{if(pP(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=uA,n=null,a=dA,f=e}return c&&a==="text/plain"&&(f=c,c=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:c,body:f}}function H3(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function Ble(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Vle(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Ule(e,t,r){let n=await Promise.all(e.map(async a=>{let c=t.routes[a.route.id];if(c){let f=await Ble(c,r);return f.links?f.links():[]}return[]}));return Wle(n.flat(1).filter(Vle).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function EB(e,t,r,n,a,c){let f=(x,w)=>r[w]?x.route.id!==r[w].route.id:!0,i=(x,w)=>{var A;return r[w].pathname!==x.pathname||((A=r[w].route.path)==null?void 0:A.endsWith("*"))&&r[w].params["*"]!==x.params["*"]};return c==="assets"?t.filter((x,w)=>f(x,w)||i(x,w)):c==="data"?t.filter((x,w)=>{var P;let A=n.routes[x.route.id];if(!A||!A.hasLoader)return!1;if(f(x,w)||i(x,w))return!0;if(x.route.shouldRevalidate){let E=x.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((P=r[0])==null?void 0:P.params)||{},nextUrl:new URL(e,window.origin),nextParams:x.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function $le(e,t,{includeHydrateFallback:r}={}){return qle(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let c=[a.module];return a.clientActionModule&&(c=c.concat(a.clientActionModule)),a.clientLoaderModule&&(c=c.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(c=c.concat(a.hydrateFallbackModule)),a.imports&&(c=c.concat(a.imports)),c}).flat(1))}function qle(e){return[...new Set(e)]}function Gle(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function Wle(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let c=JSON.stringify(Gle(a));return r.has(c)||(r.add(c),n.push({key:c,link:a})),n},[])}function Hle(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&ym(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function WW(){let e=W.useContext(p_);return H3(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Kle(){let e=W.useContext(fP);return H3(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var K3=W.createContext(void 0);K3.displayName="FrameworkContext";function HW(){let e=W.useContext(K3);return H3(e,"You must render this element inside a <HydratedRouter> element"),e}function Zle(e,t){let r=W.useContext(K3),[n,a]=W.useState(!1),[c,f]=W.useState(!1),{onFocus:i,onBlur:x,onMouseEnter:w,onMouseLeave:A,onTouchStart:P}=t,E=W.useRef(null);W.useEffect(()=>{if(e==="render"&&f(!0),e==="viewport"){let L=H=>{H.forEach(K=>{f(K.isIntersecting)})},$=new IntersectionObserver(L,{threshold:.5});return E.current&&$.observe(E.current),()=>{$.disconnect()}}},[e]),W.useEffect(()=>{if(n){let L=setTimeout(()=>{f(!0)},100);return()=>{clearTimeout(L)}}},[n]);let D=()=>{a(!0)},V=()=>{a(!1),f(!1)};return r?e!=="intent"?[c,E,{}]:[c,E,{onFocus:Rb(i,D),onBlur:Rb(x,V),onMouseEnter:Rb(w,D),onMouseLeave:Rb(A,V),onTouchStart:Rb(P,D)}]:[!1,E,{}]}function Rb(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Yle({page:e,...t}){let{router:r}=WW(),n=W.useMemo(()=>DW(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?W.createElement(Jle,{page:e,matches:n,...t}):null}function Xle(e){let{manifest:t,routeModules:r}=HW(),[n,a]=W.useState([]);return W.useEffect(()=>{let c=!1;return Ule(e,t,r).then(f=>{c||a(f)}),()=>{c=!0}},[e,t,r]),n}function Jle({page:e,matches:t,...r}){let n=co(),{manifest:a,routeModules:c}=HW(),{basename:f}=WW(),{loaderData:i,matches:x}=Kle(),w=W.useMemo(()=>EB(e,t,x,a,n,"data"),[e,t,x,a,n]),A=W.useMemo(()=>EB(e,t,x,a,n,"assets"),[e,t,x,a,n]),P=W.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let V=new Set,L=!1;if(t.forEach(H=>{var Q;let K=a.routes[H.route.id];!K||!K.hasLoader||(!w.some(ae=>ae.route.id===H.route.id)&&H.route.id in i&&((Q=c[H.route.id])!=null&&Q.shouldRevalidate)||K.hasClientLoader?L=!0:V.add(H.route.id))}),V.size===0)return[];let $=Hle(e,f);return L&&V.size>0&&$.searchParams.set("_routes",t.filter(H=>V.has(H.route.id)).map(H=>H.route.id).join(",")),[$.pathname+$.search]},[f,i,n,a,w,t,e,c]),E=W.useMemo(()=>$le(A,a),[A,a]),D=Xle(A);return W.createElement(W.Fragment,null,P.map(V=>W.createElement("link",{key:V,rel:"prefetch",as:"fetch",href:V,...r})),E.map(V=>W.createElement("link",{key:V,rel:"modulepreload",href:V,...r})),D.map(({key:V,link:L})=>W.createElement("link",{key:V,...L})))}function Qle(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var KW=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{KW&&(window.__reactRouterVersion="7.3.0")}catch{}function ece({basename:e,children:t,window:r}){let n=W.useRef();n.current==null&&(n.current=Voe({window:r,v5Compat:!0}));let a=n.current,[c,f]=W.useState({action:a.action,location:a.location}),i=W.useCallback(x=>{W.startTransition(()=>f(x))},[f]);return W.useLayoutEffect(()=>a.listen(i),[a,i]),W.createElement(kle,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:a})}var ZW=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fo=W.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:c,replace:f,state:i,target:x,to:w,preventScrollReset:A,viewTransition:P,...E},D){let{basename:V}=W.useContext(Xh),L=typeof w=="string"&&ZW.test(w),$,H=!1;if(typeof w=="string"&&L&&($=w,KW))try{let Pe=new URL(window.location.href),Ne=w.startsWith("//")?new URL(Pe.protocol+w):new URL(w),pe=ym(Ne.pathname,V);Ne.origin===Pe.origin&&pe!=null?w=pe+Ne.search+Ne.hash:H=!0}catch{$h(!1,`<Link to="${w}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let K=fle(w,{relative:a}),[Q,ae,ee]=Zle(n,E),se=ice(w,{replace:f,state:i,target:x,preventScrollReset:A,relative:a,viewTransition:P});function ce(Pe){t&&t(Pe),Pe.defaultPrevented||se(Pe)}let he=W.createElement("a",{...E,...ee,href:$||K,onClick:H||c?t:ce,ref:Qle(D,ae),target:x,"data-discover":!L&&r==="render"?"true":void 0});return Q&&!L?W.createElement(W.Fragment,null,he,W.createElement(Yle,{page:K})):he});Fo.displayName="Link";var tce=W.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:c,to:f,viewTransition:i,children:x,...w},A){let P=Bw(f,{relative:w.relative}),E=co(),D=W.useContext(fP),{navigator:V,basename:L}=W.useContext(Xh),$=D!=null&&cce(P)&&i===!0,H=V.encodeLocation?V.encodeLocation(P).pathname:P.pathname,K=E.pathname,Q=D&&D.navigation&&D.navigation.location?D.navigation.location.pathname:null;r||(K=K.toLowerCase(),Q=Q?Q.toLowerCase():null,H=H.toLowerCase()),Q&&L&&(Q=ym(Q,L)||Q);const ae=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let ee=K===H||!a&&K.startsWith(H)&&K.charAt(ae)==="/",se=Q!=null&&(Q===H||!a&&Q.startsWith(H)&&Q.charAt(H.length)==="/"),ce={isActive:ee,isPending:se,isTransitioning:$},he=ee?t:void 0,Pe;typeof n=="function"?Pe=n(ce):Pe=[n,ee?"active":null,se?"pending":null,$?"transitioning":null].filter(Boolean).join(" ");let Ne=typeof c=="function"?c(ce):c;return W.createElement(Fo,{...w,"aria-current":he,className:Pe,ref:A,style:Ne,to:f,viewTransition:i},typeof x=="function"?x(ce):x)});tce.displayName="NavLink";var rce=W.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:c,method:f=uA,action:i,onSubmit:x,relative:w,preventScrollReset:A,viewTransition:P,...E},D)=>{let V=oce(),L=lce(i,{relative:w}),$=f.toLowerCase()==="get"?"get":"post",H=typeof i=="string"&&ZW.test(i),K=Q=>{if(x&&x(Q),Q.defaultPrevented)return;Q.preventDefault();let ae=Q.nativeEvent.submitter,ee=(ae==null?void 0:ae.getAttribute("formmethod"))||f;V(ae||Q.currentTarget,{fetcherKey:t,method:ee,navigate:r,replace:a,state:c,relative:w,preventScrollReset:A,viewTransition:P})};return W.createElement("form",{ref:D,method:$,action:L,onSubmit:n?x:K,...E,"data-discover":!H&&e==="render"?"true":void 0})});rce.displayName="Form";function nce(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YW(e){let t=W.useContext(p_);return js(t,nce(e)),t}function ice(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:c,viewTransition:f}={}){let i=wa(),x=co(),w=Bw(e,{relative:c});return W.useCallback(A=>{if(Dle(A,t)){A.preventDefault();let P=r!==void 0?r:A1(x)===A1(w);i(e,{replace:P,state:n,preventScrollReset:a,relative:c,viewTransition:f})}},[x,i,w,r,n,t,e,a,c,f])}var ace=0,sce=()=>`__${String(++ace)}__`;function oce(){let{router:e}=YW("useSubmit"),{basename:t}=W.useContext(Xh),r=Ple();return W.useCallback(async(n,a={})=>{let{action:c,method:f,encType:i,formData:x,body:w}=Fle(n,t);if(a.navigate===!1){let A=a.fetcherKey||sce();await e.fetch(A,r,a.action||c,{preventScrollReset:a.preventScrollReset,formData:x,body:w,formMethod:a.method||f,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||c,{preventScrollReset:a.preventScrollReset,formData:x,body:w,formMethod:a.method||f,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function lce(e,{relative:t}={}){let{basename:r}=W.useContext(Xh),n=W.useContext(Bd);js(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),c={...Bw(e||".",{relative:t})},f=co();if(e==null){c.search=f.search;let i=new URLSearchParams(c.search),x=i.getAll("index");if(x.some(A=>A==="")){i.delete("index"),x.filter(P=>P).forEach(P=>i.append("index",P));let A=i.toString();c.search=A?`?${A}`:""}}return(!e||e===".")&&a.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(c.pathname=c.pathname==="/"?r:hm([r,c.pathname])),A1(c)}function cce(e,t={}){let r=W.useContext(BW);js(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=YW("useViewTransitionState"),a=Bw(e,{relative:t.relative});if(!r.isTransitioning)return!1;let c=ym(r.currentLocation.pathname,n)||r.currentLocation.pathname,f=ym(r.nextLocation.pathname,n)||r.nextLocation.pathname;return jA(a.pathname,f)!=null||jA(a.pathname,c)!=null}new TextEncoder;function MB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function mP(...e){return t=>{let r=!1;const n=e.map(a=>{const c=MB(a,t);return!r&&typeof c=="function"&&(r=!0),c});if(r)return()=>{for(let a=0;a<n.length;a++){const c=n[a];typeof c=="function"?c():MB(e[a],null)}}}}function Ji(...e){return W.useCallback(mP(...e),e)}var Ql=W.forwardRef((e,t)=>{const{children:r,...n}=e,a=W.Children.toArray(r),c=a.find(uce);if(c){const f=c.props.children,i=a.map(x=>x===c?W.Children.count(f)>1?W.Children.only(null):W.isValidElement(f)?f.props.children:null:x);return l.jsx(eR,{...n,ref:t,children:W.isValidElement(f)?W.cloneElement(f,void 0,i):null})}return l.jsx(eR,{...n,ref:t,children:r})});Ql.displayName="Slot";var eR=W.forwardRef((e,t)=>{const{children:r,...n}=e;if(W.isValidElement(r)){const a=hce(r),c=dce(n,r.props);return r.type!==W.Fragment&&(c.ref=t?mP(t,a):a),W.cloneElement(r,c)}return W.Children.count(r)>1?W.Children.only(null):null});eR.displayName="SlotClone";var Z3=({children:e})=>l.jsx(l.Fragment,{children:e});function uce(e){return W.isValidElement(e)&&e.type===Z3}function dce(e,t){const r={...t};for(const n in t){const a=e[n],c=t[n];/^on[A-Z]/.test(n)?a&&c?r[n]=(...i)=>{c(...i),a(...i)}:a&&(r[n]=a):n==="style"?r[n]={...a,...c}:n==="className"&&(r[n]=[a,c].filter(Boolean).join(" "))}return{...e,...r}}function hce(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function XW(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=XW(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function fi(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=XW(e))&&(n&&(n+=" "),n+=t);return n}const OB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,RB=fi,Vw=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return RB(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:c}=t,f=Object.keys(a).map(w=>{const A=r==null?void 0:r[w],P=c==null?void 0:c[w];if(A===null)return null;const E=OB(A)||OB(P);return a[w][E]}),i=r&&Object.entries(r).reduce((w,A)=>{let[P,E]=A;return E===void 0||(w[P]=E),w},{}),x=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((w,A)=>{let{class:P,className:E,...D}=A;return Object.entries(D).every(V=>{let[L,$]=V;return Array.isArray($)?$.includes({...c,...i}[L]):{...c,...i}[L]===$})?[...w,P,E]:w},[]);return RB(e,f,x,r==null?void 0:r.class,r==null?void 0:r.className)},Y3="-",fce=e=>{const t=mce(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:f=>{const i=f.split(Y3);return i[0]===""&&i.length!==1&&i.shift(),JW(i,t)||pce(f)},getConflictingClassGroupIds:(f,i)=>{const x=r[f]||[];return i&&n[f]?[...x,...n[f]]:x}}},JW=(e,t)=>{var f;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?JW(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const c=e.join(Y3);return(f=t.validators.find(({validator:i})=>i(c)))==null?void 0:f.classGroupId},IB=/^\[(.+)\]$/,pce=e=>{if(IB.test(e)){const t=IB.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},mce=e=>{const{theme:t,classGroups:r}=e,n={nextPart:new Map,validators:[]};for(const a in r)tR(r[a],n,a,t);return n},tR=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const c=a===""?t:DB(t,a);c.classGroupId=r;return}if(typeof a=="function"){if(gce(a)){tR(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([c,f])=>{tR(f,DB(t,c),r,n)})})},DB=(e,t)=>{let r=e;return t.split(Y3).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},gce=e=>e.isThemeGetter,yce=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(c,f)=>{r.set(c,f),t++,t>e&&(t=0,n=r,r=new Map)};return{get(c){let f=r.get(c);if(f!==void 0)return f;if((f=n.get(c))!==void 0)return a(c,f),f},set(c,f){r.has(c)?r.set(c,f):a(c,f)}}},rR="!",nR=":",vce=nR.length,xce=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const c=[];let f=0,i=0,x=0,w;for(let V=0;V<a.length;V++){let L=a[V];if(f===0&&i===0){if(L===nR){c.push(a.slice(x,V)),x=V+vce;continue}if(L==="/"){w=V;continue}}L==="["?f++:L==="]"?f--:L==="("?i++:L===")"&&i--}const A=c.length===0?a:a.substring(x),P=_ce(A),E=P!==A,D=w&&w>x?w-x:void 0;return{modifiers:c,hasImportantModifier:E,baseClassName:P,maybePostfixModifierPosition:D}};if(t){const a=t+nR,c=n;n=f=>f.startsWith(a)?c(f.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:f,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=c=>r({className:c,parseClassName:a})}return n},_ce=e=>e.endsWith(rR)?e.substring(0,e.length-1):e.startsWith(rR)?e.substring(1):e,bce=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let c=[];return n.forEach(f=>{f[0]==="["||t[f]?(a.push(...c.sort(),f),c=[]):c.push(f)}),a.push(...c.sort()),a}},wce=e=>({cache:yce(e.cacheSize),parseClassName:xce(e),sortModifiers:bce(e),...fce(e)}),Sce=/\s+/,Ace=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:c}=t,f=[],i=e.trim().split(Sce);let x="";for(let w=i.length-1;w>=0;w-=1){const A=i[w],{isExternal:P,modifiers:E,hasImportantModifier:D,baseClassName:V,maybePostfixModifierPosition:L}=r(A);if(P){x=A+(x.length>0?" "+x:x);continue}let $=!!L,H=n($?V.substring(0,L):V);if(!H){if(!$){x=A+(x.length>0?" "+x:x);continue}if(H=n(V),!H){x=A+(x.length>0?" "+x:x);continue}$=!1}const K=c(E).join(":"),Q=D?K+rR:K,ae=Q+H;if(f.includes(ae))continue;f.push(ae);const ee=a(H,$);for(let se=0;se<ee.length;++se){const ce=ee[se];f.push(Q+ce)}x=A+(x.length>0?" "+x:x)}return x};function Tce(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=QW(t))&&(n&&(n+=" "),n+=r);return n}const QW=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=QW(e[n]))&&(r&&(r+=" "),r+=t);return r};function Pce(e,...t){let r,n,a,c=f;function f(x){const w=t.reduce((A,P)=>P(A),e());return r=wce(w),n=r.cache.get,a=r.cache.set,c=i,i(x)}function i(x){const w=n(x);if(w)return w;const A=Ace(x,r);return a(x,A),A}return function(){return c(Tce.apply(null,arguments))}}const al=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},eH=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,tH=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Nce=/^\d+\/\d+$/,jce=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Cce=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,kce=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ece=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Mce=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zv=e=>Nce.test(e),Vi=e=>!!e&&!Number.isNaN(Number(e)),c0=e=>!!e&&Number.isInteger(Number(e)),LB=e=>e.endsWith("%")&&Vi(e.slice(0,-1)),kg=e=>jce.test(e),Oce=()=>!0,Rce=e=>Cce.test(e)&&!kce.test(e),X3=()=>!1,Ice=e=>Ece.test(e),Dce=e=>Mce.test(e),Lce=e=>!gn(e)&&!yn(e),zce=e=>g_(e,iH,X3),gn=e=>eH.test(e),u0=e=>g_(e,aH,Rce),Qj=e=>g_(e,Zce,Vi),Fce=e=>g_(e,rH,X3),Bce=e=>g_(e,nH,Dce),Vce=e=>g_(e,X3,Ice),yn=e=>tH.test(e),jS=e=>y_(e,aH),Uce=e=>y_(e,Yce),$ce=e=>y_(e,rH),qce=e=>y_(e,iH),Gce=e=>y_(e,nH),Wce=e=>y_(e,Xce,!0),g_=(e,t,r)=>{const n=eH.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},y_=(e,t,r=!1)=>{const n=tH.exec(e);return n?n[1]?t(n[1]):r:!1},rH=e=>e==="position",Hce=new Set(["image","url"]),nH=e=>Hce.has(e),Kce=new Set(["length","size","percentage"]),iH=e=>Kce.has(e),aH=e=>e==="length",Zce=e=>e==="number",Yce=e=>e==="family-name",Xce=e=>e==="shadow",Jce=()=>{const e=al("color"),t=al("font"),r=al("text"),n=al("font-weight"),a=al("tracking"),c=al("leading"),f=al("breakpoint"),i=al("container"),x=al("spacing"),w=al("radius"),A=al("shadow"),P=al("inset-shadow"),E=al("drop-shadow"),D=al("blur"),V=al("perspective"),L=al("aspect"),$=al("ease"),H=al("animate"),K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Q=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ae=()=>["auto","hidden","clip","visible","scroll"],ee=()=>["auto","contain","none"],se=()=>[yn,gn,x],ce=()=>[Zv,"full","auto",...se()],he=()=>[c0,"none","subgrid",yn,gn],Pe=()=>["auto",{span:["full",c0,yn,gn]},yn,gn],Ne=()=>[c0,"auto",yn,gn],pe=()=>["auto","min","max","fr",yn,gn],je=()=>["start","end","center","between","around","evenly","stretch","baseline"],xe=()=>["start","end","center","stretch"],Ce=()=>["auto",...se()],ze=()=>[Zv,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...se()],Te=()=>[e,yn,gn],Re=()=>[LB,u0],Fe=()=>["","none","full",w,yn,gn],He=()=>["",Vi,jS,u0],mt=()=>["solid","dashed","dotted","double"],Xe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ot=()=>["","none",D,yn,gn],qe=()=>["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",yn,gn],Lt=()=>["none",Vi,yn,gn],Zt=()=>["none",Vi,yn,gn],Xt=()=>[Vi,yn,gn],rr=()=>[Zv,"full",...se()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[kg],breakpoint:[kg],color:[Oce],container:[kg],"drop-shadow":[kg],ease:["in","out","in-out"],font:[Lce],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[kg],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[kg],shadow:[kg],spacing:["px",Vi],text:[kg],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Zv,gn,yn,L]}],container:["container"],columns:[{columns:[Vi,gn,yn,i]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Q(),gn,yn]}],overflow:[{overflow:ae()}],"overflow-x":[{"overflow-x":ae()}],"overflow-y":[{"overflow-y":ae()}],overscroll:[{overscroll:ee()}],"overscroll-x":[{"overscroll-x":ee()}],"overscroll-y":[{"overscroll-y":ee()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ce()}],"inset-x":[{"inset-x":ce()}],"inset-y":[{"inset-y":ce()}],start:[{start:ce()}],end:[{end:ce()}],top:[{top:ce()}],right:[{right:ce()}],bottom:[{bottom:ce()}],left:[{left:ce()}],visibility:["visible","invisible","collapse"],z:[{z:[c0,"auto",yn,gn]}],basis:[{basis:[Zv,"full","auto",i,...se()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Vi,Zv,"auto","initial","none",gn]}],grow:[{grow:["",Vi,yn,gn]}],shrink:[{shrink:["",Vi,yn,gn]}],order:[{order:[c0,"first","last","none",yn,gn]}],"grid-cols":[{"grid-cols":he()}],"col-start-end":[{col:Pe()}],"col-start":[{"col-start":Ne()}],"col-end":[{"col-end":Ne()}],"grid-rows":[{"grid-rows":he()}],"row-start-end":[{row:Pe()}],"row-start":[{"row-start":Ne()}],"row-end":[{"row-end":Ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":pe()}],"auto-rows":[{"auto-rows":pe()}],gap:[{gap:se()}],"gap-x":[{"gap-x":se()}],"gap-y":[{"gap-y":se()}],"justify-content":[{justify:[...je(),"normal"]}],"justify-items":[{"justify-items":[...xe(),"normal"]}],"justify-self":[{"justify-self":["auto",...xe()]}],"align-content":[{content:["normal",...je()]}],"align-items":[{items:[...xe(),"baseline"]}],"align-self":[{self:["auto",...xe(),"baseline"]}],"place-content":[{"place-content":je()}],"place-items":[{"place-items":[...xe(),"baseline"]}],"place-self":[{"place-self":["auto",...xe()]}],p:[{p:se()}],px:[{px:se()}],py:[{py:se()}],ps:[{ps:se()}],pe:[{pe:se()}],pt:[{pt:se()}],pr:[{pr:se()}],pb:[{pb:se()}],pl:[{pl:se()}],m:[{m:Ce()}],mx:[{mx:Ce()}],my:[{my:Ce()}],ms:[{ms:Ce()}],me:[{me:Ce()}],mt:[{mt:Ce()}],mr:[{mr:Ce()}],mb:[{mb:Ce()}],ml:[{ml:Ce()}],"space-x":[{"space-x":se()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":se()}],"space-y-reverse":["space-y-reverse"],size:[{size:ze()}],w:[{w:[i,"screen",...ze()]}],"min-w":[{"min-w":[i,"screen","none",...ze()]}],"max-w":[{"max-w":[i,"screen","none","prose",{screen:[f]},...ze()]}],h:[{h:["screen",...ze()]}],"min-h":[{"min-h":["screen","none",...ze()]}],"max-h":[{"max-h":["screen",...ze()]}],"font-size":[{text:["base",r,jS,u0]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,yn,Qj]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",LB,gn]}],"font-family":[{font:[Uce,gn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,yn,gn]}],"line-clamp":[{"line-clamp":[Vi,"none",yn,Qj]}],leading:[{leading:[c,...se()]}],"list-image":[{"list-image":["none",yn,gn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",yn,gn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Te()}],"text-color":[{text:Te()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...mt(),"wavy"]}],"text-decoration-thickness":[{decoration:[Vi,"from-font","auto",yn,u0]}],"text-decoration-color":[{decoration:Te()}],"underline-offset":[{"underline-offset":[Vi,"auto",yn,gn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:se()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",yn,gn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",yn,gn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Q(),$ce,Fce]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:["auto","cover","contain",qce,zce]}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},c0,yn,gn],radial:["",yn,gn],conic:[c0,yn,gn]},Gce,Bce]}],"bg-color":[{bg:Te()}],"gradient-from-pos":[{from:Re()}],"gradient-via-pos":[{via:Re()}],"gradient-to-pos":[{to:Re()}],"gradient-from":[{from:Te()}],"gradient-via":[{via:Te()}],"gradient-to":[{to:Te()}],rounded:[{rounded:Fe()}],"rounded-s":[{"rounded-s":Fe()}],"rounded-e":[{"rounded-e":Fe()}],"rounded-t":[{"rounded-t":Fe()}],"rounded-r":[{"rounded-r":Fe()}],"rounded-b":[{"rounded-b":Fe()}],"rounded-l":[{"rounded-l":Fe()}],"rounded-ss":[{"rounded-ss":Fe()}],"rounded-se":[{"rounded-se":Fe()}],"rounded-ee":[{"rounded-ee":Fe()}],"rounded-es":[{"rounded-es":Fe()}],"rounded-tl":[{"rounded-tl":Fe()}],"rounded-tr":[{"rounded-tr":Fe()}],"rounded-br":[{"rounded-br":Fe()}],"rounded-bl":[{"rounded-bl":Fe()}],"border-w":[{border:He()}],"border-w-x":[{"border-x":He()}],"border-w-y":[{"border-y":He()}],"border-w-s":[{"border-s":He()}],"border-w-e":[{"border-e":He()}],"border-w-t":[{"border-t":He()}],"border-w-r":[{"border-r":He()}],"border-w-b":[{"border-b":He()}],"border-w-l":[{"border-l":He()}],"divide-x":[{"divide-x":He()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":He()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...mt(),"hidden","none"]}],"divide-style":[{divide:[...mt(),"hidden","none"]}],"border-color":[{border:Te()}],"border-color-x":[{"border-x":Te()}],"border-color-y":[{"border-y":Te()}],"border-color-s":[{"border-s":Te()}],"border-color-e":[{"border-e":Te()}],"border-color-t":[{"border-t":Te()}],"border-color-r":[{"border-r":Te()}],"border-color-b":[{"border-b":Te()}],"border-color-l":[{"border-l":Te()}],"divide-color":[{divide:Te()}],"outline-style":[{outline:[...mt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Vi,yn,gn]}],"outline-w":[{outline:["",Vi,jS,u0]}],"outline-color":[{outline:[e]}],shadow:[{shadow:["","none",A,Wce,Vce]}],"shadow-color":[{shadow:Te()}],"inset-shadow":[{"inset-shadow":["none",yn,gn,P]}],"inset-shadow-color":[{"inset-shadow":Te()}],"ring-w":[{ring:He()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Te()}],"ring-offset-w":[{"ring-offset":[Vi,u0]}],"ring-offset-color":[{"ring-offset":Te()}],"inset-ring-w":[{"inset-ring":He()}],"inset-ring-color":[{"inset-ring":Te()}],opacity:[{opacity:[Vi,yn,gn]}],"mix-blend":[{"mix-blend":[...Xe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Xe()}],filter:[{filter:["","none",yn,gn]}],blur:[{blur:ot()}],brightness:[{brightness:[Vi,yn,gn]}],contrast:[{contrast:[Vi,yn,gn]}],"drop-shadow":[{"drop-shadow":["","none",E,yn,gn]}],grayscale:[{grayscale:["",Vi,yn,gn]}],"hue-rotate":[{"hue-rotate":[Vi,yn,gn]}],invert:[{invert:["",Vi,yn,gn]}],saturate:[{saturate:[Vi,yn,gn]}],sepia:[{sepia:["",Vi,yn,gn]}],"backdrop-filter":[{"backdrop-filter":["","none",yn,gn]}],"backdrop-blur":[{"backdrop-blur":ot()}],"backdrop-brightness":[{"backdrop-brightness":[Vi,yn,gn]}],"backdrop-contrast":[{"backdrop-contrast":[Vi,yn,gn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Vi,yn,gn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Vi,yn,gn]}],"backdrop-invert":[{"backdrop-invert":["",Vi,yn,gn]}],"backdrop-opacity":[{"backdrop-opacity":[Vi,yn,gn]}],"backdrop-saturate":[{"backdrop-saturate":[Vi,yn,gn]}],"backdrop-sepia":[{"backdrop-sepia":["",Vi,yn,gn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":se()}],"border-spacing-x":[{"border-spacing-x":se()}],"border-spacing-y":[{"border-spacing-y":se()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",yn,gn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Vi,"initial",yn,gn]}],ease:[{ease:["linear","initial",$,yn,gn]}],delay:[{delay:[Vi,yn,gn]}],animate:[{animate:["none",H,yn,gn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[V,yn,gn]}],"perspective-origin":[{"perspective-origin":qe()}],rotate:[{rotate:Lt()}],"rotate-x":[{"rotate-x":Lt()}],"rotate-y":[{"rotate-y":Lt()}],"rotate-z":[{"rotate-z":Lt()}],scale:[{scale:Zt()}],"scale-x":[{"scale-x":Zt()}],"scale-y":[{"scale-y":Zt()}],"scale-z":[{"scale-z":Zt()}],"scale-3d":["scale-3d"],skew:[{skew:Xt()}],"skew-x":[{"skew-x":Xt()}],"skew-y":[{"skew-y":Xt()}],transform:[{transform:[yn,gn,"","none","gpu","cpu"]}],"transform-origin":[{origin:qe()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:rr()}],"translate-x":[{"translate-x":rr()}],"translate-y":[{"translate-y":rr()}],"translate-z":[{"translate-z":rr()}],"translate-none":["translate-none"],accent:[{accent:Te()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Te()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",yn,gn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":se()}],"scroll-mx":[{"scroll-mx":se()}],"scroll-my":[{"scroll-my":se()}],"scroll-ms":[{"scroll-ms":se()}],"scroll-me":[{"scroll-me":se()}],"scroll-mt":[{"scroll-mt":se()}],"scroll-mr":[{"scroll-mr":se()}],"scroll-mb":[{"scroll-mb":se()}],"scroll-ml":[{"scroll-ml":se()}],"scroll-p":[{"scroll-p":se()}],"scroll-px":[{"scroll-px":se()}],"scroll-py":[{"scroll-py":se()}],"scroll-ps":[{"scroll-ps":se()}],"scroll-pe":[{"scroll-pe":se()}],"scroll-pt":[{"scroll-pt":se()}],"scroll-pr":[{"scroll-pr":se()}],"scroll-pb":[{"scroll-pb":se()}],"scroll-pl":[{"scroll-pl":se()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",yn,gn]}],fill:[{fill:["none",...Te()]}],"stroke-w":[{stroke:[Vi,jS,u0,Qj]}],stroke:[{stroke:["none",...Te()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["before","after","placeholder","file","marker","selection","first-line","first-letter","backdrop","*","**"]}},Qce=Pce(Jce);function Ut(...e){return Qce(fi(e))}const T1=Vw("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"sm"}}),Nr=W.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},c)=>{const f=n?Ql:"button";return l.jsx(f,{className:Ut(T1({variant:t,size:r,className:e})),ref:c,...a})});Nr.displayName="Button";/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sH=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rue=W.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:c,iconNode:f,...i},x)=>W.createElement("svg",{ref:x,...tue,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:sH("lucide",a),...i},[...f.map(([w,A])=>W.createElement(w,A)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=(e,t)=>{const r=W.forwardRef(({className:n,...a},c)=>W.createElement(rue,{ref:c,iconNode:t,className:sH(`lucide-${eue(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nue=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],zB=rn("Activity",nue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iue=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],FB=rn("ArrowDown",iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aue=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],gP=rn("ArrowLeft",aue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sue=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],BB=rn("ArrowUp",sue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oue=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],lue=rn("BadgeCheck",oue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cue=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],VB=rn("BookOpen",cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uue=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],Xb=rn("Building",uue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const due=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],so=rn("Calendar",due);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hue=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],cl=rn("Car",hue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fue=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],yP=rn("ChartColumn",fue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pue=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],P1=rn("ChartPie",pue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mue=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16c.5-2 1.5-7 4-7 2 0 2 3 4 3 2.5 0 4.5-5 5-7",key:"lw07rv"}]],gue=rn("ChartSpline",mue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yue=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],J3=rn("Check",yue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vue=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],oH=rn("ChevronDown",vue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xue=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Q3=rn("ChevronLeft",xue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ue=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],L0=rn("ChevronRight",_ue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bue=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],wue=rn("ChevronUp",bue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sue=[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]],Aue=rn("ChevronsLeft",Sue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tue=[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]],Pue=rn("ChevronsRight",Tue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nue=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],lH=rn("ChevronsUpDown",Nue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Fg=rn("CircleAlert",jue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cue=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],cH=rn("CircleCheckBig",Cue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],iR=rn("CircleCheck",kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Mue=rn("CircleX",Eue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Rue=rn("Circle",Oue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],eD=rn("Clock",Iue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Due=[["rect",{width:"14",height:"8",x:"5",y:"2",rx:"2",key:"wc9tft"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6 18h2",key:"rwmk9e"}],["path",{d:"M12 18h6",key:"aqd8w3"}]],Lue=rn("Computer",Due);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zue=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],vP=rn("CreditCard",zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fue=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],uH=rn("Download",Fue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bue=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Vue=rn("Ellipsis",Bue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uue=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],CA=rn("EyeOff",Uue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ue=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],kA=rn("Eye",$ue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const que=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ld=rn("FileText",que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gue=[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]],dH=rn("Filter",Gue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wue=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],EA=rn("Hash",Wue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hue=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],UB=rn("Image",Hue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kue=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],$B=rn("Layers",Kue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zue=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],_c=rn("LoaderCircle",Zue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yue=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],aR=rn("Lock",Yue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xue=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],Jue=rn("LogOut",Xue);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Que=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Uw=rn("Mail",Que);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ede=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Ed=rn("MapPin",ede);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tde=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],qB=rn("Moon",tde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rde=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],hH=rn("Palette",rde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]],ide=rn("PanelLeft",nde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ade=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],sR=rn("PenLine",ade);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sde=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],xP=rn("Phone",sde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ode=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],J0=rn("Plus",ode);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lde=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],CS=rn("RefreshCw",lde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cde=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ude=rn("RotateCcw",cde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dde=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],hde=rn("Save",dde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fde=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],v_=rn("Search",fde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pde=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],mde=rn("Settings2",pde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gde=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Px=rn("Shield",gde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M17 12h-2l-2 5-2-10-2 5H7",key:"15hlnc"}]],eC=rn("SquareActivity",yde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vde=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 8h7",key:"kbo1nt"}],["path",{d:"M8 12h6",key:"ikassy"}],["path",{d:"M11 16h5",key:"oq65wt"}]],tC=rn("SquareChartGantt",vde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xde=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ao=rn("SquarePen",xde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _de=[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]],bde=rn("SquareTerminal",_de);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wde=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],GB=rn("Sun",wde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sde=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Ade=rn("Table",Sde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tde=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Pde=rn("Tag",Tde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nde=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],fH=rn("Target",Nde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jde=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Cde=rn("Trash2",jde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kde=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],WB=rn("TrendingDown",kde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ede=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],qg=rn("TrendingUp",Ede);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mde=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Hc=rn("TriangleAlert",Mde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ode=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],MA=rn("UserPlus",Ode);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rde=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Du=rn("User",Rde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ide=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],tD=rn("Users",Ide);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dde=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],pH=rn("Wrench",Dde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lde=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qf=rn("X",Lde);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zde=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Fde=rn("Zap",zde);function ln(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Bde(e,t){const r=W.createContext(t),n=c=>{const{children:f,...i}=c,x=W.useMemo(()=>i,Object.values(i));return l.jsx(r.Provider,{value:x,children:f})};n.displayName=e+"Provider";function a(c){const f=W.useContext(r);if(f)return f;if(t!==void 0)return t;throw new Error(`\`${c}\` must be used within \`${e}\``)}return[n,a]}function Vd(e,t=[]){let r=[];function n(c,f){const i=W.createContext(f),x=r.length;r=[...r,f];const w=P=>{var H;const{scope:E,children:D,...V}=P,L=((H=E==null?void 0:E[e])==null?void 0:H[x])||i,$=W.useMemo(()=>V,Object.values(V));return l.jsx(L.Provider,{value:$,children:D})};w.displayName=c+"Provider";function A(P,E){var L;const D=((L=E==null?void 0:E[e])==null?void 0:L[x])||i,V=W.useContext(D);if(V)return V;if(f!==void 0)return f;throw new Error(`\`${P}\` must be used within \`${c}\``)}return[w,A]}const a=()=>{const c=r.map(f=>W.createContext(f));return function(i){const x=(i==null?void 0:i[e])||c;return W.useMemo(()=>({[`__scope${e}`]:{...i,[e]:x}}),[i,x])}};return a.scopeName=e,[n,Vde(a,...t)]}function Vde(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=n.reduce((i,{useScope:x,scopeName:w})=>{const P=x(c)[`__scope${w}`];return{...i,...P}},{});return W.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}function Lu(e){const t=W.useRef(e);return W.useEffect(()=>{t.current=e}),W.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Kg({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=Ude({defaultProp:t,onChange:r}),c=e!==void 0,f=c?e:n,i=Lu(r),x=W.useCallback(w=>{if(c){const P=typeof w=="function"?w(e):w;P!==e&&i(P)}else a(w)},[c,e,a,i]);return[f,x]}function Ude({defaultProp:e,onChange:t}){const r=W.useState(e),[n]=r,a=W.useRef(n),c=Lu(t);return W.useEffect(()=>{a.current!==n&&(c(n),a.current=n)},[n,a,c]),r}var $de=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],vi=$de.reduce((e,t)=>{const r=W.forwardRef((n,a)=>{const{asChild:c,...f}=n,i=c?Ql:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(i,{...f,ref:a})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function mH(e,t){e&&zw.flushSync(()=>e.dispatchEvent(t))}function rD(e){const t=e+"CollectionProvider",[r,n]=Vd(t),[a,c]=r(t,{collectionRef:{current:null},itemMap:new Map}),f=D=>{const{scope:V,children:L}=D,$=Oe.useRef(null),H=Oe.useRef(new Map).current;return l.jsx(a,{scope:V,itemMap:H,collectionRef:$,children:L})};f.displayName=t;const i=e+"CollectionSlot",x=Oe.forwardRef((D,V)=>{const{scope:L,children:$}=D,H=c(i,L),K=Ji(V,H.collectionRef);return l.jsx(Ql,{ref:K,children:$})});x.displayName=i;const w=e+"CollectionItemSlot",A="data-radix-collection-item",P=Oe.forwardRef((D,V)=>{const{scope:L,children:$,...H}=D,K=Oe.useRef(null),Q=Ji(V,K),ae=c(w,L);return Oe.useEffect(()=>(ae.itemMap.set(K,{ref:K,...H}),()=>void ae.itemMap.delete(K))),l.jsx(Ql,{[A]:"",ref:Q,children:$})});P.displayName=w;function E(D){const V=c(e+"CollectionConsumer",D);return Oe.useCallback(()=>{const $=V.collectionRef.current;if(!$)return[];const H=Array.from($.querySelectorAll(`[${A}]`));return Array.from(V.itemMap.values()).sort((ae,ee)=>H.indexOf(ae.ref.current)-H.indexOf(ee.ref.current))},[V.collectionRef,V.itemMap])}return[{Provider:f,Slot:x,ItemSlot:P},E,n]}var qde=W.createContext(void 0);function nD(e){const t=W.useContext(qde);return e||t||"ltr"}function Gde(e,t=globalThis==null?void 0:globalThis.document){const r=Lu(e);W.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Wde="DismissableLayer",oR="dismissableLayer.update",Hde="dismissableLayer.pointerDownOutside",Kde="dismissableLayer.focusOutside",HB,gH=W.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),x_=W.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:c,onInteractOutside:f,onDismiss:i,...x}=e,w=W.useContext(gH),[A,P]=W.useState(null),E=(A==null?void 0:A.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,D]=W.useState({}),V=Ji(t,ce=>P(ce)),L=Array.from(w.layers),[$]=[...w.layersWithOutsidePointerEventsDisabled].slice(-1),H=L.indexOf($),K=A?L.indexOf(A):-1,Q=w.layersWithOutsidePointerEventsDisabled.size>0,ae=K>=H,ee=Xde(ce=>{const he=ce.target,Pe=[...w.branches].some(Ne=>Ne.contains(he));!ae||Pe||(a==null||a(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},E),se=Jde(ce=>{const he=ce.target;[...w.branches].some(Ne=>Ne.contains(he))||(c==null||c(ce),f==null||f(ce),ce.defaultPrevented||i==null||i())},E);return Gde(ce=>{K===w.layers.size-1&&(n==null||n(ce),!ce.defaultPrevented&&i&&(ce.preventDefault(),i()))},E),W.useEffect(()=>{if(A)return r&&(w.layersWithOutsidePointerEventsDisabled.size===0&&(HB=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),w.layersWithOutsidePointerEventsDisabled.add(A)),w.layers.add(A),KB(),()=>{r&&w.layersWithOutsidePointerEventsDisabled.size===1&&(E.body.style.pointerEvents=HB)}},[A,E,r,w]),W.useEffect(()=>()=>{A&&(w.layers.delete(A),w.layersWithOutsidePointerEventsDisabled.delete(A),KB())},[A,w]),W.useEffect(()=>{const ce=()=>D({});return document.addEventListener(oR,ce),()=>document.removeEventListener(oR,ce)},[]),l.jsx(vi.div,{...x,ref:V,style:{pointerEvents:Q?ae?"auto":"none":void 0,...e.style},onFocusCapture:ln(e.onFocusCapture,se.onFocusCapture),onBlurCapture:ln(e.onBlurCapture,se.onBlurCapture),onPointerDownCapture:ln(e.onPointerDownCapture,ee.onPointerDownCapture)})});x_.displayName=Wde;var Zde="DismissableLayerBranch",Yde=W.forwardRef((e,t)=>{const r=W.useContext(gH),n=W.useRef(null),a=Ji(t,n);return W.useEffect(()=>{const c=n.current;if(c)return r.branches.add(c),()=>{r.branches.delete(c)}},[r.branches]),l.jsx(vi.div,{...e,ref:a})});Yde.displayName=Zde;function Xde(e,t=globalThis==null?void 0:globalThis.document){const r=Lu(e),n=W.useRef(!1),a=W.useRef(()=>{});return W.useEffect(()=>{const c=i=>{if(i.target&&!n.current){let x=function(){yH(Hde,r,w,{discrete:!0})};const w={originalEvent:i};i.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=x,t.addEventListener("click",a.current,{once:!0})):x()}else t.removeEventListener("click",a.current);n.current=!1},f=window.setTimeout(()=>{t.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(f),t.removeEventListener("pointerdown",c),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Jde(e,t=globalThis==null?void 0:globalThis.document){const r=Lu(e),n=W.useRef(!1);return W.useEffect(()=>{const a=c=>{c.target&&!n.current&&yH(Kde,r,{originalEvent:c},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function KB(){const e=new CustomEvent(oR);document.dispatchEvent(e)}function yH(e,t,r,{discrete:n}){const a=r.originalEvent.target,c=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?mH(a,c):a.dispatchEvent(c)}var rC=0;function _P(){W.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ZB()),document.body.insertAdjacentElement("beforeend",e[1]??ZB()),rC++,()=>{rC===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),rC--}},[])}function ZB(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var nC="focusScope.autoFocusOnMount",iC="focusScope.autoFocusOnUnmount",YB={bubbles:!1,cancelable:!0},Qde="FocusScope",$w=W.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:c,...f}=e,[i,x]=W.useState(null),w=Lu(a),A=Lu(c),P=W.useRef(null),E=Ji(t,L=>x(L)),D=W.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;W.useEffect(()=>{if(n){let L=function(Q){if(D.paused||!i)return;const ae=Q.target;i.contains(ae)?P.current=ae:Mg(P.current,{select:!0})},$=function(Q){if(D.paused||!i)return;const ae=Q.relatedTarget;ae!==null&&(i.contains(ae)||Mg(P.current,{select:!0}))},H=function(Q){if(document.activeElement===document.body)for(const ee of Q)ee.removedNodes.length>0&&Mg(i)};document.addEventListener("focusin",L),document.addEventListener("focusout",$);const K=new MutationObserver(H);return i&&K.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",L),document.removeEventListener("focusout",$),K.disconnect()}}},[n,i,D.paused]),W.useEffect(()=>{if(i){JB.add(D);const L=document.activeElement;if(!i.contains(L)){const H=new CustomEvent(nC,YB);i.addEventListener(nC,w),i.dispatchEvent(H),H.defaultPrevented||(ehe(ahe(vH(i)),{select:!0}),document.activeElement===L&&Mg(i))}return()=>{i.removeEventListener(nC,w),setTimeout(()=>{const H=new CustomEvent(iC,YB);i.addEventListener(iC,A),i.dispatchEvent(H),H.defaultPrevented||Mg(L??document.body,{select:!0}),i.removeEventListener(iC,A),JB.remove(D)},0)}}},[i,w,A,D]);const V=W.useCallback(L=>{if(!r&&!n||D.paused)return;const $=L.key==="Tab"&&!L.altKey&&!L.ctrlKey&&!L.metaKey,H=document.activeElement;if($&&H){const K=L.currentTarget,[Q,ae]=the(K);Q&&ae?!L.shiftKey&&H===ae?(L.preventDefault(),r&&Mg(Q,{select:!0})):L.shiftKey&&H===Q&&(L.preventDefault(),r&&Mg(ae,{select:!0})):H===K&&L.preventDefault()}},[r,n,D.paused]);return l.jsx(vi.div,{tabIndex:-1,...f,ref:E,onKeyDown:V})});$w.displayName=Qde;function ehe(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Mg(n,{select:t}),document.activeElement!==r)return}function the(e){const t=vH(e),r=XB(t,e),n=XB(t.reverse(),e);return[r,n]}function vH(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function XB(e,t){for(const r of e)if(!rhe(r,{upTo:t}))return r}function rhe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function nhe(e){return e instanceof HTMLInputElement&&"select"in e}function Mg(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&nhe(e)&&t&&e.select()}}var JB=ihe();function ihe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=QB(e,t),e.unshift(t)},remove(t){var r;e=QB(e,t),(r=e[0])==null||r.resume()}}}function QB(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function ahe(e){return e.filter(t=>t.tagName!=="A")}var dl=globalThis!=null&&globalThis.document?W.useLayoutEffect:()=>{},she=OW.useId||(()=>{}),ohe=0;function Rd(e){const[t,r]=W.useState(she());return dl(()=>{r(n=>n??String(ohe++))},[e]),t?`radix-${t}`:""}const lhe=["top","right","bottom","left"],Zg=Math.min,Nu=Math.max,OA=Math.round,kS=Math.floor,Wf=e=>({x:e,y:e}),che={left:"right",right:"left",bottom:"top",top:"bottom"},uhe={start:"end",end:"start"};function lR(e,t,r){return Nu(e,Zg(t,r))}function vm(e,t){return typeof e=="function"?e(t):e}function xm(e){return e.split("-")[0]}function __(e){return e.split("-")[1]}function iD(e){return e==="x"?"y":"x"}function aD(e){return e==="y"?"height":"width"}function Yg(e){return["top","bottom"].includes(xm(e))?"y":"x"}function sD(e){return iD(Yg(e))}function dhe(e,t,r){r===void 0&&(r=!1);const n=__(e),a=sD(e),c=aD(a);let f=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[c]>t.floating[c]&&(f=RA(f)),[f,RA(f)]}function hhe(e){const t=RA(e);return[cR(e),t,cR(t)]}function cR(e){return e.replace(/start|end/g,t=>uhe[t])}function fhe(e,t,r){const n=["left","right"],a=["right","left"],c=["top","bottom"],f=["bottom","top"];switch(e){case"top":case"bottom":return r?t?a:n:t?n:a;case"left":case"right":return t?c:f;default:return[]}}function phe(e,t,r,n){const a=__(e);let c=fhe(xm(e),r==="start",n);return a&&(c=c.map(f=>f+"-"+a),t&&(c=c.concat(c.map(cR)))),c}function RA(e){return e.replace(/left|right|bottom|top/g,t=>che[t])}function mhe(e){return{top:0,right:0,bottom:0,left:0,...e}}function xH(e){return typeof e!="number"?mhe(e):{top:e,right:e,bottom:e,left:e}}function IA(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function e6(e,t,r){let{reference:n,floating:a}=e;const c=Yg(t),f=sD(t),i=aD(f),x=xm(t),w=c==="y",A=n.x+n.width/2-a.width/2,P=n.y+n.height/2-a.height/2,E=n[i]/2-a[i]/2;let D;switch(x){case"top":D={x:A,y:n.y-a.height};break;case"bottom":D={x:A,y:n.y+n.height};break;case"right":D={x:n.x+n.width,y:P};break;case"left":D={x:n.x-a.width,y:P};break;default:D={x:n.x,y:n.y}}switch(__(t)){case"start":D[f]-=E*(r&&w?-1:1);break;case"end":D[f]+=E*(r&&w?-1:1);break}return D}const ghe=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:c=[],platform:f}=r,i=c.filter(Boolean),x=await(f.isRTL==null?void 0:f.isRTL(t));let w=await f.getElementRects({reference:e,floating:t,strategy:a}),{x:A,y:P}=e6(w,n,x),E=n,D={},V=0;for(let L=0;L<i.length;L++){const{name:$,fn:H}=i[L],{x:K,y:Q,data:ae,reset:ee}=await H({x:A,y:P,initialPlacement:n,placement:E,strategy:a,middlewareData:D,rects:w,platform:f,elements:{reference:e,floating:t}});A=K??A,P=Q??P,D={...D,[$]:{...D[$],...ae}},ee&&V<=50&&(V++,typeof ee=="object"&&(ee.placement&&(E=ee.placement),ee.rects&&(w=ee.rects===!0?await f.getElementRects({reference:e,floating:t,strategy:a}):ee.rects),{x:A,y:P}=e6(w,E,x)),L=-1)}return{x:A,y:P,placement:E,strategy:a,middlewareData:D}};async function N1(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:c,rects:f,elements:i,strategy:x}=e,{boundary:w="clippingAncestors",rootBoundary:A="viewport",elementContext:P="floating",altBoundary:E=!1,padding:D=0}=vm(t,e),V=xH(D),$=i[E?P==="floating"?"reference":"floating":P],H=IA(await c.getClippingRect({element:(r=await(c.isElement==null?void 0:c.isElement($)))==null||r?$:$.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(i.floating)),boundary:w,rootBoundary:A,strategy:x})),K=P==="floating"?{x:n,y:a,width:f.floating.width,height:f.floating.height}:f.reference,Q=await(c.getOffsetParent==null?void 0:c.getOffsetParent(i.floating)),ae=await(c.isElement==null?void 0:c.isElement(Q))?await(c.getScale==null?void 0:c.getScale(Q))||{x:1,y:1}:{x:1,y:1},ee=IA(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:K,offsetParent:Q,strategy:x}):K);return{top:(H.top-ee.top+V.top)/ae.y,bottom:(ee.bottom-H.bottom+V.bottom)/ae.y,left:(H.left-ee.left+V.left)/ae.x,right:(ee.right-H.right+V.right)/ae.x}}const yhe=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:c,platform:f,elements:i,middlewareData:x}=t,{element:w,padding:A=0}=vm(e,t)||{};if(w==null)return{};const P=xH(A),E={x:r,y:n},D=sD(a),V=aD(D),L=await f.getDimensions(w),$=D==="y",H=$?"top":"left",K=$?"bottom":"right",Q=$?"clientHeight":"clientWidth",ae=c.reference[V]+c.reference[D]-E[D]-c.floating[V],ee=E[D]-c.reference[D],se=await(f.getOffsetParent==null?void 0:f.getOffsetParent(w));let ce=se?se[Q]:0;(!ce||!await(f.isElement==null?void 0:f.isElement(se)))&&(ce=i.floating[Q]||c.floating[V]);const he=ae/2-ee/2,Pe=ce/2-L[V]/2-1,Ne=Zg(P[H],Pe),pe=Zg(P[K],Pe),je=Ne,xe=ce-L[V]-pe,Ce=ce/2-L[V]/2+he,ze=lR(je,Ce,xe),Te=!x.arrow&&__(a)!=null&&Ce!==ze&&c.reference[V]/2-(Ce<je?Ne:pe)-L[V]/2<0,Re=Te?Ce<je?Ce-je:Ce-xe:0;return{[D]:E[D]+Re,data:{[D]:ze,centerOffset:Ce-ze-Re,...Te&&{alignmentOffset:Re}},reset:Te}}}),vhe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:c,rects:f,initialPlacement:i,platform:x,elements:w}=t,{mainAxis:A=!0,crossAxis:P=!0,fallbackPlacements:E,fallbackStrategy:D="bestFit",fallbackAxisSideDirection:V="none",flipAlignment:L=!0,...$}=vm(e,t);if((r=c.arrow)!=null&&r.alignmentOffset)return{};const H=xm(a),K=Yg(i),Q=xm(i)===i,ae=await(x.isRTL==null?void 0:x.isRTL(w.floating)),ee=E||(Q||!L?[RA(i)]:hhe(i)),se=V!=="none";!E&&se&&ee.push(...phe(i,L,V,ae));const ce=[i,...ee],he=await N1(t,$),Pe=[];let Ne=((n=c.flip)==null?void 0:n.overflows)||[];if(A&&Pe.push(he[H]),P){const Ce=dhe(a,f,ae);Pe.push(he[Ce[0]],he[Ce[1]])}if(Ne=[...Ne,{placement:a,overflows:Pe}],!Pe.every(Ce=>Ce<=0)){var pe,je;const Ce=(((pe=c.flip)==null?void 0:pe.index)||0)+1,ze=ce[Ce];if(ze)return{data:{index:Ce,overflows:Ne},reset:{placement:ze}};let Te=(je=Ne.filter(Re=>Re.overflows[0]<=0).sort((Re,Fe)=>Re.overflows[1]-Fe.overflows[1])[0])==null?void 0:je.placement;if(!Te)switch(D){case"bestFit":{var xe;const Re=(xe=Ne.filter(Fe=>{if(se){const He=Yg(Fe.placement);return He===K||He==="y"}return!0}).map(Fe=>[Fe.placement,Fe.overflows.filter(He=>He>0).reduce((He,mt)=>He+mt,0)]).sort((Fe,He)=>Fe[1]-He[1])[0])==null?void 0:xe[0];Re&&(Te=Re);break}case"initialPlacement":Te=i;break}if(a!==Te)return{reset:{placement:Te}}}return{}}}};function t6(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function r6(e){return lhe.some(t=>e[t]>=0)}const xhe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=vm(e,t);switch(n){case"referenceHidden":{const c=await N1(t,{...a,elementContext:"reference"}),f=t6(c,r.reference);return{data:{referenceHiddenOffsets:f,referenceHidden:r6(f)}}}case"escaped":{const c=await N1(t,{...a,altBoundary:!0}),f=t6(c,r.floating);return{data:{escapedOffsets:f,escaped:r6(f)}}}default:return{}}}}};async function _he(e,t){const{placement:r,platform:n,elements:a}=e,c=await(n.isRTL==null?void 0:n.isRTL(a.floating)),f=xm(r),i=__(r),x=Yg(r)==="y",w=["left","top"].includes(f)?-1:1,A=c&&x?-1:1,P=vm(t,e);let{mainAxis:E,crossAxis:D,alignmentAxis:V}=typeof P=="number"?{mainAxis:P,crossAxis:0,alignmentAxis:null}:{mainAxis:P.mainAxis||0,crossAxis:P.crossAxis||0,alignmentAxis:P.alignmentAxis};return i&&typeof V=="number"&&(D=i==="end"?V*-1:V),x?{x:D*A,y:E*w}:{x:E*w,y:D*A}}const bhe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:c,placement:f,middlewareData:i}=t,x=await _he(t,e);return f===((r=i.offset)==null?void 0:r.placement)&&(n=i.arrow)!=null&&n.alignmentOffset?{}:{x:a+x.x,y:c+x.y,data:{...x,placement:f}}}}},whe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:c=!0,crossAxis:f=!1,limiter:i={fn:$=>{let{x:H,y:K}=$;return{x:H,y:K}}},...x}=vm(e,t),w={x:r,y:n},A=await N1(t,x),P=Yg(xm(a)),E=iD(P);let D=w[E],V=w[P];if(c){const $=E==="y"?"top":"left",H=E==="y"?"bottom":"right",K=D+A[$],Q=D-A[H];D=lR(K,D,Q)}if(f){const $=P==="y"?"top":"left",H=P==="y"?"bottom":"right",K=V+A[$],Q=V-A[H];V=lR(K,V,Q)}const L=i.fn({...t,[E]:D,[P]:V});return{...L,data:{x:L.x-r,y:L.y-n,enabled:{[E]:c,[P]:f}}}}}},She=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:c,middlewareData:f}=t,{offset:i=0,mainAxis:x=!0,crossAxis:w=!0}=vm(e,t),A={x:r,y:n},P=Yg(a),E=iD(P);let D=A[E],V=A[P];const L=vm(i,t),$=typeof L=="number"?{mainAxis:L,crossAxis:0}:{mainAxis:0,crossAxis:0,...L};if(x){const Q=E==="y"?"height":"width",ae=c.reference[E]-c.floating[Q]+$.mainAxis,ee=c.reference[E]+c.reference[Q]-$.mainAxis;D<ae?D=ae:D>ee&&(D=ee)}if(w){var H,K;const Q=E==="y"?"width":"height",ae=["top","left"].includes(xm(a)),ee=c.reference[P]-c.floating[Q]+(ae&&((H=f.offset)==null?void 0:H[P])||0)+(ae?0:$.crossAxis),se=c.reference[P]+c.reference[Q]+(ae?0:((K=f.offset)==null?void 0:K[P])||0)-(ae?$.crossAxis:0);V<ee?V=ee:V>se&&(V=se)}return{[E]:D,[P]:V}}}},Ahe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:c,platform:f,elements:i}=t,{apply:x=()=>{},...w}=vm(e,t),A=await N1(t,w),P=xm(a),E=__(a),D=Yg(a)==="y",{width:V,height:L}=c.floating;let $,H;P==="top"||P==="bottom"?($=P,H=E===(await(f.isRTL==null?void 0:f.isRTL(i.floating))?"start":"end")?"left":"right"):(H=P,$=E==="end"?"top":"bottom");const K=L-A.top-A.bottom,Q=V-A.left-A.right,ae=Zg(L-A[$],K),ee=Zg(V-A[H],Q),se=!t.middlewareData.shift;let ce=ae,he=ee;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(he=Q),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(ce=K),se&&!E){const Ne=Nu(A.left,0),pe=Nu(A.right,0),je=Nu(A.top,0),xe=Nu(A.bottom,0);D?he=V-2*(Ne!==0||pe!==0?Ne+pe:Nu(A.left,A.right)):ce=L-2*(je!==0||xe!==0?je+xe:Nu(A.top,A.bottom))}await x({...t,availableWidth:he,availableHeight:ce});const Pe=await f.getDimensions(i.floating);return V!==Pe.width||L!==Pe.height?{reset:{rects:!0}}:{}}}};function bP(){return typeof window<"u"}function b_(e){return _H(e)?(e.nodeName||"").toLowerCase():"#document"}function Eu(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function up(e){var t;return(t=(_H(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function _H(e){return bP()?e instanceof Node||e instanceof Eu(e).Node:!1}function qh(e){return bP()?e instanceof Element||e instanceof Eu(e).Element:!1}function ep(e){return bP()?e instanceof HTMLElement||e instanceof Eu(e).HTMLElement:!1}function n6(e){return!bP()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Eu(e).ShadowRoot}function qw(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Gh(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!["inline","contents"].includes(a)}function The(e){return["table","td","th"].includes(b_(e))}function wP(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function oD(e){const t=lD(),r=qh(e)?Gh(e):e;return["transform","translate","scale","rotate","perspective"].some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Phe(e){let t=Xg(e);for(;ep(t)&&!Nx(t);){if(oD(t))return t;if(wP(t))return null;t=Xg(t)}return null}function lD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Nx(e){return["html","body","#document"].includes(b_(e))}function Gh(e){return Eu(e).getComputedStyle(e)}function SP(e){return qh(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Xg(e){if(b_(e)==="html")return e;const t=e.assignedSlot||e.parentNode||n6(e)&&e.host||up(e);return n6(t)?t.host:t}function bH(e){const t=Xg(e);return Nx(t)?e.ownerDocument?e.ownerDocument.body:e.body:ep(t)&&qw(t)?t:bH(t)}function j1(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=bH(e),c=a===((n=e.ownerDocument)==null?void 0:n.body),f=Eu(a);if(c){const i=uR(f);return t.concat(f,f.visualViewport||[],qw(a)?a:[],i&&r?j1(i):[])}return t.concat(a,j1(a,[],r))}function uR(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function wH(e){const t=Gh(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=ep(e),c=a?e.offsetWidth:r,f=a?e.offsetHeight:n,i=OA(r)!==c||OA(n)!==f;return i&&(r=c,n=f),{width:r,height:n,$:i}}function cD(e){return qh(e)?e:e.contextElement}function xx(e){const t=cD(e);if(!ep(t))return Wf(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:c}=wH(t);let f=(c?OA(r.width):r.width)/n,i=(c?OA(r.height):r.height)/a;return(!f||!Number.isFinite(f))&&(f=1),(!i||!Number.isFinite(i))&&(i=1),{x:f,y:i}}const Nhe=Wf(0);function SH(e){const t=Eu(e);return!lD()||!t.visualViewport?Nhe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function jhe(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Eu(e)?!1:t}function z0(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),c=cD(e);let f=Wf(1);t&&(n?qh(n)&&(f=xx(n)):f=xx(e));const i=jhe(c,r,n)?SH(c):Wf(0);let x=(a.left+i.x)/f.x,w=(a.top+i.y)/f.y,A=a.width/f.x,P=a.height/f.y;if(c){const E=Eu(c),D=n&&qh(n)?Eu(n):n;let V=E,L=uR(V);for(;L&&n&&D!==V;){const $=xx(L),H=L.getBoundingClientRect(),K=Gh(L),Q=H.left+(L.clientLeft+parseFloat(K.paddingLeft))*$.x,ae=H.top+(L.clientTop+parseFloat(K.paddingTop))*$.y;x*=$.x,w*=$.y,A*=$.x,P*=$.y,x+=Q,w+=ae,V=Eu(L),L=uR(V)}}return IA({width:A,height:P,x,y:w})}function uD(e,t){const r=SP(e).scrollLeft;return t?t.left+r:z0(up(e)).left+r}function AH(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:uD(e,n)),c=n.top+t.scrollTop;return{x:a,y:c}}function Che(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const c=a==="fixed",f=up(n),i=t?wP(t.floating):!1;if(n===f||i&&c)return r;let x={scrollLeft:0,scrollTop:0},w=Wf(1);const A=Wf(0),P=ep(n);if((P||!P&&!c)&&((b_(n)!=="body"||qw(f))&&(x=SP(n)),ep(n))){const D=z0(n);w=xx(n),A.x=D.x+n.clientLeft,A.y=D.y+n.clientTop}const E=f&&!P&&!c?AH(f,x,!0):Wf(0);return{width:r.width*w.x,height:r.height*w.y,x:r.x*w.x-x.scrollLeft*w.x+A.x+E.x,y:r.y*w.y-x.scrollTop*w.y+A.y+E.y}}function khe(e){return Array.from(e.getClientRects())}function Ehe(e){const t=up(e),r=SP(e),n=e.ownerDocument.body,a=Nu(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),c=Nu(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let f=-r.scrollLeft+uD(e);const i=-r.scrollTop;return Gh(n).direction==="rtl"&&(f+=Nu(t.clientWidth,n.clientWidth)-a),{width:a,height:c,x:f,y:i}}function Mhe(e,t){const r=Eu(e),n=up(e),a=r.visualViewport;let c=n.clientWidth,f=n.clientHeight,i=0,x=0;if(a){c=a.width,f=a.height;const w=lD();(!w||w&&t==="fixed")&&(i=a.offsetLeft,x=a.offsetTop)}return{width:c,height:f,x:i,y:x}}function Ohe(e,t){const r=z0(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,c=ep(e)?xx(e):Wf(1),f=e.clientWidth*c.x,i=e.clientHeight*c.y,x=a*c.x,w=n*c.y;return{width:f,height:i,x,y:w}}function i6(e,t,r){let n;if(t==="viewport")n=Mhe(e,r);else if(t==="document")n=Ehe(up(e));else if(qh(t))n=Ohe(t,r);else{const a=SH(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return IA(n)}function TH(e,t){const r=Xg(e);return r===t||!qh(r)||Nx(r)?!1:Gh(r).position==="fixed"||TH(r,t)}function Rhe(e,t){const r=t.get(e);if(r)return r;let n=j1(e,[],!1).filter(i=>qh(i)&&b_(i)!=="body"),a=null;const c=Gh(e).position==="fixed";let f=c?Xg(e):e;for(;qh(f)&&!Nx(f);){const i=Gh(f),x=oD(f);!x&&i.position==="fixed"&&(a=null),(c?!x&&!a:!x&&i.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||qw(f)&&!x&&TH(e,f))?n=n.filter(A=>A!==f):a=i,f=Xg(f)}return t.set(e,n),n}function Ihe(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const f=[...r==="clippingAncestors"?wP(t)?[]:Rhe(t,this._c):[].concat(r),n],i=f[0],x=f.reduce((w,A)=>{const P=i6(t,A,a);return w.top=Nu(P.top,w.top),w.right=Zg(P.right,w.right),w.bottom=Zg(P.bottom,w.bottom),w.left=Nu(P.left,w.left),w},i6(t,i,a));return{width:x.right-x.left,height:x.bottom-x.top,x:x.left,y:x.top}}function Dhe(e){const{width:t,height:r}=wH(e);return{width:t,height:r}}function Lhe(e,t,r){const n=ep(t),a=up(t),c=r==="fixed",f=z0(e,!0,c,t);let i={scrollLeft:0,scrollTop:0};const x=Wf(0);if(n||!n&&!c)if((b_(t)!=="body"||qw(a))&&(i=SP(t)),n){const E=z0(t,!0,c,t);x.x=E.x+t.clientLeft,x.y=E.y+t.clientTop}else a&&(x.x=uD(a));const w=a&&!n&&!c?AH(a,i):Wf(0),A=f.left+i.scrollLeft-x.x-w.x,P=f.top+i.scrollTop-x.y-w.y;return{x:A,y:P,width:f.width,height:f.height}}function aC(e){return Gh(e).position==="static"}function a6(e,t){if(!ep(e)||Gh(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return up(e)===r&&(r=r.ownerDocument.body),r}function PH(e,t){const r=Eu(e);if(wP(e))return r;if(!ep(e)){let a=Xg(e);for(;a&&!Nx(a);){if(qh(a)&&!aC(a))return a;a=Xg(a)}return r}let n=a6(e,t);for(;n&&The(n)&&aC(n);)n=a6(n,t);return n&&Nx(n)&&aC(n)&&!oD(n)?r:n||Phe(e)||r}const zhe=async function(e){const t=this.getOffsetParent||PH,r=this.getDimensions,n=await r(e.floating);return{reference:Lhe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Fhe(e){return Gh(e).direction==="rtl"}const Bhe={convertOffsetParentRelativeRectToViewportRelativeRect:Che,getDocumentElement:up,getClippingRect:Ihe,getOffsetParent:PH,getElementRects:zhe,getClientRects:khe,getDimensions:Dhe,getScale:xx,isElement:qh,isRTL:Fhe};function NH(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Vhe(e,t){let r=null,n;const a=up(e);function c(){var i;clearTimeout(n),(i=r)==null||i.disconnect(),r=null}function f(i,x){i===void 0&&(i=!1),x===void 0&&(x=1),c();const w=e.getBoundingClientRect(),{left:A,top:P,width:E,height:D}=w;if(i||t(),!E||!D)return;const V=kS(P),L=kS(a.clientWidth-(A+E)),$=kS(a.clientHeight-(P+D)),H=kS(A),Q={rootMargin:-V+"px "+-L+"px "+-$+"px "+-H+"px",threshold:Nu(0,Zg(1,x))||1};let ae=!0;function ee(se){const ce=se[0].intersectionRatio;if(ce!==x){if(!ae)return f();ce?f(!1,ce):n=setTimeout(()=>{f(!1,1e-7)},1e3)}ce===1&&!NH(w,e.getBoundingClientRect())&&f(),ae=!1}try{r=new IntersectionObserver(ee,{...Q,root:a.ownerDocument})}catch{r=new IntersectionObserver(ee,Q)}r.observe(e)}return f(!0),c}function Uhe(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:c=!0,elementResize:f=typeof ResizeObserver=="function",layoutShift:i=typeof IntersectionObserver=="function",animationFrame:x=!1}=n,w=cD(e),A=a||c?[...w?j1(w):[],...j1(t)]:[];A.forEach(H=>{a&&H.addEventListener("scroll",r,{passive:!0}),c&&H.addEventListener("resize",r)});const P=w&&i?Vhe(w,r):null;let E=-1,D=null;f&&(D=new ResizeObserver(H=>{let[K]=H;K&&K.target===w&&D&&(D.unobserve(t),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{var Q;(Q=D)==null||Q.observe(t)})),r()}),w&&!x&&D.observe(w),D.observe(t));let V,L=x?z0(e):null;x&&$();function $(){const H=z0(e);L&&!NH(L,H)&&r(),L=H,V=requestAnimationFrame($)}return r(),()=>{var H;A.forEach(K=>{a&&K.removeEventListener("scroll",r),c&&K.removeEventListener("resize",r)}),P==null||P(),(H=D)==null||H.disconnect(),D=null,x&&cancelAnimationFrame(V)}}const $he=bhe,qhe=whe,Ghe=vhe,Whe=Ahe,Hhe=xhe,s6=yhe,Khe=She,Zhe=(e,t,r)=>{const n=new Map,a={platform:Bhe,...r},c={...a.platform,_c:n};return ghe(e,t,{...a,platform:c})};var hA=typeof document<"u"?W.useLayoutEffect:W.useEffect;function DA(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!DA(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const c=a[n];if(!(c==="_owner"&&e.$$typeof)&&!DA(e[c],t[c]))return!1}return!0}return e!==e&&t!==t}function jH(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function o6(e,t){const r=jH(e);return Math.round(t*r)/r}function sC(e){const t=W.useRef(e);return hA(()=>{t.current=e}),t}function Yhe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:c,floating:f}={},transform:i=!0,whileElementsMounted:x,open:w}=e,[A,P]=W.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[E,D]=W.useState(n);DA(E,n)||D(n);const[V,L]=W.useState(null),[$,H]=W.useState(null),K=W.useCallback(Fe=>{Fe!==se.current&&(se.current=Fe,L(Fe))},[]),Q=W.useCallback(Fe=>{Fe!==ce.current&&(ce.current=Fe,H(Fe))},[]),ae=c||V,ee=f||$,se=W.useRef(null),ce=W.useRef(null),he=W.useRef(A),Pe=x!=null,Ne=sC(x),pe=sC(a),je=sC(w),xe=W.useCallback(()=>{if(!se.current||!ce.current)return;const Fe={placement:t,strategy:r,middleware:E};pe.current&&(Fe.platform=pe.current),Zhe(se.current,ce.current,Fe).then(He=>{const mt={...He,isPositioned:je.current!==!1};Ce.current&&!DA(he.current,mt)&&(he.current=mt,zw.flushSync(()=>{P(mt)}))})},[E,t,r,pe,je]);hA(()=>{w===!1&&he.current.isPositioned&&(he.current.isPositioned=!1,P(Fe=>({...Fe,isPositioned:!1})))},[w]);const Ce=W.useRef(!1);hA(()=>(Ce.current=!0,()=>{Ce.current=!1}),[]),hA(()=>{if(ae&&(se.current=ae),ee&&(ce.current=ee),ae&&ee){if(Ne.current)return Ne.current(ae,ee,xe);xe()}},[ae,ee,xe,Ne,Pe]);const ze=W.useMemo(()=>({reference:se,floating:ce,setReference:K,setFloating:Q}),[K,Q]),Te=W.useMemo(()=>({reference:ae,floating:ee}),[ae,ee]),Re=W.useMemo(()=>{const Fe={position:r,left:0,top:0};if(!Te.floating)return Fe;const He=o6(Te.floating,A.x),mt=o6(Te.floating,A.y);return i?{...Fe,transform:"translate("+He+"px, "+mt+"px)",...jH(Te.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:He,top:mt}},[r,i,Te.floating,A.x,A.y]);return W.useMemo(()=>({...A,update:xe,refs:ze,elements:Te,floatingStyles:Re}),[A,xe,ze,Te,Re])}const Xhe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?s6({element:n.current,padding:a}).fn(r):{}:n?s6({element:n,padding:a}).fn(r):{}}}},Jhe=(e,t)=>({...$he(e),options:[e,t]}),Qhe=(e,t)=>({...qhe(e),options:[e,t]}),efe=(e,t)=>({...Khe(e),options:[e,t]}),tfe=(e,t)=>({...Ghe(e),options:[e,t]}),rfe=(e,t)=>({...Whe(e),options:[e,t]}),nfe=(e,t)=>({...Hhe(e),options:[e,t]}),ife=(e,t)=>({...Xhe(e),options:[e,t]});var afe="Arrow",CH=W.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...c}=e;return l.jsx(vi.svg,{...c,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});CH.displayName=afe;var sfe=CH;function ofe(e){const[t,r]=W.useState(void 0);return dl(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let f,i;if("borderBoxSize"in c){const x=c.borderBoxSize,w=Array.isArray(x)?x[0]:x;f=w.inlineSize,i=w.blockSize}else f=e.offsetWidth,i=e.offsetHeight;r({width:f,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var dD="Popper",[kH,ly]=Vd(dD),[lfe,EH]=kH(dD),MH=e=>{const{__scopePopper:t,children:r}=e,[n,a]=W.useState(null);return l.jsx(lfe,{scope:t,anchor:n,onAnchorChange:a,children:r})};MH.displayName=dD;var OH="PopperAnchor",RH=W.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,c=EH(OH,r),f=W.useRef(null),i=Ji(t,f);return W.useEffect(()=>{c.onAnchorChange((n==null?void 0:n.current)||f.current)}),n?null:l.jsx(vi.div,{...a,ref:i})});RH.displayName=OH;var hD="PopperContent",[cfe,ufe]=kH(hD),IH=W.forwardRef((e,t)=>{var rr,ir,Bt,De,jr,Dt;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:c="center",alignOffset:f=0,arrowPadding:i=0,avoidCollisions:x=!0,collisionBoundary:w=[],collisionPadding:A=0,sticky:P="partial",hideWhenDetached:E=!1,updatePositionStrategy:D="optimized",onPlaced:V,...L}=e,$=EH(hD,r),[H,K]=W.useState(null),Q=Ji(t,Cr=>K(Cr)),[ae,ee]=W.useState(null),se=ofe(ae),ce=(se==null?void 0:se.width)??0,he=(se==null?void 0:se.height)??0,Pe=n+(c!=="center"?"-"+c:""),Ne=typeof A=="number"?A:{top:0,right:0,bottom:0,left:0,...A},pe=Array.isArray(w)?w:[w],je=pe.length>0,xe={padding:Ne,boundary:pe.filter(hfe),altBoundary:je},{refs:Ce,floatingStyles:ze,placement:Te,isPositioned:Re,middlewareData:Fe}=Yhe({strategy:"fixed",placement:Pe,whileElementsMounted:(...Cr)=>Uhe(...Cr,{animationFrame:D==="always"}),elements:{reference:$.anchor},middleware:[Jhe({mainAxis:a+he,alignmentAxis:f}),x&&Qhe({mainAxis:!0,crossAxis:!1,limiter:P==="partial"?efe():void 0,...xe}),x&&tfe({...xe}),rfe({...xe,apply:({elements:Cr,rects:At,availableWidth:qr,availableHeight:an})=>{const{width:Jn,height:tt}=At.reference,xt=Cr.floating.style;xt.setProperty("--radix-popper-available-width",`${qr}px`),xt.setProperty("--radix-popper-available-height",`${an}px`),xt.setProperty("--radix-popper-anchor-width",`${Jn}px`),xt.setProperty("--radix-popper-anchor-height",`${tt}px`)}}),ae&&ife({element:ae,padding:i}),ffe({arrowWidth:ce,arrowHeight:he}),E&&nfe({strategy:"referenceHidden",...xe})]}),[He,mt]=zH(Te),Xe=Lu(V);dl(()=>{Re&&(Xe==null||Xe())},[Re,Xe]);const ot=(rr=Fe.arrow)==null?void 0:rr.x,qe=(ir=Fe.arrow)==null?void 0:ir.y,Lt=((Bt=Fe.arrow)==null?void 0:Bt.centerOffset)!==0,[Zt,Xt]=W.useState();return dl(()=>{H&&Xt(window.getComputedStyle(H).zIndex)},[H]),l.jsx("div",{ref:Ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...ze,transform:Re?ze.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Zt,"--radix-popper-transform-origin":[(De=Fe.transformOrigin)==null?void 0:De.x,(jr=Fe.transformOrigin)==null?void 0:jr.y].join(" "),...((Dt=Fe.hide)==null?void 0:Dt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:l.jsx(cfe,{scope:r,placedSide:He,onArrowChange:ee,arrowX:ot,arrowY:qe,shouldHideArrow:Lt,children:l.jsx(vi.div,{"data-side":He,"data-align":mt,...L,ref:Q,style:{...L.style,animation:Re?void 0:"none"}})})})});IH.displayName=hD;var DH="PopperArrow",dfe={top:"bottom",right:"left",bottom:"top",left:"right"},LH=W.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,c=ufe(DH,n),f=dfe[c.placedSide];return l.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[f]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:l.jsx(sfe,{...a,ref:r,style:{...a.style,display:"block"}})})});LH.displayName=DH;function hfe(e){return e!==null}var ffe=e=>({name:"transformOrigin",options:e,fn(t){var $,H,K;const{placement:r,rects:n,middlewareData:a}=t,f=(($=a.arrow)==null?void 0:$.centerOffset)!==0,i=f?0:e.arrowWidth,x=f?0:e.arrowHeight,[w,A]=zH(r),P={start:"0%",center:"50%",end:"100%"}[A],E=(((H=a.arrow)==null?void 0:H.x)??0)+i/2,D=(((K=a.arrow)==null?void 0:K.y)??0)+x/2;let V="",L="";return w==="bottom"?(V=f?P:`${E}px`,L=`${-x}px`):w==="top"?(V=f?P:`${E}px`,L=`${n.floating.height+x}px`):w==="right"?(V=`${-x}px`,L=f?P:`${D}px`):w==="left"&&(V=`${n.floating.width+x}px`,L=f?P:`${D}px`),{data:{x:V,y:L}}}});function zH(e){const[t,r="center"]=e.split("-");return[t,r]}var AP=MH,Gw=RH,TP=IH,PP=LH,pfe="Portal",w_=W.forwardRef((e,t)=>{var i;const{container:r,...n}=e,[a,c]=W.useState(!1);dl(()=>c(!0),[]);const f=r||a&&((i=globalThis==null?void 0:globalThis.document)==null?void 0:i.body);return f?IW.createPortal(l.jsx(vi.div,{...n,ref:t}),f):null});w_.displayName=pfe;function mfe(e,t){return W.useReducer((r,n)=>t[r][n]??r,e)}var Vu=e=>{const{present:t,children:r}=e,n=gfe(t),a=typeof r=="function"?r({present:n.isPresent}):W.Children.only(r),c=Ji(n.ref,yfe(a));return typeof r=="function"||n.isPresent?W.cloneElement(a,{ref:c}):null};Vu.displayName="Presence";function gfe(e){const[t,r]=W.useState(),n=W.useRef({}),a=W.useRef(e),c=W.useRef("none"),f=e?"mounted":"unmounted",[i,x]=mfe(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const w=ES(n.current);c.current=i==="mounted"?w:"none"},[i]),dl(()=>{const w=n.current,A=a.current;if(A!==e){const E=c.current,D=ES(w);e?x("MOUNT"):D==="none"||(w==null?void 0:w.display)==="none"?x("UNMOUNT"):x(A&&E!==D?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,x]),dl(()=>{if(t){let w;const A=t.ownerDocument.defaultView??window,P=D=>{const L=ES(n.current).includes(D.animationName);if(D.target===t&&L&&(x("ANIMATION_END"),!a.current)){const $=t.style.animationFillMode;t.style.animationFillMode="forwards",w=A.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=$)})}},E=D=>{D.target===t&&(c.current=ES(n.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",P),t.addEventListener("animationend",P),()=>{A.clearTimeout(w),t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",P),t.removeEventListener("animationend",P)}}else x("ANIMATION_END")},[t,x]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:W.useCallback(w=>{w&&(n.current=getComputedStyle(w)),r(w)},[])}}function ES(e){return(e==null?void 0:e.animationName)||"none"}function yfe(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var oC="rovingFocusGroup.onEntryFocus",vfe={bubbles:!1,cancelable:!0},NP="RovingFocusGroup",[dR,FH,xfe]=rD(NP),[_fe,BH]=Vd(NP,[xfe]),[bfe,wfe]=_fe(NP),VH=W.forwardRef((e,t)=>l.jsx(dR.Provider,{scope:e.__scopeRovingFocusGroup,children:l.jsx(dR.Slot,{scope:e.__scopeRovingFocusGroup,children:l.jsx(Sfe,{...e,ref:t})})}));VH.displayName=NP;var Sfe=W.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:c,currentTabStopId:f,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:x,onEntryFocus:w,preventScrollOnEntryFocus:A=!1,...P}=e,E=W.useRef(null),D=Ji(t,E),V=nD(c),[L=null,$]=Kg({prop:f,defaultProp:i,onChange:x}),[H,K]=W.useState(!1),Q=Lu(w),ae=FH(r),ee=W.useRef(!1),[se,ce]=W.useState(0);return W.useEffect(()=>{const he=E.current;if(he)return he.addEventListener(oC,Q),()=>he.removeEventListener(oC,Q)},[Q]),l.jsx(bfe,{scope:r,orientation:n,dir:V,loop:a,currentTabStopId:L,onItemFocus:W.useCallback(he=>$(he),[$]),onItemShiftTab:W.useCallback(()=>K(!0),[]),onFocusableItemAdd:W.useCallback(()=>ce(he=>he+1),[]),onFocusableItemRemove:W.useCallback(()=>ce(he=>he-1),[]),children:l.jsx(vi.div,{tabIndex:H||se===0?-1:0,"data-orientation":n,...P,ref:D,style:{outline:"none",...e.style},onMouseDown:ln(e.onMouseDown,()=>{ee.current=!0}),onFocus:ln(e.onFocus,he=>{const Pe=!ee.current;if(he.target===he.currentTarget&&Pe&&!H){const Ne=new CustomEvent(oC,vfe);if(he.currentTarget.dispatchEvent(Ne),!Ne.defaultPrevented){const pe=ae().filter(Te=>Te.focusable),je=pe.find(Te=>Te.active),xe=pe.find(Te=>Te.id===L),ze=[je,xe,...pe].filter(Boolean).map(Te=>Te.ref.current);qH(ze,A)}}ee.current=!1}),onBlur:ln(e.onBlur,()=>K(!1))})})}),UH="RovingFocusGroupItem",$H=W.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:c,...f}=e,i=Rd(),x=c||i,w=wfe(UH,r),A=w.currentTabStopId===x,P=FH(r),{onFocusableItemAdd:E,onFocusableItemRemove:D}=w;return W.useEffect(()=>{if(n)return E(),()=>D()},[n,E,D]),l.jsx(dR.ItemSlot,{scope:r,id:x,focusable:n,active:a,children:l.jsx(vi.span,{tabIndex:A?0:-1,"data-orientation":w.orientation,...f,ref:t,onMouseDown:ln(e.onMouseDown,V=>{n?w.onItemFocus(x):V.preventDefault()}),onFocus:ln(e.onFocus,()=>w.onItemFocus(x)),onKeyDown:ln(e.onKeyDown,V=>{if(V.key==="Tab"&&V.shiftKey){w.onItemShiftTab();return}if(V.target!==V.currentTarget)return;const L=Pfe(V,w.orientation,w.dir);if(L!==void 0){if(V.metaKey||V.ctrlKey||V.altKey||V.shiftKey)return;V.preventDefault();let H=P().filter(K=>K.focusable).map(K=>K.ref.current);if(L==="last")H.reverse();else if(L==="prev"||L==="next"){L==="prev"&&H.reverse();const K=H.indexOf(V.currentTarget);H=w.loop?Nfe(H,K+1):H.slice(K+1)}setTimeout(()=>qH(H))}})})})});$H.displayName=UH;var Afe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Tfe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Pfe(e,t,r){const n=Tfe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Afe[n]}function qH(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function Nfe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var jfe=VH,Cfe=$H,kfe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Yv=new WeakMap,MS=new WeakMap,OS={},lC=0,GH=function(e){return e&&(e.host||GH(e.parentNode))},Efe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=GH(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Mfe=function(e,t,r,n){var a=Efe(t,Array.isArray(e)?e:[e]);OS[r]||(OS[r]=new WeakMap);var c=OS[r],f=[],i=new Set,x=new Set(a),w=function(P){!P||i.has(P)||(i.add(P),w(P.parentNode))};a.forEach(w);var A=function(P){!P||x.has(P)||Array.prototype.forEach.call(P.children,function(E){if(i.has(E))A(E);else try{var D=E.getAttribute(n),V=D!==null&&D!=="false",L=(Yv.get(E)||0)+1,$=(c.get(E)||0)+1;Yv.set(E,L),c.set(E,$),f.push(E),L===1&&V&&MS.set(E,!0),$===1&&E.setAttribute(r,"true"),V||E.setAttribute(n,"true")}catch(H){console.error("aria-hidden: cannot operate on ",E,H)}})};return A(t),i.clear(),lC++,function(){f.forEach(function(P){var E=Yv.get(P)-1,D=c.get(P)-1;Yv.set(P,E),c.set(P,D),E||(MS.has(P)||P.removeAttribute(n),MS.delete(P)),D||P.removeAttribute(r)}),lC--,lC||(Yv=new WeakMap,Yv=new WeakMap,MS=new WeakMap,OS={})}},jP=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=kfe(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live]"))),Mfe(n,a,r,"aria-hidden")):function(){return null}},Bf=function(){return Bf=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Bf.apply(this,arguments)};function WH(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Ofe(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,c;n<a;n++)(c||!(n in t))&&(c||(c=Array.prototype.slice.call(t,0,n)),c[n]=t[n]);return e.concat(c||Array.prototype.slice.call(t))}var fA="right-scroll-bar-position",pA="width-before-scroll-bar",Rfe="with-scroll-bars-hidden",Ife="--removed-body-scroll-bar-size";function cC(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Dfe(e,t){var r=W.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var Lfe=typeof window<"u"?W.useLayoutEffect:W.useEffect,l6=new WeakMap;function zfe(e,t){var r=Dfe(null,function(n){return e.forEach(function(a){return cC(a,n)})});return Lfe(function(){var n=l6.get(r);if(n){var a=new Set(n),c=new Set(e),f=r.current;a.forEach(function(i){c.has(i)||cC(i,null)}),c.forEach(function(i){a.has(i)||cC(i,f)})}l6.set(r,e)},[e]),r}function Ffe(e){return e}function Bfe(e,t){t===void 0&&(t=Ffe);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(c){var f=t(c,n);return r.push(f),function(){r=r.filter(function(i){return i!==f})}},assignSyncMedium:function(c){for(n=!0;r.length;){var f=r;r=[],f.forEach(c)}r={push:function(i){return c(i)},filter:function(){return r}}},assignMedium:function(c){n=!0;var f=[];if(r.length){var i=r;r=[],i.forEach(c),f=r}var x=function(){var A=f;f=[],A.forEach(c)},w=function(){return Promise.resolve().then(x)};w(),r={push:function(A){f.push(A),w()},filter:function(A){return f=f.filter(A),r}}}};return a}function Vfe(e){e===void 0&&(e={});var t=Bfe(null);return t.options=Bf({async:!0,ssr:!1},e),t}var HH=function(e){var t=e.sideCar,r=WH(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return W.createElement(n,Bf({},r))};HH.isSideCarExport=!0;function Ufe(e,t){return e.useMedium(t),HH}var KH=Vfe(),uC=function(){},CP=W.forwardRef(function(e,t){var r=W.useRef(null),n=W.useState({onScrollCapture:uC,onWheelCapture:uC,onTouchMoveCapture:uC}),a=n[0],c=n[1],f=e.forwardProps,i=e.children,x=e.className,w=e.removeScrollBar,A=e.enabled,P=e.shards,E=e.sideCar,D=e.noIsolation,V=e.inert,L=e.allowPinchZoom,$=e.as,H=$===void 0?"div":$,K=e.gapMode,Q=WH(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),ae=E,ee=zfe([r,t]),se=Bf(Bf({},Q),a);return W.createElement(W.Fragment,null,A&&W.createElement(ae,{sideCar:KH,removeScrollBar:w,shards:P,noIsolation:D,inert:V,setCallbacks:c,allowPinchZoom:!!L,lockRef:r,gapMode:K}),f?W.cloneElement(W.Children.only(i),Bf(Bf({},se),{ref:ee})):W.createElement(H,Bf({},se,{className:x,ref:ee}),i))});CP.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};CP.classNames={fullWidth:pA,zeroRight:fA};var $fe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function qfe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=$fe();return t&&e.setAttribute("nonce",t),e}function Gfe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Wfe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Hfe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=qfe())&&(Gfe(t,r),Wfe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Kfe=function(){var e=Hfe();return function(t,r){W.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},ZH=function(){var e=Kfe(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Zfe={left:0,top:0,right:0,gap:0},dC=function(e){return parseInt(e||"",10)||0},Yfe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[dC(r),dC(n),dC(a)]},Xfe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Zfe;var t=Yfe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Jfe=ZH(),_x="data-scroll-locked",Qfe=function(e,t,r,n){var a=e.left,c=e.top,f=e.right,i=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Rfe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(i,"px ").concat(n,`;
  }
  body[`).concat(_x,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(f,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(i,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(i,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(fA,` {
    right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(pA,` {
    margin-right: `).concat(i,"px ").concat(n,`;
  }
  
  .`).concat(fA," .").concat(fA,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(pA," .").concat(pA,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(_x,`] {
    `).concat(Ife,": ").concat(i,`px;
  }
`)},c6=function(){var e=parseInt(document.body.getAttribute(_x)||"0",10);return isFinite(e)?e:0},epe=function(){W.useEffect(function(){return document.body.setAttribute(_x,(c6()+1).toString()),function(){var e=c6()-1;e<=0?document.body.removeAttribute(_x):document.body.setAttribute(_x,e.toString())}},[])},tpe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;epe();var c=W.useMemo(function(){return Xfe(a)},[a]);return W.createElement(Jfe,{styles:Qfe(c,!t,a,r?"":"!important")})},hR=!1;if(typeof window<"u")try{var RS=Object.defineProperty({},"passive",{get:function(){return hR=!0,!0}});window.addEventListener("test",RS,RS),window.removeEventListener("test",RS,RS)}catch{hR=!1}var Xv=hR?{passive:!1}:!1,rpe=function(e){return e.tagName==="TEXTAREA"},YH=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!rpe(e)&&r[t]==="visible")},npe=function(e){return YH(e,"overflowY")},ipe=function(e){return YH(e,"overflowX")},u6=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=XH(e,n);if(a){var c=JH(e,n),f=c[1],i=c[2];if(f>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},ape=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},spe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},XH=function(e,t){return e==="v"?npe(t):ipe(t)},JH=function(e,t){return e==="v"?ape(t):spe(t)},ope=function(e,t){return e==="h"&&t==="rtl"?-1:1},lpe=function(e,t,r,n,a){var c=ope(e,window.getComputedStyle(t).direction),f=c*n,i=r.target,x=t.contains(i),w=!1,A=f>0,P=0,E=0;do{var D=JH(e,i),V=D[0],L=D[1],$=D[2],H=L-$-c*V;(V||H)&&XH(e,i)&&(P+=H,E+=V),i instanceof ShadowRoot?i=i.host:i=i.parentNode}while(!x&&i!==document.body||x&&(t.contains(i)||t===i));return(A&&Math.abs(P)<1||!A&&Math.abs(E)<1)&&(w=!0),w},IS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},d6=function(e){return[e.deltaX,e.deltaY]},h6=function(e){return e&&"current"in e?e.current:e},cpe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},upe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},dpe=0,Jv=[];function hpe(e){var t=W.useRef([]),r=W.useRef([0,0]),n=W.useRef(),a=W.useState(dpe++)[0],c=W.useState(ZH)[0],f=W.useRef(e);W.useEffect(function(){f.current=e},[e]),W.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var L=Ofe([e.lockRef.current],(e.shards||[]).map(h6),!0).filter(Boolean);return L.forEach(function($){return $.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),L.forEach(function($){return $.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var i=W.useCallback(function(L,$){if("touches"in L&&L.touches.length===2||L.type==="wheel"&&L.ctrlKey)return!f.current.allowPinchZoom;var H=IS(L),K=r.current,Q="deltaX"in L?L.deltaX:K[0]-H[0],ae="deltaY"in L?L.deltaY:K[1]-H[1],ee,se=L.target,ce=Math.abs(Q)>Math.abs(ae)?"h":"v";if("touches"in L&&ce==="h"&&se.type==="range")return!1;var he=u6(ce,se);if(!he)return!0;if(he?ee=ce:(ee=ce==="v"?"h":"v",he=u6(ce,se)),!he)return!1;if(!n.current&&"changedTouches"in L&&(Q||ae)&&(n.current=ee),!ee)return!0;var Pe=n.current||ee;return lpe(Pe,$,L,Pe==="h"?Q:ae)},[]),x=W.useCallback(function(L){var $=L;if(!(!Jv.length||Jv[Jv.length-1]!==c)){var H="deltaY"in $?d6($):IS($),K=t.current.filter(function(ee){return ee.name===$.type&&(ee.target===$.target||$.target===ee.shadowParent)&&cpe(ee.delta,H)})[0];if(K&&K.should){$.cancelable&&$.preventDefault();return}if(!K){var Q=(f.current.shards||[]).map(h6).filter(Boolean).filter(function(ee){return ee.contains($.target)}),ae=Q.length>0?i($,Q[0]):!f.current.noIsolation;ae&&$.cancelable&&$.preventDefault()}}},[]),w=W.useCallback(function(L,$,H,K){var Q={name:L,delta:$,target:H,should:K,shadowParent:fpe(H)};t.current.push(Q),setTimeout(function(){t.current=t.current.filter(function(ae){return ae!==Q})},1)},[]),A=W.useCallback(function(L){r.current=IS(L),n.current=void 0},[]),P=W.useCallback(function(L){w(L.type,d6(L),L.target,i(L,e.lockRef.current))},[]),E=W.useCallback(function(L){w(L.type,IS(L),L.target,i(L,e.lockRef.current))},[]);W.useEffect(function(){return Jv.push(c),e.setCallbacks({onScrollCapture:P,onWheelCapture:P,onTouchMoveCapture:E}),document.addEventListener("wheel",x,Xv),document.addEventListener("touchmove",x,Xv),document.addEventListener("touchstart",A,Xv),function(){Jv=Jv.filter(function(L){return L!==c}),document.removeEventListener("wheel",x,Xv),document.removeEventListener("touchmove",x,Xv),document.removeEventListener("touchstart",A,Xv)}},[]);var D=e.removeScrollBar,V=e.inert;return W.createElement(W.Fragment,null,V?W.createElement(c,{styles:upe(a)}):null,D?W.createElement(tpe,{gapMode:e.gapMode}):null)}function fpe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const ppe=Ufe(KH,hpe);var Ww=W.forwardRef(function(e,t){return W.createElement(CP,Bf({},e,{ref:t,sideCar:ppe}))});Ww.classNames=CP.classNames;var fR=["Enter"," "],mpe=["ArrowDown","PageUp","Home"],QH=["ArrowUp","PageDown","End"],gpe=[...mpe,...QH],ype={ltr:[...fR,"ArrowRight"],rtl:[...fR,"ArrowLeft"]},vpe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Hw="Menu",[C1,xpe,_pe]=rD(Hw),[Q0,eK]=Vd(Hw,[_pe,ly,BH]),kP=ly(),tK=BH(),[bpe,ev]=Q0(Hw),[wpe,Kw]=Q0(Hw),rK=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:c,modal:f=!0}=e,i=kP(t),[x,w]=W.useState(null),A=W.useRef(!1),P=Lu(c),E=nD(a);return W.useEffect(()=>{const D=()=>{A.current=!0,document.addEventListener("pointerdown",V,{capture:!0,once:!0}),document.addEventListener("pointermove",V,{capture:!0,once:!0})},V=()=>A.current=!1;return document.addEventListener("keydown",D,{capture:!0}),()=>{document.removeEventListener("keydown",D,{capture:!0}),document.removeEventListener("pointerdown",V,{capture:!0}),document.removeEventListener("pointermove",V,{capture:!0})}},[]),l.jsx(AP,{...i,children:l.jsx(bpe,{scope:t,open:r,onOpenChange:P,content:x,onContentChange:w,children:l.jsx(wpe,{scope:t,onClose:W.useCallback(()=>P(!1),[P]),isUsingKeyboardRef:A,dir:E,modal:f,children:n})})})};rK.displayName=Hw;var Spe="MenuAnchor",fD=W.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=kP(r);return l.jsx(Gw,{...a,...n,ref:t})});fD.displayName=Spe;var pD="MenuPortal",[Ape,nK]=Q0(pD,{forceMount:void 0}),iK=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,c=ev(pD,t);return l.jsx(Ape,{scope:t,forceMount:r,children:l.jsx(Vu,{present:r||c.open,children:l.jsx(w_,{asChild:!0,container:a,children:n})})})};iK.displayName=pD;var Id="MenuContent",[Tpe,mD]=Q0(Id),aK=W.forwardRef((e,t)=>{const r=nK(Id,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,c=ev(Id,e.__scopeMenu),f=Kw(Id,e.__scopeMenu);return l.jsx(C1.Provider,{scope:e.__scopeMenu,children:l.jsx(Vu,{present:n||c.open,children:l.jsx(C1.Slot,{scope:e.__scopeMenu,children:f.modal?l.jsx(Ppe,{...a,ref:t}):l.jsx(Npe,{...a,ref:t})})})})}),Ppe=W.forwardRef((e,t)=>{const r=ev(Id,e.__scopeMenu),n=W.useRef(null),a=Ji(t,n);return W.useEffect(()=>{const c=n.current;if(c)return jP(c)},[]),l.jsx(gD,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ln(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Npe=W.forwardRef((e,t)=>{const r=ev(Id,e.__scopeMenu);return l.jsx(gD,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),gD=W.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:c,onCloseAutoFocus:f,disableOutsidePointerEvents:i,onEntryFocus:x,onEscapeKeyDown:w,onPointerDownOutside:A,onFocusOutside:P,onInteractOutside:E,onDismiss:D,disableOutsideScroll:V,...L}=e,$=ev(Id,r),H=Kw(Id,r),K=kP(r),Q=tK(r),ae=xpe(r),[ee,se]=W.useState(null),ce=W.useRef(null),he=Ji(t,ce,$.onContentChange),Pe=W.useRef(0),Ne=W.useRef(""),pe=W.useRef(0),je=W.useRef(null),xe=W.useRef("right"),Ce=W.useRef(0),ze=V?Ww:W.Fragment,Te=V?{as:Ql,allowPinchZoom:!0}:void 0,Re=He=>{var rr,ir;const mt=Ne.current+He,Xe=ae().filter(Bt=>!Bt.disabled),ot=document.activeElement,qe=(rr=Xe.find(Bt=>Bt.ref.current===ot))==null?void 0:rr.textValue,Lt=Xe.map(Bt=>Bt.textValue),Zt=Fpe(Lt,mt,qe),Xt=(ir=Xe.find(Bt=>Bt.textValue===Zt))==null?void 0:ir.ref.current;(function Bt(De){Ne.current=De,window.clearTimeout(Pe.current),De!==""&&(Pe.current=window.setTimeout(()=>Bt(""),1e3))})(mt),Xt&&setTimeout(()=>Xt.focus())};W.useEffect(()=>()=>window.clearTimeout(Pe.current),[]),_P();const Fe=W.useCallback(He=>{var Xe,ot;return xe.current===((Xe=je.current)==null?void 0:Xe.side)&&Vpe(He,(ot=je.current)==null?void 0:ot.area)},[]);return l.jsx(Tpe,{scope:r,searchRef:Ne,onItemEnter:W.useCallback(He=>{Fe(He)&&He.preventDefault()},[Fe]),onItemLeave:W.useCallback(He=>{var mt;Fe(He)||((mt=ce.current)==null||mt.focus(),se(null))},[Fe]),onTriggerLeave:W.useCallback(He=>{Fe(He)&&He.preventDefault()},[Fe]),pointerGraceTimerRef:pe,onPointerGraceIntentChange:W.useCallback(He=>{je.current=He},[]),children:l.jsx(ze,{...Te,children:l.jsx($w,{asChild:!0,trapped:a,onMountAutoFocus:ln(c,He=>{var mt;He.preventDefault(),(mt=ce.current)==null||mt.focus({preventScroll:!0})}),onUnmountAutoFocus:f,children:l.jsx(x_,{asChild:!0,disableOutsidePointerEvents:i,onEscapeKeyDown:w,onPointerDownOutside:A,onFocusOutside:P,onInteractOutside:E,onDismiss:D,children:l.jsx(jfe,{asChild:!0,...Q,dir:H.dir,orientation:"vertical",loop:n,currentTabStopId:ee,onCurrentTabStopIdChange:se,onEntryFocus:ln(x,He=>{H.isUsingKeyboardRef.current||He.preventDefault()}),preventScrollOnEntryFocus:!0,children:l.jsx(TP,{role:"menu","aria-orientation":"vertical","data-state":bK($.open),"data-radix-menu-content":"",dir:H.dir,...K,...L,ref:he,style:{outline:"none",...L.style},onKeyDown:ln(L.onKeyDown,He=>{const Xe=He.target.closest("[data-radix-menu-content]")===He.currentTarget,ot=He.ctrlKey||He.altKey||He.metaKey,qe=He.key.length===1;Xe&&(He.key==="Tab"&&He.preventDefault(),!ot&&qe&&Re(He.key));const Lt=ce.current;if(He.target!==Lt||!gpe.includes(He.key))return;He.preventDefault();const Xt=ae().filter(rr=>!rr.disabled).map(rr=>rr.ref.current);QH.includes(He.key)&&Xt.reverse(),Lpe(Xt)}),onBlur:ln(e.onBlur,He=>{He.currentTarget.contains(He.target)||(window.clearTimeout(Pe.current),Ne.current="")}),onPointerMove:ln(e.onPointerMove,k1(He=>{const mt=He.target,Xe=Ce.current!==He.clientX;if(He.currentTarget.contains(mt)&&Xe){const ot=He.clientX>Ce.current?"right":"left";xe.current=ot,Ce.current=He.clientX}}))})})})})})})});aK.displayName=Id;var jpe="MenuGroup",yD=W.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(vi.div,{role:"group",...n,ref:t})});yD.displayName=jpe;var Cpe="MenuLabel",sK=W.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(vi.div,{...n,ref:t})});sK.displayName=Cpe;var LA="MenuItem",f6="menu.itemSelect",EP=W.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,c=W.useRef(null),f=Kw(LA,e.__scopeMenu),i=mD(LA,e.__scopeMenu),x=Ji(t,c),w=W.useRef(!1),A=()=>{const P=c.current;if(!r&&P){const E=new CustomEvent(f6,{bubbles:!0,cancelable:!0});P.addEventListener(f6,D=>n==null?void 0:n(D),{once:!0}),mH(P,E),E.defaultPrevented?w.current=!1:f.onClose()}};return l.jsx(oK,{...a,ref:x,disabled:r,onClick:ln(e.onClick,A),onPointerDown:P=>{var E;(E=e.onPointerDown)==null||E.call(e,P),w.current=!0},onPointerUp:ln(e.onPointerUp,P=>{var E;w.current||(E=P.currentTarget)==null||E.click()}),onKeyDown:ln(e.onKeyDown,P=>{const E=i.searchRef.current!=="";r||E&&P.key===" "||fR.includes(P.key)&&(P.currentTarget.click(),P.preventDefault())})})});EP.displayName=LA;var oK=W.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...c}=e,f=mD(LA,r),i=tK(r),x=W.useRef(null),w=Ji(t,x),[A,P]=W.useState(!1),[E,D]=W.useState("");return W.useEffect(()=>{const V=x.current;V&&D((V.textContent??"").trim())},[c.children]),l.jsx(C1.ItemSlot,{scope:r,disabled:n,textValue:a??E,children:l.jsx(Cfe,{asChild:!0,...i,focusable:!n,children:l.jsx(vi.div,{role:"menuitem","data-highlighted":A?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...c,ref:w,onPointerMove:ln(e.onPointerMove,k1(V=>{n?f.onItemLeave(V):(f.onItemEnter(V),V.defaultPrevented||V.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ln(e.onPointerLeave,k1(V=>f.onItemLeave(V))),onFocus:ln(e.onFocus,()=>P(!0)),onBlur:ln(e.onBlur,()=>P(!1))})})})}),kpe="MenuCheckboxItem",lK=W.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return l.jsx(fK,{scope:e.__scopeMenu,checked:r,children:l.jsx(EP,{role:"menuitemcheckbox","aria-checked":zA(r)?"mixed":r,...a,ref:t,"data-state":xD(r),onSelect:ln(a.onSelect,()=>n==null?void 0:n(zA(r)?!0:!r),{checkForDefaultPrevented:!1})})})});lK.displayName=kpe;var cK="MenuRadioGroup",[Epe,Mpe]=Q0(cK,{value:void 0,onValueChange:()=>{}}),uK=W.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,c=Lu(n);return l.jsx(Epe,{scope:e.__scopeMenu,value:r,onValueChange:c,children:l.jsx(yD,{...a,ref:t})})});uK.displayName=cK;var dK="MenuRadioItem",hK=W.forwardRef((e,t)=>{const{value:r,...n}=e,a=Mpe(dK,e.__scopeMenu),c=r===a.value;return l.jsx(fK,{scope:e.__scopeMenu,checked:c,children:l.jsx(EP,{role:"menuitemradio","aria-checked":c,...n,ref:t,"data-state":xD(c),onSelect:ln(n.onSelect,()=>{var f;return(f=a.onValueChange)==null?void 0:f.call(a,r)},{checkForDefaultPrevented:!1})})})});hK.displayName=dK;var vD="MenuItemIndicator",[fK,Ope]=Q0(vD,{checked:!1}),pK=W.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,c=Ope(vD,r);return l.jsx(Vu,{present:n||zA(c.checked)||c.checked===!0,children:l.jsx(vi.span,{...a,ref:t,"data-state":xD(c.checked)})})});pK.displayName=vD;var Rpe="MenuSeparator",mK=W.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(vi.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});mK.displayName=Rpe;var Ipe="MenuArrow",gK=W.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=kP(r);return l.jsx(PP,{...a,...n,ref:t})});gK.displayName=Ipe;var Dpe="MenuSub",[KUe,yK]=Q0(Dpe),Jb="MenuSubTrigger",vK=W.forwardRef((e,t)=>{const r=ev(Jb,e.__scopeMenu),n=Kw(Jb,e.__scopeMenu),a=yK(Jb,e.__scopeMenu),c=mD(Jb,e.__scopeMenu),f=W.useRef(null),{pointerGraceTimerRef:i,onPointerGraceIntentChange:x}=c,w={__scopeMenu:e.__scopeMenu},A=W.useCallback(()=>{f.current&&window.clearTimeout(f.current),f.current=null},[]);return W.useEffect(()=>A,[A]),W.useEffect(()=>{const P=i.current;return()=>{window.clearTimeout(P),x(null)}},[i,x]),l.jsx(fD,{asChild:!0,...w,children:l.jsx(oK,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":bK(r.open),...e,ref:mP(t,a.onTriggerChange),onClick:P=>{var E;(E=e.onClick)==null||E.call(e,P),!(e.disabled||P.defaultPrevented)&&(P.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ln(e.onPointerMove,k1(P=>{c.onItemEnter(P),!P.defaultPrevented&&!e.disabled&&!r.open&&!f.current&&(c.onPointerGraceIntentChange(null),f.current=window.setTimeout(()=>{r.onOpenChange(!0),A()},100))})),onPointerLeave:ln(e.onPointerLeave,k1(P=>{var D,V;A();const E=(D=r.content)==null?void 0:D.getBoundingClientRect();if(E){const L=(V=r.content)==null?void 0:V.dataset.side,$=L==="right",H=$?-5:5,K=E[$?"left":"right"],Q=E[$?"right":"left"];c.onPointerGraceIntentChange({area:[{x:P.clientX+H,y:P.clientY},{x:K,y:E.top},{x:Q,y:E.top},{x:Q,y:E.bottom},{x:K,y:E.bottom}],side:L}),window.clearTimeout(i.current),i.current=window.setTimeout(()=>c.onPointerGraceIntentChange(null),300)}else{if(c.onTriggerLeave(P),P.defaultPrevented)return;c.onPointerGraceIntentChange(null)}})),onKeyDown:ln(e.onKeyDown,P=>{var D;const E=c.searchRef.current!=="";e.disabled||E&&P.key===" "||ype[n.dir].includes(P.key)&&(r.onOpenChange(!0),(D=r.content)==null||D.focus(),P.preventDefault())})})})});vK.displayName=Jb;var xK="MenuSubContent",_K=W.forwardRef((e,t)=>{const r=nK(Id,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,c=ev(Id,e.__scopeMenu),f=Kw(Id,e.__scopeMenu),i=yK(xK,e.__scopeMenu),x=W.useRef(null),w=Ji(t,x);return l.jsx(C1.Provider,{scope:e.__scopeMenu,children:l.jsx(Vu,{present:n||c.open,children:l.jsx(C1.Slot,{scope:e.__scopeMenu,children:l.jsx(gD,{id:i.contentId,"aria-labelledby":i.triggerId,...a,ref:w,align:"start",side:f.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:A=>{var P;f.isUsingKeyboardRef.current&&((P=x.current)==null||P.focus()),A.preventDefault()},onCloseAutoFocus:A=>A.preventDefault(),onFocusOutside:ln(e.onFocusOutside,A=>{A.target!==i.trigger&&c.onOpenChange(!1)}),onEscapeKeyDown:ln(e.onEscapeKeyDown,A=>{f.onClose(),A.preventDefault()}),onKeyDown:ln(e.onKeyDown,A=>{var D;const P=A.currentTarget.contains(A.target),E=vpe[f.dir].includes(A.key);P&&E&&(c.onOpenChange(!1),(D=i.trigger)==null||D.focus(),A.preventDefault())})})})})})});_K.displayName=xK;function bK(e){return e?"open":"closed"}function zA(e){return e==="indeterminate"}function xD(e){return zA(e)?"indeterminate":e?"checked":"unchecked"}function Lpe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function zpe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function Fpe(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,c=r?e.indexOf(r):-1;let f=zpe(e,Math.max(c,0));a.length===1&&(f=f.filter(w=>w!==r));const x=f.find(w=>w.toLowerCase().startsWith(a.toLowerCase()));return x!==r?x:void 0}function Bpe(e,t){const{x:r,y:n}=e;let a=!1;for(let c=0,f=t.length-1;c<t.length;f=c++){const i=t[c].x,x=t[c].y,w=t[f].x,A=t[f].y;x>n!=A>n&&r<(w-i)*(n-x)/(A-x)+i&&(a=!a)}return a}function Vpe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Bpe(r,t)}function k1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Upe=rK,$pe=fD,qpe=iK,Gpe=aK,Wpe=yD,Hpe=sK,Kpe=EP,Zpe=lK,Ype=uK,Xpe=hK,Jpe=pK,Qpe=mK,eme=gK,tme=vK,rme=_K,_D="DropdownMenu",[nme,ZUe]=Vd(_D,[eK]),Sc=eK(),[ime,wK]=nme(_D),SK=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:c,onOpenChange:f,modal:i=!0}=e,x=Sc(t),w=W.useRef(null),[A=!1,P]=Kg({prop:a,defaultProp:c,onChange:f});return l.jsx(ime,{scope:t,triggerId:Rd(),triggerRef:w,contentId:Rd(),open:A,onOpenChange:P,onOpenToggle:W.useCallback(()=>P(E=>!E),[P]),modal:i,children:l.jsx(Upe,{...x,open:A,onOpenChange:P,dir:n,modal:i,children:r})})};SK.displayName=_D;var AK="DropdownMenuTrigger",bD=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,c=wK(AK,r),f=Sc(r);return l.jsx($pe,{asChild:!0,...f,children:l.jsx(vi.button,{type:"button",id:c.triggerId,"aria-haspopup":"menu","aria-expanded":c.open,"aria-controls":c.open?c.contentId:void 0,"data-state":c.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:mP(t,c.triggerRef),onPointerDown:ln(e.onPointerDown,i=>{!n&&i.button===0&&i.ctrlKey===!1&&(c.onOpenToggle(),c.open||i.preventDefault())}),onKeyDown:ln(e.onKeyDown,i=>{n||(["Enter"," "].includes(i.key)&&c.onOpenToggle(),i.key==="ArrowDown"&&c.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(i.key)&&i.preventDefault())})})})});bD.displayName=AK;var ame="DropdownMenuPortal",TK=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Sc(t);return l.jsx(qpe,{...n,...r})};TK.displayName=ame;var PK="DropdownMenuContent",NK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=wK(PK,r),c=Sc(r),f=W.useRef(!1);return l.jsx(Gpe,{id:a.contentId,"aria-labelledby":a.triggerId,...c,...n,ref:t,onCloseAutoFocus:ln(e.onCloseAutoFocus,i=>{var x;f.current||(x=a.triggerRef.current)==null||x.focus(),f.current=!1,i.preventDefault()}),onInteractOutside:ln(e.onInteractOutside,i=>{const x=i.detail.originalEvent,w=x.button===0&&x.ctrlKey===!0,A=x.button===2||w;(!a.modal||A)&&(f.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});NK.displayName=PK;var sme="DropdownMenuGroup",jK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Wpe,{...a,...n,ref:t})});jK.displayName=sme;var ome="DropdownMenuLabel",CK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Hpe,{...a,...n,ref:t})});CK.displayName=ome;var lme="DropdownMenuItem",kK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Kpe,{...a,...n,ref:t})});kK.displayName=lme;var cme="DropdownMenuCheckboxItem",EK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Zpe,{...a,...n,ref:t})});EK.displayName=cme;var ume="DropdownMenuRadioGroup",dme=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Ype,{...a,...n,ref:t})});dme.displayName=ume;var hme="DropdownMenuRadioItem",MK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Xpe,{...a,...n,ref:t})});MK.displayName=hme;var fme="DropdownMenuItemIndicator",OK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Jpe,{...a,...n,ref:t})});OK.displayName=fme;var pme="DropdownMenuSeparator",RK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(Qpe,{...a,...n,ref:t})});RK.displayName=pme;var mme="DropdownMenuArrow",gme=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(eme,{...a,...n,ref:t})});gme.displayName=mme;var yme="DropdownMenuSubTrigger",IK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(tme,{...a,...n,ref:t})});IK.displayName=yme;var vme="DropdownMenuSubContent",DK=W.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=Sc(r);return l.jsx(rme,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});DK.displayName=vme;var xme=SK,_me=bD,bme=TK,LK=NK,wme=jK,zK=CK,FK=kK,BK=EK,VK=MK,UK=OK,$K=RK,qK=IK,GK=DK;const Wh=xme,tp=_me,Sme=wme,Ame=W.forwardRef(({className:e,inset:t,children:r,...n},a)=>l.jsxs(qK,{ref:a,className:Ut("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t&&"pl-8",e),...n,children:[r,l.jsx(L0,{className:"ml-auto"})]}));Ame.displayName=qK.displayName;const Tme=W.forwardRef(({className:e,...t},r)=>l.jsx(GK,{ref:r,className:Ut("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Tme.displayName=GK.displayName;const zd=W.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(bme,{children:l.jsx(LK,{ref:n,sideOffset:t,className:Ut("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md scrollbar-transparent","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));zd.displayName=LK.displayName;const Ka=W.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(FK,{ref:n,className:Ut("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",t&&"pl-8",e),...r}));Ka.displayName=FK.displayName;const WK=W.forwardRef(({className:e,children:t,checked:r,...n},a)=>l.jsxs(BK,{ref:a,className:Ut("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(UK,{children:l.jsx(J3,{className:"h-4 w-4"})})}),t]}));WK.displayName=BK.displayName;const Pme=W.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(VK,{ref:n,className:Ut("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(UK,{children:l.jsx(Rue,{className:"h-2 w-2 fill-current"})})}),t]}));Pme.displayName=VK.displayName;const S_=W.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(zK,{ref:n,className:Ut("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));S_.displayName=zK.displayName;const _m=W.forwardRef(({className:e,...t},r)=>l.jsx($K,{ref:r,className:Ut("-mx-1 my-1 h-px bg-muted",e),...t}));_m.displayName=$K.displayName;const HK=W.createContext({theme:"system",setTheme:()=>null});function Nme({children:e,defaultTheme:t="system",storageKey:r="vite-ui-theme",...n}){const[a,c]=W.useState(()=>localStorage.getItem(r)||t);W.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),a==="system"){const x=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(x);return}i.classList.add(a)},[a]);const f={theme:a,setTheme:i=>{localStorage.setItem(r,i),c(i)}};return l.jsx(HK.Provider,{...n,value:f,children:e})}const wD=()=>{const e=W.useContext(HK);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};function jme(){const{theme:e,setTheme:t}=wD();return l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"outline",size:"icon",children:[l.jsx(GB,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),l.jsx(qB,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),l.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),l.jsxs(zd,{align:"end",children:[l.jsxs(Ka,{className:e==="light"&&" border-2 border-primary",onClick:()=>t("light"),children:[l.jsx(GB,{className:"mr-2 h-4 w-4"}),"Light"]}),l.jsxs(Ka,{className:e==="dark"&&" border-2 border-primary",onClick:()=>t("dark"),children:[l.jsx(qB,{className:"mr-2 h-4 w-4"}),"Dark"]}),l.jsxs(Ka,{className:e==="system"&&" border-2 border-primary",onClick:()=>t("system"),children:[l.jsx(Lue,{className:"mr-2 h-4 w-4"}),"System"]})]})]})}const kn=W.forwardRef(({className:e,type:t,...r},n)=>l.jsx("input",{type:t,className:Ut("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));kn.displayName="Input";function p6(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function KK(...e){return t=>{let r=!1;const n=e.map(a=>{const c=p6(a,t);return!r&&typeof c=="function"&&(r=!0),c});if(r)return()=>{for(let a=0;a<n.length;a++){const c=n[a];typeof c=="function"?c():p6(e[a],null)}}}}function SD(...e){return W.useCallback(KK(...e),e)}function Cme(e,t=[]){let r=[];function n(c,f){const i=W.createContext(f),x=r.length;r=[...r,f];const w=P=>{var H;const{scope:E,children:D,...V}=P,L=((H=E==null?void 0:E[e])==null?void 0:H[x])||i,$=W.useMemo(()=>V,Object.values(V));return l.jsx(L.Provider,{value:$,children:D})};w.displayName=c+"Provider";function A(P,E){var L;const D=((L=E==null?void 0:E[e])==null?void 0:L[x])||i,V=W.useContext(D);if(V)return V;if(f!==void 0)return f;throw new Error(`\`${P}\` must be used within \`${c}\``)}return[w,A]}const a=()=>{const c=r.map(f=>W.createContext(f));return function(i){const x=(i==null?void 0:i[e])||c;return W.useMemo(()=>({[`__scope${e}`]:{...i,[e]:x}}),[i,x])}};return a.scopeName=e,[n,kme(a,...t)]}function kme(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(c){const f=n.reduce((i,{useScope:x,scopeName:w})=>{const P=x(c)[`__scope${w}`];return{...i,...P}},{});return W.useMemo(()=>({[`__scope${t.scopeName}`]:f}),[f])}};return r.scopeName=t.scopeName,r}function m6(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}var FA=globalThis!=null&&globalThis.document?W.useLayoutEffect:()=>{},Eme=OW[" useInsertionEffect ".trim().toString()]||FA;function Mme({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,c,f]=Ome({defaultProp:t,onChange:r}),i=e!==void 0,x=i?e:a;{const A=W.useRef(e!==void 0);W.useEffect(()=>{const P=A.current;P!==i&&console.warn(`${n} is changing from ${P?"controlled":"uncontrolled"} to ${i?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),A.current=i},[i,n])}const w=W.useCallback(A=>{var P;if(i){const E=Rme(A)?A(e):A;E!==e&&((P=f.current)==null||P.call(f,E))}else c(A)},[i,e,c,f]);return[x,w]}function Ome({defaultProp:e,onChange:t}){const[r,n]=W.useState(e),a=W.useRef(r),c=W.useRef(t);return Eme(()=>{c.current=t},[t]),W.useEffect(()=>{var f;a.current!==r&&((f=c.current)==null||f.call(c,r),a.current=r)},[r,a]),[r,n,c]}function Rme(e){return typeof e=="function"}function Ime(e){const t=W.useRef({value:e,previous:e});return W.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}function Dme(e){const[t,r]=W.useState(void 0);return FA(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const c=a[0];let f,i;if("borderBoxSize"in c){const x=c.borderBoxSize,w=Array.isArray(x)?x[0]:x;f=w.inlineSize,i=w.blockSize}else f=e.offsetWidth,i=e.offsetHeight;r({width:f,height:i})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}function Lme(e,t){return W.useReducer((r,n)=>t[r][n]??r,e)}var ZK=e=>{const{present:t,children:r}=e,n=zme(t),a=typeof r=="function"?r({present:n.isPresent}):W.Children.only(r),c=SD(n.ref,Fme(a));return typeof r=="function"||n.isPresent?W.cloneElement(a,{ref:c}):null};ZK.displayName="Presence";function zme(e){const[t,r]=W.useState(),n=W.useRef(null),a=W.useRef(e),c=W.useRef("none"),f=e?"mounted":"unmounted",[i,x]=Lme(f,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return W.useEffect(()=>{const w=DS(n.current);c.current=i==="mounted"?w:"none"},[i]),FA(()=>{const w=n.current,A=a.current;if(A!==e){const E=c.current,D=DS(w);e?x("MOUNT"):D==="none"||(w==null?void 0:w.display)==="none"?x("UNMOUNT"):x(A&&E!==D?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,x]),FA(()=>{if(t){let w;const A=t.ownerDocument.defaultView??window,P=D=>{const L=DS(n.current).includes(CSS.escape(D.animationName));if(D.target===t&&L&&(x("ANIMATION_END"),!a.current)){const $=t.style.animationFillMode;t.style.animationFillMode="forwards",w=A.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=$)})}},E=D=>{D.target===t&&(c.current=DS(n.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",P),t.addEventListener("animationend",P),()=>{A.clearTimeout(w),t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",P),t.removeEventListener("animationend",P)}}else x("ANIMATION_END")},[t,x]),{isPresent:["mounted","unmountSuspended"].includes(i),ref:W.useCallback(w=>{n.current=w?getComputedStyle(w):null,r(w)},[])}}function DS(e){return(e==null?void 0:e.animationName)||"none"}function Fme(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function Bme(e){const t=Vme(e),r=W.forwardRef((n,a)=>{const{children:c,...f}=n,i=W.Children.toArray(c),x=i.find($me);if(x){const w=x.props.children,A=i.map(P=>P===x?W.Children.count(w)>1?W.Children.only(null):W.isValidElement(w)?w.props.children:null:P);return l.jsx(t,{...f,ref:a,children:W.isValidElement(w)?W.cloneElement(w,void 0,A):null})}return l.jsx(t,{...f,ref:a,children:c})});return r.displayName=`${e}.Slot`,r}function Vme(e){const t=W.forwardRef((r,n)=>{const{children:a,...c}=r;if(W.isValidElement(a)){const f=Gme(a),i=qme(c,a.props);return a.type!==W.Fragment&&(i.ref=n?KK(n,f):f),W.cloneElement(a,i)}return W.Children.count(a)>1?W.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Ume=Symbol("radix.slottable");function $me(e){return W.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ume}function qme(e,t){const r={...t};for(const n in t){const a=e[n],c=t[n];/^on[A-Z]/.test(n)?a&&c?r[n]=(...i)=>{const x=c(...i);return a(...i),x}:a&&(r[n]=a):n==="style"?r[n]={...a,...c}:n==="className"&&(r[n]=[a,c].filter(Boolean).join(" "))}return{...e,...r}}function Gme(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Wme=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],AD=Wme.reduce((e,t)=>{const r=Bme(`Primitive.${t}`),n=W.forwardRef((a,c)=>{const{asChild:f,...i}=a,x=f?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(x,{...i,ref:c})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),MP="Checkbox",[Hme,YUe]=Cme(MP),[Kme,TD]=Hme(MP);function Zme(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:c,form:f,name:i,onCheckedChange:x,required:w,value:A="on",internal_do_not_use_render:P}=e,[E,D]=Mme({prop:r,defaultProp:a??!1,onChange:x,caller:MP}),[V,L]=W.useState(null),[$,H]=W.useState(null),K=W.useRef(!1),Q=V?!!f||!!V.closest("form"):!0,ae={checked:E,disabled:c,setChecked:D,control:V,setControl:L,name:i,form:f,value:A,hasConsumerStoppedPropagationRef:K,required:w,defaultChecked:Gg(a)?!1:a,isFormControl:Q,bubbleInput:$,setBubbleInput:H};return l.jsx(Kme,{scope:t,...ae,children:Yme(P)?P(ae):n})}var YK="CheckboxTrigger",XK=W.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:c,value:f,disabled:i,checked:x,required:w,setControl:A,setChecked:P,hasConsumerStoppedPropagationRef:E,isFormControl:D,bubbleInput:V}=TD(YK,e),L=SD(a,A),$=W.useRef(x);return W.useEffect(()=>{const H=c==null?void 0:c.form;if(H){const K=()=>P($.current);return H.addEventListener("reset",K),()=>H.removeEventListener("reset",K)}},[c,P]),l.jsx(AD.button,{type:"button",role:"checkbox","aria-checked":Gg(x)?"mixed":x,"aria-required":w,"data-state":rZ(x),"data-disabled":i?"":void 0,disabled:i,value:f,...n,ref:L,onKeyDown:m6(t,H=>{H.key==="Enter"&&H.preventDefault()}),onClick:m6(r,H=>{P(K=>Gg(K)?!0:!K),V&&D&&(E.current=H.isPropagationStopped(),E.current||H.stopPropagation())})})});XK.displayName=YK;var PD=W.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:c,required:f,disabled:i,value:x,onCheckedChange:w,form:A,...P}=e;return l.jsx(Zme,{__scopeCheckbox:r,checked:a,defaultChecked:c,disabled:i,required:f,onCheckedChange:w,name:n,form:A,value:x,internal_do_not_use_render:({isFormControl:E})=>l.jsxs(l.Fragment,{children:[l.jsx(XK,{...P,ref:t,__scopeCheckbox:r}),E&&l.jsx(tZ,{__scopeCheckbox:r})]})})});PD.displayName=MP;var JK="CheckboxIndicator",QK=W.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,c=TD(JK,r);return l.jsx(ZK,{present:n||Gg(c.checked)||c.checked===!0,children:l.jsx(AD.span,{"data-state":rZ(c.checked),"data-disabled":c.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});QK.displayName=JK;var eZ="CheckboxBubbleInput",tZ=W.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:c,defaultChecked:f,required:i,disabled:x,name:w,value:A,form:P,bubbleInput:E,setBubbleInput:D}=TD(eZ,e),V=SD(r,D),L=Ime(c),$=Dme(n);W.useEffect(()=>{const K=E;if(!K)return;const Q=window.HTMLInputElement.prototype,ee=Object.getOwnPropertyDescriptor(Q,"checked").set,se=!a.current;if(L!==c&&ee){const ce=new Event("click",{bubbles:se});K.indeterminate=Gg(c),ee.call(K,Gg(c)?!1:c),K.dispatchEvent(ce)}},[E,L,c,a]);const H=W.useRef(Gg(c)?!1:c);return l.jsx(AD.input,{type:"checkbox","aria-hidden":!0,defaultChecked:f??H.current,required:i,disabled:x,name:w,value:A,form:P,...t,tabIndex:-1,ref:V,style:{...t.style,...$,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});tZ.displayName=eZ;function Yme(e){return typeof e=="function"}function Gg(e){return e==="indeterminate"}function rZ(e){return Gg(e)?"indeterminate":e?"checked":"unchecked"}const nZ=W.forwardRef(({className:e,...t},r)=>l.jsx(PD,{ref:r,className:Ut("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:l.jsx(QK,{className:Ut("flex items-center justify-center text-current"),children:l.jsx(J3,{className:"h-4 w-4"})})}));nZ.displayName=PD.displayName;var Zw=e=>e.type==="checkbox",w0=e=>e instanceof Date,mc=e=>e==null;const iZ=e=>typeof e=="object";var oo=e=>!mc(e)&&!Array.isArray(e)&&iZ(e)&&!w0(e),aZ=e=>oo(e)&&e.target?Zw(e.target)?e.target.checked:e.target.value:e,Xme=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,sZ=(e,t)=>e.has(Xme(t)),Jme=e=>{const t=e.constructor&&e.constructor.prototype;return oo(t)&&t.hasOwnProperty("isPrototypeOf")},ND=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function qc(e){let t;const r=Array.isArray(e),n=typeof FileList<"u"?e instanceof FileList:!1;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(ND&&(e instanceof Blob||n))&&(r||oo(e)))if(t=r?[]:{},!r&&!Jme(e))t=e;else for(const a in e)e.hasOwnProperty(a)&&(t[a]=qc(e[a]));else return e;return t}var OP=e=>Array.isArray(e)?e.filter(Boolean):[],io=e=>e===void 0,Hr=(e,t,r)=>{if(!t||!oo(e))return r;const n=OP(t.split(/[,[\].]+?/)).reduce((a,c)=>mc(a)?a:a[c],e);return io(n)||n===e?io(e[t])?r:e[t]:n},kd=e=>typeof e=="boolean",jD=e=>/^\w*$/.test(e),oZ=e=>OP(e.replace(/["|']|\]/g,"").split(/\.|\[/)),ba=(e,t,r)=>{let n=-1;const a=jD(t)?[t]:oZ(t),c=a.length,f=c-1;for(;++n<c;){const i=a[n];let x=r;if(n!==f){const w=e[i];x=oo(w)||Array.isArray(w)?w:isNaN(+a[n+1])?{}:[]}if(i==="__proto__"||i==="constructor"||i==="prototype")return;e[i]=x,e=e[i]}return e};const BA={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Lh={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},tm={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},lZ=Oe.createContext(null),RP=()=>Oe.useContext(lZ),Qme=e=>{const{children:t,...r}=e;return Oe.createElement(lZ.Provider,{value:r},t)};var cZ=(e,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const c in e)Object.defineProperty(a,c,{get:()=>{const f=c;return t._proxyFormState[f]!==Lh.all&&(t._proxyFormState[f]=!n||Lh.all),r&&(r[f]=!0),e[f]}});return a},Gc=e=>oo(e)&&!Object.keys(e).length,uZ=(e,t,r,n)=>{r(e);const{name:a,...c}=e;return Gc(c)||Object.keys(c).length>=Object.keys(t).length||Object.keys(c).find(f=>t[f]===(!n||Lh.all))},l1=e=>Array.isArray(e)?e:[e],dZ=(e,t,r)=>!e||!t||e===t||l1(e).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n)));function CD(e){const t=Oe.useRef(e);t.current=e,Oe.useEffect(()=>{const r=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{r&&r.unsubscribe()}},[e.disabled])}function ege(e){const t=RP(),{control:r=t.control,disabled:n,name:a,exact:c}=e||{},[f,i]=Oe.useState(r._formState),x=Oe.useRef(!0),w=Oe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),A=Oe.useRef(a);return A.current=a,CD({disabled:n,next:P=>x.current&&dZ(A.current,P.name,c)&&uZ(P,w.current,r._updateFormState)&&i({...r._formState,...P}),subject:r._subjects.state}),Oe.useEffect(()=>(x.current=!0,w.current.isValid&&r._updateValid(!0),()=>{x.current=!1}),[r]),Oe.useMemo(()=>cZ(f,r,w.current,!1),[f,r])}var Uf=e=>typeof e=="string",hZ=(e,t,r,n,a)=>Uf(e)?(n&&t.watch.add(e),Hr(r,e,a)):Array.isArray(e)?e.map(c=>(n&&t.watch.add(c),Hr(r,c))):(n&&(t.watchAll=!0),r);function pR(e){const t=RP(),{control:r=t.control,name:n,defaultValue:a,disabled:c,exact:f}=e||{},i=Oe.useRef(n);i.current=n,CD({disabled:c,subject:r._subjects.values,next:A=>{dZ(i.current,A.name,f)&&w(qc(hZ(i.current,r._names,A.values||r._formValues,!1,a)))}});const[x,w]=Oe.useState(r._getWatch(n,a));return Oe.useEffect(()=>r._removeUnmounted()),x}function tge(e){const t=RP(),{name:r,disabled:n,control:a=t.control,shouldUnregister:c}=e,f=sZ(a._names.array,r),i=pR({control:a,name:r,defaultValue:Hr(a._formValues,r,Hr(a._defaultValues,r,e.defaultValue)),exact:!0}),x=ege({control:a,name:r,exact:!0}),w=Oe.useRef(a.register(r,{...e.rules,value:i,...kd(e.disabled)?{disabled:e.disabled}:{}})),A=Oe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Hr(x.errors,r)},isDirty:{enumerable:!0,get:()=>!!Hr(x.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Hr(x.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Hr(x.validatingFields,r)},error:{enumerable:!0,get:()=>Hr(x.errors,r)}}),[x,r]),P=Oe.useMemo(()=>({name:r,value:i,...kd(n)||x.disabled?{disabled:x.disabled||n}:{},onChange:E=>w.current.onChange({target:{value:aZ(E),name:r},type:BA.CHANGE}),onBlur:()=>w.current.onBlur({target:{value:Hr(a._formValues,r),name:r},type:BA.BLUR}),ref:E=>{const D=Hr(a._fields,r);D&&E&&(D._f.ref={focus:()=>E.focus(),select:()=>E.select(),setCustomValidity:V=>E.setCustomValidity(V),reportValidity:()=>E.reportValidity()})}}),[r,a._formValues,n,x.disabled,i,a._fields]);return Oe.useEffect(()=>{const E=a._options.shouldUnregister||c,D=(V,L)=>{const $=Hr(a._fields,V);$&&$._f&&($._f.mount=L)};if(D(r,!0),E){const V=qc(Hr(a._options.defaultValues,r));ba(a._defaultValues,r,V),io(Hr(a._formValues,r))&&ba(a._formValues,r,V)}return!f&&a.register(r),()=>{(f?E&&!a._state.action:E)?a.unregister(r):D(r,!1)}},[r,a,f,c]),Oe.useEffect(()=>{a._updateDisabledField({disabled:n,fields:a._fields,name:r})},[n,r,a]),Oe.useMemo(()=>({field:P,formState:x,fieldState:A}),[P,x,A])}const rge=e=>e.render(tge(e));var fZ=(e,t,r,n,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[n]:a||!0}}:{},g6=e=>({isOnSubmit:!e||e===Lh.onSubmit,isOnBlur:e===Lh.onBlur,isOnChange:e===Lh.onChange,isOnAll:e===Lh.all,isOnTouch:e===Lh.onTouched}),y6=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(n=>e.startsWith(n)&&/^\.\w+/.test(e.slice(n.length))));const c1=(e,t,r,n)=>{for(const a of r||Object.keys(e)){const c=Hr(e,a);if(c){const{_f:f,...i}=c;if(f){if(f.refs&&f.refs[0]&&t(f.refs[0],a)&&!n)return!0;if(f.ref&&t(f.ref,f.name)&&!n)return!0;if(c1(i,t))break}else if(oo(i)&&c1(i,t))break}}};var nge=(e,t,r)=>{const n=l1(Hr(e,r));return ba(n,"root",t[r]),ba(e,r,n),e},kD=e=>e.type==="file",Vf=e=>typeof e=="function",VA=e=>{if(!ND)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},mA=e=>Uf(e),ED=e=>e.type==="radio",UA=e=>e instanceof RegExp;const v6={value:!1,isValid:!1},x6={value:!0,isValid:!0};var pZ=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!io(e[0].attributes.value)?io(e[0].value)||e[0].value===""?x6:{value:e[0].value,isValid:!0}:x6:v6}return v6};const _6={isValid:!1,value:null};var mZ=e=>Array.isArray(e)?e.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,_6):_6;function b6(e,t,r="validate"){if(mA(e)||Array.isArray(e)&&e.every(mA)||kd(e)&&!e)return{type:r,message:mA(e)?e:"",ref:t}}var Qv=e=>oo(e)&&!UA(e)?e:{value:e,message:""},w6=async(e,t,r,n,a,c)=>{const{ref:f,refs:i,required:x,maxLength:w,minLength:A,min:P,max:E,pattern:D,validate:V,name:L,valueAsNumber:$,mount:H}=e._f,K=Hr(r,L);if(!H||t.has(L))return{};const Q=i?i[0]:f,ae=je=>{a&&Q.reportValidity&&(Q.setCustomValidity(kd(je)?"":je||""),Q.reportValidity())},ee={},se=ED(f),ce=Zw(f),he=se||ce,Pe=($||kD(f))&&io(f.value)&&io(K)||VA(f)&&f.value===""||K===""||Array.isArray(K)&&!K.length,Ne=fZ.bind(null,L,n,ee),pe=(je,xe,Ce,ze=tm.maxLength,Te=tm.minLength)=>{const Re=je?xe:Ce;ee[L]={type:je?ze:Te,message:Re,ref:f,...Ne(je?ze:Te,Re)}};if(c?!Array.isArray(K)||!K.length:x&&(!he&&(Pe||mc(K))||kd(K)&&!K||ce&&!pZ(i).isValid||se&&!mZ(i).isValid)){const{value:je,message:xe}=mA(x)?{value:!!x,message:x}:Qv(x);if(je&&(ee[L]={type:tm.required,message:xe,ref:Q,...Ne(tm.required,xe)},!n))return ae(xe),ee}if(!Pe&&(!mc(P)||!mc(E))){let je,xe;const Ce=Qv(E),ze=Qv(P);if(!mc(K)&&!isNaN(K)){const Te=f.valueAsNumber||K&&+K;mc(Ce.value)||(je=Te>Ce.value),mc(ze.value)||(xe=Te<ze.value)}else{const Te=f.valueAsDate||new Date(K),Re=mt=>new Date(new Date().toDateString()+" "+mt),Fe=f.type=="time",He=f.type=="week";Uf(Ce.value)&&K&&(je=Fe?Re(K)>Re(Ce.value):He?K>Ce.value:Te>new Date(Ce.value)),Uf(ze.value)&&K&&(xe=Fe?Re(K)<Re(ze.value):He?K<ze.value:Te<new Date(ze.value))}if((je||xe)&&(pe(!!je,Ce.message,ze.message,tm.max,tm.min),!n))return ae(ee[L].message),ee}if((w||A)&&!Pe&&(Uf(K)||c&&Array.isArray(K))){const je=Qv(w),xe=Qv(A),Ce=!mc(je.value)&&K.length>+je.value,ze=!mc(xe.value)&&K.length<+xe.value;if((Ce||ze)&&(pe(Ce,je.message,xe.message),!n))return ae(ee[L].message),ee}if(D&&!Pe&&Uf(K)){const{value:je,message:xe}=Qv(D);if(UA(je)&&!K.match(je)&&(ee[L]={type:tm.pattern,message:xe,ref:f,...Ne(tm.pattern,xe)},!n))return ae(xe),ee}if(V){if(Vf(V)){const je=await V(K,r),xe=b6(je,Q);if(xe&&(ee[L]={...xe,...Ne(tm.validate,xe.message)},!n))return ae(xe.message),ee}else if(oo(V)){let je={};for(const xe in V){if(!Gc(je)&&!n)break;const Ce=b6(await V[xe](K,r),Q,xe);Ce&&(je={...Ce,...Ne(xe,Ce.message)},ae(Ce.message),n&&(ee[L]=je))}if(!Gc(je)&&(ee[L]={ref:Q,...je},!n))return ee}}return ae(!0),ee};function ige(e,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)e=io(e)?n++:e[t[n++]];return e}function age(e){for(const t in e)if(e.hasOwnProperty(t)&&!io(e[t]))return!1;return!0}function Bo(e,t){const r=Array.isArray(t)?t:jD(t)?[t]:oZ(t),n=r.length===1?e:ige(e,r),a=r.length-1,c=r[a];return n&&delete n[c],a!==0&&(oo(n)&&Gc(n)||Array.isArray(n)&&age(n))&&Bo(e,r.slice(0,-1)),e}var hC=()=>{let e=[];return{get observers(){return e},next:a=>{for(const c of e)c.next&&c.next(a)},subscribe:a=>(e.push(a),{unsubscribe:()=>{e=e.filter(c=>c!==a)}}),unsubscribe:()=>{e=[]}}},mR=e=>mc(e)||!iZ(e);function Lg(e,t){if(mR(e)||mR(t))return e===t;if(w0(e)&&w0(t))return e.getTime()===t.getTime();const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(const a of r){const c=e[a];if(!n.includes(a))return!1;if(a!=="ref"){const f=t[a];if(w0(c)&&w0(f)||oo(c)&&oo(f)||Array.isArray(c)&&Array.isArray(f)?!Lg(c,f):c!==f)return!1}}return!0}var gZ=e=>e.type==="select-multiple",sge=e=>ED(e)||Zw(e),fC=e=>VA(e)&&e.isConnected,yZ=e=>{for(const t in e)if(Vf(e[t]))return!0;return!1};function $A(e,t={}){const r=Array.isArray(e);if(oo(e)||r)for(const n in e)Array.isArray(e[n])||oo(e[n])&&!yZ(e[n])?(t[n]=Array.isArray(e[n])?[]:{},$A(e[n],t[n])):mc(e[n])||(t[n]=!0);return t}function vZ(e,t,r){const n=Array.isArray(e);if(oo(e)||n)for(const a in e)Array.isArray(e[a])||oo(e[a])&&!yZ(e[a])?io(t)||mR(r[a])?r[a]=Array.isArray(e[a])?$A(e[a],[]):{...$A(e[a])}:vZ(e[a],mc(t)?{}:t[a],r[a]):r[a]=!Lg(e[a],t[a]);return r}var Ib=(e,t)=>vZ(e,t,$A(t)),xZ=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>io(e)?e:t?e===""?NaN:e&&+e:r&&Uf(e)?new Date(e):n?n(e):e;function pC(e){const t=e.ref;return kD(t)?t.files:ED(t)?mZ(e.refs).value:gZ(t)?[...t.selectedOptions].map(({value:r})=>r):Zw(t)?pZ(e.refs).value:xZ(io(t.value)?e.ref.value:t.value,e)}var oge=(e,t,r,n)=>{const a={};for(const c of e){const f=Hr(t,c);f&&ba(a,c,f._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:n}},Db=e=>io(e)?e:UA(e)?e.source:oo(e)?UA(e.value)?e.value.source:e.value:e;const S6="AsyncFunction";var lge=e=>!!e&&!!e.validate&&!!(Vf(e.validate)&&e.validate.constructor.name===S6||oo(e.validate)&&Object.values(e.validate).find(t=>t.constructor.name===S6)),cge=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function A6(e,t,r){const n=Hr(e,r);if(n||jD(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const c=a.join("."),f=Hr(t,c),i=Hr(e,c);if(f&&!Array.isArray(f)&&r!==c)return{name:r};if(i&&i.type)return{name:c,error:i};a.pop()}return{name:r}}var uge=(e,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||e):(r?n.isOnBlur:a.isOnBlur)?!e:(r?n.isOnChange:a.isOnChange)?e:!0,dge=(e,t)=>!OP(Hr(e,t)).length&&Bo(e,t);const hge={mode:Lh.onSubmit,reValidateMode:Lh.onChange,shouldFocusError:!0};function fge(e={}){let t={...hge,...e},r={submitCount:0,isDirty:!1,isLoading:Vf(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=oo(t.defaultValues)||oo(t.values)?qc(t.defaultValues||t.values)||{}:{},c=t.shouldUnregister?{}:qc(a),f={action:!1,mount:!1,watch:!1},i={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},x,w=0;const A={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},P={values:hC(),array:hC(),state:hC()},E=g6(t.mode),D=g6(t.reValidateMode),V=t.criteriaMode===Lh.all,L=tt=>xt=>{clearTimeout(w),w=setTimeout(tt,xt)},$=async tt=>{if(!t.disabled&&(A.isValid||tt)){const xt=t.resolver?Gc((await he()).errors):await Ne(n,!0);xt!==r.isValid&&P.state.next({isValid:xt})}},H=(tt,xt)=>{!t.disabled&&(A.isValidating||A.validatingFields)&&((tt||Array.from(i.mount)).forEach(Mt=>{Mt&&(xt?ba(r.validatingFields,Mt,xt):Bo(r.validatingFields,Mt))}),P.state.next({validatingFields:r.validatingFields,isValidating:!Gc(r.validatingFields)}))},K=(tt,xt=[],Mt,lr,cr=!0,xr=!0)=>{if(lr&&Mt&&!t.disabled){if(f.action=!0,xr&&Array.isArray(Hr(n,tt))){const ur=Mt(Hr(n,tt),lr.argA,lr.argB);cr&&ba(n,tt,ur)}if(xr&&Array.isArray(Hr(r.errors,tt))){const ur=Mt(Hr(r.errors,tt),lr.argA,lr.argB);cr&&ba(r.errors,tt,ur),dge(r.errors,tt)}if(A.touchedFields&&xr&&Array.isArray(Hr(r.touchedFields,tt))){const ur=Mt(Hr(r.touchedFields,tt),lr.argA,lr.argB);cr&&ba(r.touchedFields,tt,ur)}A.dirtyFields&&(r.dirtyFields=Ib(a,c)),P.state.next({name:tt,isDirty:je(tt,xt),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ba(c,tt,xt)},Q=(tt,xt)=>{ba(r.errors,tt,xt),P.state.next({errors:r.errors})},ae=tt=>{r.errors=tt,P.state.next({errors:r.errors,isValid:!1})},ee=(tt,xt,Mt,lr)=>{const cr=Hr(n,tt);if(cr){const xr=Hr(c,tt,io(Mt)?Hr(a,tt):Mt);io(xr)||lr&&lr.defaultChecked||xt?ba(c,tt,xt?xr:pC(cr._f)):ze(tt,xr),f.mount&&$()}},se=(tt,xt,Mt,lr,cr)=>{let xr=!1,ur=!1;const tn={name:tt};if(!t.disabled){const Gn=!!(Hr(n,tt)&&Hr(n,tt)._f&&Hr(n,tt)._f.disabled);if(!Mt||lr){A.isDirty&&(ur=r.isDirty,r.isDirty=tn.isDirty=je(),xr=ur!==tn.isDirty);const gi=Gn||Lg(Hr(a,tt),xt);ur=!!(!Gn&&Hr(r.dirtyFields,tt)),gi||Gn?Bo(r.dirtyFields,tt):ba(r.dirtyFields,tt,!0),tn.dirtyFields=r.dirtyFields,xr=xr||A.dirtyFields&&ur!==!gi}if(Mt){const gi=Hr(r.touchedFields,tt);gi||(ba(r.touchedFields,tt,Mt),tn.touchedFields=r.touchedFields,xr=xr||A.touchedFields&&gi!==Mt)}xr&&cr&&P.state.next(tn)}return xr?tn:{}},ce=(tt,xt,Mt,lr)=>{const cr=Hr(r.errors,tt),xr=A.isValid&&kd(xt)&&r.isValid!==xt;if(t.delayError&&Mt?(x=L(()=>Q(tt,Mt)),x(t.delayError)):(clearTimeout(w),x=null,Mt?ba(r.errors,tt,Mt):Bo(r.errors,tt)),(Mt?!Lg(cr,Mt):cr)||!Gc(lr)||xr){const ur={...lr,...xr&&kd(xt)?{isValid:xt}:{},errors:r.errors,name:tt};r={...r,...ur},P.state.next(ur)}},he=async tt=>{H(tt,!0);const xt=await t.resolver(c,t.context,oge(tt||i.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return H(tt),xt},Pe=async tt=>{const{errors:xt}=await he(tt);if(tt)for(const Mt of tt){const lr=Hr(xt,Mt);lr?ba(r.errors,Mt,lr):Bo(r.errors,Mt)}else r.errors=xt;return xt},Ne=async(tt,xt,Mt={valid:!0})=>{for(const lr in tt){const cr=tt[lr];if(cr){const{_f:xr,...ur}=cr;if(xr){const tn=i.array.has(xr.name),Gn=cr._f&&lge(cr._f);Gn&&A.validatingFields&&H([lr],!0);const gi=await w6(cr,i.disabled,c,V,t.shouldUseNativeValidation&&!xt,tn);if(Gn&&A.validatingFields&&H([lr]),gi[xr.name]&&(Mt.valid=!1,xt))break;!xt&&(Hr(gi,xr.name)?tn?nge(r.errors,gi,xr.name):ba(r.errors,xr.name,gi[xr.name]):Bo(r.errors,xr.name))}!Gc(ur)&&await Ne(ur,xt,Mt)}}return Mt.valid},pe=()=>{for(const tt of i.unMount){const xt=Hr(n,tt);xt&&(xt._f.refs?xt._f.refs.every(Mt=>!fC(Mt)):!fC(xt._f.ref))&&Xt(tt)}i.unMount=new Set},je=(tt,xt)=>!t.disabled&&(tt&&xt&&ba(c,tt,xt),!Lg(Xe(),a)),xe=(tt,xt,Mt)=>hZ(tt,i,{...f.mount?c:io(xt)?a:Uf(tt)?{[tt]:xt}:xt},Mt,xt),Ce=tt=>OP(Hr(f.mount?c:a,tt,t.shouldUnregister?Hr(a,tt,[]):[])),ze=(tt,xt,Mt={})=>{const lr=Hr(n,tt);let cr=xt;if(lr){const xr=lr._f;xr&&(!xr.disabled&&ba(c,tt,xZ(xt,xr)),cr=VA(xr.ref)&&mc(xt)?"":xt,gZ(xr.ref)?[...xr.ref.options].forEach(ur=>ur.selected=cr.includes(ur.value)):xr.refs?Zw(xr.ref)?xr.refs.length>1?xr.refs.forEach(ur=>(!ur.defaultChecked||!ur.disabled)&&(ur.checked=Array.isArray(cr)?!!cr.find(tn=>tn===ur.value):cr===ur.value)):xr.refs[0]&&(xr.refs[0].checked=!!cr):xr.refs.forEach(ur=>ur.checked=ur.value===cr):kD(xr.ref)?xr.ref.value="":(xr.ref.value=cr,xr.ref.type||P.values.next({name:tt,values:{...c}})))}(Mt.shouldDirty||Mt.shouldTouch)&&se(tt,cr,Mt.shouldTouch,Mt.shouldDirty,!0),Mt.shouldValidate&&mt(tt)},Te=(tt,xt,Mt)=>{for(const lr in xt){const cr=xt[lr],xr=`${tt}.${lr}`,ur=Hr(n,xr);(i.array.has(tt)||oo(cr)||ur&&!ur._f)&&!w0(cr)?Te(xr,cr,Mt):ze(xr,cr,Mt)}},Re=(tt,xt,Mt={})=>{const lr=Hr(n,tt),cr=i.array.has(tt),xr=qc(xt);ba(c,tt,xr),cr?(P.array.next({name:tt,values:{...c}}),(A.isDirty||A.dirtyFields)&&Mt.shouldDirty&&P.state.next({name:tt,dirtyFields:Ib(a,c),isDirty:je(tt,xr)})):lr&&!lr._f&&!mc(xr)?Te(tt,xr,Mt):ze(tt,xr,Mt),y6(tt,i)&&P.state.next({...r}),P.values.next({name:f.mount?tt:void 0,values:{...c}})},Fe=async tt=>{f.mount=!0;const xt=tt.target;let Mt=xt.name,lr=!0;const cr=Hr(n,Mt),xr=()=>xt.type?pC(cr._f):aZ(tt),ur=tn=>{lr=Number.isNaN(tn)||w0(tn)&&isNaN(tn.getTime())||Lg(tn,Hr(c,Mt,tn))};if(cr){let tn,Gn;const gi=xr(),Ui=tt.type===BA.BLUR||tt.type===BA.FOCUS_OUT,uo=!cge(cr._f)&&!t.resolver&&!Hr(r.errors,Mt)&&!cr._f.deps||uge(Ui,Hr(r.touchedFields,Mt),r.isSubmitted,D,E),Va=y6(Mt,i,Ui);ba(c,Mt,gi),Ui?(cr._f.onBlur&&cr._f.onBlur(tt),x&&x(0)):cr._f.onChange&&cr._f.onChange(tt);const Ks=se(Mt,gi,Ui,!1),To=!Gc(Ks)||Va;if(!Ui&&P.values.next({name:Mt,type:tt.type,values:{...c}}),uo)return A.isValid&&(t.mode==="onBlur"&&Ui?$():Ui||$()),To&&P.state.next({name:Mt,...Va?{}:Ks});if(!Ui&&Va&&P.state.next({...r}),t.resolver){const{errors:es}=await he([Mt]);if(ur(gi),lr){const rc=A6(r.errors,n,Mt),kl=A6(es,n,rc.name||Mt);tn=kl.error,Mt=kl.name,Gn=Gc(es)}}else H([Mt],!0),tn=(await w6(cr,i.disabled,c,V,t.shouldUseNativeValidation))[Mt],H([Mt]),ur(gi),lr&&(tn?Gn=!1:A.isValid&&(Gn=await Ne(n,!0)));lr&&(cr._f.deps&&mt(cr._f.deps),ce(Mt,Gn,tn,Ks))}},He=(tt,xt)=>{if(Hr(r.errors,xt)&&tt.focus)return tt.focus(),1},mt=async(tt,xt={})=>{let Mt,lr;const cr=l1(tt);if(t.resolver){const xr=await Pe(io(tt)?tt:cr);Mt=Gc(xr),lr=tt?!cr.some(ur=>Hr(xr,ur)):Mt}else tt?(lr=(await Promise.all(cr.map(async xr=>{const ur=Hr(n,xr);return await Ne(ur&&ur._f?{[xr]:ur}:ur)}))).every(Boolean),!(!lr&&!r.isValid)&&$()):lr=Mt=await Ne(n);return P.state.next({...!Uf(tt)||A.isValid&&Mt!==r.isValid?{}:{name:tt},...t.resolver||!tt?{isValid:Mt}:{},errors:r.errors}),xt.shouldFocus&&!lr&&c1(n,He,tt?cr:i.mount),lr},Xe=tt=>{const xt={...f.mount?c:a};return io(tt)?xt:Uf(tt)?Hr(xt,tt):tt.map(Mt=>Hr(xt,Mt))},ot=(tt,xt)=>({invalid:!!Hr((xt||r).errors,tt),isDirty:!!Hr((xt||r).dirtyFields,tt),error:Hr((xt||r).errors,tt),isValidating:!!Hr(r.validatingFields,tt),isTouched:!!Hr((xt||r).touchedFields,tt)}),qe=tt=>{tt&&l1(tt).forEach(xt=>Bo(r.errors,xt)),P.state.next({errors:tt?r.errors:{}})},Lt=(tt,xt,Mt)=>{const lr=(Hr(n,tt,{_f:{}})._f||{}).ref,cr=Hr(r.errors,tt)||{},{ref:xr,message:ur,type:tn,...Gn}=cr;ba(r.errors,tt,{...Gn,...xt,ref:lr}),P.state.next({name:tt,errors:r.errors,isValid:!1}),Mt&&Mt.shouldFocus&&lr&&lr.focus&&lr.focus()},Zt=(tt,xt)=>Vf(tt)?P.values.subscribe({next:Mt=>tt(xe(void 0,xt),Mt)}):xe(tt,xt,!0),Xt=(tt,xt={})=>{for(const Mt of tt?l1(tt):i.mount)i.mount.delete(Mt),i.array.delete(Mt),xt.keepValue||(Bo(n,Mt),Bo(c,Mt)),!xt.keepError&&Bo(r.errors,Mt),!xt.keepDirty&&Bo(r.dirtyFields,Mt),!xt.keepTouched&&Bo(r.touchedFields,Mt),!xt.keepIsValidating&&Bo(r.validatingFields,Mt),!t.shouldUnregister&&!xt.keepDefaultValue&&Bo(a,Mt);P.values.next({values:{...c}}),P.state.next({...r,...xt.keepDirty?{isDirty:je()}:{}}),!xt.keepIsValid&&$()},rr=({disabled:tt,name:xt,field:Mt,fields:lr})=>{(kd(tt)&&f.mount||tt||i.disabled.has(xt))&&(tt?i.disabled.add(xt):i.disabled.delete(xt),se(xt,pC(Mt?Mt._f:Hr(lr,xt)._f),!1,!1,!0))},ir=(tt,xt={})=>{let Mt=Hr(n,tt);const lr=kd(xt.disabled)||kd(t.disabled);return ba(n,tt,{...Mt||{},_f:{...Mt&&Mt._f?Mt._f:{ref:{name:tt}},name:tt,mount:!0,...xt}}),i.mount.add(tt),Mt?rr({field:Mt,disabled:kd(xt.disabled)?xt.disabled:t.disabled,name:tt}):ee(tt,!0,xt.value),{...lr?{disabled:xt.disabled||t.disabled}:{},...t.progressive?{required:!!xt.required,min:Db(xt.min),max:Db(xt.max),minLength:Db(xt.minLength),maxLength:Db(xt.maxLength),pattern:Db(xt.pattern)}:{},name:tt,onChange:Fe,onBlur:Fe,ref:cr=>{if(cr){ir(tt,xt),Mt=Hr(n,tt);const xr=io(cr.value)&&cr.querySelectorAll&&cr.querySelectorAll("input,select,textarea")[0]||cr,ur=sge(xr),tn=Mt._f.refs||[];if(ur?tn.find(Gn=>Gn===xr):xr===Mt._f.ref)return;ba(n,tt,{_f:{...Mt._f,...ur?{refs:[...tn.filter(fC),xr,...Array.isArray(Hr(a,tt))?[{}]:[]],ref:{type:xr.type,name:tt}}:{ref:xr}}}),ee(tt,!1,void 0,xr)}else Mt=Hr(n,tt,{}),Mt._f&&(Mt._f.mount=!1),(t.shouldUnregister||xt.shouldUnregister)&&!(sZ(i.array,tt)&&f.action)&&i.unMount.add(tt)}}},Bt=()=>t.shouldFocusError&&c1(n,He,i.mount),De=tt=>{kd(tt)&&(P.state.next({disabled:tt}),c1(n,(xt,Mt)=>{const lr=Hr(n,Mt);lr&&(xt.disabled=lr._f.disabled||tt,Array.isArray(lr._f.refs)&&lr._f.refs.forEach(cr=>{cr.disabled=lr._f.disabled||tt}))},0,!1))},jr=(tt,xt)=>async Mt=>{let lr;Mt&&(Mt.preventDefault&&Mt.preventDefault(),Mt.persist&&Mt.persist());let cr=qc(c);if(i.disabled.size)for(const xr of i.disabled)ba(cr,xr,void 0);if(P.state.next({isSubmitting:!0}),t.resolver){const{errors:xr,values:ur}=await he();r.errors=xr,cr=ur}else await Ne(n);if(Bo(r.errors,"root"),Gc(r.errors)){P.state.next({errors:{}});try{await tt(cr,Mt)}catch(xr){lr=xr}}else xt&&await xt({...r.errors},Mt),Bt(),setTimeout(Bt);if(P.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Gc(r.errors)&&!lr,submitCount:r.submitCount+1,errors:r.errors}),lr)throw lr},Dt=(tt,xt={})=>{Hr(n,tt)&&(io(xt.defaultValue)?Re(tt,qc(Hr(a,tt))):(Re(tt,xt.defaultValue),ba(a,tt,qc(xt.defaultValue))),xt.keepTouched||Bo(r.touchedFields,tt),xt.keepDirty||(Bo(r.dirtyFields,tt),r.isDirty=xt.defaultValue?je(tt,qc(Hr(a,tt))):je()),xt.keepError||(Bo(r.errors,tt),A.isValid&&$()),P.state.next({...r}))},Cr=(tt,xt={})=>{const Mt=tt?qc(tt):a,lr=qc(Mt),cr=Gc(tt),xr=cr?a:lr;if(xt.keepDefaultValues||(a=Mt),!xt.keepValues){if(xt.keepDirtyValues){const ur=new Set([...i.mount,...Object.keys(Ib(a,c))]);for(const tn of Array.from(ur))Hr(r.dirtyFields,tn)?ba(xr,tn,Hr(c,tn)):Re(tn,Hr(xr,tn))}else{if(ND&&io(tt))for(const ur of i.mount){const tn=Hr(n,ur);if(tn&&tn._f){const Gn=Array.isArray(tn._f.refs)?tn._f.refs[0]:tn._f.ref;if(VA(Gn)){const gi=Gn.closest("form");if(gi){gi.reset();break}}}}n={}}c=t.shouldUnregister?xt.keepDefaultValues?qc(a):{}:qc(xr),P.array.next({values:{...xr}}),P.values.next({values:{...xr}})}i={mount:xt.keepDirtyValues?i.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},f.mount=!A.isValid||!!xt.keepIsValid||!!xt.keepDirtyValues,f.watch=!!t.shouldUnregister,P.state.next({submitCount:xt.keepSubmitCount?r.submitCount:0,isDirty:cr?!1:xt.keepDirty?r.isDirty:!!(xt.keepDefaultValues&&!Lg(tt,a)),isSubmitted:xt.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:cr?{}:xt.keepDirtyValues?xt.keepDefaultValues&&c?Ib(a,c):r.dirtyFields:xt.keepDefaultValues&&tt?Ib(a,tt):xt.keepDirty?r.dirtyFields:{},touchedFields:xt.keepTouched?r.touchedFields:{},errors:xt.keepErrors?r.errors:{},isSubmitSuccessful:xt.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},At=(tt,xt)=>Cr(Vf(tt)?tt(c):tt,xt);return{control:{register:ir,unregister:Xt,getFieldState:ot,handleSubmit:jr,setError:Lt,_executeSchema:he,_getWatch:xe,_getDirty:je,_updateValid:$,_removeUnmounted:pe,_updateFieldArray:K,_updateDisabledField:rr,_getFieldArray:Ce,_reset:Cr,_resetDefaultValues:()=>Vf(t.defaultValues)&&t.defaultValues().then(tt=>{At(tt,t.resetOptions),P.state.next({isLoading:!1})}),_updateFormState:tt=>{r={...r,...tt}},_disableForm:De,_subjects:P,_proxyFormState:A,_setErrors:ae,get _fields(){return n},get _formValues(){return c},get _state(){return f},set _state(tt){f=tt},get _defaultValues(){return a},get _names(){return i},set _names(tt){i=tt},get _formState(){return r},set _formState(tt){r=tt},get _options(){return t},set _options(tt){t={...t,...tt}}},trigger:mt,register:ir,handleSubmit:jr,watch:Zt,setValue:Re,getValues:Xe,reset:At,resetField:Dt,clearErrors:qe,unregister:Xt,setError:Lt,setFocus:(tt,xt={})=>{const Mt=Hr(n,tt),lr=Mt&&Mt._f;if(lr){const cr=lr.refs?lr.refs[0]:lr.ref;cr.focus&&(cr.focus(),xt.shouldSelect&&Vf(cr.select)&&cr.select())}},getFieldState:ot}}function Cl(e={}){const t=Oe.useRef(void 0),r=Oe.useRef(void 0),[n,a]=Oe.useState({isDirty:!1,isValidating:!1,isLoading:Vf(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Vf(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...fge(e),formState:n});const c=t.current.control;return c._options=e,CD({subject:c._subjects.state,next:f=>{uZ(f,c._proxyFormState,c._updateFormState,!0)&&a({...c._formState})}}),Oe.useEffect(()=>c._disableForm(e.disabled),[c,e.disabled]),Oe.useEffect(()=>{if(c._proxyFormState.isDirty){const f=c._getDirty();f!==n.isDirty&&c._subjects.state.next({isDirty:f})}},[c,n.isDirty]),Oe.useEffect(()=>{e.values&&!Lg(e.values,r.current)?(c._reset(e.values,c._options.resetOptions),r.current=e.values,a(f=>({...f}))):c._resetDefaultValues()},[e.values,c]),Oe.useEffect(()=>{e.errors&&c._setErrors(e.errors)},[e.errors,c]),Oe.useEffect(()=>{c._state.mount||(c._updateValid(),c._state.mount=!0),c._state.watch&&(c._state.watch=!1,c._subjects.state.next({...c._formState})),c._removeUnmounted()}),Oe.useEffect(()=>{e.shouldUnregister&&c._subjects.values.next({values:c._getWatch()})},[e.shouldUnregister,c]),t.current.formState=cZ(n,c),t.current}var Xi;(function(e){e.assertEqual=a=>a;function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const c={};for(const f of a)c[f]=f;return c},e.getValidEnumValues=a=>{const c=e.objectKeys(a).filter(i=>typeof a[a[i]]!="number"),f={};for(const i of c)f[i]=a[i];return e.objectValues(f)},e.objectValues=a=>e.objectKeys(a).map(function(c){return a[c]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const c=[];for(const f in a)Object.prototype.hasOwnProperty.call(a,f)&&c.push(f);return c},e.find=(a,c)=>{for(const f of a)if(c(f))return f},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function n(a,c=" | "){return a.map(f=>typeof f=="string"?`'${f}'`:f).join(c)}e.joinValues=n,e.jsonStringifyReplacer=(a,c)=>typeof c=="bigint"?c.toString():c})(Xi||(Xi={}));var gR;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(gR||(gR={}));const on=Xi.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),lm=e=>{switch(typeof e){case"undefined":return on.undefined;case"string":return on.string;case"number":return isNaN(e)?on.nan:on.number;case"boolean":return on.boolean;case"function":return on.function;case"bigint":return on.bigint;case"symbol":return on.symbol;case"object":return Array.isArray(e)?on.array:e===null?on.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?on.promise:typeof Map<"u"&&e instanceof Map?on.map:typeof Set<"u"&&e instanceof Set?on.set:typeof Date<"u"&&e instanceof Date?on.date:on.object;default:return on.unknown}},Rr=Xi.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),pge=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Mu extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(c){return c.message},n={_errors:[]},a=c=>{for(const f of c.issues)if(f.code==="invalid_union")f.unionErrors.map(a);else if(f.code==="invalid_return_type")a(f.returnTypeError);else if(f.code==="invalid_arguments")a(f.argumentsError);else if(f.path.length===0)n._errors.push(r(f));else{let i=n,x=0;for(;x<f.path.length;){const w=f.path[x];x===f.path.length-1?(i[w]=i[w]||{_errors:[]},i[w]._errors.push(r(f))):i[w]=i[w]||{_errors:[]},i=i[w],x++}}};return a(this),n}static assert(t){if(!(t instanceof Mu))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Xi.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Mu.create=e=>new Mu(e);const jx=(e,t)=>{let r;switch(e.code){case Rr.invalid_type:e.received===on.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Rr.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Xi.jsonStringifyReplacer)}`;break;case Rr.unrecognized_keys:r=`Unrecognized key(s) in object: ${Xi.joinValues(e.keys,", ")}`;break;case Rr.invalid_union:r="Invalid input";break;case Rr.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Xi.joinValues(e.options)}`;break;case Rr.invalid_enum_value:r=`Invalid enum value. Expected ${Xi.joinValues(e.options)}, received '${e.received}'`;break;case Rr.invalid_arguments:r="Invalid function arguments";break;case Rr.invalid_return_type:r="Invalid function return type";break;case Rr.invalid_date:r="Invalid date";break;case Rr.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Xi.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Rr.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Rr.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Rr.custom:r="Invalid input";break;case Rr.invalid_intersection_types:r="Intersection results could not be merged";break;case Rr.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Rr.not_finite:r="Number must be finite";break;default:r=t.defaultError,Xi.assertNever(e)}return{message:r}};let _Z=jx;function mge(e){_Z=e}function qA(){return _Z}const GA=e=>{const{data:t,path:r,errorMaps:n,issueData:a}=e,c=[...r,...a.path||[]],f={...a,path:c};if(a.message!==void 0)return{...a,path:c,message:a.message};let i="";const x=n.filter(w=>!!w).slice().reverse();for(const w of x)i=w(f,{data:t,defaultError:i}).message;return{...a,path:c,message:i}},gge=[];function Jr(e,t){const r=qA(),n=GA({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===jx?void 0:jx].filter(a=>!!a)});e.common.issues.push(n)}class ec{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return di;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const c=await a.key,f=await a.value;n.push({key:c,value:f})}return ec.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:c,value:f}=a;if(c.status==="aborted"||f.status==="aborted")return di;c.status==="dirty"&&t.dirty(),f.status==="dirty"&&t.dirty(),c.value!=="__proto__"&&(typeof f.value<"u"||a.alwaysSet)&&(n[c.value]=f.value)}return{status:t.value,value:n}}}const di=Object.freeze({status:"aborted"}),ox=e=>({status:"dirty",value:e}),bc=e=>({status:"valid",value:e}),yR=e=>e.status==="aborted",vR=e=>e.status==="dirty",F0=e=>e.status==="valid",E1=e=>typeof Promise<"u"&&e instanceof Promise;function WA(e,t,r,n){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function bZ(e,t,r,n,a){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,r),r}var Pn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Pn||(Pn={}));var Qb,e1;class rp{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const T6=(e,t)=>{if(F0(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Mu(e.common.issues);return this._error=r,this._error}}};function Ti(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=e;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(f,i)=>{var x,w;const{message:A}=e;return f.code==="invalid_enum_value"?{message:A??i.defaultError}:typeof i.data>"u"?{message:(x=A??n)!==null&&x!==void 0?x:i.defaultError}:f.code!=="invalid_type"?{message:i.defaultError}:{message:(w=A??r)!==null&&w!==void 0?w:i.defaultError}},description:a}}class ki{get description(){return this._def.description}_getType(t){return lm(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:lm(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new ec,ctx:{common:t.parent.common,data:t.data,parsedType:lm(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(E1(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){var n;const a={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:lm(t)},c=this._parseSync({data:t,path:a.path,parent:a});return T6(a,c)}"~validate"(t){var r,n;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:lm(t)};if(!this["~standard"].async)try{const c=this._parseSync({data:t,path:[],parent:a});return F0(c)?{value:c.value}:{issues:a.common.issues}}catch(c){!((n=(r=c==null?void 0:c.message)===null||r===void 0?void 0:r.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:a}).then(c=>F0(c)?{value:c.value}:{issues:a.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:lm(t)},a=this._parse({data:t,path:n.path,parent:n}),c=await(E1(a)?a:Promise.resolve(a));return T6(n,c)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,c)=>{const f=t(a),i=()=>c.addIssue({code:Rr.custom,...n(a)});return typeof Promise<"u"&&f instanceof Promise?f.then(x=>x?!0:(i(),!1)):f?!0:(i(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Hh({schema:this,typeName:ci.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Hf.create(this,this._def)}nullable(){return ty.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Bh.create(this)}promise(){return kx.create(this,this._def)}or(t){return I1.create([this,t],this._def)}and(t){return D1.create(this,t,this._def)}transform(t){return new Hh({...Ti(this._def),schema:this,typeName:ci.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new V1({...Ti(this._def),innerType:this,defaultValue:r,typeName:ci.ZodDefault})}brand(){return new MD({typeName:ci.ZodBranded,type:this,...Ti(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new U1({...Ti(this._def),innerType:this,catchValue:r,typeName:ci.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Yw.create(this,t)}readonly(){return $1.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const yge=/^c[^\s-]{8,}$/i,vge=/^[0-9a-z]+$/,xge=/^[0-9A-HJKMNP-TV-Z]{26}$/i,_ge=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,bge=/^[a-z0-9_-]{21}$/i,wge=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Sge=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Age=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Tge="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let mC;const Pge=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Nge=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,jge=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Cge=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,kge=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ege=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,wZ="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Mge=new RegExp(`^${wZ}$`);function SZ(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`),t}function Oge(e){return new RegExp(`^${SZ(e)}$`)}function AZ(e){let t=`${wZ}T${SZ(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Rge(e,t){return!!((t==="v4"||!t)&&Pge.test(e)||(t==="v6"||!t)&&jge.test(e))}function Ige(e,t){if(!wge.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||!a.typ||!a.alg||t&&a.alg!==t)}catch{return!1}}function Dge(e,t){return!!((t==="v4"||!t)&&Nge.test(e)||(t==="v6"||!t)&&Cge.test(e))}class Fh extends ki{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==on.string){const c=this._getOrReturnCtx(t);return Jr(c,{code:Rr.invalid_type,expected:on.string,received:c.parsedType}),di}const n=new ec;let a;for(const c of this._def.checks)if(c.kind==="min")t.data.length<c.value&&(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),n.dirty());else if(c.kind==="max")t.data.length>c.value&&(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!1,message:c.message}),n.dirty());else if(c.kind==="length"){const f=t.data.length>c.value,i=t.data.length<c.value;(f||i)&&(a=this._getOrReturnCtx(t,a),f?Jr(a,{code:Rr.too_big,maximum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}):i&&Jr(a,{code:Rr.too_small,minimum:c.value,type:"string",inclusive:!0,exact:!0,message:c.message}),n.dirty())}else if(c.kind==="email")Age.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"email",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="emoji")mC||(mC=new RegExp(Tge,"u")),mC.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"emoji",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="uuid")_ge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"uuid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="nanoid")bge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"nanoid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="cuid")yge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"cuid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="cuid2")vge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"cuid2",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="ulid")xge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"ulid",code:Rr.invalid_string,message:c.message}),n.dirty());else if(c.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),Jr(a,{validation:"url",code:Rr.invalid_string,message:c.message}),n.dirty()}else c.kind==="regex"?(c.regex.lastIndex=0,c.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"regex",code:Rr.invalid_string,message:c.message}),n.dirty())):c.kind==="trim"?t.data=t.data.trim():c.kind==="includes"?t.data.includes(c.value,c.position)||(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.invalid_string,validation:{includes:c.value,position:c.position},message:c.message}),n.dirty()):c.kind==="toLowerCase"?t.data=t.data.toLowerCase():c.kind==="toUpperCase"?t.data=t.data.toUpperCase():c.kind==="startsWith"?t.data.startsWith(c.value)||(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.invalid_string,validation:{startsWith:c.value},message:c.message}),n.dirty()):c.kind==="endsWith"?t.data.endsWith(c.value)||(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.invalid_string,validation:{endsWith:c.value},message:c.message}),n.dirty()):c.kind==="datetime"?AZ(c).test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.invalid_string,validation:"datetime",message:c.message}),n.dirty()):c.kind==="date"?Mge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.invalid_string,validation:"date",message:c.message}),n.dirty()):c.kind==="time"?Oge(c).test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.invalid_string,validation:"time",message:c.message}),n.dirty()):c.kind==="duration"?Sge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"duration",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="ip"?Rge(t.data,c.version)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"ip",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="jwt"?Ige(t.data,c.alg)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"jwt",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="cidr"?Dge(t.data,c.version)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"cidr",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="base64"?kge.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"base64",code:Rr.invalid_string,message:c.message}),n.dirty()):c.kind==="base64url"?Ege.test(t.data)||(a=this._getOrReturnCtx(t,a),Jr(a,{validation:"base64url",code:Rr.invalid_string,message:c.message}),n.dirty()):Xi.assertNever(c);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:Rr.invalid_string,...Pn.errToObj(n)})}_addCheck(t){return new Fh({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Pn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Pn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Pn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Pn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Pn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Pn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Pn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Pn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Pn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Pn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Pn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Pn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Pn.errToObj(t)})}datetime(t){var r,n;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(r=t==null?void 0:t.offset)!==null&&r!==void 0?r:!1,local:(n=t==null?void 0:t.local)!==null&&n!==void 0?n:!1,...Pn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Pn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Pn.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...Pn.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...Pn.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...Pn.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...Pn.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...Pn.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...Pn.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...Pn.errToObj(r)})}nonempty(t){return this.min(1,Pn.errToObj(t))}trim(){return new Fh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Fh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Fh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Fh.create=e=>{var t;return new Fh({checks:[],typeName:ci.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Ti(e)})};function Lge(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,c=parseInt(e.toFixed(a).replace(".","")),f=parseInt(t.toFixed(a).replace(".",""));return c%f/Math.pow(10,a)}class Jg extends ki{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==on.number){const c=this._getOrReturnCtx(t);return Jr(c,{code:Rr.invalid_type,expected:on.number,received:c.parsedType}),di}let n;const a=new ec;for(const c of this._def.checks)c.kind==="int"?Xi.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.invalid_type,expected:"integer",received:"float",message:c.message}),a.dirty()):c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.too_small,minimum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.too_big,maximum:c.value,type:"number",inclusive:c.inclusive,exact:!1,message:c.message}),a.dirty()):c.kind==="multipleOf"?Lge(t.data,c.value)!==0&&(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):c.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.not_finite,message:c.message}),a.dirty()):Xi.assertNever(c);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,Pn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Pn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Pn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Pn.toString(r))}setLimit(t,r,n,a){return new Jg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Pn.toString(a)}]})}_addCheck(t){return new Jg({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Pn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Pn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Pn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Pn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Pn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Pn.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:Pn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Pn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Pn.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Xi.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Jg.create=e=>new Jg({checks:[],typeName:ci.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Ti(e)});class Qg extends ki{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==on.bigint)return this._getInvalidInput(t);let n;const a=new ec;for(const c of this._def.checks)c.kind==="min"?(c.inclusive?t.data<c.value:t.data<=c.value)&&(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.too_small,type:"bigint",minimum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="max"?(c.inclusive?t.data>c.value:t.data>=c.value)&&(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.too_big,type:"bigint",maximum:c.value,inclusive:c.inclusive,message:c.message}),a.dirty()):c.kind==="multipleOf"?t.data%c.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),Jr(n,{code:Rr.not_multiple_of,multipleOf:c.value,message:c.message}),a.dirty()):Xi.assertNever(c);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return Jr(r,{code:Rr.invalid_type,expected:on.bigint,received:r.parsedType}),di}gte(t,r){return this.setLimit("min",t,!0,Pn.toString(r))}gt(t,r){return this.setLimit("min",t,!1,Pn.toString(r))}lte(t,r){return this.setLimit("max",t,!0,Pn.toString(r))}lt(t,r){return this.setLimit("max",t,!1,Pn.toString(r))}setLimit(t,r,n,a){return new Qg({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:Pn.toString(a)}]})}_addCheck(t){return new Qg({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Pn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Pn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Pn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Pn.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:Pn.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Qg.create=e=>{var t;return new Qg({checks:[],typeName:ci.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...Ti(e)})};class M1 extends ki{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==on.boolean){const n=this._getOrReturnCtx(t);return Jr(n,{code:Rr.invalid_type,expected:on.boolean,received:n.parsedType}),di}return bc(t.data)}}M1.create=e=>new M1({typeName:ci.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Ti(e)});class B0 extends ki{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==on.date){const c=this._getOrReturnCtx(t);return Jr(c,{code:Rr.invalid_type,expected:on.date,received:c.parsedType}),di}if(isNaN(t.data.getTime())){const c=this._getOrReturnCtx(t);return Jr(c,{code:Rr.invalid_date}),di}const n=new ec;let a;for(const c of this._def.checks)c.kind==="min"?t.data.getTime()<c.value&&(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.too_small,message:c.message,inclusive:!0,exact:!1,minimum:c.value,type:"date"}),n.dirty()):c.kind==="max"?t.data.getTime()>c.value&&(a=this._getOrReturnCtx(t,a),Jr(a,{code:Rr.too_big,message:c.message,inclusive:!0,exact:!1,maximum:c.value,type:"date"}),n.dirty()):Xi.assertNever(c);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new B0({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:Pn.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:Pn.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}B0.create=e=>new B0({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:ci.ZodDate,...Ti(e)});class HA extends ki{_parse(t){if(this._getType(t)!==on.symbol){const n=this._getOrReturnCtx(t);return Jr(n,{code:Rr.invalid_type,expected:on.symbol,received:n.parsedType}),di}return bc(t.data)}}HA.create=e=>new HA({typeName:ci.ZodSymbol,...Ti(e)});class O1 extends ki{_parse(t){if(this._getType(t)!==on.undefined){const n=this._getOrReturnCtx(t);return Jr(n,{code:Rr.invalid_type,expected:on.undefined,received:n.parsedType}),di}return bc(t.data)}}O1.create=e=>new O1({typeName:ci.ZodUndefined,...Ti(e)});class R1 extends ki{_parse(t){if(this._getType(t)!==on.null){const n=this._getOrReturnCtx(t);return Jr(n,{code:Rr.invalid_type,expected:on.null,received:n.parsedType}),di}return bc(t.data)}}R1.create=e=>new R1({typeName:ci.ZodNull,...Ti(e)});class Cx extends ki{constructor(){super(...arguments),this._any=!0}_parse(t){return bc(t.data)}}Cx.create=e=>new Cx({typeName:ci.ZodAny,...Ti(e)});class E0 extends ki{constructor(){super(...arguments),this._unknown=!0}_parse(t){return bc(t.data)}}E0.create=e=>new E0({typeName:ci.ZodUnknown,...Ti(e)});class bm extends ki{_parse(t){const r=this._getOrReturnCtx(t);return Jr(r,{code:Rr.invalid_type,expected:on.never,received:r.parsedType}),di}}bm.create=e=>new bm({typeName:ci.ZodNever,...Ti(e)});class KA extends ki{_parse(t){if(this._getType(t)!==on.undefined){const n=this._getOrReturnCtx(t);return Jr(n,{code:Rr.invalid_type,expected:on.void,received:n.parsedType}),di}return bc(t.data)}}KA.create=e=>new KA({typeName:ci.ZodVoid,...Ti(e)});class Bh extends ki{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==on.array)return Jr(r,{code:Rr.invalid_type,expected:on.array,received:r.parsedType}),di;if(a.exactLength!==null){const f=r.data.length>a.exactLength.value,i=r.data.length<a.exactLength.value;(f||i)&&(Jr(r,{code:f?Rr.too_big:Rr.too_small,minimum:i?a.exactLength.value:void 0,maximum:f?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(Jr(r,{code:Rr.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(Jr(r,{code:Rr.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((f,i)=>a.type._parseAsync(new rp(r,f,r.path,i)))).then(f=>ec.mergeArray(n,f));const c=[...r.data].map((f,i)=>a.type._parseSync(new rp(r,f,r.path,i)));return ec.mergeArray(n,c)}get element(){return this._def.type}min(t,r){return new Bh({...this._def,minLength:{value:t,message:Pn.toString(r)}})}max(t,r){return new Bh({...this._def,maxLength:{value:t,message:Pn.toString(r)}})}length(t,r){return new Bh({...this._def,exactLength:{value:t,message:Pn.toString(r)}})}nonempty(t){return this.min(1,t)}}Bh.create=(e,t)=>new Bh({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ci.ZodArray,...Ti(t)});function sx(e){if(e instanceof Ls){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=Hf.create(sx(n))}return new Ls({...e._def,shape:()=>t})}else return e instanceof Bh?new Bh({...e._def,type:sx(e.element)}):e instanceof Hf?Hf.create(sx(e.unwrap())):e instanceof ty?ty.create(sx(e.unwrap())):e instanceof np?np.create(e.items.map(t=>sx(t))):e}class Ls extends ki{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Xi.objectKeys(t);return this._cached={shape:t,keys:r}}_parse(t){if(this._getType(t)!==on.object){const w=this._getOrReturnCtx(t);return Jr(w,{code:Rr.invalid_type,expected:on.object,received:w.parsedType}),di}const{status:n,ctx:a}=this._processInputParams(t),{shape:c,keys:f}=this._getCached(),i=[];if(!(this._def.catchall instanceof bm&&this._def.unknownKeys==="strip"))for(const w in a.data)f.includes(w)||i.push(w);const x=[];for(const w of f){const A=c[w],P=a.data[w];x.push({key:{status:"valid",value:w},value:A._parse(new rp(a,P,a.path,w)),alwaysSet:w in a.data})}if(this._def.catchall instanceof bm){const w=this._def.unknownKeys;if(w==="passthrough")for(const A of i)x.push({key:{status:"valid",value:A},value:{status:"valid",value:a.data[A]}});else if(w==="strict")i.length>0&&(Jr(a,{code:Rr.unrecognized_keys,keys:i}),n.dirty());else if(w!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const w=this._def.catchall;for(const A of i){const P=a.data[A];x.push({key:{status:"valid",value:A},value:w._parse(new rp(a,P,a.path,A)),alwaysSet:A in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const w=[];for(const A of x){const P=await A.key,E=await A.value;w.push({key:P,value:E,alwaysSet:A.alwaysSet})}return w}).then(w=>ec.mergeObjectSync(n,w)):ec.mergeObjectSync(n,x)}get shape(){return this._def.shape()}strict(t){return Pn.errToObj,new Ls({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var a,c,f,i;const x=(f=(c=(a=this._def).errorMap)===null||c===void 0?void 0:c.call(a,r,n).message)!==null&&f!==void 0?f:n.defaultError;return r.code==="unrecognized_keys"?{message:(i=Pn.errToObj(t).message)!==null&&i!==void 0?i:x}:{message:x}}}:{}})}strip(){return new Ls({...this._def,unknownKeys:"strip"})}passthrough(){return new Ls({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ls({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ls({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:ci.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Ls({...this._def,catchall:t})}pick(t){const r={};return Xi.objectKeys(t).forEach(n=>{t[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Ls({...this._def,shape:()=>r})}omit(t){const r={};return Xi.objectKeys(this.shape).forEach(n=>{t[n]||(r[n]=this.shape[n])}),new Ls({...this._def,shape:()=>r})}deepPartial(){return sx(this)}partial(t){const r={};return Xi.objectKeys(this.shape).forEach(n=>{const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}),new Ls({...this._def,shape:()=>r})}required(t){const r={};return Xi.objectKeys(this.shape).forEach(n=>{if(t&&!t[n])r[n]=this.shape[n];else{let c=this.shape[n];for(;c instanceof Hf;)c=c._def.innerType;r[n]=c}}),new Ls({...this._def,shape:()=>r})}keyof(){return TZ(Xi.objectKeys(this.shape))}}Ls.create=(e,t)=>new Ls({shape:()=>e,unknownKeys:"strip",catchall:bm.create(),typeName:ci.ZodObject,...Ti(t)});Ls.strictCreate=(e,t)=>new Ls({shape:()=>e,unknownKeys:"strict",catchall:bm.create(),typeName:ci.ZodObject,...Ti(t)});Ls.lazycreate=(e,t)=>new Ls({shape:e,unknownKeys:"strip",catchall:bm.create(),typeName:ci.ZodObject,...Ti(t)});class I1 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(c){for(const i of c)if(i.result.status==="valid")return i.result;for(const i of c)if(i.result.status==="dirty")return r.common.issues.push(...i.ctx.common.issues),i.result;const f=c.map(i=>new Mu(i.ctx.common.issues));return Jr(r,{code:Rr.invalid_union,unionErrors:f}),di}if(r.common.async)return Promise.all(n.map(async c=>{const f={...r,common:{...r.common,issues:[]},parent:null};return{result:await c._parseAsync({data:r.data,path:r.path,parent:f}),ctx:f}})).then(a);{let c;const f=[];for(const x of n){const w={...r,common:{...r.common,issues:[]},parent:null},A=x._parseSync({data:r.data,path:r.path,parent:w});if(A.status==="valid")return A;A.status==="dirty"&&!c&&(c={result:A,ctx:w}),w.common.issues.length&&f.push(w.common.issues)}if(c)return r.common.issues.push(...c.ctx.common.issues),c.result;const i=f.map(x=>new Mu(x));return Jr(r,{code:Rr.invalid_union,unionErrors:i}),di}}get options(){return this._def.options}}I1.create=(e,t)=>new I1({options:e,typeName:ci.ZodUnion,...Ti(t)});const am=e=>e instanceof z1?am(e.schema):e instanceof Hh?am(e.innerType()):e instanceof F1?[e.value]:e instanceof ey?e.options:e instanceof B1?Xi.objectValues(e.enum):e instanceof V1?am(e._def.innerType):e instanceof O1?[void 0]:e instanceof R1?[null]:e instanceof Hf?[void 0,...am(e.unwrap())]:e instanceof ty?[null,...am(e.unwrap())]:e instanceof MD||e instanceof $1?am(e.unwrap()):e instanceof U1?am(e._def.innerType):[];class IP extends ki{_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==on.object)return Jr(r,{code:Rr.invalid_type,expected:on.object,received:r.parsedType}),di;const n=this.discriminator,a=r.data[n],c=this.optionsMap.get(a);return c?r.common.async?c._parseAsync({data:r.data,path:r.path,parent:r}):c._parseSync({data:r.data,path:r.path,parent:r}):(Jr(r,{code:Rr.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),di)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,r,n){const a=new Map;for(const c of r){const f=am(c.shape[t]);if(!f.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const i of f){if(a.has(i))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(i)}`);a.set(i,c)}}return new IP({typeName:ci.ZodDiscriminatedUnion,discriminator:t,options:r,optionsMap:a,...Ti(n)})}}function xR(e,t){const r=lm(e),n=lm(t);if(e===t)return{valid:!0,data:e};if(r===on.object&&n===on.object){const a=Xi.objectKeys(t),c=Xi.objectKeys(e).filter(i=>a.indexOf(i)!==-1),f={...e,...t};for(const i of c){const x=xR(e[i],t[i]);if(!x.valid)return{valid:!1};f[i]=x.data}return{valid:!0,data:f}}else if(r===on.array&&n===on.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let c=0;c<e.length;c++){const f=e[c],i=t[c],x=xR(f,i);if(!x.valid)return{valid:!1};a.push(x.data)}return{valid:!0,data:a}}else return r===on.date&&n===on.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class D1 extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(c,f)=>{if(yR(c)||yR(f))return di;const i=xR(c.value,f.value);return i.valid?((vR(c)||vR(f))&&r.dirty(),{status:r.value,value:i.data}):(Jr(n,{code:Rr.invalid_intersection_types}),di)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([c,f])=>a(c,f)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}D1.create=(e,t,r)=>new D1({left:e,right:t,typeName:ci.ZodIntersection,...Ti(r)});class np extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==on.array)return Jr(n,{code:Rr.invalid_type,expected:on.array,received:n.parsedType}),di;if(n.data.length<this._def.items.length)return Jr(n,{code:Rr.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),di;!this._def.rest&&n.data.length>this._def.items.length&&(Jr(n,{code:Rr.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const c=[...n.data].map((f,i)=>{const x=this._def.items[i]||this._def.rest;return x?x._parse(new rp(n,f,n.path,i)):null}).filter(f=>!!f);return n.common.async?Promise.all(c).then(f=>ec.mergeArray(r,f)):ec.mergeArray(r,c)}get items(){return this._def.items}rest(t){return new np({...this._def,rest:t})}}np.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new np({items:e,typeName:ci.ZodTuple,rest:null,...Ti(t)})};class L1 extends ki{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==on.object)return Jr(n,{code:Rr.invalid_type,expected:on.object,received:n.parsedType}),di;const a=[],c=this._def.keyType,f=this._def.valueType;for(const i in n.data)a.push({key:c._parse(new rp(n,i,n.path,i)),value:f._parse(new rp(n,n.data[i],n.path,i)),alwaysSet:i in n.data});return n.common.async?ec.mergeObjectAsync(r,a):ec.mergeObjectSync(r,a)}get element(){return this._def.valueType}static create(t,r,n){return r instanceof ki?new L1({keyType:t,valueType:r,typeName:ci.ZodRecord,...Ti(n)}):new L1({keyType:Fh.create(),valueType:t,typeName:ci.ZodRecord,...Ti(r)})}}class ZA extends ki{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==on.map)return Jr(n,{code:Rr.invalid_type,expected:on.map,received:n.parsedType}),di;const a=this._def.keyType,c=this._def.valueType,f=[...n.data.entries()].map(([i,x],w)=>({key:a._parse(new rp(n,i,n.path,[w,"key"])),value:c._parse(new rp(n,x,n.path,[w,"value"]))}));if(n.common.async){const i=new Map;return Promise.resolve().then(async()=>{for(const x of f){const w=await x.key,A=await x.value;if(w.status==="aborted"||A.status==="aborted")return di;(w.status==="dirty"||A.status==="dirty")&&r.dirty(),i.set(w.value,A.value)}return{status:r.value,value:i}})}else{const i=new Map;for(const x of f){const w=x.key,A=x.value;if(w.status==="aborted"||A.status==="aborted")return di;(w.status==="dirty"||A.status==="dirty")&&r.dirty(),i.set(w.value,A.value)}return{status:r.value,value:i}}}}ZA.create=(e,t,r)=>new ZA({valueType:t,keyType:e,typeName:ci.ZodMap,...Ti(r)});class V0 extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==on.set)return Jr(n,{code:Rr.invalid_type,expected:on.set,received:n.parsedType}),di;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(Jr(n,{code:Rr.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(Jr(n,{code:Rr.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const c=this._def.valueType;function f(x){const w=new Set;for(const A of x){if(A.status==="aborted")return di;A.status==="dirty"&&r.dirty(),w.add(A.value)}return{status:r.value,value:w}}const i=[...n.data.values()].map((x,w)=>c._parse(new rp(n,x,n.path,w)));return n.common.async?Promise.all(i).then(x=>f(x)):f(i)}min(t,r){return new V0({...this._def,minSize:{value:t,message:Pn.toString(r)}})}max(t,r){return new V0({...this._def,maxSize:{value:t,message:Pn.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}V0.create=(e,t)=>new V0({valueType:e,minSize:null,maxSize:null,typeName:ci.ZodSet,...Ti(t)});class bx extends ki{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==on.function)return Jr(r,{code:Rr.invalid_type,expected:on.function,received:r.parsedType}),di;function n(i,x){return GA({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,qA(),jx].filter(w=>!!w),issueData:{code:Rr.invalid_arguments,argumentsError:x}})}function a(i,x){return GA({data:i,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,qA(),jx].filter(w=>!!w),issueData:{code:Rr.invalid_return_type,returnTypeError:x}})}const c={errorMap:r.common.contextualErrorMap},f=r.data;if(this._def.returns instanceof kx){const i=this;return bc(async function(...x){const w=new Mu([]),A=await i._def.args.parseAsync(x,c).catch(D=>{throw w.addIssue(n(x,D)),w}),P=await Reflect.apply(f,this,A);return await i._def.returns._def.type.parseAsync(P,c).catch(D=>{throw w.addIssue(a(P,D)),w})})}else{const i=this;return bc(function(...x){const w=i._def.args.safeParse(x,c);if(!w.success)throw new Mu([n(x,w.error)]);const A=Reflect.apply(f,this,w.data),P=i._def.returns.safeParse(A,c);if(!P.success)throw new Mu([a(A,P.error)]);return P.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new bx({...this._def,args:np.create(t).rest(E0.create())})}returns(t){return new bx({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,r,n){return new bx({args:t||np.create([]).rest(E0.create()),returns:r||E0.create(),typeName:ci.ZodFunction,...Ti(n)})}}class z1 extends ki{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}z1.create=(e,t)=>new z1({getter:e,typeName:ci.ZodLazy,...Ti(t)});class F1 extends ki{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return Jr(r,{received:r.data,code:Rr.invalid_literal,expected:this._def.value}),di}return{status:"valid",value:t.data}}get value(){return this._def.value}}F1.create=(e,t)=>new F1({value:e,typeName:ci.ZodLiteral,...Ti(t)});function TZ(e,t){return new ey({values:e,typeName:ci.ZodEnum,...Ti(t)})}class ey extends ki{constructor(){super(...arguments),Qb.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return Jr(r,{expected:Xi.joinValues(n),received:r.parsedType,code:Rr.invalid_type}),di}if(WA(this,Qb)||bZ(this,Qb,new Set(this._def.values)),!WA(this,Qb).has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return Jr(r,{received:r.data,code:Rr.invalid_enum_value,options:n}),di}return bc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return ey.create(t,{...this._def,...r})}exclude(t,r=this._def){return ey.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Qb=new WeakMap;ey.create=TZ;class B1 extends ki{constructor(){super(...arguments),e1.set(this,void 0)}_parse(t){const r=Xi.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==on.string&&n.parsedType!==on.number){const a=Xi.objectValues(r);return Jr(n,{expected:Xi.joinValues(a),received:n.parsedType,code:Rr.invalid_type}),di}if(WA(this,e1)||bZ(this,e1,new Set(Xi.getValidEnumValues(this._def.values))),!WA(this,e1).has(t.data)){const a=Xi.objectValues(r);return Jr(n,{received:n.data,code:Rr.invalid_enum_value,options:a}),di}return bc(t.data)}get enum(){return this._def.values}}e1=new WeakMap;B1.create=(e,t)=>new B1({values:e,typeName:ci.ZodNativeEnum,...Ti(t)});class kx extends ki{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==on.promise&&r.common.async===!1)return Jr(r,{code:Rr.invalid_type,expected:on.promise,received:r.parsedType}),di;const n=r.parsedType===on.promise?r.data:Promise.resolve(r.data);return bc(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}kx.create=(e,t)=>new kx({type:e,typeName:ci.ZodPromise,...Ti(t)});class Hh extends ki{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ci.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,c={addIssue:f=>{Jr(n,f),f.fatal?r.abort():r.dirty()},get path(){return n.path}};if(c.addIssue=c.addIssue.bind(c),a.type==="preprocess"){const f=a.transform(n.data,c);if(n.common.async)return Promise.resolve(f).then(async i=>{if(r.value==="aborted")return di;const x=await this._def.schema._parseAsync({data:i,path:n.path,parent:n});return x.status==="aborted"?di:x.status==="dirty"||r.value==="dirty"?ox(x.value):x});{if(r.value==="aborted")return di;const i=this._def.schema._parseSync({data:f,path:n.path,parent:n});return i.status==="aborted"?di:i.status==="dirty"||r.value==="dirty"?ox(i.value):i}}if(a.type==="refinement"){const f=i=>{const x=a.refinement(i,c);if(n.common.async)return Promise.resolve(x);if(x instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return i};if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?di:(i.status==="dirty"&&r.dirty(),f(i.value),{status:r.value,value:i.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>i.status==="aborted"?di:(i.status==="dirty"&&r.dirty(),f(i.value).then(()=>({status:r.value,value:i.value}))))}if(a.type==="transform")if(n.common.async===!1){const f=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!F0(f))return f;const i=a.transform(f.value,c);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:i}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(f=>F0(f)?Promise.resolve(a.transform(f.value,c)).then(i=>({status:r.value,value:i})):f);Xi.assertNever(a)}}Hh.create=(e,t,r)=>new Hh({schema:e,typeName:ci.ZodEffects,effect:t,...Ti(r)});Hh.createWithPreprocess=(e,t,r)=>new Hh({schema:t,effect:{type:"preprocess",transform:e},typeName:ci.ZodEffects,...Ti(r)});class Hf extends ki{_parse(t){return this._getType(t)===on.undefined?bc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Hf.create=(e,t)=>new Hf({innerType:e,typeName:ci.ZodOptional,...Ti(t)});class ty extends ki{_parse(t){return this._getType(t)===on.null?bc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}ty.create=(e,t)=>new ty({innerType:e,typeName:ci.ZodNullable,...Ti(t)});class V1 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===on.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}V1.create=(e,t)=>new V1({innerType:e,typeName:ci.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ti(t)});class U1 extends ki{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return E1(a)?a.then(c=>({status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new Mu(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Mu(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}U1.create=(e,t)=>new U1({innerType:e,typeName:ci.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ti(t)});class YA extends ki{_parse(t){if(this._getType(t)!==on.nan){const n=this._getOrReturnCtx(t);return Jr(n,{code:Rr.invalid_type,expected:on.nan,received:n.parsedType}),di}return{status:"valid",value:t.data}}}YA.create=e=>new YA({typeName:ci.ZodNaN,...Ti(e)});const zge=Symbol("zod_brand");class MD extends ki{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Yw extends ki{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const c=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?di:c.status==="dirty"?(r.dirty(),ox(c.value)):this._def.out._parseAsync({data:c.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?di:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new Yw({in:t,out:r,typeName:ci.ZodPipeline})}}class $1 extends ki{_parse(t){const r=this._def.innerType._parse(t),n=a=>(F0(a)&&(a.value=Object.freeze(a.value)),a);return E1(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}$1.create=(e,t)=>new $1({innerType:e,typeName:ci.ZodReadonly,...Ti(t)});function P6(e,t){const r=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof r=="string"?{message:r}:r}function PZ(e,t={},r){return e?Cx.create().superRefine((n,a)=>{var c,f;const i=e(n);if(i instanceof Promise)return i.then(x=>{var w,A;if(!x){const P=P6(t,n),E=(A=(w=P.fatal)!==null&&w!==void 0?w:r)!==null&&A!==void 0?A:!0;a.addIssue({code:"custom",...P,fatal:E})}});if(!i){const x=P6(t,n),w=(f=(c=x.fatal)!==null&&c!==void 0?c:r)!==null&&f!==void 0?f:!0;a.addIssue({code:"custom",...x,fatal:w})}}):Cx.create()}const Fge={object:Ls.lazycreate};var ci;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ci||(ci={}));const Bge=(e,t={message:`Input not instance of ${e.name}`})=>PZ(r=>r instanceof e,t),NZ=Fh.create,jZ=Jg.create,Vge=YA.create,Uge=Qg.create,CZ=M1.create,$ge=B0.create,qge=HA.create,Gge=O1.create,Wge=R1.create,Hge=Cx.create,Kge=E0.create,Zge=bm.create,Yge=KA.create,Xge=Bh.create,Jge=Ls.create,Qge=Ls.strictCreate,eye=I1.create,tye=IP.create,rye=D1.create,nye=np.create,iye=L1.create,aye=ZA.create,sye=V0.create,oye=bx.create,lye=z1.create,cye=F1.create,uye=ey.create,dye=B1.create,hye=kx.create,N6=Hh.create,fye=Hf.create,pye=ty.create,mye=Hh.createWithPreprocess,gye=Yw.create,yye=()=>NZ().optional(),vye=()=>jZ().optional(),xye=()=>CZ().optional(),_ye={string:e=>Fh.create({...e,coerce:!0}),number:e=>Jg.create({...e,coerce:!0}),boolean:e=>M1.create({...e,coerce:!0}),bigint:e=>Qg.create({...e,coerce:!0}),date:e=>B0.create({...e,coerce:!0})},bye=di;var Dr=Object.freeze({__proto__:null,defaultErrorMap:jx,setErrorMap:mge,getErrorMap:qA,makeIssue:GA,EMPTY_PATH:gge,addIssueToContext:Jr,ParseStatus:ec,INVALID:di,DIRTY:ox,OK:bc,isAborted:yR,isDirty:vR,isValid:F0,isAsync:E1,get util(){return Xi},get objectUtil(){return gR},ZodParsedType:on,getParsedType:lm,ZodType:ki,datetimeRegex:AZ,ZodString:Fh,ZodNumber:Jg,ZodBigInt:Qg,ZodBoolean:M1,ZodDate:B0,ZodSymbol:HA,ZodUndefined:O1,ZodNull:R1,ZodAny:Cx,ZodUnknown:E0,ZodNever:bm,ZodVoid:KA,ZodArray:Bh,ZodObject:Ls,ZodUnion:I1,ZodDiscriminatedUnion:IP,ZodIntersection:D1,ZodTuple:np,ZodRecord:L1,ZodMap:ZA,ZodSet:V0,ZodFunction:bx,ZodLazy:z1,ZodLiteral:F1,ZodEnum:ey,ZodNativeEnum:B1,ZodPromise:kx,ZodEffects:Hh,ZodTransformer:Hh,ZodOptional:Hf,ZodNullable:ty,ZodDefault:V1,ZodCatch:U1,ZodNaN:YA,BRAND:zge,ZodBranded:MD,ZodPipeline:Yw,ZodReadonly:$1,custom:PZ,Schema:ki,ZodSchema:ki,late:Fge,get ZodFirstPartyTypeKind(){return ci},coerce:_ye,any:Hge,array:Xge,bigint:Uge,boolean:CZ,date:$ge,discriminatedUnion:tye,effect:N6,enum:uye,function:oye,instanceof:Bge,intersection:rye,lazy:lye,literal:cye,map:aye,nan:Vge,nativeEnum:dye,never:Zge,null:Wge,nullable:pye,number:jZ,object:Jge,oboolean:xye,onumber:vye,optional:fye,ostring:yye,pipeline:gye,preprocess:mye,promise:hye,record:iye,set:sye,strictObject:Qge,string:NZ,symbol:qge,transformer:N6,tuple:nye,undefined:Gge,union:eye,unknown:Kge,void:Yge,NEVER:bye,ZodIssueCode:Rr,quotelessJson:pge,ZodError:Mu});const wye=Dr.object({email:Dr.string().email(),password:Dr.string().min(6,{message:"Password must be at least 6 characters long"})}),kZ=Dr.object({plateNo:Dr.union([Dr.string().min(1,{message:"Plate number is required"}),Dr.array(Dr.string().min(1,{message:"Each plate number must not be empty"})).min(1,{message:"At least one plate number is required"})]).transform(e=>typeof e=="string"?e.split(",").map(t=>t.trim()).filter(t=>t.length>0):e),fileNo:Dr.string().optional(),ownerRepresentativeName:Dr.string().min(1,{message:"Owner/Representative name is required"}),purok:Dr.string().optional(),barangay:Dr.string().min(1,{message:"Barangay is required"}),municipality:Dr.string().min(1,{message:"Municipality is required"}),province:Dr.string().min(1,{message:"Province is required"}),contactNumber:Dr.string().optional(),emailAddress:Dr.string().email({message:"Invalid email format"}).optional().or(Dr.literal("")),hasDriversLicense:Dr.boolean({required_error:"Please specify if you have a driver's license"}),driversLicenseNumber:Dr.string().optional(),birthDate:Dr.date().optional()}).refine(e=>!(e.hasDriversLicense&&!e.driversLicenseNumber),{message:"Driver's license number is required when you have a driver's license",path:["driversLicenseNumber"]}),EZ=Dr.object({plateNo:Dr.string().min(1,{message:"Plate number is required"}),fileNo:Dr.string().min(1,{message:"File number is required"}),engineNo:Dr.string().min(1,{message:"Engine number is required"}),chassisNo:Dr.string().min(1,{message:"Chassis number is required"}),make:Dr.string().min(1,{message:"Make is required"}),bodyType:Dr.string().min(1,{message:"Body type is required"}),color:Dr.string().min(1,{message:"Color is required"}),classification:Dr.string().min(1,{message:"Classification is required"}),dateOfRenewal:Dr.date({required_error:"Date of renewal is required"}),vehicleStatusType:Dr.enum(["New","Old"],{required_error:"Vehicle status type is required"}),driver:Dr.string().min(1,{message:"Driver selection is required"})}),Sye=Dr.object({plateNo:Dr.string().min(1,{message:"Plate number is required"}),fileNo:Dr.string().min(1,{message:"File number is required"}),engineNo:Dr.string().min(1,{message:"Engine number is required"}),chassisNo:Dr.string().min(1,{message:"Chassis number is required"}),make:Dr.string().min(1,{message:"Make is required"}),bodyType:Dr.string().min(1,{message:"Body type is required"}),color:Dr.string().min(1,{message:"Color is required"}),classification:Dr.string().min(1,{message:"Classification is required"}),dateOfRenewal:Dr.date({required_error:"Date of renewal is required"}),vehicleStatusType:Dr.enum(["New","Old"],{required_error:"Vehicle status type is required"}),driver:Dr.string().optional().or(Dr.null())}),MZ=Dr.object({accident_id:Dr.string().optional(),plateNo:Dr.string().min(1,{message:"Plate number is required"}),accident_date:Dr.date({required_error:"Accident date is required"}),street:Dr.string().min(1,{message:"Street is required"}),barangay:Dr.string().min(1,{message:"Barangay is required"}),municipality:Dr.string().min(1,{message:"Municipality is required"}),vehicle_type:Dr.string().min(1,{message:"Vehicle type is required"}),severity:Dr.string().min(1,{message:"Severity is required"}),notes:Dr.string().optional()}),OD=Dr.object({topNo:Dr.string().optional(),firstName:Dr.string().optional().nullable(),middleInitial:Dr.string().optional().nullable(),lastName:Dr.string().optional().nullable(),suffix:Dr.string().optional().nullable(),violations:Dr.array(Dr.string()).optional().nullable(),violationType:Dr.enum(["confiscated","alarm","impounded"],{required_error:"Violation type is required"}),licenseType:Dr.string().optional().nullable(),plateNo:Dr.string().min(1,{message:"Plate number is required"}),dateOfApprehension:Dr.date({required_error:"Date of apprehension is required"}),apprehendingOfficer:Dr.string().min(1,{message:"Apprehending officer is required"}),chassisNo:Dr.string().optional().nullable(),engineNo:Dr.string().optional().nullable()}).refine(e=>!(e.middleInitial&&e.middleInitial!==null&&e.middleInitial!=="null"&&e.middleInitial.trim()!==""&&e.middleInitial.length>1),{message:"Middle initial must be 1 character",path:["middleInitial"]}).refine(e=>!(e.licenseType&&e.licenseType!==null&&e.licenseType!=="null"&&e.licenseType.trim()!==""&&!["SP","DL","CL","PLATE","SP RECEIPT","DL RECEIPT","REFUSE TO SUR.","DL TEMPORARY","-","null"].includes(e.licenseType)),{message:"License type must be a valid option",path:["licenseType"]}),j6=(e,t,r)=>{if(e&&"reportValidity"in e){const n=Hr(r,t);e.setCustomValidity(n&&n.message||""),e.reportValidity()}},OZ=(e,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?j6(n.ref,r,e):n&&n.refs&&n.refs.forEach(a=>j6(a,r,e))}},Aye=(e,t)=>{t.shouldUseNativeValidation&&OZ(e,t);const r={};for(const n in e){const a=Hr(t.fields,n),c=Object.assign(e[n]||{},{ref:a&&a.ref});if(Tye(t.names||Object.keys(e),n)){const f=Object.assign({},Hr(r,n));ba(f,"root",c),ba(r,n,f)}else ba(r,n,c)}return r},Tye=(e,t)=>{const r=C6(t);return e.some(n=>C6(n).match(`^${r}\\.\\d+`))};function C6(e){return e.replace(/\]|\[/g,"")}function Pye(e,t){for(var r={};e.length;){var n=e[0],a=n.code,c=n.message,f=n.path.join(".");if(!r[f])if("unionErrors"in n){var i=n.unionErrors[0].errors[0];r[f]={message:i.message,type:i.code}}else r[f]={message:c,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(A){return A.errors.forEach(function(P){return e.push(P)})}),t){var x=r[f].types,w=x&&x[n.code];r[f]=fZ(f,t,r,a,w?[].concat(w,n.message):n.message)}e.shift()}return r}function tc(e,t,r){return r===void 0&&(r={}),function(n,a,c){try{return Promise.resolve(function(f,i){try{var x=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(w){return c.shouldUseNativeValidation&&OZ({},c),{errors:{},values:r.raw?Object.assign({},n):w}})}catch(w){return i(w)}return x&&x.then?x.then(void 0,i):x}(0,function(f){if(function(i){return Array.isArray(i==null?void 0:i.errors)}(f))return{values:{},errors:Aye(Pye(f.errors,!c.shouldUseNativeValidation&&c.criteriaMode==="all"),c)};throw f}))}catch(f){return Promise.reject(f)}}}var Nye="Label",RZ=W.forwardRef((e,t)=>l.jsx(vi.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));RZ.displayName=Nye;var IZ=RZ;const jye=Vw("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ls=W.forwardRef(({className:e,...t},r)=>l.jsx(IZ,{ref:r,className:Ut(jye(),e),...t}));ls.displayName=IZ.displayName;const ip=Qme,DZ=W.createContext({}),En=({...e})=>l.jsx(DZ.Provider,{value:{name:e.name},children:l.jsx(rge,{...e})}),DP=()=>{const e=W.useContext(DZ),t=W.useContext(LZ),{getFieldState:r,formState:n}=RP(),a=r(e.name,n);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:c}=t;return{id:c,name:e.name,formItemId:`${c}-form-item`,formDescriptionId:`${c}-form-item-description`,formMessageId:`${c}-form-item-message`,...a}},LZ=W.createContext({}),jn=W.forwardRef(({className:e,...t},r)=>{const n=W.useId();return l.jsx(LZ.Provider,{value:{id:n},children:l.jsx("div",{ref:r,className:Ut("space-y-2",e),...t})})});jn.displayName="FormItem";const $n=W.forwardRef(({className:e,...t},r)=>{const{error:n,formItemId:a}=DP();return l.jsx(ls,{ref:r,className:Ut(n&&"text-destructive",e),htmlFor:a,...t})});$n.displayName="FormLabel";const Nn=W.forwardRef(({...e},t)=>{const{error:r,formItemId:n,formDescriptionId:a,formMessageId:c}=DP();return l.jsx(Ql,{ref:t,id:n,"aria-describedby":r?`${a} ${c}`:`${a}`,"aria-invalid":!!r,...e})});Nn.displayName="FormControl";const Cye=W.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:n}=DP();return l.jsx("p",{ref:r,id:n,className:Ut("text-[0.8rem] text-muted-foreground",e),...t})});Cye.displayName="FormDescription";const Cn=W.forwardRef(({className:e,children:t,...r},n)=>{const{error:a,formMessageId:c}=DP(),f=a?String((a==null?void 0:a.message)??""):t;return f?l.jsx("p",{ref:n,id:c,className:Ut("text-[0.8rem] font-medium text-destructive",e),...r,children:f}):null});Cn.displayName="FormMessage";function zZ(e,t){return function(){return e.apply(t,arguments)}}const{toString:kye}=Object.prototype,{getPrototypeOf:RD}=Object,LP=(e=>t=>{const r=kye.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Jh=e=>(e=e.toLowerCase(),t=>LP(t)===e),zP=e=>t=>typeof t===e,{isArray:A_}=Array,q1=zP("undefined");function Eye(e){return e!==null&&!q1(e)&&e.constructor!==null&&!q1(e.constructor)&&Ou(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const FZ=Jh("ArrayBuffer");function Mye(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&FZ(e.buffer),t}const Oye=zP("string"),Ou=zP("function"),BZ=zP("number"),FP=e=>e!==null&&typeof e=="object",Rye=e=>e===!0||e===!1,gA=e=>{if(LP(e)!=="object")return!1;const t=RD(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Iye=Jh("Date"),Dye=Jh("File"),Lye=Jh("Blob"),zye=Jh("FileList"),Fye=e=>FP(e)&&Ou(e.pipe),Bye=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Ou(e.append)&&((t=LP(e))==="formdata"||t==="object"&&Ou(e.toString)&&e.toString()==="[object FormData]"))},Vye=Jh("URLSearchParams"),[Uye,$ye,qye,Gye]=["ReadableStream","Request","Response","Headers"].map(Jh),Wye=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xw(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),A_(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const c=r?Object.getOwnPropertyNames(e):Object.keys(e),f=c.length;let i;for(n=0;n<f;n++)i=c[n],t.call(null,e[i],i,e)}}function VZ(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const S0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,UZ=e=>!q1(e)&&e!==S0;function _R(){const{caseless:e}=UZ(this)&&this||{},t={},r=(n,a)=>{const c=e&&VZ(t,a)||a;gA(t[c])&&gA(n)?t[c]=_R(t[c],n):gA(n)?t[c]=_R({},n):A_(n)?t[c]=n.slice():t[c]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&Xw(arguments[n],r);return t}const Hye=(e,t,r,{allOwnKeys:n}={})=>(Xw(t,(a,c)=>{r&&Ou(a)?e[c]=zZ(a,r):e[c]=a},{allOwnKeys:n}),e),Kye=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Zye=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Yye=(e,t,r,n)=>{let a,c,f;const i={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),c=a.length;c-- >0;)f=a[c],(!n||n(f,e,t))&&!i[f]&&(t[f]=e[f],i[f]=!0);e=r!==!1&&RD(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Xye=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Jye=e=>{if(!e)return null;if(A_(e))return e;let t=e.length;if(!BZ(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Qye=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&RD(Uint8Array)),e0e=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const c=a.value;t.call(e,c[0],c[1])}},t0e=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},r0e=Jh("HTMLFormElement"),n0e=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),k6=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),i0e=Jh("RegExp"),$Z=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Xw(r,(a,c)=>{let f;(f=t(a,c,e))!==!1&&(n[c]=f||a)}),Object.defineProperties(e,n)},a0e=e=>{$Z(e,(t,r)=>{if(Ou(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Ou(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},s0e=(e,t)=>{const r={},n=a=>{a.forEach(c=>{r[c]=!0})};return A_(e)?n(e):n(String(e).split(t)),r},o0e=()=>{},l0e=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function c0e(e){return!!(e&&Ou(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const u0e=e=>{const t=new Array(10),r=(n,a)=>{if(FP(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const c=A_(n)?[]:{};return Xw(n,(f,i)=>{const x=r(f,a+1);!q1(x)&&(c[i]=x)}),t[a]=void 0,c}}return n};return r(e,0)},d0e=Jh("AsyncFunction"),h0e=e=>e&&(FP(e)||Ou(e))&&Ou(e.then)&&Ou(e.catch),qZ=((e,t)=>e?setImmediate:t?((r,n)=>(S0.addEventListener("message",({source:a,data:c})=>{a===S0&&c===r&&n.length&&n.shift()()},!1),a=>{n.push(a),S0.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ou(S0.postMessage)),f0e=typeof queueMicrotask<"u"?queueMicrotask.bind(S0):typeof process<"u"&&process.nextTick||qZ,sr={isArray:A_,isArrayBuffer:FZ,isBuffer:Eye,isFormData:Bye,isArrayBufferView:Mye,isString:Oye,isNumber:BZ,isBoolean:Rye,isObject:FP,isPlainObject:gA,isReadableStream:Uye,isRequest:$ye,isResponse:qye,isHeaders:Gye,isUndefined:q1,isDate:Iye,isFile:Dye,isBlob:Lye,isRegExp:i0e,isFunction:Ou,isStream:Fye,isURLSearchParams:Vye,isTypedArray:Qye,isFileList:zye,forEach:Xw,merge:_R,extend:Hye,trim:Wye,stripBOM:Kye,inherits:Zye,toFlatObject:Yye,kindOf:LP,kindOfTest:Jh,endsWith:Xye,toArray:Jye,forEachEntry:e0e,matchAll:t0e,isHTMLForm:r0e,hasOwnProperty:k6,hasOwnProp:k6,reduceDescriptors:$Z,freezeMethods:a0e,toObjectSet:s0e,toCamelCase:n0e,noop:o0e,toFiniteNumber:l0e,findKey:VZ,global:S0,isContextDefined:UZ,isSpecCompliantForm:c0e,toJSONObject:u0e,isAsyncFn:d0e,isThenable:h0e,setImmediate:qZ,asap:f0e};function Ai(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}sr.inherits(Ai,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:sr.toJSONObject(this.config),code:this.code,status:this.status}}});const GZ=Ai.prototype,WZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WZ[e]={value:e}});Object.defineProperties(Ai,WZ);Object.defineProperty(GZ,"isAxiosError",{value:!0});Ai.from=(e,t,r,n,a,c)=>{const f=Object.create(GZ);return sr.toFlatObject(e,f,function(x){return x!==Error.prototype},i=>i!=="isAxiosError"),Ai.call(f,e.message,t,r,n,a),f.cause=e,f.name=e.name,c&&Object.assign(f,c),f};const p0e=null;function bR(e){return sr.isPlainObject(e)||sr.isArray(e)}function HZ(e){return sr.endsWith(e,"[]")?e.slice(0,-2):e}function E6(e,t,r){return e?e.concat(t).map(function(a,c){return a=HZ(a),!r&&c?"["+a+"]":a}).join(r?".":""):t}function m0e(e){return sr.isArray(e)&&!e.some(bR)}const g0e=sr.toFlatObject(sr,{},null,function(t){return/^is[A-Z]/.test(t)});function BP(e,t,r){if(!sr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=sr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(L,$){return!sr.isUndefined($[L])});const n=r.metaTokens,a=r.visitor||A,c=r.dots,f=r.indexes,x=(r.Blob||typeof Blob<"u"&&Blob)&&sr.isSpecCompliantForm(t);if(!sr.isFunction(a))throw new TypeError("visitor must be a function");function w(V){if(V===null)return"";if(sr.isDate(V))return V.toISOString();if(!x&&sr.isBlob(V))throw new Ai("Blob is not supported. Use a Buffer instead.");return sr.isArrayBuffer(V)||sr.isTypedArray(V)?x&&typeof Blob=="function"?new Blob([V]):Buffer.from(V):V}function A(V,L,$){let H=V;if(V&&!$&&typeof V=="object"){if(sr.endsWith(L,"{}"))L=n?L:L.slice(0,-2),V=JSON.stringify(V);else if(sr.isArray(V)&&m0e(V)||(sr.isFileList(V)||sr.endsWith(L,"[]"))&&(H=sr.toArray(V)))return L=HZ(L),H.forEach(function(Q,ae){!(sr.isUndefined(Q)||Q===null)&&t.append(f===!0?E6([L],ae,c):f===null?L:L+"[]",w(Q))}),!1}return bR(V)?!0:(t.append(E6($,L,c),w(V)),!1)}const P=[],E=Object.assign(g0e,{defaultVisitor:A,convertValue:w,isVisitable:bR});function D(V,L){if(!sr.isUndefined(V)){if(P.indexOf(V)!==-1)throw Error("Circular reference detected in "+L.join("."));P.push(V),sr.forEach(V,function(H,K){(!(sr.isUndefined(H)||H===null)&&a.call(t,H,sr.isString(K)?K.trim():K,L,E))===!0&&D(H,L?L.concat(K):[K])}),P.pop()}}if(!sr.isObject(e))throw new TypeError("data must be an object");return D(e),t}function M6(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function ID(e,t){this._pairs=[],e&&BP(e,this,t)}const KZ=ID.prototype;KZ.append=function(t,r){this._pairs.push([t,r])};KZ.toString=function(t){const r=t?function(n){return t.call(this,n,M6)}:M6;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function y0e(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ZZ(e,t,r){if(!t)return e;const n=r&&r.encode||y0e;sr.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let c;if(a?c=a(t,r):c=sr.isURLSearchParams(t)?t.toString():new ID(t,r).toString(n),c){const f=e.indexOf("#");f!==-1&&(e=e.slice(0,f)),e+=(e.indexOf("?")===-1?"?":"&")+c}return e}class O6{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){sr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const YZ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},v0e=typeof URLSearchParams<"u"?URLSearchParams:ID,x0e=typeof FormData<"u"?FormData:null,_0e=typeof Blob<"u"?Blob:null,b0e={isBrowser:!0,classes:{URLSearchParams:v0e,FormData:x0e,Blob:_0e},protocols:["http","https","file","blob","url","data"]},DD=typeof window<"u"&&typeof document<"u",wR=typeof navigator=="object"&&navigator||void 0,w0e=DD&&(!wR||["ReactNative","NativeScript","NS"].indexOf(wR.product)<0),S0e=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",A0e=DD&&window.location.href||"http://localhost",T0e=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:DD,hasStandardBrowserEnv:w0e,hasStandardBrowserWebWorkerEnv:S0e,navigator:wR,origin:A0e},Symbol.toStringTag,{value:"Module"})),Zl={...T0e,...b0e};function P0e(e,t){return BP(e,new Zl.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,c){return Zl.isNode&&sr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)}},t))}function N0e(e){return sr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function j0e(e){const t={},r=Object.keys(e);let n;const a=r.length;let c;for(n=0;n<a;n++)c=r[n],t[c]=e[c];return t}function XZ(e){function t(r,n,a,c){let f=r[c++];if(f==="__proto__")return!0;const i=Number.isFinite(+f),x=c>=r.length;return f=!f&&sr.isArray(a)?a.length:f,x?(sr.hasOwnProp(a,f)?a[f]=[a[f],n]:a[f]=n,!i):((!a[f]||!sr.isObject(a[f]))&&(a[f]=[]),t(r,n,a[f],c)&&sr.isArray(a[f])&&(a[f]=j0e(a[f])),!i)}if(sr.isFormData(e)&&sr.isFunction(e.entries)){const r={};return sr.forEachEntry(e,(n,a)=>{t(N0e(n),a,r,0)}),r}return null}function C0e(e,t,r){if(sr.isString(e))try{return(t||JSON.parse)(e),sr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Jw={transitional:YZ,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,c=sr.isObject(t);if(c&&sr.isHTMLForm(t)&&(t=new FormData(t)),sr.isFormData(t))return a?JSON.stringify(XZ(t)):t;if(sr.isArrayBuffer(t)||sr.isBuffer(t)||sr.isStream(t)||sr.isFile(t)||sr.isBlob(t)||sr.isReadableStream(t))return t;if(sr.isArrayBufferView(t))return t.buffer;if(sr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(c){if(n.indexOf("application/x-www-form-urlencoded")>-1)return P0e(t,this.formSerializer).toString();if((i=sr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const x=this.env&&this.env.FormData;return BP(i?{"files[]":t}:t,x&&new x,this.formSerializer)}}return c||a?(r.setContentType("application/json",!1),C0e(t)):t}],transformResponse:[function(t){const r=this.transitional||Jw.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(sr.isResponse(t)||sr.isReadableStream(t))return t;if(t&&sr.isString(t)&&(n&&!this.responseType||a)){const f=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(i){if(f)throw i.name==="SyntaxError"?Ai.from(i,Ai.ERR_BAD_RESPONSE,this,null,this.response):i}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zl.classes.FormData,Blob:Zl.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};sr.forEach(["delete","get","head","post","put","patch"],e=>{Jw.headers[e]={}});const k0e=sr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),E0e=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(f){a=f.indexOf(":"),r=f.substring(0,a).trim().toLowerCase(),n=f.substring(a+1).trim(),!(!r||t[r]&&k0e[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},R6=Symbol("internals");function Lb(e){return e&&String(e).trim().toLowerCase()}function yA(e){return e===!1||e==null?e:sr.isArray(e)?e.map(yA):String(e)}function M0e(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const O0e=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function gC(e,t,r,n,a){if(sr.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!sr.isString(t)){if(sr.isString(n))return t.indexOf(n)!==-1;if(sr.isRegExp(n))return n.test(t)}}function R0e(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function I0e(e,t){const r=sr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,c,f){return this[n].call(this,t,a,c,f)},configurable:!0})})}let Yc=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function c(i,x,w){const A=Lb(x);if(!A)throw new Error("header name must be a non-empty string");const P=sr.findKey(a,A);(!P||a[P]===void 0||w===!0||w===void 0&&a[P]!==!1)&&(a[P||x]=yA(i))}const f=(i,x)=>sr.forEach(i,(w,A)=>c(w,A,x));if(sr.isPlainObject(t)||t instanceof this.constructor)f(t,r);else if(sr.isString(t)&&(t=t.trim())&&!O0e(t))f(E0e(t),r);else if(sr.isHeaders(t))for(const[i,x]of t.entries())c(x,i,n);else t!=null&&c(r,t,n);return this}get(t,r){if(t=Lb(t),t){const n=sr.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return M0e(a);if(sr.isFunction(r))return r.call(this,a,n);if(sr.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Lb(t),t){const n=sr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||gC(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function c(f){if(f=Lb(f),f){const i=sr.findKey(n,f);i&&(!r||gC(n,n[i],i,r))&&(delete n[i],a=!0)}}return sr.isArray(t)?t.forEach(c):c(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const c=r[n];(!t||gC(this,this[c],c,t,!0))&&(delete this[c],a=!0)}return a}normalize(t){const r=this,n={};return sr.forEach(this,(a,c)=>{const f=sr.findKey(n,c);if(f){r[f]=yA(a),delete r[c];return}const i=t?R0e(c):String(c).trim();i!==c&&delete r[c],r[i]=yA(a),n[i]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return sr.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&sr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[R6]=this[R6]={accessors:{}}).accessors,a=this.prototype;function c(f){const i=Lb(f);n[i]||(I0e(a,f),n[i]=!0)}return sr.isArray(t)?t.forEach(c):c(t),this}};Yc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);sr.reduceDescriptors(Yc.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});sr.freezeMethods(Yc);function yC(e,t){const r=this||Jw,n=t||r,a=Yc.from(n.headers);let c=n.data;return sr.forEach(e,function(i){c=i.call(r,c,a.normalize(),t?t.status:void 0)}),a.normalize(),c}function JZ(e){return!!(e&&e.__CANCEL__)}function T_(e,t,r){Ai.call(this,e??"canceled",Ai.ERR_CANCELED,t,r),this.name="CanceledError"}sr.inherits(T_,Ai,{__CANCEL__:!0});function QZ(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Ai("Request failed with status code "+r.status,[Ai.ERR_BAD_REQUEST,Ai.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function D0e(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function L0e(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,c=0,f;return t=t!==void 0?t:1e3,function(x){const w=Date.now(),A=n[c];f||(f=w),r[a]=x,n[a]=w;let P=c,E=0;for(;P!==a;)E+=r[P++],P=P%e;if(a=(a+1)%e,a===c&&(c=(c+1)%e),w-f<t)return;const D=A&&w-A;return D?Math.round(E*1e3/D):void 0}}function z0e(e,t){let r=0,n=1e3/t,a,c;const f=(w,A=Date.now())=>{r=A,a=null,c&&(clearTimeout(c),c=null),e.apply(null,w)};return[(...w)=>{const A=Date.now(),P=A-r;P>=n?f(w,A):(a=w,c||(c=setTimeout(()=>{c=null,f(a)},n-P)))},()=>a&&f(a)]}const XA=(e,t,r=3)=>{let n=0;const a=L0e(50,250);return z0e(c=>{const f=c.loaded,i=c.lengthComputable?c.total:void 0,x=f-n,w=a(x),A=f<=i;n=f;const P={loaded:f,total:i,progress:i?f/i:void 0,bytes:x,rate:w||void 0,estimated:w&&i&&A?(i-f)/w:void 0,event:c,lengthComputable:i!=null,[t?"download":"upload"]:!0};e(P)},r)},I6=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},D6=e=>(...t)=>sr.asap(()=>e(...t)),F0e=Zl.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Zl.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Zl.origin),Zl.navigator&&/(msie|trident)/i.test(Zl.navigator.userAgent)):()=>!0,B0e=Zl.hasStandardBrowserEnv?{write(e,t,r,n,a,c){const f=[e+"="+encodeURIComponent(t)];sr.isNumber(r)&&f.push("expires="+new Date(r).toGMTString()),sr.isString(n)&&f.push("path="+n),sr.isString(a)&&f.push("domain="+a),c===!0&&f.push("secure"),document.cookie=f.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function V0e(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function U0e(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function eY(e,t,r){let n=!V0e(t);return e&&n||r==!1?U0e(e,t):t}const L6=e=>e instanceof Yc?{...e}:e;function U0(e,t){t=t||{};const r={};function n(w,A,P,E){return sr.isPlainObject(w)&&sr.isPlainObject(A)?sr.merge.call({caseless:E},w,A):sr.isPlainObject(A)?sr.merge({},A):sr.isArray(A)?A.slice():A}function a(w,A,P,E){if(sr.isUndefined(A)){if(!sr.isUndefined(w))return n(void 0,w,P,E)}else return n(w,A,P,E)}function c(w,A){if(!sr.isUndefined(A))return n(void 0,A)}function f(w,A){if(sr.isUndefined(A)){if(!sr.isUndefined(w))return n(void 0,w)}else return n(void 0,A)}function i(w,A,P){if(P in t)return n(w,A);if(P in e)return n(void 0,w)}const x={url:c,method:c,data:c,baseURL:f,transformRequest:f,transformResponse:f,paramsSerializer:f,timeout:f,timeoutMessage:f,withCredentials:f,withXSRFToken:f,adapter:f,responseType:f,xsrfCookieName:f,xsrfHeaderName:f,onUploadProgress:f,onDownloadProgress:f,decompress:f,maxContentLength:f,maxBodyLength:f,beforeRedirect:f,transport:f,httpAgent:f,httpsAgent:f,cancelToken:f,socketPath:f,responseEncoding:f,validateStatus:i,headers:(w,A,P)=>a(L6(w),L6(A),P,!0)};return sr.forEach(Object.keys(Object.assign({},e,t)),function(A){const P=x[A]||a,E=P(e[A],t[A],A);sr.isUndefined(E)&&P!==i||(r[A]=E)}),r}const tY=e=>{const t=U0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:c,headers:f,auth:i}=t;t.headers=f=Yc.from(f),t.url=ZZ(eY(t.baseURL,t.url),e.params,e.paramsSerializer),i&&f.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):"")));let x;if(sr.isFormData(r)){if(Zl.hasStandardBrowserEnv||Zl.hasStandardBrowserWebWorkerEnv)f.setContentType(void 0);else if((x=f.getContentType())!==!1){const[w,...A]=x?x.split(";").map(P=>P.trim()).filter(Boolean):[];f.setContentType([w||"multipart/form-data",...A].join("; "))}}if(Zl.hasStandardBrowserEnv&&(n&&sr.isFunction(n)&&(n=n(t)),n||n!==!1&&F0e(t.url))){const w=a&&c&&B0e.read(c);w&&f.set(a,w)}return t},$0e=typeof XMLHttpRequest<"u",q0e=$0e&&function(e){return new Promise(function(r,n){const a=tY(e);let c=a.data;const f=Yc.from(a.headers).normalize();let{responseType:i,onUploadProgress:x,onDownloadProgress:w}=a,A,P,E,D,V;function L(){D&&D(),V&&V(),a.cancelToken&&a.cancelToken.unsubscribe(A),a.signal&&a.signal.removeEventListener("abort",A)}let $=new XMLHttpRequest;$.open(a.method.toUpperCase(),a.url,!0),$.timeout=a.timeout;function H(){if(!$)return;const Q=Yc.from("getAllResponseHeaders"in $&&$.getAllResponseHeaders()),ee={data:!i||i==="text"||i==="json"?$.responseText:$.response,status:$.status,statusText:$.statusText,headers:Q,config:e,request:$};QZ(function(ce){r(ce),L()},function(ce){n(ce),L()},ee),$=null}"onloadend"in $?$.onloadend=H:$.onreadystatechange=function(){!$||$.readyState!==4||$.status===0&&!($.responseURL&&$.responseURL.indexOf("file:")===0)||setTimeout(H)},$.onabort=function(){$&&(n(new Ai("Request aborted",Ai.ECONNABORTED,e,$)),$=null)},$.onerror=function(){n(new Ai("Network Error",Ai.ERR_NETWORK,e,$)),$=null},$.ontimeout=function(){let ae=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const ee=a.transitional||YZ;a.timeoutErrorMessage&&(ae=a.timeoutErrorMessage),n(new Ai(ae,ee.clarifyTimeoutError?Ai.ETIMEDOUT:Ai.ECONNABORTED,e,$)),$=null},c===void 0&&f.setContentType(null),"setRequestHeader"in $&&sr.forEach(f.toJSON(),function(ae,ee){$.setRequestHeader(ee,ae)}),sr.isUndefined(a.withCredentials)||($.withCredentials=!!a.withCredentials),i&&i!=="json"&&($.responseType=a.responseType),w&&([E,V]=XA(w,!0),$.addEventListener("progress",E)),x&&$.upload&&([P,D]=XA(x),$.upload.addEventListener("progress",P),$.upload.addEventListener("loadend",D)),(a.cancelToken||a.signal)&&(A=Q=>{$&&(n(!Q||Q.type?new T_(null,e,$):Q),$.abort(),$=null)},a.cancelToken&&a.cancelToken.subscribe(A),a.signal&&(a.signal.aborted?A():a.signal.addEventListener("abort",A)));const K=D0e(a.url);if(K&&Zl.protocols.indexOf(K)===-1){n(new Ai("Unsupported protocol "+K+":",Ai.ERR_BAD_REQUEST,e));return}$.send(c||null)})},G0e=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const c=function(w){if(!a){a=!0,i();const A=w instanceof Error?w:this.reason;n.abort(A instanceof Ai?A:new T_(A instanceof Error?A.message:A))}};let f=t&&setTimeout(()=>{f=null,c(new Ai(`timeout ${t} of ms exceeded`,Ai.ETIMEDOUT))},t);const i=()=>{e&&(f&&clearTimeout(f),f=null,e.forEach(w=>{w.unsubscribe?w.unsubscribe(c):w.removeEventListener("abort",c)}),e=null)};e.forEach(w=>w.addEventListener("abort",c));const{signal:x}=n;return x.unsubscribe=()=>sr.asap(i),x}},W0e=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},H0e=async function*(e,t){for await(const r of K0e(e))yield*W0e(r,t)},K0e=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},z6=(e,t,r,n)=>{const a=H0e(e,t);let c=0,f,i=x=>{f||(f=!0,n&&n(x))};return new ReadableStream({async pull(x){try{const{done:w,value:A}=await a.next();if(w){i(),x.close();return}let P=A.byteLength;if(r){let E=c+=P;r(E)}x.enqueue(new Uint8Array(A))}catch(w){throw i(w),w}},cancel(x){return i(x),a.return()}},{highWaterMark:2})},VP=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",rY=VP&&typeof ReadableStream=="function",Z0e=VP&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),nY=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Y0e=rY&&nY(()=>{let e=!1;const t=new Request(Zl.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),F6=64*1024,SR=rY&&nY(()=>sr.isReadableStream(new Response("").body)),JA={stream:SR&&(e=>e.body)};VP&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!JA[t]&&(JA[t]=sr.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new Ai(`Response type '${t}' is not supported`,Ai.ERR_NOT_SUPPORT,n)})})})(new Response);const X0e=async e=>{if(e==null)return 0;if(sr.isBlob(e))return e.size;if(sr.isSpecCompliantForm(e))return(await new Request(Zl.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(sr.isArrayBufferView(e)||sr.isArrayBuffer(e))return e.byteLength;if(sr.isURLSearchParams(e)&&(e=e+""),sr.isString(e))return(await Z0e(e)).byteLength},J0e=async(e,t)=>{const r=sr.toFiniteNumber(e.getContentLength());return r??X0e(t)},Q0e=VP&&(async e=>{let{url:t,method:r,data:n,signal:a,cancelToken:c,timeout:f,onDownloadProgress:i,onUploadProgress:x,responseType:w,headers:A,withCredentials:P="same-origin",fetchOptions:E}=tY(e);w=w?(w+"").toLowerCase():"text";let D=G0e([a,c&&c.toAbortSignal()],f),V;const L=D&&D.unsubscribe&&(()=>{D.unsubscribe()});let $;try{if(x&&Y0e&&r!=="get"&&r!=="head"&&($=await J0e(A,n))!==0){let ee=new Request(t,{method:"POST",body:n,duplex:"half"}),se;if(sr.isFormData(n)&&(se=ee.headers.get("content-type"))&&A.setContentType(se),ee.body){const[ce,he]=I6($,XA(D6(x)));n=z6(ee.body,F6,ce,he)}}sr.isString(P)||(P=P?"include":"omit");const H="credentials"in Request.prototype;V=new Request(t,{...E,signal:D,method:r.toUpperCase(),headers:A.normalize().toJSON(),body:n,duplex:"half",credentials:H?P:void 0});let K=await fetch(V);const Q=SR&&(w==="stream"||w==="response");if(SR&&(i||Q&&L)){const ee={};["status","statusText","headers"].forEach(Pe=>{ee[Pe]=K[Pe]});const se=sr.toFiniteNumber(K.headers.get("content-length")),[ce,he]=i&&I6(se,XA(D6(i),!0))||[];K=new Response(z6(K.body,F6,ce,()=>{he&&he(),L&&L()}),ee)}w=w||"text";let ae=await JA[sr.findKey(JA,w)||"text"](K,e);return!Q&&L&&L(),await new Promise((ee,se)=>{QZ(ee,se,{data:ae,headers:Yc.from(K.headers),status:K.status,statusText:K.statusText,config:e,request:V})})}catch(H){throw L&&L(),H&&H.name==="TypeError"&&/fetch/i.test(H.message)?Object.assign(new Ai("Network Error",Ai.ERR_NETWORK,e,V),{cause:H.cause||H}):Ai.from(H,H&&H.code,e,V)}}),AR={http:p0e,xhr:q0e,fetch:Q0e};sr.forEach(AR,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const B6=e=>`- ${e}`,eve=e=>sr.isFunction(e)||e===null||e===!1,iY={getAdapter:e=>{e=sr.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let c=0;c<t;c++){r=e[c];let f;if(n=r,!eve(r)&&(n=AR[(f=String(r)).toLowerCase()],n===void 0))throw new Ai(`Unknown adapter '${f}'`);if(n)break;a[f||"#"+c]=n}if(!n){const c=Object.entries(a).map(([i,x])=>`adapter ${i} `+(x===!1?"is not supported by the environment":"is not available in the build"));let f=t?c.length>1?`since :
`+c.map(B6).join(`
`):" "+B6(c[0]):"as no adapter specified";throw new Ai("There is no suitable adapter to dispatch the request "+f,"ERR_NOT_SUPPORT")}return n},adapters:AR};function vC(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new T_(null,e)}function V6(e){return vC(e),e.headers=Yc.from(e.headers),e.data=yC.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),iY.getAdapter(e.adapter||Jw.adapter)(e).then(function(n){return vC(e),n.data=yC.call(e,e.transformResponse,n),n.headers=Yc.from(n.headers),n},function(n){return JZ(n)||(vC(e),n&&n.response&&(n.response.data=yC.call(e,e.transformResponse,n.response),n.response.headers=Yc.from(n.response.headers))),Promise.reject(n)})}const aY="1.8.2",UP={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{UP[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const U6={};UP.transitional=function(t,r,n){function a(c,f){return"[Axios v"+aY+"] Transitional option '"+c+"'"+f+(n?". "+n:"")}return(c,f,i)=>{if(t===!1)throw new Ai(a(f," has been removed"+(r?" in "+r:"")),Ai.ERR_DEPRECATED);return r&&!U6[f]&&(U6[f]=!0,console.warn(a(f," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(c,f,i):!0}};UP.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function tve(e,t,r){if(typeof e!="object")throw new Ai("options must be an object",Ai.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const c=n[a],f=t[c];if(f){const i=e[c],x=i===void 0||f(i,c,e);if(x!==!0)throw new Ai("option "+c+" must be "+x,Ai.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ai("Unknown option "+c,Ai.ERR_BAD_OPTION)}}const vA={assertOptions:tve,validators:UP},zf=vA.validators;let M0=class{constructor(t){this.defaults=t,this.interceptors={request:new O6,response:new O6}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const c=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?c&&!String(n.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+c):n.stack=c}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=U0(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:c}=r;n!==void 0&&vA.assertOptions(n,{silentJSONParsing:zf.transitional(zf.boolean),forcedJSONParsing:zf.transitional(zf.boolean),clarifyTimeoutError:zf.transitional(zf.boolean)},!1),a!=null&&(sr.isFunction(a)?r.paramsSerializer={serialize:a}:vA.assertOptions(a,{encode:zf.function,serialize:zf.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),vA.assertOptions(r,{baseUrl:zf.spelling("baseURL"),withXsrfToken:zf.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let f=c&&sr.merge(c.common,c[r.method]);c&&sr.forEach(["delete","get","head","post","put","patch","common"],V=>{delete c[V]}),r.headers=Yc.concat(f,c);const i=[];let x=!0;this.interceptors.request.forEach(function(L){typeof L.runWhen=="function"&&L.runWhen(r)===!1||(x=x&&L.synchronous,i.unshift(L.fulfilled,L.rejected))});const w=[];this.interceptors.response.forEach(function(L){w.push(L.fulfilled,L.rejected)});let A,P=0,E;if(!x){const V=[V6.bind(this),void 0];for(V.unshift.apply(V,i),V.push.apply(V,w),E=V.length,A=Promise.resolve(r);P<E;)A=A.then(V[P++],V[P++]);return A}E=i.length;let D=r;for(P=0;P<E;){const V=i[P++],L=i[P++];try{D=V(D)}catch($){L.call(this,$);break}}try{A=V6.call(this,D)}catch(V){return Promise.reject(V)}for(P=0,E=w.length;P<E;)A=A.then(w[P++],w[P++]);return A}getUri(t){t=U0(this.defaults,t);const r=eY(t.baseURL,t.url,t.allowAbsoluteUrls);return ZZ(r,t.params,t.paramsSerializer)}};sr.forEach(["delete","get","head","options"],function(t){M0.prototype[t]=function(r,n){return this.request(U0(n||{},{method:t,url:r,data:(n||{}).data}))}});sr.forEach(["post","put","patch"],function(t){function r(n){return function(c,f,i){return this.request(U0(i||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:c,data:f}))}}M0.prototype[t]=r(),M0.prototype[t+"Form"]=r(!0)});let rve=class sY{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(c){r=c});const n=this;this.promise.then(a=>{if(!n._listeners)return;let c=n._listeners.length;for(;c-- >0;)n._listeners[c](a);n._listeners=null}),this.promise.then=a=>{let c;const f=new Promise(i=>{n.subscribe(i),c=i}).then(a);return f.cancel=function(){n.unsubscribe(c)},f},t(function(c,f,i){n.reason||(n.reason=new T_(c,f,i),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new sY(function(a){t=a}),cancel:t}}};function nve(e){return function(r){return e.apply(null,r)}}function ive(e){return sr.isObject(e)&&e.isAxiosError===!0}const TR={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(TR).forEach(([e,t])=>{TR[t]=e});function oY(e){const t=new M0(e),r=zZ(M0.prototype.request,t);return sr.extend(r,M0.prototype,t,{allOwnKeys:!0}),sr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return oY(U0(e,a))},r}const lo=oY(Jw);lo.Axios=M0;lo.CanceledError=T_;lo.CancelToken=rve;lo.isCancel=JZ;lo.VERSION=aY;lo.toFormData=BP;lo.AxiosError=Ai;lo.Cancel=lo.CanceledError;lo.all=function(t){return Promise.all(t)};lo.spread=nve;lo.isAxiosError=ive;lo.mergeConfig=U0;lo.AxiosHeaders=Yc;lo.formToJSON=e=>XZ(sr.isHTMLForm(e)?new FormData(e):e);lo.getAdapter=iY.getAdapter;lo.HttpStatusCode=TR;lo.default=lo;const{Axios:QUe,AxiosError:e$e,CanceledError:t$e,isCancel:r$e,CancelToken:n$e,VERSION:i$e,all:a$e,Cancel:s$e,isAxiosError:o$e,spread:l$e,toFormData:c$e,AxiosHeaders:u$e,HttpStatusCode:d$e,formToJSON:h$e,getAdapter:f$e,mergeConfig:p$e}=lo,ave="https://ltodatamanager.com/api",xn=lo.create({baseURL:ave});xn.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=t),e},e=>Promise.reject(e));xn.interceptors.response.use(e=>e,e=>{var t,r,n;return((t=e.response)==null?void 0:t.status)===401&&((n=(r=e.config)==null?void 0:r.url)!=null&&n.includes("/auth/login")||(localStorage.removeItem("token"),localStorage.removeItem("userData"))),Promise.reject(e)});class t1 extends Error{}t1.prototype.name="InvalidTokenError";function sve(e){return decodeURIComponent(atob(e).replace(/(.)/g,(t,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function ove(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return sve(t)}catch{return atob(t)}}function LS(e,t){if(typeof e!="string")throw new t1("Invalid token specified: must be a string");t||(t={});const r=t.header===!0?0:1,n=e.split(".")[r];if(typeof n!="string")throw new t1(`Invalid token specified: missing part #${r+1}`);let a;try{a=ove(n)}catch(c){throw new t1(`Invalid token specified: invalid base64 for part #${r+1} (${c.message})`)}try{return JSON.parse(a)}catch(c){throw new t1(`Invalid token specified: invalid json for part #${r+1} (${c.message})`)}}var LD="Dialog",[lY,cY]=Vd(LD),[lve,Qh]=lY(LD),uY=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:c,modal:f=!0}=e,i=W.useRef(null),x=W.useRef(null),[w=!1,A]=Kg({prop:n,defaultProp:a,onChange:c});return l.jsx(lve,{scope:t,triggerRef:i,contentRef:x,contentId:Rd(),titleId:Rd(),descriptionId:Rd(),open:w,onOpenChange:A,onOpenToggle:W.useCallback(()=>A(P=>!P),[A]),modal:f,children:r})};uY.displayName=LD;var dY="DialogTrigger",hY=W.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Qh(dY,r),c=Ji(t,a.triggerRef);return l.jsx(vi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":BD(a.open),...n,ref:c,onClick:ln(e.onClick,a.onOpenToggle)})});hY.displayName=dY;var zD="DialogPortal",[cve,fY]=lY(zD,{forceMount:void 0}),pY=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,c=Qh(zD,t);return l.jsx(cve,{scope:t,forceMount:r,children:W.Children.map(n,f=>l.jsx(Vu,{present:r||c.open,children:l.jsx(w_,{asChild:!0,container:a,children:f})}))})};pY.displayName=zD;var QA="DialogOverlay",mY=W.forwardRef((e,t)=>{const r=fY(QA,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,c=Qh(QA,e.__scopeDialog);return c.modal?l.jsx(Vu,{present:n||c.open,children:l.jsx(uve,{...a,ref:t})}):null});mY.displayName=QA;var uve=W.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Qh(QA,r);return l.jsx(Ww,{as:Ql,allowPinchZoom:!0,shards:[a.contentRef],children:l.jsx(vi.div,{"data-state":BD(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),$0="DialogContent",gY=W.forwardRef((e,t)=>{const r=fY($0,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,c=Qh($0,e.__scopeDialog);return l.jsx(Vu,{present:n||c.open,children:c.modal?l.jsx(dve,{...a,ref:t}):l.jsx(hve,{...a,ref:t})})});gY.displayName=$0;var dve=W.forwardRef((e,t)=>{const r=Qh($0,e.__scopeDialog),n=W.useRef(null),a=Ji(t,r.contentRef,n);return W.useEffect(()=>{const c=n.current;if(c)return jP(c)},[]),l.jsx(yY,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ln(e.onCloseAutoFocus,c=>{var f;c.preventDefault(),(f=r.triggerRef.current)==null||f.focus()}),onPointerDownOutside:ln(e.onPointerDownOutside,c=>{const f=c.detail.originalEvent,i=f.button===0&&f.ctrlKey===!0;(f.button===2||i)&&c.preventDefault()}),onFocusOutside:ln(e.onFocusOutside,c=>c.preventDefault())})}),hve=W.forwardRef((e,t)=>{const r=Qh($0,e.__scopeDialog),n=W.useRef(!1),a=W.useRef(!1);return l.jsx(yY,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,c),c.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),c.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:c=>{var x,w;(x=e.onInteractOutside)==null||x.call(e,c),c.defaultPrevented||(n.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=c.target;((w=r.triggerRef.current)==null?void 0:w.contains(f))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),yY=W.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:c,...f}=e,i=Qh($0,r),x=W.useRef(null),w=Ji(t,x);return _P(),l.jsxs(l.Fragment,{children:[l.jsx($w,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:c,children:l.jsx(x_,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":BD(i.open),...f,ref:w,onDismiss:()=>i.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(pve,{titleId:i.titleId}),l.jsx(gve,{contentRef:x,descriptionId:i.descriptionId})]})]})}),FD="DialogTitle",vY=W.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Qh(FD,r);return l.jsx(vi.h2,{id:a.titleId,...n,ref:t})});vY.displayName=FD;var xY="DialogDescription",_Y=W.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Qh(xY,r);return l.jsx(vi.p,{id:a.descriptionId,...n,ref:t})});_Y.displayName=xY;var bY="DialogClose",wY=W.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Qh(bY,r);return l.jsx(vi.button,{type:"button",...n,ref:t,onClick:ln(e.onClick,()=>a.onOpenChange(!1))})});wY.displayName=bY;function BD(e){return e?"open":"closed"}var SY="DialogTitleWarning",[fve,AY]=Bde(SY,{contentName:$0,titleName:FD,docsSlug:"dialog"}),pve=({titleId:e})=>{const t=AY(SY),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return W.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},mve="DialogDescriptionWarning",gve=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${AY(mve).contentName}}.`;return W.useEffect(()=>{var c;const a=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},VD=uY,yve=hY,UD=pY,Qw=mY,e2=gY,t2=vY,r2=_Y,$P=wY;const hs=VD,vve=UD,TY=W.forwardRef(({className:e,...t},r)=>l.jsx(Qw,{ref:r,className:Ut("fixed inset-0 z-50 bg-black data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));TY.displayName=Qw.displayName;const Xa=W.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(vve,{children:[l.jsx(TY,{}),l.jsxs(e2,{ref:n,className:Ut("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",e),onPointerDownOutside:a=>a.preventDefault(),onEscapeKeyDown:a=>a.preventDefault(),...r,children:[t,l.jsxs($P,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100",children:[l.jsx(Qf,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Xa.displayName=e2.displayName;const fs=({className:e,...t})=>l.jsx("div",{className:Ut("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});fs.displayName="DialogHeader";const jl=({className:e,...t})=>l.jsx("div",{className:Ut("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});jl.displayName="DialogFooter";const ps=W.forwardRef(({className:e,...t},r)=>l.jsx(t2,{ref:r,className:Ut("text-lg font-semibold leading-none tracking-tight",e),...t}));ps.displayName=t2.displayName;const bo=W.forwardRef(({className:e,...t},r)=>l.jsx(r2,{ref:r,className:Ut("text-sm text-muted-foreground",e),...t}));bo.displayName=r2.displayName;const xve=({isOpen:e,onClose:t,onSuccess:r,userEmail:n})=>{const[a,c]=W.useState(""),[f,i]=W.useState(!1),[x,w]=W.useState(300),[A,P]=W.useState(!1);W.useEffect(()=>{if(x>0&&e){const L=setTimeout(()=>w(x-1),1e3);return()=>clearTimeout(L)}else x===0&&P(!0)},[x,e]),W.useEffect(()=>{e&&(w(300),P(!1),c(""))},[e]);const E=async L=>{var $,H;if(L.preventDefault(),!a||a.length!==6){Mn.error("Please enter a valid 6-digit OTP");return}i(!0);try{const K=await xn.post("/auth/verify-otp",{email:n,otp:a});K.data.success?(Mn.success("OTP verified successfully!"),r(K.data.token)):Mn.error(K.data.message||"OTP verification failed")}catch(K){const Q=((H=($=K.response)==null?void 0:$.data)==null?void 0:H.message)||"OTP verification failed";Mn.error(Q)}finally{i(!1)}},D=async()=>{i(!0);try{Mn.info("Please login again to receive a new OTP"),t()}catch{Mn.error("Failed to resend OTP")}finally{i(!1)}},V=L=>{const $=Math.floor(L/60),H=L%60;return`${$}:${H.toString().padStart(2,"0")}`};return l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"sm:max-w-md",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(Px,{className:"h-5 w-5 text-blue-600"}),"OTP Verification Required"]}),l.jsx(bo,{children:"Please enter the 6-digit OTP sent to your email address to complete the login process."})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg",children:[l.jsx(Uw,{className:"h-4 w-4 text-blue-600"}),l.jsxs("span",{className:"text-sm text-blue-800",children:["OTP sent to: ",l.jsx("strong",{children:n})]})]}),l.jsxs("form",{onSubmit:E,className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ls,{htmlFor:"otp",children:"Enter OTP"}),l.jsx(kn,{id:"otp",type:"text",placeholder:"000000",value:a,onChange:L=>c(L.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest",disabled:f})]}),l.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[l.jsxs("span",{children:["Time remaining: ",V(x)]}),A&&l.jsx(Nr,{type:"button",variant:"link",size:"sm",onClick:D,disabled:f,className:"p-0 h-auto",children:"Resend OTP"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:t,disabled:f,className:"flex-1",children:"Cancel"}),l.jsx(Nr,{type:"submit",disabled:f||a.length!==6,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:f?l.jsxs(l.Fragment,{children:[l.jsx(_c,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify OTP"})]})]})]})]})})},PY=W.createContext(),_ve=({children:e})=>{const[t,r]=W.useState(null),[n,a]=W.useState(null),[c,f]=W.useState(!1),[i,x]=W.useState(!0),[w,A]=W.useState(!1),P=wa(),E=W.useRef(!1),D=ae=>ae.exp*1e3<Date.now();W.useEffect(()=>{(()=>{try{const ee=localStorage.getItem("token"),se=localStorage.getItem("userData"),ce=se?JSON.parse(se):null;if(ee)try{const he=LS(ee);D(he)?(localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1)):(r(ee),a(ce),f(!0))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1)}else r(null),a(null),f(!1)}catch(ee){console.error("Auth initialization error:",ee),r(null),a(null),f(!1)}finally{x(!1)}})()},[]);const V=ae=>{const ee=LS(ae);if(D(ee)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1);return}const se={userId:ee.userId,role:ee.role,email:ee.email,isPasswordChange:ee.isPasswordChange,isOtpVerified:ee.isOtpVerified};localStorage.setItem("token",ae),localStorage.setItem("userData",JSON.stringify(se)),r(ae),a(se),f(!0)},L=ae=>{const ee=LS(ae);if(D(ee)){localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1);return}const se={userId:ee.userId,role:ee.role,email:ee.email,isPasswordChange:ee.isPasswordChange,isOtpVerified:ee.isOtpVerified};localStorage.setItem("token",ae),localStorage.setItem("userData",JSON.stringify(se)),r(ae),a(se),f(!0)};W.useEffect(()=>{c&&(n!=null&&n.role)&&n.role!=="0"&&n.isOtpVerified===!1?A(!0):A(!1)},[c,n]);const $=ae=>{L(ae),setTimeout(()=>{E.current||(E.current=!0,P("/"),setTimeout(()=>{E.current=!1},100))},100)},H=()=>{A(!1),K()},K=async()=>{try{await xn.post("/auth/logout")}catch(ae){console.error("Logout API call failed:",ae)}finally{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1),E.current||(E.current=!0,P("/login"),setTimeout(()=>{E.current=!1},100))}};if(W.useEffect(()=>{if(c&&t)try{const ee=LS(t).exp*1e3-Date.now();if(ee>0){const se=setTimeout(()=>{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1),E.current||(E.current=!0,P("/login"),setTimeout(()=>{E.current=!1},100))},ee);return()=>clearTimeout(se)}else localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1),E.current||(E.current=!0,P("/login"),setTimeout(()=>{E.current=!1},100))}catch{localStorage.removeItem("token"),localStorage.removeItem("userData"),r(null),a(null),f(!1)}},[t]),i)return l.jsx("div",{className:"h-screen flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const Q={token:t,isAuthenticated:c,login:V,logout:K,updateToken:L,userData:n,setUserData:a};return l.jsxs(PY.Provider,{value:Q,children:[e,l.jsx(xve,{isOpen:w,onClose:H,onSuccess:$,userEmail:n==null?void 0:n.email})]})},Di=()=>{const e=W.useContext(PY);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},G1="/assets/lto_logo-DG4ICtLK.png";function bve({className:e,...t}){const[r,n]=W.useState(!1),[a,c]=W.useState(!1),[f,i]=W.useState(null),[x,w]=W.useState(!1),{login:A,isAuthenticated:P}=Di(),E=wa(),D=()=>{n(!r)},V=Cl({resolver:tc(wye),defaultValues:{email:localStorage.getItem("rememberedEmail")||"",password:""}});W.useEffect(()=>{const $=localStorage.getItem("rememberedEmail");$&&(w(!0),V.setValue("email",$))},[V]);const L=async $=>{var H,K;try{c(!0),i(null),x?localStorage.setItem("rememberedEmail",$.email):localStorage.removeItem("rememberedEmail");const{data:Q}=await xn.post("/auth/login",$);if(Q){if(c(!1),Q.requiresOTP){Mn.success(`OTP has been sent to ${Q.email}. Please check your email.`),Q.token&&A(Q.token);return}Q.token&&(A(Q.token),E("/"))}}catch(Q){console.error("Login error:",Q),V.clearErrors(),(((K=(H=Q.response)==null?void 0:H.data)==null?void 0:K.message)==="Password is incorrect"?"0":"1")==="0"?V.setError("password",{type:"manual",message:"Password is incorrect"}):V.setError("email",{type:"manual",message:"Email or license number is incorrect"}),c(!1)}};return l.jsx("div",{className:Ut("w-full max-w-md",e),...t,children:l.jsx("div",{className:"bg-white text-gray-900 rounded-lg shadow-lg p-8",children:l.jsx(ip,{...V,children:l.jsx("form",{onSubmit:$=>{$.preventDefault(),V.handleSubmit(L)($)},children:l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsx("div",{className:"flex justify-center mb-3",children:l.jsx("img",{src:G1,alt:"LTO Logo",className:"h-28 w-28"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h1",{className:"text-4xl font-bold text-[#1e3a8a] mb-1",children:"LTO SYSTEM"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Land Transportation Management System"})]}),l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsx(En,{control:V.control,name:"email",render:({field:$})=>l.jsxs(jn,{children:[l.jsx(Nn,{children:l.jsxs("div",{className:"relative",children:[l.jsx(Du,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),l.jsx(kn,{...$,type:"text",placeholder:"EMAIL",autoComplete:"current-email",className:Ut("pl-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",V.formState.errors.email&&"border-red-500")})]})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:V.control,name:"password",render:({field:$})=>l.jsxs(jn,{children:[l.jsx(Nn,{children:l.jsxs("div",{className:"relative",children:[l.jsx(aR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),l.jsx(kn,{...$,type:r?"text":"password",placeholder:"PASSWORD",autoComplete:"current-password",className:Ut("pl-10 pr-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",V.formState.errors.password&&"border-red-500")}),l.jsx(Nr,{type:"button",size:"icon",variant:"ghost",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 hover:bg-transparent",onClick:D,"aria-label":r?"Hide Password":"Show Password",children:r?l.jsx(kA,{className:"text-gray-400 h-4 w-4"}):l.jsx(CA,{className:"text-gray-400 h-4 w-4"})})]})}),l.jsx(Cn,{})]})})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(nZ,{id:"remember",checked:x,onCheckedChange:w,className:"border-gray-300 data-[state=checked]:bg-[#1e3a8a] data-[state=checked]:border-[#1e3a8a]"}),l.jsx("label",{htmlFor:"remember",className:"text-sm text-gray-600",children:"Remember Username"})]}),l.jsx("button",{type:"button",onClick:()=>E("/forgot-password"),className:"text-sm text-[#1e3a8a] hover:underline",children:"Forgot Password"})]}),l.jsx(Nr,{type:"submit",disabled:a,className:"w-full h-12 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold rounded-md",children:a?l.jsx(_c,{className:"w-5 h-5 text-white mx-auto animate-spin"}):"LOGIN"})]})},"login-form")})})})}const wve="/assets/bg_tools-srshAVJ8.jpg",Sve="/assets/lto_mid_logo_white_small-ea2yHhYW.png",Ave=()=>l.jsxs("div",{className:"min-h-screen relative",children:[l.jsx("div",{className:"bg-[#1e3a8a] h-16 flex items-center justify-between px-6 relative z-10",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("img",{src:"/lto.svg",alt:"LTO Logo",className:"h-8 w-8"}),l.jsx("span",{className:"text-white text-lg font-semibold",children:"LTO SYSTEM"})]})}),l.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${wve})`},children:l.jsx("div",{className:"absolute inset-0 bg-[#1e3a8a]/30"})}),l.jsx("div",{className:"relative z-10 flex items-center justify-center min-h-[calc(100vh-4rem)] p-6",children:l.jsx(bve,{})}),l.jsx("div",{className:"absolute bottom-6 right-6 z-10",children:l.jsx("img",{src:Sve,alt:"MID Logo",className:"h-16 w-auto object-contain opacity-70"})})]}),NY=W.createContext({});function Tve(e){const t=W.useRef(null);return t.current===null&&(t.current=e()),t.current}const $D=typeof window<"u",Pve=$D?W.useLayoutEffect:W.useEffect,qD=W.createContext(null),jY=W.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function Nve(e=!0){const t=W.useContext(qD);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:a}=t,c=W.useId();W.useEffect(()=>{if(e)return a(c)},[e]);const f=W.useCallback(()=>e&&n&&n(c),[c,n,e]);return!r&&n?[!1,f]:[!0]}function GD(e,t){e.indexOf(t)===-1&&e.push(t)}function WD(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Ru=e=>e;let CY=Ru;const jve={useManualTiming:!1};function HD(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ex=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class KD{constructor(){this.subscriptions=[]}add(t){return GD(this.subscriptions,t),()=>WD(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let c=0;c<a;c++){const f=this.subscriptions[c];f&&f(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const fm=e=>e*1e3,pm=e=>e/1e3;function kY(e,t){return t?e*(1e3/t):0}const Cve=HD(()=>window.ScrollTimeline!==void 0);class kve{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=r}attachTimeline(t,r){const n=this.animations.map(a=>{if(Cve()&&a.attachTimeline)return a.attachTimeline(t);if(typeof r=="function")return r(a)});return()=>{n.forEach((a,c)=>{a&&a(),this.animations[c].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class Eve extends kve{then(t,r){return Promise.all(this.animations).then(t).catch(r)}}function ZD(e,t){return e?e[t]||e.default||e:void 0}const PR=2e4;function EY(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<PR;)t+=r,n=e.next(t);return t>=PR?1/0:t}function YD(e){return typeof e=="function"}function $6(e,t){e.timeline=t,e.onfinish=null}const XD=e=>Array.isArray(e)&&typeof e[0]=="number",Mve={linearEasing:void 0};function Ove(e,t){const r=HD(e);return()=>{var n;return(n=Mve[t])!==null&&n!==void 0?n:r()}}const eT=Ove(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),MY=(e,t,r=10)=>{let n="";const a=Math.max(Math.round(t/r),2);for(let c=0;c<a;c++)n+=e(Ex(0,a-1,c))+", ";return`linear(${n.substring(0,n.length-2)})`};function OY(e){return!!(typeof e=="function"&&eT()||!e||typeof e=="string"&&(e in NR||eT())||XD(e)||Array.isArray(e)&&e.every(OY))}const r1=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,NR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:r1([0,.65,.55,1]),circOut:r1([.55,0,1,.45]),backIn:r1([.31,.01,.66,-.59]),backOut:r1([.33,1.53,.69,.99])};function RY(e,t){if(e)return typeof e=="function"&&eT()?MY(e,t):XD(e)?r1(e):Array.isArray(e)?e.map(r=>RY(r,t)||NR.easeOut):NR[e]}const zS=["read","resolveKeyframes","update","preRender","render","postRender"],q6={value:null};function Rve(e,t){let r=new Set,n=new Set,a=!1,c=!1;const f=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1},x=0;function w(P){f.has(P)&&(A.schedule(P),e()),x++,P(i)}const A={schedule:(P,E=!1,D=!1)=>{const L=D&&a?r:n;return E&&f.add(P),L.has(P)||L.add(P),P},cancel:P=>{n.delete(P),f.delete(P)},process:P=>{if(i=P,a){c=!0;return}a=!0,[r,n]=[n,r],r.forEach(w),t&&q6.value&&q6.value.frameloop[t].push(x),x=0,r.clear(),a=!1,c&&(c=!1,A.process(P))}};return A}const Ive=40;function IY(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},c=()=>r=!0,f=zS.reduce((H,K)=>(H[K]=Rve(c,t?K:void 0),H),{}),{read:i,resolveKeyframes:x,update:w,preRender:A,render:P,postRender:E}=f,D=()=>{const H=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(H-a.timestamp,Ive),1),a.timestamp=H,a.isProcessing=!0,i.process(a),x.process(a),w.process(a),A.process(a),P.process(a),E.process(a),a.isProcessing=!1,r&&t&&(n=!1,e(D))},V=()=>{r=!0,n=!0,a.isProcessing||e(D)};return{schedule:zS.reduce((H,K)=>{const Q=f[K];return H[K]=(ae,ee=!1,se=!1)=>(r||V(),Q.schedule(ae,ee,se)),H},{}),cancel:H=>{for(let K=0;K<zS.length;K++)f[zS[K]].cancel(H)},state:a,steps:f}}const{schedule:Ja,cancel:ry,state:Nl,steps:xC}=IY(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ru,!0),{schedule:JD}=IY(queueMicrotask,!1);let xA;function Dve(){xA=void 0}const Kf={now:()=>(xA===void 0&&Kf.set(Nl.isProcessing||jve.useManualTiming?Nl.timestamp:performance.now()),xA),set:e=>{xA=e,queueMicrotask(Dve)}},Oh={x:!1,y:!1};function DY(){return Oh.x||Oh.y}function Lve(e){return e==="x"||e==="y"?Oh[e]?null:(Oh[e]=!0,()=>{Oh[e]=!1}):Oh.x||Oh.y?null:(Oh.x=Oh.y=!0,()=>{Oh.x=Oh.y=!1})}function zve(e,t,r){var n;if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const c=(n=void 0)!==null&&n!==void 0?n:a.querySelectorAll(e);return c?Array.from(c):[]}return Array.from(e)}function LY(e,t){const r=zve(e),n=new AbortController,a={passive:!0,...t,signal:n.signal};return[r,a,()=>n.abort()]}function G6(e){return!(e.pointerType==="touch"||DY())}function Fve(e,t,r={}){const[n,a,c]=LY(e,r),f=i=>{if(!G6(i))return;const{target:x}=i,w=t(x,i);if(typeof w!="function"||!x)return;const A=P=>{G6(P)&&(w(P),x.removeEventListener("pointerleave",A))};x.addEventListener("pointerleave",A,a)};return n.forEach(i=>{i.addEventListener("pointerenter",f,a)}),c}function W6(e,t){const r=`${t}PointerCapture`;if(e.target instanceof Element&&r in e.target&&e.pointerId!==void 0)try{e.target[r](e.pointerId)}catch{}}const zY=(e,t)=>t?e===t?!0:zY(e,t.parentElement):!1,QD=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Bve=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Vve(e){return Bve.has(e.tagName)||e.tabIndex!==-1}const n1=new WeakSet;function H6(e){return t=>{t.key==="Enter"&&e(t)}}function _C(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Uve=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=H6(()=>{if(n1.has(r))return;_C(r,"down");const a=H6(()=>{_C(r,"up")}),c=()=>_C(r,"cancel");r.addEventListener("keyup",a,t),r.addEventListener("blur",c,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function K6(e){return QD(e)&&!DY()}function $ve(e,t,r={}){const[n,a,c]=LY(e,r),f=i=>{const x=i.currentTarget;if(!x||!K6(i)||n1.has(x))return;n1.add(x),W6(i,"set");const w=t(x,i),A=(D,V)=>{x.removeEventListener("pointerup",P),x.removeEventListener("pointercancel",E),W6(D,"release"),!(!K6(D)||!n1.has(x))&&(n1.delete(x),typeof w=="function"&&w(D,{success:V}))},P=D=>{(D.isTrusted?qve(D,x instanceof Element?x.getBoundingClientRect():{left:0,top:0,right:window.innerWidth,bottom:window.innerHeight}):!1)?A(D,!1):A(D,!(x instanceof Element)||zY(x,D.target))},E=D=>{A(D,!1)};x.addEventListener("pointerup",P,a),x.addEventListener("pointercancel",E,a),x.addEventListener("lostpointercapture",E,a)};return n.forEach(i=>{i=r.useGlobalTarget?window:i;let x=!1;i instanceof HTMLElement&&(x=!0,!Vve(i)&&i.getAttribute("tabindex")===null&&(i.tabIndex=0)),i.addEventListener("pointerdown",f,a),x&&i.addEventListener("focus",w=>Uve(w,a),a)}),c}function qve(e,t){return e.clientX<t.left||e.clientX>t.right||e.clientY<t.top||e.clientY>t.bottom}const Z6=30,Gve=e=>!isNaN(parseFloat(e));class Wve{constructor(t,r={}){this.version="12.5.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,a=!0)=>{const c=Kf.now();this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Kf.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Gve(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new KD);const n=this.events[t].add(r);return t==="change"?()=>{n(),Ja.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Kf.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Z6)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Z6);return kY(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function W1(e,t){return new Wve(e,t)}const FY=W.createContext({strict:!1}),Y6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Mx={};for(const e in Y6)Mx[e]={isEnabled:t=>Y6[e].some(r=>!!t[r])};function Hve(e){for(const t in e)Mx[t]={...Mx[t],...e[t]}}const Kve=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function tT(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Kve.has(e)}let BY=e=>!tT(e);function Zve(e){e&&(BY=t=>t.startsWith("on")?!tT(t):e(t))}try{Zve(require("@emotion/is-prop-valid").default)}catch{}function Yve(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(BY(a)||r===!0&&tT(a)||!t&&!tT(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function Xve(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,a)=>a==="create"?e:(t.has(a)||t.set(a,e(a)),t.get(a))})}const qP=W.createContext({});function GP(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function H1(e){return typeof e=="string"||Array.isArray(e)}const eL=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],tL=["initial",...eL];function WP(e){return GP(e.animate)||tL.some(t=>H1(e[t]))}function VY(e){return!!(WP(e)||e.variants)}function Jve(e,t){if(WP(e)){const{initial:r,animate:n}=e;return{initial:r===!1||H1(r)?r:void 0,animate:H1(n)?n:void 0}}return e.inherit!==!1?t:{}}function Qve(e){const{initial:t,animate:r}=Jve(e,W.useContext(qP));return W.useMemo(()=>({initial:t,animate:r}),[X6(t),X6(r)])}function X6(e){return Array.isArray(e)?e.join(" "):e}const exe=Symbol.for("motionComponentSymbol");function lx(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function txe(e,t,r){return W.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):lx(r)&&(r.current=n))},[t])}const rL=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),rxe="framerAppearId",UY="data-"+rL(rxe),$Y=W.createContext({});function nxe(e,t,r,n,a){var c,f;const{visualElement:i}=W.useContext(qP),x=W.useContext(FY),w=W.useContext(qD),A=W.useContext(jY).reducedMotion,P=W.useRef(null);n=n||x.renderer,!P.current&&n&&(P.current=n(e,{visualState:t,parent:i,props:r,presenceContext:w,blockInitialAnimation:w?w.initial===!1:!1,reducedMotionConfig:A}));const E=P.current,D=W.useContext($Y);E&&!E.projection&&a&&(E.type==="html"||E.type==="svg")&&ixe(P.current,r,a,D);const V=W.useRef(!1);W.useInsertionEffect(()=>{E&&V.current&&E.update(r,w)});const L=r[UY],$=W.useRef(!!L&&!(!((c=window.MotionHandoffIsComplete)===null||c===void 0)&&c.call(window,L))&&((f=window.MotionHasOptimisedAnimation)===null||f===void 0?void 0:f.call(window,L)));return Pve(()=>{E&&(V.current=!0,window.MotionIsMounted=!0,E.updateFeatures(),JD.render(E.render),$.current&&E.animationState&&E.animationState.animateChanges())}),W.useEffect(()=>{E&&(!$.current&&E.animationState&&E.animationState.animateChanges(),$.current&&(queueMicrotask(()=>{var H;(H=window.MotionHandoffMarkAsComplete)===null||H===void 0||H.call(window,L)}),$.current=!1))}),E}function ixe(e,t,r,n){const{layoutId:a,layout:c,drag:f,dragConstraints:i,layoutScroll:x,layoutRoot:w}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:qY(e.parent)),e.projection.setOptions({layoutId:a,layout:c,alwaysMeasureLayout:!!f||i&&lx(i),visualElement:e,animationType:typeof c=="string"?c:"both",initialPromotionConfig:n,layoutScroll:x,layoutRoot:w})}function qY(e){if(e)return e.options.allowProjection!==!1?e.projection:qY(e.parent)}function axe({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){var c,f;e&&Hve(e);function i(w,A){let P;const E={...W.useContext(jY),...w,layoutId:sxe(w)},{isStatic:D}=E,V=Qve(w),L=n(w,D);if(!D&&$D){oxe();const $=lxe(E);P=$.MeasureLayout,V.visualElement=nxe(a,L,E,t,$.ProjectionNode)}return l.jsxs(qP.Provider,{value:V,children:[P&&V.visualElement?l.jsx(P,{visualElement:V.visualElement,...E}):null,r(a,w,txe(L,V.visualElement,A),L,D,V.visualElement)]})}i.displayName=`motion.${typeof a=="string"?a:`create(${(f=(c=a.displayName)!==null&&c!==void 0?c:a.name)!==null&&f!==void 0?f:""})`}`;const x=W.forwardRef(i);return x[exe]=a,x}function sxe({layoutId:e}){const t=W.useContext(NY).id;return t&&e!==void 0?t+"-"+e:e}function oxe(e,t){W.useContext(FY).strict}function lxe(e){const{drag:t,layout:r}=Mx;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const GY=e=>t=>typeof t=="string"&&t.startsWith(e),nL=GY("--"),cxe=GY("var(--"),iL=e=>cxe(e)?uxe.test(e.split("/*")[0].trim()):!1,uxe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,K1={};function dxe(e){for(const t in e)K1[t]=e[t],nL(t)&&(K1[t].isCSSVariable=!0)}const P_=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],tv=new Set(P_);function WY(e,{layout:t,layoutId:r}){return tv.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!K1[e]||e==="opacity")}const Yl=e=>!!(e&&e.getVelocity),HY=(e,t)=>t&&typeof e=="number"?t.transform(e):e,wm=(e,t,r)=>r>t?t:r<e?e:r,N_={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Z1={...N_,transform:e=>wm(0,1,e)},FS={...N_,default:1},n2=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Og=n2("deg"),Zf=n2("%"),ni=n2("px"),hxe=n2("vh"),fxe=n2("vw"),J6={...Zf,parse:e=>Zf.parse(e)/100,transform:e=>Zf.transform(e*100)},pxe={borderWidth:ni,borderTopWidth:ni,borderRightWidth:ni,borderBottomWidth:ni,borderLeftWidth:ni,borderRadius:ni,radius:ni,borderTopLeftRadius:ni,borderTopRightRadius:ni,borderBottomRightRadius:ni,borderBottomLeftRadius:ni,width:ni,maxWidth:ni,height:ni,maxHeight:ni,top:ni,right:ni,bottom:ni,left:ni,padding:ni,paddingTop:ni,paddingRight:ni,paddingBottom:ni,paddingLeft:ni,margin:ni,marginTop:ni,marginRight:ni,marginBottom:ni,marginLeft:ni,backgroundPositionX:ni,backgroundPositionY:ni},mxe={rotate:Og,rotateX:Og,rotateY:Og,rotateZ:Og,scale:FS,scaleX:FS,scaleY:FS,scaleZ:FS,skew:Og,skewX:Og,skewY:Og,distance:ni,translateX:ni,translateY:ni,translateZ:ni,x:ni,y:ni,z:ni,perspective:ni,transformPerspective:ni,opacity:Z1,originX:J6,originY:J6,originZ:ni},Q6={...N_,transform:Math.round},aL={...pxe,...mxe,zIndex:Q6,size:ni,fillOpacity:Z1,strokeOpacity:Z1,numOctaves:Q6},gxe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},yxe=P_.length;function vxe(e,t,r){let n="",a=!0;for(let c=0;c<yxe;c++){const f=P_[c],i=e[f];if(i===void 0)continue;let x=!0;if(typeof i=="number"?x=i===(f.startsWith("scale")?1:0):x=parseFloat(i)===0,!x||r){const w=HY(i,aL[f]);if(!x){a=!1;const A=gxe[f]||f;n+=`${A}(${w}) `}r&&(t[f]=w)}}return n=n.trim(),r?n=r(t,a?"":n):a&&(n="none"),n}function sL(e,t,r){const{style:n,vars:a,transformOrigin:c}=e;let f=!1,i=!1;for(const x in t){const w=t[x];if(tv.has(x)){f=!0;continue}else if(nL(x)){a[x]=w;continue}else{const A=HY(w,aL[x]);x.startsWith("origin")?(i=!0,c[x]=A):n[x]=A}}if(t.transform||(f||r?n.transform=vxe(t,e.transform,r):n.transform&&(n.transform="none")),i){const{originX:x="50%",originY:w="50%",originZ:A=0}=c;n.transformOrigin=`${x} ${w} ${A}`}}const oL=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function KY(e,t,r){for(const n in t)!Yl(t[n])&&!WY(n,r)&&(e[n]=t[n])}function xxe({transformTemplate:e},t){return W.useMemo(()=>{const r=oL();return sL(r,t,e),Object.assign({},r.vars,r.style)},[t])}function _xe(e,t){const r=e.style||{},n={};return KY(n,r,e),Object.assign(n,xxe(e,t)),n}function bxe(e,t){const r={},n=_xe(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const wxe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function lL(e){return typeof e!="string"||e.includes("-")?!1:!!(wxe.indexOf(e)>-1||/[A-Z]/u.test(e))}const Sxe={offset:"stroke-dashoffset",array:"stroke-dasharray"},Axe={offset:"strokeDashoffset",array:"strokeDasharray"};function Txe(e,t,r=1,n=0,a=!0){e.pathLength=1;const c=a?Sxe:Axe;e[c.offset]=ni.transform(-n);const f=ni.transform(t),i=ni.transform(r);e[c.array]=`${f} ${i}`}function eV(e,t,r){return typeof e=="string"?e:ni.transform(t+r*e)}function Pxe(e,t,r){const n=eV(t,e.x,e.width),a=eV(r,e.y,e.height);return`${n} ${a}`}function cL(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:c,pathLength:f,pathSpacing:i=1,pathOffset:x=0,...w},A,P){if(sL(e,w,P),A){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:E,style:D,dimensions:V}=e;E.transform&&(V&&(D.transform=E.transform),delete E.transform),V&&(a!==void 0||c!==void 0||D.transform)&&(D.transformOrigin=Pxe(V,a!==void 0?a:.5,c!==void 0?c:.5)),t!==void 0&&(E.x=t),r!==void 0&&(E.y=r),n!==void 0&&(E.scale=n),f!==void 0&&Txe(E,f,i,x,!1)}const ZY=()=>({...oL(),attrs:{}}),uL=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Nxe(e,t,r,n){const a=W.useMemo(()=>{const c=ZY();return cL(c,t,uL(n),e.transformTemplate),{...c.attrs,style:{...c.style}}},[t]);if(e.style){const c={};KY(c,e.style,e),a.style={...c,...a.style}}return a}function jxe(e=!1){return(r,n,a,{latestValues:c},f)=>{const x=(lL(r)?Nxe:bxe)(n,c,f,r),w=Yve(n,typeof r=="string",e),A=r!==W.Fragment?{...w,...x,ref:a}:{},{children:P}=n,E=W.useMemo(()=>Yl(P)?P.get():P,[P]);return W.createElement(r,{...A,children:E})}}function tV(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function dL(e,t,r,n){if(typeof t=="function"){const[a,c]=tV(n);t=t(r!==void 0?r:e.custom,a,c)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,c]=tV(n);t=t(r!==void 0?r:e.custom,a,c)}return t}const jR=e=>Array.isArray(e),Cxe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),kxe=e=>jR(e)?e[e.length-1]||0:e;function _A(e){const t=Yl(e)?e.get():e;return Cxe(t)?t.toValue():t}function Exe({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:r},n,a,c){const f={latestValues:Mxe(n,a,c,e),renderState:t()};return r&&(f.onMount=i=>r({props:n,current:i,...f}),f.onUpdate=i=>r(i)),f}const YY=e=>(t,r)=>{const n=W.useContext(qP),a=W.useContext(qD),c=()=>Exe(e,t,n,a);return r?c():Tve(c)};function Mxe(e,t,r,n){const a={},c=n(e,{});for(const E in c)a[E]=_A(c[E]);let{initial:f,animate:i}=e;const x=WP(e),w=VY(e);t&&w&&!x&&e.inherit!==!1&&(f===void 0&&(f=t.initial),i===void 0&&(i=t.animate));let A=r?r.initial===!1:!1;A=A||f===!1;const P=A?i:f;if(P&&typeof P!="boolean"&&!GP(P)){const E=Array.isArray(P)?P:[P];for(let D=0;D<E.length;D++){const V=dL(e,E[D]);if(V){const{transitionEnd:L,transition:$,...H}=V;for(const K in H){let Q=H[K];if(Array.isArray(Q)){const ae=A?Q.length-1:0;Q=Q[ae]}Q!==null&&(a[K]=Q)}for(const K in L)a[K]=L[K]}}}return a}function hL(e,t,r){var n;const{style:a}=e,c={};for(const f in a)(Yl(a[f])||t.style&&Yl(t.style[f])||WY(f,e)||((n=r==null?void 0:r.getValue(f))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(c[f]=a[f]);return c}const Oxe={useVisualState:YY({scrapeMotionValuesFromProps:hL,createRenderState:oL})};function XY(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function JY(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const c in r)e.style.setProperty(c,r[c])}const QY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function eX(e,t,r,n){JY(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(QY.has(a)?a:rL(a),t.attrs[a])}function tX(e,t,r){const n=hL(e,t,r);for(const a in e)if(Yl(e[a])||Yl(t[a])){const c=P_.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[c]=e[a]}return n}const rV=["x","y","width","height","cx","cy","r"],Rxe={useVisualState:YY({scrapeMotionValuesFromProps:tX,createRenderState:ZY,onUpdate:({props:e,prevProps:t,current:r,renderState:n,latestValues:a})=>{if(!r)return;let c=!!e.drag;if(!c){for(const i in a)if(tv.has(i)){c=!0;break}}if(!c)return;let f=!t;if(t)for(let i=0;i<rV.length;i++){const x=rV[i];e[x]!==t[x]&&(f=!0)}f&&Ja.read(()=>{XY(r,n),Ja.render(()=>{cL(n,a,uL(r.tagName),e.transformTemplate),eX(r,n)})})}})};function Ixe(e,t){return function(n,{forwardMotionProps:a}={forwardMotionProps:!1}){const f={...lL(n)?Rxe:Oxe,preloadedFeatures:e,useRender:jxe(a),createVisualElement:t,Component:n};return axe(f)}}function Y1(e,t,r){const n=e.getProps();return dL(n,t,r!==void 0?r:n.custom,e)}const rX=new Set(["width","height","top","left","right","bottom",...P_]);function Dxe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,W1(r))}function Lxe(e,t){const r=Y1(e,t);let{transitionEnd:n={},transition:a={},...c}=r||{};c={...c,...n};for(const f in c){const i=kxe(c[f]);Dxe(e,f,i)}}function zxe(e){return!!(Yl(e)&&e.add)}function CR(e,t){const r=e.getValue("willChange");if(zxe(r))return r.add(t)}function nX(e){return e.props[UY]}const iX=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Fxe=1e-7,Bxe=12;function Vxe(e,t,r,n,a){let c,f,i=0;do f=t+(r-t)/2,c=iX(f,n,a)-e,c>0?r=f:t=f;while(Math.abs(c)>Fxe&&++i<Bxe);return f}function i2(e,t,r,n){if(e===t&&r===n)return Ru;const a=c=>Vxe(c,0,1,e,r);return c=>c===0||c===1?c:iX(a(c),t,n)}const aX=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,sX=e=>t=>1-e(1-t),oX=i2(.33,1.53,.69,.99),fL=sX(oX),lX=aX(fL),cX=e=>(e*=2)<1?.5*fL(e):.5*(2-Math.pow(2,-10*(e-1))),pL=e=>1-Math.sin(Math.acos(e)),uX=sX(pL),dX=aX(pL),hX=e=>/^0[^.\s]+$/u.test(e);function Uxe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||hX(e):!0}const u1=e=>Math.round(e*1e5)/1e5,mL=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function $xe(e){return e==null}const qxe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,gL=(e,t)=>r=>!!(typeof r=="string"&&qxe.test(r)&&r.startsWith(e)||t&&!$xe(r)&&Object.prototype.hasOwnProperty.call(r,t)),fX=(e,t,r)=>n=>{if(typeof n!="string")return n;const[a,c,f,i]=n.match(mL);return{[e]:parseFloat(a),[t]:parseFloat(c),[r]:parseFloat(f),alpha:i!==void 0?parseFloat(i):1}},Gxe=e=>wm(0,255,e),bC={...N_,transform:e=>Math.round(Gxe(e))},A0={test:gL("rgb","red"),parse:fX("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+bC.transform(e)+", "+bC.transform(t)+", "+bC.transform(r)+", "+u1(Z1.transform(n))+")"};function Wxe(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const kR={test:gL("#"),parse:Wxe,transform:A0.transform},cx={test:gL("hsl","hue"),parse:fX("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Zf.transform(u1(t))+", "+Zf.transform(u1(r))+", "+u1(Z1.transform(n))+")"},Wl={test:e=>A0.test(e)||kR.test(e)||cx.test(e),parse:e=>A0.test(e)?A0.parse(e):cx.test(e)?cx.parse(e):kR.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?A0.transform(e):cx.transform(e)},Hxe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Kxe(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(mL))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(Hxe))===null||r===void 0?void 0:r.length)||0)>0}const pX="number",mX="color",Zxe="var",Yxe="var(",nV="${}",Xxe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function X1(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},a=[];let c=0;const i=t.replace(Xxe,x=>(Wl.test(x)?(n.color.push(c),a.push(mX),r.push(Wl.parse(x))):x.startsWith(Yxe)?(n.var.push(c),a.push(Zxe),r.push(x)):(n.number.push(c),a.push(pX),r.push(parseFloat(x))),++c,nV)).split(nV);return{values:r,split:i,indexes:n,types:a}}function gX(e){return X1(e).values}function yX(e){const{split:t,types:r}=X1(e),n=t.length;return a=>{let c="";for(let f=0;f<n;f++)if(c+=t[f],a[f]!==void 0){const i=r[f];i===pX?c+=u1(a[f]):i===mX?c+=Wl.transform(a[f]):c+=a[f]}return c}}const Jxe=e=>typeof e=="number"?0:e;function Qxe(e){const t=gX(e);return yX(e)(t.map(Jxe))}const ny={test:Kxe,parse:gX,createTransformer:yX,getAnimatableNone:Qxe},e_e=new Set(["brightness","contrast","saturate","opacity"]);function t_e(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(mL)||[];if(!n)return e;const a=r.replace(n,"");let c=e_e.has(t)?1:0;return n!==r&&(c*=100),t+"("+c+a+")"}const r_e=/\b([a-z-]*)\(.*?\)/gu,ER={...ny,getAnimatableNone:e=>{const t=e.match(r_e);return t?t.map(t_e).join(" "):e}},n_e={...aL,color:Wl,backgroundColor:Wl,outlineColor:Wl,fill:Wl,stroke:Wl,borderColor:Wl,borderTopColor:Wl,borderRightColor:Wl,borderBottomColor:Wl,borderLeftColor:Wl,filter:ER,WebkitFilter:ER},vX=e=>n_e[e];function xX(e,t){let r=vX(e);return r!==ER&&(r=ny),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const i_e=new Set(["auto","none","0"]);function a_e(e,t,r){let n=0,a;for(;n<e.length&&!a;){const c=e[n];typeof c=="string"&&!i_e.has(c)&&X1(c).values.length&&(a=e[n]),n++}if(a&&r)for(const c of t)e[c]=xX(r,a)}const T0=e=>e*180/Math.PI,MR=e=>{const t=T0(Math.atan2(e[1],e[0]));return OR(t)},s_e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:MR,rotateZ:MR,skewX:e=>T0(Math.atan(e[1])),skewY:e=>T0(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},OR=e=>(e=e%360,e<0&&(e+=360),e),iV=MR,aV=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),sV=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),o_e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:aV,scaleY:sV,scale:e=>(aV(e)+sV(e))/2,rotateX:e=>OR(T0(Math.atan2(e[6],e[5]))),rotateY:e=>OR(T0(Math.atan2(-e[2],e[0]))),rotateZ:iV,rotate:iV,skewX:e=>T0(Math.atan(e[4])),skewY:e=>T0(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function oV(e){return e.includes("scale")?1:0}function RR(e,t){if(!e||e==="none")return oV(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(r)n=o_e,a=r;else{const i=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=s_e,a=i}if(!a)return oV(t);const c=n[t],f=a[1].split(",").map(c_e);return typeof c=="function"?c(f):f[c]}const l_e=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return RR(r,t)};function c_e(e){return parseFloat(e.trim())}const lV=e=>e===N_||e===ni,u_e=new Set(["x","y","z"]),d_e=P_.filter(e=>!u_e.has(e));function h_e(e){const t=[];return d_e.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Ox={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>RR(t,"x"),y:(e,{transform:t})=>RR(t,"y")};Ox.translateX=Ox.x;Ox.translateY=Ox.y;const O0=new Set;let IR=!1,DR=!1;function _X(){if(DR){const e=Array.from(O0).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const a=h_e(n);a.length&&(r.set(n,a),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const a=r.get(n);a&&a.forEach(([c,f])=>{var i;(i=n.getValue(c))===null||i===void 0||i.set(f)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}DR=!1,IR=!1,O0.forEach(e=>e.complete()),O0.clear()}function bX(){O0.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(DR=!0)})}function f_e(){bX(),_X()}class yL{constructor(t,r,n,a,c,f=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=a,this.element=c,this.isAsync=f}scheduleResolve(){this.isScheduled=!0,this.isAsync?(O0.add(this),IR||(IR=!0,Ja.read(bX),Ja.resolveKeyframes(_X))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:a}=this;for(let c=0;c<t.length;c++)if(t[c]===null)if(c===0){const f=a==null?void 0:a.get(),i=t[t.length-1];if(f!==void 0)t[0]=f;else if(n&&r){const x=n.readValue(r,i);x!=null&&(t[0]=x)}t[0]===void 0&&(t[0]=i),a&&f===void 0&&a.set(t[0])}else t[c]=t[c-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),O0.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,O0.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const wX=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),p_e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function m_e(e){const t=p_e.exec(e);if(!t)return[,];const[,r,n,a]=t;return[`--${r??n}`,a]}function SX(e,t,r=1){const[n,a]=m_e(e);if(!n)return;const c=window.getComputedStyle(t).getPropertyValue(n);if(c){const f=c.trim();return wX(f)?parseFloat(f):f}return iL(a)?SX(a,t,r+1):a}const AX=e=>t=>t.test(e),g_e={test:e=>e==="auto",parse:e=>e},TX=[N_,ni,Zf,Og,fxe,hxe,g_e],cV=e=>TX.find(AX(e));class PX extends yL{constructor(t,r,n,a,c){super(t,r,n,a,c,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let x=0;x<t.length;x++){let w=t[x];if(typeof w=="string"&&(w=w.trim(),iL(w))){const A=SX(w,r.current);A!==void 0&&(t[x]=A),x===t.length-1&&(this.finalKeyframe=w)}}if(this.resolveNoneKeyframes(),!rX.has(n)||t.length!==2)return;const[a,c]=t,f=cV(a),i=cV(c);if(f!==i)if(lV(f)&&lV(i))for(let x=0;x<t.length;x++){const w=t[x];typeof w=="string"&&(t[x]=parseFloat(w))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let a=0;a<t.length;a++)Uxe(t[a])&&n.push(a);n.length&&a_e(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ox[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(n,a).jump(a,!1)}measureEndState(){var t;const{element:r,name:n,unresolvedKeyframes:a}=this;if(!r||!r.current)return;const c=r.getValue(n);c&&c.jump(this.measuredOrigin,!1);const f=a.length-1,i=a[f];a[f]=Ox[n](r.measureViewportBox(),window.getComputedStyle(r.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([x,w])=>{r.getValue(x).set(w)}),this.resolveNoneKeyframes()}}const uV=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ny.test(e)||e==="0")&&!e.startsWith("url("));function y_e(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function v_e(e,t,r,n){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const c=e[e.length-1],f=uV(a,t),i=uV(c,t);return!f||!i?!1:y_e(e)||(r==="spring"||YD(r))&&n}const x_e=e=>e!==null;function HP(e,{repeat:t,repeatType:r="loop"},n){const a=e.filter(x_e),c=t&&r!=="loop"&&t%2===1?0:a.length-1;return!c||n===void 0?a[c]:n}const __e=40;class NX{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:a=0,repeatDelay:c=0,repeatType:f="loop",...i}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Kf.now(),this.options={autoplay:t,delay:r,type:n,repeat:a,repeatDelay:c,repeatType:f,...i},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>__e?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&f_e(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=Kf.now(),this.hasAttemptedResolve=!0;const{name:n,type:a,velocity:c,delay:f,onComplete:i,onUpdate:x,isGenerator:w}=this.options;if(!w&&!v_e(t,n,a,c))if(f)this.options.duration=0;else{x&&x(HP(t,this.options,r)),i&&i(),this.resolveFinishedPromise();return}const A=this.initPlayback(t,r);A!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...A},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const zs=(e,t,r)=>e+(t-e)*r;function wC(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function b_e({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,c=0,f=0;if(!t)a=c=f=r;else{const i=r<.5?r*(1+t):r+t-r*t,x=2*r-i;a=wC(x,i,e+1/3),c=wC(x,i,e),f=wC(x,i,e-1/3)}return{red:Math.round(a*255),green:Math.round(c*255),blue:Math.round(f*255),alpha:n}}function rT(e,t){return r=>r>0?t:e}const SC=(e,t,r)=>{const n=e*e,a=r*(t*t-n)+n;return a<0?0:Math.sqrt(a)},w_e=[kR,A0,cx],S_e=e=>w_e.find(t=>t.test(e));function dV(e){const t=S_e(e);if(!t)return!1;let r=t.parse(e);return t===cx&&(r=b_e(r)),r}const hV=(e,t)=>{const r=dV(e),n=dV(t);if(!r||!n)return rT(e,t);const a={...r};return c=>(a.red=SC(r.red,n.red,c),a.green=SC(r.green,n.green,c),a.blue=SC(r.blue,n.blue,c),a.alpha=zs(r.alpha,n.alpha,c),A0.transform(a))},A_e=(e,t)=>r=>t(e(r)),a2=(...e)=>e.reduce(A_e),LR=new Set(["none","hidden"]);function T_e(e,t){return LR.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function P_e(e,t){return r=>zs(e,t,r)}function vL(e){return typeof e=="number"?P_e:typeof e=="string"?iL(e)?rT:Wl.test(e)?hV:C_e:Array.isArray(e)?jX:typeof e=="object"?Wl.test(e)?hV:N_e:rT}function jX(e,t){const r=[...e],n=r.length,a=e.map((c,f)=>vL(c)(c,t[f]));return c=>{for(let f=0;f<n;f++)r[f]=a[f](c);return r}}function N_e(e,t){const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=vL(e[a])(e[a],t[a]));return a=>{for(const c in n)r[c]=n[c](a);return r}}function j_e(e,t){var r;const n=[],a={color:0,var:0,number:0};for(let c=0;c<t.values.length;c++){const f=t.types[c],i=e.indexes[f][a[f]],x=(r=e.values[i])!==null&&r!==void 0?r:0;n[c]=x,a[f]++}return n}const C_e=(e,t)=>{const r=ny.createTransformer(t),n=X1(e),a=X1(t);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?LR.has(e)&&!a.values.length||LR.has(t)&&!n.values.length?T_e(e,t):a2(jX(j_e(n,a),a.values),r):rT(e,t)};function CX(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?zs(e,t,r):vL(e)(e,t)}const k_e=5;function kX(e,t,r){const n=Math.max(t-k_e,0);return kY(r-e(n),t-n)}const Gs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},fV=.001;function E_e({duration:e=Gs.duration,bounce:t=Gs.bounce,velocity:r=Gs.velocity,mass:n=Gs.mass}){let a,c,f=1-t;f=wm(Gs.minDamping,Gs.maxDamping,f),e=wm(Gs.minDuration,Gs.maxDuration,pm(e)),f<1?(a=w=>{const A=w*f,P=A*e,E=A-r,D=zR(w,f),V=Math.exp(-P);return fV-E/D*V},c=w=>{const P=w*f*e,E=P*r+r,D=Math.pow(f,2)*Math.pow(w,2)*e,V=Math.exp(-P),L=zR(Math.pow(w,2),f);return(-a(w)+fV>0?-1:1)*((E-D)*V)/L}):(a=w=>{const A=Math.exp(-w*e),P=(w-r)*e+1;return-.001+A*P},c=w=>{const A=Math.exp(-w*e),P=(r-w)*(e*e);return A*P});const i=5/e,x=O_e(a,c,i);if(e=fm(e),isNaN(x))return{stiffness:Gs.stiffness,damping:Gs.damping,duration:e};{const w=Math.pow(x,2)*n;return{stiffness:w,damping:f*2*Math.sqrt(n*w),duration:e}}}const M_e=12;function O_e(e,t,r){let n=r;for(let a=1;a<M_e;a++)n=n-e(n)/t(n);return n}function zR(e,t){return e*Math.sqrt(1-t*t)}const R_e=["duration","bounce"],I_e=["stiffness","damping","mass"];function pV(e,t){return t.some(r=>e[r]!==void 0)}function D_e(e){let t={velocity:Gs.velocity,stiffness:Gs.stiffness,damping:Gs.damping,mass:Gs.mass,isResolvedFromDuration:!1,...e};if(!pV(e,I_e)&&pV(e,R_e))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),a=n*n,c=2*wm(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:Gs.mass,stiffness:a,damping:c}}else{const r=E_e(e);t={...t,...r,mass:Gs.mass},t.isResolvedFromDuration=!0}return t}function EX(e=Gs.visualDuration,t=Gs.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:a}=r;const c=r.keyframes[0],f=r.keyframes[r.keyframes.length-1],i={done:!1,value:c},{stiffness:x,damping:w,mass:A,duration:P,velocity:E,isResolvedFromDuration:D}=D_e({...r,velocity:-pm(r.velocity||0)}),V=E||0,L=w/(2*Math.sqrt(x*A)),$=f-c,H=pm(Math.sqrt(x/A)),K=Math.abs($)<5;n||(n=K?Gs.restSpeed.granular:Gs.restSpeed.default),a||(a=K?Gs.restDelta.granular:Gs.restDelta.default);let Q;if(L<1){const ee=zR(H,L);Q=se=>{const ce=Math.exp(-L*H*se);return f-ce*((V+L*H*$)/ee*Math.sin(ee*se)+$*Math.cos(ee*se))}}else if(L===1)Q=ee=>f-Math.exp(-H*ee)*($+(V+H*$)*ee);else{const ee=H*Math.sqrt(L*L-1);Q=se=>{const ce=Math.exp(-L*H*se),he=Math.min(ee*se,300);return f-ce*((V+L*H*$)*Math.sinh(he)+ee*$*Math.cosh(he))/ee}}const ae={calculatedDuration:D&&P||null,next:ee=>{const se=Q(ee);if(D)i.done=ee>=P;else{let ce=0;L<1&&(ce=ee===0?fm(V):kX(Q,ee,se));const he=Math.abs(ce)<=n,Pe=Math.abs(f-se)<=a;i.done=he&&Pe}return i.value=i.done?f:se,i},toString:()=>{const ee=Math.min(EY(ae),PR),se=MY(ce=>ae.next(ee*ce).value,ee,30);return ee+"ms "+se}};return ae}function mV({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:c=500,modifyTarget:f,min:i,max:x,restDelta:w=.5,restSpeed:A}){const P=e[0],E={done:!1,value:P},D=he=>i!==void 0&&he<i||x!==void 0&&he>x,V=he=>i===void 0?x:x===void 0||Math.abs(i-he)<Math.abs(x-he)?i:x;let L=r*t;const $=P+L,H=f===void 0?$:f($);H!==$&&(L=H-P);const K=he=>-L*Math.exp(-he/n),Q=he=>H+K(he),ae=he=>{const Pe=K(he),Ne=Q(he);E.done=Math.abs(Pe)<=w,E.value=E.done?H:Ne};let ee,se;const ce=he=>{D(E.value)&&(ee=he,se=EX({keyframes:[E.value,V(E.value)],velocity:kX(Q,he,E.value),damping:a,stiffness:c,restDelta:w,restSpeed:A}))};return ce(0),{calculatedDuration:null,next:he=>{let Pe=!1;return!se&&ee===void 0&&(Pe=!0,ae(he),ce(he)),ee!==void 0&&he>=ee?se.next(he-ee):(!Pe&&ae(he),E)}}}const L_e=i2(.42,0,1,1),z_e=i2(0,0,.58,1),MX=i2(.42,0,.58,1),F_e=e=>Array.isArray(e)&&typeof e[0]!="number",B_e={linear:Ru,easeIn:L_e,easeInOut:MX,easeOut:z_e,circIn:pL,circInOut:dX,circOut:uX,backIn:fL,backInOut:lX,backOut:oX,anticipate:cX},gV=e=>{if(XD(e)){CY(e.length===4);const[t,r,n,a]=e;return i2(t,r,n,a)}else if(typeof e=="string")return B_e[e];return e};function V_e(e,t,r){const n=[],a=r||CX,c=e.length-1;for(let f=0;f<c;f++){let i=a(e[f],e[f+1]);if(t){const x=Array.isArray(t)?t[f]||Ru:t;i=a2(x,i)}n.push(i)}return n}function U_e(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const c=e.length;if(CY(c===t.length),c===1)return()=>t[0];if(c===2&&t[0]===t[1])return()=>t[1];const f=e[0]===e[1];e[0]>e[c-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=V_e(t,n,a),x=i.length,w=A=>{if(f&&A<e[0])return t[0];let P=0;if(x>1)for(;P<e.length-2&&!(A<e[P+1]);P++);const E=Ex(e[P],e[P+1],A);return i[P](E)};return r?A=>w(wm(e[0],e[c-1],A)):w}function $_e(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Ex(0,t,n);e.push(zs(r,1,a))}}function q_e(e){const t=[0];return $_e(t,e.length-1),t}function G_e(e,t){return e.map(r=>r*t)}function W_e(e,t){return e.map(()=>t||MX).splice(0,e.length-1)}function nT({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=F_e(n)?n.map(gV):gV(n),c={done:!1,value:t[0]},f=G_e(r&&r.length===t.length?r:q_e(t),e),i=U_e(f,t,{ease:Array.isArray(a)?a:W_e(t,a)});return{calculatedDuration:e,next:x=>(c.value=i(x),c.done=x>=e,c)}}const H_e=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Ja.update(t,!0),stop:()=>ry(t),now:()=>Nl.isProcessing?Nl.timestamp:Kf.now()}},K_e={decay:mV,inertia:mV,tween:nT,keyframes:nT,spring:EX},Z_e=e=>e/100;class xL extends NX{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:x}=this.options;x&&x()};const{name:r,motionValue:n,element:a,keyframes:c}=this.options,f=(a==null?void 0:a.KeyframeResolver)||yL,i=(x,w)=>this.onKeyframesResolved(x,w);this.resolver=new f(c,i,r,n,a),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:c,velocity:f=0}=this.options,i=YD(r)?r:K_e[r]||nT;let x,w;i!==nT&&typeof t[0]!="number"&&(x=a2(Z_e,CX(t[0],t[1])),t=[0,100]);const A=i({...this.options,keyframes:t});c==="mirror"&&(w=i({...this.options,keyframes:[...t].reverse(),velocity:-f})),A.calculatedDuration===null&&(A.calculatedDuration=EY(A));const{calculatedDuration:P}=A,E=P+a,D=E*(n+1)-a;return{generator:A,mirroredGenerator:w,mapPercentToKeyframes:x,calculatedDuration:P,resolvedDuration:E,totalDuration:D}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:n}=this;if(!n){const{keyframes:he}=this.options;return{done:!0,value:he[he.length-1]}}const{finalKeyframe:a,generator:c,mirroredGenerator:f,mapPercentToKeyframes:i,keyframes:x,calculatedDuration:w,totalDuration:A,resolvedDuration:P}=n;if(this.startTime===null)return c.next(0);const{delay:E,repeat:D,repeatType:V,repeatDelay:L,onUpdate:$}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-A/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const H=this.currentTime-E*(this.speed>=0?1:-1),K=this.speed>=0?H<0:H>A;this.currentTime=Math.max(H,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=A);let Q=this.currentTime,ae=c;if(D){const he=Math.min(this.currentTime,A)/P;let Pe=Math.floor(he),Ne=he%1;!Ne&&he>=1&&(Ne=1),Ne===1&&Pe--,Pe=Math.min(Pe,D+1),!!(Pe%2)&&(V==="reverse"?(Ne=1-Ne,L&&(Ne-=L/P)):V==="mirror"&&(ae=f)),Q=wm(0,1,Ne)*P}const ee=K?{done:!1,value:x[0]}:ae.next(Q);i&&(ee.value=i(ee.value));let{done:se}=ee;!K&&w!==null&&(se=this.speed>=0?this.currentTime>=A:this.currentTime<=0);const ce=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&se);return ce&&a!==void 0&&(ee.value=HP(x,this.options,a)),$&&$(ee.value),ce&&this.finish(),ee}get duration(){const{resolved:t}=this;return t?pm(t.calculatedDuration):0}get time(){return pm(this.currentTime)}set time(t){t=fm(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=pm(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=H_e,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(c=>this.tick(c))),r&&r();const a=this.driver.now();this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=a):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const Y_e=new Set(["opacity","clipPath","filter","transform"]);function X_e(e,t,r,{delay:n=0,duration:a=300,repeat:c=0,repeatType:f="loop",ease:i="easeInOut",times:x}={}){const w={[t]:r};x&&(w.offset=x);const A=RY(i,a);return Array.isArray(A)&&(w.easing=A),e.animate(w,{delay:n,duration:a,easing:Array.isArray(A)?"linear":A,fill:"both",iterations:c+1,direction:f==="reverse"?"alternate":"normal"})}const J_e=HD(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),iT=10,Q_e=2e4;function ebe(e){return YD(e.type)||e.type==="spring"||!OY(e.ease)}function tbe(e,t){const r=new xL({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:e[0]};const a=[];let c=0;for(;!n.done&&c<Q_e;)n=r.sample(c),a.push(n.value),c+=iT;return{times:void 0,keyframes:a,duration:c-iT,ease:"linear"}}const OX={anticipate:cX,backInOut:lX,circInOut:dX};function rbe(e){return e in OX}class yV extends NX{constructor(t){super(t);const{name:r,motionValue:n,element:a,keyframes:c}=this.options;this.resolver=new PX(c,(f,i)=>this.onKeyframesResolved(f,i),r,n,a),this.resolver.scheduleResolve()}initPlayback(t,r){let{duration:n=300,times:a,ease:c,type:f,motionValue:i,name:x,startTime:w}=this.options;if(!i.owner||!i.owner.current)return!1;if(typeof c=="string"&&eT()&&rbe(c)&&(c=OX[c]),ebe(this.options)){const{onComplete:P,onUpdate:E,motionValue:D,element:V,...L}=this.options,$=tbe(t,L);t=$.keyframes,t.length===1&&(t[1]=t[0]),n=$.duration,a=$.times,c=$.ease,f="keyframes"}const A=X_e(i.owner.current,x,t,{...this.options,duration:n,times:a,ease:c});return A.startTime=w??this.calcStartTime(),this.pendingTimeline?($6(A,this.pendingTimeline),this.pendingTimeline=void 0):A.onfinish=()=>{const{onComplete:P}=this.options;i.set(HP(t,this.options,r)),P&&P(),this.cancel(),this.resolveFinishedPromise()},{animation:A,duration:n,times:a,type:f,ease:c,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return pm(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return pm(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=fm(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return Ru;const{animation:n}=r;$6(n,t)}return Ru}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:n,duration:a,type:c,ease:f,times:i}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:w,onUpdate:A,onComplete:P,element:E,...D}=this.options,V=new xL({...D,keyframes:n,duration:a,type:c,ease:f,times:i,isGenerator:!0}),L=fm(this.time);w.setWithVelocity(V.sample(L-iT).value,V.sample(L).value,iT)}const{onStop:x}=this.options;x&&x(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:n,repeatDelay:a,repeatType:c,damping:f,type:i}=t;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:x,transformTemplate:w}=r.owner.getProps();return J_e()&&n&&Y_e.has(n)&&!x&&!w&&!a&&c!=="mirror"&&f!==0&&i!=="inertia"}}const nbe={type:"spring",stiffness:500,damping:25,restSpeed:10},ibe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),abe={type:"keyframes",duration:.8},sbe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},obe=(e,{keyframes:t})=>t.length>2?abe:tv.has(e)?e.startsWith("scale")?ibe(t[1]):nbe:sbe;function lbe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:c,repeatType:f,repeatDelay:i,from:x,elapsed:w,...A}){return!!Object.keys(A).length}const _L=(e,t,r,n={},a,c)=>f=>{const i=ZD(n,e)||{},x=i.delay||n.delay||0;let{elapsed:w=0}=n;w=w-fm(x);let A={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...i,delay:-w,onUpdate:E=>{t.set(E),i.onUpdate&&i.onUpdate(E)},onComplete:()=>{f(),i.onComplete&&i.onComplete()},name:e,motionValue:t,element:c?void 0:a};lbe(i)||(A={...A,...obe(e,A)}),A.duration&&(A.duration=fm(A.duration)),A.repeatDelay&&(A.repeatDelay=fm(A.repeatDelay)),A.from!==void 0&&(A.keyframes[0]=A.from);let P=!1;if((A.type===!1||A.duration===0&&!A.repeatDelay)&&(A.duration=0,A.delay===0&&(P=!0)),A.allowFlatten=!i.type&&!i.ease,P&&!c&&t.get()!==void 0){const E=HP(A.keyframes,i);if(E!==void 0)return Ja.update(()=>{A.onUpdate(E),A.onComplete()}),new Eve([])}return!c&&yV.supports(A)?new yV(A):new xL(A)};function cbe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function RX(e,t,{delay:r=0,transitionOverride:n,type:a}={}){var c;let{transition:f=e.getDefaultTransition(),transitionEnd:i,...x}=t;n&&(f=n);const w=[],A=a&&e.animationState&&e.animationState.getState()[a];for(const P in x){const E=e.getValue(P,(c=e.latestValues[P])!==null&&c!==void 0?c:null),D=x[P];if(D===void 0||A&&cbe(A,P))continue;const V={delay:r,...ZD(f||{},P)};let L=!1;if(window.MotionHandoffAnimation){const H=nX(e);if(H){const K=window.MotionHandoffAnimation(H,P,Ja);K!==null&&(V.startTime=K,L=!0)}}CR(e,P),E.start(_L(P,E,D,e.shouldReduceMotion&&rX.has(P)?{type:!1}:V,e,L));const $=E.animation;$&&w.push($)}return i&&Promise.all(w).then(()=>{Ja.update(()=>{i&&Lxe(e,i)})}),w}function FR(e,t,r={}){var n;const a=Y1(e,t,r.type==="exit"?(n=e.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:c=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(c=r.transitionOverride);const f=a?()=>Promise.all(RX(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(w=0)=>{const{delayChildren:A=0,staggerChildren:P,staggerDirection:E}=c;return ube(e,t,A+w,P,E,r)}:()=>Promise.resolve(),{when:x}=c;if(x){const[w,A]=x==="beforeChildren"?[f,i]:[i,f];return w().then(()=>A())}else return Promise.all([f(),i(r.delay)])}function ube(e,t,r=0,n=0,a=1,c){const f=[],i=(e.variantChildren.size-1)*n,x=a===1?(w=0)=>w*n:(w=0)=>i-w*n;return Array.from(e.variantChildren).sort(dbe).forEach((w,A)=>{w.notify("AnimationStart",t),f.push(FR(w,t,{...c,delay:r+x(A)}).then(()=>w.notify("AnimationComplete",t)))}),Promise.all(f)}function dbe(e,t){return e.sortNodePosition(t)}function hbe(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(c=>FR(e,c,r));n=Promise.all(a)}else if(typeof t=="string")n=FR(e,t,r);else{const a=typeof t=="function"?Y1(e,t,r.custom):t;n=Promise.all(RX(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function IX(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const fbe=tL.length;function DX(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?DX(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<fbe;r++){const n=tL[r],a=e.props[n];(H1(a)||a===!1)&&(t[n]=a)}return t}const pbe=[...eL].reverse(),mbe=eL.length;function gbe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>hbe(e,r,n)))}function ybe(e){let t=gbe(e),r=vV(),n=!0;const a=x=>(w,A)=>{var P;const E=Y1(e,A,x==="exit"?(P=e.presenceContext)===null||P===void 0?void 0:P.custom:void 0);if(E){const{transition:D,transitionEnd:V,...L}=E;w={...w,...L,...V}}return w};function c(x){t=x(e)}function f(x){const{props:w}=e,A=DX(e.parent)||{},P=[],E=new Set;let D={},V=1/0;for(let $=0;$<mbe;$++){const H=pbe[$],K=r[H],Q=w[H]!==void 0?w[H]:A[H],ae=H1(Q),ee=H===x?K.isActive:null;ee===!1&&(V=$);let se=Q===A[H]&&Q!==w[H]&&ae;if(se&&n&&e.manuallyAnimateOnMount&&(se=!1),K.protectedKeys={...D},!K.isActive&&ee===null||!Q&&!K.prevProp||GP(Q)||typeof Q=="boolean")continue;const ce=vbe(K.prevProp,Q);let he=ce||H===x&&K.isActive&&!se&&ae||$>V&&ae,Pe=!1;const Ne=Array.isArray(Q)?Q:[Q];let pe=Ne.reduce(a(H),{});ee===!1&&(pe={});const{prevResolvedValues:je={}}=K,xe={...je,...pe},Ce=Re=>{he=!0,E.has(Re)&&(Pe=!0,E.delete(Re)),K.needsAnimating[Re]=!0;const Fe=e.getValue(Re);Fe&&(Fe.liveStyle=!1)};for(const Re in xe){const Fe=pe[Re],He=je[Re];if(D.hasOwnProperty(Re))continue;let mt=!1;jR(Fe)&&jR(He)?mt=!IX(Fe,He):mt=Fe!==He,mt?Fe!=null?Ce(Re):E.add(Re):Fe!==void 0&&E.has(Re)?Ce(Re):K.protectedKeys[Re]=!0}K.prevProp=Q,K.prevResolvedValues=pe,K.isActive&&(D={...D,...pe}),n&&e.blockInitialAnimation&&(he=!1),he&&(!(se&&ce)||Pe)&&P.push(...Ne.map(Re=>({animation:Re,options:{type:H}})))}if(E.size){const $={};if(typeof w.initial!="boolean"){const H=Y1(e,Array.isArray(w.initial)?w.initial[0]:w.initial);H&&H.transition&&($.transition=H.transition)}E.forEach(H=>{const K=e.getBaseTarget(H),Q=e.getValue(H);Q&&(Q.liveStyle=!0),$[H]=K??null}),P.push({animation:$})}let L=!!P.length;return n&&(w.initial===!1||w.initial===w.animate)&&!e.manuallyAnimateOnMount&&(L=!1),n=!1,L?t(P):Promise.resolve()}function i(x,w){var A;if(r[x].isActive===w)return Promise.resolve();(A=e.variantChildren)===null||A===void 0||A.forEach(E=>{var D;return(D=E.animationState)===null||D===void 0?void 0:D.setActive(x,w)}),r[x].isActive=w;const P=f(x);for(const E in r)r[E].protectedKeys={};return P}return{animateChanges:f,setActive:i,setAnimateFunction:c,getState:()=>r,reset:()=>{r=vV(),n=!0}}}function vbe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!IX(t,e):!1}function d0(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function vV(){return{animate:d0(!0),whileInView:d0(),whileHover:d0(),whileTap:d0(),whileDrag:d0(),whileFocus:d0(),exit:d0()}}class cy{constructor(t){this.isMounted=!1,this.node=t}update(){}}class xbe extends cy{constructor(t){super(t),t.animationState||(t.animationState=ybe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();GP(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let _be=0;class bbe extends cy{constructor(){super(...arguments),this.id=_be++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const wbe={animation:{Feature:xbe},exit:{Feature:bbe}};function J1(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function s2(e){return{point:{x:e.pageX,y:e.pageY}}}const Sbe=e=>t=>QD(t)&&e(t,s2(t));function d1(e,t,r,n){return J1(e,t,Sbe(r),n)}function LX({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function Abe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Tbe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const zX=1e-4,Pbe=1-zX,Nbe=1+zX,FX=.01,jbe=0-FX,Cbe=0+FX;function yc(e){return e.max-e.min}function kbe(e,t,r){return Math.abs(e-t)<=r}function xV(e,t,r,n=.5){e.origin=n,e.originPoint=zs(t.min,t.max,e.origin),e.scale=yc(r)/yc(t),e.translate=zs(r.min,r.max,e.origin)-e.originPoint,(e.scale>=Pbe&&e.scale<=Nbe||isNaN(e.scale))&&(e.scale=1),(e.translate>=jbe&&e.translate<=Cbe||isNaN(e.translate))&&(e.translate=0)}function h1(e,t,r,n){xV(e.x,t.x,r.x,n?n.originX:void 0),xV(e.y,t.y,r.y,n?n.originY:void 0)}function _V(e,t,r){e.min=r.min+t.min,e.max=e.min+yc(t)}function Ebe(e,t,r){_V(e.x,t.x,r.x),_V(e.y,t.y,r.y)}function bV(e,t,r){e.min=t.min-r.min,e.max=e.min+yc(t)}function f1(e,t,r){bV(e.x,t.x,r.x),bV(e.y,t.y,r.y)}const wV=()=>({translate:0,scale:1,origin:0,originPoint:0}),ux=()=>({x:wV(),y:wV()}),SV=()=>({min:0,max:0}),no=()=>({x:SV(),y:SV()});function Pd(e){return[e("x"),e("y")]}function AC(e){return e===void 0||e===1}function BR({scale:e,scaleX:t,scaleY:r}){return!AC(e)||!AC(t)||!AC(r)}function m0(e){return BR(e)||BX(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function BX(e){return AV(e.x)||AV(e.y)}function AV(e){return e&&e!=="0%"}function aT(e,t,r){const n=e-r,a=t*n;return r+a}function TV(e,t,r,n,a){return a!==void 0&&(e=aT(e,a,n)),aT(e,r,n)+t}function VR(e,t=0,r=1,n,a){e.min=TV(e.min,t,r,n,a),e.max=TV(e.max,t,r,n,a)}function VX(e,{x:t,y:r}){VR(e.x,t.translate,t.scale,t.originPoint),VR(e.y,r.translate,r.scale,r.originPoint)}const PV=.999999999999,NV=1.0000000000001;function Mbe(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let c,f;for(let i=0;i<a;i++){c=r[i],f=c.projectionDelta;const{visualElement:x}=c.options;x&&x.props.style&&x.props.style.display==="contents"||(n&&c.options.layoutScroll&&c.scroll&&c!==c.root&&hx(e,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),f&&(t.x*=f.x.scale,t.y*=f.y.scale,VX(e,f)),n&&m0(c.latestValues)&&hx(e,c.latestValues))}t.x<NV&&t.x>PV&&(t.x=1),t.y<NV&&t.y>PV&&(t.y=1)}function dx(e,t){e.min=e.min+t,e.max=e.max+t}function jV(e,t,r,n,a=.5){const c=zs(e.min,e.max,a);VR(e,t,r,c,n)}function hx(e,t){jV(e.x,t.x,t.scaleX,t.scale,t.originX),jV(e.y,t.y,t.scaleY,t.scale,t.originY)}function UX(e,t){return LX(Tbe(e.getBoundingClientRect(),t))}function Obe(e,t,r){const n=UX(e,r),{scroll:a}=t;return a&&(dx(n.x,a.offset.x),dx(n.y,a.offset.y)),n}const $X=({current:e})=>e?e.ownerDocument.defaultView:null,CV=(e,t)=>Math.abs(e-t);function Rbe(e,t){const r=CV(e.x,t.x),n=CV(e.y,t.y);return Math.sqrt(r**2+n**2)}class qX{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:c=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=PC(this.lastMoveEventInfo,this.history),E=this.startEvent!==null,D=Rbe(P.offset,{x:0,y:0})>=3;if(!E&&!D)return;const{point:V}=P,{timestamp:L}=Nl;this.history.push({...V,timestamp:L});const{onStart:$,onMove:H}=this.handlers;E||($&&$(this.lastMoveEvent,P),this.startEvent=this.lastMoveEvent),H&&H(this.lastMoveEvent,P)},this.handlePointerMove=(P,E)=>{this.lastMoveEvent=P,this.lastMoveEventInfo=TC(E,this.transformPagePoint),Ja.update(this.updatePoint,!0)},this.handlePointerUp=(P,E)=>{this.end();const{onEnd:D,onSessionEnd:V,resumeAnimation:L}=this.handlers;if(this.dragSnapToOrigin&&L&&L(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const $=PC(P.type==="pointercancel"?this.lastMoveEventInfo:TC(E,this.transformPagePoint),this.history);this.startEvent&&D&&D(P,$),V&&V(P,$)},!QD(t))return;this.dragSnapToOrigin=c,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const f=s2(t),i=TC(f,this.transformPagePoint),{point:x}=i,{timestamp:w}=Nl;this.history=[{...x,timestamp:w}];const{onSessionStart:A}=r;A&&A(t,PC(i,this.history)),this.removeListeners=a2(d1(this.contextWindow,"pointermove",this.handlePointerMove),d1(this.contextWindow,"pointerup",this.handlePointerUp),d1(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ry(this.updatePoint)}}function TC(e,t){return t?{point:t(e.point)}:e}function kV(e,t){return{x:e.x-t.x,y:e.y-t.y}}function PC({point:e},t){return{point:e,delta:kV(e,GX(t)),offset:kV(e,Ibe(t)),velocity:Dbe(t,.1)}}function Ibe(e){return e[0]}function GX(e){return e[e.length-1]}function Dbe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=GX(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>fm(t)));)r--;if(!n)return{x:0,y:0};const c=pm(a.timestamp-n.timestamp);if(c===0)return{x:0,y:0};const f={x:(a.x-n.x)/c,y:(a.y-n.y)/c};return f.x===1/0&&(f.x=0),f.y===1/0&&(f.y=0),f}function Lbe(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?zs(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?zs(r,e,n.max):Math.min(e,r)),e}function EV(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function zbe(e,{top:t,left:r,bottom:n,right:a}){return{x:EV(e.x,r,a),y:EV(e.y,t,n)}}function MV(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Fbe(e,t){return{x:MV(e.x,t.x),y:MV(e.y,t.y)}}function Bbe(e,t){let r=.5;const n=yc(e),a=yc(t);return a>n?r=Ex(t.min,t.max-n,e.min):n>a&&(r=Ex(e.min,e.max-a,t.min)),wm(0,1,r)}function Vbe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const UR=.35;function Ube(e=UR){return e===!1?e=0:e===!0&&(e=UR),{x:OV(e,"left","right"),y:OV(e,"top","bottom")}}function OV(e,t,r){return{min:RV(e,t),max:RV(e,r)}}function RV(e,t){return typeof e=="number"?e:e[t]||0}const $be=new WeakMap;class qbe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=no(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=A=>{const{dragSnapToOrigin:P}=this.getProps();P?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(s2(A).point)},c=(A,P)=>{const{drag:E,dragPropagation:D,onDragStart:V}=this.getProps();if(E&&!D&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Lve(E),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Pd($=>{let H=this.getAxisMotionValue($).get()||0;if(Zf.test(H)){const{projection:K}=this.visualElement;if(K&&K.layout){const Q=K.layout.layoutBox[$];Q&&(H=yc(Q)*(parseFloat(H)/100))}}this.originPoint[$]=H}),V&&Ja.postRender(()=>V(A,P)),CR(this.visualElement,"transform");const{animationState:L}=this.visualElement;L&&L.setActive("whileDrag",!0)},f=(A,P)=>{const{dragPropagation:E,dragDirectionLock:D,onDirectionLock:V,onDrag:L}=this.getProps();if(!E&&!this.openDragLock)return;const{offset:$}=P;if(D&&this.currentDirection===null){this.currentDirection=Gbe($),this.currentDirection!==null&&V&&V(this.currentDirection);return}this.updateAxis("x",P.point,$),this.updateAxis("y",P.point,$),this.visualElement.render(),L&&L(A,P)},i=(A,P)=>this.stop(A,P),x=()=>Pd(A=>{var P;return this.getAnimationState(A)==="paused"&&((P=this.getAxisMotionValue(A).animation)===null||P===void 0?void 0:P.play())}),{dragSnapToOrigin:w}=this.getProps();this.panSession=new qX(t,{onSessionStart:a,onStart:c,onMove:f,onSessionEnd:i,resumeAnimation:x},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:w,contextWindow:$X(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:c}=this.getProps();c&&Ja.postRender(()=>c(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!BS(t,a,this.currentDirection))return;const c=this.getAxisMotionValue(t);let f=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(f=Lbe(f,this.constraints[t],this.elastic[t])),c.set(f)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,c=this.constraints;r&&lx(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=zbe(a.layoutBox,r):this.constraints=!1,this.elastic=Ube(n),c!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Pd(f=>{this.constraints!==!1&&this.getAxisMotionValue(f)&&(this.constraints[f]=Vbe(a.layoutBox[f],this.constraints[f]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!lx(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const c=Obe(n,a.root,this.visualElement.getTransformPagePoint());let f=Fbe(a.layout.layoutBox,c);if(r){const i=r(Abe(f));this.hasMutatedConstraints=!!i,i&&(f=LX(i))}return f}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:c,dragSnapToOrigin:f,onDragTransitionEnd:i}=this.getProps(),x=this.constraints||{},w=Pd(A=>{if(!BS(A,r,this.currentDirection))return;let P=x&&x[A]||{};f&&(P={min:0,max:0});const E=a?200:1e6,D=a?40:1e7,V={type:"inertia",velocity:n?t[A]:0,bounceStiffness:E,bounceDamping:D,timeConstant:750,restDelta:1,restSpeed:10,...c,...P};return this.startAxisValueAnimation(A,V)});return Promise.all(w).then(i)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return CR(this.visualElement,t),n.start(_L(t,n,0,r,this.visualElement,!1))}stopAnimation(){Pd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Pd(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Pd(r=>{const{drag:n}=this.getProps();if(!BS(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,c=this.getAxisMotionValue(r);if(a&&a.layout){const{min:f,max:i}=a.layout.layoutBox[r];c.set(t[r]-zs(f,i,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!lx(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Pd(f=>{const i=this.getAxisMotionValue(f);if(i&&this.constraints!==!1){const x=i.get();a[f]=Bbe({min:x,max:x},this.constraints[f])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Pd(f=>{if(!BS(f,t,null))return;const i=this.getAxisMotionValue(f),{min:x,max:w}=this.constraints[f];i.set(zs(x,w,a[f]))})}addListeners(){if(!this.visualElement.current)return;$be.set(this.visualElement,this);const t=this.visualElement.current,r=d1(t,"pointerdown",x=>{const{drag:w,dragListener:A=!0}=this.getProps();w&&A&&this.start(x)}),n=()=>{const{dragConstraints:x}=this.getProps();lx(x)&&x.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,c=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),Ja.read(n);const f=J1(window,"resize",()=>this.scalePositionWithinConstraints()),i=a.addEventListener("didUpdate",({delta:x,hasLayoutChanged:w})=>{this.isDragging&&w&&(Pd(A=>{const P=this.getAxisMotionValue(A);P&&(this.originPoint[A]+=x[A].translate,P.set(P.get()+x[A].translate))}),this.visualElement.render())});return()=>{f(),r(),c(),i&&i()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:c=!1,dragElastic:f=UR,dragMomentum:i=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:c,dragElastic:f,dragMomentum:i}}}function BS(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Gbe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Wbe extends cy{constructor(t){super(t),this.removeGroupControls=Ru,this.removeListeners=Ru,this.controls=new qbe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ru}unmount(){this.removeGroupControls(),this.removeListeners()}}const IV=e=>(t,r)=>{e&&Ja.postRender(()=>e(t,r))};class Hbe extends cy{constructor(){super(...arguments),this.removePointerDownListener=Ru}onPointerDown(t){this.session=new qX(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:$X(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:IV(t),onStart:IV(r),onMove:n,onEnd:(c,f)=>{delete this.session,a&&Ja.postRender(()=>a(c,f))}}}mount(){this.removePointerDownListener=d1(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const bA={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function DV(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const zb={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ni.test(e))e=parseFloat(e);else return e;const r=DV(e,t.target.x),n=DV(e,t.target.y);return`${r}% ${n}%`}},Kbe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=ny.parse(e);if(a.length>5)return n;const c=ny.createTransformer(e),f=typeof a[0]!="number"?1:0,i=r.x.scale*t.x,x=r.y.scale*t.y;a[0+f]/=i,a[1+f]/=x;const w=zs(i,x,.5);return typeof a[2+f]=="number"&&(a[2+f]/=w),typeof a[3+f]=="number"&&(a[3+f]/=w),c(a)}};class Zbe extends W.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:c}=t;dxe(Ybe),c&&(r.group&&r.group.add(c),n&&n.register&&a&&n.register(c),c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),bA.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:c}=this.props,f=n.projection;return f&&(f.isPresent=c,a||t.layoutDependency!==r||r===void 0||t.isPresent!==c?f.willUpdate():this.safeToRemove(),t.isPresent!==c&&(c?f.promote():f.relegate()||Ja.postRender(()=>{const i=f.getStack();(!i||!i.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),JD.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function WX(e){const[t,r]=Nve(),n=W.useContext(NY);return l.jsx(Zbe,{...e,layoutGroup:n,switchLayoutGroup:W.useContext($Y),isPresent:t,safeToRemove:r})}const Ybe={borderRadius:{...zb,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:zb,borderTopRightRadius:zb,borderBottomLeftRadius:zb,borderBottomRightRadius:zb,boxShadow:Kbe};function Xbe(e,t,r){const n=Yl(e)?e:W1(e);return n.start(_L("",n,t,r)),n.animation}function Jbe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const Qbe=(e,t)=>e.depth-t.depth;class e1e{constructor(){this.children=[],this.isDirty=!1}add(t){GD(this.children,t),this.isDirty=!0}remove(t){WD(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Qbe),this.isDirty=!1,this.children.forEach(t)}}function t1e(e,t){const r=Kf.now(),n=({timestamp:a})=>{const c=a-r;c>=t&&(ry(n),e(c-t))};return Ja.read(n,!0),()=>ry(n)}const HX=["TopLeft","TopRight","BottomLeft","BottomRight"],r1e=HX.length,LV=e=>typeof e=="string"?parseFloat(e):e,zV=e=>typeof e=="number"||ni.test(e);function n1e(e,t,r,n,a,c){a?(e.opacity=zs(0,r.opacity!==void 0?r.opacity:1,i1e(n)),e.opacityExit=zs(t.opacity!==void 0?t.opacity:1,0,a1e(n))):c&&(e.opacity=zs(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let f=0;f<r1e;f++){const i=`border${HX[f]}Radius`;let x=FV(t,i),w=FV(r,i);if(x===void 0&&w===void 0)continue;x||(x=0),w||(w=0),x===0||w===0||zV(x)===zV(w)?(e[i]=Math.max(zs(LV(x),LV(w),n),0),(Zf.test(w)||Zf.test(x))&&(e[i]+="%")):e[i]=w}(t.rotate||r.rotate)&&(e.rotate=zs(t.rotate||0,r.rotate||0,n))}function FV(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const i1e=KX(0,.5,uX),a1e=KX(.5,.95,Ru);function KX(e,t,r){return n=>n<e?0:n>t?1:r(Ex(e,t,n))}function BV(e,t){e.min=t.min,e.max=t.max}function Sd(e,t){BV(e.x,t.x),BV(e.y,t.y)}function VV(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function UV(e,t,r,n,a){return e-=t,e=aT(e,1/r,n),a!==void 0&&(e=aT(e,1/a,n)),e}function s1e(e,t=0,r=1,n=.5,a,c=e,f=e){if(Zf.test(t)&&(t=parseFloat(t),t=zs(f.min,f.max,t/100)-f.min),typeof t!="number")return;let i=zs(c.min,c.max,n);e===c&&(i-=t),e.min=UV(e.min,t,r,i,a),e.max=UV(e.max,t,r,i,a)}function $V(e,t,[r,n,a],c,f){s1e(e,t[r],t[n],t[a],t.scale,c,f)}const o1e=["x","scaleX","originX"],l1e=["y","scaleY","originY"];function qV(e,t,r,n){$V(e.x,t,o1e,r?r.x:void 0,n?n.x:void 0),$V(e.y,t,l1e,r?r.y:void 0,n?n.y:void 0)}function GV(e){return e.translate===0&&e.scale===1}function ZX(e){return GV(e.x)&&GV(e.y)}function WV(e,t){return e.min===t.min&&e.max===t.max}function c1e(e,t){return WV(e.x,t.x)&&WV(e.y,t.y)}function HV(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function YX(e,t){return HV(e.x,t.x)&&HV(e.y,t.y)}function KV(e){return yc(e.x)/yc(e.y)}function ZV(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class u1e{constructor(){this.members=[]}add(t){GD(this.members,t),t.scheduleRender()}remove(t){if(WD(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const c=this.members[a];if(c.isPresent!==!1){n=c;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function d1e(e,t,r){let n="";const a=e.x.translate/t.x,c=e.y.translate/t.y,f=(r==null?void 0:r.z)||0;if((a||c||f)&&(n=`translate3d(${a}px, ${c}px, ${f}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:w,rotate:A,rotateX:P,rotateY:E,skewX:D,skewY:V}=r;w&&(n=`perspective(${w}px) ${n}`),A&&(n+=`rotate(${A}deg) `),P&&(n+=`rotateX(${P}deg) `),E&&(n+=`rotateY(${E}deg) `),D&&(n+=`skewX(${D}deg) `),V&&(n+=`skewY(${V}deg) `)}const i=e.x.scale*t.x,x=e.y.scale*t.y;return(i!==1||x!==1)&&(n+=`scale(${i}, ${x})`),n||"none"}const NC=["","X","Y","Z"],h1e={visibility:"hidden"},YV=1e3;let f1e=0;function jC(e,t,r,n){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),n&&(n[e]=0))}function XX(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=nX(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:c}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Ja,!(a||c))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&XX(n)}function JX({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(f={},i=t==null?void 0:t()){this.id=f1e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(g1e),this.nodes.forEach(b1e),this.nodes.forEach(w1e),this.nodes.forEach(y1e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=f,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let x=0;x<this.path.length;x++)this.path[x].shouldResetTransform=!0;this.root===this&&(this.nodes=new e1e)}addEventListener(f,i){return this.eventHandlers.has(f)||this.eventHandlers.set(f,new KD),this.eventHandlers.get(f).add(i)}notifyListeners(f,...i){const x=this.eventHandlers.get(f);x&&x.notify(...i)}hasListeners(f){return this.eventHandlers.has(f)}mount(f,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Jbe(f),this.instance=f;const{layoutId:x,layout:w,visualElement:A}=this.options;if(A&&!A.current&&A.mount(f),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(w||x)&&(this.isLayoutDirty=!0),e){let P;const E=()=>this.root.updateBlockedByResize=!1;e(f,()=>{this.root.updateBlockedByResize=!0,P&&P(),P=t1e(E,250),bA.hasAnimatedSinceResize&&(bA.hasAnimatedSinceResize=!1,this.nodes.forEach(JV))})}x&&this.root.registerSharedNode(x,this),this.options.animate!==!1&&A&&(x||w)&&this.addEventListener("didUpdate",({delta:P,hasLayoutChanged:E,hasRelativeLayoutChanged:D,layout:V})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const L=this.options.transition||A.getDefaultTransition()||N1e,{onLayoutAnimationStart:$,onLayoutAnimationComplete:H}=A.getProps(),K=!this.targetLayout||!YX(this.targetLayout,V),Q=!E&&D;if(this.options.layoutRoot||this.resumeFrom||Q||E&&(K||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(P,Q);const ae={...ZD(L,"layout"),onPlay:$,onComplete:H};(A.shouldReduceMotion||this.options.layoutRoot)&&(ae.delay=0,ae.type=!1),this.startAnimation(ae)}else E||JV(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=V})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const f=this.getStack();f&&f.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ry(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(S1e),this.animationId++)}getTransformTemplate(){const{visualElement:f}=this.options;return f&&f.getProps().transformTemplate}willUpdate(f=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&XX(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let A=0;A<this.path.length;A++){const P=this.path[A];P.shouldResetTransform=!0,P.updateScroll("snapshot"),P.options.layoutRoot&&P.willUpdate(!1)}const{layoutId:i,layout:x}=this.options;if(i===void 0&&!x)return;const w=this.getTransformTemplate();this.prevTransformTemplateValue=w?w(this.latestValues,""):void 0,this.updateSnapshot(),f&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(XV);return}this.isUpdating||this.nodes.forEach(x1e),this.isUpdating=!1,this.nodes.forEach(_1e),this.nodes.forEach(p1e),this.nodes.forEach(m1e),this.clearAllSnapshots();const i=Kf.now();Nl.delta=wm(0,1e3/60,i-Nl.timestamp),Nl.timestamp=i,Nl.isProcessing=!0,xC.update.process(Nl),xC.preRender.process(Nl),xC.render.process(Nl),Nl.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,JD.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(v1e),this.sharedNodes.forEach(A1e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ja.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ja.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!yc(this.snapshot.measuredBox.x)&&!yc(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let x=0;x<this.path.length;x++)this.path[x].updateScroll();const f=this.layout;this.layout=this.measure(!1),this.layoutCorrected=no(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:i}=this.options;i&&i.notify("LayoutMeasure",this.layout.layoutBox,f?f.layoutBox:void 0)}updateScroll(f="measure"){let i=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===f&&(i=!1),i){const x=n(this.instance);this.scroll={animationId:this.root.animationId,phase:f,isRoot:x,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:x}}}resetTransform(){if(!a)return;const f=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,i=this.projectionDelta&&!ZX(this.projectionDelta),x=this.getTransformTemplate(),w=x?x(this.latestValues,""):void 0,A=w!==this.prevTransformTemplateValue;f&&(i||m0(this.latestValues)||A)&&(a(this.instance,w),this.shouldResetTransform=!1,this.scheduleRender())}measure(f=!0){const i=this.measurePageBox();let x=this.removeElementScroll(i);return f&&(x=this.removeTransform(x)),j1e(x),{animationId:this.root.animationId,measuredBox:i,layoutBox:x,latestValues:{},source:this.id}}measurePageBox(){var f;const{visualElement:i}=this.options;if(!i)return no();const x=i.measureViewportBox();if(!(((f=this.scroll)===null||f===void 0?void 0:f.wasRoot)||this.path.some(C1e))){const{scroll:A}=this.root;A&&(dx(x.x,A.offset.x),dx(x.y,A.offset.y))}return x}removeElementScroll(f){var i;const x=no();if(Sd(x,f),!((i=this.scroll)===null||i===void 0)&&i.wasRoot)return x;for(let w=0;w<this.path.length;w++){const A=this.path[w],{scroll:P,options:E}=A;A!==this.root&&P&&E.layoutScroll&&(P.wasRoot&&Sd(x,f),dx(x.x,P.offset.x),dx(x.y,P.offset.y))}return x}applyTransform(f,i=!1){const x=no();Sd(x,f);for(let w=0;w<this.path.length;w++){const A=this.path[w];!i&&A.options.layoutScroll&&A.scroll&&A!==A.root&&hx(x,{x:-A.scroll.offset.x,y:-A.scroll.offset.y}),m0(A.latestValues)&&hx(x,A.latestValues)}return m0(this.latestValues)&&hx(x,this.latestValues),x}removeTransform(f){const i=no();Sd(i,f);for(let x=0;x<this.path.length;x++){const w=this.path[x];if(!w.instance||!m0(w.latestValues))continue;BR(w.latestValues)&&w.updateSnapshot();const A=no(),P=w.measurePageBox();Sd(A,P),qV(i,w.latestValues,w.snapshot?w.snapshot.layoutBox:void 0,A)}return m0(this.latestValues)&&qV(i,this.latestValues),i}setTargetDelta(f){this.targetDelta=f,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(f){this.options={...this.options,...f,crossfade:f.crossfade!==void 0?f.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Nl.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(f=!1){var i;const x=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=x.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=x.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=x.isSharedProjectionDirty);const w=!!this.resumingFrom||this!==x;if(!(f||w&&this.isSharedProjectionDirty||this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:P,layoutId:E}=this.options;if(!(!this.layout||!(P||E))){if(this.resolvedRelativeTargetAt=Nl.timestamp,!this.targetDelta&&!this.relativeTarget){const D=this.getClosestProjectingParent();D&&D.layout&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=no(),this.relativeTargetOrigin=no(),f1(this.relativeTargetOrigin,this.layout.layoutBox,D.layout.layoutBox),Sd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=no(),this.targetWithTransforms=no()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Ebe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Sd(this.target,this.layout.layoutBox),VX(this.target,this.targetDelta)):Sd(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const D=this.getClosestProjectingParent();D&&!!D.resumingFrom==!!this.resumingFrom&&!D.options.layoutScroll&&D.target&&this.animationProgress!==1?(this.relativeParent=D,this.forceRelativeParentToResolveTarget(),this.relativeTarget=no(),this.relativeTargetOrigin=no(),f1(this.relativeTargetOrigin,this.target,D.target),Sd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||BR(this.parent.latestValues)||BX(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var f;const i=this.getLead(),x=!!this.resumingFrom||this!==i;let w=!0;if((this.isProjectionDirty||!((f=this.parent)===null||f===void 0)&&f.isProjectionDirty)&&(w=!1),x&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(w=!1),this.resolvedRelativeTargetAt===Nl.timestamp&&(w=!1),w)return;const{layout:A,layoutId:P}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(A||P))return;Sd(this.layoutCorrected,this.layout.layoutBox);const E=this.treeScale.x,D=this.treeScale.y;Mbe(this.layoutCorrected,this.treeScale,this.path,x),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=no());const{target:V}=i;if(!V){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(VV(this.prevProjectionDelta.x,this.projectionDelta.x),VV(this.prevProjectionDelta.y,this.projectionDelta.y)),h1(this.projectionDelta,this.layoutCorrected,V,this.latestValues),(this.treeScale.x!==E||this.treeScale.y!==D||!ZV(this.projectionDelta.x,this.prevProjectionDelta.x)||!ZV(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",V))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(f=!0){var i;if((i=this.options.visualElement)===null||i===void 0||i.scheduleRender(),f){const x=this.getStack();x&&x.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ux(),this.projectionDelta=ux(),this.projectionDeltaWithTransform=ux()}setAnimationOrigin(f,i=!1){const x=this.snapshot,w=x?x.latestValues:{},A={...this.latestValues},P=ux();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!i;const E=no(),D=x?x.source:void 0,V=this.layout?this.layout.source:void 0,L=D!==V,$=this.getStack(),H=!$||$.members.length<=1,K=!!(L&&!H&&this.options.crossfade===!0&&!this.path.some(P1e));this.animationProgress=0;let Q;this.mixTargetDelta=ae=>{const ee=ae/1e3;QV(P.x,f.x,ee),QV(P.y,f.y,ee),this.setTargetDelta(P),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(f1(E,this.layout.layoutBox,this.relativeParent.layout.layoutBox),T1e(this.relativeTarget,this.relativeTargetOrigin,E,ee),Q&&c1e(this.relativeTarget,Q)&&(this.isProjectionDirty=!1),Q||(Q=no()),Sd(Q,this.relativeTarget)),L&&(this.animationValues=A,n1e(A,w,this.latestValues,ee,K,H)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ee},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(f){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ry(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ja.update(()=>{bA.hasAnimatedSinceResize=!0,this.currentAnimation=Xbe(0,YV,{...f,onUpdate:i=>{this.mixTargetDelta(i),f.onUpdate&&f.onUpdate(i)},onStop:()=>{},onComplete:()=>{f.onComplete&&f.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const f=this.getStack();f&&f.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(YV),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const f=this.getLead();let{targetWithTransforms:i,target:x,layout:w,latestValues:A}=f;if(!(!i||!x||!w)){if(this!==f&&this.layout&&w&&QX(this.options.animationType,this.layout.layoutBox,w.layoutBox)){x=this.target||no();const P=yc(this.layout.layoutBox.x);x.x.min=f.target.x.min,x.x.max=x.x.min+P;const E=yc(this.layout.layoutBox.y);x.y.min=f.target.y.min,x.y.max=x.y.min+E}Sd(i,x),hx(i,A),h1(this.projectionDeltaWithTransform,this.layoutCorrected,i,A)}}registerSharedNode(f,i){this.sharedNodes.has(f)||this.sharedNodes.set(f,new u1e),this.sharedNodes.get(f).add(i);const w=i.options.initialPromotionConfig;i.promote({transition:w?w.transition:void 0,preserveFollowOpacity:w&&w.shouldPreserveFollowOpacity?w.shouldPreserveFollowOpacity(i):void 0})}isLead(){const f=this.getStack();return f?f.lead===this:!0}getLead(){var f;const{layoutId:i}=this.options;return i?((f=this.getStack())===null||f===void 0?void 0:f.lead)||this:this}getPrevLead(){var f;const{layoutId:i}=this.options;return i?(f=this.getStack())===null||f===void 0?void 0:f.prevLead:void 0}getStack(){const{layoutId:f}=this.options;if(f)return this.root.sharedNodes.get(f)}promote({needsReset:f,transition:i,preserveFollowOpacity:x}={}){const w=this.getStack();w&&w.promote(this,x),f&&(this.projectionDelta=void 0,this.needsReset=!0),i&&this.setOptions({transition:i})}relegate(){const f=this.getStack();return f?f.relegate(this):!1}resetSkewAndRotation(){const{visualElement:f}=this.options;if(!f)return;let i=!1;const{latestValues:x}=f;if((x.z||x.rotate||x.rotateX||x.rotateY||x.rotateZ||x.skewX||x.skewY)&&(i=!0),!i)return;const w={};x.z&&jC("z",f,w,this.animationValues);for(let A=0;A<NC.length;A++)jC(`rotate${NC[A]}`,f,w,this.animationValues),jC(`skew${NC[A]}`,f,w,this.animationValues);f.render();for(const A in w)f.setStaticValue(A,w[A]),this.animationValues&&(this.animationValues[A]=w[A]);f.scheduleRender()}getProjectionStyles(f){var i,x;if(!this.instance||this.isSVG)return;if(!this.isVisible)return h1e;const w={visibility:""},A=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,w.opacity="",w.pointerEvents=_A(f==null?void 0:f.pointerEvents)||"",w.transform=A?A(this.latestValues,""):"none",w;const P=this.getLead();if(!this.projectionDelta||!this.layout||!P.target){const L={};return this.options.layoutId&&(L.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,L.pointerEvents=_A(f==null?void 0:f.pointerEvents)||""),this.hasProjected&&!m0(this.latestValues)&&(L.transform=A?A({},""):"none",this.hasProjected=!1),L}const E=P.animationValues||P.latestValues;this.applyTransformsToTarget(),w.transform=d1e(this.projectionDeltaWithTransform,this.treeScale,E),A&&(w.transform=A(E,w.transform));const{x:D,y:V}=this.projectionDelta;w.transformOrigin=`${D.origin*100}% ${V.origin*100}% 0`,P.animationValues?w.opacity=P===this?(x=(i=E.opacity)!==null&&i!==void 0?i:this.latestValues.opacity)!==null&&x!==void 0?x:1:this.preserveOpacity?this.latestValues.opacity:E.opacityExit:w.opacity=P===this?E.opacity!==void 0?E.opacity:"":E.opacityExit!==void 0?E.opacityExit:0;for(const L in K1){if(E[L]===void 0)continue;const{correct:$,applyTo:H,isCSSVariable:K}=K1[L],Q=w.transform==="none"?E[L]:$(E[L],P);if(H){const ae=H.length;for(let ee=0;ee<ae;ee++)w[H[ee]]=Q}else K?this.options.visualElement.renderState.vars[L]=Q:w[L]=Q}return this.options.layoutId&&(w.pointerEvents=P===this?_A(f==null?void 0:f.pointerEvents)||"":"none"),w}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(f=>{var i;return(i=f.currentAnimation)===null||i===void 0?void 0:i.stop()}),this.root.nodes.forEach(XV),this.root.sharedNodes.clear()}}}function p1e(e){e.updateLayout()}function m1e(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:c}=e.options,f=r.source!==e.layout.source;c==="size"?Pd(P=>{const E=f?r.measuredBox[P]:r.layoutBox[P],D=yc(E);E.min=n[P].min,E.max=E.min+D}):QX(c,r.layoutBox,n)&&Pd(P=>{const E=f?r.measuredBox[P]:r.layoutBox[P],D=yc(n[P]);E.max=E.min+D,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[P].max=e.relativeTarget[P].min+D)});const i=ux();h1(i,n,r.layoutBox);const x=ux();f?h1(x,e.applyTransform(a,!0),r.measuredBox):h1(x,n,r.layoutBox);const w=!ZX(i);let A=!1;if(!e.resumeFrom){const P=e.getClosestProjectingParent();if(P&&!P.resumeFrom){const{snapshot:E,layout:D}=P;if(E&&D){const V=no();f1(V,r.layoutBox,E.layoutBox);const L=no();f1(L,n,D.layoutBox),YX(V,L)||(A=!0),P.options.layoutRoot&&(e.relativeTarget=L,e.relativeTargetOrigin=V,e.relativeParent=P)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:x,layoutDelta:i,hasLayoutChanged:w,hasRelativeLayoutChanged:A})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function g1e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function y1e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function v1e(e){e.clearSnapshot()}function XV(e){e.clearMeasurements()}function x1e(e){e.isLayoutDirty=!1}function _1e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function JV(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function b1e(e){e.resolveTargetDelta()}function w1e(e){e.calcProjection()}function S1e(e){e.resetSkewAndRotation()}function A1e(e){e.removeLeadSnapshot()}function QV(e,t,r){e.translate=zs(t.translate,0,r),e.scale=zs(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function eU(e,t,r,n){e.min=zs(t.min,r.min,n),e.max=zs(t.max,r.max,n)}function T1e(e,t,r,n){eU(e.x,t.x,r.x,n),eU(e.y,t.y,r.y,n)}function P1e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const N1e={duration:.45,ease:[.4,0,.1,1]},tU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),rU=tU("applewebkit/")&&!tU("chrome/")?Math.round:Ru;function nU(e){e.min=rU(e.min),e.max=rU(e.max)}function j1e(e){nU(e.x),nU(e.y)}function QX(e,t,r){return e==="position"||e==="preserve-aspect"&&!kbe(KV(t),KV(r),.2)}function C1e(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const k1e=JX({attachResizeListener:(e,t)=>J1(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),CC={current:void 0},eJ=JX({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!CC.current){const e=new k1e({});e.mount(window),e.setOptions({layoutScroll:!0}),CC.current=e}return CC.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),E1e={pan:{Feature:Hbe},drag:{Feature:Wbe,ProjectionNode:eJ,MeasureLayout:WX}};function iU(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,c=n[a];c&&Ja.postRender(()=>c(t,s2(t)))}class M1e extends cy{mount(){const{current:t}=this.node;t&&(this.unmount=Fve(t,(r,n)=>(iU(this.node,n,"Start"),a=>iU(this.node,a,"End"))))}unmount(){}}class O1e extends cy{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=a2(J1(this.node.current,"focus",()=>this.onFocus()),J1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function aU(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),c=n[a];c&&Ja.postRender(()=>c(t,s2(t)))}class R1e extends cy{mount(){const{current:t}=this.node;t&&(this.unmount=$ve(t,(r,n)=>(aU(this.node,n,"Start"),(a,{success:c})=>aU(this.node,a,c?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const $R=new WeakMap,kC=new WeakMap,I1e=e=>{const t=$R.get(e.target);t&&t(e)},D1e=e=>{e.forEach(I1e)};function L1e({root:e,...t}){const r=e||document;kC.has(r)||kC.set(r,{});const n=kC.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(D1e,{root:e,...t})),n[a]}function z1e(e,t,r){const n=L1e(t);return $R.set(e,r),n.observe(e),()=>{$R.delete(e),n.unobserve(e)}}const F1e={some:0,all:1};class B1e extends cy{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:c}=t,f={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:F1e[a]},i=x=>{const{isIntersecting:w}=x;if(this.isInView===w||(this.isInView=w,c&&!w&&this.hasEnteredView))return;w&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",w);const{onViewportEnter:A,onViewportLeave:P}=this.node.getProps(),E=w?A:P;E&&E(x)};return z1e(this.node.current,f,i)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(V1e(t,r))&&this.startObserver()}unmount(){}}function V1e({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const U1e={inView:{Feature:B1e},tap:{Feature:R1e},focus:{Feature:O1e},hover:{Feature:M1e}},$1e={layout:{ProjectionNode:eJ,MeasureLayout:WX}},qR={current:null},tJ={current:!1};function q1e(){if(tJ.current=!0,!!$D)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>qR.current=e.matches;e.addListener(t),t()}else qR.current=!1}const G1e=[...TX,Wl,ny],W1e=e=>G1e.find(AX(e)),H1e=new WeakMap;function K1e(e,t,r){for(const n in t){const a=t[n],c=r[n];if(Yl(a))e.addValue(n,a);else if(Yl(c))e.addValue(n,W1(a,{owner:e}));else if(c!==a)if(e.hasValue(n)){const f=e.getValue(n);f.liveStyle===!0?f.jump(a):f.hasAnimated||f.set(a)}else{const f=e.getStaticValue(n);e.addValue(n,W1(f!==void 0?f:a,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const sU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Z1e{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:c,visualState:f},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=yL,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const D=Kf.now();this.renderScheduledAt<D&&(this.renderScheduledAt=D,Ja.render(this.render,!1,!0))};const{latestValues:x,renderState:w,onUpdate:A}=f;this.onUpdate=A,this.latestValues=x,this.baseTarget={...x},this.initialValues=r.initial?{...x}:{},this.renderState=w,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=i,this.blockInitialAnimation=!!c,this.isControllingVariants=WP(r),this.isVariantNode=VY(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:P,...E}=this.scrapeMotionValuesFromProps(r,{},this);for(const D in E){const V=E[D];x[D]!==void 0&&Yl(V)&&V.set(x[D],!1)}}mount(t){this.current=t,H1e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),tJ.current||q1e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:qR.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),ry(this.notifyUpdate),ry(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=tv.has(t);n&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Ja.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),c=r.on("renderRequest",this.scheduleRender);let f;window.MotionCheckAppearSync&&(f=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),c(),f&&f(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Mx){const r=Mx[t];if(!r)continue;const{isEnabled:n,Feature:a}=r;if(!this.features[t]&&a&&n(this.props)&&(this.features[t]=new a(this)),this.features[t]){const c=this.features[t];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):no()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<sU.length;n++){const a=sU[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const c="on"+a,f=t[c];f&&(this.propEventSubscriptions[a]=this.on(a,f))}this.prevMotionValues=K1e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=W1(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){var n;let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(wX(a)||hX(a))?a=parseFloat(a):!W1e(a)&&ny.test(r)&&(a=xX(t,r)),this.setBaseTarget(t,Yl(a)?a.get():a)),Yl(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props;let a;if(typeof n=="string"||typeof n=="object"){const f=dL(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);f&&(a=f[t])}if(n&&a!==void 0)return a;const c=this.getBaseTargetFromProps(this.props,t);return c!==void 0&&!Yl(c)?c:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new KD),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class rJ extends Z1e{constructor(){super(...arguments),this.KeyframeResolver=PX}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Yl(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Y1e(e){return window.getComputedStyle(e)}class X1e extends rJ{constructor(){super(...arguments),this.type="html",this.renderInstance=JY}readValueFromInstance(t,r){if(tv.has(r))return l_e(t,r);{const n=Y1e(t),a=(nL(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return UX(t,r)}build(t,r,n){sL(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return hL(t,r,n)}}class J1e extends rJ{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=no,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&XY(this.current,this.renderState)}}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(tv.has(r)){const n=vX(r);return n&&n.default||0}return r=QY.has(r)?r:rL(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return tX(t,r,n)}onBindTransform(){this.current&&!this.renderState.dimensions&&Ja.postRender(this.updateDimensions)}build(t,r,n){cL(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,a){eX(t,r,n,a)}mount(t){this.isSVGTag=uL(t.tagName),super.mount(t)}}const Q1e=(e,t)=>lL(e)?new J1e(t):new X1e(t,{allowProjection:e!==W.Fragment}),ewe=Ixe({...wbe,...U1e,...E1e,...$1e},Q1e),twe=Xve(ewe);function sT({className:e,...t}){return l.jsx("div",{className:Ut("animate-pulse rounded-md bg-primary/10",e),...t})}const VS=({name:e,icon:t,value:r,color:n,loading:a,statuses:c=[]})=>l.jsx(twe.div,{className:"bg-card shadow-sm border border-border overflow-hidden rounded-xl",children:a?l.jsx(sT,{className:"h-[100px]"}):l.jsxs("div",{className:"md:px-4 md:py-5 p-6",children:[l.jsxs("span",{className:"flex items-center justify-between text-xs text-muted-foreground ",children:[e,l.jsx(t,{size:20,className:"mr-3 text-accent-foreground"})]}),l.jsx("p",{className:"mt-1 text-3xl md:text-4xl tracking-tight font-bold ",children:r}),c.length>0&&l.jsx("div",{className:"space-x-2 mt-2",children:c.map((f,i)=>l.jsx("span",{className:" text-xs py-1 px-2 rounded-md",style:{color:f.color,backgroundColor:f.bgColor},children:f.label},i))})]})});var EC,oU;function Jc(){if(oU)return EC;oU=1;var e=Array.isArray;return EC=e,EC}var MC,lU;function nJ(){if(lU)return MC;lU=1;var e=typeof TS=="object"&&TS&&TS.Object===Object&&TS;return MC=e,MC}var OC,cU;function dp(){if(cU)return OC;cU=1;var e=nJ(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return OC=r,OC}var RC,uU;function o2(){if(uU)return RC;uU=1;var e=dp(),t=e.Symbol;return RC=t,RC}var IC,dU;function rwe(){if(dU)return IC;dU=1;var e=o2(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,a=e?e.toStringTag:void 0;function c(f){var i=r.call(f,a),x=f[a];try{f[a]=void 0;var w=!0}catch{}var A=n.call(f);return w&&(i?f[a]=x:delete f[a]),A}return IC=c,IC}var DC,hU;function nwe(){if(hU)return DC;hU=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return DC=r,DC}var LC,fU;function Nm(){if(fU)return LC;fU=1;var e=o2(),t=rwe(),r=nwe(),n="[object Null]",a="[object Undefined]",c=e?e.toStringTag:void 0;function f(i){return i==null?i===void 0?a:n:c&&c in Object(i)?t(i):r(i)}return LC=f,LC}var zC,pU;function jm(){if(pU)return zC;pU=1;function e(t){return t!=null&&typeof t=="object"}return zC=e,zC}var FC,mU;function j_(){if(mU)return FC;mU=1;var e=Nm(),t=jm(),r="[object Symbol]";function n(a){return typeof a=="symbol"||t(a)&&e(a)==r}return FC=n,FC}var BC,gU;function bL(){if(gU)return BC;gU=1;var e=Jc(),t=j_(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(c,f){if(e(c))return!1;var i=typeof c;return i=="number"||i=="symbol"||i=="boolean"||c==null||t(c)?!0:n.test(c)||!r.test(c)||f!=null&&c in Object(f)}return BC=a,BC}var VC,yU;function uy(){if(yU)return VC;yU=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return VC=e,VC}var UC,vU;function wL(){if(vU)return UC;vU=1;var e=Nm(),t=uy(),r="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";function f(i){if(!t(i))return!1;var x=e(i);return x==n||x==a||x==r||x==c}return UC=f,UC}var $C,xU;function iwe(){if(xU)return $C;xU=1;var e=dp(),t=e["__core-js_shared__"];return $C=t,$C}var qC,_U;function awe(){if(_U)return qC;_U=1;var e=iwe(),t=function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!t&&t in n}return qC=r,qC}var GC,bU;function iJ(){if(bU)return GC;bU=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return GC=r,GC}var WC,wU;function swe(){if(wU)return WC;wU=1;var e=wL(),t=awe(),r=uy(),n=iJ(),a=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,f=Function.prototype,i=Object.prototype,x=f.toString,w=i.hasOwnProperty,A=RegExp("^"+x.call(w).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P(E){if(!r(E)||t(E))return!1;var D=e(E)?A:c;return D.test(n(E))}return WC=P,WC}var HC,SU;function owe(){if(SU)return HC;SU=1;function e(t,r){return t==null?void 0:t[r]}return HC=e,HC}var KC,AU;function rv(){if(AU)return KC;AU=1;var e=swe(),t=owe();function r(n,a){var c=t(n,a);return e(c)?c:void 0}return KC=r,KC}var ZC,TU;function KP(){if(TU)return ZC;TU=1;var e=rv(),t=e(Object,"create");return ZC=t,ZC}var YC,PU;function lwe(){if(PU)return YC;PU=1;var e=KP();function t(){this.__data__=e?e(null):{},this.size=0}return YC=t,YC}var XC,NU;function cwe(){if(NU)return XC;NU=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return XC=e,XC}var JC,jU;function uwe(){if(jU)return JC;jU=1;var e=KP(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function a(c){var f=this.__data__;if(e){var i=f[c];return i===t?void 0:i}return n.call(f,c)?f[c]:void 0}return JC=a,JC}var QC,CU;function dwe(){if(CU)return QC;CU=1;var e=KP(),t=Object.prototype,r=t.hasOwnProperty;function n(a){var c=this.__data__;return e?c[a]!==void 0:r.call(c,a)}return QC=n,QC}var ek,kU;function hwe(){if(kU)return ek;kU=1;var e=KP(),t="__lodash_hash_undefined__";function r(n,a){var c=this.__data__;return this.size+=this.has(n)?0:1,c[n]=e&&a===void 0?t:a,this}return ek=r,ek}var tk,EU;function fwe(){if(EU)return tk;EU=1;var e=lwe(),t=cwe(),r=uwe(),n=dwe(),a=hwe();function c(f){var i=-1,x=f==null?0:f.length;for(this.clear();++i<x;){var w=f[i];this.set(w[0],w[1])}}return c.prototype.clear=e,c.prototype.delete=t,c.prototype.get=r,c.prototype.has=n,c.prototype.set=a,tk=c,tk}var rk,MU;function pwe(){if(MU)return rk;MU=1;function e(){this.__data__=[],this.size=0}return rk=e,rk}var nk,OU;function SL(){if(OU)return nk;OU=1;function e(t,r){return t===r||t!==t&&r!==r}return nk=e,nk}var ik,RU;function ZP(){if(RU)return ik;RU=1;var e=SL();function t(r,n){for(var a=r.length;a--;)if(e(r[a][0],n))return a;return-1}return ik=t,ik}var ak,IU;function mwe(){if(IU)return ak;IU=1;var e=ZP(),t=Array.prototype,r=t.splice;function n(a){var c=this.__data__,f=e(c,a);if(f<0)return!1;var i=c.length-1;return f==i?c.pop():r.call(c,f,1),--this.size,!0}return ak=n,ak}var sk,DU;function gwe(){if(DU)return sk;DU=1;var e=ZP();function t(r){var n=this.__data__,a=e(n,r);return a<0?void 0:n[a][1]}return sk=t,sk}var ok,LU;function ywe(){if(LU)return ok;LU=1;var e=ZP();function t(r){return e(this.__data__,r)>-1}return ok=t,ok}var lk,zU;function vwe(){if(zU)return lk;zU=1;var e=ZP();function t(r,n){var a=this.__data__,c=e(a,r);return c<0?(++this.size,a.push([r,n])):a[c][1]=n,this}return lk=t,lk}var ck,FU;function YP(){if(FU)return ck;FU=1;var e=pwe(),t=mwe(),r=gwe(),n=ywe(),a=vwe();function c(f){var i=-1,x=f==null?0:f.length;for(this.clear();++i<x;){var w=f[i];this.set(w[0],w[1])}}return c.prototype.clear=e,c.prototype.delete=t,c.prototype.get=r,c.prototype.has=n,c.prototype.set=a,ck=c,ck}var uk,BU;function AL(){if(BU)return uk;BU=1;var e=rv(),t=dp(),r=e(t,"Map");return uk=r,uk}var dk,VU;function xwe(){if(VU)return dk;VU=1;var e=fwe(),t=YP(),r=AL();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return dk=n,dk}var hk,UU;function _we(){if(UU)return hk;UU=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return hk=e,hk}var fk,$U;function XP(){if($U)return fk;$U=1;var e=_we();function t(r,n){var a=r.__data__;return e(n)?a[typeof n=="string"?"string":"hash"]:a.map}return fk=t,fk}var pk,qU;function bwe(){if(qU)return pk;qU=1;var e=XP();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return pk=t,pk}var mk,GU;function wwe(){if(GU)return mk;GU=1;var e=XP();function t(r){return e(this,r).get(r)}return mk=t,mk}var gk,WU;function Swe(){if(WU)return gk;WU=1;var e=XP();function t(r){return e(this,r).has(r)}return gk=t,gk}var yk,HU;function Awe(){if(HU)return yk;HU=1;var e=XP();function t(r,n){var a=e(this,r),c=a.size;return a.set(r,n),this.size+=a.size==c?0:1,this}return yk=t,yk}var vk,KU;function TL(){if(KU)return vk;KU=1;var e=xwe(),t=bwe(),r=wwe(),n=Swe(),a=Awe();function c(f){var i=-1,x=f==null?0:f.length;for(this.clear();++i<x;){var w=f[i];this.set(w[0],w[1])}}return c.prototype.clear=e,c.prototype.delete=t,c.prototype.get=r,c.prototype.has=n,c.prototype.set=a,vk=c,vk}var xk,ZU;function aJ(){if(ZU)return xk;ZU=1;var e=TL(),t="Expected a function";function r(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new TypeError(t);var c=function(){var f=arguments,i=a?a.apply(this,f):f[0],x=c.cache;if(x.has(i))return x.get(i);var w=n.apply(this,f);return c.cache=x.set(i,w)||x,w};return c.cache=new(r.Cache||e),c}return r.Cache=e,xk=r,xk}var _k,YU;function Twe(){if(YU)return _k;YU=1;var e=aJ(),t=500;function r(n){var a=e(n,function(f){return c.size===t&&c.clear(),f}),c=a.cache;return a}return _k=r,_k}var bk,XU;function Pwe(){if(XU)return bk;XU=1;var e=Twe(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(a){var c=[];return a.charCodeAt(0)===46&&c.push(""),a.replace(t,function(f,i,x,w){c.push(x?w.replace(r,"$1"):i||f)}),c});return bk=n,bk}var wk,JU;function PL(){if(JU)return wk;JU=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,c=Array(a);++n<a;)c[n]=r(t[n],n,t);return c}return wk=e,wk}var Sk,QU;function Nwe(){if(QU)return Sk;QU=1;var e=o2(),t=PL(),r=Jc(),n=j_(),a=e?e.prototype:void 0,c=a?a.toString:void 0;function f(i){if(typeof i=="string")return i;if(r(i))return t(i,f)+"";if(n(i))return c?c.call(i):"";var x=i+"";return x=="0"&&1/i==-1/0?"-0":x}return Sk=f,Sk}var Ak,e$;function sJ(){if(e$)return Ak;e$=1;var e=Nwe();function t(r){return r==null?"":e(r)}return Ak=t,Ak}var Tk,t$;function oJ(){if(t$)return Tk;t$=1;var e=Jc(),t=bL(),r=Pwe(),n=sJ();function a(c,f){return e(c)?c:t(c,f)?[c]:r(n(c))}return Tk=a,Tk}var Pk,r$;function JP(){if(r$)return Pk;r$=1;var e=j_();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Pk=t,Pk}var Nk,n$;function NL(){if(n$)return Nk;n$=1;var e=oJ(),t=JP();function r(n,a){a=e(a,n);for(var c=0,f=a.length;n!=null&&c<f;)n=n[t(a[c++])];return c&&c==f?n:void 0}return Nk=r,Nk}var jk,i$;function lJ(){if(i$)return jk;i$=1;var e=NL();function t(r,n,a){var c=r==null?void 0:e(r,n);return c===void 0?a:c}return jk=t,jk}var jwe=lJ();const Iu=la(jwe);var Ck,a$;function Cwe(){if(a$)return Ck;a$=1;function e(t){return t==null}return Ck=e,Ck}var kwe=Cwe();const Xn=la(kwe);var kk,s$;function Ewe(){if(s$)return kk;s$=1;var e=Nm(),t=Jc(),r=jm(),n="[object String]";function a(c){return typeof c=="string"||!t(c)&&r(c)&&e(c)==n}return kk=a,kk}var Mwe=Ewe();const l2=la(Mwe);var Owe=wL();const qn=la(Owe);var Rwe=uy();const C_=la(Rwe);var Ek={exports:{}},xa={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o$;function Iwe(){if(o$)return xa;o$=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),f=Symbol.for("react.context"),i=Symbol.for("react.server_context"),x=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),D=Symbol.for("react.offscreen"),V;V=Symbol.for("react.module.reference");function L($){if(typeof $=="object"&&$!==null){var H=$.$$typeof;switch(H){case e:switch($=$.type,$){case r:case a:case n:case w:case A:return $;default:switch($=$&&$.$$typeof,$){case i:case f:case x:case E:case P:case c:return $;default:return H}}case t:return H}}}return xa.ContextConsumer=f,xa.ContextProvider=c,xa.Element=e,xa.ForwardRef=x,xa.Fragment=r,xa.Lazy=E,xa.Memo=P,xa.Portal=t,xa.Profiler=a,xa.StrictMode=n,xa.Suspense=w,xa.SuspenseList=A,xa.isAsyncMode=function(){return!1},xa.isConcurrentMode=function(){return!1},xa.isContextConsumer=function($){return L($)===f},xa.isContextProvider=function($){return L($)===c},xa.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===e},xa.isForwardRef=function($){return L($)===x},xa.isFragment=function($){return L($)===r},xa.isLazy=function($){return L($)===E},xa.isMemo=function($){return L($)===P},xa.isPortal=function($){return L($)===t},xa.isProfiler=function($){return L($)===a},xa.isStrictMode=function($){return L($)===n},xa.isSuspense=function($){return L($)===w},xa.isSuspenseList=function($){return L($)===A},xa.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===r||$===a||$===n||$===w||$===A||$===D||typeof $=="object"&&$!==null&&($.$$typeof===E||$.$$typeof===P||$.$$typeof===c||$.$$typeof===f||$.$$typeof===x||$.$$typeof===V||$.getModuleId!==void 0)},xa.typeOf=L,xa}var l$;function Dwe(){return l$||(l$=1,Ek.exports=Iwe()),Ek.exports}var Lwe=Dwe(),Mk,c$;function cJ(){if(c$)return Mk;c$=1;var e=Nm(),t=jm(),r="[object Number]";function n(a){return typeof a=="number"||t(a)&&e(a)==r}return Mk=n,Mk}var Ok,u$;function zwe(){if(u$)return Ok;u$=1;var e=cJ();function t(r){return e(r)&&r!=+r}return Ok=t,Ok}var Fwe=zwe();const k_=la(Fwe);var Bwe=cJ();const Vwe=la(Bwe);var ul=function(t){return t===0?0:t>0?1:-1},P0=function(t){return l2(t)&&t.indexOf("%")===t.length-1},zr=function(t){return Vwe(t)&&!k_(t)},Vo=function(t){return zr(t)||l2(t)},Uwe=0,dy=function(t){var r=++Uwe;return"".concat(t||"").concat(r)},vc=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!zr(t)&&!l2(t))return n;var c;if(P0(t)){var f=t.indexOf("%");c=r*parseFloat(t.slice(0,f))/100}else c=+t;return k_(c)&&(c=n),a&&c>r&&(c=r),c},zg=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},$we=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Za=function(t,r){return zr(t)&&zr(r)?function(n){return t+n*(r-t)}:function(){return r}};function oT(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):Iu(n,t))===r})}var qwe=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,c=0,f=0,i=1/0,x=-1/0,w=0,A=0,P=0;P<r;P++)w=t[P].cx||0,A=t[P].cy||0,n+=w,a+=A,c+=w*A,f+=w*w,i=Math.min(i,w),x=Math.max(x,w);var E=r*f!==n*n?(r*c-n*a)/(r*f-n*n):0;return{xmin:i,xmax:x,a:E,b:(a-E*n)/r}};function wx(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function GR(e){"@babel/helpers - typeof";return GR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GR(e)}var Gwe=["viewBox","children"],Wwe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],d$=["points","pathLength"],Rk={svg:Gwe,polygon:d$,polyline:d$},jL=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],lT=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(W.isValidElement(t)&&(n=t.props),!C_(n))return null;var a={};return Object.keys(n).forEach(function(c){jL.includes(c)&&(a[c]=r||function(f){return n[c](n,f)})}),a},Hwe=function(t,r,n){return function(a){return t(r,n,a),null}},ap=function(t,r,n){if(!C_(t)||GR(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(c){var f=t[c];jL.includes(c)&&typeof f=="function"&&(a||(a={}),a[c]=Hwe(f,r,n))}),a},Kwe=["children"],Zwe=["children"];function h$(e,t){if(e==null)return{};var r=Ywe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Ywe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function WR(e){"@babel/helpers - typeof";return WR=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WR(e)}var f$={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},mm=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},p$=null,Ik=null,CL=function e(t){if(t===p$&&Array.isArray(Ik))return Ik;var r=[];return W.Children.forEach(t,function(n){Xn(n)||(Lwe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Ik=r,p$=t,r};function Xl(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return mm(a)}):n=[mm(t)],CL(e).forEach(function(a){var c=Iu(a,"type.displayName")||Iu(a,"type.name");n.indexOf(c)!==-1&&r.push(a)}),r}function Pu(e,t){var r=Xl(e,t);return r&&r[0]}var m$=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!zr(n)||n<=0||!zr(a)||a<=0)},Xwe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Jwe=function(t){return t&&t.type&&l2(t.type)&&Xwe.indexOf(t.type)>=0},uJ=function(t){return t&&WR(t)==="object"&&"clipDot"in t},Qwe=function(t,r,n,a){var c,f=(c=Rk==null?void 0:Rk[a])!==null&&c!==void 0?c:[];return!qn(t)&&(a&&f.includes(r)||Wwe.includes(r))||n&&jL.includes(r)},vn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(W.isValidElement(t)&&(a=t.props),!C_(a))return null;var c={};return Object.keys(a).forEach(function(f){var i;Qwe((i=a)===null||i===void 0?void 0:i[f],f,r,n)&&(c[f]=a[f])}),c},HR=function e(t,r){if(t===r)return!0;var n=W.Children.count(t);if(n!==W.Children.count(r))return!1;if(n===0)return!0;if(n===1)return g$(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var c=t[a],f=r[a];if(Array.isArray(c)||Array.isArray(f)){if(!e(c,f))return!1}else if(!g$(c,f))return!1}return!0},g$=function(t,r){if(Xn(t)&&Xn(r))return!0;if(!Xn(t)&&!Xn(r)){var n=t.props||{},a=n.children,c=h$(n,Kwe),f=r.props||{},i=f.children,x=h$(f,Zwe);return a&&i?wx(c,x)&&HR(a,i):!a&&!i?wx(c,x):!1}return!1},y$=function(t,r){var n=[],a={};return CL(t).forEach(function(c,f){if(Jwe(c))n.push(c);else if(c){var i=mm(c.type),x=r[i]||{},w=x.handler,A=x.once;if(w&&(!A||!a[i])){var P=w(c,i,f);n.push(P),a[i]=!0}}}),n},e2e=function(t){var r=t&&t.type;return r&&f$[r]?f$[r]:null},t2e=function(t,r){return CL(r).indexOf(t)},r2e=["children","width","height","viewBox","className","style","title","desc"];function KR(){return KR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KR.apply(this,arguments)}function n2e(e,t){if(e==null)return{};var r=i2e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function i2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ZR(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,c=e.className,f=e.style,i=e.title,x=e.desc,w=n2e(e,r2e),A=a||{width:r,height:n,x:0,y:0},P=fi("recharts-surface",c);return Oe.createElement("svg",KR({},vn(w,!0,"svg"),{className:P,width:r,height:n,style:f,viewBox:"".concat(A.x," ").concat(A.y," ").concat(A.width," ").concat(A.height)}),Oe.createElement("title",null,i),Oe.createElement("desc",null,x),t)}var a2e=["children","className"];function YR(){return YR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YR.apply(this,arguments)}function s2e(e,t){if(e==null)return{};var r=o2e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o2e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var mi=Oe.forwardRef(function(e,t){var r=e.children,n=e.className,a=s2e(e,a2e),c=fi("recharts-layer",n);return Oe.createElement("g",YR({className:c},vn(a,!0),{ref:t}),r)}),Vh=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),c=2;c<n;c++)a[c-2]=arguments[c]},Dk,v$;function l2e(){if(v$)return Dk;v$=1;function e(t,r,n){var a=-1,c=t.length;r<0&&(r=-r>c?0:c+r),n=n>c?c:n,n<0&&(n+=c),c=r>n?0:n-r>>>0,r>>>=0;for(var f=Array(c);++a<c;)f[a]=t[a+r];return f}return Dk=e,Dk}var Lk,x$;function c2e(){if(x$)return Lk;x$=1;var e=l2e();function t(r,n,a){var c=r.length;return a=a===void 0?c:a,!n&&a>=c?r:e(r,n,a)}return Lk=t,Lk}var zk,_$;function dJ(){if(_$)return zk;_$=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,c="\\ufe0e\\ufe0f",f="\\u200d",i=RegExp("["+f+e+a+c+"]");function x(w){return i.test(w)}return zk=x,zk}var Fk,b$;function u2e(){if(b$)return Fk;b$=1;function e(t){return t.split("")}return Fk=e,Fk}var Bk,w$;function d2e(){if(w$)return Bk;w$=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",a=t+r+n,c="\\ufe0e\\ufe0f",f="["+e+"]",i="["+a+"]",x="\\ud83c[\\udffb-\\udfff]",w="(?:"+i+"|"+x+")",A="[^"+e+"]",P="(?:\\ud83c[\\udde6-\\uddff]){2}",E="[\\ud800-\\udbff][\\udc00-\\udfff]",D="\\u200d",V=w+"?",L="["+c+"]?",$="(?:"+D+"(?:"+[A,P,E].join("|")+")"+L+V+")*",H=L+V+$,K="(?:"+[A+i+"?",i,P,E,f].join("|")+")",Q=RegExp(x+"(?="+x+")|"+K+H,"g");function ae(ee){return ee.match(Q)||[]}return Bk=ae,Bk}var Vk,S$;function h2e(){if(S$)return Vk;S$=1;var e=u2e(),t=dJ(),r=d2e();function n(a){return t(a)?r(a):e(a)}return Vk=n,Vk}var Uk,A$;function f2e(){if(A$)return Uk;A$=1;var e=c2e(),t=dJ(),r=h2e(),n=sJ();function a(c){return function(f){f=n(f);var i=t(f)?r(f):void 0,x=i?i[0]:f.charAt(0),w=i?e(i,1).join(""):f.slice(1);return x[c]()+w}}return Uk=a,Uk}var $k,T$;function p2e(){if(T$)return $k;T$=1;var e=f2e(),t=e("toUpperCase");return $k=t,$k}var m2e=p2e();const QP=la(m2e);function Ha(e){return function(){return e}}const hJ=Math.cos,cT=Math.sin,ef=Math.sqrt,uT=Math.PI,eN=2*uT,XR=Math.PI,JR=2*XR,g0=1e-6,g2e=JR-g0;function fJ(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function y2e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return fJ;const r=10**t;return function(n){this._+=n[0];for(let a=1,c=n.length;a<c;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class v2e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?fJ:y2e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,c,f){this._append`C${+t},${+r},${+n},${+a},${this._x1=+c},${this._y1=+f}`}arcTo(t,r,n,a,c){if(t=+t,r=+r,n=+n,a=+a,c=+c,c<0)throw new Error(`negative radius: ${c}`);let f=this._x1,i=this._y1,x=n-t,w=a-r,A=f-t,P=i-r,E=A*A+P*P;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(E>g0)if(!(Math.abs(P*x-w*A)>g0)||!c)this._append`L${this._x1=t},${this._y1=r}`;else{let D=n-f,V=a-i,L=x*x+w*w,$=D*D+V*V,H=Math.sqrt(L),K=Math.sqrt(E),Q=c*Math.tan((XR-Math.acos((L+E-$)/(2*H*K)))/2),ae=Q/K,ee=Q/H;Math.abs(ae-1)>g0&&this._append`L${t+ae*A},${r+ae*P}`,this._append`A${c},${c},0,0,${+(P*D>A*V)},${this._x1=t+ee*x},${this._y1=r+ee*w}`}}arc(t,r,n,a,c,f){if(t=+t,r=+r,n=+n,f=!!f,n<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(a),x=n*Math.sin(a),w=t+i,A=r+x,P=1^f,E=f?a-c:c-a;this._x1===null?this._append`M${w},${A}`:(Math.abs(this._x1-w)>g0||Math.abs(this._y1-A)>g0)&&this._append`L${w},${A}`,n&&(E<0&&(E=E%JR+JR),E>g2e?this._append`A${n},${n},0,1,${P},${t-i},${r-x}A${n},${n},0,1,${P},${this._x1=w},${this._y1=A}`:E>g0&&this._append`A${n},${n},0,${+(E>=XR)},${P},${this._x1=t+n*Math.cos(c)},${this._y1=r+n*Math.sin(c)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function kL(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new v2e(t)}function EL(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pJ(e){this._context=e}pJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function tN(e){return new pJ(e)}function mJ(e){return e[0]}function gJ(e){return e[1]}function yJ(e,t){var r=Ha(!0),n=null,a=tN,c=null,f=kL(i);e=typeof e=="function"?e:e===void 0?mJ:Ha(e),t=typeof t=="function"?t:t===void 0?gJ:Ha(t);function i(x){var w,A=(x=EL(x)).length,P,E=!1,D;for(n==null&&(c=a(D=f())),w=0;w<=A;++w)!(w<A&&r(P=x[w],w,x))===E&&((E=!E)?c.lineStart():c.lineEnd()),E&&c.point(+e(P,w,x),+t(P,w,x));if(D)return c=null,D+""||null}return i.x=function(x){return arguments.length?(e=typeof x=="function"?x:Ha(+x),i):e},i.y=function(x){return arguments.length?(t=typeof x=="function"?x:Ha(+x),i):t},i.defined=function(x){return arguments.length?(r=typeof x=="function"?x:Ha(!!x),i):r},i.curve=function(x){return arguments.length?(a=x,n!=null&&(c=a(n)),i):a},i.context=function(x){return arguments.length?(x==null?n=c=null:c=a(n=x),i):n},i}function US(e,t,r){var n=null,a=Ha(!0),c=null,f=tN,i=null,x=kL(w);e=typeof e=="function"?e:e===void 0?mJ:Ha(+e),t=typeof t=="function"?t:Ha(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?gJ:Ha(+r);function w(P){var E,D,V,L=(P=EL(P)).length,$,H=!1,K,Q=new Array(L),ae=new Array(L);for(c==null&&(i=f(K=x())),E=0;E<=L;++E){if(!(E<L&&a($=P[E],E,P))===H)if(H=!H)D=E,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),V=E-1;V>=D;--V)i.point(Q[V],ae[V]);i.lineEnd(),i.areaEnd()}H&&(Q[E]=+e($,E,P),ae[E]=+t($,E,P),i.point(n?+n($,E,P):Q[E],r?+r($,E,P):ae[E]))}if(K)return i=null,K+""||null}function A(){return yJ().defined(a).curve(f).context(c)}return w.x=function(P){return arguments.length?(e=typeof P=="function"?P:Ha(+P),n=null,w):e},w.x0=function(P){return arguments.length?(e=typeof P=="function"?P:Ha(+P),w):e},w.x1=function(P){return arguments.length?(n=P==null?null:typeof P=="function"?P:Ha(+P),w):n},w.y=function(P){return arguments.length?(t=typeof P=="function"?P:Ha(+P),r=null,w):t},w.y0=function(P){return arguments.length?(t=typeof P=="function"?P:Ha(+P),w):t},w.y1=function(P){return arguments.length?(r=P==null?null:typeof P=="function"?P:Ha(+P),w):r},w.lineX0=w.lineY0=function(){return A().x(e).y(t)},w.lineY1=function(){return A().x(e).y(r)},w.lineX1=function(){return A().x(n).y(t)},w.defined=function(P){return arguments.length?(a=typeof P=="function"?P:Ha(!!P),w):a},w.curve=function(P){return arguments.length?(f=P,c!=null&&(i=f(c)),w):f},w.context=function(P){return arguments.length?(P==null?c=i=null:i=f(c=P),w):c},w}class vJ{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function x2e(e){return new vJ(e,!0)}function _2e(e){return new vJ(e,!1)}const ML={draw(e,t){const r=ef(t/uT);e.moveTo(r,0),e.arc(0,0,r,0,eN)}},b2e={draw(e,t){const r=ef(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},xJ=ef(1/3),w2e=xJ*2,S2e={draw(e,t){const r=ef(t/w2e),n=r*xJ;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},A2e={draw(e,t){const r=ef(t),n=-r/2;e.rect(n,n,r,r)}},T2e=.8908130915292852,_J=cT(uT/10)/cT(7*uT/10),P2e=cT(eN/10)*_J,N2e=-hJ(eN/10)*_J,j2e={draw(e,t){const r=ef(t*T2e),n=P2e*r,a=N2e*r;e.moveTo(0,-r),e.lineTo(n,a);for(let c=1;c<5;++c){const f=eN*c/5,i=hJ(f),x=cT(f);e.lineTo(x*r,-i*r),e.lineTo(i*n-x*a,x*n+i*a)}e.closePath()}},qk=ef(3),C2e={draw(e,t){const r=-ef(t/(qk*3));e.moveTo(0,r*2),e.lineTo(-qk*r,-r),e.lineTo(qk*r,-r),e.closePath()}},Ad=-.5,Td=ef(3)/2,QR=1/ef(12),k2e=(QR/2+1)*3,E2e={draw(e,t){const r=ef(t/k2e),n=r/2,a=r*QR,c=n,f=r*QR+r,i=-c,x=f;e.moveTo(n,a),e.lineTo(c,f),e.lineTo(i,x),e.lineTo(Ad*n-Td*a,Td*n+Ad*a),e.lineTo(Ad*c-Td*f,Td*c+Ad*f),e.lineTo(Ad*i-Td*x,Td*i+Ad*x),e.lineTo(Ad*n+Td*a,Ad*a-Td*n),e.lineTo(Ad*c+Td*f,Ad*f-Td*c),e.lineTo(Ad*i+Td*x,Ad*x-Td*i),e.closePath()}};function M2e(e,t){let r=null,n=kL(a);e=typeof e=="function"?e:Ha(e||ML),t=typeof t=="function"?t:Ha(t===void 0?64:+t);function a(){let c;if(r||(r=c=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),c)return r=null,c+""||null}return a.type=function(c){return arguments.length?(e=typeof c=="function"?c:Ha(c),a):e},a.size=function(c){return arguments.length?(t=typeof c=="function"?c:Ha(+c),a):t},a.context=function(c){return arguments.length?(r=c??null,a):r},a}function dT(){}function hT(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function bJ(e){this._context=e}bJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:hT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:hT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function O2e(e){return new bJ(e)}function wJ(e){this._context=e}wJ.prototype={areaStart:dT,areaEnd:dT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:hT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function R2e(e){return new wJ(e)}function SJ(e){this._context=e}SJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:hT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function I2e(e){return new SJ(e)}function AJ(e){this._context=e}AJ.prototype={areaStart:dT,areaEnd:dT,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function D2e(e){return new AJ(e)}function P$(e){return e<0?-1:1}function N$(e,t,r){var n=e._x1-e._x0,a=t-e._x1,c=(e._y1-e._y0)/(n||a<0&&-0),f=(r-e._y1)/(a||n<0&&-0),i=(c*a+f*n)/(n+a);return(P$(c)+P$(f))*Math.min(Math.abs(c),Math.abs(f),.5*Math.abs(i))||0}function j$(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Gk(e,t,r){var n=e._x0,a=e._y0,c=e._x1,f=e._y1,i=(c-n)/3;e._context.bezierCurveTo(n+i,a+i*t,c-i,f-i*r,c,f)}function fT(e){this._context=e}fT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Gk(this,this._t0,j$(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Gk(this,j$(this,r=N$(this,e,t)),r);break;default:Gk(this,this._t0,r=N$(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function TJ(e){this._context=new PJ(e)}(TJ.prototype=Object.create(fT.prototype)).point=function(e,t){fT.prototype.point.call(this,t,e)};function PJ(e){this._context=e}PJ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,c){this._context.bezierCurveTo(t,e,n,r,c,a)}};function L2e(e){return new fT(e)}function z2e(e){return new TJ(e)}function NJ(e){this._context=e}NJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=C$(e),a=C$(t),c=0,f=1;f<r;++c,++f)this._context.bezierCurveTo(n[0][c],a[0][c],n[1][c],a[1][c],e[f],t[f]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function C$(e){var t,r=e.length-1,n,a=new Array(r),c=new Array(r),f=new Array(r);for(a[0]=0,c[0]=2,f[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,c[t]=4,f[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,c[r-1]=7,f[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/c[t-1],c[t]-=n,f[t]-=n*f[t-1];for(a[r-1]=f[r-1]/c[r-1],t=r-2;t>=0;--t)a[t]=(f[t]-a[t+1])/c[t];for(c[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)c[t]=2*e[t+1]-a[t+1];return[a,c]}function F2e(e){return new NJ(e)}function rN(e,t){this._context=e,this._t=t}rN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function B2e(e){return new rN(e,.5)}function V2e(e){return new rN(e,0)}function U2e(e){return new rN(e,1)}function Rx(e,t){if((f=e.length)>1)for(var r=1,n,a,c=e[t[0]],f,i=c.length;r<f;++r)for(a=c,c=e[t[r]],n=0;n<i;++n)c[n][1]+=c[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function eI(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function $2e(e,t){return e[t]}function q2e(e){const t=[];return t.key=e,t}function G2e(){var e=Ha([]),t=eI,r=Rx,n=$2e;function a(c){var f=Array.from(e.apply(this,arguments),q2e),i,x=f.length,w=-1,A;for(const P of c)for(i=0,++w;i<x;++i)(f[i][w]=[0,+n(P,f[i].key,w,c)]).data=P;for(i=0,A=EL(t(f));i<x;++i)f[A[i]].index=i;return r(f,A),f}return a.keys=function(c){return arguments.length?(e=typeof c=="function"?c:Ha(Array.from(c)),a):e},a.value=function(c){return arguments.length?(n=typeof c=="function"?c:Ha(+c),a):n},a.order=function(c){return arguments.length?(t=c==null?eI:typeof c=="function"?c:Ha(Array.from(c)),a):t},a.offset=function(c){return arguments.length?(r=c??Rx,a):r},a}function W2e(e,t){if((n=e.length)>0){for(var r,n,a=0,c=e[0].length,f;a<c;++a){for(f=r=0;r<n;++r)f+=e[r][a][1]||0;if(f)for(r=0;r<n;++r)e[r][a][1]/=f}Rx(e,t)}}function H2e(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,c=n.length;r<c;++r){for(var f=0,i=0;f<a;++f)i+=e[f][r][1]||0;n[r][1]+=n[r][0]=-i/2}Rx(e,t)}}function K2e(e,t){if(!(!((f=e.length)>0)||!((c=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,c,f;n<c;++n){for(var i=0,x=0,w=0;i<f;++i){for(var A=e[t[i]],P=A[n][1]||0,E=A[n-1][1]||0,D=(P-E)/2,V=0;V<i;++V){var L=e[t[V]],$=L[n][1]||0,H=L[n-1][1]||0;D+=$-H}x+=P,w+=D*P}a[n-1][1]+=a[n-1][0]=r,x&&(r-=w/x)}a[n-1][1]+=a[n-1][0]=r,Rx(e,t)}}function Q1(e){"@babel/helpers - typeof";return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q1(e)}var Z2e=["type","size","sizeType"];function tI(){return tI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tI.apply(this,arguments)}function k$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k$(Object(r),!0).forEach(function(n){Y2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y2e(e,t,r){return t=X2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X2e(e){var t=J2e(e,"string");return Q1(t)=="symbol"?t:t+""}function J2e(e,t){if(Q1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Q1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q2e(e,t){if(e==null)return{};var r=eSe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function eSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var jJ={symbolCircle:ML,symbolCross:b2e,symbolDiamond:S2e,symbolSquare:A2e,symbolStar:j2e,symbolTriangle:C2e,symbolWye:E2e},tSe=Math.PI/180,rSe=function(t){var r="symbol".concat(QP(t));return jJ[r]||ML},nSe=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*tSe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},iSe=function(t,r){jJ["symbol".concat(QP(t))]=r},nN=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,c=a===void 0?64:a,f=t.sizeType,i=f===void 0?"area":f,x=Q2e(t,Z2e),w=E$(E$({},x),{},{type:n,size:c,sizeType:i}),A=function(){var $=rSe(n),H=M2e().type($).size(nSe(c,i,n));return H()},P=w.className,E=w.cx,D=w.cy,V=vn(w,!0);return E===+E&&D===+D&&c===+c?Oe.createElement("path",tI({},V,{className:fi("recharts-symbols",P),transform:"translate(".concat(E,", ").concat(D,")"),d:A()})):null};nN.registerSymbol=iSe;function Ix(e){"@babel/helpers - typeof";return Ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ix(e)}function rI(){return rI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rI.apply(this,arguments)}function M$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aSe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M$(Object(r),!0).forEach(function(n){ew(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sSe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oSe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,kJ(n.key),n)}}function lSe(e,t,r){return t&&oSe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cSe(e,t,r){return t=pT(t),uSe(e,CJ()?Reflect.construct(t,r||[],pT(e).constructor):t.apply(e,r))}function uSe(e,t){if(t&&(Ix(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dSe(e)}function dSe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CJ=function(){return!!e})()}function pT(e){return pT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pT(e)}function hSe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nI(e,t)}function nI(e,t){return nI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},nI(e,t)}function ew(e,t,r){return t=kJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kJ(e){var t=fSe(e,"string");return Ix(t)=="symbol"?t:t+""}function fSe(e,t){if(Ix(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ix(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Eh=32,OL=function(e){function t(){return sSe(this,t),cSe(this,t,arguments)}return hSe(t,e),lSe(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,c=Eh/2,f=Eh/6,i=Eh/3,x=n.inactive?a:n.color;if(n.type==="plainline")return Oe.createElement("line",{strokeWidth:4,fill:"none",stroke:x,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:c,x2:Eh,y2:c,className:"recharts-legend-icon"});if(n.type==="line")return Oe.createElement("path",{strokeWidth:4,fill:"none",stroke:x,d:"M0,".concat(c,"h").concat(i,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(2*i,",").concat(c,`
            H`).concat(Eh,"M").concat(2*i,",").concat(c,`
            A`).concat(f,",").concat(f,",0,1,1,").concat(i,",").concat(c),className:"recharts-legend-icon"});if(n.type==="rect")return Oe.createElement("path",{stroke:"none",fill:x,d:"M0,".concat(Eh/8,"h").concat(Eh,"v").concat(Eh*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(Oe.isValidElement(n.legendIcon)){var w=aSe({},n);return delete w.legendIcon,Oe.cloneElement(n.legendIcon,w)}return Oe.createElement(nN,{fill:x,cx:c,cy:c,size:Eh,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,c=a.payload,f=a.iconSize,i=a.layout,x=a.formatter,w=a.inactiveColor,A={x:0,y:0,width:Eh,height:Eh},P={display:i==="horizontal"?"inline-block":"block",marginRight:10},E={display:"inline-block",verticalAlign:"middle",marginRight:4};return c.map(function(D,V){var L=D.formatter||x,$=fi(ew(ew({"recharts-legend-item":!0},"legend-item-".concat(V),!0),"inactive",D.inactive));if(D.type==="none")return null;var H=qn(D.value)?null:D.value;Vh(!qn(D.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var K=D.inactive?w:D.color;return Oe.createElement("li",rI({className:$,style:P,key:"legend-item-".concat(V)},ap(n.props,D,V)),Oe.createElement(ZR,{width:f,height:f,viewBox:A,style:E},n.renderIcon(D)),Oe.createElement("span",{className:"recharts-legend-item-text",style:{color:K}},L?L(H,D,V):H))})}},{key:"render",value:function(){var n=this.props,a=n.payload,c=n.layout,f=n.align;if(!a||!a.length)return null;var i={padding:0,margin:0,textAlign:c==="horizontal"?f:"left"};return Oe.createElement("ul",{className:"recharts-default-legend",style:i},this.renderItems())}}])}(W.PureComponent);ew(OL,"displayName","Legend");ew(OL,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Wk,O$;function pSe(){if(O$)return Wk;O$=1;var e=YP();function t(){this.__data__=new e,this.size=0}return Wk=t,Wk}var Hk,R$;function mSe(){if(R$)return Hk;R$=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return Hk=e,Hk}var Kk,I$;function gSe(){if(I$)return Kk;I$=1;function e(t){return this.__data__.get(t)}return Kk=e,Kk}var Zk,D$;function ySe(){if(D$)return Zk;D$=1;function e(t){return this.__data__.has(t)}return Zk=e,Zk}var Yk,L$;function vSe(){if(L$)return Yk;L$=1;var e=YP(),t=AL(),r=TL(),n=200;function a(c,f){var i=this.__data__;if(i instanceof e){var x=i.__data__;if(!t||x.length<n-1)return x.push([c,f]),this.size=++i.size,this;i=this.__data__=new r(x)}return i.set(c,f),this.size=i.size,this}return Yk=a,Yk}var Xk,z$;function EJ(){if(z$)return Xk;z$=1;var e=YP(),t=pSe(),r=mSe(),n=gSe(),a=ySe(),c=vSe();function f(i){var x=this.__data__=new e(i);this.size=x.size}return f.prototype.clear=t,f.prototype.delete=r,f.prototype.get=n,f.prototype.has=a,f.prototype.set=c,Xk=f,Xk}var Jk,F$;function xSe(){if(F$)return Jk;F$=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return Jk=t,Jk}var Qk,B$;function _Se(){if(B$)return Qk;B$=1;function e(t){return this.__data__.has(t)}return Qk=e,Qk}var eE,V$;function MJ(){if(V$)return eE;V$=1;var e=TL(),t=xSe(),r=_Se();function n(a){var c=-1,f=a==null?0:a.length;for(this.__data__=new e;++c<f;)this.add(a[c])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,eE=n,eE}var tE,U$;function OJ(){if(U$)return tE;U$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(t[n],n,t))return!0;return!1}return tE=e,tE}var rE,$$;function RJ(){if($$)return rE;$$=1;function e(t,r){return t.has(r)}return rE=e,rE}var nE,q$;function IJ(){if(q$)return nE;q$=1;var e=MJ(),t=OJ(),r=RJ(),n=1,a=2;function c(f,i,x,w,A,P){var E=x&n,D=f.length,V=i.length;if(D!=V&&!(E&&V>D))return!1;var L=P.get(f),$=P.get(i);if(L&&$)return L==i&&$==f;var H=-1,K=!0,Q=x&a?new e:void 0;for(P.set(f,i),P.set(i,f);++H<D;){var ae=f[H],ee=i[H];if(w)var se=E?w(ee,ae,H,i,f,P):w(ae,ee,H,f,i,P);if(se!==void 0){if(se)continue;K=!1;break}if(Q){if(!t(i,function(ce,he){if(!r(Q,he)&&(ae===ce||A(ae,ce,x,w,P)))return Q.push(he)})){K=!1;break}}else if(!(ae===ee||A(ae,ee,x,w,P))){K=!1;break}}return P.delete(f),P.delete(i),K}return nE=c,nE}var iE,G$;function bSe(){if(G$)return iE;G$=1;var e=dp(),t=e.Uint8Array;return iE=t,iE}var aE,W$;function wSe(){if(W$)return aE;W$=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a,c){n[++r]=[c,a]}),n}return aE=e,aE}var sE,H$;function RL(){if(H$)return sE;H$=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(a){n[++r]=a}),n}return sE=e,sE}var oE,K$;function SSe(){if(K$)return oE;K$=1;var e=o2(),t=bSe(),r=SL(),n=IJ(),a=wSe(),c=RL(),f=1,i=2,x="[object Boolean]",w="[object Date]",A="[object Error]",P="[object Map]",E="[object Number]",D="[object RegExp]",V="[object Set]",L="[object String]",$="[object Symbol]",H="[object ArrayBuffer]",K="[object DataView]",Q=e?e.prototype:void 0,ae=Q?Q.valueOf:void 0;function ee(se,ce,he,Pe,Ne,pe,je){switch(he){case K:if(se.byteLength!=ce.byteLength||se.byteOffset!=ce.byteOffset)return!1;se=se.buffer,ce=ce.buffer;case H:return!(se.byteLength!=ce.byteLength||!pe(new t(se),new t(ce)));case x:case w:case E:return r(+se,+ce);case A:return se.name==ce.name&&se.message==ce.message;case D:case L:return se==ce+"";case P:var xe=a;case V:var Ce=Pe&f;if(xe||(xe=c),se.size!=ce.size&&!Ce)return!1;var ze=je.get(se);if(ze)return ze==ce;Pe|=i,je.set(se,ce);var Te=n(xe(se),xe(ce),Pe,Ne,pe,je);return je.delete(se),Te;case $:if(ae)return ae.call(se)==ae.call(ce)}return!1}return oE=ee,oE}var lE,Z$;function DJ(){if(Z$)return lE;Z$=1;function e(t,r){for(var n=-1,a=r.length,c=t.length;++n<a;)t[c+n]=r[n];return t}return lE=e,lE}var cE,Y$;function ASe(){if(Y$)return cE;Y$=1;var e=DJ(),t=Jc();function r(n,a,c){var f=a(n);return t(n)?f:e(f,c(n))}return cE=r,cE}var uE,X$;function TSe(){if(X$)return uE;X$=1;function e(t,r){for(var n=-1,a=t==null?0:t.length,c=0,f=[];++n<a;){var i=t[n];r(i,n,t)&&(f[c++]=i)}return f}return uE=e,uE}var dE,J$;function PSe(){if(J$)return dE;J$=1;function e(){return[]}return dE=e,dE}var hE,Q$;function NSe(){if(Q$)return hE;Q$=1;var e=TSe(),t=PSe(),r=Object.prototype,n=r.propertyIsEnumerable,a=Object.getOwnPropertySymbols,c=a?function(f){return f==null?[]:(f=Object(f),e(a(f),function(i){return n.call(f,i)}))}:t;return hE=c,hE}var fE,e8;function jSe(){if(e8)return fE;e8=1;function e(t,r){for(var n=-1,a=Array(t);++n<t;)a[n]=r(n);return a}return fE=e,fE}var pE,t8;function CSe(){if(t8)return pE;t8=1;var e=Nm(),t=jm(),r="[object Arguments]";function n(a){return t(a)&&e(a)==r}return pE=n,pE}var mE,r8;function IL(){if(r8)return mE;r8=1;var e=CSe(),t=jm(),r=Object.prototype,n=r.hasOwnProperty,a=r.propertyIsEnumerable,c=e(function(){return arguments}())?e:function(f){return t(f)&&n.call(f,"callee")&&!a.call(f,"callee")};return mE=c,mE}var i1={exports:{}},gE,n8;function kSe(){if(n8)return gE;n8=1;function e(){return!1}return gE=e,gE}i1.exports;var i8;function LJ(){return i8||(i8=1,function(e,t){var r=dp(),n=kSe(),a=t&&!t.nodeType&&t,c=a&&!0&&e&&!e.nodeType&&e,f=c&&c.exports===a,i=f?r.Buffer:void 0,x=i?i.isBuffer:void 0,w=x||n;e.exports=w}(i1,i1.exports)),i1.exports}var yE,a8;function DL(){if(a8)return yE;a8=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,a){var c=typeof n;return a=a??e,!!a&&(c=="number"||c!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<a}return yE=r,yE}var vE,s8;function LL(){if(s8)return vE;s8=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return vE=t,vE}var xE,o8;function ESe(){if(o8)return xE;o8=1;var e=Nm(),t=LL(),r=jm(),n="[object Arguments]",a="[object Array]",c="[object Boolean]",f="[object Date]",i="[object Error]",x="[object Function]",w="[object Map]",A="[object Number]",P="[object Object]",E="[object RegExp]",D="[object Set]",V="[object String]",L="[object WeakMap]",$="[object ArrayBuffer]",H="[object DataView]",K="[object Float32Array]",Q="[object Float64Array]",ae="[object Int8Array]",ee="[object Int16Array]",se="[object Int32Array]",ce="[object Uint8Array]",he="[object Uint8ClampedArray]",Pe="[object Uint16Array]",Ne="[object Uint32Array]",pe={};pe[K]=pe[Q]=pe[ae]=pe[ee]=pe[se]=pe[ce]=pe[he]=pe[Pe]=pe[Ne]=!0,pe[n]=pe[a]=pe[$]=pe[c]=pe[H]=pe[f]=pe[i]=pe[x]=pe[w]=pe[A]=pe[P]=pe[E]=pe[D]=pe[V]=pe[L]=!1;function je(xe){return r(xe)&&t(xe.length)&&!!pe[e(xe)]}return xE=je,xE}var _E,l8;function zJ(){if(l8)return _E;l8=1;function e(t){return function(r){return t(r)}}return _E=e,_E}var a1={exports:{}};a1.exports;var c8;function MSe(){return c8||(c8=1,function(e,t){var r=nJ(),n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,c=a&&a.exports===n,f=c&&r.process,i=function(){try{var x=a&&a.require&&a.require("util").types;return x||f&&f.binding&&f.binding("util")}catch{}}();e.exports=i}(a1,a1.exports)),a1.exports}var bE,u8;function FJ(){if(u8)return bE;u8=1;var e=ESe(),t=zJ(),r=MSe(),n=r&&r.isTypedArray,a=n?t(n):e;return bE=a,bE}var wE,d8;function OSe(){if(d8)return wE;d8=1;var e=jSe(),t=IL(),r=Jc(),n=LJ(),a=DL(),c=FJ(),f=Object.prototype,i=f.hasOwnProperty;function x(w,A){var P=r(w),E=!P&&t(w),D=!P&&!E&&n(w),V=!P&&!E&&!D&&c(w),L=P||E||D||V,$=L?e(w.length,String):[],H=$.length;for(var K in w)(A||i.call(w,K))&&!(L&&(K=="length"||D&&(K=="offset"||K=="parent")||V&&(K=="buffer"||K=="byteLength"||K=="byteOffset")||a(K,H)))&&$.push(K);return $}return wE=x,wE}var SE,h8;function RSe(){if(h8)return SE;h8=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||e;return r===a}return SE=t,SE}var AE,f8;function BJ(){if(f8)return AE;f8=1;function e(t,r){return function(n){return t(r(n))}}return AE=e,AE}var TE,p8;function ISe(){if(p8)return TE;p8=1;var e=BJ(),t=e(Object.keys,Object);return TE=t,TE}var PE,m8;function DSe(){if(m8)return PE;m8=1;var e=RSe(),t=ISe(),r=Object.prototype,n=r.hasOwnProperty;function a(c){if(!e(c))return t(c);var f=[];for(var i in Object(c))n.call(c,i)&&i!="constructor"&&f.push(i);return f}return PE=a,PE}var NE,g8;function c2(){if(g8)return NE;g8=1;var e=wL(),t=LL();function r(n){return n!=null&&t(n.length)&&!e(n)}return NE=r,NE}var jE,y8;function iN(){if(y8)return jE;y8=1;var e=OSe(),t=DSe(),r=c2();function n(a){return r(a)?e(a):t(a)}return jE=n,jE}var CE,v8;function LSe(){if(v8)return CE;v8=1;var e=ASe(),t=NSe(),r=iN();function n(a){return e(a,r,t)}return CE=n,CE}var kE,x8;function zSe(){if(x8)return kE;x8=1;var e=LSe(),t=1,r=Object.prototype,n=r.hasOwnProperty;function a(c,f,i,x,w,A){var P=i&t,E=e(c),D=E.length,V=e(f),L=V.length;if(D!=L&&!P)return!1;for(var $=D;$--;){var H=E[$];if(!(P?H in f:n.call(f,H)))return!1}var K=A.get(c),Q=A.get(f);if(K&&Q)return K==f&&Q==c;var ae=!0;A.set(c,f),A.set(f,c);for(var ee=P;++$<D;){H=E[$];var se=c[H],ce=f[H];if(x)var he=P?x(ce,se,H,f,c,A):x(se,ce,H,c,f,A);if(!(he===void 0?se===ce||w(se,ce,i,x,A):he)){ae=!1;break}ee||(ee=H=="constructor")}if(ae&&!ee){var Pe=c.constructor,Ne=f.constructor;Pe!=Ne&&"constructor"in c&&"constructor"in f&&!(typeof Pe=="function"&&Pe instanceof Pe&&typeof Ne=="function"&&Ne instanceof Ne)&&(ae=!1)}return A.delete(c),A.delete(f),ae}return kE=a,kE}var EE,_8;function FSe(){if(_8)return EE;_8=1;var e=rv(),t=dp(),r=e(t,"DataView");return EE=r,EE}var ME,b8;function BSe(){if(b8)return ME;b8=1;var e=rv(),t=dp(),r=e(t,"Promise");return ME=r,ME}var OE,w8;function VJ(){if(w8)return OE;w8=1;var e=rv(),t=dp(),r=e(t,"Set");return OE=r,OE}var RE,S8;function VSe(){if(S8)return RE;S8=1;var e=rv(),t=dp(),r=e(t,"WeakMap");return RE=r,RE}var IE,A8;function USe(){if(A8)return IE;A8=1;var e=FSe(),t=AL(),r=BSe(),n=VJ(),a=VSe(),c=Nm(),f=iJ(),i="[object Map]",x="[object Object]",w="[object Promise]",A="[object Set]",P="[object WeakMap]",E="[object DataView]",D=f(e),V=f(t),L=f(r),$=f(n),H=f(a),K=c;return(e&&K(new e(new ArrayBuffer(1)))!=E||t&&K(new t)!=i||r&&K(r.resolve())!=w||n&&K(new n)!=A||a&&K(new a)!=P)&&(K=function(Q){var ae=c(Q),ee=ae==x?Q.constructor:void 0,se=ee?f(ee):"";if(se)switch(se){case D:return E;case V:return i;case L:return w;case $:return A;case H:return P}return ae}),IE=K,IE}var DE,T8;function $Se(){if(T8)return DE;T8=1;var e=EJ(),t=IJ(),r=SSe(),n=zSe(),a=USe(),c=Jc(),f=LJ(),i=FJ(),x=1,w="[object Arguments]",A="[object Array]",P="[object Object]",E=Object.prototype,D=E.hasOwnProperty;function V(L,$,H,K,Q,ae){var ee=c(L),se=c($),ce=ee?A:a(L),he=se?A:a($);ce=ce==w?P:ce,he=he==w?P:he;var Pe=ce==P,Ne=he==P,pe=ce==he;if(pe&&f(L)){if(!f($))return!1;ee=!0,Pe=!1}if(pe&&!Pe)return ae||(ae=new e),ee||i(L)?t(L,$,H,K,Q,ae):r(L,$,ce,H,K,Q,ae);if(!(H&x)){var je=Pe&&D.call(L,"__wrapped__"),xe=Ne&&D.call($,"__wrapped__");if(je||xe){var Ce=je?L.value():L,ze=xe?$.value():$;return ae||(ae=new e),Q(Ce,ze,H,K,ae)}}return pe?(ae||(ae=new e),n(L,$,H,K,Q,ae)):!1}return DE=V,DE}var LE,P8;function zL(){if(P8)return LE;P8=1;var e=$Se(),t=jm();function r(n,a,c,f,i){return n===a?!0:n==null||a==null||!t(n)&&!t(a)?n!==n&&a!==a:e(n,a,c,f,r,i)}return LE=r,LE}var zE,N8;function qSe(){if(N8)return zE;N8=1;var e=EJ(),t=zL(),r=1,n=2;function a(c,f,i,x){var w=i.length,A=w,P=!x;if(c==null)return!A;for(c=Object(c);w--;){var E=i[w];if(P&&E[2]?E[1]!==c[E[0]]:!(E[0]in c))return!1}for(;++w<A;){E=i[w];var D=E[0],V=c[D],L=E[1];if(P&&E[2]){if(V===void 0&&!(D in c))return!1}else{var $=new e;if(x)var H=x(V,L,D,c,f,$);if(!(H===void 0?t(L,V,r|n,x,$):H))return!1}}return!0}return zE=a,zE}var FE,j8;function UJ(){if(j8)return FE;j8=1;var e=uy();function t(r){return r===r&&!e(r)}return FE=t,FE}var BE,C8;function GSe(){if(C8)return BE;C8=1;var e=UJ(),t=iN();function r(n){for(var a=t(n),c=a.length;c--;){var f=a[c],i=n[f];a[c]=[f,i,e(i)]}return a}return BE=r,BE}var VE,k8;function $J(){if(k8)return VE;k8=1;function e(t,r){return function(n){return n==null?!1:n[t]===r&&(r!==void 0||t in Object(n))}}return VE=e,VE}var UE,E8;function WSe(){if(E8)return UE;E8=1;var e=qSe(),t=GSe(),r=$J();function n(a){var c=t(a);return c.length==1&&c[0][2]?r(c[0][0],c[0][1]):function(f){return f===a||e(f,a,c)}}return UE=n,UE}var $E,M8;function HSe(){if(M8)return $E;M8=1;function e(t,r){return t!=null&&r in Object(t)}return $E=e,$E}var qE,O8;function KSe(){if(O8)return qE;O8=1;var e=oJ(),t=IL(),r=Jc(),n=DL(),a=LL(),c=JP();function f(i,x,w){x=e(x,i);for(var A=-1,P=x.length,E=!1;++A<P;){var D=c(x[A]);if(!(E=i!=null&&w(i,D)))break;i=i[D]}return E||++A!=P?E:(P=i==null?0:i.length,!!P&&a(P)&&n(D,P)&&(r(i)||t(i)))}return qE=f,qE}var GE,R8;function ZSe(){if(R8)return GE;R8=1;var e=HSe(),t=KSe();function r(n,a){return n!=null&&t(n,a,e)}return GE=r,GE}var WE,I8;function YSe(){if(I8)return WE;I8=1;var e=zL(),t=lJ(),r=ZSe(),n=bL(),a=UJ(),c=$J(),f=JP(),i=1,x=2;function w(A,P){return n(A)&&a(P)?c(f(A),P):function(E){var D=t(E,A);return D===void 0&&D===P?r(E,A):e(P,D,i|x)}}return WE=w,WE}var HE,D8;function E_(){if(D8)return HE;D8=1;function e(t){return t}return HE=e,HE}var KE,L8;function XSe(){if(L8)return KE;L8=1;function e(t){return function(r){return r==null?void 0:r[t]}}return KE=e,KE}var ZE,z8;function JSe(){if(z8)return ZE;z8=1;var e=NL();function t(r){return function(n){return e(n,r)}}return ZE=t,ZE}var YE,F8;function QSe(){if(F8)return YE;F8=1;var e=XSe(),t=JSe(),r=bL(),n=JP();function a(c){return r(c)?e(n(c)):t(c)}return YE=a,YE}var XE,B8;function hp(){if(B8)return XE;B8=1;var e=WSe(),t=YSe(),r=E_(),n=Jc(),a=QSe();function c(f){return typeof f=="function"?f:f==null?r:typeof f=="object"?n(f)?t(f[0],f[1]):e(f):a(f)}return XE=c,XE}var JE,V8;function qJ(){if(V8)return JE;V8=1;function e(t,r,n,a){for(var c=t.length,f=n+(a?1:-1);a?f--:++f<c;)if(r(t[f],f,t))return f;return-1}return JE=e,JE}var QE,U8;function eAe(){if(U8)return QE;U8=1;function e(t){return t!==t}return QE=e,QE}var eM,$8;function tAe(){if($8)return eM;$8=1;function e(t,r,n){for(var a=n-1,c=t.length;++a<c;)if(t[a]===r)return a;return-1}return eM=e,eM}var tM,q8;function rAe(){if(q8)return tM;q8=1;var e=qJ(),t=eAe(),r=tAe();function n(a,c,f){return c===c?r(a,c,f):e(a,t,f)}return tM=n,tM}var rM,G8;function nAe(){if(G8)return rM;G8=1;var e=rAe();function t(r,n){var a=r==null?0:r.length;return!!a&&e(r,n,0)>-1}return rM=t,rM}var nM,W8;function iAe(){if(W8)return nM;W8=1;function e(t,r,n){for(var a=-1,c=t==null?0:t.length;++a<c;)if(n(r,t[a]))return!0;return!1}return nM=e,nM}var iM,H8;function aAe(){if(H8)return iM;H8=1;function e(){}return iM=e,iM}var aM,K8;function sAe(){if(K8)return aM;K8=1;var e=VJ(),t=aAe(),r=RL(),n=1/0,a=e&&1/r(new e([,-0]))[1]==n?function(c){return new e(c)}:t;return aM=a,aM}var sM,Z8;function oAe(){if(Z8)return sM;Z8=1;var e=MJ(),t=nAe(),r=iAe(),n=RJ(),a=sAe(),c=RL(),f=200;function i(x,w,A){var P=-1,E=t,D=x.length,V=!0,L=[],$=L;if(A)V=!1,E=r;else if(D>=f){var H=w?null:a(x);if(H)return c(H);V=!1,E=n,$=new e}else $=w?[]:L;e:for(;++P<D;){var K=x[P],Q=w?w(K):K;if(K=A||K!==0?K:0,V&&Q===Q){for(var ae=$.length;ae--;)if($[ae]===Q)continue e;w&&$.push(Q),L.push(K)}else E($,Q,A)||($!==L&&$.push(Q),L.push(K))}return L}return sM=i,sM}var oM,Y8;function lAe(){if(Y8)return oM;Y8=1;var e=hp(),t=oAe();function r(n,a){return n&&n.length?t(n,e(a,2)):[]}return oM=r,oM}var cAe=lAe();const X8=la(cAe);function GJ(e,t,r){return t===!0?X8(e,r):qn(t)?X8(e,t):e}function Dx(e){"@babel/helpers - typeof";return Dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dx(e)}var uAe=["ref"];function J8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J8(Object(r),!0).forEach(function(n){aN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HJ(n.key),n)}}function hAe(e,t,r){return t&&Q8(e.prototype,t),r&&Q8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fAe(e,t,r){return t=mT(t),pAe(e,WJ()?Reflect.construct(t,r||[],mT(e).constructor):t.apply(e,r))}function pAe(e,t){if(t&&(Dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return mAe(e)}function mAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WJ=function(){return!!e})()}function mT(e){return mT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mT(e)}function gAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iI(e,t)}function iI(e,t){return iI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},iI(e,t)}function aN(e,t,r){return t=HJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HJ(e){var t=yAe(e,"string");return Dx(t)=="symbol"?t:t+""}function yAe(e,t){if(Dx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function vAe(e,t){if(e==null)return{};var r=xAe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xAe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _Ae(e){return e.value}function bAe(e,t){if(Oe.isValidElement(e))return Oe.cloneElement(e,t);if(typeof e=="function")return Oe.createElement(e,t);t.ref;var r=vAe(t,uAe);return Oe.createElement(OL,r)}var e7=1,Yf=function(e){function t(){var r;dAe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=fAe(this,t,[].concat(a)),aN(r,"lastBoundingBox",{width:-1,height:-1}),r}return gAe(t,e),hAe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>e7||Math.abs(a.height-this.lastBoundingBox.height)>e7)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?rm({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,c=a.layout,f=a.align,i=a.verticalAlign,x=a.margin,w=a.chartWidth,A=a.chartHeight,P,E;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(f==="center"&&c==="vertical"){var D=this.getBBoxSnapshot();P={left:((w||0)-D.width)/2}}else P=f==="right"?{right:x&&x.right||0}:{left:x&&x.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(i==="middle"){var V=this.getBBoxSnapshot();E={top:((A||0)-V.height)/2}}else E=i==="bottom"?{bottom:x&&x.bottom||0}:{top:x&&x.top||0};return rm(rm({},P),E)}},{key:"render",value:function(){var n=this,a=this.props,c=a.content,f=a.width,i=a.height,x=a.wrapperStyle,w=a.payloadUniqBy,A=a.payload,P=rm(rm({position:"absolute",width:f||"auto",height:i||"auto"},this.getDefaultPosition(x)),x);return Oe.createElement("div",{className:"recharts-legend-wrapper",style:P,ref:function(D){n.wrapperNode=D}},bAe(c,rm(rm({},this.props),{},{payload:GJ(A,w,_Ae)})))}}],[{key:"getWithHeight",value:function(n,a){var c=rm(rm({},this.defaultProps),n.props),f=c.layout;return f==="vertical"&&zr(n.props.height)?{height:n.props.height}:f==="horizontal"?{width:n.props.width||a}:null}}])}(W.PureComponent);aN(Yf,"displayName","Legend");aN(Yf,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var lM,t7;function wAe(){if(t7)return lM;t7=1;var e=o2(),t=IL(),r=Jc(),n=e?e.isConcatSpreadable:void 0;function a(c){return r(c)||t(c)||!!(n&&c&&c[n])}return lM=a,lM}var cM,r7;function KJ(){if(r7)return cM;r7=1;var e=DJ(),t=wAe();function r(n,a,c,f,i){var x=-1,w=n.length;for(c||(c=t),i||(i=[]);++x<w;){var A=n[x];a>0&&c(A)?a>1?r(A,a-1,c,f,i):e(i,A):f||(i[i.length]=A)}return i}return cM=r,cM}var uM,n7;function SAe(){if(n7)return uM;n7=1;function e(t){return function(r,n,a){for(var c=-1,f=Object(r),i=a(r),x=i.length;x--;){var w=i[t?x:++c];if(n(f[w],w,f)===!1)break}return r}}return uM=e,uM}var dM,i7;function AAe(){if(i7)return dM;i7=1;var e=SAe(),t=e();return dM=t,dM}var hM,a7;function ZJ(){if(a7)return hM;a7=1;var e=AAe(),t=iN();function r(n,a){return n&&e(n,a,t)}return hM=r,hM}var fM,s7;function TAe(){if(s7)return fM;s7=1;var e=c2();function t(r,n){return function(a,c){if(a==null)return a;if(!e(a))return r(a,c);for(var f=a.length,i=n?f:-1,x=Object(a);(n?i--:++i<f)&&c(x[i],i,x)!==!1;);return a}}return fM=t,fM}var pM,o7;function FL(){if(o7)return pM;o7=1;var e=ZJ(),t=TAe(),r=t(e);return pM=r,pM}var mM,l7;function YJ(){if(l7)return mM;l7=1;var e=FL(),t=c2();function r(n,a){var c=-1,f=t(n)?Array(n.length):[];return e(n,function(i,x,w){f[++c]=a(i,x,w)}),f}return mM=r,mM}var gM,c7;function PAe(){if(c7)return gM;c7=1;function e(t,r){var n=t.length;for(t.sort(r);n--;)t[n]=t[n].value;return t}return gM=e,gM}var yM,u7;function NAe(){if(u7)return yM;u7=1;var e=j_();function t(r,n){if(r!==n){var a=r!==void 0,c=r===null,f=r===r,i=e(r),x=n!==void 0,w=n===null,A=n===n,P=e(n);if(!w&&!P&&!i&&r>n||i&&x&&A&&!w&&!P||c&&x&&A||!a&&A||!f)return 1;if(!c&&!i&&!P&&r<n||P&&a&&f&&!c&&!i||w&&a&&f||!x&&f||!A)return-1}return 0}return yM=t,yM}var vM,d7;function jAe(){if(d7)return vM;d7=1;var e=NAe();function t(r,n,a){for(var c=-1,f=r.criteria,i=n.criteria,x=f.length,w=a.length;++c<x;){var A=e(f[c],i[c]);if(A){if(c>=w)return A;var P=a[c];return A*(P=="desc"?-1:1)}}return r.index-n.index}return vM=t,vM}var xM,h7;function CAe(){if(h7)return xM;h7=1;var e=PL(),t=NL(),r=hp(),n=YJ(),a=PAe(),c=zJ(),f=jAe(),i=E_(),x=Jc();function w(A,P,E){P.length?P=e(P,function(L){return x(L)?function($){return t($,L.length===1?L[0]:L)}:L}):P=[i];var D=-1;P=e(P,c(r));var V=n(A,function(L,$,H){var K=e(P,function(Q){return Q(L)});return{criteria:K,index:++D,value:L}});return a(V,function(L,$){return f(L,$,E)})}return xM=w,xM}var _M,f7;function kAe(){if(f7)return _M;f7=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return _M=e,_M}var bM,p7;function EAe(){if(p7)return bM;p7=1;var e=kAe(),t=Math.max;function r(n,a,c){return a=t(a===void 0?n.length-1:a,0),function(){for(var f=arguments,i=-1,x=t(f.length-a,0),w=Array(x);++i<x;)w[i]=f[a+i];i=-1;for(var A=Array(a+1);++i<a;)A[i]=f[i];return A[a]=c(w),e(n,this,A)}}return bM=r,bM}var wM,m7;function MAe(){if(m7)return wM;m7=1;function e(t){return function(){return t}}return wM=e,wM}var SM,g7;function XJ(){if(g7)return SM;g7=1;var e=rv(),t=function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}}();return SM=t,SM}var AM,y7;function OAe(){if(y7)return AM;y7=1;var e=MAe(),t=XJ(),r=E_(),n=t?function(a,c){return t(a,"toString",{configurable:!0,enumerable:!1,value:e(c),writable:!0})}:r;return AM=n,AM}var TM,v7;function RAe(){if(v7)return TM;v7=1;var e=800,t=16,r=Date.now;function n(a){var c=0,f=0;return function(){var i=r(),x=t-(i-f);if(f=i,x>0){if(++c>=e)return arguments[0]}else c=0;return a.apply(void 0,arguments)}}return TM=n,TM}var PM,x7;function IAe(){if(x7)return PM;x7=1;var e=OAe(),t=RAe(),r=t(e);return PM=r,PM}var NM,_7;function DAe(){if(_7)return NM;_7=1;var e=E_(),t=EAe(),r=IAe();function n(a,c){return r(t(a,c,e),a+"")}return NM=n,NM}var jM,b7;function sN(){if(b7)return jM;b7=1;var e=SL(),t=c2(),r=DL(),n=uy();function a(c,f,i){if(!n(i))return!1;var x=typeof f;return(x=="number"?t(i)&&r(f,i.length):x=="string"&&f in i)?e(i[f],c):!1}return jM=a,jM}var CM,w7;function LAe(){if(w7)return CM;w7=1;var e=KJ(),t=CAe(),r=DAe(),n=sN(),a=r(function(c,f){if(c==null)return[];var i=f.length;return i>1&&n(c,f[0],f[1])?f=[]:i>2&&n(f[0],f[1],f[2])&&(f=[f[0]]),t(c,e(f,1),[])});return CM=a,CM}var zAe=LAe();const BL=la(zAe);function tw(e){"@babel/helpers - typeof";return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tw(e)}function aI(){return aI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aI.apply(this,arguments)}function FAe(e,t){return $Ae(e)||UAe(e,t)||VAe(e,t)||BAe()}function BAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function VAe(e,t){if(e){if(typeof e=="string")return S7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S7(e,t)}}function S7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function UAe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function $Ae(e){if(Array.isArray(e))return e}function A7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A7(Object(r),!0).forEach(function(n){qAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qAe(e,t,r){return t=GAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GAe(e){var t=WAe(e,"string");return tw(t)=="symbol"?t:t+""}function WAe(e,t){if(tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HAe(e){return Array.isArray(e)&&Vo(e[0])&&Vo(e[1])?e.join(" ~ "):e}var KAe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,c=a===void 0?{}:a,f=t.itemStyle,i=f===void 0?{}:f,x=t.labelStyle,w=x===void 0?{}:x,A=t.payload,P=t.formatter,E=t.itemSorter,D=t.wrapperClassName,V=t.labelClassName,L=t.label,$=t.labelFormatter,H=t.accessibilityLayer,K=H===void 0?!1:H,Q=function(){if(A&&A.length){var je={padding:0,margin:0},xe=(E?BL(A,E):A).map(function(Ce,ze){if(Ce.type==="none")return null;var Te=kM({display:"block",paddingTop:4,paddingBottom:4,color:Ce.color||"#000"},i),Re=Ce.formatter||P||HAe,Fe=Ce.value,He=Ce.name,mt=Fe,Xe=He;if(Re&&mt!=null&&Xe!=null){var ot=Re(Fe,He,Ce,ze,A);if(Array.isArray(ot)){var qe=FAe(ot,2);mt=qe[0],Xe=qe[1]}else mt=ot}return Oe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ze),style:Te},Vo(Xe)?Oe.createElement("span",{className:"recharts-tooltip-item-name"},Xe):null,Vo(Xe)?Oe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Oe.createElement("span",{className:"recharts-tooltip-item-value"},mt),Oe.createElement("span",{className:"recharts-tooltip-item-unit"},Ce.unit||""))});return Oe.createElement("ul",{className:"recharts-tooltip-item-list",style:je},xe)}return null},ae=kM({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},c),ee=kM({margin:0},w),se=!Xn(L),ce=se?L:"",he=fi("recharts-default-tooltip",D),Pe=fi("recharts-tooltip-label",V);se&&$&&A!==void 0&&A!==null&&(ce=$(L,A));var Ne=K?{role:"status","aria-live":"assertive"}:{};return Oe.createElement("div",aI({className:he,style:ae},Ne),Oe.createElement("p",{className:Pe,style:ee},Oe.isValidElement(ce)?ce:"".concat(ce)),Q())};function rw(e){"@babel/helpers - typeof";return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(e)}function $S(e,t,r){return t=ZAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZAe(e){var t=YAe(e,"string");return rw(t)=="symbol"?t:t+""}function YAe(e,t){if(rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fb="recharts-tooltip-wrapper",XAe={visibility:"hidden"};function JAe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return fi(Fb,$S($S($S($S({},"".concat(Fb,"-right"),zr(r)&&t&&zr(t.x)&&r>=t.x),"".concat(Fb,"-left"),zr(r)&&t&&zr(t.x)&&r<t.x),"".concat(Fb,"-bottom"),zr(n)&&t&&zr(t.y)&&n>=t.y),"".concat(Fb,"-top"),zr(n)&&t&&zr(t.y)&&n<t.y))}function T7(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,c=e.position,f=e.reverseDirection,i=e.tooltipDimension,x=e.viewBox,w=e.viewBoxDimension;if(c&&zr(c[n]))return c[n];var A=r[n]-i-a,P=r[n]+a;if(t[n])return f[n]?A:P;if(f[n]){var E=A,D=x[n];return E<D?Math.max(P,x[n]):Math.max(A,x[n])}var V=P+i,L=x[n]+w;return V>L?Math.max(A,x[n]):Math.max(P,x[n])}function QAe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function eTe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,c=e.reverseDirection,f=e.tooltipBox,i=e.useTranslate3d,x=e.viewBox,w,A,P;return f.height>0&&f.width>0&&r?(A=T7({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:c,tooltipDimension:f.width,viewBox:x,viewBoxDimension:x.width}),P=T7({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:c,tooltipDimension:f.height,viewBox:x,viewBoxDimension:x.height}),w=QAe({translateX:A,translateY:P,useTranslate3d:i})):w=XAe,{cssProperties:w,cssClasses:JAe({translateX:A,translateY:P,coordinate:r})}}function Lx(e){"@babel/helpers - typeof";return Lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lx(e)}function P7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P7(Object(r),!0).forEach(function(n){oI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rTe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,QJ(n.key),n)}}function nTe(e,t,r){return t&&rTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iTe(e,t,r){return t=gT(t),aTe(e,JJ()?Reflect.construct(t,r||[],gT(e).constructor):t.apply(e,r))}function aTe(e,t){if(t&&(Lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sTe(e)}function sTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(JJ=function(){return!!e})()}function gT(e){return gT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gT(e)}function oTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sI(e,t)}function sI(e,t){return sI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},sI(e,t)}function oI(e,t,r){return t=QJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QJ(e){var t=lTe(e,"string");return Lx(t)=="symbol"?t:t+""}function lTe(e,t){if(Lx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Lx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var j7=1,cTe=function(e){function t(){var r;tTe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=iTe(this,t,[].concat(a)),oI(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),oI(r,"handleKeyDown",function(f){if(f.key==="Escape"){var i,x,w,A;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(x=r.props.coordinate)===null||x===void 0?void 0:x.x)!==null&&i!==void 0?i:0,y:(w=(A=r.props.coordinate)===null||A===void 0?void 0:A.y)!==null&&w!==void 0?w:0}})}}),r}return oTe(t,e),nTe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>j7||Math.abs(n.height-this.state.lastBoundingBox.height)>j7)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,c=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,x=a.animationEasing,w=a.children,A=a.coordinate,P=a.hasPayload,E=a.isAnimationActive,D=a.offset,V=a.position,L=a.reverseDirection,$=a.useTranslate3d,H=a.viewBox,K=a.wrapperStyle,Q=eTe({allowEscapeViewBox:f,coordinate:A,offsetTopLeft:D,position:V,reverseDirection:L,tooltipBox:this.state.lastBoundingBox,useTranslate3d:$,viewBox:H}),ae=Q.cssClasses,ee=Q.cssProperties,se=N7(N7({transition:E&&c?"transform ".concat(i,"ms ").concat(x):void 0},ee),{},{pointerEvents:"none",visibility:!this.state.dismissed&&c&&P?"visible":"hidden",position:"absolute",top:0,left:0},K);return Oe.createElement("div",{tabIndex:-1,className:ae,style:se,ref:function(he){n.wrapperNode=he}},w)}}])}(W.PureComponent),uTe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},fp={isSsr:uTe()};function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function C7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function k7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C7(Object(r),!0).forEach(function(n){VL(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hTe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tQ(n.key),n)}}function fTe(e,t,r){return t&&hTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pTe(e,t,r){return t=yT(t),mTe(e,eQ()?Reflect.construct(t,r||[],yT(e).constructor):t.apply(e,r))}function mTe(e,t){if(t&&(zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gTe(e)}function gTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eQ=function(){return!!e})()}function yT(e){return yT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},yT(e)}function yTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lI(e,t)}function lI(e,t){return lI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},lI(e,t)}function VL(e,t,r){return t=tQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tQ(e){var t=vTe(e,"string");return zx(t)=="symbol"?t:t+""}function vTe(e,t){if(zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function xTe(e){return e.dataKey}function _Te(e,t){return Oe.isValidElement(e)?Oe.cloneElement(e,t):typeof e=="function"?Oe.createElement(e,t):Oe.createElement(KAe,t)}var ta=function(e){function t(){return dTe(this,t),pTe(this,t,arguments)}return yTe(t,e),fTe(t,[{key:"render",value:function(){var n=this,a=this.props,c=a.active,f=a.allowEscapeViewBox,i=a.animationDuration,x=a.animationEasing,w=a.content,A=a.coordinate,P=a.filterNull,E=a.isAnimationActive,D=a.offset,V=a.payload,L=a.payloadUniqBy,$=a.position,H=a.reverseDirection,K=a.useTranslate3d,Q=a.viewBox,ae=a.wrapperStyle,ee=V??[];P&&ee.length&&(ee=GJ(V.filter(function(ce){return ce.value!=null&&(ce.hide!==!0||n.props.includeHidden)}),L,xTe));var se=ee.length>0;return Oe.createElement(cTe,{allowEscapeViewBox:f,animationDuration:i,animationEasing:x,isAnimationActive:E,active:c,coordinate:A,hasPayload:se,offset:D,position:$,reverseDirection:H,useTranslate3d:K,viewBox:Q,wrapperStyle:ae},_Te(w,k7(k7({},this.props),{},{payload:ee})))}}])}(W.PureComponent);VL(ta,"displayName","Tooltip");VL(ta,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!fp.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var EM,E7;function bTe(){if(E7)return EM;E7=1;var e=dp(),t=function(){return e.Date.now()};return EM=t,EM}var MM,M7;function wTe(){if(M7)return MM;M7=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return MM=t,MM}var OM,O7;function STe(){if(O7)return OM;O7=1;var e=wTe(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return OM=r,OM}var RM,R7;function rQ(){if(R7)return RM;R7=1;var e=STe(),t=uy(),r=j_(),n=NaN,a=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,f=/^0o[0-7]+$/i,i=parseInt;function x(w){if(typeof w=="number")return w;if(r(w))return n;if(t(w)){var A=typeof w.valueOf=="function"?w.valueOf():w;w=t(A)?A+"":A}if(typeof w!="string")return w===0?w:+w;w=e(w);var P=c.test(w);return P||f.test(w)?i(w.slice(2),P?2:8):a.test(w)?n:+w}return RM=x,RM}var IM,I7;function ATe(){if(I7)return IM;I7=1;var e=uy(),t=bTe(),r=rQ(),n="Expected a function",a=Math.max,c=Math.min;function f(i,x,w){var A,P,E,D,V,L,$=0,H=!1,K=!1,Q=!0;if(typeof i!="function")throw new TypeError(n);x=r(x)||0,e(w)&&(H=!!w.leading,K="maxWait"in w,E=K?a(r(w.maxWait)||0,x):E,Q="trailing"in w?!!w.trailing:Q);function ae(xe){var Ce=A,ze=P;return A=P=void 0,$=xe,D=i.apply(ze,Ce),D}function ee(xe){return $=xe,V=setTimeout(he,x),H?ae(xe):D}function se(xe){var Ce=xe-L,ze=xe-$,Te=x-Ce;return K?c(Te,E-ze):Te}function ce(xe){var Ce=xe-L,ze=xe-$;return L===void 0||Ce>=x||Ce<0||K&&ze>=E}function he(){var xe=t();if(ce(xe))return Pe(xe);V=setTimeout(he,se(xe))}function Pe(xe){return V=void 0,Q&&A?ae(xe):(A=P=void 0,D)}function Ne(){V!==void 0&&clearTimeout(V),$=0,A=L=P=V=void 0}function pe(){return V===void 0?D:Pe(t())}function je(){var xe=t(),Ce=ce(xe);if(A=arguments,P=this,L=xe,Ce){if(V===void 0)return ee(L);if(K)return clearTimeout(V),V=setTimeout(he,x),ae(L)}return V===void 0&&(V=setTimeout(he,x)),D}return je.cancel=Ne,je.flush=pe,je}return IM=f,IM}var DM,D7;function TTe(){if(D7)return DM;D7=1;var e=ATe(),t=uy(),r="Expected a function";function n(a,c,f){var i=!0,x=!0;if(typeof a!="function")throw new TypeError(r);return t(f)&&(i="leading"in f?!!f.leading:i,x="trailing"in f?!!f.trailing:x),e(a,c,{leading:i,maxWait:c,trailing:x})}return DM=n,DM}var PTe=TTe();const nQ=la(PTe);function nw(e){"@babel/helpers - typeof";return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(e)}function L7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L7(Object(r),!0).forEach(function(n){NTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NTe(e,t,r){return t=jTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jTe(e){var t=CTe(e,"string");return nw(t)=="symbol"?t:t+""}function CTe(e,t){if(nw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(nw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kTe(e,t){return RTe(e)||OTe(e,t)||MTe(e,t)||ETe()}function ETe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MTe(e,t){if(e){if(typeof e=="string")return z7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z7(e,t)}}function z7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function OTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function RTe(e){if(Array.isArray(e))return e}var _o=W.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,c=e.width,f=c===void 0?"100%":c,i=e.height,x=i===void 0?"100%":i,w=e.minWidth,A=w===void 0?0:w,P=e.minHeight,E=e.maxHeight,D=e.children,V=e.debounce,L=V===void 0?0:V,$=e.id,H=e.className,K=e.onResize,Q=e.style,ae=Q===void 0?{}:Q,ee=W.useRef(null),se=W.useRef();se.current=K,W.useImperativeHandle(t,function(){return Object.defineProperty(ee.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),ee.current},configurable:!0})});var ce=W.useState({containerWidth:a.width,containerHeight:a.height}),he=kTe(ce,2),Pe=he[0],Ne=he[1],pe=W.useCallback(function(xe,Ce){Ne(function(ze){var Te=Math.round(xe),Re=Math.round(Ce);return ze.containerWidth===Te&&ze.containerHeight===Re?ze:{containerWidth:Te,containerHeight:Re}})},[]);W.useEffect(function(){var xe=function(He){var mt,Xe=He[0].contentRect,ot=Xe.width,qe=Xe.height;pe(ot,qe),(mt=se.current)===null||mt===void 0||mt.call(se,ot,qe)};L>0&&(xe=nQ(xe,L,{trailing:!0,leading:!1}));var Ce=new ResizeObserver(xe),ze=ee.current.getBoundingClientRect(),Te=ze.width,Re=ze.height;return pe(Te,Re),Ce.observe(ee.current),function(){Ce.disconnect()}},[pe,L]);var je=W.useMemo(function(){var xe=Pe.containerWidth,Ce=Pe.containerHeight;if(xe<0||Ce<0)return null;Vh(P0(f)||P0(x),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,f,x),Vh(!r||r>0,"The aspect(%s) must be greater than zero.",r);var ze=P0(f)?xe:f,Te=P0(x)?Ce:x;r&&r>0&&(ze?Te=ze/r:Te&&(ze=Te*r),E&&Te>E&&(Te=E)),Vh(ze>0||Te>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ze,Te,f,x,A,P,r);var Re=!Array.isArray(D)&&mm(D.type).endsWith("Chart");return Oe.Children.map(D,function(Fe){return Oe.isValidElement(Fe)?W.cloneElement(Fe,qS({width:ze,height:Te},Re?{style:qS({height:"100%",width:"100%",maxHeight:Te,maxWidth:ze},Fe.props.style)}:{})):Fe})},[r,D,x,E,P,A,Pe,f]);return Oe.createElement("div",{id:$?"".concat($):void 0,className:fi("recharts-responsive-container",H),style:qS(qS({},ae),{},{width:f,height:x,minWidth:A,minHeight:P,maxHeight:E}),ref:ee},je)}),Kh=function(t){return null};Kh.displayName="Cell";function iw(e){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(e)}function F7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F7(Object(r),!0).forEach(function(n){ITe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ITe(e,t,r){return t=DTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DTe(e){var t=LTe(e,"string");return iw(t)=="symbol"?t:t+""}function LTe(e,t){if(iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ex={widthCache:{},cacheCount:0},zTe=2e3,FTe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},B7="recharts_measurement_span";function BTe(e){var t=cI({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var p1=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||fp.isSsr)return{width:0,height:0};var n=BTe(r),a=JSON.stringify({text:t,copyStyle:n});if(ex.widthCache[a])return ex.widthCache[a];try{var c=document.getElementById(B7);c||(c=document.createElement("span"),c.setAttribute("id",B7),c.setAttribute("aria-hidden","true"),document.body.appendChild(c));var f=cI(cI({},FTe),n);Object.assign(c.style,f),c.textContent="".concat(t);var i=c.getBoundingClientRect(),x={width:i.width,height:i.height};return ex.widthCache[a]=x,++ex.cacheCount>zTe&&(ex.cacheCount=0,ex.widthCache={}),x}catch{return{width:0,height:0}}},VTe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function aw(e){"@babel/helpers - typeof";return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(e)}function vT(e,t){return GTe(e)||qTe(e,t)||$Te(e,t)||UTe()}function UTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Te(e,t){if(e){if(typeof e=="string")return V7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V7(e,t)}}function V7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function qTe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;x=!1}else for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function GTe(e){if(Array.isArray(e))return e}function WTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,KTe(n.key),n)}}function HTe(e,t,r){return t&&U7(e.prototype,t),r&&U7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KTe(e){var t=ZTe(e,"string");return aw(t)=="symbol"?t:t+""}function ZTe(e,t){if(aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var $7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,q7=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,YTe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,XTe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,iQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},JTe=Object.keys(iQ),fx="NaN";function QTe(e,t){return e*iQ[t]}var GS=function(){function e(t,r){WTe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!YTe.test(r)&&(this.num=NaN,this.unit=""),JTe.includes(r)&&(this.num=QTe(t,r),this.unit="px")}return HTe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=XTe.exec(r))!==null&&n!==void 0?n:[],c=vT(a,3),f=c[1],i=c[2];return new e(parseFloat(f),i??"")}}])}();function aQ(e){if(e.includes(fx))return fx;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=$7.exec(t))!==null&&r!==void 0?r:[],a=vT(n,4),c=a[1],f=a[2],i=a[3],x=GS.parse(c??""),w=GS.parse(i??""),A=f==="*"?x.multiply(w):x.divide(w);if(A.isNaN())return fx;t=t.replace($7,A.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var P,E=(P=q7.exec(t))!==null&&P!==void 0?P:[],D=vT(E,4),V=D[1],L=D[2],$=D[3],H=GS.parse(V??""),K=GS.parse($??""),Q=L==="+"?H.add(K):H.subtract(K);if(Q.isNaN())return fx;t=t.replace(q7,Q.toString())}return t}var G7=/\(([^()]*)\)/;function ePe(e){for(var t=e;t.includes("(");){var r=G7.exec(t),n=vT(r,2),a=n[1];t=t.replace(G7,aQ(a))}return t}function tPe(e){var t=e.replace(/\s+/g,"");return t=ePe(t),t=aQ(t),t}function rPe(e){try{return tPe(e)}catch{return fx}}function LM(e){var t=rPe(e.slice(5,-1));return t===fx?"":t}var nPe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],iPe=["dx","dy","angle","className","breakAll"];function uI(){return uI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uI.apply(this,arguments)}function W7(e,t){if(e==null)return{};var r=aPe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function aPe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function H7(e,t){return cPe(e)||lPe(e,t)||oPe(e,t)||sPe()}function sPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oPe(e,t){if(e){if(typeof e=="string")return K7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K7(e,t)}}function K7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lPe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;x=!1}else for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function cPe(e){if(Array.isArray(e))return e}var sQ=/[ \f\n\r\t\v\u2028\u2029]+/,oQ=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var c=[];Xn(r)||(n?c=r.toString().split(""):c=r.toString().split(sQ));var f=c.map(function(x){return{word:x,width:p1(x,a).width}}),i=n?0:p1(" ",a).width;return{wordsWithComputedWidth:f,spaceWidth:i}}catch{return null}},uPe=function(t,r,n,a,c){var f=t.maxLines,i=t.children,x=t.style,w=t.breakAll,A=zr(f),P=i,E=function(){var ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ze.reduce(function(Te,Re){var Fe=Re.word,He=Re.width,mt=Te[Te.length-1];if(mt&&(a==null||c||mt.width+He+n<Number(a)))mt.words.push(Fe),mt.width+=He+n;else{var Xe={words:[Fe],width:He};Te.push(Xe)}return Te},[])},D=E(r),V=function(ze){return ze.reduce(function(Te,Re){return Te.width>Re.width?Te:Re})};if(!A)return D;for(var L="…",$=function(ze){var Te=P.slice(0,ze),Re=oQ({breakAll:w,style:x,children:Te+L}).wordsWithComputedWidth,Fe=E(Re),He=Fe.length>f||V(Fe).width>Number(a);return[He,Fe]},H=0,K=P.length-1,Q=0,ae;H<=K&&Q<=P.length-1;){var ee=Math.floor((H+K)/2),se=ee-1,ce=$(se),he=H7(ce,2),Pe=he[0],Ne=he[1],pe=$(ee),je=H7(pe,1),xe=je[0];if(!Pe&&!xe&&(H=ee+1),Pe&&xe&&(K=ee-1),!Pe&&xe){ae=Ne;break}Q++}return ae||D},Z7=function(t){var r=Xn(t)?[]:t.toString().split(sQ);return[{words:r}]},dPe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,c=t.style,f=t.breakAll,i=t.maxLines;if((r||n)&&!fp.isSsr){var x,w,A=oQ({breakAll:f,children:a,style:c});if(A){var P=A.wordsWithComputedWidth,E=A.spaceWidth;x=P,w=E}else return Z7(a);return uPe({breakAll:f,children:a,maxLines:i,style:c},x,w,r,n)}return Z7(a)},Y7="#808080",q0=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,c=a===void 0?0:a,f=t.lineHeight,i=f===void 0?"1em":f,x=t.capHeight,w=x===void 0?"0.71em":x,A=t.scaleToFit,P=A===void 0?!1:A,E=t.textAnchor,D=E===void 0?"start":E,V=t.verticalAnchor,L=V===void 0?"end":V,$=t.fill,H=$===void 0?Y7:$,K=W7(t,nPe),Q=W.useMemo(function(){return dPe({breakAll:K.breakAll,children:K.children,maxLines:K.maxLines,scaleToFit:P,style:K.style,width:K.width})},[K.breakAll,K.children,K.maxLines,P,K.style,K.width]),ae=K.dx,ee=K.dy,se=K.angle,ce=K.className,he=K.breakAll,Pe=W7(K,iPe);if(!Vo(n)||!Vo(c))return null;var Ne=n+(zr(ae)?ae:0),pe=c+(zr(ee)?ee:0),je;switch(L){case"start":je=LM("calc(".concat(w,")"));break;case"middle":je=LM("calc(".concat((Q.length-1)/2," * -").concat(i," + (").concat(w," / 2))"));break;default:je=LM("calc(".concat(Q.length-1," * -").concat(i,")"));break}var xe=[];if(P){var Ce=Q[0].width,ze=K.width;xe.push("scale(".concat((zr(ze)?ze/Ce:1)/Ce,")"))}return se&&xe.push("rotate(".concat(se,", ").concat(Ne,", ").concat(pe,")")),xe.length&&(Pe.transform=xe.join(" ")),Oe.createElement("text",uI({},vn(Pe,!0),{x:Ne,y:pe,className:fi("recharts-text",ce),textAnchor:D,fill:H.includes("url")?Y7:H}),Q.map(function(Te,Re){var Fe=Te.words.join(he?"":" ");return Oe.createElement("tspan",{x:Ne,dy:Re===0?je:i,key:"".concat(Fe,"-").concat(Re)},Fe)}))};function Wg(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hPe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function UL(e){let t,r,n;e.length!==2?(t=Wg,r=(i,x)=>Wg(e(i),x),n=(i,x)=>e(i)-x):(t=e===Wg||e===hPe?e:fPe,r=e,n=e);function a(i,x,w=0,A=i.length){if(w<A){if(t(x,x)!==0)return A;do{const P=w+A>>>1;r(i[P],x)<0?w=P+1:A=P}while(w<A)}return w}function c(i,x,w=0,A=i.length){if(w<A){if(t(x,x)!==0)return A;do{const P=w+A>>>1;r(i[P],x)<=0?w=P+1:A=P}while(w<A)}return w}function f(i,x,w=0,A=i.length){const P=a(i,x,w,A-1);return P>w&&n(i[P-1],x)>-n(i[P],x)?P-1:P}return{left:a,center:f,right:c}}function fPe(){return 0}function lQ(e){return e===null?NaN:+e}function*pPe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const mPe=UL(Wg),u2=mPe.right;UL(lQ).center;class X7 extends Map{constructor(t,r=vPe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(J7(this,t))}has(t){return super.has(J7(this,t))}set(t,r){return super.set(gPe(this,t),r)}delete(t){return super.delete(yPe(this,t))}}function J7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function gPe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function yPe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function vPe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function xPe(e=Wg){if(e===Wg)return cQ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function cQ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const _Pe=Math.sqrt(50),bPe=Math.sqrt(10),wPe=Math.sqrt(2);function xT(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),c=n/Math.pow(10,a),f=c>=_Pe?10:c>=bPe?5:c>=wPe?2:1;let i,x,w;return a<0?(w=Math.pow(10,-a)/f,i=Math.round(e*w),x=Math.round(t*w),i/w<e&&++i,x/w>t&&--x,w=-w):(w=Math.pow(10,a)*f,i=Math.round(e/w),x=Math.round(t/w),i*w<e&&++i,x*w>t&&--x),x<i&&.5<=r&&r<2?xT(e,t,r*2):[i,x,w]}function dI(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,c,f]=n?xT(t,e,r):xT(e,t,r);if(!(c>=a))return[];const i=c-a+1,x=new Array(i);if(n)if(f<0)for(let w=0;w<i;++w)x[w]=(c-w)/-f;else for(let w=0;w<i;++w)x[w]=(c-w)*f;else if(f<0)for(let w=0;w<i;++w)x[w]=(a+w)/-f;else for(let w=0;w<i;++w)x[w]=(a+w)*f;return x}function hI(e,t,r){return t=+t,e=+e,r=+r,xT(e,t,r)[2]}function fI(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?hI(t,e,r):hI(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function Q7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function e9(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function uQ(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?cQ:xPe(a);n>r;){if(n-r>600){const x=n-r+1,w=t-r+1,A=Math.log(x),P=.5*Math.exp(2*A/3),E=.5*Math.sqrt(A*P*(x-P)/x)*(w-x/2<0?-1:1),D=Math.max(r,Math.floor(t-w*P/x+E)),V=Math.min(n,Math.floor(t+(x-w)*P/x+E));uQ(e,t,D,V,a)}const c=e[t];let f=r,i=n;for(Bb(e,r,t),a(e[n],c)>0&&Bb(e,r,n);f<i;){for(Bb(e,f,i),++f,--i;a(e[f],c)<0;)++f;for(;a(e[i],c)>0;)--i}a(e[r],c)===0?Bb(e,r,i):(++i,Bb(e,i,n)),i<=t&&(r=i+1),t<=i&&(n=i-1)}return e}function Bb(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function SPe(e,t,r){if(e=Float64Array.from(pPe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return e9(e);if(t>=1)return Q7(e);var n,a=(n-1)*t,c=Math.floor(a),f=Q7(uQ(e,c).subarray(0,c+1)),i=e9(e.subarray(c+1));return f+(i-f)*(a-c)}}function APe(e,t,r=lQ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,c=Math.floor(a),f=+r(e[c],c,e),i=+r(e[c+1],c+1,e);return f+(i-f)*(a-c)}}function TPe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,c=new Array(a);++n<a;)c[n]=e+n*r;return c}function Ud(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Cm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const pI=Symbol("implicit");function $L(){var e=new X7,t=[],r=[],n=pI;function a(c){let f=e.get(c);if(f===void 0){if(n!==pI)return n;e.set(c,f=t.push(c)-1)}return r[f%r.length]}return a.domain=function(c){if(!arguments.length)return t.slice();t=[],e=new X7;for(const f of c)e.has(f)||e.set(f,t.push(f)-1);return a},a.range=function(c){return arguments.length?(r=Array.from(c),a):r.slice()},a.unknown=function(c){return arguments.length?(n=c,a):n},a.copy=function(){return $L(t,r).unknown(n)},Ud.apply(a,arguments),a}function sw(){var e=$L().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,c,f,i=!1,x=0,w=0,A=.5;delete e.unknown;function P(){var E=t().length,D=a<n,V=D?a:n,L=D?n:a;c=(L-V)/Math.max(1,E-x+w*2),i&&(c=Math.floor(c)),V+=(L-V-c*(E-x))*A,f=c*(1-x),i&&(V=Math.round(V),f=Math.round(f));var $=TPe(E).map(function(H){return V+c*H});return r(D?$.reverse():$)}return e.domain=function(E){return arguments.length?(t(E),P()):t()},e.range=function(E){return arguments.length?([n,a]=E,n=+n,a=+a,P()):[n,a]},e.rangeRound=function(E){return[n,a]=E,n=+n,a=+a,i=!0,P()},e.bandwidth=function(){return f},e.step=function(){return c},e.round=function(E){return arguments.length?(i=!!E,P()):i},e.padding=function(E){return arguments.length?(x=Math.min(1,w=+E),P()):x},e.paddingInner=function(E){return arguments.length?(x=Math.min(1,E),P()):x},e.paddingOuter=function(E){return arguments.length?(w=+E,P()):w},e.align=function(E){return arguments.length?(A=Math.max(0,Math.min(1,E)),P()):A},e.copy=function(){return sw(t(),[n,a]).round(i).paddingInner(x).paddingOuter(w).align(A)},Ud.apply(P(),arguments)}function dQ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return dQ(t())},e}function m1(){return dQ(sw.apply(null,arguments).paddingInner(1))}function qL(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function hQ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function d2(){}var ow=.7,_T=1/ow,Sx="\\s*([+-]?\\d+)\\s*",lw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",PPe=/^#([0-9a-f]{3,8})$/,NPe=new RegExp(`^rgb\\(${Sx},${Sx},${Sx}\\)$`),jPe=new RegExp(`^rgb\\(${Xf},${Xf},${Xf}\\)$`),CPe=new RegExp(`^rgba\\(${Sx},${Sx},${Sx},${lw}\\)$`),kPe=new RegExp(`^rgba\\(${Xf},${Xf},${Xf},${lw}\\)$`),EPe=new RegExp(`^hsl\\(${lw},${Xf},${Xf}\\)$`),MPe=new RegExp(`^hsla\\(${lw},${Xf},${Xf},${lw}\\)$`),t9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};qL(d2,cw,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:r9,formatHex:r9,formatHex8:OPe,formatHsl:RPe,formatRgb:n9,toString:n9});function r9(){return this.rgb().formatHex()}function OPe(){return this.rgb().formatHex8()}function RPe(){return fQ(this).formatHsl()}function n9(){return this.rgb().formatRgb()}function cw(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=PPe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?i9(t):r===3?new Kc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?WS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?WS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=NPe.exec(e))?new Kc(t[1],t[2],t[3],1):(t=jPe.exec(e))?new Kc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=CPe.exec(e))?WS(t[1],t[2],t[3],t[4]):(t=kPe.exec(e))?WS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=EPe.exec(e))?o9(t[1],t[2]/100,t[3]/100,1):(t=MPe.exec(e))?o9(t[1],t[2]/100,t[3]/100,t[4]):t9.hasOwnProperty(e)?i9(t9[e]):e==="transparent"?new Kc(NaN,NaN,NaN,0):null}function i9(e){return new Kc(e>>16&255,e>>8&255,e&255,1)}function WS(e,t,r,n){return n<=0&&(e=t=r=NaN),new Kc(e,t,r,n)}function IPe(e){return e instanceof d2||(e=cw(e)),e?(e=e.rgb(),new Kc(e.r,e.g,e.b,e.opacity)):new Kc}function mI(e,t,r,n){return arguments.length===1?IPe(e):new Kc(e,t,r,n??1)}function Kc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}qL(Kc,mI,hQ(d2,{brighter(e){return e=e==null?_T:Math.pow(_T,e),new Kc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ow:Math.pow(ow,e),new Kc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Kc(R0(this.r),R0(this.g),R0(this.b),bT(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:a9,formatHex:a9,formatHex8:DPe,formatRgb:s9,toString:s9}));function a9(){return`#${N0(this.r)}${N0(this.g)}${N0(this.b)}`}function DPe(){return`#${N0(this.r)}${N0(this.g)}${N0(this.b)}${N0((isNaN(this.opacity)?1:this.opacity)*255)}`}function s9(){const e=bT(this.opacity);return`${e===1?"rgb(":"rgba("}${R0(this.r)}, ${R0(this.g)}, ${R0(this.b)}${e===1?")":`, ${e})`}`}function bT(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function R0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function N0(e){return e=R0(e),(e<16?"0":"")+e.toString(16)}function o9(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new zh(e,t,r,n)}function fQ(e){if(e instanceof zh)return new zh(e.h,e.s,e.l,e.opacity);if(e instanceof d2||(e=cw(e)),!e)return new zh;if(e instanceof zh)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),c=Math.max(t,r,n),f=NaN,i=c-a,x=(c+a)/2;return i?(t===c?f=(r-n)/i+(r<n)*6:r===c?f=(n-t)/i+2:f=(t-r)/i+4,i/=x<.5?c+a:2-c-a,f*=60):i=x>0&&x<1?0:f,new zh(f,i,x,e.opacity)}function LPe(e,t,r,n){return arguments.length===1?fQ(e):new zh(e,t,r,n??1)}function zh(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}qL(zh,LPe,hQ(d2,{brighter(e){return e=e==null?_T:Math.pow(_T,e),new zh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ow:Math.pow(ow,e),new zh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Kc(zM(e>=240?e-240:e+120,a,n),zM(e,a,n),zM(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new zh(l9(this.h),HS(this.s),HS(this.l),bT(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=bT(this.opacity);return`${e===1?"hsl(":"hsla("}${l9(this.h)}, ${HS(this.s)*100}%, ${HS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function l9(e){return e=(e||0)%360,e<0?e+360:e}function HS(e){return Math.max(0,Math.min(1,e||0))}function zM(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const GL=e=>()=>e;function zPe(e,t){return function(r){return e+r*t}}function FPe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function BPe(e){return(e=+e)==1?pQ:function(t,r){return r-t?FPe(t,r,e):GL(isNaN(t)?r:t)}}function pQ(e,t){var r=t-e;return r?zPe(e,r):GL(isNaN(e)?t:e)}const c9=function e(t){var r=BPe(t);function n(a,c){var f=r((a=mI(a)).r,(c=mI(c)).r),i=r(a.g,c.g),x=r(a.b,c.b),w=pQ(a.opacity,c.opacity);return function(A){return a.r=f(A),a.g=i(A),a.b=x(A),a.opacity=w(A),a+""}}return n.gamma=e,n}(1);function VPe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(c){for(a=0;a<r;++a)n[a]=e[a]*(1-c)+t[a]*c;return n}}function UPe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $Pe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),c=new Array(r),f;for(f=0;f<n;++f)a[f]=M_(e[f],t[f]);for(;f<r;++f)c[f]=t[f];return function(i){for(f=0;f<n;++f)c[f]=a[f](i);return c}}function qPe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function wT(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function GPe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=M_(e[a],t[a]):n[a]=t[a];return function(c){for(a in r)n[a]=r[a](c);return n}}var gI=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,FM=new RegExp(gI.source,"g");function WPe(e){return function(){return e}}function HPe(e){return function(t){return e(t)+""}}function KPe(e,t){var r=gI.lastIndex=FM.lastIndex=0,n,a,c,f=-1,i=[],x=[];for(e=e+"",t=t+"";(n=gI.exec(e))&&(a=FM.exec(t));)(c=a.index)>r&&(c=t.slice(r,c),i[f]?i[f]+=c:i[++f]=c),(n=n[0])===(a=a[0])?i[f]?i[f]+=a:i[++f]=a:(i[++f]=null,x.push({i:f,x:wT(n,a)})),r=FM.lastIndex;return r<t.length&&(c=t.slice(r),i[f]?i[f]+=c:i[++f]=c),i.length<2?x[0]?HPe(x[0].x):WPe(t):(t=x.length,function(w){for(var A=0,P;A<t;++A)i[(P=x[A]).i]=P.x(w);return i.join("")})}function M_(e,t){var r=typeof t,n;return t==null||r==="boolean"?GL(t):(r==="number"?wT:r==="string"?(n=cw(t))?(t=n,c9):KPe:t instanceof cw?c9:t instanceof Date?qPe:UPe(t)?VPe:Array.isArray(t)?$Pe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?GPe:wT)(e,t)}function WL(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function ZPe(e,t){t===void 0&&(t=e,e=M_);for(var r=0,n=t.length-1,a=t[0],c=new Array(n<0?0:n);r<n;)c[r]=e(a,a=t[++r]);return function(f){var i=Math.max(0,Math.min(n-1,Math.floor(f*=n)));return c[i](f-i)}}function YPe(e){return function(){return e}}function ST(e){return+e}var u9=[0,1];function xc(e){return e}function yI(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:YPe(isNaN(t)?NaN:.5)}function XPe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function JPe(e,t,r){var n=e[0],a=e[1],c=t[0],f=t[1];return a<n?(n=yI(a,n),c=r(f,c)):(n=yI(n,a),c=r(c,f)),function(i){return c(n(i))}}function QPe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),c=new Array(n),f=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++f<n;)a[f]=yI(e[f],e[f+1]),c[f]=r(t[f],t[f+1]);return function(i){var x=u2(e,i,1,n)-1;return c[x](a[x](i))}}function h2(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function oN(){var e=u9,t=u9,r=M_,n,a,c,f=xc,i,x,w;function A(){var E=Math.min(e.length,t.length);return f!==xc&&(f=XPe(e[0],e[E-1])),i=E>2?QPe:JPe,x=w=null,P}function P(E){return E==null||isNaN(E=+E)?c:(x||(x=i(e.map(n),t,r)))(n(f(E)))}return P.invert=function(E){return f(a((w||(w=i(t,e.map(n),wT)))(E)))},P.domain=function(E){return arguments.length?(e=Array.from(E,ST),A()):e.slice()},P.range=function(E){return arguments.length?(t=Array.from(E),A()):t.slice()},P.rangeRound=function(E){return t=Array.from(E),r=WL,A()},P.clamp=function(E){return arguments.length?(f=E?!0:xc,A()):f!==xc},P.interpolate=function(E){return arguments.length?(r=E,A()):r},P.unknown=function(E){return arguments.length?(c=E,P):c},function(E,D){return n=E,a=D,A()}}function HL(){return oN()(xc,xc)}function eNe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function AT(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Fx(e){return e=AT(Math.abs(e)),e?e[1]:NaN}function tNe(e,t){return function(r,n){for(var a=r.length,c=[],f=0,i=e[0],x=0;a>0&&i>0&&(x+i+1>n&&(i=Math.max(1,n-x)),c.push(r.substring(a-=i,a+i)),!((x+=i+1)>n));)i=e[f=(f+1)%e.length];return c.reverse().join(t)}}function rNe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var nNe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uw(e){if(!(t=nNe.exec(e)))throw new Error("invalid format: "+e);var t;return new KL({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}uw.prototype=KL.prototype;function KL(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}KL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function iNe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var mQ;function aNe(e,t){var r=AT(e,t);if(!r)return e+"";var n=r[0],a=r[1],c=a-(mQ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,f=n.length;return c===f?n:c>f?n+new Array(c-f+1).join("0"):c>0?n.slice(0,c)+"."+n.slice(c):"0."+new Array(1-c).join("0")+AT(e,Math.max(0,t+c-1))[0]}function d9(e,t){var r=AT(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const h9={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:eNe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>d9(e*100,t),r:d9,s:aNe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function f9(e){return e}var p9=Array.prototype.map,m9=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function sNe(e){var t=e.grouping===void 0||e.thousands===void 0?f9:tNe(p9.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",c=e.numerals===void 0?f9:rNe(p9.call(e.numerals,String)),f=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"−":e.minus+"",x=e.nan===void 0?"NaN":e.nan+"";function w(P){P=uw(P);var E=P.fill,D=P.align,V=P.sign,L=P.symbol,$=P.zero,H=P.width,K=P.comma,Q=P.precision,ae=P.trim,ee=P.type;ee==="n"?(K=!0,ee="g"):h9[ee]||(Q===void 0&&(Q=12),ae=!0,ee="g"),($||E==="0"&&D==="=")&&($=!0,E="0",D="=");var se=L==="$"?r:L==="#"&&/[boxX]/.test(ee)?"0"+ee.toLowerCase():"",ce=L==="$"?n:/[%p]/.test(ee)?f:"",he=h9[ee],Pe=/[defgprs%]/.test(ee);Q=Q===void 0?6:/[gprs]/.test(ee)?Math.max(1,Math.min(21,Q)):Math.max(0,Math.min(20,Q));function Ne(pe){var je=se,xe=ce,Ce,ze,Te;if(ee==="c")xe=he(pe)+xe,pe="";else{pe=+pe;var Re=pe<0||1/pe<0;if(pe=isNaN(pe)?x:he(Math.abs(pe),Q),ae&&(pe=iNe(pe)),Re&&+pe==0&&V!=="+"&&(Re=!1),je=(Re?V==="("?V:i:V==="-"||V==="("?"":V)+je,xe=(ee==="s"?m9[8+mQ/3]:"")+xe+(Re&&V==="("?")":""),Pe){for(Ce=-1,ze=pe.length;++Ce<ze;)if(Te=pe.charCodeAt(Ce),48>Te||Te>57){xe=(Te===46?a+pe.slice(Ce+1):pe.slice(Ce))+xe,pe=pe.slice(0,Ce);break}}}K&&!$&&(pe=t(pe,1/0));var Fe=je.length+pe.length+xe.length,He=Fe<H?new Array(H-Fe+1).join(E):"";switch(K&&$&&(pe=t(He+pe,He.length?H-xe.length:1/0),He=""),D){case"<":pe=je+pe+xe+He;break;case"=":pe=je+He+pe+xe;break;case"^":pe=He.slice(0,Fe=He.length>>1)+je+pe+xe+He.slice(Fe);break;default:pe=He+je+pe+xe;break}return c(pe)}return Ne.toString=function(){return P+""},Ne}function A(P,E){var D=w((P=uw(P),P.type="f",P)),V=Math.max(-8,Math.min(8,Math.floor(Fx(E)/3)))*3,L=Math.pow(10,-V),$=m9[8+V/3];return function(H){return D(L*H)+$}}return{format:w,formatPrefix:A}}var KS,ZL,gQ;oNe({thousands:",",grouping:[3],currency:["$",""]});function oNe(e){return KS=sNe(e),ZL=KS.format,gQ=KS.formatPrefix,KS}function lNe(e){return Math.max(0,-Fx(Math.abs(e)))}function cNe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fx(t)/3)))*3-Fx(Math.abs(e)))}function uNe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fx(t)-Fx(e))+1}function yQ(e,t,r,n){var a=fI(e,t,r),c;switch(n=uw(n??",f"),n.type){case"s":{var f=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(c=cNe(a,f))&&(n.precision=c),gQ(n,f)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(c=uNe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=c-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(c=lNe(a))&&(n.precision=c-(n.type==="%")*2);break}}return ZL(n)}function hy(e){var t=e.domain;return e.ticks=function(r){var n=t();return dI(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return yQ(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,c=n.length-1,f=n[a],i=n[c],x,w,A=10;for(i<f&&(w=f,f=i,i=w,w=a,a=c,c=w);A-- >0;){if(w=hI(f,i,r),w===x)return n[a]=f,n[c]=i,t(n);if(w>0)f=Math.floor(f/w)*w,i=Math.ceil(i/w)*w;else if(w<0)f=Math.ceil(f*w)/w,i=Math.floor(i*w)/w;else break;x=w}return e},e}function TT(){var e=HL();return e.copy=function(){return h2(e,TT())},Ud.apply(e,arguments),hy(e)}function vQ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,ST),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return vQ(e).unknown(t)},e=arguments.length?Array.from(e,ST):[0,1],hy(r)}function xQ(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],c=e[n],f;return c<a&&(f=r,r=n,n=f,f=a,a=c,c=f),e[r]=t.floor(a),e[n]=t.ceil(c),e}function g9(e){return Math.log(e)}function y9(e){return Math.exp(e)}function dNe(e){return-Math.log(-e)}function hNe(e){return-Math.exp(-e)}function fNe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function pNe(e){return e===10?fNe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function mNe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function v9(e){return(t,r)=>-e(-t,r)}function YL(e){const t=e(g9,y9),r=t.domain;let n=10,a,c;function f(){return a=mNe(n),c=pNe(n),r()[0]<0?(a=v9(a),c=v9(c),e(dNe,hNe)):e(g9,y9),t}return t.base=function(i){return arguments.length?(n=+i,f()):n},t.domain=function(i){return arguments.length?(r(i),f()):r()},t.ticks=i=>{const x=r();let w=x[0],A=x[x.length-1];const P=A<w;P&&([w,A]=[A,w]);let E=a(w),D=a(A),V,L;const $=i==null?10:+i;let H=[];if(!(n%1)&&D-E<$){if(E=Math.floor(E),D=Math.ceil(D),w>0){for(;E<=D;++E)for(V=1;V<n;++V)if(L=E<0?V/c(-E):V*c(E),!(L<w)){if(L>A)break;H.push(L)}}else for(;E<=D;++E)for(V=n-1;V>=1;--V)if(L=E>0?V/c(-E):V*c(E),!(L<w)){if(L>A)break;H.push(L)}H.length*2<$&&(H=dI(w,A,$))}else H=dI(E,D,Math.min(D-E,$)).map(c);return P?H.reverse():H},t.tickFormat=(i,x)=>{if(i==null&&(i=10),x==null&&(x=n===10?"s":","),typeof x!="function"&&(!(n%1)&&(x=uw(x)).precision==null&&(x.trim=!0),x=ZL(x)),i===1/0)return x;const w=Math.max(1,n*i/t.ticks().length);return A=>{let P=A/c(Math.round(a(A)));return P*n<n-.5&&(P*=n),P<=w?x(A):""}},t.nice=()=>r(xQ(r(),{floor:i=>c(Math.floor(a(i))),ceil:i=>c(Math.ceil(a(i)))})),t}function _Q(){const e=YL(oN()).domain([1,10]);return e.copy=()=>h2(e,_Q()).base(e.base()),Ud.apply(e,arguments),e}function x9(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function _9(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function XL(e){var t=1,r=e(x9(t),_9(t));return r.constant=function(n){return arguments.length?e(x9(t=+n),_9(t)):t},hy(r)}function bQ(){var e=XL(oN());return e.copy=function(){return h2(e,bQ()).constant(e.constant())},Ud.apply(e,arguments)}function b9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function gNe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function yNe(e){return e<0?-e*e:e*e}function JL(e){var t=e(xc,xc),r=1;function n(){return r===1?e(xc,xc):r===.5?e(gNe,yNe):e(b9(r),b9(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},hy(t)}function QL(){var e=JL(oN());return e.copy=function(){return h2(e,QL()).exponent(e.exponent())},Ud.apply(e,arguments),e}function vNe(){return QL.apply(null,arguments).exponent(.5)}function w9(e){return Math.sign(e)*e*e}function xNe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function wQ(){var e=HL(),t=[0,1],r=!1,n;function a(c){var f=xNe(e(c));return isNaN(f)?n:r?Math.round(f):f}return a.invert=function(c){return e.invert(w9(c))},a.domain=function(c){return arguments.length?(e.domain(c),a):e.domain()},a.range=function(c){return arguments.length?(e.range((t=Array.from(c,ST)).map(w9)),a):t.slice()},a.rangeRound=function(c){return a.range(c).round(!0)},a.round=function(c){return arguments.length?(r=!!c,a):r},a.clamp=function(c){return arguments.length?(e.clamp(c),a):e.clamp()},a.unknown=function(c){return arguments.length?(n=c,a):n},a.copy=function(){return wQ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ud.apply(a,arguments),hy(a)}function SQ(){var e=[],t=[],r=[],n;function a(){var f=0,i=Math.max(1,t.length);for(r=new Array(i-1);++f<i;)r[f-1]=APe(e,f/i);return c}function c(f){return f==null||isNaN(f=+f)?n:t[u2(r,f)]}return c.invertExtent=function(f){var i=t.indexOf(f);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},c.domain=function(f){if(!arguments.length)return e.slice();e=[];for(let i of f)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Wg),a()},c.range=function(f){return arguments.length?(t=Array.from(f),a()):t.slice()},c.unknown=function(f){return arguments.length?(n=f,c):n},c.quantiles=function(){return r.slice()},c.copy=function(){return SQ().domain(e).range(t).unknown(n)},Ud.apply(c,arguments)}function AQ(){var e=0,t=1,r=1,n=[.5],a=[0,1],c;function f(x){return x!=null&&x<=x?a[u2(n,x,0,r)]:c}function i(){var x=-1;for(n=new Array(r);++x<r;)n[x]=((x+1)*t-(x-r)*e)/(r+1);return f}return f.domain=function(x){return arguments.length?([e,t]=x,e=+e,t=+t,i()):[e,t]},f.range=function(x){return arguments.length?(r=(a=Array.from(x)).length-1,i()):a.slice()},f.invertExtent=function(x){var w=a.indexOf(x);return w<0?[NaN,NaN]:w<1?[e,n[0]]:w>=r?[n[r-1],t]:[n[w-1],n[w]]},f.unknown=function(x){return arguments.length&&(c=x),f},f.thresholds=function(){return n.slice()},f.copy=function(){return AQ().domain([e,t]).range(a).unknown(c)},Ud.apply(hy(f),arguments)}function TQ(){var e=[.5],t=[0,1],r,n=1;function a(c){return c!=null&&c<=c?t[u2(e,c,0,n)]:r}return a.domain=function(c){return arguments.length?(e=Array.from(c),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(c){return arguments.length?(t=Array.from(c),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(c){var f=t.indexOf(c);return[e[f-1],e[f]]},a.unknown=function(c){return arguments.length?(r=c,a):r},a.copy=function(){return TQ().domain(e).range(t).unknown(r)},Ud.apply(a,arguments)}const BM=new Date,VM=new Date;function qo(e,t,r,n){function a(c){return e(c=arguments.length===0?new Date:new Date(+c)),c}return a.floor=c=>(e(c=new Date(+c)),c),a.ceil=c=>(e(c=new Date(c-1)),t(c,1),e(c),c),a.round=c=>{const f=a(c),i=a.ceil(c);return c-f<i-c?f:i},a.offset=(c,f)=>(t(c=new Date(+c),f==null?1:Math.floor(f)),c),a.range=(c,f,i)=>{const x=[];if(c=a.ceil(c),i=i==null?1:Math.floor(i),!(c<f)||!(i>0))return x;let w;do x.push(w=new Date(+c)),t(c,i),e(c);while(w<c&&c<f);return x},a.filter=c=>qo(f=>{if(f>=f)for(;e(f),!c(f);)f.setTime(f-1)},(f,i)=>{if(f>=f)if(i<0)for(;++i<=0;)for(;t(f,-1),!c(f););else for(;--i>=0;)for(;t(f,1),!c(f););}),r&&(a.count=(c,f)=>(BM.setTime(+c),VM.setTime(+f),e(BM),e(VM),Math.floor(r(BM,VM))),a.every=c=>(c=Math.floor(c),!isFinite(c)||!(c>0)?null:c>1?a.filter(n?f=>n(f)%c===0:f=>a.count(0,f)%c===0):a)),a}const PT=qo(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);PT.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?qo(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):PT);PT.range;const cm=1e3,Od=cm*60,um=Od*60,Sm=um*24,e4=Sm*7,S9=Sm*30,UM=Sm*365,j0=qo(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*cm)},(e,t)=>(t-e)/cm,e=>e.getUTCSeconds());j0.range;const t4=qo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*cm)},(e,t)=>{e.setTime(+e+t*Od)},(e,t)=>(t-e)/Od,e=>e.getMinutes());t4.range;const r4=qo(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Od)},(e,t)=>(t-e)/Od,e=>e.getUTCMinutes());r4.range;const n4=qo(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*cm-e.getMinutes()*Od)},(e,t)=>{e.setTime(+e+t*um)},(e,t)=>(t-e)/um,e=>e.getHours());n4.range;const i4=qo(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*um)},(e,t)=>(t-e)/um,e=>e.getUTCHours());i4.range;const f2=qo(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Od)/Sm,e=>e.getDate()-1);f2.range;const lN=qo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Sm,e=>e.getUTCDate()-1);lN.range;const PQ=qo(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Sm,e=>Math.floor(e/Sm));PQ.range;function nv(e){return qo(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Od)/e4)}const cN=nv(0),NT=nv(1),_Ne=nv(2),bNe=nv(3),Bx=nv(4),wNe=nv(5),SNe=nv(6);cN.range;NT.range;_Ne.range;bNe.range;Bx.range;wNe.range;SNe.range;function iv(e){return qo(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/e4)}const uN=iv(0),jT=iv(1),ANe=iv(2),TNe=iv(3),Vx=iv(4),PNe=iv(5),NNe=iv(6);uN.range;jT.range;ANe.range;TNe.range;Vx.range;PNe.range;NNe.range;const a4=qo(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());a4.range;const s4=qo(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());s4.range;const Am=qo(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Am.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:qo(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Am.range;const Tm=qo(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Tm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:qo(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Tm.range;function NQ(e,t,r,n,a,c){const f=[[j0,1,cm],[j0,5,5*cm],[j0,15,15*cm],[j0,30,30*cm],[c,1,Od],[c,5,5*Od],[c,15,15*Od],[c,30,30*Od],[a,1,um],[a,3,3*um],[a,6,6*um],[a,12,12*um],[n,1,Sm],[n,2,2*Sm],[r,1,e4],[t,1,S9],[t,3,3*S9],[e,1,UM]];function i(w,A,P){const E=A<w;E&&([w,A]=[A,w]);const D=P&&typeof P.range=="function"?P:x(w,A,P),V=D?D.range(w,+A+1):[];return E?V.reverse():V}function x(w,A,P){const E=Math.abs(A-w)/P,D=UL(([,,$])=>$).right(f,E);if(D===f.length)return e.every(fI(w/UM,A/UM,P));if(D===0)return PT.every(Math.max(fI(w,A,P),1));const[V,L]=f[E/f[D-1][2]<f[D][2]/E?D-1:D];return V.every(L)}return[i,x]}const[jNe,CNe]=NQ(Tm,s4,uN,PQ,i4,r4),[kNe,ENe]=NQ(Am,a4,cN,f2,n4,t4);function $M(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function qM(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Vb(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function MNe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,c=e.days,f=e.shortDays,i=e.months,x=e.shortMonths,w=Ub(a),A=$b(a),P=Ub(c),E=$b(c),D=Ub(f),V=$b(f),L=Ub(i),$=$b(i),H=Ub(x),K=$b(x),Q={a:Re,A:Fe,b:He,B:mt,c:null,d:C9,e:C9,f:tje,g:dje,G:fje,H:JNe,I:QNe,j:eje,L:jQ,m:rje,M:nje,p:Xe,q:ot,Q:M9,s:O9,S:ije,u:aje,U:sje,V:oje,w:lje,W:cje,x:null,X:null,y:uje,Y:hje,Z:pje,"%":E9},ae={a:qe,A:Lt,b:Zt,B:Xt,c:null,d:k9,e:k9,f:vje,g:jje,G:kje,H:mje,I:gje,j:yje,L:kQ,m:xje,M:_je,p:rr,q:ir,Q:M9,s:O9,S:bje,u:wje,U:Sje,V:Aje,w:Tje,W:Pje,x:null,X:null,y:Nje,Y:Cje,Z:Eje,"%":E9},ee={a:Ne,A:pe,b:je,B:xe,c:Ce,d:N9,e:N9,f:KNe,g:P9,G:T9,H:j9,I:j9,j:qNe,L:HNe,m:$Ne,M:GNe,p:Pe,q:UNe,Q:YNe,s:XNe,S:WNe,u:LNe,U:zNe,V:FNe,w:DNe,W:BNe,x:ze,X:Te,y:P9,Y:T9,Z:VNe,"%":ZNe};Q.x=se(r,Q),Q.X=se(n,Q),Q.c=se(t,Q),ae.x=se(r,ae),ae.X=se(n,ae),ae.c=se(t,ae);function se(Bt,De){return function(jr){var Dt=[],Cr=-1,At=0,qr=Bt.length,an,Jn,tt;for(jr instanceof Date||(jr=new Date(+jr));++Cr<qr;)Bt.charCodeAt(Cr)===37&&(Dt.push(Bt.slice(At,Cr)),(Jn=A9[an=Bt.charAt(++Cr)])!=null?an=Bt.charAt(++Cr):Jn=an==="e"?" ":"0",(tt=De[an])&&(an=tt(jr,Jn)),Dt.push(an),At=Cr+1);return Dt.push(Bt.slice(At,Cr)),Dt.join("")}}function ce(Bt,De){return function(jr){var Dt=Vb(1900,void 0,1),Cr=he(Dt,Bt,jr+="",0),At,qr;if(Cr!=jr.length)return null;if("Q"in Dt)return new Date(Dt.Q);if("s"in Dt)return new Date(Dt.s*1e3+("L"in Dt?Dt.L:0));if(De&&!("Z"in Dt)&&(Dt.Z=0),"p"in Dt&&(Dt.H=Dt.H%12+Dt.p*12),Dt.m===void 0&&(Dt.m="q"in Dt?Dt.q:0),"V"in Dt){if(Dt.V<1||Dt.V>53)return null;"w"in Dt||(Dt.w=1),"Z"in Dt?(At=qM(Vb(Dt.y,0,1)),qr=At.getUTCDay(),At=qr>4||qr===0?jT.ceil(At):jT(At),At=lN.offset(At,(Dt.V-1)*7),Dt.y=At.getUTCFullYear(),Dt.m=At.getUTCMonth(),Dt.d=At.getUTCDate()+(Dt.w+6)%7):(At=$M(Vb(Dt.y,0,1)),qr=At.getDay(),At=qr>4||qr===0?NT.ceil(At):NT(At),At=f2.offset(At,(Dt.V-1)*7),Dt.y=At.getFullYear(),Dt.m=At.getMonth(),Dt.d=At.getDate()+(Dt.w+6)%7)}else("W"in Dt||"U"in Dt)&&("w"in Dt||(Dt.w="u"in Dt?Dt.u%7:"W"in Dt?1:0),qr="Z"in Dt?qM(Vb(Dt.y,0,1)).getUTCDay():$M(Vb(Dt.y,0,1)).getDay(),Dt.m=0,Dt.d="W"in Dt?(Dt.w+6)%7+Dt.W*7-(qr+5)%7:Dt.w+Dt.U*7-(qr+6)%7);return"Z"in Dt?(Dt.H+=Dt.Z/100|0,Dt.M+=Dt.Z%100,qM(Dt)):$M(Dt)}}function he(Bt,De,jr,Dt){for(var Cr=0,At=De.length,qr=jr.length,an,Jn;Cr<At;){if(Dt>=qr)return-1;if(an=De.charCodeAt(Cr++),an===37){if(an=De.charAt(Cr++),Jn=ee[an in A9?De.charAt(Cr++):an],!Jn||(Dt=Jn(Bt,jr,Dt))<0)return-1}else if(an!=jr.charCodeAt(Dt++))return-1}return Dt}function Pe(Bt,De,jr){var Dt=w.exec(De.slice(jr));return Dt?(Bt.p=A.get(Dt[0].toLowerCase()),jr+Dt[0].length):-1}function Ne(Bt,De,jr){var Dt=D.exec(De.slice(jr));return Dt?(Bt.w=V.get(Dt[0].toLowerCase()),jr+Dt[0].length):-1}function pe(Bt,De,jr){var Dt=P.exec(De.slice(jr));return Dt?(Bt.w=E.get(Dt[0].toLowerCase()),jr+Dt[0].length):-1}function je(Bt,De,jr){var Dt=H.exec(De.slice(jr));return Dt?(Bt.m=K.get(Dt[0].toLowerCase()),jr+Dt[0].length):-1}function xe(Bt,De,jr){var Dt=L.exec(De.slice(jr));return Dt?(Bt.m=$.get(Dt[0].toLowerCase()),jr+Dt[0].length):-1}function Ce(Bt,De,jr){return he(Bt,t,De,jr)}function ze(Bt,De,jr){return he(Bt,r,De,jr)}function Te(Bt,De,jr){return he(Bt,n,De,jr)}function Re(Bt){return f[Bt.getDay()]}function Fe(Bt){return c[Bt.getDay()]}function He(Bt){return x[Bt.getMonth()]}function mt(Bt){return i[Bt.getMonth()]}function Xe(Bt){return a[+(Bt.getHours()>=12)]}function ot(Bt){return 1+~~(Bt.getMonth()/3)}function qe(Bt){return f[Bt.getUTCDay()]}function Lt(Bt){return c[Bt.getUTCDay()]}function Zt(Bt){return x[Bt.getUTCMonth()]}function Xt(Bt){return i[Bt.getUTCMonth()]}function rr(Bt){return a[+(Bt.getUTCHours()>=12)]}function ir(Bt){return 1+~~(Bt.getUTCMonth()/3)}return{format:function(Bt){var De=se(Bt+="",Q);return De.toString=function(){return Bt},De},parse:function(Bt){var De=ce(Bt+="",!1);return De.toString=function(){return Bt},De},utcFormat:function(Bt){var De=se(Bt+="",ae);return De.toString=function(){return Bt},De},utcParse:function(Bt){var De=ce(Bt+="",!0);return De.toString=function(){return Bt},De}}}var A9={"-":"",_:" ",0:"0"},hl=/^\s*\d+/,ONe=/^%/,RNe=/[\\^$*+?|[\]().{}]/g;function oa(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",c=a.length;return n+(c<r?new Array(r-c+1).join(t)+a:a)}function INe(e){return e.replace(RNe,"\\$&")}function Ub(e){return new RegExp("^(?:"+e.map(INe).join("|")+")","i")}function $b(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function DNe(e,t,r){var n=hl.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function LNe(e,t,r){var n=hl.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function zNe(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function FNe(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function BNe(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function T9(e,t,r){var n=hl.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function P9(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function VNe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function UNe(e,t,r){var n=hl.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function $Ne(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function N9(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function qNe(e,t,r){var n=hl.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function j9(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function GNe(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function WNe(e,t,r){var n=hl.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function HNe(e,t,r){var n=hl.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function KNe(e,t,r){var n=hl.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZNe(e,t,r){var n=ONe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function YNe(e,t,r){var n=hl.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function XNe(e,t,r){var n=hl.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function C9(e,t){return oa(e.getDate(),t,2)}function JNe(e,t){return oa(e.getHours(),t,2)}function QNe(e,t){return oa(e.getHours()%12||12,t,2)}function eje(e,t){return oa(1+f2.count(Am(e),e),t,3)}function jQ(e,t){return oa(e.getMilliseconds(),t,3)}function tje(e,t){return jQ(e,t)+"000"}function rje(e,t){return oa(e.getMonth()+1,t,2)}function nje(e,t){return oa(e.getMinutes(),t,2)}function ije(e,t){return oa(e.getSeconds(),t,2)}function aje(e){var t=e.getDay();return t===0?7:t}function sje(e,t){return oa(cN.count(Am(e)-1,e),t,2)}function CQ(e){var t=e.getDay();return t>=4||t===0?Bx(e):Bx.ceil(e)}function oje(e,t){return e=CQ(e),oa(Bx.count(Am(e),e)+(Am(e).getDay()===4),t,2)}function lje(e){return e.getDay()}function cje(e,t){return oa(NT.count(Am(e)-1,e),t,2)}function uje(e,t){return oa(e.getFullYear()%100,t,2)}function dje(e,t){return e=CQ(e),oa(e.getFullYear()%100,t,2)}function hje(e,t){return oa(e.getFullYear()%1e4,t,4)}function fje(e,t){var r=e.getDay();return e=r>=4||r===0?Bx(e):Bx.ceil(e),oa(e.getFullYear()%1e4,t,4)}function pje(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+oa(t/60|0,"0",2)+oa(t%60,"0",2)}function k9(e,t){return oa(e.getUTCDate(),t,2)}function mje(e,t){return oa(e.getUTCHours(),t,2)}function gje(e,t){return oa(e.getUTCHours()%12||12,t,2)}function yje(e,t){return oa(1+lN.count(Tm(e),e),t,3)}function kQ(e,t){return oa(e.getUTCMilliseconds(),t,3)}function vje(e,t){return kQ(e,t)+"000"}function xje(e,t){return oa(e.getUTCMonth()+1,t,2)}function _je(e,t){return oa(e.getUTCMinutes(),t,2)}function bje(e,t){return oa(e.getUTCSeconds(),t,2)}function wje(e){var t=e.getUTCDay();return t===0?7:t}function Sje(e,t){return oa(uN.count(Tm(e)-1,e),t,2)}function EQ(e){var t=e.getUTCDay();return t>=4||t===0?Vx(e):Vx.ceil(e)}function Aje(e,t){return e=EQ(e),oa(Vx.count(Tm(e),e)+(Tm(e).getUTCDay()===4),t,2)}function Tje(e){return e.getUTCDay()}function Pje(e,t){return oa(jT.count(Tm(e)-1,e),t,2)}function Nje(e,t){return oa(e.getUTCFullYear()%100,t,2)}function jje(e,t){return e=EQ(e),oa(e.getUTCFullYear()%100,t,2)}function Cje(e,t){return oa(e.getUTCFullYear()%1e4,t,4)}function kje(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Vx(e):Vx.ceil(e),oa(e.getUTCFullYear()%1e4,t,4)}function Eje(){return"+0000"}function E9(){return"%"}function M9(e){return+e}function O9(e){return Math.floor(+e/1e3)}var tx,MQ,OQ;Mje({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Mje(e){return tx=MNe(e),MQ=tx.format,tx.parse,OQ=tx.utcFormat,tx.utcParse,tx}function Oje(e){return new Date(e)}function Rje(e){return e instanceof Date?+e:+new Date(+e)}function o4(e,t,r,n,a,c,f,i,x,w){var A=HL(),P=A.invert,E=A.domain,D=w(".%L"),V=w(":%S"),L=w("%I:%M"),$=w("%I %p"),H=w("%a %d"),K=w("%b %d"),Q=w("%B"),ae=w("%Y");function ee(se){return(x(se)<se?D:i(se)<se?V:f(se)<se?L:c(se)<se?$:n(se)<se?a(se)<se?H:K:r(se)<se?Q:ae)(se)}return A.invert=function(se){return new Date(P(se))},A.domain=function(se){return arguments.length?E(Array.from(se,Rje)):E().map(Oje)},A.ticks=function(se){var ce=E();return e(ce[0],ce[ce.length-1],se??10)},A.tickFormat=function(se,ce){return ce==null?ee:w(ce)},A.nice=function(se){var ce=E();return(!se||typeof se.range!="function")&&(se=t(ce[0],ce[ce.length-1],se??10)),se?E(xQ(ce,se)):A},A.copy=function(){return h2(A,o4(e,t,r,n,a,c,f,i,x,w))},A}function Ije(){return Ud.apply(o4(kNe,ENe,Am,a4,cN,f2,n4,t4,j0,MQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Dje(){return Ud.apply(o4(jNe,CNe,Tm,s4,uN,lN,i4,r4,j0,OQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dN(){var e=0,t=1,r,n,a,c,f=xc,i=!1,x;function w(P){return P==null||isNaN(P=+P)?x:f(a===0?.5:(P=(c(P)-r)*a,i?Math.max(0,Math.min(1,P)):P))}w.domain=function(P){return arguments.length?([e,t]=P,r=c(e=+e),n=c(t=+t),a=r===n?0:1/(n-r),w):[e,t]},w.clamp=function(P){return arguments.length?(i=!!P,w):i},w.interpolator=function(P){return arguments.length?(f=P,w):f};function A(P){return function(E){var D,V;return arguments.length?([D,V]=E,f=P(D,V),w):[f(0),f(1)]}}return w.range=A(M_),w.rangeRound=A(WL),w.unknown=function(P){return arguments.length?(x=P,w):x},function(P){return c=P,r=P(e),n=P(t),a=r===n?0:1/(n-r),w}}function fy(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function RQ(){var e=hy(dN()(xc));return e.copy=function(){return fy(e,RQ())},Cm.apply(e,arguments)}function IQ(){var e=YL(dN()).domain([1,10]);return e.copy=function(){return fy(e,IQ()).base(e.base())},Cm.apply(e,arguments)}function DQ(){var e=XL(dN());return e.copy=function(){return fy(e,DQ()).constant(e.constant())},Cm.apply(e,arguments)}function l4(){var e=JL(dN());return e.copy=function(){return fy(e,l4()).exponent(e.exponent())},Cm.apply(e,arguments)}function Lje(){return l4.apply(null,arguments).exponent(.5)}function LQ(){var e=[],t=xc;function r(n){if(n!=null&&!isNaN(n=+n))return t((u2(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Wg),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,c)=>SPe(e,c/n))},r.copy=function(){return LQ(t).domain(e)},Cm.apply(r,arguments)}function hN(){var e=0,t=.5,r=1,n=1,a,c,f,i,x,w=xc,A,P=!1,E;function D(L){return isNaN(L=+L)?E:(L=.5+((L=+A(L))-c)*(n*L<n*c?i:x),w(P?Math.max(0,Math.min(1,L)):L))}D.domain=function(L){return arguments.length?([e,t,r]=L,a=A(e=+e),c=A(t=+t),f=A(r=+r),i=a===c?0:.5/(c-a),x=c===f?0:.5/(f-c),n=c<a?-1:1,D):[e,t,r]},D.clamp=function(L){return arguments.length?(P=!!L,D):P},D.interpolator=function(L){return arguments.length?(w=L,D):w};function V(L){return function($){var H,K,Q;return arguments.length?([H,K,Q]=$,w=ZPe(L,[H,K,Q]),D):[w(0),w(.5),w(1)]}}return D.range=V(M_),D.rangeRound=V(WL),D.unknown=function(L){return arguments.length?(E=L,D):E},function(L){return A=L,a=L(e),c=L(t),f=L(r),i=a===c?0:.5/(c-a),x=c===f?0:.5/(f-c),n=c<a?-1:1,D}}function zQ(){var e=hy(hN()(xc));return e.copy=function(){return fy(e,zQ())},Cm.apply(e,arguments)}function FQ(){var e=YL(hN()).domain([.1,1,10]);return e.copy=function(){return fy(e,FQ()).base(e.base())},Cm.apply(e,arguments)}function BQ(){var e=XL(hN());return e.copy=function(){return fy(e,BQ()).constant(e.constant())},Cm.apply(e,arguments)}function c4(){var e=JL(hN());return e.copy=function(){return fy(e,c4()).exponent(e.exponent())},Cm.apply(e,arguments)}function zje(){return c4.apply(null,arguments).exponent(.5)}const R9=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:sw,scaleDiverging:zQ,scaleDivergingLog:FQ,scaleDivergingPow:c4,scaleDivergingSqrt:zje,scaleDivergingSymlog:BQ,scaleIdentity:vQ,scaleImplicit:pI,scaleLinear:TT,scaleLog:_Q,scaleOrdinal:$L,scalePoint:m1,scalePow:QL,scaleQuantile:SQ,scaleQuantize:AQ,scaleRadial:wQ,scaleSequential:RQ,scaleSequentialLog:IQ,scaleSequentialPow:l4,scaleSequentialQuantile:LQ,scaleSequentialSqrt:Lje,scaleSequentialSymlog:DQ,scaleSqrt:vNe,scaleSymlog:bQ,scaleThreshold:TQ,scaleTime:Ije,scaleUtc:Dje,tickFormat:yQ},Symbol.toStringTag,{value:"Module"}));var GM,I9;function fN(){if(I9)return GM;I9=1;var e=j_();function t(r,n,a){for(var c=-1,f=r.length;++c<f;){var i=r[c],x=n(i);if(x!=null&&(w===void 0?x===x&&!e(x):a(x,w)))var w=x,A=i}return A}return GM=t,GM}var WM,D9;function VQ(){if(D9)return WM;D9=1;function e(t,r){return t>r}return WM=e,WM}var HM,L9;function Fje(){if(L9)return HM;L9=1;var e=fN(),t=VQ(),r=E_();function n(a){return a&&a.length?e(a,r,t):void 0}return HM=n,HM}var Bje=Fje();const Bg=la(Bje);var KM,z9;function UQ(){if(z9)return KM;z9=1;function e(t,r){return t<r}return KM=e,KM}var ZM,F9;function Vje(){if(F9)return ZM;F9=1;var e=fN(),t=UQ(),r=E_();function n(a){return a&&a.length?e(a,r,t):void 0}return ZM=n,ZM}var Uje=Vje();const pN=la(Uje);var YM,B9;function $je(){if(B9)return YM;B9=1;var e=PL(),t=hp(),r=YJ(),n=Jc();function a(c,f){var i=n(c)?e:r;return i(c,t(f,3))}return YM=a,YM}var XM,V9;function qje(){if(V9)return XM;V9=1;var e=KJ(),t=$je();function r(n,a){return e(t(n,a),1)}return XM=r,XM}var Gje=qje();const Wje=la(Gje);var JM,U9;function Hje(){if(U9)return JM;U9=1;var e=zL();function t(r,n){return e(r,n)}return JM=t,JM}var Kje=Hje();const Pm=la(Kje);var O_=1e9,Zje={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},d4,Ps=!0,Fd="[DecimalError] ",I0=Fd+"Invalid argument: ",u4=Fd+"Exponent out of range: ",R_=Math.floor,y0=Math.pow,Yje=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ju,ol=1e7,cs=7,$Q=9007199254740991,CT=R_($Q/cs),hn={};hn.absoluteValue=hn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};hn.comparedTo=hn.cmp=function(e){var t,r,n,a,c=this;if(e=new c.constructor(e),c.s!==e.s)return c.s||-e.s;if(c.e!==e.e)return c.e>e.e^c.s<0?1:-1;for(n=c.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(c.d[t]!==e.d[t])return c.d[t]>e.d[t]^c.s<0?1:-1;return n===a?0:n>a^c.s<0?1:-1};hn.decimalPlaces=hn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*cs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};hn.dividedBy=hn.div=function(e){return gm(this,new this.constructor(e))};hn.dividedToIntegerBy=hn.idiv=function(e){var t=this,r=t.constructor;return Fa(gm(t,new r(e),0,1),r.precision)};hn.equals=hn.eq=function(e){return!this.cmp(e)};hn.exponent=function(){return wo(this)};hn.greaterThan=hn.gt=function(e){return this.cmp(e)>0};hn.greaterThanOrEqualTo=hn.gte=function(e){return this.cmp(e)>=0};hn.isInteger=hn.isint=function(){return this.e>this.d.length-2};hn.isNegative=hn.isneg=function(){return this.s<0};hn.isPositive=hn.ispos=function(){return this.s>0};hn.isZero=function(){return this.s===0};hn.lessThan=hn.lt=function(e){return this.cmp(e)<0};hn.lessThanOrEqualTo=hn.lte=function(e){return this.cmp(e)<1};hn.logarithm=hn.log=function(e){var t,r=this,n=r.constructor,a=n.precision,c=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(ju))throw Error(Fd+"NaN");if(r.s<1)throw Error(Fd+(r.s?"NaN":"-Infinity"));return r.eq(ju)?new n(0):(Ps=!1,t=gm(dw(r,c),dw(e,c),c),Ps=!0,Fa(t,a))};hn.minus=hn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?WQ(t,e):qQ(t,(e.s=-e.s,e))};hn.modulo=hn.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Fd+"NaN");return r.s?(Ps=!1,t=gm(r,e,0,1).times(e),Ps=!0,r.minus(t)):Fa(new n(r),a)};hn.naturalExponential=hn.exp=function(){return GQ(this)};hn.naturalLogarithm=hn.ln=function(){return dw(this)};hn.negated=hn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};hn.plus=hn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?qQ(t,e):WQ(t,(e.s=-e.s,e))};hn.precision=hn.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(I0+e);if(t=wo(a)+1,n=a.d.length-1,r=n*cs+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};hn.squareRoot=hn.sqrt=function(){var e,t,r,n,a,c,f,i=this,x=i.constructor;if(i.s<1){if(!i.s)return new x(0);throw Error(Fd+"NaN")}for(e=wo(i),Ps=!1,a=Math.sqrt(+i),a==0||a==1/0?(t=$f(i.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=R_((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new x(t)):n=new x(a.toString()),r=x.precision,a=f=r+3;;)if(c=n,n=c.plus(gm(i,c,f+2)).times(.5),$f(c.d).slice(0,f)===(t=$f(n.d)).slice(0,f)){if(t=t.slice(f-3,f+1),a==f&&t=="4999"){if(Fa(c,r+1,0),c.times(c).eq(i)){n=c;break}}else if(t!="9999")break;f+=4}return Ps=!0,Fa(n,r)};hn.times=hn.mul=function(e){var t,r,n,a,c,f,i,x,w,A=this,P=A.constructor,E=A.d,D=(e=new P(e)).d;if(!A.s||!e.s)return new P(0);for(e.s*=A.s,r=A.e+e.e,x=E.length,w=D.length,x<w&&(c=E,E=D,D=c,f=x,x=w,w=f),c=[],f=x+w,n=f;n--;)c.push(0);for(n=w;--n>=0;){for(t=0,a=x+n;a>n;)i=c[a]+D[n]*E[a-n-1]+t,c[a--]=i%ol|0,t=i/ol|0;c[a]=(c[a]+t)%ol|0}for(;!c[--f];)c.pop();return t?++r:c.shift(),e.d=c,e.e=r,Ps?Fa(e,P.precision):e};hn.toDecimalPlaces=hn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(sp(e,0,O_),t===void 0?t=n.rounding:sp(t,0,8),Fa(r,e+wo(r)+1,t))};hn.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=G0(n,!0):(sp(e,0,O_),t===void 0?t=a.rounding:sp(t,0,8),n=Fa(new a(n),e+1,t),r=G0(n,!0,e+1)),r};hn.toFixed=function(e,t){var r,n,a=this,c=a.constructor;return e===void 0?G0(a):(sp(e,0,O_),t===void 0?t=c.rounding:sp(t,0,8),n=Fa(new c(a),e+wo(a)+1,t),r=G0(n.abs(),!1,e+wo(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};hn.toInteger=hn.toint=function(){var e=this,t=e.constructor;return Fa(new t(e),wo(e)+1,t.rounding)};hn.toNumber=function(){return+this};hn.toPower=hn.pow=function(e){var t,r,n,a,c,f,i=this,x=i.constructor,w=12,A=+(e=new x(e));if(!e.s)return new x(ju);if(i=new x(i),!i.s){if(e.s<1)throw Error(Fd+"Infinity");return i}if(i.eq(ju))return i;if(n=x.precision,e.eq(ju))return Fa(i,n);if(t=e.e,r=e.d.length-1,f=t>=r,c=i.s,f){if((r=A<0?-A:A)<=$Q){for(a=new x(ju),t=Math.ceil(n/cs+4),Ps=!1;r%2&&(a=a.times(i),q9(a.d,t)),r=R_(r/2),r!==0;)i=i.times(i),q9(i.d,t);return Ps=!0,e.s<0?new x(ju).div(a):Fa(a,n)}}else if(c<0)throw Error(Fd+"NaN");return c=c<0&&e.d[Math.max(t,r)]&1?-1:1,i.s=1,Ps=!1,a=e.times(dw(i,n+w)),Ps=!0,a=GQ(a),a.s=c,a};hn.toPrecision=function(e,t){var r,n,a=this,c=a.constructor;return e===void 0?(r=wo(a),n=G0(a,r<=c.toExpNeg||r>=c.toExpPos)):(sp(e,1,O_),t===void 0?t=c.rounding:sp(t,0,8),a=Fa(new c(a),e,t),r=wo(a),n=G0(a,e<=r||r<=c.toExpNeg,e)),n};hn.toSignificantDigits=hn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(sp(e,1,O_),t===void 0?t=n.rounding:sp(t,0,8)),Fa(new n(r),e,t)};hn.toString=hn.valueOf=hn.val=hn.toJSON=hn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=wo(e),r=e.constructor;return G0(e,t<=r.toExpNeg||t>=r.toExpPos)};function qQ(e,t){var r,n,a,c,f,i,x,w,A=e.constructor,P=A.precision;if(!e.s||!t.s)return t.s||(t=new A(e)),Ps?Fa(t,P):t;if(x=e.d,w=t.d,f=e.e,a=t.e,x=x.slice(),c=f-a,c){for(c<0?(n=x,c=-c,i=w.length):(n=w,a=f,i=x.length),f=Math.ceil(P/cs),i=f>i?f+1:i+1,c>i&&(c=i,n.length=1),n.reverse();c--;)n.push(0);n.reverse()}for(i=x.length,c=w.length,i-c<0&&(c=i,n=w,w=x,x=n),r=0;c;)r=(x[--c]=x[c]+w[c]+r)/ol|0,x[c]%=ol;for(r&&(x.unshift(r),++a),i=x.length;x[--i]==0;)x.pop();return t.d=x,t.e=a,Ps?Fa(t,P):t}function sp(e,t,r){if(e!==~~e||e<t||e>r)throw Error(I0+e)}function $f(e){var t,r,n,a=e.length-1,c="",f=e[0];if(a>0){for(c+=f,t=1;t<a;t++)n=e[t]+"",r=cs-n.length,r&&(c+=Ig(r)),c+=n;f=e[t],n=f+"",r=cs-n.length,r&&(c+=Ig(r))}else if(f===0)return"0";for(;f%10===0;)f/=10;return c+f}var gm=function(){function e(n,a){var c,f=0,i=n.length;for(n=n.slice();i--;)c=n[i]*a+f,n[i]=c%ol|0,f=c/ol|0;return f&&n.unshift(f),n}function t(n,a,c,f){var i,x;if(c!=f)x=c>f?1:-1;else for(i=x=0;i<c;i++)if(n[i]!=a[i]){x=n[i]>a[i]?1:-1;break}return x}function r(n,a,c){for(var f=0;c--;)n[c]-=f,f=n[c]<a[c]?1:0,n[c]=f*ol+n[c]-a[c];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,c,f){var i,x,w,A,P,E,D,V,L,$,H,K,Q,ae,ee,se,ce,he,Pe=n.constructor,Ne=n.s==a.s?1:-1,pe=n.d,je=a.d;if(!n.s)return new Pe(n);if(!a.s)throw Error(Fd+"Division by zero");for(x=n.e-a.e,ce=je.length,ee=pe.length,D=new Pe(Ne),V=D.d=[],w=0;je[w]==(pe[w]||0);)++w;if(je[w]>(pe[w]||0)&&--x,c==null?K=c=Pe.precision:f?K=c+(wo(n)-wo(a))+1:K=c,K<0)return new Pe(0);if(K=K/cs+2|0,w=0,ce==1)for(A=0,je=je[0],K++;(w<ee||A)&&K--;w++)Q=A*ol+(pe[w]||0),V[w]=Q/je|0,A=Q%je|0;else{for(A=ol/(je[0]+1)|0,A>1&&(je=e(je,A),pe=e(pe,A),ce=je.length,ee=pe.length),ae=ce,L=pe.slice(0,ce),$=L.length;$<ce;)L[$++]=0;he=je.slice(),he.unshift(0),se=je[0],je[1]>=ol/2&&++se;do A=0,i=t(je,L,ce,$),i<0?(H=L[0],ce!=$&&(H=H*ol+(L[1]||0)),A=H/se|0,A>1?(A>=ol&&(A=ol-1),P=e(je,A),E=P.length,$=L.length,i=t(P,L,E,$),i==1&&(A--,r(P,ce<E?he:je,E))):(A==0&&(i=A=1),P=je.slice()),E=P.length,E<$&&P.unshift(0),r(L,P,$),i==-1&&($=L.length,i=t(je,L,ce,$),i<1&&(A++,r(L,ce<$?he:je,$))),$=L.length):i===0&&(A++,L=[0]),V[w++]=A,i&&L[0]?L[$++]=pe[ae]||0:(L=[pe[ae]],$=1);while((ae++<ee||L[0]!==void 0)&&K--)}return V[0]||V.shift(),D.e=x,Fa(D,f?c+wo(D)+1:c)}}();function GQ(e,t){var r,n,a,c,f,i,x=0,w=0,A=e.constructor,P=A.precision;if(wo(e)>16)throw Error(u4+wo(e));if(!e.s)return new A(ju);for(Ps=!1,i=P,f=new A(.03125);e.abs().gte(.1);)e=e.times(f),w+=5;for(n=Math.log(y0(2,w))/Math.LN10*2+5|0,i+=n,r=a=c=new A(ju),A.precision=i;;){if(a=Fa(a.times(e),i),r=r.times(++x),f=c.plus(gm(a,r,i)),$f(f.d).slice(0,i)===$f(c.d).slice(0,i)){for(;w--;)c=Fa(c.times(c),i);return A.precision=P,t==null?(Ps=!0,Fa(c,P)):c}c=f}}function wo(e){for(var t=e.e*cs,r=e.d[0];r>=10;r/=10)t++;return t}function QM(e,t,r){if(t>e.LN10.sd())throw Ps=!0,r&&(e.precision=r),Error(Fd+"LN10 precision limit exceeded");return Fa(new e(e.LN10),t)}function Ig(e){for(var t="";e--;)t+="0";return t}function dw(e,t){var r,n,a,c,f,i,x,w,A,P=1,E=10,D=e,V=D.d,L=D.constructor,$=L.precision;if(D.s<1)throw Error(Fd+(D.s?"NaN":"-Infinity"));if(D.eq(ju))return new L(0);if(t==null?(Ps=!1,w=$):w=t,D.eq(10))return t==null&&(Ps=!0),QM(L,w);if(w+=E,L.precision=w,r=$f(V),n=r.charAt(0),c=wo(D),Math.abs(c)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)D=D.times(e),r=$f(D.d),n=r.charAt(0),P++;c=wo(D),n>1?(D=new L("0."+r),c++):D=new L(n+"."+r.slice(1))}else return x=QM(L,w+2,$).times(c+""),D=dw(new L(n+"."+r.slice(1)),w-E).plus(x),L.precision=$,t==null?(Ps=!0,Fa(D,$)):D;for(i=f=D=gm(D.minus(ju),D.plus(ju),w),A=Fa(D.times(D),w),a=3;;){if(f=Fa(f.times(A),w),x=i.plus(gm(f,new L(a),w)),$f(x.d).slice(0,w)===$f(i.d).slice(0,w))return i=i.times(2),c!==0&&(i=i.plus(QM(L,w+2,$).times(c+""))),i=gm(i,new L(P),w),L.precision=$,t==null?(Ps=!0,Fa(i,$)):i;i=x,a+=2}}function $9(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=R_(r/cs),e.d=[],n=(r+1)%cs,r<0&&(n+=cs),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=cs;n<a;)e.d.push(+t.slice(n,n+=cs));t=t.slice(n),n=cs-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Ps&&(e.e>CT||e.e<-CT))throw Error(u4+r)}else e.s=0,e.e=0,e.d=[0];return e}function Fa(e,t,r){var n,a,c,f,i,x,w,A,P=e.d;for(f=1,c=P[0];c>=10;c/=10)f++;if(n=t-f,n<0)n+=cs,a=t,w=P[A=0];else{if(A=Math.ceil((n+1)/cs),c=P.length,A>=c)return e;for(w=c=P[A],f=1;c>=10;c/=10)f++;n%=cs,a=n-cs+f}if(r!==void 0&&(c=y0(10,f-a-1),i=w/c%10|0,x=t<0||P[A+1]!==void 0||w%c,x=r<4?(i||x)&&(r==0||r==(e.s<0?3:2)):i>5||i==5&&(r==4||x||r==6&&(n>0?a>0?w/y0(10,f-a):0:P[A-1])%10&1||r==(e.s<0?8:7))),t<1||!P[0])return x?(c=wo(e),P.length=1,t=t-c-1,P[0]=y0(10,(cs-t%cs)%cs),e.e=R_(-t/cs)||0):(P.length=1,P[0]=e.e=e.s=0),e;if(n==0?(P.length=A,c=1,A--):(P.length=A+1,c=y0(10,cs-n),P[A]=a>0?(w/y0(10,f-a)%y0(10,a)|0)*c:0),x)for(;;)if(A==0){(P[0]+=c)==ol&&(P[0]=1,++e.e);break}else{if(P[A]+=c,P[A]!=ol)break;P[A--]=0,c=1}for(n=P.length;P[--n]===0;)P.pop();if(Ps&&(e.e>CT||e.e<-CT))throw Error(u4+wo(e));return e}function WQ(e,t){var r,n,a,c,f,i,x,w,A,P,E=e.constructor,D=E.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new E(e),Ps?Fa(t,D):t;if(x=e.d,P=t.d,n=t.e,w=e.e,x=x.slice(),f=w-n,f){for(A=f<0,A?(r=x,f=-f,i=P.length):(r=P,n=w,i=x.length),a=Math.max(Math.ceil(D/cs),i)+2,f>a&&(f=a,r.length=1),r.reverse(),a=f;a--;)r.push(0);r.reverse()}else{for(a=x.length,i=P.length,A=a<i,A&&(i=a),a=0;a<i;a++)if(x[a]!=P[a]){A=x[a]<P[a];break}f=0}for(A&&(r=x,x=P,P=r,t.s=-t.s),i=x.length,a=P.length-i;a>0;--a)x[i++]=0;for(a=P.length;a>f;){if(x[--a]<P[a]){for(c=a;c&&x[--c]===0;)x[c]=ol-1;--x[c],x[a]+=ol}x[a]-=P[a]}for(;x[--i]===0;)x.pop();for(;x[0]===0;x.shift())--n;return x[0]?(t.d=x,t.e=n,Ps?Fa(t,D):t):new E(0)}function G0(e,t,r){var n,a=wo(e),c=$f(e.d),f=c.length;return t?(r&&(n=r-f)>0?c=c.charAt(0)+"."+c.slice(1)+Ig(n):f>1&&(c=c.charAt(0)+"."+c.slice(1)),c=c+(a<0?"e":"e+")+a):a<0?(c="0."+Ig(-a-1)+c,r&&(n=r-f)>0&&(c+=Ig(n))):a>=f?(c+=Ig(a+1-f),r&&(n=r-a-1)>0&&(c=c+"."+Ig(n))):((n=a+1)<f&&(c=c.slice(0,n)+"."+c.slice(n)),r&&(n=r-f)>0&&(a+1===f&&(c+="."),c+=Ig(n))),e.s<0?"-"+c:c}function q9(e,t){if(e.length>t)return e.length=t,!0}function HQ(e){var t,r,n;function a(c){var f=this;if(!(f instanceof a))return new a(c);if(f.constructor=a,c instanceof a){f.s=c.s,f.e=c.e,f.d=(c=c.d)?c.slice():c;return}if(typeof c=="number"){if(c*0!==0)throw Error(I0+c);if(c>0)f.s=1;else if(c<0)c=-c,f.s=-1;else{f.s=0,f.e=0,f.d=[0];return}if(c===~~c&&c<1e7){f.e=0,f.d=[c];return}return $9(f,c.toString())}else if(typeof c!="string")throw Error(I0+c);if(c.charCodeAt(0)===45?(c=c.slice(1),f.s=-1):f.s=1,Yje.test(c))$9(f,c);else throw Error(I0+c)}if(a.prototype=hn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=HQ,a.config=a.set=Xje,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function Xje(e){if(!e||typeof e!="object")throw Error(Fd+"Object expected");var t,r,n,a=["precision",1,O_,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(R_(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(I0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(I0+r+": "+n);return this}var d4=HQ(Zje);ju=new d4(1);const Ma=d4;function Jje(e){return rCe(e)||tCe(e)||eCe(e)||Qje()}function Qje(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eCe(e,t){if(e){if(typeof e=="string")return vI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vI(e,t)}}function tCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function rCe(e){if(Array.isArray(e))return vI(e)}function vI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var nCe=function(t){return t},KQ={},ZQ=function(t){return t===KQ},G9=function(t){return function r(){return arguments.length===0||arguments.length===1&&ZQ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},iCe=function e(t,r){return t===1?r:G9(function(){for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];var f=a.filter(function(i){return i!==KQ}).length;return f>=t?r.apply(void 0,a):e(t-f,G9(function(){for(var i=arguments.length,x=new Array(i),w=0;w<i;w++)x[w]=arguments[w];var A=a.map(function(P){return ZQ(P)?x.shift():P});return r.apply(void 0,Jje(A).concat(x))}))})},mN=function(t){return iCe(t.length,t)},xI=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},aCe=mN(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),sCe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return nCe;var a=r.reverse(),c=a[0],f=a.slice(1);return function(){return f.reduce(function(i,x){return x(i)},c.apply(void 0,arguments))}},_I=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},YQ=function(t){var r=null,n=null;return function(){for(var a=arguments.length,c=new Array(a),f=0;f<a;f++)c[f]=arguments[f];return r&&c.every(function(i,x){return i===r[x]})||(r=c,n=t.apply(void 0,c)),n}};function oCe(e){var t;return e===0?t=1:t=Math.floor(new Ma(e).abs().log(10).toNumber())+1,t}function lCe(e,t,r){for(var n=new Ma(e),a=0,c=[];n.lt(t)&&a<1e5;)c.push(n.toNumber()),n=n.add(r),a++;return c}var cCe=mN(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),uCe=mN(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),dCe=mN(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const gN={rangeStep:lCe,getDigitCount:oCe,interpolateNumber:cCe,uninterpolateNumber:uCe,uninterpolateTruncation:dCe};function bI(e){return pCe(e)||fCe(e)||XQ(e)||hCe()}function hCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fCe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function pCe(e){if(Array.isArray(e))return wI(e)}function hw(e,t){return yCe(e)||gCe(e,t)||XQ(e,t)||mCe()}function mCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XQ(e,t){if(e){if(typeof e=="string")return wI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wI(e,t)}}function wI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function gCe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,c=void 0;try{for(var f=e[Symbol.iterator](),i;!(n=(i=f.next()).done)&&(r.push(i.value),!(t&&r.length===t));n=!0);}catch(x){a=!0,c=x}finally{try{!n&&f.return!=null&&f.return()}finally{if(a)throw c}}return r}}function yCe(e){if(Array.isArray(e))return e}function JQ(e){var t=hw(e,2),r=t[0],n=t[1],a=r,c=n;return r>n&&(a=n,c=r),[a,c]}function QQ(e,t,r){if(e.lte(0))return new Ma(0);var n=gN.getDigitCount(e.toNumber()),a=new Ma(10).pow(n),c=e.div(a),f=n!==1?.05:.1,i=new Ma(Math.ceil(c.div(f).toNumber())).add(r).mul(f),x=i.mul(a);return t?x:new Ma(Math.ceil(x))}function vCe(e,t,r){var n=1,a=new Ma(e);if(!a.isint()&&r){var c=Math.abs(e);c<1?(n=new Ma(10).pow(gN.getDigitCount(e)-1),a=new Ma(Math.floor(a.div(n).toNumber())).mul(n)):c>1&&(a=new Ma(Math.floor(e)))}else e===0?a=new Ma(Math.floor((t-1)/2)):r||(a=new Ma(Math.floor(e)));var f=Math.floor((t-1)/2),i=sCe(aCe(function(x){return a.add(new Ma(x-f).mul(n)).toNumber()}),xI);return i(0,t)}function eee(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Ma(0),tickMin:new Ma(0),tickMax:new Ma(0)};var c=QQ(new Ma(t).sub(e).div(r-1),n,a),f;e<=0&&t>=0?f=new Ma(0):(f=new Ma(e).add(t).div(2),f=f.sub(new Ma(f).mod(c)));var i=Math.ceil(f.sub(e).div(c).toNumber()),x=Math.ceil(new Ma(t).sub(f).div(c).toNumber()),w=i+x+1;return w>r?eee(e,t,r,n,a+1):(w<r&&(x=t>0?x+(r-w):x,i=t>0?i:i+(r-w)),{step:c,tickMin:f.sub(new Ma(i).mul(c)),tickMax:f.add(new Ma(x).mul(c))})}function xCe(e){var t=hw(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=Math.max(a,2),i=JQ([r,n]),x=hw(i,2),w=x[0],A=x[1];if(w===-1/0||A===1/0){var P=A===1/0?[w].concat(bI(xI(0,a-1).map(function(){return 1/0}))):[].concat(bI(xI(0,a-1).map(function(){return-1/0})),[A]);return r>n?_I(P):P}if(w===A)return vCe(w,a,c);var E=eee(w,A,f,c),D=E.step,V=E.tickMin,L=E.tickMax,$=gN.rangeStep(V,L.add(new Ma(.1).mul(D)),D);return r>n?_I($):$}function _Ce(e,t){var r=hw(e,2),n=r[0],a=r[1],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,f=JQ([n,a]),i=hw(f,2),x=i[0],w=i[1];if(x===-1/0||w===1/0)return[n,a];if(x===w)return[x];var A=Math.max(t,2),P=QQ(new Ma(w).sub(x).div(A-1),c,0),E=[].concat(bI(gN.rangeStep(new Ma(x),new Ma(w).sub(new Ma(.99).mul(P)),P)),[w]);return n>a?_I(E):E}var bCe=YQ(xCe),wCe=YQ(_Ce),SCe="Invariant failed";function W0(e,t){throw new Error(SCe)}var ACe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ux(e){"@babel/helpers - typeof";return Ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ux(e)}function kT(){return kT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kT.apply(this,arguments)}function TCe(e,t){return CCe(e)||jCe(e,t)||NCe(e,t)||PCe()}function PCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NCe(e,t){if(e){if(typeof e=="string")return W9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W9(e,t)}}function W9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jCe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function CCe(e){if(Array.isArray(e))return e}function kCe(e,t){if(e==null)return{};var r=ECe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ECe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function MCe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OCe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nee(n.key),n)}}function RCe(e,t,r){return t&&OCe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ICe(e,t,r){return t=ET(t),DCe(e,tee()?Reflect.construct(t,r||[],ET(e).constructor):t.apply(e,r))}function DCe(e,t){if(t&&(Ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LCe(e)}function LCe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tee=function(){return!!e})()}function ET(e){return ET=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ET(e)}function zCe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&SI(e,t)}function SI(e,t){return SI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},SI(e,t)}function ree(e,t,r){return t=nee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nee(e){var t=FCe(e,"string");return Ux(t)=="symbol"?t:t+""}function FCe(e,t){if(Ux(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ux(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var I_=function(e){function t(){return MCe(this,t),ICe(this,t,arguments)}return zCe(t,e),RCe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,c=n.layout,f=n.width,i=n.dataKey,x=n.data,w=n.dataPointFormatter,A=n.xAxis,P=n.yAxis,E=kCe(n,ACe),D=vn(E,!1);this.props.direction==="x"&&A.type!=="number"&&W0();var V=x.map(function(L){var $=w(L,i),H=$.x,K=$.y,Q=$.value,ae=$.errorVal;if(!ae)return null;var ee=[],se,ce;if(Array.isArray(ae)){var he=TCe(ae,2);se=he[0],ce=he[1]}else se=ce=ae;if(c==="vertical"){var Pe=A.scale,Ne=K+a,pe=Ne+f,je=Ne-f,xe=Pe(Q-se),Ce=Pe(Q+ce);ee.push({x1:Ce,y1:pe,x2:Ce,y2:je}),ee.push({x1:xe,y1:Ne,x2:Ce,y2:Ne}),ee.push({x1:xe,y1:pe,x2:xe,y2:je})}else if(c==="horizontal"){var ze=P.scale,Te=H+a,Re=Te-f,Fe=Te+f,He=ze(Q-se),mt=ze(Q+ce);ee.push({x1:Re,y1:mt,x2:Fe,y2:mt}),ee.push({x1:Te,y1:He,x2:Te,y2:mt}),ee.push({x1:Re,y1:He,x2:Fe,y2:He})}return Oe.createElement(mi,kT({className:"recharts-errorBar",key:"bar-".concat(ee.map(function(Xe){return"".concat(Xe.x1,"-").concat(Xe.x2,"-").concat(Xe.y1,"-").concat(Xe.y2)}))},D),ee.map(function(Xe){return Oe.createElement("line",kT({},Xe,{key:"line-".concat(Xe.x1,"-").concat(Xe.x2,"-").concat(Xe.y1,"-").concat(Xe.y2)}))}))});return Oe.createElement(mi,{className:"recharts-errorBars"},V)}}])}(Oe.Component);ree(I_,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});ree(I_,"displayName","ErrorBar");function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}function H9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function h0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H9(Object(r),!0).forEach(function(n){BCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BCe(e,t,r){return t=VCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VCe(e){var t=UCe(e,"string");return fw(t)=="symbol"?t:t+""}function UCe(e,t){if(fw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var iee=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,c=t.legendContent,f=Pu(r,Yf);if(!f)return null;var i=Yf.defaultProps,x=i!==void 0?h0(h0({},i),f.props):{},w;return f.props&&f.props.payload?w=f.props&&f.props.payload:c==="children"?w=(n||[]).reduce(function(A,P){var E=P.item,D=P.props,V=D.sectors||D.data||[];return A.concat(V.map(function(L){return{type:f.props.iconType||E.props.legendType,value:L.name,color:L.fill,payload:L}}))},[]):w=(n||[]).map(function(A){var P=A.item,E=P.type.defaultProps,D=E!==void 0?h0(h0({},E),P.props):{},V=D.dataKey,L=D.name,$=D.legendType,H=D.hide;return{inactive:H,dataKey:V,type:x.iconType||$||"square",color:h4(P),value:L||V,payload:D}}),h0(h0(h0({},x),Yf.getWithHeight(f,a)),{},{payload:w,item:f})};function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function K9(e){return WCe(e)||GCe(e)||qCe(e)||$Ce()}function $Ce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qCe(e,t){if(e){if(typeof e=="string")return AI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AI(e,t)}}function GCe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WCe(e){if(Array.isArray(e))return AI(e)}function AI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Z9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z9(Object(r),!0).forEach(function(n){Ax(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ax(e,t,r){return t=HCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HCe(e){var t=KCe(e,"string");return pw(t)=="symbol"?t:t+""}function KCe(e,t){if(pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ya(e,t,r){return Xn(e)||Xn(t)?r:Vo(t)?Iu(e,t,r):qn(t)?t(e):r}function g1(e,t,r,n){var a=Wje(e,function(i){return Ya(i,t)});if(r==="number"){var c=a.filter(function(i){return zr(i)||parseFloat(i)});return c.length?[pN(c),Bg(c)]:[1/0,-1/0]}var f=n?a.filter(function(i){return!Xn(i)}):a;return f.map(function(i){return Vo(i)||i instanceof Date?i:""})}var ZCe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0,f=-1,i=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(i<=1)return 0;if(c&&c.axisType==="angleAxis"&&Math.abs(Math.abs(c.range[1]-c.range[0])-360)<=1e-6)for(var x=c.range,w=0;w<i;w++){var A=w>0?a[w-1].coordinate:a[i-1].coordinate,P=a[w].coordinate,E=w>=i-1?a[0].coordinate:a[w+1].coordinate,D=void 0;if(ul(P-A)!==ul(E-P)){var V=[];if(ul(E-P)===ul(x[1]-x[0])){D=E;var L=P+x[1]-x[0];V[0]=Math.min(L,(L+A)/2),V[1]=Math.max(L,(L+A)/2)}else{D=A;var $=E+x[1]-x[0];V[0]=Math.min(P,($+P)/2),V[1]=Math.max(P,($+P)/2)}var H=[Math.min(P,(D+P)/2),Math.max(P,(D+P)/2)];if(t>H[0]&&t<=H[1]||t>=V[0]&&t<=V[1]){f=a[w].index;break}}else{var K=Math.min(A,E),Q=Math.max(A,E);if(t>(K+P)/2&&t<=(Q+P)/2){f=a[w].index;break}}}else for(var ae=0;ae<i;ae++)if(ae===0&&t<=(n[ae].coordinate+n[ae+1].coordinate)/2||ae>0&&ae<i-1&&t>(n[ae].coordinate+n[ae-1].coordinate)/2&&t<=(n[ae].coordinate+n[ae+1].coordinate)/2||ae===i-1&&t>(n[ae].coordinate+n[ae-1].coordinate)/2){f=n[ae].index;break}return f},h4=function(t){var r,n=t,a=n.type.displayName,c=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Hs(Hs({},t.type.defaultProps),t.props):t.props,f=c.stroke,i=c.fill,x;switch(a){case"Line":x=f;break;case"Area":case"Radar":x=f&&f!=="none"?f:i;break;default:x=i;break}return x},YCe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,c=a===void 0?{}:a;if(!c)return{};for(var f={},i=Object.keys(c),x=0,w=i.length;x<w;x++)for(var A=c[i[x]].stackGroups,P=Object.keys(A),E=0,D=P.length;E<D;E++){var V=A[P[E]],L=V.items,$=V.cateAxisId,H=L.filter(function(ce){return mm(ce.type).indexOf("Bar")>=0});if(H&&H.length){var K=H[0].type.defaultProps,Q=K!==void 0?Hs(Hs({},K),H[0].props):H[0].props,ae=Q.barSize,ee=Q[$];f[ee]||(f[ee]=[]);var se=Xn(ae)?r:ae;f[ee].push({item:H[0],stackList:H.slice(1),barSize:Xn(se)?void 0:vc(se,n,0)})}}return f},XCe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,c=t.sizeList,f=c===void 0?[]:c,i=t.maxBarSize,x=f.length;if(x<1)return null;var w=vc(r,a,0,!0),A,P=[];if(f[0].barSize===+f[0].barSize){var E=!1,D=a/x,V=f.reduce(function(ae,ee){return ae+ee.barSize||0},0);V+=(x-1)*w,V>=a&&(V-=(x-1)*w,w=0),V>=a&&D>0&&(E=!0,D*=.9,V=x*D);var L=(a-V)/2>>0,$={offset:L-w,size:0};A=f.reduce(function(ae,ee){var se={item:ee.item,position:{offset:$.offset+$.size+w,size:E?D:ee.barSize}},ce=[].concat(K9(ae),[se]);return $=ce[ce.length-1].position,ee.stackList&&ee.stackList.length&&ee.stackList.forEach(function(he){ce.push({item:he,position:$})}),ce},P)}else{var H=vc(n,a,0,!0);a-2*H-(x-1)*w<=0&&(w=0);var K=(a-2*H-(x-1)*w)/x;K>1&&(K>>=0);var Q=i===+i?Math.min(K,i):K;A=f.reduce(function(ae,ee,se){var ce=[].concat(K9(ae),[{item:ee.item,position:{offset:H+(K+w)*se+(K-Q)/2,size:Q}}]);return ee.stackList&&ee.stackList.length&&ee.stackList.forEach(function(he){ce.push({item:he,position:ce[ce.length-1].position})}),ce},P)}return A},JCe=function(t,r,n,a){var c=n.children,f=n.width,i=n.margin,x=f-(i.left||0)-(i.right||0),w=iee({children:c,legendWidth:x});if(w){var A=a||{},P=A.width,E=A.height,D=w.align,V=w.verticalAlign,L=w.layout;if((L==="vertical"||L==="horizontal"&&V==="middle")&&D!=="center"&&zr(t[D]))return Hs(Hs({},t),{},Ax({},D,t[D]+(P||0)));if((L==="horizontal"||L==="vertical"&&D==="center")&&V!=="middle"&&zr(t[V]))return Hs(Hs({},t),{},Ax({},V,t[V]+(E||0)))}return t},QCe=function(t,r,n){return Xn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},aee=function(t,r,n,a,c){var f=r.props.children,i=Xl(f,I_).filter(function(w){return QCe(a,c,w.props.direction)});if(i&&i.length){var x=i.map(function(w){return w.props.dataKey});return t.reduce(function(w,A){var P=Ya(A,n);if(Xn(P))return w;var E=Array.isArray(P)?[pN(P),Bg(P)]:[P,P],D=x.reduce(function(V,L){var $=Ya(A,L,0),H=E[0]-Math.abs(Array.isArray($)?$[0]:$),K=E[1]+Math.abs(Array.isArray($)?$[1]:$);return[Math.min(H,V[0]),Math.max(K,V[1])]},[1/0,-1/0]);return[Math.min(D[0],w[0]),Math.max(D[1],w[1])]},[1/0,-1/0])}return null},eke=function(t,r,n,a,c){var f=r.map(function(i){return aee(t,i,n,c,a)}).filter(function(i){return!Xn(i)});return f&&f.length?f.reduce(function(i,x){return[Math.min(i[0],x[0]),Math.max(i[1],x[1])]},[1/0,-1/0]):null},see=function(t,r,n,a,c){var f=r.map(function(x){var w=x.props.dataKey;return n==="number"&&w&&aee(t,x,w,a)||g1(t,w,n,c)});if(n==="number")return f.reduce(function(x,w){return[Math.min(x[0],w[0]),Math.max(x[1],w[1])]},[1/0,-1/0]);var i={};return f.reduce(function(x,w){for(var A=0,P=w.length;A<P;A++)i[w[A]]||(i[w[A]]=!0,x.push(w[A]));return x},[])},oee=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},lee=function(t,r,n,a){if(a)return t.map(function(x){return x.coordinate});var c,f,i=t.map(function(x){return x.coordinate===r&&(c=!0),x.coordinate===n&&(f=!0),x.coordinate});return c||i.push(r),f||i.push(n),i},dm=function(t,r,n){if(!t)return null;var a=t.scale,c=t.duplicateDomain,f=t.type,i=t.range,x=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,w=(r||n)&&f==="category"&&a.bandwidth?a.bandwidth()/x:0;if(w=t.axisType==="angleAxis"&&(i==null?void 0:i.length)>=2?ul(i[0]-i[1])*2*w:w,r&&(t.ticks||t.niceTicks)){var A=(t.ticks||t.niceTicks).map(function(P){var E=c?c.indexOf(P):P;return{coordinate:a(E)+w,value:P,offset:w}});return A.filter(function(P){return!k_(P.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(P,E){return{coordinate:a(P)+w,value:P,index:E,offset:w}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(P){return{coordinate:a(P)+w,value:P,offset:w}}):a.domain().map(function(P,E){return{coordinate:a(P)+w,value:c?c[P]:P,index:E,offset:w}})},eO=new WeakMap,ZS=function(t,r){if(typeof r!="function")return t;eO.has(t)||eO.set(t,new WeakMap);var n=eO.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},cee=function(t,r,n){var a=t.scale,c=t.type,f=t.layout,i=t.axisType;if(a==="auto")return f==="radial"&&i==="radiusAxis"?{scale:sw(),realScaleType:"band"}:f==="radial"&&i==="angleAxis"?{scale:TT(),realScaleType:"linear"}:c==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:m1(),realScaleType:"point"}:c==="category"?{scale:sw(),realScaleType:"band"}:{scale:TT(),realScaleType:"linear"};if(l2(a)){var x="scale".concat(QP(a));return{scale:(R9[x]||m1)(),realScaleType:R9[x]?x:"point"}}return qn(a)?{scale:a}:{scale:m1(),realScaleType:"point"}},Y9=1e-4,uee=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),c=Math.min(a[0],a[1])-Y9,f=Math.max(a[0],a[1])+Y9,i=t(r[0]),x=t(r[n-1]);(i<c||i>f||x<c||x>f)&&t.domain([r[0],r[n-1]])}},dee=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},hee=function(t,r){if(!r||r.length!==2||!zr(r[0])||!zr(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),c=[t[0],t[1]];return(!zr(t[0])||t[0]<n)&&(c[0]=n),(!zr(t[1])||t[1]>a)&&(c[1]=a),c[0]>a&&(c[0]=a),c[1]<n&&(c[1]=n),c},tke=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var c=0,f=0,i=0;i<r;++i){var x=k_(t[i][n][1])?t[i][n][0]:t[i][n][1];x>=0?(t[i][n][0]=c,t[i][n][1]=c+x,c=t[i][n][1]):(t[i][n][0]=f,t[i][n][1]=f+x,f=t[i][n][1])}},rke=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var c=0,f=0;f<r;++f){var i=k_(t[f][n][1])?t[f][n][0]:t[f][n][1];i>=0?(t[f][n][0]=c,t[f][n][1]=c+i,c=t[f][n][1]):(t[f][n][0]=0,t[f][n][1]=0)}},nke={sign:tke,expand:W2e,none:Rx,silhouette:H2e,wiggle:K2e,positive:rke},ike=function(t,r,n){var a=r.map(function(i){return i.props.dataKey}),c=nke[n],f=G2e().keys(a).value(function(i,x){return+Ya(i,x,0)}).order(eI).offset(c);return f(t)},ake=function(t,r,n,a,c,f){if(!t)return null;var i=f?r.reverse():r,x={},w=i.reduce(function(P,E){var D,V=(D=E.type)!==null&&D!==void 0&&D.defaultProps?Hs(Hs({},E.type.defaultProps),E.props):E.props,L=V.stackId,$=V.hide;if($)return P;var H=V[n],K=P[H]||{hasStack:!1,stackGroups:{}};if(Vo(L)){var Q=K.stackGroups[L]||{numericAxisId:n,cateAxisId:a,items:[]};Q.items.push(E),K.hasStack=!0,K.stackGroups[L]=Q}else K.stackGroups[dy("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[E]};return Hs(Hs({},P),{},Ax({},H,K))},x),A={};return Object.keys(w).reduce(function(P,E){var D=w[E];if(D.hasStack){var V={};D.stackGroups=Object.keys(D.stackGroups).reduce(function(L,$){var H=D.stackGroups[$];return Hs(Hs({},L),{},Ax({},$,{numericAxisId:n,cateAxisId:a,items:H.items,stackedData:ike(t,H.items,c)}))},V)}return Hs(Hs({},P),{},Ax({},E,D))},A)},fee=function(t,r){var n=r.realScaleType,a=r.type,c=r.tickCount,f=r.originalDomain,i=r.allowDecimals,x=n||r.scale;if(x!=="auto"&&x!=="linear")return null;if(c&&a==="number"&&f&&(f[0]==="auto"||f[1]==="auto")){var w=t.domain();if(!w.length)return null;var A=bCe(w,c,i);return t.domain([pN(A),Bg(A)]),{niceTicks:A}}if(c&&a==="number"){var P=t.domain(),E=wCe(P,c,i);return{niceTicks:E}}return null};function $x(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,c=e.index,f=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Xn(a[t.dataKey])){var i=oT(r,"value",a[t.dataKey]);if(i)return i.coordinate+n/2}return r[c]?r[c].coordinate+n/2:null}var x=Ya(a,Xn(f)?t.dataKey:f);return Xn(x)?null:t.scale(x)}var MT=function(t){var r=t.axis,n=t.ticks,a=t.offset,c=t.bandSize,f=t.entry,i=t.index;if(r.type==="category")return n[i]?n[i].coordinate+a:null;var x=Ya(f,r.dataKey,r.domain[i]);return Xn(x)?null:r.scale(x)-c/2+a},pee=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),c=Math.max(n[0],n[1]);return a<=0&&c>=0?0:c<0?c:a}return n[0]},ske=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?Hs(Hs({},t.type.defaultProps),t.props):t.props,c=a.stackId;if(Vo(c)){var f=r[c];if(f){var i=f.items.indexOf(t);return i>=0?f.stackedData[i]:null}}return null},oke=function(t){return t.reduce(function(r,n){return[pN(n.concat([r[0]]).filter(zr)),Bg(n.concat([r[1]]).filter(zr))]},[1/0,-1/0])},mee=function(t,r,n){return Object.keys(t).reduce(function(a,c){var f=t[c],i=f.stackedData,x=i.reduce(function(w,A){var P=oke(A.slice(r,n+1));return[Math.min(w[0],P[0]),Math.max(w[1],P[1])]},[1/0,-1/0]);return[Math.min(x[0],a[0]),Math.max(x[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},X9=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,J9=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,TI=function(t,r,n){if(qn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(zr(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(X9.test(t[0])){var c=+X9.exec(t[0])[1];a[0]=r[0]-c}else qn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(zr(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(J9.test(t[1])){var f=+J9.exec(t[1])[1];a[1]=r[1]+f}else qn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},OT=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var c=BL(r,function(P){return P.coordinate}),f=1/0,i=1,x=c.length;i<x;i++){var w=c[i],A=c[i-1];f=Math.min((w.coordinate||0)-(A.coordinate||0),f)}return f===1/0?0:f}return n?void 0:0},Q9=function(t,r,n){return!t||!t.length||Pm(t,Iu(n,"type.defaultProps.domain"))?r:t},f4=function(t,r){var n=t.type.defaultProps?Hs(Hs({},t.type.defaultProps),t.props):t.props,a=n.dataKey,c=n.name,f=n.unit,i=n.formatter,x=n.tooltipType,w=n.chartType,A=n.hide;return Hs(Hs({},vn(t,!1)),{},{dataKey:a,unit:f,formatter:i,name:c||a,color:h4(t),value:Ya(r,a),type:x,payload:r,chartType:w,hide:A})};function mw(e){"@babel/helpers - typeof";return mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(e)}function eq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eq(Object(r),!0).forEach(function(n){gee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gee(e,t,r){return t=lke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lke(e){var t=cke(e,"string");return mw(t)=="symbol"?t:t+""}function cke(e,t){if(mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uke(e,t){return pke(e)||fke(e,t)||hke(e,t)||dke()}function dke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hke(e,t){if(e){if(typeof e=="string")return tq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tq(e,t)}}function tq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function pke(e){if(Array.isArray(e))return e}var RT=Math.PI/180,mke=function(t){return t*180/Math.PI},Ba=function(t,r,n,a){return{x:t+Math.cos(-RT*a)*n,y:r+Math.sin(-RT*a)*n}},yee=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},vee=function(t,r,n,a,c){var f=t.width,i=t.height,x=t.startAngle,w=t.endAngle,A=vc(t.cx,f,f/2),P=vc(t.cy,i,i/2),E=yee(f,i,n),D=vc(t.innerRadius,E,0),V=vc(t.outerRadius,E,E*.8),L=Object.keys(r);return L.reduce(function($,H){var K=r[H],Q=K.domain,ae=K.reversed,ee;if(Xn(K.range))a==="angleAxis"?ee=[x,w]:a==="radiusAxis"&&(ee=[D,V]),ae&&(ee=[ee[1],ee[0]]);else{ee=K.range;var se=ee,ce=uke(se,2);x=ce[0],w=ce[1]}var he=cee(K,c),Pe=he.realScaleType,Ne=he.scale;Ne.domain(Q).range(ee),uee(Ne);var pe=fee(Ne,sm(sm({},K),{},{realScaleType:Pe})),je=sm(sm(sm({},K),pe),{},{range:ee,radius:V,realScaleType:Pe,scale:Ne,cx:A,cy:P,innerRadius:D,outerRadius:V,startAngle:x,endAngle:w});return sm(sm({},$),{},gee({},H,je))},{})},gke=function(t,r){var n=t.x,a=t.y,c=r.x,f=r.y;return Math.sqrt(Math.pow(n-c,2)+Math.pow(a-f,2))},yke=function(t,r){var n=t.x,a=t.y,c=r.cx,f=r.cy,i=gke({x:n,y:a},{x:c,y:f});if(i<=0)return{radius:i};var x=(n-c)/i,w=Math.acos(x);return a>f&&(w=2*Math.PI-w),{radius:i,angle:mke(w),angleInRadian:w}},vke=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),c=Math.floor(n/360),f=Math.min(a,c);return{startAngle:r-f*360,endAngle:n-f*360}},xke=function(t,r){var n=r.startAngle,a=r.endAngle,c=Math.floor(n/360),f=Math.floor(a/360),i=Math.min(c,f);return t+i*360},rq=function(t,r){var n=t.x,a=t.y,c=yke({x:n,y:a},r),f=c.radius,i=c.angle,x=r.innerRadius,w=r.outerRadius;if(f<x||f>w)return!1;if(f===0)return!0;var A=vke(r),P=A.startAngle,E=A.endAngle,D=i,V;if(P<=E){for(;D>E;)D-=360;for(;D<P;)D+=360;V=D>=P&&D<=E}else{for(;D>P;)D-=360;for(;D<E;)D+=360;V=D>=E&&D<=P}return V?sm(sm({},r),{},{radius:f,angle:xke(D,r)}):null},xee=function(t){return!W.isValidElement(t)&&!qn(t)&&typeof t!="boolean"?t.className:""};function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}var _ke=["offset"];function bke(e){return Tke(e)||Ake(e)||Ske(e)||wke()}function wke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ske(e,t){if(e){if(typeof e=="string")return PI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PI(e,t)}}function Ake(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tke(e){if(Array.isArray(e))return PI(e)}function PI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pke(e,t){if(e==null)return{};var r=Nke(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Nke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function nq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nq(Object(r),!0).forEach(function(n){jke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jke(e,t,r){return t=Cke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cke(e){var t=kke(e,"string");return gw(t)=="symbol"?t:t+""}function kke(e,t){if(gw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yw(){return yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yw.apply(this,arguments)}var Eke=function(t){var r=t.value,n=t.formatter,a=Xn(t.children)?r:t.children;return qn(n)?n(a):a},Mke=function(t,r){var n=ul(r-t),a=Math.min(Math.abs(r-t),360);return n*a},Oke=function(t,r,n){var a=t.position,c=t.viewBox,f=t.offset,i=t.className,x=c,w=x.cx,A=x.cy,P=x.innerRadius,E=x.outerRadius,D=x.startAngle,V=x.endAngle,L=x.clockWise,$=(P+E)/2,H=Mke(D,V),K=H>=0?1:-1,Q,ae;a==="insideStart"?(Q=D+K*f,ae=L):a==="insideEnd"?(Q=V-K*f,ae=!L):a==="end"&&(Q=V+K*f,ae=L),ae=H<=0?ae:!ae;var ee=Ba(w,A,$,Q),se=Ba(w,A,$,Q+(ae?1:-1)*359),ce="M".concat(ee.x,",").concat(ee.y,`
    A`).concat($,",").concat($,",0,1,").concat(ae?0:1,`,
    `).concat(se.x,",").concat(se.y),he=Xn(t.id)?dy("recharts-radial-line-"):t.id;return Oe.createElement("text",yw({},n,{dominantBaseline:"central",className:fi("recharts-radial-bar-label",i)}),Oe.createElement("defs",null,Oe.createElement("path",{id:he,d:ce})),Oe.createElement("textPath",{xlinkHref:"#".concat(he)},r))},Rke=function(t){var r=t.viewBox,n=t.offset,a=t.position,c=r,f=c.cx,i=c.cy,x=c.innerRadius,w=c.outerRadius,A=c.startAngle,P=c.endAngle,E=(A+P)/2;if(a==="outside"){var D=Ba(f,i,w+n,E),V=D.x,L=D.y;return{x:V,y:L,textAnchor:V>=f?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:f,y:i,textAnchor:"middle",verticalAnchor:"end"};var $=(x+w)/2,H=Ba(f,i,$,E),K=H.x,Q=H.y;return{x:K,y:Q,textAnchor:"middle",verticalAnchor:"middle"}},Ike=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,c=t.position,f=r,i=f.x,x=f.y,w=f.width,A=f.height,P=A>=0?1:-1,E=P*a,D=P>0?"end":"start",V=P>0?"start":"end",L=w>=0?1:-1,$=L*a,H=L>0?"end":"start",K=L>0?"start":"end";if(c==="top"){var Q={x:i+w/2,y:x-P*a,textAnchor:"middle",verticalAnchor:D};return zo(zo({},Q),n?{height:Math.max(x-n.y,0),width:w}:{})}if(c==="bottom"){var ae={x:i+w/2,y:x+A+E,textAnchor:"middle",verticalAnchor:V};return zo(zo({},ae),n?{height:Math.max(n.y+n.height-(x+A),0),width:w}:{})}if(c==="left"){var ee={x:i-$,y:x+A/2,textAnchor:H,verticalAnchor:"middle"};return zo(zo({},ee),n?{width:Math.max(ee.x-n.x,0),height:A}:{})}if(c==="right"){var se={x:i+w+$,y:x+A/2,textAnchor:K,verticalAnchor:"middle"};return zo(zo({},se),n?{width:Math.max(n.x+n.width-se.x,0),height:A}:{})}var ce=n?{width:w,height:A}:{};return c==="insideLeft"?zo({x:i+$,y:x+A/2,textAnchor:K,verticalAnchor:"middle"},ce):c==="insideRight"?zo({x:i+w-$,y:x+A/2,textAnchor:H,verticalAnchor:"middle"},ce):c==="insideTop"?zo({x:i+w/2,y:x+E,textAnchor:"middle",verticalAnchor:V},ce):c==="insideBottom"?zo({x:i+w/2,y:x+A-E,textAnchor:"middle",verticalAnchor:D},ce):c==="insideTopLeft"?zo({x:i+$,y:x+E,textAnchor:K,verticalAnchor:V},ce):c==="insideTopRight"?zo({x:i+w-$,y:x+E,textAnchor:H,verticalAnchor:V},ce):c==="insideBottomLeft"?zo({x:i+$,y:x+A-E,textAnchor:K,verticalAnchor:D},ce):c==="insideBottomRight"?zo({x:i+w-$,y:x+A-E,textAnchor:H,verticalAnchor:D},ce):C_(c)&&(zr(c.x)||P0(c.x))&&(zr(c.y)||P0(c.y))?zo({x:i+vc(c.x,w),y:x+vc(c.y,A),textAnchor:"end",verticalAnchor:"end"},ce):zo({x:i+w/2,y:x+A/2,textAnchor:"middle",verticalAnchor:"middle"},ce)},Dke=function(t){return"cx"in t&&zr(t.cx)};function ll(e){var t=e.offset,r=t===void 0?5:t,n=Pke(e,_ke),a=zo({offset:r},n),c=a.viewBox,f=a.position,i=a.value,x=a.children,w=a.content,A=a.className,P=A===void 0?"":A,E=a.textBreakAll;if(!c||Xn(i)&&Xn(x)&&!W.isValidElement(w)&&!qn(w))return null;if(W.isValidElement(w))return W.cloneElement(w,a);var D;if(qn(w)){if(D=W.createElement(w,a),W.isValidElement(D))return D}else D=Eke(a);var V=Dke(c),L=vn(a,!0);if(V&&(f==="insideStart"||f==="insideEnd"||f==="end"))return Oke(a,D,L);var $=V?Rke(a):Ike(a);return Oe.createElement(q0,yw({className:fi("recharts-label",P)},L,$,{breakAll:E}),D)}ll.displayName="Label";var _ee=function(t){var r=t.cx,n=t.cy,a=t.angle,c=t.startAngle,f=t.endAngle,i=t.r,x=t.radius,w=t.innerRadius,A=t.outerRadius,P=t.x,E=t.y,D=t.top,V=t.left,L=t.width,$=t.height,H=t.clockWise,K=t.labelViewBox;if(K)return K;if(zr(L)&&zr($)){if(zr(P)&&zr(E))return{x:P,y:E,width:L,height:$};if(zr(D)&&zr(V))return{x:D,y:V,width:L,height:$}}return zr(P)&&zr(E)?{x:P,y:E,width:0,height:0}:zr(r)&&zr(n)?{cx:r,cy:n,startAngle:c||a||0,endAngle:f||a||0,innerRadius:w||0,outerRadius:A||x||i||0,clockWise:H}:t.viewBox?t.viewBox:{}},Lke=function(t,r){return t?t===!0?Oe.createElement(ll,{key:"label-implicit",viewBox:r}):Vo(t)?Oe.createElement(ll,{key:"label-implicit",viewBox:r,value:t}):W.isValidElement(t)?t.type===ll?W.cloneElement(t,{key:"label-implicit",viewBox:r}):Oe.createElement(ll,{key:"label-implicit",content:t,viewBox:r}):qn(t)?Oe.createElement(ll,{key:"label-implicit",content:t,viewBox:r}):C_(t)?Oe.createElement(ll,yw({viewBox:r},t,{key:"label-implicit"})):null:null},zke=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,c=_ee(t),f=Xl(a,ll).map(function(x,w){return W.cloneElement(x,{viewBox:r||c,key:"label-".concat(w)})});if(!n)return f;var i=Lke(t.label,r||c);return[i].concat(bke(f))};ll.parseViewBox=_ee;ll.renderCallByParent=zke;var tO,iq;function Fke(){if(iq)return tO;iq=1;function e(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}return tO=e,tO}var Bke=Fke();const Vke=la(Bke);function vw(e){"@babel/helpers - typeof";return vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vw(e)}var Uke=["valueAccessor"],$ke=["data","dataKey","clockWise","id","textBreakAll"];function qke(e){return Kke(e)||Hke(e)||Wke(e)||Gke()}function Gke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wke(e,t){if(e){if(typeof e=="string")return NI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NI(e,t)}}function Hke(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Kke(e){if(Array.isArray(e))return NI(e)}function NI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function IT(){return IT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IT.apply(this,arguments)}function aq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aq(Object(r),!0).forEach(function(n){Zke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zke(e,t,r){return t=Yke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yke(e){var t=Xke(e,"string");return vw(t)=="symbol"?t:t+""}function Xke(e,t){if(vw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oq(e,t){if(e==null)return{};var r=Jke(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Jke(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Qke=function(t){return Array.isArray(t.value)?Vke(t.value):t.value};function Dd(e){var t=e.valueAccessor,r=t===void 0?Qke:t,n=oq(e,Uke),a=n.data,c=n.dataKey,f=n.clockWise,i=n.id,x=n.textBreakAll,w=oq(n,$ke);return!a||!a.length?null:Oe.createElement(mi,{className:"recharts-label-list"},a.map(function(A,P){var E=Xn(c)?r(A,P):Ya(A&&A.payload,c),D=Xn(i)?{}:{id:"".concat(i,"-").concat(P)};return Oe.createElement(ll,IT({},vn(A,!0),w,D,{parentViewBox:A.parentViewBox,value:E,textBreakAll:x,viewBox:ll.parseViewBox(Xn(f)?A:sq(sq({},A),{},{clockWise:f})),key:"label-".concat(P),index:P}))}))}Dd.displayName="LabelList";function eEe(e,t){return e?e===!0?Oe.createElement(Dd,{key:"labelList-implicit",data:t}):Oe.isValidElement(e)||qn(e)?Oe.createElement(Dd,{key:"labelList-implicit",data:t,content:e}):C_(e)?Oe.createElement(Dd,IT({data:t},e,{key:"labelList-implicit"})):null:null}function tEe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=Xl(n,Dd).map(function(f,i){return W.cloneElement(f,{data:t,key:"labelList-".concat(i)})});if(!r)return a;var c=eEe(e.label,t);return[c].concat(qke(a))}Dd.renderCallByParent=tEe;function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function jI(){return jI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jI.apply(this,arguments)}function lq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lq(Object(r),!0).forEach(function(n){rEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rEe(e,t,r){return t=nEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nEe(e){var t=iEe(e,"string");return xw(t)=="symbol"?t:t+""}function iEe(e,t){if(xw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(xw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aEe=function(t,r){var n=ul(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},YS=function(t){var r=t.cx,n=t.cy,a=t.radius,c=t.angle,f=t.sign,i=t.isExternal,x=t.cornerRadius,w=t.cornerIsExternal,A=x*(i?1:-1)+a,P=Math.asin(x/A)/RT,E=w?c:c+f*P,D=Ba(r,n,A,E),V=Ba(r,n,a,E),L=w?c-f*P:c,$=Ba(r,n,A*Math.cos(P*RT),L);return{center:D,circleTangency:V,lineTangency:$,theta:P}},bee=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,c=t.outerRadius,f=t.startAngle,i=t.endAngle,x=aEe(f,i),w=f+x,A=Ba(r,n,c,f),P=Ba(r,n,c,w),E="M ".concat(A.x,",").concat(A.y,`
    A `).concat(c,",").concat(c,`,0,
    `).concat(+(Math.abs(x)>180),",").concat(+(f>w),`,
    `).concat(P.x,",").concat(P.y,`
  `);if(a>0){var D=Ba(r,n,a,f),V=Ba(r,n,a,w);E+="L ".concat(V.x,",").concat(V.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(x)>180),",").concat(+(f<=w),`,
            `).concat(D.x,",").concat(D.y," Z")}else E+="L ".concat(r,",").concat(n," Z");return E},sEe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,c=t.outerRadius,f=t.cornerRadius,i=t.forceCornerRadius,x=t.cornerIsExternal,w=t.startAngle,A=t.endAngle,P=ul(A-w),E=YS({cx:r,cy:n,radius:c,angle:w,sign:P,cornerRadius:f,cornerIsExternal:x}),D=E.circleTangency,V=E.lineTangency,L=E.theta,$=YS({cx:r,cy:n,radius:c,angle:A,sign:-P,cornerRadius:f,cornerIsExternal:x}),H=$.circleTangency,K=$.lineTangency,Q=$.theta,ae=x?Math.abs(w-A):Math.abs(w-A)-L-Q;if(ae<0)return i?"M ".concat(V.x,",").concat(V.y,`
        a`).concat(f,",").concat(f,",0,0,1,").concat(f*2,`,0
        a`).concat(f,",").concat(f,",0,0,1,").concat(-f*2,`,0
      `):bee({cx:r,cy:n,innerRadius:a,outerRadius:c,startAngle:w,endAngle:A});var ee="M ".concat(V.x,",").concat(V.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(P<0),",").concat(D.x,",").concat(D.y,`
    A`).concat(c,",").concat(c,",0,").concat(+(ae>180),",").concat(+(P<0),",").concat(H.x,",").concat(H.y,`
    A`).concat(f,",").concat(f,",0,0,").concat(+(P<0),",").concat(K.x,",").concat(K.y,`
  `);if(a>0){var se=YS({cx:r,cy:n,radius:a,angle:w,sign:P,isExternal:!0,cornerRadius:f,cornerIsExternal:x}),ce=se.circleTangency,he=se.lineTangency,Pe=se.theta,Ne=YS({cx:r,cy:n,radius:a,angle:A,sign:-P,isExternal:!0,cornerRadius:f,cornerIsExternal:x}),pe=Ne.circleTangency,je=Ne.lineTangency,xe=Ne.theta,Ce=x?Math.abs(w-A):Math.abs(w-A)-Pe-xe;if(Ce<0&&f===0)return"".concat(ee,"L").concat(r,",").concat(n,"Z");ee+="L".concat(je.x,",").concat(je.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(P<0),",").concat(pe.x,",").concat(pe.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(Ce>180),",").concat(+(P>0),",").concat(ce.x,",").concat(ce.y,`
      A`).concat(f,",").concat(f,",0,0,").concat(+(P<0),",").concat(he.x,",").concat(he.y,"Z")}else ee+="L".concat(r,",").concat(n,"Z");return ee},oEe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},wee=function(t){var r=cq(cq({},oEe),t),n=r.cx,a=r.cy,c=r.innerRadius,f=r.outerRadius,i=r.cornerRadius,x=r.forceCornerRadius,w=r.cornerIsExternal,A=r.startAngle,P=r.endAngle,E=r.className;if(f<c||A===P)return null;var D=fi("recharts-sector",E),V=f-c,L=vc(i,V,0,!0),$;return L>0&&Math.abs(A-P)<360?$=sEe({cx:n,cy:a,innerRadius:c,outerRadius:f,cornerRadius:Math.min(L,V/2),forceCornerRadius:x,cornerIsExternal:w,startAngle:A,endAngle:P}):$=bee({cx:n,cy:a,innerRadius:c,outerRadius:f,startAngle:A,endAngle:P}),Oe.createElement("path",jI({},vn(r,!0),{className:D,d:$,role:"img"}))};function _w(e){"@babel/helpers - typeof";return _w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_w(e)}function CI(){return CI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CI.apply(this,arguments)}function uq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uq(Object(r),!0).forEach(function(n){lEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lEe(e,t,r){return t=cEe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cEe(e){var t=uEe(e,"string");return _w(t)=="symbol"?t:t+""}function uEe(e,t){if(_w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_w(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hq={curveBasisClosed:R2e,curveBasisOpen:I2e,curveBasis:O2e,curveBumpX:x2e,curveBumpY:_2e,curveLinearClosed:D2e,curveLinear:tN,curveMonotoneX:L2e,curveMonotoneY:z2e,curveNatural:F2e,curveStep:B2e,curveStepAfter:U2e,curveStepBefore:V2e},XS=function(t){return t.x===+t.x&&t.y===+t.y},qb=function(t){return t.x},Gb=function(t){return t.y},dEe=function(t,r){if(qn(t))return t;var n="curve".concat(QP(t));return(n==="curveMonotone"||n==="curveBump")&&r?hq["".concat(n).concat(r==="vertical"?"Y":"X")]:hq[n]||tN},hEe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,c=a===void 0?[]:a,f=t.baseLine,i=t.layout,x=t.connectNulls,w=x===void 0?!1:x,A=dEe(n,i),P=w?c.filter(function(L){return XS(L)}):c,E;if(Array.isArray(f)){var D=w?f.filter(function(L){return XS(L)}):f,V=P.map(function(L,$){return dq(dq({},L),{},{base:D[$]})});return i==="vertical"?E=US().y(Gb).x1(qb).x0(function(L){return L.base.x}):E=US().x(qb).y1(Gb).y0(function(L){return L.base.y}),E.defined(XS).curve(A),E(V)}return i==="vertical"&&zr(f)?E=US().y(Gb).x1(qb).x0(f):zr(f)?E=US().x(qb).y1(Gb).y0(f):E=yJ().x(qb).y(Gb),E.defined(XS).curve(A),E(P)},Hg=function(t){var r=t.className,n=t.points,a=t.path,c=t.pathRef;if((!n||!n.length)&&!a)return null;var f=n&&n.length?hEe(t):a;return Oe.createElement("path",CI({},vn(t,!1),lT(t),{className:fi("recharts-curve",r),d:f,ref:c}))},rO={exports:{}},nO,fq;function fEe(){if(fq)return nO;fq=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return nO=e,nO}var iO,pq;function pEe(){if(pq)return iO;pq=1;var e=fEe();function t(){}function r(){}return r.resetWarningCache=t,iO=function(){function n(f,i,x,w,A,P){if(P!==e){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}n.isRequired=n;function a(){return n}var c={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:t};return c.PropTypes=c,c},iO}var mq;function mEe(){return mq||(mq=1,rO.exports=pEe()()),rO.exports}var gEe=mEe();const _a=la(gEe);var yEe=Object.getOwnPropertyNames,vEe=Object.getOwnPropertySymbols,xEe=Object.prototype.hasOwnProperty;function gq(e,t){return function(n,a,c){return e(n,a,c)&&t(n,a,c)}}function JS(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var c=a.cache,f=c.get(r),i=c.get(n);if(f&&i)return f===n&&i===r;c.set(r,n),c.set(n,r);var x=e(r,n,a);return c.delete(r),c.delete(n),x}}function yq(e){return yEe(e).concat(vEe(e))}var _Ee=Object.hasOwn||function(e,t){return xEe.call(e,t)};function av(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var bEe="__v",wEe="__o",SEe="_owner",vq=Object.getOwnPropertyDescriptor,xq=Object.keys;function AEe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function TEe(e,t){return av(e.getTime(),t.getTime())}function PEe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function NEe(e,t){return e===t}function _q(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),c=e.entries(),f,i,x=0;(f=c.next())&&!f.done;){for(var w=t.entries(),A=!1,P=0;(i=w.next())&&!i.done;){if(a[P]){P++;continue}var E=f.value,D=i.value;if(r.equals(E[0],D[0],x,P,e,t,r)&&r.equals(E[1],D[1],E[0],D[0],e,t,r)){A=a[P]=!0;break}P++}if(!A)return!1;x++}return!0}var jEe=av;function CEe(e,t,r){var n=xq(e),a=n.length;if(xq(t).length!==a)return!1;for(;a-- >0;)if(!See(e,t,r,n[a]))return!1;return!0}function Wb(e,t,r){var n=yq(e),a=n.length;if(yq(t).length!==a)return!1;for(var c,f,i;a-- >0;)if(c=n[a],!See(e,t,r,c)||(f=vq(e,c),i=vq(t,c),(f||i)&&(!f||!i||f.configurable!==i.configurable||f.enumerable!==i.enumerable||f.writable!==i.writable)))return!1;return!0}function kEe(e,t){return av(e.valueOf(),t.valueOf())}function EEe(e,t){return e.source===t.source&&e.flags===t.flags}function bq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),c=e.values(),f,i;(f=c.next())&&!f.done;){for(var x=t.values(),w=!1,A=0;(i=x.next())&&!i.done;){if(!a[A]&&r.equals(f.value,i.value,f.value,i.value,e,t,r)){w=a[A]=!0;break}A++}if(!w)return!1}return!0}function MEe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function OEe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function See(e,t,r,n){return(n===SEe||n===wEe||n===bEe)&&(e.$$typeof||t.$$typeof)?!0:_Ee(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var REe="[object Arguments]",IEe="[object Boolean]",DEe="[object Date]",LEe="[object Error]",zEe="[object Map]",FEe="[object Number]",BEe="[object Object]",VEe="[object RegExp]",UEe="[object Set]",$Ee="[object String]",qEe="[object URL]",GEe=Array.isArray,wq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Sq=Object.assign,WEe=Object.prototype.toString.call.bind(Object.prototype.toString);function HEe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,c=e.areMapsEqual,f=e.areNumbersEqual,i=e.areObjectsEqual,x=e.arePrimitiveWrappersEqual,w=e.areRegExpsEqual,A=e.areSetsEqual,P=e.areTypedArraysEqual,E=e.areUrlsEqual;return function(V,L,$){if(V===L)return!0;if(V==null||L==null)return!1;var H=typeof V;if(H!==typeof L)return!1;if(H!=="object")return H==="number"?f(V,L,$):H==="function"?a(V,L,$):!1;var K=V.constructor;if(K!==L.constructor)return!1;if(K===Object)return i(V,L,$);if(GEe(V))return t(V,L,$);if(wq!=null&&wq(V))return P(V,L,$);if(K===Date)return r(V,L,$);if(K===RegExp)return w(V,L,$);if(K===Map)return c(V,L,$);if(K===Set)return A(V,L,$);var Q=WEe(V);return Q===DEe?r(V,L,$):Q===VEe?w(V,L,$):Q===zEe?c(V,L,$):Q===UEe?A(V,L,$):Q===BEe?typeof V.then!="function"&&typeof L.then!="function"&&i(V,L,$):Q===qEe?E(V,L,$):Q===LEe?n(V,L,$):Q===REe?i(V,L,$):Q===IEe||Q===FEe||Q===$Ee?x(V,L,$):!1}}function KEe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Wb:AEe,areDatesEqual:TEe,areErrorsEqual:PEe,areFunctionsEqual:NEe,areMapsEqual:n?gq(_q,Wb):_q,areNumbersEqual:jEe,areObjectsEqual:n?Wb:CEe,arePrimitiveWrappersEqual:kEe,areRegExpsEqual:EEe,areSetsEqual:n?gq(bq,Wb):bq,areTypedArraysEqual:n?Wb:MEe,areUrlsEqual:OEe};if(r&&(a=Sq({},a,r(a))),t){var c=JS(a.areArraysEqual),f=JS(a.areMapsEqual),i=JS(a.areObjectsEqual),x=JS(a.areSetsEqual);a=Sq({},a,{areArraysEqual:c,areMapsEqual:f,areObjectsEqual:i,areSetsEqual:x})}return a}function ZEe(e){return function(t,r,n,a,c,f,i){return e(t,r,i)}}function YEe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,c=e.strict;if(n)return function(x,w){var A=n(),P=A.cache,E=P===void 0?t?new WeakMap:void 0:P,D=A.meta;return r(x,w,{cache:E,equals:a,meta:D,strict:c})};if(t)return function(x,w){return r(x,w,{cache:new WeakMap,equals:a,meta:void 0,strict:c})};var f={cache:void 0,equals:a,meta:void 0,strict:c};return function(x,w){return r(x,w,f)}}var XEe=py();py({strict:!0});py({circular:!0});py({circular:!0,strict:!0});py({createInternalComparator:function(){return av}});py({strict:!0,createInternalComparator:function(){return av}});py({circular:!0,createInternalComparator:function(){return av}});py({circular:!0,createInternalComparator:function(){return av},strict:!0});function py(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,c=e.strict,f=c===void 0?!1:c,i=KEe(e),x=HEe(i),w=n?n(x):ZEe(x);return YEe({circular:r,comparator:x,createState:a,equals:w,strict:f})}function JEe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Aq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(c){r<0&&(r=c),c-r>t?(e(c),r=-1):JEe(a)};requestAnimationFrame(n)}function kI(e){"@babel/helpers - typeof";return kI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kI(e)}function QEe(e){return nMe(e)||rMe(e)||tMe(e)||eMe()}function eMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tMe(e,t){if(e){if(typeof e=="string")return Tq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tq(e,t)}}function Tq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function nMe(e){if(Array.isArray(e))return e}function iMe(){var e={},t=function(){return null},r=!1,n=function a(c){if(!r){if(Array.isArray(c)){if(!c.length)return;var f=c,i=QEe(f),x=i[0],w=i.slice(1);if(typeof x=="number"){Aq(a.bind(null,w),x);return}a(x),Aq(a.bind(null,w));return}kI(c)==="object"&&(e=c,t(e)),typeof c=="function"&&c()}};return{stop:function(){r=!0},start:function(c){r=!1,n(c)},subscribe:function(c){return t=c,function(){t=function(){return null}}}}}function bw(e){"@babel/helpers - typeof";return bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bw(e)}function Pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pq(Object(r),!0).forEach(function(n){Aee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Aee(e,t,r){return t=aMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aMe(e){var t=sMe(e,"string");return bw(t)==="symbol"?t:String(t)}function sMe(e,t){if(bw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(bw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oMe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(c){return a.includes(c)})})},lMe=function(t){return t},cMe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},y1=function(t,r){return Object.keys(r).reduce(function(n,a){return Nq(Nq({},n),{},Aee({},a,t(a,r[a])))},{})},jq=function(t,r,n){return t.map(function(a){return"".concat(cMe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function uMe(e,t){return fMe(e)||hMe(e,t)||Tee(e,t)||dMe()}function dMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function fMe(e){if(Array.isArray(e))return e}function pMe(e){return yMe(e)||gMe(e)||Tee(e)||mMe()}function mMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tee(e,t){if(e){if(typeof e=="string")return EI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return EI(e,t)}}function gMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yMe(e){if(Array.isArray(e))return EI(e)}function EI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DT=1e-4,Pee=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},Nee=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},Cq=function(t,r){return function(n){var a=Pee(t,r);return Nee(a,n)}},vMe=function(t,r){return function(n){var a=Pee(t,r),c=[].concat(pMe(a.map(function(f,i){return f*i}).slice(1)),[0]);return Nee(c,n)}},kq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],c=r[1],f=r[2],i=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,c=0,f=1,i=1;break;case"ease":a=.25,c=.1,f=.25,i=1;break;case"ease-in":a=.42,c=0,f=1,i=1;break;case"ease-out":a=.42,c=0,f=.58,i=1;break;case"ease-in-out":a=0,c=0,f=.58,i=1;break;default:{var x=r[0].split("(");if(x[0]==="cubic-bezier"&&x[1].split(")")[0].split(",").length===4){var w=x[1].split(")")[0].split(",").map(function($){return parseFloat($)}),A=uMe(w,4);a=A[0],c=A[1],f=A[2],i=A[3]}}}var P=Cq(a,f),E=Cq(c,i),D=vMe(a,f),V=function(H){return H>1?1:H<0?0:H},L=function(H){for(var K=H>1?1:H,Q=K,ae=0;ae<8;++ae){var ee=P(Q)-K,se=D(Q);if(Math.abs(ee-K)<DT||se<DT)return E(Q);Q=V(Q-ee/se)}return E(Q)};return L.isStepper=!1,L},xMe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,c=a===void 0?8:a,f=t.dt,i=f===void 0?17:f,x=function(A,P,E){var D=-(A-P)*n,V=E*c,L=E+(D-V)*i/1e3,$=E*i/1e3+A;return Math.abs($-P)<DT&&Math.abs(L)<DT?[P,0]:[$,L]};return x.isStepper=!0,x.dt=i,x},_Me=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return kq(a);case"spring":return xMe();default:if(a.split("(")[0]==="cubic-bezier")return kq(a)}return typeof a=="function"?a:null};function ww(e){"@babel/helpers - typeof";return ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ww(e)}function Eq(e){return SMe(e)||wMe(e)||jee(e)||bMe()}function bMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SMe(e){if(Array.isArray(e))return OI(e)}function Mq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mq(Object(r),!0).forEach(function(n){MI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MI(e,t,r){return t=AMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AMe(e){var t=TMe(e,"string");return ww(t)==="symbol"?t:String(t)}function TMe(e,t){if(ww(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ww(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PMe(e,t){return CMe(e)||jMe(e,t)||jee(e,t)||NMe()}function NMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jee(e,t){if(e){if(typeof e=="string")return OI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OI(e,t)}}function OI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function CMe(e){if(Array.isArray(e))return e}var LT=function(t,r,n){return t+(r-t)*n},RI=function(t){var r=t.from,n=t.to;return r!==n},kMe=function e(t,r,n){var a=y1(function(c,f){if(RI(f)){var i=t(f.from,f.to,f.velocity),x=PMe(i,2),w=x[0],A=x[1];return Pl(Pl({},f),{},{from:w,velocity:A})}return f},r);return n<1?y1(function(c,f){return RI(f)?Pl(Pl({},f),{},{velocity:LT(f.velocity,a[c].velocity,n),from:LT(f.from,a[c].from,n)}):f},r):e(t,a,n-1)};const EMe=function(e,t,r,n,a){var c=oMe(e,t),f=c.reduce(function($,H){return Pl(Pl({},$),{},MI({},H,[e[H],t[H]]))},{}),i=c.reduce(function($,H){return Pl(Pl({},$),{},MI({},H,{from:e[H],velocity:0,to:t[H]}))},{}),x=-1,w,A,P=function(){return null},E=function(){return y1(function(H,K){return K.from},i)},D=function(){return!Object.values(i).filter(RI).length},V=function(H){w||(w=H);var K=H-w,Q=K/r.dt;i=kMe(r,i,Q),a(Pl(Pl(Pl({},e),t),E())),w=H,D()||(x=requestAnimationFrame(P))},L=function(H){A||(A=H);var K=(H-A)/n,Q=y1(function(ee,se){return LT.apply(void 0,Eq(se).concat([r(K)]))},f);if(a(Pl(Pl(Pl({},e),t),Q)),K<1)x=requestAnimationFrame(P);else{var ae=y1(function(ee,se){return LT.apply(void 0,Eq(se).concat([r(1)]))},f);a(Pl(Pl(Pl({},e),t),ae))}};return P=r.isStepper?V:L,function(){return requestAnimationFrame(P),function(){cancelAnimationFrame(x)}}};function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}var MMe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function OMe(e,t){if(e==null)return{};var r=RMe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function RMe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,c;for(c=0;c<n.length;c++)a=n[c],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function aO(e){return zMe(e)||LMe(e)||DMe(e)||IMe()}function IMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DMe(e,t){if(e){if(typeof e=="string")return II(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return II(e,t)}}function LMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zMe(e){if(Array.isArray(e))return II(e)}function II(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Oq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oq(Object(r),!0).forEach(function(n){s1(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s1(e,t,r){return t=Cee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function BMe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cee(n.key),n)}}function VMe(e,t,r){return t&&BMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Cee(e){var t=UMe(e,"string");return qx(t)==="symbol"?t:String(t)}function UMe(e,t){if(qx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(qx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Me(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&DI(e,t)}function DI(e,t){return DI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},DI(e,t)}function qMe(e){var t=GMe();return function(){var n=zT(e),a;if(t){var c=zT(this).constructor;a=Reflect.construct(n,arguments,c)}else a=n.apply(this,arguments);return LI(this,a)}}function LI(e,t){if(t&&(qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zI(e)}function zI(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zT(e){return zT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zT(e)}var zu=function(e){$Me(r,e);var t=qMe(r);function r(n,a){var c;FMe(this,r),c=t.call(this,n,a);var f=c.props,i=f.isActive,x=f.attributeName,w=f.from,A=f.to,P=f.steps,E=f.children,D=f.duration;if(c.handleStyleChange=c.handleStyleChange.bind(zI(c)),c.changeStyle=c.changeStyle.bind(zI(c)),!i||D<=0)return c.state={style:{}},typeof E=="function"&&(c.state={style:A}),LI(c);if(P&&P.length)c.state={style:P[0].style};else if(w){if(typeof E=="function")return c.state={style:w},LI(c);c.state={style:x?s1({},x,w):w}}else c.state={style:{}};return c}return VMe(r,[{key:"componentDidMount",value:function(){var a=this.props,c=a.isActive,f=a.canBegin;this.mounted=!0,!(!c||!f)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var c=this.props,f=c.isActive,i=c.canBegin,x=c.attributeName,w=c.shouldReAnimate,A=c.to,P=c.from,E=this.state.style;if(i){if(!f){var D={style:x?s1({},x,A):A};this.state&&E&&(x&&E[x]!==A||!x&&E!==A)&&this.setState(D);return}if(!(XEe(a.to,A)&&a.canBegin&&a.isActive)){var V=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var L=V||w?P:a.to;if(this.state&&E){var $={style:x?s1({},x,L):L};(x&&E[x]!==L||!x&&E!==L)&&this.setState($)}this.runAnimation(Mh(Mh({},this.props),{},{from:L,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var c=this,f=a.from,i=a.to,x=a.duration,w=a.easing,A=a.begin,P=a.onAnimationEnd,E=a.onAnimationStart,D=EMe(f,i,_Me(w),x,this.changeStyle),V=function(){c.stopJSAnimation=D()};this.manager.start([E,A,V,x,P])}},{key:"runStepAnimation",value:function(a){var c=this,f=a.steps,i=a.begin,x=a.onAnimationStart,w=f[0],A=w.style,P=w.duration,E=P===void 0?0:P,D=function(L,$,H){if(H===0)return L;var K=$.duration,Q=$.easing,ae=Q===void 0?"ease":Q,ee=$.style,se=$.properties,ce=$.onAnimationEnd,he=H>0?f[H-1]:$,Pe=se||Object.keys(ee);if(typeof ae=="function"||ae==="spring")return[].concat(aO(L),[c.runJSAnimation.bind(c,{from:he.style,to:ee,duration:K,easing:ae}),K]);var Ne=jq(Pe,K,ae),pe=Mh(Mh(Mh({},he.style),ee),{},{transition:Ne});return[].concat(aO(L),[pe,K,ce]).filter(lMe)};return this.manager.start([x].concat(aO(f.reduce(D,[A,Math.max(E,i)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=iMe());var c=a.begin,f=a.duration,i=a.attributeName,x=a.to,w=a.easing,A=a.onAnimationStart,P=a.onAnimationEnd,E=a.steps,D=a.children,V=this.manager;if(this.unSubscribe=V.subscribe(this.handleStyleChange),typeof w=="function"||typeof D=="function"||w==="spring"){this.runJSAnimation(a);return}if(E.length>1){this.runStepAnimation(a);return}var L=i?s1({},i,x):x,$=jq(Object.keys(L),f,w);V.start([A,c,Mh(Mh({},L),{},{transition:$}),f,P])}},{key:"render",value:function(){var a=this.props,c=a.children;a.begin;var f=a.duration;a.attributeName,a.easing;var i=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var x=OMe(a,MMe),w=W.Children.count(c),A=this.state.style;if(typeof c=="function")return c(A);if(!i||w===0||f<=0)return c;var P=function(D){var V=D.props,L=V.style,$=L===void 0?{}:L,H=V.className,K=W.cloneElement(D,Mh(Mh({},x),{},{style:Mh(Mh({},$),A),className:H}));return K};return w===1?P(W.Children.only(c)):Oe.createElement("div",null,W.Children.map(c,function(E){return P(E)}))}}]),r}(W.PureComponent);zu.displayName="Animate";zu.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};zu.propTypes={from:_a.oneOfType([_a.object,_a.string]),to:_a.oneOfType([_a.object,_a.string]),attributeName:_a.string,duration:_a.number,begin:_a.number,easing:_a.oneOfType([_a.string,_a.func]),steps:_a.arrayOf(_a.shape({duration:_a.number.isRequired,style:_a.object.isRequired,easing:_a.oneOfType([_a.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),_a.func]),properties:_a.arrayOf("string"),onAnimationEnd:_a.func})),children:_a.oneOfType([_a.node,_a.func]),isActive:_a.bool,canBegin:_a.bool,onAnimationEnd:_a.func,shouldReAnimate:_a.bool,onAnimationStart:_a.func,onAnimationReStart:_a.func};function Sw(e){"@babel/helpers - typeof";return Sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sw(e)}function FT(){return FT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FT.apply(this,arguments)}function WMe(e,t){return YMe(e)||ZMe(e,t)||KMe(e,t)||HMe()}function HMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KMe(e,t){if(e){if(typeof e=="string")return Rq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Rq(e,t)}}function Rq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ZMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function YMe(e){if(Array.isArray(e))return e}function Iq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Dq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iq(Object(r),!0).forEach(function(n){XMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XMe(e,t,r){return t=JMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JMe(e){var t=QMe(e,"string");return Sw(t)=="symbol"?t:t+""}function QMe(e,t){if(Sw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lq=function(t,r,n,a,c){var f=Math.min(Math.abs(n)/2,Math.abs(a)/2),i=a>=0?1:-1,x=n>=0?1:-1,w=a>=0&&n>=0||a<0&&n<0?1:0,A;if(f>0&&c instanceof Array){for(var P=[0,0,0,0],E=0,D=4;E<D;E++)P[E]=c[E]>f?f:c[E];A="M".concat(t,",").concat(r+i*P[0]),P[0]>0&&(A+="A ".concat(P[0],",").concat(P[0],",0,0,").concat(w,",").concat(t+x*P[0],",").concat(r)),A+="L ".concat(t+n-x*P[1],",").concat(r),P[1]>0&&(A+="A ".concat(P[1],",").concat(P[1],",0,0,").concat(w,`,
        `).concat(t+n,",").concat(r+i*P[1])),A+="L ".concat(t+n,",").concat(r+a-i*P[2]),P[2]>0&&(A+="A ".concat(P[2],",").concat(P[2],",0,0,").concat(w,`,
        `).concat(t+n-x*P[2],",").concat(r+a)),A+="L ".concat(t+x*P[3],",").concat(r+a),P[3]>0&&(A+="A ".concat(P[3],",").concat(P[3],",0,0,").concat(w,`,
        `).concat(t,",").concat(r+a-i*P[3])),A+="Z"}else if(f>0&&c===+c&&c>0){var V=Math.min(f,c);A="M ".concat(t,",").concat(r+i*V,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t+x*V,",").concat(r,`
            L `).concat(t+n-x*V,",").concat(r,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t+n,",").concat(r+i*V,`
            L `).concat(t+n,",").concat(r+a-i*V,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t+n-x*V,",").concat(r+a,`
            L `).concat(t+x*V,",").concat(r+a,`
            A `).concat(V,",").concat(V,",0,0,").concat(w,",").concat(t,",").concat(r+a-i*V," Z")}else A="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return A},eOe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,c=r.x,f=r.y,i=r.width,x=r.height;if(Math.abs(i)>0&&Math.abs(x)>0){var w=Math.min(c,c+i),A=Math.max(c,c+i),P=Math.min(f,f+x),E=Math.max(f,f+x);return n>=w&&n<=A&&a>=P&&a<=E}return!1},tOe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},p4=function(t){var r=Dq(Dq({},tOe),t),n=W.useRef(),a=W.useState(-1),c=WMe(a,2),f=c[0],i=c[1];W.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var ae=n.current.getTotalLength();ae&&i(ae)}catch{}},[]);var x=r.x,w=r.y,A=r.width,P=r.height,E=r.radius,D=r.className,V=r.animationEasing,L=r.animationDuration,$=r.animationBegin,H=r.isAnimationActive,K=r.isUpdateAnimationActive;if(x!==+x||w!==+w||A!==+A||P!==+P||A===0||P===0)return null;var Q=fi("recharts-rectangle",D);return K?Oe.createElement(zu,{canBegin:f>0,from:{width:A,height:P,x,y:w},to:{width:A,height:P,x,y:w},duration:L,animationEasing:V,isActive:K},function(ae){var ee=ae.width,se=ae.height,ce=ae.x,he=ae.y;return Oe.createElement(zu,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:$,duration:L,isActive:H,easing:V},Oe.createElement("path",FT({},vn(r,!0),{className:Q,d:Lq(ce,he,ee,se,E),ref:n})))}):Oe.createElement("path",FT({},vn(r,!0),{className:Q,d:Lq(x,w,A,P,E)}))},rOe=["points","className","baseLinePoints","connectNulls"];function px(){return px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},px.apply(this,arguments)}function nOe(e,t){if(e==null)return{};var r=iOe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zq(e){return lOe(e)||oOe(e)||sOe(e)||aOe()}function aOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sOe(e,t){if(e){if(typeof e=="string")return FI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FI(e,t)}}function oOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lOe(e){if(Array.isArray(e))return FI(e)}function FI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Fq=function(t){return t&&t.x===+t.x&&t.y===+t.y},cOe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){Fq(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),Fq(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},v1=function(t,r){var n=cOe(t);r&&(n=[n.reduce(function(c,f){return[].concat(zq(c),zq(f))},[])]);var a=n.map(function(c){return c.reduce(function(f,i,x){return"".concat(f).concat(x===0?"M":"L").concat(i.x,",").concat(i.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},uOe=function(t,r,n){var a=v1(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(v1(r.reverse(),n).slice(1))},dOe=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,c=t.connectNulls,f=nOe(t,rOe);if(!r||!r.length)return null;var i=fi("recharts-polygon",n);if(a&&a.length){var x=f.stroke&&f.stroke!=="none",w=uOe(r,a,c);return Oe.createElement("g",{className:i},Oe.createElement("path",px({},vn(f,!0),{fill:w.slice(-1)==="Z"?f.fill:"none",stroke:"none",d:w})),x?Oe.createElement("path",px({},vn(f,!0),{fill:"none",d:v1(r,c)})):null,x?Oe.createElement("path",px({},vn(f,!0),{fill:"none",d:v1(a,c)})):null)}var A=v1(r,c);return Oe.createElement("path",px({},vn(f,!0),{fill:A.slice(-1)==="Z"?f.fill:"none",className:i,d:A}))};function BI(){return BI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BI.apply(this,arguments)}var p2=function(t){var r=t.cx,n=t.cy,a=t.r,c=t.className,f=fi("recharts-dot",c);return r===+r&&n===+n&&a===+a?Oe.createElement("circle",BI({},vn(t,!1),lT(t),{className:f,cx:r,cy:n,r:a})):null};function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}var hOe=["x","y","top","left","width","height","className"];function VI(){return VI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VI.apply(this,arguments)}function Bq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fOe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bq(Object(r),!0).forEach(function(n){pOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pOe(e,t,r){return t=mOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mOe(e){var t=gOe(e,"string");return Aw(t)=="symbol"?t:t+""}function gOe(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yOe(e,t){if(e==null)return{};var r=vOe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vOe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var xOe=function(t,r,n,a,c,f){return"M".concat(t,",").concat(c,"v").concat(a,"M").concat(f,",").concat(r,"h").concat(n)},_Oe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,c=a===void 0?0:a,f=t.top,i=f===void 0?0:f,x=t.left,w=x===void 0?0:x,A=t.width,P=A===void 0?0:A,E=t.height,D=E===void 0?0:E,V=t.className,L=yOe(t,hOe),$=fOe({x:n,y:c,top:i,left:w,width:P,height:D},L);return!zr(n)||!zr(c)||!zr(P)||!zr(D)||!zr(i)||!zr(w)?null:Oe.createElement("path",VI({},vn($,!0),{className:fi("recharts-cross",V),d:xOe(n,c,P,D,i,w)}))},sO,Vq;function bOe(){if(Vq)return sO;Vq=1;var e=fN(),t=VQ(),r=hp();function n(a,c){return a&&a.length?e(a,r(c,2),t):void 0}return sO=n,sO}var wOe=bOe();const SOe=la(wOe);var oO,Uq;function AOe(){if(Uq)return oO;Uq=1;var e=fN(),t=hp(),r=UQ();function n(a,c){return a&&a.length?e(a,t(c,2),r):void 0}return oO=n,oO}var TOe=AOe();const POe=la(TOe);var NOe=["cx","cy","angle","ticks","axisLine"],jOe=["ticks","tick","angle","tickFormatter","stroke"];function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}function x1(){return x1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x1.apply(this,arguments)}function $q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function f0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$q(Object(r),!0).forEach(function(n){yN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qq(e,t){if(e==null)return{};var r=COe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function COe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function kOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Eee(n.key),n)}}function EOe(e,t,r){return t&&Gq(e.prototype,t),r&&Gq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MOe(e,t,r){return t=BT(t),OOe(e,kee()?Reflect.construct(t,r||[],BT(e).constructor):t.apply(e,r))}function OOe(e,t){if(t&&(Gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ROe(e)}function ROe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kee=function(){return!!e})()}function BT(e){return BT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},BT(e)}function IOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UI(e,t)}function UI(e,t){return UI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},UI(e,t)}function yN(e,t,r){return t=Eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eee(e){var t=DOe(e,"string");return Gx(t)=="symbol"?t:t+""}function DOe(e,t){if(Gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var m2=function(e){function t(){return kOe(this,t),MOe(this,t,arguments)}return IOe(t,e),EOe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,c=this.props,f=c.angle,i=c.cx,x=c.cy;return Ba(i,x,a,f)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,c=n.cy,f=n.angle,i=n.ticks,x=SOe(i,function(A){return A.coordinate||0}),w=POe(i,function(A){return A.coordinate||0});return{cx:a,cy:c,startAngle:f,endAngle:f,innerRadius:w.coordinate||0,outerRadius:x.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,c=n.cy,f=n.angle,i=n.ticks,x=n.axisLine,w=qq(n,NOe),A=i.reduce(function(V,L){return[Math.min(V[0],L.coordinate),Math.max(V[1],L.coordinate)]},[1/0,-1/0]),P=Ba(a,c,A[0],f),E=Ba(a,c,A[1],f),D=f0(f0(f0({},vn(w,!1)),{},{fill:"none"},vn(x,!1)),{},{x1:P.x,y1:P.y,x2:E.x,y2:E.y});return Oe.createElement("line",x1({className:"recharts-polar-radius-axis-line"},D))}},{key:"renderTicks",value:function(){var n=this,a=this.props,c=a.ticks,f=a.tick,i=a.angle,x=a.tickFormatter,w=a.stroke,A=qq(a,jOe),P=this.getTickTextAnchor(),E=vn(A,!1),D=vn(f,!1),V=c.map(function(L,$){var H=n.getTickValueCoord(L),K=f0(f0(f0(f0({textAnchor:P,transform:"rotate(".concat(90-i,", ").concat(H.x,", ").concat(H.y,")")},E),{},{stroke:"none",fill:w},D),{},{index:$},H),{},{payload:L});return Oe.createElement(mi,x1({className:fi("recharts-polar-radius-axis-tick",xee(f)),key:"tick-".concat(L.coordinate)},ap(n.props,L,$)),t.renderTickItem(f,K,x?x(L.value,$):L.value))});return Oe.createElement(mi,{className:"recharts-polar-radius-axis-ticks"},V)}},{key:"render",value:function(){var n=this.props,a=n.ticks,c=n.axisLine,f=n.tick;return!a||!a.length?null:Oe.createElement(mi,{className:fi("recharts-polar-radius-axis",this.props.className)},c&&this.renderAxisLine(),f&&this.renderTicks(),ll.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,c){var f;return Oe.isValidElement(n)?f=Oe.cloneElement(n,a):qn(n)?f=n(a):f=Oe.createElement(q0,x1({},a,{className:"recharts-polar-radius-axis-tick-value"}),c),f}}])}(W.PureComponent);yN(m2,"displayName","PolarRadiusAxis");yN(m2,"axisType","radiusAxis");yN(m2,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Wx(e){"@babel/helpers - typeof";return Wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wx(e)}function b0(){return b0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b0.apply(this,arguments)}function Wq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(r),!0).forEach(function(n){vN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oee(n.key),n)}}function zOe(e,t,r){return t&&Hq(e.prototype,t),r&&Hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FOe(e,t,r){return t=VT(t),BOe(e,Mee()?Reflect.construct(t,r||[],VT(e).constructor):t.apply(e,r))}function BOe(e,t){if(t&&(Wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VOe(e)}function VOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mee=function(){return!!e})()}function VT(e){return VT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},VT(e)}function UOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$I(e,t)}function $I(e,t){return $I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$I(e,t)}function vN(e,t,r){return t=Oee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oee(e){var t=$Oe(e,"string");return Wx(t)=="symbol"?t:t+""}function $Oe(e,t){if(Wx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var qOe=Math.PI/180,GOe=1e-5,g2=function(e){function t(){return LOe(this,t),FOe(this,t,arguments)}return UOe(t,e),zOe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,c=a.cx,f=a.cy,i=a.radius,x=a.orientation,w=a.tickSize,A=w||8,P=Ba(c,f,i,n.coordinate),E=Ba(c,f,i+(x==="inner"?-1:1)*A,n.coordinate);return{x1:P.x,y1:P.y,x2:E.x,y2:E.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,c=Math.cos(-n.coordinate*qOe),f;return c>GOe?f=a==="outer"?"start":"end":c<-1e-5?f=a==="outer"?"end":"start":f="middle",f}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,c=n.cy,f=n.radius,i=n.axisLine,x=n.axisLineType,w=p0(p0({},vn(this.props,!1)),{},{fill:"none"},vn(i,!1));if(x==="circle")return Oe.createElement(p2,b0({className:"recharts-polar-angle-axis-line"},w,{cx:a,cy:c,r:f}));var A=this.props.ticks,P=A.map(function(E){return Ba(a,c,f,E.coordinate)});return Oe.createElement(dOe,b0({className:"recharts-polar-angle-axis-line"},w,{points:P}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,c=a.ticks,f=a.tick,i=a.tickLine,x=a.tickFormatter,w=a.stroke,A=vn(this.props,!1),P=vn(f,!1),E=p0(p0({},A),{},{fill:"none"},vn(i,!1)),D=c.map(function(V,L){var $=n.getTickLineCoord(V),H=n.getTickTextAnchor(V),K=p0(p0(p0({textAnchor:H},A),{},{stroke:"none",fill:w},P),{},{index:L,payload:V,x:$.x2,y:$.y2});return Oe.createElement(mi,b0({className:fi("recharts-polar-angle-axis-tick",xee(f)),key:"tick-".concat(V.coordinate)},ap(n.props,V,L)),i&&Oe.createElement("line",b0({className:"recharts-polar-angle-axis-tick-line"},E,$)),f&&t.renderTickItem(f,K,x?x(V.value,L):V.value))});return Oe.createElement(mi,{className:"recharts-polar-angle-axis-ticks"},D)}},{key:"render",value:function(){var n=this.props,a=n.ticks,c=n.radius,f=n.axisLine;return c<=0||!a||!a.length?null:Oe.createElement(mi,{className:fi("recharts-polar-angle-axis",this.props.className)},f&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,c){var f;return Oe.isValidElement(n)?f=Oe.cloneElement(n,a):qn(n)?f=n(a):f=Oe.createElement(q0,b0({},a,{className:"recharts-polar-angle-axis-tick-value"}),c),f}}])}(W.PureComponent);vN(g2,"displayName","PolarAngleAxis");vN(g2,"axisType","angleAxis");vN(g2,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var lO,Kq;function WOe(){if(Kq)return lO;Kq=1;var e=BJ(),t=e(Object.getPrototypeOf,Object);return lO=t,lO}var cO,Zq;function HOe(){if(Zq)return cO;Zq=1;var e=Nm(),t=WOe(),r=jm(),n="[object Object]",a=Function.prototype,c=Object.prototype,f=a.toString,i=c.hasOwnProperty,x=f.call(Object);function w(A){if(!r(A)||e(A)!=n)return!1;var P=t(A);if(P===null)return!0;var E=i.call(P,"constructor")&&P.constructor;return typeof E=="function"&&E instanceof E&&f.call(E)==x}return cO=w,cO}var KOe=HOe();const ZOe=la(KOe);var uO,Yq;function YOe(){if(Yq)return uO;Yq=1;var e=Nm(),t=jm(),r="[object Boolean]";function n(a){return a===!0||a===!1||t(a)&&e(a)==r}return uO=n,uO}var XOe=YOe();const JOe=la(XOe);function Tw(e){"@babel/helpers - typeof";return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}function UT(){return UT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UT.apply(this,arguments)}function QOe(e,t){return nRe(e)||rRe(e,t)||tRe(e,t)||eRe()}function eRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tRe(e,t){if(e){if(typeof e=="string")return Xq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xq(e,t)}}function Xq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function rRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function nRe(e){if(Array.isArray(e))return e}function Jq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jq(Object(r),!0).forEach(function(n){iRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iRe(e,t,r){return t=aRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aRe(e){var t=sRe(e,"string");return Tw(t)=="symbol"?t:t+""}function sRe(e,t){if(Tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eG=function(t,r,n,a,c){var f=n-a,i;return i="M ".concat(t,",").concat(r),i+="L ".concat(t+n,",").concat(r),i+="L ".concat(t+n-f/2,",").concat(r+c),i+="L ".concat(t+n-f/2-a,",").concat(r+c),i+="L ".concat(t,",").concat(r," Z"),i},oRe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},lRe=function(t){var r=Qq(Qq({},oRe),t),n=W.useRef(),a=W.useState(-1),c=QOe(a,2),f=c[0],i=c[1];W.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var Q=n.current.getTotalLength();Q&&i(Q)}catch{}},[]);var x=r.x,w=r.y,A=r.upperWidth,P=r.lowerWidth,E=r.height,D=r.className,V=r.animationEasing,L=r.animationDuration,$=r.animationBegin,H=r.isUpdateAnimationActive;if(x!==+x||w!==+w||A!==+A||P!==+P||E!==+E||A===0&&P===0||E===0)return null;var K=fi("recharts-trapezoid",D);return H?Oe.createElement(zu,{canBegin:f>0,from:{upperWidth:0,lowerWidth:0,height:E,x,y:w},to:{upperWidth:A,lowerWidth:P,height:E,x,y:w},duration:L,animationEasing:V,isActive:H},function(Q){var ae=Q.upperWidth,ee=Q.lowerWidth,se=Q.height,ce=Q.x,he=Q.y;return Oe.createElement(zu,{canBegin:f>0,from:"0px ".concat(f===-1?1:f,"px"),to:"".concat(f,"px 0px"),attributeName:"strokeDasharray",begin:$,duration:L,easing:V},Oe.createElement("path",UT({},vn(r,!0),{className:K,d:eG(ce,he,ae,ee,se),ref:n})))}):Oe.createElement("g",null,Oe.createElement("path",UT({},vn(r,!0),{className:K,d:eG(x,w,A,P,E)})))},cRe=["option","shapeType","propTransformer","activeClassName","isActive"];function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function uRe(e,t){if(e==null)return{};var r=dRe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function dRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function tG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $T(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tG(Object(r),!0).forEach(function(n){hRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hRe(e,t,r){return t=fRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fRe(e){var t=pRe(e,"string");return Pw(t)=="symbol"?t:t+""}function pRe(e,t){if(Pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mRe(e,t){return $T($T({},t),e)}function gRe(e,t){return e==="symbols"}function rG(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Oe.createElement(p4,r);case"trapezoid":return Oe.createElement(lRe,r);case"sector":return Oe.createElement(wee,r);case"symbols":if(gRe(t))return Oe.createElement(nN,r);break;default:return null}}function yRe(e){return W.isValidElement(e)?e.props:e}function Nw(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?mRe:n,c=e.activeClassName,f=c===void 0?"recharts-active-shape":c,i=e.isActive,x=uRe(e,cRe),w;if(W.isValidElement(t))w=W.cloneElement(t,$T($T({},x),yRe(t)));else if(qn(t))w=t(x);else if(ZOe(t)&&!JOe(t)){var A=a(t,x);w=Oe.createElement(rG,{shapeType:r,elementProps:A})}else{var P=x;w=Oe.createElement(rG,{shapeType:r,elementProps:P})}return i?Oe.createElement(mi,{className:f},w):w}function xN(e,t){return t!=null&&"trapezoids"in e.props}function _N(e,t){return t!=null&&"sectors"in e.props}function jw(e,t){return t!=null&&"points"in e.props}function vRe(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,c=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&c}function xRe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function _Re(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function bRe(e,t){var r;return xN(e,t)?r=vRe:_N(e,t)?r=xRe:jw(e,t)&&(r=_Re),r}function wRe(e,t){var r;return xN(e,t)?r="trapezoids":_N(e,t)?r="sectors":jw(e,t)&&(r="points"),r}function SRe(e,t){if(xN(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(_N(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return jw(e,t)?t.payload:{}}function ARe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=wRe(r,t),c=SRe(r,t),f=n.filter(function(x,w){var A=Pm(c,x),P=r.props[a].filter(function(V){var L=bRe(r,t);return L(V,t)}),E=r.props[a].indexOf(P[P.length-1]),D=w===E;return A&&D}),i=n.indexOf(f[f.length-1]);return i}var wA;function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mx.apply(this,arguments)}function nG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nG(Object(r),!0).forEach(function(n){Md(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Iee(n.key),n)}}function PRe(e,t,r){return t&&iG(e.prototype,t),r&&iG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function NRe(e,t,r){return t=qT(t),jRe(e,Ree()?Reflect.construct(t,r||[],qT(e).constructor):t.apply(e,r))}function jRe(e,t){if(t&&(Hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CRe(e)}function CRe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ree(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ree=function(){return!!e})()}function qT(e){return qT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qT(e)}function kRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qI(e,t)}function qI(e,t){return qI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qI(e,t)}function Md(e,t,r){return t=Iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iee(e){var t=ERe(e,"string");return Hx(t)=="symbol"?t:t+""}function ERe(e,t){if(Hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var pp=function(e){function t(r){var n;return TRe(this,t),n=NRe(this,t,[r]),Md(n,"pieRef",null),Md(n,"sectorRefs",[]),Md(n,"id",dy("recharts-pie-")),Md(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),qn(a)&&a()}),Md(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),qn(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return kRe(t,e),PRe(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var c=this.props,f=c.label,i=c.labelLine,x=c.dataKey,w=c.valueKey,A=vn(this.props,!1),P=vn(f,!1),E=vn(i,!1),D=f&&f.offsetRadius||20,V=n.map(function(L,$){var H=(L.startAngle+L.endAngle)/2,K=Ba(L.cx,L.cy,L.outerRadius+D,H),Q=Wa(Wa(Wa(Wa({},A),L),{},{stroke:"none"},P),{},{index:$,textAnchor:t.getTextAnchor(K.x,L.cx)},K),ae=Wa(Wa(Wa(Wa({},A),L),{},{fill:"none",stroke:L.fill},E),{},{index:$,points:[Ba(L.cx,L.cy,L.outerRadius,H),K]}),ee=x;return Xn(x)&&Xn(w)?ee="value":Xn(x)&&(ee=w),Oe.createElement(mi,{key:"label-".concat(L.startAngle,"-").concat(L.endAngle,"-").concat(L.midAngle,"-").concat($)},i&&t.renderLabelLineItem(i,ae,"line"),t.renderLabelItem(f,Q,Ya(L,ee)))});return Oe.createElement(mi,{className:"recharts-pie-labels"},V)}},{key:"renderSectorsStatically",value:function(n){var a=this,c=this.props,f=c.activeShape,i=c.blendStroke,x=c.inactiveShape;return n.map(function(w,A){if((w==null?void 0:w.startAngle)===0&&(w==null?void 0:w.endAngle)===0&&n.length!==1)return null;var P=a.isActiveIndex(A),E=x&&a.hasActiveIndex()?x:null,D=P?f:E,V=Wa(Wa({},w),{},{stroke:i?w.fill:w.stroke,tabIndex:-1});return Oe.createElement(mi,mx({ref:function($){$&&!a.sectorRefs.includes($)&&a.sectorRefs.push($)},tabIndex:-1,className:"recharts-pie-sector"},ap(a.props,w,A),{key:"sector-".concat(w==null?void 0:w.startAngle,"-").concat(w==null?void 0:w.endAngle,"-").concat(w.midAngle,"-").concat(A)}),Oe.createElement(Nw,mx({option:D,isActive:P,shapeType:"sector"},V)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,c=a.sectors,f=a.isAnimationActive,i=a.animationBegin,x=a.animationDuration,w=a.animationEasing,A=a.animationId,P=this.state,E=P.prevSectors,D=P.prevIsAnimationActive;return Oe.createElement(zu,{begin:i,duration:x,isActive:f,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(A,"-").concat(D),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(V){var L=V.t,$=[],H=c&&c[0],K=H.startAngle;return c.forEach(function(Q,ae){var ee=E&&E[ae],se=ae>0?Iu(Q,"paddingAngle",0):0;if(ee){var ce=Za(ee.endAngle-ee.startAngle,Q.endAngle-Q.startAngle),he=Wa(Wa({},Q),{},{startAngle:K+se,endAngle:K+ce(L)+se});$.push(he),K=he.endAngle}else{var Pe=Q.endAngle,Ne=Q.startAngle,pe=Za(0,Pe-Ne),je=pe(L),xe=Wa(Wa({},Q),{},{startAngle:K+se,endAngle:K+je+se});$.push(xe),K=xe.endAngle}}),Oe.createElement(mi,null,n.renderSectorsStatically($))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(c){if(!c.altKey)switch(c.key){case"ArrowLeft":{var f=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[f].focus(),a.setState({sectorToFocus:f});break}case"ArrowRight":{var i=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[i].focus(),a.setState({sectorToFocus:i});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,c=n.isAnimationActive,f=this.state.prevSectors;return c&&a&&a.length&&(!f||!Pm(f,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,c=a.hide,f=a.sectors,i=a.className,x=a.label,w=a.cx,A=a.cy,P=a.innerRadius,E=a.outerRadius,D=a.isAnimationActive,V=this.state.isAnimationFinished;if(c||!f||!f.length||!zr(w)||!zr(A)||!zr(P)||!zr(E))return null;var L=fi("recharts-pie",i);return Oe.createElement(mi,{tabIndex:this.props.rootTabIndex,className:L,ref:function(H){n.pieRef=H}},this.renderSectors(),x&&this.renderLabels(f),ll.renderCallByParent(this.props,null,!1),(!D||V)&&Dd.renderCallByParent(this.props,f,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,c){if(Oe.isValidElement(n))return Oe.cloneElement(n,a);if(qn(n))return n(a);var f=fi("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Oe.createElement(Hg,mx({},a,{key:c,type:"linear",className:f}))}},{key:"renderLabelItem",value:function(n,a,c){if(Oe.isValidElement(n))return Oe.cloneElement(n,a);var f=c;if(qn(n)&&(f=n(a),Oe.isValidElement(f)))return f;var i=fi("recharts-pie-label-text",typeof n!="boolean"&&!qn(n)?n.className:"");return Oe.createElement(q0,mx({},a,{alignmentBaseline:"middle",className:i}),f)}}])}(W.PureComponent);wA=pp;Md(pp,"displayName","Pie");Md(pp,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!fp.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Md(pp,"parseDeltaAngle",function(e,t){var r=ul(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Md(pp,"getRealPieData",function(e){var t=e.data,r=e.children,n=vn(e,!1),a=Xl(r,Kh);return t&&t.length?t.map(function(c,f){return Wa(Wa(Wa({payload:c},n),c),a&&a[f]&&a[f].props)}):a&&a.length?a.map(function(c){return Wa(Wa({},n),c.props)}):[]});Md(pp,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,c=t.height,f=yee(a,c),i=n+vc(e.cx,a,a/2),x=r+vc(e.cy,c,c/2),w=vc(e.innerRadius,f,0),A=vc(e.outerRadius,f,f*.8),P=e.maxRadius||Math.sqrt(a*a+c*c)/2;return{cx:i,cy:x,innerRadius:w,outerRadius:A,maxRadius:P}});Md(pp,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Wa(Wa({},t.type.defaultProps),t.props):t.props,a=wA.getRealPieData(n);if(!a||!a.length)return null;var c=n.cornerRadius,f=n.startAngle,i=n.endAngle,x=n.paddingAngle,w=n.dataKey,A=n.nameKey,P=n.valueKey,E=n.tooltipType,D=Math.abs(n.minAngle),V=wA.parseCoordinateOfPie(n,r),L=wA.parseDeltaAngle(f,i),$=Math.abs(L),H=w;Xn(w)&&Xn(P)?(Vh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H="value"):Xn(w)&&(Vh(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),H=P);var K=a.filter(function(he){return Ya(he,H,0)!==0}).length,Q=($>=360?K:K-1)*x,ae=$-K*D-Q,ee=a.reduce(function(he,Pe){var Ne=Ya(Pe,H,0);return he+(zr(Ne)?Ne:0)},0),se;if(ee>0){var ce;se=a.map(function(he,Pe){var Ne=Ya(he,H,0),pe=Ya(he,A,Pe),je=(zr(Ne)?Ne:0)/ee,xe;Pe?xe=ce.endAngle+ul(L)*x*(Ne!==0?1:0):xe=f;var Ce=xe+ul(L)*((Ne!==0?D:0)+je*ae),ze=(xe+Ce)/2,Te=(V.innerRadius+V.outerRadius)/2,Re=[{name:pe,value:Ne,payload:he,dataKey:H,type:E}],Fe=Ba(V.cx,V.cy,Te,ze);return ce=Wa(Wa(Wa({percent:je,cornerRadius:c,name:pe,tooltipPayload:Re,midAngle:ze,middleRadius:Te,tooltipPosition:Fe},he),V),{},{value:Ya(he,H),startAngle:xe,endAngle:Ce,payload:he,paddingAngle:ul(L)*x}),ce})}return Wa(Wa({},V),{},{sectors:se,data:a})});function Cw(e){"@babel/helpers - typeof";return Cw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cw(e)}function GI(){return GI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GI.apply(this,arguments)}function aG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aG(Object(r),!0).forEach(function(n){MRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MRe(e,t,r){return t=ORe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ORe(e){var t=RRe(e,"string");return Cw(t)=="symbol"?t:t+""}function RRe(e,t){if(Cw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sG(e){return typeof e=="string"?parseInt(e,10):e}function IRe(e,t){var r="".concat(t.cx||e.cx),n=Number(r),a="".concat(t.cy||e.cy),c=Number(a);return dO(dO(dO({},t),e),{},{cx:n,cy:c})}function oG(e){return Oe.createElement(Nw,GI({shapeType:"sector",propTransformer:IRe},e))}var DRe=["shape","activeShape","activeIndex","cornerRadius"],LRe=["value","background"];function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function GT(){return GT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GT.apply(this,arguments)}function lG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lG(Object(r),!0).forEach(function(n){D0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cG(e,t){if(e==null)return{};var r=zRe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function zRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function FRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lee(n.key),n)}}function BRe(e,t,r){return t&&uG(e.prototype,t),r&&uG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function VRe(e,t,r){return t=WT(t),URe(e,Dee()?Reflect.construct(t,r||[],WT(e).constructor):t.apply(e,r))}function URe(e,t){if(t&&(Kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Re(e)}function $Re(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Dee=function(){return!!e})()}function WT(e){return WT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},WT(e)}function qRe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&WI(e,t)}function WI(e,t){return WI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},WI(e,t)}function D0(e,t,r){return t=Lee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lee(e){var t=GRe(e,"string");return Kx(t)=="symbol"?t:t+""}function GRe(e,t){if(Kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var y2=function(e){function t(){var r;FRe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=VRe(this,t,[].concat(a)),D0(r,"state",{isAnimationFinished:!1}),D0(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),qn(f)&&f()}),D0(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),qn(f)&&f()}),r}return qRe(t,e),BRe(t,[{key:"getDeltaAngle",value:function(){var n=this.props,a=n.startAngle,c=n.endAngle,f=ul(c-a),i=Math.min(Math.abs(c-a),360);return f*i}},{key:"renderSectorsStatically",value:function(n){var a=this,c=this.props,f=c.shape,i=c.activeShape,x=c.activeIndex,w=c.cornerRadius,A=cG(c,DRe),P=vn(A,!1);return n.map(function(E,D){var V=D===x,L=sl(sl(sl(sl({},P),{},{cornerRadius:sG(w)},E),ap(a.props,E,D)),{},{className:"recharts-radial-bar-sector ".concat(E.className),forceCornerRadius:A.forceCornerRadius,cornerIsExternal:A.cornerIsExternal,isActive:V,option:V?i:f});return Oe.createElement(oG,GT({},L,{key:"sector-".concat(D)}))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,c=a.data,f=a.isAnimationActive,i=a.animationBegin,x=a.animationDuration,w=a.animationEasing,A=a.animationId,P=this.state.prevData;return Oe.createElement(zu,{begin:i,duration:x,isActive:f,easing:w,from:{t:0},to:{t:1},key:"radialBar-".concat(A),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(E){var D=E.t,V=c.map(function(L,$){var H=P&&P[$];if(H){var K=Za(H.startAngle,L.startAngle),Q=Za(H.endAngle,L.endAngle);return sl(sl({},L),{},{startAngle:K(D),endAngle:Q(D)})}var ae=L.endAngle,ee=L.startAngle,se=Za(ee,ae);return sl(sl({},L),{},{endAngle:se(D)})});return Oe.createElement(mi,null,n.renderSectorsStatically(V))})}},{key:"renderSectors",value:function(){var n=this.props,a=n.data,c=n.isAnimationActive,f=this.state.prevData;return c&&a&&a.length&&(!f||!Pm(f,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"renderBackground",value:function(n){var a=this,c=this.props.cornerRadius,f=vn(this.props.background,!1);return n.map(function(i,x){i.value;var w=i.background,A=cG(i,LRe);if(!w)return null;var P=sl(sl(sl(sl(sl({cornerRadius:sG(c)},A),{},{fill:"#eee"},w),f),ap(a.props,i,x)),{},{index:x,className:fi("recharts-radial-bar-background-sector",f==null?void 0:f.className),option:w,isActive:!1});return Oe.createElement(oG,GT({},P,{key:"sector-".concat(x)}))})}},{key:"render",value:function(){var n=this.props,a=n.hide,c=n.data,f=n.className,i=n.background,x=n.isAnimationActive;if(a||!c||!c.length)return null;var w=this.state.isAnimationFinished,A=fi("recharts-area",f);return Oe.createElement(mi,{className:A},i&&Oe.createElement(mi,{className:"recharts-radial-bar-background"},this.renderBackground(c)),Oe.createElement(mi,{className:"recharts-radial-bar-sectors"},this.renderSectors()),(!x||w)&&Dd.renderCallByParent(sl({},this.props),c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(W.PureComponent);D0(y2,"displayName","RadialBar");D0(y2,"defaultProps",{angleAxisId:0,radiusAxisId:0,minPointSize:0,hide:!1,legendType:"rect",data:[],isAnimationActive:!fp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease",forceCornerRadius:!1,cornerIsExternal:!1});D0(y2,"getComposedData",function(e){var t=e.item,r=e.props,n=e.radiusAxis,a=e.radiusAxisTicks,c=e.angleAxis,f=e.angleAxisTicks,i=e.displayedData,x=e.dataKey,w=e.stackedData,A=e.barPosition,P=e.bandSize,E=e.dataStartIndex,D=dee(A,t);if(!D)return null;var V=c.cx,L=c.cy,$=r.layout,H=t.props,K=H.children,Q=H.minPointSize,ae=$==="radial"?c:n,ee=w?ae.scale.domain():null,se=pee({numericAxis:ae}),ce=Xl(K,Kh),he=i.map(function(Pe,Ne){var pe,je,xe,Ce,ze,Te;if(w?pe=hee(w[E+Ne],ee):(pe=Ya(Pe,x),Array.isArray(pe)||(pe=[se,pe])),$==="radial"){je=MT({axis:n,ticks:a,bandSize:P,offset:D.offset,entry:Pe,index:Ne}),ze=c.scale(pe[1]),Ce=c.scale(pe[0]),xe=je+D.size;var Re=ze-Ce;if(Math.abs(Q)>0&&Math.abs(Re)<Math.abs(Q)){var Fe=ul(Re||Q)*(Math.abs(Q)-Math.abs(Re));ze+=Fe}Te={background:{cx:V,cy:L,innerRadius:je,outerRadius:xe,startAngle:r.startAngle,endAngle:r.endAngle}}}else{je=n.scale(pe[0]),xe=n.scale(pe[1]),Ce=MT({axis:c,ticks:f,bandSize:P,offset:D.offset,entry:Pe,index:Ne}),ze=Ce+D.size;var He=xe-je;if(Math.abs(Q)>0&&Math.abs(He)<Math.abs(Q)){var mt=ul(He||Q)*(Math.abs(Q)-Math.abs(He));xe+=mt}}return sl(sl(sl(sl({},Pe),Te),{},{payload:Pe,value:w?pe:pe[1],cx:V,cy:L,innerRadius:je,outerRadius:xe,startAngle:Ce,endAngle:ze},ce&&ce[Ne]&&ce[Ne].props),{},{tooltipPayload:[f4(t,Pe)],tooltipPosition:Ba(V,L,(je+xe)/2,(Ce+ze)/2)})});return{data:he,layout:$}});var hO,dG;function WRe(){if(dG)return hO;dG=1;var e=Math.ceil,t=Math.max;function r(n,a,c,f){for(var i=-1,x=t(e((a-n)/(c||1)),0),w=Array(x);x--;)w[f?x:++i]=n,n+=c;return w}return hO=r,hO}var fO,hG;function zee(){if(hG)return fO;hG=1;var e=rQ(),t=1/0,r=17976931348623157e292;function n(a){if(!a)return a===0?a:0;if(a=e(a),a===t||a===-1/0){var c=a<0?-1:1;return c*r}return a===a?a:0}return fO=n,fO}var pO,fG;function HRe(){if(fG)return pO;fG=1;var e=WRe(),t=sN(),r=zee();function n(a){return function(c,f,i){return i&&typeof i!="number"&&t(c,f,i)&&(f=i=void 0),c=r(c),f===void 0?(f=c,c=0):f=r(f),i=i===void 0?c<f?1:-1:r(i),e(c,f,i,a)}}return pO=n,pO}var mO,pG;function KRe(){if(pG)return mO;pG=1;var e=HRe(),t=e();return mO=t,mO}var ZRe=KRe();const HT=la(ZRe);function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}function mG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mG(Object(r),!0).forEach(function(n){Fee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fee(e,t,r){return t=YRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YRe(e){var t=XRe(e,"string");return kw(t)=="symbol"?t:t+""}function XRe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JRe=["Webkit","Moz","O","ms"],QRe=function(t,r){var n=t.replace(/(\w)/,function(c){return c.toUpperCase()}),a=JRe.reduce(function(c,f){return gG(gG({},c),{},Fee({},f+n,r))},{});return a[t]=r,a};function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function KT(){return KT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KT.apply(this,arguments)}function yG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yG(Object(r),!0).forEach(function(n){Tu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vee(n.key),n)}}function tIe(e,t,r){return t&&vG(e.prototype,t),r&&vG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function rIe(e,t,r){return t=ZT(t),nIe(e,Bee()?Reflect.construct(t,r||[],ZT(e).constructor):t.apply(e,r))}function nIe(e,t){if(t&&(Zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iIe(e)}function iIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bee=function(){return!!e})()}function ZT(e){return ZT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ZT(e)}function aIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HI(e,t)}function HI(e,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},HI(e,t)}function Tu(e,t,r){return t=Vee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vee(e){var t=sIe(e,"string");return Zx(t)=="symbol"?t:t+""}function sIe(e,t){if(Zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var oIe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,c=t.x,f=t.width,i=t.travellerWidth;if(!r||!r.length)return{};var x=r.length,w=m1().domain(HT(0,x)).range([c,c+f-i]),A=w.domain().map(function(P){return w(P)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:w(n),endX:w(a),scale:w,scaleValues:A}},xG=function(t){return t.changedTouches&&!!t.changedTouches.length},Yx=function(e){function t(r){var n;return eIe(this,t),n=rIe(this,t,[r]),Tu(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),Tu(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),Tu(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,c=a.endIndex,f=a.onDragEnd,i=a.startIndex;f==null||f({endIndex:c,startIndex:i})}),n.detachDragEndListener()}),Tu(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Tu(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Tu(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Tu(n,"handleSlideDragStart",function(a){var c=xG(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:c.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return aIe(t,e),tIe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,c=n.endX,f=this.state.scaleValues,i=this.props,x=i.gap,w=i.data,A=w.length-1,P=Math.min(a,c),E=Math.max(a,c),D=t.getIndexInRange(f,P),V=t.getIndexInRange(f,E);return{startIndex:D-D%x,endIndex:V===A?A:V-V%x}}},{key:"getTextOfTick",value:function(n){var a=this.props,c=a.data,f=a.tickFormatter,i=a.dataKey,x=Ya(c[n],i,n);return qn(f)?f(x,n):x}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,c=a.slideMoveStartX,f=a.startX,i=a.endX,x=this.props,w=x.x,A=x.width,P=x.travellerWidth,E=x.startIndex,D=x.endIndex,V=x.onChange,L=n.pageX-c;L>0?L=Math.min(L,w+A-P-i,w+A-P-f):L<0&&(L=Math.max(L,w-f,w-i));var $=this.getIndex({startX:f+L,endX:i+L});($.startIndex!==E||$.endIndex!==D)&&V&&V($),this.setState({startX:f+L,endX:i+L,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var c=xG(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:c.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,c=a.brushMoveStartX,f=a.movingTravellerId,i=a.endX,x=a.startX,w=this.state[f],A=this.props,P=A.x,E=A.width,D=A.travellerWidth,V=A.onChange,L=A.gap,$=A.data,H={startX:this.state.startX,endX:this.state.endX},K=n.pageX-c;K>0?K=Math.min(K,P+E-D-w):K<0&&(K=Math.max(K,P-w)),H[f]=w+K;var Q=this.getIndex(H),ae=Q.startIndex,ee=Q.endIndex,se=function(){var he=$.length-1;return f==="startX"&&(i>x?ae%L===0:ee%L===0)||i<x&&ee===he||f==="endX"&&(i>x?ee%L===0:ae%L===0)||i>x&&ee===he};this.setState(Tu(Tu({},f,w+K),"brushMoveStartX",n.pageX),function(){V&&se()&&V(Q)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var c=this,f=this.state,i=f.scaleValues,x=f.startX,w=f.endX,A=this.state[a],P=i.indexOf(A);if(P!==-1){var E=P+n;if(!(E===-1||E>=i.length)){var D=i[E];a==="startX"&&D>=w||a==="endX"&&D<=x||this.setState(Tu({},a,D),function(){c.props.onChange(c.getIndex({startX:c.state.startX,endX:c.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,c=n.y,f=n.width,i=n.height,x=n.fill,w=n.stroke;return Oe.createElement("rect",{stroke:w,fill:x,x:a,y:c,width:f,height:i})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,c=n.y,f=n.width,i=n.height,x=n.data,w=n.children,A=n.padding,P=W.Children.only(w);return P?Oe.cloneElement(P,{x:a,y:c,width:f,height:i,margin:A,compact:!0,data:x}):null}},{key:"renderTravellerLayer",value:function(n,a){var c,f,i=this,x=this.props,w=x.y,A=x.travellerWidth,P=x.height,E=x.traveller,D=x.ariaLabel,V=x.data,L=x.startIndex,$=x.endIndex,H=Math.max(n,this.props.x),K=gO(gO({},vn(this.props,!1)),{},{x:H,y:w,width:A,height:P}),Q=D||"Min value: ".concat((c=V[L])===null||c===void 0?void 0:c.name,", Max value: ").concat((f=V[$])===null||f===void 0?void 0:f.name);return Oe.createElement(mi,{tabIndex:0,role:"slider","aria-label":Q,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(ee){["ArrowLeft","ArrowRight"].includes(ee.key)&&(ee.preventDefault(),ee.stopPropagation(),i.handleTravellerMoveKeyboard(ee.key==="ArrowRight"?1:-1,a))},onFocus:function(){i.setState({isTravellerFocused:!0})},onBlur:function(){i.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(E,K))}},{key:"renderSlide",value:function(n,a){var c=this.props,f=c.y,i=c.height,x=c.stroke,w=c.travellerWidth,A=Math.min(n,a)+w,P=Math.max(Math.abs(a-n)-w,0);return Oe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:x,fillOpacity:.2,x:A,y:f,width:P,height:i})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,c=n.endIndex,f=n.y,i=n.height,x=n.travellerWidth,w=n.stroke,A=this.state,P=A.startX,E=A.endX,D=5,V={pointerEvents:"none",fill:w};return Oe.createElement(mi,{className:"recharts-brush-texts"},Oe.createElement(q0,KT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(P,E)-D,y:f+i/2},V),this.getTextOfTick(a)),Oe.createElement(q0,KT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(P,E)+x+D,y:f+i/2},V),this.getTextOfTick(c)))}},{key:"render",value:function(){var n=this.props,a=n.data,c=n.className,f=n.children,i=n.x,x=n.y,w=n.width,A=n.height,P=n.alwaysShowText,E=this.state,D=E.startX,V=E.endX,L=E.isTextActive,$=E.isSlideMoving,H=E.isTravellerMoving,K=E.isTravellerFocused;if(!a||!a.length||!zr(i)||!zr(x)||!zr(w)||!zr(A)||w<=0||A<=0)return null;var Q=fi("recharts-brush",c),ae=Oe.Children.count(f)===1,ee=QRe("userSelect","none");return Oe.createElement(mi,{className:Q,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:ee},this.renderBackground(),ae&&this.renderPanorama(),this.renderSlide(D,V),this.renderTravellerLayer(D,"startX"),this.renderTravellerLayer(V,"endX"),(L||$||H||K||P)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,c=n.y,f=n.width,i=n.height,x=n.stroke,w=Math.floor(c+i/2)-1;return Oe.createElement(Oe.Fragment,null,Oe.createElement("rect",{x:a,y:c,width:f,height:i,fill:x,stroke:"none"}),Oe.createElement("line",{x1:a+1,y1:w,x2:a+f-1,y2:w,fill:"none",stroke:"#fff"}),Oe.createElement("line",{x1:a+1,y1:w+2,x2:a+f-1,y2:w+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var c;return Oe.isValidElement(n)?c=Oe.cloneElement(n,a):qn(n)?c=n(a):c=t.renderDefaultTraveller(a),c}},{key:"getDerivedStateFromProps",value:function(n,a){var c=n.data,f=n.width,i=n.x,x=n.travellerWidth,w=n.updateId,A=n.startIndex,P=n.endIndex;if(c!==a.prevData||w!==a.prevUpdateId)return gO({prevData:c,prevTravellerWidth:x,prevUpdateId:w,prevX:i,prevWidth:f},c&&c.length?oIe({data:c,width:f,x:i,travellerWidth:x,startIndex:A,endIndex:P}):{scale:null,scaleValues:null});if(a.scale&&(f!==a.prevWidth||i!==a.prevX||x!==a.prevTravellerWidth)){a.scale.range([i,i+f-x]);var E=a.scale.domain().map(function(D){return a.scale(D)});return{prevData:c,prevTravellerWidth:x,prevUpdateId:w,prevX:i,prevWidth:f,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:E}}return null}},{key:"getIndexInRange",value:function(n,a){for(var c=n.length,f=0,i=c-1;i-f>1;){var x=Math.floor((f+i)/2);n[x]>a?i=x:f=x}return a>=n[i]?i:f}}])}(W.PureComponent);Tu(Yx,"displayName","Brush");Tu(Yx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var yO,_G;function lIe(){if(_G)return yO;_G=1;var e=FL();function t(r,n){var a;return e(r,function(c,f,i){return a=n(c,f,i),!a}),!!a}return yO=t,yO}var vO,bG;function cIe(){if(bG)return vO;bG=1;var e=OJ(),t=hp(),r=lIe(),n=Jc(),a=sN();function c(f,i,x){var w=n(f)?e:r;return x&&a(f,i,x)&&(i=void 0),w(f,t(i,3))}return vO=c,vO}var uIe=cIe();const dIe=la(uIe);var Jf=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},xO,wG;function hIe(){if(wG)return xO;wG=1;var e=XJ();function t(r,n,a){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}return xO=t,xO}var _O,SG;function fIe(){if(SG)return _O;SG=1;var e=hIe(),t=ZJ(),r=hp();function n(a,c){var f={};return c=r(c,3),t(a,function(i,x,w){e(f,x,c(i,x,w))}),f}return _O=n,_O}var pIe=fIe();const mIe=la(pIe);var bO,AG;function gIe(){if(AG)return bO;AG=1;function e(t,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(!r(t[n],n,t))return!1;return!0}return bO=e,bO}var wO,TG;function yIe(){if(TG)return wO;TG=1;var e=FL();function t(r,n){var a=!0;return e(r,function(c,f,i){return a=!!n(c,f,i),a}),a}return wO=t,wO}var SO,PG;function vIe(){if(PG)return SO;PG=1;var e=gIe(),t=yIe(),r=hp(),n=Jc(),a=sN();function c(f,i,x){var w=n(f)?e:t;return x&&a(f,i,x)&&(i=void 0),w(f,r(i,3))}return SO=c,SO}var xIe=vIe();const Uee=la(xIe);var _Ie=["x","y"];function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function KI(){return KI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KI.apply(this,arguments)}function NG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NG(Object(r),!0).forEach(function(n){bIe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bIe(e,t,r){return t=wIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wIe(e){var t=SIe(e,"string");return Ew(t)=="symbol"?t:t+""}function SIe(e,t){if(Ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AIe(e,t){if(e==null)return{};var r=TIe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function TIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function PIe(e,t){var r=e.x,n=e.y,a=AIe(e,_Ie),c="".concat(r),f=parseInt(c,10),i="".concat(n),x=parseInt(i,10),w="".concat(t.height||a.height),A=parseInt(w,10),P="".concat(t.width||a.width),E=parseInt(P,10);return Hb(Hb(Hb(Hb(Hb({},t),a),f?{x:f}:{}),x?{y:x}:{}),{},{height:A,width:E,name:t.name,radius:t.radius})}function jG(e){return Oe.createElement(Nw,KI({shapeType:"rectangle",propTransformer:PIe,activeClassName:"recharts-active-bar"},e))}var NIe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var c=typeof n=="number";return c?t(n,a):(c||W0(),r)}},jIe=["value","background"],$ee;function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function CIe(e,t){if(e==null)return{};var r=kIe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function YT(){return YT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YT.apply(this,arguments)}function CG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CG(Object(r),!0).forEach(function(n){Vg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Gee(n.key),n)}}function MIe(e,t,r){return t&&kG(e.prototype,t),r&&kG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OIe(e,t,r){return t=XT(t),RIe(e,qee()?Reflect.construct(t,r||[],XT(e).constructor):t.apply(e,r))}function RIe(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IIe(e)}function IIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qee=function(){return!!e})()}function XT(e){return XT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XT(e)}function DIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ZI(e,t)}function ZI(e,t){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZI(e,t)}function Vg(e,t,r){return t=Gee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gee(e){var t=LIe(e,"string");return Xx(t)=="symbol"?t:t+""}function LIe(e,t){if(Xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ds=function(e){function t(){var r;EIe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=OIe(this,t,[].concat(a)),Vg(r,"state",{isAnimationFinished:!1}),Vg(r,"id",dy("recharts-bar-")),Vg(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),f&&f()}),Vg(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),f&&f()}),r}return DIe(t,e),MIe(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,c=this.props,f=c.shape,i=c.dataKey,x=c.activeIndex,w=c.activeBar,A=vn(this.props,!1);return n&&n.map(function(P,E){var D=E===x,V=D?w:f,L=xo(xo(xo({},A),P),{},{isActive:D,option:V,index:E,dataKey:i,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return Oe.createElement(mi,YT({className:"recharts-bar-rectangle"},ap(a.props,P,E),{key:"rectangle-".concat(P==null?void 0:P.x,"-").concat(P==null?void 0:P.y,"-").concat(P==null?void 0:P.value)}),Oe.createElement(jG,L))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,c=a.data,f=a.layout,i=a.isAnimationActive,x=a.animationBegin,w=a.animationDuration,A=a.animationEasing,P=a.animationId,E=this.state.prevData;return Oe.createElement(zu,{begin:x,duration:w,isActive:i,easing:A,from:{t:0},to:{t:1},key:"bar-".concat(P),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(D){var V=D.t,L=c.map(function($,H){var K=E&&E[H];if(K){var Q=Za(K.x,$.x),ae=Za(K.y,$.y),ee=Za(K.width,$.width),se=Za(K.height,$.height);return xo(xo({},$),{},{x:Q(V),y:ae(V),width:ee(V),height:se(V)})}if(f==="horizontal"){var ce=Za(0,$.height),he=ce(V);return xo(xo({},$),{},{y:$.y+$.height-he,height:he})}var Pe=Za(0,$.width),Ne=Pe(V);return xo(xo({},$),{},{width:Ne})});return Oe.createElement(mi,null,n.renderRectanglesStatically(L))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,c=n.isAnimationActive,f=this.state.prevData;return c&&a&&a.length&&(!f||!Pm(f,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,c=a.data,f=a.dataKey,i=a.activeIndex,x=vn(this.props.background,!1);return c.map(function(w,A){w.value;var P=w.background,E=CIe(w,jIe);if(!P)return null;var D=xo(xo(xo(xo(xo({},E),{},{fill:"#eee"},P),x),ap(n.props,w,A)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:f,index:A,className:"recharts-bar-background-rectangle"});return Oe.createElement(jG,YT({key:"background-bar-".concat(A),option:n.props.background,isActive:A===i},D))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,f=c.data,i=c.xAxis,x=c.yAxis,w=c.layout,A=c.children,P=Xl(A,I_);if(!P)return null;var E=w==="vertical"?f[0].height/2:f[0].width/2,D=function($,H){var K=Array.isArray($.value)?$.value[1]:$.value;return{x:$.x,y:$.y,value:K,errorVal:Ya($,H)}},V={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Oe.createElement(mi,V,P.map(function(L){return Oe.cloneElement(L,{key:"error-bar-".concat(a,"-").concat(L.props.dataKey),data:f,xAxis:i,yAxis:x,layout:w,offset:E,dataPointFormatter:D})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,c=n.data,f=n.className,i=n.xAxis,x=n.yAxis,w=n.left,A=n.top,P=n.width,E=n.height,D=n.isAnimationActive,V=n.background,L=n.id;if(a||!c||!c.length)return null;var $=this.state.isAnimationFinished,H=fi("recharts-bar",f),K=i&&i.allowDataOverflow,Q=x&&x.allowDataOverflow,ae=K||Q,ee=Xn(L)?this.id:L;return Oe.createElement(mi,{className:H},K||Q?Oe.createElement("defs",null,Oe.createElement("clipPath",{id:"clipPath-".concat(ee)},Oe.createElement("rect",{x:K?w:w-P/2,y:Q?A:A-E/2,width:K?P:P*2,height:Q?E:E*2}))):null,Oe.createElement(mi,{className:"recharts-bar-rectangles",clipPath:ae?"url(#clipPath-".concat(ee,")"):null},V?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(ae,ee),(!D||$)&&Dd.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(W.PureComponent);$ee=ds;Vg(ds,"displayName","Bar");Vg(ds,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!fp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Vg(ds,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,c=e.xAxis,f=e.yAxis,i=e.xAxisTicks,x=e.yAxisTicks,w=e.stackedData,A=e.dataStartIndex,P=e.displayedData,E=e.offset,D=dee(n,r);if(!D)return null;var V=t.layout,L=r.type.defaultProps,$=L!==void 0?xo(xo({},L),r.props):r.props,H=$.dataKey,K=$.children,Q=$.minPointSize,ae=V==="horizontal"?f:c,ee=w?ae.scale.domain():null,se=pee({numericAxis:ae}),ce=Xl(K,Kh),he=P.map(function(Pe,Ne){var pe,je,xe,Ce,ze,Te;w?pe=hee(w[A+Ne],ee):(pe=Ya(Pe,H),Array.isArray(pe)||(pe=[se,pe]));var Re=NIe(Q,$ee.defaultProps.minPointSize)(pe[1],Ne);if(V==="horizontal"){var Fe,He=[f.scale(pe[0]),f.scale(pe[1])],mt=He[0],Xe=He[1];je=MT({axis:c,ticks:i,bandSize:a,offset:D.offset,entry:Pe,index:Ne}),xe=(Fe=Xe??mt)!==null&&Fe!==void 0?Fe:void 0,Ce=D.size;var ot=mt-Xe;if(ze=Number.isNaN(ot)?0:ot,Te={x:je,y:f.y,width:Ce,height:f.height},Math.abs(Re)>0&&Math.abs(ze)<Math.abs(Re)){var qe=ul(ze||Re)*(Math.abs(Re)-Math.abs(ze));xe-=qe,ze+=qe}}else{var Lt=[c.scale(pe[0]),c.scale(pe[1])],Zt=Lt[0],Xt=Lt[1];if(je=Zt,xe=MT({axis:f,ticks:x,bandSize:a,offset:D.offset,entry:Pe,index:Ne}),Ce=Xt-Zt,ze=D.size,Te={x:c.x,y:xe,width:c.width,height:ze},Math.abs(Re)>0&&Math.abs(Ce)<Math.abs(Re)){var rr=ul(Ce||Re)*(Math.abs(Re)-Math.abs(Ce));Ce+=rr}}return xo(xo(xo({},Pe),{},{x:je,y:xe,width:Ce,height:ze,value:w?pe:pe[1],payload:Pe,background:Te},ce&&ce[Ne]&&ce[Ne].props),{},{tooltipPayload:[f4(r,Pe)],tooltipPosition:{x:je+Ce/2,y:xe+ze/2}})});return xo({data:he,layout:V},E)});function Mw(e){"@babel/helpers - typeof";return Mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mw(e)}function zIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function EG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wee(n.key),n)}}function FIe(e,t,r){return t&&EG(e.prototype,t),r&&EG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function MG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MG(Object(r),!0).forEach(function(n){bN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bN(e,t,r){return t=Wee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wee(e){var t=BIe(e,"string");return Mw(t)=="symbol"?t:t+""}function BIe(e,t){if(Mw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Mw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var v2=function(t,r,n,a,c){var f=t.width,i=t.height,x=t.layout,w=t.children,A=Object.keys(r),P={left:n.left,leftMirror:n.left,right:f-n.right,rightMirror:f-n.right,top:n.top,topMirror:n.top,bottom:i-n.bottom,bottomMirror:i-n.bottom},E=!!Pu(w,ds);return A.reduce(function(D,V){var L=r[V],$=L.orientation,H=L.domain,K=L.padding,Q=K===void 0?{}:K,ae=L.mirror,ee=L.reversed,se="".concat($).concat(ae?"Mirror":""),ce,he,Pe,Ne,pe;if(L.type==="number"&&(L.padding==="gap"||L.padding==="no-gap")){var je=H[1]-H[0],xe=1/0,Ce=L.categoricalDomain.sort();if(Ce.forEach(function(Lt,Zt){Zt>0&&(xe=Math.min((Lt||0)-(Ce[Zt-1]||0),xe))}),Number.isFinite(xe)){var ze=xe/je,Te=L.layout==="vertical"?n.height:n.width;if(L.padding==="gap"&&(ce=ze*Te/2),L.padding==="no-gap"){var Re=vc(t.barCategoryGap,ze*Te),Fe=ze*Te/2;ce=Fe-Re-(Fe-Re)/Te*Re}}}a==="xAxis"?he=[n.left+(Q.left||0)+(ce||0),n.left+n.width-(Q.right||0)-(ce||0)]:a==="yAxis"?he=x==="horizontal"?[n.top+n.height-(Q.bottom||0),n.top+(Q.top||0)]:[n.top+(Q.top||0)+(ce||0),n.top+n.height-(Q.bottom||0)-(ce||0)]:he=L.range,ee&&(he=[he[1],he[0]]);var He=cee(L,c,E),mt=He.scale,Xe=He.realScaleType;mt.domain(H).range(he),uee(mt);var ot=fee(mt,Ih(Ih({},L),{},{realScaleType:Xe}));a==="xAxis"?(pe=$==="top"&&!ae||$==="bottom"&&ae,Pe=n.left,Ne=P[se]-pe*L.height):a==="yAxis"&&(pe=$==="left"&&!ae||$==="right"&&ae,Pe=P[se]-pe*L.width,Ne=n.top);var qe=Ih(Ih(Ih({},L),ot),{},{realScaleType:Xe,x:Pe,y:Ne,scale:mt,width:a==="xAxis"?n.width:L.width,height:a==="yAxis"?n.height:L.height});return qe.bandSize=OT(qe,ot),!L.hide&&a==="xAxis"?P[se]+=(pe?-1:1)*qe.height:L.hide||(P[se]+=(pe?-1:1)*qe.width),Ih(Ih({},D),{},bN({},V,qe))},{})},Hee=function(t,r){var n=t.x,a=t.y,c=r.x,f=r.y;return{x:Math.min(n,c),y:Math.min(a,f),width:Math.abs(c-n),height:Math.abs(f-a)}},VIe=function(t){var r=t.x1,n=t.y1,a=t.x2,c=t.y2;return Hee({x:r,y:n},{x:a,y:c})},Kee=function(){function e(t){zIe(this,e),this.scale=t}return FIe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,c=n.position;if(r!==void 0){if(c)switch(c){case"start":return this.scale(r);case"middle":{var f=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+f}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(r)+i}default:return this.scale(r)}if(a){var x=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+x}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],c=n[n.length-1];return a<=c?r>=a&&r<=c:r>=c&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();bN(Kee,"EPS",1e-4);var m4=function(t){var r=Object.keys(t).reduce(function(n,a){return Ih(Ih({},n),{},bN({},a,Kee.create(t[a])))},{});return Ih(Ih({},r),{},{apply:function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=c.bandAware,i=c.position;return mIe(a,function(x,w){return r[w].apply(x,{bandAware:f,position:i})})},isInRange:function(a){return Uee(a,function(c,f){return r[f].isInRange(c)})}})};function UIe(e){return(e%180+180)%180}var $Ie=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=UIe(a),f=c*Math.PI/180,i=Math.atan(n/r),x=f>i&&f<Math.PI-i?n/Math.sin(f):r/Math.cos(f);return Math.abs(x)},AO,OG;function qIe(){if(OG)return AO;OG=1;var e=hp(),t=c2(),r=iN();function n(a){return function(c,f,i){var x=Object(c);if(!t(c)){var w=e(f,3);c=r(c),f=function(P){return w(x[P],P,x)}}var A=a(c,f,i);return A>-1?x[w?c[A]:A]:void 0}}return AO=n,AO}var TO,RG;function GIe(){if(RG)return TO;RG=1;var e=zee();function t(r){var n=e(r),a=n%1;return n===n?a?n-a:n:0}return TO=t,TO}var PO,IG;function WIe(){if(IG)return PO;IG=1;var e=qJ(),t=hp(),r=GIe(),n=Math.max;function a(c,f,i){var x=c==null?0:c.length;if(!x)return-1;var w=i==null?0:r(i);return w<0&&(w=n(x+w,0)),e(c,t(f,3),w)}return PO=a,PO}var NO,DG;function HIe(){if(DG)return NO;DG=1;var e=qIe(),t=WIe(),r=e(t);return NO=r,NO}var KIe=HIe();const ZIe=la(KIe);var YIe=aJ();const XIe=la(YIe);var JIe=XIe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),g4=W.createContext(void 0),y4=W.createContext(void 0),Zee=W.createContext(void 0),Yee=W.createContext({}),Xee=W.createContext(void 0),Jee=W.createContext(0),Qee=W.createContext(0),LG=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,c=r.offset,f=t.clipPathId,i=t.children,x=t.width,w=t.height,A=JIe(c);return Oe.createElement(g4.Provider,{value:n},Oe.createElement(y4.Provider,{value:a},Oe.createElement(Yee.Provider,{value:c},Oe.createElement(Zee.Provider,{value:A},Oe.createElement(Xee.Provider,{value:f},Oe.createElement(Jee.Provider,{value:w},Oe.createElement(Qee.Provider,{value:x},i)))))))},QIe=function(){return W.useContext(Xee)},ete=function(t){var r=W.useContext(g4);r==null&&W0();var n=r[t];return n==null&&W0(),n},e3e=function(){var t=W.useContext(g4);return zg(t)},t3e=function(){var t=W.useContext(y4),r=ZIe(t,function(n){return Uee(n.domain,Number.isFinite)});return r||zg(t)},tte=function(t){var r=W.useContext(y4);r==null&&W0();var n=r[t];return n==null&&W0(),n},r3e=function(){var t=W.useContext(Zee);return t},n3e=function(){return W.useContext(Yee)},v4=function(){return W.useContext(Qee)},x4=function(){return W.useContext(Jee)};function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function i3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nte(n.key),n)}}function s3e(e,t,r){return t&&a3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function o3e(e,t,r){return t=JT(t),l3e(e,rte()?Reflect.construct(t,r||[],JT(e).constructor):t.apply(e,r))}function l3e(e,t){if(t&&(Jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c3e(e)}function c3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(rte=function(){return!!e})()}function JT(e){return JT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},JT(e)}function u3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YI(e,t)}function YI(e,t){return YI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YI(e,t)}function zG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zG(Object(r),!0).forEach(function(n){_4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _4(e,t,r){return t=nte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nte(e){var t=d3e(e,"string");return Jx(t)=="symbol"?t:t+""}function d3e(e,t){if(Jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function h3e(e,t){return g3e(e)||m3e(e,t)||p3e(e,t)||f3e()}function f3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p3e(e,t){if(e){if(typeof e=="string")return BG(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BG(e,t)}}function BG(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function g3e(e){if(Array.isArray(e))return e}function XI(){return XI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XI.apply(this,arguments)}var y3e=function(t,r){var n;return Oe.isValidElement(t)?n=Oe.cloneElement(t,r):qn(t)?n=t(r):n=Oe.createElement("line",XI({},r,{className:"recharts-reference-line-line"})),n},v3e=function(t,r,n,a,c,f,i,x,w){var A=c.x,P=c.y,E=c.width,D=c.height;if(n){var V=w.y,L=t.y.apply(V,{position:f});if(Jf(w,"discard")&&!t.y.isInRange(L))return null;var $=[{x:A+E,y:L},{x:A,y:L}];return x==="left"?$.reverse():$}if(r){var H=w.x,K=t.x.apply(H,{position:f});if(Jf(w,"discard")&&!t.x.isInRange(K))return null;var Q=[{x:K,y:P+D},{x:K,y:P}];return i==="top"?Q.reverse():Q}if(a){var ae=w.segment,ee=ae.map(function(se){return t.apply(se,{position:f})});return Jf(w,"discard")&&dIe(ee,function(se){return!t.isInRange(se)})?null:ee}return null};function x3e(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,c=e.yAxisId,f=e.shape,i=e.className,x=e.alwaysShow,w=QIe(),A=ete(a),P=tte(c),E=r3e();if(!w||!E)return null;Vh(x===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var D=m4({x:A.scale,y:P.scale}),V=Vo(t),L=Vo(r),$=n&&n.length===2,H=v3e(D,V,L,$,E,e.position,A.orientation,P.orientation,e);if(!H)return null;var K=h3e(H,2),Q=K[0],ae=Q.x,ee=Q.y,se=K[1],ce=se.x,he=se.y,Pe=Jf(e,"hidden")?"url(#".concat(w,")"):void 0,Ne=FG(FG({clipPath:Pe},vn(e,!0)),{},{x1:ae,y1:ee,x2:ce,y2:he});return Oe.createElement(mi,{className:fi("recharts-reference-line",i)},y3e(f,Ne),ll.renderCallByParent(e,VIe({x1:ae,y1:ee,x2:ce,y2:he})))}var b4=function(e){function t(){return i3e(this,t),o3e(this,t,arguments)}return u3e(t,e),s3e(t,[{key:"render",value:function(){return Oe.createElement(x3e,this.props)}}])}(Oe.Component);_4(b4,"displayName","ReferenceLine");_4(b4,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function JI(){return JI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JI.apply(this,arguments)}function Qx(e){"@babel/helpers - typeof";return Qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qx(e)}function VG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VG(Object(r),!0).forEach(function(n){wN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ate(n.key),n)}}function w3e(e,t,r){return t&&b3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function S3e(e,t,r){return t=QT(t),A3e(e,ite()?Reflect.construct(t,r||[],QT(e).constructor):t.apply(e,r))}function A3e(e,t){if(t&&(Qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T3e(e)}function T3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ite(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ite=function(){return!!e})()}function QT(e){return QT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QT(e)}function P3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&QI(e,t)}function QI(e,t){return QI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},QI(e,t)}function wN(e,t,r){return t=ate(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ate(e){var t=N3e(e,"string");return Qx(t)=="symbol"?t:t+""}function N3e(e,t){if(Qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var j3e=function(t){var r=t.x,n=t.y,a=t.xAxis,c=t.yAxis,f=m4({x:a.scale,y:c.scale}),i=f.apply({x:r,y:n},{bandAware:!0});return Jf(t,"discard")&&!f.isInRange(i)?null:i},SN=function(e){function t(){return _3e(this,t),S3e(this,t,arguments)}return P3e(t,e),w3e(t,[{key:"render",value:function(){var n=this.props,a=n.x,c=n.y,f=n.r,i=n.alwaysShow,x=n.clipPathId,w=Vo(a),A=Vo(c);if(Vh(i===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!w||!A)return null;var P=j3e(this.props);if(!P)return null;var E=P.x,D=P.y,V=this.props,L=V.shape,$=V.className,H=Jf(this.props,"hidden")?"url(#".concat(x,")"):void 0,K=UG(UG({clipPath:H},vn(this.props,!0)),{},{cx:E,cy:D});return Oe.createElement(mi,{className:fi("recharts-reference-dot",$)},t.renderDot(L,K),ll.renderCallByParent(this.props,{x:E-f,y:D-f,width:2*f,height:2*f}))}}])}(Oe.Component);wN(SN,"displayName","ReferenceDot");wN(SN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});wN(SN,"renderDot",function(e,t){var r;return Oe.isValidElement(e)?r=Oe.cloneElement(e,t):qn(e)?r=e(t):r=Oe.createElement(p2,JI({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function e3(){return e3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e3.apply(this,arguments)}function e_(e){"@babel/helpers - typeof";return e_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e_(e)}function $G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$G(Object(r),!0).forEach(function(n){AN(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$G(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k3e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ote(n.key),n)}}function E3e(e,t,r){return t&&k3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function M3e(e,t,r){return t=eP(t),O3e(e,ste()?Reflect.construct(t,r||[],eP(e).constructor):t.apply(e,r))}function O3e(e,t){if(t&&(e_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R3e(e)}function R3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ste(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ste=function(){return!!e})()}function eP(e){return eP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},eP(e)}function I3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&t3(e,t)}function t3(e,t){return t3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},t3(e,t)}function AN(e,t,r){return t=ote(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ote(e){var t=D3e(e,"string");return e_(t)=="symbol"?t:t+""}function D3e(e,t){if(e_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(e_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var L3e=function(t,r,n,a,c){var f=c.x1,i=c.x2,x=c.y1,w=c.y2,A=c.xAxis,P=c.yAxis;if(!A||!P)return null;var E=m4({x:A.scale,y:P.scale}),D={x:t?E.x.apply(f,{position:"start"}):E.x.rangeMin,y:n?E.y.apply(x,{position:"start"}):E.y.rangeMin},V={x:r?E.x.apply(i,{position:"end"}):E.x.rangeMax,y:a?E.y.apply(w,{position:"end"}):E.y.rangeMax};return Jf(c,"discard")&&(!E.isInRange(D)||!E.isInRange(V))?null:Hee(D,V)},TN=function(e){function t(){return C3e(this,t),M3e(this,t,arguments)}return I3e(t,e),E3e(t,[{key:"render",value:function(){var n=this.props,a=n.x1,c=n.x2,f=n.y1,i=n.y2,x=n.className,w=n.alwaysShow,A=n.clipPathId;Vh(w===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var P=Vo(a),E=Vo(c),D=Vo(f),V=Vo(i),L=this.props.shape;if(!P&&!E&&!D&&!V&&!L)return null;var $=L3e(P,E,D,V,this.props);if(!$&&!L)return null;var H=Jf(this.props,"hidden")?"url(#".concat(A,")"):void 0;return Oe.createElement(mi,{className:fi("recharts-reference-area",x)},t.renderRect(L,qG(qG({clipPath:H},vn(this.props,!0)),$)),ll.renderCallByParent(this.props,$))}}])}(Oe.Component);AN(TN,"displayName","ReferenceArea");AN(TN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});AN(TN,"renderRect",function(e,t){var r;return Oe.isValidElement(e)?r=Oe.cloneElement(e,t):qn(e)?r=e(t):r=Oe.createElement(p4,e3({},t,{className:"recharts-reference-area-rect"})),r});function lte(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)n.push(e[a]);return n}function z3e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return $Ie(n,r)}function F3e(e,t,r){var n=r==="width",a=e.x,c=e.y,f=e.width,i=e.height;return t===1?{start:n?a:c,end:n?a+f:c+i}:{start:n?a+f:c+i,end:n?a:c}}function tP(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var c=r();return e*(t-e*c/2-n)>=0&&e*(t+e*c/2-a)<=0}function B3e(e,t){return lte(e,t+1)}function V3e(e,t,r,n,a){for(var c=(n||[]).slice(),f=t.start,i=t.end,x=0,w=1,A=f,P=function(){var V=n==null?void 0:n[x];if(V===void 0)return{v:lte(n,w)};var L=x,$,H=function(){return $===void 0&&($=r(V,L)),$},K=V.coordinate,Q=x===0||tP(e,K,H,A,i);Q||(x=0,A=f,w+=1),Q&&(A=K+e*(H()/2+a),x+=w)},E;w<=c.length;)if(E=P(),E)return E.v;return[]}function Ow(e){"@babel/helpers - typeof";return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}function GG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Hl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GG(Object(r),!0).forEach(function(n){U3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U3e(e,t,r){return t=$3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $3e(e){var t=q3e(e,"string");return Ow(t)=="symbol"?t:t+""}function q3e(e,t){if(Ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G3e(e,t,r,n,a){for(var c=(n||[]).slice(),f=c.length,i=t.start,x=t.end,w=function(E){var D=c[E],V,L=function(){return V===void 0&&(V=r(D,E)),V};if(E===f-1){var $=e*(D.coordinate+e*L()/2-x);c[E]=D=Hl(Hl({},D),{},{tickCoord:$>0?D.coordinate-$*e:D.coordinate})}else c[E]=D=Hl(Hl({},D),{},{tickCoord:D.coordinate});var H=tP(e,D.tickCoord,L,i,x);H&&(x=D.tickCoord-e*(L()/2+a),c[E]=Hl(Hl({},D),{},{isShow:!0}))},A=f-1;A>=0;A--)w(A);return c}function W3e(e,t,r,n,a,c){var f=(n||[]).slice(),i=f.length,x=t.start,w=t.end;if(c){var A=n[i-1],P=r(A,i-1),E=e*(A.coordinate+e*P/2-w);f[i-1]=A=Hl(Hl({},A),{},{tickCoord:E>0?A.coordinate-E*e:A.coordinate});var D=tP(e,A.tickCoord,function(){return P},x,w);D&&(w=A.tickCoord-e*(P/2+a),f[i-1]=Hl(Hl({},A),{},{isShow:!0}))}for(var V=c?i-1:i,L=function(K){var Q=f[K],ae,ee=function(){return ae===void 0&&(ae=r(Q,K)),ae};if(K===0){var se=e*(Q.coordinate-e*ee()/2-x);f[K]=Q=Hl(Hl({},Q),{},{tickCoord:se<0?Q.coordinate-se*e:Q.coordinate})}else f[K]=Q=Hl(Hl({},Q),{},{tickCoord:Q.coordinate});var ce=tP(e,Q.tickCoord,ee,x,w);ce&&(x=Q.tickCoord+e*(ee()/2+a),f[K]=Hl(Hl({},Q),{},{isShow:!0}))},$=0;$<V;$++)L($);return f}function w4(e,t,r){var n=e.tick,a=e.ticks,c=e.viewBox,f=e.minTickGap,i=e.orientation,x=e.interval,w=e.tickFormatter,A=e.unit,P=e.angle;if(!a||!a.length||!n)return[];if(zr(x)||fp.isSsr)return B3e(a,typeof x=="number"&&zr(x)?x:0);var E=[],D=i==="top"||i==="bottom"?"width":"height",V=A&&D==="width"?p1(A,{fontSize:t,letterSpacing:r}):{width:0,height:0},L=function(Q,ae){var ee=qn(w)?w(Q.value,ae):Q.value;return D==="width"?z3e(p1(ee,{fontSize:t,letterSpacing:r}),V,P):p1(ee,{fontSize:t,letterSpacing:r})[D]},$=a.length>=2?ul(a[1].coordinate-a[0].coordinate):1,H=F3e(c,$,D);return x==="equidistantPreserveStart"?V3e($,H,L,a,f):(x==="preserveStart"||x==="preserveStartEnd"?E=W3e($,H,L,a,f,x==="preserveStartEnd"):E=G3e($,H,L,a,f),E.filter(function(K){return K.isShow}))}var H3e=["viewBox"],K3e=["viewBox"],Z3e=["ticks"];function t_(e){"@babel/helpers - typeof";return t_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t_(e)}function gx(){return gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gx.apply(this,arguments)}function WG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WG(Object(r),!0).forEach(function(n){S4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jO(e,t){if(e==null)return{};var r=Y3e(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Y3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function X3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ute(n.key),n)}}function J3e(e,t,r){return t&&HG(e.prototype,t),r&&HG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Q3e(e,t,r){return t=rP(t),eDe(e,cte()?Reflect.construct(t,r||[],rP(e).constructor):t.apply(e,r))}function eDe(e,t){if(t&&(t_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tDe(e)}function tDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cte=function(){return!!e})()}function rP(e){return rP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rP(e)}function rDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r3(e,t)}function r3(e,t){return r3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},r3(e,t)}function S4(e,t,r){return t=ute(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ute(e){var t=nDe(e,"string");return t_(t)=="symbol"?t:t+""}function nDe(e,t){if(t_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(t_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var D_=function(e){function t(r){var n;return X3e(this,t),n=Q3e(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return rDe(t,e),J3e(t,[{key:"shouldComponentUpdate",value:function(n,a){var c=n.viewBox,f=jO(n,H3e),i=this.props,x=i.viewBox,w=jO(i,K3e);return!wx(c,x)||!wx(f,w)||!wx(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,c=a.x,f=a.y,i=a.width,x=a.height,w=a.orientation,A=a.tickSize,P=a.mirror,E=a.tickMargin,D,V,L,$,H,K,Q=P?-1:1,ae=n.tickSize||A,ee=zr(n.tickCoord)?n.tickCoord:n.coordinate;switch(w){case"top":D=V=n.coordinate,$=f+ +!P*x,L=$-Q*ae,K=L-Q*E,H=ee;break;case"left":L=$=n.coordinate,V=c+ +!P*i,D=V-Q*ae,H=D-Q*E,K=ee;break;case"right":L=$=n.coordinate,V=c+ +P*i,D=V+Q*ae,H=D+Q*E,K=ee;break;default:D=V=n.coordinate,$=f+ +P*x,L=$+Q*ae,K=L+Q*E,H=ee;break}return{line:{x1:D,y1:L,x2:V,y2:$},tick:{x:H,y:K}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,c=n.mirror,f;switch(a){case"left":f=c?"start":"end";break;case"right":f=c?"end":"start";break;default:f="middle";break}return f}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,c=n.mirror,f="end";switch(a){case"left":case"right":f="middle";break;case"top":f=c?"start":"end";break;default:f=c?"end":"start";break}return f}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,c=n.y,f=n.width,i=n.height,x=n.orientation,w=n.mirror,A=n.axisLine,P=pc(pc(pc({},vn(this.props,!1)),vn(A,!1)),{},{fill:"none"});if(x==="top"||x==="bottom"){var E=+(x==="top"&&!w||x==="bottom"&&w);P=pc(pc({},P),{},{x1:a,y1:c+E*i,x2:a+f,y2:c+E*i})}else{var D=+(x==="left"&&!w||x==="right"&&w);P=pc(pc({},P),{},{x1:a+D*f,y1:c,x2:a+D*f,y2:c+i})}return Oe.createElement("line",gx({},P,{className:fi("recharts-cartesian-axis-line",Iu(A,"className"))}))}},{key:"renderTicks",value:function(n,a,c){var f=this,i=this.props,x=i.tickLine,w=i.stroke,A=i.tick,P=i.tickFormatter,E=i.unit,D=w4(pc(pc({},this.props),{},{ticks:n}),a,c),V=this.getTickTextAnchor(),L=this.getTickVerticalAnchor(),$=vn(this.props,!1),H=vn(A,!1),K=pc(pc({},$),{},{fill:"none"},vn(x,!1)),Q=D.map(function(ae,ee){var se=f.getTickLineCoord(ae),ce=se.line,he=se.tick,Pe=pc(pc(pc(pc({textAnchor:V,verticalAnchor:L},$),{},{stroke:"none",fill:w},H),he),{},{index:ee,payload:ae,visibleTicksCount:D.length,tickFormatter:P});return Oe.createElement(mi,gx({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ae.value,"-").concat(ae.coordinate,"-").concat(ae.tickCoord)},ap(f.props,ae,ee)),x&&Oe.createElement("line",gx({},K,ce,{className:fi("recharts-cartesian-axis-tick-line",Iu(x,"className"))})),A&&t.renderTickItem(A,Pe,"".concat(qn(P)?P(ae.value,ee):ae.value).concat(E||"")))});return Oe.createElement("g",{className:"recharts-cartesian-axis-ticks"},Q)}},{key:"render",value:function(){var n=this,a=this.props,c=a.axisLine,f=a.width,i=a.height,x=a.ticksGenerator,w=a.className,A=a.hide;if(A)return null;var P=this.props,E=P.ticks,D=jO(P,Z3e),V=E;return qn(x)&&(V=E&&E.length>0?x(this.props):x(D)),f<=0||i<=0||!V||!V.length?null:Oe.createElement(mi,{className:fi("recharts-cartesian-axis",w),ref:function($){n.layerReference=$}},c&&this.renderAxisLine(),this.renderTicks(V,this.state.fontSize,this.state.letterSpacing),ll.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,c){var f;return Oe.isValidElement(n)?f=Oe.cloneElement(n,a):qn(n)?f=n(a):f=Oe.createElement(q0,gx({},a,{className:"recharts-cartesian-axis-tick-value"}),c),f}}])}(W.Component);S4(D_,"displayName","CartesianAxis");S4(D_,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var iDe=["x1","y1","x2","y2","key"],aDe=["offset"];function H0(e){"@babel/helpers - typeof";return H0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H0(e)}function KG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KG(Object(r),!0).forEach(function(n){sDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sDe(e,t,r){return t=oDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oDe(e){var t=lDe(e,"string");return H0(t)=="symbol"?t:t+""}function lDe(e,t){if(H0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(H0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C0(){return C0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C0.apply(this,arguments)}function ZG(e,t){if(e==null)return{};var r=cDe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var uDe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,c=t.y,f=t.width,i=t.height,x=t.ry;return Oe.createElement("rect",{x:a,y:c,ry:x,width:f,height:i,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function dte(e,t){var r;if(Oe.isValidElement(e))r=Oe.cloneElement(e,t);else if(qn(e))r=e(t);else{var n=t.x1,a=t.y1,c=t.x2,f=t.y2,i=t.key,x=ZG(t,iDe),w=vn(x,!1);w.offset;var A=ZG(w,aDe);r=Oe.createElement("line",C0({},A,{x1:n,y1:a,x2:c,y2:f,fill:"none",key:i}))}return r}function dDe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,c=e.horizontalPoints;if(!a||!c||!c.length)return null;var f=c.map(function(i,x){var w=Kl(Kl({},e),{},{x1:t,y1:i,x2:t+r,y2:i,key:"line-".concat(x),index:x});return dte(a,w)});return Oe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function hDe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,c=e.verticalPoints;if(!a||!c||!c.length)return null;var f=c.map(function(i,x){var w=Kl(Kl({},e),{},{x1:i,y1:t,x2:i,y2:t+r,key:"line-".concat(x),index:x});return dte(a,w)});return Oe.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function fDe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,c=e.width,f=e.height,i=e.horizontalPoints,x=e.horizontal,w=x===void 0?!0:x;if(!w||!t||!t.length)return null;var A=i.map(function(E){return Math.round(E+a-a)}).sort(function(E,D){return E-D});a!==A[0]&&A.unshift(0);var P=A.map(function(E,D){var V=!A[D+1],L=V?a+f-E:A[D+1]-E;if(L<=0)return null;var $=D%t.length;return Oe.createElement("rect",{key:"react-".concat(D),y:E,x:n,height:L,width:c,stroke:"none",fill:t[$],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Oe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},P)}function pDe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,c=e.x,f=e.y,i=e.width,x=e.height,w=e.verticalPoints;if(!r||!n||!n.length)return null;var A=w.map(function(E){return Math.round(E+c-c)}).sort(function(E,D){return E-D});c!==A[0]&&A.unshift(0);var P=A.map(function(E,D){var V=!A[D+1],L=V?c+i-E:A[D+1]-E;if(L<=0)return null;var $=D%n.length;return Oe.createElement("rect",{key:"react-".concat(D),x:E,y:f,width:L,height:x,stroke:"none",fill:n[$],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return Oe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},P)}var mDe=function(t,r){var n=t.xAxis,a=t.width,c=t.height,f=t.offset;return lee(w4(Kl(Kl(Kl({},D_.defaultProps),n),{},{ticks:dm(n,!0),viewBox:{x:0,y:0,width:a,height:c}})),f.left,f.left+f.width,r)},gDe=function(t,r){var n=t.yAxis,a=t.width,c=t.height,f=t.offset;return lee(w4(Kl(Kl(Kl({},D_.defaultProps),n),{},{ticks:dm(n,!0),viewBox:{x:0,y:0,width:a,height:c}})),f.top,f.top+f.height,r)},rx={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Ws(e){var t,r,n,a,c,f,i=v4(),x=x4(),w=n3e(),A=Kl(Kl({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:rx.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:rx.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:rx.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:rx.horizontalFill,vertical:(c=e.vertical)!==null&&c!==void 0?c:rx.vertical,verticalFill:(f=e.verticalFill)!==null&&f!==void 0?f:rx.verticalFill,x:zr(e.x)?e.x:w.left,y:zr(e.y)?e.y:w.top,width:zr(e.width)?e.width:w.width,height:zr(e.height)?e.height:w.height}),P=A.x,E=A.y,D=A.width,V=A.height,L=A.syncWithTicks,$=A.horizontalValues,H=A.verticalValues,K=e3e(),Q=t3e();if(!zr(D)||D<=0||!zr(V)||V<=0||!zr(P)||P!==+P||!zr(E)||E!==+E)return null;var ae=A.verticalCoordinatesGenerator||mDe,ee=A.horizontalCoordinatesGenerator||gDe,se=A.horizontalPoints,ce=A.verticalPoints;if((!se||!se.length)&&qn(ee)){var he=$&&$.length,Pe=ee({yAxis:Q?Kl(Kl({},Q),{},{ticks:he?$:Q.ticks}):void 0,width:i,height:x,offset:w},he?!0:L);Vh(Array.isArray(Pe),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(H0(Pe),"]")),Array.isArray(Pe)&&(se=Pe)}if((!ce||!ce.length)&&qn(ae)){var Ne=H&&H.length,pe=ae({xAxis:K?Kl(Kl({},K),{},{ticks:Ne?H:K.ticks}):void 0,width:i,height:x,offset:w},Ne?!0:L);Vh(Array.isArray(pe),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(H0(pe),"]")),Array.isArray(pe)&&(ce=pe)}return Oe.createElement("g",{className:"recharts-cartesian-grid"},Oe.createElement(uDe,{fill:A.fill,fillOpacity:A.fillOpacity,x:A.x,y:A.y,width:A.width,height:A.height,ry:A.ry}),Oe.createElement(dDe,C0({},A,{offset:w,horizontalPoints:se,xAxis:K,yAxis:Q})),Oe.createElement(hDe,C0({},A,{offset:w,verticalPoints:ce,xAxis:K,yAxis:Q})),Oe.createElement(fDe,C0({},A,{horizontalPoints:se})),Oe.createElement(pDe,C0({},A,{verticalPoints:ce})))}Ws.displayName="CartesianGrid";var yDe=["type","layout","connectNulls","ref"],vDe=["key"];function r_(e){"@babel/helpers - typeof";return r_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r_(e)}function YG(e,t){if(e==null)return{};var r=xDe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function _1(){return _1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_1.apply(this,arguments)}function XG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Au(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XG(Object(r),!0).forEach(function(n){Dh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nx(e){return SDe(e)||wDe(e)||bDe(e)||_De()}function _De(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bDe(e,t){if(e){if(typeof e=="string")return n3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n3(e,t)}}function wDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function SDe(e){if(Array.isArray(e))return n3(e)}function n3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ADe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JG(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fte(n.key),n)}}function TDe(e,t,r){return t&&JG(e.prototype,t),r&&JG(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function PDe(e,t,r){return t=nP(t),NDe(e,hte()?Reflect.construct(t,r||[],nP(e).constructor):t.apply(e,r))}function NDe(e,t){if(t&&(r_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jDe(e)}function jDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hte=function(){return!!e})()}function nP(e){return nP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nP(e)}function CDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i3(e,t)}function i3(e,t){return i3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},i3(e,t)}function Dh(e,t,r){return t=fte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fte(e){var t=kDe(e,"string");return r_(t)=="symbol"?t:t+""}function kDe(e,t){if(r_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(r_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var op=function(e){function t(){var r;ADe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=PDe(this,t,[].concat(a)),Dh(r,"state",{isAnimationFinished:!0,totalLength:0}),Dh(r,"generateSimpleStrokeDasharray",function(f,i){return"".concat(i,"px ").concat(f-i,"px")}),Dh(r,"getStrokeDasharray",function(f,i,x){var w=x.reduce(function(H,K){return H+K});if(!w)return r.generateSimpleStrokeDasharray(i,f);for(var A=Math.floor(f/w),P=f%w,E=i-f,D=[],V=0,L=0;V<x.length;L+=x[V],++V)if(L+x[V]>P){D=[].concat(nx(x.slice(0,V)),[P-L]);break}var $=D.length%2===0?[0,E]:[E];return[].concat(nx(t.repeat(x,A)),nx(D),$).map(function(H){return"".concat(H,"px")}).join(", ")}),Dh(r,"id",dy("recharts-line-")),Dh(r,"pathRef",function(f){r.mainCurve=f}),Dh(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Dh(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return CDe(t,e),TDe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var c=this.props,f=c.points,i=c.xAxis,x=c.yAxis,w=c.layout,A=c.children,P=Xl(A,I_);if(!P)return null;var E=function(L,$){return{x:L.x,y:L.y,value:L.value,errorVal:Ya(L.payload,$)}},D={clipPath:n?"url(#clipPath-".concat(a,")"):null};return Oe.createElement(mi,D,P.map(function(V){return Oe.cloneElement(V,{key:"bar-".concat(V.props.dataKey),data:f,xAxis:i,yAxis:x,layout:w,dataPointFormatter:E})}))}},{key:"renderDots",value:function(n,a,c){var f=this.props.isAnimationActive;if(f&&!this.state.isAnimationFinished)return null;var i=this.props,x=i.dot,w=i.points,A=i.dataKey,P=vn(this.props,!1),E=vn(x,!0),D=w.map(function(L,$){var H=Au(Au(Au({key:"dot-".concat($),r:3},P),E),{},{value:L.value,dataKey:A,cx:L.x,cy:L.y,index:$,payload:L.payload});return t.renderDotItem(x,H)}),V={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Oe.createElement(mi,_1({className:"recharts-line-dots",key:"dots"},V),D)}},{key:"renderCurveStatically",value:function(n,a,c,f){var i=this.props,x=i.type,w=i.layout,A=i.connectNulls;i.ref;var P=YG(i,yDe),E=Au(Au(Au({},vn(P,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(c,")"):null,points:n},f),{},{type:x,layout:w,connectNulls:A});return Oe.createElement(Hg,_1({},E,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var c=this,f=this.props,i=f.points,x=f.strokeDasharray,w=f.isAnimationActive,A=f.animationBegin,P=f.animationDuration,E=f.animationEasing,D=f.animationId,V=f.animateNewValues,L=f.width,$=f.height,H=this.state,K=H.prevPoints,Q=H.totalLength;return Oe.createElement(zu,{begin:A,duration:P,isActive:w,easing:E,from:{t:0},to:{t:1},key:"line-".concat(D),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(ae){var ee=ae.t;if(K){var se=K.length/i.length,ce=i.map(function(je,xe){var Ce=Math.floor(xe*se);if(K[Ce]){var ze=K[Ce],Te=Za(ze.x,je.x),Re=Za(ze.y,je.y);return Au(Au({},je),{},{x:Te(ee),y:Re(ee)})}if(V){var Fe=Za(L*2,je.x),He=Za($/2,je.y);return Au(Au({},je),{},{x:Fe(ee),y:He(ee)})}return Au(Au({},je),{},{x:je.x,y:je.y})});return c.renderCurveStatically(ce,n,a)}var he=Za(0,Q),Pe=he(ee),Ne;if(x){var pe="".concat(x).split(/[,\s]+/gim).map(function(je){return parseFloat(je)});Ne=c.getStrokeDasharray(Pe,Q,pe)}else Ne=c.generateSimpleStrokeDasharray(Q,Pe);return c.renderCurveStatically(i,n,a,{strokeDasharray:Ne})})}},{key:"renderCurve",value:function(n,a){var c=this.props,f=c.points,i=c.isAnimationActive,x=this.state,w=x.prevPoints,A=x.totalLength;return i&&f&&f.length&&(!w&&A>0||!Pm(w,f))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(f,n,a)}},{key:"render",value:function(){var n,a=this.props,c=a.hide,f=a.dot,i=a.points,x=a.className,w=a.xAxis,A=a.yAxis,P=a.top,E=a.left,D=a.width,V=a.height,L=a.isAnimationActive,$=a.id;if(c||!i||!i.length)return null;var H=this.state.isAnimationFinished,K=i.length===1,Q=fi("recharts-line",x),ae=w&&w.allowDataOverflow,ee=A&&A.allowDataOverflow,se=ae||ee,ce=Xn($)?this.id:$,he=(n=vn(f,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Pe=he.r,Ne=Pe===void 0?3:Pe,pe=he.strokeWidth,je=pe===void 0?2:pe,xe=uJ(f)?f:{},Ce=xe.clipDot,ze=Ce===void 0?!0:Ce,Te=Ne*2+je;return Oe.createElement(mi,{className:Q},ae||ee?Oe.createElement("defs",null,Oe.createElement("clipPath",{id:"clipPath-".concat(ce)},Oe.createElement("rect",{x:ae?E:E-D/2,y:ee?P:P-V/2,width:ae?D:D*2,height:ee?V:V*2})),!ze&&Oe.createElement("clipPath",{id:"clipPath-dots-".concat(ce)},Oe.createElement("rect",{x:E-Te/2,y:P-Te/2,width:D+Te,height:V+Te}))):null,!K&&this.renderCurve(se,ce),this.renderErrorBar(se,ce),(K||f)&&this.renderDots(se,ze,ce),(!L||H)&&Dd.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var c=n.length%2!==0?[].concat(nx(n),[0]):n,f=[],i=0;i<a;++i)f=[].concat(nx(f),nx(c));return f}},{key:"renderDotItem",value:function(n,a){var c;if(Oe.isValidElement(n))c=Oe.cloneElement(n,a);else if(qn(n))c=n(a);else{var f=a.key,i=YG(a,vDe),x=fi("recharts-line-dot",typeof n!="boolean"?n.className:"");c=Oe.createElement(p2,_1({key:f},i,{className:x}))}return c}}])}(W.PureComponent);Dh(op,"displayName","Line");Dh(op,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!fp.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Dh(op,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,c=e.yAxisTicks,f=e.dataKey,i=e.bandSize,x=e.displayedData,w=e.offset,A=t.layout,P=x.map(function(E,D){var V=Ya(E,f);return A==="horizontal"?{x:$x({axis:r,ticks:a,bandSize:i,entry:E,index:D}),y:Xn(V)?null:n.scale(V),value:V,payload:E}:{x:Xn(V)?null:r.scale(V),y:$x({axis:n,ticks:c,bandSize:i,entry:E,index:D}),value:V,payload:E}});return Au({points:P,layout:A},w)});var EDe=["layout","type","stroke","connectNulls","isRange","ref"],MDe=["key"],pte;function n_(e){"@babel/helpers - typeof";return n_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n_(e)}function mte(e,t){if(e==null)return{};var r=ODe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ODe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function k0(){return k0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k0.apply(this,arguments)}function QG(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Rg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QG(Object(r),!0).forEach(function(n){qf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QG(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yte(n.key),n)}}function IDe(e,t,r){return t&&eW(e.prototype,t),r&&eW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DDe(e,t,r){return t=iP(t),LDe(e,gte()?Reflect.construct(t,r||[],iP(e).constructor):t.apply(e,r))}function LDe(e,t){if(t&&(n_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zDe(e)}function zDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gte=function(){return!!e})()}function iP(e){return iP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iP(e)}function FDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a3(e,t)}function a3(e,t){return a3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},a3(e,t)}function qf(e,t,r){return t=yte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yte(e){var t=BDe(e,"string");return n_(t)=="symbol"?t:t+""}function BDe(e,t){if(n_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(n_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ku=function(e){function t(){var r;RDe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=DDe(this,t,[].concat(a)),qf(r,"state",{isAnimationFinished:!0}),qf(r,"id",dy("recharts-area-")),qf(r,"handleAnimationEnd",function(){var f=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),qn(f)&&f()}),qf(r,"handleAnimationStart",function(){var f=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),qn(f)&&f()}),r}return FDe(t,e),IDe(t,[{key:"renderDots",value:function(n,a,c){var f=this.props.isAnimationActive,i=this.state.isAnimationFinished;if(f&&!i)return null;var x=this.props,w=x.dot,A=x.points,P=x.dataKey,E=vn(this.props,!1),D=vn(w,!0),V=A.map(function($,H){var K=Rg(Rg(Rg({key:"dot-".concat(H),r:3},E),D),{},{index:H,cx:$.x,cy:$.y,dataKey:P,value:$.value,payload:$.payload,points:A});return t.renderDotItem(w,K)}),L={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(c,")"):null};return Oe.createElement(mi,k0({className:"recharts-area-dots"},L),V)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,c=a.baseLine,f=a.points,i=a.strokeWidth,x=f[0].x,w=f[f.length-1].x,A=n*Math.abs(x-w),P=Bg(f.map(function(E){return E.y||0}));return zr(c)&&typeof c=="number"?P=Math.max(c,P):c&&Array.isArray(c)&&c.length&&(P=Math.max(Bg(c.map(function(E){return E.y||0})),P)),zr(P)?Oe.createElement("rect",{x:x<w?x:x-A,y:0,width:A,height:Math.floor(P+(i?parseInt("".concat(i),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,c=a.baseLine,f=a.points,i=a.strokeWidth,x=f[0].y,w=f[f.length-1].y,A=n*Math.abs(x-w),P=Bg(f.map(function(E){return E.x||0}));return zr(c)&&typeof c=="number"?P=Math.max(c,P):c&&Array.isArray(c)&&c.length&&(P=Math.max(Bg(c.map(function(E){return E.x||0})),P)),zr(P)?Oe.createElement("rect",{x:0,y:x<w?x:x-A,width:P+(i?parseInt("".concat(i),10):1),height:Math.floor(A)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,c,f){var i=this.props,x=i.layout,w=i.type,A=i.stroke,P=i.connectNulls,E=i.isRange;i.ref;var D=mte(i,EDe);return Oe.createElement(mi,{clipPath:c?"url(#clipPath-".concat(f,")"):null},Oe.createElement(Hg,k0({},vn(D,!0),{points:n,connectNulls:P,type:w,baseLine:a,layout:x,stroke:"none",className:"recharts-area-area"})),A!=="none"&&Oe.createElement(Hg,k0({},vn(this.props,!1),{className:"recharts-area-curve",layout:x,type:w,connectNulls:P,fill:"none",points:n})),A!=="none"&&E&&Oe.createElement(Hg,k0({},vn(this.props,!1),{className:"recharts-area-curve",layout:x,type:w,connectNulls:P,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var c=this,f=this.props,i=f.points,x=f.baseLine,w=f.isAnimationActive,A=f.animationBegin,P=f.animationDuration,E=f.animationEasing,D=f.animationId,V=this.state,L=V.prevPoints,$=V.prevBaseLine;return Oe.createElement(zu,{begin:A,duration:P,isActive:w,easing:E,from:{t:0},to:{t:1},key:"area-".concat(D),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(H){var K=H.t;if(L){var Q=L.length/i.length,ae=i.map(function(he,Pe){var Ne=Math.floor(Pe*Q);if(L[Ne]){var pe=L[Ne],je=Za(pe.x,he.x),xe=Za(pe.y,he.y);return Rg(Rg({},he),{},{x:je(K),y:xe(K)})}return he}),ee;if(zr(x)&&typeof x=="number"){var se=Za($,x);ee=se(K)}else if(Xn(x)||k_(x)){var ce=Za($,0);ee=ce(K)}else ee=x.map(function(he,Pe){var Ne=Math.floor(Pe*Q);if($[Ne]){var pe=$[Ne],je=Za(pe.x,he.x),xe=Za(pe.y,he.y);return Rg(Rg({},he),{},{x:je(K),y:xe(K)})}return he});return c.renderAreaStatically(ae,ee,n,a)}return Oe.createElement(mi,null,Oe.createElement("defs",null,Oe.createElement("clipPath",{id:"animationClipPath-".concat(a)},c.renderClipRect(K))),Oe.createElement(mi,{clipPath:"url(#animationClipPath-".concat(a,")")},c.renderAreaStatically(i,x,n,a)))})}},{key:"renderArea",value:function(n,a){var c=this.props,f=c.points,i=c.baseLine,x=c.isAnimationActive,w=this.state,A=w.prevPoints,P=w.prevBaseLine,E=w.totalLength;return x&&f&&f.length&&(!A&&E>0||!Pm(A,f)||!Pm(P,i))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(f,i,n,a)}},{key:"render",value:function(){var n,a=this.props,c=a.hide,f=a.dot,i=a.points,x=a.className,w=a.top,A=a.left,P=a.xAxis,E=a.yAxis,D=a.width,V=a.height,L=a.isAnimationActive,$=a.id;if(c||!i||!i.length)return null;var H=this.state.isAnimationFinished,K=i.length===1,Q=fi("recharts-area",x),ae=P&&P.allowDataOverflow,ee=E&&E.allowDataOverflow,se=ae||ee,ce=Xn($)?this.id:$,he=(n=vn(f,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},Pe=he.r,Ne=Pe===void 0?3:Pe,pe=he.strokeWidth,je=pe===void 0?2:pe,xe=uJ(f)?f:{},Ce=xe.clipDot,ze=Ce===void 0?!0:Ce,Te=Ne*2+je;return Oe.createElement(mi,{className:Q},ae||ee?Oe.createElement("defs",null,Oe.createElement("clipPath",{id:"clipPath-".concat(ce)},Oe.createElement("rect",{x:ae?A:A-D/2,y:ee?w:w-V/2,width:ae?D:D*2,height:ee?V:V*2})),!ze&&Oe.createElement("clipPath",{id:"clipPath-dots-".concat(ce)},Oe.createElement("rect",{x:A-Te/2,y:w-Te/2,width:D+Te,height:V+Te}))):null,K?null:this.renderArea(se,ce),(f||K)&&this.renderDots(se,ze,ce),(!L||H)&&Dd.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(W.PureComponent);pte=ku;qf(ku,"displayName","Area");qf(ku,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!fp.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});qf(ku,"getBaseValue",function(e,t,r,n){var a=e.layout,c=e.baseValue,f=t.props.baseValue,i=f??c;if(zr(i)&&typeof i=="number")return i;var x=a==="horizontal"?n:r,w=x.scale.domain();if(x.type==="number"){var A=Math.max(w[0],w[1]),P=Math.min(w[0],w[1]);return i==="dataMin"?P:i==="dataMax"||A<0?A:Math.max(Math.min(w[0],w[1]),0)}return i==="dataMin"?w[0]:i==="dataMax"?w[1]:w[0]});qf(ku,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,c=e.xAxisTicks,f=e.yAxisTicks,i=e.bandSize,x=e.dataKey,w=e.stackedData,A=e.dataStartIndex,P=e.displayedData,E=e.offset,D=t.layout,V=w&&w.length,L=pte.getBaseValue(t,r,n,a),$=D==="horizontal",H=!1,K=P.map(function(ae,ee){var se;V?se=w[A+ee]:(se=Ya(ae,x),Array.isArray(se)?H=!0:se=[L,se]);var ce=se[1]==null||V&&Ya(ae,x)==null;return $?{x:$x({axis:n,ticks:c,bandSize:i,entry:ae,index:ee}),y:ce?null:a.scale(se[1]),value:se,payload:ae}:{x:ce?null:n.scale(se[1]),y:$x({axis:a,ticks:f,bandSize:i,entry:ae,index:ee}),value:se,payload:ae}}),Q;return V||H?Q=K.map(function(ae){var ee=Array.isArray(ae.value)?ae.value[0]:null;return $?{x:ae.x,y:ee!=null&&ae.y!=null?a.scale(ee):null}:{x:ee!=null?n.scale(ee):null,y:ae.y}}):Q=$?a.scale(L):n.scale(L),Rg({points:K,baseLine:Q,layout:D,isRange:H},E)});qf(ku,"renderDotItem",function(e,t){var r;if(Oe.isValidElement(e))r=Oe.cloneElement(e,t);else if(qn(e))r=e(t);else{var n=fi("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,c=mte(t,MDe);r=Oe.createElement(p2,k0({},c,{key:a,className:n}))}return r});function i_(e){"@babel/helpers - typeof";return i_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i_(e)}function VDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UDe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_te(n.key),n)}}function $De(e,t,r){return t&&UDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qDe(e,t,r){return t=aP(t),GDe(e,vte()?Reflect.construct(t,r||[],aP(e).constructor):t.apply(e,r))}function GDe(e,t){if(t&&(i_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WDe(e)}function WDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vte=function(){return!!e})()}function aP(e){return aP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},aP(e)}function HDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s3(e,t)}function s3(e,t){return s3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},s3(e,t)}function xte(e,t,r){return t=_te(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _te(e){var t=KDe(e,"string");return i_(t)=="symbol"?t:t+""}function KDe(e,t){if(i_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(i_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var x2=function(e){function t(){return VDe(this,t),qDe(this,t,arguments)}return HDe(t,e),$De(t,[{key:"render",value:function(){return null}}])}(Oe.Component);xte(x2,"displayName","ZAxis");xte(x2,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var ZDe=["option","isActive"];function b1(){return b1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b1.apply(this,arguments)}function YDe(e,t){if(e==null)return{};var r=XDe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function XDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function JDe(e){var t=e.option,r=e.isActive,n=YDe(e,ZDe);return typeof t=="string"?Oe.createElement(Nw,b1({option:Oe.createElement(nN,b1({type:t},n)),isActive:r,shapeType:"symbols"},n)):Oe.createElement(Nw,b1({option:t,isActive:r,shapeType:"symbols"},n))}function a_(e){"@babel/helpers - typeof";return a_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a_(e)}function w1(){return w1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w1.apply(this,arguments)}function tW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tW(Object(r),!0).forEach(function(n){Ug(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rW(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wte(n.key),n)}}function eLe(e,t,r){return t&&rW(e.prototype,t),r&&rW(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tLe(e,t,r){return t=sP(t),rLe(e,bte()?Reflect.construct(t,r||[],sP(e).constructor):t.apply(e,r))}function rLe(e,t){if(t&&(a_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nLe(e)}function nLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bte=function(){return!!e})()}function sP(e){return sP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sP(e)}function iLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o3(e,t)}function o3(e,t){return o3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},o3(e,t)}function Ug(e,t,r){return t=wte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wte(e){var t=aLe(e,"string");return a_(t)=="symbol"?t:t+""}function aLe(e,t){if(a_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(a_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var L_=function(e){function t(){var r;QDe(this,t);for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];return r=tLe(this,t,[].concat(a)),Ug(r,"state",{isAnimationFinished:!1}),Ug(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),Ug(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),Ug(r,"id",dy("recharts-scatter-")),r}return iLe(t,e),eLe(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,c=this.props,f=c.shape,i=c.activeShape,x=c.activeIndex,w=vn(this.props,!1);return n.map(function(A,P){var E=x===P,D=E?i:f,V=Cd(Cd({},w),A);return Oe.createElement(mi,w1({className:"recharts-scatter-symbol",key:"symbol-".concat(A==null?void 0:A.cx,"-").concat(A==null?void 0:A.cy,"-").concat(A==null?void 0:A.size,"-").concat(P)},ap(a.props,A,P),{role:"img"}),Oe.createElement(JDe,w1({option:D,isActive:E,key:"symbol-".concat(P)},V)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,c=a.points,f=a.isAnimationActive,i=a.animationBegin,x=a.animationDuration,w=a.animationEasing,A=a.animationId,P=this.state.prevPoints;return Oe.createElement(zu,{begin:i,duration:x,isActive:f,easing:w,from:{t:0},to:{t:1},key:"pie-".concat(A),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(E){var D=E.t,V=c.map(function(L,$){var H=P&&P[$];if(H){var K=Za(H.cx,L.cx),Q=Za(H.cy,L.cy),ae=Za(H.size,L.size);return Cd(Cd({},L),{},{cx:K(D),cy:Q(D),size:ae(D)})}var ee=Za(0,L.size);return Cd(Cd({},L),{},{size:ee(D)})});return Oe.createElement(mi,null,n.renderSymbolsStatically(V))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,c=n.isAnimationActive,f=this.state.prevPoints;return c&&a&&a.length&&(!f||!Pm(f,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,c=a.points,f=a.xAxis,i=a.yAxis,x=a.children,w=Xl(x,I_);return w?w.map(function(A,P){var E=A.props,D=E.direction,V=E.dataKey;return Oe.cloneElement(A,{key:"".concat(D,"-").concat(V,"-").concat(c[P]),data:c,xAxis:f,yAxis:i,layout:D==="x"?"vertical":"horizontal",dataPointFormatter:function($,H){return{x:$.cx,y:$.cy,value:D==="x"?+$.node.x:+$.node.y,errorVal:Ya($,H)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,c=n.line,f=n.lineType,i=n.lineJointType,x=vn(this.props,!1),w=vn(c,!1),A,P;if(f==="joint")A=a.map(function(Q){return{x:Q.cx,y:Q.cy}});else if(f==="fitting"){var E=qwe(a),D=E.xmin,V=E.xmax,L=E.a,$=E.b,H=function(ae){return L*ae+$};A=[{x:D,y:H(D)},{x:V,y:H(V)}]}var K=Cd(Cd(Cd({},x),{},{fill:"none",stroke:x&&x.fill},w),{},{points:A});return Oe.isValidElement(c)?P=Oe.cloneElement(c,K):qn(c)?P=c(K):P=Oe.createElement(Hg,w1({},K,{type:i})),Oe.createElement(mi,{className:"recharts-scatter-line",key:"recharts-scatter-line"},P)}},{key:"render",value:function(){var n=this.props,a=n.hide,c=n.points,f=n.line,i=n.className,x=n.xAxis,w=n.yAxis,A=n.left,P=n.top,E=n.width,D=n.height,V=n.id,L=n.isAnimationActive;if(a||!c||!c.length)return null;var $=this.state.isAnimationFinished,H=fi("recharts-scatter",i),K=x&&x.allowDataOverflow,Q=w&&w.allowDataOverflow,ae=K||Q,ee=Xn(V)?this.id:V;return Oe.createElement(mi,{className:H,clipPath:ae?"url(#clipPath-".concat(ee,")"):null},K||Q?Oe.createElement("defs",null,Oe.createElement("clipPath",{id:"clipPath-".concat(ee)},Oe.createElement("rect",{x:K?A:A-E/2,y:Q?P:P-D/2,width:K?E:E*2,height:Q?D:D*2}))):null,f&&this.renderLine(),this.renderErrorBar(),Oe.createElement(mi,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!L||$)&&Dd.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(W.PureComponent);Ug(L_,"displayName","Scatter");Ug(L_,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!fp.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});Ug(L_,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,c=e.displayedData,f=e.xAxisTicks,i=e.yAxisTicks,x=e.offset,w=a.props.tooltipType,A=Xl(a.props.children,Kh),P=Xn(t.dataKey)?a.props.dataKey:t.dataKey,E=Xn(r.dataKey)?a.props.dataKey:r.dataKey,D=n&&n.dataKey,V=n?n.range:x2.defaultProps.range,L=V&&V[0],$=t.scale.bandwidth?t.scale.bandwidth():0,H=r.scale.bandwidth?r.scale.bandwidth():0,K=c.map(function(Q,ae){var ee=Ya(Q,P),se=Ya(Q,E),ce=!Xn(D)&&Ya(Q,D)||"-",he=[{name:Xn(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:ee,payload:Q,dataKey:P,type:w},{name:Xn(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:se,payload:Q,dataKey:E,type:w}];ce!=="-"&&he.push({name:n.name||n.dataKey,unit:n.unit||"",value:ce,payload:Q,dataKey:D,type:w});var Pe=$x({axis:t,ticks:f,bandSize:$,entry:Q,index:ae,dataKey:P}),Ne=$x({axis:r,ticks:i,bandSize:H,entry:Q,index:ae,dataKey:E}),pe=ce!=="-"?n.scale(ce):L,je=Math.sqrt(Math.max(pe,0)/Math.PI);return Cd(Cd({},Q),{},{cx:Pe,cy:Ne,x:Pe-je,y:Ne-je,xAxis:t,yAxis:r,zAxis:n,width:2*je,height:2*je,size:pe,node:{x:ee,y:se,z:ce},tooltipPayload:he,tooltipPosition:{x:Pe,y:Ne},payload:Q},A&&A[ae]&&A[ae].props)});return Cd({points:K},x)});function s_(e){"@babel/helpers - typeof";return s_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s_(e)}function sLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tte(n.key),n)}}function lLe(e,t,r){return t&&oLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cLe(e,t,r){return t=oP(t),uLe(e,Ste()?Reflect.construct(t,r||[],oP(e).constructor):t.apply(e,r))}function uLe(e,t){if(t&&(s_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dLe(e)}function dLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ste(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ste=function(){return!!e})()}function oP(e){return oP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},oP(e)}function hLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l3(e,t)}function l3(e,t){return l3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},l3(e,t)}function Ate(e,t,r){return t=Tte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tte(e){var t=fLe(e,"string");return s_(t)=="symbol"?t:t+""}function fLe(e,t){if(s_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(s_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function c3(){return c3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c3.apply(this,arguments)}function pLe(e){var t=e.xAxisId,r=v4(),n=x4(),a=ete(t);return a==null?null:Oe.createElement(D_,c3({},a,{className:fi("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(f){return dm(f,!0)}}))}var Oa=function(e){function t(){return sLe(this,t),cLe(this,t,arguments)}return hLe(t,e),lLe(t,[{key:"render",value:function(){return Oe.createElement(pLe,this.props)}}])}(Oe.Component);Ate(Oa,"displayName","XAxis");Ate(Oa,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function o_(e){"@babel/helpers - typeof";return o_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o_(e)}function mLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jte(n.key),n)}}function yLe(e,t,r){return t&&gLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vLe(e,t,r){return t=lP(t),xLe(e,Pte()?Reflect.construct(t,r||[],lP(e).constructor):t.apply(e,r))}function xLe(e,t){if(t&&(o_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Le(e)}function _Le(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pte(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pte=function(){return!!e})()}function lP(e){return lP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lP(e)}function bLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u3(e,t)}function u3(e,t){return u3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},u3(e,t)}function Nte(e,t,r){return t=jte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jte(e){var t=wLe(e,"string");return o_(t)=="symbol"?t:t+""}function wLe(e,t){if(o_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(o_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function d3(){return d3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d3.apply(this,arguments)}var SLe=function(t){var r=t.yAxisId,n=v4(),a=x4(),c=tte(r);return c==null?null:Oe.createElement(D_,d3({},c,{className:fi("recharts-".concat(c.axisType," ").concat(c.axisType),c.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(i){return dm(i,!0)}}))},Ra=function(e){function t(){return mLe(this,t),vLe(this,t,arguments)}return bLe(t,e),yLe(t,[{key:"render",value:function(){return Oe.createElement(SLe,this.props)}}])}(Oe.Component);Nte(Ra,"displayName","YAxis");Nte(Ra,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function nW(e){return NLe(e)||PLe(e)||TLe(e)||ALe()}function ALe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TLe(e,t){if(e){if(typeof e=="string")return h3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h3(e,t)}}function PLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function NLe(e){if(Array.isArray(e))return h3(e)}function h3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f3=function(t,r,n,a,c){var f=Xl(t,b4),i=Xl(t,SN),x=[].concat(nW(f),nW(i)),w=Xl(t,TN),A="".concat(a,"Id"),P=a[0],E=r;if(x.length&&(E=x.reduce(function(L,$){if($.props[A]===n&&Jf($.props,"extendDomain")&&zr($.props[P])){var H=$.props[P];return[Math.min(L[0],H),Math.max(L[1],H)]}return L},E)),w.length){var D="".concat(P,"1"),V="".concat(P,"2");E=w.reduce(function(L,$){if($.props[A]===n&&Jf($.props,"extendDomain")&&zr($.props[D])&&zr($.props[V])){var H=$.props[D],K=$.props[V];return[Math.min(L[0],H,K),Math.max(L[1],H,K)]}return L},E)}return c&&c.length&&(E=c.reduce(function(L,$){return zr($)?[Math.min(L[0],$),Math.max(L[1],$)]:L},E)),E},CO={exports:{}},iW;function jLe(){return iW||(iW=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(x,w,A){this.fn=x,this.context=w,this.once=A||!1}function c(x,w,A,P,E){if(typeof A!="function")throw new TypeError("The listener must be a function");var D=new a(A,P||x,E),V=r?r+w:w;return x._events[V]?x._events[V].fn?x._events[V]=[x._events[V],D]:x._events[V].push(D):(x._events[V]=D,x._eventsCount++),x}function f(x,w){--x._eventsCount===0?x._events=new n:delete x._events[w]}function i(){this._events=new n,this._eventsCount=0}i.prototype.eventNames=function(){var w=[],A,P;if(this._eventsCount===0)return w;for(P in A=this._events)t.call(A,P)&&w.push(r?P.slice(1):P);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(A)):w},i.prototype.listeners=function(w){var A=r?r+w:w,P=this._events[A];if(!P)return[];if(P.fn)return[P.fn];for(var E=0,D=P.length,V=new Array(D);E<D;E++)V[E]=P[E].fn;return V},i.prototype.listenerCount=function(w){var A=r?r+w:w,P=this._events[A];return P?P.fn?1:P.length:0},i.prototype.emit=function(w,A,P,E,D,V){var L=r?r+w:w;if(!this._events[L])return!1;var $=this._events[L],H=arguments.length,K,Q;if($.fn){switch($.once&&this.removeListener(w,$.fn,void 0,!0),H){case 1:return $.fn.call($.context),!0;case 2:return $.fn.call($.context,A),!0;case 3:return $.fn.call($.context,A,P),!0;case 4:return $.fn.call($.context,A,P,E),!0;case 5:return $.fn.call($.context,A,P,E,D),!0;case 6:return $.fn.call($.context,A,P,E,D,V),!0}for(Q=1,K=new Array(H-1);Q<H;Q++)K[Q-1]=arguments[Q];$.fn.apply($.context,K)}else{var ae=$.length,ee;for(Q=0;Q<ae;Q++)switch($[Q].once&&this.removeListener(w,$[Q].fn,void 0,!0),H){case 1:$[Q].fn.call($[Q].context);break;case 2:$[Q].fn.call($[Q].context,A);break;case 3:$[Q].fn.call($[Q].context,A,P);break;case 4:$[Q].fn.call($[Q].context,A,P,E);break;default:if(!K)for(ee=1,K=new Array(H-1);ee<H;ee++)K[ee-1]=arguments[ee];$[Q].fn.apply($[Q].context,K)}}return!0},i.prototype.on=function(w,A,P){return c(this,w,A,P,!1)},i.prototype.once=function(w,A,P){return c(this,w,A,P,!0)},i.prototype.removeListener=function(w,A,P,E){var D=r?r+w:w;if(!this._events[D])return this;if(!A)return f(this,D),this;var V=this._events[D];if(V.fn)V.fn===A&&(!E||V.once)&&(!P||V.context===P)&&f(this,D);else{for(var L=0,$=[],H=V.length;L<H;L++)(V[L].fn!==A||E&&!V[L].once||P&&V[L].context!==P)&&$.push(V[L]);$.length?this._events[D]=$.length===1?$[0]:$:f(this,D)}return this},i.prototype.removeAllListeners=function(w){var A;return w?(A=r?r+w:w,this._events[A]&&f(this,A)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=r,i.EventEmitter=i,e.exports=i}(CO)),CO.exports}var CLe=jLe();const kLe=la(CLe);var kO=new kLe,EO="recharts.syncMouseEvents";function Rw(e){"@babel/helpers - typeof";return Rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rw(e)}function ELe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function MLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Cte(n.key),n)}}function OLe(e,t,r){return t&&MLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function MO(e,t,r){return t=Cte(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cte(e){var t=RLe(e,"string");return Rw(t)=="symbol"?t:t+""}function RLe(e,t){if(Rw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ILe=function(){function e(){ELe(this,e),MO(this,"activeIndex",0),MO(this,"coordinateList",[]),MO(this,"layout","horizontal")}return OLe(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,c=a===void 0?null:a,f=r.container,i=f===void 0?null:f,x=r.layout,w=x===void 0?null:x,A=r.offset,P=A===void 0?null:A,E=r.mouseHandlerCallback,D=E===void 0?null:E;this.coordinateList=(n=c??this.coordinateList)!==null&&n!==void 0?n:[],this.container=i??this.container,this.layout=w??this.layout,this.offset=P??this.offset,this.mouseHandlerCallback=D??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),c=a.x,f=a.y,i=a.height,x=this.coordinateList[this.activeIndex].coordinate,w=((r=window)===null||r===void 0?void 0:r.scrollX)||0,A=((n=window)===null||n===void 0?void 0:n.scrollY)||0,P=c+x+w,E=f+this.offset.top+i/2+A;this.mouseHandlerCallback({pageX:P,pageY:E})}}}])}();function DLe(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],a=e==null?void 0:e[1];if(n&&a&&zr(n)&&zr(a))return!0}return!1}function LLe(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function kte(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,c=e.endAngle,f=Ba(t,r,n,a),i=Ba(t,r,n,c);return{points:[f,i],cx:t,cy:r,radius:n,startAngle:a,endAngle:c}}function zLe(e,t,r){var n,a,c,f;if(e==="horizontal")n=t.x,c=n,a=r.top,f=r.top+r.height;else if(e==="vertical")a=t.y,f=a,n=r.left,c=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var i=t.cx,x=t.cy,w=t.innerRadius,A=t.outerRadius,P=t.angle,E=Ba(i,x,w,P),D=Ba(i,x,A,P);n=E.x,a=E.y,c=D.x,f=D.y}else return kte(t);return[{x:n,y:a},{x:c,y:f}]}function Iw(e){"@babel/helpers - typeof";return Iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iw(e)}function aW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function QS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aW(Object(r),!0).forEach(function(n){FLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FLe(e,t,r){return t=BLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BLe(e){var t=VLe(e,"string");return Iw(t)=="symbol"?t:t+""}function VLe(e,t){if(Iw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Iw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ULe(e){var t,r,n=e.element,a=e.tooltipEventType,c=e.isActive,f=e.activeCoordinate,i=e.activePayload,x=e.offset,w=e.activeTooltipIndex,A=e.tooltipAxisBandSize,P=e.layout,E=e.chartName,D=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!D||!c||!f||E!=="ScatterChart"&&a!=="axis")return null;var V,L=Hg;if(E==="ScatterChart")V=f,L=_Oe;else if(E==="BarChart")V=LLe(P,f,x,A),L=p4;else if(P==="radial"){var $=kte(f),H=$.cx,K=$.cy,Q=$.radius,ae=$.startAngle,ee=$.endAngle;V={cx:H,cy:K,startAngle:ae,endAngle:ee,innerRadius:Q,outerRadius:Q},L=wee}else V={points:zLe(P,f,x)},L=Hg;var se=QS(QS(QS(QS({stroke:"#ccc",pointerEvents:"none"},x),V),vn(D,!1)),{},{payload:i,payloadIndex:w,className:fi("recharts-tooltip-cursor",D.className)});return W.isValidElement(D)?W.cloneElement(D,se):W.createElement(L,se)}var $Le=["item"],qLe=["children","className","width","height","style","compact","title","desc"];function l_(e){"@babel/helpers - typeof";return l_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l_(e)}function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yx.apply(this,arguments)}function sW(e,t){return HLe(e)||WLe(e,t)||Mte(e,t)||GLe()}function GLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,c,f,i=[],x=!0,w=!1;try{if(c=(r=r.call(e)).next,t!==0)for(;!(x=(n=c.call(r)).done)&&(i.push(n.value),i.length!==t);x=!0);}catch(A){w=!0,a=A}finally{try{if(!x&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(w)throw a}}return i}}function HLe(e){if(Array.isArray(e))return e}function oW(e,t){if(e==null)return{};var r=KLe(e,t),n,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ZLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YLe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ote(n.key),n)}}function XLe(e,t,r){return t&&YLe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JLe(e,t,r){return t=cP(t),QLe(e,Ete()?Reflect.construct(t,r||[],cP(e).constructor):t.apply(e,r))}function QLe(e,t){if(t&&(l_(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return e4e(e)}function e4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ete(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ete=function(){return!!e})()}function cP(e){return cP=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cP(e)}function t4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p3(e,t)}function p3(e,t){return p3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},p3(e,t)}function c_(e){return i4e(e)||n4e(e)||Mte(e)||r4e()}function r4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mte(e,t){if(e){if(typeof e=="string")return m3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m3(e,t)}}function n4e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function i4e(e){if(Array.isArray(e))return m3(e)}function m3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lW(Object(r),!0).forEach(function(n){ri(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ri(e,t,r){return t=Ote(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ote(e){var t=a4e(e,"string");return l_(t)=="symbol"?t:t+""}function a4e(e,t){if(l_(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(l_(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s4e={xAxis:["bottom","top"],yAxis:["left","right"]},o4e={width:"100%",height:"100%"},Rte={x:0,y:0};function eA(e){return e}var l4e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},c4e=function(t,r,n,a){var c=r.find(function(A){return A&&A.index===n});if(c){if(t==="horizontal")return{x:c.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:c.coordinate};if(t==="centric"){var f=c.coordinate,i=a.radius;return pr(pr(pr({},a),Ba(a.cx,a.cy,i,f)),{},{angle:f,radius:i})}var x=c.coordinate,w=a.angle;return pr(pr(pr({},a),Ba(a.cx,a.cy,x,w)),{},{angle:w,radius:x})}return Rte},PN=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,c=r.dataEndIndex,f=(n??[]).reduce(function(i,x){var w=x.props.data;return w&&w.length?[].concat(c_(i),c_(w)):i},[]);return f.length>0?f:t&&t.length&&zr(a)&&zr(c)?t.slice(a,c+1):[]};function Ite(e){return e==="number"?[0,"auto"]:void 0}var g3=function(t,r,n,a){var c=t.graphicalItems,f=t.tooltipAxis,i=PN(r,t);return n<0||!c||!c.length||n>=i.length?null:c.reduce(function(x,w){var A,P=(A=w.props.data)!==null&&A!==void 0?A:r;P&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(P=P.slice(t.dataStartIndex,t.dataEndIndex+1));var E;if(f.dataKey&&!f.allowDuplicatedCategory){var D=P===void 0?i:P;E=oT(D,f.dataKey,a)}else E=P&&P[n]||i[n];return E?[].concat(c_(x),[f4(w,E)]):x},[])},cW=function(t,r,n,a){var c=a||{x:t.chartX,y:t.chartY},f=l4e(c,n),i=t.orderedTooltipTicks,x=t.tooltipAxis,w=t.tooltipTicks,A=ZCe(f,i,w,x);if(A>=0&&w){var P=w[A]&&w[A].value,E=g3(t,r,A,P),D=c4e(n,i,A,c);return{activeTooltipIndex:A,activeLabel:P,activePayload:E,activeCoordinate:D}}return null},u4e=function(t,r){var n=r.axes,a=r.graphicalItems,c=r.axisType,f=r.axisIdKey,i=r.stackGroups,x=r.dataStartIndex,w=r.dataEndIndex,A=t.layout,P=t.children,E=t.stackOffset,D=oee(A,c);return n.reduce(function(V,L){var $,H=L.type.defaultProps!==void 0?pr(pr({},L.type.defaultProps),L.props):L.props,K=H.type,Q=H.dataKey,ae=H.allowDataOverflow,ee=H.allowDuplicatedCategory,se=H.scale,ce=H.ticks,he=H.includeHidden,Pe=H[f];if(V[Pe])return V;var Ne=PN(t.data,{graphicalItems:a.filter(function(ot){var qe,Lt=f in ot.props?ot.props[f]:(qe=ot.type.defaultProps)===null||qe===void 0?void 0:qe[f];return Lt===Pe}),dataStartIndex:x,dataEndIndex:w}),pe=Ne.length,je,xe,Ce;DLe(H.domain,ae,K)&&(je=TI(H.domain,null,ae),D&&(K==="number"||se!=="auto")&&(Ce=g1(Ne,Q,"category")));var ze=Ite(K);if(!je||je.length===0){var Te,Re=(Te=H.domain)!==null&&Te!==void 0?Te:ze;if(Q){if(je=g1(Ne,Q,K),K==="category"&&D){var Fe=$we(je);ee&&Fe?(xe=je,je=HT(0,pe)):ee||(je=Q9(Re,je,L).reduce(function(ot,qe){return ot.indexOf(qe)>=0?ot:[].concat(c_(ot),[qe])},[]))}else if(K==="category")ee?je=je.filter(function(ot){return ot!==""&&!Xn(ot)}):je=Q9(Re,je,L).reduce(function(ot,qe){return ot.indexOf(qe)>=0||qe===""||Xn(qe)?ot:[].concat(c_(ot),[qe])},[]);else if(K==="number"){var He=eke(Ne,a.filter(function(ot){var qe,Lt,Zt=f in ot.props?ot.props[f]:(qe=ot.type.defaultProps)===null||qe===void 0?void 0:qe[f],Xt="hide"in ot.props?ot.props.hide:(Lt=ot.type.defaultProps)===null||Lt===void 0?void 0:Lt.hide;return Zt===Pe&&(he||!Xt)}),Q,c,A);He&&(je=He)}D&&(K==="number"||se!=="auto")&&(Ce=g1(Ne,Q,"category"))}else D?je=HT(0,pe):i&&i[Pe]&&i[Pe].hasStack&&K==="number"?je=E==="expand"?[0,1]:mee(i[Pe].stackGroups,x,w):je=see(Ne,a.filter(function(ot){var qe=f in ot.props?ot.props[f]:ot.type.defaultProps[f],Lt="hide"in ot.props?ot.props.hide:ot.type.defaultProps.hide;return qe===Pe&&(he||!Lt)}),K,A,!0);if(K==="number")je=f3(P,je,Pe,c,ce),Re&&(je=TI(Re,je,ae));else if(K==="category"&&Re){var mt=Re,Xe=je.every(function(ot){return mt.indexOf(ot)>=0});Xe&&(je=mt)}}return pr(pr({},V),{},ri({},Pe,pr(pr({},H),{},{axisType:c,domain:je,categoricalDomain:Ce,duplicateDomain:xe,originalDomain:($=H.domain)!==null&&$!==void 0?$:ze,isCategorical:D,layout:A})))},{})},d4e=function(t,r){var n=r.graphicalItems,a=r.Axis,c=r.axisType,f=r.axisIdKey,i=r.stackGroups,x=r.dataStartIndex,w=r.dataEndIndex,A=t.layout,P=t.children,E=PN(t.data,{graphicalItems:n,dataStartIndex:x,dataEndIndex:w}),D=E.length,V=oee(A,c),L=-1;return n.reduce(function($,H){var K=H.type.defaultProps!==void 0?pr(pr({},H.type.defaultProps),H.props):H.props,Q=K[f],ae=Ite("number");if(!$[Q]){L++;var ee;return V?ee=HT(0,D):i&&i[Q]&&i[Q].hasStack?(ee=mee(i[Q].stackGroups,x,w),ee=f3(P,ee,Q,c)):(ee=TI(ae,see(E,n.filter(function(se){var ce,he,Pe=f in se.props?se.props[f]:(ce=se.type.defaultProps)===null||ce===void 0?void 0:ce[f],Ne="hide"in se.props?se.props.hide:(he=se.type.defaultProps)===null||he===void 0?void 0:he.hide;return Pe===Q&&!Ne}),"number",A),a.defaultProps.allowDataOverflow),ee=f3(P,ee,Q,c)),pr(pr({},$),{},ri({},Q,pr(pr({axisType:c},a.defaultProps),{},{hide:!0,orientation:Iu(s4e,"".concat(c,".").concat(L%2),null),domain:ee,originalDomain:ae,isCategorical:V,layout:A})))}return $},{})},h4e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,c=r.AxisComp,f=r.graphicalItems,i=r.stackGroups,x=r.dataStartIndex,w=r.dataEndIndex,A=t.children,P="".concat(a,"Id"),E=Xl(A,c),D={};return E&&E.length?D=u4e(t,{axes:E,graphicalItems:f,axisType:a,axisIdKey:P,stackGroups:i,dataStartIndex:x,dataEndIndex:w}):f&&f.length&&(D=d4e(t,{Axis:c,graphicalItems:f,axisType:a,axisIdKey:P,stackGroups:i,dataStartIndex:x,dataEndIndex:w})),D},f4e=function(t){var r=zg(t),n=dm(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:BL(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:OT(r,n)}},uW=function(t){var r=t.children,n=t.defaultShowTooltip,a=Pu(r,Yx),c=0,f=0;return t.data&&t.data.length!==0&&(f=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(c=a.props.startIndex),a.props.endIndex>=0&&(f=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:c,dataEndIndex:f,activeTooltipIndex:-1,isTooltipActive:!!n}},p4e=function(t){return!t||!t.length?!1:t.some(function(r){var n=mm(r&&r.type);return n&&n.indexOf("Bar")>=0})},dW=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},m4e=function(t,r){var n=t.props,a=t.graphicalItems,c=t.xAxisMap,f=c===void 0?{}:c,i=t.yAxisMap,x=i===void 0?{}:i,w=n.width,A=n.height,P=n.children,E=n.margin||{},D=Pu(P,Yx),V=Pu(P,Yf),L=Object.keys(x).reduce(function(ee,se){var ce=x[se],he=ce.orientation;return!ce.mirror&&!ce.hide?pr(pr({},ee),{},ri({},he,ee[he]+ce.width)):ee},{left:E.left||0,right:E.right||0}),$=Object.keys(f).reduce(function(ee,se){var ce=f[se],he=ce.orientation;return!ce.mirror&&!ce.hide?pr(pr({},ee),{},ri({},he,Iu(ee,"".concat(he))+ce.height)):ee},{top:E.top||0,bottom:E.bottom||0}),H=pr(pr({},$),L),K=H.bottom;D&&(H.bottom+=D.props.height||Yx.defaultProps.height),V&&r&&(H=JCe(H,a,n,r));var Q=w-H.left-H.right,ae=A-H.top-H.bottom;return pr(pr({brushBottom:K},H),{},{width:Math.max(Q,0),height:Math.max(ae,0)})},g4e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},sv=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,c=a===void 0?"axis":a,f=t.validateTooltipEventTypes,i=f===void 0?["axis"]:f,x=t.axisComponents,w=t.legendContent,A=t.formatAxisMap,P=t.defaultProps,E=function(H,K){var Q=K.graphicalItems,ae=K.stackGroups,ee=K.offset,se=K.updateId,ce=K.dataStartIndex,he=K.dataEndIndex,Pe=H.barSize,Ne=H.layout,pe=H.barGap,je=H.barCategoryGap,xe=H.maxBarSize,Ce=dW(Ne),ze=Ce.numericAxisName,Te=Ce.cateAxisName,Re=p4e(Q),Fe=[];return Q.forEach(function(He,mt){var Xe=PN(H.data,{graphicalItems:[He],dataStartIndex:ce,dataEndIndex:he}),ot=He.type.defaultProps!==void 0?pr(pr({},He.type.defaultProps),He.props):He.props,qe=ot.dataKey,Lt=ot.maxBarSize,Zt=ot["".concat(ze,"Id")],Xt=ot["".concat(Te,"Id")],rr={},ir=x.reduce(function(lr,cr){var xr=K["".concat(cr.axisType,"Map")],ur=ot["".concat(cr.axisType,"Id")];xr&&xr[ur]||cr.axisType==="zAxis"||W0();var tn=xr[ur];return pr(pr({},lr),{},ri(ri({},cr.axisType,tn),"".concat(cr.axisType,"Ticks"),dm(tn)))},rr),Bt=ir[Te],De=ir["".concat(Te,"Ticks")],jr=ae&&ae[Zt]&&ae[Zt].hasStack&&ske(He,ae[Zt].stackGroups),Dt=mm(He.type).indexOf("Bar")>=0,Cr=OT(Bt,De),At=[],qr=Re&&YCe({barSize:Pe,stackGroups:ae,totalSize:g4e(ir,Te)});if(Dt){var an,Jn,tt=Xn(Lt)?xe:Lt,xt=(an=(Jn=OT(Bt,De,!0))!==null&&Jn!==void 0?Jn:tt)!==null&&an!==void 0?an:0;At=XCe({barGap:pe,barCategoryGap:je,bandSize:xt!==Cr?xt:Cr,sizeList:qr[Xt],maxBarSize:tt}),xt!==Cr&&(At=At.map(function(lr){return pr(pr({},lr),{},{position:pr(pr({},lr.position),{},{offset:lr.position.offset-xt/2})})}))}var Mt=He&&He.type&&He.type.getComposedData;Mt&&Fe.push({props:pr(pr({},Mt(pr(pr({},ir),{},{displayedData:Xe,props:H,dataKey:qe,item:He,bandSize:Cr,barPosition:At,offset:ee,stackedData:jr,layout:Ne,dataStartIndex:ce,dataEndIndex:he}))),{},ri(ri(ri({key:He.key||"item-".concat(mt)},ze,ir[ze]),Te,ir[Te]),"animationId",se)),childIndex:t2e(He,H.children),item:He})}),Fe},D=function(H,K){var Q=H.props,ae=H.dataStartIndex,ee=H.dataEndIndex,se=H.updateId;if(!m$({props:Q}))return null;var ce=Q.children,he=Q.layout,Pe=Q.stackOffset,Ne=Q.data,pe=Q.reverseStackOrder,je=dW(he),xe=je.numericAxisName,Ce=je.cateAxisName,ze=Xl(ce,n),Te=ake(Ne,ze,"".concat(xe,"Id"),"".concat(Ce,"Id"),Pe,pe),Re=x.reduce(function(ot,qe){var Lt="".concat(qe.axisType,"Map");return pr(pr({},ot),{},ri({},Lt,h4e(Q,pr(pr({},qe),{},{graphicalItems:ze,stackGroups:qe.axisType===xe&&Te,dataStartIndex:ae,dataEndIndex:ee}))))},{}),Fe=m4e(pr(pr({},Re),{},{props:Q,graphicalItems:ze}),K==null?void 0:K.legendBBox);Object.keys(Re).forEach(function(ot){Re[ot]=A(Q,Re[ot],Fe,ot.replace("Map",""),r)});var He=Re["".concat(Ce,"Map")],mt=f4e(He),Xe=E(Q,pr(pr({},Re),{},{dataStartIndex:ae,dataEndIndex:ee,updateId:se,graphicalItems:ze,stackGroups:Te,offset:Fe}));return pr(pr({formattedGraphicalItems:Xe,graphicalItems:ze,offset:Fe,stackGroups:Te},mt),Re)},V=function($){function H(K){var Q,ae,ee;return ZLe(this,H),ee=JLe(this,H,[K]),ri(ee,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),ri(ee,"accessibilityManager",new ILe),ri(ee,"handleLegendBBoxUpdate",function(se){if(se){var ce=ee.state,he=ce.dataStartIndex,Pe=ce.dataEndIndex,Ne=ce.updateId;ee.setState(pr({legendBBox:se},D({props:ee.props,dataStartIndex:he,dataEndIndex:Pe,updateId:Ne},pr(pr({},ee.state),{},{legendBBox:se}))))}}),ri(ee,"handleReceiveSyncEvent",function(se,ce,he){if(ee.props.syncId===se){if(he===ee.eventEmitterSymbol&&typeof ee.props.syncMethod!="function")return;ee.applySyncEvent(ce)}}),ri(ee,"handleBrushChange",function(se){var ce=se.startIndex,he=se.endIndex;if(ce!==ee.state.dataStartIndex||he!==ee.state.dataEndIndex){var Pe=ee.state.updateId;ee.setState(function(){return pr({dataStartIndex:ce,dataEndIndex:he},D({props:ee.props,dataStartIndex:ce,dataEndIndex:he,updateId:Pe},ee.state))}),ee.triggerSyncEvent({dataStartIndex:ce,dataEndIndex:he})}}),ri(ee,"handleMouseEnter",function(se){var ce=ee.getMouseInfo(se);if(ce){var he=pr(pr({},ce),{},{isTooltipActive:!0});ee.setState(he),ee.triggerSyncEvent(he);var Pe=ee.props.onMouseEnter;qn(Pe)&&Pe(he,se)}}),ri(ee,"triggeredAfterMouseMove",function(se){var ce=ee.getMouseInfo(se),he=ce?pr(pr({},ce),{},{isTooltipActive:!0}):{isTooltipActive:!1};ee.setState(he),ee.triggerSyncEvent(he);var Pe=ee.props.onMouseMove;qn(Pe)&&Pe(he,se)}),ri(ee,"handleItemMouseEnter",function(se){ee.setState(function(){return{isTooltipActive:!0,activeItem:se,activePayload:se.tooltipPayload,activeCoordinate:se.tooltipPosition||{x:se.cx,y:se.cy}}})}),ri(ee,"handleItemMouseLeave",function(){ee.setState(function(){return{isTooltipActive:!1}})}),ri(ee,"handleMouseMove",function(se){se.persist(),ee.throttleTriggeredAfterMouseMove(se)}),ri(ee,"handleMouseLeave",function(se){ee.throttleTriggeredAfterMouseMove.cancel();var ce={isTooltipActive:!1};ee.setState(ce),ee.triggerSyncEvent(ce);var he=ee.props.onMouseLeave;qn(he)&&he(ce,se)}),ri(ee,"handleOuterEvent",function(se){var ce=e2e(se),he=Iu(ee.props,"".concat(ce));if(ce&&qn(he)){var Pe,Ne;/.*touch.*/i.test(ce)?Ne=ee.getMouseInfo(se.changedTouches[0]):Ne=ee.getMouseInfo(se),he((Pe=Ne)!==null&&Pe!==void 0?Pe:{},se)}}),ri(ee,"handleClick",function(se){var ce=ee.getMouseInfo(se);if(ce){var he=pr(pr({},ce),{},{isTooltipActive:!0});ee.setState(he),ee.triggerSyncEvent(he);var Pe=ee.props.onClick;qn(Pe)&&Pe(he,se)}}),ri(ee,"handleMouseDown",function(se){var ce=ee.props.onMouseDown;if(qn(ce)){var he=ee.getMouseInfo(se);ce(he,se)}}),ri(ee,"handleMouseUp",function(se){var ce=ee.props.onMouseUp;if(qn(ce)){var he=ee.getMouseInfo(se);ce(he,se)}}),ri(ee,"handleTouchMove",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.throttleTriggeredAfterMouseMove(se.changedTouches[0])}),ri(ee,"handleTouchStart",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.handleMouseDown(se.changedTouches[0])}),ri(ee,"handleTouchEnd",function(se){se.changedTouches!=null&&se.changedTouches.length>0&&ee.handleMouseUp(se.changedTouches[0])}),ri(ee,"handleDoubleClick",function(se){var ce=ee.props.onDoubleClick;if(qn(ce)){var he=ee.getMouseInfo(se);ce(he,se)}}),ri(ee,"handleContextMenu",function(se){var ce=ee.props.onContextMenu;if(qn(ce)){var he=ee.getMouseInfo(se);ce(he,se)}}),ri(ee,"triggerSyncEvent",function(se){ee.props.syncId!==void 0&&kO.emit(EO,ee.props.syncId,se,ee.eventEmitterSymbol)}),ri(ee,"applySyncEvent",function(se){var ce=ee.props,he=ce.layout,Pe=ce.syncMethod,Ne=ee.state.updateId,pe=se.dataStartIndex,je=se.dataEndIndex;if(se.dataStartIndex!==void 0||se.dataEndIndex!==void 0)ee.setState(pr({dataStartIndex:pe,dataEndIndex:je},D({props:ee.props,dataStartIndex:pe,dataEndIndex:je,updateId:Ne},ee.state)));else if(se.activeTooltipIndex!==void 0){var xe=se.chartX,Ce=se.chartY,ze=se.activeTooltipIndex,Te=ee.state,Re=Te.offset,Fe=Te.tooltipTicks;if(!Re)return;if(typeof Pe=="function")ze=Pe(Fe,se);else if(Pe==="value"){ze=-1;for(var He=0;He<Fe.length;He++)if(Fe[He].value===se.activeLabel){ze=He;break}}var mt=pr(pr({},Re),{},{x:Re.left,y:Re.top}),Xe=Math.min(xe,mt.x+mt.width),ot=Math.min(Ce,mt.y+mt.height),qe=Fe[ze]&&Fe[ze].value,Lt=g3(ee.state,ee.props.data,ze),Zt=Fe[ze]?{x:he==="horizontal"?Fe[ze].coordinate:Xe,y:he==="horizontal"?ot:Fe[ze].coordinate}:Rte;ee.setState(pr(pr({},se),{},{activeLabel:qe,activeCoordinate:Zt,activePayload:Lt,activeTooltipIndex:ze}))}else ee.setState(se)}),ri(ee,"renderCursor",function(se){var ce,he=ee.state,Pe=he.isTooltipActive,Ne=he.activeCoordinate,pe=he.activePayload,je=he.offset,xe=he.activeTooltipIndex,Ce=he.tooltipAxisBandSize,ze=ee.getTooltipEventType(),Te=(ce=se.props.active)!==null&&ce!==void 0?ce:Pe,Re=ee.props.layout,Fe=se.key||"_recharts-cursor";return Oe.createElement(ULe,{key:Fe,activeCoordinate:Ne,activePayload:pe,activeTooltipIndex:xe,chartName:r,element:se,isActive:Te,layout:Re,offset:je,tooltipAxisBandSize:Ce,tooltipEventType:ze})}),ri(ee,"renderPolarAxis",function(se,ce,he){var Pe=Iu(se,"type.axisType"),Ne=Iu(ee.state,"".concat(Pe,"Map")),pe=se.type.defaultProps,je=pe!==void 0?pr(pr({},pe),se.props):se.props,xe=Ne&&Ne[je["".concat(Pe,"Id")]];return W.cloneElement(se,pr(pr({},xe),{},{className:fi(Pe,xe.className),key:se.key||"".concat(ce,"-").concat(he),ticks:dm(xe,!0)}))}),ri(ee,"renderPolarGrid",function(se){var ce=se.props,he=ce.radialLines,Pe=ce.polarAngles,Ne=ce.polarRadius,pe=ee.state,je=pe.radiusAxisMap,xe=pe.angleAxisMap,Ce=zg(je),ze=zg(xe),Te=ze.cx,Re=ze.cy,Fe=ze.innerRadius,He=ze.outerRadius;return W.cloneElement(se,{polarAngles:Array.isArray(Pe)?Pe:dm(ze,!0).map(function(mt){return mt.coordinate}),polarRadius:Array.isArray(Ne)?Ne:dm(Ce,!0).map(function(mt){return mt.coordinate}),cx:Te,cy:Re,innerRadius:Fe,outerRadius:He,key:se.key||"polar-grid",radialLines:he})}),ri(ee,"renderLegend",function(){var se=ee.state.formattedGraphicalItems,ce=ee.props,he=ce.children,Pe=ce.width,Ne=ce.height,pe=ee.props.margin||{},je=Pe-(pe.left||0)-(pe.right||0),xe=iee({children:he,formattedGraphicalItems:se,legendWidth:je,legendContent:w});if(!xe)return null;var Ce=xe.item,ze=oW(xe,$Le);return W.cloneElement(Ce,pr(pr({},ze),{},{chartWidth:Pe,chartHeight:Ne,margin:pe,onBBoxUpdate:ee.handleLegendBBoxUpdate}))}),ri(ee,"renderTooltip",function(){var se,ce=ee.props,he=ce.children,Pe=ce.accessibilityLayer,Ne=Pu(he,ta);if(!Ne)return null;var pe=ee.state,je=pe.isTooltipActive,xe=pe.activeCoordinate,Ce=pe.activePayload,ze=pe.activeLabel,Te=pe.offset,Re=(se=Ne.props.active)!==null&&se!==void 0?se:je;return W.cloneElement(Ne,{viewBox:pr(pr({},Te),{},{x:Te.left,y:Te.top}),active:Re,label:ze,payload:Re?Ce:[],coordinate:xe,accessibilityLayer:Pe})}),ri(ee,"renderBrush",function(se){var ce=ee.props,he=ce.margin,Pe=ce.data,Ne=ee.state,pe=Ne.offset,je=Ne.dataStartIndex,xe=Ne.dataEndIndex,Ce=Ne.updateId;return W.cloneElement(se,{key:se.key||"_recharts-brush",onChange:ZS(ee.handleBrushChange,se.props.onChange),data:Pe,x:zr(se.props.x)?se.props.x:pe.left,y:zr(se.props.y)?se.props.y:pe.top+pe.height+pe.brushBottom-(he.bottom||0),width:zr(se.props.width)?se.props.width:pe.width,startIndex:je,endIndex:xe,updateId:"brush-".concat(Ce)})}),ri(ee,"renderReferenceElement",function(se,ce,he){if(!se)return null;var Pe=ee,Ne=Pe.clipPathId,pe=ee.state,je=pe.xAxisMap,xe=pe.yAxisMap,Ce=pe.offset,ze=se.type.defaultProps||{},Te=se.props,Re=Te.xAxisId,Fe=Re===void 0?ze.xAxisId:Re,He=Te.yAxisId,mt=He===void 0?ze.yAxisId:He;return W.cloneElement(se,{key:se.key||"".concat(ce,"-").concat(he),xAxis:je[Fe],yAxis:xe[mt],viewBox:{x:Ce.left,y:Ce.top,width:Ce.width,height:Ce.height},clipPathId:Ne})}),ri(ee,"renderActivePoints",function(se){var ce=se.item,he=se.activePoint,Pe=se.basePoint,Ne=se.childIndex,pe=se.isRange,je=[],xe=ce.props.key,Ce=ce.item.type.defaultProps!==void 0?pr(pr({},ce.item.type.defaultProps),ce.item.props):ce.item.props,ze=Ce.activeDot,Te=Ce.dataKey,Re=pr(pr({index:Ne,dataKey:Te,cx:he.x,cy:he.y,r:4,fill:h4(ce.item),strokeWidth:2,stroke:"#fff",payload:he.payload,value:he.value},vn(ze,!1)),lT(ze));return je.push(H.renderActiveDot(ze,Re,"".concat(xe,"-activePoint-").concat(Ne))),Pe?je.push(H.renderActiveDot(ze,pr(pr({},Re),{},{cx:Pe.x,cy:Pe.y}),"".concat(xe,"-basePoint-").concat(Ne))):pe&&je.push(null),je}),ri(ee,"renderGraphicChild",function(se,ce,he){var Pe=ee.filterFormatItem(se,ce,he);if(!Pe)return null;var Ne=ee.getTooltipEventType(),pe=ee.state,je=pe.isTooltipActive,xe=pe.tooltipAxis,Ce=pe.activeTooltipIndex,ze=pe.activeLabel,Te=ee.props.children,Re=Pu(Te,ta),Fe=Pe.props,He=Fe.points,mt=Fe.isRange,Xe=Fe.baseLine,ot=Pe.item.type.defaultProps!==void 0?pr(pr({},Pe.item.type.defaultProps),Pe.item.props):Pe.item.props,qe=ot.activeDot,Lt=ot.hide,Zt=ot.activeBar,Xt=ot.activeShape,rr=!!(!Lt&&je&&Re&&(qe||Zt||Xt)),ir={};Ne!=="axis"&&Re&&Re.props.trigger==="click"?ir={onClick:ZS(ee.handleItemMouseEnter,se.props.onClick)}:Ne!=="axis"&&(ir={onMouseLeave:ZS(ee.handleItemMouseLeave,se.props.onMouseLeave),onMouseEnter:ZS(ee.handleItemMouseEnter,se.props.onMouseEnter)});var Bt=W.cloneElement(se,pr(pr({},Pe.props),ir));function De(cr){return typeof xe.dataKey=="function"?xe.dataKey(cr.payload):null}if(rr)if(Ce>=0){var jr,Dt;if(xe.dataKey&&!xe.allowDuplicatedCategory){var Cr=typeof xe.dataKey=="function"?De:"payload.".concat(xe.dataKey.toString());jr=oT(He,Cr,ze),Dt=mt&&Xe&&oT(Xe,Cr,ze)}else jr=He==null?void 0:He[Ce],Dt=mt&&Xe&&Xe[Ce];if(Xt||Zt){var At=se.props.activeIndex!==void 0?se.props.activeIndex:Ce;return[W.cloneElement(se,pr(pr(pr({},Pe.props),ir),{},{activeIndex:At})),null,null]}if(!Xn(jr))return[Bt].concat(c_(ee.renderActivePoints({item:Pe,activePoint:jr,basePoint:Dt,childIndex:Ce,isRange:mt})))}else{var qr,an=(qr=ee.getItemByXY(ee.state.activeCoordinate))!==null&&qr!==void 0?qr:{graphicalItem:Bt},Jn=an.graphicalItem,tt=Jn.item,xt=tt===void 0?se:tt,Mt=Jn.childIndex,lr=pr(pr(pr({},Pe.props),ir),{},{activeIndex:Mt});return[W.cloneElement(xt,lr),null,null]}return mt?[Bt,null,null]:[Bt,null]}),ri(ee,"renderCustomized",function(se,ce,he){return W.cloneElement(se,pr(pr({key:"recharts-customized-".concat(he)},ee.props),ee.state))}),ri(ee,"renderMap",{CartesianGrid:{handler:eA,once:!0},ReferenceArea:{handler:ee.renderReferenceElement},ReferenceLine:{handler:eA},ReferenceDot:{handler:ee.renderReferenceElement},XAxis:{handler:eA},YAxis:{handler:eA},Brush:{handler:ee.renderBrush,once:!0},Bar:{handler:ee.renderGraphicChild},Line:{handler:ee.renderGraphicChild},Area:{handler:ee.renderGraphicChild},Radar:{handler:ee.renderGraphicChild},RadialBar:{handler:ee.renderGraphicChild},Scatter:{handler:ee.renderGraphicChild},Pie:{handler:ee.renderGraphicChild},Funnel:{handler:ee.renderGraphicChild},Tooltip:{handler:ee.renderCursor,once:!0},PolarGrid:{handler:ee.renderPolarGrid,once:!0},PolarAngleAxis:{handler:ee.renderPolarAxis},PolarRadiusAxis:{handler:ee.renderPolarAxis},Customized:{handler:ee.renderCustomized}}),ee.clipPathId="".concat((Q=K.id)!==null&&Q!==void 0?Q:dy("recharts"),"-clip"),ee.throttleTriggeredAfterMouseMove=nQ(ee.triggeredAfterMouseMove,(ae=K.throttleDelay)!==null&&ae!==void 0?ae:1e3/60),ee.state={},ee}return t4e(H,$),XLe(H,[{key:"componentDidMount",value:function(){var Q,ae;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(Q=this.props.margin.left)!==null&&Q!==void 0?Q:0,top:(ae=this.props.margin.top)!==null&&ae!==void 0?ae:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var Q=this.props,ae=Q.children,ee=Q.data,se=Q.height,ce=Q.layout,he=Pu(ae,ta);if(he){var Pe=he.props.defaultIndex;if(!(typeof Pe!="number"||Pe<0||Pe>this.state.tooltipTicks.length-1)){var Ne=this.state.tooltipTicks[Pe]&&this.state.tooltipTicks[Pe].value,pe=g3(this.state,ee,Pe,Ne),je=this.state.tooltipTicks[Pe].coordinate,xe=(this.state.offset.top+se)/2,Ce=ce==="horizontal",ze=Ce?{x:je,y:xe}:{y:je,x:xe},Te=this.state.formattedGraphicalItems.find(function(Fe){var He=Fe.item;return He.type.name==="Scatter"});Te&&(ze=pr(pr({},ze),Te.props.points[Pe].tooltipPosition),pe=Te.props.points[Pe].tooltipPayload);var Re={activeTooltipIndex:Pe,isTooltipActive:!0,activeLabel:Ne,activePayload:pe,activeCoordinate:ze};this.setState(Re),this.renderCursor(he),this.accessibilityManager.setIndex(Pe)}}}},{key:"getSnapshotBeforeUpdate",value:function(Q,ae){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==ae.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==Q.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==Q.margin){var ee,se;this.accessibilityManager.setDetails({offset:{left:(ee=this.props.margin.left)!==null&&ee!==void 0?ee:0,top:(se=this.props.margin.top)!==null&&se!==void 0?se:0}})}return null}},{key:"componentDidUpdate",value:function(Q){HR([Pu(Q.children,ta)],[Pu(this.props.children,ta)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var Q=Pu(this.props.children,ta);if(Q&&typeof Q.props.shared=="boolean"){var ae=Q.props.shared?"axis":"item";return i.indexOf(ae)>=0?ae:c}return c}},{key:"getMouseInfo",value:function(Q){if(!this.container)return null;var ae=this.container,ee=ae.getBoundingClientRect(),se=VTe(ee),ce={chartX:Math.round(Q.pageX-se.left),chartY:Math.round(Q.pageY-se.top)},he=ee.width/ae.offsetWidth||1,Pe=this.inRange(ce.chartX,ce.chartY,he);if(!Pe)return null;var Ne=this.state,pe=Ne.xAxisMap,je=Ne.yAxisMap,xe=this.getTooltipEventType();if(xe!=="axis"&&pe&&je){var Ce=zg(pe).scale,ze=zg(je).scale,Te=Ce&&Ce.invert?Ce.invert(ce.chartX):null,Re=ze&&ze.invert?ze.invert(ce.chartY):null;return pr(pr({},ce),{},{xValue:Te,yValue:Re})}var Fe=cW(this.state,this.props.data,this.props.layout,Pe);return Fe?pr(pr({},ce),Fe):null}},{key:"inRange",value:function(Q,ae){var ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=this.props.layout,ce=Q/ee,he=ae/ee;if(se==="horizontal"||se==="vertical"){var Pe=this.state.offset,Ne=ce>=Pe.left&&ce<=Pe.left+Pe.width&&he>=Pe.top&&he<=Pe.top+Pe.height;return Ne?{x:ce,y:he}:null}var pe=this.state,je=pe.angleAxisMap,xe=pe.radiusAxisMap;if(je&&xe){var Ce=zg(je);return rq({x:ce,y:he},Ce)}return null}},{key:"parseEventsOfWrapper",value:function(){var Q=this.props.children,ae=this.getTooltipEventType(),ee=Pu(Q,ta),se={};ee&&ae==="axis"&&(ee.props.trigger==="click"?se={onClick:this.handleClick}:se={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var ce=lT(this.props,this.handleOuterEvent);return pr(pr({},ce),se)}},{key:"addListener",value:function(){kO.on(EO,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){kO.removeListener(EO,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(Q,ae,ee){for(var se=this.state.formattedGraphicalItems,ce=0,he=se.length;ce<he;ce++){var Pe=se[ce];if(Pe.item===Q||Pe.props.key===Q.key||ae===mm(Pe.item.type)&&ee===Pe.childIndex)return Pe}return null}},{key:"renderClipPath",value:function(){var Q=this.clipPathId,ae=this.state.offset,ee=ae.left,se=ae.top,ce=ae.height,he=ae.width;return Oe.createElement("defs",null,Oe.createElement("clipPath",{id:Q},Oe.createElement("rect",{x:ee,y:se,height:ce,width:he})))}},{key:"getXScales",value:function(){var Q=this.state.xAxisMap;return Q?Object.entries(Q).reduce(function(ae,ee){var se=sW(ee,2),ce=se[0],he=se[1];return pr(pr({},ae),{},ri({},ce,he.scale))},{}):null}},{key:"getYScales",value:function(){var Q=this.state.yAxisMap;return Q?Object.entries(Q).reduce(function(ae,ee){var se=sW(ee,2),ce=se[0],he=se[1];return pr(pr({},ae),{},ri({},ce,he.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(Q){var ae;return(ae=this.state.xAxisMap)===null||ae===void 0||(ae=ae[Q])===null||ae===void 0?void 0:ae.scale}},{key:"getYScaleByAxisId",value:function(Q){var ae;return(ae=this.state.yAxisMap)===null||ae===void 0||(ae=ae[Q])===null||ae===void 0?void 0:ae.scale}},{key:"getItemByXY",value:function(Q){var ae=this.state,ee=ae.formattedGraphicalItems,se=ae.activeItem;if(ee&&ee.length)for(var ce=0,he=ee.length;ce<he;ce++){var Pe=ee[ce],Ne=Pe.props,pe=Pe.item,je=pe.type.defaultProps!==void 0?pr(pr({},pe.type.defaultProps),pe.props):pe.props,xe=mm(pe.type);if(xe==="Bar"){var Ce=(Ne.data||[]).find(function(Fe){return eOe(Q,Fe)});if(Ce)return{graphicalItem:Pe,payload:Ce}}else if(xe==="RadialBar"){var ze=(Ne.data||[]).find(function(Fe){return rq(Q,Fe)});if(ze)return{graphicalItem:Pe,payload:ze}}else if(xN(Pe,se)||_N(Pe,se)||jw(Pe,se)){var Te=ARe({graphicalItem:Pe,activeTooltipItem:se,itemData:je.data}),Re=je.activeIndex===void 0?Te:je.activeIndex;return{graphicalItem:pr(pr({},Pe),{},{childIndex:Re}),payload:jw(Pe,se)?je.data[Te]:Pe.props.data[Te]}}}return null}},{key:"render",value:function(){var Q=this;if(!m$(this))return null;var ae=this.props,ee=ae.children,se=ae.className,ce=ae.width,he=ae.height,Pe=ae.style,Ne=ae.compact,pe=ae.title,je=ae.desc,xe=oW(ae,qLe),Ce=vn(xe,!1);if(Ne)return Oe.createElement(LG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Oe.createElement(ZR,yx({},Ce,{width:ce,height:he,title:pe,desc:je}),this.renderClipPath(),y$(ee,this.renderMap)));if(this.props.accessibilityLayer){var ze,Te;Ce.tabIndex=(ze=this.props.tabIndex)!==null&&ze!==void 0?ze:0,Ce.role=(Te=this.props.role)!==null&&Te!==void 0?Te:"application",Ce.onKeyDown=function(Fe){Q.accessibilityManager.keyboardEvent(Fe)},Ce.onFocus=function(){Q.accessibilityManager.focus()}}var Re=this.parseEventsOfWrapper();return Oe.createElement(LG,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Oe.createElement("div",yx({className:fi("recharts-wrapper",se),style:pr({position:"relative",cursor:"default",width:ce,height:he},Pe)},Re,{ref:function(He){Q.container=He}}),Oe.createElement(ZR,yx({},Ce,{width:ce,height:he,title:pe,desc:je,style:o4e}),this.renderClipPath(),y$(ee,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(W.Component);ri(V,"displayName",r),ri(V,"defaultProps",pr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},P)),ri(V,"getDerivedStateFromProps",function($,H){var K=$.dataKey,Q=$.data,ae=$.children,ee=$.width,se=$.height,ce=$.layout,he=$.stackOffset,Pe=$.margin,Ne=H.dataStartIndex,pe=H.dataEndIndex;if(H.updateId===void 0){var je=uW($);return pr(pr(pr({},je),{},{updateId:0},D(pr(pr({props:$},je),{},{updateId:0}),H)),{},{prevDataKey:K,prevData:Q,prevWidth:ee,prevHeight:se,prevLayout:ce,prevStackOffset:he,prevMargin:Pe,prevChildren:ae})}if(K!==H.prevDataKey||Q!==H.prevData||ee!==H.prevWidth||se!==H.prevHeight||ce!==H.prevLayout||he!==H.prevStackOffset||!wx(Pe,H.prevMargin)){var xe=uW($),Ce={chartX:H.chartX,chartY:H.chartY,isTooltipActive:H.isTooltipActive},ze=pr(pr({},cW(H,Q,ce)),{},{updateId:H.updateId+1}),Te=pr(pr(pr({},xe),Ce),ze);return pr(pr(pr({},Te),D(pr({props:$},Te),H)),{},{prevDataKey:K,prevData:Q,prevWidth:ee,prevHeight:se,prevLayout:ce,prevStackOffset:he,prevMargin:Pe,prevChildren:ae})}if(!HR(ae,H.prevChildren)){var Re,Fe,He,mt,Xe=Pu(ae,Yx),ot=Xe&&(Re=(Fe=Xe.props)===null||Fe===void 0?void 0:Fe.startIndex)!==null&&Re!==void 0?Re:Ne,qe=Xe&&(He=(mt=Xe.props)===null||mt===void 0?void 0:mt.endIndex)!==null&&He!==void 0?He:pe,Lt=ot!==Ne||qe!==pe,Zt=!Xn(Q),Xt=Zt&&!Lt?H.updateId:H.updateId+1;return pr(pr({updateId:Xt},D(pr(pr({props:$},H),{},{updateId:Xt,dataStartIndex:ot,dataEndIndex:qe}),H)),{},{prevChildren:ae,dataStartIndex:ot,dataEndIndex:qe})}return null}),ri(V,"renderActiveDot",function($,H,K){var Q;return W.isValidElement($)?Q=W.cloneElement($,H):qn($)?Q=$(H):Q=Oe.createElement(p2,H),Oe.createElement(mi,{className:"recharts-active-dot",key:K},Q)});var L=W.forwardRef(function(H,K){return Oe.createElement(V,yx({},H,{ref:K}))});return L.displayName=V.displayName,L},A4=sv({chartName:"LineChart",GraphicalChild:op,axisComponents:[{axisType:"xAxis",AxisComp:Oa},{axisType:"yAxis",AxisComp:Ra}],formatAxisMap:v2}),Cu=sv({chartName:"BarChart",GraphicalChild:ds,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Oa},{axisType:"yAxis",AxisComp:Ra}],formatAxisMap:v2}),Dte=sv({chartName:"PieChart",GraphicalChild:pp,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:g2},{axisType:"radiusAxis",AxisComp:m2}],formatAxisMap:vee,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),y4e=sv({chartName:"ScatterChart",GraphicalChild:L_,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:Oa},{axisType:"yAxis",AxisComp:Ra},{axisType:"zAxis",AxisComp:x2}],formatAxisMap:v2}),v4e=sv({chartName:"AreaChart",GraphicalChild:ku,axisComponents:[{axisType:"xAxis",AxisComp:Oa},{axisType:"yAxis",AxisComp:Ra}],formatAxisMap:v2}),x4e=sv({chartName:"RadialBarChart",GraphicalChild:y2,legendContent:"children",defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"angleAxis",AxisComp:g2},{axisType:"radiusAxis",AxisComp:m2}],formatAxisMap:vee,defaultProps:{layout:"radial",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),T4=sv({chartName:"ComposedChart",GraphicalChild:[op,ku,ds,L_],axisComponents:[{axisType:"xAxis",AxisComp:Oa},{axisType:"yAxis",AxisComp:Ra},{axisType:"zAxis",AxisComp:x2}],formatAxisMap:v2});function hW(e,[t,r]){return Math.min(r,Math.max(t,e))}function _4e(e){const t=W.useRef({value:e,previous:e});return W.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var b4e="VisuallyHidden",P4=W.forwardRef((e,t)=>l.jsx(vi.span,{...e,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}));P4.displayName=b4e;var w4e=P4,S4e=[" ","Enter","ArrowUp","ArrowDown"],A4e=[" ","Enter"],_2="Select",[NN,jN,T4e]=rD(_2),[z_,g$e]=Vd(_2,[T4e,ly]),CN=ly(),[P4e,my]=z_(_2),[N4e,j4e]=z_(_2),Lte=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:c,value:f,defaultValue:i,onValueChange:x,dir:w,name:A,autoComplete:P,disabled:E,required:D,form:V}=e,L=CN(t),[$,H]=W.useState(null),[K,Q]=W.useState(null),[ae,ee]=W.useState(!1),se=nD(w),[ce=!1,he]=Kg({prop:n,defaultProp:a,onChange:c}),[Pe,Ne]=Kg({prop:f,defaultProp:i,onChange:x}),pe=W.useRef(null),je=$?V||!!$.closest("form"):!0,[xe,Ce]=W.useState(new Set),ze=Array.from(xe).map(Te=>Te.props.value).join(";");return l.jsx(AP,{...L,children:l.jsxs(P4e,{required:D,scope:t,trigger:$,onTriggerChange:H,valueNode:K,onValueNodeChange:Q,valueNodeHasChildren:ae,onValueNodeHasChildrenChange:ee,contentId:Rd(),value:Pe,onValueChange:Ne,open:ce,onOpenChange:he,dir:se,triggerPointerDownPosRef:pe,disabled:E,children:[l.jsx(NN.Provider,{scope:t,children:l.jsx(N4e,{scope:e.__scopeSelect,onNativeOptionAdd:W.useCallback(Te=>{Ce(Re=>new Set(Re).add(Te))},[]),onNativeOptionRemove:W.useCallback(Te=>{Ce(Re=>{const Fe=new Set(Re);return Fe.delete(Te),Fe})},[]),children:r})}),je?l.jsxs(cre,{"aria-hidden":!0,required:D,tabIndex:-1,name:A,autoComplete:P,value:Pe,onChange:Te=>Ne(Te.target.value),disabled:E,form:V,children:[Pe===void 0?l.jsx("option",{value:""}):null,Array.from(xe)]},ze):null]})})};Lte.displayName=_2;var zte="SelectTrigger",Fte=W.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,c=CN(r),f=my(zte,r),i=f.disabled||n,x=Ji(t,f.onTriggerChange),w=jN(r),A=W.useRef("touch"),[P,E,D]=ure(L=>{const $=w().filter(Q=>!Q.disabled),H=$.find(Q=>Q.value===f.value),K=dre($,L,H);K!==void 0&&f.onValueChange(K.value)}),V=L=>{i||(f.onOpenChange(!0),D()),L&&(f.triggerPointerDownPosRef.current={x:Math.round(L.pageX),y:Math.round(L.pageY)})};return l.jsx(Gw,{asChild:!0,...c,children:l.jsx(vi.button,{type:"button",role:"combobox","aria-controls":f.contentId,"aria-expanded":f.open,"aria-required":f.required,"aria-autocomplete":"none",dir:f.dir,"data-state":f.open?"open":"closed",disabled:i,"data-disabled":i?"":void 0,"data-placeholder":lre(f.value)?"":void 0,...a,ref:x,onClick:ln(a.onClick,L=>{L.currentTarget.focus(),A.current!=="mouse"&&V(L)}),onPointerDown:ln(a.onPointerDown,L=>{A.current=L.pointerType;const $=L.target;$.hasPointerCapture(L.pointerId)&&$.releasePointerCapture(L.pointerId),L.button===0&&L.ctrlKey===!1&&L.pointerType==="mouse"&&(V(L),L.preventDefault())}),onKeyDown:ln(a.onKeyDown,L=>{const $=P.current!=="";!(L.ctrlKey||L.altKey||L.metaKey)&&L.key.length===1&&E(L.key),!($&&L.key===" ")&&S4e.includes(L.key)&&(V(),L.preventDefault())})})})});Fte.displayName=zte;var Bte="SelectValue",Vte=W.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:c,placeholder:f="",...i}=e,x=my(Bte,r),{onValueNodeHasChildrenChange:w}=x,A=c!==void 0,P=Ji(t,x.onValueNodeChange);return dl(()=>{w(A)},[w,A]),l.jsx(vi.span,{...i,ref:P,style:{pointerEvents:"none"},children:lre(x.value)?l.jsx(l.Fragment,{children:f}):c})});Vte.displayName=Bte;var C4e="SelectIcon",Ute=W.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return l.jsx(vi.span,{"aria-hidden":!0,...a,ref:t,children:n||"▼"})});Ute.displayName=C4e;var k4e="SelectPortal",$te=e=>l.jsx(w_,{asChild:!0,...e});$te.displayName=k4e;var K0="SelectContent",qte=W.forwardRef((e,t)=>{const r=my(K0,e.__scopeSelect),[n,a]=W.useState();if(dl(()=>{a(new DocumentFragment)},[]),!r.open){const c=n;return c?zw.createPortal(l.jsx(Gte,{scope:e.__scopeSelect,children:l.jsx(NN.Slot,{scope:e.__scopeSelect,children:l.jsx("div",{children:e.children})})}),c):null}return l.jsx(Wte,{...e,ref:t})});qte.displayName=K0;var Rh=10,[Gte,gy]=z_(K0),E4e="SelectContentImpl",Wte=W.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:c,onPointerDownOutside:f,side:i,sideOffset:x,align:w,alignOffset:A,arrowPadding:P,collisionBoundary:E,collisionPadding:D,sticky:V,hideWhenDetached:L,avoidCollisions:$,...H}=e,K=my(K0,r),[Q,ae]=W.useState(null),[ee,se]=W.useState(null),ce=Ji(t,rr=>ae(rr)),[he,Pe]=W.useState(null),[Ne,pe]=W.useState(null),je=jN(r),[xe,Ce]=W.useState(!1),ze=W.useRef(!1);W.useEffect(()=>{if(Q)return jP(Q)},[Q]),_P();const Te=W.useCallback(rr=>{const[ir,...Bt]=je().map(Dt=>Dt.ref.current),[De]=Bt.slice(-1),jr=document.activeElement;for(const Dt of rr)if(Dt===jr||(Dt==null||Dt.scrollIntoView({block:"nearest"}),Dt===ir&&ee&&(ee.scrollTop=0),Dt===De&&ee&&(ee.scrollTop=ee.scrollHeight),Dt==null||Dt.focus(),document.activeElement!==jr))return},[je,ee]),Re=W.useCallback(()=>Te([he,Q]),[Te,he,Q]);W.useEffect(()=>{xe&&Re()},[xe,Re]);const{onOpenChange:Fe,triggerPointerDownPosRef:He}=K;W.useEffect(()=>{if(Q){let rr={x:0,y:0};const ir=De=>{var jr,Dt;rr={x:Math.abs(Math.round(De.pageX)-(((jr=He.current)==null?void 0:jr.x)??0)),y:Math.abs(Math.round(De.pageY)-(((Dt=He.current)==null?void 0:Dt.y)??0))}},Bt=De=>{rr.x<=10&&rr.y<=10?De.preventDefault():Q.contains(De.target)||Fe(!1),document.removeEventListener("pointermove",ir),He.current=null};return He.current!==null&&(document.addEventListener("pointermove",ir),document.addEventListener("pointerup",Bt,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ir),document.removeEventListener("pointerup",Bt,{capture:!0})}}},[Q,Fe,He]),W.useEffect(()=>{const rr=()=>Fe(!1);return window.addEventListener("blur",rr),window.addEventListener("resize",rr),()=>{window.removeEventListener("blur",rr),window.removeEventListener("resize",rr)}},[Fe]);const[mt,Xe]=ure(rr=>{const ir=je().filter(jr=>!jr.disabled),Bt=ir.find(jr=>jr.ref.current===document.activeElement),De=dre(ir,rr,Bt);De&&setTimeout(()=>De.ref.current.focus())}),ot=W.useCallback((rr,ir,Bt)=>{const De=!ze.current&&!Bt;(K.value!==void 0&&K.value===ir||De)&&(Pe(rr),De&&(ze.current=!0))},[K.value]),qe=W.useCallback(()=>Q==null?void 0:Q.focus(),[Q]),Lt=W.useCallback((rr,ir,Bt)=>{const De=!ze.current&&!Bt;(K.value!==void 0&&K.value===ir||De)&&pe(rr)},[K.value]),Zt=n==="popper"?y3:Hte,Xt=Zt===y3?{side:i,sideOffset:x,align:w,alignOffset:A,arrowPadding:P,collisionBoundary:E,collisionPadding:D,sticky:V,hideWhenDetached:L,avoidCollisions:$}:{};return l.jsx(Gte,{scope:r,content:Q,viewport:ee,onViewportChange:se,itemRefCallback:ot,selectedItem:he,onItemLeave:qe,itemTextRefCallback:Lt,focusSelectedItem:Re,selectedItemText:Ne,position:n,isPositioned:xe,searchRef:mt,children:l.jsx(Ww,{as:Ql,allowPinchZoom:!0,children:l.jsx($w,{asChild:!0,trapped:K.open,onMountAutoFocus:rr=>{rr.preventDefault()},onUnmountAutoFocus:ln(a,rr=>{var ir;(ir=K.trigger)==null||ir.focus({preventScroll:!0}),rr.preventDefault()}),children:l.jsx(x_,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:rr=>rr.preventDefault(),onDismiss:()=>K.onOpenChange(!1),children:l.jsx(Zt,{role:"listbox",id:K.contentId,"data-state":K.open?"open":"closed",dir:K.dir,onContextMenu:rr=>rr.preventDefault(),...H,...Xt,onPlaced:()=>Ce(!0),ref:ce,style:{display:"flex",flexDirection:"column",outline:"none",...H.style},onKeyDown:ln(H.onKeyDown,rr=>{const ir=rr.ctrlKey||rr.altKey||rr.metaKey;if(rr.key==="Tab"&&rr.preventDefault(),!ir&&rr.key.length===1&&Xe(rr.key),["ArrowUp","ArrowDown","Home","End"].includes(rr.key)){let De=je().filter(jr=>!jr.disabled).map(jr=>jr.ref.current);if(["ArrowUp","End"].includes(rr.key)&&(De=De.slice().reverse()),["ArrowUp","ArrowDown"].includes(rr.key)){const jr=rr.target,Dt=De.indexOf(jr);De=De.slice(Dt+1)}setTimeout(()=>Te(De)),rr.preventDefault()}})})})})})})});Wte.displayName=E4e;var M4e="SelectItemAlignedPosition",Hte=W.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,c=my(K0,r),f=gy(K0,r),[i,x]=W.useState(null),[w,A]=W.useState(null),P=Ji(t,ce=>A(ce)),E=jN(r),D=W.useRef(!1),V=W.useRef(!0),{viewport:L,selectedItem:$,selectedItemText:H,focusSelectedItem:K}=f,Q=W.useCallback(()=>{if(c.trigger&&c.valueNode&&i&&w&&L&&$&&H){const ce=c.trigger.getBoundingClientRect(),he=w.getBoundingClientRect(),Pe=c.valueNode.getBoundingClientRect(),Ne=H.getBoundingClientRect();if(c.dir!=="rtl"){const jr=Ne.left-he.left,Dt=Pe.left-jr,Cr=ce.left-Dt,At=ce.width+Cr,qr=Math.max(At,he.width),an=window.innerWidth-Rh,Jn=hW(Dt,[Rh,Math.max(Rh,an-qr)]);i.style.minWidth=At+"px",i.style.left=Jn+"px"}else{const jr=he.right-Ne.right,Dt=window.innerWidth-Pe.right-jr,Cr=window.innerWidth-ce.right-Dt,At=ce.width+Cr,qr=Math.max(At,he.width),an=window.innerWidth-Rh,Jn=hW(Dt,[Rh,Math.max(Rh,an-qr)]);i.style.minWidth=At+"px",i.style.right=Jn+"px"}const pe=E(),je=window.innerHeight-Rh*2,xe=L.scrollHeight,Ce=window.getComputedStyle(w),ze=parseInt(Ce.borderTopWidth,10),Te=parseInt(Ce.paddingTop,10),Re=parseInt(Ce.borderBottomWidth,10),Fe=parseInt(Ce.paddingBottom,10),He=ze+Te+xe+Fe+Re,mt=Math.min($.offsetHeight*5,He),Xe=window.getComputedStyle(L),ot=parseInt(Xe.paddingTop,10),qe=parseInt(Xe.paddingBottom,10),Lt=ce.top+ce.height/2-Rh,Zt=je-Lt,Xt=$.offsetHeight/2,rr=$.offsetTop+Xt,ir=ze+Te+rr,Bt=He-ir;if(ir<=Lt){const jr=pe.length>0&&$===pe[pe.length-1].ref.current;i.style.bottom="0px";const Dt=w.clientHeight-L.offsetTop-L.offsetHeight,Cr=Math.max(Zt,Xt+(jr?qe:0)+Dt+Re),At=ir+Cr;i.style.height=At+"px"}else{const jr=pe.length>0&&$===pe[0].ref.current;i.style.top="0px";const Cr=Math.max(Lt,ze+L.offsetTop+(jr?ot:0)+Xt)+Bt;i.style.height=Cr+"px",L.scrollTop=ir-Lt+L.offsetTop}i.style.margin=`${Rh}px 0`,i.style.minHeight=mt+"px",i.style.maxHeight=je+"px",n==null||n(),requestAnimationFrame(()=>D.current=!0)}},[E,c.trigger,c.valueNode,i,w,L,$,H,c.dir,n]);dl(()=>Q(),[Q]);const[ae,ee]=W.useState();dl(()=>{w&&ee(window.getComputedStyle(w).zIndex)},[w]);const se=W.useCallback(ce=>{ce&&V.current===!0&&(Q(),K==null||K(),V.current=!1)},[Q,K]);return l.jsx(R4e,{scope:r,contentWrapper:i,shouldExpandOnScrollRef:D,onScrollButtonChange:se,children:l.jsx("div",{ref:x,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ae},children:l.jsx(vi.div,{...a,ref:P,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Hte.displayName=M4e;var O4e="SelectPopperPosition",y3=W.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Rh,...c}=e,f=CN(r);return l.jsx(TP,{...f,...c,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...c.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});y3.displayName=O4e;var[R4e,N4]=z_(K0,{}),v3="SelectViewport",Kte=W.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,c=gy(v3,r),f=N4(v3,r),i=Ji(t,c.onViewportChange),x=W.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),l.jsx(NN.Slot,{scope:r,children:l.jsx(vi.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:i,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ln(a.onScroll,w=>{const A=w.currentTarget,{contentWrapper:P,shouldExpandOnScrollRef:E}=f;if(E!=null&&E.current&&P){const D=Math.abs(x.current-A.scrollTop);if(D>0){const V=window.innerHeight-Rh*2,L=parseFloat(P.style.minHeight),$=parseFloat(P.style.height),H=Math.max(L,$);if(H<V){const K=H+D,Q=Math.min(V,K),ae=K-Q;P.style.height=Q+"px",P.style.bottom==="0px"&&(A.scrollTop=ae>0?ae:0,P.style.justifyContent="flex-end")}}}x.current=A.scrollTop})})})]})});Kte.displayName=v3;var Zte="SelectGroup",[I4e,D4e]=z_(Zte),Yte=W.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Rd();return l.jsx(I4e,{scope:r,id:a,children:l.jsx(vi.div,{role:"group","aria-labelledby":a,...n,ref:t})})});Yte.displayName=Zte;var Xte="SelectLabel",Jte=W.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=D4e(Xte,r);return l.jsx(vi.div,{id:a.id,...n,ref:t})});Jte.displayName=Xte;var uP="SelectItem",[L4e,Qte]=z_(uP),ere=W.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:c,...f}=e,i=my(uP,r),x=gy(uP,r),w=i.value===n,[A,P]=W.useState(c??""),[E,D]=W.useState(!1),V=Ji(t,K=>{var Q;return(Q=x.itemRefCallback)==null?void 0:Q.call(x,K,n,a)}),L=Rd(),$=W.useRef("touch"),H=()=>{a||(i.onValueChange(n),i.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(L4e,{scope:r,value:n,disabled:a,textId:L,isSelected:w,onItemTextChange:W.useCallback(K=>{P(Q=>Q||((K==null?void 0:K.textContent)??"").trim())},[]),children:l.jsx(NN.ItemSlot,{scope:r,value:n,disabled:a,textValue:A,children:l.jsx(vi.div,{role:"option","aria-labelledby":L,"data-highlighted":E?"":void 0,"aria-selected":w&&E,"data-state":w?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...f,ref:V,onFocus:ln(f.onFocus,()=>D(!0)),onBlur:ln(f.onBlur,()=>D(!1)),onClick:ln(f.onClick,()=>{$.current!=="mouse"&&H()}),onPointerUp:ln(f.onPointerUp,()=>{$.current==="mouse"&&H()}),onPointerDown:ln(f.onPointerDown,K=>{$.current=K.pointerType}),onPointerMove:ln(f.onPointerMove,K=>{var Q;$.current=K.pointerType,a?(Q=x.onItemLeave)==null||Q.call(x):$.current==="mouse"&&K.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ln(f.onPointerLeave,K=>{var Q;K.currentTarget===document.activeElement&&((Q=x.onItemLeave)==null||Q.call(x))}),onKeyDown:ln(f.onKeyDown,K=>{var ae;((ae=x.searchRef)==null?void 0:ae.current)!==""&&K.key===" "||(A4e.includes(K.key)&&H(),K.key===" "&&K.preventDefault())})})})})});ere.displayName=uP;var o1="SelectItemText",tre=W.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...c}=e,f=my(o1,r),i=gy(o1,r),x=Qte(o1,r),w=j4e(o1,r),[A,P]=W.useState(null),E=Ji(t,H=>P(H),x.onItemTextChange,H=>{var K;return(K=i.itemTextRefCallback)==null?void 0:K.call(i,H,x.value,x.disabled)}),D=A==null?void 0:A.textContent,V=W.useMemo(()=>l.jsx("option",{value:x.value,disabled:x.disabled,children:D},x.value),[x.disabled,x.value,D]),{onNativeOptionAdd:L,onNativeOptionRemove:$}=w;return dl(()=>(L(V),()=>$(V)),[L,$,V]),l.jsxs(l.Fragment,{children:[l.jsx(vi.span,{id:x.textId,...c,ref:E}),x.isSelected&&f.valueNode&&!f.valueNodeHasChildren?zw.createPortal(c.children,f.valueNode):null]})});tre.displayName=o1;var rre="SelectItemIndicator",nre=W.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return Qte(rre,r).isSelected?l.jsx(vi.span,{"aria-hidden":!0,...n,ref:t}):null});nre.displayName=rre;var x3="SelectScrollUpButton",ire=W.forwardRef((e,t)=>{const r=gy(x3,e.__scopeSelect),n=N4(x3,e.__scopeSelect),[a,c]=W.useState(!1),f=Ji(t,n.onScrollButtonChange);return dl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=x.scrollTop>0;c(w)};const x=r.viewport;return i(),x.addEventListener("scroll",i),()=>x.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?l.jsx(sre,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:x}=r;i&&x&&(i.scrollTop=i.scrollTop-x.offsetHeight)}}):null});ire.displayName=x3;var _3="SelectScrollDownButton",are=W.forwardRef((e,t)=>{const r=gy(_3,e.__scopeSelect),n=N4(_3,e.__scopeSelect),[a,c]=W.useState(!1),f=Ji(t,n.onScrollButtonChange);return dl(()=>{if(r.viewport&&r.isPositioned){let i=function(){const w=x.scrollHeight-x.clientHeight,A=Math.ceil(x.scrollTop)<w;c(A)};const x=r.viewport;return i(),x.addEventListener("scroll",i),()=>x.removeEventListener("scroll",i)}},[r.viewport,r.isPositioned]),a?l.jsx(sre,{...e,ref:f,onAutoScroll:()=>{const{viewport:i,selectedItem:x}=r;i&&x&&(i.scrollTop=i.scrollTop+x.offsetHeight)}}):null});are.displayName=_3;var sre=W.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,c=gy("SelectScrollButton",r),f=W.useRef(null),i=jN(r),x=W.useCallback(()=>{f.current!==null&&(window.clearInterval(f.current),f.current=null)},[]);return W.useEffect(()=>()=>x(),[x]),dl(()=>{var A;const w=i().find(P=>P.ref.current===document.activeElement);(A=w==null?void 0:w.ref.current)==null||A.scrollIntoView({block:"nearest"})},[i]),l.jsx(vi.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ln(a.onPointerDown,()=>{f.current===null&&(f.current=window.setInterval(n,50))}),onPointerMove:ln(a.onPointerMove,()=>{var w;(w=c.onItemLeave)==null||w.call(c),f.current===null&&(f.current=window.setInterval(n,50))}),onPointerLeave:ln(a.onPointerLeave,()=>{x()})})}),z4e="SelectSeparator",ore=W.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return l.jsx(vi.div,{"aria-hidden":!0,...n,ref:t})});ore.displayName=z4e;var b3="SelectArrow",F4e=W.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=CN(r),c=my(b3,r),f=gy(b3,r);return c.open&&f.position==="popper"?l.jsx(PP,{...a,...n,ref:t}):null});F4e.displayName=b3;function lre(e){return e===""||e===void 0}var cre=W.forwardRef((e,t)=>{const{value:r,...n}=e,a=W.useRef(null),c=Ji(t,a),f=_4e(r);return W.useEffect(()=>{const i=a.current,x=window.HTMLSelectElement.prototype,A=Object.getOwnPropertyDescriptor(x,"value").set;if(f!==r&&A){const P=new Event("change",{bubbles:!0});A.call(i,r),i.dispatchEvent(P)}},[f,r]),l.jsx(P4,{asChild:!0,children:l.jsx("select",{...n,ref:c,defaultValue:r})})});cre.displayName="BubbleSelect";function ure(e){const t=Lu(e),r=W.useRef(""),n=W.useRef(0),a=W.useCallback(f=>{const i=r.current+f;t(i),function x(w){r.current=w,window.clearTimeout(n.current),w!==""&&(n.current=window.setTimeout(()=>x(""),1e3))}(i)},[t]),c=W.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return W.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,c]}function dre(e,t,r){const a=t.length>1&&Array.from(t).every(w=>w===t[0])?t[0]:t,c=r?e.indexOf(r):-1;let f=B4e(e,Math.max(c,0));a.length===1&&(f=f.filter(w=>w!==r));const x=f.find(w=>w.textValue.toLowerCase().startsWith(a.toLowerCase()));return x!==r?x:void 0}function B4e(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var V4e=Lte,hre=Fte,U4e=Vte,$4e=Ute,q4e=$te,fre=qte,G4e=Kte,W4e=Yte,pre=Jte,mre=ere,H4e=tre,K4e=nre,gre=ire,yre=are,vre=ore;const Uo=V4e,w3=W4e,$o=U4e,So=W.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(hre,{ref:n,className:Ut("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,l.jsx($4e,{asChild:!0,children:l.jsx(oH,{className:"h-4 w-4 opacity-50"})})]}));So.displayName=hre.displayName;const xre=W.forwardRef(({className:e,...t},r)=>l.jsx(gre,{ref:r,className:Ut("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(wue,{className:"h-4 w-4"})}));xre.displayName=gre.displayName;const _re=W.forwardRef(({className:e,...t},r)=>l.jsx(yre,{ref:r,className:Ut("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(oH,{className:"h-4 w-4"})}));_re.displayName=yre.displayName;const Ao=W.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>l.jsx(q4e,{children:l.jsxs(fre,{ref:a,className:Ut("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[l.jsx(xre,{}),l.jsx(G4e,{className:Ut("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),l.jsx(_re,{})]})}));Ao.displayName=fre.displayName;const S3=W.forwardRef(({className:e,...t},r)=>l.jsx(pre,{ref:r,className:Ut("px-2 py-1.5 text-sm font-semibold",e),...t}));S3.displayName=pre.displayName;const pn=W.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(mre,{ref:n,className:Ut("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(K4e,{children:l.jsx(J3,{className:"h-4 w-4"})})}),l.jsx(H4e,{children:t})]}));pn.displayName=mre.displayName;const Z4e=W.forwardRef(({className:e,...t},r)=>l.jsx(vre,{ref:r,className:Ut("-mx-1 my-1 h-px bg-muted",e),...t}));Z4e.displayName=vre.displayName;const Ci=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ut("rounded-xl md:border bg-card text-card-foreground md:shadow",e),...t}));Ci.displayName="Card";const zi=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ut("flex flex-col space-y-1.5 p-6",e),...t}));zi.displayName="CardHeader";const Fi=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ut("font-semibold leading-none tracking-tight",e),...t}));Fi.displayName="CardTitle";const As=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ut("text-sm text-muted-foreground",e),...t}));As.displayName="CardDescription";const Ii=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ut("p-6 pt-0",e),...t}));Ii.displayName="CardContent";const j4=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ut("flex items-center p-6 pt-0",e),...t}));j4.displayName="CardFooter";const Y4e={light:"",dark:".dark"},bre=W.createContext(null);function wre(){const e=W.useContext(bre);if(!e)throw new Error("useChart must be used within a <ChartContainer />");return e}const Sre=W.forwardRef(({id:e,className:t,children:r,config:n,...a},c)=>{const f=W.useId(),i=`chart-${e||f.replace(/:/g,"")}`;return l.jsx(bre.Provider,{value:{config:n},children:l.jsxs("div",{"data-chart":i,ref:c,className:Ut("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...a,children:[l.jsx(X4e,{id:i,config:n}),l.jsx(_o,{children:r})]})})});Sre.displayName="Chart";const X4e=({id:e,config:t})=>{const r=Object.entries(t).filter(([,n])=>n.theme||n.color);return r.length?l.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(Y4e).map(([n,a])=>`
${a} [data-chart=${e}] {
${r.map(([c,f])=>{var x;const i=((x=f.theme)==null?void 0:x[n])||f.color;return i?`  --color-${c}: ${i};`:null}).join(`
`)}
}
`).join(`
`)}}):null},J4e=ta,Are=W.forwardRef(({active:e,payload:t,className:r,indicator:n="dot",hideLabel:a=!1,hideIndicator:c=!1,label:f,labelFormatter:i,labelClassName:x,formatter:w,color:A,nameKey:P,labelKey:E},D)=>{const{config:V}=wre(),L=W.useMemo(()=>{var ee;if(a||!(t!=null&&t.length))return null;const[H]=t,K=`${E||(H==null?void 0:H.dataKey)||(H==null?void 0:H.name)||"value"}`,Q=A3(V,H,K),ae=!E&&typeof f=="string"?((ee=V[f])==null?void 0:ee.label)||f:Q==null?void 0:Q.label;return i?l.jsx("div",{className:Ut("font-medium",x),children:i(ae,t)}):ae?l.jsx("div",{className:Ut("font-medium",x),children:ae}):null},[f,i,t,a,x,V,E]);if(!e||!(t!=null&&t.length))return null;const $=t.length===1&&n!=="dot";return l.jsxs("div",{ref:D,className:Ut("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",r),children:[$?null:L,l.jsx("div",{className:"grid gap-1.5",children:t.map((H,K)=>{const Q=`${P||H.name||H.dataKey||"value"}`,ae=A3(V,H,Q),ee=A||H.payload.fill||H.color;return l.jsx("div",{className:Ut("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",n==="dot"&&"items-center"),children:w&&(H==null?void 0:H.value)!==void 0&&H.name?w(H.value,H.name,H,K,H.payload):l.jsxs(l.Fragment,{children:[ae!=null&&ae.icon?l.jsx(ae.icon,{}):!c&&l.jsx("div",{className:Ut("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":n==="dot","w-1":n==="line","w-0 border-[1.5px] border-dashed bg-transparent":n==="dashed","my-0.5":$&&n==="dashed"}),style:{"--color-bg":ee,"--color-border":ee}}),l.jsxs("div",{className:Ut("flex flex-1 justify-between leading-none",$?"items-end":"items-center"),children:[l.jsxs("div",{className:"grid gap-1.5",children:[$?L:null,l.jsx("span",{className:"text-muted-foreground",children:(ae==null?void 0:ae.label)||H.name})]}),H.value&&l.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:H.value.toLocaleString()})]})]})},H.dataKey)})})]})});Are.displayName="ChartTooltip";const Q4e=W.forwardRef(({className:e,hideIcon:t=!1,payload:r,verticalAlign:n="bottom",nameKey:a},c)=>{const{config:f}=wre();return r!=null&&r.length?l.jsx("div",{ref:c,className:Ut("flex items-center justify-center gap-4",n==="top"?"pb-3":"pt-3",e),children:r.map(i=>{const x=`${a||i.dataKey||"value"}`,w=A3(f,i,x);return l.jsxs("div",{className:Ut("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[w!=null&&w.icon&&!t?l.jsx(w.icon,{}):l.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:i.color}}),w==null?void 0:w.label]},i.value)})}):null});Q4e.displayName="ChartLegend";function A3(e,t,r){if(typeof t!="object"||t===null)return;const n="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let a=r;return r in t&&typeof t[r]=="string"?a=t[r]:n&&r in n&&typeof n[r]=="string"&&(a=n[r]),a in e?e[a]:e[r]}const fW={views:{label:"Page Views"},violations:{label:"Violations",color:"hsl(var(--chart-1))"},accidents:{label:"Accidents",color:"hsl(var(--chart-2))"}};function e5e(){const[e,t]=W.useState("violations"),[r,n]=W.useState("all"),[a,c]=W.useState([]),[f,i]=W.useState(!0),[x,w]=W.useState(null),A=Di(),{token:P}=A||{};W.useEffect(()=>{E()},[r]);const E=async()=>{try{i(!0),w(null);const{data:L}=await xn.get(`/dashboard/chart?period=${r}`,{headers:{Authorization:P}});if(L.success){const $=L.data.chartData.map(H=>{let K="";return r==="week"?K=`${H.year}-${String(H.month).padStart(2,"0")}-${String(H.day).padStart(2,"0")}`:r==="years"?K=`${H.year}-01-01`:K=`${H.year}-${String(H.month).padStart(2,"0")}-01`,{date:K,violations:H.violations||0,accidents:H.accidents||0}});c($)}}catch(L){console.error("Error fetching chart data:",L),w("Failed to load chart data")}finally{i(!1)}},D=W.useMemo(()=>({violations:a.reduce((L,$)=>L+$.violations,0),accidents:a.reduce((L,$)=>L+$.accidents,0)}),[a]),V=L=>{switch(L){case"week":return"Last Week";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"months":return"Last 12 Months";case"year":return"Last Year";case"years":return"Last 5 Years";case"all":return"All Time";default:return"All Time"}};return l.jsxs(Ci,{className:"md:shadow-none border",children:[l.jsxs(zi,{className:"flex flex-col items-stretch space-y-0 border-b p-0 sm:flex-row",children:[l.jsxs("div",{className:"flex flex-1 flex-col justify-center gap-1 px-6 py-5 sm:py-6",children:[l.jsx(Fi,{children:"Violation & Accidents Overview"}),l.jsxs(As,{children:["Showing violation and accident frequency for ",V(r)]}),l.jsx("div",{className:"mt-2",children:l.jsxs(Uo,{value:r,onValueChange:n,children:[l.jsx(So,{className:"w-[180px]",children:l.jsx($o,{placeholder:"Select time period"})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"week",children:"Last Week"}),l.jsx(pn,{value:"3months",children:"Last 3 Months"}),l.jsx(pn,{value:"6months",children:"Last 6 Months"}),l.jsx(pn,{value:"months",children:"Last 12 Months"}),l.jsx(pn,{value:"year",children:"Last Year"}),l.jsx(pn,{value:"years",children:"Last 5 Years"}),l.jsx(pn,{value:"all",children:"All Time"})]})]})})]}),l.jsx("div",{className:"flex",children:["violations","accidents"].map(L=>l.jsxs("button",{"data-active":e===L,className:"relative z-30 flex flex-1 flex-col justify-center gap-1 border-t px-6 py-4 text-left even:border-l data-[active=true]:bg-muted/50 sm:border-l sm:border-t-0 sm:px-8 sm:py-6",onClick:()=>t(L),children:[l.jsx("span",{className:"text-xs text-muted-foreground",children:fW[L].label}),l.jsx("span",{className:"text-lg font-bold leading-none sm:text-3xl",children:f?"...":D[L].toLocaleString()})]},L))})]}),l.jsx(Ii,{className:"px-2 sm:p-6",children:f?l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),l.jsx("div",{className:"h-[250px] bg-muted rounded"})]}):x?l.jsx("div",{className:"flex items-center justify-center h-[250px]",children:l.jsx("div",{className:"text-red-500",children:x})}):a.length===0?l.jsx("div",{className:"flex items-center justify-center h-[250px]",children:l.jsx("div",{className:"text-muted-foreground",children:"No data available for the selected period"})}):l.jsx(Sre,{config:fW,className:"aspect-auto h-[250px] w-full",children:l.jsxs(Cu,{accessibilityLayer:!0,data:a,margin:{left:12,right:12},children:[l.jsx(Ws,{vertical:!1}),l.jsx(Oa,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,minTickGap:32,tickFormatter:L=>{const $=new Date(L);return r==="week"?$.toLocaleDateString("en-US",{month:"short",day:"numeric"}):r==="years"?$.toLocaleDateString("en-US",{year:"numeric"}):$.toLocaleDateString("en-US",{month:"short",year:"numeric"})}}),l.jsx(J4e,{content:l.jsx(Are,{className:"w-[150px]",nameKey:"views",labelFormatter:L=>{const $=new Date(L);return r==="week"?$.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):r==="years"?$.toLocaleDateString("en-US",{year:"numeric"}):$.toLocaleDateString("en-US",{month:"short",year:"numeric"})}})}),l.jsx(ds,{dataKey:e,fill:`var(--color-${e})`})]})})})]})}function ra(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Fu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function gc(e,t){const r=ra(e);return isNaN(t)?Fu(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Zh(e,t){const r=ra(e);if(isNaN(t))return Fu(e,NaN);if(!t)return r;const n=r.getDate(),a=Fu(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const c=a.getDate();return n>=c?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const C4=6048e5,t5e=864e5;let r5e={};function b2(){return r5e}function lp(e,t){var i,x,w,A;const r=b2(),n=(t==null?void 0:t.weekStartsOn)??((x=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:x.weekStartsOn)??r.weekStartsOn??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.weekStartsOn)??0,a=ra(e),c=a.getDay(),f=(c<n?7:0)+c-n;return a.setDate(a.getDate()-f),a.setHours(0,0,0,0),a}function Z0(e){return lp(e,{weekStartsOn:1})}function Tre(e){const t=ra(e),r=t.getFullYear(),n=Fu(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=Z0(n),c=Fu(e,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const f=Z0(c);return t.getTime()>=a.getTime()?r+1:t.getTime()>=f.getTime()?r:r-1}function u_(e){const t=ra(e);return t.setHours(0,0,0,0),t}function dP(e){const t=ra(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Gf(e,t){const r=u_(e),n=u_(t),a=+r-dP(r),c=+n-dP(n);return Math.round((a-c)/t5e)}function n5e(e){const t=Tre(e),r=Fu(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Z0(r)}function T3(e,t){const r=t*7;return gc(e,r)}function i5e(e,t){return Zh(e,t*12)}function a5e(e){let t;return e.forEach(function(r){const n=ra(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function s5e(e){let t;return e.forEach(r=>{const n=ra(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function Zc(e,t){const r=u_(e),n=u_(t);return+r==+n}function k4(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function o5e(e){if(!k4(e)&&typeof e!="number")return!1;const t=ra(e);return!isNaN(Number(t))}function Dw(e,t){const r=ra(e),n=ra(t),a=r.getFullYear()-n.getFullYear(),c=r.getMonth()-n.getMonth();return a*12+c}function l5e(e,t,r){const n=lp(e,r),a=lp(t,r),c=+n-dP(n),f=+a-dP(a);return Math.round((c-f)/C4)}function E4(e){const t=ra(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Xc(e){const t=ra(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Pre(e){const t=ra(e),r=Fu(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function M4(e,t){var i,x,w,A;const r=b2(),n=(t==null?void 0:t.weekStartsOn)??((x=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:x.weekStartsOn)??r.weekStartsOn??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.weekStartsOn)??0,a=ra(e),c=a.getDay(),f=(c<n?-7:0)+6-(c-n);return a.setDate(a.getDate()+f),a.setHours(23,59,59,999),a}function Nre(e){return M4(e,{weekStartsOn:1})}const c5e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},u5e=(e,t,r)=>{let n;const a=c5e[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function OO(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const d5e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},h5e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},f5e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},p5e={date:OO({formats:d5e,defaultWidth:"full"}),time:OO({formats:h5e,defaultWidth:"full"}),dateTime:OO({formats:f5e,defaultWidth:"full"})},m5e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},g5e=(e,t,r,n)=>m5e[e];function Kb(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const f=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):f;a=e.formattingValues[i]||e.formattingValues[f]}else{const f=e.defaultWidth,i=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[i]||e.values[f]}const c=e.argumentCallback?e.argumentCallback(t):t;return a[c]}}const y5e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},v5e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},x5e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_5e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},b5e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},w5e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},S5e=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},A5e={ordinalNumber:S5e,era:Kb({values:y5e,defaultWidth:"wide"}),quarter:Kb({values:v5e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Kb({values:x5e,defaultWidth:"wide"}),day:Kb({values:_5e,defaultWidth:"wide"}),dayPeriod:Kb({values:b5e,defaultWidth:"wide",formattingValues:w5e,defaultFormattingWidth:"wide"})};function Zb(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],c=t.match(a);if(!c)return null;const f=c[0],i=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],x=Array.isArray(i)?P5e(i,P=>P.test(f)):T5e(i,P=>P.test(f));let w;w=e.valueCallback?e.valueCallback(x):x,w=r.valueCallback?r.valueCallback(w):w;const A=t.slice(f.length);return{value:w,rest:A}}}function T5e(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function P5e(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function N5e(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],c=t.match(e.parsePattern);if(!c)return null;let f=e.valueCallback?e.valueCallback(c[0]):c[0];f=r.valueCallback?r.valueCallback(f):f;const i=t.slice(a.length);return{value:f,rest:i}}}const j5e=/^(\d+)(th|st|nd|rd)?/i,C5e=/\d+/i,k5e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},E5e={any:[/^b/i,/^(a|c)/i]},M5e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},O5e={any:[/1/i,/2/i,/3/i,/4/i]},R5e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},I5e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},D5e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},L5e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},z5e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},F5e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},B5e={ordinalNumber:N5e({matchPattern:j5e,parsePattern:C5e,valueCallback:e=>parseInt(e,10)}),era:Zb({matchPatterns:k5e,defaultMatchWidth:"wide",parsePatterns:E5e,defaultParseWidth:"any"}),quarter:Zb({matchPatterns:M5e,defaultMatchWidth:"wide",parsePatterns:O5e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zb({matchPatterns:R5e,defaultMatchWidth:"wide",parsePatterns:I5e,defaultParseWidth:"any"}),day:Zb({matchPatterns:D5e,defaultMatchWidth:"wide",parsePatterns:L5e,defaultParseWidth:"any"}),dayPeriod:Zb({matchPatterns:z5e,defaultMatchWidth:"any",parsePatterns:F5e,defaultParseWidth:"any"})},jre={code:"en-US",formatDistance:u5e,formatLong:p5e,formatRelative:g5e,localize:A5e,match:B5e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function V5e(e){const t=ra(e);return Gf(t,Pre(t))+1}function Cre(e){const t=ra(e),r=+Z0(t)-+n5e(t);return Math.round(r/C4)+1}function kre(e,t){var A,P,E,D;const r=ra(e),n=r.getFullYear(),a=b2(),c=(t==null?void 0:t.firstWeekContainsDate)??((P=(A=t==null?void 0:t.locale)==null?void 0:A.options)==null?void 0:P.firstWeekContainsDate)??a.firstWeekContainsDate??((D=(E=a.locale)==null?void 0:E.options)==null?void 0:D.firstWeekContainsDate)??1,f=Fu(e,0);f.setFullYear(n+1,0,c),f.setHours(0,0,0,0);const i=lp(f,t),x=Fu(e,0);x.setFullYear(n,0,c),x.setHours(0,0,0,0);const w=lp(x,t);return r.getTime()>=i.getTime()?n+1:r.getTime()>=w.getTime()?n:n-1}function U5e(e,t){var i,x,w,A;const r=b2(),n=(t==null?void 0:t.firstWeekContainsDate)??((x=(i=t==null?void 0:t.locale)==null?void 0:i.options)==null?void 0:x.firstWeekContainsDate)??r.firstWeekContainsDate??((A=(w=r.locale)==null?void 0:w.options)==null?void 0:A.firstWeekContainsDate)??1,a=kre(e,t),c=Fu(e,0);return c.setFullYear(a,0,n),c.setHours(0,0,0,0),lp(c,t)}function Ere(e,t){const r=ra(e),n=+lp(r,t)-+U5e(r,t);return Math.round(n/C4)+1}function Ta(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Eg={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Ta(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ta(r+1,2)},d(e,t){return Ta(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ta(e.getHours()%12||12,t.length)},H(e,t){return Ta(e.getHours(),t.length)},m(e,t){return Ta(e.getMinutes(),t.length)},s(e,t){return Ta(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ta(a,t.length)}},ix={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},pW={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Eg.y(e,t)},Y:function(e,t,r,n){const a=kre(e,n),c=a>0?a:1-a;if(t==="YY"){const f=c%100;return Ta(f,2)}return t==="Yo"?r.ordinalNumber(c,{unit:"year"}):Ta(c,t.length)},R:function(e,t){const r=Tre(e);return Ta(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ta(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Ta(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Ta(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Eg.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Ta(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=Ere(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Ta(a,t.length)},I:function(e,t,r){const n=Cre(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Ta(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Eg.d(e,t)},D:function(e,t,r){const n=V5e(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ta(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),c=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(c);case"ee":return Ta(c,2);case"eo":return r.ordinalNumber(c,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),c=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(c);case"cc":return Ta(c,t.length);case"co":return r.ordinalNumber(c,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Ta(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=ix.noon:n===0?a=ix.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=ix.evening:n>=12?a=ix.afternoon:n>=4?a=ix.morning:a=ix.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Eg.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Eg.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ta(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ta(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Eg.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Eg.s(e,t)},S:function(e,t){return Eg.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return gW(n);case"XXXX":case"XX":return v0(n);case"XXXXX":case"XXX":default:return v0(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return gW(n);case"xxxx":case"xx":return v0(n);case"xxxxx":case"xxx":default:return v0(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+mW(n,":");case"OOOO":default:return"GMT"+v0(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+mW(n,":");case"zzzz":default:return"GMT"+v0(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Ta(n,t.length)},T:function(e,t,r){const n=e.getTime();return Ta(n,t.length)}};function mW(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),c=n%60;return c===0?r+String(a):r+String(a)+t+Ta(c,2)}function gW(e,t){return e%60===0?(e>0?"-":"+")+Ta(Math.abs(e)/60,2):v0(e,t)}function v0(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Ta(Math.trunc(n/60),2),c=Ta(n%60,2);return r+a+t+c}const yW=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Mre=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},$5e=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return yW(e,t);let c;switch(n){case"P":c=t.dateTime({width:"short"});break;case"PP":c=t.dateTime({width:"medium"});break;case"PPP":c=t.dateTime({width:"long"});break;case"PPPP":default:c=t.dateTime({width:"full"});break}return c.replace("{{date}}",yW(n,t)).replace("{{time}}",Mre(a,t))},q5e={p:Mre,P:$5e},G5e=/^D+$/,W5e=/^Y+$/,H5e=["D","DD","YY","YYYY"];function K5e(e){return G5e.test(e)}function Z5e(e){return W5e.test(e)}function Y5e(e,t,r){const n=X5e(e,t,r);if(console.warn(n),H5e.includes(e))throw new RangeError(n)}function X5e(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const J5e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Q5e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eze=/^'([^]*?)'?$/,tze=/''/g,rze=/[a-zA-Z]/;function wc(e,t,r){var A,P,E,D,V,L,$,H;const n=b2(),a=(r==null?void 0:r.locale)??n.locale??jre,c=(r==null?void 0:r.firstWeekContainsDate)??((P=(A=r==null?void 0:r.locale)==null?void 0:A.options)==null?void 0:P.firstWeekContainsDate)??n.firstWeekContainsDate??((D=(E=n.locale)==null?void 0:E.options)==null?void 0:D.firstWeekContainsDate)??1,f=(r==null?void 0:r.weekStartsOn)??((L=(V=r==null?void 0:r.locale)==null?void 0:V.options)==null?void 0:L.weekStartsOn)??n.weekStartsOn??((H=($=n.locale)==null?void 0:$.options)==null?void 0:H.weekStartsOn)??0,i=ra(e);if(!o5e(i))throw new RangeError("Invalid time value");let x=t.match(Q5e).map(K=>{const Q=K[0];if(Q==="p"||Q==="P"){const ae=q5e[Q];return ae(K,a.formatLong)}return K}).join("").match(J5e).map(K=>{if(K==="''")return{isToken:!1,value:"'"};const Q=K[0];if(Q==="'")return{isToken:!1,value:nze(K)};if(pW[Q])return{isToken:!0,value:K};if(Q.match(rze))throw new RangeError("Format string contains an unescaped latin alphabet character `"+Q+"`");return{isToken:!1,value:K}});a.localize.preprocessor&&(x=a.localize.preprocessor(i,x));const w={firstWeekContainsDate:c,weekStartsOn:f,locale:a};return x.map(K=>{if(!K.isToken)return K.value;const Q=K.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Z5e(Q)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&K5e(Q))&&Y5e(Q,t,String(e));const ae=pW[Q[0]];return ae(i,Q,a.localize,w)}).join("")}function nze(e){const t=e.match(eze);return t?t[1].replace(tze,"'"):e}function ize(e){const t=ra(e),r=t.getFullYear(),n=t.getMonth(),a=Fu(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function aze(e){return Math.trunc(+ra(e)/1e3)}function sze(e){const t=ra(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function oze(e,t){return l5e(sze(e),Xc(e),t)+1}function P3(e,t){const r=ra(e),n=ra(t);return r.getTime()>n.getTime()}function Ore(e,t){const r=ra(e),n=ra(t);return+r<+n}function O4(e,t){const r=ra(e),n=ra(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function lze(e,t){const r=ra(e),n=ra(t);return r.getFullYear()===n.getFullYear()}function RO(e,t){return gc(e,-t)}function SA(e,t){const r=ra(e),n=r.getFullYear(),a=r.getDate(),c=Fu(e,0);c.setFullYear(n,t,15),c.setHours(0,0,0,0);const f=ize(c);return r.setMonth(t,Math.min(a,f)),r}function N3(e,t){const r=ra(e);return isNaN(+r)?Fu(e,NaN):(r.setFullYear(t),r)}var ui=function(){return ui=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},ui.apply(this,arguments)};function cze(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Rre(e,t,r){for(var n=0,a=t.length,c;n<a;n++)(c||!(n in t))&&(c||(c=Array.prototype.slice.call(t,0,n)),c[n]=t[n]);return e.concat(c||Array.prototype.slice.call(t))}function w2(e){return e.mode==="multiple"}function S2(e){return e.mode==="range"}function kN(e){return e.mode==="single"}var uze={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function dze(e,t){return wc(e,"LLLL y",t)}function hze(e,t){return wc(e,"d",t)}function fze(e,t){return wc(e,"LLLL",t)}function pze(e){return"".concat(e)}function mze(e,t){return wc(e,"cccccc",t)}function gze(e,t){return wc(e,"yyyy",t)}var yze=Object.freeze({__proto__:null,formatCaption:dze,formatDay:hze,formatMonthCaption:fze,formatWeekNumber:pze,formatWeekdayName:mze,formatYearCaption:gze}),vze=function(e,t,r){return wc(e,"do MMMM (EEEE)",r)},xze=function(){return"Month: "},_ze=function(){return"Go to next month"},bze=function(){return"Go to previous month"},wze=function(e,t){return wc(e,"cccc",t)},Sze=function(e){return"Week n. ".concat(e)},Aze=function(){return"Year: "},Tze=Object.freeze({__proto__:null,labelDay:vze,labelMonthDropdown:xze,labelNext:_ze,labelPrevious:bze,labelWeekNumber:Sze,labelWeekday:wze,labelYearDropdown:Aze});function Pze(){var e="buttons",t=uze,r=jre,n={},a={},c=1,f={},i=new Date;return{captionLayout:e,classNames:t,formatters:yze,labels:Tze,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:c,styles:f,today:i,mode:"default"}}function Nze(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,c=e.fromDate,f=e.toDate;return n?c=Xc(n):t&&(c=new Date(t,0,1)),a?f=E4(a):r&&(f=new Date(r,11,31)),{fromDate:c?u_(c):void 0,toDate:f?u_(f):void 0}}var Ire=W.createContext(void 0);function jze(e){var t,r=e.initialProps,n=Pze(),a=Nze(r),c=a.fromDate,f=a.toDate,i=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;i!=="buttons"&&(!c||!f)&&(i="buttons");var x;(kN(r)||w2(r)||S2(r))&&(x=r.onSelect);var w=ui(ui(ui({},n),r),{captionLayout:i,classNames:ui(ui({},n.classNames),r.classNames),components:ui({},r.components),formatters:ui(ui({},n.formatters),r.formatters),fromDate:c,labels:ui(ui({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:ui(ui({},n.modifiers),r.modifiers),modifiersClassNames:ui(ui({},n.modifiersClassNames),r.modifiersClassNames),onSelect:x,styles:ui(ui({},n.styles),r.styles),toDate:f});return l.jsx(Ire.Provider,{value:w,children:e.children})}function Qa(){var e=W.useContext(Ire);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function Dre(e){var t=Qa(),r=t.locale,n=t.classNames,a=t.styles,c=t.formatters.formatCaption;return l.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:c(e.displayMonth,{locale:r})})}function Cze(e){return l.jsx("svg",ui({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:l.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Lre(e){var t,r,n=e.onChange,a=e.value,c=e.children,f=e.caption,i=e.className,x=e.style,w=Qa(),A=(r=(t=w.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Cze;return l.jsxs("div",{className:i,style:x,children:[l.jsx("span",{className:w.classNames.vhidden,children:e["aria-label"]}),l.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:w.classNames.dropdown,style:w.styles.dropdown,value:a,onChange:n,children:c}),l.jsxs("div",{className:w.classNames.caption_label,style:w.styles.caption_label,"aria-hidden":"true",children:[f,l.jsx(A,{className:w.classNames.dropdown_icon,style:w.styles.dropdown_icon})]})]})}function kze(e){var t,r=Qa(),n=r.fromDate,a=r.toDate,c=r.styles,f=r.locale,i=r.formatters.formatMonthCaption,x=r.classNames,w=r.components,A=r.labels.labelMonthDropdown;if(!n)return l.jsx(l.Fragment,{});if(!a)return l.jsx(l.Fragment,{});var P=[];if(lze(n,a))for(var E=Xc(n),D=n.getMonth();D<=a.getMonth();D++)P.push(SA(E,D));else for(var E=Xc(new Date),D=0;D<=11;D++)P.push(SA(E,D));var V=function($){var H=Number($.target.value),K=SA(Xc(e.displayMonth),H);e.onChange(K)},L=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:Lre;return l.jsx(L,{name:"months","aria-label":A(),className:x.dropdown_month,style:c.dropdown_month,onChange:V,value:e.displayMonth.getMonth(),caption:i(e.displayMonth,{locale:f}),children:P.map(function($){return l.jsx("option",{value:$.getMonth(),children:i($,{locale:f})},$.getMonth())})})}function Eze(e){var t,r=e.displayMonth,n=Qa(),a=n.fromDate,c=n.toDate,f=n.locale,i=n.styles,x=n.classNames,w=n.components,A=n.formatters.formatYearCaption,P=n.labels.labelYearDropdown,E=[];if(!a)return l.jsx(l.Fragment,{});if(!c)return l.jsx(l.Fragment,{});for(var D=a.getFullYear(),V=c.getFullYear(),L=D;L<=V;L++)E.push(N3(Pre(new Date),L));var $=function(K){var Q=N3(Xc(r),Number(K.target.value));e.onChange(Q)},H=(t=w==null?void 0:w.Dropdown)!==null&&t!==void 0?t:Lre;return l.jsx(H,{name:"years","aria-label":P(),className:x.dropdown_year,style:i.dropdown_year,onChange:$,value:r.getFullYear(),caption:A(r,{locale:f}),children:E.map(function(K){return l.jsx("option",{value:K.getFullYear(),children:A(K,{locale:f})},K.getFullYear())})})}function Mze(e,t){var r=W.useState(e),n=r[0],a=r[1],c=t===void 0?n:t;return[c,a]}function Oze(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,c=e.toDate,f=e.fromDate,i=e.numberOfMonths,x=i===void 0?1:i;if(c&&Dw(c,a)<0){var w=-1*(x-1);a=Zh(c,w)}return f&&Dw(a,f)<0&&(a=f),Xc(a)}function Rze(){var e=Qa(),t=Oze(e),r=Mze(t,e.month),n=r[0],a=r[1],c=function(f){var i;if(!e.disableNavigation){var x=Xc(f);a(x),(i=e.onMonthChange)===null||i===void 0||i.call(e,x)}};return[n,c]}function Ize(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=Xc(e),c=Xc(Zh(a,n)),f=Dw(c,a),i=[],x=0;x<f;x++){var w=Zh(a,x);i.push(w)}return r&&(i=i.reverse()),i}function Dze(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,f=n?c:1,i=Xc(e);if(!r)return Zh(i,f);var x=Dw(r,e);if(!(x<c))return Zh(i,f)}}function Lze(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,c=a===void 0?1:a,f=n?c:1,i=Xc(e);if(!r)return Zh(i,-f);var x=Dw(i,r);if(!(x<=0))return Zh(i,-f)}}var zre=W.createContext(void 0);function zze(e){var t=Qa(),r=Rze(),n=r[0],a=r[1],c=Ize(n,t),f=Dze(n,t),i=Lze(n,t),x=function(P){return c.some(function(E){return O4(P,E)})},w=function(P,E){x(P)||(E&&Ore(P,E)?a(Zh(P,1+t.numberOfMonths*-1)):a(P))},A={currentMonth:n,displayMonths:c,goToMonth:a,goToDate:w,previousMonth:i,nextMonth:f,isDateDisplayed:x};return l.jsx(zre.Provider,{value:A,children:e.children})}function A2(){var e=W.useContext(zre);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function vW(e){var t,r=Qa(),n=r.classNames,a=r.styles,c=r.components,f=A2().goToMonth,i=function(A){f(Zh(A,e.displayIndex?-e.displayIndex:0))},x=(t=c==null?void 0:c.CaptionLabel)!==null&&t!==void 0?t:Dre,w=l.jsx(x,{id:e.id,displayMonth:e.displayMonth});return l.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[l.jsx("div",{className:n.vhidden,children:w}),l.jsx(kze,{onChange:i,displayMonth:e.displayMonth}),l.jsx(Eze,{onChange:i,displayMonth:e.displayMonth})]})}function Fze(e){return l.jsx("svg",ui({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:l.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Bze(e){return l.jsx("svg",ui({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:l.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var hP=W.forwardRef(function(e,t){var r=Qa(),n=r.classNames,a=r.styles,c=[n.button_reset,n.button];e.className&&c.push(e.className);var f=c.join(" "),i=ui(ui({},a.button_reset),a.button);return e.style&&Object.assign(i,e.style),l.jsx("button",ui({},e,{ref:t,type:"button",className:f,style:i}))});function Vze(e){var t,r,n=Qa(),a=n.dir,c=n.locale,f=n.classNames,i=n.styles,x=n.labels,w=x.labelPrevious,A=x.labelNext,P=n.components;if(!e.nextMonth&&!e.previousMonth)return l.jsx(l.Fragment,{});var E=w(e.previousMonth,{locale:c}),D=[f.nav_button,f.nav_button_previous].join(" "),V=A(e.nextMonth,{locale:c}),L=[f.nav_button,f.nav_button_next].join(" "),$=(t=P==null?void 0:P.IconRight)!==null&&t!==void 0?t:Bze,H=(r=P==null?void 0:P.IconLeft)!==null&&r!==void 0?r:Fze;return l.jsxs("div",{className:f.nav,style:i.nav,children:[!e.hidePrevious&&l.jsx(hP,{name:"previous-month","aria-label":E,className:D,style:i.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?l.jsx($,{className:f.nav_icon,style:i.nav_icon}):l.jsx(H,{className:f.nav_icon,style:i.nav_icon})}),!e.hideNext&&l.jsx(hP,{name:"next-month","aria-label":V,className:L,style:i.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?l.jsx(H,{className:f.nav_icon,style:i.nav_icon}):l.jsx($,{className:f.nav_icon,style:i.nav_icon})})]})}function xW(e){var t=Qa().numberOfMonths,r=A2(),n=r.previousMonth,a=r.nextMonth,c=r.goToMonth,f=r.displayMonths,i=f.findIndex(function(V){return O4(e.displayMonth,V)}),x=i===0,w=i===f.length-1,A=t>1&&(x||!w),P=t>1&&(w||!x),E=function(){n&&c(n)},D=function(){a&&c(a)};return l.jsx(Vze,{displayMonth:e.displayMonth,hideNext:A,hidePrevious:P,nextMonth:a,previousMonth:n,onPreviousClick:E,onNextClick:D})}function Uze(e){var t,r=Qa(),n=r.classNames,a=r.disableNavigation,c=r.styles,f=r.captionLayout,i=r.components,x=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:Dre,w;return a?w=l.jsx(x,{id:e.id,displayMonth:e.displayMonth}):f==="dropdown"?w=l.jsx(vW,{displayMonth:e.displayMonth,id:e.id}):f==="dropdown-buttons"?w=l.jsxs(l.Fragment,{children:[l.jsx(vW,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),l.jsx(xW,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):w=l.jsxs(l.Fragment,{children:[l.jsx(x,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),l.jsx(xW,{displayMonth:e.displayMonth,id:e.id})]}),l.jsx("div",{className:n.caption,style:c.caption,children:w})}function $ze(e){var t=Qa(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?l.jsx("tfoot",{className:a,style:n.tfoot,children:l.jsx("tr",{children:l.jsx("td",{colSpan:8,children:r})})}):l.jsx(l.Fragment,{})}function qze(e,t,r){for(var n=r?Z0(new Date):lp(new Date,{locale:e,weekStartsOn:t}),a=[],c=0;c<7;c++){var f=gc(n,c);a.push(f)}return a}function Gze(){var e=Qa(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,c=e.weekStartsOn,f=e.ISOWeek,i=e.formatters.formatWeekdayName,x=e.labels.labelWeekday,w=qze(a,c,f);return l.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&l.jsx("td",{style:r.head_cell,className:t.head_cell}),w.map(function(A,P){return l.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":x(A,{locale:a}),children:i(A,{locale:a})},P)})]})}function Wze(){var e,t=Qa(),r=t.classNames,n=t.styles,a=t.components,c=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:Gze;return l.jsx("thead",{style:n.head,className:r.head,children:l.jsx(c,{})})}function Hze(e){var t=Qa(),r=t.locale,n=t.formatters.formatDay;return l.jsx(l.Fragment,{children:n(e.date,{locale:r})})}var R4=W.createContext(void 0);function Kze(e){if(!w2(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return l.jsx(R4.Provider,{value:t,children:e.children})}return l.jsx(Zze,{initialProps:e.initialProps,children:e.children})}function Zze(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,c=t.max,f=function(w,A,P){var E,D;(E=t.onDayClick)===null||E===void 0||E.call(t,w,A,P);var V=!!(A.selected&&a&&(n==null?void 0:n.length)===a);if(!V){var L=!!(!A.selected&&c&&(n==null?void 0:n.length)===c);if(!L){var $=n?Rre([],n):[];if(A.selected){var H=$.findIndex(function(K){return Zc(w,K)});$.splice(H,1)}else $.push(w);(D=t.onSelect)===null||D===void 0||D.call(t,$,w,A,P)}}},i={disabled:[]};n&&i.disabled.push(function(w){var A=c&&n.length>c-1,P=n.some(function(E){return Zc(E,w)});return!!(A&&!P)});var x={selected:n,onDayClick:f,modifiers:i};return l.jsx(R4.Provider,{value:x,children:r})}function I4(){var e=W.useContext(R4);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Yze(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Zc(a,e)&&Zc(n,e)?void 0:Zc(a,e)?{from:a,to:void 0}:Zc(n,e)?void 0:P3(n,e)?{from:e,to:a}:{from:n,to:e}:a?P3(e,a)?{from:a,to:e}:{from:e,to:a}:n?Ore(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var D4=W.createContext(void 0);function Xze(e){if(!S2(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return l.jsx(D4.Provider,{value:t,children:e.children})}return l.jsx(Jze,{initialProps:e.initialProps,children:e.children})}function Jze(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},c=a.from,f=a.to,i=t.min,x=t.max,w=function(D,V,L){var $,H;($=t.onDayClick)===null||$===void 0||$.call(t,D,V,L);var K=Yze(D,n);(H=t.onSelect)===null||H===void 0||H.call(t,K,D,V,L)},A={range_start:[],range_end:[],range_middle:[],disabled:[]};if(c?(A.range_start=[c],f?(A.range_end=[f],Zc(c,f)||(A.range_middle=[{after:c,before:f}])):A.range_end=[c]):f&&(A.range_start=[f],A.range_end=[f]),i&&(c&&!f&&A.disabled.push({after:RO(c,i-1),before:gc(c,i-1)}),c&&f&&A.disabled.push({after:c,before:gc(c,i-1)}),!c&&f&&A.disabled.push({after:RO(f,i-1),before:gc(f,i-1)})),x){if(c&&!f&&(A.disabled.push({before:gc(c,-x+1)}),A.disabled.push({after:gc(c,x-1)})),c&&f){var P=Gf(f,c)+1,E=x-P;A.disabled.push({before:RO(c,E)}),A.disabled.push({after:gc(f,E)})}!c&&f&&(A.disabled.push({before:gc(f,-x+1)}),A.disabled.push({after:gc(f,x-1)}))}return l.jsx(D4.Provider,{value:{selected:n,onDayClick:w,modifiers:A},children:r})}function L4(){var e=W.useContext(D4);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function AA(e){return Array.isArray(e)?Rre([],e):e!==void 0?[e]:[]}function Qze(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=AA(a)}),t}var Yh;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Yh||(Yh={}));var eFe=Yh.Selected,nm=Yh.Disabled,tFe=Yh.Hidden,rFe=Yh.Today,IO=Yh.RangeEnd,DO=Yh.RangeMiddle,LO=Yh.RangeStart,nFe=Yh.Outside;function iFe(e,t,r){var n,a=(n={},n[eFe]=AA(e.selected),n[nm]=AA(e.disabled),n[tFe]=AA(e.hidden),n[rFe]=[e.today],n[IO]=[],n[DO]=[],n[LO]=[],n[nFe]=[],n);return e.fromDate&&a[nm].push({before:e.fromDate}),e.toDate&&a[nm].push({after:e.toDate}),w2(e)?a[nm]=a[nm].concat(t.modifiers[nm]):S2(e)&&(a[nm]=a[nm].concat(r.modifiers[nm]),a[LO]=r.modifiers[LO],a[DO]=r.modifiers[DO],a[IO]=r.modifiers[IO]),a}var Fre=W.createContext(void 0);function aFe(e){var t=Qa(),r=I4(),n=L4(),a=iFe(t,r,n),c=Qze(t.modifiers),f=ui(ui({},a),c);return l.jsx(Fre.Provider,{value:f,children:e.children})}function Bre(){var e=W.useContext(Fre);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function sFe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function oFe(e){return!!(e&&typeof e=="object"&&"from"in e)}function lFe(e){return!!(e&&typeof e=="object"&&"after"in e)}function cFe(e){return!!(e&&typeof e=="object"&&"before"in e)}function uFe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function dFe(e,t){var r,n=t.from,a=t.to;if(n&&a){var c=Gf(a,n)<0;c&&(r=[a,n],n=r[0],a=r[1]);var f=Gf(e,n)>=0&&Gf(a,e)>=0;return f}return a?Zc(a,e):n?Zc(n,e):!1}function hFe(e){return k4(e)}function fFe(e){return Array.isArray(e)&&e.every(k4)}function pFe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(hFe(r))return Zc(e,r);if(fFe(r))return r.includes(e);if(oFe(r))return dFe(e,r);if(uFe(r))return r.dayOfWeek.includes(e.getDay());if(sFe(r)){var n=Gf(r.before,e),a=Gf(r.after,e),c=n>0,f=a<0,i=P3(r.before,r.after);return i?f&&c:c||f}return lFe(r)?Gf(e,r.after)>0:cFe(r)?Gf(r.before,e)>0:typeof r=="function"?r(e):!1})}function z4(e,t,r){var n=Object.keys(t).reduce(function(c,f){var i=t[f];return pFe(e,i)&&c.push(f),c},[]),a={};return n.forEach(function(c){return a[c]=!0}),r&&!O4(e,r)&&(a.outside=!0),a}function mFe(e,t){for(var r=Xc(e[0]),n=E4(e[e.length-1]),a,c,f=r;f<=n;){var i=z4(f,t),x=!i.disabled&&!i.hidden;if(!x){f=gc(f,1);continue}if(i.selected)return f;i.today&&!c&&(c=f),a||(a=f),f=gc(f,1)}return c||a}var gFe=365;function Vre(e,t){var r=t.moveBy,n=t.direction,a=t.context,c=t.modifiers,f=t.retry,i=f===void 0?{count:0,lastFocused:e}:f,x=a.weekStartsOn,w=a.fromDate,A=a.toDate,P=a.locale,E={day:gc,week:T3,month:Zh,year:i5e,startOfWeek:function($){return a.ISOWeek?Z0($):lp($,{locale:P,weekStartsOn:x})},endOfWeek:function($){return a.ISOWeek?Nre($):M4($,{locale:P,weekStartsOn:x})}},D=E[r](e,n==="after"?1:-1);n==="before"&&w?D=a5e([w,D]):n==="after"&&A&&(D=s5e([A,D]));var V=!0;if(c){var L=z4(D,c);V=!L.disabled&&!L.hidden}return V?D:i.count>gFe?i.lastFocused:Vre(D,{moveBy:r,direction:n,context:a,modifiers:c,retry:ui(ui({},i),{count:i.count+1})})}var Ure=W.createContext(void 0);function yFe(e){var t=A2(),r=Bre(),n=W.useState(),a=n[0],c=n[1],f=W.useState(),i=f[0],x=f[1],w=mFe(t.displayMonths,r),A=a??(i&&t.isDateDisplayed(i))?i:w,P=function(){x(a),c(void 0)},E=function($){c($)},D=Qa(),V=function($,H){if(a){var K=Vre(a,{moveBy:$,direction:H,context:D,modifiers:r});Zc(a,K)||(t.goToDate(K,a),E(K))}},L={focusedDay:a,focusTarget:A,blur:P,focus:E,focusDayAfter:function(){return V("day","after")},focusDayBefore:function(){return V("day","before")},focusWeekAfter:function(){return V("week","after")},focusWeekBefore:function(){return V("week","before")},focusMonthBefore:function(){return V("month","before")},focusMonthAfter:function(){return V("month","after")},focusYearBefore:function(){return V("year","before")},focusYearAfter:function(){return V("year","after")},focusStartOfWeek:function(){return V("startOfWeek","before")},focusEndOfWeek:function(){return V("endOfWeek","after")}};return l.jsx(Ure.Provider,{value:L,children:e.children})}function F4(){var e=W.useContext(Ure);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function vFe(e,t){var r=Bre(),n=z4(e,r,t);return n}var B4=W.createContext(void 0);function xFe(e){if(!kN(e.initialProps)){var t={selected:void 0};return l.jsx(B4.Provider,{value:t,children:e.children})}return l.jsx(_Fe,{initialProps:e.initialProps,children:e.children})}function _Fe(e){var t=e.initialProps,r=e.children,n=function(c,f,i){var x,w,A;if((x=t.onDayClick)===null||x===void 0||x.call(t,c,f,i),f.selected&&!t.required){(w=t.onSelect)===null||w===void 0||w.call(t,void 0,c,f,i);return}(A=t.onSelect)===null||A===void 0||A.call(t,c,c,f,i)},a={selected:t.selected,onDayClick:n};return l.jsx(B4.Provider,{value:a,children:r})}function $re(){var e=W.useContext(B4);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function bFe(e,t){var r=Qa(),n=$re(),a=I4(),c=L4(),f=F4(),i=f.focusDayAfter,x=f.focusDayBefore,w=f.focusWeekAfter,A=f.focusWeekBefore,P=f.blur,E=f.focus,D=f.focusMonthBefore,V=f.focusMonthAfter,L=f.focusYearBefore,$=f.focusYearAfter,H=f.focusStartOfWeek,K=f.focusEndOfWeek,Q=function(Re){var Fe,He,mt,Xe;kN(r)?(Fe=n.onDayClick)===null||Fe===void 0||Fe.call(n,e,t,Re):w2(r)?(He=a.onDayClick)===null||He===void 0||He.call(a,e,t,Re):S2(r)?(mt=c.onDayClick)===null||mt===void 0||mt.call(c,e,t,Re):(Xe=r.onDayClick)===null||Xe===void 0||Xe.call(r,e,t,Re)},ae=function(Re){var Fe;E(e),(Fe=r.onDayFocus)===null||Fe===void 0||Fe.call(r,e,t,Re)},ee=function(Re){var Fe;P(),(Fe=r.onDayBlur)===null||Fe===void 0||Fe.call(r,e,t,Re)},se=function(Re){var Fe;(Fe=r.onDayMouseEnter)===null||Fe===void 0||Fe.call(r,e,t,Re)},ce=function(Re){var Fe;(Fe=r.onDayMouseLeave)===null||Fe===void 0||Fe.call(r,e,t,Re)},he=function(Re){var Fe;(Fe=r.onDayPointerEnter)===null||Fe===void 0||Fe.call(r,e,t,Re)},Pe=function(Re){var Fe;(Fe=r.onDayPointerLeave)===null||Fe===void 0||Fe.call(r,e,t,Re)},Ne=function(Re){var Fe;(Fe=r.onDayTouchCancel)===null||Fe===void 0||Fe.call(r,e,t,Re)},pe=function(Re){var Fe;(Fe=r.onDayTouchEnd)===null||Fe===void 0||Fe.call(r,e,t,Re)},je=function(Re){var Fe;(Fe=r.onDayTouchMove)===null||Fe===void 0||Fe.call(r,e,t,Re)},xe=function(Re){var Fe;(Fe=r.onDayTouchStart)===null||Fe===void 0||Fe.call(r,e,t,Re)},Ce=function(Re){var Fe;(Fe=r.onDayKeyUp)===null||Fe===void 0||Fe.call(r,e,t,Re)},ze=function(Re){var Fe;switch(Re.key){case"ArrowLeft":Re.preventDefault(),Re.stopPropagation(),r.dir==="rtl"?i():x();break;case"ArrowRight":Re.preventDefault(),Re.stopPropagation(),r.dir==="rtl"?x():i();break;case"ArrowDown":Re.preventDefault(),Re.stopPropagation(),w();break;case"ArrowUp":Re.preventDefault(),Re.stopPropagation(),A();break;case"PageUp":Re.preventDefault(),Re.stopPropagation(),Re.shiftKey?L():D();break;case"PageDown":Re.preventDefault(),Re.stopPropagation(),Re.shiftKey?$():V();break;case"Home":Re.preventDefault(),Re.stopPropagation(),H();break;case"End":Re.preventDefault(),Re.stopPropagation(),K();break}(Fe=r.onDayKeyDown)===null||Fe===void 0||Fe.call(r,e,t,Re)},Te={onClick:Q,onFocus:ae,onBlur:ee,onKeyDown:ze,onKeyUp:Ce,onMouseEnter:se,onMouseLeave:ce,onPointerEnter:he,onPointerLeave:Pe,onTouchCancel:Ne,onTouchEnd:pe,onTouchMove:je,onTouchStart:xe};return Te}function wFe(){var e=Qa(),t=$re(),r=I4(),n=L4(),a=kN(e)?t.selected:w2(e)?r.selected:S2(e)?n.selected:void 0;return a}function SFe(e){return Object.values(Yh).includes(e)}function AFe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(SFe(n)){var c=e.classNames["day_".concat(n)];c&&r.push(c)}}),r}function TFe(e,t){var r=ui({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=ui(ui({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function PFe(e,t,r){var n,a,c,f=Qa(),i=F4(),x=vFe(e,t),w=bFe(e,x),A=wFe(),P=!!(f.onDayClick||f.mode!=="default");W.useEffect(function(){var se;x.outside||i.focusedDay&&P&&Zc(i.focusedDay,e)&&((se=r.current)===null||se===void 0||se.focus())},[i.focusedDay,e,r,P,x.outside]);var E=AFe(f,x).join(" "),D=TFe(f,x),V=!!(x.outside&&!f.showOutsideDays||x.hidden),L=(c=(a=f.components)===null||a===void 0?void 0:a.DayContent)!==null&&c!==void 0?c:Hze,$=l.jsx(L,{date:e,displayMonth:t,activeModifiers:x}),H={style:D,className:E,children:$,role:"gridcell"},K=i.focusTarget&&Zc(i.focusTarget,e)&&!x.outside,Q=i.focusedDay&&Zc(i.focusedDay,e),ae=ui(ui(ui({},H),(n={disabled:x.disabled,role:"gridcell"},n["aria-selected"]=x.selected,n.tabIndex=Q||K?0:-1,n)),w),ee={isButton:P,isHidden:V,activeModifiers:x,selectedDays:A,buttonProps:ae,divProps:H};return ee}function NFe(e){var t=W.useRef(null),r=PFe(e.date,e.displayMonth,t);return r.isHidden?l.jsx("div",{role:"gridcell"}):r.isButton?l.jsx(hP,ui({name:"day",ref:t},r.buttonProps)):l.jsx("div",ui({},r.divProps))}function jFe(e){var t=e.number,r=e.dates,n=Qa(),a=n.onWeekNumberClick,c=n.styles,f=n.classNames,i=n.locale,x=n.labels.labelWeekNumber,w=n.formatters.formatWeekNumber,A=w(Number(t),{locale:i});if(!a)return l.jsx("span",{className:f.weeknumber,style:c.weeknumber,children:A});var P=x(Number(t),{locale:i}),E=function(D){a(t,r,D)};return l.jsx(hP,{name:"week-number","aria-label":P,className:f.weeknumber,style:c.weeknumber,onClick:E,children:A})}function CFe(e){var t,r,n=Qa(),a=n.styles,c=n.classNames,f=n.showWeekNumber,i=n.components,x=(t=i==null?void 0:i.Day)!==null&&t!==void 0?t:NFe,w=(r=i==null?void 0:i.WeekNumber)!==null&&r!==void 0?r:jFe,A;return f&&(A=l.jsx("td",{className:c.cell,style:a.cell,children:l.jsx(w,{number:e.weekNumber,dates:e.dates})})),l.jsxs("tr",{className:c.row,style:a.row,children:[A,e.dates.map(function(P){return l.jsx("td",{className:c.cell,style:a.cell,role:"presentation",children:l.jsx(x,{displayMonth:e.displayMonth,date:P})},aze(P))})]})}function _W(e,t,r){for(var n=r!=null&&r.ISOWeek?Nre(t):M4(t,r),a=r!=null&&r.ISOWeek?Z0(e):lp(e,r),c=Gf(n,a),f=[],i=0;i<=c;i++)f.push(gc(a,i));var x=f.reduce(function(w,A){var P=r!=null&&r.ISOWeek?Cre(A):Ere(A,r),E=w.find(function(D){return D.weekNumber===P});return E?(E.dates.push(A),w):(w.push({weekNumber:P,dates:[A]}),w)},[]);return x}function kFe(e,t){var r=_W(Xc(e),E4(e),t);if(t!=null&&t.useFixedWeeks){var n=oze(e,t);if(n<6){var a=r[r.length-1],c=a.dates[a.dates.length-1],f=T3(c,6-n),i=_W(T3(c,1),f,t);r.push.apply(r,i)}}return r}function EFe(e){var t,r,n,a=Qa(),c=a.locale,f=a.classNames,i=a.styles,x=a.hideHead,w=a.fixedWeeks,A=a.components,P=a.weekStartsOn,E=a.firstWeekContainsDate,D=a.ISOWeek,V=kFe(e.displayMonth,{useFixedWeeks:!!w,ISOWeek:D,locale:c,weekStartsOn:P,firstWeekContainsDate:E}),L=(t=A==null?void 0:A.Head)!==null&&t!==void 0?t:Wze,$=(r=A==null?void 0:A.Row)!==null&&r!==void 0?r:CFe,H=(n=A==null?void 0:A.Footer)!==null&&n!==void 0?n:$ze;return l.jsxs("table",{id:e.id,className:f.table,style:i.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!x&&l.jsx(L,{}),l.jsx("tbody",{className:f.tbody,style:i.tbody,children:V.map(function(K){return l.jsx($,{displayMonth:e.displayMonth,dates:K.dates,weekNumber:K.weekNumber},K.weekNumber)})}),l.jsx(H,{displayMonth:e.displayMonth})]})}function MFe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var OFe=MFe()?W.useLayoutEffect:W.useEffect,zO=!1,RFe=0;function bW(){return"react-day-picker-".concat(++RFe)}function IFe(e){var t,r=e??(zO?bW():null),n=W.useState(r),a=n[0],c=n[1];return OFe(function(){a===null&&c(bW())},[]),W.useEffect(function(){zO===!1&&(zO=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function DFe(e){var t,r,n=Qa(),a=n.dir,c=n.classNames,f=n.styles,i=n.components,x=A2().displayMonths,w=IFe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),A=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,P=[c.month],E=f.month,D=e.displayIndex===0,V=e.displayIndex===x.length-1,L=!D&&!V;a==="rtl"&&(t=[D,V],V=t[0],D=t[1]),D&&(P.push(c.caption_start),E=ui(ui({},E),f.caption_start)),V&&(P.push(c.caption_end),E=ui(ui({},E),f.caption_end)),L&&(P.push(c.caption_between),E=ui(ui({},E),f.caption_between));var $=(r=i==null?void 0:i.Caption)!==null&&r!==void 0?r:Uze;return l.jsxs("div",{className:P.join(" "),style:E,children:[l.jsx($,{id:w,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),l.jsx(EFe,{id:A,"aria-labelledby":w,displayMonth:e.displayMonth})]},e.displayIndex)}function LFe(e){var t=Qa(),r=t.classNames,n=t.styles;return l.jsx("div",{className:r.months,style:n.months,children:e.children})}function zFe(e){var t,r,n=e.initialProps,a=Qa(),c=F4(),f=A2(),i=W.useState(!1),x=i[0],w=i[1];W.useEffect(function(){a.initialFocus&&c.focusTarget&&(x||(c.focus(c.focusTarget),w(!0)))},[a.initialFocus,x,c.focus,c.focusTarget,c]);var A=[a.classNames.root,a.className];a.numberOfMonths>1&&A.push(a.classNames.multiple_months),a.showWeekNumber&&A.push(a.classNames.with_weeknumber);var P=ui(ui({},a.styles.root),a.style),E=Object.keys(n).filter(function(V){return V.startsWith("data-")}).reduce(function(V,L){var $;return ui(ui({},V),($={},$[L]=n[L],$))},{}),D=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:LFe;return l.jsx("div",ui({className:A.join(" "),style:P,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},E,{children:l.jsx(D,{children:f.displayMonths.map(function(V,L){return l.jsx(DFe,{displayIndex:L,displayMonth:V},L)})})}))}function FFe(e){var t=e.children,r=cze(e,["children"]);return l.jsx(jze,{initialProps:r,children:l.jsx(zze,{children:l.jsx(xFe,{initialProps:r,children:l.jsx(Kze,{initialProps:r,children:l.jsx(Xze,{initialProps:r,children:l.jsx(aFe,{children:l.jsx(yFe,{children:t})})})})})})})}function BFe(e){return l.jsx(FFe,ui({},e,{children:l.jsx(zFe,{initialProps:e})}))}function Lw({className:e,classNames:t,showOutsideDays:r=!0,...n}){return l.jsx(BFe,{showOutsideDays:r,className:Ut("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-start pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ut(T1({variant:"outline"}),"h-7 w-7 bg-transparent hidden p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:Ut("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:Ut(T1({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:a,...c})=>l.jsx(Q3,{className:Ut("h-4 w-4",a),...c}),IconRight:({className:a,...c})=>l.jsx(L0,{className:Ut("h-4 w-4",a),...c})},...n})}Lw.displayName="Calendar";function VFe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,c;for(c=0;c<n.length;c++)a=n[c],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}var UFe=["color"],V4=W.forwardRef(function(e,t){var r=e.color,n=r===void 0?"currentColor":r,a=VFe(e,UFe);return W.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a,{ref:t}),W.createElement("path",{d:"M3.625 7.5C3.625 8.12132 3.12132 8.625 2.5 8.625C1.87868 8.625 1.375 8.12132 1.375 7.5C1.375 6.87868 1.87868 6.375 2.5 6.375C3.12132 6.375 3.625 6.87868 3.625 7.5ZM8.625 7.5C8.625 8.12132 8.12132 8.625 7.5 8.625C6.87868 8.625 6.375 8.12132 6.375 7.5C6.375 6.87868 6.87868 6.375 7.5 6.375C8.12132 6.375 8.625 6.87868 8.625 7.5ZM12.5 8.625C13.1213 8.625 13.625 8.12132 13.625 7.5C13.625 6.87868 13.1213 6.375 12.5 6.375C11.8787 6.375 11.375 6.87868 11.375 7.5C11.375 8.12132 11.8787 8.625 12.5 8.625Z",fill:n,fillRule:"evenodd",clipRule:"evenodd"}))}),U4="Avatar",[$Fe,y$e]=Vd(U4),[qFe,qre]=$Fe(U4),Gre=W.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[a,c]=W.useState("idle");return l.jsx(qFe,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:c,children:l.jsx(vi.span,{...n,ref:t})})});Gre.displayName=U4;var Wre="AvatarImage",Hre=W.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...c}=e,f=qre(Wre,r),i=GFe(n,c.referrerPolicy),x=Lu(w=>{a(w),f.onImageLoadingStatusChange(w)});return dl(()=>{i!=="idle"&&x(i)},[i,x]),i==="loaded"?l.jsx(vi.img,{...c,ref:t,src:n}):null});Hre.displayName=Wre;var Kre="AvatarFallback",Zre=W.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=e,c=qre(Kre,r),[f,i]=W.useState(n===void 0);return W.useEffect(()=>{if(n!==void 0){const x=window.setTimeout(()=>i(!0),n);return()=>window.clearTimeout(x)}},[n]),f&&c.imageLoadingStatus!=="loaded"?l.jsx(vi.span,{...a,ref:t}):null});Zre.displayName=Kre;function GFe(e,t){const[r,n]=W.useState("idle");return dl(()=>{if(!e){n("error");return}let a=!0;const c=new window.Image,f=i=>()=>{a&&n(i)};return n("loading"),c.onload=f("loaded"),c.onerror=f("error"),c.src=e,t&&(c.referrerPolicy=t),()=>{a=!1}},[e,t]),r}var Yre=Gre,Xre=Hre,Jre=Zre;const j3=W.forwardRef(({className:e,...t},r)=>l.jsx(Yre,{ref:r,className:Ut("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));j3.displayName=Yre.displayName;const C3=W.forwardRef(({className:e,...t},r)=>l.jsx(Xre,{ref:r,className:Ut("aspect-square h-full w-full",e),...t}));C3.displayName=Xre.displayName;const k3=W.forwardRef(({className:e,...t},r)=>l.jsx(Jre,{ref:r,className:Ut("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));k3.displayName=Jre.displayName;function $4({column:e,title:t,className:r}){return e.getCanSort()?l.jsx("div",{className:Ut("flex items-center space-x-2",r),children:l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"ghost",size:"sm",className:"-ml-3 h-8 data-[state=open]:bg-accent",children:[l.jsx("span",{children:t}),e.getIsSorted()==="desc"?l.jsx(FB,{}):e.getIsSorted()==="asc"?l.jsx(BB,{}):l.jsx(lH,{})]})}),l.jsxs(zd,{align:"start",children:[l.jsxs(Ka,{onClick:()=>e.toggleSorting(!1),children:[l.jsx(BB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Asc"]}),l.jsxs(Ka,{onClick:()=>e.toggleSorting(!0),children:[l.jsx(FB,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Desc"]}),l.jsx(_m,{}),l.jsxs(Ka,{onClick:()=>e.toggleVisibility(!1),children:[l.jsx(CA,{className:"h-3.5 w-3.5 text-muted-foreground/70"}),"Hide"]})]})]})}):l.jsx("div",{className:Ut(r),children:t})}const WFe=Vw("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function us({className:e,variant:t,...r}){return l.jsx("div",{className:Ut(WFe({variant:t}),e),...r})}var[EN,v$e]=Vd("Tooltip",[ly]),MN=ly(),Qre="TooltipProvider",HFe=700,E3="tooltip.open",[KFe,q4]=EN(Qre),ene=e=>{const{__scopeTooltip:t,delayDuration:r=HFe,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:c}=e,[f,i]=W.useState(!0),x=W.useRef(!1),w=W.useRef(0);return W.useEffect(()=>{const A=w.current;return()=>window.clearTimeout(A)},[]),l.jsx(KFe,{scope:t,isOpenDelayed:f,delayDuration:r,onOpen:W.useCallback(()=>{window.clearTimeout(w.current),i(!1)},[]),onClose:W.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>i(!0),n)},[n]),isPointerInTransitRef:x,onPointerInTransitChange:W.useCallback(A=>{x.current=A},[]),disableHoverableContent:a,children:c})};ene.displayName=Qre;var ON="Tooltip",[ZFe,T2]=EN(ON),tne=e=>{const{__scopeTooltip:t,children:r,open:n,defaultOpen:a=!1,onOpenChange:c,disableHoverableContent:f,delayDuration:i}=e,x=q4(ON,e.__scopeTooltip),w=MN(t),[A,P]=W.useState(null),E=Rd(),D=W.useRef(0),V=f??x.disableHoverableContent,L=i??x.delayDuration,$=W.useRef(!1),[H=!1,K]=Kg({prop:n,defaultProp:a,onChange:ce=>{ce?(x.onOpen(),document.dispatchEvent(new CustomEvent(E3))):x.onClose(),c==null||c(ce)}}),Q=W.useMemo(()=>H?$.current?"delayed-open":"instant-open":"closed",[H]),ae=W.useCallback(()=>{window.clearTimeout(D.current),D.current=0,$.current=!1,K(!0)},[K]),ee=W.useCallback(()=>{window.clearTimeout(D.current),D.current=0,K(!1)},[K]),se=W.useCallback(()=>{window.clearTimeout(D.current),D.current=window.setTimeout(()=>{$.current=!0,K(!0),D.current=0},L)},[L,K]);return W.useEffect(()=>()=>{D.current&&(window.clearTimeout(D.current),D.current=0)},[]),l.jsx(AP,{...w,children:l.jsx(ZFe,{scope:t,contentId:E,open:H,stateAttribute:Q,trigger:A,onTriggerChange:P,onTriggerEnter:W.useCallback(()=>{x.isOpenDelayed?se():ae()},[x.isOpenDelayed,se,ae]),onTriggerLeave:W.useCallback(()=>{V?ee():(window.clearTimeout(D.current),D.current=0)},[ee,V]),onOpen:ae,onClose:ee,disableHoverableContent:V,children:r})})};tne.displayName=ON;var M3="TooltipTrigger",rne=W.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=T2(M3,r),c=q4(M3,r),f=MN(r),i=W.useRef(null),x=Ji(t,i,a.onTriggerChange),w=W.useRef(!1),A=W.useRef(!1),P=W.useCallback(()=>w.current=!1,[]);return W.useEffect(()=>()=>document.removeEventListener("pointerup",P),[P]),l.jsx(Gw,{asChild:!0,...f,children:l.jsx(vi.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:x,onPointerMove:ln(e.onPointerMove,E=>{E.pointerType!=="touch"&&!A.current&&!c.isPointerInTransitRef.current&&(a.onTriggerEnter(),A.current=!0)}),onPointerLeave:ln(e.onPointerLeave,()=>{a.onTriggerLeave(),A.current=!1}),onPointerDown:ln(e.onPointerDown,()=>{w.current=!0,document.addEventListener("pointerup",P,{once:!0})}),onFocus:ln(e.onFocus,()=>{w.current||a.onOpen()}),onBlur:ln(e.onBlur,a.onClose),onClick:ln(e.onClick,a.onClose)})})});rne.displayName=M3;var G4="TooltipPortal",[YFe,XFe]=EN(G4,{forceMount:void 0}),nne=e=>{const{__scopeTooltip:t,forceMount:r,children:n,container:a}=e,c=T2(G4,t);return l.jsx(YFe,{scope:t,forceMount:r,children:l.jsx(Vu,{present:r||c.open,children:l.jsx(w_,{asChild:!0,container:a,children:n})})})};nne.displayName=G4;var d_="TooltipContent",ine=W.forwardRef((e,t)=>{const r=XFe(d_,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...c}=e,f=T2(d_,e.__scopeTooltip);return l.jsx(Vu,{present:n||f.open,children:f.disableHoverableContent?l.jsx(ane,{side:a,...c,ref:t}):l.jsx(JFe,{side:a,...c,ref:t})})}),JFe=W.forwardRef((e,t)=>{const r=T2(d_,e.__scopeTooltip),n=q4(d_,e.__scopeTooltip),a=W.useRef(null),c=Ji(t,a),[f,i]=W.useState(null),{trigger:x,onClose:w}=r,A=a.current,{onPointerInTransitChange:P}=n,E=W.useCallback(()=>{i(null),P(!1)},[P]),D=W.useCallback((V,L)=>{const $=V.currentTarget,H={x:V.clientX,y:V.clientY},K=rBe(H,$.getBoundingClientRect()),Q=nBe(H,K),ae=iBe(L.getBoundingClientRect()),ee=sBe([...Q,...ae]);i(ee),P(!0)},[P]);return W.useEffect(()=>()=>E(),[E]),W.useEffect(()=>{if(x&&A){const V=$=>D($,A),L=$=>D($,x);return x.addEventListener("pointerleave",V),A.addEventListener("pointerleave",L),()=>{x.removeEventListener("pointerleave",V),A.removeEventListener("pointerleave",L)}}},[x,A,D,E]),W.useEffect(()=>{if(f){const V=L=>{const $=L.target,H={x:L.clientX,y:L.clientY},K=(x==null?void 0:x.contains($))||(A==null?void 0:A.contains($)),Q=!aBe(H,f);K?E():Q&&(E(),w())};return document.addEventListener("pointermove",V),()=>document.removeEventListener("pointermove",V)}},[x,A,f,w,E]),l.jsx(ane,{...e,ref:c})}),[QFe,eBe]=EN(ON,{isInside:!1}),ane=W.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:c,onPointerDownOutside:f,...i}=e,x=T2(d_,r),w=MN(r),{onClose:A}=x;return W.useEffect(()=>(document.addEventListener(E3,A),()=>document.removeEventListener(E3,A)),[A]),W.useEffect(()=>{if(x.trigger){const P=E=>{const D=E.target;D!=null&&D.contains(x.trigger)&&A()};return window.addEventListener("scroll",P,{capture:!0}),()=>window.removeEventListener("scroll",P,{capture:!0})}},[x.trigger,A]),l.jsx(x_,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:P=>P.preventDefault(),onDismiss:A,children:l.jsxs(TP,{"data-state":x.stateAttribute,...w,...i,ref:t,style:{...i.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[l.jsx(Z3,{children:n}),l.jsx(QFe,{scope:r,isInside:!0,children:l.jsx(w4e,{id:x.contentId,role:"tooltip",children:a||n})})]})})});ine.displayName=d_;var sne="TooltipArrow",tBe=W.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=MN(r);return eBe(sne,r).isInside?null:l.jsx(PP,{...a,...n,ref:t})});tBe.displayName=sne;function rBe(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),c=Math.abs(t.left-e.x);switch(Math.min(r,n,a,c)){case c:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function nBe(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function iBe(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function aBe(e,t){const{x:r,y:n}=e;let a=!1;for(let c=0,f=t.length-1;c<t.length;f=c++){const i=t[c].x,x=t[c].y,w=t[f].x,A=t[f].y;x>n!=A>n&&r<(w-i)*(n-x)/(A-x)+i&&(a=!a)}return a}function sBe(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),oBe(t)}function oBe(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const c=t[t.length-1],f=t[t.length-2];if((c.x-f.x)*(a.y-f.y)>=(c.y-f.y)*(a.x-f.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const c=r[r.length-1],f=r[r.length-2];if((c.x-f.x)*(a.y-f.y)>=(c.y-f.y)*(a.x-f.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var lBe=ene,cBe=tne,uBe=rne,dBe=nne,one=ine;const hBe=lBe,fBe=cBe,pBe=uBe,lne=W.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(dBe,{children:l.jsx(one,{ref:n,sideOffset:t,className:Ut("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));lne.displayName=one.displayName;var mBe="Separator",wW="horizontal",gBe=["horizontal","vertical"],cne=W.forwardRef((e,t)=>{const{decorative:r,orientation:n=wW,...a}=e,c=yBe(n)?n:wW,i=r?{role:"none"}:{"aria-orientation":c==="vertical"?c:void 0,role:"separator"};return l.jsx(vi.div,{"data-orientation":c,...i,...a,ref:t})});cne.displayName=mBe;function yBe(e){return gBe.includes(e)}var une=cne;const P2=W.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},a)=>l.jsx(une,{ref:a,decorative:r,orientation:t,className:Ut("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));P2.displayName=une.displayName;const Jl=e=>new Date(e).toLocaleString("en-PH",{weekday:"long",year:"numeric",month:"long",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),vBe=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"2-digit",day:"2-digit",hour:"numeric",minute:"numeric",hour12:!0,timeZone:"Asia/Manila"}),iy=e=>new Date(e).toLocaleString("en-PH",{year:"numeric",month:"long",day:"2-digit",timeZone:"Asia/Manila"}),xBe=(e,t,r)=>[{accessorKey:"accident_id",header:"Accident ID",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("accident_id")})},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("plateNo")})},{accessorKey:"accident_date",header:"Date",cell:({row:n})=>l.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("accident_date")})},{accessorKey:"street",header:"Street",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("street")||"N/A"})},{accessorKey:"barangay",header:"Barangay",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("barangay")||"N/A"})},{accessorKey:"municipality",header:"Municipality",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("municipality")||"N/A"})},{accessorKey:"vehicle_type",header:"Vehicle Type",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("vehicle_type")||"N/A"})},{accessorKey:"severity",header:"Severity",cell:({row:n})=>{const a=n.getValue("severity"),c={minor:"text-green-600 bg-green-100",moderate:"text-yellow-600 bg-yellow-100",severe:"text-orange-600 bg-orange-100",fatal:"text-red-600 bg-red-100"};return l.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium inline-block ${c[a]||"text-gray-600 bg-gray-100"}`,children:a})}},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=f=>{f.stopPropagation(),e(a._id)};return l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"ghost",className:"h-5 w-5 p-0",children:[l.jsx("span",{className:"sr-only",children:"Open menu"}),l.jsx(V4,{className:"h-4 w-4"})]})}),l.jsxs(zd,{align:"end",className:"w-24",children:[l.jsx(S_,{className:"text-xs py-1",children:"Actions"}),l.jsx(_m,{}),l.jsxs(Ka,{onClick:c,className:"text-xs py-1",children:[l.jsx(ao,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}],_Be=e=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:t})=>l.jsx("div",{className:"",children:t.getValue("plateNo")})},{accessorKey:"ownerRepresentativeName",header:({column:t})=>l.jsx($4,{column:t,title:"Owner/Representative Name"}),cell:({row:t})=>l.jsx("div",{className:"",children:t.getValue("ownerRepresentativeName")})},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:t})=>{const r=t.getValue("hasDriversLicense"),n=t.original.driversLicenseNumber;return l.jsx("div",{className:"",children:r?l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-green-600",children:"Yes"}),n&&l.jsx("div",{className:"text-xs text-muted-foreground",children:n})]}):l.jsx("div",{className:"font-semibold text-red-600",children:"No"})})}},{accessorKey:"birthDate",header:"Birthday",cell:({row:t})=>{const r=t.getValue("birthDate");return l.jsx("div",{className:"",children:r?new Date(r).toLocaleDateString():"None"})}},{accessorKey:"contactNumber",header:"Contact Number",cell:({row:t})=>{const r=t.getValue("contactNumber");return l.jsx("div",{className:"",children:r||"None"})}},{accessorKey:"emailAddress",header:"Email Address",cell:({row:t})=>{const r=t.getValue("emailAddress");return l.jsx("div",{className:"",children:r||"None"})}},{id:"actions",enableHiding:!1,cell:({row:t})=>{const r=t.original,n=a=>{a.stopPropagation(),e(r._id)};return l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"ghost",className:"h-5 w-5 p-0",children:[l.jsx("span",{className:"sr-only",children:"Open menu"}),l.jsx(V4,{className:"h-4 w-4"})]})}),l.jsxs(zd,{align:"end",children:[l.jsx(S_,{children:"Actions"}),l.jsx(_m,{}),l.jsxs(Ka,{onClick:n,children:["Activate",l.jsx(J0,{})]})]})]})}}],bBe=(e,t,r)=>[{accessorKey:"ownerRepresentativeName",header:({column:n})=>l.jsx($4,{column:n,title:"Owner"}),cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs max-w-sm break-words whitespace-normal leading-tight",children:n.getValue("ownerRepresentativeName")}),size:300},{accessorKey:"vehicleCount",header:"No. of Vehicles",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs text-center",children:n.getValue("vehicleCount")||0}),size:80},{accessorKey:"emailAddress",header:"Email Address",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("emailAddress")||"N/A"})},{accessorKey:"province",header:"Province",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("province")||"N/A"})},{accessorKey:"municipality",header:"Municipality",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("municipality")||"N/A"})},{accessorKey:"barangay",header:"Barangay",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("barangay")||"N/A"})},{accessorKey:"birthDate",header:"Birthdate",cell:({row:n})=>{const a=n.getValue("birthDate");if(!a)return l.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"None"});const c=new Date(a);return isNaN(c.getTime())?l.jsx("div",{className:"text-red-500 text-xs",children:"Invalid Date"}):l.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:c.toLocaleDateString()})}},{accessorKey:"hasDriversLicense",header:"Driver's License",cell:({row:n})=>{const a=n.getValue("hasDriversLicense"),c=n.original.driversLicenseNumber;return l.jsx("div",{className:"",children:a?l.jsxs("div",{children:[l.jsx("div",{className:"font-semibold text-green-600 text-xs",children:"Yes"}),c&&l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:c})]}):l.jsx("div",{className:"font-semibold text-red-600 text-xs",children:"No"})})}},{id:"actions",header:"Action",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=f=>{f.stopPropagation(),e(a._id)};return l.jsx(Nr,{variant:"ghost",size:"sm",onClick:c,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600",children:l.jsx(ao,{className:"h-4 w-4"})})}}],wBe=(e,t,r)=>[{accessorKey:"topNo",header:"TOP NO.",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n.getValue("topNo")})},{accessorKey:"firstName",header:"Full Name",cell:({row:n})=>{const a=n.getValue("firstName"),c=n.original.middleInitial,f=n.original.lastName,i=n.original.suffix;if((a==="None"||!a)&&(c==="None"||!c)&&(f==="None"||!f)&&(i==="None"||!i))return l.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"None"});const x=[a];return c&&c!=="None"&&x.push(c),f&&f!=="None"&&x.push(f),i&&i!=="None"&&x.push(i),l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:x.join(" ")})}},{accessorKey:"violations",header:"Violations",cell:({row:n})=>{const a=n.getValue("violations");return l.jsx("div",{className:"max-w-xs text-xs text-gray-900 dark:text-gray-200",children:a&&a.length>0&&a[0]!=="None"?Array.isArray(a)?a.join(", "):a:"None"})}},{accessorKey:"violationType",header:"Type",cell:({row:n})=>{const a=n.getValue("violationType"),c=i=>{switch(i){case"confiscated":return"Confiscated";case"alarm":return"Alarm";case"impounded":return"Impounded";default:return"Unknown"}},f=i=>{switch(i){case"confiscated":return"bg-blue-100 text-blue-800";case"alarm":return"bg-red-100 text-red-800";case"impounded":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(a)}`,children:c(a)})}},{accessorKey:"licenseType",header:"License Type",cell:({row:n})=>{const a=n.getValue("licenseType");return l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:a&&a!=="None"&&a!=="N/A"?a:"N/A"})}},{accessorKey:"plateNo",header:"Plate No.",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("plateNo")})},{accessorKey:"dateOfApprehension",header:({column:n})=>l.jsx($4,{column:n,title:"Date of Apprehension"}),cell:({row:n})=>{const a=n.getValue("dateOfApprehension");return l.jsx("div",{className:"text-gray-700 dark:text-gray-200 text-xs",children:a?new Date(a).toLocaleDateString():"None"})}},{accessorKey:"apprehendingOfficer",header:"Officer",cell:({row:n})=>l.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200 text-xs",children:n.getValue("apprehendingOfficer")||"None"})},{id:"actions",enableHiding:!1,cell:({row:n})=>{const a=n.original,c=f=>{f.stopPropagation(),e(a._id)};return l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"ghost",className:"h-5 w-5 p-0",children:[l.jsx("span",{className:"sr-only",children:"Open menu"}),l.jsx(V4,{className:"h-4 w-4"})]})}),l.jsxs(zd,{align:"end",className:"w-24",children:[l.jsx(S_,{className:"text-xs py-1",children:"Actions"}),l.jsx(_m,{}),l.jsxs(Ka,{onClick:c,className:"text-xs py-1",children:[l.jsx(ao,{className:"h-3 w-3 mr-2"}),"Edit"]})]})]})}}],SBe=()=>[{accessorKey:"id",header:"Log ID",cell:({row:e})=>l.jsx("div",{className:"",children:e.getValue("id")})},{accessorKey:"fullname",header:"Driver",cell:({row:e})=>l.jsx("div",{className:"",children:e.getValue("fullname")})},{accessorKey:"type",header:"Type ",cell:({row:e})=>l.jsx("div",{className:"",children:e.getValue("type")})},{accessorKey:"createdAt",header:"Timestamp",cell:({row:e})=>l.jsx("div",{className:"",children:e.getValue("createdAt")})}],ABe=(e,t)=>[{accessorKey:"plateNo",header:"Plate No.",cell:({row:r})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("plateNo")})},{accessorKey:"fileNo",header:"File No.",cell:({row:r})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("fileNo")||"N/A"})},{accessorKey:"engineNo",header:"Engine No.",cell:({row:r})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("engineNo")||"N/A"})},{accessorKey:"chassisNo",header:"Chassis No.",cell:({row:r})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("chassisNo")||"N/A"})},{accessorKey:"dateOfRenewal",header:"Date of Renewal",cell:({row:r})=>{const n=r.getValue("dateOfRenewal");return l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:n?new Date(n).toLocaleDateString():"Not set"})}},{accessorKey:"classification",header:"Classification",cell:({row:r})=>l.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-200 text-xs",children:r.getValue("classification")||"N/A"})},{accessorKey:"status",header:"Status",cell:({row:r})=>{const n=r.original.status,a=r.original.expirationInfo,c=n==="1"||n===1;return l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-sm",children:[c?l.jsx(iR,{className:"h-3 w-3 text-green-600"}):l.jsx(Fg,{className:"h-3 w-3 text-red-600"}),l.jsx("span",{className:`text-xs font-medium ${c?"text-green-700":"text-red-700"}`,children:c?"Active":"Expired"})]}),a&&l.jsxs("div",{className:"text-xs text-muted-foreground px-2",children:[l.jsxs("div",{children:["Last 2 digits: ",a.lastTwoDigits]}),l.jsxs("div",{children:[a.week," week of ",a.month]}),a.expirationDate&&l.jsxs("div",{children:["Expires: ",new Date(a.expirationDate).toLocaleDateString()]})]})]})}},{id:"actions",header:"Actions",enableHiding:!1,cell:({row:r})=>{const n=r.original,a=c=>{c.stopPropagation(),e(n._id)};return l.jsx("div",{className:"flex items-center gap-1",children:l.jsxs("div",{className:"relative group",children:[l.jsx(Nr,{variant:"ghost",size:"sm",onClick:a,className:"h-8 w-8 p-0 text-gray-600 hover:bg-gray-100 hover:text-gray-700",disabled:t,children:l.jsx(ao,{className:"h-4 w-4"})}),l.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:"Edit"})]})})}}];/**
   * table-core
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function $g(e,t){return typeof e=="function"?e(t):e}function Bu(e,t){return r=>{t.setState(n=>({...n,[e]:$g(r,n[e])}))}}function RN(e){return e instanceof Function}function TBe(e){return Array.isArray(e)&&e.every(t=>typeof t=="number")}function PBe(e,t){const r=[],n=a=>{a.forEach(c=>{r.push(c);const f=t(c);f!=null&&f.length&&n(f)})};return n(e),r}function ii(e,t,r){let n=[],a;return c=>{let f;r.key&&r.debug&&(f=Date.now());const i=e(c);if(!(i.length!==n.length||i.some((A,P)=>n[P]!==A)))return a;n=i;let w;if(r.key&&r.debug&&(w=Date.now()),a=t(...i),r==null||r.onChange==null||r.onChange(a),r.key&&r.debug&&r!=null&&r.debug()){const A=Math.round((Date.now()-f)*100)/100,P=Math.round((Date.now()-w)*100)/100,E=P/16,D=(V,L)=>{for(V=String(V);V.length<L;)V=" "+V;return V};console.info(`%c⏱ ${D(P,5)} /${D(A,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*E,120))}deg 100% 31%);`,r==null?void 0:r.key)}return a}}function ai(e,t,r,n){return{debug:()=>{var a;return(a=e==null?void 0:e.debugAll)!=null?a:e[t]},key:!1,onChange:n}}function NBe(e,t,r,n){const a=()=>{var f;return(f=c.getValue())!=null?f:e.options.renderFallbackValue},c={id:`${t.id}_${r.id}`,row:t,column:r,getValue:()=>t.getValue(n),renderValue:a,getContext:ii(()=>[e,r,t,c],(f,i,x,w)=>({table:f,column:i,row:x,cell:w,getValue:w.getValue,renderValue:w.renderValue}),ai(e.options,"debugCells"))};return e._features.forEach(f=>{f.createCell==null||f.createCell(c,r,t,e)},{}),c}function jBe(e,t,r,n){var a,c;const i={...e._getDefaultColumnDef(),...t},x=i.accessorKey;let w=(a=(c=i.id)!=null?c:x?typeof String.prototype.replaceAll=="function"?x.replaceAll(".","_"):x.replace(/\./g,"_"):void 0)!=null?a:typeof i.header=="string"?i.header:void 0,A;if(i.accessorFn?A=i.accessorFn:x&&(x.includes(".")?A=E=>{let D=E;for(const L of x.split(".")){var V;D=(V=D)==null?void 0:V[L]}return D}:A=E=>E[i.accessorKey]),!w)throw new Error;let P={id:`${String(w)}`,accessorFn:A,parent:n,depth:r,columnDef:i,columns:[],getFlatColumns:ii(()=>[!0],()=>{var E;return[P,...(E=P.columns)==null?void 0:E.flatMap(D=>D.getFlatColumns())]},ai(e.options,"debugColumns")),getLeafColumns:ii(()=>[e._getOrderColumnsFn()],E=>{var D;if((D=P.columns)!=null&&D.length){let V=P.columns.flatMap(L=>L.getLeafColumns());return E(V)}return[P]},ai(e.options,"debugColumns"))};for(const E of e._features)E.createColumn==null||E.createColumn(P,e);return P}const Gl="debugHeaders";function SW(e,t,r){var n;let c={id:(n=r.id)!=null?n:t.id,column:t,index:r.index,isPlaceholder:!!r.isPlaceholder,placeholderId:r.placeholderId,depth:r.depth,subHeaders:[],colSpan:0,rowSpan:0,headerGroup:null,getLeafHeaders:()=>{const f=[],i=x=>{x.subHeaders&&x.subHeaders.length&&x.subHeaders.map(i),f.push(x)};return i(c),f},getContext:()=>({table:e,header:c,column:t})};return e._features.forEach(f=>{f.createHeader==null||f.createHeader(c,e)}),c}const CBe={createTable:e=>{e.getHeaderGroups=ii(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>{var c,f;const i=(c=n==null?void 0:n.map(P=>r.find(E=>E.id===P)).filter(Boolean))!=null?c:[],x=(f=a==null?void 0:a.map(P=>r.find(E=>E.id===P)).filter(Boolean))!=null?f:[],w=r.filter(P=>!(n!=null&&n.includes(P.id))&&!(a!=null&&a.includes(P.id)));return tA(t,[...i,...w,...x],e)},ai(e.options,Gl)),e.getCenterHeaderGroups=ii(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n,a)=>(r=r.filter(c=>!(n!=null&&n.includes(c.id))&&!(a!=null&&a.includes(c.id))),tA(t,r,e,"center")),ai(e.options,Gl)),e.getLeftHeaderGroups=ii(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.left],(t,r,n)=>{var a;const c=(a=n==null?void 0:n.map(f=>r.find(i=>i.id===f)).filter(Boolean))!=null?a:[];return tA(t,c,e,"left")},ai(e.options,Gl)),e.getRightHeaderGroups=ii(()=>[e.getAllColumns(),e.getVisibleLeafColumns(),e.getState().columnPinning.right],(t,r,n)=>{var a;const c=(a=n==null?void 0:n.map(f=>r.find(i=>i.id===f)).filter(Boolean))!=null?a:[];return tA(t,c,e,"right")},ai(e.options,Gl)),e.getFooterGroups=ii(()=>[e.getHeaderGroups()],t=>[...t].reverse(),ai(e.options,Gl)),e.getLeftFooterGroups=ii(()=>[e.getLeftHeaderGroups()],t=>[...t].reverse(),ai(e.options,Gl)),e.getCenterFooterGroups=ii(()=>[e.getCenterHeaderGroups()],t=>[...t].reverse(),ai(e.options,Gl)),e.getRightFooterGroups=ii(()=>[e.getRightHeaderGroups()],t=>[...t].reverse(),ai(e.options,Gl)),e.getFlatHeaders=ii(()=>[e.getHeaderGroups()],t=>t.map(r=>r.headers).flat(),ai(e.options,Gl)),e.getLeftFlatHeaders=ii(()=>[e.getLeftHeaderGroups()],t=>t.map(r=>r.headers).flat(),ai(e.options,Gl)),e.getCenterFlatHeaders=ii(()=>[e.getCenterHeaderGroups()],t=>t.map(r=>r.headers).flat(),ai(e.options,Gl)),e.getRightFlatHeaders=ii(()=>[e.getRightHeaderGroups()],t=>t.map(r=>r.headers).flat(),ai(e.options,Gl)),e.getCenterLeafHeaders=ii(()=>[e.getCenterFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ai(e.options,Gl)),e.getLeftLeafHeaders=ii(()=>[e.getLeftFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ai(e.options,Gl)),e.getRightLeafHeaders=ii(()=>[e.getRightFlatHeaders()],t=>t.filter(r=>{var n;return!((n=r.subHeaders)!=null&&n.length)}),ai(e.options,Gl)),e.getLeafHeaders=ii(()=>[e.getLeftHeaderGroups(),e.getCenterHeaderGroups(),e.getRightHeaderGroups()],(t,r,n)=>{var a,c,f,i,x,w;return[...(a=(c=t[0])==null?void 0:c.headers)!=null?a:[],...(f=(i=r[0])==null?void 0:i.headers)!=null?f:[],...(x=(w=n[0])==null?void 0:w.headers)!=null?x:[]].map(A=>A.getLeafHeaders()).flat()},ai(e.options,Gl))}};function tA(e,t,r,n){var a,c;let f=0;const i=function(E,D){D===void 0&&(D=1),f=Math.max(f,D),E.filter(V=>V.getIsVisible()).forEach(V=>{var L;(L=V.columns)!=null&&L.length&&i(V.columns,D+1)},0)};i(e);let x=[];const w=(E,D)=>{const V={depth:D,id:[n,`${D}`].filter(Boolean).join("_"),headers:[]},L=[];E.forEach($=>{const H=[...L].reverse()[0],K=$.column.depth===V.depth;let Q,ae=!1;if(K&&$.column.parent?Q=$.column.parent:(Q=$.column,ae=!0),H&&(H==null?void 0:H.column)===Q)H.subHeaders.push($);else{const ee=SW(r,Q,{id:[n,D,Q.id,$==null?void 0:$.id].filter(Boolean).join("_"),isPlaceholder:ae,placeholderId:ae?`${L.filter(se=>se.column===Q).length}`:void 0,depth:D,index:L.length});ee.subHeaders.push($),L.push(ee)}V.headers.push($),$.headerGroup=V}),x.push(V),D>0&&w(L,D-1)},A=t.map((E,D)=>SW(r,E,{depth:f,index:D}));w(A,f-1),x.reverse();const P=E=>E.filter(V=>V.column.getIsVisible()).map(V=>{let L=0,$=0,H=[0];V.subHeaders&&V.subHeaders.length?(H=[],P(V.subHeaders).forEach(Q=>{let{colSpan:ae,rowSpan:ee}=Q;L+=ae,H.push(ee)})):L=1;const K=Math.min(...H);return $=$+K,V.colSpan=L,V.rowSpan=$,{colSpan:L,rowSpan:$}});return P((a=(c=x[0])==null?void 0:c.headers)!=null?a:[]),x}const W4=(e,t,r,n,a,c,f)=>{let i={id:t,index:n,original:r,depth:a,parentId:f,_valuesCache:{},_uniqueValuesCache:{},getValue:x=>{if(i._valuesCache.hasOwnProperty(x))return i._valuesCache[x];const w=e.getColumn(x);if(w!=null&&w.accessorFn)return i._valuesCache[x]=w.accessorFn(i.original,n),i._valuesCache[x]},getUniqueValues:x=>{if(i._uniqueValuesCache.hasOwnProperty(x))return i._uniqueValuesCache[x];const w=e.getColumn(x);if(w!=null&&w.accessorFn)return w.columnDef.getUniqueValues?(i._uniqueValuesCache[x]=w.columnDef.getUniqueValues(i.original,n),i._uniqueValuesCache[x]):(i._uniqueValuesCache[x]=[i.getValue(x)],i._uniqueValuesCache[x])},renderValue:x=>{var w;return(w=i.getValue(x))!=null?w:e.options.renderFallbackValue},subRows:[],getLeafRows:()=>PBe(i.subRows,x=>x.subRows),getParentRow:()=>i.parentId?e.getRow(i.parentId,!0):void 0,getParentRows:()=>{let x=[],w=i;for(;;){const A=w.getParentRow();if(!A)break;x.push(A),w=A}return x.reverse()},getAllCells:ii(()=>[e.getAllLeafColumns()],x=>x.map(w=>NBe(e,i,w,w.id)),ai(e.options,"debugRows")),_getAllCellsByColumnId:ii(()=>[i.getAllCells()],x=>x.reduce((w,A)=>(w[A.column.id]=A,w),{}),ai(e.options,"debugRows"))};for(let x=0;x<e._features.length;x++){const w=e._features[x];w==null||w.createRow==null||w.createRow(i,e)}return i},kBe={createColumn:(e,t)=>{e._getFacetedRowModel=t.options.getFacetedRowModel&&t.options.getFacetedRowModel(t,e.id),e.getFacetedRowModel=()=>e._getFacetedRowModel?e._getFacetedRowModel():t.getPreFilteredRowModel(),e._getFacetedUniqueValues=t.options.getFacetedUniqueValues&&t.options.getFacetedUniqueValues(t,e.id),e.getFacetedUniqueValues=()=>e._getFacetedUniqueValues?e._getFacetedUniqueValues():new Map,e._getFacetedMinMaxValues=t.options.getFacetedMinMaxValues&&t.options.getFacetedMinMaxValues(t,e.id),e.getFacetedMinMaxValues=()=>{if(e._getFacetedMinMaxValues)return e._getFacetedMinMaxValues()}}},dne=(e,t,r)=>{var n,a;const c=r==null||(n=r.toString())==null?void 0:n.toLowerCase();return!!(!((a=e.getValue(t))==null||(a=a.toString())==null||(a=a.toLowerCase())==null)&&a.includes(c))};dne.autoRemove=e=>Uh(e);const hne=(e,t,r)=>{var n;return!!(!((n=e.getValue(t))==null||(n=n.toString())==null)&&n.includes(r))};hne.autoRemove=e=>Uh(e);const fne=(e,t,r)=>{var n;return((n=e.getValue(t))==null||(n=n.toString())==null?void 0:n.toLowerCase())===(r==null?void 0:r.toLowerCase())};fne.autoRemove=e=>Uh(e);const pne=(e,t,r)=>{var n;return(n=e.getValue(t))==null?void 0:n.includes(r)};pne.autoRemove=e=>Uh(e);const mne=(e,t,r)=>!r.some(n=>{var a;return!((a=e.getValue(t))!=null&&a.includes(n))});mne.autoRemove=e=>Uh(e)||!(e!=null&&e.length);const gne=(e,t,r)=>r.some(n=>{var a;return(a=e.getValue(t))==null?void 0:a.includes(n)});gne.autoRemove=e=>Uh(e)||!(e!=null&&e.length);const yne=(e,t,r)=>e.getValue(t)===r;yne.autoRemove=e=>Uh(e);const vne=(e,t,r)=>e.getValue(t)==r;vne.autoRemove=e=>Uh(e);const H4=(e,t,r)=>{let[n,a]=r;const c=e.getValue(t);return c>=n&&c<=a};H4.resolveFilterValue=e=>{let[t,r]=e,n=typeof t!="number"?parseFloat(t):t,a=typeof r!="number"?parseFloat(r):r,c=t===null||Number.isNaN(n)?-1/0:n,f=r===null||Number.isNaN(a)?1/0:a;if(c>f){const i=c;c=f,f=i}return[c,f]};H4.autoRemove=e=>Uh(e)||Uh(e[0])&&Uh(e[1]);const om={includesString:dne,includesStringSensitive:hne,equalsString:fne,arrIncludes:pne,arrIncludesAll:mne,arrIncludesSome:gne,equals:yne,weakEquals:vne,inNumberRange:H4};function Uh(e){return e==null||e===""}const EBe={getDefaultColumnDef:()=>({filterFn:"auto"}),getInitialState:e=>({columnFilters:[],...e}),getDefaultOptions:e=>({onColumnFiltersChange:Bu("columnFilters",e),filterFromLeafRows:!1,maxLeafRowFilterDepth:100}),createColumn:(e,t)=>{e.getAutoFilterFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);return typeof n=="string"?om.includesString:typeof n=="number"?om.inNumberRange:typeof n=="boolean"||n!==null&&typeof n=="object"?om.equals:Array.isArray(n)?om.arrIncludes:om.weakEquals},e.getFilterFn=()=>{var r,n;return RN(e.columnDef.filterFn)?e.columnDef.filterFn:e.columnDef.filterFn==="auto"?e.getAutoFilterFn():(r=(n=t.options.filterFns)==null?void 0:n[e.columnDef.filterFn])!=null?r:om[e.columnDef.filterFn]},e.getCanFilter=()=>{var r,n,a;return((r=e.columnDef.enableColumnFilter)!=null?r:!0)&&((n=t.options.enableColumnFilters)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&!!e.accessorFn},e.getIsFiltered=()=>e.getFilterIndex()>-1,e.getFilterValue=()=>{var r;return(r=t.getState().columnFilters)==null||(r=r.find(n=>n.id===e.id))==null?void 0:r.value},e.getFilterIndex=()=>{var r,n;return(r=(n=t.getState().columnFilters)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.setFilterValue=r=>{t.setColumnFilters(n=>{const a=e.getFilterFn(),c=n==null?void 0:n.find(A=>A.id===e.id),f=$g(r,c?c.value:void 0);if(AW(a,f,e)){var i;return(i=n==null?void 0:n.filter(A=>A.id!==e.id))!=null?i:[]}const x={id:e.id,value:f};if(c){var w;return(w=n==null?void 0:n.map(A=>A.id===e.id?x:A))!=null?w:[]}return n!=null&&n.length?[...n,x]:[x]})}},createRow:(e,t)=>{e.columnFilters={},e.columnFiltersMeta={}},createTable:e=>{e.setColumnFilters=t=>{const r=e.getAllLeafColumns(),n=a=>{var c;return(c=$g(t,a))==null?void 0:c.filter(f=>{const i=r.find(x=>x.id===f.id);if(i){const x=i.getFilterFn();if(AW(x,f.value,i))return!1}return!0})};e.options.onColumnFiltersChange==null||e.options.onColumnFiltersChange(n)},e.resetColumnFilters=t=>{var r,n;e.setColumnFilters(t?[]:(r=(n=e.initialState)==null?void 0:n.columnFilters)!=null?r:[])},e.getPreFilteredRowModel=()=>e.getCoreRowModel(),e.getFilteredRowModel=()=>(!e._getFilteredRowModel&&e.options.getFilteredRowModel&&(e._getFilteredRowModel=e.options.getFilteredRowModel(e)),e.options.manualFiltering||!e._getFilteredRowModel?e.getPreFilteredRowModel():e._getFilteredRowModel())}};function AW(e,t,r){return(e&&e.autoRemove?e.autoRemove(t,r):!1)||typeof t>"u"||typeof t=="string"&&!t}const MBe=(e,t,r)=>r.reduce((n,a)=>{const c=a.getValue(e);return n+(typeof c=="number"?c:0)},0),OBe=(e,t,r)=>{let n;return r.forEach(a=>{const c=a.getValue(e);c!=null&&(n>c||n===void 0&&c>=c)&&(n=c)}),n},RBe=(e,t,r)=>{let n;return r.forEach(a=>{const c=a.getValue(e);c!=null&&(n<c||n===void 0&&c>=c)&&(n=c)}),n},IBe=(e,t,r)=>{let n,a;return r.forEach(c=>{const f=c.getValue(e);f!=null&&(n===void 0?f>=f&&(n=a=f):(n>f&&(n=f),a<f&&(a=f)))}),[n,a]},DBe=(e,t)=>{let r=0,n=0;if(t.forEach(a=>{let c=a.getValue(e);c!=null&&(c=+c)>=c&&(++r,n+=c)}),r)return n/r},LBe=(e,t)=>{if(!t.length)return;const r=t.map(c=>c.getValue(e));if(!TBe(r))return;if(r.length===1)return r[0];const n=Math.floor(r.length/2),a=r.sort((c,f)=>c-f);return r.length%2!==0?a[n]:(a[n-1]+a[n])/2},zBe=(e,t)=>Array.from(new Set(t.map(r=>r.getValue(e))).values()),FBe=(e,t)=>new Set(t.map(r=>r.getValue(e))).size,BBe=(e,t)=>t.length,FO={sum:MBe,min:OBe,max:RBe,extent:IBe,mean:DBe,median:LBe,unique:zBe,uniqueCount:FBe,count:BBe},VBe={getDefaultColumnDef:()=>({aggregatedCell:e=>{var t,r;return(t=(r=e.getValue())==null||r.toString==null?void 0:r.toString())!=null?t:null},aggregationFn:"auto"}),getInitialState:e=>({grouping:[],...e}),getDefaultOptions:e=>({onGroupingChange:Bu("grouping",e),groupedColumnMode:"reorder"}),createColumn:(e,t)=>{e.toggleGrouping=()=>{t.setGrouping(r=>r!=null&&r.includes(e.id)?r.filter(n=>n!==e.id):[...r??[],e.id])},e.getCanGroup=()=>{var r,n;return((r=e.columnDef.enableGrouping)!=null?r:!0)&&((n=t.options.enableGrouping)!=null?n:!0)&&(!!e.accessorFn||!!e.columnDef.getGroupingValue)},e.getIsGrouped=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.includes(e.id)},e.getGroupedIndex=()=>{var r;return(r=t.getState().grouping)==null?void 0:r.indexOf(e.id)},e.getToggleGroupingHandler=()=>{const r=e.getCanGroup();return()=>{r&&e.toggleGrouping()}},e.getAutoAggregationFn=()=>{const r=t.getCoreRowModel().flatRows[0],n=r==null?void 0:r.getValue(e.id);if(typeof n=="number")return FO.sum;if(Object.prototype.toString.call(n)==="[object Date]")return FO.extent},e.getAggregationFn=()=>{var r,n;if(!e)throw new Error;return RN(e.columnDef.aggregationFn)?e.columnDef.aggregationFn:e.columnDef.aggregationFn==="auto"?e.getAutoAggregationFn():(r=(n=t.options.aggregationFns)==null?void 0:n[e.columnDef.aggregationFn])!=null?r:FO[e.columnDef.aggregationFn]}},createTable:e=>{e.setGrouping=t=>e.options.onGroupingChange==null?void 0:e.options.onGroupingChange(t),e.resetGrouping=t=>{var r,n;e.setGrouping(t?[]:(r=(n=e.initialState)==null?void 0:n.grouping)!=null?r:[])},e.getPreGroupedRowModel=()=>e.getFilteredRowModel(),e.getGroupedRowModel=()=>(!e._getGroupedRowModel&&e.options.getGroupedRowModel&&(e._getGroupedRowModel=e.options.getGroupedRowModel(e)),e.options.manualGrouping||!e._getGroupedRowModel?e.getPreGroupedRowModel():e._getGroupedRowModel())},createRow:(e,t)=>{e.getIsGrouped=()=>!!e.groupingColumnId,e.getGroupingValue=r=>{if(e._groupingValuesCache.hasOwnProperty(r))return e._groupingValuesCache[r];const n=t.getColumn(r);return n!=null&&n.columnDef.getGroupingValue?(e._groupingValuesCache[r]=n.columnDef.getGroupingValue(e.original),e._groupingValuesCache[r]):e.getValue(r)},e._groupingValuesCache={}},createCell:(e,t,r,n)=>{e.getIsGrouped=()=>t.getIsGrouped()&&t.id===r.groupingColumnId,e.getIsPlaceholder=()=>!e.getIsGrouped()&&t.getIsGrouped(),e.getIsAggregated=()=>{var a;return!e.getIsGrouped()&&!e.getIsPlaceholder()&&!!((a=r.subRows)!=null&&a.length)}}};function UBe(e,t,r){if(!(t!=null&&t.length)||!r)return e;const n=e.filter(c=>!t.includes(c.id));return r==="remove"?n:[...t.map(c=>e.find(f=>f.id===c)).filter(Boolean),...n]}const $Be={getInitialState:e=>({columnOrder:[],...e}),getDefaultOptions:e=>({onColumnOrderChange:Bu("columnOrder",e)}),createColumn:(e,t)=>{e.getIndex=ii(r=>[S1(t,r)],r=>r.findIndex(n=>n.id===e.id),ai(t.options,"debugColumns")),e.getIsFirstColumn=r=>{var n;return((n=S1(t,r)[0])==null?void 0:n.id)===e.id},e.getIsLastColumn=r=>{var n;const a=S1(t,r);return((n=a[a.length-1])==null?void 0:n.id)===e.id}},createTable:e=>{e.setColumnOrder=t=>e.options.onColumnOrderChange==null?void 0:e.options.onColumnOrderChange(t),e.resetColumnOrder=t=>{var r;e.setColumnOrder(t?[]:(r=e.initialState.columnOrder)!=null?r:[])},e._getOrderColumnsFn=ii(()=>[e.getState().columnOrder,e.getState().grouping,e.options.groupedColumnMode],(t,r,n)=>a=>{let c=[];if(!(t!=null&&t.length))c=a;else{const f=[...t],i=[...a];for(;i.length&&f.length;){const x=f.shift(),w=i.findIndex(A=>A.id===x);w>-1&&c.push(i.splice(w,1)[0])}c=[...c,...i]}return UBe(c,r,n)},ai(e.options,"debugTable"))}},BO=()=>({left:[],right:[]}),qBe={getInitialState:e=>({columnPinning:BO(),...e}),getDefaultOptions:e=>({onColumnPinningChange:Bu("columnPinning",e)}),createColumn:(e,t)=>{e.pin=r=>{const n=e.getLeafColumns().map(a=>a.id).filter(Boolean);t.setColumnPinning(a=>{var c,f;if(r==="right"){var i,x;return{left:((i=a==null?void 0:a.left)!=null?i:[]).filter(P=>!(n!=null&&n.includes(P))),right:[...((x=a==null?void 0:a.right)!=null?x:[]).filter(P=>!(n!=null&&n.includes(P))),...n]}}if(r==="left"){var w,A;return{left:[...((w=a==null?void 0:a.left)!=null?w:[]).filter(P=>!(n!=null&&n.includes(P))),...n],right:((A=a==null?void 0:a.right)!=null?A:[]).filter(P=>!(n!=null&&n.includes(P)))}}return{left:((c=a==null?void 0:a.left)!=null?c:[]).filter(P=>!(n!=null&&n.includes(P))),right:((f=a==null?void 0:a.right)!=null?f:[]).filter(P=>!(n!=null&&n.includes(P)))}})},e.getCanPin=()=>e.getLeafColumns().some(n=>{var a,c,f;return((a=n.columnDef.enablePinning)!=null?a:!0)&&((c=(f=t.options.enableColumnPinning)!=null?f:t.options.enablePinning)!=null?c:!0)}),e.getIsPinned=()=>{const r=e.getLeafColumns().map(i=>i.id),{left:n,right:a}=t.getState().columnPinning,c=r.some(i=>n==null?void 0:n.includes(i)),f=r.some(i=>a==null?void 0:a.includes(i));return c?"left":f?"right":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();return a?(r=(n=t.getState().columnPinning)==null||(n=n[a])==null?void 0:n.indexOf(e.id))!=null?r:-1:0}},createRow:(e,t)=>{e.getCenterVisibleCells=ii(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left,t.getState().columnPinning.right],(r,n,a)=>{const c=[...n??[],...a??[]];return r.filter(f=>!c.includes(f.column.id))},ai(t.options,"debugRows")),e.getLeftVisibleCells=ii(()=>[e._getAllVisibleCells(),t.getState().columnPinning.left],(r,n)=>(n??[]).map(c=>r.find(f=>f.column.id===c)).filter(Boolean).map(c=>({...c,position:"left"})),ai(t.options,"debugRows")),e.getRightVisibleCells=ii(()=>[e._getAllVisibleCells(),t.getState().columnPinning.right],(r,n)=>(n??[]).map(c=>r.find(f=>f.column.id===c)).filter(Boolean).map(c=>({...c,position:"right"})),ai(t.options,"debugRows"))},createTable:e=>{e.setColumnPinning=t=>e.options.onColumnPinningChange==null?void 0:e.options.onColumnPinningChange(t),e.resetColumnPinning=t=>{var r,n;return e.setColumnPinning(t?BO():(r=(n=e.initialState)==null?void 0:n.columnPinning)!=null?r:BO())},e.getIsSomeColumnsPinned=t=>{var r;const n=e.getState().columnPinning;if(!t){var a,c;return!!((a=n.left)!=null&&a.length||(c=n.right)!=null&&c.length)}return!!((r=n[t])!=null&&r.length)},e.getLeftLeafColumns=ii(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ai(e.options,"debugColumns")),e.getRightLeafColumns=ii(()=>[e.getAllLeafColumns(),e.getState().columnPinning.right],(t,r)=>(r??[]).map(n=>t.find(a=>a.id===n)).filter(Boolean),ai(e.options,"debugColumns")),e.getCenterLeafColumns=ii(()=>[e.getAllLeafColumns(),e.getState().columnPinning.left,e.getState().columnPinning.right],(t,r,n)=>{const a=[...r??[],...n??[]];return t.filter(c=>!a.includes(c.id))},ai(e.options,"debugColumns"))}},rA={size:150,minSize:20,maxSize:Number.MAX_SAFE_INTEGER},VO=()=>({startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,isResizingColumn:!1,columnSizingStart:[]}),GBe={getDefaultColumnDef:()=>rA,getInitialState:e=>({columnSizing:{},columnSizingInfo:VO(),...e}),getDefaultOptions:e=>({columnResizeMode:"onEnd",columnResizeDirection:"ltr",onColumnSizingChange:Bu("columnSizing",e),onColumnSizingInfoChange:Bu("columnSizingInfo",e)}),createColumn:(e,t)=>{e.getSize=()=>{var r,n,a;const c=t.getState().columnSizing[e.id];return Math.min(Math.max((r=e.columnDef.minSize)!=null?r:rA.minSize,(n=c??e.columnDef.size)!=null?n:rA.size),(a=e.columnDef.maxSize)!=null?a:rA.maxSize)},e.getStart=ii(r=>[r,S1(t,r),t.getState().columnSizing],(r,n)=>n.slice(0,e.getIndex(r)).reduce((a,c)=>a+c.getSize(),0),ai(t.options,"debugColumns")),e.getAfter=ii(r=>[r,S1(t,r),t.getState().columnSizing],(r,n)=>n.slice(e.getIndex(r)+1).reduce((a,c)=>a+c.getSize(),0),ai(t.options,"debugColumns")),e.resetSize=()=>{t.setColumnSizing(r=>{let{[e.id]:n,...a}=r;return a})},e.getCanResize=()=>{var r,n;return((r=e.columnDef.enableResizing)!=null?r:!0)&&((n=t.options.enableColumnResizing)!=null?n:!0)},e.getIsResizing=()=>t.getState().columnSizingInfo.isResizingColumn===e.id},createHeader:(e,t)=>{e.getSize=()=>{let r=0;const n=a=>{if(a.subHeaders.length)a.subHeaders.forEach(n);else{var c;r+=(c=a.column.getSize())!=null?c:0}};return n(e),r},e.getStart=()=>{if(e.index>0){const r=e.headerGroup.headers[e.index-1];return r.getStart()+r.getSize()}return 0},e.getResizeHandler=r=>{const n=t.getColumn(e.column.id),a=n==null?void 0:n.getCanResize();return c=>{if(!n||!a||(c.persist==null||c.persist(),UO(c)&&c.touches&&c.touches.length>1))return;const f=e.getSize(),i=e?e.getLeafHeaders().map(H=>[H.column.id,H.column.getSize()]):[[n.id,n.getSize()]],x=UO(c)?Math.round(c.touches[0].clientX):c.clientX,w={},A=(H,K)=>{typeof K=="number"&&(t.setColumnSizingInfo(Q=>{var ae,ee;const se=t.options.columnResizeDirection==="rtl"?-1:1,ce=(K-((ae=Q==null?void 0:Q.startOffset)!=null?ae:0))*se,he=Math.max(ce/((ee=Q==null?void 0:Q.startSize)!=null?ee:0),-.999999);return Q.columnSizingStart.forEach(Pe=>{let[Ne,pe]=Pe;w[Ne]=Math.round(Math.max(pe+pe*he,0)*100)/100}),{...Q,deltaOffset:ce,deltaPercentage:he}}),(t.options.columnResizeMode==="onChange"||H==="end")&&t.setColumnSizing(Q=>({...Q,...w})))},P=H=>A("move",H),E=H=>{A("end",H),t.setColumnSizingInfo(K=>({...K,isResizingColumn:!1,startOffset:null,startSize:null,deltaOffset:null,deltaPercentage:null,columnSizingStart:[]}))},D=r||typeof document<"u"?document:null,V={moveHandler:H=>P(H.clientX),upHandler:H=>{D==null||D.removeEventListener("mousemove",V.moveHandler),D==null||D.removeEventListener("mouseup",V.upHandler),E(H.clientX)}},L={moveHandler:H=>(H.cancelable&&(H.preventDefault(),H.stopPropagation()),P(H.touches[0].clientX),!1),upHandler:H=>{var K;D==null||D.removeEventListener("touchmove",L.moveHandler),D==null||D.removeEventListener("touchend",L.upHandler),H.cancelable&&(H.preventDefault(),H.stopPropagation()),E((K=H.touches[0])==null?void 0:K.clientX)}},$=WBe()?{passive:!1}:!1;UO(c)?(D==null||D.addEventListener("touchmove",L.moveHandler,$),D==null||D.addEventListener("touchend",L.upHandler,$)):(D==null||D.addEventListener("mousemove",V.moveHandler,$),D==null||D.addEventListener("mouseup",V.upHandler,$)),t.setColumnSizingInfo(H=>({...H,startOffset:x,startSize:f,deltaOffset:0,deltaPercentage:0,columnSizingStart:i,isResizingColumn:n.id}))}}},createTable:e=>{e.setColumnSizing=t=>e.options.onColumnSizingChange==null?void 0:e.options.onColumnSizingChange(t),e.setColumnSizingInfo=t=>e.options.onColumnSizingInfoChange==null?void 0:e.options.onColumnSizingInfoChange(t),e.resetColumnSizing=t=>{var r;e.setColumnSizing(t?{}:(r=e.initialState.columnSizing)!=null?r:{})},e.resetHeaderSizeInfo=t=>{var r;e.setColumnSizingInfo(t?VO():(r=e.initialState.columnSizingInfo)!=null?r:VO())},e.getTotalSize=()=>{var t,r;return(t=(r=e.getHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getLeftTotalSize=()=>{var t,r;return(t=(r=e.getLeftHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getCenterTotalSize=()=>{var t,r;return(t=(r=e.getCenterHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0},e.getRightTotalSize=()=>{var t,r;return(t=(r=e.getRightHeaderGroups()[0])==null?void 0:r.headers.reduce((n,a)=>n+a.getSize(),0))!=null?t:0}}};let nA=null;function WBe(){if(typeof nA=="boolean")return nA;let e=!1;try{const t={get passive(){return e=!0,!1}},r=()=>{};window.addEventListener("test",r,t),window.removeEventListener("test",r)}catch{e=!1}return nA=e,nA}function UO(e){return e.type==="touchstart"}const HBe={getInitialState:e=>({columnVisibility:{},...e}),getDefaultOptions:e=>({onColumnVisibilityChange:Bu("columnVisibility",e)}),createColumn:(e,t)=>{e.toggleVisibility=r=>{e.getCanHide()&&t.setColumnVisibility(n=>({...n,[e.id]:r??!e.getIsVisible()}))},e.getIsVisible=()=>{var r,n;const a=e.columns;return(r=a.length?a.some(c=>c.getIsVisible()):(n=t.getState().columnVisibility)==null?void 0:n[e.id])!=null?r:!0},e.getCanHide=()=>{var r,n;return((r=e.columnDef.enableHiding)!=null?r:!0)&&((n=t.options.enableHiding)!=null?n:!0)},e.getToggleVisibilityHandler=()=>r=>{e.toggleVisibility==null||e.toggleVisibility(r.target.checked)}},createRow:(e,t)=>{e._getAllVisibleCells=ii(()=>[e.getAllCells(),t.getState().columnVisibility],r=>r.filter(n=>n.column.getIsVisible()),ai(t.options,"debugRows")),e.getVisibleCells=ii(()=>[e.getLeftVisibleCells(),e.getCenterVisibleCells(),e.getRightVisibleCells()],(r,n,a)=>[...r,...n,...a],ai(t.options,"debugRows"))},createTable:e=>{const t=(r,n)=>ii(()=>[n(),n().filter(a=>a.getIsVisible()).map(a=>a.id).join("_")],a=>a.filter(c=>c.getIsVisible==null?void 0:c.getIsVisible()),ai(e.options,"debugColumns"));e.getVisibleFlatColumns=t("getVisibleFlatColumns",()=>e.getAllFlatColumns()),e.getVisibleLeafColumns=t("getVisibleLeafColumns",()=>e.getAllLeafColumns()),e.getLeftVisibleLeafColumns=t("getLeftVisibleLeafColumns",()=>e.getLeftLeafColumns()),e.getRightVisibleLeafColumns=t("getRightVisibleLeafColumns",()=>e.getRightLeafColumns()),e.getCenterVisibleLeafColumns=t("getCenterVisibleLeafColumns",()=>e.getCenterLeafColumns()),e.setColumnVisibility=r=>e.options.onColumnVisibilityChange==null?void 0:e.options.onColumnVisibilityChange(r),e.resetColumnVisibility=r=>{var n;e.setColumnVisibility(r?{}:(n=e.initialState.columnVisibility)!=null?n:{})},e.toggleAllColumnsVisible=r=>{var n;r=(n=r)!=null?n:!e.getIsAllColumnsVisible(),e.setColumnVisibility(e.getAllLeafColumns().reduce((a,c)=>({...a,[c.id]:r||!(c.getCanHide!=null&&c.getCanHide())}),{}))},e.getIsAllColumnsVisible=()=>!e.getAllLeafColumns().some(r=>!(r.getIsVisible!=null&&r.getIsVisible())),e.getIsSomeColumnsVisible=()=>e.getAllLeafColumns().some(r=>r.getIsVisible==null?void 0:r.getIsVisible()),e.getToggleAllColumnsVisibilityHandler=()=>r=>{var n;e.toggleAllColumnsVisible((n=r.target)==null?void 0:n.checked)}}};function S1(e,t){return t?t==="center"?e.getCenterVisibleLeafColumns():t==="left"?e.getLeftVisibleLeafColumns():e.getRightVisibleLeafColumns():e.getVisibleLeafColumns()}const KBe={createTable:e=>{e._getGlobalFacetedRowModel=e.options.getFacetedRowModel&&e.options.getFacetedRowModel(e,"__global__"),e.getGlobalFacetedRowModel=()=>e.options.manualFiltering||!e._getGlobalFacetedRowModel?e.getPreFilteredRowModel():e._getGlobalFacetedRowModel(),e._getGlobalFacetedUniqueValues=e.options.getFacetedUniqueValues&&e.options.getFacetedUniqueValues(e,"__global__"),e.getGlobalFacetedUniqueValues=()=>e._getGlobalFacetedUniqueValues?e._getGlobalFacetedUniqueValues():new Map,e._getGlobalFacetedMinMaxValues=e.options.getFacetedMinMaxValues&&e.options.getFacetedMinMaxValues(e,"__global__"),e.getGlobalFacetedMinMaxValues=()=>{if(e._getGlobalFacetedMinMaxValues)return e._getGlobalFacetedMinMaxValues()}}},ZBe={getInitialState:e=>({globalFilter:void 0,...e}),getDefaultOptions:e=>({onGlobalFilterChange:Bu("globalFilter",e),globalFilterFn:"auto",getColumnCanGlobalFilter:t=>{var r;const n=(r=e.getCoreRowModel().flatRows[0])==null||(r=r._getAllCellsByColumnId()[t.id])==null?void 0:r.getValue();return typeof n=="string"||typeof n=="number"}}),createColumn:(e,t)=>{e.getCanGlobalFilter=()=>{var r,n,a,c;return((r=e.columnDef.enableGlobalFilter)!=null?r:!0)&&((n=t.options.enableGlobalFilter)!=null?n:!0)&&((a=t.options.enableFilters)!=null?a:!0)&&((c=t.options.getColumnCanGlobalFilter==null?void 0:t.options.getColumnCanGlobalFilter(e))!=null?c:!0)&&!!e.accessorFn}},createTable:e=>{e.getGlobalAutoFilterFn=()=>om.includesString,e.getGlobalFilterFn=()=>{var t,r;const{globalFilterFn:n}=e.options;return RN(n)?n:n==="auto"?e.getGlobalAutoFilterFn():(t=(r=e.options.filterFns)==null?void 0:r[n])!=null?t:om[n]},e.setGlobalFilter=t=>{e.options.onGlobalFilterChange==null||e.options.onGlobalFilterChange(t)},e.resetGlobalFilter=t=>{e.setGlobalFilter(t?void 0:e.initialState.globalFilter)}}},YBe={getInitialState:e=>({expanded:{},...e}),getDefaultOptions:e=>({onExpandedChange:Bu("expanded",e),paginateExpandedRows:!0}),createTable:e=>{let t=!1,r=!1;e._autoResetExpanded=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetExpanded)!=null?n:!e.options.manualExpanding){if(r)return;r=!0,e._queue(()=>{e.resetExpanded(),r=!1})}},e.setExpanded=n=>e.options.onExpandedChange==null?void 0:e.options.onExpandedChange(n),e.toggleAllRowsExpanded=n=>{n??!e.getIsAllRowsExpanded()?e.setExpanded(!0):e.setExpanded({})},e.resetExpanded=n=>{var a,c;e.setExpanded(n?{}:(a=(c=e.initialState)==null?void 0:c.expanded)!=null?a:{})},e.getCanSomeRowsExpand=()=>e.getPrePaginationRowModel().flatRows.some(n=>n.getCanExpand()),e.getToggleAllRowsExpandedHandler=()=>n=>{n.persist==null||n.persist(),e.toggleAllRowsExpanded()},e.getIsSomeRowsExpanded=()=>{const n=e.getState().expanded;return n===!0||Object.values(n).some(Boolean)},e.getIsAllRowsExpanded=()=>{const n=e.getState().expanded;return typeof n=="boolean"?n===!0:!(!Object.keys(n).length||e.getRowModel().flatRows.some(a=>!a.getIsExpanded()))},e.getExpandedDepth=()=>{let n=0;return(e.getState().expanded===!0?Object.keys(e.getRowModel().rowsById):Object.keys(e.getState().expanded)).forEach(c=>{const f=c.split(".");n=Math.max(n,f.length)}),n},e.getPreExpandedRowModel=()=>e.getSortedRowModel(),e.getExpandedRowModel=()=>(!e._getExpandedRowModel&&e.options.getExpandedRowModel&&(e._getExpandedRowModel=e.options.getExpandedRowModel(e)),e.options.manualExpanding||!e._getExpandedRowModel?e.getPreExpandedRowModel():e._getExpandedRowModel())},createRow:(e,t)=>{e.toggleExpanded=r=>{t.setExpanded(n=>{var a;const c=n===!0?!0:!!(n!=null&&n[e.id]);let f={};if(n===!0?Object.keys(t.getRowModel().rowsById).forEach(i=>{f[i]=!0}):f=n,r=(a=r)!=null?a:!c,!c&&r)return{...f,[e.id]:!0};if(c&&!r){const{[e.id]:i,...x}=f;return x}return n})},e.getIsExpanded=()=>{var r;const n=t.getState().expanded;return!!((r=t.options.getIsRowExpanded==null?void 0:t.options.getIsRowExpanded(e))!=null?r:n===!0||n!=null&&n[e.id])},e.getCanExpand=()=>{var r,n,a;return(r=t.options.getRowCanExpand==null?void 0:t.options.getRowCanExpand(e))!=null?r:((n=t.options.enableExpanding)!=null?n:!0)&&!!((a=e.subRows)!=null&&a.length)},e.getIsAllParentsExpanded=()=>{let r=!0,n=e;for(;r&&n.parentId;)n=t.getRow(n.parentId,!0),r=n.getIsExpanded();return r},e.getToggleExpandedHandler=()=>{const r=e.getCanExpand();return()=>{r&&e.toggleExpanded()}}}},O3=0,R3=10,$O=()=>({pageIndex:O3,pageSize:R3}),XBe={getInitialState:e=>({...e,pagination:{...$O(),...e==null?void 0:e.pagination}}),getDefaultOptions:e=>({onPaginationChange:Bu("pagination",e)}),createTable:e=>{let t=!1,r=!1;e._autoResetPageIndex=()=>{var n,a;if(!t){e._queue(()=>{t=!0});return}if((n=(a=e.options.autoResetAll)!=null?a:e.options.autoResetPageIndex)!=null?n:!e.options.manualPagination){if(r)return;r=!0,e._queue(()=>{e.resetPageIndex(),r=!1})}},e.setPagination=n=>{const a=c=>$g(n,c);return e.options.onPaginationChange==null?void 0:e.options.onPaginationChange(a)},e.resetPagination=n=>{var a;e.setPagination(n?$O():(a=e.initialState.pagination)!=null?a:$O())},e.setPageIndex=n=>{e.setPagination(a=>{let c=$g(n,a.pageIndex);const f=typeof e.options.pageCount>"u"||e.options.pageCount===-1?Number.MAX_SAFE_INTEGER:e.options.pageCount-1;return c=Math.max(0,Math.min(c,f)),{...a,pageIndex:c}})},e.resetPageIndex=n=>{var a,c;e.setPageIndex(n?O3:(a=(c=e.initialState)==null||(c=c.pagination)==null?void 0:c.pageIndex)!=null?a:O3)},e.resetPageSize=n=>{var a,c;e.setPageSize(n?R3:(a=(c=e.initialState)==null||(c=c.pagination)==null?void 0:c.pageSize)!=null?a:R3)},e.setPageSize=n=>{e.setPagination(a=>{const c=Math.max(1,$g(n,a.pageSize)),f=a.pageSize*a.pageIndex,i=Math.floor(f/c);return{...a,pageIndex:i,pageSize:c}})},e.setPageCount=n=>e.setPagination(a=>{var c;let f=$g(n,(c=e.options.pageCount)!=null?c:-1);return typeof f=="number"&&(f=Math.max(-1,f)),{...a,pageCount:f}}),e.getPageOptions=ii(()=>[e.getPageCount()],n=>{let a=[];return n&&n>0&&(a=[...new Array(n)].fill(null).map((c,f)=>f)),a},ai(e.options,"debugTable")),e.getCanPreviousPage=()=>e.getState().pagination.pageIndex>0,e.getCanNextPage=()=>{const{pageIndex:n}=e.getState().pagination,a=e.getPageCount();return a===-1?!0:a===0?!1:n<a-1},e.previousPage=()=>e.setPageIndex(n=>n-1),e.nextPage=()=>e.setPageIndex(n=>n+1),e.firstPage=()=>e.setPageIndex(0),e.lastPage=()=>e.setPageIndex(e.getPageCount()-1),e.getPrePaginationRowModel=()=>e.getExpandedRowModel(),e.getPaginationRowModel=()=>(!e._getPaginationRowModel&&e.options.getPaginationRowModel&&(e._getPaginationRowModel=e.options.getPaginationRowModel(e)),e.options.manualPagination||!e._getPaginationRowModel?e.getPrePaginationRowModel():e._getPaginationRowModel()),e.getPageCount=()=>{var n;return(n=e.options.pageCount)!=null?n:Math.ceil(e.getRowCount()/e.getState().pagination.pageSize)},e.getRowCount=()=>{var n;return(n=e.options.rowCount)!=null?n:e.getPrePaginationRowModel().rows.length}}},qO=()=>({top:[],bottom:[]}),JBe={getInitialState:e=>({rowPinning:qO(),...e}),getDefaultOptions:e=>({onRowPinningChange:Bu("rowPinning",e)}),createRow:(e,t)=>{e.pin=(r,n,a)=>{const c=n?e.getLeafRows().map(x=>{let{id:w}=x;return w}):[],f=a?e.getParentRows().map(x=>{let{id:w}=x;return w}):[],i=new Set([...f,e.id,...c]);t.setRowPinning(x=>{var w,A;if(r==="bottom"){var P,E;return{top:((P=x==null?void 0:x.top)!=null?P:[]).filter(L=>!(i!=null&&i.has(L))),bottom:[...((E=x==null?void 0:x.bottom)!=null?E:[]).filter(L=>!(i!=null&&i.has(L))),...Array.from(i)]}}if(r==="top"){var D,V;return{top:[...((D=x==null?void 0:x.top)!=null?D:[]).filter(L=>!(i!=null&&i.has(L))),...Array.from(i)],bottom:((V=x==null?void 0:x.bottom)!=null?V:[]).filter(L=>!(i!=null&&i.has(L)))}}return{top:((w=x==null?void 0:x.top)!=null?w:[]).filter(L=>!(i!=null&&i.has(L))),bottom:((A=x==null?void 0:x.bottom)!=null?A:[]).filter(L=>!(i!=null&&i.has(L)))}})},e.getCanPin=()=>{var r;const{enableRowPinning:n,enablePinning:a}=t.options;return typeof n=="function"?n(e):(r=n??a)!=null?r:!0},e.getIsPinned=()=>{const r=[e.id],{top:n,bottom:a}=t.getState().rowPinning,c=r.some(i=>n==null?void 0:n.includes(i)),f=r.some(i=>a==null?void 0:a.includes(i));return c?"top":f?"bottom":!1},e.getPinnedIndex=()=>{var r,n;const a=e.getIsPinned();if(!a)return-1;const c=(r=a==="top"?t.getTopRows():t.getBottomRows())==null?void 0:r.map(f=>{let{id:i}=f;return i});return(n=c==null?void 0:c.indexOf(e.id))!=null?n:-1}},createTable:e=>{e.setRowPinning=t=>e.options.onRowPinningChange==null?void 0:e.options.onRowPinningChange(t),e.resetRowPinning=t=>{var r,n;return e.setRowPinning(t?qO():(r=(n=e.initialState)==null?void 0:n.rowPinning)!=null?r:qO())},e.getIsSomeRowsPinned=t=>{var r;const n=e.getState().rowPinning;if(!t){var a,c;return!!((a=n.top)!=null&&a.length||(c=n.bottom)!=null&&c.length)}return!!((r=n[t])!=null&&r.length)},e._getPinnedRows=(t,r,n)=>{var a;return((a=e.options.keepPinnedRows)==null||a?(r??[]).map(f=>{const i=e.getRow(f,!0);return i.getIsAllParentsExpanded()?i:null}):(r??[]).map(f=>t.find(i=>i.id===f))).filter(Boolean).map(f=>({...f,position:n}))},e.getTopRows=ii(()=>[e.getRowModel().rows,e.getState().rowPinning.top],(t,r)=>e._getPinnedRows(t,r,"top"),ai(e.options,"debugRows")),e.getBottomRows=ii(()=>[e.getRowModel().rows,e.getState().rowPinning.bottom],(t,r)=>e._getPinnedRows(t,r,"bottom"),ai(e.options,"debugRows")),e.getCenterRows=ii(()=>[e.getRowModel().rows,e.getState().rowPinning.top,e.getState().rowPinning.bottom],(t,r,n)=>{const a=new Set([...r??[],...n??[]]);return t.filter(c=>!a.has(c.id))},ai(e.options,"debugRows"))}},QBe={getInitialState:e=>({rowSelection:{},...e}),getDefaultOptions:e=>({onRowSelectionChange:Bu("rowSelection",e),enableRowSelection:!0,enableMultiRowSelection:!0,enableSubRowSelection:!0}),createTable:e=>{e.setRowSelection=t=>e.options.onRowSelectionChange==null?void 0:e.options.onRowSelectionChange(t),e.resetRowSelection=t=>{var r;return e.setRowSelection(t?{}:(r=e.initialState.rowSelection)!=null?r:{})},e.toggleAllRowsSelected=t=>{e.setRowSelection(r=>{t=typeof t<"u"?t:!e.getIsAllRowsSelected();const n={...r},a=e.getPreGroupedRowModel().flatRows;return t?a.forEach(c=>{c.getCanSelect()&&(n[c.id]=!0)}):a.forEach(c=>{delete n[c.id]}),n})},e.toggleAllPageRowsSelected=t=>e.setRowSelection(r=>{const n=typeof t<"u"?t:!e.getIsAllPageRowsSelected(),a={...r};return e.getRowModel().rows.forEach(c=>{I3(a,c.id,n,!0,e)}),a}),e.getPreSelectedRowModel=()=>e.getCoreRowModel(),e.getSelectedRowModel=ii(()=>[e.getState().rowSelection,e.getCoreRowModel()],(t,r)=>Object.keys(t).length?GO(e,r):{rows:[],flatRows:[],rowsById:{}},ai(e.options,"debugTable")),e.getFilteredSelectedRowModel=ii(()=>[e.getState().rowSelection,e.getFilteredRowModel()],(t,r)=>Object.keys(t).length?GO(e,r):{rows:[],flatRows:[],rowsById:{}},ai(e.options,"debugTable")),e.getGroupedSelectedRowModel=ii(()=>[e.getState().rowSelection,e.getSortedRowModel()],(t,r)=>Object.keys(t).length?GO(e,r):{rows:[],flatRows:[],rowsById:{}},ai(e.options,"debugTable")),e.getIsAllRowsSelected=()=>{const t=e.getFilteredRowModel().flatRows,{rowSelection:r}=e.getState();let n=!!(t.length&&Object.keys(r).length);return n&&t.some(a=>a.getCanSelect()&&!r[a.id])&&(n=!1),n},e.getIsAllPageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows.filter(a=>a.getCanSelect()),{rowSelection:r}=e.getState();let n=!!t.length;return n&&t.some(a=>!r[a.id])&&(n=!1),n},e.getIsSomeRowsSelected=()=>{var t;const r=Object.keys((t=e.getState().rowSelection)!=null?t:{}).length;return r>0&&r<e.getFilteredRowModel().flatRows.length},e.getIsSomePageRowsSelected=()=>{const t=e.getPaginationRowModel().flatRows;return e.getIsAllPageRowsSelected()?!1:t.filter(r=>r.getCanSelect()).some(r=>r.getIsSelected()||r.getIsSomeSelected())},e.getToggleAllRowsSelectedHandler=()=>t=>{e.toggleAllRowsSelected(t.target.checked)},e.getToggleAllPageRowsSelectedHandler=()=>t=>{e.toggleAllPageRowsSelected(t.target.checked)}},createRow:(e,t)=>{e.toggleSelected=(r,n)=>{const a=e.getIsSelected();t.setRowSelection(c=>{var f;if(r=typeof r<"u"?r:!a,e.getCanSelect()&&a===r)return c;const i={...c};return I3(i,e.id,r,(f=n==null?void 0:n.selectChildren)!=null?f:!0,t),i})},e.getIsSelected=()=>{const{rowSelection:r}=t.getState();return K4(e,r)},e.getIsSomeSelected=()=>{const{rowSelection:r}=t.getState();return D3(e,r)==="some"},e.getIsAllSubRowsSelected=()=>{const{rowSelection:r}=t.getState();return D3(e,r)==="all"},e.getCanSelect=()=>{var r;return typeof t.options.enableRowSelection=="function"?t.options.enableRowSelection(e):(r=t.options.enableRowSelection)!=null?r:!0},e.getCanSelectSubRows=()=>{var r;return typeof t.options.enableSubRowSelection=="function"?t.options.enableSubRowSelection(e):(r=t.options.enableSubRowSelection)!=null?r:!0},e.getCanMultiSelect=()=>{var r;return typeof t.options.enableMultiRowSelection=="function"?t.options.enableMultiRowSelection(e):(r=t.options.enableMultiRowSelection)!=null?r:!0},e.getToggleSelectedHandler=()=>{const r=e.getCanSelect();return n=>{var a;r&&e.toggleSelected((a=n.target)==null?void 0:a.checked)}}}},I3=(e,t,r,n,a)=>{var c;const f=a.getRow(t,!0);r?(f.getCanMultiSelect()||Object.keys(e).forEach(i=>delete e[i]),f.getCanSelect()&&(e[t]=!0)):delete e[t],n&&(c=f.subRows)!=null&&c.length&&f.getCanSelectSubRows()&&f.subRows.forEach(i=>I3(e,i.id,r,n,a))};function GO(e,t){const r=e.getState().rowSelection,n=[],a={},c=function(f,i){return f.map(x=>{var w;const A=K4(x,r);if(A&&(n.push(x),a[x.id]=x),(w=x.subRows)!=null&&w.length&&(x={...x,subRows:c(x.subRows)}),A)return x}).filter(Boolean)};return{rows:c(t.rows),flatRows:n,rowsById:a}}function K4(e,t){var r;return(r=t[e.id])!=null?r:!1}function D3(e,t,r){var n;if(!((n=e.subRows)!=null&&n.length))return!1;let a=!0,c=!1;return e.subRows.forEach(f=>{if(!(c&&!a)&&(f.getCanSelect()&&(K4(f,t)?c=!0:a=!1),f.subRows&&f.subRows.length)){const i=D3(f,t);i==="all"?c=!0:(i==="some"&&(c=!0),a=!1)}}),a?"all":c?"some":!1}const L3=/([0-9]+)/gm,e6e=(e,t,r)=>xne(ay(e.getValue(r)).toLowerCase(),ay(t.getValue(r)).toLowerCase()),t6e=(e,t,r)=>xne(ay(e.getValue(r)),ay(t.getValue(r))),r6e=(e,t,r)=>Z4(ay(e.getValue(r)).toLowerCase(),ay(t.getValue(r)).toLowerCase()),n6e=(e,t,r)=>Z4(ay(e.getValue(r)),ay(t.getValue(r))),i6e=(e,t,r)=>{const n=e.getValue(r),a=t.getValue(r);return n>a?1:n<a?-1:0},a6e=(e,t,r)=>Z4(e.getValue(r),t.getValue(r));function Z4(e,t){return e===t?0:e>t?1:-1}function ay(e){return typeof e=="number"?isNaN(e)||e===1/0||e===-1/0?"":String(e):typeof e=="string"?e:""}function xne(e,t){const r=e.split(L3).filter(Boolean),n=t.split(L3).filter(Boolean);for(;r.length&&n.length;){const a=r.shift(),c=n.shift(),f=parseInt(a,10),i=parseInt(c,10),x=[f,i].sort();if(isNaN(x[0])){if(a>c)return 1;if(c>a)return-1;continue}if(isNaN(x[1]))return isNaN(f)?-1:1;if(f>i)return 1;if(i>f)return-1}return r.length-n.length}const Yb={alphanumeric:e6e,alphanumericCaseSensitive:t6e,text:r6e,textCaseSensitive:n6e,datetime:i6e,basic:a6e},s6e={getInitialState:e=>({sorting:[],...e}),getDefaultColumnDef:()=>({sortingFn:"auto",sortUndefined:1}),getDefaultOptions:e=>({onSortingChange:Bu("sorting",e),isMultiSortEvent:t=>t.shiftKey}),createColumn:(e,t)=>{e.getAutoSortingFn=()=>{const r=t.getFilteredRowModel().flatRows.slice(10);let n=!1;for(const a of r){const c=a==null?void 0:a.getValue(e.id);if(Object.prototype.toString.call(c)==="[object Date]")return Yb.datetime;if(typeof c=="string"&&(n=!0,c.split(L3).length>1))return Yb.alphanumeric}return n?Yb.text:Yb.basic},e.getAutoSortDir=()=>{const r=t.getFilteredRowModel().flatRows[0];return typeof(r==null?void 0:r.getValue(e.id))=="string"?"asc":"desc"},e.getSortingFn=()=>{var r,n;if(!e)throw new Error;return RN(e.columnDef.sortingFn)?e.columnDef.sortingFn:e.columnDef.sortingFn==="auto"?e.getAutoSortingFn():(r=(n=t.options.sortingFns)==null?void 0:n[e.columnDef.sortingFn])!=null?r:Yb[e.columnDef.sortingFn]},e.toggleSorting=(r,n)=>{const a=e.getNextSortingOrder(),c=typeof r<"u"&&r!==null;t.setSorting(f=>{const i=f==null?void 0:f.find(D=>D.id===e.id),x=f==null?void 0:f.findIndex(D=>D.id===e.id);let w=[],A,P=c?r:a==="desc";if(f!=null&&f.length&&e.getCanMultiSort()&&n?i?A="toggle":A="add":f!=null&&f.length&&x!==f.length-1?A="replace":i?A="toggle":A="replace",A==="toggle"&&(c||a||(A="remove")),A==="add"){var E;w=[...f,{id:e.id,desc:P}],w.splice(0,w.length-((E=t.options.maxMultiSortColCount)!=null?E:Number.MAX_SAFE_INTEGER))}else A==="toggle"?w=f.map(D=>D.id===e.id?{...D,desc:P}:D):A==="remove"?w=f.filter(D=>D.id!==e.id):w=[{id:e.id,desc:P}];return w})},e.getFirstSortDir=()=>{var r,n;return((r=(n=e.columnDef.sortDescFirst)!=null?n:t.options.sortDescFirst)!=null?r:e.getAutoSortDir()==="desc")?"desc":"asc"},e.getNextSortingOrder=r=>{var n,a;const c=e.getFirstSortDir(),f=e.getIsSorted();return f?f!==c&&((n=t.options.enableSortingRemoval)==null||n)&&(!(r&&(a=t.options.enableMultiRemove)!=null)||a)?!1:f==="desc"?"asc":"desc":c},e.getCanSort=()=>{var r,n;return((r=e.columnDef.enableSorting)!=null?r:!0)&&((n=t.options.enableSorting)!=null?n:!0)&&!!e.accessorFn},e.getCanMultiSort=()=>{var r,n;return(r=(n=e.columnDef.enableMultiSort)!=null?n:t.options.enableMultiSort)!=null?r:!!e.accessorFn},e.getIsSorted=()=>{var r;const n=(r=t.getState().sorting)==null?void 0:r.find(a=>a.id===e.id);return n?n.desc?"desc":"asc":!1},e.getSortIndex=()=>{var r,n;return(r=(n=t.getState().sorting)==null?void 0:n.findIndex(a=>a.id===e.id))!=null?r:-1},e.clearSorting=()=>{t.setSorting(r=>r!=null&&r.length?r.filter(n=>n.id!==e.id):[])},e.getToggleSortingHandler=()=>{const r=e.getCanSort();return n=>{r&&(n.persist==null||n.persist(),e.toggleSorting==null||e.toggleSorting(void 0,e.getCanMultiSort()?t.options.isMultiSortEvent==null?void 0:t.options.isMultiSortEvent(n):!1))}}},createTable:e=>{e.setSorting=t=>e.options.onSortingChange==null?void 0:e.options.onSortingChange(t),e.resetSorting=t=>{var r,n;e.setSorting(t?[]:(r=(n=e.initialState)==null?void 0:n.sorting)!=null?r:[])},e.getPreSortedRowModel=()=>e.getGroupedRowModel(),e.getSortedRowModel=()=>(!e._getSortedRowModel&&e.options.getSortedRowModel&&(e._getSortedRowModel=e.options.getSortedRowModel(e)),e.options.manualSorting||!e._getSortedRowModel?e.getPreSortedRowModel():e._getSortedRowModel())}},o6e=[CBe,HBe,$Be,qBe,kBe,EBe,KBe,ZBe,s6e,VBe,YBe,XBe,JBe,QBe,GBe];function l6e(e){var t,r;const n=[...o6e,...(t=e._features)!=null?t:[]];let a={_features:n};const c=a._features.reduce((E,D)=>Object.assign(E,D.getDefaultOptions==null?void 0:D.getDefaultOptions(a)),{}),f=E=>a.options.mergeOptions?a.options.mergeOptions(c,E):{...c,...E};let x={...{},...(r=e.initialState)!=null?r:{}};a._features.forEach(E=>{var D;x=(D=E.getInitialState==null?void 0:E.getInitialState(x))!=null?D:x});const w=[];let A=!1;const P={_features:n,options:{...c,...e},initialState:x,_queue:E=>{w.push(E),A||(A=!0,Promise.resolve().then(()=>{for(;w.length;)w.shift()();A=!1}).catch(D=>setTimeout(()=>{throw D})))},reset:()=>{a.setState(a.initialState)},setOptions:E=>{const D=$g(E,a.options);a.options=f(D)},getState:()=>a.options.state,setState:E=>{a.options.onStateChange==null||a.options.onStateChange(E)},_getRowId:(E,D,V)=>{var L;return(L=a.options.getRowId==null?void 0:a.options.getRowId(E,D,V))!=null?L:`${V?[V.id,D].join("."):D}`},getCoreRowModel:()=>(a._getCoreRowModel||(a._getCoreRowModel=a.options.getCoreRowModel(a)),a._getCoreRowModel()),getRowModel:()=>a.getPaginationRowModel(),getRow:(E,D)=>{let V=(D?a.getPrePaginationRowModel():a.getRowModel()).rowsById[E];if(!V&&(V=a.getCoreRowModel().rowsById[E],!V))throw new Error;return V},_getDefaultColumnDef:ii(()=>[a.options.defaultColumn],E=>{var D;return E=(D=E)!=null?D:{},{header:V=>{const L=V.header.column.columnDef;return L.accessorKey?L.accessorKey:L.accessorFn?L.id:null},cell:V=>{var L,$;return(L=($=V.renderValue())==null||$.toString==null?void 0:$.toString())!=null?L:null},...a._features.reduce((V,L)=>Object.assign(V,L.getDefaultColumnDef==null?void 0:L.getDefaultColumnDef()),{}),...E}},ai(e,"debugColumns")),_getColumnDefs:()=>a.options.columns,getAllColumns:ii(()=>[a._getColumnDefs()],E=>{const D=function(V,L,$){return $===void 0&&($=0),V.map(H=>{const K=jBe(a,H,$,L),Q=H;return K.columns=Q.columns?D(Q.columns,K,$+1):[],K})};return D(E)},ai(e,"debugColumns")),getAllFlatColumns:ii(()=>[a.getAllColumns()],E=>E.flatMap(D=>D.getFlatColumns()),ai(e,"debugColumns")),_getAllFlatColumnsById:ii(()=>[a.getAllFlatColumns()],E=>E.reduce((D,V)=>(D[V.id]=V,D),{}),ai(e,"debugColumns")),getAllLeafColumns:ii(()=>[a.getAllColumns(),a._getOrderColumnsFn()],(E,D)=>{let V=E.flatMap(L=>L.getLeafColumns());return D(V)},ai(e,"debugColumns")),getColumn:E=>a._getAllFlatColumnsById()[E]};Object.assign(a,P);for(let E=0;E<a._features.length;E++){const D=a._features[E];D==null||D.createTable==null||D.createTable(a)}return a}function N2(){return e=>ii(()=>[e.options.data],t=>{const r={rows:[],flatRows:[],rowsById:{}},n=function(a,c,f){c===void 0&&(c=0);const i=[];for(let w=0;w<a.length;w++){const A=W4(e,e._getRowId(a[w],w,f),a[w],w,c,void 0,f==null?void 0:f.id);if(r.flatRows.push(A),r.rowsById[A.id]=A,i.push(A),e.options.getSubRows){var x;A.originalSubRows=e.options.getSubRows(a[w],w),(x=A.originalSubRows)!=null&&x.length&&(A.subRows=n(A.originalSubRows,c+1,A))}}return i};return r.rows=n(t),r},ai(e.options,"debugTable","getRowModel",()=>e._autoResetPageIndex()))}function c6e(e){const t=[],r=n=>{var a;t.push(n),(a=n.subRows)!=null&&a.length&&n.getIsExpanded()&&n.subRows.forEach(r)};return e.rows.forEach(r),{rows:t,flatRows:e.flatRows,rowsById:e.rowsById}}function u6e(e,t,r){return r.options.filterFromLeafRows?d6e(e,t,r):h6e(e,t,r)}function d6e(e,t,r){var n;const a=[],c={},f=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(x,w){w===void 0&&(w=0);const A=[];for(let E=0;E<x.length;E++){var P;let D=x[E];const V=W4(r,D.id,D.original,D.index,D.depth,void 0,D.parentId);if(V.columnFilters=D.columnFilters,(P=D.subRows)!=null&&P.length&&w<f){if(V.subRows=i(D.subRows,w+1),D=V,t(D)&&!V.subRows.length){A.push(D),c[D.id]=D,a.push(D);continue}if(t(D)||V.subRows.length){A.push(D),c[D.id]=D,a.push(D);continue}}else D=V,t(D)&&(A.push(D),c[D.id]=D,a.push(D))}return A};return{rows:i(e),flatRows:a,rowsById:c}}function h6e(e,t,r){var n;const a=[],c={},f=(n=r.options.maxLeafRowFilterDepth)!=null?n:100,i=function(x,w){w===void 0&&(w=0);const A=[];for(let E=0;E<x.length;E++){let D=x[E];if(t(D)){var P;if((P=D.subRows)!=null&&P.length&&w<f){const L=W4(r,D.id,D.original,D.index,D.depth,void 0,D.parentId);L.subRows=i(D.subRows,w+1),D=L}A.push(D),a.push(D),c[D.id]=D}}return A};return{rows:i(e),flatRows:a,rowsById:c}}function j2(){return e=>ii(()=>[e.getPreFilteredRowModel(),e.getState().columnFilters,e.getState().globalFilter],(t,r,n)=>{if(!t.rows.length||!(r!=null&&r.length)&&!n){for(let E=0;E<t.flatRows.length;E++)t.flatRows[E].columnFilters={},t.flatRows[E].columnFiltersMeta={};return t}const a=[],c=[];(r??[]).forEach(E=>{var D;const V=e.getColumn(E.id);if(!V)return;const L=V.getFilterFn();L&&a.push({id:E.id,filterFn:L,resolvedValue:(D=L.resolveFilterValue==null?void 0:L.resolveFilterValue(E.value))!=null?D:E.value})});const f=(r??[]).map(E=>E.id),i=e.getGlobalFilterFn(),x=e.getAllLeafColumns().filter(E=>E.getCanGlobalFilter());n&&i&&x.length&&(f.push("__global__"),x.forEach(E=>{var D;c.push({id:E.id,filterFn:i,resolvedValue:(D=i.resolveFilterValue==null?void 0:i.resolveFilterValue(n))!=null?D:n})}));let w,A;for(let E=0;E<t.flatRows.length;E++){const D=t.flatRows[E];if(D.columnFilters={},a.length)for(let V=0;V<a.length;V++){w=a[V];const L=w.id;D.columnFilters[L]=w.filterFn(D,L,w.resolvedValue,$=>{D.columnFiltersMeta[L]=$})}if(c.length){for(let V=0;V<c.length;V++){A=c[V];const L=A.id;if(A.filterFn(D,L,A.resolvedValue,$=>{D.columnFiltersMeta[L]=$})){D.columnFilters.__global__=!0;break}}D.columnFilters.__global__!==!0&&(D.columnFilters.__global__=!1)}}const P=E=>{for(let D=0;D<f.length;D++)if(E.columnFilters[f[D]]===!1)return!1;return!0};return u6e(t.rows,P,e)},ai(e.options,"debugTable","getFilteredRowModel",()=>e._autoResetPageIndex()))}function C2(e){return t=>ii(()=>[t.getState().pagination,t.getPrePaginationRowModel(),t.options.paginateExpandedRows?void 0:t.getState().expanded],(r,n)=>{if(!n.rows.length)return n;const{pageSize:a,pageIndex:c}=r;let{rows:f,flatRows:i,rowsById:x}=n;const w=a*c,A=w+a;f=f.slice(w,A);let P;t.options.paginateExpandedRows?P={rows:f,flatRows:i,rowsById:x}:P=c6e({rows:f,flatRows:i,rowsById:x}),P.flatRows=[];const E=D=>{P.flatRows.push(D),D.subRows.length&&D.subRows.forEach(E)};return P.rows.forEach(E),P},ai(t.options,"debugTable"))}function k2(){return e=>ii(()=>[e.getState().sorting,e.getPreSortedRowModel()],(t,r)=>{if(!r.rows.length||!(t!=null&&t.length))return r;const n=e.getState().sorting,a=[],c=n.filter(x=>{var w;return(w=e.getColumn(x.id))==null?void 0:w.getCanSort()}),f={};c.forEach(x=>{const w=e.getColumn(x.id);w&&(f[x.id]={sortUndefined:w.columnDef.sortUndefined,invertSorting:w.columnDef.invertSorting,sortingFn:w.getSortingFn()})});const i=x=>{const w=x.map(A=>({...A}));return w.sort((A,P)=>{for(let D=0;D<c.length;D+=1){var E;const V=c[D],L=f[V.id],$=L.sortUndefined,H=(E=V==null?void 0:V.desc)!=null?E:!1;let K=0;if($){const Q=A.getValue(V.id),ae=P.getValue(V.id),ee=Q===void 0,se=ae===void 0;if(ee||se){if($==="first")return ee?-1:1;if($==="last")return ee?1:-1;K=ee&&se?0:ee?$:-$}}if(K===0&&(K=L.sortingFn(A,P,V.id)),K!==0)return H&&(K*=-1),L.invertSorting&&(K*=-1),K}return A.index-P.index}),w.forEach(A=>{var P;a.push(A),(P=A.subRows)!=null&&P.length&&(A.subRows=i(A.subRows))}),w};return{rows:i(r.rows),flatRows:a,rowsById:r.rowsById}},ai(e.options,"debugTable","getSortedRowModel",()=>e._autoResetPageIndex()))}/**
   * react-table
   *
   * Copyright (c) TanStack
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE.md file in the root directory of this source tree.
   *
   * @license MIT
   */function cp(e,t){return e?f6e(e)?W.createElement(e,t):e:null}function f6e(e){return p6e(e)||typeof e=="function"||m6e(e)}function p6e(e){return typeof e=="function"&&(()=>{const t=Object.getPrototypeOf(e);return t.prototype&&t.prototype.isReactComponent})()}function m6e(e){return typeof e=="object"&&typeof e.$$typeof=="symbol"&&["react.memo","react.forward_ref"].includes(e.$$typeof.description)}function E2(e){const t={state:{},onStateChange:()=>{},renderFallbackValue:null,...e},[r]=W.useState(()=>({current:l6e(t)})),[n,a]=W.useState(()=>r.current.initialState);return r.current.setOptions(c=>({...c,...e,state:{...n,...e.state},onStateChange:f=>{a(f),e.onStateChange==null||e.onStateChange(f)}})),r.current}const km=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{className:"relative w-full overflow-auto",children:l.jsx("table",{ref:r,className:Ut("w-full caption-bottom text-sm",e),...t})}));km.displayName="Table";const Em=W.forwardRef(({className:e,...t},r)=>l.jsx("thead",{ref:r,className:Ut("[&_tr]:border-b",e),...t}));Em.displayName="TableHeader";const Mm=W.forwardRef(({className:e,...t},r)=>l.jsx("tbody",{ref:r,className:Ut("[&_tr:last-child]:border-0",e),...t}));Mm.displayName="TableBody";const g6e=W.forwardRef(({className:e,...t},r)=>l.jsx("tfoot",{ref:r,className:Ut("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));g6e.displayName="TableFooter";const Ns=W.forwardRef(({className:e,...t},r)=>l.jsx("tr",{ref:r,className:Ut("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Ns.displayName="TableRow";const Ts=W.forwardRef(({className:e,...t},r)=>l.jsx("th",{ref:r,className:Ut("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));Ts.displayName="TableHead";const ha=W.forwardRef(({className:e,...t},r)=>l.jsx("td",{ref:r,className:Ut("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));ha.displayName="TableCell";const y6e=W.forwardRef(({className:e,...t},r)=>l.jsx("caption",{ref:r,className:Ut("mt-4 text-sm text-muted-foreground",e),...t}));y6e.displayName="TableCaption";const M2=({rowCount:e,cellCount:t})=>l.jsx(l.Fragment,{children:Array.from({length:e}).map((r,n)=>l.jsx(Ns,{children:Array.from({length:t}).map((a,c)=>l.jsx(ha,{children:l.jsx(sT,{className:"h-5"})},c))},n))});function O2({table:e}){return l.jsxs(Wh,{children:[l.jsx(bD,{asChild:!0,children:l.jsxs(Nr,{size:"sm",className:"ml-auto hidden h-8 lg:flex bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[l.jsx(mde,{}),"View"]})}),l.jsxs(zd,{align:"end",className:"w-[150px]",children:[l.jsx(S_,{children:"Toggle columns"}),l.jsx(_m,{}),e.getAllColumns().filter(t=>typeof t.accessorFn<"u"&&t.getCanHide()).map(t=>l.jsx(WK,{className:"capitalize",checked:t.getIsVisible(),onCheckedChange:r=>t.toggleVisibility(!!r),children:typeof t.columnDef.header=="string"?t.columnDef.header:t.id},t.id))]})]})}function R2({table:e}){return l.jsx("div",{className:"flex items-center justify-end px-2",children:l.jsxs("div",{className:"flex items-center space-x-4 lg:space-x-5",children:[l.jsxs("div",{className:"flex w-[100px] items-center justify-center text-xs font-medium",children:["Page ",e.getState().pagination.pageIndex+1," of"," ",e.getPageCount()]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs(Nr,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(0),disabled:!e.getCanPreviousPage(),children:[l.jsx("span",{className:"sr-only",children:"Go to first page"}),l.jsx(Aue,{className:"w-4 h-4"})]}),l.jsxs(Nr,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.previousPage(),disabled:!e.getCanPreviousPage(),children:[l.jsx("span",{className:"sr-only",children:"Go to previous page"}),l.jsx(Q3,{className:"w-4 h-4"})]}),l.jsxs(Nr,{variant:"outline",className:"h-7 w-7 rounded-sm p-0",onClick:()=>e.nextPage(),disabled:!e.getCanNextPage(),children:[l.jsx("span",{className:"sr-only",children:"Go to next page"}),l.jsx(L0,{className:"w-4 h-4"})]}),l.jsxs(Nr,{variant:"outline",className:"hidden h-7 w-7 rounded-sm p-0 lg:flex",onClick:()=>e.setPageIndex(e.getPageCount()-1),disabled:!e.getCanNextPage(),children:[l.jsx("span",{className:"sr-only",children:"Go to last page"}),l.jsx(Pue,{className:"w-4 h-4"})]})]})]})})}const _ne=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:c,loading:f,showAddButton:i=!1,onAdd:x,onAction:w})=>{var se;const[A,P]=Oe.useState([]),[E,D]=Oe.useState([]),[V,L]=Oe.useState({}),[$,H]=Oe.useState({pageIndex:0,pageSize:8}),[K,Q]=Oe.useState(""),ae=r,ee=E2({data:c,columns:a(w),onSortingChange:P,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:N2(),getPaginationRowModel:C2(),getSortedRowModel:k2(),getFilteredRowModel:j2(),onColumnVisibilityChange:L,onGlobalFilterChange:Q,globalFilterFn:(ce,he,Pe)=>ae.some(Ne=>{const pe=ce.getValue(Ne);return String(pe).toLowerCase().includes(Pe.toLowerCase())}),state:{pagination:$,sorting:A,columnFilters:E,columnVisibility:V,globalFilter:K}});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsx(ls,{className:"font-semibold",children:t}),l.jsxs("div",{className:`md:flex items-center flex-shrink-0 ${e?"justify-between py-3":"justify-end pb-3"}`,children:[l.jsx(kn,{placeholder:e,value:K??"",onChange:ce=>Q(ce.target.value),className:e?"hidden md:inline md:max-w-sm flex-shrink":"hidden"}),l.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[l.jsxs(Nr,{onClick:x,size:"sm",className:i?"w-min flex items-center gap-2":"hidden",children:[l.jsx(J0,{}),l.jsx("span",{className:"hidden lg:inline",children:i})]}),l.jsx(O2,{table:ee})]})]}),l.jsx("div",{className:"rounded-lg border flex-1 overflow-hidden shadow-sm bg-white min-h-0",children:l.jsx("div",{className:"overflow-auto h-full",children:l.jsx("div",{className:"px-4",children:l.jsxs(km,{children:[l.jsx(Em,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-300",children:ee.getHeaderGroups().map(ce=>l.jsx(Ns,{className:"hover:bg-gray-100/50",children:ce.headers.map(he=>l.jsx(Ts,{className:"text-xs font-semibold text-gray-800 px-3 py-2 whitespace-nowrap",children:cp(he.column.columnDef.header,he.getContext())},he.id))},ce.id))}),l.jsx(Mm,{className:"text-xs",children:f?l.jsx(M2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ce=>l.jsx(Ns,{"data-state":ce.getIsSelected()&&"selected",className:"hover:bg-gray-100 transition-colors duration-150 border-b border-gray-100",children:ce.getVisibleCells().map(he=>l.jsx(ha,{className:"px-3 py-2 text-gray-800",children:cp(he.column.columnDef.cell,he.getContext())},he.id))},ce.id)):l.jsx(Ns,{className:"hover:bg-transparent",children:l.jsx(ha,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center justify-center",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),l.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),l.jsx("div",{className:"mt-3 flex-shrink-0",children:l.jsx(R2,{table:ee})})]})},WO=e=>e.charAt(0).toUpperCase()+e.slice(1),v6e=e=>({get:t=>e[t]||null}),x6e=v6e({0:"Registration",1:"Violation",2:"Accident"}),_6e=()=>{const[e,t]=W.useState([]),r=Di(),{token:n}=r||{},[a,c]=W.useState(!0);return W.useEffect(()=>{async function f(){try{const{data:i}=await xn.get("/logs",{headers:{Authorization:n}});if(i.success){const x=i.data.map(w=>({id:w._id,fullname:w.driver.fullname,type:x6e.get(w.type),createdAt:vBe(w.createdAt)}));t(x)}}catch(i){console.log(i)}finally{c(!1)}}f()},[]),l.jsx("div",{className:"w-full",children:l.jsx(_ne,{tableColumn:SBe,data:e})})},b6e=()=>{const[e,t]=W.useState(!0),[r,n]=W.useState({vehicles:{total:0,active:0,expired:0},drivers:{total:0},violations:{total:0,recent:0,byType:[]},accidents:{total:0},trends:{monthlyViolations:[]}}),{token:a}=Di();W.useEffect(()=>{c()},[]);const c=async()=>{try{t(!0);const{data:f}=await xn.get("/dashboard/stats",{headers:{Authorization:a}});f.success&&n(f.data)}catch(f){console.error("Error fetching dashboard stats:",f)}finally{t(!1)}};return l.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6 rounded-lg",children:[l.jsx("section",{className:"text-3xl font-bold",children:"Dashboard"}),e?l.jsxs("div",{className:"space-y-4",children:[l.jsx("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(f=>l.jsx("div",{className:"bg-card shadow-sm border border-border overflow-hidden rounded-xl p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("div",{className:"h-4 bg-muted rounded w-32"}),l.jsx("div",{className:"w-5 h-5 bg-muted rounded"})]}),l.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),l.jsx("div",{className:"h-3 bg-muted rounded w-20"})]})},f))}),l.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),l.jsx("div",{className:"h-64 bg-muted rounded"})]})}),l.jsxs("section",{className:"flex gap-4 flex-col lg:flex-row",children:[l.jsx("div",{className:"flex-1 bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-4"}),l.jsx("div",{className:"h-48 bg-muted rounded"})]})}),l.jsx("div",{className:"p-5 border w-full lg:w-min rounded-lg bg-card",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-24 mb-4"}),l.jsx("div",{className:"h-48 bg-muted rounded"})]})})]})]}):l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"max-h-full w-full grid grid-flow-row lg:grid-flow-col grid-cols-1 gap-5 md:grid-cols-2 lg:grid-cols-4",children:[l.jsx(VS,{name:"Registered Vehicles",value:r.vehicles.total.toString(),icon:cl,statuses:[{label:`${r.vehicles.active} Active`,color:"#047857",bgColor:"#d1fae5"},{label:`${r.vehicles.expired} Expired`,color:"#dc2626",bgColor:"#fee2e2"}]}),l.jsx(VS,{name:"Registered Drivers",value:r.drivers.total.toString(),icon:tD}),l.jsx(VS,{name:"Violations",value:r.violations.total.toString(),icon:gue}),l.jsx(VS,{name:"Accidents",value:r.accidents.total.toString(),icon:P1})]}),l.jsx(e5e,{}),l.jsxs("section",{className:"flex gap-4 flex-col lg:flex-row",children:[l.jsx(_6e,{}),l.jsx("div",{className:"p-5 border w-full lg:w-min rounded-lg ",children:l.jsx(Lw,{mode:"single",className:"w-full"})})]})]})]})},w6e=({allowedRoles:e})=>{const t={employee:"2",admin:"1",superadmin:"0"},{isAuthenticated:r,isLoading:n,userData:a}=Di(),c=co(),f=a==null?void 0:a.role;if(n)return l.jsx("div",{className:"h-screen flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const i=e.map(x=>t[x]);return r&&i.includes(f)?l.jsx(GW,{}):l.jsx(W3,{to:"/login",state:{from:c},replace:!0})},HO=({allowedRoles:e,children:t})=>{const{userData:r,loading:n}=Di(),a=co(),c=r==null?void 0:r.role;if(n)return l.jsx("div",{children:"Loading..."});const f={employee:"2",admin:"1",superadmin:"0"};return e.map(x=>f[x]).includes(c)?t:l.jsx(W3,{to:"/",state:{from:a},replace:!0})},KO=768;function S6e(){const[e,t]=W.useState(void 0);return W.useEffect(()=>{const r=window.matchMedia(`(max-width: ${KO-1}px)`),n=()=>{t(window.innerWidth<KO)};return r.addEventListener("change",n),t(window.innerWidth<KO),()=>r.removeEventListener("change",n)},[]),!!e}const A6e=VD,T6e=UD,bne=W.forwardRef(({className:e,...t},r)=>l.jsx(Qw,{className:Ut("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));bne.displayName=Qw.displayName;const P6e=Vw("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),wne=W.forwardRef(({side:e="right",className:t,children:r,...n},a)=>l.jsxs(T6e,{children:[l.jsx(bne,{}),l.jsxs(e2,{ref:a,className:Ut(P6e({side:e}),t),...n,children:[l.jsxs($P,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[l.jsx(Qf,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]}),r]})]}));wne.displayName=e2.displayName;const Sne=({className:e,...t})=>l.jsx("div",{className:Ut("flex flex-col space-y-2 text-center sm:text-left",e),...t});Sne.displayName="SheetHeader";const Ane=W.forwardRef(({className:e,...t},r)=>l.jsx(t2,{ref:r,className:Ut("text-lg font-semibold text-foreground",e),...t}));Ane.displayName=t2.displayName;const Tne=W.forwardRef(({className:e,...t},r)=>l.jsx(r2,{ref:r,className:Ut("text-sm text-muted-foreground",e),...t}));Tne.displayName=r2.displayName;const N6e="sidebar_state",j6e=60*60*24*7,C6e="16rem",k6e="18rem",E6e="3rem",M6e="b",Pne=W.createContext(null);function F_(){const e=W.useContext(Pne);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Nne=W.forwardRef(({defaultOpen:e=!0,open:t,onOpenChange:r,className:n,style:a,children:c,...f},i)=>{const x=S6e(),[w,A]=W.useState(!1),[P,E]=W.useState(e),D=t??P,V=W.useCallback(K=>{const Q=typeof K=="function"?K(D):K;r?r(Q):E(Q),document.cookie=`${N6e}=${Q}; path=/; max-age=${j6e}`},[r,D]),L=W.useCallback(()=>x?A(K=>!K):V(K=>!K),[x,V,A]);W.useEffect(()=>{const K=Q=>{Q.key===M6e&&(Q.metaKey||Q.ctrlKey)&&(Q.preventDefault(),L())};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[L]);const $=D?"expanded":"collapsed",H=W.useMemo(()=>({state:$,open:D,setOpen:V,isMobile:x,openMobile:w,setOpenMobile:A,toggleSidebar:L}),[$,D,V,x,w,A,L]);return l.jsx(Pne.Provider,{value:H,children:l.jsx(hBe,{delayDuration:0,children:l.jsx("div",{style:{"--sidebar-width":C6e,"--sidebar-width-icon":E6e,...a},className:Ut("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:i,...f,children:c})})})});Nne.displayName="SidebarProvider";const jne=W.forwardRef(({side:e="left",variant:t="sidebar",collapsible:r="offcanvas",className:n,children:a,...c},f)=>{const{isMobile:i,state:x,openMobile:w,setOpenMobile:A}=F_();return r==="none"?l.jsx("div",{className:Ut("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:f,...c,children:a}):i?l.jsx(A6e,{open:w,onOpenChange:A,...c,children:l.jsxs(wne,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":k6e},side:e,children:[l.jsxs(Sne,{className:"sr-only",children:[l.jsx(Ane,{children:"Sidebar"}),l.jsx(Tne,{children:"Displays the mobile sidebar."})]}),l.jsx("div",{className:"flex h-full w-full flex-col",children:a})]})}):l.jsxs("div",{ref:f,className:"group peer hidden text-sidebar-foreground md:block","data-state":x,"data-collapsible":x==="collapsed"?r:"","data-variant":t,"data-side":e,children:[l.jsx("div",{className:Ut("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",t==="floating"||t==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),l.jsx("div",{className:Ut("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",e==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",t==="floating"||t==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...c,children:l.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:a})})]})});jne.displayName="Sidebar";const Cne=W.forwardRef(({className:e,onClick:t,...r},n)=>{const{toggleSidebar:a}=F_();return l.jsxs(Nr,{ref:n,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Ut("h-7 w-7",e),onClick:c=>{t==null||t(c),a()},...r,children:[l.jsx(ide,{}),l.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});Cne.displayName="SidebarTrigger";const kne=W.forwardRef(({className:e,...t},r)=>{const{toggleSidebar:n}=F_();return l.jsx("button",{ref:r,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:n,title:"Toggle Sidebar",className:Ut("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...t})});kne.displayName="SidebarRail";const Ene=W.forwardRef(({className:e,...t},r)=>l.jsx("main",{ref:r,className:Ut("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...t}));Ene.displayName="SidebarInset";const O6e=W.forwardRef(({className:e,...t},r)=>l.jsx(kn,{ref:r,"data-sidebar":"input",className:Ut("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...t}));O6e.displayName="SidebarInput";const Mne=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,"data-sidebar":"header",className:Ut("flex flex-col gap-2 p-2",e),...t}));Mne.displayName="SidebarHeader";const One=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,"data-sidebar":"footer",className:Ut("flex flex-col gap-2 p-2",e),...t}));One.displayName="SidebarFooter";const R6e=W.forwardRef(({className:e,...t},r)=>l.jsx(P2,{ref:r,"data-sidebar":"separator",className:Ut("mx-2 w-auto bg-sidebar-border",e),...t}));R6e.displayName="SidebarSeparator";const Rne=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,"data-sidebar":"content",className:Ut("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...t}));Rne.displayName="SidebarContent";const TA=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,"data-sidebar":"group",className:Ut("relative flex w-full min-w-0 flex-col p-2",e),...t}));TA.displayName="SidebarGroup";const PA=W.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?Ql:"div";return l.jsx(a,{ref:n,"data-sidebar":"group-label",className:Ut("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...r})});PA.displayName="SidebarGroupLabel";const I6e=W.forwardRef(({className:e,asChild:t=!1,...r},n)=>{const a=t?Ql:"button";return l.jsx(a,{ref:n,"data-sidebar":"group-action",className:Ut("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...r})});I6e.displayName="SidebarGroupAction";const D6e=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,"data-sidebar":"group-content",className:Ut("w-full text-sm",e),...t}));D6e.displayName="SidebarGroupContent";const vx=W.forwardRef(({className:e,...t},r)=>l.jsx("ul",{ref:r,"data-sidebar":"menu",className:Ut("flex w-full min-w-0 flex-col gap-1",e),...t}));vx.displayName="SidebarMenu";const Nd=W.forwardRef(({className:e,...t},r)=>l.jsx("li",{ref:r,"data-sidebar":"menu-item",className:Ut("group/menu-item relative",e),...t}));Nd.displayName="SidebarMenuItem";const L6e=Vw("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),jd=W.forwardRef(({asChild:e=!1,isActive:t=!1,variant:r="default",size:n="default",tooltip:a,className:c,...f},i)=>{const x=e?Ql:"button",{isMobile:w,state:A}=F_(),P=l.jsx(x,{ref:i,"data-sidebar":"menu-button","data-size":n,"data-active":t,className:Ut(L6e({variant:r,size:n}),c),...f});return a?(typeof a=="string"&&(a={children:a}),l.jsxs(fBe,{children:[l.jsx(pBe,{asChild:!0,children:P}),l.jsx(lne,{side:"right",align:"center",hidden:A!=="collapsed"||w,...a})]})):P});jd.displayName="SidebarMenuButton";const z6e=W.forwardRef(({className:e,asChild:t=!1,showOnHover:r=!1,...n},a)=>{const c=t?Ql:"button";return l.jsx(c,{ref:a,"data-sidebar":"menu-action",className:Ut("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...n})});z6e.displayName="SidebarMenuAction";const F6e=W.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,"data-sidebar":"menu-badge",className:Ut("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...t}));F6e.displayName="SidebarMenuBadge";const B6e=W.forwardRef(({className:e,showIcon:t=!1,...r},n)=>{const a=W.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return l.jsxs("div",{ref:n,"data-sidebar":"menu-skeleton",className:Ut("flex h-8 items-center gap-2 rounded-md px-2",e),...r,children:[t&&l.jsx(sT,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),l.jsx(sT,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":a}})]})});B6e.displayName="SidebarMenuSkeleton";const z3=W.forwardRef(({className:e,...t},r)=>l.jsx("ul",{ref:r,"data-sidebar":"menu-sub",className:Ut("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...t}));z3.displayName="SidebarMenuSub";const x0=W.forwardRef(({...e},t)=>l.jsx("li",{ref:t,...e}));x0.displayName="SidebarMenuSubItem";const _0=W.forwardRef(({asChild:e=!1,size:t="md",isActive:r,className:n,...a},c)=>{const f=e?Ql:"a";return l.jsx(f,{ref:c,"data-sidebar":"menu-sub-button","data-size":t,"data-active":r,className:Ut("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",t==="sm"&&"text-xs",t==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",n),...a})});_0.displayName="SidebarMenuSubButton";var Y4="Collapsible",[V6e,x$e]=Vd(Y4),[U6e,X4]=V6e(Y4),Ine=W.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:c,onOpenChange:f,...i}=e,[x=!1,w]=Kg({prop:n,defaultProp:a,onChange:f});return l.jsx(U6e,{scope:r,disabled:c,contentId:Rd(),open:x,onOpenToggle:W.useCallback(()=>w(A=>!A),[w]),children:l.jsx(vi.div,{"data-state":Q4(x),"data-disabled":c?"":void 0,...i,ref:t})})});Ine.displayName=Y4;var Dne="CollapsibleTrigger",Lne=W.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=X4(Dne,r);return l.jsx(vi.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Q4(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:ln(e.onClick,a.onOpenToggle)})});Lne.displayName=Dne;var J4="CollapsibleContent",zne=W.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=X4(J4,e.__scopeCollapsible);return l.jsx(Vu,{present:r||a.open,children:({present:c})=>l.jsx($6e,{...n,ref:t,present:c})})});zne.displayName=J4;var $6e=W.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...c}=e,f=X4(J4,r),[i,x]=W.useState(n),w=W.useRef(null),A=Ji(t,w),P=W.useRef(0),E=P.current,D=W.useRef(0),V=D.current,L=f.open||i,$=W.useRef(L),H=W.useRef(void 0);return W.useEffect(()=>{const K=requestAnimationFrame(()=>$.current=!1);return()=>cancelAnimationFrame(K)},[]),dl(()=>{const K=w.current;if(K){H.current=H.current||{transitionDuration:K.style.transitionDuration,animationName:K.style.animationName},K.style.transitionDuration="0s",K.style.animationName="none";const Q=K.getBoundingClientRect();P.current=Q.height,D.current=Q.width,$.current||(K.style.transitionDuration=H.current.transitionDuration,K.style.animationName=H.current.animationName),x(n)}},[f.open,n]),l.jsx(vi.div,{"data-state":Q4(f.open),"data-disabled":f.disabled?"":void 0,id:f.contentId,hidden:!L,...c,ref:A,style:{"--radix-collapsible-content-height":E?`${E}px`:void 0,"--radix-collapsible-content-width":V?`${V}px`:void 0,...e.style},children:L&&a})});function Q4(e){return e?"open":"closed"}var q6e=Ine;const TW=q6e,PW=Lne,NW=zne;function G6e(){const{isMobile:e}=F_(),t=Di(),{logout:r,userData:n}=t||{},a=()=>{r()};return l.jsx(vx,{children:l.jsx(Nd,{children:l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(jd,{size:"lg",className:"data-[state=open]:bg-sidebar-accent data-[state=open]:text-sidebar-accent-foreground",children:[l.jsxs(j3,{className:"h-8 w-8 rounded-lg",children:[l.jsx(C3,{src:n.avatar,alt:n.email}),l.jsx(k3,{className:"rounded-lg font-bold",children:n.email.charAt(0)})]}),l.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:l.jsx("span",{className:"truncate font-semibold",children:n.email})}),l.jsx(lH,{className:"ml-auto size-4"})]})}),l.jsxs(zd,{className:"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg",side:e?"bottom":"right",align:"end",sideOffset:4,children:[l.jsx(S_,{className:"p-0 font-normal",children:l.jsxs("div",{className:"flex items-center gap-2 px-1 py-1.5 text-left text-sm",children:[l.jsxs(j3,{className:"h-8 w-8 rounded-lg",children:[l.jsx(C3,{src:n.avatar,alt:n.email}),l.jsx(k3,{className:"rounded-lg font-bold",children:n.email.charAt(0)})]}),l.jsx("div",{className:"grid flex-1 text-left text-sm leading-tight",children:l.jsx("span",{className:"truncate font-semibold",children:n.email})})]})}),l.jsx(_m,{}),l.jsx(Sme,{children:l.jsxs(Ka,{children:[l.jsx(lue,{}),"Account"]})}),l.jsx(_m,{}),l.jsxs(Ka,{onSelect:a,children:[l.jsx(Jue,{}),"Log out"]})]})]})})})}function W6e(e){const t=co(),r=Di(),{userData:n}=r||{},{state:a}=F_(),[c,f]=W.useState(!1),[i,x]=W.useState(!1),w=a==="collapsed",A=D=>{f(D),D&&x(!1)},P=D=>{x(D),D&&f(!1)},E=(n==null?void 0:n.role)==="0"||(n==null?void 0:n.role)==="1";return n==null||n.role,l.jsxs(jne,{collapsible:"icon",...e,children:[l.jsx(Mne,{className:"group-data-[collapsible=icon]:flex group-data-[collapsible=icon]:justify-center",children:l.jsx(vx,{children:l.jsx(Nd,{children:l.jsxs(jd,{tooltip:"LTO WebSystem",className:"group-data-[collapsible=icon]:justify-center",children:[l.jsx("div",{className:"flex aspect-square size-8 items-center justify-center rounded-lg text-sidebar-primary-foreground group-data-[collapsible=icon]:size-6",children:l.jsx("img",{src:G1,className:"h-7 w-7 object-contain group-data-[collapsible=icon]:h-6 group-data-[collapsible=icon]:w-6",alt:"LTO Logo"})}),l.jsxs("div",{className:"grid flex-1 text-left text-sm leading-tight group-data-[collapsible=icon]:hidden",children:[l.jsx("span",{className:"truncate font-semibold",children:"LTO WebSystem"}),l.jsx("span",{className:"truncate text-xs",children:"Land Transportation Office"})]})]})})})}),l.jsxs(Rne,{children:[l.jsxs(TA,{children:[l.jsx(PA,{children:"Menu"}),l.jsxs(vx,{className:"",children:[l.jsx(Nd,{children:l.jsx(jd,{isActive:t.pathname==="/",asChild:!0,children:l.jsxs(Fo,{to:"/",children:[l.jsx(bde,{}),l.jsx("span",{children:"Dashboard"})]})})}),l.jsx(Nd,{children:l.jsx(jd,{isActive:t.pathname==="/vehicle",asChild:!0,children:l.jsxs(Fo,{to:"/vehicle",children:[l.jsx(cl,{}),l.jsx("span",{children:"Manage Vehicles"})]})})}),l.jsx(Nd,{children:l.jsx(jd,{isActive:t.pathname==="/driver",asChild:!0,children:l.jsxs(Fo,{to:"/driver",children:[l.jsx(tD,{}),l.jsx("span",{children:"Manage Drivers"})]})})}),l.jsx(Nd,{children:l.jsx(jd,{isActive:t.pathname==="/violation",asChild:!0,children:l.jsxs(Fo,{to:"/violation",children:[l.jsx(tC,{}),l.jsx("span",{children:"Manage Violations"})]})})}),l.jsx(Nd,{children:l.jsx(jd,{isActive:t.pathname==="/accident",asChild:!0,children:l.jsxs(Fo,{to:"/accident",children:[l.jsx(eC,{}),l.jsx("span",{children:"Manage Accidents"})]})})})]})]}),l.jsxs(TA,{children:[l.jsx(PA,{children:"Analytics"}),l.jsx(vx,{children:w?l.jsx(Nd,{children:l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(jd,{tooltip:"Analytics",children:[l.jsx(P1,{}),l.jsx("span",{children:"Analytics"})]})}),l.jsxs(zd,{side:"right",align:"start",className:"w-48",children:[l.jsx(Ka,{asChild:!0,children:l.jsxs(Fo,{to:"/analytics/registration",className:"flex items-center gap-2",children:[l.jsx(VB,{className:"h-4 w-4"}),l.jsx("span",{children:"Registration"})]})}),l.jsx(Ka,{asChild:!0,children:l.jsxs(Fo,{to:"/analytics/violation",className:"flex items-center gap-2",children:[l.jsx(tC,{className:"h-4 w-4"}),l.jsx("span",{children:"Violation"})]})}),l.jsx(Ka,{asChild:!0,children:l.jsxs(Fo,{to:"/analytics/accident",className:"flex items-center gap-2",children:[l.jsx(eC,{className:"h-4 w-4"}),l.jsx("span",{children:"Accident"})]})})]})]})}):l.jsx(TW,{asChild:!0,className:"group/collapsible",open:c,onOpenChange:A,children:l.jsxs(Nd,{children:[l.jsx(PW,{asChild:!0,children:l.jsxs(jd,{children:[l.jsx(P1,{}),l.jsx("span",{children:"Analytics"}),l.jsx(L0,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),l.jsx(NW,{children:l.jsxs(z3,{children:[l.jsx(x0,{children:l.jsx(_0,{isActive:t.pathname==="/analytics/registration",asChild:!0,children:l.jsxs(Fo,{to:"/analytics/registration",children:[l.jsx(VB,{}),l.jsx("span",{children:"Registration"})]})})}),l.jsx(x0,{children:l.jsx(_0,{isActive:t.pathname==="/analytics/violation",asChild:!0,children:l.jsxs(Fo,{to:"/analytics/violation",children:[l.jsx(tC,{}),l.jsx("span",{children:"Violation"})]})})}),l.jsx(x0,{children:l.jsx(_0,{isActive:t.pathname==="/analytics/accident",asChild:!0,children:l.jsxs(Fo,{to:"/analytics/accident",children:[l.jsx(eC,{}),l.jsx("span",{children:"Accident"})]})})})]})})]})})})]}),E&&l.jsxs(TA,{children:[l.jsx(PA,{children:"Account Management"}),l.jsx(vx,{children:w?l.jsx(Nd,{children:l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(jd,{tooltip:"Manage Account",children:[l.jsx(Du,{}),l.jsx("span",{children:"Manage Account"})]})}),l.jsxs(zd,{side:"right",align:"start",className:"w-48",children:[l.jsx(Ka,{asChild:!0,children:l.jsxs(Fo,{to:"/account/register",className:"flex items-center gap-2",children:[l.jsx(MA,{className:"h-4 w-4"}),l.jsx("span",{children:"Register Account"})]})}),l.jsx(Ka,{asChild:!0,children:l.jsxs(Fo,{to:"/account/update",className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-4 w-4"}),l.jsx("span",{children:"Update Account"})]})}),l.jsx(Ka,{asChild:!0,children:l.jsxs(Fo,{to:"/account/logs",className:"flex items-center gap-2",children:[l.jsx(Ld,{className:"h-4 w-4"}),l.jsx("span",{children:"View Account Logs"})]})})]})]})}):l.jsx(TW,{asChild:!0,className:"group/collapsible",open:i,onOpenChange:P,children:l.jsxs(Nd,{children:[l.jsx(PW,{asChild:!0,children:l.jsxs(jd,{children:[l.jsx(Du,{}),l.jsx("span",{children:"Manage Account"}),l.jsx(L0,{className:"ml-auto transition-transform duration-200 group-data-[state=open]/collapsible:rotate-90"})]})}),l.jsx(NW,{children:l.jsxs(z3,{children:[l.jsx(x0,{children:l.jsx(_0,{isActive:t.pathname==="/account/register",asChild:!0,children:l.jsxs(Fo,{to:"/account/register",children:[l.jsx(MA,{}),l.jsx("span",{children:"Register Account"})]})})}),l.jsx(x0,{children:l.jsx(_0,{isActive:t.pathname==="/account/update",asChild:!0,children:l.jsxs(Fo,{to:"/account/update",children:[l.jsx(ao,{}),l.jsx("span",{children:"Update Account"})]})})}),l.jsx(x0,{children:l.jsx(_0,{isActive:t.pathname==="/account/logs",asChild:!0,children:l.jsxs(Fo,{to:"/account/logs",children:[l.jsx(Ld,{}),l.jsx("span",{children:"View Account Logs"})]})})})]})})]})})})]})]}),l.jsx(One,{children:l.jsx(G6e,{})}),l.jsx(kne,{})]})}const Fne=W.forwardRef(({...e},t)=>l.jsx("nav",{ref:t,"aria-label":"breadcrumb",...e}));Fne.displayName="Breadcrumb";const Bne=W.forwardRef(({className:e,...t},r)=>l.jsx("ol",{ref:r,className:Ut("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5",e),...t}));Bne.displayName="BreadcrumbList";const F3=W.forwardRef(({className:e,...t},r)=>l.jsx("li",{ref:r,className:Ut("inline-flex items-center gap-1.5",e),...t}));F3.displayName="BreadcrumbItem";const Vne=W.forwardRef(({asChild:e,className:t,...r},n)=>{const a=e?Ql:"a";return l.jsx(a,{ref:n,className:Ut("transition-colors hover:text-foreground",t),...r})});Vne.displayName="BreadcrumbLink";const Une=W.forwardRef(({className:e,...t},r)=>l.jsx("span",{ref:r,role:"link","aria-disabled":"true","aria-current":"page",className:Ut("font-normal text-foreground",e),...t}));Une.displayName="BreadcrumbPage";const $ne=({children:e,className:t,...r})=>l.jsx("li",{role:"presentation","aria-hidden":"true",className:Ut("[&>svg]:w-3.5 [&>svg]:h-3.5",t),...r,children:e??l.jsx(L0,{})});$ne.displayName="BreadcrumbSeparator";const H6e=()=>{wa();const e=co(),t=()=>{const r=e.pathname;if(r.includes("/driver/")&&r.includes("/edit"))return"Edit Driver";if(r.includes("/vehicle/")&&r.includes("/edit"))return"Edit Vehicle";if(r.includes("/violation/")&&r.includes("/edit"))return"Edit Violation";if(r.includes("/accident/")&&r.includes("/edit"))return"Edit Accident";if(r.match(/^\/driver\/[a-zA-Z0-9]+$/))return null;switch(r){case"/":return"Overview";case"/driver":return"Drivers";case"/vehicle":return"Vehicles";case"/violation":return"Violations";case"/accident":return"Accidents";case"/analytics/registration":return"Registration Analytics";case"/analytics/violation":return"Violation Analytics";case"/analytics/accident":return"Accident Analytics";case"/account/register":return"Register Account";case"/account/update":return"Update Account";case"/account/logs":return"Account Logs";default:return"Overview"}};return l.jsx(l.Fragment,{children:l.jsxs(Nne,{children:[l.jsx(W6e,{}),l.jsxs(Ene,{children:[l.jsxs("header",{className:"flex justify-between border-b h-16 shrink-0 items-center gap-2 transition-[width,height] ease-linear group-has-[[data-collapsible=icon]]/sidebar-wrapper:h-12 bg-white dark:bg-black border-gray-200 dark:border-gray-700",children:[l.jsxs("div",{className:"flex items-center gap-2 px-4",children:[l.jsx(Cne,{className:"-ml-1"}),l.jsx(P2,{orientation:"vertical",className:"mr-2 h-4"}),t()&&l.jsx(Fne,{children:l.jsxs(Bne,{children:[l.jsx(F3,{className:"hidden md:block",children:l.jsx(Vne,{href:"/",children:"Dashboard"})}),l.jsx($ne,{className:"hidden md:block"}),l.jsx(F3,{children:l.jsx(Une,{children:t()})})]})})]}),l.jsx("div",{className:"px-4 md:px-8",children:l.jsx(jme,{})})]}),l.jsx("main",{className:"md:p-4 h-full flex flex-col overflow-hidden",children:l.jsx(GW,{})})]})]})})},K6e=({searchPlaceholder:e=null,title:t,filters:r,description:n,tableColumn:a,data:c,loading:f,onNavigate:i,onAdd:x,onRowClick:w,onEdit:A,onDelete:P,onFileNumberClick:E})=>{var pe;const[D,V]=Oe.useState([]),[L,$]=Oe.useState([]),[H,K]=Oe.useState({emailAddress:!1}),[Q,ae]=Oe.useState({}),[ee,se]=Oe.useState({pageIndex:0,pageSize:8}),[ce,he]=Oe.useState(""),Pe=r,Ne=E2({data:c,columns:a(A,P,E),onSortingChange:V,onColumnFiltersChange:$,onPaginationChange:se,getCoreRowModel:N2(),getPaginationRowModel:C2(),getSortedRowModel:k2(),getFilteredRowModel:j2(),onColumnVisibilityChange:K,onColumnSizingChange:ae,onGlobalFilterChange:he,globalFilterFn:(je,xe,Ce)=>Pe.some(ze=>{const Te=je.getValue(ze);return String(Te).toLowerCase().includes(Ce.toLowerCase())}),state:{pagination:ee,sorting:D,columnFilters:L,columnVisibility:H,columnSizing:Q,globalFilter:ce},enableColumnResizing:!0,columnResizeMode:"onChange"});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsx(ls,{className:"font-semibold",children:t}),l.jsxs("div",{className:`md:flex items-center justify-between py-3 flex-shrink-0
        `,children:[l.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[l.jsx(v_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),l.jsx(kn,{placeholder:"Search Driver...",value:ce??"",onChange:je=>he(je.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"}),ce&&l.jsx("button",{onClick:()=>he(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(Qf,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[l.jsxs(Nr,{onClick:x,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[l.jsx(J0,{}),l.jsx("span",{className:"hidden lg:inline",children:"Add Driver"})]}),l.jsx(O2,{table:Ne})]})]}),l.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0",children:l.jsx("div",{className:"overflow-auto h-full",children:l.jsx("div",{className:"px-0",children:l.jsxs(km,{children:[l.jsx(Em,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:Ne.getHeaderGroups().map(je=>l.jsx(Ns,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:je.headers.map(xe=>l.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",style:{width:xe.getSize()},children:cp(xe.column.columnDef.header,xe.getContext())},xe.id))},je.id))}),l.jsx(Mm,{className:"text-xs bg-white dark:bg-transparent",children:f?l.jsx(M2,{rowCount:5,cellCount:Ne.getAllColumns().length}):(pe=Ne.getRowModel().rows)!=null&&pe.length?Ne.getRowModel().rows.map(je=>l.jsx(Ns,{onClick:()=>w(je.original),"data-state":je.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:je.getVisibleCells().map(xe=>l.jsx(ha,{className:"px-3 py-2 text-gray-800 dark:text-gray-200 text-left max-w-0",style:{width:xe.column.getSize()},children:cp(xe.column.columnDef.cell,xe.getContext())},xe.id))},je.id)):l.jsx(Ns,{className:"hover:bg-transparent",children:l.jsx(ha,{colSpan:Ne.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center justify-center",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),l.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),l.jsx("div",{className:"mt-3 flex-shrink-0",children:l.jsx(R2,{table:Ne})})]})};var qne="AlertDialog",[Z6e,_$e]=Vd(qne,[cY]),Om=cY(),Gne=e=>{const{__scopeAlertDialog:t,...r}=e,n=Om(t);return l.jsx(VD,{...n,...r,modal:!0})};Gne.displayName=qne;var Y6e="AlertDialogTrigger",X6e=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Om(r);return l.jsx(yve,{...a,...n,ref:t})});X6e.displayName=Y6e;var J6e="AlertDialogPortal",Wne=e=>{const{__scopeAlertDialog:t,...r}=e,n=Om(t);return l.jsx(UD,{...n,...r})};Wne.displayName=J6e;var Q6e="AlertDialogOverlay",Hne=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Om(r);return l.jsx(Qw,{...a,...n,ref:t})});Hne.displayName=Q6e;var Tx="AlertDialogContent",[eVe,tVe]=Z6e(Tx),Kne=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,c=Om(r),f=W.useRef(null),i=Ji(t,f),x=W.useRef(null);return l.jsx(fve,{contentName:Tx,titleName:Zne,docsSlug:"alert-dialog",children:l.jsx(eVe,{scope:r,cancelRef:x,children:l.jsxs(e2,{role:"alertdialog",...c,...a,ref:i,onOpenAutoFocus:ln(a.onOpenAutoFocus,w=>{var A;w.preventDefault(),(A=x.current)==null||A.focus({preventScroll:!0})}),onPointerDownOutside:w=>w.preventDefault(),onInteractOutside:w=>w.preventDefault(),children:[l.jsx(Z3,{children:n}),l.jsx(nVe,{contentRef:f})]})})})});Kne.displayName=Tx;var Zne="AlertDialogTitle",Yne=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Om(r);return l.jsx(t2,{...a,...n,ref:t})});Yne.displayName=Zne;var Xne="AlertDialogDescription",Jne=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Om(r);return l.jsx(r2,{...a,...n,ref:t})});Jne.displayName=Xne;var rVe="AlertDialogAction",Qne=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Om(r);return l.jsx($P,{...a,...n,ref:t})});Qne.displayName=rVe;var eie="AlertDialogCancel",tie=W.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=tVe(eie,r),c=Om(r),f=Ji(t,a);return l.jsx($P,{...c,...n,ref:f})});tie.displayName=eie;var nVe=({contentRef:e})=>{const t=`\`${Tx}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Tx}\` by passing a \`${Xne}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Tx}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return W.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},iVe=Gne,aVe=Wne,rie=Hne,nie=Kne,iie=Qne,aie=tie,sie=Yne,oie=Jne;const lie=iVe,sVe=aVe,cie=W.forwardRef(({className:e,...t},r)=>l.jsx(rie,{className:Ut("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));cie.displayName=rie.displayName;const e5=W.forwardRef(({className:e,...t},r)=>l.jsxs(sVe,{children:[l.jsx(cie,{}),l.jsx(nie,{ref:r,className:Ut("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));e5.displayName=nie.displayName;const t5=({className:e,...t})=>l.jsx("div",{className:Ut("flex flex-col space-y-2 text-center sm:text-left",e),...t});t5.displayName="AlertDialogHeader";const r5=({className:e,...t})=>l.jsx("div",{className:Ut("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});r5.displayName="AlertDialogFooter";const n5=W.forwardRef(({className:e,...t},r)=>l.jsx(sie,{ref:r,className:Ut("text-lg font-semibold",e),...t}));n5.displayName=sie.displayName;const i5=W.forwardRef(({className:e,...t},r)=>l.jsx(oie,{ref:r,className:Ut("text-sm text-muted-foreground",e),...t}));i5.displayName=oie.displayName;const a5=W.forwardRef(({className:e,...t},r)=>l.jsx(iie,{ref:r,className:Ut(T1({variant:"outline"}),e),...t}));a5.displayName=iie.displayName;const s5=W.forwardRef(({className:e,...t},r)=>l.jsx(aie,{ref:r,className:Ut(T1(),"mt-2 sm:mt-0",e),...t}));s5.displayName=aie.displayName;const uie=({open:e,onOpenChange:t,confirm:r,cancel:n,title:a,description:c})=>l.jsx(lie,{open:e,onOpenChange:t,children:l.jsxs(e5,{className:"",children:[l.jsxs(t5,{children:[l.jsx(n5,{children:a}),l.jsx(i5,{children:c})]}),l.jsxs(r5,{children:[l.jsx(s5,{onClick:n,children:"Cancel"}),l.jsx(a5,{onClick:r,children:"Continue"})]})]})});var o5="Popover",[die,b$e]=Vd(o5,[ly]),I2=ly(),[oVe,yy]=die(o5),hie=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:c,modal:f=!1}=e,i=I2(t),x=W.useRef(null),[w,A]=W.useState(!1),[P=!1,E]=Kg({prop:n,defaultProp:a,onChange:c});return l.jsx(AP,{...i,children:l.jsx(oVe,{scope:t,contentId:Rd(),triggerRef:x,open:P,onOpenChange:E,onOpenToggle:W.useCallback(()=>E(D=>!D),[E]),hasCustomAnchor:w,onCustomAnchorAdd:W.useCallback(()=>A(!0),[]),onCustomAnchorRemove:W.useCallback(()=>A(!1),[]),modal:f,children:r})})};hie.displayName=o5;var fie="PopoverAnchor",lVe=W.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=yy(fie,r),c=I2(r),{onCustomAnchorAdd:f,onCustomAnchorRemove:i}=a;return W.useEffect(()=>(f(),()=>i()),[f,i]),l.jsx(Gw,{...c,...n,ref:t})});lVe.displayName=fie;var pie="PopoverTrigger",mie=W.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=yy(pie,r),c=I2(r),f=Ji(t,a.triggerRef),i=l.jsx(vi.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":_ie(a.open),...n,ref:f,onClick:ln(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:l.jsx(Gw,{asChild:!0,...c,children:i})});mie.displayName=pie;var l5="PopoverPortal",[cVe,uVe]=die(l5,{forceMount:void 0}),gie=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,c=yy(l5,t);return l.jsx(cVe,{scope:t,forceMount:r,children:l.jsx(Vu,{present:r||c.open,children:l.jsx(w_,{asChild:!0,container:a,children:n})})})};gie.displayName=l5;var h_="PopoverContent",yie=W.forwardRef((e,t)=>{const r=uVe(h_,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,c=yy(h_,e.__scopePopover);return l.jsx(Vu,{present:n||c.open,children:c.modal?l.jsx(dVe,{...a,ref:t}):l.jsx(hVe,{...a,ref:t})})});yie.displayName=h_;var dVe=W.forwardRef((e,t)=>{const r=yy(h_,e.__scopePopover),n=W.useRef(null),a=Ji(t,n),c=W.useRef(!1);return W.useEffect(()=>{const f=n.current;if(f)return jP(f)},[]),l.jsx(Ww,{as:Ql,allowPinchZoom:!0,children:l.jsx(vie,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ln(e.onCloseAutoFocus,f=>{var i;f.preventDefault(),c.current||(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ln(e.onPointerDownOutside,f=>{const i=f.detail.originalEvent,x=i.button===0&&i.ctrlKey===!0,w=i.button===2||x;c.current=w},{checkForDefaultPrevented:!1}),onFocusOutside:ln(e.onFocusOutside,f=>f.preventDefault(),{checkForDefaultPrevented:!1})})})}),hVe=W.forwardRef((e,t)=>{const r=yy(h_,e.__scopePopover),n=W.useRef(!1),a=W.useRef(!1);return l.jsx(vie,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,c),c.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),c.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:c=>{var x,w;(x=e.onInteractOutside)==null||x.call(e,c),c.defaultPrevented||(n.current=!0,c.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const f=c.target;((w=r.triggerRef.current)==null?void 0:w.contains(f))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&a.current&&c.preventDefault()}})}),vie=W.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:c,disableOutsidePointerEvents:f,onEscapeKeyDown:i,onPointerDownOutside:x,onFocusOutside:w,onInteractOutside:A,...P}=e,E=yy(h_,r),D=I2(r);return _P(),l.jsx($w,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:c,children:l.jsx(x_,{asChild:!0,disableOutsidePointerEvents:f,onInteractOutside:A,onEscapeKeyDown:i,onPointerDownOutside:x,onFocusOutside:w,onDismiss:()=>E.onOpenChange(!1),children:l.jsx(TP,{"data-state":_ie(E.open),role:"dialog",id:E.contentId,...D,...P,ref:t,style:{...P.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),xie="PopoverClose",fVe=W.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=yy(xie,r);return l.jsx(vi.button,{type:"button",...n,ref:t,onClick:ln(e.onClick,()=>a.onOpenChange(!1))})});fVe.displayName=xie;var pVe="PopoverArrow",mVe=W.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=I2(r);return l.jsx(PP,{...a,...n,ref:t})});mVe.displayName=pVe;function _ie(e){return e?"open":"closed"}var gVe=hie,yVe=mie,vVe=gie,bie=yie;const Y0=gVe,X0=yVe,sy=W.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>l.jsx(vVe,{children:l.jsx(bie,{ref:a,align:t,sideOffset:r,className:Ut("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));sy.displayName=bie.displayName;const D2=({fieldValue:e,dateValue:t})=>{const r=new Date,[n,a]=W.useState(e||r),[c,f]=W.useState((e||r).getFullYear()),[i,x]=W.useState((e||r).getMonth()),w=E=>{f(E);const D=N3(n,E);a(D),t&&t(D)},A=E=>{x(E);const D=SA(n,E);a(D),t&&t(D)},P=E=>{E&&(a(E),f(E.getFullYear()),x(E.getMonth()),t&&t(E))};return W.useEffect(()=>{e&&(a(e),f(e.getFullYear()),x(e.getMonth()))},[e]),l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(Uo,{onValueChange:E=>A(parseInt(E,10)),value:i.toString(),children:[l.jsx(So,{children:l.jsx($o,{placeholder:"Select Month"})}),l.jsx(Ao,{children:Array.from({length:12},(E,D)=>l.jsx(pn,{value:D.toString(),children:wc(new Date(2e3,D,1),"MMMM")},D))})]}),l.jsxs(Uo,{onValueChange:E=>w(parseInt(E,10)),value:c.toString(),children:[l.jsx(So,{children:l.jsx($o,{placeholder:"Select Year"})}),l.jsx(Ao,{children:Array.from({length:150},(E,D)=>{const V=new Date().getFullYear()-50+D;return l.jsx(pn,{value:V.toString(),children:V},V)})})]})]}),l.jsx("div",{className:"border rounded-md",children:l.jsx(Lw,{mode:"single",selected:n,onSelect:P,disabled:E=>E<new Date("1900-01-01"),fromYear:1900,toYear:new Date().getFullYear()+10,month:n,onMonthChange:E=>{a(E),f(E.getFullYear()),x(E.getMonth())}})}),l.jsx("div",{className:"flex justify-end",children:l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>{x(r.getMonth()),f(r.getFullYear()),a(r),t&&t(r)},children:"Today"})})]})},Ff={region:"DAVAO ORIENTAL",municipalities:{BANAYBANAY:{barangays:{CABANGCALAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CAGANGANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CALUBIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAUSWAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MOGBONGCOGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},PANIKIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PINTATAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PISO PROPER":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"PUNTA LINAO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"RANG-AY":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BOSTON:{barangays:{CAATIHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABASAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CARMEN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAWAYANAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SIBAJAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SIMULAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},BAGANGA:{barangays:{BACULIN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BATAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATIANO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BINONDO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBONAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMPAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DAPNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},KINABLANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBAJON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAHANUB:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MIKIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SALINGCOMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN VICTOR":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAOQUEGUE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CARAGA:{barangays:{ALVAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CANINGAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON LEON BALANTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMIAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANORIGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MERCEDES:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"PALMA GIL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},PICHON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN LUIS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN PEDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SANTA FE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANTIAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SOBRECAREY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},CATEEL:{barangays:{ABIJOD:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ALEGRIA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ALIWAGWAG:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},ARAGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BAYBAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGLAHUS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAINIT:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MALIBAGO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ALFONSO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ANTONIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN RAFAEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN VICENTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTA FILOMENA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAYTAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]}}},"GOVERNOR GENEROSO":{barangays:{ANITAP:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"CRISPIN DELA CRUZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON AURELIO CHICOTE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAVIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUZON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGDUG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"MANUEL ROXAS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MONTSERRAT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},NANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},OREGON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},PUNDAGUITAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SERGIO OSMEÑA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SUROP:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABEBE:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"TANDANG SORA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TIBANBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TIBLAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"UPPER TIBANBAN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},LUPON:{barangays:{BAGUMBAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABADIANGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CALAPAGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},COCORNON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CORPORACION:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON MARIANO MARCOS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ILANGAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANTAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMBAHAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACANGAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGSAYSAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAHAYAHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MARAGATAS:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MARAYAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW VISAYAS":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},POBLACION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN JOSE":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGBOA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGUGPO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},MANAY:{barangays:{CAPASNAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CAYAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CONCEPCION:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DEL PILAR":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},GUZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"HOLY CROSS":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAMBOG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MABINI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MANREZA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"NEW TAOKANGA":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"OLD MACOPA":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},RIZAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN FERMIN":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN IGNACIO":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN ISIDRO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},ZARAGOSA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}},"CITY OF MATI":{barangays:{BADAS:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BOBON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BUSO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CABUAYA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},CULIAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAHICAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DANAO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},DAWAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON ENRIQUE LOPEZ":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"DON MARTIN MARUNDAN":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"DON SALVADOR LOPEZ, SR.":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LANGKA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LAWIGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LIBUDON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LUBAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MACAMBOL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAMALI:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MATIAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAYO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SAINZ:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},SANGHAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGABAKID:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAGBINONGA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TAGUIBO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TAMISAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},"SAN ISIDRO":{barangays:{BAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},BATOBATO:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},BITAOGAN:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},CAMBALEON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},DUGMANON:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},IBA:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"LA UNION":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"LAPU-LAPU":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAAG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MANIKLING:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},MAPUTI:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SAN MIGUEL":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},"SAN ROQUE":{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},"SANTO ROSARIO":{puroks:["PUROK 1","PUROK 2","PUROK 3"]},SUDLON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TALISAY:{puroks:["PUROK 1","PUROK 2","PUROK 3"]}}},TARRAGONA:{barangays:{CABAGAYAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},CENTRAL:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4","PUROK 5"]},DADONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},JOVELLAR:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},LIMOT:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},LUCATAN:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},MAGANDA:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},OMPAO:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]},TOMOAONG:{puroks:["PUROK 1","PUROK 2","PUROK 3"]},TUBAON:{puroks:["PUROK 1","PUROK 2","PUROK 3","PUROK 4"]}}}}},xVe=({form:e,isEditMode:t=!1,onLocationChange:r})=>{const[n,a]=W.useState(""),[c,f]=W.useState(""),[i,x]=W.useState(""),[w,A]=W.useState(""),[P,E]=W.useState(""),[D,V]=W.useState(""),$=Object.keys(Ff.municipalities).filter(he=>he.toLowerCase().includes(w.toLowerCase())),K=(n?Object.keys(Ff.municipalities[n].barangays):[]).filter(he=>he.toLowerCase().includes(P.toLowerCase())),ae=(n&&c?Ff.municipalities[n].barangays[c].puroks:[]).filter(he=>he.toLowerCase().includes(D.toLowerCase())),ee=he=>{console.log("Setting municipality:",he),a(he),f(""),x(""),A(""),E(""),V(""),console.log("=== SETTING MUNICIPALITY ==="),console.log("Setting municipality to:",he),e.setValue("municipality",he,{shouldValidate:!0,shouldDirty:!0}),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("province",Ff.region,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after municipality change:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")}),setTimeout(()=>{console.log("Form values after 100ms delay:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},100),r&&r({region:Ff.region,municipality:he,barangay:"",purok:""})},se=he=>{console.log("Setting barangay:",he),f(he),x(""),E(""),V(""),console.log("=== SETTING BARANGAY ==="),console.log("Setting barangay to:",he),e.setValue("barangay",he,{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after barangay change:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")}),setTimeout(()=>{console.log("Form values after barangay 100ms delay:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},100),r&&r({region:Ff.region,municipality:n,barangay:he,purok:""})},ce=he=>{x(he),V(""),e.setValue("purok",he,{shouldValidate:!0,shouldDirty:!0}),r&&r({region:Ff.region,municipality:n,barangay:c,purok:he})};return W.useEffect(()=>{console.log("Initializing province:",Ff.region),e.setValue("province",Ff.region,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after province initialization:",{municipality:e.getValues("municipality"),barangay:e.getValues("barangay"),province:e.getValues("province")})},[e]),W.useEffect(()=>{const he=e.getValues("municipality"),Pe=e.getValues("barangay"),Ne=e.getValues("purok");console.log("=== INITIALIZING LOCATION SELECTOR ==="),console.log("Current form values:",{currentMunicipality:he,currentBarangay:Pe,currentPurok:Ne}),he&&he!==n&&(console.log("Setting municipality to:",he),a(he)),Pe&&Pe!==c&&(console.log("Setting barangay to:",Pe),f(Pe)),Ne&&Ne!==i&&(console.log("Setting purok to:",Ne),x(Ne))},[e.watch("municipality"),e.watch("barangay"),e.watch("purok")]),W.useEffect(()=>{const he=Pe=>{(w||P||D)&&!Pe.target.closest(".relative")&&(A(""),E(""),V(""))};return document.addEventListener("mousedown",he),()=>{document.removeEventListener("mousedown",he)}},[w,P,D]),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"space-y-0",children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Province"}),l.jsx("div",{className:"mt-0 p-3 bg-muted rounded-md border",children:l.jsx("span",{className:"text-sm font-medium",children:Ff.region})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"space-y-0",children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Municipality"}),l.jsxs("div",{className:"relative mt-0",children:[l.jsx(kn,{type:"text",autoFocus:!1,placeholder:"Type to search municipality...",value:n||w,onChange:he=>{const Pe=he.target.value.toUpperCase();A(Pe),n&&Pe!==n&&(a(""),f(""),x(""),e.setValue("municipality","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},className:Ut("mt-1",e.formState.errors.municipality&&"border-red-400",t&&"text-[8px]")}),w&&l.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:$.length>0?$.map(he=>l.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ee(he),children:he},he)):l.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No municipalities found"})})]}),e.formState.errors.municipality&&l.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.municipality.message})]}),l.jsxs("div",{className:"space-y-0",children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Barangay"}),l.jsxs("div",{className:"relative mt-0",children:[l.jsx(kn,{type:"text",autoFocus:!1,placeholder:n?"Type to search barangay...":"Select municipality first",value:c||P,onChange:he=>{const Pe=he.target.value.toUpperCase();E(Pe),c&&Pe!==c&&(f(""),e.setValue("barangay","",{shouldValidate:!0,shouldDirty:!0}),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},disabled:!n,className:Ut("mt-1",!n&&"opacity-50 cursor-not-allowed",e.formState.errors.barangay&&"border-red-400",t&&"text-[8px]")}),n&&P&&l.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:K.length>0?K.map(he=>l.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>se(he),children:he},he)):l.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No barangays found"})})]}),e.formState.errors.barangay&&l.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.barangay.message})]}),l.jsxs("div",{className:"space-y-0",children:[l.jsx("label",{className:"text-xs font-medium text-muted-foreground mb-0",children:"Purok"}),l.jsxs("div",{className:"relative mt-0",children:[l.jsx(kn,{type:"text",autoFocus:!1,placeholder:c?"Type to search purok...":"Select barangay first",value:i||D,onChange:he=>{const Pe=he.target.value.toUpperCase();V(Pe),i&&Pe!==i&&(x(""),e.setValue("purok","",{shouldValidate:!0,shouldDirty:!0}))},disabled:!c,className:Ut("mt-1",!c&&"opacity-50 cursor-not-allowed",e.formState.errors.purok&&"border-red-400",t&&"text-[8px]")}),c&&D&&l.jsx("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-60 overflow-y-auto scrollbar-transparent",children:ae.length>0?ae.map(he=>l.jsx("div",{className:"px-3 py-2 cursor-pointer hover:bg-accent text-sm text-foreground",onClick:()=>ce(he),children:he},he)):l.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No puroks found"})})]}),e.formState.errors.purok&&l.jsx("p",{className:"text-xs text-red-400 mt-1",children:e.formState.errors.purok.message})]})]})]})},c5=({onSubmit:e,form:t,submitting:r,onCancel:n,isEditMode:a=!1})=>(wa(),l.jsx(ip,{...t,children:l.jsx("form",{id:"driver-form",onSubmit:t.handleSubmit(e),children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium",children:"Vehicle Information"}),l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-x-3",children:[l.jsx(En,{control:t.control,name:"plateNo",render:({field:c})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),l.jsx(Nn,{children:l.jsx(kn,{...c,type:"text",autoFocus:!1,placeholder:"ABC-123, DEF-456",value:Array.isArray(c.value)?c.value.join(", "):c.value||"",onChange:f=>{if(!a){const i=f.target.value.toUpperCase(),x=i.split(",").map(w=>w.trim()).filter(w=>w.length>0);c.onChange(x.length>0?x:i)}},disabled:a,className:Ut("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.plateNo&&"border-red-400",a&&"bg-gray-100 dark:bg-gray-700 cursor-not-allowed text-[8px] text-gray-600 dark:text-gray-300")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"fileNo",render:({field:c})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),l.jsx(Nn,{className:"mt-0",children:l.jsx(kn,{...c,type:"text",autoFocus:!1,onChange:f=>{if(!a){const i=f.target.value.toUpperCase();c.onChange(i)}},disabled:a,className:Ut("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.fileNo&&"border-red-400",a&&"bg-gray-100 dark:bg-gray-700 cursor-not-allowed text-[8px] text-gray-600 dark:text-gray-300")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"ownerRepresentativeName",render:({field:c})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.ownerRepresentativeName&&"text-red-400"),children:"Owner's Name"}),l.jsx(Nn,{children:l.jsx(kn,{...c,type:"text",autoFocus:!1,onChange:f=>{const i=f.target.value.toUpperCase();c.onChange(i)},className:Ut("border border-input focus:ring-0 text-black dark:text-white",t.formState.errors.ownerRepresentativeName&&"border-red-400",a&&"text-[8px]")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})]}),l.jsx("div",{children:l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[l.jsx(En,{control:t.control,name:"birthDate",render:({field:c})=>l.jsxs(jn,{className:"lg:col-span-3 space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.birthDate&&"text-red-400"),children:"Birthday (Optional)"}),l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsx(Nn,{children:l.jsxs(Nr,{variant:"outline",className:Ut("w-full text-left font-normal justify-start",!c.value&&"text-muted-foreground",t.formState.errors.birthDate&&"border-red-400"),children:[l.jsx(so,{className:"h-4 w-4 opacity-50"}),c.value?wc(c.value,"PPP"):l.jsx("span",{children:"Pick a date"})]})})}),l.jsx(sy,{className:"w-auto p-2 space-y-2",align:"start",children:l.jsx(D2,{fieldValue:c.value,dateValue:f=>t.setValue("birthDate",f,{shouldValidate:!0})})})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"contactNumber",render:({field:c})=>l.jsxs(jn,{className:"lg:col-span-3 space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.contactNumber&&"text-red-400"),children:"Contact Number (Optional)"}),l.jsx(Nn,{children:l.jsx(kn,{...c,type:"tel",autoFocus:!1,className:Ut("text-black dark:text-white",t.formState.errors.contactNumber&&"border-red-400",a&&"text-[8px]")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"emailAddress",render:({field:c})=>l.jsxs(jn,{className:"lg:col-span-3 space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.emailAddress&&"text-red-400"),children:"Email Address (Optional)"}),l.jsx(Nn,{children:l.jsx(kn,{...c,type:"email",autoFocus:!1,className:Ut("text-black dark:text-white",t.formState.errors.emailAddress&&"border-red-400",a&&"text-[8px]")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})}),l.jsx("div",{children:l.jsx("div",{className:"mt-4",children:l.jsx(xVe,{form:t,isEditMode:a,onLocationChange:c=>{console.log("Location changed:",c)}})})}),l.jsx("div",{children:l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-9 gap-x-3",children:[l.jsx(En,{control:t.control,name:"hasDriversLicense",render:({field:c})=>{var f;return l.jsxs(jn,{className:"lg:col-span-3 space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs",t.formState.errors.hasDriversLicense&&"text-red-400"),children:"Do you have Driver's License?"}),l.jsxs(Uo,{onValueChange:i=>c.onChange(i==="true"),value:((f=c.value)==null?void 0:f.toString())||"",children:[l.jsx(Nn,{children:l.jsx(So,{className:Ut("text-black dark:text-white",t.formState.errors.hasDriversLicense&&"border-red-400",a&&"text-xs"),children:l.jsx($o,{placeholder:"Choose option",className:a?"text-xs":""})})}),l.jsx(Ao,{className:a?"text-xs":"",children:l.jsxs(w3,{children:[l.jsx(pn,{value:"true",className:a?"text-xs":"",children:"Yes"}),l.jsx(pn,{value:"false",className:a?"text-xs":"",children:"No"})]})})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}}),l.jsx(En,{control:t.control,name:"driversLicenseNumber",render:({field:c})=>l.jsxs(jn,{className:"lg:col-span-3 space-y-0",children:[l.jsx($n,{className:Ut("text-muted-foreground text-xs mb-0",t.formState.errors.driversLicenseNumber&&"text-red-400"),children:"Driver's License Number"}),l.jsx(Nn,{children:l.jsx(kn,{...c,type:"text",autoFocus:!1,onChange:f=>{const i=f.target.value.toUpperCase();c.onChange(i)},className:Ut("text-black dark:text-white",t.formState.errors.driversLicenseNumber&&"border-red-400",a&&"text-[8px]")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx("div",{className:"lg:col-span-6"})]})})]})})})),wie=({open:e,onOpenChange:t,driverData:r,onDriverUpdated:n})=>{const[a,c]=W.useState(!1),[f,i]=W.useState(!1),[x,w]=W.useState(!1),[A,P]=W.useState(null),{token:E}=Di(),D=Jl(Date.now()),V=wa(),L=Cl({resolver:tc(kZ),defaultValues:{plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0},mode:"onChange"});W.useEffect(()=>{var ee,se,ce,he,Pe,Ne;if(e&&r){const pe=((ee=r.vehicleIds)==null?void 0:ee.map(Ce=>Ce.plateNo).filter(Boolean))||[],je=((se=r.vehicleIds)==null?void 0:se.map(Ce=>Ce.fileNo).filter(Boolean))||[];console.log("=== POPULATING EDIT FORM ==="),console.log("Driver data:",r),console.log("Address data:",r.address),console.log("Plate numbers:",pe),console.log("File numbers:",je);const xe={plateNo:pe.length>0?pe:"",fileNo:je.length>0?je.join(", "):"",ownerRepresentativeName:r.ownerRepresentativeName||"",purok:((ce=r.address)==null?void 0:ce.purok)||"",barangay:((he=r.address)==null?void 0:he.barangay)||"",municipality:((Pe=r.address)==null?void 0:Pe.municipality)||"",province:((Ne=r.address)==null?void 0:Ne.province)||"Davao Oriental",contactNumber:r.contactNumber||"",emailAddress:r.emailAddress||"",hasDriversLicense:r.hasDriversLicense||!1,driversLicenseNumber:r.driversLicenseNumber||"",birthDate:r.birthDate?new Date(r.birthDate):void 0};console.log("Form data being set:",xe),L.reset(xe),setTimeout(()=>{console.log("Form values after reset:",L.getValues()),xe.plateNo&&L.setValue("plateNo",xe.plateNo,{shouldValidate:!0,shouldDirty:!0}),xe.fileNo&&L.setValue("fileNo",xe.fileNo,{shouldValidate:!0,shouldDirty:!0}),xe.municipality&&L.setValue("municipality",xe.municipality,{shouldValidate:!0,shouldDirty:!0}),xe.barangay&&L.setValue("barangay",xe.barangay,{shouldValidate:!0,shouldDirty:!0}),xe.purok&&L.setValue("purok",xe.purok,{shouldValidate:!0,shouldDirty:!0}),console.log("Form values after individual set:",L.getValues())},200)}},[e,r,L]);const $=ee=>{var ce,he,Pe,Ne;if(!r)return!1;const se={ownerRepresentativeName:r.ownerRepresentativeName||"",purok:((ce=r.address)==null?void 0:ce.purok)||"",barangay:((he=r.address)==null?void 0:he.barangay)||"",municipality:((Pe=r.address)==null?void 0:Pe.municipality)||"",province:((Ne=r.address)==null?void 0:Ne.province)||"Davao Oriental",contactNumber:r.contactNumber||"",emailAddress:r.emailAddress||"",hasDriversLicense:r.hasDriversLicense||!1,driversLicenseNumber:r.driversLicenseNumber||"",birthDate:r.birthDate?new Date(r.birthDate):void 0};for(const pe in se)if(pe==="birthDate"){const je=se[pe],xe=ee[pe];if(je&&xe){if(je.getTime()!==xe.getTime())return!0}else if(je!==xe)return!0}else if(se[pe]!==ee[pe])return!0;return!1},H=async ee=>{const se=L.getValues();if(console.log("=== EDIT DRIVER FORM SUBMISSION DEBUG ==="),console.log("Form values at submission:",se),!$(se)){w(!0),t(!1);return}const he=[];if((!se.ownerRepresentativeName||se.ownerRepresentativeName.trim()==="")&&he.push("Owner/Representative name is required"),(!se.barangay||se.barangay.trim()==="")&&he.push("Barangay is required"),(!se.municipality||se.municipality.trim()==="")&&he.push("Municipality is required"),(!se.province||se.province.trim()==="")&&he.push("Province is required"),se.hasDriversLicense&&(!se.driversLicenseNumber||se.driversLicenseNumber.trim()==="")&&he.push("Driver's license number is required when you have a driver's license"),se.emailAddress&&se.emailAddress.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(se.emailAddress)||he.push("Invalid email format")),he.length>0){console.log("Validation errors:",he),Mn.error("Please fill in all required fields",{description:he.join(", ")});return}P(se),i(!0),t(!1)},K=async()=>{var ee,se;c(!0),i(!1);try{const ce=A,he={ownerRepresentativeName:ce.ownerRepresentativeName,address:{purok:ce.purok,barangay:ce.barangay,municipality:ce.municipality,province:ce.province},contactNumber:ce.contactNumber,emailAddress:ce.emailAddress,hasDriversLicense:ce.hasDriversLicense,driversLicenseNumber:ce.driversLicenseNumber};ce.birthDate&&(he.birthDate=ce.birthDate),console.log("=== SENDING TO SERVER ==="),console.log("Content being sent:",he),console.log("Address object:",he.address),console.log("=== END SERVER DATA ===");const{data:Pe}=await xn.patch(`/driver/${r._id}`,he,{headers:{Authorization:E}});Pe.success&&(n&&n(Pe.data),t(!1),V("/driver"))}catch(ce){console.log(ce);const he=((se=(ee=ce.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to update driver";Mn.error(he,{description:D})}finally{c(!1)}},Q=ee=>{!ee&&!a&&L.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t(ee)},ae=()=>{Q(!1)};return l.jsxs(l.Fragment,{children:[l.jsx(hs,{open:e,onOpenChange:Q,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent animate-in fade-in-0 zoom-in-95 duration-300",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"Edit Driver"]}),l.jsx(bo,{children:"Update the driver information. Plate number and file number cannot be modified."})]}),l.jsx("div",{className:"space-y-6",children:l.jsx(c5,{form:L,onSubmit:H,submitting:a,onCancel:ae,isEditMode:!0})}),l.jsx(jl,{className:"flex justify-end gap-3 pt-6",children:l.jsxs(Nr,{type:"submit",form:"driver-form",disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Driver"]})})]})}),l.jsx(hs,{open:f,onOpenChange:ee=>{i(ee),ee||t(!1)},children:l.jsxs(Xa,{className:"max-w-lg border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"Confirm Driver Information"]}),l.jsx(bo,{children:"Please review the updated driver information before submitting."})]}),A&&l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Information (Read-only)"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),l.jsx("div",{className:"col-span-3",children:Array.isArray(A.plateNo)?A.plateNo.join(", "):A.plateNo}),l.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),l.jsx("div",{className:"col-span-3 break-all text-xs",children:A.fileNo||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Owner:"}),l.jsx("div",{className:"col-span-3",children:A.ownerRepresentativeName})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Personal Information"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Contact:"}),l.jsx("div",{className:"col-span-3",children:A.contactNumber||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Email:"}),l.jsx("div",{className:"col-span-3",children:A.emailAddress||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Birth Date:"}),l.jsx("div",{className:"col-span-3",children:A.birthDate?new Date(A.birthDate).toLocaleDateString():"Not provided"})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Address Information"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Province:"}),l.jsx("div",{className:"col-span-3",children:A.province}),l.jsx("div",{className:"font-medium text-gray-600",children:"Municipality:"}),l.jsx("div",{className:"col-span-3",children:A.municipality}),l.jsx("div",{className:"font-medium text-gray-600",children:"Barangay:"}),l.jsx("div",{className:"col-span-3",children:A.barangay}),l.jsx("div",{className:"font-medium text-gray-600",children:"Purok:"}),l.jsx("div",{className:"col-span-3",children:A.purok||"Not provided"})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Driver's License"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Has License:"}),l.jsx("div",{className:"col-span-3",children:A.hasDriversLicense?"Yes":"No"}),A.hasDriversLicense&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"font-medium text-gray-600",children:"License Number:"}),l.jsx("div",{className:"col-span-3",children:A.driversLicenseNumber})]})]})})]})]}),l.jsxs(jl,{className:"flex justify-end gap-3 pt-6",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>{i(!1),t(!0),L.clearErrors()},disabled:a,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),l.jsxs(Nr,{onClick:K,disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Confirm & Update Driver"]})]})]})}),l.jsx(hs,{open:x,onOpenChange:ee=>{w(ee),ee||t(!1)},children:l.jsxs(Xa,{className:"max-w-md border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"No Changes Detected"]}),l.jsx(bo,{children:"No changes were made to the driver information. Would you like to continue editing?"})]}),l.jsxs(jl,{className:"flex justify-end gap-3 pt-6",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>{w(!1),V("/driver")},className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"No"}),l.jsx(Nr,{onClick:()=>{w(!1),t(!0)},className:"flex items-center gap-2 min-w-[100px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})})]})},Sie=({open:e,onOpenChange:t,driverData:r,onFileNumberClick:n,onDriverUpdated:a})=>{var $,H,K,Q,ae;oy();const[c,f]=W.useState(!1),[i,x]=W.useState(null),[w,A]=W.useState(!1),[P,E]=W.useState(!1);co(),wa();const D=Di(),{token:V}=D||{},L=async ee=>{if(ee)if(n)n(ee);else{A(!0),f(!0);try{const{data:se}=await xn.get(`/vehicle/file/${ee}`,{headers:{Authorization:V}});se.success&&x(se.data)}catch(se){console.error("Error fetching vehicle data:",se),Mn.error("Failed to fetch vehicle information")}finally{A(!1)}}};return r?l.jsxs(l.Fragment,{children:[l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-2xl w-full p-0 overflow-hidden bg-white",children:[l.jsx("div",{className:"bg-white px-6 py-4 border-b",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:(($=r.ownerRepresentativeName)==null?void 0:$.charAt(0))||"D"}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:r.ownerRepresentativeName}),l.jsx("p",{className:"text-xs text-gray-600",children:"Driver Profile"})]})]})}),l.jsx("div",{className:"p-6 bg-white",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Du,{className:"h-4 w-4 text-blue-600"}),l.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Personal Information"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ld,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"File Numbers"})]}),l.jsx("div",{className:"ml-6 mt-1",children:r.vehicleIds&&r.vehicleIds.length>0?l.jsx("div",{className:"space-y-2",children:r.vehicleIds.map((ee,se)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>L(ee.fileNo),className:"text-blue-600 hover:text-blue-800 text-xs font-medium cursor-pointer hover:underline text-left break-all bg-blue-50 hover:bg-blue-100 px-2 py-1 rounded border border-blue-200 transition-colors duration-200",title:`Click to view vehicle details for ${ee.fileNo}`,children:ee.fileNo}),ee.plateNo&&l.jsxs("span",{className:"text-xs text-gray-500",children:["(",ee.plateNo,")"]})]},se))}):l.jsx("span",{className:"text-gray-400 text-xs",children:"N/A"})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Du,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Owner/Representative"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:r.ownerRepresentativeName||"N/A"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Date of Birth"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:r.birthDate?iy(r.birthDate):"None"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(xP,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Contact Number"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:r.contactNumber||"None"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Uw,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Email Address"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1 truncate",children:r.emailAddress||"None"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(vP,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Driver's License"})]}),l.jsxs("div",{className:"flex items-center gap-2 ml-6 mt-1",children:[l.jsx(us,{variant:r.hasDriversLicense?"default":"destructive",className:"text-xs px-2 py-0.5",children:r.hasDriversLicense?"Yes":"No"}),r.hasDriversLicense&&r.driversLicenseNumber&&l.jsx("span",{className:"text-xs text-gray-600",children:r.driversLicenseNumber})]})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx(Ed,{className:"h-4 w-4 text-green-600"}),l.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Address Information"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Purok"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:((H=r.address)==null?void 0:H.purok)||"N/A"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Barangay"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:((K=r.address)==null?void 0:K.barangay)||"N/A"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Municipality"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:((Q=r.address)==null?void 0:Q.municipality)||"N/A"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-4 w-4 text-gray-500"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Province"})]}),l.jsx("p",{className:"text-xs font-medium text-gray-800 ml-6 mt-1",children:((ae=r.address)==null?void 0:ae.province)||"N/A"})]})]})]})]})}),l.jsx("div",{className:"border-t bg-white px-6 py-3",children:l.jsx("div",{className:"flex justify-end",children:l.jsxs(Nr,{onClick:()=>E(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 rounded-md font-medium text-xs shadow-sm transition-colors duration-200",children:[l.jsx(ao,{className:"h-3 w-3 mr-1.5"}),"Edit Driver"]})})})]})}),l.jsx(wie,{open:P,onOpenChange:E,driverData:r,onDriverUpdated:a}),l.jsx(hs,{open:c,onOpenChange:f,children:l.jsxs(Xa,{className:"max-w-2xl",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"text-xl font-bold flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5 text-blue-600"}),"Vehicle Information"]}),l.jsxs(bo,{children:["Vehicle details for file number: ",r==null?void 0:r.fileNo]})]}),w?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i?l.jsx("div",{className:"space-y-4",children:l.jsx(Ci,{children:l.jsxs(Ii,{className:"pt-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Plate Number"}),l.jsx("p",{className:"font-medium text-sm",children:i.plateNo||"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"File Number"}),l.jsx("p",{className:"font-medium text-sm",children:i.fileNo||"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Engine Number"}),l.jsx("p",{className:"font-medium text-sm",children:i.engineNo||"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Chassis Number"}),l.jsx("p",{className:"font-medium text-sm",children:i.chassisNo||"N/A"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Make"}),l.jsx("p",{className:"font-medium text-sm",children:i.make||"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Body Type"}),l.jsx("p",{className:"font-medium text-sm",children:i.bodyType||"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Color"}),l.jsx("p",{className:"font-medium text-sm",children:i.color||"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Classification"}),l.jsx("p",{className:"font-medium text-sm",children:i.classification||"N/A"})]})]})]}),l.jsx(P2,{className:"my-4"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Date of Renewal"}),l.jsx("p",{className:"font-medium text-sm",children:i.dateOfRenewal?iy(i.dateOfRenewal):"N/A"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Status"}),l.jsx(us,{variant:i.status==="Active"?"default":"destructive",children:i.status||"N/A"})]})]})]})})}):l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No vehicle information found for this file number."})})]})})]}):null},Aie=({open:e,onOpenChange:t,fileNumber:r})=>{const[n,a]=W.useState(null),[c,f]=W.useState(!1),{token:i}=Di();W.useEffect(()=>{e&&r&&x()},[e,r]);const x=async()=>{f(!0);try{const{data:w}=await xn.get(`/vehicle/file/${r}`,{headers:{Authorization:i}});w.success&&a(w.data)}catch(w){console.error("Error fetching vehicle data:",w),Mn.error("Failed to fetch vehicle information")}finally{f(!1)}};return l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto animate-in fade-in-0 zoom-in-95 duration-300",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"text-xl font-bold flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5 text-blue-600"}),"Vehicle Information"]}),l.jsxs(bo,{children:["Vehicle details for file number: ",r]})]}),c?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n?l.jsx("div",{className:"space-y-4",children:l.jsx(Ci,{children:l.jsxs(Ii,{className:"pt-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Ld,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"File Number"}),l.jsx("p",{className:"font-medium text-sm",children:n.fileNo||"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(cl,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Plate Number"}),l.jsx("p",{className:"font-medium text-sm",children:n.plateNo||"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(pH,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Engine Number"}),l.jsx("p",{className:"font-medium text-sm",children:n.engineNo||"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Xb,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Chassis Number"}),l.jsx("p",{className:"font-medium text-sm",children:n.chassisNo||"N/A"})]})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(cl,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Make"}),l.jsx("p",{className:"font-medium text-sm",children:n.make||"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Xb,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Body Type"}),l.jsx("p",{className:"font-medium text-sm",children:n.bodyType||"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(hH,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Color"}),l.jsx("p",{className:"font-medium text-sm",children:n.color||"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Xb,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Classification"}),l.jsx("p",{className:"font-medium text-sm",children:n.classification||"N/A"})]})]})]})]}),l.jsx(P2,{className:"my-4"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(so,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Date of Renewal"}),l.jsx("p",{className:"font-medium text-sm",children:n.dateOfRenewal?iy(n.dateOfRenewal):"N/A"})]})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Xb,{className:"h-4 w-4 text-gray-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Vehicle Status Type"}),l.jsx("p",{className:"font-medium text-sm",children:n.vehicleStatusType||"N/A"})]})]})]}),l.jsx("div",{className:"space-y-3",children:l.jsxs("div",{className:"flex items-center gap-3",children:[n.status==="1"||n.status===1?l.jsx(cH,{className:"h-4 w-4 text-green-500"}):l.jsx(Mue,{className:"h-4 w-4 text-red-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-600",children:"Status"}),l.jsx(us,{variant:n.status==="1"||n.status===1?"default":"destructive",children:n.status==="1"||n.status===1?"Active":"Inactive"})]})]})})]})]})})}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(cl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No vehicle information found"})]})]})})},_Ve=()=>{const[e,t]=W.useState([]),{token:r}=Di(),n=wa(),a=co(),[c,f]=W.useState(!0),[i,x]=W.useState(!1),[w,A]=W.useState(null),[P,E]=W.useState(!1),[D,V]=W.useState(!1),[L,$]=W.useState(!1),[H,K]=W.useState("");W.useEffect(()=>{Q()},[]);const Q=async()=>{try{const{data:xe}=await xn.get("/driver",{headers:{Authorization:r}}),ze=xe.data.map(Te=>{var He,mt,Xe,ot,qe,Lt,Zt;const Re=((He=Te.vehicleIds)==null?void 0:He.map(Xt=>Xt.plateNo).filter(Boolean))||[],Fe=((mt=Te.vehicleIds)==null?void 0:mt.map(Xt=>Xt.fileNo).filter(Boolean))||[];return{_id:Te._id,plateNo:Re,fileNo:Fe,vehicleIds:Te.vehicleIds||[],vehicleCount:((Xe=Te.vehicleIds)==null?void 0:Xe.length)||0,ownerRepresentativeName:Te.ownerRepresentativeName,fullname:Te.fullname,birthDate:Te.birthDate,contactNumber:Te.contactNumber,emailAddress:Te.emailAddress,address:Te.address||{},province:((ot=Te.address)==null?void 0:ot.province)||Te.province,municipality:((qe=Te.address)==null?void 0:qe.municipality)||Te.municipality,barangay:((Lt=Te.address)==null?void 0:Lt.barangay)||Te.barangay,purok:(Zt=Te.address)==null?void 0:Zt.purok,hasDriversLicense:Te.hasDriversLicense,driversLicenseNumber:Te.driversLicenseNumber,isActive:Te.isActive}}).filter(Te=>Te.isActive);t(ze),f(!1)}catch(xe){f(!1),console.log(xe)}},ae=xe=>{A(xe),V(!0)},ee=xe=>{const Ce=e.find(ze=>ze._id===xe);Ce&&(A(Ce),E(!0))},se=()=>{n(`${a.pathname}/inactive`)},ce=xe=>{x(!0),A(xe)},he=()=>{je(!1),x(!1)},Pe=()=>{x(!1)},Ne=xe=>{K(xe),$(!0)},pe=xe=>{t(Ce=>Ce.map(ze=>ze._id===xe._id?xe:ze)),V(!1),Mn.success("Driver updated successfully",{description:"The driver information has been updated in the table."})},je=async xe=>{const Ce=async()=>{var ze,Te;try{return(await xn.patch(`/driver/${w}`,{isActive:xe},{headers:{Authorization:r}})).data}catch(Re){const Fe=((Te=(ze=Re.response)==null?void 0:ze.data)==null?void 0:Te.message)||"An error occurred";throw new Error(Fe)}finally{await Q()}};Mn.promise(Ce(),{loading:"Loading...",success:"Driver deactivated",error:ze=>ze.message||"Failed to update driver"})};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[l.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Drivers"}),l.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:l.jsx(K6e,{data:e,filters:["fullname","plateNo","ownerRepresentativeName","municipality","barangay"],tableColumn:bBe,loading:c,onRowClick:ae,onEdit:ee,onDelete:ce,onNavigate:se,onFileNumberClick:Ne})})]}),l.jsx(uie,{open:i,onOpenChange:x,confirm:he,cancel:Pe,title:"Are you sure?",description:"This action cannot be undone. This will deactivate the driver."}),l.jsx(Sie,{open:D,onOpenChange:V,driverData:w,onFileNumberClick:Ne,onDriverUpdated:pe}),l.jsx(wie,{open:P,onOpenChange:E,driverData:w,onDriverUpdated:pe}),l.jsx(Aie,{open:L,onOpenChange:$,fileNumber:H})]})},bVe=()=>{const e=oy(),t=wa(),[r,n]=W.useState(null),[a,c]=W.useState(!0),[f,i]=W.useState(!1),[x,w]=W.useState(!1),[A,P]=W.useState(""),{token:E}=Di();W.useEffect(()=>{D()},[]);const D=async()=>{try{const{data:$}=await xn.get(`/driver/${e.id}`,{headers:{Authorization:E}});$&&(n($.data),i(!0))}catch($){console.error("Error fetching driver:",$),t("/404")}finally{c(!1)}};if(a)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const V=$=>{P($),w(!0)},L=$=>{n($)};return l.jsxs(l.Fragment,{children:[l.jsx(Sie,{open:f,onOpenChange:$=>{i($),$||t(-1)},driverData:r,onFileNumberClick:V,onDriverUpdated:L}),l.jsx(Aie,{open:x,onOpenChange:w,fileNumber:A})]})},wVe=()=>{const e=wa();return l.jsxs("div",{className:"flex flex-col justify-center items-center h-screen",children:[l.jsx("h1",{className:"font-bold text-[80px] md:text-[100px] lg:text-[300px] text-muted-foreground leading-none",children:"404"}),l.jsx("p",{className:"text-lg mb-5",children:"Oops... Page not found."}),l.jsx(Nr,{variant:"outline",size:"lg",onClick:()=>e("/"),children:"Go to Home"})]})},SVe=()=>{const[e,t]=W.useState(!1),{token:r}=Di(),n=oy(),a=Jl(Date.now()),[c,f]=W.useState({}),i=wa(),x=Cl({resolver:tc(kZ),defaultValues:{plateNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}}),{reset:w}=x;W.useEffect(()=>{Object.keys(c).length>0&&w(c)},[c,w]),W.useEffect(()=>{A()},[n.id,r]);const A=async()=>{var D,V,L,$,H,K,Q,ae,ee,se,ce,he,Pe,Ne,pe;const E=n.id;try{const{data:je}=await xn.get(`/driver/${E}`,{headers:{Authorization:r}});if(je){const xe={plateNo:(D=je.data)==null?void 0:D.plateNo,ownerRepresentativeName:(V=je.data)==null?void 0:V.ownerRepresentativeName,purok:($=(L=je.data)==null?void 0:L.address)==null?void 0:$.purok,barangay:(K=(H=je.data)==null?void 0:H.address)==null?void 0:K.barangay,municipality:(ae=(Q=je.data)==null?void 0:Q.address)==null?void 0:ae.municipality,province:((se=(ee=je.data)==null?void 0:ee.address)==null?void 0:se.province)||"Davao Oriental",contactNumber:(ce=je.data)==null?void 0:ce.contactNumber,emailAddress:(he=je.data)==null?void 0:he.emailAddress,hasDriversLicense:(Pe=je.data)==null?void 0:Pe.hasDriversLicense,driversLicenseNumber:(Ne=je.data)==null?void 0:Ne.driversLicenseNumber,birthDate:new Date((pe=je.data)==null?void 0:pe.birthDate)};f(xe)}}catch(je){console.log(je)}},P=async E=>{t(!0);try{const D={plateNo:E.plateNo,ownerRepresentativeName:E.ownerRepresentativeName,address:{purok:E.purok,barangay:E.barangay,municipality:E.municipality,province:E.province},contactNumber:E.contactNumber,emailAddress:E.emailAddress,hasDriversLicense:E.hasDriversLicense,driversLicenseNumber:E.driversLicenseNumber,birthDate:E.birthDate},{data:V}=await xn.patch(`/driver/${n.id}`,D,{headers:{Authorization:r}});V.success&&(Mn.success("Driver updated",{description:a}),i(-1))}catch(D){console.log(D);const V=D.response.data.message;Mn.error(V,{description:`${a}`})}finally{t(!1)}};return l.jsx(l.Fragment,{children:l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsx(Fi,{className:"text-xl md:text-3xl font-bold",children:"Edit Driver"}),l.jsx(As,{children:"Fill in required fields to edit driver."})]}),l.jsx(Ii,{children:l.jsx(c5,{form:x,onSubmit:P,submitting:e})})]})})},AVe=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(!1),[a,c]=W.useState(""),[f,i]=W.useState(!0),x=wa(),{token:w}=Di();W.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:L}=await xn.get("/driver",{headers:{Authorization:w}}),H=L.data.map(K=>({_id:K._id,plateNo:K.plateNo,fileNo:K.fileNo,ownerRepresentativeName:K.ownerRepresentativeName,fullname:K.fullname,birthDate:iy(K.birthDate),contactNumber:K.contactNumber,emailAddress:K.emailAddress,hasDriversLicense:K.hasDriversLicense,driversLicenseNumber:K.driversLicenseNumber,isActive:K.isActive})).filter(K=>K.isActive===!1);t(H),i(!1)}catch(L){i(!1),console.log(L)}},P=L=>{n(!0),c(L)},E=()=>{V(!0),n(!1)},D=()=>{n(!1)},V=async L=>{const $=async()=>{var H,K;try{return(await xn.patch(`/driver/${a}`,{isActive:L},{headers:{Authorization:w}})).data}catch(Q){const ae=((K=(H=Q.response)==null?void 0:H.data)==null?void 0:K.message)||"An error occurred";throw new Error(ae)}finally{await A()}};Mn.promise($(),{loading:"Loading...",success:"Driver activated",error:H=>H.message||"Failed to update driver"})};return l.jsxs("div",{className:"p-4",children:[l.jsx("header",{className:"text-xl md:text-3xl font-bold mb-5",children:"Deleted Drivers"}),l.jsx("div",{className:" pt-4 md:px-0 md:pt-0",children:l.jsxs(Nr,{variant:"outline",className:"shadow-none",onClick:()=>x(-1),children:[l.jsx(gP,{})," Back"]})}),l.jsx("section",{children:l.jsx(_ne,{data:e,searchPlaceholder:"Search Driver...",filters:["fullname","plateNo","ownerRepresentativeName"],tableColumn:_Be,loading:f,onAction:P})}),l.jsx(uie,{open:r,onOpenChange:n,cancel:D,confirm:E,title:"Are you sure?",description:"This action cannot be undone. This will activate the driver."})]})},TVe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:c,onAdd:f,onEdit:i,submitting:x})=>{var ee;const[w,A]=Oe.useState([]),[P,E]=Oe.useState([]),[D,V]=Oe.useState({}),[L,$]=Oe.useState({pageIndex:0,pageSize:9}),[H,K]=Oe.useState(""),Q=t,ae=E2({data:n,columns:r(i,x),onSortingChange:A,onColumnFiltersChange:E,onPaginationChange:$,getCoreRowModel:N2(),getPaginationRowModel:C2(),getSortedRowModel:k2(),getFilteredRowModel:j2(),onColumnVisibilityChange:V,onGlobalFilterChange:K,globalFilterFn:(se,ce,he)=>Q.some(Pe=>{const Ne=se.getValue(Pe);return String(Ne).toLowerCase().includes(he.toLowerCase())}),state:{pagination:L,sorting:w,columnFilters:P,columnVisibility:D,globalFilter:H}});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsx(ls,{className:"font-semibold",children:e}),l.jsxs("div",{className:`md:flex items-center justify-between py-3 flex-shrink-0
        `,children:[l.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[l.jsx(v_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),l.jsx(kn,{placeholder:"Search Vehicle...",value:H??"",onChange:se=>K(se.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"}),H&&l.jsx("button",{onClick:()=>K(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(Qf,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[l.jsxs(Nr,{onClick:f,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[l.jsx(J0,{}),l.jsx("span",{className:"hidden lg:inline",children:"Add Vehicle"})]}),l.jsx(O2,{table:ae})]})]}),l.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0",children:l.jsx("div",{className:"overflow-auto h-full",children:l.jsx("div",{className:"px-0",children:l.jsxs(km,{children:[l.jsx(Em,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:ae.getHeaderGroups().map(se=>l.jsx(Ns,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:se.headers.map(ce=>l.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",children:cp(ce.column.columnDef.header,ce.getContext())},ce.id))},se.id))}),l.jsx(Mm,{className:"text-xs bg-white dark:bg-transparent",children:a?l.jsx(M2,{rowCount:5,cellCount:ae.getAllColumns().length}):(ee=ae.getRowModel().rows)!=null&&ee.length?ae.getRowModel().rows.map(se=>l.jsx(Ns,{onClick:()=>c(se.original),"data-state":se.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:se.getVisibleCells().map(ce=>l.jsx(ha,{className:"px-3 py-2 text-gray-800 dark:text-gray-200 text-left",children:cp(ce.column.columnDef.cell,ce.getContext())},ce.id))},se.id)):l.jsx(Ns,{className:"hover:bg-transparent",children:l.jsx(ha,{colSpan:ae.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center justify-center",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),l.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),l.jsx("div",{className:"mt-3 flex-shrink-0",children:l.jsx(R2,{table:ae})})]})},PVe=({open:e,onOpenChange:t,onVehicleUpdated:r})=>{const[n,a]=W.useState(""),[c,f]=W.useState(!1),[i,x]=W.useState(null),[w,A]=W.useState(""),[P,E]=W.useState(null),[D,V]=W.useState(!1),[L,$]=W.useState(!1),{token:H}=Di(),K=async()=>{var ce,he;if(!n.trim()){A("Please enter a plate number");return}f(!0),A(""),x(null);try{const{data:Pe}=await xn.get(`/vehicle/owner/${n.trim()}`,{headers:{Authorization:H}});Pe.success?(x(Pe.data),E(Pe.data.vehicle.dateOfRenewal?new Date(Pe.data.vehicle.dateOfRenewal):new Date),$(!1)):A(Pe.message||"Failed to fetch vehicle information")}catch(Pe){console.error("Error fetching vehicle data:",Pe),A(((he=(ce=Pe.response)==null?void 0:ce.data)==null?void 0:he.message)||"Vehicle not found or error occurred while fetching data")}finally{f(!1)}},Q=()=>{a(""),x(null),A(""),E(null),V(!1),$(!1),t(!1)},ae=async()=>{var ce,he;if(!i||!P){A("Please select a renewal date");return}V(!0),A("");try{const{data:Pe}=await xn.patch(`/vehicle/${i.vehicle._id}`,{dateOfRenewal:P.toISOString()},{headers:{Authorization:H}});if(Pe.success){$(!0),Mn.success("Vehicle Updated Successfully",{description:`Renewal date updated for ${i.vehicle.plateNo}`});try{const{data:Ne}=await xn.get(`/vehicle/owner/${n.trim()}`,{headers:{Authorization:H}});Ne.success&&(x(Ne.data),E(Ne.data.vehicle.dateOfRenewal?new Date(Ne.data.vehicle.dateOfRenewal):new Date),r&&r())}catch(Ne){console.error("Error refreshing vehicle data:",Ne)}}else A(Pe.message||"Failed to update renewal date")}catch(Pe){console.error("Error updating renewal date:",Pe),A(((he=(ce=Pe.response)==null?void 0:ce.data)==null?void 0:he.message)||"Failed to update renewal date")}finally{V(!1)}},ee=ce=>ce==="1"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",se=ce=>ce==="1"?"Active":"Expired";return l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[l.jsx(fs,{children:l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5"}),"Vehicle Renewal Information"]})}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(ls,{htmlFor:"plateNo",children:"Plate Number"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(kn,{id:"plateNo",placeholder:"Enter plate number (e.g., ABC123)",value:n,onChange:ce=>a(ce.target.value.toUpperCase()),onKeyPress:ce=>ce.key==="Enter"&&K(),className:"flex-1"}),l.jsx(Nr,{onClick:K,disabled:c,className:"px-6",children:c?l.jsx(_c,{className:"h-4 w-4 animate-spin"}):l.jsx(v_,{className:"h-4 w-4"})})]})]}),w&&l.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:l.jsx("p",{className:"text-sm text-red-600",children:w})}),L&&l.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:l.jsx("p",{className:"text-sm text-green-600",children:"Renewal date updated successfully!"})})]}),i&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsxs(Fi,{className:"flex items-center justify-between",children:[l.jsxs("span",{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-4 w-4"}),"Vehicle Information"]}),l.jsx(us,{className:ee(i.vehicle.status),children:se(i.vehicle.status)})]})}),l.jsx(Ii,{className:"space-y-3",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Plate Number"}),l.jsx("p",{className:"text-sm font-semibold",children:i.vehicle.plateNo})]}),l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Make & Model"}),l.jsxs("p",{className:"text-sm",children:[i.vehicle.make," ",i.vehicle.bodyType]})]}),l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Color"}),l.jsx("p",{className:"text-sm",children:i.vehicle.color})]}),l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Last Renewal"}),l.jsx("p",{className:"text-sm",children:i.vehicle.dateOfRenewal?Jl(i.vehicle.dateOfRenewal):"Not set"})]})]})})]}),l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-4 w-4"}),"Update Renewal Date"]})}),l.jsxs(Ii,{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"New Renewal Date"}),l.jsx("div",{className:"mt-2",children:l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsxs(Nr,{variant:"outline",className:Ut("w-full justify-start text-left font-normal",!P&&"text-muted-foreground"),children:[l.jsx(so,{className:"mr-2 h-4 w-4"}),P?Jl(P):"Pick a date"]})}),l.jsx(sy,{className:"w-auto p-0",align:"start",children:l.jsx(D2,{fieldValue:P,dateValue:E})})]})})]}),l.jsx("div",{className:"flex justify-end",children:l.jsxs(Nr,{onClick:ae,disabled:D||!P,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white",children:[D?l.jsx(_c,{className:"h-4 w-4 animate-spin"}):l.jsx(hde,{className:"h-4 w-4"}),D?"Updating...":"Update Renewal Date"]})})]})]}),l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(Du,{className:"h-4 w-4"}),"Owner Information"]})}),l.jsxs(Ii,{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Owner Name"}),l.jsx("p",{className:"text-sm font-semibold",children:i.owner.name})]}),i.owner.address&&l.jsxs("div",{children:[l.jsxs(ls,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[l.jsx(Ed,{className:"h-3 w-3"}),"Address"]}),l.jsxs("p",{className:"text-sm",children:[i.owner.address.purok&&`${i.owner.address.purok}, `,i.owner.address.barangay,", ",i.owner.address.municipality,l.jsx("br",{}),i.owner.address.province,", ",i.owner.address.region]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.owner.contactNumber&&l.jsxs("div",{children:[l.jsxs(ls,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[l.jsx(xP,{className:"h-3 w-3"}),"Contact Number"]}),l.jsx("p",{className:"text-sm",children:i.owner.contactNumber})]}),i.owner.emailAddress&&l.jsxs("div",{children:[l.jsxs(ls,{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[l.jsx(Uw,{className:"h-3 w-3"}),"Email"]}),l.jsx("p",{className:"text-sm",children:i.owner.emailAddress})]})]}),i.owner.driversLicenseNumber&&l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Driver's License"}),l.jsx("p",{className:"text-sm",children:i.owner.driversLicenseNumber})]})]})]}),i.expirationInfo&&l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-4 w-4"}),"Expiration Information"]})}),l.jsx(Ii,{className:"space-y-3",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Expiration Month"}),l.jsx("p",{className:"text-sm font-semibold",children:i.expirationInfo.month})]}),l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Week"}),l.jsxs("p",{className:"text-sm capitalize",children:[i.expirationInfo.week," week"]})]}),l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Expiration Date"}),l.jsx("p",{className:"text-sm",children:i.expirationInfo.expirationDate?Jl(i.expirationInfo.expirationDate):"Not calculated"})]}),l.jsxs("div",{children:[l.jsx(ls,{className:"text-sm font-medium text-gray-600",children:"Status"}),l.jsx(us,{className:i.expirationInfo.isExpired?"bg-red-100 text-red-800":"bg-green-100 text-green-800",children:i.expirationInfo.isExpired?"Expired":"Active"})]})]})})]})]})]}),l.jsx(jl,{children:l.jsx(Nr,{variant:"outline",onClick:Q,children:"Close"})})]})})},NVe=({open:e,onOpenChange:t,onDriverAdded:r})=>{const[n,a]=W.useState(!1),[c,f]=W.useState(!1),[i,x]=W.useState(null),{token:w}=Di(),A=Jl(Date.now());wa();const P=Cl({defaultValues:{plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0},mode:"onChange"});W.useEffect(()=>{if(e){const $=sessionStorage.getItem("vehicleFormData");if($){const H=JSON.parse($);P.reset({plateNo:H.plateNo||"",fileNo:H.fileNo||"",ownerRepresentativeName:H.ownerRepresentativeName||"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0})}else P.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0});setTimeout(()=>{P.setValue("province","Davao Oriental"),console.log("Province set to:",P.getValues("province")),P.trigger()},100)}},[e,P]);const E=async $=>{const H=P.getValues();console.log("=== FORM SUBMISSION DEBUG ==="),console.log("Form values at submission:",H),console.log("Specific address values:"),console.log("  - barangay:",H.barangay,"(type:",typeof H.barangay,")"),console.log("  - municipality:",H.municipality,"(type:",typeof H.municipality,")"),console.log("  - province:",H.province,"(type:",typeof H.province,")"),console.log("  - purok:",H.purok,"(type:",typeof H.purok,")"),console.log("Value checks:"),console.log("  - barangay empty?",!H.barangay||H.barangay.trim()===""),console.log("  - municipality empty?",!H.municipality||H.municipality.trim()===""),console.log("  - province empty?",!H.province||H.province.trim()===""),console.log("=== END DEBUG ===");const K=[];if((!H.plateNo||Array.isArray(H.plateNo)&&H.plateNo.length===0)&&K.push("Plate number is required"),(!H.ownerRepresentativeName||H.ownerRepresentativeName.trim()==="")&&K.push("Owner/Representative name is required"),(!H.barangay||H.barangay.trim()==="")&&K.push("Barangay is required"),(!H.municipality||H.municipality.trim()==="")&&K.push("Municipality is required"),(!H.province||H.province.trim()==="")&&K.push("Province is required"),H.hasDriversLicense&&(!H.driversLicenseNumber||H.driversLicenseNumber.trim()==="")&&K.push("Driver's license number is required when you have a driver's license"),H.emailAddress&&H.emailAddress.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(H.emailAddress)||K.push("Invalid email format")),K.length>0){console.log("Validation errors:",K),Mn.error("Please fill in all required fields",{description:K.join(", ")});return}x(H),f(!0),t(!1)},D=async()=>{var $,H;a(!0),f(!1);try{const K=i,Q={plateNo:K.plateNo,fileNo:K.fileNo,ownerRepresentativeName:K.ownerRepresentativeName,address:{purok:K.purok,barangay:K.barangay,municipality:K.municipality,province:K.province},contactNumber:K.contactNumber,emailAddress:K.emailAddress,hasDriversLicense:K.hasDriversLicense,driversLicenseNumber:K.driversLicenseNumber};K.birthDate&&(Q.birthDate=K.birthDate),console.log("=== SENDING TO SERVER ==="),console.log("Content being sent:",Q),console.log("Address object:",Q.address),console.log("=== END SERVER DATA ===");const{data:ae}=await xn.post("/driver",Q,{headers:{Authorization:w}});ae.success&&(Mn.success("Driver has been added",{description:A}),P.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),sessionStorage.removeItem("vehicleFormData"),t(!1),r&&r(ae.data))}catch(K){console.log(K);const Q=((H=($=K.response)==null?void 0:$.data)==null?void 0:H.message)||"Failed to add driver";Mn.error(Q,{description:A})}finally{a(!1)}},V=$=>{!$&&!n&&P.reset({plateNo:"",fileNo:"",ownerRepresentativeName:"",purok:"",barangay:"",municipality:"",province:"Davao Oriental",contactNumber:"",emailAddress:"",hasDriversLicense:!1,driversLicenseNumber:"",birthDate:void 0}),t($)},L=()=>{sessionStorage.removeItem("vehicleFormData"),V(!1)};return l.jsxs(l.Fragment,{children:[l.jsx(hs,{open:e,onOpenChange:V,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent animate-in fade-in-0 zoom-in-95 duration-300",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(Du,{className:"h-5 w-5"}),"Add New Driver"]}),l.jsx(bo,{children:"Fill in the required fields to add a new driver record to the system."})]}),l.jsx("div",{className:"space-y-6",children:l.jsx(c5,{form:P,onSubmit:E,submitting:n,onCancel:L})}),l.jsxs(jl,{className:"flex justify-start gap-3 pt-6",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:L,disabled:n,className:"min-w-[100px]",children:"Cancel"}),l.jsxs(Nr,{type:"submit",form:"driver-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[n&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Driver"]})]})]})}),l.jsx(hs,{open:c,onOpenChange:$=>{f($),$||t(!1)},children:l.jsxs(Xa,{className:"max-w-lg border border-gray-200 animate-in fade-in-0 zoom-in-95 duration-300",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(Du,{className:"h-5 w-5"}),"Confirm Driver Information"]}),l.jsx(bo,{children:"Please review the driver information before submitting."})]}),i&&l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Information"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),l.jsx("div",{className:"col-span-3",children:Array.isArray(i.plateNo)?i.plateNo.join(", "):i.plateNo}),l.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),l.jsx("div",{className:"col-span-3",children:i.fileNo||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Owner:"}),l.jsx("div",{className:"col-span-3",children:i.ownerRepresentativeName})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Personal Information"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Contact:"}),l.jsx("div",{className:"col-span-3",children:i.contactNumber||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Email:"}),l.jsx("div",{className:"col-span-3",children:i.emailAddress||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Birth Date:"}),l.jsx("div",{className:"col-span-3",children:i.birthDate?new Date(i.birthDate).toLocaleDateString():"Not provided"})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Address Information"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Province:"}),l.jsx("div",{className:"col-span-3",children:i.province}),l.jsx("div",{className:"font-medium text-gray-600",children:"Municipality:"}),l.jsx("div",{className:"col-span-3",children:i.municipality}),l.jsx("div",{className:"font-medium text-gray-600",children:"Barangay:"}),l.jsx("div",{className:"col-span-3",children:i.barangay}),l.jsx("div",{className:"font-medium text-gray-600",children:"Purok:"}),l.jsx("div",{className:"col-span-3",children:i.purok||"Not provided"})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Driver's License"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Has License:"}),l.jsx("div",{className:"col-span-3",children:i.hasDriversLicense?"Yes":"No"}),i.hasDriversLicense&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"font-medium text-gray-600",children:"License Number:"}),l.jsx("div",{className:"col-span-3",children:i.driversLicenseNumber})]})]})})]})]}),l.jsxs(jl,{className:"flex justify-end gap-3 pt-6",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>{f(!1),t(!0),P.clearErrors()},disabled:n,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Back to Edit"}),l.jsxs(Nr,{onClick:D,disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[n&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Confirm & Add Driver",l.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},jVe=({open:e,onOpenChange:t,ownerId:r})=>{const[n,a]=W.useState(null),[c,f]=W.useState(!1),{token:i}=Di();W.useEffect(()=>{e&&r&&x()},[e,r]);const x=async()=>{var P,E;if(!r){console.log("No ownerId found, skipping fetch");return}f(!0);try{console.log(`Fetching owner data for ID: ${r}`);const{data:D}=await xn.get(`/driver/${r}`,{headers:{Authorization:i}});console.log("Owner data received:",D),a(D.data)}catch(D){console.error("Error fetching owner data:",D),console.error("Error response:",(P=D.response)==null?void 0:P.data),console.error("Error status:",(E=D.response)==null?void 0:E.status)}finally{f(!1)}},w=P=>P?new Date(P).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",A=()=>c?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(_c,{className:"h-4 w-4 animate-spin text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading owner information..."})]})}):n?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Du,{className:"h-3 w-3"}),"Owner/Representative Name"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(n==null?void 0:n.ownerRepresentativeName)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(xP,{className:"h-3 w-3"}),"Contact Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(n==null?void 0:n.contactNumber)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Uw,{className:"h-3 w-3"}),"Email Address"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(n==null?void 0:n.emailAddress)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(so,{className:"h-3 w-3"}),"Birth Date"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:w(n==null?void 0:n.birthDate)})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(vP,{className:"h-3 w-3"}),"Driver's License"]}),l.jsx("div",{className:"ml-4",children:n!=null&&n.hasDriversLicense?l.jsxs("div",{children:[l.jsx(us,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Yes"}),(n==null?void 0:n.driversLicenseNumber)&&l.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["License No: ",n.driversLicenseNumber]})]}):l.jsx(us,{variant:"outline",className:"text-red-600 border-red-600 text-xs",children:"No"})})]}),(n==null?void 0:n.address)&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Ed,{className:"h-3 w-3"}),"Address"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[n.address.barangay,n.address.municipality,n.address.province].filter(Boolean).join(", ")})]})]}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Fg,{className:"h-8 w-8 text-red-400 mx-auto mb-3"}),l.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-2",children:"Failed to load owner information"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Unable to retrieve owner details"})]});return l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[80vh] bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:P=>P.preventDefault(),onEscapeKeyDown:P=>P.preventDefault(),children:[l.jsx(fs,{className:"pb-3 flex-shrink-0",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx(ps,{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Owner Information"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive owner information including contact details, license status, and address"})]})})}),l.jsx("div",{className:"flex flex-col flex-1 min-h-0",children:l.jsx("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:l.jsx(A,{})})})]})})},u5=({onSubmit:e,form:t,submitting:r,hideDateOfRenewal:n=!1,isEditMode:a=!1,readOnlyFields:c=[],prePopulatedOwner:f=""})=>{wa(),co();const{token:i}=Di(),[x,w]=W.useState(""),[A,P]=W.useState([]),[E,D]=W.useState(!1),[V,L]=W.useState(null),[$,H]=W.useState(!1),[K,Q]=W.useState(!1),[ae,ee]=W.useState(!1),[se,ce]=W.useState(!1),[he,Pe]=W.useState(null),Ne=W.useRef(null);W.useEffect(()=>{a&&f&&f.trim()!==""&&(w(f),f&&f!=="Not selected"&&L({_id:t.getValues("driver")||"",ownerRepresentativeName:f}))},[a,f,t]),W.useEffect(()=>{const Re=setTimeout(async()=>{var Fe,He,mt,Xe,ot;if(x.length>=2&&ae){D(!0),H(!1);try{const{data:qe}=await xn.get(`/driver/search?name=${encodeURIComponent(x)}`,{headers:{Authorization:i}});qe.success&&(console.log("Driver search results:",qe.data),console.log("First driver address:",(Fe=qe.data[0])==null?void 0:Fe.address),console.log("Municipality:",(mt=(He=qe.data[0])==null?void 0:He.address)==null?void 0:mt.municipality),console.log("Barangay:",(ot=(Xe=qe.data[0])==null?void 0:Xe.address)==null?void 0:ot.barangay),P(qe.data),qe.data.length===0&&x.length>=3&&H(!0))}catch(qe){console.error("Error searching drivers:",qe),P([]),x.length>=3&&H(!0)}finally{D(!1)}}else P([]),H(!1)},300);return()=>clearTimeout(Re)},[x,i,ae]),W.useEffect(()=>{(A.length>0||$)&&setTimeout(()=>{Ne.current&&Ne.current.scrollIntoView({behavior:"smooth",block:"center"})},100)},[A,$]);const pe=Te=>{L(Te),t.setValue("driver",Te._id),w(Te.ownerRepresentativeName),P([]),H(!1),ee(!1)},je=Te=>{Pe(Te._id),ce(!0)},xe=()=>{L(null),t.setValue("driver",null),w(""),P([]),H(!1),ee(!1)},Ce=()=>{const Te=t.getValues();sessionStorage.setItem("vehicleFormData",JSON.stringify({plateNo:Te.plateNo||"",fileNo:Te.fileNo||"",ownerRepresentativeName:Te.ownerRepresentativeName||x||""})),Q(!0)},ze=Te=>{L(Te),t.setValue("driver",Te._id),w(Te.ownerRepresentativeName),P([]),H(!1),Q(!1),ee(!1),Mn.success("Driver added successfully",{description:"The driver has been selected for this vehicle."})};return l.jsxs(ip,{...t,children:[l.jsx("form",{id:"vehicle-form",onSubmit:t.handleSubmit(Te=>{console.log("Selected driver:",V),console.log("Form data:",Te);let Re=Te.driver;a&&!ae&&!V?Re=Te.driver||t.getValues("driver"):V?Re=V._id:a&&f&&f!=="No driver assigned"&&(Re=t.getValues("driver")||Te.driver);const Fe=(V==null?void 0:V.ownerRepresentativeName)||(x&&x!==""?x:f||"Not selected"),He={...Te,driver:Re,ownerName:Fe};console.log("Form data with owner:",He),e(He)}),children:l.jsxs("div",{className:"space-y-3",children:[l.jsx("div",{children:l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[l.jsx(En,{control:t.control,name:"plateNo",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.plateNo&&"text-red-400"),children:"Plate No."}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",placeholder:"ABC-123",onChange:Re=>{const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)},className:Ut("text-black dark:text-white text-sm",t.formState.errors.plateNo&&"border-red-400")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"fileNo",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.fileNo&&"text-red-400"),children:"File No."}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",readOnly:a&&c.includes("fileNo"),onChange:Re=>{if(!(a&&c.includes("fileNo"))){const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)}},className:Ut("text-black dark:text-white text-sm",t.formState.errors.fileNo&&"border-red-400",a&&c.includes("fileNo")&&"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-gray-600")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"engineNo",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.engineNo&&"text-red-400"),children:"Engine No."}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",onChange:Re=>{const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)},className:Ut("text-black dark:text-white text-sm",t.formState.errors.engineNo&&"border-red-400")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})}),l.jsx("div",{children:l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[l.jsx(En,{control:t.control,name:"chassisNo",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.chassisNo&&"text-red-400"),children:"Chassis No."}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",onChange:Re=>{const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)},className:Ut("text-black dark:text-white text-sm",t.formState.errors.chassisNo&&"border-red-400")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"make",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.make&&"text-red-400"),children:"Make"}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",onChange:Re=>{const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)},className:Ut("text-black dark:text-white text-sm",t.formState.errors.make&&"border-red-400")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"bodyType",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.bodyType&&"text-red-400"),children:"Body Type"}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",onChange:Re=>{const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)},className:Ut("text-black dark:text-white text-sm",t.formState.errors.bodyType&&"border-red-400")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})}),l.jsx("div",{children:l.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-6 gap-3",children:[l.jsx(En,{control:t.control,name:"color",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.color&&"text-red-400"),children:"Color"}),l.jsx(Nn,{children:l.jsx(kn,{...Te,type:"text",onChange:Re=>{const Fe=Re.target.value.toUpperCase();Te.onChange(Fe)},className:Ut("text-black dark:text-white text-sm",t.formState.errors.color&&"border-red-400")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"classification",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.classification&&"text-red-400"),children:"Classification"}),l.jsxs(Uo,{onValueChange:Te.onChange,value:Te.value,children:[l.jsx(Nn,{children:l.jsx(So,{className:Ut("text-black dark:text-white text-sm",t.formState.errors.classification&&"border-red-400"),children:l.jsx($o,{placeholder:"Select classification"})})}),l.jsx(Ao,{children:l.jsxs(w3,{children:[l.jsx(S3,{children:"Classifications"}),l.jsx(pn,{value:"Private",children:"PRIVATE"}),l.jsx(pn,{value:"For Hire",children:"FOR HIRE"}),l.jsx(pn,{value:"Government",children:"GOVERNMENT"})]})})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:t.control,name:"vehicleStatusType",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.vehicleStatusType&&"text-red-400"),children:"Vehicle Status Type"}),l.jsxs(Uo,{onValueChange:Te.onChange,value:Te.value,children:[l.jsx(Nn,{children:l.jsx(So,{className:Ut("text-black dark:text-white text-sm",t.formState.errors.vehicleStatusType&&"border-red-400"),children:l.jsx($o,{placeholder:"Select vehicle status type"})})}),l.jsx(Ao,{children:l.jsxs(w3,{children:[l.jsx(S3,{children:"Vehicle Status"}),l.jsx(pn,{value:"New",children:"New Vehicle"}),l.jsx(pn,{value:"Old",children:"Old Vehicle"})]})})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),!n&&l.jsx(En,{control:t.control,name:"dateOfRenewal",render:({field:Te})=>l.jsxs(jn,{className:"lg:col-span-2",children:[l.jsx($n,{className:Ut("text-muted-foreground mb-0",t.formState.errors.dateOfRenewal&&"text-red-400"),children:"Date of Renewal"}),a&&c.includes("dateOfRenewal")?l.jsx(kn,{value:Te.value?wc(Te.value,"PPP"):"Not set",readOnly:!0,className:"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-gray-600 text-sm"}):l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsx(Nn,{children:l.jsxs(Nr,{variant:"outline",className:Ut("w-full pl-3 text-left font-normal text-black dark:text-white text-sm",!Te.value&&"text-muted-foreground",t.formState.errors.dateOfRenewal&&"border-red-400"),children:[Te.value?wc(Te.value,"PPP"):l.jsx("span",{children:"Pick a date"}),l.jsx(so,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),l.jsx(sy,{className:"w-auto p-0",align:"start",children:l.jsx(D2,{fieldValue:Te.value,dateValue:Te.onChange})})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})}),l.jsxs("div",{children:[l.jsx(ls,{children:"Driver/Owner Information"}),l.jsx("div",{className:"mt-1",children:l.jsx(En,{control:t.control,name:"driver",render:({field:Te})=>l.jsxs(jn,{children:[l.jsx($n,{className:"text-muted-foreground mb-0",children:"Search and Select Driver/Owner"}),l.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Format: Surname Suffix (Optional), FirstName, Middle Initial"}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"flex gap-2",children:l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(kn,{ref:Ne,placeholder:"Type driver/owner name to search...",value:x,onChange:Re=>{const Fe=Re.target.value.toUpperCase();w(Fe),ae||ee(!0)},onFocus:()=>{ae||ee(!0)},className:Ut("pr-10 text-sm",a&&!ae&&"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-gray-600"),readOnly:a&&!ae}),E&&l.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:l.jsx(_c,{className:"h-4 w-4 animate-spin text-muted-foreground"})}),!E&&a&&!ae&&l.jsx("button",{type:"button",onClick:()=>ee(!0),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-600 hover:text-blue-800",children:l.jsx(sR,{className:"h-4 w-4"})}),!E&&x&&ae&&l.jsx("button",{type:"button",onClick:xe,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:l.jsx(Qf,{className:"h-4 w-4"})})]})}),(A.length>0||$)&&ae&&l.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-background border border-border rounded-md shadow-lg max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent hover:scrollbar-thumb-gray-400",children:[A.map(Re=>l.jsxs("div",{className:"p-3 hover:bg-accent border-b border-border last:border-b-0 transition-colors flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>pe(Re),children:[l.jsx("div",{className:"text-sm font-medium text-foreground",children:Re.ownerRepresentativeName}),l.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Current vehicles: ",Re.plateNo||"None"]})]}),l.jsx(Nr,{type:"button",variant:"ghost",size:"sm",onClick:Fe=>{Fe.stopPropagation(),je(Re)},className:"ml-2 h-6 w-6 p-0 text-blue-600 hover:text-blue-800 hover:bg-blue-50",children:l.jsx(kA,{className:"h-3 w-3"})})]},Re._id)),$&&A.length===0&&!V&&l.jsxs("div",{className:"p-3 hover:bg-accent cursor-pointer border-b border-border last:border-b-0 bg-accent/50 transition-colors",onClick:Ce,children:[l.jsxs("div",{className:"text-sm font-medium text-primary",children:['+ Add "',x,'" as new driver']}),l.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Click to create a new driver record"})]})]}),V&&!ae&&l.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded-md",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-sm font-medium text-green-800",children:["Selected: ",V.ownerRepresentativeName]}),l.jsxs("div",{className:"text-xs text-green-600",children:["Current vehicles: ",V.plateNo||"None"]})]}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx(Nr,{type:"button",variant:"ghost",size:"sm",onClick:()=>ee(!0),className:"text-blue-600 hover:text-blue-800 h-6 w-6 p-0",children:l.jsx(sR,{className:"h-3 w-3"})}),l.jsx(Nr,{type:"button",variant:"ghost",size:"sm",onClick:xe,className:"text-green-600 hover:text-green-800 h-6 w-6 p-0",children:l.jsx(Qf,{className:"h-3 w-3"})})]})]})})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})})]})]})}),l.jsx(NVe,{open:K,onOpenChange:Q,onDriverAdded:ze}),l.jsx(jVe,{open:se,onOpenChange:ce,ownerId:he})]})},CVe=({open:e,onOpenChange:t,onVehicleAdded:r})=>{const[n,a]=W.useState(!1),[c,f]=W.useState(!1),[i,x]=W.useState(null),{token:w}=Di(),A=Jl(Date.now()),P=Cl({resolver:tc(EZ),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,vehicleStatusType:"",driver:""}}),E=async L=>{console.log("Received form data in AddVehicleModal:",L),console.log("Owner name:",L.ownerName),x(L),f(!0)},D=async()=>{var L,$;a(!0),f(!1);try{const H=i;console.log("Form data in handleConfirmSubmission:",H),console.log("vehicleStatusType in formData:",H.vehicleStatusType);const K={plateNo:H.plateNo,fileNo:H.fileNo,engineNo:H.engineNo,serialChassisNumber:H.chassisNo,make:H.make,bodyType:H.bodyType,color:H.color,classification:H.classification,vehicleStatusType:H.vehicleStatusType,driverId:H.driver};H.dateOfRenewal&&(K.dateOfRenewal=H.dateOfRenewal),console.log("Content being sent to API:",K),console.log("vehicleStatusType in content:",K.vehicleStatusType),console.log("driverId in content:",K.driverId),console.log("driverId type:",typeof K.driverId),console.log("plateNo in content:",K.plateNo),console.log("fileNo in content:",K.fileNo);const{data:Q}=await xn.post("/vehicle",K,{headers:{Authorization:w}});Q.success&&(Mn.success("Vehicle has been added",{description:A}),P.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(!1),r&&r())}catch(H){console.log(H);const K=(($=(L=H.response)==null?void 0:L.data)==null?void 0:$.message)||"Failed to add vehicle";Mn.error(K,{description:A})}finally{a(!1)}},V=L=>{!L&&!n&&P.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,dateOfRenewal:void 0,driver:""}),t(L)};return l.jsxs(l.Fragment,{children:[l.jsx(hs,{open:e,onOpenChange:V,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs(fs,{className:"flex-shrink-0",children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5"}),"Add New Vehicle"]}),l.jsx(bo,{children:"Fill in the required fields to add a new vehicle record to the system."})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:l.jsx(u5,{form:P,onSubmit:E,submitting:n})}),l.jsxs(jl,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>V(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),l.jsxs(Nr,{type:"submit",form:"vehicle-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[n&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Vehicle"]})]})]})}),l.jsx(hs,{open:c,onOpenChange:f,children:l.jsxs(Xa,{className:"max-w-lg border border-gray-200",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5"}),"Confirm Vehicle Information"]}),l.jsx(bo,{children:"Please review the vehicle information before submitting."})]}),i&&l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Details"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Plate No:"}),l.jsx("div",{className:"col-span-3",children:i.plateNo}),l.jsx("div",{className:"font-medium text-gray-600",children:"File No:"}),l.jsx("div",{className:"col-span-3",children:i.fileNo||"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Engine No:"}),l.jsx("div",{className:"col-span-3",children:i.engineNo}),l.jsx("div",{className:"font-medium text-gray-600",children:"Chassis No:"}),l.jsx("div",{className:"col-span-3",children:i.chassisNo})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Vehicle Specifications"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Make:"}),l.jsx("div",{className:"col-span-3",children:i.make}),l.jsx("div",{className:"font-medium text-gray-600",children:"Body Type:"}),l.jsx("div",{className:"col-span-3",children:i.bodyType}),l.jsx("div",{className:"font-medium text-gray-600",children:"Color:"}),l.jsx("div",{className:"col-span-3",children:i.color}),l.jsx("div",{className:"font-medium text-gray-600",children:"Classification:"}),l.jsx("div",{className:"col-span-3",children:i.classification})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Renewal"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Date of Renewal:"}),l.jsx("div",{className:"col-span-3",children:i.dateOfRenewal?new Date(i.dateOfRenewal).toLocaleDateString():"Not provided"}),l.jsx("div",{className:"font-medium text-gray-600",children:"Vehicle Status:"}),l.jsx("div",{className:"col-span-3",children:i.vehicleStatusType||"Not selected"})]})})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-xs text-black mb-2 pl-3",children:"Owner"}),l.jsx("div",{className:"bg-gray-50 rounded-md p-3",children:l.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[l.jsx("div",{className:"font-medium text-gray-600",children:"Owner Name:"}),l.jsx("div",{className:"col-span-3",children:i.ownerName||"Not selected"})]})})]})]}),l.jsxs(jl,{className:"flex justify-end gap-3 pt-6",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>{f(!1),P.clearErrors()},disabled:n,className:"min-w-[100px] bg-white border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),l.jsxs(Nr,{onClick:D,disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-600 hover:to-blue-800 text-white shadow-lg border border-blue-600 relative overflow-hidden",children:[n&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Confirm & Add Vehicle",l.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gradient-to-br from-blue-300 to-blue-500 transform rotate-45 translate-x-2 -translate-y-2 opacity-60"})]})]})]})})]})},kVe=({open:e,onOpenChange:t,vehicleData:r})=>{const[n,a]=W.useState("vehicle"),[c,f]=W.useState(null),[i,x]=W.useState(!1),[w,A]=W.useState([]),[P,E]=W.useState(!1),[D,V]=W.useState(null),{token:L}=Di();W.useEffect(()=>{e&&(r!=null&&r.driverId)&&$(),e&&(r!=null&&r._id)&&H()},[e,r]);const $=async()=>{var Ne,pe;if(console.log("=== FETCHING OWNER DATA ==="),console.log("vehicleData:",r),console.log("driverId:",r==null?void 0:r.driverId),console.log("driverId type:",typeof(r==null?void 0:r.driverId)),console.log("driverId value:",r==null?void 0:r.driverId),!(r!=null&&r.driverId)){console.log("No driverId found, skipping fetch");return}x(!0);try{console.log(`Fetching driver data for ID: ${r.driverId}`);const{data:je}=await xn.get(`/driver/${r.driverId}`,{headers:{Authorization:L}});console.log("Driver data received:",je),f(je.data)}catch(je){console.error("Error fetching owner data:",je),console.error("Error response:",(Ne=je.response)==null?void 0:Ne.data),console.error("Error status:",(pe=je.response)==null?void 0:pe.status)}finally{x(!1)}},H=async()=>{var Ne,pe;if(!(r!=null&&r._id)){console.log("No vehicle ID found, skipping renewal history fetch");return}E(!0),V(null);try{console.log(`Fetching renewal history for vehicle ID: ${r._id}`);const{data:je}=await xn.get(`/renewal-history/vehicle/${r._id}`,{headers:{Authorization:L}});je.success?(A(je.data.history||[]),console.log("Renewal history received:",je.data.history)):V(je.message||"Failed to fetch renewal history")}catch(je){console.error("Error fetching renewal history:",je);const xe=((pe=(Ne=je.response)==null?void 0:Ne.data)==null?void 0:pe.message)||"Failed to fetch renewal history";V(xe),Mn.error("Failed to load renewal history")}finally{E(!1)}},K=Ne=>Ne?new Date(Ne).toLocaleDateString():"Not set",Q=Ne=>Ne?new Date(Ne).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",ae=Ne=>{const pe=Ne==="1"||Ne===1;return l.jsxs("div",{className:"flex items-center gap-1",children:[pe?l.jsx(iR,{className:"h-3 w-3 text-green-500"}):l.jsx(Fg,{className:"h-3 w-3 text-red-500"}),l.jsx("span",{className:`text-xs font-semibold ${pe?"text-green-600":"text-red-600"}`,children:pe?"Active":"Expired"})]})},ee=Ne=>{let pe,je;switch(Ne){case"Early Renewal":pe="bg-blue-100 text-blue-800 border-blue-200",je=l.jsx(so,{className:"h-3 w-3"});break;case"On-Time Renewal":pe="bg-green-100 text-green-800 border-green-200",je=l.jsx(iR,{className:"h-3 w-3"});break;case"Late Renewal":pe="bg-red-100 text-red-800 border-red-200",je=l.jsx(Fg,{className:"h-3 w-3"});break;default:pe="bg-gray-100 text-gray-800 border-gray-200",je=l.jsx(Fg,{className:"h-3 w-3"})}return l.jsx(us,{variant:"outline",className:`text-xs font-medium ${pe}`,children:l.jsxs("div",{className:"flex items-center gap-1",children:[je,Ne]})})},se=()=>l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(EA,{className:"h-3 w-3"}),"Plate Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.plateNo)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Ld,{className:"h-3 w-3"}),"File Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.fileNo)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(pH,{className:"h-3 w-3"}),"Engine Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.engineNo)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(EA,{className:"h-3 w-3"}),"Chassis Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.chassisNo)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Xb,{className:"h-3 w-3"}),"Make"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.make)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(cl,{className:"h-3 w-3"}),"Body Type"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.bodyType)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(hH,{className:"h-3 w-3"}),"Color"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.color)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Pde,{className:"h-3 w-3"}),"Classification"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.classification)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(so,{className:"h-3 w-3"}),"Date of Renewal"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:K(r==null?void 0:r.dateOfRenewal)})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Px,{className:"h-3 w-3"}),"Status"]}),l.jsx("div",{className:"ml-4",children:ae(r==null?void 0:r.status)})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(eD,{className:"h-3 w-3"}),"Vehicle Status Type"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.vehicleStatusType)||"N/A"})]})]})}),ce=()=>i?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):c?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Du,{className:"h-3 w-3"}),"Owner/Representative Name"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(c==null?void 0:c.ownerRepresentativeName)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(xP,{className:"h-3 w-3"}),"Contact Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(c==null?void 0:c.contactNumber)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Uw,{className:"h-3 w-3"}),"Email Address"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(c==null?void 0:c.emailAddress)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(so,{className:"h-3 w-3"}),"Birth Date"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:Q(c==null?void 0:c.birthDate)})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(vP,{className:"h-3 w-3"}),"Driver's License"]}),l.jsx("div",{className:"ml-4",children:c!=null&&c.hasDriversLicense?l.jsxs("div",{children:[l.jsx(us,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Yes"}),(c==null?void 0:c.driversLicenseNumber)&&l.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["License No: ",c.driversLicenseNumber]})]}):l.jsx(us,{variant:"outline",className:"text-red-600 border-red-600 text-xs",children:"No"})})]}),(c==null?void 0:c.address)&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Ed,{className:"h-3 w-3"}),"Address"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:[c.address.barangay,c.address.municipality,c.address.province].filter(Boolean).join(", ")})]})]}):l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No owner information available"})}),he=()=>P?l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(_c,{className:"h-4 w-4 animate-spin text-blue-600"}),l.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Loading renewal history..."})]})}):D?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Fg,{className:"h-8 w-8 text-red-400 mx-auto mb-3"}),l.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-2",children:"Failed to load renewal history"}),l.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-4",children:D}),l.jsxs(Nr,{variant:"outline",size:"sm",onClick:H,className:"text-xs",children:[l.jsx(CS,{className:"h-3 w-3 mr-1"}),"Retry"]})]}):!w||w.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(CS,{className:"h-8 w-8 text-gray-400 mx-auto mb-3"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"No renewal history found"}),l.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Renewal records will appear here when the vehicle is renewed"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:["Renewal History (",w.length," records)"]}),l.jsxs(Nr,{variant:"outline",size:"sm",onClick:H,className:"text-xs",children:[l.jsx(CS,{className:"h-3 w-3 mr-1"}),"Refresh"]})]}),l.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:l.jsxs(km,{children:[l.jsx(Em,{children:l.jsxs(Ns,{className:"bg-gray-50 dark:bg-gray-700",children:[l.jsx(Ts,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Date"}),l.jsx(Ts,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Status"}),l.jsx(Ts,{className:"text-xs font-semibold text-gray-700 dark:text-gray-300",children:"Processed By"})]})}),l.jsx(Mm,{children:w.map((Ne,pe)=>{var je;return l.jsxs(Ns,{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[l.jsx(ha,{className:"text-xs text-gray-900 dark:text-gray-100",children:K(Ne.renewalDate)}),l.jsx(ha,{className:"text-xs",children:ee(Ne.status)}),l.jsx(ha,{className:"text-xs text-gray-600 dark:text-gray-400",children:((je=Ne.processedBy)==null?void 0:je.fullname)||"System"})]},Ne._id||pe)})})]})})]}),Pe=[{id:"vehicle",label:"Vehicle Information",icon:cl},{id:"owner",label:"Owner Information",icon:Du},{id:"renewal",label:"Renewal History",icon:CS}];return l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[80vh] bg-gradient-to-br from-slate-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:Ne=>Ne.preventDefault(),onEscapeKeyDown:Ne=>Ne.preventDefault(),children:[l.jsx(fs,{className:"pb-3 flex-shrink-0",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx(ps,{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Vehicle Details"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive vehicle information including registration details, specifications, and current status"}),l.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-1",children:[l.jsx(Ld,{className:"h-3 w-3 text-blue-500"}),"File Number: ",l.jsx("span",{className:"font-semibold text-blue-600",children:(r==null?void 0:r.fileNo)||"N/A"})]})]})})}),l.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[l.jsx("div",{className:"flex-shrink-0 mb-3",children:l.jsx("div",{className:"flex space-x-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm p-1 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:Pe.map(Ne=>{const pe=Ne.icon;return l.jsxs(Nr,{variant:"ghost",onClick:()=>a(Ne.id),className:`flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 ${n===Ne.id?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-gray-700"}`,children:[l.jsx(pe,{className:"h-3 w-3"}),l.jsx("span",{className:"hidden sm:inline",children:Ne.label})]},Ne.id)})})}),l.jsxs("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[n==="vehicle"&&l.jsx(se,{}),n==="owner"&&l.jsx(ce,{}),n==="renewal"&&l.jsx(he,{})]})]})]})})},EVe=({open:e,onOpenChange:t,onContinue:r,onCancel:n})=>l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-md",children:[l.jsx(fs,{children:l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(sR,{className:"h-5 w-5"}),"No Changes Detected"]})}),l.jsx("div",{className:"py-4",children:l.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"No changes were made to the vehicle information. Would you like to continue editing?"})}),l.jsxs(jl,{className:"flex justify-end gap-3",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:n,className:"min-w-[80px] bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700",children:"No"}),l.jsx(Nr,{type:"button",onClick:r,className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})}),MVe=({open:e,onOpenChange:t,vehicleId:r,onVehicleUpdated:n})=>{const[a,c]=W.useState(!1),[f,i]=W.useState({}),[x,w]=W.useState({}),[A,P]=W.useState(!1),[E,D]=W.useState(!1),{token:V}=Di(),L=Jl(Date.now()),$=Cl({resolver:tc(Sye),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,vehicleStatusType:"",dateOfRenewal:void 0,driver:"",ownerName:""}}),{reset:H}=$;W.useEffect(()=>{e&&r&&K()},[e,r,V]),W.useEffect(()=>{Object.keys(f).length>0&&H(f)},[f,H]);const K=async()=>{var he,Pe,Ne,pe,je,xe,Ce,ze,Te,Re,Fe,He,mt,Xe,ot;P(!0);try{const{data:qe}=await xn.get(`/vehicle/${r}`,{headers:{Authorization:V}});if(qe){console.log("Classification from database:",(he=qe.data)==null?void 0:he.classification),console.log("Full vehicle data:",qe.data);const Lt=Xt=>Xt?{PRIVATE:"Private","FOR HIRE":"For Hire",GOVERNMENT:"Government",Private:"Private","For Hire":"For Hire",Government:"Government"}[Xt]||Xt:void 0,Zt={plateNo:((Pe=qe.data)==null?void 0:Pe.plateNo)||"",fileNo:((Ne=qe.data)==null?void 0:Ne.fileNo)||"",engineNo:((pe=qe.data)==null?void 0:pe.engineNo)||"",chassisNo:((je=qe.data)==null?void 0:je.serialChassisNumber)||"",make:((xe=qe.data)==null?void 0:xe.make)||"",bodyType:((Ce=qe.data)==null?void 0:Ce.bodyType)||"",color:((ze=qe.data)==null?void 0:ze.color)||"",classification:Lt((Te=qe.data)==null?void 0:Te.classification),vehicleStatusType:((Re=qe.data)==null?void 0:Re.vehicleStatusType)||"Old",dateOfRenewal:(Fe=qe.data)!=null&&Fe.dateOfRenewal?new Date(qe.data.dateOfRenewal):void 0,driver:((mt=(He=qe.data)==null?void 0:He.driverId)==null?void 0:mt._id)||"",ownerName:((ot=(Xe=qe.data)==null?void 0:Xe.driverId)==null?void 0:ot.ownerRepresentativeName)||"No driver assigned"};i(Zt),w(Zt)}}catch(qe){console.log(qe),Mn.error("Failed to load vehicle data",{description:L})}finally{P(!1)}},Q=he=>{const Pe={plateNo:he.plateNo,engineNo:he.engineNo,chassisNo:he.chassisNo,make:he.make,bodyType:he.bodyType,color:he.color,classification:he.classification,vehicleStatusType:he.vehicleStatusType,driver:he.driver},Ne={plateNo:x.plateNo,engineNo:x.engineNo,chassisNo:x.chassisNo,make:x.make,bodyType:x.bodyType,color:x.color,classification:x.classification,vehicleStatusType:x.vehicleStatusType,driver:x.driver};return JSON.stringify(Pe)!==JSON.stringify(Ne)},ae=async he=>{var Pe,Ne;if(!Q(he)){D(!0);return}c(!0);try{const pe={plateNo:he.plateNo,fileNo:he.fileNo,engineNo:he.engineNo,serialChassisNumber:he.chassisNo,make:he.make,bodyType:he.bodyType,color:he.color,classification:he.classification,vehicleStatusType:he.vehicleStatusType,...he.driver&&he.driver!==x.driver&&{driverId:he.driver}},{data:je}=await xn.patch(`/vehicle/${r}`,pe,{headers:{Authorization:V}});je.success&&(Mn.success("Vehicle updated successfully",{description:L}),t(!1),n&&n())}catch(pe){console.log(pe);const je=((Ne=(Pe=pe.response)==null?void 0:Pe.data)==null?void 0:Ne.message)||"An error occurred";Mn.error(je,{description:L})}finally{c(!1)}},ee=he=>{!he&&!a&&($.reset({plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0,vehicleStatusType:"",dateOfRenewal:void 0,driver:"",ownerName:""}),i({})),t(he)},se=()=>{D(!1)},ce=()=>{D(!1),t(!1)};return A?l.jsx(hs,{open:e,onOpenChange:ee,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs(fs,{className:"flex-shrink-0",children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5"}),"Edit Vehicle"]}),l.jsx(bo,{children:"Loading vehicle data..."})]}),l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}):l.jsxs(l.Fragment,{children:[l.jsx(hs,{open:e,onOpenChange:ee,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs(fs,{className:"flex-shrink-0",children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5"}),"Edit Vehicle"]}),l.jsx(bo,{children:"Fill in the required fields to edit vehicle information."})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:l.jsx(u5,{form:$,onSubmit:ae,submitting:a,hideDateOfRenewal:!1,isEditMode:!0,readOnlyFields:["fileNo","dateOfRenewal"],prePopulatedOwner:f.ownerName})}),l.jsxs(jl,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>ee(!1),disabled:a,className:"min-w-[100px]",children:"Cancel"}),l.jsxs(Nr,{type:"submit",form:"vehicle-form",disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[a&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Vehicle"]})]})]})}),l.jsx(EVe,{open:E,onOpenChange:D,onContinue:se,onCancel:ce})]})},OVe=()=>{const[e,t]=W.useState([]),{token:r}=Di();wa(),co();const[n,a]=W.useState(!0);Jl(Date.now());const[c,f]=W.useState(!1),[i,x]=W.useState(!1),[w,A]=W.useState(!1),[P,E]=W.useState(!1),[D,V]=W.useState(!1),[L,$]=W.useState(null),[H,K]=W.useState(null);W.useEffect(()=>{Q()},[]);const Q=async()=>{try{const{data:Pe}=await xn.get("/vehicle?limit=500",{headers:{Authorization:r}}),Ne=Pe.data.map(pe=>{var xe;console.log("Processing vehicle data:",pe.plateNo,"DriverId:",pe.driverId),console.log("DriverId type:",typeof pe.driverId),console.log("DriverId is object:",typeof pe.driverId=="object");const je=typeof pe.driverId=="object"&&((xe=pe.driverId)!=null&&xe._id)?pe.driverId._id:pe.driverId;return console.log("Final driverId:",je),{_id:pe._id,plateNo:pe.plateNo,fileNo:pe.fileNo,engineNo:pe.engineNo,chassisNo:pe.serialChassisNumber,make:pe.make,bodyType:pe.bodyType,color:pe.color,classification:pe.classification,dateOfRenewal:pe.dateOfRenewal,status:pe.status,driverId:je,vehicleStatusType:pe.vehicleStatusType}});t(Ne)}catch(Pe){console.log(Pe)}finally{a(!1)}},ae=async()=>{A(!0)},ee=Pe=>{console.log("=== VEHICLE ROW CLICKED ==="),console.log("Vehicle data:",Pe),console.log("DriverId:",Pe==null?void 0:Pe.driverId),$(Pe),E(!0)},se=Pe=>{K(Pe),V(!0)},ce=()=>{Q()},he=()=>{Q()};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[l.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Vehicles"}),l.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:l.jsx(TVe,{data:e,filters:["plateNo","fileNo","engineNo","chassisNo","classification","status"],tableColumn:ABe,onAdd:ae,loading:n,onRowClick:ee,onEdit:se,submitting:c})})]}),l.jsx(PVe,{open:i,onOpenChange:x,onVehicleUpdated:ce}),l.jsx(CVe,{open:w,onOpenChange:A,onVehicleAdded:he}),l.jsx(kVe,{open:P,onOpenChange:E,vehicleData:L}),l.jsx(MVe,{open:D,onOpenChange:V,vehicleId:H,onVehicleUpdated:ce})]})},RVe=()=>{const e=oy(),[t,r]=W.useState(!0),{token:n}=Di(),[a,c]=W.useState(),[f,i]=W.useState(!1),[x,w]=W.useState(!1),A=co(),P=wa(),E=async()=>{try{r(!0);const{data:D}=await xn.get(`/vehicle/${e.id}`,{headers:{Authorization:n}});D&&c(D.data)}catch(D){console.error("Error fetching vehicle:",D),Mn.error("Failed to load vehicle data")}finally{r(!1)}};return W.useEffect(()=>{E()},[]),t?l.jsx(Ci,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:l.jsx(Ii,{className:"p-6",children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsx("div",{className:"text-muted-foreground",children:"Loading vehicle data..."})})})}):l.jsx(l.Fragment,{children:l.jsxs(Ci,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[l.jsxs(zi,{className:"border-b",children:[l.jsx(Fi,{className:"text-3xl font-bold",children:a!=null&&a.make?WO(a.make):"N/A"}),l.jsx(As,{children:(a==null?void 0:a.plateNo)||"N/A"})]}),l.jsx(Ii,{className:"p-0 pb-6",children:l.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[l.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Vehicle Information"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate Number:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"File Number:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.fileNo)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Engine Number:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.engineNo)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Chassis Number:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.chassisNo)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Make:"}),l.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.make?WO(a.make):"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Body Type:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.bodyType)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Color:"}),l.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.color?WO(a.color):"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Classification:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.classification)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Date of Renewal:"}),l.jsx("p",{className:"font-semibold w-full",children:a!=null&&a.dateOfRenewal?iy(a.dateOfRenewal):"Not set"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Status:"}),l.jsx("p",{className:"font-semibold w-full",children:l.jsx("span",{className:`px-2 py-1 rounded text-xs ${(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:(a==null?void 0:a.status)==="1"||(a==null?void 0:a.status)===1?"Active":"Expired"})})]})}),l.jsx(j4,{className:"gap-2 text-sm ",children:l.jsxs(Nr,{onClick:()=>P(`${A.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[l.jsx(ao,{}),"Edit"]})})]})})},IVe=()=>{const e=wa();return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:l.jsxs(Nr,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[l.jsx(gP,{})," Back"]})}),l.jsx("div",{className:"p-4 md:p-0",children:l.jsx(RVe,{})})]})},DVe=()=>{const[e,t]=W.useState(!1),{token:r}=Di(),n=oy(),a=Jl(Date.now()),[c,f]=W.useState({}),i=wa(),x=Cl({resolver:tc(EZ),defaultValues:{plateNo:"",fileNo:"",engineNo:"",chassisNo:"",make:"",bodyType:"",color:"",classification:void 0}}),{reset:w}=x;W.useEffect(()=>{Object.keys(c).length>0&&w(c)},[c,w]),W.useEffect(()=>{A()},[n.id,r]);const A=async()=>{var D,V,L,$,H,K,Q,ae;const E=n.id;try{const{data:ee}=await xn.get(`/vehicle/${E}`,{headers:{Authorization:r}});if(ee){const se={plateNo:(D=ee.data)==null?void 0:D.plateNo,fileNo:(V=ee.data)==null?void 0:V.fileNo,engineNo:(L=ee.data)==null?void 0:L.engineNo,chassisNo:($=ee.data)==null?void 0:$.chassisNo,make:(H=ee.data)==null?void 0:H.make,bodyType:(K=ee.data)==null?void 0:K.bodyType,color:(Q=ee.data)==null?void 0:Q.color,classification:(ae=ee.data)==null?void 0:ae.classification};f(se)}}catch(ee){console.log(ee)}},P=async E=>{var D,V;t(!0);try{const L={plateNo:E.plateNo,fileNo:E.fileNo,engineNo:E.engineNo,serialChassisNumber:E.chassisNo,make:E.make,bodyType:E.bodyType,color:E.color,classification:E.classification},{data:$}=await xn.patch(`/vehicle/${n.id}`,L,{headers:{Authorization:r}});$.success&&(Mn.success("Vehicle updated",{description:a}),i(-1))}catch(L){console.log(L);const $=((V=(D=L.response)==null?void 0:D.data)==null?void 0:V.message)||"An error occurred";Mn.error($,{description:`${a}`})}finally{t(!1)}};return l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsx(Fi,{className:"text-xl md:text-3xl font-bold",children:"Edit Vehicle"}),l.jsx(As,{children:"Fill in required fields to edit vehicle."})]}),l.jsx(Ii,{children:l.jsx(u5,{form:x,onSubmit:P,submitting:e,hideDateOfRenewal:!0})})]})},LVe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:c,onAdd:f,onEdit:i,onUpdateStatus:x,submitting:w})=>{var se;const[A,P]=Oe.useState([]),[E,D]=Oe.useState([]),[V,L]=Oe.useState({}),[$,H]=Oe.useState({pageIndex:0,pageSize:8}),[K,Q]=Oe.useState(""),ae=t,ee=E2({data:n,columns:r(i,x,w),onSortingChange:P,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:N2(),getPaginationRowModel:C2(),getSortedRowModel:k2(),getFilteredRowModel:j2(),onColumnVisibilityChange:L,onGlobalFilterChange:Q,globalFilterFn:(ce,he,Pe)=>ae.some(Ne=>{const pe=ce.getValue(Ne);return String(pe).toLowerCase().includes(Pe.toLowerCase())}),state:{pagination:$,sorting:A,columnFilters:E,columnVisibility:V,globalFilter:K}});return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsx(ls,{className:"font-semibold",children:e}),l.jsxs("div",{className:"md:flex items-center justify-between py-3 flex-shrink-0",children:[l.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[l.jsx(v_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),l.jsx(kn,{placeholder:"Search Violation...",value:K??"",onChange:ce=>Q(ce.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"}),K&&l.jsx("button",{onClick:()=>Q(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(Qf,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[l.jsxs(Nr,{onClick:f,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[l.jsx(J0,{}),l.jsx("span",{className:"hidden lg:inline",children:"Add Violation"})]}),l.jsx(O2,{table:ee})]})]}),l.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0",children:l.jsx("div",{className:"overflow-auto h-full",children:l.jsx("div",{className:"px-0",children:l.jsxs(km,{children:[l.jsx(Em,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:ee.getHeaderGroups().map(ce=>l.jsx(Ns,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:ce.headers.map(he=>l.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-3 py-2 whitespace-nowrap text-left",children:cp(he.column.columnDef.header,he.getContext())},he.id))},ce.id))}),l.jsx(Mm,{className:"text-xs bg-white dark:bg-transparent",children:a?l.jsx(M2,{rowCount:5,cellCount:ee.getAllColumns().length}):(se=ee.getRowModel().rows)!=null&&se.length?ee.getRowModel().rows.map(ce=>l.jsx(Ns,{onClick:()=>c(ce.original),"data-state":ce.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:ce.getVisibleCells().map(he=>l.jsx(ha,{className:"px-3 py-3 text-gray-800 dark:text-gray-200 text-left",children:cp(he.column.columnDef.cell,he.getContext())},he.id))},ce.id)):l.jsx(Ns,{className:"hover:bg-transparent",children:l.jsx(ha,{colSpan:ee.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center justify-center",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),l.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),l.jsx("div",{className:"mt-3 flex-shrink-0",children:l.jsx(R2,{table:ee})})]})},d5=({form:e,onSubmit:t,submitting:r,isEditMode:n=!1})=>{wa();const[a,c]=W.useState([]),[f,i]=W.useState(!1),[x,w]=W.useState(null),A=pR({control:e.control,name:"violationType",defaultValue:"confiscated"}),P=pR({control:e.control,name:"violations",defaultValue:[]});W.useEffect(()=>{console.log("=== VIOLATIONS USEEFFECT TRIGGERED ==="),console.log("formViolations:",P),console.log("violations.length:",a.length),console.log("current violations state:",a),P&&P.length>0?(console.log("Setting violations to formViolations:",P),c(P)):a.length===0&&(console.log('No form violations, setting to [""]'),c([""]),e.setValue("violations",[""]))},[P,e]);const E=()=>{console.log("=== ADD VIOLATION CLICKED ==="),console.log("Current violations state:",a),console.log("Current form violations:",P);const K=[...a,""];console.log("New violations array:",K),c(K),e.setValue("violations",K),console.log("After setViolations and setValue"),console.log("Updated violations state:",K)},D=K=>{if(a.length>1)if(n&&a[K]&&a[K].trim()!=="")w(K),i(!0);else{const Q=a.filter((ae,ee)=>ee!==K);c(Q),e.setValue("violations",Q)}},V=()=>{if(x!==null){const K=a.filter((Q,ae)=>ae!==x);c(K),e.setValue("violations",K)}i(!1),w(null)},L=()=>{i(!1),w(null)},$=(K,Q)=>{const ae=[...a];ae[K]=Q,c(ae),e.setValue("violations",ae)},H=K=>{console.log("=== FORM COMPONENT SUBMIT ==="),console.log("Form submitted with data:",K),console.log("Form state:",e.formState),console.log("Form errors:",e.formState.errors),t(K)};return l.jsxs(ip,{...e,children:[l.jsxs("form",{id:"violation-form",onSubmit:e.handleSubmit(H),className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsx(En,{control:e.control,name:"violationType",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Violation Type"}),l.jsxs(Uo,{onValueChange:K.onChange,defaultValue:K.value,children:[l.jsx(Nn,{children:l.jsx(So,{className:"text-xs",children:l.jsx($o,{placeholder:"Select violation type"})})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"confiscated",children:"Confiscated"}),l.jsx(pn,{value:"alarm",children:"Alarm"}),l.jsx(pn,{value:"impounded",children:"Impounded"})]})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"topNo",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"TOP NO."}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"TOP-0001",...K,value:K.value==="null"?"null":K.value||"",readOnly:n,className:Ut("text-xs",n&&"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 cursor-not-allowed border-gray-300 dark:border-gray-600")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"apprehendingOfficer",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Apprehending Officer"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Officer Name",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]}),!n||A==="confiscated"||A==="impounded"?l.jsxs("div",{className:"space-y-0",children:[l.jsx("h6",{className:"text-sm font-semibold",children:"Violater's Details"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsx(En,{control:e.control,name:"firstName",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"First Name"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"John",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"middleInitial",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Middle Initial"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"D",maxLength:1,...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"lastName",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Last Name"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Doe",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"suffix",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Suffix"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Jr.",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})]}):null,!n||A==="confiscated"||A==="impounded"?l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"space-y-1",children:[l.jsx("label",{className:"text-xs text-gray-600",children:"Violation/s"}),console.log("=== RENDERING VIOLATIONS ===",a),a.map((K,Q)=>(console.log(`Rendering violation ${Q}:`,K),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(kn,{placeholder:`Violation ${Q+1}`,value:K||"",onChange:ae=>$(Q,ae.target.value),className:"text-xs"}),a.length>1&&l.jsx(Nr,{type:"button",variant:"outline",size:"icon",onClick:()=>D(Q),children:l.jsx(Qf,{className:"h-4 w-4"})})]},Q))),l.jsxs(Nr,{type:"button",variant:"outline",onClick:E,className:"w-full text-xs",children:[l.jsx(J0,{className:"h-4 w-4 mr-2"}),"Add Violation"]})]})}):null,!n||A==="confiscated"?l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx(En,{control:e.control,name:"licenseType",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"License Type"}),l.jsxs(Uo,{onValueChange:K.onChange,value:K.value||void 0,children:[l.jsx(Nn,{children:l.jsx(So,{className:"text-xs",children:l.jsx($o,{placeholder:K.value==="null"?"null":"Select license type"})})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"SP",children:"SP (Student Permit)"}),l.jsx(pn,{value:"DL",children:"DL (Driver's License)"}),l.jsx(pn,{value:"CL",children:"CL (Commercial License)"}),l.jsx(pn,{value:"PLATE",children:"PLATE"}),l.jsx(pn,{value:"SP RECEIPT",children:"SP RECEIPT"}),l.jsx(pn,{value:"DL RECEIPT",children:"DL RECEIPT"}),l.jsx(pn,{value:"REFUSE TO SUR.",children:"REFUSE TO SUR."}),l.jsx(pn,{value:"DL TEMPORARY",children:"DL TEMPORARY"}),l.jsx(pn,{value:"-",children:"-"}),l.jsx(pn,{value:"null",children:"null"})]})]}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx("div",{})]})}):null,l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsx(En,{control:e.control,name:"plateNo",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Plate No."}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"ABC-1234",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"chassisNo",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Chassis No. (Optional)"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Chassis Number",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})}),l.jsx(En,{control:e.control,name:"engineNo",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Engine No. (Optional)"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Engine Number",...K,value:K.value==="null"?"null":K.value||"",className:Ut("text-xs",K.value==="null"&&"text-gray-400 dark:text-gray-500")})}),l.jsx(Cn,{className:"text-xs text-red-400"})]})})]})}),l.jsx("div",{className:"space-y-4",children:l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.jsx(En,{control:e.control,name:"dateOfApprehension",render:({field:K})=>l.jsxs(jn,{className:"space-y-0",children:[l.jsx($n,{className:"text-xs text-gray-600",children:"Date of Apprehension"}),l.jsx(Nn,{children:l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsx(Nn,{children:l.jsxs(Nr,{variant:"outline",className:Ut("w-full pl-3 text-left font-normal text-xs",!K.value&&"text-muted-foreground"),children:[K.value?wc(K.value,"PPP"):l.jsx("span",{children:"Pick a date"}),l.jsx(so,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),l.jsx(sy,{className:"w-auto p-0",align:"start",children:l.jsx(D2,{fieldValue:K.value,dateValue:K.onChange})})]})}),l.jsx(Cn,{})]})})})})]}),l.jsx(hs,{open:f,onOpenChange:i,children:l.jsxs(Xa,{className:"max-w-md",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(Hc,{className:"h-5 w-5 text-orange-500"}),"Remove Violation"]}),l.jsx(bo,{children:"Are you sure you want to remove this violation from this driver? This action cannot be undone."})]}),l.jsxs(jl,{className:"flex justify-end gap-3",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:L,className:"min-w-[80px]",children:"Cancel"}),l.jsx(Nr,{type:"button",onClick:V,className:"min-w-[80px] bg-red-600 hover:bg-red-700 text-white",children:"Remove"})]})]})})]})},zVe=({open:e,onOpenChange:t,onViolationAdded:r})=>{const[n,a]=W.useState(!1),{token:c}=Di(),f=Jl(Date.now()),i=Cl({resolver:tc(OD),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[""],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),x=async A=>{var P,E;a(!0);try{const D={topNo:A.topNo,firstName:A.firstName,middleInitial:A.middleInitial,lastName:A.lastName,suffix:A.suffix,violations:A.violations,violationType:A.violationType,licenseType:A.licenseType,plateNo:A.plateNo,apprehendingOfficer:A.apprehendingOfficer,chassisNo:A.chassisNo,engineNo:A.engineNo};A.dateOfApprehension&&(D.dateOfApprehension=A.dateOfApprehension);const{data:V}=await xn.post("/violations",D,{headers:{Authorization:c}});V.success&&(Mn.success("Violation has been added",{description:f}),i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[""],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(!1),r&&r())}catch(D){console.log(D);const V=((E=(P=D.response)==null?void 0:P.data)==null?void 0:E.message)||"Failed to add violation";Mn.error(V,{description:f})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[""],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(A)};return l.jsx(hs,{open:e,onOpenChange:w,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs(fs,{className:"flex-shrink-0",children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(Hc,{className:"h-5 w-5"}),"Add New Violation"]}),l.jsx(bo,{children:"Fill in the required fields to add a new violation record to the system."})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:l.jsx(d5,{form:i,onSubmit:x,submitting:n,isEditMode:!1})}),l.jsxs(jl,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),l.jsxs(Nr,{type:"submit",form:"violation-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[n&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Violation"]})]})]})})},FVe=({open:e,onOpenChange:t,violationData:r})=>{const[n,a]=W.useState("violation"),[c,f]=W.useState(!1),{token:i}=Di();wa(),W.useEffect(()=>{e&&r&&(a("violation"),console.log("ViolationDetailsModal - violationData:",r),console.log("ViolationDetailsModal - createdAt:",r.createdAt),console.log("ViolationDetailsModal - updatedAt:",r.updatedAt))},[e,r]);const x=V=>V?new Date(V).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not set",w=V=>{let L,$;switch(V){case"confiscated":L="bg-red-100 text-red-800 border-red-200",$=l.jsx(Hc,{className:"h-3 w-3"});break;case"impounded":L="bg-orange-100 text-orange-800 border-orange-200",$=l.jsx(Px,{className:"h-3 w-3"});break;case"alarm":L="bg-yellow-100 text-yellow-800 border-yellow-200",$=l.jsx(Fg,{className:"h-3 w-3"});break;default:L="bg-gray-100 text-gray-800 border-gray-200",$=l.jsx(Fg,{className:"h-3 w-3"})}return l.jsx(us,{variant:"outline",className:`text-xs font-medium ${L}`,children:l.jsxs("div",{className:"flex items-center gap-1",children:[$,(V==null?void 0:V.charAt(0).toUpperCase())+(V==null?void 0:V.slice(1))||"Unknown"]})})},A=V=>V?l.jsx(us,{variant:"outline",className:"text-xs font-medium bg-blue-100 text-blue-800 border-blue-200",children:V}):"N/A",P=()=>l.jsx("div",{className:"space-y-2",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(EA,{className:"h-3 w-3"}),"TOP Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.topNo)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Hc,{className:"h-3 w-3"}),"Violation Type"]}),l.jsx("div",{className:"ml-4",children:w(r==null?void 0:r.violationType)})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Du,{className:"h-3 w-3"}),"Driver Name"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:r!=null&&r.firstName&&(r!=null&&r.lastName)?`${r.firstName} ${r.middleInitial||""} ${r.lastName} ${r.suffix||""}`.trim():"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(cl,{className:"h-3 w-3"}),"Plate Number"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.plateNo)||"N/A"})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(so,{className:"h-3 w-3"}),"Date of Apprehension"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:x(r==null?void 0:r.dateOfApprehension)})]}),l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(Px,{className:"h-3 w-3"}),"Apprehending Officer"]}),l.jsx("p",{className:"text-xs font-semibold text-gray-900 dark:text-gray-100 ml-4",children:(r==null?void 0:r.apprehendingOfficer)||"N/A"})]}),(r==null?void 0:r.licenseType)&&l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-2 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-200 hover:border-blue-300 dark:hover:border-blue-600",children:[l.jsxs("label",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide flex items-center gap-1",children:[l.jsx(vP,{className:"h-3 w-3"}),"License Type"]}),l.jsx("div",{className:"ml-4",children:A(r==null?void 0:r.licenseType)})]})]})}),E=()=>l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Hc,{className:"h-5 w-5 text-red-500"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Driver Violations"})]}),r!=null&&r.violations&&r.violations.length>0?l.jsx("div",{className:"space-y-3",children:r.violations.map((V,L)=>l.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 hover:shadow-md transition-all duration-200",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs font-bold",children:L+1}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:"text-sm font-medium text-red-800 dark:text-red-200 leading-relaxed",children:V})})]})},L))}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Hc,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:"No violations recorded"}),l.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"This driver has no recorded violations"})]})]}),D=[{id:"violation",label:"Violation Details",icon:Ld},{id:"violations",label:"Driver Violations",icon:Hc}];return l.jsx(hs,{open:e,onOpenChange:t,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[80vh] bg-gradient-to-br from-slate-50 to-red-50 dark:from-gray-900 dark:to-gray-800 border-0 shadow-2xl flex flex-col",onPointerDownOutside:V=>V.preventDefault(),onEscapeKeyDown:V=>V.preventDefault(),children:[l.jsx(fs,{className:"pb-3 flex-shrink-0",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx(ps,{className:"text-lg font-bold bg-gradient-to-r from-red-600 to-orange-600 bg-clip-text text-transparent",children:"Violation Details"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive violation information including apprehension details, violations committed, and confiscated items"}),l.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 flex items-center gap-1",children:[l.jsx(EA,{className:"h-3 w-3 text-red-500"}),"TOP Number: ",l.jsx("span",{className:"font-semibold text-red-600",children:(r==null?void 0:r.topNo)||"N/A"})]})]})})}),l.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[l.jsx("div",{className:"flex-shrink-0 mb-3",children:l.jsx("div",{className:"flex space-x-1 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm p-1 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:D.map(V=>{const L=V.icon;return l.jsxs(Nr,{variant:"ghost",onClick:()=>a(V.id),className:`flex-1 flex items-center gap-1 text-xs font-medium transition-all duration-200 ${n===V.id?"bg-gradient-to-r from-red-500 to-orange-500 text-white shadow-lg":"text-gray-600 dark:text-gray-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-gray-700"}`,children:[l.jsx(L,{className:"h-3 w-3"}),l.jsx("span",{className:"hidden sm:inline",children:V.label})]},V.id)})})}),l.jsxs("div",{className:"flex-1 overflow-y-auto bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm p-3 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[n==="violation"&&l.jsx(P,{}),n==="violations"&&l.jsx(E,{})]}),l.jsx("div",{className:"flex-shrink-0 pt-4 border-t border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r!=null&&r.updatedAt?l.jsxs(l.Fragment,{children:["Last updated: ",x(r.updatedAt)]}):r!=null&&r.createdAt?l.jsxs(l.Fragment,{children:["Created: ",x(r.createdAt)]}):l.jsxs(l.Fragment,{children:["Record details • TOP #",(r==null?void 0:r.topNo)||"N/A"]})}),l.jsxs(Nr,{onClick:()=>{t(!1),window.dispatchEvent(new CustomEvent("editViolation",{detail:r==null?void 0:r._id}))},className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 px-6 py-2 text-sm font-semibold",children:[l.jsx(ao,{className:"h-4 w-4 mr-2"}),"Edit Violation"]})]})})]})]})})},BVe=({open:e,onOpenChange:t,violationId:r,onViolationUpdated:n})=>{const[a,c]=W.useState(!1),[f,i]=W.useState({}),[x,w]=W.useState(!1),[A,P]=W.useState(!1),[E,D]=W.useState(!1),[V,L]=W.useState({}),{token:$}=Di(),H=Jl(Date.now()),K=Cl({resolver:tc(OD),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),{reset:Q}=K;W.useEffect(()=>{e&&r&&ae()},[e,r,$]),W.useEffect(()=>{Object.keys(f).length>0&&Q(f)},[f,Q]);const ae=async()=>{w(!0);try{const{data:xe}=await xn.get(`/violations/${r}`,{headers:{Authorization:$}});if(xe!=null&&xe.data){const Ce=xe.data,ze={topNo:Ce.topNo!==null?Ce.topNo:"null",firstName:Ce.firstName!==null?Ce.firstName:"null",middleInitial:Ce.middleInitial!==null?Ce.middleInitial:"null",lastName:Ce.lastName!==null?Ce.lastName:"null",suffix:Ce.suffix!==null?Ce.suffix:"null",violations:Ce.violations&&Ce.violations.length>0?Ce.violations:[""],violationType:Ce.violationType||"confiscated",licenseType:Ce.licenseType!==null?Ce.licenseType:void 0,plateNo:Ce.plateNo!==null?Ce.plateNo:"null",dateOfApprehension:Ce.dateOfApprehension?new Date(Ce.dateOfApprehension):void 0,apprehendingOfficer:Ce.apprehendingOfficer!==null?Ce.apprehendingOfficer:"null",chassisNo:Ce.chassisNo!==null?Ce.chassisNo:"null",engineNo:Ce.engineNo!==null?Ce.engineNo:"null"};i(ze),L(ze)}}catch(xe){console.error("Error fetching violation data:",xe),Mn.error("Failed to load violation data",{description:H})}finally{w(!1)}},ee=xe=>{const Ce={topNo:xe.topNo,firstName:xe.firstName,middleInitial:xe.middleInitial,lastName:xe.lastName,suffix:xe.suffix,violations:xe.violations,violationType:xe.violationType,licenseType:xe.licenseType,plateNo:xe.plateNo,dateOfApprehension:xe.dateOfApprehension,apprehendingOfficer:xe.apprehendingOfficer,chassisNo:xe.chassisNo,engineNo:xe.engineNo};return JSON.stringify(Ce)!==JSON.stringify(V)},se=()=>{const xe=K.getValues();ee(xe)?P(!0):D(!0)},ce=()=>{P(!1),K.handleSubmit(pe)()},he=()=>{P(!1)},Pe=()=>{D(!1)},Ne=()=>{D(!1),t(!1)},pe=async xe=>{var Ce,ze;c(!0);try{const Te={topNo:xe.topNo,violationType:xe.violationType,plateNo:xe.plateNo,dateOfApprehension:xe.dateOfApprehension,apprehendingOfficer:xe.apprehendingOfficer},Re=He=>He==="null"?null:He;xe.violationType==="confiscated"?(Te.firstName=Re(xe.firstName),Te.middleInitial=Re(xe.middleInitial),Te.lastName=Re(xe.lastName),Te.suffix=Re(xe.suffix),Te.violations=xe.violations?xe.violations.filter(He=>He.trim()!==""):[],Te.licenseType=Re(xe.licenseType)):xe.violationType==="impounded"?(Te.firstName=Re(xe.firstName),Te.middleInitial=Re(xe.middleInitial),Te.lastName=Re(xe.lastName),Te.suffix=Re(xe.suffix),Te.violations=xe.violations?xe.violations.filter(He=>He.trim()!==""):[],Te.licenseType=null):xe.violationType==="alarm"&&(Te.firstName=null,Te.middleInitial=null,Te.lastName=null,Te.suffix=null,Te.violations=null,Te.licenseType=null);const{data:Fe}=await xn.patch(`/violations/${r}`,Te,{headers:{Authorization:$}});Fe.success&&(Mn.success("Violation updated successfully",{description:H}),t(!1),n&&n())}catch(Te){const Re=((ze=(Ce=Te==null?void 0:Te.response)==null?void 0:Ce.data)==null?void 0:ze.message)||"Failed to update violation";Mn.error(Re,{description:H})}finally{c(!1)}},je=xe=>{!xe&&!a&&K.reset({topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}),t(xe)};return x?l.jsx(hs,{open:e,onOpenChange:je,children:l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs(fs,{className:"flex-shrink-0",children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"Edit Violation"]}),l.jsx(bo,{children:"Loading violation data..."})]}),l.jsx("div",{className:"flex-1 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})]})}):l.jsxs(hs,{open:e,onOpenChange:je,children:[l.jsxs(Xa,{className:"max-w-2xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs(fs,{className:"flex-shrink-0",children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"Edit Violation"]}),l.jsx(bo,{children:"Update violation details. All data is pre-filled from the existing record."})]}),l.jsx("div",{className:"flex-1 overflow-y-auto px-1 py-2",children:l.jsx(d5,{form:K,onSubmit:pe,submitting:a,isEditMode:!0})}),l.jsxs(jl,{className:"flex-shrink-0 flex justify-start gap-3 pt-4 border-t",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>je(!1),disabled:a,className:"min-w-[100px]",children:"Cancel"}),l.jsxs(Nr,{type:"button",onClick:se,disabled:a,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[a&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),a?"Updating...":"Update Violation"]})]})]}),l.jsx(hs,{open:A,onOpenChange:P,children:l.jsxs(Xa,{className:"max-w-md",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5 text-blue-500"}),"Confirm Update"]}),l.jsx(bo,{children:"Are you sure you want to update this violation? This action will modify the existing record."})]}),l.jsxs(jl,{className:"flex justify-end gap-3",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:he,className:"min-w-[80px]",children:"Cancel"}),l.jsx(Nr,{type:"button",onClick:ce,className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Update"})]})]})}),l.jsx(hs,{open:E,onOpenChange:D,children:l.jsxs(Xa,{className:"max-w-md",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-5 w-5"}),"No Changes Detected"]}),l.jsx(bo,{children:"No changes were made to the violation information. Would you like to continue editing?"})]}),l.jsxs(jl,{className:"flex justify-end gap-3",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:Ne,className:"min-w-[80px]",children:"No"}),l.jsx(Nr,{type:"button",onClick:Pe,className:"min-w-[80px] bg-blue-600 hover:bg-blue-700 text-white",children:"Yes"})]})]})})]})},VVe=()=>{const[e,t]=W.useState([]),{token:r}=Di();wa(),co();const[n,a]=W.useState(!0),[c,f]=W.useState(!1),[i,x]=W.useState(!1),[w,A]=W.useState(!1),[P,E]=W.useState(!1),[D,V]=W.useState(null),[L,$]=W.useState(null);W.useEffect(()=>{H()},[]),W.useEffect(()=>{const ce=he=>{$(he.detail),E(!0)};return window.addEventListener("editViolation",ce),()=>{window.removeEventListener("editViolation",ce)}},[]);const H=async()=>{try{const{data:ce}=await xn.get("/violations",{headers:{Authorization:r}});ce.data&&ce.data.length>0&&(console.log("Sample violation data from API:",ce.data[0]),console.log("Available fields:",Object.keys(ce.data[0])),console.log("CreatedAt:",ce.data[0].createdAt),console.log("UpdatedAt:",ce.data[0].updatedAt));const he=ce.data.map(Pe=>({_id:Pe._id,topNo:Pe.topNo||"N/A",firstName:Pe.firstName||"N/A",middleInitial:Pe.middleInitial||"",lastName:Pe.lastName||"N/A",suffix:Pe.suffix||"",violations:Pe.violations||[],violationType:Pe.violationType||"confiscated",licenseType:Pe.licenseType||null,plateNo:Pe.plateNo||"N/A",dateOfApprehension:Pe.dateOfApprehension,apprehendingOfficer:Pe.apprehendingOfficer||"N/A",createdAt:Pe.createdAt,updatedAt:Pe.updatedAt}));t(he)}catch(ce){console.log(ce)}finally{a(!1)}},K=()=>{x(!0)},Q=ce=>{V(ce),A(!0)},ae=ce=>{$(ce),E(!0)},ee=()=>{H()},se=()=>{H()};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[l.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Violations"}),l.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:l.jsx(LVe,{data:e,filters:["topNo","firstName","lastName","violations","violationType","licenseType","plateNo","dateOfApprehension","apprehendingOfficer"],tableColumn:wBe,onAdd:K,loading:n,onRowClick:Q,onEdit:ae,onUpdateStatus:()=>{},submitting:c})})]}),l.jsx(zVe,{open:i,onOpenChange:x,onViolationAdded:ee}),l.jsx(FVe,{open:w,onOpenChange:A,violationData:D}),l.jsx(BVe,{open:P,onOpenChange:E,violationId:L,onViolationUpdated:se})]})},UVe=({title:e,filters:t,tableColumn:r,data:n,loading:a,onRowClick:c,onAdd:f,onEdit:i,onUpdateStatus:x,submitting:w})=>{var Pe;const[A,P]=Oe.useState([]),[E,D]=Oe.useState([]),[V,L]=Oe.useState({}),[$,H]=Oe.useState({pageIndex:0,pageSize:12}),[K,Q]=Oe.useState(""),[ae,ee]=Oe.useState(0),se=t,ce=Oe.useRef(null);Oe.useEffect(()=>{let Ne;const pe=()=>{if(ce.current){const xe=ce.current.offsetHeight,Ce=180,ze=80,Te=60,Re=52,Fe=xe-Ce-ze-Te,He=Math.max(8,Math.floor(Fe/Re)),mt=Math.min(He,25);mt!==$.pageSize&&H(Xe=>({...Xe,pageSize:mt}))}},je=()=>{clearTimeout(Ne),Ne=setTimeout(pe,100)};return setTimeout(pe,100),window.addEventListener("resize",je),()=>{window.removeEventListener("resize",je),clearTimeout(Ne)}},[$.pageSize]);const he=E2({data:n,columns:r(i,x,w),onSortingChange:P,onColumnFiltersChange:D,onPaginationChange:H,getCoreRowModel:N2(),getPaginationRowModel:C2(),getSortedRowModel:k2(),getFilteredRowModel:j2(),onColumnVisibilityChange:L,onGlobalFilterChange:Q,globalFilterFn:(Ne,pe,je)=>se.some(xe=>{const Ce=Ne.getValue(xe);return String(Ce).toLowerCase().includes(je.toLowerCase())}),state:{pagination:$,sorting:A,columnFilters:E,columnVisibility:V,globalFilter:K}});return l.jsxs("div",{ref:ce,className:"h-full flex flex-col min-h-0",children:[l.jsx(ls,{className:"font-semibold flex-shrink-0",children:e}),l.jsxs("div",{className:"md:flex items-center justify-between py-3 flex-shrink-0",children:[l.jsxs("div",{className:"relative hidden md:inline md:max-w-sm flex-shrink",children:[l.jsx(v_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),l.jsx(kn,{placeholder:"Search Accident...",value:K??"",onChange:Ne=>Q(Ne.target.value),className:"pl-10 pr-10 bg-white text-black border-gray-300 dark:bg-black dark:text-white dark:border-gray-600"}),K&&l.jsx("button",{onClick:()=>Q(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:l.jsx(Qf,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"flex gap-2 justify-end md:justify-normal md:items-center",children:[l.jsxs(Nr,{onClick:f,className:"w-min flex items-center gap-2 bg-white text-black border border-gray-300 hover:bg-gray-100 dark:bg-black dark:text-white dark:border-gray-600 dark:hover:bg-gray-800",children:[l.jsx(J0,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden lg:inline",children:"Add Accident"})]}),l.jsx(O2,{table:he})]})]}),l.jsx("div",{className:"border flex-1 overflow-hidden shadow-sm bg-white dark:bg-transparent border-gray-300 dark:border-gray-600 min-h-0 flex flex-col",children:l.jsx("div",{className:"overflow-auto flex-1",children:l.jsx("div",{className:"px-0",children:l.jsxs(km,{children:[l.jsx(Em,{className:"sticky top-0 z-10 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 border-b-2 border-gray-300 dark:border-gray-600",children:he.getHeaderGroups().map(Ne=>l.jsx(Ns,{className:"hover:bg-gray-100/50 dark:hover:bg-gray-700/50",children:Ne.headers.map(pe=>l.jsx(Ts,{className:"text-xs font-semibold text-gray-800 dark:text-gray-200 px-2 py-4 whitespace-nowrap text-left",children:cp(pe.column.columnDef.header,pe.getContext())},pe.id))},Ne.id))}),l.jsx(Mm,{className:"text-xs bg-white dark:bg-transparent",children:a?l.jsx(M2,{rowCount:$.pageSize,cellCount:he.getAllColumns().length}):(Pe=he.getRowModel().rows)!=null&&Pe.length?l.jsxs(l.Fragment,{children:[he.getRowModel().rows.map(Ne=>l.jsx(Ns,{onClick:()=>c(Ne.original),"data-state":Ne.getIsSelected()&&"selected",className:"hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors duration-150 border-b border-gray-100 dark:border-gray-700 cursor-pointer",children:Ne.getVisibleCells().map(pe=>l.jsx(ha,{className:"px-3 py-3 text-gray-800 dark:text-gray-200 text-left",children:cp(pe.column.columnDef.cell,pe.getContext())},pe.id))},Ne.id)),Array.from({length:Math.max(0,$.pageSize-he.getRowModel().rows.length)}).map((Ne,pe)=>l.jsx(Ns,{className:"hover:bg-transparent",children:he.getVisibleLeafColumns().map(je=>l.jsx(ha,{className:"px-3 py-3 h-12 border-b border-gray-100 dark:border-gray-700",children:" "},`empty-${pe}-${je.id}`))},`empty-${pe}`))]}):l.jsx(Ns,{className:"hover:bg-transparent",children:l.jsx(ha,{colSpan:he.getVisibleLeafColumns().length||5,className:"h-32 text-center text-muted-foreground",children:l.jsxs("div",{className:"flex flex-col items-center justify-center",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"No results found"}),l.jsx("p",{className:"text-xs text-gray-400",children:"Try adjusting your filters or add new data."})]})})})})]})})})}),l.jsx("div",{className:"mt-3 flex-shrink-0",children:l.jsx(R2,{table:he})})]})},Tie=W.forwardRef(({className:e,...t},r)=>l.jsx("textarea",{className:Ut("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));Tie.displayName="Textarea";const Pie=({form:e,onSubmit:t,submitting:r})=>(wa(),l.jsx(ip,{...e,children:l.jsxs("form",{id:"accident-form",onSubmit:e.handleSubmit(t),className:"space-y-4",children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.jsx(En,{control:e.control,name:"accident_id",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Accident ID"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"ACC-0001",...n})}),l.jsx(Cn,{})]})})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx(En,{control:e.control,name:"plateNo",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Plate No."}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter vehicle plate number",...n})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:e.control,name:"accident_date",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Accident Date"}),l.jsx(Nn,{children:l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsx(Nn,{children:l.jsxs(Nr,{variant:"outline",className:Ut("w-full text-left font-normal justify-start",!n.value&&"text-muted-foreground"),children:[l.jsx(so,{className:"h-4 w-4 opacity-50"}),n.value?wc(n.value,"PPP"):l.jsx("span",{children:"Pick a date"})]})})}),l.jsx(sy,{className:"w-auto p-2 space-y-2",align:"start",children:l.jsx(D2,{fieldValue:n.value,dateValue:a=>e.setValue("accident_date",a,{shouldValidate:!0})})})]})}),l.jsx(Cn,{})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsx(En,{control:e.control,name:"street",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Street"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Street",...n})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:e.control,name:"barangay",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Barangay"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Barangay",...n})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:e.control,name:"municipality",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Municipality"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Municipality",...n})}),l.jsx(Cn,{})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx(En,{control:e.control,name:"vehicle_type",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Vehicle Type"}),l.jsxs(Uo,{onValueChange:n.onChange,defaultValue:n.value,children:[l.jsx(Nn,{children:l.jsx(So,{children:l.jsx($o,{placeholder:"Select vehicle type"})})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"motorcycle",children:"Motorcycle"}),l.jsx(pn,{value:"car",children:"Car"}),l.jsx(pn,{value:"truck",children:"Truck"}),l.jsx(pn,{value:"bus",children:"Bus"}),l.jsx(pn,{value:"van",children:"Van"}),l.jsx(pn,{value:"jeepney",children:"Jeepney"}),l.jsx(pn,{value:"tricycle",children:"Tricycle"}),l.jsx(pn,{value:"other",children:"Other"})]})]}),l.jsx(Cn,{})]})}),l.jsx(En,{control:e.control,name:"severity",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Severity"}),l.jsxs(Uo,{onValueChange:n.onChange,defaultValue:n.value,children:[l.jsx(Nn,{children:l.jsx(So,{children:l.jsx($o,{placeholder:"Select severity"})})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"minor",children:"Minor"}),l.jsx(pn,{value:"moderate",children:"Moderate"}),l.jsx(pn,{value:"severe",children:"Severe"}),l.jsx(pn,{value:"fatal",children:"Fatal"})]})]}),l.jsx(Cn,{})]})})]}),l.jsx(En,{control:e.control,name:"notes",render:({field:n})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Notes"}),l.jsx(Nn,{children:l.jsx(Tie,{placeholder:"Enter additional notes about the accident...",className:"resize-none",rows:3,...n})}),l.jsx(Cn,{})]})})]})})),$Ve=({open:e,onOpenChange:t,onAccidentAdded:r})=>{const[n,a]=W.useState(!1),{token:c}=Di(),f=Jl(Date.now()),i=Cl({resolver:tc(MZ),defaultValues:{accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}}),x=async A=>{var P,E;a(!0);try{const D={accident_id:A.accident_id,plateNo:A.plateNo,accident_date:A.accident_date?A.accident_date.toISOString():null,street:A.street,barangay:A.barangay,municipality:A.municipality,vehicle_type:A.vehicle_type,severity:A.severity,notes:A.notes};console.log("Sending accident data:",D);const{data:V}=await xn.post("/accident",D,{headers:{Authorization:c}});V.success&&(Mn.success("Accident has been added",{description:f}),i.reset({accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}),t(!1),r&&r())}catch(D){const V=((E=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:E.message)||"Failed to add accident";Mn.error(V,{description:f})}finally{a(!1)}},w=A=>{!A&&!n&&i.reset({accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}),t(A)};return l.jsx(hs,{open:e,onOpenChange:w,children:l.jsxs(Xa,{className:"max-w-4xl max-h-[90vh] overflow-y-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar-thumb]:bg-gray-300 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb:hover]:bg-gray-400 dark:[&::-webkit-scrollbar-thumb]:bg-gray-600 dark:[&::-webkit-scrollbar-thumb:hover]:bg-gray-500 [&::-webkit-scrollbar]:bg-transparent",children:[l.jsxs(fs,{children:[l.jsxs(ps,{className:"flex items-center gap-2",children:[l.jsx(Hc,{className:"h-5 w-5"}),"Add New Accident"]}),l.jsx(bo,{children:"Fill in the required fields to add a new accident record to the system."})]}),l.jsx("div",{className:"space-y-6",children:l.jsx(Pie,{form:i,onSubmit:x,submitting:n})}),l.jsxs(jl,{className:"flex justify-start gap-3 pt-6",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>w(!1),disabled:n,className:"min-w-[100px]",children:"Cancel"}),l.jsxs(Nr,{type:"submit",form:"accident-form",disabled:n,className:"flex items-center gap-2 min-w-[120px] bg-blue-600 hover:bg-blue-700 text-white",children:[n&&l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),n?"Adding...":"Add Accident"]})]})]})})},qVe=()=>{const[e,t]=W.useState([]),{token:r}=Di(),n=wa();co();const[a,c]=W.useState(!0),[f,i]=W.useState(!1),[x,w]=W.useState(!1);W.useEffect(()=>{A()},[]);const A=async()=>{try{const{data:L}=await xn.get("/accident",{headers:{Authorization:r}}),$=L.data.map(H=>({_id:H._id,accident_id:H.accident_id,plateNo:H.plateNo||"N/A",accident_date:iy(H.accident_date),street:H.street,barangay:H.barangay,municipality:H.municipality,vehicle_type:H.vehicle_type||"N/A",severity:H.severity||"N/A",notes:H.notes||""}));t($)}catch(L){console.log(L)}finally{c(!1)}},P=()=>{w(!0)},E=L=>{const $=L._id;n(`/accident/${$}`)},D=L=>{n(`/accident/${L}/edit`)},V=()=>{A()};return l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"bg-white dark:bg-transparent rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 flex-1 flex flex-col min-h-0",children:[l.jsx("header",{className:"text-xl md:text-3xl font-bold mb-4 flex-shrink-0",children:"Accidents"}),l.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:l.jsx(UVe,{data:e,filters:["accident_id","plateNo","accident_date","street","barangay","municipality","vehicle_type","severity"],tableColumn:xBe,onAdd:P,loading:a,onRowClick:E,onEdit:D,onUpdateStatus:()=>{},submitting:f})})]}),l.jsx($Ve,{open:x,onOpenChange:w,onAccidentAdded:V})]})},GVe=()=>{const e=oy(),[t,r]=W.useState(!0),{token:n}=Di(),[a,c]=W.useState(),f=co(),i=wa(),x=async()=>{try{const{data:w}=await xn.get(`/accident/${e.id}`,{headers:{Authorization:n}});w&&c(w.data)}catch{}r(!1)};return W.useEffect(()=>{x()},[]),t?l.jsx("div",{children:"Loading..."}):l.jsxs(Ci,{className:"lg:col-span-2 row-span-2 border md:shadow-none",children:[l.jsxs(zi,{className:"border-b",children:[l.jsxs(Fi,{className:"text-3xl font-bold",children:["Accident #",(a==null?void 0:a.accident_id)||"Details"]}),l.jsx(As,{children:(a==null?void 0:a.description)||"No description available."})]}),l.jsx(Ii,{className:"p-0 pb-6",children:l.jsxs("div",{className:"grid grid-cols-2 text-sm gap-4 mb-2",children:[l.jsx("h1",{className:"font-bold col-span-2 border-b px-6 py-1",children:"Accident Information"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Date:"}),l.jsx("p",{className:"font-semibold w-full",children:iy(a==null?void 0:a.accident_date)}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Location:"}),l.jsx("p",{className:"font-semibold w-full",children:`${(a==null?void 0:a.street)||""}, ${(a==null?void 0:a.barangay)||""}, ${(a==null?void 0:a.municipality)||""}`}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Plate No:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.plateNo)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Vehicle Type:"}),l.jsx("p",{className:"font-semibold w-full",children:(a==null?void 0:a.vehicle_type)||"N/A"}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Severity:"}),l.jsx("p",{className:"font-semibold w-full",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(a==null?void 0:a.severity)==="minor"?"text-green-600 bg-green-100":(a==null?void 0:a.severity)==="moderate"?"text-yellow-600 bg-yellow-100":(a==null?void 0:a.severity)==="severe"?"text-orange-600 bg-orange-100":(a==null?void 0:a.severity)==="fatal"?"text-red-600 bg-red-100":"text-gray-600 bg-gray-100"}`,children:(a==null?void 0:a.severity)||"N/A"})}),(a==null?void 0:a.notes)&&l.jsxs(l.Fragment,{children:[l.jsx("h2",{className:"text-muted-foreground px-6",children:"Notes:"}),l.jsx("p",{className:"font-semibold w-full col-span-2",children:a.notes})]}),l.jsx("h2",{className:"text-muted-foreground px-6",children:"Last Edited:"}),l.jsx("p",{className:"font-semibold w-full",children:iy(a==null?void 0:a.time_edited)})]})}),l.jsx(j4,{className:"gap-2 text-sm ",children:l.jsxs(Nr,{onClick:()=>i(`${f.pathname}/edit`),size:"sm",className:"font-semibold",variant:"outline",children:[l.jsx(ao,{}),"Edit"]})})]})},WVe=()=>{const e=wa();return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"px-4 pt-4 md:px-0 md:pt-0 md:mb-4",children:l.jsxs(Nr,{variant:"outline",className:"shadow-none",onClick:()=>e(-1),children:[l.jsx(gP,{})," Back"]})}),l.jsx("div",{className:"p-4 md:p-0",children:l.jsx(GVe,{})})]})},HVe=()=>{const[e,t]=W.useState(!1),{token:r}=Di(),n=oy(),a=Jl(Date.now()),c=wa(),f=Cl({resolver:tc(MZ),defaultValues:{accident_id:"",plateNo:"",accident_date:void 0,street:"",barangay:"",municipality:"",vehicle_type:"",severity:"",notes:""}}),{reset:i}=f;W.useEffect(()=>{x()},[n.id,r]);const x=async()=>{const A=n.id;try{const{data:P}=await xn.get(`/accident/${A}`,{headers:{Authorization:r}});if(P!=null&&P.data){const E=P.data;i({accident_id:E.accident_id,plateNo:E.plateNo||"",accident_date:new Date(E.accident_date),street:E.street,barangay:E.barangay,municipality:E.municipality,vehicle_type:E.vehicle_type||"",severity:E.severity||"",notes:E.notes||""})}}catch(P){console.log(P)}},w=async A=>{var P,E;t(!0);try{const D={accident_id:A.accident_id,plateNo:A.plateNo,accident_date:A.accident_date?A.accident_date.toISOString():null,street:A.street,barangay:A.barangay,municipality:A.municipality,vehicle_type:A.vehicle_type,severity:A.severity,notes:A.notes},{data:V}=await xn.patch(`/accident/${n.id}`,D,{headers:{Authorization:r}});V.success&&(Mn.success("Accident updated",{description:a}),c(-1))}catch(D){const V=((E=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:E.message)||"Failed to update accident";Mn.error(V,{description:`${a}`})}finally{t(!1)}};return l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsx(Fi,{className:"text-xl md:text-3xl font-bold",children:"Edit Accident"}),l.jsx(As,{children:"Update accident details."})]}),l.jsx(Ii,{children:l.jsx(Pie,{form:f,onSubmit:w,submitting:e})})]})},KVe=()=>{const[e,t]=W.useState(!1),{token:r}=Di(),n=oy(),a=Jl(Date.now()),c=wa(),f=Cl({resolver:tc(OD),defaultValues:{topNo:"",firstName:"",middleInitial:"",lastName:"",suffix:"",violations:[],violationType:"confiscated",licenseType:void 0,plateNo:"",dateOfApprehension:void 0,apprehendingOfficer:"",chassisNo:"",engineNo:""}}),{reset:i}=f;W.useEffect(()=>{x()},[n.id,r]);const x=async()=>{const A=n.id;try{const{data:P}=await xn.get(`/violations/${A}`,{headers:{Authorization:r}});if(P!=null&&P.data){const E=P.data,D=E.violationType||"confiscated";i({topNo:E.topNo||"",firstName:E.firstName||"",middleInitial:E.middleInitial||"",lastName:E.lastName||"",suffix:E.suffix||"",violations:E.violations||[""],violationType:D,licenseType:E.licenseType||void 0,plateNo:E.plateNo||"",dateOfApprehension:E.dateOfApprehension?new Date(E.dateOfApprehension):void 0,apprehendingOfficer:E.apprehendingOfficer||""})}}catch(P){console.log(P)}},w=async A=>{var P,E;t(!0);try{const D={topNo:A.topNo,violationType:A.violationType,plateNo:A.plateNo,dateOfApprehension:A.dateOfApprehension,apprehendingOfficer:A.apprehendingOfficer};A.violationType==="confiscated"?(D.firstName=A.firstName,D.middleInitial=A.middleInitial,D.lastName=A.lastName,D.suffix=A.suffix,D.violations=A.violations?A.violations.filter(L=>L.trim()!==""):[],D.licenseType=A.licenseType):A.violationType==="impounded"?(D.firstName=A.firstName,D.middleInitial=A.middleInitial,D.lastName=A.lastName,D.suffix=A.suffix,D.violations=A.violations?A.violations.filter(L=>L.trim()!==""):[],D.licenseType=null):A.violationType==="alarm"&&(D.firstName=null,D.middleInitial=null,D.lastName=null,D.suffix=null,D.violations=null,D.licenseType=null);const{data:V}=await xn.patch(`/violations/${n.id}`,D,{headers:{Authorization:r}});V.success&&(Mn.success("Violation updated",{description:a}),c(-1))}catch(D){const V=((E=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:E.message)||"Failed to update violation";Mn.error(V,{description:`${a}`})}finally{t(!1)}};return l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsx(Fi,{className:"text-xl md:text-3xl font-bold",children:"Edit Violation"}),l.jsx(As,{children:"Update violation details."})]}),l.jsx(Ii,{children:l.jsx(d5,{form:f,onSubmit:w,submitting:e})})]})},ZVe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await xn.get("/dashboard/registration-analytics",{params:r})).data}catch(r){throw console.error("Error fetching registration analytics:",r),r}},IN=e=>["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(e)+1,YVe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await xn.get("/dashboard/municipality-registration-totals",{params:r})).data}catch(r){throw console.error("Error fetching municipality registration totals:",r),r}},XVe=async(e,t=null,r=null)=>{try{const n={municipality:e};return t&&(n.month=t),r&&(n.year=r),(await xn.get("/dashboard/barangay-registration-totals",{params:n})).data}catch(n){throw console.error("Error fetching barangay registration totals:",n),n}},JVe=async(e=null,t=null,r=null)=>{try{const n={};return e&&(n.startYear=e),t&&(n.endYear=t),r&&(n.municipality=r),(await xn.get("/dashboard/yearly-vehicle-trends",{params:n})).data}catch(n){throw console.error("Error fetching yearly vehicle trends:",n),n}},QVe=async(e,t=null)=>{try{const r={year:e};return t&&(r.municipality=t),(await xn.get("/dashboard/monthly-vehicle-trends",{params:r})).data}catch(r){throw console.error("Error fetching monthly vehicle trends:",r),r}},eUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await xn.get("/dashboard/owner-municipality-data",{params:r})).data}catch(r){throw console.error("Error fetching owner municipality data:",r),r}},tUe=async(e=null,t=null)=>{try{const r={};return e&&(r.month=e),t&&(r.year=t),(await xn.get("/dashboard/vehicle-classification-data",{params:r})).data}catch(r){throw console.error("Error fetching vehicle classification data:",r),r}},rUe=({isOpen:e,onClose:t,municipality:r,selectedMonth:n,selectedYear:a,municipalitiesList:c=[]})=>{var Ce,ze;const[f,i]=W.useState([]),[x,w]=W.useState(!1),[A,P]=W.useState(null),[E,D]=W.useState("desc"),[V,L]=W.useState(!1),[$,H]=W.useState(!1),[K,Q]=W.useState(0),[ae,ee]=W.useState("right"),[se,ce]=W.useState(!1);W.useEffect(()=>{if(e&&r&&c.length>0){const Te=c.findIndex(Re=>Re.municipality===r);Q(Te>=0?Te:0)}},[e,r,c]),W.useEffect(()=>{e&&r&&he()},[e,r,n,a]),W.useEffect(()=>{H(!!e)},[e]);const he=async(Te=r)=>{try{w(!0),P(null);let Re=null,Fe=null;n&&n!=="All"&&(Re=["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(n)+1),a&&a!=="All"&&(Fe=a),console.log("Fetching barangay data for",Te,"with:",{monthNumber:Re,yearValue:Fe,selectedMonth:n,selectedYear:a});const He=await XVe(Te,Re,Fe);i(He.data||[])}catch(Re){console.error("Error fetching barangay data:",Re),P("Error loading barangay data")}finally{w(!1)}},Pe=()=>{K>0&&(ee("left"),ce(!0),setTimeout(()=>{const Te=K-1;Q(Te);const Re=c[Te].municipality;he(Re),setTimeout(()=>ce(!1),100)},200))},Ne=()=>{K<c.length-1&&(ee("right"),ce(!0),setTimeout(()=>{const Te=K+1;Q(Te);const Re=c[Te].municipality;he(Re),setTimeout(()=>ce(!1),100)},200))},pe=Te=>Te.toLocaleString(),je=()=>{L(!0),D(Te=>Te==="desc"?"asc":"desc"),setTimeout(()=>L(!1),300)},xe=[...f].sort((Te,Re)=>E==="desc"?Re.vehicles-Te.vehicles:Te.vehicles-Re.vehicles);return e?l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4",children:l.jsxs("div",{className:`bg-gray-100 border border-gray-200/50 rounded-2xl p-4 sm:p-6 w-full max-w-4xl h-[90vh] sm:h-[85vh] overflow-hidden dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] dark:!border-[#2A2A3E]/50 dark:!shadow-2xl flex flex-col transition-all duration-500 ease-out transform ${$?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-4"}`,children:[l.jsxs("div",{className:"bg-gray-100 dark:!bg-gradient-to-br dark:!from-[#1a1a2e] dark:!via-[#16213e] dark:!to-[#0f3460] border-b border-gray-200/50 dark:border-gray-700/30 pb-4 mb-4 flex-shrink-0",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 gap-4",children:[l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[l.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl shadow-lg",children:l.jsxs("svg",{className:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M3 3v18h18"}),l.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),l.jsx("path",{d:"M16 5l3 3-3 3"})]})}),l.jsxs("div",{className:"flex items-center gap-3",children:[c.length>1&&l.jsx(l.Fragment,{children:l.jsx("button",{onClick:Pe,disabled:K===0,className:`p-2 rounded-xl transition-all duration-300 transform ${K===0?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Previous Municipality",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("h2",{className:`text-xl sm:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent dark:from-blue-400 dark:to-purple-400 transition-all duration-500 ease-in-out ${se?ae==="left"?"opacity-0 transform translate-x-4 scale-95":"opacity-0 transform -translate-x-4 scale-95":"opacity-100 transform translate-x-0 scale-100"}`,children:((Ce=c[K])==null?void 0:Ce.municipality)||r}),l.jsxs("p",{className:`text-sm text-muted-foreground mt-1 transition-all duration-500 ease-in-out ${se?"opacity-0 transform translate-y-2":"opacity-100 transform translate-y-0"}`,children:["Barangay Registration Data",a==="All"&&n&&n!=="All"&&l.jsxs("span",{className:"ml-2 text-xs",children:["(",n," across all years)"]})]})]}),c.length>1&&l.jsx("button",{onClick:Ne,disabled:K===c.length-1,className:`p-2 rounded-xl transition-all duration-300 transform ${K===c.length-1?"text-gray-400 cursor-not-allowed scale-95":"text-gray-600 hover:text-blue-600 hover:bg-blue-50 hover:scale-110 active:scale-95 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/20 shadow-sm hover:shadow-md"}`,title:"Next Municipality",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),l.jsx("button",{onClick:t,className:"p-3 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-xl transition-all duration-200 hover:scale-105",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-3 border border-blue-200/50 dark:border-blue-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-md flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),l.jsx("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300",children:"Total Barangays"})]}),l.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:f.length})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-3 border border-green-200/50 dark:border-green-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-md flex items-center justify-center",children:l.jsxs("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l2.414 2.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0M15 17a2 2 0 104 0"})]})}),l.jsx("div",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Total Vehicles"})]}),l.jsx("div",{className:"text-xl font-bold text-green-900 dark:text-green-100",children:pe(f.reduce((Te,Re)=>Te+Re.vehicles,0))})]}),l.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded-xl p-3 border border-orange-200/50 dark:border-orange-700/30 shadow-md hover:shadow-lg transition-all duration-300",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded-md flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("div",{className:"text-xs font-medium text-orange-700 dark:text-orange-300",children:"Zero Registrations"})]}),l.jsx("div",{className:"text-xl font-bold text-orange-900 dark:text-orange-100",children:f.filter(Te=>Te.vehicles===0).length})]})]})]}),l.jsx("div",{className:"overflow-y-auto flex-1 scrollbar-hide overflow-x-hidden min-h-0",children:l.jsx("div",{className:`transition-all duration-500 ease-in-out ${se?ae==="left"?"opacity-0 transform translate-x-6 scale-98":"opacity-0 transform -translate-x-6 scale-98":"opacity-100 transform translate-x-0 scale-100"}`,children:x?l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):A?l.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-red-500",children:l.jsx("p",{children:A})}):f.length===0?l.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-muted-foreground",children:l.jsxs("p",{children:["No barangay data available for ",((ze=c[K])==null?void 0:ze.municipality)||r]})}):l.jsx("div",{children:l.jsx("div",{className:"bg-gray-100 dark:bg-gray-800/50 rounded-2xl border border-gray-200/50 dark:border-gray-700/30 overflow-hidden min-h-[400px] overflow-x-auto",children:l.jsxs("table",{className:"w-full min-w-[600px]",children:[l.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider",children:"Barangay Name"}),l.jsx("th",{className:"px-3 sm:px-6 py-4 text-left text-xs sm:text-sm font-semibold text-gray-700 dark:text-gray-200 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 select-none",onClick:je,children:l.jsxs("div",{className:"flex items-center gap-2",children:["Total Registered Vehicles",l.jsxs("div",{className:"flex flex-col",children:[l.jsx("svg",{className:`w-3 h-3 ${E==="desc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),l.jsx("svg",{className:`w-3 h-3 ${E==="asc"?"text-blue-500 dark:text-blue-400":"text-gray-400 dark:text-gray-500"}`,fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})]})}),l.jsx("tbody",{className:"bg-white dark:bg-gray-800/30 divide-y divide-gray-200/50 dark:divide-gray-700/30",children:xe.map((Te,Re)=>{const Fe=Te.vehicles===0;return l.jsxs("tr",{className:`hover:bg-gray-50/80 dark:hover:bg-gray-700/50 transition-all duration-200 ${Fe?"bg-gradient-to-r from-red-50/80 to-red-100/50 dark:from-red-900/20 dark:to-red-800/10 border-l-4 border-red-500":""}`,style:{animation:`smoothFadeIn 0.6s ease-out ${Re*.03}s both`},children:[l.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center mr-4 shadow-sm ${Fe?"bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900/40 dark:to-red-800/40":"bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900/40 dark:to-blue-800/40"}`,children:l.jsx("span",{className:`text-sm font-bold ${Fe?"text-red-700 dark:text-red-300":"text-blue-700 dark:text-blue-300"}`,children:Re+1})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`text-base font-semibold ${Fe?"text-red-800 dark:text-red-200":"text-gray-800 dark:text-gray-200"}`,children:Te.barangay}),Fe&&l.jsx("span",{className:"px-3 py-1 text-xs font-semibold bg-gradient-to-r from-red-100 to-red-200 text-red-800 dark:from-red-900/40 dark:to-red-800/40 dark:text-red-200 rounded-full shadow-sm",children:"No Registrations"})]})]})}),l.jsx("td",{className:"px-3 sm:px-6 py-3 sm:py-5 whitespace-nowrap",children:l.jsx("div",{className:`text-lg font-bold ${Fe?"text-red-600 dark:text-red-400":"text-gray-800 dark:text-gray-200"}`,children:pe(Te.vehicles)})})]},Te.barangay)})})]})})})})})]})}):null},nUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=W.useState([]),[c,f]=W.useState(!1),[i,x]=W.useState(null),[w,A]=W.useState(!1),[P,E]=W.useState("desc"),[D,V]=W.useState(!1),[L,$]=W.useState(!1),[H,K]=W.useState(null),[Q,ae]=W.useState(!1);W.useEffect(()=>{const xe=()=>{ae(window.innerWidth<640)};return xe(),window.addEventListener("resize",xe),()=>window.removeEventListener("resize",xe)},[]);const ee=async()=>{try{f(!0),x(null);let xe=null,Ce=null;e&&e!=="All"&&(xe=IN(e)),t&&t!=="All"&&(Ce=t);const ze=await YVe(xe,Ce);ze.success?a(ze.data):(x("Failed to fetch municipality data"),a([]))}catch(xe){console.error("Error fetching municipality data:",xe),x("Error loading municipality data")}finally{f(!1)}};W.useEffect(()=>{ee(),V(!1)},[]),W.useEffect(()=>{ee(),V(!1)},[e,t]);const se=[...n].sort((xe,Ce)=>P==="asc"?xe.vehicles-Ce.vehicles:Ce.vehicles-xe.vehicles),ce=se.slice(0,5);W.useEffect(()=>{if(n.length>0){const xe=setTimeout(()=>V(!0),100);return()=>clearTimeout(xe)}},[n]);const he=xe=>xe.map((Ce,ze)=>({name:Ce.municipality,vehicles:Ce.vehicles,index:ze,totalCount:xe.length})),Pe=(xe,Ce)=>{if(P==="asc"){if(xe<5)return xe===0?"#dc2626":xe===1?"#ea580c":xe===2?"#d97706":xe===3?"#ca8a04":"#eab308";if(xe>=5&&xe<Ce-5)return"#84cc16";if(xe>=Ce-5)return xe===Ce-1?"#1d4ed8":xe===Ce-2?"#2563eb":xe===Ce-3?"#3b82f6":xe===Ce-4?"#60a5fa":"#93c5fd"}else{if(xe<5)return xe===0?"#1d4ed8":xe===1?"#2563eb":xe===2?"#3b82f6":xe===3?"#60a5fa":"#93c5fd";if(xe>=5&&xe<Ce-5)return"#84cc16";if(xe>=Ce-5)return xe===Ce-1?"#dc2626":xe===Ce-2?"#ea580c":xe===Ce-3?"#d97706":xe===Ce-4?"#ca8a04":"#eab308"}return"#3b82f6"},Ne=({active:xe,payload:Ce,label:ze})=>{if(xe&&Ce&&Ce.length){const Te=Ce[0].value,Re=se.length>0?(Te/Math.max(...se.map(Fe=>Fe.vehicles))*100).toFixed(1):0;return l.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-gradient-to-r from-blue-500 to-purple-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:ze}),l.jsxs("p",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[l.jsx("span",{className:"font-semibold text-lg",children:Te.toLocaleString()})," vehicles"]}),l.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:[Re,"% of highest"]})]})]})})}return null},pe=xe=>{K(xe),$(!0)},je=()=>{$(!1),K(null)};return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsxs("svg",{className:"w-6 h-6 text-orange-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),l.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["DavOr Vehicle Registration Rankings",t==="All"&&e&&e!=="All"&&l.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&l.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Top performing municipalities by vehicle registration volume"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>E(P==="asc"?"desc":"asc"),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors flex items-center gap-1",title:`Sort ${P==="asc"?"Highest to Lowest":"Lowest to Highest"}`,children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:P==="asc"?l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"}):l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})}),P==="asc"?"↑":"↓"]}),l.jsx("button",{onClick:()=>A(!0),className:"px-3 py-1.5 text-sm font-medium text-primary bg-primary/10 hover:bg-primary/20 rounded-md transition-colors",children:"View All"})]})]}),l.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[c||r?l.jsx("div",{className:"flex items-center justify-center w-full h-full",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:l.jsx("p",{children:i})}):ce.length===0?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:l.jsx("p",{children:"No data available"})}):l.jsx(_o,{width:"100%",height:"100%",minHeight:320,children:l.jsxs(Cu,{data:he(ce),margin:{top:10,right:10,left:5,bottom:20},barCategoryGap:"10%",children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),l.jsx(Oa,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:20,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:xe=>xe.length>12?xe.substring(0,12)+"...":xe}),l.jsx(Ra,{stroke:"#6b7280",fontSize:9,tickFormatter:xe=>xe.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:50}),l.jsx(ta,{content:l.jsx(Ne,{})}),l.jsx(ds,{dataKey:"vehicles",radius:[8,8,0,0],onClick:xe=>pe(xe.name),style:{cursor:"pointer"},maxBarSize:120,children:he(ce).map((xe,Ce)=>{const ze=Pe(xe.index,xe.totalCount);return l.jsx(Kh,{fill:ze,stroke:ze,strokeWidth:2,style:{filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.15))",transition:"all 0.3s ease"}},`cell-${Ce}`)})})]})}),ce.length>0&&l.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:Q?"10px":"12px",fontWeight:"500",paddingTop:"0px",paddingBottom:"0px",textAlign:"center"},children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-700"}),l.jsx("span",{children:"High"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),l.jsx("span",{children:"Medium-high"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),l.jsx("span",{children:"Medium"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),l.jsx("span",{children:"Low"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),l.jsx("span",{children:"Lowest"})]})]})]})]}),w&&l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 border border-gray-200 rounded-xl p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden shadow-2xl dark:!bg-transparent dark:!border-[#2A2A3E] dark:!shadow-none dark:!from-transparent dark:!to-transparent",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsxs("svg",{className:"w-6 h-6 text-foreground",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M3 3v18h18"}),l.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),l.jsx("path",{d:"M16 5l3 3-3 3"})]})}),l.jsxs("h2",{className:"text-2xl font-bold text-foreground",children:["All Municipalities",t==="All"&&e&&e!=="All"&&l.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&l.jsxs("span",{className:"text-lg font-normal text-muted-foreground ml-2",children:["(All months in ",t,")"]})]})]}),l.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-muted rounded-md transition-colors",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsx("div",{className:"h-[500px]",children:l.jsx(_o,{width:"100%",height:"100%",minHeight:320,children:l.jsxs(Cu,{data:he(se),margin:{top:20,right:10,left:10,bottom:60},barCategoryGap:"5%",children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),l.jsx(Oa,{dataKey:"name",stroke:"#6b7280",fontSize:9,height:5,interval:0,tick:{fill:"#6b7280",fontWeight:500},tickFormatter:xe=>xe.length>12?xe.substring(0,12)+"...":xe}),l.jsx(Ra,{stroke:"#6b7280",fontSize:12,tickFormatter:xe=>xe.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:60}),l.jsx(ta,{content:l.jsx(Ne,{})}),l.jsx(ds,{dataKey:"vehicles",radius:[6,6,0,0],onClick:xe=>pe(xe.name),style:{cursor:"pointer"},maxBarSize:80,children:he(se).map((xe,Ce)=>{const ze=Pe(xe.index,xe.totalCount);return l.jsx(Kh,{fill:ze,stroke:ze,strokeWidth:1.5,style:{filter:"drop-shadow(0 3px 6px rgba(0, 0, 0, 0.12))",transition:"all 0.3s ease"}},`cell-${Ce}`)})})]})})})]})}),l.jsx(rUe,{isOpen:L,onClose:je,municipality:H,selectedMonth:e,selectedYear:t,municipalitiesList:se})]})},iUe=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(!1);W.useEffect(()=>{const qe=()=>{n(window.innerWidth<640)};return qe(),window.addEventListener("resize",qe),()=>window.removeEventListener("resize",qe)},[]),W.useEffect(()=>{const qe=document.createElement("style");return qe.textContent=`
      .scrollbar-hide {
        -ms-overflow-style: none;  /* Internet Explorer 10+ */
        scrollbar-width: none;  /* Firefox */
      }
      .scrollbar-hide::-webkit-scrollbar { 
        display: none;  /* Safari and Chrome */
      }
    `,document.head.appendChild(qe),()=>{document.head.removeChild(qe)}},[]);const[a,c]=W.useState(!1),[f,i]=W.useState(null),[x,w]=W.useState(!1),[A,P]=W.useState(!1),[E,D]=W.useState(""),[V,L]=W.useState(""),[$,H]=W.useState(!1),[K,Q]=W.useState("year"),[ae,ee]=W.useState(!1),[se,ce]=W.useState(""),[he,Pe]=W.useState(()=>localStorage.getItem("vehicleTrendMunicipality")||"All"),[Ne,pe]=W.useState(!1),je=new Date().getFullYear(),xe=["All","BAGANGA","BANAYBANAY","BOSTON","CARAGA","CATEEL","GOVERNOR GENEROSO","LUPON","MANAY","SAN ISIDRO","TARRAGONA","CITY OF MATI"],Ce=async(qe,Lt,Zt=null)=>{try{c(!0),i(null);const rr=await JVe(qe,Lt,Zt||he);if(rr.success){const ir=rr.data.map((Bt,De,jr)=>Bt.total===0?jr.slice(De+1).find(Cr=>Cr.total>0)?{...Bt,total:0,active:0,expired:0,noRegistration:null}:{...Bt,total:null,active:null,expired:null,noRegistration:0}:{...Bt,noRegistration:null});t(ir)}else i("Failed to fetch yearly trend data"),t([])}catch(Xt){console.error("Error fetching yearly trend data:",Xt),i("Error loading yearly trend data")}finally{c(!1)}},ze=async(qe,Lt=null)=>{try{c(!0),i(null);const Xt=await QVe(qe,Lt||he);if(Xt.success){console.log("Raw monthly data:",Xt.data);const rr=Xt.data.map((ir,Bt,De)=>ir.total===0?De.slice(Bt+1).find(Dt=>Dt.total>0)?{...ir,total:0,active:0,expired:0,noRegistration:null}:{...ir,total:null,active:null,expired:null,noRegistration:0}:{...ir,noRegistration:null});console.log("Processed monthly data:",rr),t(rr)}else i("Failed to fetch monthly trend data"),t([])}catch(Zt){console.error("Error fetching monthly trend data:",Zt),i("Error loading monthly trend data")}finally{c(!1)}},Te=()=>{w(!0)},Re=()=>{const qe=parseInt(E),Lt=parseInt(V);if(i(null),!qe||!Lt){i("Please enter both start and end years");return}if(qe<2e3){i(`Start year ${qe} is too early. Please enter a year from 2000 onwards`);return}if(Lt>je){i(`End year ${Lt} is in the future. Please enter a year up to ${je}`);return}if(qe>Lt){i(`Start year ${qe} cannot be later than end year ${Lt}`);return}H(!0),localStorage.setItem("vehicleTrendCustomStartYear",qe.toString()),localStorage.setItem("vehicleTrendCustomEndYear",Lt.toString()),localStorage.setItem("vehicleTrendIsCustomRange","true"),K==="year"&&Ce(qe,Lt,he),P(!1)},Fe=()=>{H(!1),D(""),L(""),i(null),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),K==="year"&&Ce(je-4,je,he),P(!1)},He=qe=>{Q(qe),localStorage.setItem("vehicleTrendViewType",qe),qe==="year"?(H(!1),D(""),L(""),Ce(je-4,je,he),w(!1)):qe==="month"?(ee(!0),w(!1)):qe==="customRange"&&w(!1)},mt=qe=>{ce(qe),localStorage.setItem("vehicleTrendSelectedYear",qe),i(null),ee(!1),ze(qe,he)},Xe=qe=>{Pe(qe),localStorage.setItem("vehicleTrendMunicipality",qe),pe(!1),K==="year"?$&&E&&V?Ce(parseInt(E),parseInt(V),qe):Ce(je-4,je,qe):K==="month"&&se&&ze(se,qe)};W.useEffect(()=>{const qe=localStorage.getItem("vehicleTrendMunicipality")||"All";Ce(je-4,je,qe),localStorage.setItem("vehicleTrendViewType","year"),localStorage.removeItem("vehicleTrendSelectedYear"),localStorage.removeItem("vehicleTrendIsCustomRange"),localStorage.removeItem("vehicleTrendCustomStartYear"),localStorage.removeItem("vehicleTrendCustomEndYear")},[]),W.useEffect(()=>{const qe=Lt=>{x&&!Lt.target.closest(".filter-dropdown")&&w(!1)};return document.addEventListener("mousedown",qe),()=>{document.removeEventListener("mousedown",qe)}},[x]),W.useEffect(()=>{K==="month"&&!se&&(Q("year"),H(!1),D(""),L(""),Ce(je-4,je,he))},[K,se]);const ot=({active:qe,payload:Lt,label:Zt})=>{if(qe&&Lt&&Lt.length){const Xt=Lt.filter(ir=>ir.value!==null&&ir.dataKey!=="noRegistration"&&(ir.dataKey==="total"||ir.dataKey==="active"||ir.dataKey==="expired")),rr=Xt.every(ir=>ir.value===0);return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-3 shadow-lg",children:[l.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-2",children:Zt}),l.jsx("div",{className:"space-y-1",children:Xt.map((ir,Bt)=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:ir.color}}),l.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[ir.dataKey==="total"?"Total":ir.dataKey==="active"?"Active":"Expired",":",l.jsx("span",{className:"ml-1 font-medium",children:rr?"No Data":ir.value.toLocaleString()})]})]},Bt))})]})}return null};return l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsxs("svg",{className:"w-6 h-6 text-green-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M3 3v18h18"}),l.jsx("path",{d:"M18.7 8l-5.1 5.2-2.8-2.7L7 14.3"}),l.jsx("circle",{cx:"18",cy:"8",r:"2"})]})}),l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("h2",{className:"text-sm font-bold text-foreground",children:["Vehicle Registration Trends",l.jsxs("span",{className:"text-muted-foreground font-normal ml-2",style:{fontSize:"10px"},children:[K==="year"?$?`By Year (${E}-${V})`:"By Year (Last 5 Years)":`By Month (${se||"Select Year"})`,he!=="All"&&l.jsxs("span",{className:"text-primary font-medium",children:["• ",he]})]})]}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Historical registration patterns showing total, active, and expired vehicles"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:Te,className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Filter options",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),x&&l.jsx("div",{className:"filter-dropdown absolute right-0 top-full mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50",children:l.jsxs("div",{className:"p-2",children:[l.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"View Type"}),l.jsx("button",{onClick:()=>He("year"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${K==="year"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Year"}),l.jsx("button",{onClick:()=>He("month"),className:`w-full text-left px-2 py-2 text-sm rounded-md transition-colors ${K==="month"?"bg-blue-500 text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:"By Month"}),l.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 my-1"}),l.jsx("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2 px-2",children:"Date Range"}),l.jsx("button",{onClick:()=>{w(!1),P(!0)},className:"w-full text-left px-2 py-2 text-sm rounded-md transition-colors text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Custom Range"})]})})]}),l.jsx("button",{onClick:()=>pe(!0),className:"p-2 bg-primary/10 text-primary hover:bg-primary/20 rounded-md transition-colors",title:"Location options",children:l.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),l.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[a?l.jsx("div",{className:"flex items-center justify-center w-full h-full",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):f?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:l.jsx("p",{children:f})}):e.length===0?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:l.jsx("p",{children:"No data available"})}):l.jsx(_o,{width:"100%",height:"100%",minHeight:320,children:l.jsxs(T4,{data:e,margin:{top:10,right:20,left:0,bottom:20},children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"totalGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:.8}),l.jsx("stop",{offset:"20%",stopColor:"#3b82f6",stopOpacity:.6}),l.jsx("stop",{offset:"40%",stopColor:"#3b82f6",stopOpacity:.4}),l.jsx("stop",{offset:"60%",stopColor:"#3b82f6",stopOpacity:.2}),l.jsx("stop",{offset:"80%",stopColor:"#3b82f6",stopOpacity:.1}),l.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:0})]}),l.jsxs("linearGradient",{id:"activeGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#10b981",stopOpacity:.8}),l.jsx("stop",{offset:"20%",stopColor:"#10b981",stopOpacity:.6}),l.jsx("stop",{offset:"40%",stopColor:"#10b981",stopOpacity:.4}),l.jsx("stop",{offset:"60%",stopColor:"#10b981",stopOpacity:.2}),l.jsx("stop",{offset:"80%",stopColor:"#10b981",stopOpacity:.1}),l.jsx("stop",{offset:"100%",stopColor:"#10b981",stopOpacity:0})]}),l.jsxs("linearGradient",{id:"expiredGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#ef4444",stopOpacity:.8}),l.jsx("stop",{offset:"20%",stopColor:"#ef4444",stopOpacity:.6}),l.jsx("stop",{offset:"40%",stopColor:"#ef4444",stopOpacity:.4}),l.jsx("stop",{offset:"60%",stopColor:"#ef4444",stopOpacity:.2}),l.jsx("stop",{offset:"80%",stopColor:"#ef4444",stopOpacity:.1}),l.jsx("stop",{offset:"100%",stopColor:"#ef4444",stopOpacity:0})]})]}),l.jsx(Ws,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),l.jsx(Oa,{dataKey:K==="year"?"year":"month",stroke:"#6b7280",fontSize:r?10:12,tick:{fill:"#6b7280",fontWeight:500},angle:r?-45:0,textAnchor:r?"end":"middle",height:r?60:30,tickFormatter:qe=>(console.log("X-axis tick value:",qe,"viewType:",K),qe)}),l.jsx(Ra,{stroke:"#6b7280",fontSize:r?10:12,tickFormatter:qe=>qe.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:r?60:80}),l.jsx(ta,{content:l.jsx(ot,{})}),l.jsx(ku,{type:"monotone",dataKey:"total",stroke:"#3b82f6",strokeWidth:3,fill:"url(#totalGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#3b82f6",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(59, 130, 246, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#3b82f6",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(59, 130, 246, 0.4))"},name:"Total Vehicles"}),l.jsx(ku,{type:"monotone",dataKey:"active",stroke:"#10b981",strokeWidth:3,fill:"url(#activeGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#10b981",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(16, 185, 129, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#10b981",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(16, 185, 129, 0.4))"},name:"Active Vehicles"}),l.jsx(ku,{type:"monotone",dataKey:"expired",stroke:"#ef4444",strokeWidth:3,fill:"url(#expiredGradient)",fillOpacity:1,connectNulls:!0,dot:{fill:"white",stroke:"#ef4444",strokeWidth:2,r:5,filter:"drop-shadow(0 1px 2px rgba(239, 68, 68, 0.3))"},activeDot:{r:7,fill:"white",stroke:"#ef4444",strokeWidth:2,filter:"drop-shadow(0 2px 4px rgba(239, 68, 68, 0.4))"},name:"Expired Vehicles"}),l.jsx(ku,{type:"monotone",dataKey:"noRegistration",stroke:"#9ca3af",strokeWidth:2,strokeDasharray:"3 3",fill:"none",connectNulls:!0,dot:{fill:"#9ca3af",strokeWidth:1,r:3,filter:"drop-shadow(0 1px 2px rgba(156, 163, 175, 0.3))"},activeDot:{r:5,stroke:"#9ca3af",strokeWidth:1,filter:"drop-shadow(0 2px 4px rgba(156, 163, 175, 0.4))"},name:"No Registration",hide:!0})]})}),e.length>0&&l.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-gray-600 dark:text-gray-400",style:{fontSize:r?"10px":"12px",fontWeight:"500",paddingTop:"0px",textAlign:"center"},children:[e.some(qe=>qe.total!==null)&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),l.jsx("span",{children:"Total Vehicles"})]}),e.some(qe=>qe.active!==null)&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),l.jsx("span",{children:"Active Vehicles"})]}),e.some(qe=>qe.expired!==null)&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),l.jsx("span",{children:"Expired Vehicles"})]})]})]}),A&&l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Filter Date Range"})]}),l.jsx("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Year"}),l.jsx("input",{type:"number",value:E,onChange:qe=>D(qe.target.value),placeholder:"e.g., 2020",min:"2000",max:je,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Year"}),l.jsx("input",{type:"number",value:V,onChange:qe=>L(qe.target.value),placeholder:"e.g., 2025",min:"2000",max:je,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"})]})]}),f&&l.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:l.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:f})}),l.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[l.jsx("button",{onClick:Re,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply Filter"}),l.jsx("button",{onClick:Fe,className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Reset"})]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:"Default range: Last 5 years (2021 - 2025)"})]})]})}),ae&&l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-6 w-full max-w-md shadow-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:l.jsx("path",{d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Select Year for Monthly View"})]}),l.jsx("button",{onClick:()=>ee(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enter a year to view monthly vehicle registration trends:"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Year"}),l.jsx("input",{type:"number",value:se,onChange:qe=>ce(qe.target.value),placeholder:"e.g., 2025",min:"2000",max:je,className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",onKeyPress:qe=>{if(qe.key==="Enter"){const Lt=parseInt(se);Lt>=2e3&&Lt<=je&&mt(Lt)}}})]}),f&&l.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:l.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:f})}),l.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[l.jsx("button",{onClick:()=>{const qe=parseInt(se);qe>=2e3&&qe<=je?mt(qe):i(`Please enter a valid year between 2000 and ${je}`)},className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors",children:"Apply"}),l.jsx("button",{onClick:()=>ee(!1),className:"px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:"Cancel"})]}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:["Available years: 2000 - ",je]})]})]})}),Ne&&l.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-in fade-in duration-300",children:l.jsxs("div",{className:"bg-gradient-to-br from-white via-gray-50 to-white border border-gray-200/50 rounded-2xl p-8 w-full max-w-[600px] shadow-2xl dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 dark:border-gray-700/50 animate-in zoom-in-95 duration-300",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/10 rounded-xl",children:l.jsxs("svg",{className:"w-7 h-7 text-primary",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),l.jsx("path",{d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Select Municipality"}),l.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Filter data by location"})]})]}),l.jsx("button",{onClick:()=>pe(!1),className:"p-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-all duration-200 group",children:l.jsx("svg",{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl p-4 border border-blue-200/50 dark:border-blue-700/50",children:l.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"💡 Choose a municipality to view its specific vehicle registration trends"})}),l.jsx("div",{className:"grid grid-cols-1 gap-3 max-h-80 overflow-y-auto scrollbar-hide",children:xe.map((qe,Lt)=>l.jsxs("button",{onClick:()=>Xe(qe),className:`group relative p-4 text-left rounded-xl transition-all duration-300 border-2 ${he===qe?"bg-gradient-to-r from-primary to-primary/80 text-white border-primary shadow-lg shadow-primary/25 transform scale-[1.02]":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600 hover:border-primary/50 hover:bg-primary/5 dark:hover:bg-primary/10 hover:shadow-md hover:transform hover:scale-[1.01]"}`,style:{animationDelay:`${Lt*50}ms`},children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${he===qe?"bg-white":"bg-primary/60 group-hover:bg-primary"}`}),l.jsx("span",{className:"font-medium",children:qe})]}),he===qe&&l.jsx("div",{className:"flex items-center gap-2",children:l.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]}),qe==="All"&&l.jsx("p",{className:"text-xs opacity-75 mt-1",children:"View all municipalities combined"})]},qe))}),l.jsx("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),l.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Currently selected:"}),l.jsx("span",{className:"text-sm font-semibold text-primary",children:he})]})})]})]})})]})},aUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=W.useState([]),[c,f]=W.useState(!1),[i,x]=W.useState(null),[w,A]=W.useState(!1),[P,E]=W.useState(!1);W.useEffect(()=>{const $=()=>{E(window.innerWidth<640)};return $(),window.addEventListener("resize",$),()=>window.removeEventListener("resize",$)},[]);const D=async()=>{try{f(!0),x(null);let $=null,H=null;e&&e!=="All"&&($=IN(e)),t&&t!=="All"&&(H=t);const K=await eUe($,H);K.success?a(K.data):(x("Failed to fetch owner municipality data"),a([]))}catch($){console.error("Error fetching owner municipality data:",$),x("Error loading owner municipality data")}finally{f(!1)}};W.useEffect(()=>{D(),A(!1)},[]),W.useEffect(()=>{D(),A(!1)},[e,t]),W.useEffect(()=>{if(n.length>0){const $=setTimeout(()=>A(!0),100);return()=>clearTimeout($)}},[n]);const V=$=>$.map(H=>({name:H.municipality,withLicense:H.withLicense,withoutLicense:H.withoutLicense,total:H.totalOwners})),L=({active:$,payload:H,label:K})=>{var Q,ae;if($&&H&&H.length){const ee=((Q=H.find(he=>he.dataKey==="withLicense"))==null?void 0:Q.value)||0,se=((ae=H.find(he=>he.dataKey==="withoutLicense"))==null?void 0:ae.value)||0,ce=ee+se;return l.jsx("div",{className:"bg-gray-100/90 dark:bg-gray-700/90 border border-gray-400/40 dark:border-gray-500/40 rounded-xl p-4 shadow-2xl backdrop-blur-sm",children:l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-100 text-sm",children:K}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#22c55e"}}),l.jsxs("span",{className:"text-green-600 dark:text-green-400 text-xs",children:[l.jsx("span",{className:"font-semibold",children:ee.toLocaleString()})," With License"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#3b82f6"}}),l.jsxs("span",{className:"text-blue-600 dark:text-blue-400 text-xs",children:[l.jsx("span",{className:"font-semibold",children:se.toLocaleString()})," Without License"]})]}),l.jsx("div",{className:"border-t border-gray-300 dark:border-gray-600 pt-1",children:l.jsxs("span",{className:"text-gray-700 dark:text-gray-300 text-xs font-semibold",children:["Total: ",ce.toLocaleString()]})})]})]})})}return null};return l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-4xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[l.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsxs("svg",{className:"w-6 h-6 text-purple-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M3 3v18h18"}),l.jsx("path",{d:"M8 9v8"}),l.jsx("path",{d:"M8 12v6"}),l.jsx("path",{d:"M8 15v4"}),l.jsx("path",{d:"M12 9v4"}),l.jsx("path",{d:"M12 12v2"}),l.jsx("path",{d:"M12 15v1"})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Registered Owners by Municipality"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Vehicle owners with and without driver's licenses by location"})]}),t==="All"&&e&&e!=="All"&&l.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&l.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),l.jsxs("div",{className:"h-80 w-full min-h-[320px] flex-1",children:[c||r?l.jsx("div",{className:"flex items-center justify-center w-full h-full",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:l.jsx("p",{children:i})}):n.length===0?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:l.jsx("p",{children:"No data available"})}):l.jsx(_o,{width:"100%",height:"100%",minHeight:300,children:l.jsxs(Cu,{data:V(n),margin:{top:0,right:P?5:10,left:P?5:10,bottom:P?40:30},barCategoryGap:"3%",children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:"#6b7280",opacity:.4}),l.jsx(Oa,{dataKey:"name",stroke:"#6b7280",fontSize:P?7:9,height:P?35:25,interval:0,angle:-45,textAnchor:"end",tick:{fill:"#6b7280",fontWeight:500},tickFormatter:$=>$.length>10?$.substring(0,10)+"...":$}),l.jsx(Ra,{stroke:"#6b7280",fontSize:P?10:12,tickFormatter:$=>$.toLocaleString(),tick:{fill:"#6b7280",fontWeight:500},width:P?50:70}),l.jsx(ta,{content:l.jsx(L,{})}),l.jsx(ds,{dataKey:"withLicense",stackId:"owners",name:"With Driver's License",fill:"#22c55e",radius:[0,0,0,0],maxBarSize:P?150:200}),l.jsx(ds,{dataKey:"withoutLicense",stackId:"owners",name:"Without Driver's License",fill:"#3b82f6",radius:[4,4,0,0],maxBarSize:P?150:200})]})}),n.length>0&&l.jsxs("div",{className:"flex justify-center gap-6 mt-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#22c55e"}}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"With Driver's License"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:"#3b82f6"}}),l.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Without Driver's License"})]})]})]})]})},sUe=({selectedMonth:e,selectedYear:t,loading:r})=>{const[n,a]=W.useState([]),[c,f]=W.useState(!1),[i,x]=W.useState(null),[w,A]=W.useState(!1),[P,E]=W.useState(!1);W.useEffect(()=>{const K=()=>{E(window.innerWidth<640)};return K(),window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)},[]);const D=async()=>{try{f(!0),x(null);let K=null,Q=null;e&&e!=="All"&&(K=IN(e)),t&&t!=="All"&&(Q=t);const ae=await tUe(K,Q);if(ae.success&&ae.data){console.log("Raw classification data:",ae.data);const ee=ae.data.filter(se=>se.classification&&se.classification.toUpperCase()==="FOR HRE");ee.length>0?console.warn("Found FOR HRE entries in data:",ee):console.log("No FOR HRE entries found in data - filtering working correctly")}ae.success?a(ae.data):(x("Failed to fetch vehicle classification data"),a([]))}catch(K){console.error("Error fetching vehicle classification data:",K),x("Error loading vehicle classification data")}finally{f(!1)}};W.useEffect(()=>{D(),A(!1)},[]),W.useEffect(()=>{D(),A(!1)},[e,t]),W.useEffect(()=>{if(n.length>0){const K=setTimeout(()=>A(!0),100);return()=>clearTimeout(K)}},[n]);const V=K=>{console.log("formatChartData - Input data:",K);const Q={};K.forEach(se=>{if(console.log("Processing item:",se),se.classification&&se.classification.toUpperCase()==="FOR HRE"||!["PRIVATE","FOR HIRE","GOVERNMENT"].includes(se.classification.toUpperCase()))return;const he=se.classification.toUpperCase();he in Q?Q[he].count+=se.count:Q[he]={classification:he,count:se.count}});const ae=Object.values(Q).reduce((se,ce)=>se+ce.count,0),ee=Object.values(Q).map(se=>({name:se.classification,value:se.count,percentage:ae>0?Math.round(se.count/ae*100):0}));return console.log("formatChartData - Final result:",ee),ee},L=K=>{switch(K){case"PRIVATE":return"#3b82f6";case"FOR HIRE":return"#ef4444";case"GOVERNMENT":return"#10b981";default:return"#6b7280"}},$=({active:K,payload:Q})=>{if(K&&Q&&Q.length){const ae=Q[0];return l.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg p-3 shadow-lg",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ae.color}}),l.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:ae.name})]}),l.jsxs("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:[ae.value.toLocaleString()," vehicles (",ae.payload.percentage,"%)"]})]})}return null},H=({payload:K})=>l.jsx("div",{className:"flex flex-col gap-4",children:K.map((Q,ae)=>{var ee;return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-4 h-4 rounded-full shadow-sm",style:{backgroundColor:Q.color,border:`2px solid ${Q.color}20`}}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:Q.value}),l.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[((ee=Q.payload)==null?void 0:ee.percentage)||0,"%"]})]})]},ae)})});return l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-3 w-full max-w-2xl mx-auto h-fit shadow-sm dark:!bg-transparent dark:!border-gray-700 min-h-[400px] flex flex-col",children:[l.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-2 gap-2",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:l.jsxs("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2z"}),l.jsx("path",{d:"M12 2v10l8 8"})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2",children:[l.jsxs("div",{className:"flex flex-col",children:[l.jsx("h2",{className:"text-sm font-bold text-foreground",children:"Vehicle Classification"}),l.jsx("p",{className:"text-xs text-muted-foreground",children:"Distribution of vehicles by type (Private, For Hire, Government)"})]}),t==="All"&&e&&e!=="All"&&l.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(",e," across all years)"]}),e==="All"&&t&&t!=="All"&&l.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["(All months in ",t,")"]})]})]})}),l.jsx("div",{className:"h-80 w-full min-h-[320px] flex-1 relative flex flex-col",children:c||r?l.jsx("div",{className:"flex items-center justify-center w-full h-full",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):i?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-red-500",children:l.jsx("p",{children:i})}):n.length===0?l.jsx("div",{className:"flex items-center justify-center w-full h-full text-muted-foreground",children:l.jsx("p",{children:"No data available"})}):l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsx("div",{className:"flex-shrink-0 animate-fade-in",children:l.jsx(_o,{width:P?200:280,height:P?200:280,children:l.jsxs(Dte,{children:[l.jsx(pp,{data:V(n),cx:"50%",cy:"50%",labelLine:!1,outerRadius:P?80:100,innerRadius:P?20:40,fill:"#8884d8",dataKey:"value",animationBegin:0,animationDuration:1800,animationEasing:"ease-out",stroke:"#ffffff",strokeWidth:2,startAngle:90,endAngle:450,children:V(n).map((K,Q)=>l.jsx(Kh,{fill:L(K.name),stroke:"#ffffff",strokeWidth:2,style:{filter:"drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15))",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transformOrigin:"center"},onMouseEnter:ae=>{ae.target.style.filter="drop-shadow(0 4px 8px rgba(0, 0, 0, 0.25)) brightness(1.05)",ae.target.style.transform="scale(1.02)"},onMouseLeave:ae=>{ae.target.style.filter="drop-shadow(0 2px 4px rgba(0, 0, 0, 0.15))",ae.target.style.transform="scale(1)"}},`cell-${K.name}`))}),l.jsx(ta,{content:l.jsx($,{}),position:{x:0,y:0},offset:20})]})})}),l.jsx("div",{className:"flex-shrink-0 animate-slide-in-right",children:l.jsx(H,{payload:V(n).map(K=>({value:K.name,color:L(K.name),payload:{percentage:K.percentage}}))})})]})})})]})},Dg={"CITY OF MATI":{Jan:1200,Feb:1180,Mar:1300,Apr:1250,May:1400,Jun:1500,Jul:1480,Aug:1420,Sep:1350,Oct:1380,Nov:1400,Dec:1520},MANAY:{Jan:800,Feb:780,Mar:900,Apr:860,May:920,Jun:980,Jul:950,Aug:920,Sep:880,Oct:900,Nov:910,Dec:1e3},BAGANGA:{Jan:650,Feb:680,Mar:720,Apr:700,May:750,Jun:780,Jul:760,Aug:740,Sep:720,Oct:730,Nov:740,Dec:800},BANAYBANAY:{Jan:450,Feb:460,Mar:480,Apr:470,May:500,Jun:520,Jul:510,Aug:490,Sep:480,Oct:485,Nov:490,Dec:530},BOSTON:{Jan:320,Feb:330,Mar:350,Apr:340,May:360,Jun:370,Jul:365,Aug:355,Sep:350,Oct:352,Nov:355,Dec:380},CARAGA:{Jan:280,Feb:290,Mar:310,Apr:300,May:320,Jun:330,Jul:325,Aug:315,Sep:310,Oct:312,Nov:315,Dec:340},CATEEL:{Jan:380,Feb:390,Mar:410,Apr:400,May:420,Jun:430,Jul:425,Aug:415,Sep:410,Oct:412,Nov:415,Dec:440},"GOVERNOR GENEROSO":{Jan:520,Feb:530,Mar:550,Apr:540,May:570,Jun:580,Jul:575,Aug:565,Sep:560,Oct:562,Nov:565,Dec:590},LUPON:{Jan:680,Feb:690,Mar:720,Apr:700,May:740,Jun:760,Jul:750,Aug:730,Sep:720,Oct:725,Nov:730,Dec:780},"SAN ISIDRO":{Jan:420,Feb:430,Mar:450,Apr:440,May:460,Jun:470,Jul:465,Aug:455,Sep:450,Oct:452,Nov:455,Dec:480},TARRAGONA:{Jan:350,Feb:360,Mar:380,Apr:370,May:390,Jun:400,Jul:395,Aug:385,Sep:380,Oct:382,Nov:385,Dec:410}},ax=Object.keys(Dg).reduce((e,t)=>{const r=Dg[t],n=Object.values(r).reduce((a,c)=>a+c,0);return e[t]=n,e},{});function oUe(){const[e,t]=W.useState("monthly"),[r,n]=W.useState(!1),a=W.useRef(null),f=new Date().getFullYear()+1;W.useEffect(()=>{const V=L=>{a.current&&!a.current.contains(L.target)&&n(!1)};return document.addEventListener("mousedown",V),()=>{document.removeEventListener("mousedown",V)}},[]);const x=(()=>{const V=Object.values(ax).reduce((ae,ee)=>ae+ee,0),L=Object.entries(ax).reduce((ae,[ee,se])=>se>ae.total?{municipality:ee,total:se}:ae,{municipality:"",total:0});let $=0,H="",K="";return Object.entries(Dg).forEach(([ae,ee])=>{Object.entries(ee).forEach(([se,ce])=>{ce>$&&($=ce,H=ae,K=se)})}),{totalPredicted:V,topMunicipalityYear:L,peakMunicipality:H,peakMonth:K,peakValue:$,fastestGrowth:12.5}})(),A=e==="monthly"?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map($=>{const H={month:$};return Object.entries(Dg).forEach(([K,Q])=>{H[K]=Q[$]}),H}):Object.entries(ax).map(([V,L])=>({municipality:V,total:L})),P=["#4E79A7","#F28E2B","#E15759","#76B7B2","#59A14F","#EDC948","#B07AA1","#FF9DA7","#9C755F","#BAB0AC","#4E79A7"],E=({active:V,payload:L,label:$})=>{if(V&&L&&L.length){const H=[...L].sort((K,Q)=>(Q.value||0)-(K.value||0));return l.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 border border-blue-200 dark:border-blue-700 rounded-lg shadow-lg max-w-xs",children:[l.jsx("p",{className:"text-sm font-bold text-blue-800 dark:text-blue-300 mb-2 text-center",children:e==="monthly"?`${$}`:`${$}`}),l.jsx("div",{className:"space-y-1",children:H.map((K,Q)=>{var ae;return l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[l.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:K.color}}),l.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300 truncate",title:K.dataKey,children:K.dataKey})]}),l.jsx("span",{className:"text-xs font-medium flex-shrink-0 ml-2",style:{color:K.color},children:((ae=K.value)==null?void 0:ae.toLocaleString())||0})]},Q)})})]})}return null},D=V=>{let L="",$="",H="";e==="monthly"?V==="csv"?(L=`Municipality,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
`,Object.entries(Dg).forEach(([ee,se])=>{const ce=[ee,...Object.values(se)].join(",");L+=ce+`
`}),$=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.csv`,H="text/csv"):V==="json"?(L=JSON.stringify(Dg,null,2),$=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.json`,H="application/json"):V==="excel"&&(L=`Municipality,Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec
`,Object.entries(Dg).forEach(([ee,se])=>{const ce=[ee,...Object.values(se)].join(",");L+=ce+`
`}),$=`predictive_analytics_monthly_${new Date().toISOString().split("T")[0]}.xlsx`,H="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):V==="csv"?(L=`Municipality,Total
`,Object.entries(ax).forEach(([ee,se])=>{L+=`${ee},${se}
`}),$=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.csv`,H="text/csv"):V==="json"?(L=JSON.stringify(ax,null,2),$=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.json`,H="application/json"):V==="excel"&&(L=`Municipality,Total
`,Object.entries(ax).forEach(([ee,se])=>{L+=`${ee},${se}
`}),$=`predictive_analytics_yearly_${new Date().toISOString().split("T")[0]}.xlsx`,H="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");const K=new Blob([L],{type:H}),Q=window.URL.createObjectURL(K),ae=document.createElement("a");ae.href=Q,ae.download=$,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),window.URL.revokeObjectURL(Q),n(!1)};return l.jsxs("div",{className:"mt-8 bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/30 border border-blue-200 dark:border-blue-800 rounded-xl shadow-lg",children:[l.jsx("div",{className:"p-6 border-b border-blue-200/50 dark:border-blue-700/50",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Predictive Analytics"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Uses the SARIMA algorithm to forecast future trends based on historical and current data, providing insights on risks, traffic patterns, and vehicle registrations."}),l.jsxs("div",{className:"mt-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-300",children:["Predicting ",f," (Based on the last data available)"]})]})]})})}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 h-full",children:[l.jsx("div",{className:"xl:col-span-2 p-2 sm:p-4",children:l.jsx("div",{className:"space-y-4 sm:space-y-6",children:l.jsxs("div",{className:"relative bg-gradient-to-br from-green-50/80 via-blue-50/60 to-orange-50/40 dark:from-green-900/20 dark:via-blue-900/20 dark:to-orange-900/20 backdrop-blur-sm rounded-xl p-3 sm:p-6 border border-green-200/30 dark:border-green-700/30 shadow-lg overflow-hidden",children:[l.jsx("div",{className:"absolute inset-0 opacity-5",children:l.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 400 300",fill:"none",children:[l.jsx("path",{d:"M0,200 L50,150 L100,180 L150,120 L200,160 L250,100 L300,140 L350,80 L400,120 L400,300 L0,300 Z",fill:"#2E7D32"}),l.jsx("path",{d:"M0,250 Q100,220 200,250 T400,250 L400,300 L0,300 Z",fill:"#1565C0"}),l.jsx("circle",{cx:"80",cy:"80",r:"15",fill:"#81C784"}),l.jsx("circle",{cx:"320",cy:"60",r:"12",fill:"#FBC02D"}),l.jsx("circle",{cx:"150",cy:"200",r:"10",fill:"#F57C00"})]})}),l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[l.jsx("h4",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white",children:e==="monthly"?"Monthly Trends":"Yearly Totals"}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",style:{pointerEvents:"auto"},children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300 hidden sm:inline",children:"View:"}),l.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-600 rounded-md p-0.5",children:[l.jsx("button",{onClick:V=>{V.preventDefault(),V.stopPropagation(),console.log("Monthly button clicked"),t("monthly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${e==="monthly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Monthly"}),l.jsx("button",{onClick:V=>{V.preventDefault(),V.stopPropagation(),console.log("Yearly button clicked"),t("yearly")},className:`px-2 sm:px-3 py-1.5 text-xs rounded transition-all duration-200 cursor-pointer select-none z-10 relative touch-manipulation ${e==="yearly"?"bg-white dark:bg-gray-500 text-gray-900 dark:text-white shadow-sm font-medium":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-500"}`,type:"button",style:{pointerEvents:"auto"},children:"Yearly"})]})]}),l.jsx("div",{className:"flex items-center gap-2 ml-auto relative",children:l.jsxs("div",{className:"relative",ref:a,children:[l.jsxs("button",{onClick:()=>n(!r),className:"px-2 sm:px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded-md transition-colors duration-200 flex items-center gap-1 touch-manipulation",children:[l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("span",{className:"hidden sm:inline",children:"Export"}),l.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&l.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-50",children:l.jsxs("div",{className:"py-1",children:[l.jsxs("button",{onClick:()=>D("csv"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as CSV"]}),l.jsxs("button",{onClick:()=>D("json"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Export as JSON"]}),l.jsxs("button",{onClick:()=>D("excel"),className:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export as Excel"]})]})})]})})]})]}),l.jsx("div",{className:"h-64 sm:h-80 lg:h-96",children:l.jsx(_o,{width:"100%",height:"100%",children:e==="monthly"?l.jsxs(A4,{data:A,margin:{top:20,right:30,left:20,bottom:20},"aria-label":"Monthly registration trends chart",children:[l.jsx(Ws,{strokeDasharray:"2 4",stroke:"#4E79A7",strokeOpacity:.2,vertical:!1}),l.jsx(Oa,{dataKey:"month",stroke:"#4E79A7",fontSize:10,fontWeight:"500",tick:{fill:"#4E79A7"}}),l.jsx(Ra,{stroke:"#4E79A7",fontSize:10,fontWeight:"500",tick:{fill:"#4E79A7"},tickFormatter:V=>V.toLocaleString()}),l.jsx(ta,{content:l.jsx(E,{}),cursor:{stroke:"#76B7B2",strokeWidth:1,strokeDasharray:"3 3"}}),l.jsx(Yf,{wrapperStyle:{fontSize:"11px",fontWeight:"500",color:"#4E79A7",paddingTop:"10px"},onClick:V=>{console.log("Legend clicked:",V)}}),Object.keys(Dg).map((V,L)=>l.jsx(op,{type:"monotone",dataKey:V,stroke:P[L%P.length],strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",dot:{r:5,fill:P[L%P.length],stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:P[L%P.length],stroke:"#fff",strokeWidth:3,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.2))"},name:V,connectNulls:!1},V))]}):l.jsxs(Cu,{data:A,margin:{top:20,right:20,left:20,bottom:10},"aria-label":"Yearly registration totals chart",children:[l.jsx(Ws,{strokeDasharray:"2 4",stroke:"#4E79A7",strokeOpacity:.2,vertical:!1}),l.jsx(Oa,{dataKey:"municipality",stroke:"#4E79A7",fontSize:10,fontWeight:"500",angle:-45,textAnchor:"end",height:120,interval:0,tick:{fontSize:9,fill:"#4E79A7",textAnchor:"end"},tickFormatter:V=>V==="GOVERNOR GENEROSO"?["GOVERNOR","GENEROSO"]:V==="CITY OF MATI"?["CITY OF","MATI"]:V}),l.jsx(Ra,{stroke:"#4E79A7",fontSize:13,fontWeight:"500",tick:{fill:"#4E79A7"},tickFormatter:V=>V.toLocaleString()}),l.jsx(ta,{content:l.jsx(E,{}),cursor:{fill:"#76B7B2",fillOpacity:.1}}),l.jsx(Yf,{wrapperStyle:{fontSize:"11px",fontWeight:"500",color:"#4E79A7",paddingTop:"10px"}}),l.jsx(ds,{dataKey:"total",fill:"url(#pastelGradient)",name:"Total Registrations",radius:[6,6,0,0],stroke:"#4E79A7",strokeWidth:1}),l.jsx("defs",{children:l.jsxs("linearGradient",{id:"pastelGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"0%",stopColor:"#76B7B2"}),l.jsx("stop",{offset:"50%",stopColor:"#4E79A7"}),l.jsx("stop",{offset:"100%",stopColor:"#B07AA1"})]})})]})})})]})})}),l.jsx("div",{className:"xl:col-span-1 p-2 sm:p-4",children:l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-3 sm:gap-4",children:[l.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-blue-100 dark:bg-blue-900/50 rounded-lg flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Total Predicted"})]}),l.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white",children:x.totalPredicted.toLocaleString()}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Across Davao Oriental"})]}),l.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 bg-green-100 dark:bg-green-900/50 rounded-lg flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),l.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Top Municipality"})]}),l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:x.topMunicipalityYear.municipality}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.topMunicipalityYear.total.toLocaleString()," registrations"]})]}),l.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 bg-purple-100 dark:bg-purple-900/50 rounded-lg flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),l.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Peak Month"})]}),l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white truncate w-full",children:x.peakMunicipality}),l.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[x.peakMonth,": ",x.peakValue.toLocaleString()]})]}),l.jsxs("div",{className:"p-3 rounded-xl bg-white dark:bg-gray-800/60 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col items-start",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-6 h-6 bg-orange-100 dark:bg-orange-900/50 rounded-lg flex items-center justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-orange-600 dark:text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})})}),l.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Growth Rate"})]}),l.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["+",x.fastestGrowth,"%"]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Year over Year"})]})]})})]})]})}const im=(e,t=2e3)=>{const[r,n]=W.useState(0);return W.useEffect(()=>{let a;const f=i=>{a||(a=i);const x=Math.min((i-a)/t,1),w=1-Math.pow(1-x,4),A=Math.floor(0+(e-0)*w);n(A),x<1&&requestAnimationFrame(f)};requestAnimationFrame(f)},[e,t]),r};function lUe(){var Pe,Ne,pe,je,xe,Ce,ze,Te,Re,Fe,He,mt,Xe,ot,qe,Lt,Zt,Xt,rr,ir,Bt;const[e,t]=W.useState(""),[r,n]=W.useState(""),[a,c]=W.useState(null),[f,i]=W.useState(!1),[x,w]=W.useState(null),A=im(((Pe=a==null?void 0:a.vehicles)==null?void 0:Pe.total)||0),P=im(((Ne=a==null?void 0:a.vehicles)==null?void 0:Ne.active)||0),E=im(((pe=a==null?void 0:a.vehicles)==null?void 0:pe.expired)||0),D=im(((je=a==null?void 0:a.drivers)==null?void 0:je.total)||0),V=im(((xe=a==null?void 0:a.drivers)==null?void 0:xe.withLicense)||0),L=im(((Ce=a==null?void 0:a.drivers)==null?void 0:Ce.withoutLicense)||0),$=im(((ze=a==null?void 0:a.plateClassification)==null?void 0:ze.total)||0),H=im(((Te=a==null?void 0:a.plateClassification)==null?void 0:Te.permanent)||0),K=im(((Re=a==null?void 0:a.plateClassification)==null?void 0:Re.temporary)||0),Q=["All","January","February","March","April","May","June","July","August","September","October","November","December"],ae=new Date().getFullYear(),ee=["All",...Array.from({length:7},(De,jr)=>(ae+jr).toString())],se=De=>{t(De)},ce=De=>{n(De)},he=async(De,jr)=>{try{i(!0),w(null);let Dt=null,Cr=null;De&&De!=="All"&&(Dt=IN(De)),jr&&jr!=="All"&&(Cr=jr);const At=await ZVe(Dt,Cr);At.success?c(At.data):w("Failed to fetch analytics data")}catch(Dt){console.error("Error fetching analytics data:",Dt),w("Error loading analytics data")}finally{i(!1)}};return W.useEffect(()=>{he("All","All")},[]),W.useEffect(()=>{e||r?he(e,r):he("All","All")},[e,r]),l.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-transparent min-h-screen rounded-lg",children:[l.jsxs("div",{className:"registration-analytics-header",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"registration-analytics-title animate-in slide-in-from-top-5 fade-in duration-700 flex items-center gap-2",children:[l.jsx(Ld,{className:"h-8 w-8 text-blue-500 animate-pulse"}),"Registration Analytics"]}),l.jsx("p",{className:"registration-analytics-subtitle",children:"Vehicle and Owners Registration Analytics"})]}),f?l.jsxs("div",{className:"registration-analytics-controls",children:[l.jsx("div",{className:"animate-pulse",children:l.jsx("div",{className:"h-8 bg-muted rounded w-32"})}),l.jsx("div",{className:"animate-pulse",children:l.jsx("div",{className:"h-8 bg-muted rounded w-32"})})]}):l.jsxs("div",{className:"registration-analytics-controls",children:[l.jsxs(Uo,{value:e||"",onValueChange:se,children:[l.jsx(So,{className:"w-[140px]",children:l.jsx($o,{placeholder:"Month"})}),l.jsx(Ao,{children:Q.map(De=>l.jsx(pn,{value:De,children:De},De))})]}),l.jsxs(Uo,{value:r||"",onValueChange:ce,children:[l.jsx(So,{className:"w-[120px]",children:l.jsx($o,{placeholder:"Year"})}),l.jsx(Ao,{children:ee.map(De=>l.jsx(pn,{value:De,children:De},De))})]})]})]}),x&&l.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:l.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:x})}),f?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-card border border-border rounded-lg",children:[l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-24"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(De=>l.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"h-4 bg-muted rounded w-32 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),l.jsx("div",{className:"h-3 bg-muted rounded w-24"})]}),l.jsx("div",{className:"w-12 h-12 bg-muted rounded"})]}),l.jsx("div",{className:"h-1 bg-muted rounded w-full"})]})},De))}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(De=>l.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),l.jsx("div",{className:"h-64 bg-muted rounded"})]})},De))}),l.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-40 mb-4"}),l.jsx("div",{className:"h-96 bg-muted rounded"})]})})]}):l.jsx("div",{className:"registration-analytics-fade-in animate-in slide-in-from-bottom-5 fade-in duration-700",children:l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[l.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-red-300 dark:hover:border-red-600 overflow-hidden",children:[l.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-pink-100 dark:bg-pink-900/30 rounded-full opacity-60"}),l.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-red-200 dark:bg-red-800/40 rounded-full opacity-40"}),l.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-red-400/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"REGISTERED VEHICLES"})]}),l.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:f?"...":A})]}),l.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:l.jsxs("svg",{className:"w-6 h-6 text-red-500 group-hover:text-red-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"}),l.jsx("circle",{cx:"7",cy:"17",r:"2"}),l.jsx("path",{d:"M9 17h6"}),l.jsx("circle",{cx:"17",cy:"17",r:"2"})]})})]}),l.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[l.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[f?"...":P," Active"]}),l.jsx("span",{className:"mx-2",children:"•"}),l.jsxs("span",{className:"text-red-600 dark:text-red-400 font-medium",children:[f?"...":E," Expired"]})]}),l.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[l.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm animate-pulse",style:{width:`${Math.min((((Fe=a==null?void 0:a.vehicles)==null?void 0:Fe.active)||0)/(((He=a==null?void 0:a.vehicles)==null?void 0:He.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),l.jsx("div",{className:"bg-gradient-to-r from-red-400 to-red-600 h-0.5 transition-all duration-1000 ease-out shadow-sm animate-pulse",style:{width:`${Math.min((((mt=a==null?void 0:a.vehicles)==null?void 0:mt.expired)||0)/(((Xe=a==null?void 0:a.vehicles)==null?void 0:Xe.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]}),l.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 overflow-hidden",children:[l.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-blue-100 dark:bg-blue-900/30 rounded-full opacity-60"}),l.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-blue-200 dark:bg-blue-800/40 rounded-full opacity-40"}),l.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"REGISTERED OWNERS"})]}),l.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:f?"...":D})]}),l.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:l.jsx("svg",{className:"w-6 h-6 text-blue-500 group-hover:text-blue-600 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]}),l.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[l.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[f?"...":V," With License"]}),l.jsx("span",{className:"mx-2",children:"•"}),l.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[f?"...":L," Without License"]})]}),l.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[l.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((ot=a==null?void 0:a.drivers)==null?void 0:ot.withLicense)||0)/(((qe=a==null?void 0:a.drivers)==null?void 0:qe.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),l.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Lt=a==null?void 0:a.drivers)==null?void 0:Lt.withoutLicense)||0)/(((Zt=a==null?void 0:a.drivers)==null?void 0:Zt.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]}),l.jsxs("div",{className:"group relative bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:-translate-y-1 transition-all duration-300 dark:!bg-transparent dark:!border-gray-700 hover:border-purple-300 dark:hover:border-purple-600 overflow-hidden",children:[l.jsx("div",{className:"absolute -top-8 -right-8 w-24 h-24 bg-purple-100 dark:bg-purple-900/30 rounded-full opacity-60"}),l.jsx("div",{className:"absolute -top-4 -right-4 w-16 h-16 bg-purple-200 dark:bg-purple-800/40 rounded-full opacity-40"}),l.jsx("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-purple-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l.jsxs("div",{className:"relative z-10 flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"PLATE CLASSIFICATION"})]}),l.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white drop-shadow-sm",children:f?"...":$})]}),l.jsx("div",{className:"w-12 h-12 flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:l.jsxs("svg",{className:"w-6 h-6 text-purple-500 group-hover:text-purple-600 transition-colors duration-300",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 24 24",children:[l.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2",ry:"2"}),l.jsx("rect",{x:"4",y:"8",width:"16",height:"8",rx:"1",ry:"1"}),l.jsx("path",{d:"M8 10h2"}),l.jsx("path",{d:"M12 10h2"}),l.jsx("path",{d:"M16 10h2"}),l.jsx("path",{d:"M8 12h2"}),l.jsx("path",{d:"M12 12h2"}),l.jsx("path",{d:"M16 12h2"})]})})]}),l.jsxs("div",{className:"relative z-10 flex items-center text-xs text-gray-600 dark:text-gray-400 mb-3",children:[l.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium",children:[f?"...":H," Permanent"]}),l.jsx("span",{className:"mx-2",children:"•"}),l.jsxs("span",{className:"text-purple-400 dark:text-purple-400 font-medium",children:[f?"...":K," Temporary"]})]}),l.jsxs("div",{className:"relative z-10 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 flex overflow-hidden shadow-inner",children:[l.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((Xt=a==null?void 0:a.plateClassification)==null?void 0:Xt.permanent)||0)/(((rr=a==null?void 0:a.plateClassification)==null?void 0:rr.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out"}}),l.jsx("div",{className:"bg-gradient-to-r from-purple-400 to-purple-600 h-0.5 transition-all duration-1000 ease-out shadow-sm",style:{width:`${Math.min((((ir=a==null?void 0:a.plateClassification)==null?void 0:ir.temporary)||0)/(((Bt=a==null?void 0:a.plateClassification)==null?void 0:Bt.total)||1)*100,100)}%`,animation:"slideInFromLeft 1.5s ease-out 0.3s both"}})]})]})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 mb-6",children:[l.jsx("div",{className:"flex-1 lg:flex-1",children:l.jsx(nUe,{selectedMonth:e,selectedYear:r,loading:f})}),l.jsx("div",{className:"flex-1 lg:flex-1",children:l.jsx(iUe,{})})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[l.jsx("div",{className:"flex-1 lg:flex-1",children:l.jsx(sUe,{selectedMonth:e,selectedYear:r,loading:f})}),l.jsx("div",{className:"flex-1 lg:flex-1",children:l.jsx(aUe,{selectedMonth:e,selectedYear:r,loading:f})})]})]})}),l.jsx(oUe,{})]})}function cUe(){return l.jsx("div",{children:l.jsx(lUe,{})})}const uUe=async(e={},t=null)=>{try{const r=new URLSearchParams;t&&r.append("year",t),e&&typeof e=="object"&&Object.keys(e).forEach(f=>{e[f]!==null&&e[f]!==void 0&&r.append(f,e[f])});const n=r.toString(),a=`/violations/analytics${n?`?${n}`:""}`;return(await xn.get(a)).data}catch(r){throw console.error("Error fetching violation analytics:",r),r}},iA=({value:e,duration:t=2e3,className:r=""})=>{const[n,a]=W.useState(0),[c,f]=W.useState(!1),i=W.useRef(null);return W.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&f(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),W.useEffect(()=>{if(c){let x;const w=A=>{x||(x=A);const P=Math.min((A-x)/t,1),E=1-Math.pow(1-P,4),D=Math.floor(e*E);a(D),P<1?requestAnimationFrame(w):a(e)};requestAnimationFrame(w)}},[e,t,c]),l.jsx("div",{ref:i,className:`${r} transition-all duration-500 ${c?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"}`,children:n.toLocaleString()})},aA=({percentage:e,color:t="bg-blue-500",delay:r=0})=>{const[n,a]=W.useState(0),[c,f]=W.useState(!1),i=W.useRef(null);return W.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&f(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),W.useEffect(()=>{c&&setTimeout(()=>{a(e)},r)},[c,e,r]),l.jsx("div",{ref:i,className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-0.5 overflow-hidden",children:l.jsx("div",{className:`h-full ${t} rounded-full shadow-sm transition-all duration-1000 ease-out`,style:{width:`${n}%`}})})};function dUe({displayData:e,loading:t,totalViolations:r,totalTrafficViolators:n,topOfficer:a,mostCommonViolation:c}){const{theme:f}=wD(),i=f==="dark"||f==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches;return t?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[...Array(4)].map((x,w)=>l.jsx("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl p-6 animate-pulse`,children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:`h-4 ${i?"bg-gray-700":"bg-gray-200"} rounded mb-2`}),l.jsx("div",{className:`h-8 ${i?"bg-gray-700":"bg-gray-200"} rounded mb-1`}),l.jsx("div",{className:`h-3 ${i?"bg-gray-700":"bg-gray-200"} rounded`})]}),l.jsx("div",{className:"ml-4",children:l.jsx("div",{className:`w-12 h-12 ${i?"bg-gray-700":"bg-gray-200"} rounded-full`})})]})},w))}):l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[l.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-blue-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-blue-500/30 to-blue-600/15":"bg-gradient-to-br from-blue-500/10 to-blue-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"flex items-center space-x-2 mb-1",children:l.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Total Violations"})}),l.jsx(iA,{value:r,className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",duration:1500}),l.jsx("p",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"All time recorded violations"}),l.jsx(aA,{percentage:100,color:"bg-gradient-to-r from-blue-500 to-blue-600",delay:200})]}),l.jsx("div",{className:"ml-3",children:l.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})})]})]}),l.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-green-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-green-500/30 to-green-600/15":"bg-gradient-to-br from-green-500/10 to-green-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"flex items-center space-x-2 mb-1",children:l.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Traffic Violators"})}),l.jsx(iA,{value:n,className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",duration:1800}),l.jsx("p",{className:"text-xs font-medium text-green-600 dark:text-green-400",children:"People"}),l.jsx(aA,{percentage:100,color:"bg-gradient-to-r from-green-500 to-green-600",delay:400})]}),l.jsx("div",{className:"ml-3",children:l.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})})]})]}),l.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-red-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-red-500/30 to-red-600/15":"bg-gradient-to-br from-red-500/10 to-red-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"flex items-center space-x-2 mb-1",children:l.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Most Common Violation"})}),l.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white mb-1 truncate",title:(c==null?void 0:c._id)||"N/A",children:(c==null?void 0:c._id)||"N/A"}),l.jsxs("p",{className:"text-xs font-medium text-red-600 dark:text-red-400",children:[l.jsx(iA,{value:(c==null?void 0:c.count)||0,className:"inline",duration:1600})," ","occurrences"]}),l.jsx(aA,{percentage:Math.min(((c==null?void 0:c.count)||0)/(((c==null?void 0:c.count)||0)+((c==null?void 0:c.count)||0)*.7)*100,100),color:"bg-gradient-to-r from-red-500 to-red-600",delay:600})]}),l.jsx("div",{className:"ml-3",children:l.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})})]})]}),l.jsxs("div",{className:`${i?"bg-black border-gray-600":"bg-white border-gray-200"} border rounded-xl shadow-lg p-4 hover:shadow-xl hover:shadow-purple-500/30 hover:-translate-y-1 transition-all duration-300 transform relative overflow-hidden group`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-20 h-20 ${i?"bg-gradient-to-br from-purple-500/30 to-purple-600/15":"bg-gradient-to-br from-purple-500/10 to-purple-600/5"} rounded-full -translate-y-4 translate-x-4 group-hover:scale-110 transition-transform duration-300`}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"flex items-center space-x-2 mb-1",children:l.jsx("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:"Top Officer"})}),l.jsx("p",{className:"text-lg font-bold text-gray-900 dark:text-white truncate mb-1",children:(a==null?void 0:a.officerName)||"N/A"}),l.jsxs("p",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:[l.jsx(iA,{value:(a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0,className:"inline",duration:2e3})," ","apprehensions"]}),l.jsx(aA,{percentage:Math.min(((a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0)/(((a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0)+((a==null?void 0:a.count)||(a==null?void 0:a.violationCount)||0)*.8)*100,100),color:"bg-gradient-to-r from-purple-500 to-purple-600",delay:800})]}),l.jsx("div",{className:"ml-3",children:l.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:l.jsx("svg",{className:"w-6 h-6 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})})]})]})]})}function hUe({data:e,title:t,type:r,loading:n,totalCount:a}){const f=!e||e.length===0?[]:e.slice(0,5).map((x,w)=>({name:r==="officers"?x.officerName||"Unknown Officer":x._id||"Unknown Item",value:x.count||x.violationCount||0,rank:w+1})),i=({active:x,payload:w,label:A})=>{if(x&&w&&w.length){const P=w[0].payload;return l.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-lg px-4 py-3 shadow-lg min-w-[180px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs font-bold text-gray-900 dark:text-white mb-1",children:A}),l.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-1",children:[l.jsx("div",{className:"text-sm font-bold text-violet-600 dark:text-violet-400",children:P.value.toLocaleString()}),l.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:r==="officers"?"apprehensions":"violations"})]}),l.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:["Rank #",P.rank]})]})})}return null};return n?l.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 h-full flex flex-col",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("div",{className:"h-6 w-48 bg-gray-200 dark:bg-gray-700 rounded"}),l.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"})]})]}),l.jsx("div",{className:"space-y-4",children:[...Array(5)].map((x,w)=>l.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-700 rounded-xl",children:[l.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsx("div",{className:"h-4 w-32 bg-gray-200 dark:bg-gray-700 rounded"}),l.jsx("div",{className:"h-3 w-24 bg-gray-200 dark:bg-gray-700 rounded"})]}),l.jsx("div",{className:"w-16 h-8 bg-gray-200 dark:bg-gray-700 rounded"})]}),l.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"})]},w))})]})}):!e||e.length===0?l.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 h-full flex flex-col",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:t}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Performance Analytics"})]})]}),l.jsxs("div",{className:"text-center py-16 text-gray-500 dark:text-gray-400 flex-1 flex flex-col justify-center",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center shadow-lg",children:l.jsx("svg",{className:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsx("h4",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"No Data Available"}),l.jsxs("p",{className:"text-sm",children:["No ",r==="officers"?"officer":"violation"," data to display"]})]})]}):l.jsxs("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg p-4 hover:shadow-xl transition-all duration-300 h-full flex flex-col",style:{minHeight:"400px"},children:[l.jsx("div",{className:"flex items-center mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-500 rounded-lg flex items-center justify-center shadow-md",children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:t}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Performance Rankings"})]})]})}),l.jsx("div",{className:"flex-1 flex flex-col",style:{minHeight:"320px"},children:l.jsx(_o,{width:"100%",height:350,children:l.jsxs(Cu,{data:f,margin:{top:20,right:30,left:20,bottom:40},children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),l.jsx(Oa,{dataKey:"name",stroke:"#6b7280",fontSize:11,angle:-45,textAnchor:"end",height:80,interval:0}),l.jsx(Ra,{stroke:"#6b7280"}),l.jsx(ta,{content:l.jsx(i,{})}),l.jsx(ds,{dataKey:"value",radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200",children:f.map((x,w)=>l.jsx(Kh,{fill:"url(#violetPinkGradient)"},`cell-${w}`))}),l.jsx("defs",{children:l.jsxs("linearGradient",{id:"violetPinkGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[l.jsx("stop",{offset:"0%",stopColor:"#8B5CF6"}),l.jsx("stop",{offset:"50%",stopColor:"#A855F7"}),l.jsx("stop",{offset:"100%",stopColor:"#EC4899"})]})})]})})}),f.length<5&&l.jsx("div",{className:"mt-4 text-center",children:l.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-full",children:[l.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-pulse"}),l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:["Only ",f.length," ",r==="officers"?"officers":"items"," available"]})]})})]})}function fUe({data:e,title:t,loading:r}){const[n,a]=W.useState(null),[c,f]=W.useState([]);if(r)return l.jsx("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-4"}),l.jsx("div",{className:"flex items-center justify-center",children:l.jsx("div",{className:"w-48 h-48 bg-gray-200 dark:bg-gray-700 rounded-full"})}),l.jsx("div",{className:"mt-6 space-y-3",children:[...Array(5)].map((H,K)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),l.jsx("div",{className:"flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"}),l.jsx("div",{className:"w-12 h-4 bg-gray-200 dark:bg-gray-700 rounded"})]},K))})]})});if(!e||e.length===0)return l.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:t}),l.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:l.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),l.jsx("p",{children:"No data available"})]})]});const i=e.reduce((H,K)=>H+(K.count||0),0),x=e.slice(0,5);let w=0;const A=x.map((H,K)=>{const Q=H.count||0,ae=i>0?Q/i*100:0,ee=w,se=w+ae/100*360;return w=se,{...H,percentage:ae,startAngle:ee,endAngle:se,index:K}}),P=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6"],E=["url(#gradient1)","url(#gradient2)","url(#gradient3)","url(#gradient4)","url(#gradient5)"],D=H=>P[H]||"#6B7280",V=H=>E[H]||P[H]||"#6B7280";W.useEffect(()=>{const H=setTimeout(()=>{f(A)},100);return()=>clearTimeout(H)},[A]);const L=(H,K,Q=80)=>{const se=$(100,100,Q,K),ce=$(100,100,Q,H),he=K-H<=180?"0":"1";return["M",100,100,"L",se.x,se.y,"A",Q,Q,0,he,0,ce.x,ce.y,"Z"].join(" ")},$=(H,K,Q,ae)=>{const ee=(ae-90)*Math.PI/180;return{x:H+Q*Math.cos(ee),y:K+Q*Math.sin(ee)}};return l.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300 relative overflow-hidden h-full flex flex-col",style:{minHeight:"400px"},children:l.jsxs("div",{className:"relative z-10",children:[l.jsxs("h3",{className:"text-base font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-md mr-3",children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"})})}),t]}),l.jsxs("div",{className:"flex flex-col lg:flex-row items-start space-y-5 lg:space-y-0 lg:space-x-1",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsxs("svg",{width:"220",height:"220",viewBox:"0 0 200 200",className:"mx-auto drop-shadow-lg",children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"gradient1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#3B82F6"}),l.jsx("stop",{offset:"100%",stopColor:"#1D4ED8"})]}),l.jsxs("linearGradient",{id:"gradient2",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#10B981"}),l.jsx("stop",{offset:"100%",stopColor:"#047857"})]}),l.jsxs("linearGradient",{id:"gradient3",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#F59E0B"}),l.jsx("stop",{offset:"100%",stopColor:"#D97706"})]}),l.jsxs("linearGradient",{id:"gradient4",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#EF4444"}),l.jsx("stop",{offset:"100%",stopColor:"#DC2626"})]}),l.jsxs("linearGradient",{id:"gradient5",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8B5CF6"}),l.jsx("stop",{offset:"100%",stopColor:"#7C3AED"})]})]}),c.map((H,K)=>l.jsx("path",{d:L(H.startAngle,H.endAngle),fill:V(K),stroke:"white",strokeWidth:"3",className:`transition-all duration-300 cursor-pointer ${n===K?"opacity-90 transform scale-1.05":"opacity-100 hover:opacity-90"}`,onMouseEnter:()=>a(K),onMouseLeave:()=>a(null),style:{filter:n===K?"drop-shadow(0 4px 8px rgba(0,0,0,0.2))":"none"}},K)),l.jsx("circle",{cx:"100",cy:"100",r:"45",fill:"white",className:"dark:fill-black drop-shadow-md"}),l.jsx("circle",{cx:"100",cy:"100",r:"40",fill:"url(#centerGradient)",className:"drop-shadow-sm"}),l.jsx("defs",{children:l.jsxs("radialGradient",{id:"centerGradient",cx:"50%",cy:"50%",r:"50%",children:[l.jsx("stop",{offset:"0%",stopColor:"#F8FAFC"}),l.jsx("stop",{offset:"100%",stopColor:"#E2E8F0"})]})}),l.jsx("text",{x:"100",y:"93",textAnchor:"middle",className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Total"}),l.jsx("text",{x:"100",y:"118",textAnchor:"middle",className:"text-xl font-black text-gray-900 dark:text-white",children:i.toLocaleString()})]})}),l.jsx("div",{className:"flex-1 space-y-3 min-w-0",children:A.map((H,K)=>{var Q;return l.jsxs("div",{className:`flex items-center justify-between py-1 px-2 border-2 rounded-lg transition-all duration-300 cursor-pointer ${n===K?"border-blue-300 dark:border-blue-600 bg-blue-50 dark:bg-blue-900/20 shadow-lg transform scale-105":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 hover:bg-gray-50 dark:hover:bg-gray-800"}`,onMouseEnter:()=>a(K),onMouseLeave:()=>a(null),children:[l.jsxs("div",{className:"flex items-center space-x-1 min-w-0 flex-1",children:[l.jsxs("div",{className:"relative flex-shrink-0",children:[l.jsx("div",{className:"w-4 h-4 rounded-full shadow-md",style:{backgroundColor:D(K)}}),n===K&&l.jsx("div",{className:"absolute inset-0 w-4 h-4 rounded-full animate-ping opacity-75",style:{backgroundColor:D(K)}})]}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("p",{className:"text-xs font-bold text-gray-900 dark:text-white break-words",children:H._id||"Unknown"}),l.jsxs("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 break-words",style:{fontSize:"0.65rem"},children:[H.percentage.toFixed(1),"% of total"]})]})]}),l.jsxs("div",{className:"text-right flex-shrink-0 ml-1",children:[l.jsx("div",{className:"text-xs font-black text-gray-900 dark:text-white",children:((Q=H.count)==null?void 0:Q.toLocaleString())||0}),l.jsxs("div",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400",style:{fontSize:"0.65rem"},children:["violation",H.count!==1?"s":""]})]})]},K)})})]}),x.length<5&&l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:[l.jsx("svg",{className:"w-4 h-4 text-blue-600 dark:text-blue-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:["Only ",x.length," violation types available"]})]})})]})})}function pUe({displayData:e,loading:t,currentViolations:r,startIndex:n,endIndex:a,totalViolationItems:c,currentPage:f,totalPages:i,handlePrevPage:x,handleNextPage:w}){return t?l.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),l.jsx("div",{className:"space-y-3",children:[...Array(5)].map((A,P)=>l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-8 h-8 bg-muted rounded"}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsx("div",{className:"h-4 bg-muted rounded"}),l.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]}),l.jsx("div",{className:"w-16 h-6 bg-muted rounded"})]},P))})]})}):l.jsxs("div",{className:"bg-white dark:bg-black border-2 border-gray-300 dark:border-gray-800 rounded-lg shadow-md p-6",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-900 to-violet-600 rounded-lg flex items-center justify-center shadow-md",children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2.5,children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})})}),l.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Top Violations Ranking"})]}),r.length>0?l.jsx("div",{className:"space-y-3 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:r.map((A,P)=>{const E=n+P+1,D=L=>"bg-gradient-to-br from-blue-900 to-violet-600 text-white shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300",V=L=>L;return l.jsxs("div",{className:"flex items-center space-x-4 p-3 border-2 border-gray-300 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-900 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-lg transition-all duration-300 bg-white dark:bg-gray-900 group",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${D()}`,children:V(E)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors duration-300",children:A._id||"Unknown Violation"}),l.jsxs("p",{className:"text-xs bg-gradient-to-r from-blue-900 to-violet-600 bg-clip-text text-transparent font-medium group-hover:from-blue-700 group-hover:to-violet-500 transition-all duration-300",children:[A.count||0," occurrences"]}),l.jsx("div",{className:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-purple-400 to-pink-400 rounded-full shadow-sm transition-all duration-500 group-hover:shadow-md",style:{width:`${Math.min((A.count||0)/Math.max(...r.map(L=>L.count||0))*100,100)}%`}})})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-white group-hover:text-blue-700 dark:group-hover:text-blue-300 transition-colors duration-300",children:A.count||0}),l.jsx("div",{className:"text-xs bg-gradient-to-r from-violet-600 to-purple-600 bg-clip-text text-transparent font-medium group-hover:from-violet-500 group-hover:to-purple-500 transition-all duration-300",children:"violations"})]})]},A._id||P)})}):l.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:l.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),l.jsx("p",{children:"No violation data available"})]}),r.length>0&&i>1&&l.jsx("div",{className:"mt-6 pt-4 border-t-2 border-gray-300 dark:border-gray-600",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Showing ",n+1," to ",Math.min(a,c)," of ",c," violations"]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Page ",f," of ",i]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("button",{onClick:x,disabled:f===1,className:"px-3 py-1.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-900 to-violet-600 hover:from-blue-800 hover:to-violet-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),l.jsx("span",{children:"Previous"})]}),l.jsxs("button",{onClick:w,disabled:f===i,className:"px-3 py-1.5 text-sm font-semibold text-white bg-gradient-to-r from-blue-900 to-violet-600 hover:from-blue-800 hover:to-violet-700 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-lg shadow-md transition-all duration-200 flex items-center space-x-1",children:[l.jsx("span",{children:"Next"}),l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]})})]})}function mUe({displayData:e,loading:t,getCombinationRecommendation:r}){const[n,a]=W.useState("combinations"),[c,f]=W.useState(1),i=5;if(t)return l.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-xl shadow-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded mb-6"}),l.jsxs("div",{className:"overflow-hidden",children:[l.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 rounded h-8 mb-4"}),l.jsx("div",{className:"space-y-3",children:[...Array(5)].map((ee,se)=>l.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-lg"}),l.jsxs("div",{className:"flex-1 space-y-2",children:[l.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),l.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]})]})},se))})]})]})});const x=(e==null?void 0:e.violationCombinations)||[],w=(e==null?void 0:e.violationPatterns)||[],A=n==="combinations"?x.length:w.length,P=Math.ceil(A/i),E=(c-1)*i,D=E+i,V=x.slice(E,D),L=w.slice(E,D),$=()=>{f(ee=>Math.max(ee-1,1))},H=()=>{f(ee=>Math.min(ee+1,P))},K=ee=>{a(ee),f(1)},Q=ee=>ee>=50?"text-white bg-red-500 shadow-lg shadow-red-500/30 border-2 border-red-400":ee>=20?"text-white bg-orange-500 shadow-lg shadow-orange-500/30 border-2 border-orange-400":"text-white bg-yellow-500 shadow-lg shadow-yellow-500/30 border-2 border-yellow-400",ae=ee=>ee>=50?l.jsx(Hc,{className:"w-4 h-4"}):ee>=20?l.jsx(qg,{className:"w-4 h-4"}):l.jsx(eD,{className:"w-4 h-4"});return l.jsxs("div",{className:"bg-white dark:bg-black border-2 border-blue-200 dark:border-blue-800 rounded-xl shadow-lg overflow-hidden",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-100 to-indigo-100 dark:from-blue-800 dark:to-indigo-800 px-4 py-3 border-b-2 border-blue-300 dark:border-blue-700",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center shadow-lg",children:l.jsx(Px,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Violation Analysis"}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Combinations & Recommended Actions"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 bg-white dark:bg-gray-800 rounded-lg p-1 shadow-sm",children:[l.jsxs("button",{onClick:()=>K("combinations"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 ${n==="combinations"?"bg-blue-500 text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[l.jsx(Ld,{className:"w-4 h-4 inline mr-1"}),"Combinations"]}),l.jsxs("button",{onClick:()=>K("patterns"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all duration-200 ${n==="patterns"?"bg-blue-500 text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[l.jsx(qg,{className:"w-4 h-4 inline mr-1"}),"Patterns"]})]})]})}),l.jsx("div",{className:"p-4",children:x.length>0||w.length>0?l.jsxs("div",{className:"space-y-2",children:[n==="combinations"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-blue-100 dark:bg-blue-800/30 rounded-lg p-3 border-2 border-blue-300 dark:border-blue-700",children:l.jsxs("div",{className:"grid grid-cols-12 gap-4 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:[l.jsx("div",{className:"col-span-1",children:"#"}),l.jsx("div",{className:"col-span-4",children:"Violation Types"}),l.jsx("div",{className:"col-span-2",children:"Occurrences"}),l.jsx("div",{className:"col-span-2",children:"Severity"}),l.jsx("div",{className:"col-span-3",children:"Recommended Action"})]})}),V.map((ee,se)=>{const ce=ee.violations||[],he=ee.count||0,Pe=r(ce),Ne=E+se+1;return l.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/10 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-3 hover:shadow-md hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-200",children:l.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[l.jsx("div",{className:"col-span-1",children:l.jsx("div",{className:"w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:Ne})})}),l.jsx("div",{className:"col-span-4",children:l.jsx("div",{className:"flex flex-wrap gap-1",children:ce.map((pe,je)=>l.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 border border-red-200 dark:border-red-800",children:pe},je))})}),l.jsx("div",{className:"col-span-2",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(tD,{className:"w-5 h-5 text-blue-600 dark:text-blue-400",strokeWidth:2.5}),l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:he.toLocaleString()})]})}),l.jsx("div",{className:"col-span-2",children:l.jsxs("div",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-bold ${Q(he)} transform hover:scale-105 transition-all duration-200`,children:[ae(he),l.jsx("span",{children:he>=50?"High":he>=20?"Medium":"Low"})]})}),l.jsx("div",{className:"col-span-3",children:l.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[l.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-300 font-medium mb-1",children:"Action Required:"}),l.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-400 leading-relaxed",children:Pe})]})})]})},se)})]}),n==="patterns"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-blue-100 dark:bg-blue-800/30 rounded-lg p-3 border-2 border-blue-300 dark:border-blue-700",children:l.jsxs("div",{className:"grid grid-cols-12 gap-4 text-xs font-semibold text-gray-600 dark:text-gray-400 uppercase tracking-wide",children:[l.jsx("div",{className:"col-span-1",children:"#"}),l.jsx("div",{className:"col-span-4",children:"Pattern Name"}),l.jsx("div",{className:"col-span-2",children:"Frequency"}),l.jsx("div",{className:"col-span-2",children:"Status"}),l.jsx("div",{className:"col-span-3",children:"Analysis"})]})}),L.map((ee,se)=>{const ce=ee.pattern||"Unknown Pattern",he=ee.frequency||0,Pe=ee.description||"No description available",Ne=E+se+1;return l.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/10 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-3 hover:shadow-md hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-200",children:l.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[l.jsx("div",{className:"col-span-1",children:l.jsx("div",{className:"w-8 h-8 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-sm font-bold text-gray-600 dark:text-gray-300",children:Ne})})}),l.jsxs("div",{className:"col-span-4",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-1",children:ce}),l.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 leading-relaxed",children:Pe})]}),l.jsx("div",{className:"col-span-2",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(qg,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),l.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:he.toLocaleString()})]})}),l.jsx("div",{className:"col-span-2",children:l.jsx("div",{className:`inline-flex items-center space-x-1 px-2 py-0.5 rounded-full text-xs font-medium ${he>=30?"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-400":he>=15?"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20 dark:text-yellow-400":"text-gray-600 bg-gray-50 dark:bg-gray-900/20 dark:text-gray-400"}`,children:l.jsx("span",{children:he>=30?"Active":he>=15?"Moderate":"Low"})})}),l.jsx("div",{className:"col-span-3",children:l.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-3",children:[l.jsx("p",{className:"text-xs text-indigo-800 dark:text-indigo-300 font-medium mb-1",children:"Pattern Analysis:"}),l.jsx("p",{className:"text-xs text-indigo-700 dark:text-indigo-400 leading-relaxed",children:"Recurring violation behaviors requiring targeted enforcement strategies."})]})})]})},`pattern-${se}`)})]}),P>1&&l.jsxs("div",{className:"flex justify-center items-center pt-3 space-x-4",children:[l.jsxs("button",{onClick:$,disabled:c===1,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ${c===1?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600 shadow-sm"}`,children:[l.jsx(Q3,{className:"w-4 h-4"}),l.jsx("span",{children:"Previous"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",c," of ",P]}),l.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-500",children:["(",A," total items)"]})]}),l.jsxs("button",{onClick:H,disabled:c===P,className:`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all duration-200 ${c===P?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600 shadow-sm"}`,children:[l.jsx("span",{children:"Next"}),l.jsx(L0,{className:"w-4 h-4"})]})]})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:l.jsx(Px,{className:"w-10 h-10 text-gray-400"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Data Available"}),l.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"No violation combination data found for the selected period."})]})})]})}function gUe({displayData:e,loading:t,setIsLineChartModalOpen:r,currentViolations:n,startIndex:a,endIndex:c,totalViolationItems:f,currentPage:i,totalPages:x,handlePrevPage:w,handleNextPage:A,getCombinationRecommendation:P}){var he,Pe,Ne,pe,je,xe,Ce,ze,Te;const{theme:E}=wD(),D=E==="dark"||E==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches,[V,L]=W.useState(null),[$,H]=W.useState({x:0,y:0}),[K,Q]=W.useState(!1),ae=W.useRef(null);if(t)return l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[l.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),l.jsx("div",{className:"h-64 bg-muted rounded"})]})}),l.jsx("div",{className:"bg-white dark:bg-black border border-gray-200 dark:border-gray-800 rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded mb-4"}),l.jsx("div",{className:"h-64 bg-muted rounded"})]})})]});const ee=(e==null?void 0:e.violationsByType)||[];ee.reduce((Re,Fe)=>Re+(Fe.count||0),0);const ce=((e==null?void 0:e.yearlyTrends)||[]).filter(Re=>{var He;const Fe=((He=Re._id)==null?void 0:He.year)||0;return Fe>=2020&&Fe<=2025});return Math.max(...ce.map(Re=>Re.count||0),1),l.jsxs("div",{className:"space-y-6 mb-8",children:[l.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-black dark:to-black border-2 border-gray-200 dark:border-gray-800 rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300",children:l.jsx("div",{className:"relative",children:ce.length>0?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-lg",children:l.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsxs("div",{children:[l.jsx("h4",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Violation Trends Analysis"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Historical data from 2020-2025"})]})]}),ce.length>5&&l.jsxs("button",{onClick:()=>r(!0),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg hover:from-blue-600 hover:to-purple-700 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[l.jsx("span",{className:"text-sm font-medium",children:"View More"}),l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]}),l.jsxs("div",{className:"flex gap-6",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"relative bg-white dark:bg-black rounded-xl shadow-lg border border-gray-100 dark:border-gray-800 overflow-hidden",children:[l.jsx("svg",{ref:ae,width:"100%",height:"350",className:"relative",onMouseLeave:()=>{Q(!1),L(null)},children:(()=>{const Re=ce.sort((tt,xt)=>{var Mt,lr;return(((Mt=tt._id)==null?void 0:Mt.year)||0)-(((lr=xt._id)==null?void 0:lr.year)||0)});if(Re.length===0)return null;const Fe=800,He=350,mt=80,Xe=Fe-mt*2,ot=He-mt*2,qe=Re.map(tt=>{var xt;return((xt=tt._id)==null?void 0:xt.year)||0}),Lt=Re.map(tt=>tt.count||0),Zt=Math.min(...qe),rr=Math.max(...qe)-Zt||1,ir=Math.min(...Lt),Bt=Math.max(...Lt),jr=(Bt-ir||1)*.1,Dt=Math.max(0,ir-jr),At=Bt+jr-Dt,qr=Re.map((tt,xt)=>{var ur;const Mt=((ur=tt._id)==null?void 0:ur.year)||0,lr=tt.count||0,cr=mt+(Mt-Zt)/rr*Xe,xr=mt+ot-(lr-Dt)/At*ot;return{x:cr,y:xr,year:Mt,count:lr}}),an=qr.reduce((tt,xt,Mt)=>Mt===0?`M ${xt.x} ${mt+ot} L ${xt.x} ${xt.y}`:`${tt} L ${xt.x} ${xt.y}`,"")+` L ${qr[qr.length-1].x} ${mt+ot} Z`,Jn=qr.reduce((tt,xt,Mt)=>{if(Mt===0)return`M ${xt.x} ${xt.y}`;const lr=qr[Mt-1],cr=lr.x+(xt.x-lr.x)/3,xr=lr.y,ur=xt.x-(xt.x-lr.x)/3,tn=xt.y;return`${tt} C ${cr} ${xr} ${ur} ${tn} ${xt.x} ${xt.y}`},"");return l.jsxs("g",{children:[l.jsx("rect",{width:"100%",height:"100%",fill:D?"#000000":"#ffffff",className:"transition-colors duration-300"}),l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"areaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.3"}),l.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0.05"})]}),l.jsxs("linearGradient",{id:"lineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),l.jsx("stop",{offset:"50%",stopColor:"#3b82f6"}),l.jsx("stop",{offset:"100%",stopColor:"#06b6d4"})]}),l.jsxs("filter",{id:"glow",children:[l.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),l.jsxs("feMerge",{children:[l.jsx("feMergeNode",{in:"coloredBlur"}),l.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),l.jsx("line",{x1:mt,y1:mt,x2:mt,y2:mt+ot,stroke:D?"#6b7280":"#374151",strokeWidth:2}),l.jsx("line",{x1:mt,y1:mt+ot,x2:mt+Xe,y2:mt+ot,stroke:D?"#6b7280":"#374151",strokeWidth:2}),[0,.25,.5,.75,1].map((tt,xt)=>{const Mt=mt+ot-tt*ot,lr=Math.round(Dt+tt*At);return l.jsxs("g",{children:[l.jsx("line",{x1:mt-5,y1:Mt,x2:mt,y2:Mt,stroke:D?"#6b7280":"#374151",strokeWidth:1}),l.jsx("text",{x:mt-15,y:Mt+5,textAnchor:"end",fontSize:"12",fill:D?"#9ca3af":"#6b7280",fontFamily:"system-ui, -apple-system, sans-serif",children:lr})]},`y-label-${xt}`)}),qe.map((tt,xt)=>{const Mt=mt+(tt-Zt)/rr*Xe;return l.jsxs("g",{children:[l.jsx("line",{x1:Mt,y1:mt+ot,x2:Mt,y2:mt+ot+5,stroke:D?"#6b7280":"#374151",strokeWidth:1}),l.jsx("text",{x:Mt,y:mt+ot+20,textAnchor:"middle",fontSize:"12",fill:D?"#9ca3af":"#6b7280",fontFamily:"system-ui, -apple-system, sans-serif",children:tt})]},`x-label-${xt}`)}),[0,.25,.5,.75,1].map((tt,xt)=>{const Mt=mt+ot-tt*ot;return l.jsx("line",{x1:mt,y1:Mt,x2:mt+Xe,y2:Mt,stroke:D?"#374151":"#e5e7eb",strokeWidth:1,strokeDasharray:"2,2",opacity:"0.4"},`grid-h-${xt}`)}),qe.map((tt,xt)=>{const Mt=mt+(tt-Zt)/rr*Xe;return l.jsx("line",{x1:Mt,y1:mt,x2:Mt,y2:mt+ot,stroke:D?"#374151":"#e5e7eb",strokeWidth:1,strokeDasharray:"2,2",opacity:"0.4"},`grid-v-${xt}`)}),l.jsx("path",{d:an,fill:"url(#areaGradient)"}),l.jsx("path",{d:Jn,fill:"none",stroke:"url(#lineGradient)",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#glow)",children:l.jsx("animate",{attributeName:"stroke-dasharray",values:"0,1000;1000,0",dur:"2s",repeatCount:"1"})}),qr.map((tt,xt)=>{const Mt=V===xt;return l.jsxs("g",{children:[l.jsx("circle",{cx:tt.x,cy:tt.y,r:15,fill:"transparent",onMouseEnter:lr=>{L(xt),Q(!0);const cr=ae.current.getBoundingClientRect(),xr=200,ur=100;let tn=lr.clientX-cr.left,Gn=lr.clientY-cr.top;const gi=xr/2;tn<gi+20?tn=gi+20:tn>cr.width-gi-20&&(tn=cr.width-gi-20),Gn=Gn+30,Gn+ur>cr.height-20&&(Gn=lr.clientY-cr.top-ur-10),H({x:tn,y:Gn})},onMouseMove:lr=>{const cr=ae.current.getBoundingClientRect(),xr=200,ur=100;let tn=lr.clientX-cr.left,Gn=lr.clientY-cr.top;const gi=xr/2;tn<gi+20?tn=gi+20:tn>cr.width-gi-20&&(tn=cr.width-gi-20),Gn=Gn+30,Gn+ur>cr.height-20&&(Gn=lr.clientY-cr.top-ur-10),H({x:tn,y:Gn})},style:{cursor:"pointer"}}),l.jsx("circle",{cx:tt.x,cy:tt.y,r:Mt?12:8,fill:"none",stroke:Mt?"#3b82f6":"#e5e7eb",strokeWidth:Mt?3:2,opacity:Mt?.3:.6,children:l.jsx("animate",{attributeName:"r",values:Mt?"8;12;8":"8",dur:Mt?"1s":"0s",repeatCount:Mt?"indefinite":"1"})}),l.jsx("circle",{cx:tt.x,cy:tt.y,r:Mt?8:6,fill:"#3b82f6",stroke:"white",strokeWidth:3,className:"drop-shadow-lg",children:l.jsx("animate",{attributeName:"r",values:"6;8;6",dur:"2s",begin:`${xt*.1}s`,repeatCount:"1"})}),l.jsx("circle",{cx:tt.x,cy:tt.y,r:Mt?4:3,fill:"#60a5fa",opacity:"0.8"})]},tt.year)}),l.jsx("text",{x:Fe/2,y:25,textAnchor:"middle",className:"text-lg font-bold fill-gray-800 dark:fill-gray-200",children:"Violation Trends Over Time"}),l.jsx("text",{x:mt-50,y:He/2,textAnchor:"middle",transform:`rotate(-90, ${mt-50}, ${He/2})`,className:"text-sm font-medium fill-gray-600 dark:fill-gray-400",children:"Number of Violations"})]})})()}),K&&V!==null&&l.jsxs("div",{className:"absolute bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 rounded-xl shadow-2xl p-4 z-50 pointer-events-none backdrop-blur-sm min-w-[200px]",style:{left:$.x-100,top:$.y,maxWidth:"250px",position:"absolute"},children:[l.jsx("div",{className:"absolute w-3 h-3 bg-white dark:bg-gray-800 border-l-2 border-t-2 border-gray-200 dark:border-gray-600 transform rotate-45",style:{left:"50%",top:"-6px",transform:"translateX(-50%) rotate(45deg)"}}),l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),l.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:((Pe=(he=ce[V])==null?void 0:he._id)==null?void 0:Pe.year)||"N/A"})]}),l.jsxs("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:[(((Ne=ce[V])==null?void 0:Ne.count)||0).toLocaleString()," violations"]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:V>0&&l.jsxs("span",{className:(((pe=ce[V])==null?void 0:pe.count)||0)>(((je=ce[V-1])==null?void 0:je.count)||0)?"text-red-500":"text-green-500",children:[(((xe=ce[V])==null?void 0:xe.count)||0)>(((Ce=ce[V-1])==null?void 0:Ce.count)||0)?"↗":"↘",Math.abs((((ze=ce[V])==null?void 0:ze.count)||0)-(((Te=ce[V-1])==null?void 0:Te.count)||0)).toLocaleString()," from previous year"]})})]})]})}),l.jsxs("div",{className:"w-60 space-y-4",children:[l.jsxs("div",{className:`relative overflow-hidden ${D?"bg-black border border-gray-600":"bg-white border border-blue-200"} p-2 rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-12 h-12 ${D?"bg-blue-500/30 dark:bg-blue-400/30":"bg-blue-500/10 dark:bg-blue-400/10"} rounded-full -translate-y-4 translate-x-4`}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex items-center mb-0.5",children:l.jsx("div",{className:"text-xs font-medium text-blue-700 dark:text-blue-300 uppercase tracking-wide",children:"Timeline"})}),l.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100 mb-0.5",children:ce.length}),l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Years Covered"}),l.jsx("div",{className:"mt-1 flex space-x-0.5",children:[...Array(6)].map((Re,Fe)=>l.jsx("div",{className:"w-1 h-1 bg-blue-400 dark:bg-blue-500 rounded-full opacity-60"},Fe))})]})]}),l.jsxs("div",{className:`relative overflow-hidden ${D?"bg-black border border-gray-600":"bg-white border border-red-200"} p-2 rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-10 h-10 ${D?"bg-red-500/30 dark:bg-red-400/30":"bg-red-500/10 dark:bg-red-400/10"} rounded-full -translate-y-3 translate-x-3`}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex items-center mb-0.5",children:l.jsx("div",{className:"text-xs font-medium text-red-700 dark:text-red-300 uppercase tracking-wide",children:"Critical"})}),l.jsx("div",{className:"text-xl font-bold text-red-900 dark:text-red-100 mb-0.5",children:ce.reduce((Re,Fe)=>Re+(Fe.count||0),0).toLocaleString()}),l.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Total Violations"}),l.jsxs("div",{className:"mt-1 flex items-center",children:[l.jsx("div",{className:"w-4 h-0.5 bg-red-300 dark:bg-red-600 rounded-full mr-1.5"}),l.jsx("div",{className:"text-xs text-red-500 dark:text-red-400",children:"High Volume"})]})]})]}),l.jsxs("div",{className:`relative overflow-hidden ${D?"bg-black border border-gray-600":"bg-white border border-green-200"} p-2 rounded-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-12 h-12 ${D?"bg-green-500/30 dark:bg-green-400/30":"bg-green-500/10 dark:bg-green-400/10"} rounded-full -translate-y-4 translate-x-4`}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex items-center mb-0.5",children:l.jsx("div",{className:"text-xs font-medium text-green-700 dark:text-green-300 uppercase tracking-wide",children:"Analytics"})}),l.jsx("div",{className:"text-xl font-bold text-green-900 dark:text-green-100 mb-0.5",children:ce.length>0?Math.round(ce.reduce((Re,Fe)=>Re+(Fe.count||0),0)/ce.length).toLocaleString():0}),l.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Average per Year"}),l.jsxs("div",{className:"mt-1 flex items-center space-x-0.5",children:[l.jsx("div",{className:"w-0.5 h-1.5 bg-green-400 dark:bg-green-500 rounded-full"}),l.jsx("div",{className:"w-0.5 h-2 bg-green-500 dark:bg-green-400 rounded-full"}),l.jsx("div",{className:"w-0.5 h-1 bg-green-400 dark:bg-green-500 rounded-full"}),l.jsx("div",{className:"w-0.5 h-2.5 bg-green-500 dark:bg-green-400 rounded-full"}),l.jsx("div",{className:"w-0.5 h-1.5 bg-green-400 dark:bg-green-500 rounded-full"})]})]})]})]})]})]}):l.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No data available for 2020-2025"})})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 mb-5",children:[l.jsx("div",{className:"lg:col-span-2 flex",children:l.jsx("div",{className:"w-full",style:{minHeight:"400px"},children:l.jsx(fUe,{data:ee,title:"Violation Types Distribution",loading:t})})}),l.jsx("div",{className:"lg:col-span-3 flex",children:l.jsx("div",{className:"w-full",style:{minHeight:"400px"},children:l.jsx(hUe,{data:(e==null?void 0:e.topOfficers)||[],title:"Apprehending Officers",type:"officers",loading:t,totalCount:(e==null?void 0:e.totalOfficers)||0})})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-1 gap-6 mb-8",children:l.jsx("div",{className:"lg:col-span-1",children:l.jsx(pUe,{displayData:e,loading:t,currentViolations:n,startIndex:a,endIndex:c,totalViolationItems:f,currentPage:i,totalPages:x,handlePrevPage:w,handleNextPage:A})})}),l.jsx("div",{className:"mb-8",children:l.jsx(mUe,{displayData:e,loading:t,getCombinationRecommendation:P})})]})}function yUe({isLineChartModalOpen:e,setIsLineChartModalOpen:t,selectedYearRange:r,setSelectedYearRange:n,filteredYearlyData:a,loading:c}){var K,Q,ae,ee,se,ce,he,Pe,Ne;const[f,i]=W.useState(null),[x,w]=W.useState({x:0,y:0}),[A,P]=W.useState(!1),E=W.useRef(null),D=typeof window<"u"&&(document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches);if(!e)return null;const V=["2020-2025","2015-2019","2010-2014","2005-2009","2000-2004"],L=pe=>{n(pe)};Math.max(...a.map(pe=>pe.count||0),1);const H=["#8b5cf6","#8b5cf6","#3b82f6","#2563eb","#06b6d4","#06b6d4","#8b5cf6","#3b82f6","#2563eb","#06b6d4"];return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-black border-2 border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl max-w-5xl w-full max-h-[80vh] overflow-hidden transform transition-all duration-300 scale-100",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-900",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Violation Trends Analysis"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Historical violation data and trends"})]})]}),l.jsx("button",{onClick:()=>t(!1),className:"w-10 h-10 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110",children:l.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"p-4 overflow-hidden max-h-[calc(80vh-100px)]",children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{className:"flex items-center space-x-3 mb-2",children:l.jsx("label",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Select Analysis Period:"})}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:V.map(pe=>l.jsx("button",{onClick:()=>L(pe),className:`px-3 py-2 rounded-lg text-xs font-medium transition-all duration-300 transform hover:scale-105 ${r===pe?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg shadow-blue-500/25":"bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-blue-300 dark:hover:border-blue-500 hover:shadow-md"}`,children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"font-bold",children:pe}),l.jsx("div",{className:"text-xs opacity-75",children:"Years"})]})},pe))})]}),l.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-2xl p-4 shadow-xl",children:c?l.jsx("div",{className:"flex items-center justify-center h-96",children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600"}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full animate-pulse"})})]})}):a.length>0?l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{})}),l.jsxs("div",{className:"flex gap-6",children:[l.jsxs("div",{className:"flex-1 relative bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden",children:[l.jsx("svg",{ref:E,width:"100%",height:"250",className:"relative",onMouseLeave:()=>{P(!1),i(null)},children:(()=>{const pe=a.sort((Dt,Cr)=>{var At,qr;return(((At=Dt._id)==null?void 0:At.year)||0)-(((qr=Cr._id)==null?void 0:qr.year)||0)});if(pe.length===0)return null;const je=700,xe=300,Ce=100,ze=je-Ce*2,Te=xe-Ce*2,Re=pe.map(Dt=>{var Cr;return((Cr=Dt._id)==null?void 0:Cr.year)||0}),Fe=pe.map(Dt=>Dt.count||0),He=Math.min(...Re),Xe=Math.max(...Re)-He||1,ot=Math.min(...Fe),qe=Math.max(...Fe),Zt=(qe-ot||1)*.1,Xt=Math.max(0,ot-Zt),ir=qe+Zt-Xt,Bt=pe.map((Dt,Cr)=>{var tt;const At=((tt=Dt._id)==null?void 0:tt.year)||0,qr=Dt.count||0,an=Ce+(At-He)/Xe*ze,Jn=Ce+Te-(qr-Xt)/ir*Te;return{x:an,y:Jn,year:At,count:qr,color:H[Cr%H.length]}}),De=Bt.reduce((Dt,Cr,At)=>At===0?`M ${Cr.x} ${Ce+Te} L ${Cr.x} ${Cr.y}`:`${Dt} L ${Cr.x} ${Cr.y}`,"")+` L ${Bt[Bt.length-1].x} ${Ce+Te} Z`,jr=Bt.reduce((Dt,Cr,At)=>{if(At===0)return`M ${Cr.x} ${Cr.y}`;const qr=Bt[At-1],an=qr.x+(Cr.x-qr.x)/3,Jn=qr.y,tt=Cr.x-(Cr.x-qr.x)/3,xt=Cr.y;return`${Dt} C ${an} ${Jn} ${tt} ${xt} ${Cr.x} ${Cr.y}`},"");return l.jsxs("g",{children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"modalAreaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8b5cf6",stopOpacity:"0.2"}),l.jsx("stop",{offset:"50%",stopColor:"#3b82f6",stopOpacity:"0.1"}),l.jsx("stop",{offset:"100%",stopColor:"#06b6d4",stopOpacity:"0.05"})]}),l.jsxs("linearGradient",{id:"modalLineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),l.jsx("stop",{offset:"20%",stopColor:"#8b5cf6"}),l.jsx("stop",{offset:"40%",stopColor:"#3b82f6"}),l.jsx("stop",{offset:"60%",stopColor:"#2563eb"}),l.jsx("stop",{offset:"80%",stopColor:"#06b6d4"}),l.jsx("stop",{offset:"100%",stopColor:"#06b6d4"})]}),l.jsxs("filter",{id:"modalGlow",children:[l.jsx("feGaussianBlur",{stdDeviation:"4",result:"coloredBlur"}),l.jsxs("feMerge",{children:[l.jsx("feMergeNode",{in:"coloredBlur"}),l.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),l.jsx("line",{x1:Ce,y1:Ce,x2:Ce,y2:Ce+Te,stroke:"#6b7280",strokeWidth:2}),l.jsx("line",{x1:Ce,y1:Ce+Te,x2:Ce+ze,y2:Ce+Te,stroke:"#6b7280",strokeWidth:2}),[0,.25,.5,.75,1].map((Dt,Cr)=>{const At=Ce+Te-Dt*Te,qr=Math.round(Xt+Dt*ir);return l.jsxs("g",{children:[l.jsx("line",{x1:Ce-5,y1:At,x2:Ce,y2:At,stroke:"#6b7280",strokeWidth:1}),l.jsx("text",{x:Ce-15,y:At+5,textAnchor:"end",fontSize:"12",fill:"#9ca3af",fontFamily:"system-ui, -apple-system, sans-serif",children:qr})]},`y-label-${Cr}`)}),Re.map((Dt,Cr)=>{const At=Ce+(Dt-He)/Xe*ze;return l.jsxs("g",{children:[l.jsx("line",{x1:At,y1:Ce+Te,x2:At,y2:Ce+Te+5,stroke:"#6b7280",strokeWidth:1}),l.jsx("text",{x:At,y:Ce+Te+20,textAnchor:"middle",fontSize:"12",fill:"#9ca3af",fontFamily:"system-ui, -apple-system, sans-serif",children:Dt})]},`x-label-${Cr}`)}),[0,.25,.5,.75,1].map((Dt,Cr)=>{const At=Ce+Te-Dt*Te;return l.jsx("line",{x1:Ce,y1:At,x2:Ce+ze,y2:At,stroke:"#374151",strokeWidth:1,strokeDasharray:"2,2",opacity:"0.4"},`grid-h-${Cr}`)}),Re.map((Dt,Cr)=>{const At=Ce+(Dt-He)/Xe*ze;return l.jsx("line",{x1:At,y1:Ce,x2:At,y2:Ce+Te,stroke:"#374151",strokeWidth:1,strokeDasharray:"2,2",opacity:"0.4"},`grid-v-${Cr}`)}),l.jsx("path",{d:De,fill:"url(#modalAreaGradient)"}),l.jsx("path",{d:jr,fill:"none",stroke:"url(#modalLineGradient)",strokeWidth:5,strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#modalGlow)",children:l.jsx("animate",{attributeName:"stroke-dasharray",values:"0,2000;2000,0",dur:"3s",repeatCount:"1"})}),Bt.map((Dt,Cr)=>{const At=f===Cr;return l.jsxs("g",{children:[l.jsx("circle",{cx:Dt.x,cy:Dt.y,r:20,fill:"transparent",onMouseEnter:qr=>{i(Cr),P(!0);const an=E.current.getBoundingClientRect(),Jn=220,tt=120;let xt=qr.clientX-an.left,Mt=qr.clientY-an.top;const lr=Jn/2;xt<lr+20?xt=lr+20:xt>an.width-lr-20&&(xt=an.width-lr-20),Mt=Mt+30,Mt+tt>an.height-20&&(Mt=qr.clientY-an.top-tt-10),w({x:xt,y:Mt})},onMouseMove:qr=>{const an=E.current.getBoundingClientRect(),Jn=220,tt=120;let xt=qr.clientX-an.left,Mt=qr.clientY-an.top;const lr=Jn/2;xt<lr+20?xt=lr+20:xt>an.width-lr-20&&(xt=an.width-lr-20),Mt=Mt+30,Mt+tt>an.height-20&&(Mt=qr.clientY-an.top-tt-10),w({x:xt,y:Mt})},style:{cursor:"pointer"}}),l.jsx("circle",{cx:Dt.x,cy:Dt.y,r:At?7:6,fill:Dt.color,stroke:Dt.color,strokeWidth:2}),l.jsx("circle",{cx:Dt.x,cy:Dt.y,r:At?3:2.5,fill:"white"})]},Dt.year)}),l.jsx("text",{x:Ce-50,y:xe/2,textAnchor:"middle",transform:`rotate(-90, ${Ce-50}, ${xe/2})`,className:"text-sm font-medium fill-gray-600 dark:fill-gray-400",children:"Number of Violations"})]})})()}),A&&f!==null&&l.jsxs("div",{className:"absolute bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 rounded-xl shadow-2xl p-4 z-50 pointer-events-none backdrop-blur-sm min-w-[200px]",style:{left:`${x.x-110}px`,top:`${x.y}px`,maxWidth:"250px",position:"absolute"},children:[l.jsx("div",{className:"absolute w-3 h-3 bg-white dark:bg-gray-800 border-l-2 border-t-2 border-gray-200 dark:border-gray-600 transform rotate-45",style:{left:"50%",top:"-6px",transform:"translateX(-50%) rotate(45deg)"}}),l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full shadow-lg",style:{backgroundColor:H[f%H.length]}}),l.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:((Q=(K=a[f])==null?void 0:K._id)==null?void 0:Q.year)||"N/A"})]}),l.jsxs("div",{className:"text-lg font-bold mb-2",style:{color:H[f%H.length]},children:[(((ae=a[f])==null?void 0:ae.count)||0).toLocaleString()," violations"]}),l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:f>0&&l.jsxs("span",{className:(((ee=a[f])==null?void 0:ee.count)||0)>(((se=a[f-1])==null?void 0:se.count)||0)?"text-red-500":"text-green-500",children:[(((ce=a[f])==null?void 0:ce.count)||0)>(((he=a[f-1])==null?void 0:he.count)||0)?"↗":"↘",Math.abs((((Pe=a[f])==null?void 0:Pe.count)||0)-(((Ne=a[f-1])==null?void 0:Ne.count)||0)).toLocaleString()," from previous year"]})})]})]}),l.jsxs("div",{className:"w-56 space-y-2",children:[l.jsxs("div",{className:`relative overflow-hidden ${D?"bg-black border-2 border-gray-600":"bg-white border-2 border-blue-200"} rounded-lg p-2 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-8 h-8 ${D?"bg-blue-500/30 dark:bg-blue-400/30":"bg-blue-500/10 dark:bg-blue-400/10"} rounded-full -translate-y-1 translate-x-1`}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex items-center mb-0.5",children:l.jsx("div",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300 uppercase tracking-wide",children:"Timeline"})}),l.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100 mb-0.5",children:a.length}),l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Years Covered"})]})]}),l.jsxs("div",{className:`relative overflow-hidden ${D?"bg-black border-2 border-gray-600":"bg-white border-2 border-red-200"} rounded-lg p-2 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-8 h-8 ${D?"bg-red-500/30 dark:bg-red-400/30":"bg-red-500/10 dark:bg-red-400/10"} rounded-full -translate-y-1 translate-x-1`}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex items-center mb-0.5",children:l.jsx("div",{className:"text-xs font-semibold text-red-700 dark:text-red-300 uppercase tracking-wide",children:"Critical"})}),l.jsx("div",{className:"text-lg font-bold text-red-900 dark:text-red-100 mb-0.5",children:a.reduce((pe,je)=>pe+(je.count||0),0).toLocaleString()}),l.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:"Total Violations"})]})]}),l.jsxs("div",{className:`relative overflow-hidden ${D?"bg-black border-2 border-gray-600":"bg-white border-2 border-green-200"} rounded-lg p-2 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1`,children:[l.jsx("div",{className:`absolute top-0 right-0 w-8 h-8 ${D?"bg-green-500/30 dark:bg-green-400/30":"bg-green-500/10 dark:bg-green-400/10"} rounded-full -translate-y-1 translate-x-1`}),l.jsxs("div",{className:"relative z-10",children:[l.jsx("div",{className:"flex items-center mb-0.5",children:l.jsx("div",{className:"text-xs font-semibold text-green-700 dark:text-green-300 uppercase tracking-wide",children:"Analytics"})}),l.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100 mb-0.5",children:a.length>0?Math.round(a.reduce((pe,je)=>pe+(je.count||0),0)/a.length).toLocaleString():0}),l.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Average per Year"})]})]})]})]})]}):l.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-full flex items-center justify-center",children:l.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),l.jsx("p",{className:"text-sm",children:"No data available for the selected year range"}),l.jsx("p",{className:"text-xs opacity-75 mt-1",children:"Try selecting a different time period"})]})})]})]})})}function vUe({onOpen:e}){const[t,r]=W.useState(!1);return l.jsxs("button",{onClick:e,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),className:`
        flex items-center space-x-2 px-4 py-2 rounded-lg font-medium text-sm
        transition-all duration-300 transform hover:-translate-y-0.5
        ${t?"bg-transparent text-blue-700 border-2 border-blue-500 shadow-lg shadow-blue-500/20":"bg-transparent text-blue-600 border-2 border-blue-400 shadow-md hover:shadow-xl"}
      `,children:[l.jsx(so,{className:"w-4 h-4"}),l.jsx("span",{children:"Monthly Violation Monitoring"}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(yP,{className:"w-3 h-3"}),l.jsx(qg,{className:"w-3 h-3"})]})]})}function xUe({isOpen:e,onClose:t,analyticsData:r,loading:n,selectedYear:a}){const[c,f]=W.useState(null),[i,x]=W.useState({x:0,y:0}),[w,A]=W.useState(!1),[P,E]=W.useState(a||"All"),[D,V]=W.useState("line"),L=W.useRef(null);if(W.useEffect(()=>{a&&E(a)},[a]),!e)return null;const $=new Date().getFullYear(),H=["All",...Array.from({length:$-2e3+1},(he,Pe)=>(2e3+Pe).toString())],Q=(()=>{if(!(r!=null&&r.yearlyTrends)||r.yearlyTrends.length===0)return[];const he=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(P==="All"){const Pe=r.yearlyTrends.reduce((pe,je)=>pe+(je.count||0),0),Ne=r.yearlyTrends.length;return he.map((pe,je)=>{const xe=Math.sin(je/12*Math.PI)*.3+.7,Ce=Math.round(Pe/(Ne*12)*xe*Ne);return{month:pe,monthNum:je+1,count:Ce,year:"All Time"}})}else{const Pe=parseInt(P),Ne=r.yearlyTrends.find(pe=>{var je;return((je=pe._id)==null?void 0:je.year)===Pe});if(Ne&&Ne.count){const pe=Ne.count;return he.map((je,xe)=>{const Ce=Math.sin(xe/12*Math.PI)*.3+.7,ze=Math.round(pe/12*Ce);return{month:je,monthNum:xe+1,count:ze,year:Pe}})}}return he.map((Pe,Ne)=>({month:Pe,monthNum:Ne+1,count:0,year:P==="All"?"All Time":parseInt(P)}))})();Math.max(...Q.map(he=>he.count),1);const ae=Q.reduce((he,Pe)=>he+Pe.count,0),ee=Math.round(ae/12),se=Q.reduce((he,Pe)=>Pe.count>he.count?Pe:he,Q[0]),ce=["#8b5cf6","#9333ea","#a855f7","#3b82f6","#2563eb","#1d4ed8","#06b6d4","#0891b2","#0e7490","#10b981","#059669","#047857"];return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-900 dark:to-black border-2 border-gray-200 dark:border-gray-700 rounded-2xl shadow-2xl max-w-7xl w-full max-h-[80vh] overflow-hidden transform transition-all duration-300 scale-100",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-900",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:l.jsx(so,{className:"w-6 h-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Monthly Violation Monitoring"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Track violations by month and analyze trends"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Chart Type"}),l.jsxs("select",{value:D,onChange:he=>V(he.target.value),className:"px-3 py-2 pr-8 rounded-lg text-sm font-medium bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-blue-300 dark:hover:border-blue-500 focus:border-blue-500 dark:focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all duration-200 cursor-pointer shadow-sm hover:shadow-md appearance-none",style:{minWidth:"110px"},children:[l.jsx("option",{value:"line",children:"📈 Line Chart"}),l.jsx("option",{value:"bar",children:"📊 Bar Chart"})]}),l.jsx("div",{className:"absolute right-2 top-8 pointer-events-none",children:l.jsx("svg",{className:"w-3 h-3 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),l.jsxs("div",{className:"relative",children:[l.jsx("label",{className:"text-xs font-medium text-gray-600 dark:text-gray-400 mb-1 block",children:"Year"}),l.jsx("select",{value:P,onChange:he=>E(he.target.value),className:"px-4 py-2 pr-10 rounded-lg text-sm font-medium bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:border-blue-300 dark:hover:border-blue-500 focus:border-blue-500 dark:focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 transition-all duration-200 cursor-pointer shadow-sm hover:shadow-md appearance-none",style:{minWidth:"140px"},children:H.map(he=>l.jsx("option",{value:he,children:he==="All"?"📊 All Time":he},he))}),l.jsx("div",{className:"absolute right-3 top-8 pointer-events-none",children:l.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),l.jsx("button",{onClick:t,className:"w-10 h-10 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full flex items-center justify-center transition-all duration-200 hover:scale-110 mt-5",children:l.jsx(Qf,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})]})]}),l.jsx("div",{className:"p-4 overflow-hidden",children:n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-200 border-t-blue-600"}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full animate-pulse"})})]})}):Q.length>0&&ae>0?l.jsx("div",{children:l.jsx("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-xl p-4 shadow-lg",children:l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"flex-1 relative bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-100 dark:border-gray-700 overflow-hidden",children:[l.jsx("svg",{ref:L,width:"100%",height:"350",className:"relative",onMouseLeave:()=>{A(!1),f(null)},children:(()=>{const xe=Q.map(qe=>qe.count),Ce=0,ze=Math.max(...xe),Re=(ze-Ce||1)*.1,He=ze+Re,mt=Q.map((qe,Lt)=>{const Zt=60+Lt/(Q.length-1)*780,Xt=290-qe.count/He*230;return{x:Zt,y:Xt,...qe,color:ce[Lt]}}),Xe=mt.reduce((qe,Lt,Zt)=>{if(Zt===0)return`M ${Lt.x} ${Lt.y}`;const Xt=mt[Zt-1],rr=Xt.x+(Lt.x-Xt.x)/3,ir=Xt.y,Bt=Lt.x-(Lt.x-Xt.x)/3,De=Lt.y;return`${qe} C ${rr} ${ir} ${Bt} ${De} ${Lt.x} ${Lt.y}`},""),ot=mt.reduce((qe,Lt,Zt)=>{if(Zt===0)return`M ${Lt.x} 290 L ${Lt.x} ${Lt.y}`;const Xt=mt[Zt-1],rr=Xt.x+(Lt.x-Xt.x)/3,ir=Xt.y,Bt=Lt.x-(Lt.x-Xt.x)/3,De=Lt.y;return`${qe} C ${rr} ${ir} ${Bt} ${De} ${Lt.x} ${Lt.y}`},"")+` L ${mt[mt.length-1].x} 290 Z`;return l.jsxs("g",{children:[l.jsxs("defs",{children:[l.jsxs("linearGradient",{id:"monthlyAreaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8b5cf6",stopOpacity:"0.3"}),l.jsx("stop",{offset:"50%",stopColor:"#3b82f6",stopOpacity:"0.15"}),l.jsx("stop",{offset:"100%",stopColor:"#06b6d4",stopOpacity:"0.05"})]}),l.jsxs("linearGradient",{id:"monthlyLineGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),l.jsx("stop",{offset:"25%",stopColor:"#3b82f6"}),l.jsx("stop",{offset:"50%",stopColor:"#2563eb"}),l.jsx("stop",{offset:"75%",stopColor:"#06b6d4"}),l.jsx("stop",{offset:"100%",stopColor:"#10b981"})]}),l.jsxs("linearGradient",{id:"barGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#8b5cf6"}),l.jsx("stop",{offset:"70%",stopColor:"#a855f7"}),l.jsx("stop",{offset:"100%",stopColor:"#ec4899"})]}),l.jsxs("filter",{id:"monthlyGlow",children:[l.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),l.jsxs("feMerge",{children:[l.jsx("feMergeNode",{in:"coloredBlur"}),l.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),l.jsx("line",{x1:60,y1:60,x2:60,y2:290,stroke:"#6b7280",strokeWidth:2}),l.jsx("line",{x1:60,y1:290,x2:840,y2:290,stroke:"#6b7280",strokeWidth:2}),[0,.25,.5,.75,1].map((qe,Lt)=>{const Zt=290-qe*230,Xt=Math.round(qe*He);return l.jsxs("g",{children:[l.jsx("line",{x1:60,y1:Zt,x2:840,y2:Zt,stroke:"#374151",strokeWidth:1,strokeDasharray:"4,4",opacity:"0.3"}),l.jsx("text",{x:52,y:Zt+4,textAnchor:"end",fontSize:"12",fill:"#374151",fontFamily:"system-ui",fontWeight:"600",children:Xt})]},`grid-${Lt}`)}),Q.map((qe,Lt)=>{const Zt=60+Lt/(Q.length-1)*780;return l.jsxs("g",{children:[l.jsx("line",{x1:Zt,y1:290,x2:Zt,y2:295,stroke:"#6b7280",strokeWidth:1}),l.jsx("text",{x:Zt,y:308,textAnchor:"middle",fontSize:"12",fill:"#374151",fontFamily:"system-ui",fontWeight:"600",children:qe.month})]},`x-label-${Lt}`)}),D==="line"?l.jsxs(l.Fragment,{children:[l.jsx("path",{d:ot,fill:"url(#monthlyAreaGradient)"}),l.jsx("path",{d:Xe,fill:"none",stroke:"url(#monthlyLineGradient)",strokeWidth:4,strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#monthlyGlow)"}),mt.map((qe,Lt)=>{const Zt=c===Lt;return l.jsxs("g",{children:[l.jsx("circle",{cx:qe.x,cy:qe.y,r:20,fill:"transparent",onMouseEnter:Xt=>{f(Lt),A(!0);const rr=L.current.getBoundingClientRect(),ir=Xt.clientX-rr.left,Bt=Xt.clientY-rr.top+30;x({x:ir,y:Bt})},onMouseMove:Xt=>{const rr=L.current.getBoundingClientRect(),ir=Xt.clientX-rr.left,Bt=Xt.clientY-rr.top+30;x({x:ir,y:Bt})},style:{cursor:"pointer"}}),l.jsx("circle",{cx:qe.x,cy:qe.y,r:Zt?7:5,fill:qe.color,stroke:"white",strokeWidth:2}),l.jsx("circle",{cx:qe.x,cy:qe.y,r:Zt?3:2,fill:"white"})]},`point-${Lt}`)})]}):mt.map((qe,Lt)=>{const Zt=Q.length,rr=(780-(Zt-1)*8)/Zt,ir=qe.count/He*230,Bt=60+Lt*(rr+8),De=290-ir,jr=c===Lt;return l.jsxs("g",{children:[l.jsx("rect",{x:Bt-5,y:60,width:rr+10,height:230,fill:"transparent",onMouseEnter:Dt=>{f(Lt),A(!0);const Cr=L.current.getBoundingClientRect(),At=Dt.clientX-Cr.left,qr=Dt.clientY-Cr.top+30;x({x:At,y:qr})},onMouseMove:Dt=>{const Cr=L.current.getBoundingClientRect(),At=Dt.clientX-Cr.left,qr=Dt.clientY-Cr.top+30;x({x:At,y:qr})},style:{cursor:"pointer"}}),l.jsx("rect",{x:Bt,y:De,width:rr,height:ir,fill:jr?"#8b5cf6":"url(#barGradient)",stroke:"none",rx:4,ry:4,style:{filter:jr?"drop-shadow(0 6px 12px rgba(139, 92, 246, 0.4))":"drop-shadow(0 2px 4px rgba(139, 92, 246, 0.2))",transition:"all 0.3s ease"}}),l.jsx("rect",{x:Bt+1,y:De+1,width:rr-2,height:Math.max(8,ir*.06),fill:"rgba(255, 255, 255, 0.4)",rx:3,ry:3}),l.jsx("rect",{x:Bt+1,y:De+ir-3,width:rr-2,height:2,fill:"rgba(0, 0, 0, 0.1)",rx:1,ry:1})]},`bar-${Lt}`)}),l.jsx("text",{x:20,y:350/2,textAnchor:"middle",transform:`rotate(-90, 20, ${350/2})`,fontSize:"13",fill:"#6b7280",fontFamily:"system-ui",fontWeight:"500",children:"Number of Violations"}),l.jsx("text",{x:900/2,y:335,textAnchor:"middle",fontSize:"13",fill:"#6b7280",fontFamily:"system-ui",fontWeight:"500",children:"Month"})]})})()}),w&&c!==null&&l.jsxs("div",{className:"absolute bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-600 rounded-xl shadow-2xl p-4 z-50 pointer-events-none min-w-[200px]",style:{left:`${i.x-100}px`,top:`${i.y}px`},children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ce[c]}}),l.jsxs("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:[Q[c].month," ",Q[c].year]})]}),l.jsxs("div",{className:"text-lg font-bold mb-2",style:{color:ce[c]},children:[Q[c].count.toLocaleString()," violations"]}),c>0&&l.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:l.jsxs("span",{className:Q[c].count>Q[c-1].count?"text-red-500":"text-green-500",children:[Q[c].count>Q[c-1].count?"↗":"↘"," ",Math.abs(Q[c].count-Q[c-1].count).toLocaleString()," from previous month"]})})]})]}),l.jsxs("div",{className:"w-52 space-y-2",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-2.5 shadow-md hover:shadow-lg transition-all",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-[10px] font-semibold text-blue-700 dark:text-blue-300 uppercase tracking-wide",children:"Total"}),l.jsx(qg,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"})]}),l.jsx("div",{className:"text-xl font-bold text-blue-900 dark:text-blue-100",children:ae.toLocaleString()}),l.jsx("div",{className:"text-[10px] text-blue-600 dark:text-blue-400",children:"Violations this period"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30 border-2 border-purple-200 dark:border-purple-700 rounded-lg p-2.5 shadow-md hover:shadow-lg transition-all",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-[10px] font-semibold text-purple-700 dark:text-purple-300 uppercase tracking-wide",children:"Average"}),l.jsx(_Ue,{className:"w-3 h-3 text-purple-600 dark:text-purple-400"})]}),l.jsx("div",{className:"text-xl font-bold text-purple-900 dark:text-purple-100",children:ee.toLocaleString()}),l.jsx("div",{className:"text-[10px] text-purple-600 dark:text-purple-400",children:"Per month"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/30 border-2 border-red-200 dark:border-red-700 rounded-lg p-2.5 shadow-md hover:shadow-lg transition-all",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("span",{className:"text-[10px] font-semibold text-red-700 dark:text-red-300 uppercase tracking-wide",children:"Peak Month"}),l.jsx(qg,{className:"w-3 h-3 text-red-600 dark:text-red-400"})]}),l.jsx("div",{className:"text-xl font-bold text-red-900 dark:text-red-100",children:se.month}),l.jsxs("div",{className:"text-[10px] text-red-600 dark:text-red-400",children:[se.count.toLocaleString()," violations"]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/30 dark:to-amber-800/30 border-2 border-amber-200 dark:border-amber-700 rounded-lg p-2 shadow-md",children:[l.jsxs("div",{className:"flex items-center space-x-1 mb-1",children:[l.jsx("svg",{className:"w-3 h-3 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),l.jsx("span",{className:"text-[10px] font-semibold text-amber-700 dark:text-amber-300 uppercase tracking-wide",children:"Note"})]}),l.jsx("div",{className:"text-[10px] text-amber-700 dark:text-amber-300 leading-snug",children:"Monthly data is estimated based on yearly trends."})]})]})]})})}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center",children:l.jsx(so,{className:"w-8 h-8 text-gray-400"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Monthly Data Available"}),l.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"There is no violation data available for the selected period. Please try selecting a different year."}),l.jsx("button",{onClick:t,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all duration-300",children:"Close"})]})})]})})}const _Ue=({className:e})=>l.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),jW=(e,t=2e3)=>{const[r,n]=W.useState(0);return W.useEffect(()=>{let a;const f=i=>{a||(a=i);const x=Math.min((i-a)/t,1),w=1-Math.pow(1-x,4),A=Math.floor(0+(e-0)*w);n(A),x<1&&requestAnimationFrame(f)};requestAnimationFrame(f)},[e,t]),r};function bUe(){var Re,Fe,He,mt;const[e,t]=W.useState(""),[r,n]=W.useState(!1),[a,c]=W.useState(null),[f,i]=W.useState(!1),[x,w]=W.useState(null),[A,P]=W.useState(1),E=5,[D,V]=W.useState(!1),[L,$]=W.useState("2020-2023"),[H,K]=W.useState(!1),Q=W.useRef(null);new Date().getFullYear(),[...Array.from({length:19},(Xe,ot)=>(2005+ot).toString())];const ee=(()=>{if(!(a!=null&&a.yearlyTrends))return[];if(!L.includes("-")){const qe=parseInt(L);return a.yearlyTrends.filter(Lt=>{var Zt;return((Zt=Lt._id)==null?void 0:Zt.year)===qe})}const[Xe,ot]=L.split("-").map(Number);return a.yearlyTrends.filter(qe=>{var Lt,Zt;return((Lt=qe._id)==null?void 0:Lt.year)>=Xe&&((Zt=qe._id)==null?void 0:Zt.year)<=ot})})(),se=jW((a==null?void 0:a.totalViolations)||0),ce=jW((a==null?void 0:a.totalTrafficViolators)||0);W.useEffect(()=>{const Xe=ot=>{Q.current&&!Q.current.contains(ot.target)&&n(!1)};return document.addEventListener("mousedown",Xe),()=>{document.removeEventListener("mousedown",Xe)}},[]);const he=async Xe=>{var ot,qe;try{i(!0),w(null);let Lt=null;Xe&&Xe!=="All"&&(Lt=Xe),console.log("🔍 Fetching violation analytics with filters:",{year:Xe,yearValue:Lt}),console.log("🔍 Token in localStorage:",localStorage.getItem("token")?"Present":"Missing");const Zt=await uUe({},Lt);if(console.log("🔍 API Response:",Zt),console.log("🔍 Response success:",Zt==null?void 0:Zt.success),console.log("🔍 Response data:",Zt==null?void 0:Zt.data),Zt&&Zt.success)c(Zt.data),console.log("Analytics data set:",Zt.data),Xe&&Xe!=="All"&&Zt.data.totalViolations===0?w(`No violation data available for year ${Xe}. Please try a different year.`):w(null);else{const Xt=(Zt==null?void 0:Zt.message)||"Failed to fetch analytics data";w(Xt),console.error("API returned error:",Xt)}}catch(Lt){console.error("Error fetching analytics data:",Lt);const Zt=((qe=(ot=Lt.response)==null?void 0:ot.data)==null?void 0:qe.message)||Lt.message||"Error loading analytics data";w(Zt)}finally{i(!1)}};W.useEffect(()=>{he("All")},[]),W.useEffect(()=>{he(e||"All")},[e]);const Pe=((Re=a==null?void 0:a.mostCommonViolations)==null?void 0:Re.length)||0,Ne=Math.ceil(Pe/E),pe=(A-1)*E,je=pe+E,xe=((Fe=a==null?void 0:a.mostCommonViolations)==null?void 0:Fe.slice(pe,je))||[],Ce=()=>{P(Xe=>Math.max(Xe-1,1))},ze=()=>{P(Xe=>Math.min(Xe+1,Ne))},Te=Xe=>{const ot=Xe.map(qe=>qe.toLowerCase());return ot.some(qe=>qe.includes("no helmet"))&&ot.some(qe=>qe.includes("no license"))?"Immediate impoundment - High risk rider without proper documentation":ot.some(qe=>qe.includes("speeding"))&&ot.some(qe=>qe.includes("no license"))?"Vehicle impoundment and court hearing - Reckless driving without license":ot.some(qe=>qe.includes("no registration"))&&ot.some(qe=>qe.includes("no license"))?"Complete documentation check and vehicle impoundment until compliance":ot.some(qe=>qe.includes("drunk"))||ot.some(qe=>qe.includes("alcohol"))?"Immediate arrest and breathalyzer test - Zero tolerance policy":ot.some(qe=>qe.includes("reckless"))&&ot.some(qe=>qe.includes("speeding"))?"License suspension and mandatory driver education program":ot.some(qe=>qe.includes("confiscated"))||ot.some(qe=>qe.includes("impound"))?"Severe violation - Court hearing and possible vehicle forfeiture":ot.some(qe=>qe.includes("no license"))||ot.some(qe=>qe.includes("no registration"))?"Documentation violation - Vehicle impoundment until proper documents provided":ot.some(qe=>qe.includes("helmet"))||ot.some(qe=>qe.includes("safety"))?"Safety violation - Fine and safety education requirement":ot.some(qe=>qe.includes("speeding"))||ot.some(qe=>qe.includes("traffic"))?"Traffic violation - Fine and license demerit points":"Standard fine and documentation review"};return l.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:[l.jsx("div",{className:"mb-8",children:l.jsxs("div",{className:"flex justify-between items-start mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2 animate-in slide-in-from-top-5 fade-in duration-700",children:"Violation Analytics"}),l.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Traffic Violation Analytics Dashboard",a&&l.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",children:"✓ Live Data"}),!a&&!f&&l.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",children:"No Data"})]})]}),l.jsx("div",{className:"mt-2",children:l.jsx(vUe,{onOpen:()=>K(!0)})})]})}),x&&l.jsx("div",{className:"mb-4 p-4 bg-red-100 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("p",{className:"text-red-800 dark:text-red-400 text-sm",children:x}),l.jsx("button",{onClick:()=>he(e||"All"),className:"ml-4 px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"Retry"})]})}),l.jsx(dUe,{displayData:a,loading:f,totalViolations:se,totalTrafficViolators:ce,topOfficer:(He=a==null?void 0:a.topOfficers)==null?void 0:He[0],mostCommonViolation:(mt=a==null?void 0:a.mostCommonViolations)==null?void 0:mt[0]}),l.jsx(gUe,{displayData:a,loading:f,setIsLineChartModalOpen:V,currentViolations:xe,startIndex:pe,endIndex:je,totalViolationItems:Pe,currentPage:A,totalPages:Ne,handlePrevPage:Ce,handleNextPage:ze,getCombinationRecommendation:Te}),l.jsx(yUe,{isLineChartModalOpen:D,setIsLineChartModalOpen:V,selectedYearRange:L,setSelectedYearRange:$,filteredYearlyData:ee,loading:f}),H&&l.jsx(xUe,{isOpen:H,onClose:()=>K(!1),analyticsData:a,loading:f,selectedYear:e})]})}function wUe(){return l.jsx("div",{children:l.jsx(bUe,{})})}var NA={exports:{}},SUe=NA.exports,CW;function AUe(){return CW||(CW=1,function(e,t){(function(r,n){e.exports=n()})(SUe,function(){var r,n,a;function c(i,x){if(!r)r=x;else if(!n)n=x;else{var w="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+n+")(sharedChunk); self.onerror = null;",A={};r(A),a=x(A),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(a.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}c(["exports"],function(i){function x(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var w,A={},P={};function E(){if(w)return P;w=1,Object.defineProperty(P,"__esModule",{value:!0}),P.setMatrixArrayType=function(v){P.ARRAY_TYPE=s=v},P.toRadian=function(v){return v*p},P.equals=function(v,m){return Math.abs(v-m)<=h*Math.max(1,Math.abs(v),Math.abs(m))},P.RANDOM=P.ARRAY_TYPE=P.EPSILON=void 0;var h=1e-6;P.EPSILON=h;var s=typeof Float32Array<"u"?Float32Array:Array;P.ARRAY_TYPE=s;var u=Math.random;P.RANDOM=u;var p=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var v=0,m=arguments.length;m--;)v+=arguments[m]*arguments[m];return Math.sqrt(v)}),P}var D,V={};function L(){if(D)return V;function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},h(m)}D=1,Object.defineProperty(V,"__esModule",{value:!0}),V.create=function(){var m=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m},V.clone=function(m){var _=new s.ARRAY_TYPE(4);return _[0]=m[0],_[1]=m[1],_[2]=m[2],_[3]=m[3],_},V.copy=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[3],m},V.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m},V.fromValues=function(m,_,C,O){var B=new s.ARRAY_TYPE(4);return B[0]=m,B[1]=_,B[2]=C,B[3]=O,B},V.set=function(m,_,C,O,B){return m[0]=_,m[1]=C,m[2]=O,m[3]=B,m},V.transpose=function(m,_){if(m===_){var C=_[1];m[1]=_[2],m[2]=C}else m[0]=_[0],m[1]=_[2],m[2]=_[1],m[3]=_[3];return m},V.invert=function(m,_){var C=_[0],O=_[1],B=_[2],j=_[3],R=C*j-B*O;return R?(m[0]=j*(R=1/R),m[1]=-O*R,m[2]=-B*R,m[3]=C*R,m):null},V.adjoint=function(m,_){var C=_[0];return m[0]=_[3],m[1]=-_[1],m[2]=-_[2],m[3]=C,m},V.determinant=function(m){return m[0]*m[3]-m[2]*m[1]},V.multiply=p,V.rotate=function(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=Math.sin(C),M=Math.cos(C);return m[0]=O*M+j*F,m[1]=B*M+R*F,m[2]=O*-F+j*M,m[3]=B*-F+R*M,m},V.scale=function(m,_,C){var O=_[1],B=_[2],j=_[3],R=C[0],F=C[1];return m[0]=_[0]*R,m[1]=O*R,m[2]=B*F,m[3]=j*F,m},V.fromRotation=function(m,_){var C=Math.sin(_),O=Math.cos(_);return m[0]=O,m[1]=C,m[2]=-C,m[3]=O,m},V.fromScaling=function(m,_){return m[0]=_[0],m[1]=0,m[2]=0,m[3]=_[1],m},V.str=function(m){return"mat2("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+")"},V.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3])},V.LDU=function(m,_,C,O){return m[2]=O[2]/O[0],C[0]=O[0],C[1]=O[1],C[3]=O[3]-m[2]*C[1],[m,_,C]},V.add=function(m,_,C){return m[0]=_[0]+C[0],m[1]=_[1]+C[1],m[2]=_[2]+C[2],m[3]=_[3]+C[3],m},V.subtract=v,V.exactEquals=function(m,_){return m[0]===_[0]&&m[1]===_[1]&&m[2]===_[2]&&m[3]===_[3]},V.equals=function(m,_){var C=m[0],O=m[1],B=m[2],j=m[3],R=_[0],F=_[1],M=_[2],I=_[3];return Math.abs(C-R)<=s.EPSILON*Math.max(1,Math.abs(C),Math.abs(R))&&Math.abs(O-F)<=s.EPSILON*Math.max(1,Math.abs(O),Math.abs(F))&&Math.abs(B-M)<=s.EPSILON*Math.max(1,Math.abs(B),Math.abs(M))&&Math.abs(j-I)<=s.EPSILON*Math.max(1,Math.abs(j),Math.abs(I))},V.multiplyScalar=function(m,_,C){return m[0]=_[0]*C,m[1]=_[1]*C,m[2]=_[2]*C,m[3]=_[3]*C,m},V.multiplyScalarAndAdd=function(m,_,C,O){return m[0]=_[0]+C[0]*O,m[1]=_[1]+C[1]*O,m[2]=_[2]+C[2]*O,m[3]=_[3]+C[3]*O,m},V.sub=V.mul=void 0;var s=function(m,_){if(m&&m.__esModule)return m;if(m===null||h(m)!=="object"&&typeof m!="function")return{default:m};var C=u(void 0);if(C&&C.has(m))return C.get(m);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in m)if(j!=="default"&&Object.prototype.hasOwnProperty.call(m,j)){var R=B?Object.getOwnPropertyDescriptor(m,j):null;R&&(R.get||R.set)?Object.defineProperty(O,j,R):O[j]=m[j]}return O.default=m,C&&C.set(m,O),O}(E());function u(m){if(typeof WeakMap!="function")return null;var _=new WeakMap,C=new WeakMap;return(u=function(O){return O?C:_})(m)}function p(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=C[0],M=C[1],I=C[2],q=C[3];return m[0]=O*F+j*M,m[1]=B*F+R*M,m[2]=O*I+j*q,m[3]=B*I+R*q,m}function v(m,_,C){return m[0]=_[0]-C[0],m[1]=_[1]-C[1],m[2]=_[2]-C[2],m[3]=_[3]-C[3],m}return V.mul=p,V.sub=v,V}var $,H={};function K(){if($)return H;function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},h(m)}$=1,Object.defineProperty(H,"__esModule",{value:!0}),H.create=function(){var m=new s.ARRAY_TYPE(6);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[4]=0,m[5]=0),m[0]=1,m[3]=1,m},H.clone=function(m){var _=new s.ARRAY_TYPE(6);return _[0]=m[0],_[1]=m[1],_[2]=m[2],_[3]=m[3],_[4]=m[4],_[5]=m[5],_},H.copy=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[3],m[4]=_[4],m[5]=_[5],m},H.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=0,m[5]=0,m},H.fromValues=function(m,_,C,O,B,j){var R=new s.ARRAY_TYPE(6);return R[0]=m,R[1]=_,R[2]=C,R[3]=O,R[4]=B,R[5]=j,R},H.set=function(m,_,C,O,B,j,R){return m[0]=_,m[1]=C,m[2]=O,m[3]=B,m[4]=j,m[5]=R,m},H.invert=function(m,_){var C=_[0],O=_[1],B=_[2],j=_[3],R=_[4],F=_[5],M=C*j-O*B;return M?(m[0]=j*(M=1/M),m[1]=-O*M,m[2]=-B*M,m[3]=C*M,m[4]=(B*F-j*R)*M,m[5]=(O*R-C*F)*M,m):null},H.determinant=function(m){return m[0]*m[3]-m[1]*m[2]},H.multiply=p,H.rotate=function(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=_[4],M=_[5],I=Math.sin(C),q=Math.cos(C);return m[0]=O*q+j*I,m[1]=B*q+R*I,m[2]=O*-I+j*q,m[3]=B*-I+R*q,m[4]=F,m[5]=M,m},H.scale=function(m,_,C){var O=_[1],B=_[2],j=_[3],R=_[4],F=_[5],M=C[0],I=C[1];return m[0]=_[0]*M,m[1]=O*M,m[2]=B*I,m[3]=j*I,m[4]=R,m[5]=F,m},H.translate=function(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=_[4],M=_[5],I=C[0],q=C[1];return m[0]=O,m[1]=B,m[2]=j,m[3]=R,m[4]=O*I+j*q+F,m[5]=B*I+R*q+M,m},H.fromRotation=function(m,_){var C=Math.sin(_),O=Math.cos(_);return m[0]=O,m[1]=C,m[2]=-C,m[3]=O,m[4]=0,m[5]=0,m},H.fromScaling=function(m,_){return m[0]=_[0],m[1]=0,m[2]=0,m[3]=_[1],m[4]=0,m[5]=0,m},H.fromTranslation=function(m,_){return m[0]=1,m[1]=0,m[2]=0,m[3]=1,m[4]=_[0],m[5]=_[1],m},H.str=function(m){return"mat2d("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+")"},H.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],1)},H.add=function(m,_,C){return m[0]=_[0]+C[0],m[1]=_[1]+C[1],m[2]=_[2]+C[2],m[3]=_[3]+C[3],m[4]=_[4]+C[4],m[5]=_[5]+C[5],m},H.subtract=v,H.multiplyScalar=function(m,_,C){return m[0]=_[0]*C,m[1]=_[1]*C,m[2]=_[2]*C,m[3]=_[3]*C,m[4]=_[4]*C,m[5]=_[5]*C,m},H.multiplyScalarAndAdd=function(m,_,C,O){return m[0]=_[0]+C[0]*O,m[1]=_[1]+C[1]*O,m[2]=_[2]+C[2]*O,m[3]=_[3]+C[3]*O,m[4]=_[4]+C[4]*O,m[5]=_[5]+C[5]*O,m},H.exactEquals=function(m,_){return m[0]===_[0]&&m[1]===_[1]&&m[2]===_[2]&&m[3]===_[3]&&m[4]===_[4]&&m[5]===_[5]},H.equals=function(m,_){var C=m[0],O=m[1],B=m[2],j=m[3],R=m[4],F=m[5],M=_[0],I=_[1],q=_[2],X=_[3],te=_[4],le=_[5];return Math.abs(C-M)<=s.EPSILON*Math.max(1,Math.abs(C),Math.abs(M))&&Math.abs(O-I)<=s.EPSILON*Math.max(1,Math.abs(O),Math.abs(I))&&Math.abs(B-q)<=s.EPSILON*Math.max(1,Math.abs(B),Math.abs(q))&&Math.abs(j-X)<=s.EPSILON*Math.max(1,Math.abs(j),Math.abs(X))&&Math.abs(R-te)<=s.EPSILON*Math.max(1,Math.abs(R),Math.abs(te))&&Math.abs(F-le)<=s.EPSILON*Math.max(1,Math.abs(F),Math.abs(le))},H.sub=H.mul=void 0;var s=function(m,_){if(m&&m.__esModule)return m;if(m===null||h(m)!=="object"&&typeof m!="function")return{default:m};var C=u(void 0);if(C&&C.has(m))return C.get(m);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in m)if(j!=="default"&&Object.prototype.hasOwnProperty.call(m,j)){var R=B?Object.getOwnPropertyDescriptor(m,j):null;R&&(R.get||R.set)?Object.defineProperty(O,j,R):O[j]=m[j]}return O.default=m,C&&C.set(m,O),O}(E());function u(m){if(typeof WeakMap!="function")return null;var _=new WeakMap,C=new WeakMap;return(u=function(O){return O?C:_})(m)}function p(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=_[4],M=_[5],I=C[0],q=C[1],X=C[2],te=C[3],le=C[4],ue=C[5];return m[0]=O*I+j*q,m[1]=B*I+R*q,m[2]=O*X+j*te,m[3]=B*X+R*te,m[4]=O*le+j*ue+F,m[5]=B*le+R*ue+M,m}function v(m,_,C){return m[0]=_[0]-C[0],m[1]=_[1]-C[1],m[2]=_[2]-C[2],m[3]=_[3]-C[3],m[4]=_[4]-C[4],m[5]=_[5]-C[5],m}return H.mul=p,H.sub=v,H}var Q,ae={};function ee(){if(Q)return ae;function h(m){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},h(m)}Q=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.create=function(){var m=new s.ARRAY_TYPE(9);return s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0,m[3]=0,m[5]=0,m[6]=0,m[7]=0),m[0]=1,m[4]=1,m[8]=1,m},ae.fromMat4=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[4],m[4]=_[5],m[5]=_[6],m[6]=_[8],m[7]=_[9],m[8]=_[10],m},ae.clone=function(m){var _=new s.ARRAY_TYPE(9);return _[0]=m[0],_[1]=m[1],_[2]=m[2],_[3]=m[3],_[4]=m[4],_[5]=m[5],_[6]=m[6],_[7]=m[7],_[8]=m[8],_},ae.copy=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=_[2],m[3]=_[3],m[4]=_[4],m[5]=_[5],m[6]=_[6],m[7]=_[7],m[8]=_[8],m},ae.fromValues=function(m,_,C,O,B,j,R,F,M){var I=new s.ARRAY_TYPE(9);return I[0]=m,I[1]=_,I[2]=C,I[3]=O,I[4]=B,I[5]=j,I[6]=R,I[7]=F,I[8]=M,I},ae.set=function(m,_,C,O,B,j,R,F,M,I){return m[0]=_,m[1]=C,m[2]=O,m[3]=B,m[4]=j,m[5]=R,m[6]=F,m[7]=M,m[8]=I,m},ae.identity=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.transpose=function(m,_){if(m===_){var C=_[1],O=_[2],B=_[5];m[1]=_[3],m[2]=_[6],m[3]=C,m[5]=_[7],m[6]=O,m[7]=B}else m[0]=_[0],m[1]=_[3],m[2]=_[6],m[3]=_[1],m[4]=_[4],m[5]=_[7],m[6]=_[2],m[7]=_[5],m[8]=_[8];return m},ae.invert=function(m,_){var C=_[0],O=_[1],B=_[2],j=_[3],R=_[4],F=_[5],M=_[6],I=_[7],q=_[8],X=q*R-F*I,te=-q*j+F*M,le=I*j-R*M,ue=C*X+O*te+B*le;return ue?(m[0]=X*(ue=1/ue),m[1]=(-q*O+B*I)*ue,m[2]=(F*O-B*R)*ue,m[3]=te*ue,m[4]=(q*C-B*M)*ue,m[5]=(-F*C+B*j)*ue,m[6]=le*ue,m[7]=(-I*C+O*M)*ue,m[8]=(R*C-O*j)*ue,m):null},ae.adjoint=function(m,_){var C=_[0],O=_[1],B=_[2],j=_[3],R=_[4],F=_[5],M=_[6],I=_[7],q=_[8];return m[0]=R*q-F*I,m[1]=B*I-O*q,m[2]=O*F-B*R,m[3]=F*M-j*q,m[4]=C*q-B*M,m[5]=B*j-C*F,m[6]=j*I-R*M,m[7]=O*M-C*I,m[8]=C*R-O*j,m},ae.determinant=function(m){var _=m[3],C=m[4],O=m[5],B=m[6],j=m[7],R=m[8];return m[0]*(R*C-O*j)+m[1]*(-R*_+O*B)+m[2]*(j*_-C*B)},ae.multiply=p,ae.translate=function(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=_[4],M=_[5],I=_[6],q=_[7],X=_[8],te=C[0],le=C[1];return m[0]=O,m[1]=B,m[2]=j,m[3]=R,m[4]=F,m[5]=M,m[6]=te*O+le*R+I,m[7]=te*B+le*F+q,m[8]=te*j+le*M+X,m},ae.rotate=function(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=_[4],M=_[5],I=_[6],q=_[7],X=_[8],te=Math.sin(C),le=Math.cos(C);return m[0]=le*O+te*R,m[1]=le*B+te*F,m[2]=le*j+te*M,m[3]=le*R-te*O,m[4]=le*F-te*B,m[5]=le*M-te*j,m[6]=I,m[7]=q,m[8]=X,m},ae.scale=function(m,_,C){var O=C[0],B=C[1];return m[0]=O*_[0],m[1]=O*_[1],m[2]=O*_[2],m[3]=B*_[3],m[4]=B*_[4],m[5]=B*_[5],m[6]=_[6],m[7]=_[7],m[8]=_[8],m},ae.fromTranslation=function(m,_){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=1,m[5]=0,m[6]=_[0],m[7]=_[1],m[8]=1,m},ae.fromRotation=function(m,_){var C=Math.sin(_),O=Math.cos(_);return m[0]=O,m[1]=C,m[2]=0,m[3]=-C,m[4]=O,m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.fromScaling=function(m,_){return m[0]=_[0],m[1]=0,m[2]=0,m[3]=0,m[4]=_[1],m[5]=0,m[6]=0,m[7]=0,m[8]=1,m},ae.fromMat2d=function(m,_){return m[0]=_[0],m[1]=_[1],m[2]=0,m[3]=_[2],m[4]=_[3],m[5]=0,m[6]=_[4],m[7]=_[5],m[8]=1,m},ae.fromQuat=function(m,_){var C=_[0],O=_[1],B=_[2],j=_[3],R=C+C,F=O+O,M=B+B,I=C*R,q=O*R,X=O*F,te=B*R,le=B*F,ue=B*M,ie=j*R,fe=j*F,ye=j*M;return m[0]=1-X-ue,m[3]=q-ye,m[6]=te+fe,m[1]=q+ye,m[4]=1-I-ue,m[7]=le-ie,m[2]=te-fe,m[5]=le+ie,m[8]=1-I-X,m},ae.normalFromMat4=function(m,_){var C=_[0],O=_[1],B=_[2],j=_[3],R=_[4],F=_[5],M=_[6],I=_[7],q=_[8],X=_[9],te=_[10],le=_[11],ue=_[12],ie=_[13],fe=_[14],ye=_[15],Se=C*F-O*R,Le=C*M-B*R,Ie=C*I-j*R,Me=O*M-B*F,et=O*I-j*F,Be=B*I-j*M,rt=q*ie-X*ue,st=q*fe-te*ue,nt=q*ye-le*ue,ct=X*fe-te*ie,ht=X*ye-le*ie,vt=te*ye-le*fe,ut=Se*vt-Le*ht+Ie*ct+Me*nt-et*st+Be*rt;return ut?(m[0]=(F*vt-M*ht+I*ct)*(ut=1/ut),m[1]=(M*nt-R*vt-I*st)*ut,m[2]=(R*ht-F*nt+I*rt)*ut,m[3]=(B*ht-O*vt-j*ct)*ut,m[4]=(C*vt-B*nt+j*st)*ut,m[5]=(O*nt-C*ht-j*rt)*ut,m[6]=(ie*Be-fe*et+ye*Me)*ut,m[7]=(fe*Ie-ue*Be-ye*Le)*ut,m[8]=(ue*et-ie*Ie+ye*Se)*ut,m):null},ae.projection=function(m,_,C){return m[0]=2/_,m[1]=0,m[2]=0,m[3]=0,m[4]=-2/C,m[5]=0,m[6]=-1,m[7]=1,m[8]=1,m},ae.str=function(m){return"mat3("+m[0]+", "+m[1]+", "+m[2]+", "+m[3]+", "+m[4]+", "+m[5]+", "+m[6]+", "+m[7]+", "+m[8]+")"},ae.frob=function(m){return Math.hypot(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8])},ae.add=function(m,_,C){return m[0]=_[0]+C[0],m[1]=_[1]+C[1],m[2]=_[2]+C[2],m[3]=_[3]+C[3],m[4]=_[4]+C[4],m[5]=_[5]+C[5],m[6]=_[6]+C[6],m[7]=_[7]+C[7],m[8]=_[8]+C[8],m},ae.subtract=v,ae.multiplyScalar=function(m,_,C){return m[0]=_[0]*C,m[1]=_[1]*C,m[2]=_[2]*C,m[3]=_[3]*C,m[4]=_[4]*C,m[5]=_[5]*C,m[6]=_[6]*C,m[7]=_[7]*C,m[8]=_[8]*C,m},ae.multiplyScalarAndAdd=function(m,_,C,O){return m[0]=_[0]+C[0]*O,m[1]=_[1]+C[1]*O,m[2]=_[2]+C[2]*O,m[3]=_[3]+C[3]*O,m[4]=_[4]+C[4]*O,m[5]=_[5]+C[5]*O,m[6]=_[6]+C[6]*O,m[7]=_[7]+C[7]*O,m[8]=_[8]+C[8]*O,m},ae.exactEquals=function(m,_){return m[0]===_[0]&&m[1]===_[1]&&m[2]===_[2]&&m[3]===_[3]&&m[4]===_[4]&&m[5]===_[5]&&m[6]===_[6]&&m[7]===_[7]&&m[8]===_[8]},ae.equals=function(m,_){var C=m[0],O=m[1],B=m[2],j=m[3],R=m[4],F=m[5],M=m[6],I=m[7],q=m[8],X=_[0],te=_[1],le=_[2],ue=_[3],ie=_[4],fe=_[5],ye=_[6],Se=_[7],Le=_[8];return Math.abs(C-X)<=s.EPSILON*Math.max(1,Math.abs(C),Math.abs(X))&&Math.abs(O-te)<=s.EPSILON*Math.max(1,Math.abs(O),Math.abs(te))&&Math.abs(B-le)<=s.EPSILON*Math.max(1,Math.abs(B),Math.abs(le))&&Math.abs(j-ue)<=s.EPSILON*Math.max(1,Math.abs(j),Math.abs(ue))&&Math.abs(R-ie)<=s.EPSILON*Math.max(1,Math.abs(R),Math.abs(ie))&&Math.abs(F-fe)<=s.EPSILON*Math.max(1,Math.abs(F),Math.abs(fe))&&Math.abs(M-ye)<=s.EPSILON*Math.max(1,Math.abs(M),Math.abs(ye))&&Math.abs(I-Se)<=s.EPSILON*Math.max(1,Math.abs(I),Math.abs(Se))&&Math.abs(q-Le)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(Le))},ae.sub=ae.mul=void 0;var s=function(m,_){if(m&&m.__esModule)return m;if(m===null||h(m)!=="object"&&typeof m!="function")return{default:m};var C=u(void 0);if(C&&C.has(m))return C.get(m);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in m)if(j!=="default"&&Object.prototype.hasOwnProperty.call(m,j)){var R=B?Object.getOwnPropertyDescriptor(m,j):null;R&&(R.get||R.set)?Object.defineProperty(O,j,R):O[j]=m[j]}return O.default=m,C&&C.set(m,O),O}(E());function u(m){if(typeof WeakMap!="function")return null;var _=new WeakMap,C=new WeakMap;return(u=function(O){return O?C:_})(m)}function p(m,_,C){var O=_[0],B=_[1],j=_[2],R=_[3],F=_[4],M=_[5],I=_[6],q=_[7],X=_[8],te=C[0],le=C[1],ue=C[2],ie=C[3],fe=C[4],ye=C[5],Se=C[6],Le=C[7],Ie=C[8];return m[0]=te*O+le*R+ue*I,m[1]=te*B+le*F+ue*q,m[2]=te*j+le*M+ue*X,m[3]=ie*O+fe*R+ye*I,m[4]=ie*B+fe*F+ye*q,m[5]=ie*j+fe*M+ye*X,m[6]=Se*O+Le*R+Ie*I,m[7]=Se*B+Le*F+Ie*q,m[8]=Se*j+Le*M+Ie*X,m}function v(m,_,C){return m[0]=_[0]-C[0],m[1]=_[1]-C[1],m[2]=_[2]-C[2],m[3]=_[3]-C[3],m[4]=_[4]-C[4],m[5]=_[5]-C[5],m[6]=_[6]-C[6],m[7]=_[7]-C[7],m[8]=_[8]-C[8],m}return ae.mul=p,ae.sub=v,ae}var se,ce={};function he(){if(se)return ce;function h(j){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},h(j)}se=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=function(){var j=new s.ARRAY_TYPE(16);return s.ARRAY_TYPE!=Float32Array&&(j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[11]=0,j[12]=0,j[13]=0,j[14]=0),j[0]=1,j[5]=1,j[10]=1,j[15]=1,j},ce.clone=function(j){var R=new s.ARRAY_TYPE(16);return R[0]=j[0],R[1]=j[1],R[2]=j[2],R[3]=j[3],R[4]=j[4],R[5]=j[5],R[6]=j[6],R[7]=j[7],R[8]=j[8],R[9]=j[9],R[10]=j[10],R[11]=j[11],R[12]=j[12],R[13]=j[13],R[14]=j[14],R[15]=j[15],R},ce.copy=function(j,R){return j[0]=R[0],j[1]=R[1],j[2]=R[2],j[3]=R[3],j[4]=R[4],j[5]=R[5],j[6]=R[6],j[7]=R[7],j[8]=R[8],j[9]=R[9],j[10]=R[10],j[11]=R[11],j[12]=R[12],j[13]=R[13],j[14]=R[14],j[15]=R[15],j},ce.fromValues=function(j,R,F,M,I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie){var Me=new s.ARRAY_TYPE(16);return Me[0]=j,Me[1]=R,Me[2]=F,Me[3]=M,Me[4]=I,Me[5]=q,Me[6]=X,Me[7]=te,Me[8]=le,Me[9]=ue,Me[10]=ie,Me[11]=fe,Me[12]=ye,Me[13]=Se,Me[14]=Le,Me[15]=Ie,Me},ce.set=function(j,R,F,M,I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie,Me){return j[0]=R,j[1]=F,j[2]=M,j[3]=I,j[4]=q,j[5]=X,j[6]=te,j[7]=le,j[8]=ue,j[9]=ie,j[10]=fe,j[11]=ye,j[12]=Se,j[13]=Le,j[14]=Ie,j[15]=Me,j},ce.identity=p,ce.transpose=function(j,R){if(j===R){var F=R[1],M=R[2],I=R[3],q=R[6],X=R[7],te=R[11];j[1]=R[4],j[2]=R[8],j[3]=R[12],j[4]=F,j[6]=R[9],j[7]=R[13],j[8]=M,j[9]=q,j[11]=R[14],j[12]=I,j[13]=X,j[14]=te}else j[0]=R[0],j[1]=R[4],j[2]=R[8],j[3]=R[12],j[4]=R[1],j[5]=R[5],j[6]=R[9],j[7]=R[13],j[8]=R[2],j[9]=R[6],j[10]=R[10],j[11]=R[14],j[12]=R[3],j[13]=R[7],j[14]=R[11],j[15]=R[15];return j},ce.invert=function(j,R){var F=R[0],M=R[1],I=R[2],q=R[3],X=R[4],te=R[5],le=R[6],ue=R[7],ie=R[8],fe=R[9],ye=R[10],Se=R[11],Le=R[12],Ie=R[13],Me=R[14],et=R[15],Be=F*te-M*X,rt=F*le-I*X,st=F*ue-q*X,nt=M*le-I*te,ct=M*ue-q*te,ht=I*ue-q*le,vt=ie*Ie-fe*Le,ut=ie*Me-ye*Le,It=ie*et-Se*Le,Wt=fe*Me-ye*Ie,Rt=fe*et-Se*Ie,mr=ye*et-Se*Me,dr=Be*mr-rt*Rt+st*Wt+nt*It-ct*ut+ht*vt;return dr?(j[0]=(te*mr-le*Rt+ue*Wt)*(dr=1/dr),j[1]=(I*Rt-M*mr-q*Wt)*dr,j[2]=(Ie*ht-Me*ct+et*nt)*dr,j[3]=(ye*ct-fe*ht-Se*nt)*dr,j[4]=(le*It-X*mr-ue*ut)*dr,j[5]=(F*mr-I*It+q*ut)*dr,j[6]=(Me*st-Le*ht-et*rt)*dr,j[7]=(ie*ht-ye*st+Se*rt)*dr,j[8]=(X*Rt-te*It+ue*vt)*dr,j[9]=(M*It-F*Rt-q*vt)*dr,j[10]=(Le*ct-Ie*st+et*Be)*dr,j[11]=(fe*st-ie*ct-Se*Be)*dr,j[12]=(te*ut-X*Wt-le*vt)*dr,j[13]=(F*Wt-M*ut+I*vt)*dr,j[14]=(Ie*rt-Le*nt-Me*Be)*dr,j[15]=(ie*nt-fe*rt+ye*Be)*dr,j):null},ce.adjoint=function(j,R){var F=R[0],M=R[1],I=R[2],q=R[3],X=R[4],te=R[5],le=R[6],ue=R[7],ie=R[8],fe=R[9],ye=R[10],Se=R[11],Le=R[12],Ie=R[13],Me=R[14],et=R[15];return j[0]=te*(ye*et-Se*Me)-fe*(le*et-ue*Me)+Ie*(le*Se-ue*ye),j[1]=-(M*(ye*et-Se*Me)-fe*(I*et-q*Me)+Ie*(I*Se-q*ye)),j[2]=M*(le*et-ue*Me)-te*(I*et-q*Me)+Ie*(I*ue-q*le),j[3]=-(M*(le*Se-ue*ye)-te*(I*Se-q*ye)+fe*(I*ue-q*le)),j[4]=-(X*(ye*et-Se*Me)-ie*(le*et-ue*Me)+Le*(le*Se-ue*ye)),j[5]=F*(ye*et-Se*Me)-ie*(I*et-q*Me)+Le*(I*Se-q*ye),j[6]=-(F*(le*et-ue*Me)-X*(I*et-q*Me)+Le*(I*ue-q*le)),j[7]=F*(le*Se-ue*ye)-X*(I*Se-q*ye)+ie*(I*ue-q*le),j[8]=X*(fe*et-Se*Ie)-ie*(te*et-ue*Ie)+Le*(te*Se-ue*fe),j[9]=-(F*(fe*et-Se*Ie)-ie*(M*et-q*Ie)+Le*(M*Se-q*fe)),j[10]=F*(te*et-ue*Ie)-X*(M*et-q*Ie)+Le*(M*ue-q*te),j[11]=-(F*(te*Se-ue*fe)-X*(M*Se-q*fe)+ie*(M*ue-q*te)),j[12]=-(X*(fe*Me-ye*Ie)-ie*(te*Me-le*Ie)+Le*(te*ye-le*fe)),j[13]=F*(fe*Me-ye*Ie)-ie*(M*Me-I*Ie)+Le*(M*ye-I*fe),j[14]=-(F*(te*Me-le*Ie)-X*(M*Me-I*Ie)+Le*(M*le-I*te)),j[15]=F*(te*ye-le*fe)-X*(M*ye-I*fe)+ie*(M*le-I*te),j},ce.determinant=function(j){var R=j[0],F=j[1],M=j[2],I=j[3],q=j[4],X=j[5],te=j[6],le=j[7],ue=j[8],ie=j[9],fe=j[10],ye=j[11],Se=j[12],Le=j[13],Ie=j[14],Me=j[15];return(R*X-F*q)*(fe*Me-ye*Ie)-(R*te-M*q)*(ie*Me-ye*Le)+(R*le-I*q)*(ie*Ie-fe*Le)+(F*te-M*X)*(ue*Me-ye*Se)-(F*le-I*X)*(ue*Ie-fe*Se)+(M*le-I*te)*(ue*Le-ie*Se)},ce.multiply=v,ce.translate=function(j,R,F){var M,I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie=F[0],Me=F[1],et=F[2];return R===j?(j[12]=R[0]*Ie+R[4]*Me+R[8]*et+R[12],j[13]=R[1]*Ie+R[5]*Me+R[9]*et+R[13],j[14]=R[2]*Ie+R[6]*Me+R[10]*et+R[14],j[15]=R[3]*Ie+R[7]*Me+R[11]*et+R[15]):(I=R[1],q=R[2],X=R[3],te=R[4],le=R[5],ue=R[6],ie=R[7],fe=R[8],ye=R[9],Se=R[10],Le=R[11],j[0]=M=R[0],j[1]=I,j[2]=q,j[3]=X,j[4]=te,j[5]=le,j[6]=ue,j[7]=ie,j[8]=fe,j[9]=ye,j[10]=Se,j[11]=Le,j[12]=M*Ie+te*Me+fe*et+R[12],j[13]=I*Ie+le*Me+ye*et+R[13],j[14]=q*Ie+ue*Me+Se*et+R[14],j[15]=X*Ie+ie*Me+Le*et+R[15]),j},ce.scale=function(j,R,F){var M=F[0],I=F[1],q=F[2];return j[0]=R[0]*M,j[1]=R[1]*M,j[2]=R[2]*M,j[3]=R[3]*M,j[4]=R[4]*I,j[5]=R[5]*I,j[6]=R[6]*I,j[7]=R[7]*I,j[8]=R[8]*q,j[9]=R[9]*q,j[10]=R[10]*q,j[11]=R[11]*q,j[12]=R[12],j[13]=R[13],j[14]=R[14],j[15]=R[15],j},ce.rotate=function(j,R,F,M){var I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie,Me,et,Be,rt,st,nt,ct,ht,vt,ut,It,Wt,Rt=M[0],mr=M[1],dr=M[2],tr=Math.hypot(Rt,mr,dr);return tr<s.EPSILON?null:(Rt*=tr=1/tr,mr*=tr,dr*=tr,I=Math.sin(F),q=Math.cos(F),le=R[1],ue=R[2],ie=R[3],ye=R[5],Se=R[6],Le=R[7],Me=R[9],et=R[10],Be=R[11],rt=Rt*Rt*(X=1-q)+q,ct=Rt*mr*X-dr*I,ht=mr*mr*X+q,vt=dr*mr*X+Rt*I,ut=Rt*dr*X+mr*I,It=mr*dr*X-Rt*I,Wt=dr*dr*X+q,j[0]=(te=R[0])*rt+(fe=R[4])*(st=mr*Rt*X+dr*I)+(Ie=R[8])*(nt=dr*Rt*X-mr*I),j[1]=le*rt+ye*st+Me*nt,j[2]=ue*rt+Se*st+et*nt,j[3]=ie*rt+Le*st+Be*nt,j[4]=te*ct+fe*ht+Ie*vt,j[5]=le*ct+ye*ht+Me*vt,j[6]=ue*ct+Se*ht+et*vt,j[7]=ie*ct+Le*ht+Be*vt,j[8]=te*ut+fe*It+Ie*Wt,j[9]=le*ut+ye*It+Me*Wt,j[10]=ue*ut+Se*It+et*Wt,j[11]=ie*ut+Le*It+Be*Wt,R!==j&&(j[12]=R[12],j[13]=R[13],j[14]=R[14],j[15]=R[15]),j)},ce.rotateX=function(j,R,F){var M=Math.sin(F),I=Math.cos(F),q=R[4],X=R[5],te=R[6],le=R[7],ue=R[8],ie=R[9],fe=R[10],ye=R[11];return R!==j&&(j[0]=R[0],j[1]=R[1],j[2]=R[2],j[3]=R[3],j[12]=R[12],j[13]=R[13],j[14]=R[14],j[15]=R[15]),j[4]=q*I+ue*M,j[5]=X*I+ie*M,j[6]=te*I+fe*M,j[7]=le*I+ye*M,j[8]=ue*I-q*M,j[9]=ie*I-X*M,j[10]=fe*I-te*M,j[11]=ye*I-le*M,j},ce.rotateY=function(j,R,F){var M=Math.sin(F),I=Math.cos(F),q=R[0],X=R[1],te=R[2],le=R[3],ue=R[8],ie=R[9],fe=R[10],ye=R[11];return R!==j&&(j[4]=R[4],j[5]=R[5],j[6]=R[6],j[7]=R[7],j[12]=R[12],j[13]=R[13],j[14]=R[14],j[15]=R[15]),j[0]=q*I-ue*M,j[1]=X*I-ie*M,j[2]=te*I-fe*M,j[3]=le*I-ye*M,j[8]=q*M+ue*I,j[9]=X*M+ie*I,j[10]=te*M+fe*I,j[11]=le*M+ye*I,j},ce.rotateZ=function(j,R,F){var M=Math.sin(F),I=Math.cos(F),q=R[0],X=R[1],te=R[2],le=R[3],ue=R[4],ie=R[5],fe=R[6],ye=R[7];return R!==j&&(j[8]=R[8],j[9]=R[9],j[10]=R[10],j[11]=R[11],j[12]=R[12],j[13]=R[13],j[14]=R[14],j[15]=R[15]),j[0]=q*I+ue*M,j[1]=X*I+ie*M,j[2]=te*I+fe*M,j[3]=le*I+ye*M,j[4]=ue*I-q*M,j[5]=ie*I-X*M,j[6]=fe*I-te*M,j[7]=ye*I-le*M,j},ce.fromTranslation=function(j,R){return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=R[0],j[13]=R[1],j[14]=R[2],j[15]=1,j},ce.fromScaling=function(j,R){return j[0]=R[0],j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=R[1],j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=R[2],j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},ce.fromRotation=function(j,R,F){var M,I,q,X=F[0],te=F[1],le=F[2],ue=Math.hypot(X,te,le);return ue<s.EPSILON?null:(X*=ue=1/ue,te*=ue,le*=ue,M=Math.sin(R),I=Math.cos(R),j[0]=X*X*(q=1-I)+I,j[1]=te*X*q+le*M,j[2]=le*X*q-te*M,j[3]=0,j[4]=X*te*q-le*M,j[5]=te*te*q+I,j[6]=le*te*q+X*M,j[7]=0,j[8]=X*le*q+te*M,j[9]=te*le*q-X*M,j[10]=le*le*q+I,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j)},ce.fromXRotation=function(j,R){var F=Math.sin(R),M=Math.cos(R);return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=M,j[6]=F,j[7]=0,j[8]=0,j[9]=-F,j[10]=M,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},ce.fromYRotation=function(j,R){var F=Math.sin(R),M=Math.cos(R);return j[0]=M,j[1]=0,j[2]=-F,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=F,j[9]=0,j[10]=M,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},ce.fromZRotation=function(j,R){var F=Math.sin(R),M=Math.cos(R);return j[0]=M,j[1]=F,j[2]=0,j[3]=0,j[4]=-F,j[5]=M,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},ce.fromRotationTranslation=m,ce.fromQuat2=function(j,R){var F=new s.ARRAY_TYPE(3),M=-R[0],I=-R[1],q=-R[2],X=R[3],te=R[4],le=R[5],ue=R[6],ie=R[7],fe=M*M+I*I+q*q+X*X;return fe>0?(F[0]=2*(te*X+ie*M+le*q-ue*I)/fe,F[1]=2*(le*X+ie*I+ue*M-te*q)/fe,F[2]=2*(ue*X+ie*q+te*I-le*M)/fe):(F[0]=2*(te*X+ie*M+le*q-ue*I),F[1]=2*(le*X+ie*I+ue*M-te*q),F[2]=2*(ue*X+ie*q+te*I-le*M)),m(j,R,F),j},ce.getTranslation=function(j,R){return j[0]=R[12],j[1]=R[13],j[2]=R[14],j},ce.getScaling=_,ce.getRotation=function(j,R){var F=new s.ARRAY_TYPE(3);_(F,R);var M=1/F[0],I=1/F[1],q=1/F[2],X=R[0]*M,te=R[1]*I,le=R[2]*q,ue=R[4]*M,ie=R[5]*I,fe=R[6]*q,ye=R[8]*M,Se=R[9]*I,Le=R[10]*q,Ie=X+ie+Le,Me=0;return Ie>0?(Me=2*Math.sqrt(Ie+1),j[3]=.25*Me,j[0]=(fe-Se)/Me,j[1]=(ye-le)/Me,j[2]=(te-ue)/Me):X>ie&&X>Le?(Me=2*Math.sqrt(1+X-ie-Le),j[3]=(fe-Se)/Me,j[0]=.25*Me,j[1]=(te+ue)/Me,j[2]=(ye+le)/Me):ie>Le?(Me=2*Math.sqrt(1+ie-X-Le),j[3]=(ye-le)/Me,j[0]=(te+ue)/Me,j[1]=.25*Me,j[2]=(fe+Se)/Me):(Me=2*Math.sqrt(1+Le-X-ie),j[3]=(te-ue)/Me,j[0]=(ye+le)/Me,j[1]=(fe+Se)/Me,j[2]=.25*Me),j},ce.fromRotationTranslationScale=function(j,R,F,M){var I=R[0],q=R[1],X=R[2],te=R[3],le=I+I,ue=q+q,ie=X+X,fe=I*le,ye=I*ue,Se=I*ie,Le=q*ue,Ie=q*ie,Me=X*ie,et=te*le,Be=te*ue,rt=te*ie,st=M[0],nt=M[1],ct=M[2];return j[0]=(1-(Le+Me))*st,j[1]=(ye+rt)*st,j[2]=(Se-Be)*st,j[3]=0,j[4]=(ye-rt)*nt,j[5]=(1-(fe+Me))*nt,j[6]=(Ie+et)*nt,j[7]=0,j[8]=(Se+Be)*ct,j[9]=(Ie-et)*ct,j[10]=(1-(fe+Le))*ct,j[11]=0,j[12]=F[0],j[13]=F[1],j[14]=F[2],j[15]=1,j},ce.fromRotationTranslationScaleOrigin=function(j,R,F,M,I){var q=R[0],X=R[1],te=R[2],le=R[3],ue=q+q,ie=X+X,fe=te+te,ye=q*ue,Se=q*ie,Le=q*fe,Ie=X*ie,Me=X*fe,et=te*fe,Be=le*ue,rt=le*ie,st=le*fe,nt=M[0],ct=M[1],ht=M[2],vt=I[0],ut=I[1],It=I[2],Wt=(1-(Ie+et))*nt,Rt=(Se+st)*nt,mr=(Le-rt)*nt,dr=(Se-st)*ct,tr=(1-(ye+et))*ct,Ht=(Me+Be)*ct,kr=(Le+rt)*ht,vr=(Me-Be)*ht,br=(1-(ye+Ie))*ht;return j[0]=Wt,j[1]=Rt,j[2]=mr,j[3]=0,j[4]=dr,j[5]=tr,j[6]=Ht,j[7]=0,j[8]=kr,j[9]=vr,j[10]=br,j[11]=0,j[12]=F[0]+vt-(Wt*vt+dr*ut+kr*It),j[13]=F[1]+ut-(Rt*vt+tr*ut+vr*It),j[14]=F[2]+It-(mr*vt+Ht*ut+br*It),j[15]=1,j},ce.fromQuat=function(j,R){var F=R[0],M=R[1],I=R[2],q=R[3],X=F+F,te=M+M,le=I+I,ue=F*X,ie=M*X,fe=M*te,ye=I*X,Se=I*te,Le=I*le,Ie=q*X,Me=q*te,et=q*le;return j[0]=1-fe-Le,j[1]=ie+et,j[2]=ye-Me,j[3]=0,j[4]=ie-et,j[5]=1-ue-Le,j[6]=Se+Ie,j[7]=0,j[8]=ye+Me,j[9]=Se-Ie,j[10]=1-ue-fe,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j},ce.frustum=function(j,R,F,M,I,q,X){var te=1/(F-R),le=1/(I-M),ue=1/(q-X);return j[0]=2*q*te,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=2*q*le,j[6]=0,j[7]=0,j[8]=(F+R)*te,j[9]=(I+M)*le,j[10]=(X+q)*ue,j[11]=-1,j[12]=0,j[13]=0,j[14]=X*q*2*ue,j[15]=0,j},ce.perspectiveNO=C,ce.perspectiveZO=function(j,R,F,M,I){var q,X=1/Math.tan(R/2);return j[0]=X/F,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=X,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[11]=-1,j[12]=0,j[13]=0,j[15]=0,I!=null&&I!==1/0?(j[10]=I*(q=1/(M-I)),j[14]=I*M*q):(j[10]=-1,j[14]=-M),j},ce.perspectiveFromFieldOfView=function(j,R,F,M){var I=Math.tan(R.upDegrees*Math.PI/180),q=Math.tan(R.downDegrees*Math.PI/180),X=Math.tan(R.leftDegrees*Math.PI/180),te=Math.tan(R.rightDegrees*Math.PI/180),le=2/(X+te),ue=2/(I+q);return j[0]=le,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=ue,j[6]=0,j[7]=0,j[8]=-(X-te)*le*.5,j[9]=(I-q)*ue*.5,j[10]=M/(F-M),j[11]=-1,j[12]=0,j[13]=0,j[14]=M*F/(F-M),j[15]=0,j},ce.orthoNO=O,ce.orthoZO=function(j,R,F,M,I,q,X){var te=1/(R-F),le=1/(M-I),ue=1/(q-X);return j[0]=-2*te,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=-2*le,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=ue,j[11]=0,j[12]=(R+F)*te,j[13]=(I+M)*le,j[14]=q*ue,j[15]=1,j},ce.lookAt=function(j,R,F,M){var I,q,X,te,le,ue,ie,fe,ye,Se,Le=R[0],Ie=R[1],Me=R[2],et=M[0],Be=M[1],rt=M[2],st=F[0],nt=F[1],ct=F[2];return Math.abs(Le-st)<s.EPSILON&&Math.abs(Ie-nt)<s.EPSILON&&Math.abs(Me-ct)<s.EPSILON?p(j):(ie=Le-st,fe=Ie-nt,ye=Me-ct,I=Be*(ye*=Se=1/Math.hypot(ie,fe,ye))-rt*(fe*=Se),q=rt*(ie*=Se)-et*ye,X=et*fe-Be*ie,(Se=Math.hypot(I,q,X))?(I*=Se=1/Se,q*=Se,X*=Se):(I=0,q=0,X=0),te=fe*X-ye*q,le=ye*I-ie*X,ue=ie*q-fe*I,(Se=Math.hypot(te,le,ue))?(te*=Se=1/Se,le*=Se,ue*=Se):(te=0,le=0,ue=0),j[0]=I,j[1]=te,j[2]=ie,j[3]=0,j[4]=q,j[5]=le,j[6]=fe,j[7]=0,j[8]=X,j[9]=ue,j[10]=ye,j[11]=0,j[12]=-(I*Le+q*Ie+X*Me),j[13]=-(te*Le+le*Ie+ue*Me),j[14]=-(ie*Le+fe*Ie+ye*Me),j[15]=1,j)},ce.targetTo=function(j,R,F,M){var I=R[0],q=R[1],X=R[2],te=M[0],le=M[1],ue=M[2],ie=I-F[0],fe=q-F[1],ye=X-F[2],Se=ie*ie+fe*fe+ye*ye;Se>0&&(ie*=Se=1/Math.sqrt(Se),fe*=Se,ye*=Se);var Le=le*ye-ue*fe,Ie=ue*ie-te*ye,Me=te*fe-le*ie;return(Se=Le*Le+Ie*Ie+Me*Me)>0&&(Le*=Se=1/Math.sqrt(Se),Ie*=Se,Me*=Se),j[0]=Le,j[1]=Ie,j[2]=Me,j[3]=0,j[4]=fe*Me-ye*Ie,j[5]=ye*Le-ie*Me,j[6]=ie*Ie-fe*Le,j[7]=0,j[8]=ie,j[9]=fe,j[10]=ye,j[11]=0,j[12]=I,j[13]=q,j[14]=X,j[15]=1,j},ce.str=function(j){return"mat4("+j[0]+", "+j[1]+", "+j[2]+", "+j[3]+", "+j[4]+", "+j[5]+", "+j[6]+", "+j[7]+", "+j[8]+", "+j[9]+", "+j[10]+", "+j[11]+", "+j[12]+", "+j[13]+", "+j[14]+", "+j[15]+")"},ce.frob=function(j){return Math.hypot(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],j[8],j[9],j[10],j[11],j[12],j[13],j[14],j[15])},ce.add=function(j,R,F){return j[0]=R[0]+F[0],j[1]=R[1]+F[1],j[2]=R[2]+F[2],j[3]=R[3]+F[3],j[4]=R[4]+F[4],j[5]=R[5]+F[5],j[6]=R[6]+F[6],j[7]=R[7]+F[7],j[8]=R[8]+F[8],j[9]=R[9]+F[9],j[10]=R[10]+F[10],j[11]=R[11]+F[11],j[12]=R[12]+F[12],j[13]=R[13]+F[13],j[14]=R[14]+F[14],j[15]=R[15]+F[15],j},ce.subtract=B,ce.multiplyScalar=function(j,R,F){return j[0]=R[0]*F,j[1]=R[1]*F,j[2]=R[2]*F,j[3]=R[3]*F,j[4]=R[4]*F,j[5]=R[5]*F,j[6]=R[6]*F,j[7]=R[7]*F,j[8]=R[8]*F,j[9]=R[9]*F,j[10]=R[10]*F,j[11]=R[11]*F,j[12]=R[12]*F,j[13]=R[13]*F,j[14]=R[14]*F,j[15]=R[15]*F,j},ce.multiplyScalarAndAdd=function(j,R,F,M){return j[0]=R[0]+F[0]*M,j[1]=R[1]+F[1]*M,j[2]=R[2]+F[2]*M,j[3]=R[3]+F[3]*M,j[4]=R[4]+F[4]*M,j[5]=R[5]+F[5]*M,j[6]=R[6]+F[6]*M,j[7]=R[7]+F[7]*M,j[8]=R[8]+F[8]*M,j[9]=R[9]+F[9]*M,j[10]=R[10]+F[10]*M,j[11]=R[11]+F[11]*M,j[12]=R[12]+F[12]*M,j[13]=R[13]+F[13]*M,j[14]=R[14]+F[14]*M,j[15]=R[15]+F[15]*M,j},ce.exactEquals=function(j,R){return j[0]===R[0]&&j[1]===R[1]&&j[2]===R[2]&&j[3]===R[3]&&j[4]===R[4]&&j[5]===R[5]&&j[6]===R[6]&&j[7]===R[7]&&j[8]===R[8]&&j[9]===R[9]&&j[10]===R[10]&&j[11]===R[11]&&j[12]===R[12]&&j[13]===R[13]&&j[14]===R[14]&&j[15]===R[15]},ce.equals=function(j,R){var F=j[0],M=j[1],I=j[2],q=j[3],X=j[4],te=j[5],le=j[6],ue=j[7],ie=j[8],fe=j[9],ye=j[10],Se=j[11],Le=j[12],Ie=j[13],Me=j[14],et=j[15],Be=R[0],rt=R[1],st=R[2],nt=R[3],ct=R[4],ht=R[5],vt=R[6],ut=R[7],It=R[8],Wt=R[9],Rt=R[10],mr=R[11],dr=R[12],tr=R[13],Ht=R[14],kr=R[15];return Math.abs(F-Be)<=s.EPSILON*Math.max(1,Math.abs(F),Math.abs(Be))&&Math.abs(M-rt)<=s.EPSILON*Math.max(1,Math.abs(M),Math.abs(rt))&&Math.abs(I-st)<=s.EPSILON*Math.max(1,Math.abs(I),Math.abs(st))&&Math.abs(q-nt)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(nt))&&Math.abs(X-ct)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ct))&&Math.abs(te-ht)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(ht))&&Math.abs(le-vt)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(vt))&&Math.abs(ue-ut)<=s.EPSILON*Math.max(1,Math.abs(ue),Math.abs(ut))&&Math.abs(ie-It)<=s.EPSILON*Math.max(1,Math.abs(ie),Math.abs(It))&&Math.abs(fe-Wt)<=s.EPSILON*Math.max(1,Math.abs(fe),Math.abs(Wt))&&Math.abs(ye-Rt)<=s.EPSILON*Math.max(1,Math.abs(ye),Math.abs(Rt))&&Math.abs(Se-mr)<=s.EPSILON*Math.max(1,Math.abs(Se),Math.abs(mr))&&Math.abs(Le-dr)<=s.EPSILON*Math.max(1,Math.abs(Le),Math.abs(dr))&&Math.abs(Ie-tr)<=s.EPSILON*Math.max(1,Math.abs(Ie),Math.abs(tr))&&Math.abs(Me-Ht)<=s.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Ht))&&Math.abs(et-kr)<=s.EPSILON*Math.max(1,Math.abs(et),Math.abs(kr))},ce.sub=ce.mul=ce.ortho=ce.perspective=void 0;var s=function(j,R){if(j&&j.__esModule)return j;if(j===null||h(j)!=="object"&&typeof j!="function")return{default:j};var F=u(void 0);if(F&&F.has(j))return F.get(j);var M={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in j)if(q!=="default"&&Object.prototype.hasOwnProperty.call(j,q)){var X=I?Object.getOwnPropertyDescriptor(j,q):null;X&&(X.get||X.set)?Object.defineProperty(M,q,X):M[q]=j[q]}return M.default=j,F&&F.set(j,M),M}(E());function u(j){if(typeof WeakMap!="function")return null;var R=new WeakMap,F=new WeakMap;return(u=function(M){return M?F:R})(j)}function p(j){return j[0]=1,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=1,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=1,j[11]=0,j[12]=0,j[13]=0,j[14]=0,j[15]=1,j}function v(j,R,F){var M=R[0],I=R[1],q=R[2],X=R[3],te=R[4],le=R[5],ue=R[6],ie=R[7],fe=R[8],ye=R[9],Se=R[10],Le=R[11],Ie=R[12],Me=R[13],et=R[14],Be=R[15],rt=F[0],st=F[1],nt=F[2],ct=F[3];return j[0]=rt*M+st*te+nt*fe+ct*Ie,j[1]=rt*I+st*le+nt*ye+ct*Me,j[2]=rt*q+st*ue+nt*Se+ct*et,j[3]=rt*X+st*ie+nt*Le+ct*Be,j[4]=(rt=F[4])*M+(st=F[5])*te+(nt=F[6])*fe+(ct=F[7])*Ie,j[5]=rt*I+st*le+nt*ye+ct*Me,j[6]=rt*q+st*ue+nt*Se+ct*et,j[7]=rt*X+st*ie+nt*Le+ct*Be,j[8]=(rt=F[8])*M+(st=F[9])*te+(nt=F[10])*fe+(ct=F[11])*Ie,j[9]=rt*I+st*le+nt*ye+ct*Me,j[10]=rt*q+st*ue+nt*Se+ct*et,j[11]=rt*X+st*ie+nt*Le+ct*Be,j[12]=(rt=F[12])*M+(st=F[13])*te+(nt=F[14])*fe+(ct=F[15])*Ie,j[13]=rt*I+st*le+nt*ye+ct*Me,j[14]=rt*q+st*ue+nt*Se+ct*et,j[15]=rt*X+st*ie+nt*Le+ct*Be,j}function m(j,R,F){var M=R[0],I=R[1],q=R[2],X=R[3],te=M+M,le=I+I,ue=q+q,ie=M*te,fe=M*le,ye=M*ue,Se=I*le,Le=I*ue,Ie=q*ue,Me=X*te,et=X*le,Be=X*ue;return j[0]=1-(Se+Ie),j[1]=fe+Be,j[2]=ye-et,j[3]=0,j[4]=fe-Be,j[5]=1-(ie+Ie),j[6]=Le+Me,j[7]=0,j[8]=ye+et,j[9]=Le-Me,j[10]=1-(ie+Se),j[11]=0,j[12]=F[0],j[13]=F[1],j[14]=F[2],j[15]=1,j}function _(j,R){var F=R[4],M=R[5],I=R[6],q=R[8],X=R[9],te=R[10];return j[0]=Math.hypot(R[0],R[1],R[2]),j[1]=Math.hypot(F,M,I),j[2]=Math.hypot(q,X,te),j}function C(j,R,F,M,I){var q,X=1/Math.tan(R/2);return j[0]=X/F,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=X,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[11]=-1,j[12]=0,j[13]=0,j[15]=0,I!=null&&I!==1/0?(j[10]=(I+M)*(q=1/(M-I)),j[14]=2*I*M*q):(j[10]=-1,j[14]=-2*M),j}function O(j,R,F,M,I,q,X){var te=1/(R-F),le=1/(M-I),ue=1/(q-X);return j[0]=-2*te,j[1]=0,j[2]=0,j[3]=0,j[4]=0,j[5]=-2*le,j[6]=0,j[7]=0,j[8]=0,j[9]=0,j[10]=2*ue,j[11]=0,j[12]=(R+F)*te,j[13]=(I+M)*le,j[14]=(X+q)*ue,j[15]=1,j}function B(j,R,F){return j[0]=R[0]-F[0],j[1]=R[1]-F[1],j[2]=R[2]-F[2],j[3]=R[3]-F[3],j[4]=R[4]-F[4],j[5]=R[5]-F[5],j[6]=R[6]-F[6],j[7]=R[7]-F[7],j[8]=R[8]-F[8],j[9]=R[9]-F[9],j[10]=R[10]-F[10],j[11]=R[11]-F[11],j[12]=R[12]-F[12],j[13]=R[13]-F[13],j[14]=R[14]-F[14],j[15]=R[15]-F[15],j}return ce.perspective=C,ce.ortho=O,ce.mul=v,ce.sub=B,ce}var Pe,Ne={},pe={};function je(){if(Pe)return pe;function h(I){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},h(I)}Pe=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.create=p,pe.clone=function(I){var q=new s.ARRAY_TYPE(3);return q[0]=I[0],q[1]=I[1],q[2]=I[2],q},pe.length=v,pe.fromValues=function(I,q,X){var te=new s.ARRAY_TYPE(3);return te[0]=I,te[1]=q,te[2]=X,te},pe.copy=function(I,q){return I[0]=q[0],I[1]=q[1],I[2]=q[2],I},pe.set=function(I,q,X,te){return I[0]=q,I[1]=X,I[2]=te,I},pe.add=function(I,q,X){return I[0]=q[0]+X[0],I[1]=q[1]+X[1],I[2]=q[2]+X[2],I},pe.subtract=m,pe.multiply=_,pe.divide=C,pe.ceil=function(I,q){return I[0]=Math.ceil(q[0]),I[1]=Math.ceil(q[1]),I[2]=Math.ceil(q[2]),I},pe.floor=function(I,q){return I[0]=Math.floor(q[0]),I[1]=Math.floor(q[1]),I[2]=Math.floor(q[2]),I},pe.min=function(I,q,X){return I[0]=Math.min(q[0],X[0]),I[1]=Math.min(q[1],X[1]),I[2]=Math.min(q[2],X[2]),I},pe.max=function(I,q,X){return I[0]=Math.max(q[0],X[0]),I[1]=Math.max(q[1],X[1]),I[2]=Math.max(q[2],X[2]),I},pe.round=function(I,q){return I[0]=Math.round(q[0]),I[1]=Math.round(q[1]),I[2]=Math.round(q[2]),I},pe.scale=function(I,q,X){return I[0]=q[0]*X,I[1]=q[1]*X,I[2]=q[2]*X,I},pe.scaleAndAdd=function(I,q,X,te){return I[0]=q[0]+X[0]*te,I[1]=q[1]+X[1]*te,I[2]=q[2]+X[2]*te,I},pe.distance=O,pe.squaredDistance=B,pe.squaredLength=j,pe.negate=function(I,q){return I[0]=-q[0],I[1]=-q[1],I[2]=-q[2],I},pe.inverse=function(I,q){return I[0]=1/q[0],I[1]=1/q[1],I[2]=1/q[2],I},pe.normalize=function(I,q){var X=q[0],te=q[1],le=q[2],ue=X*X+te*te+le*le;return ue>0&&(ue=1/Math.sqrt(ue)),I[0]=q[0]*ue,I[1]=q[1]*ue,I[2]=q[2]*ue,I},pe.dot=R,pe.cross=function(I,q,X){var te=q[0],le=q[1],ue=q[2],ie=X[0],fe=X[1],ye=X[2];return I[0]=le*ye-ue*fe,I[1]=ue*ie-te*ye,I[2]=te*fe-le*ie,I},pe.lerp=function(I,q,X,te){var le=q[0],ue=q[1],ie=q[2];return I[0]=le+te*(X[0]-le),I[1]=ue+te*(X[1]-ue),I[2]=ie+te*(X[2]-ie),I},pe.hermite=function(I,q,X,te,le,ue){var ie=ue*ue,fe=ie*(2*ue-3)+1,ye=ie*(ue-2)+ue,Se=ie*(ue-1),Le=ie*(3-2*ue);return I[0]=q[0]*fe+X[0]*ye+te[0]*Se+le[0]*Le,I[1]=q[1]*fe+X[1]*ye+te[1]*Se+le[1]*Le,I[2]=q[2]*fe+X[2]*ye+te[2]*Se+le[2]*Le,I},pe.bezier=function(I,q,X,te,le,ue){var ie=1-ue,fe=ie*ie,ye=ue*ue,Se=fe*ie,Le=3*ue*fe,Ie=3*ye*ie,Me=ye*ue;return I[0]=q[0]*Se+X[0]*Le+te[0]*Ie+le[0]*Me,I[1]=q[1]*Se+X[1]*Le+te[1]*Ie+le[1]*Me,I[2]=q[2]*Se+X[2]*Le+te[2]*Ie+le[2]*Me,I},pe.random=function(I,q){q=q||1;var X=2*s.RANDOM()*Math.PI,te=2*s.RANDOM()-1,le=Math.sqrt(1-te*te)*q;return I[0]=Math.cos(X)*le,I[1]=Math.sin(X)*le,I[2]=te*q,I},pe.transformMat4=function(I,q,X){var te=q[0],le=q[1],ue=q[2],ie=X[3]*te+X[7]*le+X[11]*ue+X[15];return I[0]=(X[0]*te+X[4]*le+X[8]*ue+X[12])/(ie=ie||1),I[1]=(X[1]*te+X[5]*le+X[9]*ue+X[13])/ie,I[2]=(X[2]*te+X[6]*le+X[10]*ue+X[14])/ie,I},pe.transformMat3=function(I,q,X){var te=q[0],le=q[1],ue=q[2];return I[0]=te*X[0]+le*X[3]+ue*X[6],I[1]=te*X[1]+le*X[4]+ue*X[7],I[2]=te*X[2]+le*X[5]+ue*X[8],I},pe.transformQuat=function(I,q,X){var te=X[0],le=X[1],ue=X[2],ie=q[0],fe=q[1],ye=q[2],Se=le*ye-ue*fe,Le=ue*ie-te*ye,Ie=te*fe-le*ie,Me=le*Ie-ue*Le,et=ue*Se-te*Ie,Be=te*Le-le*Se,rt=2*X[3];return Le*=rt,Ie*=rt,et*=2,Be*=2,I[0]=ie+(Se*=rt)+(Me*=2),I[1]=fe+Le+et,I[2]=ye+Ie+Be,I},pe.rotateX=function(I,q,X,te){var le=[],ue=[];return le[0]=q[0]-X[0],le[1]=q[1]-X[1],le[2]=q[2]-X[2],ue[0]=le[0],ue[1]=le[1]*Math.cos(te)-le[2]*Math.sin(te),ue[2]=le[1]*Math.sin(te)+le[2]*Math.cos(te),I[0]=ue[0]+X[0],I[1]=ue[1]+X[1],I[2]=ue[2]+X[2],I},pe.rotateY=function(I,q,X,te){var le=[],ue=[];return le[0]=q[0]-X[0],le[1]=q[1]-X[1],le[2]=q[2]-X[2],ue[0]=le[2]*Math.sin(te)+le[0]*Math.cos(te),ue[1]=le[1],ue[2]=le[2]*Math.cos(te)-le[0]*Math.sin(te),I[0]=ue[0]+X[0],I[1]=ue[1]+X[1],I[2]=ue[2]+X[2],I},pe.rotateZ=function(I,q,X,te){var le=[],ue=[];return le[0]=q[0]-X[0],le[1]=q[1]-X[1],le[2]=q[2]-X[2],ue[0]=le[0]*Math.cos(te)-le[1]*Math.sin(te),ue[1]=le[0]*Math.sin(te)+le[1]*Math.cos(te),ue[2]=le[2],I[0]=ue[0]+X[0],I[1]=ue[1]+X[1],I[2]=ue[2]+X[2],I},pe.angle=function(I,q){var X=I[0],te=I[1],le=I[2],ue=q[0],ie=q[1],fe=q[2],ye=Math.sqrt(X*X+te*te+le*le)*Math.sqrt(ue*ue+ie*ie+fe*fe),Se=ye&&R(I,q)/ye;return Math.acos(Math.min(Math.max(Se,-1),1))},pe.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I},pe.str=function(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"},pe.exactEquals=function(I,q){return I[0]===q[0]&&I[1]===q[1]&&I[2]===q[2]},pe.equals=function(I,q){var X=I[0],te=I[1],le=I[2],ue=q[0],ie=q[1],fe=q[2];return Math.abs(X-ue)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ue))&&Math.abs(te-ie)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(ie))&&Math.abs(le-fe)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(fe))},pe.forEach=pe.sqrLen=pe.len=pe.sqrDist=pe.dist=pe.div=pe.mul=pe.sub=void 0;var s=function(I,q){if(I&&I.__esModule)return I;if(I===null||h(I)!=="object"&&typeof I!="function")return{default:I};var X=u(void 0);if(X&&X.has(I))return X.get(I);var te={},le=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ue in I)if(ue!=="default"&&Object.prototype.hasOwnProperty.call(I,ue)){var ie=le?Object.getOwnPropertyDescriptor(I,ue):null;ie&&(ie.get||ie.set)?Object.defineProperty(te,ue,ie):te[ue]=I[ue]}return te.default=I,X&&X.set(I,te),te}(E());function u(I){if(typeof WeakMap!="function")return null;var q=new WeakMap,X=new WeakMap;return(u=function(te){return te?X:q})(I)}function p(){var I=new s.ARRAY_TYPE(3);return s.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function v(I){return Math.hypot(I[0],I[1],I[2])}function m(I,q,X){return I[0]=q[0]-X[0],I[1]=q[1]-X[1],I[2]=q[2]-X[2],I}function _(I,q,X){return I[0]=q[0]*X[0],I[1]=q[1]*X[1],I[2]=q[2]*X[2],I}function C(I,q,X){return I[0]=q[0]/X[0],I[1]=q[1]/X[1],I[2]=q[2]/X[2],I}function O(I,q){return Math.hypot(q[0]-I[0],q[1]-I[1],q[2]-I[2])}function B(I,q){var X=q[0]-I[0],te=q[1]-I[1],le=q[2]-I[2];return X*X+te*te+le*le}function j(I){var q=I[0],X=I[1],te=I[2];return q*q+X*X+te*te}function R(I,q){return I[0]*q[0]+I[1]*q[1]+I[2]*q[2]}pe.sub=m,pe.mul=_,pe.div=C,pe.dist=O,pe.sqrDist=B,pe.len=v,pe.sqrLen=j;var F,M=(F=p(),function(I,q,X,te,le,ue){var ie,fe;for(q||(q=3),X||(X=0),fe=te?Math.min(te*q+X,I.length):I.length,ie=X;ie<fe;ie+=q)F[0]=I[ie],F[1]=I[ie+1],F[2]=I[ie+2],le(F,F,ue),I[ie]=F[0],I[ie+1]=F[1],I[ie+2]=F[2];return I});return pe.forEach=M,pe}var xe,Ce,ze={};function Te(){if(xe)return ze;function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},h(M)}xe=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.create=p,ze.clone=function(M){var I=new s.ARRAY_TYPE(4);return I[0]=M[0],I[1]=M[1],I[2]=M[2],I[3]=M[3],I},ze.fromValues=function(M,I,q,X){var te=new s.ARRAY_TYPE(4);return te[0]=M,te[1]=I,te[2]=q,te[3]=X,te},ze.copy=function(M,I){return M[0]=I[0],M[1]=I[1],M[2]=I[2],M[3]=I[3],M},ze.set=function(M,I,q,X,te){return M[0]=I,M[1]=q,M[2]=X,M[3]=te,M},ze.add=function(M,I,q){return M[0]=I[0]+q[0],M[1]=I[1]+q[1],M[2]=I[2]+q[2],M[3]=I[3]+q[3],M},ze.subtract=v,ze.multiply=m,ze.divide=_,ze.ceil=function(M,I){return M[0]=Math.ceil(I[0]),M[1]=Math.ceil(I[1]),M[2]=Math.ceil(I[2]),M[3]=Math.ceil(I[3]),M},ze.floor=function(M,I){return M[0]=Math.floor(I[0]),M[1]=Math.floor(I[1]),M[2]=Math.floor(I[2]),M[3]=Math.floor(I[3]),M},ze.min=function(M,I,q){return M[0]=Math.min(I[0],q[0]),M[1]=Math.min(I[1],q[1]),M[2]=Math.min(I[2],q[2]),M[3]=Math.min(I[3],q[3]),M},ze.max=function(M,I,q){return M[0]=Math.max(I[0],q[0]),M[1]=Math.max(I[1],q[1]),M[2]=Math.max(I[2],q[2]),M[3]=Math.max(I[3],q[3]),M},ze.round=function(M,I){return M[0]=Math.round(I[0]),M[1]=Math.round(I[1]),M[2]=Math.round(I[2]),M[3]=Math.round(I[3]),M},ze.scale=function(M,I,q){return M[0]=I[0]*q,M[1]=I[1]*q,M[2]=I[2]*q,M[3]=I[3]*q,M},ze.scaleAndAdd=function(M,I,q,X){return M[0]=I[0]+q[0]*X,M[1]=I[1]+q[1]*X,M[2]=I[2]+q[2]*X,M[3]=I[3]+q[3]*X,M},ze.distance=C,ze.squaredDistance=O,ze.length=B,ze.squaredLength=j,ze.negate=function(M,I){return M[0]=-I[0],M[1]=-I[1],M[2]=-I[2],M[3]=-I[3],M},ze.inverse=function(M,I){return M[0]=1/I[0],M[1]=1/I[1],M[2]=1/I[2],M[3]=1/I[3],M},ze.normalize=function(M,I){var q=I[0],X=I[1],te=I[2],le=I[3],ue=q*q+X*X+te*te+le*le;return ue>0&&(ue=1/Math.sqrt(ue)),M[0]=q*ue,M[1]=X*ue,M[2]=te*ue,M[3]=le*ue,M},ze.dot=function(M,I){return M[0]*I[0]+M[1]*I[1]+M[2]*I[2]+M[3]*I[3]},ze.cross=function(M,I,q,X){var te=q[0]*X[1]-q[1]*X[0],le=q[0]*X[2]-q[2]*X[0],ue=q[0]*X[3]-q[3]*X[0],ie=q[1]*X[2]-q[2]*X[1],fe=q[1]*X[3]-q[3]*X[1],ye=q[2]*X[3]-q[3]*X[2],Se=I[0],Le=I[1],Ie=I[2],Me=I[3];return M[0]=Le*ye-Ie*fe+Me*ie,M[1]=-Se*ye+Ie*ue-Me*le,M[2]=Se*fe-Le*ue+Me*te,M[3]=-Se*ie+Le*le-Ie*te,M},ze.lerp=function(M,I,q,X){var te=I[0],le=I[1],ue=I[2],ie=I[3];return M[0]=te+X*(q[0]-te),M[1]=le+X*(q[1]-le),M[2]=ue+X*(q[2]-ue),M[3]=ie+X*(q[3]-ie),M},ze.random=function(M,I){var q,X,te,le,ue,ie;I=I||1;do ue=(q=2*s.RANDOM()-1)*q+(X=2*s.RANDOM()-1)*X;while(ue>=1);do ie=(te=2*s.RANDOM()-1)*te+(le=2*s.RANDOM()-1)*le;while(ie>=1);var fe=Math.sqrt((1-ue)/ie);return M[0]=I*q,M[1]=I*X,M[2]=I*te*fe,M[3]=I*le*fe,M},ze.transformMat4=function(M,I,q){var X=I[0],te=I[1],le=I[2],ue=I[3];return M[0]=q[0]*X+q[4]*te+q[8]*le+q[12]*ue,M[1]=q[1]*X+q[5]*te+q[9]*le+q[13]*ue,M[2]=q[2]*X+q[6]*te+q[10]*le+q[14]*ue,M[3]=q[3]*X+q[7]*te+q[11]*le+q[15]*ue,M},ze.transformQuat=function(M,I,q){var X=I[0],te=I[1],le=I[2],ue=q[0],ie=q[1],fe=q[2],ye=q[3],Se=ye*X+ie*le-fe*te,Le=ye*te+fe*X-ue*le,Ie=ye*le+ue*te-ie*X,Me=-ue*X-ie*te-fe*le;return M[0]=Se*ye+Me*-ue+Le*-fe-Ie*-ie,M[1]=Le*ye+Me*-ie+Ie*-ue-Se*-fe,M[2]=Ie*ye+Me*-fe+Se*-ie-Le*-ue,M[3]=I[3],M},ze.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M[3]=0,M},ze.str=function(M){return"vec4("+M[0]+", "+M[1]+", "+M[2]+", "+M[3]+")"},ze.exactEquals=function(M,I){return M[0]===I[0]&&M[1]===I[1]&&M[2]===I[2]&&M[3]===I[3]},ze.equals=function(M,I){var q=M[0],X=M[1],te=M[2],le=M[3],ue=I[0],ie=I[1],fe=I[2],ye=I[3];return Math.abs(q-ue)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(ue))&&Math.abs(X-ie)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(ie))&&Math.abs(te-fe)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(fe))&&Math.abs(le-ye)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(ye))},ze.forEach=ze.sqrLen=ze.len=ze.sqrDist=ze.dist=ze.div=ze.mul=ze.sub=void 0;var s=function(M,I){if(M&&M.__esModule)return M;if(M===null||h(M)!=="object"&&typeof M!="function")return{default:M};var q=u(void 0);if(q&&q.has(M))return q.get(M);var X={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in M)if(le!=="default"&&Object.prototype.hasOwnProperty.call(M,le)){var ue=te?Object.getOwnPropertyDescriptor(M,le):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,le,ue):X[le]=M[le]}return X.default=M,q&&q.set(M,X),X}(E());function u(M){if(typeof WeakMap!="function")return null;var I=new WeakMap,q=new WeakMap;return(u=function(X){return X?q:I})(M)}function p(){var M=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M}function v(M,I,q){return M[0]=I[0]-q[0],M[1]=I[1]-q[1],M[2]=I[2]-q[2],M[3]=I[3]-q[3],M}function m(M,I,q){return M[0]=I[0]*q[0],M[1]=I[1]*q[1],M[2]=I[2]*q[2],M[3]=I[3]*q[3],M}function _(M,I,q){return M[0]=I[0]/q[0],M[1]=I[1]/q[1],M[2]=I[2]/q[2],M[3]=I[3]/q[3],M}function C(M,I){return Math.hypot(I[0]-M[0],I[1]-M[1],I[2]-M[2],I[3]-M[3])}function O(M,I){var q=I[0]-M[0],X=I[1]-M[1],te=I[2]-M[2],le=I[3]-M[3];return q*q+X*X+te*te+le*le}function B(M){return Math.hypot(M[0],M[1],M[2],M[3])}function j(M){var I=M[0],q=M[1],X=M[2],te=M[3];return I*I+q*q+X*X+te*te}ze.sub=v,ze.mul=m,ze.div=_,ze.dist=C,ze.sqrDist=O,ze.len=B,ze.sqrLen=j;var R,F=(R=p(),function(M,I,q,X,te,le){var ue,ie;for(I||(I=4),q||(q=0),ie=X?Math.min(X*I+q,M.length):M.length,ue=q;ue<ie;ue+=I)R[0]=M[ue],R[1]=M[ue+1],R[2]=M[ue+2],R[3]=M[ue+3],te(R,R,le),M[ue]=R[0],M[ue+1]=R[1],M[ue+2]=R[2],M[ue+3]=R[3];return M});return ze.forEach=F,ze}function Re(){if(Ce)return Ne;function h(Be){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(rt){return typeof rt}:function(rt){return rt&&typeof Symbol=="function"&&rt.constructor===Symbol&&rt!==Symbol.prototype?"symbol":typeof rt},h(Be)}Ce=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.create=C,Ne.identity=function(Be){return Be[0]=0,Be[1]=0,Be[2]=0,Be[3]=1,Be},Ne.setAxisAngle=O,Ne.getAxisAngle=function(Be,rt){var st=2*Math.acos(rt[3]),nt=Math.sin(st/2);return nt>s.EPSILON?(Be[0]=rt[0]/nt,Be[1]=rt[1]/nt,Be[2]=rt[2]/nt):(Be[0]=1,Be[1]=0,Be[2]=0),st},Ne.getAngle=function(Be,rt){var st=q(Be,rt);return Math.acos(2*st*st-1)},Ne.multiply=B,Ne.rotateX=function(Be,rt,st){st*=.5;var nt=rt[0],ct=rt[1],ht=rt[2],vt=rt[3],ut=Math.sin(st),It=Math.cos(st);return Be[0]=nt*It+vt*ut,Be[1]=ct*It+ht*ut,Be[2]=ht*It-ct*ut,Be[3]=vt*It-nt*ut,Be},Ne.rotateY=function(Be,rt,st){st*=.5;var nt=rt[0],ct=rt[1],ht=rt[2],vt=rt[3],ut=Math.sin(st),It=Math.cos(st);return Be[0]=nt*It-ht*ut,Be[1]=ct*It+vt*ut,Be[2]=ht*It+nt*ut,Be[3]=vt*It-ct*ut,Be},Ne.rotateZ=function(Be,rt,st){st*=.5;var nt=rt[0],ct=rt[1],ht=rt[2],vt=rt[3],ut=Math.sin(st),It=Math.cos(st);return Be[0]=nt*It+ct*ut,Be[1]=ct*It-nt*ut,Be[2]=ht*It+vt*ut,Be[3]=vt*It-ht*ut,Be},Ne.calculateW=function(Be,rt){var st=rt[0],nt=rt[1],ct=rt[2];return Be[0]=st,Be[1]=nt,Be[2]=ct,Be[3]=Math.sqrt(Math.abs(1-st*st-nt*nt-ct*ct)),Be},Ne.exp=j,Ne.ln=R,Ne.pow=function(Be,rt,st){return R(Be,rt),I(Be,Be,st),j(Be,Be),Be},Ne.slerp=F,Ne.random=function(Be){var rt=s.RANDOM(),st=s.RANDOM(),nt=s.RANDOM(),ct=Math.sqrt(1-rt),ht=Math.sqrt(rt);return Be[0]=ct*Math.sin(2*Math.PI*st),Be[1]=ct*Math.cos(2*Math.PI*st),Be[2]=ht*Math.sin(2*Math.PI*nt),Be[3]=ht*Math.cos(2*Math.PI*nt),Be},Ne.invert=function(Be,rt){var st=rt[0],nt=rt[1],ct=rt[2],ht=rt[3],vt=st*st+nt*nt+ct*ct+ht*ht,ut=vt?1/vt:0;return Be[0]=-st*ut,Be[1]=-nt*ut,Be[2]=-ct*ut,Be[3]=ht*ut,Be},Ne.conjugate=function(Be,rt){return Be[0]=-rt[0],Be[1]=-rt[1],Be[2]=-rt[2],Be[3]=rt[3],Be},Ne.fromMat3=M,Ne.fromEuler=function(Be,rt,st,nt){var ct=.5*Math.PI/180;rt*=ct,st*=ct,nt*=ct;var ht=Math.sin(rt),vt=Math.cos(rt),ut=Math.sin(st),It=Math.cos(st),Wt=Math.sin(nt),Rt=Math.cos(nt);return Be[0]=ht*It*Rt-vt*ut*Wt,Be[1]=vt*ut*Rt+ht*It*Wt,Be[2]=vt*It*Wt-ht*ut*Rt,Be[3]=vt*It*Rt+ht*ut*Wt,Be},Ne.str=function(Be){return"quat("+Be[0]+", "+Be[1]+", "+Be[2]+", "+Be[3]+")"},Ne.setAxes=Ne.sqlerp=Ne.rotationTo=Ne.equals=Ne.exactEquals=Ne.normalize=Ne.sqrLen=Ne.squaredLength=Ne.len=Ne.length=Ne.lerp=Ne.dot=Ne.scale=Ne.mul=Ne.add=Ne.set=Ne.copy=Ne.fromValues=Ne.clone=void 0;var s=_(E()),u=_(ee()),p=_(je()),v=_(Te());function m(Be){if(typeof WeakMap!="function")return null;var rt=new WeakMap,st=new WeakMap;return(m=function(nt){return nt?st:rt})(Be)}function _(Be,rt){if(Be&&Be.__esModule)return Be;if(Be===null||h(Be)!=="object"&&typeof Be!="function")return{default:Be};var st=m(rt);if(st&&st.has(Be))return st.get(Be);var nt={},ct=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ht in Be)if(ht!=="default"&&Object.prototype.hasOwnProperty.call(Be,ht)){var vt=ct?Object.getOwnPropertyDescriptor(Be,ht):null;vt&&(vt.get||vt.set)?Object.defineProperty(nt,ht,vt):nt[ht]=Be[ht]}return nt.default=Be,st&&st.set(Be,nt),nt}function C(){var Be=new s.ARRAY_TYPE(4);return s.ARRAY_TYPE!=Float32Array&&(Be[0]=0,Be[1]=0,Be[2]=0),Be[3]=1,Be}function O(Be,rt,st){st*=.5;var nt=Math.sin(st);return Be[0]=nt*rt[0],Be[1]=nt*rt[1],Be[2]=nt*rt[2],Be[3]=Math.cos(st),Be}function B(Be,rt,st){var nt=rt[0],ct=rt[1],ht=rt[2],vt=rt[3],ut=st[0],It=st[1],Wt=st[2],Rt=st[3];return Be[0]=nt*Rt+vt*ut+ct*Wt-ht*It,Be[1]=ct*Rt+vt*It+ht*ut-nt*Wt,Be[2]=ht*Rt+vt*Wt+nt*It-ct*ut,Be[3]=vt*Rt-nt*ut-ct*It-ht*Wt,Be}function j(Be,rt){var st=rt[0],nt=rt[1],ct=rt[2],ht=rt[3],vt=Math.sqrt(st*st+nt*nt+ct*ct),ut=Math.exp(ht),It=vt>0?ut*Math.sin(vt)/vt:0;return Be[0]=st*It,Be[1]=nt*It,Be[2]=ct*It,Be[3]=ut*Math.cos(vt),Be}function R(Be,rt){var st=rt[0],nt=rt[1],ct=rt[2],ht=rt[3],vt=Math.sqrt(st*st+nt*nt+ct*ct),ut=vt>0?Math.atan2(vt,ht)/vt:0;return Be[0]=st*ut,Be[1]=nt*ut,Be[2]=ct*ut,Be[3]=.5*Math.log(st*st+nt*nt+ct*ct+ht*ht),Be}function F(Be,rt,st,nt){var ct,ht,vt,ut,It,Wt=rt[0],Rt=rt[1],mr=rt[2],dr=rt[3],tr=st[0],Ht=st[1],kr=st[2],vr=st[3];return(ht=Wt*tr+Rt*Ht+mr*kr+dr*vr)<0&&(ht=-ht,tr=-tr,Ht=-Ht,kr=-kr,vr=-vr),1-ht>s.EPSILON?(ct=Math.acos(ht),vt=Math.sin(ct),ut=Math.sin((1-nt)*ct)/vt,It=Math.sin(nt*ct)/vt):(ut=1-nt,It=nt),Be[0]=ut*Wt+It*tr,Be[1]=ut*Rt+It*Ht,Be[2]=ut*mr+It*kr,Be[3]=ut*dr+It*vr,Be}function M(Be,rt){var st,nt=rt[0]+rt[4]+rt[8];if(nt>0)st=Math.sqrt(nt+1),Be[3]=.5*st,Be[0]=(rt[5]-rt[7])*(st=.5/st),Be[1]=(rt[6]-rt[2])*st,Be[2]=(rt[1]-rt[3])*st;else{var ct=0;rt[4]>rt[0]&&(ct=1),rt[8]>rt[3*ct+ct]&&(ct=2);var ht=(ct+1)%3,vt=(ct+2)%3;st=Math.sqrt(rt[3*ct+ct]-rt[3*ht+ht]-rt[3*vt+vt]+1),Be[ct]=.5*st,Be[3]=(rt[3*ht+vt]-rt[3*vt+ht])*(st=.5/st),Be[ht]=(rt[3*ht+ct]+rt[3*ct+ht])*st,Be[vt]=(rt[3*vt+ct]+rt[3*ct+vt])*st}return Be}Ne.clone=v.clone,Ne.fromValues=v.fromValues,Ne.copy=v.copy,Ne.set=v.set,Ne.add=v.add,Ne.mul=B;var I=v.scale;Ne.scale=I;var q=v.dot;Ne.dot=q,Ne.lerp=v.lerp;var X=v.length;Ne.length=X,Ne.len=X;var te=v.squaredLength;Ne.squaredLength=te,Ne.sqrLen=te;var le=v.normalize;Ne.normalize=le,Ne.exactEquals=v.exactEquals,Ne.equals=v.equals;var ue,ie,fe,ye=(ue=p.create(),ie=p.fromValues(1,0,0),fe=p.fromValues(0,1,0),function(Be,rt,st){var nt=p.dot(rt,st);return nt<-.999999?(p.cross(ue,ie,rt),p.len(ue)<1e-6&&p.cross(ue,fe,rt),p.normalize(ue,ue),O(Be,ue,Math.PI),Be):nt>.999999?(Be[0]=0,Be[1]=0,Be[2]=0,Be[3]=1,Be):(p.cross(ue,rt,st),Be[0]=ue[0],Be[1]=ue[1],Be[2]=ue[2],Be[3]=1+nt,le(Be,Be))});Ne.rotationTo=ye;var Se,Le,Ie=(Se=C(),Le=C(),function(Be,rt,st,nt,ct,ht){return F(Se,rt,ct,ht),F(Le,st,nt,ht),F(Be,Se,Le,2*ht*(1-ht)),Be});Ne.sqlerp=Ie;var Me,et=(Me=u.create(),function(Be,rt,st,nt){return Me[0]=st[0],Me[3]=st[1],Me[6]=st[2],Me[1]=nt[0],Me[4]=nt[1],Me[7]=nt[2],Me[2]=-rt[0],Me[5]=-rt[1],Me[8]=-rt[2],le(Be,M(Be,Me))});return Ne.setAxes=et,Ne}var Fe,He={};function mt(){if(Fe)return He;function h(F){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},h(F)}Fe=1,Object.defineProperty(He,"__esModule",{value:!0}),He.create=function(){var F=new s.ARRAY_TYPE(8);return s.ARRAY_TYPE!=Float32Array&&(F[0]=0,F[1]=0,F[2]=0,F[4]=0,F[5]=0,F[6]=0,F[7]=0),F[3]=1,F},He.clone=function(F){var M=new s.ARRAY_TYPE(8);return M[0]=F[0],M[1]=F[1],M[2]=F[2],M[3]=F[3],M[4]=F[4],M[5]=F[5],M[6]=F[6],M[7]=F[7],M},He.fromValues=function(F,M,I,q,X,te,le,ue){var ie=new s.ARRAY_TYPE(8);return ie[0]=F,ie[1]=M,ie[2]=I,ie[3]=q,ie[4]=X,ie[5]=te,ie[6]=le,ie[7]=ue,ie},He.fromRotationTranslationValues=function(F,M,I,q,X,te,le){var ue=new s.ARRAY_TYPE(8);ue[0]=F,ue[1]=M,ue[2]=I,ue[3]=q;var ie=.5*X,fe=.5*te,ye=.5*le;return ue[4]=ie*q+fe*I-ye*M,ue[5]=fe*q+ye*F-ie*I,ue[6]=ye*q+ie*M-fe*F,ue[7]=-ie*F-fe*M-ye*I,ue},He.fromRotationTranslation=_,He.fromTranslation=function(F,M){return F[0]=0,F[1]=0,F[2]=0,F[3]=1,F[4]=.5*M[0],F[5]=.5*M[1],F[6]=.5*M[2],F[7]=0,F},He.fromRotation=function(F,M){return F[0]=M[0],F[1]=M[1],F[2]=M[2],F[3]=M[3],F[4]=0,F[5]=0,F[6]=0,F[7]=0,F},He.fromMat4=function(F,M){var I=u.create();p.getRotation(I,M);var q=new s.ARRAY_TYPE(3);return p.getTranslation(q,M),_(F,I,q),F},He.copy=C,He.identity=function(F){return F[0]=0,F[1]=0,F[2]=0,F[3]=1,F[4]=0,F[5]=0,F[6]=0,F[7]=0,F},He.set=function(F,M,I,q,X,te,le,ue,ie){return F[0]=M,F[1]=I,F[2]=q,F[3]=X,F[4]=te,F[5]=le,F[6]=ue,F[7]=ie,F},He.getDual=function(F,M){return F[0]=M[4],F[1]=M[5],F[2]=M[6],F[3]=M[7],F},He.setDual=function(F,M){return F[4]=M[0],F[5]=M[1],F[6]=M[2],F[7]=M[3],F},He.getTranslation=function(F,M){var I=M[4],q=M[5],X=M[6],te=M[7],le=-M[0],ue=-M[1],ie=-M[2],fe=M[3];return F[0]=2*(I*fe+te*le+q*ie-X*ue),F[1]=2*(q*fe+te*ue+X*le-I*ie),F[2]=2*(X*fe+te*ie+I*ue-q*le),F},He.translate=function(F,M,I){var q=M[0],X=M[1],te=M[2],le=M[3],ue=.5*I[0],ie=.5*I[1],fe=.5*I[2],ye=M[4],Se=M[5],Le=M[6],Ie=M[7];return F[0]=q,F[1]=X,F[2]=te,F[3]=le,F[4]=le*ue+X*fe-te*ie+ye,F[5]=le*ie+te*ue-q*fe+Se,F[6]=le*fe+q*ie-X*ue+Le,F[7]=-q*ue-X*ie-te*fe+Ie,F},He.rotateX=function(F,M,I){var q=-M[0],X=-M[1],te=-M[2],le=M[3],ue=M[4],ie=M[5],fe=M[6],ye=M[7],Se=ue*le+ye*q+ie*te-fe*X,Le=ie*le+ye*X+fe*q-ue*te,Ie=fe*le+ye*te+ue*X-ie*q,Me=ye*le-ue*q-ie*X-fe*te;return u.rotateX(F,M,I),F[4]=Se*(le=F[3])+Me*(q=F[0])+Le*(te=F[2])-Ie*(X=F[1]),F[5]=Le*le+Me*X+Ie*q-Se*te,F[6]=Ie*le+Me*te+Se*X-Le*q,F[7]=Me*le-Se*q-Le*X-Ie*te,F},He.rotateY=function(F,M,I){var q=-M[0],X=-M[1],te=-M[2],le=M[3],ue=M[4],ie=M[5],fe=M[6],ye=M[7],Se=ue*le+ye*q+ie*te-fe*X,Le=ie*le+ye*X+fe*q-ue*te,Ie=fe*le+ye*te+ue*X-ie*q,Me=ye*le-ue*q-ie*X-fe*te;return u.rotateY(F,M,I),F[4]=Se*(le=F[3])+Me*(q=F[0])+Le*(te=F[2])-Ie*(X=F[1]),F[5]=Le*le+Me*X+Ie*q-Se*te,F[6]=Ie*le+Me*te+Se*X-Le*q,F[7]=Me*le-Se*q-Le*X-Ie*te,F},He.rotateZ=function(F,M,I){var q=-M[0],X=-M[1],te=-M[2],le=M[3],ue=M[4],ie=M[5],fe=M[6],ye=M[7],Se=ue*le+ye*q+ie*te-fe*X,Le=ie*le+ye*X+fe*q-ue*te,Ie=fe*le+ye*te+ue*X-ie*q,Me=ye*le-ue*q-ie*X-fe*te;return u.rotateZ(F,M,I),F[4]=Se*(le=F[3])+Me*(q=F[0])+Le*(te=F[2])-Ie*(X=F[1]),F[5]=Le*le+Me*X+Ie*q-Se*te,F[6]=Ie*le+Me*te+Se*X-Le*q,F[7]=Me*le-Se*q-Le*X-Ie*te,F},He.rotateByQuatAppend=function(F,M,I){var q=I[0],X=I[1],te=I[2],le=I[3],ue=M[0],ie=M[1],fe=M[2],ye=M[3];return F[0]=ue*le+ye*q+ie*te-fe*X,F[1]=ie*le+ye*X+fe*q-ue*te,F[2]=fe*le+ye*te+ue*X-ie*q,F[3]=ye*le-ue*q-ie*X-fe*te,F[4]=(ue=M[4])*le+(ye=M[7])*q+(ie=M[5])*te-(fe=M[6])*X,F[5]=ie*le+ye*X+fe*q-ue*te,F[6]=fe*le+ye*te+ue*X-ie*q,F[7]=ye*le-ue*q-ie*X-fe*te,F},He.rotateByQuatPrepend=function(F,M,I){var q=M[0],X=M[1],te=M[2],le=M[3],ue=I[0],ie=I[1],fe=I[2],ye=I[3];return F[0]=q*ye+le*ue+X*fe-te*ie,F[1]=X*ye+le*ie+te*ue-q*fe,F[2]=te*ye+le*fe+q*ie-X*ue,F[3]=le*ye-q*ue-X*ie-te*fe,F[4]=q*(ye=I[7])+le*(ue=I[4])+X*(fe=I[6])-te*(ie=I[5]),F[5]=X*ye+le*ie+te*ue-q*fe,F[6]=te*ye+le*fe+q*ie-X*ue,F[7]=le*ye-q*ue-X*ie-te*fe,F},He.rotateAroundAxis=function(F,M,I,q){if(Math.abs(q)<s.EPSILON)return C(F,M);var X=Math.hypot(I[0],I[1],I[2]);q*=.5;var te=Math.sin(q),le=te*I[0]/X,ue=te*I[1]/X,ie=te*I[2]/X,fe=Math.cos(q),ye=M[0],Se=M[1],Le=M[2],Ie=M[3];F[0]=ye*fe+Ie*le+Se*ie-Le*ue,F[1]=Se*fe+Ie*ue+Le*le-ye*ie,F[2]=Le*fe+Ie*ie+ye*ue-Se*le,F[3]=Ie*fe-ye*le-Se*ue-Le*ie;var Me=M[4],et=M[5],Be=M[6],rt=M[7];return F[4]=Me*fe+rt*le+et*ie-Be*ue,F[5]=et*fe+rt*ue+Be*le-Me*ie,F[6]=Be*fe+rt*ie+Me*ue-et*le,F[7]=rt*fe-Me*le-et*ue-Be*ie,F},He.add=function(F,M,I){return F[0]=M[0]+I[0],F[1]=M[1]+I[1],F[2]=M[2]+I[2],F[3]=M[3]+I[3],F[4]=M[4]+I[4],F[5]=M[5]+I[5],F[6]=M[6]+I[6],F[7]=M[7]+I[7],F},He.multiply=O,He.scale=function(F,M,I){return F[0]=M[0]*I,F[1]=M[1]*I,F[2]=M[2]*I,F[3]=M[3]*I,F[4]=M[4]*I,F[5]=M[5]*I,F[6]=M[6]*I,F[7]=M[7]*I,F},He.lerp=function(F,M,I,q){var X=1-q;return B(M,I)<0&&(q=-q),F[0]=M[0]*X+I[0]*q,F[1]=M[1]*X+I[1]*q,F[2]=M[2]*X+I[2]*q,F[3]=M[3]*X+I[3]*q,F[4]=M[4]*X+I[4]*q,F[5]=M[5]*X+I[5]*q,F[6]=M[6]*X+I[6]*q,F[7]=M[7]*X+I[7]*q,F},He.invert=function(F,M){var I=R(M);return F[0]=-M[0]/I,F[1]=-M[1]/I,F[2]=-M[2]/I,F[3]=M[3]/I,F[4]=-M[4]/I,F[5]=-M[5]/I,F[6]=-M[6]/I,F[7]=M[7]/I,F},He.conjugate=function(F,M){return F[0]=-M[0],F[1]=-M[1],F[2]=-M[2],F[3]=M[3],F[4]=-M[4],F[5]=-M[5],F[6]=-M[6],F[7]=M[7],F},He.normalize=function(F,M){var I=R(M);if(I>0){I=Math.sqrt(I);var q=M[0]/I,X=M[1]/I,te=M[2]/I,le=M[3]/I,ue=M[4],ie=M[5],fe=M[6],ye=M[7],Se=q*ue+X*ie+te*fe+le*ye;F[0]=q,F[1]=X,F[2]=te,F[3]=le,F[4]=(ue-q*Se)/I,F[5]=(ie-X*Se)/I,F[6]=(fe-te*Se)/I,F[7]=(ye-le*Se)/I}return F},He.str=function(F){return"quat2("+F[0]+", "+F[1]+", "+F[2]+", "+F[3]+", "+F[4]+", "+F[5]+", "+F[6]+", "+F[7]+")"},He.exactEquals=function(F,M){return F[0]===M[0]&&F[1]===M[1]&&F[2]===M[2]&&F[3]===M[3]&&F[4]===M[4]&&F[5]===M[5]&&F[6]===M[6]&&F[7]===M[7]},He.equals=function(F,M){var I=F[0],q=F[1],X=F[2],te=F[3],le=F[4],ue=F[5],ie=F[6],fe=F[7],ye=M[0],Se=M[1],Le=M[2],Ie=M[3],Me=M[4],et=M[5],Be=M[6],rt=M[7];return Math.abs(I-ye)<=s.EPSILON*Math.max(1,Math.abs(I),Math.abs(ye))&&Math.abs(q-Se)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(Se))&&Math.abs(X-Le)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(Le))&&Math.abs(te-Ie)<=s.EPSILON*Math.max(1,Math.abs(te),Math.abs(Ie))&&Math.abs(le-Me)<=s.EPSILON*Math.max(1,Math.abs(le),Math.abs(Me))&&Math.abs(ue-et)<=s.EPSILON*Math.max(1,Math.abs(ue),Math.abs(et))&&Math.abs(ie-Be)<=s.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Be))&&Math.abs(fe-rt)<=s.EPSILON*Math.max(1,Math.abs(fe),Math.abs(rt))},He.sqrLen=He.squaredLength=He.len=He.length=He.dot=He.mul=He.setReal=He.getReal=void 0;var s=m(E()),u=m(Re()),p=m(he());function v(F){if(typeof WeakMap!="function")return null;var M=new WeakMap,I=new WeakMap;return(v=function(q){return q?I:M})(F)}function m(F,M){if(F&&F.__esModule)return F;if(F===null||h(F)!=="object"&&typeof F!="function")return{default:F};var I=v(M);if(I&&I.has(F))return I.get(F);var q={},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in F)if(te!=="default"&&Object.prototype.hasOwnProperty.call(F,te)){var le=X?Object.getOwnPropertyDescriptor(F,te):null;le&&(le.get||le.set)?Object.defineProperty(q,te,le):q[te]=F[te]}return q.default=F,I&&I.set(F,q),q}function _(F,M,I){var q=.5*I[0],X=.5*I[1],te=.5*I[2],le=M[0],ue=M[1],ie=M[2],fe=M[3];return F[0]=le,F[1]=ue,F[2]=ie,F[3]=fe,F[4]=q*fe+X*ie-te*ue,F[5]=X*fe+te*le-q*ie,F[6]=te*fe+q*ue-X*le,F[7]=-q*le-X*ue-te*ie,F}function C(F,M){return F[0]=M[0],F[1]=M[1],F[2]=M[2],F[3]=M[3],F[4]=M[4],F[5]=M[5],F[6]=M[6],F[7]=M[7],F}function O(F,M,I){var q=M[0],X=M[1],te=M[2],le=M[3],ue=I[4],ie=I[5],fe=I[6],ye=I[7],Se=M[4],Le=M[5],Ie=M[6],Me=M[7],et=I[0],Be=I[1],rt=I[2],st=I[3];return F[0]=q*st+le*et+X*rt-te*Be,F[1]=X*st+le*Be+te*et-q*rt,F[2]=te*st+le*rt+q*Be-X*et,F[3]=le*st-q*et-X*Be-te*rt,F[4]=q*ye+le*ue+X*fe-te*ie+Se*st+Me*et+Le*rt-Ie*Be,F[5]=X*ye+le*ie+te*ue-q*fe+Le*st+Me*Be+Ie*et-Se*rt,F[6]=te*ye+le*fe+q*ie-X*ue+Ie*st+Me*rt+Se*Be-Le*et,F[7]=le*ye-q*ue-X*ie-te*fe+Me*st-Se*et-Le*Be-Ie*rt,F}He.getReal=u.copy,He.setReal=u.copy,He.mul=O;var B=u.dot;He.dot=B;var j=u.length;He.length=j,He.len=j;var R=u.squaredLength;return He.squaredLength=R,He.sqrLen=R,He}var Xe,ot,qe={};function Lt(){if(Xe)return qe;function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},h(M)}Xe=1,Object.defineProperty(qe,"__esModule",{value:!0}),qe.create=p,qe.clone=function(M){var I=new s.ARRAY_TYPE(2);return I[0]=M[0],I[1]=M[1],I},qe.fromValues=function(M,I){var q=new s.ARRAY_TYPE(2);return q[0]=M,q[1]=I,q},qe.copy=function(M,I){return M[0]=I[0],M[1]=I[1],M},qe.set=function(M,I,q){return M[0]=I,M[1]=q,M},qe.add=function(M,I,q){return M[0]=I[0]+q[0],M[1]=I[1]+q[1],M},qe.subtract=v,qe.multiply=m,qe.divide=_,qe.ceil=function(M,I){return M[0]=Math.ceil(I[0]),M[1]=Math.ceil(I[1]),M},qe.floor=function(M,I){return M[0]=Math.floor(I[0]),M[1]=Math.floor(I[1]),M},qe.min=function(M,I,q){return M[0]=Math.min(I[0],q[0]),M[1]=Math.min(I[1],q[1]),M},qe.max=function(M,I,q){return M[0]=Math.max(I[0],q[0]),M[1]=Math.max(I[1],q[1]),M},qe.round=function(M,I){return M[0]=Math.round(I[0]),M[1]=Math.round(I[1]),M},qe.scale=function(M,I,q){return M[0]=I[0]*q,M[1]=I[1]*q,M},qe.scaleAndAdd=function(M,I,q,X){return M[0]=I[0]+q[0]*X,M[1]=I[1]+q[1]*X,M},qe.distance=C,qe.squaredDistance=O,qe.length=B,qe.squaredLength=j,qe.negate=function(M,I){return M[0]=-I[0],M[1]=-I[1],M},qe.inverse=function(M,I){return M[0]=1/I[0],M[1]=1/I[1],M},qe.normalize=function(M,I){var q=I[0],X=I[1],te=q*q+X*X;return te>0&&(te=1/Math.sqrt(te)),M[0]=I[0]*te,M[1]=I[1]*te,M},qe.dot=function(M,I){return M[0]*I[0]+M[1]*I[1]},qe.cross=function(M,I,q){var X=I[0]*q[1]-I[1]*q[0];return M[0]=M[1]=0,M[2]=X,M},qe.lerp=function(M,I,q,X){var te=I[0],le=I[1];return M[0]=te+X*(q[0]-te),M[1]=le+X*(q[1]-le),M},qe.random=function(M,I){I=I||1;var q=2*s.RANDOM()*Math.PI;return M[0]=Math.cos(q)*I,M[1]=Math.sin(q)*I,M},qe.transformMat2=function(M,I,q){var X=I[0],te=I[1];return M[0]=q[0]*X+q[2]*te,M[1]=q[1]*X+q[3]*te,M},qe.transformMat2d=function(M,I,q){var X=I[0],te=I[1];return M[0]=q[0]*X+q[2]*te+q[4],M[1]=q[1]*X+q[3]*te+q[5],M},qe.transformMat3=function(M,I,q){var X=I[0],te=I[1];return M[0]=q[0]*X+q[3]*te+q[6],M[1]=q[1]*X+q[4]*te+q[7],M},qe.transformMat4=function(M,I,q){var X=I[0],te=I[1];return M[0]=q[0]*X+q[4]*te+q[12],M[1]=q[1]*X+q[5]*te+q[13],M},qe.rotate=function(M,I,q,X){var te=I[0]-q[0],le=I[1]-q[1],ue=Math.sin(X),ie=Math.cos(X);return M[0]=te*ie-le*ue+q[0],M[1]=te*ue+le*ie+q[1],M},qe.angle=function(M,I){var q=M[0],X=M[1],te=I[0],le=I[1],ue=Math.sqrt(q*q+X*X)*Math.sqrt(te*te+le*le);return Math.acos(Math.min(Math.max(ue&&(q*te+X*le)/ue,-1),1))},qe.zero=function(M){return M[0]=0,M[1]=0,M},qe.str=function(M){return"vec2("+M[0]+", "+M[1]+")"},qe.exactEquals=function(M,I){return M[0]===I[0]&&M[1]===I[1]},qe.equals=function(M,I){var q=M[0],X=M[1],te=I[0],le=I[1];return Math.abs(q-te)<=s.EPSILON*Math.max(1,Math.abs(q),Math.abs(te))&&Math.abs(X-le)<=s.EPSILON*Math.max(1,Math.abs(X),Math.abs(le))},qe.forEach=qe.sqrLen=qe.sqrDist=qe.dist=qe.div=qe.mul=qe.sub=qe.len=void 0;var s=function(M,I){if(M&&M.__esModule)return M;if(M===null||h(M)!=="object"&&typeof M!="function")return{default:M};var q=u(void 0);if(q&&q.has(M))return q.get(M);var X={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in M)if(le!=="default"&&Object.prototype.hasOwnProperty.call(M,le)){var ue=te?Object.getOwnPropertyDescriptor(M,le):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,le,ue):X[le]=M[le]}return X.default=M,q&&q.set(M,X),X}(E());function u(M){if(typeof WeakMap!="function")return null;var I=new WeakMap,q=new WeakMap;return(u=function(X){return X?q:I})(M)}function p(){var M=new s.ARRAY_TYPE(2);return s.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0),M}function v(M,I,q){return M[0]=I[0]-q[0],M[1]=I[1]-q[1],M}function m(M,I,q){return M[0]=I[0]*q[0],M[1]=I[1]*q[1],M}function _(M,I,q){return M[0]=I[0]/q[0],M[1]=I[1]/q[1],M}function C(M,I){return Math.hypot(I[0]-M[0],I[1]-M[1])}function O(M,I){var q=I[0]-M[0],X=I[1]-M[1];return q*q+X*X}function B(M){return Math.hypot(M[0],M[1])}function j(M){var I=M[0],q=M[1];return I*I+q*q}qe.len=B,qe.sub=v,qe.mul=m,qe.div=_,qe.dist=C,qe.sqrDist=O,qe.sqrLen=j;var R,F=(R=p(),function(M,I,q,X,te,le){var ue,ie;for(I||(I=2),q||(q=0),ie=X?Math.min(X*I+q,M.length):M.length,ue=q;ue<ie;ue+=I)R[0]=M[ue],R[1]=M[ue+1],te(R,R,le),M[ue]=R[0],M[ue+1]=R[1];return M});return qe.forEach=F,qe}function Zt(){if(ot)return A;function h(M){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},h(M)}ot=1,Object.defineProperty(A,"__esModule",{value:!0}),A.vec4=A.vec3=A.vec2=A.quat2=A.quat=A.mat4=A.mat3=A.mat2d=A.mat2=A.glMatrix=void 0;var s=F(E());A.glMatrix=s;var u=F(L());A.mat2=u;var p=F(K());A.mat2d=p;var v=F(ee());A.mat3=v;var m=F(he());A.mat4=m;var _=F(Re());A.quat=_;var C=F(mt());A.quat2=C;var O=F(Lt());A.vec2=O;var B=F(je());A.vec3=B;var j=F(Te());function R(M){if(typeof WeakMap!="function")return null;var I=new WeakMap,q=new WeakMap;return(R=function(X){return X?q:I})(M)}function F(M,I){if(M&&M.__esModule)return M;if(M===null||h(M)!=="object"&&typeof M!="function")return{default:M};var q=R(I);if(q&&q.has(M))return q.get(M);var X={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var le in M)if(le!=="default"&&Object.prototype.hasOwnProperty.call(M,le)){var ue=te?Object.getOwnPropertyDescriptor(M,le):null;ue&&(ue.get||ue.set)?Object.defineProperty(X,le,ue):X[le]=M[le]}return X.default=M,q&&q.set(M,X),X}return A.vec4=j,A}var Xt,rr,ir,Bt,De=Zt(),jr=function(){if(rr)return Xt;function h(s,u,p,v){this.cx=3*s,this.bx=3*(p-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(v-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=u,this.p2x=p,this.p2y=v}return rr=1,Xt=h,h.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,u){if(u===void 0&&(u=1e-6),s<0)return 0;if(s>1)return 1;for(var p=s,v=0;v<8;v++){var m=this.sampleCurveX(p)-s;if(Math.abs(m)<u)return p;var _=this.sampleCurveDerivativeX(p);if(Math.abs(_)<1e-6)break;p-=m/_}var C=0,O=1;for(p=s,v=0;v<20&&(m=this.sampleCurveX(p),!(Math.abs(m-s)<u));v++)s>m?C=p:O=p,p=.5*(O-C)+C;return p},solve:function(s,u){return this.sampleCurveY(this.solveCurveX(s,u))}},Xt}(),Dt=x(jr);function Cr(){if(Bt)return ir;function h(s,u){this.x=s,this.y=u}return Bt=1,ir=h,h.prototype={clone:function(){return new h(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,u){return this.clone()._rotateAround(s,u)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var u=s.x-this.x,p=s.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,u){return Math.atan2(this.x*u-this.y*s,this.x*s+this.y*u)},_matMult:function(s){var u=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=u,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var u=Math.cos(s),p=Math.sin(s),v=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=v,this},_rotateAround:function(s,u){var p=Math.cos(s),v=Math.sin(s),m=u.y+v*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-v*(this.y-u.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},h.convert=function(s){return s instanceof h?s:Array.isArray(s)?new h(s[0],s[1]):s},ir}var At=x(Cr());function qr(h,s){if(Array.isArray(h)){if(!Array.isArray(s)||h.length!==s.length)return!1;for(let u=0;u<h.length;u++)if(!qr(h[u],s[u]))return!1;return!0}if(typeof h=="object"&&h!==null&&s!==null){if(typeof s!="object"||Object.keys(h).length!==Object.keys(s).length)return!1;for(const u in h)if(!qr(h[u],s[u]))return!1;return!0}return h===s}const an=Math.PI/180,Jn=180/Math.PI;function tt(h){return h*an}function xt(h){return h*Jn}const Mt=[[0,0],[1,0],[1,1],[0,1]];function lr(h){if(h<=0)return 0;if(h>=1)return 1;const s=h*h,u=s*h;return 4*(h<.5?u:3*(h-s)+u-.75)}function cr(h,s,u,p){const v=new Dt(h,s,u,p);return function(m){return v.solve(m)}}const xr=cr(.25,.1,.25,1);function ur(h,s,u){return Math.min(u,Math.max(s,h))}function tn(h,s,u){return(u=ur((u-h)/(s-h),0,1))*u*(3-2*u)}function Gn(h,s,u){const p=u-s,v=((h-s)%p+p)%p+s;return v===s?u:v}function gi(h,s,u){if(!h.length)return u(null,[]);let p=h.length;const v=new Array(h.length);let m=null;h.forEach((_,C)=>{s(_,(O,B)=>{O&&(m=O),v[C]=B,--p==0&&u(m,v)})})}function Ui(h,...s){for(const u of s)for(const p in u)h[p]=u[p];return h}let uo=1;function Va(){return uo++}function Ks(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function To(h,s){h.forEach(u=>{s[u]&&(s[u]=s[u].bind(s))})}function es(h,s){return h.indexOf(s,h.length-s.length)!==-1}function rc(h,s,u){const p={};for(const v in h)p[v]=s.call(this,h[v],v,h);return p}function kl(h,s,u){const p={};for(const v in h)s.call(this,h[v],v,h)&&(p[v]=h[v]);return p}function Fs(h){return Array.isArray(h)?h.map(Fs):typeof h=="object"&&h?rc(h,Fs):h}const nc={};function sn(h){nc[h]||(typeof console<"u"&&console.warn(h),nc[h]=!0)}function ts(h,s,u){return(u.y-h.y)*(s.x-h.x)>(s.y-h.y)*(u.x-h.x)}function Uu(h){let s=0;for(let u,p,v=0,m=h.length,_=m-1;v<m;_=v++)u=h[v],p=h[_],s+=(p.x-u.x)*(u.y+p.y);return s}function Ua([h,s,u]){const p=tt(s+90),v=tt(u);return{x:h*Math.cos(p)*Math.sin(v),y:h*Math.sin(p)*Math.sin(v),z:h*Math.cos(v),azimuthal:s,polar:u}}function Zs(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Wn(h){const s={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,p,v,m)=>{const _=v||m;return s[p]=!_||_.toLowerCase(),""}),s["max-age"]){const u=parseInt(s["max-age"],10);isNaN(u)?delete s["max-age"]:s["max-age"]=u}return s}let fa=null;function Pa(h,s){return[h[4*s],h[4*s+1],h[4*s+2],h[4*s+3]]}function Cs(h,s,u,p){for(;s<u;){const v=s+u>>1;h[v]<p?s=v+1:u=v}return s}function El(h,s,u,p){for(;s<u;){const v=s+u>>1;h[v]<=p?s=v+1:u=v}return s}function Na(h){return h>0?1/(1.001-h):1+h}function Bs(h){return h>0?1-1/(1.001-h):-h}const $i={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!$i.API_URL)return null;try{const h=new URL($i.API_URL);return h.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":h.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ks(h){return $i.API_URL_REGEX.test(h)}function ms(h){return $i.API_SPRITE_REGEX.test(h)}let $u,Ki,Go,Tt,ve,Ae;function ke(){return $u==null&&($u=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),$u}const Ze={now:()=>Tt!==void 0?Tt:performance.now(),setNow(h){Tt=h},restoreNow(){Tt=void 0},frame(h){const s=requestAnimationFrame(h);return{cancel:()=>cancelAnimationFrame(s)}},getImageData(h,s=0){const{width:u,height:p}=h;ve||(ve=document.createElement("canvas"));const v=ve.getContext("2d",{willReadFrequently:!0});if(!v)throw new Error("failed to create canvas 2d context");return(u>ve.width||p>ve.height)&&(ve.width=u,ve.height=p),v.clearRect(-s,-s,u+2*s,p+2*s),v.drawImage(h,0,0,u,p),v.getImageData(-s,-s,u+2*s,p+2*s)},resolveURL:h=>(Ki||(Ki=document.createElement("a")),Ki.href=h,Ki.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Go==null&&(Go=window.matchMedia("(prefers-reduced-motion: reduce)")),Go.matches)},hasCanvasFingerprintNoise(){if(Ae!==void 0)return Ae;if(!ke())return Ae=!1,!1;const h=new OffscreenCanvas(85,1),s=h.getContext("2d",{willReadFrequently:!0});let u=0;for(let v=0;v<h.width;++v)s.fillStyle=`rgba(${u++},${u++},${u++}, 255)`,s.fillRect(v,0,1,1);const p=s.getImageData(0,0,h.width,h.height);u=0;for(let v=0;v<p.data.length;++v)if(v%4!=3&&u++!==p.data[v])return Ae=!0,!0;return Ae=!1,!1}};function Je(h,s){const u=h.indexOf("?");if(u<0)return`${h}?${new URLSearchParams(s).toString()}`;const p=new URLSearchParams(h.slice(u));for(const v in s)p.set(v,s[v]);return`${h.slice(0,u)}?${p.toString()}`}function at(h,s={persistentParams:[]}){const u=h.indexOf("?");if(u<0)return h;const p=new URLSearchParams,v=new URLSearchParams(h.slice(u));for(const _ of s.persistentParams){const C=v.get(_);C&&p.set(_,C)}const m=p.toString();return`${h.slice(0,u)}${m.length>0?`?${m}`:""}`}const gt="mapbox-tiles";let lt=500,St=50;const wt=["language","worldview","jobid"];let Pt,Vt;function ar(){try{return caches}catch{}}function or(){const h=ar();h&&Pt==null&&(Pt=h.open(gt))}let Ar=1/0;const Gr={supported:!1,testSupport:function(h){!On&&Ur&&(Kn?Un(h):$r=h)}};let $r,Ur,On=!1,Kn=!1;const wn=typeof self<"u"?self:{};function Un(h){const s=h.createTexture();h.bindTexture(h.TEXTURE_2D,s);try{if(h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,Ur),h.isContextLost())return;Gr.supported=!0}catch{}h.deleteTexture(s),On=!0}wn.document&&(Ur=wn.document.createElement("img"),Ur.onload=function(){$r&&Un($r),$r=null,Kn=!0},Ur.onerror=function(){On=!0,$r=null},Ur.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Rn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Rn);class ja extends Error{constructor(s,u,p){u===401&&ks(p)&&(s+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(s),this.status=u,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const gs=Zs()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,$a=function(h,s){if(!(/^file:/.test(u=h.url)||/^file:/.test(gs())&&!/^\w+:/.test(u))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(p,v){const m=new AbortController,_=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:gs(),referrerPolicy:p.referrerPolicy,signal:m.signal});let C=!1,O=!1;const B=(j=_.url).indexOf("sku=")>0&&ks(j);var j;p.type==="json"&&_.headers.set("Accept","application/json");const R=(M,I,q)=>{if(O)return;if(M&&M.message!=="SecurityError"&&sn(M.toString()),I&&q)return F(I);const X=Date.now();fetch(_).then(te=>{if(te.ok){const le=B?te.clone():null;return F(te,le,X)}return v(new ja(te.statusText,te.status,p.url))}).catch(te=>{te.name!=="AbortError"&&v(new Error(`${te.message} ${p.url}`))})},F=(M,I,q)=>{(p.type==="arrayBuffer"?M.arrayBuffer():p.type==="json"?M.json():M.text()).then(X=>{O||(I&&q&&function(te,le,ue){if(or(),Pt==null)return;const ie=Wn(le.headers.get("Cache-Control")||"");if(ie["no-store"])return;const fe={status:le.status,statusText:le.statusText,headers:new Headers};le.headers.forEach((Le,Ie)=>fe.headers.set(Ie,Le)),ie["max-age"]&&fe.headers.set("Expires",new Date(ue+1e3*ie["max-age"]).toUTCString());const ye=fe.headers.get("Expires");if(!ye||new Date(ye).getTime()-ue<42e4)return;let Se=at(te.url,{persistentParams:wt});if(le.status===206){const Le=te.headers.get("Range");if(!Le)return;fe.status=200,Se=Je(Se,{range:Le})}(function(Le,Ie){if(Vt===void 0)try{new Response(new ReadableStream),Vt=!0}catch{Vt=!1}Vt?Ie(Le.body):Le.blob().then(Ie)})(le,Le=>{const Ie=new Response((Me=le.status)!==200&&Me!==404&&[101,103,204,205,304].includes(Me)?null:Le,fe);var Me;or(),Pt!=null&&Pt.then(et=>et.put(Se,Ie)).catch(et=>sn(et.message))})}(_,I,q),C=!0,v(null,X,M.headers.get("Cache-Control"),M.headers.get("Expires")))}).catch(X=>{O||v(new Error(X.message))})};return B?function(M,I){if(or(),Pt==null)return I(null);Pt.then(q=>{let X=at(M.url,{persistentParams:wt});const te=M.headers.get("Range");te&&(X=Je(X,{range:te})),q.match(X).then(le=>{const ue=function(ie){if(!ie)return!1;const fe=new Date(ie.headers.get("Expires")||0),ye=Wn(ie.headers.get("Cache-Control")||"");return fe>Date.now()&&!ye["no-cache"]}(le);q.delete(X),ue&&q.put(X,le.clone()),I(null,le,ue)}).catch(I)}).catch(I)}(_,R):R(null,null),{cancel:()=>{O=!0,C||m.abort()}}}(h,s);if(Zs()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",h,s,void 0,!0)}var u;return function(p,v){const m=new XMLHttpRequest;m.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(m.responseType="arraybuffer");for(const _ in p.headers)m.setRequestHeader(_,p.headers[_]);return p.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=p.credentials==="include",m.onerror=()=>{v(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let _=m.response;if(p.type==="json")try{_=JSON.parse(m.response)}catch(C){return v(C)}v(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else v(new ja(m.statusText,m.status,p.url))},m.send(p.body),{cancel:()=>m.abort()}}(h,s)},rs=function(h,s){return $a(Ui(h,{type:"arrayBuffer"}),s)};function ho(h){const s=document.createElement("a");return s.href=h,s.protocol===location.protocol&&s.host===location.host}const qu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ml,Qc;Ml=[],Qc=0;const tf=function(h,s){if(Gr.supported&&(h.headers||(h.headers={}),h.headers.accept="image/webp,*/*"),Qc>=$i.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:h,callback:s,cancelled:!1,cancel(){this.cancelled=!0}};return Ml.push(m),m}Qc++;let u=!1;const p=()=>{if(!u)for(u=!0,Qc--;Ml.length&&Qc<$i.MAX_PARALLEL_IMAGE_REQUESTS;){const m=Ml.shift(),{requestParameters:_,callback:C,cancelled:O}=m;O||(m.cancel=tf(_,C).cancel)}},v=rs(h,(m,_,C,O)=>{p(),m?s(m):_&&(self.createImageBitmap?function(B,j){const R=new Blob([new Uint8Array(B)],{type:"image/png"});createImageBitmap(R).then(F=>{j(null,F)}).catch(F=>{j(new Error(`Could not load image because of ${F.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(B,j)=>s(B,j,C,O)):function(B,j){const R=new Image;R.onload=()=>{j(null,R),URL.revokeObjectURL(R.src),R.onload=null,requestAnimationFrame(()=>{R.src=qu})},R.onerror=()=>j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const F=new Blob([new Uint8Array(B)],{type:"image/png"});R.src=B.byteLength?URL.createObjectURL(F):qu}(_,(B,j)=>s(B,j,C,O)))});return{cancel:()=>{v.cancel(),p()}}};var ov,vy,mp,Ys={exports:{}},fl={exports:{}},pl={exports:{}},Ac=function(){if(mp)return Ys.exports;mp=1;var h=(ov||(ov=1,fl.exports=function(u,p){var v,m,_,C,O,B,j,R;for(m=u.length-(v=3&u.length),_=p,O=3432918353,B=461845907,R=0;R<m;)j=255&u.charCodeAt(R)|(255&u.charCodeAt(++R))<<8|(255&u.charCodeAt(++R))<<16|(255&u.charCodeAt(++R))<<24,++R,_=27492+(65535&(C=5*(65535&(_=(_^=j=(65535&(j=(j=(65535&j)*O+(((j>>>16)*O&65535)<<16)&4294967295)<<15|j>>>17))*B+(((j>>>16)*B&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(j=0,v){case 3:j^=(255&u.charCodeAt(R+2))<<16;case 2:j^=(255&u.charCodeAt(R+1))<<8;case 1:_^=j=(65535&(j=(j=(65535&(j^=255&u.charCodeAt(R)))*O+(((j>>>16)*O&65535)<<16)&4294967295)<<15|j>>>17))*B+(((j>>>16)*B&65535)<<16)&4294967295}return _^=u.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),fl.exports),s=(vy||(vy=1,pl.exports=function(u,p){for(var v,m=u.length,_=p^m,C=0;m>=4;)v=1540483477*(65535&(v=255&u.charCodeAt(C)|(255&u.charCodeAt(++C))<<8|(255&u.charCodeAt(++C))<<16|(255&u.charCodeAt(++C))<<24))+((1540483477*(v>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(v=1540483477*(65535&(v^=v>>>24))+((1540483477*(v>>>16)&65535)<<16)),m-=4,++C;switch(m){case 3:_^=(255&u.charCodeAt(C+2))<<16;case 2:_^=(255&u.charCodeAt(C+1))<<8;case 1:_=1540483477*(65535&(_^=255&u.charCodeAt(C)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),pl.exports);return Ys.exports=h,Ys.exports.murmur3=h,Ys.exports.murmur2=s,Ys.exports}(),ml=x(Ac);class _i{constructor(s,...u){Ui(this,u[0]||{}),this.type=s}}class gp extends _i{constructor(s,u={}){super("error",Ui({error:s},u))}}function Rm(h,s,u){u[h]&&u[h].indexOf(s)!==-1||(u[h]=u[h]||[],u[h].push(s))}function Tc(h,s,u){if(u&&u[h]){const p=u[h].indexOf(s);p!==-1&&u[h].splice(p,1)}}class eu{on(s,u){return this._listeners=this._listeners||{},Rm(s,u,this._listeners),this}off(s,u){return Tc(s,u,this._listeners),Tc(s,u,this._oneTimeListeners),this}once(s,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Rm(s,u,this._oneTimeListeners),this):new Promise(p=>this.once(s,p))}fire(s,u){const p=typeof s=="string"?new _i(s,u):s,v=p.type;if(this.listens(v)){p.target=this;const m=this._listeners&&this._listeners[v]?this._listeners[v].slice():[];for(const O of m)O.call(this,p);const _=this._oneTimeListeners&&this._oneTimeListeners[v]?this._oneTimeListeners[v].slice():[];for(const O of _)Tc(v,O,this._oneTimeListeners),O.call(this,p);const C=this._eventedParent;C&&(Ui(p,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(p))}else p instanceof gp&&console.error(p.error);return this}listens(s){return!!(this._listeners&&this._listeners[s]&&this._listeners[s].length>0||this._oneTimeListeners&&this._oneTimeListeners[s]&&this._oneTimeListeners[s].length>0||this._eventedParent&&this._eventedParent.listens(s))}setEventedParent(s,u){return this._eventedParent=s,this._eventedParentData=u,this}}var xy,Im={},Wo=function(){if(xy)return Im;xy=1;var h={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(m){return(m=Math.round(m))<0?0:m>255?255:m}function u(m){return s(m[m.length-1]==="%"?parseFloat(m)/100*255:parseInt(m))}function p(m){return(_=m[m.length-1]==="%"?parseFloat(m)/100:parseFloat(m))<0?0:_>1?1:_;var _}function v(m,_,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?m+(_-m)*C*6:2*C<1?_:3*C<2?m+(_-m)*(2/3-C)*6:m}try{Im.parseCSSColor=function(m){var _,C=m.replace(/ /g,"").toLowerCase();if(C in h)return h[C].slice();if(C[0]==="#")return C.length===4?(_=parseInt(C.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:C.length===7&&(_=parseInt(C.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var O=C.indexOf("("),B=C.indexOf(")");if(O!==-1&&B+1===C.length){var j=C.substr(0,O),R=C.substr(O+1,B-(O+1)).split(","),F=1;switch(j){case"rgba":if(R.length!==4)return null;F=p(R.pop());case"rgb":return R.length!==3?null:[u(R[0]),u(R[1]),u(R[2]),F];case"hsla":if(R.length!==4)return null;F=p(R.pop());case"hsl":if(R.length!==3)return null;var M=(parseFloat(R[0])%360+360)%360/360,I=p(R[1]),q=p(R[2]),X=q<=.5?q*(I+1):q+I-q*I,te=2*q-X;return[s(255*v(te,X,M+1/3)),s(255*v(te,X,M)),s(255*v(te,X,M-1/3)),F];default:return null}}return null}}catch{}return Im}();class Qn{constructor(s,u,p,v=1){this.r=s,this.g=u,this.b=p,this.a=v}static parse(s){if(!s)return;if(s instanceof Qn)return s;if(typeof s!="string")return;const u=Wo.parseCSSColor(s);return u?new Qn(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toStringPremultipliedAlpha(){const[s,u,p,v]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(s)},${Math.round(u)},${Math.round(p)},${v})`}toString(){const[s,u,p,v]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*s)},${Math.round(255*u)},${Math.round(255*p)},${v})`}toRenderColor(s){const{r:u,g:p,b:v,a:m}=this;return new Pc(s,u,p,v,m)}clone(){return new Qn(this.r,this.g,this.b,this.a)}}class Pc{constructor(s,u,p,v,m){if(s){const _=s.image.height,C=_*_;u=m===0?0:u/m*(_-1),p=m===0?0:p/m*(_-1),v=m===0?0:v/m*(_-1);const O=Math.floor(u),B=Math.floor(p),j=Math.floor(v),R=Math.ceil(u),F=Math.ceil(p),M=Math.ceil(v),I=u-O,q=p-B,X=v-j,te=s.image.data,le=4*(O+B*C+j*_),ue=4*(O+B*C+M*_),ie=4*(O+F*C+j*_),fe=4*(O+F*C+M*_),ye=4*(R+B*C+j*_),Se=4*(R+B*C+M*_),Le=4*(R+F*C+j*_),Ie=4*(R+F*C+M*_);if(le<0||Ie>=te.length)throw new Error("out of range");this.r=Fr(Fr(Fr(te[le],te[ue],X),Fr(te[ie],te[fe],X),q),Fr(Fr(te[ye],te[Se],X),Fr(te[Le],te[Ie],X),q),I)/255*m,this.g=Fr(Fr(Fr(te[le+1],te[ue+1],X),Fr(te[ie+1],te[fe+1],X),q),Fr(Fr(te[ye+1],te[Se+1],X),Fr(te[Le+1],te[Ie+1],X),q),I)/255*m,this.b=Fr(Fr(Fr(te[le+2],te[ue+2],X),Fr(te[ie+2],te[fe+2],X),q),Fr(Fr(te[ye+2],te[Se+2],X),Fr(te[Le+2],te[Ie+2],X),q),I)/255*m,this.a=m}else this.r=u,this.g=p,this.b=v,this.a=m}toArray(){const{r:s,g:u,b:p,a:v}=this;return v===0?[0,0,0,0]:[255*s/v,255*u/v,255*p/v,v]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:s,g:u,b:p,a:v}=this,m=Math.min(Math.max(s/v,0),1),_=Math.min(Math.max(u/v,0),1),C=Math.min(Math.max(p/v,0),1),O=Math.min(m,_,C),B=Math.max(m,_,C),j=(O+B)/2;if(O===B)return[0,0,100*j,v];const R=B-O,F=j>.5?R/(2-B-O):R/(B+O);let M=0;return B===m?M=(_-C)/R+(_<C?6:0):B===_?M=(C-m)/R+2:B===C&&(M=(m-_)/R+4),M*=60,[Math.min(Math.max(M,0),360),Math.min(Math.max(100*F,0),100),Math.min(Math.max(100*j,0),100),v]}toArray01(){const{r:s,g:u,b:p,a:v}=this;return v===0?[0,0,0,0]:[s/v,u/v,p/v,v]}toArray01Scaled(s){const{r:u,g:p,b:v,a:m}=this;return m===0?[0,0,0]:[u/m*s,p/m*s,v/m*s]}toArray01PremultipliedAlpha(){const{r:s,g:u,b:p,a:v}=this;return[s,u,p,v]}toArray01Linear(){const{r:s,g:u,b:p,a:v}=this;return v===0?[0,0,0,0]:[Math.pow(s/v,2.2),Math.pow(u/v,2.2),Math.pow(p/v,2.2),v]}}function Fr(h,s,u){return h*(1-u)+s*u}function tu(h,s,u){return h.map((p,v)=>Fr(p,s[v],u))}Qn.black=new Qn(0,0,0,1),Qn.white=new Qn(1,1,1,1),Qn.transparent=new Qn(0,0,0,0),Qn.red=new Qn(1,0,0,1),Qn.blue=new Qn(0,0,1,1);var Gu=Object.freeze({__proto__:null,array:tu,color:function(h,s,u){return new Qn(Fr(h.r,s.r,u),Fr(h.g,s.g,u),Fr(h.b,s.b,u),Fr(h.a,s.a,u))},number:Fr});function Wu(h,...s){for(const u of s)for(const p in u)h[p]=u[p];return h}class fn extends Error{constructor(s,u){super(u),this.message=u,this.key=s}}class Dm{constructor(s,u=[]){this.parent=s,this.bindings={};for(const[p,v]of u)this.bindings[p]=v}concat(s){return new Dm(this,s)}get(s){if(this.bindings[s])return this.bindings[s];if(this.parent)return this.parent.get(s);throw new Error(`${s} not found in scope.`)}has(s){return!!this.bindings[s]||!!this.parent&&this.parent.has(s)}}const Hu={kind:"null"},wr={kind:"number"},yi={kind:"string"},Hn={kind:"boolean"},ys={kind:"color"},Nc={kind:"object"},si={kind:"value"},ru={kind:"collator"},Ho={kind:"formatted"},jc={kind:"resolvedImage"};function qa(h,s){return{kind:"array",itemType:h,N:s}}function pa(h){if(h.kind==="array"){const s=pa(h.itemType);return typeof h.N=="number"?`array<${s}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${s}>`}return h.kind}const _y=[Hu,wr,yi,Hn,ys,Ho,Nc,qa(si),jc];function Xs(h,s){if(s.kind==="error")return null;if(h.kind==="array"){if(s.kind==="array"&&(s.N===0&&s.itemType.kind==="value"||!Xs(h.itemType,s.itemType))&&(typeof h.N!="number"||h.N===s.N))return null}else{if(h.kind===s.kind)return null;if(h.kind==="value"){for(const u of _y)if(!Xs(u,s))return null}}return`Expected ${pa(h)} but found ${pa(s)} instead.`}function $d(h,s){return s.some(u=>u.kind===h.kind)}function qd(h,s){return s.some(u=>u==="null"?h===null:u==="array"?Array.isArray(h):u==="object"?h&&!Array.isArray(h)&&typeof h=="object":u===typeof h)}class yp{constructor(s,u,p){this.sensitivity=s?u?"variant":"case":u?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(s,u){return this.collator.compare(s,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ol{constructor(s,u,p,v,m){this.text=s.normalize?s.normalize():s,this.image=u,this.scale=p,this.fontStack=v,this.textColor=m}}class Es{constructor(s){this.sections=s}static fromString(s){return new Es([new Ol(s,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(s=>s.text.length!==0||s.image&&s.image.namePrimary)}static factory(s){return s instanceof Es?s:Es.fromString(s)}toString(){return this.sections.length===0?"":this.sections.map(s=>s.text).join("")}serialize(){const s=["format"];for(const u of this.sections){if(u.image){s.push(["image",u.image.namePrimary]);continue}s.push(u.text);const p={};u.fontStack&&(p["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(p["font-scale"]=u.scale),u.textColor&&(p["text-color"]=["rgba"].concat(u.textColor.toRenderColor(null).toArray())),s.push(p)}return s}}class gl{constructor(s,u){if(this.id=s,this.options=u||{params:{}},this.options.transform){const{a:p,b:v,c:m,d:_,e:C,f:O}=this.options.transform;this.options.transform=new DOMMatrix([p,v,m,_,C,O])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(s){return JSON.parse(s).id}static deserializeFromString(s){const u=JSON.parse(s),{a:p,b:v,c:m,d:_,e:C,f:O}=u.options.transform;return new DOMMatrix([p,v,m,_,C,O]),new gl(u.id,u.options)}scaleSelf(s){return this.options.transform=this.options.transform.scale(s),this}serialize(){const s={id:this.id};this.options&&(s.options=this.options);const{a:u,b:p,c:v,d:m,e:_,f:C}=this.options.transform;return s.options.transform={a:u,b:p,c:v,d:m,e:_,f:C},JSON.stringify(s)}}class Ms{constructor(s){this.namePrimary=s.namePrimary,s.nameSecondary&&(this.nameSecondary=s.nameSecondary),s.optionsPrimary&&(this.optionsPrimary=s.optionsPrimary),s.optionsSecondary&&(this.optionsSecondary=s.optionsSecondary),this.available=s.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new gl(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new gl(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(s){return typeof s=="string"?Ms.build(s):s}static build(s,u,p,v){return s?new Ms({namePrimary:s,nameSecondary:u,optionsPrimary:p,optionsSecondary:v,available:!1}):null}}function rf(h,s,u,p){return typeof h=="number"&&h>=0&&h<=255&&typeof s=="number"&&s>=0&&s<=255&&typeof u=="number"&&u>=0&&u<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[h,s,u,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[h,s,u,p]:[h,s,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Rl(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof Qn||h instanceof yp||h instanceof Es||h instanceof Ms)return!0;if(Array.isArray(h)){for(const s of h)if(!Rl(s))return!1;return!0}if(typeof h=="object"){for(const s in h)if(!Rl(h[s]))return!1;return!0}return!1}function na(h){if(h===null)return Hu;if(typeof h=="string")return yi;if(typeof h=="boolean")return Hn;if(typeof h=="number")return wr;if(h instanceof Qn)return ys;if(h instanceof yp)return ru;if(h instanceof Es)return Ho;if(h instanceof Ms)return jc;if(Array.isArray(h)){const s=h.length;let u;for(const p of h){const v=na(p);if(u){if(u===v)continue;u=si;break}u=v}return qa(u||si,s)}return Nc}function Ca(h){const s=typeof h;return h===null?"":s==="string"||s==="number"||s==="boolean"?String(h):h instanceof Qn?h.toStringPremultipliedAlpha():h instanceof Es||h instanceof Ms?h.toString():JSON.stringify(h)}class ka{constructor(s,u){this.type=s,this.value=u}static parse(s,u){if(s.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${s.length-1} instead.`);if(!Rl(s[1]))return u.error("invalid value");const p=s[1];let v=na(p);const m=u.expectedType;return v.kind!=="array"||v.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(v=m),new ka(v,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Qn?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Es?this.value.serialize():this.value}}class ma{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}}const nu={string:yi,number:wr,boolean:Hn,object:Nc};class ic{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");let p,v=1;const m=s[0];if(m==="array"){let C,O;if(s.length>2){const B=s[1];if(typeof B!="string"||!(B in nu)||B==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);C=nu[B],v++}else C=si;if(s.length>3){if(s[2]!==null&&(typeof s[2]!="number"||s[2]<0||s[2]!==Math.floor(s[2])))return u.error('The length argument to "array" must be a positive integer literal',2);O=s[2],v++}p=qa(C,O)}else p=nu[m];const _=[];for(;v<s.length;v++){const C=u.parse(s[v],v,si);if(!C)return null;_.push(C)}return new ic(p,_)}evaluate(s){for(let u=0;u<this.args.length;u++){const p=this.args[u].evaluate(s);if(!Xs(this.type,na(p)))return p;if(u===this.args.length-1)throw new ma(`The expression ${JSON.stringify(this.args[u].serialize())} evaluated to ${pa(na(p))} but was expected to be of type ${pa(this.type)}.`)}return null}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=this.type,u=[s.kind];if(s.kind==="array"){const p=s.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){u.push(p.kind);const v=s.N;(typeof v=="number"||this.args.length>1)&&u.push(v)}}return u.concat(this.args.map(p=>p.serialize()))}}class iu{constructor(s){this.type=Ho,this.sections=s}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const p=s[1];if(!Array.isArray(p)&&typeof p=="object")return u.error("First argument must be an image or text section.");const v=[];let m=!1;for(let _=1;_<=s.length-1;++_){const C=s[_];if(m&&typeof C=="object"&&!Array.isArray(C)){m=!1;let O=null;if(C["font-scale"]&&(O=u.parseObjectValue(C["font-scale"],_,"font-scale",wr),!O))return null;let B=null;if(C["text-font"]&&(B=u.parseObjectValue(C["text-font"],_,"text-font",qa(yi)),!B))return null;let j=null;if(C["text-color"]&&(j=u.parseObjectValue(C["text-color"],_,"text-color",ys),!j))return null;const R=v[v.length-1];R.scale=O,R.font=B,R.textColor=j}else{const O=u.parse(s[_],_,si);if(!O)return null;const B=O.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,v.push({content:O,scale:null,font:null,textColor:null})}}return new iu(v)}evaluate(s){return new Es(this.sections.map(u=>{const p=u.content.evaluate(s);return na(p)===jc?new Ol("",p,null,null,null):new Ol(Ca(p),null,u.scale?u.scale.evaluate(s):null,u.font?u.font.evaluate(s).join(","):null,u.textColor?u.textColor.evaluate(s):null)}))}eachChild(s){for(const u of this.sections)s(u.content),u.scale&&s(u.scale),u.font&&s(u.font),u.textColor&&s(u.textColor)}outputDefined(){return!1}serialize(){const s=["format"];for(const u of this.sections){s.push(u.content.serialize());const p={};u.scale&&(p["font-scale"]=u.scale.serialize()),u.font&&(p["text-font"]=u.font.serialize()),u.textColor&&(p["text-color"]=u.textColor.serialize()),s.push(p)}return s}}class Gd{constructor(s,u,p,v){this._imageWarnHistory={},this.type=jc,this.inputPrimary=s,this.inputSecondary=u,this.inputPrimaryParams=p,this.inputSecondaryParams=v}static parse(s,u){if(s.length<2)return u.error("Expected two or more arguments.");let p=1;const v=[];function m(){if(p<s.length){const C=u.parse(s[p],p++,yi);return C?(v.push({image:C,options:void 0}),!0):(u.error(v.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(p<s.length){if((C=s[p])===null||typeof C!="object"||Array.isArray(C))return!0;const O=s[p].params,B=u.concat(p);if(!O)return p++,!0;if(typeof O!="object"||O.constructor!==Object)return B.error('Image options "params" should be an object'),!1;const j={},R=B.concat(void 0,"params");for(const F in O){if(!F)return R.error("Image parameter name should be non-empty"),!1;const M=R.concat(void 0,F).parse(O[F],void 0,ys,void 0,{typeAnnotation:"coerce"});if(!M)return!1;j[F]=M}return v[v.length-1].options=j,p++,!0}var C;return!0}for(let C=0;C<2;C++)if(!m()||!_())return;return new Gd(v[0].image,v[1]?v[1].image:void 0,v[0].options,v[1]?v[1].options:void 0)}evaluateParams(s,u){const p={};if(u){for(const v in u)if(u[v])try{const m=u[v].evaluate(s),_=`Ignoring image parameter "${v}" with semi-transparent color ${m.toString()}`;if(m.a!==1){this._imageWarnHistory[_]||(console.warn(_),this._imageWarnHistory[_]=!0);continue}p[v]=m}catch{continue}if(Object.keys(p).length!==0)return{params:p}}}evaluate(s){const u=Ms.build(this.inputPrimary.evaluate(s),this.inputSecondary?this.inputSecondary.evaluate(s):void 0,this.inputPrimaryParams?this.evaluateParams(s,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(s,this.inputSecondaryParams):void 0);return u&&s.availableImages&&(u.available=s.availableImages.indexOf(u.namePrimary)>-1,u.nameSecondary&&u.available&&s.availableImages&&(u.available=s.availableImages.indexOf(u.nameSecondary)>-1)),u}eachChild(s){if(s(this.inputPrimary),this.inputPrimaryParams)for(const u in this.inputPrimaryParams)this.inputPrimaryParams[u]&&s(this.inputPrimaryParams[u]);if(this.inputSecondary&&(s(this.inputSecondary),this.inputSecondaryParams))for(const u in this.inputSecondaryParams)this.inputSecondaryParams[u]&&s(this.inputSecondaryParams[u])}outputDefined(){return!1}serializeParams(s){const u={};if(s){for(const p in s)s[p]&&(u[p]=s[p].serialize());return{params:u}}}serialize(){const s=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&s.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(s.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&s.push(this.serializeParams(this.inputSecondaryParams))),s}}function Po(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}const nf={"to-boolean":Hn,"to-color":ys,"to-number":wr,"to-string":yi};class Cc{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expected at least one argument.");const p=s[0],v=[];let m=Hu;if(p==="to-array"){if(!Array.isArray(s[1]))return null;const _=s[1].length;if(u.expectedType){if(u.expectedType.kind!=="array")return u.error(`Expected ${u.expectedType.kind} but found array.`);m=qa(u.expectedType.itemType,_)}else{if(!(_>0&&Rl(s[1][0])))return null;m=qa(na(s[1][0]),_)}for(let C=0;C<_;C++){const O=s[1][C];let B;if(Po(O)==="array")B=u.parse(O,void 0,m.itemType);else{const j=Po(O);if(j!==m.itemType.kind)return u.error(`Expected ${m.itemType.kind} but found ${j}.`);B=u.registry.literal.parse(["literal",O===void 0?null:O],u)}if(!B)return null;v.push(B)}}else{if((p==="to-boolean"||p==="to-string")&&s.length!==2)return u.error("Expected one argument.");m=nf[p];for(let _=1;_<s.length;_++){const C=u.parse(s[_],_,si);if(!C)return null;v.push(C)}}return new Cc(m,v)}evaluate(s){if(this.type.kind==="boolean")return!!this.args[0].evaluate(s);if(this.type.kind==="color"){let u,p;for(const v of this.args){if(u=v.evaluate(s),p=null,u instanceof Qn)return u;if(typeof u=="string"){const m=s.parseColor(u);if(m)return m}else if(Array.isArray(u)&&(p=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:rf(u[0],u[1],u[2],u[3]),!p))return new Qn(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new ma(p||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const p of this.args){if(u=p.evaluate(s),u===null)return 0;const v=Number(u);if(!isNaN(v))return v}throw new ma(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?Es.fromString(Ca(this.args[0].evaluate(s))):this.type.kind==="resolvedImage"?Ms.build(Ca(this.args[0].evaluate(s))):this.type.kind==="array"?this.args.map(u=>u.evaluate(s)):Ca(this.args[0].evaluate(s))}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){if(this.type.kind==="formatted")return new iu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Gd(this.args[0]).serialize();const s=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(u=>{s.push(u.serialize())}),s}}const B_=["Unknown","Point","LineString","Polygon"];class by{constructor(s,u){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=s,this.options=u}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?B_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(s){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,u=this.featureDistanceData.scale,{x:p,y:v}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*u-s[0])+this.featureDistanceData.bearing[1]*(v*u-s[1])}return 0}parseColor(s){let u=this._parseColorCache[s];return u||(u=this._parseColorCache[s]=Qn.parse(s)),u}getConfig(s){return this.options?this.options.get(s):null}}class No{constructor(s,u,p,v,m){this.name=s,this.type=u,this._evaluate=p,this.args=v,this._overloadIndex=m}evaluate(s){if(!this._evaluate){const u=No.definitions[this.name];this._evaluate=Array.isArray(u)?u[2]:u.overloads[this._overloadIndex][1]}return this._evaluate(s,this.args)}eachChild(s){this.args.forEach(s)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(s=>s.serialize()))}static parse(s,u){const p=s[0],v=No.definitions[p];if(!v)return u.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(v)?v[0]:v.type,_=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,C=[];let O=null,B=-1;for(const[j,R]of _){if(Array.isArray(j)&&j.length!==s.length-1)continue;C.push(j),B++,O=new uf(u.registry,u.path,null,u.scope,void 0,u._scope,u.options);const F=[];let M=!1;for(let I=1;I<s.length;I++){const q=s[I],X=Array.isArray(j)?j[I-1]:j.type,te=O.parse(q,1+F.length,X);if(!te){M=!0;break}F.push(te)}if(!M)if(Array.isArray(j)&&j.length!==F.length)O.error(`Expected ${j.length} arguments, but found ${F.length} instead.`);else{for(let I=0;I<F.length;I++){const q=Array.isArray(j)?j[I]:j.type,X=F[I];O.concat(I+1).checkSubtype(q,X.type)}if(O.errors.length===0)return new No(p,m,R,F,B)}}if(C.length===1)u.errors.push(...O.errors);else{const j=(C.length?C:_.map(([F])=>F)).map(vp).join(" | "),R=[];for(let F=1;F<s.length;F++){const M=u.parse(s[F],1+R.length);if(!M)return null;R.push(pa(M.type))}u.error(`Expected arguments of type ${j}, but found (${R.join(", ")}) instead.`)}return null}static register(s,u){No.definitions=u;for(const p in u)s[p]=No}}function vp(h){return Array.isArray(h)?`(${h.map(pa).join(", ")})`:`(${pa(h.type)}...)`}class Lm{constructor(s,u,p){this.type=ru,this.locale=p,this.caseSensitive=s,this.diacriticSensitive=u}static parse(s,u){if(s.length!==2)return u.error("Expected one argument.");const p=s[1];if(typeof p!="object"||Array.isArray(p))return u.error("Collator options argument must be an object.");const v=p["case-sensitive"]===void 0?u.parse(!1,1,Hn):u.parseObjectValue(p["case-sensitive"],1,"case-sensitive",Hn);if(!v)return null;const m=p["diacritic-sensitive"]===void 0?u.parse(!1,1,Hn):u.parseObjectValue(p["diacritic-sensitive"],1,"diacritic-sensitive",Hn);if(!m)return null;let _=null;return p.locale&&(_=u.parseObjectValue(p.locale,1,"locale",yi),!_)?null:new Lm(v,m,_)}evaluate(s){return new yp(this.caseSensitive.evaluate(s),this.diacriticSensitive.evaluate(s),this.locale?this.locale.evaluate(s):null)}eachChild(s){s(this.caseSensitive),s(this.diacriticSensitive),this.locale&&s(this.locale)}outputDefined(){return!1}serialize(){const s={};return s["case-sensitive"]=this.caseSensitive.serialize(),s["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(s.locale=this.locale.serialize()),["collator",s]}}function xp(h,s,u=0,p=h.length-1,v=V_){for(;p>u;){if(p-u>600){const O=p-u+1,B=s-u+1,j=Math.log(O),R=.5*Math.exp(2*j/3),F=.5*Math.sqrt(j*R*(O-R)/O)*(B-O/2<0?-1:1);xp(h,s,Math.max(u,Math.floor(s-B*R/O+F)),Math.min(p,Math.floor(s+(O-B)*R/O+F)),v)}const m=h[s];let _=u,C=p;for(_p(h,u,s),v(h[p],m)>0&&_p(h,u,p);_<C;){for(_p(h,_,C),_++,C--;v(h[_],m)<0;)_++;for(;v(h[C],m)>0;)C--}v(h[u],m)===0?_p(h,u,C):(C++,_p(h,C,p)),C<=s&&(u=C+1),s<=C&&(p=C-1)}}function _p(h,s,u){const p=h[s];h[s]=h[u],h[u]=p}function V_(h,s){return h<s?-1:h>s?1:0}function U_(h){let s=0;for(let u,p,v=0,m=h.length,_=m-1;v<m;_=v++)u=h[v],p=h[_],s+=(p.x-u.x)*(u.y+p.y);return s}function af(h,s){h[0]=Math.min(h[0],s[0]),h[1]=Math.min(h[1],s[1]),h[2]=Math.max(h[2],s[0]),h[3]=Math.max(h[3],s[1])}function bp(h,s){return!(h[0]<=s[0]||h[2]>=s[2]||h[1]<=s[1]||h[3]>=s[3])}function $_(h,s,u){const p=h[0]-s[0],v=h[1]-s[1],m=h[0]-u[0],_=h[1]-u[1];return p*_-m*v==0&&p*m<=0&&v*_<=0}function sf(h,s,u=!1){let p=!1;for(let C=0,O=s.length;C<O;C++){const B=s[C];for(let j=0,R=B.length,F=R-1;j<R;F=j++){const M=B[F],I=B[j];if($_(h,M,I))return u;(m=M)[1]>(v=h)[1]!=(_=I)[1]>v[1]&&v[0]<(_[0]-m[0])*(v[1]-m[1])/(_[1]-m[1])+m[0]&&(p=!p)}}var v,m,_;return p}function wy(h,s,u,p){const v=p[0]-u[0],m=p[1]-u[1],_=(h[0]-u[0])*m-v*(h[1]-u[1]),C=(s[0]-u[0])*m-v*(s[1]-u[1]);return _>0&&C<0||_<0&&C>0}function ac(h,s,u,p){return(v=[p[0]-u[0],p[1]-u[1]])[0]*(m=[s[0]-h[0],s[1]-h[1]])[1]-v[1]*m[0]!=0&&!(!wy(h,s,u,p)||!wy(u,p,h,s));var v,m}const Ku=8192;function q_(h,s){const u=(180+h[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,v=Math.pow(2,s.z);return[Math.round(u*v*Ku),Math.round(p*v*Ku)]}function Sy(h,s){for(let u=0;u<s.length;u++)if(sf(h,s[u]))return!0;return!1}function lv(h,s,u){for(const p of u)for(let v=0,m=p.length,_=m-1;v<m;_=v++)if(ac(h,s,p[_],p[v]))return!0;return!1}function cv(h,s){for(let u=0;u<h.length;++u)if(!sf(h[u],s))return!1;for(let u=0;u<h.length-1;++u)if(lv(h[u],h[u+1],s))return!1;return!0}function G_(h,s){for(let u=0;u<s.length;u++)if(cv(h,s[u]))return!0;return!1}function Ay(h,s,u){const p=[];for(let v=0;v<h.length;v++){const m=[];for(let _=0;_<h[v].length;_++){const C=q_(h[v][_],u);af(s,C),m.push(C)}p.push(m)}return p}function Wd(h,s,u){const p=[];for(let v=0;v<h.length;v++){const m=Ay(h[v],s,u);p.push(m)}return p}function An(h,s,u,p){if(h[0]<u[0]||h[0]>u[2]){const v=.5*p;let m=h[0]-u[0]>v?-p:u[0]-h[0]>v?p:0;m===0&&(m=h[0]-u[2]>v?-p:u[2]-h[0]>v?p:0),h[0]+=m}af(s,h)}function Br(h,s,u,p){const v=Math.pow(2,p.z)*Ku,m=[p.x*Ku,p.y*Ku],_=[];if(!h)return _;for(const C of h)for(const O of C){const B=[O.x+m[0],O.y+m[1]];An(B,s,u,v),_.push(B)}return _}function zm(h,s,u,p){const v=Math.pow(2,p.z)*Ku,m=[p.x*Ku,p.y*Ku],_=[];if(!h)return _;for(const O of h){const B=[];for(const j of O){const R=[j.x+m[0],j.y+m[1]];af(s,R),B.push(R)}_.push(B)}if(s[2]-s[0]<=v/2){(C=s)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const O of _)for(const B of O)An(B,s,u,v)}var C;return _}class Kr{constructor(s,u){this.type=Hn,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${s.length-1} instead.`);if(Rl(s[1])){const p=s[1];if(p.type==="FeatureCollection")for(let v=0;v<p.features.length;++v){const m=p.features[v].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Kr(p,p.features[v].geometry)}else if(p.type==="Feature"){const v=p.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Kr(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Kr(p,p)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(s){if(s.geometry()!=null&&s.canonicalID()!=null){if(s.geometryType()==="Point")return function(u,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=u.canonicalID();if(!_)return!1;if(p.type==="Polygon"){const C=Ay(p.coordinates,m,_),O=Br(u.geometry(),v,m,_);if(!bp(v,m))return!1;for(const B of O)if(!sf(B,C))return!1}if(p.type==="MultiPolygon"){const C=Wd(p.coordinates,m,_),O=Br(u.geometry(),v,m,_);if(!bp(v,m))return!1;for(const B of O)if(!Sy(B,C))return!1}return!0}(s,this.geometries);if(s.geometryType()==="LineString")return function(u,p){const v=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=u.canonicalID();if(!_)return!1;if(p.type==="Polygon"){const C=Ay(p.coordinates,m,_),O=zm(u.geometry(),v,m,_);if(!bp(v,m))return!1;for(const B of O)if(!cv(B,C))return!1}if(p.type==="MultiPolygon"){const C=Wd(p.coordinates,m,_),O=zm(u.geometry(),v,m,_);if(!bp(v,m))return!1;for(const B of O)if(!G_(B,C))return!1}return!0}(s,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const kc={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Fm=1/298.257223563,Yr=Fm*(2-Fm),Hd=Math.PI/180;class Zu{static fromTile(s,u,p){const v=Math.PI*(1-2*(s+.5)/Math.pow(2,u)),m=Math.atan(.5*(Math.exp(v)-Math.exp(-v)))/Hd;return new Zu(m,p)}static get units(){return kc}constructor(s,u){if(s===void 0)throw new Error("No latitude given.");if(u&&!kc[u])throw new Error(`Unknown unit ${u}. Use one of: ${Object.keys(kc).join(", ")}`);const p=6378.137*Hd*(u?kc[u]:1),v=Math.cos(s*Hd),m=1/(1-Yr*(1-v*v)),_=Math.sqrt(m);this.kx=p*_*v,this.ky=p*_*m*(1-Yr)}distance(s,u){const p=vs(s[0]-u[0])*this.kx,v=(s[1]-u[1])*this.ky;return Math.sqrt(p*p+v*v)}bearing(s,u){const p=vs(u[0]-s[0])*this.kx;return Math.atan2(p,(u[1]-s[1])*this.ky)/Hd}destination(s,u,p){const v=p*Hd;return this.offset(s,Math.sin(v)*u,Math.cos(v)*u)}offset(s,u,p){return[s[0]+u/this.kx,s[1]+p/this.ky]}lineDistance(s){let u=0;for(let p=0;p<s.length-1;p++)u+=this.distance(s[p],s[p+1]);return u}area(s){let u=0;for(let p=0;p<s.length;p++){const v=s[p];for(let m=0,_=v.length,C=_-1;m<_;C=m++)u+=vs(v[m][0]-v[C][0])*(v[m][1]+v[C][1])*(p?-1:1)}return Math.abs(u)/2*this.kx*this.ky}along(s,u){let p=0;if(u<=0)return s[0];for(let v=0;v<s.length-1;v++){const m=s[v],_=s[v+1],C=this.distance(m,_);if(p+=C,p>u)return wp(m,_,(u-(p-C))/C)}return s[s.length-1]}pointToSegmentDistance(s,u,p){let[v,m]=u,_=vs(p[0]-v)*this.kx,C=(p[1]-m)*this.ky;if(_!==0||C!==0){const O=(vs(s[0]-v)*this.kx*_+(s[1]-m)*this.ky*C)/(_*_+C*C);O>1?(v=p[0],m=p[1]):O>0&&(v+=_/this.kx*O,m+=C/this.ky*O)}return _=vs(s[0]-v)*this.kx,C=(s[1]-m)*this.ky,Math.sqrt(_*_+C*C)}pointOnLine(s,u){let p=1/0,v=s[0][0],m=s[0][1],_=0,C=0;for(let O=0;O<s.length-1;O++){let B=s[O][0],j=s[O][1],R=vs(s[O+1][0]-B)*this.kx,F=(s[O+1][1]-j)*this.ky,M=0;R===0&&F===0||(M=(vs(u[0]-B)*this.kx*R+(u[1]-j)*this.ky*F)/(R*R+F*F),M>1?(B=s[O+1][0],j=s[O+1][1]):M>0&&(B+=R/this.kx*M,j+=F/this.ky*M)),R=vs(u[0]-B)*this.kx,F=(u[1]-j)*this.ky;const I=R*R+F*F;I<p&&(p=I,v=B,m=j,_=O,C=M)}return{point:[v,m],index:_,t:Math.max(0,Math.min(1,C))}}lineSlice(s,u,p){let v=this.pointOnLine(p,s),m=this.pointOnLine(p,u);if(v.index>m.index||v.index===m.index&&v.t>m.t){const B=v;v=m,m=B}const _=[v.point],C=v.index+1,O=m.index;!Bm(p[C],_[0])&&C<=O&&_.push(p[C]);for(let B=C+1;B<=O;B++)_.push(p[B]);return Bm(p[O],m.point)||_.push(m.point),_}lineSliceAlong(s,u,p){let v=0;const m=[];for(let _=0;_<p.length-1;_++){const C=p[_],O=p[_+1],B=this.distance(C,O);if(v+=B,v>s&&m.length===0&&m.push(wp(C,O,(s-(v-B))/B)),v>=u)return m.push(wp(C,O,(u-(v-B))/B)),m;v>s&&m.push(O)}return m}bufferPoint(s,u){const p=u/this.ky,v=u/this.kx;return[s[0]-v,s[1]-p,s[0]+v,s[1]+p]}bufferBBox(s,u){const p=u/this.ky,v=u/this.kx;return[s[0]-v,s[1]-p,s[2]+v,s[3]+p]}insideBBox(s,u){return vs(s[0]-u[0])>=0&&vs(s[0]-u[2])<=0&&s[1]>=u[1]&&s[1]<=u[3]}}function Bm(h,s){return h[0]===s[0]&&h[1]===s[1]}function wp(h,s,u){const p=vs(s[0]-h[0]);return[h[0]+p*u,h[1]+(s[1]-h[1])*u]}function vs(h){for(;h<-180;)h+=360;for(;h>180;)h-=360;return h}class Vs{constructor(s=[],u=(p,v)=>p<v?-1:p>v?1:0){if(this.data=s,this.length=this.data.length,this.compare=u,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(s){this.data.push(s),this._up(this.length++)}pop(){if(this.length===0)return;const s=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:u,compare:p}=this,v=u[s];for(;s>0;){const m=s-1>>1,_=u[m];if(p(v,_)>=0)break;u[s]=_,s=m}u[s]=v}_down(s){const{data:u,compare:p}=this,v=this.length>>1,m=u[s];for(;s<v;){let _=1+(s<<1);const C=_+1;if(C<this.length&&p(u[C],u[_])<0&&(_=C),p(u[_],m)>=0)break;u[s]=u[_],s=_}u[s]=m}}var hr=8192;function Ty(h,s){return s.dist-h.dist}const Sp=100,of=50;function Il(h){const s=[1/0,1/0,-1/0,-1/0];if(s.length!==h.length)return!1;for(let u=0;u<s.length;u++)if(s[u]!==h[u])return!1;return!0}function Ia(h){return h[1]-h[0]+1}function au(h,s){const u=h[1]>=h[0]&&h[1]<s;return u||console.warn("Distance Expression: Index is out of range"),u}function lf(h,s){if(h[0]>h[1])return[null,null];const u=Ia(h);if(s){if(u===2)return[h,null];const p=Math.floor(u/2);return[[h[0],h[0]+p],[h[0]+p,h[1]]]}{if(u===1)return[h,null];const p=Math.floor(u/2)-1;return[[h[0],h[0]+p],[h[0]+p+1,h[1]]]}}function Kd(h,s){const u=[1/0,1/0,-1/0,-1/0];if(!au(s,h.length))return u;for(let p=s[0];p<=s[1];++p)af(u,h[p]);return u}function Yu(h){const s=[1/0,1/0,-1/0,-1/0];for(let u=0;u<h.length;++u)for(let p=0;p<h[u].length;++p)af(s,h[u][p]);return s}function su(h,s,u){if(Il(h)||Il(s))return NaN;let p=0,v=0;return h[2]<s[0]&&(p=s[0]-h[2]),h[0]>s[2]&&(p=h[0]-s[2]),h[1]>s[3]&&(v=h[1]-s[3]),h[3]<s[1]&&(v=s[1]-h[3]),u.distance([0,0],[p,v])}function Ap(h){return 360*h-180}function uv(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function Vm(h,s){const u=Math.pow(2,s.z),p=(h.y/hr+s.y)/u;return[Ap((h.x/hr+s.x)/u),uv(p)]}function dv(h,s){const u=[];for(let p=0;p<h.length;++p)u.push(Vm(h[p],s));return u}function hv(h,s,u){const p=u.pointOnLine(s,h).point;return u.distance(h,p)}function Py(h,s,u,p,v){const m=u.slice(p[0],p[1]+1);let _=1/0;for(let C=s[0];C<=s[1];++C)if((_=Math.min(_,hv(h[C],m,v)))===0)return 0;return _}function Ny(h,s,u,p,v){const m=Math.min(v.pointToSegmentDistance(h,u,p),v.pointToSegmentDistance(s,u,p)),_=Math.min(v.pointToSegmentDistance(u,h,s),v.pointToSegmentDistance(p,h,s));return Math.min(m,_)}function W_(h,s,u,p,v){if(!au(s,h.length)||!au(p,u.length))return NaN;let m=1/0;for(let _=s[0];_<s[1];++_)for(let C=p[0];C<p[1];++C){if(ac(h[_],h[_+1],u[C],u[C+1]))return 0;m=Math.min(m,Ny(h[_],h[_+1],u[C],u[C+1],v))}return m}function fv(h,s,u,p,v){if(!au(s,h.length)||!au(p,u.length))return NaN;let m=1/0;for(let _=s[0];_<=s[1];++_)for(let C=p[0];C<=p[1];++C)if((m=Math.min(m,v.distance(h[_],u[C])))===0)return m;return m}function Js(h,s,u){if(sf(h,s,!0))return 0;let p=1/0;for(const v of s){const m=v.length;if(m<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(v[0]!==v[m-1]&&(p=Math.min(p,u.pointToSegmentDistance(h,v[m-1],v[0])))===0||(p=Math.min(p,hv(h,v,u)))===0)return p}return p}function Tp(h,s,u,p){if(!au(s,h.length))return NaN;for(let m=s[0];m<=s[1];++m)if(sf(h[m],u,!0))return 0;let v=1/0;for(let m=s[0];m<s[1];++m)for(const _ of u)for(let C=0,O=_.length,B=O-1;C<O;B=C++){if(ac(h[m],h[m+1],_[B],_[C]))return 0;v=Math.min(v,Ny(h[m],h[m+1],_[B],_[C],p))}return v}function jy(h,s){for(const u of h)for(let p=0;p<=u.length-1;++p)if(sf(u[p],s,!0))return!0;return!1}function Um(h,s,u,p=1/0){const v=Yu(h),m=Yu(s);if(p!==1/0&&su(v,m,u)>=p)return p;if(bp(v,m)){if(jy(h,s))return 0}else if(jy(s,h))return 0;let _=p;for(const C of h)for(let O=0,B=C.length,j=B-1;O<B;j=O++)for(const R of s)for(let F=0,M=R.length,I=M-1;F<M;I=F++){if(ac(C[j],C[O],R[I],R[F]))return 0;_=Math.min(_,Ny(C[j],C[O],R[I],R[F],u))}return _}function cf(h,s,u,p,v,m,_){if(m===null||_===null)return;const C=su(Kd(p,m),Kd(v,_),u);C<s&&h.push({dist:C,range1:m,range2:_})}function Cy(h,s,u,p,v=1/0){let m=Math.min(p.distance(h[0],u[0][0]),v);if(m===0)return m;const _=new Vs([{dist:0,range1:[0,h.length-1],range2:[0,0]}],Ty),C=s?of:Sp,O=Yu(u);for(;_.length;){const B=_.pop();if(B.dist>=m)continue;const j=B.range1;if(Ia(j)<=C){if(!au(j,h.length))return NaN;if(s){const R=Tp(h,j,u,p);if((m=Math.min(m,R))===0)return m}else for(let R=j[0];R<=j[1];++R){const F=Js(h[R],u,p);if((m=Math.min(m,F))===0)return m}}else{const R=lf(j,s);if(R[0]!==null){const F=su(Kd(h,R[0]),O,p);F<m&&_.push({dist:F,range1:R[0],range2:[0,0]})}if(R[1]!==null){const F=su(Kd(h,R[1]),O,p);F<m&&_.push({dist:F,range1:R[1],range2:[0,0]})}}}return m}function Ko(h,s,u,p,v,m=1/0){let _=Math.min(m,v.distance(h[0],u[0]));if(_===0)return _;const C=new Vs([{dist:0,range1:[0,h.length-1],range2:[0,u.length-1]}],Ty),O=s?of:Sp,B=p?of:Sp;for(;C.length;){const j=C.pop();if(j.dist>=_)continue;const R=j.range1,F=j.range2;if(Ia(R)<=O&&Ia(F)<=B){if(!au(R,h.length)||!au(F,u.length))return NaN;if(s&&p?_=Math.min(_,W_(h,R,u,F,v)):s||p?s&&!p?_=Math.min(_,Py(u,F,h,R,v)):!s&&p&&(_=Math.min(_,Py(h,R,u,F,v))):_=Math.min(_,fv(h,R,u,F,v)),_===0)return _}else{const M=lf(R,s),I=lf(F,p);cf(C,_,v,h,u,M[0],I[0]),cf(C,_,v,h,u,M[0],I[1]),cf(C,_,v,h,u,M[1],I[0]),cf(C,_,v,h,u,M[1],I[1])}}return _}function $m(h,s,u,p,v=1/0){let m=v;const _=Kd(h,[0,h.length-1]);for(const C of u)if(!(m!==1/0&&su(_,Kd(C,[0,C.length-1]),p)>=m)&&(m=Math.min(m,Ko(h,s,C,!0,p,m)),m===0))return m;return m}function Pp(h,s,u,p,v=1/0){let m=v;const _=Kd(h,[0,h.length-1]);for(const C of u){if(m!==1/0&&su(_,Yu(C),p)>=m)continue;const O=Cy(h,s,C,p,m);if(isNaN(O))return O;if((m=Math.min(m,O))===0)return m}return m}function ou(h){return h==="Point"||h==="MultiPoint"||h==="LineString"||h==="MultiLineString"||h==="Polygon"||h==="MultiPolygon"}class Ec{constructor(s,u){this.type=wr,this.geojson=s,this.geometries=u}static parse(s,u){if(s.length!==2)return u.error(`'distance' expression requires either one argument, but found ' ${s.length-1} instead.`);if(Rl(s[1])){const p=s[1];if(p.type==="FeatureCollection"){for(let v=0;v<p.features.length;++v)if(ou(p.features[v].geometry.type))return new Ec(p,p.features[v].geometry)}else if(p.type==="Feature"){if(ou(p.geometry.type))return new Ec(p,p.geometry)}else if(ou(p.type))return new Ec(p,p)}return u.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(s){const u=s.geometry(),p=s.canonicalID();if(u!=null&&p!=null){if(s.geometryType()==="Point")return function(v,m,_){const C=[];for(const B of v)for(const j of B)C.push(Vm(j,m));const O=new Zu(C[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?Ko(C,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",O):_.type==="MultiLineString"?$m(C,!1,_.coordinates,O):_.type==="Polygon"||_.type==="MultiPolygon"?Pp(C,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,O):null}(u,p,this.geometries);if(s.geometryType()==="LineString")return function(v,m,_){const C=[];for(const B of v){const j=[];for(const R of B)j.push(Vm(R,m));C.push(j)}const O=new Zu(C[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return $m(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",C,O);if(_.type==="MultiLineString"){let B=1/0;for(let j=0;j<_.coordinates.length;j++){const R=$m(_.coordinates[j],!0,C,O,B);if(isNaN(R))return R;if((B=Math.min(B,R))===0)return B}return B}if(_.type==="Polygon"||_.type==="MultiPolygon"){let B=1/0;for(let j=0;j<C.length;j++){const R=Pp(C[j],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,O,B);if(isNaN(R))return R;if((B=Math.min(B,R))===0)return B}return B}return null}(u,p,this.geometries);if(s.geometryType()==="Polygon")return function(v,m,_){const C=[];for(const B of function(j,R){const F=j.length;if(F<=1)return[j];const M=[];let I,q;for(let X=0;X<F;X++){const te=U_(j[X]);te!==0&&(j[X].area=Math.abs(te),q===void 0&&(q=te<0),q===te<0?(I&&M.push(I),I=[j[X]]):I.push(j[X]))}return I&&M.push(I),M}(v)){const j=[];for(let R=0;R<B.length;++R)j.push(dv(B[R],m));C.push(j)}const O=new Zu(C[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Pp(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",C,O);if(_.type==="MultiLineString"){let B=1/0;for(let j=0;j<_.coordinates.length;j++){const R=Pp(_.coordinates[j],!0,C,O,B);if(isNaN(R))return R;if((B=Math.min(B,R))===0)return B}return B}return _.type==="Polygon"||_.type==="MultiPolygon"?function(B,j,R){let F=1/0;for(const M of B)for(const I of j){const q=Um(M,I,R,F);if(isNaN(q))return q;if((F=Math.min(F,q))===0)return F}return F}(_.type==="Polygon"?[_.coordinates]:_.coordinates,C,O):null}(u,p,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Xu(h,s){switch(h){case"string":return Ca(s);case"number":return+s;case"boolean":return!!s;case"color":return Qn.parse(s);case"formatted":return Es.fromString(Ca(s));case"resolvedImage":return Ms.build(Ca(s))}return s}function Np(h,s,u,p){return p!==void 0&&(h=p*Math.round(h/p)),s!==void 0&&h<s&&(h=s),u!==void 0&&h>u&&(h=u),h}class Ju{constructor(s,u,p){this.type=s,this.key=u,this.scope=p}static parse(s,u){let p=u.expectedType;if(p==null&&(p=si),s.length<2||s.length>3)return u.error("Invalid number of arguments for 'config' expression.");const v=u.parse(s[1],1);if(!(v instanceof ka))return u.error("Key name of 'config' expression must be a string literal.");if(s.length>=3){const m=u.parse(s[2],2);return m instanceof ka?new Ju(p,Ca(v.value),Ca(m.value)):u.error("Scope of 'config' expression must be a string literal.")}return new Ju(p,Ca(v.value))}evaluate(s){const u=[this.key,this.scope,s.scope].filter(Boolean).join(""),p=s.getConfig(u);if(!p)return null;const{type:v,value:m,values:_,minValue:C,maxValue:O,stepValue:B}=p,j=p.default.evaluate(s);let R=j;if(m){const F=s.scope;s.scope=(F||"").split("").slice(1).join(""),R=m.evaluate(s),s.scope=F}return v&&(R=Xu(v,R)),R===void 0||C===void 0&&O===void 0&&B===void 0||(typeof R=="number"?R=Np(R,C,O,B):Array.isArray(R)&&(R=R.map(F=>typeof F=="number"?Np(F,C,O,B):F))),m!==void 0&&R!==void 0&&_&&!_.includes(R)&&(R=j,v&&(R=Xu(v,R))),(v&&v!==this.type||R!==void 0&&na(R)!==this.type)&&(R=Xu(this.type.kind,R)),R}eachChild(){}outputDefined(){return!1}serialize(){const s=["config",this.key];return this.scope&&s.concat(this.key),s}}function lu(h){if(h instanceof No&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Kr||h instanceof Ec)return!1;let s=!0;return h.eachChild(u=>{s&&!lu(u)&&(s=!1)}),s}function Mc(h){if(h instanceof No&&h.name==="feature-state")return!1;let s=!0;return h.eachChild(u=>{s&&!Mc(u)&&(s=!1)}),s}function Zd(h){if(h instanceof Ju)return new Set([h.key]);let s=new Set;return h.eachChild(u=>{s=new Set([...s,...Zd(u)])}),s}function Qu(h,s){if(h instanceof No&&s.indexOf(h.name)>=0)return!1;let u=!0;return h.eachChild(p=>{u&&!Qu(p,s)&&(u=!1)}),u}class Oc{constructor(s,u){this.type=u.type,this.name=s,this.boundExpression=u}static parse(s,u){if(s.length!==2||typeof s[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const p=s[1];return u.scope.has(p)?new Oc(p,u.scope.get(p)):u.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(s){return this.boundExpression.evaluate(s)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Yd{constructor(s,u=[],p,v=new Dm,m=[],_,C){this.registry=s,this.path=u,this.key=u.map(O=>typeof O=="string"?`['${O}']`:`[${O}]`).join(""),this.scope=v,this.errors=m,this.expectedType=p,this._scope=_,this.options=C}parse(s,u,p,v,m={}){return u||p?this.concat(u,null,p,v)._parse(s,m):this._parse(s,m)}parseObjectValue(s,u,p,v,m,_={}){return this.concat(u,p,v,m)._parse(s,_)}_parse(s,u){function p(v,m,_){return _==="assert"?new ic(m,[v]):_==="coerce"?new Cc(m,[v]):v}if(s!==null&&typeof s!="string"&&typeof s!="boolean"&&typeof s!="number"||(s=["literal",s]),Array.isArray(s)){if(s.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=typeof s[0]=="string"?this.registry[s[0]]:void 0;if(v){let m=v.parse(s,this);if(!m)return null;if(this.expectedType){const _=this.expectedType,C=m.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||C.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(_,C))return null}else m=p(m,_,u.typeAnnotation||"coerce");else m=p(m,_,u.typeAnnotation||"assert")}if(!(m instanceof ka)&&m.type.kind!=="resolvedImage"&&jp(m)){const _=new by(this._scope,this.options);try{m=new ka(m.type,m.evaluate(_))}catch(C){return this.error(C.message),null}}return m}return Cc.parse(["to-array",s],this)}return this.error(s===void 0?"'undefined' value invalid. Use null instead.":typeof s=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof s} instead.`)}concat(s,u,p,v){let m=typeof s=="number"?this.path.concat(s):this.path;m=typeof u=="string"?m.concat(u):m;const _=v?this.scope.concat(v):this.scope;return new Yd(this.registry,m,p||null,_,this.errors,this._scope,this.options)}error(s,...u){const p=`${this.key}${u.map(v=>`[${v}]`).join("")}`;this.errors.push(new fn(p,s))}checkSubtype(s,u){const p=Xs(s,u);return p&&this.error(p),p}}var uf=Yd;function jp(h){if(h instanceof Oc)return jp(h.boundExpression);if(h instanceof No&&h.name==="error"||h instanceof Lm||h instanceof Kr||h instanceof Ec||h instanceof Ju)return!1;const s=h instanceof Cc||h instanceof ic;let u=!0;return h.eachChild(p=>{u=s?u&&jp(p):u&&p instanceof ka}),!!u&&lu(h)&&Qu(h,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function df(h,s){const u=h.length-1;let p,v,m=0,_=u,C=0;for(;m<=_;)if(C=Math.floor((m+_)/2),p=h[C],v=h[C+1],p<=s){if(C===u||s<v)return C;m=C+1}else{if(!(p>s))throw new ma("Input is not a number.");_=C-1}return 0}class Xd{constructor(s,u,p){this.type=s,this.input=u,this.labels=[],this.outputs=[];for(const[v,m]of p)this.labels.push(v),this.outputs.push(m)}static parse(s,u){if(s.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if((s.length-1)%2!=0)return u.error("Expected an even number of arguments.");const p=u.parse(s[1],1,wr);if(!p)return null;const v=[];let m=null;u.expectedType&&u.expectedType.kind!=="value"&&(m=u.expectedType);for(let _=1;_<s.length;_+=2){const C=_===1?-1/0:s[_],O=s[_+1],B=_,j=_+1;if(typeof C!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(v.length&&v[v.length-1][0]>=C)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);const R=u.parse(O,j,m);if(!R)return null;m=m||R.type,v.push([C,R])}return new Xd(m,p,v)}evaluate(s){const u=this.labels,p=this.outputs;if(u.length===1)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=u[0])return p[0].evaluate(s);const m=u.length;return v>=u[m-1]?p[m-1].evaluate(s):p[df(u,v)].evaluate(s)}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){const s=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&s.push(this.labels[u]),s.push(this.outputs[u].serialize());return s}}const ed=.95047,Tn=1.08883,qm=4/29,td=6/29,pv=3*td*td,mv=td*td*td,Cp=Math.PI/180,Bi=180/Math.PI;function Gm(h){return h>mv?Math.pow(h,1/3):h/pv+qm}function Wm(h){return h>td?h*h*h:pv*(h-qm)}function ca(h){return 255*(h<=.0031308?12.92*h:1.055*Math.pow(h,1/2.4)-.055)}function kp(h){return(h/=255)<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function Ep(h){const s=kp(h.r),u=kp(h.g),p=kp(h.b),v=Gm((.4124564*s+.3575761*u+.1804375*p)/ed),m=Gm((.2126729*s+.7151522*u+.072175*p)/1);return{l:116*m-16,a:500*(v-m),b:200*(m-Gm((.0193339*s+.119192*u+.9503041*p)/Tn)),alpha:h.a}}function hf(h){let s=(h.l+16)/116,u=isNaN(h.a)?s:s+h.a/500,p=isNaN(h.b)?s:s-h.b/200;return s=1*Wm(s),u=ed*Wm(u),p=Tn*Wm(p),new Qn(ca(3.2404542*u-1.5371385*s-.4985314*p),ca(-.969266*u+1.8760108*s+.041556*p),ca(.0556434*u-.2040259*s+1.0572252*p),h.alpha)}function gv(h,s,u){const p=s-h;return h+u*(p>180||p<-180?p-360*Math.round(p/360):p)}const Jd={forward:Ep,reverse:hf,interpolate:function(h,s,u){return{l:Fr(h.l,s.l,u),a:Fr(h.a,s.a,u),b:Fr(h.b,s.b,u),alpha:Fr(h.alpha,s.alpha,u)}}},cu={forward:function(h){const{l:s,a:u,b:p}=Ep(h),v=Math.atan2(p,u)*Bi;return{h:v<0?v+360:v,c:Math.sqrt(u*u+p*p),l:s,alpha:h.a}},reverse:function(h){const s=h.h*Cp,u=h.c;return hf({l:h.l,a:Math.cos(s)*u,b:Math.sin(s)*u,alpha:h.alpha})},interpolate:function(h,s,u){return{h:gv(h.h,s.h,u),c:Fr(h.c,s.c,u),l:Fr(h.l,s.l,u),alpha:Fr(h.alpha,s.alpha,u)}}};var Mp=Object.freeze({__proto__:null,hcl:cu,lab:Jd});class Os{constructor(s,u,p,v,m,_){this.type=s,this.operator=u,this.interpolation=p,this.input=v,this.dynamicStops=m,this.labels=[],this.outputs=[];for(const[C,O]of _)this.labels.push(C),this.outputs.push(O)}static interpolationFactor(s,u,p,v){let m=0;if(s.name==="exponential")m=Hm(u,s.base,p,v);else if(s.name==="linear")m=Hm(u,1,p,v);else if(s.name==="cubic-bezier"){const _=s.controlPoints;m=new Dt(_[0],_[1],_[2],_[3]).solve(Hm(u,1,p,v))}return m}static parse(s,u){let[p,v,m,..._]=s;if(!Array.isArray(v)||v.length===0)return u.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const B=v[1];if(typeof B!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:B}}else{if(v[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const B=v.slice(1);if(B.length!==4||B.some(j=>typeof j!="number"||j<0||j>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:B}}}if(s.length-1<3)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length-1>3&&(s.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(m=u.parse(m,2,wr),!m)return null;const C=[];let O=null;if(p==="interpolate-hcl"||p==="interpolate-lab"?O=ys:u.expectedType&&u.expectedType.kind!=="value"&&(O=u.expectedType),s.length-1==3){const B=u.parse(_[0],3,si);return B?new Os(O,p,v,m,B,C):null}for(let B=0;B<_.length;B+=2){const j=_[B],R=_[B+1],F=B+3,M=B+4;if(typeof j!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(C.length&&C[C.length-1][0]>=j)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const I=u.parse(R,M,O);if(!I)return null;O=O||I.type,C.push([j,I])}return O.kind==="number"||O.kind==="color"||O.kind==="array"&&O.itemType.kind==="number"&&typeof O.N=="number"?new Os(O,p,v,m,null,C):u.error(`Type ${pa(O)} is not interpolatable.`)}evaluate(s){let u=this.labels,p=this.outputs;if(this.dynamicStops){const j=this.dynamicStops.evaluate(s);if(j.length%2!=0)throw new ma("Expected an even number of arguments.");u=[],p=[];for(let R=0;R<j.length;R+=2){const F=j[R],M=new ka(wr,j[R+1]);if(typeof F!="number")throw new ma('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(u.length&&u[u.length-1]>=F)throw new ma('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');u.push(F),p.push(M)}if(u.length===0)throw new ma("Expected at least one input/output pair.")}if(u.length===1)return p[0].evaluate(s);const v=this.input.evaluate(s);if(v<=u[0])return p[0].evaluate(s);const m=u.length;if(v>=u[m-1])return p[m-1].evaluate(s);const _=df(u,v),C=Os.interpolationFactor(this.interpolation,v,u[_],u[_+1]),O=p[_].evaluate(s),B=p[_+1].evaluate(s);return this.operator==="interpolate"?Gu[this.type.kind.toLowerCase()](O,B,C):this.operator==="interpolate-hcl"?cu.reverse(cu.interpolate(cu.forward(O),cu.forward(B),C)):Jd.reverse(Jd.interpolate(Jd.forward(O),Jd.forward(B),C))}eachChild(s){s(this.input);for(const u of this.outputs)s(u)}outputDefined(){return this.outputs.every(s=>s.outputDefined())}serialize(){let s;s=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,s,this.input.serialize()];if(this.dynamicStops)u.push(this.dynamicStops.serialize());else for(let p=0;p<this.labels.length;p++)u.push(this.labels[p],this.outputs[p].serialize());return u}}function Hm(h,s,u,p){const v=p-u,m=h-u;return v===0?0:s===1?m/v:(Math.pow(s,m)-1)/(Math.pow(s,v)-1)}class Km{constructor(s,u){this.type=s,this.args=u}static parse(s,u){if(s.length<2)return u.error("Expectected at least one argument.");let p=null;const v=u.expectedType;v&&v.kind!=="value"&&(p=v);const m=[];for(const C of s.slice(1)){const O=u.parse(C,1+m.length,p,void 0,{typeAnnotation:"omit"});if(!O)return null;p=p||O.type,m.push(O)}const _=v&&m.some(C=>Xs(v,C.type));return new Km(_?si:p,m)}evaluate(s){let u,p=null,v=0;for(const m of this.args){if(v++,p=m.evaluate(s),p&&p instanceof Ms&&!p.available&&(u||(u=p),p=null,v===this.args.length))return u;if(p!==null)break}return p}eachChild(s){this.args.forEach(s)}outputDefined(){return this.args.every(s=>s.outputDefined())}serialize(){const s=["coalesce"];return this.eachChild(u=>{s.push(u.serialize())}),s}}class Zm{constructor(s,u){this.type=u.type,this.bindings=[].concat(s),this.result=u}evaluate(s){return this.result.evaluate(s)}eachChild(s){for(const u of this.bindings)s(u[1]);s(this.result)}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found ${s.length-1} instead.`);const p=[];for(let m=1;m<s.length-1;m+=2){const _=s[m];if(typeof _!="string")return u.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return u.error("Variable names must contain only alphanumeric characters or '_'.",m);const C=u.parse(s[m+1],m+1);if(!C)return null;p.push([_,C])}const v=u.parse(s[s.length-1],s.length-1,u.expectedType,p);return v?new Zm(p,v):null}outputDefined(){return this.result.outputDefined()}serialize(){const s=["let"];for(const[u,p]of this.bindings)s.push(u,p.serialize());return s.push(this.result.serialize()),s}}class Ym{constructor(s,u,p){this.type=s,this.index=u,this.input=p}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,wr),v=u.parse(s[2],2,qa(u.expectedType||si));return p&&v?new Ym(v.type.itemType,p,v):null}evaluate(s){const u=this.index.evaluate(s),p=this.input.evaluate(s);if(u<0)throw new ma(`Array index out of bounds: ${u} < 0.`);if(u>p.length-1)throw new ma(`Array index out of bounds: ${u} > ${p.length-1}.`);if(u===Math.floor(u))return p[u];const v=Math.floor(u),m=Math.ceil(u),_=p[v],C=p[m];if(typeof _!="number"||typeof C!="number")throw new ma(`Cannot interpolate between non-number values at index ${u}.`);const O=u-v;return _*(1-O)+C*O}eachChild(s){s(this.index),s(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class ff{constructor(s,u){this.type=Hn,this.needle=s,this.haystack=u}static parse(s,u){if(s.length!==3)return u.error(`Expected 2 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,si),v=u.parse(s[2],2,si);return p&&v?$d(p.type,[Hn,yi,wr,Hu,si])?new ff(p,v):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${pa(p.type)} instead`):null}evaluate(s){const u=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(p==null)return!1;if(!qd(u,["boolean","string","number","null"]))throw new ma(`Expected first argument to be of type boolean, string, number or null, but found ${pa(na(u))} instead.`);if(!qd(p,["string","array"]))throw new ma(`Expected second argument to be of type array or string, but found ${pa(na(p))} instead.`);return p.indexOf(u)>=0}eachChild(s){s(this.needle),s(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Qd{constructor(s,u,p){this.type=wr,this.needle=s,this.haystack=u,this.fromIndex=p}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,si),v=u.parse(s[2],2,si);if(!p||!v)return null;if(!$d(p.type,[Hn,yi,wr,Hu,si]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${pa(p.type)} instead`);if(s.length===4){const m=u.parse(s[3],3,wr);return m?new Qd(p,v,m):null}return new Qd(p,v)}evaluate(s){const u=this.needle.evaluate(s),p=this.haystack.evaluate(s);if(!qd(u,["boolean","string","number","null"]))throw new ma(`Expected first argument to be of type boolean, string, number or null, but found ${pa(na(u))} instead.`);if(!qd(p,["string","array"]))throw new ma(`Expected second argument to be of type array or string, but found ${pa(na(p))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(s);return p.indexOf(u,v)}return p.indexOf(u)}eachChild(s){s(this.needle),s(this.haystack),this.fromIndex&&s(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const s=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),s]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Op{constructor(s,u,p,v,m,_){this.inputType=s,this.type=u,this.input=p,this.cases=v,this.outputs=m,this.otherwise=_}static parse(s,u){if(s.length<5)return u.error(`Expected at least 4 arguments, but found only ${s.length-1}.`);if(s.length%2!=1)return u.error("Expected an even number of arguments.");let p,v;u.expectedType&&u.expectedType.kind!=="value"&&(v=u.expectedType);const m={},_=[];for(let B=2;B<s.length-1;B+=2){let j=s[B];const R=s[B+1];Array.isArray(j)||(j=[j]);const F=u.concat(B);if(j.length===0)return F.error("Expected at least one branch label.");for(const I of j){if(typeof I!="number"&&typeof I!="string")return F.error("Branch labels must be numbers or strings.");if(typeof I=="number"&&Math.abs(I)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof I=="number"&&Math.floor(I)!==I)return F.error("Numeric branch labels must be integer values.");if(p){if(F.checkSubtype(p,na(I)))return null}else p=na(I);if(m[String(I)]!==void 0)return F.error("Branch labels must be unique.");m[String(I)]=_.length}const M=u.parse(R,B,v);if(!M)return null;v=v||M.type,_.push(M)}const C=u.parse(s[1],1,si);if(!C)return null;const O=u.parse(s[s.length-1],s.length-1,v);return O?C.type.kind!=="value"&&u.concat(1).checkSubtype(p,C.type)?null:new Op(p,v,C,m,_,O):null}evaluate(s){const u=this.input.evaluate(s);return(na(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(s)}eachChild(s){s(this.input),this.outputs.forEach(s),s(this.otherwise)}outputDefined(){return this.outputs.every(s=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),p=[],v={};for(const _ of u){const C=v[this.cases[_]];C===void 0?(v[this.cases[_]]=p.length,p.push([this.cases[_],[_]])):p[C][1].push(_)}const m=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,C]of p)s.push(C.length===1?m(C[0]):C.map(m)),s.push(this.outputs[_].serialize());return s.push(this.otherwise.serialize()),s}}class Rp{constructor(s,u,p){this.type=s,this.branches=u,this.otherwise=p}static parse(s,u){if(s.length<4)return u.error(`Expected at least 3 arguments, but found only ${s.length-1}.`);if(s.length%2!=0)return u.error("Expected an odd number of arguments.");let p;u.expectedType&&u.expectedType.kind!=="value"&&(p=u.expectedType);const v=[];for(let _=1;_<s.length-1;_+=2){const C=u.parse(s[_],_,Hn);if(!C)return null;const O=u.parse(s[_+1],_+1,p);if(!O)return null;v.push([C,O]),p=p||O.type}const m=u.parse(s[s.length-1],s.length-1,p);return m?new Rp(p,v,m):null}evaluate(s){for(const[u,p]of this.branches)if(u.evaluate(s))return p.evaluate(s);return this.otherwise.evaluate(s)}eachChild(s){for(const[u,p]of this.branches)s(u),s(p);s(this.otherwise)}outputDefined(){return this.branches.every(([s,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const s=["case"];return this.eachChild(u=>{s.push(u.serialize())}),s}}class pf{constructor(s,u,p,v){this.type=s,this.input=u,this.beginIndex=p,this.endIndex=v}static parse(s,u){if(s.length<=2||s.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${s.length-1} instead.`);const p=u.parse(s[1],1,si),v=u.parse(s[2],2,wr);if(!p||!v)return null;if(!$d(p.type,[qa(si),yi,si]))return u.error(`Expected first argument to be of type array or string, but found ${pa(p.type)} instead`);if(s.length===4){const m=u.parse(s[3],3,wr);return m?new pf(p.type,p,v,m):null}return new pf(p.type,p,v)}evaluate(s){const u=this.input.evaluate(s),p=this.beginIndex.evaluate(s);if(!qd(u,["string","array"]))throw new ma(`Expected first argument to be of type array or string, but found ${pa(na(u))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(s);return u.slice(p,v)}return u.slice(p)}eachChild(s){s(this.input),s(this.beginIndex),this.endIndex&&s(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const s=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),s]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Xm(h,s){return h==="=="||h==="!="?s.kind==="boolean"||s.kind==="string"||s.kind==="number"||s.kind==="null"||s.kind==="value":s.kind==="string"||s.kind==="number"||s.kind==="value"}function yv(h,s,u,p){return p.compare(s,u)===0}function eh(h,s,u){const p=h!=="=="&&h!=="!=";return class Nie{constructor(m,_,C){this.type=Hn,this.lhs=m,this.rhs=_,this.collator=C,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const C=m[0];let O=_.parse(m[1],1,si);if(!O)return null;if(!Xm(C,O.type))return _.concat(1).error(`"${C}" comparisons are not supported for type '${pa(O.type)}'.`);let B=_.parse(m[2],2,si);if(!B)return null;if(!Xm(C,B.type))return _.concat(2).error(`"${C}" comparisons are not supported for type '${pa(B.type)}'.`);if(O.type.kind!==B.type.kind&&O.type.kind!=="value"&&B.type.kind!=="value")return _.error(`Cannot compare types '${pa(O.type)}' and '${pa(B.type)}'.`);p&&(O.type.kind==="value"&&B.type.kind!=="value"?O=new ic(B.type,[O]):O.type.kind!=="value"&&B.type.kind==="value"&&(B=new ic(O.type,[B])));let j=null;if(m.length===4){if(O.type.kind!=="string"&&B.type.kind!=="string"&&O.type.kind!=="value"&&B.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(j=_.parse(m[3],3,ru),!j)return null}return new Nie(O,B,j)}evaluate(m){const _=this.lhs.evaluate(m),C=this.rhs.evaluate(m);if(p&&this.hasUntypedArgument){const O=na(_),B=na(C);if(O.kind!==B.kind||O.kind!=="string"&&O.kind!=="number")throw new ma(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${O.kind}, ${B.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const O=na(_),B=na(C);if(O.kind!=="string"||B.kind!=="string")return s(m,_,C)}return this.collator?u(m,_,C,this.collator.evaluate(m)):s(m,_,C)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[h];return this.eachChild(_=>{m.push(_.serialize())}),m}}}const H_=eh("==",function(h,s,u){return s===u},yv),K_=eh("!=",function(h,s,u){return s!==u},function(h,s,u,p){return!yv(0,s,u,p)}),ky=eh("<",function(h,s,u){return s<u},function(h,s,u,p){return p.compare(s,u)<0}),rd=eh(">",function(h,s,u){return s>u},function(h,s,u,p){return p.compare(s,u)>0}),vv=eh("<=",function(h,s,u){return s<=u},function(h,s,u,p){return p.compare(s,u)<=0}),mf=eh(">=",function(h,s,u){return s>=u},function(h,s,u,p){return p.compare(s,u)>=0});class Dl{constructor(s,u,p,v,m,_){this.type=yi,this.number=s,this.locale=u,this.currency=p,this.unit=v,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(s,u){if(s.length!==3)return u.error("Expected two arguments.");const p=u.parse(s[1],1,wr);if(!p)return null;const v=s[2];if(typeof v!="object"||Array.isArray(v))return u.error("NumberFormat options argument must be an object.");let m=null;if(v.locale&&(m=u.parseObjectValue(v.locale,2,"locale",yi),!m))return null;let _=null;if(v.currency&&(_=u.parseObjectValue(v.currency,2,"currency",yi),!_))return null;let C=null;if(v.unit&&(C=u.parseObjectValue(v.unit,2,"unit",yi),!C))return null;let O=null;if(v["min-fraction-digits"]&&(O=u.parseObjectValue(v["min-fraction-digits"],2,"min-fraction-digits",wr),!O))return null;let B=null;return v["max-fraction-digits"]&&(B=u.parseObjectValue(v["max-fraction-digits"],2,"max-fraction-digits",wr),!B)?null:new Dl(p,m,_,C,O,B)}evaluate(s){return new Intl.NumberFormat(this.locale?this.locale.evaluate(s):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(s):void 0,unit:this.unit?this.unit.evaluate(s):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(s):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(s):void 0}).format(this.number.evaluate(s))}eachChild(s){s(this.number),this.locale&&s(this.locale),this.currency&&s(this.currency),this.unit&&s(this.unit),this.minFractionDigits&&s(this.minFractionDigits),this.maxFractionDigits&&s(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const s={};return this.locale&&(s.locale=this.locale.serialize()),this.currency&&(s.currency=this.currency.serialize()),this.unit&&(s.unit=this.unit.serialize()),this.minFractionDigits&&(s["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(s["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),s]}}class th{constructor(s){this.type=wr,this.input=s}static parse(s,u){if(s.length!==2)return u.error(`Expected 1 argument, but found ${s.length-1} instead.`);const p=u.parse(s[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${pa(p.type)} instead.`):new th(p):null}evaluate(s){const u=this.input.evaluate(s);if(typeof u=="string"||Array.isArray(u))return u.length;throw new ma(`Expected value to be of type string or array, but found ${pa(na(u))} instead.`)}eachChild(s){s(this.input)}outputDefined(){return!1}serialize(){const s=["length"];return this.eachChild(u=>{s.push(u.serialize())}),s}}function Ll(h){return function(){h=1831565813+(h|=0)|0;let s=Math.imul(h^h>>>15,1|h);return s=s+Math.imul(s^s>>>7,61|s)^s,((s^s>>>14)>>>0)/4294967296}}const nd={"==":H_,"!=":K_,">":rd,"<":ky,">=":mf,"<=":vv,array:ic,at:Ym,boolean:ic,case:Rp,coalesce:Km,collator:Lm,format:iu,image:Gd,in:ff,"index-of":Qd,interpolate:Os,"interpolate-hcl":Os,"interpolate-lab":Os,length:th,let:Zm,literal:ka,match:Op,number:ic,"number-format":Dl,object:ic,slice:pf,step:Xd,string:ic,"to-boolean":Cc,"to-color":Cc,"to-number":Cc,"to-string":Cc,var:Oc,within:Kr,distance:Ec,config:Ju};function Ey(h,[s,u,p,v]){s=s.evaluate(h),u=u.evaluate(h),p=p.evaluate(h);const m=v?v.evaluate(h):1,_=rf(s,u,p,m);if(_)throw new ma(_);return new Qn(s/255*m,u/255*m,p/255*m,m)}function xv(h,[s,u,p,v]){s=s.evaluate(h),u=u.evaluate(h),p=p.evaluate(h);const m=v?v.evaluate(h):1,_=function(B,j,R,F){return typeof B=="number"&&B>=0&&B<=360?typeof j=="number"&&j>=0&&j<=100&&typeof R=="number"&&R>=0&&R<=100?F===void 0||typeof F=="number"&&F>=0&&F<=1?null:`Invalid hsla value [${[B,j,R,F].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof F=="number"?[B,j,R,F]:[B,j,R]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof F=="number"?[B,j,R,F]:[B,j,R]).join(", ")}]: 'h' must be between 0 and 360.`}(s,u,p,m);if(_)throw new ma(_);const C=`hsla(${s}, ${u}%, ${p}%, ${m})`,O=Qn.parse(C);if(!O)throw new ma(`Failed to parse HSLA color: ${C}`);return O}function id(h,s){return h in s}function rh(h,s){const u=s[h];return u===void 0?null:u}function yl(h){return{type:h}}function gf(h){return{result:"success",value:h}}function jo(h){return{result:"error",value:h}}function uu(h,s){return!!h&&!!h.parameters&&h.parameters.indexOf(s)>-1}function zl(h){return h["property-type"]==="data-driven"}function ga(h){return uu(h.expression,"measure-light")}function Qi(h){return uu(h.expression,"zoom")}function Fl(h){return!!h.expression&&h.expression.interpolated}function Us(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)}function Zo(h){return h}function du(h,s){const u=s.type==="color",p=h.stops&&typeof h.stops[0][0]=="object",v=p||!(p||h.property!==void 0),m=h.type||(Fl(s)?"exponential":"interval");if(u&&((h=Wu({},h)).stops&&(h.stops=h.stops.map(B=>[B[0],Qn.parse(B[1])])),h.default=Qn.parse(h.default?h.default:s.default)),h.colorSpace&&h.colorSpace!=="rgb"&&!Mp[h.colorSpace])throw new Error(`Unknown color space: ${h.colorSpace}`);let _,C,O;if(m==="exponential")_=My;else if(m==="interval")_=Jm;else if(m==="categorical"){_=Yo,C=Object.create(null);for(const B of h.stops)C[B[0]]=B[1];O=typeof h.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);_=Oy}if(p){const B={},j=[];for(let M=0;M<h.stops.length;M++){const I=h.stops[M],q=I[0].zoom;B[q]===void 0&&(B[q]={zoom:q,type:h.type,property:h.property,default:h.default,stops:[]},j.push(q)),B[q].stops.push([I[0].value,I[1]])}const R=[];for(const M of j)R.push([B[M].zoom,du(B[M],s)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:Os.interpolationFactor.bind(void 0,F),zoomStops:R.map(M=>M[0]),evaluate:({zoom:M},I)=>My({stops:R,base:h.base},s,M).evaluate(M,I)}}if(v){const B=m==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:B,interpolationFactor:Os.interpolationFactor.bind(void 0,B),zoomStops:h.stops.map(j=>j[0]),evaluate:({zoom:j})=>_(h,s,j,C,O)}}return{kind:"source",evaluate(B,j){const R=j&&j.properties?j.properties[h.property]:void 0;return R===void 0?sc(h.default,s.default):_(h,s,R,C,O)}}}function sc(h,s,u){return h!==void 0?h:s!==void 0?s:u!==void 0?u:void 0}function Yo(h,s,u,p,v){return sc(typeof u===v?p[u]:void 0,h.default,s.default)}function Jm(h,s,u){if(Po(u)!=="number")return sc(h.default,s.default);const p=h.stops.length;if(p===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[p-1][0])return h.stops[p-1][1];const v=df(h.stops.map(m=>m[0]),u);return h.stops[v][1]}function My(h,s,u){const p=h.base!==void 0?h.base:1;if(Po(u)!=="number")return sc(h.default,s.default);const v=h.stops.length;if(v===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[v-1][0])return h.stops[v-1][1];const m=df(h.stops.map(j=>j[0]),u),_=function(j,R,F,M){const I=M-F,q=j-F;return I===0?0:R===1?q/I:(Math.pow(R,q)-1)/(Math.pow(R,I)-1)}(u,p,h.stops[m][0],h.stops[m+1][0]),C=h.stops[m][1],O=h.stops[m+1][1];let B=Gu[s.type]||Zo;if(h.colorSpace&&h.colorSpace!=="rgb"){const j=Mp[h.colorSpace];B=(R,F)=>j.reverse(j.interpolate(j.forward(R),j.forward(F),_))}return typeof C.evaluate=="function"?{evaluate(...j){const R=C.evaluate.apply(void 0,j),F=O.evaluate.apply(void 0,j);if(R!==void 0&&F!==void 0)return B(R,F,_)}}:B(C,O,_)}function Oy(h,s,u){return s.type==="color"?u=Qn.parse(u):s.type==="formatted"?u=Es.fromString(u.toString()):s.type==="resolvedImage"?u=Ms.build(u.toString()):Po(u)===s.type||s.type==="enum"&&s.values[u]||(u=void 0),sc(u,h.default,s.default)}No.register(nd,{error:[{kind:"error"},[yi],(h,[s])=>{throw new ma(s.evaluate(h))}],typeof:[yi,[si],(h,[s])=>pa(na(s.evaluate(h)))],"to-rgba":[qa(wr,4),[ys],(h,[s])=>s.evaluate(h).toRenderColor(null).toArray()],"to-hsla":[qa(wr,4),[ys],(h,[s])=>s.evaluate(h).toRenderColor(null).toHslaArray()],rgb:[ys,[wr,wr,wr],Ey],rgba:[ys,[wr,wr,wr,wr],Ey],hsl:[ys,[wr,wr,wr],xv],hsla:[ys,[wr,wr,wr,wr],xv],has:{type:Hn,overloads:[[[yi],(h,[s])=>id(s.evaluate(h),h.properties())],[[yi,Nc],(h,[s,u])=>id(s.evaluate(h),u.evaluate(h))]]},get:{type:si,overloads:[[[yi],(h,[s])=>rh(s.evaluate(h),h.properties())],[[yi,Nc],(h,[s,u])=>rh(s.evaluate(h),u.evaluate(h))]]},"feature-state":[si,[yi],(h,[s])=>rh(s.evaluate(h),h.featureState||{})],properties:[Nc,[],h=>h.properties()],"geometry-type":[yi,[],h=>h.geometryType()],id:[si,[],h=>h.id()],zoom:[wr,[],h=>h.globals.zoom],pitch:[wr,[],h=>h.globals.pitch||0],"distance-from-center":[wr,[],h=>h.distanceFromCenter()],"measure-light":[wr,[yi],(h,[s])=>h.measureLight(s.evaluate(h))],"heatmap-density":[wr,[],h=>h.globals.heatmapDensity||0],"line-progress":[wr,[],h=>h.globals.lineProgress||0],"raster-value":[wr,[],h=>h.globals.rasterValue||0],"raster-particle-speed":[wr,[],h=>h.globals.rasterParticleSpeed||0],"sky-radial-progress":[wr,[],h=>h.globals.skyRadialProgress||0],accumulated:[si,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[wr,yl(wr),(h,s)=>{let u=0;for(const p of s)u+=p.evaluate(h);return u}],"*":[wr,yl(wr),(h,s)=>{let u=1;for(const p of s)u*=p.evaluate(h);return u}],"-":{type:wr,overloads:[[[wr,wr],(h,[s,u])=>s.evaluate(h)-u.evaluate(h)],[[wr],(h,[s])=>-s.evaluate(h)]]},"/":[wr,[wr,wr],(h,[s,u])=>s.evaluate(h)/u.evaluate(h)],"%":[wr,[wr,wr],(h,[s,u])=>s.evaluate(h)%u.evaluate(h)],ln2:[wr,[],()=>Math.LN2],pi:[wr,[],()=>Math.PI],e:[wr,[],()=>Math.E],"^":[wr,[wr,wr],(h,[s,u])=>Math.pow(s.evaluate(h),u.evaluate(h))],sqrt:[wr,[wr],(h,[s])=>Math.sqrt(s.evaluate(h))],log10:[wr,[wr],(h,[s])=>Math.log(s.evaluate(h))/Math.LN10],ln:[wr,[wr],(h,[s])=>Math.log(s.evaluate(h))],log2:[wr,[wr],(h,[s])=>Math.log(s.evaluate(h))/Math.LN2],sin:[wr,[wr],(h,[s])=>Math.sin(s.evaluate(h))],cos:[wr,[wr],(h,[s])=>Math.cos(s.evaluate(h))],tan:[wr,[wr],(h,[s])=>Math.tan(s.evaluate(h))],asin:[wr,[wr],(h,[s])=>Math.asin(s.evaluate(h))],acos:[wr,[wr],(h,[s])=>Math.acos(s.evaluate(h))],atan:[wr,[wr],(h,[s])=>Math.atan(s.evaluate(h))],min:[wr,yl(wr),(h,s)=>Math.min(...s.map(u=>u.evaluate(h)))],max:[wr,yl(wr),(h,s)=>Math.max(...s.map(u=>u.evaluate(h)))],abs:[wr,[wr],(h,[s])=>Math.abs(s.evaluate(h))],round:[wr,[wr],(h,[s])=>{const u=s.evaluate(h);return u<0?-Math.round(-u):Math.round(u)}],floor:[wr,[wr],(h,[s])=>Math.floor(s.evaluate(h))],ceil:[wr,[wr],(h,[s])=>Math.ceil(s.evaluate(h))],"filter-==":[Hn,[yi,si],(h,[s,u])=>h.properties()[s.value]===u.value],"filter-id-==":[Hn,[si],(h,[s])=>h.id()===s.value],"filter-type-==":[Hn,[yi],(h,[s])=>h.geometryType()===s.value],"filter-<":[Hn,[yi,si],(h,[s,u])=>{const p=h.properties()[s.value],v=u.value;return typeof p==typeof v&&p<v}],"filter-id-<":[Hn,[si],(h,[s])=>{const u=h.id(),p=s.value;return typeof u==typeof p&&u<p}],"filter->":[Hn,[yi,si],(h,[s,u])=>{const p=h.properties()[s.value],v=u.value;return typeof p==typeof v&&p>v}],"filter-id->":[Hn,[si],(h,[s])=>{const u=h.id(),p=s.value;return typeof u==typeof p&&u>p}],"filter-<=":[Hn,[yi,si],(h,[s,u])=>{const p=h.properties()[s.value],v=u.value;return typeof p==typeof v&&p<=v}],"filter-id-<=":[Hn,[si],(h,[s])=>{const u=h.id(),p=s.value;return typeof u==typeof p&&u<=p}],"filter->=":[Hn,[yi,si],(h,[s,u])=>{const p=h.properties()[s.value],v=u.value;return typeof p==typeof v&&p>=v}],"filter-id->=":[Hn,[si],(h,[s])=>{const u=h.id(),p=s.value;return typeof u==typeof p&&u>=p}],"filter-has":[Hn,[si],(h,[s])=>s.value in h.properties()],"filter-has-id":[Hn,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[Hn,[qa(yi)],(h,[s])=>s.value.indexOf(h.geometryType())>=0],"filter-id-in":[Hn,[qa(si)],(h,[s])=>s.value.indexOf(h.id())>=0],"filter-in-small":[Hn,[yi,qa(si)],(h,[s,u])=>u.value.indexOf(h.properties()[s.value])>=0],"filter-in-large":[Hn,[yi,qa(si)],(h,[s,u])=>function(p,v,m,_){for(;m<=_;){const C=m+_>>1;if(v[C]===p)return!0;v[C]>p?_=C-1:m=C+1}return!1}(h.properties()[s.value],u.value,0,u.value.length-1)],all:{type:Hn,overloads:[[[Hn,Hn],(h,[s,u])=>s.evaluate(h)&&u.evaluate(h)],[yl(Hn),(h,s)=>{for(const u of s)if(!u.evaluate(h))return!1;return!0}]]},any:{type:Hn,overloads:[[[Hn,Hn],(h,[s,u])=>s.evaluate(h)||u.evaluate(h)],[yl(Hn),(h,s)=>{for(const u of s)if(u.evaluate(h))return!0;return!1}]]},"!":[Hn,[Hn],(h,[s])=>!s.evaluate(h)],"is-supported-script":[Hn,[yi],(h,[s])=>{const u=h.globals&&h.globals.isSupportedScript;return!u||u(s.evaluate(h))}],upcase:[yi,[yi],(h,[s])=>s.evaluate(h).toUpperCase()],downcase:[yi,[yi],(h,[s])=>s.evaluate(h).toLowerCase()],concat:[yi,yl(si),(h,s)=>s.map(u=>Ca(u.evaluate(h))).join("")],"resolved-locale":[yi,[ru],(h,[s])=>s.evaluate(h).resolvedLocale()],random:[wr,[wr,wr,si],(h,s)=>{const[u,p,v]=s.map(_=>_.evaluate(h));if(u>p||u===p)return u;let m;if(typeof v=="string")m=function(_){let C=0;if(_.length===0)return C;for(let O=0;O<_.length;O++)C=(C<<5)-C+_.charCodeAt(O),C|=0;return C}(v);else{if(typeof v!="number")throw new ma(`Invalid seed input: ${v}`);m=v}return u+Ll(m)()*(p-u)}]});class nh{constructor(s,u,p,v){this.expression=s,this._warningHistory={},this._evaluator=new by(p,v),this._defaultValue=u?function(m){return m.type==="color"&&(Us(m.default)||Array.isArray(m.default))?new Qn(0,0,0,0):m.type==="color"?Qn.parse(m.default)||null:m.default===void 0?null:m.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null,this.configDependencies=Zd(s)}evaluateWithoutErrorHandling(s,u,p,v,m,_,C,O){return this._evaluator.globals=s,this._evaluator.feature=u,this._evaluator.featureState=p,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=O||null,this.expression.evaluate(this._evaluator)}evaluate(s,u,p,v,m,_,C,O){this._evaluator.globals=s,this._evaluator.feature=u||null,this._evaluator.featureState=p||null,this._evaluator.canonical=v||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=O||null;try{const B=this.expression.evaluate(this._evaluator);if(B==null||typeof B=="number"&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new ma(`Expected value to be one of ${Object.keys(this._enumValues).map(j=>JSON.stringify(j)).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${B.message}`)),this._defaultValue}}}function ih(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in nd}function Xo(h,s,u,p){const v=new uf(nd,[],s?function(_){const C={color:ys,string:yi,number:wr,enum:yi,boolean:Hn,formatted:Ho,resolvedImage:jc};return _.type==="array"?qa(C[_.value]||si,_.length):C[_.type]}(s):void 0,void 0,void 0,u,p),m=v.parse(h,void 0,void 0,void 0,s&&s.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?gf(new nh(m,s,u,p)):jo(v.errors)}class ah{constructor(s,u,p,v){this.kind=s,this._styleExpression=u,this.isLightConstant=p,this.isLineProgressConstant=v,this.isStateDependent=s!=="constant"&&!Mc(u.expression),this.configDependencies=Zd(u.expression)}evaluateWithoutErrorHandling(s,u,p,v,m,_){return this._styleExpression.evaluateWithoutErrorHandling(s,u,p,v,m,_)}evaluate(s,u,p,v,m,_){return this._styleExpression.evaluate(s,u,p,v,m,_)}}class sh{constructor(s,u,p,v,m,_){this.kind=s,this.zoomStops=p,this._styleExpression=u,this.isStateDependent=s!=="camera"&&!Mc(u.expression),this.isLightConstant=m,this.isLineProgressConstant=_,this.configDependencies=Zd(u.expression),this.interpolationType=v}evaluateWithoutErrorHandling(s,u,p,v,m,_){return this._styleExpression.evaluateWithoutErrorHandling(s,u,p,v,m,_)}evaluate(s,u,p,v,m,_){return this._styleExpression.evaluate(s,u,p,v,m,_)}interpolationFactor(s,u,p){return this.interpolationType?Os.interpolationFactor(this.interpolationType,s,u,p):0}}function Ry(h,s,u,p){if((h=Xo(h,s,u,p)).result==="error")return h;const v=h.value.expression,m=lu(v);if(!m&&!zl(s))return jo([new fn("","data expressions not supported")]);const _=Qu(v,["zoom","pitch","distance-from-center"]);if(!_&&!Qi(s))return jo([new fn("","zoom expressions not supported")]);const C=Qu(v,["measure-light"]);if(!C&&!ga(s))return jo([new fn("","measure-light expression not supported")]);const O=Qu(v,["line-progress"]);if(!O&&!function(R){return uu(R.expression,"line-progress")}(s))return jo([new fn("","line-progress expression not supported")]);const B=s.expression&&s.expression.relaxZoomRestriction,j=Bl(v);return j||_||B?j instanceof fn?jo([j]):j instanceof Os&&!Fl(s)?jo([new fn("",'"interpolate" expressions cannot be used with this property')]):gf(j?new sh(m&&O?"camera":"composite",h.value,j.labels,j instanceof Os?j.interpolation:void 0,C,O):new ah(m&&O?"constant":"source",h.value,C,O)):jo([new fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Ip{constructor(s,u){this._parameters=s,this._specification=u,Wu(this,du(this._parameters,this._specification))}static deserialize(s){return new Ip(s._parameters,s._specification)}static serialize(s){return{_parameters:s._parameters,_specification:s._specification}}}function Bl(h){let s=null;if(h instanceof Zm)s=Bl(h.result);else if(h instanceof Km){for(const u of h.args)if(s=Bl(u),s)break}else(h instanceof Xd||h instanceof Os)&&h.input instanceof No&&h.input.name==="zoom"&&(s=h);return s instanceof fn||h.eachChild(u=>{const p=Bl(u);p instanceof fn?s=p:s&&p&&s!==p&&(s=new fn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),s}var ad,oh,Qm=function(){if(oh)return ad;oh=1,ad=s;var h=3;function s(u,p,v){var m=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;var _=new Int32Array(this.arrayBuffer);u=_[0],this.d=(p=_[1])+2*(v=_[2]);for(var C=0;C<this.d*this.d;C++){var O=_[h+C],B=_[h+C+1];m.push(O===B?null:_.subarray(O,B))}var j=_[h+m.length+1];this.keys=_.subarray(_[h+m.length],j),this.bboxes=_.subarray(j),this.insert=this._insertReadonly}else{this.d=p+2*v;for(var R=0;R<this.d*this.d;R++)m.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=v,this.scale=p/u,this.uid=0;var F=v/p*u;this.min=-F,this.max=u+F}return s.prototype.insert=function(u,p,v,m,_){this._forEachCell(p,v,m,_,this._insertCell,this.uid++),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(m),this.bboxes.push(_)},s.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},s.prototype._insertCell=function(u,p,v,m,_,C){this.cells[_].push(C)},s.prototype.query=function(u,p,v,m,_){var C=this.min,O=this.max;if(u<=C&&p<=C&&O<=v&&O<=m&&!_)return Array.prototype.slice.call(this.keys);var B=[];return this._forEachCell(u,p,v,m,this._queryCell,B,{},_),B},s.prototype._queryCell=function(u,p,v,m,_,C,O,B){var j=this.cells[_];if(j!==null)for(var R=this.keys,F=this.bboxes,M=0;M<j.length;M++){var I=j[M];if(O[I]===void 0){var q=4*I;(B?B(F[q+0],F[q+1],F[q+2],F[q+3]):u<=F[q+2]&&p<=F[q+3]&&v>=F[q+0]&&m>=F[q+1])?(O[I]=!0,C.push(R[I])):O[I]=!1}}},s.prototype._forEachCell=function(u,p,v,m,_,C,O,B){for(var j=this._convertToCellCoord(u),R=this._convertToCellCoord(p),F=this._convertToCellCoord(v),M=this._convertToCellCoord(m),I=j;I<=F;I++)for(var q=R;q<=M;q++){var X=this.d*q+I;if((!B||B(this._convertFromCellCoord(I),this._convertFromCellCoord(q),this._convertFromCellCoord(I+1),this._convertFromCellCoord(q+1)))&&_.call(this,u,p,v,m,X,C,O,B))return}},s.prototype._convertFromCellCoord=function(u){return(u-this.padding)/this.scale},s.prototype._convertToCellCoord=function(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))},s.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var u=this.cells,p=h+this.cells.length+1+1,v=0,m=0;m<this.cells.length;m++)v+=this.cells[m].length;var _=new Int32Array(p+v+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var C=p,O=0;O<u.length;O++){var B=u[O];_[h+O]=C,_.set(B,C),C+=B.length}return _[h+u.length]=C,_.set(this.keys,C),_[h+u.length+1]=C+=this.keys.length,_.set(this.bboxes,C),C+=this.bboxes.length,_.buffer},ad}(),Rc=x(Qm);const Co={};function gr(h,s,u={}){Object.defineProperty(h,"_classRegistryKey",{value:s,writable:!1}),Co[s]={klass:h,omit:u.omit||[]}}gr(Object,"Object"),Rc.serialize=function(h,s){const u=h.toArrayBuffer();return s&&s.add(u),{buffer:u}},Rc.deserialize=function(h){return new Rc(h.buffer)},Object.defineProperty(Rc,"name",{value:"Grid"}),gr(Rc,"Grid"),typeof DOMMatrix<"u"&&gr(DOMMatrix,"DOMMatrix"),gr(Qn,"Color"),gr(Error,"Error"),gr(Es,"Formatted"),gr(Ol,"FormattedSection"),gr(ja,"AJAXError"),gr(Ms,"ResolvedImage"),gr(Ip,"StylePropertyFunction"),gr(nh,"StyleExpression",{omit:["_evaluator"]}),gr(gl,"ImageIdWithOptions"),gr(sh,"ZoomDependentExpression"),gr(ah,"ZoomConstantExpression"),gr(No,"CompoundExpression",{omit:["_evaluate"]});for(const h in nd)Co[nd[h]._classRegistryKey]||gr(nd[h],`Expression${h}`);function hu(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function oc(h){return self.ImageBitmap&&h instanceof ImageBitmap}function fo(h,s){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp)return h;if(hu(h)||oc(h))return s&&s.add(h),h;if(ArrayBuffer.isView(h))return s&&s.add(h.buffer),h;if(h instanceof ImageData)return s&&s.add(h.data.buffer),h;if(Array.isArray(h)){const u=[];for(const p of h)u.push(fo(p,s));return u}if(h instanceof Map){const u={$name:"Map"};for(const[p,v]of h.entries())u[p]=fo(v);return u}if(h instanceof Set){const u={$name:"Set"};let p=0;for(const v of h.values())u[++p]=fo(v);return u}if(typeof h=="object"){const u=h.constructor,p=u._classRegistryKey;if(!p)throw new Error(`Can't serialize object of unregistered class "${p}".`);const v=u.serialize?u.serialize(h,s):{};if(!u.serialize){for(const m in h)h.hasOwnProperty(m)&&(Co[p].omit.indexOf(m)>=0||(v[m]=fo(h[m],s)));h instanceof Error&&(v.message=h.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(v.$name=p),v}throw new Error("can't serialize object of type "+typeof h)}function vl(h){if(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||hu(h)||oc(h)||ArrayBuffer.isView(h)||h instanceof ImageData)return h;if(Array.isArray(h))return h.map(vl);if(typeof h=="object"){const s=h.$name||"Object";if(s==="Map"){const v=new Map;for(const m of Object.keys(h))m!=="$name"&&v.set(m,vl(h[m]));return v}if(s==="Set"){const v=new Set;for(const m of Object.keys(h))m!=="$name"&&v.add(vl(h[m]));return v}const{klass:u}=Co[s];if(!u)throw new Error(`Can't deserialize unregistered class "${s}".`);if(u.deserialize)return u.deserialize(h);const p=Object.create(u.prototype);for(const v of Object.keys(h))v!=="$name"&&(p[v]=vl(h[v]));return p}throw new Error("can't deserialize object of type "+typeof h)}const Er={"Latin-1 Supplement":h=>h>=128&&h<=255,Arabic:h=>h>=1536&&h<=1791,"Arabic Supplement":h=>h>=1872&&h<=1919,"Arabic Extended-A":h=>h>=2208&&h<=2303,"Hangul Jamo":h=>h>=4352&&h<=4607,"Unified Canadian Aboriginal Syllabics":h=>h>=5120&&h<=5759,Khmer:h=>h>=6016&&h<=6143,"Unified Canadian Aboriginal Syllabics Extended":h=>h>=6320&&h<=6399,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"CJK Radicals Supplement":h=>h>=11904&&h<=12031,"Kangxi Radicals":h=>h>=12032&&h<=12255,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Bopomofo:h=>h>=12544&&h<=12591,"Hangul Compatibility Jamo":h=>h>=12592&&h<=12687,Kanbun:h=>h>=12688&&h<=12703,"Bopomofo Extended":h=>h>=12704&&h<=12735,"CJK Strokes":h=>h>=12736&&h<=12783,"Katakana Phonetic Extensions":h=>h>=12784&&h<=12799,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"CJK Unified Ideographs Extension A":h=>h>=13312&&h<=19903,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Yi Syllables":h=>h>=40960&&h<=42127,"Yi Radicals":h=>h>=42128&&h<=42191,"Hangul Jamo Extended-A":h=>h>=43360&&h<=43391,"Hangul Syllables":h=>h>=44032&&h<=55215,"Hangul Jamo Extended-B":h=>h>=55216&&h<=55295,"Private Use Area":h=>h>=57344&&h<=63743,"CJK Compatibility Ideographs":h=>h>=63744&&h<=64255,"Arabic Presentation Forms-A":h=>h>=64336&&h<=65023,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Arabic Presentation Forms-B":h=>h>=65136&&h<=65279,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519,Osage:h=>h>=66736&&h<=66815,"CJK Unified Ideographs Extension B":h=>h>=131072&&h<=173791};function Dp(h){for(const s of h)if(po(s.charCodeAt(0)))return!0;return!1}function Iy(h){for(const s of h)if(!xl(s.charCodeAt(0)))return!1;return!0}function xl(h){return!(Er.Arabic(h)||Er["Arabic Supplement"](h)||Er["Arabic Extended-A"](h)||Er["Arabic Presentation Forms-A"](h)||Er["Arabic Presentation Forms-B"](h))}function po(h){return!(h!==746&&h!==747&&(h<4352||!(Er["Bopomofo Extended"](h)||Er.Bopomofo(h)||Er["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||Er["CJK Compatibility Ideographs"](h)||Er["CJK Compatibility"](h)||Er["CJK Radicals Supplement"](h)||Er["CJK Strokes"](h)||!(!Er["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||Er["CJK Unified Ideographs Extension A"](h)||Er["CJK Unified Ideographs"](h)||Er["Enclosed CJK Letters and Months"](h)||Er["Hangul Compatibility Jamo"](h)||Er["Hangul Jamo Extended-A"](h)||Er["Hangul Jamo Extended-B"](h)||Er["Hangul Jamo"](h)||Er["Hangul Syllables"](h)||Er.Hiragana(h)||Er["Ideographic Description Characters"](h)||Er.Kanbun(h)||Er["Kangxi Radicals"](h)||Er["Katakana Phonetic Extensions"](h)||Er.Katakana(h)&&h!==12540||!(!Er["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!Er["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||Er["Unified Canadian Aboriginal Syllabics"](h)||Er["Unified Canadian Aboriginal Syllabics Extended"](h)||Er["Vertical Forms"](h)||Er["Yijing Hexagram Symbols"](h)||Er["Yi Syllables"](h)||Er["Yi Radicals"](h))))}function ya(h){return!(po(h)||function(s){return!!(Er["Latin-1 Supplement"](s)&&(s===167||s===169||s===174||s===177||s===188||s===189||s===190||s===215||s===247)||Er["General Punctuation"](s)&&(s===8214||s===8224||s===8225||s===8240||s===8241||s===8251||s===8252||s===8258||s===8263||s===8264||s===8265||s===8273)||Er["Letterlike Symbols"](s)||Er["Number Forms"](s)||Er["Miscellaneous Technical"](s)&&(s>=8960&&s<=8967||s>=8972&&s<=8991||s>=8996&&s<=9e3||s===9003||s>=9085&&s<=9114||s>=9150&&s<=9165||s===9167||s>=9169&&s<=9179||s>=9186&&s<=9215)||Er["Control Pictures"](s)&&s!==9251||Er["Optical Character Recognition"](s)||Er["Enclosed Alphanumerics"](s)||Er["Geometric Shapes"](s)||Er["Miscellaneous Symbols"](s)&&!(s>=9754&&s<=9759)||Er["Miscellaneous Symbols and Arrows"](s)&&(s>=11026&&s<=11055||s>=11088&&s<=11097||s>=11192&&s<=11243)||Er["CJK Symbols and Punctuation"](s)||Er.Katakana(s)||Er["Private Use Area"](s)||Er["CJK Compatibility Forms"](s)||Er["Small Form Variants"](s)||Er["Halfwidth and Fullwidth Forms"](s)||s===8734||s===8756||s===8757||s>=9984&&s<=10087||s>=10102&&s<=10131||s===65532||s===65533)}(h))}function _l(h){return h>=1424&&h<=2303||Er["Arabic Presentation Forms-A"](h)||Er["Arabic Presentation Forms-B"](h)}function Dy(h,s){return!(!s&&_l(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||Er.Khmer(h))}function eg(h){for(const s of h)if(_l(s.charCodeAt(0)))return!0;return!1}const lh="deferred",yf="loading",tg="loaded";let bl=null,ko="unavailable",wl=null;const Lp=function(h){h&&typeof h=="string"&&h.indexOf("NetworkError")>-1&&(ko="error"),bl&&bl(h)};function Ly(){Ic.fire(new _i("pluginStateChange",{pluginStatus:ko,pluginURL:wl}))}const Ic=new eu,ch=function(){return ko},vf=function(){if(ko!==lh||!wl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ko=yf,Ly(),wl&&rs({url:wl},h=>{h?Lp(h):(ko=tg,Ly())})},Jo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ko===tg||Jo.applyArabicShaping!=null,isLoading:()=>ko===yf,setState(h){ko=h.pluginStatus,wl=h.pluginURL},isParsed:()=>Jo.applyArabicShaping!=null&&Jo.processBidirectionalText!=null&&Jo.processStyledBidirectionalText!=null,getPluginURL:()=>wl};class bi{constructor(s,u){this.zoom=s,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch,this.brightness=u.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(s){return function(u,p){for(const v of u)if(!Dy(v.charCodeAt(0),p))return!1;return!0}(s,Jo.isLoaded())}}class zp{constructor(s,u,p,v){this.property=s,this.value=u,this.expression=function(m,_,C,O){if(Us(m))return new Ip(m,_);if(ih(m)||Array.isArray(m)&&m.length>0){const B=Ry(m,_,C,O);if(B.result==="error")throw new Error(B.value.map(j=>`${j.key}: ${j.message}`).join(", "));return B.value}{let B=m;return typeof m=="string"&&_.type==="color"&&(B=Qn.parse(m)),{kind:"constant",configDependencies:new Set,evaluate:()=>B}}}(u===void 0?s.specification.default:u,s.specification,p,v)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(s,u,p){return this.property.possiblyEvaluate(this,s,u,p)}}class sd{constructor(s,u,p){this.property=s,this.value=new zp(s,void 0,u,p)}transitioned(s,u){return new od(this.property,this.value,u,Ui({},s.transition,this.transition),s.now)}untransitioned(){return new od(this.property,this.value,null,{},0)}}class uh{constructor(s,u,p){this._properties=s,this._values=Object.create(s.defaultTransitionablePropertyValues),this._scope=u,this._options=p,this.configDependencies=new Set}getValue(s){return Fs(this._values[s].value.value)}setValue(s,u){this._values.hasOwnProperty(s)||(this._values[s]=new sd(this._values[s].property,this._scope,this._options)),this._values[s].value=new zp(this._values[s].property,u===null?void 0:Fs(u),this._scope,this._options),this._values[s].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].value.expression.configDependencies]))}setTransitionOrValue(s,u){u&&(this._options=u);const p=this._properties.properties;if(s)for(const v in s){const m=s[v];if(es(v,"-transition")){const _=v.slice(0,-11);p[_]&&this.setTransition(_,m)}else p.hasOwnProperty(v)&&this.setValue(v,m)}}getTransition(s){return Fs(this._values[s].transition)}setTransition(s,u){this._values.hasOwnProperty(s)||(this._values[s]=new sd(this._values[s].property)),this._values[s].transition=Fs(u)||void 0}serialize(){const s={};for(const u of Object.keys(this._values)){const p=this.getValue(u);p!==void 0&&(s[u]=p);const v=this.getTransition(u);v!==void 0&&(s[`${u}-transition`]=v)}return s}transitioned(s,u){const p=new dh(this._properties);for(const v of Object.keys(this._values))p._values[v]=this._values[v].transitioned(s,u._values[v]);return p}untransitioned(){const s=new dh(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].untransitioned();return s}}class od{constructor(s,u,p,v,m){const _=v.delay||0,C=v.duration||0;m=m||0,this.property=s,this.value=u,this.begin=m+_,this.end=this.begin+C,s.specification.transition&&(v.delay||v.duration)&&(this.prior=p)}possiblyEvaluate(s,u,p){const v=s.now||0,m=this.value.possiblyEvaluate(s,u,p),_=this.prior;if(_){if(v>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(v<this.begin)return _.possiblyEvaluate(s,u,p);{const C=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(s,u,p),m,lr(C))}}return m}}class dh{constructor(s){this._properties=s,this._values=Object.create(s.defaultTransitioningPropertyValues)}possiblyEvaluate(s,u,p){const v=new ud(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(s,u,p);return v}hasTransition(){for(const s of Object.keys(this._values))if(this._values[s].prior)return!0;return!1}}class ld{constructor(s,u,p){this._properties=s,this._values=Object.create(s.defaultPropertyValues),this._scope=u,this._options=p,this.configDependencies=new Set}getValue(s){return Fs(this._values[s].value)}setValue(s,u){this._values[s]=new zp(this._values[s].property,u===null?void 0:Fs(u),this._scope,this._options),this._values[s].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[s].expression.configDependencies]))}serialize(){const s={};for(const u of Object.keys(this._values)){const p=this.getValue(u);p!==void 0&&(s[u]=p)}return s}possiblyEvaluate(s,u,p){const v=new ud(this._properties);for(const m of Object.keys(this._values))v._values[m]=this._values[m].possiblyEvaluate(s,u,p);return v}}class cd{constructor(s,u,p){this.property=s,this.value=u,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(s){return this.value.kind==="constant"?this.value.value:s}evaluate(s,u,p,v){return this.property.evaluate(this.value,this.parameters,s,u,p,v)}}class ud{constructor(s){this._properties=s,this._values=Object.create(s.defaultPossiblyEvaluatedValues)}get(s){return this._values[s]}}class er{constructor(s){this.specification=s}possiblyEvaluate(s,u){return s.expression.evaluate(u)}interpolate(s,u,p){const v=Gu[this.specification.type];return v?v(s,u,p):s}}class fr{constructor(s,u){this.specification=s,this.overrides=u}possiblyEvaluate(s,u,p,v){return new cd(this,s.expression.kind==="constant"||s.expression.kind==="camera"?{kind:"constant",value:s.expression.evaluate(u,null,{},p,v)}:s.expression,u)}interpolate(s,u,p){if(s.value.kind!=="constant"||u.value.kind!=="constant")return s;if(s.value.value===void 0||u.value.value===void 0)return new cd(this,{kind:"constant",value:void 0},s.parameters);const v=Gu[this.specification.type];return v?new cd(this,{kind:"constant",value:v(s.value.value,u.value.value,p)},s.parameters):s}evaluate(s,u,p,v,m,_){return s.kind==="constant"?s.value:s.evaluate(u,p,v,m,_)}}class Vl{constructor(s){this.specification=s}possiblyEvaluate(s,u,p,v){return!!s.expression.evaluate(u,null,{},p,v)}interpolate(){return!1}}class qi{constructor(s){this.properties=s,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new bi(0,{});for(const p in s){const v=s[p];v.specification.overridable&&this.overridableProperties.push(p);const m=this.defaultPropertyValues[p]=new zp(v,void 0),_=this.defaultTransitionablePropertyValues[p]=new sd(v);this.defaultTransitioningPropertyValues[p]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=m.possiblyEvaluate(u)}}}gr(fr,"DataDrivenProperty"),gr(er,"DataConstantProperty"),gr(Vl,"ColorRampProperty");var _t=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function Dc(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function lc(h){if(Array.isArray(h))return h.map(lc);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const s={};for(const u in h)s[u]=lc(h[u]);return s}return Dc(h)}function Fp(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const s of h.slice(1))if(!Fp(s)&&typeof s!="boolean")return!1;return!0;default:return!0}}function zy(h,s="",u=null,p="fill"){if(h==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Fp(h)||(h=dd(h));const v=h;let m=!0;try{m=function(j){if(!pu(j))return j;let R=lc(j);return fu(R),R=Lc(R),R}(v)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(v,null,2)}
        `)}let _=null,C=null;if(p!=="background"&&p!=="sky"&&p!=="slot"){C=_t[`filter_${p}`];const j=Xo(m,C,s,u);if(j.result==="error")throw new Error(j.value.map(R=>`${R.key}: ${R.message}`).join(", "));_=(R,F,M)=>j.value.evaluate(R,F,{},M)}let O=null,B=null;if(m!==v){const j=Xo(v,C,s,u);if(j.result==="error")throw new Error(j.value.map(R=>`${R.key}: ${R.message}`).join(", "));O=(R,F,M,I,q)=>j.value.evaluate(R,F,{},M,void 0,void 0,I,q),B=!lu(j.value.expression)}return{filter:_,dynamicFilter:O||void 0,needGeometry:Fy(m),needFeature:!!B}}function Lc(h){if(!Array.isArray(h))return h;const s=function(u){if(_v.has(u[0])){for(let p=1;p<u.length;p++)if(pu(u[p]))return!0}return u}(h);return s===!0?s:s.map(u=>Lc(u))}function fu(h){let s=!1;const u=[];if(h[0]==="case"){for(let p=1;p<h.length-1;p+=2)s=s||pu(h[p]),u.push(h[p+1]);u.push(h[h.length-1])}else if(h[0]==="match"){s=s||pu(h[1]);for(let p=2;p<h.length-1;p+=2)u.push(h[p+1]);u.push(h[h.length-1])}else if(h[0]==="step"){s=s||pu(h[1]);for(let p=1;p<h.length-1;p+=2)u.push(h[p+1])}s&&(h.length=0,h.push("any",...u));for(let p=1;p<h.length;p++)fu(h[p])}function pu(h){if(!Array.isArray(h))return!1;if((s=h[0])==="pitch"||s==="distance-from-center")return!0;var s;for(let u=1;u<h.length;u++)if(pu(h[u]))return!0;return!1}const _v=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function rg(h,s){return h<s?-1:h>s?1:0}function Fy(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let s=1;s<h.length;s++)if(Fy(h[s]))return!0;return!1}function dd(h){if(!h)return!0;const s=h[0];return h.length<=1?s!=="any":s==="=="?Qs(h[1],h[2],"=="):s==="!="?Sl(Qs(h[1],h[2],"==")):s==="<"||s===">"||s==="<="||s===">="?Qs(h[1],h[2],s):s==="any"?(u=h.slice(1),["any"].concat(u.map(dd))):s==="all"?["all"].concat(h.slice(1).map(dd)):s==="none"?["all"].concat(h.slice(1).map(dd).map(Sl)):s==="in"?hh(h[1],h.slice(2)):s==="!in"?Sl(hh(h[1],h.slice(2))):s==="has"?fh(h[1]):s!=="!has"||Sl(fh(h[1]));var u}function Qs(h,s,u){switch(h){case"$type":return[`filter-type-${u}`,s];case"$id":return[`filter-id-${u}`,s];default:return[`filter-${u}`,h,s]}}function hh(h,s){if(s.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",s]];case"$id":return["filter-id-in",["literal",s]];default:return s.length>200&&!s.some(u=>typeof u!=typeof s[0])?["filter-in-large",h,["literal",s.sort(rg)]]:["filter-in-small",h,["literal",s]]}}function fh(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Sl(h){return["!",h]}const xf="";function Eo(h,s){return s?`${h}${xf}${s}`:h}const zc="-transition",ng=new Set(["fill","line","background","hillshade","raster"]);class pi extends eu{constructor(s,u,p,v,m){if(super(),this.id=s.id,this.fqid=Eo(this.id,p),this.type=s.type,this.scope=p,this.lut=v,this.options=m,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,s.type!=="custom"){if(this.metadata=s.metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type&&s.type!=="background"&&s.type!=="sky"&&s.type!=="slot"){this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter;const _=Xo(this.filter,_t[`filter_${s.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(s.slot&&(this.slot=s.slot),u.layout&&(this._unevaluatedLayout=new ld(u.layout,this.scope,m),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),u.paint){this._transitionablePaint=new uh(u.paint,this.scope,m);for(const _ in s.paint)this.setPaintProperty(_,s.paint[_]);for(const _ in s.layout)this.setLayoutProperty(_,s.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ud(u.paint)}}}onAdd(s){}onRemove(s){}isDraped(s){return!this.is3D()&&ng.has(this.type)}getLayoutProperty(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)}setLayoutProperty(s,u){if(this.type==="custom"&&s==="visibility")return void(this.visibility=u);const p=this._unevaluatedLayout;p._properties.properties[s]&&(p.setValue(s,u),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),s==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(s){return es(s,zc)?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)}setPaintProperty(s,u){const p=this._transitionablePaint,v=p._properties.properties;if(es(s,zc)){const R=s.slice(0,-11);return v[R]&&p.setTransition(R,u||void 0),!1}if(!v[s])return!1;const m=p._values[s],_=m.value.isDataDriven(),C=m.value;p.setValue(s,u),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),this._handleSpecialPaintPropertyUpdate(s);const O=p._values[s].value,B=O.isDataDriven(),j=es(s,"pattern")||s==="line-dasharray";return B||_||j||this._handleOverridablePaintPropertyUpdate(s,C,O)}_handleSpecialPaintPropertyUpdate(s){}getProgramIds(){return null}getDefaultProgramParams(s,u,p){return null}_handleOverridablePaintPropertyUpdate(s,u,p){return!1}isHidden(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"}updateTransitions(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(s,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,u)}serialize(){return kl({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(s,u)=>!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const s in this.paint._values){const u=this.paint.get(s);if(u instanceof cd&&zl(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(s){this._filterCompiled||(this._featureFilter=zy(this.filter,this.scope,s),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(s){this._stats&&(s.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(s){}queryIntersectsFeature(s,u,p,v,m,_,C,O,B){}}const ig={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ph{constructor(s,u){this._structArray=s,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(s,u){return s._trim(),u&&(s.isTransferred=!0,u.add(s.arrayBuffer)),{length:s.length,arrayBuffer:s.arrayBuffer}}static deserialize(s){const u=Object.create(this.prototype);return u.arrayBuffer=s.arrayBuffer,u.length=s.length,u.capacity=s.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(s){this.reserve(s),this.length=s}reserve(s){if(s>this.capacity){this.capacity=Math.max(s,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...s){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...s){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ei(h,s=1){let u=0,p=0;return{members:h.map(v=>{const m=ig[v.type].BYTES_PER_ELEMENT,_=u=ag(u,Math.max(s,m)),C=v.components||1;return p=Math.max(p,m),u+=m*C,{name:v.name,type:v.type,components:C,offset:_}}),size:ag(u,Math.max(p,s)),alignment:s}}function ag(h,s){return Math.ceil(h/s)*s}class Mo extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u){const p=this.length;return this.resize(p+1),this.emplace(p,s,u)}emplace(s,u,p){const v=2*s;return this.int16[v+0]=u,this.int16[v+1]=p,s}}Mo.prototype.bytesPerElement=4,gr(Mo,"StructArrayLayout2i4");class ia extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,u,p)}emplace(s,u,p,v){const m=3*s;return this.int16[m+0]=u,this.int16[m+1]=p,this.int16[m+2]=v,s}}ia.prototype.bytesPerElement=6,gr(ia,"StructArrayLayout3i6");class ua extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=4*s;return this.int16[_+0]=u,this.int16[_+1]=p,this.int16[_+2]=v,this.int16[_+3]=m,s}}ua.prototype.bytesPerElement=8,gr(ua,"StructArrayLayout4i8");class ns extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const C=5*s;return this.int16[C+0]=u,this.int16[C+1]=p,this.int16[C+2]=v,this.int16[C+3]=m,this.int16[C+4]=_,s}}ns.prototype.bytesPerElement=10,gr(ns,"StructArrayLayout5i10");class hd extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,C)}emplace(s,u,p,v,m,_,C,O){const B=6*s,j=12*s,R=3*s;return this.int16[B+0]=u,this.int16[B+1]=p,this.uint8[j+4]=v,this.uint8[j+5]=m,this.uint8[j+6]=_,this.uint8[j+7]=C,this.float32[R+2]=O,s}}hd.prototype.bytesPerElement=12,gr(hd,"StructArrayLayout2i4ub1f12");class Qo extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,u,p)}emplace(s,u,p,v){const m=3*s;return this.float32[m+0]=u,this.float32[m+1]=p,this.float32[m+2]=v,s}}Qo.prototype.bytesPerElement=12,gr(Qo,"StructArrayLayout3f12");class is extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const C=6*s,O=3*s;return this.uint16[C+0]=u,this.uint16[C+1]=p,this.uint16[C+2]=v,this.uint16[C+3]=m,this.float32[O+2]=_,s}}is.prototype.bytesPerElement=12,gr(is,"StructArrayLayout4ui1f12");class sg extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=4*s;return this.uint16[_+0]=u,this.uint16[_+1]=p,this.uint16[_+2]=v,this.uint16[_+3]=m,s}}sg.prototype.bytesPerElement=8,gr(sg,"StructArrayLayout4ui8");class xs extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_){const C=this.length;return this.resize(C+1),this.emplace(C,s,u,p,v,m,_)}emplace(s,u,p,v,m,_,C){const O=6*s;return this.int16[O+0]=u,this.int16[O+1]=p,this.int16[O+2]=v,this.int16[O+3]=m,this.int16[O+4]=_,this.int16[O+5]=C,s}}xs.prototype.bytesPerElement=12,gr(xs,"StructArrayLayout6i12");class Bp extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B,j,R,F){const M=this.length;return this.resize(M+1),this.emplace(M,s,u,p,v,m,_,C,O,B,j,R,F)}emplace(s,u,p,v,m,_,C,O,B,j,R,F,M){const I=12*s;return this.int16[I+0]=u,this.int16[I+1]=p,this.int16[I+2]=v,this.int16[I+3]=m,this.uint16[I+4]=_,this.uint16[I+5]=C,this.uint16[I+6]=O,this.uint16[I+7]=B,this.int16[I+8]=j,this.int16[I+9]=R,this.int16[I+10]=F,this.int16[I+11]=M,s}}Bp.prototype.bytesPerElement=24,gr(Bp,"StructArrayLayout4i4ui4i24");class Vp extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_){const C=this.length;return this.resize(C+1),this.emplace(C,s,u,p,v,m,_)}emplace(s,u,p,v,m,_,C){const O=10*s,B=5*s;return this.int16[O+0]=u,this.int16[O+1]=p,this.int16[O+2]=v,this.float32[B+2]=m,this.float32[B+3]=_,this.float32[B+4]=C,s}}Vp.prototype.bytesPerElement=20,gr(Vp,"StructArrayLayout3i3f20");class mu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=4*s;return this.float32[_+0]=u,this.float32[_+1]=p,this.float32[_+2]=v,this.float32[_+3]=m,s}}mu.prototype.bytesPerElement=16,gr(mu,"StructArrayLayout4f16");class Ul extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint32[1*s+0]=u,s}}Ul.prototype.bytesPerElement=4,gr(Ul,"StructArrayLayout1ul4");class Rs extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u){const p=this.length;return this.resize(p+1),this.emplace(p,s,u)}emplace(s,u,p){const v=2*s;return this.uint16[v+0]=u,this.uint16[v+1]=p,s}}Rs.prototype.bytesPerElement=4,gr(Rs,"StructArrayLayout2ui4");class mh extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B,j,R,F,M){const I=this.length;return this.resize(I+1),this.emplace(I,s,u,p,v,m,_,C,O,B,j,R,F,M)}emplace(s,u,p,v,m,_,C,O,B,j,R,F,M,I){const q=20*s,X=10*s;return this.int16[q+0]=u,this.int16[q+1]=p,this.int16[q+2]=v,this.int16[q+3]=m,this.int16[q+4]=_,this.float32[X+3]=C,this.float32[X+4]=O,this.float32[X+5]=B,this.float32[X+6]=j,this.int16[q+14]=R,this.uint32[X+8]=F,this.uint16[q+18]=M,this.uint16[q+19]=I,s}}mh.prototype.bytesPerElement=40,gr(mh,"StructArrayLayout5i4f1i1ul2ui40");class _f extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,C)}emplace(s,u,p,v,m,_,C,O){const B=8*s;return this.int16[B+0]=u,this.int16[B+1]=p,this.int16[B+2]=v,this.int16[B+4]=m,this.int16[B+5]=_,this.int16[B+6]=C,this.int16[B+7]=O,s}}_f.prototype.bytesPerElement=16,gr(_f,"StructArrayLayout3i2i2i16");class Up extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const C=4*s,O=8*s;return this.float32[C+0]=u,this.float32[C+1]=p,this.float32[C+2]=v,this.int16[O+6]=m,this.int16[O+7]=_,s}}Up.prototype.bytesPerElement=16,gr(Up,"StructArrayLayout2f1f2i16");class og extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_){const C=this.length;return this.resize(C+1),this.emplace(C,s,u,p,v,m,_)}emplace(s,u,p,v,m,_,C){const O=20*s,B=5*s;return this.uint8[O+0]=u,this.uint8[O+1]=p,this.float32[B+1]=v,this.float32[B+2]=m,this.float32[B+3]=_,this.float32[B+4]=C,s}}og.prototype.bytesPerElement=20,gr(og,"StructArrayLayout2ub4f20");class _s extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p){const v=this.length;return this.resize(v+1),this.emplace(v,s,u,p)}emplace(s,u,p,v){const m=3*s;return this.uint16[m+0]=u,this.uint16[m+1]=p,this.uint16[m+2]=v,s}}_s.prototype.bytesPerElement=6,gr(_s,"StructArrayLayout3ui6");class lg extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te,le,ue,ie,fe){const ye=this.length;return this.resize(ye+1),this.emplace(ye,s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te,le,ue,ie,fe)}emplace(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te,le,ue,ie,fe,ye){const Se=30*s,Le=15*s,Ie=60*s;return this.int16[Se+0]=u,this.int16[Se+1]=p,this.int16[Se+2]=v,this.float32[Le+2]=m,this.float32[Le+3]=_,this.uint16[Se+8]=C,this.uint16[Se+9]=O,this.uint32[Le+5]=B,this.uint32[Le+6]=j,this.uint32[Le+7]=R,this.uint16[Se+16]=F,this.uint16[Se+17]=M,this.uint16[Se+18]=I,this.float32[Le+10]=q,this.float32[Le+11]=X,this.uint8[Ie+48]=te,this.uint8[Ie+49]=le,this.uint8[Ie+50]=ue,this.uint32[Le+13]=ie,this.int16[Se+28]=fe,this.uint8[Ie+58]=ye,s}}lg.prototype.bytesPerElement=60,gr(lg,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class cg extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie,Me,et,Be,rt,st,nt,ct){const ht=this.length;return this.resize(ht+1),this.emplace(ht,s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie,Me,et,Be,rt,st,nt,ct)}emplace(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te,le,ue,ie,fe,ye,Se,Le,Ie,Me,et,Be,rt,st,nt,ct,ht){const vt=20*s,ut=40*s,It=80*s;return this.float32[vt+0]=u,this.float32[vt+1]=p,this.int16[ut+4]=v,this.int16[ut+5]=m,this.int16[ut+6]=_,this.int16[ut+7]=C,this.int16[ut+8]=O,this.int16[ut+9]=B,this.int16[ut+10]=j,this.int16[ut+11]=R,this.int16[ut+12]=F,this.uint16[ut+13]=M,this.uint16[ut+14]=I,this.uint16[ut+15]=q,this.uint16[ut+16]=X,this.uint16[ut+17]=te,this.uint16[ut+18]=le,this.uint16[ut+19]=ue,this.uint16[ut+20]=ie,this.uint16[ut+21]=fe,this.uint16[ut+22]=ye,this.uint16[ut+23]=Se,this.uint16[ut+24]=Le,this.uint16[ut+25]=Ie,this.uint16[ut+26]=Me,this.uint16[ut+27]=et,this.uint32[vt+14]=Be,this.float32[vt+15]=rt,this.float32[vt+16]=st,this.float32[vt+17]=nt,this.float32[vt+18]=ct,this.uint8[It+76]=ht,s}}cg.prototype.bytesPerElement=80,gr(cg,"StructArrayLayout2f9i15ui1ul4f1ub80");class bf extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.float32[1*s+0]=u,s}}bf.prototype.bytesPerElement=4,gr(bf,"StructArrayLayout1f4");class gu extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m){const _=this.length;return this.resize(_+1),this.emplace(_,s,u,p,v,m)}emplace(s,u,p,v,m,_){const C=5*s;return this.float32[C+0]=u,this.float32[C+1]=p,this.float32[C+2]=v,this.float32[C+3]=m,this.float32[C+4]=_,s}}gu.prototype.bytesPerElement=20,gr(gu,"StructArrayLayout5f20");class $p extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,C)}emplace(s,u,p,v,m,_,C,O){const B=7*s;return this.float32[B+0]=u,this.float32[B+1]=p,this.float32[B+2]=v,this.float32[B+3]=m,this.float32[B+4]=_,this.float32[B+5]=C,this.float32[B+6]=O,s}}$p.prototype.bytesPerElement=28,gr($p,"StructArrayLayout7f28");class cc extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B,j,R){const F=this.length;return this.resize(F+1),this.emplace(F,s,u,p,v,m,_,C,O,B,j,R)}emplace(s,u,p,v,m,_,C,O,B,j,R,F){const M=11*s;return this.float32[M+0]=u,this.float32[M+1]=p,this.float32[M+2]=v,this.float32[M+3]=m,this.float32[M+4]=_,this.float32[M+5]=C,this.float32[M+6]=O,this.float32[M+7]=B,this.float32[M+8]=j,this.float32[M+9]=R,this.float32[M+10]=F,s}}cc.prototype.bytesPerElement=44,gr(cc,"StructArrayLayout11f44");class fd extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B){const j=this.length;return this.resize(j+1),this.emplace(j,s,u,p,v,m,_,C,O,B)}emplace(s,u,p,v,m,_,C,O,B,j){const R=9*s;return this.float32[R+0]=u,this.float32[R+1]=p,this.float32[R+2]=v,this.float32[R+3]=m,this.float32[R+4]=_,this.float32[R+5]=C,this.float32[R+6]=O,this.float32[R+7]=B,this.float32[R+8]=j,s}}fd.prototype.bytesPerElement=36,gr(fd,"StructArrayLayout9f36");class gh extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u){const p=this.length;return this.resize(p+1),this.emplace(p,s,u)}emplace(s,u,p){const v=2*s;return this.float32[v+0]=u,this.float32[v+1]=p,s}}gh.prototype.bytesPerElement=8,gr(gh,"StructArrayLayout2f8");class wf extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s,u,p,v){const m=this.length;return this.resize(m+1),this.emplace(m,s,u,p,v)}emplace(s,u,p,v,m){const _=6*s;return this.uint32[3*s+0]=u,this.uint16[_+2]=p,this.uint16[_+3]=v,this.uint16[_+4]=m,s}}wf.prototype.bytesPerElement=12,gr(wf,"StructArrayLayout1ul3ui12");class Sf extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint16[1*s+0]=u,s}}Sf.prototype.bytesPerElement=2,gr(Sf,"StructArrayLayout1ui2");class Af extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X){const te=this.length;return this.resize(te+1),this.emplace(te,s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X)}emplace(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te){const le=16*s;return this.float32[le+0]=u,this.float32[le+1]=p,this.float32[le+2]=v,this.float32[le+3]=m,this.float32[le+4]=_,this.float32[le+5]=C,this.float32[le+6]=O,this.float32[le+7]=B,this.float32[le+8]=j,this.float32[le+9]=R,this.float32[le+10]=F,this.float32[le+11]=M,this.float32[le+12]=I,this.float32[le+13]=q,this.float32[le+14]=X,this.float32[le+15]=te,s}}Af.prototype.bytesPerElement=64,gr(Af,"StructArrayLayout16f64");class yh extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(s,u,p,v,m,_,C){const O=this.length;return this.resize(O+1),this.emplace(O,s,u,p,v,m,_,C)}emplace(s,u,p,v,m,_,C,O){const B=10*s,j=5*s;return this.uint16[B+0]=u,this.uint16[B+1]=p,this.uint16[B+2]=v,this.uint16[B+3]=m,this.float32[j+2]=_,this.float32[j+3]=C,this.float32[j+4]=O,s}}yh.prototype.bytesPerElement=20,gr(yh,"StructArrayLayout4ui3f20");class ug extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.int16[1*s+0]=u,s}}ug.prototype.bytesPerElement=2,gr(ug,"StructArrayLayout1i2");class qp extends Ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(s){const u=this.length;return this.resize(u+1),this.emplace(u,s)}emplace(s,u){return this.uint8[1*s+0]=u,s}}qp.prototype.bytesPerElement=1,gr(qp,"StructArrayLayout1ub1");class By extends ph{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}By.prototype.size=40;class dg extends mh{get(s){return new By(this,s)}}gr(dg,"CollisionBoxArray");class vh extends ph{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(s){this._structArray.uint8[this._pos1+49]=s}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(s){this._structArray.uint8[this._pos1+50]=s}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(s){this._structArray.uint32[this._pos4+13]=s}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(s){this._structArray.uint8[this._pos1+58]=s}}vh.prototype.size=60;class Vy extends lg{get(s){return new vh(this,s)}}gr(Vy,"PlacedSymbolArray");class Uy extends ph{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(s){this._structArray.uint32[this._pos4+14]=s}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(s){this._structArray.float32[this._pos4+18]=s}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Uy.prototype.size=80;class $y extends cg{get(s){return new Uy(this,s)}}gr($y,"SymbolInstanceArray");class bv extends bf{getoffsetX(s){return this.float32[1*s+0]}}gr(bv,"GlyphOffsetArray");class qy extends Mo{getx(s){return this.int16[2*s+0]}gety(s){return this.int16[2*s+1]}}gr(qy,"SymbolLineVertexArray");class Gp extends ph{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Gp.prototype.size=12;class Wp extends wf{get(s){return new Gp(this,s)}}gr(Wp,"FeatureIndexArray");class Oo extends Rs{geta_centroid_pos0(s){return this.uint16[2*s+0]}geta_centroid_pos1(s){return this.uint16[2*s+1]}}gr(Oo,"FillExtrusionCentroidArray");class Tf extends ph{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Tf.prototype.size=6;class Gy extends ia{get(s){return new Tf(this,s)}}gr(Gy,"FillExtrusionWallArray");const hg=ei([{name:"a_pos",components:2,type:"Int16"}],4),Z_=ei([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class va{constructor(s=[]){this.segments=s}_prepareSegment(s,u,p,v){let m=this.segments[this.segments.length-1];return s>va.MAX_VERTEX_ARRAY_LENGTH&&sn(`Max vertices per segment is ${va.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${s}`),(!m||m.vertexLength+s>va.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==v)&&(m={vertexOffset:u,primitiveOffset:p,vertexLength:0,primitiveLength:0},v!==void 0&&(m.sortKey=v),this.segments.push(m)),m}prepareSegment(s,u,p,v){return this._prepareSegment(s,u.length,p.length,v)}get(){return this.segments}destroy(){for(const s of this.segments)for(const u in s.vaos)s.vaos[u].destroy()}static simpleSegment(s,u,p,v){return new va([{vertexOffset:s,primitiveOffset:u,vertexLength:p,primitiveLength:v,vaos:{},sortKey:0}])}}function fg(h,s){return 256*(h=ur(Math.floor(h),0,255))+ur(Math.floor(s),0,255)}va.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gr(va,"SegmentVector");const uc=ei([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Hp=ei([{name:"a_dash",components:4,type:"Uint16"}]);class pd{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(s,u,p,v){this.ids.push(Wy(s)),this.positions.push(u,p,v)}eachPosition(s,u){const p=Wy(s);let v=0,m=this.ids.length-1;for(;v<m;){const _=v+m>>1;this.ids[_]>=p?m=_:v=_+1}for(;this.ids[v]===p;)u(this.positions[3*v],this.positions[3*v+1],this.positions[3*v+2]),v++}static serialize(s,u){const p=new Float64Array(s.ids),v=new Uint32Array(s.positions);return Pf(p,v,0,p.length-1),u&&(u.add(p.buffer),u.add(v.buffer)),{ids:p,positions:v}}static deserialize(s){const u=new pd;let p;u.ids=s.ids,u.positions=s.positions;for(const v of u.ids)v!==p&&u.uniqueIds.push(v),p=v;return u.indexed=!0,u}}function Wy(h){const s=+h;return!isNaN(s)&&Number.MIN_SAFE_INTEGER<=s&&s<=Number.MAX_SAFE_INTEGER?s:ml(String(h))}function Pf(h,s,u,p){for(;u<p;){const v=h[u+p>>1];let m=u-1,_=p+1;for(;;){do m++;while(h[m]<v);do _--;while(h[_]>v);if(m>=_)break;Kp(h,m,_),Kp(s,3*m,3*_),Kp(s,3*m+1,3*_+1),Kp(s,3*m+2,3*_+2)}_-u<p-_?(Pf(h,s,u,_),u=_+1):(Pf(h,s,_+1,p),p=_)}}function Kp(h,s,u){const p=h[s];h[s]=h[u],h[u]=p}gr(pd,"FeaturePositionMap");class $l{constructor(s){this.gl=s.gl,this.initialized=!1}fetchUniformLocation(s,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(s,u),this.initialized=!0),!!this.location}set(s,u,p){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Fc extends $l{constructor(s){super(s),this.current=0}set(s,u,p){this.fetchUniformLocation(s,u)&&this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}}class da extends $l{constructor(s){super(s),this.current=0}set(s,u,p){this.fetchUniformLocation(s,u)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class el extends $l{constructor(s){super(s),this.current=[0,0]}set(s,u,p){this.fetchUniformLocation(s,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1])))}}class Nf extends $l{constructor(s){super(s),this.current=[0,0,0]}set(s,u,p){this.fetchUniformLocation(s,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2])))}}class jf extends $l{constructor(s){super(s),this.current=[0,0,0,0]}set(s,u,p){this.fetchUniformLocation(s,u)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Hy extends $l{constructor(s){super(s),this.current=Qn.transparent.toRenderColor(null)}set(s,u,p){this.fetchUniformLocation(s,u)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const Ky=new Float32Array(16);class Cf extends $l{constructor(s){super(s),this.current=Ky}set(s,u,p){if(this.fetchUniformLocation(s,u)){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let v=1;v<16;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}}}const pg=new Float32Array(9),Y_=new Float32Array(4);class mo extends $l{constructor(s){super(s),this.current=Y_}set(s,u,p){if(this.fetchUniformLocation(s,u)){for(let v=0;v<4;v++)if(p[v]!==this.current[v]){this.current=p,this.gl.uniformMatrix2fv(this.location,!1,p);break}}}}function eo(h){return[fg(255*h.r,255*h.g),fg(255*h.b,255*h.a)]}class md{constructor(s,u,p,v){this.value=s,this.uniformNames=u.map(m=>`u_${m}`),this.type=p,this.context=v}setUniform(s,u,p,v,m){const _=v.constantOr(this.value);u.set(s,m,_ instanceof Qn?_.toRenderColor(this.ignoreLut?null:this.context.lut):_)}getBinding(s,u){return this.type==="color"?new Hy(s):new da(s)}}class gd{constructor(s,u){this.uniformNames=u.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(s){this.pixelRatio=s.pixelRatio||1,this.pattern=s.tl.concat(s.br)}setUniform(s,u,p,v,m){const _=m==="u_pattern"||m==="u_dash"?this.pattern:m==="u_pixel_ratio"?this.pixelRatio:null;_&&u.set(s,m,_)}getBinding(s,u){return u==="u_pattern"||u==="u_dash"?new jf(s):new da(s)}}class Bc{constructor(s,u,p,v){this.expression=s,this.type=p,this.maxValue=0,this.paintVertexAttributes=u.map(m=>({name:`a_${m}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(s,u,p,v,m,_,C){const O=this.paintVertexArray.length,B=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new bi(0,{brightness:_}),u,{},m,v,C):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new bi(0,{brightness:_}),u,{},m,v,C)==="none"),this.paintVertexArray.resize(s),this._setPaintValue(O,s,B,this.context)}updatePaintArray(s,u,p,v,m,_,C){const O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:C},p,v,void 0,m):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:C},p,v,void 0,m)==="none"),this._setPaintValue(s,u,O,this.context)}_setPaintValue(s,u,p,v){if(this.type==="color"){const m=eo(p.toRenderColor(this.ignoreLut?null:v.lut));for(let _=s;_<u;_++)this.paintVertexArray.emplace(_,m[0],m[1])}else{for(let m=s;m<u;m++)this.paintVertexArray.emplace(m,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ql{constructor(s,u,p,v,m,_){this.expression=s,this.uniformNames=u.map(C=>`u_${C}_t`),this.type=p,this.useIntegerZoom=v,this.context=m,this.maxValue=0,this.paintVertexAttributes=u.map(C=>({name:`a_${C}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(s,u,p,v,m,_,C){const O=this.expression.evaluate(new bi(this.context.zoom,{brightness:_}),u,{},m,v,C),B=this.expression.evaluate(new bi(this.context.zoom+1,{brightness:_}),u,{},m,v,C);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new bi(this.context.zoom,{brightness:_}),u,{},m,v,C)==="none");const j=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValue(j,s,O,B,this.context)}updatePaintArray(s,u,p,v,m,_,C){const O=this.expression.evaluate({zoom:this.context.zoom,brightness:C},p,v,void 0,m),B=this.expression.evaluate({zoom:this.context.zoom+1,brightness:C},p,v,void 0,m);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:C},p,v,void 0,m)==="none"),this._setPaintValue(s,u,O,B,this.context)}_setPaintValue(s,u,p,v,m){if(this.type==="color"){const _=eo(p.toRenderColor(this.ignoreLut?null:m.lut)),C=eo(p.toRenderColor(this.ignoreLut?null:m.lut));for(let O=s;O<u;O++)this.paintVertexArray.emplace(O,_[0],_[1],C[0],C[1])}else{for(let _=s;_<u;_++)this.paintVertexArray.emplace(_,p,v);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(v))}}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(s,u,p,v,m){const _=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,C=ur(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);u.set(s,m,C)}getBinding(s,u){return new da(s)}}class yu{constructor(s,u,p,v,m){this.expression=s,this.layerId=m,this.paintVertexAttributes=(p==="array"?Hp:uc).members;for(let _=0;_<u.length;++_);this.paintVertexArray=new v}populatePaintArray(s,u,p,v){const m=this.paintVertexArray.length;this.paintVertexArray.resize(s),this._setPaintValues(m,s,u.patterns&&u.patterns[this.layerId],p)}updatePaintArray(s,u,p,v,m,_,C){this._setPaintValues(s,u,p.patterns&&p.patterns[this.layerId],_)}_setPaintValues(s,u,p,v){if(!v||!p)return;const m=v[p];if(!m)return;const{tl:_,br:C,pixelRatio:O}=m;for(let B=s;B<u;B++)this.paintVertexArray.emplace(B,_[0],_[1],C[0],C[1],O)}upload(s){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=s.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class vu{constructor(s,u,p=()=>!0){this.binders={},this._buffers=[],this.context=u;const v=[];for(const m in s.paint._values){const _=s.paint.get(m),C=s.paint.get(`${m}-use-theme`);if(m.endsWith("-use-theme")||!p(m)||!(_ instanceof cd&&zl(_.property.specification)))continue;const O=wv(m,s.type),B=_.value,j=_.property.specification.type,R=!!_.property.useIntegerZoom,F=m==="line-dasharray"||m.endsWith("pattern"),M=m==="line-dasharray"&&s.layout.get("line-cap").value.kind!=="constant"||C&&C.value.kind!=="constant";if(B.kind!=="constant"||M)if(B.kind==="source"||M||F){const I=mg(m,j,"source");this.binders[m]=F?new yu(B,O,j,I,s.id):new Bc(B,O,j,I),v.push(`/a_${m}`)}else{const I=mg(m,j,"composite");this.binders[m]=new ql(B,O,j,R,u,I),v.push(`/z_${m}`)}else this.binders[m]=F?new gd(B.value,O):new md(B.value,O,j,u),v.push(`/u_${m}`);C&&(this.binders[m].ignoreLut=C.constantOr("default")==="none",this.binders[m].lutExpression=C.value,this.binders[m].checkUseTheme=!0)}this.cacheKey=v.sort().join("")}getMaxValue(s){const u=this.binders[s];return u instanceof Bc||u instanceof ql?u.maxValue:0}populatePaintArrays(s,u,p,v,m,_,C){for(const O in this.binders){const B=this.binders[O];B.context=this.context,B instanceof Bc||B instanceof ql||B instanceof yu?B.populatePaintArray(s,u,p,v,m,_,C):B.lutExpression&&B instanceof md&&B.lutExpression&&(B.lutExpression.kind==="composite"||B.lutExpression.kind==="source")&&(B.ignoreLut=B.lutExpression.evaluate(new bi(0,{brightness:_}),u,{},m,v,C)==="none")}}setConstantPatternPositions(s){for(const u in this.binders){const p=this.binders[u];p instanceof gd&&p.setConstantPatternPositions(s)}}updatePaintArrays(s,u,p,v,m,_,C,O,B){let j=!1;const R=Object.keys(s),F=R.length!==0&&!O,M=F?R:u.uniqueIds;this.context.lut=m.lut;for(const I in this.binders){const q=this.binders[I];if(q.context=this.context,(q instanceof Bc||q instanceof ql||q instanceof yu)&&q.expression&&q.expression.kind&&q.expression.kind!=="constant"&&(q.expression.isStateDependent===!0||q.expression.isLightConstant===!1)){const X=m.paint.get(I);q.expression=X.value;for(const te of M){const le=s[te.toString()];u.eachPosition(te,(ue,ie,fe)=>{const ye=v.feature(ue);q.updatePaintArray(ie,fe,ye,le,_,C,B)})}if(!F)for(const te of p.uniqueIds){const le=s[te.toString()];p.eachPosition(te,(ue,ie,fe)=>{const ye=v.feature(ue);q.updatePaintArray(ie,fe,ye,le,_,C,B)})}j=!0}}return j}defines(){const s=[];for(const u in this.binders){const p=this.binders[u];(p instanceof md||p instanceof gd)&&s.push(...p.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return s}getBinderAttributes(){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Bc||p instanceof ql||p instanceof yu)for(let v=0;v<p.paintVertexAttributes.length;v++)s.push(p.paintVertexAttributes[v].name)}return s}getBinderUniforms(){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof md||p instanceof gd||p instanceof ql)for(const v of p.uniformNames)s.push(v)}return s}getPaintVertexBuffers(){return this._buffers}getUniforms(s){const u=[];for(const p in this.binders){const v=this.binders[p];if(v instanceof md||v instanceof gd||v instanceof ql)for(const m of v.uniformNames)u.push({name:m,property:p,binding:v.getBinding(s,m)})}return u}setUniforms(s,u,p,v,m){for(const{name:_,property:C,binding:O}of p){if(this.binders[C].checkUseTheme&&this.binders[C]instanceof md){const B=v.get(`${C}-use-theme`);B.isConstant()&&(this.binders[C].ignoreLut=B.constantOr("default")==="none")}this.binders[C].setUniform(s,O,m,v.get(C),_)}}updatePaintBuffers(){this._buffers=[];for(const s in this.binders){const u=this.binders[s];(u instanceof Bc||u instanceof ql||u instanceof yu)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(s){for(const u in this.binders){const p=this.binders[u];(p instanceof Bc||p instanceof ql||p instanceof yu)&&p.upload(s)}this.updatePaintBuffers()}destroy(){for(const s in this.binders){const u=this.binders[s];(u instanceof Bc||u instanceof ql||u instanceof yu)&&u.destroy()}}}class xu{constructor(s,u,p=()=>!0){this.programConfigurations={};for(const v of s)this.programConfigurations[v.id]=new vu(v,u,p);this.needsUpload=!1,this._featureMap=new pd,this._featureMapWithoutIds=new pd,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(s,u,p,v,m,_,C,O){for(const B in this.programConfigurations)this.programConfigurations[B].populatePaintArrays(s,u,v,m,_,C,O);u.id!==void 0?this._featureMap.add(u.id,p,this._bufferOffset,s):(this._featureMapWithoutIds.add(this._idlessCounter,p,this._bufferOffset,s),this._idlessCounter+=1),this._bufferOffset=s,this.needsUpload=!0}updatePaintArrays(s,u,p,v,m,_,C){for(const O of p)this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(s,this._featureMap,this._featureMapWithoutIds,u,O,v,m,_,C||0)||this.needsUpload}get(s){return this.programConfigurations[s]}upload(s){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(s);this.needsUpload=!1}}destroy(){for(const s in this.programConfigurations)this.programConfigurations[s].destroy()}}const Zy={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function wv(h,s){return Zy[h]||[h.replace(`${s}-`,"").replace(/-/g,"_")]}const Sv={"line-pattern":{source:is,composite:is},"fill-pattern":{source:is,composite:is},"fill-extrusion-pattern":{source:is,composite:is},"line-dasharray":{source:sg,composite:sg}},kf={color:{source:gh,composite:mu},number:{source:bf,composite:gh}};function mg(h,s,u){const p=Sv[h];return p&&p[u]||kf[s][u]}gr(md,"ConstantBinder"),gr(gd,"PatternConstantBinder"),gr(Bc,"SourceExpressionBinder"),gr(yu,"PatternCompositeBinder"),gr(ql,"CompositeExpressionBinder"),gr(vu,"ProgramConfiguration",{omit:["_buffers"]}),gr(xu,"ProgramConfigurationSet");const to=hr/Math.PI/2,yd=5,Zp=6,Av=16383,xh=64,Ef=[xh,32,16],tl=-to,go=to;function rl(h,s,u,p=to){return u=tt(u),[h*Math.sin(u)*p,-s*p,h*Math.cos(u)*p]}function _h(h,s,u){return rl(Math.cos(tt(h)),Math.sin(tt(h)),s,u)}const vd=63710088e-1,Yp=2*Math.PI*vd;class Zn{constructor(s,u){if(isNaN(s)||isNaN(u))throw new Error(`Invalid LngLat object: (${s}, ${u})`);if(this.lng=+s,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Zn(Gn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(s){const u=Math.PI/180,p=this.lat*u,v=s.lat*u,m=Math.sin(p)*Math.sin(v)+Math.cos(p)*Math.cos(v)*Math.cos((s.lng-this.lng)*u);return vd*Math.acos(Math.min(m,1))}toBounds(s=0){const u=360*s/40075017,p=u/Math.cos(Math.PI/180*this.lat);return new _u({lng:this.lng-p,lat:this.lat-u},{lng:this.lng+p,lat:this.lat+u})}toEcef(s){return _h(this.lat,this.lng,to+s*to/vd)}static convert(s){if(s instanceof Zn)return s;if(Array.isArray(s)&&(s.length===2||s.length===3))return new Zn(Number(s[0]),Number(s[1]));if(!Array.isArray(s)&&typeof s=="object"&&s!==null)return new Zn(Number("lng"in s?s.lng:s.lon),Number(s.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class _u{constructor(s,u){if(s)if(u)this.setSouthWest(s).setNorthEast(u);else if(s.length===4){const p=s;this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]])}else{const p=s;this.setSouthWest(p[0]).setNorthEast(p[1])}}setNorthEast(s){return this._ne=s instanceof Zn?new Zn(s.lng,s.lat):Zn.convert(s),this}setSouthWest(s){return this._sw=s instanceof Zn?new Zn(s.lng,s.lat):Zn.convert(s),this}extend(s){const u=this._sw,p=this._ne;let v,m;if(s instanceof Zn)v=s,m=s;else{if(!(s instanceof _u))return Array.isArray(s)?s.length===4||s.every(Array.isArray)?this.extend(_u.convert(s)):this.extend(Zn.convert(s)):typeof s=="object"&&s!==null&&s.hasOwnProperty("lat")&&(s.hasOwnProperty("lon")||s.hasOwnProperty("lng"))?this.extend(Zn.convert(s)):this;if(v=s._sw,m=s._ne,!v||!m)return this}return u||p?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),p.lng=Math.max(m.lng,p.lng),p.lat=Math.max(m.lat,p.lat)):(this._sw=new Zn(v.lng,v.lat),this._ne=new Zn(m.lng,m.lat)),this}getCenter(){return new Zn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Zn(this.getWest(),this.getNorth())}getSouthEast(){return new Zn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(s){const{lng:u,lat:p}=Zn.convert(s);let v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&v}static convert(s){if(s)return s instanceof _u?s:new _u(s)}}const Xp=0,yo=25.5;function gg(h){return Yp*Math.cos(h*Math.PI/180)}function Vc(h){return(180+h)/360}function nl(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function Gi(h,s){return h/gg(s)}function il(h){return 360*h-180}function Vr(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function bh(h,s){return h*gg(Vr(s))}const ro=85.051129;function yg(h){return Math.cos(tt(ur(h,-85.051129,ro)))}function Mf(h,s){const u=ur(s,Xp,yo),p=Math.pow(2,u);return yg(h)*Yp/(512*p)}function g(h){return 1/Math.cos(h*Math.PI/180)}function o(h,s=0){const u=Math.exp(Math.PI*(1-(h.y+s/hr)/(1<<h.z)*2));return 80150034*u/(u*u+1)/hr/(1<<h.z)}class d{constructor(s,u,p=0){this.x=+s,this.y=+u,this.z=+p}static fromLngLat(s,u=0){const p=Zn.convert(s);return new d(Vc(p.lng),nl(p.lat),Gi(u,p.lat))}toLngLat(){return new Zn(il(this.x),Vr(this.y))}toAltitude(){return bh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Yp*g(Vr(this.y))}}function y(h,s,u,p,v,m,_,C,O){const B=(s+p)/2,j=(u+v)/2,R=new At(B,j);C(R),function(F,M,I,q,X,te){const le=I-X,ue=q-te;return Math.abs((q-M)*le-(I-F)*ue)/Math.hypot(le,ue)}(R.x,R.y,m.x,m.y,_.x,_.y)>=O?(y(h,s,u,B,j,m,R,C,O),y(h,B,j,p,v,R,_,C,O)):h.push(_)}function S(h,s,u){let p=h[0],v=p.x,m=p.y;s(p);const _=[p];for(let C=1;C<h.length;C++){const O=h[C],{x:B,y:j}=O;s(O),y(_,v,m,B,j,p,O,s,u),v=B,m=j,p=O}return _}function N(h,s,u,p){if(p(s,u)){const v=s.add(u)._mult(.5);N(h,s,v,p),N(h,v,u,p)}else h.push(u)}function k(h,s){let u=h[0];const p=[u];for(let v=1;v<h.length;v++){const m=h[v];N(p,u,m,s),u=m}return p}const z=Math.pow(2,14)-1,G=-z-1;function Z(h,s){const u=Math.round(h.x*s),p=Math.round(h.y*s);return h.x=ur(u,G,z),h.y=ur(p,G,z),(u<h.x||u>h.x+1||p<h.y||p>h.y+1)&&sn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),h}function Y(h,s,u){const p=h.loadGeometry(),v=h.extent,m=hr/v;if(s&&u&&u.projection.isReprojectedInTileSpace){const _=1<<s.z,{scale:C,x:O,y:B,projection:j}=u,R=F=>{const M=il((s.x+F.x/v)/_),I=Vr((s.y+F.y/v)/_),q=j.project(M,I);F.x=(q.x*C-O)*v,F.y=(q.y*C-B)*v};for(let F=0;F<p.length;F++)if(h.type!==1)p[F]=S(p[F],R,1);else{const M=[];for(const I of p[F])I.x<0||I.x>=v||I.y<0||I.y>=v||(R(I),M.push(I));p[F]=M}}for(const _ of p)for(const C of _)Z(C,m);return p}function re(h,s){return{type:h.type,id:h.id,properties:h.properties,geometry:s?Y(h):[]}}function ne(h,s,u,p,v){h.emplaceBack(2*s+(p+1)/2,2*u+(v+1)/2)}function oe(h,s,u){h.emplaceBack(s.x,s.y,s.z,u[0]*16384,u[1]*16384,u[2]*16384)}class _e{constructor(s){this.zoom=s.zoom,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.projection=s.projection,this.layoutVertexArray=new Mo,this.indexArray=new _s,this.segments=new va,this.programConfigurations=new xu(s.layers,{zoom:s.zoom,lut:s.lut}),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}updateFootprints(s,u){}populate(s,u,p,v){const m=this.layers[0],_=[];let C=null;m.type==="circle"&&(C=m.layout.get("circle-sort-key"));for(const{feature:B,id:j,index:R,sourceLayerIndex:F}of s){const M=this.layers[0]._featureFilter.needGeometry,I=re(B,M);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),I,p))continue;const q=C?C.evaluate(I,{},p):void 0,X={id:j,properties:B.properties,type:B.type,sourceLayerIndex:F,index:R,geometry:M?I.geometry:Y(B,p,v),patterns:{},sortKey:q};_.push(X)}C&&_.sort((B,j)=>B.sortKey-j.sortKey);let O=null;v.projection.name==="globe"&&(this.globeExtVertexArray=new xs,O=v.projection);for(const B of _){const{geometry:j,index:R,sourceLayerIndex:F}=B,M=s[R].feature;this.addFeature(B,j,R,u.availableImages,p,O,u.brightness),u.featureIndex.insert(M,j,R,F,this.index)}}update(s,u,p,v,m,_,C){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,C)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,hg.members),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Z_.members))),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(s,u,p,v,m,_,C){for(const O of u)for(const B of O){const j=B.x,R=B.y;if(j<0||j>=hr||R<0||R>=hr)continue;if(_){const I=_.projectTilePoint(j,R,m),q=_.upVector(m,j,R),X=this.globeExtVertexArray;oe(X,I,q),oe(X,I,q),oe(X,I,q),oe(X,I,q)}const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,s.sortKey),M=F.vertexLength;ne(this.layoutVertexArray,j,R,-1,-1),ne(this.layoutVertexArray,j,R,1,-1),ne(this.layoutVertexArray,j,R,1,1),ne(this.layoutVertexArray,j,R,-1,1),this.indexArray.emplaceBack(M,M+1,M+2),this.indexArray.emplaceBack(M,M+2,M+3),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,{},v,m,C)}}function me(h,s){for(let u=0;u<h.length;u++)if(Ge(s,h[u]))return!0;for(let u=0;u<s.length;u++)if(Ge(h,s[u]))return!0;return!!$e(h,s)}function we(h,s,u){return!!Ge(h,s)||!!Qe(s,h,u)}function be(h,s){if(h.length===1)return Ke(s,h[0]);for(let u=0;u<s.length;u++){const p=s[u];for(let v=0;v<p.length;v++)if(Ge(h,p[v]))return!0}for(let u=0;u<h.length;u++)if(Ke(s,h[u]))return!0;for(let u=0;u<s.length;u++)if($e(h,s[u]))return!0;return!1}function Ee(h,s,u){if(h.length>1){if($e(h,s))return!0;for(let p=0;p<s.length;p++)if(Qe(s[p],h,u))return!0}for(let p=0;p<h.length;p++)if(Qe(h[p],s,u))return!0;return!1}function $e(h,s){if(h.length===0||s.length===0)return!1;for(let u=0;u<h.length-1;u++){const p=h[u],v=h[u+1];for(let m=0;m<s.length-1;m++)if(Ve(p,v,s[m],s[m+1]))return!0}return!1}function Ve(h,s,u,p){return ts(h,u,p)!==ts(s,u,p)&&ts(h,s,u)!==ts(h,s,p)}function Qe(h,s,u){const p=u*u;if(s.length===1)return h.distSqr(s[0])<p;for(let v=1;v<s.length;v++)if(We(h,s[v-1],s[v])<p)return!0;return!1}function We(h,s,u){const p=s.distSqr(u);if(p===0)return h.distSqr(s);const v=((h.x-s.x)*(u.x-s.x)+(h.y-s.y)*(u.y-s.y))/p;return h.distSqr(v<0?s:v>1?u:u.sub(s)._mult(v)._add(s))}function Ke(h,s){let u,p,v,m=!1;for(let _=0;_<h.length;_++){u=h[_];for(let C=0,O=u.length-1;C<u.length;O=C++)p=u[C],v=u[O],p.y>s.y!=v.y>s.y&&s.x<(v.x-p.x)*(s.y-p.y)/(v.y-p.y)+p.x&&(m=!m)}return m}function Ge(h,s){let u=!1;for(let p=0,v=h.length-1;p<h.length;v=p++){const m=h[p],_=h[v];m.y>s.y!=_.y>s.y&&s.x<(_.x-m.x)*(s.y-m.y)/(_.y-m.y)+m.x&&(u=!u)}return u}function Ye(h,s,u,p,v){for(const _ of h)if(s<=_.x&&u<=_.y&&p>=_.x&&v>=_.y)return!0;const m=[new At(s,u),new At(s,v),new At(p,v),new At(p,u)];if(h.length>2){for(const _ of m)if(Ge(h,_))return!0}for(let _=0;_<h.length-1;_++)if(it(h[_],h[_+1],m))return!0;return!1}function it(h,s,u){const p=u[0],v=u[2];if(h.x<p.x&&s.x<p.x||h.x>v.x&&s.x>v.x||h.y<p.y&&s.y<p.y||h.y>v.y&&s.y>v.y)return!1;const m=ts(h,s,u[0]);return m!==ts(h,s,u[1])||m!==ts(h,s,u[2])||m!==ts(h,s,u[3])}function bt(h,s,u,p,v,m){let _=s.y-h.y,C=h.x-s.x;if(m=m||0){const O=_*_+C*C;if(O===0)return!0;const B=Math.sqrt(O);_/=B,C/=B}return!((u.x-h.x)*_+(u.y-h.y)*C-m<0||(p.x-h.x)*_+(p.y-h.y)*C-m<0||(v.x-h.x)*_+(v.y-h.y)*C-m<0)}function pt(h,s,u,p,v,m,_){return!(bt(h,s,p,v,m,_)||bt(s,u,p,v,m,_)||bt(u,h,p,v,m,_)||bt(p,v,h,s,u,_)||bt(v,m,h,s,u,_)||bt(m,p,h,s,u,_))}function kt(h,s,u){const p=s.paint.get(h).value;return p.kind==="constant"?p.value:u.programConfigurations.get(s.id).getMaxValue(h)}function Et(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function dt(h,s,u,p,v){if(!s[0]&&!s[1])return h;const m=At.convert(s)._mult(v);u==="viewport"&&m._rotate(-p);const _=[];for(let C=0;C<h.length;C++)_.push(h[C].sub(m));return _}function jt(h,s,u,p){const v=At.convert(h)._mult(p);return s==="viewport"&&v._rotate(-u),v}let Gt,ft;gr(_e,"CircleBucket",{omit:["layers"]});var Ft,Ct={exports:{}},Qt=(Ft||(Ft=1,function(h,s){(function(u){function p(m,_,C){var O=v(256*m,256*(_=Math.pow(2,C)-_-1),C),B=v(256*(m+1),256*(_+1),C);return O[0]+","+O[1]+","+B[0]+","+B[1]}function v(m,_,C){var O=2*Math.PI*6378137/256/Math.pow(2,C);return[m*O-2*Math.PI*6378137/2,_*O-2*Math.PI*6378137/2]}u.getURL=function(m,_,C,O,B,j){return j=j||{},m+"?"+["bbox="+p(C,O,B),"format="+(j.format||"image/png"),"service="+(j.service||"WMS"),"version="+(j.version||"1.1.1"),"request="+(j.request||"GetMap"),"srs="+(j.srs||"EPSG:3857"),"width="+(j.width||256),"height="+(j.height||256),"layers="+_].join("&")},u.getTileBBox=p,u.getMercCoords=v,Object.defineProperty(u,"__esModule",{value:!0})})(s)}(0,Ct.exports)),Ct.exports);class $t{constructor(s,u,p){this.z=s,this.x=u,this.y=p,this.key=nr(0,s,s,u,p)}equals(s){return this.z===s.z&&this.x===s.x&&this.y===s.y}url(s,u){const p=Qt.getTileBBox(this.x,this.y,this.z),v=function(m,_,C){let O,B="";for(let j=m;j>0;j--)O=1<<j-1,B+=(_&O?1:0)+(C&O?2:0);return B}(this.z,this.x,this.y);return s[(this.x+this.y)%s.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",v).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zt{constructor(s,u){this.wrap=s,this.canonical=u,this.key=nr(s,u.z,u.z,u.x,u.y)}}class Yt{constructor(s,u,p,v,m){this.overscaledZ=s,this.wrap=u,this.canonical=new $t(p,+v,+m),this.key=u===0&&s===p?this.canonical.key:nr(u,s,p,v,m)}equals(s){return this.overscaledZ===s.overscaledZ&&this.wrap===s.wrap&&this.canonical.equals(s.canonical)}scaledTo(s){const u=this.canonical.z-s;return s>this.canonical.z?new Yt(s,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Yt(s,this.wrap,s,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(s,u=!0){if(this.overscaledZ===s&&u)return this.key;if(s>this.canonical.z)return nr(this.wrap*+u,s,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-s;return nr(this.wrap*+u,s,s,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(s){if(s.wrap!==this.wrap)return!1;const u=this.canonical.z-s.canonical.z;return s.overscaledZ===0||s.overscaledZ<this.overscaledZ&&s.canonical.z<this.canonical.z&&s.canonical.x===this.canonical.x>>u&&s.canonical.y===this.canonical.y>>u}children(s){if(this.overscaledZ>=s)return[new Yt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,p=2*this.canonical.x,v=2*this.canonical.y;return[new Yt(u,this.wrap,u,p,v),new Yt(u,this.wrap,u,p+1,v),new Yt(u,this.wrap,u,p,v+1),new Yt(u,this.wrap,u,p+1,v+1)]}isLessThan(s){return this.wrap<s.wrap||!(this.wrap>s.wrap)&&(this.overscaledZ<s.overscaledZ||!(this.overscaledZ>s.overscaledZ)&&(this.canonical.x<s.canonical.x||!(this.canonical.x>s.canonical.x)&&this.canonical.y<s.canonical.y))}wrapped(){return new Yt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(s){return new Yt(this.overscaledZ,s,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nr(h,s,u,p,v){const m=1<<Math.min(u,22);let _=m*(v%m)+p%m;return h&&u<22&&(_+=m*m*((h<0?-2*h-1:2*h)%(1<<2*(22-u)))),16*(32*_+u)+(s-u)}const yr=[h=>{let s=h.canonical.x-1,u=h.wrap;return s<0&&(s=(1<<h.canonical.z)-1,u--),new Yt(h.overscaledZ,u,h.canonical.z,s,h.canonical.y)},h=>{let s=h.canonical.x+1,u=h.wrap;return s===1<<h.canonical.z&&(s=0,u++),new Yt(h.overscaledZ,u,h.canonical.z,s,h.canonical.y)},h=>new Yt(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,(h.canonical.y===0?1<<h.canonical.z:h.canonical.y)-1),h=>new Yt(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y===(1<<h.canonical.z)-1?0:h.canonical.y+1)];gr($t,"CanonicalTileID"),gr(Yt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const _r=ei([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Wr}=_r,Or=ei([{name:"a_pos_3",components:3,type:"Int16"}]);var Lr=ei([{name:"a_pos",type:"Int16",components:2}]);class Zr{constructor(s,u){this.pos=s,this.dir=u}intersectsPlane(s,u,p){const v=De.vec3.dot(u,this.dir);if(Math.abs(v)<1e-6)return!1;const m=((s[0]-this.pos[0])*u[0]+(s[1]-this.pos[1])*u[1]+(s[2]-this.pos[2])*u[2])/v;return p[0]=this.pos[0]+this.dir[0]*m,p[1]=this.pos[1]+this.dir[1]*m,p[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(s,u,p){if(De.vec3.equals(this.pos,s)||u===0)return p[0]=p[1]=p[2]=0,!1;const[v,m,_]=this.dir,C=this.pos[0]-s[0],O=this.pos[1]-s[1],B=this.pos[2]-s[2],j=v*v+m*m+_*_,R=2*(C*v+O*m+B*_),F=R*R-4*j*(C*C+O*O+B*B-u*u);if(F<0){const M=Math.max(-R/2,0),I=C+v*M,q=O+m*M,X=B+_*M,te=Math.hypot(I,q,X);return p[0]=I*u/te,p[1]=q*u/te,p[2]=X*u/te,!1}{const M=(-R-Math.sqrt(F))/(2*j);if(M<0){const I=Math.hypot(C,O,B);return p[0]=C*u/I,p[1]=O*u/I,p[2]=B*u/I,!1}return p[0]=C+v*M,p[1]=O+m*M,p[2]=B+_*M,!0}}}class Dn{constructor(s,u,p,v,m){this.TL=s,this.TR=u,this.BR=p,this.BL=v,this.horizon=m}static fromInvProjectionMatrix(s,u,p){const v=[-1,1,1],m=[1,1,1],_=[1,-1,1],C=[-1,-1,1],O=De.vec3.transformMat4(v,v,s),B=De.vec3.transformMat4(m,m,s),j=De.vec3.transformMat4(_,_,s),R=De.vec3.transformMat4(C,C,s);return new Dn(O,B,j,R,u/p)}}function hi(h,s,u){let p=1/0,v=-1/0;const m=[];for(const _ of h){De.vec3.sub(m,_,s);const C=De.vec3.dot(m,u);p=Math.min(p,C),v=Math.max(v,C)}return[p,v]}function Wi(h,s){let u=!0;for(let p=0;p<h.planes.length;p++){const v=h.planes[p];let m=0;for(let _=0;_<s.length;_++)m+=De.vec3.dot(v,s[_])+v[3]>=0;if(m===0)return 0;m!==s.length&&(u=!1)}return u?2:1}function Yn(h,s){for(const u of h.projections){const p=hi(s,h.points[0],u.axis);if(u.projection[1]<p[0]||u.projection[0]>p[1])return 0}return 1}function Xr(h,s){let u=0;const p=[0,0,0,0];for(let v=0;v<h.length;v++)p[0]=h[v][0],p[1]=h[v][1],p[2]=h[v][2],p[3]=1,De.vec4.dot(p,s)>=0&&u++;return u}class Sn{constructor(s,u){this.points=s||new Array(8).fill([0,0,0]),this.planes=u||new Array(6).fill([0,0,0,0]),this.bounds=Sr.fromPoints(this.points),this.projections=[],this.frustumEdges=[De.vec3.sub([],this.points[2],this.points[3]),De.vec3.sub([],this.points[0],this.points[3]),De.vec3.sub([],this.points[4],this.points[0]),De.vec3.sub([],this.points[5],this.points[1]),De.vec3.sub([],this.points[6],this.points[2]),De.vec3.sub([],this.points[7],this.points[3])];for(const p of this.frustumEdges){const v=[0,-p[2],p[1]],m=[p[2],0,-p[0]];this.projections.push({axis:v,projection:hi(this.points,this.points[0],v)}),this.projections.push({axis:m,projection:hi(this.points,this.points[0],m)})}}static fromInvProjectionMatrix(s,u,p,v){const m=Math.pow(2,p),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(B=>{const j=De.vec4.transformMat4([],B,s),R=1/j[3]/u*m;return De.vec4.mul(j,j,[R,R,v?1/j[3]:R,R])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(B=>{const j=De.vec3.sub([],_[B[0]],_[B[1]]),R=De.vec3.sub([],_[B[2]],_[B[1]]),F=De.vec3.normalize([],De.vec3.cross([],j,R)),M=-De.vec3.dot(F,_[B[1]]);return F.concat(M)}),O=[];for(let B=0;B<_.length;B++)O.push([_[B][0],_[B][1],_[B][2]]);return new Sn(O,C)}intersectsPrecise(s,u,p){for(let v=0;v<u.length;v++)if(!Xr(s,u[v]))return 0;for(let v=0;v<this.planes.length;v++)if(!Xr(s,this.planes[v]))return 0;for(const v of p)for(const m of this.frustumEdges){const _=De.vec3.cross([],v,m),C=De.vec3.length(_);if(C===0)continue;De.vec3.scale(_,_,1/C);const O=hi(this.points,this.points[0],_),B=hi(s,this.points[0],_);if(O[0]>B[1]||B[0]>O[1])return 0}return 1}containsPoint(s){for(const u of this.planes){const p=u[3];if(De.vec3.dot([u[0],u[1],u[2]],s)+p<0)return!1}return!0}}class Sr{static fromPoints(s){const u=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const v of s)De.vec3.min(u,u,v),De.vec3.max(p,p,v);return new Sr(u,p)}static fromTileIdAndHeight(s,u,p){const v=1<<s.canonical.z,m=s.canonical.x,_=s.canonical.y;return new Sr([m/v,_/v,u],[(m+1)/v,(_+1)/v,p])}static applyTransform(s,u){const p=s.getCorners();for(let v=0;v<p.length;++v)De.vec3.transformMat4(p[v],p[v],u);return Sr.fromPoints(p)}static applyTransformFast(s,u){const p=[u[12],u[13],u[14]],v=[...p];for(let m=0;m<3;m++)for(let _=0;_<3;_++){const C=u[4*_+m],O=C*s.min[_],B=C*s.max[_];p[m]+=Math.min(O,B),v[m]+=Math.max(O,B)}return new Sr(p,v)}static projectAabbCorners(s,u){const p=s.getCorners();for(let v=0;v<p.length;++v)De.vec3.transformMat4(p[v],p[v],u);return p}constructor(s,u){this.min=s,this.max=u,this.center=De.vec3.scale([],De.vec3.add([],this.min,this.max),.5)}quadrant(s){const u=[s%2==0,s<2],p=De.vec3.clone(this.min),v=De.vec3.clone(this.max);for(let m=0;m<u.length;m++)p[m]=u[m]?this.min[m]:this.center[m],v[m]=u[m]?this.center[m]:this.max[m];return v[2]=this.max[2],new Sr(p,v)}distanceX(s){return Math.max(Math.min(this.max[0],s[0]),this.min[0])-s[0]}distanceY(s){return Math.max(Math.min(this.max[1],s[1]),this.min[1])-s[1]}distanceZ(s){return Math.max(Math.min(this.max[2],s[2]),this.min[2])-s[2]}getCorners(){const s=this.min,u=this.max;return[[s[0],s[1],s[2]],[u[0],s[1],s[2]],[u[0],u[1],s[2]],[s[0],u[1],s[2]],[s[0],s[1],u[2]],[u[0],s[1],u[2]],[u[0],u[1],u[2]],[s[0],u[1],u[2]]]}intersects(s){return this.intersectsAabb(s.bounds)?Wi(s,this.getCorners()):0}intersectsFlat(s){return this.intersectsAabb(s.bounds)?Wi(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(s,u){return u||this.intersects(s)?Yn(s,this.getCorners()):0}intersectsPreciseFlat(s,u){return u||this.intersectsFlat(s)?Yn(s,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(s){for(let u=0;u<3;++u)if(this.min[u]>s.max[u]||s.min[u]>this.max[u])return!1;return!0}intersectsAabbXY(s){return!(this.min[0]>s.max[0]||s.min[0]>this.max[0]||this.min[1]>s.max[1]||s.min[1]>this.max[1])}encapsulate(s){for(let u=0;u<3;u++)this.min[u]=Math.min(this.min[u],s.min[u]),this.max[u]=Math.max(this.max[u],s.max[u])}encapsulatePoint(s){for(let u=0;u<3;u++)this.min[u]=Math.min(this.min[u],s[u]),this.max[u]=Math.max(this.max[u],s[u])}closestPoint(s){return[Math.max(Math.min(this.max[0],s[0]),this.min[0]),Math.max(Math.min(this.max[1],s[1]),this.min[1]),Math.max(Math.min(this.max[2],s[2]),this.min[2])]}}function In(h){return h*to/vd}gr(Sr,"Aabb");const ti=[new Sr([tl,tl,tl],[go,go,go]),new Sr([tl,tl,tl],[0,0,go]),new Sr([0,tl,tl],[go,0,go]),new Sr([tl,0,tl],[0,go,go]),new Sr([0,0,tl],[go,go,go])];function oi(h,s,u,p=!0){const v=De.vec3.scale([],h._camera.position,h.worldSize),m=[s,u,1,1];De.vec4.transformMat4(m,m,h.pixelMatrixInverse),De.vec4.scale(m,m,1/m[3]);const _=De.vec3.sub([],m,v),C=De.vec3.normalize([],_),O=h.globeMatrix,B=[O[12],O[13],O[14]],j=De.vec3.sub([],B,v),R=De.vec3.length(j),F=De.vec3.normalize([],j),M=h.worldSize/(2*Math.PI),I=De.vec3.dot(F,C),q=Math.asin(M/R);if(q<Math.acos(I)){if(!p)return null;const et=[],Be=[];De.vec3.scale(et,C,R/I),De.vec3.normalize(Be,De.vec3.sub(Be,et,j)),De.vec3.normalize(C,De.vec3.add(C,j,De.vec3.scale(C,Be,Math.tan(q)*R)))}const X=[];new Zr(v,C).closestPointOnSphere(B,M,X);const te=De.vec3.normalize([],Pa(O,0)),le=De.vec3.normalize([],Pa(O,1)),ue=De.vec3.normalize([],Pa(O,2)),ie=De.vec3.dot(te,X),fe=De.vec3.dot(le,X),ye=De.vec3.dot(ue,X),Se=xt(Math.asin(-fe/M));let Le=xt(Math.atan2(ie,ye));Le=h.center.lng+function(et,Be){const rt=(Be-et+180)%360-180;return rt<-180?rt+360:rt}(h.center.lng,Le);const Ie=Vc(Le),Me=ur(nl(Se),0,1);return new d(Ie,Me)}class ea{constructor(s,u,p){this.a=De.vec3.sub([],s,p),this.b=De.vec3.sub([],u,p),this.center=p;const v=De.vec3.normalize([],this.a),m=De.vec3.normalize([],this.b);this.angle=Math.acos(De.vec3.dot(v,m))}}function aa(h,s){if(h.angle===0)return null;let u;return u=h.a[s]===0?1/h.angle*.5*Math.PI:1/h.angle*Math.atan(h.b[s]/h.a[s]/Math.sin(h.angle)-1/Math.tan(h.angle)),u<0||u>1?null:function(p,v,m,_){const C=Math.sin(m);return p*(Math.sin((1-_)*m)/C)+v*(Math.sin(_*m)/C)}(h.a[s],h.b[s],h.angle,ur(u,0,1))+h.center[s]}function Ea(h){if(h.z<=1)return ti[h.z+2*h.y+h.x];const s=Ni(Mi(h));return Sr.fromPoints(s)}function Sa(h,s,u){return De.vec3.scale(h,h,1-u),De.vec3.scaleAndAdd(h,h,s,u)}function Is(h,s,u){for(const p of h)De.vec3.transformMat4(p,p,s),De.vec3.scale(p,p,u)}function Ds(h,s,u,p){const v=s/h.worldSize,m=h.globeMatrix;if(u.z<=1){const Ie=Ea(u).getCorners();return Is(Ie,m,v),Sr.fromPoints(Ie)}const _=Mi(u,p),C=Ni(_,to+In(h._tileCoverLift));Is(C,m,v);const O=Number.MAX_VALUE,B=[-O,-O,-O],j=[O,O,O];if(_.contains(h.center)){for(const et of C)De.vec3.min(j,j,et),De.vec3.max(B,B,et);B[2]=0;const Ie=h.point,Me=[Ie.x*v,Ie.y*v,0];return De.vec3.min(j,j,Me),De.vec3.max(B,B,Me),new Sr(j,B)}if(h._tileCoverLift>0){for(const Ie of C)De.vec3.min(j,j,Ie),De.vec3.max(B,B,Ie);return new Sr(j,B)}const R=[m[12]*v,m[13]*v,m[14]*v],F=_.getCenter(),M=ur(h.center.lat,-85.051129,ro),I=ur(F.lat,-85.051129,ro),q=Vc(h.center.lng),X=nl(M);let te=q-Vc(F.lng);const le=X-nl(I);te>.5?te-=1:te<-.5&&(te+=1);let ue=0;if(Math.abs(te)>Math.abs(le))ue=te>=0?1:3;else{ue=le>=0?0:2;const Ie=[m[4]*v,m[5]*v,m[6]*v],Me=-Math.sin(tt(le>=0?_.getSouth():_.getNorth()))*to;De.vec3.scaleAndAdd(R,R,Ie,Me)}const ie=C[ue],fe=C[(ue+1)%4],ye=new ea(ie,fe,R),Se=[aa(ye,0)||ie[0],aa(ye,1)||ie[1],aa(ye,2)||ie[2]],Le=Ro(h.zoom);if(Le>0){const Ie=function({x:et,y:Be,z:rt},st,nt,ct,ht){const vt=1/(1<<rt);let ut=et*vt,It=ut+vt,Wt=Be*vt,Rt=Wt+vt,mr=0;const dr=(ut+It)/2-ct;return dr>.5?mr=-1:dr<-.5&&(mr=1),ut=((ut+mr)*st-(ct*=st))*nt+ct,It=((It+mr)*st-ct)*nt+ct,Wt=(Wt*st-(ht*=st))*nt+ht,Rt=(Rt*st-ht)*nt+ht,[[ut,Rt,0],[It,Rt,0],[It,Wt,0],[ut,Wt,0]]}(u,s,h._pixelsPerMercatorPixel,q,X);for(let et=0;et<C.length;et++)Sa(C[et],Ie[et],Le);const Me=De.vec3.add([],Ie[ue],Ie[(ue+1)%4]);De.vec3.scale(Me,Me,.5),Sa(Se,Me,Le)}for(const Ie of C)De.vec3.min(j,j,Ie),De.vec3.max(B,B,Ie);return j[2]=Math.min(ie[2],fe[2]),De.vec3.min(j,j,Se),De.vec3.max(B,B,Se),new Sr(j,B)}function Mi({x:h,y:s,z:u},p=!1){const v=1/(1<<u),m=new Zn(il(h*v),s===(1<<u)-1&&p?-90:Vr((s+1)*v)),_=new Zn(il((h+1)*v),s===0&&p?90:Vr(s*v));return new _u(m,_)}function Ni(h,s=to){const u=tt(h.getNorth()),p=tt(h.getSouth()),v=Math.cos(u),m=Math.cos(p),_=Math.sin(u),C=Math.sin(p),O=h.getWest(),B=h.getEast();return[rl(m,C,O,s),rl(m,C,B,s),rl(v,_,B,s),rl(v,_,O,s)]}function wi(h,s,u,p){const v=1<<u.z,m=(h/hr+u.x)/v;return _h(Vr((s/hr+u.y)/v),il(m),p)}function zn({min:h,max:s}){return Av/Math.max(s[0]-h[0],s[1]-h[1],s[2]-h[2])}const sa=new Float64Array(16);function as(h){const s=zn(h),u=De.mat4.fromScaling(sa,[s,s,s]);return De.mat4.translate(u,u,De.vec3.negate([],h.min))}function ji(h){const s=De.mat4.fromTranslation(sa,h.min),u=1/zn(h);return De.mat4.scale(s,s,[u,u,u])}function $s(h){const s=hr/(2*Math.PI);return h/(2*Math.PI)/s}function Al(h,s){return hr/(512*Math.pow(2,h))*zn(Ea(s))}function bs(h,s,u,p,v){const m=$s(u),_=[h,s,-u/(2*Math.PI)],C=De.mat4.identity(new Float64Array(16));return De.mat4.translate(C,C,_),De.mat4.scale(C,C,[m,m,m]),De.mat4.rotateX(C,C,tt(-v)),De.mat4.rotateY(C,C,tt(-p)),C}function Ro(h){return tn(yd,Zp,h)}function Io(h,s){const u=_h(s.lat,s.lng),p=function(m){const _=_h(m._center.lat,m._center.lng),C=De.vec3.fromValues(0,1,0);let O=De.vec3.cross([],C,_);const B=De.mat4.fromRotation([],-m.angle,_);O=De.vec3.transformMat4(O,O,B),De.mat4.fromRotation(B,-m._pitch,O);const j=De.vec3.normalize([],_);return De.vec3.scale(j,j,In(m.cameraToCenterDistance/m.pixelsPerMeter)),De.vec3.transformMat4(j,j,B),De.vec3.add([],_,j)}(h),v=De.vec3.subtract([],p,u);return De.vec3.angle(v,u)}function Tl(h,s){return Io(h,s)>Math.PI/2*1.01}const Oi=tt(85),wh=Math.cos(Oi),dc=Math.sin(Oi),Sh=De.mat4.create(),Of=h=>{const s=[];return h.paint.get("circle-pitch-alignment")==="map"&&s.push("PITCH_WITH_MAP"),h.paint.get("circle-pitch-scale")==="map"&&s.push("SCALE_WITH_MAP"),s};function Jp(h,s,u,p,v,m,_,C,O){if(m&&h.queryGeometry.isAboveHorizon)return!1;m&&(O*=h.pixelToTileUnitsFactor);const B=h.tileID.canonical,j=u.projection.upVectorScale(B,u.center.lat,u.worldSize).metersToTile;for(const R of s)for(const F of R){const M=F.add(C),I=v&&u.elevation?u.elevation.exaggeration()*v.getElevationAt(M.x,M.y,!0):0,q=u.projection.projectTilePoint(M.x,M.y,B);if(I>0){const ue=u.projection.upVector(B,M.x,M.y);q.x+=ue[0]*j*I,q.y+=ue[1]*j*I,q.z+=ue[2]*j*I}const X=m?M:vg(q.x,q.y,q.z,p),te=m?h.tilespaceRays.map(ue=>X_(ue,I)):h.queryGeometry.screenGeometry,le=De.vec4.transformMat4([],[q.x,q.y,q.z,1],p);if(!_&&m?O*=le[3]/u.cameraToCenterDistance:_&&!m&&(O*=u.cameraToCenterDistance/le[3]),m){const ue=Vr((F.y/hr+B.y)/(1<<B.z));O/=u.projection.pixelsPerMeter(ue,1)/Gi(1,ue)}if(we(te,X,O))return!0}return!1}function vg(h,s,u,p){const v=De.vec4.transformMat4([],[h,s,u,1],p);return new At(v[0]/v[3],v[1]/v[3])}const L2=De.vec3.fromValues(0,0,0),Uc=De.vec3.fromValues(0,0,1);function X_(h,s){const u=De.vec3.create();return L2[2]=s,h.intersectsPlane(L2,Uc,u),new At(u[0],u[1])}class z2 extends _e{}let Ah,Yy,Rf,Xy;function Tv(h,{width:s,height:u},p,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==s*u*p)throw new RangeError("mismatched image size")}else v=new Uint8Array(s*u*p);return h.width=s,h.height=u,h.data=v,h}function Pv(h,s,u){const{width:p,height:v}=s;p===h.width&&v===h.height||(J_(h,s,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,p),height:Math.min(h.height,v)},u,null),h.width=p,h.height=v,h.data=s.data)}function J_(h,s,u,p,v,m,_,C){if(v.width===0||v.height===0)return s;if(v.width>h.width||v.height>h.height||u.x>h.width-v.width||u.y>h.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>s.width||v.height>s.height||p.x>s.width-v.width||p.y>s.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const O=h.data,B=s.data,j=m===4&&C;for(let R=0;R<v.height;R++){const F=((u.y+R)*h.width+u.x)*m,M=((p.y+R)*s.width+p.x)*m;if(j)for(let I=0;I<v.width;I++){const q=F+I*m+3,X=M+I*m;B[X+0]=255,B[X+1]=255,B[X+2]=255,B[X+3]=O[q]}else if(_)for(let I=0;I<v.width;I++){const q=F+I*m,X=M+I*m,te=O[q+3],le=new Qn(O[q+0]/255*te,O[q+1]/255*te,O[q+2]/255*te,te).toRenderColor(_).toArray();B[X+0]=le[0],B[X+1]=le[1],B[X+2]=le[2],B[X+3]=le[3]}else for(let I=0;I<v.width*m;I++)B[M+I]=O[F+I]}return s}gr(z2,"HeatmapBucket",{omit:["layers"]});class xd{constructor(s,u){Tv(this,s,1,u)}resize(s){Pv(this,new xd(s),1)}clone(){return new xd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,p,v,m){J_(s,u,p,v,m,1,null)}}class qs{constructor(s,u){Tv(this,s,4,u)}resize(s){Pv(this,new qs(s),4)}replace(s,u){u?this.data.set(s):this.data=s instanceof Uint8ClampedArray?new Uint8Array(s.buffer):s}clone(){return new qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(s,u,p,v,m,_,C){J_(s,u,p,v,m,4,_,C)}}class Q_{constructor(s,u){this.width=s.width,this.height=s.height,this.data=u instanceof Uint8Array?new Float32Array(u.buffer):u}}function xg(h){const s={},u=h.resolution||256,p=h.clips?h.clips.length:1,v=h.image||new qs({width:u,height:p}),m=(_,C,O)=>{s[h.evaluationKey]=O;const B=h.expression.evaluate(s);B&&(v.data[_+C+0]=Math.floor(255*B.r/B.a),v.data[_+C+1]=Math.floor(255*B.g/B.a),v.data[_+C+2]=Math.floor(255*B.b/B.a),v.data[_+C+3]=Math.floor(255*B.a))};if(h.clips)for(let _=0,C=0;_<p;++_,C+=4*u)for(let O=0,B=0;O<u;O++,B+=4){const j=O/(u-1),{start:R,end:F}=h.clips[_];m(C,B,R*(1-j)+F*j)}else for(let _=0,C=0;_<u;_++,C+=4)m(0,C,_/(u-1));return v}gr(xd,"AlphaImage"),gr(qs,"RGBAImage");const Nv=ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:jv}=Nv;function _g(h,s,u=2){const p=s&&s.length,v=p?s[0]*u:h.length;let m=Cv(h,0,v,u,!0);const _=[];if(!m||m.next===m.prev)return _;let C,O,B;if(p&&(m=function(j,R,F,M){const I=[];for(let q=0,X=R.length;q<X;q++){const te=Cv(j,R[q]*M,q<X-1?R[q+1]*M:j.length,M,!1);te===te.next&&(te.steiner=!0),I.push(Jy(te))}I.sort(F2);for(let q=0;q<I.length;q++)F=DN(I[q],F);return F}(h,s,m,u)),h.length>80*u){C=1/0,O=1/0;let j=-1/0,R=-1/0;for(let F=u;F<v;F+=u){const M=h[F],I=h[F+1];M<C&&(C=M),I<O&&(O=I),M>j&&(j=M),I>R&&(R=I)}B=Math.max(j-C,R-O),B=B!==0?32767/B:0}return bg(m,_,u,C,O,B,0),_}function Cv(h,s,u,p,v){let m;if(v===function(_,C,O,B){let j=0;for(let R=C,F=O-B;R<O;R+=B)j+=(_[F]-_[R])*(_[R+1]+_[F+1]),F=R;return j}(h,s,u,p)>0)for(let _=s;_<u;_+=p)m=yt(_/p|0,h[_],h[_+1],m);else for(let _=u-p;_>=s;_-=p)m=yt(_/p|0,h[_],h[_+1],m);return m&&T(m,m.next)&&(Nt(m),m=m.next),m}function Qp(h,s){if(!h)return h;s||(s=h);let u,p=h;do if(u=!1,p.steiner||!T(p,p.next)&&b(p.prev,p,p.next)!==0)p=p.next;else{if(Nt(p),p=s=p.prev,p===p.next)break;u=!0}while(u||p!==s);return s}function bg(h,s,u,p,v,m,_){if(!h)return;!_&&m&&function(O,B,j,R){let F=O;do F.z===0&&(F.z=rb(F.x,F.y,B,j,R)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==O);F.prevZ.nextZ=null,F.prevZ=null,function(M){let I,q=1;do{let X,te=M;M=null;let le=null;for(I=0;te;){I++;let ue=te,ie=0;for(let ye=0;ye<q&&(ie++,ue=ue.nextZ,ue);ye++);let fe=q;for(;ie>0||fe>0&&ue;)ie!==0&&(fe===0||!ue||te.z<=ue.z)?(X=te,te=te.nextZ,ie--):(X=ue,ue=ue.nextZ,fe--),le?le.nextZ=X:M=X,X.prevZ=le,le=X;te=ue}le.nextZ=null,q*=2}while(I>1)}(F)}(h,p,v,m);let C=h;for(;h.prev!==h.next;){const O=h.prev,B=h.next;if(m?kv(h,p,v,m):eb(h))s.push(O.i,h.i,B.i),Nt(h),h=B.next,C=B.next;else if((h=B)===C){_?_===1?bg(h=tb(Qp(h),s),s,u,p,v,m,2):_===2&&Ev(h,s,u,p,v,m):bg(Qp(h),s,u,p,v,m,1);break}}}function eb(h){const s=h.prev,u=h,p=h.next;if(b(s,u,p)>=0)return!1;const v=s.x,m=u.x,_=p.x,C=s.y,O=u.y,B=p.y,j=v<m?v<_?v:_:m<_?m:_,R=C<O?C<B?C:B:O<B?O:B,F=v>m?v>_?v:_:m>_?m:_,M=C>O?C>B?C:B:O>B?O:B;let I=p.next;for(;I!==s;){if(I.x>=j&&I.x<=F&&I.y>=R&&I.y<=M&&wg(v,C,m,O,_,B,I.x,I.y)&&b(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function kv(h,s,u,p){const v=h.prev,m=h,_=h.next;if(b(v,m,_)>=0)return!1;const C=v.x,O=m.x,B=_.x,j=v.y,R=m.y,F=_.y,M=C<O?C<B?C:B:O<B?O:B,I=j<R?j<F?j:F:R<F?R:F,q=C>O?C>B?C:B:O>B?O:B,X=j>R?j>F?j:F:R>F?R:F,te=rb(M,I,s,u,p),le=rb(q,X,s,u,p);let ue=h.prevZ,ie=h.nextZ;for(;ue&&ue.z>=te&&ie&&ie.z<=le;){if(ue.x>=M&&ue.x<=q&&ue.y>=I&&ue.y<=X&&ue!==v&&ue!==_&&wg(C,j,O,R,B,F,ue.x,ue.y)&&b(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,ie.x>=M&&ie.x<=q&&ie.y>=I&&ie.y<=X&&ie!==v&&ie!==_&&wg(C,j,O,R,B,F,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0))return!1;ie=ie.nextZ}for(;ue&&ue.z>=te;){if(ue.x>=M&&ue.x<=q&&ue.y>=I&&ue.y<=X&&ue!==v&&ue!==_&&wg(C,j,O,R,B,F,ue.x,ue.y)&&b(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;ie&&ie.z<=le;){if(ie.x>=M&&ie.x<=q&&ie.y>=I&&ie.y<=X&&ie!==v&&ie!==_&&wg(C,j,O,R,B,F,ie.x,ie.y)&&b(ie.prev,ie,ie.next)>=0)return!1;ie=ie.nextZ}return!0}function tb(h,s){let u=h;do{const p=u.prev,v=u.next.next;!T(p,v)&&U(p,u,u.next,v)&&ge(p,v)&&ge(v,p)&&(s.push(p.i,u.i,v.i),Nt(u),Nt(u.next),u=h=v),u=u.next}while(u!==h);return Qp(u)}function Ev(h,s,u,p,v,m){let _=h;do{let C=_.next.next;for(;C!==_.prev;){if(_.i!==C.i&&Ov(_,C)){let O=Ue(_,C);return _=Qp(_,_.next),O=Qp(O,O.next),bg(_,s,u,p,v,m,0),void bg(O,s,u,p,v,m,0)}C=C.next}_=_.next}while(_!==h)}function F2(h,s){return h.x-s.x}function DN(h,s){const u=function(v,m){let _=m;const C=v.x,O=v.y;let B,j=-1/0;do{if(O<=_.y&&O>=_.next.y&&_.next.y!==_.y){const q=_.x+(O-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(q<=C&&q>j&&(j=q,B=_.x<_.next.x?_:_.next,q===C))return B}_=_.next}while(_!==m);if(!B)return null;const R=B,F=B.x,M=B.y;let I=1/0;_=B;do{if(C>=_.x&&_.x>=F&&C!==_.x&&wg(O<M?C:j,O,F,M,O<M?j:C,O,_.x,_.y)){const q=Math.abs(O-_.y)/(C-_.x);ge(_,v)&&(q<I||q===I&&(_.x>B.x||_.x===B.x&&Mv(B,_)))&&(B=_,I=q)}_=_.next}while(_!==R);return B}(h,s);if(!u)return s;const p=Ue(u,h);return Qp(p,p.next),Qp(u,u.next)}function Mv(h,s){return b(h.prev,h,s.prev)<0&&b(s.next,h,h.next)<0}function rb(h,s,u,p,v){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-u)*v|0)|h<<8))|h<<4))|h<<2))|h<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-p)*v|0)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Jy(h){let s=h,u=h;do(s.x<u.x||s.x===u.x&&s.y<u.y)&&(u=s),s=s.next;while(s!==h);return u}function wg(h,s,u,p,v,m,_,C){return(v-_)*(s-C)>=(h-_)*(m-C)&&(h-_)*(p-C)>=(u-_)*(s-C)&&(u-_)*(m-C)>=(v-_)*(p-C)}function Ov(h,s){return h.next.i!==s.i&&h.prev.i!==s.i&&!function(u,p){let v=u;do{if(v.i!==u.i&&v.next.i!==u.i&&v.i!==p.i&&v.next.i!==p.i&&U(v,v.next,u,p))return!0;v=v.next}while(v!==u);return!1}(h,s)&&(ge(h,s)&&ge(s,h)&&function(u,p){let v=u,m=!1;const _=(u.x+p.x)/2,C=(u.y+p.y)/2;do v.y>C!=v.next.y>C&&v.next.y!==v.y&&_<(v.next.x-v.x)*(C-v.y)/(v.next.y-v.y)+v.x&&(m=!m),v=v.next;while(v!==u);return m}(h,s)&&(b(h.prev,h,s.prev)||b(h,s.prev,s))||T(h,s)&&b(h.prev,h,h.next)>0&&b(s.prev,s,s.next)>0)}function b(h,s,u){return(s.y-h.y)*(u.x-s.x)-(s.x-h.x)*(u.y-s.y)}function T(h,s){return h.x===s.x&&h.y===s.y}function U(h,s,u,p){const v=de(b(h,s,u)),m=de(b(h,s,p)),_=de(b(u,p,h)),C=de(b(u,p,s));return v!==m&&_!==C||!(v!==0||!J(h,u,s))||!(m!==0||!J(h,p,s))||!(_!==0||!J(u,h,p))||!(C!==0||!J(u,s,p))}function J(h,s,u){return s.x<=Math.max(h.x,u.x)&&s.x>=Math.min(h.x,u.x)&&s.y<=Math.max(h.y,u.y)&&s.y>=Math.min(h.y,u.y)}function de(h){return h>0?1:h<0?-1:0}function ge(h,s){return b(h.prev,h,h.next)<0?b(h,s,h.next)>=0&&b(h,h.prev,s)>=0:b(h,s,h.prev)<0||b(h,h.next,s)<0}function Ue(h,s){const u=Jt(h.i,h.x,h.y),p=Jt(s.i,s.x,s.y),v=h.next,m=s.prev;return h.next=s,s.prev=h,u.next=v,v.prev=u,p.next=u,u.prev=p,m.next=p,p.prev=m,p}function yt(h,s,u,p){const v=Jt(h,s,u);return p?(v.next=p.next,v.prev=p,p.next.prev=v,p.next=v):(v.prev=v,v.next=v),v}function Nt(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function Jt(h,s,u){return{i:h,x:s,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Tr(h,s){const u=h.length;if(u<=1)return[h];const p=[];let v,m;for(let _=0;_<u;_++){const C=Uu(h[_]);C!==0&&(h[_].area=Math.abs(C),m===void 0&&(m=C<0),m===C<0?(v&&p.push(v),v=[h[_]]):v.push(h[_]))}if(v&&p.push(v),s>1)for(let _=0;_<p.length;_++)p[_].length<=s||(xp(p[_],s,1,p[_].length-1,Mr),p[_]=p[_].slice(0,s));return p}function Mr(h,s){return s.area-h.area}function Pr(h,s,u=1){if(!h)return null;const p=typeof h=="string"?h:h.getPrimary().id;s[p]||(s[p]=[]);const v=Ms.from(p).getPrimary().scaleSelf(u);return s[p].push(v),v.serialize()}function Qr(h,s,u,p){const v=p.patternDependencies;let m=!1;for(const _ of s){const C=_.paint.get(`${h}-pattern`);C.isConstant()||(m=!0),Pr(C.constantOr(null),v,u)&&(m=!0)}return m}function cn(h,s,u,p,v,m){const _=m.patternDependencies;for(const C of s){const O=C.paint.get(`${h}-pattern`).value;if(O.kind!=="constant"){let B=O.evaluate({zoom:p},u,{},m.availableImages);B=B&&B.name?B.name:B;const j=Pr(B,_,v);j&&(u.patterns[C.id]=j)}}return u}class dn{constructor(s){this.zoom=s.zoom,this.pixelRatio=s.pixelRatio,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Mo,this.indexArray=new _s,this.indexArray2=new Rs,this.programConfigurations=new xu(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new va,this.segments2=new va,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=s.projection}updateFootprints(s,u){}populate(s,u,p,v){this.hasPattern=Qr("fill",this.layers,this.pixelRatio,u);const m=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:C,id:O,index:B,sourceLayerIndex:j}of s){const R=this.layers[0]._featureFilter.needGeometry,F=re(C,R);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),F,p))continue;const M=m?m.evaluate(F,{},p,u.availableImages):void 0,I={id:O,properties:C.properties,type:C.type,sourceLayerIndex:j,index:B,geometry:R?F.geometry:Y(C,p,v),patterns:{},sortKey:M};_.push(I)}m&&_.sort((C,O)=>C.sortKey-O.sortKey);for(const C of _){const{geometry:O,index:B,sourceLayerIndex:j}=C;if(this.hasPattern){const R=cn("fill",this.layers,C,this.zoom,this.pixelRatio,u);this.patternFeatures.push(R)}else this.addFeature(C,O,B,p,{},u.availableImages,u.brightness,u.elevationFeatures);u.featureIndex.insert(s[B].feature,O,B,j,this.index)}}update(s,u,p,v,m,_,C){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,C)}addFeatures(s,u,p,v,m,_){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,u,p,v,_,s.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jv),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.indexBuffer2=s.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(s,u,p,v,m,_=[],C,O){for(const B of Tr(u,500)){let j=0;for(const X of B)j+=X.length;const R=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),F=R.vertexLength,M=[],I=[];for(const X of B){if(X.length===0)continue;X!==B[0]&&I.push(M.length/2);const te=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),le=te.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(le+X.length-1,le),M.push(X[0].x),M.push(X[0].y);for(let ue=1;ue<X.length;ue++)this.layoutVertexArray.emplaceBack(X[ue].x,X[ue].y),this.indexArray2.emplaceBack(le+ue-1,le+ue),M.push(X[ue].x),M.push(X[ue].y);te.vertexLength+=X.length,te.primitiveLength+=X.length}const q=_g(M,I);for(let X=0;X<q.length;X+=3)this.indexArray.emplaceBack(F+q[X],F+q[X+1],F+q[X+2]);R.vertexLength+=j,R.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,_,v,C)}}let ws,qt,Ot,Kt;gr(dn,"FillBucket",{omit:["layers","patternFeatures"]});class Ir{constructor(s,u,p,v){if(this.triangleCount=u.length/3,this.min=new At(0,0),this.max=new At(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||s.length===0)return;const[m,_]=[s[0].clone(),s[0].clone()];for(let R=1;R<s.length;++R){const F=s[R];m.x=Math.min(m.x,F.x),m.y=Math.min(m.y,F.y),_.x=Math.max(_.x,F.x),_.y=Math.max(_.y,F.y)}if(v){const R=Math.ceil(Math.max(_.x-m.x,_.y-m.y)/v);p=Math.max(p,R)}if(p===0)return;this.min=m,this.max=_;const C=this.max.sub(this.min);C.x=Math.max(C.x,1),C.y=Math.max(C.y,1);const O=Math.max(C.x,C.y)/p;this.cellsX=Math.max(1,Math.ceil(C.x/O)),this.cellsY=Math.max(1,Math.ceil(C.y/O)),this.xScale=1/O,this.yScale=1/O;const B=[];for(let R=0;R<this.triangleCount;R++){const F=s[u[3*R+0]].sub(this.min),M=s[u[3*R+1]].sub(this.min),I=s[u[3*R+2]].sub(this.min),q=nn(Math.floor(Math.min(F.x,M.x,I.x)),this.xScale,this.cellsX),X=nn(Math.floor(Math.max(F.x,M.x,I.x)),this.xScale,this.cellsX),te=nn(Math.floor(Math.min(F.y,M.y,I.y)),this.yScale,this.cellsY),le=nn(Math.floor(Math.max(F.y,M.y,I.y)),this.yScale,this.cellsY),ue=new At(0,0),ie=new At(0,0),fe=new At(0,0),ye=new At(0,0);for(let Se=te;Se<=le;++Se){ue.y=ie.y=Se*O,fe.y=ye.y=(Se+1)*O;for(let Le=q;Le<=X;++Le)ue.x=fe.x=Le*O,ie.x=ye.x=(Le+1)*O,(pt(F,M,I,ue,ie,ye)||pt(F,M,I,ue,ye,fe))&&B.push({cellIdx:Se*this.cellsX+Le,triIdx:R})}}if(B.length===0)return;B.sort((R,F)=>R.cellIdx-F.cellIdx||R.triIdx-F.triIdx);let j=0;for(;j<B.length;){const R=B[j].cellIdx,F={start:this.payload.length,len:0};for(;j<B.length&&B[j].cellIdx===R;)++F.len,this.payload.push(B[j++].triIdx);this.cells[R]=F}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(s,u){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>s.x||s.y>this.max.y||this.min.y>s.y)return;const p=nn(s.x-this.min.x,this.xScale,this.cellsX),v=nn(s.y-this.min.y,this.yScale,this.cellsY),m=this.cells[v*this.cellsX+p];if(m){this._lazyInitLookup();for(let _=0;_<m.len;_++){const C=this.payload[m.start+_],O=Math.floor(C/8),B=1<<C%8;if(!(this.lookup[O]&B)&&(this.lookup[O]|=B,u.push(C),u.length===this.triangleCount))return}}}query(s,u,p){if(this.triangleCount===0||this.cells.length===0||s.x>this.max.x||this.min.x>u.x||s.y>this.max.y||this.min.y>u.y)return;this._lazyInitLookup();const v=nn(s.x-this.min.x,this.xScale,this.cellsX),m=nn(u.x-this.min.x,this.xScale,this.cellsX),_=nn(s.y-this.min.y,this.yScale,this.cellsY),C=nn(u.y-this.min.y,this.yScale,this.cellsY);for(let O=_;O<=C;O++)for(let B=v;B<=m;B++){const j=this.cells[O*this.cellsX+B];if(j)for(let R=0;R<j.len;R++){const F=this.payload[j.start+R],M=Math.floor(F/8),I=1<<F%8;if(!(this.lookup[M]&I)&&(this.lookup[M]|=I,p.push(F),p.length===this.triangleCount))return}}}}function nn(h,s,u){return Math.max(0,Math.min(u-1,Math.floor(h*s)))}gr(Ir,"TriangleGridIndex");class Fn{constructor(s){this.zoom=s.zoom,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.footprints=[]}updateFootprints(s,u){for(const p of this.footprints)u.push({footprint:p,id:s})}populate(s,u,p,v){const m=[];for(const{feature:_,id:C,index:O,sourceLayerIndex:B}of s){const j=this.layers[0]._featureFilter.needGeometry,R=re(_,j);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),R,p))continue;const F={id:C,properties:_.properties,type:_.type,sourceLayerIndex:B,index:O,geometry:j?R.geometry:Y(_,p,v),patterns:{}};m.push(F)}for(const _ of m){const{geometry:C,index:O,sourceLayerIndex:B}=_;this.addFeature(_,C,O,p,{},u.availableImages,u.brightness),u.featureIndex.insert(s[O].feature,C,O,B,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(s){}update(s,u,p,v,m,_,C){}destroy(){}addFeature(s,u,p,v,m,_=[],C){for(const O of Tr(u,2)){const B=[],j=[],R=[],F=new At(1/0,1/0),M=new At(-1/0,-1/0);for(const X of O)if(X.length!==0){X!==O[0]&&R.push(j.length/2);for(let te=0;te<X.length;te++)j.push(X[te].x),j.push(X[te].y),B.push(X[te]),F.x=Math.min(F.x,X[te].x),F.y=Math.min(F.y,X[te].y),M.x=Math.max(M.x,X[te].x),M.y=Math.max(M.y,X[te].y)}const I=_g(j,R),q=new Ir(B,I,8,256);this.footprints.push({vertices:B,indices:I,grid:q,min:F,max:M})}}}gr(Fn,"ClipBucket",{omit:["layers"]});const Vn=ei([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),li=ei([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),vo=ei([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Zi=ei([{name:"a_join_normal_inside",components:3,type:"Int16"}]),If=ei([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),LN=ei([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:jie}=Vn;var zN,h5,FN,f5,BN,p5,m5,B2={};function g5(){if(h5)return zN;h5=1;var h=Cr();function s(v,m,_,C,O){this.properties={},this.extent=_,this.type=0,this._pbf=v,this._geometry=-1,this._keys=C,this._values=O,v.readFields(u,this,m)}function u(v,m,_){v==1?m.id=_.readVarint():v==2?function(C,O){for(var B=C.readVarint()+C.pos;C.pos<B;){var j=O._keys[C.readVarint()],R=O._values[C.readVarint()];O.properties[j]=R}}(_,m):v==3?m.type=_.readVarint():v==4&&(m._geometry=_.pos)}function p(v){for(var m,_,C=0,O=0,B=v.length,j=B-1;O<B;j=O++)C+=((_=v[j]).x-(m=v[O]).x)*(m.y+_.y);return C}return zN=s,s.types=["Unknown","Point","LineString","Polygon"],s.prototype.loadGeometry=function(){var v=this._pbf;v.pos=this._geometry;for(var m,_=v.readVarint()+v.pos,C=1,O=0,B=0,j=0,R=[];v.pos<_;){if(O<=0){var F=v.readVarint();C=7&F,O=F>>3}if(O--,C===1||C===2)B+=v.readSVarint(),j+=v.readSVarint(),C===1&&(m&&R.push(m),m=[]),m.push(new h(B,j));else{if(C!==7)throw new Error("unknown command "+C);m&&m.push(m[0].clone())}}return m&&R.push(m),R},s.prototype.bbox=function(){var v=this._pbf;v.pos=this._geometry;for(var m=v.readVarint()+v.pos,_=1,C=0,O=0,B=0,j=1/0,R=-1/0,F=1/0,M=-1/0;v.pos<m;){if(C<=0){var I=v.readVarint();_=7&I,C=I>>3}if(C--,_===1||_===2)(O+=v.readSVarint())<j&&(j=O),O>R&&(R=O),(B+=v.readSVarint())<F&&(F=B),B>M&&(M=B);else if(_!==7)throw new Error("unknown command "+_)}return[j,F,R,M]},s.prototype.toGeoJSON=function(v,m,_){var C,O,B=this.extent*Math.pow(2,_),j=this.extent*v,R=this.extent*m,F=this.loadGeometry(),M=s.types[this.type];function I(te){for(var le=0;le<te.length;le++){var ue=te[le];te[le]=[360*(ue.x+j)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+R)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(C=0;C<F.length;C++)q[C]=F[C][0];I(F=q);break;case 2:for(C=0;C<F.length;C++)I(F[C]);break;case 3:for(F=function(te){var le=te.length;if(le<=1)return[te];for(var ue,ie,fe=[],ye=0;ye<le;ye++){var Se=p(te[ye]);Se!==0&&(ie===void 0&&(ie=Se<0),ie===Se<0?(ue&&fe.push(ue),ue=[te[ye]]):ue.push(te[ye]))}return ue&&fe.push(ue),fe}(F),C=0;C<F.length;C++)for(O=0;O<F[C].length;O++)I(F[C][O])}F.length===1?F=F[0]:M="Multi"+M;var X={type:"Feature",geometry:{type:M,coordinates:F},properties:this.properties};return"id"in this&&(X.id=this.id),X},zN}function y5(){if(f5)return FN;f5=1;var h=g5();function s(p,v){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(u,this,v),this.length=this._features.length}function u(p,v,m){p===15?v.version=m.readVarint():p===1?v.name=m.readString():p===5?v.extent=m.readVarint():p===2?v._features.push(m.pos):p===3?v._keys.push(m.readString()):p===4&&v._values.push(function(_){for(var C=null,O=_.readVarint()+_.pos;_.pos<O;){var B=_.readVarint()>>3;C=B===1?_.readString():B===2?_.readFloat():B===3?_.readDouble():B===4?_.readVarint64():B===5?_.readVarint():B===6?_.readSVarint():B===7?_.readBoolean():null}return C}(m))}return FN=s,s.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var v=this._pbf.readVarint()+this._pbf.pos;return new h(this._pbf,v,this.extent,this._keys,this._values)},FN}function v5(){return m5||(m5=1,B2.VectorTile=function(){if(p5)return BN;p5=1;var h=y5();function s(u,p,v){if(u===3){var m=new h(v,v.readVarint()+v.pos);m.length&&(p[m.name]=m)}}return BN=function(u,p){this.layers=u.readFields(s,{},p)},BN}(),B2.VectorTileFeature=g5(),B2.VectorTileLayer=y5()),B2}var Rv=v5();class Qy extends At{constructor(s,u,p){super(s,u),this.z=p}}class x5 extends Qy{constructor(s,u,p,v){super(s,u,p),this.w=v}}function V2(h,s,u,p){const v=[],m=p===0?(_,C,O,B,j,R)=>{_.push(new At(R,O+(R-C)/(B-C)*(j-O)))}:(_,C,O,B,j,R)=>{_.push(new At(C+(R-O)/(j-O)*(B-C),R))};for(const _ of h){const C=[];for(const O of _){if(O.length<=2)continue;const B=[];for(let F=0;F<O.length-1;F++){const M=O[F].x,I=O[F].y,q=O[F+1].x,X=O[F+1].y,te=p===0?M:I,le=p===0?q:X;te<s?le>s&&m(B,M,I,q,X,s):te>u?le<u&&m(B,M,I,q,X,u):B.push(O[F]),le<s&&te>=s&&m(B,M,I,q,X,s),le>u&&te<=u&&m(B,M,I,q,X,u)}let j=O[O.length-1];const R=p===0?j.x:j.y;R>=s&&R<=u&&B.push(j),B.length&&(j=B[B.length-1],B[0].x===j.x&&B[0].y===j.y||B.push(B[0]),C.push(B))}C.length&&v.push(C)}return v}function _5(h,s,u,p){const v=u==="x"?"y":"x",m=(p-h[u])/(s[u]-h[u]);h[v]=h[v]+(s[v]-h[v])*m,h[u]=p,h.hasOwnProperty("z")&&(h.z=Fr(h.z,s.z,m)),h.hasOwnProperty("w")&&(h.w=Fr(h.w,s.w,m))}function b5(h,s,u,p){const v=u,m=p;for(const _ of["x","y"]){let C=h,O=s;C[_]>=O[_]&&(C=s,O=h),C[_]<v&&O[_]>v&&_5(C,O,_,v),C[_]<m&&O[_]>m&&_5(O,C,_,m)}}const U2=Number.MAX_SAFE_INTEGER;function w5(h,s,u,p){return h.order<s||h.order===U2||!(h.clipMask&u)||function(v,m){return m.length!==0&&m.find(_=>_===v)===void 0}(p,h.clipScope)}function $2(h,s){return h.x-s.x||h.y-s.y}function S5(h,s){return $2(h.min,s.min)===0&&$2(h.max,s.max)===0}function VN(h,s){return!(h.min.x>s.max.x||h.max.x<s.min.x||h.min.y>s.max.y||h.max.y<s.min.y)}function UN(h,s){if(h.length!==s.length)return!1;for(let u=0;u<h.length;u++)if(h[u].sourceId!==s[u].sourceId||!S5(h[u],s[u])||h[u].order!==s[u].order||h[u].clipMask!==s[u].clipMask||!qr(h[u].clipScope,s[u].clipScope))return!1;return!0}function A5(h,s,u){const p=1/hr,v=1/(1<<u.canonical.z),m=(s.x*p+u.canonical.x)*v+u.wrap,_=(s.y*p+u.canonical.y)*v;return{min:new At((h.x*p+u.canonical.x)*v+u.wrap,(h.y*p+u.canonical.y)*v),max:new At(m,_)}}function Cie(h,s,u){const p=1<<u.canonical.z,v=((s.x-u.wrap)*p-u.canonical.x)*hr,m=(s.y*p-u.canonical.y)*hr;return{min:new At(((h.x-u.wrap)*p-u.canonical.x)*hr,(h.y*p-u.canonical.y)*hr),max:new At(v,m)}}function T5(h,s,u,p,v,m,_){const C=h.indices,O=h.vertices,B=[];for(let j=p;j<p+v;j+=3){const R=s[u[j+0]+m],F=s[u[j+1]+m],M=s[u[j+2]+m],I=Math.min(R.x,F.x,M.x),q=Math.max(R.x,F.x,M.x),X=Math.min(R.y,F.y,M.y),te=Math.max(R.y,F.y,M.y);B.length=0,h.grid.query(new At(I,X),new At(q,te),B);for(let le=0;le<B.length;le++){const ue=B[le];if(pt(O[C[3*ue+0]],O[C[3*ue+1]],O[C[3*ue+2]],R,F,M,_))return!0}}return!1}function P5(h,s,u,p){if(!h||!u)return!1;let v=h.vertices;if(!s.canonical.equals(p.canonical)||s.wrap!==p.wrap){if(u.vertices.length<h.vertices.length)return P5(u,p,h,s);const m=s.canonical,_=p.canonical,C=Math.pow(2,_.z-m.z);v=h.vertices.map(O=>new At((O.x+m.x*hr)*C-_.x*hr,(O.y+m.y*hr)*C-_.y*hr))}return T5(u,v,h.indices,0,h.indices.length,0,0)}function N5(h,s,u,p){const v=Math.pow(2,p.z-u.z);return new At((h+u.x*hr)*v-p.x*hr,(s+u.y*hr)*v-p.y*hr)}function j5(h,s){const u=[];s.grid.queryPoint(h,u);const p=s.indices,v=s.vertices;for(let m=0;m<u.length;m++){const _=u[m];if(Ge([v[p[3*_+0]],v[p[3*_+1]],v[p[3*_+2]]],h))return!0}return!1}const $N=[new At(0,0),new At(hr,0),new At(hr,hr),new At(0,hr)];function C5(h,s){const u=[];let p=[];if(!s||h.length<2)return[h];if(h.length===2)return it(h[0],h[1],$N)?[h]:[];for(let v=0;v<h.length+2;v++){const m=h[v%h.length],_=h[(v+1)%h.length],C=it(v===0?h[h.length-1]:h[(v-1)%h.length],m,$N),O=it(m,_,$N),B=C||O;B&&p.push(m),B&&O||p.length>0&&(p.length>1&&u.push(p),p=[])}return p.length>1&&u.push(p),u}const qN=Rv.VectorTileFeature.types,kie=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Eie=["fill-extrusion-flood-light-ground-radius"],Mie=Math.pow(2,13),Oie=Math.pow(2,15)-1,k5=new At(0,1),Sg=2147483648;function nb(h,s,u,p,v,m,_,C){h.emplaceBack((s<<1)+_,(u<<1)+m,(Math.floor(p*Mie)<<1)+v,Math.round(C))}function ib(h,s,u){h.emplaceBack(s.x*hr,s.y*hr,u?1:0)}function q2(h,s,u,p,v,m){h.emplaceBack(s.x,s.y,(u.x<<1)+p,(u.y<<1)+v,m)}function ab(h,s,u){h.emplaceBack(s.x,s.y,s.z,u[0]*16384,u[1]*16384,u[2]*16384)}class E5{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class M5{constructor(){this.centroidXY=new At(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new At(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new At(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new At(this.max.x-this.min.x,this.max.y-this.min.y)}}class O5{constructor(){this.acc=new At(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(s,u){s.min.x===Number.MAX_VALUE&&(s.min.x=s.max.x=u.x,s.min.y=s.max.y=u.y)}appendEdge(s,u,p){this.accCount++,this.acc._add(u);let v=!!this.borders;u.x<s.min.x?(s.min.x=u.x,v=!0):u.x>s.max.x&&(s.max.x=u.x,v=!0),u.y<s.min.y?(s.min.y=u.y,v=!0):u.y>s.max.y&&(s.max.y=u.y,v=!0),((u.x===0||u.x===hr)&&u.x===p.x)!=((u.y===0||u.y===hr)&&u.y===p.y)&&this.processBorderOverlap(u,p),v&&this.checkBorderIntersection(u,p)}checkBorderIntersection(s,u){u.x<0!=s.x<0&&this.addBorderIntersection(0,Fr(u.y,s.y,(0-u.x)/(s.x-u.x))),u.x>hr!=s.x>hr&&this.addBorderIntersection(1,Fr(u.y,s.y,(hr-u.x)/(s.x-u.x))),u.y<0!=s.y<0&&this.addBorderIntersection(2,Fr(u.x,s.x,(0-u.y)/(s.y-u.y))),u.y>hr!=s.y>hr&&this.addBorderIntersection(3,Fr(u.x,s.x,(hr-u.y)/(s.y-u.y)))}addBorderIntersection(s,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[s];u<p[0]&&(p[0]=u),u>p[1]&&(p[1]=u)}processBorderOverlap(s,u){if(s.x===u.x){if(s.y===u.y)return;const p=s.x===0?0:1;this.addBorderIntersection(p,u.y),this.addBorderIntersection(p,s.y)}else{const p=s.y===0?2:3;this.addBorderIntersection(p,u.x),this.addBorderIntersection(p,s.x)}}centroid(){return this.accCount===0?new At(0,0):new At(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((s,u)=>s+ +(u[0]!==Number.MAX_VALUE),0):0}}function R5(h,s){const u=h.add(s)._unit(),p=ur(h.x*u.x+h.y*u.y,-1,1);var v,m,_;return _=Math.acos(p),Math.min(4,Math.max(-4,Math.tan(_)))/4*Oie*((v=h).x*(m=s).y-v.y*m.x<0?-1:1)}const Rie=[h=>h.x<0,h=>h.x>hr,h=>h.y<0,h=>h.y>hr];function Iie(h,s,u,p){const v=[4];if(p===0)return v;u._mult(p);const m=h.sub(u),_=s.sub(u),C=[h,s,m,_];for(let O=0;O<4;O++)for(const B of C)if(Rie[O](B)){v.push(O);break}return v}class I5{constructor(s){this.vertexArray=new ns,this.indexArray=new _s,this.programConfigurations=new xu(s.layers,{zoom:s.zoom,lut:s.lut},u=>Eie.includes(u)),this._segments=new va,this.hiddenByLandmarkVertexArray=new qp,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new va}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(s,u,p,v=!1){const m=s.length;if(m>2){let _=Math.max(0,this._segments.get().length-1);const C=this._segments._prepareSegment(4*m,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let O;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const B=s[0],j=s[1];O=R5(B.sub(s[m-1])._perp()._unit(),j.sub(B)._perp()._unit())}for(let B=0;B<m;B++){const j=B===m-1?0:B+1,R=s[B],F=s[j],M=s[j===m-1?0:j+1],I=F.sub(R)._perp()._unit(),q=R5(I,M.sub(F)._perp()._unit()),X=O,te=q;if(GN(R,F,u)||v&&z5(R,u)&&z5(F,u)){O=q;continue}const le=C.vertexLength;q2(this.vertexArray,R,F,1,1,X),q2(this.vertexArray,R,F,1,0,X),q2(this.vertexArray,R,F,0,1,te),q2(this.vertexArray,R,F,0,0,te),C.vertexLength+=4;const ue=Iie(R,F,I,p);for(const ie of ue)this._segmentToGroundQuads[_].push({id:le,region:ie}),this._segmentToRegionTriCounts[_][ie]+=2,C.primitiveLength+=2;O=q}}}prepareBorderSegments(){if(!this.hasData())return;const s=this._segments.get(),u=s.length;for(let p=0;p<u;p++)this._segmentToGroundQuads[p].sort((v,m)=>v.region-m.region);for(let p=0;p<u;p++){const v=this._segmentToGroundQuads[p],m=s[p],_=this._segmentToRegionTriCounts[p];_.reduce((O,B)=>O+B,0);let C=0;for(let O=0;O<=4;O++){const B=_[O];if(B!==0){let j=this.regionSegments[O];j||(j=this.regionSegments[O]=new va);const R={vertexOffset:m.vertexOffset,primitiveOffset:m.primitiveOffset+C,vertexLength:m.vertexLength,primitiveLength:B};j.get().push(R)}C+=B}for(let O=0;O<v.length;O++){const B=v[O].id;this.indexArray.emplaceBack(B,B+1,B+3),this.indexArray.emplaceBack(B,B+3,B+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(s,u,p,v,m,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,s,u,p,v,m,_)}upload(s){this.hasData()&&(this.vertexBuffer=s.createVertexBuffer(this.vertexArray,li.members),this.indexBuffer=s.createIndexBuffer(this.indexArray))}uploadPaintProperties(s){this.hasData()&&this.programConfigurations.upload(s)}update(s,u,p,v,m,_,C){this.hasData()&&this.programConfigurations.updatePaintArrays(s,u,p,v,m,_,C)}updateHiddenByLandmark(s){if(!this.hasData())return;const u=s.groundVertexCount+s.groundVertexArrayOffset;if(s.groundVertexCount===0)return;const p=s.flags&Sg?1:0;for(let v=s.groundVertexArrayOffset;v<u;++v)this.hiddenByLandmarkVertexArray.emplace(v,p);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(s){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=s.createVertexBuffer(this.hiddenByLandmarkVertexArray,If.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let s=0;s<=4;s++){const u=this.regionSegments[s];u&&u.destroy()}}}}class G2{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.overscaling=s.overscaling,this.layers=s.layers,this.pixelRatio=s.pixelRatio,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=s.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new _s,this.footprintVertices=new Mo,this.footprintSegments=[],this.layoutVertexArray=new ua,this.centroidVertexArray=new Oo,this.wallVertexArray=new Gy,this.indexArray=new _s,this.programConfigurations=new xu(s.layers,{zoom:s.zoom,lut:s.lut},u=>kie.includes(u)),this.segments=new va,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.groundEffect=new I5(s),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(s,u){}populate(s,u,p,v){this.features=[],this.hasPattern=Qr("fill-extrusion",this.layers,this.pixelRatio,u),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=o(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:m,id:_,index:C,sourceLayerIndex:O}of s){const B=this.layers[0]._featureFilter.needGeometry,j=re(m,B);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),j,p))continue;const R={id:_,sourceLayerIndex:O,index:C,geometry:B?j.geometry:Y(m,p,v),properties:m.properties,type:m.type,patterns:{}},F=this.layoutVertexArray.length,M=qN[R.type]==="Polygon";if(this.hasPattern)this.features.push(cn("fill-extrusion",this.layers,R,this.zoom,this.pixelRatio,u));else if(this.wallMode)for(const I of R.geometry)for(const q of C5(I,M))this.addFeature(R,[q],C,p,{},u.availableImages,v,u.brightness);else this.addFeature(R,R.geometry,C,p,{},u.availableImages,v,u.brightness);u.featureIndex.insert(m,R.geometry,C,O,this.index,F)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(s,u,p,v,m,_){for(const C of this.features){const O=qN[C.type]==="Polygon",{geometry:B}=C;if(this.wallMode)for(const j of B)for(const R of C5(j,O))this.addFeature(C,[R],C.index,u,p,v,m,_);else this.addFeature(C,B,C.index,u,p,v,m,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(s,u,p,v,m,_,C){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,C),this.groundEffect.update(s,u,m,p,v,_,C)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,jie),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.wallVertexBuffer=s.createVertexBuffer(this.wallVertexArray,Zi.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=s.createVertexBuffer(this.layoutVertexExtArray,LN.members,!0)),this.groundEffect.upload(s)),this.groundEffect.uploadPaintProperties(s),this.programConfigurations.upload(s),this.uploaded=!0}uploadCentroid(s){this.groundEffect.uploadHiddenByLandmark(s),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=s.createVertexBuffer(this.centroidVertexArray,vo.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(s,u,p,v,m,_,C,O){const B=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(s,{})/this.tileToMeter,j=[new At(0,0),new At(hr,hr)],R=C.projection,F=R.name==="globe",M=this.wallMode||qN[s.type]==="Polygon",I=new O5;I.centroidDataIndex=this.centroidData.length;const q=new M5,X=this.layers[0].paint.get("fill-extrusion-base").evaluate(s,{},v)<=0,te=this.layers[0].paint.get("fill-extrusion-height").evaluate(s,{},v);let le;if(q.height=te,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new xs),this.wallMode){if(F)return void sn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(u.length!==1)return;le=function(Me){const et=Me[0].x===Me[Me.length-1].x&&Me[0].y===Me[Me.length-1].y;(function(tr){let Ht=0;const kr=tr.length;for(let vr=0;vr<kr;vr++)Ht+=(tr[(vr+1)%kr].x-tr[vr].x)*(tr[(vr+1)%kr].y+tr[vr].y);return Ht>=0})(Me)||(Me=Me.reverse());const rt={geometry:[],joinNormals:[],indices:[]},st=[],nt=[],ct=[];let ht=Me.length;for(;ht>=2&&Me[ht-1].equals(Me[ht-2]);)ht--;if(ht<(et?3:2))return rt;let vt,ut,It,Wt,Rt,mr=0;for(;mr<ht-1&&Me[mr].equals(Me[mr+1]);)mr++;et&&(vt=Me[ht-2],Rt=Me[mr].sub(vt)._unit()._perp());for(let tr=mr;tr<ht;tr++){if(It=tr===ht-1?et?Me[mr+1]:void 0:Me[tr+1],It&&Me[tr].equals(It))continue;Rt&&(Wt=Rt),vt&&(ut=vt),vt=Me[tr],Rt=It?It.sub(vt)._unit()._perp():Wt,Wt=Wt||Rt;let Ht=Wt.add(Rt);Ht.x===0&&Ht.y===0||Ht._unit();const kr=Ht.x*Rt.x+Ht.y*Rt.y,vr=kr!==0?1/kr:1/0,br=Wt.x*Rt.y-Wt.y*Rt.x>0;let en="miter";const mn=2;en==="miter"&&vr>mn&&(en="bevel"),en==="bevel"&&(vr>100&&(en="flipbevel"),vr<mn&&(en="miter"));const _n=(bn,Ln,Bn,Li)=>{const Pi=new At(bn.x,bn.y),un=new At(bn.x,bn.y);Pi.x+=Ln.x*Li,Pi.y+=Ln.y*Li,un.x-=Ln.x*Math.max(Bn,1),un.y-=Ln.y*Math.max(Bn,1),ct.push(Ln),st.push(Pi),nt.push(un)};if(en==="miter")Ht._mult(vr),_n(vt,Ht,0,0);else if(en==="flipbevel")Ht=Rt.mult(-1),_n(vt,Ht,0,0),_n(vt,Ht.mult(-1),0,0);else{const bn=-Math.sqrt(vr*vr-1),Ln=br?bn:0,Bn=br?0:bn;ut&&_n(vt,Wt,Ln,Bn),It&&_n(vt,Rt,Ln,Bn)}}rt.geometry=[...st,...nt.reverse(),st[0]],rt.joinNormals=[...ct,...ct.reverse(),ct[ct.length-1]];const dr=rt.geometry.length-1;for(let tr=0;tr<dr/2;tr++)if(tr+1<dr/2){let Ht=tr,kr=tr+1,vr=dr-1-tr,br=dr-2-tr;Ht=Ht===0?dr-1:Ht-1,kr=kr===0?dr-1:kr-1,vr=vr===0?dr-1:vr-1,br=br===0?dr-1:br-1,rt.indices.push(vr),rt.indices.push(kr),rt.indices.push(Ht),rt.indices.push(vr),rt.indices.push(br),rt.indices.push(kr)}return rt}(u[0]),u=[le.geometry]}const ue=(Me,et)=>Me<(et.length-1)/2||Me===et.length-1,ie=this.wallMode?[u]:Tr(u,500);for(let Me=ie.length-1;Me>=0;Me--){const et=ie[Me];(et.length===0||(fe=et[0]).every(Be=>Be.x<=0)||fe.every(Be=>Be.x>=hr)||fe.every(Be=>Be.y<=0)||fe.every(Be=>Be.y>=hr))&&ie.splice(Me,1)}var fe;let ye;if(F)ye=U5(ie,j,v);else{ye=[];for(const Me of ie)ye.push({polygon:Me,bounds:j})}const Se=M?this.edgeRadius:0,Le=Se>0&&this.zoom<17,Ie=(Me,et)=>{if(Me.length===0)return!1;const Be=Me[Me.length-1];return et.x===Be.x&&et.y===Be.y};for(const{polygon:Me,bounds:et}of ye){let Be=0,rt=0;for(const ht of Me)M&&!ht[0].equals(ht[ht.length-1])&&ht.push(ht[0]),rt+=M?ht.length-1:ht.length;const st=this.segments.prepareSegment((M?5:4)*rt,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);const nt={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ct=new E5;if(ct.vertexOffset=this.footprintVertices.length,ct.indexOffset=3*this.footprintIndices.length,ct.ringIndices=[],M){const ht=[],vt=[];Be=st.vertexLength;for(let It=0;It<Me.length;It++){const Wt=Me[It];Wt.length&&It!==0&&vt.push(ht.length/2);const Rt=[];let mr,dr;mr=Wt[1].sub(Wt[0])._perp()._unit(),ct.ringIndices.push(Wt.length-1);for(let tr=1;tr<Wt.length;tr++){const Ht=Wt[tr],kr=Wt[tr===Wt.length-1?1:tr+1],vr=Ht.clone();if(Se){dr=kr.sub(Ht)._perp()._unit();const br=mr.add(dr)._unit(),en=Se*Math.min(4,1/(mr.x*br.x+mr.y*br.y));vr.x+=en*br.x,vr.y+=en*br.y,vr.x=Math.round(vr.x),vr.y=Math.round(vr.y),mr=dr}if(!X||Se!==0&&!Le||Ie(Rt,vr)||Rt.push(vr),nb(this.layoutVertexArray,vr.x,vr.y,0,0,1,1,0),this.wallMode){const br=ue(tr,Wt);ib(this.wallVertexArray,le.joinNormals[tr],!br)}st.vertexLength++,this.footprintVertices.emplaceBack(Ht.x,Ht.y),ht.push(Ht.x,Ht.y),F&&ab(this.layoutVertexExtArray,R.projectTilePoint(vr.x,vr.y,v),R.upVector(v,vr.x,vr.y))}X&&(Se===0||Le)&&(Rt.length!==0&&Ie(Rt,Rt[0])&&Rt.pop(),this.groundEffect.addData(Rt,et,B))}const ut=this.wallMode?le.indices:_g(ht,vt);for(let It=0;It<ut.length;It+=3)this.footprintIndices.emplaceBack(ct.vertexOffset+ut[It+0],ct.vertexOffset+ut[It+1],ct.vertexOffset+ut[It+2]),this.indexArray.emplaceBack(Be+ut[It],Be+ut[It+2],Be+ut[It+1]),st.primitiveLength++;ct.indexCount+=ut.length,ct.vertexCount+=this.footprintVertices.length-ct.vertexOffset}for(let ht=0;ht<Me.length;ht++){const vt=Me[ht];I.startRing(q,vt[0]);let ut=vt.length>4&&F5(vt[vt.length-2],vt[0],vt[1]),It=Se?Die(vt[vt.length-2],vt[0],vt[1],Se):0;const Wt=[];let Rt,mr,dr;mr=vt[1].sub(vt[0])._perp()._unit();let tr=!0;for(let Ht=1,kr=0;Ht<vt.length;Ht++){let vr=vt[Ht-1],br=vt[Ht];const en=vt[Ht===vt.length-1?1:Ht+1];if(I.appendEdge(q,br,vr),GN(br,vr,et)){Se&&(mr=en.sub(br)._perp()._unit(),tr=!tr);continue}const mn=br.sub(vr)._perp(),_n=mn.x/(Math.abs(mn.x)+Math.abs(mn.y)),bn=mn.y>0?1:0,Ln=vr.dist(br);if(kr+Ln>32768&&(kr=0),Se){dr=en.sub(br)._perp()._unit();let un=L5(vr,br,en,D5(mr,dr),Se);isNaN(un)&&(un=0);const xi=br.sub(vr)._unit();vr=vr.add(xi.mult(It))._round(),br=br.add(xi.mult(-un))._round(),It=un,mr=dr,X&&this.zoom>=17&&(Ie(Wt,vr)||Wt.push(vr),Ie(Wt,br)||Wt.push(br))}const Bn=st.vertexLength,Li=vt.length>4&&F5(vr,br,en);let Pi=B5(kr,ut,tr);if(nb(this.layoutVertexArray,vr.x,vr.y,_n,bn,0,0,Pi),nb(this.layoutVertexArray,vr.x,vr.y,_n,bn,0,1,Pi),this.wallMode){const un=ue(Ht-1,vt),xi=le.joinNormals[Ht-1];ib(this.wallVertexArray,xi,un),ib(this.wallVertexArray,xi,un)}if(kr+=Ln,Pi=B5(kr,Li,!tr),ut=Li,nb(this.layoutVertexArray,br.x,br.y,_n,bn,0,0,Pi),nb(this.layoutVertexArray,br.x,br.y,_n,bn,0,1,Pi),this.wallMode){const un=ue(Ht,vt),xi=le.joinNormals[Ht];ib(this.wallVertexArray,xi,un),ib(this.wallVertexArray,xi,un)}if(st.vertexLength+=4,this.indexArray.emplaceBack(Bn+0,Bn+1,Bn+2),this.indexArray.emplaceBack(Bn+1,Bn+3,Bn+2),st.primitiveLength+=2,Se){const un=Be+(Ht===1?vt.length-2:Ht-2),xi=Ht===1?Be:un+1;if(this.indexArray.emplaceBack(Bn+1,un,Bn+3),this.indexArray.emplaceBack(un,xi,Bn+3),st.primitiveLength+=2,Rt===void 0&&(Rt=Bn),!GN(en,vt[Ht],et)){const Si=Ht===vt.length-1?Rt:st.vertexLength;this.indexArray.emplaceBack(Bn+2,Bn+3,Si),this.indexArray.emplaceBack(Bn+3,Si+1,Si),this.indexArray.emplaceBack(Bn+3,xi,Si+1),st.primitiveLength+=3}tr=!tr}if(F){const un=this.layoutVertexExtArray,xi=R.projectTilePoint(vr.x,vr.y,v),Si=R.projectTilePoint(br.x,br.y,v),Yi=R.upVector(v,vr.x,vr.y),Da=R.upVector(v,br.x,br.y);ab(un,xi,Yi),ab(un,xi,Yi),ab(un,Si,Da),ab(un,Si,Da)}}M&&(Be+=vt.length-1),X&&Se&&this.zoom>=17&&(Wt.length!==0&&Ie(Wt,Wt[0])&&Wt.pop(),this.groundEffect.addData(Wt,et,B,Se>0))}this.footprintSegments.push(ct),nt.triangleCount=this.indexArray.length-nt.triangleArrayOffset,this.polygonSegments.push(nt),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=I.borders?k5:this.encodeCentroid(I,q),this.centroidData.push(q),I.borders){this.featuresOnBorder.push(I);const Me=this.featuresOnBorder.length-1;for(let et=0;et<I.borders.length;et++)I.borders[et][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[et].push(Me)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,_,v,O),this.groundEffect.addPaintPropertiesData(s,p,m,_,v,O),this.maxHeight=Math.max(this.maxHeight,te)}}sortBorders(){for(let s=0;s<this.borderFeatureIndices.length;s++)this.borderFeatureIndices[s].sort((u,p)=>this.featuresOnBorder[u].borders[s][0]-this.featuresOnBorder[p].borders[s][0])}splitToSubtiles(){const s=[];for(let C=0;C<this.centroidData.length;C++){const O=this.centroidData[C],B=+(O.min.y+O.max.y>hr),j=2*B+(+(O.min.x+O.max.x>hr)^B);for(let R=0;R<O.polygonSegLen;R++){const F=O.polygonSegIdx+R;s.push({centroidIdx:C,subtile:j,polygonSegmentIdx:F,triangleSegmentIdx:this.polygonSegments[F].triangleSegIdx})}}const u=new _s;s.sort((C,O)=>C.triangleSegmentIdx===O.triangleSegmentIdx?C.subtile-O.subtile:C.triangleSegmentIdx-O.triangleSegmentIdx);let p=0,v=0,m=0;for(const C of s){if(C.triangleSegmentIdx!==p)break;m++}const _=s.length;for(;v!==s.length;){p=s[v].triangleSegmentIdx;let C=0,O=v,B=v;for(let j=O;j<m&&s[j].subtile===C;j++)B++;for(;O!==m;){const j=s[O];C=j.subtile;const R=this.centroidData[j.centroidIdx].min.clone(),F=this.centroidData[j.centroidIdx].max.clone(),M={vertexOffset:this.segments.segments[p].vertexOffset,primitiveOffset:u.length,vertexLength:this.segments.segments[p].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let I=O;I<B;I++){const q=s[I],X=this.polygonSegments[q.polygonSegmentIdx],te=this.centroidData[q.centroidIdx].min,le=this.centroidData[q.centroidIdx].max,ue=this.indexArray.uint16;for(let ie=X.triangleArrayOffset;ie<X.triangleArrayOffset+X.triangleCount;ie++)u.emplaceBack(ue[3*ie],ue[3*ie+1],ue[3*ie+2]);M.primitiveLength+=X.triangleCount,R.x=Math.min(R.x,te.x),R.y=Math.min(R.y,te.y),F.x=Math.max(F.x,le.x),F.y=Math.max(F.y,le.y)}M.primitiveLength>0&&this.triangleSubSegments.push({segment:M,min:R,max:F}),O=B;for(let I=O;I<m&&s[I].subtile===s[O].subtile;I++)B++}v=m;for(let j=v;j<_&&s[j].triangleSegmentIdx===s[v].triangleSegmentIdx;j++)m++}u._trim(),this.indexArray=u}getVisibleSegments(s,u,p){const v=new va;if(this.wallMode){for(const q of this.triangleSubSegments)v.segments.push(q.segment);return v}let m=0,_=0;const C=1<<s.canonical.z;if(u){const q=u.getMinMaxForTile(s);q&&(m=q.min,_=q.max)}_+=this.maxHeight;const O=s.toUnwrapped();let B;const j=[O.canonical.x/C+O.wrap,O.canonical.y/C],R=[(O.canonical.x+1)/C+O.wrap,(O.canonical.y+1)/C],F=(q,X,te)=>[q[0]*(1-te[0])+X[0]*te[0],q[1]*(1-te[1])+X[1]*te[1]],M=[],I=[];for(const q of this.triangleSubSegments){M[0]=q.min.x/hr,M[1]=q.min.y/hr,I[0]=q.max.x/hr,I[1]=q.max.y/hr;const X=F(j,R,M),te=F(j,R,I);if(new Sr([X[0],X[1],m],[te[0],te[1],_]).intersectsPrecise(p)===0){B&&(v.segments.push(B),B=void 0);continue}const le=q.segment;B&&B.vertexOffset!==le.vertexOffset&&(v.segments.push(B),B=void 0),B?(B.vertexLength+=le.vertexLength,B.primitiveLength+=le.primitiveLength):B={vertexOffset:le.vertexOffset,primitiveLength:le.primitiveLength,vertexLength:le.vertexLength,primitiveOffset:le.primitiveOffset,sortKey:void 0,vaos:{}}}return B&&v.segments.push(B),v}encodeCentroid(s,u){const p=s.centroid(),v=u.span(),m=Math.min(7,Math.round(v.x*this.tileToMeter/10)),_=Math.min(7,Math.round(v.y*this.tileToMeter/10));return new At(ur(p.x,1,hr-1)<<3|m,ur(p.y,1,hr-1)<<3|_)}encodeBorderCentroid(s){if(!s.borders)return new At(0,0);const u=s.borders,p=Number.MAX_VALUE;if(u[0][0]!==p||u[1][0]!==p){const v=u[0][0]!==p?0:1;return new At(6|(u[0][0]!==p?0:65528),(u[v][0]+u[v][1])/2<<3|6)}{const v=u[2][0]!==p?2:3;return new At((u[v][0]+u[v][1])/2<<3|6,6|(u[2][0]!==p?0:65528))}}showCentroid(s){const u=this.centroidData[s.centroidDataIndex];u.flags&=Sg,u.centroidXY.x=0,u.centroidXY.y=0,this.writeCentroidToBuffer(u)}writeCentroidToBuffer(s){this.groundEffect.updateHiddenByLandmark(s);const u=s.vertexArrayOffset,p=s.vertexCount+s.vertexArrayOffset,v=s.flags&Sg?k5:s.centroidXY,m=this.centroidVertexArray.geta_centroid_pos0(u);if(this.centroidVertexArray.geta_centroid_pos1(u)!==v.y||m!==v.x){for(let _=u;_<p;++_)this.centroidVertexArray.emplace(_,v.x,v.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const s of this.centroidData)this.writeCentroidToBuffer(s)}updateReplacement(s,u,p){if(u.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=u.updateTime;const v=u.getReplacementRegionsForTile(s.toUnwrapped());if(UN(this.activeReplacements,v))return;if(this.activeReplacements=v,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const m=[];for(const _ of this.activeReplacements){if(_.order<p)continue;const C=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-s.canonical.z));for(const O of this.centroidData)if(!(O.flags&Sg||_.min.x>O.max.x||O.min.x>_.max.x||_.min.y>O.max.y||O.min.y>_.max.y))for(let B=0;B<O.footprintSegLen;B++){const j=this.footprintSegments[O.footprintSegIdx+B];if(m.length=0,Lie(this.footprintVertices,j.vertexOffset,j.vertexCount,_.footprintTileId.canonical,s.canonical,m),T5(_.footprint,m,this.footprintIndices.uint16,j.indexOffset,j.indexCount,-j.vertexOffset,-C)){O.flags|=Sg;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(s,u,p){let v=!1;for(let m=0;m<p.footprintSegLen;m++){const _=this.footprintSegments[p.footprintSegIdx+m];let C=0;for(const O of _.ringIndices){for(let B=C,j=O+C-1;B<O+C;j=B++){const R=this.footprintVertices.int16[2*(B+_.vertexOffset)+0],F=this.footprintVertices.int16[2*(B+_.vertexOffset)+1],M=this.footprintVertices.int16[2*(j+_.vertexOffset)+1];F>u!=M>u&&s<(this.footprintVertices.int16[2*(j+_.vertexOffset)+0]-R)*(u-F)/(M-F)+R&&(v=!v)}C=O}}return v}getHeightAtTileCoord(s,u){let p=Number.NEGATIVE_INFINITY,v=!0;const m=4*(s+hr)*hr+(u+hr);if(this.partLookup.hasOwnProperty(m)){const _=this.partLookup[m];return _?{height:_.height,hidden:!!(_.flags&Sg)}:void 0}for(const _ of this.centroidData)s>_.max.x||_.min.x>s||u>_.max.y||_.min.y>u||this.footprintContainsPoint(s,u,_)&&_&&_.height>p&&(p=_.height,this.partLookup[m]=_,v=!!(_.flags&Sg));if(p!==Number.NEGATIVE_INFINITY)return{height:p,hidden:v};this.partLookup[m]=void 0}}function D5(h,s){const u=h.add(s)._unit();return h.x*u.x+h.y*u.y}function Die(h,s,u,p){const v=s.sub(h)._perp()._unit(),m=u.sub(s)._perp()._unit();return L5(h,s,u,D5(v,m),p)}function L5(h,s,u,p,v){const m=Math.sqrt(1-p*p);return Math.min(h.dist(s)/3,s.dist(u)/3,v*m/p)}function GN(h,s,u){return h.x<u[0].x&&s.x<u[0].x||h.x>u[1].x&&s.x>u[1].x||h.y<u[0].y&&s.y<u[0].y||h.y>u[1].y&&s.y>u[1].y}function z5(h,s){return h.x<s[0].x||h.x>s[1].x||h.y<s[0].y||h.y>s[1].y}function F5(h,s,u){if(h.x<0||h.x>=hr||s.x<0||s.x>=hr||u.x<0||u.x>=hr)return!1;const p=u.sub(s),v=p.perp(),m=h.sub(s);return(p.x*m.x+p.y*m.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(m.x*m.x+m.y*m.y))>-.866&&v.x*m.x+v.y*m.y<0}function B5(h,s,u){const p=s?2|h:-3&h;return u?1|p:-2&p}function V5(){const h=Math.PI/32,s=Math.tan(h),u=vd;return u*Math.sqrt(1+2*s*s)-u}function U5(h,s,u){const p=1<<u.z,v=il(u.x/p),m=il((u.x+1)/p),_=Vr(u.y/p),C=Vr((u.y+1)/p);return function(O,B,j,R,F=0,M){const I=[];if(!O.length||!j||!R)return I;const q=(ye,Se)=>{for(const Le of ye)I.push({polygon:Le,bounds:Se})},X=Math.ceil(Math.log2(j)),te=Math.ceil(Math.log2(R)),le=X-te,ue=[];for(let ye=0;ye<Math.abs(le);ye++)ue.push(le>0?0:1);for(let ye=0;ye<Math.min(X,te);ye++)ue.push(0),ue.push(1);let ie=O;if(ie=V2(ie,B[0].y-F,B[1].y+F,1),ie=V2(ie,B[0].x-F,B[1].x+F,0),!ie.length)return I;const fe=[];for(ue.length?fe.push({polygons:ie,bounds:B,depth:0}):q(ie,B);fe.length;){const ye=fe.pop(),Se=ye.depth,Le=ue[Se],Ie=ye.bounds[0],Me=ye.bounds[1],et=Le===0?Ie.x:Ie.y,Be=Le===0?Me.x:Me.y,rt=M?M(Le,et,Be):.5*(et+Be),st=V2(ye.polygons,et-F,rt+F,Le),nt=V2(ye.polygons,rt-F,Be+F,Le);if(st.length){const ct=[Ie,new At(Le===0?rt:Me.x,Le===1?rt:Me.y)];ue.length>Se+1?fe.push({polygons:st,bounds:ct,depth:Se+1}):q(st,ct)}if(nt.length){const ct=[new At(Le===0?rt:Ie.x,Le===1?rt:Ie.y),Me];ue.length>Se+1?fe.push({polygons:nt,bounds:ct,depth:Se+1}):q(nt,ct)}}return I}(h,s,Math.ceil((m-v)/11.25),Math.ceil((_-C)/11.25),1,(O,B,j)=>{if(O===0)return .5*(B+j);{const R=Vr((u.y+B/hr)/p);return(nl(.5*(Vr((u.y+j/hr)/p)+R))*p-u.y)*hr}})}function Lie(h,s,u,p,v,m){const _=Math.pow(2,p.z-v.z);for(let C=0;C<u;C++){let O=h.int16[2*(C+s)+0],B=h.int16[2*(C+s)+1];O=(O+v.x*hr)*_-p.x*hr,B=(B+v.y*hr)*_-p.y*hr,m.push(new At(O,B))}}let $5,q5;function sb(h,s){return h.x*s.x+h.y*s.y}function G5(h,s){if(h.length===1){let u=0;const p=s[u++];let v;for(;!v||p.equals(v);)if(v=s[u++],!v)return 1/0;for(;u<s.length;u++){const m=s[u],_=h[0],C=v.sub(p),O=m.sub(p),B=_.sub(p),j=sb(C,C),R=sb(C,O),F=sb(O,O),M=sb(B,C),I=sb(B,O),q=j*F-R*R,X=(F*M-R*I)/q,te=(j*I-R*M)/q,le=p.z*(1-X-te)+v.z*X+m.z*te;if(isFinite(le))return le}return 1/0}{let u=1/0;for(const p of s)u=Math.min(u,p.z);return u}}function W5(h,s,u,p,v,m,_,C){const O=_*v.getElevationAt(h,s,!0,!0),B=m[0]!==0,j=B?m[1]===0?_*(m[0]/7-450):_*function(R,F,M){const I=Math.floor(F[0]/8),q=Math.floor(F[1]/8),X=10*(F[0]-8*I),te=10*(F[1]-8*q),le=R.getElevationAt(I,q,!0,!0),ue=R.getMeterToDEM(M),ie=Math.floor(.5*(X*ue-1)),fe=Math.floor(.5*(te*ue-1)),ye=R.tileCoordToPixel(I,q),Se=2*ie+1,Le=2*fe+1,Ie=function(nt,ct,ht,vt,ut){return[nt.getElevationAtPixel(ct,ht,!0),nt.getElevationAtPixel(ct+ut,ht,!0),nt.getElevationAtPixel(ct,ht+ut,!0),nt.getElevationAtPixel(ct+vt,ht+ut,!0)]}(R,ye.x-ie,ye.y-fe,Se,Le),Me=Math.abs(Ie[0]-Ie[1]),et=Math.abs(Ie[2]-Ie[3]),Be=Math.abs(Ie[0]-Ie[2])+Math.abs(Ie[1]-Ie[3]),rt=Math.min(.25,.5*ue*(Me+et)/Se),st=Math.min(.25,.5*ue*Be/Le);return le+Math.max(rt*X,st*te)}(v,m,C):O;return{base:O+(u===0?-1:u),top:B?Math.max(j+p,O+u+2):O+p}}gr(G2,"FillExtrusionBucket",{omit:["layers","features"]}),gr(M5,"PartData"),gr(E5,"FootprintSegment"),gr(O5,"BorderCentroidData"),gr(I5,"GroundEffect");const zie=ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Fie=ei([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Bie}=zie,Vie=ei([{name:"a_packed",components:3,type:"Float32"}]),{members:Uie}=Vie,$ie=ei([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:qie}=$ie;class H5{constructor(s,u){this.width=s,this.height=u,this.nextRow=0,this.image=new xd({width:s,height:u}),this.positions={},this.uploaded=!1}getDash(s,u){const p=this.getKey(s,u);return this.positions[p]}trim(){const s=this.width,u=this.height=Ks(this.nextRow);this.image.resize({width:s,height:u})}getKey(s,u){return s.join(",")+u}getDashRanges(s,u,p){const v=[];let m=s.length%2==1?-s[s.length-1]*p:0,_=s[0]*p,C=!0;v.push({left:m,right:_,isDash:C,zeroLength:s[0]===0});let O=s[0];for(let B=1;B<s.length;B++){C=!C;const j=s[B];m=O*p,O+=j,_=O*p,v.push({left:m,right:_,isDash:C,zeroLength:j===0})}return v}addRoundDash(s,u,p){const v=u/2;for(let m=-p;m<=p;m++){const _=this.width*(this.nextRow+p+m);let C=0,O=s[C];for(let B=0;B<this.width;B++){B/O.right>1&&(O=s[++C]);const j=Math.abs(B-O.left),R=Math.abs(B-O.right),F=Math.min(j,R);let M;const I=m/p*(v+1);if(O.isDash){const q=v-Math.abs(I);M=Math.sqrt(F*F+q*q)}else M=v-Math.sqrt(F*F+I*I);this.image.data[_+B]=Math.max(0,Math.min(255,M+128))}}}addRegularDash(s,u){for(let O=s.length-1;O>=0;--O){const B=s[O],j=s[O+1];B.zeroLength?s.splice(O,1):j&&j.isDash===B.isDash&&(j.left=B.left,s.splice(O,1))}const p=s[0],v=s[s.length-1];p.isDash===v.isDash&&(p.left=v.left-this.width,v.right=p.right+this.width);const m=this.width*this.nextRow;let _=0,C=s[_];for(let O=0;O<this.width;O++){O/C.right>1&&(C=s[++_]);const B=Math.abs(O-C.left),j=Math.abs(O-C.right),R=Math.min(B,j);this.image.data[m+O]=Math.max(0,Math.min(255,(C.isDash?R:-R)+u+128))}}addDash(s,u){const p=this.getKey(s,u);if(this.positions[p])return this.positions[p];const v=u==="round",m=v?7:0,_=2*m+1;if(this.nextRow+_>this.height)return sn("LineAtlas out of space"),null;s.length===0&&s.push(1);let C=0;for(let j=0;j<s.length;j++)s[j]<0&&(sn("Negative value is found in line dasharray, replacing values with 0"),s[j]=0),C+=s[j];if(C!==0){const j=this.width/C,R=this.getDashRanges(s,this.width,j);v?this.addRoundDash(R,j,m):this.addRegularDash(R,u==="square"?.5*j:0)}const O=this.nextRow+m;this.nextRow+=_;const B={tl:[O,m],br:[C,0]};return this.positions[p]=B,B}}gr(H5,"LineAtlas");const Gie=Rv.VectorTileFeature.types,Wie=Math.cos(Math.PI/180*37.5),Hie=Math.cos(Math.PI/180*5);class WN{constructor(s){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=s.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=s.overscaling,this.pixelRatio=s.pixelRatio,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.index=s.index,this.projection=s.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new hd,this.layoutVertexArray2=new Qo,this.patternVertexArray=new Qo,this.indexArray=new _s,this.programConfigurations=new xu(s.layers,{zoom:s.zoom,lut:s.lut}),this.segments=new va,this.maxLineLength=0,this.zOffsetVertexArray=new Qo,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.tessellationStep=s.tessellationStep?s.tessellationStep:hr/64}updateFootprints(s,u){}populate(s,u,p,v){this.hasPattern=Qr("line",this.layers,this.pixelRatio,u);const m=this.layers[0].layout.get("line-sort-key");this.tileToMeter=o(p);const _=this.layers[0].layout.get("line-z-offset"),C=_.isConstant()&&!_.constantOr(0),O=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=O==="sea"||O==="ground"||!C&&O==="none",this.hasZOffset&&O==="none"&&sn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const B=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&B!==void 0;const j=[];for(const{feature:I,id:q,index:X,sourceLayerIndex:te}of s){const le=this.layers[0]._featureFilter.needGeometry,ue=re(I,le);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),ue,p))continue;const ie=m?m.evaluate(ue,{},p):void 0,fe={id:q,properties:I.properties,type:I.type,sourceLayerIndex:te,index:X,geometry:le?ue.geometry:Y(I,p,v),patterns:{},sortKey:ie};j.push(fe)}m&&j.sort((I,q)=>I.sortKey-q.sortKey);const{lineAtlas:R,featureIndex:F}=u,M=this.addConstantDashes(R);for(const I of j){const{geometry:q,index:X,sourceLayerIndex:te}=I;if(M&&this.addFeatureDashes(I,R),this.hasPattern){const le=cn("line",this.layers,I,this.zoom,this.pixelRatio,u);this.patternFeatures.push(le)}else this.addFeature(I,q,X,p,R.positions,u.availableImages,u.brightness);F.insert(s[X].feature,q,X,te,this.index)}}addConstantDashes(s){let u=!1;for(const p of this.layers){const v=p.paint.get("line-dasharray").value,m=p.layout.get("line-cap").value;if(v.kind!=="constant"||m.kind!=="constant")u=!0;else{const _=m.value,C=v.value;if(!C)continue;s.addDash(C,_)}}return u}addFeatureDashes(s,u){const p=this.zoom;for(const v of this.layers){const m=v.paint.get("line-dasharray").value,_=v.layout.get("line-cap").value;if(m.kind==="constant"&&_.kind==="constant")continue;let C,O;if(m.kind==="constant"){if(C=m.value,!C)continue}else C=m.evaluate({zoom:p},s);O=_.kind==="constant"?_.value:_.evaluate({zoom:p},s),u.addDash(C,O),s.patterns[v.id]=u.getKey(C,O)}}update(s,u,p,v,m,_,C){this.programConfigurations.updatePaintArrays(s,u,m,p,v,_,C)}addFeatures(s,u,p,v,m,_){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,u,p,v,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(s){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=s.createVertexBuffer(this.layoutVertexArray2,Uie)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=s.createVertexBuffer(this.patternVertexArray,qie)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,Fie.members,!0)),this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Bie),this.indexBuffer=s.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(s),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(s){if(s.properties&&s.properties.hasOwnProperty("mapbox_clip_start")&&s.properties.hasOwnProperty("mapbox_clip_end"))return{start:+s.properties.mapbox_clip_start,end:+s.properties.mapbox_clip_end}}addFeature(s,u,p,v,m,_,C){const O=this.layers[0].layout,B=O.get("line-join").evaluate(s,{}),j=O.get("line-cap").evaluate(s,{}),R=O.get("line-miter-limit"),F=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(s),this.lineFeature=s,this.zOffsetValue=O.get("line-z-offset").value;const M=this.layers[0].paint.get("line-width").value;M.kind!=="constant"&&M.isLineProgressConstant===!1&&(this.variableWidthValue=M);for(const I of u)this.addLine(I,s,v,B,j,R,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,s,p,m,_,v,C)}addLine(s,u,p,v,m,_,C){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=v==="none";if(this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ue=0;ue<s.length-1;ue++)this.totalDistance+=s[ue].dist(s[ue+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=Gie[u.type]==="Polygon";let j=s.length;for(;j>=2&&s[j-1].equals(s[j-2]);)j--;let R=0;for(;R<j-1&&s[R].equals(s[R+1]);)R++;if(j<(B?3:2))return;v==="bevel"&&(_=1.05);const F=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);let M,I,q,X,te,le;this.e1=this.e2=-1,B&&(M=s[j-2],te=s[R].sub(M)._unit()._perp());for(let ue=R;ue<j;ue++){if(q=ue===j-1?B?s[R+1]:void 0:s[ue+1],q&&s[ue].equals(q))continue;te&&(X=te),M&&(I=M),M=s[ue],le=this.evaluateLineProgressFeatures(I?I.dist(M):0),te=q?q.sub(M)._unit()._perp():X,X=X||te;const ie=I&&q;let fe=ie?v:B||O?"butt":m;const ye=X.x*te.x+X.y*te.y;if(O){const st=function(nt){if(nt.patternJoinNone){const ct=nt.segmentPoints.length/2,ht=nt.lineSoFar-nt.segmentStart;for(let vt=0;vt<ct;++vt){const ut=nt.segmentPoints[2*vt+1],It=Math.round(nt.segmentPoints[2*vt])+.5+.25*ut;nt.patternVertexArray.emplaceBack(It,ht,nt.segmentStart),nt.patternVertexArray.emplaceBack(It,ht,nt.segmentStart)}nt.segmentPoints.length=0}nt.e1=nt.e2=-1};if(ie&&ye<Hie){this.updateDistance(I,M),this.addCurrentVertex(M,X,1,1,F,le),st(this),this.addCurrentVertex(M,te,-1,-1,F,le);continue}if(I){if(!q){this.updateDistance(I,M),this.addCurrentVertex(M,X,1,1,F,le),st(this);continue}fe="miter"}}let Se=X.add(te);Se.x===0&&Se.y===0||Se._unit();const Le=Se.x*te.x+Se.y*te.y,Ie=Le!==0?1/Le:1/0,Me=2*Math.sqrt(2-2*Le),et=Le<Wie&&I&&q,Be=X.x*te.y-X.y*te.x>0,rt=this.overscaling<=16?15*hr/(512*this.overscaling):0;if(ie&&fe==="round"){if(Ie<C)fe="miter";else if(Ie<=2){const st=HN(M,-10,hr+10);fe=this.hasZOffset&&(st||this.hasCrossSlope)?"miter":"fakeround"}}if(fe==="miter"&&Ie>_&&(fe="bevel"),fe==="bevel"&&(Ie>2&&(fe="flipbevel"),Ie<_&&(fe="miter")),I&&!(fe==="miter"&&et)&&this.updateDistance(I,M),fe==="miter")if(et){const st=M.dist(I);if(st>2*rt){const ct=M.sub(M.sub(I)._mult(rt/st)._round());this.updateDistance(I,ct),this.addCurrentVertex(ct,X,0,0,F,le),I=ct}this.updateDistance(I,M),Se._mult(Ie),this.addCurrentVertex(M,Se,0,0,F,le);const nt=M.dist(q);if(nt>2*rt){const ct=M.add(q.sub(M)._mult(rt/nt)._round());this.updateDistance(M,ct),this.addCurrentVertex(ct,te,0,0,F,le),M=ct}}else Se._mult(Ie),this.addCurrentVertex(M,Se,0,0,F,le);else if(fe==="flipbevel"){if(Ie>100)Se=te.mult(-1);else{const st=Ie*X.add(te).mag()/X.sub(te).mag();Se._perp()._mult(st*(Be?-1:1))}this.addCurrentVertex(M,Se,0,0,F,le),this.addCurrentVertex(M,Se.mult(-1),0,0,F,le)}else if(fe==="bevel"||fe==="fakeround"){le!=null&&I&&this.addCurrentVertex(M,X,-1,-1,F,le);const st=M.dist(I)<=2*rt&&fe!=="bevel",nt=Se.mult(Be?1:-1);nt._mult(Ie);const ct=te.mult(Be?-1:1),ht=X.mult(Be?-1:1),vt=this.evaluateLineProgressFeatures(this.distance);if(le==null&&(this.addHalfVertex(M,nt.x,nt.y,!1,!Be,0,F,vt),st||this.addHalfVertex(M,nt.x+2*ht.x,nt.y+2*ht.y,!1,Be,0,F,vt)),fe==="fakeround"){const ut=Math.round(180*Me/Math.PI/20);this.addHalfVertex(M,ht.x,ht.y,!1,Be,0,F,vt);for(let It=0;It<ut;It++){let Wt=It/ut;if(Wt!==.5){const mr=Wt-.5;Wt+=Wt*mr*(Wt-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*mr*mr+(.848013+ye*(.215638*ye-1.06021)))}const Rt=ct.sub(ht)._mult(Wt)._add(ht)._unit();this.addHalfVertex(M,Rt.x,Rt.y,!1,Be,0,F,vt)}this.addHalfVertex(M,ct.x,ct.y,!1,Be,0,F,vt)}st||le!=null||this.addHalfVertex(M,nt.x+2*ct.x,nt.y+2*ct.y,!1,Be,0,F,vt),le!=null&&q&&this.addCurrentVertex(M,te,1,1,F,le)}else fe==="butt"?this.addCurrentVertex(M,Se,0,0,F,le):fe==="square"?(I||this.addCurrentVertex(M,Se,-1,-1,F,le),this.addCurrentVertex(M,Se,0,0,F,le),I&&this.addCurrentVertex(M,Se,1,1,F,le)):fe==="round"&&(I&&(this.addCurrentVertex(M,X,0,0,F,le),this.addCurrentVertex(M,X,1,1,F,le,!0)),q&&(this.addCurrentVertex(M,te,-1,-1,F,le,!0),this.addCurrentVertex(M,te,0,0,F,le)))}}addVerticesTo(s,u,p,v,m,_,C,O,B,j){const R=(u.w-s.w)/this.tessellationStep|0;let F=0;const M=this.scaledDistance;if(R>1){this.lineSoFar=s.w;const q=(u.x-s.x)/R,X=(u.y-s.y)/R,te=(u.z-s.z)/R,le=(u.w-s.w)/R;for(let ue=1;ue<R;++ue){s.x+=q,s.y+=X,s.z+=te,this.lineSoFar+=le,F+=le;const ie=this.evaluateLineProgressFeatures(this.prevDistance+F);this.scaledDistance=(this.prevDistance+F)/this.totalDistance,this.addHalfVertex(s,p,v,j,!1,C,B,ie),this.addHalfVertex(s,m,_,j,!0,-O,B,ie)}}this.lineSoFar=u.w,this.scaledDistance=M;const I=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(u,p,v,j,!1,C,B,I),this.addHalfVertex(u,m,_,j,!0,-O,B,I)}evaluateLineProgressFeatures(s){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+s)/this.totalFeatureLength):sn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let u=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(u=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:u}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:u}:{zOffset:0,variableWidth:u}}addCurrentVertex(s,u,p,v,m,_,C=!1){const O=u.x+u.y*p,B=u.y-u.x*p,j=u.y*v-u.x,R=-u.y-u.x*v;if(_!=null){const F=this.hasZOffset,M=-10,I=hr+10,q=_.zOffset,X=new x5(s.x,s.y,q,this.lineSoFar),te=!!F&&HN(s,M,I),le=this.lineSoFar,ue=this.distance;if(this.currentVertex)if(te){const ie=this.currentVertexIsOutside,fe=this.currentVertex,ye=new x5(s.x,s.y,q,this.lineSoFar);if(b5(fe,ye,M,I),!HN(ye,M,I)){if(ie){this.e1=this.e2=-1,this.distance-=fe.dist(X),this.lineSoFar=fe.w;const Se=this.evaluateLineProgressFeatures(fe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(fe,O,B,C,!1,p,m,Se),this.addHalfVertex(fe,j,R,C,!0,-v,m,Se),this.prevDistance=this.distance}this.distance=this.prevDistance+fe.dist(ye),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(fe,ye,O,B,j,R,p,v,m,C),this.distance=ue,this.scaledDistance=this.distance/this.totalDistance}}else{const ie=this.currentVertex;if(this.currentVertexIsOutside){b5(ie,X,M,I),this.e1=this.e2=-1,this.distance-=ie.dist(X),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ie.w;const fe=this.evaluateLineProgressFeatures(ie.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ie,O,B,C,!1,p,m,fe),this.addHalfVertex(ie,j,R,C,!0,-v,m,fe),this.prevDistance=this.distance,this.distance=ue,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ie,X,O,B,j,R,p,v,m,C)}else te||(this.addHalfVertex(s,O,B,C,!1,p,m,_),this.addHalfVertex(s,j,R,C,!0,-v,m,_));this.currentVertex=X,this.currentVertexIsOutside=te,this.lineSoFar=le}else this.addHalfVertex(s,O,B,C,!1,p,m,_),this.addHalfVertex(s,j,R,C,!0,-v,m,_)}addHalfVertex({x:s,y:u},p,v,m,_,C,O,B){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,C)),this.layoutVertexArray.emplaceBack((s<<1)+(m?1:0),(u<<1)+(_?1:0),Math.round(63*p)+128,Math.round(63*v)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const R=Fr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,R)}const j=O.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,j),O.primitiveLength++),_?this.e2=j:this.e1=j,B!=null&&this.zOffsetVertexArray.emplaceBack(B.zOffset,B.variableWidth,B.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(s,u){this.prevDistance=this.distance,this.distance+=s.dist(u),this.updateScaledDistance()}}function HN(h,s,u){return h.x<s||h.x>u||h.y<s||h.y>u}let K5,Z5;function Y5(h,s,u){return s*(hr/(h.tileSize*Math.pow(2,u-h.tileID.overscaledZ)))}gr(WN,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const X5=(h,s,u)=>(1-u)*h+u*s;function J5(h,s){return 1/Y5(h,1,s.tileZoom)}function Q5(h,s,u,p){return h.translatePosMatrix(p||s.tileID.projMatrix,s,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const ez=h=>{const s=[];tz(h)&&s.push("RENDER_LINE_DASH"),h.paint.get("line-gradient")&&s.push("RENDER_LINE_GRADIENT");const u=h.paint.get("line-trim-offset");u[0]===0&&u[1]===0||s.push("RENDER_LINE_TRIM_OFFSET"),h.paint.get("line-border-width").constantOr(1)!==0&&s.push("RENDER_LINE_BORDER");const p=h.layout.get("line-join").constantOr("miter")==="none",v=!!h.paint.get("line-pattern").constantOr(1);return p&&v&&s.push("LINE_JOIN_NONE"),s};function tz(h){const s=h.paint.get("line-dasharray").value;return s.value||s.kind!=="constant"}let KN;const rz=()=>KN||(KN={layout:K5||(K5=new qi({"line-cap":new fr(_t.layout_line["line-cap"]),"line-join":new fr(_t.layout_line["line-join"]),"line-miter-limit":new er(_t.layout_line["line-miter-limit"]),"line-round-limit":new er(_t.layout_line["line-round-limit"]),"line-sort-key":new fr(_t.layout_line["line-sort-key"]),"line-z-offset":new fr(_t.layout_line["line-z-offset"]),"line-elevation-reference":new er(_t.layout_line["line-elevation-reference"]),"line-cross-slope":new er(_t.layout_line["line-cross-slope"]),visibility:new er(_t.layout_line.visibility),"line-width-unit":new er(_t.layout_line["line-width-unit"])})),paint:Z5||(Z5=new qi({"line-opacity":new fr(_t.paint_line["line-opacity"]),"line-color":new fr(_t.paint_line["line-color"]),"line-translate":new er(_t.paint_line["line-translate"]),"line-translate-anchor":new er(_t.paint_line["line-translate-anchor"]),"line-width":new fr(_t.paint_line["line-width"]),"line-gap-width":new fr(_t.paint_line["line-gap-width"]),"line-offset":new fr(_t.paint_line["line-offset"]),"line-blur":new fr(_t.paint_line["line-blur"]),"line-dasharray":new fr(_t.paint_line["line-dasharray"]),"line-pattern":new fr(_t.paint_line["line-pattern"]),"line-gradient":new Vl(_t.paint_line["line-gradient"]),"line-trim-offset":new er(_t.paint_line["line-trim-offset"]),"line-trim-fade-range":new er(_t.paint_line["line-trim-fade-range"]),"line-trim-color":new er(_t.paint_line["line-trim-color"]),"line-emissive-strength":new er(_t.paint_line["line-emissive-strength"]),"line-border-width":new fr(_t.paint_line["line-border-width"]),"line-border-color":new fr(_t.paint_line["line-border-color"]),"line-occlusion-opacity":new er(_t.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},KN);class Kie extends fr{possiblyEvaluate(s,u){return u=new bi(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,transition:u.transition}),super.possiblyEvaluate(s,u)}evaluate(s,u,p,v){return u=Ui({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(s,u,p,v)}}let ob;function nz(h,s){return s>0?s+2*h:h}const Zie=ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yie=ei([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Xie=ei([{name:"a_projected_pos",components:4,type:"Float32"}],4);ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Jie=ei([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Qie=ei([{name:"a_texb",components:2,type:"Uint16"}]),eae=ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),tae=ei([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ei([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const iz=ei([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),rae=ei([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ei([{name:"triangle",components:3,type:"Uint16"}]),ei([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ei([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ei([{type:"Float32",name:"offsetX"}]),ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Do=24;const Th=128;function ZN(h,s,u,p,v){if(h.kind==="camera")return h.maxSize;if(h.kind==="composite"){const m=s.possiblyEvaluate(new bi(h.maxZoom),u).evaluate(v,{},u),_=s.possiblyEvaluate(new bi(h.minZoom),u).evaluate(v,{},u);return Math.max(m,_)}return s.possiblyEvaluate(new bi(p)).evaluate(v,{},u)}function YN(h,s){const{expression:u}=s;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new bi(h+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:v}=u;let m=0;for(;m<p.length&&p[m]<=h;)m++;m=Math.max(0,m-1);let _=m;for(;_<p.length&&p[_]<h+1;)_++;_=Math.min(p.length-1,_);const C=p[m],O=p[_];return u.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:O,interpolationType:v}:{kind:"camera",minZoom:C,maxZoom:O,minSize:u.evaluate(new bi(C)),maxSize:u.evaluate(new bi(O)),interpolationType:v}}}function W2(h,{uSize:s,uSizeT:u},{lowerSize:p,upperSize:v}){return h.kind==="source"?p/Th:h.kind==="composite"?Fr(p/Th,v/Th,u):s}function Iv(h,s,u=1){let p=0,v=0;if(h.kind==="constant")v=h.layoutSize*u;else if(h.kind!=="source"){const{interpolationType:m,minZoom:_,maxZoom:C}=h,O=m?ur(Os.interpolationFactor(m,s,_,C),0,1):0;h.kind==="camera"?v=Fr(h.minSize,h.maxSize,O)*u:p=O*u}return{uSizeT:p,uSize:v}}var nae=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Th,evaluateSizeForFeature:W2,evaluateSizeForZoom:Iv,getRasterizedIconSize:ZN,getSizeData:YN});function iae(h,s,u){return h.sections.forEach(p=>{p.text=function(v,m,_){const C=m.layout.get("text-transform").evaluate(_,{});return C==="uppercase"?v=v.toLocaleUpperCase():C==="lowercase"&&(v=v.toLocaleLowerCase()),Jo.applyArabicShaping&&(v=Jo.applyArabicShaping(v)),v}(p.text,s,u)}),h}const lb={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function aae(h){return h==="︶"||h==="﹈"||h==="︸"||h==="﹄"||h==="﹂"||h==="︾"||h==="︼"||h==="︺"||h==="︘"||h==="﹀"||h==="︐"||h==="︓"||h==="︔"||h==="｀"||h==="￣"||h==="︑"||h==="︒"}function sae(h){return h==="︵"||h==="﹇"||h==="︷"||h==="﹃"||h==="﹁"||h==="︽"||h==="︻"||h==="︹"||h==="︗"||h==="︿"}var az,XN,sz,JN={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function oae(){return az||(az=1,JN.read=function(h,s,u,p,v){var m,_,C=8*v-p-1,O=(1<<C)-1,B=O>>1,j=-7,R=u?v-1:0,F=u?-1:1,M=h[s+R];for(R+=F,m=M&(1<<-j)-1,M>>=-j,j+=C;j>0;m=256*m+h[s+R],R+=F,j-=8);for(_=m&(1<<-j)-1,m>>=-j,j+=p;j>0;_=256*_+h[s+R],R+=F,j-=8);if(m===0)m=1-B;else{if(m===O)return _?NaN:1/0*(M?-1:1);_+=Math.pow(2,p),m-=B}return(M?-1:1)*_*Math.pow(2,m-p)},JN.write=function(h,s,u,p,v,m){var _,C,O,B=8*m-v-1,j=(1<<B)-1,R=j>>1,F=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=p?0:m-1,I=p?1:-1,q=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(C=isNaN(s)?1:0,_=j):(_=Math.floor(Math.log(s)/Math.LN2),s*(O=Math.pow(2,-_))<1&&(_--,O*=2),(s+=_+R>=1?F/O:F*Math.pow(2,1-R))*O>=2&&(_++,O/=2),_+R>=j?(C=0,_=j):_+R>=1?(C=(s*O-1)*Math.pow(2,v),_+=R):(C=s*Math.pow(2,R-1)*Math.pow(2,v),_=0));v>=8;h[u+M]=255&C,M+=I,C/=256,v-=8);for(_=_<<v|C,B+=v;B>0;h[u+M]=255&_,M+=I,_/=256,B-=8);h[u+M-I]|=128*q}),JN}function oz(){if(sz)return XN;sz=1,XN=s;var h=oae();function s(ie){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ie)?ie:new Uint8Array(ie||0),this.pos=0,this.type=0,this.length=this.buf.length}s.Varint=0,s.Fixed64=1,s.Bytes=2,s.Fixed32=5;var u=4294967296,p=1/u,v=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function m(ie){return ie.type===s.Bytes?ie.readVarint()+ie.pos:ie.pos+1}function _(ie,fe,ye){return ye?4294967296*fe+(ie>>>0):4294967296*(fe>>>0)+(ie>>>0)}function C(ie,fe,ye){var Se=fe<=16383?1:fe<=2097151?2:fe<=268435455?3:Math.floor(Math.log(fe)/(7*Math.LN2));ye.realloc(Se);for(var Le=ye.pos-1;Le>=ie;Le--)ye.buf[Le+Se]=ye.buf[Le]}function O(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeVarint(ie[ye])}function B(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeSVarint(ie[ye])}function j(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeFloat(ie[ye])}function R(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeDouble(ie[ye])}function F(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeBoolean(ie[ye])}function M(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeFixed32(ie[ye])}function I(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeSFixed32(ie[ye])}function q(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeFixed64(ie[ye])}function X(ie,fe){for(var ye=0;ye<ie.length;ye++)fe.writeSFixed64(ie[ye])}function te(ie,fe){return(ie[fe]|ie[fe+1]<<8|ie[fe+2]<<16)+16777216*ie[fe+3]}function le(ie,fe,ye){ie[ye]=fe,ie[ye+1]=fe>>>8,ie[ye+2]=fe>>>16,ie[ye+3]=fe>>>24}function ue(ie,fe){return(ie[fe]|ie[fe+1]<<8|ie[fe+2]<<16)+(ie[fe+3]<<24)}return s.prototype={destroy:function(){this.buf=null},readFields:function(ie,fe,ye){for(ye=ye||this.length;this.pos<ye;){var Se=this.readVarint(),Le=Se>>3,Ie=this.pos;this.type=7&Se,ie(Le,fe,this),this.pos===Ie&&this.skip(Se)}return fe},readMessage:function(ie,fe){return this.readFields(ie,fe,this.readVarint()+this.pos)},readFixed32:function(){var ie=te(this.buf,this.pos);return this.pos+=4,ie},readSFixed32:function(){var ie=ue(this.buf,this.pos);return this.pos+=4,ie},readFixed64:function(){var ie=te(this.buf,this.pos)+te(this.buf,this.pos+4)*u;return this.pos+=8,ie},readSFixed64:function(){var ie=te(this.buf,this.pos)+ue(this.buf,this.pos+4)*u;return this.pos+=8,ie},readFloat:function(){var ie=h.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ie},readDouble:function(){var ie=h.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ie},readVarint:function(ie){var fe,ye,Se=this.buf;return fe=127&(ye=Se[this.pos++]),ye<128?fe:(fe|=(127&(ye=Se[this.pos++]))<<7,ye<128?fe:(fe|=(127&(ye=Se[this.pos++]))<<14,ye<128?fe:(fe|=(127&(ye=Se[this.pos++]))<<21,ye<128?fe:function(Le,Ie,Me){var et,Be,rt=Me.buf;if(et=(112&(Be=rt[Me.pos++]))>>4,Be<128||(et|=(127&(Be=rt[Me.pos++]))<<3,Be<128)||(et|=(127&(Be=rt[Me.pos++]))<<10,Be<128)||(et|=(127&(Be=rt[Me.pos++]))<<17,Be<128)||(et|=(127&(Be=rt[Me.pos++]))<<24,Be<128)||(et|=(1&(Be=rt[Me.pos++]))<<31,Be<128))return _(Le,et,Ie);throw new Error("Expected varint not more than 10 bytes")}(fe|=(15&(ye=Se[this.pos]))<<28,ie,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ie=this.readVarint();return ie%2==1?(ie+1)/-2:ie/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ie=this.readVarint()+this.pos,fe=this.pos;return this.pos=ie,ie-fe>=12&&v?function(ye,Se,Le){return v.decode(ye.subarray(Se,Le))}(this.buf,fe,ie):function(ye,Se,Le){for(var Ie="",Me=Se;Me<Le;){var et,Be,rt,st=ye[Me],nt=null,ct=st>239?4:st>223?3:st>191?2:1;if(Me+ct>Le)break;ct===1?st<128&&(nt=st):ct===2?(192&(et=ye[Me+1]))==128&&(nt=(31&st)<<6|63&et)<=127&&(nt=null):ct===3?(Be=ye[Me+2],(192&(et=ye[Me+1]))==128&&(192&Be)==128&&((nt=(15&st)<<12|(63&et)<<6|63&Be)<=2047||nt>=55296&&nt<=57343)&&(nt=null)):ct===4&&(Be=ye[Me+2],rt=ye[Me+3],(192&(et=ye[Me+1]))==128&&(192&Be)==128&&(192&rt)==128&&((nt=(15&st)<<18|(63&et)<<12|(63&Be)<<6|63&rt)<=65535||nt>=1114112)&&(nt=null)),nt===null?(nt=65533,ct=1):nt>65535&&(nt-=65536,Ie+=String.fromCharCode(nt>>>10&1023|55296),nt=56320|1023&nt),Ie+=String.fromCharCode(nt),Me+=ct}return Ie}(this.buf,fe,ie)},readBytes:function(){var ie=this.readVarint()+this.pos,fe=this.buf.subarray(this.pos,ie);return this.pos=ie,fe},readPackedVarint:function(ie,fe){if(this.type!==s.Bytes)return ie.push(this.readVarint(fe));var ye=m(this);for(ie=ie||[];this.pos<ye;)ie.push(this.readVarint(fe));return ie},readPackedSVarint:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSVarint());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readSVarint());return ie},readPackedBoolean:function(ie){if(this.type!==s.Bytes)return ie.push(this.readBoolean());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readBoolean());return ie},readPackedFloat:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFloat());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readFloat());return ie},readPackedDouble:function(ie){if(this.type!==s.Bytes)return ie.push(this.readDouble());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readDouble());return ie},readPackedFixed32:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFixed32());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readFixed32());return ie},readPackedSFixed32:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSFixed32());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readSFixed32());return ie},readPackedFixed64:function(ie){if(this.type!==s.Bytes)return ie.push(this.readFixed64());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readFixed64());return ie},readPackedSFixed64:function(ie){if(this.type!==s.Bytes)return ie.push(this.readSFixed64());var fe=m(this);for(ie=ie||[];this.pos<fe;)ie.push(this.readSFixed64());return ie},skip:function(ie){var fe=7&ie;if(fe===s.Varint)for(;this.buf[this.pos++]>127;);else if(fe===s.Bytes)this.pos=this.readVarint()+this.pos;else if(fe===s.Fixed32)this.pos+=4;else{if(fe!==s.Fixed64)throw new Error("Unimplemented type: "+fe);this.pos+=8}},writeTag:function(ie,fe){this.writeVarint(ie<<3|fe)},realloc:function(ie){for(var fe=this.length||16;fe<this.pos+ie;)fe*=2;if(fe!==this.length){var ye=new Uint8Array(fe);ye.set(this.buf),this.buf=ye,this.length=fe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ie){this.realloc(4),le(this.buf,ie,this.pos),this.pos+=4},writeSFixed32:function(ie){this.realloc(4),le(this.buf,ie,this.pos),this.pos+=4},writeFixed64:function(ie){this.realloc(8),le(this.buf,-1&ie,this.pos),le(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeSFixed64:function(ie){this.realloc(8),le(this.buf,-1&ie,this.pos),le(this.buf,Math.floor(ie*p),this.pos+4),this.pos+=8},writeVarint:function(ie){(ie=+ie||0)>268435455||ie<0?function(fe,ye){var Se,Le;if(fe>=0?(Se=fe%4294967296|0,Le=fe/4294967296|0):(Le=~(-fe/4294967296),4294967295^(Se=~(-fe%4294967296))?Se=Se+1|0:(Se=0,Le=Le+1|0)),fe>=18446744073709552e3||fe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ye.realloc(10),function(Ie,Me,et){et.buf[et.pos++]=127&Ie|128,Ie>>>=7,et.buf[et.pos++]=127&Ie|128,Ie>>>=7,et.buf[et.pos++]=127&Ie|128,Ie>>>=7,et.buf[et.pos++]=127&Ie|128,et.buf[et.pos]=127&(Ie>>>=7)}(Se,0,ye),function(Ie,Me){var et=(7&Ie)<<4;Me.buf[Me.pos++]|=et|((Ie>>>=3)?128:0),Ie&&(Me.buf[Me.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Me.buf[Me.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Me.buf[Me.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Me.buf[Me.pos++]=127&Ie|((Ie>>>=7)?128:0),Ie&&(Me.buf[Me.pos++]=127&Ie)))))}(Le,ye)}(ie,this):(this.realloc(4),this.buf[this.pos++]=127&ie|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=127&(ie>>>=7)|(ie>127?128:0),ie<=127||(this.buf[this.pos++]=ie>>>7&127))))},writeSVarint:function(ie){this.writeVarint(ie<0?2*-ie-1:2*ie)},writeBoolean:function(ie){this.writeVarint(!!ie)},writeString:function(ie){ie=String(ie),this.realloc(4*ie.length),this.pos++;var fe=this.pos;this.pos=function(Se,Le,Ie){for(var Me,et,Be=0;Be<Le.length;Be++){if((Me=Le.charCodeAt(Be))>55295&&Me<57344){if(!et){Me>56319||Be+1===Le.length?(Se[Ie++]=239,Se[Ie++]=191,Se[Ie++]=189):et=Me;continue}if(Me<56320){Se[Ie++]=239,Se[Ie++]=191,Se[Ie++]=189,et=Me;continue}Me=et-55296<<10|Me-56320|65536,et=null}else et&&(Se[Ie++]=239,Se[Ie++]=191,Se[Ie++]=189,et=null);Me<128?Se[Ie++]=Me:(Me<2048?Se[Ie++]=Me>>6|192:(Me<65536?Se[Ie++]=Me>>12|224:(Se[Ie++]=Me>>18|240,Se[Ie++]=Me>>12&63|128),Se[Ie++]=Me>>6&63|128),Se[Ie++]=63&Me|128)}return Ie}(this.buf,ie,this.pos);var ye=this.pos-fe;ye>=128&&C(fe,ye,this),this.pos=fe-1,this.writeVarint(ye),this.pos+=ye},writeFloat:function(ie){this.realloc(4),h.write(this.buf,ie,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ie){this.realloc(8),h.write(this.buf,ie,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ie){var fe=ie.length;this.writeVarint(fe),this.realloc(fe);for(var ye=0;ye<fe;ye++)this.buf[this.pos++]=ie[ye]},writeRawMessage:function(ie,fe){this.pos++;var ye=this.pos;ie(fe,this);var Se=this.pos-ye;Se>=128&&C(ye,Se,this),this.pos=ye-1,this.writeVarint(Se),this.pos+=Se},writeMessage:function(ie,fe,ye){this.writeTag(ie,s.Bytes),this.writeRawMessage(fe,ye)},writePackedVarint:function(ie,fe){fe.length&&this.writeMessage(ie,O,fe)},writePackedSVarint:function(ie,fe){fe.length&&this.writeMessage(ie,B,fe)},writePackedBoolean:function(ie,fe){fe.length&&this.writeMessage(ie,F,fe)},writePackedFloat:function(ie,fe){fe.length&&this.writeMessage(ie,j,fe)},writePackedDouble:function(ie,fe){fe.length&&this.writeMessage(ie,R,fe)},writePackedFixed32:function(ie,fe){fe.length&&this.writeMessage(ie,M,fe)},writePackedSFixed32:function(ie,fe){fe.length&&this.writeMessage(ie,I,fe)},writePackedFixed64:function(ie,fe){fe.length&&this.writeMessage(ie,q,fe)},writePackedSFixed64:function(ie,fe){fe.length&&this.writeMessage(ie,X,fe)},writeBytesField:function(ie,fe){this.writeTag(ie,s.Bytes),this.writeBytes(fe)},writeFixed32Field:function(ie,fe){this.writeTag(ie,s.Fixed32),this.writeFixed32(fe)},writeSFixed32Field:function(ie,fe){this.writeTag(ie,s.Fixed32),this.writeSFixed32(fe)},writeFixed64Field:function(ie,fe){this.writeTag(ie,s.Fixed64),this.writeFixed64(fe)},writeSFixed64Field:function(ie,fe){this.writeTag(ie,s.Fixed64),this.writeSFixed64(fe)},writeVarintField:function(ie,fe){this.writeTag(ie,s.Varint),this.writeVarint(fe)},writeSVarintField:function(ie,fe){this.writeTag(ie,s.Varint),this.writeSVarint(fe)},writeStringField:function(ie,fe){this.writeTag(ie,s.Bytes),this.writeString(fe)},writeFloatField:function(ie,fe){this.writeTag(ie,s.Fixed32),this.writeFloat(fe)},writeDoubleField:function(ie,fe){this.writeTag(ie,s.Fixed64),this.writeDouble(fe)},writeBooleanField:function(ie,fe){this.writeVarintField(ie,!!fe)}},XN}var H2=x(oz());const QN=3;function lae(h,s,u){s.glyphs=[],h===1&&u.readMessage(cae,s)}function cae(h,s,u){if(h===3){const{id:p,bitmap:v,width:m,height:_,left:C,top:O,advance:B}=u.readMessage(uae,{});s.glyphs.push({id:p,bitmap:new xd({width:m+2*QN,height:_+2*QN},v),metrics:{width:m,height:_,left:C,top:O,advance:B}})}else h===4?s.ascender=u.readSVarint():h===5&&(s.descender=u.readSVarint())}function uae(h,s,u){h===1?s.id=u.readVarint():h===2?s.bitmap=u.readBytes():h===3?s.width=u.readVarint():h===4?s.height=u.readVarint():h===5?s.left=u.readSVarint():h===6?s.top=u.readSVarint():h===7&&(s.advance=u.readVarint())}const dae=QN,bu={horizontal:1,vertical:2,horizontalOnly:3};class cb{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(s,u){const p=new cb;return p.scale=s||1,p.fontStack=u,p}static forImage(s){const u=new cb;return u.image=s,u}}class Dv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(s,u){const p=new Dv;for(let v=0;v<s.sections.length;v++){const m=s.sections[v];m.image?p.addImageSection(m):p.addTextSection(m,u)}return p}length(){return this.text.length}getSection(s){return this.sections[this.sectionIndex[s]]}getSections(){return this.sections}getSectionIndex(s){return this.sectionIndex[s]}getCodePoint(s){return this.text.codePointAt(s)}verticalizePunctuation(s){this.text=function(u,p){let v="";for(let m=0;m<u.length;m++){const _=u.charCodeAt(m+1)||null,C=u.charCodeAt(m-1)||null;v+=!p&&(_&&ya(_)&&!lb[u[m+1]]||C&&ya(C)&&!lb[u[m-1]])||!lb[u[m]]?u[m]:lb[u[m]]}return v}(this.text,s)}trim(){let s=0;for(let p=0;p<this.text.length&&K2[this.text.charCodeAt(p)];p++)s++;let u=this.text.length;for(let p=this.text.length-1;p>=0&&p>=s&&K2[this.text.charCodeAt(p)];p--)u--;this.text=this.text.substring(s,u),this.sectionIndex=this.sectionIndex.slice(s,u)}substring(s,u){const p=new Dv;return p.text=this.text.substring(s,u),p.sectionIndex=this.sectionIndex.slice(s,u),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((s,u)=>Math.max(s,this.sections[u].scale),0)}addTextSection(s,u){this.text+=s.text,this.sections.push(cb.forText(s.scale,s.fontStack||u));const p=this.sections.length-1;for(let v=0;v<s.text.length;++v)this.sectionIndex.push(p)}addImageSection(s){const u=s.image&&s.image.namePrimary?s.image.getPrimary():null;if(!u)return void sn("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCodePoint(p),this.sections.push(cb.forImage(u)),this.sectionIndex.push(this.sections.length-1)):sn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ej(h,s,u,p,v,m,_,C,O,B,j,R,F,M,I){const q=Dv.fromFeature(h,v);R===bu.vertical&&q.verticalizePunctuation(F);let X=[];const te=function(ye,Se,Le,Ie,Me,et){if(!ye)return[];const Be=[],rt=function(ht,vt,ut,It,Wt,Rt){let mr=0;for(let dr=0;dr<ht.length();dr++){const tr=ht.getSection(dr);mr+=lz(ht.getCodePoint(dr),tr,It,Wt,vt,Rt)}return mr/Math.max(1,Math.ceil(mr/ut))}(ye,Se,Le,Ie,Me,et),st=ye.text.indexOf("​")>=0;let nt=0;for(let ht=0;ht<ye.length();ht++){const vt=ye.getSection(ht),ut=ye.getCodePoint(ht);if(K2[ut]||(nt+=lz(ut,vt,Ie,Me,Se,et)),ht<ye.length()-1){const It=!((ct=ut)<11904||!(Er["Bopomofo Extended"](ct)||Er.Bopomofo(ct)||Er["CJK Compatibility Forms"](ct)||Er["CJK Compatibility Ideographs"](ct)||Er["CJK Compatibility"](ct)||Er["CJK Radicals Supplement"](ct)||Er["CJK Strokes"](ct)||Er["CJK Symbols and Punctuation"](ct)||Er["CJK Unified Ideographs Extension A"](ct)||Er["CJK Unified Ideographs"](ct)||Er["Enclosed CJK Letters and Months"](ct)||Er["Halfwidth and Fullwidth Forms"](ct)||Er.Hiragana(ct)||Er["Ideographic Description Characters"](ct)||Er["Kangxi Radicals"](ct)||Er["Katakana Phonetic Extensions"](ct)||Er.Katakana(ct)||Er["Vertical Forms"](ct)||Er["Yi Radicals"](ct)||Er["Yi Syllables"](ct)));(hae[ut]||It||vt.image)&&Be.push(uz(ht+1,nt,rt,Be,fae(ut,ye.getCodePoint(ht+1),It&&st),!1))}}var ct;return dz(uz(ye.length(),nt,rt,Be,0,!0))}(q,B,m,s,p,M),{processBidirectionalText:le,processStyledBidirectionalText:ue}=Jo;if(le&&q.sections.length===1){const ye=le(q.toString(),te);for(const Se of ye){const Le=new Dv;Le.text=Se,Le.sections=q.sections;for(let Ie=0;Ie<Se.length;Ie++)Le.sectionIndex.push(0);X.push(Le)}}else if(ue){const ye=ue(q.text,q.sectionIndex,te);for(const Se of ye){const Le=new Dv;Le.text=Se[0],Le.sectionIndex=Se[1],Le.sections=q.sections,X.push(Le)}}else X=function(ye,Se){const Le=[],Ie=ye.text;let Me=0;for(const et of Se)Le.push(ye.substring(Me,et)),Me=et;return Me<Ie.length&&Le.push(ye.substring(Me,Ie.length)),Le}(q,te);const ie=[],fe={positionedLines:ie,text:q.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:R,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ye,Se,Le,Ie,Me,et,Be,rt,st,nt,ct,ht){let vt=0,ut=0,It=0;const Wt=rt==="right"?1:rt==="left"?0:.5;let Rt=!1;for(const vr of Me){const br=vr.getSections();for(const en of br){if(en.image)continue;const mn=Se[en.fontStack];if(mn&&(Rt=mn.ascender!==void 0&&mn.descender!==void 0,!Rt))break}if(!Rt)break}let mr=0;for(const vr of Me){vr.trim();const br=vr.getMaxScale(),en=(br-1)*Do,mn={positionedGlyphs:[],lineOffset:0};ye.positionedLines[mr]=mn;const _n=mn.positionedGlyphs;let bn=0;if(!vr.length()){ut+=et,++mr;continue}let Ln=0,Bn=0;for(let Pi=0;Pi<vr.length();Pi++){const un=vr.getSection(Pi),xi=vr.getSectionIndex(Pi),Si=vr.getCodePoint(Pi);let Yi=un.scale,Da=null,os=null,La=null,Aa=Do,Ga=0;const Ss=!(st===bu.horizontal||!ct&&!po(Si)||ct&&(K2[Si]||(dr=Si,Er.Arabic(dr)||Er["Arabic Supplement"](dr)||Er["Arabic Extended-A"](dr)||Er["Arabic Presentation Forms-A"](dr)||Er["Arabic Presentation Forms-B"](dr))));if(un.image){const Lo=Ie[un.image.serialize()];if(!Lo)continue;La=un.image.id,ye.iconsInText=ye.iconsInText||!0,os=Lo.paddedRect;const Hi=Lo.displaySize;Yi=Yi*Do/ht,Da={width:Hi[0],height:Hi[1],left:0,top:-3,advance:Ss?Hi[1]:Hi[0],localGlyph:!1},Ga=Rt?-Da.height*Yi:br*Do-17-Hi[1]*Yi,Aa=Da.advance;const hc=(Ss?Hi[0]:Hi[1])*Yi-Do*br;hc>0&&hc>bn&&(bn=hc)}else{const Lo=Le[un.fontStack];if(!Lo)continue;Lo[Si]&&(os=Lo[Si]);const Hi=Se[un.fontStack];if(!Hi)continue;const hc=Hi.glyphs[Si];if(!hc)continue;if(Da=hc.metrics,Aa=Si!==8203?Do:0,Rt){const kh=Hi.ascender!==void 0?Math.abs(Hi.ascender):0,bd=Hi.descender!==void 0?Math.abs(Hi.descender):0,wd=(kh+bd)*Yi;Ln<wd&&(Ln=wd,Bn=(kh-bd)/2*Yi),Ga=-kh*Yi}else Ga=(br-Yi)*Do-17}Ss?(ye.verticalizable=!0,_n.push({glyph:Si,imageName:La,x:vt,y:ut+Ga,vertical:Ss,scale:Yi,localGlyph:Da.localGlyph,fontStack:un.fontStack,sectionIndex:xi,metrics:Da,rect:os}),vt+=Aa*Yi+nt):(_n.push({glyph:Si,imageName:La,x:vt,y:ut+Ga,vertical:Ss,scale:Yi,localGlyph:Da.localGlyph,fontStack:un.fontStack,sectionIndex:xi,metrics:Da,rect:os}),vt+=Da.advance*Yi+nt)}_n.length!==0&&(It=Math.max(vt-nt,It),Rt?hz(_n,Wt,bn,Bn,et*br/2):hz(_n,Wt,bn,0,et/2)),vt=0;const Li=et*br+bn;mn.lineOffset=Math.max(bn,en),ut+=Li,++mr}var dr;const tr=ut,{horizontalAlign:Ht,verticalAlign:kr}=tj(Be);(function(vr,br,en,mn,_n,bn){const Ln=(br-en)*_n,Bn=-bn*mn;for(const Li of vr)for(const Pi of Li.positionedGlyphs)Pi.x+=Ln,Pi.y+=Bn})(ye.positionedLines,Wt,Ht,kr,It,tr),ye.top+=-kr*tr,ye.bottom=ye.top+tr,ye.left+=-Ht*It,ye.right=ye.left+It,ye.hasBaseline=Rt}(fe,s,u,p,X,_,C,O,R,B,F,I),!function(ye){for(const Se of ye)if(Se.positionedGlyphs.length!==0)return!1;return!0}(ie)&&fe}const K2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hae={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function lz(h,s,u,p,v,m){if(s.image){const _=p[s.image.serialize()];return _?_.displaySize[0]*s.scale*Do/m+v:0}{const _=u[s.fontStack],C=_&&_.glyphs[h];return C?C.metrics.advance*s.scale+v:0}}function cz(h,s,u,p){const v=Math.pow(h-s,2);return p?h<s?v/2:2*v:v+Math.abs(u)*u}function fae(h,s,u){let p=0;return h===10&&(p-=1e4),u&&(p+=150),h!==40&&h!==65288||(p+=50),s!==41&&s!==65289||(p+=50),p}function uz(h,s,u,p,v,m){let _=null,C=cz(s,u,v,m);for(const O of p){const B=cz(s-O.x,u,v,m)+O.badness;B<=C&&(_=O,C=B)}return{index:h,x:s,priorBreak:_,badness:C}}function dz(h){return h?dz(h.priorBreak).concat(h.index):[]}function tj(h){let s=.5,u=.5;switch(h){case"right":case"top-right":case"bottom-right":s=1;break;case"left":case"top-left":case"bottom-left":s=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:s,verticalAlign:u}}function hz(h,s,u,p,v){if(!(s||u||p||v))return;const m=h.length-1,_=h[m],C=(_.x+_.metrics.advance*_.scale)*s;for(let O=0;O<=m;O++)h[O].x-=C,h[O].y+=u+p+v}function pae(h,s,u,p){const{horizontalAlign:v,verticalAlign:m}=tj(p),_=u[0]-h.displaySize[0]*v,C=u[1]-h.displaySize[1]*m;return{imagePrimary:h,imageSecondary:s,top:C,bottom:C+h.displaySize[1],left:_,right:_+h.displaySize[0]}}function fz(h,s,u,p,v,m){const _=h.imagePrimary;let C;if(_.content){const X=_.content,te=_.pixelRatio||1;C=[X[0]/te,X[1]/te,_.displaySize[0]-X[2]/te,_.displaySize[1]-X[3]/te]}const O=s.left*m,B=s.right*m;let j,R,F,M;u==="width"||u==="both"?(M=v[0]+O-p[3],R=v[0]+B+p[1]):(M=v[0]+(O+B-_.displaySize[0])/2,R=M+_.displaySize[0]);const I=s.top*m,q=s.bottom*m;return u==="height"||u==="both"?(j=v[1]+I-p[0],F=v[1]+q+p[2]):(j=v[1]+(I+q-_.displaySize[1])/2,F=j+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:j,right:R,bottom:F,left:M,collisionPadding:C}}class em extends At{constructor(s,u,p,v,m){super(s,u),this.angle=v,this.z=p,m!==void 0&&(this.segment=m)}clone(){return new em(this.x,this.y,this.z,this.angle,this.segment)}}function pz(h,s,u,p,v){if(s.segment===void 0)return!0;let m=s,_=s.segment+1,C=0;for(;C>-u/2;){if(_--,_<0)return!1;C-=h[_].dist(m),m=h[_]}C+=h[_].dist(h[_+1]),_++;const O=[];let B=0;for(;C<u/2;){const j=h[_],R=h[_+1];if(!R)return!1;let F=h[_-1].angleTo(j)-j.angleTo(R);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),O.push({distance:C,angleDelta:F}),B+=F;C-O[0].distance>p;)B-=O.shift().angleDelta;if(B>v)return!1;_++,C+=j.dist(R)}return!0}function mz(h){let s=0;for(let u=0;u<h.length-1;u++)s+=h[u].dist(h[u+1]);return s}function gz(h,s,u){return h?.6*s*u:0}function yz(h,s){return Math.max(h?h.right-h.left:0,s?s.right-s.left:0)}function mae(h,s,u,p,v,m){const _=gz(u,v,m),C=yz(u,p)*m;let O=0;const B=mz(h)/2;for(let j=0;j<h.length-1;j++){const R=h[j],F=h[j+1],M=R.dist(F);if(O+M>B){const I=(B-O)/M,q=Fr(R.x,F.x,I),X=Fr(R.y,F.y,I),te=new em(q,X,0,F.angleTo(R),j);return!_||pz(h,te,C,_,s)?te:void 0}O+=M}}function gae(h,s,u,p,v,m,_,C,O){const B=gz(p,m,_),j=yz(p,v),R=j*_,F=h[0].x===0||h[0].x===O||h[0].y===0||h[0].y===O;return s-R<s/4&&(s=R+s/4),vz(h,F?s/2*C%s:(j/2+2*m)*_*C%s,s,B,u,R,F,!1,O)}function vz(h,s,u,p,v,m,_,C,O){const B=m/2,j=mz(h);let R=0,F=s-u,M=[];for(let I=0;I<h.length-1;I++){const q=h[I],X=h[I+1],te=q.dist(X),le=X.angleTo(q);for(;F+u<R+te;){F+=u;const ue=(F-R)/te,ie=Fr(q.x,X.x,ue),fe=Fr(q.y,X.y,ue);if(ie>=0&&ie<O&&fe>=0&&fe<O&&F-B>=0&&F+B<=j){const ye=new em(ie,fe,0,le,I);p&&!pz(h,ye,m,p,v)||M.push(ye)}}R+=te}return C||M.length||_||(M=vz(h,R/2,u,p,v,m,_,!0,O)),M}function xz(h,s,u,p,v){const m=[];for(let _=0;_<h.length;_++){const C=h[_];let O;for(let B=0;B<C.length-1;B++){let j=C[B],R=C[B+1];j.x<s&&R.x<s||(j.x<s?j=new At(s,j.y+(s-j.x)/(R.x-j.x)*(R.y-j.y))._round():R.x<s&&(R=new At(s,j.y+(s-j.x)/(R.x-j.x)*(R.y-j.y))._round()),j.y<u&&R.y<u||(j.y<u?j=new At(j.x+(u-j.y)/(R.y-j.y)*(R.x-j.x),u)._round():R.y<u&&(R=new At(j.x+(u-j.y)/(R.y-j.y)*(R.x-j.x),u)._round()),j.x>=p&&R.x>=p||(j.x>=p?j=new At(p,j.y+(p-j.x)/(R.x-j.x)*(R.y-j.y))._round():R.x>=p&&(R=new At(p,j.y+(p-j.x)/(R.x-j.x)*(R.y-j.y))._round()),j.y>=v&&R.y>=v||(j.y>=v?j=new At(j.x+(v-j.y)/(R.y-j.y)*(R.x-j.x),v)._round():R.y>=v&&(R=new At(j.x+(v-j.y)/(R.y-j.y)*(R.x-j.x),v)._round()),O&&j.equals(O[O.length-1])||(O=[j],m.push(O)),O.push(R)))))}}return m}function _z(h){let s=0,u=0;for(const _ of h)s+=_.w*_.h,u=Math.max(u,_.w);h.sort((_,C)=>C.h-_.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(s/.95)),u),h:1/0}];let v=0,m=0;for(const _ of h)for(let C=p.length-1;C>=0;C--){const O=p[C];if(!(_.w>O.w||_.h>O.h)){if(_.x=O.x,_.y=O.y,m=Math.max(m,_.y+_.h),v=Math.max(v,_.x+_.w),_.w===O.w&&_.h===O.h){const B=p.pop();C<p.length&&(p[C]=B)}else _.h===O.h?(O.x+=_.w,O.w-=_.w):_.w===O.w?(O.y+=_.h,O.h-=_.h):(p.push({x:O.x+_.w,y:O.y,w:O.w-_.w,h:_.h}),O.y+=_.h,O.h-=_.h);break}}return{w:v,h:m,fill:s/(v*m)||0}}gr(em,"Anchor");const ub=1;class db{static getImagePositionScale(s,u,p){return u&&s&&s.options&&s.options.transform?{x:s.options.transform.a,y:s.options.transform.d}:{x:p,y:p}}constructor(s,{pixelRatio:u,version:p,stretchX:v,stretchY:m,content:_,sdf:C,usvg:O},B,j){this.paddedRect=s,this.pixelRatio=u,this.stretchX=v,this.stretchY=m,this.content=_,this.version=p,this.padding=B,this.sdf=C,this.scale=db.getImagePositionScale(j,O,u)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class bz{constructor(s,u,p){const v={},m={};this.haveRenderCallbacks=[];const _=[];this.addImages(s,v,ub,_),this.addImages(u,m,2,_);const{w:C,h:O}=_z(_),B=new qs({width:C||1,height:O||1});for(const j in s){const R=s[j],F=v[j].paddedRect;qs.copy(R.data,B,{x:0,y:0},{x:F.x+ub,y:F.y+ub},R.data,p,R.sdf)}for(const j in u){const R=u[j],F=m[j].paddedRect;let M=m[j].padding;const I=F.x+M,q=F.y+M,X=R.data.width,te=R.data.height;M=M>1?M-1:M,qs.copy(R.data,B,{x:0,y:0},{x:I,y:q},R.data,p),qs.copy(R.data,B,{x:0,y:te-M},{x:I,y:q-M},{width:X,height:M},p),qs.copy(R.data,B,{x:0,y:0},{x:I,y:q+te},{width:X,height:M},p),qs.copy(R.data,B,{x:X-M,y:0},{x:I-M,y:q},{width:M,height:te},p),qs.copy(R.data,B,{x:0,y:0},{x:I+X,y:q},{width:M,height:te},p),qs.copy(R.data,B,{x:X-M,y:te-M},{x:I-M,y:q-M},{width:M,height:M},p),qs.copy(R.data,B,{x:0,y:te-M},{x:I+X,y:q-M},{width:M,height:M},p),qs.copy(R.data,B,{x:0,y:0},{x:I+X,y:q+te},{width:M,height:M},p),qs.copy(R.data,B,{x:X-M,y:0},{x:I-M,y:q+te},{width:M,height:M},p)}this.lut=p,this.image=B,this.iconPositions=v,this.patternPositions=m}addImages(s,u,p,v){for(const m in s){const _=s[m],C={x:0,y:0,w:_.data.width+2*p,h:_.data.height+2*p};v.push(C);const O=gl.deserializeFromString(m);u[m]=new db(C,_,p,O),_.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(s,u,p){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(v=>s.hasImage(v,p)),s.dispatchRenderCallbacks(this.haveRenderCallbacks,p);for(const v in s.getUpdatedImages(p)){for(const m of Object.keys(this.iconPositions))gl.deserializeId(m)===v&&this.patchUpdatedImage(this.iconPositions[m],s.getImage(v,p),u);for(const m of Object.keys(this.patternPositions))gl.deserializeId(m)===v&&this.patchUpdatedImage(this.patternPositions[m],s.getImage(v,p),u)}}patchUpdatedImage(s,u,p){if(!s||!u||s.version===u.version)return;s.version=u.version;const[v,m]=s.tl,_=s.sdf;if(this.lut||_){const C={width:u.data.width,height:u.data.height},O=new qs(C);qs.copy(u.data,O,{x:0,y:0},{x:0,y:0},C,this.lut,_),p.update(O,{position:{x:v,y:m}})}else p.update(u.data,{position:{x:v,y:m}})}}gr(db,"ImagePosition"),gr(bz,"ImageAtlas");const Z2=1e20;function wz(h,s,u,p,v,m,_,C,O){for(let B=s;B<s+p;B++)Sz(h,u*m+B,m,v,_,C,O);for(let B=u;B<u+v;B++)Sz(h,B*m+s,1,p,_,C,O)}function Sz(h,s,u,p,v,m,_){m[0]=0,_[0]=-1e20,_[1]=Z2,v[0]=h[s];for(let C=1,O=0,B=0;C<p;C++){v[C]=h[s+C*u];const j=C*C;do{const R=m[O];B=(v[C]-v[R]+j-R*R)/(C-R)/2}while(B<=_[O]&&--O>-1);O++,m[O]=C,_[O]=B,_[O+1]=Z2}for(let C=0,O=0;C<p;C++){for(;_[O+1]<C;)O++;const B=m[O],j=C-B;h[s+C*u]=v[B]+j*j}}const Ph=2,rj={none:0,ideographs:1,all:2};class Lv{constructor(s,u,p){this.requestManager=s,this.localGlyphMode=u,this.localFontFamily=p,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(s,u){this.urls[u]=s}getGlyphs(s,u,p){const v=[],m=this.urls[u]||$i.GLYPHS_URL;for(const _ in s)for(const C of s[_])v.push({stack:_,id:C});gi(v,({stack:_,id:C},O)=>{let B=this.entries[_];B||(B=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let j=B.glyphs[C];if(j!==void 0)return void O(null,{stack:_,id:C,glyph:j});if(j=this._tinySDF(B,_,C),j)return B.glyphs[C]=j,void O(null,{stack:_,id:C,glyph:j});const R=Math.floor(C/256);if(256*R>65535)return sn("glyphs > 65535 not supported"),void O(null,{stack:_,id:C,glyph:j});if(B.ranges[R])return void O(null,{stack:_,id:C,glyph:j});let F=B.requests[R];F||(F=B.requests[R]=[],Lv.loadGlyphRange(_,R,m,this.requestManager,(M,I)=>{if(I){B.ascender=I.ascender,B.descender=I.descender;for(const q in I.glyphs)this._doesCharSupportLocalGlyph(+q)||(B.glyphs[+q]=I.glyphs[+q]);B.ranges[R]=!0}for(const q of F)q(M,I);delete B.requests[R]})),F.push((M,I)=>{M?O(M):I&&O(null,{stack:_,id:C,glyph:I.glyphs[C]||null})})},(_,C)=>{if(_)p(_);else if(C){const O={};for(const{stack:B,id:j,glyph:R}of C)O[B]===void 0&&(O[B]={}),O[B].glyphs===void 0&&(O[B].glyphs={}),O[B].glyphs[j]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},O[B].ascender=this.entries[B].ascender,O[B].descender=this.entries[B].descender;p(null,O)}})}_doesCharSupportLocalGlyph(s){return this.localGlyphMode!==rj.none&&(this.localGlyphMode===rj.all?!!this.localFontFamily:!!this.localFontFamily&&(Er["CJK Unified Ideographs"](s)||Er["Hangul Syllables"](s)||Er.Hiragana(s)||Er.Katakana(s)||Er["CJK Symbols and Punctuation"](s)||Er["CJK Unified Ideographs Extension A"](s)||Er["CJK Unified Ideographs Extension B"](s)||Er.Osage(s)))}_tinySDF(s,u,p){const v=this.localFontFamily;if(!v||!this._doesCharSupportLocalGlyph(p))return;let m=s.tinySDF;if(!m){let q="400";/bold/i.test(u)?q="900":/medium/i.test(u)?q="500":/light/i.test(u)&&(q="200"),m=s.tinySDF=new Lv.TinySDF({fontFamily:v,fontWeight:q,fontSize:24*Ph,buffer:3*Ph,radius:8*Ph}),m.fontWeight=q}if(this.localGlyphs[m.fontWeight][p])return this.localGlyphs[m.fontWeight][p];const _=String.fromCodePoint(p),{data:C,width:O,height:B,glyphWidth:j,glyphHeight:R,glyphLeft:F,glyphTop:M,glyphAdvance:I}=m.draw(_);return this.localGlyphs[m.fontWeight][p]={id:p,bitmap:new xd({width:O,height:B},C),metrics:{width:j/Ph,height:R/Ph,left:F/Ph,top:M/Ph-27,advance:I/Ph,localGlyph:!0}}}}Lv.loadGlyphRange=function(h,s,u,p,v){const m=256*s,_=m+255,C=p.transformRequest(p.normalizeGlyphsURL(u).replace("{fontstack}",h).replace("{range}",`${m}-${_}`),Rn.Glyphs);rs(C,(O,B)=>{if(O)v(O);else if(B){const j={},R=function(F){return new H2(F).readFields(lae,{})}(B);for(const F of R.glyphs)j[F.id]=F;v(null,{glyphs:j,ascender:R.ascender,descender:R.descender})}})},Lv.TinySDF=class{constructor({fontSize:h=24,buffer:s=3,radius:u=8,cutoff:p=.25,fontFamily:v="sans-serif",fontWeight:m="normal",fontStyle:_="normal"}={}){this.buffer=s,this.cutoff=p,this.radius=u;const C=this.size=h+4*s,O=this._createCanvas(C),B=this.ctx=O.getContext("2d",{willReadFrequently:!0});B.font=`${_} ${m} ${h}px ${v}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(h){const s=document.createElement("canvas");return s.width=s.height=h,s}draw(h){const{width:s,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:v,actualBoundingBoxRight:m}=this.ctx.measureText(h),_=Math.ceil(u),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-v))),O=Math.min(this.size-this.buffer,_+Math.ceil(p)),B=C+2*this.buffer,j=O+2*this.buffer,R=Math.max(B*j,0),F=new Uint8ClampedArray(R),M={data:F,width:B,height:j,glyphWidth:C,glyphHeight:O,glyphTop:_,glyphLeft:0,glyphAdvance:s};if(C===0||O===0)return M;const{ctx:I,buffer:q,gridInner:X,gridOuter:te}=this;I.clearRect(q,q,C,O),I.fillText(h,q,q+_);const le=I.getImageData(q,q,C,O);te.fill(Z2,0,R),X.fill(0,0,R);for(let ue=0;ue<O;ue++)for(let ie=0;ie<C;ie++){const fe=le.data[4*(ue*C+ie)+3]/255;if(fe===0)continue;const ye=(ue+q)*B+ie+q;if(fe===1)te[ye]=0,X[ye]=Z2;else{const Se=.5-fe;te[ye]=Se>0?Se*Se:0,X[ye]=Se<0?Se*Se:0}}wz(te,0,0,B,j,B,this.f,this.v,this.z),wz(X,q,q,C,O,B,this.f,this.v,this.z);for(let ue=0;ue<R;ue++){const ie=Math.sqrt(te[ue])-Math.sqrt(X[ue]);F[ue]=Math.round(255-255*(ie/this.radius+this.cutoff))}return M}};const e0=ub;function Az(h,s){return h+s[1]-s[0]}function Tz(h,s,u,p,v=1){const m=[],_=h.imagePrimary,C=_.pixelRatio,O=_.paddedRect.w-2*e0,B=_.paddedRect.h-2*e0,j=(h.right-h.left)*v,R=(h.bottom-h.top)*v,F=_.stretchX||[[0,O]],M=_.stretchY||[[0,B]],I=F.reduce(Az,0),q=M.reduce(Az,0),X=O-I,te=B-q;let le=0,ue=I,ie=0,fe=q,ye=0,Se=X,Le=0,Ie=te;if(_.content&&p){const et=_.content;le=Y2(F,0,et[0]),ie=Y2(M,0,et[1]),ue=Y2(F,et[0],et[2]),fe=Y2(M,et[1],et[3]),ye=et[0]-le,Le=et[1]-ie,Se=et[2]-et[0]-ue,Ie=et[3]-et[1]-fe}const Me=(et,Be,rt,st)=>{const nt=X2(et.stretch-le,ue,j,h.left*v),ct=J2(et.fixed-ye,Se,et.stretch,I),ht=X2(Be.stretch-ie,fe,R,h.top*v),vt=J2(Be.fixed-Le,Ie,Be.stretch,q),ut=X2(rt.stretch-le,ue,j,h.left*v),It=J2(rt.fixed-ye,Se,rt.stretch,I),Wt=X2(st.stretch-ie,fe,R,h.top*v),Rt=J2(st.fixed-Le,Ie,st.stretch,q),mr=new At(nt,ht),dr=new At(ut,ht),tr=new At(ut,Wt),Ht=new At(nt,Wt),kr=new At(ct/C,vt/C),vr=new At(It/C,Rt/C),br=s*Math.PI/180;if(br){const Bn=Math.sin(br),Li=Math.cos(br),Pi=[Li,-Bn,Bn,Li];mr._matMult(Pi),dr._matMult(Pi),Ht._matMult(Pi),tr._matMult(Pi)}const en=et.stretch+et.fixed,mn=rt.stretch+rt.fixed,_n=Be.stretch+Be.fixed,bn=st.stretch+st.fixed,Ln=h.imageSecondary;return{tl:mr,tr:dr,bl:Ht,br:tr,texPrimary:{x:_.paddedRect.x+e0+en,y:_.paddedRect.y+e0+_n,w:mn-en,h:bn-_n},texSecondary:Ln?{x:Ln.paddedRect.x+e0+en,y:Ln.paddedRect.y+e0+_n,w:mn-en,h:bn-_n}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:kr,pixelOffsetBR:vr,minFontScaleX:Se/C/j,minFontScaleY:Ie/C/R,isSDF:u}};if(p&&(_.stretchX||_.stretchY)){const et=Pz(F,X,I),Be=Pz(M,te,q);for(let rt=0;rt<et.length-1;rt++){const st=et[rt],nt=et[rt+1];for(let ct=0;ct<Be.length-1;ct++)m.push(Me(st,Be[ct],nt,Be[ct+1]))}}else m.push(Me({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:O+1},{fixed:0,stretch:B+1}));return m}function Y2(h,s,u){let p=0;for(const v of h)p+=Math.max(s,Math.min(u,v[1]))-Math.max(s,Math.min(u,v[0]));return p}function Pz(h,s,u){const p=[{fixed:-1,stretch:0}];for(const[v,m]of h){const _=p[p.length-1];p.push({fixed:v-_.stretch,stretch:_.stretch}),p.push({fixed:v-_.stretch,stretch:_.stretch+(m-v)})}return p.push({fixed:s+e0,stretch:u}),p}function X2(h,s,u,p){return h/s*u+p}function J2(h,s,u,p){return h-s*u/p}function yae(h,s,u,p){const v=s+h.positionedLines[p].lineOffset;return p===0?u+v/2:u+(v+(s+h.positionedLines[p-1].lineOffset))/2}function vae(h,s=1,u=!1){let p=1/0,v=1/0,m=-1/0,_=-1/0;const C=h[0];for(let M=0;M<C.length;M++){const I=C[M];(!M||I.x<p)&&(p=I.x),(!M||I.y<v)&&(v=I.y),(!M||I.x>m)&&(m=I.x),(!M||I.y>_)&&(_=I.y)}const O=Math.min(m-p,_-v);let B=O/2;const j=new Vs([],xae);if(O===0)return new At(p,v);for(let M=p;M<m;M+=O)for(let I=v;I<_;I+=O)j.push(new zv(M+B,I+B,B,h));let R=function(M){let I=0,q=0,X=0;const te=M[0];for(let le=0,ue=te.length,ie=ue-1;le<ue;ie=le++){const fe=te[le],ye=te[ie],Se=fe.x*ye.y-ye.x*fe.y;q+=(fe.x+ye.x)*Se,X+=(fe.y+ye.y)*Se,I+=3*Se}return new zv(q/I,X/I,0,M)}(h),F=j.length;for(;j.length;){const M=j.pop();(M.d>R.d||!R.d)&&(R=M,u&&console.log("found best %d after %d probes",Math.round(1e4*M.d)/1e4,F)),M.max-R.d<=s||(B=M.h/2,j.push(new zv(M.p.x-B,M.p.y-B,B,h)),j.push(new zv(M.p.x+B,M.p.y-B,B,h)),j.push(new zv(M.p.x-B,M.p.y+B,B,h)),j.push(new zv(M.p.x+B,M.p.y+B,B,h)),F+=4)}return u&&(console.log(`num probes: ${F}`),console.log(`best distance: ${R.d}`)),R.p}function xae(h,s){return s.max-h.max}class zv{constructor(s,u,p,v){this.p=new At(s,u),this.h=p,this.d=function(m,_){let C=!1,O=1/0;for(let B=0;B<_.length;B++){const j=_[B];for(let R=0,F=j.length,M=F-1;R<F;M=R++){const I=j[R],q=j[M];I.y>m.y!=q.y>m.y&&m.x<(q.x-I.x)*(m.y-I.y)/(q.y-I.y)+I.x&&(C=!C),O=Math.min(O,We(m,I,q))}}return(C?1:-1)*Math.sqrt(O)}(this.p,v),this.max=this.d+this.h*Math.SQRT2}}const nj=Number.POSITIVE_INFINITY,_ae=Math.sqrt(2);function Nz(h,[s,u]){let p=0,v=0;if(u===nj){s<0&&(s=0);const m=s/_ae;switch(h){case"top-right":case"top-left":v=m-7;break;case"bottom-right":case"bottom-left":v=7-m;break;case"bottom":v=7-s;break;case"top":v=s-7}switch(h){case"top-right":case"bottom-right":p=-m;break;case"top-left":case"bottom-left":p=m;break;case"left":p=s;break;case"right":p=-s}}else{switch(s=Math.abs(s),u=Math.abs(u),h){case"top-right":case"top-left":case"top":v=u-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-u}switch(h){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}}return[p,v]}function ij(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function bae(h,s,u,p,v,m,_,C,O,B,j,R,F,M,I){let q=m.textMaxSize.evaluate(s,{},R);q===void 0?q=_*m.textScaleFactor:q*=m.textScaleFactor;const X=h.layers[0].layout,te=X.get("icon-offset").evaluate(s,{},R),le=Cz(u.horizontal)||u.vertical,ue=F.name==="globe",ie=Do,fe=_*m.textScaleFactor/ie,ye=h.tilePixelRatio*q/ie,Se=(nt=h.overscaling,h.zoom>18&&nt>2&&(nt>>=1),Math.max(hr/(512*nt),1)*X.get("symbol-spacing")),Le=X.get("text-padding")*h.tilePixelRatio,Ie=X.get("icon-padding")*h.tilePixelRatio,Me=tt(X.get("text-max-angle")),et=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Be=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",rt=X.get("symbol-placement"),st=Se/2;var nt;const ct=X.get("icon-text-fit").evaluate(s,{},R),ht=X.get("icon-text-fit-padding").evaluate(s,{},R),vt=ct!=="none";let ut;h.hasAnyIconTextFit===!1&&vt&&(h.hasAnyIconTextFit=!0),p&&vt&&(h.allowVerticalPlacement&&u.vertical&&(ut=fz(p,u.vertical,ct,ht,te,fe)),le&&(p=fz(p,le,ct,ht,te,fe)));const It=(Wt,Rt,mr)=>{if(Rt.x<0||Rt.x>=hr||Rt.y<0||Rt.y>=hr)return;let dr=null;if(ue){const{x:tr,y:Ht,z:kr}=F.projectTilePoint(Rt.x,Rt.y,mr);dr={anchor:new em(tr,Ht,kr,0,void 0),up:F.upVector(mr,Rt.x,Rt.y)}}(function(tr,Ht,kr,vr,br,en,mn,_n,bn,Ln,Bn,Li,Pi,un,xi,Si,Yi,Da,os,La,Aa,Ga,Ss,Lo,Hi,hc,kh){const bd=tr.addToLineVertexArray(Ht,vr);let wd,a0,jg,s0,kb,cB,uB,dB=0,hB=0,fB=0,pB=0,Fj=-1,Bj=-1;const Df={};let mB=ml("");const o0=kr?kr.anchor:Ht,Vj=bn.layout.get("icon-text-fit").evaluate(Aa,{},Hi)!=="none";let Uj=0,$j=0;if(bn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Uj,$j]=bn.layout.get("text-offset").evaluate(Aa,{},Hi).map(Su=>Su*Do):(Uj=bn.layout.get("text-radial-offset").evaluate(Aa,{},Hi)*Do,$j=nj),tr.allowVerticalPlacement&&br.vertical){const Su=br.vertical;if(xi)cB=aj(Su),_n&&(uB=aj(_n));else{const fc=bn.layout.get("text-rotate").evaluate(Aa,{},Hi)+90;jg=Q2(Ln,o0,Ht,Bn,Li,Pi,Su,un,fc,Si),_n&&(s0=Q2(Ln,o0,Ht,Bn,Li,Pi,_n,Da,fc))}}if(en){const Su=tr.iconSizeData,fc=bn.layout.get("icon-rotate").evaluate(Aa,{},Hi),Eb=Tz(en,fc,Ss,Vj,Ga.iconScaleFactor),Gj=_n?Tz(_n,fc,Ss,Vj,Ga.iconScaleFactor):void 0;a0=Q2(Ln,o0,Ht,Bn,Li,Pi,en,Da,fc,null),dB=4*Eb.length;let l0=null;Su.kind==="source"?(l0=[Th*bn.layout.get("icon-size").evaluate(Aa,{},Hi)*Ga.iconScaleFactor],l0[0]>Ag&&sn(`${tr.layerIds[0]}: Value for "icon-size" is >= ${hb}. Reduce your "icon-size".`)):Su.kind==="composite"&&(l0=[Th*Ga.compositeIconSizes[0].evaluate(Aa,{},Hi)*Ga.iconScaleFactor,Th*Ga.compositeIconSizes[1].evaluate(Aa,{},Hi)*Ga.iconScaleFactor],(l0[0]>Ag||l0[1]>Ag)&&sn(`${tr.layerIds[0]}: Value for "icon-size" is >= ${hb}. Reduce your "icon-size".`)),tr.addSymbols(tr.icon,Eb,l0,La,os,Aa,!1,kr,Ht,bd.lineStartIndex,bd.lineLength,-1,Lo,Hi,hc,kh),Fj=tr.icon.placedSymbolArray.length-1,Gj&&(hB=4*Gj.length,tr.addSymbols(tr.icon,Gj,l0,La,os,Aa,bu.vertical,kr,Ht,bd.lineStartIndex,bd.lineLength,-1,Lo,Hi,hc,kh),Bj=tr.icon.placedSymbolArray.length-1)}for(const Su in br.horizontal){const fc=br.horizontal[Su];wd||(mB=ml(fc.text),xi?kb=aj(fc):wd=Q2(Ln,o0,Ht,Bn,Li,Pi,fc,un,bn.layout.get("text-rotate").evaluate(Aa,{},Hi),Si));const Eb=fc.positionedLines.length===1;if(fB+=jz(tr,kr,Ht,fc,mn,bn,xi,Aa,Si,bd,br.vertical?bu.horizontal:bu.horizontalOnly,Eb?Object.keys(br.horizontal):[Su],Df,Fj,Ga,Lo,Hi,hc),Eb)break}br.vertical&&(pB+=jz(tr,kr,Ht,br.vertical,mn,bn,xi,Aa,Si,bd,bu.vertical,["vertical"],Df,Bj,Ga,Lo,Hi,hc));let Cg=-1;const qj=(Su,fc)=>Su?Math.max(Su,fc):fc;Cg=qj(kb,Cg),Cg=qj(cB,Cg),Cg=qj(uB,Cg);const eoe=Cg>-1?1:0;tr.glyphOffsetArray.length>=65535&&sn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Aa.sortKey!==void 0&&tr.addToSortKeyRanges(tr.symbolInstances.length,Aa.sortKey),tr.symbolInstances.emplaceBack(Ht.x,Ht.y,o0.x,o0.y,o0.z,Df.right>=0?Df.right:-1,Df.center>=0?Df.center:-1,Df.left>=0?Df.left:-1,Df.vertical>=0?Df.vertical:-1,Fj,Bj,mB,wd!==void 0?wd:tr.collisionBoxArray.length,wd!==void 0?wd+1:tr.collisionBoxArray.length,jg!==void 0?jg:tr.collisionBoxArray.length,jg!==void 0?jg+1:tr.collisionBoxArray.length,a0!==void 0?a0:tr.collisionBoxArray.length,a0!==void 0?a0+1:tr.collisionBoxArray.length,s0||tr.collisionBoxArray.length,s0?s0+1:tr.collisionBoxArray.length,Bn,fB,pB,dB,hB,eoe,0,Uj,$j,Cg,0,Vj?1:0)})(h,Rt,dr,Wt,u,p,v,ut,h.layers[0],h.collisionBoxArray,s.index,s.sourceLayerIndex,h.index,Le,et,O,0,Ie,Be,te,s,m,B,j,R,M,I)};if(rt==="line")for(const Wt of xz(s.geometry,0,0,hr,hr)){const Rt=gae(Wt,Se,Me,u.vertical||le,p,ie,ye,h.overscaling,hr);for(const mr of Rt)le&&wae(h,le.text,st,mr)||It(Wt,mr,R)}else if(rt==="line-center"){for(const Wt of s.geometry)if(Wt.length>1){const Rt=mae(Wt,Me,u.vertical||le,p,ie,ye);Rt&&It(Wt,Rt,R)}}else if(s.type==="Polygon")for(const Wt of Tr(s.geometry,0)){const Rt=vae(Wt,16);It(Wt[0],new em(Rt.x,Rt.y,0,0,void 0),R)}else if(s.type==="LineString")for(const Wt of s.geometry)It(Wt,new em(Wt[0].x,Wt[0].y,0,0,void 0),R);else if(s.type==="Point")for(const Wt of s.geometry)for(const Rt of Wt)It([Rt],new em(Rt.x,Rt.y,0,0,void 0),R)}const hb=255,Ag=hb*Th;function jz(h,s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X,te){const le=function(fe,ye,Se,Le,Ie,Me,et,Be){const rt=[];if(ye.positionedLines.length===0)return rt;const st=Le.layout.get("text-rotate").evaluate(Me,{})*Math.PI/180,nt=function(It){const Wt=It[0],Rt=It[1],mr=Wt*Rt;return mr>0?[Wt,-Rt]:mr<0?[-Wt,Rt]:Wt===0?[Rt,Wt]:[Rt,-Wt]}(Se);let ct=Math.abs(ye.top-ye.bottom);for(const It of ye.positionedLines)ct-=It.lineOffset;const ht=ye.positionedLines.length,vt=ct/ht;let ut=ye.top-Se[1];for(let It=0;It<ht;++It){const Wt=ye.positionedLines[It];ut=yae(ye,vt,ut,It);for(const Rt of Wt.positionedGlyphs){if(!Rt.rect)continue;const mr=Rt.rect||{};let dr=dae+1,tr=!0,Ht=1,kr=0;if(Rt.imageName){const La=et[Ms.build(Rt.imageName).getSerializedPrimary()];if(!La)continue;if(La.sdf){sn("SDF images are not supported in formatted text and will be ignored.");continue}tr=!1,Ht=La.pixelRatio,dr=ub/Ht}const vr=(Ie||Be)&&Rt.vertical,br=Rt.metrics.advance*Rt.scale/2,en=Rt.metrics,mn=Rt.rect;if(mn===null)continue;Be&&ye.verticalizable&&(kr=Rt.imageName?br-Rt.metrics.width*Rt.scale/2:0);const _n=Ie?[Rt.x+br,Rt.y]:[0,0];let bn=[0,0],Ln=[0,0],Bn=!1;Ie||(vr?(Ln=[Rt.x+br+nt[0],Rt.y+nt[1]-kr],Bn=!0):bn=[Rt.x+br+Se[0],Rt.y+Se[1]-kr]);const Li=mn.w*Rt.scale/(Ht*(Rt.localGlyph?Ph:1)),Pi=mn.h*Rt.scale/(Ht*(Rt.localGlyph?Ph:1));let un,xi,Si,Yi;if(vr){const La=Rt.y-ut,Aa=new At(-br,br-La),Ga=-Math.PI/2,Ss=new At(...Ln);un=new At(-br+bn[0],bn[1]),un._rotateAround(Ga,Aa)._add(Ss),un.x+=-La+br,un.y-=(en.left-dr)*Rt.scale;const Lo=Rt.imageName?en.advance*Rt.scale:Do*Rt.scale,Hi=String.fromCodePoint(Rt.glyph);aae(Hi)?un.x+=(1-dr)*Rt.scale:sae(Hi)?un.x+=Lo-en.height*Rt.scale+(-dr-1)*Rt.scale:un.x+=Rt.imageName||en.width+2*dr===mn.w&&en.height+2*dr===mn.h?(Lo-Pi)/2:(Lo-(en.height+2*dr)*Rt.scale)/2,xi=new At(un.x,un.y-Li),Si=new At(un.x+Pi,un.y),Yi=new At(un.x+Pi,un.y-Li)}else{const La=(en.left-dr)*Rt.scale-br+bn[0],Aa=(-en.top-dr)*Rt.scale+bn[1],Ga=La+Li,Ss=Aa+Pi;un=new At(La,Aa),xi=new At(Ga,Aa),Si=new At(La,Ss),Yi=new At(Ga,Ss)}if(st){let La;La=Ie?new At(0,0):Bn?new At(nt[0],nt[1]):new At(Se[0],Se[1]),un._rotateAround(st,La),xi._rotateAround(st,La),Si._rotateAround(st,La),Yi._rotateAround(st,La)}const Da=new At(0,0),os=new At(0,0);rt.push({tl:un,tr:xi,bl:Si,br:Yi,texPrimary:mr,texSecondary:void 0,writingMode:ye.writingMode,glyphOffset:_n,sectionIndex:Rt.sectionIndex,isSDF:tr,pixelOffsetTL:Da,pixelOffsetBR:os,minFontScaleX:0,minFontScaleY:0})}}return rt}(0,p,O,m,_,C,v,h.allowVerticalPlacement),ue=h.textSizeData;let ie=null;ue.kind==="source"?(ie=[Th*m.layout.get("text-size").evaluate(C,{},X)*I.textScaleFactor],ie[0]>Ag&&sn(`${h.layerIds[0]}: Value for "text-size" is >= ${hb}. Reduce your "text-size".`)):ue.kind==="composite"&&(ie=[Th*I.compositeTextSizes[0].evaluate(C,{},X)*I.textScaleFactor,Th*I.compositeTextSizes[1].evaluate(C,{},X)*I.textScaleFactor],(ie[0]>Ag||ie[1]>Ag)&&sn(`${h.layerIds[0]}: Value for "text-size" is >= ${hb}. Reduce your "text-size".`)),h.addSymbols(h.text,le,ie,O,_,C,j,s,u,B.lineStartIndex,B.lineLength,M,q,X,te,!1);for(const fe of R)F[fe]=h.text.placedSymbolArray.length-1;return 4*le.length}function Cz(h){for(const s in h)return h[s];return null}function Q2(h,s,u,p,v,m,_,C,O,B){let j=_.top,R=_.bottom,F=_.left,M=_.right;const I=_.collisionPadding;if(I&&(F-=I[0],j-=I[1],M+=I[2],R+=I[3]),O){const q=new At(F,j),X=new At(M,j),te=new At(F,R),le=new At(M,R),ue=tt(O);let ie=new At(0,0);B&&(ie=new At(B[0],B[1])),q._rotateAround(ue,ie),X._rotateAround(ue,ie),te._rotateAround(ue,ie),le._rotateAround(ue,ie),F=Math.min(q.x,X.x,te.x,le.x),M=Math.max(q.x,X.x,te.x,le.x),j=Math.min(q.y,X.y,te.y,le.y),R=Math.max(q.y,X.y,te.y,le.y)}return h.emplaceBack(s.x,s.y,s.z,u.x,u.y,F,j,M,R,C,p,v,m),h.length-1}function aj(h){h.collisionPadding&&(h.top-=h.collisionPadding[1],h.bottom+=h.collisionPadding[3]);const s=h.bottom-h.top;return s>0?Math.max(10,s):null}function wae(h,s,u,p){const v=h.compareText;if(s in v){const m=v[s];for(let _=m.length-1;_>=0;_--)if(p.dist(m[_])<u)return!0}else v[s]=[];return v[s].push(p),!1}function kz(h,s){const u=h.fovAboveCenter,p=h.elevation?h.elevation.getMinElevationBelowMSL()*s:0,v=(h._camera.position[2]*h.worldSize-p)/Math.cos(h._pitch),m=Math.sin(u)*v/Math.sin(Math.max(Math.PI/2-h._pitch-u,.01));let _=Math.sin(h._pitch)*m+v;const C=v*(1/h._horizonShift);if(!h.elevation||h.elevation.exaggeration()===0){let O=Math.max(h.zoom-17,0);h.isOrthographic&&(O/=10),_*=1+O}return Math.min(1.01*_,C)}function fb(h,s){if(!s.isReprojectedInTileSpace)return{scale:1<<h.z,x:h.x,y:h.y,x2:h.x+1,y2:h.y+1,projection:s};const u=Math.pow(2,-h.z),p=h.x*u,v=(h.x+1)*u,m=h.y*u,_=(h.y+1)*u,C=il(p),O=il(v),B=Vr(m),j=Vr(_),R=s.project(C,B),F=s.project(O,B),M=s.project(O,j),I=s.project(C,j);let q=Math.min(R.x,F.x,M.x,I.x),X=Math.min(R.y,F.y,M.y,I.y),te=Math.max(R.x,F.x,M.x,I.x),le=Math.max(R.y,F.y,M.y,I.y);const ue=u/16;function ie(ye,Se,Le,Ie,Me,et){const Be=(Le+Me)/2,rt=(Ie+et)/2,st=s.project(il(Be),Vr(rt)),nt=Math.max(0,q-st.x,X-st.y,st.x-te,st.y-le);q=Math.min(q,st.x),te=Math.max(te,st.x),X=Math.min(X,st.y),le=Math.max(le,st.y),nt>ue&&(ie(ye,st,Le,Ie,Be,rt),ie(st,Se,Be,rt,Me,et))}ie(R,F,p,m,v,m),ie(F,M,v,m,v,_),ie(M,I,v,_,p,_),ie(I,R,p,_,p,m),q-=ue,X-=ue,te+=ue,le+=ue;const fe=1/Math.max(te-q,le-X);return{scale:fe,x:q*fe,y:X*fe,x2:te*fe,y2:le*fe,projection:s}}function Ez(h,{x:s,y:u},p=0){return new At(((s-p)*h.scale-h.x)*hr,(u*h.scale-h.y)*hr)}const Sae=De.mat4.identity(new Float32Array(16));class Tg{constructor(s){this.spec=s,this.name=s.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(s,u){return{x:0,y:0,z:0}}unproject(s,u){return new Zn(0,0)}projectTilePoint(s,u,p){return{x:s,y:u,z:0}}locationPoint(s,u,p=!0){return s._coordinatePoint(s.locationCoordinate(u),p)}pixelsPerMeter(s,u){return Gi(1,s)*u}pixelSpaceConversion(s,u,p){return 1}farthestPixelDistance(s){return kz(s,s.pixelsPerMeter)}pointCoordinate(s,u,p,v){const m=s.horizonLineFromTop(!1),_=new At(u,Math.max(m,p));return s.rayIntersectionCoordinate(s.pointRayIntersection(_,v))}pointCoordinate3D(s,u,p){const v=new At(u,p);if(s.elevation)return s.elevation.pointCoordinate(v);{const m=this.pointCoordinate(s,v.x,v.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(s,u){if(s.elevation&&s.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(s,u.x,u.y);const p=s.horizonLineFromTop();return u.y<p}createInversionMatrix(s,u){return Sae}createTileMatrix(s,u,p){let v,m,_;const C=p.canonical,O=De.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const B=fb(C,this);v=1,m=B.x+p.wrap*B.scale,_=B.y,De.mat4.scale(O,O,[v/B.scale,v/B.scale,s.pixelsPerMeter/u])}else v=u/s.zoomScale(C.z),m=(C.x+Math.pow(2,C.z)*p.wrap)*v,_=C.y*v;return De.mat4.translate(O,O,[m,_,0]),De.mat4.scale(O,O,[v/hr,v/hr,1]),O}upVector(s,u,p){return[0,0,1]}upVectorScale(s,u,p){return{metersToTile:1}}}class Aae extends Tg{constructor(s){super(s),this.range=[4,7],this.center=s.center||[-96,37.5];const[u,p]=this.parallels=s.parallels||[29.5,45.5],v=Math.sin(tt(u));this.n=(v+Math.sin(tt(p)))/2,this.c=1+v*(2*this.n-v),this.r0=Math.sqrt(this.c)/this.n}project(s,u){const{n:p,c:v,r0:m}=this,_=tt(s-this.center[0]),C=tt(u),O=Math.sqrt(v-2*p*Math.sin(C))/p;return{x:O*Math.sin(_*p),y:O*Math.cos(_*p)-m,z:0}}unproject(s,u){const{n:p,c:v,r0:m}=this,_=m+u;let C=Math.atan2(s,Math.abs(_))*Math.sign(_);_*p<0&&(C-=Math.PI*Math.sign(s)*Math.sign(_));const O=tt(this.center[0])*p;C=Gn(C,-Math.PI-O,Math.PI-O);const B=ur(xt(C/p)+this.center[0],-180,180),j=Math.asin(ur((v-(s*s+_*_)*p*p)/(2*p),-1,1)),R=ur(xt(j),-85.051129,ro);return new Zn(B,R)}}const pb=1.340264,mb=-.081106,gb=893e-6,yb=.003796,eS=Math.sqrt(3)/2;class Tae extends Tg{project(s,u){u=u/180*Math.PI,s=s/180*Math.PI;const p=Math.asin(eS*Math.sin(u)),v=p*p,m=v*v*v;return{x:.5*(s*Math.cos(p)/(eS*(pb+3*mb*v+m*(7*gb+9*yb*v)))/Math.PI+.5),y:1-.5*(p*(pb+mb*v+m*(gb+yb*v))/Math.PI+1),z:0}}unproject(s,u){s=(2*s-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,v=p*p,m=v*v*v;for(let j,R,F,M=0;M<12&&(R=p*(pb+mb*v+m*(gb+yb*v))-u,F=pb+3*mb*v+m*(7*gb+9*yb*v),j=R/F,p=ur(p-j,-Math.PI/3,Math.PI/3),v=p*p,m=v*v*v,!(Math.abs(j)<1e-12));++M);const _=eS*s*(pb+3*mb*v+m*(7*gb+9*yb*v))/Math.cos(p),C=Math.asin(Math.sin(p)/eS),O=ur(180*_/Math.PI,-180,180),B=ur(180*C/Math.PI,-85.051129,ro);return new Zn(O,B)}}class Pae extends Tg{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0}project(s,u){return{x:.5+s/360,y:.5-u/360,z:0}}unproject(s,u){const p=360*(s-.5),v=ur(360*(.5-u),-85.051129,ro);return new Zn(p,v)}}const Fv=Math.PI/2;function tS(h){return Math.tan((Fv+h)/2)}class Nae extends Tg{constructor(s){super(s),this.center=s.center||[0,30];const[u,p]=this.parallels=s.parallels||[30,30];let v=tt(u),m=tt(p);this.southernCenter=v+m<0,this.southernCenter&&(v=-v,m=-m);const _=Math.cos(v),C=tS(v);this.n=v===m?Math.sin(v):Math.log(_/Math.cos(m))/Math.log(tS(m)/C),this.f=_*Math.pow(tS(v),this.n)/this.n}project(s,u){u=tt(u),this.southernCenter&&(u=-u),s=tt(s-this.center[0]);const p=1e-6,{n:v,f:m}=this;m>0?u<-Fv+p&&(u=-Fv+p):u>Fv-p&&(u=Fv-p);const _=m/Math.pow(tS(u),v);let C=_*Math.sin(v*s),O=m-_*Math.cos(v*s);return C=.5*(C/Math.PI+.5),O=.5*(O/Math.PI+.5),{x:C,y:this.southernCenter?O:1-O,z:0}}unproject(s,u){s=(2*s-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:p,f:v}=this,m=v-u,_=Math.sign(m),C=Math.sign(p)*Math.sqrt(s*s+m*m);let O=Math.atan2(s,Math.abs(m))*_;m*p<0&&(O-=Math.PI*Math.sign(s)*_);const B=ur(xt(O/p)+this.center[0],-180,180),j=ur(xt(2*Math.atan(Math.pow(v/C,1/p))-Fv),-85.051129,ro);return new Zn(B,this.southernCenter?-j:j)}}class Mz extends Tg{constructor(s){super(s),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(s,u){return{x:Vc(s),y:nl(u),z:0}}unproject(s,u){const p=il(s),v=Vr(u);return new Zn(p,v)}}const Oz=tt(ro);class jae extends Tg{project(s,u){const p=(u=tt(u))*u,v=p*p;return{x:.5*((s=tt(s))*(.8707-.131979*p+v*(v*(.003971*p-.001529*v)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+p*(.015085+v*(.028874*p-.044475-.005916*v)))/Math.PI+1),z:0}}unproject(s,u){s=(2*s-.5)*Math.PI;let p=u=(2*(1-u)-1)*Math.PI,v=25,m=0,_=p*p;do{_=p*p;const B=_*_;m=(p*(1.007226+_*(.015085+B*(.028874*_-.044475-.005916*B)))-u)/(1.007226+_*(.045255+B*(.259866*_-.311325-.005916*11*B))),p=ur(p-m,-Oz,Oz)}while(Math.abs(m)>1e-6&&--v>0);_=p*p;const C=ur(xt(s/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),O=xt(p);return new Zn(C,O)}}const Rz=tt(ro);class Cae extends Tg{project(s,u){u=tt(u),s=tt(s);const p=Math.cos(u),v=2/Math.PI,m=Math.acos(p*Math.cos(s/2)),_=Math.sin(m)/m,C=.5*(s*v+2*p*Math.sin(s/2)/_)||0,O=.5*(u+Math.sin(u)/_)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(O/Math.PI+1),z:0}}unproject(s,u){let p=s=(2*s-.5)*Math.PI,v=u=(2*(1-u)-1)*Math.PI,m=25;const _=1e-6;let C=0,O=0;do{const B=Math.cos(v),j=Math.sin(v),R=2*j*B,F=j*j,M=B*B,I=Math.cos(p/2),q=Math.sin(p/2),X=2*I*q,te=q*q,le=1-M*I*I,ue=le?1/le:0,ie=le?Math.acos(B*I)*Math.sqrt(1/le):0,fe=.5*(2*ie*B*q+2*p/Math.PI)-s,ye=.5*(ie*j+v)-u,Se=.5*ue*(M*te+ie*B*I*F)+1/Math.PI,Le=ue*(X*R/4-ie*j*q),Ie=.125*ue*(R*q-ie*j*M*X),Me=.5*ue*(F*I+ie*te*B)+.5,et=Le*Ie-Me*Se;C=(ye*Le-fe*Me)/et,O=(fe*Ie-ye*Se)/et,p=ur(p-C,-Math.PI,Math.PI),v=ur(v-O,-Rz,Rz)}while((Math.abs(C)>_||Math.abs(O)>_)&&--m>0);return new Zn(xt(p),xt(v))}}class Iz extends Tg{constructor(s){super(s),this.center=s.center||[0,0],this.parallels=s.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(tt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(s,u){const{scale:p,cosPhi:v}=this;return{x:tt(s)*v*p+.5,y:-Math.sin(tt(u))/v*p+.5,z:0}}unproject(s,u){const{scale:p,cosPhi:v}=this,m=-(u-.5)/p,_=ur(xt((s-.5)/p)/v,-180,180),C=Math.asin(ur(m*v,-1,1)),O=ur(xt(C),-85.051129,ro);return new Zn(_,O)}}class kae extends Mz{constructor(s){super(s),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(s,u,p){const v=wi(s,u,p),m=as(Ea(p));return De.vec3.transformMat4(v,v,m),{x:v[0],y:v[1],z:v[2]}}locationPoint(s,u){const p=_h(u.lat,u.lng),v=De.vec3.normalize([],p),m=s.elevation?s.elevation.getAtPointOrZero(s.locationCoordinate(u),s._centerAltitude):s._centerAltitude,_=Gi(1,0)*hr*m;De.vec3.scaleAndAdd(p,p,v,_);const C=De.mat4.identity(new Float64Array(16));return De.mat4.multiply(C,s.pixelMatrix,s.globeMatrix),De.vec3.transformMat4(p,p,C),new At(p[0],p[1])}pixelsPerMeter(s,u){return Gi(1,0)*u}pixelSpaceConversion(s,u,p){const v=Gi(1,s)*u,m=Fr(Gi(1,45)*u,v,p);return this.pixelsPerMeter(s,u)/m}createTileMatrix(s,u,p){const v=ji(Ea(p.canonical));return De.mat4.multiply(new Float64Array(16),s.globeMatrix,v)}createInversionMatrix(s,u){const{center:p}=s,v=as(Ea(u));return De.mat4.rotateY(v,v,tt(p.lng)),De.mat4.rotateX(v,v,tt(p.lat)),De.mat4.scale(v,v,[s._pixelsPerMercatorPixel,s._pixelsPerMercatorPixel,1]),Float32Array.from(v)}pointCoordinate(s,u,p,v){return oi(s,u,p,!0)||new d(0,0)}pointCoordinate3D(s,u,p){const v=this.pointCoordinate(s,u,p,0);return[v.x,v.y,v.z]}isPointAboveHorizon(s,u){return!oi(s,u.x,u.y,!1)}farthestPixelDistance(s){const u=function(v,m){const _=v.cameraToCenterDistance,C=v._centerAltitude*m,O=v._camera,B=v._camera.forward(),j=De.vec3.add([],De.vec3.scale([],B,-_),[0,0,C]),R=v.worldSize/(2*Math.PI),F=[0,0,-R],M=v.width/v.height,I=Math.tan(v.fovAboveCenter),q=De.vec3.scale([],O.up(),I),X=De.vec3.scale([],O.right(),I*M),te=De.vec3.normalize([],De.vec3.add([],De.vec3.add([],B,q),X)),le=[];let ue;if(new Zr(j,te).closestPointOnSphere(F,R,le)){const ie=De.vec3.add([],le,F),fe=De.vec3.sub([],ie,j);ue=Math.cos(v.fovAboveCenter)*De.vec3.length(fe)}else{const ie=De.vec3.sub([],j,F),fe=De.vec3.sub([],F,j);De.vec3.normalize(fe,fe);const ye=De.vec3.length(ie)-R;ue=Math.sqrt(ye*(ye+2*R));const Se=Math.acos(ue/(R+ye))-Math.acos(De.vec3.dot(B,fe));ue*=Math.cos(Se)}return 1.01*ue}(s,this.pixelsPerMeter(s.center.lat,s.worldSize)),p=Ro(s.zoom);if(p>0){const v=kz(s,Gi(1,s.center.lat)*s.worldSize),m=s.worldSize/(2*Math.PI),_=Math.max(s.width,s.height)/s.worldSize*Math.PI;return Fr(u,v+m*(1-Math.cos(_)),Math.pow(p,10))}return u}upVector(s,u,p){return wi(u,p,s,1)}upVectorScale(s){return{metersToTile:In(zn(Ea(s)))}}}function Dz(h){const s=h.parallels,u=!!s&&Math.abs(s[0]+s[1])<.01;switch(h.name){case"mercator":return new Mz(h);case"equirectangular":return new Pae(h);case"naturalEarth":return new jae(h);case"equalEarth":return new Tae(h);case"winkelTripel":return new Cae(h);case"albers":return u?new Iz(h):new Aae(h);case"lambertConformalConic":return u?new Iz(h):new Nae(h);case"globe":return new kae(h)}throw new Error(`Invalid projection name: ${h.name}`)}const Eae=Rv.VectorTileFeature.types,Mae=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rS(h,s,u,p,v,m,_,C,O,B,j,R,F){const M=C?Math.min(Ag,Math.round(C[0])):0,I=C?Math.min(Ag,Math.round(C[1])):0;h.emplaceBack(s,u,Math.round(32*p),Math.round(32*v),m,_,(M<<1)+(O?1:0),I,16*B,16*j,256*R,256*F)}function nS(h,s,u){h.emplaceBack(s,u)}function iS(h,s,u,p,v,m,_){h.emplaceBack(s,u,p,v,m,_)}function aS(h,s,u,p,v){h.emplaceBack(s,u,p,v),h.emplaceBack(s,u,p,v),h.emplaceBack(s,u,p,v),h.emplaceBack(s,u,p,v)}function Oae(h){for(const s of h.sections)if(eg(s.text))return!0;return!1}class sj{constructor(s){this.layoutVertexArray=new Bp,this.indexArray=new _s,this.programConfigurations=s,this.segments=new va,this.dynamicLayoutVertexArray=new mu,this.opacityVertexArray=new Ul,this.placedSymbolArray=new Vy,this.iconTransitioningVertexArray=new Rs,this.globeExtVertexArray=new Vp,this.zOffsetVertexArray=new bf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(s,u,p,v,m){this.isEmpty()||(p&&(this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,Zie.members),this.indexBuffer=s.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=s.createVertexBuffer(this.dynamicLayoutVertexArray,Xie.members,!0),this.opacityVertexBuffer=s.createVertexBuffer(this.opacityVertexArray,Mae,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=s.createVertexBuffer(this.iconTransitioningVertexArray,Qie.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=s.createVertexBuffer(this.globeExtVertexArray,Yie.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||m)&&(this.zOffsetVertexBuffer=s.createVertexBuffer(this.zOffsetVertexArray,Jie.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||v)&&this.programConfigurations.upload(s))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}gr(sj,"SymbolBuffers");class oj{constructor(s,u,p){this.layoutVertexArray=new s,this.layoutAttributes=u,this.indexArray=new p,this.segments=new va,this.collisionVertexArray=new og,this.collisionVertexArrayExt=new mu}upload(s){this.layoutVertexBuffer=s.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=s.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=s.createVertexBuffer(this.collisionVertexArray,eae.members,!0),this.collisionVertexBufferExt=s.createVertexBuffer(this.collisionVertexArrayExt,tae.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}gr(oj,"CollisionBuffers");class sS{constructor(s){this.collisionBoxArray=s.collisionBoxArray,this.zoom=s.zoom,this.lut=s.lut,this.overscaling=s.overscaling,this.layers=s.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=s.index,this.pixelRatio=s.pixelRatio,this.sourceLayerIndex=s.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=De.mat4.identity([]),this.placementViewportMatrix=De.mat4.identity([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=YN(this.zoom,u["text-size"]),this.iconSizeData=YN(this.zoom,u["icon-size"]);const p=this.layers[0].layout,v=p.get("symbol-sort-key"),m=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&v.constantOr(1)!==void 0,this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(_=>bu[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=s.sourceID,this.projection=s.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=p.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new sj(new xu(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("text")||s.startsWith("symbol"))),this.icon=new sj(new xu(this.layers,{zoom:this.zoom,lut:this.lut},s=>s.startsWith("icon")||s.startsWith("symbol"))),this.glyphOffsetArray=new bv,this.lineVertexArray=new qy,this.symbolInstances=new $y}calculateGlyphDependencies(s,u,p,v,m){for(const _ of s){const C=_.codePointAt(0);if(C===void 0)break;if(u[C]=!0,v&&m&&C<=65535){const O=lb[_];O&&(u[O.charCodeAt(0)]=!0)}}}updateFootprints(s,u){}updateReplacement(s,u){if(u.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=u.updateTime;const p=u.getReplacementRegionsForTile(s.toUnwrapped(),!0);return!UN(this.activeReplacements,p)&&(this.activeReplacements=p,!0)}populate(s,u,p,v){const m=this.layers[0],_=m.layout,C=this.projection.name==="globe",O=_.get("text-font"),B=_.get("text-field"),j=_.get("icon-image"),[R,F]=_.get("icon-size-scale-range"),M=ur(u.scaleFactor||1,R,F),I=(B.value.kind!=="constant"||B.value.value instanceof Es&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&(O.value.kind!=="constant"||O.value.value.length>0),q=j.value.kind!=="constant"||!!j.value.value||Object.keys(j.parameters).length>0,X=_.get("symbol-sort-key");if(this.features=[],!I&&!q)return;const te=u.iconDependencies,le=u.glyphDependencies,ue=u.availableImages,ie=new bi(this.zoom);for(const{feature:fe,id:ye,index:Se,sourceLayerIndex:Le}of s){const Ie=m._featureFilter.needGeometry,Me=re(fe,Ie);if(!m._featureFilter.filter(ie,Me,p))continue;if(Ie||(Me.geometry=Y(fe,p,v)),C&&fe.type!==1&&p.z<=5){const nt=Me.geometry,ct=.98078528056,ht=(vt,ut)=>{const It=wi(vt.x,vt.y,p,1),Wt=wi(ut.x,ut.y,p,1);return De.vec3.dot(It,Wt)<ct};for(let vt=0;vt<nt.length;vt++)nt[vt]=k(nt[vt],ht)}let et,Be;if(I){const nt=m.getValueAndResolveTokens("text-field",Me,p,ue),ct=Es.factory(nt);Oae(ct)&&(this.hasRTLText=!0),(!this.hasRTLText||ch()==="unavailable"||this.hasRTLText&&Jo.isParsed())&&(et=iae(ct,m,Me))}if(q){const nt=m.getValueAndResolveTokens("icon-image",Me,p,ue);Be=nt instanceof Ms?nt:Ms.build(nt)}if(!et&&!Be)continue;const rt=this.sortFeaturesByKey?X.evaluate(Me,{},p):void 0,st={id:ye,text:et,icon:Be,index:Se,sourceLayerIndex:Le,geometry:Me.geometry,properties:fe.properties,type:Eae[fe.type],sortKey:rt};if(this.features.push(st),Be){const nt=ZN(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],p,this.zoom,st)*M*this.pixelRatio,ct=Be.getPrimary().scaleSelf(nt);if(te[ct.id]=te[ct.id]||[],te[ct.id].push(ct),Be.nameSecondary){const ht=Be.getSecondary().scaleSelf(nt);te[ht.id]=te[ht.id]||[],te[ht.id].push(ht)}}if(et){const nt=O.evaluate(Me,{},p).join(","),ct=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(bu.vertical)>=0;for(const ht of et.sections)if(ht.image){const vt=ht.image.getPrimary().scaleSelf(this.pixelRatio);te[vt.id]=te[vt.id]||[],te[vt.id].push(vt)}else{const vt=Dp(et.toString()),ut=ht.fontStack||nt,It=le[ut]=le[ut]||{};this.calculateGlyphDependencies(ht.text,It,ct,this.allowVerticalPlacement,vt)}}}_.get("symbol-placement")==="line"&&(this.features=function(fe){const ye={},Se={},Le=[];let Ie=0;function Me(st){Le.push(fe[st]),Ie++}function et(st,nt,ct){const ht=Se[st];return delete Se[st],Se[nt]=ht,Le[ht].geometry[0].pop(),Le[ht].geometry[0]=Le[ht].geometry[0].concat(ct[0]),ht}function Be(st,nt,ct){const ht=ye[nt];return delete ye[nt],ye[st]=ht,Le[ht].geometry[0].shift(),Le[ht].geometry[0]=ct[0].concat(Le[ht].geometry[0]),ht}function rt(st,nt,ct){const ht=ct?nt[0][nt[0].length-1]:nt[0][0];return`${st}:${ht.x}:${ht.y}`}for(let st=0;st<fe.length;st++){const nt=fe[st],ct=nt.geometry,ht=nt.text?nt.text.toString():null;if(!ht){Me(st);continue}const vt=rt(ht,ct),ut=rt(ht,ct,!0);if(vt in Se&&ut in ye&&Se[vt]!==ye[ut]){const It=Be(vt,ut,ct),Wt=et(vt,ut,Le[It].geometry);delete ye[vt],delete Se[ut],Se[rt(ht,Le[Wt].geometry,!0)]=Wt,Le[It].geometry=null}else vt in Se?et(vt,ut,ct):ut in ye?Be(vt,ut,ct):(Me(st),ye[vt]=Ie-1,Se[ut]=Ie-1)}return Le.filter(st=>st.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((fe,ye)=>fe.sortKey-ye.sortKey)}update(s,u,p,v,m,_,C){this.text.programConfigurations.updatePaintArrays(s,u,m,p,v,_,C),this.icon.programConfigurations.updatePaintArrays(s,u,m,p,v,_,C)}updateZOffset(){const s=(m,_,C)=>{p+=_,p>m.length&&m.resize(p);for(let O=-_;O<0;O++)m.emplace(O+p,C)},u=(m,_,C)=>{v+=_,v>m.length&&m.resize(v);for(let O=-_;O<0;O++)m.emplace(O+v,C)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let p=0,v=0;for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m),{numHorizontalGlyphVertices:C,numVerticalGlyphVertices:O,numIconVertices:B}=_,j=_.zOffset,R=B>0;if((C>0||O>0)&&(s(this.text.zOffsetVertexArray,C,j),s(this.text.zOffsetVertexArray,O,j)),R){const{placedIconSymbolIndex:F,verticalPlacedIconSymbolIndex:M}=_;F>=0&&u(this.icon.zOffsetVertexArray,B,j),M>=0&&u(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,j)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(s){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(s),this.iconCollisionBox.upload(s)),this.text.upload(s,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(s,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Dz(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(s,u){const p=this.lineVertexArray.length;if(s.segment!==void 0)for(const{x:v,y:m}of u)this.lineVertexArray.emplaceBack(v,m);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(s,u,p,v,m,_,C,O,B,j,R,F,M,I,q,X){const te=s.indexArray,le=s.layoutVertexArray,ue=s.globeExtVertexArray,ie=s.segments.prepareSegment(4*u.length,le,te,this.canOverlap?_.sortKey:void 0),fe=this.glyphOffsetArray.length,ye=ie.vertexLength,Se=this.allowVerticalPlacement&&C===bu.vertical?Math.PI/2:0,Le=_.text&&_.text.sections;for(let Me=0;Me<u.length;Me++){const{tl:et,tr:Be,bl:rt,br:st,texPrimary:nt,texSecondary:ct,pixelOffsetTL:ht,pixelOffsetBR:vt,minFontScaleX:ut,minFontScaleY:It,glyphOffset:Wt,isSDF:Rt,sectionIndex:mr}=u[Me],dr=ie.vertexLength,tr=Wt[1];if(rS(le,B.x,B.y,et.x,tr+et.y,nt.x,nt.y,p,Rt,ht.x,ht.y,ut,It),rS(le,B.x,B.y,Be.x,tr+Be.y,nt.x+nt.w,nt.y,p,Rt,vt.x,ht.y,ut,It),rS(le,B.x,B.y,rt.x,tr+rt.y,nt.x,nt.y+nt.h,p,Rt,ht.x,vt.y,ut,It),rS(le,B.x,B.y,st.x,tr+st.y,nt.x+nt.w,nt.y+nt.h,p,Rt,vt.x,vt.y,ut,It),O){const{x:Ht,y:kr,z:vr}=O.anchor,[br,en,mn]=O.up;iS(ue,Ht,kr,vr,br,en,mn),iS(ue,Ht,kr,vr,br,en,mn),iS(ue,Ht,kr,vr,br,en,mn),iS(ue,Ht,kr,vr,br,en,mn),aS(s.dynamicLayoutVertexArray,Ht,kr,vr,Se)}else aS(s.dynamicLayoutVertexArray,B.x,B.y,B.z,Se);if(X){const Ht=ct||nt;nS(s.iconTransitioningVertexArray,Ht.x,Ht.y),nS(s.iconTransitioningVertexArray,Ht.x+Ht.w,Ht.y),nS(s.iconTransitioningVertexArray,Ht.x,Ht.y+Ht.h),nS(s.iconTransitioningVertexArray,Ht.x+Ht.w,Ht.y+Ht.h)}te.emplaceBack(dr,dr+1,dr+2),te.emplaceBack(dr+1,dr+2,dr+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wt[0]),Me!==u.length-1&&mr===u[Me+1].sectionIndex||s.programConfigurations.populatePaintArrays(le.length,_,_.index,{},M,I,q,Le&&Le[mr])}const Ie=O?O.anchor:B;s.placedSymbolArray.emplaceBack(Ie.x,Ie.y,Ie.z,B.x,B.y,fe,this.glyphOffsetArray.length-fe,ye,j,R,B.segment,p?p[0]:0,p?p[1]:0,v[0],v[1],C,0,!1,0,F,0)}_commitLayoutVertex(s,u,p,v,m,_,C){s.emplaceBack(u,p,v,m,_,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(s,u,p,v,m,_,C){const O=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),B=O.vertexLength,j=C.tileAnchorX,R=C.tileAnchorY;for(let M=0;M<4;M++)p.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(p.collisionVertexArrayExt,u,s.padding,C.zOffset),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,j,R,new At(s.x1,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,j,R,new At(s.x2,s.y1)),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,j,R,new At(s.x2,s.y2)),this._commitLayoutVertex(p.layoutVertexArray,v,m,_,j,R,new At(s.x1,s.y2)),O.vertexLength+=4;const F=p.indexArray;F.emplaceBack(B,B+1),F.emplaceBack(B+1,B+2),F.emplaceBack(B+2,B+3),F.emplaceBack(B+3,B),O.primitiveLength+=4}_addTextDebugCollisionBoxes(s,u,p,v,m,_){for(let C=v;C<m;C++){const O=p.get(C),B=this.getSymbolInstanceTextSize(s,_,u,C);this._addCollisionDebugVertices(O,B,this.textCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(s,u,p,v,m,_){for(let C=v;C<m;C++){const O=p.get(C),B=this.getSymbolInstanceIconSize(s,u,_.placedIconSymbolIndex);this._addCollisionDebugVertices(O,B,this.iconCollisionBox,O.projectedAnchorX,O.projectedAnchorY,O.projectedAnchorZ,_)}}generateCollisionDebugBuffers(s,u,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new oj(_f,iz.members,Rs),this.iconCollisionBox=new oj(_f,iz.members,Rs);const v=Iv(this.iconSizeData,s),m=Iv(this.textSizeData,s,p);for(let _=0;_<this.symbolInstances.length;_++){const C=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(m,s,u,C.textBoxStartIndex,C.textBoxEndIndex,C),this._addTextDebugCollisionBoxes(m,s,u,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._addIconDebugCollisionBoxes(v,s,u,C.iconBoxStartIndex,C.iconBoxEndIndex,C),this._addIconDebugCollisionBoxes(v,s,u,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C)}}getSymbolInstanceTextSize(s,u,p,v){const m=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:v),_=W2(this.textSizeData,s,m)/Do;return this.tilePixelRatio*_}getSymbolInstanceIconSize(s,u,p){const v=this.icon.placedSymbolArray.get(p),m=W2(this.iconSizeData,s,v);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(s,u,p,v){s.emplaceBack(u,-p,-p,v),s.emplaceBack(u,p,-p,v),s.emplaceBack(u,p,p,v),s.emplaceBack(u,-p,p,v)}_updateTextDebugCollisionBoxes(s,u,p,v,m,_,C){for(let O=v;O<m;O++){const B=p.get(O),j=this.getSymbolInstanceTextSize(s,_,u,O);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,j,B.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(s,u,p,v,m,_,C){for(let O=v;O<m;O++){const B=p.get(O),j=this.getSymbolInstanceIconSize(s,u,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,j,B.padding,_.zOffset)}}updateCollisionDebugBuffers(s,u,p,v){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const m=Iv(this.iconSizeData,s,v),_=Iv(this.textSizeData,s,p);for(let C=0;C<this.symbolInstances.length;C++){const O=this.symbolInstances.get(C);this._updateTextDebugCollisionBoxes(_,s,u,O.textBoxStartIndex,O.textBoxEndIndex,O,p),this._updateTextDebugCollisionBoxes(_,s,u,O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,p),this._updateIconDebugCollisionBoxes(m,s,u,O.iconBoxStartIndex,O.iconBoxEndIndex,O,v),this._updateIconDebugCollisionBoxes(m,s,u,O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,v)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(s,u,p,v,m,_,C,O,B){const j={};if(u<p){const{x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:fe}=s.get(u);j.textBox={x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},j.textFeatureIndex=fe}if(v<m){const{x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:fe}=s.get(v);j.verticalTextBox={x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},j.verticalTextFeatureIndex=fe}if(_<C){const{x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:fe}=s.get(_);j.iconBox={x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},j.iconFeatureIndex=fe}if(O<B){const{x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie,featureIndex:fe}=s.get(O);j.verticalIconBox={x1:R,y1:F,x2:M,y2:I,padding:q,projectedAnchorX:X,projectedAnchorY:te,projectedAnchorZ:le,tileAnchorX:ue,tileAnchorY:ie},j.verticalIconFeatureIndex=fe}return j}deserializeCollisionBoxes(s){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(s,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(s,u){const p=s.placedSymbolArray.get(u),v=p.vertexStartIndex+4*p.numGlyphs;for(let m=p.vertexStartIndex;m<v;m+=4)s.indexArray.emplaceBack(m,m+1,m+2),s.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(s){if(this.sortedAngle===s&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(s),p=Math.cos(s),v=[],m=[],_=[];for(let C=0;C<this.symbolInstances.length;++C){_.push(C);const O=this.symbolInstances.get(C);v.push(0|Math.round(u*O.tileAnchorX+p*O.tileAnchorY)),m.push(O.featureIndex)}return _.sort((C,O)=>v[C]-v[O]||m[O]-m[C]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let s=0;s<this.symbolInstances.length;++s)this.symbolInstanceIndexesSortedZOffset.push(s)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((s,u)=>this.symbolInstances.get(u).zOffset-this.symbolInstances.get(s).zOffset)}addToSortKeyRanges(s,u){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===u?p.symbolInstanceEnd=s+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:s,symbolInstanceEnd:s+1})}sortFeatures(s){if(this.sortFeaturesByY&&this.sortedAngle!==s&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(s),this.sortedAngle=s,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const p=this.symbolInstances.get(u);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:B}=p;v>=0&&this.addIndicesForPlacedSymbol(this.text,v),m>=0&&m!==v&&this.addIndicesForPlacedSymbol(this.text,m),_>=0&&_!==m&&_!==v&&this.addIndicesForPlacedSymbol(this.text,_),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O),B>=0&&this.addIndicesForPlacedSymbol(this.icon,B)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Lz,zz,lj;gr(sS,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),sS.addDynamicAttributes=aS;class Fz{constructor(s){this.type=s.property.overrides?s.property.overrides.runtimeType:Hu,this.defaultValue=s}evaluate(s){if(s.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(s.formattedSection))return u.getOverride(s.formattedSection)}return s.feature&&s.featureState?this.defaultValue.evaluate(s.feature,s.featureState):this.defaultValue.property.specification.default}eachChild(s){this.defaultValue.isConstant()||s(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gr(Fz,"FormatSectionOverride",{omit:["defaultValue"]});const cj=()=>lj||(lj={layout:Lz||(Lz=new qi({"symbol-placement":new er(_t.layout_symbol["symbol-placement"]),"symbol-spacing":new er(_t.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new er(_t.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new fr(_t.layout_symbol["symbol-sort-key"]),"symbol-z-order":new er(_t.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new er(_t.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new er(_t.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new er(_t.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new er(_t.layout_symbol["icon-ignore-placement"]),"icon-optional":new er(_t.layout_symbol["icon-optional"]),"icon-rotation-alignment":new er(_t.layout_symbol["icon-rotation-alignment"]),"icon-size":new fr(_t.layout_symbol["icon-size"]),"icon-size-scale-range":new er(_t.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new fr(_t.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fr(_t.layout_symbol["icon-text-fit-padding"]),"icon-image":new fr(_t.layout_symbol["icon-image"]),"icon-rotate":new fr(_t.layout_symbol["icon-rotate"]),"icon-padding":new er(_t.layout_symbol["icon-padding"]),"icon-keep-upright":new er(_t.layout_symbol["icon-keep-upright"]),"icon-offset":new fr(_t.layout_symbol["icon-offset"]),"icon-anchor":new fr(_t.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new er(_t.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new er(_t.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new er(_t.layout_symbol["text-rotation-alignment"]),"text-field":new fr(_t.layout_symbol["text-field"]),"text-font":new fr(_t.layout_symbol["text-font"]),"text-size":new fr(_t.layout_symbol["text-size"]),"text-size-scale-range":new er(_t.layout_symbol["text-size-scale-range"]),"text-max-width":new fr(_t.layout_symbol["text-max-width"]),"text-line-height":new fr(_t.layout_symbol["text-line-height"]),"text-letter-spacing":new fr(_t.layout_symbol["text-letter-spacing"]),"text-justify":new fr(_t.layout_symbol["text-justify"]),"text-radial-offset":new fr(_t.layout_symbol["text-radial-offset"]),"text-variable-anchor":new er(_t.layout_symbol["text-variable-anchor"]),"text-anchor":new fr(_t.layout_symbol["text-anchor"]),"text-max-angle":new er(_t.layout_symbol["text-max-angle"]),"text-writing-mode":new er(_t.layout_symbol["text-writing-mode"]),"text-rotate":new fr(_t.layout_symbol["text-rotate"]),"text-padding":new er(_t.layout_symbol["text-padding"]),"text-keep-upright":new er(_t.layout_symbol["text-keep-upright"]),"text-transform":new fr(_t.layout_symbol["text-transform"]),"text-offset":new fr(_t.layout_symbol["text-offset"]),"text-allow-overlap":new er(_t.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new er(_t.layout_symbol["text-ignore-placement"]),"text-optional":new er(_t.layout_symbol["text-optional"]),visibility:new er(_t.layout_symbol.visibility)})),paint:zz||(zz=new qi({"icon-opacity":new fr(_t.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new fr(_t.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new fr(_t.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new fr(_t.paint_symbol["text-emissive-strength"]),"icon-color":new fr(_t.paint_symbol["icon-color"]),"icon-halo-color":new fr(_t.paint_symbol["icon-halo-color"]),"icon-halo-width":new fr(_t.paint_symbol["icon-halo-width"]),"icon-halo-blur":new fr(_t.paint_symbol["icon-halo-blur"]),"icon-translate":new er(_t.paint_symbol["icon-translate"]),"icon-translate-anchor":new er(_t.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new fr(_t.paint_symbol["icon-image-cross-fade"]),"text-opacity":new fr(_t.paint_symbol["text-opacity"]),"text-occlusion-opacity":new fr(_t.paint_symbol["text-occlusion-opacity"]),"text-color":new fr(_t.paint_symbol["text-color"],{runtimeType:ys,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new fr(_t.paint_symbol["text-halo-color"]),"text-halo-width":new fr(_t.paint_symbol["text-halo-width"]),"text-halo-blur":new fr(_t.paint_symbol["text-halo-blur"]),"text-translate":new er(_t.paint_symbol["text-translate"]),"text-translate-anchor":new er(_t.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new er(_t.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new er(_t.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new er(_t.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new er(_t.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new fr(_t.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},lj);class oS extends pi{constructor(s,u,p,v){super(s,cj(),u,p,v),this._colorAdjustmentMatrix=De.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=s.paint!==void 0&&("icon-occlusion-opacity"in s.paint||"text-occlusion-opacity"in s.paint)}recalculate(s,u){super.recalculate(s,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const v=[];for(const m of p)v.indexOf(m)<0&&v.push(m);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(s,u,p,v){return this._saturation===s&&this._contrast===u&&this._brightnessMin===p&&this._brightnessMax===v||(this._colorAdjustmentMatrix=function(m,_,C,O){m=Bs(m),_=Na(_);const B=De.mat4.create(),j=m/3,R=1-2*j,F=[R,j,j,0,j,R,j,0,j,j,R,0,0,0,0,1],M=.5-.5*_,I=O-C;return De.mat4.multiply(B,[I,0,0,0,0,I,0,0,0,0,I,0,C,C,C,1],[_,0,0,0,0,_,0,0,0,0,_,0,M,M,M,1]),De.mat4.multiply(B,B,F),B}(s,u,p,v),this._saturation=s,this._contrast=u,this._brightnessMin=p,this._brightnessMax=v),this._colorAdjustmentMatrix}getValueAndResolveTokens(s,u,p,v){const m=this.layout.get(s).evaluate(u,{},p,v),_=this._unevaluatedLayout._values[s];return _.isDataDriven()||ih(_.value)||!m?m:function(C,O){return O.replace(/{([^{}]+)}/g,(B,j)=>j in C?String(C[j]):"")}(u.properties,m)}createBucket(s){return new sS(s)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const s of cj().paint.overridableProperties){if(!oS.hasPaintOverride(this.layout,s))continue;const u=this.paint.get(s),p=new Fz(u),v=new nh(p,u.property.specification,this.scope,this.options);let m=null;m=u.value.kind==="constant"||u.value.kind==="source"?new ah("source",v):new sh("composite",v,u.value.zoomStops,u.value._interpolationType),this.paint._values[s]=new cd(u.property,m,u.parameters)}}_handleOverridablePaintPropertyUpdate(s,u,p){return!(!this.layout||u.isDataDriven()||p.isDataDriven())&&oS.hasPaintOverride(this.layout,s)}static hasPaintOverride(s,u){const p=s.get("text-field"),v=cj().paint.properties[u];let m=!1;const _=C=>{for(const O of C)if(v.overrides&&v.overrides.hasOverride(O))return void(m=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Es)_(p.value.value.sections);else if(p.value.kind==="source"){const C=B=>{m||(B instanceof ka&&na(B.value)===Ho?_(B.value.sections):B instanceof iu?_(B.sections):B.eachChild(C))},O=p.value;O._styleExpression&&C(O._styleExpression.expression)}return m}getProgramIds(){return["symbol"]}getDefaultProgramParams(s,u,p){return{config:new vu(this,{zoom:u,lut:p}),overrideFog:!1}}}let Bz,Vz,Uz,$z;var uj=ei([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function dj(h){switch(h){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function hj(h){switch(h){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class fj{constructor(s,u,p,v){this.context=s,this.format=p,this.useMipmap=v&&v.useMipmap,this.texture=s.gl.createTexture(),this.update(u,{premultiply:v&&v.premultiply})}update(s,u){const p=s&&s instanceof HTMLVideoElement&&s.width===0?s.videoWidth:s.width,v=s&&s instanceof HTMLVideoElement&&s.height===0?s.videoHeight:s.height,{context:m}=this,{gl:_}=m,{x:C,y:O}=u&&u.position?u.position:{x:0,y:0},B=C+p,j=O+v;!this.size||this.size[0]===B&&this.size[1]===j||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!u||u.premultiply!==!1));const R=s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageData||ImageBitmap&&s instanceof ImageBitmap;if(!this.size&&B>0&&j>0){const F=this.useMipmap?Math.floor(Math.log2(Math.max(B,j)))+1:1;_.texStorage2D(_.TEXTURE_2D,F,this.format,B,j),this.size=[B,j]}if(this.size)if(R)_.texSubImage2D(_.TEXTURE_2D,0,C,O,dj(this.format),hj(this.format),s);else{const F=s.data;F&&_.texSubImage2D(_.TEXTURE_2D,0,C,O,p,v,dj(this.format),hj(this.format),F)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(s,u,p=!1){const{context:v}=this,{gl:m}=v;m.bindTexture(m.TEXTURE_2D,this.texture),s!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap&&!p?s===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),u!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,u),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,u),this.wrapS=u)}bindExtraParam(s,u,p,v){const{context:m}=this,{gl:_}=m;_.bindTexture(_.TEXTURE_2D,this.texture),u!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,u),this.magFilter=u),s!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?s===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:s),this.minFilter=s),p!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,p),this.wrapS=p),v!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,v),this.wrapT=v)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}}class lS{constructor(s,u){this.context=s,this.texture=u}bind(s,u){const{context:p}=this,{gl:v}=p;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,s),this.minFilter=s),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,u),this.wrapS=u)}}function cS(h,s,u,p,v,m,_,C){const O=[h,s,1,u,p,1,v,m,1],B=[_,C,1],j=De.mat3.adjoint([],O),[R,F,M]=De.vec3.transformMat3(B,B,j);return De.mat3.multiply(O,O,[R,0,0,0,F,0,0,0,M])}function qz(h,s,u,p,v,m,_,C){const O=function(B,j,R,F,M,I,q,X){const te=cS(0,0,1,0,1,1,0,1),le=cS(B,j,R,F,M,I,q,X),ue=De.mat3.adjoint([],te);return De.mat3.multiply(le,le,ue)}(h,s,u,p,v,m,_,C);return[O[2]/O[8]/hr,O[5]/O[8]/hr]}function uS(h){return[h[0],Math.min(Math.max(h[1],-85.051129),ro)]}class Gz extends eu{constructor(s,u,p,v){super(),this.id=s,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(v),this.options=u,this._dirty=!1}load(s,u){if(this._loaded=u||!1,this.fire(new _i("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return s&&(this.coordinates=s),this._loaded=!0,void this._finishLoading();this._imageRequest=tf(this.map._requestManager.transformRequest(this.url,Rn.Image),(p,v)=>{this._imageRequest=null,this._loaded=!0,p?this.fire(new gp(p)):v&&(this.image=v instanceof HTMLImageElement?Ze.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,s&&(this.coordinates=s),this._finishLoading())})}loaded(){return this._loaded}updateImage(s){return s.url?(this._imageRequest&&s.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=s.url,this.load(s.coordinates,this._loaded),this):this}setTexture(s){if(!(s.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new lS(this.map.painter.context,s.handle),this.width=s.dimensions[0],this.height=s.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new _i("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(s){this.map=s,this.load()}onRemove(s){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof lS||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(s){if(this.coordinates=s,this._boundsArray=void 0,this._unsupportedCoords=!1,!s.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let u=s[0][1],p=s[0][1];for(const m of s)m[1]>p&&(p=m[1]),m[1]<u&&(u=m[1]);const v=(p+u)/2;if(v>ro?this.onNorthPole=!0:v<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const m=s.map(d.fromLngLat);this.tileID=function(_){let C=1/0,O=1/0,B=-1/0,j=-1/0;for(const q of _)C=Math.min(C,q.x),O=Math.min(O,q.y),B=Math.max(B,q.x),j=Math.max(j,q.y);const R=Math.max(B-C,j-O),F=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),M=Math.pow(2,F);let I=Math.floor((C+B)/2*M);return I>1&&(I-=1),new $t(F,I,Math.floor((O+j)/2*M))}(m),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new _i("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(s){for(const te in this.tiles){const le=this.tiles[te];le.state!=="loaded"&&(le.state="loaded",le.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const u=fb(new $t(0,0,0),this.map.transform.projection),p=[u.projection.project(this.coordinates[0][0],this.coordinates[0][1]),u.projection.project(this.coordinates[1][0],this.coordinates[1][1]),u.projection.project(this.coordinates[2][0],this.coordinates[2][1]),u.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(te){const le=te[1].x-te[0].x,ue=te[1].y-te[0].y,ie=te[2].x-te[1].x,fe=te[2].y-te[1].y,ye=te[3].x-te[2].x,Se=te[3].y-te[2].y,Le=te[0].x-te[3].x,Ie=te[0].y-te[3].y,Me=le*fe-ie*ue,et=ie*Se-ye*fe,Be=ye*Ie-Le*Se,rt=Le*ue-le*Ie;return Me>0&&et>0&&Be>0&&rt>0||Me<0&&et<0&&Be<0&&rt<0}(p))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const v=fb(this.tileID,this.map.transform.projection),[m,_,C,O]=this.coordinates.map(te=>{const le=v.projection.project(te[0],te[1]);return Ez(v,le)._round()});this.perspectiveTransform=qz(m.x,m.y,_.x,_.y,C.x,C.y,O.x,O.y);const B=this._boundsArray=new ua;B.emplaceBack(m.x,m.y,0,0),B.emplaceBack(_.x,_.y,hr,0),B.emplaceBack(O.x,O.y,0,hr),B.emplaceBack(C.x,C.y,hr,hr),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=s.createVertexBuffer(B,uj.members),this.boundsSegments=va.simpleSegment(0,0,4,2);const j=[],R=[uS((F=this.coordinates)[0]),uS(F[1]),uS(F[2]),uS(F[3])];var F;const[M,I,q,X]=function(te){let le=te[0][0],ue=le,ie=te[0][1],fe=ie;for(let ye=1;ye<te.length;ye++)te[ye][0]<le?le=te[ye][0]:te[ye][0]>ue&&(ue=te[ye][0]),te[ye][1]<ie?ie=te[ye][1]:te[ye][1]>fe&&(fe=te[ye][1]);return[le,ie,ue-le,fe-ie]}(R);{const te=new ua,[le,ue,ie,fe]=function(ht){let vt=ht[0].x,ut=vt,It=ht[0].y,Wt=It;for(let Rt=1;Rt<ht.length;Rt++)ht[Rt].x<vt?vt=ht[Rt].x:ht[Rt].x>ut&&(ut=ht[Rt].x),ht[Rt].y<It?It=ht[Rt].y:ht[Rt].y>Wt&&(Wt=ht[Rt].y);return[vt,It,ut-vt,Wt-It]}(p),ye=ht=>[(ht.x-le)/ie,(ht.y-ue)/fe],[Se,Le,Ie,Me]=p.map(ye),et=function(ht,vt,ut,It,Wt,Rt,mr,dr){const tr=cS(0,0,1,0,1,1,0,1),Ht=cS(ht,vt,ut,It,Wt,Rt,mr,dr),kr=De.mat3.adjoint([],Ht);return De.mat3.multiply(tr,tr,kr)}(Se[0],Se[1],Le[0],Le[1],Ie[0],Ie[1],Me[0],Me[1]);this.elevatedGlobePerspectiveTransform=qz(Se[0],Se[1],Le[0],Le[1],Ie[0],Ie[1],Me[0],Me[1]);const Be=(ht,vt)=>{j.push(ht.lng);const ut=Math.round((ht.lng-M)/q*hr),It=Math.round((ht.lat-I)/X*hr),Wt=ye(vt),Rt=De.vec3.transformMat3([],[Wt[0],Wt[1],1],et),mr=Math.round(Rt[0]/Rt[2]*hr),dr=Math.round(Rt[1]/Rt[2]*hr);te.emplaceBack(ut,It,mr,dr)},rt=p[3].x-p[0].x,st=p[3].y-p[0].y,nt=p[2].x-p[1].x,ct=p[2].y-p[1].y;for(let ht=0;ht<65;ht++){const vt=ht/64,ut=[p[0].x+vt*rt,p[0].y+vt*st],It=[p[1].x+vt*nt,p[1].y+vt*ct],Wt=It[0]-ut[0],Rt=It[1]-ut[1];for(let mr=0;mr<65;mr++){const dr=mr/64,tr={x:ut[0]+Wt*dr,y:ut[1]+Rt*dr};Be(u.projection.unproject(tr.x,tr.y),tr)}}this.elevatedGlobeVertexBuffer=s.createVertexBuffer(te,uj.members)}{this.maxLongitudeTriangleSize=0;let te=[],le=new _s;const ue=(ie,fe,ye)=>{le.emplaceBack(ie,fe,ye);const Se=j[ie],Le=j[fe],Ie=j[ye],Me=Math.min(Math.min(Se,Le),Ie),et=Math.max(Math.max(Se,Le),Ie)-Me;et>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=et),te.push(Me+et/2)};for(let ie=0;ie<64;ie++)for(let fe=0;fe<64;fe++){const ye=65*ie+fe,Se=ye+1,Le=ye+65,Ie=Le+1;ue(ye,Le,Se),ue(Se,Le,Ie)}[te,le]=function(ie,fe){const ye=Array.from({length:ie.length},(Ie,Me)=>Me);ye.sort((Ie,Me)=>ie[Ie]-ie[Me]);const Se=[],Le=new _s;for(let Ie=0;Ie<ye.length;Ie++){const Me=ye[Ie];Se.push(ie[Me]);const et=3*Me,Be=et+1;Le.emplaceBack(fe.uint16[et],fe.uint16[Be],fe.uint16[Be+1])}return[Se,Le]}(te,le),this.elevatedGlobeTrianglesCenterLongitudes=te,this.elevatedGlobeIndexBuffer=s.createIndexBuffer(le)}this.elevatedGlobeSegments=va.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,q/hr,0,X/hr,0,0,I,M,0])}prepare(){const s=Object.keys(this.tiles).length!==0;if(this.tileID&&!s)return;const u=this.map.painter.context,p=u.gl;!this._dirty||this.texture instanceof lS||(this.texture?this.texture.update(this.image):(this.texture=new fj(u,this.image,p.RGBA8),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),s&&this._prepareData(u)}loadTile(s,u){this.tileID&&this.tileID.equals(s.tileID.canonical)?(this.tiles[String(s.tileID.wrap)]=s,s.buckets={},u(null)):(s.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(s){const u=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!u)return null;const p=this.elevatedGlobeTrianglesCenterLongitudes;let v=(m=s+180)+360*Math.round((p[0]-m)/360);var m;const _=new va,C=(R,F)=>{_.segments.push({vertexOffset:0,primitiveOffset:R,vertexLength:u.segments[0].vertexLength,primitiveLength:F,sortKey:void 0,vaos:{}})},O=.51*this.maxLongitudeTriangleSize;if(Math.abs(p[0]-v)<=O){const R=El(p,0,p.length,v+O);return R===p.length||C(R,Cs(p,R+1,p.length,v+360-O)-R),_}v<p[0]&&(v+=360);const B=Cs(p,0,p.length,v-O);if(B===p.length)return C(0,p.length),_;C(0,B-0);const j=El(p,B+1,p.length,v+O);return j!==p.length&&C(j,p.length-j),_}}const Rae=(Math.pow(256,2)-1)/16907520;class Wz extends pi{constructor(s,u,p,v){super(s,{layout:Uz||(Uz=new qi({visibility:new er(_t.layout_raster.visibility)})),paint:$z||($z=new qi({"raster-opacity":new er(_t.paint_raster["raster-opacity"]),"raster-color":new Vl(_t.paint_raster["raster-color"]),"raster-color-mix":new er(_t.paint_raster["raster-color-mix"]),"raster-color-range":new er(_t.paint_raster["raster-color-range"]),"raster-hue-rotate":new er(_t.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new er(_t.paint_raster["raster-brightness-min"]),"raster-brightness-max":new er(_t.paint_raster["raster-brightness-max"]),"raster-saturation":new er(_t.paint_raster["raster-saturation"]),"raster-contrast":new er(_t.paint_raster["raster-contrast"]),"raster-resampling":new er(_t.paint_raster["raster-resampling"]),"raster-fade-duration":new er(_t.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new er(_t.paint_raster["raster-emissive-strength"]),"raster-array-band":new er(_t.paint_raster["raster-array-band"]),"raster-elevation":new er(_t.paint_raster["raster-elevation"]),"raster-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},u,p,v),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(s){return!(s&&s._source instanceof Gz&&(s._source.onNorthPole||s._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(s){s!=="raster-color"&&s!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(s){if(!this.hasColorMap()||!this._curRampRange)return;const u=this._transitionablePaint._values["raster-color"].value.expression,[p,v]=s||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(p)&&isNaN(v)||p===this._curRampRange[0]&&v===this._curRampRange[1]||(this.colorRamp=xg({expression:u,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:p,end:v}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[p,v])}}let Hz,Kz,Zz,Yz,Xz;class Jz extends pi{constructor(s,u,p,v){super(s,{layout:Hz||(Hz=new qi({visibility:new er(_t["layout_raster-particle"].visibility)})),paint:Kz||(Kz=new qi({"raster-particle-array-band":new er(_t["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new er(_t["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Vl(_t["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new er(_t["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new er(_t["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new er(_t["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new er(_t["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new er(_t["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},u,p,v),this._updateColorRamp(),this.lastInvalidatedAt=Ze.now()}onRemove(s){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(s){return!1}_handleSpecialPaintPropertyUpdate(s){s!=="raster-particle-color"&&s!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),s==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const s=this._transitionablePaint._values["raster-particle-color"].value.expression,u=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=xg({expression:s,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:u}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ze.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Iae extends pi{constructor(s,u){super(s,{},u,null),this.implementation=s,s.slot&&(this.slot=s.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(s){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)}onRemove(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)}}function pj(h,s,u){const p=[0,0,1],v=De.quat.identity([]);return De.quat.rotateY(v,v,u?-tt(h)+Math.PI:tt(h)),De.quat.rotateX(v,v,-tt(s)),De.vec3.transformQuat(p,p,v),De.vec3.normalize(p,p)}function Qz(h,s){const u=dS(h.projection,h.zoom,h.width,h.height),p=function(m,_,C,O,B){const j=new Zn(C.lng-180*Pg,C.lat),R=new Zn(C.lng+180*Pg,C.lat),F=m.project(j.lng,j.lat),M=m.project(R.lng,R.lat),I=-Math.atan2(M.y-F.y,M.x-F.x),q=d.fromLngLat(C);q.y=ur(q.y,-1+Pg,1-Pg);const X=q.toLngLat(),te=m.project(X.lng,X.lat),le=d.fromLngLat(X);le.x+=Pg;const ue=le.toLngLat(),ie=m.project(ue.lng,ue.lat),fe=tF(ie.x-te.x,ie.y-te.y,I),ye=d.fromLngLat(X);ye.y+=Pg;const Se=ye.toLngLat(),Le=m.project(Se.lng,Se.lat),Ie=tF(Le.x-te.x,Le.y-te.y,I),Me=Math.abs(fe.x)/Math.abs(Ie.y),et=De.mat4.identity([]);De.mat4.rotateZ(et,et,-I*(1-(B?0:O)));const Be=De.mat4.identity([]);return De.mat4.scale(Be,Be,[1,1-(1-Me)*O,1]),Be[4]=-Ie.x/Ie.y*O,De.mat4.rotateZ(Be,Be,I),De.mat4.multiply(Be,et,Be),Be}(h.projection,0,h.center,u,s),v=eF(h);return De.mat4.scale(p,p,[v,v,1]),p}function eF(h){const s=h.projection,u=dS(h.projection,h.zoom,h.width,h.height),p=mj(s,h.center),v=mj(s,Zn.convert(s.center));return Math.pow(2,p*u+(1-u)*v)}function dS(h,s,u,p,v=1/0){const m=h.range;if(!m)return 0;const _=Math.min(v,Math.max(u,p)),C=Math.log(_/1024)/Math.LN2;return tn(m[0]+C,m[1]+C,s)}const Pg=1/4e4;function mj(h,s){const u=ur(s.lat,-85.051129,ro),p=new Zn(s.lng-180*Pg,u),v=new Zn(s.lng+180*Pg,u),m=h.project(p.lng,u),_=h.project(v.lng,u),C=d.fromLngLat(p),O=d.fromLngLat(v),B=_.x-m.x,j=_.y-m.y,R=O.x-C.x,F=O.y-C.y,M=Math.sqrt((R*R+F*F)/(B*B+j*j));return Math.log(M)/Math.LN2}function tF(h,s,u){const p=Math.cos(u),v=Math.sin(u);return{x:h*p-s*v,y:h*v+s*p}}function rF(h,s,u){De.mat4.identity(h),De.mat4.rotateZ(h,h,tt(s[2])),De.mat4.rotateX(h,h,tt(s[0])),De.mat4.rotateY(h,h,tt(s[1])),De.mat4.scale(h,h,u),De.mat4.multiply(h,h,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function hS(h,s,u,p,v,m,_,C){const O=[u[0]-s[0],u[1]-s[1],0],B=[p[0]-s[0],p[1]-s[1],0];if(De.vec3.length(O)<1e-12||De.vec3.length(B)<1e-12)return De.quat.identity(h);const j=De.vec3.cross([],O,B);De.vec3.normalize(j,j),De.vec3.subtract(B,p,s),O[2]=(m-v)*C,B[2]=(_-v)*C;const R=O;return De.vec3.cross(R,O,B),De.vec3.normalize(R,R),De.quat.rotationTo(h,j,R)}function gj(h,s,u=!1){const p=Ro(s.zoom),v=function(m,_,C){const O=_.worldSize,B=[m[12],m[13],m[14]],j=Vr(B[1]/O),R=il(B[0]/O),F=De.mat4.identity([]),M=Gi(1,j)*O,I=Gi(1,0)*O*Mf(j,_.zoom),q=1/$s(O);let X=I*q;if(C){const ie=dS(_.projection,_.zoom,_.width,_.height,1024);X=q*_.projection.pixelSpaceConversion(_.center.lat,O,ie)}const te=_h(j,R);De.vec3.add(te,te,De.vec3.scale([],De.vec3.normalize([],te),M*X*B[2]));const le=function(ie){const fe=[ie[0],ie[1],ie[2]];let ye=[0,1,0];const Se=De.vec3.cross([],ye,fe);return De.vec3.cross(ye,fe,Se),De.vec3.squaredLength(ye)===0&&(ye=[0,1,0],De.vec3.cross(Se,fe,ye)),De.vec3.normalize(Se,Se),De.vec3.normalize(ye,ye),De.vec3.normalize(fe,fe),[Se[0],Se[1],Se[2],0,ye[0],ye[1],ye[2],0,fe[0],fe[1],fe[2],0,ie[0],ie[1],ie[2],1]}(te);De.mat4.scale(F,F,[X,X,X*M]),De.mat4.translate(F,F,[-B[0],-B[1],-B[2]]);const ue=De.mat4.multiply([],_.globeMatrix,le);return De.mat4.multiply(ue,ue,F),De.mat4.multiply(ue,ue,m),ue}(h,s,u);if(p>0){const m=function(_,C){const O=C.worldSize,B=Gi(1,0)*O*Mf(C.center.lat,C.zoom)/$s(O),j=Gi(1,C.center.lat)*O,R=De.mat4.identity([]);return De.mat4.rotateY(R,R,tt(C.center.lng)),De.mat4.rotateX(R,R,tt(C.center.lat)),De.mat4.translate(R,R,[0,0,to]),De.mat4.scale(R,R,[B,B,B*j]),De.mat4.translate(R,R,[C.point.x-.5*O,C.point.y-.5*O,0]),De.mat4.multiply(R,R,_),De.mat4.multiply(R,C.globeMatrix,R)}(h,s);return function(_,C,O){const B=(I,q,X)=>{const te=De.vec3.length(I),le=De.vec3.length(q),ue=Sa(I,q,X);return De.vec3.scale(ue,ue,1/De.vec3.length(ue)*Fr(te,le,X))},j=B([_[0],_[1],_[2]],[C[0],C[1],C[2]],O),R=B([_[4],_[5],_[6]],[C[4],C[5],C[6]],O),F=B([_[8],_[9],_[10]],[C[8],C[9],C[10]],O),M=Sa([_[12],_[13],_[14]],[C[12],C[13],C[14]],O);return[j[0],j[1],j[2],0,R[0],R[1],R[2],0,F[0],F[1],F[2],0,M[0],M[1],M[2],1]}(v,m,p)}return v}function nF(h,s,u,p){const v=Sr.projectAabbCorners(p,u);let m=Number.MAX_VALUE,_=-1;for(let B=0;B<v.length;++B){const j=v[B];j[0]=(.5*j[0]+.5)*s.width,j[1]=(.5-.5*j[1])*s.height,j[2]<m&&(_=B,m=j[2])}const C=B=>new At(v[B][0],v[B][1]);let O;switch(_){case 0:case 6:O=[C(1),C(5),C(4),C(7),C(3),C(2),C(1)];break;case 1:case 7:O=[C(0),C(4),C(5),C(6),C(2),C(3),C(0)];break;case 3:case 5:O=[C(1),C(0),C(4),C(7),C(6),C(2),C(1)];break;default:O=[C(1),C(5),C(6),C(7),C(3),C(0),C(1)]}if(me(h,O))return m}const Dae=ei([{name:"a_pos_3f",components:3,type:"Float32"}]),Lae=ei([{name:"a_color_3f",components:3,type:"Float32"}]),zae=ei([{name:"a_color_4f",components:4,type:"Float32"}]),Fae=ei([{name:"a_uv_2f",components:2,type:"Float32"}]),Bae=ei([{name:"a_normal_3f",components:3,type:"Float32"}]),Vae=ei([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Uae=ei([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),iF={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class fS{constructor(s,u,p,v){this.message=(s?`${s}: `:"")+p,v&&(this.identifier=v),u!=null&&u.__line__&&(this.line=u.__line__)}}function aF(h,s){const u=h.indexOf("://")===-1;try{return new URL(h,u&&s?"http://example.com":void 0),!0}catch{return!1}}class sF{constructor(s,u){this.feature=s,this.instancedDataOffset=u,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class oF{constructor(){this.instancedDataArray=new Af,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class yj{constructor(s){this.zoom=s.zoom,this.canonical=s.canonical,this.layers=s.layers,this.layerIds=this.layers.map(u=>u.fqid),this.projection=s.projection,this.index=s.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(s,u){}populate(s,u,p,v){this.tileToMeter=o(p);const m=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:C,index:O,sourceLayerIndex:B}of s){const j=C??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),R=re(_,m);if(!this.layers[0]._featureFilter.filter(new bi(this.zoom),R,p))continue;const F={id:j,sourceLayerIndex:B,index:O,geometry:m?R.geometry:Y(_,p,v),properties:_.properties,type:_.type,patterns:{}},M=this.addFeature(F,F.geometry,R);M&&u.featureIndex.insert(_,F.geometry,O,B,this.index,this.instancesPerModel[M].instancedDataArray.length,hr/32)}this.lookup=null}update(s,u,p,v){for(const m in this.instancesPerModel){const _=this.instancesPerModel[m];for(const C in s)_.idToFeaturesIndex.hasOwnProperty(C)&&(this.evaluate(_.features[_.idToFeaturesIndex[C]],s[C],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let s=!1;for(const u in this.instancesPerModel){const p=this.instancesPerModel[u];for(const v of p.features){const m=this.layers[0],_=v.feature,C=this.canonical,O=m.paint.get("model-rotation").evaluate(_,{},C),B=m.paint.get("model-scale").evaluate(_,{},C),j=m.paint.get("model-translation").evaluate(_,{},C);De.vec3.exactEquals(v.rotation,O)&&De.vec3.exactEquals(v.scale,B)&&De.vec3.exactEquals(v.translation,j)||(this.evaluate(v,v.featureStates,p,!0),s=!0)}}return s}updateReplacement(s,u,p,v){if(u.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=u.updateTime;const m=u.getReplacementRegionsForTile(s.toUnwrapped(),!0);if(UN(this.activeReplacements,m))return!1;this.activeReplacements=m;let _=!1;for(const C in this.instancesPerModel){const O=this.instancesPerModel[C],B=O.instancedDataArray;for(const j of O.features){const R=j.instancedDataOffset,F=j.instancedDataCount;for(let M=0;M<F;M++){const I=16*(M+R);let q=B.float32[I+0];const X=q>hr;q=X?q-hr:q;const te=Math.floor(q),le=B.float32[I+1];let ue=!1;for(const ie of this.activeReplacements)if(!w5(ie,p,iF.Model,v)&&!(ie.min.x>te||te>ie.max.x||ie.min.y>le||le>ie.max.y)&&(ue=j5(N5(te,le,s.canonical,ie.footprintTileId.canonical),ie.footprint),ue))break;B.float32[I]=ue?q+hr:q,_=_||ue!==X}}}return _}isEmpty(){for(const s in this.instancesPerModel)if(this.instancesPerModel[s].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(s){if(!this.uploaded)for(const u in this.instancesPerModel){const p=this.instancesPerModel[u];p.instancedDataArray.length<0||p.instancedDataArray.length===0||(p.instancedDataBuffer?p.instancedDataBuffer.updateData(p.instancedDataArray):p.instancedDataBuffer=s.createVertexBuffer(p.instancedDataArray,Vae.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const u in this.instancesPerModel){const p=this.instancesPerModel[u];p.instancedDataArray.length!==0&&p.instancedDataBuffer&&p.instancedDataBuffer.destroy()}const s=this.layers[0].modelManager;if(s&&this.modelUris)for(const u of this.modelUris)s.removeModel(u,"")}addFeature(s,u,p){const v=this.layers[0],m=v.layout.get("model-id").evaluate(p,{},this.canonical);if(!m)return sn(`modelId is not evaluated for layer ${v.id} and it is not going to get rendered.`),m;aF(m,!1)&&(this.modelUris.includes(m)||this.modelUris.push(m)),this.instancesPerModel[m]||(this.instancesPerModel[m]=new oF);const _=this.instancesPerModel[m],C=_.instancedDataArray,O=new sF(p,C.length);for(const B of u)for(const j of B){if(j.x<0||j.x>=hr||j.y<0||j.y>=hr)continue;const R=(this.lookupDim-1)/hr,F=this.lookupDim*(j.y*R|0)+j.x*R|0;if(this.lookup){if(this.lookup[F]!==0)continue;this.lookup[F]=1}this.instanceCount++;const M=C.length;C.resize(M+1),_.instancesEvaluatedElevation.push(0),C.float32[16*M]=j.x,C.float32[16*M+1]=j.y}return O.instancedDataCount=_.instancedDataArray.length-O.instancedDataOffset,O.instancedDataCount>0&&(s.id&&(_.idToFeaturesIndex[s.id]=_.features.length),_.features.push(O),this.evaluate(O,{},_,!1)),m}getModelUris(){return this.modelUris}evaluate(s,u,p,v){const m=this.layers[0],_=s.feature,C=this.canonical,O=s.rotation=m.paint.get("model-rotation").evaluate(_,u,C),B=s.scale=m.paint.get("model-scale").evaluate(_,u,C),j=s.translation=m.paint.get("model-translation").evaluate(_,u,C),R=m.paint.get("model-color").evaluate(_,u,C);R.a=m.paint.get("model-color-mix-intensity").evaluate(_,u,C);const F=[];this.maxVerticalOffset<j[2]&&(this.maxVerticalOffset=j[2]),this.maxScale=Math.max(Math.max(this.maxScale,B[0]),Math.max(B[1],B[2])),rF(F,O,B);const M=Math.round(100*R.a)+R.b/1.05;for(let I=0;I<s.instancedDataCount;++I){const q=s.instancedDataOffset+I,X=16*q,te=p.instancedDataArray.float32;let le=0;v&&(le=te[X+6]-p.instancesEvaluatedElevation[q]);const ue=0|te[X+1];te[X]=(0|te[X])+R.r/1.05,te[X+1]=ue+R.g/1.05,te[X+2]=M,te[X+3]=1/(C.z>10?this.tileToMeter:o(C,ue)),te[X+4]=j[0],te[X+5]=j[1],te[X+6]=j[2]+le,te[X+7]=F[0],te[X+8]=F[1],te[X+9]=F[2],te[X+10]=F[4],te[X+11]=F[5],te[X+12]=F[6],te[X+13]=F[8],te[X+14]=F[9],te[X+15]=F[10],p.instancesEvaluatedElevation[q]=j[2]}}}let lF,cF;gr(yj,"ModelBucket",{omit:["layers"]}),gr(oF,"PerModelAttributes"),gr(sF,"ModelFeature");const t0=64,Bv={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function uF(h,s,u,p,v,m,_,C,O,B=!1){const j=u.zoom,R=u.project(p),F=Mf(p.lat,j),M=1/F;De.mat4.identity(h),De.mat4.translate(h,h,[R.x+_[0]*M,R.y+_[1]*M,_[2]]);let I=1,q=1;const X=u.worldSize;if(B){if(u.projection.name==="mercator"){let ie=0;u.elevation&&(ie=u.elevation.getAtPointOrZero(new d(R.x/X,R.y/X),0));const fe=De.vec4.transformMat4([],[R.x,R.y,ie,1],u.projMatrix)[3]/u.cameraToCenterDistance;I=fe,q=fe*Mf(u.center.lat,j)}else if(u.projection.name==="globe"){const ie=gj(h,u),fe=De.mat4.multiply([],u.projMatrix,ie),ye=[0,0,0,1];De.vec4.transformMat4(ye,ye,fe);const Se=ye[3]/u.cameraToCenterDistance,Le=Ro(j),Ie=u.projection.pixelsPerMeter(p.lat,X)*Mf(p.lat,j),Me=u.projection.pixelsPerMeter(u.center.lat,X)*Mf(u.center.lat,j);I=Se/Fr(Ie,yg(u.center.lat),Le),q=Se*F/Ie,I*=Me,q*=Me}}else I=M;De.mat4.scale(h,h,[I,I,q]);const te=[...h],le=s.orientation,ue=[];if(rF(ue,[le[0]+v[0],le[1]+v[1],le[2]+v[2]],m),De.mat4.multiply(h,te,ue),C&&u.elevation){let ie=0;const fe=[];if(O&&u.elevation){ie=function(Le,Ie,Me,et,Be){const rt=Ie.elevation;if(!rt)return 0;const st=Sr.projectAabbCorners(Me,et),nt=Gi(1,Be.lat)*Ie.worldSize,ct=function(kr,vr){const br=[0,0,1],en=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const mn of en){const _n=kr[mn.corners[0]],bn=kr[mn.corners[1]],Ln=kr[mn.corners[2]],Bn=[bn[0]-_n[0],bn[1]-_n[1],vr*(bn[2]-_n[2])],Li=De.vec3.cross(Bn,Bn,[Ln[0]-_n[0],Ln[1]-_n[1],vr*(Ln[2]-_n[2])]);De.vec3.normalize(Li,Li),mn.dotProductWithUp=De.vec3.dot(Li,br)}return en.sort((mn,_n)=>mn.dotProductWithUp-_n.dotProductWithUp),en[0].corners}(st,nt),ht=st[ct[0]],vt=st[ct[1]],ut=st[ct[2]],It=st[ct[3]],Wt=rt.getAtPointOrZero(new d(ht[0]/Ie.worldSize,ht[1]/Ie.worldSize),0),Rt=rt.getAtPointOrZero(new d(vt[0]/Ie.worldSize,vt[1]/Ie.worldSize),0),mr=rt.getAtPointOrZero(new d(ut[0]/Ie.worldSize,ut[1]/Ie.worldSize),0),dr=rt.getAtPointOrZero(new d(It[0]/Ie.worldSize,It[1]/Ie.worldSize),0),tr=(Wt+dr)/2,Ht=(Rt+mr)/2;return tr>Ht?Rt<mr?hS(Le,vt,It,ht,Rt,dr,Wt,nt):hS(Le,ut,ht,It,mr,Wt,dr,nt):Wt<dr?hS(Le,ht,vt,ut,Wt,Rt,mr,nt):hS(Le,It,ut,vt,dr,mr,Rt,nt),Math.max(tr,Ht)}(fe,u,s.aabb,h,p);const ye=De.mat4.fromQuat([],fe),Se=De.mat4.multiply([],ye,ue);De.mat4.multiply(h,te,Se)}else ie=u.elevation.getAtPointOrZero(new d(R.x/X,R.y/X),0);ie!==0&&(h[14]+=ie)}}function vb(h,s,u=!1){h.uploaded||(h.gfxTexture=new fj(s,h.image,u?s.gl.R8:s.gl.RGBA8,{useMipmap:h.sampler.minFilter>=s.gl.NEAREST_MIPMAP_NEAREST}),h.uploaded=!0,h.image=null)}function $ae(h,s,u){h.indexBuffer=s.createIndexBuffer(h.indexArray,!1,!0),h.vertexBuffer=s.createVertexBuffer(h.vertexArray,Dae.members,!1,!0),h.normalArray&&(h.normalBuffer=s.createVertexBuffer(h.normalArray,Bae.members,!1,!0)),h.texcoordArray&&(h.texcoordBuffer=s.createVertexBuffer(h.texcoordArray,Fae.members,!1,!0)),h.colorArray&&(h.colorBuffer=s.createVertexBuffer(h.colorArray,(h.colorArray.bytesPerElement===12?Lae:zae).members,!1,!0)),h.featureArray&&(h.pbrBuffer=s.createVertexBuffer(h.featureArray,Uae.members,!0)),h.segments=va.simpleSegment(0,0,h.vertexArray.length,h.indexArray.length);const p=h.material;p.pbrMetallicRoughness.baseColorTexture&&vb(p.pbrMetallicRoughness.baseColorTexture,s),p.pbrMetallicRoughness.metallicRoughnessTexture&&vb(p.pbrMetallicRoughness.metallicRoughnessTexture,s),p.normalTexture&&vb(p.normalTexture,s),p.occlusionTexture&&vb(p.occlusionTexture,s,u),p.emissionTexture&&vb(p.emissionTexture,s)}function vj(h,s,u){if(h.meshes)for(const p of h.meshes)$ae(p,s,u);if(h.children)for(const p of h.children)vj(p,s,u)}function pS(h){if(h.meshes)for(const s of h.meshes)s.indexArray.destroy(),s.vertexArray.destroy(),s.colorArray&&s.colorArray.destroy(),s.normalArray&&s.normalArray.destroy(),s.texcoordArray&&s.texcoordArray.destroy(),s.featureArray&&s.featureArray.destroy();if(h.children)for(const s of h.children)pS(s)}function xj(h){if(h.meshes)for(const u of h.meshes)u.vertexBuffer&&(u.vertexBuffer.destroy(),u.indexBuffer.destroy(),u.normalBuffer&&u.normalBuffer.destroy(),u.texcoordBuffer&&u.texcoordBuffer.destroy(),u.colorBuffer&&u.colorBuffer.destroy(),u.pbrBuffer&&u.pbrBuffer.destroy(),u.segments.destroy(),u.material&&((s=u.material).pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()));var s;if(h.children)for(const u of h.children)xj(u)}class Vv{constructor(s,u,p){this._demTile=s,this._dem=this._demTile.dem,this._scale=u,this._offset=p}static create(s,u,p){const v=p||s.findDEMTileFor(u);if(!v||!v.dem)return;const m=v.dem,_=v.tileID,C=1<<u.canonical.z-_.canonical.z;return new Vv(v,m.dim/hr/C,[(u.canonical.x/C-_.canonical.x)*m.dim,(u.canonical.y/C-_.canonical.y)*m.dim])}tileCoordToPixel(s,u){const p=u*this._scale+this._offset[1],v=Math.floor(s*this._scale+this._offset[0]),m=Math.floor(p);return new At(v,m)}getElevationAt(s,u,p,v){const m=s*this._scale+this._offset[0],_=u*this._scale+this._offset[1],C=Math.floor(m),O=Math.floor(_),B=this._dem;return v=!!v,p?Fr(Fr(B.get(C,O,v),B.get(C,O+1,v),_-O),Fr(B.get(C+1,O,v),B.get(C+1,O+1,v),_-O),m-C):B.get(C,O,v)}getElevationAtPixel(s,u,p){return this._dem.get(s,u,!!p)}getMeterToDEM(s){return(1<<this._demTile.tileID.canonical.z)*Gi(1,s)*this._dem.stride}}const _j=new Float32Array(262144),r0=new Uint8Array(262144);function dF(h){let s=0;if(h.meshes)for(const u of h.meshes)s=Math.max(s,u.aabb.max[2]);if(h.children)for(const u of h.children)s=Math.max(s,dF(u));return s}function hF(h,s,u){if(h.meshes)for(const p of h.meshes){if(p.aabb.min[0]===1/0)continue;const v=Sr.applyTransform(p.aabb,h.matrix);u.insert(s,v.min[0],v.min[1],v.max[0],v.max[1])}if(h.children)for(const p of h.children)hF(p,s,u)}const fF=["","wall","door","roof","window","lamp","logo"];class pF{constructor(s){this.node=s,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:s.id,geometry:[],properties:{height:dF(s)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let s=0;const u=new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const p of this.node.meshes)this.node.lightMeshIndex!==s&&(p.transformedAabb=Sr.applyTransformFast(p.aabb,this.node.matrix),u.encapsulate(p.transformedAabb)),s++;this.aabb=u}return this.aabb}}class mS{constructor(s,u,p,v,m,_,C){this.id=p,this.layers=s,this.layerIds=this.layers.map(O=>O.fqid),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.modelTraits|=Bv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,v&&(this.modelTraits|=Bv.HasMapboxMeshFeatures),m&&(this.modelTraits|=Bv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const O of u)this.nodesInfo.push(new pF(O)),hF(O,C.featureIndexArray.length,C.grid),C.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,C.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(s,u){for(const p of this.getNodesInfo()){const v=p.node;v.footprint&&u.push({footprint:v.footprint,id:s})}}update(s){const u=Object.keys(s).length!==0;if(u&&!this.stateDependentLayers.length)return;const p=u?this.stateDependentLayers:this.layers;if(!qr(s,this.states))for(const v of p)this.evaluate(v,s);this.states=structuredClone(s)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(s){if(!this.needsUpload)return;const u=this.getNodesInfo();for(const p of u){const v=p.node;this.uploaded?this.updatePbrBuffer(v):vj(v,s,!0)}for(const p of u)pS(p.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(s){let u=!1;if(!s.meshes)return u;for(const p of s.meshes)p.pbrBuffer&&(p.pbrBuffer.updateData(p.featureArray),u=!0);return u}needsReEvaluation(s,u,p){const v=s.transform.projectionOptions,m=s.style.getBrightness(),_=this.brightness!==m;if(!this.uploaded||this.dirty||v.name!==this.projection.name||xb(p.paint.get("model-color").value,_)||xb(p.paint.get("model-color-mix-intensity").value,_)||xb(p.paint.get("model-roughness").value,_)||xb(p.paint.get("model-emissive-strength").value,_)||xb(p.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=v,this.brightness=m;const C=this.getNodesInfo();for(const O of C)O.state=null;return!0}return!1}evaluateScale(s,u){if(s.transform.zoom===this.zoom)return;this.zoom=s.transform.zoom;const p=this.getNodesInfo(),v=this.id.canonical;for(const m of p){const _=m.feature;m.evaluatedScale=u.paint.get("model-scale").evaluate(_,{},v)}}evaluate(s,u){const p=this.getNodesInfo();for(const v of p){if(!v.node.meshes)continue;const m=v.feature,_=u&&u[m.id];if(qr(_,v.state))continue;v.state=structuredClone(_);const C=v.node.meshes&&v.node.meshes[0].featureData,O=v.evaluatedColor[2],B=v.evaluatedRMEA[2],j=this.id.canonical;if(v.hasTranslucentParts=!1,C){for(let R=0;R<fF.length;R++){const F=fF[R];F.length&&(m.properties.part=F);const M=s.paint.get("model-color").evaluate(m,_,j).toRenderColor(null),I=s.paint.get("model-color-mix-intensity").evaluate(m,_,j);v.evaluatedColor[R]=[M.r,M.g,M.b,I],v.evaluatedRMEA[R][0]=s.paint.get("model-roughness").evaluate(m,_,j),v.evaluatedRMEA[R][2]=s.paint.get("model-emissive-strength").evaluate(m,_,j),v.evaluatedRMEA[R][3]=M.a,v.emissionHeightBasedParams[R]=s.paint.get("model-height-based-emissive-strength-multiplier").evaluate(m,_,j),!v.hasTranslucentParts&&M.a<1&&(v.hasTranslucentParts=!0)}delete m.properties.part,Gae(v,O!==v.evaluatedColor[2]||B!==v.evaluatedRMEA[2],this.modelTraits)}else v.evaluatedRMEA[0][2]=s.paint.get("model-emissive-strength").evaluate(m,_,j);v.evaluatedScale=s.paint.get("model-scale").evaluate(m,_,j),this.updatePbrBuffer(v.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(s,u,p,v){const m=s.findDEMTileFor(p);if(m&&(m.tileID.canonical!==this.terrainTile||u!==this.terrainExaggeration)){if(m.dem&&m.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=m.tileID.overscaledZ;const _=Vv.create(s,p,m);if(!_)return;this.modelTraits&Bv.HasMapboxMeshFeatures&&this.updateDEM(s,_,p,v);for(const C of this.getNodesInfo()){const O=C.node;if(!O.footprint||!O.footprint.vertices||!O.footprint.vertices.length)continue;const B=O.footprint.vertices;let j=_.getElevationAt(B[0].x,B[0].y,!0,!0);for(let R=1;R<B.length;R++)j=Math.min(j,_.getElevationAt(B[R].x,B[R].y,!0,!0));O.elevation=j}}this.terrainTile=m.tileID.canonical,this.terrainExaggeration=u}}updateDEM(s,u,p,v){let m=u._dem._modifiedForSources[v];if(m===void 0&&(u._dem._modifiedForSources[v]=[],m=u._dem._modifiedForSources[v]),m.includes(p.canonical))return;const _=u._dem.dim;m.push(p.canonical);let C=!1;for(const O of this.getNodesInfo()){const B=O.node;if(!B.footprint||!B.footprint.grid)continue;const j=B.footprint.grid,R=u.tileCoordToPixel(j.min.x,j.min.y),F=u.tileCoordToPixel(j.max.x,j.max.y),M=Math.min(Math.min(_-F.y,R.x),Math.min(R.y,_-F.x));if(M<0)continue;const I=ur(M,2,5);let q=Math.max(0,R.x-I),X=Math.max(0,R.y-I),te=Math.min(F.x+I,_-1),le=Math.min(F.y+I,_-1);for(let ye=X;ye<=le;++ye)for(let Se=q;Se<=te;++Se)r0[ye*_+Se]=255;let ue=0,ie=0;for(let ye=0;ye<j.cellsY;++ye)for(let Se=0;Se<j.cellsX;++Se){if(!j.cells[ye*j.cellsX+Se])continue;const Le=u.tileCoordToPixel(j.min.x+Se/j.xScale,j.min.y+ye/j.yScale),Ie=u.tileCoordToPixel(j.min.x+(Se+1)/j.xScale,j.min.y+(ye+1)/j.yScale);for(let Me=Le.y;Me<=Math.min(Ie.y+1,_-1);++Me)for(let et=Le.x;et<=Math.min(Ie.x+1,_-1);++et)r0[Me*_+et]===255&&(r0[Me*_+et]=0,ue+=u.getElevationAtPixel(et,Me),ie++)}const fe=ue/ie;q=Math.max(1,R.x-I),X=Math.max(1,R.y-I),te=Math.min(F.x+I,_-2),le=Math.min(F.y+I,_-2),C=!0;for(let ye=X;ye<=le;++ye)for(let Se=q;Se<=te;++Se)r0[ye*_+Se]===0&&(_j[ye*_+Se]=u._dem.set(Se,ye,fe));for(let ye=1;ye<I;++ye){q=Math.max(1,R.x-ye),X=Math.max(1,R.y-ye),te=Math.min(F.x+ye,_-2),le=Math.min(F.y+ye,_-2);for(let Se=X;Se<=le;++Se)for(let Le=q;Le<=te;++Le){const Ie=Se*_+Le;if(r0[Ie]===255){let Me=0,et=0,Be=-1,rt=-1;for(let st=-1;st<=1;++st)for(let nt=-1;nt<=1;++nt){const ct=(Se+st)*_+Le+nt;if(r0[ct]>=ye)continue;const ht=_j[ct],vt=Math.abs(ht);vt>et&&(Me=ht,et=vt,Be=nt,rt=st)}if(et>.1){const st=1-(ye+.5*Math.abs(Be*rt))/I;let nt=u._dem.get(Le,Se)+Me*st;const ct=u._dem.get(Le+Be,Se+rt),ht=u._dem.get(Le-Be,Se-rt,!0);(nt-ct)*(nt-ht)>0&&(nt=(ct+ht)/2),_j[Ie]=u._dem.set(Le,Se,nt),r0[Ie]=ye}}}}}C&&(u._demTile.needsDEMTextureUpload=!0,u._dem._timestamp=Ze.now())}getNodesInfo(){return this.nodesInfo}destroy(){const s=this.getNodesInfo();for(const u of s)pS(u.node),xj(u.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(s,u){if(u.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=u.updateTime;const p=u.getReplacementRegionsForTile(s.toUnwrapped()),v=this.getNodesInfo();for(let m=0;m<this.nodesInfo.length;m++){const _=v[m].node;v[m].hiddenByReplacement=!!_.footprint&&!p.find(C=>C.footprint===_.footprint)}}getHeightAtTileCoord(s,u){const p=this.getNodesInfo(),v=[],m=[0,0,0],_=De.mat4.identity([]);for(let C=0;C<this.nodesInfo.length;C++){const O=p[C],B=O.node.meshes[0],j=B.transformedAabb;if(s<j.min[0]||u<j.min[1]||s>j.max[0]||u>j.max[1])continue;if(O.node.hidden===!0)return{height:1/0,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};De.mat4.invert(_,O.node.matrix),m[0]=s,m[1]=u,De.vec3.transformMat4(m,m,_);const R=(m[0]-B.aabb.min[0])/(B.aabb.max[0]-B.aabb.min[0])*t0|0,F=Math.min(63,(m[1]-B.aabb.min[1])/(B.aabb.max[1]-B.aabb.min[1])*t0|0)*t0+Math.min(63,R),M=B.heightmap[F];if(!(M<0&&O.node.footprint))return O.hiddenByReplacement?void 0:{height:M,maxHeight:O.feature.properties.height,hidden:!1,verticalScale:O.evaluatedScale[2]};if(O.node.footprint.grid.query(new At(s,u),new At(s,u),v),v.length>0)return{height:void 0,maxHeight:O.feature.properties.height,hidden:O.hiddenByReplacement,verticalScale:O.evaluatedScale[2]}}}}function xb(h,s){return!h.isLightConstant&&s}function qae(h,s,u,p,v,m,_,C){let O=(61440&s|(61440&s)>>4)>>8,B=(3840&s|(3840&s)>>4)>>4,j=240&s|(240&s)>>4;u[3]>0&&(O=Fr(O,255*u[0],u[3]),B=Fr(B,255*u[1],u[3]),j=Fr(j,255*u[2],u[3]));const R=O<<8|B,F=j<<8|Math.floor(255*p[3]),M=function(ye){const Se=ur(ye,0,2);return Math.min(Math.round(.5*Se*255),255)}(p[2])<<8|15*p[0]<<4|15*p[1],I=ur(v[0],0,1),q=ur(v[1],0,1),X=ur(v[2],0,1),te=ur(v[3],0,1);let le,ue,ie,fe;if(I!==q&&_!==m&&q!==I){const ye=_-m;ue=1/(ye*(q-I)),ie=-(m+ye*I)/(ye*(q-I));const Se=ur(v[4],-1,1);fe=Math.pow(10,Se),le=255*X<<8|255*te}else le=65535,ue=0,ie=1,fe=1;if(h.emplaceBack(R,F,M,le,ue,ie,fe),C){const ye=C.length;C.clear();for(let Se=0;Se<ye;Se++)C.emplaceBack(R,F,M,le,ue,ie,fe)}}function Gae(h,s,u){const p=h.node;let v=0;const m=u&Bv.HasMeshoptCompression;for(const _ of p.meshes){if(p.lights&&p.lightMeshIndex===v||!_.featureData)continue;_.featureArray=new yh,_.featureArray.reserve(_.featureData.length);let C=s;for(const O of _.featureData){const B=m?65535&O:O>>16&65535,j=m?O>>16&65535:65535&O,R=(15&j)<8?15&j:0,F=h.evaluatedRMEA[R],M=h.evaluatedColor[R],I=h.emissionHeightBasedParams[R];let q;if(C&&R===2&&p.lights&&(q=new yh,q.resize(10*p.lights.length)),qae(_.featureArray,B,M,F,I,_.aabb.min[2],_.aabb.max[2],q),q&&C){C=!1;const X=p.meshes[p.lightMeshIndex];X.featureArray=q,X.featureArray._trim()}}_.featureArray._trim(),v++}}function mF(h,s,u,p){const v=1<<h.z;s.lat=Vr((p/hr+h.y)/v),s.lng=il((u/hr+h.x)/v)}gr(mS,"Tiled3dModelBucket",{omit:["layers"]}),gr(pF,"Tiled3dModelFeature");const Wae={circle:class extends pi{constructor(h,s,u,p){super(h,{layout:Gt||(Gt=new qi({"circle-sort-key":new fr(_t.layout_circle["circle-sort-key"]),"circle-elevation-reference":new er(_t.layout_circle["circle-elevation-reference"]),visibility:new er(_t.layout_circle.visibility)})),paint:ft||(ft=new qi({"circle-radius":new fr(_t.paint_circle["circle-radius"]),"circle-color":new fr(_t.paint_circle["circle-color"]),"circle-blur":new fr(_t.paint_circle["circle-blur"]),"circle-opacity":new fr(_t.paint_circle["circle-opacity"]),"circle-translate":new er(_t.paint_circle["circle-translate"]),"circle-translate-anchor":new er(_t.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new er(_t.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new er(_t.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new fr(_t.paint_circle["circle-stroke-width"]),"circle-stroke-color":new fr(_t.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new fr(_t.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new er(_t.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}createBucket(h){return new _e(h)}queryRadius(h){const s=h;return kt("circle-radius",this,s)+kt("circle-stroke-width",this,s)+Et(this.paint.get("circle-translate"))}queryIntersectsFeature(h,s,u,p,v,m,_,C){const O=jt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),B=this.paint.get("circle-radius").evaluate(s,u)+this.paint.get("circle-stroke-width").evaluate(s,u);return Jp(h,p,m,_,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",O,B)}getProgramIds(){return["circle"]}getDefaultProgramParams(h,s,u){const p=Of(this);return{config:new vu(this,{zoom:s,lut:u}),defines:p,overrideFog:!1}}},heatmap:class extends pi{createBucket(h){return new z2(h)}constructor(h,s,u,p){super(h,{layout:Ah||(Ah=new qi({visibility:new er(_t.layout_heatmap.visibility)})),paint:Yy||(Yy=new qi({"heatmap-radius":new fr(_t.paint_heatmap["heatmap-radius"]),"heatmap-weight":new fr(_t.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new er(_t.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Vl(_t.paint_heatmap["heatmap-color"]),"heatmap-opacity":new er(_t.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=xg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(h){return kt("heatmap-radius",this,h)}queryIntersectsFeature(h,s,u,p,v,m,_,C){const O=this.paint.get("heatmap-radius").evaluate(s,u);return Jp(h,p,m,_,C,!0,!0,new At(0,0),O)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(h,s,u){return h==="heatmap"?{config:new vu(this,{zoom:s,lut:u}),overrideFog:!1}:{}}},hillshade:class extends pi{constructor(h,s,u,p){super(h,{layout:Rf||(Rf=new qi({visibility:new er(_t.layout_hillshade.visibility)})),paint:Xy||(Xy=new qi({"hillshade-illumination-direction":new er(_t.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new er(_t.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new er(_t.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new er(_t.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new er(_t.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new er(_t.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new er(_t.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(h,s,u){return{overrideFog:!1}}},fill:class extends pi{constructor(h,s,u,p){super(h,{layout:ws||(ws=new qi({"fill-sort-key":new fr(_t.layout_fill["fill-sort-key"]),visibility:new er(_t.layout_fill.visibility),"fill-elevation-reference":new er(_t.layout_fill["fill-elevation-reference"])})),paint:qt||(qt=new qi({"fill-antialias":new er(_t.paint_fill["fill-antialias"]),"fill-opacity":new fr(_t.paint_fill["fill-opacity"]),"fill-color":new fr(_t.paint_fill["fill-color"]),"fill-outline-color":new fr(_t.paint_fill["fill-outline-color"]),"fill-translate":new er(_t.paint_fill["fill-translate"]),"fill-translate-anchor":new er(_t.paint_fill["fill-translate-anchor"]),"fill-pattern":new fr(_t.paint_fill["fill-pattern"]),"fill-emissive-strength":new er(_t.paint_fill["fill-emissive-strength"]),"fill-z-offset":new fr(_t.paint_fill["fill-z-offset"]),"fill-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}getProgramIds(){const h=this.paint.get("fill-pattern"),s=h&&h.constantOr(1),u=[s?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(s&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getDefaultProgramParams(h,s,u){return{config:new vu(this,{zoom:s,lut:u}),overrideFog:!1}}recalculate(h,s){super.recalculate(h,s);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(h){return new dn(h)}queryRadius(){return Et(this.paint.get("fill-translate"))}queryIntersectsFeature(h,s,u,p,v,m){return!h.queryGeometry.isAboveHorizon&&be(dt(h.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends pi{constructor(h,s,u,p){super(h,{layout:$5||($5=new qi({visibility:new er(_t["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new er(_t["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:q5||(q5=new qi({"fill-extrusion-opacity":new er(_t["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new fr(_t["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new er(_t["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new er(_t["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fr(_t["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new fr(_t["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new fr(_t["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new er(_t["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new er(_t["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new er(_t["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new er(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new er(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new er(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new er(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new er(_t["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new er(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new er(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new fr(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new fr(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new er(_t["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new er(_t["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new er(_t["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new er(_t["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new fr(_t["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new fr(_t["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new er(_t["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(h){return new G2(h)}queryRadius(){return Et(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(h,s,u,p,v,m,_,C,O){const B=jt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),j=this.paint.get("fill-extrusion-height").evaluate(s,u),R=this.paint.get("fill-extrusion-base").evaluate(s,u),F=[0,0],M=C&&m.elevation,I=m.elevation?m.elevation.exaggeration():1,q=h.tile.getBucket(this);if(M&&q instanceof G2){const ie=q.centroidVertexArray,fe=O+1;fe<ie.length&&(F[0]=ie.geta_centroid_pos0(fe),F[1]=ie.geta_centroid_pos1(fe))}if(F[0]===0&&F[1]===1)return!1;m.projection.name==="globe"&&(p=U5([p],[new At(0,0),new At(hr,hr)],h.tileID.canonical).map(ie=>ie.polygon).flat());const X=M?C:null,[te,le]=function(ie,fe,ye,Se,Le,Ie,Me,et,Be,rt,st){return ie.projection.name==="globe"?function(nt,ct,ht,vt,ut,It,Wt,Rt,mr,dr,tr){const Ht=[],kr=[],vr=nt.projection.upVectorScale(tr,nt.center.lat,nt.worldSize).metersToTile,br=[0,0,0,1],en=[0,0,0,1],mn=(bn,Ln,Bn,Li)=>{bn[0]=Ln,bn[1]=Bn,bn[2]=Li,bn[3]=1},_n=V5();ht>0&&(ht+=_n),vt+=_n;for(const bn of ct){const Ln=[],Bn=[];for(const Li of bn){const Pi=Li.x+ut.x,un=Li.y+ut.y,xi=nt.projection.projectTilePoint(Pi,un,tr),Si=nt.projection.upVector(tr,Li.x,Li.y);let Yi=ht,Da=vt;if(Wt){const os=W5(Pi,un,ht,vt,Wt,Rt,mr,dr);Yi+=os.base,Da+=os.top}ht!==0?mn(br,xi.x+Si[0]*vr*Yi,xi.y+Si[1]*vr*Yi,xi.z+Si[2]*vr*Yi):mn(br,xi.x,xi.y,xi.z),mn(en,xi.x+Si[0]*vr*Da,xi.y+Si[1]*vr*Da,xi.z+Si[2]*vr*Da),De.vec3.transformMat4(br,br,It),De.vec3.transformMat4(en,en,It),Ln.push(new Qy(br[0],br[1],br[2])),Bn.push(new Qy(en[0],en[1],en[2]))}Ht.push(Ln),kr.push(Bn)}return[Ht,kr]}(ie,fe,ye,Se,Le,Ie,Me,et,Be,rt,st):Me?function(nt,ct,ht,vt,ut,It,Wt,Rt,mr){const dr=[],tr=[],Ht=[0,0,0,1];for(const kr of nt){const vr=[],br=[];for(const en of kr){const mn=en.x+vt.x,_n=en.y+vt.y,bn=W5(mn,_n,ct,ht,It,Wt,Rt,mr);Ht[0]=mn,Ht[1]=_n,Ht[2]=bn.base,Ht[3]=1,De.vec4.transformMat4(Ht,Ht,ut),Ht[3]=Math.max(Ht[3],1e-5);const Ln=new Qy(Ht[0]/Ht[3],Ht[1]/Ht[3],Ht[2]/Ht[3]);Ht[0]=mn,Ht[1]=_n,Ht[2]=bn.top,Ht[3]=1,De.vec4.transformMat4(Ht,Ht,ut),Ht[3]=Math.max(Ht[3],1e-5);const Bn=new Qy(Ht[0]/Ht[3],Ht[1]/Ht[3],Ht[2]/Ht[3]);vr.push(Ln),br.push(Bn)}dr.push(vr),tr.push(br)}return[dr,tr]}(fe,ye,Se,Le,Ie,Me,et,Be,rt):function(nt,ct,ht,vt,ut){const It=[],Wt=[],Rt=ut[8]*ct,mr=ut[9]*ct,dr=ut[10]*ct,tr=ut[11]*ct,Ht=ut[8]*ht,kr=ut[9]*ht,vr=ut[10]*ht,br=ut[11]*ht;for(const en of nt){const mn=[],_n=[];for(const bn of en){const Ln=bn.x+vt.x,Bn=bn.y+vt.y,Li=ut[0]*Ln+ut[4]*Bn+ut[12],Pi=ut[1]*Ln+ut[5]*Bn+ut[13],un=ut[2]*Ln+ut[6]*Bn+ut[14],xi=ut[3]*Ln+ut[7]*Bn+ut[15],Si=Li+Rt,Yi=Pi+mr,Da=un+dr,os=Math.max(xi+tr,1e-5),La=Li+Ht,Aa=Pi+kr,Ga=un+vr,Ss=Math.max(xi+br,1e-5);mn.push(new Qy(Si/os,Yi/os,Da/os)),_n.push(new Qy(La/Ss,Aa/Ss,Ga/Ss))}It.push(mn),Wt.push(_n)}return[It,Wt]}(fe,ye,Se,Le,Ie)}(m,p,R,j,B,_,X,F,I,m.center.lat,h.tileID.canonical),ue=h.queryGeometry;return function(ie,fe,ye){let Se=1/0;be(ye,fe)&&(Se=G5(ye,fe[0]));for(let Le=0;Le<fe.length;Le++){const Ie=fe[Le],Me=ie[Le];for(let et=0;et<Ie.length-1;et++){const Be=Ie[et],rt=[Be,Ie[et+1],Me[et+1],Me[et],Be];me(ye,rt)&&(Se=Math.min(Se,G5(ye,rt)))}}return Se!==1/0&&Se}(te,le,ue.isPointQuery()?ue.screenBounds:ue.screenGeometry)}},line:class extends pi{constructor(h,s,u,p){const v=rz();super(h,v,s,u,p),v.layout&&(this.layout=new ud(v.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(h){if(h==="line-gradient"){const s=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=s._styleExpression&&s._styleExpression.expression instanceof Xd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(h,s){super.recalculate(h,s),this.paint._values["line-floorwidth"]=(()=>{if(ob)return ob;const u=rz();return ob=new Kie(u.paint.properties["line-width"].specification),ob.useIntegerZoom=!0,ob})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,h)}createBucket(h){return new WN(h)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(h,s,u){const p=ez(this);return{config:new vu(this,{zoom:s,lut:u}),defines:p,overrideFog:!1}}queryRadius(h){const s=h,u=nz(kt("line-width",this,s),kt("line-gap-width",this,s)),p=kt("line-offset",this,s);return u/2+Math.abs(p)+Et(this.paint.get("line-translate"))}queryIntersectsFeature(h,s,u,p,v,m){if(h.queryGeometry.isAboveHorizon)return!1;const _=dt(h.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,h.pixelToTileUnitsFactor),C=h.pixelToTileUnitsFactor/2*nz(this.paint.get("line-width").evaluate(s,u),this.paint.get("line-gap-width").evaluate(s,u)),O=this.paint.get("line-offset").evaluate(s,u);return O&&(p=function(B,j){const R=[],F=new At(0,0);for(let M=0;M<B.length;M++){const I=B[M],q=[];for(let X=0;X<I.length;X++){const te=I[X],le=I[X+1],ue=X===0?F:te.sub(I[X-1])._unit()._perp(),ie=X===I.length-1?F:le.sub(te)._unit()._perp(),fe=ue._add(ie)._unit();fe._mult(1/(fe.x*ie.x+fe.y*ie.y)),q.push(fe._mult(j)._add(te))}R.push(q)}return R}(p,O*h.pixelToTileUnitsFactor)),function(B,j,R){for(let F=0;F<j.length;F++){const M=j[F];if(B.length>=3){for(let I=0;I<M.length;I++)if(Ge(B,M[I]))return!0}if(Ee(B,M,R))return!0}return!1}(_,p,C)}isTileClipped(){return!0}isDraped(h){return!this.hasElevatedBuckets}},symbol:oS,background:class extends pi{constructor(h,s,u,p){super(h,{layout:Bz||(Bz=new qi({visibility:new er(_t.layout_background.visibility)})),paint:Vz||(Vz=new qi({"background-pitch-alignment":new er(_t.paint_background["background-pitch-alignment"]),"background-color":new er(_t.paint_background["background-color"]),"background-pattern":new er(_t.paint_background["background-pattern"]),"background-opacity":new er(_t.paint_background["background-opacity"]),"background-emissive-strength":new er(_t.paint_background["background-emissive-strength"]),"background-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(h,s,u){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:Wz,"raster-particle":Jz,sky:class extends pi{constructor(h,s,u,p){super(h,{layout:Zz||(Zz=new qi({visibility:new er(_t.layout_sky.visibility)})),paint:Yz||(Yz=new qi({"sky-type":new er(_t.paint_sky["sky-type"]),"sky-atmosphere-sun":new er(_t.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new er(_t.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new er(_t.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new er(_t.paint_sky["sky-gradient-radius"]),"sky-gradient":new Vl(_t.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new er(_t.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new er(_t.paint_sky["sky-atmosphere-color"]),"sky-opacity":new er(_t.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(h){h==="sky-gradient"?this._updateColorRamp():h!=="sky-atmosphere-sun"&&h!=="sky-atmosphere-halo-color"&&h!=="sky-atmosphere-color"&&h!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=xg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(h){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const s=h.style.light.properties.get("position");return this._lightPosition.azimuthal!==s.azimuthal||this._lightPosition.polar!==s.polar}return!1}getCenter(h,s){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),v=!p,m=h.style.light,_=m.properties.get("position");return v&&m.properties.get("anchor")==="viewport"&&sn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),v?pj(_.azimuthal,90-_.polar,s):pj(p[0],90-p[1],s)}const u=this.paint.get("sky-gradient-center");return pj(u[0],90-u[1],s)}isSky(){return!0}markSkyboxValid(h){this._skyboxInvalidated=!1,this._lightPosition=h.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const h=this.paint.get("sky-type");return h==="atmosphere"?["skyboxCapture","skybox"]:h==="gradient"?["skyboxGradient"]:null}},slot:class extends pi{constructor(h,s,u,p){super(h,{paint:Xz||(Xz=new qi({}))},s,null)}},model:class extends pi{constructor(h,s,u,p){super(h,{layout:lF||(lF=new qi({visibility:new er(_t.layout_model.visibility),"model-id":new fr(_t.layout_model["model-id"])})),paint:cF||(cF=new qi({"model-opacity":new fr(_t.paint_model["model-opacity"]),"model-rotation":new fr(_t.paint_model["model-rotation"]),"model-scale":new fr(_t.paint_model["model-scale"]),"model-translation":new fr(_t.paint_model["model-translation"]),"model-color":new fr(_t.paint_model["model-color"]),"model-color-mix-intensity":new fr(_t.paint_model["model-color-mix-intensity"]),"model-type":new er(_t.paint_model["model-type"]),"model-cast-shadows":new er(_t.paint_model["model-cast-shadows"]),"model-receive-shadows":new er(_t.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new er(_t.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new fr(_t.paint_model["model-emissive-strength"]),"model-roughness":new fr(_t.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new fr(_t.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new er(_t.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new er(_t.paint_model["model-front-cutoff"]),"model-color-use-theme":new fr({type:"string",default:"default","property-type":"data-driven"})}))},s,u,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(h){return new yj(h)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(h){return h instanceof mS?hr-1:0}queryIntersectsFeature(h,s,u,p,v,m){if(!this.modelManager)return!1;const _=this.modelManager,C=h.tile.getBucket(this);if(!(C&&C instanceof yj))return!1;for(const O in C.instancesPerModel){const B=C.instancesPerModel[O],j=s.id!==void 0?s.id:s.properties&&s.properties.hasOwnProperty("id")?s.properties.id:void 0;if(B.idToFeaturesIndex.hasOwnProperty(j)){const R=B.features[B.idToFeaturesIndex[j]],F=_.getModel(O,this.scope);if(!F)return!1;let M=De.mat4.create();const I=new Zn(0,0),q=C.canonical;let X=Number.MAX_VALUE;for(let te=0;te<R.instancedDataCount;++te){const le=16*(R.instancedDataOffset+te),ue=B.instancedDataArray.float32,ie=[ue[le+4],ue[le+5],ue[le+6]];mF(q,I,ue[le],0|ue[le+1]),uF(M,F,m,I,R.rotation,R.scale,ie,!1,!1,!1),m.projection.name==="globe"&&(M=gj(M,m));const fe=De.mat4.multiply([],m.projMatrix,M),ye=h.queryGeometry,Se=nF(ye.isPointQuery()?ye.screenBounds:ye.screenGeometry,m,fe,F.aabb);Se!=null&&(X=Math.min(Se,X))}return X!==Number.MAX_VALUE&&X}}return!1}_handleOverridablePaintPropertyUpdate(h,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven()||h!=="model-color"&&h!=="model-color-mix-intensity"&&h!=="model-rotation"&&h!=="model-scale"&&h!=="model-translation"&&h!=="model-emissive-strength")}_isPropertyZoomDependent(h){const s=this._transitionablePaint._values[h];return s!=null&&s.value!=null&&s.value.expression!=null&&s.value.expression instanceof sh}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends pi{constructor(h,s,u,p){super(h,{layout:Ot||(Ot=new qi({"clip-layer-types":new er(_t.layout_clip["clip-layer-types"]),"clip-layer-scope":new er(_t.layout_clip["clip-layer-scope"])})),paint:Kt||(Kt=new qi({}))},s,u,p)}recalculate(h,s){super.recalculate(h,s)}createBucket(h){return new Fn(h)}isTileClipped(){return!0}is3D(){return!0}}};class Hae{constructor(s){this._callback=s,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Kae{constructor(){this.tasks={},this.taskQueue=[],To(["process"],this),this.invoker=new Hae(this.process),this.nextId=0}add(s,u){const p=this.nextId++,v=function({type:m,isSymbolTile:_,zoom:C}){return C=C||0,m==="message"?0:m!=="maybePrepare"||_?m!=="parseTile"||_?m==="parseTile"&&_?300-C:m==="maybePrepare"&&_?400-C:500:200-C:100-C}(u);if(v===0){try{s()}finally{}return null}return this.tasks[p]={fn:s,metadata:u,priority:v,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const s=this.pick();if(s===null)return;const u=this.tasks[s];if(delete this.tasks[s],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let s=null,u=1/0;for(let v=0;v<this.taskQueue.length;v++){const m=this.tasks[this.taskQueue[v]];m.priority<u&&(u=m.priority,s=v)}if(s===null)return null;const p=this.taskQueue[s];return this.taskQueue.splice(s,1),p}remove(){this.invoker.remove()}}class gF{constructor(s,u,p){this.target=s,this.parent=u,this.mapId=p,this.callbacks={},this.cancelCallbacks={},To(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Kae}send(s,u,p,v,m=!1,_){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=_,this.callbacks[C]=p);const O=new Set;return this.target.postMessage({id:C,type:s,hasCallback:!!p,targetMapId:v,mustQueue:m,sourceMapId:this.mapId,data:fo(u,O)},O),{cancel:()=>{p&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:v,sourceMapId:this.mapId})}}}receive(s){const u=s.data,p=u.id;if(p&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){const v=this.cancelCallbacks[p];delete this.cancelCallbacks[p],v&&v.cancel()}else if(u.mustQueue||Zs()){const v=this.callbacks[p],m=this.scheduler.add(()=>this.processTask(p,u),v&&v.metadata||{type:"message"});m&&(this.cancelCallbacks[p]=m)}else this.processTask(p,u)}processTask(s,u){if(delete this.cancelCallbacks[s],u.type==="<response>"){const p=this.callbacks[s];delete this.callbacks[s],p&&(u.error?p(vl(u.error)):p(null,vl(u.data)))}else{const p=new Set,v=u.hasCallback?(_,C)=>{this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:_?fo(_):null,data:fo(C,p)},p)}:()=>{},m=vl(u.data);if(this.parent[u.type])this.parent[u.type](u.sourceMapId,m,v);else if(this.parent.getWorkerSource){const _=u.type.split(".");this.parent.getWorkerSource(u.sourceMapId,_[0],m.source,m.scope)[_[1]](m,v)}else v(new Error(`Could not find function ${u.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var _b={workerUrl:"",workerClass:null,workerParams:void 0};const bj="mapboxgl_preloaded_worker_pool";class n0{constructor(){this.active={}}acquire(s,u=n0.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<u;)this.workers.push(_b.workerClass!=null?new _b.workerClass:new self.Worker(_b.workerUrl,_b.workerParams));return this.active[s]=!0,this.workers.slice()}release(s){delete this.active[s],this.workers&&this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[bj]}numActive(){return Object.keys(this.active).length}}n0.workerCount=2;class Uv{constructor(s,u,p="Worker",v=n0.workerCount){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=Va();const m=this.workerPool.acquire(this.id,v);for(let _=0;_<m.length;_++){const C=new Uv.Actor(m[_],u,this.id);C.name=`${p} ${_}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(s,u,p){gi(this.actors,(v,m)=>{v.send(s,u,m)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(s=>{s.remove()}),this.actors=[],this.workerPool.release(this.id)}}let bb,wj;function gS(){return bb||(bb=new n0),bb}Uv.Actor=gF;const Sj=new Qn(0,0,0);var Aj=(h=>(h[h.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",h[h.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",h[h.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",h))(Aj||{}),yS=(h=>(h[h.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",h[h.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",h[h.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",h[h.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",h))(yS||{}),wb=(h=>(h[h.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",h[h.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",h[h.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",h[h.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",h[h.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",h))(wb||{}),yF=(h=>(h[h.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",h[h.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",h[h.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",h))(yF||{}),$v=(h=>(h[h.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",h[h.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",h[h.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",h[h.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",h[h.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",h[h.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",h))($v||{}),vF=(h=>(h[h.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",h[h.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",h[h.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",h))(vF||{});function Zae(h,s,u){h===1&&s.icons.push(function(p,v){return function(m){if(m.usvg_tree.height||(m.usvg_tree.height=m.usvg_tree.width),!m.metadata)return m;const{metadata:_}=m;if(_.content_area){const{content_area:C}=_;C.top==null&&(C.top=C.left),C.width==null&&(C.width=m.usvg_tree.width),C.height==null&&(C.height=C.width)}return _.stretch_x&&_.stretch_x.length&&xF(_,"x"),_.stretch_y&&_.stretch_y.length&&xF(_,"y"),m}(p.readFields(Yae,{name:void 0},v))}(u,u.readVarint()+u.pos))}function xF(h,s){const u=[],p=h[`stretch_${s}`];let v=null;for(let m=0;m<p.length;m++)v===null?v=u.length===0?p[0]:u[u.length-1][1]+p[m]:(u.push([v,v+p[m]]),v=null);h[`stretch_${s}_areas`]=u}function Yae(h,s,u){h===1?s.name=u.readString():h===2?s.metadata=function(p,v){return p.readFields(Xae,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},v)}(u,u.readVarint()+u.pos):h===3&&(s.usvg_tree=function(p,v){return p.readFields(ese,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},v)}(u,u.readVarint()+u.pos),s.data="usvg_tree")}function Xae(h,s,u){h===1?s.stretch_x=u.readPackedVarint():h===2?s.stretch_y=u.readPackedVarint():h===3?s.content_area=function(p,v){return p.readFields(Jae,{left:0},v)}(u,u.readVarint()+u.pos):h===4&&s.variables.push(function(p,v){return p.readFields(Qae,{name:void 0},v)}(u,u.readVarint()+u.pos))}function Jae(h,s,u){h===1?s.left=u.readVarint():h===2?s.width=u.readVarint():h===3?s.top=u.readVarint():h===4&&(s.height=u.readVarint())}function Qae(h,s,u){h===1?s.name=u.readString():h===2&&(s.rgb_color=_S(u.readVarint()),s.value="rgb_color")}function ese(h,s,u){h===1?s.width=s.height=u.readVarint():h===2?s.height=u.readVarint():h===3?s.children.push(vS(u,u.readVarint()+u.pos)):h===4?s.linear_gradients.push(function(p,v){return p.readFields(ose,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},v)}(u,u.readVarint()+u.pos)):h===5?s.radial_gradients.push(function(p,v){return p.readFields(cse,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},v)}(u,u.readVarint()+u.pos)):h===7?s.clip_paths.push(function(p,v){return p.readFields(use,{children:[]},v)}(u,u.readVarint()+u.pos)):h===8&&s.masks.push(function(p,v){const m=p.readFields(dse,{left:0,width:20,mask_type:1,children:[]},v);return m.height==null&&(m.height=m.width),m.top==null&&(m.top=m.left),m}(u,u.readVarint()+u.pos))}function vS(h,s){return h.readFields(tse,{},s)}function tse(h,s,u){h===1?(s.group=function(p,v){return p.readFields(rse,{opacity:255,children:[]},v)}(u,u.readVarint()+u.pos),s.node="group"):h===2&&(s.path=function(p,v){return p.readFields(ise,{paint_order:1,commands:[],step:1,diffs:[],rule:1},v)}(u,u.readVarint()+u.pos),s.node="path")}function rse(h,s,u){h===1?s.transform=xS(u,u.readVarint()+u.pos):h===2?s.opacity=u.readVarint():h===5?s.clip_path_idx=u.readVarint():h===6?s.mask_idx=u.readVarint():h===7&&s.children.push(vS(u,u.readVarint()+u.pos))}function xS(h,s){return h.readFields(nse,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},s)}function nse(h,s,u){h===1?s.sx=u.readFloat():h===2?s.ky=u.readFloat():h===3?s.kx=u.readFloat():h===4?s.sy=u.readFloat():h===5?s.tx=u.readFloat():h===6&&(s.ty=u.readFloat())}function ise(h,s,u){h===1?s.fill=function(p,v){return p.readFields(ase,{rgb_color:Sj,paint:"rgb_color",opacity:255},v)}(u,u.readVarint()+u.pos):h===2?s.stroke=function(p,v){return p.readFields(sse,{rgb_color:Sj,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},v)}(u,u.readVarint()+u.pos):h===3?s.paint_order=u.readVarint():h===5?u.readPackedVarint(s.commands):h===6?s.step=u.readFloat():h===7?u.readPackedSVarint(s.diffs):h===8&&(s.rule=u.readVarint())}function ase(h,s,u){h===1?(s.rgb_color=_S(u.readVarint()),s.paint="rgb_color"):h===2?(s.linear_gradient_idx=u.readVarint(),s.paint="linear_gradient_idx"):h===3?(s.radial_gradient_idx=u.readVarint(),s.paint="radial_gradient_idx"):h===5&&(s.opacity=u.readVarint())}function _S(h){return new Qn((h>>16&255)/255,(h>>8&255)/255,(255&h)/255,1)}function sse(h,s,u){h===1?(s.rgb_color=_S(u.readVarint()),s.paint="rgb_color"):h===2?(s.linear_gradient_idx=u.readVarint(),s.paint="linear_gradient_idx"):h===3?(s.radial_gradient_idx=u.readVarint(),s.paint="radial_gradient_idx"):h===5?u.readPackedFloat(s.dasharray):h===6?s.dashoffset=u.readFloat():h===7?s.miterlimit=u.readFloat():h===8?s.opacity=u.readVarint():h===9?s.width=u.readFloat():h===10?s.linecap=u.readVarint():h===11&&(s.linejoin=u.readVarint())}function ose(h,s,u){h===1?s.transform=xS(u,u.readVarint()+u.pos):h===2?s.spread_method=u.readVarint():h===3?s.stops.push(_F(u,u.readVarint()+u.pos)):h===4?s.x1=u.readFloat():h===5?s.y1=u.readFloat():h===6?s.x2=u.readFloat():h===7&&(s.y2=u.readFloat())}function _F(h,s){return h.readFields(lse,{offset:0,opacity:255,rgb_color:Sj},s)}function lse(h,s,u){h===1?s.offset=u.readFloat():h===2?s.opacity=u.readVarint():h===3&&(s.rgb_color=_S(u.readVarint()))}function cse(h,s,u){h===1?s.transform=xS(u,u.readVarint()+u.pos):h===2?s.spread_method=u.readVarint():h===3?s.stops.push(_F(u,u.readVarint()+u.pos)):h===4?s.cx=u.readFloat():h===5?s.cy=u.readFloat():h===6?s.r=u.readFloat():h===7?s.fx=u.readFloat():h===8?s.fy=u.readFloat():h===9&&(s.fr=u.readFloat())}function use(h,s,u){h===1?s.transform=xS(u,u.readVarint()+u.pos):h===2?s.clip_path_idx=u.readVarint():h===3&&s.children.push(vS(u,u.readVarint()+u.pos))}function dse(h,s,u){h===1?s.left=s.top=u.readFloat():h===2?s.width=s.height=u.readFloat():h===3?s.top=u.readFloat():h===4?s.height=u.readFloat():h===5?s.mask_type=u.readVarint():h===6?s.mask_idx=u.readVarint():h===7&&s.children.push(vS(u,u.readVarint()+u.pos))}class hse{static calculate(s,u){const p=new Map,v=new Map;if(Object.keys(s).length===0)return p;u.forEach(m=>{v.set(m.name,m.rgb_color||new Qn(0,0,0))});for(const[m,_]of Object.entries(s))v.has(m)?p.set(v.get(m).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${m}"`);return p}}function qv(h,s=255,u){const p=s/255,v=h.toStringPremultipliedAlpha(),m=u.has(v)?u.get(v).clone():h.clone();return m.a=p,m.toString()}function Sb(h,s){if(!ke()){const u=document.createElement("canvas");return u.width=h,u.height=s,u}return new OffscreenCanvas(h,s)}function fse(h,s){const u=hse.calculate(s.params,h.metadata?h.metadata.variables:[]),p=h.usvg_tree,v=p.width,m=p.height,_=s.transform?s.transform:new DOMMatrix,C=Math.max(1,Math.round(v*_.a)),O=Math.max(1,Math.round(m*_.d)),B=new DOMMatrix([C/v,0,0,O/m,0,0]),j=Sb(C,O).getContext("2d");return Tj(j,B,p,p,u),j.getImageData(0,0,C,O)}function Tj(h,s,u,p,v){for(const m of p.children)bF(h,s,u,m,v)}function bF(h,s,u,p,v){p.group?(h.save(),function(m,_,C,O,B){const j=O.mask_idx!=null?C.masks[O.mask_idx]:null,R=O.clip_path_idx!=null?C.clip_paths[O.clip_path_idx]:null;if(O.transform&&(_=bS(O.transform).preMultiplySelf(_)),!function(I,q,X){return I.opacity!==255||q||X}(O,R!=null,j!=null))return void Tj(m,_,C,O,B);const F=Sb(m.canvas.width,m.canvas.height),M=F.getContext("2d");Tj(M,_,C,O,B),R&&jF(M,_,C,R),j&&CF(M,_,C,j,B),m.globalAlpha=O.opacity/255,m.drawImage(F,0,0)}(h,s,u,p.group,v),h.restore()):p.path&&(h.save(),function(m,_,C,O,B){const j=kF(O);m.setTransform(_),O.paint_order===yF.PAINT_ORDER_FILL_AND_STROKE?(wF(m,C,O,j,B),AF(m,C,O,j,B)):(AF(m,C,O,j,B),wF(m,C,O,j,B))}(h,s,u,p.path,v),h.restore())}function wF(h,s,u,p,v){const m=u.fill;if(!m)return;const _=m.opacity/255;switch(m.paint){case"rgb_color":h.fillStyle=qv(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":h.fillStyle=TF(h,s.linear_gradients[m.linear_gradient_idx],_,v);break;case"radial_gradient_idx":h.fillStyle=PF(h,s.radial_gradients[m.radial_gradient_idx],_,v)}h.fill(p,SF(u))}function SF(h){return h.rule===Aj.PATH_RULE_NON_ZERO?"nonzero":h.rule===Aj.PATH_RULE_EVEN_ODD?"evenodd":void 0}function AF(h,s,u,p,v){const m=u.stroke;if(!m)return;h.lineWidth=m.width,h.miterLimit=m.miterlimit,h.setLineDash(m.dasharray),h.lineDashOffset=m.dashoffset;const _=m.opacity/255;switch(m.paint){case"rgb_color":h.strokeStyle=qv(m.rgb_color,m.opacity,v);break;case"linear_gradient_idx":h.strokeStyle=TF(h,s.linear_gradients[m.linear_gradient_idx],_,v);break;case"radial_gradient_idx":h.strokeStyle=PF(h,s.radial_gradients[m.radial_gradient_idx],_,v)}switch(m.linejoin){case wb.LINE_JOIN_MITER_CLIP:case wb.LINE_JOIN_MITER:h.lineJoin="miter";break;case wb.LINE_JOIN_ROUND:h.lineJoin="round";break;case wb.LINE_JOIN_BEVEL:h.lineJoin="bevel"}switch(m.linecap){case yS.LINE_CAP_BUTT:h.lineCap="butt";break;case yS.LINE_CAP_ROUND:h.lineCap="round";break;case yS.LINE_CAP_SQUARE:h.lineCap="square"}h.stroke(p)}function TF(h,s,u,p){if(s.stops.length===1){const F=s.stops[0];return qv(F.rgb_color,F.opacity*u,p)}const v=bS(s.transform),{x1:m,y1:_,x2:C,y2:O}=s,B=v.transformPoint(new DOMPoint(m,_)),j=v.transformPoint(new DOMPoint(C,O)),R=h.createLinearGradient(B.x,B.y,j.x,j.y);for(const F of s.stops)R.addColorStop(F.offset,qv(F.rgb_color,F.opacity*u,p));return R}function PF(h,s,u,p){if(s.stops.length===1){const F=s.stops[0];return qv(F.rgb_color,F.opacity*u,p)}const v=bS(s.transform),{fx:m,fy:_,cx:C,cy:O}=s,B=v.transformPoint(new DOMPoint(m,_)),j=v.transformPoint(new DOMPoint(C,O)),R=h.createRadialGradient(B.x,B.y,0,j.x,j.y,s.r*((v.a+v.d)/2));for(const F of s.stops)R.addColorStop(F.offset,qv(F.rgb_color,F.opacity*u,p));return R}function NF(h,s,u,p){const v=p.transform?bS(p.transform).preMultiplySelf(s):s,m=Sb(h.canvas.width,h.canvas.height),_=m.getContext("2d");for(const O of p.children)if(O.group)NF(_,v,u,O.group);else if(O.path){const B=O.path,j=new Path2D;j.addPath(kF(B),v),_.fill(j,SF(B))}const C=p.clip_path_idx!=null?u.clip_paths[p.clip_path_idx]:null;C&&jF(_,v,u,C),h.globalCompositeOperation="source-over",h.drawImage(m,0,0)}function jF(h,s,u,p){const v=Sb(h.canvas.width,h.canvas.height);NF(v.getContext("2d"),s,u,p),h.globalCompositeOperation="destination-in",h.drawImage(v,0,0)}function CF(h,s,u,p,v){if(p.children.length===0)return;const m=p.mask_idx!=null?u.masks[p.mask_idx]:null;m&&CF(h,s,u,m,v);const _=h.canvas.width,C=h.canvas.height,O=Sb(_,C),B=O.getContext("2d"),j=p.width,R=p.height,F=p.left,M=p.top,I=new Path2D,q=new Path2D;q.rect(F,M,j,R),I.addPath(q,s),B.clip(I);for(const le of p.children)bF(B,s,u,le,v);const X=B.getImageData(0,0,_,C),te=X.data;if(p.mask_type===vF.MASK_TYPE_LUMINANCE)for(let le=0;le<te.length;le+=4)te[le+3]=te[le+3]/255*(.2126*te[le]+.7152*te[le+1]+.0722*te[le+2]);B.putImageData(X,0,0),h.globalCompositeOperation="destination-in",h.drawImage(O,0,0)}function bS(h){return h?new DOMMatrix([h.sx,h.ky,h.kx,h.sy,h.tx,h.ty]):new DOMMatrix}function kF(h){const s=new Path2D,u=h.step;let p=h.diffs[0]*u,v=h.diffs[1]*u;s.moveTo(p,v);for(let m=0,_=2;m<h.commands.length;m++)switch(h.commands[m]){case $v.PATH_COMMAND_MOVE:p+=h.diffs[_++]*u,v+=h.diffs[_++]*u,s.moveTo(p,v);break;case $v.PATH_COMMAND_LINE:p+=h.diffs[_++]*u,v+=h.diffs[_++]*u,s.lineTo(p,v);break;case $v.PATH_COMMAND_QUAD:{const C=p+h.diffs[_++]*u,O=v+h.diffs[_++]*u;p=C+h.diffs[_++]*u,v=O+h.diffs[_++]*u,s.quadraticCurveTo(C,O,p,v);break}case $v.PATH_COMMAND_CUBIC:{const C=p+h.diffs[_++]*u,O=v+h.diffs[_++]*u,B=C+h.diffs[_++]*u,j=O+h.diffs[_++]*u;p=B+h.diffs[_++]*u,v=j+h.diffs[_++]*u,s.bezierCurveTo(C,O,B,j,p,v);break}case $v.PATH_COMMAND_CLOSE:s.closePath()}return s}class Pj{constructor(s){this.capacity=s,this.cache=new Map}get(s){if(!this.cache.has(s))return;const u=this.cache.get(s);return this.cache.delete(s),this.cache.set(s,u),u}put(s,u){this.cache.has(s)?this.cache.delete(s):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(s,u)}delete(s){this.cache.delete(s)}}class Nj{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(s){return new qs(s,s.data)}getFromCache(s,u,p){return this.cacheMap.has(p)||this.cacheMap.set(p,new Pj(150)),this.cacheMap.get(p).get(Eo(s.serialize(),u))}setInCache(s,u,p,v){this.cacheDependenciesMap.has(v)||this.cacheDependenciesMap.set(v,new Map),this.cacheMap.has(v)||this.cacheMap.set(v,new Pj(150));const m=this.cacheDependenciesMap.get(v);m.get(Eo(s.id,p))||m.set(Eo(s.id,p),new Set);const _=this.cacheMap.get(v),C=s.serialize();m.get(Eo(s.id,p)).add(C),_.put(Eo(s.serialize(),p),u)}removeImagesFromCacheByIds(s,u,p=""){if(!this.cacheMap.has(p)||!this.cacheDependenciesMap.has(p))return;const v=this.cacheMap.get(p),m=this.cacheDependenciesMap.get(p);for(const _ of s)if(m.has(Eo(_,u))){for(const C of m.get(Eo(_,u)))v.delete(C);m.delete(Eo(_,u))}}rasterize(s,u,p,v,m=fse){const _=this.getFromCache(s,p,v);if(_)return _.clone();const C=m(u.icon,s.options),O=Nj._getImage(C);return this.setInCache(s,O,p,v),O.clone()}}class EF{constructor(s){this.size=s,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(s,u){const p=this.toIdx(s,u);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(s,u){return this.leaves[this.toIdx(s,u)]}toIdx(s,u){return u*this.size+s}}function MF(h,s,u,p){let v=0,m=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(p[_])<1e-15){if(u[_]<h[_]||u[_]>s[_])return null}else{const C=1/p[_];let O=(h[_]-u[_])*C,B=(s[_]-u[_])*C;if(O>B){const j=O;O=B,B=j}if(O>v&&(v=O),B<m&&(m=B),v>m)return null}return v}function OF(h,s,u,p,v,m,_,C,O,B,j){const R=p-h,F=v-s,M=m-u,I=_-h,q=C-s,X=O-u,te=j[1]*X-j[2]*q,le=j[2]*I-j[0]*X,ue=j[0]*q-j[1]*I,ie=R*te+F*le+M*ue;if(Math.abs(ie)<1e-15)return null;const fe=1/ie,ye=B[0]-h,Se=B[1]-s,Le=B[2]-u,Ie=(ye*te+Se*le+Le*ue)*fe;if(Ie<0||Ie>1)return null;const Me=Se*M-Le*F,et=Le*R-ye*M,Be=ye*F-Se*R,rt=(j[0]*Me+j[1]*et+j[2]*Be)*fe;return rt<0||Ie+rt>1?null:(I*Me+q*et+X*Be)*fe}function RF(h,s,u){return(h-s)/(u-s)}function IF(h,s,u,p,v,m,_,C,O){const B=1<<u,j=m-p,R=_-v,F=(h+1)/B*j+p,M=(s+0)/B*R+v,I=(s+1)/B*R+v;C[0]=(h+0)/B*j+p,C[1]=M,O[0]=F,O[1]=I}class DF{constructor(s){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=s,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(m){const _=Math.ceil(Math.log2(m.dim/8)),C=[];let O=Math.ceil(Math.pow(2,_));const B=1/O,j=(M,I,q,X,te)=>{const le=X?1:0,ue=(M+1)*q-le,ie=I*q,fe=(I+1)*q-le;te[0]=M*q,te[1]=ie,te[2]=ue,te[3]=fe};let R=new EF(O);const F=[];for(let M=0;M<O*O;M++){j(M%O,Math.floor(M/O),B,!1,F);const I=Ng(F[0],F[1],m),q=Ng(F[2],F[1],m),X=Ng(F[2],F[3],m),te=Ng(F[0],F[3],m);R.minimums.push(Math.min(I,q,X,te)),R.maximums.push(Math.max(I,q,X,te)),R.leaves.push(1)}for(C.push(R),O/=2;O>=1;O/=2){const M=C[C.length-1];R=new EF(O);for(let I=0;I<O*O;I++){j(I%O,Math.floor(I/O),2,!0,F);const q=M.getElevation(F[0],F[1]),X=M.getElevation(F[2],F[1]),te=M.getElevation(F[2],F[3]),le=M.getElevation(F[0],F[3]),ue=M.isLeaf(F[0],F[1]),ie=M.isLeaf(F[2],F[1]),fe=M.isLeaf(F[2],F[3]),ye=M.isLeaf(F[0],F[3]),Se=Math.min(q.min,X.min,te.min,le.min),Le=Math.max(q.max,X.max,te.max,le.max),Ie=ue&&ie&&fe&&ye;R.maximums.push(Le),R.minimums.push(Se),R.leaves.push(Le-Se<=5&&Ie?1:0)}C.push(R)}return C}(this.dem),p=u.length-1,v=u[p];this._addNode(v.minimums[0],v.maximums[0],v.leaves[0]),this._construct(u,0,0,p,0)}raycastRoot(s,u,p,v,m,_,C=1){return MF([s,u,-100],[p,v,this.maximums[0]*C],m,_)}raycast(s,u,p,v,m,_,C=1){if(!this.nodeCount)return null;const O=this.raycastRoot(s,u,p,v,m,_,C);if(O==null)return null;const B=[],j=[],R=[],F=[],M=[{idx:0,t:O,nodex:0,nodey:0,depth:0}];for(;M.length>0;){const{idx:I,t:q,nodex:X,nodey:te,depth:le}=M.pop();if(this.leaves[I]){IF(X,te,le,s,u,p,v,R,F);const ie=1<<le,fe=(X+0)/ie,ye=(X+1)/ie,Se=(te+0)/ie,Le=(te+1)/ie,Ie=Ng(fe,Se,this.dem)*C,Me=Ng(ye,Se,this.dem)*C,et=Ng(ye,Le,this.dem)*C,Be=Ng(fe,Le,this.dem)*C,rt=OF(R[0],R[1],Ie,F[0],R[1],Me,F[0],F[1],et,m,_),st=OF(F[0],F[1],et,R[0],F[1],Be,R[0],R[1],Ie,m,_),nt=Math.min(rt!==null?rt:Number.MAX_VALUE,st!==null?st:Number.MAX_VALUE);if(nt!==Number.MAX_VALUE)return nt;{const ct=De.vec3.scaleAndAdd([],m,_,q);if(LF(Ie,Me,Be,et,RF(ct[0],R[0],F[0]),RF(ct[1],R[1],F[1]))>=ct[2])return q}continue}let ue=0;for(let ie=0;ie<this._siblingOffset.length;ie++){IF((X<<1)+this._siblingOffset[ie][0],(te<<1)+this._siblingOffset[ie][1],le+1,s,u,p,v,R,F),R[2]=-100,F[2]=this.maximums[this.childOffsets[I]+ie]*C;const fe=MF(R,F,m,_);if(fe!=null){const ye=fe;B[ie]=ye;let Se=!1;for(let Le=0;Le<ue&&!Se;Le++)ye>=B[j[Le]]&&(j.splice(Le,0,ie),Se=!0);Se||(j[ue]=ie),ue++}}for(let ie=0;ie<ue;ie++){const fe=j[ie];M.push({idx:this.childOffsets[I]+fe,t:B[fe],nodex:(X<<1)+this._siblingOffset[fe][0],nodey:(te<<1)+this._siblingOffset[fe][1],depth:le+1})}}return null}_addNode(s,u,p){return this.minimums.push(s),this.maximums.push(u),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(s,u,p,v,m){if(s[v].isLeaf(u,p)===1)return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const _=v-1,C=s[_];let O=0,B=0;for(let j=0;j<this._siblingOffset.length;j++){const R=2*u+this._siblingOffset[j][0],F=2*p+this._siblingOffset[j][1],M=C.getElevation(R,F),I=C.isLeaf(R,F),q=this._addNode(M.min,M.max,I);I&&(O|=1<<j),B||(B=q)}for(let j=0;j<this._siblingOffset.length;j++)O&1<<j||this._construct(s,2*u+this._siblingOffset[j][0],2*p+this._siblingOffset[j][1],_,B+j)}}function LF(h,s,u,p,v,m){return Fr(Fr(h,u,m),Fr(s,p,m),v)}function Ng(h,s,u){const p=u.dim,v=ur(h*p-.5,0,p-1),m=ur(s*p-.5,0,p-1),_=Math.floor(v),C=Math.floor(m),O=Math.min(_+1,p-1),B=Math.min(C+1,p-1);return LF(u.get(_,C),u.get(O,C),u.get(_,B),u.get(O,B),v-_,m-C)}const pse={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function mse(h,s,u){return(256*h*256+256*s+u)/10-1e4}function gse(h,s,u){return 256*h+s+u/256-32768}class wS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(s,u,p,v=!1){if(this.uid=s,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void sn(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const m=this.dim=u.height-2,_=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.floatView=new Float32Array(u.data.buffer),this.borderReady=v,this._modifiedForSources={},!v){for(let O=0;O<m;O++)_[this._idx(-1,O)]=_[this._idx(0,O)],_[this._idx(m,O)]=_[this._idx(m-1,O)],_[this._idx(O,-1)]=_[this._idx(O,0)],_[this._idx(O,m)]=_[this._idx(O,m-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(m,-1)]=_[this._idx(m-1,0)],_[this._idx(-1,m)]=_[this._idx(0,m-1)],_[this._idx(m,m)]=_[this._idx(m-1,m-1)]}const C=p==="terrarium"?gse:mse;for(let O=0;O<_.length;++O){const B=4*O;this.floatView[O]=C(this.pixels[B],this.pixels[B+1],this.pixels[B+2])}this._timestamp=Ze.now()}_buildQuadTree(){this._tree=new DF(this)}get(s,u,p=!1){p&&(s=ur(s,-1,this.dim),u=ur(u,-1,this.dim));const v=this._idx(s,u);return this.floatView[v]}set(s,u,p){const v=this._idx(s,u),m=this.floatView[v];return this.floatView[v]=p,p-m}static getUnpackVector(s){return pse[s]}_idx(s,u){if(s<-1||s>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(s+1)}static pack(s,u){const p=[0,0,0,0],v=wS.getUnpackVector(u);let m=Math.floor((s+v[3])/v[2]);return p[2]=m%256,m=Math.floor(m/256),p[1]=m%256,m=Math.floor(m/256),p[0]=m,p}getPixels(){return new Q_({width:this.stride,height:this.stride},this.pixels)}backfillBorder(s,u,p){if(this.dim!==s.dim)throw new Error("dem dimension mismatch");let v=u*this.dim,m=u*this.dim+this.dim,_=p*this.dim,C=p*this.dim+this.dim;switch(u){case-1:v=m-1;break;case 1:m=v+1}switch(p){case-1:_=C-1;break;case 1:C=_+1}const O=-u*this.dim,B=-p*this.dim;for(let j=_;j<C;j++)for(let R=v;R<m;R++){const F=4*this._idx(R,j),M=4*this._idx(R+O,j+B);this.pixels[F+0]=s.pixels[M+0],this.pixels[F+1]=s.pixels[M+1],this.pixels[F+2]=s.pixels[M+2],this.pixels[F+3]=s.pixels[M+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function yse(h,s,u){h===1?s.headerLength=u.readFixed32():h===2?s.x=u.readVarint():h===3?s.y=u.readVarint():h===4?s.z=u.readVarint():h===5&&s.layers.push(function(p,v){return p.readFields(wse,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},v)}(u,u.readVarint()+u.pos))}function vse(h,s,u){h===1?(s.delta_filter=function(p,v){return p.readFields(xse,{blockSize:0},v)}(u,u.readVarint()+u.pos),s.filter="delta_filter"):h===2?(u.readVarint(),s.filter="zigzag_filter"):h===3?(u.readVarint(),s.filter="bitshuffle_filter"):h===4&&(u.readVarint(),s.filter="byteshuffle_filter")}function xse(h,s,u){h===1&&(s.blockSize=u.readVarint())}function _se(h,s,u){h===1?(u.readVarint(),s.codec="gzip_data"):h===2?(u.readVarint(),s.codec="jpeg_image"):h===3?(u.readVarint(),s.codec="webp_image"):h===4&&(u.readVarint(),s.codec="png_image")}function bse(h,s,u){let p=0,v=0;h===1?s.firstByte=u.readFixed64():h===2?s.lastByte=u.readFixed64():h===3?s.filters.push(function(m,_){return m.readFields(vse,{},_)}(u,u.readVarint()+u.pos)):h===4?s.codec=function(m,_){return m.readFields(_se,{},_)}(u,u.readVarint()+u.pos):h===5?v=u.readFloat():h===6?p=u.readFloat():h===7?s.bands.push(u.readString()):h===8?s.offset=u.readDouble():h===9&&(s.scale=u.readDouble()),s.offset===0&&(s.offset=v),s.scale===0&&(s.scale=p)}function wse(h,s,u){h===1?s.version=u.readVarint():h===2?s.name=u.readString():h===3?s.units=u.readString():h===4?s.tileSize=u.readVarint():h===5?s.buffer=u.readVarint():h===6?s.pixelFormat=u.readVarint():h===7&&s.dataIndex.push(function(p,v){return p.readFields(bse,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},v)}(u,u.readVarint()+u.pos))}function Sse(h,s,u){if(h===2)(function(p,v,m){p.readFields(Ase,m,v)})(u,u.readVarint()+u.pos,s);else if(h===3)throw new Error("Not implemented")}function Ase(h,s,u){if(h===1){let p=0;const v=u.readVarint()+u.pos;for(;u.pos<v;)s[p++]=u.readVarint()}}function Tse(h,s){if(s.length!==4)throw new Error(`Expected data of dimension 4 but got ${s.length}.`);let u=s[3];for(let p=2;p>=1;p--){const v=p===1?1:0,m=p===2?1:0;for(let _=0;_<s[0];_++){const C=s[1]*_;for(let O=v;O<s[1];O++){const B=s[2]*(O+C);for(let j=m;j<s[2];j++){const R=s[3]*(j+B);for(let F=0;F<s[3];F++){const M=R+F;h[M]+=h[M-u]}}}}u*=s[p]}return h}function Pse(h){for(let s=0,u=h.length;s<u;s++)h[s]=h[s]>>>1^-(1&h[s]);return h}function Nse(h,s){switch(s){case"uint32":return h;case"uint16":for(let u=0;u<h.length;u+=2){const p=h[u],v=h[u+1];h[u]=(240&p)>>4|(61440&p)>>8|(240&v)<<4|61440&v,h[u+1]=15&p|(3840&p)>>4|(15&v)<<8|(3840&v)<<4}return h;case"uint8":for(let u=0;u<h.length;u+=4){const p=h[u],v=h[u+1],m=h[u+2],_=h[u+3];h[u+0]=(192&p)>>6|(192&v)>>4|(192&m)>>2|192&_,h[u+1]=(48&p)>>4|(48&v)>>2|48&m|(48&_)<<2,h[u+2]=(12&p)>>2|12&v|(12&m)<<2|(12&_)<<4,h[u+3]=3&p|(3&v)<<2|(3&m)<<4|(3&_)<<6}return h;default:throw new Error(`Invalid pixel format, "${s}"`)}}gr(wS,"DEMData"),gr(DF,"DemMinMaxQuadTree",{omit:["dem"]});var wu=Uint8Array,Ab=Uint16Array,jse=Int32Array,zF=new wu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),FF=new wu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Cse=new wu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BF=function(h,s){for(var u=new Ab(31),p=0;p<31;++p)u[p]=s+=1<<h[p-1];var v=new jse(u[30]);for(p=1;p<30;++p)for(var m=u[p];m<u[p+1];++m)v[m]=m-u[p]<<5|p;return{b:u,r:v}},VF=BF(zF,2),UF=VF.b,kse=VF.r;UF[28]=258,kse[258]=28;for(var Ese=BF(FF,0).b,$F=new Ab(32768),ss=0;ss<32768;++ss){var Gv=(43690&ss)>>1|(21845&ss)<<1;$F[ss]=((65280&(Gv=(61680&(Gv=(52428&Gv)>>2|(13107&Gv)<<2))>>4|(3855&Gv)<<4))>>8|(255&Gv)<<8)>>1}var Tb=function(h,s,u){for(var p=h.length,v=0,m=new Ab(s);v<p;++v)h[v]&&++m[h[v]-1];var _,C=new Ab(s);for(v=1;v<s;++v)C[v]=C[v-1]+m[v-1]<<1;_=new Ab(1<<s);var O=15-s;for(v=0;v<p;++v)if(h[v])for(var B=v<<4|h[v],j=s-h[v],R=C[h[v]-1]++<<j,F=R|(1<<j)-1;R<=F;++R)_[$F[R]>>O]=B;return _},Pb=new wu(288);for(ss=0;ss<144;++ss)Pb[ss]=8;for(ss=144;ss<256;++ss)Pb[ss]=9;for(ss=256;ss<280;++ss)Pb[ss]=7;for(ss=280;ss<288;++ss)Pb[ss]=8;var qF=new wu(32);for(ss=0;ss<32;++ss)qF[ss]=5;var Mse=Tb(Pb,9),Ose=Tb(qF,5),jj=function(h){for(var s=h[0],u=1;u<h.length;++u)h[u]>s&&(s=h[u]);return s},Nh=function(h,s,u){var p=s/8|0;return(h[p]|h[p+1]<<8)>>(7&s)&u},Cj=function(h,s){var u=s/8|0;return(h[u]|h[u+1]<<8|h[u+2]<<16)>>(7&s)},Rse=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],jh=function(h,s,u){var p=new Error(s||Rse[h]);if(p.code=h,Error.captureStackTrace&&Error.captureStackTrace(p,jh),!u)throw p;return p},Ise=new wu(0),Dse=typeof TextDecoder<"u"&&new TextDecoder;try{Dse.decode(Ise,{stream:!0})}catch{}const Lse={gzip_data:"gzip"};class _d extends Error{constructor(s){super(s),this.name="MRTError"}}const zse={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},GF={uint32:1,uint16:2,uint8:4},Fse={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let kj;class Ej{constructor(s=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=s}getLayer(s){const u=this.layers[s];if(!u)throw new _d(`Layer '${s}' not found`);return u}getHeaderLength(s){const u=new Uint8Array(s),p=new DataView(s);if(u[0]!==13)throw new _d("File is not a valid MRT.");return p.getUint32(1,!0)}parseHeader(s){const u=new Uint8Array(s),p=this.getHeaderLength(s);if(u.length<p)throw new _d(`Expected header with length >= ${p} but got buffer of length ${u.length}`);const v=function(m,_){return m.readFields(yse,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new kj(u.subarray(0,p)));if(!isNaN(this.x)&&(this.x!==v.x||this.y!==v.y||this.z!==v.z))throw new _d(`Invalid attempt to parse header ${v.z}/${v.x}/${v.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=v.x,this.y=v.y,this.z=v.z;for(const m of v.layers)this.layers[m.name]=new Bse(m,{cacheSize:this._cacheSize});return this}createDecodingTask(s){const u=[],p=this.getLayer(s.layerName);for(let v of s.blockIndices){const m=p.dataIndex[v],_=m.firstByte-s.firstByte,C=m.lastByte-s.firstByte;if(p._blocksInProgress.has(v))continue;const O={layerName:p.name,firstByte:_,lastByte:C,pixelFormat:p.pixelFormat,blockIndex:v,blockShape:[m.bands.length].concat(p.bandShape),buffer:p.buffer,codec:m.codec.codec,filters:m.filters.map(B=>B.filter)};p._blocksInProgress.add(v),u.push(O)}return new WF(u,()=>{u.forEach(v=>p._blocksInProgress.delete(v.blockIndex))},(v,m)=>{if(u.forEach(_=>p._blocksInProgress.delete(_.blockIndex)),v)throw v;m.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class Bse{constructor({version:s,name:u,units:p,tileSize:v,pixelFormat:m,buffer:_,dataIndex:C},O){if(this.version=s,this.version!==1)throw new _d(`Cannot parse raster layer encoded with MRT version ${s}`);this.name=u,this.units=p,this.tileSize=v,this.buffer=_,this.pixelFormat=zse[m],this.dataIndex=C,this.bandShape=[v+2*_,v+2*_,GF[this.pixelFormat]],this._decodedBlocks=new Pj(O?O.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return GF[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:s})=>s).flat()}processDecodedData(s){const u=s.blockIndex.toString();this._decodedBlocks.get(u)||this._decodedBlocks.put(u,s.data)}getBlockForBand(s){let u=0;switch(typeof s){case"string":for(const[p,v]of this.dataIndex.entries()){for(const[m,_]of v.bands.entries())if(_===s)return{bandIndex:u+m,blockIndex:p,blockBandIndex:m};u+=v.bands.length}break;case"number":for(const[p,v]of this.dataIndex.entries()){if(s>=u&&s<u+v.bands.length)return{bandIndex:s,blockIndex:p,blockBandIndex:s-u};u+=v.bands.length}break;default:throw new _d(`Invalid band \`${JSON.stringify(s)}\`. Expected string or integer.`)}throw new _d(`Band not found: ${JSON.stringify(s)}`)}getDataRange(s){let u=1/0,p=-1/0;const v=[],m=new Set;for(const _ of s){const{blockIndex:C}=this.getBlockForBand(_);if(C<0)throw new _d(`Invalid band: ${JSON.stringify(_)}`);const O=this.dataIndex[C];v.includes(C)||v.push(C),m.add(C),u=Math.min(u,O.firstByte),p=Math.max(p,O.lastByte)}if(m.size>this.cacheSize)throw new _d(`Number of blocks to decode (${m.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:u,lastByte:p,blockIndices:v}}hasBand(s){const{blockIndex:u}=this.getBlockForBand(s);return u>=0}hasDataForBand(s){const{blockIndex:u}=this.getBlockForBand(s);return u>=0&&!!this._decodedBlocks.get(u.toString())}getBandView(s){const{blockIndex:u,blockBandIndex:p}=this.getBlockForBand(s),v=this._decodedBlocks.get(u.toString());if(!v)throw new _d(`Data for band ${JSON.stringify(s)} of layer "${this.name}" not decoded.`);const m=this.dataIndex[u],_=this.bandShape.reduce((B,j)=>B*j,1),C=p*_,O=v.subarray(C,C+_);return{data:O,bytes:new Uint8Array(O.buffer).subarray(O.byteOffset,O.byteOffset+O.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:m.offset,scale:m.scale}}}Ej.setPbf=function(h){kj=h};class WF{constructor(s,u,p){this.tasks=s,this._onCancel=u,this._onComplete=p,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(s,u){this._finalized||(this._onComplete(s,u),this._finalized=!0)}}Ej.performDecoding=function(h,s){const u=new Uint8Array(h);return Promise.all(s.tasks.map(p=>{const{layerName:v,firstByte:m,lastByte:_,pixelFormat:C,blockShape:O,blockIndex:B,filters:j,codec:R}=p,F=u.subarray(m,_+1),M=new Uint32Array(O[0]*O[1]*O[2]);let I;if(R!=="gzip_data")throw new _d(`Unhandled codec: ${R}`);return I=function(q,X){if(!globalThis.DecompressionStream&&X==="gzip_data")return Promise.resolve(((ie=function(Se){Se[0]==31&&Se[1]==139&&Se[2]==8||jh(6,"invalid gzip data");var Le=Se[3],Ie=10;4&Le&&(Ie+=2+(Se[10]|Se[11]<<8));for(var Me=(Le>>3&1)+(Le>>4&1);Me>0;Me-=!Se[Ie++]);return Ie+(2&Le)}(ue=q))+8>ue.length&&jh(6,"invalid gzip data"),function(Se,Le,Ie,Me){var et=Se.length;if(!et||Le.f&&!Le.l)return Ie||new wu(0);var Be=!Ie,rt=Be||Le.i!=2,st=Le.i;Be&&(Ie=new wu(3*et));var nt,ct,ht=function(jg){var s0=Ie.length;if(jg>s0){var kb=new wu(Math.max(2*s0,jg));kb.set(Ie),Ie=kb}},vt=Le.f||0,ut=Le.p||0,It=Le.b||0,Wt=Le.l,Rt=Le.d,mr=Le.m,dr=Le.n,tr=8*et;do{if(!Wt){vt=Nh(Se,ut,1);var Ht=Nh(Se,ut+1,3);if(ut+=3,!Ht){var kr=Se[(un=4+((ut+7)/8|0))-4]|Se[un-3]<<8,vr=un+kr;if(vr>et){st&&jh(0);break}rt&&ht(It+kr),Ie.set(Se.subarray(un,vr),It),Le.b=It+=kr,Le.p=ut=8*vr,Le.f=vt;continue}if(Ht==1)Wt=Mse,Rt=Ose,mr=9,dr=5;else if(Ht==2){var br=Nh(Se,ut,31)+257,en=Nh(Se,ut+10,15)+4,mn=br+Nh(Se,ut+5,31)+1;ut+=14;for(var _n=new wu(mn),bn=new wu(19),Ln=0;Ln<en;++Ln)bn[Cse[Ln]]=Nh(Se,ut+3*Ln,7);ut+=3*en;var Bn=jj(bn),Li=(1<<Bn)-1,Pi=Tb(bn,Bn);for(Ln=0;Ln<mn;){var un,xi=Pi[Nh(Se,ut,Li)];if(ut+=15&xi,(un=xi>>4)<16)_n[Ln++]=un;else{var Si=0,Yi=0;for(un==16?(Yi=3+Nh(Se,ut,3),ut+=2,Si=_n[Ln-1]):un==17?(Yi=3+Nh(Se,ut,7),ut+=3):un==18&&(Yi=11+Nh(Se,ut,127),ut+=7);Yi--;)_n[Ln++]=Si}}var Da=_n.subarray(0,br),os=_n.subarray(br);mr=jj(Da),dr=jj(os),Wt=Tb(Da,mr),Rt=Tb(os,dr)}else jh(1);if(ut>tr){st&&jh(0);break}}rt&&ht(It+131072);for(var La=(1<<mr)-1,Aa=(1<<dr)-1,Ga=ut;;Ga=ut){var Ss=(Si=Wt[Cj(Se,ut)&La])>>4;if((ut+=15&Si)>tr){st&&jh(0);break}if(Si||jh(2),Ss<256)Ie[It++]=Ss;else{if(Ss==256){Ga=ut,Wt=null;break}var Lo=Ss-254;Ss>264&&(Lo=Nh(Se,ut,(1<<(kh=zF[Ln=Ss-257]))-1)+UF[Ln],ut+=kh);var Hi=Rt[Cj(Se,ut)&Aa],hc=Hi>>4;if(Hi||jh(3),ut+=15&Hi,os=Ese[hc],hc>3){var kh=FF[hc];os+=Cj(Se,ut)&(1<<kh)-1,ut+=kh}if(ut>tr){st&&jh(0);break}rt&&ht(It+131072);var bd=It+Lo;if(It<os){var wd=0-os,a0=Math.min(os,bd);for(wd+It<0&&jh(3);It<a0;++It)Ie[It]=(void 0)[wd+It]}for(;It<bd;++It)Ie[It]=Ie[It-os]}}Le.l=Wt,Le.p=Ga,Le.b=It,Le.f=vt,Wt&&(vt=1,Le.m=mr,Le.d=Rt,Le.n=dr)}while(!vt);return It!=Ie.length&&Be?(nt=Ie,((ct=It)==null||ct>nt.length)&&(ct=nt.length),new wu(nt.subarray(0,ct))):Ie.subarray(0,It)}(ue.subarray(ie,-8),{i:2},new wu(((te=ue)[(le=te.length)-4]|te[le-3]<<8|te[le-2]<<16|te[le-1]<<24)>>>0))));var te,le,ue,ie;const fe=Lse[X];if(!fe)throw new Error(`Unhandled codec: ${X}`);const ye=new globalThis.DecompressionStream(fe);return new Response(new Blob([q]).stream().pipeThrough(ye)).arrayBuffer().then(Se=>new Uint8Array(Se))}(F,R).then(q=>(function(X,te){X.readFields(Sse,te)}(new kj(q),M),new Fse[C](M.buffer))),I.then(q=>{for(let X=j.length-1;X>=0;X--)switch(j[X]){case"delta_filter":Tse(q,O);break;case"zigzag_filter":Pse(q);break;case"bitshuffle_filter":Nse(q,C);break;default:throw new _d(`Unhandled filter "${j[X]}"`)}return{layerName:v,blockIndex:B,data:q}}).catch(q=>{throw q})}))},gr(WF,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let Nb,Mj,Ch,Wv,Oj,Hv=null;function HF(){return Zs()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Mj||$i.DRACO_URL}function KF(){if(Zs()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Wv)return Wv;const h=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Wv=WebAssembly.validate(h)?$i.MESHOPT_SIMD_URL:$i.MESHOPT_URL,Wv}const SS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Vse={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},jb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function ZF(h,s,u){const p=u.json.bufferViews.length,v=u.buffers.length;s.bufferView=p,u.json.bufferViews[p]={buffer:v,byteLength:h.byteLength},u.buffers[v]=h}const Rj="KHR_draco_mesh_compression";function Use(h,s){const u=h.extensions&&h.extensions[Rj];if(!u)return;const p=new Ch.Decoder,v=QF(s,u.bufferView),m=new Ch.Mesh;if(!p.DecodeArrayToMesh(v,v.byteLength,m))throw new Error("Failed to decode Draco mesh");const _=s.json.accessors[h.indices],C=SS[_.componentType],O=_.count*C.BYTES_PER_ELEMENT,B=Ch._malloc(O);C===Uint16Array?p.GetTrianglesUInt16Array(m,O,B):p.GetTrianglesUInt32Array(m,O,B),ZF(Ch.memory.buffer.slice(B,B+O),_,s),Ch._free(B);for(const j of Object.keys(u.attributes)){const R=p.GetAttributeByUniqueId(m,u.attributes[j]),F=s.json.accessors[h.attributes[j]],M=Vse[F.componentType],I=F.count*jb[F.type]*SS[F.componentType].BYTES_PER_ELEMENT,q=Ch._malloc(I);p.GetAttributeDataArrayForAllPoints(m,R,Ch[M],I,q),ZF(Ch.memory.buffer.slice(q,q+I),F,s),Ch._free(q)}p.destroy(),m.destroy(),delete h.extensions[Rj]}const AS="EXT_meshopt_compression";function $se(h,s){if(!h.extensions||!h.extensions[AS])return;const u=h.extensions[AS],p=new Uint8Array(s.buffers[u.buffer],u.byteOffset||0,u.byteLength||0),v=new Uint8Array(u.count*u.byteStride);Oj.decodeGltfBuffer(v,u.count,u.byteStride,p,u.mode,u.filter),h.buffer=s.buffers.length,h.byteOffset=0,s.buffers[h.buffer]=v.buffer,delete h.extensions[AS]}const YF=1179937895,XF=new TextDecoder("utf8");function JF(h,s){return new URL(h,s).href}function qse(h,s,u,p){return fetch(JF(h.uri,p)).then(v=>v.arrayBuffer()).then(v=>{s.buffers[u]=v})}function QF(h,s){const u=h.json.bufferViews[s];return new Uint8Array(h.buffers[u.buffer],u.byteOffset||0,u.byteLength)}function Gse(h,s,u,p){if(h.uri){const v=JF(h.uri,p);return fetch(v).then(m=>m.blob()).then(m=>createImageBitmap(m)).then(m=>{s.images[u]=m})}if(h.bufferView!==void 0){const v=QF(s,h.bufferView),m=new Blob([v],{type:h.mimeType});return createImageBitmap(m).then(_=>{s.images[u]=_})}}function eB(h,s=0,u){const p={json:null,images:[],buffers:[]};if(new Uint32Array(h,s,1)[0]===YF){const j=new Uint32Array(h,s);let R=2;const F=(j[R++]>>2)-3,M=j[R++]>>2;if(R++,p.json=JSON.parse(XF.decode(j.subarray(R,R+M))),R+=M,R<F){const I=j[R++];R++;const q=s+(R<<2);p.buffers[0]=h.slice(q,q+I)}}else p.json=JSON.parse(XF.decode(new Uint8Array(h,s)));const{buffers:v,images:m,meshes:_,extensionsUsed:C,bufferViews:O}=p.json;let B=Promise.resolve();if(v){const j=[];for(let R=0;R<v.length;R++){const F=v[R];F.uri?j.push(qse(F,p,R,u)):p.buffers[R]||(p.buffers[R]=null)}B=Promise.all(j)}return B.then(()=>{const j=[],R=C&&C.includes(Rj),F=C&&C.includes(AS);if(R&&j.push(function(){if(!Ch)return Nb??(Nb=function(M){let I,q=null;function X(){I=new Uint8Array(q.buffer)}function te(){throw new Error("Unexpected Draco error.")}const le={a:{a:te,d:function(ue,ie,fe){return I.copyWithin(ue,ie,ie+fe)},c:function(ue){const ie=I.length,fe=Math.max(ue>>>0,Math.ceil(1.2*ie)),ye=Math.ceil((fe-ie)/65536);try{return q.grow(ye),X(),!0}catch{return!1}},b:te}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(M,le):M.then(ue=>ue.arrayBuffer()).then(ue=>WebAssembly.instantiate(ue,le))).then(ue=>{const{Rb:ie,Qb:fe,P:ye,T:Se,X:Le,Ja:Ie,La:Me,Qa:et,Va:Be,Wa:rt,eb:st,jb:nt,f:ct,e:ht,yb:vt,zb:ut,Ab:It,Bb:Wt,Db:Rt,Gb:mr}=ue.instance.exports;q=ht;const dr=(()=>{let tr=0,Ht=0,kr=0,vr=0;return br=>{kr&&(ie(vr),ie(tr),Ht+=kr,kr=tr=0),tr||(Ht+=128,tr=fe(Ht));const en=br.length+7&-8;let mn=tr;en>=Ht&&(kr=en,mn=vr=fe(en));for(let _n=0;_n<br.length;_n++)I[mn+_n]=br[_n];return mn}})();return X(),ct(),{memory:ht,_free:ie,_malloc:fe,Mesh:class{constructor(){this.ptr=ye()}destroy(){Se(this.ptr)}},Decoder:class{constructor(){this.ptr=Ie()}destroy(){nt(this.ptr)}DecodeArrayToMesh(tr,Ht,kr){const vr=dr(tr),br=Me(this.ptr,vr,Ht,kr.ptr);return!!Le(br)}GetAttributeByUniqueId(tr,Ht){return{ptr:et(this.ptr,tr.ptr,Ht)}}GetTrianglesUInt16Array(tr,Ht,kr){Be(this.ptr,tr.ptr,Ht,kr)}GetTrianglesUInt32Array(tr,Ht,kr){rt(this.ptr,tr.ptr,Ht,kr)}GetAttributeDataArrayForAllPoints(tr,Ht,kr,vr,br){st(this.ptr,tr.ptr,Ht.ptr,kr,vr,br)}},DT_INT8:vt(),DT_UINT8:ut(),DT_INT16:It(),DT_UINT16:Wt(),DT_UINT32:Rt(),DT_FLOAT32:mr()}})}(fetch(HF())),Nb.then(M=>{Ch=M,Nb=void 0}))}()),F&&j.push(function(){if(Oj)return;const M=function(I){let q;const X=WebAssembly.instantiateStreaming(I,{}).then(ue=>{q=ue.instance,q.exports.__wasm_call_ctors()}),te={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},le={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:X,supported:!0,decodeGltfBuffer(ue,ie,fe,ye,Se,Le){(function(Ie,Me,et,Be,rt,st,nt){const ct=Ie.exports.sbrk,ht=Be+3&-4,vt=ct(ht*rt),ut=ct(st.length),It=new Uint8Array(Ie.exports.memory.buffer);It.set(st,ut);const Wt=Me(vt,Be,rt,ut,st.length);if(Wt===0&&nt&&nt(vt,ht,rt),et.set(It.subarray(vt,vt+Be*rt)),ct(vt-ct(0)),Wt!==0)throw new Error(`Malformed buffer data: ${Wt}`)})(q,q.exports[le[Se]],ue,ie,fe,ye,q.exports[te[Le]])}}}(fetch(KF()));return M.ready.then(()=>{Oj=M})}()),m)for(let M=0;M<m.length;M++)j.push(Gse(m[M],p,M,u));return(j.length?Promise.all(j):Promise.resolve()).then(()=>{if(R&&_)for(const{primitives:M}of _)for(const I of M)Use(I,p);if(F&&_&&O)for(const M of O)$se(M,p);return p})})}function i0(h,s){const u=h.json.bufferViews[s.bufferView],p=SS[s.componentType];return new p(h.buffers[u.buffer],(s.byteOffset||0)+(u.byteOffset||0),s.count*(u.byteStride&&u.byteStride!==jb[s.type]*p.BYTES_PER_ELEMENT?u.byteStride/p.BYTES_PER_ELEMENT:jb[s.type]))}function Ij(h,s,u,p){const v=SS[s.componentType],m=function(j){switch(j){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(v),_=h.json.bufferViews[s.bufferView],C=_.byteStride?_.byteStride/v.BYTES_PER_ELEMENT:jb[s.type],O=u.float32,B=O.length/u.capacity;for(let j=0,R=0;j<s.count*C;j+=C,R+=B)for(let F=0;F<B;F++)O[R+F]=p[j+F]*m;u._trim()}function Wse(h,s,u){const p=h.indices,v=h.attributes,m={};m.indexArray=new _s;const _=s.json.accessors[p],C=_.count/3;m.indexArray.reserve(C);const O=i0(s,_);for(let F=0;F<C;F++)m.indexArray.emplaceBack(O[3*F],O[3*F+1],O[3*F+2]);m.indexArray._trim(),m.vertexArray=new Qo;const B=s.json.accessors[v.POSITION];m.vertexArray.reserve(B.count);const j=i0(s,B);for(let F=0;F<B.count;F++)m.vertexArray.emplaceBack(j[3*F],j[3*F+1],j[3*F+2]);if(m.vertexArray._trim(),m.aabb=new Sr(B.min,B.max),m.centroid=function(F,M){const I=[0,0,0],q=F.length;if(q>0){for(let X=0;X<q;X++){const te=3*F[X];I[0]+=M[te],I[1]+=M[te+1],I[2]+=M[te+2]}I[0]/=q,I[1]/=q,I[2]/=q}return I}(O,j),v.COLOR_0!==void 0){const F=s.json.accessors[v.COLOR_0],M=jb[F.type],I=i0(s,F);m.colorArray=M===3?new Qo:new mu,m.colorArray.resize(F.count),Ij(s,F,m.colorArray,I)}if(v.NORMAL!==void 0){m.normalArray=new Qo;const F=s.json.accessors[v.NORMAL];m.normalArray.resize(F.count);const M=i0(s,F);Ij(s,F,m.normalArray,M)}if(v.TEXCOORD_0!==void 0&&u.length>0){m.texcoordArray=new gh;const F=s.json.accessors[v.TEXCOORD_0];m.texcoordArray.resize(F.count);const M=i0(s,F);Ij(s,F,m.texcoordArray,M)}if(v._FEATURE_ID_RGBA4444!==void 0){const F=s.json.accessors[v._FEATURE_ID_RGBA4444];s.json.extensionsUsed&&s.json.extensionsUsed.includes("EXT_meshopt_compression")&&(m.featureData=i0(s,F))}v._FEATURE_RGBA4444!==void 0&&(m.featureData=new Uint32Array(i0(s,s.json.accessors[v._FEATURE_RGBA4444]).buffer));const R=h.material;return m.material=function(F,M){const{emissiveFactor:I=[0,0,0],alphaMode:q="OPAQUE",alphaCutoff:X=.5,normalTexture:te,occlusionTexture:le,emissiveTexture:ue,doubleSided:ie}=F,{baseColorFactor:fe=[1,1,1,1],metallicFactor:ye=1,roughnessFactor:Se=1,baseColorTexture:Le,metallicRoughnessTexture:Ie}=F.pbrMetallicRoughness||{},Me=le?M[le.index]:void 0;if(le&&le.extensions&&le.extensions.KHR_texture_transform&&Me){const et=le.extensions.KHR_texture_transform;Me.offsetScale=[et.offset[0],et.offset[1],et.scale[0],et.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Qn(...fe),metallicFactor:ye,roughnessFactor:Se,baseColorTexture:Le?M[Le.index]:void 0,metallicRoughnessTexture:Ie?M[Ie.index]:void 0},doubleSided:ie,emissiveFactor:I,alphaMode:q,alphaCutoff:X,normalTexture:te?M[te.index]:void 0,occlusionTexture:Me,emissionTexture:ue?M[ue.index]:void 0,defined:F.defined===void 0}}(R!==void 0?s.json.materials[R]:{defined:!1},u),m}function tB(h,s,u){const{matrix:p,rotation:v,translation:m,scale:_,mesh:C,extras:O,children:B}=h,j={};if(j.matrix=p||De.mat4.fromRotationTranslationScale([],v||[0,0,0,1],m||[0,0,0],_||[1,1,1]),C!==void 0){j.meshes=u[C];const R=j.anchor=[0,0];for(const F of j.meshes){const{min:M,max:I}=F.aabb;R[0]+=M[0]+I[0],R[1]+=M[1]+I[1]}R[0]=Math.floor(R[0]/j.meshes.length/2),R[1]=Math.floor(R[1]/j.meshes.length/2)}if(O&&(O.id&&(j.id=O.id),O.lights&&(j.lights=function(R){if(!R.length)return[];const F=function(te){const le=atob(te),ue=new Uint8Array(le.length);for(let ie=0;ie<le.length;ie++)ue[ie]=le.codePointAt(ie);return ue}(R),M=[],I=F.length/24,q=new Uint16Array(F.buffer),X=new Float32Array(F.buffer);for(let te=0;te<I;te++){const le=q[2*te*6]/30,ue=q[2*te*6+1]/30,ie=q[2*te*6+10]/100,fe=X[6*te+1],ye=X[6*te+2],Se=X[6*te+3],Le=X[6*te+4],Ie=Se-fe,Me=Le-ye,et=Math.hypot(Ie,Me);M.push({pos:[fe+.5*Ie,ye+.5*Me,ue],normal:[Me/et,-Ie/et,0],width:et,height:le,depth:ie,points:[fe,ye,Se,Le]})}return M}(O.lights))),B){const R=[];for(const F of B)R.push(tB(s.json.nodes[F],s,u));j.children=R}return j}function Hse(h){if(h.vertices.length===0||h.indices.length===0)return null;const s=new Ir(h.vertices,h.indices,8,256),[u,p]=[s.min.clone(),s.max.clone()];return{vertices:h.vertices,indices:h.indices,grid:s,min:u,max:p}}function Kse(h){if(!h.extras||!h.extras.ground)return null;const s=h.extras.ground;if(!s||!Array.isArray(s)||s.length===0)return null;const u=s[0];if(!u||!Array.isArray(u)||u.length===0)return null;const p=[];for(const _ of u){if(!Array.isArray(_)||_.length!==2)continue;const C=_[0],O=_[1];typeof C=="number"&&typeof O=="number"&&p.push(new At(C,O))}if(p.length<3)return null;p.length>1&&p[p.length-1].equals(p[0])&&p.pop();let v=0;for(let _=0;_<p.length;_++){const C=p[_],O=p[(_+1)%p.length],B=p[(_+2)%p.length];v+=(C.x-O.x)*(B.y-O.y)-(B.x-O.x)*(C.y-O.y)}v>0&&p.reverse();const m=_g(p.flatMap(_=>[_.x,_.y]),[]);return m.length===0?null:{vertices:p,indices:m}}function Zse(h,s){const u=[],p=[];let v=0;const m=[];for(const _ of h){v=u.length;const C=_.vertexArray.float32,O=_.indexArray.uint16;for(let B=0;B<_.vertexArray.length;B++)m[0]=C[3*B+0],m[1]=C[3*B+1],m[2]=C[3*B+2],De.vec3.transformMat4(m,m,s),u.push(new At(m[0],m[1]));for(let B=0;B<3*_.indexArray.length;B++)p.push(O[B]+v)}if(p.length%3!=0)return null;for(let _=0;_<p.length;_+=3){const C=u[p[_+0]],O=u[p[_+1]],B=u[p[_+2]];(C.x-O.x)*(B.y-O.y)-(B.x-O.x)*(C.y-O.y)>0&&([p[_+1],p[_+2]]=[p[_+2],p[_+1]])}return{vertices:u,indices:p}}function rB(h){const s=function(O,B){const j=[],R=WebGL2RenderingContext;if(O.json.textures)for(const F of O.json.textures){const M={magFilter:R.LINEAR,minFilter:R.NEAREST,wrapS:R.REPEAT,wrapT:R.REPEAT};F.sampler!==void 0&&Object.assign(M,O.json.samplers[F.sampler]),j.push({image:B[F.source],sampler:M,uploaded:!1})}return j}(h,h.images),u=function(O,B){const j=[];for(const R of O.json.meshes){const F=[];for(const M of R.primitives)F.push(Wse(M,O,B));j.push(F)}return j}(h,s),{scenes:p,scene:v,nodes:m}=h.json,_=p?p[v||0].nodes:m,C=[];for(const O of _)C.push(tB(m[O],h,u));return function(O,B,j){const R={},F=new Set;for(let M=0;M<O.length;M++){const I=j[B[M]];if(!I.extras)continue;const q=I.extras["mapbox:footprint:version"],X=I.extras["mapbox:footprint:id"];(q||X)&&F.add(M),q==="1.0.0"&&X&&(R[X]=M)}for(let M=0;M<O.length;M++){if(F.has(M))continue;const I=O[M],q=j[B[M]];if(!q.extras)continue;let X=null;I.id in R&&(X=Zse(O[R[I.id]].meshes,I.matrix)),X||(X=Kse(q)),X&&(I.footprint=Hse(X))}if(F.size>0){const M=Array.from(F.values()).sort((I,q)=>I-q);for(let I=M.length-1;I>=0;I--)O.splice(M[I],1)}}(C,_,h.json.nodes),C}function Yse(h){h.heightmap=new Float32Array(4096),h.heightmap.fill(-1);const s=h.vertexArray.float32,u=h.aabb.min[0]-1,p=h.aabb.min[1]-1,v=t0/(h.aabb.max[0]-u+2),m=t0/(h.aabb.max[1]-p+2);for(let _=0;_<s.length;_+=3){const C=s[_+2],O=(s[_+0]-u)*v|0,B=(s[_+1]-p)*m|0;C>h.heightmap[B*t0+O]&&(h.heightmap[B*t0+O]=C)}}function Xse(h,s){const u={};u.indexArray=new _s,u.indexArray.reserve(4*h.length),u.vertexArray=new Qo,u.vertexArray.reserve(10*h.length),u.colorArray=new mu,u.vertexArray.reserve(10*h.length);let p=0;for(const _ of h){const C=Math.min(10,Math.max(4,1.3*_.height))*s,O=[-_.normal[1],_.normal[0],0],B=Math.min(.29,.1*_.width/_.depth),j=_.width-2*_.depth*s*(B+.01),R=De.vec3.scaleAndAdd([],_.pos,O,j/2),F=De.vec3.scaleAndAdd([],_.pos,O,-j/2),M=[R[0],R[1],R[2]+_.height],I=[F[0],F[1],F[2]+_.height],q=De.vec3.scaleAndAdd([],_.normal,O,B);De.vec3.scale(q,q,C);const X=De.vec3.scaleAndAdd([],_.normal,O,-B);De.vec3.scale(X,X,C),De.vec3.add(q,R,q),De.vec3.add(X,F,X),R[2]+=.1,F[2]+=.1,u.vertexArray.emplaceBack(q[0],q[1],q[2]),u.vertexArray.emplaceBack(X[0],X[1],X[2]),u.vertexArray.emplaceBack(R[0],R[1],R[2]),u.vertexArray.emplaceBack(F[0],F[1],F[2]),u.vertexArray.emplaceBack(M[0],M[1],M[2]),u.vertexArray.emplaceBack(I[0],I[1],I[2]),u.vertexArray.emplaceBack(R[0],R[1],R[2]),u.vertexArray.emplaceBack(F[0],F[1],F[2]),u.vertexArray.emplaceBack(q[0],q[1],q[2]),u.vertexArray.emplaceBack(X[0],X[1],X[2]);const te=j/C/2;u.colorArray.emplaceBack(-te-B,-1,te,.8),u.colorArray.emplaceBack(te+B,-1,te,.8),u.colorArray.emplaceBack(-te,0,te,1.3),u.colorArray.emplaceBack(te,0,te,1.3),u.colorArray.emplaceBack(te+B,-.8,te,.7),u.colorArray.emplaceBack(te+B,-.8,te,.7),u.colorArray.emplaceBack(0,0,te,1.3),u.colorArray.emplaceBack(0,0,te,1.3),u.colorArray.emplaceBack(te+B,-1.2,te,.8),u.colorArray.emplaceBack(te+B,-1.2,te,.8),u.indexArray.emplaceBack(6+p,4+p,8+p),u.indexArray.emplaceBack(7+p,9+p,5+p),u.indexArray.emplaceBack(0+p,1+p,2+p),u.indexArray.emplaceBack(1+p,3+p,2+p),p+=10}const v={defined:!0,emissiveFactor:[0,0,0]},m={};return m.baseColorFactor=Qn.white,v.pbrMetallicRoughness=m,u.material=v,u.aabb=new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),u}class nB{constructor(s){this._stringToNumber={},this._numberToString=[];for(let u=0;u<s.length;u++){const p=s[u];this._stringToNumber[p]=u,this._numberToString[u]=p}}encode(s){return this._stringToNumber[s]}decode(s){return this._numberToString[s]}}const Jse=["id","tile","layer","source","sourceLayer","state"];class Kv{constructor(s,u,p,v,m){this.type="Feature",this._vectorTileFeature=s,this._z=u,this._x=p,this._y=v,this.properties=s.properties,this.id=m}clone(){const s=new Kv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(s.state=Object.assign({},this.state)),this.layer&&(s.layer=Object.assign({},this.layer)),this.source&&(s.source=this.source),this.sourceLayer&&(s.sourceLayer=this.sourceLayer),s}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(s){this._geometry=s}toJSON(){const s={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const u of Jse)this[u]!==void 0&&(s[u]=this[u]);return s}}class iB{constructor(s,u){this.tileID=s,this.x=s.canonical.x,this.y=s.canonical.y,this.z=s.canonical.z,this.grid=new Rc(hr,16,0),this.featureIndexArray=new Wp,this.promoteId=u,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(s,u,p,v,m,_=0,C=0){const O=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,v,m,_);const B=this.grid;for(let j=0;j<u.length;j++){const R=u[j],F=[1/0,1/0,-1/0,-1/0];for(let M=0;M<R.length;M++){const I=R[M];F[0]=Math.min(F[0],I.x),F[1]=Math.min(F[1],I.y),F[2]=Math.max(F[2],I.x),F[3]=Math.max(F[3],I.y)}C!==0&&(F[0]-=C,F[1]-=C,F[2]+=C,F[3]+=C),F[0]<hr&&F[1]<hr&&F[2]>=0&&F[3]>=0&&B.insert(O,F[0],F[1],F[2],F[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Rv.VectorTile(new H2(this.rawTileData)).layers,this.sourceLayerCoder=new nB(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const s in this.vtLayers)this.vtFeatures[s]=[]}return this.vtLayers}query(s,u){const{tilespaceGeometry:p,transform:v,tileTransform:m,pixelPosMatrix:_,availableImages:C}=u;this.loadVTLayers(),this.serializedLayersCache.clear();const O=p.bufferedTilespaceBounds,B=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,(M,I,q,X)=>Ye(p.bufferedTilespaceGeometry,M,I,q,X));B.sort(Qse);let j=null;v.elevation&&B.length>0&&(j=Vv.create(v.elevation,this.tileID));const R={};let F;for(let M=0;M<B.length;M++){const I=B[M];if(I===F)continue;F=I;const q=this.featureIndexArray.get(I);let X=null;this.is3DTile?this.loadMatchingModelFeature(R,q,s,p,v):this.loadMatchingFeature(R,q,s,C,(te,le,ue,ie=0)=>(X||(X=Y(te,this.tileID.canonical,m)),le.queryIntersectsFeature(p,te,ue,X,this.z,v,_,j,ie)))}return R}loadMatchingFeature(s,u,p,v,m){const{featureIndex:_,bucketIndex:C,sourceLayerIndex:O,layoutVertexArrayOffset:B}=u,j=this.bucketLayerIDs[C],R=p.layers,F=Object.keys(R);if(F.length&&!function(te,le){for(let ue=0;ue<te.length;ue++)if(le.indexOf(te[ue])>=0)return!0;return!1}(F,j))return;const M=p.sourceCache,I=this.sourceLayerCoder.decode(O),q=this.vtLayers[I].feature(_),X=this.getId(q,I);for(let te=0;te<j.length;te++){const le=j[te];if(!R[le])continue;const{styleLayer:ue,targets:ie}=R[le];let fe={};X!==void 0&&(fe=M.getFeatureState(ue.sourceLayer,X));const ye=!m||m(q,ue,fe,B);if(!ye)continue;const Se=new Kv(q,this.z,this.x,this.y,X);Se.tile=this.tileID.canonical,Se.state=fe;let Le=this.serializedLayersCache.get(le);Le||(Le=ue.serialize(),Le.id=le,this.serializedLayersCache.set(le,Le)),Se.source=Le.source,Se.sourceLayer=Le["source-layer"],Se.layer=Ui({},Le),Se.layer.paint=aB(Le.paint,ue.paint,q,fe,v),Se.layer.layout=aB(Le.layout,ue.layout,q,fe,v);let Ie=!1;for(const Me of ie){this.updateFeatureProperties(Se,Me);const{filter:et}=Me;if(et){if(q.properties=Se.properties,et.needGeometry){const Be=re(q,!0);if(!et.filter(new bi(this.tileID.overscaledZ),Be,this.tileID.canonical))continue}else if(!et.filter(new bi(this.tileID.overscaledZ),q))continue}Ie=!0,Me.targetId&&this.addFeatureVariant(Se,Me)}Ie&&this.appendToResult(s,le,_,Se,ye)}}loadMatchingModelFeature(s,u,p,v,m){const _=this.bucketLayerIDs[0][0],C=p.layers;if(!C[_])return;const{styleLayer:O,targets:B}=C[_];if(O.type!=="model")return;const j=v.tile,R=u.featureIndex,F=j.getBucket(O);if(!(F&&F instanceof mS))return;const M=function(Le,Ie,Me,et){const Be=Le.getNodesInfo()[Ie];if(Be.hiddenByReplacement||!Be.node.meshes)return;let rt=Number.MAX_VALUE;const st=Be.node,nt=Me.tile,ct=et.calculatePosMatrix(nt.tileID.toUnwrapped(),et.worldSize),ht=Be.evaluatedScale;let vt=0;et.elevation&&st.elevation&&(vt=st.elevation*et.elevation.exaggeration()),De.mat4.translate(ct,ct,[(st.anchor?st.anchor[0]:0)*(ht[0]-1),(st.anchor?st.anchor[1]:0)*(ht[1]-1),vt]),De.mat4.scale(ct,ct,ht);const ut=Me.queryGeometry,It=ut.isPointQuery()?ut.screenBounds:ut.screenGeometry,Wt=function(mr){const dr=De.mat4.multiply([],ct,mr.matrix);De.mat4.multiply(dr,et.expandedFarZProjMatrix,dr);for(let tr=0;tr<mr.meshes.length;++tr){const Ht=mr.meshes[tr];if(tr===mr.lightMeshIndex)continue;const kr=nF(It,et,dr,Ht.aabb);kr!=null&&(rt=Math.min(kr,rt))}if(mr.children)for(const tr of mr.children)Wt(tr)};if(Wt(st),rt===Number.MAX_VALUE)return;const Rt=new Zn(0,0);return mF(nt.tileID.canonical,Rt,Be.node.anchor[0],Be.node.anchor[1]),{intersectionZ:rt,position:Rt,feature:Be.feature}}(F,R,v,m);if(!M)return;const{z:I,x:q,y:X}=j.tileID.canonical,{feature:te,intersectionZ:le,position:ue}=M;let ie={};te.id!==void 0&&(ie=p.sourceCache.getFeatureState(O.sourceLayer,te.id));const fe=new Kv({},I,q,X,te.id);fe.tile=this.tileID.canonical,fe.state=ie,fe.properties=te.properties,fe.geometry={type:"Point",coordinates:[ue.lng,ue.lat]};let ye=this.serializedLayersCache.get(_);ye||(ye=O.serialize(),ye.id=_,this.serializedLayersCache.set(_,ye)),fe.source=ye.source,fe.sourceLayer=ye["source-layer"],fe.layer=Ui({},ye);let Se=!1;for(const Le of B){this.updateFeatureProperties(fe,Le);const{filter:Ie}=Le;if(Ie){if(te.properties=fe.properties,Ie.needGeometry){if(!Ie.filter(new bi(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!Ie.filter(new bi(this.tileID.overscaledZ),te))continue}Se=!0,Le.targetId&&this.addFeatureVariant(fe,Le)}Se&&this.appendToResult(s,_,R,fe,le)}updateFeatureProperties(s,u,p){if(u.properties){const v={};for(const m in u.properties){const _=u.properties[m].evaluate({zoom:this.z},s._vectorTileFeature,s.state,s.tile,p);_!=null&&(v[m]=_)}s.properties=v}}addFeatureVariant(s,u,p){const v={target:u.target,namespace:u.namespace,uniqueFeatureID:u.uniqueFeatureID};u.properties&&(v.properties=s.properties),s.variants=s.variants||{},s.variants[u.targetId]=s.variants[u.targetId]||[],s.variants[u.targetId].push(v)}appendToResult(s,u,p,v,m){let _=s[u];_===void 0&&(_=s[u]=[]),_.push({featureIndex:p,feature:v,intersectionZ:m})}lookupSymbolFeatures(s,u,p,v,m){const _={};this.loadVTLayers();for(const C of s)this.loadMatchingFeature(_,{bucketIndex:u,sourceLayerIndex:p,featureIndex:C,layoutVertexArrayOffset:0},v,m);return _}loadFeature(s){const{featureIndex:u,sourceLayerIndex:p}=s;this.loadVTLayers();const v=this.sourceLayerCoder.decode(p),m=this.vtFeatures[v];if(m[u])return m[u];const _=this.vtLayers[v].feature(u);return m[u]=_,_}hasLayer(s){for(const u of this.bucketLayerIDs)for(const p of u)if(s===p)return!0;return!1}getId(s,u){let p=s.id;if(this.promoteId){const v=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[u];if(v!=null)if(Array.isArray(v)){if(!this.promoteIdExpression){const m=Xo(v);if(m.result!=="success"){const _=m.value.map(C=>`${C.key}: ${C.message}`).join(", ");return void sn(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=m.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new by),p=this.promoteIdExpression.evaluate({zoom:0},s)}else p=s.properties[v];typeof p=="boolean"&&(p=Number(p))}return p}}function aB(h,s,u,p,v){return rc(h,(m,_)=>{const C=s instanceof ud?s.get(_):null;return C&&C.evaluate?C.evaluate(u,p,v):C})}function Qse(h,s){return s-h}gr(iB,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const sB=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Dj{static from(s){if(!(s instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,p]=new Uint8Array(s,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const v=p>>4;if(v!==1)throw new Error(`Got v${v} data when expected v1.`);const m=sB[15&p];if(!m)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(s,2,1),[C]=new Uint32Array(s,4,1);return new Dj(C,_,m,s)}constructor(s,u=64,p=Float64Array,v){if(isNaN(s)||s<0)throw new Error(`Unpexpected numItems value: ${s}.`);this.numItems=+s,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=p,this.IndexArrayType=s<65536?Uint16Array:Uint32Array;const m=sB.indexOf(this.ArrayType),_=2*s*this.ArrayType.BYTES_PER_ELEMENT,C=s*this.IndexArrayType.BYTES_PER_ELEMENT,O=(8-C%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${p}.`);v&&v instanceof ArrayBuffer?(this.data=v,this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+O,2*s),this._pos=2*s,this._finished=!0):(this.data=new ArrayBuffer(8+_+C+O),this.ids=new this.IndexArrayType(this.data,8,s),this.coords=new this.ArrayType(this.data,8+C+O,2*s),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=s)}add(s,u){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=s,this.coords[this._pos++]=u,p}finish(){const s=this._pos>>1;if(s!==this.numItems)throw new Error(`Added ${s} items when expected ${this.numItems}.`);return Lj(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(s,u,p,v){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:C}=this,O=[0,m.length-1,0],B=[];for(;O.length;){const j=O.pop()||0,R=O.pop()||0,F=O.pop()||0;if(R-F<=C){for(let X=F;X<=R;X++){const te=_[2*X],le=_[2*X+1];te>=s&&te<=p&&le>=u&&le<=v&&B.push(m[X])}continue}const M=F+R>>1,I=_[2*M],q=_[2*M+1];I>=s&&I<=p&&q>=u&&q<=v&&B.push(m[M]),(j===0?s<=I:u<=q)&&(O.push(F),O.push(M-1),O.push(1-j)),(j===0?p>=I:v>=q)&&(O.push(M+1),O.push(R),O.push(1-j))}return B}within(s,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:v,coords:m,nodeSize:_}=this,C=[0,v.length-1,0],O=[],B=p*p;for(;C.length;){const j=C.pop()||0,R=C.pop()||0,F=C.pop()||0;if(R-F<=_){for(let X=F;X<=R;X++)lB(m[2*X],m[2*X+1],s,u)<=B&&O.push(v[X]);continue}const M=F+R>>1,I=m[2*M],q=m[2*M+1];lB(I,q,s,u)<=B&&O.push(v[M]),(j===0?s-p<=I:u-p<=q)&&(C.push(F),C.push(M-1),C.push(1-j)),(j===0?s+p>=I:u+p>=q)&&(C.push(M+1),C.push(R),C.push(1-j))}return O}}function Lj(h,s,u,p,v,m){if(v-p<=u)return;const _=p+v>>1;oB(h,s,_,p,v,m),Lj(h,s,u,p,_-1,1-m),Lj(h,s,u,_+1,v,1-m)}function oB(h,s,u,p,v,m){for(;v>p;){if(v-p>600){const B=v-p+1,j=u-p+1,R=Math.log(B),F=.5*Math.exp(2*R/3),M=.5*Math.sqrt(R*F*(B-F)/B)*(j-B/2<0?-1:1);oB(h,s,u,Math.max(p,Math.floor(u-j*F/B+M)),Math.min(v,Math.floor(u+(B-j)*F/B+M)),m)}const _=s[2*u+m];let C=p,O=v;for(Cb(h,s,p,u),s[2*v+m]>_&&Cb(h,s,p,v);C<O;){for(Cb(h,s,C,O),C++,O--;s[2*C+m]<_;)C++;for(;s[2*O+m]>_;)O--}s[2*p+m]===_?Cb(h,s,p,O):(O++,Cb(h,s,O,v)),O<=u&&(p=O+1),u<=O&&(v=O-1)}}function Cb(h,s,u,p){zj(h,u,p),zj(s,2*u,2*p),zj(s,2*u+1,2*p+1)}function zj(h,s,u){const p=h[s];h[s]=h[u],h[u]=p}function lB(h,s,u,p){const v=h-u,m=s-p;return v*v+m*m}i.$=Fp,i.A=Ms,i.B=2,i.C=db,i.D=Uv,i.E=eu,i.F=_z,i.G=class extends fS{},i.H=Po,i.I=Nj,i.J=Wu,i.K=Dc,i.L=Fl,i.M=zl,i.N=Qi,i.O=ih,i.P=At,i.Q=lc,i.R=Rn,i.S=Ry,i.T=fj,i.U=Xo,i.V=fS,i.W=Mc,i.X=Qu,i.Y=lu,i.Z=No,i._=Wo,i.a=function(h){return $i.API_CDN_URL_REGEX.test(h)},i.a$=Kv,i.a0=Us,i.a1=ga,i.a2=function(h){const s=h.value;let u=[];if(!s)return u;const p=Po(s);return p!=="string"?(u=u.concat([new fS(h.key,s,`string expected, "${p}" found`)]),u):(aF(s,!0)||(u=u.concat([new fS(h.key,s,`invalid url "${s}"`)])),u)},i.a3=_t,i.a4=uh,i.a5=qi,i.a6=er,i.a7=class{constructor(h){this.specification=h}possiblyEvaluate(h,s){return Ua(h.expression.evaluate(s))}interpolate(h,s,u){return{x:Fr(h.x,s.x,u),y:Fr(h.y,s.y,u),z:Fr(h.z,s.z,u),azimuthal:Fr(h.azimuthal,s.azimuthal,u),polar:Fr(h.polar,s.polar,u)}}},i.a8=bi,i.a9=sh,i.aA=nl,i.aB=class{constructor(h){this.entries={},this.scheduler=h}request(h,s,u,p){const v=this.entries[h]=this.entries[h]||{callbacks:[]};if(v.result){const[m,_]=v.result;return this.scheduler?this.scheduler.add(()=>{p(m,_)},s):p(m,_),()=>{}}return v.callbacks.push(p),v.cancel||(v.cancel=u((m,_)=>{v.result=[m,_];for(const C of v.callbacks)this.scheduler?this.scheduler.add(()=>{C(m,_)},s):C(m,_);setTimeout(()=>delete this.entries[h],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(m=>m!==p),v.callbacks.length||(v.cancel(),delete this.entries[h]))}}},i.aC=Eo,i.aD=function(h,s,u){const p=JSON.stringify(h.request);return h.data&&(this.deduped.entries[p]={result:[null,h.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:h.isSymbolTile,zoom:h.tileZoom},v=>{const m=rs(h.request,(_,C,O,B)=>{_?v(_):C&&v(null,{vectorTile:u?void 0:new Rv.VectorTile(new H2(C)),rawData:C,cacheControl:O,expires:B})});return()=>{m.cancel(),v()}},s)},i.aE=function(h){Ar++,Ar>St&&(h.getActor().send("enforceCacheSizeLimit",lt),Ar=0)},i.aF=function(h){return h<=1?1:Math.pow(2,Math.floor(Math.log(h)/Math.LN2))},i.aG=Yt,i.aH=Wz,i.aI=Jz,i.aJ=Gz,i.aK=function(h,s){const u=document.createElement("video");u.muted=!0,u.onloadstart=function(){s(null,u)};for(let p=0;p<h.length;p++){const v=document.createElement("source");ho(h[p])||(u.crossOrigin="Anonymous"),v.src=h[p],u.appendChild(v)}return{cancel:()=>{}}},i.aL=lS,i.aM=function(h){return fetch(h).then(s=>s.arrayBuffer()).then(s=>eB(s,0,h))},i.aN=rB,i.aO=class{constructor(h,s,u,p){this.id=h,this.position=s!=null?new Zn(s[0],s[1]):new Zn(0,0),this.orientation=u??[0,0,0],this.nodes=p,this.uploaded=!1,this.aabb=new Sr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(h,s){if(De.mat4.multiply(h.matrix,s,h.matrix),h.meshes)for(const u of h.meshes){const p=Sr.applyTransformFast(u.aabb,h.matrix);this.aabb.encapsulate(p)}if(h.children)for(const u of h.children)this._applyTransformations(u,h.matrix)}computeBoundsAndApplyParent(){const h=De.mat4.identity([]);for(const s of this.nodes)this._applyTransformations(s,h)}computeModelMatrix(h,s,u,p,v,m,_=!1){uF(this.matrix,this,h.transform,this.position,s,u,p,v,m,_)}upload(h){if(!this.uploaded){for(const s of this.nodes)vj(s,h);for(const s of this.nodes)pS(s);this.uploaded=!0}}destroy(){for(const h of this.nodes)xj(h)}},i.aP=To,i.aQ=fb,i.aR=il,i.aS=Vr,i.aT=ua,i.aU=_s,i.aV=Va,i.aW=dg,i.aX=sS,i.aY=function(){Jo.isLoading()||Jo.isLoaded()||ch()!=="deferred"||vf()},i.aZ=zy,i.a_=re,i.aa=d,i.ab=De,i.ac=tn,i.ad=ud,i.ae=Ro,i.af=Fr,i.ag=hr,i.ah=tu,i.ai=tt,i.aj=Qn,i.ak=class{constructor(h){this.specification=h}possiblyEvaluate(h,s){return function([u,p]){const v=Ua([1,u,p]);return{x:v.x,y:v.y,z:v.z}}(h.expression.evaluate(s))}interpolate(h,s,u){return{x:Fr(h.x,s.x,u),y:Fr(h.y,s.y,u),z:Fr(h.z,s.z,u)}}},i.al=function(h,s,u=0,p=!0){const v=new At(u,u),m=h.sub(v),_=s.add(v),C=[m,new At(_.x,m.y),_,new At(m.x,_.y)];return p&&C.push(m.clone()),C},i.am=function(h,s){const u=[];for(let p=0;p<h.length;p++){const v=Gn(p-1,-1,h.length-1),m=Gn(p+1,-1,h.length-1),_=h[p],C=h[m],O=h[v].sub(_).unit(),B=C.sub(_).unit(),j=B.angleWithSep(O.x,O.y),R=O.add(B).unit().mult(-1*s/Math.sin(j/2));u.push(_.add(R))}return u},i.an=Ez,i.ao=Ye,i.ap=function(h,s,u=0){return De.vec3.fromValues(((s.x-u)*h.scale-h.x)*hr,(s.y*h.scale-h.y)*hr,bh(s.z,s.y))},i.aq=Zr,i.ar=Y5,i.as=function(h){let s=1/0,u=1/0,p=-1/0,v=-1/0;for(const m of h)s=Math.min(s,m.x),u=Math.min(u,m.y),p=Math.max(p,m.x),v=Math.max(v,m.y);return{min:new At(s,u),max:new At(p,v)}},i.at=Vc,i.au=Ge,i.av=S,i.aw=ur,i.ax=to,i.ay=function(h,s){const u={};for(let p=0;p<s.length;p++){const v=s[p];v in h&&(u[v]=h[v])}return u},i.az=_u,i.b=function(h){return $i.API_FONTS_REGEX.test(h)},i.b$=dS,i.b0=Wn,i.b1=WN,i.b2=dn,i.b3=Y,i.b4=Mo,i.b5=Sf,i.b6=Lr,i.b7=va,i.b8=_g,i.b9=uj,i.bA=j5,i.bB=ij,i.bC=Nz,i.bD=tj,i.bE=Dj,i.bF=Gn,i.bG=Pa,i.bH=Gi,i.bI=function(h,s,u){h[4*s+0]=u[0],h[4*s+1]=u[1],h[4*s+2]=u[2],h[4*s+3]=u[3]},i.bJ=Cf,i.bK=el,i.bL=Nf,i.bM=da,i.bN=Fc,i.bO=Zn,i.bP=Dz,i.bQ=zt,i.bR=Sn,i.bS=eF,i.bT=$t,i.bU=Ds,i.bV=function(h,s,u,p,v,m,_,C,O){if(O.name==="globe")return Ds(h,s,new $t(u,p,v),!1);const B=fb({z:u,x:p,y:v},O);return new Sr([(m+B.x/B.scale)*s,s*(B.y/B.scale),_],[(m+B.x2/B.scale)*s,s*(B.y2/B.scale),C])},i.bW=function(h,s,u){let p=0;for(let v=0;v<2;++v)h[v]>0&&(p+=(h[v]-0)*(h[v]-0)),s[v]<0&&(p+=(0-s[v])*(0-s[v]));return p},i.bX=ro,i.bY=Zp,i.bZ=function(h){const s=De.mat4.identity(new Float64Array(16));De.mat4.multiply(s,h.pixelMatrix,h.globeMatrix);const u=[0,tl,0],p=[0,go,0];return De.vec3.transformMat4(u,u,s),De.vec3.transformMat4(p,p,s),[u[0]>0&&u[0]<=h.width&&u[1]>0&&u[1]<=h.height&&!Tl(h,new Zn(h.center.lat,90)),p[0]>0&&p[0]<=h.width&&p[1]>0&&p[1]<=h.height&&!Tl(h,new Zn(h.center.lat,-90))]},i.b_=function(h,s){const{scale:u}=h.tileTransform,p=u*hr/(h.tileSize*Math.pow(2,s.zoom-h.tileID.overscaledZ+h.tileID.canonical.z));return De.mat2.scale(new Float32Array(4),s.inverseAdjustmentMatrix,[p,p])},i.ba=function(h,s){const u=Ro(s.zoom);if(u===0)return Ea(h);const p=Mi(h),v=Ni(p),m=Vc(p.getWest())*s.worldSize,_=Vc(p.getEast())*s.worldSize,C=nl(p.getNorth())*s.worldSize,O=nl(p.getSouth())*s.worldSize,B=[m,C,0],j=[_,C,0],R=[m,O,0],F=[_,O,0],M=De.mat4.invert([],s.globeMatrix);return De.vec3.transformMat4(B,B,M),De.vec3.transformMat4(j,j,M),De.vec3.transformMat4(R,R,M),De.vec3.transformMat4(F,F,M),v[0]=Sa(v[0],R,u),v[1]=Sa(v[1],F,u),v[2]=Sa(v[2],j,u),v[3]=Sa(v[3],B,u),Sr.fromPoints(v)},i.bb=as,i.bc=wi,i.bd=Sa,i.be=ia,i.bf=Or,i.bg=Ej,i.bh=H2,i.bi=rs,i.bj=function(h){const s=[];for(const u in h)s.push(h[u]);return s},i.bk=function(h,s){const u=[];for(const p in h)p in s||u.push(p);return u},i.bl=gi,i.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bn=qr,i.bo=function(h,s){const{x:u,y:p}=h.point,v=bs(u,p,h.worldSize/h._pixelsPerMercatorPixel,0,0);return De.mat4.multiply(v,v,ji(Ea(s)))},i.bp=Iv,i.bq=bu,i.br=W2,i.bs=function(h,s,u,p,v){const m=5*s+2;h.float32[m+0]=u,h.float32[m+1]=p,h.float32[m+2]=v},i.bt=aS,i.bu=xz,i.bv=me,i.bw=Do,i.bx=w5,i.by=iF,i.bz=N5,i.c=ms,i.c$=(h,s,u,p,v,m,_,C)=>{const O=h.transform,B=O.pitch<15?X5(.07,.7,ur((14-O.zoom)/5,0,1)):.07,j=u.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Q5(h,s,u,p),u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:O.calculatePixelsToTileUnitsMatrix(s),u_device_pixel_ratio:v,u_width_scale:m,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:J5(s,O),u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:u.paint.get("line-trim-fade-range"),u_trim_color:u.paint.get("line-trim-color").toRenderColor(j?null:u.lut).toArray01(),u_emissive_strength:u.paint.get("line-emissive-strength"),u_zbias_factor:B,u_tile_to_meter:o(s.tileID.canonical,0)}},i.c0=Qz,i.c1=function(h){const s=Qz(h,!0);return De.mat2.invert([],[s[0],s[1],s[4],s[5]])},i.c2=Dn,i.c3=function(h){const{x:s,y:u}=h.point,{lng:p,lat:v}=h._center;return bs(s,u,h.worldSize,p,v)},i.c4=xt,i.c5=nr,i.c6=yd,i.c7=function(h){const s=Math.round((h+45+360)%360/90)%4;return Mt[s]},i.c8=45,i.c9=gg,i.cA=class extends $l{constructor(h){super(h),this.current=pg}set(h,s,u){if(this.fetchUniformLocation(h,s)){for(let p=0;p<9;p++)if(u[p]!==this.current[p]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},i.cB=lr,i.cC=function(h,s,u){const p=Ro(u.zoom),v=h.style.map._antialias,m=h.terrain&&h.terrain.exaggeration()>0;return p===0&&!v&&!m},i.cD=function(h){const s=h.pixelsPerMeter,u=s/Gi(1,h.center.lat),p=De.mat4.identity(new Float64Array(16));return De.mat4.translate(p,p,[h.point.x,h.point.y,0]),De.mat4.scale(p,p,[u,u,s]),Float32Array.from(p)},i.cE=Mi,i.cF=function(h){const s=ro-5;h=ur(h,-80.051129,s)/s*90;const u=Math.pow(Math.abs(Math.sin(tt(h))),3);return Math.round(u*(Ef.length-1))},i.cG=function(h,s,u,p){const v=s.getNorth(),m=s.getSouth(),_=s.getWest(),C=s.getEast(),O=1<<h.z,B=C-_,j=v-m,R=B/xh,F=-j/Ef[u],M=[0,R,0,F,0,0,v,_,0];if(h.z>0){const I=180/p;De.mat3.multiply(M,M,[I/B+1,0,0,0,I/j+1,0,-.5*I/R,.5*I/F,1])}return M[2]=O,M[5]=h.x,M[8]=h.y,M},i.cH=Ea,i.cI=function(h,s,u){const p=De.mat4.identity(new Float64Array(16)),v=(s/(1<<h)-.5)*Math.PI*2;return De.mat4.rotateY(p,u.globeMatrix,v),Float32Array.from(p)},i.cJ=class{isDataAvailableAtPoint(h){const s=this._source();if(this.isUsingMockSource()||!s||h.y<0||h.y>1)return!1;const u=s.getSource().maxzoom,p=1<<u,v=Math.floor(h.x),m=Math.floor((h.x-v)*p),_=Math.floor(h.y*p),C=this.findDEMTileFor(new Yt(u,v,u,m,_));return!(!C||!C.dem)}getAtPointOrZero(h,s=0){return this.getAtPoint(h,s)||0}getAtPoint(h,s,u=!0){if(this.isUsingMockSource())return null;s==null&&(s=null);const p=this._source();if(!p||h.y<0||h.y>1)return s;const v=p.getSource().maxzoom,m=1<<v,_=Math.floor(h.x),C=h.x-_,O=new Yt(v,_,v,Math.floor(C*m),Math.floor(h.y*m)),B=this.findDEMTileFor(O);if(!B||!B.dem)return s;const j=B.dem,R=1<<B.tileID.canonical.z,F=(C*R-B.tileID.canonical.x)*j.dim,M=(h.y*R-B.tileID.canonical.y)*j.dim,I=Math.floor(F),q=Math.floor(M);return(u?this.exaggeration():1)*Fr(Fr(j.get(I,q),j.get(I,q+1),M-q),Fr(j.get(I+1,q),j.get(I+1,q+1),M-q),F-I)}getAtTileOffset(h,s,u){const p=1<<h.canonical.z;return this.getAtPointOrZero(new d(h.wrap+(h.canonical.x+s/hr)/p,(h.canonical.y+u/hr)/p))}getAtTileOffsetFunc(h,s,u,p){return v=>{const m=this.getAtTileOffset(h,v.x,v.y),_=p.upVector(h.canonical,v.x,v.y),C=p.upVectorScale(h.canonical,s,u).metersToTile;return De.vec3.scale(_,_,m*C),_}}getForTilePoints(h,s,u,p){if(this.isUsingMockSource())return!1;const v=Vv.create(this,h,p);return!!v&&(s.forEach(m=>{m[2]=this.exaggeration()*v.getElevationAt(m[0],m[1],u)}),!0)}getMinMaxForTile(h){if(this.isUsingMockSource())return null;const s=this.findDEMTileFor(h);if(!s||!s.dem)return null;const u=s.dem.tree,p=s.tileID,v=1<<h.canonical.z-p.canonical.z;let m=h.canonical.x/v-p.canonical.x,_=h.canonical.y/v-p.canonical.y,C=0;for(let O=0;O<h.canonical.z-p.canonical.z&&!u.leaves[C];O++){m*=2,_*=2;const B=2*Math.floor(_)+Math.floor(m);C=u.childOffsets[C]+B,m%=1,_%=1}return{min:this.exaggeration()*u.minimums[C],max:this.exaggeration()*u.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(h,s,u){throw new Error("Pure virtual method called.")}pointCoordinate(h){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(h){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const h=this.visibleDemTiles;if(h.length===0)return null;let s=!1,u=Number.MAX_VALUE,p=Number.MIN_VALUE;for(const v of h){const m=this.getMinMaxForTile(v.tileID);m&&(u=Math.min(u,m.min),p=Math.max(p,m.max),s=!0)}return s?{min:u,max:p}:null}},i.cK=Q_,i.cL=In,i.cM=function(h,s){return[Math.pow(h[0],2.2)*s,Math.pow(h[1],2.2)*s,Math.pow(h[2],2.2)*s]},i.cN=Al,i.cO=Bs,i.cP=Na,i.cQ=256,i.cR=function(h,s){const u=[0,0,0],p=as(Ea(s.canonical));return De.vec3.transformMat4(u,u,p),De.vec3.transformMat4(u,u,h),u},i.cS=h=>({u_camera_to_center_distance:new da(h),u_extrude_scale:new mo(h),u_device_pixel_ratio:new da(h),u_matrix:new Cf(h),u_inv_rot_matrix:new Cf(h),u_merc_center:new el(h),u_tile_id:new Nf(h),u_zoom_transition:new da(h),u_up_dir:new Nf(h),u_emissive_strength:new da(h)}),i.cT=h=>({u_matrix:new Cf(h),u_pixels_to_tile_units:new mo(h),u_device_pixel_ratio:new da(h),u_width_scale:new da(h),u_floor_width_scale:new da(h),u_units_to_pixels:new el(h),u_dash_image:new Fc(h),u_gradient_image:new Fc(h),u_image_height:new da(h),u_texsize:new el(h),u_tile_units_to_pixels:new da(h),u_alpha_discard_threshold:new da(h),u_trim_offset:new el(h),u_trim_fade_range:new el(h),u_trim_color:new jf(h),u_emissive_strength:new da(h),u_zbias_factor:new da(h),u_tile_to_meter:new da(h)}),i.cU=h=>({u_matrix:new Cf(h),u_texsize:new el(h),u_pixels_to_tile_units:new mo(h),u_device_pixel_ratio:new da(h),u_width_scale:new da(h),u_floor_width_scale:new da(h),u_image:new Fc(h),u_units_to_pixels:new el(h),u_tile_units_to_pixels:new da(h),u_alpha_discard_threshold:new da(h),u_trim_offset:new el(h),u_trim_fade_range:new el(h),u_trim_color:new jf(h),u_emissive_strength:new da(h),u_zbias_factor:new da(h),u_tile_to_meter:new da(h)}),i.cV=Up,i.cW=rae,i.cX=nae,i.cY=Of,i.cZ=(h,s,u,p,v,m)=>{const _=h.transform,C=_.projection.name==="globe";let O;if(m.paint.get("circle-pitch-alignment")==="map")if(C){const j=Al(_.zoom,s.canonical)*_._pixelsPerMercatorPixel;O=Float32Array.from([j,0,0,j])}else O=_.calculatePixelsToTileUnitsMatrix(u);else O=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:h.transform.getCameraToCenterDistance(_.projection),u_matrix:h.translatePosMatrix(s.projMatrix,u,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ze.devicePixelRatio,u_extrude_scale:O,u_inv_rot_matrix:Sh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:m.paint.get("circle-emissive-strength")};if(C){B.u_inv_rot_matrix=p,B.u_merc_center=v,B.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],B.u_zoom_transition=Ro(_.zoom);const j=v[0]*hr,R=v[1]*hr;B.u_up_dir=_.projection.upVector(new $t(0,0,0),j,R)}return B},i.c_=ez,i.ca=jf,i.cb=function(h,s,u){const p=Math.sqrt(h*h+s*s+u*u),v=p>0?Math.acos(u/p)*Jn:0;let m=h!==0||s!==0?Math.atan2(-s,-h)*Jn+90:0;return m<0&&(m+=360),[p,m,v]},i.cc=o,i.cd=Sr,i.ce=Ua,i.cf=function(h){return[Math.pow(h[0],1/2.2),Math.pow(h[1],1/2.2),Math.pow(h[2],1/2.2)]},i.cg=function(h,s){return h.readFields(Zae,{icons:[]},s)},i.ch=function(h){return h({pluginStatus:ko,pluginURL:wl}),Ic.on("pluginStateChange",h),h},i.ci=gS,i.cj=Lv,i.ck=rj,i.cl=gs,i.cm=Lp,i.cn=at,i.co=ml,i.cp=Fs,i.cq=function(h){const s=h.indexOf(xf);return s>=0?h.slice(0,s):h},i.cr=function(h){return h.indexOf(xf)>=0},i.cs=function(h){const s=h.indexOf(xf);return s>=0?h.slice(s+1):""},i.ct=function(h){const s=[],u=h.id;return u===void 0&&s.push({message:`layers.${u}: missing required property "id"`}),h.render===void 0&&s.push({message:`layers.${u}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&s.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),s},i.cu=function(h,s,u,p){return h.type==="custom"?new Iae(h,s):new Wae[h.type](h,s,u,p)},i.cv=kl,i.cw=class extends Kv{constructor(h,s){super(h._vectorTileFeature,h._z,h._x,h._y,h.id),h.state&&(this.state=Object.assign({},h.state)),this.target=s.target,this.namespace=s.namespace,s.properties&&(this.properties=s.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=h.source,this.sourceLayer=h.sourceLayer,this.layer=h.layer)}toJSON(){const h=super.toJSON();return h.target=this.target,h.namespace=this.namespace,h}},i.cx=Ic,i.cy=$a,i.cz=Hy,i.d=function(h){return $i.API_TILEJSON_REGEX.test(h)},i.d$=iB,i.d0=(h,s,u,p,v,m,_,C,O)=>{const B=h.transform,j=B.calculatePixelsToTileUnitsMatrix(s),R=u.paint.get("line-trim-color-use-theme").constantOr("default")==="none",F=B.pitch<15?X5(.07,.7,ur((14-B.zoom)/5,0,1)):.07;return{u_matrix:Q5(h,s,u,p),u_pixels_to_tile_units:j,u_device_pixel_ratio:m,u_width_scale:_,u_floor_width_scale:C,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:tz(u)&&s.lineAtlasTexture?s.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:J5(s,h.transform),u_alpha_discard_threshold:0,u_trim_offset:O,u_trim_fade_range:u.paint.get("line-trim-fade-range"),u_trim_color:u.paint.get("line-trim-color").toRenderColor(R?null:u.lut).toArray01(),u_emissive_strength:u.paint.get("line-emissive-strength"),u_zbias_factor:F,u_tile_to_meter:o(s.tileID.canonical,0)}},i.d1=Ks,i.d2=xg,i.d3=V5,i.d4=yr,i.d5=G2,i.d6=Sg,i.d7=450,i.d8=7,i.d9=Rae,i.dA=xr,i.dB=g,i.dC=_h,i.dD=function([h,s,u]){const p=Math.hypot(h,s,u),v=Math.atan2(h,u),m=.5*Math.PI-Math.acos(-s/p);return new Zn(xt(v),xt(m))},i.dE=mj,i.dF=function(h){const s=h.navigator?h.navigator.userAgent:null;return!!function(u){if(fa==null){const p=u.navigator?u.navigator.userAgent:null;fa=!!u.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return fa}(h)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(h,s){lt=h,St=s},i.dH=Tl,i.dI=Io,i.dJ=function(h){const s=[0,0,0],u=De.mat4.identity(new Float64Array(16));return De.mat4.multiply(u,h.pixelMatrix,h.globeMatrix),De.vec3.transformMat4(s,s,u),new At(s[0],s[1])},i.dK=function(h,s,u=!1){if(ko===lh||ko===yf||ko===tg)throw new Error("setRTLTextPlugin cannot be called multiple times.");wl=Ze.resolveURL(h),ko=lh,bl=s,Ly(),u||vf()},i.dL=ch,i.dM=function(){gS().acquire(bj)},i.dN=function(){const h=bb;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(bj),bb=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=n0,i.dP=function(h){const s=ar();if(!s)return;const u=s.delete(gt);h&&u.catch(h).then(()=>h())},i.dQ=_b,i.dR=HF,i.dS=function(h){Mj=Ze.resolveURL(h),Hv||(Hv=new Uv(gS(),new eu)),Hv.broadcast("setDracoUrl",Mj)},i.dT=KF,i.dU=function(h){Wv=Ze.resolveURL(h),Hv||(Hv=new Uv(gS(),new eu)),Hv.broadcast("setMeshoptUrl",Wv)},i.dV=gr,i.dW=xd,i.dX=Ph,i.dY=Rv,i.dZ=class{constructor(h,s){this.pos=h,this.dir=s}intersectsPlane(h,s,u){const p=De.vec2.dot(s,this.dir);if(Math.abs(p)<1e-6)return!1;const v=((h[0]-this.pos[0])*s[0]+(h[1]-this.pos[1])*s[1])/p;return u[0]=this.pos[0]+this.dir[0]*v,u[1]=this.pos[1]+this.dir[1]*v,!0}},i.d_=nB,i.da=ei,i.db=ug,i.dc=256,i.dd=ji,i.de=Qo,i.df=gu,i.dg=$p,i.dh=function(h,s,u,p,v){return ur((h-s)/(u-s)*(v-p)+p,p,v)},i.di=Ll,i.dj=Mf,i.dk=class{constructor(h,s,u,p){this.context=h,this.format=p,this.size=u,this.texture=h.gl.createTexture();const[v,m,_]=this.size,{gl:C}=h;C.bindTexture(C.TEXTURE_3D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(!1),C.texImage3D(C.TEXTURE_3D,0,this.format,v,m,_,0,dj(this.format),hj(this.format),s.data)}bind(h,s){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_3D,this.texture),h!==this.minFilter&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MAG_FILTER,h),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MIN_FILTER,h),this.minFilter=h),s!==this.wrapS&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_T,s),this.wrapS=s)}destroy(){const{gl:h}=this.context;h.deleteTexture(this.texture),this.texture=null}},i.dl=gj,i.dm=[1,1,1],i.dn=Vv,i.dp=Bv,i.dq=Rs,i.dr=gh,i.ds=vd,i.dt=fd,i.du=cc,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new At(1/0,1/0),max:new At(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(h,s=!1){const u=A5(new At(0,0),new At(hr,hr),h),p=[];if(s&&!VN(u,this._globalClipBounds))return p;for(const v of this._activeRegions){if(v.hiddenByOverlap||!VN(u,v))continue;const m=Cie(v.min,v.max,h);p.push({min:m.min,max:m.max,sourceId:this._sourceIds[v.priority],footprint:v.footprint,footprintTileId:v.tileId,order:v.order,clipMask:v.clipMask,clipScope:v.clipScope})}return p}setSources(h){this._setSources(h.map(s=>({getSourceId:()=>s.cache.id,getFootprints:()=>{const u=[];for(const p of s.cache.getVisibleCoordinates()){const v=s.cache.getTile(p).buckets[s.layer];v&&v.updateFootprints(p.toUnwrapped(),u)}return u},getOrder:()=>s.order,getClipMask:()=>s.clipMask,getClipScope:()=>s.clipScope})))}_addSource(h){const s=h.getFootprints();if(s.length===0)return;const u=h.getOrder(),p=h.getClipMask(),v=h.getClipScope();for(const m of s){if(!m.footprint)continue;const _=A5(m.footprint.min,m.footprint.max,m.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:m.id,footprint:m.footprint,order:u,clipMask:p,clipScope:v})}this._sourceIds.push(h.getSourceId())}_computeReplacement(){this._activeRegions.sort((s,u)=>s.priority-u.priority||$2(s.min,u.min)||$2(s.max,u.max)||s.order-u.order||s.clipMask-u.clipMask||function(p,v){const m=(_,C)=>_+C;return p.length-v.length||p.reduce(m,"").localeCompare(v.reduce(m,""))}(s.clipScope,u.clipScope));let h=this._activeRegions.length!==this._prevRegions.length;if(!h){let s=0;for(;!h&&s!==this._activeRegions.length;){const u=this._activeRegions[s],p=this._prevRegions[s];h=u.priority!==p.priority||!S5(u,p)||u.order!==p.order||u.clipMask!==p.clipMask||!qr(u.clipScope,p.clipScope),++s}}if(h){++this._updateTime;for(const u of this._activeRegions)u.order!==U2&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,u.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,u.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,u.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,u.max.y));const s=u=>{const p=this._activeRegions;if(u>=p.length)return u;const v=p[u].priority;for(;u<p.length&&p[u].priority===v;)++u;return u};if(this._sourceIds.length>1){let u=0,p=s(u);for(;u!==p;){let v=u;const m=u;for(;v!==p;){const _=this._activeRegions[v];_.hiddenByOverlap=!1;for(let C=0;C<m;C++){const O=this._activeRegions[C];if(!O.hiddenByOverlap&&_.order===U2&&VN(_,O)&&(_.hiddenByOverlap=P5(_.footprint,_.tileId,O.footprint,O.tileId),_.hiddenByOverlap))break}++v}u=p,p=s(u)}}}}_setSources(h){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let s=h.length-1;s>=0;s--)this._addSource(h[s]);this._computeReplacement()}},i.dw=class{constructor(h){this._createGrid(h),this._createPoles(h)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const h of this._poleSegments)h.destroy();for(const h of this._gridSegments)h.withSkirts.destroy(),h.withoutSkirts.destroy()}_fillGridMeshWithLods(h,s){const u=new Mo,p=new _s,v=[],m=h+1+2,_=s[0]+1,C=s[0]+1+(1+s.length),O=(B,j,R)=>{let F=B===m-1?B-2:B===0?B:B-1;return F+=R?24575:0,[F,j]};for(let B=0;B<m;++B)u.emplaceBack(...O(B,0,!0));for(let B=0;B<_;++B)for(let j=0;j<m;++j)u.emplaceBack(...O(j,B,(j===0||j===m-1)&&!0));for(let B=0;B<s.length;++B){const j=s[B];for(let R=0;R<m;++R)u.emplaceBack(...O(R,j,!0))}for(let B=0;B<s.length;++B){const j=p.length,R=s[B]+1+2,F=new _s;for(let q=0;q<R-1;q++){const X=q===R-2,te=X?m*(C-s.length+B-q):m;for(let le=0;le<m-1;le++){const ue=q*m+le;q===0||X||le===0||le===m-2?(F.emplaceBack(ue+1,ue,ue+te),F.emplaceBack(ue+te,ue+te+1,ue+1)):(p.emplaceBack(ue+1,ue,ue+te),p.emplaceBack(ue+te,ue+te+1,ue+1))}}const M=va.simpleSegment(0,j,u.length,p.length-j);for(let q=0;q<F.uint16.length;q+=3)p.emplaceBack(F.uint16[q],F.uint16[q+1],F.uint16[q+2]);const I=va.simpleSegment(0,j,u.length,p.length-j);v.push({withoutSkirts:M,withSkirts:I})}return{vertices:u,indices:p,segments:v}}_createGrid(h){const s=this._fillGridMeshWithLods(xh,Ef);this._gridSegments=s.segments,this._gridBuffer=h.createVertexBuffer(s.vertices,Lr.members),this._gridIndexBuffer=h.createIndexBuffer(s.indices,!0)}_createPoles(h){const s=new _s;for(let _=0;_<=xh;_++)s.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=h.createIndexBuffer(s,!0);const u=new gu,p=new gu,v=new gu,m=new gu;this._poleSegments=[];for(let _=0,C=0;_<yd;_++){const O=360/(1<<_);u.emplaceBack(0,-to,0,.5,0),p.emplaceBack(0,-to,0,.5,1),v.emplaceBack(0,-to,0,.5,.5),m.emplaceBack(0,-to,0,.5,.5);for(let B=0;B<=xh;B++){let j=B/xh,R=0;const F=Fr(0,O,j),[M,I,q]=rl(wh,dc,F,to);u.emplaceBack(M,I,q,j,R),p.emplaceBack(M,I,q,j,1-R);const X=tt(F);j=.5+.5*Math.sin(X),R=.5+.5*Math.cos(X),v.emplaceBack(M,I,q,j,R),m.emplaceBack(M,I,q,j,1-R)}this._poleSegments.push(va.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=h.createVertexBuffer(u,Wr,!1),this._poleSouthVertexBuffer=h.createVertexBuffer(p,Wr,!1),this._texturedPoleNorthVertexBuffer=h.createVertexBuffer(v,Wr,!1),this._texturedPoleSouthVertexBuffer=h.createVertexBuffer(m,Wr,!1)}getGridBuffers(h,s){return[this._gridBuffer,this._gridIndexBuffer,s?this._gridSegments[h].withSkirts:this._gridSegments[h].withoutSkirts]}getPoleBuffers(h,s){return[s?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,s?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[h]]}},i.dx=U2,i.dy=cr,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=$i,i.e0=H5,i.e1=rc,i.e2=gl,i.e3=bz,i.e4=function(h,s,u,p,v,m,_,C,O,B,j=1,R,F){h.createArrays(),h.tilePixelRatio=hr/(512*h.overscaling),h.compareText={},h.iconsNeedLinear=!1;const M=h.layers[0].layout,I=h.layers[0]._unevaluatedLayout._values,q={};q.scaleFactor=j,q.textSizeScaleRange=M.get("text-size-scale-range"),q.iconSizeScaleRange=M.get("icon-size-scale-range");const[X,te]=q.textSizeScaleRange,[le,ue]=q.iconSizeScaleRange;if(q.textScaleFactor=ur(q.scaleFactor,X,te),q.iconScaleFactor=ur(q.scaleFactor,le,ue),h.textSizeData.kind==="composite"){const{minZoom:Se,maxZoom:Le}=h.textSizeData;q.compositeTextSizes=[I["text-size"].possiblyEvaluate(new bi(Se),C),I["text-size"].possiblyEvaluate(new bi(Le),C)]}if(h.iconSizeData.kind==="composite"){const{minZoom:Se,maxZoom:Le}=h.iconSizeData;q.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new bi(Se),C),I["icon-size"].possiblyEvaluate(new bi(Le),C)]}q.layoutTextSize=I["text-size"].possiblyEvaluate(new bi(O+1),C),q.layoutIconSize=I["icon-size"].possiblyEvaluate(new bi(O+1),C),q.textMaxSize=I["text-size"].possiblyEvaluate(new bi(18),C);const ie=M.get("text-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",fe=M.get("text-size");let ye=!1;for(const Se of h.features)if(Se.icon&&Se.icon.nameSecondary){ye=!0;break}for(const Se of h.features){const Le=M.get("text-font").evaluate(Se,{},C).join(","),Ie=fe.evaluate(Se,{},C)*q.textScaleFactor,Me=q.layoutTextSize.evaluate(Se,{},C)*q.textScaleFactor,et=(q.layoutIconSize.evaluate(Se,{},C),{horizontal:{},vertical:void 0}),Be=Se.text;let rt,st=[0,0];if(Be){const ht=Be.toString(),vt=M.get("text-letter-spacing").evaluate(Se,{},C)*Do,ut=M.get("text-line-height").evaluate(Se,{},C)*Do,It=Iy(ht)?vt:0,Wt=M.get("text-anchor").evaluate(Se,{},C),Rt=M.get("text-variable-anchor");if(!Rt){const kr=M.get("text-radial-offset").evaluate(Se,{},C);st=kr?Nz(Wt,[kr*Do,nj]):M.get("text-offset").evaluate(Se,{},C).map(vr=>vr*Do)}let mr=ie?"center":M.get("text-justify").evaluate(Se,{},C);const dr=M.get("symbol-placement")==="point",tr=dr?M.get("text-max-width").evaluate(Se,{},C)*Do:1/0,Ht=kr=>{h.allowVerticalPlacement&&Dp(ht)&&(et.vertical=ej(Be,s,u,v,Le,tr,ut,Wt,kr,It,st,bu.vertical,!0,Me,Ie))};if(!ie&&Rt){const kr=mr==="auto"?Rt.map(br=>ij(br)):[mr];let vr=!1;for(let br=0;br<kr.length;br++){const en=kr[br];if(!et.horizontal[en])if(vr)et.horizontal[en]=et.horizontal[0];else{const mn=ej(Be,s,u,v,Le,tr,ut,"center",en,It,st,bu.horizontal,!1,Me,Ie);mn&&(et.horizontal[en]=mn,vr=mn.positionedLines.length===1)}}Ht("left")}else{if(mr==="auto"&&(mr=ij(Wt)),dr||M.get("text-writing-mode").indexOf("horizontal")>=0||!Dp(ht)){const kr=ej(Be,s,u,v,Le,tr,ut,Wt,mr,It,st,bu.horizontal,!1,Me,Ie);kr&&(et.horizontal[mr]=kr)}Ht(dr?"left":mr)}}let nt=!1;if(Se.icon&&Se.icon.namePrimary){const ht=ZN(h.iconSizeData,I["icon-size"],C,h.zoom,Se)*q.iconScaleFactor*R,vt=Se.icon.getPrimary().scaleSelf(ht).serialize(),ut=p[vt];ut&&(rt=pae(v[vt],Se.icon.nameSecondary?v[Se.icon.getSecondary().scaleSelf(ht).serialize()]:void 0,M.get("icon-offset").evaluate(Se,{},C),M.get("icon-anchor").evaluate(Se,{},C)),nt=ut.sdf,h.sdfIcons===void 0?h.sdfIcons=ut.sdf:h.sdfIcons!==ut.sdf&&sn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==h.pixelRatio||M.get("icon-rotate").constantOr(1)!==0)&&(h.iconsNeedLinear=!0))}const ct=Cz(et.horizontal)||et.vertical;h.iconsInText||(h.iconsInText=!!ct&&ct.iconsInText),(ct||rt)&&bae(h,Se,et,rt,p,q,Me,0,st,nt,_,C,B,F,ye)}m&&h.generateCollisionDebugBuffers(O,h.collisionBoxArray,q.textScaleFactor)},i.e5=wS,i.e6=Cr,i.e7=v5,i.e8=oz,i.e9=x,i.ea=function(h){let s=0;if(new Uint32Array(h,0,1)[0]!==YF){const u=new Uint32Array(h,0,7),[,,p,v,m,_]=u;s=u.byteLength+v+m+_+m,(p!==h.byteLength||s>=h.byteLength)&&sn("Invalid b3dm header information.")}return eB(h,s)},i.eb=function(h,s){const u=rB(h);for(const p of u){for(const v of p.meshes)Yse(v);p.lights&&(p.lightMeshIndex=p.meshes.length,p.meshes.push(Xse(p.lights,s)))}return u},i.ec=mS,i.ed=gF,i.ee=Jo,i.ef=function(h){or(),Pt!=null&&Pt.then(s=>{s.keys().then(u=>{for(let p=0;p<u.length-h;p++)s.delete(u[p])})})},i.f=function(h){return h.indexOf("mapbox:")===0},i.g=function(h,s){return $a(Ui(h,{method:"GET"}),s)},i.h=ks,i.i=function(h){return $i.API_STYLE_REGEX.test(h)&&!ms(h)},i.j=function(h){return decodeURIComponent(atob(h).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(h){return btoa(encodeURIComponent(h).replace(/%([0-9A-F]{2})/g,(s,u)=>String.fromCharCode(+("0x"+u))))},i.l=Ui,i.m=Gr,i.n=function(h,s){return $a(Ui(h,{type:"json"}),s)},i.o=tf,i.p=function(h,s){return $a(Ui(h,{method:"POST"}),s)},i.q=Ze,i.r=qs,i.s=function(h){try{const s=self[h];return s.setItem("_mapbox_test_",1),s.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=ke,i.u=function(){return function h(s){return s?(s^Math.random()*(16>>s/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,h)}()},i.v=function(h){return!!h&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(h)},i.w=sn,i.x=function(){return wj||(wj=new n0),wj},i.y=gp,i.z=_i}),c(["./shared"],function(i){function x(Tt){const ve=Tt?Tt.url.toString():void 0;return ve?performance.getEntriesByName(ve):[]}function w(Tt){if(typeof Tt=="number"||typeof Tt=="boolean"||typeof Tt=="string"||Tt==null)return JSON.stringify(Tt);if(Array.isArray(Tt)){let Ae="[";for(const ke of Tt)Ae+=`${w(ke)},`;return`${Ae}]`}let ve="{";for(const Ae of Object.keys(Tt).sort())ve+=`${Ae}:${w(Tt[Ae])},`;return`${ve}}`}function A(Tt){let ve="";for(const Ae of i.bm)(Tt.type!=="model"||Ae!=="minzoom"&&Ae!=="maxzoom")&&(ve+=`/${w(Tt[Ae])}`);return ve}class P{constructor(ve){this.keyCache={},this._layers={},this._layerConfigs={},ve&&this.replace(ve)}replace(ve,Ae){this._layerConfigs={},this._layers={},this.update(ve,[],Ae)}update(ve,Ae,ke){this._options=ke;for(const Je of ve)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=i.cu(Je,this.scope,null,this._options)).compileFilter(ke),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of Ae)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const Ze=function(Je,at){const gt={};for(let St=0;St<Je.length;St++){const wt=Je[St];let Pt=at&&at[wt.id];!Pt&&(Pt=A(wt),wt.type==="line"&&wt.paint)&&function ar(or){return typeof or=="string"&&or==="line-progress"||(Array.isArray(or)?or.some(ar):!(!or||typeof or!="object")&&Object.values(or).some(ar))}(wt.paint["line-width"])&&(Pt+=`/${w(wt.paint["line-width"])}`),at&&(at[wt.id]=Pt);let Vt=gt[Pt];Vt||(Vt=gt[Pt]=[]),Vt.push(wt)}const lt=[];for(const St in gt)lt.push(gt[St]);return lt}(i.bj(this._layerConfigs),this.keyCache);for(const Je of Ze){const at=Je.map(Vt=>this._layers[Vt.id]),gt=at[0];if(gt.visibility==="none")continue;const lt=gt.source||"";let St=this.familiesBySource[lt];St||(St=this.familiesBySource[lt]={});const wt=gt.sourceLayer||"_geojsonTileLayer";let Pt=St[wt];Pt||(Pt=St[wt]=[]),Pt.push(at)}}}const E=1*i.dX;class D{constructor(ve){const Ae={},ke=[];for(const gt in ve){const lt=ve[gt],St=Ae[gt]={};for(const wt in lt.glyphs){const Pt=lt.glyphs[+wt];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const Vt=Pt.metrics.localGlyph?E:1,ar={x:0,y:0,w:Pt.bitmap.width+2*Vt,h:Pt.bitmap.height+2*Vt};ke.push(ar),St[wt]=ar}}const{w:Ze,h:Je}=i.F(ke),at=new i.dW({width:Ze||1,height:Je||1});for(const gt in ve){const lt=ve[gt];for(const St in lt.glyphs){const wt=lt.glyphs[+St];if(!wt||wt.bitmap.width===0||wt.bitmap.height===0)continue;const Pt=Ae[gt][St],Vt=wt.metrics.localGlyph?E:1;i.dW.copy(wt.bitmap,at,{x:0,y:0},{x:Pt.x+Vt,y:Pt.y+Vt},wt.bitmap)}}this.image=at,this.positions=Ae}}i.dV(D,"GlyphAtlas");const V="3d_elevation_id",L="hd_road_elevation";class ${constructor(){this._valid=!1}reset(ve){return this.feature=ve,this._valid=!0,this._geometry=ve.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(ve,Ae){return this._valid&&ve(Ae(this._geometry)),this}require(ve,Ae,ke){return this.get(ve,!0,Ae,ke)}optional(ve,Ae,ke){return this.get(ve,!1,Ae,ke)}success(){return this._valid}get(ve,Ae,ke,Ze){const Je=this.feature.properties.hasOwnProperty(ve)?+this.feature.properties[ve]:void 0;return this._valid&&Je!==void 0?ke(Ze?Ze(Je):Je):Ae&&(this._valid=!1),this}}class H{constructor(ve,Ae){this.featureFunc=ve,this.vertexFunc=Ae}parseFeature(ve,Ae,ke){return this.featureFunc(ve,Ae,ke)}parseVertex(ve,Ae,ke){return this.vertexFunc(ve,Ae,ke)}}const K=new H((Tt,ve,Ae)=>Tt.reset(ve).require(V,ke=>{Ae.id=ke}).optional("fixed_height_relative",ke=>{Ae.constantHeight=ke},ae.decodeRelativeHeight).geometry(ke=>{Ae.bounds=ke},ae.computeBounds).success(),(Tt,ve,Ae)=>Tt.reset(ve).require(V,ke=>{Ae.id=ke}).require("elevation_idx",ke=>{Ae.idx=ke}).require("extent",ke=>{Ae.extent=ke}).require("height_relative",ke=>{Ae.height=ke},ae.decodeRelativeHeight).geometry(ke=>{Ae.position=ke},ae.getPoint).success()),Q=new H((Tt,ve,Ae)=>Tt.reset(ve).require(V,ke=>{Ae.id=ke}).optional("fixed_height",ke=>{Ae.constantHeight=ke},ae.decodeMetricHeight).geometry(ke=>{Ae.bounds=ke},ae.computeBounds).success(),(Tt,ve,Ae)=>Tt.reset(ve).require(V,ke=>{Ae.id=ke}).require("elevation_idx",ke=>{Ae.idx=ke}).require("extent",ke=>{Ae.extent=ke}).require("height",ke=>{Ae.height=ke},ae.decodeMetricHeight).geometry(ke=>{Ae.position=ke},ae.getPoint).success());class ae{static computeBounds(ve){const Ae=new i.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),ke=new i.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const Ze of ve[0])Ae.x>Ze.x&&(Ae.x=Ze.x),Ae.y>Ze.y&&(Ae.y=Ze.y),ke.x<Ze.x&&(ke.x=Ze.x),ke.y<Ze.y&&(ke.y=Ze.y);return{min:Ae,max:ke}}static getPoint(ve){return i.ab.vec2.fromValues(ve[0][0].x,ve[0][0].y)}static decodeRelativeHeight(ve){return 1e-4*ve*5}static decodeMetricHeight(ve){return 1e-4*ve}static parse(ve){const Ae=[],ke=[],Ze=ve.length,Je=new $;for(let gt=0;gt<Ze;gt++){const lt=ve.feature(gt),St=lt.properties.hasOwnProperty("version")?String(lt.properties.version):void 0,wt=(at=St)?at==="1.0.1"?Q:void 0:K;if(wt===void 0){i.w(`Unknown elevation feature version number ${St||"(unknown)"}`);continue}const Pt=lt.properties.hasOwnProperty("type")?lt.properties.type:void 0;if(Pt){if(i.dY.VectorTileFeature.types[lt.type]==="Point"&&Pt==="curve_point"){const Vt={};wt.parseVertex(Je,lt,Vt)&&Ae.push(Vt)}else if(i.dY.VectorTileFeature.types[lt.type]==="Polygon"&&Pt==="curve_meta"){const Vt={};wt.parseFeature(Je,lt,Vt)&&ke.push(Vt)}}}var at;return{vertices:Ae,features:ke}}}class ee{constructor(ve,Ae,ke,Ze,Je,at){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=ve,this.heightRange={min:ke,max:ke},this.safeArea=Ae,this.constantHeight=ke,this.constantHeight==null&&(this.constantHeight!=null||Ze.length!==0)){this.vertices=Ze,this.edges=Je,this.edges=this.edges.filter(gt=>gt.a<this.vertices.length&&gt.b<this.vertices.length&&!i.ab.vec2.exactEquals(this.vertices[gt.a].position,this.vertices[gt.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const gt of this.vertices)this.vertexProps.push({dir:i.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,gt.height),this.heightRange.max=Math.max(this.heightRange.max,gt.height);for(const gt of this.edges){const lt=this.vertices[gt.a].position,St=this.vertices[gt.b].position,wt=i.ab.vec2.subtract(i.ab.vec2.create(),St,lt),Pt=i.ab.vec2.length(wt),Vt=i.ab.vec2.scale(i.ab.vec2.create(),wt,1/Pt);this.edgeProps.push({vec:wt,dir:Vt,len:Pt});const ar=this.vertexProps[gt.a].dir,or=this.vertexProps[gt.b].dir;i.ab.vec2.add(ar,ar,Vt),i.ab.vec2.add(or,or,Vt)}for(const gt of this.vertexProps)gt.dir[0]===0&&gt.dir[1]===0||i.ab.vec2.normalize(gt.dir,gt.dir);this.tessellate(at)}}pointElevation(ve){if(this.constantHeight!=null)return this.constantHeight;const Ae=this.getClosestEdge(ve);if(Ae==null)return 0;const[ke,Ze]=Ae;return(1-(Je=Ze))*this.vertices[this.edges[ke].a].height+Je*this.vertices[this.edges[ke].b].height;var Je}getClosestEdge(ve){if(this.edges.length===0)return;let Ae=0,ke=Number.POSITIVE_INFINITY,Ze=0;const Je=i.ab.vec2.fromValues(ve.x,ve.y);for(let at=0;at<this.edges.length;at++){const gt=this.edges[at],lt=this.edgeProps[at].dir,St=new i.dZ(Je,this.edgeProps[at].dir),wt=this.vertices[gt.a].position,Pt=this.vertices[gt.b].position,Vt=i.ab.vec2.create(),ar=i.ab.vec2.create(),or=St.intersectsPlane(wt,this.vertexProps[gt.a].dir,Vt),Ar=St.intersectsPlane(Pt,this.vertexProps[gt.b].dir,ar);if(!or||!Ar)continue;const Gr=i.ab.vec2.subtract(i.ab.vec2.create(),ar,Vt),$r=i.ab.vec2.subtract(i.ab.vec2.create(),Je,Vt),Ur=i.ab.vec2.dot(Gr,Gr),On=Ur>0?i.ab.vec2.dot($r,Gr)/Ur:0,Kn=i.aw(On,0,1),wn=Math.abs((On-Kn)*this.edgeProps[at].len),Un=i.ab.vec2.subtract(i.ab.vec2.create(),Je,wt),Rn=wn+Math.abs(i.ab.vec2.dot(Un,i.ab.vec2.fromValues(lt[1],-lt[0])));Rn<ke&&(Ae=at,ke=Rn,Ze=Kn)}return[Ae,Ze]}tessellate(ve){for(let Ae=this.edges.length-1;Ae>=0;--Ae){const ke=this.edges[Ae].a,Ze=this.edges[Ae].b,{position:Je,height:at,extent:gt}=this.vertices[ke],{position:lt,height:St,extent:wt}=this.vertices[Ze],Pt=this.vertexProps[ke].dir,Vt=this.vertexProps[Ze].dir,ar=i.ab.vec3.fromValues(Je[0]/ve,Je[1]/ve,at),or=i.ab.vec3.fromValues(lt[0]/ve,lt[1]/ve,St),Ar=i.ab.vec3.fromValues(Pt[1],-Pt[0],0);i.ab.vec3.scale(Ar,Ar,gt);const Gr=i.ab.vec3.fromValues(Vt[1],-Vt[0],0);if(i.ab.vec3.scale(Gr,Gr,wt),this.distSqLines(i.ab.vec3.fromValues(ar[0]+.5*Ar[0],ar[1]+.5*Ar[1],ar[2]+.5*Ar[2]),i.ab.vec3.fromValues(or[0]-.5*Gr[0],or[1]-.5*Gr[1],or[2]-.5*Gr[2]),i.ab.vec3.fromValues(ar[0]-.5*Ar[0],ar[1]-.5*Ar[1],ar[2]-.5*Ar[2]),i.ab.vec3.fromValues(or[0]+.5*Gr[0],or[1]+.5*Gr[1],or[2]+.5*Gr[2]))<=.05*.05)continue;const $r=this.vertices.length,Ur=i.ab.vec2.add(i.ab.vec2.create(),Je,lt);this.vertices.push({position:i.ab.vec2.scale(Ur,Ur,.5),height:.5*(at+St),extent:.5*(gt+wt)});const On=i.ab.vec2.add(i.ab.vec2.create(),Pt,Vt);this.vertexProps.push({dir:i.ab.vec2.normalize(On,On)}),this.edges.splice(Ae,1),this.edgeProps.splice(Ae,1),this.edges.push({a:ke,b:$r}),this.edges.push({a:$r,b:Ze});const Kn=i.ab.vec2.subtract(i.ab.vec2.create(),this.vertices[$r].position,Je),wn=i.ab.vec2.length(Kn),Un={vec:Kn,dir:i.ab.vec2.scale(i.ab.vec2.create(),Kn,1/wn),len:wn};this.edgeProps.push(Un),this.edgeProps.push(Un)}}distSqLines(ve,Ae,ke,Ze){const Je=i.ab.vec3.subtract(i.ab.vec3.create(),Ae,ve),at=i.ab.vec3.subtract(i.ab.vec3.create(),Ze,ke),gt=i.ab.vec3.subtract(i.ab.vec3.create(),ve,ke),lt=i.ab.vec3.dot(Je,Je),St=i.ab.vec3.dot(Je,at),wt=i.ab.vec3.dot(Je,gt),Pt=i.ab.vec3.dot(at,at),Vt=i.ab.vec3.dot(at,gt),ar=lt*Pt-St*St;if(ar===0){const Ur=i.ab.vec3.dot(gt,at)/i.ab.vec3.dot(at,at),On=i.ab.vec3.lerp(i.ab.vec3.create(),ke,Ze,Ur);return i.ab.vec3.squaredDistance(On,ve)}const or=(St*Vt-wt*Pt)/ar,Ar=(lt*Vt-St*wt)/ar,Gr=i.ab.vec3.lerp(i.ab.vec3.create(),ve,Ae,or),$r=i.ab.vec3.lerp(i.ab.vec3.create(),ke,Ze,Ar);return i.ab.vec3.squaredDistance(Gr,$r)}}class se{static parseFrom(ve,Ae){const ke=ae.parse(ve);if(!ke)return[];let{vertices:Ze,features:Je}=ke;const at=1/i.cc(Ae);Je.sort((wt,Pt)=>wt.id-Pt.id),Ze.sort((wt,Pt)=>wt.id-Pt.id||wt.idx-Pt.idx),Ze=Ze.filter((wt,Pt,Vt)=>Pt===Vt.findIndex(ar=>ar.id===wt.id&&ar.idx===wt.idx));const gt=new Array;let lt=0;const St=Ze.length;for(const wt of Je){if(wt.constantHeight){gt.push(new ee(wt.id,wt.bounds,wt.constantHeight));continue}for(;lt!==St&&Ze[lt].id<wt.id;)lt++;if(lt===St||Ze[lt].id!==wt.id)continue;const Pt=new Array,Vt=new Array,ar=lt;for(;lt!==St&&Ze[lt].id===wt.id;){const or=Ze[lt];if(Pt.push({position:or.position,height:or.height,extent:or.extent}),lt!==ar&&Ze[lt-1].idx===or.idx-1){const Ar=lt-ar;Vt.push({a:Ar-1,b:Ar})}lt++}gt.push(new ee(wt.id,wt.bounds,void 0,Pt,Vt,at))}return gt}}i.dV(ee,"ElevationFeature");class ce{constructor(ve){this.tileID=new i.aG(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),this.tileZoom=ve.tileZoom,this.uid=ve.uid,this.zoom=ve.zoom,this.lut=ve.lut,this.canonical=ve.tileID.canonical,this.pixelRatio=ve.pixelRatio,this.tileSize=ve.tileSize,this.source=ve.source,this.scope=ve.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ve.showCollisionBoxes,this.collectResourceTiming=!!ve.request&&ve.request.collectResourceTiming,this.promoteId=ve.promoteId,this.isSymbolTile=ve.isSymbolTile,this.tileTransform=i.aQ(ve.tileID.canonical,ve.projection),this.projection=ve.projection,this.worldview=ve.worldview,this.localizableLayerIds=ve.localizableLayerIds,this.brightness=ve.brightness,this.extraShadowCaster=!!ve.extraShadowCaster,this.tessellationStep=ve.tessellationStep,this.scaleFactor=ve.scaleFactor}parse(ve,Ae,ke,Ze,Je){this.status="parsing",this.data=ve,this.collisionBoxArray=new i.aW;const at=new i.d_(Object.keys(ve.layers).sort()),gt=new i.d$(this.tileID,this.promoteId);gt.bucketLayerIDs=[];const lt={},St=new i.e0(256,256),wt={featureIndex:gt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:St,availableImages:ke,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Pt=Ae.familiesBySource[this.source];for(const Ur in Pt){const On=ve.layers[Ur];if(!On)continue;let Kn=!1,wn=!1,Un=!1;for(const $a of Pt[Ur])$a[0].type==="symbol"?Kn=!0:wn=!0,$a[0].is3D()&&$a[0].type!=="model"&&(Un=!0);if(this.extraShadowCaster&&!Un||this.isSymbolTile===!0&&!Kn||this.isSymbolTile===!1&&!wn)continue;On.version===1&&i.w(`Vector tile source "${this.source}" layer "${Ur}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Rn=at.encode(Ur),ja=[];let gs=!1;for(let $a=0,rs=0;$a<On.length;$a++){const ho=On.feature($a),qu=gt.getId(ho,Ur);if(this.localizableLayerIds&&this.localizableLayerIds.has(Ur)){const Ml=ho.properties?ho.properties.worldview:null;if(this.worldview&&typeof Ml=="string")if(Ml==="all")ho.properties.$localized=!0;else{if(!Ml.split(",").includes(this.worldview))continue;ho.properties.$localized=!0,ho.properties.worldview=this.worldview}}!gs&&ho.properties&&ho.properties.hasOwnProperty(V)&&(gs=!0),ja.push({feature:ho,id:qu,index:rs,sourceLayerIndex:Rn}),rs++}gs&&ve.layers.hasOwnProperty(L)&&(wt.elevationFeatures=se.parseFrom(ve.layers[L],this.canonical));for(const $a of Pt[Ur]){const rs=$a[0];(!this.extraShadowCaster||rs.is3D()&&rs.type!=="model")&&(this.isSymbolTile!==void 0&&rs.type==="symbol"!==this.isSymbolTile||rs.minzoom&&this.zoom<Math.floor(rs.minzoom)||rs.maxzoom&&this.zoom>=rs.maxzoom||rs.visibility!=="none"&&(he($a,this.zoom,wt.brightness,ke),(lt[rs.id]=rs.createBucket({index:gt.bucketLayerIDs.length,layers:$a,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(ja,wt,this.tileID.canonical,this.tileTransform),gt.bucketLayerIDs.push($a.map(ho=>i.aC(ho.id,ho.scope)))))}}let Vt,ar,or,Ar;St.trim();const Gr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},$r=()=>{if(Vt)return this.status="done",Je(Vt);if(this.extraShadowCaster)this.status="done",Je(null,{buckets:i.bj(lt).filter(Ur=>!Ur.isEmpty()),featureIndex:gt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:wt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(ar&&or&&Ar){const Ur=new D(ar),On=new i.e3(or,Ar,this.lut);for(const Kn in lt){const wn=lt[Kn];wn instanceof i.aX?(he(wn.layers,this.zoom,wt.brightness,ke),i.e4(wn,ar,Ur.positions,or,On.iconPositions,this.showCollisionBoxes,ke,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):wn.hasPattern&&(wn instanceof i.b1||wn instanceof i.b2||wn instanceof i.d5)&&(he(wn.layers,this.zoom,wt.brightness,ke),wn.addFeatures(wt,this.tileID.canonical,On.patternPositions,ke,this.tileTransform,this.brightness))}this.status="done",Je(null,{buckets:i.bj(lt).filter(Kn=>!Kn.isEmpty()),featureIndex:gt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ur.image,lineAtlas:St,imageAtlas:On,brightness:wt.brightness})}};if(!this.extraShadowCaster){const Ur=i.e1(wt.glyphDependencies,wn=>Object.keys(wn).map(Number));Object.keys(Ur).length?Ze.send("getGlyphs",{uid:this.uid,stacks:Ur,scope:this.scope},(wn,Un)=>{Vt||(Vt=wn,ar=Un,$r())},void 0,!1,Gr):ar={};const On=Object.keys(wt.iconDependencies);On.length?Ze.send("getImages",{icons:On,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(wn,Un)=>{if(Vt)return;Vt=wn;const Rn={};Object.values(Un).some(ja=>ja.usvg)?this.rasterize(Ze,Rn,Un,wt.iconDependencies,()=>{or=Rn,$r()}):(this.fillImageMap(Rn,wt.iconDependencies,Un),or=Rn,$r())},void 0,!1,Gr):or={};const Kn=Object.keys(wt.patternDependencies);Kn.length?Ze.send("getImages",{icons:Kn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(wn,Un)=>{if(!Vt){Vt=wn;const Rn={};Object.values(Un).some(ja=>ja.usvg)?this.rasterize(Ze,Rn,Un,wt.patternDependencies,()=>{Ar=Rn,$r()}):(this.fillImageMap(Rn,wt.patternDependencies,Un),Ar=Rn,$r())}},void 0,!1,Gr):Ar={}}$r()}fillImageMap(ve,Ae,ke){for(const Ze in ke){const Je=Ae[Ze]||[];for(const at of Je)ke[at.id].usvg||(ve[at.serialize()]=ke[at.id])}}getImageTaskQueue(ve,Ae,ke){const Ze={};for(const Je in Ae){const at=ke[Je]||[];for(const gt of at){const lt=gt.serialize();Ae[gt.id].usvg?Ze[lt]||(Ze[lt]=gt):ve[lt]=Ae[gt.id]}}return Ze}rasterize(ve,Ae,ke,Ze,Je){const at=this.getImageTaskQueue(Ae,ke,Ze);this.rasterizeTask=ve.send("rasterizeImages",{scope:this.scope,imageTasks:at},(gt,lt)=>{if(!gt)for(const St in lt){const{id:wt}=i.e2.deserializeFromString(St);Ae[St]=Object.assign({},ke[wt],{data:lt[St]})}Je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function he(Tt,ve,Ae,ke){const Ze=new i.a8(ve,{brightness:Ae});for(const Je of Tt)Je.recalculate(Ze,ke)}class Pe extends i.E{constructor(ve,Ae,ke,Ze,Je,at){super(),this.actor=ve,this.layerIndex=Ae,this.availableImages=ke,this.loadVectorData=Je||i.aD,this.loading={},this.loaded={},this.deduped=new i.aB(ve.scheduler),this.isSpriteLoaded=Ze,this.scheduler=ve.scheduler,this.brightness=at}loadTile(ve,Ae){const ke=ve.uid,Ze=ve&&ve.request,Je=Ze&&Ze.collectResourceTiming,at=this.loading[ke]=new ce(ve);at.abort=this.loadVectorData(ve,(gt,lt)=>{const St=!this.loading[ke];if(delete this.loading[ke],at.cancelRasterize(),St||gt||!lt)return at.status="done",St||(this.loaded[ke]=at),Ae(gt);const wt=lt.rawData,Pt={};lt.expires&&(Pt.expires=lt.expires),lt.cacheControl&&(Pt.cacheControl=lt.cacheControl),at.vectorTile=lt.vectorTile||new i.dY.VectorTile(new i.bh(wt));const Vt=()=>{at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.actor,(ar,or)=>{if(ar||!or)return Ae(ar);const Ar={};if(Je){const Gr=x(Ze);Gr.length>0&&(Ar.resourceTiming=JSON.parse(JSON.stringify(Gr)))}Ae(null,i.l({rawTileData:wt.slice(0)},or,Pt,Ar))})};this.isSpriteLoaded?Vt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Vt,{type:"parseTile",isSymbolTile:ve.isSymbolTile,zoom:ve.tileZoom}):Vt()}),this.loaded=this.loaded||{},this.loaded[ke]=at})}reloadTile(ve,Ae){const ke=this.loaded,Ze=ve.uid;if(ke&&ke[Ze]){const Je=ke[Ze];Je.scaleFactor=ve.scaleFactor,Je.showCollisionBoxes=ve.showCollisionBoxes,Je.projection=ve.projection,Je.brightness=ve.brightness,Je.tileTransform=i.aQ(ve.tileID.canonical,ve.projection),Je.extraShadowCaster=ve.extraShadowCaster,Je.lut=ve.lut;const at=(gt,lt)=>{const St=Je.reloadCallback;St&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,St)),Ae(gt,lt)};Je.status==="parsing"?Je.reloadCallback=at:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,at):at())}else Ae(null,void 0)}abortTile(ve,Ae){const ke=ve.uid,Ze=this.loading[ke];Ze&&(Ze.abort&&Ze.abort(),delete this.loading[ke]),Ae()}removeTile(ve,Ae){const ke=this.loaded,Ze=ve.uid;ke&&ke[Ze]&&delete ke[Ze],Ae()}}class Ne{loadTile(ve,Ae){const{uid:ke,encoding:Ze,rawImageData:Je,padding:at}=ve,gt=ImageBitmap&&Je instanceof ImageBitmap?this.getImageData(Je,at):Je;Ae(null,new i.e5(ke,gt,Ze,at<1))}getImageData(ve,Ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ve.width,ve.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ve.width,this.offscreenCanvas.height=ve.height,this.offscreenCanvasContext.drawImage(ve,0,0,ve.width,ve.height);const ke=this.offscreenCanvasContext.getImageData(-Ae,-Ae,ve.width+2*Ae,ve.height+2*Ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ke}}i.bg.setPbf(i.bh);class pe{decodeRasterArray({task:ve,buffer:Ae},ke){i.bg.performDecoding(Ae,ve).then(Ze=>{ke(null,Ze)},Ze=>{ke(Ze)})}}const je=i.dY.VectorTileFeature.prototype.toGeoJSON;class xe{constructor(ve){this._feature=ve,this.extent=i.ag,this.type=ve.type,this.properties=ve.tags,"id"in ve&&!isNaN(ve.id)&&(this.id=parseInt(ve.id,10))}loadGeometry(){if(this._feature.type===1){const ve=[];for(const Ae of this._feature.geometry)ve.push([new i.P(Ae[0],Ae[1])]);return ve}{const ve=[];for(const Ae of this._feature.geometry){const ke=[];for(const Ze of Ae)ke.push(new i.P(Ze[0],Ze[1]));ve.push(ke)}return ve}}toGeoJSON(ve,Ae,ke){return je.call(this,ve,Ae,ke)}}class Ce{constructor(ve){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.ag,this.length=ve.length,this._features=ve}feature(ve){return new xe(this._features[ve])}}const ze=64/4096,Te=128;class Re{constructor(){this.features=new Map}clear(){this.features.clear()}load(ve=[],Ae){for(const ke of ve){const Ze=ke.id;if(Ze==null)continue;let Je=this.features.get(Ze);Je&&this.updateCache(Je,Ae),ke.geometry?(Je=He(ke),this.updateCache(Je,Ae),this.features.set(Ze,Je)):this.features.delete(Ze),this.updateCache(Je,Ae)}}updateCache(ve,Ae){for(const{canonical:ke,uid:Ze}of Object.values(Ae)){const{z:Je,x:at,y:gt}=ke;Fe(ve,Math.pow(2,Je),at,gt)&&delete Ae[Ze]}}getTile(ve,Ae,ke){const Ze=Math.pow(2,ve),Je=[];for(const at of this.features.values())Fe(at,Ze,Ae,ke)&&Je.push(qe(at,Ze,Ae,ke));return{features:Je}}getFeatures(){return[...this.features.values()]}}function Fe({minX:Tt,minY:ve,maxX:Ae,maxY:ke},Ze,Je,at){return Tt<(Je+1+ze)/Ze&&ve<(at+1+ze)/Ze&&Ae>(Je-ze)/Ze&&ke>(at-ze)/Ze}function He(Tt){const{id:ve,geometry:Ae,properties:ke}=Tt;if(!Ae)return;if(Ae.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ze,coordinates:Je}=Ae,at={id:ve,type:1,geometry:[],tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},gt=at.geometry;if(Ze==="Point")mt(Je,gt,at);else if(Ze==="MultiPoint")for(const lt of Je)mt(lt,gt,at);else if(Ze==="LineString")at.type=2,Xe(Je,gt,at);else if(Ze==="MultiLineString")at.type=2,ot(Je,gt,at);else if(Ze==="Polygon")at.type=3,ot(Je,gt,at,!0);else{if(Ze!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");at.type=3;for(const lt of Je)ot(lt,gt,at,!0)}return at}function mt([Tt,ve],Ae,ke){const Ze=i.at(Tt);let Je=i.aA(ve);Je=Je<0?0:Je>1?1:Je,Ae.push(Ze,Je),ke.minX=Math.min(ke.minX,Ze),ke.minY=Math.min(ke.minY,Je),ke.maxX=Math.max(ke.maxX,Ze),ke.maxY=Math.max(ke.maxY,Je)}function Xe(Tt,ve,Ae,ke=!1,Ze=!1){const Je=[];for(const at of Tt)mt(at,Je,Ae);ve.push(Je),ke&&function(at,gt){let lt=0;for(let St=0,wt=at.length,Pt=wt-2;St<wt;Pt=St,St+=2)lt+=(at[St]-at[Pt])*(at[St+1]+at[Pt+1]);if(lt>0===gt)for(let St=0,wt=at.length;St<wt/2;St+=2){const Pt=at[St],Vt=at[St+1];at[St]=at[wt-2-St],at[St+1]=at[wt-1-St],at[wt-2-St]=Pt,at[wt-1-St]=Vt}}(Je,Ze)}function ot(Tt,ve,Ae,ke=!1){for(let Ze=0;Ze<Tt.length;Ze++)Xe(Tt[Ze],ve,Ae,ke,Ze===0)}function qe(Tt,ve,Ae,ke){const{id:Ze,type:Je,geometry:at,tags:gt}=Tt,lt=[];if(Je===1)(function(St,wt,Pt,Vt,ar){for(let or=0;or<St.length;or+=2){const Ar=Math.round(i.ag*(St[or+0]*wt-Pt)),Gr=Math.round(i.ag*(St[or+1]*wt-Vt));ar.push([Ar,Gr])}})(at,ve,Ae,ke,lt);else for(const St of at)Lt(St,ve,Ae,ke,lt);return{id:Ze,type:Je,geometry:lt,tags:gt}}function Lt(Tt,ve,Ae,ke,Ze){const at=i.ag+Te;let gt;for(let lt=0;lt<Tt.length-2;lt+=2){let St=Math.round(i.ag*(Tt[lt+0]*ve-Ae)),wt=Math.round(i.ag*(Tt[lt+1]*ve-ke)),Pt=Math.round(i.ag*(Tt[lt+2]*ve-Ae)),Vt=Math.round(i.ag*(Tt[lt+3]*ve-ke));const ar=Pt-St,or=Vt-wt;St<-128&&Pt<-128||(St<-128?(wt+=Math.round(or*((-128-St)/ar)),St=-128):Pt<-128&&(Vt=wt+Math.round(or*((-128-St)/ar)),Pt=-128),wt<-128&&Vt<-128||(wt<-128?(St+=Math.round(ar*((-128-wt)/or)),wt=-128):Vt<-128&&(Pt=St+Math.round(ar*((-128-wt)/or)),Vt=-128),St>=at&&Pt>=at||(St>=at?(wt+=Math.round(or*((at-St)/ar)),St=at):Pt>=at&&(Vt=wt+Math.round(or*((at-St)/ar)),Pt=at),wt>=at&&Vt>=at||(wt>=at?(St+=Math.round(ar*((at-wt)/or)),wt=at):Vt>=at&&(Pt=St+Math.round(ar*((at-wt)/or)),Vt=at),gt&&St===gt[gt.length-1][0]&&wt===gt[gt.length-1][1]||(gt=[[St,wt]],Ze.push(gt)),gt.push([Pt,Vt])))))}}var Zt,Xt,rr,ir={exports:{}},Bt=function(){if(rr)return ir.exports;rr=1;var Tt=i.e8(),ve=function(){if(Xt)return Zt;Xt=1;var wt=i.e6(),Pt=i.e7().VectorTileFeature;function Vt(or,Ar){this.options=Ar||{},this.features=or,this.length=or.length}function ar(or,Ar){this.id=typeof or.id=="number"?or.id:void 0,this.type=or.type,this.rawGeometry=or.type===1?[or.geometry]:or.geometry,this.properties=or.tags,this.extent=Ar||4096}return Zt=Vt,Vt.prototype.feature=function(or){return new ar(this.features[or],this.options.extent)},ar.prototype.loadGeometry=function(){var or=this.rawGeometry;this.geometry=[];for(var Ar=0;Ar<or.length;Ar++){for(var Gr=or[Ar],$r=[],Ur=0;Ur<Gr.length;Ur++)$r.push(new wt(Gr[Ur][0],Gr[Ur][1]));this.geometry.push($r)}return this.geometry},ar.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var or=this.geometry,Ar=1/0,Gr=-1/0,$r=1/0,Ur=-1/0,On=0;On<or.length;On++)for(var Kn=or[On],wn=0;wn<Kn.length;wn++){var Un=Kn[wn];Ar=Math.min(Ar,Un.x),Gr=Math.max(Gr,Un.x),$r=Math.min($r,Un.y),Ur=Math.max(Ur,Un.y)}return[Ar,$r,Gr,Ur]},ar.prototype.toGeoJSON=Pt.prototype.toGeoJSON,Zt}();function Ae(wt){var Pt=new Tt;return function(Vt,ar){for(var or in Vt.layers)ar.writeMessage(3,ke,Vt.layers[or])}(wt,Pt),Pt.finish()}function ke(wt,Pt){var Vt;Pt.writeVarintField(15,wt.version||1),Pt.writeStringField(1,wt.name||""),Pt.writeVarintField(5,wt.extent||4096);var ar={keys:[],values:[],keycache:{},valuecache:{}};for(Vt=0;Vt<wt.length;Vt++)ar.feature=wt.feature(Vt),Pt.writeMessage(2,Ze,ar);var or=ar.keys;for(Vt=0;Vt<or.length;Vt++)Pt.writeStringField(3,or[Vt]);var Ar=ar.values;for(Vt=0;Vt<Ar.length;Vt++)Pt.writeMessage(4,St,Ar[Vt])}function Ze(wt,Pt){var Vt=wt.feature;Vt.id!==void 0&&Pt.writeVarintField(1,Vt.id),Pt.writeMessage(2,Je,wt),Pt.writeVarintField(3,Vt.type),Pt.writeMessage(4,lt,Vt)}function Je(wt,Pt){var Vt=wt.feature,ar=wt.keys,or=wt.values,Ar=wt.keycache,Gr=wt.valuecache;for(var $r in Vt.properties){var Ur=Vt.properties[$r],On=Ar[$r];if(Ur!==null){On===void 0&&(ar.push($r),Ar[$r]=On=ar.length-1),Pt.writeVarint(On);var Kn=typeof Ur;Kn!=="string"&&Kn!=="boolean"&&Kn!=="number"&&(Ur=JSON.stringify(Ur));var wn=Kn+":"+Ur,Un=Gr[wn];Un===void 0&&(or.push(Ur),Gr[wn]=Un=or.length-1),Pt.writeVarint(Un)}}}function at(wt,Pt){return(Pt<<3)+(7&wt)}function gt(wt){return wt<<1^wt>>31}function lt(wt,Pt){for(var Vt=wt.loadGeometry(),ar=wt.type,or=0,Ar=0,Gr=Vt.length,$r=0;$r<Gr;$r++){var Ur=Vt[$r],On=1;ar===1&&(On=Ur.length),Pt.writeVarint(at(1,On));for(var Kn=ar===3?Ur.length-1:Ur.length,wn=0;wn<Kn;wn++){wn===1&&ar!==1&&Pt.writeVarint(at(2,Kn-1));var Un=Ur[wn].x-or,Rn=Ur[wn].y-Ar;Pt.writeVarint(gt(Un)),Pt.writeVarint(gt(Rn)),or+=Un,Ar+=Rn}ar===3&&Pt.writeVarint(at(7,1))}}function St(wt,Pt){var Vt=typeof wt;Vt==="string"?Pt.writeStringField(1,wt):Vt==="boolean"?Pt.writeBooleanField(7,wt):Vt==="number"&&(wt%1!=0?Pt.writeDoubleField(3,wt):wt<0?Pt.writeSVarintField(6,wt):Pt.writeVarintField(5,wt))}return ir.exports=Ae,ir.exports.fromVectorTileJs=Ae,ir.exports.fromGeojsonVt=function(wt,Pt){Pt=Pt||{};var Vt={};for(var ar in wt)Vt[ar]=new ve(wt[ar].features,Pt),Vt[ar].name=ar,Vt[ar].version=Pt.version,Vt[ar].extent=Pt.extent;return Ae({layers:Vt})},ir.exports.GeoJSONWrapper=ve,ir.exports}(),De=i.e9(Bt);const jr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Tt=>Tt},Dt=Math.fround||(Cr=new Float32Array(1),Tt=>(Cr[0]=+Tt,Cr[0]));var Cr;const At=3,qr=5,an=6;class Jn{constructor(ve){this.options=Object.assign(Object.create(jr),ve),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ve){const{log:Ae,minZoom:ke,maxZoom:Ze}=this.options;Ae&&console.time("total time");const Je=`prepare ${ve.length} points`;Ae&&console.time(Je),this.points=ve;const at=[];for(let lt=0;lt<ve.length;lt++){const St=ve[lt];if(!St.geometry)continue;const[wt,Pt]=St.geometry.coordinates,Vt=Dt(Mt(wt)),ar=Dt(lr(Pt));at.push(Vt,ar,1/0,lt,-1,1),this.options.reduce&&at.push(0)}let gt=this.trees[Ze+1]=this._createTree(at);Ae&&console.timeEnd(Je);for(let lt=Ze;lt>=ke;lt--){const St=+Date.now();gt=this.trees[lt]=this._createTree(this._cluster(gt,lt)),Ae&&console.log("z%d: %d clusters in %dms",lt,gt.numItems,+Date.now()-St)}return Ae&&console.timeEnd("total time"),this}getClusters(ve,Ae){let ke=((ve[0]+180)%360+360)%360-180;const Ze=Math.max(-90,Math.min(90,ve[1]));let Je=ve[2]===180?180:((ve[2]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,ve[3]));if(ve[2]-ve[0]>=360)ke=-180,Je=180;else if(ke>Je){const Pt=this.getClusters([ke,Ze,180,at],Ae),Vt=this.getClusters([-180,Ze,Je,at],Ae);return Pt.concat(Vt)}const gt=this.trees[this._limitZoom(Ae)],lt=gt.range(Mt(ke),lr(at),Mt(Je),lr(Ze)),St=gt.data,wt=[];for(const Pt of lt){const Vt=this.stride*Pt;wt.push(St[Vt+qr]>1?tt(St,Vt,this.clusterProps):this.points[St[Vt+At]])}return wt}getChildren(ve){const Ae=this._getOriginId(ve),ke=this._getOriginZoom(ve),Ze="No cluster with the specified id.",Je=this.trees[ke];if(!Je)throw new Error(Ze);const at=Je.data;if(Ae*this.stride>=at.length)throw new Error(Ze);const gt=this.options.radius/(this.options.extent*Math.pow(2,ke-1)),lt=Je.within(at[Ae*this.stride],at[Ae*this.stride+1],gt),St=[];for(const wt of lt){const Pt=wt*this.stride;at[Pt+4]===ve&&St.push(at[Pt+qr]>1?tt(at,Pt,this.clusterProps):this.points[at[Pt+At]])}if(St.length===0)throw new Error(Ze);return St}getLeaves(ve,Ae,ke){const Ze=[];return this._appendLeaves(Ze,ve,Ae=Ae||10,ke=ke||0,0),Ze}getTile(ve,Ae,ke){const Ze=this.trees[this._limitZoom(ve)],Je=Math.pow(2,ve),{extent:at,radius:gt}=this.options,lt=gt/at,St=(ke-lt)/Je,wt=(ke+1+lt)/Je,Pt={features:[]};return this._addTileFeatures(Ze.range((Ae-lt)/Je,St,(Ae+1+lt)/Je,wt),Ze.data,Ae,ke,Je,Pt),Ae===0&&this._addTileFeatures(Ze.range(1-lt/Je,St,1,wt),Ze.data,Je,ke,Je,Pt),Ae===Je-1&&this._addTileFeatures(Ze.range(0,St,lt/Je,wt),Ze.data,-1,ke,Je,Pt),Pt.features.length?Pt:null}getClusterExpansionZoom(ve){let Ae=this._getOriginZoom(ve)-1;for(;Ae<=this.options.maxZoom;){const ke=this.getChildren(ve);if(Ae++,ke.length!==1)break;ve=ke[0].properties.cluster_id}return Ae}_appendLeaves(ve,Ae,ke,Ze,Je){const at=this.getChildren(Ae);for(const gt of at){const lt=gt.properties;if(lt&&lt.cluster?Je+lt.point_count<=Ze?Je+=lt.point_count:Je=this._appendLeaves(ve,lt.cluster_id,ke,Ze,Je):Je<Ze?Je++:ve.push(gt),ve.length===ke)break}return Je}_createTree(ve){const Ae=new i.bE(ve.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ke=0;ke<ve.length;ke+=this.stride)Ae.add(ve[ke],ve[ke+1]);return Ae.finish(),Ae.data=ve,Ae}_addTileFeatures(ve,Ae,ke,Ze,Je,at){for(const gt of ve){const lt=gt*this.stride,St=Ae[lt+qr]>1;let wt,Pt,Vt;if(St)wt=xt(Ae,lt,this.clusterProps),Pt=Ae[lt],Vt=Ae[lt+1];else{const Ar=this.points[Ae[lt+At]];wt=Ar.properties;const[Gr,$r]=Ar.geometry.coordinates;Pt=Mt(Gr),Vt=lr($r)}const ar={type:1,geometry:[[Math.round(this.options.extent*(Pt*Je-ke)),Math.round(this.options.extent*(Vt*Je-Ze))]],tags:wt};let or;or=St||this.options.generateId?Ae[lt+At]:this.points[Ae[lt+At]].id,or!==void 0&&(ar.id=or),at.features.push(ar)}}_limitZoom(ve){return Math.max(this.options.minZoom,Math.min(Math.floor(+ve),this.options.maxZoom+1))}_cluster(ve,Ae){const{radius:ke,extent:Ze,reduce:Je,minPoints:at}=this.options,gt=ke/(Ze*Math.pow(2,Ae)),lt=ve.data,St=[],wt=this.stride;for(let Pt=0;Pt<lt.length;Pt+=wt){if(lt[Pt+2]<=Ae)continue;lt[Pt+2]=Ae;const Vt=lt[Pt],ar=lt[Pt+1],or=ve.within(lt[Pt],lt[Pt+1],gt),Ar=lt[Pt+qr];let Gr=Ar;for(const $r of or){const Ur=$r*wt;lt[Ur+2]>Ae&&(Gr+=lt[Ur+qr])}if(Gr>Ar&&Gr>=at){let $r,Ur=Vt*Ar,On=ar*Ar,Kn=-1;const wn=(Pt/wt<<5)+(Ae+1)+this.points.length;for(const Un of or){const Rn=Un*wt;if(lt[Rn+2]<=Ae)continue;lt[Rn+2]=Ae;const ja=lt[Rn+qr];Ur+=lt[Rn]*ja,On+=lt[Rn+1]*ja,lt[Rn+4]=wn,Je&&($r||($r=this._map(lt,Pt,!0),Kn=this.clusterProps.length,this.clusterProps.push($r)),Je($r,this._map(lt,Rn)))}lt[Pt+4]=wn,St.push(Ur/Gr,On/Gr,1/0,wn,-1,Gr),Je&&St.push(Kn)}else{for(let $r=0;$r<wt;$r++)St.push(lt[Pt+$r]);if(Gr>1)for(const $r of or){const Ur=$r*wt;if(!(lt[Ur+2]<=Ae)){lt[Ur+2]=Ae;for(let On=0;On<wt;On++)St.push(lt[Ur+On])}}}}return St}_getOriginId(ve){return ve-this.points.length>>5}_getOriginZoom(ve){return(ve-this.points.length)%32}_map(ve,Ae,ke){if(ve[Ae+qr]>1){const at=this.clusterProps[ve[Ae+an]];return ke?Object.assign({},at):at}const Ze=this.points[ve[Ae+At]].properties,Je=this.options.map(Ze);return ke&&Je===Ze?Object.assign({},Je):Je}}function tt(Tt,ve,Ae){return{type:"Feature",id:Tt[ve+At],properties:xt(Tt,ve,Ae),geometry:{type:"Point",coordinates:[(ke=Tt[ve],360*(ke-.5)),cr(Tt[ve+1])]}};var ke}function xt(Tt,ve,Ae){const ke=Tt[ve+qr],Ze=ke>=1e4?`${Math.round(ke/1e3)}k`:ke>=1e3?Math.round(ke/100)/10+"k":ke,Je=Tt[ve+an],at=Je===-1?{}:Object.assign({},Ae[Je]);return Object.assign(at,{cluster:!0,cluster_id:Tt[ve+At],point_count:ke,point_count_abbreviated:Ze})}function Mt(Tt){return Tt/360+.5}function lr(Tt){const ve=Math.sin(Tt*Math.PI/180),Ae=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return Ae<0?0:Ae>1?1:Ae}function cr(Tt){const ve=(180-360*Tt)*Math.PI/180;return 360*Math.atan(Math.exp(ve))/Math.PI-90}function xr(Tt,ve,Ae,ke){let Ze=ke;const Je=ve+(Ae-ve>>1);let at,gt=Ae-ve;const lt=Tt[ve],St=Tt[ve+1],wt=Tt[Ae],Pt=Tt[Ae+1];for(let Vt=ve+3;Vt<Ae;Vt+=3){const ar=ur(Tt[Vt],Tt[Vt+1],lt,St,wt,Pt);if(ar>Ze)at=Vt,Ze=ar;else if(ar===Ze){const or=Math.abs(Vt-Je);or<gt&&(at=Vt,gt=or)}}Ze>ke&&(at-ve>3&&xr(Tt,ve,at,ke),Tt[at+2]=Ze,Ae-at>3&&xr(Tt,at,Ae,ke))}function ur(Tt,ve,Ae,ke,Ze,Je){let at=Ze-Ae,gt=Je-ke;if(at!==0||gt!==0){const lt=((Tt-Ae)*at+(ve-ke)*gt)/(at*at+gt*gt);lt>1?(Ae=Ze,ke=Je):lt>0&&(Ae+=at*lt,ke+=gt*lt)}return at=Tt-Ae,gt=ve-ke,at*at+gt*gt}function tn(Tt,ve,Ae,ke){const Ze={id:Tt??null,type:ve,geometry:Ae,tags:ke,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ve==="Point"||ve==="MultiPoint"||ve==="LineString")Gn(Ze,Ae);else if(ve==="Polygon")Gn(Ze,Ae[0]);else if(ve==="MultiLineString")for(const Je of Ae)Gn(Ze,Je);else if(ve==="MultiPolygon")for(const Je of Ae)Gn(Ze,Je[0]);return Ze}function Gn(Tt,ve){for(let Ae=0;Ae<ve.length;Ae+=3)Tt.minX=Math.min(Tt.minX,ve[Ae]),Tt.minY=Math.min(Tt.minY,ve[Ae+1]),Tt.maxX=Math.max(Tt.maxX,ve[Ae]),Tt.maxY=Math.max(Tt.maxY,ve[Ae+1])}function gi(Tt,ve,Ae,ke){if(!ve.geometry)return;const Ze=ve.geometry.coordinates;if(Ze&&Ze.length===0)return;const Je=ve.geometry.type,at=Math.pow(Ae.tolerance/((1<<Ae.maxZoom)*Ae.extent),2);let gt=[],lt=ve.id;if(Ae.promoteId?lt=ve.properties[Ae.promoteId]:Ae.generateId&&(lt=ke||0),Je==="Point")Ui(Ze,gt);else if(Je==="MultiPoint")for(const St of Ze)Ui(St,gt);else if(Je==="LineString")uo(Ze,gt,at,!1);else if(Je==="MultiLineString"){if(Ae.lineMetrics){for(const St of Ze)gt=[],uo(St,gt,at,!1),Tt.push(tn(lt,"LineString",gt,ve.properties));return}Va(Ze,gt,at,!1)}else if(Je==="Polygon")Va(Ze,gt,at,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(const St of ve.geometry.geometries)gi(Tt,{id:lt,geometry:St,properties:ve.properties},Ae,ke);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const St of Ze){const wt=[];Va(St,wt,at,!0),gt.push(wt)}}Tt.push(tn(lt,Je,gt,ve.properties))}function Ui(Tt,ve){ve.push(Ks(Tt[0]),To(Tt[1]),0)}function uo(Tt,ve,Ae,ke){let Ze,Je,at=0;for(let lt=0;lt<Tt.length;lt++){const St=Ks(Tt[lt][0]),wt=To(Tt[lt][1]);ve.push(St,wt,0),lt>0&&(at+=ke?(Ze*wt-St*Je)/2:Math.sqrt(Math.pow(St-Ze,2)+Math.pow(wt-Je,2))),Ze=St,Je=wt}const gt=ve.length-3;ve[2]=1,xr(ve,0,gt,Ae),ve[gt+2]=1,ve.size=Math.abs(at),ve.start=0,ve.end=ve.size}function Va(Tt,ve,Ae,ke){for(let Ze=0;Ze<Tt.length;Ze++){const Je=[];uo(Tt[Ze],Je,Ae,ke),ve.push(Je)}}function Ks(Tt){return Tt/360+.5}function To(Tt){const ve=Math.sin(Tt*Math.PI/180),Ae=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return Ae<0?0:Ae>1?1:Ae}function es(Tt,ve,Ae,ke,Ze,Je,at,gt){if(ke/=ve,Je>=(Ae/=ve)&&at<ke)return Tt;if(at<Ae||Je>=ke)return null;const lt=[];for(const St of Tt){const wt=St.geometry;let Pt=St.type;const Vt=Ze===0?St.minX:St.minY,ar=Ze===0?St.maxX:St.maxY;if(Vt>=Ae&&ar<ke){lt.push(St);continue}if(ar<Ae||Vt>=ke)continue;let or=[];if(Pt==="Point"||Pt==="MultiPoint")rc(wt,or,Ae,ke,Ze);else if(Pt==="LineString")kl(wt,or,Ae,ke,Ze,!1,gt.lineMetrics);else if(Pt==="MultiLineString")nc(wt,or,Ae,ke,Ze,!1);else if(Pt==="Polygon")nc(wt,or,Ae,ke,Ze,!0);else if(Pt==="MultiPolygon")for(const Ar of wt){const Gr=[];nc(Ar,Gr,Ae,ke,Ze,!0),Gr.length&&or.push(Gr)}if(or.length){if(gt.lineMetrics&&Pt==="LineString"){for(const Ar of or)lt.push(tn(St.id,Pt,Ar,St.tags));continue}Pt!=="LineString"&&Pt!=="MultiLineString"||(or.length===1?(Pt="LineString",or=or[0]):Pt="MultiLineString"),Pt!=="Point"&&Pt!=="MultiPoint"||(Pt=or.length===3?"Point":"MultiPoint"),lt.push(tn(St.id,Pt,or,St.tags))}}return lt.length?lt:null}function rc(Tt,ve,Ae,ke,Ze){for(let Je=0;Je<Tt.length;Je+=3){const at=Tt[Je+Ze];at>=Ae&&at<=ke&&sn(ve,Tt[Je],Tt[Je+1],Tt[Je+2])}}function kl(Tt,ve,Ae,ke,Ze,Je,at){let gt=Fs(Tt);const lt=Ze===0?ts:Uu;let St,wt,Pt=Tt.start;for(let Gr=0;Gr<Tt.length-3;Gr+=3){const $r=Tt[Gr],Ur=Tt[Gr+1],On=Tt[Gr+2],Kn=Tt[Gr+3],wn=Tt[Gr+4],Un=Ze===0?$r:Ur,Rn=Ze===0?Kn:wn;let ja=!1;at&&(St=Math.sqrt(Math.pow($r-Kn,2)+Math.pow(Ur-wn,2))),Un<Ae?Rn>Ae&&(wt=lt(gt,$r,Ur,Kn,wn,Ae),at&&(gt.start=Pt+St*wt)):Un>ke?Rn<ke&&(wt=lt(gt,$r,Ur,Kn,wn,ke),at&&(gt.start=Pt+St*wt)):sn(gt,$r,Ur,On),Rn<Ae&&Un>=Ae&&(wt=lt(gt,$r,Ur,Kn,wn,Ae),ja=!0),Rn>ke&&Un<=ke&&(wt=lt(gt,$r,Ur,Kn,wn,ke),ja=!0),!Je&&ja&&(at&&(gt.end=Pt+St*wt),ve.push(gt),gt=Fs(Tt)),at&&(Pt+=St)}let Vt=Tt.length-3;const ar=Tt[Vt],or=Tt[Vt+1],Ar=Ze===0?ar:or;Ar>=Ae&&Ar<=ke&&sn(gt,ar,or,Tt[Vt+2]),Vt=gt.length-3,Je&&Vt>=3&&(gt[Vt]!==gt[0]||gt[Vt+1]!==gt[1])&&sn(gt,gt[0],gt[1],gt[2]),gt.length&&ve.push(gt)}function Fs(Tt){const ve=[];return ve.size=Tt.size,ve.start=Tt.start,ve.end=Tt.end,ve}function nc(Tt,ve,Ae,ke,Ze,Je){for(const at of Tt)kl(at,ve,Ae,ke,Ze,Je,!1)}function sn(Tt,ve,Ae,ke){Tt.push(ve,Ae,ke)}function ts(Tt,ve,Ae,ke,Ze,Je){const at=(Je-ve)/(ke-ve);return sn(Tt,Je,Ae+(Ze-Ae)*at,1),at}function Uu(Tt,ve,Ae,ke,Ze,Je){const at=(Je-Ae)/(Ze-Ae);return sn(Tt,ve+(ke-ve)*at,Je,1),at}function Ua(Tt,ve){const Ae=[];for(let ke=0;ke<Tt.length;ke++){const Ze=Tt[ke],Je=Ze.type;let at;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")at=Zs(Ze.geometry,ve);else if(Je==="MultiLineString"||Je==="Polygon"){at=[];for(const gt of Ze.geometry)at.push(Zs(gt,ve))}else if(Je==="MultiPolygon"){at=[];for(const gt of Ze.geometry){const lt=[];for(const St of gt)lt.push(Zs(St,ve));at.push(lt)}}Ae.push(tn(Ze.id,Je,at,Ze.tags))}return Ae}function Zs(Tt,ve){const Ae=[];Ae.size=Tt.size,Tt.start!==void 0&&(Ae.start=Tt.start,Ae.end=Tt.end);for(let ke=0;ke<Tt.length;ke+=3)Ae.push(Tt[ke]+ve,Tt[ke+1],Tt[ke+2]);return Ae}function Wn(Tt,ve){if(Tt.transformed)return Tt;const Ae=1<<Tt.z,ke=Tt.x,Ze=Tt.y;for(const Je of Tt.features){const at=Je.geometry,gt=Je.type;if(Je.geometry=[],gt===1)for(let lt=0;lt<at.length;lt+=2)Je.geometry.push(fa(at[lt],at[lt+1],ve,Ae,ke,Ze));else for(let lt=0;lt<at.length;lt++){const St=[];for(let wt=0;wt<at[lt].length;wt+=2)St.push(fa(at[lt][wt],at[lt][wt+1],ve,Ae,ke,Ze));Je.geometry.push(St)}}return Tt.transformed=!0,Tt}function fa(Tt,ve,Ae,ke,Ze,Je){return[Math.round(Ae*(Tt*ke-Ze)),Math.round(Ae*(ve*ke-Je))]}function Pa(Tt,ve,Ae,ke,Ze){const Je=ve===Ze.maxZoom?0:Ze.tolerance/((1<<ve)*Ze.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:Tt.length,source:null,x:Ae,y:ke,z:ve,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const gt of Tt)Cs(at,gt,Je,Ze);return at}function Cs(Tt,ve,Ae,ke){const Ze=ve.geometry,Je=ve.type,at=[];if(Tt.minX=Math.min(Tt.minX,ve.minX),Tt.minY=Math.min(Tt.minY,ve.minY),Tt.maxX=Math.max(Tt.maxX,ve.maxX),Tt.maxY=Math.max(Tt.maxY,ve.maxY),Je==="Point"||Je==="MultiPoint")for(let gt=0;gt<Ze.length;gt+=3)at.push(Ze[gt],Ze[gt+1]),Tt.numPoints++,Tt.numSimplified++;else if(Je==="LineString")El(at,Ze,Tt,Ae,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(let gt=0;gt<Ze.length;gt++)El(at,Ze[gt],Tt,Ae,Je==="Polygon",gt===0);else if(Je==="MultiPolygon")for(let gt=0;gt<Ze.length;gt++){const lt=Ze[gt];for(let St=0;St<lt.length;St++)El(at,lt[St],Tt,Ae,!0,St===0)}if(at.length){let gt=ve.tags||null;if(Je==="LineString"&&ke.lineMetrics){gt={};for(const St in ve.tags)gt[St]=ve.tags[St];gt.mapbox_clip_start=Ze.start/Ze.size,gt.mapbox_clip_end=Ze.end/Ze.size}const lt={geometry:at,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:gt};ve.id!==null&&(lt.id=ve.id),Tt.features.push(lt)}}function El(Tt,ve,Ae,ke,Ze,Je){const at=ke*ke;if(ke>0&&ve.size<(Ze?at:ke))return void(Ae.numPoints+=ve.length/3);const gt=[];for(let lt=0;lt<ve.length;lt+=3)(ke===0||ve[lt+2]>at)&&(Ae.numSimplified++,gt.push(ve[lt],ve[lt+1])),Ae.numPoints++;Ze&&function(lt,St){let wt=0;for(let Pt=0,Vt=lt.length,ar=Vt-2;Pt<Vt;ar=Pt,Pt+=2)wt+=(lt[Pt]-lt[ar])*(lt[Pt+1]+lt[ar+1]);if(wt>0===St)for(let Pt=0,Vt=lt.length;Pt<Vt/2;Pt+=2){const ar=lt[Pt],or=lt[Pt+1];lt[Pt]=lt[Vt-2-Pt],lt[Pt+1]=lt[Vt-1-Pt],lt[Vt-2-Pt]=ar,lt[Vt-1-Pt]=or}}(gt,Je),Tt.push(gt)}const Na={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Bs{constructor(ve,Ae){const ke=(Ae=this.options=function(Je,at){for(const gt in at)Je[gt]=at[gt];return Je}(Object.create(Na),Ae)).debug;if(ke&&console.time("preprocess data"),Ae.maxZoom<0||Ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ae.promoteId&&Ae.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ze=function(Je,at){const gt=[];if(Je.type==="FeatureCollection")for(let lt=0;lt<Je.features.length;lt++)gi(gt,Je.features[lt],at,lt);else gi(gt,Je.type==="Feature"?Je:{geometry:Je},at);return gt}(ve,Ae);this.tiles={},this.tileCoords=[],ke&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ae.indexMaxZoom,Ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ze=function(Je,at){const gt=at.buffer/at.extent;let lt=Je;const St=es(Je,1,-1-gt,gt,0,-1,2,at),wt=es(Je,1,1-gt,2+gt,0,-1,2,at);return(St||wt)&&(lt=es(Je,1,-gt,1+gt,0,-1,2,at)||[],St&&(lt=Ua(St,1).concat(lt)),wt&&(lt=lt.concat(Ua(wt,-1)))),lt}(Ze,Ae),Ze.length&&this.splitTile(Ze,0,0,0),ke&&(Ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ve,Ae,ke,Ze,Je,at,gt){const lt=[ve,Ae,ke,Ze],St=this.options,wt=St.debug;for(;lt.length;){Ze=lt.pop(),ke=lt.pop(),Ae=lt.pop(),ve=lt.pop();const Pt=1<<Ae,Vt=$i(Ae,ke,Ze);let ar=this.tiles[Vt];if(!ar&&(wt>1&&console.time("creation"),ar=this.tiles[Vt]=Pa(ve,Ae,ke,Ze,St),this.tileCoords.push({z:Ae,x:ke,y:Ze}),wt)){wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ae,ke,Ze,ar.numFeatures,ar.numPoints,ar.numSimplified),console.timeEnd("creation"));const ja=`z${Ae}`;this.stats[ja]=(this.stats[ja]||0)+1,this.total++}if(ar.source=ve,Je==null){if(Ae===St.indexMaxZoom||ar.numPoints<=St.indexMaxPoints)continue}else{if(Ae===St.maxZoom||Ae===Je)continue;if(Je!=null){const ja=Je-Ae;if(ke!==at>>ja||Ze!==gt>>ja)continue}}if(ar.source=null,ve.length===0)continue;wt>1&&console.time("clipping");const or=.5*St.buffer/St.extent,Ar=.5-or,Gr=.5+or,$r=1+or;let Ur=null,On=null,Kn=null,wn=null,Un=es(ve,Pt,ke-or,ke+Gr,0,ar.minX,ar.maxX,St),Rn=es(ve,Pt,ke+Ar,ke+$r,0,ar.minX,ar.maxX,St);ve=null,Un&&(Ur=es(Un,Pt,Ze-or,Ze+Gr,1,ar.minY,ar.maxY,St),On=es(Un,Pt,Ze+Ar,Ze+$r,1,ar.minY,ar.maxY,St),Un=null),Rn&&(Kn=es(Rn,Pt,Ze-or,Ze+Gr,1,ar.minY,ar.maxY,St),wn=es(Rn,Pt,Ze+Ar,Ze+$r,1,ar.minY,ar.maxY,St),Rn=null),wt>1&&console.timeEnd("clipping"),lt.push(Ur||[],Ae+1,2*ke,2*Ze),lt.push(On||[],Ae+1,2*ke,2*Ze+1),lt.push(Kn||[],Ae+1,2*ke+1,2*Ze),lt.push(wn||[],Ae+1,2*ke+1,2*Ze+1)}}getTile(ve,Ae,ke){ve=+ve,Ae=+Ae,ke=+ke;const Ze=this.options,{extent:Je,debug:at}=Ze;if(ve<0||ve>24)return null;const gt=1<<ve,lt=$i(ve,Ae=Ae+gt&gt-1,ke);if(this.tiles[lt])return Wn(this.tiles[lt],Je);at>1&&console.log("drilling down to z%d-%d-%d",ve,Ae,ke);let St,wt=ve,Pt=Ae,Vt=ke;for(;!St&&wt>0;)wt--,Pt>>=1,Vt>>=1,St=this.tiles[$i(wt,Pt,Vt)];return St&&St.source?(at>1&&(console.log("found parent tile z%d-%d-%d",wt,Pt,Vt),console.time("drilling down")),this.splitTile(St.source,wt,Pt,Vt,ve,Ae,ke),at>1&&console.timeEnd("drilling down"),this.tiles[lt]?Wn(this.tiles[lt],Je):null):null}}function $i(Tt,ve,Ae){return 32*((1<<Tt)*Ae+ve)+Tt}function ks(Tt,ve){const Ae=Tt.tileID.canonical;if(!this._geoJSONIndex)return void ve(null,null);const ke=this._geoJSONIndex.getTile(Ae.z,Ae.x,Ae.y);if(!ke)return void ve(null,null);const Ze=new Ce(ke.features);let Je=De(Ze);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),ve(null,{vectorTile:Ze,rawData:Je.buffer})}class ms extends Pe{constructor(ve,Ae,ke,Ze,Je,at){super(ve,Ae,ke,Ze,ks,at),Je&&(this.loadGeoJSON=Je),this._dynamicIndex=new Re}loadData(ve,Ae){const ke=ve&&ve.request,Ze=ke&&ke.collectResourceTiming;this.loadGeoJSON(ve,(Je,at)=>{if(Je||!at)return Ae(Je);if(typeof at!="object")return Ae(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));{try{if(ve.filter){const lt=i.U(ve.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(lt.result==="error")throw new Error(lt.value.map(St=>`${St.key}: ${St.message}`).join(", "));at.features=at.features.filter(St=>lt.value.evaluate({zoom:0},St))}ve.dynamic?(at.type==="Feature"&&(at={type:"FeatureCollection",features:[at]}),ve.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(at.features,this.loaded),ve.cluster&&(at.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ve.cluster?new Jn(function({superclusterOptions:lt,clusterProperties:St}){if(!St||!lt)return lt;const wt={},Pt={},Vt={accumulated:null,zoom:0},ar={properties:null},or=Object.keys(St);for(const Ar of or){const[Gr,$r]=St[Ar],Ur=i.U($r),On=i.U(typeof Gr=="string"?[Gr,["accumulated"],["get",Ar]]:Gr);wt[Ar]=Ur.value,Pt[Ar]=On.value}return lt.map=Ar=>{ar.properties=Ar;const Gr={};for(const $r of or)Gr[$r]=wt[$r].evaluate(Vt,ar);return Gr},lt.reduce=(Ar,Gr)=>{ar.properties=Gr;for(const $r of or)Vt.accumulated=Ar[$r],Ar[$r]=Pt[$r].evaluate(Vt,ar)},lt}(ve)).load(at.features):ve.dynamic?this._dynamicIndex:function(lt,St){return new Bs(lt,St)}(at,ve.geojsonVtOptions)}catch(lt){return Ae(lt)}const gt={};if(Ze){const lt=x(ke);lt&&(gt.resourceTiming={},gt.resourceTiming[ve.source]=JSON.parse(JSON.stringify(lt)))}Ae(null,gt)}})}reloadTile(ve,Ae){const ke=this.loaded;return ke&&ke[ve.uid]?ve.partial?Ae(null,void 0):super.reloadTile(ve,Ae):this.loadTile(ve,Ae)}loadGeoJSON(ve,Ae){if(ve.request)i.n(ve.request,Ae);else{if(typeof ve.data!="string")return Ae(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`));try{return Ae(null,JSON.parse(ve.data))}catch{return Ae(new Error(`Input data given to '${ve.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ve,Ae){try{Ae(null,this._geoJSONIndex.getClusterExpansionZoom(ve.clusterId))}catch(ke){Ae(ke)}}getClusterChildren(ve,Ae){try{Ae(null,this._geoJSONIndex.getChildren(ve.clusterId))}catch(ke){Ae(ke)}}getClusterLeaves(ve,Ae){try{Ae(null,this._geoJSONIndex.getLeaves(ve.clusterId,ve.limit,ve.offset))}catch(ke){Ae(ke)}}}class $u{constructor(ve,Ae){this.tileID=new i.aG(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),this.tileZoom=ve.tileZoom,this.uid=ve.uid,this.zoom=ve.zoom,this.canonical=ve.tileID.canonical,this.pixelRatio=ve.pixelRatio,this.tileSize=ve.tileSize,this.source=ve.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ve.projection,this.brightness=Ae}parse(ve,Ae,ke,Ze){this.status="parsing";const Je=new i.aG(ke.tileID.overscaledZ,ke.tileID.wrap,ke.tileID.canonical.z,ke.tileID.canonical.x,ke.tileID.canonical.y),at=[],gt=Ae.familiesBySource[ke.source],lt=new i.d$(Je,ke.promoteId);return lt.bucketLayerIDs=[],lt.is3DTile=!0,i.ea(ve).then(St=>{if(!St)return Ze(new Error("Could not parse tile"));const wt=i.eb(St,1/i.cc(ke.tileID.canonical)),Pt=St.json.extensionsUsed&&St.json.extensionsUsed.includes("MAPBOX_mesh_features")||St.json.asset.extras&&St.json.asset.extras.MAPBOX_mesh_features,Vt=St.json.extensionsUsed&&St.json.extensionsUsed.includes("EXT_meshopt_compression"),ar=new i.a8(this.zoom,{brightness:this.brightness});for(const or in gt)for(const Ar of gt[or]){const Gr=Ar[0];lt.bucketLayerIDs.push(Ar.map(Ur=>i.aC(Ur.id,Ur.scope))),Gr.recalculate(ar,[]);const $r=new i.ec(Ar,wt,Je,Pt,Vt,this.brightness,lt);Pt||($r.needsUpload=!0),at.push($r),$r.evaluate(Gr)}this.status="done",Ze(null,{buckets:at,featureIndex:lt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(St=>Ze(new Error(St.message)))}}class Ki{constructor(ve,Ae,ke,Ze,Je,at){this.actor=ve,this.layerIndex=Ae,this.availableImages=ke,this.brightness=at,this.loading={},this.loaded={}}loadTile(ve,Ae){const ke=ve.uid,Ze=this.loading[ke]=new $u(ve,this.brightness);i.bi(ve.request,(Je,at)=>{const gt=!this.loading[ke];return delete this.loading[ke],gt||Je?(Ze.status="done",gt||(this.loaded[ke]=Ze),Ae(Je)):at&&at.byteLength!==0?void Ze.parse(at,this.layerIndex,ve,(lt,St)=>{Ze.status="done",this.loaded=this.loaded||{},this.loaded[ke]=Ze,lt||!St?Ae(lt):Ae(null,St)}):(Ze.status="done",this.loaded[ke]=Ze,Ae())})}reloadTile(ve,Ae){const ke=this.loaded,Ze=ve.uid;if(ke&&ke[Ze]){const Je=ke[Ze];Je.projection=ve.projection,Je.brightness=ve.brightness;const at=(gt,lt)=>{Je.reloadCallback&&(delete Je.reloadCallback,this.loadTile(ve,Ae)),Ae(gt,lt)};Je.status==="parsing"?Je.reloadCallback=at:Je.status==="done"&&this.loadTile(ve,Ae)}}abortTile(ve,Ae){const ke=ve.uid;this.loading[ke]&&delete this.loading[ke],Ae()}removeTile(ve,Ae){const ke=this.loaded,Ze=ve.uid;ke&&ke[Ze]&&delete ke[Ze],Ae()}}class Go{constructor(ve){this.self=ve,this.actor=new i.ed(ve,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bP({name:"mercator"}),this.workerSourceTypes={vector:Pe,geojson:ms,"batched-model":Ki},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ae,ke)=>{if(this.workerSourceTypes[Ae])throw new Error(`Worker source with name "${Ae}" already registered.`);this.workerSourceTypes[Ae]=ke},this.self.registerRTLTextPlugin=Ae=>{if(i.ee.isParsed())throw new Error("RTL text plugin already registered.");i.ee.applyArabicShaping=Ae.applyArabicShaping,i.ee.processBidirectionalText=Ae.processBidirectionalText,i.ee.processStyledBidirectionalText=Ae.processStyledBidirectionalText}}clearCaches(ve,Ae,ke){delete this.layerIndexes[ve],delete this.availableImages[ve],delete this.workerSources[ve],delete this.demWorkerSources[ve],delete this.rasterArrayWorkerSource,ke()}checkIfReady(ve,Ae,ke){ke()}setReferrer(ve,Ae){this.referrer=Ae}spriteLoaded(ve,{scope:Ae,isLoaded:ke}){if(this.isSpriteLoaded[ve]||(this.isSpriteLoaded[ve]={}),this.isSpriteLoaded[ve][Ae]=ke,this.workerSources[ve]&&this.workerSources[ve][Ae])for(const Ze in this.workerSources[ve][Ae]){const Je=this.workerSources[ve][Ae][Ze];for(const at in Je){const gt=Je[at];gt instanceof Pe&&(gt.isSpriteLoaded=ke,gt.fire(new i.z("isSpriteLoaded")))}}}setImages(ve,{scope:Ae,images:ke},Ze){if(this.availableImages[ve]||(this.availableImages[ve]={}),this.availableImages[ve][Ae]=ke,this.workerSources[ve]&&this.workerSources[ve][Ae]){for(const Je in this.workerSources[ve][Ae]){const at=this.workerSources[ve][Ae][Je];for(const gt in at)at[gt].availableImages=ke}Ze()}else Ze()}setProjection(ve,Ae){this.projections[ve]=i.bP(Ae)}setBrightness(ve,Ae,ke){this.brightness=Ae,ke()}setLayers(ve,Ae,ke){this.getLayerIndex(ve,Ae.scope).replace(Ae.layers,Ae.options),ke()}updateLayers(ve,Ae,ke){this.getLayerIndex(ve,Ae.scope).update(Ae.layers,Ae.removedIds,Ae.options),ke()}loadTile(ve,Ae,ke){Ae.projection=this.projections[ve]||this.defaultProjection,this.getWorkerSource(ve,Ae.type,Ae.source,Ae.scope).loadTile(Ae,ke)}loadDEMTile(ve,Ae,ke){this.getDEMWorkerSource(ve,Ae.source,Ae.scope).loadTile(Ae,ke)}decodeRasterArray(ve,Ae,ke){this.getRasterArrayWorkerSource().decodeRasterArray(Ae,ke)}reloadTile(ve,Ae,ke){Ae.projection=this.projections[ve]||this.defaultProjection,this.getWorkerSource(ve,Ae.type,Ae.source,Ae.scope).reloadTile(Ae,ke)}abortTile(ve,Ae,ke){this.getWorkerSource(ve,Ae.type,Ae.source,Ae.scope).abortTile(Ae,ke)}removeTile(ve,Ae,ke){this.getWorkerSource(ve,Ae.type,Ae.source,Ae.scope).removeTile(Ae,ke)}removeSource(ve,Ae,ke){if(!(this.workerSources[ve]&&this.workerSources[ve][Ae.scope]&&this.workerSources[ve][Ae.scope][Ae.type]&&this.workerSources[ve][Ae.scope][Ae.type][Ae.source]))return;const Ze=this.workerSources[ve][Ae.scope][Ae.type][Ae.source];delete this.workerSources[ve][Ae.scope][Ae.type][Ae.source],Ze.removeSource!==void 0?Ze.removeSource(Ae,ke):ke()}loadWorkerSource(ve,Ae,ke){try{this.self.importScripts(Ae.url),ke()}catch(Ze){ke(Ze.toString())}}syncRTLPluginState(ve,Ae,ke){try{i.ee.setState(Ae);const Ze=i.ee.getPluginURL();if(i.ee.isLoaded()&&!i.ee.isParsed()&&Ze!=null){this.self.importScripts(Ze);const Je=i.ee.isParsed();ke(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ze}`),Je)}}catch(Ze){ke(Ze.toString())}}setDracoUrl(ve,Ae){this.dracoUrl=Ae}getAvailableImages(ve,Ae){this.availableImages[ve]||(this.availableImages[ve]={});let ke=this.availableImages[ve][Ae];return ke||(ke=[]),ke}getLayerIndex(ve,Ae){this.layerIndexes[ve]||(this.layerIndexes[ve]={});let ke=this.layerIndexes[ve][Ae];return ke||(ke=this.layerIndexes[ve][Ae]=new P,ke.scope=Ae),ke}getWorkerSource(ve,Ae,ke,Ze){return this.workerSources[ve]||(this.workerSources[ve]={}),this.workerSources[ve][Ze]||(this.workerSources[ve][Ze]={}),this.workerSources[ve][Ze][Ae]||(this.workerSources[ve][Ze][Ae]={}),this.isSpriteLoaded[ve]||(this.isSpriteLoaded[ve]={}),this.workerSources[ve][Ze][Ae][ke]||(this.workerSources[ve][Ze][Ae][ke]=new this.workerSourceTypes[Ae]({send:(Je,at,gt,lt,St,wt)=>{this.actor.send(Je,at,gt,ve,St,wt)},scheduler:this.actor.scheduler},this.getLayerIndex(ve,Ze),this.getAvailableImages(ve,Ze),this.isSpriteLoaded[ve][Ze],void 0,this.brightness)),this.workerSources[ve][Ze][Ae][ke]}rasterizeImages(ve,Ae,ke){const{imageTasks:Ze,scope:Je}=Ae,at={};for(const gt in Ze){const{image:lt,imageIdWithOptions:St}=Ze[gt];at[gt]=this.imageRasterizer.rasterize(St,lt,Je,ve)}ke(void 0,at)}removeRasterizedImages(ve,Ae,ke){const{imageIds:Ze,scope:Je}=Ae;this.imageRasterizer.removeImagesFromCacheByIds(Ze,Je,ve),ke()}getDEMWorkerSource(ve,Ae,ke){return this.demWorkerSources[ve]||(this.demWorkerSources[ve]={}),this.demWorkerSources[ve][ke]||(this.demWorkerSources[ve][ke]={}),this.demWorkerSources[ve][ke][Ae]||(this.demWorkerSources[ve][ke][Ae]=new Ne),this.demWorkerSources[ve][ke][Ae]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new pe),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ve,Ae){i.ef(Ae)}getWorkerPerformanceMetrics(ve,Ae,ke){ke(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Go(self)),Go}),c(["./shared"],function(i){var x="3.10.0";const w={create:"create",load:"load",fullLoad:"fullLoad"},A={mark(g){performance.mark(g)},measure(g,o,d){performance.measure(g,o,d)}};function P(g){const o=g.name.split("?")[0];return i.a(o)&&o.includes("mapbox-gl.js")?"javascript":i.a(o)&&o.includes("mapbox-gl.css")?"css":i.b(o)?"fontRange":i.c(o)?"sprite":i.i(o)?"style":i.d(o)?"tilejson":"other"}var E,D={},V=function(){if(E)return D;function g(y){return!o(y)}function o(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var N,k,z=new Blob([""],{type:"text/javascript"}),G=URL.createObjectURL(z);try{k=new Worker(G),N=!0}catch{N=!1}return k&&k.terminate(),URL.revokeObjectURL(G),N}()?function(){var N=document.createElement("canvas");N.width=N.height=1;var k=N.getContext("2d");if(!k)return!1;var z=k.getImageData(0,0,1,1);return z&&z.width===N.width}()?(d[S=y&&y.failIfMajorPerformanceCaveat]===void 0&&(d[S]=function(N){var k,z=function(G){var Z=document.createElement("canvas"),Y=Object.create(g.webGLContextAttributes);return Y.failIfMajorPerformanceCaveat=G,Z.getContext("webgl2",Y)}(N);if(!z)return!1;try{k=z.createShader(z.VERTEX_SHADER)}catch{return!1}return!(!k||z.isContextLost())&&(z.shaderSource(k,"void main() {}"),z.compileShader(k),z.getShaderParameter(k,z.COMPILE_STATUS)===!0)}(S)),d[S]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var S}E=1,D.supported=g,D.notSupportedReason=o;var d={};return g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},D}();function L(g,o,d){const y=document.createElement(g);return o!=null&&(y.className=o),d&&d.appendChild(y),y}function $(g,o,d){const y=document.createElementNS("http://www.w3.org/2000/svg",g);for(const S of Object.keys(o))y.setAttributeNS(null,S,String(o[S]));return d&&d.appendChild(y),y}const H=typeof document<"u"?document.documentElement&&document.documentElement.style:null,K=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Q;function ae(){H&&K&&(Q=H[K],H[K]="none")}function ee(){H&&K&&(H[K]=Q)}function se(g){g.preventDefault(),g.stopPropagation(),window.removeEventListener("click",se,!0)}function ce(){window.addEventListener("click",se,!0),window.setTimeout(()=>{window.removeEventListener("click",se,!0)},0)}function he(g,o){const d=g.getBoundingClientRect();return pe(g,d,o)}function Pe(g,o){const d=g.getBoundingClientRect(),y=[];for(let S=0;S<o.length;S++)y.push(pe(g,d,o[S]));return y}function Ne(g){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&g.button===2&&g.ctrlKey?0:g.button}function pe(g,o,d){const y=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new i.P((d.clientX-o.left)*y,(d.clientY-o.top)*y)}const je="01",xe="NO_ACCESS_TOKEN";class Ce{constructor(o,d,y){this._transformRequestFn=o,this._customAccessToken=d,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const o=function(){let d="";for(let y=0;y<10;y++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",je,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,d){return this._transformRequestFn&&this._transformRequestFn(o,d)||{url:o}}normalizeStyleURL(o,d){if(!i.f(o))return o;const y=Te(o);return y.params.push(`sdk=js-${x}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeGlyphsURL(o,d){if(!i.f(o))return o;const y=Te(o);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeModelURL(o,d){if(!i.f(o))return o;const y=Te(o);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||d)}normalizeSourceURL(o,d,y,S){if(!i.f(o))return o;const N=Te(o);return N.path=`/v4/${N.authority}.json`,N.params.push("secure"),y&&N.params.push(`language=${y}`),S&&N.params.push(`worldview=${S}`),this._makeAPIURL(N,this._customAccessToken||d)}normalizeIconsetURL(o,d){const y=Te(o);return i.f(o)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||d)):Re(y)}normalizeSpriteURL(o,d,y,S){const N=Te(o);return i.f(o)?(N.path=`/styles/v1${N.path}/sprite${d}${y}`,this._makeAPIURL(N,this._customAccessToken||S)):(N.path+=`${d}${y}`,Re(N))}normalizeTileURL(o,d,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!i.f(o))return o;const S=Te(o);S.path=S.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${d||y&&S.authority!=="raster"&&y===512?"@2x":""}${i.m.supported?".webp":"$1"}`),S.authority==="raster"?S.path=`/${i.e.RASTER_URL_PREFIX}${S.path}`:S.authority==="rasterarrays"?S.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${S.path}`:S.authority==="3dtiles"?S.path=`/${i.e.TILES3D_URL_PREFIX}${S.path}`:(S.path=S.path.replace(/^.+\/v4\//,"/"),S.path=`/${i.e.TILE_URL_VERSION}${S.path}`);const N=this._customAccessToken||function(k){for(const z of k){const G=z.match(/^access_token=(.*)$/);if(G)return G[1]}return null}(S.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&N&&this._skuToken&&S.params.push(`sku=${this._skuToken}`),this._makeAPIURL(S,N)}canonicalizeTileURL(o,d){const y=Te(o);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return o;let S="mapbox://";y.path.match(/^\/raster\/v1\//)?S+=`raster/${y.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?S+=`rasterarrays/${y.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:S+=`tiles/${y.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let N=y.params;return d&&(N=N.filter(k=>!k.match(/^access_token=/))),N.length&&(S+=`?${N.join("&")}`),S}canonicalizeTileset(o,d){const y=!!d&&i.f(d),S=[];for(const N of o.tiles||[])i.h(N)?S.push(this.canonicalizeTileURL(N,y)):S.push(N);return S}_makeAPIURL(o,d){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",S=Te(i.e.API_URL);if(o.protocol=S.protocol,o.authority=S.authority,o.protocol==="http"){const N=o.params.indexOf("secure");N>=0&&o.params.splice(N,1)}if(S.path!=="/"&&(o.path=`${S.path}${o.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Re(o);if(d=d||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!d)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(d[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return o.params=o.params.filter(N=>N.indexOf("access_token")===-1),o.params.push(`access_token=${d||""}`),Re(o)}}const ze=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Te(g){const o=g.match(ze);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Re(g){const o=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${o}`}const Fe="mapbox.eventData";function He(g){if(!g)return null;const o=g.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(i.j(o[1]))}catch{return null}}class mt{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const d=He(i.e.ACCESS_TOKEN);let y="";return y=d&&d.u?i.k(d.u):i.e.ACCESS_TOKEN||"",o?`${Fe}.${o}:${y}`:`${Fe}:${y}`}fetchEventData(){const o=i.s("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(o)try{const S=localStorage.getItem(d);S&&(this.eventData=JSON.parse(S));const N=localStorage.getItem(y);N&&(this.anonId=N)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const o=i.s("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid"),S=this.anonId;if(o&&S)try{localStorage.setItem(y,S),Object.keys(this.eventData).length>=1&&localStorage.setItem(d,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,d,y,S){if(!i.e.EVENTS_URL)return;const N=Te(i.e.EVENTS_URL);N.params.push(`access_token=${S||i.e.ACCESS_TOKEN||""}`);const k={event:this.type,created:new Date(o).toISOString()},z=d?i.l(k,d):k,G={url:Re(N),headers:{"Content-Type":"text/plain"},body:JSON.stringify([z])};this.pendingRequest=i.p(G,Z=>{this.pendingRequest=null,y(Z),this.saveEventData(),this.processRequests(S)})}queueRequest(o,d){this.queue.push(o),this.processRequests(d)}}const Xe=new class extends mt{constructor(g){super("appUserTurnstile"),this._customAccessToken=g}postTurnstileEvent(g,o){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(g)&&g.some(d=>i.f(d)||i.h(d))&&this.queueRequest(Date.now(),o)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=He(i.e.ACCESS_TOKEN),d=o?o.u:i.e.ACCESS_TOKEN;let y=d!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),y=!0);const S=this.queue.shift();if(this.eventData.lastSuccess){const N=new Date(this.eventData.lastSuccess),k=new Date(S),z=(S-this.eventData.lastSuccess)/864e5;y=y||z>=1||z<-1||N.getDate()!==k.getDate()}else y=!0;y?this.postEvent(S,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:je,"enabled.telemetry":!1,userId:this.anonId},N=>{N||(this.eventData.lastSuccess=S,this.eventData.tokenU=d)},g):this.processRequests()}},ot=Xe.postTurnstileEvent.bind(Xe),qe=new class extends mt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(g,o,d,y){this.skuToken=o,this.errorCb=y,i.e.EVENTS_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(xe)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:d}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:x,skuId:je,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},g))}remove(){this.errorCb=null}},Lt=qe.postMapLoadEvent.bind(qe),Zt=new class extends mt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(g){let o=this.mapInstanceIdMap.get(g);return o||(o=i.u(),this.mapInstanceIdMap.set(g,o)),o}getEventId(g){const o=this.eventIdPerMapInstanceMap.get(g)||0;return this.eventIdPerMapInstanceMap.set(g,o+1),o}postStyleLoadEvent(g,o){const{map:d,style:y,importedStyles:S}=o;if(!i.e.EVENTS_URL||!g&&!i.e.ACCESS_TOKEN)return;const N=this.getMapInstanceId(d),k={mapInstanceId:N,eventId:this.getEventId(N),style:y};S.length&&(k.importedStyles=S),this.queueRequest({timestamp:Date.now(),payload:k},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:d}=this.queue.shift();this.postEvent(o,d,()=>{},g)}},Xt=Zt.postStyleLoadEvent.bind(Zt),rr=new class extends mt{constructor(){super("gljs.performance")}postPerformanceEvent(g,o){i.e.EVENTS_URL&&(g||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},g)}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:d}=this.queue.shift(),y=function(S){const N=performance.getEntriesByType("resource"),k=performance.getEntriesByType("mark"),z=function(oe){const _e={};if(oe){for(const me in oe)if(me!=="other")for(const we of oe[me]){const be=`${me}ResolveRangeMin`,Ee=`${me}ResolveRangeMax`,$e=`${me}RequestCount`,Ve=`${me}RequestCachedCount`;_e[be]=Math.min(_e[be]||1/0,we.startTime),_e[Ee]=Math.max(_e[Ee]||-1/0,we.responseEnd);const Qe=We=>{_e[We]===void 0&&(_e[We]=0),++_e[We]};we.transferSize!==void 0&&we.transferSize===0&&Qe(Ve),Qe($e)}}return _e}(function(oe,_e){const me={};if(oe)for(const we of oe){const be=_e(we);me[be]===void 0&&(me[be]=[]),me[be].push(we)}return me}(N,P)),G=window.devicePixelRatio,Z=navigator.connection||navigator.mozConnection||navigator.webkitConnection,Y=Z?Z.effectiveType:void 0,re={counters:[],metadata:[],attributes:[]},ne=(oe,_e,me)=>{me!=null&&oe.push({name:_e,value:me.toString()})};for(const oe in z)ne(re.counters,oe,z[oe]);if(S.interactionRange[0]!==1/0&&S.interactionRange[1]!==-1/0&&(ne(re.counters,"interactionRangeMin",S.interactionRange[0]),ne(re.counters,"interactionRangeMax",S.interactionRange[1])),k)for(const oe of Object.keys(w)){const _e=w[oe],me=k.find(we=>we.name===_e);me&&ne(re.counters,_e,me.startTime)}return ne(re.counters,"visibilityHidden",S.visibilityHidden),ne(re.attributes,"style",function(oe){if(oe)for(const _e of oe){const me=_e.name.split("?")[0];if(i.i(me)){const we=me.split("/").slice(-2);if(we.length===2)return`mapbox://styles/${we[0]}/${we[1]}`}}}(N)),ne(re.attributes,"terrainEnabled",S.terrainEnabled?"true":"false"),ne(re.attributes,"fogEnabled",S.fogEnabled?"true":"false"),ne(re.attributes,"projection",S.projection),ne(re.attributes,"zoom",S.zoom),ne(re.metadata,"devicePixelRatio",G),ne(re.metadata,"connectionEffectiveType",Y),ne(re.metadata,"navigatorUserAgent",navigator.userAgent),ne(re.metadata,"screenWidth",window.screen.width),ne(re.metadata,"screenHeight",window.screen.height),ne(re.metadata,"windowWidth",window.innerWidth),ne(re.metadata,"windowHeight",window.innerHeight),ne(re.metadata,"mapWidth",S.width/G),ne(re.metadata,"mapHeight",S.height/G),ne(re.metadata,"webglRenderer",S.renderer),ne(re.metadata,"webglVendor",S.vendor),ne(re.metadata,"sdkVersion",x),ne(re.metadata,"sdkIdentifier","mapbox-gl-js"),re}(d);for(const S of y.metadata);for(const S of y.counters);for(const S of y.attributes);this.postEvent(o,y,()=>{},g)}},ir=rr.postPerformanceEvent.bind(rr),Bt=new class extends mt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(g,o,d,y){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const S=Te(i.e.API_URL+i.e.SESSION_PATH);S.params.push(`sku=${o||""}`),S.params.push(`access_token=${y||i.e.ACCESS_TOKEN||""}`);const N={url:Re(S),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(N,k=>{this.pendingRequest=null,d(k),this.saveEventData(),this.processRequests(y)})}getSessionAPI(g,o,d,y){this.skuToken=o,this.errorCb=y,i.e.SESSION_PATH&&i.e.API_URL&&(d||i.e.ACCESS_TOKEN?this.queueRequest({id:g,timestamp:Date.now()},d):this.errorCb(new Error(xe)))}processRequests(g){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:d}=this.queue.shift();o&&this.success[o]||this.getSession(d,this.skuToken,y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},g)}remove(){this.errorCb=null}},De=Bt.getSessionAPI.bind(Bt),jr=new Set;function Dt(g,o){o?jr.add(g):jr.delete(g)}class Cr{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,d){this._updatedSourceCaches[o]=d,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const d=o.scope;this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._updatedLayers[d].add(o.id),this.setDirty()}removeLayer(o){const d=o.scope;this._removedLayers[d]=this._removedLayers[d]||{},this._updatedLayers[d]=this._updatedLayers[d]||new Set,this._removedLayers[d][o.id]=o,this._updatedLayers[d].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const d in this._updatedLayers)o[d]=o[d]||{},o[d].updatedIds=Array.from(this._updatedLayers[d].values());for(const d in this._removedLayers)o[d]=o[d]||{},o[d].removedIds=Object.keys(this._removedLayers[d]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(o){this._updatedImages.add(o),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function At(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class qr extends i.E{constructor(o){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=o,o!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(o){this.images[o]={},this.loaded[o]=!1,this.updatedImages[o]={},this.patterns[o]={},this.callbackDispatchedThisFrame[o]={},this.atlasImage[o]=new i.r({width:1,height:1})}isLoaded(){for(const o in this.loaded)if(!this.loaded[o])return!1;return!0}setLoaded(o,d){if(this.loaded[d]!==o&&(this.loaded[d]=o,o)){for(const{ids:y,callback:S}of this.requestors)this._notify(y,d,S);this.requestors=[]}}hasImage(o,d){return!!this.getImage(o,d)}getImage(o,d){return this.images[d][o]}addImage(o,d,y){this._validate(o,y)&&(this.images[d][o]=y)}_validate(o,d){let y=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new i.y(new Error(`Image "${o}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new i.y(new Error(`Image "${o}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new i.y(new Error(`Image "${o}" has invalid "content" value`))),y=!1),y}_validateStretch(o,d){if(!o)return!0;let y=0;for(const S of o){if(S[0]<y||S[1]<S[0]||d<S[1])return!1;y=S[1]}return!0}_validateContent(o,d){return o?o.length!==4||!d.usvg&&(o[0]<0||d.data.width<o[0]||o[1]<0||d.data.height<o[1]||o[2]<0||d.data.width<o[2]||o[3]<0||d.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,d,y){y.version=this.images[d][o].version+1,this.images[d][o]=y,this.updatedImages[d][o]=!0,this.removeFromImageRasterizerCache(o,d)}removeFromImageRasterizerCache(o,d){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:d}):this.imageRasterizer.removeImagesFromCacheByIds([o],d))}removeImage(o,d){const y=this.images[d][o];delete this.images[d][o],delete this.patterns[d][o],this.removeFromImageRasterizerCache(o,d),y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(o){return Object.keys(this.images[o])}getImages(o,d,y){let S=!0;const N=!!this.loaded[d];if(!N)for(const k of o)this.images[d][k]||(S=!1);N||S?this._notify(o,d,y):this.requestors.push({ids:o,scope:d,callback:y})}rasterizeImages({scope:o,imageTasks:d},y){const S={};for(const N in d){const k=d[N],z=this.getImage(k.id,o);z&&(S[N]={image:z,imageIdWithOptions:k})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:S,scope:o},y):this.rasterizeImagesInMainThread({imageTasks:S,scope:o},y)}rasterizeImagesInMainThread(o,d){const{imageTasks:y,scope:S}=o,N={};for(const k in y){const{image:z,imageIdWithOptions:G}=y[k];N[k]=this.imageRasterizer.rasterize(G,z,S,"")}d(void 0,N)}getUpdatedImages(o){return this.updatedImages[o]}_notify(o,d,y){const S={};for(const N of o){this.images[d][N]||this.fire(new i.z("styleimagemissing",{id:N}));const k=this.images[d][N];k?S[N]={data:k.usvg?null:k.data.clone(),pixelRatio:k.pixelRatio,sdf:k.sdf,usvg:k.usvg,version:k.version,stretchX:k.stretchX,stretchY:k.stretchY,content:k.content,hasRenderCallback:!!(k.userImage&&k.userImage.render)}:i.w(`Image "${N}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}y(null,S)}getPixelSize(o){const{width:d,height:y}=this.atlasImage[o];return{width:d,height:y}}getPattern(o,d,y){const S=this.patterns[d][o],N=this.getImage(o,d);if(!N)return null;if(S&&S.position.version===N.version)return S.position;if(S)S.position.version=N.version;else{N.usvg&&!N.data&&(N.data=this.imageRasterizer.rasterize(i.A.from(o).getPrimary(),N,d,""));const k={w:N.data.width+2*i.B,h:N.data.height+2*i.B,x:0,y:0},z=new i.C(k,N,i.B);this.patterns[d][o]={bin:k,position:z}}return this._updatePatternAtlas(d,y),this.patterns[d][o].position}bind(o,d){const y=o.gl;let S=this.atlasTexture[d];S?this.dirty&&(S.update(this.atlasImage[d]),this.dirty=!1):(S=new i.T(o,this.atlasImage[d],y.RGBA8),this.atlasTexture[d]=S),S.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(o,d){const y=[];for(const z in this.patterns[o])y.push(this.patterns[o][z].bin);const{w:S,h:N}=i.F(y),k=this.atlasImage[o];k.resize({width:S||1,height:N||1});for(const z in this.patterns[o]){const{bin:G,position:Z}=this.patterns[o][z];let Y=Z.padding;const re=G.x+Y,ne=G.y+Y,oe=this.images[o][z].data,_e=oe.width,me=oe.height;Y=Y>1?Y-1:Y,i.r.copy(oe,k,{x:0,y:0},{x:re,y:ne},{width:_e,height:me},d),i.r.copy(oe,k,{x:0,y:me-Y},{x:re,y:ne-Y},{width:_e,height:Y},d),i.r.copy(oe,k,{x:0,y:0},{x:re,y:ne+me},{width:_e,height:Y},d),i.r.copy(oe,k,{x:_e-Y,y:0},{x:re-Y,y:ne},{width:Y,height:me},d),i.r.copy(oe,k,{x:0,y:0},{x:re+_e,y:ne},{width:Y,height:me},d),i.r.copy(oe,k,{x:_e-Y,y:me-Y},{x:re-Y,y:ne-Y},{width:Y,height:Y},d),i.r.copy(oe,k,{x:0,y:me-Y},{x:re+_e,y:ne-Y},{width:Y,height:Y},d),i.r.copy(oe,k,{x:0,y:0},{x:re+_e,y:ne+me},{width:Y,height:Y},d),i.r.copy(oe,k,{x:_e-Y,y:0},{x:re-Y,y:ne+me},{width:Y,height:Y},d)}this.dirty=!0}beginFrame(){for(const o in this.images)this.callbackDispatchedThisFrame[o]={}}dispatchRenderCallbacks(o,d){for(const y of o){if(this.callbackDispatchedThisFrame[d][y])continue;this.callbackDispatchedThisFrame[d][y]=!0;const S=this.images[d][y];At(S)&&this.updateImage(y,d,S)}}}function an(g){const o=g.key,d=g.value,y=g.valueSpec||{},S=g.objectElementValidators||{},N=g.style,k=g.styleSpec;let z=[];const G=i.H(d);if(G!=="object")return[new i.V(o,d,`object expected, ${G} found`)];for(const Z in d){const Y=Z.split(".")[0];let re;S[Y]?re=S[Y]:y[Y]?re=sn:S["*"]?re=S["*"]:y["*"]&&(re=sn),re?z=z.concat(re({key:(o&&`${o}.`)+Z,value:d[Z],valueSpec:y[Y]||y["*"],style:N,styleSpec:k,object:d,objectKey:Z},d)):z.push(new i.G(o,d[Z],`unknown property "${Z}"`))}for(const Z in y)S[Z]||y[Z].required&&y[Z].default===void 0&&d[Z]===void 0&&z.push(new i.V(o,d,`missing required property "${Z}"`));return z}function Jn(g){const o=g.value,d=g.valueSpec,y=g.style,S=g.styleSpec,N=g.key,k=g.arrayElementValidator||sn;if(i.H(o)!=="array")return[new i.V(N,o,`array expected, ${i.H(o)} found`)];if(d.length&&o.length!==d.length)return[new i.V(N,o,`array length ${d.length} expected, length ${o.length} found`)];if(d["min-length"]&&o.length<d["min-length"])return[new i.V(N,o,`array length at least ${d["min-length"]} expected, length ${o.length} found`)];let z={type:d.value,values:d.values,minimum:d.minimum,maximum:d.maximum,function:void 0};S.$version<7&&(z.function=d.function),i.H(d.value)==="object"&&(z=d.value);let G=[];for(let Z=0;Z<o.length;Z++)G=G.concat(k({array:o,arrayIndex:Z,value:o[Z],valueSpec:z,style:y,styleSpec:S,key:`${N}[${Z}]`},!0));return G}function tt(g){const o=g.key,d=g.value,y=g.valueSpec;let S=i.H(d);if(S==="number"&&d!=d&&(S="NaN"),S!=="number")return[new i.V(o,d,`number expected, ${S} found`)];if("minimum"in y){let N=y.minimum;if(i.H(y.minimum)==="array"&&(N=y.minimum[g.arrayIndex]),d<N)return[new i.V(o,d,`${d} is less than the minimum value ${N}`)]}if("maximum"in y){let N=y.maximum;if(i.H(y.maximum)==="array"&&(N=y.maximum[g.arrayIndex]),d>N)return[new i.V(o,d,`${d} is greater than the maximum value ${N}`)]}return[]}function xt(g){const o=g.valueSpec,d=i.K(g.value.type);let y,S,N,k={};const z=d!=="categorical"&&g.value.property===void 0,G=!z,Z=i.H(g.value.stops)==="array"&&i.H(g.value.stops[0])==="array"&&i.H(g.value.stops[0][0])==="object",Y=an({key:g.key,value:g.value,valueSpec:g.styleSpec.function,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{stops:function(oe){if(d==="identity")return[new i.V(oe.key,oe.value,'identity function may not have a "stops" property')];let _e=[];const me=oe.value;return _e=_e.concat(Jn({key:oe.key,value:me,valueSpec:oe.valueSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:re})),i.H(me)==="array"&&me.length===0&&_e.push(new i.V(oe.key,me,"array must have at least one stop")),_e},default:function(oe){return sn({key:oe.key,value:oe.value,valueSpec:o,style:oe.style,styleSpec:oe.styleSpec})}}});return d==="identity"&&z&&Y.push(new i.V(g.key,g.value,'missing required property "property"')),d==="identity"||g.value.stops||Y.push(new i.V(g.key,g.value,'missing required property "stops"')),d==="exponential"&&g.valueSpec.expression&&!i.L(g.valueSpec)&&Y.push(new i.V(g.key,g.value,"exponential functions not supported")),g.styleSpec.$version>=8&&(G&&!i.M(g.valueSpec)?Y.push(new i.V(g.key,g.value,"property functions not supported")):z&&!i.N(g.valueSpec)&&Y.push(new i.V(g.key,g.value,"zoom functions not supported"))),d!=="categorical"&&!Z||g.value.property!==void 0||Y.push(new i.V(g.key,g.value,'"property" property is required')),Y;function re(oe){let _e=[];const me=oe.value,we=oe.key;if(i.H(me)!=="array")return[new i.V(we,me,`array expected, ${i.H(me)} found`)];if(me.length!==2)return[new i.V(we,me,`array length 2 expected, length ${me.length} found`)];if(Z){if(i.H(me[0])!=="object")return[new i.V(we,me,`object expected, ${i.H(me[0])} found`)];if(me[0].zoom===void 0)return[new i.V(we,me,"object stop key must have zoom")];if(me[0].value===void 0)return[new i.V(we,me,"object stop key must have value")];const be=i.K(me[0].zoom);if(typeof be!="number")return[new i.V(we,me[0].zoom,"stop zoom values must be numbers")];if(N&&N>be)return[new i.V(we,me[0].zoom,"stop zoom values must appear in ascending order")];be!==N&&(N=be,S=void 0,k={}),_e=_e.concat(an({key:`${we}[0]`,value:me[0],valueSpec:{zoom:{}},style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:tt,value:ne}}))}else _e=_e.concat(ne({key:`${we}[0]`,value:me[0],style:oe.style,styleSpec:oe.styleSpec},me));return i.O(i.Q(me[1]))?_e.concat([new i.V(`${we}[1]`,me[1],"expressions are not allowed in function stops.")]):_e.concat(sn({key:`${we}[1]`,value:me[1],valueSpec:o,style:oe.style,styleSpec:oe.styleSpec}))}function ne(oe,_e){const me=i.H(oe.value),we=i.K(oe.value),be=oe.value!==null?oe.value:_e;if(y){if(me!==y)return[new i.V(oe.key,be,`${me} stop domain type must match previous stop domain type ${y}`)]}else y=me;if(me!=="number"&&me!=="string"&&me!=="boolean"&&typeof we!="number"&&typeof we!="string"&&typeof we!="boolean")return[new i.V(oe.key,be,"stop domain value must be a number, string, or boolean")];if(me!=="number"&&d!=="categorical"){let Ee=`number expected, ${me} found`;return i.M(o)&&d===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(oe.key,be,Ee)]}return d!=="categorical"||me!=="number"||typeof we=="number"&&isFinite(we)&&Math.floor(we)===we?d!=="categorical"&&me==="number"&&typeof we=="number"&&typeof S=="number"&&S!==void 0&&we<S?[new i.V(oe.key,be,"stop domain values must appear in ascending order")]:(S=we,d==="categorical"&&we in k?[new i.V(oe.key,be,"stop domain values must be unique")]:(k[we]=!0,[])):[new i.V(oe.key,be,`integer expected, found ${String(we)}`)]}}function Mt(g){const o=(g.expressionContext==="property"?i.S:i.U)(i.Q(g.value),g.valueSpec);if(o.result==="error")return o.value.map(y=>new i.V(`${g.key}${y.key}`,g.value,y.message));const d=o.value.expression||o.value._styleExpression.expression;if(g.expressionContext==="property"&&g.propertyKey==="text-font"&&!d.outputDefined())return[new i.V(g.key,g.value,`Invalid data expression for "${g.propertyKey}". Output values must be contained as literals within the expression.`)];if(g.expressionContext==="property"&&g.propertyType==="layout"&&!i.W(d))return[new i.V(g.key,g.value,'"feature-state" data expressions are not supported with layout properties.')];if(g.expressionContext==="filter")return lr(d,g);if(g.expressionContext&&g.expressionContext.indexOf("cluster")===0){if(!i.X(d,["zoom","feature-state"]))return[new i.V(g.key,g.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(g.expressionContext==="cluster-initial"&&!i.Y(d))return[new i.V(g.key,g.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function lr(g,o){const d=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const S of o.valueSpec.expression.parameters)d.delete(S);if(d.size===0)return[];const y=[];return g instanceof i.Z&&d.has(g.name)?[new i.V(o.key,o.value,`["${g.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(g.eachChild(S=>{y.push(...lr(S,o))}),y)}function cr(g){const o=g.key,d=g.value,y=g.valueSpec,S=[];return Array.isArray(y.values)?y.values.indexOf(i.K(d))===-1&&S.push(new i.V(o,d,`expected one of [${y.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(y.values).indexOf(i.K(d))===-1&&S.push(new i.V(o,d,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(d)} found`)),S}function xr(g){return i.$(i.Q(g.value))?Mt(i.J({},g,{expressionContext:"filter",valueSpec:g.styleSpec[`filter_${g.layerType||"fill"}`]})):ur(g)}function ur(g){const o=g.value,d=g.key;if(i.H(o)!=="array")return[new i.V(d,o,`array expected, ${i.H(o)} found`)];const y=g.styleSpec;let S,N=[];if(o.length<1)return[new i.V(d,o,"filter array must have at least 1 element")];switch(N=N.concat(cr({key:`${d}[0]`,value:o[0],valueSpec:y.filter_operator,style:g.style,styleSpec:g.styleSpec})),i.K(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&i.K(o[1])==="$type"&&N.push(new i.V(d,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&N.push(new i.V(d,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(S=i.H(o[1]),S!=="string"&&N.push(new i.V(`${d}[1]`,o[1],`string expected, ${S} found`)));for(let k=2;k<o.length;k++)S=i.H(o[k]),i.K(o[1])==="$type"?N=N.concat(cr({key:`${d}[${k}]`,value:o[k],valueSpec:y.geometry_type,style:g.style,styleSpec:g.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&N.push(new i.V(`${d}[${k}]`,o[k],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let k=1;k<o.length;k++)N=N.concat(ur({key:`${d}[${k}]`,value:o[k],style:g.style,styleSpec:g.styleSpec}));break;case"has":case"!has":S=i.H(o[1]),o.length!==2?N.push(new i.V(d,o,`filter array for "${o[0]}" operator must have 2 elements`)):S!=="string"&&N.push(new i.V(`${d}[1]`,o[1],`string expected, ${S} found`))}return N}function tn(g,o){const d=g.key,y=g.style,S=g.layer,N=g.styleSpec,k=g.value,z=g.objectKey,G=N[`${o}_${g.layerType}`];if(!G)return[];const Z=z.match(/^(.*)-use-theme$/);if(o==="paint"&&Z&&G[Z[1]])return i.O(k)?[].concat(sn({key:g.key,value:k,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:N,expressionContext:"property",propertyType:o,propertyKey:z})):sn({key:d,value:k,valueSpec:{type:"string"},style:y,styleSpec:N});const Y=z.match(/^(.*)-transition$/);if(o==="paint"&&Y&&G[Y[1]]&&G[Y[1]].transition)return sn({key:d,value:k,valueSpec:N.transition,style:y,styleSpec:N});const re=g.valueSpec||G[z];if(!re)return[new i.G(d,k,`unknown property "${z}"`)];let ne;if(i.H(k)==="string"&&i.M(re)&&!re.tokens&&(ne=/^{([^}]+)}$/.exec(k))){const _e=`\`{ "type": "identity", "property": ${ne?JSON.stringify(ne[1]):'"_"'} }\``;return[new i.V(d,k,`"${z}" does not support interpolation syntax
Use an identity property function instead: ${_e}.`)]}const oe=[];if(g.layerType==="symbol")z!=="text-field"||!y||y.glyphs||y.imports||oe.push(new i.V(d,k,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&i.a0(i.Q(k))&&i.K(k.type)==="identity"&&oe.push(new i.V(d,k,'"text-font" does not support identity functions'));else if(g.layerType==="model"&&o==="paint"&&S&&S.layout&&S.layout.hasOwnProperty("model-id")&&i.M(re)&&(i.a1(re)||i.N(re))){const _e=i.S(i.Q(k),re),me=_e.value.expression||_e.value._styleExpression.expression;me&&!i.X(me,["measure-light"])&&(z==="model-emissive-strength"&&i.Y(me)&&i.W(me)||oe.push(new i.V(d,k,`${z} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return oe.concat(sn({key:g.key,value:k,valueSpec:re,style:y,styleSpec:N,expressionContext:"property",propertyType:o,propertyKey:z}))}function Gn(g){return tn(g,"paint")}function gi(g){return tn(g,"layout")}function Ui(g){let o=[];const d=g.value,y=g.key,S=g.style,N=g.styleSpec;d.type||d.ref||o.push(new i.V(y,d,'either "type" or "ref" is required'));let k=i.K(d.type);const z=i.K(d.ref);if(d.id){const G=i.K(d.id);for(let Z=0;Z<g.arrayIndex;Z++){const Y=S.layers[Z];i.K(Y.id)===G&&o.push(new i.V(y,d.id,`duplicate layer id "${d.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in d){let G;["type","source","source-layer","filter","layout"].forEach(Z=>{Z in d&&o.push(new i.V(y,d[Z],`"${Z}" is prohibited for ref layers`))}),S.layers.forEach(Z=>{i.K(Z.id)===z&&(G=Z)}),G?G.ref?o.push(new i.V(y,d.ref,"ref cannot reference another ref layer")):k=i.K(G.type):typeof z=="string"&&o.push(new i.V(y,d.ref,`ref layer "${z}" not found`))}else if(k!=="background"&&k!=="sky"&&k!=="slot")if(d.source){const G=S.sources&&S.sources[d.source],Z=G&&i.K(G.type);G?Z==="vector"&&k==="raster"?o.push(new i.V(y,d.source,`layer "${d.id}" requires a raster source`)):Z==="raster"&&k!=="raster"?o.push(new i.V(y,d.source,`layer "${d.id}" requires a vector source`)):Z!=="vector"||d["source-layer"]?Z==="raster-dem"&&k!=="hillshade"?o.push(new i.V(y,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):Z!=="raster-array"||["raster","raster-particle"].includes(k)?k!=="line"||!d.paint||!d.paint["line-gradient"]&&!d.paint["line-trim-offset"]||Z==="geojson"&&G.lineMetrics?k==="raster-particle"&&Z!=="raster-array"&&o.push(new i.V(y,d.source,`layer "${d.id}" requires a 'raster-array' source.`)):o.push(new i.V(y,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new i.V(y,d.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new i.V(y,d,`layer "${d.id}" must specify a "source-layer"`)):o.push(new i.V(y,d.source,`source "${d.source}" not found`))}else o.push(new i.V(y,d,'missing required property "source"'));return o=o.concat(an({key:y,value:d,valueSpec:N.layer,style:g.style,styleSpec:g.styleSpec,objectElementValidators:{"*":()=>[],type:()=>sn({key:`${y}.type`,value:d.type,valueSpec:N.layer.type,style:g.style,styleSpec:g.styleSpec,object:d,objectKey:"type"}),filter:G=>xr(i.J({layerType:k},G)),layout:G=>an({layer:d,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":Z=>gi(i.J({layerType:k},Z))}}),paint:G=>an({layer:d,key:G.key,value:G.value,valueSpec:{},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{"*":Z=>Gn(i.J({layerType:k,layer:d},Z))}})}})),o}function uo(g){const o=g.value,d=g.key,y=i.H(o);return y!=="string"?[new i.V(d,o,`string expected, ${y} found`)]:[]}const Va={promoteId:function g({key:o,value:d}){if(i.H(d)==="string")return uo({key:o,value:d});if(Array.isArray(d)){const y=[],S=i.Q(d),N=i.U(S);return N.result==="error"&&N.value.forEach(k=>{y.push(new i.V(`${o}${k.key}`,null,`${k.message}`))}),i.X(N.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new i.V(`${o}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const S in d)y.push(...g({key:`${o}.${S}`,value:d[S]}));return y}}};function Ks(g){const o=g.value,d=g.key,y=g.styleSpec,S=g.style;if(!o.type)return[new i.V(d,o,'"type" is required')];const N=i.K(o.type);let k=[];switch(["vector","raster","raster-dem","raster-array"].includes(N)&&(o.url||o.tiles||k.push(new i.G(d,o,'Either "url" or "tiles" is required.'))),N){case"vector":case"raster":case"raster-dem":case"raster-array":return k=k.concat(an({key:d,value:o,valueSpec:y[`source_${N.replace("-","_")}`],style:g.style,styleSpec:y,objectElementValidators:Va})),k;case"geojson":if(k=an({key:d,value:o,valueSpec:y.source_geojson,style:S,styleSpec:y,objectElementValidators:Va}),o.cluster)for(const z in o.clusterProperties){const[G,Z]=o.clusterProperties[z],Y=typeof G=="string"?[G,["accumulated"],["get",z]]:G;k.push(...Mt({key:`${d}.${z}.map`,value:Z,expressionContext:"cluster-map"})),k.push(...Mt({key:`${d}.${z}.reduce`,value:Y,expressionContext:"cluster-reduce"}))}return k;case"video":return an({key:d,value:o,valueSpec:y.source_video,style:S,styleSpec:y});case"image":return an({key:d,value:o,valueSpec:y.source_image,style:S,styleSpec:y});case"canvas":return[new i.V(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cr({key:`${d}.type`,value:o.type,valueSpec:{values:To(y)}})}}function To(g){return g.source.reduce((o,d)=>{const y=g[d];return y.type.type==="enum"&&(o=o.concat(Object.keys(y.type.values))),o},[])}function es(g){const o=g.value,d=g.styleSpec,y=d.light,S=g.style;let N=[];const k=i.H(o);if(o===void 0)return N;if(k!=="object")return N=N.concat([new i.V("light",o,`object expected, ${k} found`)]),N;for(const z in o){const G=z.match(/^(.*)-transition$/),Z=z.match(/^(.*)-use-theme$/);N=N.concat(Z&&y[Z[1]]?sn({key:z,value:o[z],valueSpec:{type:"string"},style:S,styleSpec:d}):G&&y[G[1]]&&y[G[1]].transition?sn({key:z,value:o[z],valueSpec:d.transition,style:S,styleSpec:d}):y[z]?sn({key:z,value:o[z],valueSpec:y[z],style:S,styleSpec:d}):[new i.V(z,o[z],`unknown property "${z}"`)])}return N}function rc(g){const o=g.value;let d=[];if(!o)return d;const y=i.H(o);if(y!=="object")return d=d.concat([new i.V("light-3d",o,`object expected, ${y} found`)]),d;const S=g.styleSpec,N=S["light-3d"],k=g.key,z=g.style,G=g.style.lights;for(const re of["type","id"])if(!(re in o))return d=d.concat([new i.V("light-3d",o,`missing property ${re} on light`)]),d;if(o.type&&G)for(let re=0;re<g.arrayIndex;re++){const ne=i.K(o.type),oe=G[re];i.K(oe.type)===ne&&d.push(new i.V(k,o.id,`duplicate light type "${o.type}", previously defined at line ${oe.id.__line__}`))}const Z=`properties_light_${o.type}`;if(!(Z in S))return d=d.concat([new i.V("light-3d",o,`Invalid light type ${o.type}`)]),d;const Y=S[Z];for(const re in o)if(re==="properties"){const ne=o[re],oe=i.H(ne);if(oe!=="object")return d=d.concat([new i.V("properties",ne,`object expected, ${oe} found`)]),d;for(const _e in ne)d=d.concat(Y[_e]?sn({key:_e,value:ne[_e],valueSpec:Y[_e],style:z,styleSpec:S}):[new i.G(g.key,ne[_e],`unknown property "${_e}"`)])}else{const ne=re.match(/^(.*)-transition$/),oe=re.match(/^(.*)-use-theme$/);d=d.concat(oe&&N[oe[1]]?sn({key:re,value:o[re],valueSpec:{type:"string"},style:z,styleSpec:S}):ne&&N[ne[1]]&&N[ne[1]].transition?sn({key:re,value:o[re],valueSpec:S.transition,style:z,styleSpec:S}):N[re]?sn({key:re,value:o[re],valueSpec:N[re],style:z,styleSpec:S}):[new i.G(re,o[re],`unknown property "${re}"`)])}return d}function kl(g){const o=g.value,d=g.key,y=g.style,S=g.styleSpec,N=S.terrain;let k=[];const z=i.H(o);if(o===void 0||z==="null")return k;if(z!=="object")return k=k.concat([new i.V("terrain",o,`object expected, ${z} found`)]),k;for(const G in o){const Z=G.match(/^(.*)-transition$/),Y=G.match(/^(.*)-use-theme$/);k=k.concat(Y&&N[Y[1]]?sn({key:G,value:o[G],valueSpec:{type:"string"},style:y,styleSpec:S}):Z&&N[Z[1]]&&N[Z[1]].transition?sn({key:G,value:o[G],valueSpec:S.transition,style:y,styleSpec:S}):N[G]?sn({key:G,value:o[G],valueSpec:N[G],style:y,styleSpec:S}):[new i.G(G,o[G],`unknown property "${G}"`)])}if(o.source){const G=y.sources&&y.sources[o.source],Z=G&&i.K(G.type);G?Z!=="raster-dem"&&k.push(new i.V(d,o.source,`terrain cannot be used with a source of type ${String(Z)}, it only be used with a "raster-dem" source type`)):k.push(new i.V(d,o.source,`source "${o.source}" not found`))}else k.push(new i.V(d,o,'terrain is missing required property "source"'));return k}function Fs(g){const o=g.value,d=g.style,y=g.styleSpec,S=y.fog;let N=[];const k=i.H(o);if(o===void 0)return N;if(k!=="object")return N=N.concat([new i.V("fog",o,`object expected, ${k} found`)]),N;for(const z in o){const G=z.match(/^(.*)-transition$/),Z=z.match(/^(.*)-use-theme$/);N=N.concat(Z&&S[Z[1]]?sn({key:z,value:o[z],valueSpec:{type:"string"},style:d,styleSpec:y}):G&&S[G[1]]&&S[G[1]].transition?sn({key:z,value:o[z],valueSpec:y.transition,style:d,styleSpec:y}):S[z]?sn({key:z,value:o[z],valueSpec:S[z],style:d,styleSpec:y}):[new i.G(z,o[z],`unknown property "${z}"`)])}return N}const nc={"*":()=>[],array:Jn,boolean:function(g){const o=g.value,d=g.key,y=i.H(o);return y!=="boolean"?[new i.V(d,o,`boolean expected, ${y} found`)]:[]},number:tt,color:function(g){const o=g.key,d=g.value,y=i.H(d);return y!=="string"?[new i.V(o,d,`color expected, ${y} found`)]:i._.parseCSSColor(d)===null?[new i.V(o,d,`color expected, "${d}" found`)]:[]},enum:cr,filter:xr,function:xt,layer:Ui,object:an,source:Ks,model:i.a2,light:es,"light-3d":rc,terrain:kl,fog:Fs,string:uo,formatted:function(g){return uo(g).length===0?[]:Mt(g)},resolvedImage:function(g){return uo(g).length===0?[]:Mt(g)},projection:function(g){const o=g.value,d=g.styleSpec,y=d.projection,S=g.style;let N=[];const k=i.H(o);if(k==="object")for(const z in o)N=N.concat(sn({key:z,value:o[z],valueSpec:y[z],style:S,styleSpec:d}));else k!=="string"&&(N=N.concat([new i.V("projection",o,`object or string expected, ${k} found`)]));return N},import:function(g){const{value:o,styleSpec:d}=g,{data:y,...S}=o;Object.defineProperty(S,"__line__",{value:o.__line__,enumerable:!1});let N=an(i.J({},g,{value:S,valueSpec:d.import}));return i.K(S.id)===""&&N.push(new i.V(`${g.key}.id`,S,"import id can't be an empty string")),y&&(N=N.concat(Uu(y,d,{key:`${g.key}.data`}))),N}};function sn(g,o=!1){const d=g.value,y=g.valueSpec,S=g.styleSpec;if(y.expression&&i.a0(i.K(d)))return xt(g);if(y.expression&&i.O(i.Q(d)))return Mt(g);if(y.type&&nc[y.type]){const N=nc[y.type](g);return o===!0&&N.length>0&&i.H(g.value)==="array"?Mt(g):N}return an(i.J({},g,{valueSpec:y.type?S[y.type]:y}))}function ts(g){const o=g.value,d=g.key,y=uo(g);return y.length||(o.indexOf("{fontstack}")===-1&&y.push(new i.V(d,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&y.push(new i.V(d,o,'"glyphs" url must include a "{range}" token'))),y}function Uu(g,o=i.a3,d={}){return sn({key:d.key||"",value:g,valueSpec:o.$root,styleSpec:o,style:g,objectElementValidators:{glyphs:ts,"*":()=>[]}})}function Ua(g,o=i.a3){return Ki(Uu(g,o))}const Zs=g=>Ki(Ks(g)),Wn=g=>Ki(es(g)),fa=g=>Ki(rc(g)),Pa=g=>Ki(kl(g)),Cs=g=>Ki(Fs(g)),El=g=>Ki(function(o){const d=o.value,y=o.style,S=o.styleSpec,N=S.snow;let k=[];const z=i.H(d);if(d===void 0)return k;if(z!=="object")return k=k.concat([new i.V("snow",d,`object expected, ${z} found`)]),k;for(const G in d){const Z=G.match(/^(.*)-transition$/);k=k.concat(Z&&N[Z[1]]&&N[Z[1]].transition?sn({key:G,value:d[G],valueSpec:S.transition,style:y,styleSpec:S}):N[G]?sn({key:G,value:d[G],valueSpec:N[G],style:y,styleSpec:S}):[new i.G(G,d[G],`unknown property "${G}"`)])}return k}(g)),Na=g=>Ki(function(o){const d=o.value,y=o.style,S=o.styleSpec,N=S.rain;let k=[];const z=i.H(d);if(d===void 0)return k;if(z!=="object")return k=k.concat([new i.V("rain",d,`object expected, ${z} found`)]),k;for(const G in d){const Z=G.match(/^(.*)-transition$/);k=k.concat(Z&&N[Z[1]]&&N[Z[1]].transition?sn({key:G,value:d[G],valueSpec:S.transition,style:y,styleSpec:S}):N[G]?sn({key:G,value:d[G],valueSpec:N[G],style:y,styleSpec:S}):[new i.G(G,d[G],`unknown property "${G}"`)])}return k}(g)),Bs=g=>Ki(Ui(g)),$i=g=>Ki(xr(g)),ks=g=>Ki(Gn(g)),ms=g=>Ki(gi(g)),$u=g=>Ki(i.a2(g));function Ki(g){return g.slice().sort((o,d)=>o.line&&d.line?o.line-d.line:0)}function Go(g,o){let d=!1;if(o&&o.length)for(const y of o)y instanceof i.G?i.w(y.message):(g.fire(new i.y(new Error(y.message))),d=!0);return d}let Tt;class ve extends i.E{constructor(o,d="flat"){super(),this._transitionable=new i.a4(Tt||(Tt=new i.a5({anchor:new i.a6(i.a3.light.anchor),position:new i.a7(i.a3.light.position),color:new i.a6(i.a3.light.color),intensity:new i.a6(i.a3.light.intensity)}))),this.setLight(o,d),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,d,y={}){this._validate(Wn,o,y)||(this._transitionable.setTransitionOrValue(o),this.id=d)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,y){return(!y||y.validate!==!1)&&Go(this,o.call(Ua,i.l({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Ae=class extends i.E{constructor(g,o,d,y){super(),this.scope=d,this._transitionable=new i.a4(new i.a5({source:new i.a6(i.a3.terrain.source),exaggeration:new i.a6(i.a3.terrain.exaggeration)}),d,y),this._transitionable.setTransitionOrValue(g,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(g,o){this._transitionable.setTransitionOrValue(g,o)}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}getExaggeration(g){return this._transitioning.possiblyEvaluate(new i.a8(g)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const g=this._transitionable._values.exaggeration;if(!g)return null;const o=g.value.expression;if(!o)return null;let d=-1,y=-1,S=1;for(const N of o.zoomStops)S=o.evaluate(new i.a8(N)),S>.01?(d=N,y=-1):y=N;return S<.01&&d>0&&y>d?[d,y]:null}isZoomDependent(){const g=this._transitionable._values.exaggeration;return g!=null&&g.value!=null&&g.value.expression!=null&&g.value.expression instanceof i.a9}};const ke=45,Ze=65,Je=.05;function at(g,o,d,y){const S=i.ac(ke,Ze,d),[N,k]=gt(g,y);let z=1-Math.min(1,Math.exp((o-N)/(k-N)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*S*g.alpha}function gt(g,o){const d=.5/Math.tan(.5*o);return[g.range[0]+d,g.range[1]+d]}function lt(g,o,d,y,S){const N=i.ab.vec3.transformMat4([],[o,d,y],S.mercatorFogMatrix);return at(g,i.ab.vec3.length(N),S.pitch,S._fov)}function St(g,o,d,y,S,N,k){const z=[[d,y,0],[S,y,0],[S,N,0],[d,N,0]];let G=Number.MAX_VALUE,Z=-Number.MAX_VALUE;for(const Y of z){const re=i.ab.vec3.transformMat4([],Y,o),ne=i.ab.vec3.length(re);G=Math.min(G,ne),Z=Math.max(Z,ne)}return[at(g,G,k.pitch,k._fov),at(g,Z,k.pitch,k._fov)]}class wt extends i.E{constructor(o,d,y,S){super();const N=new i.a5({range:new i.a6(i.a3.fog.range),color:new i.a6(i.a3.fog.color),"color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a6(i.a3.fog["high-color"]),"high-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a6(i.a3.fog["space-color"]),"space-color-use-theme":new i.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a6(i.a3.fog["horizon-blend"]),"star-intensity":new i.a6(i.a3.fog["star-intensity"]),"vertical-range":new i.a6(i.a3.fog["vertical-range"])});this._transitionable=new i.a4(N,y,new Map(S)),this.set(o,S),this._transitioning=this._transitionable.untransitioned(),this._transform=d,this.properties=new i.ad(N),this.scope=y}get state(){const o=this._transform,d=o.projection.name==="globe",y=i.ae(o.zoom),S=this.properties.get("range"),N=[.5,3];return{range:d?[i.af(N[0],S[0],y),i.af(N[1],S[1],y)]:S,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,d,y={}){if(this._validate(Cs,o,y))return;const S=i.l({},o);for(const N of Object.keys(i.a3.fog))S[N]===void 0&&(S[N]=i.a3.fog[N].default);this._options=S,this._transitionable.setTransitionOrValue(this._options,d)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ac(ke,Ze,o))*d.a}getOpacityAtLatLng(o,d){return this._transform.projection.supportsFog?function(y,S,N){const k=i.aa.fromLngLat(S),z=N.elevation?N.elevation.getAtPointOrZero(k):0;return lt(y,k.x,k.y,z,N)}(this.state,o,d):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const d=this._transform.calculateFogTileMatrix(o.toUnwrapped());return St(this.state,d,0,0,i.ag,i.ag,this._transform)}getOpacityForBounds(o,d,y,S,N){return this._transform.projection.supportsFog?St(this.state,o,d,y,S,N,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?gt(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const d=[4,5,6,7];for(const y of d){const S=o.points[y];let N;if(S[2]>=0)N=S;else{const k=o.points[y-4];N=i.ah(k,S,k[2]/(k[2]-S[2]))}if(lt(this.state,N[0],N[1],0,this._transform)>=Je)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,d,y){return(!y||y.validate!==!1)&&Go(this,o.call(Ua,i.l({value:d,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}}let Pt,Vt,ar,or,Ar=class extends i.E{constructor(g,o,d,y){super();const S=Pt||(Pt=new i.a5({density:new i.a6(i.a3.snow.density),intensity:new i.a6(i.a3.snow.intensity),color:new i.a6(i.a3.snow.color),opacity:new i.a6(i.a3.snow.opacity),vignette:new i.a6(i.a3.snow.vignette),"vignette-color":new i.a6(i.a3.snow["vignette-color"]),"center-thinning":new i.a6(i.a3.snow["center-thinning"]),direction:new i.a6(i.a3.snow.direction),"flake-size":new i.a6(i.a3.snow["flake-size"])}));this._transitionable=new i.a4(S,d,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(S),this.scope=d}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),d=this.properties.get("direction"),y=i.ai(d[0]),S=-Math.max(i.ai(d[1]),.01),N=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],k=this.properties.get("vignette"),z=this.properties.get("vignette-color");return z.a=k,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(o.r,o.g,o.b,o.a*g),direction:N,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:z}}get(){return this._transitionable.serialize()}set(g,o,d={}){if(this._validate(El,g,d))return;const y=i.l({},g);for(const S of Object.keys(i.a3.snow))y[S]===void 0&&(y[S]=i.a3.snow[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,d){return(!d||d.validate!==!1)&&Go(this,g.call(Ua,i.l({value:o,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}},Gr=class extends i.E{constructor(g,o,d,y){super();const S=Vt||(Vt=new i.a5({density:new i.a6(i.a3.rain.density),intensity:new i.a6(i.a3.rain.intensity),color:new i.a6(i.a3.rain.color),opacity:new i.a6(i.a3.rain.opacity),vignette:new i.a6(i.a3.rain.vignette),"vignette-color":new i.a6(i.a3.rain["vignette-color"]),"center-thinning":new i.a6(i.a3.rain["center-thinning"]),direction:new i.a6(i.a3.rain.direction),"droplet-size":new i.a6(i.a3.rain["droplet-size"]),"distortion-strength":new i.a6(i.a3.rain["distortion-strength"])}));this._transitionable=new i.a4(S,d,new Map(y)),this.set(g,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ad(S),this.scope=d}get state(){const g=this.properties.get("opacity"),o=this.properties.get("color"),d=this.properties.get("direction"),y=i.ai(d[0]),S=-Math.max(i.ai(d[1]),.01),N=[Math.cos(y)*Math.cos(S),Math.sin(y)*Math.cos(S),Math.sin(S)],k=this.properties.get("vignette-color");return k.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.aj(o.r,o.g,o.b,o.a*g),direction:N,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:k}}get(){return this._transitionable.serialize()}set(g,o,d={}){if(this._validate(Na,g,d))return;const y=i.l({},g);for(const S of Object.keys(i.a3.rain))y[S]===void 0&&(y[S]=i.a3.rain[S].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(g){this._transitionable.setTransitionOrValue(this._options,new Map(g))}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}_validate(g,o,d){return(!d||d.validate!==!1)&&Go(this,g.call(Ua,i.l({value:o,style:{glyphs:!0,sprite:!0},styleSpec:i.a3})))}};class $r extends i.E{constructor(o,d,y,S){super(),this.scope=y,this._options=o,this.properties=new i.ad(d),this._transitionable=new i.a4(d,y,new Map(S)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,d){this._options=o,this._transitionable.setTransitionOrValue(o.properties,d)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ur{constructor(o,d,y,S){this.screenBounds=o,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,S)}static createFromScreenPoints(o,d){let y,S;if(o instanceof i.P||typeof o[0]=="number"){const N=i.P.convert(o);y=[N],S=d.isPointAboveHorizon(N)}else{const N=i.P.convert(o[0]),k=i.P.convert(o[1]);y=[N,k],S=i.al(N,k).every(z=>d.isPointAboveHorizon(z))}return new Ur(y,d.getCameraPoint(),S,d)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return i.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.al(d,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<y.x?S.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?S[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(S[3]=this.cameraPoint)),i.am(S,o)}bufferedCameraGeometryGlobe(o){const d=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],S=i.al(d,y,o),N=this.cameraPoint.clone();switch(3*((N.y>d.y)+(N.y>y.y))+((N.x>d.x)+(N.x>y.x))){case 0:S[0]=N,S[4]=N.clone();break;case 1:S.splice(1,0,N);break;case 2:S[1]=N;break;case 3:S.splice(4,0,N);break;case 5:S.splice(2,0,N);break;case 6:S[3]=N;break;case 7:S.splice(3,0,N);break;case 8:S[2]=N}return S}containsTile(o,d,y,S=0){const N=o.queryPadding/d._pixelsPerMercatorPixel+1,k=y?this._bufferedCameraMercator(N,d):this._bufferedScreenMercator(N,d);let z=o.tileID.wrap+(k.unwrapped?S:0);const G=k.polygon.map(we=>i.an(o.tileTransform,we,z));if(!i.ao(G,0,0,i.ag,i.ag))return;z=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?S:0);const Z=this.screenGeometryMercator.polygon.map(we=>i.ap(o.tileTransform,we,z)),Y=Z.map(we=>new i.P(we[0],we[1])),re=d.getFreeCameraOptions().position||new i.aa(0,0,0),ne=i.ap(o.tileTransform,re,z),oe=Z.map(we=>{const be=i.ab.vec3.sub(we,we,ne);return i.ab.vec3.normalize(be,be),new i.aq(ne,be)}),_e=i.ar(o,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:oe,bufferedTilespaceGeometry:G,bufferedTilespaceBounds:(me=i.as(G),me.min.x=i.aw(me.min.x,0,i.ag),me.min.y=i.aw(me.min.y,0,i.ag),me.max.x=i.aw(me.max.x,0,i.ag),me.max.y=i.aw(me.max.y,0,i.ag),me),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:_e};var me}_bufferedScreenMercator(o,d){const y=wn(o);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),d):{polygon:this.bufferedScreenGeometry(o).map(N=>d.pointCoordinate3D(N)),unwrapped:!0},this._screenRaycastCache[y]=S,S}}_bufferedCameraMercator(o,d){const y=wn(o);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let S;return S=d.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),d):{polygon:this.bufferedCameraGeometry(o).map(N=>d.pointCoordinate3D(N)),unwrapped:!0},this._cameraRaycastCache[y]=S,S}}_projectAndResample(o,d){const y=function(N,k){const z=i.ab.mat4.multiply([],k.pixelMatrix,k.globeMatrix),G=[0,-i.ax,0,1],Z=[0,i.ax,0,1],Y=[0,0,0,1];i.ab.vec4.transformMat4(G,G,z),i.ab.vec4.transformMat4(Z,Z,z),i.ab.vec4.transformMat4(Y,Y,z);const re=new i.P(G[0]/G[3],G[1]/G[3]),ne=new i.P(Z[0]/Z[3],Z[1]/Z[3]),oe=i.au(N,re)&&G[3]<Y[3],_e=i.au(N,ne)&&Z[3]<Y[3];if(!oe&&!_e)return null;const me=function(Ke,Ge,Ye){for(let it=1;it<Ke.length;it++){const bt=Kn(Ge.pointCoordinate3D(Ke[it-1]).x),pt=Kn(Ge.pointCoordinate3D(Ke[it]).x);if(Ye<0){if(bt<pt)return{idx:it,t:-bt/(pt-1-bt)}}else if(pt<bt)return{idx:it,t:(1-bt)/(pt+1-bt)}}return null}(N,k,oe?-1:1);if(!me)return null;const{idx:we,t:be}=me;let Ee=we>1?On(N.slice(0,we),k):[],$e=we<N.length?On(N.slice(we),k):[];Ee=Ee.map(Ke=>new i.P(Kn(Ke.x),Ke.y)),$e=$e.map(Ke=>new i.P(Kn(Ke.x),Ke.y));const Ve=[...Ee];Ve.length===0&&Ve.push($e[$e.length-1]);const Qe=i.af(Ve[Ve.length-1].y,($e.length===0?Ee[0]:$e[0]).y,be);let We;return We=oe?[new i.P(0,Qe),new i.P(0,0),new i.P(1,0),new i.P(1,Qe)]:[new i.P(1,Qe),new i.P(1,1),new i.P(0,1),new i.P(0,Qe)],Ve.push(...We),$e.length===0?Ve.push(Ee[0]):Ve.push(...$e),{polygon:Ve.map(Ke=>new i.aa(Ke.x,Ke.y)),unwrapped:!1}}(o,d);if(y)return y;const S=function(N,k){let z=!1,G=-1/0,Z=0;for(let re=0;re<N.length-1;re++)N[re].x>G&&(G=N[re].x,Z=re);for(let re=0;re<N.length-1;re++){const ne=(Z+re)%(N.length-1),oe=N[ne],_e=N[ne+1];Math.abs(oe.x-_e.x)>.5&&(oe.x<_e.x?(oe.x+=1,ne===0&&(N[N.length-1].x+=1)):(_e.x+=1,ne+1===N.length-1&&(N[0].x+=1)),z=!0)}const Y=i.at(k.center.lng);return z&&Y<Math.abs(Y-1)&&N.forEach(re=>{re.x-=1}),{polygon:N,unwrapped:z}}(On(o,d).map(N=>new i.P(Kn(N.x),N.y)),d);return{polygon:S.polygon.map(N=>new i.aa(N.x,N.y)),unwrapped:S.unwrapped}}}function On(g,o){return i.av(g,d=>{const y=o.pointCoordinate3D(d);d.x=y.x,d.y=y.y},1/256)}function Kn(g){return g<0?1+g%1:g%1}function wn(g){return 100*g|0}function Un(g,o,d,y,S){const N=function(z,G){if(z)return S(z);if(G){if(g.url&&G.tiles&&g.tiles&&delete g.tiles,G.variants){if(!Array.isArray(G.variants))return S(new Error("variants must be an array"));for(const Y of G.variants){if(Y==null||typeof Y!="object"||Y.constructor!==Object)return S(new Error("variant must be an object"));if(!Array.isArray(Y.capabilities))return S(new Error("capabilities must be an array"));if(Y.capabilities.length===1&&Y.capabilities[0]==="meshopt"){G=i.l(G,Y);break}}}const Z=i.ay(i.l({},G,g),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);Z.tiles=o.canonicalizeTileset(Z,g.url),S(null,Z)}},k=function(z,G,Z){if(!z)return null;if(!G&&!Z)return z;Z=Z||z.worldview_default;const Y=Object.values(z.language||{});if(Y.length===0)return null;const re=Object.values(z.worldview||{});if(re.length===0)return null;const ne=Y.every(_e=>_e===G),oe=re.every(_e=>_e===Z);return ne&&oe?z:G in(z.language_options||{})||Z in(z.worldview_options||{})?null:z.language_options&&z.worldview_options?z:null}(g.data,d,y);return k?i.q.frame(()=>N(null,k)):g.url?i.n(o.transformRequest(o.normalizeSourceURL(g.url,null,d,y),i.R.Source),N):i.q.frame(()=>{const{data:z,...G}=g;N(null,G)})}class Rn{constructor(o,d,y){this.bounds=i.az.convert(this.validateBounds(o)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const d=Math.pow(2,o.z),y=Math.floor(i.at(this.bounds.getWest())*d),S=Math.floor(i.aA(this.bounds.getNorth())*d),N=Math.ceil(i.at(this.bounds.getEast())*d),k=Math.ceil(i.aA(this.bounds.getSouth())*d);return o.x>=y&&o.x<N&&o.y>=S&&o.y<k}}class ja extends i.E{constructor(o,d,y,S){if(super(),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ay(d,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},d),this._collectResourceTiming=!!d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S),this._tileWorkers={},this._deduped=new i.aB}load(o){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=Un(this._options,this.map._requestManager,d,y,(S,N)=>{if(this._tileJSONRequest=null,this._loaded=!0,S)d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new i.y(S));else if(N){if(i.l(this,N),this.hasWorldviews=!!N.worldview_options,N.worldview_default&&(this.worldviewDefault=N.worldview_default),N.vector_layers){this.vectorLayers=N.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const k of N.vector_layers)this.vectorLayerIds.push(k.id),N.worldview&&N.worldview[k.source]&&this.localizableLayerIds.add(k.id)}N.bounds&&(this.tileBounds=new Rn(N.bounds,this.minzoom,this.maxzoom)),ot(N.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}o&&o(S)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(o,d){const y=o.tileID.canonical.url(this.tiles,this.scheme),S=this.map._requestManager.normalizeTileURL(y),N=this.map._requestManager.transformRequest(S,i.R.Tile),k=this.map.style?this.map.style.getLut(this.scope):null,z=k?{image:k.image.clone()}:null,G={request:N,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:z,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(y)&&(G.worldview=this.map.getWorldview()||this.worldviewDefault,G.localizableLayerIds=this.localizableLayerIds),G.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=d:o.request=o.actor.send("reloadTile",G,Z.bind(this));else if(o.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",G,Z.bind(this),void 0,!0);else{const Y=i.aD.call({deduped:this._deduped},G,(re,ne)=>{re||!ne?Z.call(this,re):(G.data={cacheControl:ne.cacheControl,expires:ne.expires,rawData:ne.rawData.slice(0)},o.actor&&o.actor.send("loadTile",G,Z.bind(this),void 0,!0))},!0);o.request={cancel:Y}}function Z(Y,re){return delete o.request,o.aborted?d(null):Y&&Y.status!==404?d(Y):(re&&re.resourceTiming&&(o.resourceTiming=re.resourceTiming),this.map._refreshExpiredTiles&&re&&o.setExpiryData(re),o.loadVectorData(re,this.map.painter),i.aE(this.dispatcher),d(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,d){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class gs extends i.E{constructor(o,d,y,S){super(),this.id=o,this.dispatcher=y,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},d),i.l(this,i.ay(d,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Un(this._options,this.map._requestManager,null,null,(d,y)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new i.y(d)):y&&(i.l(this,y),y.raster_layers&&(this.rasterLayers=y.raster_layers,this.rasterLayerIds=this.rasterLayers.map(S=>S.id)),y.bounds&&(this.tileBounds=new Rn(y.bounds,this.minzoom,this.maxzoom)),ot(y.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),o&&o(d)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,d){const y=i.q.devicePixelRatio>=2,S=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);o.request=i.o(this.map._requestManager.transformRequest(S,i.R.Tile),(N,k,z,G)=>(delete o.request,o.aborted?(o.state="unloaded",d(null)):N?(o.state="errored",d(N)):k?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:z,expires:G}),o.setTexture(k,this.map.painter),o.state="loaded",i.aE(this.dispatcher),void d(null)):d(null)))}abortTile(o,d){o.request&&(o.request.cancel(),delete o.request),d&&d()}unloadTile(o,d){o.texture&&o.texture instanceof i.T?(o.destroy(!0),o.texture&&o.texture instanceof i.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),d&&d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class $a extends gs{constructor(o,d,y,S){super(o,d,y,S),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},d)}triggerRepaint(o){const d=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);d&&d.enabled&&y&&d._clearRenderCacheForTile(y.id,o.tileID),this.map.triggerRepaint()}loadTile(o,d){const y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),S=this.map._requestManager.transformRequest(y,i.R.Tile);o.requestParams=S,o.actor||(o.actor=this.dispatcher.getActor()),o.request=o.fetchHeader(void 0,(N,k,z,G)=>{if(delete o.request,o.aborted)return o.state="unloaded",d(null);if(N)return N.code===20?void 0:(o.state="errored",d(N));this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:z,expires:G}),o.state="empty",d(null)})}unloadTile(o,d){const y=o.texture;y&&y instanceof i.T?(o.destroy(!0),this.map.painter.saveTileTexture(y)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,d,y){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(d,y,(S,N)=>{if(S)return o.state="errored",this.fire(new i.y(S)),void this.triggerRepaint(o);N&&(o.setTexture(N,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const d=this.rasterLayers.find(({id:N})=>N===o),y=d&&d.fields,S=y&&y.bands&&y.bands;return S?S[0]:0}getTextureDescriptor(o,d,y){if(!o)return;const S=d.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!S)return;let N=null;d instanceof i.aH?N=d.paint.get("raster-array-band"):d instanceof i.aI&&(N=d.paint.get("raster-particle-array-band"));const k=N||this.getInitialBand(S);if(k!=null)if(o.textureDescriptor){if(!o.updateNeeded(S,k)||y)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,S,k)}}const rs={vector:ja,raster:gs,"raster-dem":class extends gs{constructor(g,o,d,y){super(g,o,d,y),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(S,N){S&&(g.state="errored",o(S)),N&&(g.dem=N,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=i.o(this.map._requestManager.transformRequest(d,i.R.Tile),(function(S,N,k,z){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(S)g.state="errored",o(S);else if(N){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:k,expires:z});const G=ImageBitmap&&N instanceof ImageBitmap&&i.t(),Z=1-(N.width-i.aF(N.width))/2;Z<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const Y=G?N:i.q.getImageData(N,Z),re={uid:g.uid,coord:g.tileID,source:this.id,scope:this.scope,rawImageData:Y,encoding:this.encoding,padding:Z};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",re,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,d=Math.pow(2,o.z),y=(o.x-1+d)%d,S=o.x===0?g.wrap-1:g.wrap,N=(o.x+1+d)%d,k=o.x+1===d?g.wrap+1:g.wrap,z={};return z[new i.aG(g.overscaledZ,S,o.z,y,o.y).key]={backfilled:!1},z[new i.aG(g.overscaledZ,k,o.z,N,o.y).key]={backfilled:!1},o.y>0&&(z[new i.aG(g.overscaledZ,S,o.z,y,o.y-1).key]={backfilled:!1},z[new i.aG(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},z[new i.aG(g.overscaledZ,k,o.z,N,o.y-1).key]={backfilled:!1}),o.y+1<d&&(z[new i.aG(g.overscaledZ,S,o.z,y,o.y+1).key]={backfilled:!1},z[new i.aG(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},z[new i.aG(g.overscaledZ,k,o.z,N,o.y+1).key]={backfilled:!1}),z}},"raster-array":$a,geojson:class extends i.E{constructor(g,o,d,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(y),this._data=o.data,this._options=i.l({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const S=i.ag/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*S,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*S,extent:i.ag,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:i.ag,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*S,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}updateData(g){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof g!="string"&&(g.type==="Feature"&&(g={type:"FeatureCollection",features:[g]}),g.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof g!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const d of this._data.features)o.set(d.id,d);for(const d of g.features)o.set(d.id,d);this._data.features=[...o.values()]}else this._data=g;return this._updateWorkerData(!0),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id,scope:this.scope},o),this}getClusterLeaves(g,o,d,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:g,limit:o,offset:d},y),this}_updateWorkerData(g=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const o=i.l({append:g},this.workerOptions);o.scope=this.scope;const d=this._data;typeof d=="string"?(o.request=this.map._requestManager.transformRequest(i.q.resolveURL(d),i.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(d),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(y,S)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new i.y(y));else{const N={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(N.resourceTiming=S.resourceTiming[this.id]),g&&(this._partialReload=!0),this.fire(new i.z("data",N)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(g),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g),this._updateWorkerData()}loadTile(g,o){const d=g.actor?"reloadTile":"loadTile";g.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,S=y?{image:y.image.clone()}:null,N=this._partialReload,k={type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:S,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:N};g.request=this.actor.send(d,k,(z,G)=>N&&!G?(g.state="loaded",o(null)):(delete g.request,g.destroy(),g.aborted?o(null):z?o(z):(g.loadVectorData(G,this.map.painter,d==="reloadTile"),o(null))),void 0,d==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g,o){this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id,scope:this.scope}),g.destroy()}onRemove(g){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aJ{constructor(g,o,d,y){super(g,o,d,y),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,i.R.Source).url);i.aK(this.urls,(o,d)=>{this._loaded=!0,o?this.fire(new i.y(o)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(g,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aJ,model:class extends i.E{constructor(g,o,d,y){super(),this.id=g,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const g=[];for(const o in this._options.models){const d=this._options.models[o],y=i.aM(this.map._requestManager.transformRequest(d.uri,i.R.Model).url).then(S=>{if(!S)return;const N=i.aN(S),k=new i.aO(o,d.position,d.orientation,N);k.computeBoundsAndApplyParent(),this.models.push(k)}).catch(S=>{this.fire(new i.y(new Error(`Could not load model ${o} from ${d.uri}: ${S.message}`)))});g.push(y)}return Promise.allSettled(g).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this.fire(new i.y(new Error(`Could not load models: ${o.message}`)))})}onAdd(g){this.map=g,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(g,o){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(g,o,d,y){super(),this.type="batched-model",this.id=g,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=d,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(g){this.map=g,this.load()}reload(){this.cancelTileJSONRequest();const g=i.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(g))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(g){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=Un(this._options,this.map._requestManager,o,d,(y,S)=>{this._tileJSONRequest=null,this._loaded=!0,y?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),d&&d.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new i.y(y))):S&&(i.l(this,S),S.bounds&&(this.tileBounds=new Rn(S.bounds,this.minzoom,this.maxzoom)),ot(S.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),g&&g(y)})}hasTransition(){return!1}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}loaded(){return this._loaded}loadTile(g,o){const d=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(d,i.R.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:g.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(g.actor&&g.state!=="expired")if(g.state==="loading")g.reloadCallback=o;else{if(g.buckets){const N=Object.values(g.buckets);for(const k of N)k.dirty=!0;return void(g.state="loaded")}g.request=g.actor.send("reloadTile",y,S.bind(this))}else g.actor=this.dispatcher.getActor(),g.request=g.actor.send("loadTile",y,S.bind(this),void 0,!0);function S(N,k){return g.aborted?o(null):N&&N.status!==404?o(N):(this.map._refreshExpiredTiles&&k&&g.setExpiryData(k),g.loadModelData(k,this.map.painter),g.state="loaded",void o(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aJ{constructor(g,o,d,y){super(g,o,d,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(N=>typeof N!="number"))||this.fire(new i.y(new i.V(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(g){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!g&&!this._playing||this.texture instanceof i.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends i.E{constructor(g,o,d,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=o,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Rn(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ay(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this.map=g,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:d,z:y}=g.canonical;return this._implementation.hasTile({x:o,y:d,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:d,y,z:S}=g.tileID.canonical,N=new AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:d,y,z:S},{signal:N.signal})).then((function(k){return delete g.request,g.aborted?(g.state="unloaded",o(null)):k===void 0?(g.state="errored",o(null)):k===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):function(z){return z instanceof ImageData||z instanceof HTMLCanvasElement||z instanceof ImageBitmap||z instanceof HTMLImageElement}(k)?(this.loadTileData(g,k),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(k=>{k.code!==20&&(g.state="errored",o(k))}),g.request.cancel=()=>N.abort()}loadTileData(g,o){g.setTexture(o,this.map.painter)}unloadTile(g,o){if(g.texture&&g.texture instanceof i.T?(g.destroy(!0),g.texture&&g.texture instanceof i.T&&this.map.painter.saveTileTexture(g.texture)):g.destroy(),this._implementation.unloadTile){const{x:d,y,z:S}=g.tileID.canonical;this._implementation.unloadTile({x:d,y,z:S})}o&&o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){const g=i.aC(this.id,this.scope);this.map.style.clearSource(g)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},ho=function(g,o,d,y){const S=new rs[o.type](g,o,d,y);if(S.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${S.id}`);return i.aP(["load","abort","unload","serialize","prepare"],S),S};function qu(g,o,d=""){return`${d}:${o.id||""}:${o.layer.id}:${function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:S,importId:N}=y;return`featureset:${S}${N?`:import:${N}`:""}`}}(g.target)}`}function Ml(g,o,d,y=""){if(g.uniqueFeatureID){const S=qu(g,o,y);if(d.has(S))return!0;d.add(S)}return!1}function Qc(g,o,d,y,S=!1){const N=o.sourceCache.transform,k=o.sourceCache.tilesIn(g,o.has3DLayers,S);k.sort(vy);const z=[];for(const G of k){const Z=G.tile.queryRenderedFeatures(o,G,d,y,N,S);Object.keys(Z).length&&z.push({wrappedTileID:G.tile.tileID.wrapped().key,queryResults:Z})}return z.length===0?{}:function(G){const Z={},Y={};for(const re of G){const ne=re.queryResults,oe=re.wrappedTileID,_e=Y[oe]=Y[oe]||{};for(const me in ne){const we=ne[me],be=_e[me]=_e[me]||{},Ee=Z[me]=Z[me]||[];for(const $e of we)be[$e.featureIndex]||(be[$e.featureIndex]=!0,Ee.push($e))}}return Z}(z)}function tf(g,o,d,y,S){const N={},k=y.queryRenderedSymbols(g),z=[];for(const G of Object.keys(k).map(Number))z.push(S[G]);z.sort(vy);for(const G of z){const Z=G.featureIndex.lookupSymbolFeatures(k[G.bucketInstanceId],G.bucketIndex,G.sourceLayerIndex,o,d);for(const Y in Z){const re=N[Y]=N[Y]||[],ne=Z[Y];ne.sort((oe,_e)=>{const me=G.featureSortOrder;if(me){const we=me.indexOf(oe.featureIndex);return me.indexOf(_e.featureIndex)-we}return _e.featureIndex-oe.featureIndex});for(const oe of ne)re.push(oe)}}return N}function ov(g,o){const d=g.getRenderableIds().map(N=>g.getTileByID(N)),y=[],S={};for(let N=0;N<d.length;N++){const k=d[N],z=k.tileID.canonical.key;S[z]||(S[z]=!0,k.querySourceFeatures(y,o))}return y}function vy(g,o){const d=g.tileID,y=o.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}function mp(g,o){const d={};if(!o)return d;for(const y of g){const S=y.layerIds.map(N=>o.getLayer(N)).filter(Boolean);if(S.length!==0){y.layers=S,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(N=>S.filter(k=>k.id===N)[0]));for(const N of S)d[N.fqid]=y}}return d}const Ys=32,fl=33,pl=new Uint16Array(8184);for(let g=0;g<2046;g++){let o=g+2,d=0,y=0,S=0,N=0,k=0,z=0;for(1&o?S=N=k=Ys:d=y=z=Ys;(o>>=1)>1;){const Z=d+S>>1,Y=y+N>>1;1&o?(S=d,N=y,d=k,y=z):(d=S,y=N,S=k,N=z),k=Z,z=Y}const G=4*g;pl[G+0]=d,pl[G+1]=y,pl[G+2]=S,pl[G+3]=N}const Ac=new Uint16Array(2178),ml=new Uint8Array(1089),_i=new Uint16Array(1089);function gp(g){return g===0?-.03125:g===32?.03125:0}const Rm={type:2,extent:i.ag,loadGeometry:()=>[[new i.P(0,0),new i.P(i.ag+1,0),new i.P(i.ag+1,i.ag+1),new i.P(0,i.ag+1),new i.P(0,0)]]};class Tc{constructor(o,d,y,S,N){this.tileID=o,this.uid=i.aV(),this.uses=0,this.tileSize=d,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=N,S&&S.style&&(this._lastUpdatedBrightness=S.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",S&&S.transform&&(this.projection=S.transform.projection)}registerFadeDuration(o){const d=o+this.timeAdded;d<i.q.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,d,y){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=mp(o.buckets,d.style),this.hasSymbolBuckets=!1;for(const S in this.buckets){const N=this.buckets[S];if(N instanceof i.aX){if(this.hasSymbolBuckets=!0,!y)break;N.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const S in this.buckets){const N=this.buckets[S];if(N instanceof i.aX&&N.hasRTLText){this.hasRTLText=!0,i.aY();break}}this.queryPadding=0;for(const S in this.buckets){const N=this.buckets[S],k=d.style.getOwnLayer(S);if(!k)continue;const z=k.queryRadius(N);this.queryPadding=Math.max(this.queryPadding,z)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new i.aW}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,d,y){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,mp(o.buckets,d.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const S in this.buckets){const N=this.buckets[S];N.uploadPending()&&N.upload(o)}const d=o.gl,y=this.imageAtlas;if(y&&!y.uploaded){const S=!!Object.keys(y.patternPositions).length;this.imageAtlasTexture=new i.T(o,y.image,d.RGBA8,{useMipmap:S}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(o,this.glyphAtlasImage,d.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(o,this.lineAtlas.image,d.R8),this.lineAtlas.uploaded=!0)}prepare(o,d,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,y),!d||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const S=d.style.getBrightness();(this._lastUpdatedBrightness||S)&&(this._lastUpdatedBrightness&&S&&Math.abs(this._lastUpdatedBrightness-S)<.001||(this.updateBuckets(d,this._lastUpdatedBrightness!==S),this._lastUpdatedBrightness=S))}queryRenderedFeatures(o,d,y,S,N,k){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const z=function(G,Z){const Y=i.ab.mat4.fromScaling([],[.5*G.width,.5*-G.height,1]);return i.ab.mat4.translate(Y,Y,[1,-1,0]),i.ab.mat4.multiply(Y,Y,G.calculateProjMatrix(Z.toUnwrapped())),Float32Array.from(Y)}(N,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:d,pixelPosMatrix:z,transform:S,availableImages:y,tileTransform:this.tileTransform})}querySourceFeatures(o,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const S=y.loadVTLayers(),N=d?d.sourceLayer:"",k=S._geojsonTileLayer||S[N];if(!k)return;const z=i.aZ(d&&d.filter),{z:G,x:Z,y:Y}=this.tileID.canonical,re={z:G,x:Z,y:Y};for(let ne=0;ne<k.length;ne++){const oe=k.feature(ne);if(z.needGeometry){const we=i.a_(oe,!0);if(!z.filter(new i.a8(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!z.filter(new i.a8(this.tileID.overscaledZ),oe))continue;const _e=y.getId(oe,N),me=new i.a$(oe,G,Z,Y,_e);me.tile=re,o.push(me)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const d=this.expirationTime;if(o.cacheControl){const y=i.b0(o.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const y=Date.now();let S=!1;if(this.expirationTime>y)S=!1;else if(d)if(this.expirationTime<d)S=!0;else{const N=this.expirationTime-d;N?this.expirationTime=y+Math.max(N,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,d){if(!this.latestFeatureIndex||!o.style)return;const y=this.latestFeatureIndex.loadVTLayers(),S=o.style.listImages(),N=o.style.getBrightness();for(const k in this.buckets){if(!o.style.hasLayer(k))continue;const z=this.buckets[k],G=z.layers[0],Z=G.sourceLayer||"_geojsonTileLayer",Y=y[Z],re=o.style.getLayerSourceCache(G);let ne={};re&&(ne=re._state.getState(Z,void 0));const oe=this.imageAtlas&&this.imageAtlas.patternPositions||{},_e=Object.keys(ne).length>0&&!d;_e&&!z.stateDependentLayers.length&&!d||z.update(ne,Y,S,oe,_e?z.stateDependentLayers:z.layers,d,N),(z instanceof i.b1||z instanceof i.b2)&&o._terrain&&o._terrain.enabled&&re&&z.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(re.id,this.tileID);const me=o&&o.style&&o.style.getOwnLayer(k);me&&(this.queryPadding=Math.max(this.queryPadding,me.queryRadius(z)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=i.q.now()+o}setTexture(o,d){const y=d.context,S=y.gl;this.texture=this.texture||d.getTileTexture(o.width),this.texture&&this.texture instanceof i.T?this.texture.update(o):(this.texture=new i.T(y,o,S.RGBA8,{useMipmap:!0}),this.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE))}setDependencies(o,d){const y={};for(const S of d)y[S]=!0;this.dependencies[o]=y}hasDependency(o,d){for(const y of o){const S=this.dependencies[y];if(S){for(const N of d)if(S[N])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,d){if(!d||d.name==="mercator"||this._tileDebugBuffer)return;const y=i.b3(Rm,this.tileID.canonical,this.tileTransform)[0],S=new i.b4,N=new i.b5;for(let k=0;k<y.length;k++){const{x:z,y:G}=y[k];S.emplaceBack(z,G),N.emplaceBack(k)}N.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(N),this._tileDebugBuffer=o.createVertexBuffer(S,i.b6.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,S.length,N.length)}_makeTileBoundsBuffers(o,d){if(this._tileBoundsBuffer||!d||d.name==="mercator")return;const y=i.b3(Rm,this.tileID.canonical,this.tileTransform)[0];let S,N;if(this.isRaster){const k=function(z,G){const Z=i.aQ(z,G),Y=Math.pow(2,z.z);for(let we=0;we<fl;we++)for(let be=0;be<fl;be++){const Ee=i.aR((z.x+(be+gp(be))/Ys)/Y),$e=i.aS((z.y+(we+gp(we))/Ys)/Y),Ve=G.project(Ee,$e),Qe=we*fl+be;Ac[2*Qe+0]=Math.round((Ve.x*Z.scale-Z.x)*i.ag),Ac[2*Qe+1]=Math.round((Ve.y*Z.scale-Z.y)*i.ag)}ml.fill(0),_i.fill(0);for(let we=2045;we>=0;we--){const be=4*we,Ee=pl[be+0],$e=pl[be+1],Ve=pl[be+2],Qe=pl[be+3],We=Ee+Ve>>1,Ke=$e+Qe>>1,Ge=We+Ke-$e,Ye=Ke+Ee-We,it=$e*fl+Ee,bt=Qe*fl+Ve,pt=Ke*fl+We,kt=Math.hypot((Ac[2*it+0]+Ac[2*bt+0])/2-Ac[2*pt+0],(Ac[2*it+1]+Ac[2*bt+1])/2-Ac[2*pt+1])>=16;ml[pt]=ml[pt]||(kt?1:0),we<1022&&(ml[pt]=ml[pt]||ml[($e+Ye>>1)*fl+(Ee+Ge>>1)]||ml[(Qe+Ye>>1)*fl+(Ve+Ge>>1)])}const re=new i.aT,ne=new i.aU;let oe=0;function _e(we,be){const Ee=be*fl+we;return _i[Ee]===0&&(re.emplaceBack(Ac[2*Ee+0],Ac[2*Ee+1],we*i.ag/Ys,be*i.ag/Ys),_i[Ee]=++oe),_i[Ee]-1}function me(we,be,Ee,$e,Ve,Qe){const We=we+Ee>>1,Ke=be+$e>>1;if(Math.abs(we-Ve)+Math.abs(be-Qe)>1&&ml[Ke*fl+We])me(Ve,Qe,we,be,We,Ke),me(Ee,$e,Ve,Qe,We,Ke);else{const Ge=_e(we,be),Ye=_e(Ee,$e),it=_e(Ve,Qe);ne.emplaceBack(Ge,Ye,it)}}return me(0,0,Ys,Ys,Ys,0),me(Ys,Ys,0,0,0,Ys),{vertices:re,indices:ne}}(this.tileID.canonical,d);S=k.vertices,N=k.indices}else{S=new i.aT,N=new i.aU;for(const{x:z,y:G}of y)S.emplaceBack(z,G,0,0);const k=i.b8(S.int16,void 0,4);for(let z=0;z<k.length;z+=3)N.emplaceBack(k[z],k[z+1],k[z+2])}this._tileBoundsBuffer=o.createVertexBuffer(S,i.b9.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(N),this._tileBoundsSegments=i.b7.simpleSegment(0,0,S.length,N.length)}_makeGlobeTileDebugBuffers(o,d){const y=d.projection;if(!y||y.name!=="globe"||d.freezeTileCoverage)return;const S=this.tileID.canonical,N=i.ba(S,d),k=i.bb(N),z=i.ae(d.zoom);let G;z>0&&(G=i.ab.mat4.invert(new Float64Array(16),d.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,S,d,k,G,z),this._makeGlobeTileDebugTextBuffer(o,S,d,k,G,z)}_globePoint(o,d,y,S,N,k,z){let G=i.bc(o,d,y);if(k){const Z=1<<y.z,Y=i.at(S.center.lng),re=i.aA(S.center.lat),ne=(y.x+.5)/Z-Y;let oe=0;ne>.5?oe=-1:ne<-.5&&(oe=1);let _e=(o/i.ag+y.x)/Z+oe,me=(d/i.ag+y.y)/Z;_e=(_e-Y)*S._pixelsPerMercatorPixel+Y,me=(me-re)*S._pixelsPerMercatorPixel+re;const we=[_e*S.worldSize,me*S.worldSize,0];i.ab.vec3.transformMat4(we,we,k),G=i.bd(G,we,z)}return i.ab.vec3.transformMat4(G,G,N)}_makeGlobeTileDebugBorderBuffer(o,d,y,S,N,k){const z=new i.b4,G=new i.b5,Z=new i.be,Y=(ne,oe,_e,me,we)=>{const be=(_e-ne)/(we-1),Ee=(me-oe)/(we-1),$e=z.length;for(let Ve=0;Ve<we;Ve++){const Qe=ne+Ve*be,We=oe+Ve*Ee;z.emplaceBack(Qe,We);const Ke=this._globePoint(Qe,We,d,y,S,N,k);Z.emplaceBack(Ke[0],Ke[1],Ke[2]),G.emplaceBack($e+Ve)}},re=i.ag;Y(0,0,re,0,16),Y(re,0,re,re,16),Y(re,re,0,re,16),Y(0,re,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(G),this._tileDebugBuffer=o.createVertexBuffer(z,i.b6.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(Z,i.bf.members),this._tileDebugSegments=i.b7.simpleSegment(0,0,z.length,G.length)}_makeGlobeTileDebugTextBuffer(o,d,y,S,N,k){const z=i.ag/4,G=new i.b4,Z=new i.aU,Y=new i.be,re=25;Z.reserve(32),G.reserve(re),Y.reserve(re);const ne=(oe,_e)=>re*oe+_e;for(let oe=0;oe<re;oe++){const _e=oe*z;for(let me=0;me<re;me++){const we=me*z;G.emplaceBack(we,_e);const be=this._globePoint(we,_e,d,y,S,N,k);Y.emplaceBack(be[0],be[1],be[2])}}for(let oe=0;oe<4;oe++)for(let _e=0;_e<4;_e++){const me=ne(oe,_e),we=ne(oe,_e+1),be=ne(oe+1,_e),Ee=ne(oe+1,_e+1);Z.emplaceBack(me,we,be),Z.emplaceBack(be,we,Ee)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(Z),this._tileDebugTextBuffer=o.createVertexBuffer(G,i.b6.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(Y,i.bf.members),this._tileDebugTextSegments=i.b7.simpleSegment(0,0,re,32)}destroy(o=!1){for(const d in this.buckets)this.buckets[d].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bg.setPbf(i.bh);class eu extends Tc{constructor(o,d,y,S,N){super(o,d,y,S,N),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(o,d){const y=d.context,S=y.gl;this.texture=this.texture||d.getTileTexture(o.width),this.texture&&this.texture instanceof i.T?this.texture.update(o,{premultiply:!1}):this.texture=new i.T(y,o,S.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(o=16384,d){const y=this._mrt=new i.bg(30),S=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=i.bi(S,(N,k,z,G)=>{if(N)d(N);else try{const Z=y.getHeaderLength(k);if(Z>o)return void(this.request=this.fetchHeader(Z,d));y.parseHeader(k),this._isHeaderLoaded=!0;let Y=0;for(const re of Object.values(y.layers))Y=Math.max(Y,re.dataIndex[re.dataIndex.length-1].last_byte);k.byteLength>=Y&&(this.entireBuffer=k),d(null,this.entireBuffer||k,z,G)}catch(Z){d(Z)}}),this.request}fetchBand(o,d,y){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void y(new Error("Tile header is not ready"));const N=this.actor;if(!N)return void y(new Error("Can't fetch tile band without an actor"));let k;const z=(re,ne)=>{k.complete(re,ne),re?y(re):(this.updateTextureDescriptor(o,d),y(null,this.textureDescriptor&&this.textureDescriptor.img))},G=(re,ne)=>{if(re)return y(re);const oe=N.send("decodeRasterArray",{buffer:ne,task:k},z,void 0,!0);this._workQueue.push(()=>{oe&&oe.cancel(),k.cancel()})},Z=S.getLayer(o);if(!Z)return void y(new Error(`Unknown sourceLayer "${o}"`));if(Z.hasDataForBand(d))return this.updateTextureDescriptor(o,d),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const Y=Z.getDataRange([d]);if(k=S.createDecodingTask(Y),!k||k.tasks.length)if(this.flushQueues(),this.entireBuffer)G(null,this.entireBuffer.slice(Y.firstByte,Y.lastByte+1));else{const re=Object.assign({},this.requestParams,{headers:{Range:`bytes=${Y.firstByte}-${Y.lastByte}`}}),ne=i.bi(re,G);this._fetchQueue.push(()=>{ne.cancel(),k.cancel()})}else y(null)}updateNeeded(o,d){return(!this.textureDescriptor||this.textureDescriptor.band!==d||this.textureDescriptor.layer!==o)&&this.state!=="errored"}updateTextureDescriptor(o,d){if(!this._mrt)return;const y=this._mrt.getLayer(o);if(!y||!y.hasBand(d)||!y.hasDataForBand(d))return;const{bytes:S,tileSize:N,buffer:k,offset:z,scale:G}=y.getBandView(d),Z=N+2*k,Y={data:S,width:Z,height:Z},re=this.texture;re&&re instanceof i.T&&re.update(Y,{premultiply:!1}),this.textureDescriptor={layer:o,band:d,img:Y,buffer:k,offset:z,tileSize:N,format:y.pixelFormat,mix:[G,256*G,65536*G,16777216*G]}}}class xy{constructor(o,d){this.max=o,this.onRemove=d,this.reset()}reset(){for(const o in this.data)for(const d of this.data[o])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(o,d,y){const S=o.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);const N={value:d,timeout:void 0};if(y!==void 0&&(N.timeout=setTimeout(()=>{this.remove(o,N)},y)),this.data[S].push(N),this.order.push(S),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const d=this.data[o].shift();return d.timeout&&clearTimeout(d.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),d.value}getByKey(o){const d=this.data[o];return d?d[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,d){if(!this.has(o))return this;const y=o.wrapped().key,S=d===void 0?0:this.data[y].indexOf(d),N=this.data[y][S];return this.data[y].splice(S,1),N.timeout&&clearTimeout(N.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(N.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(o){const d=[];for(const y in this.data)for(const S of this.data[y])o(S.value)||d.push(S);for(const y of d)this.remove(y.value.tileID,y)}}class Im{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,d,y){const S=String(d);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][S]=this.stateChanges[o][S]||{},i.l(this.stateChanges[o][S],y),this.deletedStates[o]===null){this.deletedStates[o]={};for(const N in this.state[o])N!==S&&(this.deletedStates[o][N]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][S]===null){this.deletedStates[o][S]={};for(const N in this.state[o][S])y[N]||(this.deletedStates[o][S][N]=null)}else for(const N in y)this.deletedStates[o]&&this.deletedStates[o][S]&&this.deletedStates[o][S][N]===null&&delete this.deletedStates[o][S][N]}removeFeatureState(o,d,y){if(this.deletedStates[o]===null)return;const S=String(d);if(this.deletedStates[o]=this.deletedStates[o]||{},y&&d!==void 0)this.deletedStates[o][S]!==null&&(this.deletedStates[o][S]=this.deletedStates[o][S]||{},this.deletedStates[o][S][y]=null);else if(d!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][S])for(y in this.deletedStates[o][S]={},this.stateChanges[o][S])this.deletedStates[o][S][y]=null;else this.deletedStates[o][S]=null;else this.deletedStates[o]=null}getState(o,d){const y=this.state[o]||{},S=this.stateChanges[o]||{},N=this.deletedStates[o];if(N===null)return{};if(d!==void 0){const z=String(d),G=i.l({},y[z],S[z]);if(N){const Z=N[d];if(Z===null)return{};for(const Y in Z)delete G[Y]}return G}const k=i.l({},y,S);if(N)for(const z in N)delete k[z];return k}initializeTileState(o,d){o.refreshFeatureState(d)}coalesceChanges(o,d){const y={};for(const S in this.stateChanges){this.state[S]=this.state[S]||{};const N={};for(const k in this.stateChanges[S])this.state[S][k]||(this.state[S][k]={}),i.l(this.state[S][k],this.stateChanges[S][k]),N[k]=this.state[S][k];y[S]=N}for(const S in this.deletedStates){this.state[S]=this.state[S]||{};const N={};if(this.deletedStates[S]===null)for(const k in this.state[S])N[k]={},this.state[S][k]={};else for(const k in this.deletedStates[S]){if(this.deletedStates[S][k]===null)this.state[S][k]={};else if(this.state[S][k])for(const z of Object.keys(this.deletedStates[S][k]))delete this.state[S][k][z];N[k]=this.state[S][k]}y[S]=y[S]||{},i.l(y[S],N)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const S in o)o[S].refreshFeatureState(d)}}class Wo extends i.E{constructor(o,d,y){super(),this.id=o,this._onlySymbols=y,d.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),d.on("error",()=>{this._sourceErrored=!0}),this._source=d,this._tiles={},this._cache=new xy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Im,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const d=this._tiles[o];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,d){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,d)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(o),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bj(this._tiles).map(o=>o.tileID).sort(Qn).map(o=>o.key)}getRenderableIds(o,d){const y=[];for(const S in this._tiles)this._isIdRenderable(+S,o,d)&&y.push(this._tiles[S]);return o?y.sort((S,N)=>{const k=S.tileID,z=N.tileID,G=new i.P(k.canonical.x,k.canonical.y)._rotate(this.transform.angle),Z=new i.P(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return k.overscaledZ-z.overscaledZ||Z.y-G.y||Z.x-G.x}).map(S=>S.tileID.key):y.map(S=>S.tileID).sort(Qn).map(S=>S.key)}hasRenderableParent(o){const d=this.findLoadedParent(o,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(o,d,y){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(d||!this._tiles[o].holdingForFade())&&(y||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,d){const y=this._tiles[o];y&&(y.state!=="loading"&&(y.state=d),this._loadTile(y,this._tileLoaded.bind(this,y,o,d)))}_tileLoaded(o,d,y,S){if(S)if(o.state="errored",S.status!==404)this._source.fire(new i.y(S,{tile:o}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const N=this.map.painter.terrain;this.update(this.transform,N.getScaledDemTileSize(),!0),N.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=i.q.now(),y==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(d,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const d=this.getRenderableIds();for(let S=0;S<d.length;S++){const N=d[S];if(o.neighboringTiles&&o.neighboringTiles[N]){const k=this.getTileByID(N);y(o,k),y(k,o)}}function y(S,N){if(!S.dem||S.dem.borderReady)return;S.needsHillshadePrepare=!0,S.needsDEMTextureUpload=!0;let k=N.tileID.canonical.x-S.tileID.canonical.x;const z=N.tileID.canonical.y-S.tileID.canonical.y,G=Math.pow(2,S.tileID.canonical.z),Z=N.tileID.key;k===0&&z===0||Math.abs(z)>1||(Math.abs(k)>1&&(Math.abs(k+G)===1?k+=G:Math.abs(k-G)===1&&(k-=G)),N.dem&&S.dem&&(S.dem.backfillBorder(N.dem,k,z),S.neighboringTiles&&S.neighboringTiles[Z]&&(S.neighboringTiles[Z].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,d,y,S){for(const N in this._tiles){let k=this._tiles[N];if(S[N]||!k.hasData()||k.tileID.overscaledZ<=d||k.tileID.overscaledZ>y)continue;let z=k.tileID;for(;k&&k.tileID.overscaledZ>d+1;){const Z=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[Z.key],k&&k.hasData()&&(z=Z)}let G=z;for(;G.overscaledZ>d;)if(G=G.scaledTo(G.overscaledZ-1),o[G.key]){S[z.key]=z;break}}}findLoadedParent(o,d){if(o.key in this._loadedParentTiles){const y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=o.overscaledZ-1;y>=d;y--){const S=o.scaledTo(y),N=this._getLoadedTile(S);if(N)return N}}_getLoadedTile(o){const d=this._tiles[o.key];return d&&d.hasData()?d:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,d){d=d||this._source.tileSize;const y=Math.ceil(o.width/d)+1,S=Math.ceil(o.height/d)+1,N=Math.floor(y*S*5),k=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,N):N,z=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,k):k;this._cache.setMaxSize(z)}handleWrapJump(o){const d=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,d){const y={};for(const S in this._tiles){const N=this._tiles[S];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+d),y[N.tileID.key]=N}this._tiles=y;for(const S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(const S in this._tiles)this._setTileReloadTimer(+S,this._tiles[S])}}update(o,d,y,S){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(o,d),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const N=this._source.type==="batched-model";let k,z=this._source.maxzoom;const G=this.map&&this.map.painter?this.map.painter._terrain:null;if(G&&G.sourceCache===this&&G.attenuationRange()){const re=G.attenuationRange()[0],ne=Math.floor(re)-Math.log2(G.getDemUpscale());z>ne&&(z=ne)}if(this.used||this.usedForTerrain){if(this._source.tileID)k=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(re=>new i.aG(re.canonical.z,re.wrap,re.canonical.z,re.canonical.x,re.canonical.y));else if(this.tileCoverLift!==0){const re=o.clone();re.tileCoverLift=this.tileCoverLift,k=re.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:N}),this._source.minzoom<=1&&o.projection.name==="globe"&&(k.push(new i.aG(1,0,1,0,0)),k.push(new i.aG(1,0,1,1,0)),k.push(new i.aG(1,0,1,0,1)),k.push(new i.aG(1,0,1,1,1)))}else if(k=o.coveringTiles({tileSize:d||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:z,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:N}),this._source.hasTile){const re=this._source.hasTile.bind(this._source);k=k.filter(ne=>re(ne))}}else k=[];if(k.length>0&&this.castsShadows&&S&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Pc(this._source.type)){const re=o.coveringZoomLevel({tileSize:d||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),ne=Math.min(re,this._source.maxzoom);if(N){const oe=o.extendTileCover(k,ne);for(const _e of oe)k.push(_e)}else{const oe=o.extendTileCover(k,ne,S);for(const _e of oe)this._shadowCasterTiles[_e.key]=!0,k.push(_e)}}const Z=this._updateRetainedTiles(k);if(Pc(this._source.type)&&k.length!==0){const re={},ne={},oe=Object.keys(Z);for(const me of oe){const we=Z[me],be=this._tiles[me];if(!be||be.fadeEndTime&&be.fadeEndTime<=i.q.now())continue;const Ee=this.findLoadedParent(we,Math.max(we.overscaledZ-Wo.maxOverzooming,this._source.minzoom));Ee&&(this._addTile(Ee.tileID),re[Ee.tileID.key]=Ee.tileID),ne[me]=we}const _e=k[k.length-1].overscaledZ;for(const me in this._tiles){const we=this._tiles[me];if(Z[me]||!we.hasData())continue;let be=we.tileID;for(;be.overscaledZ>_e;){be=be.scaledTo(be.overscaledZ-1);const Ee=this._tiles[be.key];if(Ee&&Ee.hasData()&&ne[be.key]){Z[me]=we.tileID;break}}}for(const me in re)Z[me]||(this._coveredTiles[me]=!0,Z[me]=re[me])}for(const re in Z)this._tiles[re].clearFadeHold();const Y=i.bk(this._tiles,Z);for(const re of Y){const ne=this._tiles[re];ne.hasSymbolBuckets&&!ne.holdingForFade()?ne.setHoldDuration(this.map._fadeDuration):ne.hasSymbolBuckets&&!ne.symbolFadeFinished()||this._removeTile(+re)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const d={};if(o.length===0)return d;const y={},S=o.reduce((Z,Y)=>Math.min(Z,Y.overscaledZ),1/0),N=o[0].overscaledZ,k=Math.max(N-Wo.maxOverzooming,this._source.minzoom),z=Math.max(N+Wo.maxUnderzooming,this._source.minzoom),G={};for(const Z of o){const Y=this._addTile(Z);d[Z.key]=Z,Y.hasData()||S<this._source.maxzoom&&(G[Z.key]=Z)}this._retainLoadedChildren(G,S,z,d);for(const Z of o){let Y=this._tiles[Z.key];if(Y.hasData())continue;if(Z.canonical.z>=this._source.maxzoom){const ne=Z.children(this._source.maxzoom)[0],oe=this.getTile(ne);if(oe&&oe.hasData()){d[ne.key]=ne;continue}}else{const ne=Z.children(this._source.maxzoom);if(d[ne[0].key]&&d[ne[1].key]&&d[ne[2].key]&&d[ne[3].key])continue}let re=Y.wasRequested();for(let ne=Z.overscaledZ-1;ne>=k;--ne){const oe=Z.scaledTo(ne);if(y[oe.key]||(y[oe.key]=!0,Y=this.getTile(oe),!Y&&re&&(Y=this._addTile(oe)),Y&&(d[oe.key]=oe,re=Y.wasRequested(),Y.hasData())))break}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const d=[];let y,S=this._tiles[o].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){y=this._loadedParentTiles[S.key];break}d.push(S.key);const N=S.scaledTo(S.overscaledZ-1);if(y=this._getLoadedTile(N),y)break;S=N}for(const N of d)this._loadedParentTiles[N]=y}}_addTile(o){let d=this._tiles[o.key];if(d)return d.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),d;d=this._cache.getAndRemove(o),d&&(this._setTileReloadTimer(o.key,d),d.tileID=o,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,d)));const y=!!d;if(!y){const S=this.map?this.map.painter:null,N=this._source.tileSize*o.overscaleFactor();d=this._source.type==="raster-array"?new eu(o,N,this.transform.tileZoom,S,this._isRaster):new Tc(o,N,this.transform.tileZoom,S,this._isRaster),this._loadTile(d,this._tileLoaded.bind(this,d,o.key,d.state))}return d?(d.uses++,this._tiles[o.key]=d,y||this._source.fire(new i.z("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null}_setTileReloadTimer(o,d){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const y=d.getExpiryTimeout();y&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},y))}_removeTile(o){const d=this._tiles[o];d&&(d.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),d.uses>0||(d.hasData()&&d.state!=="reloading"||d.state==="empty"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,d,y){const S=[],N=this.transform;if(!N)return S;const k=N.projection.name==="globe",z=i.at(N.center.lng);for(const G in this._tiles){const Z=this._tiles[G];if(y&&Z.clearQueryDebugViz(),Z.holdingForFade())continue;let Y;if(k){const re=Z.tileID.canonical;if(re.z===0){const ne=[Math.abs(i.aw(z,...Fr(re,-1))-z),Math.abs(i.aw(z,...Fr(re,1))-z)];Y=[0,2*ne.indexOf(Math.min(...ne))-1]}else{const ne=[Math.abs(i.aw(z,...Fr(re,-1))-z),Math.abs(i.aw(z,...Fr(re,0))-z),Math.abs(i.aw(z,...Fr(re,1))-z)];Y=[ne.indexOf(Math.min(...ne))-1]}}else Y=[0];for(const re of Y){const ne=o.containsTile(Z,N,d,re);ne&&S.push(ne)}}return S}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,d){const y=this.getRenderableIds(o,d).map(N=>this._tiles[N].tileID),S=this.transform.projection.name==="globe";for(const N of y)N.projMatrix=this.transform.calculateProjMatrix(N.toUnwrapped()),N.expandedProjMatrix=S?this.transform.calculateProjMatrix(N.toUnwrapped(),!1,!0):N.projMatrix;return y}sortCoordinatesByDistance(o){const d=o.slice(),y=this.transform._camera.position,S=this.transform._camera.forward(),N={};for(const k of d){const z=1/(1<<k.canonical.z);N[k.key]=((k.canonical.x+.5)*z+k.wrap-y[0])*S[0]+((k.canonical.y+.5)*z-y[1])*S[1]-y[2]*S[2]}return d.sort((k,z)=>N[k.key]-N[z.key]),d}hasTransition(){if(this._source.hasTransition())return!0;if(Pc(this._source.type))for(const o in this._tiles){const d=this._tiles[o];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(o,d,y){this._state.updateState(o=o||"_geojsonTileLayer",d,y)}removeFeatureState(o,d,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",d,y)}getFeatureState(o,d){return this._state.getState(o=o||"_geojsonTileLayer",d)}setDependencies(o,d,y){const S=this._tiles[o];S&&S.setDependencies(d,y)}reloadTilesForDependencies(o,d){for(const y in this._tiles)this._tiles[y].hasDependency(o,d)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(o,d))}_preloadTiles(o,d){if(!this._sourceLoaded){const G=()=>{this._sourceLoaded&&(this._source.off("data",G),this._preloadTiles(o,d))};return void this._source.on("data",G)}const y=new Map,S=Array.isArray(o)?o:[o],N=this.map.painter.terrain,k=this.usedForTerrain&&N?N.getScaledDemTileSize():this._source.tileSize;for(const G of S){const Z=G.coveringTiles({tileSize:k,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const Y of Z)y.set(Y.key,Y);this.usedForTerrain&&G.updateElevation(!1)}const z=Array.from(y.values());i.bl(z,(G,Z)=>{const Y=new Tc(G,this._source.tileSize*G.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(Y,re=>{this._source.type==="raster-dem"&&Y.dem&&this._backfillDEM(Y),Z(re,Y)})},d)}}function Qn(g,o){const d=Math.abs(2*g.wrap)-+(g.wrap<0),y=Math.abs(2*o.wrap)-+(o.wrap<0);return g.overscaledZ-o.overscaledZ||y-d||o.canonical.y-g.canonical.y||o.canonical.x-g.canonical.x}function Pc(g){return g==="raster"||g==="image"||g==="video"||g==="custom"}function Fr(g,o){const d=1<<g.z;return[g.x/d+o,(g.x+1)/d+o]}Wo.maxOverzooming=10,Wo.maxUnderzooming=3;class tu{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,d=!1;for(const y in this.style._mergedLayers){const S=this.style._mergedLayers[y];if(S.type==="fill-extrusion")this.layers.push({layer:S,visible:o,visibilityChanged:d});else if(S.type==="model"){const N=this.style.getLayerSource(S);N&&N.type==="batched-model"&&this.layers.push({layer:S,visible:o,visibilityChanged:d})}}}onNewFrame(o){this.layersGotHidden=!1;for(const d of this.layers){const y=d.layer;let S=!1;y.type==="fill-extrusion"?S=!y.isHidden(o)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="model"&&(S=!y.isHidden(o)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!S&&d.visible,d.visible=S}}updateZOffset(o,d){this.currentBuildingBuckets=[];for(const S of this.layers){const N=S.layer,k=this.style.getLayerSourceCache(N);let z=1;N.type==="fill-extrusion"&&(z=S.visible?N.paint.get("fill-extrusion-vertical-scale"):0);let G=k?k.getTile(d):null;if(!G&&k&&d.canonical.z>k.getSource().minzoom){let Z=d.scaledTo(Math.min(k.getSource().maxzoom,d.overscaledZ-1));for(;Z.overscaledZ>=k.getSource().minzoom&&(G=k.getTile(Z),!G&&Z.overscaledZ!==0);)Z=Z.scaledTo(Z.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:G?G.getBucket(N):null,tileID:G?G.tileID:d,verticalScale:z})}o.hasAnyZOffset=!1;let y=!1;for(let S=0;S<o.symbolInstances.length;S++){const N=o.symbolInstances.get(S),k=N.zOffset,z=this._getHeightAtTileOffset(d,N.tileAnchorX,N.tileAnchorY);N.zOffset=z!==Number.NEGATIVE_INFINITY?z:k,y||k===N.zOffset||(y=!0),o.hasAnyZOffset||N.zOffset===0||(o.hasAnyZOffset=!0)}y&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,d,y,S){let N=d,k=y;if(o.canonical.z!==S.canonical.z){const z=S.canonical,G=1/(1<<o.canonical.z-z.z);N=(d+o.canonical.x*i.ag)*G-z.x*i.ag|0,k=(y+o.canonical.y*i.ag)*G-z.y*i.ag|0}return{tileX:N,tileY:k}}_getHeightAtTileOffset(o,d,y){let S,N;for(let k=0;k<this.layers.length;++k){if(this.layers[k].layer.type!=="fill-extrusion")continue;const{bucket:z,tileID:G,verticalScale:Z}=this.currentBuildingBuckets[k];if(!z)continue;const{tileX:Y,tileY:re}=this._mapCoordToOverlappingTile(o,d,y,G),ne=z.getHeightAtTileCoord(Y,re);ne&&ne.height!==void 0&&(ne.hidden?S=ne.height:N=Math.max(ne.height*Z,N||0))}if(N!==void 0)return N;for(let k=0;k<this.layers.length;++k){const z=this.layers[k];if(z.layer.type!=="model"||!z.visible)continue;const{bucket:G,tileID:Z}=this.currentBuildingBuckets[k];if(!G)continue;const{tileX:Y,tileY:re}=this._mapCoordToOverlappingTile(o,d,y,Z),ne=G.getHeightAtTileCoord(Y,re);if(ne&&!ne.hidden)return ne.height===void 0&&S!==void 0?Math.min(ne.maxHeight,S)*ne.verticalScale:ne.height?ne.height*ne.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Gu(g,o){const d={};for(const y in g)y!=="ref"&&(d[y]=g[y]);return i.bm.forEach(y=>{y in o&&(d[y]=o[y])}),d}function Wu(g){g=g.slice();const o=Object.create(null);for(let d=0;d<g.length;d++)o[g[d].id]=g[d];for(let d=0;d<g.length;d++)"ref"in g[d]&&(g[d]=Gu(g[d],o[g[d].ref]));return g}const fn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Dm(g,o,d){d.push({command:fn.addSource,args:[g,o[g]]})}function Hu(g,o,d){o.push({command:fn.removeSource,args:[g]}),d[g]=!0}function wr(g,o,d,y){Hu(g,d,y),Dm(g,o,d)}function yi(g,o,d){let y;for(y in g[d])if(g[d].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[d][y],o[d][y]))return!1;for(y in o[d])if(o[d].hasOwnProperty(y)&&y!=="data"&&!i.bn(g[d][y],o[d][y]))return!1;return!0}function Hn(g,o,d,y,S,N){let k;for(k in o=o||{},g=g||{})g.hasOwnProperty(k)&&(i.bn(g[k],o[k])||d.push({command:N,args:[y,k,o[k],S]}));for(k in o)o.hasOwnProperty(k)&&!g.hasOwnProperty(k)&&(i.bn(g[k],o[k])||d.push({command:N,args:[y,k,o[k],S]}))}function ys(g){return g.id}function Nc(g,o){return g[o.id]=o,g}class si{constructor(o,d){this.reset(o,d)}reset(o,d){this.points=o||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=i.aw(o,0,1);let d=1,y=this._distances[d];const S=o*this.paddedLength+this.padding;for(;y<S&&d<this._distances.length;)y=this._distances[++d];const N=d-1,k=this._distances[N],z=y-k,G=z>0?(S-k)/z:0;return this.points[N].mult(1-G).add(this.points[d].mult(G))}}class ru{constructor(o,d,y){const S=this.boxCells=[],N=this.circleCells=[];this.xCellCount=Math.ceil(o/y),this.yCellCount=Math.ceil(d/y);for(let k=0;k<this.xCellCount*this.yCellCount;k++)S.push([]),N.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=d,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,d,y,S,N){this._forEachCell(d,y,S,N,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(S),this.bboxes.push(N)}insertCircle(o,d,y,S){this._forEachCell(d-S,y-S,d+S,y+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(d),this.circles.push(y),this.circles.push(S)}_insertBoxCell(o,d,y,S,N,k){this.boxCells[N].push(k)}_insertCircleCell(o,d,y,S,N,k){this.circleCells[N].push(k)}_query(o,d,y,S,N,k){if(y<0||o>this.width||S<0||d>this.height)return!N&&[];const z=[];if(o<=0&&d<=0&&this.width<=y&&this.height<=S){if(N)return!0;for(let G=0;G<this.boxKeys.length;G++)z.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){const Z=this.circles[3*G],Y=this.circles[3*G+1],re=this.circles[3*G+2];z.push({key:this.circleKeys[G],x1:Z-re,y1:Y-re,x2:Z+re,y2:Y+re})}return k?z.filter(k):z}return this._forEachCell(o,d,y,S,this._queryCell,z,{hitTest:N,seenUids:{box:{},circle:{}}},k),N?z.length>0:z}_queryCircle(o,d,y,S,N){const k=o-y,z=o+y,G=d-y,Z=d+y;if(z<0||k>this.width||Z<0||G>this.height)return!S&&[];const Y=[];return this._forEachCell(k,G,z,Z,this._queryCellCircle,Y,{hitTest:S,circle:{x:o,y:d,radius:y},seenUids:{box:{},circle:{}}},N),S?Y.length>0:Y}query(o,d,y,S,N){return this._query(o,d,y,S,!1,N)}hitTest(o,d,y,S,N){return this._query(o,d,y,S,!0,N)}hitTestCircle(o,d,y,S){return this._queryCircle(o,d,y,!0,S)}_queryCell(o,d,y,S,N,k,z,G){const Z=z.seenUids,Y=this.boxCells[N];if(Y!==null){const ne=this.bboxes;for(const oe of Y)if(!Z.box[oe]){Z.box[oe]=!0;const _e=4*oe;if(o<=ne[_e+2]&&d<=ne[_e+3]&&y>=ne[_e+0]&&S>=ne[_e+1]&&(!G||G(this.boxKeys[oe]))){if(z.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[oe],x1:ne[_e],y1:ne[_e+1],x2:ne[_e+2],y2:ne[_e+3]})}}}const re=this.circleCells[N];if(re!==null){const ne=this.circles;for(const oe of re)if(!Z.circle[oe]){Z.circle[oe]=!0;const _e=3*oe;if(this._circleAndRectCollide(ne[_e],ne[_e+1],ne[_e+2],o,d,y,S)&&(!G||G(this.circleKeys[oe]))){if(z.hitTest)return k.push(!0),!0;{const me=ne[_e],we=ne[_e+1],be=ne[_e+2];k.push({key:this.circleKeys[oe],x1:me-be,y1:we-be,x2:me+be,y2:we+be})}}}}}_queryCellCircle(o,d,y,S,N,k,z,G){const Z=z.circle,Y=z.seenUids,re=this.boxCells[N];if(re!==null){const oe=this.bboxes;for(const _e of re)if(!Y.box[_e]){Y.box[_e]=!0;const me=4*_e;if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,oe[me+0],oe[me+1],oe[me+2],oe[me+3])&&(!G||G(this.boxKeys[_e])))return k.push(!0),!0}}const ne=this.circleCells[N];if(ne!==null){const oe=this.circles;for(const _e of ne)if(!Y.circle[_e]){Y.circle[_e]=!0;const me=3*_e;if(this._circlesCollide(oe[me],oe[me+1],oe[me+2],Z.x,Z.y,Z.radius)&&(!G||G(this.circleKeys[_e])))return k.push(!0),!0}}}_forEachCell(o,d,y,S,N,k,z,G){const Z=this._convertToXCellCoord(o),Y=this._convertToYCellCoord(d),re=this._convertToXCellCoord(y),ne=this._convertToYCellCoord(S);for(let oe=Z;oe<=re;oe++)for(let _e=Y;_e<=ne;_e++)if(N.call(this,o,d,y,S,this.xCellCount*_e+oe,k,z,G))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,d,y,S,N,k){const z=S-o,G=N-d,Z=y+k;return Z*Z>z*z+G*G}_circleAndRectCollide(o,d,y,S,N,k,z){const G=(k-S)/2,Z=Math.abs(o-(S+G));if(Z>G+y)return!1;const Y=(z-N)/2,re=Math.abs(d-(N+Y));if(re>Y+y)return!1;if(Z<=G||re<=Y)return!0;const ne=Z-G,oe=re-Y;return ne*ne+oe*oe<=y*y}}const Ho={unknown:0,flipRequired:1,flipNotRequired:2},jc=Math.tan(85*Math.PI/180);function qa(g,o,d,y,S,N,k){const z=i.ab.mat4.create();if(d)if(N.name==="globe"){const G=i.bo(S,o);i.ab.mat4.multiply(z,z,G)}else{const G=i.ab.mat2.invert([],k);z[0]=G[0],z[1]=G[1],z[4]=G[2],z[5]=G[3],y||i.ab.mat4.rotateZ(z,z,S.angle)}else i.ab.mat4.multiply(z,S.labelPlaneMatrix,g);return z}function pa(g,o,d,y,S,N,k){const z=qa(g,o,d,y,S,N,k);return N.name==="globe"&&d||(z[2]=z[6]=z[10]=z[14]=0),z}function _y(g,o,d,y,S,N,k){if(d){if(N.name==="globe"){const z=qa(g,o,d,y,S,N,k);return i.ab.mat4.invert(z,z),i.ab.mat4.multiply(z,g,z),z}{const z=i.ab.mat4.clone(g),G=i.ab.mat4.identity([]);return G[0]=k[0],G[1]=k[1],G[4]=k[2],G[5]=k[3],i.ab.mat4.multiply(z,z,G),y||i.ab.mat4.rotateZ(z,z,-S.angle),z}}return S.glCoordMatrix}function Xs(g,o,d,y){const S=[g,o,d,1];d?i.ab.vec4.transformMat4(S,S,y):Ca(S,S,y);const N=S[3];return S[0]/=N,S[1]/=N,S[2]/=N,S}function $d(g,o){return Math.min(.5+g/o*.5,1.5)}function qd(g,o){const d=g[0]/g[3],y=g[1]/g[3];return d>=-o[0]&&d<=o[0]&&y>=-o[1]&&y<=o[1]}function yp(g,o,d,y,S,N,k,z,G,Z){const Y=d.transform,re=y?g.textSizeData:g.iconSizeData,ne=i.bp(re,d.transform.zoom),oe=Y.projection.name==="globe",_e=[256/d.width*2+1,256/d.height*2+1],me=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;me.clear();let we=null;oe&&(we=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const be=g.lineVertexArray,Ee=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,$e=d.transform.width/d.transform.height;let Ve,Qe=!1;for(let We=0;We<Ee.length;We++){const Ke=Ee.get(We),{numGlyphs:Ge,writingMode:Ye}=Ke;if(Ye!==i.bq.vertical||Qe||Ve===i.bq.horizontal||(Qe=!0),Ve=Ye,(Ke.hidden||Ye===i.bq.vertical)&&!Qe){na(Ge,me);continue}Qe=!1;const it=new i.P(Ke.tileAnchorX,Ke.tileAnchorY);let{x:bt,y:pt,z:kt}=Y.projection.projectTilePoint(it.x,it.y,Z.canonical);if(G){const[zt,Yt,nr]=G(it);bt+=zt,pt+=Yt,kt+=nr}const Et=[bt,pt,kt,1];if(i.ab.vec4.transformMat4(Et,Et,o),!qd(Et,_e)){na(Ge,me);continue}const dt=Et[3],jt=$d(d.transform.getCameraToCenterDistance(Y.projection),dt),Gt=i.br(re,ne,Ke),ft=k?Gt/jt:Gt*jt,Ft=Xs(bt,pt,kt,S);if(Ft[3]<=0){na(Ge,me);continue}let Ct={};const Qt=k?null:G,$t=gl(Ke,ft,!1,z,o,S,N,g.glyphOffsetArray,be,me,we,Ft,it,Ct,$e,Qt,Y.projection,Z,k);Qe=$t.useVertical,Qt&&$t.needsFlipping&&(Ct={}),($t.notEnoughRoom||Qe||$t.needsFlipping&&gl(Ke,ft,!0,z,o,S,N,g.glyphOffsetArray,be,me,we,Ft,it,Ct,$e,Qt,Y.projection,Z,k).notEnoughRoom)&&na(Ge,me)}y?(g.text.dynamicLayoutVertexBuffer.updateData(me),we&&g.text.globeExtVertexBuffer&&g.text.globeExtVertexBuffer.updateData(we)):(g.icon.dynamicLayoutVertexBuffer.updateData(me),we&&g.icon.globeExtVertexBuffer&&g.icon.globeExtVertexBuffer.updateData(we))}function Ol(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me){const{lineStartIndex:we,glyphStartIndex:be,segment:Ee}=z,$e=be+z.numGlyphs,Ve=we+z.lineLength,Qe=o.getoffsetX(be),We=o.getoffsetX($e-1),Ke=Rl(g*Qe,d,y,S,N,k,Ee,we,Ve,G,Z,Y,re,ne,!0,oe,_e,me);if(!Ke)return null;const Ge=Rl(g*We,d,y,S,N,k,Ee,we,Ve,G,Z,Y,re,ne,!0,oe,_e,me);return Ge?{first:Ke,last:Ge}:null}function Es(g,o,d,y){return g===i.bq.horizontal&&Math.abs(y)>Math.abs(d)?{useVertical:!0}:g===i.bq.vertical?y>0?{needsFlipping:!0}:null:o!==Ho.unknown&&function(S,N){return S===0||Math.abs(N/S)>jc}(d,y)?o===Ho.flipRequired?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null}function gl(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be,Ee){const $e=o/24,Ve=g.lineOffsetX*$e,Qe=g.lineOffsetY*$e,{lineStartIndex:We,glyphStartIndex:Ke,numGlyphs:Ge,segment:Ye,writingMode:it,flipState:bt}=g,pt=We+g.lineLength,kt=Et=>{if(Y){const[ft,Ft,Ct]=Et.up,Qt=Z.length;i.bs(Y,Qt+0,ft,Ft,Ct),i.bs(Y,Qt+1,ft,Ft,Ct),i.bs(Y,Qt+2,ft,Ft,Ct),i.bs(Y,Qt+3,ft,Ft,Ct)}const[dt,jt,Gt]=Et.point;i.bt(Z,dt,jt,Gt,Et.angle)};if(Ge>1){const Et=Ol($e,z,Ve,Qe,d,re,ne,g,G,N,oe,me,!1,we,be,Ee);if(!Et)return{notEnoughRoom:!0};if(y&&!d){let[dt,jt,Gt]=Et.first.point,[ft,Ft,Ct]=Et.last.point;[dt,jt]=Xs(dt,jt,Gt,k),[ft,Ft]=Xs(ft,Ft,Ct,k);const Qt=Es(it,bt,(ft-dt)*_e,Ft-jt);if(g.flipState=Qt&&Qt.needsFlipping?Ho.flipRequired:Ho.flipNotRequired,Qt)return Qt}kt(Et.first);for(let dt=Ke+1;dt<Ke+Ge-1;dt++){const jt=Rl($e*z.getoffsetX(dt),Ve,Qe,d,re,ne,Ye,We,pt,G,N,oe,me,!1,!1,we,be,Ee);if(!jt)return Z.length-=4*(dt-Ke),{notEnoughRoom:!0};kt(jt)}kt(Et.last)}else{if(y&&!d){const dt=Xs(ne.x,ne.y,0,S),jt=We+Ye+1,Gt=new i.P(G.getx(jt),G.gety(jt)),ft=Xs(Gt.x,Gt.y,0,S),Ft=ft[3]>0?ft:rf(ne,Gt,dt,1,S,void 0,we,be.canonical),Ct=Es(it,bt,(Ft[0]-dt[0])*_e,Ft[1]-dt[1]);if(g.flipState=Ct&&Ct.needsFlipping?Ho.flipRequired:Ho.flipNotRequired,Ct)return Ct}const Et=Rl($e*z.getoffsetX(Ke),Ve,Qe,d,re,ne,Ye,We,pt,G,N,oe,me,!1,!1,we,be,Ee);if(!Et)return{notEnoughRoom:!0};kt(Et)}return{}}function Ms(g,o,d,y,S){const{x:N,y:k,z}=y.projectTilePoint(g.x,g.y,o);if(!S)return Xs(N,k,z,d);const[G,Z,Y]=S(g);return Xs(N+G,k+Z,z+Y,d)}function rf(g,o,d,y,S,N,k,z){const G=Ms(g.sub(o)._unit()._add(g),z,S,k,N);return i.ab.vec3.sub(G,d,G),i.ab.vec3.normalize(G,G),i.ab.vec3.scaleAndAdd(G,d,G,y)}function Rl(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be){const Ee=y?g-o:g+o;let $e=Ee>0?1:-1,Ve=0;y&&($e*=-1,Ve=Math.PI),$e<0&&(Ve+=Math.PI);let Qe=z+k+($e>0?0:1)|0,We=S,Ke=S,Ge=0,Ye=0;const it=Math.abs(Ee),bt=[],pt=[];let kt=N,Et=kt;const dt=()=>rf(Et,kt,Ke,it-Ge+1,Y,ne,me,we.canonical);for(;Ge+Ye<=it;){if(Qe+=$e,Qe<z||Qe>=G)return null;if(Ke=We,Et=kt,bt.push(Ke),oe&&pt.push(Et),kt=new i.P(Z.getx(Qe),Z.gety(Qe)),We=re[Qe],!We){const Yt=Ms(kt,we.canonical,Y,me,ne);We=Yt[3]>0?re[Qe]=Yt:dt()}Ge+=Ye,Ye=i.ab.vec3.distance(Ke,We)}_e&&ne&&(re[Qe]&&(We=dt(),Ye=i.ab.vec3.distance(Ke,We)),re[Qe]=We);const jt=(it-Ge)/Ye,Gt=kt.sub(Et)._mult(jt)._add(Et),ft=i.ab.vec3.sub([],We,Ke),Ft=i.ab.vec3.scaleAndAdd([],Ke,ft,jt);let Ct=[0,0,1],Qt=ft[0],$t=ft[1];if(be&&(Ct=me.upVector(we.canonical,Gt.x,Gt.y),Ct[0]!==0||Ct[1]!==0||Ct[2]!==1)){const Yt=[Ct[2],0,-Ct[0]],nr=i.ab.vec3.cross([],Ct,Yt);i.ab.vec3.normalize(Yt,Yt),i.ab.vec3.normalize(nr,nr),Qt=i.ab.vec3.dot(ft,Yt),$t=i.ab.vec3.dot(ft,nr)}if(d){const Yt=i.ab.vec3.cross([],Ct,ft);i.ab.vec3.normalize(Yt,Yt),i.ab.vec3.scaleAndAdd(Ft,Ft,Yt,d*$e)}const zt=Ve+Math.atan2($t,Qt);return bt.push(Ft),oe&&pt.push(Gt),{point:Ft,angle:zt,path:bt,tilePath:pt,up:Ct}}function na(g,o){const d=o.length,y=d+4*g;o.resize(y),o.float32.fill(-1/0,4*d,4*y)}function Ca(g,o,d){const y=o[0],S=o[1];return g[0]=d[0]*y+d[4]*S+d[12],g[1]=d[1]*y+d[5]*S+d[13],g[3]=d[3]*y+d[7]*S+d[15],g}const ka=100;class ma{constructor(o,d,y=new ru(o.width+200,o.height+200,25),S=new ru(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=S,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ka,this.screenBottomBoundary=o.height+ka,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=d}placeCollisionBox(o,d,y,S,N,k,z,G){let Z=y.projectedAnchorX,Y=y.projectedAnchorY,re=y.projectedAnchorZ;const ne=y.elevation,oe=y.tileID,_e=o.getProjection();if(ne&&oe){const[We,Ke,Ge]=_e.upVector(oe.canonical,y.tileAnchorX,y.tileAnchorY),Ye=_e.upVectorScale(oe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Z+=We*ne*Ye,Y+=Ke*ne*Ye,re+=Ge*ne*Ye}const me=this.projectAndGetPerspectiveRatio(z,Z,Y,re,y.tileID,_e.name==="globe"||!!ne||this.transform.pitch>0,_e),we=k*me.perspectiveRatio,be=(y.x1*d+S.x-y.padding)*we+me.point.x,Ee=(y.y1*d+S.y-y.padding)*we+me.point.y,$e=(y.x2*d+S.x+y.padding)*we+me.point.x,Ve=(y.y2*d+S.y+y.padding)*we+me.point.y,Qe=me.perspectiveRatio<=.55||me.occluded;return!this.isInsideGrid(be,Ee,$e,Ve)||!N&&this.grid.hitTest(be,Ee,$e,Ve,G)||Qe?{box:[],offscreen:!1,occluded:me.occluded}:{box:[be,Ee,$e,Ve],offscreen:this.isOffscreen(be,Ee,$e,Ve),occluded:!1}}placeCollisionCircles(o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me){const we=[],be=this.transform.elevation,Ee=o.getProjection(),$e=be?be.getAtTileOffsetFunc(me,this.transform.center.lat,this.transform.worldSize,Ee):null,Ve=new i.P(y.tileAnchorX,y.tileAnchorY);let{x:Qe,y:We,z:Ke}=Ee.projectTilePoint(Ve.x,Ve.y,me.canonical);if($e){const[Gt,ft,Ft]=$e(Ve);Qe+=Gt,We+=ft,Ke+=Ft}const Ge=Ee.name==="globe",Ye=this.projectAndGetPerspectiveRatio(z,Qe,We,Ke,me,Ge||!!be||this.transform.pitch>0,Ee),{perspectiveRatio:it}=Ye,bt=(re?k/it:k*it)/i.bw,pt=Xs(Qe,We,Ke,G),kt=Ye.signedDistanceFromCamera>0?Ol(bt,N,y.lineOffsetX*bt,y.lineOffsetY*bt,!1,pt,Ve,y,S,G,{},be&&!re?$e:null,re&&!!be,Ee,me,re):null;let Et=!1,dt=!1,jt=!0;if(kt&&!Ye.occluded){const Gt=.5*oe*it+_e,ft=new i.P(-100,-100),Ft=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Ct=new si,{first:Qt,last:$t}=kt,zt=Qt.path.length;let Yt=[];for(let _r=zt-1;_r>=1;_r--)Yt.push(Qt.path[_r]);for(let _r=1;_r<$t.path.length;_r++)Yt.push($t.path[_r]);const nr=2.5*Gt;Z&&(Yt=Yt.map(([_r,Wr,Or],Lr)=>($e&&!Ge&&(Or=$e(Lr<zt-1?Qt.tilePath[zt-1-Lr]:$t.tilePath[Lr-zt+2])[2]),Xs(_r,Wr,Or,Z))),Yt.some(_r=>_r[3]<=0)&&(Yt=[]));let yr=[];if(Yt.length>0){let _r=1/0,Wr=-1/0,Or=1/0,Lr=-1/0;for(const Zr of Yt)_r=Math.min(_r,Zr[0]),Or=Math.min(Or,Zr[1]),Wr=Math.max(Wr,Zr[0]),Lr=Math.max(Lr,Zr[1]);Wr>=ft.x&&_r<=Ft.x&&Lr>=ft.y&&Or<=Ft.y&&(yr=[Yt.map(Zr=>new i.P(Zr[0],Zr[1]))],(_r<ft.x||Wr>Ft.x||Or<ft.y||Lr>Ft.y)&&(yr=i.bu(yr,ft.x,ft.y,Ft.x,Ft.y)))}for(const _r of yr){Ct.reset(_r,.25*Gt);let Wr=0;Wr=Ct.length<=.5*Gt?1:Math.ceil(Ct.paddedLength/nr)+1;for(let Or=0;Or<Wr;Or++){const Lr=Or/Math.max(Wr-1,1),Zr=Ct.lerp(Lr),Dn=Zr.x+ka,hi=Zr.y+ka;we.push(Dn,hi,Gt,0);const Wi=Dn-Gt,Yn=hi-Gt,Xr=Dn+Gt,Sn=hi+Gt;if(jt=jt&&this.isOffscreen(Wi,Yn,Xr,Sn),dt=dt||this.isInsideGrid(Wi,Yn,Xr,Sn),!d&&this.grid.hitTestCircle(Dn,hi,Gt,ne)&&(Et=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:Et,occluded:!1}}}}return{circles:!Y&&Et||!dt?[]:we,offscreen:jt,collisionDetected:Et,occluded:Ye.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let y=1/0,S=1/0,N=-1/0,k=-1/0;for(const Y of o){const re=new i.P(Y.x+ka,Y.y+ka);y=Math.min(y,re.x),S=Math.min(S,re.y),N=Math.max(N,re.x),k=Math.max(k,re.y),d.push(re)}const z=this.grid.query(y,S,N,k).concat(this.ignoredGrid.query(y,S,N,k)),G={},Z={};for(const Y of z){const re=Y.key;if(G[re.bucketInstanceId]===void 0&&(G[re.bucketInstanceId]={}),G[re.bucketInstanceId][re.featureIndex])continue;const ne=[new i.P(Y.x1,Y.y1),new i.P(Y.x2,Y.y1),new i.P(Y.x2,Y.y2),new i.P(Y.x1,Y.y2)];i.bv(d,ne)&&(G[re.bucketInstanceId][re.featureIndex]=!0,Z[re.bucketInstanceId]===void 0&&(Z[re.bucketInstanceId]=[]),Z[re.bucketInstanceId].push(re.featureIndex))}return Z}insertCollisionBox(o,d,y,S,N){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:S,collisionGroupID:N},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,d,y,S,N){const k=d?this.ignoredGrid:this.grid,z={bucketInstanceId:y,featureIndex:S,collisionGroupID:N};for(let G=0;G<o.length;G+=4)k.insertCircle(z,o[G],o[G+1],o[G+2])}projectAndGetPerspectiveRatio(o,d,y,S,N,k,z){const G=[d,y,S,1];let Z=!1;S||this.transform.pitch>0?(i.ab.vec4.transformMat4(G,G,o),this.fogState&&N&&z.name!=="globe"&&(Z=function(ne,oe,_e,me,we,be){const Ee=be.calculateFogTileMatrix(we),$e=[oe,_e,me];return i.ab.vec3.transformMat4($e,$e,Ee),at(ne,i.ab.vec3.length($e),be.pitch,be._fov)}(this.fogState,d,y,S,N.toUnwrapped(),this.transform)>.9)):Ca(G,G,o);const Y=G[3];return{point:new i.P((G[0]/Y+1)/2*this.transform.width+ka,(-G[1]/Y+1)/2*this.transform.height+ka),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(z)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:k&&G[2]>Y||Z}}isOffscreen(o,d,y,S){return y<ka||o>=this.screenRightBoundary||S<ka||d>this.screenBottomBoundary}isInsideGrid(o,d,y,S){return y>=0&&o<this.gridRightBoundary&&S>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const o=i.ab.mat4.identity([]);return i.ab.mat4.translate(o,o,[-100,-100,0]),o}}function nu(g,o,d){const y=o.createTileMatrix(g,g.worldSize,d.toUnwrapped());return i.ab.mat4.multiply(new Float32Array(16),g.projMatrix,y)}function ic(g,o,d){if(o.projection.name===d.projection.name)return g.projMatrix;const y=d.clone();return y.setProjection(o.projection),nu(y,o.getProjection(),g)}function iu(g,o,d){return o.name===d.projection.name?g.projMatrix:nu(d,o,g)}class Gd{constructor(o,d,y,S){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?d:-d))):S&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class Po{constructor(o,d,y,S,N,k=!1){this.text=new Gd(o?o.text:null,d,y,N),this.icon=new Gd(o?o.icon:null,d,S,N),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class nf{constructor(o,d,y,S=!1){this.text=o,this.icon=d,this.skipFade=y,this.clipped=S}}class Cc{constructor(){this.invProjMatrix=i.ab.mat4.create(),this.viewportMatrix=i.ab.mat4.create(),this.circles=[]}}class B_{constructor(o,d,y,S,N){this.bucketInstanceId=o,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=S,this.tileID=N}}class by{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const d=++this.maxGroupID;this.collisionGroups[o]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[o]}}function No(g,o,d,y,S){const{horizontalAlign:N,verticalAlign:k}=i.bD(g),z=-(N-.5)*o,G=-(k-.5)*d,Z=i.bC(g,y);return new i.P(z+Z[0]*S,G+Z[1]*S)}function vp(g,o,d,y,S){const N=new i.P(g,o);return d&&N._rotate(y?S:-S),N}class Lm{constructor(o,d,y,S,N,k){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new ma(this.transform,N),this.buildingIndex=k,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new by(y),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,d,y,S,N=1){const k=y.getBucket(d),z=y.latestFeatureIndex;if(!k||!z||d.fqid!==k.layerIds[0])return;const G=k.layers[0].layout,Z=k.layers[0].paint,Y=y.collisionBoxArray,re=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),ne=y.tileSize/i.ag,oe=y.tileID.toUnwrapped();this.transform.setProjection(k.projection);const _e=(me=y.tileID,we=k.getProjection(),be=this.transform,we.name===this.projection?be.calculateProjMatrix(me.toUnwrapped()):nu(be,we,me));var me,we,be;const Ee=G.get("text-pitch-alignment")==="map",$e=G.get("text-rotation-alignment")==="map";d.compileFilter(d.options);const Ve=d.dynamicFilter(),Qe=d.dynamicFilterNeedsFeature(),We=this.transform.calculatePixelsToTileUnitsMatrix(y),Ke=pa(_e,y.tileID.canonical,Ee,$e,this.transform,k.getProjection(),We);let Ge=null;if(Ee){const Gt=_y(_e,y.tileID.canonical,Ee,$e,this.transform,k.getProjection(),We);Ge=i.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Gt)}let Ye=null;Ve&&y.latestFeatureIndex&&(Ye={unwrappedTileID:oe,dynamicFilter:Ve,dynamicFilterNeedsFeature:Qe}),this.retainedQueryData[k.bucketInstanceId]=new B_(k.bucketInstanceId,z,k.sourceLayerIndex,k.index,y.tileID);const[it,bt]=k.layers[0].layout.get("text-size-scale-range"),pt=i.aw(N,it,bt),[kt,Et]=G.get("icon-size-scale-range"),dt=i.aw(N,kt,Et),jt={bucket:k,layout:G,paint:Z,posMatrix:_e,textLabelPlaneMatrix:Ke,labelToScreenMatrix:Ge,clippingData:Ye,scale:re,textPixelRatio:ne,holdingForFade:y.holdingForFade(),collisionBoxArray:Y,partiallyEvaluatedTextSize:i.bp(k.textSizeData,this.transform.zoom,pt),partiallyEvaluatedIconSize:i.bp(k.iconSizeData,this.transform.zoom,dt),collisionGroup:this.collisionGroups.get(k.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(S)for(const Gt of k.sortKeyRanges){const{sortKey:ft,symbolInstanceStart:Ft,symbolInstanceEnd:Ct}=Gt;o.push({sortKey:ft,symbolInstanceStart:Ft,symbolInstanceEnd:Ct,parameters:jt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:k.symbolInstances.length,parameters:jt})}attemptAnchorPlacement(o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be,Ee){const{textOffset0:$e,textOffset1:Ve,crossTileID:Qe}=ne,We=[$e,Ve],Ke=No(o,y,S,We,N),Ge=this.collisionIndex.placeCollisionBox(_e,N,d,vp(Ke.x,Ke.y,k,z,this.transform.angle),re,G,Z,Y.predicate);if(we){const Ye=_e.getSymbolInstanceIconSize(Ee,this.transform.zoom,ne.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(_e,Ye,we,vp(Ke.x,Ke.y,k,z,this.transform.angle),re,G,Z,Y.predicate).box.length===0)return}if(Ge.box.length>0){let Ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[Qe]&&this.prevPlacement.placements[Qe]&&this.prevPlacement.placements[Qe].text&&(Ye=this.prevPlacement.variableOffsets[Qe].anchor),this.variableOffsets[Qe]={textOffset:We,width:y,height:S,anchor:o,textScale:N,prevAnchor:Ye},this.markUsedJustification(_e,o,ne,me),_e.allowVerticalPlacement&&(this.markUsedOrientation(_e,me,ne),this.placedOrientations[Qe]=me),{shift:Ke,placedGlyphBoxes:Ge}}}placeLayerBucketPart(o,d,y,S,N=1){const{bucket:k,layout:z,paint:G,posMatrix:Z,textLabelPlaneMatrix:Y,labelToScreenMatrix:re,clippingData:ne,textPixelRatio:oe,holdingForFade:_e,collisionBoxArray:me,partiallyEvaluatedTextSize:we,partiallyEvaluatedIconSize:be,collisionGroup:Ee,latestFeatureIndex:$e}=o.parameters,Ve=z.get("text-optional"),Qe=z.get("icon-optional"),We=z.get("text-allow-overlap"),Ke=z.get("icon-allow-overlap"),Ge=z.get("text-rotation-alignment")==="map",Ye=z.get("text-pitch-alignment")==="map",it=z.get("symbol-z-elevate"),bt=G.get("symbol-z-offset"),pt=z.get("symbol-elevation-reference")==="sea",[kt,Et]=z.get("text-size-scale-range"),[dt,jt]=z.get("icon-size-scale-range"),Gt=i.aw(N,kt,Et),ft=i.aw(N,dt,jt);this.transform.setProjection(k.projection);let Ft=We&&(Ke||!k.hasIconData()||Qe),Ct=Ke&&(We||!k.hasTextData()||Ve);const Qt=!bt.isConstant();!k.collisionArrays&&me&&k.deserializeCollisionBoxes(me),y&&S&&k.updateCollisionDebugBuffers(this.transform.zoom,me,Gt,ft);const $t=(zt,Yt,nr)=>{const{crossTileID:yr,numVerticalGlyphVertices:_r}=zt;let Wr=null;if(ne&&ne.dynamicFilterNeedsFeature||Qt){const Ni=this.retainedQueryData[k.bucketInstanceId];Wr=$e.loadFeature({featureIndex:zt.featureIndex,bucketIndex:Ni.bucketIndex,sourceLayerIndex:Ni.sourceLayerIndex,layoutVertexArrayOffset:0})}if(ne&&!(0,ne.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Wr,this.retainedQueryData[k.bucketInstanceId].tileID.canonical,new i.P(zt.tileAnchorX,zt.tileAnchorY),this.transform.calculateDistanceTileData(ne.unwrappedTileID)))return this.placements[yr]=new nf(!1,!1,!1,!0),void d.add(yr);const Or=bt.evaluate(Wr,{});if(d.has(yr))return;if(_e)return void(this.placements[yr]=new nf(!1,!1,!1));let Lr=!1,Zr=!1,Dn=!0,hi=!1,Wi=!1,Yn=null,Xr={box:null,offscreen:null,occluded:null},Sn={box:null},Sr=null,In=null,ti=null,oi=0,ea=0,aa=0;nr.textFeatureIndex?oi=nr.textFeatureIndex:zt.useRuntimeCollisionCircles&&(oi=zt.featureIndex),nr.verticalTextFeatureIndex&&(ea=nr.verticalTextFeatureIndex);const Ea=Ni=>{Ni.tileID=this.retainedQueryData[k.bucketInstanceId].tileID;const wi=this.transform.elevation;Ni.elevation=pt?Or:Or+(wi?wi.getAtTileOffset(Ni.tileID,Ni.tileAnchorX,Ni.tileAnchorY):0),Ni.elevation+=zt.zOffset},Sa=nr.textBox;if(Sa){Ea(Sa);const Ni=zn=>{let sa=i.bq.horizontal;if(k.allowVerticalPlacement&&!zn&&this.prevPlacement){const as=this.prevPlacement.placedOrientations[yr];as&&(this.placedOrientations[yr]=as,sa=as,this.markUsedOrientation(k,sa,zt))}return sa},wi=(zn,sa)=>{if(k.allowVerticalPlacement&&_r>0&&nr.verticalTextBox){for(const as of k.writingModes)if(as===i.bq.vertical?(Xr=sa(),Sn=Xr):Xr=zn(),Xr&&Xr.box&&Xr.box.length)break}else Xr=zn()};if(z.get("text-variable-anchor")){let zn=z.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[yr]){const ji=this.prevPlacement.variableOffsets[yr];zn.indexOf(ji.anchor)>0&&(zn=zn.filter($s=>$s!==ji.anchor),zn.unshift(ji.anchor))}const sa=(ji,$s,Al)=>{const bs=k.getSymbolInstanceTextSize(we,zt,this.transform.zoom,Yt),Ro=(ji.x2-ji.x1)*bs+2*ji.padding,Io=(ji.y2-ji.y1)*bs+2*ji.padding,Tl=zt.hasIconTextFit&&!Ke?$s:null;Tl&&Ea(Tl);let Oi={box:[],offscreen:!1,occluded:!1};const wh=We?2*zn.length:zn.length;for(let dc=0;dc<wh;++dc){const Sh=this.attemptAnchorPlacement(zn[dc%zn.length],ji,Ro,Io,bs,Ge,Ye,oe,Z,Ee,dc>=zn.length,zt,Yt,k,Al,Tl,we,be);if(Sh&&(Oi=Sh.placedGlyphBoxes,Oi&&Oi.box&&Oi.box.length)){Lr=!0,Yn=Sh.shift;break}}return Oi};wi(()=>sa(Sa,nr.iconBox,i.bq.horizontal),()=>{const ji=nr.verticalTextBox;return ji&&Ea(ji),k.allowVerticalPlacement&&!(Xr&&Xr.box&&Xr.box.length)&&_r>0&&ji?sa(ji,nr.verticalIconBox,i.bq.vertical):{box:null,offscreen:null,occluded:null}}),Xr&&(Lr=Xr.box,Dn=Xr.offscreen,hi=Xr.occluded);const as=Ni(!(!Xr||!Xr.box));if(!Lr&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[yr];ji&&(this.variableOffsets[yr]=ji,this.markUsedJustification(k,ji.anchor,zt,as))}}else{const zn=(sa,as)=>{const ji=k.getSymbolInstanceTextSize(we,zt,this.transform.zoom,Yt,N),$s=this.collisionIndex.placeCollisionBox(k,ji,sa,new i.P(0,0),We,oe,Z,Ee.predicate);return $s&&$s.box&&$s.box.length&&(this.markUsedOrientation(k,as,zt),this.placedOrientations[yr]=as),$s};wi(()=>zn(Sa,i.bq.horizontal),()=>{const sa=nr.verticalTextBox;return k.allowVerticalPlacement&&_r>0&&sa?(Ea(sa),zn(sa,i.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Ni(!!(Xr&&Xr.box&&Xr.box.length))}}if(Sr=Xr,Lr=Sr&&Sr.box&&Sr.box.length>0,Dn=Sr&&Sr.offscreen,hi=Sr&&Sr.occluded,zt.useRuntimeCollisionCircles){const Ni=k.text.placedSymbolArray.get(zt.centerJustifiedTextSymbolIndex>=0?zt.centerJustifiedTextSymbolIndex:zt.verticalPlacedTextSymbolIndex),wi=i.br(k.textSizeData,we,Ni),zn=z.get("text-padding");In=this.collisionIndex.placeCollisionCircles(k,We,Ni,k.lineVertexArray,k.glyphOffsetArray,wi,Z,Y,re,y,Ye,Ee.predicate,zt.collisionCircleDiameter*wi/i.bw,zn,this.retainedQueryData[k.bucketInstanceId].tileID),Lr=We||In.circles.length>0&&!In.collisionDetected,Dn=Dn&&In.offscreen,hi=In.occluded}if(nr.iconFeatureIndex&&(aa=nr.iconFeatureIndex),nr.iconBox){const Ni=wi=>{Ea(wi);const zn=zt.hasIconTextFit&&Yn?vp(Yn.x,Yn.y,Ge,Ye,this.transform.angle):new i.P(0,0),sa=k.getSymbolInstanceIconSize(be,this.transform.zoom,zt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(k,sa,wi,zn,Ke,oe,Z,Ee.predicate)};Sn&&Sn.box&&Sn.box.length&&nr.verticalIconBox?(ti=Ni(nr.verticalIconBox),Zr=ti.box.length>0):(ti=Ni(nr.iconBox),Zr=ti.box.length>0),Dn=Dn&&ti.offscreen,Wi=ti.occluded}const Is=Ve||zt.numHorizontalGlyphVertices===0&&_r===0,Ds=Qe||zt.numIconVertices===0;if(Is||Ds?Ds?Is||(Zr=Zr&&Lr):Lr=Zr&&Lr:Zr=Lr=Zr&&Lr,Lr&&Sr&&Sr.box&&this.collisionIndex.insertCollisionBox(Sr.box,z.get("text-ignore-placement"),k.bucketInstanceId,Sn&&Sn.box&&ea?ea:oi,Ee.ID),Zr&&ti&&this.collisionIndex.insertCollisionBox(ti.box,z.get("icon-ignore-placement"),k.bucketInstanceId,aa,Ee.ID),In&&(Lr&&this.collisionIndex.insertCollisionCircles(In.circles,z.get("text-ignore-placement"),k.bucketInstanceId,oi,Ee.ID),y)){const Ni=k.bucketInstanceId;let wi=this.collisionCircleArrays[Ni];wi===void 0&&(wi=this.collisionCircleArrays[Ni]=new Cc);for(let zn=0;zn<In.circles.length;zn+=4)wi.circles.push(In.circles[zn+0]),wi.circles.push(In.circles[zn+1]),wi.circles.push(In.circles[zn+2]),wi.circles.push(In.collisionDetected?1:0)}const Mi=k.projection.name!=="globe";Ft=Ft&&(Mi||!hi),Ct=Ct&&(Mi||!Wi),this.placements[yr]=new nf(Lr||Ft,Zr||Ct,Dn||k.justReloaded),d.add(yr)};if(it&&this.buildingIndex&&(this.buildingIndex.updateZOffset(k,this.retainedQueryData[k.bucketInstanceId].tileID),k.updateZOffset()),k.sortFeaturesByY){const zt=k.getSortedSymbolIndexes(this.transform.angle);for(let Yt=zt.length-1;Yt>=0;--Yt){const nr=zt[Yt];$t(k.symbolInstances.get(nr),nr,k.collisionArrays[nr])}k.hasAnyZOffset&&i.w(`${k.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(k.hasAnyZOffset){const zt=k.getSortedIndexesByZOffset();for(let Yt=0;Yt<zt.length;++Yt){const nr=zt[Yt];$t(k.symbolInstances.get(nr),nr,k.collisionArrays[nr])}}else for(let zt=o.symbolInstanceStart;zt<o.symbolInstanceEnd;zt++)$t(k.symbolInstances.get(zt),zt,k.collisionArrays[zt]);if(y&&k.bucketInstanceId in this.collisionCircleArrays){const zt=this.collisionCircleArrays[k.bucketInstanceId];i.ab.mat4.invert(zt.invProjMatrix,Z),zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}k.justReloaded=!1}markUsedJustification(o,d,y,S){const{leftJustifiedTextSymbolIndex:N,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:G,crossTileID:Z}=y,Y=i.bB(d),re=S===i.bq.vertical?G:Y==="left"?N:Y==="center"?k:Y==="right"?z:-1;N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=re>=0&&N!==re?0:Z),k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=re>=0&&k!==re?0:Z),z>=0&&(o.text.placedSymbolArray.get(z).crossTileID=re>=0&&z!==re?0:Z),G>=0&&(o.text.placedSymbolArray.get(G).crossTileID=re>=0&&G!==re?0:Z)}markUsedOrientation(o,d,y){const S=d===i.bq.horizontal||d===i.bq.horizontalOnly?d:0,N=d===i.bq.vertical?d:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:z,rightJustifiedTextSymbolIndex:G,verticalPlacedTextSymbolIndex:Z}=y,Y=o.text.placedSymbolArray;k>=0&&(Y.get(k).placedOrientation=S),z>=0&&(Y.get(z).placedOrientation=S),G>=0&&(Y.get(G).placedOrientation=S),Z>=0&&(Y.get(Z).placedOrientation=N)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const S=d?d.symbolFadeChange(o):1,N=d?d.opacities:{},k=d?d.variableOffsets:{},z=d?d.placedOrientations:{};for(const G in this.placements){const Z=this.placements[G],Y=N[G];Y?(this.opacities[G]=new Po(Y,S,Z.text,Z.icon,null,Z.clipped),y=y||Z.text!==Y.text.placed||Z.icon!==Y.icon.placed):(this.opacities[G]=new Po(null,S,Z.text,Z.icon,Z.skipFade,Z.clipped),y=y||Z.text||Z.icon)}for(const G in N){const Z=N[G];if(!this.opacities[G]){const Y=new Po(Z,S,!1,!1);Y.isHidden()||(this.opacities[G]=Y,y=y||Z.text.placed||Z.icon.placed)}}for(const G in k)this.variableOffsets[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.variableOffsets[G]=k[G]);for(const G in z)this.placedOrientations[G]||!this.opacities[G]||this.opacities[G].isHidden()||(this.placedOrientations[G]=z[G]);y?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:o)}updateLayerOpacities(o,d,y,S){const N=new Set;for(const k of d){const z=k.getBucket(o);z&&k.latestFeatureIndex&&o.fqid===z.layerIds[0]&&(this.updateBucketOpacities(z,N,k,k.collisionBoxArray,y,S,k.tileID,o.scope),z.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(z,k.tileID),z.updateZOffset()))}}updateBucketOpacities(o,d,y,S,N,k,z,G){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const Z=o.layers[0].layout,Y=o.layers[0].paint,re=!!o.layers[0].dynamicFilter(),ne=new Po(null,0,!1,!1,!0),oe=Z.get("text-allow-overlap"),_e=Z.get("icon-allow-overlap"),me=Z.get("text-variable-anchor"),we=Z.get("text-rotation-alignment")==="map",be=Z.get("text-pitch-alignment")==="map",Ee=Y.get("symbol-z-offset"),$e=Z.get("symbol-elevation-reference")==="sea",Ve=!Ee.isConstant(),Qe=new Po(null,0,oe&&(_e||!o.hasIconData()||Z.get("icon-optional")),_e&&(oe||!o.hasTextData()||Z.get("text-optional")),!0);!o.collisionArrays&&S&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(S);const We=(Ge,Ye,it)=>{for(let bt=0;bt<Ye/4;bt++)Ge.opacityVertexArray.emplaceBack(it)};let Ke=0;k&&o.updateReplacement(z,k);for(let Ge=0;Ge<o.symbolInstances.length;Ge++){const Ye=o.symbolInstances.get(Ge),{numHorizontalGlyphVertices:it,numVerticalGlyphVertices:bt,crossTileID:pt,numIconVertices:kt,tileAnchorX:Et,tileAnchorY:dt}=Ye;let jt=null;const Gt=this.retainedQueryData[o.bucketInstanceId];Ve&&Ye&&Gt&&(jt=y.latestFeatureIndex.loadFeature({featureIndex:Ye.featureIndex,bucketIndex:Gt.bucketIndex,sourceLayerIndex:Gt.sourceLayerIndex,layoutVertexArrayOffset:0}));const ft=Ee.evaluate(jt,{}),Ft=d.has(pt);let Ct=this.opacities[pt];Ft?Ct=ne:Ct||(Ct=Qe,this.opacities[pt]=Ct),d.add(pt);const Qt=it>0||bt>0,$t=kt>0,zt=this.placedOrientations[pt],Yt=zt===i.bq.vertical,nr=zt===i.bq.horizontal||zt===i.bq.horizontalOnly;!Qt&&!$t||Ct.isHidden()||Ke++;let yr=!1;if((Qt||$t)&&k)for(const _r of o.activeReplacements){if(i.bx(_r,N,i.by.Symbol,G)||_r.min.x>Et||Et>_r.max.x||_r.min.y>dt||dt>_r.max.y)continue;const Wr=i.bz(Et,dt,z.canonical,_r.footprintTileId.canonical);if(yr=i.bA(Wr,_r.footprint),yr)break}if(Qt){const _r=yr?ac:wy(Ct.text);We(o.text,it,Yt?ac:_r),We(o.text,bt,nr?ac:_r);const Wr=Ct.text.isHidden(),{leftJustifiedTextSymbolIndex:Or,centerJustifiedTextSymbolIndex:Lr,rightJustifiedTextSymbolIndex:Zr,verticalPlacedTextSymbolIndex:Dn}=Ye,hi=o.text.placedSymbolArray,Wi=Wr||Yt?1:0;Or>=0&&(hi.get(Or).hidden=Wi),Lr>=0&&(hi.get(Lr).hidden=Wi),Zr>=0&&(hi.get(Zr).hidden=Wi),Dn>=0&&(hi.get(Dn).hidden=Wr||nr?1:0);const Yn=this.variableOffsets[pt];Yn&&this.markUsedJustification(o,Yn.anchor,Ye,zt);const Xr=this.placedOrientations[pt];Xr&&(this.markUsedJustification(o,"left",Ye,Xr),this.markUsedOrientation(o,Xr,Ye))}if($t){const _r=yr?ac:wy(Ct.icon),{placedIconSymbolIndex:Wr,verticalPlacedIconSymbolIndex:Or}=Ye,Lr=o.icon.placedSymbolArray,Zr=Ct.icon.isHidden()?1:0;Wr>=0&&(We(o.icon,kt,Yt?ac:_r),Lr.get(Wr).hidden=Zr),Or>=0&&(We(o.icon,Ye.numVerticalIconVertices,nr?ac:_r),Lr.get(Or).hidden=Zr)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const _r=o.collisionArrays[Ge];if(_r){let Wr=new i.P(0,0),Or=!0;if(_r.textBox||_r.verticalTextBox){if(me){const Zr=this.variableOffsets[pt];Zr?(Wr=No(Zr.anchor,Zr.width,Zr.height,Zr.textOffset,Zr.textScale),we&&Wr._rotate(be?this.transform.angle:-this.transform.angle)):Or=!1}re&&(Or=!Ct.clipped),_r.textBox&&xp(o.textCollisionBox.collisionVertexArray,Ct.text.placed,!Or||Yt,ft,$e,Wr.x,Wr.y),_r.verticalTextBox&&xp(o.textCollisionBox.collisionVertexArray,Ct.text.placed,!Or||nr,ft,$e,Wr.x,Wr.y)}const Lr=Or&&!!(!nr&&_r.verticalIconBox);_r.iconBox&&xp(o.iconCollisionBox.collisionVertexArray,Ct.icon.placed,Lr,ft,$e,Ye.hasIconTextFit?Wr.x:0,Ye.hasIconTextFit?Wr.y:0),_r.verticalIconBox&&xp(o.iconCollisionBox.collisionVertexArray,Ct.icon.placed,!Lr,ft,$e,Ye.hasIconTextFit?Wr.x:0,Ye.hasIconTextFit?Wr.y:0)}}}if(o.fullyClipped=Ke===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Ge.invProjMatrix,o.placementViewportMatrix=Ge.viewportMatrix,o.collisionCircleArray=Ge.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>o}setStale(){this.stale=!0}}function xp(g,o,d,y,S,N,k){g.emplaceBack(o?1:0,d?1:0,N||0,k||0,y,S?1:0),g.emplaceBack(o?1:0,d?1:0,N||0,k||0,y,S?1:0),g.emplaceBack(o?1:0,d?1:0,N||0,k||0,y,S?1:0),g.emplaceBack(o?1:0,d?1:0,N||0,k||0,y,S?1:0)}const _p=Math.pow(2,25),V_=Math.pow(2,24),U_=Math.pow(2,17),af=Math.pow(2,16),bp=Math.pow(2,9),$_=Math.pow(2,8),sf=Math.pow(2,1);function wy(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,d=Math.floor(127*g.opacity);return d*_p+o*V_+d*U_+o*af+d*bp+o*$_+d*sf+o}const ac=0;class Ku{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,d,y,S,N,k){const z=this._bucketParts;for(;this._currentTileIndex<o.length;)if(d.getBucketParts(z,S,o[this._currentTileIndex],this._sortAcrossTiles,k),this._currentTileIndex++,N())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((G,Z)=>G.sortKey-Z.sortKey));this._currentPartIndex<z.length;){const G=z[this._currentPartIndex];if(d.placeLayerBucketPart(G,this._seenCrossTileIDs,y,G.symbolInstanceStart===0,k),this._currentPartIndex++,N())return!0}return!1}}class q_{constructor(o,d,y,S,N,k,z,G,Z){this.placement=new Lm(o,N,k,z,G,Z),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(o,d,y,S,N){const k=i.q.now(),z=()=>{const G=i.q.now()-k;return!this._forceFullPlacement&&G>2};for(;this._currentPlacementIndex>=0;){const G=d[o[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if(G.type==="symbol"&&(!G.minzoom||G.minzoom<=Z)&&(!G.maxzoom||G.maxzoom>Z)){const Y=G,re=Y.layout.get("symbol-z-elevate"),ne=Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,oe=Y.layout.get("symbol-z-order"),_e=oe==="viewport-y"||oe==="auto"&&!(oe!=="viewport-y"&&ne),me=Y.layout.get("text-allow-overlap")||Y.layout.get("icon-allow-overlap")||Y.layout.get("text-ignore-placement")||Y.layout.get("icon-ignore-placement"),we=_e&&me,be=this._inProgressLayer=this._inProgressLayer||new Ku(Y),Ee=i.aC(G.source,G.scope);if(be.continuePlacement(re||we?S[Ee]:y[Ee],this.placement,this._showCollisionBoxes,G,z,N))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Sy=512/i.ag/2;class lv{constructor(o,d,y){this.tileID=o,this.bucketInstanceId=y,this.index=new i.bE(d.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const S=o.canonical.x*i.ag,N=o.canonical.y*i.ag;for(let k=0;k<d.length;k++){const{key:z,crossTileID:G,tileAnchorX:Z,tileAnchorY:Y}=d.get(k),re=Math.floor((S+Z)*Sy),ne=Math.floor((N+Y)*Sy);this.index.add(re,ne),this.keys.push(z),this.crossTileIDs.push(G)}this.index.finish()}findMatches(o,d,y){const S=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z),N=Sy/Math.pow(2,d.canonical.z-this.tileID.canonical.z),k=d.canonical.x*i.ag,z=d.canonical.y*i.ag;for(let G=0;G<o.length;G++){const Z=o.get(G);if(Z.crossTileID)continue;const{key:Y,tileAnchorX:re,tileAnchorY:ne}=Z,oe=Math.floor((k+re)*N),_e=Math.floor((z+ne)*N),me=this.index.range(oe-S,_e-S,oe+S,_e+S);for(const we of me){const be=this.crossTileIDs[we];if(this.keys[we]===Y&&!y.has(be)){y.add(be),Z.crossTileID=be;break}}}}}class cv{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class G_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const d=Math.round((o-this.lng)/360);if(d!==0)for(const y in this.indexes){const S=this.indexes[y],N={};for(const k in S){const z=S[k];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+d),N[z.tileID.key]=z}this.indexes[y]=N}this.lng=o}addBucket(o,d,y){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let N=0;N<d.symbolInstances.length;N++)d.symbolInstances.get(N).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const S=this.usedCrossTileIDs[o.overscaledZ];for(const N in this.indexes){const k=this.indexes[N];if(Number(N)>o.overscaledZ)for(const z in k){const G=k[z];G.tileID.isChildOf(o)&&G.findMatches(d.symbolInstances,o,S)}else{const z=k[o.scaledTo(Number(N)).key];z&&z.findMatches(d.symbolInstances,o,S)}}for(let N=0;N<d.symbolInstances.length;N++){const k=d.symbolInstances.get(N);k.crossTileID||(k.crossTileID=y.generate(),S.add(k.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new lv(o,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(o,d){for(const y of d.crossTileIDs)this.usedCrossTileIDs[o].delete(y)}removeStaleBuckets(o){let d=!1;for(const y in this.indexes){const S=this.indexes[y];for(const N in S)o[S[N].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,S[N]),delete S[N],d=!0)}return d}}class Ay{constructor(){this.layerIndexes={},this.crossTileIDs=new cv,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,d,y,S){let N=this.layerIndexes[o.fqid];N===void 0&&(N=this.layerIndexes[o.fqid]=new G_);let k=!1;const z={};S.name!=="globe"&&N.handleWrapJump(y);for(const G of d){const Z=G.getBucket(o);Z&&o.fqid===Z.layerIds[0]&&(Z.bucketInstanceId||(Z.bucketInstanceId=++this.maxBucketInstanceId),N.addBucket(G.tileID,Z,this.crossTileIDs)&&(k=!0),z[Z.bucketInstanceId]=!0)}return N.removeStaleBuckets(z)&&(k=!0),k}pruneUnusedLayers(o){const d={};o.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const Wd=771;class An{constructor(o,d,y,S){this.blendFunction=o,this.blendColor=d,this.mask=y,this.blendEquation=S}}An.Replace=[1,0,1,0],An.disabled=new An(An.Replace,i.aj.transparent,[!1,!1,!1,!1]),An.unblended=new An(An.Replace,i.aj.transparent,[!0,!0,!0,!0]),An.alphaBlended=new An([1,Wd,1,Wd],i.aj.transparent,[!0,!0,!0,!0]),An.alphaBlendedNonPremultiplied=new An([770,Wd,770,Wd],i.aj.transparent,[!0,!0,!0,!0]),An.multiply=new An([774,0,774,0],i.aj.transparent,[!0,!0,!0,!0]);class Br{constructor(o,d,y){this.func=o,this.mask=d,this.range=y}}Br.ReadOnly=!1,Br.ReadWrite=!0,Br.disabled=new Br(519,Br.ReadOnly,[0,1]);const zm=7680;class Kr{constructor(o,d,y,S,N,k){this.test=o,this.ref=d,this.mask=y,this.fail=S,this.depthFail=N,this.pass=k}}Kr.disabled=new Kr({func:519,mask:0},0,0,zm,zm,zm);const kc=1029,Fm=2305;class Yr{constructor(o,d,y){this.enable=o,this.mode=d,this.frontFace=y}}function Hd(g,o){const d=i.bG(g,3);i.ab.mat4.fromQuat(g,o),i.bI(g,3,d)}function Zu(g,o){const d=i.ab.quat.identity([]);return i.ab.quat.rotateZ(d,d,-o),i.ab.quat.rotateX(d,d,-g),d}function Bm(g,o){const d=[g[0],g[1],0],y=[o[0],o[1],0];if(i.ab.vec3.length(d)>=1e-15){const k=i.ab.vec3.normalize([],d);i.ab.vec3.scale(y,k,i.ab.vec3.dot(y,k)),o[0]=y[0],o[1]=y[1]}const S=i.ab.vec3.cross([],o,g);if(i.ab.vec3.len(S)<1e-15)return null;const N=Math.atan2(-S[1],S[0]);return Zu(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),N)}Yr.disabled=new Yr(!1,kc,Fm),Yr.backCCW=new Yr(!0,kc,Fm),Yr.backCW=new Yr(!0,kc,2304),Yr.frontCW=new Yr(!0,1028,2304),Yr.frontCCW=new Yr(!0,1028,Fm);class wp{constructor(o,d){this.position=o,this.orientation=d}get position(){return this._position}set position(o){if(o){const d=o instanceof i.aa?o:new i.aa(o[0],o[1],o[2]);this._renderWorldCopies&&(d.x=i.bF(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(o,d){if(this.orientation=null,!this.position)return;const y=this.position,S=this._elevation?this._elevation.getAtPointOrZero(i.aa.fromLngLat(o)):0,N=i.aa.fromLngLat(o,S),k=[N.x-y.x,N.y-y.y,N.z-y.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Bm(k,d)}setPitchBearing(o,d){this.orientation=Zu(i.ai(o),i.ai(-d))}}class vs{constructor(o,d){this._transform=i.ab.mat4.identity([]),this.orientation=d,this.position=o}get mercatorPosition(){const o=this.position;return new i.aa(o[0],o[1],o[2])}get position(){const o=i.bG(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var d;o&&i.bI(this._transform,3,[(d=o)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||i.ab.quat.identity([]),o&&Hd(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,d){this._orientation=Zu(o,d),Hd(this._transform,this._orientation)}forward(){const o=i.bG(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=i.bG(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=i.bG(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,d){const y=new Float64Array(16);return i.ab.mat4.invert(y,this.getWorldToCamera(o,d)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,d,y){const S=this.position;i.ab.vec3.scale(S,S,-o);const N=new Float64Array(16);return i.ab.mat4.fromScaling(N,[y,y,y]),i.ab.mat4.translate(N,N,S),N[10]*=d,N}getWorldToCamera(o,d){const y=new Float64Array(16),S=new Float64Array(4),N=this.position;return i.ab.quat.conjugate(S,this._orientation),i.ab.vec3.scale(N,N,-o),i.ab.mat4.fromQuat(y,S),i.ab.mat4.translate(y,y,N),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=d,y[9]*=d,y[10]*=d,y[11]*=d,y}getCameraToClipPerspective(o,d,y,S){const N=new Float64Array(16);return i.ab.mat4.perspective(N,o,d,y,S),N}getCameraToClipOrthographic(o,d,y,S,N,k){const z=new Float64Array(16);return i.ab.mat4.ortho(z,o,d,y,S,N,k),z}getDistanceToElevation(o,d=!1){const y=o===0?0:i.bH(o,d?i.aS(this.position[1]):this.position[1]),S=this.forward();return(y-this.position[2])/S[2]}clone(){return new vs([...this.position],[...this.orientation])}}const Vs={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class hr{constructor(o=0,d=0,y=0,S=0){if(isNaN(o)||o<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=d,this.left=y,this.right=S}interpolate(o,d,y){return d.top!=null&&o.top!=null&&(this.top=i.af(o.top,d.top,y)),d.bottom!=null&&o.bottom!=null&&(this.bottom=i.af(o.bottom,d.bottom,y)),d.left!=null&&o.left!=null&&(this.left=i.af(o.left,d.left,y)),d.right!=null&&o.right!=null&&(this.right=i.af(o.right,d.right,y)),this}getCenter(o,d){const y=i.aw((this.left+o-this.right)/2,0,o),S=i.aw((this.top+d-this.bottom)/2,0,d);return new i.P(y,S)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new hr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ty=(g,o,d)=>(1-d)*g+d*o,Sp=g=>g*g*g*g*g;class of{constructor(o,d,y,S,N,k,z){this.tileSize=512,this._renderWorldCopies=N===void 0||N,this._minZoom=o||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=S??60,this.setProjection(k),this.setMaxBounds(z),this.width=0,this.height=0,this._center=new i.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new hr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new vs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const o=new of(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,d=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(o||y)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return i.ay(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=i.bP(this.projectionOptions);const y=this.getProjection(),S=!i.bn(d,y);return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bP({name:"mercator"});const d=o!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bF(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const d=-o*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=i.ab.mat2.create(),i.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const d=i.aw(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=i.ai(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const d=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,d=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!d||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;d||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let S=0,N=0;for(let k=0;k<d.length;k++){const z=new i.P(d[k][0]*this.width,y+d[k][1]*(this.height-y)),G=o.pointCoordinate(z);if(!G)continue;const Z=1/Math.hypot(G[0]-this._camera.position[0],G[1]-this._camera.position[1]);S+=G[3]*Z,N+=Z}return N===0?NaN:S/N}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*d,S=this._mercatorZfromZoom(o),N=this._mercatorZfromZoom(this._maxZoom),k=Math.max(S-y,N);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let y;y=o.z<this._camera.position[2]?[d.x,d.y,d.z]:[o.x,o.y,o.z];const S=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,y));return i.aw(this._zoomFromMercatorZ(S),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let d=!1;if(o.orientation&&!i.ab.quat.exactEquals(o.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(o.orientation)),o.position){const y=[o.position.x,o.position.y,o.position.z];i.ab.vec3.exactEquals(y,this._camera.position)||(this._setCameraPosition(y),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,d=new wp;return d.position=new i.aa(o[0],o[1],o[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(o){if(!i.ab.quat.length(o))return!1;i.ab.quat.normalize(o,o);const d=i.ab.vec3.transformQuat([],[0,0,-1],o),y=i.ab.vec3.transformQuat([],[0,-1,0],o);if(y[2]<0)return!1;const S=Bm(d,y);return!!S&&(this._camera.orientation=S,!0)}_setCameraPosition(o){const d=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,S=this.cameraToCenterDistance;o[2]=i.aw(o[2],S/y,S/d),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,d,y){this._unmodified=!1,this._edgeInsets.interpolate(o,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const d=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(o){const d=[new i.bQ(0,o)];if(this.renderWorldCopies){const y=this.pointCoordinate(new i.P(0,0)),S=this.pointCoordinate(new i.P(this.width,0)),N=this.pointCoordinate(new i.P(this.width,this.height)),k=this.pointCoordinate(new i.P(0,this.height)),z=Math.floor(Math.min(y.x,S.x,N.x,k.x)),G=Math.floor(Math.max(y.x,S.x,N.x,k.x)),Z=1;for(let Y=z-Z;Y<=G+Z;Y++)Y!==0&&d.push(new i.bQ(Y,o))}return d}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,d,y){let S=[];const N=y!==void 0,k=!N;if(k&&this.zoom<d||N&&y[0]===0&&y[1]===0)return S;const z=new Set,G=(Y,re,ne,oe,_e)=>{const me=i.c5(re,Y,ne,oe,_e);z.has(me)||(S.push(new i.aG(Y,re,ne,oe,_e)),z.add(me))};for(let Y=0;Y<o.length;Y++){const re=o[Y];if(k&&re.canonical.z!==d)continue;const ne=re.canonical,oe=re.overscaledZ,_e=re.wrap,me=1<<ne.z,we=ne.x+1<me,be=ne.x>0,Ee=ne.y+1<me,$e=ne.y>0,Ve=re.wrap-(be?0:1),Qe=re.wrap+(we?0:1),We=be?ne.x-1:me-1,Ke=we?ne.x+1:0;if(N)y[0]<0?(G(oe,Qe,ne.z,Ke,ne.y),y[1]<0&&Ee&&(G(oe,_e,ne.z,ne.x,ne.y+1),G(oe,Qe,ne.z,Ke,ne.y+1)),y[1]>0&&$e&&(G(oe,_e,ne.z,ne.x,ne.y-1),G(oe,Qe,ne.z,Ke,ne.y-1))):y[0]>0?(G(oe,Ve,ne.z,We,ne.y),y[1]<0&&Ee&&(G(oe,_e,ne.z,ne.x,ne.y+1),G(oe,Ve,ne.z,We,ne.y+1)),y[1]>0&&$e&&(G(oe,_e,ne.z,ne.x,ne.y-1),G(oe,Ve,ne.z,We,ne.y-1))):y[1]<0&&Ee?G(oe,_e,ne.z,ne.x,ne.y+1):$e&&G(oe,_e,ne.z,ne.x,ne.y-1);else{const Ge=re.visibleQuadrants;1&Ge&&(G(oe,Ve,ne.z,We,ne.y),$e&&(G(oe,_e,ne.z,ne.x,ne.y-1),G(oe,Ve,ne.z,We,ne.y-1))),2&Ge&&(G(oe,Qe,ne.z,Ke,ne.y),$e&&(G(oe,_e,ne.z,ne.x,ne.y-1),G(oe,Qe,ne.z,Ke,ne.y-1))),4&Ge&&(G(oe,Ve,ne.z,We,ne.y),Ee&&(G(oe,_e,ne.z,ne.x,ne.y+1),G(oe,Ve,ne.z,We,ne.y+1))),8&Ge&&(G(oe,Qe,ne.z,Ke,ne.y),Ee&&(G(oe,_e,ne.z,ne.x,ne.y+1),G(oe,Qe,ne.z,Ke,ne.y+1)))}}const Z=[];for(const Y of S)S.some(re=>Y.isChildOf(re))||Z.push(Y);if(S=Z.filter(Y=>!o.some(re=>!!(Y.overscaledZ<d&&re.isChildOf(Y))||Y.equals(re)||Y.isChildOf(re))),k){const Y=1<<d,re=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ne=[Y*re.x,Y*re.y],oe=4,_e=oe*oe;S=S.filter(me=>{const we=me.canonical.x+.5-ne[0],be=me.canonical.y+.5-ne[1];return we*we+be*be<_e})}return S}coveringTiles(o){let d=this.coveringZoomLevel(o);const y=d,S=this.elevation&&this.elevation.exaggeration(),N=S&&!o.isTerrainDEM,k=this.projection.name==="mercator";if(o.minzoom!==void 0&&d<o.minzoom)return[];o.maxzoom!==void 0&&d>o.maxzoom&&(d=o.maxzoom);const z=this.locationCoordinate(this.center),G=this.center.lat,Z=1<<d,Y=[Z*z.x,Z*z.y,0],re=this.projection.name==="globe",ne=!re,oe=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,ne),_e=re?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),me=Z*i.bH(1,this.center.lat),we=this._camera.position[2]/i.bH(1,this.center.lat),be=[Z*_e.x,Z*_e.y,we*(ne?1:me)],Ee=re||S,$e=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Ve=this.isLODDisabled(!0)?d:0;let Qe;if(this._elevation&&o.isTerrainDEM)Qe=1e4*this._elevation.exaggeration();else if(this._elevation){const ft=this._elevation.getMinMaxForVisibleTiles();Qe=ft?ft.max:this._centerAltitude}else Qe=this._centerAltitude;const We=o.isTerrainDEM?-Qe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ke=this.projection.isReprojectedInTileSpace?i.bS(this):1,Ge=ft=>{const Ct=new i.aa(ft.x+25e-6,ft.y,ft.z),Qt=new i.aa(ft.x,ft.y+25e-6,ft.z),$t=ft.toLngLat(),zt=Ct.toLngLat(),Yt=Qt.toLngLat(),nr=this.locationCoordinate($t),yr=this.locationCoordinate(zt),_r=this.locationCoordinate(Yt),Wr=Math.hypot(yr.x-nr.x,yr.y-nr.y),Or=Math.hypot(_r.x-nr.x,_r.y-nr.y);return Math.sqrt(Wr*Or)*Ke/25e-6},Ye=ft=>{const Ft=Qe,Ct=We;return{aabb:i.bV(this,Z,0,0,0,ft,Ct,Ft,this.projection),zoom:0,x:0,y:0,minZ:Ct,maxZ:Ft,wrap:ft,fullyVisible:!1}},it=[];let bt=[];const pt=d,kt=o.reparseOverscaled?y:d,Et=(we-this._centerAltitude)*me,dt=ft=>{if(!this._elevation||!ft.tileID||!k)return;const Ft=this._elevation.getMinMaxForTile(ft.tileID),Ct=ft.aabb;Ft?(Ct.min[2]=Ft.min,Ct.max[2]=Ft.max,Ct.center[2]=(Ct.min[2]+Ct.max[2])/2):(ft.shouldSplit=Gt(ft),ft.shouldSplit||(Ct.min[2]=Ct.max[2]=Ct.center[2]=this._centerAltitude))},jt=(ft,Ft)=>{if(.707*Ft<ft)return 1;const Ct=Ft/ft;return Ct/(1.4144271570014144+(Math.pow(1.1,Ct-1.4144271570014144+1)-1)/(1.1-1)-1)},Gt=ft=>{if(ft.zoom<Ve)return!0;if(ft.zoom===pt)return!1;if(ft.shouldSplit!=null)return ft.shouldSplit;const Ft=ft.aabb.distanceX(be),Ct=ft.aabb.distanceY(be);let Qt=Et,$t=1;if(re){Qt=ft.aabb.distanceZ(be);const Or=Math.pow(2,ft.zoom),Lr=i.aS((ft.y+1)/Or),Zr=i.aS(ft.y/Or),Dn=Math.min(Math.max(G,Lr),Zr),hi=i.c9(Dn)/i.c9(G);if($t=Dn===G?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,hi/this._mercatorScaleRatio),this.zoom<=i.c6&&ft.zoom===pt-1&&hi>=.9)return!0}else if(N&&(Qt=ft.aabb.distanceZ(be)*me),this.projection.isReprojectedInTileSpace&&y<=5){const Or=Math.pow(2,ft.zoom),Lr=Ge(new i.aa((ft.x+.5)/Or,(ft.y+.5)/Or));$t=Lr>.85?1:Lr}if(!k){const Or=Math.sqrt(Ft*Ft+Ct*Ct+Qt*Qt);let Lr=(1<<pt-ft.zoom)*$e*$t;return Lr*=jt(Math.max(Qt,Et),Or),Or<Lr}let zt=Number.MAX_VALUE,Yt=0;const nr=ft.aabb.getCorners(),yr=[];for(const Or of nr){i.ab.vec3.sub(yr,Or,be),re||(N?yr[2]*=me:yr[2]=Et);const Lr=i.ab.vec3.dot(yr,this._camera.forward());Lr<zt&&(zt=Lr,Yt=Math.abs(yr[2]))}let _r=(1<<pt-ft.zoom)*$e*$t;if(_r*=jt(Math.max(Yt,Et),zt),zt<_r)return!0;const Wr=ft.aabb.closestPoint(Y);return Wr[0]===Y[0]&&Wr[1]===Y[1]};if(this.renderWorldCopies)for(let ft=1;ft<=3;ft++)it.push(Ye(-ft)),it.push(Ye(ft));for(it.push(Ye(0));it.length>0;){const ft=it.pop(),Ft=ft.x,Ct=ft.y;let Qt=ft.fullyVisible;const $t=()=>this.projection.name==="globe"&&(ft.y===0||ft.y===(1<<ft.zoom)-1);if(!Qt){let zt=Ee?ft.aabb.intersects(oe):ft.aabb.intersectsFlat(oe);if(zt===0&&$t()){const Yt=new i.bT(ft.zoom,Ft,Ct);zt=i.bU(this,Z,Yt,!0).intersects(oe)}if(zt===0)continue;Qt=zt===2}if(ft.zoom!==pt&&Gt(ft))for(let zt=0;zt<4;zt++){const Yt=(Ft<<1)+zt%2,nr=(Ct<<1)+(zt>>1),yr={aabb:k?ft.aabb.quadrant(zt):i.bV(this,Z,ft.zoom+1,Yt,nr,ft.wrap,ft.minZ,ft.maxZ,this.projection),zoom:ft.zoom+1,x:Yt,y:nr,wrap:ft.wrap,fullyVisible:Qt,tileID:void 0,shouldSplit:void 0,minZ:ft.minZ,maxZ:ft.maxZ};N&&!re&&(yr.tileID=new i.aG(ft.zoom+1===pt?kt:ft.zoom+1,ft.wrap,ft.zoom+1,Yt,nr),dt(yr)),it.push(yr)}else{const zt=ft.zoom===pt?kt:ft.zoom;if(o.minzoom&&o.minzoom>zt)continue;let Yt=0;if(!Qt){let Wr=Ee?ft.aabb.intersectsPrecise(oe):ft.aabb.intersectsPreciseFlat(oe);if(Wr===0&&$t()){const Or=new i.bT(ft.zoom,Ft,Ct);Wr=i.bU(this,Z,Or,!0).intersectsPrecise(oe)}if(Wr===0)continue;if(o.calculateQuadrantVisibility)if(oe.containsPoint(ft.aabb.center))Yt=15;else for(let Or=0;Or<4;Or++)ft.aabb.quadrant(Or).intersects(oe)!==0&&(Yt|=1<<Or)}const nr=Y[0]-(.5+Ft+(ft.wrap<<ft.zoom))*(1<<d-ft.zoom),yr=Y[1]-.5-Ct,_r=ft.tileID?ft.tileID:new i.aG(zt,ft.wrap,ft.zoom,Ft,Ct);o.calculateQuadrantVisibility&&(_r.visibleQuadrants=Yt),bt.push({tileID:_r,distanceSq:nr*nr+yr*yr})}}if(this.fogCullDistSq){const ft=this.fogCullDistSq,Ft=this.horizonLineFromTop();bt=bt.filter(Ct=>{const Qt=[0,0,0,1],$t=[i.ag,i.ag,0,1],zt=this.calculateFogTileMatrix(Ct.tileID.toUnwrapped());i.ab.vec4.transformMat4(Qt,Qt,zt),i.ab.vec4.transformMat4($t,$t,zt);const Yt=i.ab.vec4.min([],Qt,$t),nr=i.ab.vec4.max([],Qt,$t),yr=i.bW(Yt,nr);if(yr===0)return!0;let _r=!1;const Wr=this._elevation;if(Wr&&yr>ft&&Ft!==0){const Or=this.calculateProjMatrix(Ct.tileID.toUnwrapped());let Lr;o.isTerrainDEM||(Lr=Wr.getMinMaxForTile(Ct.tileID)),Lr||(Lr={min:We,max:Qe});const Zr=i.c7(this.rotation),Dn=[Zr[0]*i.ag,Zr[1]*i.ag,Lr.max];i.ab.vec3.transformMat4(Dn,Dn,Or),_r=(1-Dn[1])*this.height*.5<Ft}return yr<ft||_r})}return bt.sort((ft,Ft)=>ft.distanceSq-Ft.distanceSq).map(ft=>ft.tileID)}resize(o,d){this.width=o,this.height=d,this.pixelsToGLUnits=[2/o,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const d=i.aw(o.lat,-i.bX,i.bX),y=this.projection.project(o.lng,d);return new i.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,d){let y,S;const N=this.centerPoint;if(this.projection.name==="globe"){const z=this.worldSize;y=(d.x-N.x)/z,S=(d.y-N.y)/z}else{const z=this.pointCoordinate(d),G=this.pointCoordinate(N);y=z.x-G.x,S=z.y-G.y}const k=this.locationCoordinate(o);this.setLocation(new i.aa(k.x-y,k.y-S))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,d){const y=d?i.bH(d,o.lat):void 0,S=this.projection.project(o.lng,o.lat);return new i.aa(S.x,S.y,y)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,d){const y=d??this._centerAltitude,S=[o.x,o.y,0,1],N=[o.x,o.y,1,1];i.ab.vec4.transformMat4(S,S,this.pixelMatrixInverse),i.ab.vec4.transformMat4(N,N,this.pixelMatrixInverse);const k=N[3];i.ab.vec4.scale(S,S,1/S[3]),i.ab.vec4.scale(N,N,1/k);const z=S[2],G=N[2];return{p0:S,p1:N,t:z===G?0:(y-z)/(G-z)}}screenPointToMercatorRay(o){const d=[o.x,o.y,0,1],y=[o.x,o.y,1,1];return i.ab.vec4.transformMat4(d,d,this.pixelMatrixInverse),i.ab.vec4.transformMat4(y,y,this.pixelMatrixInverse),i.ab.vec4.scale(d,d,1/d[3]),i.ab.vec4.scale(y,y,1/y[3]),d[2]=i.bH(d[2],this._center.lat)*this.worldSize,y[2]=i.bH(y[2],this._center.lat)*this.worldSize,i.ab.vec4.scale(d,d,1/this.worldSize),i.ab.vec4.scale(y,y,1/this.worldSize),new i.aq([d[0],d[1],d[2]],i.ab.vec3.normalize([],i.ab.vec3.sub([],y,d)))}rayIntersectionCoordinate(o){const{p0:d,p1:y,t:S}=o,N=i.bH(d[2],this._center.lat),k=i.bH(y[2],this._center.lat);return new i.aa(i.af(d[0],y[0],S)/this.worldSize,i.af(d[1],y[1],S)/this.worldSize,i.af(N,k,S))}pointCoordinate(o,d=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,d)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let d=this.projection.pointCoordinate3D(this,o.x,o.y);if(d)return new i.aa(d[0],d[1],d[2]);let y=0,S=this.horizonLineFromTop();if(o.y>S)return this.pointCoordinate(o);const N=.02*S,k=o.clone();for(let z=0;z<10&&S-y>N;z++){k.y=i.af(y,S,.66);const G=this.projection.pointCoordinate3D(this,k.x,k.y);G?(S=k.y,d=G):y=k.y}return d?new i.aa(d[0],d[1],d[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=i.bY)return!this.isPointAboveHorizon(o);const d=this.pointCoordinate(o);return d.y>=0&&d.y<=1}_coordinatePoint(o,d){const y=d&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,S=[o.x*this.worldSize,o.y*this.worldSize,y+o.toAltitude(),1];return i.ab.vec4.transformMat4(S,S,this.pixelMatrix),S[3]>0?new i.P(S[0]/S[3],S[1]/S[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:d}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,N=this.pointLocation3D(new i.P(d,o)),k=this.pointLocation3D(new i.P(S,o)),z=this.pointLocation3D(new i.P(S,y)),G=this.pointLocation3D(new i.P(d,y));let Z=Math.min(N.lng,k.lng,z.lng,G.lng),Y=Math.max(N.lng,k.lng,z.lng,G.lng),re=Math.min(N.lat,k.lat,z.lat,G.lat),ne=Math.max(N.lat,k.lat,z.lat,G.lat);const oe=Math.pow(2,-this.zoom)/16*270,_e=this.projection.name==="globe"?1:4,me=(we,be,Ee,$e,Ve)=>{const Qe=(we+Ee)/2,We=(be+$e)/2,Ke=new i.P(Qe,We),{lng:Ge,lat:Ye}=this.pointLocation3D(Ke),it=Math.max(0,Z-Ge,re-Ye,Ge-Y,Ye-ne);Z=Math.min(Z,Ge),Y=Math.max(Y,Ge),re=Math.min(re,Ye),ne=Math.max(ne,Ye),(Ve<_e||it>oe)&&(me(we,be,Qe,We,Ve+1),me(Qe,We,Ee,$e,Ve+1))};if(me(d,o,S,o,1),me(S,o,S,y,1),me(S,y,d,y,1),me(d,y,d,o,1),this.projection.name==="globe"){const[we,be]=i.bZ(this);we?(ne=90,Y=180,Z=-180):be&&(re=-90,Y=180,Z=-180)}return new i.az(new i.bO(Z,re),new i.bO(Y,ne))}_getBoundsRectangular(o,d){const{top:y,left:S}=this._edgeInsets,N=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,z=new i.P(S,y),G=new i.P(k,y),Z=new i.P(k,N),Y=new i.P(S,N);let re=this.pointCoordinate(z,o),ne=this.pointCoordinate(G,o);const oe=this.pointCoordinate(Z,d),_e=this.pointCoordinate(Y,d),me=(we,be)=>(be.y-we.y)/(be.x-we.x);return re.y>1&&ne.y>=0?re=new i.aa((1-_e.y)/me(_e,re)+_e.x,1):re.y<0&&ne.y<=1&&(re=new i.aa(-_e.y/me(_e,re)+_e.x,0)),ne.y>1&&re.y>=0?ne=new i.aa((1-oe.y)/me(oe,ne)+oe.x,1):ne.y<0&&re.y<=1&&(ne=new i.aa(-oe.y/me(oe,ne)+oe.x,0)),new i.az().extend(this.coordinateLocation(re)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(_e)).extend(this.coordinateLocation(oe))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=o.visibleDemTiles.reduce((y,S)=>{if(S.dem){const N=S.dem.tree;y.min=Math.min(y.min,N.minimums[0]),y.max=Math.max(y.max,N.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*o.exaggeration(),d.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-d*(1-this._horizonShift);return o?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-i.bX,this.maxLat=i.bX,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.at(this.minLng)*this.tileSize,this.worldMaxX=i.at(this.maxLng)*this.tileSize,this.worldMinY=i.aA(this.maxLat)*this.tileSize,this.worldMaxY=i.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,d){return this.projection.createTileMatrix(this,d,o)}calculateDistanceTileData(o){const d=o.key,y=this._distanceTileDataCache;if(y[d])return y[d];const S=o.canonical,N=1/this.height,k=this.cameraWorldSize,z=k/this.zoomScale(S.z),G=(S.x+Math.pow(2,S.z)*o.wrap)*z,Z=S.y*z,Y=this.point;Y.x*=k/this.worldSize,Y.y*=k/this.worldSize;const re=this.angle,ne=Math.sin(-re),oe=-Math.cos(-re);return y[d]={bearing:[ne,oe],center:[(Y.x-G)*N,(Y.y-Z)*N],scale:z/i.ag*N},y[d]}calculateFogTileMatrix(o){const d=o.key,y=this._fogTileMatrixCache;if(y[d])return y[d];const S=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return i.ab.mat4.multiply(S,this.worldToFogMatrix,S),y[d]=new Float32Array(S),y[d]}calculateProjMatrix(o,d=!1,y=!1){const S=o.key;let N;if(N=y?this._expandedProjMatrixCache:d?this._alignedProjMatrixCache:this._projMatrixCache,N[S])return N[S];const k=this.calculatePosMatrix(o,this.worldSize);let z;return z=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:d?this.alignedProjMatrix:this.projMatrix,i.ab.mat4.multiply(k,z,k),N[S]=new Float32Array(k),N[S]}calculatePixelsToTileUnitsMatrix(o){const d=o.tileID.key,y=this._pixelsToTileUnitsCache;if(y[d])return y[d];const S=i.b_(o,this);return y[d]=S,y[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,d=i.ab.mat4.fromScaling([],[o,o,o]);return i.ab.mat4.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const d=i.bH(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(d),S=this._camera.forward(),N=i.bH(1,this._center.lat);y[2]/=N,S[2]/=N,i.ab.vec3.normalize(S,S);const k=o.raycast(y,S,o.exaggeration());if(k){const z=i.ab.vec3.scaleAndAdd([],y,S,k),G=new i.aa(z[0],z[1],i.bH(z[2],i.aS(z[1]))),Z=(G.z+i.ab.vec3.length([G.x-y[0],G.y-y[1],G.z-y[2]*N]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(Z),this._centerAltitude=G.toAltitude(),this._center=this.coordinateLocation(G),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const d=this._elevation,y=i.bH(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(y),N=d.getAtPointOrZero(new i.aa(...S)),k=this.pixelsPerMeter/this.worldSize*N,z=this._minimumHeightOverTerrain(),G=S[2]-k;if(G<=z)if(G<0||o){const Z=this.locationCoordinate(this._center,this._centerAltitude),Y=[S[0],S[1],Z.z-S[2]],re=i.ab.vec3.length(Y);Y[2]-=(z-G)/this._pixelsPerMercatorPixel;const ne=i.ab.vec3.length(Y);if(ne===0)return;i.ab.vec3.scale(Y,Y,re/ne*this._pixelsPerMercatorPixel),this._camera.position=[S[0],S[1],Z.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const ne=this.center;return ne.lat=i.aw(ne.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(ne.lng=i.aw(ne.lng,this.minLng,this.maxLng)),this.center=ne,void(this._constraining=!1)}const d=this._unmodified,{x:y,y:S}=this.point;let N=0,k=y,z=S;const G=this.width/2,Z=this.height/2,Y=this.worldMinY*this.scale,re=this.worldMaxY*this.scale;if(S-Z<Y&&(z=Y+Z),S+Z>re&&(z=re-Z),re-Y<this.height&&(N=Math.max(N,this.height/(re-Y)),z=(re+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ne=this.worldMinX*this.scale,oe=this.worldMaxX*this.scale,_e=this.worldSize/2-(ne+oe)/2;k=(y+_e+this.worldSize)%this.worldSize-_e,k-G<ne&&(k=ne+G),k+G>oe&&(k=oe-G),oe-ne<this.width&&(N=Math.max(N,this.width/(oe-ne)),k=(oe+ne)/2)}k===y&&z===S||(this.center=this.unproject(new i.P(k,z))),N&&(this.zoom+=this.scaleZoom(N)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,d=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bH(1,this.center.lat)/i.bH(1,i.c8));const S=i.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const N=this.projection.zAxisUnit==="meters"?y:1,k=this._camera.getWorldToCamera(this.worldSize,N);let z;const G=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(G[8]=2*-o.x/this.width,G[9]=2*o.y/this.height,this.isOrthographic){let Ye=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),it=Ye*this.aspect,bt=-it,pt=-Ye;it-=o.x,bt-=o.x,Ye+=o.y,pt+=o.y,z=this._camera.getCameraToClipOrthographic(bt,it,pt,Ye,this._nearZ,this._farZ),((kt,Et,dt,jt)=>{for(let Gt=0;Gt<16;Gt++)kt[Gt]=Ty(Et[Gt],dt[Gt],jt)})(z,z,G,Sp(this.pitch>=15?1:this.pitch/15))}else z=G;const Z=i.ab.mat4.mul([],G,k);let Y=i.ab.mat4.mul([],z,k);if(this.projection.isReprojectedInTileSpace){const Ye=this.locationCoordinate(this.center),it=i.ab.mat4.identity([]);i.ab.mat4.translate(it,it,[Ye.x*this.worldSize,Ye.y*this.worldSize,0]),i.ab.mat4.multiply(it,it,i.c0(this)),i.ab.mat4.translate(it,it,[-Ye.x*this.worldSize,-Ye.y*this.worldSize,0]),i.ab.mat4.multiply(Y,Y,it),i.ab.mat4.multiply(Z,Z,it),this.inverseAdjustmentMatrix=i.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.ab.mat4.scale([],Y,[this.worldSize,this.worldSize,this.worldSize/N,1]),this.projMatrix=Y,this.invProjMatrix=i.ab.mat4.invert(new Float64Array(16),this.projMatrix),d){const Ye=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ye[8]=2*-o.x/this.width,Ye[9]=2*o.y/this.height,this.expandedFarZProjMatrix=i.ab.mat4.mul([],Ye,k)}else this.expandedFarZProjMatrix=this.projMatrix;const re=i.ab.mat4.invert([],z);this.frustumCorners=i.c2.fromInvProjectionMatrix(re,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!d);const ne=new Float32Array(16);i.ab.mat4.identity(ne),i.ab.mat4.scale(ne,ne,[1,-1,1]),i.ab.mat4.rotateX(ne,ne,this._pitch),i.ab.mat4.rotateZ(ne,ne,this.angle);const oe=i.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.ab.mat4.clone(oe);const _e=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;oe[8]=2*-o.x/this.width,oe[9]=2*(o.y+_e)/this.height,this.skyboxMatrix=i.ab.mat4.multiply(ne,oe,ne);const me=this.point,we=me.x,be=me.y,Ee=this.width%2/2,$e=this.height%2/2,Ve=Math.cos(this.angle),Qe=Math.sin(this.angle),We=we-Math.round(we)+Ve*Ee+Qe*$e,Ke=be-Math.round(be)+Ve*$e+Qe*Ee,Ge=new Float64Array(Y);if(i.ab.mat4.translate(Ge,Ge,[We>.5?We-1:We,Ke>.5?Ke-1:Ke,0]),this.alignedProjMatrix=Ge,Y=i.ab.mat4.create(),i.ab.mat4.scale(Y,Y,[this.width/2,-this.height/2,1]),i.ab.mat4.translate(Y,Y,[1,-1,0]),this.labelPlaneMatrix=Y,Y=i.ab.mat4.create(),i.ab.mat4.scale(Y,Y,[1,-1,1]),i.ab.mat4.translate(Y,Y,[-1,-1,0]),i.ab.mat4.scale(Y,Y,[2/this.width,2/this.height,1]),this.glCoordMatrix=Y,this.pixelMatrix=i.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,Z),this._calcFogMatrices(),this._distanceTileDataCache={},Y=i.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!Y)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=Y,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c3(this);const Ye=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.ab.vec3.transformMat4(Ye,Ye,k),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=Y;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,y=this._camera.position,S=1/this.height/this._pixelsPerMercatorPixel,N=[o,o,d];i.ab.vec3.scale(N,N,S),i.ab.vec3.scale(y,y,-1),i.ab.vec3.multiply(y,y,N);const k=i.ab.mat4.create();i.ab.mat4.translate(k,k,y),i.ab.mat4.scale(k,k,N),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,d,S)}_computeCameraPosition(o){const d=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),S=this.point,N=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-o/this.worldSize*this._centerAltitude;return[S.x/this.worldSize-y[0]*N,S.y/this.worldSize-y[1]*N,o/this.worldSize*this._centerAltitude-y[2]*N]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],S=o[2];let N=1;this.projection.wrap&&(this.center=this.center.wrap()),S>0&&(N=Math.min((d-y)/S,1)),this._camera.position=i.ab.vec3.scaleAndAdd([],this._camera.position,o,N),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,d=this._camera.forward(),{pitch:y,bearing:S}=this._camera.getPitchBearing(),N=i.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ai(this._maxPitch)),z=Math.max((o[2]-N)/Math.cos(y),k),G=this._zoomFromMercatorZ(z);i.ab.vec3.scaleAndAdd(o,o,d,z),this._pitch=i.aw(y,i.ai(this.minPitch),i.ai(this.maxPitch)),this.angle=i.bF(S,-Math.PI,Math.PI),this._setZoom(i.aw(G,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.aa(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let d=0,y=i.bY,S=0,N=1/0;for(;y-d>1e-6&&y>d;){const k=d+.5*(y-d),z=this.tileSize*Math.pow(2,k),G=this.getCameraToCenterDistance(this.projection,k,z),Z=this.scaleZoom(G/(o*this.tileSize)),Y=Math.abs(k-Z);Y<N&&(N=Y,S=k),k<Z?d=k:y=k}return S}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,d){const y=Math.min(o.x,d.x),S=Math.max(o.x,d.x),N=Math.min(o.y,d.y),k=Math.max(o.y,d.y);if(N<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const z=[new i.P(y,N),new i.P(S,k),new i.P(y,k),new i.P(S,N)],G=this.renderWorldCopies?-3:0,Z=this.renderWorldCopies?4:1;for(const Y of z){const re=this.pointRayIntersection(Y);if(re.t<0)return!0;const ne=this.rayIntersectionCoordinate(re);if(ne.x<G||ne.y<0||ne.x>Z||ne.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(o,d){const y=i.ab.vec3.length(i.ab.vec3.sub([],this._camera.position,o)),S=this._zoomFromMercatorZ(y)+d;return y-this._mercatorZfromZoom(S)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([d,y,S],N){const k=[d,y,S,1];i.ab.vec4.transformMat4(k,k,N);const z=k[3]=Math.max(k[3],1e-6);return k[0]/=z,k[1]/=z,k[2]/=z,k}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,o))}}getCameraToCenterDistance(o,d=this.zoom,y=this.worldSize){const S=i.b$(o,d,this.width,this.height,1024),N=o.pixelSpaceConversion(this.center.lat,y,S);let k=.5/Math.tan(.5*this._fov)*this.height*N;return this.isOrthographic&&(k=Ty(1,k,Sp(this.pitch>=15?1:this.pitch/15))),k}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.ab.mat4.multiply(o,o,this.globeMatrix),o}getFrustum(o){return i.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const Il=(g,o)=>{if(o>0&&g.terrain&&i.w("Cutoff is currently disabled on terrain"),o<=0||g.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const d=g.transform,y=Math.max(Math.abs(d._zoom-(g.minCutoffZoom-1)),1),S=d.isLODDisabled(!1)?i.ac(60,45,d.pitch):i.ac(30,15,d.pitch),N=d._farZ-d._nearZ,k=o*d.height,z=((1-(G=S))*d.cameraToCenterDistance+G*(d._farZ+k))*y;var G;return{shouldRenderCutoff:S<1,uniformValues:{u_cutoff_params:[d._nearZ,d._farZ,(z-d._nearZ)/N,(z-k-d._nearZ)/N]}}},Ia={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class au{constructor(o,d){this.aabb=o,this.lastCascade=d}}class lf{add(o,d){const y=this.receivers[o.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],d.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],d.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],d.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],d.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],d.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],d.max[2])):this.receivers[o.key]=new au(d,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,d,y){const S=i.cd.fromPoints(o.points);let N=0;for(const k in this.receivers){const z=this.receivers[k];if(!z||!S.intersectsAabb(z.aabb))continue;z.aabb.min=S.closestPoint(z.aabb.min),z.aabb.max=S.closestPoint(z.aabb.max);const G=z.aabb.getCorners();for(let Z=0;Z<y.length;Z++){let Y=!0;for(const re of G){const ne=[re[0]*d,re[1]*d,re[2]];if(i.ab.vec3.transformMat4(ne,ne,y[Z].matrix),ne[0]<-1||ne[0]>1||ne[1]<-1||ne[1]>1){Y=!1;break}}if(z.lastCascade=Z,N=Math.max(N,Z),Y)break}}return N+1}}class Kd{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new lf,this._depthMode=new Br(o.context.gl.LEQUAL,Br.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(Ia,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(Ia,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(Ia,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,d){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!d||!d.properties)return;const S=d.properties.get("shadow-intensity");if(!d.shadowsEnabled()||S<=0||(this._shadowLayerCount=y.style.order.reduce((_e,me)=>{const we=y.style._mergedLayers[me];return _e+(we.hasShadowPass()&&!we.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const N=y.context,k=Ia.shadowMapResolution,z=Ia.shadowMapResolution;if(this._cascades.length===0||Ia.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let _e=0;_e<Ia.cascadeCount;++_e){const me=y._shadowMapDebug,we=N.gl,be=N.createFramebuffer(k,z,me,"texture"),Ee=new i.T(N,{width:k,height:z,data:null},we.DEPTH_COMPONENT16);if(be.depthAttachment.set(Ee.texture),me){const $e=new i.T(N,{width:k,height:z,data:null},we.RGBA8);be.colorAttachment.set($e.texture)}this._cascades.push({framebuffer:be,texture:Ee,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bR,scale:0})}}this.shadowDirection=su(d);let G=0;if(o.elevation){const _e=o.elevation,me=[1e4,-1e4];_e.visibleDemTiles.filter(we=>we.dem).forEach(we=>{const be=we.dem.tree;me[0]=Math.min(me[0],be.minimums[0]),me[1]=Math.max(me[1],be.maximums[0])}),me[0]!==1e4&&(G=(me[1]-me[0])*_e.exaggeration())}const Z=1.5*o.cameraToCenterDistance,Y=3*Z,re=new Float64Array(16);for(let _e=0;_e<this._cascades.length;++_e){const me=this._cascades[_e];let we=o.height/50,be=1;Ia.cascadeCount===1?be=Y:_e===0?be=Z:(we=Z,be=Y);const[Ee,$e]=uv(o,this.shadowDirection,we,be,Ia.shadowMapResolution,G);me.scale=o.scale,me.matrix=Ee,me.boundingSphereRadius=$e,i.ab.mat4.invert(re,me.matrix),me.frustum=i.bR.fromInvProjectionMatrix(re,1,0,!0),me.far=be}const ne=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[ne].far,this._cascades[ne].far],this._uniformValues.u_shadow_intensity=S,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ia.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ia.shadowMapResolution,this._uniformValues.u_shadowmap_0=Vs.ShadowMap0,this._uniformValues.u_shadowmap_1=Vs.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const oe=y.transform.elevation;for(const _e of this._groundShadowTiles){let me={min:0,max:0};if(oe){const we=oe.getMinMaxForTile(_e);we&&(me=we)}this.addShadowReceiver(_e.toUnwrapped(),me.min,me.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,d){if(!this.enabled)return;const y=this.painter,S=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),S.viewport.set([0,0,Ia.shadowMapResolution,Ia.shadowMapResolution]);for(let N=0;N<this._numCascadesToRender;++N){y.currentShadowCascade=N,S.bindFramebuffer.set(this._cascades[N].framebuffer.framebuffer),S.clear({color:i.aj.white,depth:1});for(const k of o.order){const z=o._mergedLayers[k];if(!z.hasShadowPass()||z.isHidden(y.transform.zoom))continue;const G=o.getLayerSourceCache(z),Z=G?d[G.id]:void 0;(z.type==="model"||Z&&Z.length)&&y.renderLayer(y,G,z,Z)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,d=o.style,y=o.context,S=d.directionalLight,N=d.ambientLight;if(!S||!N)return;const k=[],z=Il(o,o.longestCutoffRange);z.shouldRenderCutoff&&k.push("RENDER_CUTOFF"),k.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&k.push("NORMAL_OFFSET");const G=Ap(d,S,N),Z=new Br(y.gl.LEQUAL,Br.ReadOnly,o.depthRangeFor3D);for(const Y of this._groundShadowTiles){const re=Y.toUnwrapped(),ne=o.isTileAffectedByFog(Y),oe=o.getOrCreateProgram("groundShadow",{defines:k,overrideFog:ne});this.setupShadows(re,oe),o.uploadCommonUniforms(y,oe,re,null,z);const _e={u_matrix:o.transform.calculateProjMatrix(re),u_ground_shadow_factor:G};oe.draw(o,y.gl.TRIANGLES,Z,Kr.disabled,An.multiply,Yr.disabled,_e,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,{},o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?An.unblended:An.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const d=this.painter.transform,y=d.calculatePosMatrix(o,d.worldSize);return i.ab.mat4.multiply(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(o){return i.ab.mat4.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,d,y,S=0){if(!this.enabled)return;const N=this.painter.transform,k=this.painter.context,z=k.gl,G=this._uniformValues,Z=new Float64Array(16),Y=N.calculatePosMatrix(o,N.worldSize);for(let re=0;re<this._cascades.length;re++)i.ab.mat4.multiply(Z,this._cascades[re].matrix,Y),G[re===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(Z),k.activeTexture.set(z.TEXTURE0+Vs.ShadowMap0+re),this._cascades[re].texture.bind(z.NEAREST,z.CLAMP_TO_EDGE);if(this.useNormalOffset=!!y,this.useNormalOffset){const re=i.cc(o.canonical),ne=2/N.tileSize*i.ag/Ia.shadowMapResolution,oe=ne*this._cascades[0].boundingSphereRadius,_e=ne*this._cascades[this._cascades.length-1].boundingSphereRadius,me=(y==="vector-tile"?1:3)/Math.pow(2,S-o.canonical.z-(1-N.zoom+Math.floor(N.zoom)));G.u_shadow_normal_offset=[re,oe*me,_e*me],G.u_shadow_bias=[6e-5,.0012,.012]}else G.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(k,G)}setupShadowsFromMatrix(o,d,y=!1){if(!this.enabled)return;const S=this.painter.context,N=S.gl,k=this._uniformValues,z=new Float64Array(16);for(let G=0;G<Ia.cascadeCount;G++)i.ab.mat4.multiply(z,this._cascades[G].matrix,o),k[G===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(z),S.activeTexture.set(N.TEXTURE0+Vs.ShadowMap0+G),this._cascades[G].texture.bind(N.NEAREST,N.CLAMP_TO_EDGE);if(this.useNormalOffset=y,y){const G=Ia.normalOffset;k.u_shadow_normal_offset=[1,G,G],k.u_shadow_bias=[6e-5,.0012,.012]}else k.u_shadow_bias=[36e-5,.0012,.012];d.setShadowUniformValues(S,k)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,d,y,S){if(S[2]>=0)return{};const N=function(G,Z,Y){const re=Y/(1<<G.canonical.z);return new i.cd([G.canonical.x*re+G.wrap*Y,G.canonical.y*re+G.wrap*Y,0],[(G.canonical.x+1)*re+G.wrap*Y,(G.canonical.y+1)*re+G.wrap*Y,Z])}(o,d,y).getCorners(),k=d/-S[2];S[0]<0?(i.ab.vec3.add(N[0],N[0],[S[0]*k,0,0]),i.ab.vec3.add(N[3],N[3],[S[0]*k,0,0])):S[0]>0&&(i.ab.vec3.add(N[1],N[1],[S[0]*k,0,0]),i.ab.vec3.add(N[2],N[2],[S[0]*k,0,0])),S[1]<0?(i.ab.vec3.add(N[0],N[0],[0,S[1]*k,0]),i.ab.vec3.add(N[1],N[1],[0,S[1]*k,0])):S[1]>0&&(i.ab.vec3.add(N[2],N[2],[0,S[1]*k,0]),i.ab.vec3.add(N[3],N[3],[0,S[1]*k,0]));const z={};return z.vertices=N,z.planes=[Yu(N[1],N[0],N[4]),Yu(N[2],N[1],N[5]),Yu(N[3],N[2],N[6]),Yu(N[0],N[3],N[7])],z}addShadowReceiver(o,d,y){this._receivers.add(o,i.cd.fromTileIdAndHeight(o,d,y))}getMaxCascadeForTile(o){const d=this._receivers.get(o);return d&&d.lastCascade?d.lastCascade:0}}function Yu(g,o,d){const y=i.ab.vec3.sub([],d,o),S=i.ab.vec3.sub([],g,o),N=i.ab.vec3.cross([],y,S),k=i.ab.vec3.length(N);return k===0?[0,0,1,0]:(i.ab.vec3.scale(N,N,1/k),[N[0],N[1],N[2],-i.ab.vec3.dot(N,o)])}function su(g){const o=g.properties.get("direction"),d=i.cb(o.x,o.y,o.z);d[2]=i.aw(d[2],0,75);const y=i.ce([d[0],d[1],d[2]]);return i.ab.vec3.fromValues(y.x,y.y,y.z)}function Ap(g,o,d){const y=o.properties.get("color-use-theme")==="none",S=o.properties.get("color"),N=o.properties.get("intensity"),k=o.properties.get("direction"),z=[k.x,k.y,k.z],G=d.properties.get("color-use-theme")==="none",Z=d.properties.get("color"),Y=d.properties.get("intensity"),re=Math.max(i.ab.vec3.dot([0,0,1],z),0),ne=[0,0,0];i.ab.vec3.scale(ne,Z.toRenderColor(G?null:g.getLut(o.scope)).toArray01Linear().slice(0,3),Y);const oe=[0,0,0];return i.ab.vec3.scale(oe,S.toRenderColor(y?null:g.getLut(d.scope)).toArray01Linear().slice(0,3),re*N),i.cf([ne[0]>0?ne[0]/(ne[0]+oe[0]):0,ne[1]>0?ne[1]/(ne[1]+oe[1]):0,ne[2]>0?ne[2]/(ne[2]+oe[2]):0])}function uv(g,o,d,y,S,N){const k=g.zoom,z=g.scale,G=g.worldSize,Z=1/G,Y=g.aspect,re=Math.sqrt(1+Y*Y)*Math.tan(.5*g.fovX),ne=re*re,oe=y-d,_e=y+d;let me,we;ne>oe/_e?(me=y,we=y*re):(me=.5*_e*(1+ne),we=.5*Math.sqrt(oe*oe+2*(y*y+d*d)*ne+_e*_e*ne*ne));const be=g.projection.pixelsPerMeter(g.center.lat,G),Ee=g._camera.getCameraToWorldMercator(),$e=[0,0,-me*Z];i.ab.vec3.transformMat4($e,$e,Ee);let Ve=we*Z;const Qe=g._edgeInsets;if(!(Qe.left===0&&Qe.top===0&&Qe.right===0&&Qe.bottom===0||Qe.left===Qe.right&&Qe.top===Qe.bottom)){const Qt=g._camera.getWorldToCamera(g.worldSize,g.projection.zAxisUnit==="meters"?be:1),$t=g._camera.getCameraToClipPerspective(g._fov,g.width/g.height,d,y);$t[8]=2*-g.centerOffset.x/g.width,$t[9]=2*g.centerOffset.y/g.height;const zt=new Float64Array(16);i.ab.mat4.mul(zt,$t,Qt);const Yt=new Float64Array(16);i.ab.mat4.invert(Yt,zt);const nr=i.bR.fromInvProjectionMatrix(Yt,G,k,!0);for(const yr of nr.points){const _r=((We=yr)[0]/=z,We[1]/=z,We[2]=i.bH(We[2],g._center.lat),We);Ve=Math.max(Ve,i.ab.vec3.len(i.ab.vec3.subtract([],$e,_r)))}}var We;Ve*=S/(S-1);const Ke=Math.acos(o[2]),Ge=Math.atan2(-o[0],-o[1]),Ye=new vs;Ye.position=$e,Ye.setPitchBearing(Ke,Ge);const it=Ye.getWorldToCamera(G,be),bt=Ve*G,pt=Math.min(g._mercatorZfromZoom(17)*G*-2,-2*bt),kt=Ye.getCameraToClipOrthographic(-bt,bt,-bt,bt,pt,(bt+N*be)/o[2]),Et=new Float64Array(16);i.ab.mat4.multiply(Et,kt,it);const dt=i.ab.vec3.fromValues(Math.floor(1e6*$e[0])/1e6*G,Math.floor(1e6*$e[1])/1e6*G,0),jt=.5*S,Gt=[0,0,0];i.ab.vec3.transformMat4(Gt,dt,Et),i.ab.vec3.scale(Gt,Gt,jt);const ft=[Math.floor(Gt[0]),Math.floor(Gt[1]),Math.floor(Gt[2])],Ft=[0,0,0];i.ab.vec3.sub(Ft,Gt,ft),i.ab.vec3.scale(Ft,Ft,-1/jt);const Ct=new Float64Array(16);return i.ab.mat4.identity(Ct),i.ab.mat4.translate(Ct,Ct,Ft),i.ab.mat4.multiply(Et,Ct,Et),[Et,bt]}class Vm extends i.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(o,d){return i.aM(this.requestManager.transformRequest(d,i.R.Model).url).then(y=>{if(!y)return;const S=i.aN(y),N=new i.aO(o,void 0,void 0,S);return N.computeBoundsAndApplyParent(),N}).catch(y=>{if(y&&y.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${o} from ${d}: ${y.message}`)))})}load(o,d,y={keepNumReferences:!1}){this.models[d]||(this.models[d]={});const S=Object.keys(o);this.numModelsLoading[d]=(this.numModelsLoading[d]||0)+S.length;const N=[];for(const k of S)N.push(this.loadModel(k,o[k]));Promise.allSettled(N).then(k=>{for(let z=0;z<k.length;z++){const{status:G,value:Z}=k[z];if(G==="fulfilled"&&Z){const Y=this.models[d][S[z]];this.models[d][S[z]]={model:Z,numReferences:y.keepNumReferences&&Y?Y.numReferences:1}}}this.numModelsLoading[d]-=S.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(k=>{this.fire(new i.y(new Error(`Could not load models: ${k.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,d){return!!this.getModel(o,d)}getModel(o,d){return this.models[d]||(this.models[d]={}),this.models[d][o]?this.models[d][o].model:void 0}addModel(o,d,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={}),this.hasModel(o,y)&&this.models[y][o].numReferences++,this.modelUris[y][o]=this.requestManager.normalizeModelURL(d),this.load({[o]:this.modelUris[y][o]},y)}addModels(o,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const y=this.modelUris[d];for(const S in o)this.models[d][S]={},y[S]=this.requestManager.normalizeModelURL(o[S]);this.load(y,d,{keepNumReferences:!0})}reloadModels(o){this.load(this.modelUris[o],o)}addModelsFromBucket(o,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const y={};for(const S of o)this.hasModel(S,d)?this.models[d][S].numReferences++:(this.modelUris[d][S]=this.requestManager.normalizeModelURL(S),y[S]=this.modelUris[d][S]);this.load(y,d)}removeModel(o,d){if(this.models[d]&&this.models[d][o]&&(this.models[d][o].numReferences--,this.models[d][o].numReferences===0)){const y=this.models[d][o].model;delete this.models[d][o],delete this.modelUris[d][o],y.destroy()}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,d){this.models[d]||(this.models[d]={});for(const y in this.models[d])this.models[d][y].model&&this.models[d][y].model.upload(o.context)}}const dv=new i.a5({data:new i.a6(i.a3.colorTheme.data)}),hv={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Py(g){return g=g||{},Object.assign(g,hv)}class Ny extends i.E{constructor(o){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=o,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(o=>{o.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=o.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=o.stylesheet.indoor.buildingFeaturesetId,this._scope=o.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:o=>(o.feature&&o.feature.properties.floorplan&&this.selectFloorplan(o.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(o){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(k,z){const[G,Z]=k,{center:Y,radius:re}=z,[ne,oe]=Y,_e=Math.abs(G-ne);return Math.sqrt((_e>180?360-_e:_e)**2+(Z-oe)**2)<=re}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const d={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=new i.P(this._map.transform.width/2,this._map.transform.height/2),S=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],N=this._map.queryRenderedFeatures(o?S:y,d);N.length>0&&(this._selectedFloorplan&&N[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=N[0],this._floorplanSelected(!1)))}_floorplanSelected(o){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(N){const[[k,z],[G,Z]]=N,Y=(G-k+360)%360,re=Y>180?360-Y:Y;return{center:[(k+re/2+360)%360,(z+Z)/2],radius:Math.sqrt(re**2+(Z-z)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const d=this._floorplanStates[this._indoorData.id].selectedBuilding,y=this._floorplanStates[this._indoorData.id].selectedLevel;let S;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const N of this._indoorData.levels)N.id===this._selectedLevel.id&&(S=N.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:S})),d){const N=this._indoorData.buildings.find(k=>k.id===d);this._buildingSelected(N,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(y){const N=this._indoorData.levels.find(k=>k.id===y);this._updateLevels(N,o)}else o&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(o,d){d&&o&&o.extent&&this._map.fitBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=o?o.id:void 0;const y=this._indoorData.levels.filter(S=>o.levels.includes(S.id));this.fire(new i.z("buildingselected",{buildingId:o.id,levels:y}))}_levelSelected(o){if(o==="overview")this._updateLevels(void 0,!0);else{const d=this._indoorData.levels.find(y=>y.id===o);this._updateLevels(d,!0)}this.fire(new i.z("levelselected",{levelId:o==="overview"?void 0:o}))}_updateLevels(o,d){if(!o)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(d&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function y(Z){const Y=Z.indexOf("/floor/");if(Y===-1)return Z;const re=Y+7,ne=Z.indexOf("/",re);return ne===-1?Z.slice(re):Z.slice(re,ne)}this._selectedLevel=o,this._floorplanStates[this._indoorData.id].selectedLevel=o?o.id:void 0;const S=[],N={},k={},z={},G={};for(const Z of this._indoorData.levels)if(S.push(Z.id),N[Z.id]=Z.height,k[Z.id]=Z.base,o){if(this.mergeFloors){const Y=y(o.id),re=y(Z.id);z[Z.id]=re===Y?"true":"false"}else z[Z.id]=Z.id===o.id?"true":"false";G[Z.id]=Z.base<o.base?"true":"false"}else G[Z.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",S]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",N]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",k]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",z]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",G]),o&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!o.isUnderground),d&&o.extent)){const Z=this._map.cameraForBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),Y=this._map.getZoom(),re=Z.zoom?Math.abs(Y-Z.zoom):0;this._map.fitBounds(o.extent,re>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:Y})}}selectFloorplan(o){const d={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],S=this._map.queryRenderedFeatures(y,d);if(S.length>0){for(const N of S)if(JSON.parse(N.properties["indoor-data"]).floorplanIDs.includes(o)){this._selectedFloorplan=N,this._floorplanSelected(!0);break}}}selectBuilding(o){const d=this._indoorData.buildings.find(y=>y.id===o);this._buildingSelected(d,!0)}selectLevel(o){this._levelSelected(o)}}function W_(g){if(!g.metadata||!g.metadata.content_area)return;const o=i.q.devicePixelRatio,{left:d,top:y,width:S,height:N}=g.metadata.content_area,k=d*o,z=y*o;return[k,z,k+S*o,z+N*o]}function fv(g){if(g)return g.map(([o,d])=>[o*i.q.devicePixelRatio,d*i.q.devicePixelRatio])}const Js=(g,o)=>Go(g,o&&o.filter(d=>d.identifier!=="source.canvas")),Tp=i.ay(fn,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),jy=i.ay(fn,["setCenter","setZoom","setBearing","setPitch"]),Um=new Set(["background","sky","slot","custom"]),cf={version:8,layers:[],sources:{}},Cy={duration:300,delay:0};class Ko extends i.E{constructor(o,d={}){super(),this.map=o,this.scope=d.scope||"",this.globalId=null,this.fragments=[],this.importDepth=d.importDepth||0,this.importsCache=d.importsCache||new Map,this.resolvedImports=d.resolvedImports||new Set,this.transition=i.l({},Cy),this._buildingIndex=new tu(this),this.crossTileSymbolIndex=new Ay,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=d.styleChanges||new Cr,this.dispatcher=d.dispatcher?d.dispatcher:new i.D(i.ci(),this),d.imageManager?this.imageManager=d.imageManager:(this.imageManager=new qr(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=d.glyphManager?d.glyphManager:new i.cj(o._requestManager,d.localFontFamily?i.ck.all:d.localIdeographFontFamily?i.ck.ideographs:i.ck.none,d.localFontFamily||d.localIdeographFontFamily),d.modelManager?this.modelManager=d.modelManager:(this.modelManager=new Vm(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=d.configOptions?d.configOptions:new Map,this._configDependentLayers=d.configDependentLayers?d.configDependentLayers:new Set,this._config=d.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:d.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=d.initialConfig,this.dispatcher.broadcast("setReferrer",i.cl());const y=this;this._rtlTextPluginCallback=Ko.registerForPluginStateChange(S=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(N,k)=>{if(i.cm(N),k&&k.every(z=>z))for(const z in y._sourceCaches){const G=y._sourceCaches[z],Z=G.getSource().type;Z!=="vector"&&Z!=="geojson"||G.reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;const N=this.getOwnSource(S.sourceId);if(N&&N.vectorLayerIds)for(const k in this._layers){const z=this._layers[k];z.source===N.id&&this._validateLayer(z)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(i.f(o))return o;const d=i.cn(o);if(!d.startsWith("http"))try{return new URL(d,location.href).toString()}catch{return d}return d}return`json://${i.co(JSON.stringify(o))}`}_diffStyle(o,d,y){this.globalId=this._getGlobalId(o);const S=(N,k)=>{try{k(null,this.setState(N,y))}catch(z){k(z,!1)}};if(typeof o=="string"){const N=this.map._requestManager.normalizeStyleURL(o),k=this.map._requestManager.transformRequest(N,i.R.Style);i.n(k,(z,G)=>{z?this.fire(new i.y(z)):G&&S(G,d)})}else typeof o=="object"&&S(o,d)}loadURL(o,d={}){this.fire(new i.z("dataloading",{dataType:"style"}));const y=typeof d.validate=="boolean"?d.validate:!i.f(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,d.accessToken),this.resolvedImports.add(o);const S=this.importsCache.get(o);if(S)return this._load(S,y);const N=this.map._requestManager.transformRequest(o,i.R.Style);this._request=i.n(N,(k,z)=>{if(this._request=null,k)this.fire(new i.y(k));else if(z)return this.importsCache.set(o,z),this._load(z,y)})}loadJSON(o,d={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=i.q.frame(()=>{this._request=null,this._load(o,d.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(cf,!1)}_loadImports(o,d,y){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const S=[];for(const N of o){const k=this._createFragmentStyle(N),z=new Promise(Y=>{k.once("style.import.load",Y),k.once("error",Y)}).then(()=>this.mergeAll());if(S.push(z),this.resolvedImports.has(N.url)){k.loadEmpty();continue}const G=N.data||this.importsCache.get(N.url);G?(k.loadJSON(G,{validate:d}),this._isInternalStyle(G)&&(k.globalId=null)):N.url?k.loadURL(N.url,{validate:d}):k.loadEmpty();const Z={style:k,id:N.id,config:N.config};if(y){const Y=this.fragments.findIndex(({id:re})=>re===y);this.fragments=this.fragments.slice(0,Y).concat(Z).concat(this.fragments.slice(Y))}else this.fragments.push(Z)}return Promise.allSettled(S)}getImportGlobalIds(o=this,d=new Set){for(const y of o.fragments)y.style.globalId&&d.add(y.style.globalId),this.getImportGlobalIds(y.style,d);return[...d.values()]}_createFragmentStyle(o){const d=this.scope?i.aC(o.id,this.scope):o.id;let y;const S=this._initialConfig&&this._initialConfig[d];(o.config||S)&&(y=i.l({},o.config,S));const N=new Ko(this.map,{scope:d,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return N.setEventedParent(this.map,{style:N}),N}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,d){const y=o.indoor?Py(o.schema):o.schema;if(this._isInternalStyle(o)){const k=i.l({},cf,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(k,d)}if(this.updateConfig(this._config,y),d&&Js(this,Ua(o)))return;this._loaded=!0,this.stylesheet=i.cp(o);const S=()=>{for(const Z in o.sources)this.addSource(Z,o.sources[Z],{validate:!1,isInitialLoad:!0});o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(o.glyphs,this.scope);const k=Wu(this.stylesheet.layers);if(this._order=k.map(Z=>Z.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const Z=this.stylesheet.lights[0];this.light=new ve(Z.properties,Z.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ve(this.stylesheet.light)),this._layers={};for(const Z of k){const Y=i.cu(Z,this.scope,this._styleColorTheme.lut,this.options);Y.configDependencies.size!==0&&this._configDependentLayers.add(Y.fqid),Y.setEventedParent(this,{layer:{id:Y.id}}),this._layers[Y.id]=Y;const re=this.getOwnLayerSourceCache(Y),ne=!!this.directionalLight&&this.directionalLight.shadowsEnabled();re&&Y.canCastShadows()&&ne&&(re.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const z=this.stylesheet.terrain;z&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(z,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const G=this.isRootStyle();o.imports?this._loadImports(o.imports,d).then(()=>{this._reloadImports(),this.fire(new i.z(G?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(G?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const N=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(N){const k=this._evaluateColorThemeData(N);this._loadColorTheme(k).then(()=>{S()}).catch(z=>{i.w(`Couldn't load color theme from the stylesheet: ${z}`),S()})}else this._styleColorTheme.lut=null,S()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,d,y,S,N,k,z,G,Z,Y;const re={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(ne=>{if(ne.stylesheet){if(ne.light!=null&&(o=ne.light),ne.stylesheet.lights)for(const oe of ne.stylesheet.lights)oe.type==="ambient"&&ne.ambientLight!=null&&(d=ne.ambientLight),oe.type==="directional"&&ne.directionalLight!=null&&(y=ne.directionalLight);S=this._prioritizeTerrain(S,ne.terrain,ne.stylesheet.terrain),ne.stylesheet.fog&&ne.fog!=null&&(N=ne.fog),ne.stylesheet.snow&&ne.snow!=null&&(k=ne.snow),ne.stylesheet.rain&&ne.rain!=null&&(z=ne.rain),ne.stylesheet.camera!=null&&(Y=ne.stylesheet.camera),ne.stylesheet.projection!=null&&(G=ne.stylesheet.projection),ne.stylesheet.transition!=null&&(Z=ne.stylesheet.transition),re[ne.scope]=ne._styleColorTheme}}),this.light=o,this.ambientLight=d,this.directionalLight=y,this.fog=N,this.snow=k,this.rain=z,this._styleColorThemeForScope=re,S===null?delete this.terrain:this.terrain=S,this.camera=Y||{"camera-projection":"perspective"},this.projection=G||{name:"mercator"},this.transition=i.l({},Cy,Z),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const d=y=>{for(const S of y.fragments)d(S.style);o(y)};d(this)}_prioritizeTerrain(o,d,y){const S=o&&o.drapeRenderMode===0;return y===null?d&&d.drapeRenderMode===0?d:S?o:null:d!=null&&(!o||S||d&&d.drapeRenderMode===1)?d:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(d=>{o=this._prioritizeTerrain(o,d.terrain,d.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(d=>{d.stylesheet.projection!=null&&(o=d.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},d={},y={};this.forEachFragmentStyle(S=>{for(const N in S._sourceCaches){const k=i.aC(N,S.scope);o[k]=S._sourceCaches[N]}for(const N in S._otherSourceCaches){const k=i.aC(N,S.scope);d[k]=S._otherSourceCaches[N]}for(const N in S._symbolSourceCaches){const k=i.aC(N,S.scope);y[k]=S._symbolSourceCaches[N]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=d,this._mergedSymbolSourceCaches=y}mergeLayers(){const o={},d=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(N=>{for(const k of N._order){const z=N._layers[k];if(z.type==="slot"){const G=i.cq(k);if(o[G])continue;o[G]=[]}z.slot&&o[z.slot]?o[z.slot].push(z):d.push(z)}}),this._mergedOrder=[];const S=(N=[])=>{for(const k of N)if(k.type==="slot"){const z=i.cq(k.id);o[z]&&S(o[z]),this._mergedSlots.push(z)}else{const z=i.aC(k.id,k.scope);this._mergedOrder.push(z),y[z]=k,k.is3D()&&(this._has3DLayers=!0),k.type==="circle"&&(this._hasCircleLayers=!0),k.type==="symbol"&&(this._hasSymbolLayers=!0),k.type==="clip"&&(this._clipLayerPresent=!0)}};S(d),this._mergedOrder.sort((N,k)=>{const z=y[N],G=y[k];return z.hasInitialOcclusionOpacityProperties?G.is3D()?1:0:z.is3D()&&G.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=i.l({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(d,y,S){const N=i.l({},y);for(const z of Object.keys(i.a3.colorTheme))N[z]===void 0&&(N[z]=i.a3.colorTheme[z].default);const k=new i.a4(dv,d,new Map(S));return k.setTransitionOrValue(N,S),k.untransitioned().possiblyEvaluate(new i.a8(0))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const d=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,S)=>{const N="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let k=o;k.startsWith(N)||(k=N+k);const z="mapbox-reserved-lut",G=new Image;G.src=k,G.onerror=()=>{this._styleColorTheme.lutLoading=!1,S(new Error("Failed to load image data"))},G.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==d)return void y();this._styleColorTheme.lutLoading=!1;const{width:Z,height:Y,data:re}=i.q.getImageData(G);if(Y>32)return void S(new Error("The height of the image must be less than or equal to 32 pixels."));if(Z!==Y*Y)return void S(new Error("The width of the image must be equal to the height squared."));this.getImage(z)&&this.removeImage(z),this.addImage(z,{data:new i.r({width:Z,height:Y},re),pixelRatio:1,sdf:!1,usvg:!1,version:0});const ne=this.imageManager.getImage(z,this.scope);ne?(this._styleColorTheme.lut={image:ne.data,data:o},y()):S(new Error("Missing LUT image."))}})}getLut(o){const d=this._styleColorThemeForScope[o];return d?d.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(d,y,S){let N,k,z;const G=i.q.devicePixelRatio>1?"@2x":"";let Z=i.n(y.transformRequest(y.normalizeSpriteURL(d,G,".json"),i.R.SpriteJSON),(ne,oe)=>{Z=null,z||(z=ne,N=oe,re())}),Y=i.o(y.transformRequest(y.normalizeSpriteURL(d,G,".png"),i.R.SpriteImage),(ne,oe)=>{Y=null,z||(z=ne,k=oe,re())});function re(){if(z)S(z);else if(N&&k){const ne=i.q.getImageData(k),oe={};for(const _e in N){const{width:me,height:we,x:be,y:Ee,sdf:$e,pixelRatio:Ve,stretchX:Qe,stretchY:We,content:Ke}=N[_e],Ge=new i.r({width:me,height:we});i.r.copy(ne,Ge,{x:be,y:Ee},{x:0,y:0},{width:me,height:we},null),oe[_e]={data:Ge,pixelRatio:Ve,sdf:$e,stretchX:Qe,stretchY:We,content:Ke,usvg:!1}}S(null,oe)}}return{cancel(){Z&&(Z.cancel(),Z=null),Y&&(Y.cancel(),Y=null)}}}(o,this.map._requestManager,(d,y)=>{if(this._spriteRequest=null,d)this.fire(new i.y(d));else if(y)for(const S in y)this.imageManager.addImage(S,this.scope,y[S]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(o){if(!i.f(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const d=this.map._spriteFormat==="auto";var y,S;this._spriteRequest=(S=(N,k)=>{if(this._spriteRequest=null,N)d?this._loadSprite(o):this.fire(new i.y(N));else if(k)for(const z in k)this.imageManager.addImage(z,this.scope,k[z]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bi((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(o),i.R.Iconset),(N,k)=>{if(N)return void S(N);const z={},G=i.cg(new i.bh(k));for(const Z of G.icons){const Y={version:1,pixelRatio:i.q.devicePixelRatio,content:W_(Z),stretchX:Z.metadata?fv(Z.metadata.stretch_x_areas):void 0,stretchY:Z.metadata?fv(Z.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:Z};z[Z.name]=Y}S(null,z)}))}_validateLayer(o){const d=this.getOwnSource(o.source);if(!d)return;const y=o.sourceLayer;y&&(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(y)===-1)&&this.fire(new i.y(new Error(`Source layer "${y}" does not exist on source "${d.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,d)=>{const y=this.fragments[d];return y&&y.style&&(o.data=y.style.serialize()),o})}_serializeSources(){const o={};for(const d in this._sourceCaches){const y=this._sourceCaches[d].getSource();o[y.id]||(o[y.id]=y.serialize())}return o}_serializeLayers(o){const d=[];for(const y of o){const S=this._layers[y];S&&S.type!=="custom"&&d.push(S.serialize())}return d}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const d=this.getOwnLayer(o);if(d)return d;this.fire(new i.y(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const d=this.getOwnSource(o);if(d)return d;this.fire(new i.y(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,d){const y=this.map.painter;if(y)for(let S=o.minzoom||0;S<(o.maxzoom||25.5);S++){const N=o.getProgramIds();if(N)for(const k of N){const z=o.getDefaultProgramParams(k,d.zoom,this._styleColorTheme.lut);z&&(y.style=this,this.fog&&(y._fogVisible=!0,z.overrideFog=!0,y.getOrCreateProgram(k,z)),y._fogVisible=!1,z.overrideFog=!1,y.getOrCreateProgram(k,z),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(z.overrideRtt=!0,y.getOrCreateProgram(k,z)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const d=this.calculateLightsBrightness();o.brightness=d||0,d!==this._brightness&&(this._brightness=d,this.dispatcher.broadcast("setBrightness",d));const y=this._changes.isDirty();let S=!1;if(this._changes.isDirty()){const k=this._changes.getLayerUpdatesByScope();for(const z in k){const{updatedIds:G,removedIds:Z}=k[z];(G||Z)&&(this._updateWorkerLayers(z,G,Z),S=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const N={};for(const k in this._mergedSourceCaches){const z=this._mergedSourceCaches[k];N[k]=z.used,z.used=!1,z.tileCoverLift=0}for(const k of this._mergedOrder){const z=this._mergedLayers[k];if(z.recalculate(o,this._availableImages),!z.isHidden(o.zoom)){const G=this.getLayerSourceCache(z);G&&(G.used=!0,G.tileCoverLift=Math.max(G.tileCoverLift,z.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(z,o)}):this.precompilePrograms(z,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&S&&this.mergeLayers();for(const k in N){const z=this._mergedSourceCaches[k];N[k]!==z.used&&z.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:z.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),y&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=this._changes.getUpdatedImages();if(o.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],o);this._changes.resetUpdatedImages()}}_updateWorkerLayers(o,d,y){const S=this.getFragmentStyle(o);S&&this.dispatcher.broadcast("updateLayers",{layers:d?S._serializeLayers(d):[],scope:o,removedIds:y||[],options:S.options})}setState(o,d){if(this._checkLoaded(),Js(this,Ua(o)))return!1;(o=i.cp(o)).layers=Wu(o.layers);const y=function(k,z){if(!k)return[{command:fn.setStyle,args:[z]}];let G=[];try{if(!i.bn(k.version,z.version))return[{command:fn.setStyle,args:[z]}];if(i.bn(k.center,z.center)||G.push({command:fn.setCenter,args:[z.center]}),i.bn(k.zoom,z.zoom)||G.push({command:fn.setZoom,args:[z.zoom]}),i.bn(k.bearing,z.bearing)||G.push({command:fn.setBearing,args:[z.bearing]}),i.bn(k.pitch,z.pitch)||G.push({command:fn.setPitch,args:[z.pitch]}),i.bn(k.sprite,z.sprite)||G.push({command:fn.setSprite,args:[z.sprite]}),i.bn(k.glyphs,z.glyphs)||G.push({command:fn.setGlyphs,args:[z.glyphs]}),i.bn(k.imports,z.imports)||function(oe=[],_e=[],me){_e=_e||[];const we=(oe=oe||[]).map(ys),be=_e.map(ys),Ee=oe.reduce(Nc,{}),$e=_e.reduce(Nc,{}),Ve=we.slice();let Qe,We,Ke,Ge;for(Qe=0,We=0;Qe<we.length;Qe++)Ke=we[Qe],$e.hasOwnProperty(Ke)?We++:(me.push({command:fn.removeImport,args:[Ke]}),Ve.splice(Ve.indexOf(Ke,We),1));for(Qe=0,We=0;Qe<be.length;Qe++)Ke=be[be.length-1-Qe],Ve[Ve.length-1-Qe]!==Ke&&(Ee.hasOwnProperty(Ke)?(me.push({command:fn.removeImport,args:[Ke]}),Ve.splice(Ve.lastIndexOf(Ke,Ve.length-We),1)):We++,Ge=Ve[Ve.length-Qe],me.push({command:fn.addImport,args:[$e[Ke],Ge]}),Ve.splice(Ve.length-Qe,0,Ke));for(const Ye of _e){const it=Ee[Ye.id];it&&!i.bn(it,Ye)&&me.push({command:fn.updateImport,args:[Ye.id,Ye]})}}(k.imports,z.imports,G),i.bn(k.transition,z.transition)||G.push({command:fn.setTransition,args:[z.transition]}),i.bn(k.light,z.light)||G.push({command:fn.setLight,args:[z.light]}),i.bn(k.fog,z.fog)||G.push({command:fn.setFog,args:[z.fog]}),i.bn(k.snow,z.snow)||G.push({command:fn.setSnow,args:[z.snow]}),i.bn(k.rain,z.rain)||G.push({command:fn.setRain,args:[z.rain]}),i.bn(k.projection,z.projection)||G.push({command:fn.setProjection,args:[z.projection]}),i.bn(k.lights,z.lights)||G.push({command:fn.setLights,args:[z.lights]}),i.bn(k.camera,z.camera)||G.push({command:fn.setCamera,args:[z.camera]}),!i.bn(k["color-theme"],z["color-theme"]))return[{command:fn.setStyle,args:[z]}];const Z={},Y=[];(function(oe,_e,me,we){let be;for(be in _e=_e||{},oe=oe||{})oe.hasOwnProperty(be)&&(_e.hasOwnProperty(be)||Hu(be,me,we));for(be in _e){if(!_e.hasOwnProperty(be))continue;const Ee=_e[be];oe.hasOwnProperty(be)?i.bn(oe[be],Ee)||(oe[be].type==="geojson"&&Ee.type==="geojson"&&yi(oe,_e,be)?me.push({command:fn.setGeoJSONSourceData,args:[be,Ee.data]}):wr(be,_e,me,we)):Dm(be,_e,me)}})(k.sources,z.sources,Y,Z);const re=[];k.layers&&k.layers.forEach(oe=>{oe.source&&Z[oe.source]?G.push({command:fn.removeLayer,args:[oe.id]}):re.push(oe)});let ne=k.terrain;ne&&Z[ne.source]&&(G.push({command:fn.setTerrain,args:[void 0]}),ne=void 0),G=G.concat(Y),i.bn(ne,z.terrain)||G.push({command:fn.setTerrain,args:[z.terrain]}),function(oe,_e,me){_e=_e||[];const we=(oe=oe||[]).map(ys),be=_e.map(ys),Ee=oe.reduce(Nc,{}),$e=_e.reduce(Nc,{}),Ve=we.slice(),Qe=Object.create(null);let We,Ke,Ge,Ye,it,bt,pt;for(We=0,Ke=0;We<we.length;We++)Ge=we[We],$e.hasOwnProperty(Ge)?Ke++:(me.push({command:fn.removeLayer,args:[Ge]}),Ve.splice(Ve.indexOf(Ge,Ke),1));for(We=0,Ke=0;We<be.length;We++)Ge=be[be.length-1-We],Ve[Ve.length-1-We]!==Ge&&(Ee.hasOwnProperty(Ge)?(me.push({command:fn.removeLayer,args:[Ge]}),Ve.splice(Ve.lastIndexOf(Ge,Ve.length-Ke),1)):Ke++,bt=Ve[Ve.length-We],me.push({command:fn.addLayer,args:[$e[Ge],bt]}),Ve.splice(Ve.length-We,0,Ge),Qe[Ge]=!0);for(We=0;We<be.length;We++)if(Ge=be[We],Ye=Ee[Ge],it=$e[Ge],!Qe[Ge]&&!i.bn(Ye,it))if(i.bn(Ye.source,it.source)&&i.bn(Ye["source-layer"],it["source-layer"])&&i.bn(Ye.type,it.type)){for(pt in Hn(Ye.layout,it.layout,me,Ge,null,fn.setLayoutProperty),Hn(Ye.paint,it.paint,me,Ge,null,fn.setPaintProperty),i.bn(Ye.slot,it.slot)||me.push({command:fn.setSlot,args:[Ge,it.slot]}),i.bn(Ye.filter,it.filter)||me.push({command:fn.setFilter,args:[Ge,it.filter]}),i.bn(Ye.minzoom,it.minzoom)&&i.bn(Ye.maxzoom,it.maxzoom)||me.push({command:fn.setLayerZoomRange,args:[Ge,it.minzoom,it.maxzoom]}),Ye)Ye.hasOwnProperty(pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&pt!=="slot"&&(pt.indexOf("paint.")===0?Hn(Ye[pt],it[pt],me,Ge,pt.slice(6),fn.setPaintProperty):i.bn(Ye[pt],it[pt])||me.push({command:fn.setLayerProperty,args:[Ge,pt,it[pt]]}));for(pt in it)it.hasOwnProperty(pt)&&!Ye.hasOwnProperty(pt)&&pt!=="layout"&&pt!=="paint"&&pt!=="filter"&&pt!=="metadata"&&pt!=="minzoom"&&pt!=="maxzoom"&&pt!=="slot"&&(pt.indexOf("paint.")===0?Hn(Ye[pt],it[pt],me,Ge,pt.slice(6),fn.setPaintProperty):i.bn(Ye[pt],it[pt])||me.push({command:fn.setLayerProperty,args:[Ge,pt,it[pt]]}))}else me.push({command:fn.removeLayer,args:[Ge]}),bt=Ve[Ve.lastIndexOf(Ge)+1],me.push({command:fn.addLayer,args:[it,bt]})}(re,z.layers,G)}catch(Z){console.warn("Unable to compute style diff:",Z),G=[{command:fn.setStyle,args:[z]}]}return G}(this.serialize(),o).filter(k=>!(k.command in jy));if(y.length===0)return!1;const S=y.filter(k=>!(k.command in Tp));if(S.length>0)throw new Error(`Unimplemented: ${S.map(k=>k.command).join(", ")}.`);const N=[];return y.forEach(k=>{N.push(this[k.command].apply(this,k.args))}),d&&Promise.all(N).then(d),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(o,d){return this.getImage(o)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,this.scope,d),this._afterImageUpdated(o),this)}updateImage(o,d,y=!1){this.imageManager.updateImage(o,this.scope,d),y&&this._afterImageUpdated(o)}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._afterImageUpdated(o),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(o),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(o,d,y={}){return this._checkLoaded(),this._validate($u,`models.${o}`,d,null,y)||(this.modelManager.addModel(o,d,this.scope),this._changes.setDirty()),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,d,y={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(Zs,`sources.${o}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const S=ho(o,d,this.dispatcher,this);S.scope=this.scope,S.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(S.id),source:S.serialize(),sourceId:S.id}));const N=k=>{const z=(k?"symbol:":"other:")+S.id,G=i.aC(z,this.scope),Z=this._sourceCaches[z]=new Wo(G,S,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[S.id]=Z,Z.onAdd(this.map)};N(!1),d.type!=="vector"&&d.type!=="geojson"||N(!0),S.onAdd&&S.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const d=this.getOwnSource(o);if(!d)throw new Error("There is no source with this ID");for(const S in this._layers)if(this._layers[S].source===o)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while layer "${S}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new i.y(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const y=this.getOwnSourceCaches(o);for(const S of y){const N=i.cq(S.id);delete this._sourceCaches[N],this._changes.discardSourceCacheUpdate(S.id),S.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:S.getSource().id})),S.setEventedParent(null),S.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,d){this._checkLoaded(),this.getOwnSource(o).setData(d),this._changes.setDirty()}getOwnSource(o){const d=this.getOwnSourceCache(o);return d&&d.getSource()}getOwnSources(){const o=[];for(const d in this._otherSourceCaches){const y=this.getOwnSourceCache(d);y&&o.push(y.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const d in o){const y=o[d]._tiles;for(const S in y){const N=y[S];if(N.state!=="loaded"&&N.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const d=this._getTransitionParameters();for(const S of o){if(this._validate(fa,"lights",S))return;switch(S.type){case"ambient":if(this.ambientLight){const N=this.ambientLight;N.set(S),N.updateTransitions(d)}else this.ambientLight=new $r(S,ar||(ar=new i.a5({color:new i.a6(i.a3.properties_light_ambient.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const N=this.directionalLight;N.set(S),N.updateTransitions(d)}else this.directionalLight=new $r(S,or||(or=new i.a5({direction:new i.ak(i.a3.properties_light_directional.direction),color:new i.a6(i.a3.properties_light_directional.color),"color-use-theme":new i.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a6(i.a3.properties_light_directional.intensity),"cast-shadows":new i.a6(i.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a6(i.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a6(i.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=new i.a8(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,d=this.ambientLight;if(!o||!d)return;const y=ne=>.2126*(ne[0]<=.03928?ne[0]/12.92:Math.pow((ne[0]+.055)/1.055,2.4))+.7152*(ne[1]<=.03928?ne[1]/12.92:Math.pow((ne[1]+.055)/1.055,2.4))+.0722*(ne[2]<=.03928?ne[2]/12.92:Math.pow((ne[2]+.055)/1.055,2.4)),S=o.properties.get("color").toRenderColor(null).toArray01(),N=o.properties.get("intensity"),k=o.properties.get("direction"),z=1-i.cb(k.x,k.y,k.z)[2]/90,G=y(S)*N*z,Z=d.properties.get("color").toRenderColor(null).toArray01(),Y=d.properties.get("intensity"),re=y(Z)*Y;return Number(((G+re)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(!o)return this;if(i.cr(o)){const d=i.cs(o),y=this.fragments.find(({id:N})=>N===d);if(!y)throw new Error(`Style import '${o}' not found`);const S=i.cq(o);return y.style.getFragmentStyle(S)}{const d=this.fragments.find(({id:y})=>y===o);return d?d.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const d={},y=(S,N="")=>`${S}::${N}`;this._featuresetSelectors={};for(const S in o){const N=this._featuresetSelectors[S]=[];for(const k of o[S].selectors){if(k.featureNamespace){const G=this.getOwnLayer(k.layer);if(!G){i.w(`Layer is undefined for selector: ${k.layer}`);continue}const Z=y(G.source,G.sourceLayer);if(Z in d&&d[Z]!==k.featureNamespace){i.w(`"featureNamespace ${k.featureNamespace} of featureset ${S}'s selector is not associated to the same source, skip this selector`);continue}d[Z]=k.featureNamespace}let z;if(k.properties)for(const G in k.properties){const Z=i.U(k.properties[G]);Z.result==="success"&&(z=z||{},z[G]=Z.value)}N.push({layerId:k.layer,namespace:k.featureNamespace,properties:z,uniqueFeatureID:k._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const d=this.getFragmentStyle(o);if(!d||!d.stylesheet.featuresets)return[];const y=[];for(const S in d.stylesheet.featuresets)y.push({featuresetId:S,importId:d.scope?d.scope:void 0});return y}getFeaturesetLayers(o,d){const y=this.getFragmentStyle(d),S=y.stylesheet.featuresets;if(!S||!S[o])return this.fire(new i.y(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const N=[];for(const k of S[o].selectors){const z=y.getOwnLayer(k.layer);z&&N.push(z)}return N}getConfigProperty(o,d){const y=this.getFragmentStyle(o);if(!y)return null;const S=i.aC(d,y.scope),N=y.options.get(S),k=N?N.value||N.default:null;return k?k.serialize():null}setConfigProperty(o,d,y){const S=this.getFragmentStyle(o);if(!S)return;const N=S.stylesheet.indoor?Py(S.stylesheet.schema):S.stylesheet.schema;if(!N||!N[d])return;const k=i.U(y);if(k.result!=="success")return void Js(this,k.value);const z=k.value.expression,G=i.aC(d,S.scope),Z=S.options.get(G);if(!Z)return;let Y;const{minValue:re,maxValue:ne,stepValue:oe,type:_e,values:me}=N[d],we=i.U(N[d].default);we.result==="success"&&(Y=we.value.expression),Y?(this.options.set(G,Object.assign({},Z,{value:z,default:Y,minValue:re,maxValue:ne,stepValue:oe,type:_e,values:me})),this.updateConfigDependencies(d)):this.fire(new i.y(new Error(`No schema defined for the config option "${d}" in the "${o}" fragment.`)))}getConfig(o){const d=this.getFragmentStyle(o);if(!d)return null;const y=d.stylesheet.schema;if(!y)return null;const S={};for(const N in y){const k=i.aC(N,d.scope),z=d.options.get(k),G=z?z.value||z.default:null;S[N]=G?G.serialize():null}return S}setConfig(o,d){const y=this.getFragmentStyle(o);y&&(y.updateConfig(d,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const d=this.getFragmentStyle(o);return d?d.stylesheet.schema:null}setSchema(o,d){const y=this.getFragmentStyle(o);y&&(y.stylesheet.schema=d,y.updateConfig(y._config,d),this.updateConfigDependencies())}updateConfig(o,d){if(this._config=o,o||d)if(d)for(const y in d){let S,N;const k=i.U(d[y].default);if(k.result==="success"&&(S=k.value.expression),o&&o[y]!==void 0){const ne=i.U(o[y]);ne.result==="success"&&(N=ne.value.expression)}const{minValue:z,maxValue:G,stepValue:Z,type:Y,values:re}=d[y];if(S){const ne=i.aC(y,this.scope);this.options.set(ne,{default:S,value:N,minValue:z,maxValue:G,stepValue:Z,type:Y,values:re})}else this.fire(new i.y(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const d of this._configDependentLayers){const y=this.getLayer(d);if(y){if(o&&!y.configDependencies.has(o))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(d=>{const y=d._styleColorTheme.colorThemeOverride?d._styleColorTheme.colorThemeOverride:d._styleColorTheme.colorTheme;if(y){const S=d._evaluateColorThemeData(y);(!d._styleColorTheme.lut&&S!==""||d._styleColorTheme.lut&&S!==d._styleColorTheme.lut.data)&&d.setColorTheme(y)}}),this._changes.setDirty()}addLayer(o,d,y={}){this._checkLoaded();const S=o.id;if(this._layers[S])return void this.fire(new i.y(new Error(`Layer with id "${S}" already exists on this map`)));let N;if(o.type==="custom"){if(Js(this,i.ct(o)))return;N=i.cu(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(S,o.source),o=i.cp(o),o=i.l(o,{source:S})),this._validate(Bs,`layers.${S}`,o,{arrayIndex:-1},y))return;N=i.cu(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(N),N.setEventedParent(this,{layer:{id:S}})}N.configDependencies.size!==0&&this._configDependentLayers.add(N.fqid);let k=this._order.length;if(d){const Y=this._order.indexOf(d);if(Y===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));N.slot===this._layers[d].slot?k=Y:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(k,0,S),this._layerOrderChanged=!0,this._layers[S]=N;const z=this.getOwnLayerSourceCache(N),G=!!this.directionalLight&&this.directionalLight.shadowsEnabled();z&&N.canCastShadows()&&G&&(z.castsShadows=!0);const Z=this._changes.getRemovedLayer(N);if(Z&&N.source&&z&&N.type!=="custom"){this._changes.discardLayerRemoval(N);const Y=i.aC(N.source,N.scope);Z.type!==N.type?this._changes.updateSourceCache(Y,"clear"):(this._changes.updateSourceCache(Y,"reload"),z.pause())}this._updateLayer(N),N.onAdd&&N.onAdd(this.map),N.scope=this.scope,this.mergeLayers()}moveLayer(o,d){this._checkLoaded();const y=this._checkLayer(o);if(!y||o===d)return;const S=this._order.indexOf(o);this._order.splice(S,1);let N=this._order.length;if(d){const k=this._order.indexOf(d);if(k===-1)return void this.fire(new i.y(new Error(`Layer with id "${d}" does not exist on this map.`)));y.slot===this._layers[d].slot?N=k:i.w(`Layer with id "${d}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(N,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const d=this._checkLayer(o);if(!d)return;d.setEventedParent(null);const y=this._order.indexOf(o);this._order.splice(y,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(d.fqid),this._changes.removeLayer(d);const S=this.getOwnLayerSourceCache(d);if(S&&S.castsShadows){let N=!1;for(const k in this._layers)if(this._layers[k].source===d.source&&this._layers[k].canCastShadows()){N=!0;break}S.castsShadows=N}d.onRemove&&d.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const d in this._layers)if(this._layers[d].type===o)return!0;return!1}setLayerZoomRange(o,d,y){this._checkLoaded();const S=this._checkLayer(o);S&&(S.minzoom===d&&S.maxzoom===y||(d!=null&&(S.minzoom=d),y!=null&&(S.maxzoom=y),this._updateLayer(S)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,d){this._checkLoaded();const y=this._checkLayer(o);y&&y.slot!==d&&(y.slot=d,this._updateLayer(y))}setFilter(o,d,y={}){this._checkLoaded();const S=this._checkLayer(o);if(S&&!i.bn(S.filter,d))return d==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate($i,`layers.${S.id}.filter`,d,{layerType:S.type},y)||(S.filter=i.cp(d),this._updateLayer(S)))}getFilter(o){const d=this._checkLayer(o);if(d)return i.cp(d.filter)}setLayoutProperty(o,d,y,S={}){this._checkLoaded();const N=this._checkLayer(o);if(N&&!i.bn(N.getLayoutProperty(d),y)){if(y!=null&&(!S||S.validate!==!1)&&Js(N,ms.call(Ua,{key:`layers.${o}.layout.${d}`,layerType:N.type,objectKey:d,value:y,styleSpec:i.a3,style:{glyphs:!0,sprite:!0}})))return;N.setLayoutProperty(d,y),N.configDependencies.size!==0&&this._configDependentLayers.add(N.fqid),this._updateLayer(N)}}getLayoutProperty(o,d){const y=this._checkLayer(o);if(y)return y.getLayoutProperty(d)}setPaintProperty(o,d,y,S={}){this._checkLoaded();const N=this._checkLayer(o);if(!N||i.bn(N.getPaintProperty(d),y)||y!=null&&(!S||S.validate!==!1)&&Js(N,ks.call(Ua,{key:`layers.${o}.paint.${d}`,layerType:N.type,objectKey:d,value:y,styleSpec:i.a3})))return;const k=N.setPaintProperty(d,y);N.configDependencies.size!==0&&this._configDependentLayers.add(N.fqid),k&&this._updateLayer(N),this._changes.updatePaintProperties(N)}getPaintProperty(o,d){const y=this._checkLayer(o);if(y)return y.getPaintProperty(d)}setFeatureState(o,d){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:G,importId:Z}=o.target,Y=this.getFragmentStyle(Z),re=Y.getFeaturesetLayers(G);for(const{source:ne,sourceLayer:oe}of re)Y.setFeatureState({id:o.id,source:ne,sourceLayer:oe},d)}else if("layerId"in o.target){const{layerId:G}=o.target,Z=this.getLayer(G);this.setFeatureState({id:o.id,source:Z.source,sourceLayer:Z.sourceLayer},d)}return}const y=o.source,S=o.sourceLayer,N=this._checkSource(y);if(!N)return;const k=N.type;if(k==="geojson"&&S)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(k==="vector"&&!S)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const z=this.getOwnSourceCaches(y);for(const G of z)G.setFeatureState(S,o.id,d)}removeFeatureState(o,d){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:G,importId:Z}=o.target,Y=this.getFragmentStyle(Z),re=Y.getFeaturesetLayers(G);for(const{source:ne,sourceLayer:oe}of re)Y.removeFeatureState({id:o.id,source:ne,sourceLayer:oe},d)}else if("layerId"in o.target){const{layerId:G}=o.target,Z=this.getLayer(G);this.removeFeatureState({id:o.id,source:Z.source,sourceLayer:Z.sourceLayer},d)}return}const y=o.source,S=this._checkSource(y);if(!S)return;const N=S.type,k=N==="vector"?o.sourceLayer:void 0;if(N==="vector"&&!k)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const z=this.getOwnSourceCaches(y);for(const G of z)G.removeFeatureState(k,o.id,d)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let N;if("featuresetId"in o.target){const{featuresetId:k,importId:z}=o.target,G=this.getFragmentStyle(z),Z=G.getFeaturesetLayers(k);for(const{source:Y,sourceLayer:re}of Z){const ne=G.getFeatureState({id:o.id,source:Y,sourceLayer:re});if(ne&&!N)N=ne;else if(!i.bn(N,ne))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:k}=o.target,z=this.getLayer(k);N=this.getFeatureState({id:o.id,source:z.source,sourceLayer:z.sourceLayer})}return N}const d=o.source,y=o.sourceLayer,S=this._checkSource(d);if(S){if(S.type!=="vector"||y)return o.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(d)[0].getFeatureState(y,o.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=i.l({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),d=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return i.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:d,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateFilteredLayers(o){for(const d of Object.values(this._mergedLayers))o(d)&&this._updateLayer(d)}_updateLayer(o){this._changes.updateLayer(o);const d=this.getLayerSourceCache(o),y=i.aC(o.source,o.scope),S=this._changes.getUpdatedSourceCaches();o.source&&!S[y]&&d&&d.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),d.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const d=z=>this._mergedLayers[z].is3D(),y=this.order,S={},N=[];for(let z=y.length-1;z>=0;z--){const G=y[z];if(d(G)){S[G]=z;for(const Z of o){const Y=Z[G];if(Y)for(const re of Y)N.push(re)}}}N.sort((z,G)=>G.intersectionZ-z.intersectionZ);const k=[];for(let z=y.length-1;z>=0;z--){const G=y[z];if(d(G))for(let Z=N.length-1;Z>=0;Z--){const Y=N[Z].feature;if(Y.layer&&S[Y.layer.id]<z)break;k.push(Y),N.pop()}else for(const Z of o){const Y=Z[G];if(Y)for(const re of Y)k.push(re.feature)}}return k}queryRenderedFeatures(o,d,y){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate($i,"queryRenderedFeatures.filter",d.filter,null,d),S=i.aZ(d.filter));const N={},k=Y=>{if(Um.has(Y.type))return;const re=this.getOwnLayerSourceCache(Y),ne=N[re.id]=N[re.id]||{sourceCache:re,layers:{},has3DLayers:!1};Y.is3D()&&(ne.has3DLayers=!0),ne.layers[Y.fqid]=ne.layers[Y.fqid]||{styleLayer:Y,targets:[]},ne.layers[Y.fqid].targets.push({filter:S})};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const Y of d.layers){const re=this._layers[Y];if(!re)return this.fire(new i.y(new Error(`The layer '${Y}' does not exist in the map's style and cannot be queried for features.`))),[];k(re)}}else for(const Y in this._layers)k(this._layers[Y]);const z=this._queryRenderedFeatures(o,N,y),G=this._flattenAndSortRenderedFeatures(z),Z=[];for(const Y of G)i.cs(Y.layer.id)===this.scope&&Z.push(Y);return Z}queryRenderedFeatureset(o,d,y){let S;d&&!Array.isArray(d)&&d.filter&&(this._validate($i,"queryRenderedFeatures.filter",d.filter,null,d),S=i.aZ(d.filter));const N="mock",k=[];if(d&&d.target)k.push(Object.assign({},d,{targetId:N,filter:S}));else{const Y=this.getFeaturesetDescriptors();for(const re of Y)k.push({targetId:N,filter:S,target:re});for(const{style:re}of this.fragments){const ne=re.getFeaturesetDescriptors();for(const oe of ne)k.push({targetId:N,filter:S,target:oe})}}const z=this.queryRenderedTargets(o,k,y),G=[],Z=new Set;for(const Y of z)for(const re of Y.variants[N])Ml(re,Y,Z)||G.push(new i.cw(Y,re));return G}queryRenderedTargets(o,d,y){const S={},N=(z,G,Z,Y)=>{const re=S[G.id]=S[G.id]||{sourceCache:G,layers:{},has3DLayers:!1};if(re.layers[z.fqid]=re.layers[z.fqid]||{styleLayer:z,targets:[]},z.is3D()&&(re.has3DLayers=!0),!Y)return Z.uniqueFeatureID=!1,void re.layers[z.fqid].targets.push(Z);re.layers[z.fqid].targets.push(Object.assign({},Z,{namespace:Y.namespace,properties:Y.properties,uniqueFeatureID:Y.uniqueFeatureID}))};for(const z of d)if("featuresetId"in z.target){const{featuresetId:G,importId:Z}=z.target,Y=this.getFragmentStyle(Z);if(!Y||!Y._featuresetSelectors)continue;const re=Y._featuresetSelectors[G];if(!re){this.fire(new i.y(new Error(`The featureset '${G}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const ne of re){const oe=Y.getOwnLayer(ne.layerId);oe&&!Um.has(oe.type)&&N(oe,Y.getOwnLayerSourceCache(oe),z,ne)}}else if("layerId"in z.target){const{layerId:G}=z.target,Z=this.getLayer(G);if(!Z||Um.has(Z.type))continue;N(Z,this.getLayerSourceCache(Z),z)}const k=this._queryRenderedFeatures(o,S,y);return this._flattenAndSortRenderedFeatures(k)}_queryRenderedFeatures(o,d,y){const S=[],N=!!this.map._showQueryGeometry,k=Ur.createFromScreenPoints(o,y);for(const z in d){const G=Qc(k,d[z],this._availableImages,y,N);Object.keys(G).length&&S.push(G)}if(this.placement)for(const z in d){if(!d[z].sourceCache._onlySymbols)continue;const G=tf(k.screenGeometry,d[z],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(G).length&&S.push(G)}return S}querySourceFeatures(o,d){const y=d&&d.filter;y&&this._validate($i,"querySourceFeatures.filter",y,null,d);let S=[];const N=this.getOwnSourceCaches(o);for(const k of N)S=S.concat(ov(k,d));return S}addSourceType(o,d,y){return Ko.getSourceType(o)?y(new Error(`A source type called "${o}" already exists.`)):(Ko.setSourceType(o,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:d.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,d,y={}){this._checkLoaded();const S=this.light.getLight();let N=!1;for(const z in o)if(!i.bn(o[z],S[z])){N=!0;break}if(!N)return;const k=this._getTransitionParameters();this.light.setLight(o,d,y),this.light.updateTransitions(k)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,d=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),d===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=o;const S=o.source==null;if(d===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const z="terrain-dem-src";this.addSource(z,y.source),y=i.cp(y),y=i.l(y,{source:z})}const N=i.l({},y),k={};if(this.terrain&&S){N.source=this.terrain.get().source;const z=this.terrain?this.getFragmentStyle(this.terrain.scope):null;z&&(k.style=z.serialize())}if(this._validate(Pa,"terrain",N,k))return}if(!this.terrain||this.terrain.scope!==this.scope&&!S||this.terrain&&d!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,d),this.fire(new i.z("data",{dataType:"style"}))}else{const N=this.terrain,k=N.get();for(const z of Object.keys(i.a3.terrain))!y.hasOwnProperty(z)&&i.a3.terrain[z].default&&(y[z]=i.a3.terrain[z].default);for(const z in o)if(!i.bn(o[z],k[z])){N.set(o,this.options),this.stylesheet.terrain=o;const G=this._getTransitionParameters({duration:0});N.updateTransitions(G),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const d=this.fog=new wt(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_createSnow(o){const d=this.snow=new Ar(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_createRain(o){const d=this.rain=new Gr(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog;if(!i.bn(d.get(),o)){d.set(o,this.options),this.stylesheet.fog=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const d=this.snow;if(!i.bn(d.get(),o)){d.set(o,this.options),this.stylesheet.snow=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const d=this.rain;if(!i.bn(d.get(),o)){d.set(o,this.options),this.stylesheet.rain=d.get();const y=this._getTransitionParameters({duration:0});d.updateTransitions(y)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const S in this._layers)this._layers[S].lut=this._styleColorTheme.lut;for(const S in this._sourceCaches)this._sourceCaches[S].clearTiles()},d=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!d)return this._styleColorTheme.lut=null,void o();const y=this._evaluateColorThemeData(d);this._loadColorTheme(y).then(()=>{this.fire(new i.z("colorthemeset")),o()}).catch(S=>{i.w(`Couldn't set color theme: ${S}`)})}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,d){const y=this.getFragmentStyle(o);y&&(y._styleColorTheme.colorThemeOverride=d,y._reloadColorTheme())}_getTransitionParameters(o){return{now:i.q.now(),transition:i.l(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],d=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?o.push(y):d.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...d)}_createTerrain(o,d){const y=this.terrain=new Ae(o,d,this.scope,this.options);d===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const S=this._getTransitionParameters({duration:0});y.updateTransitions(S)}_force3DLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="fill-extrusion"&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const d=this._layers[o];d.type==="symbol"&&this._updateLayer(d)}}_validate(o,d,y,S,N={}){if(N&&N.validate===!1)return!1;const k=i.l({},this.serialize());return Js(this,o.call(Ua,i.l({key:d,style:k,value:y,styleSpec:i.a3},S)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(o){const d=this.getSourceCaches(o);for(const y of d)y.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){const d=this.getSourceCaches(o);for(const y of d)y.resume(),y.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(o=>{o.modelManager.reloadModels(o.scope)})}updateSources(o){let d;this.directionalLight&&(d=su(this.directionalLight));for(const y in this._mergedSourceCaches)this._mergedSourceCaches[y].update(o,void 0,void 0,d)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const d=this._sourceCaches[o];d.resume(),d.reload()}}_updatePlacement(o,d,y,S,N,k,z=!1){let G=!1,Z=!1;const Y={},re={};for(const ne of this._mergedOrder){const oe=this._mergedLayers[ne];if(oe.type!=="symbol")continue;const _e=i.aC(oe.source,oe.scope);let me=Y[_e];if(!me){const be=this.getLayerSourceCache(oe);if(!be)continue;const Ee=be.getRenderableIds(!0).map($e=>be.getTileByID($e));re[_e]=Ee.slice(),me=Y[_e]=Ee.sort(($e,Ve)=>Ve.tileID.overscaledZ-$e.tileID.overscaledZ||($e.tileID.isLessThan(Ve.tileID)?-1:1))}const we=this.crossTileSymbolIndex.addLayer(oe,me,d.center.lng,d.projection);G=G||we}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),z=z||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(z||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),d.zoom))&&(this.pauseablePlacement=new q_(d,this._mergedOrder,z,y,S,N,this.placement,this.fog&&d.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,Y,re,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),Z=!0),G&&this.pauseablePlacement.placement.setStale()),Z||G){this._buildingIndex.onNewFrame(d.zoom);for(let ne=0;ne<this._mergedOrder.length;ne++){const oe=this._mergedLayers[this._mergedOrder[ne]];if(oe.type!=="symbol")continue;const _e=this.isLayerClipped(oe);this.placement.updateLayerOpacities(oe,Y[i.aC(oe.source,oe.scope)],ne,_e?k:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,d){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:N})=>N===o.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!d)return y.push(o),this._loadImports([o],!0);const S=y.findIndex(({id:N})=>N===d);return S===-1&&this.fire(new i.y(new Error(`Import with id "${d}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,S).concat(o).concat(y.slice(S)),this._loadImports([o],!0,d)}updateImport(o,d){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(o);return S===-1?this:typeof d=="string"?(this.setImportUrl(o,d),this):(d.url&&d.url!==y[S].url&&this.setImportUrl(o,d.url),i.bn(d.config,y[S].config)||this.setImportConfig(o,d.config,d.data.schema),i.bn(d.data,y[S].data)||this.setImportData(o,d.data),this)}moveImport(o,d){this._checkLoaded();let y=this.stylesheet.imports||[];const S=this.getImportIndex(o);if(S===-1)return this;const N=this.getImportIndex(d);if(N===-1)return this;const k=y[S],z=this.fragments[S];return y=y.filter(({id:G})=>G!==o),this.fragments=this.fragments.filter(({id:G})=>G!==o),this.stylesheet.imports=y.slice(0,N).concat(k).concat(y.slice(N)),this.fragments=this.fragments.slice(0,N).concat(z).concat(this.fragments.slice(N)),this.mergeLayers(),this}setImportUrl(o,d){this._checkLoaded();const y=this.stylesheet.imports||[],S=this.getImportIndex(o);if(S===-1)return this;y[S].url=d;const N=this.fragments[S];return N.style=this._createFragmentStyle(y[S]),N.style.on("style.import.load",()=>this.mergeAll()),N.style.loadURL(d),this}setImportData(o,d){this._checkLoaded();const y=this.getImportIndex(o),S=this.stylesheet.imports||[];return y===-1?this:d?(this.fragments[y].style.setState(d),this._reloadImports(),this):(delete S[y].data,this.setImportUrl(o,S[y].url))}setImportConfig(o,d,y){this._checkLoaded();const S=this.getImportIndex(o),N=this.stylesheet.imports||[];if(S===-1)return this;d?N[S].config=d:delete N[S].config;const k=this.fragments[S];y&&k.style.stylesheet&&(k.style.stylesheet.schema=y);const z=k.style.stylesheet&&k.style.stylesheet.schema;return k.config=d,k.style.updateConfig(d,z),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const d=this.stylesheet.imports||[],y=this.getImportIndex(o);y!==-1&&(d.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(o){const d=(this.stylesheet.imports||[]).findIndex(y=>y.id===o);return d===-1&&this.fire(new i.y(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),d}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const d in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[d];y&&o.push(y.getSource())}return o}getSource(o,d){const y=this.getSourceCache(o,d);return y&&y.getSource()}getLayerSource(o){const d=this.getLayerSourceCache(o);return d&&d.getSource()}getSourceCache(o,d){const y=i.aC(o,d);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(o){const d=i.aC(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[d]:this._mergedOtherSourceCaches[d]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const d=[];return this._mergedOtherSourceCaches[o]&&d.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&d.push(this._mergedSymbolSourceCaches[o]),d}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const d in o){const y=o[d];y==="reload"?this.reloadSource(d):y==="clear"&&this.clearSource(d)}}updateLayers(o){const d=this._changes.getUpdatedPaintProperties();for(const y of d){const S=this.getLayer(y);S&&S.updateTransitions(o)}}getImages(o,d,y){this.imageManager.getImages(d.icons,d.scope,y),this._updateTilesForChangedImages();const S=N=>{N&&N.setDependencies(d.tileID.key,d.type,d.icons)};S(this._otherSourceCaches[d.source]),S(this._symbolSourceCaches[d.source])}rasterizeImages(o,d,y){this.imageManager.rasterizeImages(d,y)}getGlyphs(o,d,y){this.glyphManager.getGlyphs(d.stacks,d.scope,y)}getResource(o,d,y){return i.cy(d,y)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const d=[];return this._otherSourceCaches[o]&&d.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&d.push(this._symbolSourceCaches[o]),d}_isSourceCacheLoaded(o){const d=this.getOwnSourceCaches(o);return d.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${o}'`))),!1):d.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,d){if(!this._clipLayerPresent&&o.type!=="fill-extrusion")return!1;const y=o.type==="fill-extrusion"&&o.sourceLayer==="building";if(o.is3D()){if(y||d&&d.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ko.getSourceType=function(g){return rs[g]},Ko.setSourceType=function(g,o){rs[g]=o},Ko.registerForPluginStateChange=i.ch;var $m=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Pp=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,ou=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Ec="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Xu=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Np=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ju=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,lu=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Mc=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Zd=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Qu=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Oc=[];ed($m,Oc),ed(ou,Oc),ed(Pp,Oc);const Yd={"_prelude_fog.vertex.glsl":Np,"_prelude_terrain.vertex.glsl":Xu,"_prelude_shadow.vertex.glsl":Zd,"_prelude_fog.fragment.glsl":Ju,"_prelude_shadow.fragment.glsl":Qu,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":lu,"_prelude_raster_particle.glsl":Mc},uf={};Tn("",Xu),Tn(Ju,Np),Tn(Qu,Zd),Tn(lu,""),Tn(Mc,"");const jp=Tn(Pp,ou),df=$m;var Xd={background:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Tn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Tn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Tn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Tn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Tn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Tn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Tn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Tn(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Tn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Tn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Tn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Tn(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Tn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Tn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ec),skyboxGradient:Tn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Ec),skyboxCapture:Tn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Tn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Tn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Tn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Tn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Tn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Tn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Tn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Tn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ed(g,o){const d=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of d)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const S=y.split(" ");for(const N of S)o.includes(N)||o.push(N)}}function Tn(g,o){const d=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let S=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);S&&(S=S.map(Z=>{const Y=Z.split(" ");return Y[Y.length-1]}),S=[...new Set(S)]);const N={},k=[],z=[];if(g=g.replace(d,(Z,Y)=>(z.push(Y),"")),(o=o.replace(d,(Z,Y)=>(k.push(Y),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let G=[...Oc];ed(g,G),ed(o,G);for(const Z of[...k,...z])Yd[Z]||console.error(`Undefined include: ${Z}`),uf[Z]||(uf[Z]=[],ed(Yd[Z],uf[Z])),G=[...G,...uf[Z]];return{fragmentSource:g=g.replace(y,(Z,Y,re,ne,oe)=>(N[oe]=!0,Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
in ${re} ${ne} ${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="initialize"?`
#ifdef HAS_UNIFORM_u_${oe}
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${re} ${ne} ${oe};
#endif
`:Y==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(y,(Z,Y,re,ne,oe)=>{const _e=ne==="float"?"vec2":ne,me=oe.match(/color/)?"color":_e;return Y==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
in ${re} ${ne} a_${oe};
#endif
`:N[oe]?Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${re} ${_e} a_${oe};
out ${re} ${ne} ${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="initialize"?me==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = a_${oe};
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = unpack_mix_${me}(a_${oe}, u_${oe}_t);
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:Y==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${re} ${ne} a_${oe};
    out ${re} ${ne} ${oe};
#endif
`:Y==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${oe} = a_${oe};
#endif
`:void 0:Y==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${re} ${_e} a_${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="define-instanced"?me==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${oe}0;
in vec4 a_${oe}1;
in vec4 a_${oe}2;
in vec4 a_${oe}3;
#else
uniform ${re} ${ne} u_${oe};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${re} ${_e} a_${oe};
#else
uniform ${re} ${ne} u_${oe};
#endif
`:Y==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${re} ${ne} ${oe} = a_${oe};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${re} ${ne} ${oe} = a_${oe};
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${re} ${ne} ${oe} = unpack_mix_${me}(a_${oe}, u_${oe}_t);
#else
    ${re} ${ne} ${oe} = u_${oe};
#endif
`}),staticAttributes:S,usedDefines:G,vertexIncludes:k,fragmentIncludes:z}}class qm{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,d,y,S,N,k,z,G){this.context=o;let Z=this.boundPaintVertexBuffers.length!==S.length;for(let re=0;!Z&&re<S.length;re++)this.boundPaintVertexBuffers[re]!==S[re]&&(Z=!0);let Y=this.boundDynamicVertexBuffers.length!==z.length;for(let re=0;!Y&&re<z.length;re++)this.boundDynamicVertexBuffers[re]!==z[re]&&(Y=!0);if(!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||Z||Y||this.boundIndexBuffer!==N||this.boundVertexOffset!==k)this.freshBind(d,y,S,N,k,z,G);else{o.bindVertexArrayOES.set(this.vao);for(const re of z)re&&(re.bind(),G&&re.instanceCount&&re.setVertexAttribDivisor(o.gl,d,G));N&&N.dynamicDraw&&N.bind()}}freshBind(o,d,y,S,N,k,z){const G=o.numAttributes,Z=this.context,Y=Z.gl;this.vao&&this.destroy(),this.vao=Z.gl.createVertexArray(),Z.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=S,this.boundVertexOffset=N,this.boundDynamicVertexBuffers=k,d.enableAttributes(Y,o),d.bind(),d.setVertexAttribPointers(Y,o,N);for(const re of y)re.enableAttributes(Y,o),re.bind(),re.setVertexAttribPointers(Y,o,N);for(const re of k)re&&(re.enableAttributes(Y,o),re.bind(),re.setVertexAttribPointers(Y,o,N),z&&re.instanceCount&&re.setVertexAttribDivisor(Y,o,z));S&&S.bind(),Z.currentNumAttributes=G}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function td(g,o){const d=Math.pow(2,o.canonical.z),y=o.canonical.y;return[new i.aa(0,y/d).toLngLat().lat,new i.aa(0,(y+1)/d).toLngLat().lat]}function pv(g,o,d,y,S,N,k){const z=g.context,G=z.gl,Z=d.hillshadeFBO;if(!Z)return;g.prepareDrawTile();const Y=g.isTileAffectedByFog(o),re=g.getOrCreateProgram("hillshade",{overrideFog:Y});z.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,Z.colorAttachment.get());const ne=((we,be,Ee,$e)=>{const Ve=Ee.paint.get("hillshade-shadow-color"),Qe=Ee.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",We=Ee.paint.get("hillshade-highlight-color"),Ke=Ee.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ge=Ee.paint.get("hillshade-accent-color"),Ye=Ee.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",it=Ee.paint.get("hillshade-emissive-strength");let bt=i.ai(Ee.paint.get("hillshade-illumination-direction"));if(Ee.paint.get("hillshade-illumination-anchor")==="viewport")bt-=we.transform.angle;else if(we.style&&we.style.enable3dLights()&&we.style.directionalLight){const kt=we.style.directionalLight.properties.get("direction"),Et=i.cb(kt.x,kt.y,kt.z);bt=i.ai(Et[1])}const pt=!we.options.moving;return{u_matrix:$e||we.transform.calculateProjMatrix(be.tileID.toUnwrapped(),pt),u_image:0,u_latrange:td(0,be.tileID),u_light:[Ee.paint.get("hillshade-exaggeration"),bt],u_shadow:Ve.toRenderColor(Qe?null:Ee.lut),u_highlight:We.toRenderColor(Ke?null:Ee.lut),u_emissive_strength:it,u_accent:Ge.toRenderColor(Ye?null:Ee.lut)}})(g,d,y,g.terrain?o.projMatrix:null);g.uploadCommonUniforms(z,re,o.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:_e,tileBoundsSegments:me}=g.getTileBoundsBuffers(d);re.draw(g,G.TRIANGLES,S,N,k,Yr.disabled,ne,y.id,oe,_e,me)}function mv(g,o,d){if(!o.needsDEMTextureUpload)return;const y=g.context,S=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(d.stride);const N=d.getPixels();o.demTexture?o.demTexture.update(N,{premultiply:!1}):o.demTexture=new i.T(y,N,S.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Cp(g,o,d){const y=g.context,S=y.gl;if(!o.dem)return;const N=o.dem;if(y.activeTexture.set(S.TEXTURE1),mv(g,o,N),!o.demTexture)return;o.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const k=N.dim;y.activeTexture.set(S.TEXTURE0);let z=o.hillshadeFBO;if(!z){const ne=new i.T(y,{width:k,height:k,data:null},S.RGBA8);ne.bind(S.LINEAR,S.CLAMP_TO_EDGE),z=o.hillshadeFBO=y.createFramebuffer(k,k,!0,"renderbuffer"),z.colorAttachment.set(ne.texture)}y.bindFramebuffer.set(z.framebuffer),y.viewport.set([0,0,k,k]);const{tileBoundsBuffer:G,tileBoundsIndexBuffer:Z,tileBoundsSegments:Y}=g.getMercatorTileBoundsBuffers(),re=[];g.linearFloatFilteringSupported()&&re.push("TERRAIN_DEM_FLOAT_FORMAT"),g.getOrCreateProgram("hillshadePrepare",{defines:re}).draw(g,S.TRIANGLES,Br.disabled,Kr.disabled,An.unblended,Yr.disabled,((ne,oe)=>{const _e=oe.stride,me=i.ab.mat4.create();return i.ab.mat4.ortho(me,0,i.ag,-i.ag,0,0,1),i.ab.mat4.translate(me,me,[0,-i.ag,0]),{u_matrix:me,u_image:1,u_dimension:[_e,_e],u_zoom:ne.overscaledZ}})(o.tileID,N),d.id,G,Z,Y),o.needsHillshadePrepare=!1}class Bi{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Gm extends Bi{getDefault(){return i.aj.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Wm extends Bi{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class ca extends Bi{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class kp extends Bi{getDefault(){return[!0,!0,!0,!0]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ep extends Bi{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class hf extends Bi{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class gv extends Bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const d=this.current;(o.func!==d.func||o.ref!==d.ref||o.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Jd extends Bi{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class cu extends Bi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=o,this.dirty=!1}}class Mp extends Bi{getDefault(){return[0,1]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Os extends Bi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=o,this.dirty=!1}}class Hm extends Bi{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Km extends Bi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.BLEND):d.disable(d.BLEND),this.current=o,this.dirty=!1}}class Zm extends Bi{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ym extends Bi{getDefault(){return i.aj.transparent}set(o){const d=this.current;(o.r!==d.r||o.g!==d.g||o.b!==d.b||o.a!==d.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ff extends Bi{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class Qd extends Bi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;o?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=o,this.dirty=!1}}class Op extends Bi{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Rp extends Bi{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let pf=class extends Bi{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Xm extends Bi{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class yv extends Bi{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const d=this.current;(o[0]!==d[0]||o[1]!==d[1]||o[2]!==d[2]||o[3]!==d[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class eh extends Bi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class H_ extends Bi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class K_ extends Bi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class ky extends Bi{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class rd extends Bi{getDefault(){return null}set(o){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class vv extends Bi{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class mf extends Bi{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Dl extends Bi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class th extends Bi{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Ll extends Bi{constructor(o,d){super(o),this.context=o,this.parent=d}getDefault(){return null}}class nd extends Ll{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Ey extends Ll{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class xv extends Ll{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,this.attachment(),d.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class id extends Ey{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const rh=(g,o,d)=>({u_matrix:g,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:d}),yl=(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:d,u_zoom_transition:S,u_merc_center:N,u_image0:0,u_frustum_tl:k,u_frustum_tr:z,u_frustum_br:G,u_frustum_bl:Z,u_globe_pos:Y,u_globe_radius:re,u_viewport:ne,u_grid_matrix:me?Float32Array.from(me):new Float32Array(9),u_skirt_height:oe,u_far_z_cutoff:_e});function gf(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const jo=new class{constructor(){this.operations={}}newMorphing(g,o,d,y,S){if(g in this.operations){const N=this.operations[g];N.to.tileID.key!==d.tileID.key&&(N.queued=d)}else this.operations[g]={startTime:y,phase:0,duration:S,from:o,to:d,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const d=this.operations[o];for(d.phase=(g-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},uu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function zl(g,o,d){if(o===0)return 0;const y=o<1&&d===514?.25/o:1;return 6*Math.pow(1.5,22-g)*Math.max(o,1)*y}function ga(g,o){const d=1<<g.z;return!o&&(g.x===0||g.x===d-1)||g.y===0||g.y===d-1}const Qi=g=>({u_matrix:g});function Fl(g,o,d,y,S){if(S>0){const N=i.q.now(),k=(N-g.timeAdded)/S,z=o?(N-o.timeAdded)/S:-1,G=d.getSource(),Z=y.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),Y=!o||Math.abs(o.tileID.overscaledZ-Z)>Math.abs(g.tileID.overscaledZ-Z),re=Y&&g.refreshedUponExpiration?1:i.aw(Y?k:1-z,0,1);return g.refreshedUponExpiration&&k>=1&&(g.refreshedUponExpiration=!1),o?{opacity:1,mix:1-re}:{opacity:re,mix:0}}return{opacity:1,mix:0}}class Us extends Wo{constructor(o){const d={type:"raster-dem",maxzoom:o.transform.maxZoom},y=new i.D(i.ci(),null),S=ho("mock-dem",d,y,o.style);super("mock-dem",S,!1),S.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,d){o.state="loaded",d(null)}}class Zo extends Wo{constructor(o){const d=ho("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new i.D(i.ci(),null),o.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,d,y){if(o.freezeTileCoverage)return;this.transform=o;const S=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((N,k)=>{if(N[k.key]="",!this._tiles[k.key]){const z=new Tc(k,this._source.tileSize*k.overscaleFactor(),o.tileZoom);z.state="loaded",this._tiles[k.key]=z}return N},{});for(const N in this._tiles)N in S||(this.freeFBO(N),this._tiles[N].unloadVectorData(),delete this._tiles[N])}freeFBO(o){const d=this.proxyCachedFBO[o];if(d!==void 0){const y=Object.values(d);this.renderCachePool.push(...y),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class du extends i.aG{constructor(o,d,y){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=d,this.projMatrix=y}}class sc extends i.cJ{constructor(o,d){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,S,N]=function(G){const Z=new i.b4,Y=new i.aU,re=131;Z.reserve(17161),Y.reserve(33800);const ne=i.ag/128,oe=i.ag+ne/2,_e=oe+ne;for(let we=-ne;we<_e;we+=ne)for(let be=-ne;be<_e;be+=ne){const Ee=be<0||be>oe||we<0||we>oe?24575:0,$e=i.aw(Math.round(be),0,i.ag),Ve=i.aw(Math.round(we),0,i.ag);Z.emplaceBack($e+Ee,Ve)}const me=(we,be)=>{const Ee=be*re+we;Y.emplaceBack(Ee+1,Ee,Ee+re),Y.emplaceBack(Ee+re,Ee+re+1,Ee+1)};for(let we=1;we<129;we++)for(let be=1;be<129;be++)me(be,we);return[0,129].forEach(we=>{for(let be=0;be<130;be++)me(be,we),me(we,be)}),[Z,Y,32768]}(),k=o.context;this.gridBuffer=k.createVertexBuffer(y,i.b6.members),this.gridIndexBuffer=k.createIndexBuffer(S),this.gridSegments=i.b7.simpleSegment(0,0,y.length,S.length),this.gridNoSkirtSegments=i.b7.simpleSegment(0,0,y.length,N),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Zo(d.map),this.orthoMatrix=i.ab.mat4.create(),i.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.ag,0,i.ag,0,1);const z=k.gl;this._overlapStencilMode=new Kr({func:z.GEQUAL,mask:255},0,255,z.KEEP,z.KEEP,z.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Us(d.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,d,y){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const S=o.terrain.properties,N=o.terrain.drapeRenderMode===0,k=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const z=o.terrain&&o.terrain.scope,G=S.get("source"),Z=N?this._mockSourceCache:o.getSourceCache(G,z);if(!Z)return void i.w(`Couldn't find terrain source "${G}".`);if(this.sourceCache=Z,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=k?this.calculateExaggeration(d):S.get("exaggeration"),!d.projection.requiresDraping&&k&&this._exaggeration===0)return void this._disable();this.enabled=!0;const Y=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const re=this.getScaledDemTileSize();this.sourceCache.update(d,re,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,Y(),this._initializing=!0),Y(),d.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0,this._previousZoom=d.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const d=this._previousCameraAltitude,y=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=y;const S=d!=null?y-d:Number.MAX_VALUE;if(Math.abs(S)<2)return this._exaggeration;const N=o.zoom,k=this._style.terrain;if(!this._previousUpdateTimestamp)return k.getExaggeration(N);let z=N-this._previousZoom;const G=this._previousUpdateTimestamp;let Z=N;this._evaluationZoom!=null&&(Z=this._evaluationZoom,Math.abs(N-Z)>.5&&(z=.5*(N-Z+z)),z*S<0&&(Z+=z)),this._evaluationZoom=Z;const Y=k.getExaggeration(Z),re=Y===k.getExaggeration(Math.max(0,Z-.1));if(re&&Math.abs(Y-this._exaggeration)<.01)return Y;let ne=Math.min(.1,.00375*(this._updateTimestamp-G));return(re||Y<.1||Math.abs(z)<1e-4)&&(ne=Math.min(.2,4*ne)),i.af(this._exaggeration,Y,ne)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(i.aa.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const S=this.proxyCoords=d.getIds().map(G=>{const Z=d.getTileByID(G).tileID;return Z.projMatrix=y.calculateProjMatrix(Z.toUnwrapped()),Z});(function(G,Z){const Y=Z.transform.pointCoordinate(Z.transform.getCameraPoint()),re=new i.P(Y.x,Y.y);G.sort((ne,oe)=>{if(oe.overscaledZ-ne.overscaledZ)return oe.overscaledZ-ne.overscaledZ;const _e=new i.P(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),me=new i.P(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),we=re.mult(1<<ne.canonical.z);return we.x-=.5,we.y-=.5,we.distSqr(_e)-we.distSqr(me)})})(S,this.painter);const N=this.proxyToSource||{};this.proxyToSource={},S.forEach(G=>{this.proxyToSource[G.key]={}}),this.terrainTileForTile={};const k=this._style._mergedSourceCaches;for(const G in k){const Z=k[G];if(!Z.used||(Z!==this.sourceCache&&this.resetTileLookupCache(Z.id),this._setupProxiedCoordsForOrtho(Z,o[G],N),Z.usedForTerrain))continue;const Y=o[G];Z.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[d.id]=S.map(G=>new du(G,G.key,this.orthoMatrix)),this._assignTerrainTiles(S),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(N),this.renderingToTexture=!1;const z={};this._visibleDemTiles=[];for(const G of this.proxyCoords){const Z=this.terrainTileForTile[G.key];if(!Z)continue;const Y=Z.tileID.key;Y in z||(this._visibleDemTiles.push(Z),z[Y]=Y)}}_assignTerrainTiles(o){this._initializing||o.forEach(d=>{if(this.terrainTileForTile[d.key])return;const y=this._findTileCoveringTileID(d,this.sourceCache);y&&(this.terrainTileForTile[d.key]=y)})}_prepareDEMTextures(){const o=this.painter.context,d=o.gl;for(const y in this.terrainTileForTile){const S=this.terrainTileForTile[y],N=S.dem;!N||S.demTexture&&!S.needsDEMTextureUpload||(o.activeTexture.set(d.TEXTURE1),mv(this.painter,S,N))}}_prepareDemTileUniforms(o,d,y,S){if(!d||d.demTexture==null)return!1;const N=o.tileID.canonical,k=Math.pow(2,d.tileID.canonical.z-N.z),z=S||"";return y[`u_dem_tl${z}`]=[N.x*k%1,N.y*k%1],y[`u_dem_scale${z}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const d=this._visibleDemTiles.reduce((y,S)=>{if(!S.dem)return y;const N=S.dem.tree.minimums[0];return N>0&&o++,y+N},0);return o?d/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,d=o.gl;o.activeTexture.set(d.TEXTURE2);const y=this._getLoadedAreaMinimum(),S=new i.cK({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let N=this._emptyDEMTexture;return N?N.update(S,{premultiply:!1}):N=this._emptyDEMTexture=new i.T(o,S,d.R32F,{premultiply:!1}),N}setupElevationDraw(o,d,y){const S=this.painter.context,N=S.gl,k={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};k.u_exaggeration=this.exaggeration();let z=null,G=null,Z=1;if(y&&y.morphing&&this._useVertexMorphing){const oe=y.morphing.srcDemTile,_e=y.morphing.dstDemTile;Z=y.morphing.phase,oe&&_e&&(this._prepareDemTileUniforms(o,oe,k,"_prev")&&(G=oe),this._prepareDemTileUniforms(o,_e,k)&&(z=_e))}const Y=oe=>oe&&oe.demTexture&&this.painter.linearFloatFilteringSupported()?N.LINEAR:N.NEAREST;let re=null;var ne;if(this.enabled?G&&z?(re=z.demTexture,S.activeTexture.set(N.TEXTURE4),G.demTexture.bind(Y(G),N.CLAMP_TO_EDGE),k.u_dem_lerp=Z):(z=this.terrainTileForTile[o.tileID.key],re=this._prepareDemTileUniforms(o,z,k)?z.demTexture:this.emptyDEMTexture):re=this.emptyDEMTexture,S.activeTexture.set(N.TEXTURE2),re&&(k.u_dem_size=(ne=re).size[0]===1?1:ne.size[0]-2,re.bind(Y(z),N.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,d,k),y&&y.useMeterToDem&&z){const oe=(1<<z.tileID.canonical.z)*i.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=oe}if(y&&y.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),d.setTerrainUniformValues(S,k),this.painter.transform.projection.name==="globe"){const oe=this.globeUniformValues(this.painter.transform,o.tileID.canonical,y&&y.useDenormalizedUpVectorScale);d.setGlobeUniformValues(S,oe)}}globeUniformValues(o,d,y){const S=o.projection;return{u_tile_tl_up:S.upVector(d,0,0),u_tile_tr_up:S.upVector(d,i.ag,0),u_tile_br_up:S.upVector(d,i.ag,i.ag),u_tile_bl_up:S.upVector(d,0,i.ag),u_tile_up_scale:y?i.cL(1):S.upVectorScale(d,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const d=this.painter,y=this.painter.context;o.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(S,N,k,z,G){if(S.transform.projection.name==="globe")(function(Z,Y,re,ne,oe){const _e=Z.context,me=_e.gl;let we,be;const Ee=Z.transform,$e=i.cC(Z,_e,Ee),Ve=(kt,Et)=>{if(be===Et)return;const dt=[uu[Et],"PROJECTION_GLOBE_VIEW"];$e&&dt.push("CUSTOM_ANTIALIASING");const jt=Z.isTileAffectedByFog(kt);we=Z.getOrCreateProgram("globeRaster",{defines:dt,overrideFog:jt}),be=Et},Qe=Z.colorModeForRenderPass(),We=new Br(me.LEQUAL,Br.ReadWrite,Z.depthRangeFor3D);jo.update(oe);const Ke=i.cD(Ee),Ge=[i.at(Ee.center.lng),i.aA(Ee.center.lat)],Ye=Z.globeSharedBuffers,it=[Ee.width*i.q.devicePixelRatio,Ee.height*i.q.devicePixelRatio],bt=Float32Array.from(Ee.globeMatrix),pt={useDenormalizedUpVectorScale:!0};{const kt=Z.transform,Et=zl(kt.zoom,Y.exaggeration(),Y.sourceCache._source.tileSize);be=-1;const dt=me.TRIANGLES;for(const jt of ne){const Gt=re.getTile(jt),ft=Kr.disabled,Ft=Y.prevTerrainTileForTile[jt.key],Ct=Y.terrainTileForTile[jt.key];gf(Ft,Ct)&&jo.newMorphing(jt.key,Ft,Ct,oe,250),_e.activeTexture.set(me.TEXTURE0),Gt.texture&&Gt.texture.bind(me.LINEAR,me.CLAMP_TO_EDGE);const Qt=jo.getMorphValuesForProxy(jt.key),$t=Qt?1:0;Qt&&i.J(pt,{morphing:{srcDemTile:Qt.from,dstDemTile:Qt.to,phase:i.cB(Qt.phase)}});const zt=i.cE(jt.canonical),Yt=i.cF(zt.getCenter().lat),nr=i.cG(jt.canonical,zt,Yt,kt.worldSize/kt._pixelsPerMercatorPixel),yr=i.bb(i.cH(jt.canonical)),_r=yl(kt.expandedFarZProjMatrix,bt,Ke,yr,i.ae(kt.zoom),Ge,kt.frustumCorners.TL,kt.frustumCorners.TR,kt.frustumCorners.BR,kt.frustumCorners.BL,kt.globeCenterInViewSpace,kt.globeRadius,it,Et,kt._farZ,nr);if(Ve(jt,$t),we&&(Y.setupElevationDraw(Gt,we,pt),Z.uploadCommonUniforms(_e,we,jt.toUnwrapped()),Ye)){const[Wr,Or,Lr]=Ye.getGridBuffers(Yt,Et!==0);we.draw(Z,dt,We,ft,Qe,Yr.backCCW,_r,"globe_raster",Wr,Or,Lr)}}}if(Ye&&(Z.renderDefaultNorthPole||Z.renderDefaultSouthPole)){const kt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];$e&&kt.push("CUSTOM_ANTIALIASING"),we=Z.getOrCreateProgram("globeRaster",{defines:kt});for(const Et of ne){const{x:dt,y:jt,z:Gt}=Et.canonical,ft=jt===0,Ft=jt===(1<<Gt)-1,[Ct,Qt,$t,zt]=Ye.getPoleBuffers(Gt,!1);if(zt&&(ft||Ft)){const Yt=re.getTile(Et);_e.activeTexture.set(me.TEXTURE0),Yt.texture&&Yt.texture.bind(me.LINEAR,me.CLAMP_TO_EDGE);let nr=i.cI(Gt,dt,Ee);const yr=i.bb(i.cH(Et.canonical)),_r=(Wr,Or)=>Wr.draw(Z,me.TRIANGLES,We,Kr.disabled,Qe,Yr.disabled,yl(Ee.expandedFarZProjMatrix,nr,nr,yr,0,Ge,Ee.frustumCorners.TL,Ee.frustumCorners.TR,Ee.frustumCorners.BR,Ee.frustumCorners.BL,Ee.globeCenterInViewSpace,Ee.globeRadius,it,0,Ee._farZ),"globe_pole_raster",Or,$t,zt);Y.setupElevationDraw(Yt,we,pt),Z.uploadCommonUniforms(_e,we,Et.toUnwrapped()),ft&&Z.renderDefaultNorthPole&&_r(we,Ct),Ft&&Z.renderDefaultSouthPole&&(nr=i.ab.mat4.scale(i.ab.mat4.create(),nr,[1,-1,1]),_r(we,Qt))}}}})(S,N,k,z,G);else{const Z=S.context,Y=Z.gl;let re,ne;const oe=S.shadowRenderer,_e=Il(S,S.longestCutoffRange),me=Qe=>{if(ne===Qe)return;const We=[];We.push(uu[Qe]),_e.shouldRenderCutoff&&We.push("RENDER_CUTOFF"),oe&&(We.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&We.push("NORMAL_OFFSET")),re=S.getOrCreateProgram("terrainRaster",{defines:We}),ne=Qe},we=S.colorModeForRenderPass(),be=new Br(Y.LEQUAL,Br.ReadWrite,S.depthRangeFor3D);jo.update(G);const Ee=S.transform,$e=zl(Ee.zoom,N.exaggeration(),N.sourceCache._source.tileSize);let Ve=[0,0,0];if(oe){const Qe=S.style.directionalLight,We=S.style.ambientLight;Qe&&We&&(Ve=Ap(S.style,Qe,We))}{ne=-1;const Qe=Y.TRIANGLES,[We,Ke]=[N.gridIndexBuffer,N.gridSegments];for(const Ge of z){const Ye=k.getTile(Ge),it=Kr.disabled,bt=N.prevTerrainTileForTile[Ge.key],pt=N.terrainTileForTile[Ge.key];gf(bt,pt)&&jo.newMorphing(Ge.key,bt,pt,G,250),Z.activeTexture.set(Y.TEXTURE0),Ye.texture&&Ye.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const kt=jo.getMorphValuesForProxy(Ge.key),Et=kt?1:0;let dt;kt&&(dt={morphing:{srcDemTile:kt.from,dstDemTile:kt.to,phase:i.cB(kt.phase)}});const jt=rh(Ge.projMatrix,ga(Ge.canonical,Ee.renderWorldCopies)?$e/10:$e,Ve);if(me(Et),!re)continue;N.setupElevationDraw(Ye,re,dt);const Gt=Ge.toUnwrapped();oe&&oe.setupShadows(Gt,re),S.uploadCommonUniforms(Z,re,Gt,null,_e),re.draw(S,Qe,be,it,we,Yr.backCCW,jt,"terrain_raster",N.gridBuffer,We,Ke)}}}}(d,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const d=this.painter,y=this.painter.context,S=this.proxySourceCache,N=this.proxiedCoords[S.id],k=this._drapedRenderBatches.shift(),z=d.style.order,G=[];let Z=0;for(const Y of N){const re=S.getTileByID(Y.proxyTileKey),ne=S.proxyCachedFBO[Y.key]?S.proxyCachedFBO[Y.key][o]:void 0,oe=ne!==void 0?S.renderCache[ne]:this.pool[Z++],_e=ne!==void 0;if(re.texture=oe.tex,_e&&!oe.dirty){G.push(re.tileID);continue}let me;y.bindFramebuffer.set(oe.fb.framebuffer),this.renderedToTile=!1,oe.dirty&&(y.clear({color:i.aj.transparent,stencil:0}),oe.dirty=!1);for(let we=k.start;we<=k.end;++we){const be=d.style._mergedLayers[z[we]];if(be.isHidden(d.transform.zoom))continue;const Ee=d.style.getLayerSourceCache(be),$e=Ee?this.proxyToSource[Y.key][Ee.id]:[Y];if(!$e)continue;const Ve=$e;y.viewport.set([0,0,oe.fb.width,oe.fb.height]),me!==(Ee?Ee.id:null)&&(this._setupStencil(oe,$e,be,Ee),me=Ee?Ee.id:null),d.renderLayer(d,Ee,be,Ve)}if(this._drapedRenderBatches.length===0)for(const we of this._pendingGroundEffectLayers){const be=d.style._mergedLayers[z[we]];if(be.isHidden(d.transform.zoom))continue;const Ee=d.style.getLayerSourceCache(be),$e=Ee?this.proxyToSource[Y.key][Ee.id]:[Y];if(!$e)continue;const Ve=$e;y.viewport.set([0,0,oe.fb.width,oe.fb.height]),me!==(Ee?Ee.id:null)&&(this._setupStencil(oe,$e,be,Ee),me=Ee?Ee.id:null),d.renderLayer(d,Ee,be,Ve)}this.renderedToTile?(oe.dirty=!0,G.push(re.tileID)):_e||--Z,Z===5&&(Z=0,this.renderToBackBuffer(G))}return this.renderToBackBuffer(G),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,d.width,d.height]),k.end+1}postRender(){}isLayerOrderingCorrect(o){const d=o.order.length;let y=-1,S=d;for(let N=0;N<d;++N)this._style.isLayerDraped(o._mergedLayers[o.order[N]])?y=Math.max(y,N):S=Math.min(S,N);return S>y}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{o=Math.min(o,d.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,d,y){if(!this._visibleDemTiles)return null;const S=this._visibleDemTiles.filter(N=>N.dem).map(N=>{const k=N.tileID,z=1<<k.overscaledZ,{x:G,y:Z}=k.canonical,Y=G/z,re=(G+1)/z,ne=Z/z,oe=(Z+1)/z;return{minx:Y,miny:ne,maxx:re,maxy:oe,t:N.dem.tree.raycastRoot(Y,ne,re,oe,o,d,y),tile:N}});S.sort((N,k)=>(N.t!==null?N.t:Number.MAX_VALUE)-(k.t!==null?k.t:Number.MAX_VALUE));for(const N of S){if(N.t==null)return null;const k=N.tile.dem.tree.raycast(N.minx,N.miny,N.maxx,N.maxy,o,d,y);if(k!=null)return k}return null}_createFBO(){const o=this.painter.context,d=o.gl,y=this.drapeBufferSize;o.activeTexture.set(d.TEXTURE0);const S=new i.T(o,{width:y[0],height:y[1],data:null},d.RGBA8);S.bind(d.LINEAR,d.CLAMP_TO_EDGE);const N=o.createFramebuffer(y[0],y[1],!0,null);return N.colorAttachment.set(S.texture),N.depthAttachment=new id(o,N.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,N.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):N.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:N,tex:S,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const d=this._style._mergedLayers[o],y=d.isHidden(this.painter.transform.zoom);return d.type==="hillshade"||d.type==="custom"?!y&&d.shouldRedrape():!y&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const y of this._style.getSources())if(y instanceof ja){o=!0;break}if(!o)return;const d={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],N=this._style.getLayerSourceCache(S);if(N&&!d[N.id]&&!S.isHidden(this.painter.transform.zoom)&&S.type==="line"&&S.widthExpression()instanceof i.a9){d[N.id]=!0;for(const k of this.proxyCoords){const z=this.proxyToSource[k.key][N.id];if(z)for(const G of z)this._clearRenderCacheForTile(N.id,G)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof gs){o=!0;break}if(!o)return;const d={};for(let y=0;y<this._style.order.length;++y){const S=this._style._mergedLayers[this._style.order[y]],N=this._style.getLayerSourceCache(S);if(!N||d[N.id]||S.isHidden(this.painter.transform.zoom)||S.type!=="raster")continue;const k=S.paint.get("raster-fade-duration");for(const z of this.proxyCoords){const G=this.proxyToSource[z.key][N.id];if(G)for(const Z of G){const Y=Fl(N.getTile(Z),N.findLoadedParent(Z,0),N,this.painter.transform,k);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(N.id,Z)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,d=o.length;if(d===0)return;const y=[];this._pendingGroundEffectLayers=[];let S,N=0,k=this._style._mergedLayers[o[N]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++N<d;)k=this._style._mergedLayers[o[N]];for(;N<d;++N){const z=this._style._mergedLayers[o[N]];z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(z)?S===void 0&&(S=N):(z.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(N),S!==void 0&&(y.push({start:S,end:N-1}),S=void 0)))}if(S!==void 0&&y.push({start:S,end:N-1}),y.length!==0){const z=y[y.length-1];this._pendingGroundEffectLayers.every(G=>G>z.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(o){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const k=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let z=0;z<k.length;++z){const G=Object.values(k[z]);d.renderCachePool.push(...G)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,S=this._tilesDirty;for(let k=y.length-1;k>=0;k--){const z=y[k];if(d.getTileByID(z.key),d.proxyCachedFBO[z.key]!==void 0){const G=o[z.key],Z=this.proxyToSource[z.key];let Y=0;for(const re in Z){const ne=Z[re],oe=G[re];if(!oe||oe.length!==ne.length||ne.some((_e,me)=>_e!==oe[me]||S[re]&&S[re].hasOwnProperty(_e.key))){Y=-1;break}++Y}for(const re in d.proxyCachedFBO[z.key])d.renderCache[d.proxyCachedFBO[z.key][re]].dirty=Y<0||Y!==Object.values(G).length}}const N=[...this._drapedRenderBatches];N.sort((k,z)=>z.end-z.start-(k.end-k.start));for(const k of N)for(const z of y){if(d.proxyCachedFBO[z.key])continue;let G=d.renderCachePool.pop();G===void 0&&d.renderCache.length<50&&(G=d.renderCache.length,d.renderCache.push(this._createFBO())),G!==void 0&&(d.proxyCachedFBO[z.key]={},d.proxyCachedFBO[z.key][k.start]=G,d.renderCache[G].dirty=!0)}this._tilesDirty={}}_setupStencil(o,d,y,S){if(!S||!this._sourceTilesOverlap[S.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const N=this.painter.context,k=N.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let z;if(y.isTileClipped())z=d.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);z=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+z>255&&(N.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=z,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):Kr.disabled}_renderTileClippingMasks(o,d){const y=this.painter,S=this.painter.context,N=S.gl;y._tileClippingMaskIDs={},S.setColorMode(An.disabled),S.setDepthMode(Br.disabled);const k=y.getOrCreateProgram("clippingMask");for(const z of o){const G=y._tileClippingMaskIDs[z.key]=--d;k.draw(y,N.TRIANGLES,Br.disabled,new Kr({func:N.ALWAYS,mask:0},G,255,N.KEEP,N.KEEP,N.REPLACE),An.disabled,Yr.disabled,Qi(z.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(o){const d=this.painter.transform;if(o.x<0||o.x>d.width||o.y<0||o.y>d.height)return null;const y=[o.x,o.y,1,1];i.ab.vec4.transformMat4(y,y,d.pixelMatrixInverse),i.ab.vec4.scale(y,y,1/y[3]),y[0]/=d.worldSize,y[1]/=d.worldSize;const S=d._camera.position,N=i.bH(1,d.center.lat),k=[S[0],S[1],S[2]/N,0],z=i.ab.vec3.subtract([],y.slice(0,3),k);i.ab.vec3.normalize(z,z);const G=this.raycast(k,z,this._exaggeration);return G!==null&&G?(i.ab.vec3.scaleAndAdd(k,k,z,G),k[3]=k[2],k[2]*=N,k):null}_setupProxiedCoordsForOrtho(o,d,y){if(o.getSource()instanceof i.aJ)return this._setupProxiedCoordsForImageSource(o,d,y);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const S=this.proxiedCoords[o.id]=[],N=this.proxyCoords;for(let G=0;G<N.length;G++){const Z=N[G],Y=this._findTileCoveringTileID(Z,o);if(Y){const re=this._createProxiedId(Z,Y,y[Z.key]&&y[Z.key][o.id]);S.push(re),this.proxyToSource[Z.key][o.id]=[re]}}let k=!1;const z=new Set;for(let G=0;G<d.length;G++){const Z=o.getTile(d[G]);if(!Z||!Z.hasData())continue;const Y=this._findTileCoveringTileID(Z.tileID,this.proxySourceCache);if(Y&&Y.tileID.canonical.z!==Z.tileID.canonical.z){const re=this.proxyToSource[Y.tileID.key][o.id],ne=this._createProxiedId(Y.tileID,Z,y[Y.tileID.key]&&y[Y.tileID.key][o.id]);re?re.splice(re.length-1,0,ne):this.proxyToSource[Y.tileID.key][o.id]=[ne];const oe=this.proxyToSource[Y.tileID.key][o.id];z.has(oe)||z.add(oe),S.push(ne),k=!0}}if(this._sourceTilesOverlap[o.id]=k,k&&this._debugParams.sortTilesHiZFirst)for(const G of z)G.sort((Z,Y)=>Y.overscaledZ-Z.overscaledZ)}_setupProxiedCoordsForImageSource(o,d,y){if(!o.getSource().loaded())return;const S=this.proxiedCoords[o.id]=[],N=this.proxyCoords,k=o.getSource(),z=k.tileID;if(!z)return;const G=new i.P(z.x,z.y)._div(1<<z.z),Z=k.coordinates.map(i.aa.fromLngLat).reduce((re,ne)=>(re.min.x=Math.min(re.min.x,ne.x-G.x),re.min.y=Math.min(re.min.y,ne.y-G.y),re.max.x=Math.max(re.max.x,ne.x-G.x),re.max.y=Math.max(re.max.y,ne.y-G.y),re),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),Y=(re,ne)=>{const oe=re.wrap+re.canonical.x/(1<<re.canonical.z),_e=re.canonical.y/(1<<re.canonical.z),me=i.ag/(1<<re.canonical.z),we=ne.wrap+ne.canonical.x/(1<<ne.canonical.z),be=ne.canonical.y/(1<<ne.canonical.z);return oe+me<we+Z.min.x||oe>we+Z.max.x||_e+me<be+Z.min.y||_e>be+Z.max.y};for(let re=0;re<N.length;re++){const ne=N[re];for(let oe=0;oe<d.length;oe++){const _e=o.getTile(d[oe]);if(!_e||!_e.hasData()||Y(ne,_e.tileID))continue;const me=this._createProxiedId(ne,_e,y[ne.key]&&y[ne.key][o.id]),we=this.proxyToSource[ne.key][o.id];we?we.push(me):this.proxyToSource[ne.key][o.id]=[me],S.push(me)}}}_createProxiedId(o,d,y){let S=this.orthoMatrix;if(y){const N=y.find(k=>k.key===d.tileID.key);if(N)return N}if(d.tileID.key!==o.key){const N=o.canonical.z-d.tileID.canonical.z;let k,z,G;S=i.ab.mat4.create();const Z=d.tileID.wrap-o.wrap<<o.overscaledZ;N>0?(k=i.ag>>N,z=k*((d.tileID.canonical.x<<N)-o.canonical.x+Z),G=k*((d.tileID.canonical.y<<N)-o.canonical.y)):(k=i.ag<<-N,z=i.ag*(d.tileID.canonical.x-(o.canonical.x+Z<<-N)),G=i.ag*(d.tileID.canonical.y-(o.canonical.y<<-N))),i.ab.mat4.ortho(S,0,k,0,k,0,1),i.ab.mat4.translate(S,S,[z,G,0])}return new du(d.tileID,o.key,S)}_findTileCoveringTileID(o,d){let y=d.getTile(o);if(y&&y.hasData())return y;const S=this._findCoveringTileCache[d.id],N=S[o.key];if(y=N?d.getTileByID(N):null,y&&y.hasData()||N===null)return y;let k=y?y.tileID:o,z=k.overscaledZ;const G=d.getSource().minzoom,Z=[];if(!N){const re=d.getSource().maxzoom;if(o.canonical.z>=re){const ne=o.canonical.z-re;d.getSource().reparseOverscaled?(z=Math.max(o.canonical.z+2,d.transform.tileZoom),k=new i.aG(z,o.wrap,re,o.canonical.x>>ne,o.canonical.y>>ne)):ne!==0&&(z=re,k=new i.aG(z,o.wrap,re,o.canonical.x>>ne,o.canonical.y>>ne))}k.key!==o.key&&(Z.push(k.key),y=d.getTile(k))}const Y=re=>{Z.forEach(ne=>{S[ne]=re}),Z.length=0};for(z-=1;z>=G&&(!y||!y.hasData());z--){y&&Y(y.tileID.key);const re=k.calculateScaledKey(z);if(y=d.getTileByID(re),y&&y.hasData())break;const ne=S[re];if(ne===null)break;ne===void 0?Z.push(re):y=d.getTileByID(ne)}return Y(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,d){let y=this._tilesDirty[o];y||(y=this._tilesDirty[o]={}),y[d.key]=!0}}function Yo(g,o,d){const y=function(z,G,Z){const Y=i.ab.vec3.dot(G,z),re=i.ab.vec3.dot(Z,[.2126,.7152,.0722]),ne=(_e,me,we)=>(1-we)*_e+we*me,oe=ne(1-.3*Math.min(re,1),1,Math.min(Y+1,1));return ne(.92,1,Math.asin(i.aw(G[2],-1,1))/Math.PI+.5)*oe}(g,[0,0,1],o),S=[0,0,0];i.ab.vec3.scale(S,d.slice(0,3),y);const N=[0,0,0];i.ab.vec3.scale(N,o.slice(0,3),g[2]);const k=[0,0,0];return i.ab.vec3.add(k,S,N),i.cf(k)}const Jm=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],My=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Oy{static cacheKey(o,d,y,S){let N=`${d}${S?S.cacheKey:""}`;for(const k of y)o.usedDefines.includes(k)&&(N+=`/${k}`);return N}constructor(o,d,y,S,N,k){const z=o.gl;this.program=z.createProgram(),this.configuration=S,this.name=d,this.fixedDefines=[...k];const G=S?S.getBinderAttributes():[],Z=(y.staticAttributes||[]).concat(G);let Y=S?S.defines():[];Y=Y.concat(k.map(we=>`#define ${we}`));const re=`#version 300 es
`;let ne=re+Y.concat("precision mediump float;",df,jp.fragmentSource).join(`
`);for(const we of y.fragmentIncludes)ne+=`
${Yd[we]}`;ne+=`
${y.fragmentSource}`;let oe=re+Y.concat("precision highp float;",df,jp.vertexSource).join(`
`);for(const we of y.vertexIncludes)oe+=`
${Yd[we]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(oe+=`
uniform int u_instanceID;
`),oe+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(oe=oe.replaceAll("gl_InstanceID","u_instanceID"));const _e=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);z.shaderSource(_e,ne),z.compileShader(_e),z.attachShader(this.program,_e);const me=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())this.failedToCreate=!0;else{z.shaderSource(me,oe),z.compileShader(me),z.attachShader(this.program,me),this.attributes={},this.numAttributes=Z.length;for(let we=0;we<this.numAttributes;we++)if(Z[we]){const be=Z[we].startsWith("a_")?Z[we]:`a_${Z[we]}`;z.bindAttribLocation(this.program,we,be),this.attributes[be]=we}z.linkProgram(this.program),z.deleteShader(me),z.deleteShader(_e),this.fixedUniforms=N(o),this.binderUniforms=S?S.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(we=>({u_instanceID:new i.bN(we)}))(o)),(k.includes("TERRAIN")||d.indexOf("symbol")!==-1||d.indexOf("circle")!==-1)&&(this.terrainUniforms=(we=>({u_dem:new i.bN(we),u_dem_prev:new i.bN(we),u_dem_tl:new i.bK(we),u_dem_scale:new i.bM(we),u_dem_tl_prev:new i.bK(we),u_dem_scale_prev:new i.bM(we),u_dem_size:new i.bM(we),u_dem_lerp:new i.bM(we),u_exaggeration:new i.bM(we),u_depth:new i.bN(we),u_depth_size_inv:new i.bK(we),u_depth_range_unpack:new i.bK(we),u_occluder_half_size:new i.bM(we),u_occlusion_depth_offset:new i.bM(we),u_meter_to_dem:new i.bM(we),u_label_plane_matrix_inv:new i.bJ(we)}))(o)),k.includes("GLOBE")&&(this.globeUniforms=(we=>({u_tile_tl_up:new i.bL(we),u_tile_tr_up:new i.bL(we),u_tile_br_up:new i.bL(we),u_tile_bl_up:new i.bL(we),u_tile_up_scale:new i.bM(we)}))(o)),k.includes("FOG")&&(this.fogUniforms=(we=>({u_fog_matrix:new i.bJ(we),u_fog_range:new i.bK(we),u_fog_color:new i.ca(we),u_fog_horizon_blend:new i.bM(we),u_fog_vertical_limit:new i.bK(we),u_fog_temporal_offset:new i.bM(we),u_frustum_tl:new i.bL(we),u_frustum_tr:new i.bL(we),u_frustum_br:new i.bL(we),u_frustum_bl:new i.bL(we),u_globe_pos:new i.bL(we),u_globe_radius:new i.bM(we),u_globe_transition:new i.bM(we),u_is_globe:new i.bN(we),u_viewport:new i.bK(we)}))(o)),k.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(we=>({u_cutoff_params:new i.ca(we)}))(o)),k.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(we=>({u_lighting_ambient_color:new i.bL(we),u_lighting_directional_dir:new i.bL(we),u_lighting_directional_color:new i.bL(we),u_ground_radiance:new i.bL(we)}))(o)),k.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(we=>({u_light_matrix_0:new i.bJ(we),u_light_matrix_1:new i.bJ(we),u_fade_range:new i.bK(we),u_shadow_normal_offset:new i.bL(we),u_shadow_intensity:new i.bM(we),u_shadow_texel_size:new i.bM(we),u_shadow_map_resolution:new i.bM(we),u_shadow_direction:new i.bL(we),u_shadow_bias:new i.bL(we),u_shadowmap_0:new i.bN(we),u_shadowmap_1:new i.bN(we)}))(o))}}setTerrainUniformValues(o,d){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S]&&y[S].set(this.program,S,d[S])}}setGlobeUniformValues(o,d){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S]&&y[S].set(this.program,S,d[S])}}setFogUniformValues(o,d){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}}setCutoffUniformValues(o,d){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}}setLightsUniformValues(o,d){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}}setShadowUniformValues(o,d){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;o.program.set(this.program);for(const S in d)y[S].set(this.program,S,d[S])}_drawDebugWireframe(o,d,y,S,N,k,z,G,Z,Y){const re=o.options.wireframe;if(re.terrain===!1&&re.layers2D===!1&&re.layers3D===!1)return;const ne=o.context;if(!(!(!re.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!re.layers2D||o._terrain&&o._terrain.renderingToTexture||!Jm.includes(this.name))||!(!re.layers3D||!My.includes(this.name))))return;const oe=ne.gl,_e=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,N,ne);if(!_e)return;const me=[...this.fixedDefines];me.push("DEBUG_WIREFRAME");const we=o.getOrCreateProgram(this.name,{config:this.configuration,defines:me});ne.program.set(we.program);const be=(Ve,Qe,We)=>{if(Qe[Ve]&&We[Ve])for(const Ke in Qe[Ve])We[Ve][Ke]&&We[Ve][Ke].set(We.program,Ke,Qe[Ve][Ke].current)};Z&&Z.setUniforms(we.program,ne,we.binderUniforms,z,{zoom:G}),be("fixedUniforms",this,we),be("terrainUniforms",this,we),be("globeUniforms",this,we),be("fogUniforms",this,we),be("lightsUniforms",this,we),be("shadowUniforms",this,we),_e.bind(),ne.setColorMode(new An([oe.ONE,oe.ONE_MINUS_SRC_ALPHA,oe.ZERO,oe.ONE],i.aj.transparent,[!0,!0,!0,!1])),ne.setDepthMode(new Br(d.func===oe.LESS?oe.LEQUAL:d.func,Br.ReadOnly,d.range)),ne.setStencilMode(Kr.disabled);const Ee=3*k.primitiveLength*2,$e=3*k.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Ve=Y||1;for(let Qe=0;Qe<Ve;++Qe)we.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Qe),oe.drawElements(oe.LINES,Ee,oe.UNSIGNED_SHORT,$e)}else Y&&Y>1?oe.drawElementsInstanced(oe.LINES,Ee,oe.UNSIGNED_SHORT,$e,Y):oe.drawElements(oe.LINES,Ee,oe.UNSIGNED_SHORT,$e);N.bind(),ne.program.set(this.program),ne.setDepthMode(d),ne.setStencilMode(y),ne.setColorMode(S)}checkUniforms(o,d,y){if(this.fixedDefines.includes(d)){for(const S of Object.keys(y))if(!y[S].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${S} not set but required by ${d} being defined`)}}draw(o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we){const be=o.context,Ee=be.gl;if(this.failedToCreate)return;be.program.set(this.program),be.setDepthMode(y),be.setStencilMode(S),be.setColorMode(N),be.setCullFace(k);for(const Qe of Object.keys(this.fixedUniforms))this.fixedUniforms[Qe].set(this.program,Qe,z[Qe]);_e&&_e.setUniforms(this.program,be,this.binderUniforms,ne,{zoom:oe});const $e={[Ee.POINTS]:1,[Ee.LINES]:2,[Ee.TRIANGLES]:3,[Ee.LINE_STRIP]:1}[d];this.checkUniforms(G,"RENDER_SHADOWS",this.shadowUniforms);const Ve=we&&we>0?1:void 0;for(const Qe of re.get()){const We=Qe.vaos||(Qe.vaos={});if((We[G]||(We[G]=new qm)).bind(be,this,Z,_e?_e.getPaintVertexBuffers():[],Y,Qe.vertexOffset,me||[],Ve),this.forceManualRenderingForInstanceIDShaders){const Ke=we||1;for(let Ge=0;Ge<Ke;++Ge)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ge),Y?Ee.drawElements(d,Qe.primitiveLength*$e,Ee.UNSIGNED_SHORT,Qe.primitiveOffset*$e*2):Ee.drawArrays(d,Qe.vertexOffset,Qe.vertexLength)}else we&&we>1?Ee.drawElementsInstanced(d,Qe.primitiveLength*$e,Ee.UNSIGNED_SHORT,Qe.primitiveOffset*$e*2,we):Y?Ee.drawElements(d,Qe.primitiveLength*$e,Ee.UNSIGNED_SHORT,Qe.primitiveOffset*$e*2):Ee.drawArrays(d,Qe.vertexOffset,Qe.vertexLength);d===Ee.TRIANGLES&&Y&&this._drawDebugWireframe(o,y,S,N,Y,Qe,ne,oe,_e,we)}}}function nh(g,o){const d=Math.pow(2,o.tileID.overscaledZ),y=o.tileSize*Math.pow(2,g.transform.tileZoom)/d,S=y*(o.tileID.canonical.x+o.tileID.wrap*d),N=y*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ar(o,1,g.transform.tileZoom),u_pixel_coord_upper:[S>>16,N>>16],u_pixel_coord_lower:[65535&S,65535&N]}}const ih={terrain:0,flat:1},Xo=i.ab.mat4.create(),ah=(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be)=>{const Ee=o.style.light,$e=Ee.properties.get("position"),Ve=[$e.x,$e.y,$e.z],Qe=i.ab.mat3.create();Ee.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Qe,-o.transform.angle),i.ab.vec3.transformMat3(Ve,Ve,Qe));const We=Ee.properties.get("color"),Ke=o.transform,Ge={u_matrix:g,u_lightpos:Ve,u_lightintensity:Ee.properties.get("intensity"),u_lightcolor:[We.r,We.g,We.b],u_vertical_gradient:+d,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xo,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:ih[Z],u_base_type:ih[Y],u_ao:S,u_edge_radius:N,u_width_scale:k,u_flood_light_color:_e,u_vertical_scale:me,u_flood_light_intensity:we,u_ground_shadow_factor:be};return Ke.projection.name==="globe"&&(Ge.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],Ge.u_zoom_transition=re,Ge.u_inv_rot_matrix=oe,Ge.u_merc_center=ne,Ge.u_up_dir=Ke.projection.upVector(new i.bT(0,0,0),ne[0]*i.ag,ne[1]*i.ag),Ge.u_height_lift=G),Ge},sh=(g,o,d,y,S,N)=>({u_matrix:g,u_edge_radius:o,u_width_scale:d,u_vertical_scale:y,u_height_type:ih[S],u_base_type:ih[N]}),Ry=(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we)=>{const be=ah(g,o,d,y,S,N,k,z,Z,Y,re,ne,oe,_e,me,we,1,[0,0,0]),Ee={u_height_factor:-Math.pow(2,z.overscaledZ)/G.tileSize/8};return i.l(be,nh(o,G),Ee)},Ip=(g,o)=>({u_matrix:g,u_emissive_strength:o}),Bl=(g,o,d,y)=>i.l(Ip(g,o),nh(d,y)),ad=(g,o,d)=>({u_matrix:g,u_world:d,u_emissive_strength:o}),oh=(g,o,d,y,S)=>i.l(Bl(g,o,d,y),{u_world:S}),Qm=(g,o,d,y)=>{const S=i.ag/d.tileSize;return{u_matrix:g,u_camera_to_center_distance:o.getCameraToCenterDistance(y),u_extrude_scale:[o.pixelsToGLUnits[0]/S,o.pixelsToGLUnits[1]/S]}},Rc=(g,o,d=1)=>({u_matrix:g,u_color:o.toRenderColor(null),u_overlay:0,u_overlay_scale:d}),Co=i.ab.mat4.create(),gr=(g,o,d,y,S,N,k)=>{const z=g.transform,G=z.projection.name==="globe",Z=G?i.cN(z.zoom,o.canonical)*z._pixelsPerMercatorPixel:i.ar(d,1,N),Y={u_matrix:o.projMatrix,u_extrude_scale:Z,u_intensity:k,u_inv_rot_matrix:Co,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(G){Y.u_inv_rot_matrix=y,Y.u_merc_center=S,Y.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],Y.u_zoom_transition=i.ae(z.zoom);const re=S[0]*i.ag,ne=S[1]*i.ag;Y.u_up_dir=z.projection.upVector(new i.bT(0,0,0),re,ne)}return Y};function hu(g,[o,d,y,S],[N,k]){if(N===k)return[0,0,0,0];const z=255*(g-1)/(g*(k-N));return[o*z,d*z,y*z,S*z]}function oc(g,o,[d,y]){return d===y?0:.5/g+(o-d)*(g-1)/(g*(y-d))}const fo=(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be,Ee,$e,Ve)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:N,u_scale_parent:Z,u_fade_t:Y.mix,u_opacity:Y.opacity*re.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:re.paint.get("raster-brightness-min"),u_brightness_high:re.paint.get("raster-brightness-max"),u_saturation_factor:i.cO(re.paint.get("raster-saturation")),u_contrast_factor:i.cP(re.paint.get("raster-contrast")),u_spin_weights:vl(re.paint.get("raster-hue-rotate")),u_perspective_transform:ne,u_raster_elevation:oe,u_zoom_transition:k,u_merc_center:z,u_cutoff_params:G,u_colorization_mix:hu(i.cQ,me,be),u_colorization_offset:oc(i.cQ,we,be),u_color_ramp:_e,u_texture_offset:[$e/(Ee+2*$e),Ee/(Ee+2*$e)],u_texture_res:[Ee+2*$e,Ee+2*$e],u_emissive_strength:Ve});function vl(g){g*=Math.PI/180;const o=Math.sin(g),d=Math.cos(g);return[(2*d+1)/3,(-Math.sqrt(3)*o-d+1)/3,(Math.sqrt(3)*o-d+1)/3]}const Er=.05,Dp=(g,o,d,y,S,N,k,z,G,Z,Y,re)=>({u_matrix:g,u_normalize_matrix:o,u_globe_matrix:d,u_merc_matrix:y,u_grid_matrix:S,u_tl_parent:N,u_scale_parent:Z,u_fade_t:Y.mix,u_opacity:Y.opacity,u_image0:0,u_image1:1,u_raster_elevation:re,u_zoom_transition:k,u_merc_center:z,u_cutoff_params:G}),Iy=(g,o,d,y,S,N,k,z,G,Z)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_tile_offset:d,u_velocity:y,u_color_ramp:N,u_velocity_res:S,u_max_speed:k,u_uv_offset:z,u_data_scale:[255*G[0],255*G[1]],u_data_offset:Z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Er,Er]}),xl=(g,o,d,y,S,N,k,z,G,Z)=>({u_particle_texture:g,u_particle_texture_side_len:o,u_velocity:d,u_velocity_res:y,u_max_speed:S,u_speed_factor:N,u_reset_rate:k,u_rand_seed:Math.random(),u_uv_offset:z,u_data_scale:[255*G[0],255*G[1]],u_data_offset:Z,u_particle_pos_scale:1.1,u_particle_pos_offset:[Er,Er]}),po=i.ab.mat4.create(),ya=(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be,Ee,$e,Ve,Qe)=>{const We=S.transform,Ke={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:We.getCameraToCenterDistance(Ee),u_rotate_symbol:+d,u_aspect_ratio:We.width/We.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:N,u_label_plane_matrix:k,u_coord_matrix:z,u_is_text:+Z,u_elevation_from_sea:G?1:0,u_pitch_with_map:+y,u_texsize:Y,u_texsize_icon:re,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:po,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:po,u_up_vector:[0,-1,0],u_color_adj_mat:$e,u_icon_transition:Ve||0,u_gamma_scale:y?S.transform.getCameraToCenterDistance(Ee)*Math.cos(S.terrain?0:S.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:1,u_scale_factor:Qe||1};return Ee.name==="globe"&&(Ke.u_tile_id=[oe.canonical.x,oe.canonical.y,1<<oe.canonical.z],Ke.u_zoom_transition=_e,Ke.u_inv_rot_matrix=we,Ke.u_merc_center=me,Ke.u_camera_forward=We._camera.forward(),Ke.u_ecef_origin=i.cR(We.globeMatrix,oe.toUnwrapped()),Ke.u_tile_matrix=Float32Array.from(We.globeMatrix),Ke.u_up_vector=be),Ke},_l=(g,o,d,y)=>({u_matrix:g,u_emissive_strength:o,u_opacity:d,u_color:y}),Dy=(g,o,d,y,S,N,k,z,G)=>i.l(function(Z,Y,re,ne,oe,_e){const{width:me,height:we}=ne.imageManager.getPixelSize(Y),be=Math.pow(2,_e.tileID.overscaledZ),Ee=_e.tileSize*Math.pow(2,ne.transform.tileZoom)/be,$e=Ee*(_e.tileID.canonical.x+_e.tileID.wrap*be),Ve=Ee*_e.tileID.canonical.y;return{u_image:0,u_pattern_tl:re.tl,u_pattern_br:re.br,u_texsize:[me,we],u_pattern_size:re.displaySize,u_pattern_units_to_pixels:oe?[ne.transform.width,-1*ne.transform.height]:[1/i.ar(_e,1,ne.transform.tileZoom),1/i.ar(_e,1,ne.transform.tileZoom)],u_pixel_coord_upper:[$e>>16,Ve>>16],u_pixel_coord_lower:[65535&$e,65535&Ve]}}(0,N,k,y,z,G),{u_matrix:g,u_emissive_strength:o,u_opacity:d}),eg=new Float32Array(i.ab.mat4.identity([])),lh=(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe=[0,0,0],_e)=>{const me=S.style.light,we=me.properties.get("position"),be=[-we.x,-we.y,we.z],Ee=i.ab.mat3.create();me.properties.get("anchor")==="viewport"&&(i.ab.mat3.fromRotation(Ee,-S.transform.angle),i.ab.vec3.transformMat3(be,be,Ee));const $e=Y.alphaMode==="MASK",Ve=me.properties.get("color").toRenderColor(null),Qe=ne.paint.get("model-ambient-occlusion-intensity"),We=ne.paint.get("model-color").constantOr(i.aj.white).toRenderColor(null),Ke=ne.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:g,u_lighting_matrix:o,u_normal_matrix:d,u_node_matrix:y||eg,u_lightpos:be,u_lightintensity:me.properties.get("intensity"),u_lightcolor:[Ve.r,Ve.g,Ve.b],u_camera_pos:oe,u_opacity:N,u_baseTextureIsAlpha:0,u_alphaMask:+$e,u_alphaCutoff:Y.alphaCutoff,u_baseColorFactor:[k.r,k.g,k.b,k.a],u_emissiveFactor:[z[0],z[1],z[2],1],u_metallicFactor:G,u_roughnessFactor:Z,u_baseColorTexture:Vs.BaseColor,u_metallicRoughnessTexture:Vs.MetallicRoughness,u_normalTexture:Vs.Normal,u_occlusionTexture:Vs.Occlusion,u_emissionTexture:Vs.Emission,u_lutTexture:Vs.LUT,u_color_mix:[We.r,We.g,We.b,Ke],u_aoIntensity:Qe,u_emissive_strength:re,u_occlusionTextureTransform:_e||[0,0,0,0]}},yf=(g,o=eg,d=eg)=>({u_matrix:g,u_instance:o,u_node_matrix:d}),tg={fillExtrusion:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_opacity:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_flood_light_color:new i.bL(g),u_vertical_scale:new i.bM(g),u_flood_light_intensity:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),fillExtrusionDepth:g=>({u_matrix:new i.bJ(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_vertical_scale:new i.bM(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g)}),fillExtrusionPattern:g=>({u_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_vertical_gradient:new i.bM(g),u_height_factor:new i.bM(g),u_edge_radius:new i.bM(g),u_width_scale:new i.bM(g),u_ao:new i.bK(g),u_height_type:new i.bN(g),u_base_type:new i.bN(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_up_dir:new i.bL(g),u_height_lift:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g),u_opacity:new i.bM(g)}),fillExtrusionGroundEffect:g=>({u_matrix:new i.bJ(g),u_opacity:new i.bM(g),u_ao_pass:new i.bM(g),u_meter_to_tile:new i.bM(g),u_ao:new i.bK(g),u_flood_light_intensity:new i.bM(g),u_flood_light_color:new i.bL(g),u_attenuation:new i.bM(g),u_edge_radius:new i.bM(g),u_fb:new i.bN(g),u_fb_size:new i.bM(g),u_dynamic_offset:new i.bM(g)}),fill:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g)}),fillPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),fillOutline:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g)}),fillOutlinePattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_world:new i.bK(g),u_image:new i.bN(g),u_texsize:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_tile_units_to_pixels:new i.bM(g)}),circle:i.cS,collisionBox:g=>({u_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_extrude_scale:new i.bK(g)}),collisionCircle:g=>({u_matrix:new i.bJ(g),u_inv_matrix:new i.bJ(g),u_camera_to_center_distance:new i.bM(g),u_viewport_size:new i.bK(g)}),debug:g=>({u_color:new i.cz(g),u_matrix:new i.bJ(g),u_overlay:new i.bN(g),u_overlay_scale:new i.bM(g)}),clippingMask:g=>({u_matrix:new i.bJ(g)}),heatmap:g=>({u_extrude_scale:new i.bM(g),u_intensity:new i.bM(g),u_matrix:new i.bJ(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_up_dir:new i.bL(g)}),heatmapTexture:g=>({u_image:new i.bN(g),u_color_ramp:new i.bN(g),u_opacity:new i.bM(g)}),hillshade:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_latrange:new i.bK(g),u_light:new i.bK(g),u_shadow:new i.cz(g),u_highlight:new i.cz(g),u_emissive_strength:new i.bM(g),u_accent:new i.cz(g)}),hillshadePrepare:g=>({u_matrix:new i.bJ(g),u_image:new i.bN(g),u_dimension:new i.bK(g),u_zoom:new i.bM(g)}),line:i.cT,linePattern:i.cU,raster:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_brightness_low:new i.bM(g),u_brightness_high:new i.bM(g),u_saturation_factor:new i.bM(g),u_contrast_factor:new i.bM(g),u_spin_weights:new i.bL(g),u_perspective_transform:new i.bK(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g),u_colorization_mix:new i.ca(g),u_colorization_offset:new i.bM(g),u_color_ramp:new i.bN(g),u_texture_offset:new i.bK(g),u_texture_res:new i.bK(g),u_emissive_strength:new i.bM(g)}),rasterParticle:g=>({u_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_grid_matrix:new i.cA(g),u_tl_parent:new i.bK(g),u_scale_parent:new i.bM(g),u_fade_t:new i.bM(g),u_opacity:new i.bM(g),u_image0:new i.bN(g),u_image1:new i.bN(g),u_raster_elevation:new i.bM(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_cutoff_params:new i.ca(g)}),rasterParticleTexture:g=>({u_texture:new i.bN(g),u_opacity:new i.bM(g)}),rasterParticleDraw:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_tile_offset:new i.bK(g),u_velocity:new i.bN(g),u_color_ramp:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),rasterParticleUpdate:g=>({u_particle_texture:new i.bN(g),u_particle_texture_side_len:new i.bM(g),u_velocity:new i.bN(g),u_velocity_res:new i.bK(g),u_max_speed:new i.bM(g),u_speed_factor:new i.bM(g),u_reset_rate:new i.bM(g),u_rand_seed:new i.bM(g),u_uv_offset:new i.bK(g),u_data_scale:new i.bK(g),u_data_offset:new i.bM(g),u_particle_pos_scale:new i.bM(g),u_particle_pos_offset:new i.bK(g)}),symbol:g=>({u_is_size_zoom_constant:new i.bN(g),u_is_size_feature_constant:new i.bN(g),u_size_t:new i.bM(g),u_size:new i.bM(g),u_camera_to_center_distance:new i.bM(g),u_rotate_symbol:new i.bN(g),u_aspect_ratio:new i.bM(g),u_fade_change:new i.bM(g),u_matrix:new i.bJ(g),u_label_plane_matrix:new i.bJ(g),u_coord_matrix:new i.bJ(g),u_is_text:new i.bN(g),u_elevation_from_sea:new i.bN(g),u_pitch_with_map:new i.bN(g),u_texsize:new i.bK(g),u_texsize_icon:new i.bK(g),u_texture:new i.bN(g),u_texture_icon:new i.bN(g),u_gamma_scale:new i.bM(g),u_device_pixel_ratio:new i.bM(g),u_tile_id:new i.bL(g),u_zoom_transition:new i.bM(g),u_inv_rot_matrix:new i.bJ(g),u_merc_center:new i.bK(g),u_camera_forward:new i.bL(g),u_tile_matrix:new i.bJ(g),u_up_vector:new i.bL(g),u_ecef_origin:new i.bL(g),u_is_halo:new i.bN(g),u_icon_transition:new i.bM(g),u_color_adj_mat:new i.bJ(g),u_scale_factor:new i.bM(g)}),background:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_color:new i.cz(g)}),backgroundPattern:g=>({u_matrix:new i.bJ(g),u_emissive_strength:new i.bM(g),u_opacity:new i.bM(g),u_image:new i.bN(g),u_pattern_tl:new i.bK(g),u_pattern_br:new i.bK(g),u_texsize:new i.bK(g),u_pattern_size:new i.bK(g),u_pixel_coord_upper:new i.bK(g),u_pixel_coord_lower:new i.bK(g),u_pattern_units_to_pixels:new i.bK(g)}),terrainRaster:g=>({u_matrix:new i.bJ(g),u_image0:new i.bN(g),u_skirt_height:new i.bM(g),u_ground_shadow_factor:new i.bL(g)}),skybox:g=>({u_matrix:new i.bJ(g),u_sun_direction:new i.bL(g),u_cubemap:new i.bN(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxGradient:g=>({u_matrix:new i.bJ(g),u_color_ramp:new i.bN(g),u_center_direction:new i.bL(g),u_radius:new i.bM(g),u_opacity:new i.bM(g),u_temporal_offset:new i.bM(g)}),skyboxCapture:g=>({u_matrix_3f:new i.cA(g),u_sun_direction:new i.bL(g),u_sun_intensity:new i.bM(g),u_color_tint_r:new i.ca(g),u_color_tint_m:new i.ca(g),u_luminance:new i.bM(g)}),globeRaster:g=>({u_proj_matrix:new i.bJ(g),u_globe_matrix:new i.bJ(g),u_normalize_matrix:new i.bJ(g),u_merc_matrix:new i.bJ(g),u_zoom_transition:new i.bM(g),u_merc_center:new i.bK(g),u_image0:new i.bN(g),u_grid_matrix:new i.cA(g),u_skirt_height:new i.bM(g),u_far_z_cutoff:new i.bM(g),u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_globe_pos:new i.bL(g),u_globe_radius:new i.bM(g),u_viewport:new i.bK(g)}),globeAtmosphere:g=>({u_frustum_tl:new i.bL(g),u_frustum_tr:new i.bL(g),u_frustum_br:new i.bL(g),u_frustum_bl:new i.bL(g),u_horizon:new i.bM(g),u_transition:new i.bM(g),u_fadeout_range:new i.bM(g),u_color:new i.ca(g),u_high_color:new i.ca(g),u_space_color:new i.ca(g),u_temporal_offset:new i.bM(g),u_horizon_angle:new i.bM(g)}),model:g=>({u_matrix:new i.bJ(g),u_lighting_matrix:new i.bJ(g),u_normal_matrix:new i.bJ(g),u_node_matrix:new i.bJ(g),u_lightpos:new i.bL(g),u_lightintensity:new i.bM(g),u_lightcolor:new i.bL(g),u_camera_pos:new i.bL(g),u_opacity:new i.bM(g),u_baseColorFactor:new i.ca(g),u_emissiveFactor:new i.ca(g),u_metallicFactor:new i.bM(g),u_roughnessFactor:new i.bM(g),u_baseTextureIsAlpha:new i.bN(g),u_alphaMask:new i.bN(g),u_alphaCutoff:new i.bM(g),u_baseColorTexture:new i.bN(g),u_metallicRoughnessTexture:new i.bN(g),u_normalTexture:new i.bN(g),u_occlusionTexture:new i.bN(g),u_emissionTexture:new i.bN(g),u_lutTexture:new i.bN(g),u_color_mix:new i.ca(g),u_aoIntensity:new i.bM(g),u_emissive_strength:new i.bM(g),u_occlusionTextureTransform:new i.ca(g)}),modelDepth:g=>({u_matrix:new i.bJ(g),u_instance:new i.bJ(g),u_node_matrix:new i.bJ(g)}),groundShadow:g=>({u_matrix:new i.bJ(g),u_ground_shadow_factor:new i.bL(g)}),stars:g=>({u_matrix:new i.bJ(g),u_up:new i.bL(g),u_right:new i.bL(g),u_intensity_multiplier:new i.bM(g)}),snowParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_horizontalOscillationRadius:new i.bM(g),u_horizontalOscillationRate:new i.bM(g),u_boxSize:new i.bM(g),u_billboardSize:new i.bM(g),u_simpleShapeParameters:new i.bK(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_particleColor:new i.ca(g),u_direction:new i.bL(g)}),rainParticle:g=>({u_modelview:new i.bJ(g),u_projection:new i.bJ(g),u_time:new i.bM(g),u_cam_pos:new i.bL(g),u_texScreen:new i.bN(g),u_velocityConeAperture:new i.bM(g),u_velocity:new i.bM(g),u_boxSize:new i.bM(g),u_rainDropletSize:new i.bK(g),u_distortionStrength:new i.bM(g),u_rainDirection:new i.bL(g),u_color:new i.ca(g),u_screenSize:new i.bK(g),u_thinningCenterPos:new i.bK(g),u_thinningShape:new i.bL(g),u_thinningAffectedRatio:new i.bM(g),u_thinningParticleOffset:new i.bM(g),u_shapeDirectionalPower:new i.bM(g),u_shapeNormalPower:new i.bM(g),u_mode:new i.bM(g)}),vignette:g=>({u_vignetteShape:new i.bL(g),u_vignetteColor:new i.ca(g)}),occlusion:g=>({u_matrix:new i.bJ(g),u_anchorPos:new i.bL(g),u_screenSizePx:new i.bK(g),u_occluderSizePx:new i.bK(g),u_color:new i.ca(g)})};class bl{constructor(o,d,y,S){this.id=bl.uniqueIdxCounter,bl.uniqueIdxCounter++,this.context=o;const N=o.gl;this.buffer=N.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),N.bufferData(N.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||S||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=bl.uniqueIdxCounter,bl.uniqueIdxCounter++;const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}bl.uniqueIdxCounter=0;const ko={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wl{constructor(o,d,y,S,N,k){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=S,this.instanceCount=k,this.context=o;const z=o.gl;this.buffer=z.createBuffer(),o.bindVertexBuffer.set(this.buffer),z.bufferData(z.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?z.DYNAMIC_DRAW:z.STATIC_DRAW),this.dynamicDraw||N||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,d){for(let y=0;y<this.attributes.length;y++){const S=d.attributes[this.attributes[y].name];S!==void 0&&o.enableVertexAttribArray(S)}}setVertexAttribPointers(o,d,y){for(let S=0;S<this.attributes.length;S++){const N=this.attributes[S],k=d.attributes[N.name];k!==void 0&&o.vertexAttribPointer(k,N.components,o[ko[N.type]],!1,this.itemSize,N.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(o,d,y){for(let S=0;S<this.attributes.length;S++){const N=d.attributes[this.attributes[S].name];N!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(N,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Lp{constructor(o,d,y,S,N){this.context=o,this.width=d,this.height=y;const k=this.framebuffer=o.gl.createFramebuffer();S&&(this.colorAttachment=new nd(o,k)),N&&(this.depthAttachmentType=N,this.depthAttachment=N==="renderbuffer"?new Ey(o,k):new xv(o,k))}destroy(){const o=this.context.gl;if(this.colorAttachment){const d=this.colorAttachment.get();d&&o.deleteTexture(d)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const d=this.depthAttachment.get();d&&o.deleteRenderbuffer(d)}else{const d=this.depthAttachment.get();d&&o.deleteTexture(d)}o.deleteFramebuffer(this.framebuffer)}}class Ly{constructor(o,d){this.gl=o,this.clearColor=new Gm(this),this.clearDepth=new Wm(this),this.clearStencil=new ca(this),this.colorMask=new kp(this),this.depthMask=new Ep(this),this.stencilMask=new hf(this),this.stencilFunc=new gv(this),this.stencilOp=new Jd(this),this.stencilTest=new cu(this),this.depthRange=new Mp(this),this.depthTest=new Os(this),this.depthFunc=new Hm(this),this.blend=new Km(this),this.blendFunc=new Zm(this),this.blendColor=new Ym(this),this.blendEquation=new ff(this),this.cullFace=new Qd(this),this.cullFaceSide=new Op(this),this.frontFace=new Rp(this),this.program=new pf(this),this.activeTexture=new Xm(this),this.viewport=new yv(this),this.bindFramebuffer=new eh(this),this.bindRenderbuffer=new H_(this),this.bindTexture=new K_(this),this.bindVertexBuffer=new ky(this),this.bindElementBuffer=new rd(this),this.bindVertexArrayOES=new vv(this),this.pixelStoreUnpack=new mf(this),this.pixelStoreUnpackPremultiplyAlpha=new Dl(this),this.pixelStoreUnpackFlipY=new th(this),this.options=d?Object.assign({},d):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=d&&!!d.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,d,y){return new bl(this,o,d,y)}createVertexBuffer(o,d,y,S,N){return new wl(this,o,d,y,S,N)}createRenderbuffer(o,d,y){const S=this.gl,N=S.createRenderbuffer();return this.bindRenderbuffer.set(N),S.renderbufferStorage(S.RENDERBUFFER,o,d,y),this.bindRenderbuffer.set(null),N}createFramebuffer(o,d,y,S){return new Lp(this,o,d,y,S)}clear({color:o,depth:d,stencil:y,colorMask:S}){const N=this.gl;let k=0;o&&(k|=N.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set(S||[!0,!0,!0,!0])),d!==void 0&&(k|=N.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),y!==void 0&&(k|=N.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),N.clear(k)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){i.bn(o.blendFunction,An.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Ic;function ch(g,o,d,y,S,N,k){const z=g.context,G=z.gl,Z=g.transform,Y=g.getOrCreateProgram("collisionBox"),re=[];let ne=0,oe=0;for(let Ve=0;Ve<y.length;Ve++){const Qe=y[Ve],We=o.getTile(Qe),Ke=We.getBucket(d);if(!Ke)continue;const Ge=ic(Qe,Ke,Z);let Ye=Ge;S[0]===0&&S[1]===0||(Ye=g.translatePosMatrix(Ge,We,S,N));const it=k?Ke.textCollisionBox:Ke.iconCollisionBox,bt=Ke.collisionCircleArray;if(bt.length>0){const pt=i.ab.mat4.create(),kt=Ye;i.ab.mat4.mul(pt,Ke.placementInvProjMatrix,Z.glCoordMatrix),i.ab.mat4.mul(pt,pt,Ke.placementViewportMatrix),re.push({circleArray:bt,circleOffset:oe,transform:kt,invTransform:pt,projection:Ke.getProjection()}),ne+=bt.length/4,oe=ne}it&&(g.terrain&&g.terrain.setupElevationDraw(We,Y),Y.draw(g,G.LINES,Br.disabled,Kr.disabled,g.colorModeForRenderPass(),Yr.disabled,Qm(Ye,Z,We,Ke.getProjection()),d.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,null,Z.zoom,null,[it.collisionVertexBuffer,it.collisionVertexBufferExt]))}if(!k||!re.length)return;const _e=g.getOrCreateProgram("collisionCircle"),me=new i.cV;me.resize(4*ne),me._trim();let we=0;for(const Ve of re)for(let Qe=0;Qe<Ve.circleArray.length/4;Qe++){const We=4*Qe,Ke=Ve.circleArray[We+0],Ge=Ve.circleArray[We+1],Ye=Ve.circleArray[We+2],it=Ve.circleArray[We+3];me.emplace(we++,Ke,Ge,Ye,it,0),me.emplace(we++,Ke,Ge,Ye,it,1),me.emplace(we++,Ke,Ge,Ye,it,2),me.emplace(we++,Ke,Ge,Ye,it,3)}(!Ic||Ic.length<2*ne)&&(Ic=function(Ve){const Qe=2*Ve,We=new i.aU;We.resize(Qe),We._trim();for(let Ke=0;Ke<Qe;Ke++){const Ge=6*Ke;We.uint16[Ge+0]=4*Ke+0,We.uint16[Ge+1]=4*Ke+1,We.uint16[Ge+2]=4*Ke+2,We.uint16[Ge+3]=4*Ke+2,We.uint16[Ge+4]=4*Ke+3,We.uint16[Ge+5]=4*Ke+0}return We}(ne));const be=z.createIndexBuffer(Ic,!0),Ee=z.createVertexBuffer(me,i.cW.members,!0);for(const Ve of re){const Qe={u_matrix:Ve.transform,u_inv_matrix:Ve.invTransform,u_camera_to_center_distance:($e=Z).getCameraToCenterDistance(Ve.projection),u_viewport_size:[$e.width,$e.height]};_e.draw(g,G.TRIANGLES,Br.disabled,Kr.disabled,g.colorModeForRenderPass(),Yr.disabled,Qe,d.id,Ee,be,i.b7.simpleSegment(0,2*Ve.circleOffset,Ve.circleArray.length,Ve.circleArray.length/2),null,Z.zoom)}var $e;Ee.destroy(),be.destroy()}const vf=i.ab.mat4.create();function Jo(g){const o=g._camera.getWorldToCamera(g.worldSize,1),d=i.ab.mat4.multiply([],o,g.globeMatrix);i.ab.mat4.invert(d,d);const y=[0,0,0],S=[0,1,0,0];return i.ab.vec4.transformMat4(S,S,d),y[0]=S[0],y[1]=S[1],y[2]=S[2],i.ab.vec3.normalize(y,y),y}function bi({width:g,height:o,anchor:d,textOffset:y,textScale:S},N){const{horizontalAlign:k,verticalAlign:z}=i.bD(d),G=-(k-.5)*g,Z=-(z-.5)*o,Y=i.bC(d,y);return new i.P((G/S+Y[0])*N,(Z/S+Y[1])*N)}function zp(g,o,d,y,S,N,k,z,G,Z,Y){const re=g.text.placedSymbolArray,ne=g.text.dynamicLayoutVertexArray,oe=g.icon.dynamicLayoutVertexArray,_e={},me=g.getProjection(),we=iu(z,me,N),be=N.elevation,Ee=me.upVectorScale(z.canonical,N.center.lat,N.worldSize).metersToTile;ne.clear();for(let $e=0;$e<re.length;$e++){const Ve=re.get($e),{tileAnchorX:Qe,tileAnchorY:We,numGlyphs:Ke}=Ve,Ge=Ve.hidden||!Ve.crossTileID||g.allowVerticalPlacement&&!Ve.placedOrientation?null:y[Ve.crossTileID];if(Ge){let Ye=0,it=0,bt=0;if(be){const Ct=be?be.getAtTileOffset(z,Qe,We):0,[Qt,$t,zt]=me.upVector(z.canonical,Qe,We);Ye=Ct*Qt*Ee,it=Ct*$t*Ee,bt=Ct*zt*Ee}let[pt,kt,Et,dt]=Xs(Ve.projectedAnchorX+Ye,Ve.projectedAnchorY+it,Ve.projectedAnchorZ+bt,d?we:k);const jt=$d(N.getCameraToCenterDistance(me),dt);let Gt=S.evaluateSizeForFeature(g.textSizeData,Z,Ve)*jt/i.bw;d&&(Gt*=g.tilePixelRatio/G);const ft=bi(Ge,Gt);d?({x:pt,y:kt,z:Et}=me.projectTilePoint(Qe+ft.x,We+ft.y,z.canonical),[pt,kt,Et]=Xs(pt+Ye,kt+it,Et+bt,k)):(o&&ft._rotate(-N.angle),pt+=ft.x,kt+=ft.y,Et=0);const Ft=g.allowVerticalPlacement&&Ve.placedOrientation===i.bq.vertical?Math.PI/2:0;for(let Ct=0;Ct<Ke;Ct++)i.bt(ne,pt,kt,Et,Ft);Y&&Ve.associatedIconIndex>=0&&(_e[Ve.associatedIconIndex]={x:pt,y:kt,z:Et,angle:Ft})}else na(Ke,ne)}if(Y){oe.clear();const $e=g.icon.placedSymbolArray;for(let Ve=0;Ve<$e.length;Ve++){const Qe=$e.get(Ve),{numGlyphs:We}=Qe,Ke=_e[Ve];if(Qe.hidden||!Ke)na(We,oe);else{const{x:Ge,y:Ye,z:it,angle:bt}=Ke;for(let pt=0;pt<We;pt++)i.bt(oe,Ge,Ye,it,bt)}}g.icon.dynamicLayoutVertexBuffer.updateData(oe)}g.text.dynamicLayoutVertexBuffer.updateData(ne)}function sd(g,o,d,y,S,N,k={}){const z=d.paint.get("icon-translate"),G=d.paint.get("text-translate"),Z=d.paint.get("icon-translate-anchor"),Y=d.paint.get("text-translate-anchor"),re=d.layout.get("icon-rotation-alignment"),ne=d.layout.get("text-rotation-alignment"),oe=d.layout.get("icon-pitch-alignment"),_e=d.layout.get("text-pitch-alignment"),me=d.layout.get("icon-keep-upright"),we=d.layout.get("text-keep-upright"),be=d.paint.get("icon-color-saturation"),Ee=d.paint.get("icon-color-contrast"),$e=d.paint.get("icon-color-brightness-min"),Ve=d.paint.get("icon-color-brightness-max"),Qe=d.layout.get("symbol-elevation-reference")==="sea",We=g.context,Ke=We.gl,Ge=g.transform,Ye=re==="map",it=ne==="map",bt=oe==="map",pt=_e==="map",kt=d.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Et=!1;const dt=g.depthModeForSublayer(0,Br.ReadOnly),jt=[i.at(Ge.center.lng),i.aA(Ge.center.lat)],Gt=d.layout.get("text-variable-anchor"),ft=Ge.projection.name==="globe",Ft=[],Ct=[0,-1,0];for(const Qt of y){const $t=o.getTile(Qt),zt=$t.getBucket(d);if(!zt||zt.projection.name==="mercator"&&ft||zt.fullyClipped)continue;const Yt=zt.projection.name==="globe",nr=Yt?i.ae(Ge.zoom):0,yr=iu(Qt,zt.getProjection(),Ge),_r=Ge.calculatePixelsToTileUnitsMatrix($t),Wr=Gt&&zt.hasTextData(),Or=zt.hasIconTextFit()&&Wr&&zt.hasIconData(),Lr=zt.getProjection().createInversionMatrix(Ge,Qt.canonical),Zr=ti=>{Ge.depthOcclusionForSymbolsAndCircles&&(d.hasInitialOcclusionOpacityProperties||g.terrain)&&(ti.push("DEPTH_D24"),ti.push("DEPTH_OCCLUSION"))},Dn=()=>{const ti=Ye&&d.layout.get("symbol-placement")!=="point",oi=[];Zr(oi);const ea=ti||Or,aa=d.paint.get("icon-image-cross-fade").constantOr(0);g.terrainRenderModeElevated()&&bt&&oi.push("PITCH_WITH_MAP_TERRAIN"),Yt&&(oi.push("PROJECTION_GLOBE_VIEW"),ea&&oi.push("PROJECTED_POS_ON_VIEWPORT")),aa>0&&oi.push("ICON_TRANSITION"),zt.icon.zOffsetVertexBuffer&&oi.push("Z_OFFSET"),be===0&&Ee===0&&$e===0&&Ve===1||oi.push("COLOR_ADJUSTMENT"),zt.sdfIcons&&oi.push("RENDER_SDF");const Ea=zt.icon.programConfigurations.get(d.id),Sa=g.getOrCreateProgram("symbol",{config:Ea,defines:oi}),Is=$t.imageAtlasTexture?$t.imageAtlasTexture.size:[0,0],Ds=zt.iconSizeData,Mi=i.bp(Ds,Ge.zoom),Ni=bt||Ge.pitch!==0,wi=qa(yr,$t.tileID.canonical,bt,Ye,Ge,zt.getProjection(),_r),zn=_y(yr,$t.tileID.canonical,bt,Ye,Ge,zt.getProjection(),_r),sa=g.translatePosMatrix(zn,$t,z,Z,!0),as=g.translatePosMatrix(yr,$t,z,Z),ji=ea?vf:wi,$s=Ye&&!bt&&!ti;let Al=Ct;!ft&&!Ge.mercatorFromTransition||Ye||(Al=Jo(Ge));const bs=Yt?Al:Ct,Ro=d.getColorAdjustmentMatrix(be,Ee,$e,Ve),Io=ya(Ds.kind,Mi,$s,bt,g,as,ji,sa,Qe,!1,Is,[0,0],!0,Qt,nr,jt,Lr,bs,zt.getProjection(),Ro,aa),Tl=$t.imageAtlasTexture?$t.imageAtlasTexture:null,Oi=d.layout.get("icon-size").constantOr(0)!==1||zt.iconsNeedLinear,wh=zt.sdfIcons||g.options.rotating||g.options.zooming||Oi||Ni?Ke.LINEAR:Ke.NEAREST,dc=zt.sdfIcons&&d.paint.get("icon-halo-width").constantOr(1)!==0,Sh=g.terrain&&bt&&ti?i.ab.mat4.invert(i.ab.mat4.create(),wi):vf;if(ti&&zt.icon){const Of=Ge.elevation,Jp=Of?Of.getAtTileOffsetFunc(Qt,Ge.center.lat,Ge.worldSize,zt.getProjection()):null,vg=pa(yr,$t.tileID.canonical,bt,Ye,Ge,zt.getProjection(),_r);yp(zt,yr,g,!1,vg,zn,bt,me,Jp,Qt)}return{program:Sa,buffers:zt.icon,uniformValues:Io,atlasTexture:Tl,atlasTextureIcon:null,atlasInterpolation:wh,atlasInterpolationIcon:null,isSDF:zt.sdfIcons,hasHalo:dc,tile:$t,labelPlaneMatrixInv:Sh}},hi=()=>{const ti=it&&d.layout.get("symbol-placement")!=="point",oi=[],ea=ti||Gt||Or;g.terrainRenderModeElevated()&&pt&&oi.push("PITCH_WITH_MAP_TERRAIN"),Yt&&(oi.push("PROJECTION_GLOBE_VIEW"),ea&&oi.push("PROJECTED_POS_ON_VIEWPORT")),zt.text.zOffsetVertexBuffer&&oi.push("Z_OFFSET"),zt.iconsInText&&oi.push("RENDER_TEXT_AND_SYMBOL"),oi.push("RENDER_SDF"),Zr(oi);const aa=zt.text.programConfigurations.get(d.id),Ea=g.getOrCreateProgram("symbol",{config:aa,defines:oi});let Sa,Is=[0,0],Ds=null;const Mi=zt.textSizeData;zt.iconsInText&&(Is=$t.imageAtlasTexture?$t.imageAtlasTexture.size:[0,0],Ds=$t.imageAtlasTexture?$t.imageAtlasTexture:null,Sa=pt||Ge.pitch!==0||g.options.rotating||g.options.zooming||Mi.kind==="composite"||Mi.kind==="camera"?Ke.LINEAR:Ke.NEAREST);const Ni=$t.glyphAtlasTexture?$t.glyphAtlasTexture.size:[0,0],wi=d.layout.get("text-size-scale-range"),zn=i.aw(g.scaleFactor,wi[0],wi[1]),sa=i.bp(Mi,Ge.zoom,zn),as=qa(yr,$t.tileID.canonical,pt,it,Ge,zt.getProjection(),_r),ji=_y(yr,$t.tileID.canonical,pt,it,Ge,zt.getProjection(),_r),$s=g.translatePosMatrix(ji,$t,G,Y,!0),Al=g.translatePosMatrix(yr,$t,G,Y),bs=ea?vf:as,Ro=it&&!pt&&!ti;let Io=Ct;!ft&&!Ge.mercatorFromTransition||it||(Io=Jo(Ge));const Tl=ya(Mi.kind,sa,Ro,pt,g,Al,bs,$s,Qe,!0,Ni,Is,!0,Qt,nr,jt,Lr,Yt?Io:Ct,zt.getProjection(),null,null,zn),Oi=$t.glyphAtlasTexture?$t.glyphAtlasTexture:null,wh=Ke.LINEAR,dc=d.paint.get("text-halo-width").constantOr(1)!==0,Sh=g.terrain&&pt&&ti?i.ab.mat4.invert(i.ab.mat4.create(),as):vf;if(ti&&zt.text){const Of=Ge.elevation,Jp=Of?Of.getAtTileOffsetFunc(Qt,Ge.center.lat,Ge.worldSize,zt.getProjection()):null,vg=pa(yr,$t.tileID.canonical,pt,it,Ge,zt.getProjection(),_r);yp(zt,yr,g,!0,vg,ji,pt,we,Jp,Qt)}return{program:Ea,buffers:zt.text,uniformValues:Tl,atlasTexture:Oi,atlasTextureIcon:Ds,atlasInterpolation:wh,atlasInterpolationIcon:Sa,isSDF:!0,hasHalo:dc,tile:$t,labelPlaneMatrixInv:Sh}},Wi=zt.icon.segments.get().length,Yn=zt.text.segments.get().length,Xr=Wi&&!k.onlyText?Dn():null,Sn=Yn&&!k.onlyIcons?hi():null,Sr=d.paint.get("icon-opacity").constantOr(1),In=d.paint.get("text-opacity").constantOr(1);if(kt&&zt.canOverlap){Et=!0;const ti=Sr&&!k.onlyText?zt.icon.segments.get():[],oi=In&&!k.onlyIcons?zt.text.segments.get():[];for(const ea of ti)Ft.push({segments:new i.b7([ea]),sortKey:ea.sortKey,state:Xr});for(const ea of oi)Ft.push({segments:new i.b7([ea]),sortKey:ea.sortKey,state:Sn})}else k.onlyText||Ft.push({segments:Sr?zt.icon.segments:new i.b7([]),sortKey:0,state:Xr}),k.onlyIcons||Ft.push({segments:In?zt.text.segments:new i.b7([]),sortKey:0,state:Sn})}Et&&Ft.sort((Qt,$t)=>Qt.sortKey-$t.sortKey);for(const Qt of Ft){const $t=Qt.state;if($t)if(g.terrain?g.terrain.setupElevationDraw($t.tile,$t.program,{useDepthForOcclusion:Ge.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:$t.labelPlaneMatrixInv}):g.setupDepthForOcclusion(Ge.depthOcclusionForSymbolsAndCircles,$t.program),We.activeTexture.set(Ke.TEXTURE0),$t.atlasTexture&&$t.atlasTexture.bind($t.atlasInterpolation,Ke.CLAMP_TO_EDGE,!0),$t.atlasTextureIcon&&(We.activeTexture.set(Ke.TEXTURE1),$t.atlasTextureIcon&&$t.atlasTextureIcon.bind($t.atlasInterpolationIcon,Ke.CLAMP_TO_EDGE,!0)),g.uploadCommonLightUniforms(g.context,$t.program),$t.hasHalo){const zt=$t.uniformValues;zt.u_is_halo=1,uh($t.buffers,Qt.segments,d,g,$t.program,dt,S,N,zt,2),zt.u_is_halo=0}else{if($t.isSDF){const zt=$t.uniformValues;$t.hasHalo&&(zt.u_is_halo=1,uh($t.buffers,Qt.segments,d,g,$t.program,dt,S,N,zt,1)),zt.u_is_halo=0}uh($t.buffers,Qt.segments,d,g,$t.program,dt,S,N,$t.uniformValues,1)}}}function uh(g,o,d,y,S,N,k,z,G,Z){const Y=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.iconTransitioningVertexBuffer,g.globeExtVertexBuffer,g.zOffsetVertexBuffer];S.draw(y,y.context.gl.TRIANGLES,N,k,z,Yr.disabled,G,d.id,g.layoutVertexBuffer,g.indexBuffer,o,d.paint,y.transform.zoom,g.programConfigurations.get(d.id),Y,Z)}function od(g,o,d,y,S,N,k){const z=g.context.gl,G=d.paint.get("fill-pattern"),Z=d.is3D(),Y=Z?g.stencilModeFor3D():Kr.disabled,re=G&&G.constantOr(1);let ne,oe,_e,me,we;k?(oe=re&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ne=z.LINES):(oe=re?"fillPattern":"fill",ne=z.TRIANGLES);for(const be of y){const Ee=o.getTile(be);if(re&&!Ee.patternsLoaded())continue;const $e=Ee.getBucket(d);if(!$e)continue;g.prepareDrawTile();const Ve=$e.programConfigurations.get(d.id),Qe=g.isTileAffectedByFog(be),We=g.getOrCreateProgram(oe,{config:Ve,overrideFog:Qe});re&&(g.context.activeTexture.set(z.TEXTURE0),Ee.imageAtlasTexture&&Ee.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Ve.updatePaintBuffers());const Ke=G.constantOr(null);if(Ke&&Ee.imageAtlas){const it=Ee.imageAtlas,bt=i.A.from(Ke).getPrimary().scaleSelf(i.q.devicePixelRatio).serialize(),pt=it.patternPositions[bt];pt&&Ve.setConstantPatternPositions(pt)}const Ge=g.translatePosMatrix(be.projMatrix,Ee,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor")),Ye=d.paint.get("fill-emissive-strength");if(k){me=$e.indexBuffer2,we=$e.segments2;const it=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[z.drawingBufferWidth,z.drawingBufferHeight];_e=oe==="fillOutlinePattern"&&re?oh(Ge,Ye,g,Ee,it):ad(Ge,Ye,it)}else me=$e.indexBuffer,we=$e.segments,_e=re?Bl(Ge,Ye,g,Ee):Ip(Ge,Ye);g.uploadCommonUniforms(g.context,We,be.toUnwrapped()),We.draw(g,ne,S,Z?Y:g.stencilModeForClipping(be),N,Yr.disabled,_e,d.id,$e.layoutVertexBuffer,me,we,d.paint,g.transform.zoom,Ve,void 0)}}function dh(g,o,d,y,S,N,k,z){d.resetLayerRenderingStats(g);const G=g.context,Z=G.gl,Y=g.transform,re=d.paint.get("fill-extrusion-pattern"),ne=re.constantOr(1),oe=d.paint.get("fill-extrusion-opacity"),_e=g.style.enable3dLights(),me=d.paint.get(_e&&!ne?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),we=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),me],be=d.layout.get("fill-extrusion-edge-radius"),Ee=be>0&&!d.paint.get("fill-extrusion-rounded-roof"),$e=Ee?0:be,Ve=Y.projection.name==="globe"?i.d3():0,Qe=Y.projection.name==="globe",We=Qe?i.ae(Y.zoom):0,Ke=[i.at(Y.center.lng),i.aA(Y.center.lat)],Ge=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ye=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ge?null:d.lut).toArray01().slice(0,3),it=d.paint.get("fill-extrusion-flood-light-intensity"),bt=d.paint.get("fill-extrusion-vertical-scale"),pt=d.paint.get("fill-extrusion-line-width").constantOr(1)!==0,kt=d.paint.get("fill-extrusion-height-alignment"),Et=d.paint.get("fill-extrusion-base-alignment"),dt=Il(g,d.paint.get("fill-extrusion-cutoff-fade-range")),jt=[];let Gt;Qe&&jt.push("PROJECTION_GLOBE_VIEW"),we[0]>0&&jt.push("FAUX_AO"),Ee&&jt.push("ZERO_ROOF_RADIUS"),z&&jt.push("HAS_CENTROID"),it>0&&jt.push("FLOOD_LIGHT"),dt.shouldRenderCutoff&&jt.push("RENDER_CUTOFF"),pt&&jt.push("RENDER_WALL_MODE");const ft=g.renderPass==="shadow",Ft=g.shadowRenderer,Ct=ft&&!!Ft;g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!0);let Qt=[0,0,0];if(Ft){const Yt=g.style.directionalLight,nr=g.style.ambientLight;Yt&&nr&&(Qt=Ap(g.style,Yt,nr)),ft||(jt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Ft.useNormalOffset&&jt.push("NORMAL_OFFSET")),Gt=jt.concat(["SHADOWS_SINGLE_CASCADE"])}const $t=Ct?"fillExtrusionDepth":ne?"fillExtrusionPattern":"fillExtrusion",zt=d.getLayerRenderingStats();for(const Yt of y){const nr=o.getTile(Yt),yr=nr.getBucket(d);if(!yr||yr.projection.name!==Y.projection.name)continue;let _r=!1;Ft&&(_r=Ft.getMaxCascadeForTile(Yt.toUnwrapped())===0);const Wr=g.isTileAffectedByFog(Yt),Or=yr.programConfigurations.get(d.id),Lr=g.getOrCreateProgram($t,{config:Or,defines:_r?Gt:jt,overrideFog:Wr});if(g.terrain&&g.terrain.setupElevationDraw(nr,Lr,{useMeterToDem:!0}),!yr.centroidVertexBuffer){const Sn=Lr.attributes.a_centroid_pos;Sn!==void 0&&Z.vertexAttrib2f(Sn,0,0)}!ft&&Ft&&Ft.setupShadows(nr.tileID.toUnwrapped(),Lr,"vector-tile",nr.tileID.overscaledZ),ne&&(g.context.activeTexture.set(Z.TEXTURE0),nr.imageAtlasTexture&&nr.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Or.updatePaintBuffers());const Zr=re.constantOr(null);if(Zr&&nr.imageAtlas){const Sn=nr.imageAtlas,Sr=i.A.from(Zr).getPrimary().scaleSelf(i.q.devicePixelRatio),In=Sn.patternPositions[Sr.serialize()];In&&Or.setConstantPatternPositions(In)}const Dn=d.paint.get("fill-extrusion-vertical-gradient"),hi=1/yr.tileToMeter;let Wi;if(ft&&Ft){if(Vl(nr.tileID,yr,g))continue;const Sn=Ft.calculateShadowPassMatrixFromTile(nr.tileID.toUnwrapped());Wi=sh(Sn,$e,hi,bt,kt,Et)}else{const Sn=g.translatePosMatrix(Yt.expandedProjMatrix,nr,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Sr=Y.projection.createInversionMatrix(Y,Yt.canonical);Wi=ne?Ry(Sn,g,Dn,oe,we,$e,hi,Yt,nr,Ve,kt,Et,We,Ke,Sr,Ye,bt):ah(Sn,g,Dn,oe,we,$e,hi,Yt,Ve,kt,Et,We,Ke,Sr,Ye,bt,it,Qt)}g.uploadCommonUniforms(G,Lr,Yt.toUnwrapped(),null,dt);let Yn=yr.segments;if(Y.projection.name==="mercator"&&!ft&&(Yn=yr.getVisibleSegments(nr.tileID,g.terrain,g.transform.getFrustum(0)),!Yn.get().length))continue;if(zt)if(ft)for(const Sn of Yn.get())zt.numRenderedVerticesInShadowPass+=Sn.primitiveLength;else for(const Sn of Yn.get())zt.numRenderedVerticesInTransparentPass+=Sn.primitiveLength;const Xr=[];(g.terrain||z)&&Xr.push(yr.centroidVertexBuffer),Qe&&Xr.push(yr.layoutVertexExtBuffer),pt&&Xr.push(yr.wallVertexBuffer),Lr.draw(g,G.gl.TRIANGLES,S,N,k,Yr.backCCW,Wi,d.id,yr.layoutVertexBuffer,yr.indexBuffer,Yn,d.paint,g.transform.zoom,Or,Xr)}g.shadowRenderer&&(g.shadowRenderer.useNormalOffset=!1)}function ld(g,o,d,y,S,N,k,z,G,Z,Y,re,ne,oe,_e,me,we,be,Ee){const $e=g.context,Ve=$e.gl,Qe=g.transform,We=g.transform.zoom,Ke=[],Ge=Il(g,d.paint.get("fill-extrusion-cutoff-fade-range"));Z==="clear"?(Ke.push("CLEAR_SUBPASS"),Ee&&(Ke.push("CLEAR_FROM_TEXTURE"),$e.activeTexture.set(Ve.TEXTURE0),Ee.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE))):Z==="sdf"&&Ke.push("SDF_SUBPASS"),we&&Ke.push("HAS_CENTROID"),Ge.shouldRenderCutoff&&Ke.push("RENDER_CUTOFF");const Ye=d.layout.get("fill-extrusion-edge-radius"),it=(bt,pt,kt,Et,dt)=>{const jt=pt.programConfigurations.get(d.id),Gt=g.isTileAffectedByFog(bt),ft=g.getOrCreateProgram("fillExtrusionGroundEffect",{config:jt,defines:Ke,overrideFog:Gt}),Ft=((Qt,$t,zt,Yt,nr,yr,_r,Wr,Or,Lr,Zr)=>({u_matrix:$t,u_opacity:zt,u_ao_pass:Yt?1:0,u_meter_to_tile:nr,u_ao:yr,u_flood_light_intensity:_r,u_flood_light_color:Wr,u_attenuation:Or,u_edge_radius:Lr,u_fb:0,u_fb_size:Zr,u_dynamic_offset:1}))(0,Et,Y,G,dt,[re,ne*dt],oe,_e,me,We>=17?0:Ye*dt,Ee?Ee.size[0]:0),Ct=[];we&&Ct.push(pt.hiddenByLandmarkVertexBuffer),g.uploadCommonUniforms($e,ft,bt.toUnwrapped(),null,Ge),ft.draw(g,$e.gl.TRIANGLES,S,N,k,z,Ft,d.id,pt.vertexBuffer,pt.indexBuffer,kt,d.paint,We,jt,Ct)};for(const bt of y){const pt=o.getTile(bt),kt=pt.getBucket(d);if(!kt||kt.projection.name!==Qe.projection.name||!kt.groundEffect||kt.groundEffect&&!kt.groundEffect.hasData())continue;const Et=kt.groundEffect,dt=1/kt.tileToMeter;{const jt=g.translatePosMatrix(bt.projMatrix,pt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Gt=Et.getDefaultSegment();it(bt,Et,Gt,jt,dt)}if(be)for(let jt=0;jt<4;jt++){const Gt=i.d4[jt](bt),ft=o.getTile(Gt);if(!ft)continue;const Ft=ft.getBucket(d);if(!Ft||Ft.projection.name!==Qe.projection.name||!Ft.groundEffect||Ft.groundEffect&&!Ft.groundEffect.hasData())continue;const Ct=Ft.groundEffect;let Qt,$t;jt===0?(Qt=[-i.ag,0,0],$t=1):jt===1?(Qt=[i.ag,0,0],$t=0):jt===2?(Qt=[0,-i.ag,0],$t=3):(Qt=[0,i.ag,0],$t=2);const zt=Ct.regionSegments[$t];if(!zt)continue;const Yt=new Float32Array(16);i.ab.mat4.translate(Yt,bt.projMatrix,Qt),it(bt,Ct,zt,g.translatePosMatrix(Yt,pt,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),dt)}}}function cd(g,o,d,y,S,N,k){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const z=N?N.findDEMTileFor(d):null;if(!(z&&z.dem||k))return;N&&z&&z.dem&&y.selfDEMTileTimestamp!==z.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=z.dem._timestamp);const G=be=>new i.P(Math.ceil((be+i.d7)*i.d8),0),Z=be=>{const Ee=o.getSource().minzoom,$e=Qe=>{const We=o.getTileByID(Qe);if(We&&We.hasData())return We.getBucket(S)},Ve=[0,-1,1];for(const Qe of Ve){if(be.overscaledZ+Qe<Ee)continue;const We=$e(be.calculateScaledKey(be.overscaledZ+Qe));if(We)return We}},Y=[0,0,0],re=(be,Ee)=>(Y[0]=Math.min(be.min.y,Ee.min.y),Y[1]=Math.max(be.max.y,Ee.max.y),Y[2]=i.ag-Ee.min.x>be.max.x?Ee.min.x-i.ag:be.max.x,Y),ne=(be,Ee)=>(Y[0]=Math.min(be.min.x,Ee.min.x),Y[1]=Math.max(be.max.x,Ee.max.x),Y[2]=i.ag-Ee.min.y>be.max.y?Ee.min.y-i.ag:be.max.y,Y),oe=[(be,Ee)=>re(be,Ee),(be,Ee)=>re(Ee,be),(be,Ee)=>ne(be,Ee),(be,Ee)=>ne(Ee,be)],_e=(be,Ee,$e,Ve,Qe,We,Ke)=>{if(!N)return 0;const Ge=[[We?$e:be,We?be:$e,0],[We?$e:Ee,We?Ee:$e,0]],Ye=Ke<0?i.ag+Ke:Ke,it=[We?Ye:(be+Ee)/2,We?(be+Ee)/2:Ye,0];return $e===0&&Ke<0||$e!==0&&Ke>0?N.getForTilePoints(Qe,[it],!0,Ve):Ge.push(it),N.getForTilePoints(d,Ge,!0,z),Math.max(Ge[0][2],Ge[1][2],it[2])/N.exaggeration()};for(let be=0;be<4;be++){const Ee=y.borderFeatureIndices[be];if(Ee.length===0)continue;const $e=i.d4[be](d),Ve=Z($e);if(!(Ve&&Ve instanceof i.d5))continue;const Qe=N?N.findDEMTileFor($e):null;if(!(Qe&&Qe.dem||k)||(N&&Qe&&Qe.dem&&y.borderDEMTileTimestamp[be]!==Qe.dem._timestamp&&(y.borderDoneWithNeighborZ[be]=-1,y.borderDEMTileTimestamp[be]=Qe.dem._timestamp),y.borderDoneWithNeighborZ[be]===Ve.canonical.z))continue;Ve.centroidVertexArray.length===0&&Ve.createCentroidsBuffer();const We=(be<2?1:5)-be,Ke=Ve.borderDoneWithNeighborZ[We]!==y.canonical.z,Ge=Ve.borderFeatureIndices[We];let Ye=0;if(y.canonical.z!==Ve.canonical.z){for(const it of Ee)y.showCentroid(y.featuresOnBorder[it]);if(Ke)for(const it of Ge)Ve.showCentroid(Ve.featuresOnBorder[it]);y.borderDoneWithNeighborZ[be]=Ve.canonical.z,Ve.borderDoneWithNeighborZ[We]=y.canonical.z}for(const it of Ee){const bt=y.featuresOnBorder[it],pt=y.centroidData[bt.centroidDataIndex],kt=bt.borders[be];let Et;for(;Ye<Ge.length;){Et=Ve.featuresOnBorder[Ge[Ye]];const dt=Et.borders[We];if(dt[1]>kt[0]+3||dt[0]>kt[0]-3)break;Ve.showCentroid(Et),Ye++}if(Et&&Ye<Ge.length){const dt=Ye;let jt=0;for(;!(Et.borders[We][0]>kt[1]-3)&&(jt++,++Ye!==Ge.length);)Et=Ve.featuresOnBorder[Ge[Ye]];Et=Ve.featuresOnBorder[Ge[dt]];let Gt=!1;if(jt>=1){const Ct=Et.borders[We];Math.abs(kt[0]-Ct[0])<3&&Math.abs(kt[1]-Ct[1])<3&&(jt=1,Gt=!0,Ye=dt+1)}else if(jt===0){y.showCentroid(bt);continue}const ft=Ve.centroidData[Et.centroidDataIndex];k&&Gt&&(((me=pt).flags|(we=ft).flags)&i.d6?(me.flags|=i.d6,we.flags|=i.d6):(me.flags&=~i.d6,we.flags&=~i.d6));const Ft=bt.intersectsCount()>1||Et.intersectsCount()>1;if(jt>1)Ye=dt,pt.centroidXY=ft.centroidXY=new i.P(0,0);else if(Qe&&Qe.dem&&!Ft){const Ct=oe[be](pt,ft),Qt=be%2?i.ag-1:0,$t=_e(Ct[0],Math.min(i.ag-1,Ct[1]),Qt,Qe,$e,be<2,Ct[2]);pt.centroidXY=ft.centroidXY=G($t)}else Ft?pt.centroidXY=ft.centroidXY=new i.P(0,0):(pt.centroidXY=y.encodeBorderCentroid(bt),ft.centroidXY=Ve.encodeBorderCentroid(Et));y.writeCentroidToBuffer(pt),Ve.writeCentroidToBuffer(ft)}else y.showCentroid(bt)}y.borderDoneWithNeighborZ[be]=Ve.canonical.z,Ve.borderDoneWithNeighborZ[We]=y.canonical.z}var me,we;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(g)}const ud=[1,0,0],er=[0,1,0],fr=[0,0,1];function Vl(g,o,d){const y=d.transform,S=d.shadowRenderer;if(!S)return!0;const N=g.toUnwrapped(),k=y.tileSize*S._cascades[d.currentShadowCascade].scale;let z=o.maxHeight;if(y.elevation){const me=y.elevation.getMinMaxForTile(g);me&&(z+=me.max)}const G=[...S.shadowDirection];G[2]=-G[2];const Z=S.computeSimplifiedTileShadowVolume(N,z,k,G);if(!Z)return!1;const Y=[ud,er,fr,G,[G[0],0,G[2]],[0,G[1],G[2]]],re=y.projection.name==="globe",ne=y.scaleZoom(k),oe=i.bR.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,ne,!re),_e=S.getCurrentCascadeFrustum();return oe.intersectsPrecise(Z.vertices,Z.planes,Y)===0||_e.intersectsPrecise(Z.vertices,Z.planes,Y)===0}function qi(g){return[g[0]*i.d9,g[1]*i.d9,g[2]*i.d9,0]}function _t(g,o,d,y,S,N,k,z,G){const Z=y.getSource(),Y=d.globeSharedBuffers;if(!Y)return;let re,ne,oe;if(o&&(re=y.getTile(o)),Z instanceof i.aJ?(ne=Z.texture,oe=i.cI(0,0,d.transform)):re&&o&&(ne=re.texture,oe=i.cI(o.canonical.z,o.canonical.x,d.transform)),!ne||!oe)return;g||(oe=i.ab.mat4.scale(i.ab.mat4.create(),oe,[1,-1,1]));const _e=d.context,me=_e.gl,we=S.paint.get("raster-resampling")==="nearest"?me.NEAREST:me.LINEAR,be=d.colorModeForDrapableLayerRenderPass(N),Ee=k.defines;Ee.push("GLOBE_POLES");const $e=new Br(me.LEQUAL,Br.ReadWrite,d.depthRangeFor3D),Ve=Float32Array.from(d.transform.expandedFarZProjMatrix),Qe=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0))));d.terrain&&d.terrain.prepareDrawTile(),_e.activeTexture.set(me.TEXTURE0),ne.bind(we,me.CLAMP_TO_EDGE),_e.activeTexture.set(me.TEXTURE1),ne.bind(we,me.CLAMP_TO_EDGE),ne.useMipmap&&_e.extTextureFilterAnisotropic&&d.transform.pitch>20&&me.texParameterf(me.TEXTURE_2D,_e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_e.extTextureFilterAnisotropicMax);const[We,Ke,Ge,Ye]=o?Y.getPoleBuffers(o.canonical.z,!1):Y.getPoleBuffers(0,!0),it=S.paint.get("raster-elevation");let bt;g?(bt=We,d.renderDefaultNorthPole=it!==0):(bt=Ke,d.renderDefaultSouthPole=it!==0);const pt=qi(k.mix),kt=((dt,jt,Gt,ft,Ft,Ct,Qt,$t,zt,Yt,nr,yr,_r)=>fo(dt,jt,Gt,new Float32Array(16),new Float32Array(9),[0,0],ft,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ct,[0,0],$t,2,Yt,nr,yr,1,0,_r))(Ve,Qe,oe,i.ae(d.transform.zoom),0,S,0,it,0,pt,k.offset,k.range,N),Et=d.getOrCreateProgram("raster",{defines:Ee});d.uploadCommonUniforms(_e,Et,null),Et.draw(d,me.TRIANGLES,$e,G,be,z,kt,S.id,bt,Ge,Ye)}function Dc(g){const o=g._nearZ,d=g.projection.farthestPixelDistance(g),y=d-o,S=.2*g.height,N=o+S;return[o,d,(N-S-o)/y,(N-o)/y]}function lc(g,o,d,y){if(g)return o instanceof $a&&g instanceof eu?o.getTextureDescriptor(g,d,!0):{texture:g.texture,mix:qi(y.mix),offset:y.offset,buffer:0,tileSize:1}}var Fp=i.da([{name:"a_index",type:"Int16",components:1}]);class zy{constructor(o,d,y,S){const N={width:y[0],height:y[1],data:null},k=o.gl;this.targetColorTexture=new i.T(o,N,k.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(o,N,k.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(d,S),this.lastInvalidatedAt=0}updateParticleTexture(o,d){if(this.particleTextureDimension===d.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,S=d.width*d.height;this.particleTexture0=new i.T(this.context,d,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,d,y.RGBA8,{premultiply:!1,useMipmap:!1});const N=new i.db;N.reserve(S);for(let k=0;k<S;k++)N.emplaceBack(k);this.particleIndexBuffer=this.context.createVertexBuffer(N,Fp.members,!0),this.particleSegment=i.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=d.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Lc(g,o,d){if(!g)return null;const y=o.getTextureDescriptor(g,d,!0);if(!y)return null;let{texture:S,mix:N,offset:k,tileSize:z,buffer:G,format:Z}=y;if(!S||!Z)return null;let Y=!1;return Z==="uint32"&&(Y=!0,N[3]=0,N=hu(i.dc,N,[0,d.paint.get("raster-particle-max-speed")]),k=oc(i.dc,k,[0,d.paint.get("raster-particle-max-speed")])),{texture:S,textureOffset:[G/(z+2*G),z/(z+2*G)],tileSize:z,scalarData:Y,scale:N,offset:k,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[Z]]}}function fu(g){const o=g._nearZ,d=g.projection.farthestPixelDistance(g),y=d-o,S=.2*g.height,N=o+S;return[o,d,(N-S-o)/y,(N-o)/y]}const pu=new i.aj(1,0,0,1),_v=new i.aj(0,1,0,1),rg=new i.aj(0,0,1,1),Fy=new i.aj(1,0,1,1),dd=new i.aj(0,1,1,1);function Qs(g,o,d,y,S,N,k){const z=g.context,G=g.transform,Z=z.gl,Y=G.projection.name==="globe",re=Y?["PROJECTION_GLOBE_VIEW"]:[];let ne=i.ab.mat4.clone(d.projMatrix);if(Y&&i.ae(G.zoom)>0){const pt=i.ba(d.canonical,G),kt=i.dd(pt);ne=i.ab.mat4.multiply(new Float32Array(16),G.globeMatrix,kt),i.ab.mat4.multiply(ne,G.projMatrix,ne)}const oe=i.ab.mat4.create();oe[12]+=2*S/(i.q.devicePixelRatio*G.width),oe[13]+=2*N/(i.q.devicePixelRatio*G.height),i.ab.mat4.multiply(ne,oe,ne);const _e=g.getOrCreateProgram("debug",{defines:re}),me=o.getTileByID(d.key);g.terrain&&g.terrain.setupElevationDraw(me,_e);const we=Br.disabled,be=Kr.disabled,Ee=g.colorModeForRenderPass(),$e="$debug";z.activeTexture.set(Z.TEXTURE0),g.emptyTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Y?me._makeGlobeTileDebugBuffers(g.context,G):me._makeDebugTileBoundsBuffers(g.context,G.projection);const Ve=me._tileDebugBuffer||g.debugBuffer,Qe=me._tileDebugIndexBuffer||g.debugIndexBuffer,We=me._tileDebugSegments||g.debugSegments;if(_e.draw(g,Z.LINE_STRIP,we,be,Ee,Yr.disabled,Rc(ne,y),$e,Ve,Qe,We,null,null,null,[me._globeTileDebugBorderBuffer]),k){const pt=me.latestRawTileData,kt=Math.floor((pt&&pt.byteLength||0)/1024);let Et=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(Et+=` => ${d.overscaledZ}`),Et+=` ${me.state}`,Et+=` ${kt}kb`,function(dt,jt){dt.initDebugOverlayCanvas();const Gt=dt.debugOverlayCanvas,ft=dt.context.gl,Ft=dt.debugOverlayCanvas.getContext("2d");Ft.clearRect(0,0,Gt.width,Gt.height),Ft.shadowColor="white",Ft.shadowBlur=2,Ft.lineWidth=1.5,Ft.strokeStyle="white",Ft.textBaseline="top",Ft.font="bold 36px Open Sans, sans-serif",Ft.fillText(jt,5,5),Ft.strokeText(jt,5,5),dt.debugOverlayTexture.update(Gt),dt.debugOverlayTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE)}(g,Et)}const Ke=o.getTile(d).tileSize,Ge=512/Math.min(Ke,512)*(d.overscaledZ/G.zoom)*.5,Ye=me._tileDebugTextBuffer||g.debugBuffer,it=me._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,bt=me._tileDebugTextSegments||g.debugSegments;_e.draw(g,Z.TRIANGLES,we,be,An.alphaBlended,Yr.disabled,Rc(ne,i.aj.transparent,Ge),$e,Ye,it,bt,null,null,null,[me._globeTileDebugTextBuffer])}function hh(g,o,d,y){Sl(g,0,o+d/2,g.transform.width,d,y)}function fh(g,o,d,y){Sl(g,o-d/2,0,d,g.transform.height,y)}function Sl(g,o,d,y,S,N){const k=g.context,z=k.gl;z.enable(z.SCISSOR_TEST),z.scissor(o*i.q.devicePixelRatio,d*i.q.devicePixelRatio,y*i.q.devicePixelRatio,S*i.q.devicePixelRatio),k.clear({color:N}),z.disable(z.SCISSOR_TEST)}const xf=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Eo}=xf;function zc(g,o,d,y){g.emplaceBack(o,d,y)}class ng{constructor(o){this.vertexArray=new i.de,this.indices=new i.aU,zc(this.vertexArray,-1,-1,1),zc(this.vertexArray,1,-1,1),zc(this.vertexArray,-1,1,1),zc(this.vertexArray,1,1,1),zc(this.vertexArray,-1,-1,-1),zc(this.vertexArray,1,-1,-1),zc(this.vertexArray,-1,1,-1),zc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Eo),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=i.b7.simpleSegment(0,0,36,12)}}function pi(g,o,d,y,S,N){const k=g.context.gl,z=o.paint.get("sky-atmosphere-color"),G=o.paint.get("sky-atmosphere-halo-color"),Z=o.paint.get("sky-atmosphere-sun-intensity"),Y=((re,ne,oe,_e,me)=>({u_matrix_3f:re,u_sun_direction:ne,u_sun_intensity:oe,u_color_tint_r:[_e.r,_e.g,_e.b,_e.a],u_color_tint_m:[me.r,me.g,me.b,me.a],u_luminance:5e-5}))(i.ab.mat3.fromMat4(i.ab.mat3.create(),y),S,Z,z,G);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+N,o.skyboxTexture,0),d.draw(g,k.TRIANGLES,Br.disabled,Kr.disabled,An.unblended,Yr.frontCW,Y,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const ig=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class ph{constructor(o){const d=new i.df;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const y=new i.aU;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(d,ig.members),this.indexBuffer=o.createIndexBuffer(y),this.segments=i.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ei=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ei{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ag{constructor(o){this.colorModeAlphaBlendedWriteRGB=new An([1,Wd,1,Wd],i.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new An([1,0,1,0],i.aj.transparent,[!1,!1,!1,!0]),this.params=new ei,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const d=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new ph(d);const y=this.params.sizeRange,S=this.params.intensityRange,N=function(Y){const re=i.di(30),ne=[];for(let oe=0;oe<Y;++oe){const _e=2*Math.PI*re(),me=Math.acos(1-2*re())-.5*Math.PI;ne.push(i.ab.vec3.fromValues(Math.cos(me)*Math.cos(_e),Math.cos(me)*Math.sin(_e),Math.sin(me)))}return ne}(this.params.starsCount),k=i.di(300),z=new i.dg,G=new i.aU;let Z=0;for(let Y=0;Y<N.length;++Y){const re=i.ab.vec3.scale([],N[Y],200),ne=Math.max(0,1+.01*y*(1*k()-.5)),oe=Math.max(0,1+.01*S*(1*k()-.5));z.emplaceBack(re[0],re[1],re[2],-1,-1,ne,oe),z.emplaceBack(re[0],re[1],re[2],1,-1,ne,oe),z.emplaceBack(re[0],re[1],re[2],1,1,ne,oe),z.emplaceBack(re[0],re[1],re[2],-1,1,ne,oe),G.emplaceBack(Z+0,Z+1,Z+2),G.emplaceBack(Z+0,Z+2,Z+3),Z+=4}this.starsVx=d.createVertexBuffer(z,Ei.members),this.starsIdx=d.createIndexBuffer(G),this.starsSegments=i.b7.simpleSegment(0,0,z.length,G.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,d){const y=o.context,S=y.gl,N=o.transform,k=new Br(S.LEQUAL,Br.ReadOnly,[0,1]),z=i.ae(N.zoom),G=o.style.getLut(d.scope),Z=d.properties.get("color-use-theme")==="none",Y=d.properties.get("color").toRenderColor(Z?null:G).toArray01(),re=d.properties.get("high-color-use-theme")==="none",ne=d.properties.get("high-color").toRenderColor(re?null:G).toArray01(),oe=d.properties.get("space-color-use-theme")==="none",_e=d.properties.get("space-color").toRenderColor(oe?null:G).toArray01PremultipliedAlpha(),me=5e-4,we=i.dh(d.properties.get("horizon-blend"),0,1,me,.25),be=i.cC(o,y,N)&&we===me?N.worldSize/(2*Math.PI*1.025)-1:N.globeRadius,Ee=o.frameCounter/1e3%1,$e=i.ab.vec3.length(N.globeCenterInViewSpace),Ve=Math.sqrt(Math.pow($e,2)-Math.pow(be,2)),Qe=Math.acos(Ve/$e),We=Ke=>{const Ge=N.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ke&&Ge.push("ALPHA_PASS");const Ye=o.getOrCreateProgram("globeAtmosphere",{defines:Ge}),it=((pt,kt,Et,dt,jt,Gt,ft,Ft,Ct,Qt,$t,zt)=>({u_frustum_tl:pt,u_frustum_tr:kt,u_frustum_br:Et,u_frustum_bl:dt,u_horizon:jt,u_transition:Gt,u_fadeout_range:ft,u_color:Ft,u_high_color:Ct,u_space_color:Qt,u_temporal_offset:$t,u_horizon_angle:zt}))(N.frustumCorners.TL,N.frustumCorners.TR,N.frustumCorners.BR,N.frustumCorners.BL,N.frustumCorners.horizon,z,we,Y,ne,_e,Ee,Qe);o.uploadCommonUniforms(y,Ye);const bt=this.atmosphereBuffer;bt&&Ye.draw(o,S.TRIANGLES,k,Kr.disabled,Ke?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Yr.backCW,it,Ke?"atmosphere_glow_alpha":"atmosphere_glow",bt.vertexBuffer,bt.indexBuffer,bt.segments)};We(!1),We(!0)}drawStars(o,d){const y=i.aw(d.properties.get("star-intensity"),0,1);if(y===0)return;const S=o.context,N=S.gl,k=o.transform,z=o.getOrCreateProgram("stars"),G=i.ab.quat.identity([]);i.ab.quat.rotateX(G,G,-k._pitch),i.ab.quat.rotateZ(G,G,-k.angle),i.ab.quat.rotateX(G,G,i.ai(k._center.lat)),i.ab.quat.rotateY(G,G,-i.ai(k._center.lng));const Z=i.ab.mat4.fromQuat(new Float32Array(16),G),Y=i.ab.mat4.multiply([],k.starsProjMatrix,Z),re=i.ab.mat3.fromMat4([],Z),ne=i.ab.mat3.invert([],re),oe=[0,1,0];i.ab.vec3.transformMat3(oe,oe,ne),i.ab.vec3.scale(oe,oe,this.params.sizeMultiplier);const _e=[1,0,0];i.ab.vec3.transformMat3(_e,_e,ne),i.ab.vec3.scale(_e,_e,this.params.sizeMultiplier);const me=(we=oe,be=_e,Ee=y,{u_matrix:Float32Array.from(Y),u_up:we,u_right:be,u_intensity_multiplier:Ee});var we,be,Ee;o.uploadCommonUniforms(S,z),this.starsVx&&this.starsIdx&&z.draw(o,N.TRIANGLES,Br.disabled,Kr.disabled,this.colorModeAlphaBlendedWriteRGB,Yr.disabled,me,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Mo(g,o){const d=[...g],y=o.cameraWorldSizeForFog/o.worldSize,S=i.ab.mat4.identity([]);return i.ab.mat4.scale(S,S,[y,y,1]),i.ab.mat4.multiply(d,S,d),i.ab.mat4.multiply(d,o.worldToFogMatrix,d),d}function ia(g,o,d,y,S){const N=d.material,k=y.context,{baseColorTexture:z,metallicRoughnessTexture:G}=N.pbrMetallicRoughness,{normalTexture:Z,occlusionTexture:Y,emissionTexture:re}=N;function ne(_e,me,we){if(_e&&(g.push(me),k.activeTexture.set(k.gl.TEXTURE0+we),_e.gfxTexture)){const{minFilter:be,magFilter:Ee,wrapS:$e,wrapT:Ve}=_e.sampler;_e.gfxTexture.bindExtraParam(be,Ee,$e,Ve)}}ne(z,"HAS_TEXTURE_u_baseColorTexture",Vs.BaseColor),ne(G,"HAS_TEXTURE_u_metallicRoughnessTexture",Vs.MetallicRoughness),ne(Z,"HAS_TEXTURE_u_normalTexture",Vs.Normal),ne(Y,"HAS_TEXTURE_u_occlusionTexture",Vs.Occlusion),ne(re,"HAS_TEXTURE_u_emissionTexture",Vs.Emission),S&&(S.texture||(S.texture=new i.dk(y.context,S.image,[S.image.height,S.image.height,S.image.height],k.gl.RGBA8)),k.activeTexture.set(k.gl.TEXTURE0+Vs.LUT),S.texture&&S.texture.bind(k.gl.LINEAR,k.gl.CLAMP_TO_EDGE),g.push("APPLY_LUT_ON_GPU")),d.texcoordBuffer&&(g.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(d.texcoordBuffer)),d.colorBuffer&&(g.push(d.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(d.colorBuffer)),d.normalBuffer&&(g.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(d.normalBuffer)),d.pbrBuffer&&(g.push("HAS_ATTRIBUTE_a_pbr"),g.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(d.pbrBuffer)),N.alphaMode!=="OPAQUE"&&N.alphaMode!=="MASK"||g.push("UNPREMULT_TEXTURE_IN_SHADER"),N.defined||g.push("DIFFUSE_SHADED");const oe=y.shadowRenderer;oe&&(g.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&g.push("NORMAL_OFFSET"))}function ua(g,o,d,y,S,N){const k=d.paint.get("model-opacity").constantOr(1),z=o.context,G=new Br(o.context.gl.LEQUAL,Br.ReadWrite,o.depthRangeFor3D),Z=o.transform,Y=g.mesh,re=Y.material,ne=re.pbrMetallicRoughness,oe=o.style.fog;let _e;_e=o.transform.projection.zAxisUnit==="pixels"?[...g.nodeModelMatrix]:i.ab.mat4.multiply([],y.zScaleMatrix,g.nodeModelMatrix),i.ab.mat4.multiply(_e,y.negCameraPosMatrix,_e);const me=i.ab.mat4.invert([],_e);i.ab.mat4.transpose(me,me);const we=d.paint.get("model-color-use-theme").constantOr("default")==="none",be=d.paint.get("model-emissive-strength").constantOr(0),Ee=lh(new Float32Array(g.worldViewProjection),new Float32Array(_e),new Float32Array(me),null,o,k,ne.baseColorFactor.toRenderColor(null),re.emissiveFactor,ne.metallicFactor,ne.roughnessFactor,re,be,d),$e={defines:[]},Ve=[],Qe=o.shadowRenderer;Qe&&(Qe.useNormalOffset=!1),ia($e.defines,Ve,Y,o,we?null:d.lut);let We=null;if(oe){const Ye=Mo(g.nodeModelMatrix,o.transform);if(We=new Float32Array(Ye),Z.projection.name!=="globe"){const it=Y.aabb.min,bt=Y.aabb.max,[pt,kt]=oe.getOpacityForBounds(Ye,it[0],it[1],bt[0],bt[1]);$e.overrideFog=pt>=Je||kt>=Je}}const Ke=Il(o,d.paint.get("model-cutoff-fade-range"));Ke.shouldRenderCutoff&&$e.defines.push("RENDER_CUTOFF");const Ge=o.getOrCreateProgram("model",$e);o.uploadCommonUniforms(z,Ge,null,We,Ke),o.renderPass!=="shadow"&&Qe&&Qe.setupShadowsFromMatrix(g.nodeModelMatrix,Ge),Ge.draw(o,z.gl.TRIANGLES,G,S,N,Y.material.doubleSided?Yr.disabled:Yr.backCCW,Ee,d.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,d.paint,o.transform.zoom,void 0,Ve)}function ns(g,o,d,y,S,N,k){let z;z=g.projection.name==="globe"?i.dl(d,g):[...d],i.ab.mat4.multiply(z,z,o.matrix);const G=i.ab.mat4.multiply([],y,z);if(o.meshes)for(const Z of o.meshes){if(Z.material.alphaMode!=="BLEND"){k.push({mesh:Z,depth:0,modelIndex:S,worldViewProjection:G,nodeModelMatrix:z});continue}const Y=i.ab.vec3.transformMat4([],Z.centroid,G);!g.isOrthographic&&Y[2]<=0||N.push({mesh:Z,depth:Y[2],modelIndex:S,worldViewProjection:G,nodeModelMatrix:z})}if(o.children)for(const Z of o.children)ns(g,Z,d,y,S,N,k)}function hd(g,o,d,y){const S=d.shadowRenderer;if(!S)return;const N=S.getShadowPassDepthMode(),k=S.getShadowPassColorMode(),z=S.calculateShadowPassMatrixFromMatrix(o),G=yf(z);d.getOrCreateProgram("modelDepth",{defines:d._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(d,d.context.gl.TRIANGLES,N,Kr.disabled,k,Yr.backCCW,G,y.id,g.vertexBuffer,g.indexBuffer,g.segments,y.paint,d.transform.zoom,void 0,void 0)}function Qo(g,o,d){const y=o.updateZoomBasedPaintProperties(),S=function(N,k,z){let G,Z,Y,re=N.terrain?N.terrain.exaggeration():0;if(N.terrain&&re>0){const ne=N.terrain,oe=ne.findDEMTileFor(z);oe&&oe.dem?G=i.dn.create(ne,z,oe):re=0}if(re===0&&(k.terrainElevationMin=0,k.terrainElevationMax=0),re===k.validForExaggeration&&(re===0||G&&G._demTile&&G._demTile.tileID===k.validForDEMTile.id&&G._dem._timestamp===k.validForDEMTile.timestamp))return!1;for(const ne in k.instancesPerModel){const oe=k.instancesPerModel[ne];for(let _e=0;_e<oe.instancedDataArray.length;++_e){const me=(G?re*G.getElevationAt(0|oe.instancedDataArray.float32[16*_e],0|oe.instancedDataArray.float32[16*_e+1],!0,!0):0)+oe.instancesEvaluatedElevation[_e];oe.instancedDataArray.float32[16*_e+6]=me,Z=Z?Math.min(k.terrainElevationMin,me):me,Y=Y?Math.max(k.terrainElevationMax,me):me}}return k.terrainElevationMin=Z||0,k.terrainElevationMax=Y||0,k.validForExaggeration=re,k.validForDEMTile=G&&G._demTile?{id:G._demTile.tileID,timestamp:G._dem._timestamp}:{id:void 0,timestamp:0},!0}(g,o,d);(y||S)&&(o.uploaded=!1,o.upload(g.context))}const is={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cd([0,0,0],[i.ag,i.ag,0])};function sg(g,o){const d=1<<g.canonical.z,y=o.getFreeCameraOptions().position,S=o.elevation,N=g.canonical.x/d,k=(g.canonical.x+1)/d,z=g.canonical.y/d,G=(g.canonical.y+1)/d;let Z=o._centerAltitude;if(S){const oe=S.getMinMaxForTile(g);oe&&oe.max>Z&&(Z=oe.max)}const Y=i.aw(y.x,N,k)-y.x,re=i.aw(y.y,z,G)-y.y,ne=i.bH(Z,o.center.lat)-y.z;return o._zoomFromMercatorZ(Math.sqrt(Y*Y+re*re+ne*ne))}function xs(g,o,d,y,S,N,k){const z=g.context,G=g.renderPass==="shadow",Z=g.shadowRenderer,Y=G&&Z?Z.getShadowPassDepthMode():new Br(z.gl.LEQUAL,Br.ReadWrite,g.depthRangeFor3D),re=g.isTileAffectedByFog(N);if(d.meshes)for(const ne of d.meshes){const oe=["MODEL_POSITION_ON_GPU"],_e=[];let me,we,be;y.instancedDataArray.length>20&&oe.push("INSTANCED_ARRAYS");const Ee=Il(g,o.paint.get("model-cutoff-fade-range"));if(Ee.shouldRenderCutoff&&oe.push("RENDER_CUTOFF"),G&&Z)me=g.getOrCreateProgram("modelDepth",{defines:oe}),we=yf(k.shadowTileMatrix,k.shadowTileMatrix,Float32Array.from(d.matrix)),be=Z.getShadowPassColorMode();else{ia(oe,_e,ne,g,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),me=g.getOrCreateProgram("model",{defines:oe,overrideFog:re});const Ve=ne.material,Qe=Ve.pbrMetallicRoughness,We=o.paint.get("model-opacity").constantOr(1),Ke=o.paint.get("model-emissive-strength").constantOr(0);we=lh(N.expandedProjMatrix,Float32Array.from(d.matrix),new Float32Array(16),null,g,We,Qe.baseColorFactor.toRenderColor(null),Ve.emissiveFactor,Qe.metallicFactor,Qe.roughnessFactor,Ve,Ke,o,S),Z&&(k.shadowUniformsInitialized?me.setShadowUniformValues(z,Z.getShadowUniformValues()):(Z.setupShadows(N.toUnwrapped(),me,"model-tile",N.overscaledZ),k.shadowUniformsInitialized=!0)),be=Ee.shouldRenderCutoff||We<1||Ve.alphaMode!=="OPAQUE"?An.alphaBlended:An.unblended}g.uploadCommonUniforms(z,me,N.toUnwrapped(),null,Ee);const $e=ne.material.doubleSided?Yr.disabled:Yr.backCCW;if(y.instancedDataArray.length>20)_e.push(y.instancedDataBuffer),me.draw(g,z.gl.TRIANGLES,Y,Kr.disabled,be,$e,we,o.id,ne.vertexBuffer,ne.indexBuffer,ne.segments,o.paint,g.transform.zoom,void 0,_e,y.instancedDataArray.length);else{const Ve=G?"u_instance":"u_normal_matrix";for(let Qe=0;Qe<y.instancedDataArray.length;++Qe)we[Ve]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Qe,16),me.draw(g,z.gl.TRIANGLES,Y,Kr.disabled,be,$e,we,o.id,ne.vertexBuffer,ne.indexBuffer,ne.segments,o.paint,g.transform.zoom,void 0,_e)}}if(d.children)for(const ne of d.children)xs(g,o,ne,y,S,N,k)}const Bp=[1,-1,1];function Vp(g,o,d,y){if(!d.modelManager)return!0;const S=d.modelManager;if(!d.shadowRenderer)return!0;const N=d.shadowRenderer,k=o.aabb;let z=!0,G=g.maxHeight;if(G===0){let Y=0;for(const re in g.instancesPerModel){const ne=S.getModel(re,y);ne?Y=Math.max(Y,Math.max(Math.max(ne.aabb.max[0],ne.aabb.max[1]),ne.aabb.max[2])):z=!1}G=g.maxScale*Y*1.41+g.maxVerticalOffset,z&&(g.maxHeight=G)}k.max[2]=G,k.min[2]+=g.terrainElevationMin,k.max[2]+=g.terrainElevationMax,i.ab.vec3.transformMat4(k.min,k.min,o.tileMatrix),i.ab.vec3.transformMat4(k.max,k.max,o.tileMatrix);const Z=k.intersects(N.getCurrentCascadeFrustum());return d.currentShadowCascade===0&&(g.isInsideFirstShadowMapFrustum=Z===2),Z===0}function mu(g,o){const d=g.uniformValues.u_cutoff_params[0],y=g.uniformValues.u_cutoff_params[1],S=g.uniformValues.u_cutoff_params[2],N=g.uniformValues.u_cutoff_params[3];return y===d||N===S?1:i.aw(((o-d)/(y-d)-S)/(N-S),0,1)}function Ul(g,o,d,y){if(o.pitch<20)return 1;const S=o.getWorldToCameraMatrix();i.ab.mat4.multiply(S,S,g);const N=i.ab.vec4.fromValues(d.min[0],d.min[1],d.min[2],1);let k=i.ab.vec4.transformMat4(i.ab.vec4.create(),N,S),z=k,G=k;N[1]=d.max[1],k=i.ab.vec4.transformMat4(i.ab.vec4.create(),N,S),z=k[1]<z[1]?k:z,G=k[1]>G[1]?k:G,N[0]=d.max[0],k=i.ab.vec4.transformMat4(i.ab.vec4.create(),N,S),z=k[1]<z[1]?k:z,G=k[1]>G[1]?k:G,N[1]=d.min[1],k=i.ab.vec4.transformMat4(i.ab.vec4.create(),N,S),z=k[1]<z[1]?k:z,G=k[1]>G[1]?k:G;const Z=i.aw(y[0],0,1),Y=100*o.pixelsPerMeter*i.aw(y[1],0,1),re=i.aw(y[2],0,1),ne=i.ab.vec4.lerp(i.ab.vec4.create(),z,G,Z),oe=Math.tan(.5*o.fovX),_e=-ne[2]*oe;if(Y===0)return ne[1]<-Math.abs(_e)?re:1;const me=(-Math.abs(_e)-ne[1])/Y,we=(Ee,$e,Ve)=>(1-Ve)*Ee+Ve*$e,be=i.aw(we(1,re,me),re,1);return we(1,be,i.aw((o.pitch-20)/20,0,1))}class Rs{}class mh{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,d,y){{const re=this._storage.get(d.id);if(re)return re.lastUsedFrameIdx=o,re.buf}const S=y.gl,N=S.getBufferParameter(S.ELEMENT_ARRAY_BUFFER,S.BUFFER_SIZE),k=new ArrayBuffer(N),z=new Int16Array(k);S.getBufferSubData(S.ELEMENT_ARRAY_BUFFER,0,new Int16Array(k));const G=new i.dq;for(let re=0;re<N/2;re+=3){const ne=z[re],oe=z[re+1],_e=z[re+2];G.emplaceBack(ne,oe),G.emplaceBack(oe,_e),G.emplaceBack(_e,ne)}const Z=y.bindVertexArrayOES.current,Y=new Rs;return Y.buf=new bl(y,G),Y.lastUsedFrameIdx=o,this._storage.set(d.id,Y),y.bindVertexArrayOES.set(Z),Y.buf}update(o){for(const[d,y]of this._storage)o-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(d))}destroy(){for(const[o,d]of this._storage)d.buf.destroy(),this._storage.delete(o)}}class _f{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Up=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class og{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class _s{constructor(o,d){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...d,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...d,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const lg=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class cg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,d){const y=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const k=new i.dr,z=new i.aU;k.emplaceBack(-1,-1),k.emplaceBack(1,-1),k.emplaceBack(1,1),k.emplaceBack(-1,1),z.emplaceBack(0,1,2),z.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(k,lg.members),this.vignetteIdx=o.context.createIndexBuffer(z)}const S=i.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,y);const k={u_vignetteShape:(N={vignetteShape:[d.start,d.range,Math.pow(10,d.fadePower)],vignetteColor:[d.color.r,d.color.g,d.color.b,d.color.a*d.strength]}).vignetteShape,u_vignetteColor:N.vignetteColor};y.draw(o,o.context.gl.TRIANGLES,Br.disabled,Kr.disabled,An.alphaBlended,Yr.disabled,k,"vignette",this.vignetteVx,this.vignetteIdx,S,{})}var N}}class bf{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,d){const y=o.getFreeCameraOptions().position,S=y.toAltitude(),N=y.toLngLat(),k=i.ai(N.lng),z=i.ai(N.lat),G=o.pixelsPerMeter/d,Z=k*i.ds,Y=i.ds*Math.log(Math.tan(Math.PI/4+z/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const re=-this._offsetYPrev+Y,ne=-this._elevationPrev+S;this._accumulatedOffsetX+=(-this._offsetXPrev+Z)*G,this._accumulatedOffsetY+=re*G,this._accumulatedElevation+=ne*G,this._offsetXPrev=Z,this._offsetYPrev=Y,this._elevationPrev=S}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function gu(g,o){return[-(g[0]-Math.floor(g[0]/o)*o),-(g[1]-Math.floor(g[1]/o)*o),-(g[2]-Math.floor(g[2]/o)*o)]}function $p(g){const o=i.di(1323123451230),d=[];for(let y=0;y<g;++y){const S=2*o()-1,N=2*o()-1,k=2*o()-1;d.push(i.ab.vec3.fromValues(S,N,k))}return d}function cc(g,o,d,y,S){const N=i.aw((S-d)/(y-d),0,1);return(1-N)*g+N*o}class fd{constructor(o){this._movement=new bf,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new cg,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,d){const y=o.transform;this._movement.update(y,this._ppmScaleFactor);const S=y.starsProjMatrix,N=i.ab.quat.identity([]);i.ab.quat.rotateX(N,N,i.ai(90)-y._pitch),i.ab.quat.rotateZ(N,N,-y.angle);const k=i.ab.mat4.fromQuat(new Float32Array(16),N),z=i.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),G=i.ab.mat4.transpose([],z),Z=i.ab.mat4.multiply([],G,k),Y=Date.now()/1e3;return this._accumulatedTimeFromStart+=(Y-this._prevTime)*d,this._prevTime=Y,{projectionMatrix:S,modelviewMatrix:Z}}}class gh extends fd{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new _s(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const d=o.context;if(!this.particlesVx){const y=$p(this.particlesCount),S=new i.dt,N=new i.aU;let k=0;const z=i.di(1323123451230);for(let G=0;G<y.length;++G){const Z=y[G],Y=[2*z()-1,z(),z(),z()];S.emplaceBack(Z[0],Z[1],Z[2],-1,-1,...Y),S.emplaceBack(Z[0],Z[1],Z[2],1,-1,...Y),S.emplaceBack(Z[0],Z[1],Z[2],1,1,...Y),S.emplaceBack(Z[0],Z[1],Z[2],-1,1,...Y),N.emplaceBack(k+0,k+1,k+2),N.emplaceBack(k+0,k+2,k+3),k+=4}this.particlesVx=d.createVertexBuffer(S,Up.members),this.particlesIdx=d.createIndexBuffer(N)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const d=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=o.transform.zoom;if(d.revealStart>y)return;const S=cc(0,1,d.revealStart,d.revealStart+d.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const N=structuredClone(this._params);let k=[-N.direction.x,N.direction.y,-100];i.ab.vec3.normalize(k,k);const z=structuredClone(this._vignetteParams);z.strength*=S,N.overrideStyleParameters||(N.intensity=o.style.rain.state.density,N.timeFactor=o.style.rain.state.intensity,N.color=structuredClone(o.style.rain.state.color),k=structuredClone(o.style.rain.state.direction),N.screenThinning.intensity=o.style.rain.state.centerThinning,N.dropletSizeX=o.style.rain.state.dropletSize[0],N.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],N.distortionStrength=100*o.style.rain.state.distortionStrength,z.strength=1,z.color=structuredClone(o.style.rain.state.vignetteColor));const G=this.updateOnRender(o,N.timeFactor),Z=o.context,Y=Z.gl,re=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new i.T(Z,{width:o.width,height:o.height,data:null},Y.RGBA8)),N.distortionStrength>0&&(Z.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Y.copyTexSubImage2D(Y.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const ne=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(Z,ne),Z.activeTexture.set(Y.TEXTURE0),this.screenTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const oe=[N.color.r,N.color.g,N.color.b,N.color.a],_e=(me,we)=>{const be=gu(this._movement.getPosition(),me),Ee=N.dropletSizeX,$e=N.dropletSizeX*N.dropletSizeYScale,Ve=o.width/2,Qe=o.height/2,We=cc(0,N.screenThinning.start,0,1,N.screenThinning.intensity),Ke=cc(.001,N.screenThinning.range,0,1,N.screenThinning.intensity),Ge=cc(0,N.screenThinning.particleOffset,0,1,N.screenThinning.intensity),Ye=(it={modelview:G.modelviewMatrix,projection:G.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:be,velocityConeAperture:N.velocityConeAperture,velocity:N.velocity,boxSize:me,rainDropletSize:[Ee,$e],distortionStrength:N.distortionStrength,rainDirection:k,color:oe,screenSize:[re.width,re.height],thinningCenterPos:[Ve,Qe],thinningShape:[We,Ke,Math.pow(10,N.screenThinning.fadePower)],thinningAffectedRatio:N.screenThinning.affectedRatio,thinningParticleOffset:Ge,shapeDirectionalPower:N.shapeDirPower,shapeNormalPower:N.shapeNormalPower,mode:we?0:1},{u_modelview:Float32Array.from(it.modelview),u_projection:Float32Array.from(it.projection),u_time:it.time,u_cam_pos:it.camPos,u_texScreen:0,u_velocityConeAperture:it.velocityConeAperture,u_velocity:it.velocity,u_boxSize:it.boxSize,u_rainDropletSize:it.rainDropletSize,u_distortionStrength:it.distortionStrength,u_rainDirection:it.rainDirection,u_color:it.color,u_screenSize:it.screenSize,u_thinningCenterPos:it.thinningCenterPos,u_thinningShape:it.thinningShape,u_thinningAffectedRatio:it.thinningAffectedRatio,u_thinningParticleOffset:it.thinningParticleOffset,u_shapeDirectionalPower:it.shapeDirectionalPower,u_shapeNormalPower:it.shapeNormalPower,u_mode:it.mode});var it;const bt=Math.round(N.intensity*this.particlesCount),pt=i.b7.simpleSegment(0,0,4*bt,2*bt);ne.draw(o,Y.TRIANGLES,Br.disabled,Kr.disabled,An.alphaBlended,Yr.disabled,Ye,"rain_particles",this.particlesVx,this.particlesIdx,pt,{})};N.distortionStrength>0&&_e(N.boxSize,!0),_e(N.boxSize,!1),this._vignette.draw(o,z)}}const wf=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Sf extends fd{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new _s(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const d=o.context;if(!this.particlesVx){const y=$p(this.particlesCount),S=new i.du,N=new i.aU;let k=0;const z=i.di(1323123451230);for(let G=0;G<y.length;++G){const Z=y[G],Y=z(),re=z(),ne=z(),oe=[G/y.length,Y,re,ne],_e=[z(),z()];S.emplaceBack(Z[0],Z[1],Z[2],-1,-1,...oe,..._e),S.emplaceBack(Z[0],Z[1],Z[2],1,-1,...oe,..._e),S.emplaceBack(Z[0],Z[1],Z[2],1,1,...oe,..._e),S.emplaceBack(Z[0],Z[1],Z[2],-1,1,...oe,..._e),N.emplaceBack(k+0,k+1,k+2),N.emplaceBack(k+0,k+2,k+3),k+=4}this.particlesVx=d.createVertexBuffer(S,wf.members),this.particlesIdx=d.createIndexBuffer(N)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const d=structuredClone(this._params);let y=[-d.direction.x,d.direction.y,-100];i.ab.vec3.normalize(y,y);const S=structuredClone(this._vignetteParams),N=d.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},k=o.transform.zoom;if(N.revealStart>k)return;const z=cc(0,1,N.revealStart,N.revealStart+N.revealRange,k);S.strength*=z,d.overrideStyleParameters||(d.intensity=o.style.snow.state.density,d.timeFactor=o.style.snow.state.intensity,d.color=structuredClone(o.style.snow.state.color),y=structuredClone(o.style.snow.state.direction),d.screenThinning.intensity=o.style.snow.state.centerThinning,d.billboardSize=2.79*o.style.snow.state.flakeSize,S.strength=1,S.color=structuredClone(o.style.snow.state.vignetteColor));const G=this.updateOnRender(o,d.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const Z=o.context,Y=Z.gl,re=o.transform,ne=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(Z,ne),((oe,_e,me)=>{const we=gu(this._movement.getPosition(),oe),be=re.width/2,Ee=re.height/2,$e=cc(0,me.screenThinning.start,0,1,me.screenThinning.intensity),Ve=cc(.001,me.screenThinning.range,0,1,me.screenThinning.intensity),Qe=cc(0,me.screenThinning.particleOffset,0,1,me.screenThinning.intensity),We=(Ke={modelview:G.modelviewMatrix,projection:G.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:we,velocityConeAperture:me.velocityConeAperture,velocity:me.velocity,horizontalOscillationRadius:me.horizontalOscillationRadius,horizontalOscillationRate:me.horizontalOscillationRate,boxSize:oe,billboardSize:1*me.billboardSize,simpleShapeParameters:[me.shapeFadeStart,me.shapeFadePower],screenSize:[re.width,re.height],thinningCenterPos:[be,Ee],thinningShape:[$e,Ve,Math.pow(10,me.screenThinning.fadePower)],thinningAffectedRatio:me.screenThinning.affectedRatio,thinningParticleOffset:Qe,color:[me.color.r,me.color.g,me.color.b,me.color.a],direction:y},{u_modelview:Float32Array.from(Ke.modelview),u_projection:Float32Array.from(Ke.projection),u_time:Ke.time,u_cam_pos:Ke.camPos,u_velocityConeAperture:Ke.velocityConeAperture,u_velocity:Ke.velocity,u_horizontalOscillationRadius:Ke.horizontalOscillationRadius,u_horizontalOscillationRate:Ke.horizontalOscillationRate,u_boxSize:Ke.boxSize,u_billboardSize:Ke.billboardSize,u_simpleShapeParameters:Ke.simpleShapeParameters,u_screenSize:Ke.screenSize,u_thinningCenterPos:Ke.thinningCenterPos,u_thinningShape:Ke.thinningShape,u_thinningAffectedRatio:Ke.thinningAffectedRatio,u_thinningParticleOffset:Ke.thinningParticleOffset,u_particleColor:Ke.color,u_direction:Ke.direction});var Ke;const Ge=Math.round(me.intensity*this.particlesCount),Ye=i.b7.simpleSegment(0,0,4*Ge,2*Ge);this.particlesVx&&this.particlesIdx&&ne.draw(o,Y.TRIANGLES,Br.disabled,Kr.disabled,An.alphaBlended,Yr.disabled,We,"snow_particles",this.particlesVx,this.particlesIdx,Ye,{})})(d.boxSize,0,d),this._vignette.draw(o,S)}}const Af={symbol:function(g,o,d,y,S){if(g.renderPass!=="translucent")return;const N=Kr.disabled,k=g.colorModeForRenderPass(),z=d.layout.get("text-variable-anchor"),G=d.layout.get("text-size-scale-range"),Z=i.aw(g.scaleFactor,G[0],G[1]);z&&function(ne,oe,_e,me,we,be,Ee,$e){const Ve=oe.transform,Qe=we==="map",We=be==="map";for(const Ke of ne){const Ge=me.getTile(Ke),Ye=Ge.getBucket(_e);if(!Ye||!Ye.text||!Ye.text.segments.get().length)continue;const it=i.bp(Ye.textSizeData,Ve.zoom,$e),bt=iu(Ke,Ye.getProjection(),Ve),pt=Ve.calculatePixelsToTileUnitsMatrix(Ge),kt=qa(bt,Ge.tileID.canonical,We,Qe,Ve,Ye.getProjection(),pt),Et=Ye.hasIconTextFit()&&Ye.hasIconData();if(it){const dt=Math.pow(2,Ve.zoom-Ge.tileID.overscaledZ);zp(Ye,Qe,We,Ee,i.cX,Ve,kt,Ke,dt,it,Et)}}}(y,g,d,o,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),S,Z);const Y=d.paint.get("icon-opacity").constantOr(1)!==0,re=d.paint.get("text-opacity").constantOr(1)!==0;d.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(Y||re)?sd(g,o,d,y,N,k):(Y&&sd(g,o,d,y,N,k,{onlyIcons:!0}),re&&sd(g,o,d,y,N,k,{onlyText:!0})),o.map.showCollisionBoxes&&(ch(g,o,d,y,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),ch(g,o,d,y,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,d,y){if(g.renderPass!=="translucent")return;const S=d.paint.get("circle-opacity"),N=d.paint.get("circle-stroke-width"),k=d.paint.get("circle-stroke-opacity"),z=d.layout.get("circle-sort-key").constantOr(1)!==void 0,G=d.paint.get("circle-emissive-strength");if(S.constantOr(1)===0&&(N.constantOr(1)===0||k.constantOr(1)===0))return;const Z=g.context,Y=Z.gl,re=g.transform,ne=g.depthModeForSublayer(0,Br.ReadOnly),oe=Kr.disabled,_e=g.colorModeForDrapableLayerRenderPass(G),me=re.projection.name==="globe",we=[i.at(re.center.lng),i.aA(re.center.lat)],be=[];for(let $e=0;$e<y.length;$e++){const Ve=y[$e],Qe=o.getTile(Ve),We=Qe.getBucket(d);if(!We||We.projection.name!==re.projection.name)continue;const Ke=We.programConfigurations.get(d.id),Ge=i.cY(d),Ye=g.isTileAffectedByFog(Ve);me&&Ge.push("PROJECTION_GLOBE_VIEW"),Ge.push("DEPTH_D24"),g.terrain&&re.depthOcclusionForSymbolsAndCircles&&Ge.push("DEPTH_OCCLUSION");const it=g.getOrCreateProgram("circle",{config:Ke,defines:Ge,overrideFog:Ye}),bt=We.layoutVertexBuffer,pt=We.globeExtVertexBuffer,kt=We.indexBuffer,Et=re.projection.createInversionMatrix(re,Ve.canonical),dt={programConfiguration:Ke,program:it,layoutVertexBuffer:bt,globeExtVertexBuffer:pt,indexBuffer:kt,uniformValues:i.cZ(g,Ve,Qe,Et,we,d),tile:Qe};if(z){const jt=We.segments.get();for(const Gt of jt)be.push({segments:new i.b7([Gt]),sortKey:Gt.sortKey,state:dt})}else be.push({segments:We.segments,sortKey:0,state:dt})}z&&be.sort(($e,Ve)=>$e.sortKey-Ve.sortKey);const Ee={useDepthForOcclusion:re.depthOcclusionForSymbolsAndCircles};for(const $e of be){const{programConfiguration:Ve,program:Qe,layoutVertexBuffer:We,globeExtVertexBuffer:Ke,indexBuffer:Ge,uniformValues:Ye,tile:it}=$e.state,bt=$e.segments;g.terrain&&g.terrain.setupElevationDraw(it,Qe,Ee),g.uploadCommonUniforms(Z,Qe,it.tileID.toUnwrapped()),Qe.draw(g,Y.TRIANGLES,ne,oe,_e,Yr.disabled,Ye,d.id,We,Ge,bt,d.paint,re.zoom,Ve,[Ke])}},heatmap:function(g,o,d,y){if(d.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const S=g.context,N=S.gl,k=Kr.disabled,z=new An([N.ONE,N.ONE,N.ONE,N.ONE],i.aj.transparent,[!0,!0,!0,!0]);(function(oe,_e,me,we){const be=oe.gl,Ee=_e.width*we,$e=_e.height*we;oe.activeTexture.set(be.TEXTURE1),oe.viewport.set([0,0,Ee,$e]);let Ve=me.heatmapFbo;if(!Ve||Ve&&(Ve.width!==Ee||Ve.height!==$e)){Ve&&Ve.destroy();const Qe=be.createTexture();be.bindTexture(be.TEXTURE_2D,Qe),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MAG_FILTER,be.LINEAR),Ve=me.heatmapFbo=oe.createFramebuffer(Ee,$e,!0,null),function(We,Ke,Ge,Ye,it,bt){const pt=We.gl;pt.texImage2D(pt.TEXTURE_2D,0,We.extRenderToTextureHalfFloat?pt.RGBA16F:pt.RGBA,it,bt,0,pt.RGBA,We.extRenderToTextureHalfFloat?pt.HALF_FLOAT:pt.UNSIGNED_BYTE,null),Ye.colorAttachment.set(Ge)}(oe,0,Qe,Ve,Ee,$e)}else be.bindTexture(be.TEXTURE_2D,Ve.colorAttachment.get()),oe.bindFramebuffer.set(Ve.framebuffer)})(S,g,d,g.transform.projection.name==="globe"?.5:.25),S.clear({color:i.aj.transparent});const G=g.transform,Z=G.projection.name==="globe",Y=Z?["PROJECTION_GLOBE_VIEW"]:[],re=Z?Yr.frontCCW:Yr.disabled,ne=[i.at(G.center.lng),i.aA(G.center.lat)];for(let oe=0;oe<y.length;oe++){const _e=y[oe];if(o.hasRenderableParent(_e))continue;const me=o.getTile(_e),we=me.getBucket(d);if(!we||we.projection.name!==G.projection.name)continue;const be=g.isTileAffectedByFog(_e),Ee=we.programConfigurations.get(d.id),$e=g.getOrCreateProgram("heatmap",{config:Ee,defines:Y,overrideFog:be}),{zoom:Ve}=g.transform;g.terrain&&g.terrain.setupElevationDraw(me,$e),g.uploadCommonUniforms(S,$e,_e.toUnwrapped());const Qe=G.projection.createInversionMatrix(G,_e.canonical);$e.draw(g,N.TRIANGLES,Br.disabled,k,z,re,gr(g,_e,me,Qe,ne,Ve,d.paint.get("heatmap-intensity")),d.id,we.layoutVertexBuffer,we.indexBuffer,we.segments,d.paint,g.transform.zoom,Ee,Z?[we.globeExtVertexBuffer]:null)}S.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(S,N){const k=S.context,z=k.gl,G=N.heatmapFbo;if(!G)return;k.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,G.colorAttachment.get()),k.activeTexture.set(z.TEXTURE1);let Z=N.colorRampTexture;Z||(Z=N.colorRampTexture=new i.T(k,N.colorRamp,z.RGBA8)),Z.bind(z.LINEAR,z.CLAMP_TO_EDGE),S.getOrCreateProgram("heatmapTexture").draw(S,z.TRIANGLES,Br.disabled,Kr.disabled,S.colorModeForRenderPass(),Yr.disabled,((Y,re,ne,oe)=>({u_image:0,u_color_ramp:1,u_opacity:re.paint.get("heatmap-opacity")}))(0,N),N.id,S.viewportBuffer,S.quadTriangleIndexBuffer,S.viewportSegments,N.paint,S.transform.zoom)}(g,d))},line:function(g,o,d,y){if(g.renderPass!=="translucent")return;const S=d.paint.get("line-opacity"),N=d.paint.get("line-width");if(S.constantOr(1)===0||N.constantOr(1)===0)return;const k=d.paint.get("line-emissive-strength"),z=d.paint.get("line-occlusion-opacity"),G=d.layout.get("line-elevation-reference"),Z=d.layout.get("line-width-unit")==="meters",Y=G==="sea",re=g.context,ne=re.gl;if(d.hasElevatedBuckets&&g.transform.projection.name==="globe")return;const oe=d.layout.get("line-cross-slope"),_e=oe!==void 0,me=oe<1,we=g.colorModeForDrapableLayerRenderPass(k),be=g.terrain&&g.terrain.renderingToTexture,Ee=be?1:i.q.devicePixelRatio,$e=d.paint.get("line-dasharray"),Ve=$e.constantOr(1),Qe=d.layout.get("line-cap"),We=$e.constantOr(null),Ke=Qe.constantOr(null),Ge=d.paint.get("line-pattern"),Ye=Ge.constantOr(1),it=Ge.constantOr(null),bt=d.paint.get("line-opacity").constantOr(1);let pt=!Ye&&bt!==1||g.depthOcclusion&&z>0&&z<1;const kt=d.paint.get("line-gradient"),Et=Ye?"linePattern":"line",dt=i.c_(d);let jt;if(be&&g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(pt=!1),z!==0&&g.depthOcclusion){const ft=d.paint._values["line-opacity"];ft&&ft.value&&ft.value.kind==="constant"?jt=ft.value:i.w(`Occlusion opacity for layer ${d.id} is supported only when line-opacity isn't data-driven.`)}N.value.kind!=="constant"&&N.value.isLineProgressConstant===!1&&dt.push("VARIABLE_LINE_WIDTH");const Gt=(ft,Ft,Ct,Qt,$t)=>{for(const zt of ft){const Yt=o.getTile(zt);if(Ye&&!Yt.patternsLoaded())continue;const nr=Yt.getBucket(d);if(!nr||nr.hasZOffset&&!$t||!nr.hasZOffset&&$t)continue;g.prepareDrawTile();const yr=nr.programConfigurations.get(d.id),_r=g.isTileAffectedByFog(zt),Wr=g.getOrCreateProgram(Et,{config:yr,defines:Ft,overrideFog:_r,overrideRtt:!$t&&void 0});if(it&&Yt.imageAtlas){const Xr=i.A.from(it).getPrimary().scaleSelf(Ee).serialize(),Sn=Yt.imageAtlas.patternPositions[Xr];Sn&&yr.setConstantPatternPositions(Sn)}if(!Ye&&We&&Ke&&Yt.lineAtlas){const Xr=Yt.lineAtlas.getDash(We,Ke);Xr&&yr.setConstantPatternPositions(Xr)}let[Or,Lr]=d.paint.get("line-trim-offset");(Ke==="round"||Ke==="square")&&Or!==Lr&&(Or===0&&(Or-=1),Lr===1&&(Lr+=1));const Zr=be?zt.projMatrix:null,Dn=Z?1/nr.tileToMeter/i.ar(Yt,1,g.transform.zoom):1,hi=Z?1/nr.tileToMeter/i.ar(Yt,1,Math.floor(g.transform.zoom)):1,Wi=Ye?i.c$(g,Yt,d,Zr,Ee,Dn,hi,[Or,Lr]):i.d0(g,Yt,d,Zr,nr.lineClipsArray.length,Ee,Dn,hi,[Or,Lr]);if(kt){const Xr=nr.gradients[d.id];let Sn=Xr.texture;if(d.gradientVersion!==Xr.version){let Sr=256;if(d.stepInterpolant){const In=o.getSource().maxzoom,ti=zt.canonical.z===In?Math.ceil(1<<g.transform.maxZoom-zt.canonical.z):1;Sr=i.aw(i.d1(nr.maxLineLength/i.ag*1024*ti),256,re.maxTextureSize)}Xr.gradient=i.d2({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:Sr,image:Xr.gradient||void 0,clips:nr.lineClipsArray}),Xr.texture?Xr.texture.update(Xr.gradient):Xr.texture=new i.T(re,Xr.gradient,ne.RGBA8),Xr.version=d.gradientVersion,Sn=Xr.texture}re.activeTexture.set(ne.TEXTURE1),Sn.bind(d.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ve&&(re.activeTexture.set(ne.TEXTURE0),Yt.lineAtlasTexture&&Yt.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),yr.updatePaintBuffers()),Ye&&(re.activeTexture.set(ne.TEXTURE0),Yt.imageAtlasTexture&&Yt.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),yr.updatePaintBuffers()),$t&&!Y&&g.terrain.setupElevationDraw(Yt,Wr),g.uploadCommonUniforms(re,Wr,zt.toUnwrapped());const Yn=Xr=>{jt!=null&&(jt.value=bt*z),Wr.draw(g,ne.TRIANGLES,Ct,Xr,we,Yr.disabled,Wi,d.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,d.paint,g.transform.zoom,yr,[nr.layoutVertexBuffer2,nr.patternVertexBuffer,nr.zOffsetVertexBuffer]),jt!=null&&(jt.value=bt)};if(pt&&!$t){const Xr=g.stencilModeForClipping(zt).ref;Xr===0&&be&&re.clear({stencil:0});const Sn={func:ne.EQUAL,mask:255};Wi.u_alpha_discard_threshold=.8,Yn(new Kr(Sn,Xr,255,ne.KEEP,ne.KEEP,ne.INVERT)),Wi.u_alpha_discard_threshold=0,Yn(new Kr(Sn,Xr,255,ne.KEEP,ne.KEEP,ne.KEEP))}else pt&&$t&&(Wi.u_alpha_discard_threshold=.001),Yn($t?Qt:g.stencilModeForClipping(zt))}};if(d.hasNonElevatedBuckets){const ft=!be&&g.terrain;z!==0&&ft?i.w(`Occlusion opacity for layer ${d.id} is supported on terrain only if the layer has line-z-offset enabled.`):ft?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${d.id}.`):Gt(y,dt,g.depthModeForSublayer(0,Br.ReadOnly),Kr.disabled,!1)}if(d.hasElevatedBuckets){dt.push("ELEVATED"),_e&&dt.push(me?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Y&&dt.push("ELEVATION_REFERENCE_SEA");const ft=pt?g.stencilModeFor3D():Kr.disabled,Ft=new Br(g.depthOcclusion?ne.GREATER:ne.LEQUAL,Br.ReadOnly,g.depthRangeFor3D);g.forceTerrainMode=!0,Gt(y,dt,Ft,ft,!0),g.forceTerrainMode=!1}pt&&(g.resetStencilClippingMasks(),be&&re.clear({stencil:0})),z===0||g.depthOcclusion||be||g.layersWithOcclusionOpacity.push(g.currentLayer)},fill:function(g,o,d,y){const S=d.paint.get("fill-color"),N=d.paint.get("fill-opacity"),k=d.is3D(),z=new Br(g.context.gl.LEQUAL,Br.ReadWrite,g.depthRangeFor3D);if(N.constantOr(1)===0)return;const G=d.paint.get("fill-emissive-strength"),Z=g.colorModeForDrapableLayerRenderPass(G),Y=d.paint.get("fill-pattern"),re=g.opaquePassEnabledForLayer()&&!Y.constantOr(1)&&S.constantOr(i.aj.transparent).a===1&&N.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===re){const ne=k?z:g.depthModeForSublayer(1,g.renderPass==="opaque"?Br.ReadWrite:Br.ReadOnly);od(g,o,d,y,ne,Z,!1)}if(!k&&g.renderPass==="translucent"&&d.paint.get("fill-antialias")){const ne=k?z:g.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,Br.ReadOnly);od(g,o,d,y,ne,Z,!0)}},"fill-extrusion":function(g,o,d,y){const S=d.paint.get("fill-extrusion-opacity"),N=g.context,k=N.gl,z=g.terrain,G=z&&z.renderingToTexture;if(S===0)return;const Z=g.conflationActive&&g.style.isLayerClipped(d,o.getSource()),Y=g.style.order.indexOf(d.fqid);if(Z&&function(re,ne,oe,_e,me){for(const we of _e){const be=ne.getTile(we).getBucket(oe);be&&(be.updateReplacement(we,re.replacementSource,me),be.uploadCentroid(re.context))}}(g,o,d,y,Y),z||Z)for(const re of y){const ne=o.getTile(re).getBucket(d);ne&&cd(g.context,o,re,ne,d,z,Z)}if(g.renderPass==="shadow"&&g.shadowRenderer){const re=g.shadowRenderer;if(z&&S<.65&&d._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a9)return;const ne=re.getShadowPassDepthMode(),oe=re.getShadowPassColorMode();dh(g,o,d,y,ne,Kr.disabled,oe,Z)}else if(g.renderPass==="translucent"){const re=!d.paint.get("fill-extrusion-pattern").constantOr(1),ne=d.paint.get("fill-extrusion-color").constantOr(i.aj.white);if(!G&&ne.a!==0){const oe=new Br(g.context.gl.LEQUAL,Br.ReadWrite,g.depthRangeFor3D);S===1&&re?dh(g,o,d,y,oe,Kr.disabled,An.unblended,Z):(dh(g,o,d,y,oe,Kr.disabled,An.disabled,Z),dh(g,o,d,y,oe,g.stencilModeFor3D(),g.colorModeForRenderPass(),Z),g.resetStencilClippingMasks())}if(g.style.enable3dLights()&&re&&(!z&&g.transform.projection.name!=="globe"||G)){const oe=d.paint.get("fill-extrusion-opacity"),_e=d.paint.get("fill-extrusion-ambient-occlusion-intensity"),me=d.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),we=d.paint.get("fill-extrusion-flood-light-intensity"),be=d.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ee=d.paint.get("fill-extrusion-flood-light-color").toRenderColor(be?null:d.lut).toArray01().slice(0,3),$e=_e>0&&me>0,Ve=we>0,Qe=(Ke,Ge,Ye)=>(1-Ye)*Ke+Ye*Ge,We=Ke=>{const Ge=g.depthModeForSublayer(1,Br.ReadOnly,k.LEQUAL,!0),Ye=d.paint.get(Ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),it=Qe(.1,3,Ye),bt=g._showOverdrawInspector;if(!bt){const pt=new Kr({func:k.ALWAYS,mask:255},255,255,k.KEEP,k.KEEP,k.REPLACE),kt=new An([k.ONE,k.ONE,k.ONE,k.ONE],i.aj.transparent,[!1,!1,!1,!0],k.MIN);ld(g,o,d,y,Ge,pt,kt,Yr.disabled,Ke,"sdf",oe,_e,me,we,Ee,it,Z,!1)}{const pt=bt?Kr.disabled:new Kr({func:k.EQUAL,mask:255},255,255,k.KEEP,k.DECR,k.DECR),kt=bt?g.colorModeForRenderPass():new An([k.ONE_MINUS_DST_ALPHA,k.DST_ALPHA,k.ONE,k.ONE],i.aj.transparent,[!0,!0,!0,!0]);ld(g,o,d,y,Ge,pt,kt,Yr.disabled,Ke,"color",oe,_e,me,we,Ee,it,Z,!1)}};if(G){const Ke=(Ge,Ye,it)=>{const bt=g.depthModeForSublayer(1,Br.ReadOnly,k.LEQUAL,!1),pt=d.paint.get(Ge?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),kt=Qe(.1,3,pt);{const Et=new An([k.ONE,k.ONE,k.ONE,k.ONE],i.aj.transparent,[!1,!1,!1,!0]);ld(g,o,d,y,bt,Kr.disabled,Et,Yr.disabled,Ge,"clear",oe,_e,me,we,Ee,kt,Z,Ye)}{const Et=new Kr({func:k.ALWAYS,mask:255},255,255,k.KEEP,k.KEEP,k.REPLACE),dt=new An([k.ONE,k.ONE,k.ONE,k.ONE],i.aj.transparent,[!1,!1,!1,!0],k.MIN);ld(g,o,d,y,bt,Et,dt,Yr.disabled,Ge,"sdf",oe,_e,me,we,Ee,kt,Z,Ye)}{const Et=Ge?k.ZERO:k.ONE_MINUS_DST_ALPHA,dt=new Kr({func:k.EQUAL,mask:255},255,255,k.KEEP,k.DECR,k.DECR),jt=new An([Et,k.DST_ALPHA,k.ONE_MINUS_DST_ALPHA,k.ZERO],i.aj.transparent,[!0,!0,!0,!0]);ld(g,o,d,y,bt,dt,jt,Yr.disabled,Ge,"color",oe,_e,me,we,Ee,kt,Z,Ye)}{const Et=new An([k.ONE,k.ONE,k.ONE,Ge?k.ZERO:k.ONE],i.aj.transparent,[!1,!1,!1,!0],Ge?k.FUNC_ADD:k.MAX);ld(g,o,d,y,bt,Kr.disabled,Et,Yr.disabled,Ge,"clear",oe,_e,me,we,Ee,kt,Z,Ye,it)}};if($e||Ve){let Ge;if(g.prepareDrawTile(),z){const Ye=z.drapeBufferSize[0],it=z.drapeBufferSize[1];Ge=z.framebufferCopyTexture,Ge&&(!Ge||Ge.size[0]===Ye&&Ge.size[1]===it)||(Ge&&Ge.destroy(),Ge=z.framebufferCopyTexture=new i.T(N,new i.r({width:Ye,height:it}),k.RGBA8)),Ge.bind(k.LINEAR,k.CLAMP_TO_EDGE),k.copyTexSubImage2D(k.TEXTURE_2D,0,0,0,0,0,Ye,it)}$e&&Ke(!0,!1,Ge),Ve&&Ke(!1,!0,Ge)}}else $e&&We(!0),Ve&&We(!1),($e||Ve)&&g.resetStencilClippingMasks()}}},hillshade:function(g,o,d,y){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent"||g.style.disableElevatedTerrain)return;const S=g.context,N=g.terrain&&g.terrain.renderingToTexture,[k,z]=g.renderPass!=="translucent"||N?[{},y]:g.stencilConfigForOverlap(y);for(const G of z){const Z=o.getTile(G);if(Z.needsHillshadePrepare&&g.renderPass==="offscreen")Cp(g,Z,d);else if(g.renderPass==="translucent"){const Y=g.depthModeForSublayer(0,Br.ReadOnly),re=d.paint.get("hillshade-emissive-strength"),ne=g.colorModeForDrapableLayerRenderPass(re),oe=N&&g.terrain?g.terrain.stencilModeForRTTOverlap(G):k[G.overscaledZ];pv(g,G,Z,d,Y,oe,ne)}}S.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,d,y,S,N){if(g.renderPass!=="translucent"||d.paint.get("raster-opacity")===0)return;const k=g.transform.projection.name==="globe",z=d.paint.get("raster-elevation")!==0,G=z&&k;if(g.renderElevatedRasterBackface&&!G)return;const Z=g.context,Y=Z.gl,re=o.getSource(),ne=function(We,Ke,Ge,Ye){const it=Ke.paint.get("raster-color"),bt=We.type==="raster-array",pt=[],kt=Ke.paint.get("raster-resampling"),Et=Ke.paint.get("raster-color-mix");let dt=Ke.paint.get("raster-color-range");const jt=[Et[0],Et[1],Et[2],0],Gt=Et[3];let ft=kt==="nearest"?Ye.NEAREST:Ye.LINEAR;if(bt&&(pt.push("RASTER_ARRAY"),it||pt.push("RASTER_COLOR"),kt==="linear"&&pt.push("RASTER_ARRAY_LINEAR"),ft=Ye.NEAREST,!dt&&We.rasterLayers)){const Ft=We.rasterLayers.find(({id:Ct})=>Ct===Ke.sourceLayer);Ft&&Ft.fields&&Ft.fields.range&&(dt=Ft.fields.range)}if(dt=dt||[0,1],it){pt.push("RASTER_COLOR"),Ge.activeTexture.set(Ye.TEXTURE2),Ke.updateColorRamp(dt);let Ft=Ke.colorRampTexture;Ft||(Ft=Ke.colorRampTexture=new i.T(Ge,Ke.colorRamp,Ye.RGBA8)),Ft.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE)}return{mix:jt,range:dt,offset:Gt,defines:pt,resampling:ft}}(re,d,Z,Y);if(re instanceof i.aJ&&!y.length&&!k)return;const oe=d.paint.get("raster-emissive-strength"),_e=g.colorModeForDrapableLayerRenderPass(oe),me=g.terrain&&g.terrain.renderingToTexture,we=!g.options.moving,be=d.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;if(re instanceof i.aJ&&!y.length&&(re.onNorthPole||re.onSouthPole)){const We=z?g.stencilModeFor3D():Kr.disabled;return void _t(!!re.onNorthPole,null,g,o,d,oe,ne,Yr.disabled,We)}if(!y.length)return;const[Ee,$e]=re instanceof i.aJ||me?[{},y]:g.stencilConfigForOverlap(y),Ve=$e[$e.length-1].overscaledZ;G&&ne.defines.push("PROJECTION_GLOBE_VIEW"),z&&ne.defines.push("RENDER_CUTOFF");const Qe=(We,Ke,Ge)=>{for(const Ye of We){const it=Ye.toUnwrapped(),bt=o.getTile(Ye);if(me&&(!bt||!bt.hasData()))continue;Z.activeTexture.set(Y.TEXTURE0);const pt=lc(bt,re,d,ne);if(!pt||!pt.texture)continue;const{texture:kt,mix:Et,offset:dt,tileSize:jt,buffer:Gt}=pt;let ft,Ft;me?(ft=Br.disabled,Ft=Ye.projMatrix):z?(ft=new Br(Y.LEQUAL,Br.ReadWrite,g.depthRangeFor3D),Ft=k?Float32Array.from(g.transform.expandedFarZProjMatrix):g.transform.calculateProjMatrix(it,we)):(ft=g.depthModeForSublayer(Ye.overscaledZ-Ve,d.paint.get("raster-opacity")===1?Br.ReadWrite:Br.ReadOnly,Y.LESS),Ft=g.transform.calculateProjMatrix(it,we));const Ct=g.terrain&&me?g.terrain.stencilModeForRTTOverlap(Ye):Ee[Ye.overscaledZ],Qt=N?0:d.paint.get("raster-fade-duration");bt.registerFadeDuration(Qt);const $t=o.findLoadedParent(Ye,0),zt=Fl(bt,$t,o,g.transform,Qt);let Yt,nr;g.terrain&&g.terrain.prepareDrawTile(),Z.activeTexture.set(Y.TEXTURE0),kt.bind(be,Y.CLAMP_TO_EDGE),Z.activeTexture.set(Y.TEXTURE1),$t?($t.texture&&$t.texture.bind(be,Y.CLAMP_TO_EDGE),Yt=Math.pow(2,$t.tileID.overscaledZ-bt.tileID.overscaledZ),nr=[bt.tileID.canonical.x*Yt%1,bt.tileID.canonical.y*Yt%1]):kt.bind(be,Y.CLAMP_TO_EDGE),kt.useMipmap&&Z.extTextureFilterAnisotropic&&g.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax);const yr=g.transform;let _r;const Wr=z?Dc(yr):[0,0,0,0];let Or,Lr,Zr,Dn,hi,Wi=0;if(G&&re instanceof i.aJ&&re.coordinates.length>3)Or=Float32Array.from(i.bb(i.cH(new i.bT(0,0,0)))),Lr=Float32Array.from(yr.globeMatrix),Zr=Float32Array.from(i.cD(yr)),Dn=[i.at(yr.center.lng),i.aA(yr.center.lat)],_r=re.elevatedGlobePerspectiveTransform,hi=re.elevatedGlobeGridMatrix||new Float32Array(9);else if(G){const Sr=i.cE(Ye.canonical);Wi=i.cF(Sr.getCenter().lat),Or=Float32Array.from(i.bb(i.cH(Ye.canonical))),Lr=Float32Array.from(yr.globeMatrix),Zr=Float32Array.from(i.cD(yr)),Dn=[i.at(yr.center.lng),i.aA(yr.center.lat)],_r=[0,0],hi=Float32Array.from(i.cG(Ye.canonical,Sr,Wi,yr.worldSize/yr._pixelsPerMercatorPixel))}else _r=re instanceof i.aJ?re.perspectiveTransform:[0,0],Or=new Float32Array(16),Lr=new Float32Array(9),Zr=new Float32Array(16),Dn=[0,0],hi=new Float32Array(9);const Yn=fo(Ft,Or,Lr,Zr,hi,nr||[0,0],i.ae(g.transform.zoom),Dn,Wr,Yt||1,zt,d,_r,z?d.paint.get("raster-elevation"):0,2,Et,dt,ne.range,jt,Gt,oe),Xr=g.isTileAffectedByFog(Ye),Sn=g.getOrCreateProgram("raster",{defines:ne.defines,overrideFog:Xr});if(g.uploadCommonUniforms(Z,Sn,it),re instanceof i.aJ){const Sr=re.elevatedGlobeVertexBuffer,In=re.elevatedGlobeIndexBuffer;if(me||!k)re.boundsBuffer&&re.boundsSegments&&Sn.draw(g,Y.TRIANGLES,ft,Kr.disabled,_e,Yr.disabled,Yn,d.id,re.boundsBuffer,g.quadTriangleIndexBuffer,re.boundsSegments);else if(Sr&&In){const ti=yr.zoom<=i.c6?re.elevatedGlobeSegments:re.getSegmentsForLongitude(yr.center.lng);ti&&Sn.draw(g,Y.TRIANGLES,ft,Kr.disabled,_e,Ke,Yn,d.id,Sr,In,ti)}}else if(G){ft=new Br(Y.LEQUAL,Br.ReadOnly,g.depthRangeFor3D);const Sr=g.globeSharedBuffers;if(Sr){const[In,ti,oi]=Sr.getGridBuffers(Wi,!1);Sn.draw(g,Y.TRIANGLES,ft,Ge||Ct,g.colorModeForRenderPass(),Ke,Yn,d.id,In,ti,oi)}}else{const{tileBoundsBuffer:Sr,tileBoundsIndexBuffer:In,tileBoundsSegments:ti}=g.getTileBoundsBuffers(bt);Sn.draw(g,Y.TRIANGLES,ft,Ct,_e,Yr.disabled,Yn,d.id,Sr,In,ti)}}if(!(re instanceof i.aJ)&&G)for(const Ye of We){const it=Ye.canonical.y===(1<<Ye.canonical.z)-1;Ye.canonical.y===0&&_t(!0,Ye,g,o,d,oe,ne,Ke,Ge||Kr.disabled),it&&_t(!1,Ye,g,o,d,oe,ne,Ke===Yr.frontCW?Yr.backCW:Yr.frontCW,Ge||Kr.disabled)}};G?Qe($e,g.renderElevatedRasterBackface?Yr.backCW:Yr.frontCW,g.stencilModeFor3D()):Qe($e,Yr.disabled,void 0),g.resetStencilClippingMasks()},"raster-particle":function(g,o,d,y,S,N){g.renderPass==="offscreen"&&function(k,z,G,Z){if(!Z.length)return;const Y=k.context,re=Y.gl,ne=z.getSource();if(!(ne instanceof $a))return;const oe=Math.ceil(Math.sqrt(G.paint.get("raster-particle-count")));let _e=G.particlePositionRGBAImage;if(!_e||_e.width!==oe){const $e=function(Ve){const Qe=Ve*Ve,We=new Uint8Array(4*Qe),Ke=function(Ye){return Ye|=0,Ye=Math.imul(2747636419^Ye,2654435769),Ye=Math.imul(Ye^Ye>>>16,2654435769),((Ye=Math.imul(Ye^Ye>>>16,2654435769))>>>0)/4294967296},Ge=1/1.1;for(let Ye=0;Ye<Qe;Ye++){const it=Ge*(Ke(2*Ye+0)+Er),bt=Ge*(Ke(2*Ye+1)+Er),pt=255*it%1,kt=255*bt%1,Et=pt,dt=bt-kt/255,jt=kt;We[4*Ye+0]=255*(it-pt/255),We[4*Ye+1]=255*Et,We[4*Ye+2]=255*dt,We[4*Ye+3]=255*jt}return We}(oe);_e=G.particlePositionRGBAImage=new i.r({width:oe,height:oe},$e)}let me=G.particleFramebuffer;me?me.width!==oe&&(me.destroy(),me=G.particleFramebuffer=Y.createFramebuffer(oe,oe,!0,null)):me=G.particleFramebuffer=Y.createFramebuffer(oe,oe,!0,null);const we=[];for(const $e of Z){const Ve=z.getTile($e);if(!(Ve instanceof eu))continue;const Qe=Lc(Ve,ne,G);if(!Qe)continue;const We=[Ve.tileSize,Ve.tileSize];let Ke=G.tileFramebuffer;Ke||(Ke=G.tileFramebuffer=Y.createFramebuffer(We[0],We[1],!0,null));let Ge=Ve.rasterParticleState;Ge||(Ge=Ve.rasterParticleState=new zy(Y,$e,We,_e));const Ye=Ge.update(G.lastInvalidatedAt);Ge.particleTextureDimension!==oe&&Ge.updateParticleTexture($e,_e);const it=Ge.targetColorTexture;Ge.targetColorTexture=Ge.backgroundColorTexture,Ge.backgroundColorTexture=it;const bt=Ge.particleTexture0;Ge.particleTexture0=Ge.particleTexture1,Ge.particleTexture1=bt,we.push([$e,Qe,Ge,Ye])}if(we.length===0)return;const be=i.q.now(),Ee=G.previousDrawTimestamp?.001*(be-G.previousDrawTimestamp):.0167;if(G.previousDrawTimestamp=be,G.hasColorMap()){Y.activeTexture.set(re.TEXTURE0+2);let $e=G.colorRampTexture;$e||($e=G.colorRampTexture=new i.T(Y,G.colorRamp,re.RGBA8)),$e.bind(re.LINEAR,re.CLAMP_TO_EDGE)}Y.bindFramebuffer.set(G.tileFramebuffer.framebuffer),function($e,Ve,Qe){const We=$e.context,Ke=We.gl,Ge=Ve.tileFramebuffer;We.activeTexture.set(Ke.TEXTURE0);const Ye={u_texture:0,u_opacity:1.05*(bt=Ve.paint.get("raster-particle-fade-opacity-factor"))/(bt+.05)},it=$e.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var bt;for(const pt of Qe){const[,,kt,Et]=pt;Ge.colorAttachment.set(kt.targetColorTexture.texture),We.viewport.set([0,0,Ge.width,Ge.height]),We.clear({color:i.aj.transparent}),Et&&(kt.backgroundColorTexture.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE),it.draw($e,Ke.TRIANGLES,Br.disabled,Kr.disabled,An.alphaBlended,Yr.disabled,Ye,Ve.id,$e.viewportBuffer,$e.quadTriangleIndexBuffer,$e.viewportSegments))}}(k,G,we),function($e,Ve,Qe,We){const Ke=$e.context,Ge=Ke.gl,Ye=Qe.tileFramebuffer,it=$e.transform.projection.name==="globe",bt=Qe.paint.get("raster-particle-max-speed");for(const pt of We){const[kt,Et,dt]=pt;Ke.activeTexture.set(Ge.TEXTURE0+0),Et.texture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),Ye.colorAttachment.set(dt.targetColorTexture.texture);const jt=$e.getOrCreateProgram("rasterParticleDraw",{defines:Et.defines,overrideFog:!1});Ke.activeTexture.set(Ge.TEXTURE0+1);const Gt=Et.scalarData?[]:[0,1,2,3].map(Ct=>i.d4[Ct](kt));Gt.push(kt);const ft=kt.canonical.x,Ft=kt.canonical.y;for(const Ct of Gt){const Qt=Ve.getTile(it?Ct.wrapped():Ct);if(!Qt)continue;const $t=Qt.rasterParticleState;if(!$t)continue;const zt=Ct.canonical.x+(1<<Ct.canonical.z)*(Ct.wrap-kt.wrap),Yt=Ct.canonical.y;$t.particleTexture0.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE);const nr=Iy(1,$t.particleTexture0.size[0],[zt-ft,Yt-Ft],0,Et.texture.size,2,bt,Et.textureOffset,Et.scale,Et.offset);jt.draw($e,Ge.POINTS,Br.disabled,Kr.disabled,An.alphaBlended,Yr.disabled,nr,Qe.id,$t.particleIndexBuffer,void 0,$t.particleSegment)}}}(k,z,G,we),Y.bindFramebuffer.set(G.particleFramebuffer.framebuffer),function($e,Ve,Qe,We){const Ke=$e.context,Ge=Ke.gl,Ye=Ve.paint.get("raster-particle-max-speed"),it=We*Ve.paint.get("raster-particle-speed-factor")*.15,bt=function(kt){return Math.pow(kt,6)}(.01+1*Ve.paint.get("raster-particle-reset-rate-factor")),pt=Ve.particleFramebuffer;Ke.viewport.set([0,0,pt.width,pt.height]);for(const kt of Qe){const[,Et,dt]=kt;Ke.activeTexture.set(Ge.TEXTURE0+0),Et.texture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),Ke.activeTexture.set(Ge.TEXTURE0+1);const jt=dt.particleTexture0;jt.bind(Ge.NEAREST,Ge.CLAMP_TO_EDGE);const Gt=xl(1,jt.size[0],0,Et.texture.size,Ye,it,bt,Et.textureOffset,Et.scale,Et.offset);pt.colorAttachment.set(dt.particleTexture1.texture),Ke.clear({color:i.aj.transparent}),$e.getOrCreateProgram("rasterParticleUpdate",{defines:Et.defines}).draw($e,Ge.TRIANGLES,Br.disabled,Kr.disabled,An.unblended,Yr.disabled,Gt,Ve.id,$e.viewportBuffer,$e.quadTriangleIndexBuffer,$e.viewportSegments)}}(k,G,we,Ee)}(g,o,d,y),g.renderPass==="translucent"&&(function(k,z,G,Z,Y){const re=k.context,ne=re.gl,oe=z.getSource().tileSize,_e=5*(1-i.ac(i.bY,i.bY+1,k.transform.zoom))*oe+G.paint.get("raster-particle-elevation"),me=!k.options.moving,we=k.transform.projection.name==="globe";if(!Z.length)return;const[be,Ee]=k.stencilConfigForOverlap(Z),$e=[];we&&$e.push("PROJECTION_GLOBE_VIEW");const Ve=k.stencilModeFor3D();for(const Qe of Ee){const We=Qe.toUnwrapped(),Ke=z.getTile(Qe);if(!Ke.rasterParticleState)continue;const Ge=Ke.rasterParticleState,Ye=100;Ke.registerFadeDuration(Ye);const it=z.findLoadedParent(Qe,0),bt=Fl(Ke,it,z,k.transform,Ye);let pt,kt;k.terrain&&k.terrain.prepareDrawTile(),re.activeTexture.set(ne.TEXTURE0),Ge.targetColorTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),re.activeTexture.set(ne.TEXTURE1),it&&it.rasterParticleState?(it.rasterParticleState.targetColorTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),pt=Math.pow(2,it.tileID.overscaledZ-Ke.tileID.overscaledZ),kt=[Ke.tileID.canonical.x*pt%1,Ke.tileID.canonical.y*pt%1]):Ge.targetColorTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);const Et=we?Float32Array.from(k.transform.expandedFarZProjMatrix):k.transform.calculateProjMatrix(We,me),dt=k.transform,jt=fu(dt),Gt=i.cE(Qe.canonical),ft=i.cF(Gt.getCenter().lat);let Ft,Ct,Qt,$t,zt;we?(Ft=Float32Array.from(i.bb(i.cH(Qe.canonical))),Ct=Float32Array.from(dt.globeMatrix),Qt=Float32Array.from(i.cD(dt)),$t=[i.at(dt.center.lng),i.aA(dt.center.lat)],zt=Float32Array.from(i.cG(Qe.canonical,Gt,ft,dt.worldSize/dt._pixelsPerMercatorPixel))):(Ft=new Float32Array(16),Ct=new Float32Array(9),Qt=new Float32Array(16),$t=[0,0],zt=new Float32Array(9));const Yt=Dp(Et,Ft,Ct,Qt,zt,kt||[0,0],i.ae(k.transform.zoom),$t,jt,pt||1,bt,_e),nr=k.isTileAffectedByFog(Qe),yr=k.getOrCreateProgram("rasterParticle",{defines:$e,overrideFog:nr});if(k.uploadCommonUniforms(re,yr,We),we){const _r=new Br(ne.LEQUAL,Br.ReadOnly,k.depthRangeFor3D),Wr=0,Or=k.globeSharedBuffers;if(Or){const[Lr,Zr,Dn]=Or.getGridBuffers(ft,Wr!==0);yr.draw(k,ne.TRIANGLES,_r,Ve,An.alphaBlended,k.renderElevatedRasterBackface?Yr.frontCCW:Yr.backCCW,Yt,G.id,Lr,Zr,Dn)}}else{const _r=k.depthModeForSublayer(0,Br.ReadOnly),Wr=be[Qe.overscaledZ],{tileBoundsBuffer:Or,tileBoundsIndexBuffer:Lr,tileBoundsSegments:Zr}=k.getTileBoundsBuffers(Ke);yr.draw(k,ne.TRIANGLES,_r,Wr,An.alphaBlended,Yr.disabled,Yt,G.id,Or,Lr,Zr)}}k.resetStencilClippingMasks()}(g,o,d,y),g.style.map.triggerRepaint())},background:function(g,o,d,y){const S=d.paint.get("background-color"),N=d.paint.get("background-color-use-theme").constantOr("default")==="none",k=d.paint.get("background-opacity"),z=d.paint.get("background-emissive-strength"),G=d.paint.get("background-pitch-alignment")==="viewport";if(k===0)return;const Z=g.context,Y=Z.gl,re=g.transform,ne=re.tileSize,oe=d.paint.get("background-pattern");let _e;if(oe!==void 0&&(oe===null||(_e=g.imageManager.getPattern(oe.toString(),d.scope,g.style.getLut(d.scope)),!_e)))return;const me=!oe&&S.a===1&&k===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==me)return;const we=Kr.disabled,be=g.depthModeForSublayer(0,me==="opaque"?Br.ReadWrite:Br.ReadOnly),Ee=g.colorModeForDrapableLayerRenderPass(z),$e=oe?"backgroundPattern":"background";let Ve,Qe=y;if(Qe||(Ve=g.getBackgroundTiles(),Qe=Object.values(Ve).map(We=>We.tileID)),oe&&(Z.activeTexture.set(Y.TEXTURE0),g.imageManager.bind(g.context,d.scope)),G){const We=g.getOrCreateProgram($e,{overrideFog:!1,overrideRtt:!0}),Ke=new Float32Array(i.ab.mat4.identity([])),Ge=new i.aG(0,0,0,0,0),Ye=oe?Dy(Ke,z,k,g,0,d.scope,_e,G,{tileID:Ge,tileSize:ne}):_l(Ke,z,k,S.toRenderColor(N?null:d.lut));We.draw(g,Y.TRIANGLES,be,we,Ee,Yr.disabled,Ye,d.id,g.viewportBuffer,g.quadTriangleIndexBuffer,g.viewportSegments)}else for(const We of Qe){const Ke=g.isTileAffectedByFog(We),Ge=g.getOrCreateProgram($e,{overrideFog:Ke}),Ye=We.toUnwrapped(),it=y?We.projMatrix:g.transform.calculateProjMatrix(Ye);g.prepareDrawTile();const bt=o?o.getTile(We):Ve?Ve[We.key]:new Tc(We,ne,re.zoom,g),pt=oe?Dy(it,z,k,g,0,d.scope,_e,G,{tileID:We,tileSize:ne}):_l(it,z,k,S.toRenderColor(N?null:d.lut));g.uploadCommonUniforms(Z,Ge,Ye);const{tileBoundsBuffer:kt,tileBoundsIndexBuffer:Et,tileBoundsSegments:dt}=g.getTileBoundsBuffers(bt);Ge.draw(g,Y.TRIANGLES,be,we,Ee,Yr.disabled,pt,d.id,kt,Et,dt)}},sky:function(g,o,d){const y=g._atmosphere?i.ae(g.transform.zoom):1,S=d.paint.get("sky-opacity")*y;if(S===0)return;const N=g.context,k=d.paint.get("sky-type"),z=new Br(N.gl.LEQUAL,Br.ReadOnly,[0,1]),G=g.frameCounter/1e3%1;k==="atmosphere"?g.renderPass==="offscreen"?d.needsSkyboxCapture(g)&&(function(Z,Y,re,ne){const oe=Z.context,_e=oe.gl;let me=Y.skyboxFbo;if(!me){me=Y.skyboxFbo=oe.createFramebuffer(32,32,!0,null),Y.skyboxGeometry=new ng(oe),Y.skyboxTexture=oe.gl.createTexture(),_e.bindTexture(_e.TEXTURE_CUBE_MAP,Y.skyboxTexture),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_CUBE_MAP,_e.TEXTURE_MAG_FILTER,_e.LINEAR);for(let $e=0;$e<6;++$e)_e.texImage2D(_e.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,_e.RGBA,32,32,0,_e.RGBA,_e.UNSIGNED_BYTE,null)}oe.bindFramebuffer.set(me.framebuffer),oe.viewport.set([0,0,32,32]);const we=Y.getCenter(Z,!0),be=Z.getOrCreateProgram("skyboxCapture"),Ee=new Float64Array(16);i.ab.mat4.identity(Ee),i.ab.mat4.rotateY(Ee,Ee,.5*-Math.PI),pi(Z,Y,be,Ee,we,0),i.ab.mat4.identity(Ee),i.ab.mat4.rotateY(Ee,Ee,.5*Math.PI),pi(Z,Y,be,Ee,we,1),i.ab.mat4.identity(Ee),i.ab.mat4.rotateX(Ee,Ee,.5*-Math.PI),pi(Z,Y,be,Ee,we,2),i.ab.mat4.identity(Ee),i.ab.mat4.rotateX(Ee,Ee,.5*Math.PI),pi(Z,Y,be,Ee,we,3),i.ab.mat4.identity(Ee),pi(Z,Y,be,Ee,we,4),i.ab.mat4.identity(Ee),i.ab.mat4.rotateY(Ee,Ee,Math.PI),pi(Z,Y,be,Ee,we,5),oe.viewport.set([0,0,Z.width,Z.height])}(g,d),d.markSkyboxValid(g)):g.renderPass==="sky"&&function(Z,Y,re,ne,oe){const _e=Z.context,me=_e.gl,we=Z.transform,be=Z.getOrCreateProgram("skybox");_e.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_CUBE_MAP,Y.skyboxTexture);const Ee=(($e,Ve,Qe,We,Ke)=>({u_matrix:$e,u_sun_direction:Ve,u_cubemap:0,u_opacity:We,u_temporal_offset:Ke}))(we.skyboxMatrix,Y.getCenter(Z,!1),0,ne,oe);Z.uploadCommonUniforms(_e,be),be.draw(Z,me.TRIANGLES,re,Kr.disabled,Z.colorModeForRenderPass(),Yr.backCW,Ee,"skybox",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(g,d,z,S,G):k==="gradient"&&g.renderPass==="sky"&&function(Z,Y,re,ne,oe){const _e=Z.context,me=_e.gl,we=Z.transform,be=Z.getOrCreateProgram("skyboxGradient");Y.skyboxGeometry||(Y.skyboxGeometry=new ng(_e)),_e.activeTexture.set(me.TEXTURE0);let Ee=Y.colorRampTexture;Ee||(Ee=Y.colorRampTexture=new i.T(_e,Y.colorRamp,me.RGBA8)),Ee.bind(me.LINEAR,me.CLAMP_TO_EDGE);const $e=((Ve,Qe,We,Ke,Ge)=>({u_matrix:Ve,u_color_ramp:0,u_center_direction:Qe,u_radius:i.ai(We),u_opacity:Ke,u_temporal_offset:Ge}))(we.skyboxMatrix,Y.getCenter(Z,!1),Y.paint.get("sky-gradient-radius"),ne,oe);Z.uploadCommonUniforms(_e,be),be.draw(Z,me.TRIANGLES,re,Kr.disabled,Z.colorModeForRenderPass(),Yr.backCW,$e,"skyboxGradient",Y.skyboxGeometry.vertexBuffer,Y.skyboxGeometry.indexBuffer,Y.skyboxGeometry.segment)}(g,d,z,S,G)},debug:function(g,o,d,y,S,N){for(let k=0;k<d.length;k++)if(S){const Z=new i.aj(y.r*.8,y.g*.8,y.b*.8,1);Qs(g,o,d[k],y,-1,-1,N),Qs(g,o,d[k],y,-1,1,N),Qs(g,o,d[k],y,1,1,N),Qs(g,o,d[k],y,1,-1,N),Qs(g,o,d[k],Z,0,0,N)}else Qs(g,o,d[k],y,0,0,N)},custom:function(g,o,d,y){const S=g.context,N=d.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&d.isDraped(o)){if(g.renderPass==="offscreen"){const k=N.prerender;if(k){if(g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const z=g.transform.pointMerc;k.call(N,S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[z.x,z.y],g.transform.pixelsPerMeterRatio)}else k.call(N,S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const z=N.renderToTile;if(z){const G=y[0].canonical,Z=new i.aa(G.x+y[0].wrap*(1<<G.z),G.y,G.z);S.setDepthMode(Br.disabled),S.setStencilMode(Kr.disabled),S.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),z.call(N,S.gl,Z),S.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),S.setColorMode(g.colorModeForRenderPass()),S.setStencilMode(Kr.disabled);const k=N.renderingMode==="3d"?new Br(g.context.gl.LEQUAL,Br.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,Br.ReadOnly);if(S.setDepthMode(k),g.transform.projection.name==="globe"){const z=g.transform.pointMerc;N.render(S.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),i.ae(g.transform.zoom),[z.x,z.y],g.transform.pixelsPerMeterRatio)}else N.render(S.gl,g.transform.customLayerMatrix());S.setDirty(),g.setBaseState(),S.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(g,o,d,y){if(g.renderPass==="opaque")return;const S=d.paint.get("model-opacity").constantOr(1);if(S===0)return;const N=d.paint.get("model-cast-shadows");if(g.renderPass==="shadow"&&(!N||g.terrain&&S<.65&&d._transitionablePaint._values["model-opacity"].value.expression instanceof i.a9))return;const k=g.shadowRenderer,z=d.paint.get("model-receive-shadows");k&&(k.useNormalOffset=!0,z||(k.enabled=!1));const G=()=>{k&&(k.useNormalOffset=!0,z||(k.enabled=!0))},Z=o.getSource();if(g.renderPass==="light-beam"&&Z.type!=="batched-model")return;if(Z.type==="vector"||Z.type==="geojson")return function(be,Ee,$e,Ve,Qe){const We=be.transform;if(We.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${We.projection.name} projection is not yet implemented`);const Ke=We.getFreeCameraOptions().position;if(!be.modelManager)return;const Ge=be.modelManager;$e.modelManager=Ge;const Ye=be.shadowRenderer;if(!$e._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const it=$e._unevaluatedLayout._values["model-id"],bt=Object.assign({},$e.layout.get("model-id").parameters),pt=be.style.order.indexOf($e.fqid);for(const kt of Ve){const Et=Ee.getTile(kt).getBucket($e);if(!Et||Et.projection.name!==We.projection.name)continue;const dt=Et.getModelUris();dt&&!Et.modelsRequested&&(Ge.addModelsFromBucket(dt,Qe),Et.modelsRequested=!0);const jt=sg(kt,We);bt.zoom=jt;const Gt=it.possiblyEvaluate(bt);if(Qo(be,Et,kt),is.shadowUniformsInitialized=!1,is.useSingleShadowCascade=!!Ye&&Ye.getMaxCascadeForTile(kt.toUnwrapped())===0,be.renderPass==="shadow"&&Ye){if(be.currentShadowCascade===1&&Et.isInsideFirstShadowMapFrustum)continue;const Ct=We.calculatePosMatrix(kt.toUnwrapped(),We.worldSize);if(is.tileMatrix.set(Ct),is.shadowTileMatrix=Float32Array.from(Ye.calculateShadowPassMatrixFromMatrix(Ct)),is.aabb.min.fill(0),is.aabb.max[0]=is.aabb.max[1]=i.ag,is.aabb.max[2]=0,Vp(Et,is,be,$e.scope))continue}const ft=1<<kt.canonical.z,Ft=[((Ke.x-kt.wrap)*ft-kt.canonical.x)*i.ag,(Ke.y*ft-kt.canonical.y)*i.ag,Ke.z*ft*i.ag];be.conflationActive&&Object.keys(Et.instancesPerModel).length>0&&be.style.isLayerClipped($e,Ee.getSource())&&Et.updateReplacement(kt,be.replacementSource,pt,Qe)&&(Et.uploaded=!1,Et.upload(be.context));for(let Ct in Et.instancesPerModel){const Qt=Et.instancesPerModel[Ct];Qt.features.length>0&&(Ct=Gt.evaluate(Qt.features[0].feature,{}));const $t=Ge.getModel(Ct,Qe);if($t&&$t.uploaded)for(const zt of $t.nodes)xs(be,$e,zt,Qt,Ft,kt,is)}}}(g,o,d,y,Z.type==="vector"?d.scope:""),void G();if(!Z.loaded())return;if(Z.type==="batched-model")return function(be,Ee,$e,Ve){$e.resetLayerRenderingStats(be);const Qe=be.context,We=be.transform,Ke=be.style.fog,Ge=be.shadowRenderer;if(We.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${We.projection.name} projection is not yet implemented`);const Ye=be.transform.getFreeCameraOptions().position,it=i.ab.vec3.scale([],[Ye.x,Ye.y,Ye.z],be.transform.worldSize),bt=i.ab.vec3.negate([],it),pt=i.ab.mat4.identity([]),kt=i.dj(We.center.lat,We.zoom),Et=i.ab.mat4.fromScaling([],[1,1,1/kt]);i.ab.mat4.translate(pt,pt,bt);const dt=$e.paint.get("model-opacity").constantOr(1),jt=new Br(Qe.gl.LEQUAL,Br.ReadWrite,be.depthRangeFor3D),Gt=new Br(Qe.gl.LEQUAL,Br.ReadOnly,be.depthRangeFor3D),ft=new i.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Ft=be.renderPass==="shadow",Ct=Ft&&Ge?Ge.getCurrentCascadeFrustum():We.getFrustum(We.scaleZoom(We.worldSize)),Qt=$e.paint.get("model-front-cutoff"),$t=Qt[2]<1,zt=Il(be,$e.paint.get("model-cutoff-fade-range")),Yt=$e.getLayerRenderingStats();(function(nr,yr,_r,Wr){const Or=nr.terrain?nr.terrain.exaggeration():0,Lr=nr.transform.zoom;for(const Zr of Wr){const Dn=yr.getTile(Zr).getBucket(_r);Dn&&(nr.conflationActive&&Dn.updateReplacement(Zr,nr.replacementSource),Dn.evaluateScale(nr,_r),nr.terrain&&Or>0&&Dn.elevationUpdate(nr.terrain,Or,Zr,_r.source),Dn.needsReEvaluation(nr,Lr,_r)&&Dn.evaluate(_r))}})(be,Ee,$e,Ve),function(){let nr,yr,_r;$t?(nr=Ve.length-1,yr=-1,_r=-1):(nr=0,yr=Ve.length,_r=1);const Wr=new Float64Array(16),Or=i.ab.vec3.create(),Lr=new i.P(0,0);for(let Zr=nr;Zr!==yr;Zr+=_r){const Dn=Ve[Zr],hi=Ee.getTile(Dn).getBucket($e);if(!hi||!hi.uploaded)continue;let Wi=!1;Ge&&(Wi=Ge.getMaxCascadeForTile(Dn.toUnwrapped())===0);const Yn=We.calculatePosMatrix(Dn.toUnwrapped(),We.worldSize),Xr=hi.modelTraits;!Ft&&$t&&(i.ab.mat4.invert(Wr,Yn),i.ab.vec3.transformMat4(Or,it,Wr),Lr.x=Or[0],Lr.y=Or[1]);const Sn=[];for(const Sr of hi.getNodesInfo()){if(Sr.hiddenByReplacement||!Sr.node.meshes)continue;const In=Sr.node;let ti=0;be.terrain&&In.elevation&&(ti=In.elevation*be.terrain.exaggeration());const oi=(()=>{const zn=Sr.aabb;return ft.min=[...zn.min],ft.max=[...zn.max],ft.min[2]+=ti,ft.max[2]+=ti,i.ab.vec3.transformMat4(ft.min,ft.min,Yn),i.ab.vec3.transformMat4(ft.max,ft.max,Yn),ft})(),ea=Sr.evaluatedScale;if(ea[0]<=1&&ea[1]<=1&&ea[2]<=1&&oi.intersects(Ct)===0)continue;if(!Ft&&$t){const zn=.16666666666666666;Sr.cameraCollisionOpacity=it[0]>oi.min[0]&&it[0]<oi.max[0]&&it[1]>oi.min[1]&&it[1]<oi.max[1]&&it[2]*kt<oi.max[2]&&In.footprint&&i.bA(Lr,In.footprint)?Math.max(Sr.cameraCollisionOpacity-zn,0):Math.min(1,Sr.cameraCollisionOpacity+zn)}const aa=[...Yn],Ea=In.anchor?In.anchor[0]:0,Sa=In.anchor?In.anchor[1]:0;i.ab.mat4.translate(aa,aa,[Ea*(ea[0]-1),Sa*(ea[1]-1),ti]),i.ab.vec3.exactEquals(ea,i.dm)||i.ab.mat4.scale(aa,aa,ea);const Is=i.ab.mat4.multiply([],aa,In.matrix),Ds=i.ab.mat4.multiply([],We.expandedFarZProjMatrix,Is),Mi=i.ab.mat4.multiply([],We.expandedFarZProjMatrix,aa),Ni=i.ab.vec4.transformMat4([],[Ea,Sa,ti,1],Ds)[2];In.hidden=!1;let wi=dt;Ft||($t&&(wi*=Sr.cameraCollisionOpacity,wi*=Ul(aa,We,Sr.aabb,Qt)),wi*=mu(zt,Ni)),wi!==0?Sn.push({nodeInfo:Sr,depth:Ni,opacity:wi,wvpForNode:Ds,wvpForTile:Mi,nodeModelMatrix:Is,tileModelMatrix:aa}):In.hidden=!0}Ft||Sn.sort((Sr,In)=>!$t||Sr.opacity===1&&In.opacity===1?Sr.depth<In.depth?-1:1:Sr.opacity===1?-1:In.opacity===1?1:Sr.depth>In.depth?-1:1);for(const Sr of Sn){const In=Sr.nodeInfo,ti=In.node;let oi=i.ab.mat4.multiply([],Et,Sr.tileModelMatrix);i.ab.mat4.multiply(oi,pt,oi);const ea=i.ab.mat4.invert([],oi);i.ab.mat4.transpose(ea,ea),i.ab.mat4.scale(ea,ea,Bp),oi=i.ab.mat4.multiply(oi,oi,ti.matrix);const aa=be.renderPass==="light-beam",Ea=$e.paint.get("model-color-use-theme").constantOr("default")==="none",Sa=Xr&i.dp.HasMapboxMeshFeatures,Is=Sa?0:In.evaluatedRMEA[0][2];for(let Ds=0;Ds<ti.meshes.length;++Ds){const Mi=ti.meshes[Ds],Ni=Ds===ti.lightMeshIndex;let wi=Sr.wvpForNode;if(Ni){if(!aa&&!be.terrain&&be.shadowRenderer){be.currentLayer<be.firstLightBeamLayer&&(be.firstLightBeamLayer=be.currentLayer);continue}wi=Sr.wvpForTile}else if(aa)continue;const zn={defines:[]},sa=[];if(!Ft&&Ge&&(Ge.useNormalOffset=!!Mi.normalBuffer),ia(zn.defines,sa,Mi,be,Ea?null:$e.lut),Sa||zn.defines.push("DIFFUSE_SHADED"),Wi&&zn.defines.push("SHADOWS_SINGLE_CASCADE"),Yt&&(Ft?Yt.numRenderedVerticesInShadowPass+=Mi.vertexArray.length:Yt.numRenderedVerticesInTransparentPass+=Mi.vertexArray.length),Ft){hd(Mi,Sr.nodeModelMatrix,be,$e);continue}let as=null;if(Ke){const Io=Mo(Sr.nodeModelMatrix,be.transform);if(as=new Float32Array(Io),We.projection.name!=="globe"){const Tl=Mi.aabb.min,Oi=Mi.aabb.max,[wh,dc]=Ke.getOpacityForBounds(Io,Tl[0],Tl[1],Oi[0],Oi[1]);zn.overrideFog=wh>=Je||dc>=Je}}const ji=Mi.material;let $s;ji.occlusionTexture&&ji.occlusionTexture.offsetScale&&($s=ji.occlusionTexture.offsetScale,zn.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Al=be.getOrCreateProgram("model",zn);!Ft&&Ge&&Ge.setupShadowsFromMatrix(Sr.tileModelMatrix,Al,Ge.useNormalOffset),be.uploadCommonUniforms(Qe,Al,null,as);const bs=ji.pbrMetallicRoughness;bs.metallicFactor=.9,bs.roughnessFactor=.5;const Ro=lh(new Float32Array(wi),new Float32Array(oi),new Float32Array(ea),new Float32Array(ti.matrix),be,Sr.opacity,bs.baseColorFactor.toRenderColor(null),ji.emissiveFactor,bs.metallicFactor,bs.roughnessFactor,ji,Is,$e,[0,0,0],$s);!Ni&&(In.hasTranslucentParts||Sr.opacity<1)&&Al.draw(be,Qe.gl.TRIANGLES,jt,Kr.disabled,An.disabled,Yr.backCCW,Ro,$e.id,Mi.vertexBuffer,Mi.indexBuffer,Mi.segments,$e.paint,be.transform.zoom,void 0,sa),Al.draw(be,Qe.gl.TRIANGLES,Ni?Gt:jt,Kr.disabled,Ni||Sr.opacity<1||In.hasTranslucentParts?An.alphaBlended:An.unblended,Yr.backCCW,Ro,$e.id,Mi.vertexBuffer,Mi.indexBuffer,Mi.segments,$e.paint,be.transform.zoom,void 0,sa)}}}}()}(g,o,d,y),void G();if(Z.type!=="model")return;const Y=Z.getModels(),re=[],ne=g.transform.getFreeCameraOptions().position,oe=i.ab.vec3.scale([],[ne.x,ne.y,ne.z],g.transform.worldSize);i.ab.vec3.negate(oe,oe);const _e=[],me=[];let we=0;for(const be of Y){const Ee=d.paint.get("model-rotation").constantOr(null),$e=d.paint.get("model-scale").constantOr(null),Ve=d.paint.get("model-translation").constantOr(null);be.computeModelMatrix(g,Ee,$e,Ve,!0,!0,!1);const Qe=i.ab.mat4.identity([]),We=i.dj(be.position.lat,g.transform.zoom),Ke=i.ab.mat4.fromScaling([],[1,1,1/We]);i.ab.mat4.translate(Qe,Qe,oe),re.push({zScaleMatrix:Ke,negCameraPosMatrix:Qe});for(const Ge of be.nodes)ns(g.transform,Ge,be.matrix,g.transform.expandedFarZProjMatrix,we,_e,me);we++}if(_e.sort((be,Ee)=>Ee.depth-be.depth),g.renderPass!=="shadow"){if(S===1)for(const be of me)ua(be,g,d,re[be.modelIndex],Kr.disabled,g.colorModeForRenderPass());else{for(const be of me)ua(be,g,d,re[be.modelIndex],Kr.disabled,An.disabled);for(const be of me)ua(be,g,d,re[be.modelIndex],g.stencilModeFor3D(),g.colorModeForRenderPass());g.resetStencilClippingMasks()}for(const be of _e)ua(be,g,d,re[be.modelIndex],Kr.disabled,g.colorModeForRenderPass());G()}else{for(const be of me)hd(be.mesh,be.nodeModelMatrix,g,d);for(const be of _e)hd(be.mesh,be.nodeModelMatrix,g,d);G()}}},yh={line:function(g,o,d){if(g.hasElevatedBuckets=!1,g.hasNonElevatedBuckets=!1,g._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||g._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const y=o.getVisibleCoordinates();for(const S of y){const N=o.getTile(S).getBucket(g);if(N&&(N.hasZOffset?g.hasElevatedBuckets=!0:g.hasNonElevatedBuckets=!0,g.hasElevatedBuckets&&g.hasNonElevatedBuckets))break}}}else g.hasNonElevatedBuckets=!0},model:function(g,o,d){const y=o.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(d.modelManager&&d.modelManager.upload(d,y.type==="vector"?g.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const S=y.getModels();for(const N of S)N.upload(d.context)},raster:function(g,o,d){const y=o.getSource();if(!(y instanceof $a&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const N=g.paint.get("raster-array-band")||y.getInitialBand(S);if(N==null)return;const k=o.getIds().map(z=>o.getTileByID(z));for(const z of k)z.updateNeeded(S,N)&&y.prepareTile(z,S,N)},"raster-particle":function(g,o,d){const y=o.getSource();if(!(y instanceof $a&&y.loaded()))return;const S=g.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!S)return;const N=g.paint.get("raster-particle-array-band")||y.getInitialBand(S);if(N==null)return;const k=o.getIds().map(z=>o.getTileByID(z));for(const z of k)z.updateNeeded(S,N)&&y.prepareTile(z,S,N)}};class ug{constructor(o,d,y,S,N){this.context=new Ly(o,d),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=N,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const k=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const G of k)this._debugParams.enabledLayers[G]=!0;N.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),N.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),N.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),N.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),N.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),N.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const G of k)N.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],G);this.occlusionParams=new _f(N),this.setup(),this.numSublayers=Wo.maxUnderzooming+Wo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Kd(this),this._wireframeDebugCache=new mh,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const z=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,z,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=S}updateTerrain(o,d){const y=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new sc(this,o));const S=this._terrain;this.transform.elevation=y?S:null,S.update(o,this.transform,d),this.transform.elevation&&!S.enabled&&(this.transform.elevation=null)}_updateFog(o){const d=o.fog;if(!d||this.transform.projection.name==="globe"||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,S]=d.getFovAdjustedRange(this.transform._fov);if(y>S)return void(this.transform.fogCullDistSq=null);const N=y+.78*(S-y);this.transform.fogCullDistSq=N*N}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new sc(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,d){if(this.width=o*i.q.devicePixelRatio,this.height=d*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const o=this.context,d=new i.b4;d.emplaceBack(0,0),d.emplaceBack(i.ag,0),d.emplaceBack(0,i.ag),d.emplaceBack(i.ag,i.ag),this.tileExtentBuffer=o.createVertexBuffer(d,i.b6.members),this.tileExtentSegments=i.b7.simpleSegment(0,0,4,2);const y=new i.b4;y.emplaceBack(0,0),y.emplaceBack(i.ag,0),y.emplaceBack(0,i.ag),y.emplaceBack(i.ag,i.ag),this.debugBuffer=o.createVertexBuffer(y,i.b6.members),this.debugSegments=i.b7.simpleSegment(0,0,4,5);const S=new i.b4;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(-1,1),S.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(S,i.b6.members),this.viewportSegments=i.b7.simpleSegment(0,0,4,2);const N=new i.aT;N.emplaceBack(0,0,0,0),N.emplaceBack(i.ag,0,i.ag,0),N.emplaceBack(0,i.ag,0,i.ag),N.emplaceBack(i.ag,i.ag,i.ag,i.ag),this.mercatorBoundsBuffer=o.createVertexBuffer(N,i.b9.members),this.mercatorBoundsSegments=i.b7.simpleSegment(0,0,4,2);const k=new i.aU;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(k);const z=new i.b5;for(const Z of[0,1,3,2,0])z.emplaceBack(Z);this.debugIndexBuffer=o.createIndexBuffer(z),this.emptyTexture=new i.T(o,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=i.ab.mat4.create();const G=this.context.gl;this.stencilClearMode=new Kr({func:G.ALWAYS,mask:0},0,255,G.ZERO,G.ZERO,G.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,Br.disabled,this.stencilClearMode,An.disabled,Yr.disabled,Qi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,d,y){if(!d||this.currentStencilSource===d.id||!o.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let z=!1;for(const G of y)if(this._tileClippingMaskIDs[G.key]===void 0){z=!0;break}if(!z)return}this.currentStencilSource=d.id;const S=this.context,N=S.gl;this.nextStencilID+y.length>256&&this.clearStencil(),S.setColorMode(An.disabled),S.setDepthMode(Br.disabled);const k=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of y){const G=d.getTile(z),Z=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:re,tileBoundsSegments:ne}=this.getTileBoundsBuffers(G);k.draw(this,N.TRIANGLES,Br.disabled,new Kr({func:N.ALWAYS,mask:0},Z,255,N.KEEP,N.KEEP,N.REPLACE),An.disabled,Yr.disabled,Qi(z.projMatrix),"$clipping",Y,re,ne)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,d=this.context.gl;return new Kr({func:d.NOTEQUAL,mask:255},o,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const d=this.context.gl;return new Kr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(o){const d=this.context.gl,y=o.sort((k,z)=>z.overscaledZ-k.overscaledZ),S=y[y.length-1].overscaledZ,N=y[0].overscaledZ-S+1;if(N>1){this.currentStencilSource=void 0,this.nextStencilID+N>256&&this.clearStencil();const k={};for(let z=0;z<N;z++)k[z+S]=new Kr({func:d.GEQUAL,mask:255},z+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=N,[k,y]}return[{[S]:Kr.disabled},y]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new An([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new i.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?An.unblended:An.alphaBlended}colorModeForDrapableLayerRenderPass(o){const d=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new An([d.ONE,d.ONE_MINUS_SRC_ALPHA,d.CONSTANT_ALPHA,d.ONE_MINUS_SRC_ALPHA],new i.aj(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,d,y,S=!1){if(this.depthOcclusion)return new Br(this.context.gl.GREATER,Br.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!S)return Br.disabled;const N=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Br(y||this.context.gl.LEQUAL,d,[N,N])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,d=Math.ceil(this.width),y=Math.ceil(this.height),S=this.context.bindFramebuffer.get(),N=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===d&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),d!==0&&y!==0&&(this.depthFBO=new Lp(this.context,d,y,!1,"texture"),this.depthTexture=new i.T(this.context,{width:d,height:y,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(S),o.bindTexture(o.TEXTURE_2D,N),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,d,y,0,0,d,y,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,d)=>o+d/this._fpsHistory.length,0))}render(o,d){const y=i.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=d;const S=this.style._mergedLayers,N=!(!this.terrain||!this.terrain.enabled),k=()=>this.style._getOrder(N).filter(dt=>{const jt=S[dt];return!(jt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[jt.type]});let z=k(),G=!1,Z=!1;for(const dt of z){const jt=S[dt];jt.type==="circle"&&(G=!0),jt.type==="symbol"&&(jt.hasInitialOcclusionOpacityProperties?Z=!0:G=!0)}let Y=z.map(dt=>S[dt]);const re=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let ne=0,oe=!1;for(const dt in re){const jt=re[dt];jt.used&&(jt.prepare(this.context),jt.getSource().usedInConflation&&++ne)}let _e=!1;for(const dt of Y)dt.isHidden(this.transform.zoom)||(dt.type==="clip"&&(_e=!0),this.prepareLayer(dt));const me={},we={},be={},Ee={},$e={};for(const dt in re){const jt=re[dt];me[dt]=jt.getVisibleCoordinates(),we[dt]=me[dt].slice().reverse(),be[dt]=jt.getVisibleCoordinates(!0).reverse(),Ee[dt]=jt.getShadowCasterCoordinates(),$e[dt]=jt.sortCoordinatesByDistance(me[dt])}const Ve=dt=>{const jt=this.style.getLayerSourceCache(dt);return jt&&jt.used?jt.getSource():null};if(ne||_e||this._clippingActiveLastFrame){const dt=[],jt=[];let Gt=0;for(const ft of Y)this.isSourceForClippingOrConflation(ft,Ve(ft))&&(dt.push(ft),jt.push(Gt)),Gt++;if(dt&&(_e||dt.length>1)||this._clippingActiveLastFrame){_e=!1;const ft=[];for(let Ft=0;Ft<dt.length;Ft++){const Ct=dt[Ft],Qt=jt[Ft],$t=this.style.getLayerSourceCache(Ct);if(!$t||!$t.used||!$t.getSource().usedInConflation&&Ct.type!=="clip")continue;let zt=i.dx,Yt=i.by.None;const nr=[];let yr=!0;if(Ct.type==="clip"){zt=Qt;for(const _r of Ct.layout.get("clip-layer-types"))Yt|=_r==="model"?i.by.Model:_r==="symbol"?i.by.Symbol:i.by.FillExtrusion;for(const _r of Ct.layout.get("clip-layer-scope"))nr.push(_r);Ct.isHidden(this.transform.zoom)?yr=!1:_e=!0}yr&&ft.push({layer:Ct.fqid,cache:$t,order:zt,clipMask:Yt,clipScope:nr})}this.replacementSource.setSources(ft),oe=!0}}this._clippingActiveLastFrame=_e,oe||this.replacementSource.clear(),this.conflationActive=oe,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let dt=0;dt<Y.length;dt++){const jt=Y[dt],Gt=jt.cutoffRange();if(this.longestCutoffRange=Math.max(Gt,this.longestCutoffRange),Gt>0){const ft=Ve(jt);ft&&(this.minCutoffZoom=Math.max(ft.minzoom,this.minCutoffZoom)),jt.minzoom&&(this.minCutoffZoom=Math.max(jt.minzoom,this.minCutoffZoom))}jt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=dt),this._lastOcclusionLayer=dt)}const Qe=this.style&&this.style.fog;Qe?(this._fogVisible=Qe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Qe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(be),this.opaquePassCutoff=0,z=k(),Y=z.map(dt=>S[dt]));const We=this._shadowRenderer;if(We){We.updateShadowParameters(this.transform,this.style.directionalLight);for(const dt in re)for(const jt of me[dt]){let Gt={min:0,max:0};this.terrain&&(Gt=this.terrain.getMinMaxForTile(jt)||Gt),We.addShadowReceiver(jt.toUnwrapped(),Gt.min,Gt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ag(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Ke=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ge=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Ke&&!this._snow&&(this._snow=new Sf(this)),!Ke&&this._snow&&(this._snow.destroy(),delete this._snow),Ge&&!this._rain&&(this._rain=new gh(this)),!Ge&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!jr.has(this.context.gl))return;this.renderPass="offscreen";for(const dt of Y){const jt=o.getLayerSourceCache(dt);if(!dt.hasOffscreenPass()||dt.isHidden(this.transform.zoom))continue;const Gt=jt?we[jt.id]:void 0;(dt.type==="custom"||dt.type==="raster"||dt.type==="raster-particle"||dt.isSky()||Gt&&Gt.length)&&this.renderLayer(this,jt,dt,Gt)}this.depthRangeFor3D=[0,1-(Y.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Ee)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ye=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),it=(()=>{if(d.showOverdrawInspector)return i.aj.black;const dt=this.style.fog;if(dt&&this.transform.projection.supportsFog){const jt=this.style.getLut(dt.scope);if(!Ye){const Gt=dt.properties.get("color-use-theme")==="none",ft=dt.properties.get("color").toRenderColor(Gt?null:jt).toArray01();return new i.aj(...ft)}if(Ye){const Gt=dt.properties.get("space-color-use-theme")==="none",ft=dt.properties.get("space-color").toRenderColor(Gt?null:jt).toArray01();return new i.aj(...ft)}}return i.aj.transparent})();if(this.context.clear({color:it,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ye&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=z.length-1;this.currentLayer>=0;this.currentLayer--){const dt=Y[this.currentLayer],jt=o.getLayerSourceCache(dt);if(dt.isSky())continue;const Gt=jt?(dt.is3D()?$e:we)[jt.id]:void 0;this._renderTileClippingMasks(dt,jt,Gt),this.renderLayer(this,jt,dt,Gt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ye&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<z.length;this.currentLayer++){const dt=Y[this.currentLayer],jt=o.getLayerSourceCache(dt);dt.isSky()&&this.renderLayer(this,jt,dt,jt?we[jt.id]:void 0)}function bt(dt,jt){let Gt;return jt&&(Gt=(dt.type==="symbol"?be:dt.is3D()?$e:we)[jt.id]),Gt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<z.length;){const dt=Y[this.currentLayer];if(dt.type==="raster"||dt.type==="raster-particle"){const jt=o.getLayerSourceCache(dt);this.renderLayer(this,jt,dt,bt(dt,jt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let pt=0;We&&(pt=We.getShadowCastingLayerCount());let kt=!1,Et=-1;for(let dt=0;dt<z.length;++dt){const jt=Y[dt];jt.isHidden(this.transform.zoom)||jt.is3D()&&(Et=dt)}for(Z&&Et===-1&&(G=!0);this.currentLayer<z.length;){const dt=Y[this.currentLayer],jt=o.getLayerSourceCache(dt);if(dt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(dt)){if(dt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(G&&!kt&&this.terrain&&!this.transform.isOrthographic&&(kt=!0,this.blitDepth()),Z&&Et!==-1&&this.currentLayer===Et+1&&!this.transform.isOrthographic&&this.blitDepth(),dt.is3D()||this.terrain||this._renderTileClippingMasks(dt,jt,jt?me[jt.id]:void 0),this.renderLayer(this,jt,dt,bt(dt,jt)),!this.terrain&&We&&pt>0&&dt.hasShadowPass()&&--pt==0&&(We.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Gt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Gt;this.currentLayer++){const ft=Y[this.currentLayer];if(!ft.hasLightBeamPass())continue;const Ft=o.getLayerSourceCache(ft);this.renderLayer(this,Ft,ft,Ft?we[Ft.id]:void 0)}this.currentLayer=Gt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Gt=this.currentLayer;this.depthOcclusion=!0;for(const ft of this.layersWithOcclusionOpacity){this.currentLayer=ft;const Ft=Y[this.currentLayer],Ct=o.getLayerSourceCache(Ft),Qt=Ct?we[Ct.id]:void 0;Ft.is3D()||this.terrain||this._renderTileClippingMasks(Ft,Ct,Ct?me[Ct.id]:void 0),this.renderLayer(this,Ct,Ft,Qt)}this.depthOcclusion=!1,this.currentLayer=Gt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let dt=null;Y.forEach(jt=>{const Gt=o.getLayerSourceCache(jt);Gt&&!jt.isHidden(this.transform.zoom)&&Gt.getVisibleCoordinates().length&&(!dt||dt.getSource().maxzoom<Gt.getSource().maxzoom)&&(dt=Gt)}),dt&&this.options.showTileBoundaries&&Af.debug(this,dt,dt.getVisibleCoordinates(),i.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Af.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(dt){const jt=dt.transform.padding;hh(dt,dt.transform.height-(jt.top||0),3,pu),hh(dt,jt.bottom||0,3,_v),fh(dt,jt.left||0,3,rg),fh(dt,dt.transform.width-(jt.right||0),3,Fy);const Gt=dt.transform.centerPoint;(function(ft,Ft,Ct,Qt){Sl(ft,Ft-1,Ct-10,2,20,Qt),Sl(ft,Ft-10,Ct-1,20,2,Qt)})(dt,Gt.x,dt.transform.height-Gt.y,dd)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),oe||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:d}=this.transform.projection,y=!d||!d.includes(o.type);if(yh[o.type]&&(y||this.terrain&&o.type==="custom")){const S=this.style.getLayerSourceCache(o);yh[o.type](o,S,this)}this.gpuTimingEnd()}renderLayer(o,d,y,S){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||S&&S.length)&&(this.id=y.id,this.gpuTimingStart(y),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(y.type)&&(!o.terrain||y.type!=="custom")||y.type==="clip"||Af[y.type](o,d,y,S,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery,y=this.context.gl;let S=this.gpuTimers[o.id];S||(S=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:y.createQuery()}),S.calls++,y.beginQuery(d.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,d=this.context.gl,y=d.createQuery();this.deferredRenderGpuTimeQueries.push(y),d.beginQuery(o.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const d={};for(const y in o){const S=o[y],N=this.context.extTimerQuery,k=N.getQueryParameter(S.query,this.context.gl.QUERY_RESULT)/1e6;N.deleteQueryEXT(S.query),d[y]=k}return d}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.gl;let y=0;for(const S of o)y+=d.getQueryParameter(S,d.QUERY_RESULT)/1e6,d.deleteQuery(S);return y}translatePosMatrix(o,d,y,S,N){if(!y[0]&&!y[1])return o;const k=N?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(k){const Z=Math.sin(k),Y=Math.cos(k);y=[y[0]*Y-y[1]*Z,y[0]*Z+y[1]*Y]}const z=[N?y[0]:i.ar(d,y[0],this.transform.zoom),N?y[1]:i.ar(d,y[1],this.transform.zoom),0],G=new Float32Array(16);return i.ab.mat4.translate(G,o,z),G}saveTileTexture(o){const d=o.size[0],y=this._tileTextures[d];y?y.push(o):this._tileTextures[d]=[o]}getTileTexture(o){const d=this._tileTextures[o];return d&&d.length>0?d.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,d,y){const S=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,N=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(N.push("LIGHTING_3D_MODE"),N.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):S||N.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||N.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(N.push("TERRAIN"),this.linearFloatFilteringSupported()&&N.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&N.push("GLOBE"),!this._fogVisible||S||d!==void 0&&!d||N.push("FOG","FOG_DITHERING"),S&&N.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&N.push("OVERDRAW_INSPECTOR"),N}getOrCreateProgram(o,d){this.cache=this.cache||{};const y=d&&d.defines||[],S=d&&d.config,N=this.currentGlobalDefines(o,d&&d.overrideFog,d&&d.overrideRtt).concat(y),k=Oy.cacheKey(Xd[o],o,N,S);return this.cache[k]||(this.cache[k]=new Oy(this.context,o,Xd[o],S,tg[o],N)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,d){if(this.style.enable3dLights()){const y=this.style.directionalLight,S=this.style.ambientLight;if(y&&S){const N=((k,z,G)=>{const Z=k.properties.get("direction"),Y=k.properties.get("color-use-theme")==="none",re=k.properties.get("color").toRenderColor(Y?null:G.getLut(k.scope)).toArray01(),ne=k.properties.get("intensity"),oe=z.properties.get("color-use-theme")==="none",_e=z.properties.get("color").toRenderColor(oe?null:G.getLut(z.scope)).toArray01(),me=z.properties.get("intensity"),we=[Z.x,Z.y,Z.z],be=i.cM(_e,me),Ee=i.cM(re,ne);return{u_lighting_ambient_color:be,u_lighting_directional_dir:we,u_lighting_directional_color:Ee,u_ground_radiance:Yo(we,Ee,be)}})(y,S,this.style);d.setLightsUniformValues(o,N)}}}uploadCommonUniforms(o,d,y,S,N){if(this.uploadCommonLightUniforms(o,d),this.terrain&&this.terrain.renderingToTexture)return;const k=this.style.fog;if(k){const z=k.getOpacity(this.transform.pitch),G=((Z,Y,re,ne,oe,_e,me,we,be,Ee,$e,Ve)=>{const Qe=Z.transform,We=Y.properties.get("color-use-theme")==="none",Ke=Y.properties.get("color").toRenderColor(We?null:Z.style.getLut(Y.scope)).toArray01();Ke[3]=ne;const Ge=Z.frameCounter/1e3%1,[Ye,it]=Y.properties.get("vertical-range");return{u_fog_matrix:re?Qe.calculateFogTileMatrix(re):Ve||Z.identityMat,u_fog_range:Y.getFovAdjustedRange(Qe._fov),u_fog_color:Ke,u_fog_horizon_blend:Y.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ye,it),it],u_fog_temporal_offset:Ge,u_frustum_tl:oe,u_frustum_tr:_e,u_frustum_br:me,u_frustum_bl:we,u_globe_pos:be,u_globe_radius:Ee,u_viewport:$e,u_globe_transition:i.ae(Qe.zoom),u_is_globe:+(Qe.projection.name==="globe")}})(this,k,y,z,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],S);d.setFogUniformValues(o,G)}N&&d.setCutoffUniformValues(o,N.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,d=o.createTexture();return o.bindTexture(o.TEXTURE_2D,d),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,d=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const S of y)d[S.key]=o[S.key]||new Tc(S,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,d){return!(!o.is3D()||o.type!=="clip"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building")&&(!d||d.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let d=this._cachedTileFogOpacities[o.key];return d||(this._cachedTileFogOpacities[o.key]=d=this.style.fog.getOpacityForTile(o)),d[0]>=Je||d[1]>=Je}setupDepthForOcclusion(o,d,y){const S=this.context,N=S.gl,k=!!y;var z;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),S.activeTexture.set(N.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((z=this.depthRangeFor3D)[1]-z[0]),-1-2*z[0]/(z[1]-z[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE),S.activeTexture.set(N.TEXTURE0),k||d.setTerrainUniformValues(S,y)}}function qp(g,o){let d=!1,y=null;const S=()=>{y=null,d&&(g(),y=setTimeout(S,o),d=!1)};return()=>(d=!0,y||S(),y)}class By{constructor(o){this._hashName=o&&encodeURIComponent(o),i.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=qp(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const d=dg(o);if(this._hashName){const y=this._hashName;let S=!1;const N=location.hash.slice(1).split("&").map(k=>{const z=k.split("=")[0];return z===y?(S=!0,`${z}=${d}`):k}).filter(k=>k);return S||N.push(`${y}=${d}`),`#${N.join("&")}`}return`#${d}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let d;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(d=y)}),(d&&d[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(y=>isNaN(y))){const y=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(d[3]||0):o.getBearing();return o.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:y,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function dg(g,o){const d=g.getCenter(),y=Math.round(100*g.getZoom())/100,S=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,S),k=Math.round(d.lng*N)/N,z=Math.round(d.lat*N)/N,G=g.getBearing(),Z=g.getPitch();let Y=o?`/${k}/${z}/${y}`:`${y}/${z}/${k}`;return(G||Z)&&(Y+="/"+Math.round(10*G)/10),Z&&(Y+=`/${Math.round(Z)}`),Y}const vh={linearity:.3,easing:i.dy(0,0,.3,1)},Vy=i.l({deceleration:2500,maxSpeed:1400},vh),Uy=i.l({deceleration:20,maxSpeed:1400},vh),$y=i.l({deceleration:1e3,maxSpeed:360},vh),bv=i.l({deceleration:1e3,maxSpeed:90},vh);class qy{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,d=i.q.now();for(;o.length>0&&d-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:N}of this._inertiaBuffer)d.zoom+=N.zoomDelta||0,d.bearing+=N.bearingDelta||0,d.pitch+=N.pitchDelta||0,N.panDelta&&d.pan._add(N.panDelta),N.around&&(d.around=N.around),N.pinchAround&&(d.pinchAround=N.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(d.pan.mag()){const N=Wp(d.pan.mag(),y,i.l({},Vy,o||{}));S.offset=d.pan.mult(N.amount/d.pan.mag()),S.center=this._map.transform.center,Gp(S,N)}if(d.zoom){const N=Wp(d.zoom,y,Uy);S.zoom=this._map.transform.zoom+N.amount,Gp(S,N)}if(d.bearing){const N=Wp(d.bearing,y,$y);S.bearing=this._map.transform.bearing+i.aw(N.amount,-179,179),Gp(S,N)}if(d.pitch){const N=Wp(d.pitch,y,bv);S.pitch=this._map.transform.pitch+N.amount,Gp(S,N)}if(S.zoom||S.bearing){const N=d.pinchAround===void 0?d.around:d.pinchAround;S.around=N?this._map.unproject(N):this._map.getCenter()}return this.clear(),S.noMoveStart=!0,S}}function Gp(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function Wp(g,o,d){const{maxSpeed:y,linearity:S,deceleration:N}=d,k=i.aw(g*S/(o/1e3),-y,y),z=Math.abs(k)/(N*S);return{easing:d.easing,duration:1e3*z,amount:k*(z/2)}}class Oo extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y,S={}){const N=he(d.getCanvasContainer(),y),k=d.unproject(N);super(o,i.l({point:N,lngLat:k,originalEvent:y},S)),this._defaultPrevented=!1,this.target=d}}class Tf extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d,y){const S=o==="touchend"?y.changedTouches:y.touches,N=Pe(d.getCanvasContainer(),S),k=N.map(G=>d.unproject(G)),z=N.reduce((G,Z,Y,re)=>G.add(Z.div(re.length)),new i.P(0,0));super(o,{points:N,point:z,lngLats:k,lngLat:d.unproject(z),originalEvent:y}),this._defaultPrevented=!1}}class Gy extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,d){super("wheel",{originalEvent:d}),this._defaultPrevented=!1}}class hg{constructor(o,d){this._map=o,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Gy(this._map,o))}mousedown(o,d){return this._mousedownPos=d,this._firePreventable(new Oo(o.type,this._map,o))}mouseup(o){this._map.fire(new Oo(o.type,this._map,o))}preclick(o){const d=i.l({},o);d.type="preclick",this._map.fire(new Oo(d.type,this._map,d))}click(o,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Oo(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Oo(o.type,this._map,o))}mouseover(o){this._map.fire(new Oo(o.type,this._map,o))}mouseout(o){this._map.fire(new Oo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Tf(o.type,this._map,o))}touchmove(o){this._map.fire(new Tf(o.type,this._map,o))}touchend(o){this._map.fire(new Tf(o.type,this._map,o))}touchcancel(o){this._map.fire(new Tf(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Z_{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Oo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Oo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Oo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class va{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,d){this.isEnabled()&&o.shiftKey&&o.button===0&&(ae(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(o,d){if(!this._active)return;const y=d,S=this._startPos,N=this._lastPos;if(!S||!N||N.equals(y)||!this._box&&y.dist(S)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const k=Math.min(S.x,y.x),z=Math.max(S.x,y.x),G=Math.min(S.y,y.y),Z=Math.max(S.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${k}px,${G}px)`,this._box.style.width=z-k+"px",this._box.style.height=Z-G+"px")})}mouseupWindow(o,d){if(!this._active)return;const y=this._startPos,S=d;if(y&&o.button===0){if(this.reset(),ce(),y.x!==S.x||y.y!==S.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:o})),{cameraAnimation:N=>N.fitScreenCoordinates(y,S,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ee(),delete this._startPos,delete this._lastPos}_fireEvent(o,d){return this._map.fire(new i.z(o,{originalEvent:d}))}}function fg(g,o){const d={};for(let y=0;y<g.length;y++)d[g[y].identifier]=o[y];return d}class uc{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),y.length===this.numTouches&&(this.centroid=function(S){const N=new i.P(0,0);for(const k of S)N._add(k);return N.div(S.length)}(d),this.touches=fg(y,d)))}touchmove(o,d,y){if(this.aborted||!this.centroid)return;const S=fg(y,d);for(const N in this.touches){const k=S[N];(!k||k.dist(this.touches[N])>30)&&(this.aborted=!0)}}touchend(o,d,y){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Hp{constructor(o){this.singleTap=new uc(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,d,y){this.singleTap.touchstart(o,d,y)}touchmove(o,d,y){this.singleTap.touchmove(o,d,y)}touchend(o,d,y){const S=this.singleTap.touchend(o,d,y);if(S){const N=o.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(S)<30;if(N&&k||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class pd{constructor(){this._zoomIn=new Hp({numTouches:1,numTaps:2}),this._zoomOut=new Hp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,d,y){this._zoomIn.touchstart(o,d,y),this._zoomOut.touchstart(o,d,y)}touchmove(o,d,y){this._zoomIn.touchmove(o,d,y),this._zoomOut.touchmove(o,d,y)}touchend(o,d,y){const S=this._zoomIn.touchend(o,d,y),N=this._zoomOut.touchend(o,d,y);return S?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(S)},{originalEvent:o})}):N?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(N)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Wy={0:1,2:2};class Pf{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,d){return!1}_move(o,d){return{}}mousedown(o,d){if(this._lastPoint)return;const y=Ne(o);this._correctButton(o,y)&&(this._lastPoint=d,this._eventButton=y)}mousemoveWindow(o,d){const y=this._lastPoint;if(y){if(o.preventDefault(),this._eventButton!=null&&function(S,N){const k=Wy[N];return S.buttons===void 0||(S.buttons&k)!==k}(o,this._eventButton))this.reset();else if(this._moved||!(d.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(y,d)}}mouseupWindow(o){this._lastPoint&&Ne(o)===this._eventButton&&(this._moved&&ce(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kp extends Pf{mousedown(o,d){super.mousedown(o,d),this._lastPoint&&(this._active=!0)}_correctButton(o,d){return d===0&&!o.ctrlKey}_move(o,d){return{around:d,panDelta:d.sub(o)}}}class $l extends Pf{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const y=.8*(d.x-o.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(o){o.preventDefault()}}class Fc extends Pf{_correctButton(o,d){return d===0&&o.ctrlKey||d===2}_move(o,d){const y=-.5*(d.y-o.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(o){o.preventDefault()}}class da{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),i.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(o,d,y){return this._calculateTransform(o,d,y)}touchmove(o,d,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,d,y)}}touchend(o,d,y){this._calculateTransform(o,d,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,d,y){y.length>0&&(this._active=!0);const S=fg(y,d),N=new i.P(0,0),k=new i.P(0,0);let z=0;for(const Z in S){const Y=S[Z],re=this._touches[Z];re&&(N._add(Y),k._add(Y.sub(re)),z++,S[Z]=Y)}if(this._touches=S,z<this._minTouches||!k.mag())return;const G=k.div(z);return this._sum._add(G),this._sum.mag()<this._clickTolerance?void 0:{around:N.div(z),panDelta:G}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class el{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,d,y){return{}}touchstart(o,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(o,d,y){const S=this._firstTwoTouches;if(!S)return;o.preventDefault();const[N,k]=S,z=Nf(y,d,N),G=Nf(y,d,k);if(!z||!G)return;const Z=this._aroundCenter?null:z.add(G).div(2);return this._move([z,G],Z,o)}touchend(o,d,y){if(!this._firstTwoTouches)return;const[S,N]=this._firstTwoTouches,k=Nf(y,d,S),z=Nf(y,d,N);k&&z||(this._active&&ce(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Nf(g,o,d){for(let y=0;y<g.length;y++)if(g[y].identifier===d)return o[y]}function jf(g,o){return Math.log(g/o)/Math.LN2}class Hy extends el{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,d){const y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(jf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:jf(this._distance,y),pinchAround:d}}}function Ky(g,o){return 180*g.angleWith(o)/Math.PI}class Cf extends el{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,d){const y=this._vector;if(this._vector=o[0].sub(o[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ky(this._vector,y),pinchAround:d}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const d=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const S=Ky(o,y);return Math.abs(S)<d}}function pg(g){return Math.abs(g.y)>Math.abs(g.x)}class Y_ extends el{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,pg(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,d,y){const S=this._lastPoints;if(!S)return;const N=o[0].sub(S[0]),k=o[1].sub(S[1]);return this._map._cooperativeGestures&&!i.dz()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(N,k,y.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(N.y+k.y)/2*-.5})}gestureBeginsVertically(o,d,y){if(this._valid!==void 0)return this._valid;const S=o.mag()>=2,N=d.mag()>=2;if(!S&&!N)return;if(!S||!N)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const k=o.y>0==d.y>0;return pg(o)&&pg(d)&&k}}const mo={panStep:100,bearingStep:15,pitchStep:10};class eo{constructor(){const o=mo;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let d=0,y=0,S=0,N=0,k=0;switch(o.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:o.shiftKey?y=-1:(o.preventDefault(),N=-1);break;case 39:o.shiftKey?y=1:(o.preventDefault(),N=1);break;case 38:o.shiftKey?S=1:(o.preventDefault(),k=-1);break;case 40:o.shiftKey?S=-1:(o.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(y=0,S=0),{cameraAnimation:z=>{const G=z.getZoom();z.easeTo({duration:300,easeId:"keyboardHandler",easing:md,zoom:d?Math.round(G)+d*(o.shiftKey?2:1):G,bearing:z.getBearing()+y*this._bearingStep,pitch:z.getPitch()+S*this._pitchStep,offset:[-N*this._panStep,-k*this._panStep],center:z.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function md(g){return g*(2-g)}const gd=4.000244140625,Bc=1/450;class ql{constructor(o,d){this._map=o,this._el=o.getCanvasContainer(),this._handler=d,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Bc,i.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const y=i.q.now(),S=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,d!==0&&d%gd==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=d,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(S*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),o.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=o,this._delta-=d,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=he(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const Z=this._type==="wheel"&&Math.abs(this._delta)>gd?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&Y!==0&&(Y=1/Y);const re=d(),ne=Math.pow(2,re),oe=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):ne;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(oe*Y))),this._type==="wheel"&&(this._startZoom=re,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:d(),S=this._startZoom,N=this._easing;let k,z=!1;if(this._type==="wheel"&&S&&N){const Z=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),Y=N(Z);k=i.af(S,y,Y),Z<1?this._frameId||(this._frameId=!0):z=!0}else k=y,z=!0;this._active=!0,z&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let G=k-d();return G*this._lastDelta<0&&(G=0),{noInertia:!0,needsRenderFrame:!z,zoomDelta:G,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let d=i.dA;if(this._prevEase){const y=this._prevEase,S=(i.q.now()-y.start)/y.duration,N=y.easing(S+.01)-y.easing(S),k=.27/Math.sqrt(N*N+1e-4)*.01,z=Math.sqrt(.0729-k*k);d=i.dy(k,z,.25,1)}return this._prevEase={start:i.q.now(),duration:o,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class yu{constructor(o,d){this._clickZoom=o,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class vu{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,d){return o.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(o.shiftKey?-1:1),around:y.unproject(d)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xu{constructor(){this._tap=new Hp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,d,y){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=d[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(o,d,y))}touchmove(o,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const S=d[0],N=S.y-this._swipePoint.y;return this._swipePoint=S,o.preventDefault(),this._active=!0,{zoomDelta:N/128}}}else this._tap.touchmove(o,d,y)}touchend(o,d,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(o,d,y)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zy{constructor(o,d,y){this._el=o,this._mousePan=d,this._touchPan=y}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wv{constructor(o,d,y){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Sv{constructor(o,d,y,S){this._el=o,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const kf=g=>g.zoom||g.drag||g.pitch||g.rotate;class mg extends i.z{}class to{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,d){const y=i.ab.vec3.sub([],d,o);this.radius=i.ab.vec3.length(y[2]<0?i.ab.vec3.div([],y,this.constants):[y[0],y[1],0])}projectRay(o){i.ab.vec3.div(o,o,this.constants),i.ab.vec3.normalize(o,o),i.ab.vec3.mul(o,o,this.constants);const d=i.ab.vec3.scale([],o,this.radius);if(d[2]>0){const y=i.ab.vec3.scale([],[0,0,1],i.ab.vec3.dot(d,[0,0,1])),S=i.ab.vec3.scale([],i.ab.vec3.normalize([],[d[0],d[1],0]),this.radius),N=i.ab.vec3.add([],d,i.ab.vec3.scale([],i.ab.vec3.sub([],i.ab.vec3.add([],S,y),d),2));d[0]=N[0],d[1]=N[1]}return d}}function yd(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Zp{constructor(o,d){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qy(o),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new to,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),i.aP(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[S,N,k]of this._listeners){const z=S===document?this.handleWindowEvent:this.handleEvent;S.addEventListener(N,z,k)}}destroy(){for(const[o,d,y]of this._listeners){const S=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(d,S,y)}}_addDefaultHandlers(o){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new hg(d,o));const S=d.boxZoom=new va(d,o);this._add("boxZoom",S);const N=new pd,k=new vu;d.doubleClickZoom=new yu(k,N),this._add("tapZoom",N),this._add("clickZoom",k);const z=new xu;this._add("tapDragZoom",z);const G=d.touchPitch=new Y_(d);this._add("touchPitch",G);const Z=new $l(o),Y=new Fc(o);d.dragRotate=new wv(o,Z,Y),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const re=new Kp(o),ne=new da(d,o);d.dragPan=new Zy(y,re,ne),this._add("mousePan",re),this._add("touchPan",ne,["touchZoom","touchRotate"]);const oe=new Cf,_e=new Hy;d.touchZoomRotate=new Sv(y,_e,oe,z),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",_e,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Z_(d));const me=d.scrollZoom=new ql(d,this);this._add("scrollZoom",me,["mousePan"]);const we=d.keyboard=new eo;this._add("keyboard",we);for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[be]&&d[be].enable(o[be])}_add(o,d,y){this._handlers.push({handlerName:o,handler:d,allowed:y}),this._handlersById[o]=d}stop(o){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!kf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,d,y){for(const S in o)if(S!==y&&(!d||d.indexOf(S)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const d=[];for(const y of o)this._el.contains(y.target)&&d.push(y);return d}handleEvent(o,d){this._updatingCamera=!0;const y=o.type==="renderFrame",S=y?void 0:o,N={needsRenderFrame:!1},k={},z={},G=o.touches?this._getMapTouches(o.touches):void 0,Z=G?Pe(this._el,G):y?void 0:he(this._el,o);for(const{handlerName:ne,handler:oe,allowed:_e}of this._handlers){if(!oe.isEnabled())continue;let me;this._blockedByActive(z,_e,ne)?oe.reset():oe[d||o.type]&&(me=oe[d||o.type](o,Z,G),this.mergeHandlerResult(N,k,me,ne,S),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||oe.isActive())&&(z[ne]=oe)}const Y={};for(const ne in this._previousActiveHandlers)z[ne]||(Y[ne]=S);this._previousActiveHandlers=z,(Object.keys(Y).length||yd(N))&&(this._changes.push([N,k,Y]),this._triggerRenderFrame()),(Object.keys(z).length||yd(N))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=N;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))}mergeHandlerResult(o,d,y,S,N){if(!y)return;i.l(o,y);const k={handlerName:S,originalEvent:y.originalEvent||N};y.zoomDelta!==void 0&&(d.zoom=k),y.panDelta!==void 0&&(d.drag=k),y.pitchDelta!==void 0&&(d.pitch=k),y.bearingDelta!==void 0&&(d.rotate=k)}_applyChanges(){const o={},d={},y={};for(const[S,N,k]of this._changes)S.panDelta&&(o.panDelta=(o.panDelta||new i.P(0,0))._add(S.panDelta)),S.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(o.around=S.around),S.aroundCoord!==void 0&&(o.aroundCoord=S.aroundCoord),S.pinchAround!==void 0&&(o.pinchAround=S.pinchAround),S.noInertia&&(o.noInertia=S.noInertia),i.l(d,N),i.l(y,k);this._updateMapTransform(o,d,y),this._changes=[]}_updateMapTransform(o,d,y){const S=this._map,N=S.transform,k=Ee=>[Ee.x,Ee.y,Ee.z];if((Ee=>{const $e=this._eventsInProgress.drag;return $e&&!this._handlersById[$e.handlerName].isActive()})()&&!yd(o)){const Ee=N.zoom;N.cameraElevationReference="sea",this._originalZoom!=null&&N._orthographicProjectionAtLowPitch&&N.projection.name!=="globe"&&N.pitch===0?(N.cameraElevationReference="ground",N.zoom=this._originalZoom):(N.recenterOnTerrain(),N.cameraElevationReference="ground"),Ee!==N.zoom&&this._map._update(!0)}if(N._isCameraConstrained&&S._stop(!0),!yd(o))return void this._fireEvents(d,y,!0);let{panDelta:z,zoomDelta:G,bearingDelta:Z,pitchDelta:Y,around:re,aroundCoord:ne,pinchAround:oe}=o;N._isCameraConstrained&&(G>0&&(G=0),N._isCameraConstrained=!1),oe!==void 0&&(re=oe),(G||(Ee=>d[Ee]&&!this._eventsInProgress[Ee])("drag"))&&re&&(this._dragOrigin=k(N.pointCoordinate3D(re)),this._originalZoom=N.zoom,this._trackingEllipsoid.setup(N._camera.position,this._dragOrigin)),N.cameraElevationReference="sea",S._stop(!0),re=re||S.transform.centerPoint,Z&&(N.bearing+=Z),Y&&(N.pitch+=Y),N._updateCameraState();const _e=[0,0,0];if(z)if(N.projection.name==="mercator"){const Ee=this._trackingEllipsoid.projectRay(N.screenPointToMercatorRay(re).dir),$e=this._trackingEllipsoid.projectRay(N.screenPointToMercatorRay(re.sub(z)).dir);_e[0]=$e[0]-Ee[0],_e[1]=$e[1]-Ee[1]}else{const Ee=N.pointCoordinate(re);if(N.projection.name==="globe"){z=z.rotate(-N.angle);const $e=N._pixelsPerMercatorPixel/N.worldSize;_e[0]=-z.x*i.dB(i.aS(Ee.y))*$e,_e[1]=-z.y*i.dB(N.center.lat)*$e}else{const $e=N.pointCoordinate(re.sub(z));Ee&&$e&&(_e[0]=$e.x-Ee.x,_e[1]=$e.y-Ee.y)}}const me=N.zoom,we=[0,0,0];if(G){const Ee=k(ne||N.pointCoordinate3D(re)),$e={dir:i.ab.vec3.normalize([],i.ab.vec3.sub([],Ee,N._camera.position))};if($e.dir[2]<0){const Ve=N.zoomDeltaToMovement(Ee,G);i.ab.vec3.scale(we,$e.dir,Ve)}}const be=i.ab.vec3.add(_e,_e,we);N._translateCameraConstrained(be),G&&Math.abs(N.zoom-me)>1e-4&&N.recenterOnTerrain(),N.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(d,y,!0)}_fireEvents(o,d,y){const S=kf(this._eventsInProgress),N=kf(o),k={};for(const Y in o){const{originalEvent:re}=o[Y];this._eventsInProgress[Y]||(k[`${Y}start`]=re),this._eventsInProgress[Y]=o[Y]}!S&&N&&this._fireEvent("movestart",N.originalEvent);for(const Y in k)this._fireEvent(Y,k[Y]);N&&this._fireEvent("move",N.originalEvent);for(const Y in o){const{originalEvent:re}=o[Y];this._fireEvent(Y,re)}const z={};let G;for(const Y in this._eventsInProgress){const{handlerName:re,originalEvent:ne}=this._eventsInProgress[Y];this._handlersById[re].isActive()||(delete this._eventsInProgress[Y],G=d[re]||ne,z[`${Y}end`]=G)}for(const Y in z)this._fireEvent(Y,z[Y]);const Z=kf(this._eventsInProgress);if(y&&(S||N)&&!Z){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=ne=>ne!==0&&-this._bearingSnap<ne&&ne<this._bearingSnap;Y?(re(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:G})):(this._map.fire(new i.z("moveend",{originalEvent:G})),re(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,d){this._map.fire(new i.z(o,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new mg("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Av="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class xh extends i.E{constructor(o,d){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=d.bearingSnap,this._respectPrefersReducedMotion=d.respectPrefersReducedMotion!==!1,i.aP(["_renderFrameCallback"],this)}getCenter(){return new i.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(o,d){return this.jumpTo({center:o},d)}panBy(o,d,y){return o=i.P.convert(o).mult(-1),this.panTo(this.transform.center,i.l({offset:o},d),y)}panTo(o,d,y){return this.easeTo(i.l({center:o},d),y)}getZoom(){return this.transform.zoom}setZoom(o,d){return this.jumpTo({zoom:o},d),this}zoomTo(o,d,y){return this.easeTo(i.l({zoom:o},d),y)}zoomIn(o,d){return this.zoomTo(this.getZoom()+1,o,d),this}zoomOut(o,d){return this.zoomTo(this.getZoom()-1,o,d),this}getBearing(){return this.transform.bearing}setBearing(o,d){return this.jumpTo({bearing:o},d),this}getPadding(){return this.transform.padding}setPadding(o,d){return this.jumpTo({padding:o},d),this}rotateTo(o,d,y){return this.easeTo(i.l({bearing:o},d),y)}resetNorth(o,d){return this.rotateTo(0,i.l({duration:1e3},o),d),this}resetNorthPitch(o,d){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},o),d),this}snapToNorth(o,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,d):this}getPitch(){return this.transform.pitch}setPitch(o,d){return this.jumpTo({pitch:o},d),this}cameraForBounds(o,d){o=i.az.convert(o);const y=d&&d.bearing||0,S=d&&d.pitch||0,N=o.getNorthWest(),k=o.getSouthEast();return this._cameraForBounds(this.transform,N,k,y,S,d)}_extendPadding(o){const d={top:0,right:0,bottom:0,left:0};return o==null?i.l({},d,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:i.l({},d,o)}_extendCameraOptions(o){return(o=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,d){const y=d.max[0]-d.min[0],S=d.max[1]-d.min[1];return y/S>o.aspect?y/(2*Math.tan(.5*o.fovX)*o.aspect):S/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,d,y,S,N,k){const z=o.clone(),G=this._extendCameraOptions(k);z.bearing=S,z.pitch=N;const Z=i.bO.convert(d),Y=i.bO.convert(y),re=.5*(Z.lat+Y.lat),ne=.5*(Z.lng+Y.lng),oe=i.dC(re,ne),_e=i.ab.vec3.normalize([],oe),me=i.ab.vec3.normalize([],i.ab.vec3.cross([],_e,[0,1,0])),we=i.ab.vec3.cross([],me,_e),be=[me[0],me[1],me[2],0,we[0],we[1],we[2],0,_e[0],_e[1],_e[2],0,0,0,0,1],Ee=[oe,i.dC(Z.lat,Z.lng),i.dC(Y.lat,Z.lng),i.dC(Y.lat,Y.lng),i.dC(Z.lat,Y.lng),i.dC(re,Z.lng),i.dC(re,Y.lng),i.dC(Z.lat,ne),i.dC(Y.lat,ne)];let $e=i.cd.fromPoints(Ee.map(Ct=>[i.ab.vec3.dot(me,Ct),i.ab.vec3.dot(we,Ct),i.ab.vec3.dot(_e,Ct)]));const Ve=i.ab.vec3.transformMat4([],$e.center,be);i.ab.vec3.squaredLength(Ve)===0&&i.ab.vec3.set(Ve,0,0,1),i.ab.vec3.normalize(Ve,Ve),i.ab.vec3.scale(Ve,Ve,i.ax),z.center=i.dD(Ve);const Qe=z.getWorldToCameraMatrix(),We=i.ab.mat4.invert(new Float64Array(16),Qe);$e=i.cd.applyTransform($e,i.ab.mat4.multiply([],Qe,be));const Ke=this._extendAABB($e,z,G,S);if(!Ke)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");$e=Ke,i.ab.vec3.transformMat4(Ve,Ve,Qe);const Ge=.5*($e.max[2]-$e.min[2]),Ye=this._minimumAABBFrustumDistance(z,$e),it=i.ab.vec3.scale([],[0,0,1],Ge),bt=i.ab.vec3.add(it,Ve,it),pt=Ye+(z.pitch===0?0:i.ab.vec3.distance(Ve,bt)),kt=z.globeCenterInViewSpace,Et=i.ab.vec3.sub([],Ve,[kt[0],kt[1],kt[2]]);i.ab.vec3.normalize(Et,Et),i.ab.vec3.scale(Et,Et,pt);const dt=i.ab.vec3.add([],Ve,Et);i.ab.vec3.transformMat4(dt,dt,We);const jt=i.ds/i.ax,Gt=i.ab.vec3.length(dt),ft=i.bH(Math.max(Gt*jt-i.ds,Number.EPSILON),0),Ft=Math.min(z.zoomFromMercatorZAdjusted(ft),G.maxZoom);return Ft>.5*(i.c6+i.bY)?(z.setProjection({name:"mercator"}),z.zoom=Ft,this._cameraForBounds(z,d,y,S,N,k)):{center:z.center,zoom:Ft,bearing:S,pitch:N}}_extendAABB(o,d,y,S){const N=.5*((y.padding.left||0)+(y.padding.right||0)),k=.5*((y.padding.top||0)+(y.padding.bottom||0)),z=k,G=N,Z=N,Y=k,re=d.width-(G+Z),ne=d.height-(z+Y),oe=i.ab.vec3.sub([],o.max,o.min),_e=Math.min(re/oe[0],ne/oe[1]),me=Math.min(d.scaleZoom(d.scale*_e),y.maxZoom);if(isNaN(me))return null;const we=d.scale/d.zoomScale(me),be=new i.cd([o.min[0]-G*we,o.min[1]-Y*we,o.min[2]],[o.max[0]+Z*we,o.max[1]+z*we,o.max[2]]),Ee=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new i.P(y.offset.x,y.offset.y):i.P.convert(y.offset)).rotate(-i.ai(S));return be.center[0]-=Ee.x*we,be.center[1]+=Ee.y*we,be}queryTerrainElevation(o,d){const y=this.transform.elevation;return y?(d=i.l({},{exaggerated:!0},d),y.getAtPoint(i.aa.fromLngLat(o),null,d.exaggerated)):null}_cameraForBounds(o,d,y,S,N,k){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,d,y,S,N,k);const z=o.clone(),G=this._extendCameraOptions(k);z.bearing=S,z.pitch=N;const Z=i.bO.convert(d),Y=i.bO.convert(y),re=new i.bO(Z.lng,Y.lat),ne=new i.bO(Y.lng,Z.lat),oe=z.project(Z),_e=z.project(Y),me=this.queryTerrainElevation(Z),we=this.queryTerrainElevation(Y),be=this.queryTerrainElevation(re),Ee=this.queryTerrainElevation(ne),$e=[[oe.x,oe.y,Math.min(me||0,we||0,be||0,Ee||0)],[_e.x,_e.y,Math.max(me||0,we||0,be||0,Ee||0)]];let Ve=i.cd.fromPoints($e);const Qe=z.getWorldToCameraMatrix(),We=i.ab.mat4.invert(new Float64Array(16),Qe);Ve=i.cd.applyTransform(Ve,Qe);const Ke=this._extendAABB(Ve,z,G,S);if(!Ke)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ve=Ke;const Ge=.5*i.ab.vec3.sub([],Ve.max,Ve.min)[2],Ye=this._minimumAABBFrustumDistance(z,Ve),it=[0,0,1,0];i.ab.vec4.transformMat4(it,it,Qe),i.ab.vec4.normalize(it,it);const bt=i.ab.vec3.scale([],it,Ye+Ge),pt=i.ab.vec3.add([],Ve.center,bt);i.ab.vec3.transformMat4(Ve.center,Ve.center,We),i.ab.vec3.transformMat4(pt,pt,We);const kt=z.unproject(new i.P(Ve.center[0],Ve.center[1])),Et=i.dE(z.projection,kt),dt=Math.pow(2,Et),jt=Math.min(z._zoomFromMercatorZ(pt[2]*z.pixelsPerMeter*dt/z.worldSize),G.maxZoom);return z.mercatorFromTransition&&jt<.5*(i.c6+i.bY)?(z.setProjection({name:"globe"}),z.zoom=jt,this._cameraForBounds(z,d,y,S,N,k)):{center:kt,zoom:jt,bearing:S,pitch:N}}fitBounds(o,d,y){const S=this.cameraForBounds(o,d);return this._fitInternal(S,d,y)}fitScreenCoordinates(o,d,y,S,N){const k=i.P.convert(o),z=i.P.convert(d),G=new i.P(Math.min(k.x,z.x),Math.min(k.y,z.y)),Z=new i.P(Math.max(k.x,z.x),Math.max(k.y,z.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(k,z))return this;const Y=this.transform.pointLocation3D(G),re=this.transform.pointLocation3D(Z),ne=this.transform.pointLocation3D(new i.P(G.x,Z.y)),oe=this.transform.pointLocation3D(new i.P(Z.x,G.y)),_e=[Math.min(Y.lng,re.lng,ne.lng,oe.lng),Math.min(Y.lat,re.lat,ne.lat,oe.lat)],me=[Math.max(Y.lng,re.lng,ne.lng,oe.lng),Math.max(Y.lat,re.lat,ne.lat,oe.lat)],we=S&&S.pitch?S.pitch:this.getPitch(),be=this._cameraForBounds(this.transform,_e,me,y,we,S);return this._fitInternal(be,S,N)}_fitInternal(o,d,y){return o?(d=i.l(o,d)).linear?this.easeTo(d,y):this.flyTo(d,y):this}jumpTo(o,d){this.stop();const y=o.preloadOnly?this.transform.clone():this.transform;let S=!1,N=!1,k=!1;"zoom"in o&&y.zoom!==+o.zoom&&(S=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=i.bO.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(N=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(k=!0,y.pitch=+o.pitch);const z=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!y.isPaddingEqual(z))if(o.retainPadding===!1){const G=y.clone();G.padding=z,y.setLocationAtPoint(y.center,G.centerPoint)}else y.padding=z;return o.preloadOnly?(this._preloadTiles(y),this):(this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),S&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),N&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),k&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(Av),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,d){const y=this.transform;if(!y.projection.supportsFreeCamera)return i.w(Av),this;this.stop();const S=y.zoom,N=y.pitch,k=y.bearing;y.setFreeCameraOptions(o);const z=S!==y.zoom,G=N!==y.pitch,Z=k!==y.bearing;return this.fire(new i.z("movestart",d)).fire(new i.z("move",d)),z&&this.fire(new i.z("zoomstart",d)).fire(new i.z("zoom",d)).fire(new i.z("zoomend",d)),Z&&this.fire(new i.z("rotatestart",d)).fire(new i.z("rotate",d)).fire(new i.z("rotateend",d)),G&&this.fire(new i.z("pitchstart",d)).fire(new i.z("pitch",d)).fire(new i.z("pitchend",d)),this.fire(new i.z("moveend",d)),this}easeTo(o,d){this._stop(!1,o.easeId),((o=i.l({offset:[0,0],duration:500,easing:i.dA},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const y=this.transform,S=this.getZoom(),N=this.getBearing(),k=this.getPitch(),z=this.getPadding(),G="zoom"in o?+o.zoom:S,Z="bearing"in o?this._normalizeBearing(o.bearing,N):N,Y="pitch"in o?+o.pitch:k,re=this._extendPadding(o.padding),ne=i.P.convert(o.offset);let oe,_e,me;if(y.projection.name==="globe"){const it=i.aa.fromLngLat(y.center),bt=ne.rotate(-y.angle);it.x+=bt.x/y.worldSize,it.y+=bt.y/y.worldSize;const pt=it.toLngLat(),kt=i.bO.convert(o.center||pt);this._normalizeCenter(kt),oe=y.centerPoint.add(bt),_e=new i.P(it.x,it.y).mult(y.worldSize),me=new i.P(i.at(kt.lng),i.aA(kt.lat)).mult(y.worldSize).sub(_e)}else{oe=y.centerPoint.add(ne);const it=y.pointLocation(oe),bt=i.bO.convert(o.center||it);this._normalizeCenter(bt),_e=y.project(it),me=y.project(bt).sub(_e)}const we=y.zoomScale(G-S);let be,Ee;o.around&&(be=i.bO.convert(o.around),Ee=y.locationPoint(be));const $e=this._zooming||G!==S,Ve=this._rotating||N!==Z,Qe=this._pitching||Y!==k,We=!y.isPaddingEqual(re),Ke=o.retainPadding===!1?y.clone():y,Ge=it=>bt=>{if($e&&(it.zoom=i.af(S,G,bt)),Ve&&(it.bearing=i.af(N,Z,bt)),Qe&&(it.pitch=i.af(k,Y,bt)),We&&(Ke.interpolatePadding(z,re,bt),oe=Ke.centerPoint.add(ne)),be)it.setLocationAtPoint(be,Ee);else{const pt=it.zoomScale(it.zoom-S),kt=G>S?Math.min(2,we):Math.max(.5,we),Et=Math.pow(kt,1-bt),dt=it.unproject(_e.add(me.mult(bt*Et)).mult(pt));it.setLocationAtPoint(it.renderWorldCopies?dt.wrap():dt,oe)}return o.preloadOnly||this._fireMoveEvents(d),it};if(o.preloadOnly){const it=this._emulate(Ge,o.duration,y);return this._preloadTiles(it),this}const Ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=$e,this._rotating=Ve,this._pitching=Qe,this._padding=We,this._easeId=o.easeId,this._prepareEase(d,o.noMoveStart,Ye),this._ease(Ge(y),it=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(d,it)},o),this}_prepareEase(o,d,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),d||y.moving||this.fire(new i.z("movestart",o)),this._zooming&&!y.zooming&&this.fire(new i.z("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new i.z("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new i.z("pitchstart",o))}_fireMoveEvents(o){this.fire(new i.z("move",o)),this._zooming&&this.fire(new i.z("zoom",o)),this._rotating&&this.fire(new i.z("rotate",o)),this._pitching&&this.fire(new i.z("pitch",o))}_afterEase(o,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,S=this._rotating,N=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new i.z("zoomend",o)),S&&this.fire(new i.z("rotateend",o)),N&&this.fire(new i.z("pitchend",o)),this.fire(new i.z("moveend",o))}flyTo(o,d){if(this._prefersReducedMotion(o)){const Ct=i.ay(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ct,d)}this.stop(),o=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},o);const y=this.transform,S=this.getZoom(),N=this.getBearing(),k=this.getPitch(),z=this.getPadding(),G="zoom"in o?i.aw(+o.zoom,y.minZoom,y.maxZoom):S,Z="bearing"in o?this._normalizeBearing(o.bearing,N):N,Y="pitch"in o?+o.pitch:k,re=this._extendPadding(o.padding),ne=y.zoomScale(G-S),oe=i.P.convert(o.offset);let _e=y.centerPoint.add(oe);const me=y.pointLocation(_e),we=i.bO.convert(o.center||me);this._normalizeCenter(we);const be=y.project(me),Ee=y.project(we).sub(be);let $e=o.curve;const Ve=Math.max(y.width,y.height),Qe=Ve/ne,We=Ee.mag();if("minZoom"in o){const Ct=i.aw(Math.min(o.minZoom,S,G),y.minZoom,y.maxZoom),Qt=Ve/y.zoomScale(Ct-S);$e=Math.sqrt(Qt/We*2)}const Ke=$e*$e;function Ge(Ct){const Qt=(Qe*Qe-Ve*Ve+(Ct?-1:1)*Ke*Ke*We*We)/(2*(Ct?Qe:Ve)*Ke*We);return Math.log(Math.sqrt(Qt*Qt+1)-Qt)}function Ye(Ct){return(Math.exp(Ct)-Math.exp(-Ct))/2}function it(Ct){return(Math.exp(Ct)+Math.exp(-Ct))/2}const bt=Ge(0);let pt=function(Ct){return it(bt)/it(bt+$e*Ct)},kt=function(Ct){return Ve*((it(bt)*(Ye(Qt=bt+$e*Ct)/it(Qt))-Ye(bt))/Ke)/We;var Qt},Et=(Ge(1)-bt)/$e;if(Math.abs(We)<1e-6||!isFinite(Et)){if(Math.abs(Ve-Qe)<1e-6)return this.easeTo(o,d);const Ct=Qe<Ve?-1:1;Et=Math.abs(Math.log(Qe/Ve))/$e,kt=function(){return 0},pt=function(Qt){return Math.exp(Ct*$e*Qt)}}o.duration="duration"in o?+o.duration:1e3*Et/("screenSpeed"in o?+o.screenSpeed/$e:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const dt=N!==Z,jt=Y!==k,Gt=!y.isPaddingEqual(re),ft=o.retainPadding===!1?y.clone():y,Ft=Ct=>Qt=>{const $t=Qt*Et,zt=1/pt($t);Ct.zoom=Qt===1?G:S+Ct.scaleZoom(zt),dt&&(Ct.bearing=i.af(N,Z,Qt)),jt&&(Ct.pitch=i.af(k,Y,Qt)),Gt&&(ft.interpolatePadding(z,re,Qt),_e=ft.centerPoint.add(oe));const Yt=Qt===1?we:Ct.unproject(be.add(Ee.mult(kt($t))).mult(zt));return Ct.setLocationAtPoint(Ct.renderWorldCopies?Yt.wrap():Yt,_e),Ct._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(d),Ct};if(o.preloadOnly){const Ct=this._emulate(Ft,o.duration,y);return this._preloadTiles(Ct),this}return this._zooming=!0,this._rotating=dt,this._pitching=jt,this._padding=Gt,this._prepareEase(d,!1),this._ease(Ft(y),()=>this._afterEase(d),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,d)}if(!o){const y=this.handlers;y&&y.stop(!1)}return this}_ease(o,d,y){y.animate===!1||y.duration===0?(o(1),d()):(this._easeStart=i.q.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,d){o=i.bF(o,-180,180);const y=Math.abs(o-d);return Math.abs(o-360-d)<y&&(o-=360),Math.abs(o+360-d)<y&&(o+=360),o}_normalizeCenter(o){const d=this.transform;if(d.maxBounds||d.projection.name!=="globe"&&!d.renderWorldCopies)return;const y=o.lng-d.center.lng;o.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,d,y){const S=Math.ceil(15*d/1e3),N=[],k=o(y.clone());for(let z=0;z<=S;z++){const G=k(z/S);N.push(G.clone())}return N}_preloadTiles(o,d){}}class Ef{constructor(o={}){this.options=o,i.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const d=this.options&&this.options.compact,y=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const S=L("span","mapboxgl-ctrl-icon",this._compactButton);return S.setAttribute("aria-hidden","true"),S.setAttribute("title",y),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),d===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(o){const y=d.reduce((S,N,k)=>(N.value&&(S+=`${N.key}=${N.value}${k<d.length-1?"&":""}`),S),"?");o.href=`${i.e.FEEDBACK_URL}/${y}#${dg(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}const d=this._map.style._mergedSourceCaches;for(const S in d){const N=d[S];if(N.used){const k=N.getSource();k.attribution&&o.indexOf(k.attribution)<0&&o.push(k.attribution)}}o.sort((S,N)=>S.length-N.length),o=o.filter((S,N)=>{for(let k=N+1;k<o.length;k++)if(o[k].indexOf(S)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const y=o.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,o.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class tl{constructor(){i.aP(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=L("div","mapboxgl-ctrl");const d=L("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const d in o){const y=o[d].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const d=o[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class go{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const d=++this._id;return this._queue.push({callback:o,id:d,cancelled:!1}),d}remove(o){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const S of y)if(S.id===o)return void(S.cancelled=!0)}run(o=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class rl{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const d=i.cB((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,d,y){this._start=this.getValue(d),this._end=o,this._startTime=d,this._endTime=d+y}}const _h={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class vd extends i.z{constructor(o,d,y,S){const{point:N,lngLat:k,originalEvent:z,target:G}=o;super(o.type,{point:N,lngLat:k,originalEvent:z,target:G}),this.preventDefault=()=>{o.preventDefault()},this.id=d,this.interaction=y,this.feature=S}}class Yp{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,d){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const y=d.filter;let S=d.type;y&&this.filters.set(o,i.aZ(y)),S==="mouseover"&&(S="mouseenter"),S==="mouseout"&&(S="mouseleave");const N=this.interactionsByType.get(S)||new Map;S==="mouseenter"||S==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,d)):N.size===0&&this.map.on(S,this.handleType),N.size===0&&this.interactionsByType.set(S,N),N.set(o,d),this.typeById.set(o,S)}get(o){const d=this.typeById.get(o);if(!d)return;const y=this.interactionsByType.get(d);return y?y.get(o):void 0}remove(o){const d=this.typeById.get(o);if(!d)return;this.typeById.delete(o),this.filters.delete(o);const y=this.interactionsByType.get(d);y&&(y.delete(o),d==="mouseenter"||d==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(d,this.handleType))}queryTargets(o,d){const y=[];for(const[S,N]of d)N.target&&y.push({targetId:S,target:N.target,filter:this.filters.get(S)});return this.map.style.queryRenderedTargets(o,y,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const d=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());d.length&&(o.type="mouseenter",this.handleType(o,d));const y=new Map;for(const[S,{feature:N}]of this.prevHoveredFeatures)this.hoveredFeatures.has(S)||y.set(N.id,N);y.size&&(o.type="mouseleave",this.handleType(o,Array.from(y.values())))}handleOut(o){const d=Array.from(this.hoveredFeatures.values()).map(({feature:y})=>y);d.length&&(o.type="mouseleave",this.handleType(o,d)),this.hoveredFeatures.clear()}handleType(o,d){const y=Array.from(this.interactionsByType.get(o.type)).reverse(),S=!!d;d=d||this.queryTargets(o.point,y);const N=o.type==="mouseenter";let k=!1;const z=new Set;for(const G of d){for(const[Z,Y]of y){if(!Y.target)continue;const re=G.variants?G.variants[Z]:null;if(re){for(const ne of re){if(Ml(ne,G,z,Z))continue;const oe=new i.cw(G,ne),_e=qu(ne,G,Z);S&&(oe.state=this.map.getFeatureState(oe));const me=N?this.prevHoveredFeatures.get(_e):null,we=new vd(o,Z,Y,oe),be=me?me.stop:Y.handler(we);if(N&&this.hoveredFeatures.set(_e,{feature:G,stop:be}),be!==!1){k=!0;break}}if(k)break}}if(k)break}if(!k)for(const[G,Z]of y){const{handler:Y,target:re}=Z;if(!re&&Y(new vd(o,G,Z,null))!==!1)break}}}function Zn(g,o){if(Array.isArray(g)&&Array.isArray(o)){const d=new Set(g),y=new Set(o);return d.size===y.size&&g.every(S=>y.has(S))}return i.bn(g,o)}const _u={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Xp={showCompass:!0,showZoom:!0,visualizePitch:!1};class yo{constructor(o,d,y=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new $l({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,y&&(this.mousePitch=new Fc({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),i.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(o,d){this.mouseRotate.mousedown(o,d),this.mousePitch&&this.mousePitch.mousedown(o,d),ae()}move(o,d){const y=this.map,S=this.mouseRotate.mousemoveWindow(o,d),N=S&&S.bearingDelta;if(N&&y.setBearing(y.getBearing()+N),this.mousePitch){const k=this.mousePitch.mousemoveWindow(o,d),z=k&&k.pitchDelta;z&&y.setPitch(y.getPitch()+z)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ee(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(i.l({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),he(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,he(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Pe(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=Pe(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function gg(g,o,d){if(g=new i.bO(g.lng,g.lat),o){const y=new i.bO(g.lng-360,g.lat),S=new i.bO(g.lng+360,g.lat),N=360*Math.ceil(Math.abs(g.lng-d.center.lng)/360),k=d.locationPoint(g).distSqr(o),z=o.x<0||o.y<0||o.x>d.width||o.y>d.height;d.locationPoint(y).distSqr(o)<k&&(z||Math.abs(y.lng-d.center.lng)<N)?g=y:d.locationPoint(S).distSqr(o)<k&&(z||Math.abs(S.lng-d.center.lng)<N)&&(g=S)}for(;Math.abs(g.lng-d.center.lng)>180;){const y=d.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=d.width&&y.y<=d.height)break;g.lng>d.center.lng?g.lng-=360:g.lng+=360}return g}const Vc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class nl extends i.E{constructor(o,d){if(super(),(o instanceof HTMLElement||d)&&(o=i.l({element:o},d)),i.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=i.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=L("div");const N=41,k=27,z=$("svg",{display:"block",height:N*this._scale+"px",width:k*this._scale+"px",viewBox:`0 0 ${k} ${N}`},this._element),G=$("radialGradient",{id:"shadowGradient"},$("defs",{},z));$("stop",{offset:"10%","stop-opacity":.4},G),$("stop",{offset:"100%","stop-opacity":.05},G),$("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},z),$("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},z),$("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},z),$("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},z),this._offset=i.P.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",N=>{N.preventDefault()}),this._element.addEventListener("mousedown",N=>{N.preventDefault()});const y=this._element.classList;for(const N in Vc)y.remove(`mapboxgl-marker-anchor-${N}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`);const S=o&&o.className?o.className.trim().split(/\s+/):[];y.add(...S),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=i.bO.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const S=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const d=o.code,y=o.charCode||o.keyCode;d!=="Space"&&d!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(o){const d=o.originalEvent.target,y=this._element;this._popup&&(d===y||y.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,d=this._pos;if(!o||!d)return!1;const y=o.unproject(d),S=o.getFreeCameraOptions();if(!S.position)return!1;const N=S.position.toLngLat();return N.distanceTo(y)<.9*N.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const d=this._pos;if(!d||d.x<0||d.x>o.transform.width||d.y<0||d.y>o.transform.height)return void this._clearFadeTimer();const y=o.unproject(d);let S;o._showingGlobe()&&i.dH(o.transform,this._lngLat)?S=0:(S=1-o._queryFogOpacity(y),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(S*=this._occludedOpacity)),this._element.style.opacity=`${S}`,this._element.style.pointerEvents=S>0?"auto":"none",this._popup&&this._popup._setOpacity(S),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Vc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${d.x}px,${d.y}px)
        `}_calculateXYTransform(){const o=this._pos,d=this._map,y=this.getPitchAlignment();if(!d||!o||y!=="map")return"";if(!d._showingGlobe()){const G=d.getPitch();return G?`rotateX(${G}deg)`:""}const S=i.c4(i.dI(d.transform,this._lngLat)),N=o.sub(i.dJ(d.transform)),k=Math.abs(N.x)+Math.abs(N.y);if(k===0)return"";const z=S/k;return`rotateX(${-N.y*z}deg) rotateY(${N.x*z}deg)`}_calculateZTransform(){const o=this._pos,d=this._map;if(!d||!o)return"";let y=0;const S=this.getRotationAlignment();if(S==="map")if(d._showingGlobe()){const N=d.project(new i.bO(this._lngLat.lng,this._lngLat.lat+.001)),k=d.project(new i.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(N);y=i.c4(Math.atan2(k.y,k.x))-90}else y=-d.getBearing();else if(S==="horizon"){const N=i.ac(4,6,d.getZoom()),k=i.dJ(d.transform);k.y+=N*d.transform.height;const z=o.sub(k),G=i.c4(Math.atan2(z.y,z.x));y=(G>90?G-270:G+90)*(1-N)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=gg(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=i.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const d=this._map;if(!d)return;const y=this._pointerdownPos,S=this._positionDelta;if(y&&S){if(!this._isDragging){const N=this._clickTolerance||d._clickTolerance;if(o.point.dist(y)<N)return;this._isDragging=!0}this._pos=o.point.sub(S),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(o){const d=this._map,y=this._pos;d&&y&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(y),this._pointerdownPos=o.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const d=this._map;return d&&(o?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Gi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},il={maxWidth:100,unit:"metric"},Vr={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},bh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ro=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yg(g=new i.P(0,0),o="bottom"){if(typeof g=="number"){const d=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new i.P(0,g);case"top-left":return new i.P(d,d);case"top-right":return new i.P(-d,d);case"bottom":return new i.P(0,-g);case"bottom-left":return new i.P(d,-d);case"bottom-right":return new i.P(-d,-d);case"left":return new i.P(g,0);case"right":return new i.P(-g,0)}return new i.P(0,0)}return g instanceof i.P||Array.isArray(g)?i.P.convert(g):i.P.convert(g[o]||[0,0])}return{version:x,supported:V.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends xh{constructor(g){A.mark(w.create);const o=g;if((g=i.l({},_u,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&i.dF(window)&&(g.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new of(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._repaint=!!g.repaint,this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new go,this._domRenderTaskQueue=new go,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aV(),this._locale=i.l({},_h,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._tessellationStep=g.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=g.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new rl(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=g.scaleFactor,this._requestManager=new Ce(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,this._contextCreateOptions=g.contextCreateOptions?Object.assign({},g.contextCreateOptions):{},typeof g.container=="string"){const d=document.getElementById(g.container);if(!d)throw new Error(`Container '${g.container.toString()}' not found.`);this._container=d}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),this._spriteFormat=g.spriteFormat,i.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new og),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Zp(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,(g.style||!g.testMode)&&this.setStyle(g.style||i.e.DEFAULT_STYLE,{config:g.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this.indoor=new Ny(this),g.hash&&(this._hash=new By(typeof g.hash=="string"&&g.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch});const d=g.bounds;d&&(this.resize(),this.fitBounds(d,i.l({},g.fitBoundsOptions,{duration:0})))}this.resize(),g.attributionControl&&this.addControl(new Ef({customAttribution:g.customAttribution})),this._logoControl=new tl,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",d=>{this._update(d.dataType==="style"),this.fire(new i.z(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new i.z(`${d.dataType}dataloading`,d))}),this._interactions=new Yp(this)}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[o];return o.indexOf("bottom")!==-1?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new i.z("movestart",g)).fire(new i.z("move",g)),this.fire(new i.z("resize",g)),o&&this.fire(new i.z("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(i.az.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(g){return this._scaleFactor=g,this.painter.scaleFactor=g,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(o=>o.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?navigator.language:Array.isArray(g)?g.length===0?void 0:g.map(o=>o==="auto"?navigator.language:o):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let d;o==="globe"&&g.zoom>=i.bY?(g.setMercatorFromTransition(),d=!0):o==="mercator"&&g.zoom<i.bY&&(g.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;return o=g.name==="globe"&&this.transform.zoom>=i.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(g){return this.transform.locationPoint3D(i.bO.convert(g))}unproject(g){return this.transform.pointLocation3D(i.P.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,d){const y=S=>{let N=[];if(Array.isArray(o)){const k=o.filter(z=>this.getLayer(z));N=k.length?this.queryRenderedFeatures(S,{layers:k}):[]}else N=this.queryRenderedFeatures(S,{target:o});return N};if(g==="mouseenter"||g==="mouseover"){let S=!1;return{listener:d,targets:o,delegates:{mousemove:k=>{const z=y(k.point);z.length?S||(S=!0,d.call(this,new Oo(g,this,k.originalEvent,{features:z}))):S=!1},mouseout:()=>{S=!1}}}}if(g==="mouseleave"||g==="mouseout"){let S=!1;return{listener:d,targets:o,delegates:{mousemove:z=>{y(z.point).length?S=!0:S&&(S=!1,d.call(this,new Oo(g,this,z.originalEvent)))},mouseout:z=>{S&&(S=!1,d.call(this,new Oo(g,this,z.originalEvent)))}}}}{const S=N=>{const k=y(N.point);k.length&&(N.features=k,d.call(this,N),delete N.features)};return{listener:d,targets:o,delegates:{[g]:S}}}}on(g,o,d){if(typeof o=="function"||d===void 0)return super.on(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(g,o,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const S in y.delegates)this.on(S,y.delegates[S]);return this}once(g,o,d){if(typeof o=="function"||d===void 0)return super.once(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(g,o,d);for(const S in y.delegates)this.once(S,y.delegates[S]);return this}off(g,o,d){if(typeof o=="function"||d===void 0)return super.off(g,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._delegatedListeners?this._delegatedListeners[g]:void 0;return y&&(S=>{for(let N=0;N<S.length;N++){const k=S[N];if(k.listener===d&&Zn(k.targets,o)){for(const z in k.delegates)this.off(z,k.delegates[z]);return S.splice(N,1),this}}})(y),this}queryRenderedFeatures(g,o){if(!this.style)return[];if(g===void 0||g instanceof i.P||Array.isArray(g)||o!==void 0||(o=g,g=void 0),g=g||[[0,0],[this.transform.width,this.transform.height]],!o){const N=this.style.queryRenderedFeatures(g,void 0,this.transform),k=this.style.queryRenderedFeatureset(g,void 0,this.transform);return N.concat(k)}let d=!0;if(o.target&&(d=this._isTargetValid(o.target),d&&!o.layers))return this.style.queryRenderedFeatureset(g,o,this.transform);let y=!0;if(o.layers&&Array.isArray(o.layers)){for(const N of o.layers)if(!this._isValidId(N)){y=!1;break}if(y&&!o.target)return this.style.queryRenderedFeatures(g,o,this.transform)}let S=[];return y&&(S=S.concat(this.style.queryRenderedFeatures(g,o,this.transform))),d&&(S=S.concat(this.style.queryRenderedFeatureset(g,o,this.transform))),S}querySourceFeatures(g,o){return!g||typeof g=="string"&&!this._isValidId(g)?[]:this.style.querySourceFeatures(g,o)}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&i.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(g))}addInteraction(g,o){return this._interactions.add(g,o),this}removeInteraction(g){return this._interactions.remove(g),this}setStyle(g,o){return o=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&g&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(g,(d,y)=>{d?(i.w(`Unable to perform style diff: ${String(d.message||d.error||d)}. Rebuilding the style from scratch.`),this._updateStyle(g,o)):y&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g){const d=i.l({},o);o&&o.config&&(d.initialConfig=o.config,delete d.config),this.style=new Ko(this,d).load(g),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ko(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(g){return g==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cr(g)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${g}".`))),!1)}_isTargetValid(g){return"featuresetId"in g?this._isValidId("importId"in g?g.importId:g.featuresetId):"layerId"in g&&this._isValidId(g.layerId)}_areTargetsValid(g){if(Array.isArray(g)){for(const o of g)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(g)}addSource(g,o){return this._isValidId(g)?(this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)):this}isSourceLoaded(g){return!!this._isValidId(g)&&!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(g,o,d){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,d)}removeSource(g){return this._isValidId(g)?(this.style.removeSource(g),this._updateTerrain(),this._update(!0)):this}getSource(g){return this._isValidId(g)?this.style.getOwnSource(g):null}addImage(g,o,{pixelRatio:d=1,sdf:y=!1,stretchX:S,stretchY:N,content:k}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:z,height:G,data:Z}=i.q.getImageData(o);this.style.addImage(g,{data:new i.r({width:z,height:G},Z),pixelRatio:d,stretchX:S,stretchY:N,content:k,sdf:y,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:z,height:G}=o,Z=o;this.style.addImage(g,{data:new i.r({width:z,height:G},new Uint8Array(Z.data)),pixelRatio:d,stretchX:S,stretchY:N,content:k,sdf:y,usvg:!1,version:0,userImage:Z}),Z.onAdd&&Z.onAdd(this,g)}}updateImage(g,o){this._lazyInitEmptyStyle();const d=this.style.getImage(g);if(!d)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?i.q.getImageData(o):o,{width:S,height:N,data:k}=y;if(S===void 0||N===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==(d.usvg?d.icon.usvg_tree.width:d.data.width)||N!==(d.usvg?d.icon.usvg_tree.height:d.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${S}, ${N})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`)));const z=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let G=!1;d.usvg?(d.data=new i.r({width:S,height:N},new Uint8Array(k)),d.usvg=!1,d.icon=void 0,G=!0):d.data.replace(k,z),this.style.updateImage(g,d,G)}hasImage(g){return g?!!this.style&&!!this.style.getImage(g):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,o){i.o(this._requestManager.transformRequest(g,i.R.Image),(d,y)=>{o(d,y instanceof HTMLImageElement?i.q.getImageData(y):y)})}listImages(){return this.style.listImages()}addModel(g,o){this._lazyInitEmptyStyle(),this.style.addModel(g,o)}hasModel(g){return g?this.style.hasModel(g):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(g){this.style.removeModel(g)}listModels(){return this.style.listModels()}addLayer(g,o){return this._isValidId(g.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)):this}getSlot(g){const o=this.getLayer(g);return o&&o.slot||null}setSlot(g,o){return this.style.setSlot(g,o),this.style.mergeLayers(),this._update(!0)}addImport(g,o){return this.style.addImport(g,o),this}updateImport(g,o){return typeof o!="string"&&o.id!==g?(this.removeImport(g),this.addImport(o)):(this.style.updateImport(g,o),this._update(!0))}removeImport(g){return this.style.removeImport(g),this}moveImport(g,o){return this.style.moveImport(g,o),this._update(!0)}moveLayer(g,o){return this._isValidId(g)?(this.style.moveLayer(g,o),this._update(!0)):this}removeLayer(g){return this._isValidId(g)?(this.style.removeLayer(g),this._update(!0)):this}getLayer(g){if(!this._isValidId(g))return null;const o=this.style.getOwnLayer(g);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(g,o,d){return this._isValidId(g)?(this.style.setLayerZoomRange(g,o,d),this._update(!0)):this}setFilter(g,o,d={}){return this._isValidId(g)?(this.style.setFilter(g,o,d),this._update(!0)):this}getFilter(g){return this._isValidId(g)?this.style.getFilter(g):null}setPaintProperty(g,o,d,y={}){return this._isValidId(g)?(this.style.setPaintProperty(g,o,d,y),this._update(!0)):this}getPaintProperty(g,o){return this._isValidId(g)?this.style.getPaintProperty(g,o):null}setLayoutProperty(g,o,d,y={}){return this._isValidId(g)?(this.style.setLayoutProperty(g,o,d,y),this._update(!0)):this}getLayoutProperty(g,o){return this._isValidId(g)?this.style.getLayoutProperty(g,o):null}getSchema(g){return this.style.getSchema(g)}setSchema(g,o){return this.style.setSchema(g,o),this._update(!0)}getConfig(g){return this.style.getConfig(g)}setConfig(g,o){return this.style.setConfig(g,o),this._update(!0)}getConfigProperty(g,o){return this.style.getConfigProperty(g,o)}setConfigProperty(g,o,d){return this.style.setConfigProperty(g,o,d),this._update(!0)}getFeaturesetDescriptors(g){return this.style.getFeaturesetDescriptors(g)}setLights(g){if(this._lazyInitEmptyStyle(),g&&g.length===1&&g[0].type==="flat"){const o=g[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(g),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const g=this.style.getLights()||[];return g.length===0&&g.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),g}setLight(g,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:g}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(g){return this._lazyInitEmptyStyle(),this.style.setSnow(g),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(g){return this._lazyInitEmptyStyle(),this.style.setRain(g),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(g){return this._lazyInitEmptyStyle(),this.style.setColorTheme(g),this._update(!0)}setImportColorTheme(g,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(g,o),this._update(!0)}setCamera(g){return this.style.setCamera(g),this._triggerCameraUpdate(g)}_triggerCameraUpdate(g){return this._update(this.transform.setOrthographicProjectionAtLowPitch(g["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bO.convert(g),this.transform):0}setFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.setFeatureState(g,o),this._update())}removeFeatureState(g,o){return g.source&&!this._isValidId(g.source)?this:(this.style.removeFeatureState(g,o),this._update())}getFeatureState(g){return g.source&&!this._isValidId(g.source)?null:this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let d,y,S,N=this._container;for(;N&&(!y||!S);){const k=window.getComputedStyle(N).transform;k&&k!=="none"&&(d=k.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&d[0]!=="0"&&d[0]!=="1"&&(y=d[0]),d[3]&&d[3]!=="0"&&d[3]!=="1"&&(S=d[3])),N=N.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=S?Math.abs(o/S):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=L("div","mapboxgl-canvas-container",g);this._canvas=L("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=L("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(S=>{y[S]=L("div",`mapboxgl-ctrl-${S}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const d=i.q.devicePixelRatio||1;this._canvas.width=d*Math.ceil(g),this._canvas.height=d*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=i.l({},V.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",g);o?(Dt(o,!0),this.painter=new ug(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",d=>{d.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(o)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;this.fire(new i.z("renderstart")),++this._frameId;const d=this.painter.context.extTimerQuery,y=i.q.now(),S=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=S.createQuery(),S.beginQuery(d.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const N=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const Z=this.transform.zoom,Y=this.transform.pitch,re=i.q.now(),ne=new i.a8(Z,{now:re,fadeDuration:N,pitch:Y,transition:this.style.transition});this.style.update(ne)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let k=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),k=this._updateAverageElevation(y),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):k=this._updateAverageElevation(y);const z=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,N,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),z&&(this._placementDirty=z.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:N,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,A.mark(w.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const Z=i.q.now()-y;S.endQuery(d.TIME_ELAPSED_EXT),setTimeout(()=>{const Y=S.getQueryParameter(o,S.QUERY_RESULT)/1e6;S.deleteQuery(o),this.fire(new i.z("gpu-timing-frame",{cpuTime:Z,gpuTime:Y}))},50)}if(this.listens("gpu-timing-layer")){const Z=this.painter.collectGpuTimers();setTimeout(()=>{const Y=this.painter.queryGpuTimers(Z);this.fire(new i.z("gpu-timing-layer",{layerTimes:Y}))},50)}if(this.listens("gpu-timing-deferred-render")){const Z=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Y=this.painter.queryGpuTimeDeferredRender(Z);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:Y}))},50)}const G=this._sourcesDirty||this._styleDirty||this._placementDirty||k;if(G||this._repaint)this.triggerRepaint();else{const Z=this.idle();if(Z&&(k=this._updateAverageElevation(y,!0)),k)this.triggerRepaint();else if(this._triggerFrame(!1),Z&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Y=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:Y})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,A.mark(w.fullLoad),this._performanceMetricsCollection&&ir(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const d=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&d(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const S=this.transform.averageElevation;let N=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(N)?N=0:this._averageElevationLastSampledAt=g;const k=Math.abs(S-N);if(k>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(N),d(N);this._averageElevation.easeTo(N,g,300)}else if(k>1e-4)return this._averageElevation.jumpTo(N),d(N)}return!!this._averageElevation.isEasing(g)&&d(this._averageElevation.getValue(g))}_authenticate(){De(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===xe||g.status===401)){const o=this.painter.context.gl;Dt(o,!1),this._logoControl instanceof tl&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Lt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Xt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const d=this.painter.context.gl,y=d.createFramebuffer();function S(N){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,N,0);const k=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,k),k}return d.bindFramebuffer(d.FRAMEBUFFER,y),this._canvasPixelComparison(S(g),o.canvasCopies.map(S),o.timeStamps)}_canvasPixelComparison(g,o,d){let y=d[1]-d[0];const S=g.length/4;for(let N=0;N<o.length;N++){const k=o[N];let z=0;for(let G=0;G<k.length;G+=4)k[G]===g[G]&&k[G+1]===g[G+1]&&k[G+2]===g[G+2]&&k[G+3]===g[G+3]&&(z+=1);y+=(d[N+2]-d[N+1])*(1-z/S)}return y}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),jr.delete(this.painter.context.gl),Bt.remove(),qe.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=i.q.frame(o=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(o)}))}_preloadTiles(g){const o=this.style?this.style.getSourceCaches():[];return i.bl(o,(d,y)=>d._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(g){this._showParseStatus!==g&&(this._showParseStatus=g,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(g){this._showLayers2DWireframe!==g&&(this._showLayers2DWireframe=g,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(g){this._showLayers3DWireframe!==g&&(this._showLayers3DWireframe=g,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,this._tp.refreshUI(),g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,this._tp.refreshUI(),g&&this._update())}_setCacheLimits(g,o){i.dG(g,o)}get version(){return x}},NavigationControl:class{constructor(g={}){this.options=i.l({},Xp,g),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(i.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:o}):d.resetNorth({},{originalEvent:o}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),d=o===g.getMaxZoom(),y=o===g.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yo(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const d=L("button",g,this._container);return d.type="button",d.addEventListener("click",o),d}_setButtonTitle(g,o){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",d),g.firstElementChild&&g.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends i.E{constructor(g={}){super();const o=navigator.geolocation;this.options=i.l({geolocation:o},Gi,g),i.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=qp(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,g(d)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(d=>o(d.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),d=g.coords;return!!o&&(d.longitude<o.getWest()||d.longitude>o.getEast()||d.latitude<o.getSouth()||d.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",g)),this._finish()}}_updateCamera(g){const o=new i.bO(g.coords.longitude,g.coords.latitude),d=g.coords.accuracy,y=this._map.getBearing(),S=i.l({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(d),S,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new i.bO(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=i.bH(1,g._center.lat)*g.worldSize,d=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new nl({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new nl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ef,ScaleControl:class{constructor(g={}){this.options=i.l({},il,g),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,d=o._containerHeight/2,y=o._containerWidth/2-g/2,S=o.unproject([y,d]),N=o.unproject([y+g,d]),k=S.distanceTo(N);if(this.options.unit==="imperial"){const z=3.2808*k;z>5280?this._setScale(g,z/5280,"mile"):this._setScale(g,z,"foot")}else this.options.unit==="nautical"?this._setScale(g,k/1852,"nautical-mile"):k>=1e3?this._setScale(g,k/1e3,"kilometer"):this._setScale(g,k,"meter")}_setScale(g,o,d){this._map._requestDomTask(()=>{const y=function(N){const k=Math.pow(10,`${Math.floor(N)}`.length-1);let z=N/k;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(G){const Z=Math.pow(10,Math.ceil(-Math.log(G)/Math.LN10));return Math.round(G*Z)/Z}(z),k*z}(o),S=y/o;this._container.innerHTML=this._isNumberFormatSupported&&d!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:d}).format(y):`${y}&nbsp;${Vr[d]}`,this._container.style.width=g*S+"px"})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g={}){this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:i.w("Full screen control 'container' must be a DOM element.")),i.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(g){super(),this.options=i.l(Object.create(bh),g),i.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=i.bO.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const o=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=g;y=d.firstChild,y;)o.appendChild(y);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const d=this._closeButton=L("button","mapboxgl-popup-close-button",o);d.type="button",d.setAttribute("aria-label","Close popup"),d.innerHTML='<span aria-hidden="true">&#215;</span>',d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,d=this._container,y=this._pos;if(!o||!d||!y)return"bottom";const S=d.offsetWidth,N=d.offsetHeight,k=y.x<S/2,z=y.x>o.transform.width-S/2;if(y.y+g<N)return k?"top-left":z?"top-right":"top";if(y.y>o.transform.height-N){if(k)return"bottom-left";if(z)return"bottom-right"}return k?"left":z?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,d=this._content;if(!o||!this._lngLat&&!this._trackPointer||!d)return;let y=this._container;if(y||(y=this._container=L("div","mapboxgl-popup",o.getContainer()),this._tip=L("div","mapboxgl-popup-tip",y),y.appendChild(d)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gg(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const S=this._pos=this._trackPointer&&g instanceof i.P?g:o.project(this._lngLat),N=yg(this.options.offset),k=this._anchor=this._getAnchor(N.y),z=yg(this.options.offset,k),G=S.add(z).round();o._requestDomTask(()=>{this._container&&k&&(this._container.style.transform=`${Vc[k]} translate(${G.x}px,${G.y}px)`)})}if(!this._marker&&o._showingGlobe()){const S=i.dH(o.transform,this._lngLat)?0:1;this._setOpacity(S)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(ro);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:nl,Style:Ko,LngLat:i.bO,LngLatBounds:i.az,Point:i.P,MercatorCoordinate:i.aa,FreeCameraOptions:wp,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(g){i.e.ACCESS_TOKEN=g},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(g){i.e.API_URL=g},get workerCount(){return i.dO.workerCount},set workerCount(g){i.dO.workerCount=g},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){i.e.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){i.dP(g)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(g){i.dQ.workerUrl=g},get workerClass(){return i.dQ.workerClass},set workerClass(g){i.dQ.workerClass=g},get workerParams(){return i.dQ.workerParams},set workerParams(g){i.dQ.workerParams=g},get dracoUrl(){return i.dR()},set dracoUrl(g){i.dS(g)},get meshoptUrl(){return i.dT()},set meshoptUrl(g){i.dU(g)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var f=a;return f})}(NA)),NA.exports}var TUe=AUe();const sA=la(TUe),ZO={Mati:{lat:6.90543,lng:126.198137},Baganga:{lat:7.138566,lng:126.19839},Banaybanay:{lat:7.052637,lng:126.271871},Caraga:{lat:7.040689,lng:126.405736},Cateel:{lat:7.03907,lng:126.073971},"Governor Generoso":{lat:7.023682,lng:126.135764},Lupon:{lat:6.996579,lng:126.157647},Manay:{lat:6.910817,lng:125.976873},"San Isidro":{lat:7.026718,lng:126.399461},Tarragona:{lat:7.090034,lng:126.217449},Boston:{lat:6.969014,lng:126.235561},Maco:{lat:7.036735,lng:126.414316},Mabini:{lat:7.012285,lng:125.970299},Pantukan:{lat:7.008709,lng:125.964125},Mawab:{lat:7.002258,lng:126.393666},Monkayo:{lat:6.950413,lng:126.203313},"New Bataan":{lat:7.037214,lng:125.949183},Compostela:{lat:7.0845,lng:126.9761},Laak:{lat:6.9046,lng:126.5307},Maragusan:{lat:7.1389,lng:126.2254}};function PUe(e,t="",r=""){if(!e)return null;const n=e.trim().replace(/\s+/g," ");if(ZO[n])return ZO[n];const a=n.toLowerCase();for(const[c,f]of Object.entries(ZO))if(c.toLowerCase().includes(a)||a.includes(c.toLowerCase()))return f;return console.warn(`No coordinates found for municipality: ${e}`),null}const NUe=({analyticsData:e,className:t=""})=>{const[r,n]=W.useState(!1),[a,c]=W.useState("year-over-year"),[f,i]=W.useState(null),[x,w]=W.useState(!1);W.useEffect(()=>{const ae=()=>{const ce=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;n(ce)};ae();const ee=new MutationObserver(ae);ee.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const se=window.matchMedia("(prefers-color-scheme: dark)");return se.addEventListener("change",ae),()=>{ee.disconnect(),se.removeEventListener("change",ae)}},[]),W.useEffect(()=>{if(!e)return;w(!0);const ae=A(e,a);i(ae),w(!1)},[e,a]);const A=(ae,ee)=>{if(!ae||!ae.trends||!ae.trends.monthly)return null;const se=ae.trends.monthly,ce=new Date().getFullYear();switch(ee){case"year-over-year":return P(se,ce);case"quarterly":return E(se);case"monthly-trend":return D(se);case"severity-comparison":return V(ae);default:return null}},P=(ae,ee)=>{const se=ae.filter(Pe=>Pe._id.year===ee),ce=ae.filter(Pe=>Pe._id.year===ee-1);return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((Pe,Ne)=>{const pe=se.find(xe=>xe._id.month===Ne+1),je=ce.find(xe=>xe._id.month===Ne+1);return{month:Pe,current:(pe==null?void 0:pe.count)||0,previous:(je==null?void 0:je.count)||0,change:pe&&je?(pe.count-je.count)/je.count*100:0}})},E=ae=>{const ee=[{name:"Q1",months:[1,2,3]},{name:"Q2",months:[4,5,6]},{name:"Q3",months:[7,8,9]},{name:"Q4",months:[10,11,12]}],se=new Date().getFullYear(),ce=ae.filter(Pe=>Pe._id.year===se),he=ae.filter(Pe=>Pe._id.year===se-1);return ee.map(Pe=>{const Ne=ce.filter(je=>Pe.months.includes(je._id.month)).reduce((je,xe)=>je+xe.count,0),pe=he.filter(je=>Pe.months.includes(je._id.month)).reduce((je,xe)=>je+xe.count,0);return{quarter:Pe.name,current:Ne,previous:pe,change:pe>0?(Ne-pe)/pe*100:0}})},D=ae=>{const ee=new Date().getFullYear(),se=ae.filter(ce=>ce._id.year===ee);return se.map(ce=>({month:new Date(ce._id.year,ce._id.month-1).toLocaleDateString("en-US",{month:"short"}),accidents:ce.count,cumulative:se.filter(he=>he._id.month<=ce._id.month).reduce((he,Pe)=>he+Pe.count,0)}))},V=ae=>{if(!ae.distributions||!ae.distributions.severity)return null;const ee=ae.distributions.severity,se=ee.reduce((ce,he)=>ce+he.count,0);return ee.map(ce=>({severity:ce._id.charAt(0).toUpperCase()+ce._id.slice(1),count:ce.count,percentage:(ce.count/se*100).toFixed(1),trend:Math.random()>.5?"up":"down"}))},L=()=>r?["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4"]:["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],$=()=>{if(!f||x)return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});switch(a){case"year-over-year":return l.jsx(_o,{width:"100%",height:300,children:l.jsxs(T4,{data:f,children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:r?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(ae,ee)=>[ae,ee==="current"?"Current Year":"Previous Year"]}),l.jsx(Yf,{}),l.jsx(ds,{dataKey:"previous",fill:L()[1],fillOpacity:.6,name:"Previous Year"}),l.jsx(ds,{dataKey:"current",fill:L()[0],name:"Current Year"})]})});case"quarterly":return l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Cu,{data:f,children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"quarter",stroke:r?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:r?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),l.jsx(ds,{dataKey:"current",fill:L()[0],name:"Current Year"}),l.jsx(ds,{dataKey:"previous",fill:L()[1],name:"Previous Year"})]})});case"monthly-trend":return l.jsx(_o,{width:"100%",height:300,children:l.jsxs(A4,{data:f,children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"month",stroke:r?"#9ca3af":"#6b7280"}),l.jsx(Ra,{yAxisId:"left",stroke:r?"#9ca3af":"#6b7280"}),l.jsx(Ra,{yAxisId:"right",orientation:"right",stroke:r?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"}}),l.jsx(Yf,{}),l.jsx(op,{yAxisId:"left",type:"monotone",dataKey:"accidents",stroke:L()[0],strokeWidth:3,name:"Monthly Accidents"}),l.jsx(op,{yAxisId:"right",type:"monotone",dataKey:"cumulative",stroke:L()[1],strokeWidth:2,strokeDasharray:"5 5",name:"Cumulative Total"})]})});case"severity-comparison":return l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Cu,{data:f,children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:r?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"severity",stroke:r?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:r?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:r?"#1f2937":"#ffffff",border:r?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:r?"#f9fafb":"#111827"},formatter:(ae,ee)=>[ee==="count"?`${ae} accidents`:`${ae}%`,ee==="count"?"Count":"Percentage"]}),l.jsx(ds,{dataKey:"count",fill:L()[2]})]})});default:return null}},H=()=>{switch(a){case"year-over-year":return"Year-over-Year Comparison";case"quarterly":return"Quarterly Analysis";case"monthly-trend":return"Monthly Trend Analysis";case"severity-comparison":return"Severity Distribution Comparison";default:return"Comparison Analysis"}},K=()=>{switch(a){case"year-over-year":return"Compare current year accident data with previous year";case"quarterly":return"Quarterly breakdown of accident trends";case"monthly-trend":return"Monthly accident patterns with cumulative totals";case"severity-comparison":return"Accident severity distribution analysis";default:return"Comparative analysis of accident data"}},Q=()=>{if(!f||f.length===0)return null;switch(a){case"year-over-year":const ae=f.reduce((ce,he)=>ce+he.current,0),ee=f.reduce((ce,he)=>ce+he.previous,0),se=ee>0?(ae-ee)/ee*100:0;return l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[l.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Current Year"}),l.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:ae}),l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Total accidents"})]}),l.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Previous Year"}),l.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:ee}),l.jsx("div",{className:"text-xs text-green-600 dark:text-green-400",children:"Total accidents"})]}),l.jsxs("div",{className:`p-3 rounded-lg ${se>=0?"bg-red-50 dark:bg-red-950/20":"bg-green-50 dark:bg-green-950/20"}`,children:[l.jsx("div",{className:`text-sm font-medium ${se>=0?"text-red-700 dark:text-red-300":"text-green-700 dark:text-green-300"}`,children:"Year-over-Year Change"}),l.jsxs("div",{className:`text-lg font-bold ${se>=0?"text-red-900 dark:text-red-100":"text-green-900 dark:text-green-100"}`,children:[se>=0?"+":"",se.toFixed(1),"%"]}),l.jsx("div",{className:`text-xs ${se>=0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:se>=0?"Increase":"Decrease"})]})]});default:return null}};return l.jsxs(Ci,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[l.jsx(zi,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(yP,{className:"h-5 w-5 text-purple-500"}),H()]}),l.jsx(As,{children:K()})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs(Uo,{value:a,onValueChange:c,children:[l.jsx(So,{className:"w-[180px]",children:l.jsx($o,{})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"year-over-year",children:"Year-over-Year"}),l.jsx(pn,{value:"quarterly",children:"Quarterly"}),l.jsx(pn,{value:"monthly-trend",children:"Monthly Trend"}),l.jsx(pn,{value:"severity-comparison",children:"Severity Comparison"})]})]})})]})}),l.jsxs(Ii,{children:[$(),Q()]})]})},jUe=({accidents:e,className:t=""})=>{const r=W.useRef(null),n=W.useRef(null),[a,c]=W.useState(!1),[f,i]=W.useState(!1),[x,w]=W.useState(!1),[A,P]=W.useState(!0),[E,D]=W.useState(!1),[V,L]=W.useState("all"),[$,H]=W.useState("streets"),[K,Q]=W.useState(!1);W.useEffect(()=>{const pe=()=>{const Ce=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;w(Ce)};pe();const je=new MutationObserver(pe);je.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const xe=window.matchMedia("(prefers-color-scheme: dark)");return xe.addEventListener("change",pe),()=>{je.disconnect(),xe.removeEventListener("change",pe)}},[]);const ae=pe=>{const je={streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-v9",outdoors:"mapbox://styles/mapbox/outdoors-v12",light:"mapbox://styles/mapbox/light-v11",dark:"mapbox://styles/mapbox/dark-v11"};return je[pe]||je.streets};W.useEffect(()=>{if(!e||e.length===0)return;const pe="pk.eyJ1IjoiY2xhcmVuY2VqYXBpbmFuIiwiYSI6ImNtOGk1NGh3bjA5bWwya3B0a2lzMGk0eDkifQ.Px83G0Hg6bYtv9E9teOTpQ";if(sA.accessToken=pe,!n.current)try{n.current=new sA.Map({container:r.current,style:ae($),center:[125.971907,6.90543],zoom:9}),n.current.addControl(new sA.NavigationControl,"top-right"),n.current.on("load",()=>{c(!0),ee()}),n.current.on("error",je=>{console.error("Map error:",je),i(!0)})}catch(je){console.error("Map initialization error:",je),i(!0);return}return()=>{n.current&&(n.current.remove(),n.current=null)}},[e]),W.useEffect(()=>{if(n.current&&a&&!K){Q(!0);try{n.current.setStyle(ae($)),n.current.once("styledata",()=>{ee(),Q(!1)}),setTimeout(()=>{Q(!1)},3e3)}catch(pe){console.error("Style change error:",pe),i(!0),Q(!1)}}},[$,a]),W.useEffect(()=>{a&&n.current&&ee()},[a,A,E,V]);const ee=()=>{if(!n.current||!a)return;const pe=se();n.current.getLayer("clusters")&&n.current.removeLayer("clusters"),n.current.getLayer("cluster-count")&&n.current.removeLayer("cluster-count"),n.current.getLayer("unclustered-point")&&n.current.removeLayer("unclustered-point"),n.current.getLayer("heatmap")&&n.current.removeLayer("heatmap"),n.current.getSource("accidents")&&n.current.removeSource("accidents"),n.current.addSource("accidents",{type:"geojson",data:pe,cluster:A,clusterMaxZoom:14,clusterRadius:50}),A&&(n.current.addLayer({id:"clusters",type:"circle",source:"accidents",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",10,"#f1f075",30,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,10,20,30,25]}}),n.current.addLayer({id:"cluster-count",type:"symbol",source:"accidents",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}})),n.current.addLayer({id:"unclustered-point",type:"circle",source:"accidents",filter:["!",["has","point_count"]],paint:{"circle-color":["case",["==",["get","severity"],"fatal"],"#dc2626",["==",["get","severity"],"severe"],"#ea580c",["==",["get","severity"],"moderate"],"#f59e0b",["==",["get","severity"],"minor"],"#16a34a","#6b7280"],"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),E&&n.current.addLayer({id:"heatmap",type:"heatmap",source:"accidents",maxzoom:15,paint:{"heatmap-weight":["interpolate",["linear"],["case",["==",["get","severity"],"fatal"],4,["==",["get","severity"],"severe"],3,["==",["get","severity"],"moderate"],2,["==",["get","severity"],"minor"],1,0],0,0,1,1,2,2,3,3,4,4],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,15,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,15,20],"heatmap-opacity":["interpolate",["linear"],["zoom"],7,1,15,0]}}),n.current.on("click","clusters",je=>{const xe=n.current.queryRenderedFeatures(je.point,{layers:["clusters"]}),Ce=xe[0].properties.cluster_id;n.current.getSource("accidents").getClusterExpansionZoom(Ce,(ze,Te)=>{ze||n.current.easeTo({center:xe[0].geometry.coordinates,zoom:Te})})}),n.current.on("click","unclustered-point",je=>{const xe=je.features[0].geometry.coordinates.slice(),Ce=je.features[0].properties;new sA.Popup().setLngLat(xe).setHTML(ce(Ce)).addTo(n.current)}),n.current.on("mouseenter","clusters",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","clusters",()=>{n.current.getCanvas().style.cursor=""}),n.current.on("mouseenter","unclustered-point",()=>{n.current.getCanvas().style.cursor="pointer"}),n.current.on("mouseleave","unclustered-point",()=>{n.current.getCanvas().style.cursor=""})},se=()=>({type:"FeatureCollection",features:e.filter(je=>!(V!=="all"&&je.severity!==V)).map(je=>{let xe=null;if(je.municipality){const Ce=PUe(je.municipality,je.barangay,je.street);Ce&&(xe=[Ce.lng,Ce.lat])}return xe?{type:"Feature",properties:{id:je.accident_id,severity:je.severity||"unknown",plateNo:je.plateNo,vehicle_type:je.vehicle_type,municipality:je.municipality,barangay:je.barangay,street:je.street,accident_date:je.accident_date,notes:je.notes},geometry:{type:"Point",coordinates:xe}}:null}).filter(je=>je!==null)}),ce=pe=>`
      <div style="padding: 12px; min-width: 220px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
        <h3 style="margin: 0 0 10px 0; font-size: 16px; font-weight: bold; color: #1f2937; border-bottom: 1px solid #e5e7eb; padding-bottom: 6px;">
          ${pe.id||"Accident ID: N/A"}
        </h3>
        <div style="font-size: 13px; line-height: 1.5; color: #374151;">
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Plate:</strong> ${pe.plateNo||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Severity:</strong> 
            <span style="color: ${he(pe.severity)}; font-weight: bold; text-transform: uppercase;">
              ${pe.severity||"Unknown"}
            </span>
          </p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Vehicle:</strong> ${pe.vehicle_type||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Location:</strong> ${pe.municipality||"N/A"}, ${pe.barangay||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Street:</strong> ${pe.street||"N/A"}</p>
          <p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Date:</strong> ${pe.accident_date?new Date(pe.accident_date).toLocaleDateString():"N/A"}</p>
          ${pe.notes?`<p style="margin: 4px 0; color: #1f2937;"><strong style="color: #111827;">Notes:</strong> ${pe.notes}</p>`:""}
        </div>
      </div>
    `,he=pe=>{switch(pe){case"fatal":return"#dc2626";case"severe":return"#ea580c";case"moderate":return"#f59e0b";case"minor":return"#16a34a";default:return"#6b7280"}},Pe=()=>{n.current&&n.current.flyTo({center:[125.971907,6.90543],zoom:9,duration:1e3})},Ne=()=>{const pe=["streets","satellite","outdoors","light","dark"],xe=(pe.indexOf($)+1)%pe.length;i(!1),H(pe[xe])};return f?l.jsxs(Ci,{className:t,children:[l.jsx(zi,{children:l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(Hc,{className:"h-5 w-5 text-red-500"}),"Map Error"]})}),l.jsx(Ii,{children:l.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:l.jsxs("div",{className:"text-center text-gray-500",children:[l.jsx("div",{className:"text-lg font-medium",children:"Map unavailable"}),l.jsx("div",{className:"text-sm mb-4",children:"Unable to load map. This might be due to:"}),l.jsxs("ul",{className:"text-xs text-left space-y-1 mb-4",children:[l.jsx("li",{children:"• Internet connection issues"}),l.jsx("li",{children:"• Mapbox token configuration"}),l.jsx("li",{children:"• Style loading problems"})]}),l.jsx("button",{onClick:()=>{i(!1),c(!1),n.current&&(n.current.remove(),n.current=null)},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",children:"Retry"})]})})})]}):!e||e.length===0?l.jsxs(Ci,{className:t,children:[l.jsx(zi,{children:l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-5 w-5 text-blue-500"}),"Accident Map"]})}),l.jsx(Ii,{children:l.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg",children:l.jsxs("div",{className:"text-center text-gray-500",children:[l.jsx("div",{className:"text-lg font-medium",children:"No location data available"}),l.jsx("div",{className:"text-sm",children:"Accidents in this period don't have coordinate information"})]})})})]}):l.jsxs(Ci,{className:`group hover:shadow-lg transition-all duration-300 ${t}`,children:[l.jsx(zi,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-5 w-5 text-blue-500"}),"Accident Map"]}),l.jsx(As,{children:"Interactive map with clustering, heat layers, and advanced filtering"})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs(us,{variant:"outline",className:"text-xs",children:[e.length," Accidents"]})})]})}),l.jsx(Ii,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-2 p-3 bg-muted/30 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(Nr,{variant:A?"default":"outline",size:"sm",onClick:()=>P(!A),className:"flex items-center gap-1",children:[l.jsx(fH,{className:"h-4 w-4"}),"Clusters"]}),l.jsxs(Nr,{variant:E?"default":"outline",size:"sm",onClick:()=>D(!E),className:"flex items-center gap-1",children:[l.jsx($B,{className:"h-4 w-4"}),"Heatmap"]})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("select",{value:V,onChange:pe=>L(pe.target.value),className:"px-2 py-1 text-sm border rounded-md bg-background",children:[l.jsx("option",{value:"all",children:"All Severities"}),l.jsx("option",{value:"fatal",children:"Fatal"}),l.jsx("option",{value:"severe",children:"Severe"}),l.jsx("option",{value:"moderate",children:"Moderate"}),l.jsx("option",{value:"minor",children:"Minor"})]})}),l.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[l.jsxs(Nr,{variant:"outline",size:"sm",onClick:Ne,disabled:K,className:"flex items-center gap-1",children:[l.jsx($B,{className:"h-4 w-4"}),K?"Loading...":"Style"]}),l.jsxs(Nr,{variant:"outline",size:"sm",onClick:Pe,className:"flex items-center gap-1",children:[l.jsx(ude,{className:"h-4 w-4"}),"Reset"]})]})]}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{ref:r,className:"w-full h-96 rounded-lg",style:{minHeight:"400px"}}),l.jsxs("div",{className:`absolute top-4 left-4 rounded-lg shadow-lg p-3 text-xs ${x?"bg-gray-800 border border-gray-700 text-gray-100":"bg-white border border-gray-200 text-gray-900"}`,children:[l.jsx("div",{className:"font-semibold mb-2",children:"Accident Severity"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-red-600 border-2 border-white"}),l.jsx("span",{children:"Fatal"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-600 border-2 border-white"}),l.jsx("span",{children:"Severe"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-500 border-2 border-white"}),l.jsx("span",{children:"Moderate"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-green-600 border-2 border-white"}),l.jsx("span",{children:"Minor"})]})]}),A&&l.jsxs("div",{className:"mt-3 pt-2 border-t border-gray-300",children:[l.jsx("div",{className:"font-semibold mb-1",children:"Clusters"}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-400"}),l.jsx("span",{children:"Small"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-400"}),l.jsx("span",{children:"Medium"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-5 h-5 rounded-full bg-pink-400"}),l.jsx("span",{children:"Large"})]})]})]})]})]})]})})]})},CUe=({analyticsData:e,riskData:t,timePeriod:r,selectedSeverity:n,selectedVehicleType:a,className:c=""})=>{const f=()=>{if(!e)return;const A=[];A.push(["Metric","Value","Change"]),A.push(["Total Accidents",e.summary.totalAccidents,e.summary.accidentChange]),A.push(["Fatal Accidents",e.summary.fatalities,e.summary.fatalitiesChange]),A.push(["High Risk Areas",e.distributions.municipality.length,""]),t&&A.push(["High Risk Predictions",t.riskPredictions.highRisk,t.riskPredictions.highRiskPercentage]),A.push(["","",""]),A.push(["Month","Accidents"]),e.trends.monthly.forEach(L=>{const $=new Date(L._id.year,L._id.month-1);A.push([$.toLocaleDateString("en-US",{month:"long",year:"numeric"}),L.count])}),A.push(["",""]),A.push(["Severity","Count"]),e.distributions.severity.forEach(L=>{A.push([L._id,L.count])}),A.push(["",""]),A.push(["Vehicle Type","Count"]),e.distributions.vehicleType.forEach(L=>{A.push([L._id,L.count])}),A.push(["",""]),A.push(["Municipality","Count"]),e.distributions.municipality.forEach(L=>{A.push([L._id,L.count])});const P=A.map(L=>L.map($=>`"${$}"`).join(",")).join(`
`),E=new Blob([P],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),V=URL.createObjectURL(E);D.setAttribute("href",V),D.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)},i=()=>{if(!e)return;const A={exportInfo:{timestamp:new Date().toISOString(),timePeriod:r,filters:{severity:n,vehicleType:a}},summary:e.summary,trends:e.trends,distributions:e.distributions,riskData:t,mapData:e.mapData},P=JSON.stringify(A,null,2),E=new Blob([P],{type:"application/json;charset=utf-8;"}),D=document.createElement("a"),V=URL.createObjectURL(E);D.setAttribute("href",V),D.setAttribute("download",`accident_analytics_${r}_${new Date().toISOString().split("T")[0]}.json`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)},x=A=>{alert(`Exporting ${A} chart as image... (Feature requires additional setup)`)},w=()=>{if(!e)return;const A=`
ACCIDENT ANALYTICS REPORT
Generated: ${new Date().toLocaleDateString()}
Time Period: ${r}
Filters: Severity=${n}, Vehicle Type=${a}

SUMMARY
========
Total Accidents: ${e.summary.totalAccidents}
Fatal Accidents: ${e.summary.fatalities}
High Risk Areas: ${e.distributions.municipality.length}
Accident Change: ${e.summary.accidentChange}%

${t?`
RISK ANALYSIS
=============
High Risk Predictions: ${t.riskPredictions.highRisk} (${t.riskPredictions.highRiskPercentage}%)
Medium Risk: ${t.riskPredictions.mediumRisk}
Low Risk: ${t.riskPredictions.lowRisk}
`:""}

MONTHLY TRENDS
==============
${e.trends.monthly.map(V=>`${new Date(V._id.year,V._id.month-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}: ${V.count} accidents`).join(`
`)}

SEVERITY DISTRIBUTION
====================
${e.distributions.severity.map(V=>`${V._id}: ${V.count} accidents`).join(`
`)}

VEHICLE TYPE DISTRIBUTION
=========================
${e.distributions.vehicleType.map(V=>`${V._id}: ${V.count} accidents`).join(`
`)}

TOP MUNICIPALITIES
==================
${e.distributions.municipality.slice(0,10).map(V=>`${V._id}: ${V.count} accidents`).join(`
`)}
    `.trim(),P=new Blob([A],{type:"text/plain;charset=utf-8;"}),E=document.createElement("a"),D=URL.createObjectURL(P);E.setAttribute("href",D),E.setAttribute("download",`accident_report_${r}_${new Date().toISOString().split("T")[0]}.txt`),E.style.visibility="hidden",document.body.appendChild(E),E.click(),document.body.removeChild(E)};return l.jsx("div",{className:`flex items-center gap-2 ${c}`,children:l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[l.jsx(uH,{className:"h-4 w-4"}),"Export"]})}),l.jsxs(zd,{align:"end",className:"w-48",children:[l.jsxs(Ka,{onClick:f,className:"flex items-center gap-2",children:[l.jsx(Ade,{className:"h-4 w-4"}),"Export as CSV"]}),l.jsxs(Ka,{onClick:i,className:"flex items-center gap-2",children:[l.jsx(Ld,{className:"h-4 w-4"}),"Export as JSON"]}),l.jsxs(Ka,{onClick:w,className:"flex items-center gap-2",children:[l.jsx(Ld,{className:"h-4 w-4"}),"Export Report"]}),l.jsx(_m,{}),l.jsxs(Ka,{onClick:()=>x("trends"),className:"flex items-center gap-2",children:[l.jsx(yP,{className:"h-4 w-4"}),"Export Trends Chart"]}),l.jsxs(Ka,{onClick:()=>x("severity"),className:"flex items-center gap-2",children:[l.jsx(UB,{className:"h-4 w-4"}),"Export Severity Chart"]}),l.jsxs(Ka,{onClick:()=>x("heatmap"),className:"flex items-center gap-2",children:[l.jsx(UB,{className:"h-4 w-4"}),"Export Heatmap"]})]})]})})},kW={light:["#DC2626","#EA580C","#059669","#2563EB"],dark:["#EF4444","#F97316","#10B981","#3B82F6"]},oA=({value:e,duration:t=2e3,className:r=""})=>{const[n,a]=W.useState(0),[c,f]=W.useState(!1),i=W.useRef(null);return W.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&f(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),W.useEffect(()=>{if(c){let x;const w=A=>{x||(x=A);const P=Math.min((A-x)/t,1),E=1-Math.pow(1-P,4),D=Math.floor(e*E);a(D),P<1?requestAnimationFrame(w):a(e)};requestAnimationFrame(w)}},[e,t,c]),l.jsx("div",{ref:i,className:`${r} transition-all duration-500 ${c?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"}`,children:n.toLocaleString()})},lA=({percentage:e,color:t="bg-blue-500",delay:r=0})=>{const[n,a]=W.useState(0),[c,f]=W.useState(!1),i=W.useRef(null);return W.useEffect(()=>{const x=new IntersectionObserver(([w])=>{w.isIntersecting&&f(!0)},{threshold:.1});return i.current&&x.observe(i.current),()=>x.disconnect()},[]),W.useEffect(()=>{if(c){const x=setTimeout(()=>{a(e)},r);return()=>clearTimeout(x)}},[c,e,r]),l.jsx("div",{ref:i,className:"mt-2 w-full bg-gray-200 rounded-full h-1.5 overflow-hidden",children:l.jsx("div",{className:`${t} h-1.5 rounded-full transition-all duration-1000 ease-out`,style:{width:`${n}%`}})})};function kUe(){const[e,t]=W.useState("alltime"),[r,n]=W.useState(null),[a,c]=W.useState(null),[f,i]=W.useState(!0),[x,w]=W.useState(null),[A,P]=W.useState("area"),[E,D]=W.useState(!1),{token:V}=Di(),[L,$]=W.useState(!1);W.useEffect(()=>{const xe=()=>{const Te=document.documentElement.classList.contains("dark")||window.matchMedia("(prefers-color-scheme: dark)").matches;$(Te)};xe();const Ce=new MutationObserver(xe);Ce.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]});const ze=window.matchMedia("(prefers-color-scheme: dark)");return ze.addEventListener("change",xe),()=>{Ce.disconnect(),ze.removeEventListener("change",xe)}},[]);const H=()=>L?kW.dark:kW.light;W.useEffect(()=>{K()},[e]);const K=async()=>{var xe;try{i(!0),w(null);const Ce=Date.now();console.log(`Fetching analytics data for period: ${e} at ${new Date(Ce).toISOString()}`);const[ze,Te]=await Promise.all([xn.get(`/accident/analytics/summary?period=${e}&_t=${Ce}`,{headers:{Authorization:V}}),xn.get(`/accident/analytics/risk?period=${e}&_t=${Ce}`,{headers:{Authorization:V}})]);ze.data.success&&(console.log("Frontend received analytics data:",ze.data.data),console.log("Municipality data:",(xe=ze.data.data.distributions)==null?void 0:xe.municipality),n(ze.data.data)),Te.data.success&&c(Te.data.data)}catch(Ce){console.error("Error fetching accident analytics:",Ce),w("Failed to load accident analytics data")}finally{i(!1)}},Q=xe=>{switch(xe){case"week":return"Last Week";case"month":return"Last Month";case"3months":return"Last 3 Months";case"6months":return"Last 6 Months";case"year":return"Last Year";case"alltime":return"All Time";default:return"Last 6 Months"}},ae=xe=>xe.map(Ce=>({month:`${Ce._id.year}-${String(Ce._id.month).padStart(2,"0")}`,accidents:Ce.count})),ee=xe=>xe.map(Ce=>({name:Ce._id.charAt(0).toUpperCase()+Ce._id.slice(1),value:Ce.count,severity:Ce._id})),se=({active:xe,payload:Ce,label:ze})=>{if(xe&&Ce&&Ce.length){const Te=Ce[0];Pe(r.distributions.municipality).find(He=>He.name===Te.name);const Fe=H()[2];return l.jsxs("div",{className:"p-3 rounded-lg shadow-lg border transition-all duration-200 ease-in-out",style:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",color:L?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},children:[l.jsxs("p",{className:"font-semibold text-sm mb-1",children:["Municipality: ",ze]}),l.jsxs("p",{className:"text-sm",style:{color:Fe,fontWeight:"600"},children:["Accidents: ",Te.value," accidents"]})]})}return null},ce=({active:xe,payload:Ce,label:ze})=>{if(xe&&Ce&&Ce.length){const Te=Ce[0],Re=H();ee(r.distributions.severity);const He={Fatal:Re[0],Severe:Re[1],Minor:Re[2],Moderate:Re[3]}[Te.name]||Re[0],mt=L?"#1f2937":"#ffffff",Xe=He,ot=He,qe=L?"rgba(0, 0, 0, 0.4)":"rgba(0, 0, 0, 0.15)",Lt=L?`${He}60`:`${He}30`;return l.jsx("div",{className:"p-3 rounded-lg shadow-lg border transition-all duration-200 ease-in-out",style:{backgroundColor:mt,border:`2px solid ${Xe}`,boxShadow:`${qe} 0 8px 25px, 0 0 0 1px ${Lt}`,fontWeight:"600",backdropFilter:L?"blur(8px)":"none"},children:l.jsx("p",{style:{color:ot,margin:0,fontSize:"14px",fontWeight:"700",textShadow:L?`0 0 12px ${He}80, 0 0 4px ${He}40`:`0 0 8px ${He}60, 0 0 2px ${He}30`,filter:L?"brightness(1.1)":"brightness(1)"},children:`${Te.name} : ${Te.value}`})})}return null},he=xe=>xe.map(Ce=>({name:Ce._id.charAt(0).toUpperCase()+Ce._id.slice(1),value:Ce.count,type:Ce._id})),Pe=xe=>{console.log("formatMunicipalityData input:",xe);const Ce=xe.map(ze=>({name:ze._id,accidents:ze.count,percentage:xe.length>0?(ze.count/xe.reduce((Te,Re)=>Te+Re.count,0)*100).toFixed(1):0})).sort((ze,Te)=>Te.accidents-ze.accidents);return console.log("formatMunicipalityData output:",Ce),Ce},Ne=xe=>{const Ce=Array.from({length:24},(ze,Te)=>({hour:Te,accidents:0}));return xe==null||xe.forEach(ze=>{if(ze.accident_date){const Te=new Date(ze.accident_date).getHours();Ce[Te].accidents++}}),Ce.map(ze=>({...ze,timeLabel:`${ze.hour}:00`,period:ze.hour<6?"Night":ze.hour<12?"Morning":ze.hour<18?"Afternoon":"Evening"}))},pe=xe=>{const Ce=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ze=Array.from({length:7},(Te,Re)=>({day:Re,dayName:Ce[Re],accidents:0}));return xe==null||xe.forEach(Te=>{if(Te.accident_date){const Re=new Date(Te.accident_date).getDay();ze[Re].accidents++}}),ze},je=(xe,Ce)=>!xe||!Ce?[]:[{category:"High Risk",accidents:Ce.riskPredictions.highRisk,percentage:Ce.riskPredictions.highRiskPercentage},{category:"Medium Risk",accidents:Ce.riskPredictions.mediumRisk,percentage:100-Ce.riskPredictions.highRiskPercentage-Ce.riskPredictions.lowRiskPercentage},{category:"Low Risk",accidents:Ce.riskPredictions.lowRisk,percentage:Ce.riskPredictions.lowRiskPercentage}];return f?l.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6 rounded-lg",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[l.jsx(Hc,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),l.jsx("p",{className:"text-muted-foreground",children:"Comprehensive Analysis of Accident Data"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"animate-pulse",children:l.jsx("div",{className:"h-8 bg-muted rounded w-32"})}),l.jsx("div",{className:"animate-pulse",children:l.jsx("div",{className:"h-8 bg-muted rounded w-40"})})]})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-24"})]})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(xe=>l.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-4 bg-muted rounded w-24 mb-2"}),l.jsx("div",{className:"h-8 bg-muted rounded w-16 mb-2"}),l.jsx("div",{className:"h-3 bg-muted rounded w-20"})]})},xe))}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map(xe=>l.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-48 mb-4"}),l.jsx("div",{className:"h-64 bg-muted rounded"})]})},xe))}),l.jsx("div",{className:"bg-card border border-border rounded-lg p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-6 bg-muted rounded w-40 mb-4"}),l.jsx("div",{className:"h-96 bg-muted rounded"})]})})]}):x?l.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"text-red-500",children:x})})}):l.jsxs("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-3xl font-bold tracking-tight flex items-center gap-2 animate-in slide-in-from-top-5 fade-in duration-700",children:[l.jsx(Hc,{className:"h-8 w-8 text-red-500 animate-pulse"}),"Accident Analytics"]}),l.jsx("p",{className:"text-muted-foreground",children:"Comprehensive analysis of accident data"})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx(CUe,{analyticsData:r,riskData:a,timePeriod:e})})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(dH,{className:"h-4 w-4 text-muted-foreground"}),l.jsx("span",{className:"text-sm font-medium",children:"Filters:"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Advanced:"}),l.jsxs("button",{onClick:()=>D(!E),className:`px-3 py-2 text-sm font-medium rounded-md transition-colors flex items-center gap-2 ${E?"text-white bg-primary hover:bg-primary/90 dark:text-white dark:bg-primary dark:hover:bg-primary/90":"text-foreground bg-background border border-border hover:bg-muted dark:text-foreground dark:bg-background dark:border-border dark:hover:bg-muted"}`,children:[l.jsx(yP,{className:"h-4 w-4"}),E?"Hide Advanced":"Show Advanced"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Date:"}),l.jsxs(Uo,{value:e,onValueChange:t,children:[l.jsx(So,{className:"w-[140px]",children:l.jsx($o,{placeholder:"Select time period"})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"week",children:"Last Week"}),l.jsx(pn,{value:"month",children:"Last Month"}),l.jsx(pn,{value:"3months",children:"Last 3 Months"}),l.jsx(pn,{value:"6months",children:"Last 6 Months"}),l.jsx(pn,{value:"year",children:"Last Year"}),l.jsx(pn,{value:"alltime",children:"All Time"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-muted-foreground",children:"Chart Type:"}),l.jsxs(Uo,{value:A,onValueChange:P,children:[l.jsx(So,{className:"w-[120px]",children:l.jsx($o,{})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"area",children:"Area Chart"}),l.jsx(pn,{value:"line",children:"Line Chart"}),l.jsx(pn,{value:"bar",children:"Bar Chart"}),l.jsx(pn,{value:"composed",children:"Composed"})]})]})]})]})]}),r&&l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[l.jsxs(Ci,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-blue-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),l.jsxs(zi,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[l.jsx(Fi,{className:"text-sm font-medium",children:"Total Accidents"}),l.jsx(cl,{className:"h-4 w-4 text-blue-500"})]}),l.jsxs(Ii,{className:"relative z-10",children:[l.jsx(oA,{value:r.summary.totalAccidents,className:"text-2xl font-bold",duration:1500}),l.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.accidentChange>=0?l.jsx(qg,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):l.jsx(WB,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),Math.abs(r.summary.accidentChange),"% from previous period"]}),l.jsx(lA,{percentage:Math.min(r.summary.totalAccidents/100*100,100),color:"bg-blue-500",delay:200})]})]}),l.jsxs(Ci,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-red-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),l.jsxs(zi,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[l.jsx(Fi,{className:"text-sm font-medium",children:"Fatal Accidents"}),l.jsx(Hc,{className:"h-4 w-4 text-red-500"})]}),l.jsxs(Ii,{className:"relative z-10",children:[l.jsx(oA,{value:r.summary.fatalities,className:"text-2xl font-bold text-red-600",duration:1800}),l.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[r.summary.fatalitiesChange>=0?l.jsx(qg,{className:"h-3 w-3 text-red-500 mr-1 animate-pulse"}):l.jsx(WB,{className:"h-3 w-3 text-green-500 mr-1 animate-pulse"}),r.summary.fatalitiesChange," from previous period"]}),l.jsx(lA,{percentage:Math.min(r.summary.fatalities/10*100,100),color:"bg-red-500",delay:400})]})]}),l.jsxs(Ci,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-orange-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),l.jsxs(zi,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[l.jsx(Fi,{className:"text-sm font-medium",children:"High Risk Areas"}),l.jsx(Ed,{className:"h-4 w-4 text-orange-500"})]}),l.jsxs(Ii,{className:"relative z-10",children:[l.jsx(oA,{value:r.distributions.municipality.length,className:"text-2xl font-bold",duration:1600}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Municipalities with accidents"}),l.jsx(lA,{percentage:Math.min(r.distributions.municipality.length/20*100,100),color:"bg-orange-500",delay:600})]})]}),l.jsxs(Ci,{className:"relative overflow-hidden group hover:shadow-lg transition-all duration-300",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500/10 rounded-full -translate-y-10 translate-x-10 group-hover:scale-110 transition-transform duration-300"}),l.jsxs(zi,{className:"flex flex-row items-center justify-between space-y-0 pb-2 relative z-10",children:[l.jsx(Fi,{className:"text-sm font-medium",children:"Risk Predictions"}),l.jsx(zB,{className:"h-4 w-4 text-purple-500"})]}),l.jsxs(Ii,{className:"relative z-10",children:[l.jsx(oA,{value:a?a.riskPredictions.highRiskPercentage:0,className:"text-2xl font-bold",duration:2e3}),l.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High risk predictions"}),l.jsx(lA,{percentage:a?a.riskPredictions.highRiskPercentage:0,color:"bg-purple-500",delay:800})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r&&r.trends.monthly.length>0&&l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[l.jsx(zi,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-5 w-5 text-blue-500 animate-pulse"}),"Accident Trends Over Time"]}),l.jsxs(As,{children:["Monthly accident frequency for ",Q(e)]})]}),l.jsx("div",{className:"flex items-center gap-2",children:l.jsx(us,{variant:"outline",className:"text-xs",children:A.toUpperCase()})})]})}),l.jsx(Ii,{children:l.jsxs(_o,{width:"100%",height:300,children:[A==="area"&&l.jsxs(v4e,{data:ae(r.trends.monthly),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"month",tickFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:L?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{labelFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827"}}),l.jsx(ku,{type:"monotone",dataKey:"accidents",stroke:H()[0],fill:H()[0],fillOpacity:.3,strokeWidth:3,animationDuration:1500,animationEasing:"ease-out"})]}),A==="line"&&l.jsxs(A4,{data:ae(r.trends.monthly),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"month",tickFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:L?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{labelFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827"}}),l.jsx(op,{type:"monotone",dataKey:"accidents",stroke:H()[0],strokeWidth:3,dot:{fill:H()[0],strokeWidth:2,r:4},activeDot:{r:6,stroke:H()[0],strokeWidth:2},animationDuration:1500,animationEasing:"ease-out"})]}),A==="bar"&&l.jsxs(Cu,{data:ae(r.trends.monthly),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"month",tickFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:L?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{labelFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827"}}),l.jsx(ds,{dataKey:"accidents",fill:H()[0],radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"})]}),A==="composed"&&l.jsxs(T4,{data:ae(r.trends.monthly),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"month",tickFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"short",year:"2-digit"}),stroke:L?"#9ca3af":"#6b7280"}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{labelFormatter:xe=>new Date(xe).toLocaleDateString("en-US",{month:"long",year:"numeric"}),contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827"}}),l.jsx(ds,{dataKey:"accidents",fill:H()[0],fillOpacity:.6,radius:[4,4,0,0],animationDuration:1500,animationEasing:"ease-out"}),l.jsx(op,{type:"monotone",dataKey:"accidents",stroke:H()[1],strokeWidth:2,dot:!1,animationDuration:1500,animationEasing:"ease-out"})]})]})})]}),r&&r.distributions.severity.length>0&&l.jsxs(Ci,{className:"animate-in slide-in-from-right-5 fade-in duration-700",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(P1,{className:"h-5 w-5 text-orange-500 animate-pulse"}),"Accident Severity Distribution"]}),l.jsx(As,{children:"Breakdown of accidents by severity level"})]}),l.jsx(Ii,{children:l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Dte,{children:[l.jsx(pp,{data:ee(r.distributions.severity),cx:"50%",cy:"50%",labelLine:!1,label:({name:xe,percent:Ce})=>`${xe} ${(Ce*100).toFixed(0)}%`,outerRadius:80,innerRadius:40,fill:"currentColor",dataKey:"value",animationDuration:1500,animationEasing:"ease-out",children:ee(r.distributions.severity).map((xe,Ce)=>{const ze=H(),Te={Fatal:ze[0],Severe:ze[1],Minor:ze[2],Moderate:ze[3]};return l.jsx(Kh,{fill:Te[xe.name]||ze[0]},`cell-${Ce}`)})}),l.jsx(ta,{content:l.jsx(ce,{})})]})})})]}),r&&r.distributions.vehicleType.length>0&&l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(cl,{className:"h-5 w-5 text-green-500"}),"Vehicle Type Distribution"]}),l.jsx(As,{children:"Accidents by vehicle type with enhanced visualization"})]}),l.jsxs(Ii,{children:[l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Cu,{data:he(r.distributions.vehicleType),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"name",stroke:L?"#9ca3af":"#6b7280",fontSize:12,angle:-45,textAnchor:"end",height:80}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(xe,Ce)=>[`${xe} accidents`,"Count"],labelFormatter:xe=>`Vehicle Type: ${xe}`}),l.jsx(ds,{dataKey:"value",fill:H()[1],radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),l.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const xe=he(r.distributions.vehicleType),Ce=xe.reduce((Te,Re)=>Te+Re.value,0),ze=xe.reduce((Te,Re)=>Re.value>Te.value?Re:Te);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Most Common"}),l.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:ze.name}),l.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[ze.value," accidents (",(ze.value/Ce*100).toFixed(1),"%)"]})]}),l.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Vehicles"}),l.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:xe.length}),l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Vehicle types involved"})]})]})})()})]})]}),r&&r.distributions.municipality.length>0&&l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(Ed,{className:"h-5 w-5 text-orange-500"}),"Top Municipalities by Accidents"]}),l.jsx(As,{children:"Municipalities with highest accident counts and risk analysis"})]}),l.jsxs(Ii,{children:[l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Cu,{data:Pe(r.distributions.municipality),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"name",stroke:L?"#9ca3af":"#6b7280",fontSize:11,angle:-45,textAnchor:"end",height:80}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{content:l.jsx(se,{})}),l.jsx(ds,{dataKey:"accidents",radius:[4,4,0,0],className:"hover:opacity-80 transition-opacity duration-200",children:Pe(r.distributions.municipality).map((xe,Ce)=>l.jsx(Kh,{fill:H()[2]},`cell-${Ce}`))})]})}),l.jsx("div",{className:"mt-4 grid grid-cols-3 gap-4",children:(()=>{const xe=Pe(r.distributions.municipality),Ce=xe.reduce((Re,Fe)=>Re+Fe.accidents,0),ze=xe.reduce((Re,Fe)=>Fe.accidents>Re.accidents?Fe:Re),Te=Ce/xe.length;return xe.find(Re=>Re.name==="Mati"),l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 dark:bg-orange-950/20",children:[l.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Highest Risk"}),l.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:ze.name}),l.jsxs("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:[ze.accidents," accidents (",ze.percentage,"%)"]})]}),l.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Areas"}),l.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:xe.length}),l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Municipalities affected"})]}),l.jsxs("div",{className:"p-3 rounded-lg bg-purple-50 dark:bg-purple-950/20",children:[l.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Average"}),l.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:Te.toFixed(1)}),l.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Accidents per area"})]})]})})()})]})]})]}),a&&l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsx(Fi,{children:"Risk Level Distribution"}),l.jsx(As,{children:"ML-based risk predictions for accidents"})]}),l.jsx(Ii,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),l.jsx("span",{children:"High Risk"})]}),l.jsxs(us,{variant:"destructive",children:[a.riskPredictions.highRisk," (",a.riskPredictions.highRiskPercentage,"%)"]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),l.jsx("span",{children:"Medium Risk"})]}),l.jsx(us,{variant:"secondary",children:a.riskPredictions.mediumRisk})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),l.jsx("span",{children:"Low Risk"})]}),l.jsx(us,{variant:"outline",children:a.riskPredictions.lowRisk})]})]})})]}),l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsx(Fi,{children:"Rule-Based Detection"}),l.jsx(As,{children:"Traditional rule-based risk assessment"})]}),l.jsx(Ii,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Hc,{className:"h-4 w-4 text-red-500"}),l.jsx("span",{children:"Flagged (High Risk)"})]}),l.jsxs(us,{variant:"destructive",children:[a.ruleBasedDetection.flagged," (",a.ruleBasedDetection.flaggedPercentage,"%)"]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(zB,{className:"h-4 w-4 text-green-500"}),l.jsx("span",{children:"Safe (Low Risk)"})]}),l.jsxs(us,{variant:"outline",children:[a.ruleBasedDetection.safe," (",a.ruleBasedDetection.safePercentage,"%)"]})]})]})})]})]}),E&&r&&l.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-5 fade-in duration-700",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Fde,{className:"h-5 w-5 text-yellow-500 animate-pulse"}),l.jsx("h3",{className:"text-xl font-semibold",children:"Advanced Analytics"}),l.jsx(us,{variant:"secondary",className:"ml-2 animate-pulse",children:"Enhanced Visualizations"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-left-5 fade-in duration-700",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(eD,{className:"h-5 w-5 text-green-500 animate-pulse"}),"Hourly Accident Distribution"]}),l.jsx(As,{children:"Accidents by hour of day showing peak times and patterns"})]}),l.jsxs(Ii,{children:[l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Cu,{data:Ne(r.mapData),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"timeLabel",stroke:L?"#9ca3af":"#6b7280",fontSize:11,interval:1}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(xe,Ce)=>[`${xe} accidents`,"Count"],labelFormatter:xe=>`Time: ${xe}`}),l.jsx(ds,{dataKey:"accidents",fill:H()[2],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),l.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const xe=Ne(r.mapData),Ce=xe.reduce((Te,Re)=>Re.accidents>Te.accidents?Re:Te),ze=xe.reduce((Te,Re)=>Te+Re.accidents,0);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"Peak Hour"}),l.jsx("div",{className:"text-lg font-bold text-green-900 dark:text-green-100",children:Ce.timeLabel}),l.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[Ce.accidents," accidents"]})]}),l.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Total Accidents"}),l.jsx("div",{className:"text-lg font-bold text-blue-900 dark:text-blue-100",children:ze}),l.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Across all hours"})]})]})})()})]})]}),l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300 animate-in slide-in-from-right-5 fade-in duration-700",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(so,{className:"h-5 w-5 text-purple-500 animate-pulse"}),"Day of Week Analysis"]}),l.jsx(As,{children:"Accident patterns by day of the week with risk assessment"})]}),l.jsxs(Ii,{children:[l.jsx(_o,{width:"100%",height:300,children:l.jsxs(Cu,{data:pe(r.mapData),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"dayName",stroke:L?"#9ca3af":"#6b7280",fontSize:12}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15)"},formatter:(xe,Ce)=>[`${xe} accidents`,"Count"],labelFormatter:xe=>`Day: ${xe}`}),l.jsx(ds,{dataKey:"accidents",fill:H()[3],radius:[2,2,0,0],className:"hover:opacity-80 transition-opacity duration-200"})]})}),l.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:(()=>{const xe=pe(r.mapData),Ce=xe.reduce((Re,Fe)=>Fe.accidents>Re.accidents?Fe:Re),Te=xe.filter(Re=>Re.day===0||Re.day===6).reduce((Re,Fe)=>Re+Fe.accidents,0);return l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-purple-700 dark:text-purple-300",children:"Peak Day"}),l.jsx("div",{className:"text-lg font-bold text-purple-900 dark:text-purple-100",children:Ce.dayName}),l.jsxs("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:[Ce.accidents," accidents"]})]}),l.jsxs("div",{className:"p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[l.jsx("div",{className:"text-sm font-medium text-orange-700 dark:text-orange-300",children:"Weekend Total"}),l.jsx("div",{className:"text-lg font-bold text-orange-900 dark:text-orange-100",children:Te}),l.jsx("div",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Sat + Sun accidents"})]})]})})()})]})]}),a&&l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(fH,{className:"h-5 w-5 text-red-500"}),"Risk Level Correlation"]}),l.jsx(As,{children:"Relationship between risk levels and accident counts"})]}),l.jsx(Ii,{children:l.jsx(_o,{width:"100%",height:300,children:l.jsxs(y4e,{data:je(r,a),children:[l.jsx(Ws,{strokeDasharray:"3 3",stroke:L?"#374151":"#e5e7eb"}),l.jsx(Oa,{dataKey:"category",stroke:L?"#9ca3af":"#6b7280",fontSize:12}),l.jsx(Ra,{stroke:L?"#9ca3af":"#6b7280"}),l.jsx(ta,{contentStyle:{backgroundColor:L?"#1f2937":"#ffffff",border:L?"1px solid #374151":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827"}}),l.jsx(L_,{dataKey:"accidents",fill:H()[4],r:8})]})})})]}),r&&r.distributions.severity.length>0&&l.jsxs(Ci,{className:"group hover:shadow-lg transition-all duration-300",children:[l.jsxs(zi,{children:[l.jsxs(Fi,{className:"flex items-center gap-2",children:[l.jsx(P1,{className:"h-5 w-5 text-orange-500"}),"Severity Distribution (Radial)"]}),l.jsx(As,{children:"Circular view of accident severity breakdown"})]}),l.jsx(Ii,{children:l.jsx(_o,{width:"100%",height:300,children:l.jsxs(x4e,{cx:"50%",cy:"50%",innerRadius:"20%",outerRadius:"80%",data:ee(r.distributions.severity),children:[l.jsx(y2,{dataKey:"value",cornerRadius:4,fill:H()[0]}),l.jsx(ta,{contentStyle:{backgroundColor:L?"#374151":"#ffffff",border:L?"1px solid #4b5563":"1px solid #e5e7eb",borderRadius:"8px",color:L?"#f9fafb":"#111827",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"}})]})})})]})]}),l.jsx(NUe,{analyticsData:r,className:"w-full"})]}),r&&r.mapData&&r.mapData.length>0&&l.jsx(jUe,{accidents:r.mapData,className:"w-full"})]})}function EUe(){return l.jsx("div",{children:l.jsx(kUe,{})})}const MUe=Dr.object({firstName:Dr.string().min(1,"First name is required").trim(),middleName:Dr.string().optional(),lastName:Dr.string().min(1,"Last name is required").trim(),email:Dr.string().email("Invalid email address"),password:Dr.string().min(6,"Password must be at least 6 characters"),confirmPassword:Dr.string(),role:Dr.enum(["0","1","2"]).optional()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),OUe=[{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function RUe(){const{userData:e}=Di(),[t,r]=W.useState(!1),n=Jl(Date.now()),a=Cl({resolver:tc(MUe),defaultValues:{firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0}}),c=async f=>{var i,x;try{r(!0);const{confirmPassword:w,...A}=f;(e==null?void 0:e.role)==="1"?A.role="2":(e==null?void 0:e.role)==="0"&&(A.role=f.role||"2"),(await xn.post("/auth/register",A)).data.success&&(Mn.success("Account has been registered successfully",{description:n}),a.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0}))}catch(w){const A=((x=(i=w.response)==null?void 0:i.data)==null?void 0:x.message)||"Failed to register account";Mn.error(A,{description:n})}finally{r(!1)}};return l.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:l.jsx("div",{className:"max-w-2xl mx-auto",children:l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(MA,{className:"h-6 w-6"}),l.jsx(Fi,{children:"Register New Account"})]}),l.jsx(As,{children:(e==null?void 0:e.role)==="0"?"Create a new admin or employee account for the LTO system":"Create a new employee account for the LTO system"})]}),l.jsx(Ii,{children:l.jsx(ip,{...a,children:l.jsxs("form",{onSubmit:a.handleSubmit(c),className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsx(En,{control:a.control,name:"firstName",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"First Name *"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter first name",...f})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:a.control,name:"middleName",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Middle Name"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter middle name (optional)",...f})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:a.control,name:"lastName",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Last Name *"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter last name",...f})}),l.jsx(Cn,{})]})})]}),l.jsx(En,{control:a.control,name:"email",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Email Address *"}),l.jsx(Nn,{children:l.jsx(kn,{type:"email",placeholder:"Enter email address",...f})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:a.control,name:"password",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Password *"}),l.jsx(Nn,{children:l.jsx(kn,{type:"password",placeholder:"Enter password",...f})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:a.control,name:"confirmPassword",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Confirm Password *"}),l.jsx(Nn,{children:l.jsx(kn,{type:"password",placeholder:"Confirm password",...f})}),l.jsx(Cn,{})]})}),(e==null?void 0:e.role)==="0"&&l.jsx(En,{control:a.control,name:"role",render:({field:f})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Role *"}),l.jsxs(Uo,{onValueChange:f.onChange,defaultValue:f.value,children:[l.jsx(Nn,{children:l.jsx(So,{children:l.jsx($o,{placeholder:"Select a role"})})}),l.jsx(Ao,{children:OUe.map(i=>l.jsx(pn,{value:i.value,children:i.label},i.value))})]}),l.jsx(Cn,{})]})}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx(Nr,{type:"submit",disabled:t,className:"w-auto px-8",children:t?l.jsxs(l.Fragment,{children:[l.jsx(_c,{className:"mr-2 h-4 w-4 animate-spin"}),"Registering..."]}):l.jsxs(l.Fragment,{children:[l.jsx(MA,{className:"mr-2 h-4 w-4"}),"Register Account"]})}),l.jsx(Nr,{type:"button",variant:"outline",onClick:()=>{a.reset({firstName:"",middleName:"",lastName:"",email:"",password:"",confirmPassword:"",role:(e==null?void 0:e.role)==="0"?"2":void 0})},disabled:t,className:"w-auto px-8",children:"Clear Form"})]})]})})})]})})})}const IUe=Dr.object({userId:Dr.string().min(1,"User ID is required"),firstName:Dr.string().min(1,"First name is required").trim(),middleName:Dr.string().optional(),lastName:Dr.string().min(1,"Last name is required").trim(),email:Dr.string().email("Invalid email address"),role:Dr.enum(["0","1","2"],{required_error:"Please select a role"}),isPasswordChange:Dr.boolean().optional()}),DUe=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}];function LUe(){const{userData:e}=Di(),[t,r]=W.useState([]),[n,a]=W.useState(!1),[c,f]=W.useState(!1),[i,x]=W.useState(null),[w,A]=W.useState(!1),[P,E]=W.useState(!1),[D,V]=W.useState(null),L=Cl({resolver:tc(IUe),defaultValues:{userId:"",firstName:"",middleName:"",lastName:"",email:"",role:"",isPasswordChange:!1}}),$=async()=>{var he,Pe;try{a(!0);const Ne=await xn.get("/user/all");if(Ne.data.success){let pe=Ne.data.users;(e==null?void 0:e.role)==="1"?pe=pe.filter(je=>je.role==="2"):(e==null?void 0:e.role)==="0"&&(pe=pe.filter(je=>je.role==="1"||je.role==="2")),r(pe)}}catch(Ne){const pe=((Pe=(he=Ne.response)==null?void 0:he.data)==null?void 0:Pe.message)||"Failed to fetch users";Mn.error(pe)}finally{a(!1)}};W.useEffect(()=>{$()},[e]);const H=he=>{x(he),A(!0),L.reset({userId:he._id,firstName:he.firstName,middleName:he.middleName||"",lastName:he.lastName,email:he.email,role:he.role,isPasswordChange:he.isPasswordChange||!1})},K=he=>{V(he),E(!0)},Q=async()=>{var he,Pe;try{f(!0),(await xn.delete(`/user/${D._id}`)).data.success&&(Mn.success("User deleted successfully!"),$())}catch(Ne){const pe=((Pe=(he=Ne.response)==null?void 0:he.data)==null?void 0:Pe.message)||"Failed to delete user";Mn.error(pe)}finally{f(!1),E(!1),V(null)}},ae=async he=>{var Pe,Ne;try{f(!0),(await xn.put(`/user/${he.userId}`,he)).data.success&&(Mn.success("Account updated successfully!"),$(),A(!1),x(null))}catch(pe){const je=((Ne=(Pe=pe.response)==null?void 0:Pe.data)==null?void 0:Ne.message)||"Failed to update account";Mn.error(je)}finally{f(!1)}},ee=()=>{x(null),A(!1),L.reset()},se=he=>{switch(he){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}},ce=he=>{switch(he){case"0":return"Superadmin";case"1":return"Admin";case"2":return"Employee";default:return"Unknown"}};return l.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[l.jsx(Ci,{children:l.jsxs(zi,{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-6 w-6"}),l.jsx(Fi,{children:"Manage User Accounts"})]}),l.jsx(As,{children:(e==null?void 0:e.role)==="0"?"View and manage admin and employee accounts":"View and manage employee accounts"})]})}),l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsx(Fi,{children:"User Accounts"})}),l.jsx(Ii,{children:n?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(_c,{className:"h-8 w-8 animate-spin"}),l.jsx("span",{className:"ml-2",children:"Loading users..."})]}):t.length===0?l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"}):l.jsx("div",{className:"rounded-md border",children:l.jsxs(km,{children:[l.jsx(Em,{children:l.jsxs(Ns,{children:[l.jsx(Ts,{children:"Full Name"}),l.jsx(Ts,{children:"Email"}),l.jsx(Ts,{children:"Role"}),l.jsx(Ts,{children:"Created At"}),l.jsx(Ts,{children:"Last Updated"}),l.jsx(Ts,{className:"w-[50px]",children:"Actions"})]})}),l.jsx(Mm,{children:t.map(he=>l.jsxs(Ns,{children:[l.jsxs(ha,{className:"font-medium",children:[he.firstName," ",he.middleName," ",he.lastName]}),l.jsx(ha,{children:he.email}),l.jsx(ha,{children:l.jsx(us,{variant:se(he.role),children:ce(he.role)})}),l.jsx(ha,{children:new Date(he.createdAt).toLocaleDateString()}),l.jsx(ha,{children:new Date(he.updatedAt).toLocaleDateString()}),l.jsx(ha,{children:l.jsxs(Wh,{children:[l.jsx(tp,{asChild:!0,children:l.jsxs(Nr,{variant:"ghost",className:"h-8 w-8 p-0",children:[l.jsx("span",{className:"sr-only",children:"Open menu"}),l.jsx(Vue,{className:"h-4 w-4"})]})}),l.jsxs(zd,{align:"end",children:[l.jsxs(Ka,{onClick:()=>H(he),children:[l.jsx(ao,{className:"mr-2 h-4 w-4"}),"Update"]}),(e==null?void 0:e.role)==="0"&&l.jsxs(Ka,{onClick:()=>K(he),className:"text-red-600",children:[l.jsx(Cde,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},he._id))})]})})})]}),w&&i&&l.jsxs(Ci,{children:[l.jsxs(zi,{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ao,{className:"h-6 w-6"}),l.jsx(Fi,{children:"Update Account Information"})]}),l.jsxs(As,{children:["Modify the account information for ",i.firstName," ",i.lastName]})]}),l.jsx(Ii,{children:l.jsx(ip,{...L,children:l.jsxs("form",{onSubmit:L.handleSubmit(ae),className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx(En,{control:L.control,name:"firstName",render:({field:he})=>l.jsxs(jn,{children:[l.jsx($n,{children:"First Name *"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter first name",...he})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:L.control,name:"lastName",render:({field:he})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Last Name *"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter last name",...he})}),l.jsx(Cn,{})]})})]}),l.jsx(En,{control:L.control,name:"middleName",render:({field:he})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Middle Name"}),l.jsx(Nn,{children:l.jsx(kn,{placeholder:"Enter middle name (optional)",...he})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:L.control,name:"email",render:({field:he})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Email Address *"}),l.jsx(Nn,{children:l.jsx(kn,{type:"email",placeholder:"Enter email address",...he})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:L.control,name:"role",render:({field:he})=>l.jsxs(jn,{children:[l.jsx($n,{children:"Role *"}),l.jsxs(Uo,{onValueChange:he.onChange,value:he.value,children:[l.jsx(Nn,{children:l.jsx(So,{children:l.jsx($o,{placeholder:"Select a role"})})}),l.jsx(Ao,{children:DUe.map(Pe=>l.jsx(pn,{value:Pe.value,children:Pe.label},Pe.value))})]}),l.jsx(Cn,{})]})}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx(Nr,{type:"submit",disabled:c,className:"w-auto px-8",children:c?l.jsxs(l.Fragment,{children:[l.jsx(_c,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):l.jsxs(l.Fragment,{children:[l.jsx(ao,{className:"mr-2 h-4 w-4"}),"Update Account"]})}),l.jsx(Nr,{type:"button",variant:"outline",onClick:ee,disabled:c,className:"w-auto px-8",children:"Cancel"})]})]})})})]}),l.jsx(lie,{open:P,onOpenChange:E,children:l.jsxs(e5,{children:[l.jsxs(t5,{children:[l.jsx(n5,{children:"Are you sure?"}),l.jsxs(i5,{children:["This action cannot be undone. This will permanently delete the account for"," ",l.jsxs("strong",{children:[D==null?void 0:D.firstName," ",D==null?void 0:D.lastName]}),"."]})]}),l.jsxs(r5,{children:[l.jsx(s5,{children:"Cancel"}),l.jsx(a5,{onClick:Q,disabled:c,className:"bg-red-600 hover:bg-red-700",children:c?l.jsxs(l.Fragment,{children:[l.jsx(_c,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})})}const YO=[{value:"0",label:"Superadmin"},{value:"1",label:"Admin"},{value:"2",label:"Employee"}],EW=[{value:"login",label:"Login"},{value:"logout",label:"Logout"},{value:"register",label:"Registration"},{value:"update",label:"Account Update"},{value:"delete",label:"Delete"},{value:"password_change",label:"Password Change"},{value:"otp_verified",label:"OTP Verification"},{value:"otp_sent",label:"OTP Sent"},{value:"otp_reset",label:"OTP Reset"},{value:"add_driver",label:"Add Driver"},{value:"add_vehicle",label:"Add Vehicle"},{value:"add_accident",label:"Add Accident"},{value:"add_violation",label:"Add Violation"},{value:"update_driver",label:"Update Driver"},{value:"update_vehicle",label:"Update Vehicle"},{value:"update_accident",label:"Update Accident"},{value:"update_violation",label:"Update Violation"},{value:"delete_driver",label:"Delete Driver"},{value:"delete_vehicle",label:"Delete Vehicle"},{value:"delete_accident",label:"Delete Accident"},{value:"delete_violation",label:"Delete Violation"}];function zUe(){const{userData:e}=Di(),[t,r]=W.useState([]),[n,a]=W.useState(!1),[c,f]=W.useState(""),[i,x]=W.useState(""),[w,A]=W.useState(""),[P,E]=W.useState(null),[D,V]=W.useState(null),[L,$]=W.useState(1),[H,K]=W.useState(1),[Q,ae]=W.useState(0),ee=async(pe=1)=>{var je,xe;try{a(!0);const Ce=new URLSearchParams({page:pe.toString(),limit:"10"});c&&Ce.append("email",c),w&&w!=="all"&&Ce.append("logType",w),P&&Ce.append("dateFrom",P.toISOString().split("T")[0]),D&&Ce.append("dateTo",D.toISOString().split("T")[0]),(e==null?void 0:e.role)==="1"?i&&i!=="all"?Ce.append("role",i):Ce.append("roles","1,2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?Ce.append("role",i):Ce.append("roles","0,1,2"));const ze=await xn.get(`/user/logs?${Ce}`);if(ze.data.success){let Te=ze.data.logs;(e==null?void 0:e.role)==="1"?i&&i!=="all"?Te=Te.filter(Re=>Re.role===i):Te=Te.filter(Re=>Re.role==="1"||Re.role==="2"):(e==null?void 0:e.role)==="0"&&(i&&i!=="all"?Te=Te.filter(Re=>Re.role===i):Te=Te.filter(Re=>Re.role==="0"||Re.role==="1"||Re.role==="2")),console.log("Raw logs from API:",ze.data.logs),console.log("Filtered logs:",Te),r(Te),K(ze.data.totalPages),ae(Te.length),$(pe)}}catch(Ce){const ze=((xe=(je=Ce.response)==null?void 0:je.data)==null?void 0:xe.message)||"Failed to fetch logs";Mn.error(ze)}finally{a(!1)}};W.useEffect(()=>{ee()},[e]);const se=()=>{$(1),ee(1)},ce=()=>{f(""),x(""),A(""),E(null),V(null),$(1),ee(1)},he=async()=>{try{const pe=new URLSearchParams;c&&pe.append("email",c),i&&pe.append("role",i),w&&pe.append("logType",w),P&&pe.append("dateFrom",P.toISOString().split("T")[0]),D&&pe.append("dateTo",D.toISOString().split("T")[0]);const je=await xn.get(`/user/logs/export?${pe}`,{responseType:"blob"}),xe=window.URL.createObjectURL(new Blob([je.data])),Ce=document.createElement("a");Ce.href=xe,Ce.setAttribute("download",`account-logs-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(Ce),Ce.click(),Ce.remove(),window.URL.revokeObjectURL(xe),Mn.success("Logs exported successfully!")}catch{Mn.error("Failed to export logs")}},Pe=pe=>{switch(pe){case"login":return"default";case"logout":return"secondary";case"register":return"outline";case"update":return"default";case"password_change":return"destructive";case"otp_verified":return"secondary";case"otp_sent":return"outline";case"otp_reset":return"destructive";case"add_driver":return"default";case"add_vehicle":return"default";case"add_accident":return"destructive";case"add_violation":return"destructive";case"update_driver":return"secondary";case"update_vehicle":return"secondary";case"update_accident":return"destructive";case"update_violation":return"destructive";case"delete_driver":return"destructive";case"delete_vehicle":return"destructive";case"delete_accident":return"destructive";case"delete_violation":return"destructive";default:return"outline"}},Ne=pe=>{switch(pe){case"0":return"destructive";case"1":return"default";case"2":return"secondary";default:return"outline"}};return l.jsx("div",{className:"container mx-auto p-6 bg-white dark:bg-black min-h-screen rounded-lg",children:l.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[l.jsx(Ci,{children:l.jsxs(zi,{children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ld,{className:"h-6 w-6"}),l.jsx(Fi,{children:"Account Logs"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(Nr,{onClick:he,variant:"outline",size:"sm",children:[l.jsx(uH,{className:"mr-2 h-4 w-4"}),"Export Excel"]}),l.jsxs(Nr,{onClick:se,size:"sm",children:[l.jsx(v_,{className:"mr-2 h-4 w-4"}),"Search"]})]})]}),l.jsx(As,{children:(e==null?void 0:e.role)==="0"?"View and monitor all account activities and system logs (Superadmin, Admin, and Employee)":"View and monitor admin and employee account activities and system logs"})]})}),l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(dH,{className:"h-5 w-5"}),l.jsx(Fi,{className:"text-lg",children:"Filters"})]})}),l.jsx(Ii,{children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[l.jsx(kn,{placeholder:"Search by email",value:c,onChange:pe=>f(pe.target.value),onKeyPress:pe=>pe.key==="Enter"&&se()}),l.jsxs(Uo,{value:i,onValueChange:x,children:[l.jsx(So,{children:l.jsx($o,{placeholder:"Filter by role"})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"all",children:"All Roles"}),YO.filter(pe=>(e==null?void 0:e.role)==="1"?pe.value==="1"||pe.value==="2":(e==null?void 0:e.role)==="0"?pe.value==="0"||pe.value==="1"||pe.value==="2":!1).map(pe=>l.jsx(pn,{value:pe.value,children:pe.label},pe.value))]})]}),l.jsxs(Uo,{value:w,onValueChange:A,children:[l.jsx(So,{children:l.jsx($o,{placeholder:"Filter by log type"})}),l.jsxs(Ao,{children:[l.jsx(pn,{value:"all",children:"All Types"}),EW.map(pe=>l.jsx(pn,{value:pe.value,children:pe.label},pe.value))]})]}),l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsxs(Nr,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[l.jsx(so,{className:"mr-2 h-4 w-4"}),P?wc(P,"MM/dd/yyyy"):"From date"]})}),l.jsx(sy,{className:"w-auto p-0",align:"start",children:l.jsx(Lw,{mode:"single",selected:P,onSelect:E,initialFocus:!0})})]}),l.jsxs(Y0,{children:[l.jsx(X0,{asChild:!0,children:l.jsxs(Nr,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[l.jsx(so,{className:"mr-2 h-4 w-4"}),D?wc(D,"MM/dd/yyyy"):"To date"]})}),l.jsx(sy,{className:"w-auto p-0",align:"start",children:l.jsx(Lw,{mode:"single",selected:D,onSelect:V,initialFocus:!0})})]}),l.jsx(Nr,{onClick:ce,variant:"outline",children:"Clear Filters"})]})})]}),l.jsxs(Ci,{children:[l.jsx(zi,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx(Fi,{children:"Account Activity Logs"}),l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Total: ",Q," logs"]})]})}),l.jsx(Ii,{children:n?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(_c,{className:"h-8 w-8 animate-spin"}),l.jsx("span",{className:"ml-2",children:"Loading logs..."})]}):t.length===0?l.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No logs found matching your criteria"}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"rounded-md border",children:l.jsxs(km,{children:[l.jsx(Em,{children:l.jsxs(Ns,{children:[l.jsx(Ts,{children:"Performed By"}),l.jsx(Ts,{children:"Timestamp"}),l.jsx(Ts,{children:"User"}),l.jsx(Ts,{children:"Email"}),l.jsx(Ts,{children:"Role"}),l.jsx(Ts,{children:"Activity"}),l.jsx(Ts,{children:"Details"}),l.jsx(Ts,{children:"IP Address"}),l.jsx(Ts,{children:"Status"})]})}),l.jsx(Mm,{children:t.map((pe,je)=>{var xe,Ce,ze;return l.jsxs(Ns,{children:[l.jsx(ha,{children:l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"font-medium text-sm",children:pe.actorName||"N/A"}),l.jsx("span",{className:"text-xs text-muted-foreground",children:pe.actorEmail||""}),pe.actorRole&&l.jsx(us,{variant:"outline",className:"w-fit mt-1",children:((xe=YO.find(Te=>Te.value===pe.actorRole))==null?void 0:xe.label)||"Unknown"})]})}),l.jsx(ha,{children:new Date(pe.timestamp).toLocaleString()}),l.jsx(ha,{children:pe.userName||"N/A"}),l.jsx(ha,{children:pe.email}),l.jsx(ha,{children:l.jsx(us,{variant:Ne(pe.role),children:((Ce=YO.find(Te=>Te.value===pe.role))==null?void 0:Ce.label)||"Unknown"})}),l.jsx(ha,{children:l.jsx(us,{variant:Pe(pe.logType),children:((ze=EW.find(Te=>Te.value===pe.logType))==null?void 0:ze.label)||pe.logType})}),l.jsx(ha,{children:l.jsx("span",{className:"text-sm text-muted-foreground",children:pe.details||"N/A"})}),l.jsx(ha,{children:l.jsx("span",{className:"font-mono text-sm",children:pe.ipAddress==="::1"||pe.ipAddress==="::ffff:127.0.0.1"?"127.0.0.1":pe.ipAddress||"N/A"})}),l.jsx(ha,{children:l.jsx(us,{variant:pe.status==="success"?"default":"destructive",children:pe.status})})]},je)})})]})}),H>1&&l.jsxs("div",{className:"flex items-center justify-between mt-4",children:[l.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",L," of ",H]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(Nr,{variant:"outline",size:"sm",onClick:()=>ee(L-1),disabled:L===1||n,children:"Previous"}),l.jsx(Nr,{variant:"outline",size:"sm",onClick:()=>ee(L+1),disabled:L===H||n,children:"Next"})]})]})]})})]})]})})}const FUe=Dr.object({email:Dr.string().email("Please enter a valid email address")}),BUe=Dr.object({otp:Dr.string().min(6,"OTP must be 6 digits").max(6,"OTP must be 6 digits")});function VUe(){const[e,t]=W.useState(1),[r,n]=W.useState(""),[a,c]=W.useState(!1),[f,i]=W.useState(""),x=wa(),w=Cl({resolver:tc(FUe),defaultValues:{email:""}}),A=Cl({resolver:tc(BUe),defaultValues:{otp:""}});W.useEffect(()=>{e===2&&A.reset({otp:""})},[e,A]);const P=async L=>{var $,H;try{c(!0),n(L.email);const{data:K}=await xn.post("/auth/forgot-password",{email:L.email});K.success&&(Mn.success(K.message),A.reset({otp:""}),t(2))}catch(K){console.error("Forgot password error:",K),Mn.error(((H=($=K.response)==null?void 0:$.data)==null?void 0:H.message)||"Failed to send reset email")}finally{c(!1)}},E=async L=>{var $,H;try{c(!0);const{data:K}=await xn.post("/auth/verify-password-reset-otp",{email:r,otp:L.otp});K.success&&(i(K.resetToken),Mn.success("OTP verified successfully"),x("/reset-password",{state:{resetToken:K.resetToken,email:r}}))}catch(K){console.error("OTP verification error:",K),Mn.error(((H=($=K.response)==null?void 0:$.data)==null?void 0:H.message)||"Invalid OTP")}finally{c(!1)}},D=()=>{x("/login")},V=()=>{x("/login")};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("img",{src:G1,alt:"LTO Logo",className:"h-20 w-20 mx-auto mb-4"}),l.jsx("h1",{className:"text-3xl font-bold text-[#1e3a8a] mb-2",children:"LTO SYSTEM"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Land Transportation Management System"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e===1?l.jsx(ip,{...w,children:l.jsx("form",{onSubmit:w.handleSubmit(P),children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Forgot Password?"}),l.jsx("p",{className:"text-gray-600",children:"Enter your email address and we'll send you an OTP to reset your password."})]}),l.jsx(En,{control:w.control,name:"email",render:({field:L})=>l.jsxs(jn,{children:[l.jsx(Nn,{children:l.jsxs("div",{className:"relative",children:[l.jsx(Du,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),l.jsx(kn,{...L,type:"email",placeholder:"Enter your email address",className:Ut("pl-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",w.formState.errors.email&&"border-red-500")})]})}),l.jsx(Cn,{})]})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:V,className:"flex-1 h-11 border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),l.jsx(Nr,{type:"submit",disabled:a,className:"flex-1 h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:a?l.jsx(_c,{className:"w-4 h-4 animate-spin"}):"Send OTP"})]})]})})}):W.createElement(ip,{...A,key:"otp-form"},l.jsx("form",{onSubmit:A.handleSubmit(E),children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Verify OTP"}),l.jsxs("p",{className:"text-gray-600",children:["We've sent a 6-digit OTP to ",l.jsx("strong",{children:r})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Please check your email and enter the OTP below."})]}),l.jsx(En,{control:A.control,name:"otp",render:({field:L})=>l.jsxs(jn,{children:[l.jsx(Nn,{children:l.jsx(kn,{...L,type:"text",placeholder:"Enter 6-digit OTP",maxLength:6,className:Ut("h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500 text-center text-lg tracking-widest",A.formState.errors.otp&&"border-red-500")})}),l.jsx(Cn,{})]})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsxs(Nr,{type:"button",variant:"outline",onClick:()=>t(1),className:"flex-1 h-11 border-gray-300 text-gray-700 hover:bg-gray-50",children:[l.jsx(gP,{className:"w-4 h-4 mr-2"}),"Back"]}),l.jsx(Nr,{type:"submit",disabled:a,className:"flex-1 h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:a?l.jsx(_c,{className:"w-4 h-4 animate-spin"}):"Verify OTP"})]})]})})),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("button",{onClick:D,className:"text-sm text-[#1e3a8a] hover:underline",children:"Back to Login"})})]})]})})}const UUe=Dr.object({newPassword:Dr.string().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:Dr.string()}).refine(e=>e.newPassword===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function $Ue(){const[e,t]=W.useState(!1),[r,n]=W.useState(!1),[a,c]=W.useState(!1),[f,i]=W.useState(!1),x=wa(),w=co(),A=Cl({resolver:tc(UUe),defaultValues:{newPassword:"",confirmPassword:""}});W.useEffect(()=>{var L;(L=w.state)!=null&&L.resetToken||(Mn.error("Invalid reset link. Please request a new password reset."),x("/forgot-password"))},[w.state,x]);const P=()=>{t(!e)},E=()=>{n(!r)},D=async L=>{var $,H;try{c(!0);const{data:K}=await xn.post("/auth/reset-password",{resetToken:w.state.resetToken,newPassword:L.newPassword});K.success&&(i(!0),Mn.success("Password reset successfully!"),setTimeout(()=>{x("/login")},3e3))}catch(K){console.error("Reset password error:",K),Mn.error(((H=($=K.response)==null?void 0:$.data)==null?void 0:H.message)||"Failed to reset password")}finally{c(!1)}},V=()=>{x("/login")};return f?l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("img",{src:G1,alt:"LTO Logo",className:"h-20 w-20 mx-auto mb-4"}),l.jsx("h1",{className:"text-3xl font-bold text-[#1e3a8a] mb-2",children:"LTO SYSTEM"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Land Transportation Management System"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx(cH,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Password Reset Successful!"}),l.jsx("p",{className:"text-gray-600",children:"Your password has been successfully reset. You will be redirected to the login page shortly."})]}),l.jsx(Nr,{onClick:V,className:"w-full h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:"Go to Login"})]})]})}):l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:l.jsxs("div",{className:"w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("img",{src:G1,alt:"LTO Logo",className:"h-20 w-20 mx-auto mb-4"}),l.jsx("h1",{className:"text-3xl font-bold text-[#1e3a8a] mb-2",children:"LTO SYSTEM"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Land Transportation Management System"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[l.jsx(ip,{...A,children:l.jsx("form",{onSubmit:A.handleSubmit(D),children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Reset Password"}),l.jsx("p",{className:"text-gray-600",children:"Enter your new password below."})]}),l.jsx(En,{control:A.control,name:"newPassword",render:({field:L})=>l.jsxs(jn,{children:[l.jsx(Nn,{children:l.jsxs("div",{className:"relative",children:[l.jsx(aR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),l.jsx(kn,{...L,type:e?"text":"password",placeholder:"New Password",className:Ut("pl-10 pr-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",A.formState.errors.newPassword&&"border-red-500")}),l.jsx(Nr,{type:"button",size:"icon",variant:"ghost",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 hover:bg-transparent",onClick:P,"aria-label":e?"Hide Password":"Show Password",children:e?l.jsx(kA,{className:"text-gray-400 h-4 w-4"}):l.jsx(CA,{className:"text-gray-400 h-4 w-4"})})]})}),l.jsx(Cn,{})]})}),l.jsx(En,{control:A.control,name:"confirmPassword",render:({field:L})=>l.jsxs(jn,{children:[l.jsx(Nn,{children:l.jsxs("div",{className:"relative",children:[l.jsx(aR,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),l.jsx(kn,{...L,type:r?"text":"password",placeholder:"Confirm New Password",className:Ut("pl-10 pr-10 h-11 border-gray-300 focus:ring-0 focus:border-[#1e3a8a] rounded-md bg-white text-gray-900 placeholder:text-gray-500",A.formState.errors.confirmPassword&&"border-red-500")}),l.jsx(Nr,{type:"button",size:"icon",variant:"ghost",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 hover:bg-transparent",onClick:E,"aria-label":r?"Hide Password":"Show Password",children:r?l.jsx(kA,{className:"text-gray-400 h-4 w-4"}):l.jsx(CA,{className:"text-gray-400 h-4 w-4"})})]})}),l.jsx(Cn,{})]})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Nr,{type:"button",variant:"outline",onClick:V,className:"flex-1 h-11 border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),l.jsx(Nr,{type:"submit",disabled:a,className:"flex-1 h-11 bg-[#1e3a8a] hover:bg-[#1e40af] text-white font-semibold",children:a?l.jsx(_c,{className:"w-4 h-4 animate-spin"}):"Reset Password"})]})]})})}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx("button",{onClick:V,className:"text-sm text-[#1e3a8a] hover:underline",children:"Back to Login"})})]})]})})}function qUe(){return l.jsxs(l.Fragment,{children:[l.jsx(Foe,{closeButton:!0}),l.jsxs(Ele,{children:[l.jsx(za,{path:"/login",element:l.jsx(Ave,{})}),l.jsx(za,{path:"/forgot-password",element:l.jsx(VUe,{})}),l.jsx(za,{path:"/reset-password",element:l.jsx($Ue,{})}),l.jsx(za,{path:"/404",element:l.jsx(wVe,{})}),l.jsx(za,{path:"/",element:l.jsx(w6e,{allowedRoles:["superadmin","admin","employee"]}),children:l.jsxs(za,{element:l.jsx(H6e,{}),children:[l.jsx(za,{index:!0,element:l.jsx(b6e,{})}),l.jsx(za,{path:"analytics/registration",element:l.jsx(cUe,{})}),l.jsx(za,{path:"analytics/violation",element:l.jsx(wUe,{})}),l.jsx(za,{path:"analytics/accident",element:l.jsx(EUe,{})}),l.jsx(za,{path:"driver",element:l.jsx(_Ve,{})}),l.jsx(za,{path:"driver/inactive",element:l.jsx(AVe,{})}),l.jsx(za,{path:"driver/:id",element:l.jsx(bVe,{})}),l.jsx(za,{path:"driver/:id/edit",element:l.jsx(SVe,{})}),l.jsx(za,{path:"vehicle",element:l.jsx(OVe,{})}),l.jsx(za,{path:"vehicle/:id",element:l.jsx(IVe,{})}),l.jsx(za,{path:"vehicle/:id/edit",element:l.jsx(DVe,{})}),l.jsx(za,{path:"violation",element:l.jsx(VVe,{})}),l.jsx(za,{path:"violation/:id/edit",element:l.jsx(KVe,{})}),l.jsx(za,{path:"accident",element:l.jsx(qVe,{})}),l.jsx(za,{path:"accident/:id",element:l.jsx(WVe,{})}),l.jsx(za,{path:"accident/:id/edit",element:l.jsx(HVe,{})}),l.jsx(za,{path:"account/register",element:l.jsx(HO,{allowedRoles:["admin","superadmin"],children:l.jsx(RUe,{})})}),l.jsx(za,{path:"account/update",element:l.jsx(HO,{allowedRoles:["admin","superadmin"],children:l.jsx(LUe,{})})}),l.jsx(za,{path:"account/logs",element:l.jsx(HO,{allowedRoles:["admin","superadmin"],children:l.jsx(zUe,{})})})]})}),l.jsx(za,{path:"*",element:l.jsx(W3,{to:"/404"})})]})]})}var cA={},MW;function GUe(){if(MW)return cA;MW=1;var e=RW();return cA.createRoot=e.createRoot,cA.hydrateRoot=e.hydrateRoot,cA}var WUe=GUe();const HUe=la(WUe);HUe.createRoot(document.getElementById("root")).render(l.jsx(Oe.StrictMode,{children:l.jsx(ece,{children:l.jsx(_ve,{children:l.jsx(Nme,{defaultTheme:"dark",storageKey:"vite-ui-theme",children:l.jsx(qUe,{})})})})}));
